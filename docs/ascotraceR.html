<!DOCTYPE html><html lang="en-US"><head><title>Help for package ascotraceR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ascotraceR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ascotraceR-package'><p>ascotraceR: Simulate the Spread of Ascochyta Blight in Chickpea</p></a></li>
<li><a href='#format_weather'><p>Format weather data into an an object suitable for use in ascotraceR spore dispersal models</p></a></li>
<li><a href='#summarise_trace'><p>Summarise a trace_asco output nested list as a single data.frame object</p></a></li>
<li><a href='#tidy_trace'><p>Tidy up a trace_asco output nested list</p></a></li>
<li><a href='#trace_asco'><p>Simulates the spread of Ascochyta blight in a chickpea field</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Simulate the Spread of Ascochyta Blight in Chickpea</td>
</tr>
<tr>
<td>Version:</td>
<td>0.0.1</td>
</tr>
<tr>
<td>Description:</td>
<td>A spatiotemporal model that simulates the spread of Ascochyta
    blight in chickpea fields based on location-specific weather conditions.
    This model is adapted from a model developed by Diggle et al. (2002)
   &lt;<a href="https://doi.org/10.1094%2FPHYTO.2002.92.10.1110">doi:10.1094/PHYTO.2002.92.10.1110</a>&gt; for simulating the spread of anthracnose
   in a lupin field.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/IhsanKhaliq/ascotraceR">https://github.com/IhsanKhaliq/ascotraceR</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/IhsanKhaliq/ascotraceR/issues">https://github.com/IhsanKhaliq/ascotraceR/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>data.table (&ge; 1.13.0), lubridate (&ge; 1.7.9.2), lutz (&ge;
0.3.1), circular (&ge; 0.4-93), purrr, stats, sf, terra</td>
</tr>
<tr>
<td>Suggests:</td>
<td>ggplot2, knitr, rmarkdown, spelling, testthat (&ge; 3.0.1)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>X-schema.org-applicationCategory:</td>
<td>Tools</td>
</tr>
<tr>
<td>X-schema.org-keywords:</td>
<td>chickpea, botanical-epidemiology,
plant-disease-model, agricultural-modelling,
agricultural-modeling, crop-protection, agricultural-research,
model, modelling, modeling, Ascochyta-rabiei</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-12-19 11:54:34 UTC; Tele</td>
</tr>
<tr>
<td>Author:</td>
<td>Ihsanul Khaliq <a href="https://orcid.org/0000-0003-4171-0917"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Paul Melloy <a href="https://orcid.org/0000-0003-4253-7167"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    trl, cre],
  Adam H. Sparks <a href="https://orcid.org/0000-0002-0061-8359"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, ccp],
  Grains Research and Development Corporation (GRDC) Project
    USQ1903-003RTX [fnd, cph],
  University of Southern Queensland [cph],
  Western Australia Agriculture Authority (WAAA) [cph] (Supported the
    development of ascotraceR through Adam H.  Sparks' time.)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Paul Melloy &lt;p.melloy@uq.edu.au&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-12-20 15:50:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='ascotraceR-package'>ascotraceR: Simulate the Spread of Ascochyta Blight in Chickpea</h2><span id='topic+ascotraceR'></span><span id='topic+ascotraceR-package'></span>

<h3>Description</h3>

<p>A spatiotemporal model that simulates the spread of Ascochyta blight in chickpea fields based on location-specific weather conditions. This model is adapted from a model developed by Diggle et al. (2002) &lt;doi:10.1094/PHYTO.2002.92.10.1110&gt; for simulating the spread of anthracnose in a lupin field.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Paul Melloy <a href="mailto:p.melloy@uq.edu.au">p.melloy@uq.edu.au</a> (<a href="https://orcid.org/0000-0003-4253-7167">ORCID</a>) [translator]
</p>
<p>Authors:
</p>

<ul>
<li><p> Ihsanul Khaliq <a href="mailto:ihsan.khaliq@usq.edu.au">ihsan.khaliq@usq.edu.au</a> (<a href="https://orcid.org/0000-0003-4171-0917">ORCID</a>)
</p>
</li>
<li><p> Adam H. Sparks <a href="mailto:adamhsparks@gmail.com">adamhsparks@gmail.com</a> (<a href="https://orcid.org/0000-0002-0061-8359">ORCID</a>) [conceptor]
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Grains Research and Development Corporation (GRDC) Project USQ1903-003RTX [funder, copyright holder]
</p>
</li>
<li><p> University of Southern Queensland [copyright holder]
</p>
</li>
<li><p> Western Australia Agriculture Authority (WAAA) (Supported the development of ascotraceR through Adam H. Sparks' time.) [copyright holder]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/IhsanKhaliq/ascotraceR">https://github.com/IhsanKhaliq/ascotraceR</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/IhsanKhaliq/ascotraceR/issues">https://github.com/IhsanKhaliq/ascotraceR/issues</a>
</p>
</li></ul>


<hr>
<h2 id='format_weather'>Format weather data into an an object suitable for use in ascotraceR spore dispersal models</h2><span id='topic+format_weather'></span>

<h3>Description</h3>

<p>Formats raw weather data into an object suitable for use in the
<code><a href="#topic+trace_asco">trace_asco()</a></code> function ensuring that the supplied weather data meet the
requirements of the model to run.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>format_weather(
  x,
  YYYY = NULL,
  MM = NULL,
  DD = NULL,
  hh = NULL,
  mm = NULL,
  POSIXct_time = NULL,
  time_zone = NULL,
  temp,
  rain,
  ws,
  wd,
  wd_sd,
  station,
  lon = NULL,
  lat = NULL,
  r = NULL,
  lonlat_file = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="format_weather_+3A_x">x</code></td>
<td>
<p>A <a href="base.html#topic+data.frame">data.frame</a> object of weather station data for formatting.
<code>character</code>.</p>
</td></tr>
<tr><td><code id="format_weather_+3A_yyyy">YYYY</code></td>
<td>
<p>Column name or index in <code>x</code> that refers to the year when the
weather was logged. <code>character</code>.</p>
</td></tr>
<tr><td><code id="format_weather_+3A_mm">MM</code></td>
<td>
<p>Column name or index in <code>x</code> that refers to the month (numerical)
when the weather was logged. <code>character</code>.</p>
</td></tr>
<tr><td><code id="format_weather_+3A_dd">DD</code></td>
<td>
<p>Column name or index in <code>x</code> that refers to the day of month when
the weather was logged. <code>character</code>.</p>
</td></tr>
<tr><td><code id="format_weather_+3A_hh">hh</code></td>
<td>
<p>Column name or index in <code>x</code> that refers to the hour (24 hour) when
the weather was logged. <code>character</code>.</p>
</td></tr>
<tr><td><code id="format_weather_+3A_mm">mm</code></td>
<td>
<p>Column name or index in <code>x</code> that refers to the minute when the
weather was logged. <code>character</code>.</p>
</td></tr>
<tr><td><code id="format_weather_+3A_posixct_time">POSIXct_time</code></td>
<td>
<p>Column name or index in <code>x</code> which contains a <code>POSIXct</code>
formatted time. This can be used instead of arguments <code>YYYY</code>, <code>MM</code>, <code>DD</code>,
<code>hh</code>, <code>mm.</code> <code>character</code>.</p>
</td></tr>
<tr><td><code id="format_weather_+3A_time_zone">time_zone</code></td>
<td>
<p>Time zone (Olsen time zone format) where the weather station
is located. May be in a column or supplied as a character string. Optional,
see also <code>r</code>. <code>character</code>. See details.</p>
</td></tr>
<tr><td><code id="format_weather_+3A_temp">temp</code></td>
<td>
<p>Column name or index in <code>x</code> that refers to temperature in degrees
Celsius. <code>character</code>.</p>
</td></tr>
<tr><td><code id="format_weather_+3A_rain">rain</code></td>
<td>
<p>Column name or index in <code>x</code> that refers to rainfall in mm.
<code>character</code>.</p>
</td></tr>
<tr><td><code id="format_weather_+3A_ws">ws</code></td>
<td>
<p>Column name or index in <code>x</code> that refers to wind speed in km / h.
<code>character</code>.</p>
</td></tr>
<tr><td><code id="format_weather_+3A_wd">wd</code></td>
<td>
<p>Column name or index in <code>x</code> that refers to wind direction in
degrees. <code>character</code>.</p>
</td></tr>
<tr><td><code id="format_weather_+3A_wd_sd">wd_sd</code></td>
<td>
<p>Column name or index in <code>x</code> that refers to wind speed columns
standard deviation .<code>character</code>.  This is only applicable if weather data
is already summarised to hourly increments. See details.</p>
</td></tr>
<tr><td><code id="format_weather_+3A_station">station</code></td>
<td>
<p>Column name or index in <code>x</code> that refers to the weather station
name or identifier. <code>character</code>. See details.</p>
</td></tr>
<tr><td><code id="format_weather_+3A_lon">lon</code></td>
<td>
<p>Column name or index in <code>x</code> that refers to weather station's
longitude. <code>character</code>. See details.</p>
</td></tr>
<tr><td><code id="format_weather_+3A_lat">lat</code></td>
<td>
<p>Column name or index in <code>x</code> that refers to weather station's
latitude. <code>character</code>. See details.</p>
</td></tr>
<tr><td><code id="format_weather_+3A_r">r</code></td>
<td>
<p>Spatial raster which is intended to be used with this weather data
for use in the blackspot model. Used to set <code>time_zone</code> if it is not
supplied in data. <code>character</code>. Optional, see also <code>time_zone</code>.</p>
</td></tr>
<tr><td><code id="format_weather_+3A_lonlat_file">lonlat_file</code></td>
<td>
<p>A file path to a <abbr><span class="acronym">CSV</span></abbr> which included station
name/id and longitude and latitude coordinates if they are not supplied in
the data. <code>character</code>. Optional, see also <code>lon</code> and <code>lat</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>time_zone</code> All weather stations must fall within the same time
zone.  If the required stations are located in differing time zones,
separate <code>ascotraceR.weather</code> objects must be created for each time zone.
If a raster object, <code>r</code>, of previous crops is provided that spans time
zones, an error will be emitted.
</p>
<p><code>wd_sd</code> If weather data is provided in hourly increments, a column
with the standard deviation of the wind direction over the hour is required
to be provided. If the weather data are sub-hourly, the standard deviation
will be calculated and returned automatically.
</p>
<p><code>lon</code>, <code>lat</code> and <code>lonlat_file</code> If <code>x</code> provides longitude and
latitude values for station locations, these may be specified in the <code>lon</code>
and <code>lat</code> columns.  If the coordinates are not relevant to the study
location <code>NA</code> can be specified and the function will drop these column
variables.  If these data are not included, (<code>NULL</code>) a separate file may be
provided that contains the longitude, latitude and matching station name to
provide station locations in the final <code>ascotraceR.weather</code> object that is
created by specifying the file path to a <abbr><span class="acronym">CSV</span></abbr> file using
<code>lonlat_file</code>.
</p>


<h3>Value</h3>

<p>A <code>ascotraceR.weather</code> object (an extension of <a href="https://CRAN.R-project.org/package=data.table"><span class="pkg">data.table</span></a>)
containing the supplied weather aggregated to each hour in a suitable
format for use with <code><a href="#topic+trace_asco">trace_asco()</a></code> containing the following columns:
</p>

<table>
<tr>
 <td style="text-align: right;">
<strong>times</strong>: </td><td style="text-align: left;"> Time in POSIXct format </td>
</tr>
<tr>
 <td style="text-align: right;">
<strong>rain</strong>: </td><td style="text-align: left;"> Rainfall in mm </td>
</tr>
<tr>
 <td style="text-align: right;">
<strong>ws</strong>: </td><td style="text-align: left;"> Wind speed in km / h </td>
</tr>
<tr>
 <td style="text-align: right;">
<strong>wd</strong>: </td><td style="text-align: left;"> Wind direction in compass degrees </td>
</tr>
<tr>
 <td style="text-align: right;">
<strong>wd_sd</strong>: </td><td style="text-align: left;"> Wind direction standard deviation in compass degrees </td>
</tr>
<tr>
 <td style="text-align: right;">
<strong>lon</strong>: </td><td style="text-align: left;"> Station longitude in decimal degrees </td>
</tr>
<tr>
 <td style="text-align: right;">
<strong>lat</strong>: </td><td style="text-align: left;"> Station latitude in decimal degrees </td>
</tr>
<tr>
 <td style="text-align: right;">
<strong>station</strong>: </td><td style="text-align: left;"> Unique station identifying name </td>
</tr>
<tr>
 <td style="text-align: right;">
<strong>YYYY</strong>: </td><td style="text-align: left;"> Year </td>
</tr>
<tr>
 <td style="text-align: right;">
<strong>MM</strong>: </td><td style="text-align: left;"> Month </td>
</tr>
<tr>
 <td style="text-align: right;">
<strong>DD</strong>: </td><td style="text-align: left;"> Day </td>
</tr>
<tr>
 <td style="text-align: right;">
<strong>hh</strong>: </td><td style="text-align: left;"> Hour </td>
</tr>
<tr>
 <td style="text-align: right;">
<strong>mm</strong>: </td><td style="text-align: left;"> Minute </td>
</tr>

</table>



<h3>Examples</h3>

<pre><code class='language-R'># Weather data files for Newmarracara for testing and examples have been
# included in ascotraceR. The weather data files both are of the same format,
# so they will be combined for formatting here.

Newmarracarra &lt;- read.csv(
 system.file("extdata",
             "1998_Newmarracarra_weather_table.csv",
             package = "ascotraceR")
)

station_data &lt;- system.file("extdata",
                            "stat_dat.csv",
                            package = "ascotraceR")

weather &lt;- format_weather(
  x = Newmarracarra,
  POSIXct_time = "Local.Time",
  temp = "mean_daily_temp",
  rain = "rain_mm",
  ws = "ws",
  wd = "wd",
  wd_sd = "wd_sd",
  station = "Location",
  time_zone = "Australia/Perth",
  lonlat_file = station_data
)

# Saving weather data and reimporting can lose the object class
# Reimported data can be quickly reformatted, adding the 'asco.weather' class
#  with this same function
temp_file_path &lt;- paste0(tempdir(),"weather_file.csv")
write.csv(weather, file = temp_file_path, row.names = FALSE)
weather_imported &lt;- read.csv(temp_file_path)
weather &lt;- format_weather(weather_imported,
                          time_zone = "Australia/Perth")
unlink(temp_file_path) # remove temporary weather file
</code></pre>

<hr>
<h2 id='summarise_trace'>Summarise a trace_asco output nested list as a single data.frame object</h2><span id='topic+summarise_trace'></span><span id='topic+summarize_trace'></span>

<h3>Description</h3>

<p>Creates a paddock-level summary <a href="https://CRAN.R-project.org/package=data.table"><span class="pkg">data.table</span></a> from the output of
<code><a href="#topic+trace_asco">trace_asco()</a></code> on a daily time-step where each row represents one day for
the entire paddock.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summarise_trace(trace)

summarize_trace(trace)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summarise_trace_+3A_trace">trace</code></td>
<td>
<p>a nested list output from <code><a href="#topic+trace_asco">trace_asco()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <a href="https://CRAN.R-project.org/package=data.table"><span class="pkg">data.table</span></a> summarising the model's output for a paddock
on a daily time-step with the area under the disease progress curve
(<abbr><span class="acronym">AUDPC</span></abbr>) at the paddock level for the simulation's run with the
following columns:
</p>

<table>
<tr>
 <td style="text-align: right;">
<strong>i_day</strong>: </td><td style="text-align: left;"> Model iteration day (day) </td>
</tr>
<tr>
 <td style="text-align: right;">
<strong>new_gp</strong>: </td><td style="text-align: left;"> New growing points on <code>i_day</code> (n) </td>
</tr>
<tr>
 <td style="text-align: right;">
<strong>susceptible_gp</strong>: </td><td style="text-align: left;"> Susceptible growing points on <code>i_day</code> (n) </td>
</tr>
<tr>
 <td style="text-align: right;">
<strong>exposed_gp</strong>: </td><td style="text-align: left;"> Exposed growing points on <code>i_day</code> (n) </td>
</tr>
<tr>
 <td style="text-align: right;">
<strong>i_date</strong>: </td><td style="text-align: left;"> Calendar date corresponding to model's <code>i_day</code> </td>
</tr>
<tr>
 <td style="text-align: right;">
<strong>day</strong>: </td><td style="text-align: left;"> Julian day or numeric day of year (day) </td>
</tr>
<tr>
 <td style="text-align: right;">
<strong>cdd</strong>: </td><td style="text-align: left;"> Cumulative degree days (day) </td>
</tr>
<tr>
 <td style="text-align: right;">
<strong>cwh</strong>: </td><td style="text-align: left;"> Cumulative wet hours (h) </td>
</tr>
<tr>
 <td style="text-align: right;">
<strong>cr</strong>: </td><td style="text-align: left;"> Cumulative rainfall (mm) </td>
</tr>
<tr>
 <td style="text-align: right;">
<strong>gp_standard</strong>: </td><td style="text-align: left;"> standard growing points assuming growth is not
impeded by infection on <code>i_day</code> (n) </td>
</tr>
<tr>
 <td style="text-align: right;">
<strong>AUDPC</strong>: </td><td style="text-align: left;"> Area under the disease progress curve (AUDPC) for the duration
of the model's run.</td>
</tr>

</table>



<h3>See Also</h3>

<p><code><a href="#topic+trace_asco">trace_asco()</a></code>, <code><a href="#topic+tidy_trace">tidy_trace()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
Newmarracarra &lt;-
   read.csv(system.file("extdata",
            "1998_Newmarracarra_weather_table.csv", package = "ascotraceR"))
station_data &lt;-
   system.file("extdata", "stat_dat.csv", package = "ascotraceR")

weather_dat &lt;- format_weather(
   x = Newmarracarra,
   POSIXct_time = "Local.Time",
   temp = "mean_daily_temp",
   ws = "ws",
   wd_sd = "wd_sd",
   rain = "rain_mm",
   wd = "wd",
   station = "Location",
   time_zone = "Australia/Perth",
   lonlat_file = station_data)

traced &lt;- trace_asco(
  weather = weather_dat,
  paddock_length = 100,
  paddock_width = 100,
  initial_infection = "1998-06-10",
  sowing_date = "1998-06-09",
  harvest_date = "1998-06-30",
  time_zone = "Australia/Perth",
  primary_infection_foci = "centre")

summarised &lt;- summarise_trace(traced)



Newmarracarra &lt;-
   read.csv(system.file("extdata",
            "1998_Newmarracarra_weather_table.csv", package = "ascotraceR"))
station_data &lt;-
   system.file("extdata", "stat_dat.csv", package = "ascotraceR")

weather_dat &lt;- format_weather(
   x = Newmarracarra,
   POSIXct_time = "Local.Time",
   temp = "mean_daily_temp",
   ws = "ws",
   wd_sd = "wd_sd",
   rain = "rain_mm",
   wd = "wd",
   station = "Location",
   time_zone = "Australia/Perth",
   lonlat_file = station_data)

traced &lt;- trace_asco(
  weather = weather_dat,
  paddock_length = 100,
  paddock_width = 100,
  initial_infection = "1998-06-10",
  sowing_date = as.POSIXct("1998-06-09"),
  harvest_date = as.POSIXct("1998-06-09") + lubridate::ddays(100),
  time_zone = "Australia/Perth",
  primary_infection_foci = "centre")

summarised &lt;- summarise_trace(traced)

</code></pre>

<hr>
<h2 id='tidy_trace'>Tidy up a trace_asco output nested list</h2><span id='topic+tidy_trace'></span>

<h3>Description</h3>

<p>Creates a tidy <a href="https://CRAN.R-project.org/package=data.table"><span class="pkg">data.table</span></a> from the output of <code><a href="#topic+trace_asco">trace_asco()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tidy_trace(trace)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tidy_trace_+3A_trace">trace</code></td>
<td>
<p>a nested list output from <code><a href="#topic+trace_asco">trace_asco()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tidy <a href="https://CRAN.R-project.org/package=data.table"><span class="pkg">data.table</span></a> of <code><a href="#topic+trace_asco">trace_asco()</a></code> output.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summarise_trace">summarise_trace()</a></code>, <code><a href="#topic+trace_asco">trace_asco()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

Newmarracarra &lt;-
   read.csv(system.file("extdata",
            "1998_Newmarracarra_weather_table.csv", package = "ascotraceR"))
station_data &lt;-
   system.file("extdata", "stat_dat.csv", package = "ascotraceR")

weather_dat &lt;- format_weather(
   x = Newmarracarra,
   POSIXct_time = "Local.Time",
   temp = "mean_daily_temp",
   ws = "ws",
   wd_sd = "wd_sd",
   rain = "rain_mm",
   wd = "wd",
   station = "Location",
   time_zone = "Australia/Perth",
   lonlat_file = station_data)

traced &lt;- trace_asco(
  weather = weather_dat,
  paddock_length = 20,
  paddock_width = 20,
  initial_infection = "1998-06-10",
  sowing_date = as.POSIXct("1998-06-09"),
  harvest_date = as.POSIXct("1998-06-09") + lubridate::ddays(100),
  time_zone = "Australia/Perth",
  primary_infection_foci = "centre")

tidied &lt;- tidy_trace(traced)

# take a look at the infectious growing points on day 102
library(ggplot2)
ggplot(data = subset(tidied, i_day == 102),
       aes(x = x, y = y, fill = infectious_gp)) +
  geom_tile()

</code></pre>

<hr>
<h2 id='trace_asco'>Simulates the spread of Ascochyta blight in a chickpea field</h2><span id='topic+trace_asco'></span>

<h3>Description</h3>

<p>Simulate the spatiotemporal development of Ascochyta blight in a chickpea
paddock over a growing season. Both host and pathogen activities are
simulated in one square metre cells.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trace_asco(
  weather,
  paddock_length,
  paddock_width,
  sowing_date,
  harvest_date,
  initial_infection,
  seeding_rate = 40,
  gp_rr = 0.0065,
  max_gp_lim = 5000,
  max_new_gp = 350,
  latent_period_cdd = 150,
  time_zone = "UTC",
  primary_infection_foci = "random",
  primary_inoculum_intensity = 1,
  n_foci = 1,
  spores_per_gp_per_wet_hour = 0.22,
  splash_cauchy_parameter = 0.5,
  wind_cauchy_multiplier = 0.015,
  daily_rain_threshold = 2,
  hourly_rain_threshold = 0.1,
  susceptible_days = 2,
  rainfall_multiplier = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="trace_asco_+3A_weather">weather</code></td>
<td>
<p>weather data for a representative chickpea paddock for a
complete chickpea growing season for the model's operation.</p>
</td></tr>
<tr><td><code id="trace_asco_+3A_paddock_length">paddock_length</code></td>
<td>
<p>length of a paddock in metres (y).</p>
</td></tr>
<tr><td><code id="trace_asco_+3A_paddock_width">paddock_width</code></td>
<td>
<p>width of a paddock in metres (x).</p>
</td></tr>
<tr><td><code id="trace_asco_+3A_sowing_date">sowing_date</code></td>
<td>
<p>a character string of a date value indicating sowing date
of chickpea seed and the start of the &lsquo;ascotraceR&rsquo; model. Preferably
in ISO8601 format (YYYY-MM-DD), <em>e.g.</em> &ldquo;2020-04-26&rdquo;. Assumes there
is sufficient soil moisture to induce germination and start the crop
growing season.</p>
</td></tr>
<tr><td><code id="trace_asco_+3A_harvest_date">harvest_date</code></td>
<td>
<p>a character string of a date value indicating harvest
date of chickpea crop, which is also the last day to run the
&lsquo;ascotraceR&rsquo; model. Preferably in ISO8601 format (YYYY-MM-DD),
<em>e.g.</em>, &ldquo;2020-04-26&rdquo;.</p>
</td></tr>
<tr><td><code id="trace_asco_+3A_initial_infection">initial_infection</code></td>
<td>
<p>a character string of a date value referring to the
initial or primary infection on seedlings, resulting in the production of
infectious growing points.</p>
</td></tr>
<tr><td><code id="trace_asco_+3A_seeding_rate">seeding_rate</code></td>
<td>
<p>indicate the rate at which chickpea seed is sown per
square metre. Defaults to <code>40</code>.</p>
</td></tr>
<tr><td><code id="trace_asco_+3A_gp_rr">gp_rr</code></td>
<td>
<p>refers to rate of increase in chickpea growing points per degree
Celsius per day. Defaults to <code>0.0065</code>.</p>
</td></tr>
<tr><td><code id="trace_asco_+3A_max_gp_lim">max_gp_lim</code></td>
<td>
<p>maximum number of chickpea growing points (meristems)
allowed per square metre. Defaults to <code>5000</code>.</p>
</td></tr>
<tr><td><code id="trace_asco_+3A_max_new_gp">max_new_gp</code></td>
<td>
<p>Maximum number of new chickpea growing points (meristems),
which develop per day, per square metre. Defaults to <code>350</code>.</p>
</td></tr>
<tr><td><code id="trace_asco_+3A_latent_period_cdd">latent_period_cdd</code></td>
<td>
<p>latent period in cumulative degree days (sum of
daily temperature means) is the period between infection and production of
lesions on susceptible growing points. Defaults to <code>150</code>.</p>
</td></tr>
<tr><td><code id="trace_asco_+3A_time_zone">time_zone</code></td>
<td>
<p>refers to time in Coordinated Universal Time (UTC).</p>
</td></tr>
<tr><td><code id="trace_asco_+3A_primary_infection_foci">primary_infection_foci</code></td>
<td>
<p>refers to the inoculated coordinates where the
infection starts. Accepted inputs are: <code>centre</code>/<code>center</code> or <code>random</code>
(Default) or a <code>data.frame</code> with column names &lsquo;x&rsquo;, &lsquo;y&rsquo; and
&lsquo;load&rsquo;. The <code>data.frame</code> inputs inform the model of specific grid
cell/s coordinates where the epidemic should begin. The &lsquo;load&rsquo;
column is optional and can specify the <code>primary_inoculum_intensity</code> for
each coordinate.</p>
</td></tr>
<tr><td><code id="trace_asco_+3A_primary_inoculum_intensity">primary_inoculum_intensity</code></td>
<td>
<p>Refers to the amount of primary infection
as lesions on chickpea plants at the time of <code>initial_infection</code>. On the
date of initial infection in the experiment. The sources of primary
inoculum can be infected seed, volunteer chickpea plants or infested
stubble from the previous seasons. Defaults to <code>1</code>.</p>
</td></tr>
<tr><td><code id="trace_asco_+3A_n_foci">n_foci</code></td>
<td>
<p>Quantifies the number of primary infection foci. The value is
<code>1</code> when <code>primary_infection_foci = "centre"</code> and can be greater than <code>1</code> if
<code style="white-space: pre;">&#8288;primary_infection_foci = "random&#8288;</code>.</p>
</td></tr>
<tr><td><code id="trace_asco_+3A_spores_per_gp_per_wet_hour">spores_per_gp_per_wet_hour</code></td>
<td>
<p>number of spores produced per infectious
growing point during each wet hour. Also known as the <code>spore_rate</code>. Value
is dependent on the susceptibility of the host genotype.</p>
</td></tr>
<tr><td><code id="trace_asco_+3A_splash_cauchy_parameter">splash_cauchy_parameter</code></td>
<td>
<p>a parameter used in the Cauchy distribution
and describes the median distance spores travel due to rain splashes.
Default to <code>0.5</code>.</p>
</td></tr>
<tr><td><code id="trace_asco_+3A_wind_cauchy_multiplier">wind_cauchy_multiplier</code></td>
<td>
<p>a scaling parameter to estimate a Cauchy
distribution which resembles the possible distances a conidium travels due
to wind driven rain. Defaults to <code>0.015</code>.</p>
</td></tr>
<tr><td><code id="trace_asco_+3A_daily_rain_threshold">daily_rain_threshold</code></td>
<td>
<p>minimum cumulative rainfall required in a day to
allow hourly spore spread events. See also <code>hourly_rain_threshold</code>.
Defaults to <code>2</code>.</p>
</td></tr>
<tr><td><code id="trace_asco_+3A_hourly_rain_threshold">hourly_rain_threshold</code></td>
<td>
<p>minimum rainfall in an hour to trigger a spore
spread event in the same hour (assuming daily_rain_threshold is already
met). Defaults to <code>0.1</code>.</p>
</td></tr>
<tr><td><code id="trace_asco_+3A_susceptible_days">susceptible_days</code></td>
<td>
<p>the number of days for which conidia remain viable on
chickpea after dispersal. Defaults to <code>2</code>. Conidia remain viable on the
plant for at least 48 hours after a spread event</p>
</td></tr>
<tr><td><code id="trace_asco_+3A_rainfall_multiplier">rainfall_multiplier</code></td>
<td>
<p>logical values will turn on or off rainfall
multiplier default method. The default method increases the number of
spores spread per growing point if the rainfall in the spore spread event
hour is greater than one. Numeric values will scale the number of spores
spread per growing point against the volume of rainfall in the hour.
Defaults to <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a nested <code>list</code> object where each sub-list contains daily data for
the day <code>i_day</code> (the model's iteration day) generated by the model
including: * <strong>paddock</strong>, an 'x' 'y' <a href="https://CRAN.R-project.org/package=data.table"><span class="pkg">data.table</span></a> containing: *
<strong>x</strong>, location of quadrat on x-axis in paddock, * <strong>y</strong>, location of
quadrat on y-axis in paddock, * <strong>new_gp</strong>, new growing points produced in
the last 24 hours, * <strong>susceptible_gp</strong>, susceptible growing points in the
last 24 hours, * <strong>exposed_gp</strong>, exposed growing points in the last 24
hours, * <strong>infectious_gp</strong>, infectious growing points in the last 24 hours,
</p>

<ul>
<li> <p><strong>i_day</strong>, model iteration day, * <strong>cumulative daily weather data</strong>, a
<a href="https://CRAN.R-project.org/package=data.table"><span class="pkg">data.table</span></a> containing: * <strong>cdd</strong>, cumulative degree days, *
<strong>cwh</strong>, cumulative wet hours, * <strong>cr</strong>, cumulative rainfall in mm, *
<strong>gp_standard</strong>, standard growing points assuming growth is not impeded by
infection, * <strong>infected_coords</strong>, a <a href="https://CRAN.R-project.org/package=data.table"><span class="pkg">data.table</span></a> of only infectious
growing point coordinates, * <strong>new_infections</strong>, a <a href="https://CRAN.R-project.org/package=data.table"><span class="pkg">data.table</span></a> of
newly infected growing points, * <strong>exposed_gps</strong>, a <a href="https://CRAN.R-project.org/package=data.table"><span class="pkg">data.table</span></a> of
exposed growing points in the latent period phase of infection.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+tidy_trace">tidy_trace()</a></code>, <code><a href="#topic+summarise_trace">summarise_trace()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# First weather data needs to be imported and formatted with `format_weather`
Newmarracarra &lt;-
   read.csv(system.file("extdata",
            "1998_Newmarracarra_weather_table.csv", package = "ascotraceR"))
station_data &lt;-
   system.file("extdata", "stat_dat.csv", package = "ascotraceR")

weather_dat &lt;- format_weather(
   x = Newmarracarra,
   POSIXct_time = "Local.Time",
   temp = "mean_daily_temp",
   ws = "ws",
   wd_sd = "wd_sd",
   rain = "rain_mm",
   wd = "wd",
   station = "Location",
   time_zone = "Australia/Perth",
   lonlat_file = station_data)

# Now the `trace_asco` function can be run to simulate disease spread
traced &lt;- trace_asco(
  weather = weather_dat,
  paddock_length = 100,
  paddock_width = 100,
  initial_infection = "1998-06-10",
  sowing_date = "1998-06-09",
  harvest_date = "1998-06-30",
  time_zone = "Australia/Perth",
  gp_rr = 0.0065,
  primary_inoculum_intensity = 40,
  spores_per_gp_per_wet_hour = 0.22,
  primary_infection_foci = "centre")

traced[[23]] # extracts the model output for day 23

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
