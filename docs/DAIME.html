<!DOCTYPE html><html><head><title>Help for package DAIME</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {DAIME}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#DAIME-package'>
<p>Effects of Changing Deposition Rates</p></a></li>
<li><a href='#ColDePalluel.rdata'><p>Microcpaleontological, palynological, and geochemical data from the Col de Palluel, SE France (Late Albanian)</p></a></li>
<li><a href='#KPgLastOccurrences.rdata'><p>Last occurrences for the K/Pg boundary and a potential influence of Deccan volcanism</p></a></li>
<li><a href='#LakeSuperiour.rdata'><p>210Pb measurements and derived age models from Lake Superior</p></a></li>
<li><a href='#patterntodepositionmodel'>
<p>Use sedimentary dilution/condensation of known patterns to create age model</p></a></li>
<li><a href='#patterntransform'>
<p>Transform patterns between stratigraphic height and time/age</p></a></li>
<li><a href='#pointtransform'>
<p>Transform points between stratigraphic height and time/age</p></a></li>
<li><a href='#SeymourIslandAgeModels'><p>Age models for the K/Pg boundary on Seymour Island, Antarctica</p></a></li>
<li><a href='#SeymourIslandBins.rdata'><p>Sampling bins approaching and covering the K/Pg boundary on Seymour Island, Antarctica</p></a></li>
<li><a href='#strattotimepointbin'>
<p>Transform Points and Isotope Ratios from Stratigraphic Height into Time (Binned)</p></a></li>
<li><a href='#strattotimepointcont'>
<p>Transform Points and Isotope Ratios from Stratigraphic Height into Time (Continuos)</p></a></li>
<li><a href='#strattotimeratebin'>
<p>Transform patterns from Stratigraphic Height into Time (Binned)</p></a></li>
<li><a href='#strattotimeratecont'>
<p>Transform Patterns from Stratigraphic Height into Time (Continuous)</p></a></li>
<li><a href='#timetostratpointbin'>
<p>Transform Points and Isotope Ratios from Time into Stratigraphic Height (Binned)</p></a></li>
<li><a href='#timetostratpointcont'>
<p>Transform Points and Isotope Ratios from Time into Stratigraphic Height (Continuous)</p></a></li>
<li><a href='#timetostratratebin'>
<p>Transform Patterns from Time into Stratigraphic Height (Binned)</p></a></li>
<li><a href='#timetostratratecont'>
<p>Transform Patterns from Time into Stratigraphic Height (Continuous)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Effects of Changing Deposition Rates</td>
</tr>
<tr>
<td>Version:</td>
<td>2.1.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-03-10</td>
</tr>
<tr>
<td>Author:</td>
<td>Niklas Hohmann</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Niklas Hohmann &lt;Niklas.Hohmann@fau.de&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Reverse and model the effects of changing deposition rates on geological data and rates. Based on Hohmann (2018) &lt;<a href="https://doi.org/10.13140%2FRG.2.2.23372.51841">doi:10.13140/RG.2.2.23372.51841</a>&gt; .</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://creativecommons.org/licenses/by/4.0">CC BY 4.0</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>stats, utils, R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-03-10 12:35:41 UTC; nick</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-03-10 12:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='DAIME-package'>
Effects of Changing Deposition Rates
</h2><span id='topic+DAIME-package'></span><span id='topic+DAIME'></span>

<h3>Description</h3>

<p>Reverse and model the effects of changing deposition rates on geological data and rates. Based on Hohmann (2018) &lt;doi:10.13140/RG.2.2.23372.51841&gt; .
</p>


<h3>Details</h3>

<p>The DESCRIPTION file:
</p>

<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> DAIME</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Title: </td><td style="text-align: left;"> Effects of Changing Deposition Rates</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 2.1.3</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2020-03-10</td>
</tr>
<tr>
 <td style="text-align: left;">
Author: </td><td style="text-align: left;"> Niklas Hohmann</td>
</tr>
<tr>
 <td style="text-align: left;">
Maintainer: </td><td style="text-align: left;"> Niklas Hohmann &lt;Niklas.Hohmann@fau.de&gt;</td>
</tr>
<tr>
 <td style="text-align: left;">
Description: </td><td style="text-align: left;"> Reverse and model the effects of changing deposition rates on geological data and rates. Based on Hohmann (2018) &lt;doi:10.13140/RG.2.2.23372.51841&gt; .</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> CC BY 4.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Depends: </td><td style="text-align: left;"> stats, utils, R (&gt;= 3.5.0)</td>
</tr>
<tr>
 <td style="text-align: left;">
Suggests: </td><td style="text-align: left;"> knitr,
rmarkdown</td>
</tr>
<tr>
 <td style="text-align: left;">
VignetteBuilder: </td><td style="text-align: left;"> knitr</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyData: </td><td style="text-align: left;"> true</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>


<p>Index of help topics:
</p>
<pre>
ColDePalluel            Microcpaleontological, palynological, and
                        geochemical data from the Col de Palluel, SE
                        France (Late Albanian)
DAIME-package           Effects of Changing Deposition Rates
KPgLastOccurrences      Last occurrences for the K/Pg boundary and a
                        potential influence of Deccan volcanism
LakeSuperior            210Pb measurements and derived age models from
                        Lake Superior
SeymourIslandAgeModels
                        Age models for the K/Pg boundary on Seymour
                        Island, Antarctica
SeymourIslandBins       Sampling bins approaching and covering the K/Pg
                        boundary on Seymour Island, Antarctica
patterntodepositionmodel
                        Use sedimentary dilution/condensation of known
                        patterns to create age model
patterntransform        Transform patterns between stratigraphic height
                        and time/age
pointtransform          Transform points between stratigraphic height
                        and time/age
strattotimepointbin     Transform Points and Isotope Ratios from
                        Stratigraphic Height into Time (Binned)
strattotimepointcont    Transform Points and Isotope Ratios from
                        Stratigraphic Height into Time (Continuos)
strattotimeratebin      Transform patterns from Stratigraphic Height
                        into Time (Binned)
strattotimeratecont     Transform Patterns from Stratigraphic Height
                        into Time (Continuous)
timetostratpointbin     Transform Points and Isotope Ratios from Time
                        into Stratigraphic Height (Binned)
timetostratpointcont    Transform Points and Isotope Ratios from Time
                        into Stratigraphic Height (Continuous)
timetostratratebin      Transform Patterns from Time into Stratigraphic
                        Height (Binned)
timetostratratecont     Transform Patterns from Time into Stratigraphic
                        Height (Continuous)
</pre>


<h3>Author(s)</h3>

<p>Niklas Hohmann
</p>
<p>Maintainer: Niklas Hohmann &lt;Niklas.Hohmann@fau.de&gt;
</p>


<h3>References</h3>

<p>Hohmann, Niklas. 2018. Quantifying the Effects of Changing Deposition Rates and Hiatii on the Stratigraphic Distribution of Fossils. &lt;doi:10.13140/RG.2.2.23372.51841&gt;
</p>

<hr>
<h2 id='ColDePalluel.rdata'>Microcpaleontological, palynological, and geochemical data from the Col de Palluel, SE France (Late Albanian)</h2><span id='topic+ColDePalluel'></span>

<h3>Description</h3>

<p>Contains data on geochemistry, palynology, planktic forams, and nannofossils from the Col de Palluel from Bornemann et al. (2005)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ColDePalluel)</code></pre>


<h3>Format</h3>

<p>A list with four entries named &quot;geochemistry&quot;, &quot;palynomorphs&quot;, &quot;nannofossils&quot;, and &quot;plankticforaminifera&quot; containing the data given in Bornemann et al. (2005).
</p>


<h3>Source</h3>

<p>Bornemann, Andre; Pross, Joerg; Reichelt, Kerstin; Herrle, Jens O; Hemleben, Christoph; Mutterlose, Joerg (2005): Micropaleontological investigation of Late Albanian Col de Palluel. PANGAEA, https://doi.org/10.1594/PANGAEA.737945 <a href="https://creativecommons.org/licenses/by/3.0/">CC BY 3.0</a>
</p>


<h3>References</h3>

<p>Bornemann, A et al. (2005): Reconstruction of short-term palaeoceanographic changes during the formation of the Late Albian Niveau Breistroffer black shales (Oceanic Anoxic Event 1d, SE France). Journal of the Geological Society of London, 162(4), 623-639, https://doi.org/10.1144/0016-764903-171
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("ColDePalluel")
#plot carbonate content
plot(ColDePalluel$geochemistry$Depth..m.,ColDePalluel$geochemistry$CaCO3....,type='l')
</code></pre>

<hr>
<h2 id='KPgLastOccurrences.rdata'>Last occurrences for the K/Pg boundary and a potential influence of Deccan volcanism</h2><span id='topic+KPgLastOccurrences'></span>

<h3>Description</h3>

<p>Contains last occurrences generated by a spike in extinction rate at the K/Pg boundary and an influence of Deccan volcanism before that. Relative influence of volcanism ranges from 0% (none), 10 % (weak), 20% (intermediate), 30 % (strong) to 40% (very strong).
Location of Deccan volcanism is based on the extinction interval from Tobin (2017), fig. 5, transformed into time assuming a constant deposition rate.
The last occurrences were generated based on the convolution procedure described in Hohmann (2018) and a rate of fossil occurrences of 40 fossils per Myr.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(KPgLastOccurrences)</code></pre>


<h3>Format</h3>

<p>A list with five entries, each named after the intensity of the early extinction pulse described in Hohmann (in preparation). Each of these entries contains three vectors: 'val' contains the last occurrences per Myr at the ages in 'age', and 'parameters' contains the parameters used to create the pattern of last occurrences.
</p>


<h3>Source</h3>

<p>Hohmann, Niklas. 2018. Quantifying the Effects of Changing Deposition Rates and Hiatii on the Stratigraphic Distribution of Fossils. &lt;doi:10.13140/RG.2.2.23372.51841&gt;.
</p>


<h3>References</h3>

<p>Hohmann, Niklas. (2018). Reversing Time Averaging and Reconstructing Extinction Rates with Approaches from Image Processing. DOI 10.1101/408864. 
</p>
<p>Tobin, Thomas S. &quot;Recognition of a likely two phased extinction at the K-Pg boundary in Antarctica.&quot; Scientific reports 7.1 (2017): 1-11.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(KPgLastOccurrences)
KPgLastOccurrences$Intermediate.Deccan$parameters
plot(KPgLastOccurrences$Intermediate.Deccan$age,
  KPgLastOccurrences$Intermediate.Deccan$val,type='l',
  xlim=rev(range(KPgLastOccurrences$Intermediate.Deccan$age)),xlab='Age [Ma]',
  ylab='Last Occurrences [per Myr]')
</code></pre>

<hr>
<h2 id='LakeSuperiour.rdata'>210Pb measurements and derived age models from Lake Superior</h2><span id='topic+LakeSuperior'></span>

<h3>Description</h3>

<p>Contains lead measurments and the derived age models and sediment accumulation rates from eight cores in Lake Superior (O'Beirne et al. 2017)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(LakeSuperior)</code></pre>


<h3>Format</h3>

<p>A list containing eight data tables, each with the information about one core.
</p>


<h3>Source</h3>

<p>O'Beirne, Molly D; Werne, Josef P; Hecky, Robert E; Johnson, Thomas C; Katsev, Sergei; Reavie, Euan D (2017): 210Pb based age model of sediment core BH03-3. PANGAEA, https://doi.org/10.1594/PANGAEA.874717 <a href="https://creativecommons.org/licenses/by/3.0/">CC BY 3.0</a>
</p>
<p>O'Beirne, Molly D; Werne, Josef P; Hecky, Robert E; Johnson, Thomas C; Katsev, Sergei; Reavie, Euan D (2017): 210Pb based age model of sediment core BH09-2. PANGAEA, https://doi.org/10.1594/PANGAEA.874718 <a href="https://creativecommons.org/licenses/by/3.0/">CC BY 3.0</a>
</p>
<p>O'Beirne, Molly D; Werne, Josef P; Hecky, Robert E; Johnson, Thomas C; Katsev, Sergei; Reavie, Euan D (2017): 210Pb based age model of sediment core BH09-3. PANGAEA, https://doi.org/10.1594/PANGAEA.874719 <a href="https://creativecommons.org/licenses/by/3.0/">CC BY 3.0</a>
</p>
<p>O'Beirne, Molly D; Werne, Josef P; Hecky, Robert E; Johnson, Thomas C; Katsev, Sergei; Reavie, Euan D (2017): 210Pb based age model of sediment core BH09-4. PANGAEA, https://doi.org/10.1594/PANGAEA.874720 <a href="https://creativecommons.org/licenses/by/3.0/">CC BY 3.0</a>
</p>
<p>O'Beirne, Molly D; Werne, Josef P; Hecky, Robert E; Johnson, Thomas C; Katsev, Sergei; Reavie, Euan D (2017): 210Pb based age model of sediment core CM_MC. PANGAEA, https://doi.org/10.1594/PANGAEA.874721 <a href="https://creativecommons.org/licenses/by/3.0/">CC BY 3.0</a>
</p>
<p>O'Beirne, Molly D; Werne, Josef P; Hecky, Robert E; Johnson, Thomas C; Katsev, Sergei; Reavie, Euan D (2017): 210Pb based age model of sediment core EM_MC. PANGAEA, https://doi.org/10.1594/PANGAEA.874722 <a href="https://creativecommons.org/licenses/by/3.0/">CC BY 3.0</a>
</p>
<p>O'Beirne, Molly D; Werne, Josef P; Hecky, Robert E; Johnson, Thomas C; Katsev, Sergei; Reavie, Euan D (2017): 210Pb based age model of sediment core IR_MC. PANGAEA, https://doi.org/10.1594/PANGAEA.874723 <a href="https://creativecommons.org/licenses/by/3.0/">CC BY 3.0</a>
</p>
<p>O'Beirne, Molly D; Werne, Josef P; Hecky, Robert E; Johnson, Thomas C; Katsev, Sergei; Reavie, Euan D (2017): 210Pb based age model of sediment core LG_MC. PANGAEA, https://doi.org/10.1594/PANGAEA.874724 <a href="https://creativecommons.org/licenses/by/3.0/">CC BY 3.0</a>
</p>


<h3>References</h3>

<p>O'Beirne, MD et al. (2017): Anthropogenic climate change has altered primary productivity in Lake Superior. Nature Communications, 8, 15713, https://doi.org/10.1038/ncomms15713
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(LakeSuperior)
plot(LakeSuperior$BH03_3$Depth..m.,LakeSuperior$BH03_3$X210Pb.xs..Bq.kg.,
  xlab='Core depth [m]',ylab='Excess lead [Bq/kg]')
</code></pre>

<hr>
<h2 id='patterntodepositionmodel'>
Use sedimentary dilution/condensation of known patterns to create age model
</h2><span id='topic+patterntodepositionmodel'></span>

<h3>Description</h3>

<p>Takes a pair of a stratigraphic and a temporal pattern to determine the deposition model that transforms them into each other. The deposition model is returned as an age model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>patterntodepositionmodel(xheight, yheight, 
    xage = NULL, yage = NULL,
    heightmode = 'piecewise linear', agemode = 'piecewise linear',
    atheight=NULL,atage=NULL,rescalefor=1,timetype='time')
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="patterntodepositionmodel_+3A_xheight">xheight</code></td>
<td>
<p>A vector of strictly increasing numbers
</p>
</td></tr>
<tr><td><code id="patterntodepositionmodel_+3A_yheight">yheight</code></td>
<td>
<p>A vector of strictly positive numbers. <code>xheight</code> and <code>yheight</code> define the stratigraphic pattern. By default, it is assumed to be piecewise linear and is accordingly given by <code>approxfun(xheight,yheight)</code>. This can be changed to a binned representation using the option <code>heightmode</code> (see below)
</p>
</td></tr>
<tr><td><code id="patterntodepositionmodel_+3A_xage">xage</code></td>
<td>
<p>OPTIONAL, default is <code>NULL</code>
</p>
</td></tr>
<tr><td><code id="patterntodepositionmodel_+3A_yage">yage</code></td>
<td>
<p>OPTIONAL, default is <code>NULL</code>. <code>xage</code> and <code>yage</code> can be used to define the temporal pattern used for the reconstruction of the deposition model. If no input is handed over (default setting), it is assumed that the temporal pattern is constant over a time interval of duration 1. Using the option <code>agemode</code> allows to define both piecewise linear and binned temporal patterns (see below)
</p>
</td></tr>
<tr><td><code id="patterntodepositionmodel_+3A_heightmode">heightmode</code></td>
<td>
<p>OPTIONAL, default is <code>'piecewise linear'</code>. Either <code>'piecewise linear'</code> or <code>'binned'</code>. Determines whether <code>xheight</code> and <code>yheight</code> are taken as a piecewise linear or a binned description of the stratigraphic pattern. In the first case, <code>length(xheight)</code> needs to match <code>length(yheight)</code>, and the stratigraphic pattern is given by <code>approxfun(xheight,yheight)</code>. In the second case, <code>length(xheight)</code> needs to match <code>length(yheight)+1</code>, and the value of the stratigraphic pattern between the stratigraphic heights <code>xheight[i]</code> and <code>xheight[i+1]</code> is given by <code>yheight[i]</code>
</p>
</td></tr>
<tr><td><code id="patterntodepositionmodel_+3A_agemode">agemode</code></td>
<td>
<p>OPTIONAL, default is <code>'piecewise linear'</code>. Either <code>'piecewise linear'</code> or <code>'binned'</code>. Determines whether <code>xage</code> and <code>yage</code> are taken as a piecewise linear or a binned description of the temporal pattern. In the first case, <code>length(xage)</code> needs to match <code>length(yage)</code>, and the temporal pattern is given by <code>approxfun(xage,yage)</code>. In the second case, <code>length(xage)</code> needs to match <code>length(yage)+1</code>, and the value of the temporal pattern between the ages <code>xage[i]</code> and <code>xage[i+1]</code> is given by <code>yage[i]</code>
</p>
</td></tr>
<tr><td><code id="patterntodepositionmodel_+3A_atheight">atheight</code></td>
<td>
<p>OPTIONAL, default is <code>NULL</code>. Stratigraphic heights that should be included in the age model. By default, the function chooses those heights automatically
</p>
</td></tr>
<tr><td><code id="patterntodepositionmodel_+3A_atage">atage</code></td>
<td>
<p>OPTIONAL, default is <code>NULL</code>. Ages that should be included in the age model. By default, the function chooses those ages automatically
</p>
</td></tr>
<tr><td><code id="patterntodepositionmodel_+3A_rescalefor">rescalefor</code></td>
<td>
<p>OPTIONAL, default is 1. Either a strictly positive number, 'temporal pattern', or 'stratigraphic pattern'. Determines what the total input into the sediment is.</p>
</td></tr>
<tr><td><code id="patterntodepositionmodel_+3A_timetype">timetype</code></td>
<td>
<p>OPTIONAL, default is &quot;time&quot;. Either &quot;time&quot; or &quot;age&quot;, determines whether input/output will be interpreted/given as time or age
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>timetype='time'</code>, a list containing the following entries:
</p>
<table>
<tr><td><code>time</code></td>
<td>
<p>Vector of times</p>
</td></tr>
<tr><td><code>height</code></td>
<td>
<p>Vector of stratigraphic heights</p>
</td></tr>
<tr><td><code>report</code></td>
<td>
<p>A short summary of the task performed</p>
</td></tr>
</table>
<p>If <code>timetype='age'</code>, a list containing the following entries:
</p>
<table>
<tr><td><code>age</code></td>
<td>
<p>Vector of ages</p>
</td></tr>
<tr><td><code>height</code></td>
<td>
<p>Vector of stratigraphic heights</p>
</td></tr>
<tr><td><code>report</code></td>
<td>
<p>A short summary of the task performed</p>
</td></tr>
</table>
<p><code>age</code>/<code>time</code> and <code>height</code> form the age model in the sense that the age/time at which <code>height[i]</code> was deposited is given by <code>age[i]</code>/<code>time[i]</code>. Conversely at the age/time <code>age[i]</code>/<code>time[i]</code>, <code>height[i]</code> was deposited
</p>


<h3>Author(s)</h3>

<p>Niklas Hohmann
</p>


<h3>References</h3>

<p>Hohmann, Niklas. 2018. Quantifying the Effects of Changing Deposition Rates and Hiatii on the Stratigraphic Distribution of Fossils. &lt;doi:10.13140/RG.2.2.23372.51841&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pointtransform">pointtransform</a></code> for the transformations of points using age models
</p>
<p><code><a href="#topic+patterntransform">patterntransform</a></code> for the transformations of temporal and stratigraphic patterns (such as input rates into the sediment) using age models
</p>
<p>For an overview of the functions in the DAIME package and examples using stratigraphic data see the vignette (available via <code>vignette('DAIME')</code> )
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Reconstruct deposition model based on condensation/dilution of a constant input
#assume a constant input of pollen (this is an arbitrary choice) into the sediment through time
#this is the observed stratigraphic pattern
my.xheight=seq(0,10,by=1)
my.yheight=seq(0,3,length.out=11)+rexp(11)
plot(my.xheight,my.yheight,xlab='Stratigraphic Height',ylab='Pollen Abundance',type='l',
  ylim=c(0,max(my.yheight)),main='Stratigraphic Pattern')
#reconstruct deposition model based on the assumption of constant pollen input in time
my.agemodel=patterntodepositionmodel(xheight=my.xheight,yheight=my.yheight)
my.agemodel$report
agemodelage=my.agemodel$time
agemodelheight=my.agemodel$height
plot(agemodelage,agemodelheight,type='l',
  lwd=6,main='Reconstructed Deposition Models as Age Model')
legend('topleft',legend='Age Model',lwd=6,col='black')
#approximate deposition rate (=derivative of the age model)
grad=diff(agemodelheight)/diff(agemodelage)
xbase=agemodelage[-1]
plot(xbase,grad,xlab='Time',ylab='Deposition Rate',
  main='Reconstructed Deposition Model as Deposition Rate',type='l',lwd=6,ylim=c(0,max(grad)))

#now assume pollen input into the sediment is decreasing and lasts for 2 time units
my.xage=c(0,2)
my.yage=c(5,1)
plot(my.xage,my.yage,type='l',xlab='Time',ylab='Pollen Input',ylim=c(0,max(my.yage)),
  lwd=6,main='Temporal Pattern')
#reconstruct age model based on these updated assumptions
my.agemodel2=patterntodepositionmodel(xheight=my.xheight,yheight=my.yheight,
    xage=my.xage,yage=my.yage)
my.agemodel2$report
agemodelage2=my.agemodel2$time
agemodelheight2=my.agemodel2$height
plot(agemodelage2,agemodelheight2,type='l',lwd=6, 
  main='Reconstructed Deposition Model as Age Model')
legend('topleft',legend='Age Model',lwd=6,col='black')

#if a pattern is given as bins, use the option 'heightmode' or 'agemode'
#define stratigraphic pattern as binned function
my.xheight3=seq(0,10,length.out=11) #borders of the bins used to define the stratigraphic pattern
my.yheight3=seq(0,3,length.out=10)+rexp(10) #note that xheight has one element more than yheight
barplot(my.yheight3,width=diff(my.xheight3),ylab='Pollen Abundance',xlab='Stratigraphic Height',
  space=0,main='Stratigraphic Pattern')
#reconstruct age model as in the first example, but with the binned pollen observation 
#  in stratigraphic height
#Note that pollen input in time is again assumed to be constant 
#(default setting if no xage and yage given)
my.agemodel3=patterntodepositionmodel(xheight=my.xheight3,yheight=my.yheight3,heightmode='binned')
my.agemodel3$report
agemodelage3=my.agemodel3$time
agemodelheight3=my.agemodel3$height
plot(agemodelage3,agemodelheight3,type='l',lwd=6,
  main='Reconstructed Deposition Model as Age Model')
legend('topleft',legend='Age Model',lwd=6,col='black')
#The same option is also available for the temporal pattern (no example given)

</code></pre>

<hr>
<h2 id='patterntransform'>
Transform patterns between stratigraphic height and time/age
</h2><span id='topic+patterntransform'></span>

<h3>Description</h3>

<p>This function (1) takes temporal patterns and determines the corresponding stratigraphic patterns or (2) takes stratigraphic patterns and reconstructs the underlying temporal patterns.
</p>
<p>These patterns can for example be rates of (first/last) fossil occurrences, rates of morphological change, or input rates into the sediment, e.g. of geochemical proxies.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>patterntransform ( xdep , ydep , xpat , ypat ,  direction = 'time to height' ,
depositionmodel = 'piecewise linear deposition rate' ,  patternmode = 'piecewise linear' ,
pos=NULL , hiatuslist=list() ,unit = 'time per sediment',timetype='time' )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="patterntransform_+3A_xdep">xdep</code></td>
<td>

<p>Vector of strictly increasing real numbers
</p>
</td></tr>
<tr><td><code id="patterntransform_+3A_ydep">ydep</code></td>
<td>

<p>Vector of real numbers. <code>xdep</code> and <code>ydep</code> describe the deposition model, and how they are interpreted depends on the option <code>depositionmodel</code> (and when <code>direction='height to time'</code>, also on the option <code>unit</code>). By default, <code>xdep</code> and <code>ydep</code> describe a piecewise linear deposition rate, i.e. <code>deporate=approxfun(xdep,ydep)</code>. For more options on how to describe deposition models, see <code>depositionmodel</code> below
</p>
</td></tr>
<tr><td><code id="patterntransform_+3A_xpat">xpat</code></td>
<td>

<p>Vector of strictly increasing real numbers
</p>
</td></tr>
<tr><td><code id="patterntransform_+3A_ypat">ypat</code></td>
<td>

<p>Vector containing positive real numbers. <code>xpat</code> and <code>ypat</code> describe the pattern to be transformed. By default, it is taken to be piecewise linear and is accordingly given by <code>pattern=approxfun(xpat,ypat)</code>. The option <code>patternmode</code> allows to change to binned patterns (see below). Whether the input pattern is a temporal or a stratigraphic pattern is determined by <code>direction</code>
</p>
</td></tr>
<tr><td><code id="patterntransform_+3A_direction">direction</code></td>
<td>
<p>OPTIONAL, default is <code>'time to height'</code>. Determines the direction of the transformation. Either <code>'time to height'</code> (in which case the input pattern described by <code>xpat</code> and <code>ypat</code> is interpreted as a temporal pattern and will be transformed into a stratigraphic pattern) or <code>'height to time'</code> (in which case the input pattern described by <code>xpat</code> and <code>ypat</code> is interpreted as a stratigraphic pattern and will be transformed into a temporal pattern) 
</p>
</td></tr>
<tr><td><code id="patterntransform_+3A_depositionmodel">depositionmodel</code></td>
<td>
<p>OPTIONAL, default is <code>'piecewise linear deposition rate'</code>. Either <code>'piecewise linear deposition rate'</code>, <code>'binned deposition rate'</code>, or <code>'age model'</code>. Determines how the input of <code>xdep</code> and <code>ydep</code> is interpreted. Dependent on the choice of <code>direction</code> and <code>depositionmodel</code>, different restrictions on the input of <code>ydep</code> exist, for details and examples see the vignette (available via <code>vignette('DAIME') or the error messages</code>
</p>
</td></tr>
<tr><td><code id="patterntransform_+3A_patternmode">patternmode</code></td>
<td>
<p>OPTIONAL, default is <code>'piecewise linear'</code>. Either <code>'piecewise linear'</code> or <code>'binned'</code>. Determines whether <code>xpat</code> and <code>ypat</code> are taken as a piecewise linear or a binned description of the pattern. In the first case, <code>length(xpat)</code> needs to match <code>length(ypat)</code>, and the pattern is given by <code>approxfun(xpat,ypat)</code>. In the second case, <code>length(xpat)</code> needs to match <code>length(ypat)+1</code>, and the value of the pattern between the <code>xpat[i]</code> and <code>xpat[i+1]</code> is given by <code>ypat[i]</code>
</p>
</td></tr>
<tr><td><code id="patterntransform_+3A_pos">pos</code></td>
<td>
<p>OPTIONAL, default is <code>NULL</code>. A vector of points that will be transformed and then used determine the value of the pattern at these points. In the default setting, the number and location of points is chosen automatically
</p>
</td></tr>
<tr><td><code id="patterntransform_+3A_hiatuslist">hiatuslist</code></td>
<td>

<p>OPTIONAL, default is an empty list. List of hiatuses to be included into the transformation, only used when <code>direction='height to time'</code>, e.g. the transformation is from stratigraphic height to time. A list, containing vectors of length two as elements. Every element in the list corresponds to a hiatus: <code>hiatuslist[[i]][1]</code> is the stratigraphic height of the i-th hiatus, and <code>hiatuslist[[i]][2]</code> is its duration
</p>
</td></tr>
<tr><td><code id="patterntransform_+3A_unit">unit</code></td>
<td>

<p>OPTIONAL, default is 'sediment per time'. Only used when <code>direction='height to time'</code>, e.g. the transformation is from stratigraphic height to time, and <code>deposition model</code> is <code>'piecewise linear deposition rate'</code> or <code>'binned deposition rate'</code>. Either <code>'sediment per time'</code> or <code>'time per sediment'</code>. Determines the unit of the (binned or piecewise linear) deposition rate in the sense that if <code>unit='sediment per time'</code>, the deposition rate describes the deposition rate with which a given point in the section was deposited. If <code>unit='time per sediment'</code>, the deposition rate describes the time needed to deposit one unit of sediment
</p>
</td></tr>
<tr><td><code id="patterntransform_+3A_timetype">timetype</code></td>
<td>
<p>OPTIONAL, default is &quot;time&quot;. Either &quot;time&quot; or &quot;age&quot;, determines whether input/output will be interpreted/given as time or age
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list with two elements. If <code>direction='time to height'</code>, these elements are
</p>
<table>
<tr><td><code>height</code></td>
<td>
<p>vector containing stratigraphic heights</p>
</td></tr>
<tr><td><code>val</code></td>
<td>
<p>vector containing the values of the stratigraphic pattern (=transformed temporal pattern) at the stratigraphic heights given by <code>height</code></p>
</td></tr>
<tr><td><code>report</code></td>
<td>
<p>A short summary of the task performed</p>
</td></tr>
</table>
<p>If <code>direction='height to time'</code> and <code>timetype='time'</code>, these elements are
</p>
<table>
<tr><td><code>time</code></td>
<td>
<p>vector containing points in time</p>
</td></tr>
<tr><td><code>val</code></td>
<td>
<p>vector containing the values of the temporal pattern (=transformed stratigraphic pattern) at the points in time given by <code>time</code></p>
</td></tr>
<tr><td><code>report</code></td>
<td>
<p>A short summary of the task performed</p>
</td></tr>
</table>
<p>If <code>direction='height to time'</code> and <code>timetype='age'</code>, these elements are
</p>
<table>
<tr><td><code>age</code></td>
<td>
<p>vector containing ages</p>
</td></tr>
<tr><td><code>val</code></td>
<td>
<p>vector containing the values of the temporal pattern (=transformed stratigraphic pattern) at the ages given by <code>age</code></p>
</td></tr>
<tr><td><code>report</code></td>
<td>
<p>A short summary of the task performed</p>
</td></tr>
</table>
<p>Output of <code>NA</code> in <code>age</code>,<code>time</code>, <code>height</code>, or <code>val</code> indicates that some values coincide with a hiatus or intervals where the deposition model is undefined.
</p>


<h3>Author(s)</h3>

<p>Niklas Hohmann
</p>


<h3>References</h3>

<p>Hohmann, Niklas. 2018. Quantifying the Effects of Changing Deposition Rates and Hiatii on the Stratigraphic Distribution of Fossils. &lt;doi:10.13140/RG.2.2.23372.51841&gt;
</p>


<h3>See Also</h3>

<p>For an overview of the functions in the DAIME package and examples using stratigraphic data see the vignette (available via <code>vignette('DAIME')</code> )
</p>
<p><code><a href="#topic+pointtransform">pointtransform</a></code> for the transformation of points
</p>
<p><code><a href="#topic+patterntodepositionmodel">patterntodepositionmodel</a></code> to create deposition models based in sedimentary dilution/condensation of known patterns
</p>
<p><code><a href="#topic+strattotimeratebin">strattotimeratebin</a></code>, <code><a href="#topic+strattotimeratecont">strattotimeratecont</a></code>, <code><a href="#topic+timetostratratebin">timetostratratebin</a></code>, and  <code><a href="#topic+timetostratratecont">timetostratratecont</a></code> for diverse (outdated) wrappers of <code>patterntransform</code>. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Example 1: transform patterns from time into the section
##define (piecewise linear) deposition rate
my.xdep=seq(0,12,length.out=100)
my.ydep=splinefunH(x=c(0,2,4,6,8,10,12),y=c(1,5,6,1,0.5,1,6),m=c(0,1.5,-0.5,-0.5,0,0.5,0))(my.xdep)
#Plot deposition rate
plot(my.xdep,my.ydep,type='l',main='Deposition Rate',xlab='Time', ylab='Sediment per Time Unit',
  ylim=c(0,max(my.ydep))) 
##define (piecewise linear) temporal pattern, here fossil occurrences
patternname='Fossil Occurrences'
my.temp.pat.x= seq(from=min(my.xdep),to=max(my.xdep),length.out=100)
my.temp.pat.y=splinefunH(x=c(0,4,12),y=c(0.5,2,0.5),m=c(0,0,0))(my.temp.pat.x)  

plot(my.temp.pat.x,my.temp.pat.y,type='l',main=paste(patternname,'in time'),
  xlab='Time',ylab=patternname,ylim=c(0,max(my.temp.pat.y)))
##transform temporal pattern into stratigraphic pattern
strat.pat=patterntransform(xdep=my.xdep,ydep=my.ydep,xpat=my.temp.pat.x,ypat=my.temp.pat.y,
  direction = 'time to height' , depositionmodel = 'piecewise linear deposition rate' ,
  patternmode = 'piecewise linear')
strat.pat$report
my.strat.pat.x=strat.pat$height
my.strat.pat.y=strat.pat$val
plot(my.strat.pat.x,my.strat.pat.y,type='l',xlab='Stratigraphic Height',
ylab=patternname, main=paste(patternname,' in the section'))

## Variation: modify deposition rate to include erosion
my.xdep2=my.xdep
my.ydep2=splinefunH(x=c(0,2,4,6,8,10,12),y=c(1,5,6,-2,5,1,6),m=c(0,1.5,-0.5,-0.5,0,0.5,0))(my.xdep2)
#Plot deposition rate
plot(my.xdep2,my.ydep2,type='l',main='Deposition Rate',xlab='Time',ylab='Sediment per Time Unit')
lines(range(my.xdep2),c(0,0))
strat.pat2=patterntransform(xdep=my.xdep2,ydep=my.ydep2,xpat=my.temp.pat.x,ypat=my.temp.pat.y,
  direction = 'time to height' , depositionmodel = 'piecewise linear deposition rate' ,
  patternmode = 'piecewise linear')
strat.pat2$report
my.strat.pat.x2=strat.pat2$height
my.strat.pat.y2=strat.pat2$val
plot(my.strat.pat.x2,my.strat.pat.y2,type='l',xlab='Stratigraphic Height',
  ylab=patternname,main=paste(patternname,' in the section'),ylim=c(0,1))
#the spike is because the deposition rate is very small when it transitions from 
#negative to positive, generating a punctual extreme condensation

### Example 2: Transform patterns from the section into time
patternname='Fossil Occurrences'
#piecewise linear deposition rate
my.xdep=seq(0,12,length.out=100)
my.ydep=splinefunH(x=c(0,2,4,6,8,10,12),y=c(1,5,6,1,0.5,1,6),m=c(0,1.5,-0.5,-0.5,0,0.5,0))(my.xdep)
## Same pattern, this time interpreted as stratigraphic pattern
my.strat.pat.x= seq(from=min(my.xdep),to=max(my.xdep),length.out=100)
my.strat.pat.y=splinefunH(x=c(0,4,12),y=c(0.5,2,0.5),m=c(0,0,0))(my.strat.pat.x)
plot(my.strat.pat.x,my.strat.pat.y,type='l',main=paste(patternname,'in the section'),
  xlab='Stratigraphic Height',ylab=patternname,ylim=c(0,max(my.strat.pat.y)))

##interpret deposition rate as inverse deposition rate with the unit "time per sediment"
usedunit='time per sediment'
plot(my.xdep,my.ydep,type='l',main=paste('Deposition Rate as',usedunit),
  xlab='Stratigraphic Height',ylab=usedunit,ylim=c(0,max(my.ydep)))
#transform pattern
temp.pat1=patterntransform(xdep=my.xdep,ydep=my.ydep,xpat=my.strat.pat.x,ypat=my.strat.pat.y,
  direction = 'height to time' , depositionmodel = 'piecewise linear deposition rate' ,
  patternmode = 'piecewise linear', unit=usedunit)
temp.pat1$report
#plot result
plot(temp.pat1$time,temp.pat1$val,type='l',xlab='Time',
  ylab=patternname,main=paste(patternname, 'in time'),ylim=c(0,max(temp.pat1$val)))
  
##take the deposition rate as ordinary deposition rate with unit "sediment per time"
usedunit='sediment per time'
plot(my.xdep,my.ydep,type='l',main=paste('Deposition Rate as',usedunit),
xlab='Stratigraphic Height',ylab=usedunit,ylim=c(0,max(my.ydep)))
#transform pattern
temp.pat2=patterntransform(xdep=my.xdep,ydep=my.ydep,xpat=my.strat.pat.x,ypat=my.strat.pat.y,
  direction = 'height to time' ,depositionmodel = 'piecewise linear deposition rate' ,
  patternmode = 'piecewise linear', unit=usedunit)
temp.pat2$report
#plot result
plot(temp.pat2$time,temp.pat2$val,type='l',xlab='Time',
  ylab=patternname,main=paste(patternname, 'in time'),ylim=c(0,max(temp.pat2$val)))
#Note the big difference in the resulting patterns in time depending on the unit used.

</code></pre>

<hr>
<h2 id='pointtransform'>
Transform points between stratigraphic height and time/age
</h2><span id='topic+pointtransform'></span>

<h3>Description</h3>

<p>This function (1) takes times/ages and determines the stratigraphic heights that were deposited at said times/ages or (2) takes stratigraphic heights and determines their time/age of deposition.
</p>
<p>This can be used to (1) reconstruct the age/time/stratigraphic height of single objects placed in the sediment (2) construct age models from deposition rates and (3) transform (isotope) ratios or percentages from stratigraphic height into time/age and vice versa (see examples).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pointtransform( points , xdep , ydep ,
  direction = 'time to height' , depositionmodel = 'piecewise linear deposition rate' ,
  hiatuslist = list() , unit = 'time per sediment', timetype='time')
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pointtransform_+3A_points">points</code></td>
<td>

<p>Vector containing points that are transformed. Whether the entries in <code>points</code> are interpreted as stratigraphic heights or as times/ages depends on the option <code>direction</code> and <code>timetype</code>.
</p>
</td></tr>
<tr><td><code id="pointtransform_+3A_xdep">xdep</code></td>
<td>

<p>Vector of strictly increasing real numbers 
</p>
</td></tr>
<tr><td><code id="pointtransform_+3A_ydep">ydep</code></td>
<td>

<p>Vector of real numbers. <code>xdep</code> and <code>ydep</code> describe the deposition model, and how they are interpreted depends on the option <code>depositionmodel</code> (and when <code>direction='height to time'</code>, also on the option <code>unit</code>). By default, <code>xdep</code> and <code>ydep</code> describe a piecewise linear deposition rate, i.e. <code>deporate=approxfun(xdep,ydep)</code>. For more options on how to describe deposition models, see <code>depositionmodel</code>
</p>
</td></tr>
<tr><td><code id="pointtransform_+3A_direction">direction</code></td>
<td>
<p>OPTIONAL, default is <code>'time to height'</code>. Determines the direction of the transformation. Either <code>'time to height'</code> (in which case the input given by <code>points</code> corresponds to ages/times) or <code>'height to time'</code> (in which case the input of <code>points</code> corresponds to stratigraphic heights)
</p>
</td></tr>
<tr><td><code id="pointtransform_+3A_depositionmodel">depositionmodel</code></td>
<td>
<p>OPTIONAL, default is <code>'piecewise linear deposition rate'</code>. Either <code>'piecewise linear deposition rate'</code>, <code>'binned deposition rate'</code>, or <code>'age model'</code>. Determines how the input of <code>xdep</code> and <code>ydep</code> is interpreted. Dependent on the choice of <code>direction</code> and <code>depositionmodel</code>, different restrictions on the input of <code>ydep</code> exist, for details and examples see the vignette (available via <code>vignette('DAIME') or the error messages</code>
</p>
</td></tr>
<tr><td><code id="pointtransform_+3A_hiatuslist">hiatuslist</code></td>
<td>

<p>OPTIONAL, default is an empty list. List of hiatuses to be included into the transformation, only used when <code>direction='height to time'</code>, e.g. the transformation is from stratigraphic height to time. A list, containing vectors of length two as elements. Every element in the list corresponds to a hiatus: <code>hiatuslist[[i]][1]</code> is the stratigraphic height of the i-th hiatus, and <code>hiatuslist[[i]][2]</code> is its duration
</p>
</td></tr>
<tr><td><code id="pointtransform_+3A_unit">unit</code></td>
<td>

<p>OPTIONAL, default is 'sediment per time'. Only used when <code>direction='height to time'</code>, e.g. the transformation is from stratigraphic height to time, and <code>depositionmodel</code> is <code>'piecewise linear deposition rate'</code> or <code>'binned deposition rate'</code>. Either <code>'sediment per time'</code> or <code>'time per sediment'</code>. Determines the unit of the (binned or piecewise linear) deposition rate. If <code>unit='sediment per time'</code>, the deposition rate describes the deposition rate with which a given point in the section was deposited. If <code>unit='time per sediment'</code>, the deposition rate describes the time needed to deposit one unit of sediment (also know as the inverse deposition rate)
</p>
</td></tr>
<tr><td><code id="pointtransform_+3A_timetype">timetype</code></td>
<td>
<p>OPTIONAL, default is &quot;time&quot;. Either &quot;time&quot; or &quot;age&quot;, determines whether input/output will be interpreted/given as time or age
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>timetype='time'</code> a list containing:
</p>
<table>
<tr><td><code>time</code></td>
<td>
<p>Vector containing the times at which the stratigraphic heights in <code>height</code> were deposited</p>
</td></tr>
<tr><td><code>height</code></td>
<td>
<p>Vector containing stratigraphic heights that were deposited at the times given in <code>time</code></p>
</td></tr>
<tr><td><code>report</code></td>
<td>
<p>A short summary of the task performed</p>
</td></tr>
</table>
<p>If <code>timetype='age'</code> a list containing:
</p>
<table>
<tr><td><code>age</code></td>
<td>
<p>Vector containing the ages at which the stratigraphic heights in <code>height</code> were deposited</p>
</td></tr>
<tr><td><code>height</code></td>
<td>
<p>Vector containing stratigraphic heights that were deposited at the ages given in <code>age</code></p>
</td></tr>
<tr><td><code>report</code></td>
<td>
<p>A short summary of the task performed</p>
</td></tr>
</table>
<p>If <code>direction='time to height'</code>, <code>age</code>/<code>time</code> is a duplicate of the input <code>points</code>, and <code>height</code> contains the stratigraphic heights that were deposited at the ages/times given by <code>points</code>.
</p>
<p>If <code>direction='height to time'</code>, <code>height</code> is a duplicate of the input <code>points</code>, and <code>age</code>/<code>time</code> contains the ages/times at which the stratigraphic height given by <code>points</code> were deposited.
</p>
<p>Output of <code>NA</code> in a vector indicates that the transformation was unsuccessful. This happens when entries of <code>points</code> coincide with a hiatus or are not in the domain of definition of the deposition model.
</p>


<h3>Author(s)</h3>

<p>Niklas Hohmann
</p>


<h3>References</h3>

<p>Hohmann, Niklas. 2018. Quantifying the Effects of Changing Deposition Rates and Hiatii on the Stratigraphic Distribution of Fossils. &lt;doi:10.13140/RG.2.2.23372.51841&gt;
</p>


<h3>See Also</h3>

<p>For an overview of the functions in the DAIME package and examples using stratigraphic data see the vignette (available via <code>vignette('DAIME')</code> )
</p>
<p><code><a href="#topic+patterntransform">patterntransform</a></code> for the transformation of input rates (stratigraphic patterns into temporal patterns and vice versa)
</p>
<p><code><a href="#topic+patterntodepositionmodel">patterntodepositionmodel</a></code> to create deposition models based on sedimentary dilution/condensation of known patterns
</p>
<p><code><a href="#topic+strattotimepointbin">strattotimepointbin</a></code>, <code><a href="#topic+strattotimepointcont">strattotimepointcont</a></code>, <code><a href="#topic+timetostratpointbin">timetostratpointbin</a></code>, and  <code><a href="#topic+timetostratpointcont">timetostratpointcont</a></code> for diverse (outdated) wrappers of <code>pointtransform</code>. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Example 1: Determine age/stratigraphic height of single objects
##define deposition rate
my.xdep=seq(0,12,length.out=100)
my.ydep=splinefunH(x=c(0,2,4,6,8,10,12),y=c(1,5,6,1,0.5,1,6),m=c(0,1.5,-0.5,-0.5,0,0.5,0))(my.xdep)
#unit of deposition rate is sediment per time unit (default setting)
usedunit='sediment per time' #unit of deposition rate is sediment per time unit (default setting)
#Plot deposition rate (in stratigraphic height)
plot(my.xdep,my.ydep,type='l',main='Deposition Rate',xlab='Stratigraphic Height',ylab=usedunit,
  ylim=c(0,max(my.ydep)))
##at what time was the object found at stratigraphic height 9 deposited?
#using default setting for depositionmodel (depositionmodel = 'piecewise linear deposition rate')
pointtransform(points=9,xdep=my.xdep,ydep=my.ydep,direction='height to time', unit=usedunit) 
#change unit used
usedunit='time per sediment'
pointtransform(points=9,xdep=my.xdep,ydep=my.ydep,direction='height to time', unit=usedunit) 
#note how different the results are!
##Now, take deposition rate as deposition rate in time
##at what stratigraphic height will an object appear that was deposited at time 5?
pointtransform(points=5,xdep=my.xdep,ydep=my.ydep,direction='time to height') 
#The option "unit" is unused when transforming from time to height

### Example 2: Create Age models based on a deposition rate
##create an age model. Essentially transform many points, which then approximate the age model
stratheights=seq(min(my.xdep),max(my.xdep),length.out=1000) #many points to approx. age model
usedunit='sediment per time'
reslist=pointtransform(points=stratheights,xdep=my.xdep,ydep=my.ydep,
  direction='height to time',unit=usedunit)
reslist$report
agemodelage=reslist$time
agemodelheight=reslist$height
#plot age model
plot(agemodelage,agemodelheight,xlab='Time',ylab='Stratigraphic Height',
  main=paste('Age model based on deposition rate \n with unit',usedunit))
  
#create age model but with other units for sedimentn input
usedunit='time per sediment'
reslist=pointtransform(points=stratheights,xdep=my.xdep,ydep=my.ydep,
  direction='height to time',unit=usedunit)
reslist$report
agemodelage=reslist$time
agemodelheight=reslist$height
#plot age model (note the difference the setting of unit makes in terms of time 
#required to deposit the section!)
plot(agemodelage,agemodelheight,xlab='Time',ylab='Stratigraphic Height',
  main=paste('Age model based on deposition rate \n with unit',usedunit))

##create age model with a hiatus 1: height to time
stratigraphicheight=5 #strat. height of the hiatus
duration=10 #duration of the hiatus
my.hiatuslist=list(c(stratigraphicheight,duration)) #required input format for hiatuses
reslist=pointtransform(points=stratheights,xdep=my.xdep,ydep=my.ydep,
  direction='height to time',hiatuslist=my.hiatuslist)
reslist$report
agemodelage=reslist$time
agemodelheight=reslist$height
#!using default setting for unit (sediment per time) again!
plot(agemodelage,agemodelheight,xlab='Time',ylab='stratigraphic height')
#the gap corresponds to the hiatus

##create age model with a hiatus 2: time to height
my.xdep2=c(0,6,8,12)
my.ydep2=c(0,6,5,12)
plot(my.xdep2,my.ydep2,type='l',main='Age Model, not eroded',xlab='time',ylab='height')
reslist=pointtransform(points=stratheights,xdep=my.xdep2,ydep=my.ydep2,
  direction='time to height',depositionmodel='age model')
reslist$report
agemodelage=reslist$time
agemodelheight=reslist$height
plot(agemodelage,agemodelheight,xlab='Time',ylab='stratigraphic height'
  ,main='Age model, eroded (with hiatus)')

###Example 3: Transform (isotope) ratios
##define deposition rate
my.xdep3=seq(0,12,length.out=100)
my.ydep3=splinefunH(x=c(0,2,4,6,8,10,12),y=c(1,5,6,1,0.5,1,6),
  m=c(0,1.5,-0.5,-0.5,0,0.5,0))(my.xdep3)
#create fake (oxygen) isotope curves
samplelocation=seq(0,12,length.out=20) #where the samples are taken
isotoperatio=(-1)^(0:19) +0.2*0:19
plot(my.xdep3,my.ydep3,type='l',ylim=c(0,7),xlab='Stratigraphic Height',ylab='')
lines(samplelocation,isotoperatio,type='l',lwd=4)
legend('topleft',lwd=c(1,4),legend=c('Deposition rate','(Isotope) ratio'))
#transform only (!) sample locations, NOT values 
#again using the default setting for unit
reslist=pointtransform(points=samplelocation,xdep=my.xdep3,ydep=my.ydep3,
  direction='height to time')
#Isotope ratios in time 
plot(reslist$time,isotoperatio,type='l',xlab='Time',ylab='Isotope Ratio',lwd=4)

</code></pre>

<hr>
<h2 id='SeymourIslandAgeModels'>Age models for the K/Pg boundary on Seymour Island, Antarctica</h2><span id='topic+SeymourIslandAgeModels'></span>

<h3>Description</h3>

<p>Contains age models for the extinction at the K/Pg boundary on Seymour Island, Antarctica. Age models are based on
</p>
<p>*the Stratigraphic height of the K/Pg boundary of 1007.5 m with an age of 66.04 Ma (Renne et al. 2013)
</p>
<p>*magnetostratigraphy from Tobin et al. (2012) and ages from Gradstein et al. (2012), yielding an age of 66.389 Ma at the stratigraphic height of 934.4 m.
</p>
<p>The stratigraphic height of a low deposition interval is assumed to be at 959.5 m based on section A from Witts et al. (2016).
</p>
<p>Reference for stratigraphic heights is the composite section by Witts et al. (2016).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(SeymourIslandBins)</code></pre>


<h3>Format</h3>

<p>A list with entries named after the age models described in Hohmann (in preparation). Each of these age models consists of three vectors: 'age' and 'height' correspond to the age of deposition of a given stratigraphic height, and 'parameters' contains a description of the parameters used to generate the age models
</p>


<h3>Source</h3>

<p>Gradstein, Felix M., et al., eds. The geologic time scale 2012. elsevier, 2012.
</p>
<p>Renne, Paul R., et al. &quot;Time scales of critical events around the Cretaceous-Paleogene boundary.&quot; Science 339.6120 (2013): 684-687.
</p>
<p>Tobin, Thomas S., et al. &quot;Extinction patterns, delta18 O trends, and magnetostratigraphy from a southern high-latitude Cretaceous/Paleogene section: Links with Deccan volcanism.&quot; Palaeogeography, Palaeoclimatology, Palaeoecology 350 (2012): 180-188.
</p>
<p>Hohmann, Niklas. 2018. Quantifying the Effects of Changing Deposition Rates and Hiatii on the Stratigraphic Distribution of Fossils. &lt;doi:10.13140/RG.2.2.23372.51841&gt;.
</p>
<p>Witts, James D., et al. &quot;Macrofossil evidence for a rapid and severe Cretaceous/Paleogene mass extinction in Antarctica.&quot; Nature communications 7 (2016): 11738.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("SeymourIslandAgeModels")
#Select age model B
my.agemodel=SeymourIslandAgeModels$B
#check parameters of age model
my.agemodel$parameters
plot(my.agemodel$age,my.agemodel$height,type='l',
  xlim=rev(range(my.agemodel$age)),xlab='Age [Ma]',ylab='Stratigraphic Height [m]')
</code></pre>

<hr>
<h2 id='SeymourIslandBins.rdata'>Sampling bins approaching and covering the K/Pg boundary on Seymour Island, Antarctica</h2><span id='topic+SeymourIslandBins'></span>

<h3>Description</h3>

<p>Contains the sampling bins from Seymour Island from
</p>

<ul>
<li><p> Macellari (1984), section D 
</p>
</li>
<li><p> Witts et al. (2016), section A
</p>
</li></ul>

<p>Reference for stratigraphic heights is the composite section by Witts et al. (2016) with the K/Pg boundary at 1007.5 m. The bins from Macellari were correlated using the glauconite bed and the last ammonite occurrences at the K/PG boundary (Macellari 1984, p. 506 and 518, samples 401,402, and 403).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(SeymourIslandBins)</code></pre>


<h3>Format</h3>

<p>A list with two entries: One corresponding to the bins from Macellari (1984), the other to the bins from Witts et al. (2016)
</p>


<h3>Source</h3>

<p>Macellari, Carlos E. Late Cretaceous stratigraphy, sedimentology, and macropaleontology of Seymour Island, Antarctic Peninsula. Diss. The Ohio State University, 1984.
</p>
<p>Witts, James D., et al. &quot;Macrofossil evidence for a rapid and severe Cretaceous/Paleogene mass extinction in Antarctica.&quot; Nature communications 7 (2016): 11738.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("SeymourIslandBins")
#Compare bins from Macellari and Witts before the K/Pg extinction
plot(SeymourIslandBins$Macellari.1984.Section.D.,
  rep(0,length(SeymourIslandBins$Macellari.1984.Section.D.)),
  ylim=c(0,1.1),xlab='Stratigraphic Height [m]',xlim=c(930,1007.5))
points(SeymourIslandBins$Witts.et.al.2016.Section.A,
  rep(0.2,length(SeymourIslandBins$Witts.et.al.2016.Section.A)),pch=19)
lines(c(1007.5,1007.5),c(0,2))
legend('topleft',pch=c(1,19,NA),lty=c(NA,NA,1),legend=c('Macellari','Witts','K/Pg boundary'))
</code></pre>

<hr>
<h2 id='strattotimepointbin'>
Transform Points and Isotope Ratios from Stratigraphic Height into Time (Binned)
</h2><span id='topic+strattotimepointbin'></span>

<h3>Description</h3>

<p>This function takes a binned deposition rate and reconstructs at what time a given stratigraphic height was deposited. Essentially a wrapper of <code>pointtransform(...,direction='height to time',depositionmodel='binned deposition rate')</code> kept for backwards compatibility of the package. It is recommended to use <code>pointtransform</code> instead of this function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>strattotimepointbin(x, binborder, depoval, hiatuslist = list(),
  unit = "sediment per time")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="strattotimepointbin_+3A_x">x</code></td>
<td>

<p>Vector containing the stratigraphic heights whose time of deposition are to be determined
</p>
</td></tr>
<tr><td><code id="strattotimepointbin_+3A_binborder">binborder</code></td>
<td>

<p>Vector of strictly increasing numerical values. Defines the borders of the bins in stratigraphic height
</p>
</td></tr>
<tr><td><code id="strattotimepointbin_+3A_depoval">depoval</code></td>
<td>

<p>Strictly positive vector of length <code>length(binborder)-1</code>. Defines the deposition rate in the bins, i.e. <code>depoval[i]</code> is the deposition rate between the stratigraphic heights <code>binborder[i]</code> and  <code>binborder[i+1]</code>
</p>
</td></tr>
<tr><td><code id="strattotimepointbin_+3A_hiatuslist">hiatuslist</code></td>
<td>

<p>OPTIONAL, default is an empty list. A list of hiatuses to insert. Every entry in the list corresponds to a hiatus, which is given as a vector of length two. The first entry of the vector is the stratigraphic height of the hiatus, the second entry is the duration of the hiatus.
</p>
</td></tr>
<tr><td><code id="strattotimepointbin_+3A_unit">unit</code></td>
<td>

<p>OPTIONAL, default is &quot;sediment per time&quot;. Either &quot;sediment per time&quot; or &quot;time per sediment&quot;. Determines the unit that is assumed for the input given by <code>depoval</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list containing
</p>
<table>
<tr><td><code>age</code></td>
<td>
<p>vector containing ages of deposition of the stratigraphic heights given by the input <code>x</code></p>
</td></tr>
<tr><td><code>height</code></td>
<td>
<p>vector containing the heights that were deposited at the times given by <code>age</code>. Essentially a duplicate of the input <code>x</code></p>
</td></tr>
</table>
<p>Output of <code>NA</code> in <code>age</code> indicates that some values coincide with a hiatus or are located at places where the deposition rate is undefined.
</p>


<h3>Author(s)</h3>

<p>Niklas Hohmann
</p>


<h3>References</h3>

<p>Hohmann, Niklas. 2018. Quantifying the Effects of Changing Deposition Rates and Hiatii on the Stratigraphic Distribution of Fossils. &lt;doi:10.13140/RG.2.2.23372.51841&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pointtransform">pointtransform</a></code> for the more general function underlying this wrapper
</p>
<p>For an overview of the functions in the DAIME package, see its vignette (available via <code>vignette("DAIME")</code> )
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##define deposition rate
binborder=1:6 #bins in tratigraphic height
depoval=c(1,4,5,2,2)
usedunit="sediment per time" #unit of deposition rate is sediment per time unit (default setting)
#Plot deposition rate
plot(approx(binborder,c(depoval,tail(depoval,1)),method='constant',xout=seq(min(binborder),
  max(binborder),length.out=100)),type='l',main='Deposition Rate',xlab='Stratigraphic Height',
  ylab=usedunit,ylim=c(0,max(depoval)))
  
##at what time was the point with tratigraphic height 3.5 deposited?
strattotimepointbin(3.5,binborder,depoval) 

##create an age model
stratheight=seq(min(binborder),max(binborder),length.out=100)
reslist=strattotimepointbin(stratheight,binborder,depoval,unit=usedunit)
#plot age model
usedunit="sediment per time"
plot(reslist$age,reslist$height,xlab='Time',ylab='Stratigraphic Height',
  main=paste('Age model with unit',usedunit))
#create age model but with other units for sedimentn input
usedunit='time per sediment'
reslist=strattotimepointbin(stratheight,binborder,depoval,unit=usedunit)
#plot age model (note the difference this setting makes)
plot(reslist$age,reslist$height,xlab='Time',ylab='Stratigraphic Height',
  main=paste('Age model with unit',usedunit))

##create age model with a hiatus
stratigraphicheight=5 #strat. height of the hiatus
duration=2 #duration of the hiatus
hiatuslist=list(c(stratigraphicheight,duration)) #required input format for hiatuses
reslist=strattotimepointbin(stratheight,binborder,depoval,hiatuslist=hiatuslist)
#!using default setting for units again!
plot(reslist$age,reslist$height,xlab='Time',ylab='stratigraphic height') 

##Transform isotope ratios
depoval=c(1,4,0.1,2,2) 
#create fake oxygen isotope curves
samplelocation=sort(runif(20,min=min(binborder),max=max(binborder))) #where the samples are taken
isotoperatio=sin(samplelocation)*rnorm(length(samplelocation)) #isotope ratios of the samples
plot(samplelocation,isotoperatio,type='l',xlab='Stratigraphic Height',ylab='Isotope Ratio')
#transform only (!) sample locations, NOT values
reslist=strattotimepointbin(samplelocation,binborder,depoval)
#Isotope ratios in time 
plot(reslist$age,isotoperatio,type='l',xlab='Time',ylab='Isotope Ratio')

</code></pre>

<hr>
<h2 id='strattotimepointcont'>
Transform Points and Isotope Ratios from Stratigraphic Height into Time (Continuos)
</h2><span id='topic+strattotimepointcont'></span>

<h3>Description</h3>

<p>This function takes a continuous deposition rate and reconstructs at what time a given stratigraphic height was deposited. Essentially a wrapper of <code>pointtransform(...,direction='height to time',depositionmodel='piecewise linear deposition rate')</code> kept for backwards compatibility of the package. It is recommended to use <code>pointtransform</code> instead of this function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>strattotimepointcont(x, xdep, ydep, hiatuslist = list(), unit = "sediment per time")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="strattotimepointcont_+3A_x">x</code></td>
<td>

<p>Vector containing the stratigraphic heights whose time of deposition are to be determined
</p>
</td></tr>
<tr><td><code id="strattotimepointcont_+3A_xdep">xdep</code></td>
<td>

<p>Vector of strictly increasing real numbers 
</p>
</td></tr>
<tr><td><code id="strattotimepointcont_+3A_ydep">ydep</code></td>
<td>

<p>Vector of the same length of <code>xdep</code>, containing strictly positive real numbers. <code>xdep</code> and <code>ydep</code> define the deposition rate in the sense that <code>depositionrate=approxfun(xdep,ydep)</code>. The units of te deposition rate are by default <code>"sediment per time"</code> and can be changed using the optional input <code>unit</code>
</p>
</td></tr>
<tr><td><code id="strattotimepointcont_+3A_hiatuslist">hiatuslist</code></td>
<td>

<p>OPTIONAL, default is an empty list. A list of hiatuses to insert. Every entry in the list corresponds to a hiatus, which is given as a vector of length two. The first entry of the vector is the stratigraphic height of the hiatus, the second entry is the duration of the hiatus.
</p>
</td></tr>
<tr><td><code id="strattotimepointcont_+3A_unit">unit</code></td>
<td>

<p>OPTIONAL, default is &quot;sediment per time&quot;. Either &quot;sediment per time&quot; or &quot;time per sediment&quot;. Determines the unit that is assumed for the deposition rate.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list containing
</p>
<table>
<tr><td><code>age</code></td>
<td>
<p>vector containing times of deposition of the stratigraphic heights given by the input <code>x</code></p>
</td></tr>
<tr><td><code>height</code></td>
<td>
<p>vector containing the heights that were deposited at the times given by <code>age</code>. Essentially a duplicate of the input <code>x</code></p>
</td></tr>
</table>
<p>Output of <code>NA</code> in <code>age</code> indicates that some values coincide with a hiatus or are located at places where the deposition rate is undefined.
</p>


<h3>Author(s)</h3>

<p>Niklas Hohmann
</p>


<h3>References</h3>

<p>Hohmann, Niklas. 2018. Quantifying the Effects of Changing Deposition Rates and Hiatii on the Stratigraphic Distribution of Fossils. &lt;doi:10.13140/RG.2.2.23372.51841&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pointtransform">pointtransform</a></code> for the more general function underlying this wrapper
</p>
<p>For an overview of the functions in the DAIME package, see its vignette (available via <code>vignette("DAIME")</code> )
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##define deposition rate
xdep=seq(0,12,length.out=100)
ydep=splinefunH(x=c(0,2,4,6,8,10,12),y=c(1,5,6,1,0.5,1,6),m=c(0,1.5,-0.5,-0.5,0,0.5,0))(xdep)
#unit of deposition rate is sediment per time unit (default setting)
usedunit="sediment per time" #unit of deposition rate is sediment per time unit (default setting)
#Plot deposition rate
plot(xdep,ydep,type='l',main='Deposition Rate',xlab='Stratigraphic Height',ylab=usedunit) 

##at what time was the point with tratigraphic height 9 deposited?
strattotimepointcont(9,xdep,ydep) 

##create an age model
stratheight=seq(min(xdep),max(xdep),length.out=100)
usedunit="sediment per time"
reslist=strattotimepointcont(stratheight,xdep,ydep,unit=usedunit)
#plot age model
plot(reslist$age,reslist$height,xlab='Time',ylab='Stratigraphic Height',
  main=paste('Age model with unit',usedunit))
#create age model but with other units for sedimentn input
usedunit='time per sediment'
reslist=strattotimepointcont(stratheight,xdep,ydep,unit=usedunit)
#plot age model (note the difference this setting makes)
plot(reslist$age,reslist$height,xlab='Time',ylab='Stratigraphic Height',
  main=paste('Age model with unit',usedunit))

##create age model with a hiatus
stratigraphicheight=5 #strat. height of the hiatus
duration=2 #duration of the hiatus
hiatuslist=list(c(stratigraphicheight,duration)) #required input format for hiatuses
reslist=strattotimepointcont(stratheight,xdep,ydep,hiatuslist=hiatuslist)
#!using default setting for units again!
plot(reslist$age,reslist$height,xlab='Time',ylab='stratigraphic height')

##Transform isotope ratios
#create fake oxygen isotope curves
samplelocation=sort(runif(20,min=min(xdep),max=max(xdep))) #where the samples are taken
isotoperatio=sin(samplelocation)*rnorm(length(samplelocation)) #isotope ratios of the samples
plot(samplelocation,isotoperatio,type='l',xlab='Stratigraphic Height',ylab='Isotope Ratio')
#transform only (!) sample locations, NOT values
reslist=strattotimepointcont(samplelocation,xdep,ydep)
#Isotope ratios in time 
plot(reslist$age,isotoperatio,type='l',xlab='Time',ylab='Isotope Ratio')
</code></pre>

<hr>
<h2 id='strattotimeratebin'>
Transform patterns from Stratigraphic Height into Time (Binned)
</h2><span id='topic+strattotimeratebin'></span>

<h3>Description</h3>

<p>This function transforms a given binned stratigraphic pattern into the corresponding temporal pattern. The transformation is based on the age model derived from the given deposition rate. Essentially a wrapper of <code>patterntransform(...,direction='height to time',depositionmodel='binned deposition rate',patternmode='binned')</code> kept for backwards compatibility of the package.
It is recommended to use <code>patterntransform</code> instead of this function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>strattotimeratebin(binborder, depoval, signalval, pos = NULL, hiatuslist = list(), 
  unit = "sediment per time")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="strattotimeratebin_+3A_binborder">binborder</code></td>
<td>

<p>Vector of strictly increasing numerical values. Defines the borders of the bins in stratigraphic height
</p>
</td></tr>
<tr><td><code id="strattotimeratebin_+3A_depoval">depoval</code></td>
<td>

<p>Strictly positive vector of length <code>length(binborder)-1</code>. Defines the deposition rate in the bins, i.e. <code>depoval[i]</code> is the deposition rate between the stratigraphic heights <code>binborder[i]</code> and  <code>binborder[i+1]</code>
</p>
</td></tr>
<tr><td><code id="strattotimeratebin_+3A_signalval">signalval</code></td>
<td>

<p>Positive vector of length <code>length(binborder)-1</code>. Defines the stratigraphic pattern in the bins, i.e. <code>signalval[i]</code> is the value of the stratigraphic pattern between the stratigraphic heights <code>binborder[i]</code> and  <code>binborder[i+1]</code>
</p>
</td></tr>
<tr><td><code id="strattotimeratebin_+3A_pos">pos</code></td>
<td>

<p>OPTIONAL. Vector of points in stratigrapic height that will be transformed into time, and where  the temporal pattern will evaluated. Default setting is a vector spanning the interval of interest with evenly spaced points (no. is chosen by the code)
</p>
</td></tr>
<tr><td><code id="strattotimeratebin_+3A_hiatuslist">hiatuslist</code></td>
<td>

<p>OPTIONAL, default is an empty list. A list of hiatuses to insert. Every entry in the list corresponds to a hiatus, which is given as a vector of length two. The first entry of the vector is the stratigraphic height of the hiatus, the second entry is the duration of the hiatus.
</p>
</td></tr>
<tr><td><code id="strattotimeratebin_+3A_unit">unit</code></td>
<td>

<p>OPTIONAL, default is &quot;sediment per time&quot;. Either &quot;sediment per time&quot; or &quot;time per sediment&quot;. Determines the unit that is assumed for the input given by <code>depoval</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list containing
</p>
<table>
<tr><td><code>age</code></td>
<td>
<p>vector containing times</p>
</td></tr>
<tr><td><code>val</code></td>
<td>
<p>vector containign the values of the temporal pattern at the times given by the first entry of the list</p>
</td></tr>
</table>
<p>The temporal pattern can be approximated by <code>approxfun(output$age,output$val)</code>. Output of <code>NA</code> indicates that some values coincide with a hiatus or are located at places where the deposition rate/stratigraphic pattern are undefined.
</p>


<h3>Author(s)</h3>

<p>Niklas Hohmann
</p>


<h3>References</h3>

<p>Hohmann, Niklas. 2018. Quantifying the Effects of Changing Deposition Rates and Hiatii on the Stratigraphic Distribution of Fossils. &lt;doi:10.13140/RG.2.2.23372.51841&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+patterntransform">patterntransform</a></code> for the more general function underlying this wrapper
</p>
<p>For an overview of the functions in the DAIME package, see its vignette (available via <code>vignette("DAIME")</code> )
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##define deposition rate and stratigraphic pattern
binborder=1:6 #bins in tratigraphic height
depoval=c(1,4,0.1,2,2)
usedunit="sediment per time" #unit of deposition rate is sediment per time unit (default setting)
#Plot deposition rate
plot(approx(binborder,c(depoval,tail(depoval,1)),method='constant',
  xout=seq(min(binborder),max(binborder),length.out=100)),type='l',main='Deposition Rate',
  xlab='Stratigraphic Height',ylab=usedunit,ylim=c(0,max(depoval)))
#define stratigraphic rate
signalval=c(runif(5))
#plot stratigraphic pattern
plot(approx(binborder,c(signalval,tail(signalval,1)),method='constant', 
  xout=seq(min(binborder),max(binborder),length.out=100)),type='l',main='Deposition Rate',
  xlab='Stratigraphic Height', ylab='Stratigraphic Pattern',ylim=c(0,max(signalval)))
  
##transform stratigraphic pattern into temporal pattern
usedunit="sediment per time" #unit of deposition rate is sediment per time unit (default setting)
reslist=strattotimeratebin(binborder,depoval, signalval,unit=usedunit)
#plot results
plot(reslist$age,reslist$val,xlab='time',ylab='temporal pattern',
  main=paste('depoval interpreted as',usedunit))
usedunit="time per sediment" #use other input interpretation
reslist=strattotimeratebin(binborder,depoval, signalval,unit=usedunit)
#note how different the results look!!
plot(reslist$age,reslist$val,xlab='time',ylab='temporal pattern',
  main=paste('depoval interpreted as',usedunit))
  
##insert a hiatus
stratigraphicheight=3.5 #strat. height of the hiatus
duration=2 #duration of the hiatus
hiatuslist=list(c(stratigraphicheight,duration)) #required input format for hiatuses
#usedunit is back to default setting!
reslist=strattotimeratebin(binborder,depoval, signalval,hiatuslist=hiatuslist)
#the hiatus corresponds to the gap  in the middle of the temporal rate
plot(reslist$age,reslist$val,xlab='time',ylab='temporal pattern') 

</code></pre>

<hr>
<h2 id='strattotimeratecont'>
Transform Patterns from Stratigraphic Height into Time (Continuous)
</h2><span id='topic+strattotimeratecont'></span>

<h3>Description</h3>

<p>This function transforms a given continuous stratigraphic pattern into the corresponding temporal pattern. The transformation is based on the age model derived from the given deposition rate. Essentially a wrapper of <code>patterntransform(...,direction='height to time',depositionmodel='piecewise linear deposition rate',patternmode='piecewise linear')</code> kept for backwards compatibility of the package. It is recommended to use <code>patterntransform</code> instead of this function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>strattotimeratecont(xdep, ydep, xsig, ysig, pos = NULL,   hiatuslist = list(),
  unit = "sediment per time")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="strattotimeratecont_+3A_xdep">xdep</code></td>
<td>

<p>Vector of strictly increasing real numbers 
</p>
</td></tr>
<tr><td><code id="strattotimeratecont_+3A_ydep">ydep</code></td>
<td>

<p>Vector of the same length of <code>xdep</code>, containing strictly positive real numbers. <code>xdep</code> and <code>ydep</code> define the deposition rate in the sense that <code>depositionrate=approxfun(xdep,ydep)</code>. The units of te deposition rate are by default <code>"sediment per time"</code> and can be changed using the optional input <code>unit</code>
</p>
</td></tr>
<tr><td><code id="strattotimeratecont_+3A_xsig">xsig</code></td>
<td>

<p>Vector of strictly increasing real numbers 
</p>
</td></tr>
<tr><td><code id="strattotimeratecont_+3A_ysig">ysig</code></td>
<td>

<p>Vector of the same length of <code>xsig</code>, containing positive real numbers. <code>xsig</code> and <code>ysig</code> define the stratigraphic pattern in the sense that <code>stratigraphicrate=approxfun(xsig,ysig)</code>.
</p>
</td></tr>
<tr><td><code id="strattotimeratecont_+3A_pos">pos</code></td>
<td>

<p>OPTIONAL. Vector of points in stratigrapic height that will be transformed into time, and determine where the temporal pattern is evaluated. Default setting is a vector spanning the interval of interest with evenly spaced points (no. is chosen by the code)
</p>
</td></tr>
<tr><td><code id="strattotimeratecont_+3A_hiatuslist">hiatuslist</code></td>
<td>

<p>OPTIONAL, default is an empty list. A list of hiatuses to insert. Every entry in the list corresponds to a hiatus, which is given as a vector of length two. The first entry of the vector is the stratigraphic height of the hiatus, the second entry is the duration of the hiatus.
</p>
</td></tr>
<tr><td><code id="strattotimeratecont_+3A_unit">unit</code></td>
<td>

<p>OPTIONAL, default is &quot;sediment per time&quot;. Either &quot;sediment per time&quot; or &quot;time per sediment&quot;. Determines the unit that is assumed for the deposition rate.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list containing:
</p>
<table>
<tr><td><code>age</code></td>
<td>
<p>vector containing times</p>
</td></tr>
<tr><td><code>val</code></td>
<td>
<p>vector containign the values of the temporal pattern at the times given by the first entry of the list</p>
</td></tr>
</table>
<p>The temporal pattern can then be approximated by <code>approxfun(output$age,output$val)</code>. Output of <code>NA</code> indicates that some values coincide with a hiatus or are located at places where the deposition rate/stratigraphic pattern are undefined.
</p>


<h3>Author(s)</h3>

<p>Niklas Hohmann
</p>


<h3>References</h3>

<p>Hohmann, Niklas. 2018. Quantifying the Effects of Changing Deposition Rates and Hiatii on the Stratigraphic Distribution of Fossils. &lt;doi:10.13140/RG.2.2.23372.51841&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+patterntransform">patterntransform</a></code> for the more general function underlying this wrapper
</p>
<p>For an overview of the functions in the DAIME package, see its vignette (available via <code>vignette("DAIME")</code> )
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##define deposition rate and stratigraphic pattern
xdep=seq(0,12,length.out=100)
ydep=splinefunH(x=c(0,2,4,6,8,10,12),y=c(1,5,6,1,0.5,1,6),m=c(0,1.5,-0.5,-0.5,0,0.5,0))(xdep)
usedunit="sediment per time" #unit of deposition rate is sediment per time unit (default setting)
#Plot deposition rate
plot(xdep,ydep,type='l',main='Deposition Rate',xlab='Stratigraphic Height',
  ylab=usedunit)
#define a pattern
xsig= seq(from=min(xdep),to=max(xdep),length.out=100)
ysig=splinefunH(x=c(0,4,12),y=c(0.5,2,0.5),m=c(0,0,0))(xsig) #function values of the signal
plot(xsig,ysig,type='l',main='Stratigraphic Pattern',
  xlab='Stratigraphic Height',ylab='Intensity')
  
##transform stratigraphic pattern into temporal pattern
usedunit="sediment per time" #unit of deposition rate is sediment per time unit (default setting)
reslist=strattotimeratecont(xdep,ydep,xsig,ysig,unit=usedunit)
#plot temporal pattern (transformed stratigrapic pattern)
plot(reslist$age,reslist$val,type='l',xlab='Time',ylab='Intensity',
  main=paste('deposition rate interpreted as',usedunit))
#now using same input, but different interpretation of units
usedunit="time per sediment" #now interpret the deposition rate in different units
reslist=strattotimeratecont(xdep,ydep,xsig,ysig,unit=usedunit)
#plot temporal pattern (transformed stratigrapic pattern)
plot(reslist$age,reslist$val,type='l',xlab='Time',ylab='Intensity temporal pattern',
  main=paste('deposition rate interpreted as',usedunit))
#note how different the results look!!

#Insert hiatus
stratigraphicheight=5 #strat. height of the hiatus
duration=4 #duration of the hiatus
hiatuslist=list(c(stratigraphicheight,duration)) #required input format for hiatuses
reslist=strattotimeratecont(xdep,ydep,xsig,ysig,hiatuslist=hiatuslist) #unit is back to default
plot(reslist$age,reslist$val,xlab='Time',ylab='Intensity',main='Temporal Pattern')
#hiatus is approx between 2 and 5
</code></pre>

<hr>
<h2 id='timetostratpointbin'>
Transform Points and Isotope Ratios from Time into Stratigraphic Height (Binned)
</h2><span id='topic+timetostratpointbin'></span>

<h3>Description</h3>

<p>This function takes a binned deposition rate to determined what stratigraphic height of a section was deposited at a given time. Essentially a wrapper of <code>pointtransform(...,direction='time to height',depositionmodel='binned deposition rate')</code> kept for backwards compatibility of the package. It is recommended to use <code>pointtransform</code> instead of this function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>timetostratpointbin(x, binborder, depoval)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="timetostratpointbin_+3A_x">x</code></td>
<td>

<p>Vector containing the times whose stratigraphic heights are to be determined
</p>
</td></tr>
<tr><td><code id="timetostratpointbin_+3A_binborder">binborder</code></td>
<td>

<p>Vector of strictly increasing numerical values. Defines the borders of the bins in time
</p>
</td></tr>
<tr><td><code id="timetostratpointbin_+3A_depoval">depoval</code></td>
<td>

<p>Vector of length <code>length(binborder)-1</code>. Defines the deposition rate in the bins, i.e. <code>depoval[i]</code> is the deposition rate in the time interval between      
<code>binborder[i]</code> and  <code>binborder[i+1]</code>
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list containing
</p>
<table>
<tr><td><code>height</code></td>
<td>
<p>vector containing the stratigraphic heights that were deposited at the times given by the input <code>x</code></p>
</td></tr>
<tr><td><code>age</code></td>
<td>
<p>vector containing the ages at which the stratigraphic heights given by <code>height</code> were deposited. Essentially a duplicate of the input <code>x</code></p>
</td></tr>
</table>
<p>Output of <code>NA</code> in <code>height</code> indicates that some values coincide with a hiatus or are located at places where the deposition rate is undefined.
</p>


<h3>Author(s)</h3>

<p>Niklas Hohmann
</p>


<h3>References</h3>

<p>Hohmann, Niklas. 2018. Quantifying the Effects of Changing Deposition Rates and Hiatii on the Stratigraphic Distribution of Fossils. &lt;doi:10.13140/RG.2.2.23372.51841&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pointtransform">pointtransform</a></code> for the more general function underlying this wrapper
</p>
<p>For an overview of the functions in the DAIME package, see its vignette (available via <code>vignette("DAIME")</code> )
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##Define deposition rate
binborder=1:6 #temporal bins for the deposition rate
depoval=c(5,4,3,1,2) #deposition rate in the bins
#plot deposition rate
depositionrate=approxfun(binborder,c(depoval,tail(depoval,1)),method="constant",yleft=NA,yright=NA)
plot(depositionrate(seq(from=min(binborder),to=max(binborder),length.out=100)),xlab='time',
  ylab='deposition rate', main='Deposition rate')

##at what stratigraphic height can an object be found that was deposited in the 
##sediment after 5 time units?
timetostratpointbin(5,binborder,depoval) 

##create age model
#points that will be transformed into stratigraphic height
time=seq(from=min(binborder),to=max(binborder),length.out=100) 
reslist=timetostratpointbin(time,binborder,depoval)
#plot age model
plot(reslist$height,reslist$age,type='l',ylab='Time',xlab='Stratigraphic Height',main='Age model')

## Age model with removal of sediment (hiatus)
depoval=c(5,4,-3,1,2) #in the midle time bin, erosion rate is 3
reslist=timetostratpointbin(time,binborder,depoval)
#plot age model. the gap represents the hiatus
plot(reslist$height,reslist$age,type='l',ylab='Time',xlab='Stratigraphic Height',
  main='Age model with erosion')
#A object deposited in the sediment after 3.5 time units is destroyed due to the hiatus:
timetostratpointbin(3.5,binborder,depoval) 

##transform isotope ratio curves
depoval=c(5,4,2,1,0.1)
#create fake ratios and sample locations
sampletime=sort(runif(20,min=min(binborder),max=max(binborder))) #times where the samples were taken
isotoperatio=sin(sampletime)*rnorm(length(sampletime)) #isotope ratios
plot(sampletime,isotoperatio,type='l',xlab='Time',ylab='Isotope Ratio')
#!!transform only (!) sample times, NOT isotope values!!
reslist=timetostratpointbin(sampletime,binborder,depoval)
#this is the resulting isotope ratio curve in stratigraphic height
plot(reslist$height,isotoperatio,type='l',xlab='Stratigraphic Height',ylab='Isotope Ratio')

</code></pre>

<hr>
<h2 id='timetostratpointcont'>
Transform Points and Isotope Ratios from Time into Stratigraphic Height (Continuous)
</h2><span id='topic+timetostratpointcont'></span>

<h3>Description</h3>

<p>This function takes a continuous deposition rate to determined what stratigraphic height of a section was deposited at a given time. Essentially a wrapper of <code>pointtransform(...,direction='time to height',depositionmodel='piecewise linear deposition rate')</code> kept for backwards compatibility of the package. It is recommended to use <code>pointtransform</code> instead of this function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>timetostratpointcont(x, xdep, ydep)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="timetostratpointcont_+3A_x">x</code></td>
<td>

<p>Vector containing the times whose stratigraphic heights are to be determined
</p>
</td></tr>
<tr><td><code id="timetostratpointcont_+3A_xdep">xdep</code></td>
<td>

<p>Vector of strictly increasing real numbers 
</p>
</td></tr>
<tr><td><code id="timetostratpointcont_+3A_ydep">ydep</code></td>
<td>

<p>Vector of the same length of <code>xdep</code>. <code>xdep</code> and <code>ydep</code> define the deposition rate in the sense that <code>depositionrate=approxfun(xdep,ydep)</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list containing
</p>
<table>
<tr><td><code>height</code></td>
<td>
<p>vector containing the stratigraphic heights that were deposited at the times given by the input <code>x</code></p>
</td></tr>
<tr><td><code>age</code></td>
<td>
<p>vector containing the ages at which the stratigraphic heights given by <code>height</code> were deposited. Essentially a duplicate of the input <code>x</code></p>
</td></tr>
</table>
<p>Output of <code>NA</code> in <code>height</code> indicates that some values coincide with a hiatus or are located at places where the deposition rate is undefined.
</p>


<h3>Author(s)</h3>

<p>Niklas Hohmann
</p>


<h3>References</h3>

<p>Hohmann, Niklas. 2018. Quantifying the Effects of Changing Deposition Rates and Hiatii on the Stratigraphic Distribution of Fossils. &lt;doi:10.13140/RG.2.2.23372.51841&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pointtransform">pointtransform</a></code> for the more general function underlying this wrapper
</p>
<p>For an overview of the functions in the DAIME package, see its vignette (available via <code>vignette("DAIME")</code> )
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##define deposition rate
xdep=seq(0,12,length.out=100)
ydep=splinefunH(x=c(0,2,4,6,8,10,12),y=c(1,5,6,1,0.5,1,6),m=c(0,1.5,-0.5,-0.5,0,0.5,0))(xdep)
#Plot deposition rate
plot(xdep,ydep,type='l',main='Deposition Rate',xlab='Time',ylab='Deposition Rate') 

##at what stratigraphic height can an object be found that was deposited in the 
#sediment after 9 time units?
timetostratpointcont(9,xdep,ydep) 

##create age model
#points that will be transformed into stratigraphic height
time=seq(min(xdep),max(xdep),length.out=100) 
reslist=timetostratpointcont(time,xdep,ydep)
#plot age model
plot(reslist$height,reslist$age,type='l',ylab='Time',xlab='Stratigraphic Height',main='Age model')
#age model with Removal of sediment
#define deposition rate with negative deposition rate, e.g. removal of sediment
xdep=seq(0,12,length.out=100)
ydep=splinefunH(x=c(0,2,4,6,8,10,12),y=c(1,5,6,0,-2,1,6),m=c(0,1.5,-0.5,-0.5,0,0.5,0))(xdep)
#Plot deposition rate
plot(xdep,ydep,main='Deposition Rate',xlab='Time',ylab='Deposition Rate')
#sediment removal is done automatically. e.g. create age model as before:
reslist=timetostratpointcont(time,xdep,ydep)
#plot age model
plot(reslist$height,reslist$age,type='l',ylab='Time',xlab='Stratigraphic Height',main='Age model')


#transform isotope ratio curves
ydep=splinefunH(x=c(0,2,4,6,8,10,12),y=c(1,5,6,1,0.5,1,6),m=c(0,1.5,-0.5,-0.5,0,0.5,0))(xdep)
##create fake ratios and sample locations
sampletime=sort(runif(20,min=min(xdep),max=max(xdep))) #times where the samples were taken
isotoperatio=sin(sampletime)*rnorm(length(sampletime)) #isotope ratios
plot(sampletime,isotoperatio,type='l',xlab='Time',ylab='Isotope Ratio')
#transform only (!) sample times, NOT values
reslist=timetostratpointcont(sampletime,xdep,ydep)
#this is the resulting isotope ratio curve in stratigraphic height
plot(reslist$height,isotoperatio,type='l',xlab='Stratigraphic Height',ylab='Isotope Ratio')
</code></pre>

<hr>
<h2 id='timetostratratebin'>
Transform Patterns from Time into Stratigraphic Height (Binned)
</h2><span id='topic+timetostratratebin'></span>

<h3>Description</h3>

<p>This function transforms a given binned temporal pattern into the corresponding stratigraphic pattern. The transformation is based on the age model derived from the given deposition rate. Essentially a wrapper of <code>patterntransform(...,direction='time to height',depositionmodel='binned deposition rate',patternmode='binned')</code> kept for backwards compatibility of the package. It is recommended to use <code>patterntransform</code> instead of this function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>timetostratratebin(binborder, depoval, signalval, pos = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="timetostratratebin_+3A_binborder">binborder</code></td>
<td>

<p>Vector of strictly increasing numerical values. Defines the borders of the bins in time
</p>
</td></tr>
<tr><td><code id="timetostratratebin_+3A_depoval">depoval</code></td>
<td>

<p>Strictly positive vector of length <code>length(binborder)-1</code>. Defines the deposition rate in the bins, i.e. <code>depoval[i]</code> is the deposition rate in the time interval between <code>binborder[i]</code> and  <code>binborder[i+1]</code>
</p>
</td></tr>
<tr><td><code id="timetostratratebin_+3A_signalval">signalval</code></td>
<td>

<p>Positive vector of length <code>length(binborder)-1</code>. Defines the temporal pattern in the bins, i.e. <code>signalval[i]</code> is the value of the temporal pattern between the times <code>binborder[i]</code> and  <code>binborder[i+1]</code>
</p>
</td></tr>
<tr><td><code id="timetostratratebin_+3A_pos">pos</code></td>
<td>

<p>OPTIONAL. Vector of points in time that will be transformed into stratigraphic height, and where the stratigraphic pattern will evaluated. Default setting is a vector spanning the interval of interest with evenly spaced points (no. is chosen by the code)
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following entries:
</p>
<table>
<tr><td><code>height</code></td>
<td>
<p>vector containing stratigraphic heights</p>
</td></tr>
<tr><td><code>val</code></td>
<td>
<p>vector containing the values of the stratigraphic pattern at the height given by <code>height</code></p>
</td></tr>
</table>
<p>NA is returned if the values coincide with a hiatus or when the deposition rate/temporal pattern are undefined.
</p>


<h3>Author(s)</h3>

<p>Niklas Hohmann
</p>


<h3>References</h3>

<p>Hohmann, Niklas. 2018. Quantifying the Effects of Changing Deposition Rates and Hiatii on the Stratigraphic Distribution of Fossils. &lt;doi:10.13140/RG.2.2.23372.51841&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+patterntransform">patterntransform</a></code> for the more general function underlying this wrapper
</p>
<p>For an overview of the functions in the DAIME package, see its vignette (available via <code>vignette("DAIME")</code> )
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Define deposition rate
binborder=1:6 #temporal bins for the deposition rate
depoval=c(5,4,3,1,2) #deposition rate in the bins
#plot deposition rate
depositionrate=approxfun(binborder,c(depoval,tail(depoval,1)),method="constant",yleft=NA,yright=NA)
plot(depositionrate(seq(from=min(binborder),to=max(binborder),length.out=100)),xlab='time',
  ylab='deposition rate', main='Deposition rate')
## Define temporal pattern
signalval=c(1,0,5,2,1)
#plot temporal pattern
temporalpat=approxfun(binborder,c(signalval,tail(signalval,1)),method="constant",
  yleft=NA,yright=NA)
plot(temporalpat(seq(from=min(binborder),to=max(binborder),length.out=100)),xlab='time',
  ylab='Intensity', main='Temporal Pattern')

## Transform temporal pattern into stratigraphic pattern
reslist=timetostratratebin(binborder,depoval,signalval)
#plot resulting stratigraphic pattern
plot(reslist$height,reslist$val,xlab='Stratigraphic Height',ylab='Intensity',
  main='Stratigraphic Pattern')
## With removal of sediment (hiatus)
depoval=c(5,4,-3,1,2) #erosion rate is 3 in the middle time bin
reslist=timetostratratebin(binborder,depoval,signalval)
#plot resulting stratigraphic pattern
plot(reslist$height,reslist$val,xlab='Stratigraphic Height',ylab='Intensity',
  main='Stratigraphic Pattern')
</code></pre>

<hr>
<h2 id='timetostratratecont'>
Transform Patterns from Time into Stratigraphic Height (Continuous)
</h2><span id='topic+timetostratratecont'></span>

<h3>Description</h3>

<p>This function transforms a given continuous temporal pattern into the corresponding stratigraphic pattern. The transformation is based on the age model derived from the given deposition rate. Essentially a wrapper of <code>patterntransform(...,direction='time to height',depositionmodel='piecewise linear deposition rate',patternmode='piecewise linear')</code> kept for backwards compatibility of the package. It is recommended to use <code>patterntransform</code> instead of this function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>timetostratratecont(xdep, ydep, xsig, ysig, pos = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="timetostratratecont_+3A_xdep">xdep</code></td>
<td>

<p>Vector of strictly increasing real numbers 
</p>
</td></tr>
<tr><td><code id="timetostratratecont_+3A_ydep">ydep</code></td>
<td>

<p>Vector of the same length of <code>xdep</code>, containing strictly positive real numbers. <code>xdep</code> and <code>ydep</code> define the deposition rate in the sense that <code>depositionrate=approxfun(xdep,ydep)</code>
</p>
</td></tr>
<tr><td><code id="timetostratratecont_+3A_xsig">xsig</code></td>
<td>

<p>Vector of strictly increasing real numbers 
</p>
</td></tr>
<tr><td><code id="timetostratratecont_+3A_ysig">ysig</code></td>
<td>

<p>Vector of the same length of <code>xsig</code>, containing positive real numbers. <code>xsig</code> and <code>ysig</code> define the temporal pattern in the sense that <code>temporalpat=approxfun(xsig,ysig)</code>.
</p>
</td></tr>
<tr><td><code id="timetostratratecont_+3A_pos">pos</code></td>
<td>

<p>OPTIONAL. Vector of points in time height that will be transformed into stratigraphic height, and determine where the stratigraphic pattern is evaluated. Default setting is a vector spanning the interval of interest with evenly spaced points (no. is chosen by the code)
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list containing:
</p>
<table>
<tr><td><code>height</code></td>
<td>
<p>vector containing stratigraphic heights</p>
</td></tr>
<tr><td><code>val</code></td>
<td>
<p>vector containign the values of the stratigraphic pattern at <code>height</code></p>
</td></tr>
</table>
<p>The stratigraphic pattern can be approximated using <code>stratpat=approxfun(height,val)</code>
</p>


<h3>Author(s)</h3>

<p>Niklas Hohmann
</p>


<h3>References</h3>

<p>Hohmann, Niklas. 2018. Quantifying the Effects of Changing Deposition Rates and Hiatii on the Stratigraphic Distribution of Fossils. &lt;doi:10.13140/RG.2.2.23372.51841&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+patterntransform">patterntransform</a></code> for the more general function underlying this wrapper
</p>
<p>For an overview of the functions in the DAIME package, see its vignette (available via <code>vignette("DAIME")</code> )
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##define deposition rate
xdep=seq(0,12,length.out=100)
ydep=splinefunH(x=c(0,2,4,6,8,10,12),y=c(1,5,6,1,0.5,1,6),m=c(0,1.5,-0.5,-0.5,0,0.5,0))(xdep)
#Plot deposition rate
plot(xdep,ydep,type='l',main='Deposition Rate',xlab='Time',ylab='Sediment per Time Unit')

#define a temporal pattern
xsig= seq(0,12,length.out=100)
ysig=splinefunH(x=c(0,4,12),y=c(0.5,2,0.5),m=c(0,0,0))(xsig)
plot(xsig,ysig,type='l',main='Temporal Pattern',xlab='Time',ylab='Intensity')

##transform temporal pattern into stratigraphic pattern (pattern observable in the section)
reslist=timetostratratecont(xdep,ydep,xsig,ysig)
plot(reslist$height,reslist$val,type='l',xlab='Stratigraphic Height',
  ylab='Intensity',main='Stratigraphic Pattern')
  
##with removal of sediment
ydep=splinefunH(x=c(0,2,4,6,8,10,12),y=c(1,5,6,-2,5,1,6),m=c(0,1.5,-0.5,-0.5,0,0.5,0))(xdep)
#Plot deposition rate
plot(xdep,ydep,type='l',main='Deposition Rate',xlab='Time',ylab='Sediment per Time Unit')
reslist=timetostratratecont(xdep,ydep,xsig,ysig)
plot(reslist$height,reslist$val,type='l',xlab='Stratigraphic Height',
  ylab='Intensity',main='Stratigraphic Pattern',ylim=c(0,1))
#the spike is because the deposition rate is very small when it transitions from 
#negative to positive, generating a punctual extreme condensation
  
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
