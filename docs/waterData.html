<!DOCTYPE html><html lang="en"><head><title>Help for package waterData</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {waterData}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#waterData-package'><p>Hydrologic Data Retrieval and Analysis and Anomaly Calculation</p></a></li>
<li><a href='#badDataSet'><p>Hydrologic dataset with provisional and negative data.</p></a></li>
<li><a href='#cleanUp'><p>Cleans up hydrologic time series data</p></a></li>
<li><a href='#compAnom'><p>Calculates  anomalies</p></a></li>
<li><a href='#fillMiss'><p>Fill-in missing hydrological values</p></a></li>
<li><a href='#importDVs'><p>Imports daily USGS hydrologic times series data</p></a></li>
<li><a href='#misQ05054000'><p>Daily mean streamflow with missing values</p></a></li>
<li><a href='#pH05082500'><p>Hydrologic dataset with provisional and negative data.</p></a></li>
<li><a href='#plotAnoms'><p>Plots streamflow anomalies</p></a></li>
<li><a href='#plotParam'><p>Plot Streamflow and Continous Water-Quality Data</p></a></li>
<li><a href='#q05054000LT'><p>Long-term hydrologic dataset.</p></a></li>
<li><a href='#siteInfo'><p>Retrieve site information</p></a></li>
<li><a href='#summaryStats'><p>Calculate summary statistics</p></a></li>
<li><a href='#tellMeSiteURL'><p>USGS Site Information Service URL</p></a></li>
<li><a href='#tellMeURL'><p>USGS Daily Values Site Service URL</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>1.0.8</td>
</tr>
<tr>
<td>Date:</td>
<td>2017-04-28</td>
</tr>
<tr>
<td>Title:</td>
<td>Retrieval, Analysis, and Anomaly Calculation of Daily Hydrologic
Time Series Data</td>
</tr>
<tr>
<td>Author:</td>
<td>Karen R. Ryberg and Aldo V. Vecchia</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Karen R. Ryberg &lt;kryberg@usgs.gov&gt;</td>
</tr>
<tr>
<td>License:</td>
<td>Unlimited | file LICENSE</td>
</tr>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Description:</td>
<td>Imports U.S. Geological Survey (USGS) daily hydrologic data from USGS web services (see <a href="https://waterservices.usgs.gov/">https://waterservices.usgs.gov/</a> for more information), plots the data, addresses some common data problems, and calculates and plots anomalies.    </td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2.6)</td>
</tr>
<tr>
<td>Imports:</td>
<td>lattice, latticeExtra, xml2, lubridate, dataRetrieval</td>
</tr>
<tr>
<td>Suggests:</td>
<td>xtable, maps, mapdata</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://pubs.usgs.gov/of/2012/1168/">https://pubs.usgs.gov/of/2012/1168/</a></td>
</tr>
<tr>
<td>Collate:</td>
<td>'waterData-package.R' 'importDVs.R' 'fillMiss.R'
'summaryStats.R' 'compAnom.R' 'plotAnoms.R'</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2017-04-28 15:11:09 UTC; kryberg</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2017-04-28 22:25:45 UTC</td>
</tr>
</table>
<hr>
<h2 id='waterData-package'>Hydrologic Data Retrieval and Analysis and Anomaly Calculation</h2><span id='topic+waterData'></span><span id='topic+waterData-package'></span>

<h3>Description</h3>

<p>Retrieval, analysis, and anomaly calculation of daily 
hydrologic time deries data.
</p>


<h3>Details</h3>

<p>This package imports U.S. Geological Survey (USGS) daily hydrologic data 
from USGS web services, plots the data, addresses some common data problems, 
and calculates and plots anomalies.  For a description of anomalies see 
Vecchia (2003), and for examples of the application of streamflow anomalies 
in trend analysis of nutrients, pesticides and surface water, see Alexander 
and Smith (2006), Ryberg and Vecchia (2006), Ryberg and others (2010), 
Sullivan and others (2009), Vecchia (2005), and Vecchia and others (2008).
</p>

<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> waterData</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0.8</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2017-04-28</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> Unlimited | file LICENSE </td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Karen R. Ryberg <a href="mailto:kryberg@usgs.gov">kryberg@usgs.gov</a> and 
Aldo V. Vecchia <a href="mailto:avecchia@usgs.gov">avecchia@usgs.gov</a>
</p>


<h3>References</h3>

<p>Alexander, R.B. and Smith, R.A., 2006, Trends in the nutrient enrichment of 
U.S. rivers during the late 20th century and their relation to changes in
probable stream trophic conditions: Limnology and Oceanography, v. 51, no.
1, Part 2: Eutrophication of Freshwater and Marine Ecosystems, p. 
639&ndash;654., accessed August 1, 2012, at <a href="http://www.jstor.org/stable/4499617">http://www.jstor.org/stable/4499617</a>.
</p>
<p>Ryberg, K.R. and Vecchia, A.V., 2006, Water-quality trend analysis and 
sampling design for the Devils Lake Basin, North Dakota, January 1965 
through September 2003: U.S. Geological Survey Scientific Investigations 
Report 2006&ndash;5238, 64 p., accessed August 1, 2012, at
<a href="http://pubs.usgs.gov/sir/2006/5238/">http://pubs.usgs.gov/sir/2006/5238/</a>.
</p>
<p>Ryberg, K.R. and Vecchia, A.V., 2012, waterData&mdash;An R package for retrieval, 
analysis, and anomaly calculation of daily hydrologic time series data, 
version 1.0: U.S. Geological Survey Open-File Report 2012&ndash;1168, 8 p. 
(Also available at <a href="http://pubs.usgs.gov/of/2012/1168/">http://pubs.usgs.gov/of/2012/1168/</a>.)
</p>
<p>Ryberg, K.R., Vecchia, A.V., Martin, J.D., Gilliom, R.J., 2010, Trends in 
pesticide concentrations in urban streams in the United States, 1992&ndash;2008: 
U.S. Geological Survey Scientific Investigations Report 2010-5139, 101 p., 
accessed August 1, 2012, at <a href="http://pubs.usgs.gov/sir/2010/5139/">http://pubs.usgs.gov/sir/2010/5139/</a>.
</p>
<p>Sullivan, D.J., Vecchia, A.V., Lorenz, D.L., Gilliom, R.J., Martin, J.D., 
2009, Trends in pesticide concentrations in corn-belt streams, 1996&ndash;2006: 
U.S. Geological Survey Scientific Investigations Report 2009-5132, 75 p., 
accessed August 1, 2012, at <a href="http://pubs.usgs.gov/sir/2009/5132/">http://pubs.usgs.gov/sir/2009/5132/</a>.
</p>
<p>Vecchia, A.V., 2003, Relation between climate variability and stream water 
quality in the continental United States, Hydrological Science and 
Technology, v. 19 no. 1, 77&ndash;98.
</p>
<p>Vecchia, A.V., 2003, Water-quality trend analysis and sampling design for 
streams in North Dakota, 1971&ndash;2000: U.S. Geological Survey Scientific 
Investigations Report 2003&ndash;4094, 73 p., accessed August 1, 2012, at  
<a href="http://nd.water.usgs.gov/pubs/wri/wri034094/index.html">http://nd.water.usgs.gov/pubs/wri/wri034094/index.html</a>.
</p>
<p>Vecchia, A.V., 2005, Water-quality trend analysis and sampling design for 
streams in the Red River of the North Basin, Minnesota, North Dakota, and 
South Dakota, 1970&ndash;2001: U.S. Geological Survey Scientific Investigations 
Report 2005&ndash;5224, 54 p., accessed August 1, 2012, at 
<a href="http://pubs.usgs.gov/sir/2005/5224/">http://pubs.usgs.gov/sir/2005/5224/</a>.
</p>

<hr>
<h2 id='badDataSet'>Hydrologic dataset with provisional and negative data.</h2><span id='topic+badDataSet'></span>

<h3>Description</h3>

<p>Daily mean streamflow for the Red River of the North
at Fargo, North Dakota, streamgage 0504000, from January 1, 2000, to 
December 31, 2010.  At the time these data were downloaded, some of the data 
were provisional and subject to revision, including a negative value.  
<img src="../help/figures/badDataSet.png" alt="Red River of the North, North Dakota, 
  streamflow, in cubic feet per second, with a anomalous negative value." />

</p>


<h3>Usage</h3>

<pre><code class='language-R'>badDataSet</code></pre>


<h3>Format</h3>

<p>A dataframe containing 4,018 observations of daily mean 
streamflow.  There are  four variables shown in the following table.
</p>

<table>
<tr>
 <td style="text-align: left;">
   Name </td><td style="text-align: left;"> Type </td><td style="text-align: left;"> Description </td>
</tr>
<tr>
 <td style="text-align: left;"> 
   staid </td><td style="text-align: left;"> factor </td><td style="text-align: left;"> USGS Station identification number </td>
</tr>
<tr>
 <td style="text-align: left;">
   val </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Daily mean streamflow </td>
</tr>
<tr>
 <td style="text-align: left;">
   dates </td><td style="text-align: left;"> Date </td><td style="text-align: left;"> Date of daily mean </td>
</tr>
<tr>
 <td style="text-align: left;">
   qualcode </td><td style="text-align: left;"> factor </td><td style="text-align: left;"> Qualification code
  </td>
</tr>

</table>



<h3>Details</h3>

<p>Streamflow data for U.S. Geological Survey streamgage 05054000, Red River of 
the North at Fargo, North Dakota, from January 1, 2000, to December 31, 
2010, were downloaded, then 2,000 of the 4,018 daily values were randomly
changed to missing values.  At the time these data were downloaded, some of the data 
were provisional and subject to revision, including a negative value.  For
example purposes, the three smallest nonnegative values were changed to
zero.  Data for this site and specific dates have since been revised and 
approved.  Definitions of the daily data qualification codes can be 
found at 
<a href="http://help.waterdata.usgs.gov/codes-and-parameters/daily-value-qualification-code-dv_rmk_cd">http://help.waterdata.usgs.gov/codes-and-parameters/daily-value-qualification-code-dv_rmk_cd</a> 
(U.S. Geological Survey, 2011a).
</p>


<h3>Source</h3>

<p>Imported from the USGS Daily Values Site Web Service 
<a href="http://waterservices.usgs.gov/rest/DV-Service.html">http://waterservices.usgs.gov/rest/DV-Service.html</a> (U.S. 
Geological Survey, 2011b) using the function <a href="#topic+importDVs">importDVs</a>, 
modified by replacing the three smallest values with zero.  
Data for this site and specific dates have since been revised and 
approved.  The user would not be able to retrieve the same dataset from the USGS 
Daily Values Web Site Service.
</p>


<h3>References</h3>

<p>U.S. Geological Survey, 2011a, Daily value qualification code (dv_rmk_cd): 
National Water Information System: Help System, accessed September 7, 
2012, at 
<a href="http://help.waterdata.usgs.gov/codes-and-parameters/daily-value-qualification-code-dv_rmk_cd">http://help.waterdata.usgs.gov/codes-and-parameters/daily-value-qualification-code-dv_rmk_cd</a>.<br /><br />
U.S. Geological Survey, 2011b, National Water Information System (NWISWeb): 
U.S. Geological Survey database, accessed November 2, 2011, at 
<a href="http://waterservices.usgs.gov/">http://waterservices.usgs.gov/</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampleWaterData)
par(las=1, tck=0.02, mar=c(5,5,4,2), mex=1.2, cex.axis=0.75)
plot(badDataSet$dates, badDataSet$val, type="l",  
     ylab="Streamflow, in cubic feet per second", 
     xlab="", yaxs='i', xaxs='i', 
     xlim=c(as.Date("2000-01-01"), as.Date("2012-01-01")), 
     yaxt="n", col="blue")
axis(2, axTicks(2), format(axTicks(2), big.mark=",", scientific=FALSE))
title("Red River of the North at Fargo, North Dakota")
summary(badDataSet$val)
</code></pre>

<hr>
<h2 id='cleanUp'>Cleans up hydrologic time series data</h2><span id='topic+cleanUp'></span>

<h3>Description</h3>

<p>Function to identify and fix common problems with hydrologic data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cleanUp(dataset, task = "view", replace = 0.1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cleanUp_+3A_dataset">dataset</code></td>
<td>
<p>is a data frame in format of the data frame returned by 
<a href="#topic+importDVs">importDVs</a>.</p>
</td></tr>
<tr><td><code id="cleanUp_+3A_task">task</code></td>
<td>
<p>is either &quot;view&quot; or &quot;fix.&quot;  View will return a list containing 
rows with negative values and rows with missing values.  Fix will 
replace negative values with NA and replace zeroes with the value
specified by the replace argument.</p>
</td></tr>
<tr><td><code id="cleanUp_+3A_replace">replace</code></td>
<td>
<p>is the value used to replace 0 values.  The default
is 0.1.  For streamflow in small streams, one might want to use 0.01.
For daily data other than streamflow, such as turbidity, users may not want
to replace 0 values with a nonzero value.  In those cases, replace can be 
set to 0.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list showing days with negative values and days with 
values of 0 when task is &quot;view.&quot;  When task is &quot;fix&quot; the fixed dataset 
is returned.
When a negative value is replaced with NA, an &quot;N&quot; is added to the qualcode
field to indicate that there had been a negative number.
When a zero value is replaced, an &quot;R&quot; is added to the qualcode field to
indicate that a zero value was replaced.
</p>


<h3>Note</h3>

<p>If calculating anomalies (see <a href="#topic+compAnom">compAnom</a>), the user may need to 
replace isolated missing values with with a value; however, if there are 
larger periods with missing values, streamflow anomalies may not be an 
appropriate use of the data.  The substitution of some missing data with 
values may be done using the function <a href="#topic+fillMiss">fillMiss</a> that is part of this 
package.  However, care needs to be taken when filling in missing data.
</p>


<h3>See Also</h3>

<p><a href="#topic+fillMiss">fillMiss</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampleWaterData)
head(badDataSet)
cleanUp(badDataSet, task="view")
q05054000Fix &lt;- cleanUp(badDataSet, task="fix")
# replace 0s with NA, then one could use the fillMiss function
# to estimate values
q05054000Fix2 &lt;- cleanUp(badDataSet, task="fix", replace=NA)
summary(badDataSet)
summary(q05054000Fix)
summary(q05054000Fix2)
</code></pre>

<hr>
<h2 id='compAnom'>Calculates  anomalies</h2><span id='topic+compAnom'></span>

<h3>Description</h3>

<p>Function to calculate short-, medium-, and long-term hydrologic anomalies
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compAnom(dataset, which = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compAnom_+3A_dataset">dataset</code></td>
<td>
<p>is the daily hydrologic data returned from <a href="#topic+importDVs">importDVs</a> 
or data otherwise obtained and in the same format as that produced by 
<a href="#topic+importDVs">importDVs</a>.</p>
</td></tr>
<tr><td><code id="compAnom_+3A_which">which</code></td>
<td>
<p>indicates which set of anomalies; 1 calculates the 1-year, 
30-day, and 1-day anomalies; 2 calculates the 100-day, 10-day, and 1-day 
anomalies; 3 calculates the 30-day and 1-day anomalies; and 4 calculates 
the 10-year, 5-year, 1-year, one-quarter-year (seasonal), and 1-day 
anomalies.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function was written with streamflow data in mind because streamflow 
is the most commonly used exogenous variable for trend models for water 
quality;  however, the function is generic so that users may experiment with 
anomalies from other daily hydrologic data.  Examples of the inclusion of 
streamflow anomalies in trend analysis of nutrients, pesticides and 
surface water can be found in Alexander and Smith (2006), Ryberg and Vecchia 
(2006), Ryberg and others (2010), Sullivan and others (2009), Vecchia
(2003), Vecchia (2005), and Vecchia and others (2008).
</p>


<h3>Value</h3>

<p>A list.  In the cases of &quot;which&quot; equal to 1 or 2, the 
first element of the list is a data frame containing the station 
identification number, dates, streamflow, and long-term, mid-term, and 
short-term anomalies.  The next three elements of the list are the length 
in days of the long-term, mid-term, and short-term streamflow anomalies.  
In the case of &quot;which&quot; equal to 3, the first element of the list is a data 
frame containing the station identification number, dates, streamflow, and 
mid-term and short-term anomalies.  The next two elements of the list are 
the length in days of the mid-term and short-term streamflow anomalies.  
In the case of &quot;which&quot; equal to 4, the first element of the list is a data 
frame containing the station identification number, dates, streamflow, and 
10-year, 5-year, annual, seasonal, and daily streamflow anomalies.  The 
next five elements of the list are the length in days of the 10-year, 
5-year, annual, seasonal, and daily streamflow anomalies.
</p>


<h3>References</h3>

<p>Alexander, R.B. and Smith, R.A., 2006, Trends in the nutrient enrichment of 
U.S. rivers during the late 20th century and their relation to changes in
probable stream trophic conditions: Limnology and Oceanography, v. 51, no.
1, Part 2: Eutrophication of Freshwater and Marine Ecosystems, p. 
639&ndash;654, accessed August 1, 2012, at 
<a href="http://www.jstor.org/stable/4499617">http://www.jstor.org/stable/4499617</a>.
</p>
<p>Ryberg, K.R. and Vecchia, A.V., 2006, Water-quality trend analysis and 
sampling design for the Devils Lake Basin, North Dakota, January 1965 
through September 2003: U.S. Geological Survey Scientific Investigations 
Report 2006&ndash;5238, 64 p., accessed August 1, 2012, at 
<a href="http://pubs.usgs.gov/sir/2006/5238/">http://pubs.usgs.gov/sir/2006/5238/</a>.
</p>
<p>Ryberg, K.R. and Vecchia, A.V., 2012, waterData&mdash;An R packge for retrieval, 
analysis, and anomaly calculation of daily hydrologic time series data, 
version 1.0: U.S. Geological Survey Open-File Report 2012&ndash;1168, 8 p.  
(Also available at <a href="http://pubs.usgs.gov/of/2012/1168/">http://pubs.usgs.gov/of/2012/1168/</a>.)
</p>
<p>Ryberg, K.R., Vecchia, A.V., Martin, J.D., Gilliom, R.J., 2010, Trends in 
pesticide concentrations in urban streams in the United States, 1992-2008: 
U.S. Geological Survey Scientific Investigations Report 2010&ndash;5139, 101 p. 
(Also available at <a href="http://pubs.usgs.gov/sir/2010/5139/">http://pubs.usgs.gov/sir/2010/5139/</a>.)
</p>
<p>Sullivan, D.J., Vecchia, A.V., Lorenz, D.L., Gilliom, R.J., Martin, J.D., 
2009, Trends in pesticide concentrations in corn-belt streams, 1996&ndash;2006: 
U.S. Geological Survey Scientific Investigations Report 2009&ndash;5132, 75 p., 
accessed Ausugst , 2012, at <a href="http://pubs.usgs.gov/sir/2009/5132/">http://pubs.usgs.gov/sir/2009/5132/</a>.
</p>
<p>Vecchia, A.V., 2003, Relation between climate variability and stream water 
quality in the continental United States, Hydrological Science and 
Technology, v. 19, no. 1, 77&ndash;98.
</p>
<p>Vecchia, A.V., 2003, Water-quality trend analysis and sampling design for 
streams in North Dakota, 1971&ndash;2000: U.S. Geological Survey Scientific 
Investigations Report 2003&ndash;4094, 73 p., accessed August 1, 2012, at 
<a href="http://nd.water.usgs.gov/pubs/wri/wri034094/index.html">http://nd.water.usgs.gov/pubs/wri/wri034094/index.html</a>.
</p>
<p>Vecchia, A.V., 2005, Water-quality trend analysis and sampling design for 
streams in the Red River of the North Basin, Minnesota, North Dakota, and 
South Dakota, 1970&ndash;2001: U.S. Geological Survey Scientific Investigations 
Report 2005&ndash;5224, 54 p. accessed August 1, 2012, at 
<a href="http://pubs.usgs.gov/sir/2005/5224/">http://pubs.usgs.gov/sir/2005/5224/</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> ## Not run: 
q05054000.85 &lt;- importDVs("05054000", sdate="1985-10-01", edate="2010-09-30")
anoms05054000.1 &lt;- compAnom(q05054000.85, which=1)
anoms05054000.2 &lt;- compAnom(q05054000.85, which=2)
anoms05054000.3 &lt;- compAnom(q05054000.85, which=3)
anoms05054000.4 &lt;- compAnom(q05054000.85, which=4)
 
## End(Not run)
</code></pre>

<hr>
<h2 id='fillMiss'>Fill-in missing hydrological values</h2><span id='topic+fillMiss'></span>

<h3>Description</h3>

<p>Function to fill in missing time series data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fillMiss(dataset, block = 30, pmiss = 40, model = "trend",
  smooth = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fillMiss_+3A_dataset">dataset</code></td>
<td>
<p>is a data frame in the format of the data frame returned by
<a href="#topic+importDVs">importDVs</a>, with missing values indicated by NA.</p>
</td></tr>
<tr><td><code id="fillMiss_+3A_block">block</code></td>
<td>
<p>is the size of the largest block of missing data that the 
function will fill-in.</p>
</td></tr>
<tr><td><code id="fillMiss_+3A_pmiss">pmiss</code></td>
<td>
<p>is the maximum amount of the missing data that can be missing
in the dataset for fill-in procedure to be performed.</p>
</td></tr>
<tr><td><code id="fillMiss_+3A_model">model</code></td>
<td>
<p>is the type of structural time series model, see 
<a href="stats.html#topic+StructTS">StructTS</a>.  The default value is trend.  If level is used, the results 
of <a href="#topic+fillMiss">fillMiss</a>, which by default applies a fixed-interval smoothing to 
the time series, <a href="stats.html#topic+tsSmooth">tsSmooth</a>, will be very close to linear interpolation.</p>
</td></tr>
<tr><td><code id="fillMiss_+3A_smooth">smooth</code></td>
<td>
<p>a logical that indicates whether or not to apply 
<a href="stats.html#topic+tsSmooth">tsSmooth</a> to the structured time series.</p>
</td></tr>
<tr><td><code id="fillMiss_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to plotting method (see <a href="graphics.html#topic+par">par</a>).</p>
</td></tr>
</table>


<h3>Format</h3>

<p>The returned data frame has the following columns: <br />
</p>

<table>
<tr>
 <td style="text-align: left;">
Name </td><td style="text-align: left;"> Type </td><td style="text-align: left;"> Description </td>
</tr>
<tr>
 <td style="text-align: left;"> 
staid </td><td style="text-align: left;"> factor </td><td style="text-align: left;"> USGS station identification number </td>
</tr>
<tr>
 <td style="text-align: left;">
val </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> The value of the hydrologic variable </td>
</tr>
<tr>
 <td style="text-align: left;">
dates </td><td style="text-align: left;"> Date </td><td style="text-align: left;"> Date of daily value </td>
</tr>
<tr>
 <td style="text-align: left;">
qualcode </td><td style="text-align: left;"> factor </td><td style="text-align: left;"> Qualification code
</td>
</tr>

</table>


<h3>Details</h3>

<p>This function will check the percent of missing values and the size
of the largest missing block of data.  By default, if less than 40 percent 
of the data are missing and the largest block is less than 30 days, the 
data will be filled-in by using a structural time series, <a href="stats.html#topic+StructTS">StructTS</a> 
from the base stats  package in R (R Development Core Team, 2012).  The 
fitted structural time series is then smoothed via a state-space model, 
<a href="stats.html#topic+tsSmooth">tsSmooth</a> from the base stats package in R.
</p>


<h3>Value</h3>

<p>a data frame with NAs in the &quot;val&quot; column replaced by 
estimated values and a plot showing observed and estimated data.  If there 
are too many missing values, based on default or user defined limits, the
unaltered dataset is returned as well as a message, such as &quot;Error 
in fillMiss(misQ05054000) : Too much missing data.  Cannot fill in missing 
values.&quot;
</p>


<h3>Note</h3>

<p>Many methods have been suggested for estimating missing hydrological 
data.  However, experiments showed that the functions in the base stats 
package  worked very well if the blocks of missing data were not long.  
Users with larger blocks of missing data may want to explore other methods 
including using nearby gages to estimate missing values at a streamgage.  
Additional methods for filling in missing hydrological data are summarized 
in Beauchamp and others (1989) and Elshorbagy and others (2000).
</p>
<p>To indicate which values have been replaced, the qualcode field is
populated with 'fM' for those values that were estimated using the
fillMiss function.
</p>


<h3>References</h3>

<p>Beauchamp, J.J., 1989, Comparison of regression and time-series methods for
synthesizing missing streamflow records: Water Resources Bulletin, v. 25, 
no. 5, p. 961&ndash;975.
</p>
<p>Elshorbagy, A.A., Panu, U.S., Simonovic, S.P., 2000, Group-based
estimation of missing hydrological data&mdash;I. Approach and general
methodology: Hydrological Sciences Journal, v. 45, no. 6, p. 849&ndash;866.
</p>
<p>R Development Core Team, 2012, R&mdash;A language and environment for statistical
computing: Vienna, Austria, R Foundation for Statistical Computing, [ISBN
3-900051-07-0].  (Also available at <a href="https://www.r-project.org">https://www.r-project.org</a>.)
</p>


<h3>See Also</h3>

<p><a href="stats.html#topic+StructTS">StructTS</a>, <a href="stats.html#topic+tsSmooth">tsSmooth</a>, <a href="#topic+cleanUp">cleanUp</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampleWaterData)
my.newdata &lt;- fillMiss(misQ05054000, block=30, pmiss=50, log="y")
summary(misQ05054000)
summary(my.newdata)
# ph example
 ## Not run: 
pH05082500&lt;-importDVs("05082500", code="00400", stat="00008", 
sdate="2000-01-01", edate="2011-12-31")
plotParam(pH05082500)
pHfilled&lt;-fillMiss(pH05082500, block=45, ylim=c(7.5,9), yaxs="i")
 
## End(Not run)
</code></pre>

<hr>
<h2 id='importDVs'>Imports daily USGS hydrologic times series data</h2><span id='topic+importDVs'></span>

<h3>Description</h3>

<p>Function to import daily hydrologic time series 
data given a USGS streamgage identification number.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>importDVs(staid, code = "00060", stat = "00003", sdate = "1851-01-01",
  edate = as.Date(Sys.Date(), format = "%Y-%m-%d"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="importDVs_+3A_staid">staid</code></td>
<td>
<p>is the USGS site identification number,
usually eight digits long, but can be longer.  Users may search for 
surface-water sites and obtain station identification numbers using the 
USGS Site Web Service, 
<a href="https://waterservices.usgs.gov/rest/Site-Service.html">https://waterservices.usgs.gov/rest/Site-Service.html</a> (USGS, 2017e); 
using the National Water Information System: Mapper, 
<a href="https://maps.waterdata.usgs.gov/mapper/index.html">https://maps.waterdata.usgs.gov/mapper/index.html</a> (U.S. Geological Survey, 2017a); 
or using the National Water Information System: Web Interface to daily 
surface-water data, 
<a href="https://waterdata.usgs.gov/nwis/dv/?referred_module=sw">https://waterdata.usgs.gov/nwis/dv/?referred_module=sw</a> 
(U.S. Geological Survey, 2012f).  The site identification number needs to 
be entered as a character, that is in quotes, because many USGS 
streamgage numbers begin with zero and the leading zero is necessary.</p>
</td></tr>
<tr><td><code id="importDVs_+3A_code">code</code></td>
<td>
<p>is the USGS parameter code, a 5-digit number 
used in the USGS computerized data system, National Water 
Information System (NWIS), to uniquely identify a specific hydrologic 
property or constituent.  A list of paramater codes is available at 
<a href="https://nwis.waterdata.usgs.gov/usa/nwis/pmcodes">https://nwis.waterdata.usgs.gov/usa/nwis/pmcodes</a> (U.S. Geological Survey, 2017b).</p>
</td></tr>
<tr><td><code id="importDVs_+3A_stat">stat</code></td>
<td>
<p>is the USGS statistics code, a 5-digit number 
used in the USGS computerized data system, National Water 
Information System (NWIS), to uniquely identify specific statistics, such
as daily mean, daily maximum, and daily minimum.  The default,  
00003,  is the mean daily value.  A list of statistics codes is available at 
<a href="https://nwis.waterdata.usgs.gov/nwis/help/?read_file=stat&amp;format=table">https://nwis.waterdata.usgs.gov/nwis/help/?read_file=stat&amp;format=table</a> 
(U.S. Geological Survey, 2017c).
Not all statistics are available at every gage.</p>
</td></tr>
<tr><td><code id="importDVs_+3A_sdate">sdate</code></td>
<td>
<p>is the start date of the time series, in the format 
yyyy-mm-dd, optional.</p>
</td></tr>
<tr><td><code id="importDVs_+3A_edate">edate</code></td>
<td>
<p>is the end date of the time series, in the format yyyy-mm-dd, 
optional.</p>
</td></tr>
</table>


<h3>Format</h3>

<p>The returned data frame has the following columns <br />
</p>

<table>
<tr>
 <td style="text-align: left;">
Name </td><td style="text-align: left;"> Type </td><td style="text-align: left;"> Description </td>
</tr>
<tr>
 <td style="text-align: left;"> 
staid </td><td style="text-align: left;"> factor </td><td style="text-align: left;"> USGS station identification number </td>
</tr>
<tr>
 <td style="text-align: left;">
val </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> The value of the hydrologic variable </td>
</tr>
<tr>
 <td style="text-align: left;">
dates </td><td style="text-align: left;"> Date </td><td style="text-align: left;"> Date of daily value </td>
</tr>
<tr>
 <td style="text-align: left;">
qualcode </td><td style="text-align: left;"> factor </td><td style="text-align: left;"> Qualification code
</td>
</tr>

</table>


<h3>Details</h3>

<p>This function will import data from a WaterML2 service (current USGS 
hydrological data standard).  It will retrieve daily streamflow and 
continuous water-quality data from the USGS Daily Values Site Web 
Service <a href="https://waterservices.usgs.gov/rest/DV-Service.html">https://waterservices.usgs.gov/rest/DV-Service.html</a>
(U.S. Geological Survey, 2017d).
</p>


<h3>Value</h3>

<p>a data frame containing daily streamflow or other hydrologic data 
for the site specified during the dates specified (inclusive).  The USGS 
parameter code, code, and the statistics code, stat, are attributes of the
data frame.
</p>


<h3>References</h3>

<p>U.S. Geological Survey, 2017a, National Water Information System: Mapper, 
accessed January 3, 2017, at 
<a href="https://maps.waterdata.usgs.gov/mapper/index.html">https://maps.waterdata.usgs.gov/mapper/index.html</a>.
</p>
<p>U.S. Geological Survey, 2017b, Parameter code definition, 
National Water Information System: Web Interface, accessed January 3, 
2017, at <a href="https://nwis.waterdata.usgs.gov/usa/nwis/pmcodes">https://nwis.waterdata.usgs.gov/usa/nwis/pmcodes</a>.
</p>
<p>U.S. Geological Survey, 2017c, Stat codes (stat_cd), 
National Water Information System: Web Interface, accessed January 3, 
2017, at 
<a href="https://nwis.waterdata.usgs.gov/nwis/help/?read_file=stat&amp;format=table">https://nwis.waterdata.usgs.gov/nwis/help/?read_file=stat&amp;format=table</a>.
</p>
<p>U.S. Geological Survey, 2017d, USGS daily values site web service: 
REST Web Services, accessed January 3, 2017, at 
<a href="https://waterservices.usgs.gov/rest/DV-Service.html">https://waterservices.usgs.gov/rest/DV-Service.html</a>.
</p>
<p>U.S. Geological Survey, 2017e, USGS site web service: 
REST Web Services, accessed January 3, 2017, at 
<a href="https://waterservices.usgs.gov/rest/Site-Service.html">https://waterservices.usgs.gov/rest/Site-Service.html</a>.
</p>
<p>U.S. Geological Survey, 2017f, USGS surface-water daily data for the Nation: 
National Water Information System: Web Interface, accessed January 3, 
2017, at <a href="http://waterdata.usgs.gov/nwis/dv/?referred_module=sw">http://waterdata.usgs.gov/nwis/dv/?referred_module=sw</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> ## Not run: 
# import mean daily streamflow for Red River of the North at Fargo, ND
q05054000 &lt;- importDVs("05054000", sdate="2000-01-01", edate="2010-12-31")
head(q05054000)
# additional examples of how to this function follow
# import mean daily gage height for Red River of the North at Grand Forks, ND
gh05082500 &lt;- importDVs("05082500", code="00065", sdate="2000-01-01", edate="2010-12-31")
# import mean daily specific conductance for Red River of the North at Grand Forks, ND
sc05082500&lt;- importDVs("05082500", code="00095", sdate="2000-01-01", edate="2010-12-31")
# import mean daily water temperature for Red River of the North at Fargo, ND
temp05054000&lt;- importDVs("05054000", code="00010", sdate="2000-01-01", edate="2010-12-31")
# import median daily pH for Red River of the North at Fargo, ND
pH05054000&lt;- importDVs("05054000", code="00400", stat="00008", 
sdate="2000-01-01", edate="2010-12-31")
# examine the attributes of the data frame to show that the parameter code 
# and statistics code are saved with the data frame
attributes(pH05054000)[c("code","stat")]
# import mean daily oxygen for Red River of the North at Fargo, ND
do05054000 &lt;- importDVs("05054000", code="00300", sdate="2000-01-01", edate="2010-12-31")
# import mean daily turbidity for Red River of the North at Fargo, ND
turb05054000 &lt;- importDVs("05054000", code="63680", sdate="2000-01-01", edate="2010-12-31")

## End(Not run)
</code></pre>

<hr>
<h2 id='misQ05054000'>Daily mean streamflow with missing values</h2><span id='topic+misQ05054000'></span>

<h3>Description</h3>

<p>Daily mean streamflow data with randomly generated missing values.
<img src="../help/figures/misQ05054000.png" alt="Red River of the North, North Dakota, 
  streamflow, in cubic feet per second, on a logarithmic scale, with missing 
  values." />
  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>misQ05054000</code></pre>


<h3>Format</h3>

<p>A dataframe containing 4,018 observations of daily mean 
streamflow.  There are  four variables, staid, the USGS streamgage station 
number; val, the daily mean streamflow value in cubic feet per second; 
dates, the dates of the observations; and qualcode, the USGS data 
qualification code.
</p>

<table>
<tr>
 <td style="text-align: left;">
   Name </td><td style="text-align: left;"> Type </td><td style="text-align: left;"> Description </td>
</tr>
<tr>
 <td style="text-align: left;"> 
   staid </td><td style="text-align: left;"> factor </td><td style="text-align: left;"> USGS station identification number </td>
</tr>
<tr>
 <td style="text-align: left;">
   val </td><td style="text-align: left;"> numberic </td><td style="text-align: left;"> Daily mean streamflow </td>
</tr>
<tr>
 <td style="text-align: left;">
   dates </td><td style="text-align: left;"> Date </td><td style="text-align: left;"> Date of daily mean </td>
</tr>
<tr>
 <td style="text-align: left;">
   qualcode </td><td style="text-align: left;"> factor </td><td style="text-align: left;"> Qualification code
  </td>
</tr>

</table>



<h3>Details</h3>

<p>Streamflow data for USGS streamgage 05054000, Red River of the North
at Fargo, North Dakota, from January 1, 2000, to December 31, 2010,
were downloaded and then 2,000 of the 4,018 daily values were randomly
replaced with NAs.  This provides a dataset with slightly less than
50 percent of the values missing; however, the blocks of missing values
are less than 30 days long. Definitions of the daily data qualification codes can be 
found at 
<a href="http://help.waterdata.usgs.gov/codes-and-parameters/daily-value-qualification-code-dv_rmk_cd">http://help.waterdata.usgs.gov/codes-and-parameters/daily-value-qualification-code-dv_rmk_cd</a> 
(U.S. Geological Survey, 2011).
</p>


<h3>Source</h3>

<p>Imported from the USGS Daily Values Site Web Service 
<a href="http://waterservices.usgs.gov/rest/DV-Service.html">http://waterservices.usgs.gov/rest/DV-Service.html</a> (U.S. 
Geological Survey, 2012) using the function <a href="#topic+importDVs">importDVs</a>, with
random replacements of data with NAs.
</p>


<h3>References</h3>

<p>U.S. Geological Survey, 2011, Daily value qualification code (dv_rmk_cd): 
National Water Information System: Help System, accessed September 7, 
2012, at 
<a href="http://help.waterdata.usgs.gov/codes-and-parameters/daily-value-qualification-code-dv_rmk_cd">http://help.waterdata.usgs.gov/codes-and-parameters/daily-value-qualification-code-dv_rmk_cd</a>.<br /><br />
U.S. Geological Survey, 2012, National Water Information System (NWISWeb): 
U.S. Geological Survey database, accessed May 2, 2012, at 
<a href="http://waterservices.usgs.gov/">http://waterservices.usgs.gov/</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampleWaterData)
par(las=1, tck=0.02, mar=c(5,5,4,2), mex=1.2, cex.axis=.9)
plot(misQ05054000$dates, misQ05054000$val, type="l", log="y", 
     ylab="Streamflow, in cubic feet per second", 
     xlab="", yaxs='i', xaxs='i', 
     xlim=c(as.Date("2000-01-01"), as.Date("2012-01-01")), ylim=c(10,50000), 
     yaxt="n")
axis(2, axTicks(2), format(axTicks(2), big.mark=","))
title("Red River of the North at Fargo, North Dakota")
summary(misQ05054000$val)
</code></pre>

<hr>
<h2 id='pH05082500'>Hydrologic dataset with provisional and negative data.</h2><span id='topic+pH05082500'></span>

<h3>Description</h3>

<p>Daily median pH for the Red River of the North
at Grand Forks, North Dakota, streamgage 05082500, from March 31, 2001, to 
December 31, 2011.  At the time these data were downloaded, some of it was 
provisional data subject to revision.  
<img src="../help/figures/pH05082500.png" alt="Red River of the North, at Grand Forks, 
  North Dakota, daily median, pH, water unfiltered,field, standard units." />

</p>


<h3>Usage</h3>

<pre><code class='language-R'>pH05082500</code></pre>


<h3>Format</h3>

<p>A dataframe containing 1,737 rows.  There are  four variables, staid, 
the USGS streamgage station number; val, the daily meadian pH value in 
standard unites;  dates, the dates of the observations; and qualcode, the 
USGS data qualification code.
</p>

<table>
<tr>
 <td style="text-align: left;">
   Name </td><td style="text-align: left;"> Type </td><td style="text-align: left;"> Description </td>
</tr>
<tr>
 <td style="text-align: left;"> 
   staid </td><td style="text-align: left;"> factor </td><td style="text-align: left;"> USGS station identification number </td>
</tr>
<tr>
 <td style="text-align: left;">
   val </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Daily median pH </td>
</tr>
<tr>
 <td style="text-align: left;">
   dates </td><td style="text-align: left;"> Date </td><td style="text-align: left;"> Date of daily value </td>
</tr>
<tr>
 <td style="text-align: left;">
   qualcode </td><td style="text-align: left;"> factor </td><td style="text-align: left;"> Qualification code
  </td>
</tr>

</table>



<h3>Details</h3>

<p>pH data for USGS streamgage 05082500, Red River of the North
at Grand Forks, North Dakota, from March 31, 2001, to December 31, 2011.  
At the time these data were downloaded, some of the data 
were provisional and subject to revision, indicated by &quot;P&quot; in the qualcode
column.  Definitions of the daily data qualification codes can be 
found at 
<a href="http://help.waterdata.usgs.gov/codes-and-parameters/daily-value-qualification-code-dv_rmk_cd">http://help.waterdata.usgs.gov/codes-and-parameters/daily-value-qualification-code-dv_rmk_cd</a> 
(U.S. Geological Survey, 2011).
</p>


<h3>Source</h3>

<p>Imported from the USGS Daily Values Site Web Service 
<a href="http://waterservices.usgs.gov/rest/DV-Service.html">http://waterservices.usgs.gov/rest/DV-Service.html</a> (U.S. 
Geological Survey, 2012) using the function <a href="#topic+importDVs">importDVs</a>, July 23, 2012.
</p>


<h3>References</h3>

<p>U.S. Geological Survey, 2011, Daily value qualification code (dv_rmk_cd): 
National Water Information System: Help System, accessed September 7, 
2012, at 
<a href="http://help.waterdata.usgs.gov/codes-and-parameters/daily-value-qualification-code-dv_rmk_cd">http://help.waterdata.usgs.gov/codes-and-parameters/daily-value-qualification-code-dv_rmk_cd</a>.<br /><br />
U.S. Geological Survey, 2012, National Water Information System (NWISWeb): 
U.S. Geological Survey database, accessed July 23, 2012, at 
<a href="http://waterservices.usgs.gov/">http://waterservices.usgs.gov/</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampleWaterData)
par(las=1, tck=0.02, mar=c(3,5,2,2), cex.axis=0.75)
plot(pH05082500$dates, pH05082500$val, type="l",  
     ylab="Daily median pH, water, \nunfiltered, field, standard units", 
     xlab="", yaxs='i', xaxs='i', ylim=c(7.4, 9), 
     xlim=c(as.Date("2007-01-01"), as.Date("2012-01-01")), col="red")
title("Red River of the North at Grand Forks, North Dakota",cex.main=0.95)
summary(pH05082500$val)
</code></pre>

<hr>
<h2 id='plotAnoms'>Plots streamflow anomalies</h2><span id='topic+plotAnoms'></span>

<h3>Description</h3>

<p>Function to plot hydrologic time series and anomalies
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotAnoms(data, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotAnoms_+3A_data">data</code></td>
<td>
<p>is the anomaly list from the function 
<a href="#topic+compAnom">compAnom</a>.</p>
</td></tr>
<tr><td><code id="plotAnoms_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to plotting method (see <a href="graphics.html#topic+par">par</a>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a plot.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> ## Not run: 
q05054000.85 &lt;- importDVs("05054000", sdate="1985-01-01", edate="2010-09-30")
anoms05054000 &lt;- compAnom(q05054000.85, which=1)
plotAnoms(anoms05054000)
 
## End(Not run)
</code></pre>

<hr>
<h2 id='plotParam'>Plot Streamflow and Continous Water-Quality Data</h2><span id='topic+plotParam'></span>

<h3>Description</h3>

<p>Function to plot hydrologic times series.  
Will plot more than one site at a time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotParam(data, logscale = FALSE, metric = FALSE, ylabel = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotParam_+3A_data">data</code></td>
<td>
<p>is the data frame in the format of that returned by 
<a href="#topic+importDVs">importDVs</a>.</p>
</td></tr>
<tr><td><code id="plotParam_+3A_logscale">logscale</code></td>
<td>
<p>is a logical indicating whether or not the y-scale should be 
log 10.  Streamflow generally is plotted with a log scale and this only has 
an effect on the plotting of streamflow data.</p>
</td></tr>
<tr><td><code id="plotParam_+3A_metric">metric</code></td>
<td>
<p>USGS streamflow data are usually in cubic feet per second;
however it may be converted to cubic meters per second for publication.  
Likewise, gage height is usually in feet, but could be converted to 
meters.  The metric argument only has an effect on streamflow and gage 
height.</p>
</td></tr>
<tr><td><code id="plotParam_+3A_ylabel">ylabel</code></td>
<td>
<p>optionally allows user to pass a y-axis label.</p>
</td></tr>
<tr><td><code id="plotParam_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to plotting method (see <a href="graphics.html#topic+par">par</a>). 
(see <a href="lattice.html#topic+xyplot">xyplot</a>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a lattice plot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampleWaterData)
plotParam(misQ05054000, code="00060", stat="00003", logscale=TRUE)
plotParam(misQ05054000, code=attributes(misQ05054000)$code, 
stat=attributes(misQ05054000)$stat, logscale=TRUE)
</code></pre>

<hr>
<h2 id='q05054000LT'>Long-term hydrologic dataset.</h2><span id='topic+q05054000LT'></span>

<h3>Description</h3>

<p>Daily mean streamflow for the Red River of the North
at Fargo, North Dakota, streamgage 0504000, from October 1, 1949, to 
September 30, 2010.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>q05054000LT</code></pre>


<h3>Format</h3>

<p>A dataframe containing 22,280 observations of daily mean 
streamflow.  There are  four variables shown in the following table.
</p>

<table>
<tr>
 <td style="text-align: left;">
   Name </td><td style="text-align: left;"> Type </td><td style="text-align: left;"> Description </td>
</tr>
<tr>
 <td style="text-align: left;"> 
   staid </td><td style="text-align: left;"> factor </td><td style="text-align: left;"> USGS Station identification number </td>
</tr>
<tr>
 <td style="text-align: left;">
   val </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Daily mean streamflow </td>
</tr>
<tr>
 <td style="text-align: left;">
   dates </td><td style="text-align: left;"> Date </td><td style="text-align: left;"> Date of daily mean </td>
</tr>
<tr>
 <td style="text-align: left;">
   qualcode </td><td style="text-align: left;"> factor </td><td style="text-align: left;"> Qualification code
  </td>
</tr>

</table>



<h3>Details</h3>

<p>Streamflow data for U.S. Geological Survey streamgage 05054000, Red 
River of the North at Fargo, North Dakota, are provided for the 
vignette. The vignette provides the code (commented out) to import 
the data from the USGS, but such a large retrieval can timeout, so 
the data are provided with the package.
</p>


<h3>Source</h3>

<p>Imported from the USGS Daily Values Site Web Service 
<a href="http://waterservices.usgs.gov/rest/DV-Service.html">http://waterservices.usgs.gov/rest/DV-Service.html</a> (U.S. 
Geological Survey, 2014) using the function <a href="#topic+importDVs">importDVs</a>.
</p>


<h3>References</h3>

<p>U.S. Geological Survey, 2014, National Water Information System (NWISWeb): 
U.S. Geological Survey database, accessed November 18, 2014, at 
<a href="http://waterservices.usgs.gov/">http://waterservices.usgs.gov/</a>.
</p>

<hr>
<h2 id='siteInfo'>Retrieve site information</h2><span id='topic+siteInfo'></span>

<h3>Description</h3>

<p>Function to retrieve information about a USGS streamgage site
</p>


<h3>Usage</h3>

<pre><code class='language-R'>siteInfo(staid)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="siteInfo_+3A_staid">staid</code></td>
<td>
<p>is a character vector containing USGS site
identification number(s).  USGS site numbers are usually eight digits long, 
but can be longer.  Users may search for surface-water sites and obtain 
station identification numbers using the USGS Site Web Service, 
<a href="https://waterservices.usgs.gov/rest/Site-Service.html">https://waterservices.usgs.gov/rest/Site-Service.html</a> (U.S. Geological 
Survey, 2017b); using the National Water Information System: Mapper, 
<a href="https://maps.waterdata.usgs.gov/mapper/index.html">https://maps.waterdata.usgs.gov/mapper/index.html</a> (U.S. Geological Survey, 2017a); 
or using the National Water Information System: Web Interface to daily 
surface-water data, 
<a href="https://waterdata.usgs.gov/nwis/dv/?referred_module=sw">https://waterdata.usgs.gov/nwis/dv/?referred_module=sw</a> (U.S. 
Geological Survey, 2017c).  The site identification number needs to be 
entered as a character, that is in quotes, because many USGS streamgage 
numbers begin with zero and the leading zero is necessary.</p>
</td></tr>
</table>


<h3>Format</h3>

<p>a data frame with the following columns:
</p>

<table>
<tr>
 <td style="text-align: left;">
Name </td><td style="text-align: left;"> Type </td><td style="text-align: left;"> Description </td>
</tr>
<tr>
 <td style="text-align: left;"> 
staid </td><td style="text-align: left;"> factor </td><td style="text-align: left;"> USGS station identification number </td>
</tr>
<tr>
 <td style="text-align: left;">
staname </td><td style="text-align: left;"> character </td><td style="text-align: left;"> USGS station name </td>
</tr>
<tr>
 <td style="text-align: left;">
lat </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Decimal latitude </td>
</tr>
<tr>
 <td style="text-align: left;">
lng </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Decimal longitude
</td>
</tr>

</table>


<h3>Details</h3>

<p>This provides some limited metadata about the USGS streamgage site.
</p>


<h3>Value</h3>

<p>a data frame containing the station identification number(s), the 
USGS streamgage name(s), the decimal latitude(s), and decimal longitude(s).
</p>


<h3>Note</h3>

<p>Information retrieved using this function can be used to create a map of
multiple streamgage sites&mdash;see package vignette.
</p>


<h3>References</h3>

<p>U.S. Geological Survey, 2017a, National Water Information System: Mapper, 
accessed January 3, 2017, at 
<a href="https://maps.waterdata.usgs.gov/mapper/index.html">https://maps.waterdata.usgs.gov/mapper/index.html</a>.
</p>
<p>U.S. Geological Survey, 2017b, USGS site web service: 
REST Web Services, accessed January 3, 2017, at 
<a href="https://waterservices.usgs.gov/rest/Site-Service.html">https://waterservices.usgs.gov/rest/Site-Service.html</a>.
</p>
<p>U.S. Geological Survey, 2017c, USGS surface-water daily data for the Nation: 
National Water Information System: Web Interface, accessed January 3, 2017, 
at <a href="https://waterdata.usgs.gov/nwis/dv/?referred_module=sw">https://waterdata.usgs.gov/nwis/dv/?referred_module=sw</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> ## Not run: 
staInfo &lt;- siteInfo("05054000")
staInfo
staInfo &lt;- siteInfo(c("05054000", "05082500", "06342500"))
staInfo
# a list with an invalid station identification number
staInfo &lt;- siteInfo(c("05054000", "05082500", "0642501"))
 
## End(Not run)
</code></pre>

<hr>
<h2 id='summaryStats'>Calculate summary statistics</h2><span id='topic+summaryStats'></span>

<h3>Description</h3>

<p>Function to calculate summary statistics for daily hydrologic time series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summaryStats(dataset, staid = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summaryStats_+3A_dataset">dataset</code></td>
<td>
<p>is the data frame containing hydrologic data</p>
</td></tr>
<tr><td><code id="summaryStats_+3A_staid">staid</code></td>
<td>
<p>is used to label the output</p>
</td></tr>
</table>


<h3>Format</h3>

<p>The returned matrix has the following columns, which are formatted
for putting in a report or table. <br />
</p>

<table>
<tr>
 <td style="text-align: left;">
Name </td><td style="text-align: left;"> Type </td><td style="text-align: left;"> Description </td>
</tr>
<tr>
 <td style="text-align: left;"> 
Begin </td><td style="text-align: left;"> character </td><td style="text-align: left;"> The beginning date of the time series </td>
</tr>
<tr>
 <td style="text-align: left;">
End </td><td style="text-align: left;"> character </td><td style="text-align: left;"> The ending date of the time series </td>
</tr>
<tr>
 <td style="text-align: left;">
n </td><td style="text-align: left;"> character </td><td style="text-align: left;"> Number of rows </td>
</tr>
<tr>
 <td style="text-align: left;">
NA </td><td style="text-align: left;"> character </td><td style="text-align: left;"> Number of missing values </td>
</tr>
<tr>
 <td style="text-align: left;">
Neg </td><td style="text-align: left;"> character </td><td style="text-align: left;"> Number of negative values </td>
</tr>
<tr>
 <td style="text-align: left;">
Min </td><td style="text-align: left;"> character </td><td style="text-align: left;"> The minimum value </td>
</tr>
<tr>
 <td style="text-align: left;">
Q1 </td><td style="text-align: left;"> character </td><td style="text-align: left;"> The first quartile, 25th percentile </td>
</tr>
<tr>
 <td style="text-align: left;">
Med </td><td style="text-align: left;"> character </td><td style="text-align: left;"> The median </td>
</tr>
<tr>
 <td style="text-align: left;">
Mean </td><td style="text-align: left;"> character </td><td style="text-align: left;"> The mean </td>
</tr>
<tr>
 <td style="text-align: left;">
Q3 </td><td style="text-align: left;"> character </td><td style="text-align: left;"> The third quartile, 75th percentile </td>
</tr>
<tr>
 <td style="text-align: left;">
Max </td><td style="text-align: left;"> character </td><td style="text-align: left;"> The maximum value </td>
</tr>
<tr>
 <td style="text-align: left;">
StdDev </td><td style="text-align: left;"> character </td><td style="text-align: left;"> The standard deviation </td>
</tr>
<tr>
 <td style="text-align: left;">
IQR </td><td style="text-align: left;"> character </td><td style="text-align: left;"> The interquartile range </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>


<h3>Details</h3>

<p>The summary statistics returned are useful for exploratory data analysis 
and for describing the date set.
</p>


<h3>Value</h3>

<p>a data frame containing a number of summary statistics of the daily 
hydrologic data series
</p>


<h3>Note</h3>

<p>Hydrologic data are often skewed (Helsel and Hirsch, 2002).  Summary 
statistics help describe the degree of skewness and help to determine
the degree of applicability of hypothesis tests.  Some data, in particular
streamflow, may need to be transformed to produce approximately normal
data.
</p>


<h3>References</h3>

<p>Helsel, D.R. and Hirsch, R. M., 2002, Statistical methods in water resources: 
U.S. Geolgical Survey Techniques of Water Resources Investigations, book 4, 
chap. A3, 522 p. (Also available at <a href="http://pubs.usgs.gov/twri/twri4a3/">http://pubs.usgs.gov/twri/twri4a3/</a>).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampleWaterData)
summaryStats(pH05082500, staid="05082500")
</code></pre>

<hr>
<h2 id='tellMeSiteURL'>USGS Site Information Service URL</h2><span id='topic+tellMeSiteURL'></span>

<h3>Description</h3>

<p>Function that returns USGS Site Information Service URL for troubleshooting or 
building a URL for other purposes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tellMeSiteURL(staid)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tellMeSiteURL_+3A_staid">staid</code></td>
<td>
<p>is the USGS site identification number, which 
is usually eight digits long, but can be longer.  Users may search for 
surface-water sites and obtain station identification numbers using the 
USGS Site Web Service, 
<a href="https://waterservices.usgs.gov/rest/Site-Service.html">https://waterservices.usgs.gov/rest/Site-Service.html</a> (U.S. Geological 
Survey, 2017b); using the National Water Information System: Mapper, 
<a href="https://maps.waterdata.usgs.gov/mapper/index.html">https://maps.waterdata.usgs.gov/mapper/index.html</a> (U.S. Geological Survey, 2017a); 
or using the National Water Information System: Web Interface to daily 
surface-water data, 
<a href="https://waterdata.usgs.gov/nwis/dv/?referred_module=sw">https://waterdata.usgs.gov/nwis/dv/?referred_module=sw</a> (U.S. 
Geological Survey, 2017c).  The site identification number needs to be 
entered as a character, that is in quotes, because many USGS streamgage 
numbers begin with zero and the leading zero is necessary.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>URL for USGS site information
</p>


<h3>References</h3>

<p>U.S. Geological Survey, 2017a, National Water Information System: Mapper, 
accessed January 3, 2017, at 
<a href="https://maps.waterdata.usgs.gov/mapper/index.html">https://maps.waterdata.usgs.gov/mapper/index.html</a>.
</p>
<p>U.S. Geological Survey, 2017b, USGS site web service: 
REST Web Services, accessed January 3, 2017, at 
<a href="https://waterservices.usgs.gov/rest/Site-Service.html">https://waterservices.usgs.gov/rest/Site-Service.html</a>.
</p>
<p>U.S. Geological Survey, 2017c, USGS surface-water daily data for the Nation: 
National Water Information System: Web Interface, accessed January 3, 2017, 
at <a href="https://waterdata.usgs.gov/nwis/dv/?referred_module=sw">https://waterdata.usgs.gov/nwis/dv/?referred_module=sw</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>tellMeSiteURL("05054000")
</code></pre>

<hr>
<h2 id='tellMeURL'>USGS Daily Values Site Service URL</h2><span id='topic+tellMeURL'></span>

<h3>Description</h3>

<p>Function that returns USGS Daily Values Site Service URL for troubleshooting or 
building a URL for other purposes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tellMeURL(staid, code = "00060", stat = "00003", sdate = "1851-01-01",
  edate = as.Date(Sys.Date(), format = "%Y-%m-%d"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tellMeURL_+3A_staid">staid</code></td>
<td>
<p>is the USGS site identification number, which 
is usually eight digits long, but can be longer.  Users may search for 
surface-water sites and obtain station identification numbers using the 
USGS Site Web Service, 
<a href="https://waterservices.usgs.gov/rest/Site-Service.html">https://waterservices.usgs.gov/rest/Site-Service.html</a> (U.S. Geological 
Survey, 2017d); using the National Water Information System: Mapper, 
<a href="https://maps.waterdata.usgs.gov/mapper/index.html">https://maps.waterdata.usgs.gov/mapper/index.html</a> (U.S. Geological Survey, 2017a); 
or using the National Water Information System: Web Interface to daily 
surface-water data, 
<a href="https://waterdata.usgs.gov/nwis/dv/?referred_module=sw">https://waterdata.usgs.gov/nwis/dv/?referred_module=sw</a> (U.S. 
Geological Survey, 2017e).  The site identification number needs to be 
entered as a character, that is in quotes, because many USGS streamgage 
numbers begin with zero and the leading zero is necessary.</p>
</td></tr>
<tr><td><code id="tellMeURL_+3A_code">code</code></td>
<td>
<p>is the USGS parameter code, a 5-digit number 
used in the USGS computerized data system, National Water 
Information System (NWIS), to uniquely identify a specific hydrologic 
property or constituent.  A list of paramater codes is available at 
<a href="https://nwis.waterdata.usgs.gov/usa/nwis/pmcodes">https://nwis.waterdata.usgs.gov/usa/nwis/pmcodes</a> (U.S. Geological 
Survey, 2017b).</p>
</td></tr>
<tr><td><code id="tellMeURL_+3A_stat">stat</code></td>
<td>
<p>is the USGS statistics code, a 5-digit number 
used in the USGS computerized data system, NWIS, to uniquely identify 
specific statistics, such as daily mean, daily maximum, and daily minimum.  
The default,  00003,  is the mean daily value.  A list of statistics codes 
is available at 
<a href="https://nwis.waterdata.usgs.gov/nwis/help/?read_file=stat&amp;format=table">https://nwis.waterdata.usgs.gov/nwis/help/?read_file=stat&amp;format=table</a> 
(U.S. Geological Survey, 2017c).
Not all statistics are available at every gage.</p>
</td></tr>
<tr><td><code id="tellMeURL_+3A_sdate">sdate</code></td>
<td>
<p>is the start date of the time series, in the format yyyy-mm-dd.</p>
</td></tr>
<tr><td><code id="tellMeURL_+3A_edate">edate</code></td>
<td>
<p>is the end date of the time series, in the format yyyy-mm-dd.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>URL for USGS data
</p>


<h3>References</h3>

<p>U.S. Geological Survey, 2017a, National Water Information System: Mapper, 
accessed January 3, 2017, at 
<a href="https://maps.waterdata.usgs.gov/mapper/index.html">https://maps.waterdata.usgs.gov/mapper/index.html</a>.
</p>
<p>U.S. Geological Survey, 2017b, Parameter code definition, 
National Water Information System: Web Interface, accessed January 3, 
2017, at <a href="https://nwis.waterdata.usgs.gov/usa/nwis/pmcodes">https://nwis.waterdata.usgs.gov/usa/nwis/pmcodes</a>.
</p>
<p>U.S. Geological Survey, 2017c, Stat codes (stat_cd), 
National Water Information System: Web Interface, accessed January 3, 
2017, at 
<a href="https://nwis.waterdata.usgs.gov/nwis/help/?read_file=stat&amp;format=table">https://nwis.waterdata.usgs.gov/nwis/help/?read_file=stat&amp;format=table</a>.
</p>
<p>U.S. Geological Survey, 2017d, USGS site web service: 
REST Web Services, accessed January 3, 2017, at 
<a href="https://waterservices.usgs.gov/rest/Site-Service.html">https://waterservices.usgs.gov/rest/Site-Service.html</a>.
</p>
<p>U.S. Geological Survey, 2017e, USGS surface-water daily data for the Nation: 
National Water Information System: Web Interface, accessed January 3, 
2017, at <a href="http://waterdata.usgs.gov/nwis/dv/?referred_module=sw">http://waterdata.usgs.gov/nwis/dv/?referred_module=sw</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>tellMeURL("05054000", code="00060", stat="00003", sdate="2000-01-01", 
 edate=as.Date(Sys.Date(), format="%Y-%m-%d"))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
