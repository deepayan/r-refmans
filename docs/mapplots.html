<!DOCTYPE html><html lang="en"><head><title>Help for package mapplots</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {mapplots}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#mapplots-package'>
<p>Data visualisation on maps</p></a></li>
<li><a href='#add.pie'>
<p>Add pie plot to existing plot</p></a></li>
<li><a href='#barplot2D'>
<p>Draw 2-dimensional barplots</p></a></li>
<li><a href='#basemap'>
<p>Draw a (blank) map</p></a></li>
<li><a href='#breaks.grid'>
<p>Define breakpoints for colour scales</p></a></li>
<li><a href='#coast'><p>Shapefile of the Irish and UK coastlines</p></a></li>
<li><a href='#draw.barplot2D'>
<p>Draw 2-dimensional barplots in an existing plot</p></a></li>
<li><a href='#draw.bubble'>
<p>Draw bubble plots in an existing plot</p></a></li>
<li><a href='#draw.grid'>
<p>Display a grd object as a heatmap</p></a></li>
<li><a href='#draw.pie'>
<p>Draw pie plots in an existing plot</p></a></li>
<li><a href='#draw.rect'>
<p>Draw ICES rectangles in an existing plot</p></a></li>
<li><a href='#draw.shape'>
<p>Draw shapefiles in an existing plot</p></a></li>
<li><a href='#draw.xy'>
<p>Draw xy sub-plots in an existing plot</p></a></li>
<li><a href='#effort'><p>Spatially disaggregated fishing effort and landings data</p></a></li>
<li><a href='#get.asp'>
<p>Get the current aspect ratio of a plot</p></a></li>
<li><a href='#ices.rect'>
<p>Convert ICES rectangles from or to geographical coordinates</p></a></li>
<li><a href='#landings'><p>Spatially disaggregated landings data</p></a></li>
<li><a href='#legend.box'>
<p>Define location of a legend box.</p></a></li>
<li><a href='#legend.bubble'>
<p>Legend for bubble plot</p></a></li>
<li><a href='#legend.grid'>
<p>Legend for</p></a></li>
<li><a href='#legend.pie'>
<p>Legend for pie plots</p></a></li>
<li><a href='#make.grid'>
<p>Create grd object</p></a></li>
<li><a href='#make.multigrid'>
<p>Create a grd object</p></a></li>
<li><a href='#make.xyz'>
<p>Create xyz object</p></a></li>
<li><a href='#progressMsg'>
<p>Progress message</p></a></li>
<li><a href='#write.grid'>
<p>Export a grd object as csv or shapefile</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Data Visualisation on Maps</td>
</tr>
<tr>
<td>Version:</td>
<td>1.5.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-08-21</td>
</tr>
<tr>
<td>Author:</td>
<td>Hans Gerritsen</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Hans Gerritsen &lt;hans.gerritsen@marine.ie&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>shapefiles</td>
</tr>
<tr>
<td>Description:</td>
<td>Create simple maps; add sub-plots like pie plots to a map or any other plot; format, plot and export gridded data. The package was developed for displaying fisheries data but most functions can be used for more generic data visualisation. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-25 07:55:55 UTC; hgerritsen</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-25 09:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='mapplots-package'>
Data visualisation on maps
</h2><span id='topic+mapplots-package'></span><span id='topic+mapplots'></span>

<h3>Description</h3>

<p>Create simple maps; add sub-plots like pie plots to a map or any other plot; format, plot and export gridded data. The package was developed for displaying fisheries data but most functions can be used for more generic data visualisation.
For a complete list of functions with individual help pages, use <code>library(help="mapplots")</code>.
</p>


<h3>Details</h3>

<p>The starting point is generally the function <code><a href="#topic+basemap">basemap</a></code> which creates a blank map (although most mapplots functions could be applied to any plot, not just maps). Coastlines or other features can be added to the map with the function <code><a href="#topic+draw.shape">draw.shape</a></code>. ICES rectangles can also be displayed on the map and axes by <code><a href="#topic+draw.rect">draw.rect</a></code>. The main purpose of this package is to visualise data on maps. For univariate data, the main functions are <code><a href="#topic+draw.bubble">draw.bubble</a></code> (bubble plots) and <code><a href="#topic+draw.grid">draw.grid</a></code> (heat maps). Multivariate data can be displayed with <code><a href="#topic+draw.barplot2D">draw.barplot2D</a></code> ('square pie plots'), <code><a href="#topic+draw.pie">draw.pie</a></code> (pie plots) and <code><a href="#topic+draw.xy">draw.xy</a></code> (xy or barplots). Some of these have a specific function for displaying a legend: <code><a href="#topic+legend.bubble">legend.bubble</a></code>, <code><a href="#topic+legend.grid">legend.grid</a></code> and <code><a href="#topic+legend.pie">legend.pie</a></code>. The following functions can help to get data in the right format for plotting: <code><a href="#topic+make.grid">make.grid</a></code> and <code><a href="#topic+make.multigrid">make.multigrid</a></code> (to create grd objects for <code><a href="#topic+draw.grid">draw.grid</a></code>) and <code><a href="#topic+make.xyz">make.xyz</a></code> (to create xyz objects for <code><a href="#topic+draw.barplot2D">draw.barplot2D</a></code> and <code><a href="#topic+draw.pie">draw.pie</a></code>). Finally, there is a functions to export grd objects as csv or shapefiles: <code><a href="#topic+write.grid">write.grid</a></code>. The remaining functions are called by the main funcions listed above and were never intended to be used directly. However, they are documented and can be called directly.
</p>


<h3>Author(s)</h3>

<p>Hans Gerritsen
</p>
<p>Maintainer: &lt;hans.gerritsen@marine.ie&gt;
</p>

<hr>
<h2 id='add.pie'>
Add pie plot to existing plot
</h2><span id='topic+add.pie'></span>

<h3>Description</h3>

<p>This function is used by <code><a href="#topic+draw.pie">draw.pie</a></code> to add a pie plot at a specific location to an existing plot. It can be used directly but in general it is advisable to use <code><a href="#topic+draw.pie">draw.pie</a></code> instead.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add.pie(z, x = 0, y = 0, labels = names(z), radius = 1, edges = 200, clockwise = 
  TRUE, init.angle = 90, density = NULL, angle = 45, col = NULL, border = NULL, 
  lty =  NULL, label.dist = 1.1, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="add.pie_+3A_z">z</code></td>
<td>

<p>a vector of non-negative numerical quantities. The values in <code>z</code> are displayed as the areas of pie slices.
</p>
</td></tr>
<tr><td><code id="add.pie_+3A_x">x</code>, <code id="add.pie_+3A_y">y</code></td>
<td>

<p>the location of the centre of the pie on the x and y-scale of the existing plot.
</p>
</td></tr>
<tr><td><code id="add.pie_+3A_labels">labels</code></td>
<td>

<p>one or more expressions or character strings giving names for the slices. Other objects are coerced by <code><a href="grDevices.html#topic+as.graphicsAnnot">as.graphicsAnnot</a></code>. For empty or NA (after coercion to character) labels, no label nor pointing line is drawn.
</p>
</td></tr>
<tr><td><code id="add.pie_+3A_radius">radius</code></td>
<td>

<p>the radius of the pie in units of the y-scale
</p>
</td></tr>
<tr><td><code id="add.pie_+3A_edges">edges</code></td>
<td>

<p>the circular outline of the pie is approximated by a polygon with this many edges.
</p>
</td></tr>
<tr><td><code id="add.pie_+3A_clockwise">clockwise</code></td>
<td>

<p>logical indicating if slices are drawn clockwise or counter clockwise (i.e., mathematically positive direction), the former is default.
</p>
</td></tr>
<tr><td><code id="add.pie_+3A_init.angle">init.angle</code></td>
<td>

<p>number specifying the starting angle (in degrees) for the slices. see <code><a href="graphics.html#topic+pie">pie</a></code> for details.
</p>
</td></tr>
<tr><td><code id="add.pie_+3A_density">density</code></td>
<td>

<p>the density of shading lines, in lines per inch. The default value of NULL means that no shading lines are drawn. Non-positive values of density also inhibit the drawing of shading lines.
</p>
</td></tr>
<tr><td><code id="add.pie_+3A_angle">angle</code></td>
<td>

<p>the slope of shading lines, given as an angle in degrees (counter-clockwise).
</p>
</td></tr>
<tr><td><code id="add.pie_+3A_col">col</code></td>
<td>

<p>a vector of colors to be used in filling or shading the slices. If missing a set of 6 pastel colours is used, unless density is specified when par(&quot;fg&quot;) is used.
</p>
</td></tr>
<tr><td><code id="add.pie_+3A_border">border</code></td>
<td>

<p>(possibly vector) argument passed to polygon which draws each slice.
</p>
</td></tr>
<tr><td><code id="add.pie_+3A_lty">lty</code></td>
<td>

<p>(possibly vector) argument passed to polygon which draws each slice.
</p>
</td></tr>
<tr><td><code id="add.pie_+3A_label.dist">label.dist</code></td>
<td>

<p>distance that the label is placed away from the pie (relative to the radius)
</p>
</td></tr>
<tr><td><code id="add.pie_+3A_...">...</code></td>
<td>

<p><code><a href="graphics.html#topic+graphical+20parameters">graphical parameters</a></code> can be given as arguments to pie. They will affect the main title and labels only.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Because this function is intended to add pie plots to a map, the radius is scaled to units on the y-scale. This is more convenient than using the x-scale as 1 degree latitude is exactly 60 nautical miles. (The conversion from degrees to distance on the x-scale is less straightforward as it depends on the latitude).
</p>


<h3>Note</h3>

<p>The function obtaines the aspect ratio of the current plot from <code><a href="#topic+get.asp">get.asp</a></code> in order to draw circular pies. If the plot window is re-sized and <code>asp</code> is not defined in <code><a href="graphics.html#topic+par">par</a></code> then the pies will end up being oval.
</p>


<h3>Author(s)</h3>

<p>Adapted from the function <code><a href="graphics.html#topic+pie">pie</a></code> by Hans Gerritsen
</p>


<h3>See Also</h3>

<p><code><a href="#topic+draw.pie">draw.pie</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot(NA,NA, xlim=c(-1,1), ylim=c(-1,1) )
add.pie(z=rpois(6,10), x=-0.5, y=0.5, radius=0.5)
add.pie(z=rpois(4,10), x=0.5, y=-0.5, radius=0.3)
</code></pre>

<hr>
<h2 id='barplot2D'>
Draw 2-dimensional barplots 
</h2><span id='topic+barplot2D'></span>

<h3>Description</h3>

<p>This function is used by <code><a href="#topic+draw.barplot2D">draw.barplot2D</a></code> to add a 2-dimensional barplot at a specific location to an existing plot. It can be used directly but in general it is advisable to use <code><a href="#topic+draw.barplot2D">draw.barplot2D</a></code> instead.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>barplot2D(z, x = 0, y = 0, width = 1, height = 1, colour, add = TRUE, col.frame = NULL, 
	lwd.frame = 1, threshold = 1.1, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="barplot2D_+3A_z">z</code></td>
<td>

<p>vector, containing positive numbers (NAs are discarded), to be used as the area of the rectangles 
</p>
</td></tr>
<tr><td><code id="barplot2D_+3A_colour">colour</code></td>
<td>

<p>a vector (same length as <code>z</code>) of colors to be used in filling the rectangles
</p>
</td></tr>
<tr><td><code id="barplot2D_+3A_x">x</code>, <code id="barplot2D_+3A_y">y</code></td>
<td>

<p>the location of the centre of the pie on the x and y-scale of the existing plot.
</p>
</td></tr>
<tr><td><code id="barplot2D_+3A_width">width</code>, <code id="barplot2D_+3A_height">height</code></td>
<td>

<p>the width and height of the 2D barplot (user coordinate units).
</p>
</td></tr>
<tr><td><code id="barplot2D_+3A_add">add</code></td>
<td>

<p>logical, should the 2D barplot be added to an existing plot&gt; Defaults to TRUE
</p>
</td></tr>
<tr><td><code id="barplot2D_+3A_col.frame">col.frame</code></td>
<td>

<p>the colour of the frame of the 2D barplot
</p>
</td></tr>
<tr><td><code id="barplot2D_+3A_lwd.frame">lwd.frame</code></td>
<td>

<p>the line width of the frame of the 2D barplot
</p>
</td></tr>
<tr><td><code id="barplot2D_+3A_threshold">threshold</code></td>
<td>

<p>the maximum acceptable aspect ratio of the rectangles 
</p>
</td></tr>
<tr><td><code id="barplot2D_+3A_...">...</code></td>
<td>

<p>arguments to be passed to <code><a href="graphics.html#topic+polygon">polygon</a></code>
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The algorithm that determines the location of each rectangle within the 2D-barplot is as follows: 1) Start with a rectangle representing the highest value of <code>z</code>. 2) Try to put the first rectangle on the left. 3) If it too elongated, try to put two rectangles, on top of each other, on the left. 4) When you have placed those rectangles, proceed with the remaining rectangles.
</p>
<p>More precisely, we choose the number of rectables to stack so as to minimize the following penalty: penalty for the first rectangle in the stack + penalty for the last where the penalty of a rectangle is: <code>ratio - 1.1</code>. where <code>ratio</code> is the ratio of the longer side by the smaller.
</p>


<h3>Author(s)</h3>

<p>Adapted by Hans Gerritsen
</p>


<h3>References</h3>

<p>This function was adapted from code pulbished on <a href="http://zoonek2.free.fr/UNIX/48_R/03.html">http://zoonek2.free.fr/UNIX/48_R/03.html</a> (accessed 1 Jun 2012).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+draw.barplot2D">draw.barplot2D</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot(NA,NA, xlim=c(-1,1), ylim=c(-1,1) )
barplot2D(z=rpois(6,10), x=-0.5, y=0.5, width=0.75, height=0.75, colour=rainbow(6))
barplot2D(z=rpois(4,10), x=0.5, y=-0.5, width=0.5, height=0.5, colour=rainbow(4))
</code></pre>

<hr>
<h2 id='basemap'>
Draw a (blank) map 
</h2><span id='topic+basemap'></span>

<h3>Description</h3>

<p>A blank map is created that has approximatedly the correct aspect ratio for its latitude.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>basemap(xlim, ylim, xlab = "Longitude", ylab = "Latitude", bg = "lightblue", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="basemap_+3A_xlim">xlim</code></td>
<td>

<p>the x limits (x1, x2) of the plot.
</p>
</td></tr>
<tr><td><code id="basemap_+3A_ylim">ylim</code></td>
<td>

<p>the y limits of the plot.
</p>
</td></tr>
<tr><td><code id="basemap_+3A_xlab">xlab</code></td>
<td>

<p>a label for the x axis, defaults to &quot;Longitude&quot;.
</p>
</td></tr>
<tr><td><code id="basemap_+3A_ylab">ylab</code></td>
<td>

<p>a label for the y axis, defaults to &quot;Latitude&quot;.
</p>
</td></tr>
<tr><td><code id="basemap_+3A_bg">bg</code></td>
<td>

<p>background colour for the map, defaults to &quot;lightblue&quot;.
</p>
</td></tr>
<tr><td><code id="basemap_+3A_...">...</code></td>
<td>

<p>other arguments to be passed to <code><a href="graphics.html#topic+plot.default">plot.default</a></code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The aspect ratio of the map is based on the approximation that the earth is a perfect sphere of 21600 nautical miles in circumference. The straight-line distance between two medidians that lie 1 degree apart is then 60 nautical miles <code style="white-space: pre;">&#8288;*&#8288;</code> cos(latitude). The aspect ratio is therefore set at the inverse of the cosine of the latitude at the middle of the y-scale.
If the plot window is re-sized the aspect ratio will remain correct but the background colour will not fill the full plot area.
</p>


<h3>Author(s)</h3>

<p>Hans Gerritsen
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(landings)
data(coast)
xlim &lt;- c(-11,-5.5)
ylim &lt;- c(51.5,55.5)
basemap(xlim, ylim)
draw.shape(coast, col="cornsilk")
</code></pre>

<hr>
<h2 id='breaks.grid'>
Define breakpoints for colour scales
</h2><span id='topic+breaks.grid'></span>

<h3>Description</h3>

<p>This function can be used to define breakpoints for use with the functions <code><a href="#topic+draw.grid">draw.grid</a></code> and <code><a href="#topic+legend.grid">legend.grid</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>breaks.grid(grd, quantile = 0.975, ncol = 12, zero = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="breaks.grid_+3A_grd">grd</code></td>
<td>

<p>an array produced by <code><a href="#topic+make.grid">make.grid</a></code> or a list produced by <code><a href="#topic+make.multigrid">make.multigrid</a></code> or a vector of positive values.
</p>
</td></tr>
<tr><td><code id="breaks.grid_+3A_quantile">quantile</code></td>
<td>

<p>the maximum value of the breaks will be determined by the quantile given here. This can be used to deal with outlying values in <code>grd</code>. If <code>quantile = 1</code> then the maximum value of the breaks will be the same as the maximum value in <code>grd</code>.
</p>
</td></tr>
<tr><td><code id="breaks.grid_+3A_ncol">ncol</code></td>
<td>

<p>number of colours to be used, always one more than the number of breakpoints. Defaults to 12.
</p>
</td></tr>
<tr><td><code id="breaks.grid_+3A_zero">zero</code></td>
<td>

<p>logical, should zero be included as a separate category? Defaults to <code>TRUE</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of breakpoints to be used by <code><a href="#topic+draw.grid">draw.grid</a></code> and <code><a href="#topic+legend.grid">legend.grid</a></code>
</p>


<h3>Author(s)</h3>

<p>Hans Gerritsen
</p>


<h3>See Also</h3>

<p><code><a href="#topic+draw.grid">draw.grid</a></code>, <code><a href="#topic+legend.grid">legend.grid</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>breaks.grid(100,ncol=6)
breaks.grid(100,ncol=5,zero=FALSE)

# create breaks on the log scale
exp(breaks.grid(log(10000),ncol=4,zero=FALSE))
</code></pre>

<hr>
<h2 id='coast'>Shapefile of the Irish and UK coastlines</h2><span id='topic+coast'></span>

<h3>Description</h3>

<p>Shapefile list object (see: <code><a href="shapefiles.html#topic+shapefiles">shapefiles</a></code>) of the Irish and UK coastline.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(coast)</code></pre>


<h3>Format</h3>

<p>shapefile list object</p>


<h3>Source</h3>

<p>GSHHS A Global Self-consistent, Hierarchical, High-resolution Shoreline Database.</p>


<h3>References</h3>

<p><a href="https://www.ngdc.noaa.gov/mgg/shorelines/gshhs.html">https://www.ngdc.noaa.gov/mgg/shorelines/gshhs.html</a>
</p>

<hr>
<h2 id='draw.barplot2D'>
Draw 2-dimensional barplots in an existing plot
</h2><span id='topic+draw.barplot2D'></span>

<h3>Description</h3>

<p>2-Dimensional barplots are essentially rectangular pieplots. These plots can be used to display proportional data in certain locations on a map.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>draw.barplot2D(x, y, z, width, height, scale = F, col = NULL, col.frame = "black", 
	lwd.frame = 1, silent = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="draw.barplot2D_+3A_x">x</code>, <code id="draw.barplot2D_+3A_y">y</code></td>
<td>

<p>vector with x and y-locations of the centre of the 2D barplots
</p>
</td></tr>
<tr><td><code id="draw.barplot2D_+3A_z">z</code></td>
<td>

<p>array where the rows correspond to <code>x</code> and <code>y</code> and the columns correspond to categories to be plotted. The function <code><a href="#topic+make.xyz">make.xyz</a></code> can be useful to create <code>z</code>.
</p>
</td></tr>
<tr><td><code id="draw.barplot2D_+3A_width">width</code></td>
<td>

<p>the width of the (largest) 2D barplot (user coordinate units). This can be a single value or a vector with the same length as <code>x</code>.
</p>
</td></tr>
<tr><td><code id="draw.barplot2D_+3A_height">height</code></td>
<td>

<p>the width of the (largest) 2D barplot see <code>width</code>
</p>
</td></tr>
<tr><td><code id="draw.barplot2D_+3A_scale">scale</code></td>
<td>

<p>logical, should the surface area of each 2d-barplot automatically be scaled to the sum of its z-values? Only works if <code>width</code> and <code>height</code> are vectors with a length of 1.
</p>
</td></tr>
<tr><td><code id="draw.barplot2D_+3A_col">col</code></td>
<td>

<p>a vector (same length as the number of columns in <code>z</code>) of colors to be used in filling the rectangles
</p>
</td></tr>
<tr><td><code id="draw.barplot2D_+3A_col.frame">col.frame</code></td>
<td>

<p>the colour of the frame of the 2D barplot
</p>
</td></tr>
<tr><td><code id="draw.barplot2D_+3A_lwd.frame">lwd.frame</code></td>
<td>

<p>the line width of the frame of the 2D barplot
</p>
</td></tr>
<tr><td><code id="draw.barplot2D_+3A_silent">silent</code></td>
<td>

<p>logical, should a progress message be displayed in the console? Defaults to <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="draw.barplot2D_+3A_...">...</code></td>
<td>

<p>arguments to be passed to <code><a href="#topic+barplot2D">barplot2D</a></code>, particlarly <code>border</code>, which determines the colour of the borders of the rectangles (as opposed to the frame around each 2D barplot which is controlled by <code>col.frame</code>. Other relevant arguments include <code>density</code> and <code>lwd</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The algorithm that determines the location of each rectangle within the 2D-barplot is as follows: 1) Start with a rectangle representing the highest value of <code>z</code>. 2) Try to put the first rectangle on the left. 3) If it too elongated, try to put two rectangles, on top of each other, on the left. 4) When you have placed those rectangles, proceed with the remaining rectangles.
</p>
<p>More precisely, we choose the number of rectables to stack so as to minimize the following penalty: penalty for the first rectangle in the stack + penalty for the last where the penalty of a rectangle is: <code>ratio - 1.1</code>. where <code>ratio</code> is the ratio of the longer side by the smaller.
</p>


<h3>Author(s)</h3>

<p>Adapted by Hans Gerritsen
</p>


<h3>References</h3>

<p>This function was adapted from <a href="http://zoonek2.free.fr/UNIX/48_R/03.html">http://zoonek2.free.fr/UNIX/48_R/03.html</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(landings)
data(coast)
xlim &lt;- c(-15,0)
ylim &lt;- c(50,56)
xyz &lt;- make.xyz(landings$Lon,landings$Lat,landings$LiveWeight,landings$Species)
col &lt;- rainbow(5)
basemap(xlim, ylim, main = "Species composition of gadoid landings")
draw.shape(coast, col="cornsilk")
draw.barplot2D(xyz$x, xyz$y, xyz$z, width = 0.8, height = 0.4, col=col)
legend("topright", legend=colnames(xyz$z), fill=col, bg="lightblue", inset=0.02)  
 
basemap(xlim, ylim, main = "Species composition of gadoid landings")
draw.shape(coast, col="cornsilk")
draw.barplot2D(xyz$x, xyz$y, xyz$z, width = 1, height = 0.5, scale=TRUE, col=col)
legend("topright", legend=colnames(xyz$z), fill=col, bg="lightblue", inset=0.02)
</code></pre>

<hr>
<h2 id='draw.bubble'>
Draw bubble plots in an existing plot
</h2><span id='topic+draw.bubble'></span>

<h3>Description</h3>

<p>Bubble plots are plots of circles whose surfaces areas are proportional to values in <code>z</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>draw.bubble(x, y, z, maxradius = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="draw.bubble_+3A_x">x</code>, <code id="draw.bubble_+3A_y">y</code></td>
<td>

<p>vector with x and y-locations of the centre of the bubbles.
</p>
</td></tr>
<tr><td><code id="draw.bubble_+3A_z">z</code></td>
<td>

<p>vector with positive values to correspond with the surface area of the bubbles.
</p>
</td></tr>
<tr><td><code id="draw.bubble_+3A_maxradius">maxradius</code></td>
<td>

<p>the radius of the largest bubble in units of the y-scale.
</p>
</td></tr>
<tr><td><code id="draw.bubble_+3A_...">...</code></td>
<td>

<p>other arguments to be passed to <code><a href="graphics.html#topic+points">points</a></code>
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Hans Gerritsen
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(landings)
data(coast)
xlim &lt;- c(-12,-5)
ylim &lt;- c(50,56)
agg &lt;- aggregate(list(z=landings$LiveWeight),list(x=landings$Lon,y=landings$Lat),sum)
basemap(xlim, ylim, main = "Gadoid landings")
draw.shape(coast, col="cornsilk")
draw.bubble(agg$x, agg$y, agg$z, maxradius=0.5, pch=21, bg="#00FF0050")
legend.z &lt;- round(max(agg$z)/1000,0)
legend.bubble("topright", z=legend.z, maxradius=0.5, inset=0.02, bg="lightblue", txt.cex=0.8,
 pch=21, pt.bg="#00FF0050")
</code></pre>

<hr>
<h2 id='draw.grid'>
Display a grd object as a heatmap
</h2><span id='topic+draw.grid'></span>

<h3>Description</h3>

<p>Displays a grid of colored or gray-scale rectangles with colors corresponding to the values in z. This can be used to display three-dimensional or spatial data as images.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>draw.grid(grd, breaks = NULL, col = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="draw.grid_+3A_grd">grd</code></td>
<td>

<p>a 2-dimensional array with data to be plotted. The row and column names should should correspond to the x and y locations of the gridlines at which the values are displayed. see <code><a href="#topic+make.grid">make.grid</a></code>.
</p>
</td></tr>
<tr><td><code id="draw.grid_+3A_breaks">breaks</code></td>
<td>

<p>a vector of breakpoints for the colours, must give one more breakpoint than colour.
</p>
</td></tr>
<tr><td><code id="draw.grid_+3A_col">col</code></td>
<td>

<p>a vector with colours. defaults to 12 colors ranging from white (lowest) through yellow and orange to red (highest).
</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The resulting maps are often referred to as heat maps although this is not strictly correct as red would imply the lowest and white the highest value (an object glowing white is hotter than an object glowing red). However using the scale in this way is counter-intuitive.
</p>


<h3>Author(s)</h3>

<p>Hans Gerritsen
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+image">image</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(coast)
data(landings)
byx = 1
byy = 0.5
xlim &lt;- c(-15.5,0)
ylim &lt;- c(50.25,56)
grd &lt;- make.grid(landings$Lon,landings$Lat,landings$LiveWeight, byx, byy, xlim, ylim)
breaks &lt;- breaks.grid(grd,zero=FALSE)
basemap(xlim, ylim, main = "Gadoid landings")
draw.grid(grd,breaks)
draw.shape(coast, col="darkgreen")
legend.grid("topright", breaks=breaks/1000, type=2, inset=0.02, title="tonnes")
</code></pre>

<hr>
<h2 id='draw.pie'>
Draw pie plots in an existing plot
</h2><span id='topic+draw.pie'></span>

<h3>Description</h3>

<p>Draw pie plots in an existing plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>draw.pie(x, y, z, radius, scale = T, labels = NA, silent = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="draw.pie_+3A_x">x</code>, <code id="draw.pie_+3A_y">y</code></td>
<td>

<p>vector with x and y-locations of the centre of the pies
</p>
</td></tr>
<tr><td><code id="draw.pie_+3A_z">z</code></td>
<td>

<p>array where the rows correspond to <code>x</code> and <code>y</code> and the columns correspond to categories to be plotted. The function <code><a href="#topic+make.xyz">make.xyz</a></code> can be useful to create <code>z</code>.
</p>
</td></tr>
<tr><td><code id="draw.pie_+3A_radius">radius</code></td>
<td>

<p>the radius of the (largest) pie (y-scale units). This can be a single value or a vector with the same length as <code>x</code>.
</p>
</td></tr>
<tr><td><code id="draw.pie_+3A_scale">scale</code></td>
<td>

<p>logical, should the surface area of each pie plot automatically be scaled to the sum of its z-values? Only works if <code>radius</code> is a vector with a length of 1.
</p>
</td></tr>
<tr><td><code id="draw.pie_+3A_labels">labels</code></td>
<td>

<p>labels for each slice. Defaults to NA, labels are probably best placed in a legend by legend.pie.
</p>
</td></tr>
<tr><td><code id="draw.pie_+3A_silent">silent</code></td>
<td>

<p>logical, should a progress message be displayed in the console? Defaults to <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="draw.pie_+3A_...">...</code></td>
<td>

<p>other arguments to be passed to <code><a href="#topic+add.pie">add.pie</a></code>
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Hans Gerritsen
</p>


<h3>See Also</h3>

<p><code><a href="#topic+add.pie">add.pie</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(landings)
data(coast)
xlim &lt;- c(-12,-5)
ylim &lt;- c(50,56)
xyz &lt;- make.xyz(landings$Lon,landings$Lat,landings$LiveWeight,landings$Species)
col &lt;- rainbow(5)
basemap(xlim, ylim, main = "Species composition of gadoid landings")
draw.shape(coast, col="cornsilk")
draw.pie(xyz$x, xyz$y, xyz$z, radius = 0.3, col=col)
legend.pie(-13.25,54.8,labels=c("cod","had","hke","pok","whg"), radius=0.3, bty="n", col=col,
 cex=0.8, label.dist=1.3)
legend.z &lt;- round(max(rowSums(xyz$z,na.rm=TRUE))/10^6,0)
legend.bubble(-13.25,55.5,z=legend.z,round=1,maxradius=0.3,bty="n",txt.cex=0.6)
text(-13.25,56,"landings (kt)",cex=0.8) 
</code></pre>

<hr>
<h2 id='draw.rect'>
Draw ICES rectangles in an existing plot
</h2><span id='topic+draw.rect'></span>

<h3>Description</h3>

<p>Draw ICES rectangles in an existing map and add axis labels to the top and righ axes.
ICES statistical rectangles (<a href="https://www.ices.dk">https://www.ices.dk</a>) are rectangles of 1 degree longitude x 0.5 degrees latitude. They are used for reporting of fishinge effort and landings.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>draw.rect(col = "grey", lty = 2, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="draw.rect_+3A_col">col</code></td>
<td>

<p>colour of the lines, defaults to &quot;grey&quot;.
</p>
</td></tr>
<tr><td><code id="draw.rect_+3A_lty">lty</code></td>
<td>

<p>line type, defaults to 2.
</p>
</td></tr>
<tr><td><code id="draw.rect_+3A_...">...</code></td>
<td>

<p>any other arguments to be passed to <code><a href="graphics.html#topic+abline">abline</a></code>.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Hans Gerritsen
</p>


<h3>References</h3>

<p><a href="https://www.ices.dk">https://www.ices.dk</a> 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+basemap">basemap</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>xlim &lt;- c(-15,0)
ylim &lt;- c(50,56)
basemap(xlim, ylim)
draw.rect()
</code></pre>

<hr>
<h2 id='draw.shape'>
Draw shapefiles in an existing plot
</h2><span id='topic+draw.shape'></span>

<h3>Description</h3>

<p>Draw shapefiles in an existing plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>draw.shape(shape, type = "poly", col = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="draw.shape_+3A_shape">shape</code></td>
<td>

<p>a shape list object created by (<code><a href="shapefiles.html#topic+shapefiles">shapefiles</a></code>
</p>
</td></tr>
<tr><td><code id="draw.shape_+3A_type">type</code></td>
<td>

<p>type of plot desired. The following values are possible: <code>"p"</code> for points, <code>"l"</code> or <code>"lines"</code> for lines and <code>"poly"</code> (default) for polygons.
</p>
</td></tr>
<tr><td><code id="draw.shape_+3A_col">col</code></td>
<td>

<p>the colour of the points, lines or polygons
</p>
</td></tr>
<tr><td><code id="draw.shape_+3A_...">...</code></td>
<td>

<p>other arguments to be passed to <code><a href="graphics.html#topic+points">points</a></code>, <code><a href="graphics.html#topic+lines">lines</a></code> or <code><a href="graphics.html#topic+polygon">polygon</a></code>
</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The shapefile needs to have the WGS 84 Geographic Coordinate System in order to display properly on a map of longitude and latitude.
</p>


<h3>Author(s)</h3>

<p>Hans Gerritsen
</p>


<h3>See Also</h3>

<p><code><a href="shapefiles.html#topic+read.shapefile">read.shapefile</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(shapefiles)
shp.file &lt;- file.path(system.file(package = "mapplots", "extdata"), "Ireland")
irl &lt;- read.shapefile(shp.file)
xlim &lt;- c(-11,-5.5)
ylim &lt;- c(51.5,55.5)
basemap(xlim, ylim)
draw.shape(irl, col="cornsilk")
</code></pre>

<hr>
<h2 id='draw.xy'>
Draw xy sub-plots in an existing plot
</h2><span id='topic+draw.xy'></span>

<h3>Description</h3>

<p>This function is intended to draw xy-plots or barplots in existing maps or other plots.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>draw.xy(x, y, xx, yy, xlim = NULL, ylim = NULL, width = 1, height = 0.5, bg = NULL, 
	border = 1, type = "p", col = 1, silent = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="draw.xy_+3A_x">x</code>, <code id="draw.xy_+3A_y">y</code></td>
<td>

<p>vectors with x and y-locations of the centre of the xy-plots.
</p>
</td></tr>
<tr><td><code id="draw.xy_+3A_xx">xx</code>, <code id="draw.xy_+3A_yy">yy</code></td>
<td>

<p>vectors (of the same length as <code>x</code>) with the x and y-values of the xy-plots
</p>
</td></tr>
<tr><td><code id="draw.xy_+3A_xlim">xlim</code>, <code id="draw.xy_+3A_ylim">ylim</code></td>
<td>

<p>the x and y-limits of the xy-plots. the same limits will apply to all xyplots. Defaults to <code>range(xx)</code> and <code>range(yy)</code>.
</p>
</td></tr>
<tr><td><code id="draw.xy_+3A_width">width</code>, <code id="draw.xy_+3A_height">height</code></td>
<td>

<p>the width and height of the xy-plot area (coordinate units of the main map or plot).
</p>
</td></tr>
<tr><td><code id="draw.xy_+3A_bg">bg</code></td>
<td>

<p>background colour of the xy-plots
</p>
</td></tr>
<tr><td><code id="draw.xy_+3A_border">border</code></td>
<td>

<p>the colour of the border of the xy-plots. <code>NA</code> will result in no border
</p>
</td></tr>
<tr><td><code id="draw.xy_+3A_type">type</code></td>
<td>

<p>the type of plot. See <code><a href="graphics.html#topic+plot.default">plot.default</a></code> for possible values. Also see Details section below
</p>
</td></tr>
<tr><td><code id="draw.xy_+3A_col">col</code></td>
<td>

<p>a single colour or a vector of colours (same length as <code>x</code>) for the plotting symbols.
</p>
</td></tr>
<tr><td><code id="draw.xy_+3A_silent">silent</code></td>
<td>

<p>logical, should a progress message be displayed in the console? Defaults to <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="draw.xy_+3A_...">...</code></td>
<td>

<p>other arguments to be passed to <code><a href="graphics.html#topic+points">points</a></code>
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>type = "h"</code> will result in plots that resemble barplots. These are not true barplots as the x-axis is not categorical. However if suitable <code>xx</code> data are provided and <code>lwd</code> is tweaked correctly for the current graphical device it will result in adequate plots.
</p>


<h3>Author(s)</h3>

<p>Hans Gerritsen
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(effort)
data(coast)
xlim &lt;- c(-12,-5)
ylim &lt;- c(51,54)
col &lt;- terrain.colors(12)
effort$col &lt;- col[match(effort$Month,1:12)]
basemap(xlim, ylim, main = "Monthly trends in haddock landings and fishing effort")
draw.rect(lty=1, col=1)
draw.shape(coast, col="cornsilk")
draw.xy(effort$Lon, effort$Lat, effort$Month, effort$LiveWeight, width=1, height=0.5,
 col=effort$col, type="h",lwd=3, border=NA)
draw.xy(effort$Lon, effort$Lat, effort$Month, effort$Effort, width=1, height=0.5, col="red",
 type="l", border=NA)
draw.xy(effort$Lon, effort$Lat, effort$Month, effort$Effort, width=1, height=0.5, col="red",
 type="p",cex=0.4,pch=16, border=NA)
legend("topleft", c(month.abb,"Effort"), pch=c(rep(22,12),16), pt.bg=c(col,NA),
 pt.cex=c(rep(2,12),0.8),col=c(rep(1,12),2), lty=c(rep(NA,12),1), bg="lightblue",
 inset=0.02, title="Landings", cex=0.8)
</code></pre>

<hr>
<h2 id='effort'>Spatially disaggregated fishing effort and landings data</h2><span id='topic+effort'></span>

<h3>Description</h3>

<p>Monthly fishing effort and haddock landings landings at a spatial resolution of 1 degree longitude and 0.5 degrees latitude. The data are from Irish otter trawlers in 2009.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(effort)</code></pre>


<h3>Format</h3>

<p>data frame</p>


<h3>Source</h3>

<p>EU Logbooks database</p>

<hr>
<h2 id='get.asp'>
Get the current aspect ratio of a plot
</h2><span id='topic+get.asp'></span>

<h3>Description</h3>

<p>This function is used by <code><a href="#topic+draw.pie">draw.pie</a></code> to draw circles (rather than ellipses) in existing plots.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.asp()
</code></pre>


<h3>Value</h3>

<p>Returns the aspect ratio of the current plot.
</p>


<h3>Note</h3>

<p>If the plot is re-sized <code>get.asp</code> is <strong>not</strong> automatically updated
</p>


<h3>Author(s)</h3>

<p>Hans Gerritsen
</p>


<h3>See Also</h3>

<p><code><a href="#topic+draw.pie">draw.pie</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot(1:10,(1:10)/10)
get.asp()
</code></pre>

<hr>
<h2 id='ices.rect'>
Convert ICES rectangles from or to geographical coordinates
</h2><span id='topic+ices.rect'></span><span id='topic+ices.rect2'></span>

<h3>Description</h3>

<p><code>ices.rect</code> converts the names of ICES statistical rectangles into geographical coordinates (midpoints).
<code>ices.rect2</code> converts geographical coordinates into ICES statistical rectangles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ices.rect(rectangle)
ices.rect2(lon, lat)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ices.rect_+3A_rectangle">rectangle</code></td>
<td>

<p>a characer vector with the names of ices rectangles. Note that the code can cope with rectangle names that have been converted into numbers by helpful microsoft office software, e.g. &quot;36E2&quot; tends to be converted to 3600.
</p>
</td></tr>
<tr><td><code id="ices.rect_+3A_lon">lon</code>, <code id="ices.rect_+3A_lat">lat</code></td>
<td>

<p>a vector with longitude and latitude (not neccesarily the mid-points of rectangles).
</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>ices.rect</code> will return a data frame with the midpoints of the ICES rectangles.
<code>ices.rect2</code> will return a vector with the names of the ICES rectangles.
</p>


<h3>Author(s)</h3>

<p>Hans Gerritsen
</p>


<h3>References</h3>

<p>ICES statistical rectangles <a href="https://www.ices.dk">https://www.ices.dk</a> are rectangles of 1 degree longitude x 0.5 degrees latitude. They are used for reporting of fishinge effort and landings.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># rectangle names to coordinates:
ices.rect(c("36E2","3600","40D8"))

# coordinates to rectangle names:
lon &lt;- rnorm(10,-10,2)
lat &lt;- rnorm(10,53,1)
rect &lt;- ices.rect2(lon,lat)
basemap(xlim=range(lon), ylim=range(lat) )
draw.rect()
points(lon,lat)
text(lon,lat,rect,cex=0.7,pos=3)
</code></pre>

<hr>
<h2 id='landings'>Spatially disaggregated landings data</h2><span id='topic+landings'></span>

<h3>Description</h3>

<p>Landings data of some gadoid species (cod, haddock, hake, saithe and whiting) at a spatial resolution of 1 degree longitude and 0.5 degrees latitude. The data are from Irish otter trawlers in 2009.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(landings)</code></pre>


<h3>Format</h3>

<p>data frame</p>


<h3>Source</h3>

<p>EU Logbooks database</p>

<hr>
<h2 id='legend.box'>
Define location of a legend box.
</h2><span id='topic+legend.box'></span>

<h3>Description</h3>

<p>Define a location of a legend box. Used by <code><a href="#topic+legend.bubble">legend.bubble</a></code> and <code><a href="#topic+legend.pie">legend.pie</a></code>. This is not intended as a user function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>legend.box(x, y = NULL, maxradius, mab = 1.2, inset = 0, double = F)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="legend.box_+3A_x">x</code>, <code id="legend.box_+3A_y">y</code></td>
<td>

<p>the x and y co-ordinates to be used to position the legend, see <code><a href="graphics.html#topic+legend">legend</a></code>.
</p>
</td></tr>
<tr><td><code id="legend.box_+3A_maxradius">maxradius</code></td>
<td>

<p>the (maximum) radius of the pie or bubble to be represented in the legend.
</p>
</td></tr>
<tr><td><code id="legend.box_+3A_mab">mab</code></td>
<td>

<p>the margin around the bubble or pie.
</p>
</td></tr>
<tr><td><code id="legend.box_+3A_inset">inset</code></td>
<td>

<p>inset distance(s) from the margins as a fraction of the plot region when legend is placed by keyword.
</p>
</td></tr>
<tr><td><code id="legend.box_+3A_double">double</code></td>
<td>

<p>logical, should the box be double the 'normal' size to allow for pies and bubbles to be displayed in a single legend box. generally not very pretty.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the corner points of the legend box in user coordinates 
</p>


<h3>Author(s)</h3>

<p>Hans Gerritsen
</p>


<h3>See Also</h3>

<p><code><a href="#topic+legend.bubble">legend.bubble</a></code>, <code><a href="#topic+legend.pie">legend.pie</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot(1)
box &lt;- legend.box("topleft", maxradius=0.2, inset=0.02)
rect(box[1],box[2],box[3],box[4], border="red", lwd=3, lty=2)
legend.bubble("topleft", z=10, maxradius=0.2, inset=0.02)
</code></pre>

<hr>
<h2 id='legend.bubble'>
Legend for bubble plot
</h2><span id='topic+legend.bubble'></span>

<h3>Description</h3>

<p>Draw a legend for a bubble plot (<code><a href="#topic+draw.bubble">draw.bubble</a></code>)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>legend.bubble(x, y = NULL, z, maxradius = 1, n = 3, round = 0, bty = "o", mab = 1.2, 
	bg = NULL, inset = 0, pch = 21, pt.bg = NULL, txt.cex = 1, 
	txt.col = NULL, font = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="legend.bubble_+3A_x">x</code>, <code id="legend.bubble_+3A_y">y</code></td>
<td>

<p>the x and y co-ordinates to be used to position the legend. <code>x</code> can be a keyword (e.g. <code>"topleft"</code>). See <code><a href="graphics.html#topic+legend">legend</a></code>.
</p>
</td></tr>
<tr><td><code id="legend.bubble_+3A_z">z</code></td>
<td>

<p>either a single value representing the largest bubble, in which case <code>n</code> determines how many bubbles are displayed; or a vector of z values which will be to be shown as bubbles in the legend.
</p>
</td></tr>
<tr><td><code id="legend.bubble_+3A_maxradius">maxradius</code></td>
<td>

<p>the radius of the largest bubble. this should match <code>maxradius</code> in <code><a href="#topic+draw.bubble">draw.bubble</a></code>.
</p>
</td></tr>
<tr><td><code id="legend.bubble_+3A_n">n</code></td>
<td>

<p>integer giving the number of bubbles that should be shown in the legend. Defaults to 3. Only relevant when z is a single value.
</p>
</td></tr>
<tr><td><code id="legend.bubble_+3A_round">round</code></td>
<td>

<p>integer indicating the number of decimal places to be used in the legend.
</p>
</td></tr>
<tr><td><code id="legend.bubble_+3A_bty">bty</code></td>
<td>

<p>single character indicating the type of box to be drawn around the legend. The allowed values are &quot;o&quot; (the default) and &quot;n&quot; (no box).
</p>
</td></tr>
<tr><td><code id="legend.bubble_+3A_mab">mab</code></td>
<td>

<p>the margin around the bubble. i.e. how much space should there be between the largest bubble and the legend box. relative to the size of the bubble.
</p>
</td></tr>
<tr><td><code id="legend.bubble_+3A_bg">bg</code></td>
<td>

<p>background colour of the legend box.
</p>
</td></tr>
<tr><td><code id="legend.bubble_+3A_inset">inset</code></td>
<td>

<p>inset distance(s) from the margins as a fraction of the plot region when legend is placed by keyword.
</p>
</td></tr>
<tr><td><code id="legend.bubble_+3A_pch">pch</code></td>
<td>

<p>plotting character, i.e., symbol to use. Defaults to 21.
</p>
</td></tr>
<tr><td><code id="legend.bubble_+3A_pt.bg">pt.bg</code></td>
<td>

<p>background (fill) color for the open plot symbols given by pch=21:25.
</p>
</td></tr>
<tr><td><code id="legend.bubble_+3A_txt.cex">txt.cex</code></td>
<td>

<p>character expansion for the legend text.
</p>
</td></tr>
<tr><td><code id="legend.bubble_+3A_txt.col">txt.col</code></td>
<td>

<p>colour of the legend text.
</p>
</td></tr>
<tr><td><code id="legend.bubble_+3A_font">font</code></td>
<td>

<p>An integer which specifies which font to use for text. See <code><a href="graphics.html#topic+graphical+20parameters">graphical parameters</a></code>
</p>
</td></tr>
<tr><td><code id="legend.bubble_+3A_...">...</code></td>
<td>

<p>any other arguments to be passed to <code><a href="graphics.html#topic+points">points</a></code>.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Hans Gerritsen
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(landings)
data(coast)
xlim &lt;- c(-12,-5)
ylim &lt;- c(50,56)
agg &lt;- aggregate(list(z=landings$LiveWeight),list(x=landings$Lon,y=landings$Lat),sum)
basemap(xlim, ylim, main = "Gadoid landings")
draw.shape(coast, col="cornsilk")
draw.bubble(agg$x, agg$y, agg$z, maxradius=0.5, pch=21, bg="#00FF0050")
legend.bubble("topright", z=round(max(agg$z)/1000,0), maxradius=0.5, inset=0.02, bg="lightblue",
 txt.cex=0.8, pch=21, pt.bg="#00FF0050")
</code></pre>

<hr>
<h2 id='legend.grid'>
Legend for 
</h2><span id='topic+legend.grid'></span>

<h3>Description</h3>

<p>Draw a legend for a <code><a href="#topic+draw.grid">draw.grid</a></code> plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>legend.grid(x, y = NULL, breaks, col ,digits = 2, suffix = "", type = 1, pch = 15,
	pt.cex = 2.5, bg = "lightblue", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="legend.grid_+3A_x">x</code>, <code id="legend.grid_+3A_y">y</code></td>
<td>

<p>the x and y co-ordinates to be used to position the legend. <code>x</code> can be a keyword (e.g. <code>"topleft"</code>). See <code><a href="graphics.html#topic+legend">legend</a></code>.
</p>
</td></tr>
<tr><td><code id="legend.grid_+3A_breaks">breaks</code></td>
<td>

<p>a vector of breakpoints for the colours, must give one more breakpoint than colour.
</p>
</td></tr>
<tr><td><code id="legend.grid_+3A_col">col</code></td>
<td>

<p>a vector with colours. defaults to colors ranging from white (lowest) through yellow and orange to red (highest).
</p>
</td></tr>
<tr><td><code id="legend.grid_+3A_digits">digits</code></td>
<td>

<p>integer indicating the number of significant places to be used in the legend. Defaults to 2.
</p>
</td></tr>
<tr><td><code id="legend.grid_+3A_suffix">suffix</code></td>
<td>

<p>character string to be placed after the legend entries, e.g. <code>"kg"</code>.
</p>
</td></tr>
<tr><td><code id="legend.grid_+3A_type">type</code></td>
<td>

<p>integer specifying the legend type, <code>1</code> will result in a single value for each colour (the average value for each colour category). Type <code>2</code> will result in a range being displayed for each colour category. This is more accurate but can make the legend take up a lot of space.
</p>
</td></tr>
<tr><td><code id="legend.grid_+3A_pch">pch</code></td>
<td>

<p>plotting character, i.e., symbol to use. This can either be a single character or an integer code for one of a set of graphics symbols. See <code><a href="graphics.html#topic+points">points</a></code>. Defaults to 15.
</p>
</td></tr>
<tr><td><code id="legend.grid_+3A_pt.cex">pt.cex</code></td>
<td>

<p>character expansion of the symbols. Defaults to 2.5
</p>
</td></tr>
<tr><td><code id="legend.grid_+3A_bg">bg</code></td>
<td>

<p>background colour for the legend box
</p>
</td></tr>
<tr><td><code id="legend.grid_+3A_...">...</code></td>
<td>

<p>other arguments to be passed to <code><a href="graphics.html#topic+legend">legend</a></code>.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Hans Gerritsen
</p>


<h3>See Also</h3>

<p><code><a href="#topic+draw.grid">draw.grid</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(coast)
data(landings)
byx = 1
byy = 0.5
xlim &lt;- c(-15.5,0)
ylim &lt;- c(50.25,56)
grd &lt;- make.grid(landings$Lon,landings$Lat,landings$LiveWeight, byx, byy, xlim, ylim)
breaks &lt;- breaks.grid(grd,zero=FALSE)
basemap(xlim, ylim, main = "Gadoid landings")
draw.grid(grd,breaks)
draw.shape(coast, col="darkgreen")
legend.grid("topright", breaks=breaks/1000, type=2, inset=0.02, title="tonnes")
</code></pre>

<hr>
<h2 id='legend.pie'>
Legend for pie plots
</h2><span id='topic+legend.pie'></span>

<h3>Description</h3>

<p>Draw a legend for a <code><a href="#topic+draw.pie">draw.pie</a></code> plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>legend.pie(x, y = NULL, z, labels, radius = 1, bty = "o", mab = 1.2, bg = NULL, 
	inset = 0, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="legend.pie_+3A_x">x</code>, <code id="legend.pie_+3A_y">y</code></td>
<td>

<p>the x and y co-ordinates to be used to position the legend. <code>x</code> can be a keyword (e.g. <code>"topleft"</code>. See <code><a href="graphics.html#topic+legend">legend</a></code>.
</p>
</td></tr>
<tr><td><code id="legend.pie_+3A_z">z</code></td>
<td>

<p>optional vector of non-negative numerical quantities. The values in <code>z</code> are displayed as the areas of pie slices in the legend.
</p>
</td></tr>
<tr><td><code id="legend.pie_+3A_labels">labels</code></td>
<td>

<p>character vector (same length as <code>z</code>) with labels for the pies.
</p>
</td></tr>
<tr><td><code id="legend.pie_+3A_radius">radius</code></td>
<td>

<p>the radius of the pie to be displayed.
</p>
</td></tr>
<tr><td><code id="legend.pie_+3A_bty">bty</code></td>
<td>

<p>single character indicating the type of box to be drawn around the legend. The allowed values are &quot;o&quot; (the default) and &quot;n&quot; (no box).
</p>
</td></tr>
<tr><td><code id="legend.pie_+3A_mab">mab</code></td>
<td>

<p>the margin around the pie. i.e. how much space should there be between the pie and the legend box. relative to the size of the pie.
</p>
</td></tr>
<tr><td><code id="legend.pie_+3A_bg">bg</code></td>
<td>

<p>background colour of the legend box.
</p>
</td></tr>
<tr><td><code id="legend.pie_+3A_inset">inset</code></td>
<td>

<p>inset distance(s) from the margins as a fraction of the plot region when legend is placed by keyword.
</p>
</td></tr>
<tr><td><code id="legend.pie_+3A_...">...</code></td>
<td>

<p>any other arguments to be passed on to <code><a href="#topic+add.pie">add.pie</a></code>.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Hans Gerritsen
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(landings)
data(coast)
xlim &lt;- c(-12,-5)
ylim &lt;- c(50,56)
xyz &lt;- make.xyz(landings$Lon,landings$Lat,landings$LiveWeight,landings$Species)
col &lt;- rainbow(5)
basemap(xlim, ylim, main = "Species composition of gadoid landings")
draw.shape(coast, col="cornsilk")
draw.pie(xyz$x, xyz$y, xyz$z, radius = 0.3, col=col)
legend.pie(-13.25,54.8,labels=c("cod","had","hke","pok","whg"), radius=0.3, bty="n", col=col,
 cex=0.8, label.dist=1.3)
legend.z &lt;- round(max(rowSums(xyz$z,na.rm=TRUE))/10^6,0)
legend.bubble(-13.25,55.5,z=legend.z,round=1,maxradius=0.3,bty="n",txt.cex=0.6)
text(-13.25,56,"landings (kt)",cex=0.8)
</code></pre>

<hr>
<h2 id='make.grid'>
Create grd object
</h2><span id='topic+make.grid'></span>

<h3>Description</h3>

<p>Create a grd object from <code>x</code>, <code>y</code> and <code>z</code> data.
For use with <code><a href="#topic+draw.grid">draw.grid</a></code> and <code><a href="#topic+write.grid">write.grid</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make.grid(x, y, z, byx , byy , xlim, ylim, fun = function(x) sum(x, na.rm = T))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="make.grid_+3A_x">x</code></td>
<td>

<p>a vector of x-coordinates (longitude)
</p>
</td></tr>
<tr><td><code id="make.grid_+3A_y">y</code></td>
<td>

<p>a vector of y-coordinates (latitude; same length as <code>x</code>)
</p>
</td></tr>
<tr><td><code id="make.grid_+3A_z">z</code></td>
<td>

<p>a vector of values; same length as <code>x</code>
</p>
</td></tr>
<tr><td><code id="make.grid_+3A_byx">byx</code>, <code id="make.grid_+3A_byy">byy</code></td>
<td>

<p>the size of the grid cells on the x and y scale
</p>
</td></tr>
<tr><td><code id="make.grid_+3A_xlim">xlim</code>, <code id="make.grid_+3A_ylim">ylim</code></td>
<td>

<p>the x and y limits of the grid. Note that the origin of the grid depends on <code>xlim[1]</code> and <code>ylim[1]</code>, these values will be taken as the mid-point of the bottom-left grid-cell. See example below how to use this to create a grid that matches that of the ICES rectangles.
</p>
</td></tr>
<tr><td><code id="make.grid_+3A_fun">fun</code></td>
<td>

<p>a function to be applied to <code>z</code>. Defaults to <code>sum</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Due to the way fractions are stored in binary format, rounding errors can occur, e.g.:
</p>
<p><code>as.character(seq(-5,0,by=0.8))</code> 
</p>
<p>results in:
</p>
<p><code>"-5"	"-4.2"	"-3.4"	"-2.6"	"-1.8"	"-1"	"-0.199999999999999"</code>
</p>
<p>this can affect the <code>make.grid</code> function although this is generally not a problem.
</p>


<h3>Value</h3>

<p>a grd object, which is simply a 2-dimensional array with row and column names that correspond to the x and y positions of the grid.
</p>


<h3>Author(s)</h3>

<p>Hans Gerritsen
</p>


<h3>See Also</h3>

<p><code><a href="#topic+draw.grid">draw.grid</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(coast)
data(landings)
byx = 1
byy = 0.5
xlim &lt;- c(-15.5,0)
ylim &lt;- c(50.25,56)
grd &lt;- make.grid(landings$Lon,landings$Lat,landings$LiveWeight, byx, byy, xlim, ylim)
breaks &lt;- breaks.grid(grd,zero=FALSE)
basemap(xlim, ylim, main = "Gadoid landings")
draw.grid(grd,breaks)
draw.shape(coast, col="darkgreen")
legend.grid("topright", breaks=breaks/1000, type=2, inset=0.02, title="tonnes")
</code></pre>

<hr>
<h2 id='make.multigrid'>
Create a grd object
</h2><span id='topic+make.multigrid'></span>

<h3>Description</h3>

<p>Create list of grd objects from <code>x</code>, <code>y</code>, <code>z</code> and <code>group</code> data, where each level of <code>group</code> provides a separate grd object. For use with <code><a href="#topic+draw.grid">draw.grid</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make.multigrid(x, y, z, group, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="make.multigrid_+3A_x">x</code></td>
<td>

<p>a vector of x-coordinates (longitude)
</p>
</td></tr>
<tr><td><code id="make.multigrid_+3A_y">y</code></td>
<td>

<p>a vector of y-coordinates (latitude; same length as <code>x</code>)
</p>
</td></tr>
<tr><td><code id="make.multigrid_+3A_z">z</code></td>
<td>

<p>a vector of values; same length as <code>x</code>
</p>
</td></tr>
<tr><td><code id="make.multigrid_+3A_group">group</code></td>
<td>

<p>a factor; same length as <code>x</code>. E.g. species, season etc.
</p>
</td></tr>
<tr><td><code id="make.multigrid_+3A_...">...</code></td>
<td>

<p>other arguments to be passed to <code><a href="#topic+make.grid">make.grid</a></code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of grd objects, see  <code><a href="#topic+make.grid">make.grid</a></code>.
</p>


<h3>Author(s)</h3>

<p>Hans Gerritsen
</p>


<h3>See Also</h3>

<p><code><a href="#topic+make.grid">make.grid</a></code>, <code><a href="#topic+draw.grid">draw.grid</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(coast)
data(landings)
byx = 1
byy = 0.5
xlim &lt;- c(-12.5,-5)
ylim &lt;- c(50.25,56)
grd &lt;- make.multigrid(landings$Lon,landings$Lat,landings$LiveWeight, landings$Species,
 byx, byy, xlim, ylim)
breaks &lt;- breaks.grid(grd,zero=FALSE)
par(mfrow=c(2,3),mar=c(1,1,2,1) )
for(s in names(grd) ) {
  basemap(xlim, ylim, main = s, axes=FALSE)
  draw.grid(grd[[s]],breaks)
  draw.shape(coast, col="darkgreen")
}
plot.new()
legend.grid("center",breaks=breaks/1000,type=2)
</code></pre>

<hr>
<h2 id='make.xyz'>
Create xyz object
</h2><span id='topic+make.xyz'></span>

<h3>Description</h3>

<p>Creata an xyz object for use with the functions <code><a href="#topic+draw.barplot2D">draw.barplot2D</a></code> and <code><a href="#topic+draw.pie">draw.pie</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make.xyz(x, y, z, group, FUN = sum, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="make.xyz_+3A_x">x</code>, <code id="make.xyz_+3A_y">y</code></td>
<td>

<p>vector with x and y-locations of the 2D barplots or pies to be plotted.
</p>
</td></tr>
<tr><td><code id="make.xyz_+3A_z">z</code></td>
<td>

<p>vector (same length as <code>x</code>) with the values to be displayed as the areas of the pie slices or 2D barplot.
</p>
</td></tr>
<tr><td><code id="make.xyz_+3A_group">group</code></td>
<td>

<p>factor (same length as <code>x</code>) with groupings for the <code>x</code>, <code>y</code>, <code>z</code> data, e.g. year, species etc.
</p>
</td></tr>
<tr><td><code id="make.xyz_+3A_fun">FUN</code></td>
<td>

<p>function to apply to the <code>z</code>(in case there are duplicate combinations of <code>x</code>, <code>y</code> and <code>group</code>).
</p>
</td></tr>
<tr><td><code id="make.xyz_+3A_...">...</code></td>
<td>

<p>optional arguments to <code>FUN</code>.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Hans Gerritsen
</p>


<h3>See Also</h3>

<p><code><a href="#topic+draw.barplot2D">draw.barplot2D</a></code> and <code><a href="#topic+draw.pie">draw.pie</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(landings)
data(coast)
xlim &lt;- c(-12,-5)
ylim &lt;- c(50,56)
xyz &lt;- make.xyz(landings$Lon,landings$Lat,landings$LiveWeight,landings$Species)
col &lt;- rainbow(5)
basemap(xlim, ylim, main = "Species composition of gadoid landings")
draw.shape(coast, col="cornsilk")
draw.pie(xyz$x, xyz$y, xyz$z, radius = 0.3, col=col)
legend.pie(-13.25,54.8,labels=c("cod","had","hke","pok","whg"), radius=0.3, bty="n",
 col=col, cex=0.8, label.dist=1.3)
legend.z &lt;- round(max(rowSums(xyz$z,na.rm=TRUE))/10^6,0)
legend.bubble(-13.25,55.5,z=legend.z,round=1,maxradius=0.3,bty="n",txt.cex=0.6)
text(-13.25,56,"landings (kt)",cex=0.8) 
</code></pre>

<hr>
<h2 id='progressMsg'>
Progress message
</h2><span id='topic+progressMsg'></span><span id='topic+setProgressMsg'></span>

<h3>Description</h3>

<p>progress message in the R console.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setProgressMsg(min = 0, max = 1)
progressMsg(pm, value, round = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="progressMsg_+3A_min">min</code>, <code id="progressMsg_+3A_max">max</code></td>
<td>

<p>(finite) numeric values for the extremes of the progress message. Must have <code>min &lt; max</code>
</p>
</td></tr>
<tr><td><code id="progressMsg_+3A_pm">pm</code></td>
<td>

<p>list created by setProgressMsg
</p>
</td></tr>
<tr><td><code id="progressMsg_+3A_value">value</code></td>
<td>

<p>value for the progress message.
</p>
</td></tr>
<tr><td><code id="progressMsg_+3A_round">round</code></td>
<td>

<p>integer indicating the number of decimal places for the percentage completed. Defaults to 0.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>setProgressMsg</code> sets up a list with variables used and updated by <code>progressMsg</code>
</p>


<h3>Value</h3>

<p>a list
</p>


<h3>Author(s)</h3>

<p>Hans Gerritsen
</p>


<h3>See Also</h3>

<p>See also <code><a href="utils.html#topic+txtProgressBar">txtProgressBar</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  pm &lt;- setProgressMsg(0,500)
  for(i in 1:500) {
    pm&lt;- progressMsg(pm,i)
    Sys.sleep(0.01)
  
  }
  rm(pm)
  
## End(Not run)
</code></pre>

<hr>
<h2 id='write.grid'>
Export a grd object as csv or shapefile
</h2><span id='topic+write.grid'></span>

<h3>Description</h3>

<p>Export a grd object (created by <code><a href="#topic+make.grid">make.grid</a></code>) as csv or shapefile.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write.grid(grd, file, type="csv")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="write.grid_+3A_grd">grd</code></td>
<td>

<p>a grid object created by the function <code><a href="#topic+make.grid">make.grid</a></code>.
</p>
</td></tr>
<tr><td><code id="write.grid_+3A_file">file</code></td>
<td>

<p>character string naming the output filename. For csv files do include the extension (e.g. &quot;my_file.csv&quot;); for shapefiles omit the extension (e.g. &quot;my_file&quot;).
</p>
</td></tr>
<tr><td><code id="write.grid_+3A_type">type</code></td>
<td>

<p>character string specifying the output file type. Must be one of &quot;csv&quot; (default) or &quot;shape&quot;
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A csv file with three columns corresponing to <code>x</code>, <code>y</code> and <code>z</code> (lon, lat, value), or a shapefile with a polygon for each cell in the grd object. The assumed projection is EPSG:4326
</p>


<h3>Author(s)</h3>

<p>Hans Gerritsen
</p>


<h3>See Also</h3>

<p><code><a href="#topic+make.grid">make.grid</a></code>, <code><a href="shapefiles.html#topic+write.shapefile">write.shapefile</a></code> .
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(shapefiles)
data(landings)
data(coast)
byx = 1
byy = 0.5
xlim &lt;- c(-15.5,0)
ylim &lt;- c(50.25,56)
grd &lt;- make.grid(landings$Lon, landings$Lat, landings$LiveWeight, byx, byy, xlim, ylim)
breaks &lt;- breaks.grid(grd,zero=FALSE)
basemap(xlim, ylim, main = "Gadoid landings")
draw.grid(grd,breaks)
draw.shape(coast, col="darkgreen")
legend.grid("topright", breaks=breaks/1000, type=2)
## Not run: 
write.grid(grd,"c:/test1.csv")
write.grid(grd,"c:/test1","shape")

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
