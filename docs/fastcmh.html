<!DOCTYPE html><html lang="en"><head><title>Help for package fastcmh</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {fastcmh}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#demofastcmh'><p>Demo of fastcmh</p></a></li>
<li><a href='#makefastcmhdata'><p>Create sample data for fastcmh</p></a></li>
<li><a href='#runfastcmh'><p>Run the fastcmh algorithm</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Significant Interval Discovery with Categorical Covariates</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.7</td>
</tr>
<tr>
<td>Author:</td>
<td>Felipe Llinares Lopez, Dean Bodenham</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Dean Bodenham &lt;deanbodenhambsse@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>A method which uses the Cochran-Mantel-Haenszel test with significant pattern mining to detect intervals in binary genotype data which are significantly associated with a particular phenotype, while accounting for categorical covariates.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.3.0), bindata</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>5.0.1</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>C++11</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2016-09-13 16:11:45 UTC; dean</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2016-09-13 21:19:17</td>
</tr>
</table>
<hr>
<h2 id='demofastcmh'>Demo of fastcmh</h2><span id='topic+demofastcmh'></span>

<h3>Description</h3>

<p>This function runs a demo for fastcmh, by first creating a sample data set
and then running fastcmh on this data set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>demofastcmh(saveToFolder = FALSE, folder = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="demofastcmh_+3A_savetofolder">saveToFolder</code></td>
<td>
<p>A flag indicating whether or not the data files created
for the demo should be saved to file. The default is <code>FALSE</code>, i.e. no
files are saved to the folder. The only reason to save demo data to a
folder is for the user to be able to have a look at the files after the
demo.</p>
</td></tr>
<tr><td><code id="demofastcmh_+3A_folder">folder</code></td>
<td>
<p>The folder in which the data for the demo will be saved.
Default is the current directory, <code>"./"</code>. The demo data will created
in <code>folder/data</code> and the results will be saved in
<code>folder/results</code> as an RData file.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function will first create a sample data set in <code>folder/data</code>,
and will then run <code>runfastcmh</code> on this data set, before saving the
each step showing the R code that can be used to do the step, then running
that R code, and then waiting for the user to press enter before moving
onto the next step. If <code>saveToFolder=FALSE</code>, (default) then no files
are saved and all the results are kept in memory.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+runfastcmh">runfastcmh</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>demofastcmh()
</code></pre>

<hr>
<h2 id='makefastcmhdata'>Create sample data for fastcmh</h2><span id='topic+makefastcmhdata'></span>

<h3>Description</h3>

<p>This function creates sample data for use with the <code>runfastcmh</code> method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>makefastcmhdata(folder = "./", xfilename = "data.txt",
  yfilename = "label.txt", covfilename = "cov.txt", K = 2, L = 1000,
  n = 200, noiseP = 0.3, corruptP = 0.05, rho = 0.8, tau1 = 100,
  taulength1 = 4, tau2 = 200, taulength2 = 4, seednum = 2,
  truetaufilename = "truetau.txt", showOutput = FALSE, saveToList = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="makefastcmhdata_+3A_folder">folder</code></td>
<td>
<p>The folder in which the data will be saved. Default is
current directory <code>"./"</code>.</p>
</td></tr>
<tr><td><code id="makefastcmhdata_+3A_xfilename">xfilename</code></td>
<td>
<p>The name of the data file. Default is <code>"data.txt"</code></p>
</td></tr>
<tr><td><code id="makefastcmhdata_+3A_yfilename">yfilename</code></td>
<td>
<p>The name of the label file. Default is <code>"label.txt"</code></p>
</td></tr>
<tr><td><code id="makefastcmhdata_+3A_covfilename">covfilename</code></td>
<td>
<p>The name of the file containing the covariate categories
. This file actually just contains <code>K</code> numbers, where <code>K</code> is the
number of covariates. Default is <code>"cov.txt"</code></p>
</td></tr>
<tr><td><code id="makefastcmhdata_+3A_k">K</code></td>
<td>
<p>The number of covariates (a positive integer). Default is
<code>K=2</code>.</p>
</td></tr>
<tr><td><code id="makefastcmhdata_+3A_l">L</code></td>
<td>
<p>The number of features (length of each sequence). Default is
<code>L=1000</code>.</p>
</td></tr>
<tr><td><code id="makefastcmhdata_+3A_n">n</code></td>
<td>
<p>The number of samples (cases and controls combined). Default is
<code>n=200</code>, i.e. 100 cases and 100 controls.</p>
</td></tr>
<tr><td><code id="makefastcmhdata_+3A_noisep">noiseP</code></td>
<td>
<p>The background noise in the data (as a probability of 0/1
being flipped). Default is <code>noiseP=0.3</code></p>
</td></tr>
<tr><td><code id="makefastcmhdata_+3A_corruptp">corruptP</code></td>
<td>
<p>The probability of data corruption: each bit has
probability <code>corruptP</code> of being flipped. Default is
<code>corruptP=0.05</code>.</p>
</td></tr>
<tr><td><code id="makefastcmhdata_+3A_rho">rho</code></td>
<td>
<p>The strength of the confounding in the confounded interval (as
a probability). Default is <code>rho=0.8</code> (i.e. a very strong signal).</p>
</td></tr>
<tr><td><code id="makefastcmhdata_+3A_tau1">tau1</code></td>
<td>
<p>The location of the significant interval (starting point).
Default value is <code>tau1=100</code>.</p>
</td></tr>
<tr><td><code id="makefastcmhdata_+3A_taulength1">taulength1</code></td>
<td>
<p>The length of the significant interval. Default value is
<code>taulength1=4</code>, so default significant interval is <code>[100, 103]</code>.</p>
</td></tr>
<tr><td><code id="makefastcmhdata_+3A_tau2">tau2</code></td>
<td>
<p>The location of the confounded significant interval (starting
point). Default value is <code>tau2=200</code>.</p>
</td></tr>
<tr><td><code id="makefastcmhdata_+3A_taulength2">taulength2</code></td>
<td>
<p>The length of the confounded significant interval.
Default value is <code>taulength2=4</code>, so default significant interval is
<code>[200, 203]</code>.</p>
</td></tr>
<tr><td><code id="makefastcmhdata_+3A_seednum">seednum</code></td>
<td>
<p>The seed used for generating the data. Default value is
<code>seednum=2</code>.</p>
</td></tr>
<tr><td><code id="makefastcmhdata_+3A_truetaufilename">truetaufilename</code></td>
<td>
<p>The file where the location of the true significant
intervals are saved (as opposed to the detected significant intervals).
Default is <code>"truetau.txt"</code>.</p>
</td></tr>
<tr><td><code id="makefastcmhdata_+3A_showoutput">showOutput</code></td>
<td>
<p>Flag to decide whether or not to show output, where files
are created, their names, etc. Default is <code>FALSE</code>, so will save to
<code>folder</code> by default. However, all of the examples use
<code>saveToList=TRUE</code> in order to avoid writing to file. The list will
consist of <code>data</code>, <code>label</code> and <code>cov</code> data frames, when
<code>saveToList=TRUE</code>.</p>
</td></tr>
<tr><td><code id="makefastcmhdata_+3A_savetolist">saveToList</code></td>
<td>
<p>Flag to decide whether or not to save data to the folder,
or to return (output) the data as a list. By default,
<code>saveToList=FALSE</code>.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+runfastcmh">runfastcmh</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#make a small sample data set, using the default parameters
mylist &lt;- makefastcmhdata(showOutput=TRUE, saveToList=TRUE)

#make a very small sample data set
mylist &lt;- makefastcmhdata(n=20, L=10, tau1=2, taulength1=2,
       tau2=6, taulength2=2, saveToList=TRUE)
</code></pre>

<hr>
<h2 id='runfastcmh'>Run the fastcmh algorithm</h2><span id='topic+runfastcmh'></span>

<h3>Description</h3>

<p>This function runs the FastCMH algorithm on a particular data set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>runfastcmh(folder = NULL, data = NULL, label = NULL, cov = NULL,
  alpha = 0.05, Lmax = 0, showProcessing = FALSE, saveAllPvals = FALSE,
  doFDR = FALSE, useDependenceFDR = FALSE, saveToFile = FALSE,
  saveFilename = "fastcmhresults.RData", saveFolder = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="runfastcmh_+3A_folder">folder</code></td>
<td>
<p>The folder in which the data is saved. If the any of
<code>data</code>, <code>label</code> and <code>pvalue</code> arguments are not specified,
then filenames must have following a naming convention inside the folder:
the data file is <code>"data.txt"</code>
(i.e. the full path is <code>"folder/data.txt"</code>), the phenotype label file
is <code>label.txt</code>, and covariate label file is
<code>cov.txt</code>. More details on the structure of these files is given
below, or the user can use the <code><a href="#topic+makefastcmhdata">makefastcmhdata</a></code> function to
see an example of the correct data formats. If <code>folder="/data/"</code>, the
data in <code>fastcmh/inst/extdata</code> is used.</p>
</td></tr>
<tr><td><code id="runfastcmh_+3A_data">data</code></td>
<td>
<p>The filename for the data file. Default is <code>NULL</code>. The
data file must be an <code>L x n</code> txt file containing only <code>0</code>s and
<code>1</code>s, which are space-separated in each row, while each row is on a
separate newline.</p>
</td></tr>
<tr><td><code id="runfastcmh_+3A_label">label</code></td>
<td>
<p>The filename for the phenotype label file. Default is
<code>NULL</code>. The label file should consist of a single column (i.e. each
row is on a separate line) of <code>0</code>s and <code>1</code>s.</p>
</td></tr>
<tr><td><code id="runfastcmh_+3A_cov">cov</code></td>
<td>
<p>The filename for the covariate label file. Default is
<code>NULL</code>. The <code>cov</code> file contains a single column of positive
integers. The first row, containing value <code class="reqn">n_1</code>, specifies that the
first <code class="reqn">n_1</code> columns have covariate value <code>1</code>; the second row,
containing <code class="reqn">n_2</code>, specifies that the next <code class="reqn">n_2</code> rows have
covariate value <code>2</code>, etc.</p>
</td></tr>
<tr><td><code id="runfastcmh_+3A_alpha">alpha</code></td>
<td>
<p>The value of the FWER; must be a number between 0 and 1.
Default is <code>alpha=0.05</code>.</p>
</td></tr>
<tr><td><code id="runfastcmh_+3A_lmax">Lmax</code></td>
<td>
<p>The maximum length of significant intervals which is
considered. Must be a non-negative integer. For example, <code>Lmax=10</code>
searches for significant intervals up to length 10. Setting <code>Lmax=0</code>
will search for significant intervals up to any length (with algorithm
pruning appropriately). Default is <code>Lmax=0</code>.</p>
</td></tr>
<tr><td><code id="runfastcmh_+3A_showprocessing">showProcessing</code></td>
<td>
<p>A flag which will turn printing to screen on/off.
Default is <code>FALSE</code> (which is &ldquo;off&rdquo;).</p>
</td></tr>
<tr><td><code id="runfastcmh_+3A_saveallpvals">saveAllPvals</code></td>
<td>
<p>A flag which controls whether or not all the intervals
(less than minimum attainable pvalue) will be returned. Default is
<code>FALSE</code> (which is &ldquo;no, do notreturn all intervals&rdquo;).</p>
</td></tr>
<tr><td><code id="runfastcmh_+3A_dofdr">doFDR</code></td>
<td>
<p>A flag which controls whether or not Gilbert's Tarone FDR
procedure (while accounting for positive regression dependence) is
performed. Default is <code>FALSE</code> (which is &ldquo;no, do not do FDR&rdquo;).</p>
</td></tr>
<tr><td><code id="runfastcmh_+3A_usedependencefdr">useDependenceFDR</code></td>
<td>
<p>A flag which controls whether or not Gilbert's
Tarone FDR procedure uses the dependent formulation by Benjamini and
Yekutieli (2001), which further adjusts alpha by dividing by the harmonic
mean. This flag is only used if <code>doFDR==TRUE</code>. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="runfastcmh_+3A_savetofile">saveToFile</code></td>
<td>
<p>A flag which controls whether or not the results are
saved to file. By default, <code>saveToFile=FALSE</code>, and the data frame is
returned in R. See the examples below.</p>
</td></tr>
<tr><td><code id="runfastcmh_+3A_savefilename">saveFilename</code></td>
<td>
<p>A string which gives the filename to which the output
is saved (needs to have <code>saveToFile=TRUE</code>) as an RData file. Default
is <code>"fastcmhresults.RData"</code>.</p>
</td></tr>
<tr><td><code id="runfastcmh_+3A_savefolder">saveFolder</code></td>
<td>
<p>A string which gives the path to which the output will
be saved (needs to have <code>saveToFile=TRUE</code>). Default is <code>"./"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function runs the FastCMH algorithm on a particular data set in
order to discover intervals that are statistically significantly
associated with a particular label, while accounting for categorical
covariates.
</p>
<p>The user must either supply the folder, which contains files named
<code>"data.txt"</code>, <code>"label.txt"</code> and <code>"cov.txt"</code>, or the
non-default filenames must be specified individually. See the descriptions of arguments <code>data</code>, <code>label</code> and <code>cov</code> to see the format of
the input files, or make a small sample data file using the
<code><a href="#topic+makefastcmhdata">makefastcmhdata</a></code> function.
By default, filtered results are provided. The user also has the option
of using an FDR procedure rather than the standard FWER-preserving
procedure.
</p>


<h3>Value</h3>

<p><code>runfastcmh</code> will return a list if <code>saveToFile=FALSE</code> (default
setting), otherwise it will save the list in an .RData file. The fields
of the list are:
</p>

<dl>
<dt><code>sig</code></dt><dd><p>a dataframe listing the significant intervals, after
filterting. Columns <code>start</code>, <code>end</code> and <code>pvalue</code> indicate
the start and end points of the interval (inclusive), and the
<em>p</em>-value for that interval.</p>
</dd>
<dt><code>unfiltered</code></dt><dd><p>a dataframe listing all the significant intervals
before filtering. The filtering compares the overlapping intervals and
returns the interval with the smallest p-value in each cluster of
overlapping intervals. Dataframe has has structure as <code>sig</code>.</p>
</dd>
<dt><code>fdr</code></dt><dd><p>(if doFDR==TRUE) significant intervals using Gilbert's
FDR-Tarone procedure, after filtering. Dataframe has same structure as
<code>sig</code>.</p>
</dd>
<dt><code>unfilteredFdr</code></dt><dd><p>(if doFDR==TRUE) a dataframe listing all the significant intervals before filtering. See description of <code>unfiltered</code>.</p>
</dd>
<dt><code>allTestablle</code></dt><dd><p>(if saveAllPvals==TRUE) a dataframe listing all
the testable intervals, many of which will not be significant. Dataframe
has same structure as <code>sig</code>.</p>
</dd>
<dt><code>histObs</code></dt><dd><p>Together with histFreq gives a histogram of maximum
attainable CMH statistics.</p>
</dd>
<dt><code>histFreq</code></dt><dd><p>Histogram of maximum attainable CMH statistics (only
reliable in the testable range).</p>
</dd>
<dt><code>summary</code></dt><dd><p>a character string summarising the results. Use
<code>cat(...$summary)</code> to print the results with the correct
indentation/new lines.</p>
</dd>
<dt><code>timing</code></dt><dd><p>a list containing (i) <code>details</code>, a character
string summarising the runtime values for the experiment - use
<code>cat(...$timing$details)</code> for correct indentation, etc.
(ii) <code>exec</code>, the total execution time. (iii) <code>init</code>, the time
to initialise the objects. (iv) <code>fileIO</code>, the time to read the input
files. (v) <code>compSigThresh</code>, the time to compute the significance
threshold. (vi) <code>compSigInt</code>, the time to compute the significant
intervals.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Felipe Llinares Lopez, Dean Bodenham
</p>


<h3>See Also</h3>

<p><code><a href="#topic+makefastcmhdata">makefastcmhdata</a></code>
</p>


<h3>References</h3>

<p>Gilbert, P. B. (2005) <em>A modified false discovery rate
multipl-comparisons procedure for discrete data, applied to human
immunodeficiency virus genetics</em>. Journal of the Royal Statistical
Society: Series C (Applied Statistics), 54(1), 143-158.
</p>
<p>Benjamini, Y., Yekutieli, D. (2001). <em>The control of the false
discovery rate in multiple testing under dependency</em>.
Annals of Statistics, 29(4), 1165-1188.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Example with default naming convention used for data, label and cov files
# Note: using "/data/" as the argument for folder
#       accesses the data/ directory in the fastcmh package folder
mylist &lt;- runfastcmh("/data/")

#Example where the progress will be shown
mylist &lt;- runfastcmh(folder="/data/", showProcessing=TRUE)

#Example where many parameters are specified
mylist &lt;- runfastcmh(folder="/data/", data="data2.txt", alpha=0.01, Lmax=7)

#Example where Gilbert's Tarone-FDR procedure is used
mylist &lt;- runfastcmh("/data/", doFDR=TRUE)

#Example where FDR procedure takes some dependence structures into account
mylist &lt;- runfastcmh("/data/", doFDR=TRUE, useDependenceFDR=TRUE)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
