<!DOCTYPE html><html lang="en-GB"><head><title>Help for package AccelStab</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {AccelStab}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#antigenicity'><p>Antigenicity Accelerated Stability Data</p></a></li>
<li><a href='#excursion'><p>Temperature Excursion</p></a></li>
<li><a href='#potency'><p>Potency Accelerated Stability Data</p></a></li>
<li><a href='#step1_down'><p>Step1 Down Model</p></a></li>
<li><a href='#step1_down_basic'><p>Basic version Step1 Down Model</p></a></li>
<li><a href='#step1_down_rmse'><p>Step1 Down Model Root Mean Square Error Calculation</p></a></li>
<li><a href='#step1_plot_CI'><p>Plot Confidence Intervals</p></a></li>
<li><a href='#step1_plot_desc'><p>Plot Stability Data</p></a></li>
<li><a href='#step1_plot_diagnostic'><p>Create Diagnostic Plots</p></a></li>
<li><a href='#step1_plot_PI'><p>Plot Prediction Intervals</p></a></li>
<li><a href='#step1_plot_pred'><p>Plot Model Predictions</p></a></li>
<li><a href='#step1_plot_T'><p>Focus on Temperature</p></a></li>
<li><a href='#step1_sample_mvt'><p>Sample the Multivariate t Distribution</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Accelerated Stability Kinetic Modelling</td>
</tr>
<tr>
<td>Version:</td>
<td>2.1.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimate the Šesták–Berggren kinetic model (degradation model) from experimental data. A
  A closed-form (analytic) solution to the degradation model is implemented as a non-linear fit,
  allowing for the extrapolation of the degradation of a drug product - both in time and 
  temperature. Parametric bootstrap, with kinetic parameters drawn from the multivariate
  t-distribution, and analytical formulae (the delta method) are available options to calculate
  the confidence and prediction intervals.
  The results (modelling, extrapolations and statistical intervals) can be visualised
  with multiple plots. The examples illustrate the accelerated stability modelling in drugs and
  vaccines development.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/AGPL-3">AGPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, ggplot2, minpack.lm, mvtnorm, stats, scales</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0), knitr, rmarkdown, lifecycle</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Language:</td>
<td>en-GB</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/AccelStab/AccelStab">https://github.com/AccelStab/AccelStab</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/AccelStab/AccelStab/issues">https://github.com/AccelStab/AccelStab/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-01-20 13:15:38 UTC; benwe</td>
</tr>
<tr>
<td>Author:</td>
<td>Bernard G Franq [aut, cph],
  Ben Wells [cre],
  Alex Ball [ctb],
  Daniel Williams [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ben Wells &lt;wellsbenjy@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-01-20 15:20:01 UTC</td>
</tr>
</table>
<hr>
<h2 id='antigenicity'>Antigenicity Accelerated Stability Data</h2><span id='topic+antigenicity'></span>

<h3>Description</h3>

<p>An example dataset containing antigenicity concentration data at different
temperatures over a period of up to 407 days. Two points over 180 days are
to be used for validation instead of fitting.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(antigenicity)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>"data.frame"</code> with 56 rows and 6 variables
</p>

<dl>
<dt>time</dt><dd><p>Number of days in years for which the datapoints are gathered.</p>
</dd>
<dt>Celsius</dt><dd><p>The temperature in celsius.</p>
</dd>
<dt>K</dt><dd><p>The temperature in Kelvin.</p>
</dd>
<dt>conc</dt><dd><p>The concentration at a time.</p>
</dd>
<dt>N.days</dt><dd><p>Number of days for which the datapoints are gathered.</p>
</dd>
<dt>validA</dt><dd><p>Whether the data point is to be used for validation or fitting.</p>
</dd>
</dl>


<hr>
<h2 id='excursion'>Temperature Excursion</h2><span id='topic+excursion'></span>

<h3>Description</h3>

<p>Predict a temperature excursion for a product.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>excursion(
  step1_down_object,
  temp_changes,
  time_changes,
  CI = TRUE,
  PI = TRUE,
  draw = 10000,
  confidence_interval = 0.95,
  intercept = NULL,
  ribbon = TRUE,
  xname = NULL,
  yname = NULL,
  plot_simulations = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="excursion_+3A_step1_down_object">step1_down_object</code></td>
<td>
<p>The fit object from the step1.down function (required).</p>
</td></tr>
<tr><td><code id="excursion_+3A_temp_changes">temp_changes</code></td>
<td>
<p>A list that represents the order of the temperatures that
the product is subjected to. Must be the same length as time_changes.</p>
</td></tr>
<tr><td><code id="excursion_+3A_time_changes">time_changes</code></td>
<td>
<p>List that represents the times at which the temperature changes,
Starts from time zero and must be the same length as temp_changes.</p>
</td></tr>
<tr><td><code id="excursion_+3A_ci">CI</code></td>
<td>
<p>Show confidence intervals.</p>
</td></tr>
<tr><td><code id="excursion_+3A_pi">PI</code></td>
<td>
<p>Show prediction intervals.</p>
</td></tr>
<tr><td><code id="excursion_+3A_draw">draw</code></td>
<td>
<p>Number of simulations used to estimate confidence intervals.</p>
</td></tr>
<tr><td><code id="excursion_+3A_confidence_interval">confidence_interval</code></td>
<td>
<p>Confidence level for the confidence and prediction intervals
around the predictions (default 0.95).</p>
</td></tr>
<tr><td><code id="excursion_+3A_intercept">intercept</code></td>
<td>
<p>Use a forced y-intercept. If null, the fitted value will be used.</p>
</td></tr>
<tr><td><code id="excursion_+3A_ribbon">ribbon</code></td>
<td>
<p>Add shade to confidence and prediction intervals (optional).</p>
</td></tr>
<tr><td><code id="excursion_+3A_xname">xname</code></td>
<td>
<p>Label for the x-axis (optional).</p>
</td></tr>
<tr><td><code id="excursion_+3A_yname">yname</code></td>
<td>
<p>Label for the y-axis (optional).</p>
</td></tr>
<tr><td><code id="excursion_+3A_plot_simulations">plot_simulations</code></td>
<td>
<p>If TRUE, randomly selects 100 of the simulations to
display on the plot.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Use the output from step1.down to run a temperature excursion prediction.
</p>


<h3>Value</h3>

<p>An SB class object, a list including the following elements:
</p>

<ul>
<li> <p><em>prediction</em> - A data frame containing the predictions with the confidence and prediction intervals.
</p>
</li>
<li> <p><em>simulations</em> - Matrix of the simulations.
</p>
</li>
<li> <p><em>excursion plot</em> - A plot with predictions and statistical intervals.
</p>
</li>
<li> <p><em>user_parameters</em> - List of users input parameters which is utilised by other
functions in the package.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>#load antigenicity
data(antigenicity)

#run step1.down fit
fit1 &lt;- step1_down(data = antigenicity, y = "conc", .time = "time",
 C = "Celsius", max_time_pred = 3)

#run excursion function with fixed intercept.
excursion &lt;- excursion(step1_down_object = fit1,
                       temp_changes = c(5,15,10),
                       time_changes = c(0.5,1.5,3),
                       CI = TRUE, PI = TRUE, draw = 4000,
                       confidence_interval = 0.95,
                       intercept = 80,
                       xname = "Time in years", yname = "Concentration",
                       ribbon = TRUE, plot_simulations = TRUE)

excursion$excursion_plot

</code></pre>

<hr>
<h2 id='potency'>Potency Accelerated Stability Data</h2><span id='topic+potency'></span>

<h3>Description</h3>

<p>An example dataset containing potency data at different
temperatures..
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(potency)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>"data.frame"</code> with 78 rows and 3 variables
</p>

<dl>
<dt>Time</dt><dd><p>Time for which the datapoints are gathered.</p>
</dd>
<dt>Potency</dt><dd><p>Measured potency at a time.</p>
</dd>
<dt>Celsius</dt><dd><p>The temperature in celsius.</p>
</dd>
</dl>


<hr>
<h2 id='step1_down'>Step1 Down Model</h2><span id='topic+step1_down'></span>

<h3>Description</h3>

<p>Fit the one-step Šesták–Berggren kinetic model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>step1_down(
  data,
  y,
  .time,
  K = NULL,
  C = NULL,
  validation = NULL,
  draw = 10000,
  parms = NULL,
  temp_pred_C = NULL,
  max_time_pred = NULL,
  confidence_interval = 0.95,
  by = 101,
  reparameterisation = FALSE,
  zero_order = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="step1_down_+3A_data">data</code></td>
<td>
<p>Dataframe containing accelerated stability data (required).</p>
</td></tr>
<tr><td><code id="step1_down_+3A_y">y</code></td>
<td>
<p>Name of decreasing variable (e.g. concentration) contained within data
(required).</p>
</td></tr>
<tr><td><code id="step1_down_+3A_.time">.time</code></td>
<td>
<p>Time variable contained within data (required).</p>
</td></tr>
<tr><td><code id="step1_down_+3A_k">K</code></td>
<td>
<p>Kelvin variable (numeric or column name) (optional).</p>
</td></tr>
<tr><td><code id="step1_down_+3A_c">C</code></td>
<td>
<p>Celsius variable (numeric or column name) (optional).</p>
</td></tr>
<tr><td><code id="step1_down_+3A_validation">validation</code></td>
<td>
<p>Validation dummy variable, the column must contain only 1s and 0s, 1 for validation data and 0 for fit data. (column name) (optional).</p>
</td></tr>
<tr><td><code id="step1_down_+3A_draw">draw</code></td>
<td>
<p>Number of simulations used to estimate confidence intervals. When set to NULL the calculus method is used, however this is not recommended.</p>
</td></tr>
<tr><td><code id="step1_down_+3A_parms">parms</code></td>
<td>
<p>Starting values for the parameters as a list - k1, k2, k3, and c0.</p>
</td></tr>
<tr><td><code id="step1_down_+3A_temp_pred_c">temp_pred_C</code></td>
<td>
<p>Integer or numeric value to predict the response for a
given temperature (in Celsius).</p>
</td></tr>
<tr><td><code id="step1_down_+3A_max_time_pred">max_time_pred</code></td>
<td>
<p>Maximum time to predict the response variable.</p>
</td></tr>
<tr><td><code id="step1_down_+3A_confidence_interval">confidence_interval</code></td>
<td>
<p>Confidence level for the confidence and prediction intervals
around the predictions (default 0.95).</p>
</td></tr>
<tr><td><code id="step1_down_+3A_by">by</code></td>
<td>
<p>Number of points (on the time scale) to smooth the statistical
intervals around the predictions.</p>
</td></tr>
<tr><td><code id="step1_down_+3A_reparameterisation">reparameterisation</code></td>
<td>
<p>Use alternative parameterisation of the one-step
model which aims to reduce correlation between k1 and k2.</p>
</td></tr>
<tr><td><code id="step1_down_+3A_zero_order">zero_order</code></td>
<td>
<p>Set kinetic order, k3, to zero (straight lines).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Fit the one-step Šesták–Berggren kinetic (non-linear) model using
accelerated stability data from an R dataframe format. Parameters are kept in even when not significant.
</p>


<h3>Value</h3>

<p>An SB class object, a list including the following elements:
</p>

<ul>
<li> <p><em>fit</em> - The non-linear fit.
</p>
</li>
<li> <p><em>data</em> - The data set.
</p>
</li>
<li> <p><em>prediction</em> - A data frame containing the predictions with the confidence and prediction intervals.
</p>
</li>
<li> <p><em>user_parameters</em> - List of users input parameters which is utilised by other
functions in the package.
</p>
</li>
<li> <p><em>sample_coefficients</em> - A matrix containing the coefficients sampled during bootstrapping.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>#load antigenicity and potency data.
data(antigenicity)
data(potency)

#Basic use of the step1_down function with C column defined.
fit1 &lt;- step1_down(data = antigenicity, y = "conc", .time = "time", C = "Celsius", draw = 5000)

#Basic use of the step1_down function with K column defined &amp; Validation data segmented out.
fit2 &lt;- step1_down(data = antigenicity, y = "conc", .time = "time", K = "K",
validation = "validA", draw = 5000)

#When zero_order = FALSE, the output suggests using zero_order = TRUE for Potency dataset.
fit3 &lt;- step1_down(data = potency, y = "Potency", .time = "Time",C = "Celsius",
  reparameterisation = FALSE, zero_order = TRUE, draw = 5000)

#reparameterisation is TRUE.
fit4 &lt;- step1_down(data = antigenicity, y = "conc", .time = "time",C = "Celsius",
  reparameterisation = TRUE, draw = 5000)

</code></pre>

<hr>
<h2 id='step1_down_basic'>Basic version Step1 Down Model</h2><span id='topic+step1_down_basic'></span>

<h3>Description</h3>

<p>Quickly fit the one-step Šesták–Berggren kinetic model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>step1_down_basic(
  data,
  y,
  .time,
  K = NULL,
  C = NULL,
  validation = NULL,
  parms = NULL,
  reparameterisation = FALSE,
  zero_order = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="step1_down_basic_+3A_data">data</code></td>
<td>
<p>Dataframe containing accelerated stability data (required).</p>
</td></tr>
<tr><td><code id="step1_down_basic_+3A_y">y</code></td>
<td>
<p>Name of decreasing variable (e.g. concentration) contained within data
(required).</p>
</td></tr>
<tr><td><code id="step1_down_basic_+3A_.time">.time</code></td>
<td>
<p>Time variable contained within data (required).</p>
</td></tr>
<tr><td><code id="step1_down_basic_+3A_k">K</code></td>
<td>
<p>Kelvin variable (numeric or column name) (optional).</p>
</td></tr>
<tr><td><code id="step1_down_basic_+3A_c">C</code></td>
<td>
<p>Celsius variable (numeric or column name) (optional).</p>
</td></tr>
<tr><td><code id="step1_down_basic_+3A_validation">validation</code></td>
<td>
<p>Validation dummy variable, the column must contain only 1s and 0s, 1 for validation data and 0 for fit data. (column name) (optional).</p>
</td></tr>
<tr><td><code id="step1_down_basic_+3A_parms">parms</code></td>
<td>
<p>Starting values for the parameters as a list - k1, k2, k3, and c0.</p>
</td></tr>
<tr><td><code id="step1_down_basic_+3A_reparameterisation">reparameterisation</code></td>
<td>
<p>Use alternative parameterisation of the one-step
model which aims to reduce correlation between k1 and k2.</p>
</td></tr>
<tr><td><code id="step1_down_basic_+3A_zero_order">zero_order</code></td>
<td>
<p>Set kinetic order, k3, to zero (straight lines).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Fit the one-step Šesták–Berggren kinetic (non-linear) model using
accelerated stability data from an R dataframe format. Fit summary is printed
to the console and the fit itself is returned. Fewer arguments and
outputs than the main function for rapid testing. Parameters are kept in
even when not significant.
</p>


<h3>Value</h3>

<p>The fit object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#load antigenicity and potency data.
data(antigenicity)
data(potency)

#Use of the step1_down_basic function with C column defined.
fit1 &lt;- step1_down_basic(data = antigenicity, y = "conc", .time = "time", C = "Celsius")

#Basic use of the step1_down_basic function with K column defined &amp; Validation data segmented out.
fit2 &lt;- step1_down_basic(data = antigenicity, y = "conc", .time = "time", K = "K",
validation = "validA")

#When zero_order = FALSE, the output suggests using zero_order = TRUE for Potency dataset.
fit3 &lt;- step1_down_basic(data = potency, y = "Potency", .time = "Time",C = "Celsius",
  reparameterisation = FALSE, zero_order = TRUE)

#reparameterisation is TRUE.
fit4 &lt;- step1_down_basic(data = antigenicity, y = "conc", .time = "time",C = "Celsius",
  reparameterisation = TRUE)

</code></pre>

<hr>
<h2 id='step1_down_rmse'>Step1 Down Model Root Mean Square Error Calculation</h2><span id='topic+step1_down_rmse'></span>

<h3>Description</h3>

<p>Calculate Root Mean Square Error (RMSE) for the one-step Šesták–Berggren kinetic model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>step1_down_rmse(
  data,
  y,
  .time,
  K = NULL,
  C = NULL,
  parms,
  reparameterisation = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="step1_down_rmse_+3A_data">data</code></td>
<td>
<p>Dataframe containing accelerated stability data (required).</p>
</td></tr>
<tr><td><code id="step1_down_rmse_+3A_y">y</code></td>
<td>
<p>Name of decreasing variable (e.g. concentration) contained within data (required).</p>
</td></tr>
<tr><td><code id="step1_down_rmse_+3A_.time">.time</code></td>
<td>
<p>Time variable contained within data (required).</p>
</td></tr>
<tr><td><code id="step1_down_rmse_+3A_k">K</code></td>
<td>
<p>Kelvin variable (numeric or column name) (optional).</p>
</td></tr>
<tr><td><code id="step1_down_rmse_+3A_c">C</code></td>
<td>
<p>Celsius variable (numeric or column name) (optional).</p>
</td></tr>
<tr><td><code id="step1_down_rmse_+3A_parms">parms</code></td>
<td>
<p>Values for the parameters as a list - k1, k2, k3, and c0. If multiple are provided all combinations will be used (required).</p>
</td></tr>
<tr><td><code id="step1_down_rmse_+3A_reparameterisation">reparameterisation</code></td>
<td>
<p>Use alternative parameterisation of the one-step
model which aims to reduce correlation between k1 and k2.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculate RMSE for the one-step Šesták–Berggren kinetic (non-linear) model using
user provided parameters.
</p>


<h3>Value</h3>

<p>A data frame containing one row for each RMSE calculation
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#load antigenicity and potency data.
data(antigenicity)
data(potency)

#Basic use of the step1_down_rmse function with C column defined.
rmse1 &lt;- step1_down_rmse(data = antigenicity, y = "conc", .time = "time",
 C = "Celsius", parms = list(c0 = c(96,98,100), k1 = c(42,45),
  k2 = c(12000,12500), k3 = c(8,9,10)))

#Basic use of the step1_down_rmse function with K column defined.
rmse2 &lt;- step1_down_rmse(data = antigenicity, y = "conc", .time = "time",
 K = "K", parms = list(c0 = c(98), k1 = c(42,45), k2 = c(12500), k3 = c(8,9)))

#reparameterisation is TRUE.
rmse3 &lt;- step1_down_rmse(data = antigenicity, y = "conc", .time = "time",
 C = "Celsius", parms = list(c0 = c(100,95), k1 = c(2,2.5), k2 = c(12000,13000),
  k3 = c(9,10)), reparameterisation = TRUE)

</code></pre>

<hr>
<h2 id='step1_plot_CI'>Plot Confidence Intervals</h2><span id='topic+step1_plot_CI'></span>

<h3>Description</h3>

<p>Plot the stability data and visualise the predictions with
confidence intervals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>step1_plot_CI(
  step1_down_object,
  xname = NULL,
  yname = NULL,
  xlim = NULL,
  ylim = NULL,
  ribbon = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="step1_plot_CI_+3A_step1_down_object">step1_down_object</code></td>
<td>
<p>The fit object from the step1.down function (required).</p>
</td></tr>
<tr><td><code id="step1_plot_CI_+3A_xname">xname</code></td>
<td>
<p>Label for the x-axis (optional).</p>
</td></tr>
<tr><td><code id="step1_plot_CI_+3A_yname">yname</code></td>
<td>
<p>Label for the y-axis (optional).</p>
</td></tr>
<tr><td><code id="step1_plot_CI_+3A_xlim">xlim</code></td>
<td>
<p>x-axis limits (optional).</p>
</td></tr>
<tr><td><code id="step1_plot_CI_+3A_ylim">ylim</code></td>
<td>
<p>y-axis limits (optional).</p>
</td></tr>
<tr><td><code id="step1_plot_CI_+3A_ribbon">ribbon</code></td>
<td>
<p>Add shade to confidence intervals (optional).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Use the fit object obtained from the step1.down function to plot the
data and visualise the predictions with confidence intervals applied.
There is an option to view the confidence intervals as a ribbon. The
confidence interval value is chosen in the step1.down function.
</p>


<h3>Value</h3>

<p>Plot of stability data with prediction curves and confidence intervals.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#load antigenciity data
data(antigenicity)

#run step1.down fit
fit1 &lt;- step1_down(data = antigenicity, y = "conc", .time = "time",
 C = "Celsius", max_time_pred = 3, confidence_interval = 0.9, validation = "validA")

#plot raw data with prediction curves and confidence intervals.
step1_plot_CI(step1_down_object = fit1, xlim = NULL, ylim = NULL,
 xname = "Time (Years)", yname = "Concentration", ribbon = TRUE)

</code></pre>

<hr>
<h2 id='step1_plot_desc'>Plot Stability Data</h2><span id='topic+step1_plot_desc'></span>

<h3>Description</h3>

<p>Plot raw accelerated stability data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>step1_plot_desc(
  data,
  y,
  .time,
  K = NULL,
  C = NULL,
  validation = NULL,
  xname = NULL,
  yname = NULL,
  xlim = NULL,
  ylim = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="step1_plot_desc_+3A_data">data</code></td>
<td>
<p>Dataframe containing accelerated stability data.</p>
</td></tr>
<tr><td><code id="step1_plot_desc_+3A_y">y</code></td>
<td>
<p>Name of decreasing variable (e.g. concentration) contained within data</p>
</td></tr>
<tr><td><code id="step1_plot_desc_+3A_.time">.time</code></td>
<td>
<p>Time variable contained within data.</p>
</td></tr>
<tr><td><code id="step1_plot_desc_+3A_k">K</code></td>
<td>
<p>Kelvin variable (numeric or column name) (optional).</p>
</td></tr>
<tr><td><code id="step1_plot_desc_+3A_c">C</code></td>
<td>
<p>Celsius variable (numeric or column name) (optional).</p>
</td></tr>
<tr><td><code id="step1_plot_desc_+3A_validation">validation</code></td>
<td>
<p>Validation dummy variable (column name) (optional).</p>
</td></tr>
<tr><td><code id="step1_plot_desc_+3A_xname">xname</code></td>
<td>
<p>Label for the x-axis (optional).</p>
</td></tr>
<tr><td><code id="step1_plot_desc_+3A_yname">yname</code></td>
<td>
<p>Label for the y-axis (optional).</p>
</td></tr>
<tr><td><code id="step1_plot_desc_+3A_xlim">xlim</code></td>
<td>
<p>x-axis limits (optional).</p>
</td></tr>
<tr><td><code id="step1_plot_desc_+3A_ylim">ylim</code></td>
<td>
<p>y-axis limits (optional).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Plot the raw accelerated stability data by selecting the columns -
response, time and temperature.
</p>


<h3>Value</h3>

<p>Plot of raw accelerated stability data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#load example datasets
data(antigenicity)
data(potency)

step1_plot_desc(data=antigenicity, y="conc", .time="time", C = "Celsius")

step1_plot_desc(data=potency, y="Potency", .time="Time", C = "Celsius")

</code></pre>

<hr>
<h2 id='step1_plot_diagnostic'>Create Diagnostic Plots</h2><span id='topic+step1_plot_diagnostic'></span>

<h3>Description</h3>

<p>Generate residual diagnostic plots from a step1_down fit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>step1_plot_diagnostic(step1_down_object, bins = 7, residuals = "classic")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="step1_plot_diagnostic_+3A_step1_down_object">step1_down_object</code></td>
<td>
<p>The fit object from the step1_down function (required).</p>
</td></tr>
<tr><td><code id="step1_plot_diagnostic_+3A_bins">bins</code></td>
<td>
<p>The number of bins in the Histogram plot (default 7).</p>
</td></tr>
<tr><td><code id="step1_plot_diagnostic_+3A_residuals">residuals</code></td>
<td>
<p>The type of residuals to plot classic/studentized/standardized (default classic).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Use the fit object obtained from the step1_down function to plot the
residual diagnostic plots, assess the quality of fit and search for anomalies.
Change the type of Residuals assessed.
Plots created are: Residuals Histogram, Observed Vs Predicted results, Residuals
Vs Predicted results and QQplot of Residuals.
</p>


<h3>Value</h3>

<p>A list containing the four ggplot2 plots.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#load antigenicity data
data(antigenicity)

#run step1_down fit
fit1 &lt;- step1_down(data = antigenicity, y = "conc", .time = "time",
 C = "Celsius", max_time_pred = 3)

#plot diagnostic plots to asses the fit
step1_plot_diagnostic(fit1)

</code></pre>

<hr>
<h2 id='step1_plot_PI'>Plot Prediction Intervals</h2><span id='topic+step1_plot_PI'></span>

<h3>Description</h3>

<p>Plot the stability data and visualise the predictions with prediction intervals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>step1_plot_PI(
  step1_down_object,
  xname = NULL,
  yname = NULL,
  xlim = NULL,
  ylim = NULL,
  ribbon = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="step1_plot_PI_+3A_step1_down_object">step1_down_object</code></td>
<td>
<p>The fit object from the step1.down function (required).</p>
</td></tr>
<tr><td><code id="step1_plot_PI_+3A_xname">xname</code></td>
<td>
<p>Label for the x-axis (optional).</p>
</td></tr>
<tr><td><code id="step1_plot_PI_+3A_yname">yname</code></td>
<td>
<p>Label for the y-axis (optional).</p>
</td></tr>
<tr><td><code id="step1_plot_PI_+3A_xlim">xlim</code></td>
<td>
<p>x-axis limits (optional).</p>
</td></tr>
<tr><td><code id="step1_plot_PI_+3A_ylim">ylim</code></td>
<td>
<p>y-axis limits (optional).</p>
</td></tr>
<tr><td><code id="step1_plot_PI_+3A_ribbon">ribbon</code></td>
<td>
<p>Add shade to prediction intervals (optional).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Use the fit object obtained from the step1.down function to plot the
stability data and visualise the predictions with prediction intervals applied.
There is an option to view the prediction intervals as a ribbon. The
prediction interval value is chosen in the step1.down function.
</p>


<h3>Value</h3>

<p>Plot of stability data with prediction curves and prediction intervals.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#load antigenicity data
data(antigenicity)

#run step1.down fit
fit1 &lt;- step1_down(data = antigenicity, y = "conc", .time = "time",
 C = "Celsius", max_time_pred = 3)

#plot raw data with prediction curves and prediction intervals.
step1_plot_PI(step1_down_object = fit1, xlim = NULL, ylim = NULL,
 xname = "Time (Years)", yname = "Concentration", ribbon = TRUE)

</code></pre>

<hr>
<h2 id='step1_plot_pred'>Plot Model Predictions</h2><span id='topic+step1_plot_pred'></span>

<h3>Description</h3>

<p>Plot the stability data and visualise the predictions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>step1_plot_pred(
  step1_down_object,
  xname = NULL,
  yname = NULL,
  xlim = NULL,
  ylim = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="step1_plot_pred_+3A_step1_down_object">step1_down_object</code></td>
<td>
<p>The fit object from the step1.down function (required).</p>
</td></tr>
<tr><td><code id="step1_plot_pred_+3A_xname">xname</code></td>
<td>
<p>Label for the x-axis (optional).</p>
</td></tr>
<tr><td><code id="step1_plot_pred_+3A_yname">yname</code></td>
<td>
<p>Label for the y-axis (optional).</p>
</td></tr>
<tr><td><code id="step1_plot_pred_+3A_xlim">xlim</code></td>
<td>
<p>x-axis limits (optional).</p>
</td></tr>
<tr><td><code id="step1_plot_pred_+3A_ylim">ylim</code></td>
<td>
<p>y-axis limits (optional).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Use the fit object from the step1.down function to plot the accelerated
stability data and visualise the predictions.
</p>


<h3>Value</h3>

<p>Plot of accelerated stability data with prediction curves.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#load antigenicity data
data(antigenicity)

fit1 &lt;- step1_down(data = antigenicity, y = "conc", .time = "time",
 C = "Celsius", max_time_pred = 3)

step1_plot_pred(step1_down_object = fit1, xlim = NULL, ylim = NULL,
 xname = "Time (Years)", yname = "Concentration")

</code></pre>

<hr>
<h2 id='step1_plot_T'>Focus on Temperature</h2><span id='topic+step1_plot_T'></span>

<h3>Description</h3>

<p>Plot the stability data and visualise the predictions with focus on
one temperature.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>step1_plot_T(
  step1_down_object,
  focus_T = NULL,
  xname = NULL,
  yname = NULL,
  xlim = NULL,
  ylim = NULL,
  ribbon = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="step1_plot_T_+3A_step1_down_object">step1_down_object</code></td>
<td>
<p>The fit object from the step1.down function (required).</p>
</td></tr>
<tr><td><code id="step1_plot_T_+3A_focus_t">focus_T</code></td>
<td>
<p>Selected temperature to highlight on the plot.</p>
</td></tr>
<tr><td><code id="step1_plot_T_+3A_xname">xname</code></td>
<td>
<p>Label for the x-axis (optional).</p>
</td></tr>
<tr><td><code id="step1_plot_T_+3A_yname">yname</code></td>
<td>
<p>Label for the y-axis (optional).</p>
</td></tr>
<tr><td><code id="step1_plot_T_+3A_xlim">xlim</code></td>
<td>
<p>the x-axis limits (optional).</p>
</td></tr>
<tr><td><code id="step1_plot_T_+3A_ylim">ylim</code></td>
<td>
<p>the y-axis limits (optional).</p>
</td></tr>
<tr><td><code id="step1_plot_T_+3A_ribbon">ribbon</code></td>
<td>
<p>adds shade to confidence and prediction intervals (optional).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Plot the stability data and visualise the predictions focusing on one
chosen temperature with confidence and prediction intervals.
</p>


<h3>Value</h3>

<p>ggplot2 object with focus on chosen temperature.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#load potency data
data(potency)

#run step1_down fit
fit1 &lt;- step1_down(data = potency, y = "Potency", .time = "Time",
 C = "Celsius", zero_order = TRUE)

#plot raw data with prediction curves with focus on temperature in dataset.
step1_plot_T(fit1, focus_T = 5,ribbon = TRUE, xlim = NULL, ylim = c(0,12),
 xname = "Time (Month)", yname = "Potency")

#plot raw data with prediction curves with focus on temperature not in dataset.
step1_plot_T(fit1, focus_T = -10,ribbon = TRUE, xlim = NULL, ylim = c(0,12),
 xname = "Time (Months)", yname = "Potency")

</code></pre>

<hr>
<h2 id='step1_sample_mvt'>Sample the Multivariate t Distribution</h2><span id='topic+step1_sample_mvt'></span>

<h3>Description</h3>

<p>Take a selected number of samples from the multivariate t distribution (mvt).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>step1_sample_mvt(
  data,
  y,
  .time,
  K = NULL,
  C = NULL,
  validation = NULL,
  draw,
  parms = NULL,
  reparameterisation = FALSE,
  zero_order = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="step1_sample_mvt_+3A_data">data</code></td>
<td>
<p>Dataframe containing accelerated stability data (required).</p>
</td></tr>
<tr><td><code id="step1_sample_mvt_+3A_y">y</code></td>
<td>
<p>Name of decreasing variable (e.g. concentration) contained within data
(required).</p>
</td></tr>
<tr><td><code id="step1_sample_mvt_+3A_.time">.time</code></td>
<td>
<p>Time variable contained within data (required).</p>
</td></tr>
<tr><td><code id="step1_sample_mvt_+3A_k">K</code></td>
<td>
<p>Kelvin variable (numeric or column name) (optional).</p>
</td></tr>
<tr><td><code id="step1_sample_mvt_+3A_c">C</code></td>
<td>
<p>Celsius variable (numeric or column name) (optional).</p>
</td></tr>
<tr><td><code id="step1_sample_mvt_+3A_validation">validation</code></td>
<td>
<p>Validation dummy variable (column name) (optional).</p>
</td></tr>
<tr><td><code id="step1_sample_mvt_+3A_draw">draw</code></td>
<td>
<p>Number of samples to draw from mvt (required).</p>
</td></tr>
<tr><td><code id="step1_sample_mvt_+3A_parms">parms</code></td>
<td>
<p>Starting values for the parameters as a list - k1, k2, k3, and c0 (optional).</p>
</td></tr>
<tr><td><code id="step1_sample_mvt_+3A_reparameterisation">reparameterisation</code></td>
<td>
<p>Use alternative parameterisation of the one-step
model which aims to reduce correlation between k1 and k2.</p>
</td></tr>
<tr><td><code id="step1_sample_mvt_+3A_zero_order">zero_order</code></td>
<td>
<p>Set kinetic order, k3, to zero (straight lines).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Using the provided data the function creates a fit of the
Šesták–Berggren kinetic model and then draws a selected number of
samples from the mvt of the model parameters.
</p>


<h3>Value</h3>

<p>A matrix containing parameter draws from the mvt distribution.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#load antigenicity data.
data(antigenicity)

#Basic use of the step1_sample_mvt function with C column defined and 1000 draws.
sample1 &lt;- step1_sample_mvt(data = antigenicity, y = "conc", .time = "time",
 C = "Celsius", draw = 1000)

#Basic use of the step1_sample_mvt function with K column defined and 50000 draws
sample2 &lt;- step1_sample_mvt(data = antigenicity, y = "conc", .time = "time",
 K = "K", draw = 50000)

#reparameterisation is TRUE and 10000 draws.
sample3 &lt;- step1_sample_mvt(data = antigenicity, y = "conc", .time = "time",
C = "Celsius", reparameterisation = TRUE, draw = 10000)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
