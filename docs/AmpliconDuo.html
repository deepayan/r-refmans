<!DOCTYPE html><html><head><title>Help for package AmpliconDuo</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {AmpliconDuo}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#AmpliconDuo-package'>
<p>Statistical Analysis Of Amplicon Data Of The Same Sample To Identify Spurious Amplicons</p></a></li>
<li><a href='#accepted.amplicons'>
<p>List Of Amplicon Indices That Passed Filter Criteria</p></a></li>
<li><a href='#ampliconduo'>
<p>Apply Fisher's Exact Tests To Two Amplicon Frequency Sets Of The Same Sample</p></a></li>
<li><a href='#ampliconfreqs'>
<p>SSU Amplicon Frequencies Of Different Sampling Sites (Short Version)</p></a></li>
<li><a href='#ampliconfreqs.long'>
<p>SSU Amplicon Frequencies Of Different Sampling Sites</p></a></li>
<li><a href='#amplicons'>
<p>Example List of Ampliconduo Data Frames</p></a></li>
<li><a href='#discordance.delta'>
<p>Measure Of Discordance Between Two Amplicon Data Sets</p></a></li>
<li><a href='#filter.ampliconduo'>
<p>AmpliconDuo Amplicon Filter</p></a></li>
<li><a href='#filter.ampliconduo.set'>
<p>AmpliconDuo List Amplicon Filter</p></a></li>
<li><a href='#plotAmpliconduo'>
<p>Frequeny-Frequency Plot Focusing On Significant Deviations In Amplicon Occurences</p></a></li>
<li><a href='#plotAmpliconduo.set'>
<p>Frequeny-Frequency Plot Arrangement Focusing On Significant Deviations In Amplicon Occurences</p></a></li>
<li><a href='#plotORdensity'>
<p>Probability Density Plot Of Odds Ratios</p></a></li>
<li><a href='#site.f'>
<p>Sampling Site Short Names</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Statistical Analysis of Amplicon Data of the Same Sample to
Identify Artefacts</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-05-22</td>
</tr>
<tr>
<td>Author:</td>
<td>Anja Lange [aut, cre],
  Daniel Hoffmann [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Anja Lange &lt;anja.lange@uni-due.de&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10), stats, ggplot2, xtable</td>
</tr>
<tr>
<td>Description:</td>
<td>Increasingly powerful techniques for high-throughput sequencing open the possibility to comprehensively characterize microbial communities, including rare species. However, a still unresolved issue are the substantial error rates in the experimental process generating these sequences. To overcome these limitations we propose an approach, where each sample is split and the same amplification and sequencing protocol is applied to both halves. This procedure should allow to detect likely PCR and sequencing artifacts, and true rare species by comparison of the results of both parts. The AmpliconDuo package, whereas amplicon duo from here on refers to the two amplicon data sets of a split sample, is intended to help interpret the obtained read frequency distribution across split samples, and to filter the false positive reads.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-05-25 10:31:28 UTC; anja</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-05-25 22:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='AmpliconDuo-package'>
Statistical Analysis Of Amplicon Data Of The Same Sample To Identify Spurious Amplicons
</h2><span id='topic+AmpliconDuo-package'></span><span id='topic+AmpliconDuo'></span>

<h3>Description</h3>

<p>Increasingly powerful techniques for high-throughput sequencing open the
possibility to comprehensively characterize microbial communities,
including rare species. However, a still unresolved issue are the
substantial error rates in the experimental process generating these
sequences. To overcome these limitations we propose an approach, where
each sample is split and the same amplification and sequencing protocol
is applied to both halves. This procedure should allow to detect likely PCR and sequencing artifacts, 
and true rare species by comparison of the results of both parts.
</p>
<p>The <span class="pkg">AmpliconDuo</span> package, whereas ampliconduo from here on refers to the two amplicon data sets of a split sample,
is intended to help interpret the obtained amplicon frequency distribution across split samples, 
and to filter the false positive amplicons.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> AmpliconDuo</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.1.1</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2020-05-22</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2 </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>The core of this package is the <code><a href="#topic+ampliconduo">ampliconduo</a></code> function, that generates for each pair of a split samples an ampliconduo data frame, while statistically analysing the data by Fisher's exact test.
Ampliconduo data frames, or lists of these, are the input required for all other functions of this package.
</p>

<ul>
<li><p><code><a href="#topic+plotAmpliconduo">plotAmpliconduo</a></code> 
plots for an ampliconduo the amplicon frequencies (number of reads per amplicon) of sample A vs. amplicon frequencies of sample B, highlighting amplicons displaying a significant deviation between both samples.

</p>
</li>
<li><p><code><a href="#topic+plotAmpliconduo.set">plotAmpliconduo.set</a></code>
does the same as <code>plotAmpliconduo</code> but accepts a list of ampliconduo data frames and arranges the plots in a 2-dimensional array.

</p>
</li>
<li><p><code><a href="#topic+plotORdensity">plotORdensity</a></code> 
generates a histogram plot of the amplicon frequency odds ratio density for an ampliconduo data frame. For multiple data frames
organizes the plots in a 2-dimentional array.

</p>
</li>
<li><p><code><a href="#topic+discordance.delta">discordance.delta</a></code>
calculates delta (<code class="reqn">\Delta</code>) and delta prime (<code class="reqn">\Delta'</code>), the fraction of amplicon frequencies and amplicons, respectively, with a false discovery rate below a certain threshold <code class="reqn">\theta</code> as a measure of discordance between two amplicon data sets A and B.

</p>
</li>
<li><p><code><a href="#topic+filter.ampliconduo">filter.ampliconduo</a></code>
applies filter criteria to an ampliconduo data frame deciding which amplicons are going to be rejected.

</p>
</li>
<li><p><code><a href="#topic+filter.ampliconduo.set">filter.ampliconduo.set</a></code>
same as <code>filter.ampliconduo</code> for a list af ampliconduo data frames.

</p>
</li>
<li><p><code><a href="#topic+accepted.amplicons">accepted.amplicons</a></code>
returns the indices of those amplicons that have passed the filter criteria.

</p>
</li></ul>



<h3>Author(s)</h3>

<p>Anja Lange (<a href="mailto:anja.lange@uni-due.de">anja.lange@uni-due.de</a>)
and
Daniel Hoffmann (<a href="mailto:daniel.hoffmann@uni-due.de">daniel.hoffmann@uni-due.de</a>)
</p>
<p>Maintainer: Anja Lange (<a href="mailto:anja.lange@uni-due.de">anja.lange@uni-due.de</a>)
</p>


<h3>References</h3>

<p>Lange A, Jost S, Heider D, Bock C, Budeus B, et al. (2015) AmpliconDuo: A Split-Sample Filtering Protocol for High-Throughput Amplicon Sequencing of Microbial Communities. PLOS ONE 10(11): e0141590
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## load test amplicon frequency data ampliconfreqs and vector with sample names site.f
data(ampliconfreqs)
data(site.f)

## generating ampliconduo data frames 
## depending on the size if the data sets, may take some time
ampliconduoset &lt;- ampliconduo(ampliconfreqs[,1:4], sample.names = site.f[1:2])

## plot amplicon read numbers of sample A  vs. amplicon read numbers of sample B,
## indicating amplicons with significant deviations in their occurence across samples
plotAmpliconduo.set(ampliconduoset, nrow = 3)

## calculate discordance between the two data sets of an ampliconduo
discordance &lt;- discordance.delta(ampliconduoset)

## plot the odds ratio density of ampliconduo data
plotORdensity(ampliconduoset)

## apply filter criteria to remove/mark spurious amplicons
ampliconduoset.f &lt;- filter.ampliconduo.set(ampliconduoset, min.freq = 1, q = 0.05)

## return indices of accepted amplicons, indices correspond to indices of the ampliconfreqs data, 
## that were used as input for the ampliconduo function
accep.reads &lt;- accepted.amplicons(ampliconduoset.f)
</code></pre>

<hr>
<h2 id='accepted.amplicons'> 
List Of Amplicon Indices That Passed Filter Criteria
</h2><span id='topic+accepted.amplicons'></span>

<h3>Description</h3>

<p>Returns the indices of those amplicons in an ampliconduo data frame, that passed the applied filter criteria (ampliconduo data frames are filtered using the <code><a href="#topic+filter.ampliconduo">filter.ampliconduo</a></code> or <code><a href="#topic+filter.ampliconduo.set">filter.ampliconduo.set</a></code> function). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>accepted.amplicons(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="accepted.amplicons_+3A_x">x</code></td>
<td>

<p>An ampliconduo data frame or a list of ampliconduo data frames.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calling this function on an ampliconduo data frame, or a list of the latter, returns the indices of amplicons that passed the applied filter criteria. For each ampliconduo data frame an integer vector is created, and if a list of ampliconduo data frames is supplied with <code>x</code>, these are pooled in a list.
The returned indices correspond to the data originally used to generate the ampliconduo data frames (parameter <code>A</code> and <code>B</code> in  the <code><a href="#topic+ampliconduo">ampliconduo</a></code> function call).
</p>


<h3>Value</h3>

<p>If <code>x</code> is an ampliconduo data frame, an integer vector is returned.
</p>
<p>In case <code>x</code> is a list of ampliconduo data frames, a list of integer
vectors is returned, one for each data frame.
</p>


<h3>Author(s)</h3>

<p>Anja Lange
&amp;
Daniel Hoffmann
</p>


<h3>See Also</h3>

<p><code><a href="#topic+filter.ampliconduo">filter.ampliconduo</a></code> and <code><a href="#topic+filter.ampliconduo.set">filter.ampliconduo.set</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## load example data
data(amplicons)

## apply filter criteria
ampliconduos.f &lt;- filter.ampliconduo.set(amplicons, q = 0.05)

## return a list with accepted amplicons
good.reads &lt;- accepted.amplicons(ampliconduos.f)
</code></pre>

<hr>
<h2 id='ampliconduo'>
Apply Fisher's Exact Tests To Two Amplicon Frequency Sets Of The Same Sample
</h2><span id='topic+ampliconduo'></span>

<h3>Description</h3>

<p>Implements Fisher's exact test to detect amplicons with significant
deviating read numbers between two amplicon sets of the same sample. The
p-values of the Fisher's exact test are corrected for multiple testing
by computation of the false discovery rates q. This function is intended
to help identifying reads that may be the results of experimental artefacts.
(The calculation can take some time depending on the size of the data sets and 
the computing power.)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ampliconduo(A, B = NULL, sample.names = NULL, correction = "fdr", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ampliconduo_+3A_a">A</code></td>
<td>

<p>A list or a data frame containing amplicon occurences / number of reads per amplicon (integer values). 
</p>
</td></tr>
<tr><td><code id="ampliconduo_+3A_b">B</code></td>
<td>

<p>Optional. A list or a data frame containing amplicon occurences. 
</p>
</td></tr>
<tr><td><code id="ampliconduo_+3A_sample.names">sample.names</code></td>
<td>

<p>Optional. A vector or list of characters with names for the amplicon pairs.
</p>
</td></tr>
<tr><td><code id="ampliconduo_+3A_correction">correction</code></td>
<td>

<p>Optional. Specifies the correction method for the p-values from Fisher's exact test.
Accepts one of the following characters: <code>"holm", "hochberg", "hommel",</code>
<code>"bonferroni", "BH", "BY","fdr"</code> and <code>"none"</code>. Default is <code>"fdr"</code>.
For more details see <code><a href="stats.html#topic+p.adjust">p.adjust</a></code>.
</p>
</td></tr>
<tr><td><code id="ampliconduo_+3A_...">...</code></td>
<td>

<p>Arguments passed to the internally called <code><a href="stats.html#topic+fisher.test">fisher.test</a></code> function.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If only <code>A</code> is specified, it is assumed that the list elements 1 &amp;
2, 3 &amp; 4 etc. of <code>A</code> are amplicon data of the same sample. In case <code>A</code> and <code>B</code>
are specified, the <em>i</em>th frequency set of <code>A</code> and <code>B</code>
are combined. For each amplicon data pair, frequencies at the corresponding
positions in the lists are assumed to belong to the same amplicon. It is required, that two frequency sets that belong to the same sample, an ampliconduo, have the same length. The <code>ampliconduo</code> function iterates over all amplicon pairs and performs the following tasks:
</p>

<ul>
<li>
<p>amplicons with frequency zero in both samples are removed. Position information is retained.
</p>
</li>
<li>
<p>For each amplicon Fisher's exact test using the method <code><a href="stats.html#topic+fisher.test">fisher.test</a></code>
is performed. The p-value, odds ratio and confidence interval are returned. Via the <code>...</code>, arguments
<code>conf.level</code>, <code>or</code> and <code>alternative</code> can be passed to the <code><a href="stats.html#topic+fisher.test">fisher.test</a></code> function call. Default values are <code>conf.level</code> = 0.95, <code>or</code> = 1 and <code>alternative</code> = &quot;two.sided&quot;.
</p>
</li>
<li>
<p>The p-values are corrected using the <code><a href="stats.html#topic+p.adjust">p.adjust</a></code> function. By default the method by Benjamini &amp; Hochberg (1995) is used.
Setting the <code>correction</code> argument to any of the following characters <code>"holm", "hochberg", "hommel", "bonferroni", "BH", "BY",    "fdr", "none"</code>, the adjustment method for the p-values can be changed. See function <code><a href="stats.html#topic+p.adjust">p.adjust</a></code>.

</p>
</li></ul>

<p>The <span class="pkg">AmpliconDuo</span> package implements further methods to visualize and filter the returned ampliconduo data frames.
</p>


<h3>Value</h3>

<p>A list of data frames, one for each amplicon pair, that will be called <dfn>ampliconduo data frame</dfn> in the following. List entries are named according to the specified <code>sample.names</code> or numbered.
</p>
<p>Each ampliconduo data frame has 9 columns
</p>

<ul>
<li>
<p>freqA: frequencies of amplicon set A
</p>
</li>
<li>
<p>freqB: frequencies of amplicon set B (taken from argument <code>B</code> if specified)
</p>
</li>
<li>
<p>p: p-values calculated with Fisher's exact test
</p>
</li>
<li>
<p>OR: odds ratio calculated with Fisher's exact test
</p>
</li>
<li>
<p>CI.low: lower confidence limit for <code>OR</code>
</p>
</li>
<li>
<p>CI.up: upper confidence limit for <code>OR</code>
</p>
</li>
<li>
<p>rejected: logical, indicating whether the amplicon was rejected
</p>
</li>
<li>
<p>sample: sample name taken from <code>sample.name</code> if specified, same for all rows in a given data frame 
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Anja Lange
and
Daniel Hoffmann
</p>


<h3>References</h3>

<p>Y Benjamini and Y Hochberg. Controlling the False Discovery Rate: A
Practical and Powerful Approach to Multiple Testing. <em>Journal of the Royal
Statistical Society</em>. Series B (Methodological), <strong>57(1)</strong>:289-300, 1995.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+fisher.test">fisher.test</a></code>, used to calculate the p-value, odds ratio and confidence interval; 
</p>
<p><code><a href="stats.html#topic+p.adjust">p.adjust</a></code>, called to correct the p-values;
</p>
<p>methods to visualize or further manipulate the ampliconduo data frames:
</p>
<p><code><a href="#topic+plotAmpliconduo.set">plotAmpliconduo.set</a></code>, 
<code><a href="#topic+plotAmpliconduo">plotAmpliconduo</a></code>, 
<code><a href="#topic+discordance.delta">discordance.delta</a></code>, 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## loads read numbers from example amplicon data sets
data(ampliconfreqs)
data(site.f)

## generate ampliconduo data frames 
ampliconduos.a &lt;- ampliconduo(A = ampliconfreqs[,1:4], sample.names = site.f[1:2])
ampliconduos.b &lt;- ampliconduo(A = ampliconfreqs[c(1,3)],
B = ampliconfreqs[c(2,4)], sample.names = site.f[1:2],
conf.level = 0.9)

## frequency plot
plotAmpliconduo.set(ampliconduos.a)
</code></pre>

<hr>
<h2 id='ampliconfreqs'>
SSU Amplicon Frequencies Of Different Sampling Sites (Short Version)
</h2><span id='topic+ampliconfreqs'></span>

<h3>Description</h3>

<p>A data frame with 16 amplicon data sets taken from 8 different sampling sites. A reduced version (frequencies of 2500 amplicons) of the <code><a href="#topic+ampliconfreqs.long">ampliconfreqs.long</a></code> data provided with this package. 
Samples from each sampling site were sequenced twice, corresponding to sets A and B (e.g. column  FU25.A and FU25.B). 
Names of the sampling sites are specified in the data <code><a href="#topic+site.f">site.f</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ampliconfreqs)</code></pre>


<h3>Format</h3>

<p>A data frame with 80903 observations on the following 16 variables.
</p>

<dl>
<dt><code>FU25.A</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>FU25.B</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>FU28.A</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>FU28.B</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>FU31.A</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>FU31.B</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>FU31.C</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>FU31.D</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>FU34.A</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>FU34.B</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>FU37.A</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>FU37.B</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>UniPond.A</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>UniPond.B</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>BogSoil.A</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>BogSoil.B</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>References</h3>

<p>Boenigk J, Heider D, Jost S, Lange A, Budeus B, Schilling E,
Strittmatter A, Hoffmann D: A high-throughput amplicon sequencing and
analysis protocol for comparative analyses of microbial communities
<em>(submitted)</em>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ampliconfreqs)
data(site.f)
ampliconduo.a &lt;- ampliconduo(ampliconfreqs[,1:4], sample.names = site.f[1:2])
</code></pre>

<hr>
<h2 id='ampliconfreqs.long'>
SSU Amplicon Frequencies Of Different Sampling Sites
</h2><span id='topic+ampliconfreqs.long'></span>

<h3>Description</h3>

<p>A data frame with 16 amplicon data sets taken from 8 different sampling sites. 
Samples from each sampling site were sequenced twice, corresponding to sets A and B (e.g. column  FU25.A and FU25.B). 
Names of the sampling sites are specified in the data <code><a href="#topic+site.f">site.f</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ampliconfreqs.long)</code></pre>


<h3>Format</h3>

<p>A data frame with 80903 observations on the following 16 variables.
</p>

<dl>
<dt><code>FU25.A</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>FU25.B</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>FU28.A</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>FU28.B</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>FU31.A</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>FU31.B</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>FU31.C</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>FU31.D</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>FU34.A</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>FU34.B</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>FU37.A</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>FU37.B</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>UniPond.A</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>UniPond.B</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>BogSoil.A</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>BogSoil.B</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>References</h3>

<p>Boenigk J, Heider D, Jost S, Lange A, Budeus B, Schilling E,
Strittmatter A, Hoffmann D: A high-throughput amplicon sequencing and
analysis protocol for comparative analyses of microbial communities
<em>(submitted)</em>
</p>

<hr>
<h2 id='amplicons'>
Example List of Ampliconduo Data Frames
</h2><span id='topic+amplicons'></span>

<h3>Description</h3>

<p>A list of ampliconduo data frames that was generated calling the
<code><a href="#topic+ampliconduo">ampliconduo</a></code> function with its default parameters and the 
<code><a href="#topic+ampliconfreqs.long">ampliconfreqs.long</a></code> data provided with this package as input. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(amplicons)</code></pre>


<h3>References</h3>

<p>Boenigk J, Heider D, Jost S, Lange A, Budeus B, Schilling E,
Strittmatter A, Hoffmann D: A high-throughput amplicon sequencing and
analysis protocol for comparative analyses of microbial communities
<em>(submitted)</em>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(amplicons)
plotAmpliconduo.set(amplicons, nrow = 3)
</code></pre>

<hr>
<h2 id='discordance.delta'>
Measure Of Discordance Between Two Amplicon Data Sets 
</h2><span id='topic+discordance.delta'></span>

<h3>Description</h3>

<p>Calculates delta (<code class="reqn">\Delta</code>) and delta prime (<code class="reqn">\Delta'</code>), the fraction of amplicon frequencies and amplicons, respectively, with a false discovery rate below a certain threshold <code class="reqn">\theta</code> as a measure of discordance between two amplicon data sets A and B.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>discordance.delta(x, names = NULL, theta = 0.05, corrected = TRUE,
printToTex = FALSE, directory = NULL, file.name = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="discordance.delta_+3A_x">x</code></td>
<td>

<p>A list of amplicon duo data frames as returned by the <code><a href="#topic+ampliconduo">ampliconduo</a></code> function.
</p>
</td></tr>
<tr><td><code id="discordance.delta_+3A_names">names</code></td>
<td>

<p>Optional. Vector or list of characters specifying the sample/amplicon pair names. By default 
names are taken from the element names of <code>x</code>.
</p>
</td></tr>
<tr><td><code id="discordance.delta_+3A_theta">theta</code></td>
<td>

<p>Optional. Numeric, threshold for the false discovery rate. Default value is 0.05.
</p>
</td></tr>
<tr><td><code id="discordance.delta_+3A_corrected">corrected</code></td>
<td>

<p>Optional. Logical, indicates whether the p-value from Fisher's exact test (FALSE) or the 
adjusted p-value (TRUE), here called q, is used for calculation of <code class="reqn">\Delta</code> and <code class="reqn">\Delta'</code>.
</p>
</td></tr>
<tr><td><code id="discordance.delta_+3A_printtotex">printToTex</code></td>
<td>

<p>Optional. Logical, if <code>TRUE</code> writes a file with the resulting table in Tex format. Default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="discordance.delta_+3A_directory">directory</code></td>
<td>

<p>Optional. If <code>printToTex</code> is <code>TRUE</code>, the output file will be saved in the specified directory.
</p>
</td></tr>
<tr><td><code id="discordance.delta_+3A_file.name">file.name</code></td>
<td>

<p>Optional. If <code>printToTex</code> is <code>TRUE</code>, the output file will have the name <code>file.name</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculates <code class="reqn">\Delta</code> and <code class="reqn">\Delta'</code>, the fraction of frequencies of amplicons and amplicons, respectively, with false discovery rate below a certain threshold <code class="reqn">\theta</code> as a measure of discordance between two amplicon data sets A and B with occurence <code class="reqn">r_{(iAS)}</code> of amplicon <em>i</em> in amplicon set A of sample S (the ampliconduo data frame).
<code class="reqn">\Delta</code> and <code class="reqn">\Delta'</code> are defined as follows:
</p>
<p style="text-align: center;"><code class="reqn"> 
  \Delta_{S\theta}  = \frac{\sum_{i=1}^{n_S}(r_{iAS}+r_{iBS})\delta(q_{iS}&lt;\theta)}{\sum_{i=1}^{n_S}(r_{iAS}+r_{iBS})}\\
</code>
</p>

<p style="text-align: center;"><code class="reqn">
  \Delta'_{S\theta} = \frac{\sum_{i=1}^{n_S}\delta(q_{iS}&lt;\theta)}{n_S},\\
</code>
</p>

<p style="text-align: center;"><code class="reqn">
  \mathrm{with\;} \delta(q_{iS}&lt;\theta) =
  \left\{
  \begin{array}{cc}
  1 &amp; \mathrm{\;for\;} q_{iS} &lt; \theta\\
  0 &amp; \mathrm{\;for\;} q_{iS} \ge \theta
  \end{array}
  \right. 
</code>
</p>

<p><img src="../help/figures/discordanceDelta.png" width="400" alt="discordanceDelta.png" />
</p>
<p>for number <code class="reqn">n_S</code> of amplicons detected in sample/ampliconduo S. <code class="reqn">\Delta_{S\theta}</code> and <code class="reqn">\Delta'_{S\theta}</code> are located between 0 (no discordance, i.e. no statistically significant deviations between experimental branches) and 1 (complete discordance).
</p>
<p><code>x</code> is the return value of a <code>ampliconduo</code> call.
</p>


<h3>Value</h3>

<p>Data frame with three columns. The first column contains the sample/amplicon pair names. Second and third column 
harbor the corresponding <code class="reqn">\Delta</code> and <code class="reqn">\Delta'</code> values, respectively.
</p>


<h3>Author(s)</h3>

<p>Anja Lange
&amp;
Daniel Hoffmann
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ampliconduo">ampliconduo</a></code>, generates the expected data format for <code>x</code>
</p>
<p><code><a href="xtable.html#topic+xtable">xtable</a></code>, used to convert the returned data frame into a <code>Latex</code> table.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## load example ampliconduo data frame
data(amplicons)

## calculate the discordance between amplicon data sets of an ampliconduo data frame
dd.a &lt;- discordance.delta(amplicons)
dd.b &lt;- discordance.delta(amplicons, theta = 0.1)
</code></pre>

<hr>
<h2 id='filter.ampliconduo'>
AmpliconDuo Amplicon Filter
</h2><span id='topic+filter.ampliconduo'></span>

<h3>Description</h3>

<p>Marks or removes amplicons from an ampliconduo data frame according to the specified filter criteria.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>filter.ampliconduo(x, min.freq = 1, OR = NULL, q = NULL, p = NULL, remove = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="filter.ampliconduo_+3A_x">x</code></td>
<td>

<p>Data frame, an ampliconduo data frame returned by the <code><a href="#topic+ampliconduo">ampliconduo</a></code> function.
</p>
</td></tr>
<tr><td><code id="filter.ampliconduo_+3A_min.freq">min.freq</code></td>
<td>

<p>Optional. Integer, minimium frequency/read count for an amplicon in each of the two amplicon sets to be retained.
Default value is 1.
</p>
</td></tr>
<tr><td><code id="filter.ampliconduo_+3A_or">OR</code></td>
<td>

<p>Optional. Numeric, minimum odds ratio for an amplicon to be retained. If no value is specified the odds ratio is 
excluded from the filter criteria.
</p>
</td></tr>
<tr><td><code id="filter.ampliconduo_+3A_q">q</code></td>
<td>

<p>Optional. Numeric, minimum value for <code>q</code>, the adjusted p-value for
an amplicon to pass the filter. If no value 
is specified, <code>q</code> is excluded from the filter criteria.
</p>
</td></tr>
<tr><td><code id="filter.ampliconduo_+3A_p">p</code></td>
<td>

<p>Optional. Numeric, minimum p-value for an amplicon to pass the filter. If no value for <code>p</code>
is specified <code>p</code> is excluded from the filter criteria.
</p>
</td></tr>
<tr><td><code id="filter.ampliconduo_+3A_remove">remove</code></td>
<td>

<p>Optional. Logical, decides whether amplicons that fail the filter criteria should be removed (<code>TRUE</code>),
or retained (<code>FALSE</code>).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Takes the <code>ampliconduo</code> data frame <code>x</code> and applies each filter criterion that is selected to each amplicon.
If an amplicon <em>i</em> does not pass each of the applied criteria, the logical value in column <code>rejected</code> in row <em>i</em> is set to <code>TRUE</code>.
In case the parameter <code>remove</code> was set to <code>TRUE</code>, all amplicons with <code>rejected = TRUE</code> are removed. The position information with respect to the data used as input for the <code><a href="#topic+ampliconduo">ampliconduo</a></code> call is retained.
</p>


<h3>Value</h3>

<p>Data frame corresponding to the input <code>x</code>, but with the adjustments in the <code>rejected</code> column according to the specified filter criteria, or removed rows (<code>removed = TRUE</code>).
</p>


<h3>Author(s)</h3>

<p>Anja Lange
&amp;
Daniel Hoffmann
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ampliconduo">ampliconduo</a></code>, generates the input data <code>x</code> for this method.
</p>
<p><code><a href="#topic+accepted.amplicons">accepted.amplicons</a></code>, returns the indices of amplicons that
have passed the filter criteria.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##load example data
data(amplicons)

## extract the first ampliconduo data frame
ampliconduo1 &lt;- amplicons[[1]]

## apply filter criteria 
ampliconduo1.f &lt;- filter.ampliconduo(ampliconduo1)
ampliconduo1.f &lt;- filter.ampliconduo(ampliconduo1, min.freq = 2, remove = TRUE)

## to return a list with the indices (corresponding to the indices of the data 
## the ampliconduo function was called on) of all amplicons that passed the filter criteria 
good.reads &lt;- accepted.amplicons(ampliconduo1.f)

</code></pre>

<hr>
<h2 id='filter.ampliconduo.set'>
AmpliconDuo List Amplicon Filter
</h2><span id='topic+filter.ampliconduo.set'></span>

<h3>Description</h3>

<p>Marks or removes amplicons from each ampliconduo data frame in a list according to the specified filter criteria.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>filter.ampliconduo.set(x, min.freq = 1, OR = NULL, q = NULL, p = NULL, remove = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="filter.ampliconduo.set_+3A_x">x</code></td>
<td>

<p>List of ampliconduo data frames, return value of an <code><a href="#topic+ampliconduo">ampliconduo</a></code> call.
</p>
</td></tr>
<tr><td><code id="filter.ampliconduo.set_+3A_min.freq">min.freq</code></td>
<td>

<p>Optional. Integer, minimium frequency/read count for a given amplicon in each of the two amplicon sets of an ampliconduo to be retained.
Default value is 1.
</p>
</td></tr>
<tr><td><code id="filter.ampliconduo.set_+3A_or">OR</code></td>
<td>

<p>Optional. Numeric, minimum odds ratio for an amplicon to be retained. 
If no value is specified the odds ratio is excluded from the filter criteria.
</p>
</td></tr>
<tr><td><code id="filter.ampliconduo.set_+3A_q">q</code></td>
<td>

<p>Optional. Numeric, minimum value for <code>q</code>, the adjusted p-value foran amplicon to pass the filter. 
If no value is specified, <code>q</code> is excluded from the filter criteria.
</p>
</td></tr>
<tr><td><code id="filter.ampliconduo.set_+3A_p">p</code></td>
<td>

<p>Optional. Numeric, minimum p-value for an amplicon to pass the filter.
If no value for <code>p</code> is specified <code>p</code> is excluded from the filter criteria.
</p>
</td></tr>
<tr><td><code id="filter.ampliconduo.set_+3A_remove">remove</code></td>
<td>

<p>Optional. Logical, decides whether amplicons that fail the filter criteria should be removed (<code>TRUE</code>),
or retained (<code>FALSE</code>).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For every <code>ampliconduo</code> data frame in argument <code>x</code>, applies
each filter criterion that was specified to each amplicon.
If an amplicon <em>i</em> fails any of the applied criteria, the logical value in column <code>rejected</code> in row <em>i</em> is set to <code>TRUE</code>.
In case the parameter <code>remove</code> was set to <code>TRUE</code>, all amplicons with <code>rejected = TRUE</code> are removed. The position information in respect to the data used as input for the <code><a href="#topic+ampliconduo">ampliconduo</a></code> call are kept.
This method uses the function <code><a href="#topic+filter.ampliconduo">filter.ampliconduo</a></code>.
</p>


<h3>Value</h3>

<p>List of ampliconduo data frames. Same as input parameter <code>x</code> but with the adjustments in the <code>rejected</code> column according to the specified filter criteria, or removed rows (<code>removed = TRUE</code>)
</p>


<h3>Author(s)</h3>

<p>Anja Lange
&amp;
Daniel Hoffmann
</p>


<h3>See Also</h3>

<p><code><a href="#topic+filter.ampliconduo">filter.ampliconduo</a></code>, performs filtering on single ampliconduo data.frames, is called by this method.
</p>
<p><code><a href="#topic+ampliconduo">ampliconduo</a></code>, generates the input data <code>x</code> for this method.
</p>
<p><code><a href="#topic+accepted.amplicons">accepted.amplicons</a></code>, returns the indices of amplicons that
have passed the filter criteria.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## load example data
data(amplicons)

## apply filter criteria
ampliconduos.f &lt;- filter.ampliconduo.set(amplicons)
ampliconduos.f &lt;- filter.ampliconduo.set(amplicons, min.freq = 3, remove = TRUE)

## to return a list with the indices (corresponding to the indices of the data 
## the ampliconduo function was called on) of all amplicons that passed the filter criteria 
good.reads &lt;- accepted.amplicons(ampliconduos.f)
</code></pre>

<hr>
<h2 id='plotAmpliconduo'>
Frequeny-Frequency Plot Focusing On Significant Deviations In Amplicon Occurences
</h2><span id='topic+plotAmpliconduo'></span>

<h3>Description</h3>

<p>Applied to an ampliconduo data frame, one element of the return value of
the <code><a href="#topic+ampliconduo">ampliconduo</a></code> function. Generates a plot of <code>freqB</code>
over <code>freqA</code> (the read numbers of the same amplicon in both halves
A and B of a split sample). For amplicons that have significantly
deviating read numbers, i.e. with a p-value or adjusted p-value below a
certain treshold, points are colored differently (default: red).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotAmpliconduo(x, color.treshold = 0.05, xlab = "Abundance (PCR A)", 
ylab = "Abundance (PCR B)",main = NULL, log = "xy", corrected = TRUE, asp = 1, 
legend.position = NULL, save = FALSE, path = NULL, file.name = NULL,
format = "jpeg", h.start = 0, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotAmpliconduo_+3A_x">x</code></td>
<td>

<p>Ampliconduo data frame, an element of the returned list of the <code><a href="#topic+ampliconduo">ampliconduo</a></code> function.
</p>
</td></tr>
<tr><td><code id="plotAmpliconduo_+3A_color.treshold">color.treshold</code></td>
<td>

<p>Optional. Numeric value specifying at which p-value or adjusted p-value points in the plot are drawn in complementary color.
Default value is 0.05.
</p>
</td></tr>
<tr><td><code id="plotAmpliconduo_+3A_xlab">xlab</code></td>
<td>

<p>Optional. Character indicating the x-axis label. Default is &ldquo;Abundance (PCR A)&rdquo;.
</p>
</td></tr>
<tr><td><code id="plotAmpliconduo_+3A_ylab">ylab</code></td>
<td>

<p>Optional. Character indicating the y-axis label. Default is &ldquo;Abundance (PCR B)&rdquo;.
</p>
</td></tr>
<tr><td><code id="plotAmpliconduo_+3A_main">main</code></td>
<td>

<p>Optional. Character specifying the overall title of the plot. If no value is passed, takes the 
sample name from the <code>x$sample</code> column.
</p>
</td></tr>
<tr><td><code id="plotAmpliconduo_+3A_log">log</code></td>
<td>

<p>Optional. Character specifying the variables to transform to log (&ldquo;&rdquo;,&ldquo;x&rdquo;, &ldquo;y&rdquo;, or &ldquo;xy&rdquo;).
Default is &ldquo;xy&rdquo;.
</p>
</td></tr>
<tr><td><code id="plotAmpliconduo_+3A_corrected">corrected</code></td>
<td>

<p>Optional. Logical to decide whether the p-value (<code>FALSE</code>), or corrected p-value (<code>TRUE</code>) is used for coloring.
Default value is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="plotAmpliconduo_+3A_asp">asp</code></td>
<td>

<p>Optional. Numeric value, the y/x aspect ratio. Default is 1.
</p>
</td></tr>
<tr><td><code id="plotAmpliconduo_+3A_legend.position">legend.position</code></td>
<td>

<p>Optional. Numeric vector of length two. Defines the position of the legend. By default tries to find a position that fits
best the arrangement of the plots.
</p>
</td></tr>
<tr><td><code id="plotAmpliconduo_+3A_save">save</code></td>
<td>

<p>Optional. Logical value indicationg if the plot should be saved to file. Default value is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="plotAmpliconduo_+3A_path">path</code></td>
<td>

<p>Optional. Character, in case the argument <code>save</code> was set to <code>TRUE</code>, specifies the directory (no backslash or slash at the end) for saving.
By default (parameter <code>save</code> is set to TRUE) the plot is saved in the working directory.
</p>
</td></tr>
<tr><td><code id="plotAmpliconduo_+3A_file.name">file.name</code></td>
<td>

<p>Optional. If  argument <code>save</code> was set to <code>TRUE</code> specifies the file name for the plot.
The default name is &ldquo;ampliconduo_&lt;date&gt;.&lt;file extension&gt;&rdquo;
</p>
</td></tr>
<tr><td><code id="plotAmpliconduo_+3A_format">format</code></td>
<td>

<p>Optional. Character specifying the format of the saved file. One of &ldquo;eps&rdquo;, &ldquo;ps&rdquo;, &ldquo;tex&rdquo;, &ldquo;pdf&rdquo;, &ldquo;jpeg&rdquo;, &ldquo;tiff&rdquo;, &ldquo;png&rdquo;, &ldquo;bmp&rdquo;, &ldquo;svg&rdquo; and &ldquo;wmf&rdquo; (windows only). Default format is &ldquo;jpeg&rdquo;.
</p>
</td></tr>
<tr><td><code id="plotAmpliconduo_+3A_h.start">h.start</code></td>
<td>

<p>Optional. Numeric value between 0 and 360 defines the color of the plotted points. 
Default value is 0 (blue-green, red). 
</p>
</td></tr>
<tr><td><code id="plotAmpliconduo_+3A_...">...</code></td>
<td>

<p>Optional. Allows to pass other aesthetics.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Anja Lange 
&amp;
Daniel Hoffmann
</p>


<h3>References</h3>

<p><a href="https://ggplot2.tidyverse.org/reference/qplot.html">https://ggplot2.tidyverse.org/reference/qplot.html</a>
</p>


<h3>See Also</h3>

<p><span class="pkg">ggplot2</span> package
</p>
<p><code><a href="ggplot2.html#topic+qplot">qplot</a></code> internally used to create the plot.
</p>
<p><code><a href="#topic+plotAmpliconduo.set">plotAmpliconduo.set</a></code>, generates a very similar plot for a list of ampliconduo data frames.
</p>
<p><code><a href="#topic+ampliconduo">ampliconduo</a></code>, generates the input data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## load example data
data(amplicons)

## extract the second ampliconduo data frame
ampliconduo2 &lt;- amplicons[[2]]

## plot the amplicon frequencies of the ampliconduo data frame 
plotAmpliconduo(ampliconduo2, main = "ampliconduo_2")
plotAmpliconduo(ampliconduo2, main = "ampliconduo_2", h.start = 50, log = "")
plotAmpliconduo(ampliconduo2, h.start = 50, log = "", asp = 2, corrected = FALSE)
</code></pre>

<hr>
<h2 id='plotAmpliconduo.set'>
Frequeny-Frequency Plot Arrangement Focusing On Significant Deviations In Amplicon Occurences
</h2><span id='topic+plotAmpliconduo.set'></span>

<h3>Description</h3>

<p>Called on the return value of the <code><a href="#topic+ampliconduo">ampliconduo</a></code> function, a list of ampliconduo data frames. Generates for each ampliconduo data frame a plot with <code>freqB</code> over <code>freqA</code> and arranges them in a 2-dimensional array, whereas plots in the same row and column share the same scale. Points with a p-value or adjusted p-value below a certain treshold are colored differently (default: red) indicating significant deviations of amplicon occurences between the two samples in an ampliconduo data frame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotAmpliconduo.set(x, color.treshold = 0.05, xlab = "Abundance (PCR A)", 
ylab = "Abundance (PCR B)",log = "xy", corrected = TRUE, asp = 1, nrow = 1,
legend.position = NULL, save = FALSE, path = NULL, file.name = NULL,
format = "jpeg", h.start = 0, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotAmpliconduo.set_+3A_x">x</code></td>
<td>

<p>List of ampliconduo data frames, return value of the <code><a href="#topic+ampliconduo">ampliconduo</a></code> function.
</p>
</td></tr>
<tr><td><code id="plotAmpliconduo.set_+3A_color.treshold">color.treshold</code></td>
<td>

<p>Optional. Numeric value specifying at which p-value or adjusted p-value points in the plot are drawn in complementary color.
Default value is 0.05.
</p>
</td></tr>
<tr><td><code id="plotAmpliconduo.set_+3A_xlab">xlab</code></td>
<td>

<p>Optional. Character indicating the x-axis label. Default is &ldquo;Abundance (PCR A)&rdquo;.
</p>
</td></tr>
<tr><td><code id="plotAmpliconduo.set_+3A_ylab">ylab</code></td>
<td>

<p>Optional. Character indicating the y-axis label. Default is &ldquo;Abundance (PCR B)&rdquo;.
</p>
</td></tr>
<tr><td><code id="plotAmpliconduo.set_+3A_log">log</code></td>
<td>

<p>Optional. Character specifying the variables to transform to log (&ldquo;&rdquo;,&ldquo;x&rdquo;, &ldquo;y&rdquo;, or &ldquo;xy&rdquo;).
Default is &ldquo;xy&rdquo;.
</p>
</td></tr>
<tr><td><code id="plotAmpliconduo.set_+3A_corrected">corrected</code></td>
<td>

<p>Optional. Logical to decide whether the p-value (<code>FALSE</code>), or corrected p-value (<code>TRUE</code>) is used for coloring.
Default value is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="plotAmpliconduo.set_+3A_asp">asp</code></td>
<td>

<p>Optional. Numeric value, the y/x aspect ratio. Default is 1.
</p>
</td></tr>
<tr><td><code id="plotAmpliconduo.set_+3A_nrow">nrow</code></td>
<td>

<p>Optional. Integer value specifying the numer of rows used to arrange the plots. Default is 1.
</p>
</td></tr>
<tr><td><code id="plotAmpliconduo.set_+3A_legend.position">legend.position</code></td>
<td>

<p>Optional. Numeric vector of length two. Defines the position of the legend. By default tries to find a position that fits
the arrangement of the plots best.
</p>
</td></tr>
<tr><td><code id="plotAmpliconduo.set_+3A_save">save</code></td>
<td>

<p>Optional. Logical value indicationg if the plot should be saved to file. Default value is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="plotAmpliconduo.set_+3A_path">path</code></td>
<td>

<p>Optional. Character, in case the argument <code>save</code> was set to <code>TRUE</code>, specifies the directory (no backslash or slash at the end) for saving.
By default (parameter <code>save</code> is set to TRUE) the plot is saved in the working directory.
</p>
</td></tr>
<tr><td><code id="plotAmpliconduo.set_+3A_file.name">file.name</code></td>
<td>

<p>Optional. If  argument <code>save</code> was set to <code>TRUE</code> specifies the file name for the plot.
The default name is &ldquo;ampliconduo_&lt;date&gt;.&lt;file extension&gt;&rdquo;
</p>
</td></tr>
<tr><td><code id="plotAmpliconduo.set_+3A_format">format</code></td>
<td>

<p>Optional. Character specifying the format of the saved file. One of &ldquo;eps&rdquo;, &ldquo;ps&rdquo;, &ldquo;tex&rdquo;, &ldquo;pdf&rdquo;, &ldquo;jpeg&rdquo;, &ldquo;tiff&rdquo;, &ldquo;png&rdquo;, &ldquo;bmp&rdquo;, &ldquo;svg&rdquo; and &ldquo;wmf&rdquo; (windows only). Default format is &ldquo;jpeg&rdquo;.
</p>
</td></tr>
<tr><td><code id="plotAmpliconduo.set_+3A_h.start">h.start</code></td>
<td>

<p>Optional. Numeric value between 0 and 360, defines the color of the plotted points. Default value is 0 (blue-green, red). 
</p>
</td></tr>
<tr><td><code id="plotAmpliconduo.set_+3A_...">...</code></td>
<td>

<p>Optional. Allows to pass other aesthetics.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generates an arrangement of plots from the return value of the <code><a href="#topic+ampliconduo">ampliconduo</a></code> function, that nicely visualizes those amplicons with a significant deviations in read numbers between the two amplicon data sets. The data in <code>x</code> are transformed and passed to the <code><a href="ggplot2.html#topic+qplot">qplot</a></code> function. The 2-dimensional arrangement of the different plots is achieved using <code><a href="ggplot2.html#topic+facet_wrap">facet_wrap</a></code>. Important aestetic parameters like color, aspect ratio, legend position ... are easily customized. Optionally, the plot can be saved in a variety of formats.
</p>


<h3>Author(s)</h3>

<p>Anja Lange 
&amp;
Daniel Hoffmann
</p>


<h3>References</h3>

<p><a href="https://ggplot2.tidyverse.org/reference/qplot.html">https://ggplot2.tidyverse.org/reference/qplot.html</a>
</p>


<h3>See Also</h3>

<p><span class="pkg">ggplot2</span> package
</p>
<p><code><a href="ggplot2.html#topic+qplot">qplot</a></code>, used by <code><a href="#topic+plotAmpliconduo.set">plotAmpliconduo.set</a></code> to create the plots.
</p>
<p><code><a href="ggplot2.html#topic+facet_wrap">facet_wrap</a></code>, called for 2-dimensional arrangement of the plots.
</p>
<p><code><a href="#topic+plotAmpliconduo">plotAmpliconduo</a></code>, generates a very similar plot for a single ampliconduo data frame.
</p>
<p><code><a href="#topic+ampliconduo">ampliconduo</a></code>, generates the input data, an ampliconduo data frame.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## loads example data of ampliconduo data frames
data(amplicons)

## plot amplicon frequencies of multiple ampliconduo data frames
plotAmpliconduo.set(amplicons[1:4], nrow = 3, h.start = 100)

plotAmpliconduo.set(amplicons[1:4], nrow = 1, corrected = FALSE, color.treshold = 0.1)
</code></pre>

<hr>
<h2 id='plotORdensity'>
Probability Density Plot Of Odds Ratios
</h2><span id='topic+plotORdensity'></span>

<h3>Description</h3>

<p>Plots for an ampliconduo data frame probability densities of the odds ratios of amplicon occurences in the two amplicon data sets.
The function allows to shift the two extrema (odds ratios OR = 0 and OR
= infinity) to the edges of the plot.
Plots of multipe ampliconduo data frames are arranged in a 2-dimensional array with shared scales.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotORdensity(x, log = "x", ncol = 2, adjust.zeroinf = TRUE, zero.pos = 0.005, 
inf.pos = 200, binwidth = 0.15, color = "black", xlab = "odds ratio", 
save = FALSE, path = NULL, file.name = NULL, format = "jpeg", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotORdensity_+3A_x">x</code></td>
<td>

<p>List or a single ampliconduo data frame, return value of the <code><a href="#topic+ampliconduo">ampliconduo</a></code> function.
</p>
</td></tr>
<tr><td><code id="plotORdensity_+3A_log">log</code></td>
<td>

<p>Optional. Character specifying the variables to transform to log (&ldquo;&rdquo;,&ldquo;x&rdquo;, &ldquo;y&rdquo;, or &ldquo;xy&rdquo;).
Default is &ldquo;x&rdquo;.
</p>
</td></tr>
<tr><td><code id="plotORdensity_+3A_ncol">ncol</code></td>
<td>

<p>Optional. Integer value specifying the numer of columns used to arrange the plots. Default is 2.
</p>
</td></tr>
<tr><td><code id="plotORdensity_+3A_adjust.zeroinf">adjust.zeroinf</code></td>
<td>

<p>Optional. Logical, specifies whether the density bar for 0 and inf should be shifted. Default value is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="plotORdensity_+3A_zero.pos">zero.pos</code></td>
<td>

<p>Optional. Numeric, in case <code>adjust.zeroinf</code> is set to <code>TRUE</code>, determines the position for the odds ratio = 0 bar.
Default value is 0.05.
</p>
</td></tr>
<tr><td><code id="plotORdensity_+3A_inf.pos">inf.pos</code></td>
<td>

<p>Optional. Numeric, in case <code>adjust.zeroinf</code> is set to <code>TRUE</code>, gives the position for the odds ratio = inf bar.
Default value is 200.
</p>
</td></tr>
<tr><td><code id="plotORdensity_+3A_binwidth">binwidth</code></td>
<td>

<p>Optional. Numeric, bin width to use, default is 0.15.
</p>
</td></tr>
<tr><td><code id="plotORdensity_+3A_color">color</code></td>
<td>

<p>Optional. Character, name of the color used to draw the density bars. Default is &ldquo;black&rdquo;.
</p>
</td></tr>
<tr><td><code id="plotORdensity_+3A_xlab">xlab</code></td>
<td>

<p>Optional. Character, label for the x-axis. Default is &ldquo;odds ratio&rdquo;.
</p>
</td></tr>
<tr><td><code id="plotORdensity_+3A_save">save</code></td>
<td>

<p>Optional. Logical, <code>TRUE</code> to save the plot, else <code>FALSE</code>. Default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="plotORdensity_+3A_path">path</code></td>
<td>

<p>Optional. Character, in case the argument <code>save</code> was set to <code>TRUE</code>, specifies the directory (no backslash or slash at the end) for saving.
By default (parameter <code>save</code> is set to TRUE) the plot is saved in the working directory.
</p>
</td></tr>
<tr><td><code id="plotORdensity_+3A_file.name">file.name</code></td>
<td>

<p>Optional. If  argument <code>save</code> was set to <code>TRUE</code> specifies the file name for the plot.
The default name is &ldquo;ampliconduo_&lt;date&gt;.&lt;file extension&gt;&rdquo;
</p>
</td></tr>
<tr><td><code id="plotORdensity_+3A_format">format</code></td>
<td>

<p>Optional. Character specifying the format of the saved file. One of &ldquo;eps&rdquo;, &ldquo;ps&rdquo;, &ldquo;tex&rdquo;, &ldquo;pdf&rdquo;, &ldquo;jpeg&rdquo;, &ldquo;tiff&rdquo;, &ldquo;png&rdquo;, &ldquo;bmp&rdquo;, &ldquo;svg&rdquo; and &ldquo;wmf&rdquo; (windows only). Default format is &ldquo;jpeg&rdquo;.
</p>
</td></tr>
<tr><td><code id="plotORdensity_+3A_...">...</code></td>
<td>

<p>Optional. Allows to pass other aesthetics.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Anja Lange 
&amp;
Daniel Hoffmann
</p>


<h3>See Also</h3>

<p><code><a href="ggplot2.html#topic+qplot">qplot</a></code>, used by <code><a href="#topic+plotAmpliconduo.set">plotAmpliconduo.set</a></code> to create the plots.
</p>
<p><code><a href="ggplot2.html#topic+facet_wrap">facet_wrap</a></code>, called for 2-dimensional arrangement of the plots.
</p>
<p><code><a href="#topic+ampliconduo">ampliconduo</a></code>, generates the input data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## loads example data of ampliconduo data frames
data(amplicons)

## plot odds ratio density for amplicon frequencies in ampliconduo data frames
plotORdensity(amplicons)
plotORdensity(amplicons[1:4], binwidth = 0.1, color = "magenta")
plotORdensity(amplicons[[1]], binwidth = 0.1, color = "orange", main = "Sample FU25")
plotORdensity(amplicons[1:4],  color = "darkblue", ncol = 2)

</code></pre>

<hr>
<h2 id='site.f'>
Sampling Site Short Names
</h2><span id='topic+site.f'></span>

<h3>Description</h3>

<p>Character vector with the names of the sampling sites, corresponding to
the names used to denote amplicon frequencies in 
the <code><a href="#topic+ampliconfreqs">ampliconfreqs</a></code> data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(site.f)</code></pre>


<h3>Format</h3>

<p>The format is:
chr [1:8] &quot;FU25&quot; &quot;FU28&quot; &quot;FU31.1&quot; &quot;FU31.2&quot; &quot;FU34&quot; &quot;FU37&quot; &quot;UniPond&quot; &quot;BogSoil&quot;
</p>


<h3>References</h3>

<p>Boenigk J, Heider D, Jost S, Lange A, Budeus B, Schilling E,
Strittmatter A, Hoffmann D: A high-throughput amplicon sequencing and
analysis protocol for comparative analyses of microbial communities
<em>(submitted)</em>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(site.f)
data(ampliconfreqs)
ampliconduo(ampliconfreqs[,1:6], sample.names = site.f[1:3])

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
