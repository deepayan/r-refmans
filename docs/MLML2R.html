<!DOCTYPE html><html><head><title>Help for package MLML2R</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MLML2R}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#C_BS_sim'><p>C (unconverted) counts from BS</p></a></li>
<li><a href='#C_OxBS_sim'><p>C (unconverted) counts from oxBS</p></a></li>
<li><a href='#C_TAB_sim'><p>C (unconverted) counts from TAB</p></a></li>
<li><a href='#MLML'><p>MLE (maximum likelihood estimates) of 5-mC and 5-hmC levels.</p></a></li>
<li><a href='#T_BS_sim'><p>T (converted) counts from BS</p></a></li>
<li><a href='#T_OxBS_sim'><p>T (converted) counts from oxBS</p></a></li>
<li><a href='#T_TAB_sim'><p>T (converted) counts from TAB</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Maximum Likelihood Estimation of DNA Methylation and
Hydroxymethylation Proportions</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.3</td>
</tr>
<tr>
<td>Author:</td>
<td>Samara Kiihl [aut, cre],
  Maria Jose Martinez-Garrido [aut],
  Arce Domingo-Relloso [aut],
  Jose Bermudez [aut],
  Maria Tellez-Plaza [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Samara Kiihl &lt;samara@ime.unicamp.br&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Maximum likelihood estimates (MLE) of the proportions
    of 5-mC and 5-hmC in the DNA using information from BS-conversion,
    TAB-conversion, and oxBS-conversion methods. One can use information from all three methods 
    or any combination of two of them. Estimates are based on Binomial model by
    Qu et al. (2013) &lt;<a href="https://doi.org/10.1093%2Fbioinformatics%2Fbtt459">doi:10.1093/bioinformatics/btt459</a>&gt; and
    Kiihl et al. (2019) &lt;<a href="https://doi.org/10.1515%2Fsagmb-2018-0031">doi:10.1515/sagmb-2018-0031</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>biocViews:</td>
<td>Software, MethylationArray, Epigenetics, DNAMethylation,
Microarray, TwoChannel, OneChannel</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/samarafk/MLML2R">https://github.com/samarafk/MLML2R</a></td>
</tr>
<tr>
<td>Suggests:</td>
<td>minfi, microbenchmark, GEOquery, knitr, rmarkdown,
IlluminaHumanMethylation450kmanifest</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/samarafk/MLML2R/issues">https://github.com/samarafk/MLML2R/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-10-17 10:14:34 UTC; sfk</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-10-17 19:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='C_BS_sim'>C (unconverted) counts from BS</h2><span id='topic+C_BS_sim'></span>

<h3>Description</h3>

<p>A matrix of simulated counts corresponding to 100 CpGs and 2 samples.
True proportions of methylation, hydroxymethylation and unmethylated
used in the simulation are .3, .2, and .5, respectively.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>C_BS_sim
</code></pre>


<h3>Format</h3>

<p>100 x 2 matrix (CpGs in the rows and  Samples in the columns).</p>

<hr>
<h2 id='C_OxBS_sim'>C (unconverted) counts from oxBS</h2><span id='topic+C_OxBS_sim'></span>

<h3>Description</h3>

<p>A matrix of simulated counts corresponding to 100 CpGs and 2 samples.
True proportions of methylation, hydroxymethylation and unmethylated
used in the simulation are .3, .2, and .5, respectively.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>C_OxBS_sim
</code></pre>


<h3>Format</h3>

<p>100 x 2 matrix (CpGs in the rows and  Samples in the columns).</p>

<hr>
<h2 id='C_TAB_sim'>C (unconverted) counts from TAB</h2><span id='topic+C_TAB_sim'></span>

<h3>Description</h3>

<p>A matrix of simulated counts corresponding to 100 CpGs and 2 samples.
True proportions of methylation, hydroxymethylation and unmethylated
used in the simulation are .3, .2, and .5, respectively.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>C_TAB_sim
</code></pre>


<h3>Format</h3>

<p>100 x 2 matrix (CpGs in the rows and  Samples in the columns).</p>

<hr>
<h2 id='MLML'>MLE (maximum likelihood estimates) of 5-mC and 5-hmC levels.</h2><span id='topic+MLML'></span>

<h3>Description</h3>

<p>MLE (maximum likelihood estimates) of 5-mC and 5-hmC levels.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MLML(U.matrix = NULL, T.matrix = NULL, G.matrix = NULL,
  H.matrix = NULL, L.matrix = NULL, M.matrix = NULL,
  iterative = FALSE, tol = 1e-05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MLML_+3A_u.matrix">U.matrix</code></td>
<td>
<p>Converted cytosines (T counts or U channel) from standard BS-conversion (True 5-C).</p>
</td></tr>
<tr><td><code id="MLML_+3A_t.matrix">T.matrix</code></td>
<td>
<p>Unconverted cytosines (C counts or M channel) from standard BS-conversion (reflecting 5-mC+5-hmC).</p>
</td></tr>
<tr><td><code id="MLML_+3A_g.matrix">G.matrix</code></td>
<td>
<p>Converted cytosines (T counts or U channel) from TAB-conversion (reflecting 5-C + 5-mC).</p>
</td></tr>
<tr><td><code id="MLML_+3A_h.matrix">H.matrix</code></td>
<td>
<p>Unconverted cytosines (C counts or M channel) from TAB-conversion(reflecting True 5-hmC).</p>
</td></tr>
<tr><td><code id="MLML_+3A_l.matrix">L.matrix</code></td>
<td>
<p>Converted cytosines (T counts or U channel) from oxBS-conversion (reflecting 5-C + 5-hmC).</p>
</td></tr>
<tr><td><code id="MLML_+3A_m.matrix">M.matrix</code></td>
<td>
<p>Unconverted cytosines (C counts or M channel) from oxBS-conversion (reflecting True 5-mC).</p>
</td></tr>
<tr><td><code id="MLML_+3A_iterative">iterative</code></td>
<td>
<p>logical. If iterative=TRUE EM-algorithm is used. For the combination of
two methods, iterative=FALSE returns the exact constrained MLE using the
pool-adjacent-violators algorithm (PAVA). When all three methods are combined,
iterative=FALSE returns the constrained MLE using Lagrange multiplier.</p>
</td></tr>
<tr><td><code id="MLML_+3A_tol">tol</code></td>
<td>
<p>convergence tolerance; considered only if iterative=TRUE</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function returns MLE estimates (binomial model assumed).
The function assumes that the order of the rows and columns in the input matrices
are consistent. In addition, all the input matrices must have the same dimension.
Usually, rows represent CpG loci and columns are the samples.
</p>


<h3>Value</h3>

<p>The returned value is a list with the following components.
</p>
<table>
<tr><td><code>mC</code></td>
<td>
<p>maximum likelihood estimate for the proportion of methylation.</p>
</td></tr>
<tr><td><code>hmC</code></td>
<td>
<p>maximum likelihood estimate for the proportion of hydroxymethylation.</p>
</td></tr>
<tr><td><code>C</code></td>
<td>
<p>maximum likelihood estimate for the proportion of unmethylation.</p>
</td></tr>
<tr><td><code>methods</code></td>
<td>
<p>the conversion methods used to produce the MLE</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Samara Kiihl samara@ime.unicamp.br;
Maria Jose Garrido;
Arce Domingo-Relloso;
Jose Bermudez;
Maria Tellez-Plaza.
</p>


<h3>References</h3>

<p>Kiihl SF, Martinez-Garrido MJ, Domingo-Relloso A, Bermudez J, Tellez-Plaza M. MLML2R: an
R package for maximum likelihood estimation of DNA methylation and hydroxymethylation
proportions. Statistical Applications in Genetics and Molecular Biology. 2019;18(1).
doi:10.1515/sagmb-2018-0031.
</p>
<p>Qu J, Zhou M, Song Q, Hong EE, Smith AD. MLML: consistent simultaneous estimates of
DNA methylation and hydroxymethylation. Bioinformatics. 2013;29(20):2645-2646.
doi:10.1093/bioinformatics/btt459.
</p>
<p>Ayer M, Brunk HD, Ewing GM, Reid WT, Silverman E. An Empirical Distribution Function
for Sampling with Incomplete Information. Ann. Math. Statist. 1955, 26(4), 641-647.
doi:10.1214/aoms/1177728423.
</p>
<p>Zongli Xu, Jack A. Taylor, Yuet-Kin Leung, Shuk-Mei Ho, Liang Niu;
oxBS-MLE: an efficient method to estimate 5-methylcytosine and 5-hydroxymethylcytosine
in paired bisulfite and oxidative bisulfite treated DNA,
Bioinformatics, 2016;32(23):3667-3669.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load the example datasets from BS, oxBS and TAB methods
data(C_BS_sim)
data(C_OxBS_sim)
data(T_BS_sim)
data(T_OxBS_sim)
data(C_TAB_sim)
data(T_TAB_sim)

# obtain MLE via EM-algorithm for BS+oxBS:
results_em &lt;- MLML(T.matrix = C_BS_sim , U.matrix = T_BS_sim,
L.matrix = T_OxBS_sim, M.matrix = C_OxBS_sim,iterative=TRUE)

# obtain constrained exact MLE for BS+oxBS:
results_exact &lt;- MLML(T.matrix = C_BS_sim , U.matrix = T_BS_sim,
L.matrix = T_OxBS_sim, M.matrix = C_OxBS_sim)

# obtain MLE via EM-algorithm for BS+TAB:
results_em &lt;- MLML(T.matrix = C_BS_sim , U.matrix = T_BS_sim,
G.matrix = T_TAB_sim, H.matrix = C_TAB_sim,iterative=TRUE)

# obtain constrained exact MLE for BS+TAB:
results_exact &lt;- MLML(T.matrix = C_BS_sim , U.matrix = T_BS_sim,
G.matrix = T_TAB_sim, H.matrix = C_TAB_sim)

# obtain MLE via EM-algorithm for oxBS+TAB:
results_em &lt;- MLML(L.matrix = T_OxBS_sim, M.matrix = C_OxBS_sim,
G.matrix = T_TAB_sim, H.matrix = C_TAB_sim,iterative=TRUE)

# obtain constrained exact MLE for oxBS+TAB:
results_exact &lt;- MLML(L.matrix = T_OxBS_sim, M.matrix = C_OxBS_sim,
G.matrix = T_TAB_sim, H.matrix = C_TAB_sim)

# obtain MLE via EM-algorithm for BS+oxBS+TAB:
results_em &lt;- MLML(T.matrix = C_BS_sim , U.matrix = T_BS_sim,
L.matrix = T_OxBS_sim, M.matrix = C_OxBS_sim,
G.matrix = T_TAB_sim, H.matrix = C_TAB_sim,iterative=TRUE)

#' # obtain MLE via Lagrange multiplier for BS+oxBS+TAB:
results_exact &lt;- MLML(T.matrix = C_BS_sim , U.matrix = T_BS_sim,
L.matrix = T_OxBS_sim, M.matrix = C_OxBS_sim,
G.matrix = T_TAB_sim, H.matrix = C_TAB_sim)


# Example of datasets with zero counts and missing values:

C_BS_sim[1,1] &lt;- 0
C_OxBS_sim[1,1] &lt;- 0
C_TAB_sim[1,1] &lt;- 0
T_BS_sim[1,1] &lt;- 0
T_OxBS_sim[1,1] &lt;- 0
T_TAB_sim[1,1] &lt;- 0

C_BS_sim[2,2] &lt;- NA
C_OxBS_sim[2,2] &lt;- NA
C_TAB_sim[2,2] &lt;- NA
T_BS_sim[2,2] &lt;- NA
T_OxBS_sim[2,2] &lt;- NA
T_TAB_sim[2,2] &lt;- NA



</code></pre>

<hr>
<h2 id='T_BS_sim'>T (converted) counts from BS</h2><span id='topic+T_BS_sim'></span>

<h3>Description</h3>

<p>A matrix of simulated counts corresponding to 100 CpGs and 2 samples.
True proportions of methylation, hydroxymethylation and unmethylated
used in the simulation are .3, .2, and .5, respectively.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>T_BS_sim
</code></pre>


<h3>Format</h3>

<p>100 x 2 matrix (CpGs in the rows and  Samples in the columns).</p>

<hr>
<h2 id='T_OxBS_sim'>T (converted) counts from oxBS</h2><span id='topic+T_OxBS_sim'></span>

<h3>Description</h3>

<p>A matrix of simulated counts corresponding to 100 CpGs and 2 samples.
True proportions of methylation, hydroxymethylation and unmethylated
used in the simulation are .3, .2, and .5, respectively.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>T_OxBS_sim
</code></pre>


<h3>Format</h3>

<p>100 x 2 matrix (CpGs in the rows and  Samples in the columns).</p>

<hr>
<h2 id='T_TAB_sim'>T (converted) counts from TAB</h2><span id='topic+T_TAB_sim'></span>

<h3>Description</h3>

<p>A matrix of simulated counts corresponding to 100 CpGs and 2 samples.
True proportions of methylation, hydroxymethylation and unmethylated
used in the simulation are .3, .2, and .5, respectively.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>T_TAB_sim
</code></pre>


<h3>Format</h3>

<p>100 x 2 matrix (CpGs in the rows and  Samples in the columns).</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
