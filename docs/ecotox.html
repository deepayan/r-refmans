<!DOCTYPE html><html><head><title>Help for package ecotox</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ecotox}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#lamprey_time'><p>Lethal time data for seasonal exposure to TFM for larval sea lamprey</p></a></li>
<li><a href='#lamprey_tox'><p>Lethal concentration data for seasonal exposure to TFM for larval sea lamprey</p></a></li>
<li><a href='#LC_logit'><p>Lethal Concentration Logit</p></a></li>
<li><a href='#LC_probit'><p>Lethal Concentration Probit</p></a></li>
<li><a href='#LT_logit'><p>Lethal Time Logit</p></a></li>
<li><a href='#LT_probit'><p>Lethal Time Probit</p></a></li>
<li><a href='#ratio_test'><p>Ratio test</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Analysis of Ecotoxicology</td>
</tr>
<tr>
<td>Version:</td>
<td>1.4.4</td>
</tr>
<tr>
<td>Description:</td>
<td>A simple approach to using a probit or logit analysis to calculate
        lethal concentration (LC) or time (LT) and the appropriate fiducial 
        confidence limits desired for selected LC or LT for
        ecotoxicology studies (Finney 1971; Wheeler et al. 2006; 
        Robertson et al. 2007). The simplicity of 'ecotox' comes from the 
        syntax it implies within its functions which are similar to functions 
        like glm() and lm(). In addition to the simplicity of the syntax, 
        a comprehensive data frame is produced which gives the user a 
        predicted LC or LT value for the desired level and a suite of important 
        parameters such as fiducial confidence limits and slope.   
        Finney, D.J. (1971, ISBN: 052108041X);
        Wheeler, M.W., Park, R.M., and Bailer, A.J. (2006) &lt;<a href="https://doi.org/10.1897%2F05-320R.1">doi:10.1897/05-320R.1</a>&gt;;
        Robertson, J.L., Savin, N.E., Russell, R.M., and Preisler, H.K.
        (2007, ISBN: 0849323312).</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.3.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, tibble</td>
</tr>
<tr>
<td>Suggests:</td>
<td>covr, data.table, dplyr, ggplot2, Hmisc, openxlsx, readr,
testthat, tidyr</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> | file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2.9000</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-10-27 15:56:26 UTC; benja</td>
</tr>
<tr>
<td>Author:</td>
<td>Benjamin L Hlina [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Benjamin L Hlina &lt;benjamin.hlina@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-10-27 16:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='lamprey_time'>Lethal time data for seasonal exposure to TFM for larval sea lamprey</h2><span id='topic+lamprey_time'></span>

<h3>Description</h3>

<p>This dataset contains the amount of responding/dead lamprey from 1 to 12 h of exposure to the piscicide, 3-trifluoromethyl-4-nitrophenol (TFM), for the calculated LC50s at each month for the 2011 seasonal larval sea lamprey TFM toxicity data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lamprey_time
</code></pre>


<h3>Format</h3>

<p>A tibble containing 44 rows and 7 columns.
</p>

<dl>
<dt>nominal.dose</dt><dd><p>nominal TFM dose(mg/L)</p>
</dd>
<dt>dose</dt><dd><p>averaged measured TFM dose (mg/L) over 12 h of exposures</p>
</dd>
<dt>month</dt><dd><p>month in which toxicity test occurred</p>
</dd>
<dt>hour</dt><dd><p>duration of exposure in hours</p>
</dd>
<dt>response</dt><dd><p>number of lamprey that responded over 12 h exposure to TFM</p>
</dd>
<dt>survive</dt><dd><p>number of lamprey that survived over 12 h exposure to TFM</p>
</dd>
<dt>total</dt><dd><p>total number of lamprey that were exposed to TFM over 12 h</p>
</dd>
</dl>



<h3>Details</h3>

<p>For each month, new lamprey were collected from the deer creek, MI, and were randomly assigned to a tank for exposure to the piscicide, 3-trifluoromethyl-4-nitrophenol (TFM). The LC50 at each month was then calculated and the amount of responding/dead lamprey from 1 to 12 h was recorded.
</p>


<h3>Source</h3>

<p>Hlina, B.L., Birceanu, O., Robinson, C.S., Dhiyebi, H., Wilkie, M.P. <em>In Reivew</em>. Seasonal Variation in the Sensitivity of Invasive Sea Lampreys to the Lampricide TFM: Importance of Energy Reserves and Temperature. North American Journal of Fisheries Management
</p>

<hr>
<h2 id='lamprey_tox'>Lethal concentration data for seasonal exposure to TFM for larval sea lamprey</h2><span id='topic+lamprey_tox'></span>

<h3>Description</h3>

<p>This dataset contains 2011 seasonal larval sea lamprey exposed to the piscicide, 3-trifluoromethyl-4-nitrophenol (TFM) toxicity data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lamprey_tox
</code></pre>


<h3>Format</h3>

<p>A tibble containing 64 rows and 7 columns.
</p>

<dl>
<dt>nominal_dose</dt><dd><p>nominal TFM dose (mg/L)</p>
</dd>
<dt>tank</dt><dd><p>tank assignment</p>
</dd>
<dt>month</dt><dd><p>month in which toxicity test occurred</p>
</dd>
<dt>dose</dt><dd><p>averaged measured TFM dose (mg/L) over 12 h of exposure</p>
</dd>
<dt>response</dt><dd><p>number of lamprey that responded over 12 h exposure to TFM</p>
</dd>
<dt>survive</dt><dd><p>number of lamprey that survived over 12 h exposure to TFM</p>
</dd>
<dt>total</dt><dd><p>total number of lamprey that were exposed to TFM over 12 h</p>
</dd>
</dl>



<h3>Details</h3>

<p>For each month, new lamprey were collected from the Deer Creek, MI, and were randomly assigned to a tank for exposure to varying doses of the piscicide, 3-trifluoromethyl-4-nitrophenol (TFM).
</p>


<h3>Source</h3>

<p>Hlina, B.L., Birceanu, O., Robinson, C.S., Dhiyebi, H., Wilkie, M.P. <em>In Reivew</em>. Seasonal Variation in the Sensitivity of Invasive Sea Lampreys to the Lampricide TFM: Importance of Energy Reserves and Temperature. North American Journal of Fisheries Management
</p>

<hr>
<h2 id='LC_logit'>Lethal Concentration Logit</h2><span id='topic+LC_logit'></span>

<h3>Description</h3>

<p>Calculates lethal concentration (LC) and
its fiducial confidence limits (CL) using a logit analysis
according to Finney 1971, Wheeler et al. 2006, and Robertson et al. 2007.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LC_logit(formula, data, p = NULL, weights = NULL,
         subset = NULL, log_base = NULL,
         log_x = TRUE, het_sig = NULL,
         conf_level = NULL, conf_type = NULL,
         long_output = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LC_logit_+3A_formula">formula</code></td>
<td>
<p>an object of class <code>formula</code> or one that can be coerced to that class): a symbolic description of the model to be fitted. The details of model specification are given under Details.</p>
</td></tr>
<tr><td><code id="LC_logit_+3A_data">data</code></td>
<td>
<p>an optional data frame, list or environment (or object coercible by as.data.frame to a data frame) containing the variables in the model. If not found in data, the variables are taken from environment(formula), typically the environment from which <code>LC_logit</code> is called.</p>
</td></tr>
<tr><td><code id="LC_logit_+3A_p">p</code></td>
<td>
<p>Lethal Concentration (LC) values for given p, example will return a LC50 value if p equals 50. If more than one LC value wanted specify by creating a vector. LC values can be calculated down to the 1e-16 of a percentage (e.g. LC99.99). However, the tibble produced can round to nearest whole number.</p>
</td></tr>
<tr><td><code id="LC_logit_+3A_weights">weights</code></td>
<td>
<p>vector of 'prior weights' to be used in the fitting process. Only needs to be supplied if you are taking the response / total for your response variable within the formula call of <code>LC_probit</code>. Otherwise if you use cbind(response, non-response) method you do not need to supply weights. If you do the model will be incorrect. If you don't supply weights there is a warning that will help you to make sure you are using one method or the other.See the following StackExchange post about differences <a href="https://stats.stackexchange.com/questions/259502/in-using-the-cbind-function-in-r-for-a-logistic-regression-on-a-2-times-2-t">cbind() function in R for a logistic regression</a>.</p>
</td></tr>
<tr><td><code id="LC_logit_+3A_subset">subset</code></td>
<td>
<p>allows for the data to be subseted if desired. Default set to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="LC_logit_+3A_log_base">log_base</code></td>
<td>
<p>default is <code>10</code> and will be used to  calculate results using the anti of <code>log10()</code> given that the x variable has been <code>log10</code> transformed. If <code>FALSE</code> results will not be back transformed.</p>
</td></tr>
<tr><td><code id="LC_logit_+3A_log_x">log_x</code></td>
<td>
<p>default is <code>TRUE</code> and will calculate results using the antilog of determined by <code>log_base</code> given that the x variable has been <code>log()</code> transformed. If <code>FALSE</code> results will not be back transformed.</p>
</td></tr>
<tr><td><code id="LC_logit_+3A_het_sig">het_sig</code></td>
<td>
<p>significance level from person's chi square goodness-of-fit test that is used to decide if a heterogeneity factor is used. <code>NULL</code> is set to 0.15.</p>
</td></tr>
<tr><td><code id="LC_logit_+3A_conf_level">conf_level</code></td>
<td>
<p>adjust confidence level as necessary or <code>NULL</code> set at 0.95.</p>
</td></tr>
<tr><td><code id="LC_logit_+3A_conf_type">conf_type</code></td>
<td>
<p>default is <code>"fl"</code> which will calculate fudicial confidence limits per Finney 1971. If set to <code>"dm"</code> the delta method will be used instead.</p>
</td></tr>
<tr><td><code id="LC_logit_+3A_long_output">long_output</code></td>
<td>
<p>default is <code>TRUE</code> which will return a tibble with all 17 variables. If <code>FALSE</code> the tibble returned will consist of the p level, n, the predicted LC for given p level, lower and upper confidence limits.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a tibble with predicted LC for given p level, lower CL (LCL), upper CL (UCL), Pearson's chi square goodness-of-fit test (pgof), slope, intercept, slope and intercept p values and standard error, and LC variance.
</p>


<h3>References</h3>

<p>Finney, D.J., 1971. Probit Analysis, Cambridge University Press, Cambridge, England, ISBN: 052108041X
</p>
<p>Wheeler, M.W., Park, R.M., and Bailey, A.J., 2006. Comparing median lethal concentration values using confidence interval overlap or ratio tests, Environ. Toxic. Chem. 25(5), 1441-1444.10.1897/05-320R.1
</p>
<p>Robertson, J.L., Savin, N.E., Russell, R.M. and Preisler, H.K., 2007. Bioassays with arthropods. CRC press. ISBN: 9780849323317
</p>


<h3>Examples</h3>

<pre><code class='language-R'>head(lamprey_tox)

# within the dataframe used, control dose, unless produced a value
# during experimentation, are removed from the dataframe,
# as glm cannot handle values of infinite. Other statistical programs
# make note of the control dose but do not include within analysis


# calculate LC50 and LC99 for May

m &lt;- LC_logit((response / total) ~ log10(dose), p = c(50, 99),
         weights = total,
         data = lamprey_tox[lamprey_tox$nominal_dose != 0, ],
         subset = c(month == "May"))


# OR

m1 &lt;- LC_logit(cbind(response, survive) ~ log10(dose), p = c(50, 99),
               data = lamprey_tox[lamprey_tox$nominal_dose != 0, ],
               subset = c(month == "May"))


# view calculated LC50 and LC99 for seasonal toxicity of a pisicide,
# to lamprey in 2011

m

# they are the same

m1

# dose-response curve can be plotted using 'ggplot2'
# Uncomment the below lines to run create plots

# library(ggplot2)

# lc_may &lt;- subset(lamprey_tox, month %in% c("May"))

# p1 &lt;- ggplot(data = lc_may[lc_may$nominal_dose != 0, ],
#              aes(x = log10(dose), y = (response / total))) +
# geom_point() +
# geom_smooth(method = "glm",
#             method.args = list(family = binomial(link = "logit")),
#             aes(weight = total), colour = "#FF0000", se = TRUE)

# p1

# calculate LC50s and LC99s for multiple toxicity tests, June, August, and September

j &lt;- LC_logit((response / total) ~ log10(dose), p = c(50, 99),
        weights = total,
        data = lamprey_tox[lamprey_tox$nominal_dose != 0, ],
        subset = c(month == "June"))

a &lt;- LC_logit((response / total) ~ log10(dose), p = c(50, 99),
        weights = total,
        data = lamprey_tox[lamprey_tox$nominal_dose != 0, ],
        subset = c(month == "August"))

s &lt;- LC_logit((response / total) ~ log10(dose), p = c(50, 99),
        weights = total,
        data = lamprey_tox[lamprey_tox$nominal_dose != 0, ],
        subset = c(month == "September"))

# group results together in a dataframe to plot with 'ggplot2'

results &lt;- rbind(m[, c(1, 3:8, 11)], j[,c(1, 3:8, 11)],
                 a[, c(1, 3:8, 11)], s[, c(1, 3:8, 11)])
results$month &lt;- factor(c(rep("May", 2), rep("June", 2),
                          rep("August", 2), rep("September", 2)),
                        levels = c("May", "June", "August", "September"))


# p2 &lt;- ggplot(data = results, aes(x = month, y = dose,
#                              group = factor(p), fill = factor(p))) +
#   geom_col(position = position_dodge(width = 0.9), colour = "#000000") +
#   geom_errorbar(aes(ymin = LCL, ymax = UCL),
#                 size = 0.4, width = 0.06,
#                 position = position_dodge(width = 0.9))

# p2
</code></pre>

<hr>
<h2 id='LC_probit'>Lethal Concentration Probit</h2><span id='topic+LC_probit'></span>

<h3>Description</h3>

<p>Calculates lethal concentration (LC) and
its fiducial confidence limits (CL) using a probit analysis
according to Finney 1971, Wheeler et al. 2006, and Robertson et al. 2007.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LC_probit(formula, data, p = NULL, weights = NULL,
          subset = NULL, log_base = NULL, log_x = TRUE,
          het_sig = NULL, conf_level = NULL, conf_type = NULL,
          long_output = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LC_probit_+3A_formula">formula</code></td>
<td>
<p>an object of class <code>formula</code> or one that can be coerced to that class): a symbolic description of the model to be fitted. The details of model specification are given under Details.</p>
</td></tr>
<tr><td><code id="LC_probit_+3A_data">data</code></td>
<td>
<p>an optional data frame, list or environment (or object coercible by as.data.frame to a data frame) containing the variables in the model. If not found in data, the variables are taken from environment(formula), typically the environment from which <code>LC_probit</code> is called.</p>
</td></tr>
<tr><td><code id="LC_probit_+3A_p">p</code></td>
<td>
<p>Lethal Concentration (LC) values for given p, example will return a LC50 value if p equals 50. If more than one LC value wanted specify by creating a vector. LC values can be calculated down to the 1e-16 of a percentage (e.g. LC99.99). However, the tibble produced can round to nearest whole number.</p>
</td></tr>
<tr><td><code id="LC_probit_+3A_weights">weights</code></td>
<td>
<p>vector of 'prior weights' to be used in the fitting process. Only needs to be supplied if you are taking the response / total for your response variable within the formula call of <code>LC_probit</code>. Otherwise if you use cbind(response, non-response) method you do not need to supply weights. If you do the model will be incorrect. If you don't supply weights there is a warning that will help you to make sure you are using one method or the other. See the following StackExchanges post about differences <a href="https://stats.stackexchange.com/questions/259502/in-using-the-cbind-function-in-r-for-a-logistic-regression-on-a-2-times-2-t">cbind() function in R for a logistic regression</a> and <a href="https://stats.stackexchange.com/questions/322038/input-format-for-response-in-binomial-glm-in-r">input format for binomial glm</a>.</p>
</td></tr>
<tr><td><code id="LC_probit_+3A_subset">subset</code></td>
<td>
<p>allows for the data to be subseted if desired. Default set to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="LC_probit_+3A_log_base">log_base</code></td>
<td>
<p>default is <code>10</code> and will be used to  calculate results using the anti of <code>log10()</code> given that the x variable has been <code>log10</code> transformed. If <code>FALSE</code> results will not be back transformed.</p>
</td></tr>
<tr><td><code id="LC_probit_+3A_log_x">log_x</code></td>
<td>
<p>default is <code>TRUE</code> and will calculate results using the antilog of determined by <code>log_base</code> given that the x variable has been <code>log()</code> transformed. If <code>FALSE</code> results will not be back transformed.</p>
</td></tr>
<tr><td><code id="LC_probit_+3A_het_sig">het_sig</code></td>
<td>
<p>significance level from person's chi square goodness-of-fit test (pgof) that is used to decide if a heterogeneity factor is used. <code>NULL</code> is set to 0.15.</p>
</td></tr>
<tr><td><code id="LC_probit_+3A_conf_level">conf_level</code></td>
<td>
<p>adjust confidence level as necessary or <code>NULL</code> set at 0.95.</p>
</td></tr>
<tr><td><code id="LC_probit_+3A_conf_type">conf_type</code></td>
<td>
<p>default is <code>"fl"</code> which will calculate fudicial confidence limits per Finney 1971. If set to <code>"dm"</code> the delta method will be used instead.</p>
</td></tr>
<tr><td><code id="LC_probit_+3A_long_output">long_output</code></td>
<td>
<p>default is <code>TRUE</code> which will return a tibble with all 17 variables. If <code>FALSE</code> the tibble returned will consist of the p level, n, the predicted LC for given p level, lower and upper confidence limits.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a tibble with predicted LC for given p level, lower CL (LCL), upper CL (UCL), Pearson's chi square goodness-of-fit test (pgof), slope, intercept, slope and intercept p values and standard error, and LC variance.
</p>


<h3>References</h3>

<p>Finney, D.J., 1971. Probit Analysis, Cambridge University Press, Cambridge, England, ISBN: 052108041X
</p>
<p>Wheeler, M.W., Park, R.M., and Bailey, A.J., 2006. Comparing median lethal concentration values using confidence interval overlap or ratio tests, Environ. Toxic. Chem. 25(5), 1441-1444.10.1897/05-320R.1
</p>
<p>Robertson, J.L., Savin, N.E., Russell, R.M. and Preisler, H.K., 2007. Bioassays with arthropods. CRC press. ISBN: 9780849323317
</p>


<h3>Examples</h3>

<pre><code class='language-R'>head(lamprey_tox)

# within the dataframe used, control dose, unless produced a value
# during experimentation, are removed from the dataframe,
# as glm cannot handle values of infinite. Other statistical programs
# make note of the control dose but do not include within analysis

# calculate LC50 and LC99

m &lt;- LC_probit((response / total) ~ log10(dose), p = c(50, 99),
               weights = total,
               data = lamprey_tox[lamprey_tox$nominal_dose != 0, ],
               subset = c(month == "May"))
# OR

m1 &lt;- LC_probit(cbind(response, survive) ~ log10(dose), p = c(50, 99),
               data = lamprey_tox[lamprey_tox$nominal_dose != 0, ],
               subset = c(month == "May"))

# view calculated LC50 and LC99 for seasonal toxicity of a pisicide,
# to lamprey in 2011

m

# these are the same

m1

# dose-response curve can be plotted using 'ggplot2'

# library(ggplot2)

# lc_may &lt;- subset(lamprey_tox, month %in% c("May"))

# p1 &lt;- ggplot(data = lc_may[lc_may$nominal_dose != 0, ],
#              aes(x = log10(dose), y = (response / total))) +
#   geom_point() +
#   geom_smooth(method = "glm",
#               method.args = list(family = binomial(link = "probit")),
#               aes(weight = total), colour = "#FF0000", se = TRUE)

# p1

# calculate LC50s and LC99s for multiple toxicity tests, June, August, and September

j &lt;- LC_probit((response / total) ~ log10(dose), p = c(50, 99),
        weights = total,
        data = lamprey_tox[lamprey_tox$nominal_dose != 0, ],
        subset = c(month == "June"))

a &lt;- LC_probit((response / total) ~ log10(dose), p = c(50, 99),
        weights = total,
        data = lamprey_tox[lamprey_tox$nominal_dose != 0, ],
        subset = c(month == "August"))

s &lt;- LC_probit((response / total) ~ log10(dose), p = c(50, 99),
        weights = total,
        data = lamprey_tox[lamprey_tox$nominal_dose != 0, ],
        subset = c(month == "September"))

# group results together in a dataframe to plot with 'ggplot2'

results &lt;- rbind(m[, c(1, 3:8, 11)], j[,c(1, 3:8, 11)],
                 a[, c(1, 3:8, 11)], s[, c(1, 3:8, 11)])
results$month &lt;- factor(c(rep("May", 2), rep("June", 2),
                          rep("August", 2), rep("September", 2)),
                        levels = c("May", "June", "August", "September"))

# p2 &lt;- ggplot(data = results, aes(x = month, y = dose,
#                              group = factor(p), fill = factor(p))) +
#   geom_col(position = position_dodge(width = 0.9), colour = "#000000") +
#   geom_errorbar(aes(ymin = LCL, ymax = UCL),
#                 size = 0.4, width = 0.06,
#                 position = position_dodge(width = 0.9))

# p2
</code></pre>

<hr>
<h2 id='LT_logit'>Lethal Time Logit</h2><span id='topic+LT_logit'></span>

<h3>Description</h3>

<p>Calculates lethal time (LT) and
its fiducial confidence limits (CL) using a logit analysis
according to Finney 1971, Wheeler et al. 2006, and Robertson et al. 2007.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LT_logit(formula, data, p = NULL, weights = NULL,
          subset = NULL, log_base = NULL, log_x = TRUE, het_sig = NULL,
          conf_level = NULL, long_output = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LT_logit_+3A_formula">formula</code></td>
<td>
<p>an object of class <code>formula</code> or one that can be coerced to that class: a symbolic description of the model to be fitted.</p>
</td></tr>
<tr><td><code id="LT_logit_+3A_data">data</code></td>
<td>
<p>an optional data frame, list or environment (or object coercible by as.data.frame to a data frame) containing the variables in the model. If not found in data, the variables are taken from environment(formula), typically the environment from which <code>LT_logit</code> is called.</p>
</td></tr>
<tr><td><code id="LT_logit_+3A_p">p</code></td>
<td>
<p>Lethal time (LT) values for given p, example will return a LT50 value if p equals 50. If more than one LT value wanted specify by creating a vector. LT values can be calculated down to the 1e-16 of a percentage (e.g. LT99.99).However, the tibble produced can and will round to nearest whole number.</p>
</td></tr>
<tr><td><code id="LT_logit_+3A_weights">weights</code></td>
<td>
<p>vector of 'prior weights' to be used in the fitting process. Only needs to be supplied if you are taking the response / total for your response variable within the formula call of <code>LC_probit</code>. Otherwise if you use cbind(response, non-response) method you do not need to supply weights. If you do the model will be incorrect. If you don't supply weights there is a warning that will help you to make sure you are using one method or the other. See the following StackExchange post about differences <a href="https://stats.stackexchange.com/questions/259502/in-using-the-cbind-function-in-r-for-a-logistic-regression-on-a-2-times-2-t">cbind() function in R for a logistic regression</a>.</p>
</td></tr>
<tr><td><code id="LT_logit_+3A_subset">subset</code></td>
<td>
<p>allows for the data to be subseted if desired. Default set to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="LT_logit_+3A_log_base">log_base</code></td>
<td>
<p>default is <code>10</code> and will be used to  calculate results using the anti of <code>log10()</code> given that the x variable has been <code>log10</code> transformed. If <code>FALSE</code> results will not be back transformed.</p>
</td></tr>
<tr><td><code id="LT_logit_+3A_log_x">log_x</code></td>
<td>
<p>default is <code>TRUE</code> and will calculate results using the antilog of determined by <code>log_base</code> given that the x variable has been <code>log()</code> transformed. If <code>FALSE</code> results will not be back transformed.</p>
</td></tr>
<tr><td><code id="LT_logit_+3A_het_sig">het_sig</code></td>
<td>
<p>significance level from person's chi square goodness-of-fit test that is used to decide if a heterogeneity factor is used. <code>NULL</code> is set to 0.15.</p>
</td></tr>
<tr><td><code id="LT_logit_+3A_conf_level">conf_level</code></td>
<td>
<p>Adjust confidence level as necessary or <code>NULL</code> set at 0.95.</p>
</td></tr>
<tr><td><code id="LT_logit_+3A_long_output">long_output</code></td>
<td>
<p>default is <code>TRUE</code> which will return a tibble with all 17 variables. If <code>FALSE</code> the tibble returned will consist of the p level, n, the predicted LC for given p level, lower and upper confidence limits.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a tibble with predicted LT for given p level, lower CL (LCL), upper CL (UCL), LCL, Pearson's chi square goodness-of-fit test (pgof), slope, intercept, slope and intercept p values and standard error, and LT variance.
</p>


<h3>References</h3>

<p>Finney, D.J., 1971. Probit Analysis, Cambridge University Press, Cambridge, England, ISBN: 052108041X
</p>
<p>Wheeler, M.W., Park, R.M., and Bailey, A.J., 2006. Comparing median lethal concentration values using confidence interval overlap or ratio tests, Environ. Toxic. Chem. 25(5), 1441-1444.10.1897/05-320R.1
</p>
<p>Robertson, J.L., Savin, N.E., Russell, R.M. and Preisler, H.K., 2007. Bioassays with arthropods. CRC press. ISBN: 9780849323317
</p>


<h3>Examples</h3>

<pre><code class='language-R'>head(lamprey_time)

results &lt;- LT_logit((response / total) ~ log10(hour),
p = c(50, 99),
weights = total,
data = lamprey_time,
subset = c(month == "May"))

# view calculated LT50 and LT99 for seasonal
# toxicity of a piscicide, 3-trifluoromethyl-4-nitrophenol, to lamprey in 2011

results

# dose-response curve can be plotted using 'ggplot2'

</code></pre>

<hr>
<h2 id='LT_probit'>Lethal Time Probit</h2><span id='topic+LT_probit'></span>

<h3>Description</h3>

<p>Calculates lethal time (LT) and
its fiducial confidence limits (CL) using a probit analysis
according to Finney 1971, Wheeler et al. 2006, and Robertson et al. 2007.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LT_probit(
  formula,
  data,
  p = NULL,
  weights = NULL,
  subset = NULL,
  log_base = NULL,
  log_x = TRUE,
  het_sig = NULL,
  conf_level = NULL,
  conf_type = NULL,
  long_output = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LT_probit_+3A_formula">formula</code></td>
<td>
<p>an object of class <code>formula</code> or one that can be coerced to that class: a symbolic description of the model to be fitted.</p>
</td></tr>
<tr><td><code id="LT_probit_+3A_data">data</code></td>
<td>
<p>an optional data frame, list or environment (or object coercible by as.data.frame to a data frame) containing the variables in the model. If not found in data, the variables are taken from environment(formula), typically the environment from which <code>LT_probit</code> is called.</p>
</td></tr>
<tr><td><code id="LT_probit_+3A_p">p</code></td>
<td>
<p>Lethal time (LT) values for given p, example will return a LT50 value if p equals 50. If more than one LT value wanted specify by creating a vector. LT values can be calculated down to the 1e-16 of a percentage (e.g. LT99.99). However, the tibble produced can and will round to nearest whole number.</p>
</td></tr>
<tr><td><code id="LT_probit_+3A_weights">weights</code></td>
<td>
<p>vector of 'prior weights' to be used in the fitting process. Only needs to be supplied if you are taking the response / total for your response variable within the formula call of <code>LC_probit</code>. Otherwise if you use cbind(response, non-response) method you do not need to supply weights. If you do the model will be incorrect. If you don't supply weights there is a warning that will help you to make sure you are using one method or the other. See the following StackExchange post about differences <a href="https://stats.stackexchange.com/questions/259502/in-using-the-cbind-function-in-r-for-a-logistic-regression-on-a-2-times-2-t">cbind() function in R for a logistic regression</a>.</p>
</td></tr>
<tr><td><code id="LT_probit_+3A_subset">subset</code></td>
<td>
<p>allows for the data to be subseted if desired. Default set to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="LT_probit_+3A_log_base">log_base</code></td>
<td>
<p>default is <code>10</code> and will be used to  calculate results using the anti of <code>log10()</code> given that the x variable has been <code>log10</code> transformed. If <code>FALSE</code> results will not be back transformed.</p>
</td></tr>
<tr><td><code id="LT_probit_+3A_log_x">log_x</code></td>
<td>
<p>default is <code>TRUE</code> and will calculate results using the antilog of determined by <code>log_base</code> given that the x variable has been <code>log()</code> transformed. If <code>FALSE</code> results will not be back transformed.</p>
</td></tr>
<tr><td><code id="LT_probit_+3A_het_sig">het_sig</code></td>
<td>
<p>significance level from person's chi square goodness-of-fit test that is used to decide if a heterogeneity factor is used. <code>NULL</code> is set to 0.15.</p>
</td></tr>
<tr><td><code id="LT_probit_+3A_conf_level">conf_level</code></td>
<td>
<p>Adjust confidence level as necessary or <code>NULL</code> set at 0.95.</p>
</td></tr>
<tr><td><code id="LT_probit_+3A_conf_type">conf_type</code></td>
<td>
<p>default is <code>"fl"</code> which will calculate fudicial confidence limits per Finney 1971. If set to <code>"dm"</code> the delta method will be used instead.</p>
</td></tr>
<tr><td><code id="LT_probit_+3A_long_output">long_output</code></td>
<td>
<p>default is <code>TRUE</code> which will return a tibble with all 17 variables. If <code>FALSE</code> the tibble returned will consist of the p level, n, the predicted LC for given p level, lower and upper confidence limits.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a tibble with predicted LT for given p level, lower CL (LCL), upper CL (UCL), LCL, Pearson's chi square goodness-of-fit test (pgof), slope, intercept, slope and intercept p values and standard error, and LT variance.
</p>


<h3>References</h3>

<p>Finney, D.J., 1971. Probit Analysis, Cambridge University Press, Cambridge, England, ISBN: 052108041X
</p>
<p>Wheeler, M.W., Park, R.M., and Bailey, A.J., 2006. Comparing median lethal concentration values using confidence interval overlap or ratio tests, Environ. Toxic. Chem. 25(5), 1441-1444.10.1897/05-320R.1
</p>
<p>Robertson, J.L., Savin, N.E., Russell, R.M. and Preisler, H.K., 2007. Bioassays with arthropods. CRC press. ISBN: 9780849323317
</p>


<h3>Examples</h3>

<pre><code class='language-R'>head(lamprey_time)

results &lt;- LT_probit((response / total) ~ log10(hour),
p = c(50, 99),
weights = total,
data = lamprey_time,
subset = c(month == "May"))

# view calculated LT50 and LT99 for seasonal
# toxicity of a piscicide, 3-trifluoromethyl-4-nitrophenol, to lamprey in 2011

results

# dose-response curve can be plotted using 'ggplot2'
</code></pre>

<hr>
<h2 id='ratio_test'>Ratio test</h2><span id='topic+ratio_test'></span>

<h3>Description</h3>

<p>Calculates a ratio test to compare two LC or LT values from two separate probit or logit models. This function is based on the ratio test developed in <a href="https://setac.onlinelibrary.wiley.com/doi/abs/10.1897/05-320R.1">Wheeler et al. 2006. 10.1897/05-320R.1</a> which has been suggested as a replacement to the common method of comparing confidence intervals to determine differences.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ratio_test(model_1, model_2, percentage = NULL,
           type = NULL, compare = NULL, log_base = NULL, log_x = TRUE,
           obj_type = NULL, conf_type = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ratio_test_+3A_model_1">model_1</code></td>
<td>
<p>first model used in the ratio test. Should be an object of either a probit or logit model created using the <code>glm()</code> function. See example.</p>
</td></tr>
<tr><td><code id="ratio_test_+3A_model_2">model_2</code></td>
<td>
<p>second model used in the ratio test. Should be an object of either a
probit or logit model created using the <code>glm()</code> function. See example.</p>
</td></tr>
<tr><td><code id="ratio_test_+3A_percentage">percentage</code></td>
<td>
<p>either a single value or a vector for given LC or LT percentage desired to compare.
Percentage is the same value used for the argument <code>p</code> in all <code>LC_</code> and <code>LT_</code> functions. For example, 50 will return and compare LC50 values for the two models. If more than one LC value is desired specify by creating a vector. LC values can be calculated down to the 1e-16 of a percentage (e.g. LC99.99). However, the tibble produced can and will round to nearest whole number.</p>
</td></tr>
<tr><td><code id="ratio_test_+3A_type">type</code></td>
<td>
<p>Link type needs to be specified to either <code>"probit"</code> which is default and will return and used in calculations for a probit model for the desired LCs or LTs. If specified to <code>"logit"</code> then <code>ratio_test</code> will return and calculate using a logit model for the desired LCs or LTs.</p>
</td></tr>
<tr><td><code id="ratio_test_+3A_compare">compare</code></td>
<td>
<p>Supply a character string to be used in the output letting the user know what models the LCs or LTs are being compared. Default output is &quot;Model 1 - Model 2&quot;. See example.</p>
</td></tr>
<tr><td><code id="ratio_test_+3A_log_base">log_base</code></td>
<td>
<p>default is <code>10</code> and will be used to  calculate results using the anti of <code>log10()</code> given that the x variable has been <code>log10</code> transformed. If <code>FALSE</code> results will not be back transformed.</p>
</td></tr>
<tr><td><code id="ratio_test_+3A_log_x">log_x</code></td>
<td>
<p>default is <code>TRUE</code> and will calculate results using the antilog of determined by <code>log_base</code> given that the x variable has been <code>log()</code> transformed. If <code>FALSE</code> results will not be back transformed.</p>
</td></tr>
<tr><td><code id="ratio_test_+3A_obj_type">obj_type</code></td>
<td>
<p>default is  <code>"list"</code> which requires both <code>model_1</code> and <code>model_2</code> arguments to be model objects, in the form of a list, from <code>glm()</code> functions. Alternatively <code>"df"</code> can be used which will require both <code>model_1</code> and <code>model_2</code> arguments to be data.frame objects created when running either <code>LC_</code> or <code>LT_</code> functions.</p>
</td></tr>
<tr><td><code id="ratio_test_+3A_conf_type">conf_type</code></td>
<td>
<p>default is <code>"fl"</code> which if <code>"df"</code> is supplied will correct covariance values if h is above 1 as fudicial confidence limits use a heterogeneity factor, h, to correct variances when chi-square p value is less than 0.15. <code>conf_type</code> can also be <code>"dm"</code>, delta method, which doesn't use a heterogeneity correction factor therefore covariance will not be uncorrected. This argument is only needed if you are using the dataframe objects from <code>LC_</code> or <code>LT_</code> functions and have used the delta method in that analysis.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tibble with <code>percentage</code> for the LC or LT value desired for the above percentage argument, <code>dose_1</code> and <code>dose_2</code> displayed calculated backtransformed or untransformed doses for the desired LC or LT values. Standard Error (<code>se</code>), Z test statistic (<code>test_stat</code>) and <code>p_value</code> determined using Z test statistic as determined using formulas in <a href="https://setac.onlinelibrary.wiley.com/doi/abs/10.1897/05-320R.1">Wheeler et al. 2006</a>.
.
</p>


<h3>References</h3>

<p>Wheeler, M.W., Park, R.M., and Bailey, A.J., 2006. Comparing median lethal concentration values using confidence interval overlap or ratio tests, Environ. Toxic. Chem. 25(5), 1441-1444.<a href="https://setac.onlinelibrary.wiley.com/doi/abs/10.1897/05-320R.1">10.1897/05-320R.1</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># view lamprey_tox data

head(lamprey_tox)

# using glm() to detemine LC values using probit model for May and June

m &lt;- glm((response / total) ~ log10(dose),
         data = lamprey_tox[lamprey_tox$nominal_dose != 0, ],
         subset = c(month == "May"),
         weights = total,
         family = binomial(link = "probit"))


j &lt;- glm((response / total) ~ log10(dose),
         data = lamprey_tox[lamprey_tox$nominal_dose != 0, ],
         subset = c(month == "June"),
         weights = total,
         family = binomial(link = "probit"))

# now that both May and June models have been made. use ratio_test to
# compare LC50 values or whatever LC values of interest.

ratios &lt;- ratio_test(model_1 = m, model_2 = j, percentage = 50,
compare = "May - June")

# view ratio test results

ratios

# you can also use LC_probit to create the models and use ratio test

m_1 &lt;- LC_probit((response / total) ~ log10(dose), p = c(50, 99),
weights = total,
data = lamprey_tox[lamprey_tox$nominal_dose != 0, ],
subset = c(month == "May"))



j_1 &lt;- LC_probit((response / total) ~ log10(dose), p = c(50, 99),
weights = total,
data = lamprey_tox[lamprey_tox$nominal_dose != 0, ],
subset = c(month == "June"))



ratios_2 &lt;- ratio_test(model_1 = m_1, model_2 = j_1, percentage = 50,
compare = "May - June", obj_type = "df")

ratios_2

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
