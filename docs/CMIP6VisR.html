<!DOCTYPE html><html lang="en"><head><title>Help for package CMIP6VisR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {CMIP6VisR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#CMIP6VisR-package'><p>Visualization and Analysis of CMIP6 Hydroclimatic Data</p></a></li>
<li><a href='#cv_basin_daily_precip'><p>Calculates basin-averaged daily precipitation</p></a></li>
<li><a href='#cv_clip_basin'><p>Get zones and areas that clip rasters from a given basin polygon</p></a></li>
<li><a href='#cv_zone_area_raster'><p>Gets zones and areas for all grid locations</p></a></li>
<li><a href='#zone_grid_df'><p>zone_grid_df</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Visualization and Analysis of Coupled Model Intercomparison
Project, Phase-6 (CMIP6) Hydroclimatic Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2025-02-27</td>
</tr>
<tr>
<td>Description:</td>
<td>Data manipulation for Coupled Model Intercomparison Project, Phase-6 (CMIP6) hydroclimatic data. The files are archived in the Federated Research Data Repository (FRDR) (Rajulapati et al, 2024, &lt;<a href="https://doi.org/10.20383%2F103.0829">doi:10.20383/103.0829</a>&gt;). The data set is described in Abdelmoaty et al. (2025, &lt;<a href="https://doi.org/10.1038%2Fs41597-025-04396-z">doi:10.1038/s41597-025-04396-z</a>&gt;).</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>terra, stringr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Author:</td>
<td>Simon Michael Papalexiou [aut],
  Heba Abdelmoaty [aut],
  Konstantinos Andreadis [aut],
  Kevin Shook [ctb, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Kevin Shook &lt;kshook@kshook.ca&gt;</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/TycheLab/CMIP6VisR">https://github.com/TycheLab/CMIP6VisR</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-02-28 00:23:40 UTC; kevin</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-03-03 11:50:43 UTC</td>
</tr>
</table>
<hr>
<h2 id='CMIP6VisR-package'>Visualization and Analysis of CMIP6 Hydroclimatic Data</h2><span id='topic+CMIP6VisR'></span><span id='topic+CMIP6VisR-package'></span>

<h3>Description</h3>

<p>Provides data manipulation, analyses and visualization for Coupled Model Intercomparison Project, Phase-6 (CMIP6) hydroclimatic data. The files are archived in the Federated Research Data Repository (FRDR) (Rajulapati et al., 2024)
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Kevin Shook <a href="mailto:kshook@kshook.ca">kshook@kshook.ca</a> [contributor]
</p>
<p>Authors:
</p>

<ul>
<li><p> Simon Michael Papalexiou
</p>
</li>
<li><p> Heba Abdelmoaty
</p>
</li>
<li><p> Konstantinos Andreadis
</p>
</li></ul>



<h3>References</h3>

<p>Rajulapati, C., Abdelmoaty, H., Nerantzaki, S., Papalexiou, S. (2024). High-resolution future temperature and precipitation dataset for Canada, 2015 - 2100. Federated Research Data Repository. https://doi.org/10.20383/103.0829
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/TycheLab/CMIP6VisR">https://github.com/TycheLab/CMIP6VisR</a>
</p>
</li></ul>


<hr>
<h2 id='cv_basin_daily_precip'>Calculates basin-averaged daily precipitation</h2><span id='topic+cv_basin_daily_precip'></span>

<h3>Description</h3>

<p>Extracts the daily precipitation values from CMIP6 NetCDF files, and calculates
the mean precipitation for a given basin for each time interval. The original files are in
longitude-latitude projection, so the areas of the cells varies. The cell areas
are used to weight the precipitation when computing the basin mean precipitation.
</p>
<p>The CMIP6 data are arranged by zone in 9 files. As a given basin may lie over more than
one zone, it may necessary to read in data from more than one NetCDF file when computing
the basin mean precipitation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cv_basin_daily_precip(
  netcdf_directory = ".",
  scenario = "pr_day_ACCESS-CM2_ssp126_r2i1p1f1_gn_20150101-21001231_cannc_SPQM_",
  basin_zone_area = NULL,
  temp_file = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cv_basin_daily_precip_+3A_netcdf_directory">netcdf_directory</code></td>
<td>
<p>Required. Directory containing NetCDF files.</p>
</td></tr>
<tr><td><code id="cv_basin_daily_precip_+3A_scenario">scenario</code></td>
<td>
<p>Required. Full name of scenario to be used. This is the file name omitting the zone number.</p>
</td></tr>
<tr><td><code id="cv_basin_daily_precip_+3A_basin_zone_area">basin_zone_area</code></td>
<td>
<p>Required. A list object returned by <code>cv_clip_basin()</code> which contains the zone numbers to be used,
the basin area within each zone, and rasters of each zone containing the area of each
element.</p>
</td></tr>
<tr><td><code id="cv_basin_daily_precip_+3A_temp_file">temp_file</code></td>
<td>
<p>If <code>TRUE</code> (the default) then temporary files will be used when extracting the values
from the NetCDF files. This option is slower than keeping all the values in
memory (which is what occurs if <code>temp_file = TRUE</code>), <em>but</em> allows the function
to work with very large basins, which may require more memory than is available.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Reruns a data frame with 2 columns: <code>date</code> and <code>precipitation</code>. The
<code>date</code> is a standard <span class="rlang"><b>R</b></span> date over the interval 2015-01-01 to 2100-12-31, and the
<code>precipitation</code> is the basin mean value.
</p>


<h3>Author(s)</h3>

<p>Kevin Shook
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cv_clip_basin">cv_clip_basin</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# This function is marked to not be tested as it requires local copies of the CMIP6 data files
# which are many GB in size
library(terra)
az_raster &lt;- cv_zone_area_raster()
fpath &lt;- system.file("extdata", "07BF001.shp", package = "CMIP6VisR")
basin_vector &lt;- vect(fpath)
basin_areas &lt;- cv_clip_basin(az_raster, basin_vector)
netcdf_directory &lt;- "."
values &lt;- cv_basin_daily_precip(netcdf_directory = netcdf_directory,
                               basin_zone_area = basin_areas,
                               temp_file = FALSE)

</code></pre>

<hr>
<h2 id='cv_clip_basin'>Get zones and areas that clip rasters from a given basin polygon</h2><span id='topic+cv_clip_basin'></span>

<h3>Description</h3>

<p>Takes the <code>SpatRaster</code> that represents zones and areas and
clips them from polygon <code>basin</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cv_clip_basin(za_rast, basin)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cv_clip_basin_+3A_za_rast">za_rast</code></td>
<td>
<p><code>SpatRaster</code> of the zones and areas</p>
</td></tr>
<tr><td><code id="cv_clip_basin_+3A_basin">basin</code></td>
<td>
<p><code>SpatVector</code> of the basin to clip to</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list with 3 elements: 1) <code>raster</code> (rasters of cell areas for each zone),
2) <code>area</code> total area of each zone in the basin, and 3) <code>zone</code> zone numbers.
</p>


<h3>Author(s)</h3>

<p>Kostas Andreadis
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cv_basin_daily_precip">cv_basin_daily_precip</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>{
library(terra)
az_raster &lt;- cv_zone_area_raster()
fpath &lt;- system.file("extdata", "07BF001.shp", package = "CMIP6VisR")
basin_vector &lt;- vect(fpath)
basin_areas &lt;- cv_clip_basin(az_raster, basin_vector)
}

</code></pre>

<hr>
<h2 id='cv_zone_area_raster'>Gets zones and areas for all grid locations</h2><span id='topic+cv_zone_area_raster'></span>

<h3>Description</h3>

<p>Uses the data frame <code>zone_grid_df</code>. Returns a raster containing two layers, the zone (1-9) and the area (km^2^) for
each grid location in the CMIP6 files. The raster raster returned has 415 rows (latitudes in 0.1 degrees)
and 883 columns (longitudes in 0.1 degrees). The zone number is used to determine the file(s) to read in
for computing the basin mean precipitation statistics for a given Canadian hydrometric basin. The
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cv_zone_area_raster()
</code></pre>


<h3>Value</h3>

<p>Returns a <span class="pkg">terra</span> <code>SpatRaster</code> object (415 rows x 883 columns x 2 layers) of all Canadian grid locations.
</p>


<h3>Author(s)</h3>

<p>Heba Abdelmoaty Kevin SHook
</p>


<h3>Examples</h3>

<pre><code class='language-R'>zone_area_grid &lt;- cv_zone_area_raster()
library(terra)
plot(zone_area_grid)

</code></pre>

<hr>
<h2 id='zone_grid_df'>zone_grid_df</h2><span id='topic+zone_grid_df'></span>

<h3>Description</h3>

<p>A dataframe of zone values and areas for all CMIP6 grid cells
</p>


<h3>Usage</h3>

<pre><code class='language-R'>zone_grid_df
</code></pre>


<h3>Format</h3>

<p>A dateframe with 169584 rows and 4 columns.
</p>


<h3>Details</h3>

<p>Variables:
</p>

<dl>
<dt>long</dt><dd><p>Longitude</p>
</dd>
<dt>lat</dt><dd><p>Latitude</p>
</dd>
<dt>zone</dt><dd><p>Zone (0-9)</p>
</dd>
<dt>area</dt><dd><p>Grid cell area km<code class="reqn">^2</code></p>
</dd>
</dl>



<h3>Source</h3>

<p>https://doi.org/10.20383/103.0829
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
