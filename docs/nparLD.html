<!DOCTYPE html><html lang="en"><head><title>Help for package nparLD</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {nparLD}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#nparLD'><p>Nonparametric Tests for Repeated Measures Data in Factorial Designs</p></a></li>
<li><a href='#amylase'><p>Alpha-amylase study</p></a></li>
<li><a href='#dental'><p>Dental study</p></a></li>
<li><a href='#edema'><p>Postoperative edema</p></a></li>
<li><a href='#f1.ld.f1'><p>Nonparametric Tests for the F1-LD-F1 Design</p></a></li>
<li><a href='#f1.ld.f2'><p>Nonparametric Tests for the F1-LD-F2 Design</p></a></li>
<li><a href='#f2.ld.f1'><p>Nonparametric Tests for the F2-LD-F1 Design</p></a></li>
<li><a href='#ld.ci'><p>Confidence Intervals for the Relative Treatment Effects</p></a></li>
<li><a href='#ld.f1'><p>Nonparametric Tests for the LD-F1 Design</p></a></li>
<li><a href='#ld.f2'><p>Nonparametric Tests for the LD-F2 Design</p></a></li>
<li><a href='#panic'><p>Panic disorder study I</p></a></li>
<li><a href='#panic2'><p>Panic disorder study II</p></a></li>
<li><a href='#plasma'><p>Plasma-renin study</p></a></li>
<li><a href='#plot.nparLD'><p>Plot for nparLD</p></a></li>
<li><a href='#print.nparLD'><p>Simple Summary for nparLD</p></a></li>
<li><a href='#rat'><p>Rat growth study</p></a></li>
<li><a href='#respiration'><p>Respiratory disorder study</p></a></li>
<li><a href='#shoulder'><p>Shoulder tip pain study</p></a></li>
<li><a href='#summary.nparLD'><p>Object Summary for nparLD</p></a></li>
<li><a href='#tree'><p>Vitality of treetops</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>2.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-08-06</td>
</tr>
<tr>
<td>Title:</td>
<td>Nonparametric Analysis of Longitudinal Data in Factorial
Experiments</td>
</tr>
<tr>
<td>Author:</td>
<td>Kimihiro Noguchi &lt;noguchk@wwu.edu&gt;, Mahbub Latif
        &lt;mlatif@isrt.ac.bd&gt;, Karthinathan Thangavelu,
        Frank Konietschke &lt;frank.konietschke@charite.de&gt;, Yulia R. Gel
        &lt;yxg142030@utdallas.edu&gt;, Edgar Brunner
        &lt;ebrunne1@gwdg.de&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Frank Konietschke &lt;frank.konietschke@charite.de&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.6.0), MASS</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Description:</td>
<td>Performs nonparametric
        analysis of longitudinal data in factorial experiments.
        Longitudinal data are those which are collected from the same
        subjects over time, and they frequently arise in biological
        sciences. Nonparametric methods do not require distributional
        assumptions, and are applicable to a variety of data types
        (continuous, discrete, purely ordinal, and dichotomous).  Such
        methods are also robust with respect to outliers and for small
        sample sizes.</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-08-06 14:39:07 UTC; Matthias</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-08-07 00:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='nparLD'>Nonparametric Tests for Repeated Measures Data in Factorial Designs</h2><span id='topic+nparLD'></span><span id='topic+nparLD-package'></span>

<h3>Description</h3>

<p>This function performs several nonparametric tests for the relative treatment effects with global alternatives for repeated measures data in various factorial designs (see Details for the designs). For such data, the Wald-type statistic (WTS) and the ANOVA-type statistic (ATS) are calculated (see On the Test Statistics for details of the test staistics). The methods are available for the LD-F1, LD-F2, F1-LD-F1, F1-LD-F2, and F2-LD-F1 designs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nparLD(formula, data=NULL, subject, description=TRUE,
time1.order=NULL, time2.order=NULL, group1.order=NULL, group2.order=NULL,
plot.CI=FALSE, alpha=0.05, show.covariance=FALSE, order.warning=TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nparLD_+3A_formula">formula</code></td>
<td>
<p>a model <code><a href="stats.html#topic+formula">formula</a></code> object. The left hand side contains the response variable, and the right hand side contains the whole-plot and sub-plot factor variables. The whole-plot and sub-plot factor variables are automatically detected according to the <code>subject</code> variable.</p>
</td></tr>
<tr><td><code id="nparLD_+3A_data">data</code></td>
<td>
<p>a data.frame, list or environment (or object coercible by <code><a href="base.html#topic+as.data.frame">as.data.frame</a></code> to a data.frame), containing the variables in formula. Neither a matrix nor an array will be accepted; the default option is NULL.</p>
</td></tr>
<tr><td><code id="nparLD_+3A_subject">subject</code></td>
<td>
<p>the column number in <code>data</code>, the column name in <code>data</code>, or a vector to specify individual subjects.</p>
</td></tr>
<tr><td><code id="nparLD_+3A_description">description</code></td>
<td>
<p>an indicator for whether a short description of the output should be shown; the default option is TRUE.</p>
</td></tr>
<tr><td><code id="nparLD_+3A_time1.order">time1.order</code></td>
<td>
<p>a character or numeric vector specifying the order of the time1 levels; applicable to all designs.</p>
</td></tr>
<tr><td><code id="nparLD_+3A_time2.order">time2.order</code></td>
<td>
<p>a character or numeric vector specifying the order of the time2 levels; applicable to the LD-F2 and F1-LD-F2 designs.</p>
</td></tr>
<tr><td><code id="nparLD_+3A_group1.order">group1.order</code></td>
<td>
<p>a character or numeric vector specifying the order of the group1 levels; applicable to the F1-LD-F1 and F1-LD-F2 designs.</p>
</td></tr>
<tr><td><code id="nparLD_+3A_group2.order">group2.order</code></td>
<td>
<p>a character or numeric vector specifying the order of the group2 levels; applicable to the F2-LD-F1 design.</p>
</td></tr>
<tr><td><code id="nparLD_+3A_plot.ci">plot.CI</code></td>
<td>
<p>an indicator for whether a plot of the confidence interval (CI) for the relative treatment effect (RTE) should be shown; the default option is FALSE.</p>
</td></tr>
<tr><td><code id="nparLD_+3A_alpha">alpha</code></td>
<td>
<p>a numeric specifying the significance level of the confidence intervals; the default option is 0.05.</p>
</td></tr>
<tr><td><code id="nparLD_+3A_show.covariance">show.covariance</code></td>
<td>
<p>an indicator for whether the covariance matrix should be shown; the default option is FALSE, in which case, NULL is returned.</p>
</td></tr>
<tr><td><code id="nparLD_+3A_order.warning">order.warning</code></td>
<td>
<p>an indicator for whether a short description of the warning regarding the ordering of factors should be shown; the default option is TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Fx-LD-Fy design refers to the experimental design with x whole-plot factor and y sub-plot factors. A whole-plot (between-subjects) factor refers to a factor effective for each subject at all times. A sub-plot (within-subjects) factor refers to a factor effective at a single time point for all time curves and all subjects. The LD-Fy design refers to the experimental design with no whole-plot factor. See Brunner et al. (2002) for more examples. Also see <code><a href="#topic+print">print</a></code>, <code><a href="#topic+plot">plot</a></code>, and <code><a href="#topic+summary">summary</a></code> for summarized outputs.
</p>


<h3>Value</h3>

<p>An <code>nparLD</code> class object with the following components.
</p>
<table role = "presentation">
<tr><td><code>RTE</code></td>
<td>

<p>summary of the relative treatment effect (RTE) in a n-by-3 matrix form, where n is the total number of time1, time2, and group levels, and group-time interactions; the summary includes the mean of the ranks (RankMeans) in the 1st column, number of observations without counting the repeated measurements within the cell (Nobs) in the 2nd column, and the relative treatment effect (RTE) in the 3rd column.
</p>
</td></tr>
<tr><td><code>Wald.test</code></td>
<td>
<p>the test statistic, the degrees of freedom (df) of the central chi-squared distribution, and the corresponding p-value of the Wald-type test.</p>
</td></tr>
<tr><td><code>ANOVA.test</code></td>
<td>
<p>the test statistic, the numerator degrees of freedom (df) of the central F distribution, and the corresponding p-value of the ANOVA-type test; the denominator degrees of freedom is set to infinity.</p>
</td></tr>
<tr><td><code>covariance</code></td>
<td>
<p>the covariance matrix.</p>
</td></tr>
<tr><td><code>Conf.Int</code></td>
<td>
<p>the (pointwise) 100(1-alpha) percent confidence intervals. See <code><a href="#topic+ld.ci">ld.ci</a></code> for details.</p>
</td></tr>
<tr><td><code>...</code></td>
<td>
<p>Other function-specific outputs. For example, <code>ANOVA.test.mod.Box</code> which is applicable to designs with whole-plot factor(s).</p>
</td></tr>
</table>


<h3>On the Test Statistics</h3>

<p>Although we provide both Wald-type statistic (WTS, see <code>Wald.test</code>) and ANOVA-type statistic with the denominator degrees of freedom set to infinity (ATS, see <code>ANOVA.test</code>), ATS is typically preferred to WTS as it requires less assumptions on the covariance matrix and it has superior small sample performances. Moreover, for the main effects and interactions involving only the whole-plot factors, the modified ANOVA-type statistic with Box (1954) approximation (<code>ANOVA.test.mod.Box</code>) is preferred to ATS. See Brunner et al. (2002) for more details.
</p>


<h3>Author(s)</h3>

<p>Kimihiro Noguchi, Karthinathan Thangavelu, Frank Konietschke, Yulia Gel, Edgar Brunner</p>


<h3>References</h3>

<p>Box, G.E.P. (1954). Some theorems on quadratic forms applied in the study of analysis of variance problems, I. Effect of inequality of variance in the one-way classification. <em>Annals of Mathematical Statistics</em>, 25, 290-302.<br />
</p>
<p>Brunner, E., Domhof, S., and Langer, F. (2002). <em>Nonparametric Analysis of Longitudinal Data in Factorial Experiments</em>,
Wiley, New York.<br />
</p>
<p>Brunner, E. and Langer, F. (1999). <em>Nichtparametrische Analyse longitudinaler Daten</em>, 
R. Oldenbourg Verlag, Munchen Wien.<br />
</p>
<p>Noguchi, K., Gel, Y.R., Brunner, E., and Konietschke, F. (2012). 
nparLD: An R Software Package for the Nonparametric Analysis of Longitudinal Data in Factorial Experiments. 
<em>Journal of Statistical Software</em>, 50(12), 1-23.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ld.f1">ld.f1</a></code>, <code><a href="#topic+ld.f2">ld.f2</a></code>, <code><a href="#topic+f1.ld.f1">f1.ld.f1</a></code>, <code><a href="#topic+f1.ld.f2">f1.ld.f2</a></code>, <code><a href="#topic+f2.ld.f1">f2.ld.f1</a></code>, <code><a href="#topic+ld.ci">ld.ci</a></code>, <code><a href="#topic+amylase">amylase</a></code>, <code><a href="#topic+edema">edema</a></code>, <code><a href="#topic+shoulder">shoulder</a></code>, <code><a href="#topic+tree">tree</a></code>, <code><a href="#topic+panic">panic</a></code>, <code><a href="#topic+panic2">panic2</a></code>, <code><a href="#topic+plasma">plasma</a></code>, <code><a href="#topic+dental">dental</a></code>, <code><a href="#topic+rat">rat</a></code>, <code><a href="#topic+respiration">respiration</a></code>, <code><a href="#topic+print">print</a></code>, <code><a href="#topic+plot">plot</a></code>, <code><a href="#topic+summary">summary</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Example with the "Panic disorder study I" data (LD-F1 design) ##
data(panic)
ex.f1.np&lt;-nparLD(resp~time, data=panic, subject="subject", description=FALSE)
# LD F1 Model 
# ----------------------- 
# Check that the order of the time level is correct.
# Time level:   0 2 4 6 8 
# If the order is not correct, specify the correct order in time.order.

ex.f1.np$Wald.test
#     Statistic df    p-value
#time  126.6946  4 1.9822e-26

ex.f1.np$ANOVA.test
#     Statistic       df      p-value
#time  36.93664 2.234135 1.975781e-18

## Example with the "Alpha-amylase study" data (LD-F2 design) ##
data(amylase)
ex.f2.np&lt;-nparLD(resp~time1*time2, data=amylase, subject="subject", description=FALSE)
# LD F2 Model 
# ----------------------- 
# Check that the order of the time1 and time2 levels are correct.
# Time1 level:   M T 
# Time2 level:   8 12 17 21 
# If the order is not correct, specify the correct order in time1.order or 
# time2.order.

ex.f2.np$Wald.test
#             Statistic df      p-value
#time1        0.6761043  1 4.109314e-01
#time2       35.8647640  3 7.997949e-08
#time1:time2 14.3020921  3 2.521503e-03

ex.f2.np$ANOVA.test
#             Statistic       df      p-value
#time1        0.6761043 1.000000 4.109314e-01
#time2       14.2671950 2.858344 5.860479e-09
#time1:time2  5.2242782 2.184249 4.150298e-03

## Example with the "Vitality of treetops" data (F1-LD-F1 design) ##
data(tree)
ex.f1f1.np&lt;-nparLD(resp~time*group, data=tree, subject="subject", 
description=FALSE)
# F1 LD F1 Model 
# ----------------------- 
# Check that the order of the time and group levels are correct.
# Time level:   1 2 3 4 
# Group level:   D2 D0 D1 
# If the order is not correct, specify the correct order in time.order or 
# group.order.

ex.f1f1.np$Wald.test
#           Statistic df      p-value
#group       4.510037  2 1.048716e-01
#time       58.061097  3 1.525356e-12
#group:time 14.819966  6 2.170415e-02

ex.f1f1.np$ANOVA.test
#           Statistic       df      p-value
#group       2.352854 1.968147 9.601181e-02
#time       21.389142 2.729147 8.210954e-13
#group:time  3.113632 5.346834 6.768732e-03

ex.f1f1.np$ANOVA.test.mod.Box
#      Statistic      df1     df2   p-value
#group  2.352854 1.968147 64.3979 0.1040525

## Example with the "Postoperative edema" data (F1-LD-F2 design) ##
data(edema)
ex.f1f2.np&lt;-nparLD(resp~group*time1*time2, data=edema, subject="subject", 
description=FALSE)
# F1 LD F2 Model 
# -----------------------  
# Check that the order of the time1, time2, and group levels are correct.
# Time1 level:   Healthy Operated 
# Time2 level:   -1 1 3 5 
# Group level:   Drug Placebo 
# If the order is not correct, specify the correct order in time1.order, 
# time2.order, or group.order.

ex.f1f2.np$Wald.test
#                   Statistic df      p-value
#group              1.0725762  1 3.003643e-01
#time1             25.8758257  1 3.641005e-07
#time2             36.8857947  3 4.864630e-08
#group:time1        0.3304448  1 5.653973e-01
#time2:time1       47.3460508  3 2.933702e-10
#group:time2        5.3048189  3 1.507900e-01
#group:time1:time2  1.6581652  3 6.462743e-01

ex.f1f2.np$ANOVA.test
#                   Statistic       df      p-value
#group              1.0725762 1.000000 3.003643e-01
#time1             25.8758257 1.000000 3.641005e-07
#time2             11.0630080 2.699667 9.661602e-07
#group:time1        0.3304448 1.000000 5.653973e-01
#time2:time1       15.1854889 2.630202 6.184646e-09
#group:time2        1.3342605 2.699667 2.625538e-01
#group:time1:time2  0.7170325 2.630202 5.242367e-01

## Example with the "Shoulder tip pain study" data (F2-LD-F1 design) ##
data(shoulder)
ex.f2f1.np&lt;-nparLD(resp~time*group1*group2, data=shoulder, subject="subject", 
description=FALSE)
# F2 LD F1 Model 
# ----------------------- 
# Check that the order of the time, group1, and group2 levels are correct.
# Time level:   1 2 3 4 5 6 
# Group1 level:   Y N 
# Group2 level:   F M 
# If the order is not correct, specify the correct order in time.order, 
# group1.order, or group2.order.
#
#
# Warning(s):
# The covariance matrix is singular. 

ex.f2f1.np$Wald.test
#                     Statistic df      p-value
#group1             16.40129021  1 5.125033e-05
#group2              0.04628558  1 8.296575e-01
#time               16.34274332  5 5.930698e-03
#group1:group2       0.03583558  1 8.498554e-01
#group1:time        27.51450085  5 4.527996e-05
#group2:time        12.37903186  5 2.994753e-02
#group1:group2:time  5.11864769  5 4.015727e-01

ex.f2f1.np$ANOVA.test
#                     Statistic       df      p-value
#group1             16.40129021 1.000000 5.125033e-05
#group2              0.04628558 1.000000 8.296575e-01
#time                3.38218704 2.700754 2.120366e-02
#group1:group2       0.03583558 1.000000 8.498554e-01
#group1:time         3.71077200 2.700754 1.398190e-02
#group2:time         1.14434841 2.700754 3.272967e-01
#group1:group2:time  0.43755394 2.700754 7.054255e-01

ex.f2f1.np$ANOVA.test.mod.Box
#                Statistic df1      df2      p-value
#group1        16.40129021   1 21.86453 0.0005395379
#group2         0.04628558   1 21.86453 0.8316516274
#group1:group2  0.03583558   1 21.86453 0.8516017168
</code></pre>

<hr>
<h2 id='amylase'>Alpha-amylase study</h2><span id='topic+amylase'></span>

<h3>Description</h3>

<p>Measurements of alpha-amylase levels (in U/ml) of the saliva from a group of volunteers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(amylase)</code></pre>


<h3>Format</h3>

<p>Longitudinal data of 14 probands with alpha-amylase level measurements taken on 8 occasions (4 times per day for 2 days).
</p>


<h3>Details</h3>

<p>In clinical chemistry, it is important for the determination of reference intervals to investigate whether a variable of interest has a circadian rhythm. If so, the reference intervals cannot be determined independently of time. This question is to be analyzed in the case of alpha-amylase in saliva. Measurements of alpha-amylase levels were taken from the saliva of 14 volunteers, four times per day (8 a.m., 12 p.m., 5 p.m., 9 p.m.) on two days (Monday (m), Thursday (t)), since differences in the alpha-amylase profiles immediately after a weekend as opposed to the middle of the week are suspected. Thus, each subject was examined on Monday and Thursday.
</p>


<h3>References</h3>

<p>Brunner, E., Domhof, S., and Langer, F. (2002). <em>Nonparametric Analysis of Longitudinal Data in Factorial Experiments</em>,
Wiley, New York.<br />
</p>
<p>Brunner, E. and Langer, F. (1999). <em>Nichtparametrische Analyse longitudinaler Daten</em>, 
R. Oldenbourg Verlag, Munchen Wien.<br />
</p>
<p>Noguchi, K., Gel, Y.R., Brunner, E., and Konietschke, F. (2012). 
nparLD: An R Software Package for the Nonparametric Analysis of Longitudinal Data in Factorial Experiments. 
<em>Journal of Statistical Software</em>, 50(12), 1-23.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Analysis using LD-F2 design ##
data(amylase)
attach(amylase)
ex.f2&lt;-ld.f2(y=resp, time1=time1, time2=time2, subject=subject,
time1.name="Day", time2.name="Time", description=FALSE)
# LD F2 Model 
# ----------------------- 
# Check that the order of the time1 and time2 levels are correct.
# Time1 level:   M T 
# Time2 level:   8 12 17 21 
# If the order is not correct, specify the correct order in time1.order or 
# time2.order.

## Wald-type statistic 
ex.f2$Wald.test

#          Statistic df      p-value
#Day       0.6761043  1 4.109314e-01
#Time     35.8647640  3 7.997949e-08
#Day:Time 14.3020921  3 2.521503e-03

## ANOVA-type statistic
ex.f2$ANOVA.test

#          Statistic       df      p-value
#Day       0.6761043 1.000000 4.109314e-01
#Time     14.2671950 2.858344 5.860479e-09
#Day:Time  5.2242782 2.184249 4.150298e-03
</code></pre>

<hr>
<h2 id='dental'>Dental study</h2><span id='topic+dental'></span>

<h3>Description</h3>

<p>Measurements of distances (in millimeters) between the center of the pituitary and the pterygomaxillary fissure from a group of boys.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(dental)</code></pre>


<h3>Format</h3>

<p>Longitudinal data of of 16 boys with the dental measurements taken on 4 occasions (at the ages 8, 10, 12, and 14).
</p>


<h3>Details</h3>

<p>Potthoff and Roy (1964) use this dental measurement dataset to analyze the growth curve problem to suggest answers to questions such as a suitable form for the function of time, the difference in the curves between boys and girls, and possibility of obtaining confidence bands. The dataset contains the data for boys (see <code><a href="nlme.html#topic+Orthodont">Orthodont</a></code> for a complete dataset). The dataset was obtained by investigators at the University of North Carolina Dental School.
</p>


<h3>References</h3>

<p>Brunner, E., Domhof, S., and Langer, F. (2002). <em>Nonparametric Analysis of Longitudinal Data in Factorial Experiments</em>,
Wiley, New York.<br />
</p>
<p>Brunner, E. and Langer, F. (1999). <em>Nichtparametrische Analyse longitudinaler Daten</em>, 
R. Oldenbourg Verlag, Munchen Wien.<br />
</p>
<p>Noguchi, K., Gel, Y.R., Brunner, E., and Konietschke, F. (2012). 
nparLD: An R Software Package for the Nonparametric Analysis of Longitudinal Data in Factorial Experiments. 
<em>Journal of Statistical Software</em>, 50(12), 1-23.<br />
</p>
<p>Potthoff, R.F. and Roy, S.N. (1964). Generalized multivariate analysis of variance model useful especially for growth curve problems, 
<em>Biometrika</em>, 51, 313-326.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+nparLD">nparLD</a></code>, <code><a href="#topic+ld.f1">ld.f1</a></code>, <code><a href="nlme.html#topic+Orthodont">Orthodont</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Analysis using LD-F1 design ##
data(dental)
attach(dental)
ex.f1&lt;-ld.f1(y=resp, time=time, subject=subject, w.pat=c(1,2,3,4), 
time.name="Age", description=FALSE, time.order=NULL)
# LD F1 Model 
# ----------------------- 
# Check that the order of the time level is correct.
# Time level:   8 10 12 14 
# If the order is not correct, specify the correct order in time.order.

## Wald-type statistic 
ex.f1$Wald.test
#     Statistic df p-value
#Week  94.47718  3 2.391503e-20

## ANOVA-type statistic
ex.f1$ANOVA.test
#    Statistic       df      p-value
#Age  31.48774 2.700785 1.437729e-18

## The same analysis can be done using the wrapper function "nparLD" ##

ex.f1np&lt;-nparLD(resp~time, data=dental, subject="subject", description=FALSE)
# LD F1 Model 
# ----------------------- 
# Check that the order of the time level is correct.
# Time level:   8 10 12 14 
# If the order is not correct, specify the correct order in time.order.
</code></pre>

<hr>
<h2 id='edema'>Postoperative edema</h2><span id='topic+edema'></span>

<h3>Description</h3>

<p>Measurements of skin temperatures (in degree Celcius/10) of both operated and non-operated hands from a group of patients who had a surgery on a hand.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(edema)</code></pre>


<h3>Format</h3>

<p>Longitudinal data of 58 patients from both a treatment and a control group with skin temperatues taken on 4 occasions on each hand, which result in 8 occasions per patient.
</p>


<h3>Details</h3>

<p>Surgical procedures on the hand may lead to a postoperative edema and a reddening of the skin. This is related to an increase in the skin temperature. A randomized clinical study was conducted to investigate whether treatment with a substance (V) effects a faster reduction of the edema and reddening than a placebo (P). Each experimental group consists of 29 patients. Temperature measurements were taken on the same area of both the operated and non-operated hand on the day previous to the operation (day -1) as well as on the first, third and fifth day (days 1, 3, 5) subsequent to the surgery.
</p>


<h3>References</h3>

<p>Brunner, E., Domhof, S., and Langer, F. (2002). <em>Nonparametric Analysis of Longitudinal Data in Factorial Experiments</em>,
Wiley, New York.<br />
</p>
<p>Brunner, E. and Langer, F. (1999). <em>Nichtparametrische Analyse longitudinaler Daten</em>, 
R. Oldenbourg Verlag, Munchen Wien.<br />
</p>
<p>Noguchi, K., Gel, Y.R., Brunner, E., and Konietschke, F. (2012). 
nparLD: An R Software Package for the Nonparametric Analysis of Longitudinal Data in Factorial Experiments. 
<em>Journal of Statistical Software</em>, 50(12), 1-23.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Analysis using F1-LD-F2 design ##
data(edema)
attach(edema)
ex.f1f2&lt;-f1.ld.f2(y=resp, time1=time1, time2=time2, group=group, subject=subject, 
time1.name="Hand", time2.name="Day", group.name="Treatment", description=FALSE)
# F1 LD F2 Model 
# ----------------------- 
# Check that the order of the time1, time2, and group levels are correct.
# Time1 level:   Healthy Operated 
# Time2 level:   -1 1 3 5 
# Group level:   Drug Placebo 
# If the order is not correct, specify the correct order in time1.order, 
# time2.order, or group.order.

## Wald-type statistic 
ex.f1f2$Wald.test

#                    Statistic df      p-value
#Treatment           1.0725762  1 3.003643e-01
#Hand               25.8758257  1 3.641005e-07
#Day                36.8857947  3 4.864630e-08
#Treatment:Hand      0.3304448  1 5.653973e-01
#Day:Hand           47.3460508  3 2.933702e-10
#Treatment:Day       5.3048189  3 1.507900e-01
#Treatment:Hand:Day  1.6581652  3 6.462743e-01

## ANOVA-type statistic
ex.f1f2$ANOVA.test

#                    Statistic       df      p-value
#Treatment           1.0725762 1.000000 3.003643e-01
#Hand               25.8758257 1.000000 3.641005e-07
#Day                11.0630080 2.699667 9.661602e-07
#Treatment:Hand      0.3304448 1.000000 5.653973e-01
#Day:Hand           15.1854889 2.630202 6.184646e-09
#Treatment:Day       1.3342605 2.699667 2.625538e-01
#Treatment:Hand:Day  0.7170325 2.630202 5.242367e-01
</code></pre>

<hr>
<h2 id='f1.ld.f1'>Nonparametric Tests for the F1-LD-F1 Design</h2><span id='topic+f1.ld.f1'></span>

<h3>Description</h3>

<p>This function performs several tests for the relative treatment effects with global or patterned alternatives for the F1-LD-F1 design (see Details for the definition). For the experiments with F1-LD-F1 design, the Wald-type statistic (WTS), the ANOVA-type statistic (ATS), and the modified ANOVA-type statistic with Box (1954) approximation are calculated for testing group and time effects, and interaction. The hypothesis can also be tested against patterned alternatives to detect various trends. Moreover, pairwise comparisons of the groups, patterned interactions, and patterned group effects can be tested using this function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>f1.ld.f1(y, time, group, subject, w.pat=NULL, w.t=NULL, w.g=NULL, 
time.name="Time", group.name="Group", description=TRUE, 
time.order=NULL, group.order=NULL, plot.RTE=TRUE, show.covariance=FALSE,
order.warning=TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="f1.ld.f1_+3A_y">y</code></td>
<td>
<p>a vector of numeric variable of interest; missing values should be specified as NA.</p>
</td></tr>
<tr><td><code id="f1.ld.f1_+3A_time">time</code></td>
<td>
<p>a vector of the sub-plot factor variable. See Details for more explanation.</p>
</td></tr>
<tr><td><code id="f1.ld.f1_+3A_group">group</code></td>
<td>
<p>a vector of the whole-plot factor variable. See Details for more explanation.</p>
</td></tr>
<tr><td><code id="f1.ld.f1_+3A_subject">subject</code></td>
<td>
<p>a vector of individual subjects.</p>
</td></tr>
<tr><td><code id="f1.ld.f1_+3A_w.pat">w.pat</code></td>
<td>
<p>an A-by-T matrix specifying the pattern for the pattern alternatives where A is the group level and T is the time level; the default option is NULL.</p>
</td></tr>
<tr><td><code id="f1.ld.f1_+3A_w.t">w.t</code></td>
<td>
<p>a vector of time pattern for the pattern alternatives; the default option is NULL. The length, if specified, must be equal to the number of time levels.</p>
</td></tr>
<tr><td><code id="f1.ld.f1_+3A_w.g">w.g</code></td>
<td>
<p>a vector of group pattern for the pattern alternatives; the default option is NULL. The length, if specified, must be equal to the number of group levels.</p>
</td></tr>
<tr><td><code id="f1.ld.f1_+3A_time.name">time.name</code></td>
<td>
<p>a character vector specifying the name of the time vector; the default option is &quot;Time&quot;.</p>
</td></tr>
<tr><td><code id="f1.ld.f1_+3A_group.name">group.name</code></td>
<td>
<p>a character vector specifying the name of the group vector; the default option is &quot;Group&quot;.</p>
</td></tr>
<tr><td><code id="f1.ld.f1_+3A_description">description</code></td>
<td>
<p>an indicator for whether a short description of the output should be shown; the default option is TRUE.</p>
</td></tr>
<tr><td><code id="f1.ld.f1_+3A_time.order">time.order</code></td>
<td>
<p>a character or numeric vector specifying the order of the time levels; the default option is NULL, in which case, the levels are in the order of the original data.</p>
</td></tr>
<tr><td><code id="f1.ld.f1_+3A_group.order">group.order</code></td>
<td>
<p>a character or numeric vector specifying the order of the group levels; the default option is NULL, in which case, the levels are in the order of the original data.</p>
</td></tr>
<tr><td><code id="f1.ld.f1_+3A_plot.rte">plot.RTE</code></td>
<td>
<p>an indicator for whether a plot of the relative treatment effect (RTE) should be shown; the default option is TRUE.</p>
</td></tr>
<tr><td><code id="f1.ld.f1_+3A_show.covariance">show.covariance</code></td>
<td>
<p>an indicator for whether the covariance matrix should be shown; the default option is FALSE, in which case, NULL is returned.</p>
</td></tr>
<tr><td><code id="f1.ld.f1_+3A_order.warning">order.warning</code></td>
<td>
<p>an indicator for whether a short description of the warning regarding the ordering of factors should be shown; the default option is TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The F1-LD-F1 design refers to the experimental design with one whole-plot factor and one sub-plot factor. A whole-plot factor refers to a factor effective for each subject at all times. A sub-plot factor refers to a factor effective at a single time point for all time curves and all subjects. See Brunner et al. (2002) for more examples.
</p>


<h3>Value</h3>

<p>A list with the following numeric components.
</p>
<table role = "presentation">
<tr><td><code>RTE</code></td>
<td>

<p>summary of the relative treatment effect (RTE) in a n-by-3 matrix form, where n is the total number of time points, group levels, and group-time interactions; the summary includes the mean of the ranks (RankMeans) in the 1st column, number of observations without counting the repeated measurements within the cell (Nobs) in the 2nd column, and the relative treatment effect (RTE) in the 3rd column.
</p>
</td></tr>
<tr><td><code>case2x2</code></td>
<td>
<p>the test statistic, corresponding p-value (approximated by standard normal distribution), degrees of freedom (df) for Student's t distribution, and corresponding p-value (approximated by Student's t distribution with the degrees of freedom in the previous column) for the 2-by-2 design with no missing observations. For the cases which do not use the 2-by-2 design, or when there is a missing value in the 2-by-2 design, case2x2 returns NULL.</p>
</td></tr>
<tr><td><code>Wald.test</code></td>
<td>
<p>the test statistic, degrees of freedom (df) for the central chi-square distribution, and corresponding p-value of the Wald-type test.</p>
</td></tr>
<tr><td><code>ANOVA.test</code></td>
<td>
<p>the test statistic, numerator degrees of freedom (df) for the central F distribution, and corresponding p-value of the ANOVA-type test; denominator degrees of freedom is set to infinity.</p>
</td></tr>
<tr><td><code>ANOVA.test.mod.Box</code></td>
<td>
<p>the test statistic, numerator and denominator degrees of freedom (df1, df2), respectively, for the central F distribution, and corresponding p-value of the ANOVA-type test for the whole-plot factor.</p>
</td></tr>
<tr><td><code>Wald.test.time</code></td>
<td>
<p>the test statistic and corresponding p-value of the Wald-type test with the hypothesis of no simple time effects.</p>
</td></tr>
<tr><td><code>ANOVA.test.time</code></td>
<td>
<p>the test statistic and corresponding p-value of the ANOVA-type test with the hypothesis of no simple time effects.</p>
</td></tr>
<tr><td><code>pattern.time</code></td>
<td>
<p>the test statistic, corresponding p-value (approximated by standard normal distribution), degrees of freedom (df) for Student's t distribution, and corresponding p-value (approximated by Student's t distribution with the degrees of freedom in the previous column) to test for patterned simple time effects. If the pattern (w.pat) is not specified, pattern.time returns NULL.</p>
</td></tr>
<tr><td><code>pair.comparison</code></td>
<td>
<p>the test statistic, degrees of freedom (df), and the corresponding p-value of the pairwise comparisons.</p>
</td></tr>
<tr><td><code>pattern.pair.comparison</code></td>
<td>
<p>the test statistic, corresponding p-value (approximated by standard normal distribution), degrees of freedom (df) for Student's t distribution, and corresponding p-value (approximated by Student's t distribution with the degrees of freedom in the previous column) to test for patterned interactions.</p>
</td></tr>
<tr><td><code>pattern.group</code></td>
<td>
<p>the test statistic, corresponding p-value (approximated by standard normal distribution), degrees of freedom (df) for Student's t distribution, and corresponding p-value (approximated by Student's t distribution with the degrees of freedom in the previous column) to test for patterned group effects.</p>
</td></tr>
<tr><td><code>covariance</code></td>
<td>
<p>the covariance matrix.</p>
</td></tr>
<tr><td><code>model.name</code></td>
<td>
<p>the name of the model used.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kimihiro Noguchi, Mahbub Latif, Frank Konietschke, Yulia Gel, Edgar Brunner</p>


<h3>References</h3>

<p>Box, G.E.P. (1954). Some theorems on quadratic forms applied in the study of analysis of variance problems, I. Effect of inequality of variance in the one-way classification. <em>Annals of Mathematical Statistics</em>, 25, 290-302.<br />
</p>
<p>Brunner, E., Domhof, S., and Langer, F. (2002). <em>Nonparametric Analysis of Longitudinal Data in Factorial Experiments</em>,
Wiley, New York.<br />
</p>
<p>Brunner, E. and Langer, F. (1999). <em>Nichtparametrische Analyse longitudinaler Daten</em>, 
R. Oldenbourg Verlag, Munchen Wien.<br />
</p>
<p>Noguchi, K., Gel, Y.R., Brunner, E., and Konietschke, F. (2012). 
nparLD: An R Software Package for the Nonparametric Analysis of Longitudinal Data in Factorial Experiments. 
<em>Journal of Statistical Software</em>, 50(12), 1-23.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+nparLD">nparLD</a></code>, <code><a href="#topic+ld.f1">ld.f1</a></code>, <code><a href="#topic+ld.f2">ld.f2</a></code>,
<code><a href="#topic+f1.ld.f2">f1.ld.f2</a></code>, <code><a href="#topic+f2.ld.f1">f2.ld.f1</a></code>, <code><a href="#topic+ld.ci">ld.ci</a></code>, 
<code><a href="#topic+tree">tree</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Example with the "Vitality of treetops" data ##
data(tree)
attach(tree)
w.t&lt;-c(1:4)
w.g&lt;-c(1:3)
w.pat &lt;- rbind(c(1:4), c(1:4), c(1:4))
ex.f1f1&lt;-f1.ld.f1(y=resp, time=time, group=group, subject=subject,
w.pat=w.pat, w.t=w.t, w.g=w.g, time.name="Year", group.name="Area",
description=FALSE, time.order=c(1,2,3,4), group.order=c("D0","D1","D2"))
# F1 LD F1 Model 
# ----------------------- 
# Check that the order of the time and group levels are correct.
# Time level:   1 2 3 4 
# Group level:   D0 D1 D2 
# If the order is not correct, specify the correct order in time.order or 
# group.order.

## Wald-type statistic 
ex.f1f1$Wald.test

#          Statistic df      p-value
#Area       4.510037  2 1.048716e-01
#Year      58.061097  3 1.525356e-12
#Area:Year 14.819966  6 2.170415e-02

## ANOVA-type statistic
ex.f1f1$ANOVA.test

#          Statistic       df      p-value
#Area       2.352854 1.968147 9.601181e-02
#Year      21.389142 2.729147 8.210954e-13
#Area:Year  3.113632 5.346834 6.768732e-03

## ANOVA-type statistic for the whole-plot factor
ex.f1f1$ANOVA.test.mod.Box

#     Statistic      df1     df2   p-value
#Area  2.352854 1.968147 64.3979 0.1040525
</code></pre>

<hr>
<h2 id='f1.ld.f2'>Nonparametric Tests for the F1-LD-F2 Design</h2><span id='topic+f1.ld.f2'></span>

<h3>Description</h3>

<p>This function performs several tests for the relative treatment effects with global or patterned alternatives for the F1-LD-F2 design (see Details for the definition). For the experiments with F1-LD-F2 design, the Wald-type statistic (WTS) and the ANOVA-type statistic (ATS) are calculated.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>f1.ld.f2(y, time1, time2, group, subject, time1.name="Time1", 
time2.name="Time2", group.name="Group", description=TRUE, 
time1.order=NULL, time2.order=NULL, group.order=NULL,
plot.RTE=TRUE, show.covariance=FALSE, order.warning=TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="f1.ld.f2_+3A_y">y</code></td>
<td>
<p>a vector of numeric variable of interest; missing values should be specified as NA.</p>
</td></tr>
<tr><td><code id="f1.ld.f2_+3A_time1">time1</code></td>
<td>
<p>a vector of the first sub-plot factor variable. See Details for more explanation.</p>
</td></tr>
<tr><td><code id="f1.ld.f2_+3A_time2">time2</code></td>
<td>
<p>a vector of the second sub-plot factor variable. See Details for more explanation.</p>
</td></tr>
<tr><td><code id="f1.ld.f2_+3A_group">group</code></td>
<td>
<p>a vector of the whole-plot factor variable. See Details for more explanation.</p>
</td></tr>
<tr><td><code id="f1.ld.f2_+3A_subject">subject</code></td>
<td>
<p>a vector of individual subjects.</p>
</td></tr>
<tr><td><code id="f1.ld.f2_+3A_time1.name">time1.name</code></td>
<td>
<p>a character vector specifying the name of the time1 vector; the default option is &quot;Treatment&quot;.</p>
</td></tr>
<tr><td><code id="f1.ld.f2_+3A_time2.name">time2.name</code></td>
<td>
<p>a character vector specifying the name of the time2 vector; the default option is &quot;Time&quot;.</p>
</td></tr>
<tr><td><code id="f1.ld.f2_+3A_group.name">group.name</code></td>
<td>
<p>a character vector specifying the name of the group vector; the default option is &quot;Group&quot;.</p>
</td></tr>
<tr><td><code id="f1.ld.f2_+3A_description">description</code></td>
<td>
<p>an indicator for whether a short description of the output should be shown; the default option is TRUE.</p>
</td></tr>
<tr><td><code id="f1.ld.f2_+3A_time1.order">time1.order</code></td>
<td>
<p>a character or numeric vector specifying the order of the time1 levels; the default option is NULL, in which case, the levels are in the order of the original data.</p>
</td></tr>
<tr><td><code id="f1.ld.f2_+3A_time2.order">time2.order</code></td>
<td>
<p>a character or numeric vector specifying the order of the time2 levels; the default option is NULL, in which case, the levels are in the order of the original data.</p>
</td></tr>
<tr><td><code id="f1.ld.f2_+3A_group.order">group.order</code></td>
<td>
<p>a character or numeric vector specifying the order of the group levels; the default option is NULL, in which case, the levels are in the order of the original data.</p>
</td></tr>
<tr><td><code id="f1.ld.f2_+3A_plot.rte">plot.RTE</code></td>
<td>
<p>an indicator for whether a plot of the relative treatment effect (RTE) should be shown; the default option is TRUE.</p>
</td></tr>
<tr><td><code id="f1.ld.f2_+3A_show.covariance">show.covariance</code></td>
<td>
<p>an indicator for whether the covariance matrix should be shown; the default option is FALSE, in which case, NULL is returned.</p>
</td></tr>
<tr><td><code id="f1.ld.f2_+3A_order.warning">order.warning</code></td>
<td>
<p>an indicator for whether a short description of the warning regarding the ordering of factors should be shown; the default option is TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The F1-LD-F2 design refers to the experimental design with one whole-plot factor and two sub-plot factors (where time2 is the stratification of time1). A whole-plot factor refers to a factor effective for each subject at all times. A sub-plot factor refers to a factor effective at a single time point for all time curves and all subjects. See Brunner et al. (2002) for more examples.
</p>


<h3>Value</h3>

<p>A list with the following numeric components.
</p>
<table role = "presentation">
<tr><td><code>RTE</code></td>
<td>

<p>summary of the relative treatment effect (RTE) in a n-by-3 matrix form, where n is the total number of time1, time2, and group levels, and group-time interactions; the summary includes the mean of the ranks (RankMeans) in the 1st column, number of observations without counting the repeated measurements within the cell (Nobs) in the 2nd column, and the relative treatment effect (RTE) in the 3rd column.
</p>
</td></tr>
<tr><td><code>Wald.test</code></td>
<td>
<p>the test statistic, degrees of freedom (df) for the central chi-square distribution, and corresponding p-value of the Wald-type test.</p>
</td></tr>
<tr><td><code>ANOVA.test</code></td>
<td>
<p>the test statistic, numerator degrees of freedom (df) for the central F distribution, and corresponding p-value of the ANOVA-type test; denominator degrees of freedom is set to infinity.</p>
</td></tr>
<tr><td><code>ANOVA.test.mod.Box</code></td>
<td>
<p>the test statistic, numerator and denominator degrees of freedom (df1, df2), respectively, for the central F distribution, and corresponding p-value of the ANOVA-type test for the whole-plot factor.</p>
</td></tr>
<tr><td><code>covariance</code></td>
<td>
<p>the covariance matrix.</p>
</td></tr>
<tr><td><code>model.name</code></td>
<td>
<p>the name of the model used.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Version 1.3 of the f1.ld.f2 function had problems with calculations of the statistics with unequal group sizes, and the issues have been resolved in Version 2.0. We would like to thank Dr. Fernando Marmolejo-Ramos for bringing this to our attention.
</p>


<h3>Author(s)</h3>

<p>Kimihiro Noguchi, Karthinathan Thangavelu, Frank Konietschke, Yulia Gel, Edgar Brunner</p>


<h3>References</h3>

<p>Brunner, E., Domhof, S., and Langer, F. (2002). <em>Nonparametric Analysis of Longitudinal Data in Factorial Experiments</em>,
Wiley, New York.<br />
</p>
<p>Brunner, E. and Langer, F. (1999). <em>Nichtparametrische Analyse longitudinaler Daten</em>, 
R. Oldenbourg Verlag, Munchen Wien.<br />
</p>
<p>Noguchi, K., Gel, Y.R., Brunner, E., and Konietschke, F. (2012). 
nparLD: An R Software Package for the Nonparametric Analysis of Longitudinal Data in Factorial Experiments. 
<em>Journal of Statistical Software</em>, 50(12), 1-23.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+nparLD">nparLD</a></code>, <code><a href="#topic+ld.f1">ld.f1</a></code>, <code><a href="#topic+ld.f2">ld.f2</a></code>, 
<code><a href="#topic+f1.ld.f1">f1.ld.f1</a></code>, <code><a href="#topic+f2.ld.f1">f2.ld.f1</a></code>, <code><a href="#topic+ld.ci">ld.ci</a></code>, 
<code><a href="#topic+edema">edema</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Example with the "Postoperative edema" data ##
data(edema)
attach(edema)
ex.f1f2&lt;-f1.ld.f2(y=resp, time1=time1, time2=time2, group=group, 
subject=subject, time1.name="Hand", time2.name="Day", group.name="Treatment",
description=FALSE, time1.order=c("Healthy","Operated"), time2.order=c(-1,1,3,5), 
group.order=c("Drug","Placebo"))
# F1 LD F2 Model 
# ----------------------- 
# Check that the order of the time1, time2, and group levels are correct.
# Time1 level:   Healthy Operated 
# Time2 level:   -1 1 3 5 
# Group level:   Drug Placebo 
# If the order is not correct, specify the correct order in time1.order, 
# time2.order, or group.order.

## Wald-type statistic 
ex.f1f2$Wald.test

#                    Statistic df      p-value
#Treatment           1.0725762  1 3.003643e-01
#Hand               25.8758257  1 3.641005e-07
#Day                36.8857947  3 4.864630e-08
#Treatment:Hand      0.3304448  1 5.653973e-01
#Day:Hand           47.3460508  3 2.933702e-10
#Treatment:Day       5.3048189  3 1.507900e-01
#Treatment:Hand:Day  1.6581652  3 6.462743e-01

## ANOVA-type statistic
ex.f1f2$ANOVA.test

#                    Statistic       df      p-value
#Treatment           1.0725762 1.000000 3.003643e-01
#Hand               25.8758257 1.000000 3.641005e-07
#Day                11.0630080 2.699667 9.661602e-07
#Treatment:Hand      0.3304448 1.000000 5.653973e-01
#Day:Hand           15.1854889 2.630202 6.184646e-09
#Treatment:Day       1.3342605 2.699667 2.625538e-01
#Treatment:Hand:Day  0.7170325 2.630202 5.242367e-01

## ANOVA-type statistic for the whole-plot factor
ex.f1f2$ANOVA.test.mod.Box

#          Statistic df1      df2   p-value
#Treatment  1.072576   1 55.80551 0.3048313
</code></pre>

<hr>
<h2 id='f2.ld.f1'>Nonparametric Tests for the F2-LD-F1 Design</h2><span id='topic+f2.ld.f1'></span>

<h3>Description</h3>

<p>This function performs several tests for the relative treatment effects with global or patterned alternatives for the F2-LD-F1 design (see Details for the definition). For the experiments with F2-LD-F1 design, the Wald-type statistic (WTS), the ANOVA-type statistic (ATS), and the modified ANOVA-type statistic with Box (1954) approximation are calculated for testing group and time effects, and interaction. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>f2.ld.f1(y, time, group1, group2, subject, time.name="Time", 
group1.name="GroupA", group2.name="GroupB", description=TRUE, 
time.order=NULL, group1.order=NULL, group2.order=NULL,
plot.RTE=TRUE, show.covariance=FALSE, order.warning=TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="f2.ld.f1_+3A_y">y</code></td>
<td>
<p>a vector of numeric variable of interest; missing values should be specified as NA.</p>
</td></tr>
<tr><td><code id="f2.ld.f1_+3A_time">time</code></td>
<td>
<p>a vector of the sub-plot factor variable. See Details for more explanation.</p>
</td></tr>
<tr><td><code id="f2.ld.f1_+3A_group1">group1</code></td>
<td>
<p>a vector of the first whole-plot factor variable. See Details for more explanation.</p>
</td></tr>
<tr><td><code id="f2.ld.f1_+3A_group2">group2</code></td>
<td>
<p>a vector of the second whole-plot factor variable. See Details for more explanation.</p>
</td></tr>
<tr><td><code id="f2.ld.f1_+3A_subject">subject</code></td>
<td>
<p>a vector of individual subjects</p>
</td></tr>
<tr><td><code id="f2.ld.f1_+3A_time.name">time.name</code></td>
<td>
<p>a character vector specifying the name of the time vector; the default option is &quot;Time&quot;.</p>
</td></tr>
<tr><td><code id="f2.ld.f1_+3A_group1.name">group1.name</code></td>
<td>
<p>a character vector specifying the name of the group1 vector; the default option is &quot;GroupA&quot;.</p>
</td></tr>
<tr><td><code id="f2.ld.f1_+3A_group2.name">group2.name</code></td>
<td>
<p>a character vector specifying  the name of the group2 vector; the default option is &quot;GroupB&quot;.</p>
</td></tr>
<tr><td><code id="f2.ld.f1_+3A_description">description</code></td>
<td>
<p>an indicator for whether a short description of the output should be shown; the default option is TRUE.</p>
</td></tr>
<tr><td><code id="f2.ld.f1_+3A_time.order">time.order</code></td>
<td>
<p>a character or numeric vector specifying the order of the time levels; the default option is NULL.</p>
</td></tr>
<tr><td><code id="f2.ld.f1_+3A_group1.order">group1.order</code></td>
<td>
<p>a character or numeric vector specifying the order of the time2 levels; the default option is NULL, in which case, the levels are in the order of the original data.</p>
</td></tr>
<tr><td><code id="f2.ld.f1_+3A_group2.order">group2.order</code></td>
<td>
<p>a character or numeric vector specifying the order of the group levels; the default option is NULL, in which case, the levels are in the order of the original data.</p>
</td></tr>
<tr><td><code id="f2.ld.f1_+3A_plot.rte">plot.RTE</code></td>
<td>
<p>an indicator for whether a plot of the relative treatment effect (RTE) should be shown; the default option is TRUE.</p>
</td></tr>
<tr><td><code id="f2.ld.f1_+3A_show.covariance">show.covariance</code></td>
<td>
<p>an indicator for whether the covariance matrix should be shown; the default option is FALSE, in which case, NULL is returned.</p>
</td></tr>
<tr><td><code id="f2.ld.f1_+3A_order.warning">order.warning</code></td>
<td>
<p>an indicator for whether a short description of the warning regarding the ordering of factors should be shown; the default option is TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The F2-LD-F1 design refers to the experimental design with two whole-plot factors (where group2 is the stratification of group1) and one sub-plot factor. A whole-plot factor refers to a factor effective for each subject at all times. A sub-plot factor refers to a factor effective at a single time point for all time curves and all subjects. See Brunner et al. (2002) for more examples.
</p>


<h3>Value</h3>

<p>A list with the following numeric components.
</p>
<table role = "presentation">
<tr><td><code>RTE</code></td>
<td>

<p>summary of the relative treatment effect (RTE) in a n-by-3 matrix form, where n is the total number of time, group1, and group2 levels, and group-time interactions; the summary includes the mean of the ranks (RankMeans) in the 1st column, number of observations without counting the repeated measurements within the cell (Nobs) in the 2nd column, and the relative treatment effect (RTE) in the 3rd column.
</p>
</td></tr>
<tr><td><code>Wald.test</code></td>
<td>
<p>the test statistic, degrees of freedom (df) for the central chi-square distribution, and corresponding p-value of the Wald-type test.</p>
</td></tr>
<tr><td><code>ANOVA.test</code></td>
<td>
<p>the test statistic, numerator degrees of freedom (df) for the central F distribution, and corresponding p-value of the ANOVA-type test; denominator degrees of freedom is set to infinity.</p>
</td></tr>
<tr><td><code>ANOVA.test.mod.Box</code></td>
<td>
<p>the test statistic, numerator and denominator degrees of freedom (df1, df2), respectively, for the central F distribution, and corresponding p-value of the ANOVA-type test for the whole-plot factors and their interaction.</p>
</td></tr>
<tr><td><code>covariance</code></td>
<td>
<p>the covariance matrix.</p>
</td></tr>
<tr><td><code>model.name</code></td>
<td>
<p>the name of the model used.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kimihiro Noguchi, Karthinathan Thangavelu, Frank Konietschke, Yulia Gel, Edgar Brunner</p>


<h3>References</h3>

<p>Box, G.E.P. (1954). Some theorems on quadratic forms applied in the study of analysis of variance problems, I. Effect of inequality of variance in the one-way classification. <em>Annals of Mathematical Statistics</em>, 25, 290-302.<br />
</p>
<p>Brunner, E., Domhof, S., and Langer, F. (2002). <em>Nonparametric Analysis of Longitudinal Data in Factorial Experiments</em>,
Wiley, New York.<br />
</p>
<p>Brunner, E. and Langer, F. (1999). <em>Nichtparametrische Analyse longitudinaler Daten</em>, 
R. Oldenbourg Verlag, Munchen Wien.<br />
</p>
<p>Noguchi, K., Gel, Y.R., Brunner, E., and Konietschke, F. (2012). 
nparLD: An R Software Package for the Nonparametric Analysis of Longitudinal Data in Factorial Experiments. 
<em>Journal of Statistical Software</em>, 50(12), 1-23.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+nparLD">nparLD</a></code>, <code><a href="#topic+ld.f1">ld.f1</a></code>, <code><a href="#topic+ld.f2">ld.f2</a></code>, 
<code><a href="#topic+f1.ld.f1">f1.ld.f1</a></code>, <code><a href="#topic+f1.ld.f2">f1.ld.f2</a></code>, <code><a href="#topic+ld.ci">ld.ci</a></code>, 
<code><a href="#topic+shoulder">shoulder</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Example with the "Shoulder tip pain study" data ##
data(shoulder)
attach(shoulder)
ex.f2f1&lt;-f2.ld.f1(y=resp, time=time, group1=group1, group2=group2, 
subject=subject, time.name="Time", group1.name="Treatment", 
group2.name="Gender", description=FALSE, time.order=c(1,2,3,4,5,6), 
group1.order=c("Y","N"), group2.order=c("F","M"))
# F2 LD F1 Model 
# ----------------------- 
# Check that the order of the time, group1, and group2 levels are correct.
# Time level:   1 2 3 4 5 6 
# Group1 level:   Y N 
# Group2 level:   F M 
# If the order is not correct, specify the correct order in time.order, 
# group1.order, or group2.order.
#
#
# Warning(s):
# The covariance matrix is singular. 

## Wald-type statistic 
ex.f2f1$Wald.test

#                        Statistic df      p-value
#Treatment             16.40129021  1 5.125033e-05
#Gender                 0.04628558  1 8.296575e-01
#Time                  16.34274332  5 5.930698e-03
#Treatment:Gender       0.03583558  1 8.498554e-01
#Treatment:Time        27.51450085  5 4.527996e-05
#Gender:Time           12.37903186  5 2.994753e-02
#Treatment:Gender:Time  5.11864769  5 4.015727e-01

## ANOVA-type statistic
ex.f2f1$ANOVA.test

#                        Statistic       df      p-value
#Treatment             16.40129021 1.000000 5.125033e-05
#Gender                 0.04628558 1.000000 8.296575e-01
#Time                   3.38218704 2.700754 2.120366e-02
#Treatment:Gender       0.03583558 1.000000 8.498554e-01
#Treatment:Time         3.71077200 2.700754 1.398190e-02
#Gender:Time            1.14434841 2.700754 3.272967e-01
#Treatment:Gender:Time  0.43755394 2.700754 7.054255e-01

## ANOVA-type statistic for the whole-plot factors and 
## their interaction
ex.f2f1$ANOVA.test.mod.Box
#                   Statistic df1      df2      p-value
#Treatment        16.40129021   1 21.86453 0.0005395379
#Gender            0.04628558   1 21.86453 0.8316516274
#Treatment:Gender  0.03583558   1 21.86453 0.8516017168
</code></pre>

<hr>
<h2 id='ld.ci'>Confidence Intervals for the Relative Treatment Effects</h2><span id='topic+ld.ci'></span>

<h3>Description</h3>

<p>This function performs calculations of the two-sided confidence intervals for the relative treatment effects of the factors specified. The function performs calculations only if no observations are missing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ld.ci(y, time, subject, group=NULL, alpha=0.05, time.name="Time", 
group.name="Group", description=TRUE, time.order=NULL, group.order=NULL,
rounds=4, plot.CI=TRUE, order.warning=TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ld.ci_+3A_y">y</code></td>
<td>
<p>a vector of numeric variable of interest.</p>
</td></tr>
<tr><td><code id="ld.ci_+3A_time">time</code></td>
<td>
<p>a vector of the sub-plot factor variable. See Details for more explanation.</p>
</td></tr>
<tr><td><code id="ld.ci_+3A_subject">subject</code></td>
<td>
<p>a vector of individual subjects.</p>
</td></tr>
<tr><td><code id="ld.ci_+3A_group">group</code></td>
<td>
<p>a vector of the whole-plot factor variable; the default option is NULL. See Details for more explanation.</p>
</td></tr>
<tr><td><code id="ld.ci_+3A_alpha">alpha</code></td>
<td>
<p>a numeric specifying the significance level of the confidence intervals; the default option is 0.05.</p>
</td></tr>
<tr><td><code id="ld.ci_+3A_time.name">time.name</code></td>
<td>
<p>a vector of the sub-plot factor variable.</p>
</td></tr>
<tr><td><code id="ld.ci_+3A_group.name">group.name</code></td>
<td>
<p>a vector of the whole-plot factor variable.</p>
</td></tr>
<tr><td><code id="ld.ci_+3A_description">description</code></td>
<td>
<p>an indicator for whether a short description of the output should be shown; the default option is TRUE.</p>
</td></tr>
<tr><td><code id="ld.ci_+3A_time.order">time.order</code></td>
<td>
<p>a character or numeric vector specifying the order of the time levels; the default option is NULL, in which case, the levels are in the order of the original data.</p>
</td></tr>
<tr><td><code id="ld.ci_+3A_group.order">group.order</code></td>
<td>
<p>a character or numeric vector specifying the order of the group levels; the default option is NULL, in which case, the levels are in the order of the original data.</p>
</td></tr>
<tr><td><code id="ld.ci_+3A_rounds">rounds</code></td>
<td>
<p>a numeric specifying the number of digits to be displayed.</p>
</td></tr>
<tr><td><code id="ld.ci_+3A_plot.ci">plot.CI</code></td>
<td>
<p>an indicator for whether a plot of the confidence interval (CI) should be shown; the default option is TRUE.</p>
</td></tr>
<tr><td><code id="ld.ci_+3A_order.warning">order.warning</code></td>
<td>
<p>an indicator for whether a short description of the warning regarding the ordering of factors should be shown; the default option is TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A whole-plot factor refers to a factor effective for each subject at all times. A sub-plot factor refers to a factor effective at a single time point for all time curves and all subjects. See Brunner et al. (2002) for more examples. Also, note that the interval for the relative treatment effects can only be interpreted as a confidence interval when the sample sample sizes are (approximately) the same (pp.60, Brunner et al., 2002).<br />
</p>
<p>The function returns a list with the following numeric components: the relative treatment effect (RTE), bias estimation (Bias), variance estimation (Variance), the lower and upper bound of the RTE (Lower bound, Upper bound, respectively), in the form of an n-by-9 data frame where n is the number of group factor levels times the number of time factor levels.
</p>


<h3>Author(s)</h3>

<p>Kimihiro Noguchi, Karthinathan Thangavelu, Frank Konietschke, Yulia Gel, Edgar Brunner</p>


<h3>References</h3>

<p>Brunner, E., Domhof, S., and Langer, F. (2002). <em>Nonparametric Analysis of Longitudinal Data in Factorial Experiments</em>,
Wiley, New York.<br />
</p>
<p>Brunner, E. and Langer, F. (1999). <em>Nichtparametrische Analyse longitudinaler Daten</em>, 
R. Oldenbourg Verlag, Munchen Wien.<br />
</p>
<p>Noguchi, K., Gel, Y.R., Brunner, E., and Konietschke, F. (2012). 
nparLD: An R Software Package for the Nonparametric Analysis of Longitudinal Data in Factorial Experiments. 
<em>Journal of Statistical Software</em>, 50(12), 1-23.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+nparLD">nparLD</a></code>, <code><a href="#topic+ld.f1">ld.f1</a></code>, <code><a href="#topic+ld.f2">ld.f2</a></code>, 
<code><a href="#topic+f1.ld.f1">f1.ld.f1</a></code>, <code><a href="#topic+f1.ld.f2">f1.ld.f2</a></code>, <code><a href="#topic+f2.ld.f1">f2.ld.f1</a></code>, 
<code><a href="#topic+shoulder">shoulder</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Example with the "Shoulder tip pain study" data ##
data(shoulder)
attach(shoulder)
group&lt;-paste(group1, group2, sep="")
ex.ci&lt;-ld.ci(y=resp, time=time, subject=subject, group=group, alpha=0.05, 
time.name="Time", group.name="Group", description=FALSE, time.order=c(1,2,3,4,5,6), 
group.order=c("YF","YM","NF","NM"))
# LD CI Calculations 
# ----------------------- 
# Order of the time and group levels.
# Time level:   1 2 3 4 5 6 
# Group level:   YF YM NF NM 
# The order may be specified in time.order or group.order.

## Summary of the output
ex.ci

#     Group Time Nobs RankMeans    RTE    Bias Variance  Lower  Upper
#1  GroupYF    1   14  123.9643 0.5019  0.0008   0.1680 0.3792 0.6243
#2  GroupYF    2   14  100.2857 0.4056  0.0003   0.1366 0.3000 0.5222
#3  GroupYF    3   14   89.2500 0.3608 -0.0005   0.0979 0.2722 0.4615
#4  GroupYF    4   14  101.4643 0.4104  0.0000   0.1136 0.3131 0.5164
#5  GroupYF    5   14   72.1071 0.2911 -0.0004   0.0389 0.2351 0.3554
#6  GroupYF    6   14   84.3214 0.3407 -0.0002   0.0808 0.2605 0.4329
#7  GroupYM    1    8  107.4375 0.4347 -0.0002   0.3093 0.2786 0.6060
#8  GroupYM    2    8  113.4375 0.4591  0.0002   0.2607 0.3120 0.6142
#9  GroupYM    3    8   87.3750 0.3532  0.0001   0.1464 0.2471 0.4774
#10 GroupYM    4    8   76.6875 0.3097  0.0002   0.0873 0.2277 0.4070
#11 GroupYM    5    8   92.0625 0.3722 -0.0001   0.2011 0.2487 0.5167
#12 GroupYM    6    8   92.0625 0.3722 -0.0001   0.2011 0.2487 0.5167
#13 GroupNF    1   11  154.3636 0.6255  0.0004   0.2954 0.4500 0.7708
#14 GroupNF    2   11  174.3636 0.7068  0.0007   0.1890 0.5573 0.8188
#15 GroupNF    3   11  162.4545 0.6584 -0.0001   0.1941 0.5130 0.7768
#16 GroupNF    4   11  182.2273 0.7387  0.0007   0.1704 0.5926 0.8425
#17 GroupNF    5   11  146.8182 0.5948  0.0001   0.2383 0.4408 0.7307
#18 GroupNF    6   11  133.5000 0.5407 -0.0018   0.1531 0.4208 0.6555
#19 GroupNM    1    8  126.7500 0.5132 -0.0005   0.3339 0.3422 0.6810
#20 GroupNM    2    8  168.6250 0.6834  0.0005   0.2855 0.5021 0.8196
#21 GroupNM    3    8  176.5000 0.7154  0.0016   0.3400 0.5090 0.8555
#22 GroupNM    4    8  172.5625 0.6994  0.0013   0.3102 0.5066 0.8376
#23 GroupNM    5    8  150.0000 0.6077 -0.0003   0.3585 0.4175 0.7683
#24 GroupNM    6    8  122.8125 0.4972 -0.0025   0.2469 0.3502 0.6447
</code></pre>

<hr>
<h2 id='ld.f1'>Nonparametric Tests for the LD-F1 Design</h2><span id='topic+ld.f1'></span>

<h3>Description</h3>

<p>This function performs several tests for the relative treatment effects with global or patterned alternatives for the LD-F1 design (see Details for the definition). For the experiments with LD-F1 design, the Wald-type statistic (WTS), Hotelling's F (T-squared) statistic, and the ANOVA-type statistic (ATS) are calculated for the global alternatives. The hypothesis can also be tested against patterned alternatives to detect various trends. For the design with two time points where no data are missing, tests under Behrens-Fisher and homogeneous variance situations can be performed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ld.f1(y, time, subject, w.pat=NULL, time.name="Time", description=TRUE, 
time.order=NULL, plot.RTE=TRUE, show.covariance=FALSE, order.warning=TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ld.f1_+3A_y">y</code></td>
<td>
<p>a vector of numeric variable of interest; missing values should be specified as NA.</p>
</td></tr>
<tr><td><code id="ld.f1_+3A_time">time</code></td>
<td>
<p>a vector of the sub-plot factor variable. See Details for more explanation.</p>
</td></tr>
<tr><td><code id="ld.f1_+3A_subject">subject</code></td>
<td>
<p>a vector of individual subjects</p>
</td></tr>
<tr><td><code id="ld.f1_+3A_w.pat">w.pat</code></td>
<td>
<p>a vector of pattern for the pattern alternatives; the default option is NULL. The length, if specified, must be equal to the number of time levels.</p>
</td></tr>
<tr><td><code id="ld.f1_+3A_time.name">time.name</code></td>
<td>
<p>a character vector specifying the name of the time vector; the default option is &quot;Time&quot;.</p>
</td></tr> 
<tr><td><code id="ld.f1_+3A_description">description</code></td>
<td>
<p>an indicator for whether a short description of the output should be shown; the default option is TRUE.</p>
</td></tr>
<tr><td><code id="ld.f1_+3A_time.order">time.order</code></td>
<td>
<p>a character or numeric vector specifying the order of the time levels; the default option is NULL, in which case, the levels are in the order of the original data.</p>
</td></tr>
<tr><td><code id="ld.f1_+3A_plot.rte">plot.RTE</code></td>
<td>
<p>an indicator for whether a plot of the relative treatment effect (RTE) should be shown; the default option is TRUE.</p>
</td></tr>
<tr><td><code id="ld.f1_+3A_show.covariance">show.covariance</code></td>
<td>
<p>an indicator for whether the covariance matrix should be shown; the default option is FALSE, in which case, NULL is returned.</p>
</td></tr>
<tr><td><code id="ld.f1_+3A_order.warning">order.warning</code></td>
<td>
<p>an indicator for whether a short description of the warning regarding the ordering of factors should be shown; the default option is TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The LD-F1 design refers to the experimental design with one sub-plot factor (longitudinal data for one homogeneous group of subjects). A sub-plot factor refers to a factor effective at a single time point for all time curves and all subjects. See Brunner et al. (2002) for more examples.
</p>


<h3>Value</h3>

<p>A list with the following numeric components.
</p>
<table role = "presentation">
<tr><td><code>RTE</code></td>
<td>

<p>summary of the relative treatment effect (RTE) in a n-by-3 matrix form, where n is the number of time vector levels; the summary includes the mean of the ranks (RankMeans) in the 1st column, number of observations without counting the repeated measurements within the cell (Nobs) in the 2nd column, and the relative treatment effect (RTE) in the 3rd column.
</p>
</td></tr>
<tr><td><code>Wald.test</code></td>
<td>
<p>the test statistic, degrees of freedom (df) for the central chi-square distribution, and corresponding p-value of the Wald-type test.</p>
</td></tr>
<tr><td><code>Hotelling.test</code></td>
<td>
<p>the test statistic, numerator and denominator degrees of freedom (df1, df2), respectively, for the central F distribution, and corresponding p-value of the Hotelling's F (T-squared) test.</p>
</td></tr>
<tr><td><code>ANOVA.test</code></td>
<td>
<p>the test statistic, numerator degrees of freedom (df) for the central F distribution, and corresponding p-value of the ANOVA-type test; denominator degrees of freedom is set to infinity.</p>
</td></tr>
<tr><td><code>two.sample.test</code></td>
<td>
<p>the test statistic and corresponding p-values (approximated by standard normal and Student's t distributions) of the test under homogeneous variance situation.</p>
</td></tr>
<tr><td><code>two.sample.BF.test</code></td>
<td>
<p>the test statistic and corresponding p-values (approximated by standard normal (N) and Student's t distributions (T)) of the test under the Behrens-Fisher situation where variances of the two samples are not assumed to be equal.</p>
</td></tr>
<tr><td><code>pattern.test</code></td>
<td>
<p>the test statistic and corresponding p-values (approximated by standard normal (N) and Student's t distributions (T)) of the test with patterned alternatives where the patterns are specified by w.pat.</p>
</td></tr>
<tr><td><code>covariance</code></td>
<td>
<p>the covariance matrix.</p>
</td></tr>
<tr><td><code>model.name</code></td>
<td>
<p>the name of the model used.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>If there are more than two time points in the data, or if there is a missing observation, two.sample.test and two.sample.BF.test return NULL. 
If the denominator degrees of freedom (df2) is less than 1, Hotelling.test returns NULL.
</p>


<h3>Author(s)</h3>

<p>Kimihiro Noguchi, Mahbub Latif, Frank Konietschke, Yulia Gel, Edgar Brunner</p>


<h3>References</h3>

<p>Brunner, E., Domhof, S., and Langer, F. (2002). <em>Nonparametric Analysis of Longitudinal Data in Factorial Experiments</em>,
Wiley, New York.<br />
</p>
<p>Brunner, E. and Langer, F. (1999). <em>Nichtparametrische Analyse longitudinaler Daten</em>, 
R. Oldenbourg Verlag, Munchen Wien.<br />
</p>
<p>Noguchi, K., Gel, Y.R., Brunner, E., and Konietschke, F. (2012). 
nparLD: An R Software Package for the Nonparametric Analysis of Longitudinal Data in Factorial Experiments. 
<em>Journal of Statistical Software</em>, 50(12), 1-23.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+nparLD">nparLD</a></code>, <code><a href="#topic+ld.f2">ld.f2</a></code>, <code><a href="#topic+f1.ld.f1">f1.ld.f1</a></code>, 
<code><a href="#topic+f1.ld.f2">f1.ld.f2</a></code>, <code><a href="#topic+f2.ld.f1">f2.ld.f1</a></code>, <code><a href="#topic+ld.ci">ld.ci</a></code>, 
<code><a href="#topic+panic">panic</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Example with the "Panic disorder study I" data ##
data(panic)
attach(panic)
w.pat&lt;-c(5,4,3,2,5)
ex.f1&lt;-ld.f1(y=resp, time=time, subject=subject, w.pat=w.pat, time.name="Week", 
description=FALSE, time.order=c(0,2,4,6,8))
# LD F1 Model 
# ----------------------- 
# Check that the order of the time level is correct.
# Time level:   0 2 4 6 8 
# If the order is not correct, specify the correct order in time.order.

## Wald-type statistic 
ex.f1$Wald.test

#     Statistic df p-value
#Week  126.6946  4 1.9822e-26

## ANOVA-type statistic
ex.f1$ANOVA.test

#     Statistic       df p-value
#Week  36.93664 2.234135 1.975781e-18
</code></pre>

<hr>
<h2 id='ld.f2'>Nonparametric Tests for the LD-F2 Design</h2><span id='topic+ld.f2'></span>

<h3>Description</h3>

<p>This function performs several tests for the relative treatment effects for the LD-F2 design (see Details for the definition). The Wald-type statistic (WTS) and the ANOVA-type statistic (ATS) are calculated for each of the two sub-plot factors as well as their interaction.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ld.f2(y, time1, time2, subject, time1.name="Treatment", 
time2.name="Time", description=TRUE, time1.order=NULL, 
time2.order=NULL, plot.RTE=TRUE, show.covariance=FALSE,
order.warning=TRUE) 
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ld.f2_+3A_y">y</code></td>
<td>
<p>a vector of numeric variable of interest; missing values should be specified as NA.</p>
</td></tr>
<tr><td><code id="ld.f2_+3A_time1">time1</code></td>
<td>
<p>a vector of the first sub-plot factor variable. See Details for more explanation.</p>
</td></tr>
<tr><td><code id="ld.f2_+3A_time2">time2</code></td>
<td>
<p>a vector of the second sub-plot factor variable. See Details for more explanation.</p>
</td></tr>
<tr><td><code id="ld.f2_+3A_subject">subject</code></td>
<td>
<p>a vector of individual subjects.</p>
</td></tr>
<tr><td><code id="ld.f2_+3A_time1.name">time1.name</code></td>
<td>
<p>a character vector specifying the name of the time1 vector; the default option is &quot;Treatment&quot;.</p>
</td></tr>
<tr><td><code id="ld.f2_+3A_time2.name">time2.name</code></td>
<td>
<p>a character vector specifying the name of the time2 vector; the default option is &quot;Time&quot;.</p>
</td></tr>
<tr><td><code id="ld.f2_+3A_description">description</code></td>
<td>
<p>an indicator for whether a short description of the output should be shown; the default option is TRUE.</p>
</td></tr>
<tr><td><code id="ld.f2_+3A_time1.order">time1.order</code></td>
<td>
<p>a character or numeric vector specifying the order of the time1 levels; the default option is NULL, in which case, the levels are in the order of the original data.</p>
</td></tr>
<tr><td><code id="ld.f2_+3A_time2.order">time2.order</code></td>
<td>
<p>a character or numeric vector specifying the order of the time2 levels; the default option is NULL, in which case, the levels are in the order of the original data.</p>
</td></tr>
<tr><td><code id="ld.f2_+3A_plot.rte">plot.RTE</code></td>
<td>
<p>an indicator for whether a plot of the relative treatment effect (RTE) should be shown; the default option is TRUE.</p>
</td></tr>
<tr><td><code id="ld.f2_+3A_show.covariance">show.covariance</code></td>
<td>
<p>an indicator for whether the covariance matrix should be shown; the default option is FALSE, in which case, NULL is returned.</p>
</td></tr>
<tr><td><code id="ld.f2_+3A_order.warning">order.warning</code></td>
<td>
<p>an indicator for whether a short description of the warning regarding the ordering of factors should be shown; the default option is TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The LD-F2 design refers to the experimental design with two sub-plot factors (longitudinal data for one homogeneous group of subjects and an underlying structure in the time where time2 is the stratification of time1). A sub-plot factor refers to a factor effective at a single time point for all time curves and all subjects. See Brunner et al. (2002) for more examples.
</p>


<h3>Value</h3>

<p>A list with the following numeric components.
</p>
<table role = "presentation">
<tr><td><code>RTE</code></td>
<td>

<p>summary of the relative treatment effect (RTE) in a n-by-3 matrix form, where n is the total of number of time1 and time2 levels, and their interactions; the summary includes the mean of the ranks (RankMeans) in the 1st column, number of observations without counting the repeated measurements within the cell (Nobs) in the 2nd column, and the relative treatment effect (RTE) in the 3rd column.
</p>
</td></tr>
<tr><td><code>Wald.test</code></td>
<td>
<p>the test statistic, degrees of freedom (df) for the central chi-square distribution, and corresponding p-value of the Wald-type test.</p>
</td></tr>
<tr><td><code>ANOVA.test</code></td>
<td>
<p>the test statistic, numerator degrees of freedom (df) for the central F distribution, and corresponding p-value of the ANOVA-type test; denominator degrees of freedom is set to infinity.</p>
</td></tr>
<tr><td><code>covariance</code></td>
<td>
<p>the covariance matrix.</p>
</td></tr>
<tr><td><code>model.name</code></td>
<td>
<p>the name of the model used.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Version 1.0 of the ld.f2 function had problems with calculations of the statistics, and the issues have been resolved in Version 1.1. We would like to thank Dr. Stefano Burigat for pointing out the problems.
</p>


<h3>Author(s)</h3>

<p>Kimihiro Noguchi, Karthinathan Thangavelu, Frank Konietschke, Yulia Gel, Edgar Brunner</p>


<h3>References</h3>

<p>Brunner, E., Domhof, S., and Langer, F. (2002). <em>Nonparametric Analysis of Longitudinal Data in Factorial Experiments</em>,
Wiley, New York.<br />
</p>
<p>Brunner, E. and Langer, F. (1999). <em>Nichtparametrische Analyse longitudinaler Daten</em>, 
R. Oldenbourg Verlag, Munchen Wien.<br />
</p>
<p>Noguchi, K., Gel, Y.R., Brunner, E., and Konietschke, F. (2012). 
nparLD: An R Software Package for the Nonparametric Analysis of Longitudinal Data in Factorial Experiments. 
<em>Journal of Statistical Software</em>, 50(12), 1-23.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+nparLD">nparLD</a></code>, <code><a href="#topic+ld.f1">ld.f1</a></code>, <code><a href="#topic+f1.ld.f1">f1.ld.f1</a></code>, 
<code><a href="#topic+f1.ld.f2">f1.ld.f2</a></code>, <code><a href="#topic+f2.ld.f1">f2.ld.f1</a></code>, <code><a href="#topic+ld.ci">ld.ci</a></code>, 
<code><a href="#topic+amylase">amylase</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Example with the "Alpha-amylase study" data ##
data(amylase)
attach(amylase)
ex.f2&lt;-ld.f2(y=resp, time1=time1, time2=time2, subject=subject,
time1.name="Day", time2.name="Time", description=FALSE, 
time1.order=c("M","T"), time2.order=c(8,12,17,21))
# LD F2 Model 
# ----------------------- 
# Check that the order of the time1 and time2 levels are correct.
# Time1 level:   M T 
# Time2 level:   8 12 17 21 
# If the order is not correct, specify the correct order in time1.order and 
# time2.order.

## Wald-type statistic 
ex.f2$Wald.test

#          Statistic df      p-value
#Day       0.6761043  1 4.109314e-01
#Time     35.8647640  3 7.997949e-08
#Day:Time 14.3020921  3 2.521503e-03

## ANOVA-type statistic
ex.f2$ANOVA.test

#          Statistic       df      p-value
#Day       0.6761043 1.000000 4.109314e-01
#Time     14.2671950 2.858344 5.860479e-09
#Day:Time  5.2242782 2.184249 4.150298e-03
</code></pre>

<hr>
<h2 id='panic'>Panic disorder study I</h2><span id='topic+panic'></span>

<h3>Description</h3>

<p>Measurements of the degree of illness on a CGI scale for a group of patients suffering from panic disorder and agoraphobia.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(panic)</code></pre>


<h3>Format</h3>

<p>Longitudinal data of 16 patients with CGI scores taken on 5 occasions.
</p>


<h3>Details</h3>

<p>A group of 16 patients from panic disorder and agoraphobia were treated with anti-depressant imipramin over a period of eight weeks. Measurements on a discrete scale of scores between 2 and 8 were taken (2=not ill through 8=extremely ill) on 5 occasions (0=baseline, 2=after two weeks, 4=after four weeks,...).
</p>


<h3>References</h3>

<p>Brunner, E., Domhof, S., and Langer, F. (2002). <em>Nonparametric Analysis of Longitudinal Data in Factorial Experiments</em>,
Wiley, New York.<br />
</p>
<p>Brunner, E. and Langer, F. (1999). <em>Nichtparametrische Analyse longitudinaler Daten</em>, 
R. Oldenbourg Verlag, Munchen Wien.<br />
</p>
<p>Noguchi, K., Gel, Y.R., Brunner, E., and Konietschke, F. (2012). 
nparLD: An R Software Package for the Nonparametric Analysis of Longitudinal Data in Factorial Experiments. 
<em>Journal of Statistical Software</em>, 50(12), 1-23.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Analysis using LD-F1 design ##
data(panic)
attach(panic)
w.pat&lt;-c(5,4,3,2,5)
ex.f1&lt;-ld.f1(y=resp, time=time, subject=subject, w.pat=w.pat, time.name="Week", 
description=FALSE)
# LD F1 Model 
# ----------------------- 
# Check that the order of the time level is correct.
# Time level:   0 2 4 6 8 
# If the order is not correct, specify the correct order in time.order.

## Wald-type statistic 
ex.f1$Wald.test

#     Statistic df p-value
#Week  126.6946  4 1.9822e-26

## ANOVA-type statistic
ex.f1$ANOVA.test

#     Statistic       df p-value
#Week  36.93664 2.234135 1.975781e-18
</code></pre>

<hr>
<h2 id='panic2'>Panic disorder study II</h2><span id='topic+panic2'></span>

<h3>Description</h3>

<p>Measurements of the degree of illness on a P&amp;A scale for a group of patients suffering from panic disorder with or without agoraphobia.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(panic2)</code></pre>


<h3>Format</h3>

<p>Longitudinal data of 37 patients with P&amp;A scores taken on 5 occasions.
</p>


<h3>Details</h3>

<p>A group of 37 patients with a panic disorder with/without agoraphobia was treated with anti-depressant imipramin over a period of eight weeks. The severity of the panic disorder was determined at five different occasions in increments of two weeks (0=baseline, 2=after two weeks, 4=after four weeks,...) using the new P&amp;A scale (Bandelow, 1995, 1999), a discrete scale assigning to each patient a value between 0 and 52. Aim of this study was to determine whether a patient's improvement as measured by the P&amp;A scale was different depending on whether or not the patient suffered from agoraphobia (w=with agoraphobia, wo=without agoraphobia).
</p>


<h3>References</h3>

<p>Bandelow, B. (1995). Assessing the efficacy of treatments for panic disorder and agoraphobia, II. The Panic and Agoraphobia Scale. <em>International Journal of Clinical Psychopharmacology</em> 10, 73 2.<br />
</p>
<p>Bandelow, B. (1999). <em>Panic and Agoraphobia Scale (PAS)</em>. Hogrefe &amp; Huber, Goettingen.<br />
</p>
<p>Brunner, E., Domhof, S., and Langer, F. (2002). <em>Nonparametric Analysis of Longitudinal Data in Factorial Experiments</em>,
Wiley, New York.<br />
</p>
<p>Brunner, E. and Langer, F. (1999). <em>Nichtparametrische Analyse longitudinaler Daten</em>, 
R. Oldenbourg Verlag, Munchen Wien.<br />
</p>
<p>Noguchi, K., Gel, Y.R., Brunner, E., and Konietschke, F. (2012). 
nparLD: An R Software Package for the Nonparametric Analysis of Longitudinal Data in Factorial Experiments. 
<em>Journal of Statistical Software</em>, 50(12), 1-23.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Analysis using F1-LD-F1 design ##
data(panic2)
attach(panic2)
w.t&lt;-c(1:5)
w.g&lt;-c(1:2)
w.pat&lt;-rbind(c(1:5), c(1:5))
ex.f1f1.2&lt;-f1.ld.f1(y=resp, time=time, group=group, subject=subject, w.pat=w.pat, 
w.t=w.t, w.g=w.g, time.name="Week", group.name="Agoraphobia", description=FALSE)
# F1 LD F1 Model 
# ----------------------- 
# Check that the order of the time and group levels are correct.
# Time level:   0 2 4 6 8 
# Group level:   w wo 
# If the order is not correct, specify the correct order in time.order or 
# group.order.

## Wald-type statistic
ex.f1f1.2$Wald.test

#              	   Statistic df     p-value
#Agoraphobia        8.427367  1 3.696152e-03
#Week             119.793400  4 5.912722e-25
#Agoraphobia:Week  13.493440  4 9.100275e-03

## ANOVA-type statistic
ex.f1f1.2$ANOVA.test

#           	  Statistic       df     p-value
#Agoraphobia       8.427367 1.000000 3.696152e-03
#Week             32.089272 2.693506 7.109822e-19
#Agoraphobia:Week  1.751998 2.693506 1.599706e-01

## ANOVA-type statistic for the whole-plot factor
ex.f1f1.2$ANOVA.test.mod.Box

#            Statistic df1      df2     p-value
#Agoraphobia  8.427367   1 28.62587 0.007044246
</code></pre>

<hr>
<h2 id='plasma'>Plasma-renin study</h2><span id='topic+plasma'></span>

<h3>Description</h3>

<p>Measurements of the plasma-renin activity (PRA) (in ng/ml/h) for agroup of healthy non-smokers aged 21-30 years
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(plasma)</code></pre>


<h3>Format</h3>

<p>Longitudinal data of 49 subjects with PRA measurements taken on 5 occasions.
</p>


<h3>Details</h3>

<p>In a randomized, controlled study of 49 subjects (healthy non-smokers, aged 21-30 years) 750 ml of blood was removed and replaced with 1000 ml of a physiological electrolyte solution, together with one of four drugs (propanolol: 10 subjects, dobutamine: 13 subjects, fenoterol: 13 subjects, placebo: 13 subjects). Three of the original 13 subjects in the propanolol group fell ill and were unable to continue their participation in the study. The plasma-renin activity (PRA) was measured on five occasions (after 0, 2, 6, 8, 12 hours) and determined by means of blood test. One of the aims of the study was to analyze the extent to which PRA was increased or reduced by the drug.
</p>


<h3>References</h3>

<p>Brunner, E., Domhof, S., and Langer, F. (2002). <em>Nonparametric Analysis of Longitudinal Data in Factorial Experiments</em>,
Wiley, New York.<br />
</p>
<p>Brunner, E. and Langer, F. (1999). <em>Nichtparametrische Analyse longitudinaler Daten</em>, 
R. Oldenbourg Verlag, Munchen Wien.<br />
</p>
<p>Noguchi, K., Gel, Y.R., Brunner, E., and Konietschke, F. (2012). 
nparLD: An R Software Package for the Nonparametric Analysis of Longitudinal Data in Factorial Experiments. 
<em>Journal of Statistical Software</em>, 50(12), 1-23.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Analysis using F1-LD-F1 design ##
data(plasma)
attach(plasma)
w.t&lt;-c(1:5)
w.g&lt;-c(1:4)
w.pat&lt;-rbind(c(1:5), c(1:5), c(1:5), c(1:5))
ex.f1f1.3&lt;-f1.ld.f1(y=resp, time=time, group=group, subject=subject, 
w.pat=w.pat, w.t=w.t, w.g=w.g, time.name="Hour", group.name="Drug", 
description=FALSE)
# F1 LD F1 Model 
# ----------------------- 
# Check that the order of the time and group levels are correct.
# Time level:   0 2 6 8 12 
# Group level:   Propanolol Dobutamine Fenoterol Placebo 
# If the order is not correct, specify the correct order in time.order or 
# group.order.

## Wald-type statistic
ex.f1f1.3$Wald.test

#          Statistic df      p-value
#Drug       128.6257  3 1.069606e-27
#Hour       235.4921  4 8.672886e-50
#Drug:Hour  163.9275 12 8.307977e-29

## ANOVA-type statistic
ex.f1f1.3$ANOVA.test

#          Statistic       df      p-value
#Drug       23.74689 2.610248 1.113276e-13
#Hour       53.66771 3.108207 7.870535e-36
#Drug:Hour  16.03977 7.778431 2.488143e-23

## ANOVA-type statistic for the whole-plot factor
ex.f1f1.3$ANOVA.test.mod.Box

#     Statistic      df1      df2      p-value
#Drug  23.74689 2.610248 38.76767 2.207969e-08
</code></pre>

<hr>
<h2 id='plot.nparLD'>Plot for nparLD</h2><span id='topic+plot'></span><span id='topic+plot.nparLD'></span>

<h3>Description</h3>

<p>This function displays the plot of the relative treatment effect (RTE) at each time point with the corresponding pointwise confidence interval from <code><a href="#topic+nparLD">nparLD</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nparLD'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.nparLD_+3A_x">x</code></td>
<td>
<p>an <code>nparLD</code> class object generated by <code><a href="#topic+nparLD">nparLD</a></code> (see examples).</p>
</td></tr>
<tr><td><code id="plot.nparLD_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Fx-LD-Fy design refers to the experimental design with x whole-plot factor and y sub-plot factors. A whole-plot (between-subjects) factor refers to a factor effective for each subject at all times. A sub-plot (within-subjects) factor refers to a factor effective at a single time point for all time curves and all subjects. The LD-Fy design refers to the experimental design with no whole-plot factor. See Brunner et al. (2002) for more examples.
</p>


<h3>Value</h3>

<p>A list with the following numeric components.
</p>
<table role = "presentation">
<tr><td><code>RTE</code></td>
<td>

<p>summary of the relative treatment effect (RTE) in a n-by-3 matrix form, where n is the total number of time1, time2, and group levels, and group-time interactions; the summary includes the mean of the ranks (RankMeans) in the 1st column, number of observations without counting the repeated measurements within the cell (Nobs) in the 2nd column, and the relative treatment effect (RTE) in the 3rd column.
</p>
</td></tr>
<tr><td><code>Wald.test</code></td>
<td>
<p>the test statistic, the degrees of freedom (df) of the central chi-squared distribution, and the corresponding p-value of the Wald-type test.</p>
</td></tr>
<tr><td><code>ANOVA.test</code></td>
<td>
<p>the test statistic, the numerator degrees of freedom (df) of the central F distribution, and the corresponding p-value of the ANOVA-type test; the denominator degrees of freedom is set to infinity.</p>
</td></tr>
<tr><td><code>covariance</code></td>
<td>
<p>the covariance matrix.</p>
</td></tr>
<tr><td><code>Conf.Int</code></td>
<td>
<p>the (pointwise) 100(1-alpha) percent confidence intervals. See <code><a href="#topic+ld.ci">ld.ci</a></code> for details.</p>
</td></tr>
<tr><td><code>...</code></td>
<td>
<p>Other function-specific outputs. For example, <code>ANOVA.test.mod.Box</code> which is applicable to designs with whole-plot factor(s).</p>
</td></tr>
</table>


<h3>On the Test Statistics</h3>

<p>Although we provide both Wald-type statistic (WTS, see <code>Wald.test</code>) and ANOVA-type statistic with the denominator degrees of freedom set to infinity (ATS, see <code>ANOVA.test</code>), ATS is typically preferred to WTS as it requires less assumptions on the covariance matrix and it has superior small sample performances. Moreover, for the main effects and interactions involving only the whole-plot factors, the modified ANOVA-type statistic with Box (1954) approximation (<code>ANOVA.test.mod.Box</code>) is preferred to ATS. See Brunner et al. (2002) for more details.
</p>


<h3>Author(s)</h3>

<p>Kimihiro Noguchi, Karthinathan Thangavelu, Frank Konietschke, Yulia Gel, Edgar Brunner</p>


<h3>References</h3>

<p>Box, G.E.P. (1954). Some theorems on quadratic forms applied in the study of analysis of variance problems, I. Effect of inequality of variance in the one-way classification. <em>Annals of Mathematical Statistics</em>, 25, 290-302.<br />
</p>
<p>Brunner, E., Domhof, S., and Langer, F. (2002). <em>Nonparametric Analysis of Longitudinal Data in Factorial Experiments</em>,
Wiley, New York.<br />
</p>
<p>Brunner, E. and Langer, F. (1999). <em>Nichtparametrische Analyse longitudinaler Daten</em>, 
R. Oldenbourg Verlag, Munchen Wien.<br />
</p>
<p>Noguchi, K., Gel, Y.R., Brunner, E., and Konietschke, F. (2012). 
nparLD: An R Software Package for the Nonparametric Analysis of Longitudinal Data in Factorial Experiments. 
<em>Journal of Statistical Software</em>, 50(12), 1-23.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+nparLD">nparLD</a></code>, <code><a href="#topic+ld.f1">ld.f1</a></code>, <code><a href="#topic+ld.f2">ld.f2</a></code>, <code><a href="#topic+f1.ld.f1">f1.ld.f1</a></code>, <code><a href="#topic+f1.ld.f2">f1.ld.f2</a></code>, <code><a href="#topic+f2.ld.f1">f2.ld.f1</a></code>, <code><a href="#topic+ld.ci">ld.ci</a></code>, <code><a href="#topic+amylase">amylase</a></code>, <code><a href="#topic+edema">edema</a></code>, <code><a href="#topic+shoulder">shoulder</a></code>, <code><a href="#topic+tree">tree</a></code>, <code><a href="#topic+panic">panic</a></code>, <code><a href="#topic+panic2">panic2</a></code>, <code><a href="#topic+plasma">plasma</a></code>, <code><a href="#topic+dental">dental</a></code>, <code><a href="#topic+rat">rat</a></code>, <code><a href="#topic+respiration">respiration</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Example with the "Panic disorder study I" data (LD-F1 design) ##
data(panic)
ex.f1.np&lt;-nparLD(resp~time, data=panic, subject="subject", description=FALSE, 
order.warning=FALSE)
plot.nparLD(ex.f1.np)

</code></pre>

<hr>
<h2 id='print.nparLD'>Simple Summary for nparLD</h2><span id='topic+print'></span><span id='topic+print.nparLD'></span>

<h3>Description</h3>

<p>This function prints out a simple summary of the object returned by the function <code><a href="#topic+nparLD">nparLD</a></code>. The summary includes the model, the corresponding formula, the Wald-type statistic (WTS), and the ANOVA-type statistic (ATS).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nparLD'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.nparLD_+3A_x">x</code></td>
<td>
<p>an <code>nparLD</code> class object generated by <code><a href="#topic+nparLD">nparLD</a></code> (see examples).</p>
</td></tr>
<tr><td><code id="print.nparLD_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Fx-LD-Fy design refers to the experimental design with x whole-plot factor and y sub-plot factors. A whole-plot (between-subjects) factor refers to a factor effective for each subject at all times. A sub-plot (within-subjects) factor refers to a factor effective at a single time point for all time curves and all subjects. The LD-Fy design refers to the experimental design with no whole-plot factor. See Brunner et al. (2002) for more examples.
</p>


<h3>Value</h3>

<p>A list with the following numeric components.
</p>
<table role = "presentation">
<tr><td><code>RTE</code></td>
<td>

<p>summary of the relative treatment effect (RTE) in a n-by-3 matrix form, where n is the total number of time1, time2, and group levels, and group-time interactions; the summary includes the mean of the ranks (RankMeans) in the 1st column, number of observations without counting the repeated measurements within the cell (Nobs) in the 2nd column, and the relative treatment effect (RTE) in the 3rd column.
</p>
</td></tr>
<tr><td><code>Wald.test</code></td>
<td>
<p>the test statistic, the degrees of freedom (df) of the central chi-squared distribution, and the corresponding p-value of the Wald-type test.</p>
</td></tr>
<tr><td><code>ANOVA.test</code></td>
<td>
<p>the test statistic, the numerator degrees of freedom (df) of the central F distribution, and the corresponding p-value of the ANOVA-type test; the denominator degrees of freedom is set to infinity.</p>
</td></tr>
<tr><td><code>covariance</code></td>
<td>
<p>the covariance matrix.</p>
</td></tr>
<tr><td><code>Conf.Int</code></td>
<td>
<p>the (pointwise) 100(1-alpha) percent confidence intervals. See <code><a href="#topic+ld.ci">ld.ci</a></code> for details.</p>
</td></tr>
<tr><td><code>...</code></td>
<td>
<p>Other function-specific outputs. For example, <code>ANOVA.test.mod.Box</code> which is applicable to designs with whole-plot factor(s).</p>
</td></tr>
</table>


<h3>On the Test Statistics</h3>

<p>Although we provide both Wald-type statistic (WTS, see <code>Wald.test</code>) and ANOVA-type statistic with the denominator degrees of freedom set to infinity (ATS, see <code>ANOVA.test</code>), ATS is typically preferred to WTS as it requires less assumptions on the covariance matrix and it has superior small sample performances. Moreover, for the main effects and interactions involving only the whole-plot factors, the modified ANOVA-type statistic with Box (1954) approximation (<code>ANOVA.test.mod.Box</code>) is preferred to ATS. See Brunner et al. (2002) for more details.
</p>


<h3>Author(s)</h3>

<p>Kimihiro Noguchi, Karthinathan Thangavelu, Frank Konietschke, Yulia Gel, Edgar Brunner</p>


<h3>References</h3>

<p>Box, G.E.P. (1954). Some theorems on quadratic forms applied in the study of analysis of variance problems, I. Effect of inequality of variance in the one-way classification. <em>Annals of Mathematical Statistics</em>, 25, 290-302.<br />
</p>
<p>Brunner, E., Domhof, S., and Langer, F. (2002). <em>Nonparametric Analysis of Longitudinal Data in Factorial Experiments</em>,
Wiley, New York.<br />
</p>
<p>Brunner, E. and Langer, F. (1999). <em>Nichtparametrische Analyse longitudinaler Daten</em>, 
R. Oldenbourg Verlag, Munchen Wien.<br />
</p>
<p>Noguchi, K., Gel, Y.R., Brunner, E., and Konietschke, F. (2012). 
nparLD: An R Software Package for the Nonparametric Analysis of Longitudinal Data in Factorial Experiments. 
<em>Journal of Statistical Software</em>, 50(12), 1-23.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+nparLD">nparLD</a></code>, <code><a href="#topic+ld.f1">ld.f1</a></code>, <code><a href="#topic+ld.f2">ld.f2</a></code>, <code><a href="#topic+f1.ld.f1">f1.ld.f1</a></code>, <code><a href="#topic+f1.ld.f2">f1.ld.f2</a></code>, <code><a href="#topic+f2.ld.f1">f2.ld.f1</a></code>, <code><a href="#topic+ld.ci">ld.ci</a></code>, <code><a href="#topic+amylase">amylase</a></code>, <code><a href="#topic+edema">edema</a></code>, <code><a href="#topic+shoulder">shoulder</a></code>, <code><a href="#topic+tree">tree</a></code>, <code><a href="#topic+panic">panic</a></code>, <code><a href="#topic+panic2">panic2</a></code>, <code><a href="#topic+plasma">plasma</a></code>, <code><a href="#topic+dental">dental</a></code>, <code><a href="#topic+rat">rat</a></code>, <code><a href="#topic+respiration">respiration</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Example with the "Panic disorder study I" data (LD-F1 design) ##
data(panic)
ex.f1.np&lt;-nparLD(resp~time, data=panic, subject="subject", description=FALSE, 
order.warning=FALSE)
print.nparLD(ex.f1.np)

#Model: 
#LD F1 Model 
 
#Call: 
#resp ~ time

#Relative Treatment Effect (RTE):
#      RankMeans Nobs       RTE
#time0  66.09375   16 0.8199219
#time2  50.50000   16 0.6250000
#time4  41.28125   16 0.5097656
#time6  25.62500   16 0.3140625
#time8  19.00000   16 0.2312500
</code></pre>

<hr>
<h2 id='rat'>Rat growth study</h2><span id='topic+rat'></span>

<h3>Description</h3>

<p>Measurements of body weights (in grams) of rats.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(rat)</code></pre>


<h3>Format</h3>

<p>Longitudinal data of 27 rats with body weight measurements from both control and treatment groups taken over a 5-week period.
</p>


<h3>Details</h3>

<p>In clinical chemistry, it is important for the determination of reference intervals to investigate whether a variable of interest has a circadian rhythm. If so, the reference intervals cannot be determined independently of time. This question is to be analyzed in the case of alpha-amylase in saliva. Measurements of alpha-amylase levels were taken from the saliva of 14 volunteers, four times per day (8 a.m., 12 p.m., 5 p.m., 9 p.m.) on two days (Monday (m), Thursday (t)), since differences in the alpha-amylase profiles immediately after a weekend as opposed to the middle of the week are suspected. Thus, each subject was examined on Monday and Thursday.
</p>
<p>Box (1950) and Wolfinger (1996) consider the growth curve problem using the body weight measurements of 27 rats. In the data, 10 rats are in the control group while the remaining 17 rats are in two treatment groups. The treatment groups with 7 and 10 rats had thyroxin and thiouracil in their drinking water, respectively. The main difficulty in modeling their growth curves is the fanning effect, which indicates an increase in variances over time. To stabilize the variances, Box (1950) considers differencing based on the data at the initial week and Wolfinger (1996) illustrates the logarithmic transformation and discusses ways to model the growth curve without relying on the data transformation.
</p>


<h3>References</h3>

<p>Box, G.E.P. (1950). Problems in the analysis of growth and wear curves. 
<em>Biometrics</em>, 6, 362-389.<br />
</p>
<p>Brunner, E., Domhof, S., and Langer, F. (2002). <em>Nonparametric Analysis of Longitudinal Data in Factorial Experiments</em>,
Wiley, New York.<br />
</p>
<p>Brunner, E. and Langer, F. (1999). <em>Nichtparametrische Analyse longitudinaler Daten</em>, 
R. Oldenbourg Verlag, Munchen Wien.<br />
</p>
<p>Noguchi, K., Gel, Y.R., Brunner, E., and Konietschke, F. (2012). 
nparLD: An R Software Package for the Nonparametric Analysis of Longitudinal Data in Factorial Experiments. 
<em>Journal of Statistical Software</em>, 50(12), 1-23.<br />
</p>
<p>Wolfinger, R.D. (1996). Heterogeneous variance: covariance structures for repeated measures.
<em>Journal of Agricultural, Biological, and Environmental Statistics</em>, 1, 205-230.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Analysis using F1-LD-F1 design ##
data(rat)
attach(rat)
w.pat&lt;-matrix(rep(c(1:5),each=5),ncol=5,nrow=5)
ex.f1f1&lt;-f1.ld.f1(y=resp, time=time, group=group, subject=subject, 
time.name="Week", group.name="Treatment", description="FALSE", w.pat=w.pat)
# F1 LD F1 Model 
# ----------------------- 
# Check that the order of the time and group levels are correct.
# Time level:   0 1 2 3 4 
# Group level:   control thyrox thiour 
# If the order is not correct, specify the correct order in time.order or 
# group.order.

## Wald-type statistic 
ex.f1f1$Wald.test

#                Statistic df      p-value
#Treatment        12.52657  2 1.904977e-03
#Week           3619.03739  4 0.000000e+00
#Treatment:Week   70.34311  8 4.199050e-12

## ANOVA-type statistic
ex.f1f1$ANOVA.test

#                 Statistic       df      p-value
#Treatment         5.286582 1.922792 5.654723e-03
#Week           1008.512138 1.990411 0.000000e+00
#Treatment:Week   11.093940 3.516933 3.616929e-08

## ANOVA-type statistic for the whole-plot factor
ex.f1f1$ANOVA.test.mod.Box

#          Statistic      df1      df2    p-value
#Treatment  5.286582 1.922792 19.23468 0.01563658

## The same analysis can be done using the wrapper function "nparLD" ##

ex.f1f1np&lt;-nparLD(resp~time*group, data=rat, subject="subject", 
description=FALSE)
# F1 LD F1 Model 
# ----------------------- 
# Check that the order of the time and group levels are correct.
# Time level:   0 1 2 3 4 
# Group level:   control thyrox thiour 
# If the order is not correct, specify the correct order in time.order or 
# group.order.
</code></pre>

<hr>
<h2 id='respiration'>Respiratory disorder study</h2><span id='topic+respiration'></span>

<h3>Description</h3>

<p>Measurements of health status in an ordinal scale from 0 to 4 from a group of patients with a respiratory disorder.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(respiration)</code></pre>


<h3>Format</h3>

<p>Longitudinal data of health status of 111 patients with a respiratory disorder from both the control and treatment groups (57 and 54 patients, respectively) taken at each of their 5 visits in 2 different centers (56 and 55 patients, respectively).
</p>


<h3>Details</h3>

<p>Researchers are often concerned with ordinal responses in clinical trials. Koch et al. (1990) discuss the problem with such ordinal data arising from a clinical trial for patients with a respiratory disorder with multiple whole-plot factors. In this dataset, a total of 111 paties from two centers were randomly assigned to either the control or treatment group, and their responses in an ordinal scale from 0 to 4, indicating their health status, were recorded over their 5 visits. 
</p>


<h3>References</h3>

<p>Brunner, E., Domhof, S., and Langer, F. (2002). <em>Nonparametric Analysis of Longitudinal Data in Factorial Experiments</em>,
Wiley, New York.<br />
</p>
<p>Brunner, E. and Langer, F. (1999). <em>Nichtparametrische Analyse longitudinaler Daten</em>, 
R. Oldenbourg Verlag, Munchen Wien.<br />
</p>
<p>Koch, G.G., Carr, G.J., Amara, I.A., Stokes, M.E., and Uryniak, T.J. (1990). 
<em>Categorical Data Analysis. Statistical Methodology in the Pharmaceutical Sciences</em>, D. A. Berry ed., pp.389-473.<br />
</p>
<p>Noguchi, K., Gel, Y.R., Brunner, E., and Konietschke, F. (2012). 
nparLD: An R Software Package for the Nonparametric Analysis of Longitudinal Data in Factorial Experiments. 
<em>Journal of Statistical Software</em>, 50(12), 1-23.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Analysis using F1-LD-F2 design ##
data(respiration)
attach(respiration)
ex.f2f1&lt;-f2.ld.f1(y=resp, time=time, group1=center, group2=treatment, 
subject=patient, time.name="Time", group1.name="Center", 
group2.name="Treatment", description=FALSE)
# F2 LD F1 Model 
# ----------------------- 
# Check that the order of the time, group1, and group2 levels are correct.
# Time level:   1 2 3 4 5 
# Group1 level:   1 2 
# Group2 level:   A P 
# If the order is not correct, specify the correct order in time.order, 
# group1.order, or group2.order.

## Wald-type statistic 
ex.f2f1$Wald.test

#                       Statistic df     p-value
#Center                10.2569587  1 0.001361700
#Treatment              9.3451482  1 0.002235766
#Time                  17.4568433  4 0.001575205
#Center:Treatment       1.2365618  1 0.266134717
#Center:Time            8.7200395  4 0.068491057
#Treatment:Time        17.5434583  4 0.001515158
#Center:Treatment:Time  0.2898785  4 0.990458142

## ANOVA-type statistic
ex.f2f1$ANOVA.test

#                        Statistic       df      p-value
#Center                10.25695866 1.000000 0.0013616998
#Treatment              9.34514819 1.000000 0.0022357657
#Time                   4.43527016 3.320559 0.0028528788
#Center:Treatment       1.23656176 1.000000 0.2661347165
#Center:Time            1.60699585 3.320559 0.1802120504
#Treatment:Time         5.46185031 3.320559 0.0005867392
#Center:Treatment:Time  0.05915234 3.320559 0.9866660535

## ANOVA-type statistic for the whole-plot factors and 
## their interaction
ex.f2f1$ANOVA.test.mod.Box

#                 Statistic df1      df2     p-value
#Center           10.256959   1 104.9255 0.001803091
#Treatment         9.345148   1 104.9255 0.002836284
#Center:Treatment  1.236562   1 104.9255 0.268676117

## The same analysis can be done using the wrapper function "nparLD" ##

ex.f2f1np&lt;-nparLD(resp~time*center*treatment, data=respiration, 
subject="patient", description=FALSE)
# F2 LD F1 Model 
# ----------------------- 
# Check that the order of the time, group1, and group2 levels are correct.
# Time level:   1 2 3 4 5 
# Group1 level:   1 2 
# Group2 level:   A P 
# If the order is not correct, specify the correct order in time.order, 
# group1.order, or group2.order.
</code></pre>

<hr>
<h2 id='shoulder'>Shoulder tip pain study</h2><span id='topic+shoulder'></span>

<h3>Description</h3>

<p>Measurements of shoulder pain levels from a group of patients having undergone laparoscopic surgery in abdomen.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(shoulder)</code></pre>


<h3>Format</h3>

<p>Longitudinal data of 41 patients from both a treatment and a control group with shoulder pain scores taken on 6 occasions (2 times a day for 3 days).
</p>


<h3>Details</h3>

<p>In the shoulder tip pain study described by Lumley (1996), the shoulder pain typically experienced in patients having undergone laparoscopic surgery in the abdomen was observed in a total of 41 patients. A subgroup of 22 randomly selected patients received a treatment in which the air was removed by using a specific suction procedure (treatment Y). The remaining 19 patients served as the control group (treatment N). The pain was subjectively assessed by means of pain-scores (1=low through 5=high). This score was repeatedly measured in the morning and the evening of the first three days after the operation, yielding six repeated measurements for each patient. The patients were stratified according to gender (M=male, F=female) since pain sensitivity may depend on the gender of the patient.
</p>


<h3>References</h3>

<p>Brunner, E., Domhof, S., and Langer, F. (2002). <em>Nonparametric Analysis of Longitudinal Data in Factorial Experiments</em>,
Wiley, New York.<br />
</p>
<p>Brunner, E. and Langer, F. (1999). <em>Nichtparametrische Analyse longitudinaler Daten</em>, 
R. Oldenbourg Verlag, Munchen Wien.<br />
</p>
<p>Lumley, T. (1996). Generalized estimating equations for ordinal data: A note on working correlation structures. 
<em>Biometrics</em> 52, 354-361.<br />
</p>
<p>Noguchi, K., Gel, Y.R., Brunner, E., and Konietschke, F. (2012). 
nparLD: An R Software Package for the Nonparametric Analysis of Longitudinal Data in Factorial Experiments. 
<em>Journal of Statistical Software</em>, 50(12), 1-23.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Analysis using F2-LD-F1 design ##
data(shoulder)
attach(shoulder)
ex.f2f1&lt;-f2.ld.f1(y=resp, time=time, group1=group1, group2=group2, 
subject=subject, time.name="Time", group1.name="Treatment", 
group2.name="Gender", description=FALSE)
# Check that the order of the time, group1, and group2 levels are correct.
# Time level:   1 2 3 4 5 6 
# Group1 level:   Y N 
# Group2 level:   F M 
# If the order is not correct, specify the correct order in time.order, 
# group1.order, or group2.order.
#
#
# Warning(s):
# The covariance matrix is singular. 

## Wald-type statistic 
ex.f2f1$Wald.test

#                        Statistic df      p-value
#Treatment             16.40129021  1 5.125033e-05
#Gender                 0.04628558  1 8.296575e-01
#Time                  16.34274332  5 5.930698e-03
#Treatment:Gender       0.03583558  1 8.498554e-01
#Treatment:Time        27.51450085  5 4.527996e-05
#Gender:Time           12.37903186  5 2.994753e-02
#Treatment:Gender:Time  5.11864769  5 4.015727e-01

## ANOVA-type statistic
ex.f2f1$ANOVA.test

#                        Statistic       df      p-value
#Treatment             16.40129021 1.000000 5.125033e-05
#Gender                 0.04628558 1.000000 8.296575e-01
#Time                   3.38218704 2.700754 2.120366e-02
#Treatment:Gender       0.03583558 1.000000 8.498554e-01
#Treatment:Time         3.71077200 2.700754 1.398190e-02
#Gender:Time            1.14434841 2.700754 3.272967e-01
#Treatment:Gender:Time  0.43755394 2.700754 7.054255e-01

## ANOVA-type statistic for the whole-plot factors and
## their interaction
ex.f2f1$ANOVA.test.mod.Box

#                   Statistic df1      df2      p-value
#Treatment        16.40129021   1 21.86453 0.0005395379
#Gender            0.04628558   1 21.86453 0.8316516274
#Treatment:Gender  0.03583558   1 21.86453 0.8516017168
</code></pre>

<hr>
<h2 id='summary.nparLD'>Object Summary for nparLD</h2><span id='topic+summary'></span><span id='topic+summary.nparLD'></span>

<h3>Description</h3>

<p>This function prints out a summary of the object returned by the function <code><a href="#topic+nparLD">nparLD</a></code>. The summary includes the model and the corresponding formula, the relative treatment effect (RTE), the Wald-type statistic (WTS), and the ANOVA-type statistic (ATS).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nparLD'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.nparLD_+3A_object">object</code></td>
<td>
<p>an <code>nparLD</code> class object generated by <code><a href="#topic+nparLD">nparLD</a></code> (see examples).</p>
</td></tr>
<tr><td><code id="summary.nparLD_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Fx-LD-Fy design refers to the experimental design with x whole-plot factor and y sub-plot factors. A whole-plot (between-subjects) factor refers to a factor effective for each subject at all times. A sub-plot (within-subjects) factor refers to a factor effective at a single time point for all time curves and all subjects. The LD-Fy design refers to the experimental design with no whole-plot factor. See Brunner et al. (2002) for more examples.
</p>


<h3>Value</h3>

<p>A list with the following numeric components.
</p>
<table role = "presentation">
<tr><td><code>RTE</code></td>
<td>

<p>summary of the relative treatment effect (RTE) in a n-by-3 matrix form, where n is the total number of time1, time2, and group levels, and group-time interactions; the summary includes the mean of the ranks (RankMeans) in the 1st column, number of observations without counting the repeated measurements within the cell (Nobs) in the 2nd column, and the relative treatment effect (RTE) in the 3rd column.
</p>
</td></tr>
<tr><td><code>Wald.test</code></td>
<td>
<p>the test statistic, the degrees of freedom (df) of the central chi-squared distribution, and the corresponding p-value of the Wald-type test.</p>
</td></tr>
<tr><td><code>ANOVA.test</code></td>
<td>
<p>the test statistic, the numerator degrees of freedom (df) of the central F distribution, and the corresponding p-value of the ANOVA-type test; the denominator degrees of freedom is set to infinity.</p>
</td></tr>
<tr><td><code>covariance</code></td>
<td>
<p>the covariance matrix.</p>
</td></tr>
<tr><td><code>Conf.Int</code></td>
<td>
<p>the (pointwise) 100(1-alpha) percent confidence intervals. See <code><a href="#topic+ld.ci">ld.ci</a></code> for details.</p>
</td></tr>
<tr><td><code>...</code></td>
<td>
<p>Other function-specific outputs. For example, <code>ANOVA.test.mod.Box</code> which is applicable to designs with whole-plot factor(s).</p>
</td></tr>
</table>


<h3>On the Test Statistics</h3>

<p>Although we provide both Wald-type statistic (WTS, see <code>Wald.test</code>) and ANOVA-type statistic with the denominator degrees of freedom set to infinity (ATS, see <code>ANOVA.test</code>), ATS is typically preferred to WTS as it requires less assumptions on the covariance matrix and it has superior small sample performances. Moreover, for the main effects and interactions involving only the whole-plot factors, the modified ANOVA-type statistic with Box (1954) approximation (<code>ANOVA.test.mod.Box</code>) is preferred to ATS. See Brunner et al. (2002) for more details.
</p>


<h3>Author(s)</h3>

<p>Kimihiro Noguchi, Karthinathan Thangavelu, Frank Konietschke, Yulia Gel, Edgar Brunner</p>


<h3>References</h3>

<p>Box, G.E.P. (1954). Some theorems on quadratic forms applied in the study of analysis of variance problems, I. Effect of inequality of variance in the one-way classification. <em>Annals of Mathematical Statistics</em>, 25, 290-302.<br />
</p>
<p>Brunner, E., Domhof, S., and Langer, F. (2002). <em>Nonparametric Analysis of Longitudinal Data in Factorial Experiments</em>,
Wiley, New York.<br />
</p>
<p>Brunner, E. and Langer, F. (1999). <em>Nichtparametrische Analyse longitudinaler Daten</em>, 
R. Oldenbourg Verlag, Munchen Wien.<br />
</p>
<p>Noguchi, K., Gel, Y.R., Brunner, E., and Konietschke, F. (2012). 
nparLD: An R Software Package for the Nonparametric Analysis of Longitudinal Data in Factorial Experiments. 
<em>Journal of Statistical Software</em>, 50(12), 1-23.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+nparLD">nparLD</a></code>, <code><a href="#topic+ld.f1">ld.f1</a></code>, <code><a href="#topic+ld.f2">ld.f2</a></code>, <code><a href="#topic+f1.ld.f1">f1.ld.f1</a></code>, <code><a href="#topic+f1.ld.f2">f1.ld.f2</a></code>, <code><a href="#topic+f2.ld.f1">f2.ld.f1</a></code>, <code><a href="#topic+ld.ci">ld.ci</a></code>, <code><a href="#topic+amylase">amylase</a></code>, <code><a href="#topic+edema">edema</a></code>, <code><a href="#topic+shoulder">shoulder</a></code>, <code><a href="#topic+tree">tree</a></code>, <code><a href="#topic+panic">panic</a></code>, <code><a href="#topic+panic2">panic2</a></code>, <code><a href="#topic+plasma">plasma</a></code>, <code><a href="#topic+dental">dental</a></code>, <code><a href="#topic+rat">rat</a></code>, <code><a href="#topic+respiration">respiration</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Example with the "Panic disorder study I" data (LD-F1 design) ##
data(panic)
ex.f1.np&lt;-nparLD(resp~time, data=panic, subject="subject", description=FALSE, 
order.warning=FALSE)
summary.nparLD(ex.f1.np)

#Model: 
#LD F1 Model 
 
#Call: 
#resp ~ time

#Relative Treatment Effect (RTE):
#      RankMeans Nobs       RTE
#time0  66.09375   16 0.8199219
#time2  50.50000   16 0.6250000
#time4  41.28125   16 0.5097656
#time6  25.62500   16 0.3140625
#time8  19.00000   16 0.2312500

#Wald-Type Statistc (WTS):
#     Statistic df    p-value
#time  126.6946  4 1.9822e-26

#ANOVA-Type Statistc (ATS):
#     Statistic       df      p-value
#time  36.93664 2.234135 1.975781e-18
</code></pre>

<hr>
<h2 id='tree'>Vitality of treetops</h2><span id='topic+tree'></span>

<h3>Description</h3>

<p>Measurements of the vitality condition of the treetops on a grading scale from three experimental sites.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(tree)</code></pre>


<h3>Format</h3>

<p>Longitudinal data of 72 trees from three areas with the treetop vitality scores taken on 4 occasions.
</p>


<h3>Details</h3>

<p>In this study, the condition of the trees in all three experimental sites was evaluated by means of a crane constructed for the examination of the treetops. Each individual tree was identified (22 trees in the D0 area, 23 in the D2 area, and 27 in the D1 area) and categorized according to the vitality of the tree using a grading scale from 1 (vital) to 10 (dead). This determination of the vitality status was conducted each year from 1993 until 1996.
</p>


<h3>References</h3>

<p>Brunner, E., Domhof, S., and Langer, F. (2002). <em>Nonparametric Analysis of Longitudinal Data in Factorial Experiments</em>,
Wiley, New York.<br />
</p>
<p>Brunner, E. and Langer, F. (1999). <em>Nichtparametrische Analyse longitudinaler Daten</em>, 
R. Oldenbourg Verlag, Munchen Wien.<br />
</p>
<p>Noguchi, K., Gel, Y.R., Brunner, E., and Konietschke, F. (2012). 
nparLD: An R Software Package for the Nonparametric Analysis of Longitudinal Data in Factorial Experiments. 
<em>Journal of Statistical Software</em>, 50(12), 1-23.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Analysis using F1-LD-F1 design ##
data(tree)
attach(tree)
w.t&lt;-c(1:4)
w.g&lt;-c(1:3)
w.pat &lt;- rbind(c(1:4), c(1:4), c(1:4))
ex.f1f1&lt;-f1.ld.f1(y=resp, time=time, group=group, subject=subject,
w.pat=w.pat, w.t=w.t, w.g=w.g, time.name="Year", group.name="Area", 
description=FALSE)
# F1 LD F1 Model 
# ----------------------- 
# Check that the order of the time and group levels are correct.
# Time level:   1 2 3 4 
# Group level:   D0 D2 D1 
# If the order is not correct, specify the correct order in time.order or 
# group.order.

## Wald-type statistic 
ex.f1f1$Wald.test

#Area       4.510037  2 1.048716e-01
#Year      58.061097  3 1.525356e-12
#Area:Year 14.819966  6 2.170415e-02

## ANOVA-type statistic
ex.f1f1$ANOVA.test

#          Statistic       df      p-value
#Area       2.352854 1.968147 9.601181e-02
#Year      21.389142 2.729147 8.210954e-13
#Area:Year  3.113632 5.346834 6.768732e-03

## ANOVA-type statistic for the whole-plot factor
ex.f1f1$ANOVA.test.mod.Box

#     Statistic      df1     df2   p-value
#Area  2.352854 1.968147 64.3979 0.1040525
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
