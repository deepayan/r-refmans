<!DOCTYPE html><html lang="en"><head><title>Help for package blm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {blm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#blm-package'>
<p>Binomial linear and linear-expit regression  model</p></a></li>
<li><a href='#aarp'><p>Nested case-control data set of bladder cancer in the NIH-AARP Diet and Health Study</p></a></li>
<li><a href='#blm'><p>Fit a binomial linear regression model</p></a></li>
<li><a href='#blm-class'><p>Class &quot;blm&quot;</p></a></li>
<li><a href='#ccdata'><p>Simulated case-control dataset</p></a></li>
<li><a href='#coef'><p>Get coefs from <code>blm</code> and <code>lexpit</code> objects.</p></a></li>
<li><a href='#confint'><p>Confidence intervals for parameters of <code>blm</code> and <code>lexpit</code> objects.</p></a></li>
<li><a href='#crude.risk'><p>Risk-exposure scatter plot</p></a></li>
<li><a href='#EO'><p>Compute the ratio of expected event to observed events for <code>blm</code> and <code>lexpit</code> objects.</p></a></li>
<li><a href='#expit'><p>Inverse-logit function</p></a></li>
<li><a href='#gof'><p>Hosmer-lemeshow goodness-of-fit statistics for <code>blm</code> and <code>lexpit</code> objects.</p></a></li>
<li><a href='#gof.pearson'><p>Pearson's goodness-of-fit statistics for <code>blm</code> and <code>lexpit</code> objects.</p></a></li>
<li><a href='#lexpit'><p>Fit a linear-expit regression model</p></a></li>
<li><a href='#lexpit-class'><p>Class &quot;lexpit&quot;</p></a></li>
<li><a href='#logit'><p>Logit function</p></a></li>
<li><a href='#logLik'><p>Log-likelihood of <code>blm</code> and <code>lexpit</code> objects.</p></a></li>
<li><a href='#LRT'><p>Performs likelihood-ratio test for lexpit and BLM models of cohort data</p></a></li>
<li><a href='#model.formula'><p>Get formula call for <code>blm</code> and <code>lexpit</code> objects.</p></a></li>
<li><a href='#predict'><p>Get risk predictions for <code>blm</code> and <code>lexpit</code> objects.</p></a></li>
<li><a href='#print'><p>Print coefficients of <code>blm</code> and <code>lexpit</code> model fit.</p></a></li>
<li><a href='#resid'><p>Get residuals from <code>blm</code> and <code>lexpit</code> objects.</p></a></li>
<li><a href='#risk.exposure.plot'><p>Risk-exposure scatter plot</p></a></li>
<li><a href='#Rsquared'><p>Compute R-squared measures of model fit for <code>blm</code> and <code>lexpit</code> objects.</p></a></li>
<li><a href='#show'><p>Show <code>blm</code> and <code>lexpit</code> model fit.</p></a></li>
<li><a href='#summary'><p>Summary of <code>blm</code> and <code>lexpit</code> model fit.</p></a></li>
<li><a href='#vcov'><p>Get variance-covariance from <code>blm</code> and <code>lexpit</code> objects.</p></a></li>
<li><a href='#which.at.boundary'><p>Covariate patterns at the boundary for <code>blm</code> and <code>lexpit</code> objects.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Binomial Linear Regression</td>
</tr>
<tr>
<td>Version:</td>
<td>2022.0.0.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-09-09</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0), methods</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, stats4</td>
</tr>
<tr>
<td>Author:</td>
<td>S. Kovalchik</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>S.Kovalchik &lt;s.a.kovalchik@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements regression models for binary data on the absolute risk scale. These models are applicable to cohort and population-based case-control data.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-09-12 08:12:56 UTC</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-09-10 13:40:00 UTC; skovalchik</td>
</tr>
</table>
<hr>
<h2 id='blm-package'>
Binomial linear and linear-expit regression  model
</h2><span id='topic+blm-package'></span>

<h3>Description</h3>

<p>The functions <code>blm</code> and <code>lexpit</code> implement a binomial linear and linear-expit regression model. Estimates are the maximum likelihood estimates with constrained optimization through adaptive barrier method to ensure that estimable probabilities are in the (0,1) interval. 
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> blm</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 2013.2.4.4</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2013-8-14</td>
</tr>
<tr>
 <td style="text-align: left;">
Depends: </td><td style="text-align: left;"> R (&gt;= 2.10.1), methods</td>
</tr>
<tr>
 <td style="text-align: left;">
Imports: </td><td style="text-align: left;"> stats, stats4</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 2) </td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Maintainer: Stephanie Kovalchik &lt;s.a.kovalchik@gmail.com&gt;
</p>


<h3>References</h3>

<p>Kovalchik S, Varadhan R (2013). Fitting Additive Binomial Regression Models with the R Package blm. <em>Journal of Statistical Software</em>, 54(1), 1-18. URL: <a href="https://www.jstatsoft.org/v54/i01/">https://www.jstatsoft.org/v54/i01/</a>.
</p>


<h3>See Also</h3>

<p><a href="stats.html#topic+constrOptim">constrOptim</a>, <a href="#topic+blm">blm</a>, <a href="#topic+lexpit">lexpit</a></p>

<hr>
<h2 id='aarp'>Nested case-control data set of bladder cancer in the NIH-AARP Diet and Health Study</h2><span id='topic+aarp'></span>

<h3>Description</h3>

<p>The <code>aarp</code> data set is a nested case-control study of bladder cancer outcomes in the NIH-AARP Diet and Health Study. The data set is intended for demonstration purposes only.</p>


<h3>Usage</h3>

<pre><code class='language-R'>aarp
</code></pre>


<h3>Format</h3>


<table>
<tr>
 <td style="text-align: left;">
    bladder70:</td><td style="text-align: left;"> indicator of bladder cancer by age 70 years </td>
</tr>
<tr>
 <td style="text-align: left;">
    female:</td><td style="text-align: left;"> indicator of female gender </td>
</tr>
<tr>
 <td style="text-align: left;">
    smoke_status: </td><td style="text-align: left;"> factor of smoking status (four categories)  </td>
</tr>
<tr>
 <td style="text-align: left;">
    w: </td><td style="text-align: left;"> inverse of sampling fraction</td>
</tr>
<tr>
 <td style="text-align: left;">
    redmeat: </td><td style="text-align: left;"> total daily redmeat consumption (grams/day)</td>
</tr>
<tr>
 <td style="text-align: left;">
    fiber.centered: </td><td style="text-align: left;"> total daily fiber consumption (grams), centered on sample median </td>
</tr>
<tr>
 <td style="text-align: left;">
    educ: </td><td style="text-align: left;"> factor of education status (six categories)
  </td>
</tr>

</table>



<h3>Source</h3>

<p>National Cancer Institute. National Institutes of Health AARP Diet and Health Study. <a href="https://dceg.cancer.gov/research/who-we-study/nih-aarp-diet-health-study">https://dceg.cancer.gov/research/who-we-study/nih-aarp-diet-health-study</a>. Accessed: 12/10/2012
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(aarp)

# ABSOLUTE RISK OF BLADDER CANCER BY 70 YEARS
# FOR DIFFERENT GENDER AND RISK GROUP

fit &lt;- blm(bladder70~female * smoke_status, 
			      data = aarp, 
			      weight=aarp$w)

# INTERCEPT IS BASELINE RISK
# ALL OTHER COEFFICIENTS ARE RISK DIFFERENCES FROM BASELINE

summary(fit)


</code></pre>

<hr>
<h2 id='blm'>Fit a binomial linear regression model</h2><span id='topic+blm'></span>

<h3>Description</h3>

<p>A direct probability model for regression with a binary outcome from observational data. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>blm(formula, data, na.action = na.omit, weights = NULL, 
    strata = NULL, par.init = NULL, warn=FALSE,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="blm_+3A_formula">formula</code></td>
<td>
<p>formula for linear model for binary outcome, <code>event~x1+x2+...</code></p>
</td></tr>
<tr><td><code id="blm_+3A_data">data</code></td>
<td>
<p>data.frame containing the variables of <code>formula</code></p>
</td></tr>
<tr><td><code id="blm_+3A_na.action">na.action</code></td>
<td>
<p>function specifying how missing data should be handled, <a href="stats.html#topic+na.action">na.action</a></p>
</td></tr>
<tr><td><code id="blm_+3A_weights">weights</code></td>
<td>
<p>Vector of weights equal to the number of observations. For population-based case-control study, weights are the inverse sampling fractions for controls.</p>
</td></tr>
<tr><td><code id="blm_+3A_strata">strata</code></td>
<td>
<p>vector indicating the stratification for weighted regression with stratified observational data</p>
</td></tr>
<tr><td><code id="blm_+3A_par.init">par.init</code></td>
<td>
<p>vector (optional) of initial parameters</p>
</td></tr>
<tr><td><code id="blm_+3A_warn">warn</code></td>
<td>
<p>logical indicator whether to include warnings during algorithm fitting. Default of <code>FALSE</code> suppresses warnings when testing for feasible parameters.</p>
</td></tr>
<tr><td><code id="blm_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code>constrOptim</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>blm</code> model coefficients are the solutions to the maximum of a pseudo log-likelihood using a constrained optimization algorithm with an adaptive barrier method, <code>constrOptim</code> (Lange, 2010). Variance estimates are based on Taylor linearization (Shah, 2002). When <code>weights</code> are not NULL, it is assumed that the study is a case-control design.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>blm</code>.
</p>


<h3>Author(s)</h3>

<p>S. Kovalchik <a href="mailto:s.a.kovalchik@gmail.com">s.a.kovalchik@gmail.com</a></p>


<h3>References</h3>

<p>Kovalchik S, Varadhan R (2013). Fitting Additive Binomial Regression Models with the R Package blm. <em>Journal of Statistical Software</em>, 54(1), 1-18. URL: <a href="https://www.jstatsoft.org/v54/i01/">https://www.jstatsoft.org/v54/i01/</a>.
</p>
<p>Lange, K. (2010) <em>Numerical Analysis for Statisticians</em>, Springer.
</p>
<p>Shah, BV. (2002) Calculus of Taylor deviations. Joint Statistical Meetings.
</p>


<h3>See Also</h3>

<p><a href="stats.html#topic+constrOptim">constrOptim</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(ccdata)

fit &lt;- blm(y~female+packyear, weights = ccdata$w,strata=ccdata$strata,
				data=ccdata)

summary(fit)


data(aarp)

# ABSOLUTE RISK OF BLADDER CANCER BY 70 YEARS
# FOR DIFFERENT GENDER AND RISK GROUP

fit &lt;- blm(bladder70~female * smoke_status, 
			      data = aarp, 
			      weight=aarp$w)

logLik(fit)

# INTERCEPT IS BASELINE RISK
# ALL OTHER COEFFICIENTS ARE RISK DIFFERENCES FROM BASELINE

summary(fit)

# RISK DIFFERENCE CONFIDENCE INTERVALS (PER 1,000 PERSONS)
confint(fit)*1000
</code></pre>

<hr>
<h2 id='blm-class'>Class &quot;blm&quot;</h2><span id='topic+blm-class'></span>

<h3>Description</h3>

<p>Class for binomial linear regression (BLM).
</p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("blm", ...)</code>. 
</p>


<h3>Slots</h3>


<dl>
<dt><code>coef</code>:</dt><dd><p>vector of fitted coefficients</p>
</dd>
<dt><code>vcov</code>:</dt><dd><p>matrix of variance-covariate estimates for <code>coef</code></p>
</dd>
<dt><code>formula</code>:</dt><dd><p>model formula</p>
</dd>
<dt><code>df.residual</code>:</dt><dd><p>residual degrees of freedom</p>
</dd>
<dt><code>data</code>:</dt><dd><p>data frame used in fitting, after applying <code>na.action</code></p>
</dd>
<dt><code>which.kept</code>:</dt><dd><p>vector of index of values in original data source that were used in the model fitting</p>
</dd>
<dt><code>y</code>:</dt><dd><p>response vector for fitted model</p>
</dd>	
<dt><code>weights</code>:</dt><dd><p>vector of weights used in model fitting</p>
</dd>
<dt><code>strata</code>:</dt><dd><p>stratification factor for weighted regression.</p>
</dd>
<dt><code>converged</code>:</dt><dd><p>logical message about convergence status at the end of algorithm</p>
</dd>
<dt><code>par.init</code>:</dt><dd><p>initial parameter values for optimization algorithm</p>
</dd>
<dt><code>loglik</code></dt><dd><p>value of log-likelihood (normalized for weighted likelihood) under full model</p>
</dd> 
<dt><code>loglik.null</code></dt><dd><p>value of log-likelihood (normalized for weighted likelihood) under null model</p>
</dd> 
<dt><code>barrier.value</code></dt><dd><p>value of the barrier function at the optimum</p>
</dd>
</dl>
 


<h3>Methods</h3>


<dl>
<dt>show</dt><dd><p><code>signature(object = "blm")</code>:
Display point estimates of <code>blm</code> object.
</p>
</dd>
<dt>print</dt><dd><p><code>signature(x = "blm",...)</code>:
Display point estimates of <code>blm</code> object.
</p>
</dd>
<dt>summary</dt><dd><p><code>signature(object = "blm",...)</code>:
List of estimates and convergence information.
</p>
</dd>
<dt>coef</dt><dd><p><code>signature(object = "blm")</code>:
Extractor for fitted coefficients. 
</p>
</dd>
<dt>logLik</dt><dd><p><code>signature(object = "blm")</code>:
Extractor for log-likelihood of <code>blm</code> model.
</p>
</dd>
<dt>model.formula</dt><dd><p><code>signature(object = "blm")</code>:
Extractor for formula of <code>blm</code> object. 
</p>
</dd>
<dt>resid</dt><dd><p><code>signature(object = "blm")</code>:
Extractor for residuals. 
</p>
</dd>
<dt>vcov</dt><dd><p><code>signature(object = "blm")</code>:
Extractor for variance-covariance based on Taylor series large-sample Hessian approximation with the pseudo-likelihood of the constrained optimization.
</p>
</dd>
<dt>predict</dt><dd><p><code>signature(object = "blm")</code>:
Returns vector of linear predictors for each subject of the fitted model.
</p>
</dd>
<dt>confint</dt><dd><p><code>signature(object = "blm", parm, level = 0.95,...)</code>:
Returns confidence interval (at a given <code>level</code>) for the specified regression parameters.
</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+blm">blm</a></code>, <code><a href="stats.html#topic+constrOptim">constrOptim</a></code></p>

<hr>
<h2 id='ccdata'>Simulated case-control dataset</h2><span id='topic+ccdata'></span>

<h3>Description</h3>

<p>Simulated population-based case-control dataset</p>


<h3>Usage</h3>

<pre><code class='language-R'>ccdata
</code></pre>


<h3>Format</h3>


<table>
<tr>
 <td style="text-align: left;">
    female:</td><td style="text-align: left;"> indicator for female gender </td>
</tr>
<tr>
 <td style="text-align: left;">
    packyear:</td><td style="text-align: left;"> discrete variable representing pack-years smoked </td>
</tr>
<tr>
 <td style="text-align: left;">
    strata: </td><td style="text-align: left;"> stratification variable </td>
</tr>
<tr>
 <td style="text-align: left;">
    y: </td><td style="text-align: left;"> indicator of case status (1 for case, 0 for control) </td>
</tr>
<tr>
 <td style="text-align: left;">
    w: </td><td style="text-align: left;"> inverse of sampling fraction
  </td>
</tr>

</table>


<hr>
<h2 id='coef'>Get coefs from <code>blm</code> and <code>lexpit</code> objects.</h2><span id='topic+coef.blm'></span><span id='topic+coef+2Cblm-method'></span><span id='topic+coef+2Clexpit-method'></span>

<h3>Description</h3>

<p>Extract vector of coefs of the fit of a <code>blm</code> or <code>lexpit</code> model.
</p>


<h3>Methods</h3>


<dl>
<dt>coef</dt><dd><p><code>signature(object = "blm")</code>:
Extractor for MLEs returned as a matrix with one column.
</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>S. Kovalchik <a href="mailto:s.a.kovalchik@gmail.com">s.a.kovalchik@gmail.com</a></p>

<hr>
<h2 id='confint'>Confidence intervals for parameters of <code>blm</code> and <code>lexpit</code> objects.</h2><span id='topic+confint.blm'></span><span id='topic+confint+2Cblm-method'></span><span id='topic+confint+2Clexpit-method'></span>

<h3>Description</h3>

<p>Return the confidence intervals for specified parameters and confidence level.
</p>


<h3>Methods</h3>


<dl>
<dt>confint</dt><dd><p><code>signature(object = "blm", parm, level = 0.95,...)</code>:
Returns confidence interval (at a given <code>level</code>) for the specified regression parameters.
</p>
</dd>
<dt>confint</dt><dd><p><code>signature(object = "lexpit", parm, level = 0.95,...)</code>:
Returns confidence interval (at a given <code>level</code>) for the specified regression parameters.
</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Stephanie Kovalchik <a href="mailto:s.a.kovalchik@gmail.com">s.a.kovalchik@gmail.com</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(ccdata)

fit &lt;- lexpit(y~female, y~packyear, data = ccdata,
       			weight = ccdata$w, strata = ccdata$strata)

confint(fit)
</code></pre>

<hr>
<h2 id='crude.risk'>Risk-exposure scatter plot</h2><span id='topic+crude.risk'></span>

<h3>Description</h3>

<p>Calculates the weighted average crude risk against the average exposure level for a continuous exposure. Each point corresponds to overlapping subgroups of 20 percent of the sample ordered from lowest to highest exposure and a sliding window of 1
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crude.risk(formula, data, weights = NULL, na.action = na.omit) 
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="crude.risk_+3A_formula">formula</code></td>
<td>
<p>formula specifying the binary outcome and the continuous covariate of interest, e.g. <code>y~x</code></p>
</td></tr>
<tr><td><code id="crude.risk_+3A_data">data</code></td>
<td>
<p>dataframe containing the variables specified in <code>formula</code></p>
</td></tr>
<tr><td><code id="crude.risk_+3A_weights">weights</code></td>
<td>
<p>vector of sample weights</p>
</td></tr>
<tr><td><code id="crude.risk_+3A_na.action">na.action</code></td>
<td>
<p>function used for handling missing variables in the variables of <code>formula</code> and <code>weights</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>crude.risk</code> function is intended to explore the possible functional relationship between risk and exposure in a non-parametric way.
</p>


<h3>Author(s)</h3>

<p>S. Kovalchik <a href="mailto:s.a.kovalchik@gmail.com">s.a.kovalchik@gmail.com</a></p>


<h3>See Also</h3>

<p><a href="#topic+risk.exposure.plot">risk.exposure.plot</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(aarp)

risk &lt;- crude.risk(bladder70~redmeat,
		  weights = aarp$w,
		  data = aarp)

risk.exposure.plot(risk,
		   xlab = "Avg. Red Meat Consumption")

</code></pre>

<hr>
<h2 id='EO'>Compute the ratio of expected event to observed events for <code>blm</code> and <code>lexpit</code> objects.</h2><span id='topic+EO'></span>

<h3>Description</h3>

<p>Returns a list of expected to observed counts and the specified confidence interval. The argument <code>group</code> can be used to estimate this ratio by the categories of the categorical variable <code>group</code>. If population-based case-control data is used to fit the model, the expected counts are for the population and make use of the sampling weights. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EO(object, index = NULL, level = 0.95)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="EO_+3A_object">object</code></td>
<td>
<p>object of class <code>blm</code> or <code>lexpit</code></p>
</td></tr>
<tr><td><code id="EO_+3A_index">index</code></td>
<td>
<p>factor for computing E/O comparison by subgroups</p>
</td></tr>
<tr><td><code id="EO_+3A_level">level</code></td>
<td>
<p>numeric, confidence level (between 0 and 1) for the E/O ratios</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame with:
</p>

<dl>
<dt><code>E</code></dt><dd><p>expected count</p>
</dd>
<dt><code>O</code></dt><dd><p>observed counts</p>
</dd>
<dt><code>EtoO</code></dt><dd><p>ratio of expected to observed</p>
</dd>
<dt><code>lowerCI</code></dt><dd><p>lower endpoint of confidence interval for E over O ratio</p>
</dd>
<dt><code>upperCI</code></dt><dd><p>upper endpoint of confidence interval for E over O ratio</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Stephanie Kovalchik <a href="mailto:s.a.kovalchik@gmail.com">s.a.kovalchik@gmail.com</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(ccdata)

fit &lt;- blm(y~female+packyear,data = ccdata,
			weight = ccdata$w, strata = ccdata$strata)

EO(fit)

EO(fit, ccdata$strata) # BY FACTOR
</code></pre>

<hr>
<h2 id='expit'>Inverse-logit function</h2><span id='topic+expit'></span>

<h3>Description</h3>

<p>Returns the inverse logit. Where,
</p>
<p style="text-align: center;"><code class="reqn">
expit(x) = \frac{\exp(x)}{(1+\exp(x))}
</code>
</p>



<h3>Usage</h3>

<pre><code class='language-R'>expit(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="expit_+3A_x">x</code></td>
<td>
<p>numeric vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric that is the inverse logit of <code>x</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
expit(1:10)

</code></pre>

<hr>
<h2 id='gof'>Hosmer-lemeshow goodness-of-fit statistics for <code>blm</code> and <code>lexpit</code> objects.</h2><span id='topic+gof'></span>

<h3>Description</h3>

<p>Computes the deviance and Pearson chi-squared statistics for the fit from a <code>blm</code> or <code>lexpit</code> model. These tests are appropriate when all predictors are categorical and there are many replicates within each covariate class.
</p>


<h3>Value</h3>

<p>Returns a list with <code>table</code>, with expected <code>E</code> and observed <code>O</code>, and the chi-square test <code>chisq</code> and p-value (<code>p.value</code>) for the Pearson goodness-of-fit test. The observed and expected count are listed in the order of the unique levels formed by the design matrix.
</p>
<p>When sample weights are present, the goodness-of-fit test is a modified F-test as suggested by Archer et al. (2007).
</p>


<h3>usage</h3>

<p>gof(object)
</p>


<h3>arguments</h3>


<dl>
<dt>object</dt><dd><p>instance of <code>blm</code> or <code>lexpit</code></p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Stephanie Kovalchik <a href="mailto:s.a.kovalchik@gmail.com">s.a.kovalchik@gmail.com</a></p>


<h3>References</h3>

<p>Archer KJ, Lemeshow S, Hosmer DW. Goodness-of-fit tests for logistic regression models when data are collected using a complex sampling design. <em>Computational Statistics &amp; Data Analysis</em>. 2007;51:4450&ndash;4464. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+blm">blm</a></code>, <code><a href="#topic+lexpit">lexpit</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(ccdata)

ccdata$packyear &lt;- ccdata$packyear+runif(nrow(ccdata))

# UNWEIGHTED GOF
fit &lt;- blm(y~female+packyear,data = ccdata)
gof(fit)

# WEIGHTED GOF
fit &lt;- blm(y~female+packyear,data = ccdata, weight = ccdata$w)
gof(fit)

</code></pre>

<hr>
<h2 id='gof.pearson'>Pearson's goodness-of-fit statistics for <code>blm</code> and <code>lexpit</code> objects.</h2><span id='topic+gof.pearson'></span>

<h3>Description</h3>

<p>Computes the deviance and Pearson chi-squared statistics for the fit from a <code>blm</code> or <code>lexpit</code> model. These tests are appropriate when all predictors are categorical and there are many replicates within each covariate class.
</p>


<h3>Value</h3>

<p>Returns a list with expected <code>E</code> and observed <code>O</code> and the chi-square test <code>chisq</code> and p-value (<code>p.value</code>) for the Pearson goodness-of-fit test. The observed and expected count are listed in the order of the unique levels formed by the design matrix.
</p>


<h3>usage</h3>

<p>gof.pearson(object)
</p>


<h3>arguments</h3>


<dl>
<dt>object</dt><dd><p>instance of <code>blm</code> or <code>lexpit</code></p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Stephanie Kovalchik <a href="mailto:s.a.kovalchik@gmail.com">s.a.kovalchik@gmail.com</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+blm">blm</a></code>, <code><a href="#topic+lexpit">lexpit</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(ccdata)

fit &lt;- blm(y~female+I(packyear&gt;20),data = ccdata,
			weight = ccdata$w, strata = ccdata$strata)

gof.pearson(fit)

</code></pre>

<hr>
<h2 id='lexpit'>Fit a linear-expit regression model</h2><span id='topic+lexpit'></span>

<h3>Description</h3>

<p>A direct probability model for regression with a binary outcome from observational data. Covariate effects are the sum of additive terms and an expit term, which allows some explanatory variables to be additive and others non-linear.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lexpit(formula.linear,formula.expit,data,na.action=na.omit,
					weights=NULL,strata=NULL,par.init=NULL,
					warn = FALSE,
					control.lexpit=list(max.iter=1000,tol=1E-7),...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lexpit_+3A_formula.linear">formula.linear</code></td>
<td>
<p>formula for linear model for binary outcome, <code>event~x1+x2+...</code></p>
</td></tr>
<tr><td><code id="lexpit_+3A_formula.expit">formula.expit</code></td>
<td>
<p>formula for expit model, linear in expit, <code>event~z1+z2+...</code></p>
</td></tr>
<tr><td><code id="lexpit_+3A_data">data</code></td>
<td>
<p>data.frame containing the variables of <code>formula.linear</code> and <code>formula.expit</code></p>
</td></tr>
<tr><td><code id="lexpit_+3A_na.action">na.action</code></td>
<td>
<p>function specifying how missing data should be handled, <a href="stats.html#topic+na.action">na.action</a></p>
</td></tr>
<tr><td><code id="lexpit_+3A_weights">weights</code></td>
<td>
<p>Vector of weights equal to the number of observations. For population-based case-control study, weights are the inverse sampling fractions for controls.</p>
</td></tr>
<tr><td><code id="lexpit_+3A_strata">strata</code></td>
<td>
<p>vector indicating the stratification for weighted regression with stratified observational data</p>
</td></tr>
<tr><td><code id="lexpit_+3A_par.init">par.init</code></td>
<td>
<p>list (optional) of initial parameters for <code>linear</code> and <code>expit</code> terms.</p>
</td></tr>
<tr><td><code id="lexpit_+3A_warn">warn</code></td>
<td>
<p>logical indicator whether to include warnings during algorithm fitting. Default of <code>FALSE</code> suppresses warnings when testing for feasible parameters.</p>
</td></tr>
<tr><td><code id="lexpit_+3A_control.lexpit">control.lexpit</code></td>
<td>
<p>list with control parameters for optimization algorithm</p>
</td></tr>
<tr><td><code id="lexpit_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code>constrOptim</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>lexpit</code> model uses a two-stage optimization procedure. At the first stage linear terms the solutions to the maximum of a pseudo log-likelihood using a constrained optimization algorithm with an adaptive barrier method, <code>constrOptim</code> (Lange, 2010). The second stage maximizes the pseudo log-likelihood with respect to the expit terms using iterative reweighted least squares with an offset term for the linear component of the model.
</p>
<p>Variance estimates are based on Taylor linearization (Shah, 2002). When <code>weights</code> are not NULL, it is assumed that the study is a case-control design. 
</p>


<h3>Value</h3>

<p>Returns an object of class <code>lexpit</code>.
</p>


<h3>Author(s)</h3>

<p>S. Kovalchik <a href="mailto:s.a.kovalchik@gmail.com">s.a.kovalchik@gmail.com</a></p>


<h3>References</h3>

<p>Kovalchik S, Varadhan R (2013). Fitting Additive Binomial Regression Models with the R Package blm. <em>Journal of Statistical Software</em>, 54(1), 1-18. URL: <a href="https://www.jstatsoft.org/v54/i01/">https://www.jstatsoft.org/v54/i01/</a>.
</p>
<p>Lange, K. (2010) <em>Numerical Analysis for Statisticians</em>, Springer.
</p>
<p>Shah, BV. (2002) Calculus of Taylor deviations. Joint Statistical Meetings.
</p>


<h3>See Also</h3>

<p><a href="stats.html#topic+constrOptim">constrOptim</a>, <a href="stats.html#topic+nlm">nlm</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(ccdata)

fit &lt;- lexpit(y~female,y~packyear,weights = ccdata$w,
       		strata=ccdata$strata,data=ccdata)

summary(fit)

# LEXPIT MODEL FOR BLADDER CANCER RISK BY AGE 70
formula.linear &lt;- bladder70~female * smoke_status
formula.expit &lt;- bladder70~redmeat+fiber.centered+I(fiber.centered^2)

# ADDITIVE EFFECTS FOR GENDER AND SMOKING
# LOGISTIC EFFECTS FOR FIBER AND REDMEAT CONSUMPTION
data(aarp)

fit &lt;- lexpit(formula.linear, formula.expit, aarp, weight=aarp$w)
logLik(fit)

model.formula(fit)

# SUMMARY
summary(fit)
confint(fit)

# FITTED ABSOLUTE RISK PER 1,000 PERSONS
head(predict(fit)*1000)
</code></pre>

<hr>
<h2 id='lexpit-class'>Class &quot;lexpit&quot;</h2><span id='topic+lexpit-class'></span>

<h3>Description</h3>

<p>Class for linear-expit regression (lexpit).
</p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("lexpit", ...)</code>. 
</p>


<h3>Slots</h3>


<dl>
<dt><code>coef.linear</code>:</dt><dd><p>vector of fitted linear coefficients</p>
</dd>
<dt><code>coef.expit</code>:</dt><dd><p>vector of fitted expit coefficients</p>
</dd>
<dt><code>vcov.linear</code>:</dt><dd><p>matrix of variance-covariate estimates for linear <code>coef</code></p>
</dd>
<dt><code>vcov.expit</code>:</dt><dd><p>matrix of variance-covariate estimates for expit <code>coef</code></p>
</dd>
<dt><code>formula.linear</code>:</dt><dd><p>model formula for linear component</p>
</dd>
<dt><code>formula.expit</code>:</dt><dd><p>model formula for expit component</p>
</dd>
<dt><code>df.residual</code>:</dt><dd><p>residual degrees of freedom</p>
</dd>
<dt><code>p</code>:</dt><dd><p>number of linear parameters</p>
</dd>
<dt><code>q</code>:</dt><dd><p>number of expit parameters</p>
</dd>
<dt><code>data</code>:</dt><dd><p>data frame used in fitting, after applying <code>na.action</code></p>
</dd>
<dt><code>which.kept</code>:</dt><dd><p>vector of index of values in original data source that were used in the model fitting</p>
</dd>
<dt><code>y</code>:</dt><dd><p>response vector for fitted model</p>
</dd>	
<dt><code>weights</code>:</dt><dd><p>vector of weights used in model fitting</p>
</dd>
<dt><code>strata</code>:</dt><dd><p>stratification factor for weighted regression.</p>
</dd>
<dt><code>converged</code>:</dt><dd><p>logical message about convergence status at the end of algorithm</p>
</dd>
<dt><code>par.init</code>:</dt><dd><p>initial parameter values for optimization algorithm</p>
</dd>
<dt><code>loglik</code></dt><dd><p>value of log-likelihood (normalized for weighted likelihood) under full model</p>
</dd> 
<dt><code>loglik.null</code></dt><dd><p>value of log-likelihood (normalized for weighted likelihood) under null model</p>
</dd> 
<dt><code>barrier.value</code></dt><dd><p>value of the barrier function at the optimum</p>
</dd>
<dt><code>control.lexpit</code></dt><dd><p>list with control parameters for optimization algorithm</p>
</dd>
</dl>
 


<h3>Methods</h3>


<dl>
<dt>show</dt><dd><p><code>signature(object = "lexpit")</code>:
Display point estimates of <code>lexpit</code> object.
</p>
</dd>
<dt>print</dt><dd><p><code>signature(x = "lexpit",...)</code>:
Display point estimates of <code>lexpit</code> object.
</p>
</dd>
<dt>summary</dt><dd><p><code>signature(object = "lexpit",...)</code>:
List of estimates and convergence information.
</p>
</dd>
<dt>coef</dt><dd><p><code>signature(object = "lexpit")</code>:
Extractor for fitted coefficients. 
</p>
</dd>
<dt>logLik</dt><dd><p><code>signature(object = "lexpit")</code>:
Extractor for log-likelihood of <code>lexpit</code> model.
</p>
</dd>
<dt>model.formula</dt><dd><p><code>signature(object = "lexpit")</code>:
Extractor for formula of <code>lexpit</code> object. 
</p>
</dd>
<dt>vcov</dt><dd><p><code>signature(object = "lexpit")</code>:
Extractor for variance-covariance based on Taylor series large-sample Hessian approximation with the pseudo-likelihood of the constrained optimization.
</p>
</dd>
<dt>resid</dt><dd><p><code>signature(object = "lexpit")</code>:
Extractor for residuals. 
</p>
</dd>
<dt>predict</dt><dd><p><code>signature(object = "lexpit")</code>:
Returns vector of linear predictors for each subject of the fitted model.
</p>
</dd>
<dt>confint</dt><dd><p><code>signature(object = "lexpit", parm, level = 0.95,...)</code>:
Returns confidence interval (at a given <code>level</code>) for the specified regression parameters.
</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+lexpit">lexpit</a></code>, <code><a href="stats.html#topic+constrOptim">constrOptim</a></code></p>

<hr>
<h2 id='logit'>Logit function</h2><span id='topic+logit'></span>

<h3>Description</h3>

<p>Returns the logit. Where,
</p>
<p style="text-align: center;"><code class="reqn">
logit(x) = \log(x/(1-x))
</code>
</p>



<h3>Usage</h3>

<pre><code class='language-R'>logit(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="logit_+3A_x">x</code></td>
<td>
<p>numeric vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric that is the logit of <code>x</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+expit">expit</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
logit(1:10)

</code></pre>

<hr>
<h2 id='logLik'>Log-likelihood of <code>blm</code> and <code>lexpit</code> objects.</h2><span id='topic+logLik.blm'></span><span id='topic+logLik+2Cblm-method'></span><span id='topic+logLik+2Clexpit-method'></span>

<h3>Description</h3>

<p>Method to access the log-likelihood of the fitted <code>blm</code> or <code>lexpit</code> model.
</p>


<h3>Details</h3>

<p>The return object is of the <code>logLik</code> class. This method is registered with the <a href="stats4.html#topic+stats4">stats4</a> package and can therefore be used with applicable methods like <a href="stats.html#topic+AIC">AIC</a> and <a href="stats.html#topic+BIC">BIC</a>.
Note that when weights are used in the model estimation, the <code>logLik</code> is a pseduo-log-likelihood.
</p>


<h3>Methods</h3>


<dl>
<dt>logLik</dt><dd><p><code>signature(object = "blm",...)</code>:
Extract log-likelihood. Returns object of <code>logLik</code> class.
</p>
</dd>
<dt>logLik</dt><dd><p><code>signature(object = "lexpit",...)</code>:
Extract log-likelihood. Returns object of <code>logLik</code> class.
</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Stephanie Kovalchik <a href="mailto:s.a.kovalchik@gmail.com">s.a.kovalchik@gmail.com</a></p>


<h3>See Also</h3>

<p><a href="stats.html#topic+logLik.lm">logLik.lm</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(ccdata)

fit &lt;- lexpit(y~female, y~packyear, data = ccdata,
       			weight = ccdata$w, strata = ccdata$strata)

logLik(fit)

AIC(fit)
</code></pre>

<hr>
<h2 id='LRT'>Performs likelihood-ratio test for lexpit and BLM models of cohort data</h2><span id='topic+LRT'></span>

<h3>Description</h3>

<p>Computes the likelihood ratio test for the significance of the specified variable in a lexpit or BLM model fit to cohort data. This method is only valid for study designs that use simple random sampling.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LRT(object, var)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LRT_+3A_object">object</code></td>
<td>
<p>a model of the <code>lexpit</code> or <code>blm</code> class.</p>
</td></tr>
<tr><td><code id="LRT_+3A_var">var</code></td>
<td>
<p>character name of <code>term.label</code> to be tested</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix with the LRT statistic and p-value for the test of the significance of the specified variable given all other variables in the model.
</p>


<h3>Author(s)</h3>

<p>S. Kovalchik <a href="mailto:s.a.kovalchik@gmail.com">s.a.kovalchik@gmail.com</a></p>


<h3>See Also</h3>

<p><a href="stats.html#topic+constrOptim">constrOptim</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>

cohort &lt;- data.frame(
	x1 = runif(500),
	x2 = runif(500)
)

cohort$event &lt;- rbinom(n=nrow(cohort),size=1,
			prob=0.25+0.1*cohort$x1+.1*cohort$x2)

fit &lt;- blm(event~x1+x2, data=cohort)

summary(fit)

LRT(fit, "x1")
LRT(fit, "x2")

</code></pre>

<hr>
<h2 id='model.formula'>Get formula call for <code>blm</code> and <code>lexpit</code> objects.</h2><span id='topic+model.formula'></span><span id='topic+model.formula+2Cblm-method'></span><span id='topic+model.formula+2Clexpit-method'></span>

<h3>Description</h3>

<p>Extract vector of formula of the fit of a <code>blm</code> or the formulas for the <code>lexpit</code> model.
</p>


<h3>Methods</h3>


<dl>
<dt>model.formula</dt><dd><p><code>signature(object = "blm")</code>:
Extractor for formula of <code>blm</code> object.
</p>
</dd>
<dt>model.formula</dt><dd><p><code>signature(object = "lexpit")</code>:
Extractor for formulas of <code>lexpit</code> object. Returns a list containing the <code>linear</code> and <code>expit</code> formulas.
</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>S. Kovalchik <a href="mailto:s.a.kovalchik@gmail.com">s.a.kovalchik@gmail.com</a></p>

<hr>
<h2 id='predict'>Get risk predictions for <code>blm</code> and <code>lexpit</code> objects.</h2><span id='topic+predict.blm'></span><span id='topic+predict+2Cblm-method'></span><span id='topic+predict+2Clexpit-method'></span>

<h3>Description</h3>

<p>Computes vector of risk predictions for the dataset used to fit the model. As with method <code>predict.glm</code>, standard errors for fitted values can be requested and predictions for the covariates of the data frame <code>newdata</code> can be computed rather than the default computation of all fitted values for the data frame used for model fitting.
</p>


<h3>Methods</h3>


<dl>
<dt>predict</dt><dd><p><code>signature(object = "blm", newdata, se = FALSE)</code>:
Risk predictions for fit design matrix. 
</p>
</dd>
<dt>predict</dt><dd><p><code>signature(object = "lexpit", newdata, se = FALSE)</code>:
Risk predictions for fit design matrix. 
</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Stephanie Kovalchik <a href="mailto:s.a.kovalchik@gmail.com">s.a.kovalchik@gmail.com</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(ccdata)

fit &lt;- lexpit(y~female, y~packyear, data = ccdata,
       			weight = ccdata$w, strata = ccdata$strata)

predict(fit)[1:10]
</code></pre>

<hr>
<h2 id='print'>Print coefficients of <code>blm</code> and <code>lexpit</code> model fit.</h2><span id='topic+print.blm'></span><span id='topic+print+2Cblm-method'></span><span id='topic+print+2Clexpit-method'></span>

<h3>Description</h3>

<p>Prints the regression coefficients of the fit of a <code>blm</code> or <code>lexpit</code> model.
</p>


<h3>Methods</h3>


<dl>
<dt>print</dt><dd><p><code>signature(x = "blm")</code>:
Call and coefficient estimates.
</p>
</dd>
<dt>print</dt><dd><p><code>signature(x = "lexpit")</code>:
Call and coefficient estimates.
</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Stephanie Kovalchik <a href="mailto:s.a.kovalchik@gmail.com">s.a.kovalchik@gmail.com</a></p>

<hr>
<h2 id='resid'>Get residuals from <code>blm</code> and <code>lexpit</code> objects.</h2><span id='topic+resid.blm'></span><span id='topic+resid+2Cblm-method'></span><span id='topic+resid+2Clexpit-method'></span>

<h3>Description</h3>

<p>Extract residuals of model fit.
</p>


<h3>Methods</h3>


<dl>
<dt>resid</dt><dd><p><code>signature(object = "blm")</code>:
Extractor for residuals of <code>blm</code> object. 
</p>
</dd>
<dt>resid</dt><dd><p><code>signature(object = "lexpit")</code>:
Extractor for residuals of <code>blm</code> object. 
</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Stephanie Kovalchik <a href="mailto:s.a.kovalchik@gmail.com">s.a.kovalchik@gmail.com</a></p>

<hr>
<h2 id='risk.exposure.plot'>Risk-exposure scatter plot</h2><span id='topic+risk.exposure.plot'></span>

<h3>Description</h3>

<p>Calculates the weighted average crude risk against the average exposure level for a continuous exposure. Each point corresponds to overlapping subgroups of 20 percent of the sample ordered from lowest to highest exposure and a sliding window of 1
</p>


<h3>Usage</h3>

<pre><code class='language-R'>risk.exposure.plot(object, scale=1,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="risk.exposure.plot_+3A_object">object</code></td>
<td>
<p>list or data.frame with <code>risk</code> and <code>x</code> covariate. Return object of <a href="#topic+crude.risk">crude.risk</a></p>
</td></tr>
<tr><td><code id="risk.exposure.plot_+3A_scale">scale</code></td>
<td>
<p>multiplicative factor to modify scale of crude risk estimates</p>
</td></tr>
<tr><td><code id="risk.exposure.plot_+3A_...">...</code></td>
<td>
<p>additional arguments passed to <a href="stats.html#topic+scatter.smooth">scatter.smooth</a></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The risk-exposure scatter plot is intended to explore the possible functional relationship between risk and exposure.
</p>


<h3>Author(s)</h3>

<p>S. Kovalchik <a href="mailto:s.a.kovalchik@gmail.com">s.a.kovalchik@gmail.com</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(aarp)

risk &lt;- crude.risk(bladder70~redmeat,
		  weights = aarp$w,
		  data = aarp)

risk.exposure.plot(risk,
		   xlab = "Avg. Red Meat Consumption")

</code></pre>

<hr>
<h2 id='Rsquared'>Compute R-squared measures of model fit for <code>blm</code> and <code>lexpit</code> objects.</h2><span id='topic+Rsquared'></span>

<h3>Description</h3>

<p>Returns McFadden's unadjusted and adjusted R-squared measures for models of a binary outcome. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Rsquared(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Rsquared_+3A_object">object</code></td>
<td>
<p>object of class <code>blm</code> or <code>lexpit</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of <code>R2</code> and <code>R2adj</code>.
</p>


<h3>Author(s)</h3>

<p>Stephanie Kovalchik <a href="mailto:s.a.kovalchik@gmail.com">s.a.kovalchik@gmail.com</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(ccdata)

fit &lt;- blm(y~female+packyear,data = ccdata,
			weight = ccdata$w, strata = ccdata$strata)

Rsquared(fit)
</code></pre>

<hr>
<h2 id='show'>Show <code>blm</code> and <code>lexpit</code> model fit.</h2><span id='topic+show.blm'></span><span id='topic+show+2Cblm-method'></span><span id='topic+show+2Clexpit-method'></span>

<h3>Description</h3>

<p>Print estimates of a <code>blm</code> or <code>lexpit</code> model fit.
</p>


<h3>Methods</h3>


<dl>
<dt>show</dt><dd><p><code>signature(object = "blm")</code>:
Call and coefficient estimates.
</p>
</dd>
<dt>show</dt><dd><p><code>signature(object = "lexpit")</code>:
Call and coefficient estimates.
</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Stephanie Kovalchik <a href="mailto:s.a.kovalchik@gmail.com">s.a.kovalchik@gmail.com</a></p>

<hr>
<h2 id='summary'>Summary of <code>blm</code> and <code>lexpit</code> model fit.</h2><span id='topic+summary.blm'></span><span id='topic+summary+2Cblm-method'></span><span id='topic+summary+2Clexpit-method'></span>

<h3>Description</h3>

<p>A list of estimates and convergence status of a <code>blm</code> or <code>lexpit</code> model fit.
</p>


<h3>Methods</h3>


<dl>
<dt>summary</dt><dd><p><code>signature(object = "blm")</code>:
Matrix of estimates and convergence information.
</p>
</dd>
<dt>summary</dt><dd><p><code>signature(object = "lexpit")</code>:
Matrix of estimates and convergence information.
</p>
</dd>
</dl>
<p>The matrix returned has the named components:
</p>
<dl>
<dt>Est.</dt><dd><p>vector of estimated regression coefficients. For lexpit model estimates are split into <code>est.linear</code> and <code>est.expit</code> components of list</p>
</dd>
<dt>Std. Err</dt><dd><p>standard error of model estimates</p>
</dd>
<dt>t-value</dt><dd><p>t-value of model estimates</p>
</dd>
<dt>p-value</dt><dd><p>p-value (two-sided) of model estimates</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>S. Kovalchik <a href="mailto:s.a.kovalchik@gmail.com">s.a.kovalchik@gmail.com</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+blm">blm</a></code>, <code><a href="#topic+lexpit">lexpit</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(ccdata)

fit &lt;- blm(y~female+packyear,data = ccdata,
			weight = ccdata$w, strata = ccdata$strata)

summary(fit)

fit.lexpit &lt;- lexpit(y~female, y~packyear,data = ccdata,
			weight = ccdata$w, strata = ccdata$strata)

summary(fit.lexpit)


</code></pre>

<hr>
<h2 id='vcov'>Get variance-covariance from <code>blm</code> and <code>lexpit</code> objects.</h2><span id='topic+vcov.blm'></span><span id='topic+vcov+2Cblm-method'></span><span id='topic+vcov+2Clexpit-method'></span>

<h3>Description</h3>

<p>Returns Hessian-based variance-covariance matrix of the fit of a <code>blm</code> or <code>lexpit</code> model. If any constraints are active, only the augmented Lagrangian takes this into account in the Hessian computation, so if <code>augmented</code> is <code>FALSE</code>, i.e. the adaptive barrier method of optimization is used, the covariance-variance might be inaccurate.
</p>


<h3>Methods</h3>


<dl>
<dt>vcov</dt><dd><p><code>signature(object = "blm")</code>:
Extractor for variance-covariance of MLEs. 
</p>
</dd>
<dt>vcov</dt><dd><p><code>signature(object = "lexpit")</code>:
Extractor for variance-covariance of MLEs. 
</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Stephanie Kovalchik <a href="mailto:s.a.kovalchik@gmail.com">s.a.kovalchik@gmail.com</a></p>

<hr>
<h2 id='which.at.boundary'>Covariate patterns at the boundary for <code>blm</code> and <code>lexpit</code> objects.</h2><span id='topic+which.at.boundary'></span>

<h3>Description</h3>

<p>Returns matrix of covariate types with a predicted probability at the lower or upper boundary defined by the specified <code>criterion</code> or <code>NA</code> if no boundary constraints are present.
</p>


<h3>Value</h3>

<p>Returns all rows of design matrix whose predicted risk are less than or equal to <code>criterion</code> or greater than or equal to 1 - <code>criterion</code>.
</p>


<h3>usage</h3>

<p>which.at.boundary  (object, criterion = 1e-06) 
</p>


<h3>arguments</h3>


<dl>
<dt>object</dt><dd><p>model fit of class <code>blm</code> or <code>lexpit</code></p>
</dd>
<dt>criterion</dt><dd><p>numeric distance from 0 (or 1) that is considered to be at the boundary</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Stephanie Kovalchik <a href="mailto:s.a.kovalchik@gmail.com">s.a.kovalchik@gmail.com</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(ccdata)

fit &lt;- blm(y~female+packyear,data = ccdata,
			weight = ccdata$w, strata = ccdata$strata)

which.at.boundary(fit)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
