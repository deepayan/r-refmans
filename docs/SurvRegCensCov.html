<!DOCTYPE html><html lang="en"><head><title>Help for package SurvRegCensCov</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SurvRegCensCov}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#SurvRegCensCov-package'><p>Weibull Regression for a Right-Censored Endpoint with Interval-Censored Covariates</p></a></li>
<li><a href='#CDF'><p>Cumulative distribution function</p></a></li>
<li><a href='#censorContVar'><p>Censor a vector of continuous numbers</p></a></li>
<li><a href='#coef.src'><p>Extract coefficients of Weibull regression with an interval-censored covariate</p></a></li>
<li><a href='#ConvertWeibull'><p>Transformation of survreg output for the Weibull distribution</p></a></li>
<li><a href='#larynx'><p>Survival Times of Larynx Cancer Patients</p></a></li>
<li><a href='#logLik.src'><p>Extract value of log-likelihood at maximum for Weibull regression with an interval-censored covariate</p></a></li>
<li><a href='#LoglikCens'><p>Log-likelihood functions for estimation of canonical parameters from a censored sample</p></a></li>
<li><a href='#LoglikNormalDeltaCens'><p>Log likelihood function to compute mean difference between two normally distributed censored samples.</p></a></li>
<li><a href='#LoglikWeibullSurvRegCens'><p>Log-likelihood function of a Weibull Survival Regression Model allowing for an interval-censored covariate.</p></a></li>
<li><a href='#NormalMeanDiffCens'><p>Maximum Likelihood Estimator for the mean difference between two censored normally distributed samples</p></a></li>
<li><a href='#ParamSampleCens'><p>Maximum Likelihood Estimator of parameters from a censored sample</p></a></li>
<li><a href='#print.src'><p>Print result of Weibull regression with an interval-censored covariate</p></a></li>
<li><a href='#summary.src'><p>Summarizing Weibull regression with an interval-censored covariate</p></a></li>
<li><a href='#SurvRegCens'><p>Weibull Survival Regression Model with a censored covariate</p></a></li>
<li><a href='#TimeSampleWeibull'><p>Generate time-to-event data according to a Weibull regression model</p></a></li>
<li><a href='#WeibullDiag'><p>Diagnostic Plot of Adequacy of Weibull Distribution</p></a></li>
<li><a href='#WeibullIntegrate'><p>Function to be integrated in function <code>SurvRegCens</code></p></a></li>
<li><a href='#WeibullReg'><p>Weibull Regression for Survival Data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Weibull Regression for a Right-Censored Endpoint with
Interval-Censored Covariate</td>
</tr>
<tr>
<td>Version:</td>
<td>1.7</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-09-27</td>
</tr>
<tr>
<td>Author:</td>
<td>Stanislas Hubeaux &lt;stan.hubeaux@bluewin.ch&gt; and Kaspar Rufibach &lt;kaspar.rufibach@gmail.com&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Stanislas Hubeaux &lt;stan.hubeaux@bluewin.ch&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10), survival, stats, graphics</td>
</tr>
<tr>
<td>Imports:</td>
<td>numDeriv</td>
</tr>
<tr>
<td>Description:</td>
<td>The function SurvRegCens() of this package allows estimation of a Weibull Regression for a right-censored endpoint, one interval-censored covariate, and an arbitrary number of non-censored covariates. Additional functions allow to switch between different parametrizations of Weibull regression used by different R functions, inference for the mean difference of two arbitrarily censored Normal samples, and estimation of canonical parameters from censored samples for several distributional assumptions. Hubeaux, S. and Rufibach, K. (2014) &lt;<a href="https://doi.org/10.48550/arXiv.1402.0432">doi:10.48550/arXiv.1402.0432</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-09-27 12:12:52 UTC; hubeauxs</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-09-27 12:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='SurvRegCensCov-package'>Weibull Regression for a Right-Censored Endpoint with Interval-Censored Covariates</h2><span id='topic+SurvRegCensCov.package'></span><span id='topic+SurvRegCensCov'></span><span id='topic+SurvRegCensCov-package'></span>

<h3>Description</h3>

<p>The function <code><a href="#topic+SurvRegCens">SurvRegCens</a></code> of this package allows estimation of a Weibull Regression for a right-censored endpoint, one interval-censored covariate, and an arbitrary number of non-censored covariates. Additional functions allow to switch between different parametrizations of Weibull regression used by different <code>R</code> functions (<code><a href="#topic+ConvertWeibull">ConvertWeibull</a></code>, <code><a href="#topic+WeibullReg">WeibullReg</a></code>, <code><a href="#topic+WeibullDiag">WeibullDiag</a></code>), inference for the mean difference of two arbitrarily censored Normal samples (<code><a href="#topic+NormalMeanDiffCens">NormalMeanDiffCens</a></code>), and estimation of canonical parameters from censored samples for several distributional assumptions (<code><a href="#topic+ParamSampleCens">ParamSampleCens</a></code>).
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> SurvRegCensCov</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.7</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2023-09-27</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;=2) </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Stanislas Hubeaux (maintainer), <a href="mailto:stan.hubeaux@bluewin.ch">stan.hubeaux@bluewin.ch</a> 
</p>
<p>Kaspar Rufibach, <a href="mailto:kaspar.rufibach@gmail.com">kaspar.rufibach@gmail.com</a> <br /> <a href="http://www.kasparrufibach.ch">http://www.kasparrufibach.ch</a>
</p>
<p>We thank Sarah Haile for contributing the functions <code><a href="#topic+ConvertWeibull">ConvertWeibull</a></code>, <code><a href="#topic+WeibullReg">WeibullReg</a></code>, <code><a href="#topic+WeibullDiag">WeibullDiag</a></code> to the package.
</p>


<h3>References</h3>

<p>Hubeaux, S. (2013). 
Estimation from left- and/or interval-censored samples. 
Technical report, Biostatistics Oncology, F. Hoffmann-La Roche Ltd.     
</p>
<p>Hubeaux, S. (2013). 
Parametric Surival Regression Model with left- and/or interval-censored covariate. 
Technical report, Biostatistics Oncology, F. Hoffmann-La Roche Ltd.	
</p>
<p>Hubeaux, S. and Rufibach, K. (2014).
<b>SurvRegCensCov</b>: Weibull Regression for a Right-Censored Endpoint with a Censored Covariate.
Preprint, <a href="https://arxiv.org/abs/1402.0432">https://arxiv.org/abs/1402.0432</a>.
</p>
<p>Lynn, H. S. (2001). 
Maximum likelihood inference for left-censored HIV RNA data. 
<em>Stat. Med.</em>, <b>20</b>, 33&ndash;45.
</p>
<p>Sattar, A., Sinha, S. K. and Morris, N. J. (2012). 
A Parametric Survival Model When a Covariate is Subject to Left-Censoring. 
<em>Biometrics &amp; Biostatistics</em>, <b>S3</b>(2).
</p>


<h3>Examples</h3>

<pre><code class='language-R'># The main functions in this package are illustrated in their respective help files.
</code></pre>

<hr>
<h2 id='CDF'>Cumulative distribution function</h2><span id='topic+CDF'></span>

<h3>Description</h3>

<p>Evaluates the cumulative distribution function using the integral of its density function.</p>


<h3>Usage</h3>

<pre><code class='language-R'>CDF(c, density)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CDF_+3A_c">c</code></td>
<td>
<p>Value at which the CDF is to be evaluated.</p>
</td></tr>
<tr><td><code id="CDF_+3A_density">density</code></td>
<td>
<p>Density function.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Function not intended to be invoked by the user.</p>


<h3>Author(s)</h3>

<p>Stanislas Hubeaux, <a href="mailto:stan.hubeaux@bluewin.ch">stan.hubeaux@bluewin.ch</a> 
</p>
<p>Kaspar Rufibach, <a href="mailto:kaspar.rufibach@gmail.com">kaspar.rufibach@gmail.com</a> <br /> <a href="http://www.kasparrufibach.ch">http://www.kasparrufibach.ch</a>
</p>

<hr>
<h2 id='censorContVar'>Censor a vector of continuous numbers</h2><span id='topic+censorContVar'></span>

<h3>Description</h3>

<p>Given a vector of realizations of a continuous random variable, interval-, left-, or right-censor these numbers at given boundaries. Useful when setting up simulations involving censored observations.</p>


<h3>Usage</h3>

<pre><code class='language-R'>censorContVar(x, LLOD = NA, ULOD = NA)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="censorContVar_+3A_x">x</code></td>
<td>
<p>Vector of random numbers.</p>
</td></tr>
<tr><td><code id="censorContVar_+3A_llod">LLOD</code></td>
<td>
<p>Lower limit where <code>x</code> should be left-censored at. If no left-censoring, set to <code>NA</code>.</p>
</td></tr>
<tr><td><code id="censorContVar_+3A_ulod">ULOD</code></td>
<td>
<p>Upper limit where <code>x</code> should be left-censored at. If no left-censoring, set to <code>NA</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.frame</code> as specified by <code>code = interval2</code> in <code><a href="survival.html#topic+Surv">Surv</a></code>.</p>


<h3>Author(s)</h3>

<p>Stanislas Hubeaux, <a href="mailto:stan.hubeaux@bluewin.ch">stan.hubeaux@bluewin.ch</a> 
</p>
<p>Kaspar Rufibach, <a href="mailto:kaspar.rufibach@gmail.com">kaspar.rufibach@gmail.com</a> <br /> <a href="http://www.kasparrufibach.ch">http://www.kasparrufibach.ch</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## random vector
x &lt;- rnorm(200)

## interval-censor this vector at -1 and 0.5
censorContVar(x, -1, 0.5)
</code></pre>

<hr>
<h2 id='coef.src'>Extract coefficients of Weibull regression with an interval-censored covariate</h2><span id='topic+coef.src'></span>

<h3>Description</h3>

<p><code>coef</code> method for class <code>"src"</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'src'
coef(object, ...)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coef.src_+3A_object">object</code></td>
<td>
<p>An object of class <code>"src"</code>, usually a result of a call to <code>SurvRegCens</code>.</p>
</td></tr>
<tr><td><code id="coef.src_+3A_...">...</code></td>
<td>
<p>Further arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function <code>coef.src</code> returns the estimated parameters of the Weibull regression when calling <code><a href="#topic+SurvRegCens">SurvRegCens</a></code>.</p>


<h3>Author(s)</h3>

<p>Stanislas Hubeaux, <a href="mailto:stan.hubeaux@bluewin.ch">stan.hubeaux@bluewin.ch</a> 
</p>
<p>Kaspar Rufibach, <a href="mailto:kaspar.rufibach@gmail.com">kaspar.rufibach@gmail.com</a> <br /> <a href="http://www.kasparrufibach.ch">http://www.kasparrufibach.ch</a>
</p>


<h3>References</h3>

<p>Hubeaux, S. (2013). 
Parametric Surival Regression Model with left- and/or interval-censored covariate. 
Technical report, Biostatistics Oncology, F. Hoffmann-La Roche Ltd.     
</p>
<p>Hubeaux, S. and Rufibach, K. (2014).
<b>SurvRegCensCov</b>: Weibull Regression for a Right-Censored Endpoint with a Censored Covariate.
Preprint, <a href="https://arxiv.org/abs/1402.0432">https://arxiv.org/abs/1402.0432</a>.
</p>
<p>Sattar, A., Sinha, S. K. and Morris, N. J. (2012). 
A Parametric Survival Model When a Covariate is Subject to Left-Censoring. 
<em>Biometrics &amp; Biostatistics</em>, <b>S3</b>(2).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See help file of function "SurvRegCens".
</code></pre>

<hr>
<h2 id='ConvertWeibull'>Transformation of survreg output for the Weibull distribution</h2><span id='topic+ConvertWeibull'></span>

<h3>Description</h3>

<p>Transforms output from <code><a href="survival.html#topic+survreg">survreg</a></code> using the Weibull distribution to a more natural parameterization. See details and the vignette for more information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ConvertWeibull(model, conf.level = 0.95)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ConvertWeibull_+3A_model">model</code></td>
<td>
<p>A <code><a href="survival.html#topic+survreg">survreg</a></code> model, with <code>dist = "weibull"</code>.</p>
</td></tr>
<tr><td><code id="ConvertWeibull_+3A_conf.level">conf.level</code></td>
<td>
<p>Confidence level used to produce two-sided <code class="reqn">1-\alpha/2</code> confidence intervals for the hazard and event time ratios.</p>
</td></tr>
</table>


<h3>Details</h3>

    
<p>The <code><a href="survival.html#topic+survreg">survreg</a></code> function fits a Weibull accelerated failure time model of the form 
</p>
<p style="text-align: center;"><code class="reqn">\log t = \mu + \alpha^T Z + \sigma W,</code>
</p>
 
<p>where <code class="reqn">Z</code> is a matrix of covariates, and <code class="reqn">W</code> has the extreme value distribution, <code class="reqn">\mu</code> is the intercept, 
<code class="reqn">\alpha</code> is a vector of parameters for each of the covariates, and <code class="reqn">\sigma</code> is the scale. The usual 
parameterization of the model, however, is defined by hazard function 
</p>
<p style="text-align: center;"><code class="reqn">h(t|Z) = \gamma \lambda t^{\gamma - 1} \exp(\beta^T Z).</code>
</p>

<p>The transformation is as follows: <code class="reqn">\gamma = 1/\sigma</code>, <code class="reqn">\lambda = \exp(-\mu/\sigma)</code>, and 
<code class="reqn">\beta=-\alpha/\sigma</code>, and estimates of the standard errors can be found using the delta method.
</p>
<p>The Weibull distribution has the advantage of having two separate interpretations. The first, via proportional hazards, leads to a hazard ratio, defined by <code class="reqn">\exp \beta</code>. The second, of accelerated failure times, leads to an event time ratio (also known as an acceleration factor), defined by <code class="reqn">\exp (-\beta/\gamma)</code>.
</p>
<p>Further details regarding the transformations of the parameters and their standard errors can be found in Klein and 
Moeschberger (2003, Chapter 12). An explanation of event time ratios for the accelerated failure time interpretation of the model can be found in Carroll (2003). A general overview can be found in the <code>vignette("weibull")</code> of this package.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>vars</code></td>
<td>
<p>A matrix containing the values of the transformed parameters and their standard errors</p>
</td></tr>
<tr><td><code>HR</code></td>
<td>
<p>A matrix containing the hazard ratios for the covariates, and <code class="reqn">1 - </code><code>conf.level</code><code class="reqn"> / 2</code> confidence intervals.</p>
</td></tr>
<tr><td><code>ETR</code></td>
<td>
<p>A matrix containing the event time ratios for the covariates, and <code class="reqn">1 - </code><code>conf.level</code><code class="reqn"> / 2</code> confidence intervals.</p>
</td></tr> 
</table>


<h3>Author(s)</h3>

<p>Sarah R. Haile, Epidemiology, Biostatistics and Prevention Institute (EBPI), University of Zurich, <a href="mailto:sarah.haile@uzh.ch">sarah.haile@uzh.ch</a></p>


<h3>References</h3>

<p>Carroll, K. (2003). 
On the use and utility of the Weibull model in the analysis of survival data.
<em>Controlled Clinical Trials</em>, <b>24</b>, 682&ndash;701.
</p>
<p>Klein, J. and Moeschberger, M. (2003). 
<em>Survival analysis: techniques for censored and truncated data</em>. 
2nd edition, Springer.
</p>


<h3>See Also</h3>

<p>This function is used by <code><a href="#topic+WeibullReg">WeibullReg</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(larynx)
ConvertWeibull(survreg(Surv(time, death) ~ stage + age, larynx), conf.level = 0.95)
</code></pre>

<hr>
<h2 id='larynx'>Survival Times of Larynx Cancer Patients</h2><span id='topic+larynx'></span>

<h3>Description</h3>

<p>A study of 90 males with laryngeal cancer was performed, comparing survival times. Each patient's age, year of 
diagnosis, and disease stage was noted, see Kardaun (1983) and Klein and Moeschberger (2003).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(larynx)</code></pre>


<h3>Format</h3>

<p>A data frame with 90 observations on the following 5 variables.
</p>

<dl>
<dt><code>stage</code></dt><dd><p>Disease stage (1-4) from TNM cancer staging classification.</p>
</dd>
<dt><code>time</code></dt><dd><p>Time from first treatment until death, or end of study.</p>
</dd>
<dt><code>age</code></dt><dd><p>Age at diagnosis.</p>
</dd>
<dt><code>year</code></dt><dd><p>Year of diagnosis.</p>
</dd>
<dt><code>death</code></dt><dd><p>Indicator of death [1, if patient died at time t; 0, otherwise].</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://www.mcw.edu/-/media/MCW/Departments/Biostatistics/datafromsection18.txt?la=en">https://www.mcw.edu/-/media/MCW/Departments/Biostatistics/datafromsection18.txt?la=en</a>
</p>


<h3>References</h3>

<p>Kardaun, O. (1983).
Statistical survival analysis of male larynx-cancer patients-a case study. 
<em>Statistica Neerlandica</em>, <b>37</b>, 103&ndash;125.
</p>
<p>Klein, J. and Moeschberger, M. (2003). 
<em>Survival analysis: techniques for censored and truncated data</em>. 
2nd edition, Springer.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(survival)
data(larynx)
Surv(larynx$time, larynx$death)
</code></pre>

<hr>
<h2 id='logLik.src'>Extract value of log-likelihood at maximum for Weibull regression with an interval-censored covariate</h2><span id='topic+logLik.src'></span>

<h3>Description</h3>

<p><code>logLik</code> method for class <code>"src"</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'src'
logLik(object, ...)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="logLik.src_+3A_object">object</code></td>
<td>
<p>An object of class <code>"src"</code>, usually a result of a call to <code>SurvRegCens</code>.</p>
</td></tr>
<tr><td><code id="logLik.src_+3A_...">...</code></td>
<td>
<p>Further arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function <code>logLik.src</code> returns the value of the log-likelihood at the maximum likelihood estimate, as well as the corresponding degrees of freedom.</p>


<h3>Author(s)</h3>

<p>Stanislas Hubeaux, <a href="mailto:stan.hubeaux@bluewin.ch">stan.hubeaux@bluewin.ch</a> 
</p>
<p>Kaspar Rufibach, <a href="mailto:kaspar.rufibach@gmail.com">kaspar.rufibach@gmail.com</a> <br /> <a href="http://www.kasparrufibach.ch">http://www.kasparrufibach.ch</a>
</p>


<h3>References</h3>

<p>Hubeaux, S. (2013). 
Parametric Surival Regression Model with left- and/or interval-censored covariate. 
Technical report, Biostatistics Oncology, F. Hoffmann-La Roche Ltd.     
</p>
<p>Hubeaux, S. and Rufibach, K. (2014).
<b>SurvRegCensCov</b>: Weibull Regression for a Right-Censored Endpoint with a Censored Covariate.
Preprint, <a href="https://arxiv.org/abs/1402.0432">https://arxiv.org/abs/1402.0432</a>.
</p>
<p>Sattar, A., Sinha, S. K. and Morris, N. J. (2012). 
A Parametric Survival Model When a Covariate is Subject to Left-Censoring. 
<em>Biometrics &amp; Biostatistics</em>, <b>S3</b>(2).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See help file of function "SurvRegCens".
</code></pre>

<hr>
<h2 id='LoglikCens'>Log-likelihood functions for estimation of canonical parameters from a censored sample</h2><span id='topic+LoglikNormalCens'></span><span id='topic+LoglikWeibullCens'></span><span id='topic+LoglikLogisticCens'></span><span id='topic+LoglikGammaCens'></span>

<h3>Description</h3>

<p>Computes the log-likelihood function for a censored sample, according to a specified distributional assumptions. Available distributions are Normal, Weibull, Logistic, and Gamma.</p>


<h3>Usage</h3>

<pre><code class='language-R'>LoglikNormalCens(x, data, lowerbound, vdelta)
LoglikWeibullCens(x, data, lowerbound, vdelta)
LoglikLogisticCens(x, data, lowerbound, vdelta)
LoglikGammaCens(x, data, lowerbound, vdelta)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LoglikCens_+3A_x">x</code></td>
<td>
<p>Two-dimensional vector giving the canonical parameters of the distribution.</p>
</td></tr>
<tr><td><code id="LoglikCens_+3A_data">data</code></td>
<td>
<p>Observed or censored event times.</p>
</td></tr>
<tr><td><code id="LoglikCens_+3A_lowerbound">lowerbound</code></td>
<td>
<p>A vector that collect lower bounds for the interval-censored observations. If no lower bound is available then put <code>NA</code>.</p>
</td></tr>
<tr><td><code id="LoglikCens_+3A_vdelta">vdelta</code></td>
<td>
<p>A vector which indicates censoring (0: censored, 1: not censored).</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Function not intended to be invoked by the user.</p>


<h3>Author(s)</h3>

<p>Stanislas Hubeaux, <a href="mailto:stan.hubeaux@bluewin.ch">stan.hubeaux@bluewin.ch</a> 
</p>
<p>Kaspar Rufibach, <a href="mailto:kaspar.rufibach@gmail.com">kaspar.rufibach@gmail.com</a> <br /> <a href="http://www.kasparrufibach.ch">http://www.kasparrufibach.ch</a>
</p>


<h3>References</h3>

<p>Hubeaux, S. (2013). 
Estimation from left- and/or interval-censored samples. 
Technical report, Biostatistics Oncology, F. Hoffmann-La Roche Ltd.  
</p>
<p>Lynn, H. S. (2001). 
Maximum likelihood inference for left-censored HIV RNA data. 
<em>Stat. Med.</em>, <b>20</b>, 33&ndash;45.
</p>

<hr>
<h2 id='LoglikNormalDeltaCens'>Log likelihood function to compute mean difference between two normally distributed censored samples.</h2><span id='topic+LoglikNormalDeltaCens'></span>

<h3>Description</h3>

<p>Reparametrization of the log likelihood function for a normally distributed censored sample such that the mean difference is a parameter of the function, thus allowing to be made inference on. The mean difference is computed as sample 1 - sample 2.</p>


<h3>Usage</h3>

<pre><code class='language-R'>LoglikNormalDeltaCens(x, data1, lowerbound1, vdelta1, data2,
                      lowerbound2, vdelta2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LoglikNormalDeltaCens_+3A_x">x</code></td>
<td>
<p>A vector of four components where the first component corresponds to the mean of the normal distribution of the first sample, the second component corresponds to mean difference between the two samples: sample 1 - sample 2, the third component corresponds to the standard deviation of the normal distribution of the first sample, and the fourth component corresponds to the standard deviation of the normal distribution of the second sample.</p>
</td></tr>
<tr><td><code id="LoglikNormalDeltaCens_+3A_data1">data1</code></td>
<td>
<p>A vector of data corresponding to the first sample.</p>
</td></tr>
<tr><td><code id="LoglikNormalDeltaCens_+3A_lowerbound1">lowerbound1</code></td>
<td>
<p>A vector which corresponds to the lower bounds for the interval-censored observations of the vector of data corresponding to the first sample. If no lower bound is available then put <code>NA</code>.</p>
</td></tr>
<tr><td><code id="LoglikNormalDeltaCens_+3A_vdelta1">vdelta1</code></td>
<td>
<p>A vector which indicates for censoring for the first sample (0: censored, 1: not censored).</p>
</td></tr>
<tr><td><code id="LoglikNormalDeltaCens_+3A_data2">data2</code></td>
<td>
<p>A vector of data corresponding to the second sample.</p>
</td></tr>
<tr><td><code id="LoglikNormalDeltaCens_+3A_lowerbound2">lowerbound2</code></td>
<td>
<p>A vector which corresponds to the lower bounds for the interval-censored observations of the vector of data corresponding to the second sample. If no lower bound is available then put <code>NA</code>.</p>
</td></tr>
<tr><td><code id="LoglikNormalDeltaCens_+3A_vdelta2">vdelta2</code></td>
<td>
<p>A vector which indicates for censoring for the second sample (0: censored, 1: not censored).</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Function not intended to be invoked by the user.</p>


<h3>Author(s)</h3>

<p>Stanislas Hubeaux, <a href="mailto:stan.hubeaux@bluewin.ch">stan.hubeaux@bluewin.ch</a> 
</p>
<p>Kaspar Rufibach, <a href="mailto:kaspar.rufibach@gmail.com">kaspar.rufibach@gmail.com</a> <br /> <a href="http://www.kasparrufibach.ch">http://www.kasparrufibach.ch</a>
</p>


<h3>References</h3>

<p>Hubeaux, S. (2013). 
Estimation from left- and/or interval-censored samples. 
Technical report, Biostatistics Oncology, F. Hoffmann-La Roche Ltd.  
</p>
<p>Lynn, H. S. (2001). 
Maximum likelihood inference for left-censored HIV RNA data. 
<em>Stat. Med.</em>, <b>20</b>, 33&ndash;45.
</p>

<hr>
<h2 id='LoglikWeibullSurvRegCens'>Log-likelihood function of a Weibull Survival Regression Model allowing for an interval-censored covariate.</h2><span id='topic+LoglikWeibullSurvRegCens'></span><span id='topic+h_conditional'></span><span id='topic+S_conditional'></span>

<h3>Description</h3>

<p>Computes the log-likelihood function of a Weibull Survival Regression Model allowing for an interval-censored covariate.</p>


<h3>Usage</h3>

<pre><code class='language-R'>LoglikWeibullSurvRegCens(x, data_y, data_delta_loglik, data_cov_noncens = NULL, 
                         data_cov_cens, density, data_r_loglik, data_lowerbound,
                         intlimit = 10^-10)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LoglikWeibullSurvRegCens_+3A_x">x</code></td>
<td>
<p>Vector of parameters, ordered as follows: Scale parameter, Shape parameter, regression parameters (i.e. <code class="reqn">\beta</code>) linked to the non-censored covariates, regression parameter (i.e. <code class="reqn">\beta</code>) linked to the censored covariate.</p>
</td></tr>
<tr><td><code id="LoglikWeibullSurvRegCens_+3A_data_y">data_y</code></td>
<td>
<p>Time-to-event vector.</p>
</td></tr>
<tr><td><code id="LoglikWeibullSurvRegCens_+3A_data_delta_loglik">data_delta_loglik</code></td>
<td>
<p>Censored indicator vector of the time-to-event (0: censored, 1: not censored).</p>
</td></tr>
<tr><td><code id="LoglikWeibullSurvRegCens_+3A_data_cov_noncens">data_cov_noncens</code></td>
<td>
<p>Matrix where each column represents a non-censored covariate.</p>
</td></tr>
<tr><td><code id="LoglikWeibullSurvRegCens_+3A_data_cov_cens">data_cov_cens</code></td>
<td>
<p>Censored covariate vector.</p>
</td></tr>
<tr><td><code id="LoglikWeibullSurvRegCens_+3A_density">density</code></td>
<td>
<p>Density function of the censored covariate.</p>
</td></tr>
<tr><td><code id="LoglikWeibullSurvRegCens_+3A_data_r_loglik">data_r_loglik</code></td>
<td>
<p>Censored indicator vector of the censored covariate (0: censored, 1: not censored).</p>
</td></tr>
<tr><td><code id="LoglikWeibullSurvRegCens_+3A_data_lowerbound">data_lowerbound</code></td>
<td>
<p>A vector which corresponds to the lower bounds for the interval-censored observations of the censored covariate. If no lower bound is available then put <code>NA</code>.</p>
</td></tr>
<tr><td><code id="LoglikWeibullSurvRegCens_+3A_intlimit">intlimit</code></td>
<td>
<p>In computation of integrals, values of the function to be integrated below <code>intlimit</code> are set to 0. This makes integration results more accurate and speeds up integration. If the data is such that the absolute values of the underlying baseline Weibull density are very small, i.e. in the range of <code>intlimit</code>, it is advisable to rescale the time variable, e.g. change the scaling from days to years. A very small value of the estimated <code class="reqn">\lambda</code> is indicative of that situation.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Function not intended to be invoked by the user.</p>


<h3>Author(s)</h3>

<p>Stanislas Hubeaux, <a href="mailto:stan.hubeaux@bluewin.ch">stan.hubeaux@bluewin.ch</a> 
</p>
<p>Kaspar Rufibach, <a href="mailto:kaspar.rufibach@gmail.com">kaspar.rufibach@gmail.com</a> <br /> <a href="http://www.kasparrufibach.ch">http://www.kasparrufibach.ch</a>
</p>


<h3>References</h3>

<p>Hubeaux, S. (2013). 
Parametric Surival Regression Model with left- and/or interval-censored covariate. 
Technical report, Biostatistics Oncology, F. Hoffmann-La Roche Ltd.  
</p>
<p>Sattar, A., Sinha, S. K. and Morris, N. J. (2012). 
A Parametric Survival Model When a Covariate is Subject to Left-Censoring. 
<em>Biometrics &amp; Biostatistics</em>, <b>S3</b>(2).
</p>

<hr>
<h2 id='NormalMeanDiffCens'>Maximum Likelihood Estimator for the mean difference between two censored normally distributed samples</h2><span id='topic+NormalMeanDiffCens'></span>

<h3>Description</h3>

<p>Computes estimates of the parameters of two censored Normal samples, as well as the mean difference between the two samples.</p>


<h3>Usage</h3>

<pre><code class='language-R'>NormalMeanDiffCens(censdata1, censdata2, conf.level = 0.95, 
     null.values = c(0, 0, 1, 1))</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="NormalMeanDiffCens_+3A_censdata1">censdata1</code></td>
<td>
<p>Observations of first sample, format as specified by <code>code = interval2</code> in <code><a href="survival.html#topic+Surv">Surv</a></code>.</p>
</td></tr>
<tr><td><code id="NormalMeanDiffCens_+3A_censdata2">censdata2</code></td>
<td>
<p>Observations of second sample, as specified by <code>code = interval2</code> in <code><a href="survival.html#topic+Surv">Surv</a></code>.</p>
</td></tr>
<tr><td><code id="NormalMeanDiffCens_+3A_conf.level">conf.level</code></td>
<td>
<p>Confidence level for confidence intervals.</p>
</td></tr>  
<tr><td><code id="NormalMeanDiffCens_+3A_null.values">null.values</code></td>
<td>
<p>Fixed values for hypothesis tests. Four-dimensional vector specifying the hypothesis for <code class="reqn">\mu_1</code>, <code class="reqn">\mu_2</code>, <code class="reqn">\sigma_1</code>, <code class="reqn">\sigma_2</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A table with estimators and inference for the means and standard deviations of both samples, as well as the difference <code class="reqn">\Delta</code> between the mean of the first and second sample. Hypothesis tests are for the values in <code>null.values</code> and for the null hypothesis of no mean difference.</p>


<h3>Author(s)</h3>

<p>Stanislas Hubeaux, <a href="mailto:stan.hubeaux@bluewin.ch">stan.hubeaux@bluewin.ch</a> 
</p>
<p>Kaspar Rufibach, <a href="mailto:kaspar.rufibach@gmail.com">kaspar.rufibach@gmail.com</a> <br /> <a href="http://www.kasparrufibach.ch">http://www.kasparrufibach.ch</a>
</p>


<h3>References</h3>

<p>Hubeaux, S. (2013). 
Estimation from left- and/or interval-censored samples. 
Technical report, Biostatistics Oncology, F. Hoffmann-La Roche Ltd.  
</p>
<p>Lynn, H. S. (2001). 
Maximum likelihood inference for left-censored HIV RNA data. 
<em>Stat. Med.</em>, <b>20</b>, 33&ndash;45.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## example with interval-censored Normal samples
n &lt;- 500
prop.cens &lt;- 0.35
mu &lt;- c(0, 2)
sigma &lt;- c(1, 1)

set.seed(2013)

## Sample 1:
LOD1 &lt;- qnorm(prop.cens, mean = mu[1], sd = sigma[1])
x1 &lt;- rnorm(n, mean = mu[1], sd = sigma[1])
s1 &lt;- censorContVar(x1, LLOD = LOD1)

## Sample 2:
LOD2 &lt;- qnorm(0.35, mean = mu[2], sd = sigma[2])
x2 &lt;- rnorm(n, mean = mu[2], sd = sigma[2])
s2 &lt;- censorContVar(x2, LLOD = LOD2)

## inference on distribution parameters and mean difference:
NormalMeanDiffCens(censdata1 = s1, censdata2 = s2)
</code></pre>

<hr>
<h2 id='ParamSampleCens'>Maximum Likelihood Estimator of parameters from a censored sample</h2><span id='topic+ParamSampleCens'></span>

<h3>Description</h3>

<p>Computes maximum likelihood estimators of the canonical parameters for several distributions, based on a censored sample.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ParamSampleCens(censdata, dist = c("normal", "logistic", "gamma", "weibull")[1], 
     null.values = c(0, 1), conf.level = 0.95, initial = NULL)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ParamSampleCens_+3A_censdata">censdata</code></td>
<td>
<p>Dataframe that contains censored data, format as specified by <code>code = interval2</code> in <code><a href="survival.html#topic+Surv">Surv</a></code>.</p>
</td></tr>
<tr><td><code id="ParamSampleCens_+3A_dist">dist</code></td>
<td>
<p>Assumed distribution of the sample.</p>
</td></tr>
<tr><td><code id="ParamSampleCens_+3A_null.values">null.values</code></td>
<td>
<p>Fixed values for hypothesis tests.</p>
</td></tr>
<tr><td><code id="ParamSampleCens_+3A_conf.level">conf.level</code></td>
<td>
<p>Confidence level of confidence intervals.</p>
</td></tr>  
<tr><td><code id="ParamSampleCens_+3A_initial">initial</code></td>
<td>
<p>Initial values for the maximization.</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>coeff</code></td>
<td>
<p>Estimators, standard errors, confidence intervals, and 2-sided <code class="reqn">p</code>-values for the null hypothesis as given in <code>null.values</code>. All this inference is based on maximum likelihood theory, i.e. standard errors are computed using the inverse expected Hessian at the maximum likelihood estimator.</p>
</td></tr>
<tr><td><code>percent.cens</code></td>
<td>
<p>Percentage of censored observations.</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p>Log likelihood function value at the estimator.</p>
</td></tr>
<tr><td><code>info.converg</code></td>
<td>
<p>Convergence information provided by the function <code>optim</code>.</p>
</td></tr>
<tr><td><code>info.converg.message</code></td>
<td>
<p>Message provided by the function <code>optim</code>.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Functions with similar functionality are provided in the package <span class="pkg">fitdistrplus</span>.</p>


<h3>Author(s)</h3>

<p>Stanislas Hubeaux, <a href="mailto:stan.hubeaux@bluewin.ch">stan.hubeaux@bluewin.ch</a> 
</p>
<p>Kaspar Rufibach, <a href="mailto:kaspar.rufibach@gmail.com">kaspar.rufibach@gmail.com</a> <br /> <a href="http://www.kasparrufibach.ch">http://www.kasparrufibach.ch</a>
</p>


<h3>References</h3>

<p>Hubeaux, S. (2013). 
Estimation from left- and/or interval-censored samples. 
Technical report, Biostatistics Oncology, F. Hoffmann-La Roche Ltd.  
</p>
<p>Lynn, H. S. (2001). 
Maximum likelihood inference for left-censored HIV RNA data. 
<em>Stat. Med.</em>, <b>20</b>, 33&ndash;45.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n &lt;- 500
prop.cens &lt;- 0.35

## example with a left-censored Normally distributed sample
set.seed(2013)
mu &lt;- 3.5
sigma &lt;- 1
LOD &lt;- qnorm(prop.cens, mean = mu, sd = sigma)
x1 &lt;- rnorm(n, mean = mu, sd = sigma)
s1 &lt;- censorContVar(x1, LLOD = LOD)
ParamSampleCens(censdata = s1)


## example with an interval-censored Normal sample
set.seed(2013)
x2 &lt;- rnorm(n, mean = mu, sd = sigma)
LOD &lt;- qnorm(prop.cens / 2, mean = mu, sd = sigma)
UOD &lt;- qnorm(1 - prop.cens / 2, mean = mu, sd = sigma)
s2 &lt;- censorContVar(x2, LLOD = LOD, ULOD = UOD)
ParamSampleCens(censdata = s2)


## Not run: 
## compare to fitdistrplus
library(fitdistrplus)
s2 &lt;- as.data.frame(s2)
colnames(s2) &lt;- c("left", "right")
summary(fitdistcens(censdata = s2, distr = "norm"))

## End(Not run)
</code></pre>

<hr>
<h2 id='print.src'>Print result of Weibull regression with an interval-censored covariate</h2><span id='topic+print.src'></span>

<h3>Description</h3>

<p><code>print</code> method for class <code>"src"</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'src'
print(x, ...)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.src_+3A_x">x</code></td>
<td>
<p>An object of class <code>"src"</code>, usually a result of a call to <code>SurvRegCens</code>.</p>
</td></tr>
<tr><td><code id="print.src_+3A_...">...</code></td>
<td>
<p>Further arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function <code>print.src</code> returns the estimated parameters of the Weibull regression, incl. AIC, when calling <code><a href="#topic+SurvRegCens">SurvRegCens</a></code>.</p>


<h3>Author(s)</h3>

<p>Stanislas Hubeaux, <a href="mailto:stan.hubeaux@bluewin.ch">stan.hubeaux@bluewin.ch</a> 
</p>
<p>Kaspar Rufibach, <a href="mailto:kaspar.rufibach@gmail.com">kaspar.rufibach@gmail.com</a> <br /> <a href="http://www.kasparrufibach.ch">http://www.kasparrufibach.ch</a>
</p>


<h3>References</h3>

<p>Hubeaux, S. (2013). 
Parametric Surival Regression Model with left- and/or interval-censored covariate. 
Technical report, Biostatistics Oncology, F. Hoffmann-La Roche Ltd.     
</p>
<p>Hubeaux, S. and Rufibach, K. (2014).
<b>SurvRegCensCov</b>: Weibull Regression for a Right-Censored Endpoint with a Censored Covariate.
Preprint, <a href="https://arxiv.org/abs/1402.0432">https://arxiv.org/abs/1402.0432</a>.
</p>
<p>Sattar, A., Sinha, S. K. and Morris, N. J. (2012). 
A Parametric Survival Model When a Covariate is Subject to Left-Censoring. 
<em>Biometrics &amp; Biostatistics</em>, <b>S3</b>(2).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See help file of function "SurvRegCens".
</code></pre>

<hr>
<h2 id='summary.src'>Summarizing Weibull regression with an interval-censored covariate</h2><span id='topic+summary.src'></span>

<h3>Description</h3>

<p><code>summary</code> method for class <code>"src"</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'src'
summary(object, ...)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.src_+3A_object">object</code></td>
<td>
<p>An object of class <code>"src"</code>, usually a result of a call to <code>SurvRegCens</code>.</p>
</td></tr>
<tr><td><code id="summary.src_+3A_...">...</code></td>
<td>
<p>Further arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function <code>summary.src</code> returns the estimated parameters, incl. statistical inference, of the Weibull regression, incl. AIC, when calling <code><a href="#topic+SurvRegCens">SurvRegCens</a></code>.</p>


<h3>Author(s)</h3>

<p>Stanislas Hubeaux, <a href="mailto:stan.hubeaux@bluewin.ch">stan.hubeaux@bluewin.ch</a> 
</p>
<p>Kaspar Rufibach, <a href="mailto:kaspar.rufibach@gmail.com">kaspar.rufibach@gmail.com</a> <br /> <a href="http://www.kasparrufibach.ch">http://www.kasparrufibach.ch</a>
</p>


<h3>References</h3>

<p>Hubeaux, S. (2013). 
Parametric Surival Regression Model with left- and/or interval-censored covariate. 
Technical report, Biostatistics Oncology, F. Hoffmann-La Roche Ltd.     
</p>
<p>Hubeaux, S. and Rufibach, K. (2014).
<b>SurvRegCensCov</b>: Weibull Regression for a Right-Censored Endpoint with a Censored Covariate.
Preprint, <a href="https://arxiv.org/abs/1402.0432">https://arxiv.org/abs/1402.0432</a>.
</p>
<p>Sattar, A., Sinha, S. K. and Morris, N. J. (2012). 
A Parametric Survival Model When a Covariate is Subject to Left-Censoring. 
<em>Biometrics &amp; Biostatistics</em>, <b>S3</b>(2).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See help file of function "SurvRegCens".
</code></pre>

<hr>
<h2 id='SurvRegCens'>Weibull Survival Regression Model with a censored covariate</h2><span id='topic+SurvRegCens'></span>

<h3>Description</h3>

<p>Computes estimators for the shape and scale parameter of the Weibull distribution, as well as for the vector of regression parameters in a parametric survival model with potentially right-censored time-to-event endpoint distributed according to a Weibull distribution. The regression allows for one potentially interval-censored and an arbitrary number of non-censored covariates.</p>


<h3>Usage</h3>

<pre><code class='language-R'>SurvRegCens(formula, data = parent.frame(), Density, initial, conf.level = 0.95, 
          intlimit = 10^-10, namCens = "VarCens", trace = 0, reltol = 10^-8)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SurvRegCens_+3A_formula">formula</code></td>
<td>
<p>A formula expression as for other regression models. The response has to be a survival object for right-censored data, as returned by the <code><a href="survival.html#topic+Surv">Surv</a></code> function. The censored covariate is equally specified using <code><a href="survival.html#topic+Surv">Surv</a></code>. See the examples below and the documentation for <code><a href="survival.html#topic+Surv">Surv</a></code>, <code><a href="stats.html#topic+lm">lm</a></code> and <code><a href="stats.html#topic+formula">formula</a></code> for details.</p>
</td></tr>
<tr><td><code id="SurvRegCens_+3A_data">data</code></td>
<td>
<p>A data frame in which to interpret the variables named in the formula argument.</p>
</td></tr>
<tr><td><code id="SurvRegCens_+3A_density">Density</code></td>
<td>
<p>Density function of the censored covariate.</p>
</td></tr>
<tr><td><code id="SurvRegCens_+3A_initial">initial</code></td>
<td>
<p>Initial values for the parameters to be optimized over, ordered according to Scale parameter, Shape parameter, regression parameters (i.e. <code class="reqn">\beta</code>) linked to the non-censored covariates, regression parameter (i.e. <code class="reqn">\beta</code>) linked to the censored covariate. A straightforward initial vector is based on ignoring the censoring of the censored covariate and using <code><a href="survival.html#topic+survreg">survreg</a></code>, see the example below for an illustration.</p>
</td></tr>
<tr><td><code id="SurvRegCens_+3A_conf.level">conf.level</code></td>
<td>
<p>Confidence level of confidence intervals.</p>
</td></tr>  
<tr><td><code id="SurvRegCens_+3A_intlimit">intlimit</code></td>
<td>
<p>In computation of integrals, values of the function to be integrated below <code>intlimit</code> are set to 0. This makes integration results more accurate and speeds up integration. If the data is such that the absolute values of the underlying baseline Weibull density are very small, i.e. in the range of <code>intlimit</code>, it is advisable to rescale the time variable, e.g. change the scaling from days to years. A very small value of the estimated <code class="reqn">\lambda</code> is indicative of that situation.</p>
</td></tr>
<tr><td><code id="SurvRegCens_+3A_namcens">namCens</code></td>
<td>
<p>Name of censored covariate, to tidy outputs.</p>
</td></tr>
<tr><td><code id="SurvRegCens_+3A_trace">trace</code></td>
<td>
<p><code>trace</code> argument in <code>optim</code>, indicates whether to show optimization progress.</p>
</td></tr>
<tr><td><code id="SurvRegCens_+3A_reltol">reltol</code></td>
<td>
<p><code>reltol</code> argument in <code>optim</code>. By changing this one can modify the relative tolerance in maximization of the likelihood function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The time-to-event distributed according to a Weibull distribution, i.e. time-to-event <code class="reqn">\sim</code> Weibull<code class="reqn">(\lambda,\gamma)</code>, has conditional density given by,
</p>
<p style="text-align: center;"><code class="reqn">f_{Y_i}(t|\mathbf{x}_i,\boldsymbol{\beta}) =\gamma \lambda t^{\gamma-1} \exp\left(\mathbf{x}_i\boldsymbol{\beta}\right)\exp\left( - \lambda t^{\gamma} \exp\left(\mathbf{x}_i\boldsymbol{\beta}\right) \right),</code>
</p>

<p>conditional hazard function given by,
</p>
<p style="text-align: center;"><code class="reqn">h_i(t|\mathbf{x}_i,\boldsymbol{\beta})= \lambda \gamma t^{\gamma-1} \exp\left( \mathbf{x}_i\boldsymbol{\beta} \right),</code>
</p>

<p>and conditional survival function given by,
</p>
<p style="text-align: center;"><code class="reqn">S_i(t|\mathbf{x}_i,\boldsymbol{\beta}) = \exp\left(-\lambda t^{\gamma} \exp\left(\mathbf{x}_i\boldsymbol{\beta}\right)\right),</code>
</p>

<p>where <code class="reqn">\mathbf{x}_i</code> collects the values of each covariate for observation <code class="reqn">i</code> and <code class="reqn">\boldsymbol{\beta}</code> represents the regression parameters.
</p>


<h3>Value</h3>

<p><code><a href="#topic+SurvRegCens">SurvRegCens</a></code> returns an object of class <code>"src"</code>, a list containing the 
following components:
</p>
<table role = "presentation">
<tr><td><code>coeff</code></td>
<td>
<p>Estimators, confidence intervals, <code class="reqn">p</code>-values for the for the null hypothesis: {Estimators is equal to 0}, and this for each of the parameters of the Weibull survival regression model.</p>
</td></tr>
<tr><td><code>percent.cens</code></td>
<td>
<p>Percentage of censored observations in the censored covariate.</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p>Log-likelihood function value at the estimators.</p>
</td></tr>
<tr><td><code>info.converg</code></td>
<td>
<p>Convergence information provided by the function <code><a href="stats.html#topic+optim">optim</a></code>.</p>
</td></tr>
<tr><td><code>info.converg.message</code></td>
<td>
<p>Message provided by <code><a href="stats.html#topic+optim">optim</a></code>.</p>
</td></tr>	
</table>
<p>The methods <code><a href="#topic+print.src">print.src</a></code>, <code><a href="#topic+summary.src">summary.src</a></code>, <code><a href="#topic+coef.src">coef.src</a></code>, and <code><a href="#topic+logLik.src">logLik.src</a></code> are used to print or obtain a summary, coefficients, or the value of the log-likelihood at the maximum.
</p>


<h3>Author(s)</h3>

<p>Stanislas Hubeaux, <a href="mailto:stan.hubeaux@bluewin.ch">stan.hubeaux@bluewin.ch</a> 
</p>
<p>Kaspar Rufibach, <a href="mailto:kaspar.rufibach@gmail.com">kaspar.rufibach@gmail.com</a> <br /> <a href="http://www.kasparrufibach.ch">http://www.kasparrufibach.ch</a>
</p>


<h3>References</h3>

<p>Hubeaux, S. (2013). 
Parametric Surival Regression Model with left- and/or interval-censored covariate. 
Technical report, Biostatistics Oncology, F. Hoffmann-La Roche Ltd.     
</p>
<p>Hubeaux, S. and Rufibach, K. (2014).
<b>SurvRegCensCov</b>: Weibull Regression for a Right-Censored Endpoint with a Censored Covariate.
Preprint, <a href="https://arxiv.org/abs/1402.0432">https://arxiv.org/abs/1402.0432</a>.
</p>
<p>Sattar, A., Sinha, S. K. and Morris, N. J. (2012). 
A Parametric Survival Model When a Covariate is Subject to Left-Censoring. 
<em>Biometrics &amp; Biostatistics</em>, <b>S3</b>(2).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## --------------------------------------------------------------
## 1 censored-covariate and 2 non-censored covariates 
## no censoring, to compare result with survival::survreg
## modify prop.cens to introduce left-censoring of covariate
## --------------------------------------------------------------

set.seed(158)
n &lt;- 100
lambda &lt;- exp(-2)
gamma &lt;- 1.5

## vector of regression parameters: the last entry is the one for the censored covariate
beta &lt;- c(0.3, -0.2, 0.25) 
true &lt;- c(lambda, gamma, beta)

## non-censored covariates
var1 &lt;- rnorm(n, mean = 4, sd = 0.5)
var2 &lt;- rnorm(n, mean = 4, sd = 0.5)

## Generate censored covariate. 
## For generation of Weibull survival times, do not left-censor it yet.
var3 &lt;- rnorm(n, mean = 5, sd = 0.5)

## simulate from a Weibull regression model
time &lt;- TimeSampleWeibull(covariate_noncens = data.frame(var1, var2), 
          covariate_cens = var3, lambda = lambda, gamma = gamma, beta = beta) 

## left-censor covariate
## prop.cens specifies the proportion of observations that should be left-censored
prop.cens &lt;- 0
LOD &lt;- qnorm(prop.cens, mean = 5, sd = 0.5)
var3.cens &lt;- censorContVar(var3, LLOD = LOD)

## censor survival time
event &lt;- matrix(1, nrow = n, ncol = 1)
time.cens &lt;- rexp(n, rate = 0.5)
ind.time &lt;- (event &gt;= time.cens)
event[ind.time] &lt;- 0
time[ind.time] &lt;- time.cens[ind.time]

## specify the density for the censored covariate:
## For simplicity, we take here the "true" density we simulate from. In an application,
## you might want to use a density with parameters estimated from the censored covariate,
## e.g. using the function ParamSampleCens. See example in Hubeaux &amp; Rufibach (2014).
DensityCens &lt;- function(value){return(dnorm(value, mean = 5, sd = 0.5))}

## use Weibull regression where each censored covariate value is set 
## to LOD ("naive" method)
naive &lt;- survreg(Surv(time, event) ~ var1 + var2 + var3.cens[, 2], dist = "weibull")
initial &lt;- as.vector(ConvertWeibull(naive)$vars[, 1])

## use new method that takes into account the left-censoring of one covariate
data &lt;- data.frame(time, event, var3.cens, var1, var2)
formula &lt;- formula(Surv(time, event) ~  Surv(time = var3.cens[, 1], time2 = var3.cens[, 2], 
                      type = "interval2") + var1 + var2)
cens1 &lt;- SurvRegCens(formula = formula, data = data, Density = DensityCens, initial = initial, 
                      namCens = "biomarker")
summary(cens1)
coef(cens1)
logLik(cens1)

## compare estimates
tab &lt;- data.frame(cbind(true, initial, cens1$coeff[, 1]))
colnames(tab) &lt;- c("true", "naive", "Weibull MLE")
rownames(tab) &lt;- rownames(cens1$coeff)
tab

## compare confidence intervals
ConvertWeibull(naive)$HR[, 2:3]
cens1$coeff[, 7:8]


## --------------------------------------------------------------
## model without the non-censored covariates
## --------------------------------------------------------------
naive2 &lt;- survreg(Surv(time, event) ~ var3.cens[, 2], dist = "weibull")
initial2 &lt;- as.vector(ConvertWeibull(naive2)$vars[, 1])

## use new method that takes into account the left-censoring of one covariate
formula &lt;- formula(Surv(time, event) ~ Surv(time = var3.cens[, 1], time2 = var3.cens[, 2], 
                      type = "interval2"))
cens2 &lt;- SurvRegCens(formula = formula, data = data, Density = DensityCens, initial = initial2, 
                      namCens = "biomarker")
summary(cens2)

## compare estimates
tab &lt;- data.frame(cbind(true[c(1, 2, 5)], initial2, cens2$coeff[, 1]))
colnames(tab) &lt;- c("true", "naive", "Weibull MLE")
rownames(tab) &lt;- rownames(cens2$coeff)
tab

## compare confidence intervals
ConvertWeibull(naive2)$HR[, 2:3]
cens2$coeff[, 7:8]

## End(Not run)
</code></pre>

<hr>
<h2 id='TimeSampleWeibull'>Generate time-to-event data according to a Weibull regression model</h2><span id='topic+TimeSampleWeibull'></span><span id='topic+survtime'></span><span id='topic+F_time'></span>

<h3>Description</h3>

<p>Generates time-to-event data using the transform inverse sampling method, and such that the time-to-event is distributed according to a Weibull distribution induced by censored and/or non-censored covariates. Can be used to set up simulations.</p>


<h3>Usage</h3>

<pre><code class='language-R'>TimeSampleWeibull(covariate_noncens = NULL, covariate_cens, lambda, gamma, beta)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="TimeSampleWeibull_+3A_covariate_cens">covariate_cens</code></td>
<td>
<p>Censored covariate vector.</p>
</td></tr>
<tr><td><code id="TimeSampleWeibull_+3A_covariate_noncens">covariate_noncens</code></td>
<td>
<p>Matrix where each column represents a non-censored covariate.</p>
</td></tr>
<tr><td><code id="TimeSampleWeibull_+3A_lambda">lambda</code></td>
<td>
<p>Scale parameter.</p>
</td></tr>
<tr><td><code id="TimeSampleWeibull_+3A_gamma">gamma</code></td>
<td>
<p>Shape parameter.</p>
</td></tr>
<tr><td><code id="TimeSampleWeibull_+3A_beta">beta</code></td>
<td>
<p>Regression parameters, ordered as <code class="reqn">\beta</code> linked to the non-censored covariates, <code class="reqn">\beta</code> linked to the censored covariate.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The use of this function is illustrated in <code><a href="#topic+SurvRegCens">SurvRegCens</a></code>.</p>


<h3>Author(s)</h3>

<p>Stanislas Hubeaux, <a href="mailto:stan.hubeaux@bluewin.ch">stan.hubeaux@bluewin.ch</a></p>

<hr>
<h2 id='WeibullDiag'>Diagnostic Plot of Adequacy of Weibull Distribution</h2><span id='topic+WeibullDiag'></span>

<h3>Description</h3>

<p>This function constructs a diagnostic plot of the adequacy of the Weibull distribution for survival 
data with respect to one categorical covariate. If the Weibull distribution fits the data well, then the 
lines produced should be linear and parallel.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>WeibullDiag(formula, data = parent.frame(), labels = names(m$strata))</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="WeibullDiag_+3A_formula">formula</code></td>
<td>
<p>A formula containing a <code><a href="survival.html#topic+Surv">Surv</a></code> object, should only contain one categorical 
predictor, or a set of indicators describing only one predictor.</p>
</td></tr>
<tr><td><code id="WeibullDiag_+3A_data">data</code></td>
<td>
<p>Data set.</p>
</td></tr>
<tr><td><code id="WeibullDiag_+3A_labels">labels</code></td>
<td>
<p>A vector containing labels for the plotted lines.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>As discussed in Klein and Moeschberger (2003), one method for checking the adequacy of the Weibull model with a 
categorical covariate is to produce stratified Kaplan-Meier estimates (KM), which can be transformed to estimate 
the log cumulative hazard for each stratum. Then in a plot of <code class="reqn">\log(t)</code> versus <code class="reqn">\log(-\log(KM))</code>, the 
lines should be linear and parallel. This can be seen as the log cumulative hazard for the Weibull distribution 
is 
</p>
<p style="text-align: center;"><code class="reqn">\log H(t) = \log \lambda + \alpha \log t.</code>
</p>



<h3>Value</h3>

<p>Produces a plot of log Time vs. log Estimated Cumulative Hazard for each level of the predictor 
(similarly to what can be obtained using <code><a href="survival.html#topic+plot.survfit">plot.survfit</a></code> and the <code>fun = "cloglog"</code> option), 
as well as a data set containing that information.</p>


<h3>Author(s)</h3>

<p>Sarah R. Haile, Epidemiology, Biostatistics and Prevention Institute (EBPI), University of Zurich, <a href="mailto:sarah.haile@uzh.ch">sarah.haile@uzh.ch</a></p>


<h3>References</h3>

<p>Klein, J. and Moeschberger, M. (2003). 
<em>Survival analysis: techniques for censored and truncated data</em>. 
2nd edition, Springer.
</p>


<h3>See Also</h3>

<p>Requires <span class="pkg">survival</span>. A similar plot can be produced using <code><a href="survival.html#topic+plot.survfit">plot.survfit</a></code> and the option <code>fun = "cloglog"</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(larynx)
WeibullDiag(Surv(time, death) ~ stage, data = larynx)
</code></pre>

<hr>
<h2 id='WeibullIntegrate'>Function to be integrated in function <code><a href="#topic+SurvRegCens">SurvRegCens</a></code></h2><span id='topic+WeibullIntegrate'></span>

<h3>Description</h3>

<p>Function to be integrated to compute log-likelihood function for the Weibull survival regression model with a censored covariate.</p>


<h3>Usage</h3>

<pre><code class='language-R'>WeibullIntegrate(x, x_i_noncens = NULL, density, param_y_i,
                 param_delta_i, param_lambda, param_gamma,
                 param_beta, intlimit = 10^-10, ForIntegrate = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="WeibullIntegrate_+3A_x">x</code></td>
<td>
<p>Value of the censored covariate for observation <code class="reqn">i</code>.</p>
</td></tr>
<tr><td><code id="WeibullIntegrate_+3A_x_i_noncens">x_i_noncens</code></td>
<td>
<p>Vector of values of the non-censored covariates for observation <code class="reqn">i</code>, i.e. one row of the matrix where each column represents a non-censored covariate.</p>
</td></tr>
<tr><td><code id="WeibullIntegrate_+3A_density">density</code></td>
<td>
<p>Density function of the censored covariate.</p>
</td></tr>
<tr><td><code id="WeibullIntegrate_+3A_param_y_i">param_y_i</code></td>
<td>
<p>Value of the time-to-event for observation <code class="reqn">i</code>.</p>
</td></tr>
<tr><td><code id="WeibullIntegrate_+3A_param_delta_i">param_delta_i</code></td>
<td>
<p>Censoring indicator of time-to-event for observation <code class="reqn">i</code> (0: censored, 1: not censored).</p>
</td></tr>
<tr><td><code id="WeibullIntegrate_+3A_param_lambda">param_lambda</code></td>
<td>
<p>Scale parameter of the Weibull distribution.</p>
</td></tr>
<tr><td><code id="WeibullIntegrate_+3A_param_gamma">param_gamma</code></td>
<td>
<p>Shape parameter of the Weibull distribution.</p>
</td></tr>
<tr><td><code id="WeibullIntegrate_+3A_param_beta">param_beta</code></td>
<td>
<p>Regression parameters (i.e. <code class="reqn">\beta</code>): (betaNonCens1, ..., betaNonCens, betaCens)</p>
</td></tr>
<tr><td><code id="WeibullIntegrate_+3A_intlimit">intlimit</code></td>
<td>
<p>In computation of integrals, values of the function to be integrated below <code>intlimit</code> are set to 0. This makes integration results more accurate and speeds up integration. If the data is such that the absolute values of the underlying baseline Weibull density are very small, i.e. in the range of <code>intlimit</code>, it is advisable to rescale the time variable, e.g. change the scaling from days to years. A very small value of the estimated <code class="reqn">\lambda</code> is indicative of that situation.</p>
</td></tr>
<tr><td><code id="WeibullIntegrate_+3A_forintegrate">ForIntegrate</code></td>
<td>
<p><code>logical</code> indicating whether the function is to be integrated or not.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Function is not intended to be invoked by the user.</p>


<h3>Author(s)</h3>

<p>Stanislas Hubeaux, <a href="mailto:stan.hubeaux@bluewin.ch">stan.hubeaux@bluewin.ch</a></p>

<hr>
<h2 id='WeibullReg'>Weibull Regression for Survival Data</h2><span id='topic+WeibullReg'></span>

<h3>Description</h3>

<p><code>WeibullReg</code> performs Weibull regression using the <code><a href="survival.html#topic+survreg">survreg</a></code> function, and transforms the 
estimates to a more natural parameterization. Additionally, it produces hazard ratios (corresponding to the proportional 
hazards interpretation), and event time ratios (corresponding to the accelerated failure time interpretation) for all 
covariates.</p>


<h3>Usage</h3>

<pre><code class='language-R'>WeibullReg(formula, data = parent.frame(), conf.level = 0.95)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="WeibullReg_+3A_formula">formula</code></td>
<td>
<p>A <code><a href="survival.html#topic+Surv">Surv</a></code> formula.</p>
</td></tr>
<tr><td><code id="WeibullReg_+3A_data">data</code></td>
<td>
<p>The dataset containing all variables referenced in <code>formula</code>.</p>
</td></tr>
<tr><td><code id="WeibullReg_+3A_conf.level">conf.level</code></td>
<td>
<p>Specifies that <code class="reqn">1 - \alpha</code> level confidence intervals for the hazard and event time ratios should be produced.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Details regarding the transformations of the parameters and their standard errors can be found in Klein and 
Moeschberger (2003, Chapter 12). An explanation of event time ratios for the accelerated failure time interpretation of 
the model can be found in Carroll (2003). A general overview can be found in the <code>vignette("weibull")</code> of this package, or in the documentation for <code><a href="#topic+ConvertWeibull">ConvertWeibull</a></code>.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>formula</code></td>
<td>
<p>The formula for the Weibull regression model.</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p>The transformed maximum likelihood estimates, with standard errors.</p>
</td></tr>
<tr><td><code>HR</code></td>
<td>
<p>The hazard ratios for each of the predictors, with <code class="reqn">1 - \alpha</code> level confidence intervals.</p>
</td></tr>
<tr><td><code>ETR</code></td>
<td>
<p>The event time ratios (acceleration factors) for each of the predictors, with <code class="reqn">1 - \alpha</code> level 
confidence intervals.</p>
</td></tr>
<tr><td><code>summary</code></td>
<td>
<p>The summary output from the original <code><a href="survival.html#topic+survreg">survreg</a></code> model.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sarah R. Haile, Epidemiology, Biostatistics and Prevention Institute (EBPI), University of Zurich, <a href="mailto:sarah.haile@uzh.ch">sarah.haile@uzh.ch</a></p>


<h3>References</h3>

<p>Carroll, K. (2003). 
On the use and utility of the Weibull model in the analysis of survival data.
<em>Controlled Clinical Trials</em>, <b>24</b>, 682&ndash;701.
</p>
<p>Klein, J. and Moeschberger, M. (2003). 
<em>Survival analysis: techniques for censored and truncated data</em>. 
2nd edition, Springer.
</p>


<h3>See Also</h3>

<p>Requires the package <span class="pkg">survival</span>. This function depends on <code><a href="#topic+ConvertWeibull">ConvertWeibull</a></code>. See also 
<code><a href="survival.html#topic+survreg">survreg</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(larynx)
WR &lt;- WeibullReg(Surv(time, death) ~ factor(stage) + age, data = larynx)
WR
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
