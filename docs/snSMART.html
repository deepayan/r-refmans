<!DOCTYPE html><html lang="en"><head><title>Help for package snSMART</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {snSMART}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#snSMART-package'><p>snSMART: Small N Sequential Multiple Assignment Randomized Trial Methods</p></a></li>
<li><a href='#BJSM_binary'><p>BJSM for snSMART (3 active treatments/placebo and 2 dose level) with binary outcome</p></a></li>
<li><a href='#BJSM_c'><p>BJSM continuous (snSMART with three active treatments and a continuous outcome design)</p></a></li>
<li><a href='#data_binary'><p>Dataset with binary outcomes</p></a></li>
<li><a href='#data_dose'><p>Dose Level dataset with binary outcomes</p></a></li>
<li><a href='#group_seq'><p>BJSM method for interim analysis and final analysis of group sequential trial design</p></a></li>
<li><a href='#groupseqDATA_full'><p>Group sequential full data</p></a></li>
<li><a href='#groupseqDATA_look1'><p>Group sequential data look 1</p></a></li>
<li><a href='#LPJSM_binary'><p>LPJSM for snSMART with binary outcomes (3 active treatments or placebo and two</p>
dose level)</a></li>
<li><a href='#sample_size'><p>Sample size calculation for snSMART with 3 active treatments and a binary outcome</p></a></li>
<li><a href='#summary.BJSM_binary'><p>Summarizing BJSM fits</p></a></li>
<li><a href='#summary.BJSM_dose_binary'><p>Summarizing BJSM fits</p></a></li>
<li><a href='#summary.group_seq'><p>Summarizing BJSM fits</p></a></li>
<li><a href='#trialDataMF'><p>Dataset with continuous outcomes</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Small N Sequential Multiple Assignment Randomized Trial Methods</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.4</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Michael Kleinsasser &lt;mkleinsa@umich.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Consolidated data simulation, sample size calculation and
    analysis functions for several snSMART (small sample sequential,
    multiple assignment, randomized trial) designs under one library.  See
    Wei, B., Braun, T.M., Tamura, R.N. and Kidwell, K.M. "A Bayesian
    analysis of small n sequential multiple assignment randomized trials
    (snSMARTs)." (2018) Statistics in medicine, 37(26), pp.3723-3732
    &lt;<a href="https://doi.org/10.1002%2Fsim.7900">doi:10.1002/sim.7900</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/sidiwang/snSMART">https://github.com/sidiwang/snSMART</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/sidiwang/snSMART/issues">https://github.com/sidiwang/snSMART/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), EnvStats (&ge; 2.4.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>bayestestR (&ge; 0.11.0), condMVNorm (&ge; 2020.1), cubature (&ge;
2.0.4.1), geepack (&ge; 1.3-1), HDInterval (&ge; 0.2.0), pracma (&ge;
2.3.3), rjags (&ge; 4-12), tidyr (&ge; 1.1.2), truncdist (&ge; 1.0-1)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>coda (&ge; 0.19-2), testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Biarch:</td>
<td>true</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>JAGS 4.x.y</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-10-16 19:48:56 UTC; mk</td>
</tr>
<tr>
<td>Author:</td>
<td>Sidi Wang [aut],
  Kelley Kidwell [aut],
  Michael Kleinsasser [cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-10-16 20:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='snSMART-package'>snSMART: Small N Sequential Multiple Assignment Randomized Trial Methods</h2><span id='topic+snSMART'></span><span id='topic+snSMART-package'></span>

<h3>Description</h3>

<p>Consolidated data simulation, sample size calculation and analysis functions for several snSMART (small sample sequential, multiple assignment, randomized trial) designs under one library. See Wei, B., Braun, T.M., Tamura, R.N. and Kidwell, K.M. &quot;A Bayesian analysis of small n sequential multiple assignment randomized trials (snSMARTs).&quot; (2018) Statistics in medicine, 37(26), pp.3723-3732 <a href="https://doi.org/10.1002/sim.7900">doi:10.1002/sim.7900</a>.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Michael Kleinsasser <a href="mailto:mkleinsa@umich.edu">mkleinsa@umich.edu</a>
</p>
<p>Authors:
</p>

<ul>
<li><p> Sidi Wang <a href="mailto:sidiwang@umich.edu">sidiwang@umich.edu</a>
</p>
</li>
<li><p> Kelley Kidwell <a href="mailto:kidwell@umich.edu">kidwell@umich.edu</a>
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/sidiwang/snSMART">https://github.com/sidiwang/snSMART</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/sidiwang/snSMART/issues">https://github.com/sidiwang/snSMART/issues</a>
</p>
</li></ul>


<hr>
<h2 id='BJSM_binary'>BJSM for snSMART (3 active treatments/placebo and 2 dose level) with binary outcome</h2><span id='topic+BJSM_binary'></span><span id='topic+print.summary.BJSM_binary'></span><span id='topic+print.BJSM_binary'></span><span id='topic+print.summary.BJSM_dose_binary'></span><span id='topic+print.BJSM_dose_binary'></span>

<h3>Description</h3>

<p>This function implements the BJSM (Bayesian Joint Stage Modeling) method which
borrows information across both stages to estimate the individual response rate
of each treatment/dose level in a snSMART design with binary outcomes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BJSM_binary(
  data,
  prior_dist,
  pi_prior,
  normal.par,
  beta_prior,
  n_MCMC_chain = 1,
  n.adapt,
  BURN.IN = 100,
  thin = 1,
  MCMC_SAMPLE,
  ci = 0.95,
  six = TRUE,
  DTR = TRUE,
  jags.model_options = NULL,
  coda.samples_options = NULL,
  verbose = FALSE,
  ...
)

## S3 method for class 'summary.BJSM_binary'
print(x, ...)

## S3 method for class 'BJSM_binary'
print(x, ...)

## S3 method for class 'summary.BJSM_dose_binary'
print(x, ...)

## S3 method for class 'BJSM_dose_binary'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BJSM_binary_+3A_data">data</code></td>
<td>
<p>trial data with 4 columns: <code>treatment_stageI, response_stageI,
treatment_stageII</code> and <code>response_stageII</code>. Missing data is allowed in stage 2.</p>
</td></tr>
<tr><td><code id="BJSM_binary_+3A_prior_dist">prior_dist</code></td>
<td>
<p>for 3 active treatment design: vector of three values
(&quot;prior distribution for <code>pi</code>&quot;, &quot;prior distribution for <code>beta0</code>&quot;,
&quot;prior distribution for <code>beta1</code>&quot;). User can choose from &quot;gamma&quot;, &quot;beta&quot;, &quot;pareto&quot;.
e.g. prior_dist = c(&quot;beta&quot;, &quot;beta&quot;, &quot;pareto&quot;); for dose level design: vector of two
values (&quot;prior distribution for <code>pi_P</code>&quot;, &quot;prior distribution for <code>beta</code>&quot;)</p>
</td></tr>
<tr><td><code id="BJSM_binary_+3A_pi_prior">pi_prior</code></td>
<td>
<p>for 3 active treatment design: vector of six values (a, b, c, d, e, f),
where a and b are the parameter <code>a</code> and parameter <code>b</code> of the prior distribution
for <code>pi_1A</code>, c and d are the parameter <code>a</code> and parameter <code>b</code> of the prior
distribution for <code>pi_1B</code>, and e and f are the parameter <code>a</code> and parameter
<code>b</code> of the prior distribution for <code>pi_1C</code>. for dose level design: vector
of two values (a, b). <code>a</code> is the parameter <code>a</code> of the prior distribution for
<code>pi</code> (response rate) of placebo. <code>b</code> is the parameter <code>b</code> of the prior
distribution for <code>pi</code> of placebo. Please check the <code>Details</code> section for
more explanation</p>
</td></tr>
<tr><td><code id="BJSM_binary_+3A_normal.par">normal.par</code></td>
<td>
<p>for dose level design: vector of two values (normal.mean, normal.var).
our function assumes that the logarithm of treatment effect ratio follows a Gaussian
prior distribution <code class="reqn">N(\mu, \sigma^2)</code>, that is <code class="reqn">log(\pi_L/\pi_P)~N(normal.mean, normal.var)</code>,
and <code class="reqn">log(\pi_H/\pi_P)~N(normal.mean, normal.var)</code>. <code>normal.mean</code> is the mean of
this Gaussian prior. <code>normal.var</code> is the variance of this Gaussian prior distribution</p>
</td></tr>
<tr><td><code id="BJSM_binary_+3A_beta_prior">beta_prior</code></td>
<td>
<p>for 3 active treatment design: vector of four values (a, b, c, d).
<code>a</code> is the value of parameter <code>a</code> of the prior distribution for linkage parameter
<code>beta_0</code> or <code>beta_0m</code>, <code>b</code> is the value of parameter <code>b</code> of the
prior distribution for linkage parameter <code>beta_0</code> or <code>beta_0m</code>. <code>c</code>
is the value of parameter <code>a</code> of the prior distribution for linkage parameter
<code>beta_1</code> or <code>beta_1m</code>. <code>d</code> is the value of parameter <code>b</code> of the
prior distribution for linkage parameter <code>beta_1</code> or <code>beta_1m</code>. for
dose level design: vector of two values (a, b). <code>a</code> is the parameter <code>a</code> of the
prior distribution for linkage parameter <code>beta</code>. <code>b</code> is the parameter b of
the prior distribution  for linkage parameter <code>beta</code>. Please check the <code>Details</code>
section for more explanation</p>
</td></tr>
<tr><td><code id="BJSM_binary_+3A_n_mcmc_chain">n_MCMC_chain</code></td>
<td>
<p>number of MCMC chains, default to 1.</p>
</td></tr>
<tr><td><code id="BJSM_binary_+3A_n.adapt">n.adapt</code></td>
<td>
<p>the number of iterations for adaptation</p>
</td></tr>
<tr><td><code id="BJSM_binary_+3A_burn.in">BURN.IN</code></td>
<td>
<p>number of burn-in iterations for MCMC</p>
</td></tr>
<tr><td><code id="BJSM_binary_+3A_thin">thin</code></td>
<td>
<p>thinning interval for monitors</p>
</td></tr>
<tr><td><code id="BJSM_binary_+3A_mcmc_sample">MCMC_SAMPLE</code></td>
<td>
<p>number of iterations for MCMC</p>
</td></tr>
<tr><td><code id="BJSM_binary_+3A_ci">ci</code></td>
<td>
<p>coverage probability for credible intervals, default = 0.95</p>
</td></tr>
<tr><td><code id="BJSM_binary_+3A_six">six</code></td>
<td>
<p>TRUE or FALSE. If TRUE, will run the six beta model (allow for estimating
<code>beta_0m</code> and <code>beta_1m</code> values that differ among different treatments m), if FALSE
will run the two beta model. default = TRUE. Only need to specify this for 3 active
treatment design.</p>
</td></tr>
<tr><td><code id="BJSM_binary_+3A_dtr">DTR</code></td>
<td>
<p>TRUE or FALSE. If TRUE, will also return the expected response rate of
dynamic treatment regimens. default = TRUE. Only need to specify this for 3 active
treatment design.</p>
</td></tr>
<tr><td><code id="BJSM_binary_+3A_jags.model_options">jags.model_options</code></td>
<td>
<p>a list of optional arguments that are passed to <code>jags.model()</code> function.</p>
</td></tr>
<tr><td><code id="BJSM_binary_+3A_coda.samples_options">coda.samples_options</code></td>
<td>
<p>a list of optional arguments that are passed to <code>coda.samples()</code> function.</p>
</td></tr>
<tr><td><code id="BJSM_binary_+3A_verbose">verbose</code></td>
<td>
<p>TRUE or FALSE. If FALSE, no function message and progress bar will be
printed.</p>
</td></tr>
<tr><td><code id="BJSM_binary_+3A_...">...</code></td>
<td>
<p>further arguments. Not currently used.</p>
</td></tr>
<tr><td><code id="BJSM_binary_+3A_x">x</code></td>
<td>
<p>object to summarize.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For <code>gamma</code> distribution, <code>prior.a</code> is the shape parameter <code>r</code>, <code>prior.b</code> is the rate parameter <code>lambda</code>. For <code>beta</code> distribution, <code>prior.a</code> is the shape parameter <code>a</code>, <code>prior.b</code> is the shape parameter <code>b</code>.
For <code>pareto</code> distribution, <code>prior.a</code> is the scale parameter <code>alpha</code>, <code>prior.b</code> is the shape parameter <code>c</code> (see jags user manual).
</p>
<p>The individual response rate is regarded as a permanent feature of the treatment. The second stage outcome is modeled conditionally on the first stage results linking the first and
second stage response probabilities through linkage parameters. The first stage response rate is denoted as <code class="reqn">\pi_m</code> for treatment <code class="reqn">m</code>. In the two <code class="reqn">\beta</code> model, the second stage response rate for first stage responders is equal to <code class="reqn">\beta_1\pi_m</code>. For nonresponders to treatment <code class="reqn">m</code> in the first stage who
receive treatment <code class="reqn">m'</code> in the second the stage, the second stage response rate in the second stage is equal to <code class="reqn">\beta_0\pi_{m'}</code>. In the six <code class="reqn">\beta</code> model, the second stage response rate of the first stage responders to treatment m is denoted by <code class="reqn">\beta_{1m}\pi_m</code>, and the second stage response rate of the non-responders
to first stage treatment $m$ who receive treatment <code class="reqn">m'</code> in the second stage is denoted by <code class="reqn">\beta_{0m}\pi_{m'}</code>. All the <code class="reqn">\beta</code>s are linkage parameters.
</p>
<p>Please refer to the paper listed under <code>reference</code> section for standard snSMART trial design and detailed definition of parameters.
</p>
<p>Note that this package does not include the JAGS library, users need to install JAGS separately. Please check this page for more details: <a href="https://sourceforge.net/projects/mcmc-jags/">https://sourceforge.net/projects/mcmc-jags/</a>
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>posterior_sample</code></td>
<td>
<p>an <code>mcmc.list</code> object generated through the <code>coda.samples()</code> function,
which includes posterior samples of the link parameters and response rates generated through the MCMC
process</p>
</td></tr>
<tr><td><code>pi_hat_bjsm</code></td>
<td>
<p>estimate of response rate/treatment effect</p>
</td></tr>
<tr><td><code>se_hat_bjsm</code></td>
<td>
<p>standard error of the response rate</p>
</td></tr>
<tr><td><code>ci_pi_A(P)</code>, <code>ci_pi_B(L)</code>, <code>ci_pi_C(H)</code></td>
<td>
<p>x% credible intervals for treatment A(P), B(L), C(H)</p>
</td></tr>
<tr><td><code>diff_AB(PL)</code>, <code>diff_BC(LH). diff_AC(PH)</code></td>
<td>
<p>estimate of differences between
treatments A(P) and B(L), B(L) and C(H), A(P) and C(H)</p>
</td></tr>
<tr><td><code>ci_diff_AB(PL)</code>, <code>ci_diff_BC(LH)</code>, <code>ci_diff_AC(PH)</code></td>
<td>
<p>x% credible intervals
for the estimated differences between treatments A(P) and B(L), B(L) and C(H), A(P) and C(H)</p>
</td></tr>
<tr><td><code>se_AB(PL)</code>, <code>se_BC(LH)</code>, <code>se_AC(PH)</code></td>
<td>
<p>standard error for the estimated differences
between treatments A(P) and B(L), B(L) and C(H), A(P) and C(H)</p>
</td></tr>
<tr><td><code>beta0_hat</code>, <code>beta1_hat</code></td>
<td>
<p>linkage parameter <code>beta0</code> and <code>beta1</code> estimates</p>
</td></tr>
<tr><td><code>se_beta0_hat</code>, <code>se_beta1_hat</code></td>
<td>
<p>standard error of the estimated value of linkage
parameter <code>beta0</code> and <code>beta1</code></p>
</td></tr>
<tr><td><code>ci_beta0_hat</code>, <code>ci_beta1_hat</code></td>
<td>
<p>linkage parameter <code>beta0</code> and <code>beta1</code>
credible interval</p>
</td></tr>
<tr><td><code>pi_DTR_est</code></td>
<td>
<p>expected response rate of dynamic treatment regimens (DTRs)</p>
</td></tr>
<tr><td><code>pi_DTR_se</code></td>
<td>
<p>standard error for the estimated DTR response rate</p>
</td></tr>
<tr><td><code>ci_pi_AB</code>, <code>ci_pi_AC</code>, <code>ci_pi_BA</code>, <code>ci_pi_BC</code>, <code>ci_pi_CA</code>, <code>ci_pi_CB</code></td>
<td>
<p>x% credible intervals for the estimated DTR response rate</p>
</td></tr>
</table>


<h3>References</h3>

<p>Wei, B., Braun, T.M., Tamura, R.N. and Kidwell, K.M., 2018. A Bayesian analysis of small n sequential multiple assignment randomized trials (snSMARTs).
Statistics in medicine, 37(26), pp.3723-3732. URL: <a href="doi:10.1002/sim.7900">doi:10.1002/sim.7900</a>
</p>
<p>Chao, Y.C., Trachtman, H., Gipson, D.S., Spino, C., Braun, T.M. and Kidwell, K.M., 2020. Dynamic treatment regimens in small n, sequential, multiple assignment, randomized trials: An application in focal segmental glomerulosclerosis. Contemporary clinical trials, 92, p.105989. URL: <a href="doi:10.1016/j.cct.2020.105989">doi:10.1016/j.cct.2020.105989</a>
</p>
<p>Fang, F., Hochstedler, K.A., Tamura, R.N., Braun, T.M. and Kidwell, K.M., 2021. Bayesian methods to compare dose levels with placebo in a small n,
sequential, multiple assignment, randomized trial. Statistics in Medicine, 40(4), pp.963-977. URL: <a href="doi:10.1002/sim.8813">doi:10.1002/sim.8813</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+LPJSM_binary">LPJSM_binary</a></code> <br />
<code><a href="#topic+sample_size">sample_size</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mydata &lt;- data_binary

BJSM_result &lt;- BJSM_binary(
  data = mydata, prior_dist = c("beta", "beta", "pareto"),
  pi_prior = c(0.4, 1.6, 0.4, 1.6, 0.4, 1.6), beta_prior = c(1.6, 0.4, 3, 1),
  n_MCMC_chain = 1, n.adapt = 1000, MCMC_SAMPLE = 2000, ci = 0.95,
  six = TRUE, DTR = TRUE, verbose = FALSE
)


BJSM_result2 &lt;- BJSM_binary(
  data = mydata, prior_dist = c("beta", "beta", "pareto"),
  pi_prior = c(0.4, 1.6, 0.4, 1.6, 0.4, 1.6), beta_prior = c(1.6, 0.4, 3, 1),
  n_MCMC_chain = 1, n.adapt = 10000, MCMC_SAMPLE = 60000, ci = 0.95,
  six = FALSE, DTR = FALSE, verbose = FALSE
)

summary(BJSM_result)
summary(BJSM_result2)


data &lt;- data_dose
BJSM_dose_result &lt;- BJSM_binary(
  data = data_dose, prior_dist = c("beta", "gamma"),
  pi_prior = c(3, 17), normal.par = c(0.2, 100), beta_prior = c(2, 2),
  n_MCMC_chain = 2, n.adapt = 1000, MCMC_SAMPLE = 6000, ci = 0.95, verbose = FALSE
)

summary(BJSM_dose_result)

</code></pre>

<hr>
<h2 id='BJSM_c'>BJSM continuous (snSMART with three active treatments and a continuous outcome design)</h2><span id='topic+BJSM_c'></span><span id='topic+summary.BJSM_c'></span><span id='topic+print.summary.BJSM_c'></span><span id='topic+print.BJSM_c'></span>

<h3>Description</h3>

<p>BJSM (Bayesian Joint Stage Modeling) method that borrows information across both stages
to estimate the individual response rate of each treatment (with continuous
outcome and a mapping function).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BJSM_c(
  data,
  xi_prior.mean,
  xi_prior.sd,
  phi3_prior.sd,
  n_MCMC_chain,
  n.adapt,
  MCMC_SAMPLE,
  ci = 0.95,
  n.digits,
  thin = 1,
  BURN.IN = 100,
  jags.model_options = NULL,
  coda.samples_options = NULL,
  verbose = FALSE,
  ...
)

## S3 method for class 'BJSM_c'
summary(object, ...)

## S3 method for class 'summary.BJSM_c'
print(x, ...)

## S3 method for class 'BJSM_c'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BJSM_c_+3A_data">data</code></td>
<td>
<p>trial ddatset with columns: <code>id, trt1</code> (treatment 1), <code>stage1outcome, stay</code>
(stay = 1 if patient stay on the same treatment in stage 2, otherwise stay = 0),
<code>trt2</code> (treatment 2), <code>stage2outcome</code></p>
</td></tr>
<tr><td><code id="BJSM_c_+3A_xi_prior.mean">xi_prior.mean</code></td>
<td>
<p>a 3-element vector of mean of the prior distributions
(normal distribution) for <code>xi</code>s (treatment effect). Please check the <code>Details</code>
section for more explaination</p>
</td></tr>
<tr><td><code id="BJSM_c_+3A_xi_prior.sd">xi_prior.sd</code></td>
<td>
<p>a 3-element vector of standard deviation of the prior distributions
(normal distribution) for <code>xi</code>s (treatment effect). Please check the <code>Details</code>
section for more explaination</p>
</td></tr>
<tr><td><code id="BJSM_c_+3A_phi3_prior.sd">phi3_prior.sd</code></td>
<td>
<p>standard deviation of the prior distribution (folded normal
distribution) of <code>phi3</code> (if the patient stays on the same treatment, <code>phi3</code>
is the cumulative effect of stage 1 that occurs on the treatment longer term).
Please check the <code>Details</code> section for more explaination</p>
</td></tr>
<tr><td><code id="BJSM_c_+3A_n_mcmc_chain">n_MCMC_chain</code></td>
<td>
<p>number of MCMC chains, default to 1</p>
</td></tr>
<tr><td><code id="BJSM_c_+3A_n.adapt">n.adapt</code></td>
<td>
<p>the number of iterations for adaptation</p>
</td></tr>
<tr><td><code id="BJSM_c_+3A_mcmc_sample">MCMC_SAMPLE</code></td>
<td>
<p>number of iterations for MCMC</p>
</td></tr>
<tr><td><code id="BJSM_c_+3A_ci">ci</code></td>
<td>
<p>coverage probability for credible intervals, default = 0.95</p>
</td></tr>
<tr><td><code id="BJSM_c_+3A_n.digits">n.digits</code></td>
<td>
<p>number of digits to keep in the final estimation of treatment effect</p>
</td></tr>
<tr><td><code id="BJSM_c_+3A_thin">thin</code></td>
<td>
<p>thinning interval for monitors</p>
</td></tr>
<tr><td><code id="BJSM_c_+3A_burn.in">BURN.IN</code></td>
<td>
<p>number of burn-in iterations for MCMC</p>
</td></tr>
<tr><td><code id="BJSM_c_+3A_jags.model_options">jags.model_options</code></td>
<td>
<p>a list of optional arguments that are passed to <code>jags.model()</code> function.</p>
</td></tr>
<tr><td><code id="BJSM_c_+3A_coda.samples_options">coda.samples_options</code></td>
<td>
<p>a list of optional arguments that are passed to <code>coda.samples()</code> function.</p>
</td></tr>
<tr><td><code id="BJSM_c_+3A_verbose">verbose</code></td>
<td>
<p>TRUE or FALSE. If FALSE, no function message and progress bar will be
printed.</p>
</td></tr>
<tr><td><code id="BJSM_c_+3A_...">...</code></td>
<td>
<p>further arguments. Not currently used.</p>
</td></tr>
<tr><td><code id="BJSM_c_+3A_object">object</code></td>
<td>
<p>object to summarize.</p>
</td></tr>
<tr><td><code id="BJSM_c_+3A_x">x</code></td>
<td>
<p>object to print</p>
</td></tr>
</table>


<h3>Details</h3>

<p>section 2.2.1 and 2.2.2 of the paper listed under <code>reference</code> provides a detailed
description of the assumptions and prior distributions of the model.
</p>
<p>Note that this package does not include the JAGS library, users need to install JAGS separately. Please check this page for more details: <a href="https://sourceforge.net/projects/mcmc-jags/">https://sourceforge.net/projects/mcmc-jags/</a>
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>posterior_sample</code></td>
<td>
<p>an <code>mcmc.list</code> object generated through the <code>coda.samples()</code> function,
which includes posterior samples of the link parameters and response rates generated through the MCMC
process</p>
</td></tr>
<tr><td><code>mean_estimate</code></td>
<td>
<p>BJSM estimate of each parameter:
</p>

<ol>
<li> <p><code>phi1</code> - lingering effect of the first treatment
</p>
</li>
<li> <p><code>phi3</code> - if the patient stays on the same treatment, <code>phi3</code> is the cumulative effect of stage 1 that occurs on the treatment longer term
</p>
</li>
<li> <p><code>xi_j</code> - the expected effect of treatment j, j = 1, 2, 3 in the first stage
</p>
</li>
<li> <p><code>V1</code>,<code>V2</code> are the variance-covariance matrix of the multivariate distribution. <code>V1</code> is for patients who stay on the same treatment,
and <code>V2</code> is for patients who switch treatments. This allows those who stay on the same treatment to have a different correlation between stage one
stage two outcomes than those who switch treatments.
</p>
</li></ol>
</td></tr>
<tr><td><code>ci_estimate</code></td>
<td>
<p>x% credible interval for each parameter. By default round to
2 decimal places, if more decimals are needed, please access the results by
<code style="white-space: pre;">&#8288;[YourResultName]$ci_estimates$CI_low&#8288;</code> or <code style="white-space: pre;">&#8288;[YourResultName]$ci_estimates$CI_high&#8288;</code> </p>
</td></tr>
</table>


<h3>References</h3>

<p>Hartman, H., Tamura, R.N., Schipper, M.J. and Kidwell, K.M., 2021. Design and analysis considerations for utilizing a mapping function in a small sample,
sequential, multiple assignment, randomized trials with continuous outcomes. Statistics in Medicine, 40(2), pp.312-326. URL: <a href="doi:10.1002/sim.8776">doi:10.1002/sim.8776</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>trialData &lt;- trialDataMF

BJSM_result &lt;- BJSM_c(
  data = trialData, xi_prior.mean = c(50, 50, 50),
  xi_prior.sd = c(50, 50, 50), phi3_prior.sd = 20, n_MCMC_chain = 1,
  n.adapt = 1000, MCMC_SAMPLE = 5000, BURIN.IN = 1000, ci = 0.95, n.digits = 5, verbose = FALSE
)

summary(BJSM_result)
print(BJSM_result)
</code></pre>

<hr>
<h2 id='data_binary'>Dataset with binary outcomes</h2><span id='topic+data_binary'></span>

<h3>Description</h3>

<p>sample synthetic dataset of snSMART (3 active treatment) with binary outcomes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data_binary
</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>treatment_stageI</dt><dd><p>treatment received in stage 1 - possible values: 1 (placebo), 2, 3</p>
</dd>
<dt>response_stageI</dt><dd><p>whether patients respond to stage 1 treatment - possible values: 0 (nonresponder), 1 (responder)</p>
</dd>
<dt>treatment_stageII</dt><dd><p>treatment received in stage 2 - possible values: 2, 3</p>
</dd>
<dt>response_stageII</dt><dd><p>whether patients respond to stage 2 treatment - possible values: 0 (nonresponder), 1 (responder)</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>mydata &lt;- data_binary
LPJSM_result &lt;- LPJSM_binary(data = mydata, six = TRUE, DTR = TRUE)

</code></pre>

<hr>
<h2 id='data_dose'>Dose Level dataset with binary outcomes</h2><span id='topic+data_dose'></span>

<h3>Description</h3>

<p>sample synthetic dataset of snSMART (dose level treatment) with binary outcomes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data_dose
</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>treatment_stageI</dt><dd><p>treatment received in stage 1 - possible values: 1 (placebo), 2, 3</p>
</dd>
<dt>response_stageI</dt><dd><p>whether patients respond to stage 1 treatment - possible values: 0 (nonresponder), 1 (responder)</p>
</dd>
<dt>treatment_stageII</dt><dd><p>treatment received in stage 2 - possible values: 2, 3</p>
</dd>
<dt>response_stageII</dt><dd><p>whether patients respond to stage 2 treatment - possible values: 0 (nonresponder), 1 (responder)</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>mydata &lt;- data_dose
BJSM_dose_result &lt;- BJSM_binary(
  data = data_dose, prior_dist = c("beta", "gamma"),
  pi_prior = c(3, 17), normal.par = c(0.2, 100), beta_prior = c(2, 2),
  n_MCMC_chain = 2, n.adapt = 100, MCMC_SAMPLE = 2000, ci = 0.95
)

</code></pre>

<hr>
<h2 id='group_seq'>BJSM method for interim analysis and final analysis of group sequential trial design</h2><span id='topic+group_seq'></span><span id='topic+print.summary.group_seq'></span><span id='topic+print.group_seq'></span>

<h3>Description</h3>

<p>After obtain real trial data, this function can be used to decide which arm to
drop in an interim analysis or provide a full final analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>group_seq(
  data,
  interim = TRUE,
  drop_threshold_pair = NULL,
  prior_dist,
  pi_prior,
  beta_prior,
  MCMC_SAMPLE,
  n.adapt,
  thin = 1,
  BURN.IN = 100,
  n_MCMC_chain,
  ci = 0.95,
  DTR = TRUE,
  jags.model_options = NULL,
  coda.samples_options = NULL,
  verbose = FALSE,
  ...
)

## S3 method for class 'summary.group_seq'
print(x, ...)

## S3 method for class 'group_seq'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="group_seq_+3A_data">data</code></td>
<td>
<p>dataset should include 8 columns: <code>time.1st.trt</code> (first treatment
starts time), <code>time.1st.resp</code> (first response time), <code>time.2nd.trt</code> (second
treatment starts time), <code>time.2nd.resp</code> (second response time),
<code>trt.1st</code> (treatment arm for first treatment), <code>resp.1st</code> (response for first
treatment), <code>trt.2nd</code> (treatment arm for second treatment), <code>resp.2nd</code> (response
for second
treatment) data yet to be observed should be marked as &quot;<code>NA</code>&quot;</p>
</td></tr>
<tr><td><code id="group_seq_+3A_interim">interim</code></td>
<td>
<p>indicates whether user is conducting an interim analysis via BJSM (<code>interim</code> = TRUE) or an final analysis via BJSM (<code>interim</code> = FALSE)</p>
</td></tr>
<tr><td><code id="group_seq_+3A_drop_threshold_pair">drop_threshold_pair</code></td>
<td>
<p>a vector of 2 values (<code>drop_threshold_tau_l</code>, <code>drop_threshold_psi_l</code>). Both <code>drop_threshold_tau_l</code> and <code>drop_threshold_psi_l</code> should be between 0 and 1. only assign value to this parameter when <code>interim = TRUE</code>. See the details section for more explanation</p>
</td></tr>
<tr><td><code id="group_seq_+3A_prior_dist">prior_dist</code></td>
<td>
<p>vector of three values (&quot;prior distribution for <code>pi</code>&quot;,
&quot;prior distribution for <code>beta0</code>&quot;, &quot;prior distribution for <code>beta1</code>&quot;),
user can choose from &quot;gamma&quot;, &quot;beta&quot;, &quot;pareto&quot;. e.g. prior_dist = c(&quot;beta&quot;,
&quot;beta&quot;, &quot;pareto&quot;)</p>
</td></tr>
<tr><td><code id="group_seq_+3A_pi_prior">pi_prior</code></td>
<td>
<p>vector of six values (a, b, c, d, e, f), where a and b are the parameter <code>a</code> and parameter <code>b</code> of the prior distribution for <code>pi_1A</code>, c and d are the parameter <code>a</code> and parameter <code>b</code> of the prior distribution for <code>pi_1B</code>, and e and f are the parameter <code>a</code> and parameter <code>b</code> of the prior distribution for <code>pi_1C</code>. Please check the <code>Details</code> section for more explanation</p>
</td></tr>
<tr><td><code id="group_seq_+3A_beta_prior">beta_prior</code></td>
<td>
<p>vector of four values (<code>beta0_prior.a</code>, <code>beta0_prior.b</code>, <code>beta1_prior.a</code>, <code>beta1_prior.c</code>).  <code>beta0_prior.a</code> is the parameter a of the prior distribution for linkage parameter <code>beta0</code>. <code>beta0_prior.b</code> is the parameter b of the prior distribution  for linkage parameter <code>beta0</code>. <code>beta1_prior.a</code> is the parameter a of the prior distribution for linkage parameter <code>beta1</code>. <code>beta1_prior.c</code> is the parameter b of the prior distribution for linkage parameter <code>beta1</code>. Please check the <code>Details</code> section for more explanation</p>
</td></tr>
<tr><td><code id="group_seq_+3A_mcmc_sample">MCMC_SAMPLE</code></td>
<td>
<p>number of iterations for MCMC</p>
</td></tr>
<tr><td><code id="group_seq_+3A_n.adapt">n.adapt</code></td>
<td>
<p>the number of iterations for adaptation</p>
</td></tr>
<tr><td><code id="group_seq_+3A_thin">thin</code></td>
<td>
<p>thinning interval for monitors</p>
</td></tr>
<tr><td><code id="group_seq_+3A_burn.in">BURN.IN</code></td>
<td>
<p>number of burn-in iterations for MCMC</p>
</td></tr>
<tr><td><code id="group_seq_+3A_n_mcmc_chain">n_MCMC_chain</code></td>
<td>
<p>number of MCMC chains, default to 1</p>
</td></tr>
<tr><td><code id="group_seq_+3A_ci">ci</code></td>
<td>
<p>coverage probability for credible intervals, default = 0.95. only
assign value to this parameter when <code>interim = FALSE</code>.</p>
</td></tr>
<tr><td><code id="group_seq_+3A_dtr">DTR</code></td>
<td>
<p>if TRUE, will also return the expected response rate of dynamic
treatment regimens. default = TRUE. only assign value to this parameter when
<code>interim = FALSE</code>.</p>
</td></tr>
<tr><td><code id="group_seq_+3A_jags.model_options">jags.model_options</code></td>
<td>
<p>a list of optional arguments that are passed to <code>jags.model()</code> function.</p>
</td></tr>
<tr><td><code id="group_seq_+3A_coda.samples_options">coda.samples_options</code></td>
<td>
<p>a list of optional arguments that are passed to <code>coda.samples()</code> function.</p>
</td></tr>
<tr><td><code id="group_seq_+3A_verbose">verbose</code></td>
<td>
<p>TRUE or FALSE. If FALSE, no function message and progress bar will be
printed.</p>
</td></tr>
<tr><td><code id="group_seq_+3A_...">...</code></td>
<td>
<p>further arguments. Not currently used.</p>
</td></tr>
<tr><td><code id="group_seq_+3A_x">x</code></td>
<td>
<p>object to summarize.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For <code>gamma</code> distribution, <code>prior.a</code> is the shape parameter <code>r</code>,
<code>prior.b</code> is the rate parameter <code>lambda</code>. For <code>beta</code> distribution,
<code>prior.a</code> is the shape parameter <code>a</code>, <code>prior.b</code> is the shape parameter
<code>b</code>.
For <code>pareto</code> distribution, <code>prior.a</code> is the scale parameter <code>alpha</code>,
<code>prior.b</code> is the shape parameter <code>c</code> (see jags user manual).
The individual response rate is regarded as a permanent feature of the treatment.
The second stage outcome is modeled conditionally on the first stage results
linking the first and
second stage response probabilities through linkage parameters.
</p>
<p>(paper provided in the reference section, section 2.2.2 Bayesian decision rules. drop_threshold_tau_l and drop_threshold_psi_l correspond to <code class="reqn">tau_l</code> and <code class="reqn">psi_l</code> respectively)
</p>
<p>Please refer to the paper listed under <code>reference</code> section for detailed definition of parameters.
Note that this package does not include the JAGS library, users need to install JAGS separately. Please check this page for more details: <a href="https://sourceforge.net/projects/mcmc-jags/">https://sourceforge.net/projects/mcmc-jags/</a>
</p>


<h3>Value</h3>

<p>if <code>interim = TRUE</code>, this function returns either 0 - no arm is dropped,
or A/B/C - arm A/B/C is dropped <br />
</p>
<p>if <code>interim = FALSE</code>, this function returns:
</p>
<table role = "presentation">
<tr><td><code>posterior_sample</code></td>
<td>
<p>an <code>mcmc.list</code> object generated through the <code>coda.samples()</code> function,
which includes posterior samples of the link parameters and response rates generated through the MCMC
process</p>
</td></tr>
<tr><td><code>pi_hat_bjsm</code></td>
<td>
<p>estimate of response rate/treatment effect</p>
</td></tr>
<tr><td><code>se_hat_bjsm</code></td>
<td>
<p>standard error of the response rate</p>
</td></tr>
<tr><td><code>ci_pi_A</code>, <code>ci_pi_B</code>, <code>ci_pi_C</code></td>
<td>
<p>x% credible intervals for treatment A, B, C</p>
</td></tr>
<tr><td><code>diff_AB</code>, <code>diff_BC. diff_AC</code></td>
<td>
<p>estimate of differences between treatments A
and B, B and C, A and C</p>
</td></tr>
<tr><td><code>ci_diff_AB</code>, <code>ci_diff_BC</code>, <code>ci_diff_AC</code></td>
<td>
<p>x% credible intervals for the differences
between treatments A and B, B and C, A and C</p>
</td></tr>
<tr><td><code>se_AB</code>, <code>se_BC</code>, <code>se_AC</code></td>
<td>
<p>standard error for the differences between treatments
A and B, B and C, A and C</p>
</td></tr>
<tr><td><code>beta0_hat</code>, <code>beta1_hat</code></td>
<td>
<p>linkage parameter <code>beta0</code> and <code>beta1</code> estimates</p>
</td></tr>
<tr><td><code>se_beta0_hat</code>, <code>se_beta1_hat</code></td>
<td>
<p>standard error of the estimated value of linkage
parameter <code>beta0</code> and <code>beta1</code></p>
</td></tr>
<tr><td><code>ci_beta0_hat</code>, <code>ci_beta1_hat</code></td>
<td>
<p>linkage parameter <code>beta0</code> and <code>beta1</code>
credible interval</p>
</td></tr>
<tr><td><code>pi_DTR_est</code></td>
<td>
<p>expected response rate of dynamic treatment regimens (DTRs)</p>
</td></tr>
<tr><td><code>pi_DTR_se</code></td>
<td>
<p>standard error for the estimated DTR response rate</p>
</td></tr>
<tr><td><code>ci_pi_AB</code>, <code>ci_pi_AC</code>, <code>ci_pi_BA</code>, <code>ci_pi_BC</code>, <code>ci_pi_CA</code>, <code>ci_pi_CB</code></td>
<td>
<p>x% credible intervals for the estimated DTR response rate</p>
</td></tr>
</table>


<h3>References</h3>

<p>Chao, Y.C., Braun, T.M., Tamura, R.N. and Kidwell, K.M., 2020. A Bayesian group
sequential small n sequential multiple‐assignment randomized trial. Journal of
the Royal Statistical Society: Series C (Applied Statistics), 69(3), pp.663-680. URL: <a href="doi:10.1111/rssc.12406">doi:10.1111/rssc.12406</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mydata &lt;- groupseqDATA_look1

result1 &lt;- group_seq(
  data = mydata, interim = TRUE, drop_threshold_pair = c(0.5, 0.4),
  prior_dist = c("beta", "beta", "pareto"), pi_prior = c(0.4, 1.6, 0.4, 1.6, 0.4, 1.6),
  beta_prior = c(1.6, 0.4, 3, 1), MCMC_SAMPLE = 6000, n.adapt = 1000, n_MCMC_chain = 1
)

summary(result1)


mydata &lt;- groupseqDATA_full
result2 &lt;- group_seq(
  data = mydata, interim = FALSE, prior_dist = c("beta", "beta", "pareto"),
  pi_prior = c(0.4, 1.6, 0.4, 1.6, 0.4, 1.6),
  beta_prior = c(1.6, 0.4, 3, 1), MCMC_SAMPLE = 6000, n.adapt = 1000,
  n_MCMC_chain = 1, ci = 0.95, DTR = TRUE
)

summary(result2)

</code></pre>

<hr>
<h2 id='groupseqDATA_full'>Group sequential full data</h2><span id='topic+groupseqDATA_full'></span>

<h3>Description</h3>

<p>sample synthetic dataset of group sequential trial design snSMART, can be used for final analysis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>groupseqDATA_full
</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>time.1st.trt</dt><dd><p>first treatment time</p>
</dd>
<dt>time.1st.resp</dt><dd><p>first response time</p>
</dd>
<dt>time.2nd.trt</dt><dd><p>second treatment time</p>
</dd>
<dt>time.2nd.resp</dt><dd><p>second response time</p>
</dd>
<dt>trt.1st</dt><dd><p>treatment arm for first treatment</p>
</dd>
<dt>resp.1st</dt><dd><p>response for first treatment</p>
</dd>
<dt>trt.2nd</dt><dd><p>treatment arm for second treatment</p>
</dd>
<dt>resp.2nd</dt><dd><p>response for second treatment</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>mydata &lt;- groupseqDATA_full
result2 &lt;- group_seq(
  data = mydata, interim = FALSE, prior_dist = c(
    "beta", "beta", "pareto"
  ), pi_prior = c(0.4, 1.6, 0.4, 1.6, 0.4, 1.6),
  beta_prior = c(1.6, 0.4, 3, 1), MCMC_SAMPLE = 6000, n.adapt = 1000,
  n_MCMC_chain = 1, ci = 0.95, DTR = TRUE
)
</code></pre>

<hr>
<h2 id='groupseqDATA_look1'>Group sequential data look 1</h2><span id='topic+groupseqDATA_look1'></span>

<h3>Description</h3>

<p>sample synthetic dataset of group sequential trial design snSMART, can be used for interim analysis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>groupseqDATA_look1
</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>time.1st.trt</dt><dd><p>first treatment time</p>
</dd>
<dt>time.1st.resp</dt><dd><p>first response time</p>
</dd>
<dt>time.2nd.trt</dt><dd><p>second treatment time</p>
</dd>
<dt>time.2nd.resp</dt><dd><p>second response time</p>
</dd>
<dt>trt.1st</dt><dd><p>treatment arm for first treatment</p>
</dd>
<dt>resp.1st</dt><dd><p>response for first treatment</p>
</dd>
<dt>trt.2nd</dt><dd><p>treatment arm for second treatment</p>
</dd>
<dt>resp.2nd</dt><dd><p>response for second treatment</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>mydata &lt;- groupseqDATA_look1

result1 &lt;- group_seq(
  data = mydata, interim = TRUE, drop_threshold_pair = c(0.5, 0.4),
  prior_dist = c("beta", "beta", "pareto"), pi_prior = c(0.4, 1.6, 0.4, 1.6, 0.4, 1.6),
  beta_prior = c(1.6, 0.4, 3, 1), MCMC_SAMPLE = 6000, n.adapt = 1000, n_MCMC_chain = 1
)

</code></pre>

<hr>
<h2 id='LPJSM_binary'>LPJSM for snSMART with binary outcomes (3 active treatments or placebo and two
dose level)</h2><span id='topic+LPJSM_binary'></span><span id='topic+summary.LPJSM_binary'></span><span id='topic+print.summary.LPJSM_binary'></span><span id='topic+print.LPJSM_binary'></span>

<h3>Description</h3>

<p>A joint-stage regression model (LPJSM) is a frequentist modeling approach that
incorporates the responses of both stages as repeated measurements for each subject.
Generalized estimating equations (GEE) are used to estimate the response rates of
each treatment. The marginal response rates for each DTR can also be obtained based
on the GEE results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LPJSM_binary(data, six = TRUE, DTR = TRUE, ...)

## S3 method for class 'LPJSM_binary'
summary(object, ...)

## S3 method for class 'summary.LPJSM_binary'
print(x, ...)

## S3 method for class 'LPJSM_binary'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LPJSM_binary_+3A_data">data</code></td>
<td>
<p>dataset with columns named as <code>treatment_stageI</code>, <code>response_stageI</code>,
<code>treatment_stageII</code> and <code>response_stageII</code></p>
</td></tr>
<tr><td><code id="LPJSM_binary_+3A_six">six</code></td>
<td>
<p>if TRUE, will run the six beta model, if FALSE will run the two
beta model. Default is <code>six = TRUE</code></p>
</td></tr>
<tr><td><code id="LPJSM_binary_+3A_dtr">DTR</code></td>
<td>
<p>if TRUE, will also return the expected response rate and its standard
error of dynamic treatment regimens</p>
</td></tr>
<tr><td><code id="LPJSM_binary_+3A_...">...</code></td>
<td>
<p>optional arguments that are passed to <code>geepack::geeglm()</code> function.</p>
</td></tr>
<tr><td><code id="LPJSM_binary_+3A_object">object</code></td>
<td>
<p>object to print</p>
</td></tr>
<tr><td><code id="LPJSM_binary_+3A_x">x</code></td>
<td>
<p>object to summarize.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>list</code> containing
</p>
<table role = "presentation">
<tr><td><code>GEE_output</code></td>
<td>
<p> - original output of the GEE (geeglm) model</p>
</td></tr>
<tr><td><code>pi_hat</code></td>
<td>
<p> - estimate of response rate/treatment effect</p>
</td></tr>
<tr><td><code>sd_pi_hat</code></td>
<td>
<p> - standard error of the response rate</p>
</td></tr>
<tr><td><code>pi_DTR_hat</code></td>
<td>
<p> - expected response rate of dynamic treatment regimens (DTRs)</p>
</td></tr>
<tr><td><code>pi_DTR_se</code></td>
<td>
<p> - standard deviation of DTR estimates</p>
</td></tr>
</table>


<h3>References</h3>

<p>Wei, B., Braun, T.M., Tamura, R.N. and Kidwell, K.M., 2018. A Bayesian analysis of small n sequential multiple assignment randomized trials (snSMARTs).
Statistics in medicine, 37(26), pp.3723-3732. URL: <a href="doi:10.1002/sim.7900">doi:10.1002/sim.7900</a>
</p>
<p>Chao, Y.C., Trachtman, H., Gipson, D.S., Spino, C., Braun, T.M. and Kidwell, K.M., 2020. Dynamic treatment regimens in small n, sequential, multiple assignment, randomized trials: An application in focal segmental glomerulosclerosis. Contemporary clinical trials, 92, p.105989. URL: <a href="doi:10.1016/j.cct.2020.105989">doi:10.1016/j.cct.2020.105989</a>
</p>
<p>Fang, F., Hochstedler, K.A., Tamura, R.N., Braun, T.M. and Kidwell, K.M., 2021. Bayesian methods to compare dose levels with placebo in a small n,
sequential, multiple assignment, randomized trial. Statistics in Medicine, 40(4), pp.963-977. URL: <a href="doi:10.1002/sim.8813">doi:10.1002/sim.8813</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+BJSM_binary">BJSM_binary</a></code> <br />
<code><a href="#topic+sample_size">sample_size</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- data_binary

LPJSM_result &lt;- LPJSM_binary(data = data, six = TRUE, DTR = TRUE)

summary(LPJSM_result)

</code></pre>

<hr>
<h2 id='sample_size'>Sample size calculation for snSMART with 3 active treatments and a binary outcome</h2><span id='topic+sample_size'></span><span id='topic+summary.sample_size'></span><span id='topic+print.summary.sample_size'></span><span id='topic+print.sample_size'></span>

<h3>Description</h3>

<p>conduct Bayesian sample size calculation for a snSMART design with 3 active
treatments and a binary outcome to distinguish the best treatment from the second-best
treatment using the Bayesian joint stage model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sample_size(pi, beta1, beta0, coverage, power, mu, n, verbose = FALSE)

## S3 method for class 'sample_size'
summary(object, ...)

## S3 method for class 'summary.sample_size'
print(x, ...)

## S3 method for class 'sample_size'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sample_size_+3A_pi">pi</code></td>
<td>
<p>a vector with 3 values (<code>piA</code>, <code>piB</code>, <code>piC</code>). <code>piA</code> is the the response
rate (ranges from 0.01 to 0.99) for treatment A, <code>piB</code> is the response rate
(ranges from 0.01 to 0.99) for treatment B, <code>piC</code> is the response rate (ranges
from 0.01 to 0.99) for treatment C</p>
</td></tr>
<tr><td><code id="sample_size_+3A_beta1">beta1</code></td>
<td>
<p>the linkage parameter (ranges from 1.00 to 1/largest response rate)
for first stage responders. (A smaller value leads to more conservative sample
size calculation because two stages are less correlated)</p>
</td></tr>
<tr><td><code id="sample_size_+3A_beta0">beta0</code></td>
<td>
<p>the linkage parameter (ranges from 0.01 to 0.99) for first stage
non-responders. A larger value leads to a more conservative sample size calculation
because two stages are less correlated</p>
</td></tr>
<tr><td><code id="sample_size_+3A_coverage">coverage</code></td>
<td>
<p>the coverage rate (ranges from 0.01 to 0.99) for the posterior
difference of top two treatments</p>
</td></tr>
<tr><td><code id="sample_size_+3A_power">power</code></td>
<td>
<p>the probability (ranges from 0.01 to 0.99) for identify the best treatment</p>
</td></tr>
<tr><td><code id="sample_size_+3A_mu">mu</code></td>
<td>
<p>a vector with 3 values (<code>muA</code>, <code>muB</code>, <code>muC</code>). <code>muA</code> is the prior mean
(ranges from 0.01 to 0.99) for treatment A, <code>muB</code> is the prior mean (ranges from
0.01 to 0.99) for treatment B, <code>muC</code> is the prior mean (ranges from 0.01 to 0.99)
for treatment C</p>
</td></tr>
<tr><td><code id="sample_size_+3A_n">n</code></td>
<td>
<p>a vector with 3 values (<code>nA</code>, <code>nB</code>, <code>nC</code>). <code>nA</code> is the prior sample size
(larger than 0) for treatment A. <code>nB</code> is the prior sample size (larger than 0)
for treatment B. <code>nC</code> is the prior sample size (larger than 0) for treatment C</p>
</td></tr>
<tr><td><code id="sample_size_+3A_verbose">verbose</code></td>
<td>
<p>TRUE or FALSE. If FALSE, no function message and progress bar will be
printed.</p>
</td></tr>
<tr><td><code id="sample_size_+3A_object">object</code></td>
<td>
<p>object to summarize.</p>
</td></tr>
<tr><td><code id="sample_size_+3A_...">...</code></td>
<td>
<p>further arguments. Not currently used.</p>
</td></tr>
<tr><td><code id="sample_size_+3A_x">x</code></td>
<td>
<p>object to print</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that this package does not include the JAGS library, users need to install JAGS separately. Please check this page for more details: <a href="https://sourceforge.net/projects/mcmc-jags/">https://sourceforge.net/projects/mcmc-jags/</a>
This function may take a few minutes to run
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>final_N</code></td>
<td>
<p>the estimated sample size per arm for this snSMART</p>
</td></tr>
<tr><td><code>critical_value</code></td>
<td>
<p> critical value based on the provided coverage value</p>
</td></tr>
<tr><td><code>grid_result</code></td>
<td>
<p>for each iteration we calculate <code>l</code>, where <code>l</code> belongs to <code>{2 * (pi_(1) - pi_(2)), ..., 0.02, 0.01}</code>; <code>E(D)</code>: the mean of the posterior distribution of <code>D</code>,
, where <code>D = pi_(1) = pi_(2)</code>; <code>Var(D)</code>: the variance of the posterior distribution of <code>D</code>; <code>N</code>: the corresponding
sample size; and <code>power</code>: the resulting power of this iteration</p>
</td></tr>
</table>


<h3>References</h3>

<p>Wei, B., Braun, T.M., Tamura, R.N. and Kidwell, K.M., 2018. A Bayesian analysis of small n sequential multiple assignment randomized trials (snSMARTs).
Statistics in medicine, 37(26), pp.3723-3732. URL: <a href="doi:10.1002/sim.7900">doi:10.1002/sim.7900</a>
</p>
<p>Wei, B., Braun, T.M., Tamura, R.N. and Kidwell, K., 2020. Sample size determination
for Bayesian analysis of small n sequential, multiple assignment, randomized trials
(snSMARTs) with three agents. Journal of Biopharmaceutical Statistics, 30(6), pp.1109-1120. URL: <a href="doi:10.1080/10543406.2020.1815032">doi:10.1080/10543406.2020.1815032</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+BJSM_binary">BJSM_binary</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# short running time example
sampleSize &lt;- sample_size(
  pi = c(0.7, 0.5, 0.25), beta1 = 1.4, beta0 = 0.5, coverage = 0.9,
  power = 0.3, mu = c(0.65, 0.55, 0.25), n = c(10, 10, 10)
)

## End(Not run)


sampleSize &lt;- sample_size(
  pi = c(0.7, 0.5, 0.25), beta1 = 1.4, beta0 = 0.5, coverage = 0.9,
  power = 0.8, mu = c(0.65, 0.55, 0.25), n = c(4, 2, 3)
)


</code></pre>

<hr>
<h2 id='summary.BJSM_binary'>Summarizing BJSM fits</h2><span id='topic+summary.BJSM_binary'></span>

<h3>Description</h3>

<p><code>summary</code> method for class &quot;<code>BJSM_binary</code>&quot;
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'BJSM_binary'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.BJSM_binary_+3A_object">object</code></td>
<td>
<p>an object of class &quot;<code>BJSM_binary</code>&quot;, usually, a result of a call to <code><a href="#topic+BJSM_binary">BJSM_binary</a></code></p>
</td></tr>
<tr><td><code id="summary.BJSM_binary_+3A_...">...</code></td>
<td>
<p>further arguments. Not currently used.</p>
</td></tr>
</table>


<h3>Value</h3>


<dl>
<dt>Treatment Effects Estimate</dt><dd><p>a 3 x 5 matrix with columns for the estimated treatment effects, its standard error, coverage probability of its credible interval, lower bound for its credible interval and higher bound for its credible interval</p>
</dd>
<dt>Differences between Treatments</dt><dd><p>a 3 x 5 matrix with columns for the estimated differences in treatment effects between two treatments, its standard error, coverage probability of its credible interval, lower bound and higher bound of the credible interval</p>
</dd>
<dt>Linkage Parameter Estimate</dt><dd><p>a 2 x 5 matrix, if the two beta model is fitted, or a 6 x 5 matrix, if the six beta model is fitted, with columns for the estimated linkage parameters</p>
</dd>
<dt>Expected Response Rate of Dynamic Treatment Regimens (DTR)</dt><dd><p>only when <code>DTR = TRUE</code></p>
</dd>
</dl>


<hr>
<h2 id='summary.BJSM_dose_binary'>Summarizing BJSM fits</h2><span id='topic+summary.BJSM_dose_binary'></span>

<h3>Description</h3>

<p><code>summary</code> method for class <code>BJSM_dose_binary</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'BJSM_dose_binary'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.BJSM_dose_binary_+3A_object">object</code></td>
<td>
<p>an object of class <code>BJSM_dose_binary</code>, usually, a result of a call to <code><a href="#topic+BJSM_binary">BJSM_binary</a></code></p>
</td></tr>
<tr><td><code id="summary.BJSM_dose_binary_+3A_...">...</code></td>
<td>
<p>further arguments. Not currently used.</p>
</td></tr>
</table>


<h3>Value</h3>


<dl>
<dt>Treatment Effects Estimate</dt><dd><p>a 3 x 5 matrix with columns for the estimated treatment effects, its standard error, coverage probability of its credible interval, lower bound for its credible interval and higher bound for its credible interval</p>
</dd>
<dt>Differences between Treatments</dt><dd><p>a 3 x 5 matrix with columns for the estimated differences in treatment effects between two treatments, its standard error, coverage probability of its credible interval, lower bound and higher bound of the credible interval</p>
</dd>
<dt>Linkage Parameter Estimate</dt><dd><p>a 6 x 5 matrix with columns for the estimated linkage parameters</p>
</dd>
</dl>


<hr>
<h2 id='summary.group_seq'>Summarizing BJSM fits</h2><span id='topic+summary.group_seq'></span>

<h3>Description</h3>

<p><code>summary</code> method for class &quot;<code>group_seq</code>&quot;
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'group_seq'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.group_seq_+3A_object">object</code></td>
<td>
<p>an object of class &quot;<code>group_seq</code>&quot;, usually, a result of a call to <code><a href="#topic+group_seq">group_seq</a></code></p>
</td></tr>
<tr><td><code id="summary.group_seq_+3A_...">...</code></td>
<td>
<p>further arguments. Not currently used.</p>
</td></tr>
</table>


<h3>Value</h3>


<dl>
<dt>Treatment Effects Estimate</dt><dd><p>a 3 x 5 matrix with columns for the estimated treatment effects, its standard error, coverage probability of its credible interval, lower bound for its credible interval and higher bound for its credible interval</p>
</dd>
<dt>Differences between Treatments</dt><dd><p>a 3 x 5 matrix with columns for the estimated differences in treatment effects between two treatments, its standard error, coverage probability of its credible interval, lower bound and higher bound of the credible interval</p>
</dd>
<dt>Linkage Parameter Estimate</dt><dd><p>a 2 x 5 matrix, if the two beta model is fitted, or a 6 x 5 matrix, if the six beta model is fitted, with columns for the estimated linkage parameters</p>
</dd>
<dt>Expected Response Rate of Dynamic Treatment Regimens (DTR)</dt><dd><p>only when <code>DTR = TRUE</code></p>
</dd>
</dl>


<hr>
<h2 id='trialDataMF'>Dataset with continuous outcomes</h2><span id='topic+trialDataMF'></span>

<h3>Description</h3>

<p>sample synthetic dataset of snSMART (mapping function) with continuous outcomes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trialDataMF
</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>id</dt><dd><p>participant ID</p>
</dd>
<dt>trt1</dt><dd><p>treatment received in stage 1 - possible values: 1 (placebo), 2, 3</p>
</dd>
<dt>stage1outcome</dt><dd><p>a number between 0-100 that represents the stage 1 treatment effect</p>
</dd>
<dt>stay</dt><dd><p>indicates whether the participant stayed on the same treatment arm in stage 2 - possible values: 0 (didn't stay), 1 (stayed)</p>
</dd>
<dt>trt2</dt><dd><p>treatment received in stage 2 - possible values: 2, 3</p>
</dd>
<dt>stage2outcome</dt><dd><p>a number between 0-100 that represents the stage 2 treatment effect</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>trialData &lt;- trialDataMF

BJSM_result &lt;- BJSM_c(
  data = trialData, xi_prior.mean = c(50, 50, 50),
  xi_prior.sd = c(50, 50, 50), phi3_prior.sd = 20, n_MCMC_chain = 1,
  n.adapt = 1000, MCMC_SAMPLE = 5000, ci = 0.95, n.digits = 5
)

summary(BJSM_result)
print(BJSM_result)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
