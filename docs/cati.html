<!DOCTYPE html><html><head><title>Help for package cati</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {cati}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#AbToInd'>
<p>Internal function. Transform abundance data matrix into individual like matrix.</p></a></li>
<li><a href='#as.listofindex'>
<p>Transform index results in a list of index</p></a></li>
<li><a href='#Auxiliary+20functions'>
<p>Auxiliary functions</p></a></li>
<li><a href='#ComIndex'>
<p>Computing metrics to test and quantify the non-random assembly of communities</p></a></li>
<li><a href='#ComIndexMulti'>
<p>Computing multitraits metrics to test and quantify the non-random assembly of communities</p></a></li>
<li><a href='#decompCTRE'>
<p>Variance partitioning for multiple traits</p></a></li>
<li><a href='#finch.ind'>
<p>Finch morphological data</p></a></li>
<li><a href='#Fred'>
<p>Functional richness, evenness and divergence following Villeger et al. 2008</p></a></li>
<li><a href='#IndexByGroups'>
<p>Apply metrics to groups.</p></a></li>
<li><a href='#MinMaxMST'>
<p>Ratio of the shortest distance to the longest distance in a minimum spanning tree</p></a></li>
<li><a href='#Neigbourhood+20distance+20metrics'>
<p>Coefficient of variation, mean, minimum and standard deviation of the nearest neigbourhood distance.</p></a></li>
<li><a href='#partvar'>
<p>Variance partitioning accross nested scales</p></a></li>
<li><a href='#plot.listofindex'>
<p>Plot community assembly index</p></a></li>
<li><a href='#plotCorTstats'>
<p>Plot the bivariate relationships between T-statistics</p></a></li>
<li><a href='#plotDistri'>
<p>Plot function to represent density of trait values</p></a></li>
<li><a href='#plotRandtest'>
<p>Plot result of observed indices values against null distribution</p></a></li>
<li><a href='#plotSESvar'>
<p>Plot SES values against a variable</p></a></li>
<li><a href='#plotSpPop'>
<p>Plot populations values against species values</p></a></li>
<li><a href='#plotSpVar'>
<p>Plot populations values against species values</p></a></li>
<li><a href='#Pval'>
<p>Calcul of p-value for object of class Tstats, ComIndex, ComIndexMulti and listofindex</p></a></li>
<li><a href='#RandCom'>
<p>Toy model to simulate internal and/or external filtering</p></a></li>
<li><a href='#RaoRel'>
<p>Alpha, gamma and beta-components for taxonomic, functional and phylogenetic diversity</p></a></li>
<li><a href='#samplingSubsetData'>
<p>Sampling subset of data.</p></a></li>
<li><a href='#ses'>
<p>Standardized effect size and confidence interval for a matrix of statistics</p></a></li>
<li><a href='#ses.listofindex'>
<p>Standardized effect size for a list of index.</p></a></li>
<li><a href='#SumBL'>
<p>Sum of branch length of a classification dendrogram (Petchey and Gaston, 2002)</p></a></li>
<li><a href='#traitflex.anova'>
<p>Variance decomposition for a given trait used in decompCTRE</p></a></li>
<li><a href='#Tstats'>
<p>Computing observed T-statistics (T for Traits) and null expectations.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Community Assembly by Traits: Individuals and Beyond</td>
</tr>
<tr>
<td>Version:</td>
<td>0.99.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-02-25</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Adrien Taudiere &lt;adrien.taudiere@tutanota.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), nlme, ade4, ape,</td>
</tr>
<tr>
<td>Imports:</td>
<td>e1071, rasterVis, hypervolume, FD, geometry, vegan</td>
</tr>
<tr>
<td>Suggests:</td>
<td>lattice, entropart, fBasics, picante, mice, knitr</td>
</tr>
<tr>
<td>Description:</td>
<td>Detect and quantify community assembly processes using trait values of individuals or populations, the T-statistics and other metrics, and dedicated null models.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/adrientaudiere/cati">https://github.com/adrientaudiere/cati</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-02-25 09:54:52 UTC; adrien</td>
</tr>
<tr>
<td>Author:</td>
<td>Adrien Taudiere <a href="https://orcid.org/0000-0003-1088-1182"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Cyrille Violle <a href="https://orcid.org/0000-0002-2471-9226"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Fran√ßois Munoz <a href="https://orcid.org/0000-0001-8776-4705"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-02-25 10:10:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='AbToInd'>
Internal function. Transform abundance data matrix into individual like matrix.
</h2><span id='topic+AbToInd'></span>

<h3>Description</h3>

<p>Transform abundance data matrix into individual like matrix to allows the use of ComIndex and ComIndexMulti on populationnal or specific traits values. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	AbToInd(traits, com, type.sp.val = "count")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AbToInd_+3A_traits">traits</code></td>
<td>

<p>Individual Matrix of traits with traits in columns. &quot;traits&quot; matrix must have row names (e.g. species or populationnal names).
</p>
</td></tr>
<tr><td><code id="AbToInd_+3A_com">com</code></td>
<td>

<p>Community data matrix with species in rows and sites in column.
</p>
</td></tr>
<tr><td><code id="AbToInd_+3A_type.sp.val">type.sp.val</code></td>
<td>

<p>Either &quot;count&quot; or &quot;abundance&quot;. Use abundance when all values in the com matrix are not superior to one. Using abundance is EXPERIMENTAL. This function round abundance to fit count data. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Internal function
</p>


<h3>Value</h3>

<p>A list of objects:
</p>
<table>
<tr><td><code>$traits</code></td>
<td>
<p>Individual traits matrix</p>
</td></tr>
<tr><td><code>$sp</code></td>
<td>
<p>Vector of species attributes</p>
</td></tr>
<tr><td><code>$ind.plot</code></td>
<td>
<p>Vector of sites attributes</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Adrien Taudiere
</p>

<hr>
<h2 id='as.listofindex'>
Transform index results in a list of index
</h2><span id='topic+as.listofindex'></span>

<h3>Description</h3>

<p>Transform various results from functions Tstats, ComIndex or ComIndexMulti in a list of index. Useful to use the functions plot.listofindex (S3 method) and ses.listofindex.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	as.listofindex(x, namesindex = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.listofindex_+3A_x">x</code></td>
<td>

<p>A list of objects of class Tstats, ComIndex or ComIndexMulti
</p>
</td></tr>
<tr><td><code id="as.listofindex_+3A_namesindex">namesindex</code></td>
<td>

<p>Optionnal, the names of index in the same order as in x.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of observed values and corresponding &quot;null&quot; values (i.e. produced by null models) in the form &quot;list(index1, null model index1, index2, null model index2 ...)&quot;
</p>


<h3>Author(s)</h3>

<p>Adrien Taudiere
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ses.listofindex">ses.listofindex</a></code>;
<code><a href="#topic+plot.listofindex">plot.listofindex</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>	data(finch.ind)

	res.finch &lt;- Tstats(traits.finch, ind.plot = ind.plot.finch, 
	sp = sp.finch, nperm = 9, print = FALSE)

	## Not run: 
		#### Use a different regional pool than the binding of studied communities
		#create a random regional pool for the example
	
		reg.p &lt;- rbind(traits.finch, traits.finch[sample(1:2000,300), ])
	
		res.finch2 &lt;- Tstats(traits.finch, ind.plot = ind.plot.finch, 
	    sp = sp.finch, reg.pool=reg.p, nperm = 9, print = FALSE)	
	    
	    plot(as.listofindex(list(res.finch,res.finch2)))
    
    
	    #### Use a different regional pool for each communities
		#create a random regional pool for each communities for the example
		list.reg.p &lt;- list(
		traits.finch[sample(1:290,200), ], traits.finch[sample(100:1200,300), ], 
		traits.finch[sample(100:1500, 1000), ], traits.finch[sample(300:800,300), ],
		traits.finch[sample(1000:2000, 500), ], traits.finch[sample(100:900, 700), ] )

		# Warning: the regional pool need to be larger than the observed communities
		table(ind.plot.finch)
		# For exemple, the third community need a regional pool of more than 981 individuals
		
		res.finch3 &lt;- Tstats(traits.finch, ind.plot = ind.plot.finch, 
	    sp = sp.finch, reg.pool=list.reg.p, nperm = 9, print = FALSE)	
	    
	    plot(as.listofindex(list(res.finch, res.finch2, res.finch3)))	
	
## End(Not run)


</code></pre>

<hr>
<h2 id='Auxiliary+20functions'>
Auxiliary functions
</h2><span id='topic+funky.col'></span>

<h3>Description</h3>

<p>Auxiliary functions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	funky.col(n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Auxiliary+2B20functions_+3A_n">n</code></td>
<td>

<p>number of color for the funky palette
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>funky.col is a clone of the palette funky from the adegenet package.
</p>


<h3>Value</h3>

<p>A color palette
</p>


<h3>Author(s)</h3>

<p>Thibault Jombart
</p>

<hr>
<h2 id='ComIndex'>
Computing metrics to test and quantify the non-random assembly of communities
</h2><span id='topic+ComIndex'></span><span id='topic+plot.ComIndex'></span><span id='topic+summary.ComIndex'></span><span id='topic+print.ComIndex'></span>

<h3>Description</h3>

<p>Computing the moments of the trait distribution and other metrics to test and quantify the non-random assembly of communities. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
	ComIndex(traits = NULL, index = NULL, nullmodels = NULL, 
	ind.plot = NULL, sp = NULL, com = NULL, SE = 0, namesindex = NULL,
	reg.pool = NULL, SE.reg.pool = NULL, nperm = 99, printprogress = TRUE, 
	independantTraits = TRUE, type.sp.val = "count")
	
	## S3 method for class 'ComIndex'
plot(x, type = "normal", 
	col.index = c("red", "purple", "olivedrab3"), add.conf = TRUE, 
	color.cond = TRUE, val.quant = c(0.025, 0.975), ...)
		
	## S3 method for class 'ComIndex'
print(x, ...)
		
	## S3 method for class 'ComIndex'
summary(object, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ComIndex_+3A_traits">traits</code></td>
<td>

<p>Individual Matrix of traits with traits in column (or species matrix when using &quot;com&quot; instead of &quot;ind.plot&quot;). 
</p>
</td></tr>
<tr><td><code id="ComIndex_+3A_index">index</code></td>
<td>

<p>A vector of function to apply to traits vectors in the form &quot;mean(x, na.rm = TRUE)&quot; or &quot;range(x)&quot;, see examples for more complexe functions.
</p>
</td></tr>
<tr><td><code id="ComIndex_+3A_nullmodels">nullmodels</code></td>
<td>

<p>A vector of names corresponding to null models tu use for each index. <strong>local</strong> (or 1) corresponds to a randomization of individual values within a given community. <strong>regional.ind</strong> (or 2) corresponds to randomization of individual values within region, ie within all the dataset. A value of <strong>regional.pop</strong> (or 2sp) corresponds to randomization of population values (each individual value are replaced by the mean value of it population) within region. Finally a value of <strong>regional.pop.prab</strong> (or 2sp.prab)  mirror null model <strong>regional.pop</strong> but without taking indo account species abundance. For example, if nullmodels = c(&quot;local&quot;, &quot;regional.ind&quot;), the first index will be calculated on the null model <strong>local</strong>  and the second index on the null model <strong>regional.ind</strong>.
</p>
<p>If only one value is given, all the the null model will be determined by this value. 
</p>
</td></tr>
<tr><td><code id="ComIndex_+3A_ind.plot">ind.plot</code></td>
<td>

<p>Factor defining the name of the plot (site or community) in which the individual is. 
</p>
</td></tr>
<tr><td><code id="ComIndex_+3A_sp">sp</code></td>
<td>

<p>Factor defining the species which the individual belong to.
</p>
</td></tr>
<tr><td><code id="ComIndex_+3A_com">com</code></td>
<td>

<p>Community data matrix with species (or populations) in rows and sites in column. Use only if ind.plot = NULL. 
&quot;traits&quot; matrix and &quot;com&quot; matrix must have the same number of rows.
</p>
</td></tr>
<tr><td><code id="ComIndex_+3A_se">SE</code></td>
<td>

<p>A single value or vector of standard errors associated with each traits. Especially allow to handle measurement errors. Not used with populational null model.  
</p>
</td></tr>
<tr><td><code id="ComIndex_+3A_namesindex">namesindex</code></td>
<td>

<p>A vector of names for index.
</p>
</td></tr>
<tr><td><code id="ComIndex_+3A_reg.pool">reg.pool</code></td>
<td>

<p>Regional pool data for traits. If not informed, traits is considere as the regional pool. This matrix need to be larger (more rows) than the matrix &quot;traits&quot;. Use only for null model <strong>regional.ind</strong>.
</p>
</td></tr>	
<tr><td><code id="ComIndex_+3A_se.reg.pool">SE.reg.pool</code></td>
<td>

<p>A single value or vector of standard errors associated with each traits in each regional pool. Use only if reg.pool is used. Need to have the same dimension as reg.pool.
</p>
</td></tr>
<tr><td><code id="ComIndex_+3A_nperm">nperm</code></td>
<td>

<p>Number of permutations. If NULL, only observed values are returned.
</p>
</td></tr>
<tr><td><code id="ComIndex_+3A_printprogress">printprogress</code></td>
<td>

<p>Logical value; print progress during the calculation or not.
</p>
</td></tr>
<tr><td><code id="ComIndex_+3A_independanttraits">independantTraits</code></td>
<td>
 
<p>Logical value (default: TRUE). If independantTraits is true (default), each traits is sample independently in null models, if not, each lines of the matrix are randomized, keeping the relation (and trade-off) among traits.
</p>
</td></tr>
<tr><td><code id="ComIndex_+3A_type.sp.val">type.sp.val</code></td>
<td>

<p>Only if ind.plot = NULL. Either &quot;count&quot; or &quot;abundance&quot;. Use abundance when one value or more in the com matrix are inferior to one. Using abundance is EXPERIMENTAL. This function round abundance to fit count data.
</p>
</td></tr>
<tr><td><code id="ComIndex_+3A_x">x</code></td>
<td>

<p>An object of class ComIndex.
</p>
</td></tr>
<tr><td><code id="ComIndex_+3A_object">object</code></td>
<td>

<p>An object of class ComIndex.
</p>
</td></tr>
<tr><td><code id="ComIndex_+3A_type">type</code></td>
<td>

<p>Type of plot. Possible type = &quot;simple&quot;, &quot;simple_range&quot;, &quot;normal&quot;, &quot;barplot&quot; and &quot;bytraits&quot;.
</p>
</td></tr>
<tr><td><code id="ComIndex_+3A_col.index">col.index</code></td>
<td>

<p>Vector of colors for index.
</p>
</td></tr>
<tr><td><code id="ComIndex_+3A_add.conf">add.conf</code></td>
<td>

<p>Logical value; Add confidence intervals or not. 
</p>
</td></tr>
<tr><td><code id="ComIndex_+3A_color.cond">color.cond</code></td>
<td>

<p>Logical value; If color.cond = TRUE, color points indicate T-statistics values significatively different from the null model and grey points are not different from null model.
</p>
</td></tr>
<tr><td><code id="ComIndex_+3A_val.quant">val.quant</code></td>
<td>

<p>Numeric vectors of length 2, giving the quantile to calculate confidence interval. By default val.quant = c(0.025,0.975) for a bilateral test with alpha = 5%.
</p>
</td></tr>	
<tr><td><code id="ComIndex_+3A_...">...</code></td>
<td>

<p>Any additional arguments are passed to the plot, print or summary function. See <code><a href="#topic+plot.listofindex">plot.listofindex</a></code> for more arguments.
</p>
</td></tr>	
</table>


<h3>Details</h3>

<p>Compute statistics (e.g. mean, range, CVNND and kurtosis) to test community assembly using null models.
For each statistic this function returns observed values and the related null distribution.
This function implement four null models which keep unchanged the number of individual per community.
Model <strong>local</strong> (1) corresponds to randomization of individual values within community.
Model <strong>regional.ind</strong> (2) corresponds to randomization of individual values within region.
Model <strong>regional.pop</strong> (2sp) corresponds to randomization of population values within region.
Model <strong>regional.pop.prab</strong> (2sp.prab) corresponds to randomization of population values within region but whitout taking into account for abundance.
</p>
<p>In most cases, models <strong>local</strong> and <strong>regional.ind</strong> correspond to index at the individual level and the model <strong>regional.pop</strong> and <strong>regional.pop.prab</strong> to index at the species level (or any other aggregate variable like genus, family or functionnal group).
</p>
<p>S3 method plot for class listofindex:
</p>
<p>-Normal type plot means, standard deviations, ranges and confidence intervals of T-statistics.
</p>
<p>-Simple_range type plot means, standard deviations and range of T-statistics
</p>
<p>-Simple type plot T-statistics for each site and traits and the mean confidence intervals by traits
</p>
<p>-Barplot type plot means, standard deviations and confidence intervals of T-statistics in a barplot fashion
</p>
<p>-Bysites type plot each metrics for each sites
</p>
<p>-Bytraits type plot each metrics for each traits
</p>


<h3>Value</h3>

<p>An object of class &quot;ComIndex&quot; corresponding to a list of lists:
</p>
<table>
<tr><td><code>$obs</code></td>
<td>
<p>List of observed values for each trait in each community. Each component of the list corresponds to a matrix containing the result for each custom function.</p>
</td></tr>
<tr><td><code>$null</code></td>
<td>
<p>List of null values for each trait in each community. Each component of the list corresponds to an array containing the result of the permutations for each custom function.</p>
</td></tr>
<tr><td><code>$list.index</code></td>
<td>
<p>List of index values and related null models. Internal use in other function. Traits in columns.</p>
</td></tr>
<tr><td><code>$list.index.t</code></td>
<td>
<p>List of index values and related null models. Internal use in other function. Traits in rows.</p>
</td></tr>
<tr><td><code>$sites_richness</code></td>
<td>
<p>Number of species per site.</p>
</td></tr>
<tr><td><code>$namestraits</code></td>
<td>
<p>Names of traits.</p>
</td></tr>
<tr><td><code>$traits</code></td>
<td>
<p>traits data</p>
</td></tr>
<tr><td><code>$ind.plot</code></td>
<td>
<p>name of the plot in which the individual is</p>
</td></tr>
<tr><td><code>$sp</code></td>
<td>
<p>groups (e.g. species) which the individual belong to</p>
</td></tr>
<tr><td><code>$nullmodels</code></td>
<td>
<p>List of null models used for each indices.</p>
</td></tr>
<tr><td><code>$call</code></td>
<td>
<p>call of the function Tstats</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Adrien Taudiere
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ComIndexMulti">ComIndexMulti</a></code>;
<code><a href="#topic+plot.listofindex">plot.listofindex</a></code>;
<code><a href="#topic+ses">ses</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>	
data(finch.ind)

## Not run: 
#Define the functions that will be calculating
funct&lt;-c("mean(x, na.rm = TRUE)", "kurtosis(x, na.rm = TRUE)",
     "max(x, na.rm = TRUE) - min(x, na.rm = TRUE)" )

#Test against the null model regional.ind
res.finch.sp_regional.ind&lt;-ComIndex(traits = traits.finch, index = funct, sp = sp.finch,
                           nullmodels = "regional.ind", ind.plot = ind.plot.finch,
                            nperm = 9, print = FALSE)
 
#Test against the null model regional.pop
#Individuals values are transformed in populational values
res.finch.sp_regional.pop&lt;-ComIndex(traits = traits.finch, index = funct, sp = sp.finch,
               nullmodels = "regional.pop", ind.plot = ind.plot.finch, 
               nperm = 9, print = FALSE)


#We can calculate index with or without intraspecific variance.

#calculate  of means by population (name_sp_site is a name of a population) 
#determine the site for each population (sites_bypop)
 
name_sp_sites = paste(sp.finch, ind.plot.finch,sep = "_")
traits.by.pop&lt;-apply(traits.finch, 2 , 
           function (x) tapply(x, name_sp_sites, mean, na.rm = TRUE))

sites_bypop&lt;-lapply(strsplit(paste(rownames(traits.by.pop), sep = "_"), split = "_"), 
          function(x) x[3])

#New list of function "funct"

funct.1&lt;-c("tapply(x, ind.plot.finch, function(x) mean(x, na.rm = TRUE))",
     "tapply(x, ind.plot.finch, function(x) kurtosis(x, na.rm = TRUE))",
     "tapply(x, ind.plot.finch, function(x) max(x, na.rm = TRUE)-min(x, na.rm = TRUE))", 
     "tapply(x, ind.plot.finch, function(x) CVNND(x, na.rm = TRUE))" )

fact&lt;-unlist(sites_bypop)  
funct.2&lt;-c("tapply(x, fact, function(x) mean(x, na.rm = TRUE))",
          "tapply(x, fact, function(x) kurtosis(x, na.rm = TRUE))",
          "tapply(x, fact, function(x) max(x, na.rm = TRUE)-min(x, na.rm = TRUE))", 
          "tapply(x, fact, function(x) CVNND(x, na.rm = TRUE))")


res.finch.withIV&lt;-ComIndex(traits = traits.finch, index = funct.1,
               sp = sp.finch, nullmodels = "regional.ind",
               ind.plot = ind.plot.finch, nperm = 9, print = FALSE)

res.finch.withoutIV&lt;-ComIndex(traits = traits.finch, index = funct.2, 
               sp = sp.finch, nullmodels = "regional.pop", 
               ind.plot = ind.plot.finch, nperm = 9, print = FALSE)

#ComIndex class are associated to S3 methods plot, print and summary.

res.finch.withIV
summary(res.finch.withIV)
plot(res.finch.withIV)
plot(res.finch.withoutIV)

plot(as.listofindex(list(res.finch.withIV, res.finch.withoutIV)))

## End(Not run)

</code></pre>

<hr>
<h2 id='ComIndexMulti'>
Computing multitraits metrics to test and quantify the non-random assembly of communities
</h2><span id='topic+ComIndexMulti'></span><span id='topic+plot.ComIndexMulti'></span><span id='topic+summary.ComIndexMulti'></span><span id='topic+print.ComIndexMulti'></span>

<h3>Description</h3>

<p>Computing multitraits metrics to test and quantify the non-random assembly of communities
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	
	ComIndexMulti(traits = NULL, index = NULL, by.factor = NULL, 
	nullmodels = NULL, ind.plot = NULL, sp = NULL, com = NULL,
	SE = 0, namesindex = NULL, reg.pool = NULL, SE.reg.pool = NULL,
	nperm = 99, printprogress = TRUE, independantTraits = TRUE, 
	type.sp.val = "count")
	
	## S3 method for class 'ComIndexMulti'
plot(x, type = "normal", 
	col.index = c("red", "purple", "olivedrab3"), add.conf = TRUE, 
	color.cond = TRUE, val.quant = c(0.025, 0.975), ...)
		
	## S3 method for class 'ComIndexMulti'
print(x, ...)
		
	## S3 method for class 'ComIndexMulti'
summary(object, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ComIndexMulti_+3A_traits">traits</code></td>
<td>

<p>Individual Matrix of traits with traits in column (or species matrix when using &quot;com&quot; instead of &quot;ind.plot&quot;).
</p>
</td></tr>
<tr><td><code id="ComIndexMulti_+3A_index">index</code></td>
<td>

<p>A vector of functions to apply to traits vectors in the form &quot;mean(x, na.rm = TRUE)&quot; or &quot;range(x)&quot;.
</p>
</td></tr>
<tr><td><code id="ComIndexMulti_+3A_by.factor">by.factor</code></td>
<td>

<p>A factor to split the Matrix of traits and compute index for each subset eg for each site.  
</p>
</td></tr>
<tr><td><code id="ComIndexMulti_+3A_nullmodels">nullmodels</code></td>
<td>

<p>A vector of names corresponding to null models tu use for each index. <strong>local</strong> (or 1) corresponds to a randomization of individual values within a given community. <strong>regional.ind</strong> (or 2) corresponds to randomization of individual values within region, ie within all the dataset. A value of <strong>regional.pop</strong> (or 2sp) corresponds to randomization of population values (each individual value are replaced by the mean value of it population) within region. Finally a value of <strong>regional.pop.prab</strong> (or 2sp.prab)  mirror null model <strong>regional.pop</strong> but without taking indo account species abundance. For example, if nullmodels = c(&quot;local&quot;, &quot;regional.ind&quot;), the first index will be calculated on the null model <strong>local</strong>  and the second index on the null model <strong>regional.ind</strong>.
</p>
<p>If only one value is given, all the the null model will be determined by this value. 
</p>
</td></tr>
<tr><td><code id="ComIndexMulti_+3A_ind.plot">ind.plot</code></td>
<td>

<p>Factor defining the name of the plot (site or community) in which the individual is. 
</p>
</td></tr>
<tr><td><code id="ComIndexMulti_+3A_sp">sp</code></td>
<td>

<p>Factor defining the species which the individual belong to.
</p>
</td></tr>
<tr><td><code id="ComIndexMulti_+3A_com">com</code></td>
<td>

<p>Community data matrix with species (or populations) in rows and sites in column. Use only if ind.plot = NULL. 
&quot;traits&quot; matrix and &quot;com&quot; matrix must have the same number of rows.
</p>
</td></tr>
<tr><td><code id="ComIndexMulti_+3A_se">SE</code></td>
<td>

<p>A single value or vector of standard errors associated with each traits. Especially allow to handle measurement errors. Not used with populational null model.  
</p>
</td></tr>
<tr><td><code id="ComIndexMulti_+3A_namesindex">namesindex</code></td>
<td>

<p>A vector of names for metrics.
</p>
</td></tr>
<tr><td><code id="ComIndexMulti_+3A_reg.pool">reg.pool</code></td>
<td>

<p>Regional pool data for traits. If not informed, traits is considere as the regional pool. This matrix need to be larger (more rows) than the matrix &quot;traits&quot;. Use only for null model 2.
</p>
</td></tr>	
<tr><td><code id="ComIndexMulti_+3A_se.reg.pool">SE.reg.pool</code></td>
<td>

<p>A single value or vector of standard errors associated with each traits in each regional pool. Use only if reg.pool is used. Need to have the same dimension as reg.pool.
</p>
</td></tr>
<tr><td><code id="ComIndexMulti_+3A_nperm">nperm</code></td>
<td>

<p>Number of permutations. If NULL, only observed values are returned.
</p>
</td></tr>
<tr><td><code id="ComIndexMulti_+3A_printprogress">printprogress</code></td>
<td>

<p>Logical value; print progress during the calculation or not.
</p>
</td></tr>
<tr><td><code id="ComIndexMulti_+3A_independanttraits">independantTraits</code></td>
<td>
 
<p>Logical value (default: TRUE). If independantTraits is true (default), each traits is sample independently in null models, if not, each lines of the matrix are randomized, keeping the relation (and trade-off) among traits.
</p>
</td></tr>
<tr><td><code id="ComIndexMulti_+3A_type.sp.val">type.sp.val</code></td>
<td>

<p>Only if ind.plot = NULL. Either &quot;count&quot; or &quot;abundance&quot;. Use abundance when all values in the com matrix are not superior to one.
</p>
</td></tr>
<tr><td><code id="ComIndexMulti_+3A_x">x</code></td>
<td>

<p>An object of class ComIndexMulti.
</p>
</td></tr>
<tr><td><code id="ComIndexMulti_+3A_object">object</code></td>
<td>

<p>An object of class ComIndexMulti.
</p>
</td></tr>
<tr><td><code id="ComIndexMulti_+3A_type">type</code></td>
<td>

<p>Type of plot. Possible type = &quot;simple&quot;, &quot;simple_range&quot;, &quot;normal&quot;, &quot;barplot&quot; and &quot;bytraits&quot;.
</p>
</td></tr>
<tr><td><code id="ComIndexMulti_+3A_col.index">col.index</code></td>
<td>

<p>Vector of colors for index.
</p>
</td></tr>
<tr><td><code id="ComIndexMulti_+3A_add.conf">add.conf</code></td>
<td>

<p>Logical value; Add confidence intervals or not. 
</p>
</td></tr>
<tr><td><code id="ComIndexMulti_+3A_color.cond">color.cond</code></td>
<td>

<p>Logical value; If color.cond = TRUE, color points indicate T-statistics values significatively different from the null model and grey points are not different from null model.
</p>
</td></tr>
<tr><td><code id="ComIndexMulti_+3A_val.quant">val.quant</code></td>
<td>

<p>Numeric vectors of length 2, giving the quantile to calculate confidence interval. By default val.quant = c(0.025,0.975) for a bilateral test with alpha = 5%.
</p>
</td></tr>
<tr><td><code id="ComIndexMulti_+3A_...">...</code></td>
<td>

<p>Any additional arguments are passed to the plot, print or summary function creating the core of the plot and can be used to adjust the look of resulting graph. See <code><a href="#topic+plot.listofindex">plot.listofindex</a></code> for more arguments.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function implement four null models which keep unchanged the number of individual per community.
Model <strong>local</strong> (1) corresponds to randomization of individual values within community.
Model <strong>regional.ind</strong> (2) corresponds to randomization of individual values within region.
Model <strong>regional.pop</strong> (2sp) corresponds to randomization of population values within region.
Model <strong>regional.pop.prab</strong> (2sp.prab) corresponds to randomization of population values within region but whitout taking into account for abundance.
</p>
<p>S3 method plot for class listofindex:
</p>
<p>-Normal type plot means, standard deviations, ranges and confidence intervals of T-statistics.
</p>
<p>-Simple_range type plot means, standard deviations and range of T-statistics
</p>
<p>-Simple type plot T-statistics for each site and traits and the mean confidence intervals by traits
</p>
<p>-Barplot type plot means, standard deviations and confidence intervals of T-statistics in a barplot fashion
</p>
<p>-Bysites type plot each metrics for each sites
</p>
<p>-Bytraits type plot each metrics for each traits
</p>


<h3>Value</h3>

<p>A list of lists:
</p>
<table>
<tr><td><code>$obs</code></td>
<td>
<p>List of observed values for each trait in each community. Each component of the list correspond to a matrix containing the result for each custom function.</p>
</td></tr>
<tr><td><code>$null</code></td>
<td>
<p>List of null values for each trait in each community. Each component of the list correspond to an array containing the result of the permutations for each custom function.</p>
</td></tr>
<tr><td><code>$sites_richness</code></td>
<td>
<p>Number of species per site.</p>
</td></tr>
<tr><td><code>$namestraits</code></td>
<td>
<p>Names of traits.</p>
</td></tr>
<tr><td><code>$traits</code></td>
<td>
<p>traits data</p>
</td></tr>
<tr><td><code>$ind.plot</code></td>
<td>
<p>name of the plot in which the individual is</p>
</td></tr>
<tr><td><code>$sp</code></td>
<td>
<p>groups (e.g. species) which the individual belong to</p>
</td></tr>
<tr><td><code>$nullmodels</code></td>
<td>
<p>List of null models used for each indices.</p>
</td></tr>
<tr><td><code>$call</code></td>
<td>
<p>call of the function Tstats</p>
</td></tr>
<tr><td><code>$list.index</code></td>
<td>
<p>List of index values and associate null models. Internal use in other function. Traits in columns.</p>
</td></tr>
<tr><td><code>$list.index.t</code></td>
<td>
<p>List of index values and associate null models. Internal use in other function. Traits in rows.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Adrien Taudiere
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ComIndex">ComIndex</a></code>;
<code><a href="#topic+plot.listofindex">plot.listofindex</a></code>;
<code><a href="#topic+ses">ses</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(finch.ind)

## Not run: 
#For most multivariate functions we need to replace (or exclude) NA values. 
#For this example, we use the package mice to complete the data.

comm&lt;-t(table(ind.plot.finch,1:length(ind.plot.finch)))

library(mice)
traits = traits.finch
mice&lt;-mice(traits.finch)
traits.finch.mice&lt;-complete(mice)


#A simple example to illustrate the concept of the function ComIndexMulti

n_sp_plot&lt;-as.factor(paste(sp.finch, ind.plot.finch, sep = "_")) 
res.sum.1&lt;-ComIndexMulti(traits.finch, 
              index = c("sum(scale(x), na.rm = T)", "sum(x, na.rm = T)"), 
              by.factor = n_sp_plot, nullmodels = "regional.ind", 
              ind.plot = ind.plot.finch, nperm = 9, sp = sp.finch)
res.sum.1



#A more interesting example using the function hypervolume
library(hypervolume)

hv&lt;-hypervolume(traits.finch.mice, 
        reps = 100,bandwidth = 0.2, 
        verbose = F, warnings = F)
plot(hv)

hv.1&lt;-ComIndexMulti(traits.finch.mice, 
             index = c("as.numeric(try(hypervolume(na.omit(x), reps = 100, 
                 bandwidth = 0.2, verbose = F, warnings = F)@Volume))"),
             by.factor = rep(1,length(n_sp_plot)), nullmodels = "regional.ind",
             ind.plot = ind.plot.finch, nperm = 9, sp = sp.finch) 

hv.1


## End(Not run)
</code></pre>

<hr>
<h2 id='decompCTRE'>
Variance partitioning for multiple traits
</h2><span id='topic+decompCTRE'></span><span id='topic+barplot.decompCTRE'></span>

<h3>Description</h3>

<p>This function decomposes the variation in community trait composition into three sources: (i) the intraspecific trait variability, (ii) the
variability due to species turnover and (iii) their covariation is also separated. This decomposition is computed for the whole variation in the trait
values and, The formula specified, across the contribution of various explanatory variables considered in the model. Barplot.decompCTRE allow to plot the result of the decomposition.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	decompCTRE(traits = NULL, formula = ~1, ind.plot = NULL, sp = NULL, 
	printprogress = TRUE, ...)
	
	## S3 method for class 'decompCTRE'
barplot(height, resume = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="decompCTRE_+3A_traits">traits</code></td>
<td>

<p>Matrix of traits with traits in column
</p>
</td></tr>
<tr><td><code id="decompCTRE_+3A_height">height</code></td>
<td>

<p>An object of class decompCTRE obtain by the function decompCTRE.
</p>
</td></tr>
<tr><td><code id="decompCTRE_+3A_formula">formula</code></td>
<td>

<p>The formula parameter must be a one-sided formula, i.e. starting with a tilde (~) character. The response variable is specified by the next two arguments, specif.avg and const.avg. By default set to ~1.		
</p>
</td></tr>
<tr><td><code id="decompCTRE_+3A_ind.plot">ind.plot</code></td>
<td>

<p>Factor defining the name of the plot (site or community) in which the individual is. 
</p>
</td></tr>
<tr><td><code id="decompCTRE_+3A_sp">sp</code></td>
<td>

<p>Factor defining the species which the individual belong to.
</p>
</td></tr>
<tr><td><code id="decompCTRE_+3A_printprogress">printprogress</code></td>
<td>

<p>Logical value; print progress during the calculation or not.
</p>
</td></tr>
<tr><td><code id="decompCTRE_+3A_resume">resume</code></td>
<td>

<p>Logical. If resume = FALSE, plot one graphic by traits.
</p>
</td></tr>
<tr><td><code id="decompCTRE_+3A_...">...</code></td>
<td>

<p>Optional additional arguments
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &quot;decompCTRE&quot;.
</p>


<h3>Author(s)</h3>

<p>Adrien Taudiere
Jan Leps
</p>


<h3>References</h3>

<p>Leps, Jan, Francesco de Bello, Petr Smilauer and Jiri Dolezal. 2011. Community trait response to environment: disentangling species turnover vs intraspecific trait variability effects. Ecography 34 (5): 856-863.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+barplot.decompCTRE">barplot.decompCTRE</a></code>;
<code><a href="#topic+traitflex.anova">traitflex.anova</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(finch.ind)
## Not run: 
  res.decomp &lt;- decompCTRE(traits = traits.finch, sp = sp.finch, 
  ind.plot = ind.plot.finch, print = FALSE)

  barplot.decompCTRE(res.decomp)

  par(mfrow = c(2,2))
  barplot.decompCTRE(res.decomp, resume = FALSE)
  par(mfrow = c(1,1))
  
## End(Not run)
</code></pre>

<hr>
<h2 id='finch.ind'>
Finch morphological data
</h2><span id='topic+finch.ind'></span><span id='topic+ind.plot.finch'></span><span id='topic+sp.finch'></span><span id='topic+traits.finch'></span><span id='topic+.Random.seed'></span>

<h3>Description</h3>

<p>Individual morphological data for Darwin&quot;s finches. finch is the all data.frame. ind.plot.finch and sp.finch respectively correspond to the Ilsland and the species attribute of each individual. traits.finch is the matrix of traits with four traits in rows and 2677 individuals in columns. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	data(finch.ind)
</code></pre>


<h3>Format</h3>

<p>A data.frame of 2677 individuals in rows and 14 columns.</p>


<h3>Details</h3>

<p>See http://bioquest.org/birdd/morph.php for more information on database.
</p>


<h3>Source</h3>

<p>http://bioquest.org/birdd/morph.php</p>


<h3>Examples</h3>

<pre><code class='language-R'>	data(finch.ind)
</code></pre>

<hr>
<h2 id='Fred'>
Functional richness, evenness and divergence following Villeger et al. 2008
</h2><span id='topic+Fred'></span>

<h3>Description</h3>

<p>Compute the 3 functional diversity indices (multi-traits) presented in Villeger et al. 2008 (Ecology 89 2290-2301): Functional richness (FRic), Functional evenness (FEve), Functional divergence (FDiv) 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	Fred(traits, ind.plot)  
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Fred_+3A_traits">traits</code></td>
<td>

<p>Individual Matrix of traits with traits in columns. NA are not allowed .
</p>
</td></tr>
<tr><td><code id="Fred_+3A_ind.plot">ind.plot</code></td>
<td>

<p>Factor defining the name of the plot in which the individual is.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For each trait, values are standardized (mean=0 and standard deviation=1)
For FRic computation, number of individuals must be higher than number of traits
</p>


<h3>Value</h3>

<p>list of 4 vectors with values of indices in each sites
</p>
<table>
<tr><td><code>$nbind</code></td>
<td>
<p>number of individuals</p>
</td></tr>
<tr><td><code>$FRic</code></td>
<td>
<p>functional richness index</p>
</td></tr>
<tr><td><code>$FEve</code></td>
<td>
<p>functional evenness index</p>
</td></tr>
<tr><td><code>$FDiv</code></td>
<td>
<p>functional divergence index</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sebastien Villeger sligthy modified by Adrien Taudiere
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ComIndexMulti">ComIndexMulti</a></code>
<code><a href="#topic+ComIndex">ComIndex</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(finch.ind)
## Not run: 
#For most multivariate functions we need to replace (or exclude) NA values. 
#For this example, we use the package mice to complete the data.

comm&lt;-t(table(ind.plot.finch,1:length(ind.plot.finch)))

library(mice)
traits = traits.finch
mice&lt;-mice(traits.finch)
traits.finch.mice&lt;-complete(mice)
fred&lt;-Fred(traits.finch.mice, ind.plot.finch)

## End(Not run)
</code></pre>

<hr>
<h2 id='IndexByGroups'>
Apply metrics to groups.
</h2><span id='topic+IndexByGroups'></span>

<h3>Description</h3>

<p>Transforme a list of metrics to apply them to groups, typically to populations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	IndexByGroups(metrics, groups)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="IndexByGroups_+3A_metrics">metrics</code></td>
<td>

<p>A vector of metrics like the argument &quot;index&quot; of function ComIndex 
</p>
</td></tr>
<tr><td><code id="IndexByGroups_+3A_groups">groups</code></td>
<td>

<p>Name of the factor to apply the metrics to groups in the form &quot;pop&quot;, e.g. population
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of transformed metrics
</p>


<h3>Author(s)</h3>

<p>Adrien Taudiere
</p>

<hr>
<h2 id='MinMaxMST'>
Ratio of the shortest distance to the longest distance in a minimum spanning tree
</h2><span id='topic+MinMaxMST'></span>

<h3>Description</h3>

<p>Ratio of the shortest distance to the longest distance in a minimum spanning tree.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	MinMaxMST(traits, gower.dist = TRUE, scale.tr = TRUE, method.dist = "euclidian")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MinMaxMST_+3A_traits">traits</code></td>
<td>

<p>Traits matrix (traits in column)
</p>
</td></tr>
<tr><td><code id="MinMaxMST_+3A_gower.dist">gower.dist</code></td>
<td>

<p>Calculate gower distance using the function gowdis from package FD.
</p>
</td></tr>	
<tr><td><code id="MinMaxMST_+3A_scale.tr">scale.tr</code></td>
<td>

<p>Does traits need to be scale before multi-traits metric calculation? Only use when gower.dist = FALSE. Default is yes.
</p>
</td></tr>
<tr><td><code id="MinMaxMST_+3A_method.dist">method.dist</code></td>
<td>

<p>Method to calculate the distance in case of multi-traits metric (function dist). Only use when gower.dist = FALSE. Default is euclidian.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The value of the ratio of the shortest distance to the longest distance in a minimum spanning tree.
</p>


<h3>Author(s)</h3>

<p>Aiba et al., 2013 modified by Adrien Taudiere
</p>


<h3>References</h3>

<p>Stubbs, WJ., and Wilson, JB. 2004. Evidence for limiting similarity in a sand dune community. Journal of Ecology 92: 557-567.
Aiba, M., Katabuchi, M., Takafumi, H., Matsuzaki, S.S., Sasaki, T. &amp; Hiura, T. 2013. Robustness of trait distribution metrics for community assembly studies under the uncertainties of assembly processes. Ecology, 94, 2873-2885.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

	data(finch.ind)
	
	MinMaxMST(traits.finch[1:10,])
	MinMaxMST(traits.finch[1:10,], gower.dist = FALSE)
	MinMaxMST(traits.finch[1:10,], gower.dist = FALSE, scale.tr = FALSE)

## End(Not run)

</code></pre>

<hr>
<h2 id='Neigbourhood+20distance+20metrics'>
Coefficient of variation, mean, minimum and standard deviation of the nearest neigbourhood distance.
</h2><span id='topic+CVNND'></span><span id='topic+MNND'></span><span id='topic+MinNND'></span><span id='topic+SDNND'></span><span id='topic+SDND'></span><span id='topic+MND'></span>

<h3>Description</h3>

<p>CVNND : Coefficient of variation of the nearest neigbourhood distance
</p>
<p>MNND : Mean of the nearest neigbourhood distance
</p>
<p>MinNND : Minimum of the nearest neigbourhood distance	
</p>
<p>SDNND : Standard deviation of the nearest neigbourhood distance
</p>
<p>SDND : Standard deviation of the neigbourhood distance
</p>
<p>MND : Mean of the neigbourhood distance
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	CVNND(traits, div_range =  FALSE, na.rm = FALSE, scale.tr = TRUE,
	method.dist = "euclidian")
	
	MNND(traits, div_range =  FALSE, na.rm = FALSE, scale.tr = TRUE, 
	method.dist = "euclidian")
	
	MinNND(traits, div_range =  FALSE, na.rm = FALSE, scale.tr = TRUE, 
	method.dist = "euclidian")
	
	SDNND(traits, div_range =  FALSE, na.rm = FALSE, scale.tr = TRUE, 
	method.dist = "euclidian")
	
	SDND(trait, div_range = FALSE, na.rm = FALSE)	
	
	MND(trait, div_range = FALSE, na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Neigbourhood+2B20distance+2B20metrics_+3A_traits">traits</code></td>
<td>

<p>Trait vector (uni-trait metric) or traits matrix (Multi-traits metric), traits in column.
</p>
</td></tr>
<tr><td><code id="Neigbourhood+2B20distance+2B20metrics_+3A_trait">trait</code></td>
<td>

<p>Trait vector
</p>
</td></tr>	
<tr><td><code id="Neigbourhood+2B20distance+2B20metrics_+3A_div_range">div_range</code></td>
<td>

<p>Does metric need to be divided by the range? Default is no.
</p>
</td></tr>
<tr><td><code id="Neigbourhood+2B20distance+2B20metrics_+3A_na.rm">na.rm</code></td>
<td>

<p>If div_range=TRUE, a logical value indicating whether NA values should be stripped before the computation proceeds.
</p>
</td></tr>
<tr><td><code id="Neigbourhood+2B20distance+2B20metrics_+3A_scale.tr">scale.tr</code></td>
<td>

<p>Does traits need to be scale before multi-traits metric calculation? Default is yes.
</p>
</td></tr>
<tr><td><code id="Neigbourhood+2B20distance+2B20metrics_+3A_method.dist">method.dist</code></td>
<td>

<p>Method to calculate the distance in case of multi-traits metric (function dist). Default is euclidian.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>One value corresponding to the metric value.
</p>


<h3>Author(s)</h3>

<p>Adrien Taudiere
</p>


<h3>References</h3>

<p>Aiba, M., Katabuchi, M., Takafumi, H., Matsuzaki, S.S., Sasaki, T. &amp; Hiura, T. 2013. Robustness of trait distribution metrics for community assembly studies under the uncertainties of assembly processes. Ecology, 94, 2873-2885.
Jung, Vincent, Cyrille Violle, Cedric Mondy, Lucien Hoffmann, et Serge Muller. 2010. Intraspecific variability and trait-based community assembly: Intraspecific variability and community assembly. Journal of Ecology 98 (5): 1134-1140.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(finch.ind)

CVNND(traits.finch[,1], na.rm = TRUE)
CVNND(traits.finch[,1], div_range =  TRUE, na.rm = TRUE)
CVNND(traits.finch, na.rm = TRUE)
CVNND(traits.finch, scale.tr = FALSE, na.rm = TRUE)
SDND(traits.finch[,1], na.rm = TRUE)

</code></pre>

<hr>
<h2 id='partvar'>
Variance partitioning accross nested scales
</h2><span id='topic+partvar'></span><span id='topic+barPartvar'></span><span id='topic+piePartvar'></span>

<h3>Description</h3>

<p>Variance partitioning accross nested scales using a decomposition (varcomp function) of variance on restricted maximum likelihood (REML) method (lme function). See Messier et al. 2010 for more information. barPartvar and piePartvar are associated plotting functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	partvar(traits, factors, printprogress = TRUE)
	barPartvar(partvar, col.bar = NA, ...)
	piePartvar(partvar, col.pie = NA, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="partvar_+3A_traits">traits</code></td>
<td>

<p>Matrix of traits with traits in column
</p>
</td></tr>
<tr><td><code id="partvar_+3A_factors">factors</code></td>
<td>

<p>A matrix of factors with the first column corresponds to the higher level factor, the second row the second higher level factor and so on.  
</p>
</td></tr>
<tr><td><code id="partvar_+3A_printprogress">printprogress</code></td>
<td>

<p>Logical value; print progress during the calculation or not.
</p>
</td></tr>
<tr><td><code id="partvar_+3A_partvar">partvar</code></td>
<td>

<p>The result of the partvar function.
</p>
</td></tr>
<tr><td><code id="partvar_+3A_col.bar">col.bar</code></td>
<td>

<p>Vector of colors of bars 
</p>
</td></tr>
<tr><td><code id="partvar_+3A_...">...</code></td>
<td>

<p>Any additional arguments are passed to the pie function.
</p>
</td></tr>
<tr><td><code id="partvar_+3A_col.pie">col.pie</code></td>
<td>

<p>Vector of color for pie.
</p>
</td></tr>	
</table>


<h3>Value</h3>

<p>An object of class &quot;partvar&quot; corresponding to a matrix of variance values with traits in rows and nested factors in column.
</p>


<h3>Author(s)</h3>

<p>Adrien Taudiere
Julie Messier
</p>


<h3>References</h3>

<p>Messier, Julie, Brian J. McGill, et Martin J. Lechowicz. 2010. How do traits vary across ecological scales? A case for trait-based ecology: How do traits vary across ecological scales? Ecology Letters 13(7): 838-848. doi:10.1111/j.1461-0248.2010.01476.x.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+piePartvar">piePartvar</a></code>;
<code><a href="#topic+barPartvar">barPartvar</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
	data(finch.ind)
	## Not run: 
	cond&lt;-seq(1,length(sp.finch)*2, by = 2)
	genus &lt;- as.vector(unlist(strsplit(as.vector(sp.finch),"_"))[cond])

	res.partvar.finch &lt;- partvar(traits = traits.finch, 
	factors = cbind(sites = as.factor(as.vector(ind.plot.finch)), 
	species = as.factor(as.vector(sp.finch)), genus = as.factor(genus)))
	
	res.partvar.finch
	
	oldpar&lt;-par()
	par(mfrow = c(2,2), mai = c(0.2,0.2,0.2,0.2))
	piePartvar(res.partvar.finch)
	par(oldpar)
	
	barPartvar(res.partvar.finch)
	
## End(Not run)
</code></pre>

<hr>
<h2 id='plot.listofindex'>
Plot community assembly index
</h2><span id='topic+plot.listofindex'></span>

<h3>Description</h3>

<p>Plot community assembly index and confidence intervals using a list of index. S3 method for class listofindex.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	## S3 method for class 'listofindex'
plot(x, type = "normal", 
	col.index = c("red", "purple", "olivedrab3"), add.conf = TRUE, 
	color.cond = TRUE, val.quant = c(0.025, 0.975), 
	grid.v = TRUE, grid.h = TRUE, xlim = NULL, ylim = NULL, 
	cex.text = 0.8, plot.ask = FALSE, srt.text = 90, alpha = 0.4, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.listofindex_+3A_x">x</code></td>
<td>

<p>A list of index and related null models obtained from to the as.listofindex function.
</p>
</td></tr>
<tr><td><code id="plot.listofindex_+3A_type">type</code></td>
<td>

<p>Type of plot. Possible type = &quot;simple&quot;, &quot;simple_range&quot;, &quot;normal&quot;, &quot;barplot&quot; and &quot;bytraits&quot;.
</p>
</td></tr>
<tr><td><code id="plot.listofindex_+3A_col.index">col.index</code></td>
<td>

<p>Vector of colors for index.
</p>
</td></tr>
<tr><td><code id="plot.listofindex_+3A_add.conf">add.conf</code></td>
<td>

<p>Logical value; Add confidence intervals or not. 
</p>
</td></tr>
<tr><td><code id="plot.listofindex_+3A_color.cond">color.cond</code></td>
<td>

<p>Logical value; If color.cond = TRUE, color points indicate T-statistics values significatively different from the null model and grey points are not different from null model.
</p>
</td></tr>
<tr><td><code id="plot.listofindex_+3A_val.quant">val.quant</code></td>
<td>

<p>Numeric vectors of length 2, giving the quantile to calculate confidence interval. By default val.quant = c(0.025,0.975) for a bilateral test with alpha = 5%.
</p>
</td></tr>
<tr><td><code id="plot.listofindex_+3A_grid.v">grid.v</code></td>
<td>

<p>Logical value; print vertical grid or not
</p>
</td></tr>
<tr><td><code id="plot.listofindex_+3A_grid.h">grid.h</code></td>
<td>

<p>Logical value; print horizontal grid or not
</p>
</td></tr>
<tr><td><code id="plot.listofindex_+3A_xlim">xlim</code></td>
<td>

<p>Numeric vectors of length 2, giving the x coordinates range 
</p>
</td></tr>
<tr><td><code id="plot.listofindex_+3A_ylim">ylim</code></td>
<td>

<p>Numeric vectors of length 2, giving the y coordinates range 
</p>
</td></tr>
<tr><td><code id="plot.listofindex_+3A_cex.text">cex.text</code></td>
<td>

<p>Numeric value; the magnification to be used for text relative to the current setting of cex
</p>
</td></tr>
<tr><td><code id="plot.listofindex_+3A_plot.ask">plot.ask</code></td>
<td>

<p>Logical value; ask for plotting the next plot or not.
</p>
</td></tr>
<tr><td><code id="plot.listofindex_+3A_srt.text">srt.text</code></td>
<td>

<p>Degree of rotation for text.
</p>
</td></tr>
<tr><td><code id="plot.listofindex_+3A_alpha">alpha</code></td>
<td>

<p>Degree of transparency for null models aera.
</p>
</td></tr>
<tr><td><code id="plot.listofindex_+3A_...">...</code></td>
<td>

<p>Any additional arguments are passed to the plot function creating the core of the plot and can be used to adjust the look of resulting graph.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>S3 method plot for class listofindex:
-Normal type plot means, standard deviations, ranges and confidence intervals of T-statistics.
-Simple_range type plot means, standard deviations and range of T-statistics
-Simple type plot T-statistics for each site and traits and the mean confidence intervals by traits
-Barplot type plot means, standard deviations and confidence intervals of T-statistics in a barplot fashion
-Bysites type plot each metrics for each sites
-Bytraits type plot each metrics for each traits
</p>


<h3>Value</h3>

<p>None; used for the side-effect of producing a plot.
</p>


<h3>Author(s)</h3>

<p>Adrien Taudiere
</p>


<h3>See Also</h3>

<p><code><a href="#topic+as.listofindex">as.listofindex</a></code>;
<code><a href="#topic+plot.Tstats">plot.Tstats</a></code>;
<code><a href="#topic+ses.listofindex">ses.listofindex</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>	
	data(finch.ind)

	res.finch &lt;- Tstats(traits.finch, ind.plot = ind.plot.finch, 
	sp = sp.finch, nperm = 9, print = FALSE)

	## Not run: 
		#### Use a different regional pool than the binding of studied communities
		#create a random regional pool for the example
	
		reg.p &lt;- rbind(traits.finch, traits.finch[sample(1:2000,300), ])
	
		res.finch2 &lt;- Tstats(traits.finch, ind.plot = ind.plot.finch, 
	    sp = sp.finch, reg.pool=reg.p, nperm = 9, print = FALSE)	
	    
	    plot(as.listofindex(list(res.finch,res.finch2)))
    
    
	    #### Use a different regional pool for each communities
		#create a random regional pool for each communities for the example
		list.reg.p &lt;- list(
		traits.finch[sample(1:290,200), ], traits.finch[sample(100:1200,300), ], 
		traits.finch[sample(100:1500, 1000), ], traits.finch[sample(300:800,300), ],
		traits.finch[sample(1000:2000, 500), ], traits.finch[sample(100:900, 700), ] )

		# Warning: the regional pool need to be larger than the observed communities
		table(ind.plot.finch)
		# For exemple, the third community need a regional pool of more than 981 individuals
		
		res.finch3 &lt;- Tstats(traits.finch, ind.plot = ind.plot.finch, 
	    sp = sp.finch, reg.pool=list.reg.p, nperm = 9, print = FALSE)	
	    
	    plot(as.listofindex(list(res.finch, res.finch2, res.finch3)))	
	
## End(Not run)
</code></pre>

<hr>
<h2 id='plotCorTstats'>
Plot the bivariate relationships between T-statistics
</h2><span id='topic+plotCorTstats'></span>

<h3>Description</h3>

<p>Plot the bivariate relationships between the three T-statistics namely T_IP.IC, T_IC.IR and T_PC.PR.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	plotCorTstats(tstats = NULL, val.quant = c(0.025, 0.975), 
	add.text =  FALSE, bysite =  FALSE, col.obj = NULL, plot.ask = TRUE, 
	multipanel = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotCorTstats_+3A_tstats">tstats</code></td>
<td>

<p>The list resulting from the function Tstats.
</p>
</td></tr>
<tr><td><code id="plotCorTstats_+3A_val.quant">val.quant</code></td>
<td>
		
<p>Numeric vector of length 2, giving the quantile to calculate confidence interval. By default val.quant = c(0.025,0.975) for a bilateral test with alpha = 5%.
</p>
</td></tr>
<tr><td><code id="plotCorTstats_+3A_add.text">add.text</code></td>
<td>

<p>Logical value; Add text or not.
</p>
</td></tr>
<tr><td><code id="plotCorTstats_+3A_bysite">bysite</code></td>
<td>

<p>Logical value; plot per site or by traits. 
</p>
</td></tr>
<tr><td><code id="plotCorTstats_+3A_col.obj">col.obj</code></td>
<td>

<p>Vector of colors for object (either traits or sites).
</p>
</td></tr>
<tr><td><code id="plotCorTstats_+3A_plot.ask">plot.ask</code></td>
<td>

<p>Logical value; Ask for new plot or not.
</p>
</td></tr>
<tr><td><code id="plotCorTstats_+3A_multipanel">multipanel</code></td>
<td>

<p>Logical value. If TRUE divides the device to shown several traits graphics in the same device. 
</p>
</td></tr>
<tr><td><code id="plotCorTstats_+3A_...">...</code></td>
<td>

<p>Any additional arguments are passed to the plot function creating the core of the plot and can be used to adjust the look of resulting graph.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None; used for the side-effect of producing a plot.
</p>


<h3>Author(s)</h3>

<p>Adrien Taudiere
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Tstats">Tstats</a></code>;
<code><a href="#topic+plot.Tstats">plot.Tstats</a></code>;
<code><a href="#topic+plotSESvar">plotSESvar</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>	data(finch.ind)
	res.finch &lt;- Tstats(traits.finch, ind.plot = ind.plot.finch, 
	sp = sp.finch, nperm = 9)
	
	## Not run: 
		plotCorTstats(res.finch, bysite = FALSE)
		plotCorTstats(res.finch, bysite = TRUE)
	
## End(Not run)
</code></pre>

<hr>
<h2 id='plotDistri'>
Plot function to represent density of trait values
</h2><span id='topic+plotDistri'></span>

<h3>Description</h3>

<p>Plot function to represent density of trait values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	plotDistri(traits = NULL, var.1 = NULL, var.2 = NULL, col.dens = NULL, 
	plot.ask = TRUE, ylim.cex = 1, cex.leg = 0.8, polyg = TRUE, 
	multipanel = TRUE, leg = TRUE, xlim = NULL, ylim = NULL, 
	main = "default", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotDistri_+3A_traits">traits</code></td>
<td>

<p>Matrix of traits with traits in column.
</p>
</td></tr>
<tr><td><code id="plotDistri_+3A_var.1">var.1</code></td>
<td>

<p>The first variable defines the division of each plots, in most case either a vector of species or name of sites.
</p>
</td></tr>
<tr><td><code id="plotDistri_+3A_var.2">var.2</code></td>
<td>

<p>The second variable define the division by color, in most case either a vector of species or name of sites.
</p>
</td></tr>
<tr><td><code id="plotDistri_+3A_col.dens">col.dens</code></td>
<td>

<p>A vector of colors for the second variable.
</p>
</td></tr>
<tr><td><code id="plotDistri_+3A_plot.ask">plot.ask</code></td>
<td>

<p>Logical value; ask for plotting the next plot or not.
</p>
</td></tr>
<tr><td><code id="plotDistri_+3A_ylim.cex">ylim.cex</code></td>
<td>

<p>Numeric value; the magnification to be used for range of y axe
</p>
</td></tr>
<tr><td><code id="plotDistri_+3A_cex.leg">cex.leg</code></td>
<td>

<p>Numeric value; the magnification to be used for legend relative to the current setting of cex
</p>
</td></tr>
<tr><td><code id="plotDistri_+3A_polyg">polyg</code></td>
<td>

<p>Logical value; do the mean distribution is full or empty
</p>
</td></tr>
<tr><td><code id="plotDistri_+3A_multipanel">multipanel</code></td>
<td>

<p>Logical value. If TRUE divides the device to shown several traits graphics in the same device. 
</p>
</td></tr>
<tr><td><code id="plotDistri_+3A_leg">leg</code></td>
<td>

<p>Logical value; if TRUE print the legend.
</p>
</td></tr>
<tr><td><code id="plotDistri_+3A_ylim">ylim</code></td>
<td>

<p>Numeric vectors of length 2, giving the y coordinates range 
</p>
</td></tr>
<tr><td><code id="plotDistri_+3A_xlim">xlim</code></td>
<td>

<p>Numeric vectors of length 2, giving the y coordinates range 
</p>
</td></tr>
<tr><td><code id="plotDistri_+3A_main">main</code></td>
<td>

<p>Title for the plot. Default set automatic title using informations in the input dataset.
</p>
</td></tr>
<tr><td><code id="plotDistri_+3A_...">...</code></td>
<td>

<p>Any additional arguments are passed to the plot function creating the core of the plot and can be used to adjust the look of resulting graph.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None; used for the side-effect of producing a plot.
</p>


<h3>Author(s)</h3>

<p>Adrien Taudiere
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plotSpPop">plotSpPop</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>	
data(finch.ind)

## Not run: 
	#Plot the distribution of trait values for populations, 
	#species, sites and regional scales. 
	
	### First, let try the distribution for all populations 
	#of Darwin finches.
	
	par(mfrow = c(4,4), cex = 0.5)
	plotDistri(traits.finch, sp.finch, ind.plot.finch, ylim.cex = 3, 
	plot.ask = FALSE, multipanel = FALSE, leg = FALSE)
	
	### Then we can inverse the second and the third arguments 
	#to plot the distribution for all finches species. 
	
	par(mfrow = c(4,4), cex = 0.5)
	plotDistri(traits.finch, ind.plot.finch, sp.finch, ylim.cex = 8, 
	plot.ask = FALSE, multipanel = FALSE, leg = FALSE)
	
	### Only one trait to plot using leg = TRUE to plot the legend

	par(mfrow=c(2,3))
	plotDistri(as.matrix(traits.finch[,1]), ind.plot.finch, sp.finch, 
    ylim.cex=8, plot.ask = FALSE, multipanel = FALSE, leg = TRUE, cex.leg=0.5)

	### You can also plot trait distribution for all species in the region
	
	par(mfrow = c(1,1), cex = 1)
	plotDistri(traits.finch, rep("region", times = dim(traits.finch)[1]), 
	sp.finch, ylim.cex = 6, plot.ask = FALSE, leg = FALSE)
	
	### You can also plot trait distribution for all sites
	#without taking into account species identity

	plotDistri(traits.finch, rep("toutes_sp", times = dim(traits.finch)[1]), 
	ind.plot.finch, ylim.cex = 3, plot.ask = FALSE)


## End(Not run)
	
</code></pre>

<hr>
<h2 id='plotRandtest'>
Plot result of observed indices values against null distribution
</h2><span id='topic+plotRandtest'></span>

<h3>Description</h3>

<p>Function to plot result of observed indices values against null distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	plotRandtest(x, alternative = "two-sided", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotRandtest_+3A_x">x</code></td>
<td>

<p>An object of class listofindex, ComIndex, ComIndexMulti or Tstats.
</p>
</td></tr>
<tr><td><code id="plotRandtest_+3A_alternative">alternative</code></td>
<td>

<p>Indicates the alternative hypothesis and must be one of &quot;two.sided&quot;, &quot;greater&quot; or &quot;less&quot;. You can specify just the initial letter. &quot;greater&quot; corresponds to positive association, &quot;less&quot; to negative association.
</p>
</td></tr>
<tr><td><code id="plotRandtest_+3A_...">...</code></td>
<td>

<p>Any additional arguments are passed to the plot function creating the core of the plot and can be used to adjust the look of resulting graph.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None; used for the side-effect of producing a plot.
</p>


<h3>Author(s)</h3>

<p>Adrien Taudiere
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ComIndex">ComIndex</a></code>;
<code><a href="#topic+ComIndexMulti">ComIndexMulti</a></code>;
<code><a href="#topic+Tstats">Tstats</a></code>;
<code><a href="#topic+as.listofindex">as.listofindex</a></code>;
<code><a href="#topic+plot.listofindex">plot.listofindex</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>	data(finch.ind)
	## Not run: 
		res.finch &lt;- Tstats(traits.finch, ind.plot = ind.plot.finch, 
		sp = sp.finch, nperm = 99, print = FALSE)
	
	par(mfrow = c(4,4))
	
	plotRandtest(res.finch)
	plotRandtest(res.finch, alter = "less")
	
## End(Not run)
</code></pre>

<hr>
<h2 id='plotSESvar'>
Plot SES values against a variable
</h2><span id='topic+plotSESvar'></span>

<h3>Description</h3>

<p>Plot standardized effect size values against a variable
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	plotSESvar(index.list, variable = NULL, ylab = "variable", 
	color.traits = NULL, val.quant = c(0.025, 0.975), resume = FALSE, 
	multipanel = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotSESvar_+3A_index.list">index.list</code></td>
<td>

<p>A list of index and the associate null models in the forme: list( index_1 = index_1_observed, index_1_nm = null.model.index_1 ,index_2 = index_2_observed, index_2_nm = null.model.index_2, ...). 
</p>
</td></tr>
<tr><td><code id="plotSESvar_+3A_variable">variable</code></td>
<td>

<p>The variable against standardized effect sizes are plotted.
</p>
</td></tr>
<tr><td><code id="plotSESvar_+3A_ylab">ylab</code></td>
<td>

<p>Label for the variable.
</p>
</td></tr>
<tr><td><code id="plotSESvar_+3A_color.traits">color.traits</code></td>
<td>

<p>A vector of colors corresponding to traits.
</p>
</td></tr>
<tr><td><code id="plotSESvar_+3A_val.quant">val.quant</code></td>
<td>

<p>Numeric vectors of length 2, giving the quantile to calculation confidence interval. By default val.quant = c(0.025,0.975) for a bilateral test with alpha = 5%.
</p>
</td></tr>
<tr><td><code id="plotSESvar_+3A_resume">resume</code></td>
<td>

<p>Logical value; resume = FALSE by default; Simplify the plot by plotting the mean and standard error for index value of multiple traits
</p>
</td></tr>
<tr><td><code id="plotSESvar_+3A_multipanel">multipanel</code></td>
<td>

<p>Logical value. If TRUE divides the device to shown several traits graphics in the same device. 
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None; used for the side-effect of producing a plot.
</p>


<h3>Author(s)</h3>

<p>Adrien Taudiere
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.listofindex">plot.listofindex</a></code>;
<code><a href="#topic+ses">ses</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>	data(finch.ind)
	res.finch &lt;- Tstats(traits.finch, ind.plot = ind.plot.finch, sp = sp.finch, 
	nperm = 9)
## Not run: 
	par(mfrow = c(2,2))
	species.richness &lt;- table(ind.plot.finch)
	plotSESvar(as.listofindex(list(res.finch)), species.richness, 
	multipanel = FALSE)

	#Same plot with resume = TRUE.
	
	par(mfrow = c(2,2))
	plotSESvar(as.listofindex(list(res.finch)), species.richness, 
	resume = TRUE, multipanel = FALSE)
	par(mfrow = c(1,1))
	
## End(Not run)
</code></pre>

<hr>
<h2 id='plotSpPop'>
Plot populations values against species values
</h2><span id='topic+plotSpPop'></span>

<h3>Description</h3>

<p>Plot populations values against species values. The objectif is to see the contribution of intra-specific vs inter-specific variation to trait gradient.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	plotSpPop(traits = NULL, ind.plot = NULL, sp = NULL, 
	col.ind = rgb(0.5, 0.5, 0.5, 0.5), col.pop = NULL, col.sp = NULL, 
	col.site = NULL, resume =  FALSE, p.val = 0.05, min.ind.signif = 10, 
	multipanel = TRUE, col.nonsignif.lm = rgb(0, 0, 0, 0.5), 
	col.signif.lm = rgb(1, 0.1, 0.1, 0.8), silent =  FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotSpPop_+3A_traits">traits</code></td>
<td>

<p>Individual Matrix of traits with traits in columns.
</p>
</td></tr>
<tr><td><code id="plotSpPop_+3A_ind.plot">ind.plot</code></td>
<td>

<p>Factor defining the name of the plot in which the individual is.
</p>
</td></tr>
<tr><td><code id="plotSpPop_+3A_sp">sp</code></td>
<td>

<p>Factor defining the species which the individual belong to.
</p>
</td></tr>
<tr><td><code id="plotSpPop_+3A_col.ind">col.ind</code></td>
<td>

<p>Color for individual values.
</p>
</td></tr>
<tr><td><code id="plotSpPop_+3A_col.pop">col.pop</code></td>
<td>

<p>Color for populational mean values.
</p>
</td></tr>
<tr><td><code id="plotSpPop_+3A_col.sp">col.sp</code></td>
<td>

<p>Color for species mean values.
</p>
</td></tr>
<tr><td><code id="plotSpPop_+3A_col.site">col.site</code></td>
<td>

<p>Color for sites mean values.
</p>
</td></tr>
<tr><td><code id="plotSpPop_+3A_resume">resume</code></td>
<td>

<p>Logical, if TRUE plot a simple form of the plot.
</p>
</td></tr>
<tr><td><code id="plotSpPop_+3A_p.val">p.val</code></td>
<td>

<p>Choosen p.value to print significant linear relationship using linear model. Argument past to the lm funtion internally.
</p>
</td></tr>
<tr><td><code id="plotSpPop_+3A_min.ind.signif">min.ind.signif</code></td>
<td>

<p>Minimum individual to print significant linear relationship.
</p>
</td></tr>
<tr><td><code id="plotSpPop_+3A_multipanel">multipanel</code></td>
<td>

<p>Logical value. If TRUE divides the device to shown several traits graphics in the same device. 
</p>
</td></tr>
<tr><td><code id="plotSpPop_+3A_col.nonsignif.lm">col.nonsignif.lm</code></td>
<td>

<p>Color for non significant linear relationship.
</p>
</td></tr>
<tr><td><code id="plotSpPop_+3A_col.signif.lm">col.signif.lm</code></td>
<td>

<p>Color for significant linear relationship.
</p>
</td></tr>
<tr><td><code id="plotSpPop_+3A_silent">silent</code></td>
<td>

<p>Logical value, if resume = FALSE do not print warning argument.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Example of utilisation: Cornwell, W.K., Ackerly, D.D., 2009. Community assembly and shifts in plant trait distributions across an environmental gradient in coastal California. Ecological Monographs 79, 109-126.
</p>


<h3>Value</h3>

<p>None; used for the side-effect of producing a plot.
</p>


<h3>Author(s)</h3>

<p>Adrien Taudiere
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plotDistri">plotDistri</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>	data(finch.ind)
	## Not run: 
	plotSpPop(traits.finch, ind.plot.finch, sp.finch, silent = TRUE)

	#If we change the value of the threshold 
	#(alpha = 10% instead of 5% 
	#and the minimum individual to represent significativity 
	#fixed to 3 instead of 10 by default) 
	#we can see some significant relationships.

	plotSpPop(traits.finch, ind.plot.finch, sp.finch, p.val = 0.1,  
	min.ind.signif = 3, silent = TRUE)


	#For a more simple figure, add the option resume = TRUE. 
	#Again if we change the value of the threshold 
	#(alpha = 10% instead of 5% 
	#and the minimum individual to represent significativity
	# fixed to 3 instead of 10 by default) 
	#we can see some significant relationships.

	plotSpPop(traits.finch, ind.plot.finch, sp.finch, silent = TRUE, 
	resume = TRUE, col.pop = "grey")
	
	plotSpPop(traits.finch, ind.plot.finch, sp.finch, silent = TRUE, 
	resume = TRUE, col.pop = "grey", col.sp = "black")
	
	plotSpPop(traits.finch, ind.plot.finch, sp.finch, silent = TRUE, 
	resume = TRUE, col.pop = "grey", col.sp = "black", 
	p.val = 0.1,  min.ind.signif = 3)
	
## End(Not run)
</code></pre>

<hr>
<h2 id='plotSpVar'>
Plot populations values against species values
</h2><span id='topic+plotSpVar'></span>

<h3>Description</h3>

<p>Plot populations values against species values. The objectif is to see the contribution of intra-specific vs inter-specific variation to trait gradient.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	plotSpVar(traits = NULL, ind.plot = NULL, sp = NULL, variable = NULL, 
	col.ind = rgb(0.5, 0.5, 0.5, 0.5), col.pop = NULL, col.sp = NULL, 
	col.site = NULL, resume =  FALSE, p.val = 0.05, min.ind.signif = 10, 
	multipanel = TRUE, col.nonsignif.lm = rgb(0, 0, 0, 0.5), 
	col.signif.lm = rgb(1, 0.1, 0.1, 0.8), silent =  FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotSpVar_+3A_traits">traits</code></td>
<td>

<p>Individual Matrix of traits with traits in columns.
</p>
</td></tr>
<tr><td><code id="plotSpVar_+3A_ind.plot">ind.plot</code></td>
<td>

<p>Factor defining the name of the plot in which the individual is.
</p>
</td></tr>
<tr><td><code id="plotSpVar_+3A_sp">sp</code></td>
<td>

<p>Factor defining the species which the individual belong to.
</p>
</td></tr>
<tr><td><code id="plotSpVar_+3A_variable">variable</code></td>
<td>

<p>A matrix of variables corresponding to each site (in rows) and each trait (in columns). 
If you want to plot all traits against one variable, variable can be a vector of numerical values.
</p>
</td></tr>
<tr><td><code id="plotSpVar_+3A_col.ind">col.ind</code></td>
<td>

<p>Color for individual values.
</p>
</td></tr>
<tr><td><code id="plotSpVar_+3A_col.pop">col.pop</code></td>
<td>

<p>Color for populational mean values.
</p>
</td></tr>
<tr><td><code id="plotSpVar_+3A_col.sp">col.sp</code></td>
<td>

<p>Color for species mean values.
</p>
</td></tr>
<tr><td><code id="plotSpVar_+3A_col.site">col.site</code></td>
<td>

<p>Color for sites mean values.
</p>
</td></tr>
<tr><td><code id="plotSpVar_+3A_resume">resume</code></td>
<td>

<p>Logical, if TRUE plot a simple form of the plot.
</p>
</td></tr>
<tr><td><code id="plotSpVar_+3A_p.val">p.val</code></td>
<td>

<p>Choosen p.value to print significant linear relationship using linear model. Argument past to the lm funtion internally.
</p>
</td></tr>
<tr><td><code id="plotSpVar_+3A_min.ind.signif">min.ind.signif</code></td>
<td>

<p>Minimum individual to print significant linear relationship.
</p>
</td></tr>
<tr><td><code id="plotSpVar_+3A_multipanel">multipanel</code></td>
<td>

<p>Logical value. If TRUE divides the device to shown several traits graphics in the same device. 
</p>
</td></tr>
<tr><td><code id="plotSpVar_+3A_col.nonsignif.lm">col.nonsignif.lm</code></td>
<td>

<p>Color for non significant linear relationship.
</p>
</td></tr>
<tr><td><code id="plotSpVar_+3A_col.signif.lm">col.signif.lm</code></td>
<td>

<p>Color for significant linear relationship.
</p>
</td></tr>
<tr><td><code id="plotSpVar_+3A_silent">silent</code></td>
<td>

<p>Logical value, if resume = FALSE do not print warning argument.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None; used for the side-effect of producing a plot.
</p>


<h3>Author(s)</h3>

<p>Adrien Taudiere
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plotDistri">plotDistri</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>	data(finch.ind)
	
	#Random variable for this example
	variable &lt;- c(1,5,15,6,3,25)
	## Not run: 
	plotSpVar(traits.finch, ind.plot.finch, sp.finch, variable, 
	silent = TRUE)

	#If we change the value of the threshold 
	#(alpha = 10% instead of 5% 
	#and the minimum individual to represent significativity 
	#fixed to 3 instead of 10 by default) 
	#we can see some significant relationships.

	plotSpVar(traits.finch, ind.plot.finch, sp.finch, variable, 
	p.val = 0.1,  min.ind.signif = 3, silent = TRUE)


	#For a more simple figure, add the option resume = TRUE. 
	#Again if we change the value of the threshold 
	#(alpha = 10% instead of 5% 
	#and the minimum individual to represent significativity
	# fixed to 3 instead of 10 by default) 
	#we can see some significant relationships.

	plotSpVar(traits.finch, ind.plot.finch, sp.finch, variable, 
	silent = TRUE, resume = TRUE, col.pop = "grey")
	
	plotSpVar(traits.finch, ind.plot.finch, sp.finch, variable, 
	silent = TRUE, resume = TRUE, col.pop = "grey", col.sp = "black")
	
	plotSpVar(traits.finch, ind.plot.finch, sp.finch, variable, 
	silent = TRUE, resume = TRUE, col.pop = "grey", col.sp = "black", 
	p.val = 0.1,  min.ind.signif = 3)

## End(Not run)
</code></pre>

<hr>
<h2 id='Pval'>
Calcul of p-value for object of class Tstats, ComIndex, ComIndexMulti and listofindex
</h2><span id='topic+Pval'></span>

<h3>Description</h3>

<p>Calcul of p-value for object of class Tstats, ComIndex, ComIndexMulti and listofindex. 
This test equates to finding the quantile in exp in which obs would be found (under a one-tailed test).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	Pval(x, na.rm = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Pval_+3A_x">x</code></td>
<td>

<p>An object of class Tstats, ComIndex, ComIndexMulti or listofindex. 
</p>
</td></tr>
<tr><td><code id="Pval_+3A_na.rm">na.rm</code></td>
<td>

<p>A logical value indicating whether NA values should be stripped before the computation proceeds. 
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of p-value for each metrics, traits and grouping if needed (e.g. sites) 
</p>


<h3>Author(s)</h3>

<p>Adrien Taudiere
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(finch.ind)
res.finch &lt;- Tstats(traits.finch, ind.plot = ind.plot.finch, 
	sp = sp.finch, nperm = 9, print = FALSE)
  ## Not run: 
    Pval(res.finch)
  
## End(Not run)
</code></pre>

<hr>
<h2 id='RandCom'>
Toy model to simulate internal and/or external filtering
</h2><span id='topic+RandCom'></span>

<h3>Description</h3>

<p>Toy model to simulate internal and/or external filtering
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	RandCom(Ncom = 10, Nsp = 20, Nind.com = 100, sdlog = 1.5, 
	min_value_traits = 80, max_value_traits = 200, 
	cv_intra_sp = 1.5, cv_intra_com = 1.5, 
	Int_Filter_Strength = 50, Ext_Filter_Strength = 50, Filter="None")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RandCom_+3A_ncom">Ncom</code></td>
<td>

<p>Number of communities (or sites).
</p>
</td></tr>
<tr><td><code id="RandCom_+3A_nsp">Nsp</code></td>
<td>

<p>Number of species at the regional scale.
</p>
</td></tr>
<tr><td><code id="RandCom_+3A_nind.com">Nind.com</code></td>
<td>

<p>Number of individuals by communities.
</p>
</td></tr>
<tr><td><code id="RandCom_+3A_sdlog">sdlog</code></td>
<td>

<p>Parameter of the log normal distribution for species abundances distribution within communities.
</p>
</td></tr>
<tr><td><code id="RandCom_+3A_min_value_traits">min_value_traits</code></td>
<td>

<p>Minimum mean value for traits distributions.
</p>
</td></tr>
<tr><td><code id="RandCom_+3A_max_value_traits">max_value_traits</code></td>
<td>

<p>Maximum mean value for traits distributions.
</p>
</td></tr>
<tr><td><code id="RandCom_+3A_cv_intra_sp">cv_intra_sp</code></td>
<td>

<p>Coefficient of variation for intra-specific distributions. The more the value is high the less there is internal filtering. Used only for the trait 1 (normally distributed).
</p>
</td></tr>
<tr><td><code id="RandCom_+3A_cv_intra_com">cv_intra_com</code></td>
<td>

<p>Coefficient of variation for intra-community distributions. The more the value is high the less there is external filtering. Used only for the trait 1 (normally distributed)
</p>
</td></tr>
<tr><td><code id="RandCom_+3A_int_filter_strength">Int_Filter_Strength</code></td>
<td>

<p>Strength of internal filtering in percentage. Use in addition to cv_intra_sp by distributing mean species trait more or less evenly. In the most extreme case (if Int_Filter_Strength==100), species have equally distributed mean values along the trait gradient.
</p>
</td></tr>
<tr><td><code id="RandCom_+3A_ext_filter_strength">Ext_Filter_Strength</code></td>
<td>

<p>Strength of external filtering in percentage. Use in addition to cv_intra_com by distributing mean communities trait more or less evenly. In the most extreme case (if Ext_Filter_Strength==100), communities have equally distributed mean values along the trait gradient.
</p>
</td></tr>
<tr><td><code id="RandCom_+3A_filter">Filter</code></td>
<td>

<p>The type of filter to simulate. Either &quot;None&quot;, &quot;Internal&quot;, &quot;External&quot; or &quot;Both&quot;
</p>
</td></tr>	
</table>


<h3>Details</h3>

<p>In this version of the function, the trait 1 follows a normal distribution wheras the trait 2 follows a uniform distribution.
</p>


<h3>Value</h3>

<table>
<tr><td><code>$data$com</code></td>
<td>
<p>Vector of simulated communities for each individual.</p>
</td></tr>
<tr><td><code>$data$sp</code></td>
<td>
<p>Vector of simulated species for each individual.</p>
</td></tr>
<tr><td><code>$data$trait1</code></td>
<td>
<p>Vector of simulated value for the trait 1: normally distributed.</p>
</td></tr>
<tr><td><code>$data$trait2</code></td>
<td>
<p>Vector of simulated value for the trait 2: normally distributed.</p>
</td></tr>
<tr><td><code>$call</code></td>
<td>
<p>call of the function Tstats</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Cecile Albert and Adrien Taudiere
</p>


<h3>Examples</h3>

<pre><code class='language-R'>	
	res &lt;- RandCom()
</code></pre>

<hr>
<h2 id='RaoRel'>
Alpha, gamma and beta-components for taxonomic, functional and phylogenetic diversity
</h2><span id='topic+RaoRel'></span>

<h3>Description</h3>

<p>The Rao function computes alpha, gamma and beta-components for taxonomic, functional and phylogenetic diversity with the Rao index. The script integrates two functions: &quot;Qdecomp&quot;, by Villeger et Mouillot (J Ecol, 2008) modified by Wilfried Thuiller, and &quot;disc&quot;, by S. Pavoine, in the package ade4. For a regional assemblage of C local communities gamma = mean(alpha) + beta, where: gamma is the diversity of the regional pool, alpha is the diversity of the local community and beta is the turn over between local communities diversity is estimated with the Rao quadratic entropy index (Rao 1982)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	RaoRel(sample, dfunc, dphyl, weight = FALSE, Jost = FALSE, 
	structure = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RaoRel_+3A_sample">sample</code></td>
<td>

<p>Community matrix of abundance (c x s) of the s species for the c local communities.
</p>
</td></tr>
<tr><td><code id="RaoRel_+3A_dfunc">dfunc</code></td>
<td>

<p>matrix (s x s) or dist object with pairwise functional trait distances between the s species
</p>
</td></tr>
<tr><td><code id="RaoRel_+3A_dphyl">dphyl</code></td>
<td>

<p>As dfunct but for phylogenetic distances
</p>
</td></tr>
<tr><td><code id="RaoRel_+3A_weight">weight</code></td>
<td>

<p>Defining if the correction by Villeger &amp; Mouillot (J Ecol, 2008) is applied or not
</p>
</td></tr>
<tr><td><code id="RaoRel_+3A_jost">Jost</code></td>
<td>

<p>Defining if the Jost correction is applied (Jost 2007)
</p>
</td></tr>
<tr><td><code id="RaoRel_+3A_structure">structure</code></td>
<td>

<p>A data frame containing the name of the group to which samples belong see de Bello et al, 2011 for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>NA are automatically replaced by 0 in &quot;sample&quot;. This function use the function &quot;Qdecomp&quot; by Sebastien Villeger &amp; David Mouillot (J Ecol, 2008) modified by Wilfried Thuiller and the function disc originally proposed by Sandrine Pavoine.
</p>


<h3>Value</h3>

<p>The results are organized for Taxonomic diversity ($TD), Functional diversity ($FD) and phylogenetical diversity ($PD). Beta and gamma diversities are calculated for the whole data set and for each pair of samples (&quot;Pairwise_samples&quot;):
</p>
<p>$Richness_per_plot(number of species per sample)
</p>
<p>$Relative_abundance (species relative abundances per plot)
</p>
<p>$Pi (species regional relative abundance)
</p>
<p>$Wc (weigthing factor),                               
</p>
<p>$Mean_Alpha (mean aplpha diversity; for taxonomic diversity the Simpson index is calculated)                                   
</p>
<p>$Alpha (alpha diversity for each sample; for taxonomic diversity the Simpson index is calculated)                                       
</p>
<p>$Gamma (gamma diversity; for taxonomic diversity the Simpson index is calculated)                                      
</p>
<p>$Beta_add (Gamma-Mean_Alpha)                                          
</p>
<p>$Beta_prop (Beta_add*100/Gamma)                                                         
</p>
<p>$Pairwise_samples$Alpha (mean alpha for each pair of samples)                        
</p>
<p>$Pairwise_samples$Gamma (gamma for each pair of samples)
</p>
<p>$Pairwise_samples$Beta_add (beta for each pair of samples as Gamma-Mean_Alpha)  
</p>
<p>$Pairwise_samples$Beta_prop (beta for each pair of samples as Beta_add*100/Gamma) 
</p>


<h3>Author(s)</h3>

<p>Francesco De Bello et al., 2011 modified by Adrien Taudiere
</p>


<h3>References</h3>

<p>De Bello, Francesco, Sandra Lavorel, Cecile H. Albert, Wilfried Thuiller, Karl Grigulis, Jiri Dolezal, stepan Janecek, et Jan Leps. 2011. Quantifying the relevance of intraspecific trait variability for functional diversity: Intraspecific variability in functional diversity. Methods in Ecology and Evolution 2: 163-174. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>	data(finch.ind)
	
	## Not run: 
		comm &lt;- t(table(ind.plot.finch,1:length(ind.plot.finch)))
		comm.sp &lt;- table(sp.finch, ind.plot.finch)
		class(comm.sp) &lt;- "matrix"
		
		traits.finch.sp &lt;- apply( apply(traits.finch, 2, scale ), 2, 

		function(x) tapply(x, sp.finch, mean, na.rm = TRUE))
		
		mat.dist &lt;- (as.matrix(dist(traits.finch.sp))^2)/2
		
		res.rao &lt;- RaoRel(sample = as.matrix(comm.sp), dfunc = mat.dist, dphyl = NULL, 
		weight = FALSE, Jost = FALSE, structure = NULL)

		function(x) tapply(x, sp.finch, mean, na.rm=TRUE))
		
		mat.dist &lt;- as.matrix(dist(traits.finch.sp))^2
		
		res.rao &lt;- RaoRel(sample=as.matrix(comm.sp), dfunc=mat.dist, dphyl=NULL, 
		weight=FALSE, Jost=FALSE, structure=NULL)

		
		witRao &lt;- res.rao$FD$Mean_Alpha  #overall within species variance
		betRao &lt;- res.rao$FD$Beta_add    #between species variance
		totRao &lt;- res.rao$FD$Gamma       #the total variance
		
		witRao+betRao
		totRao
		
		
		#Now let"s take the abundance to calculate Rao diversity.
		

		res.rao.w &lt;- RaoRel(sample = as.matrix(comm.sp), dfunc = mat.dist, dphyl = NULL, 
		weight = TRUE, Jost = FALSE, structure = NULL)
		
		witRao.w &lt;- res.rao.w$FD$Mean_Alpha  #overall within species variance
		betRao.w &lt;- res.rao.w$FD$Beta_add    #between species variance
		totRao.w &lt;- res.rao.w$FD$Gamma       #the total variance
		
		witRao.w
		betRao.w
		
		
		#Plot the results
		
		barplot(cbind(c(witRao.w, betRao.w), c(witRao, betRao)), 
		names.arg  = c("abundance" ,"presence"), 
		legend.text = c("within species", "between species"), 
		ylab = "Rao", ylim = c(0,10))
		
		
		#We can do this analysis for each trait separately. 
		#First we need to replace (or exclude) NA values. 
		#For this example, we use the package mice to complete the data.
		
		comm &lt;- t(table(ind.plot.finch,1:length(ind.plot.finch)))
		
		library(mice)

		traits = traits.finch

		mice &lt;- mice(traits.finch)
		traits.finch.mice &lt;- complete(mice)
		
		traits.finch.mice.sp &lt;- apply(apply(traits.finch.mice, 2, scale ), 2, 
		function(x) tapply(x, sp.finch, mean, na.rm = TRUE))


		trait.rao.w &lt;- list()
		witRao.w.bytrait &lt;- c()
		betRao.w.bytrait &lt;- c()

		for (t in 1 : 4){
		  trait.rao.w[[t]] &lt;- RaoRel(sample = as.matrix(comm.sp), 
		  dfunc = (dist(traits.finch.mice.sp[,t])^2)/2, dphyl = NULL, weight = TRUE, 
		  Jost = FALSE, structure = NULL)
				  
		  witRao.w.bytrait &lt;- c(witRao.w.bytrait, trait.rao.w[[t]]$FD$Mean_Alpha)
		  betRao.w.bytrait &lt;- c(betRao.w.bytrait, trait.rao.w[[t]]$FD$Beta_add)
		}
		
		#Plot the results by traits.
		
		barplot(t(cbind( witRao.w.bytrait, betRao.w.bytrait)), 
		names.arg = colnames(traits.finch),
		legend.text = c("within species", "between species"), 
		ylab = "Rao", ylim = c(0,1.5))	
	
## End(Not run)
</code></pre>

<hr>
<h2 id='samplingSubsetData'>
Sampling subset of data.
</h2><span id='topic+samplingSubsetData'></span>

<h3>Description</h3>

<p>Sampling subset of data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	samplingSubsetData(d = NULL, sampUnit = NULL, nperm = 9, 
	type = "proportion", prop = seq(10, 100, by = 10), MinSample = 1,
	Size = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="samplingSubsetData_+3A_d">d</code></td>
<td>

<p>Dataframe of data to sample. Each line is an individual.
</p>
</td></tr>
<tr><td><code id="samplingSubsetData_+3A_sampunit">sampUnit</code></td>
<td>

<p>A Factor defining the sampling unit to impoverish. For example it can be the species or the plot attributes of each individual. 
</p>
</td></tr>
<tr><td><code id="samplingSubsetData_+3A_nperm">nperm</code></td>
<td>

<p>Number of permutations. 
</p>
</td></tr>
<tr><td><code id="samplingSubsetData_+3A_type">type</code></td>
<td>

<p>Type of sampling. Either <strong>proportion</strong>, <strong>count</strong>, <strong>propBySize</strong> or <strong>factorBySize</strong>. See details.
</p>
</td></tr>
<tr><td><code id="samplingSubsetData_+3A_prop">prop</code></td>
<td>

<p>Integer between 1 and 100. Categorical proportions to sample in percentage. 
</p>
</td></tr>
<tr><td><code id="samplingSubsetData_+3A_minsample">MinSample</code></td>
<td>

<p>Minimum number of individual to sample by sample unit. Default is one.
</p>
</td></tr>
<tr><td><code id="samplingSubsetData_+3A_size">Size</code></td>
<td>

<p>A vector of value for each individual (type <strong>propBySize</strong> and <strong>factorBySize</strong>) or for each level of factor (<strong>factorBySize</strong> only). Determine the rank of individual/factor when using the sampling schemes <strong>propBySize</strong> and <strong>factorBySize</strong>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Sampling scheme <strong>count</strong> sample a number of individuals wheras <strong>proportion</strong> sample a proportion of individuals by sample unit. Sampling scheme <strong>propBySize</strong> sample in each sampling unit (sampUnit) a proportion of the individual ranked using the argument <strong>Size</strong>. Consequently, the bigest individuals (higher Size) will be sample before the smaller one. <strong>factorBySize</strong> sample a proportion of sampling unit (sampUnit) ranked using the argument <strong>Size</strong>. For example you can sample only the individuals of the 20% of the more aboundant species.
</p>


<h3>Value</h3>

<p>Return a list list of sample dataframe. The first level of the list depicts the permutation and the second level depicts the different proportion/number of individual sampled by factor. 
</p>


<h3>Author(s)</h3>

<p>Adrien Taudiere
</p>

<hr>
<h2 id='ses'>
Standardized effect size and confidence interval for a matrix of statistics 
</h2><span id='topic+ses'></span>

<h3>Description</h3>

<p>calculation standardized effect size and confidence interval for a matrix of statistics and the related null model expressed as a list or as an array. Internal function use by other functions of the package. You can transpose the observed matrix to represent either the SES by traits or by plots. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	ses(obs = NULL, nullmodel = NULL, val.quant = c(0.025, 0.975))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ses_+3A_obs">obs</code></td>
<td>

<p>Observed matrix or vector of values.
</p>
</td></tr>
<tr><td><code id="ses_+3A_nullmodel">nullmodel</code></td>
<td>

<p>Either a list or an array of three (two for a vector of observed values) dimensions corresponding to the null model permutations. 
</p>
</td></tr>
<tr><td><code id="ses_+3A_val.quant">val.quant</code></td>
<td>

<p>Numeric vectors of length 2, giving the quantile to calculation confidence interval. By default val.quant = c(0.025,0.975) for a bilateral test with alpha = 5%.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Warning: to detect automatically the correspondence between dimension of observed matrix and null model list or array, observed matrix needs to have different numbers of rows and columns. In the case of same row and column number, please verify manually the correspondance beatween the rows of the observed matrix and the null model array.
</p>


<h3>Value</h3>

<p>A list of three components:
</p>
<table>
<tr><td><code>$ses</code></td>
<td>
<p>Observed value of standardized effect size.</p>
</td></tr>
<tr><td><code>$ses.inf</code></td>
<td>
<p>Lower limit of the confidence interval.</p>
</td></tr>
<tr><td><code>$ses.sup</code></td>
<td>
<p>Upper limit of the confidence interval.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Adrien Taudiere
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.listofindex">plot.listofindex</a></code>;
<code><a href="#topic+plotSESvar">plotSESvar</a></code>;
<code><a href="#topic+ses.listofindex">ses.listofindex</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>	data(finch.ind)
	
	res.finch &lt;- Tstats(traits.finch, ind.plot = ind.plot.finch, 
	sp = sp.finch, nperm = 9)
	## Not run: 
		ses(res.finch$Tstats$T_IP.IC, res.finch$Tstats$T_IP.IC_nm)
	
## End(Not run)
</code></pre>

<hr>
<h2 id='ses.listofindex'>
Standardized effect size for a list of index. 
</h2><span id='topic+ses.listofindex'></span>

<h3>Description</h3>

<p>Standardized effect size and confidence interval for a list of index.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	ses.listofindex(index.list = NULL, val.quant = c(0.025, 0.975))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ses.listofindex_+3A_index.list">index.list</code></td>
<td>

<p>A list of index obtain using the function as.listofindex.
</p>
</td></tr>
<tr><td><code id="ses.listofindex_+3A_val.quant">val.quant</code></td>
<td>

<p>Numeric vectors of length 2, giving the quantile to calculation confidence interval. By default val.quant = c(0.025,0.975) for a bilateral test with alpha = 5%.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list which each component correspond to the result of the ses function for an index. Further, each component is a list of three components:
</p>
<table>
<tr><td><code>$ses</code></td>
<td>
<p>Observed value of standardized effect size.</p>
</td></tr>
<tr><td><code>$ses.inf</code></td>
<td>
<p>Lower limit of the confidence interval.</p>
</td></tr>
<tr><td><code>$ses.sup</code></td>
<td>
<p>Upper limit of the confidence interval.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Adrien	Taudiere
</p>


<h3>See Also</h3>

<p><code><a href="#topic+as.listofindex">as.listofindex</a></code>;
<code><a href="#topic+ses">ses</a></code>
</p>

<hr>
<h2 id='SumBL'>
Sum of branch length of a classification dendrogram (Petchey and Gaston, 2002) 
</h2><span id='topic+SumBL'></span>

<h3>Description</h3>

<p>Sum of branch length of a classification dendrogram (Petchey and Gaston, 2002) 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	SumBL(traits, gower.dist = TRUE, method.hclust = "average", 
	scale.tr = TRUE, method.dist = "euclidian")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SumBL_+3A_traits">traits</code></td>
<td>

<p>Traits matrix (traits in column)
</p>
</td></tr>
<tr><td><code id="SumBL_+3A_gower.dist">gower.dist</code></td>
<td>

<p>Calculate gower distance using the function gowdis from package FD.
</p>
</td></tr>	
<tr><td><code id="SumBL_+3A_method.hclust">method.hclust</code></td>
<td>

<p>Define the method for the hclust function (default is &quot;average&quot; i.e. UPGMA).
</p>
</td></tr>
<tr><td><code id="SumBL_+3A_scale.tr">scale.tr</code></td>
<td>

<p>Does traits need to be scale before multi-traits metric calculation? Only use when gower.dist = FALSE. Default is yes.
</p>
</td></tr>
<tr><td><code id="SumBL_+3A_method.dist">method.dist</code></td>
<td>

<p>Method to calculate the distance in case of multi-traits metric (function dist). Only use when gower.dist = FALSE. Default is euclidian.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The value of the sum of branch length from a classification dendrogram of traits.
</p>


<h3>Author(s)</h3>

<p>Adrien Taudiere
</p>


<h3>References</h3>

<p>Petchey, OL., and Gaston, KJ. 2002. Functional diversity (FD), species richness and community composition. Ecology Letters 5:402-411
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 

data(finch.ind)
SumBL(traits.finch)
SumBL(traits.finch, gower.dist = FALSE)


## End(Not run)

</code></pre>

<hr>
<h2 id='traitflex.anova'>
Variance decomposition for a given trait used in decompCTRE
</h2><span id='topic+traitflex.anova'></span><span id='topic+print.traitflex'></span><span id='topic+plot.traitflex'></span>

<h3>Description</h3>

<p>This function decomposes variation of trait values within a community into three sources: (i) the intraspecific trait variability, (ii) the
variability due to species turnover and (iii) their covariation is also separated. This decomposition is computed for the whole variation in the trait
values and, The formula specified, across the contribution of various explanatory variables considered in the model. S3 method plot summarizes graphically the decomposition of trait variation, obtained with the traitflex.anova function. Print is an other S3 method for object of class traitflex.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	traitflex.anova(formula, specif.avg, const.avg, ...)
	## S3 method for class 'traitflex'
plot(x, plot.total =  FALSE, use.percentage = TRUE, 
	plot.covar =  FALSE, cumul =  FALSE, 
	legend.pos = if (plot.total) "topleft" else "topright", 
	plot.res = TRUE, ...)
	
	## S3 method for class 'traitflex'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="traitflex.anova_+3A_formula">formula</code></td>
<td>

<p>The formula parameter must be a one-sided formula, i.e. starting with a tilde character. The response variable is specified by the next two arguments, specif.avg and const.avg. 
</p>
</td></tr>
<tr><td><code id="traitflex.anova_+3A_specif.avg">specif.avg</code></td>
<td>

<p>Vector with community trait composition values for a single trait. It is calculated from trait values specific to each community (i.e. trait values for individual species are 'specific' to each plot, or habitat, where the species is found)
</p>
</td></tr>
<tr><td><code id="traitflex.anova_+3A_const.avg">const.avg</code></td>
<td>

<p>Vector with community trait composition values for a single trait. It is calculated from average (fixed) trait values of individual species (i.e. fixed trait value for individual species used for all habitats where the species is found)
</p>
</td></tr>
<tr><td><code id="traitflex.anova_+3A_x">x</code></td>
<td>

<p>An object of class traitflex.
</p>
</td></tr>
<tr><td><code id="traitflex.anova_+3A_plot.total">plot.total</code></td>
<td>

<p>Logical value; if TRUE plot not only the individual components of variation, but also the total variation. This is useful particularly when the decomposition was done with non-trivial formula (i.e. with explanatory variables)
</p>
</td></tr>
<tr><td><code id="traitflex.anova_+3A_use.percentage">use.percentage</code></td>
<td>

<p>Logical value; if TRUE the individual plotted sources of trait variation are shown as percentages of the total variation, on 0-100 scale.
</p>
</td></tr>
<tr><td><code id="traitflex.anova_+3A_plot.covar">plot.covar</code></td>
<td>

<p>Logical value; if TRUE the covariance between within-species trait variability and the variability due to species composition turnover is plotted as yet another category within the stacked bars. The plot.covar argument is entirely ignored when plotting traitflex object fitted with a formula without any predictor variables.
</p>
</td></tr>
<tr><td><code id="traitflex.anova_+3A_cumul">cumul</code></td>
<td>

<p>Logical value; if TRUE values are shown in a cumulative way.
</p>
</td></tr>
<tr><td><code id="traitflex.anova_+3A_legend.pos">legend.pos</code></td>
<td>

<p>This argument allows you to specify the position of graph legend. Thus argument is entirely ignored when plotting traitflex object created with a formula without predictors
</p>
</td></tr>
<tr><td><code id="traitflex.anova_+3A_plot.res">plot.res</code></td>
<td>

<p>Logical value; if resume = FALSE plot is not shown but the table of values used to print the plot is return.
</p>
</td></tr>
<tr><td><code id="traitflex.anova_+3A_...">...</code></td>
<td>

<p>Optional additional arguments.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The formula parameter must be a one-sided formula, i.e. starting with a tilde character. The response variable is specified by the next two arguments, specif.avg and const.avg. 
</p>


<h3>Value</h3>

<p>An object of class traitflex. There are print and plot methods available for it. The object contains decomposition of sum of squares into intraspecific variation component, compositional variation component, their covariation and total in a SumSq element. This is a data frame with multiple rows if predictors were specified in formula argument. The RelSumSq element contains the same table relativized to unit row totals. Finally, the anova.turnover, anova.total, and anova.diff elements contain the three aov objects used to decompose the variation.
</p>


<h3>Author(s)</h3>

<p>Jan Leps et al., 2011 modified by Adrien Taudiere
</p>


<h3>References</h3>

<p>Leps, Jan, Francesco de Bello, Petr Smilauer and Jiri Dolezal. 2011. Community trait response to environment: disentangling species turnover vs intraspecific trait variability effects. Ecography 34 (5): 856-863.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+print.traitflex">print.traitflex</a></code>;
<code><a href="#topic+plot.traitflex">plot.traitflex</a></code>;
<code><a href="#topic+decompCTRE">decompCTRE</a></code>
</p>

<hr>
<h2 id='Tstats'>
Computing observed T-statistics (T for Traits) and null expectations.
</h2><span id='topic+Tstats'></span><span id='topic+barplot.Tstats'></span><span id='topic+plot.Tstats'></span><span id='topic+summary.Tstats'></span><span id='topic+print.Tstats'></span><span id='topic+sum_Tstats'></span><span id='topic+ses.Tstats'></span>

<h3>Description</h3>

<p>Computing observed T-statistics (T for Traits) as three ratios of variance, namely T_IP.IC, T_IC.IR and T_PC.PR. This function can also return the distribution of this three statistics under null models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	Tstats(traits, ind.plot, sp, SE = 0, reg.pool = NULL, 
	SE.reg.pool = NULL, nperm = 99, printprogress = TRUE, 
	independantTraits = TRUE)
	
	sum_Tstats(x, val.quant = c(0.025, 0.975), type = "all")
	
	ses.Tstats(x, val.quant = c(0.025, 0.975))
		
	## S3 method for class 'Tstats'
barplot(height, val.quant = c(0.025, 0.975), 
	col.index = c("red", "purple", "olivedrab3", "white"), ylim = NULL, ...)
                 
	## S3 method for class 'Tstats'
plot(x, type = "normal", col.index = c("red", "purple", "olivedrab3"),
	add.conf = TRUE, color.cond = TRUE, val.quant = c(0.025, 0.975), ...)
		
	## S3 method for class 'Tstats'
print(x, ...)
		
	## S3 method for class 'Tstats'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Tstats_+3A_traits">traits</code></td>
<td>

<p>Individual Matrix of traits with traits in columns. For one trait, use as.matrix().
</p>
</td></tr>
<tr><td><code id="Tstats_+3A_ind.plot">ind.plot</code></td>
<td>

<p>Factor defining the name of the plot in which the individual is.
</p>
</td></tr>
<tr><td><code id="Tstats_+3A_sp">sp</code></td>
<td>

<p>Factor defining the species which the individual belong to.
</p>
</td></tr>
<tr><td><code id="Tstats_+3A_se">SE</code></td>
<td>

<p>A single value or vector of standard errors associated with each traits. Especially allow to handle measurement errors. Not used with populational null model.  
</p>
</td></tr>
<tr><td><code id="Tstats_+3A_reg.pool">reg.pool</code></td>
<td>

<p>Regional pool data for traits. If not informed, 'traits' is considered as the regional pool. This matrix need to be larger (more rows) than the matrix &quot;traits&quot;. Use only for null model 2 (regional.ind).
</p>
</td></tr>	
<tr><td><code id="Tstats_+3A_se.reg.pool">SE.reg.pool</code></td>
<td>

<p>A single value or vector of standard errors associated with each traits in each regional pool. Use only if reg.pool is used. Need to have the same dimension as reg.pool.
</p>
</td></tr>
<tr><td><code id="Tstats_+3A_nperm">nperm</code></td>
<td>

<p>Number of permutations. If NULL, only observed values are returned; 
</p>
</td></tr>
<tr><td><code id="Tstats_+3A_printprogress">printprogress</code></td>
<td>

<p>Logical value; print progress during the calculation or not.
</p>
</td></tr>
<tr><td><code id="Tstats_+3A_independanttraits">independantTraits</code></td>
<td>
 
<p>Logical value (default: TRUE). If independantTraits is true (default), each traits is sample independently in null models, if not, each lines of the matrix are randomized, keeping the relation (and trade-off) among traits.
</p>
</td></tr>
<tr><td><code id="Tstats_+3A_x">x</code></td>
<td>

<p>An object of class Tstats.
</p>
</td></tr>
<tr><td><code id="Tstats_+3A_height">height</code></td>
<td>

<p>An object of class Tstats.
</p>
</td></tr>
<tr><td><code id="Tstats_+3A_object">object</code></td>
<td>

<p>An object of class Tstats.
</p>
</td></tr>
<tr><td><code id="Tstats_+3A_val.quant">val.quant</code></td>
<td>

<p>Numeric vectors of length 2, giving the quantile to calculation confidence interval. By default val.quant = c(0.025,0.975) for a bilateral test with alpha = 5%.
</p>
</td></tr>
<tr><td><code id="Tstats_+3A_ylim">ylim</code></td>
<td>

<p>Numeric vectors of length 2, giving the y coordinates range 
</p>
</td></tr>
<tr><td><code id="Tstats_+3A_col.index">col.index</code></td>
<td>

<p>A vector of three color correspond to the three T-statistics.
</p>
</td></tr>
<tr><td><code id="Tstats_+3A_color.cond">color.cond</code></td>
<td>

<p>Logical value; If color.cond = TRUE, color points indicate T-statistics values significatively different from the null model and grey points are not different from null model.
</p>
</td></tr>
<tr><td><code id="Tstats_+3A_type">type</code></td>
<td>

<p>For the plot function, type of plot. Possible type = &quot;simple&quot;, &quot;simple_range&quot;, &quot;normal&quot;, &quot;barplot&quot; and &quot;bytraits&quot;.
For the summary function, type of summary statistics. Either &quot;binary&quot;, &quot;percent&quot;, &quot;p.value&quot;, &quot;site&quot; or &quot;all&quot;. 
</p>
</td></tr>
<tr><td><code id="Tstats_+3A_add.conf">add.conf</code></td>
<td>

<p>Logical value; Add confidence intervals or not. 
</p>
</td></tr>
<tr><td><code id="Tstats_+3A_...">...</code></td>
<td>

<p>Any additional arguments are passed to the plot function creating the core of the plot and can be used to adjust the look of resulting graph. See <code><a href="#topic+plot.listofindex">plot.listofindex</a></code> for more arguments.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><b>S3 method plot:</b>
</p>
<p>-<em>Normal</em> type plot means, standard deviations, ranges and confidence intervals of T-statistics.
</p>
<p>-<em>Simple_range</em> type plot means, standard deviations and range of T-statistics
</p>
<p>-<em>Simple</em> type plot T-statistics for each site and traits and the mean confidence intervals by traits
</p>
<p>-<em>Barplot</em> type plot means, standard deviations and confidence intervals of T-statistics in a barplot fashion
</p>
<p>-<em>Bysites</em> type plot each metrics for each sites
</p>
<p>-<em>Bytraits</em> type plot each metrics for each traits
</p>
<p><b>S3 method print</b>: print the structure if the object of class Tstats
</p>
<p><b>S3 method summary:</b> print the summary statistics of the three T-statistics
</p>
<p><b>Method summary sum_Tstats:</b>
</p>
<p>-<em>Binary</em> type only test if a T-statistics is significatively different from the null expectation for each trait.
</p>
<p>-<em>Percent</em> type determine the percentage of sites were the T-statistics is significatively different from the null expectation for each trait. Asterix shows global significance of the test.
</p>
<p>-<em>P-value</em> type determine the p-value (two unilateral tests) of the T-statistics for each trait and sites.
</p>
<p>-<em>Site</em> type allows to know in which sites T-statistics deviate from the null expectation.
</p>
<p>-<em>All</em> type do all the precedent type of summary.
</p>


<h3>Value</h3>

<p>A list of statistics:
</p>
<table>
<tr><td><code>Tstats$T_IP.IC</code></td>
<td>
<p>Observed ratio between variance of individuals in populations and individuals in communities</p>
</td></tr>
<tr><td><code>Tstats$T_IC.IR</code></td>
<td>
<p>Observed ratio between variance of individuals in communities and individuals in the region</p>
</td></tr>
<tr><td><code>Tstats$T_PC.PR</code></td>
<td>
<p>Observed ratio between variance of populations in communities and populations in the region</p>
</td></tr>
<tr><td><code>$Tstats$T_IP.IC_nm</code></td>
<td>
<p>If nperm is numeric; Result of simulation for T_IP.IC</p>
</td></tr>
<tr><td><code>$Tstats$T_IC.IR_nm</code></td>
<td>
<p>If nperm is numeric; Result of simulation for T_IC.IR</p>
</td></tr>
<tr><td><code>$Tstats$T_PC.PR_nm</code></td>
<td>
<p>If nperm is numeric; Result of simulation for T_PC.PR</p>
</td></tr>
<tr><td><code>$variances$var_IP</code></td>
<td>
<p>variance of individuals within populations</p>
</td></tr>    
<tr><td><code>$variances$var_PC</code></td>
<td>
<p>variance of populations within communities</p>
</td></tr>
<tr><td><code>$variances$var_CR</code></td>
<td>
<p>variance of communities within the region</p>
</td></tr>
<tr><td><code>$variances$var_IC</code></td>
<td>
<p>variance of individuals within communities</p>
</td></tr>
<tr><td><code>$variances$var_PR</code></td>
<td>
<p>variance of populations within the region</p>
</td></tr>
<tr><td><code>$variances$var_IR</code></td>
<td>
<p>variance of individuals within the region</p>
</td></tr>
<tr><td><code>$variances$var_IP_nm1</code></td>
<td>
<p>variance of individuals within populations in null model 1</p>
</td></tr>    
<tr><td><code>$variances$var_PC_nm2sp</code></td>
<td>
<p>variance of populations within communities in null model 2sp</p>
</td></tr>
<tr><td><code>$variances$var_IC_nm1</code></td>
<td>
<p>variance of communities within the region in null model 1</p>
</td></tr>
<tr><td><code>$variances$var_IC_nm2</code></td>
<td>
<p>variance of individuals within communities in null model 2</p>
</td></tr>
<tr><td><code>$variances$var_PR_nm2sp</code></td>
<td>
<p>variance of populations within the region in null model 2sp</p>
</td></tr>
<tr><td><code>$variances$var_IR_nm2</code></td>
<td>
<p>variance of individuals within the region in null model 2</p>
</td></tr>
<tr><td><code>$traits</code></td>
<td>
<p>traits data</p>
</td></tr>
<tr><td><code>$ind.plot</code></td>
<td>
<p>name of the plot in which the individual is</p>
</td></tr>
<tr><td><code>$sp</code></td>
<td>
<p>groups (e.g. species) which the individual belong to</p>
</td></tr>
<tr><td><code>$call</code></td>
<td>
<p>call of the function Tstats</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Adrien Taudiere and Cyrille Violle
</p>


<h3>References</h3>

<p>Violle, Cyrille, Brian J. Enquist, Brian J. McGill, Lin Jiang, Cecile H. Albert, Catherine Hulshof, Vincent Jung, et Julie Messier. 2012. The return of the variance: intraspecific variability in community ecology. Trends in Ecology &amp; Evolution 27 (4): 244-252. doi:10.1016/j.tree.2011.11.014.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ComIndex">ComIndex</a></code>;
<code><a href="#topic+ComIndexMulti">ComIndexMulti</a></code>;
<code><a href="#topic+plotCorTstats">plotCorTstats</a></code>;
<code><a href="#topic+plotSESvar">plotSESvar</a></code>;
<code><a href="#topic+plot.listofindex">plot.listofindex</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>	data(finch.ind)
	
## Not run: 
	res.finch &lt;- Tstats(traits.finch, ind.plot = ind.plot.finch, 
	sp = sp.finch, nperm = 9, print = FALSE)
	
	res.finch

	#Tstats class is associated to S3 methods plot, barplot and summary
	
	plot(res.finch)
	
	
	plot(res.finch, type = "simple")
	plot(res.finch, type = "simple_range")
	plot(res.finch, type = "barplot")
	plot(res.finch, type = "bysites")
	plot(res.finch, type = "bytraits")

	
	sum_Tstats(res.finch, type = "binary")
	sum_Tstats(res.finch, type = "site")
	sum_Tstats(res.finch, type = "p.value")

	barplot(res.finch)
	
	#### An other way to see "ses values" of T-statistics
	
	# Custom theme (from rasterVis package)
	require(rasterVis)
	
	my.theme &lt;- BuRdTheme()
	# Customize the colorkey
	my.ckey &lt;- list(col = my.theme$regions$col)
	
	levelplot(t(ses(res.finch$Tstats$T_IP.IC,res.finch$Tstats$T_IP.IC_nm)$ses), 
	colorkey = my.ckey, par.settings = my.theme,border = "black")
	
	#### Use a different regional pool than the binding of studied communities
	#create a random regional pool for the example
	
	reg.p &lt;- rbind(traits.finch, traits.finch[sample(1:2000,300), ])
	
	res.finch2 &lt;- Tstats(traits.finch, ind.plot = ind.plot.finch, 
	   sp = sp.finch, reg.pool=reg.p, nperm = 9, print = FALSE)	
	    
	plot(as.listofindex(list(res.finch,res.finch2)))
  
	#### Use a different regional pool for each communities
	#create a random regional pool for each communities for the example
	
	list.reg.p &lt;- list(
	traits.finch[sample(1:290,200), ], traits.finch[sample(100:1200,300), ], 
	traits.finch[sample(100:1500, 1000), ], traits.finch[sample(300:800,300), ],
	traits.finch[sample(1000:2000, 500), ], traits.finch[sample(100:900, 700), ] )

	# Warning: the regional pool need to be larger than the observed communities
	table(ind.plot.finch)
	# For exemple, the third community need a regional pool of more than 981 individuals
		
	res.finch3 &lt;- Tstats(traits.finch, ind.plot = ind.plot.finch, 
	   sp = sp.finch, reg.pool=list.reg.p, nperm = 9, print = FALSE)	
	    
	plot(as.listofindex(list(res.finch, res.finch2, res.finch3)))	

	#### Use the standard errors of measure in the analysis (argument SE)
	res.finch.SE0 &lt;- Tstats(traits.finch, ind.plot = ind.plot.finch, 
	sp = sp.finch, SE = 0, print = FALSE)
		
	res.finch.SE5 &lt;- Tstats(traits.finch, ind.plot = ind.plot.finch, 
	sp = sp.finch, SE = 5, print = FALSE)
	
	plot(as.listofindex(list(res.finch.SE0, res.finch.SE5)))
	
## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
