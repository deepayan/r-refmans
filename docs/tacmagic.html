<!DOCTYPE html><html><head><title>Help for package tacmagic</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {tacmagic}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#as.tac'><p>Creates a tac object from a data.frame</p></a></li>
<li><a href='#batch_load'><p>Load (+/- merge) ROIs for batch of participants</p></a></li>
<li><a href='#batch_tm'><p>Calculate one or more models for a batch of participants</p></a></li>
<li><a href='#batch_voistat'><p>Obtain values from voistat files (using load_voistat() for a batch.</p></a></li>
<li><a href='#change_units'><p>Convert radioactivity units</p></a></li>
<li><a href='#cutoff_aiz'><p>Cutoff value calculation using method described in Aizenstein et al. 2008</p></a></li>
<li><a href='#dvr'><p>Distribution volume ratio (DVR) for one or more ROIs</p></a></li>
<li><a href='#DVR_all_ref_Logan'><p>Non-invasive reference Logan method for all ROIs in tac data</p></a></li>
<li><a href='#DVR_ref_Logan'><p>Non-invasive reference Logan method</p></a></li>
<li><a href='#fake_DVR'><p>Fake DVR data for vignette and package testing</p></a></li>
<li><a href='#load_tac'><p>Loads TAC from file for use by other functions (default is PMOD .tac format)</p></a></li>
<li><a href='#load_voistat'><p>Reads PMOD .voistat files and optionally merges volume-weighted ROIs</p></a></li>
<li><a href='#load_vol'><p>Loads ROI volumes from file for use by other functions</p></a></li>
<li><a href='#plot.ref_Logan'><p>Non-invasive reference Logan plot</p></a></li>
<li><a href='#plot.tac'><p>Plots time activity curves from 1 or 2 participants or groups.</p></a></li>
<li><a href='#pos_anyroi'><p>Dichotomize participants based on ROI cutoff values</p></a></li>
<li><a href='#roi_AAL_full'><p>Return a list of merged ROIs made up of the atomic ROIs in the AAL atlas.</p>
The groupings for major lobes are as described in the PMOD documentation.</a></li>
<li><a href='#roi_ham_full'><p>Return a list of larger ROIs made up of the ROIs in the Hammer's atlas.</p></a></li>
<li><a href='#roi_ham_pib'><p>Return a list of merged ROIs made up of atomic ROIs in the Hammer's atlas.</p></a></li>
<li><a href='#roi_ham_stand'><p>Return a list of merged ROIs made up of the atomic ROIs in the Hammer's</p>
atlas.</a></li>
<li><a href='#save_tac'><p>Save a tac object as a .tac file</p></a></li>
<li><a href='#split_pvc'><p>Subset PMOD tacs with or without PVC</p></a></li>
<li><a href='#suv'><p>Calculate average SUV over time window, or maximum SUV</p></a></li>
<li><a href='#suvr'><p>Calculate weighted SUVRs for specified regions of interest</p></a></li>
<li><a href='#suvr_auc'><p>Calculate SUVRs for regions of interest with AUC from mid-frame times</p></a></li>
<li><a href='#tac_roi'><p>Calculate weighted time-activity curves for specified regions of interest</p></a></li>
<li><a href='#tac_suv'><p>Calculate SUV from TAC</p></a></li>
<li><a href='#tacmagic'><p>tacmagic: PET Analysis in R</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Positron Emission Tomography Time-Activity Curve Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.1</td>
</tr>
<tr>
<td>Description:</td>
<td>To facilitate the analysis of positron emission tomography (PET) 
    time activity curve (TAC) data, and to encourage open science and 
    replicability, this package supports data loading and analysis of multiple 
    TAC file formats. Functions are available to analyze loaded TAC data for 
    individual participants or in batches. Major functionality includes weighted
    TAC merging by region of interest (ROI), calculating models including 
    standardized uptake value ratio (SUVR) and distribution volume ratio (DVR, 
    Logan et al. 1996 &lt;<a href="https://doi.org/10.1097%2F00004647-199609000-00008">doi:10.1097/00004647-199609000-00008</a>&gt;), basic plotting 
    functions and calculation of cut-off values (Aizenstein et al. 2008
    &lt;<a href="https://doi.org/10.1001%2Farchneur.65.11.1509">doi:10.1001/archneur.65.11.1509</a>&gt;). Please see the walkthrough vignette for
    a detailed overview of 'tacmagic' functions.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/ropensci/tacmagic">https://github.com/ropensci/tacmagic</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/ropensci/tacmagic">https://github.com/ropensci/tacmagic</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.0</td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, grDevices, pracma, utils, R.matlab</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, knitr, rmarkdown, covr, vdiffr</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-12-09 02:49:29 UTC; ericbrown</td>
</tr>
<tr>
<td>Author:</td>
<td>Eric Brown <a href="https://orcid.org/0000-0002-1575-2606"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre],
  Ariel Graff-Guerrero [dgs],
  Jon Clayden <a href="https://orcid.org/0000-0002-6608-0619"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [rev]
    (Jon Clayden reviewed the package for ropensci, see
    &lt;https://github.com/ropensci/software-review/issues/280&gt;),
  Brandon Hurr <a href="https://orcid.org/0000-0003-2576-4544"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [rev] (Brandon Hurr reviewed the package for ropensci, see
    &lt;https://github.com/ropensci/software-review/issues/280&gt;)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Eric Brown &lt;eb@ericebrown.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-12-09 10:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='as.tac'>Creates a tac object from a data.frame</h2><span id='topic+as.tac'></span>

<h3>Description</h3>

<p>tac objects can be created from data.frame objects with 'as.tac()'. The time 
and activity units must be specified as arguments if not already set as 
attributes in the data.frame. The columns of the data frame are the regional
time activity curves, with the column names the names of the ROIs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.tac(x, time_unit = NULL, activity_unit = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.tac_+3A_x">x</code></td>
<td>
<p>data.frame with start, end time and tac data</p>
</td></tr>
<tr><td><code id="as.tac_+3A_time_unit">time_unit</code></td>
<td>
<p>NULL if in data.frame or set to &quot;seconds&quot; or &quot;minutes&quot;</p>
</td></tr>
<tr><td><code id="as.tac_+3A_activity_unit">activity_unit</code></td>
<td>
<p>NULL if in data.frame or set to &quot;kBq/cc&quot;, &quot;Bq/cc&quot;, 
&quot;nCi/cc&quot;</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the time_unit and activity_unit attributes are already in the data.frame,
they do not need to be set again, but otherwise they will need to be
specified in the input parameters.
</p>


<h3>Value</h3>

<p>tac object
</p>


<h3>See Also</h3>

<p>Other Loading functions: 
<code><a href="#topic+load_tac">load_tac</a>()</code>,
<code><a href="#topic+load_voistat">load_voistat</a>()</code>,
<code><a href="#topic+load_vol">load_vol</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>manual &lt;- data.frame(start=c(0:4), end=c(2:6), 
                     ROI1=c(10.1:14.2), ROI2=c(11:15))
manual_tac &lt;- as.tac(manual, time_unit="minutes", activity_unit="kBq/cc")
</code></pre>

<hr>
<h2 id='batch_load'>Load (+/- merge) ROIs for batch of participants</h2><span id='topic+batch_load'></span>

<h3>Description</h3>

<p>For a vector of participant IDs and correspondingly named tac files,
this loads the tac files. If roi_m = T, then can also merge ROIs into 
larger ROIs based on the optional parameters that follow.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>batch_load(
  participants,
  dir = "",
  tac_file_suffix = ".tac",
  tac_format = "PMOD",
  roi_m = FALSE,
  PVC = NULL,
  vol_file_suffix = NULL,
  vol_format = NULL,
  merge = NULL,
  ROI_def = NULL,
  tracer_dose = NULL,
  dose_unit = NULL,
  weight_kg = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="batch_load_+3A_participants">participants</code></td>
<td>
<p>A vector of participant IDs</p>
</td></tr>
<tr><td><code id="batch_load_+3A_dir">dir</code></td>
<td>
<p>A directory and/or file name prefix for the tac/volume files</p>
</td></tr>
<tr><td><code id="batch_load_+3A_tac_file_suffix">tac_file_suffix</code></td>
<td>
<p>How participant IDs corresponds to the TAC files</p>
</td></tr>
<tr><td><code id="batch_load_+3A_tac_format">tac_format</code></td>
<td>
<p>Format of tac files provided: See load_tac()</p>
</td></tr>
<tr><td><code id="batch_load_+3A_roi_m">roi_m</code></td>
<td>
<p>TRUE if you want to merge atomic ROIs into larger ROIs (and if 
not, the following parameters are not used)</p>
</td></tr>
<tr><td><code id="batch_load_+3A_pvc">PVC</code></td>
<td>
<p>For PVC, true where the data is stored as _C in same tac file</p>
</td></tr>
<tr><td><code id="batch_load_+3A_vol_file_suffix">vol_file_suffix</code></td>
<td>
<p>How participant IDs correspond to volume files</p>
</td></tr>
<tr><td><code id="batch_load_+3A_vol_format">vol_format</code></td>
<td>
<p>The file format that includes volumes: See load_vol()</p>
</td></tr>
<tr><td><code id="batch_load_+3A_merge">merge</code></td>
<td>
<p>Passes value to tac_roi(); T to also incl. original atomic ROIs</p>
</td></tr>
<tr><td><code id="batch_load_+3A_roi_def">ROI_def</code></td>
<td>
<p>Object that defines combined ROIs, see ROI_definitions.R</p>
</td></tr>
<tr><td><code id="batch_load_+3A_tracer_dose">tracer_dose</code></td>
<td>
<p>optionally, a vector of tracer doses (in the same order as
participants), for SUV</p>
</td></tr>
<tr><td><code id="batch_load_+3A_dose_unit">dose_unit</code></td>
<td>
<p>if tracer_dose is specified, note the unit (e.g &quot;MBq&quot;)</p>
</td></tr>
<tr><td><code id="batch_load_+3A_weight_kg">weight_kg</code></td>
<td>
<p>optionally, a vector of participant weights in kg, for SUV</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See load_tac() for specifics.
</p>


<h3>Value</h3>

<p>A list of data.frames, each is a participant's TACs
</p>


<h3>See Also</h3>

<p>Other Batch functions: 
<code><a href="#topic+batch_tm">batch_tm</a>()</code>,
<code><a href="#topic+batch_voistat">batch_voistat</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># For the working example, the participants are full filenames.
participants &lt;- c(system.file("extdata", "AD06.tac", package="tacmagic"),
                  system.file("extdata", "AD07.tac", package="tacmagic"),
                  system.file("extdata", "AD08.tac", package="tacmagic"))

tacs &lt;- batch_load(participants, tac_file_suffix="")
</code></pre>

<hr>
<h2 id='batch_tm'>Calculate one or more models for a batch of participants</h2><span id='topic+batch_tm'></span>

<h3>Description</h3>

<p>For a list of tac data (from load_batch) this calculates specified models
and saves in a tidy data.frame. Current model options are &quot;SUVR&quot;, &quot;Logan&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>batch_tm(all_tacs, models, custom_model = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="batch_tm_+3A_all_tacs">all_tacs</code></td>
<td>
<p>A list by participant, of tac data (load_batch())</p>
</td></tr>
<tr><td><code id="batch_tm_+3A_models">models</code></td>
<td>
<p>A vector of names of the models to calculate</p>
</td></tr>
<tr><td><code id="batch_tm_+3A_custom_model">custom_model</code></td>
<td>
<p>A function that can be run like other models (advanced)</p>
</td></tr>
<tr><td><code id="batch_tm_+3A_...">...</code></td>
<td>
<p>The arguments that get passed to the specified models/custom model,
many are required; please check with model desired.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For further details about how the models are calculated, see the individual
functions that they rely on. &quot;SUVR&quot; uses suvr(), &quot;Logan&quot; uses
DVR_all_ref_Logan().
</p>


<h3>Value</h3>

<p>A table of SUVR values for the specified ROIs for all participants
</p>


<h3>See Also</h3>

<p>Other Batch functions: 
<code><a href="#topic+batch_load">batch_load</a>()</code>,
<code><a href="#topic+batch_voistat">batch_voistat</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>participants &lt;- c(system.file("extdata", "AD06.tac", package="tacmagic"),
                  system.file("extdata", "AD07.tac", package="tacmagic"),
                  system.file("extdata", "AD08.tac", package="tacmagic"))

tacs &lt;- batch_load(participants, tac_file_suffix="")

# Keeps only the ROIs without partial-volume correction (PMOD convention)
tacs &lt;- lapply(tacs, split_pvc, FALSE)

batch &lt;- batch_tm(tacs, models=c("SUVR", "Logan"), ref="Cerebellum_r",
                  SUVR_def=c(3000,3300,3600), k2prime=0.2, t_star=23)

</code></pre>

<hr>
<h2 id='batch_voistat'>Obtain values from voistat files (using load_voistat() for a batch.</h2><span id='topic+batch_voistat'></span>

<h3>Description</h3>

<p>For a vector of participant IDs and correspondingly named .voistat files,
this extracts the value from the files for the specified ROIs.
participants can also be a vector of filenames, in which case set dir=&quot;&quot; and
filesuffix=&quot;&quot;, as in the example.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>batch_voistat(
  participants,
  ROI_def,
  dir = "",
  filesuffix = ".voistat",
  varname = "VALUE"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="batch_voistat_+3A_participants">participants</code></td>
<td>
<p>A vector of participant IDs</p>
</td></tr>
<tr><td><code id="batch_voistat_+3A_roi_def">ROI_def</code></td>
<td>
<p>Object that defines combined ROIs, see ROI_definitions.R</p>
</td></tr>
<tr><td><code id="batch_voistat_+3A_dir">dir</code></td>
<td>
<p>Directory and/or filename prefix of the files</p>
</td></tr>
<tr><td><code id="batch_voistat_+3A_filesuffix">filesuffix</code></td>
<td>
<p>Optional filename characters between ID and &quot;.voistat&quot;</p>
</td></tr>
<tr><td><code id="batch_voistat_+3A_varname">varname</code></td>
<td>
<p>The name of the variable being extracted, e.g. &quot;SRTM&quot;</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See load_voistat() for specifics.
</p>


<h3>Value</h3>

<p>A table of values for the specified ROIs for all participants
</p>


<h3>See Also</h3>

<p>Other Batch functions: 
<code><a href="#topic+batch_load">batch_load</a>()</code>,
<code><a href="#topic+batch_tm">batch_tm</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>participants &lt;- c(system.file("extdata", "AD06_BPnd_BPnd_Logan.voistat", 
                              package="tacmagic"),
                   system.file("extdata", "AD07_BPnd_BPnd_Logan.voistat", 
                               package="tacmagic"),
                   system.file("extdata", "AD08_BPnd_BPnd_Logan.voistat", 
                               package="tacmagic"))

batchtest &lt;- batch_voistat(participants=participants, ROI_def=roi_ham_pib(), 
                           dir="", filesuffix="", varname="Logan") 

</code></pre>

<hr>
<h2 id='change_units'>Convert radioactivity units</h2><span id='topic+change_units'></span>

<h3>Description</h3>

<p>Change the radioactivity units of a tac or numeric object to the specified
desired units (e.g. Bq, kBq, MBq, nCi, uCi, mCi, Ci). For convenience, if the
unit is per volume (&quot;x/cc&quot; or &quot;x/mL&quot;), the &quot;/cc&quot; part is ignored for the 
conversion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>change_units(x, to_unit, from_unit)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="change_units_+3A_x">x</code></td>
<td>
<p>time-activity curve or numeric object</p>
</td></tr>
<tr><td><code id="change_units_+3A_to_unit">to_unit</code></td>
<td>
<p>the desired unit (e.g. &quot;kBq&quot;)</p>
</td></tr>
<tr><td><code id="change_units_+3A_from_unit">from_unit</code></td>
<td>
<p>not used for tac object (it is in the tac object), but for 
numeric objects, must be specified (e.g. &quot;nCi&quot;)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the converted object, same type as x
</p>


<h3>Examples</h3>

<pre><code class='language-R'>f &lt;- system.file("extdata", "AD06.tac", package="tacmagic")
AD06_tac &lt;- load_tac(f, format="PMOD")
AD06_tac_nCicc &lt;- change_units(AD06_tac, to_unit = "nCi/cc")

change_units(5, to_unit = "kBq", from_unit = "nCi")
change_units(0.185, to_unit = "nCi", from_unit = "kBq")
</code></pre>

<hr>
<h2 id='cutoff_aiz'>Cutoff value calculation using method described in Aizenstein et al. 2008</h2><span id='topic+cutoff_aiz'></span>

<h3>Description</h3>

<p>See the reference below and the tacmagic walkthrough vignette. Aizenstein et
al. (2008) proposed a standardized method of calculating Pittsburgh Compound
B (PIB) cutoff values to classify participants as PIB+ or PIB-. They used the
distribution volume ratio (DVR) from several ROIs associated with amyloid 
deposition. The steps are summarized below. cutoff_aiz() implements 1-3,
returning cutoff values for each ROI. It can be used to dichotomize
participants, with pos_anyroi().
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cutoff_aiz(modelstats, ROIs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cutoff_aiz_+3A_modelstats">modelstats</code></td>
<td>
<p>SUVR or DVR data for group of participants from batch_tm()</p>
</td></tr>
<tr><td><code id="cutoff_aiz_+3A_rois">ROIs</code></td>
<td>
<p>list of variables (ROIs) to use for cutoff detection</p>
</td></tr>
</table>


<h3>Details</h3>

<p>1. Remove outliers from a group of cognitively normal individuals. An outlier
is defined as having any ROI with DVR &gt; upper inner fence of that ROI (= 3rd
quartile + (1.5 * IQR).
2. Iterate step 1 as needed until there are no more outlying participants.
3. From this subset of the group with outliers removed, the cutoff value for 
each ROI is set as the upper inner fence. 
4. For all participants, if there is any ROI above the cutoff for that 
region, then the participant is deemed to be PIB+.
</p>


<h3>Value</h3>

<p>Cutoff values for each ROI based on the above method
</p>


<h3>References</h3>

<p>Aizenstein HJ, Nebes RD, Saxton JA, et al. 2008. Frequent amyloid 
deposition without significant cognitive impairment among the elderly. 
Arch Neurol 65: 1509-1517.
</p>


<h3>See Also</h3>

<p>Other Cutoff functions: 
<code><a href="#topic+pos_anyroi">pos_anyroi</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cutoff_aiz(fake_DVR, c("ROI1_DVR", "ROI2_DVR", "ROI3_DVR", "ROI4_DVR"))
</code></pre>

<hr>
<h2 id='dvr'>Distribution volume ratio (DVR) for one or more ROIs</h2><span id='topic+dvr'></span>

<h3>Description</h3>

<p>This calculates the DVR using the non-invasive reference Logan method for
all TACs in a supplied tac file. It uses DVR_ref_Logan if a target ROI is 
specified, otherwise will calculate DVR for all ROIs with DVR_ref_all_Logan()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dvr(
  tac,
  model = "logan",
  target = NULL,
  ref,
  k2prime,
  t_star,
  error = 0.1,
  method = "trapz"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dvr_+3A_tac">tac</code></td>
<td>
<p>The time-activity curve data from load_tac() or tac_roi()</p>
</td></tr>
<tr><td><code id="dvr_+3A_model">model</code></td>
<td>
<p>Only model currently available is &quot;logan&quot;</p>
</td></tr>
<tr><td><code id="dvr_+3A_target">target</code></td>
<td>
<p>Optional - otherwise will calculate DVR for all regions</p>
</td></tr>
<tr><td><code id="dvr_+3A_ref">ref</code></td>
<td>
<p>Required &ndash; The reference region, e.g. &quot;cerebellum&quot;</p>
</td></tr>
<tr><td><code id="dvr_+3A_k2prime">k2prime</code></td>
<td>
<p>Required &ndash; A fixed value for k2' must be specified (e.g. 0.2)</p>
</td></tr>
<tr><td><code id="dvr_+3A_t_star">t_star</code></td>
<td>
<p>Required &ndash; If 0, t* will be calculated using find_t_star()</p>
</td></tr>
<tr><td><code id="dvr_+3A_error">error</code></td>
<td>
<p>For find_t_star()</p>
</td></tr>
<tr><td><code id="dvr_+3A_method">method</code></td>
<td>
<p>Method of integration, &quot;trapz&quot; or &quot;integrate&quot;</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For other model parameters, directly call DVR_ref_Logan().
</p>


<h3>Value</h3>

<p>Data frame with calculated DVRs
</p>


<h3>References</h3>

<p>Logan, J., Fowler, J. S., Volkow, N. D., Wang, G.-J., 
Ding, Y.-S., &amp; Alexoff, D. L. (1996). Distribution Volume Ratios without 
Blood Sampling from Graphical Analysis of PET Data. Journal of Cerebral 
Blood Flow &amp; Metabolism, 16(5), 834-840. 
https://doi.org/10.1097/00004647-199609000-00008
</p>


<h3>See Also</h3>

<p>Other Logan plot functions: 
<code><a href="#topic+DVR_all_ref_Logan">DVR_all_ref_Logan</a>()</code>,
<code><a href="#topic+DVR_ref_Logan">DVR_ref_Logan</a>()</code>,
<code><a href="#topic+plot.ref_Logan">plot.ref_Logan</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>f &lt;- system.file("extdata", "AD06.tac", package="tacmagic")
fv &lt;- system.file("extdata", "AD06_TAC.voistat", package="tacmagic")
AD06_tac &lt;- load_tac(f, format="PMOD")
AD06_volume &lt;- load_vol(fv, format="voistat")
AD06 &lt;- tac_roi(tac=AD06_tac, volumes=AD06_volume, ROI_def=roi_ham_pib(),  
                merge=FALSE, PVC=FALSE)  

AD06_DVRs &lt;- dvr(AD06, ref="cerebellum", k2prime=0.2, t_star=23)

AD06_DVR &lt;- dvr(AD06, target="frontal", ref="cerebellum", 
             k2prime=0.2, t_star=23)
</code></pre>

<hr>
<h2 id='DVR_all_ref_Logan'>Non-invasive reference Logan method for all ROIs in tac data</h2><span id='topic+DVR_all_ref_Logan'></span>

<h3>Description</h3>

<p>This calculates the DVR using the non-invasive reference Logan method for
all TACs in a supplied tac file. It uses DVR_ref_Logan.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DVR_all_ref_Logan(
  tac_data,
  ref,
  k2prime,
  t_star,
  error = 0.1,
  method = "trapz",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DVR_all_ref_Logan_+3A_tac_data">tac_data</code></td>
<td>
<p>The time-activity curve data from tac_roi()</p>
</td></tr>
<tr><td><code id="DVR_all_ref_Logan_+3A_ref">ref</code></td>
<td>
<p>Required &ndash; The reference region, e.g. &quot;cerebellum&quot;</p>
</td></tr>
<tr><td><code id="DVR_all_ref_Logan_+3A_k2prime">k2prime</code></td>
<td>
<p>Required &ndash; A fixed value for k2' must be specified (e.g. 0.2)</p>
</td></tr>
<tr><td><code id="DVR_all_ref_Logan_+3A_t_star">t_star</code></td>
<td>
<p>Required &ndash; If 0, t* will be calculated using find_t_star()</p>
</td></tr>
<tr><td><code id="DVR_all_ref_Logan_+3A_error">error</code></td>
<td>
<p>For find_t_star()</p>
</td></tr>
<tr><td><code id="DVR_all_ref_Logan_+3A_method">method</code></td>
<td>
<p>Method of integration, &quot;trapz&quot; or &quot;integrate&quot;</p>
</td></tr>
<tr><td><code id="DVR_all_ref_Logan_+3A_...">...</code></td>
<td>
<p>When called from tm_batch, unused parameters may be supplied</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame with calculated DVRs for all ROIs
</p>


<h3>References</h3>

<p>Logan, J., Fowler, J. S., Volkow, N. D., Wang, G.-J., 
Ding, Y.-S., &amp; Alexoff, D. L. (1996). Distribution Volume Ratios without 
Blood Sampling from Graphical Analysis of PET Data. Journal of Cerebral 
Blood Flow &amp; Metabolism, 16(5), 834-840. 
https://doi.org/10.1097/00004647-199609000-00008
</p>


<h3>See Also</h3>

<p>Other Logan plot functions: 
<code><a href="#topic+DVR_ref_Logan">DVR_ref_Logan</a>()</code>,
<code><a href="#topic+dvr">dvr</a>()</code>,
<code><a href="#topic+plot.ref_Logan">plot.ref_Logan</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>f &lt;- system.file("extdata", "AD06.tac", package="tacmagic")
fv &lt;- system.file("extdata", "AD06_TAC.voistat", package="tacmagic")
AD06_tac &lt;- load_tac(f, format="PMOD")
AD06_volume &lt;- load_vol(fv, format="voistat")
AD06 &lt;- tac_roi(tac=AD06_tac, volumes=AD06_volume, ROI_def=roi_ham_pib(),  
                merge=FALSE, PVC=FALSE)  

AD06_DVR &lt;- DVR_all_ref_Logan(AD06, ref="cerebellum", k2prime=0.2, t_star=23)

</code></pre>

<hr>
<h2 id='DVR_ref_Logan'>Non-invasive reference Logan method</h2><span id='topic+DVR_ref_Logan'></span>

<h3>Description</h3>

<p>This calculates the coefficient from the non-invasive Logan method, which
is equal to DVR. Works for a single tac (target).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DVR_ref_Logan(
  tac_data,
  target,
  ref,
  k2prime,
  t_star,
  error = 0.1,
  method = "trapz"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DVR_ref_Logan_+3A_tac_data">tac_data</code></td>
<td>
<p>The time-activity curve data from tac_roi()</p>
</td></tr>
<tr><td><code id="DVR_ref_Logan_+3A_target">target</code></td>
<td>
<p>The name of the target ROI, e.g. &quot;frontal&quot;</p>
</td></tr>
<tr><td><code id="DVR_ref_Logan_+3A_ref">ref</code></td>
<td>
<p>The reference region, e.g. &quot;cerebellum&quot;</p>
</td></tr>
<tr><td><code id="DVR_ref_Logan_+3A_k2prime">k2prime</code></td>
<td>
<p>A fixed value for k2' must be specified (e.g. 0.2)</p>
</td></tr>
<tr><td><code id="DVR_ref_Logan_+3A_t_star">t_star</code></td>
<td>
<p>If 0, t* will be calculated using find_t_star()</p>
</td></tr>
<tr><td><code id="DVR_ref_Logan_+3A_error">error</code></td>
<td>
<p>For find_t_star()</p>
</td></tr>
<tr><td><code id="DVR_ref_Logan_+3A_method">method</code></td>
<td>
<p>Method of integration, &quot;trapz&quot; or &quot;integrate&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame with calculate DVRs for all ROIs
</p>


<h3>References</h3>

<p>Logan, J., Fowler, J. S., Volkow, N. D., Wang, G.-J., 
Ding, Y.-S., &amp; Alexoff, D. L. (1996). Distribution Volume Ratios without 
Blood Sampling from Graphical Analysis of PET Data. Journal of Cerebral 
Blood Flow &amp; Metabolism, 16(5), 834-840. 
https://doi.org/10.1097/00004647-199609000-00008
</p>


<h3>See Also</h3>

<p>Other Logan plot functions: 
<code><a href="#topic+DVR_all_ref_Logan">DVR_all_ref_Logan</a>()</code>,
<code><a href="#topic+dvr">dvr</a>()</code>,
<code><a href="#topic+plot.ref_Logan">plot.ref_Logan</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>f &lt;- system.file("extdata", "AD06.tac", package="tacmagic")
fv &lt;- system.file("extdata", "AD06_TAC.voistat", package="tacmagic")
AD06_tac &lt;- load_tac(f, format="PMOD")
AD06_volume &lt;- load_vol(fv, format="voistat")
AD06 &lt;- tac_roi(tac=AD06_tac, volumes=AD06_volume, ROI_def=roi_ham_pib(),  
                merge=FALSE, PVC=FALSE)                             
               
AD06_DVR_fr &lt;- DVR_ref_Logan(AD06, target="frontal", ref="cerebellum",
                             k2prime=0.2, t_star=0) 
                            
</code></pre>

<hr>
<h2 id='fake_DVR'>Fake DVR data for vignette and package testing</h2><span id='topic+fake_DVR'></span>

<h3>Description</h3>

<p>A fake dataset of 50 simulated participants in the format that the function
tm_batch() would be expected to produce with the &quot;Logan&quot; model specified.
The data itself was generated as follows: <br /> <br />
#higher &lt;- matrix(rnorm(40, 1.9, 0.6), ncol=4, nrow=10) <br />
#lower &lt;- matrix(rnorm(160, 1.3, 0.3), ncol=4, nrow=40) <br />
#fake_data &lt;- as.data.frame(rbind(higher, lower)) <br />
#row.names(fake_data) &lt;- paste0(&quot;p&quot;, 1:50) <br /> 
#colnames(fake_data) &lt;- c(&quot;ROI1_DVR&quot;, &quot;ROI2_DVR&quot;, &quot;ROI3_DVR&quot;, &quot;ROI4_DVR&quot;)<br />
#save(fake_data, &quot;fake_DVR.Rda&quot;) <br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fake_DVR
</code></pre>


<h3>Format</h3>

<p>A data frame with 50 rows and 4 variables representing ROIs
</p>

<hr>
<h2 id='load_tac'>Loads TAC from file for use by other functions (default is PMOD .tac format)</h2><span id='topic+load_tac'></span>

<h3>Description</h3>

<p>This is the main function for loading an individual participant's TAC data.
The minimal required information within the supplied files is the start and 
stop times and a time unit (either seconds or minutes), as well as the 
activity values for 1 or more ROIs, and units for activity. The currently 
supported formats (with the corresponding format argument), include:
</p>

<ul>
<li><p> &quot;PMOD&quot;: PMOD .tac files
</p>
</li>
<li><p> &quot;voistat&quot;: PMOD TAC .voistat files used in combination with PMOD 
.acqtimes file for start/stop times.
</p>
</li>
<li><p> &quot;magia&quot;: magia pipeline .mat tac file
</p>
</li>
<li><p> &quot;DFT&quot;: Turku PET Centre's DFT format
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>load_tac(
  filename,
  format = "PMOD",
  acqtimes = NULL,
  time_unit = NULL,
  activity_unit = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="load_tac_+3A_filename">filename</code></td>
<td>
<p>(e.g. &quot;participant01.tac&quot;)</p>
</td></tr>
<tr><td><code id="load_tac_+3A_format">format</code></td>
<td>
<p>A character string, with options listed above (e.g. &quot;PMOD&quot;)</p>
</td></tr>
<tr><td><code id="load_tac_+3A_acqtimes">acqtimes</code></td>
<td>
<p>Filename for a .acqtimes file (as in PMOD), required for 
format=&quot;voistat&quot;</p>
</td></tr>
<tr><td><code id="load_tac_+3A_time_unit">time_unit</code></td>
<td>
<p>NULL if in file (e.g. PMOD .tac), or set to &quot;seconds&quot; or 
&quot;minutes&quot; if not in file or to override file</p>
</td></tr>
<tr><td><code id="load_tac_+3A_activity_unit">activity_unit</code></td>
<td>
<p>NULL if in file (e.g. PMOD .tac), or set to &quot;kBq/cc&quot;, 
&quot;Bq/cc&quot;, &quot;nCi/cc&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>tac object
</p>


<h3>See Also</h3>

<p>Other Loading functions: 
<code><a href="#topic+as.tac">as.tac</a>()</code>,
<code><a href="#topic+load_voistat">load_voistat</a>()</code>,
<code><a href="#topic+load_vol">load_vol</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>f_raw_tac &lt;- system.file("extdata", "AD06.tac", package="tacmagic") 
tac &lt;- load_tac(f_raw_tac)

</code></pre>

<hr>
<h2 id='load_voistat'>Reads PMOD .voistat files and optionally merges volume-weighted ROIs</h2><span id='topic+load_voistat'></span>

<h3>Description</h3>

<p>PMOD can produce .voistat files with the average model values by ROI for 
its voxelwise binding potential (BPnd) models, such as Logan, SRTM, etc.
This function reads the .voistat file and returns a data.frame with the
ROI as rows and the model value as the column. Optionally, the ROIs can be
combined into larger ROIs if ROI_def is specified, just as with TAC loading.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>load_voistat(filename, ROI_def = NULL, model = "VALUE")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="load_voistat_+3A_filename">filename</code></td>
<td>
<p>(e.g. participant_logan.voistat)</p>
</td></tr>
<tr><td><code id="load_voistat_+3A_roi_def">ROI_def</code></td>
<td>
<p>Optional ROI definitions to combine ROIs (e.g. roi_ham_pib())</p>
</td></tr>
<tr><td><code id="load_voistat_+3A_model">model</code></td>
<td>
<p>A string to name the variable being extracted, e.g. &quot;Logan_DVR&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.frame with loaded model data in specified combined weighted ROIs
</p>


<h3>See Also</h3>

<p>Other Loading functions: 
<code><a href="#topic+as.tac">as.tac</a>()</code>,
<code><a href="#topic+load_tac">load_tac</a>()</code>,
<code><a href="#topic+load_vol">load_vol</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>f &lt;- system.file("extdata", "AD06_BPnd_BPnd_Logan.voistat", 
                 package="tacmagic")
vs &lt;- load_voistat(f, ROI_def=roi_ham_pib(), model="Logan")
</code></pre>

<hr>
<h2 id='load_vol'>Loads ROI volumes from file for use by other functions</h2><span id='topic+load_vol'></span>

<h3>Description</h3>

<p>Loads ROI volumes from file for use by other functions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>load_vol(filename, format = "voistat")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="load_vol_+3A_filename">filename</code></td>
<td>
<p>(e.g. participant.voistat)</p>
</td></tr>
<tr><td><code id="load_vol_+3A_format">format</code></td>
<td>
<p>(default is the TAC .voistat format from PMOD, also accepts 
&quot;DFT and &quot;BPndPaste&quot;)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.frame with loaded TAC data
</p>


<h3>See Also</h3>

<p>Other Loading functions: 
<code><a href="#topic+as.tac">as.tac</a>()</code>,
<code><a href="#topic+load_tac">load_tac</a>()</code>,
<code><a href="#topic+load_voistat">load_voistat</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>f_raw_vol &lt;- system.file("extdata", "AD06_TAC.voistat", package="tacmagic")

vol &lt;- load_vol(f_raw_vol)
</code></pre>

<hr>
<h2 id='plot.ref_Logan'>Non-invasive reference Logan plot</h2><span id='topic+plot.ref_Logan'></span>

<h3>Description</h3>

<p>This plots the non-invasive Logan plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ref_Logan'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.ref_Logan_+3A_x">x</code></td>
<td>
<p>Reference Logan model data object from DVR_ref_Logan()</p>
</td></tr>
<tr><td><code id="plot.ref_Logan_+3A_...">...</code></td>
<td>
<p>Additional parameters than can be passed to plotting function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return
f &lt;- system.file(&quot;extdata&quot;, &quot;AD06.tac&quot;, package=&quot;tacmagic&quot;)
fv &lt;- system.file(&quot;extdata&quot;, &quot;AD06_TAC.voistat&quot;, package=&quot;tacmagic&quot;)
AD06_tac &lt;- load_tac(f, format=&quot;PMOD&quot;)
AD06_volume &lt;- load_vol(fv, format=&quot;voistat&quot;)
AD06 &lt;- tac_roi(tac=AD06_tac, volumes=AD06_volume, ROI_def=roi_ham_pib(),  
merge=FALSE, PVC=FALSE)  
AD06_DVR_fr &lt;- DVR_ref_Logan(AD06, target=&quot;frontal&quot;, ref=&quot;cerebellum&quot;,
k2prime=0.2, t_star=0) 
plot(AD06_DVR_fr)
</p>


<h3>See Also</h3>

<p>Other Logan plot functions: 
<code><a href="#topic+DVR_all_ref_Logan">DVR_all_ref_Logan</a>()</code>,
<code><a href="#topic+DVR_ref_Logan">DVR_ref_Logan</a>()</code>,
<code><a href="#topic+dvr">dvr</a>()</code>
</p>

<hr>
<h2 id='plot.tac'>Plots time activity curves from 1 or 2 participants or groups.</h2><span id='topic+plot.tac'></span>

<h3>Description</h3>

<p>Plots time activity curves from 1 or 2 participants or groups.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'tac'
plot(
  x,
  tac2 = NULL,
  ROIs,
  ymax = 25,
  time = "minutes",
  title = "",
  colors = rainbow,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.tac_+3A_x">x</code></td>
<td>
<p>A tac object containing time-activity curves to plot, e.g. from 
tac_roi() or load_tac()</p>
</td></tr>
<tr><td><code id="plot.tac_+3A_tac2">tac2</code></td>
<td>
<p>An optional, second TAC, to plot for comparison</p>
</td></tr>
<tr><td><code id="plot.tac_+3A_rois">ROIs</code></td>
<td>
<p>A vector of ROIs to plot, names matching the TAC headers</p>
</td></tr>
<tr><td><code id="plot.tac_+3A_ymax">ymax</code></td>
<td>
<p>The maximum value on the y-axis</p>
</td></tr>
<tr><td><code id="plot.tac_+3A_time">time</code></td>
<td>
<p>&quot;seconds&quot; or &quot;minutes&quot; depending on desired x-axis, converts tac</p>
</td></tr>
<tr><td><code id="plot.tac_+3A_title">title</code></td>
<td>
<p>A title for the plot</p>
</td></tr>
<tr><td><code id="plot.tac_+3A_colors">colors</code></td>
<td>
<p>If null, rainbow palette is used, otherwise another palette can
be specified (heat.colors, terrain.colors, topo.colors, cm.colors</p>
</td></tr>
<tr><td><code id="plot.tac_+3A_...">...</code></td>
<td>
<p>Additional arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Creates a plot
</p>


<h3>See Also</h3>

<p>Other tac functions: 
<code><a href="#topic+save_tac">save_tac</a>()</code>,
<code><a href="#topic+split_pvc">split_pvc</a>()</code>,
<code><a href="#topic+tac_roi">tac_roi</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># f_raw_tac and f_raw_vol are the filenames of PMOD-generated files
f_raw_tac &lt;- system.file("extdata", "AD06.tac", package="tacmagic") 
f_raw_vol &lt;- system.file("extdata", "AD06_TAC.voistat", package="tacmagic")

tac &lt;- load_tac(f_raw_tac)
vol &lt;- load_vol(f_raw_vol)
AD06_tac_nc &lt;- tac_roi(tac, vol, roi_ham_full(), merge=FALSE, PVC=FALSE)
plot(AD06_tac_nc, ROIs=c("frontal", "cerebellum"), title="Example Plot")
</code></pre>

<hr>
<h2 id='pos_anyroi'>Dichotomize participants based on ROI cutoff values</h2><span id='topic+pos_anyroi'></span>

<h3>Description</h3>

<p>Aizenstein et al. (2008) proposed a standardized method of calculating PIB+ 
cutoff values to classify participants as PIB+ or PIB-. They used the DVR 
from 7 ROIs associated with amyloid deposition. This function takes the 
ROI-based cutoff values, e.g. from cutoff_aiz(), and returns a table 
specifying which participants are positive, i.e. which have at least one ROI
greater than the cutoff.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pos_anyroi(modelstats, cutoff)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pos_anyroi_+3A_modelstats">modelstats</code></td>
<td>
<p>SUVR or DVR data for group of participants from batch_tm()</p>
</td></tr>
<tr><td><code id="pos_anyroi_+3A_cutoff">cutoff</code></td>
<td>
<p>cutoffs for ROIs as from cutoff_aiz()</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.frame of participants and positive/negative status
</p>


<h3>References</h3>

<p>Aizenstein HJ, Nebes RD, Saxton JA, et al. 2008. Frequent amyloid 
deposition without significant cognitive impairment among the elderly. 
Arch Neurol 65: 1509-1517.
</p>


<h3>See Also</h3>

<p>Other Cutoff functions: 
<code><a href="#topic+cutoff_aiz">cutoff_aiz</a>()</code>
</p>

<hr>
<h2 id='roi_AAL_full'>Return a list of merged ROIs made up of the atomic ROIs in the AAL atlas.
The groupings for major lobes are as described in the PMOD documentation.</h2><span id='topic+roi_AAL_full'></span>

<h3>Description</h3>

<p>Return a list of merged ROIs made up of the atomic ROIs in the AAL atlas.
The groupings for major lobes are as described in the PMOD documentation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>roi_AAL_full()
</code></pre>


<h3>Value</h3>

<p>A list of lists, where each list is an ROI (e.g.) frontal lobe that
specifies the atomic ROIs from the atlas that make it up.
</p>


<h3>References</h3>

<p>PMOD Groupings of the AAL Atlas.
</p>
<p>Automated Anatomical Labeling of Activations in SPM Using a Macroscopic Anatomical Parcellation of the MNI MRI Single-Subject Brain. N. Tzourio-Mazoyer, B. Landeau, D. Papathanassiou, F. Crivello, O. Ã‰tard, N. Delcroix, B. Mazoyer, and M. Joliot. NeuroImage 2002, 15 :273-289 &lt;doi:10.1006/nimg.2001.0978&gt;
</p>


<h3>See Also</h3>

<p>Other ROI definitions: 
<code><a href="#topic+roi_ham_full">roi_ham_full</a>()</code>,
<code><a href="#topic+roi_ham_pib">roi_ham_pib</a>()</code>,
<code><a href="#topic+roi_ham_stand">roi_ham_stand</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>roi_AAL_full()
</code></pre>

<hr>
<h2 id='roi_ham_full'>Return a list of larger ROIs made up of the ROIs in the Hammer's atlas.</h2><span id='topic+roi_ham_full'></span>

<h3>Description</h3>

<p>This includes the cortical regions of roi_ham_stand() but also other regions.
It can be modified to suit the user's needs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>roi_ham_full()
</code></pre>


<h3>Value</h3>

<p>A list of lists, where each list is an ROI (e.g.) frontal lobe that 
specifies the atomic ROIs from the atlas that make it up.
</p>


<h3>References</h3>

<p>Hammers, Alexander, Richard Allom, Matthias J. Koepp, Samantha L. Free, 
Ralph Myers, Louis Lemieux, Tejal N. Mitchell, David J. Brooks, and John S. 
Duncan. 2003. Three-dimensional Maximum Probability Atlas of the Human 
Brain, with Particular Reference to the Temporal Lobe. Human Brain Mapping 
19 (4): 224-247. doi:10.1002/hbm.10123
</p>


<h3>See Also</h3>

<p>Other ROI definitions: 
<code><a href="#topic+roi_AAL_full">roi_AAL_full</a>()</code>,
<code><a href="#topic+roi_ham_pib">roi_ham_pib</a>()</code>,
<code><a href="#topic+roi_ham_stand">roi_ham_stand</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>roi_ham_full()
</code></pre>

<hr>
<h2 id='roi_ham_pib'>Return a list of merged ROIs made up of atomic ROIs in the Hammer's atlas.</h2><span id='topic+roi_ham_pib'></span>

<h3>Description</h3>

<p>This includes the ROIs from roi_ham_full and also the PIB cortical composite
ROI as defined in the PMOD documentation and as widely used in PIB studies.
See PMOD Neuro Tool (PNEURO) (Version 4.0) documentation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>roi_ham_pib()
</code></pre>


<h3>Value</h3>

<p>A list of lists, where each list is an ROI (e.g.) frontal lobe that 
specifies the atomic ROIs from the atlas that make it up.
</p>


<h3>References</h3>

<p>Hammers, Alexander, Richard Allom, Matthias J. Koepp, Samantha L. Free, 
Ralph Myers, Louis Lemieux, Tejal N. Mitchell, David J. Brooks, and John S. 
Duncan. 2003. Three-dimensional Maximum Probability Atlas of the Human 
Brain, with Particular Reference to the Temporal Lobe. Human Brain Mapping 
19 (4): 224-247. doi:10.1002/hbm.10123
</p>


<h3>See Also</h3>

<p>Other ROI definitions: 
<code><a href="#topic+roi_AAL_full">roi_AAL_full</a>()</code>,
<code><a href="#topic+roi_ham_full">roi_ham_full</a>()</code>,
<code><a href="#topic+roi_ham_stand">roi_ham_stand</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>roi_ham_pib()
</code></pre>

<hr>
<h2 id='roi_ham_stand'>Return a list of merged ROIs made up of the atomic ROIs in the Hammer's 
atlas.</h2><span id='topic+roi_ham_stand'></span>

<h3>Description</h3>

<p>Return a list of merged ROIs made up of the atomic ROIs in the Hammer's 
atlas.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>roi_ham_stand()
</code></pre>


<h3>Value</h3>

<p>A list of lists, where each list is an ROI (e.g.) frontal lobe that 
specifies the atomic ROIs from the atlas that make it up.
</p>


<h3>References</h3>

<p>Hammers, Alexander, Richard Allom, Matthias J. Koepp, Samantha L. Free, 
Ralph Myers, Louis Lemieux, Tejal N. Mitchell, David J. Brooks, and John S. 
Duncan. 2003. Three-dimensional Maximum Probability Atlas of the Human 
Brain, with Particular Reference to the Temporal Lobe. Human Brain Mapping 
19 (4): 224-247. doi:10.1002/hbm.10123
</p>


<h3>See Also</h3>

<p>Other ROI definitions: 
<code><a href="#topic+roi_AAL_full">roi_AAL_full</a>()</code>,
<code><a href="#topic+roi_ham_full">roi_ham_full</a>()</code>,
<code><a href="#topic+roi_ham_pib">roi_ham_pib</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>roi_ham_stand()
</code></pre>

<hr>
<h2 id='save_tac'>Save a tac object as a .tac file</h2><span id='topic+save_tac'></span>

<h3>Description</h3>

<p>Saves a tac object, created by load_tac(), tac_roi() or manually, and 
saves it as a PMOD-formatted tac file. Using the .tac extension in the 
file name is recommended.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>save_tac(tac, outfile)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="save_tac_+3A_tac">tac</code></td>
<td>
<p>The time-activity curve data, e.g. from load_tac() or tac_roi()</p>
</td></tr>
<tr><td><code id="save_tac_+3A_outfile">outfile</code></td>
<td>
<p>The output filename</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Does not return an object, only saves a file
</p>


<h3>See Also</h3>

<p>Other tac functions: 
<code><a href="#topic+plot.tac">plot.tac</a>()</code>,
<code><a href="#topic+split_pvc">split_pvc</a>()</code>,
<code><a href="#topic+tac_roi">tac_roi</a>()</code>
</p>

<hr>
<h2 id='split_pvc'>Subset PMOD tacs with or without PVC</h2><span id='topic+split_pvc'></span>

<h3>Description</h3>

<p>When partial volume correction (PVC) is used in PMOD, the saved tac files
have ROIs with and without PVC. When loaded with load_tac()) it may be 
desirable to keep only either the PVC or non-PVC tacs. This returns a tac 
object that is a subset of the input tac object with only the PVC or non-PVC
tacs. This relies on PMOD's convention of labelling tac columns with &quot;_C&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>split_pvc(tac, PVC = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="split_pvc_+3A_tac">tac</code></td>
<td>
<p>The time-activity curve data from loading function (PMOD)</p>
</td></tr>
<tr><td><code id="split_pvc_+3A_pvc">PVC</code></td>
<td>
<p>If TRUE, includes columns with &quot;_C&quot;, if FALSE, ones without &quot;_C&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Time-activity curve object
</p>


<h3>See Also</h3>

<p>Other tac functions: 
<code><a href="#topic+plot.tac">plot.tac</a>()</code>,
<code><a href="#topic+save_tac">save_tac</a>()</code>,
<code><a href="#topic+tac_roi">tac_roi</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># f_raw_tac and f_raw_vol are the filenames of PMOD-generated files
f_raw_tac &lt;- system.file("extdata", "AD06.tac", package="tacmagic") 

tac &lt;- load_tac(f_raw_tac)
tac_pvc &lt;- split_pvc(tac, TRUE)
tac_nc &lt;- split_pvc(tac, FALSE)
</code></pre>

<hr>
<h2 id='suv'>Calculate average SUV over time window, or maximum SUV</h2><span id='topic+suv'></span>

<h3>Description</h3>

<p>Calculate the standardized uptake value (SUV) from a tac object, the
participant's weight, and the tracer dose. These values may be in the tac
object or manually supplied. The weight must be in kg, and the tracer units
must be specified. The dose is converted to MBq, the tac is converted to
kBq/cc, and the final SUV units are thus in g/cc. Aside from the tac object,
the remaining parameters should be left NULL if the required data is in the
tac object attributes (as can be done with batch_load()).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>suv(tac, SUV_def, dose = NULL, dose_unit = NULL, weight_kg = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="suv_+3A_tac">tac</code></td>
<td>
<p>time-activity curve object (decay-corrected)</p>
</td></tr>
<tr><td><code id="suv_+3A_suv_def">SUV_def</code></td>
<td>
<p>vector of start times for window for SUV weighted average, or
alternatively, &quot;max&quot; for the maximum ROI SUV value</p>
</td></tr>
<tr><td><code id="suv_+3A_dose">dose</code></td>
<td>
<p>the injected tracer dose</p>
</td></tr>
<tr><td><code id="suv_+3A_dose_unit">dose_unit</code></td>
<td>
<p>unit of tracer dose (e.g. &quot;MBq&quot;, &quot;kBq&quot;, &quot;mCi&quot;...)</p>
</td></tr>
<tr><td><code id="suv_+3A_weight_kg">weight_kg</code></td>
<td>
<p>the participant's weight in kg</p>
</td></tr>
<tr><td><code id="suv_+3A_...">...</code></td>
<td>
<p>When called from tm_batch, unused parameters may be supplied</p>
</td></tr>
</table>


<h3>Value</h3>

<p>table of SUV values
</p>


<h3>See Also</h3>

<p>Other SUV functions: 
<code><a href="#topic+tac_suv">tac_suv</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>f &lt;- system.file("extdata", "AD06.tac", package="tacmagic")
fv &lt;- system.file("extdata", "AD06_TAC.voistat", package="tacmagic")
AD06_tac &lt;- load_tac(f, format="PMOD")
AD06_volume &lt;- load_vol(fv, format="voistat")
AD06 &lt;- tac_roi(tac=AD06_tac, volumes=AD06_volume, ROI_def=roi_ham_pib(),
                merge=FALSE, PVC=FALSE)
# dose and weight are fabricated for the example
AD06_suvmax &lt;- suv(AD06, "max", dose = 9.0, dose_unit = "mCi",
                     weight_kg = 70)
AD06_suv &lt;- suv(AD06, c(3000, 3300, 3600), dose = 9.0, dose_unit = "mCi",
                  weight_kg = 70)
</code></pre>

<hr>
<h2 id='suvr'>Calculate weighted SUVRs for specified regions of interest</h2><span id='topic+suvr'></span>

<h3>Description</h3>

<p>Calculate the standardized uptake value ratio (SUVR) for all ROIs in the
provided tac data, using the specified reference region.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>suvr(tac, SUVR_def, ref, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="suvr_+3A_tac">tac</code></td>
<td>
<p>The time-activity curve data from tac_roi()</p>
</td></tr>
<tr><td><code id="suvr_+3A_suvr_def">SUVR_def</code></td>
<td>
<p>a vector of start times for window to be used in SUVR</p>
</td></tr>
<tr><td><code id="suvr_+3A_ref">ref</code></td>
<td>
<p>a string, e.g. &quot;cerebellum&quot;, to specify reference region</p>
</td></tr>
<tr><td><code id="suvr_+3A_...">...</code></td>
<td>
<p>When called from tm_batch, unused parameters may be supplied</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame of SUVR values for the specified ROIs
</p>


<h3>See Also</h3>

<p>Other SUVR functions: 
<code><a href="#topic+suvr_auc">suvr_auc</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>f &lt;- system.file("extdata", "AD06.tac", package="tacmagic")
fv &lt;- system.file("extdata", "AD06_TAC.voistat", package="tacmagic")
AD06_tac &lt;- load_tac(f, format="PMOD")
AD06_volume &lt;- load_vol(fv, format="voistat")
AD06 &lt;- tac_roi(tac=AD06_tac, volumes=AD06_volume, ROI_def=roi_ham_pib(),  
                merge=FALSE, PVC=FALSE)

AD06_SUVR &lt;- suvr(AD06, SUVR_def=c(3000,3300,3600), ref="cerebellum")

</code></pre>

<hr>
<h2 id='suvr_auc'>Calculate SUVRs for regions of interest with AUC from mid-frame times</h2><span id='topic+suvr_auc'></span>

<h3>Description</h3>

<p>Calculate the standardized uptake value ratio (SUVR) for all ROIs in the
provided tac data, using the specified reference region. This is an 
alternate to suvr() which should provide very similar values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>suvr_auc(tac, SUVR_def, ref, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="suvr_auc_+3A_tac">tac</code></td>
<td>
<p>The time-activity curve data from tac_roi()</p>
</td></tr>
<tr><td><code id="suvr_auc_+3A_suvr_def">SUVR_def</code></td>
<td>
<p>a vector of start times for window to be used in SUVR</p>
</td></tr>
<tr><td><code id="suvr_auc_+3A_ref">ref</code></td>
<td>
<p>is a string, e.g. &quot;cerebellum&quot;, to specify reference region</p>
</td></tr>
<tr><td><code id="suvr_auc_+3A_...">...</code></td>
<td>
<p>When called from tm_batch, unused parameters may be supplied</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame of SUVR values for the specified ROIs
#' f &lt;- system.file(&quot;extdata&quot;, &quot;AD06.tac&quot;, package=&quot;tacmagic&quot;)
fv &lt;- system.file(&quot;extdata&quot;, &quot;AD06_TAC.voistat&quot;, package=&quot;tacmagic&quot;)
AD06_tac &lt;- load_tac(f, format=&quot;PMOD&quot;)
AD06_volume &lt;- load_vol(fv, format=&quot;voistat&quot;)
AD06 &lt;- tac_roi(tac=AD06_tac, volumes=AD06_volume, ROI_def=roi_ham_pib(),  
merge=FALSE, PVC=FALSE)
</p>
<p>AD06_SUVR &lt;- suvr_auc(AD06, SUVR_def=c(3000,3300,3600), ref=&quot;cerebellum&quot;)
</p>


<h3>See Also</h3>

<p>Other SUVR functions: 
<code><a href="#topic+suvr">suvr</a>()</code>
</p>

<hr>
<h2 id='tac_roi'>Calculate weighted time-activity curves for specified regions of interest</h2><span id='topic+tac_roi'></span>

<h3>Description</h3>

<p>Calculate weighted time-activity curves for specified regions of interest
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tac_roi(tac, volumes, ROI_def, merge, PVC)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tac_roi_+3A_tac">tac</code></td>
<td>
<p>The time-activity curve data from loading function</p>
</td></tr>
<tr><td><code id="tac_roi_+3A_volumes">volumes</code></td>
<td>
<p>The ROI volume data from loading function</p>
</td></tr>
<tr><td><code id="tac_roi_+3A_roi_def">ROI_def</code></td>
<td>
<p>The definition of ROIs by combining smaller ROIs from TAC file</p>
</td></tr>
<tr><td><code id="tac_roi_+3A_merge">merge</code></td>
<td>
<p>If TRUE, includes the original ROIs in the output data</p>
</td></tr>
<tr><td><code id="tac_roi_+3A_pvc">PVC</code></td>
<td>
<p>If TRUE, appends &quot;_C&quot; to ROI name header (as in PMOD TAC files)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Time-activity curves for the specified ROIs
</p>


<h3>See Also</h3>

<p>Other tac functions: 
<code><a href="#topic+plot.tac">plot.tac</a>()</code>,
<code><a href="#topic+save_tac">save_tac</a>()</code>,
<code><a href="#topic+split_pvc">split_pvc</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># f_raw_tac and f_raw_vol are the filenames of PMOD-generated files
f_raw_tac &lt;- system.file("extdata", "AD06.tac", package="tacmagic") 
f_raw_vol &lt;- system.file("extdata", "AD06_TAC.voistat", package="tacmagic")

tac &lt;- load_tac(f_raw_tac)
vol &lt;- load_vol(f_raw_vol)
AD06_tac_nc &lt;- tac_roi(tac, vol, roi_ham_full(), merge=FALSE, PVC=FALSE)
</code></pre>

<hr>
<h2 id='tac_suv'>Calculate SUV from TAC</h2><span id='topic+tac_suv'></span>

<h3>Description</h3>

<p>Calculate the standardized uptake value (SUV) time-activity curve from a tac
object, the participant's weight, and the tracer dose. The weight must be in
kg, and the tracer dose must be specified. The dose is converted to MBq, the
tac is converted to kBq/cc, and the final SUV units are thus in g/cc. Aside
from the tac object, the remaining parameters should be left NULL if the
required data is in the tac object attributes (as can be done with
batch_load().
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tac_suv(tac, dose = NULL, dose_unit = NULL, weight_kg = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tac_suv_+3A_tac">tac</code></td>
<td>
<p>time-activity curve object (decay-corrected)</p>
</td></tr>
<tr><td><code id="tac_suv_+3A_dose">dose</code></td>
<td>
<p>the injected tracer dose</p>
</td></tr>
<tr><td><code id="tac_suv_+3A_dose_unit">dose_unit</code></td>
<td>
<p>unit of tracer dose (e.g. &quot;MBq&quot;, &quot;kBq&quot;, &quot;mCi&quot;...)</p>
</td></tr>
<tr><td><code id="tac_suv_+3A_weight_kg">weight_kg</code></td>
<td>
<p>the participant's weight in kg</p>
</td></tr>
</table>


<h3>Value</h3>

<p>tac object with SUV values
</p>


<h3>See Also</h3>

<p>Other SUV functions: 
<code><a href="#topic+suv">suv</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>f &lt;- system.file("extdata", "AD06.tac", package="tacmagic")
fv &lt;- system.file("extdata", "AD06_TAC.voistat", package="tacmagic")
AD06_tac &lt;- load_tac(f, format="PMOD")
AD06_volume &lt;- load_vol(fv, format="voistat")
AD06 &lt;- tac_roi(tac=AD06_tac, volumes=AD06_volume, ROI_def=roi_ham_pib(),
                merge=FALSE, PVC=FALSE)
# dose and weight are fabricated for the example
AD06_suv &lt;- tac_suv(AD06, dose = 9.0, dose_unit = "mCi", weight_kg = 70)
</code></pre>

<hr>
<h2 id='tacmagic'>tacmagic: PET Analysis in R</h2><span id='topic+tacmagic'></span>

<h3>Description</h3>

<p>The main features of tacmagic are to load PET time activity curve (tac) data 
from multiple formats, merge ROIs weighted for volume, calculate binding 
potential models including SUVR and DVR, basic plotting, and calculation of 
cut-off values. Please see the walkthrough vignette for a detailed overview.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
