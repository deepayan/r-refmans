<!DOCTYPE html><html><head><title>Help for package intsurv</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {intsurv}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#intsurv-package'><p>Integrative Survival Modeling</p></a></li>
<li><a href='#BIC.cox_cure'><p>Bayesian Information Criterion (BIC)</p></a></li>
<li><a href='#BIC.cox_cure_net'><p>Bayesian Information Criterion (BIC)</p></a></li>
<li><a href='#bootSe'><p>Standard Error Estimates through Bootstrap</p></a></li>
<li><a href='#cIndex'><p>Concordance Index</p></a></li>
<li><a href='#coef,iCoxph-method'><p>Estimated Covariates Coefficients</p></a></li>
<li><a href='#coef.cox_cure'><p>Estimated Covariate Coefficients</p></a></li>
<li><a href='#coef.cox_cure_net'><p>Estimated Covariate Coefficients</p></a></li>
<li><a href='#cox_cure'><p>Cox Cure Rate Model</p></a></li>
<li><a href='#cox_cure_net'><p>Regularized Cox Cure Rate Model</p></a></li>
<li><a href='#iCoxph'><p>Integrative Cox Model for Uncertain Event Times</p></a></li>
<li><a href='#iCoxph-class'><p>An S4 Class to Represent a Fitted Integrative Cox Model</p></a></li>
<li><a href='#iCoxph.control'><p>Auxiliary for Controlling iCoxph Fitting</p></a></li>
<li><a href='#iCoxph.start'><p>Auxiliary for Starting iCoxph Fitting</p></a></li>
<li><a href='#show-method'><p>Show Methods</p></a></li>
<li><a href='#simData4cure'><p>Simulate Data from Cox Cure Model with Uncertain Event Status</p></a></li>
<li><a href='#simData4iCoxph'><p>Simulated Survival Data with Uncertain Records</p></a></li>
<li><a href='#summary,iCoxph-method'><p>Summary of a Fitted Model</p></a></li>
<li><a href='#summary.cox_cure'><p>Summary of a Fitted Model</p></a></li>
<li><a href='#summary.iCoxph-class'><p>An S4 Class to Represent Summary of a fitted integrative Cox model</p></a></li>
<li><a href='#Survi'><p>Formula Response for Survival Data With Uncertain Event Times</p></a></li>
<li><a href='#Survi-class'><p>An S4 Class Representing Formula Response</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Integrative Survival Modeling</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-01-07</td>
</tr>
<tr>
<td>Description:</td>
<td>Contains implementations of
    integrative survival analysis routines, including
    regular Cox cure rate model proposed by
    Kuk and Chen (1992) &lt;<a href="https://doi.org/10.1093%2Fbiomet%2F79.3.531">doi:10.1093/biomet/79.3.531</a>&gt;
    via an EM algorithm proposed by
    Sy and Taylor (2000) &lt;<a href="https://doi.org/10.1111%2Fj.0006-341X.2000.00227.x">doi:10.1111/j.0006-341X.2000.00227.x</a>&gt;,
    regularized Cox cure rate model with elastic net penalty following
    Masud et al. (2018) &lt;<a href="https://doi.org/10.1177%2F0962280216677748">doi:10.1177/0962280216677748</a>&gt;, and
    Zou and Hastie (2005) &lt;<a href="https://doi.org/10.1111%2Fj.1467-9868.2005.00503.x">doi:10.1111/j.1467-9868.2005.00503.x</a>&gt;, and
    weighted concordance index for cure models proposed by
    Asano and Hirakawa (2017) &lt;<a href="https://doi.org/10.1080%2F10543406.2017.1293082">doi:10.1080/10543406.2017.1293082</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2.3)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 0.12.0), methods, stats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>tinytest</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Collate:</td>
<td>'RcppExports.R' 'class.R' 'Survi.R' 'assessment.R' 'bootSe.R'
'coef.R' 'cox_cure.R' 'cox_cure_net.R' 'iCoxph.R' 'intsurv.R'
'misc.R' 'prep_model.R' 'print.R' 'show.R' 'simData4cure.R'
'simData4iCoxph.R' 'summary.R'</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://wwenjie.org/intsurv">https://wwenjie.org/intsurv</a>,
<a href="https://github.com/wenjie2wang/intsurv">https://github.com/wenjie2wang/intsurv</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/wenjie2wang/intsurv/issues">https://github.com/wenjie2wang/intsurv/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-01-07 05:05:24 UTC; wenjie</td>
</tr>
<tr>
<td>Author:</td>
<td>Wenjie Wang <a href="https://orcid.org/0000-0003-0363-3180"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre],
  Kun Chen <a href="https://orcid.org/0000-0003-3579-5467"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb],
  Jun Yan <a href="https://orcid.org/0000-0003-4401-7296"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Wenjie Wang &lt;wang@wwenjie.org&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-01-08 09:10:09 UTC</td>
</tr>
</table>
<hr>
<h2 id='intsurv-package'>Integrative Survival Modeling</h2><span id='topic+intsurv-package'></span>

<h3>Description</h3>

<p>The package <span class="pkg">intsurv</span> provides implementations of
</p>


<h3>Details</h3>


<ul>
<li><p> integrative Cox model with uncertain event times (Wang et al., 2020)
</p>
</li>
<li><p> Cox cure rate model with uncertain event status (Wang et al., 2020)
</p>
</li></ul>

<p>It also contains other survival analysis routines, including regular Cox
cure rate model, regularized Cox cure rate model with elastic net penalty,
and weighted concordance index.
</p>


<h3>References</h3>

<p>Wang, W., Aseltine, R. H., Chen, K., &amp; Yan, J. (2020). Integrative Survival
Analysis with Uncertain Event Times in Application to A Suicide Risk
Study. <em>Annals of Applied Statistics</em>, 14(1), 51&ndash;73.
</p>
<p>Wang, W., Luo, C., Aseltine, R. H., Wang, F., Yan, J., &amp; Chen, K. (2020).
Suicide Risk Modeling with Uncertain Diagnostic Records. <em>arXiv
preprint arXiv:2009.02597</em>.
</p>

<hr>
<h2 id='BIC.cox_cure'>Bayesian Information Criterion (BIC)</h2><span id='topic+BIC.cox_cure'></span><span id='topic+BIC.cox_cure_uncer'></span>

<h3>Description</h3>

<p>Compute Bayesian information criterion (BIC) or Schwarz's Bayesian criterion
(SBC) for possibly one or several objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cox_cure'
BIC(object, ..., method = c("obs", "effective"))

## S3 method for class 'cox_cure_uncer'
BIC(object, ..., method = c("obs", "certain-event"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BIC.cox_cure_+3A_object">object</code></td>
<td>
<p>An object for a fitted model.</p>
</td></tr>
<tr><td><code id="BIC.cox_cure_+3A_...">...</code></td>
<td>
<p>Other objects of the same class.</p>
</td></tr>
<tr><td><code id="BIC.cox_cure_+3A_method">method</code></td>
<td>
<p>A character string specifying the method for computing the BIC
values.  Notice that this argument is placed after <code>...</code> and thus
must be specified as a named argument.  The available options for
<code>cox_cure</code> objects are <code>"obs"</code> for regular BIC based on the
number of observations, and <code>"effective"</code> for using BIC based on
the number of effective sample size for censored data (number of
uncensored events) proposed by Volinsky and Raftery (2000).  The
available options for <code>cox_cure_uncer</code> objects are <code>"obs"</code> for
regular BIC based on the number of observations, and
<code>"certain-event"</code> for a variant of BIC based on the number of
certain uncensored events.  For objects of either class, the former
method is used by default.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Volinsky, C. T., &amp; Raftery, A. E. (2000). Bayesian information criterion for
censored survival models. Biometrics, 56(1), 256&ndash;262.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See examples of function 'cox_cure'.
</code></pre>

<hr>
<h2 id='BIC.cox_cure_net'>Bayesian Information Criterion (BIC)</h2><span id='topic+BIC.cox_cure_net'></span><span id='topic+BIC.cox_cure_net_uncer'></span>

<h3>Description</h3>

<p>Compute Bayesian information criterion (BIC) or Schwarz's Bayesian criterion
(SBC) from a fitted solution path.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cox_cure_net'
BIC(object, ..., method = c("obs", "effective"))

## S3 method for class 'cox_cure_net_uncer'
BIC(object, ..., method = c("obs", "certain-event"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BIC.cox_cure_net_+3A_object">object</code></td>
<td>
<p>An object for a fitted solution path.</p>
</td></tr>
<tr><td><code id="BIC.cox_cure_net_+3A_...">...</code></td>
<td>
<p>Other arguments for future usage.  A warning message will be
thrown for any invalid argument.</p>
</td></tr>
<tr><td><code id="BIC.cox_cure_net_+3A_method">method</code></td>
<td>
<p>A character string specifying the method for computing the BIC
values.  Notice that this argument is placed after <code>...</code> and thus
must be specified as a named argument.  The available options for
<code>cox_cure</code> objects are <code>"obs"</code> for regular BIC based on the
number of observations, and <code>"effective"</code> for using BIC based on
the number of effective sample size for censored data (number of
uncensored events) proposed by Volinsky and Raftery (2000).  The
available options for <code>cox_cure_uncer</code> objects are <code>"obs"</code> for
regular BIC based on the number of observations, and
<code>"certain-event"</code> for a variant of BIC based on the number of
certain uncensored events.  For objects of either class, the former
method is used by default.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Volinsky, C. T., &amp; Raftery, A. E. (2000). Bayesian information criterion for
censored survival models. Biometrics, 56(1), 256&ndash;262.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See examples of function 'cox_cure_net'.
</code></pre>

<hr>
<h2 id='bootSe'>Standard Error Estimates through Bootstrap</h2><span id='topic+bootSe'></span>

<h3>Description</h3>

<p>For <code><a href="#topic+iCoxph-class">iCoxph-class</a></code> object, add (or update) standard error (SE)
estimates through bootstrap methods, or compute the coefficient estimates
from the given number of bootstrap samples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bootSe(
  object,
  B = 50,
  se = c("inter-quartile", "mad", "sd"),
  return_beta = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bootSe_+3A_object">object</code></td>
<td>
<p><code><a href="#topic+iCoxph-class">iCoxph-class</a></code> object.</p>
</td></tr>
<tr><td><code id="bootSe_+3A_b">B</code></td>
<td>
<p>A positive integer specifying number of bootstrap samples used for
SE estimates.  A large number, such as 200, is often needed for a more
reliable estimation in practice.  If <code>B = 1</code> is specified, the
function will return the covariate coefficient estimates instead of a
<code>iCoxph-class</code> object.</p>
</td></tr>
<tr><td><code id="bootSe_+3A_se">se</code></td>
<td>
<p>A character value specifying the way computing SE from bootstrap
samples. The default method is based on median absolute deviation and
the second method is based on inter-quartile, both of which are based on
normality of the bootstrap estimates and provides robust estimates for
SE. The third method estimates SE by the standard deviation of the
bootstrap estimates.</p>
</td></tr>
<tr><td><code id="bootSe_+3A_return_beta">return_beta</code></td>
<td>
<p>A logical value. If <code>TRUE</code>, the function returns the
covariate coefficient estimates from the given number of bootstrap
samples, which allows users to split the most computationally intensive
step into small pieces that can be computed in a parallel manner.  The
default value is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="bootSe_+3A_...">...</code></td>
<td>
<p>Other arguments for future usage.  A warning will be thrown if
any invalid argument is specified.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Three different methods are available for computing SE from bootstrap
samples through argument <code>se</code>.  Given the fact that the bootstrap
method is computationally intensive, the function returns the coefficient
estimates in a matrix from the given number of bootstrap samples when
<code>return_beta = TRUE)</code> is specified, which can be used in parallel
computing or high performance computing (HPC) cluster.  The SE estimates can
be further computed based on estimates from bootstrap samples by users on
their own.  The <code>return_beta = TRUE</code> is implied, when <code>B = 1</code> is
specified.
</p>


<h3>Value</h3>

<p><code><a href="#topic+iCoxph-class">iCoxph-class</a></code> object or a numeric matrix that contains
the covariate coefficient estimates from the given number of bootstrap
samples in rows.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+iCoxph">iCoxph</a></code> for fitting integrative Cox model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See examples of function 'iCoxph'.
</code></pre>

<hr>
<h2 id='cIndex'>Concordance Index</h2><span id='topic+cIndex'></span>

<h3>Description</h3>

<p>Compute concordance index (C-index or C-statistic) that allows weights for
right-censored survival data.  For example, Asano and Hirakawa (2017)
proposed cure status weighting for cure models, which reduces to Harrell's
C-index if weighs are all ones.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cIndex(time, event = NULL, risk_score, weight = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cIndex_+3A_time">time</code></td>
<td>
<p>A numeric vector for observed times</p>
</td></tr>
<tr><td><code id="cIndex_+3A_event">event</code></td>
<td>
<p>A numeric vector for event indicators.  If it is <code>NULL</code>
(by default) or <code>NA</code>, <code>event</code> will be treated all as ones and
the function will compute concordance index for uncensored survival
data.</p>
</td></tr>
<tr><td><code id="cIndex_+3A_risk_score">risk_score</code></td>
<td>
<p>A numeric vector representing the risk scores of events.</p>
</td></tr>
<tr><td><code id="cIndex_+3A_weight">weight</code></td>
<td>
<p>A optional numeric vector for weights.  If it is <code>NULL</code>
(by default) or <code>NA</code>, equal weights will be used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let <code class="reqn">r_i</code>, <code class="reqn">t_i</code>, and <code class="reqn">\delta_i</code> denote the risk score, observed
time, and event indicator of <code class="reqn">i</code>-th subject.  The pair of
<code class="reqn">(t_i,\delta_i)</code> and <code class="reqn">(t_j,\delta_j)</code>, where <code class="reqn">i&lt;j</code>, are defined
to be comparable if <code class="reqn">t_i&lt;t_j,\delta_i=1</code> or
<code class="reqn">t_i=t_j,\delta_i=1,\delta_j=0</code>.  In the context of survival analysis,
the risk scores of a comparable pair are said to be concordant with the
survival outcomes if <code class="reqn">r_i&gt;r_j</code>.  The C-index is defined as the
proportion of the concordant pairs among the comparable pairs.  For
comparable pair satisfying <code class="reqn">t_i&lt;t_j,\delta_i=1</code>, we count 0.5 in the
numerator of the concordance index for tied risk scores (<code class="reqn">r_i=r_j</code>).
</p>


<h3>Value</h3>

<p>A named numeric vector that consists of
</p>

<ul>
<li> <p><code>index</code>: the concordance index.
</p>
</li>
<li> <p><code>concordant</code>: the number of concordant pairs.
</p>
</li>
<li> <p><code>comparable</code>: the number of comparable pairs.
</p>
</li>
<li> <p><code>tied_tisk</code>: the number of comparable pairs having tied risks.
</p>
</li></ul>



<h3>References</h3>

<p>Asano, J., &amp; Hirakawa, A. (2017). Assessing the prediction accuracy of a
cure model for censored survival data with long-term survivors: Application
to breast cancer data. Journal of Biopharmaceutical Statistics, 27(6),
918&ndash;932.
</p>
<p>Harrell, F. E., Lee, K. L., &amp; Mark, D. B. (1996). Multivariable prognostic
models: Issues in developing models, evaluating assumptions and adequacy,
and measuring and reducing errors. Statistics in medicine, 15(4), 361&ndash;387.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See examples of function 'cox_cure'.
</code></pre>

<hr>
<h2 id='coef+2CiCoxph-method'>Estimated Covariates Coefficients</h2><span id='topic+coef+2CiCoxph-method'></span><span id='topic+coef.iCoxph'></span>

<h3>Description</h3>

<p><code>coef,iCoxph-method</code> is an S4 class method that extracts covariate
coefficient estimates from <code><a href="#topic+iCoxph-class">iCoxph-class</a></code> object from function
<code><a href="#topic+iCoxph">iCoxph</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'iCoxph'
coef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef+2B2CiCoxph-method_+3A_object">object</code></td>
<td>
<p><code><a href="#topic+iCoxph-class">iCoxph-class</a></code> object.</p>
</td></tr>
<tr><td><code id="coef+2B2CiCoxph-method_+3A_...">...</code></td>
<td>
<p>Other arguments for future usage.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named numeric vector.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+iCoxph">iCoxph</a></code> for fitting integrative Cox model;
<code><a href="#topic+summary+2CiCoxph-method">summary,iCoxph-method</a></code> for summary of a fitted model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See examples of function iCoxph.
</code></pre>

<hr>
<h2 id='coef.cox_cure'>Estimated Covariate Coefficients</h2><span id='topic+coef.cox_cure'></span><span id='topic+coef.cox_cure_uncer'></span>

<h3>Description</h3>

<p>Extract the covariate coefficient estimates from a fitted Cox cure rate
model with possible uncertain event status.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cox_cure'
coef(object, part = c("both", "survival", "cure"), ...)

## S3 method for class 'cox_cure_uncer'
coef(object, part = c("both", "survival", "cure"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef.cox_cure_+3A_object">object</code></td>
<td>
<p>Object representing a fitted model.</p>
</td></tr>
<tr><td><code id="coef.cox_cure_+3A_part">part</code></td>
<td>
<p>A character string specifying the coefficient estimates from a
particular model part.  The available options are <code>"both"</code> for the
coefficient estimates from both model parts, <code>"survival"</code> for the
coefficient estimates from the survival model part, and <code>"cure"</code>
for the coefficient estimates from the cure rate model part.  The
default option is <code>"all"</code>.</p>
</td></tr>
<tr><td><code id="coef.cox_cure_+3A_...">...</code></td>
<td>
<p>Other arguments for future usage.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>part = "both"</code>, this function returns a list that consists
of the following named elements </p>

<ul>
<li> <p><code>surv</code>: the coefficient estimates of survival model part.
</p>
</li>
<li> <p><code>cure</code>: the coefficient estimates of cure rate model part.
</p>
</li></ul>

<p>Otherwise, a named numeric vector representing the coefficient estimates of
the specified model part will be returned.
</p>

<hr>
<h2 id='coef.cox_cure_net'>Estimated Covariate Coefficients</h2><span id='topic+coef.cox_cure_net'></span><span id='topic+coef.cox_cure_net_uncer'></span>

<h3>Description</h3>

<p>Extract the covariate coefficient estimates from a solution path of
regularized Cox cure rate model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cox_cure_net'
coef(object, naive_en = FALSE, selection = c("bic1", "bic2", "all"), ...)

## S3 method for class 'cox_cure_net_uncer'
coef(object, naive_en = FALSE, selection = c("bic1", "bic2", "all"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef.cox_cure_net_+3A_object">object</code></td>
<td>
<p>Object representing a fitted solution path.</p>
</td></tr>
<tr><td><code id="coef.cox_cure_net_+3A_naive_en">naive_en</code></td>
<td>
<p>A logical value specifying whether to return naive elastic
net estimates.  If <code>FALSE</code> by default, the elastic net estimates
will be returned instead of the naive elastic net estimates.</p>
</td></tr>
<tr><td><code id="coef.cox_cure_net_+3A_selection">selection</code></td>
<td>
<p>A character string for specifying the criterion for
selection of coefficient estimates.  The available options are
<code>"bic1"</code> for selecting coefficient estimates by regular BIC
criterion based on the number of observations, <code>"bic2"</code> for a
variant BIC criterion based on the effective sample size, and
<code>"all"</code> for returning the whole solution path.  See
<code><a href="#topic+BIC.cox_cure_net">BIC.cox_cure_net</a></code> for details of selection by BIC.</p>
</td></tr>
<tr><td><code id="coef.cox_cure_net_+3A_...">...</code></td>
<td>
<p>Other arguments for future usage.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list that consists of the following named elements:
</p>

<ul>
<li> <p><code>surv</code>: the selected coefficient estimates of survival model
part.
</p>
</li>
<li> <p><code>cure</code>: the selected coefficient estimates of cure rate model
part.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>## see examples of function `cox_cure_net`

</code></pre>

<hr>
<h2 id='cox_cure'>Cox Cure Rate Model</h2><span id='topic+cox_cure'></span><span id='topic+cox_cure.fit'></span>

<h3>Description</h3>

<p>For right-censored data, fit a regular Cox cure rate model (Kuk and Chen,
1992; Sy and Taylor, 2000) via an EM algorithm.  For right-censored data
with uncertain event status, fit the Cox cure model proposed by Wang et
al. (2020).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cox_cure(
  surv_formula,
  cure_formula,
  time,
  event,
  data,
  subset,
  contrasts = NULL,
  bootstrap = 0,
  firth = FALSE,
  surv_start = NULL,
  cure_start = NULL,
  surv_offset = NULL,
  cure_offset = NULL,
  em_max_iter = 200,
  em_rel_tol = 1e-05,
  surv_max_iter = 30,
  surv_rel_tol = 1e-05,
  cure_max_iter = 30,
  cure_rel_tol = 1e-05,
  tail_completion = c("zero", "exp", "zero-tau"),
  tail_tau = NULL,
  pmin = 1e-05,
  early_stop = TRUE,
  verbose = FALSE,
  ...
)

cox_cure.fit(
  surv_x,
  cure_x,
  time,
  event,
  cure_intercept = TRUE,
  bootstrap = 0,
  firth = FALSE,
  surv_start = NULL,
  cure_start = NULL,
  surv_offset = NULL,
  cure_offset = NULL,
  surv_standardize = TRUE,
  cure_standardize = TRUE,
  em_max_iter = 200,
  em_rel_tol = 1e-05,
  surv_max_iter = 30,
  surv_rel_tol = 1e-05,
  cure_max_iter = 30,
  cure_rel_tol = 1e-05,
  tail_completion = c("zero", "exp", "zero-tau"),
  tail_tau = NULL,
  pmin = 1e-05,
  early_stop = TRUE,
  verbose = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cox_cure_+3A_surv_formula">surv_formula</code></td>
<td>
<p>A formula object starting with <code>~</code> for the model
formula in survival model part.  For Cox model, no intercept term is
included even if an intercept is specified or implied in the model
formula.  A model formula with an intercept term only is not allowed.</p>
</td></tr>
<tr><td><code id="cox_cure_+3A_cure_formula">cure_formula</code></td>
<td>
<p>A formula object starting with <code>~</code> for the model
formula in incidence model part.  For logistic model, an intercept term
is included by default and can be excluded by adding <code>+ 0</code> or
<code>- 1</code> to the model formula.</p>
</td></tr>
<tr><td><code id="cox_cure_+3A_time">time</code></td>
<td>
<p>A numeric vector for the observed survival times.</p>
</td></tr>
<tr><td><code id="cox_cure_+3A_event">event</code></td>
<td>
<p>A numeric vector for the event indicators.  <code>NA</code>'s are
allowed and represent uncertain event status.</p>
</td></tr>
<tr><td><code id="cox_cure_+3A_data">data</code></td>
<td>
<p>An optional data frame, list, or environment that contains the
covariates and response variables (<code>time</code> and <code>event</code>),
included in the model. If they are not found in data, the variables are
taken from the environment of the specified formula, usually the
environment from which this function is called.</p>
</td></tr>
<tr><td><code id="cox_cure_+3A_subset">subset</code></td>
<td>
<p>An optional logical vector specifying a subset of observations
to be used in the fitting process.</p>
</td></tr>
<tr><td><code id="cox_cure_+3A_contrasts">contrasts</code></td>
<td>
<p>An optional list, whose entries are values (numeric
matrices or character strings naming functions) to be used as
replacement values for the contrasts replacement function and whose
names are the names of columns of data containing factors.  See
<code>contrasts.arg</code> of <code><a href="stats.html#topic+model.matrix.default">model.matrix.default</a></code> for
details.</p>
</td></tr>
<tr><td><code id="cox_cure_+3A_bootstrap">bootstrap</code></td>
<td>
<p>An integer representing the number of bootstrap samples for
estimating standard errors of the coefficient estimates.  The bootstrap
procedure will not run with <code>bootstrap = 0</code> by default.  If
<code>bootstrap &gt; 0</code>, the specified number of bootstrap samples will be
used in estimating standard errors.</p>
</td></tr>
<tr><td><code id="cox_cure_+3A_firth">firth</code></td>
<td>
<p>A logical value indicating whether to use Firth's
bias-reduction method (Firth, 1993) in the logistic model component.
The default value is <code>FALSE</code> for fitting a regular logistic model.
Notice that this argument is experimental and only available for regular
Cox cure rate model currently.</p>
</td></tr>
<tr><td><code id="cox_cure_+3A_surv_start">surv_start</code>, <code id="cox_cure_+3A_cure_start">cure_start</code></td>
<td>
<p>An optional numeric vector representing the
starting values for the survival model component or the incidence model
component.  If <code>surv_start = NULL</code> is specified, the starting
values will be obtained from fitting a regular Cox to events only.
Similarly, if <code>cure_start = NULL</code> is specified, the starting values
will be obtained from fitting a regular logistic model to the
non-missing event indicators.</p>
</td></tr>
<tr><td><code id="cox_cure_+3A_surv_offset">surv_offset</code>, <code id="cox_cure_+3A_cure_offset">cure_offset</code></td>
<td>
<p>An optional numeric vector representing the
offset term in the survival model compoent or the incidence model
component.  The function will internally try to find values of the
specified variable in the <code>data</code> first.  Alternatively, one or more
<code>offset</code> terms can be specified in the formula (by
<code>stats::offset()</code>).  If more than one offset terms are specified,
their sum will be used.</p>
</td></tr>
<tr><td><code id="cox_cure_+3A_em_max_iter">em_max_iter</code></td>
<td>
<p>A positive integer specifying the maximum iteration
number of the EM algorithm.  The default value is <code>200</code>.</p>
</td></tr>
<tr><td><code id="cox_cure_+3A_em_rel_tol">em_rel_tol</code></td>
<td>
<p>A positive number specifying the tolerance that determines
the convergence of the EM algorithm in terms of the convergence of the
covariate coefficient estimates.  The tolerance is compared with the
relative change between estimates from two consecutive iterations, which
is measured by ratio of the L1-norm of their difference to the sum of
their L1-norm.  The default value is <code>1e-5</code>.</p>
</td></tr>
<tr><td><code id="cox_cure_+3A_surv_max_iter">surv_max_iter</code>, <code id="cox_cure_+3A_cure_max_iter">cure_max_iter</code></td>
<td>
<p>A positive integer specifying the maximum
iteration number of the M-step routine related to the survival model
component or the incidence model component.  The default value is
<code>200</code>.</p>
</td></tr>
<tr><td><code id="cox_cure_+3A_surv_rel_tol">surv_rel_tol</code>, <code id="cox_cure_+3A_cure_rel_tol">cure_rel_tol</code></td>
<td>
<p>A positive number specifying the tolerance
that determines the convergence of the M-step related to the survival
model component or the incidence model component in terms of the
convergence of the covariate coefficient estimates.  The tolerance is
compared with the relative change between estimates from two consecutive
iterations, which is measured by ratio of the L1-norm of their
difference to the sum of their L1-norm.  The default value is
<code>1e-5</code>.</p>
</td></tr>
<tr><td><code id="cox_cure_+3A_tail_completion">tail_completion</code></td>
<td>
<p>A character string specifying the tail completion
method for conditional survival function.  The available methods are
<code>"zero"</code> for zero-tail completion after the largest event times (Sy
and Taylor, 2000), <code>"exp"</code> for exponential-tail completion (Peng,
2003), and <code>"zero-tau"</code> for zero-tail completion after a specified
<code>tail_tau</code>.  The default method is the zero-tail completion
proposed by Sy and Taylor (2000).</p>
</td></tr>
<tr><td><code id="cox_cure_+3A_tail_tau">tail_tau</code></td>
<td>
<p>A numeric number specifying the time of zero-tail
completion.  It will be used only if <code>tail_completion =
"zero-tau"</code>.  A reasonable choice must be a time point between the
largest event time and the largest survival time.</p>
</td></tr>
<tr><td><code id="cox_cure_+3A_pmin">pmin</code></td>
<td>
<p>A numeric number specifying the minimum value of probabilities
for sake of numerical stability.  The default value is <code>1e-5</code>.</p>
</td></tr>
<tr><td><code id="cox_cure_+3A_early_stop">early_stop</code></td>
<td>
<p>A logical value specifying whether to stop the iteration
once the negative log-likelihood unexpectedly increases, which may
suggest convergence on likelihood, or indicate numerical issues or
implementation bugs.  The default value is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="cox_cure_+3A_verbose">verbose</code></td>
<td>
<p>A logical value.  If <code>TRUE</code>, a verbose information will
be given along iterations for tracing the convergence.  The default
value is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="cox_cure_+3A_...">...</code></td>
<td>
<p>Other arguments for future usage.  A warning will be thrown if
any invalid argument is specified.</p>
</td></tr>
<tr><td><code id="cox_cure_+3A_surv_x">surv_x</code></td>
<td>
<p>A numeric matrix for the design matrix of the survival model
component.</p>
</td></tr>
<tr><td><code id="cox_cure_+3A_cure_x">cure_x</code></td>
<td>
<p>A numeric matrix for the design matrix of the cure rate model
component.  The design matrix should exclude an intercept term unless we
want to fit a model only including the intercept term.  In that case, we
need further set <code>cure_intercept = FALSE</code> to not standardize the
intercept term.</p>
</td></tr>
<tr><td><code id="cox_cure_+3A_cure_intercept">cure_intercept</code></td>
<td>
<p>A logical value specifying whether to add an intercept
term to the cure rate model component.  If <code>TRUE</code> by default, an
intercept term is included.</p>
</td></tr>
<tr><td><code id="cox_cure_+3A_surv_standardize">surv_standardize</code></td>
<td>
<p>A logical value specifying whether to standardize
the covariates for the survival model part.  If <code>FALSE</code>, the
covariates will be standardized internally to have mean zero and
standard deviation one.</p>
</td></tr>
<tr><td><code id="cox_cure_+3A_cure_standardize">cure_standardize</code></td>
<td>
<p>A logical value specifying whether to standardize
the covariates for the cure rate model part.  If <code>TRUE</code> (by
default), the covariates will be standardized internally to have mean
zero and standard deviation one.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>cox_cure</code> object for regular Cox cure rate model or
<code>cox_cure_uncer</code> object for Cox cure rate model with uncertain events.
</p>


<h3>References</h3>

<p>Firth, D. (1993). Bias reduction of maximum likelihood
estimates. <em>Biometrika</em>, 80(1), 27&ndash;38.
</p>
<p>Kuk, A. Y. C., &amp; Chen, C. (1992). A mixture model combining logistic
regression with proportional hazards regression. <em>Biometrika</em>, 79(3),
531&ndash;541.
</p>
<p>Peng, Y. (2003). Estimating baseline distribution in proportional hazards
cure models. <em>Computational Statistics &amp; Data Analysis</em>, 42(1-2),
187&ndash;201.
</p>
<p>Sy, J. P., &amp; Taylor, J. M. (2000). Estimation in a Cox proportional hazards
cure model. <em>Biometrics</em>, 56(1), 227&ndash;236.
</p>
<p>Wang, W., Luo, C., Aseltine, R. H., Wang, F., Yan, J., &amp; Chen, K. (2020).
Suicide Risk Modeling with Uncertain Diagnostic Records. <em>arXiv
preprint arXiv:2009.02597</em>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cox_cure_net">cox_cure_net</a></code> for regularized Cox cure rate model with
elastic-net penalty.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(intsurv)

### regular Cox cure rate model ======================================
## 1. simulate right-censored data with a cure fraction
set.seed(123)
n_obs &lt;- 2e2
p &lt;- 5
x_mat &lt;- matrix(rnorm(n_obs * p), nrow = n_obs, ncol = p)
colnames(x_mat) &lt;- paste0("x", seq_len(p))
cure_beta &lt;- rep(0.5, p)
b0 &lt;- - 1
expit &lt;- binomial()$linkinv
ncure_prob &lt;- expit(as.numeric(b0 + x_mat %*% cure_beta))
is_cure &lt;- 1 - rbinom(n_obs, size = 1, prob = ncure_prob)
surv_beta &lt;- rep(0.5, p)
risk_score &lt;- as.numeric(x_mat %*% surv_beta)
event_time &lt;- rexp(n_obs, exp(as.numeric(x_mat %*% surv_beta)))
censor_time &lt;- 10
event &lt;- ifelse(event_time &lt; censor_time &amp; ! is_cure, 1, 0)
obs_time &lt;- ifelse(event &gt; 0, event_time, censor_time)

## model-fitting from given design matrices
fit1 &lt;- cox_cure.fit(x_mat, x_mat, obs_time, event, bootstrap = 30)
summary(fit1)

## coefficient estimates from both model parts
coef(fit1)

## or a particular part
coef(fit1, "surv")
coef(fit1, "cure")

## weighted concordance index (C-index)
fit1$model$c_index
## which also can be computed as follows
cIndex(time = obs_time, event = event,
       risk_score = fit1$fitted$surv_xBeta,
       weight = ifelse(event &gt; 0, 1, fit1$fitted$susceptible_prob))

## 2. create a toy dataset
toy_dat &lt;- data.frame(time = obs_time, status = event)
toy_dat$group &lt;- cut(abs(x_mat[, 1L]), breaks = c(0, 0.5, 1, 3, Inf),
                     labels = LETTERS[1:4])
toy_dat &lt;- cbind(toy_dat, as.data.frame(x_mat[, - 1L, drop = FALSE]))

## model-fitting from given model formula
fit2 &lt;- cox_cure(~ x3 + x4 + group, ~ group + x3 + offset(x2),
                 time = time, event = status, surv_offset = x2,
                 data = toy_dat, subset = group != "D", bootstrap = 30)
summary(fit2)

## get BIC's
BIC(fit1)
BIC(fit2)
BIC(fit1, fit2)


### Cox cure rate model with uncertain event status ==================
## simulate sample data
sim_dat &lt;- simData4cure(nSubject = 200, max_censor = 10, lambda_censor = 0.1,
                        survMat = x_mat, cureMat = x_mat, b0 = 1)
table(sim_dat$case)
table(sim_dat$obs_event, useNA = "ifany")

## use formula
fit3 &lt;- cox_cure(~ x1 + x2 + x3, ~ z1 + z2 + z3,
                 time = obs_time, event = obs_event, data = sim_dat)
summary(fit3)

## use design matrix
fit4 &lt;- cox_cure.fit(x_mat, x_mat, time = sim_dat$obs_time,
                     event = sim_dat$obs_event)
summary(fit4)

## get BIC's
BIC(fit3, fit4)
</code></pre>

<hr>
<h2 id='cox_cure_net'>Regularized Cox Cure Rate Model</h2><span id='topic+cox_cure_net'></span><span id='topic+cox_cure_net.fit'></span>

<h3>Description</h3>

<p>For right-censored data, fit a regularized Cox cure rate model through
elastic-net penalty following Masud et al. (2018), and Zou and Hastie
(2005).  For right-censored data with uncertain event status,
fit the regularized Cox cure model proposed by Wang et al. (2020).  Without
regularization, the model reduces to the regular Cox cure rate model (Kuk
and Chen, 1992; Sy and Taylor, 2000)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cox_cure_net(
  surv_formula,
  cure_formula,
  time,
  event,
  data,
  subset,
  contrasts = NULL,
  surv_lambda = NULL,
  surv_alpha = 1,
  surv_nlambda = 10,
  surv_lambda_min_ratio = 0.1,
  surv_l1_penalty_factor = NULL,
  cure_lambda = NULL,
  cure_alpha = 1,
  cure_nlambda = 10,
  cure_lambda_min_ratio = 0.1,
  cure_l1_penalty_factor = NULL,
  cv_nfolds = 0,
  surv_start = NULL,
  cure_start = NULL,
  surv_offset = NULL,
  cure_offset = NULL,
  surv_standardize = TRUE,
  cure_standardize = TRUE,
  em_max_iter = 200,
  em_rel_tol = 1e-05,
  surv_max_iter = 10,
  surv_rel_tol = 1e-05,
  cure_max_iter = 10,
  cure_rel_tol = 1e-05,
  tail_completion = c("zero", "exp", "zero-tau"),
  tail_tau = NULL,
  pmin = 1e-05,
  early_stop = TRUE,
  verbose = FALSE,
  ...
)

cox_cure_net.fit(
  surv_x,
  cure_x,
  time,
  event,
  cure_intercept = TRUE,
  surv_lambda = NULL,
  surv_alpha = 1,
  surv_nlambda = 10,
  surv_lambda_min_ratio = 0.1,
  surv_l1_penalty_factor = NULL,
  cure_lambda = NULL,
  cure_alpha = 1,
  cure_nlambda = 10,
  cure_lambda_min_ratio = 0.1,
  cure_l1_penalty_factor = NULL,
  cv_nfolds = 0,
  surv_start = NULL,
  cure_start = NULL,
  surv_offset = NULL,
  cure_offset = NULL,
  surv_standardize = TRUE,
  cure_standardize = TRUE,
  em_max_iter = 200,
  em_rel_tol = 1e-05,
  surv_max_iter = 10,
  surv_rel_tol = 1e-05,
  cure_max_iter = 10,
  cure_rel_tol = 1e-05,
  tail_completion = c("zero", "exp", "zero-tau"),
  tail_tau = NULL,
  pmin = 1e-05,
  early_stop = TRUE,
  verbose = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cox_cure_net_+3A_surv_formula">surv_formula</code></td>
<td>
<p>A formula object starting with <code>~</code> for the model
formula in survival model part.  For Cox model, no intercept term is
included even if an intercept is specified or implied in the model
formula.  A model formula with an intercept term only is not allowed.</p>
</td></tr>
<tr><td><code id="cox_cure_net_+3A_cure_formula">cure_formula</code></td>
<td>
<p>A formula object starting with <code>~</code> for the model
formula in incidence model part.  For logistic model, an intercept term
is included by default and can be excluded by adding <code>+ 0</code> or
<code>- 1</code> to the model formula.</p>
</td></tr>
<tr><td><code id="cox_cure_net_+3A_time">time</code></td>
<td>
<p>A numeric vector for the observed survival times.</p>
</td></tr>
<tr><td><code id="cox_cure_net_+3A_event">event</code></td>
<td>
<p>A numeric vector for the event indicators.  <code>NA</code>'s are
allowed and represent uncertain event status.</p>
</td></tr>
<tr><td><code id="cox_cure_net_+3A_data">data</code></td>
<td>
<p>An optional data frame, list, or environment that contains the
covariates and response variables (<code>time</code> and <code>event</code>),
included in the model. If they are not found in data, the variables are
taken from the environment of the specified formula, usually the
environment from which this function is called.</p>
</td></tr>
<tr><td><code id="cox_cure_net_+3A_subset">subset</code></td>
<td>
<p>An optional logical vector specifying a subset of observations
to be used in the fitting process.</p>
</td></tr>
<tr><td><code id="cox_cure_net_+3A_contrasts">contrasts</code></td>
<td>
<p>An optional list, whose entries are values (numeric
matrices or character strings naming functions) to be used as
replacement values for the contrasts replacement function and whose
names are the names of columns of data containing factors.  See
<code>contrasts.arg</code> of <code><a href="stats.html#topic+model.matrix.default">model.matrix.default</a></code> for
details.</p>
</td></tr>
<tr><td><code id="cox_cure_net_+3A_surv_lambda">surv_lambda</code>, <code id="cox_cure_net_+3A_cure_lambda">cure_lambda</code></td>
<td>
<p>A numeric vector consists of nonnegative
values representing the tuning parameter sequence for the survival model
part or the incidence model part.</p>
</td></tr>
<tr><td><code id="cox_cure_net_+3A_surv_alpha">surv_alpha</code>, <code id="cox_cure_net_+3A_cure_alpha">cure_alpha</code></td>
<td>
<p>A number between 0 and 1 for tuning the elastic
net penalty for the survival model part or the incidence model part.  If
it is one, the elastic penalty will reduce to the well-known lasso
penalty.  If it is zero, the ridge penalty will be used.</p>
</td></tr>
<tr><td><code id="cox_cure_net_+3A_surv_nlambda">surv_nlambda</code>, <code id="cox_cure_net_+3A_cure_nlambda">cure_nlambda</code></td>
<td>
<p>A positive number specifying the number of
<code>surv_lambda</code> or <code>cure_lambda</code> if <code>surv_lambda</code> or
<code>cure_lambda</code> is not specified, respectively.  The default value is
10.</p>
</td></tr>
<tr><td><code id="cox_cure_net_+3A_surv_lambda_min_ratio">surv_lambda_min_ratio</code>, <code id="cox_cure_net_+3A_cure_lambda_min_ratio">cure_lambda_min_ratio</code></td>
<td>
<p>The ratio of the minimum
<code>surv_lambda</code> (or <code>cure_lambda</code>) to the large enough
<code>surv_lambda</code> (or codecure_lambda) that produces all-zero
estimates on log scale.  The default value is <code>1e-1</code>.</p>
</td></tr>
<tr><td><code id="cox_cure_net_+3A_surv_l1_penalty_factor">surv_l1_penalty_factor</code>, <code id="cox_cure_net_+3A_cure_l1_penalty_factor">cure_l1_penalty_factor</code></td>
<td>
<p>A numeric vector that
consists of nonnegative penalty factors (or weights) on L1-norm for the
coefficient estimate vector in the survival model part or the incidence
model part.  The penalty is applied to the coefficient estimate divided
by the specified weights.  The specified weights are re-scaled
internally so that their summation equals the length of coefficients.
If <code>NULL</code> is specified, the weights are all set to be one.</p>
</td></tr>
<tr><td><code id="cox_cure_net_+3A_cv_nfolds">cv_nfolds</code></td>
<td>
<p>An non-negative integer specifying number of folds in
cross-validation (CV).  The default value is <code>0</code> and the CV
procedure is not enabled.</p>
</td></tr>
<tr><td><code id="cox_cure_net_+3A_surv_start">surv_start</code></td>
<td>
<p>An optional numeric vector representing the
starting values for the survival model component or the incidence model
component.  If <code>surv_start = NULL</code> is specified, the starting
values will be obtained from fitting a regular Cox to events only.
Similarly, if <code>cure_start = NULL</code> is specified, the starting values
will be obtained from fitting a regular logistic model to the
non-missing event indicators.</p>
</td></tr>
<tr><td><code id="cox_cure_net_+3A_cure_start">cure_start</code></td>
<td>
<p>An optional numeric vector representing the
starting values for the survival model component or the incidence model
component.  If <code>surv_start = NULL</code> is specified, the starting
values will be obtained from fitting a regular Cox to events only.
Similarly, if <code>cure_start = NULL</code> is specified, the starting values
will be obtained from fitting a regular logistic model to the
non-missing event indicators.</p>
</td></tr>
<tr><td><code id="cox_cure_net_+3A_surv_offset">surv_offset</code></td>
<td>
<p>An optional numeric vector representing the
offset term in the survival model compoent or the incidence model
component.  The function will internally try to find values of the
specified variable in the <code>data</code> first.  Alternatively, one or more
<code>offset</code> terms can be specified in the formula (by
<code>stats::offset()</code>).  If more than one offset terms are specified,
their sum will be used.</p>
</td></tr>
<tr><td><code id="cox_cure_net_+3A_cure_offset">cure_offset</code></td>
<td>
<p>An optional numeric vector representing the
offset term in the survival model compoent or the incidence model
component.  The function will internally try to find values of the
specified variable in the <code>data</code> first.  Alternatively, one or more
<code>offset</code> terms can be specified in the formula (by
<code>stats::offset()</code>).  If more than one offset terms are specified,
their sum will be used.</p>
</td></tr>
<tr><td><code id="cox_cure_net_+3A_surv_standardize">surv_standardize</code>, <code id="cox_cure_net_+3A_cure_standardize">cure_standardize</code></td>
<td>
<p>A logical value specifying whether
to standardize the covariates for the survival model part or the
incidence model part.  If <code>FALSE</code>, the covariates will be
standardized internally to have mean zero and standard deviation one.</p>
</td></tr>
<tr><td><code id="cox_cure_net_+3A_em_max_iter">em_max_iter</code></td>
<td>
<p>A positive integer specifying the maximum iteration
number of the EM algorithm.  The default value is <code>200</code>.</p>
</td></tr>
<tr><td><code id="cox_cure_net_+3A_em_rel_tol">em_rel_tol</code></td>
<td>
<p>A positive number specifying the tolerance that determines
the convergence of the EM algorithm in terms of the convergence of the
covariate coefficient estimates.  The tolerance is compared with the
relative change between estimates from two consecutive iterations, which
is measured by ratio of the L1-norm of their difference to the sum of
their L1-norm.  The default value is <code>1e-5</code>.</p>
</td></tr>
<tr><td><code id="cox_cure_net_+3A_surv_max_iter">surv_max_iter</code>, <code id="cox_cure_net_+3A_cure_max_iter">cure_max_iter</code></td>
<td>
<p>A positive integer specifying the maximum
iteration number of the M-step routine related to the survival model
component or the incidence model component.  The default value is
<code>10</code> to encourage faster convergence.</p>
</td></tr>
<tr><td><code id="cox_cure_net_+3A_surv_rel_tol">surv_rel_tol</code></td>
<td>
<p>A positive number specifying the tolerance
that determines the convergence of the M-step related to the survival
model component or the incidence model component in terms of the
convergence of the covariate coefficient estimates.  The tolerance is
compared with the relative change between estimates from two consecutive
iterations, which is measured by ratio of the L1-norm of their
difference to the sum of their L1-norm.  The default value is
<code>1e-5</code>.</p>
</td></tr>
<tr><td><code id="cox_cure_net_+3A_cure_rel_tol">cure_rel_tol</code></td>
<td>
<p>A positive number specifying the tolerance
that determines the convergence of the M-step related to the survival
model component or the incidence model component in terms of the
convergence of the covariate coefficient estimates.  The tolerance is
compared with the relative change between estimates from two consecutive
iterations, which is measured by ratio of the L1-norm of their
difference to the sum of their L1-norm.  The default value is
<code>1e-5</code>.</p>
</td></tr>
<tr><td><code id="cox_cure_net_+3A_tail_completion">tail_completion</code></td>
<td>
<p>A character string specifying the tail completion
method for conditional survival function.  The available methods are
<code>"zero"</code> for zero-tail completion after the largest event times (Sy
and Taylor, 2000), <code>"exp"</code> for exponential-tail completion (Peng,
2003), and <code>"zero-tau"</code> for zero-tail completion after a specified
<code>tail_tau</code>.  The default method is the zero-tail completion
proposed by Sy and Taylor (2000).</p>
</td></tr>
<tr><td><code id="cox_cure_net_+3A_tail_tau">tail_tau</code></td>
<td>
<p>A numeric number specifying the time of zero-tail
completion.  It will be used only if <code>tail_completion =
"zero-tau"</code>.  A reasonable choice must be a time point between the
largest event time and the largest survival time.</p>
</td></tr>
<tr><td><code id="cox_cure_net_+3A_pmin">pmin</code></td>
<td>
<p>A numeric number specifying the minimum value of probabilities
for sake of numerical stability.  The default value is <code>1e-5</code>.</p>
</td></tr>
<tr><td><code id="cox_cure_net_+3A_early_stop">early_stop</code></td>
<td>
<p>A logical value specifying whether to stop the iteration
once the negative log-likelihood unexpectedly increases, which may
suggest convergence on likelihood, or indicate numerical issues or
implementation bugs.  The default value is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="cox_cure_net_+3A_verbose">verbose</code></td>
<td>
<p>A logical value.  If <code>TRUE</code>, a verbose information will
be given along iterations for tracing the convergence.  The default
value is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="cox_cure_net_+3A_...">...</code></td>
<td>
<p>Other arguments for future usage.  A warning will be thrown if
any invalid argument is specified.</p>
</td></tr>
<tr><td><code id="cox_cure_net_+3A_surv_x">surv_x</code></td>
<td>
<p>A numeric matrix for the design matrix of the survival model
component.</p>
</td></tr>
<tr><td><code id="cox_cure_net_+3A_cure_x">cure_x</code></td>
<td>
<p>A numeric matrix for the design matrix of the cure rate model
component.  The design matrix should exclude an intercept term unless we
want to fit a model only including the intercept term.  In that case, we
need further set <code>cure_intercept = FALSE</code> to not standardize the
intercept term.</p>
</td></tr>
<tr><td><code id="cox_cure_net_+3A_cure_intercept">cure_intercept</code></td>
<td>
<p>A logical value specifying whether to add an intercept
term to the cure rate model component.  If <code>TRUE</code> by default, an
intercept term is included.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The model estimation procedure follows expectation maximization (EM)
algorithm.  Variable selection procedure through regularization by elastic
net penalty is developed based on cyclic coordinate descent and
majorization-minimization (MM) algorithm.
</p>


<h3>Value</h3>

<p><code>cox_cure_net</code> object for regular Cox cure rate model or
<code>cox_cure_net_uncer</code> object for Cox cure rate model with uncertain
events.
</p>


<h3>References</h3>

<p>Kuk, A. Y. C., &amp; Chen, C. (1992). A mixture model combining logistic
regression with proportional hazards regression. <em>Biometrika</em>, 79(3),
531&ndash;541.
</p>
<p>Masud, A., Tu, W., &amp; Yu, Z. (2018). Variable selection for mixture and
promotion time cure rate models. <em>Statistical methods in medical
research</em>, 27(7), 2185&ndash;2199.
</p>
<p>Peng, Y. (2003). Estimating baseline distribution in proportional hazards
cure models. <em>Computational Statistics &amp; Data Analysis</em>, 42(1-2),
187&ndash;201.
</p>
<p>Sy, J. P., &amp; Taylor, J. M. (2000). Estimation in a Cox proportional hazards
cure model. <em>Biometrics</em>, 56(1), 227&ndash;236.
</p>
<p>Wang, W., Luo, C., Aseltine, R. H., Wang, F., Yan, J., &amp; Chen, K. (2020).
Suicide Risk Modeling with Uncertain Diagnostic Records. <em>arXiv
preprint arXiv:2009.02597</em>.
</p>
<p>Zou, H., &amp; Hastie, T. (2005). Regularization and variable selection via the
elastic net. <em>Journal of the Royal Statistical Society</em>: Series B
(Statistical Methodology), 67(2), 301&ndash;320.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cox_cure">cox_cure</a></code> for regular Cox cure rate model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(intsurv)

### regularized Cox cure rate model ==================================
## simulate a toy right-censored data with a cure fraction
set.seed(123)
n_obs &lt;- 100
p &lt;- 10
x_mat &lt;- matrix(rnorm(n_obs * p), nrow = n_obs, ncol = p)
colnames(x_mat) &lt;- paste0("x", seq_len(p))
surv_beta &lt;- c(rep(0, p - 5), rep(1, 5))
cure_beta &lt;- c(rep(1, 2), rep(0, p - 2))
dat &lt;- simData4cure(nSubject = n_obs, lambda_censor = 0.01,
                    max_censor = 10, survMat = x_mat,
                    survCoef = surv_beta, cureCoef = cure_beta,
                    b0 = 0.5, p1 = 1, p2 = 1, p3 = 1)

## model-fitting from given design matrices
fit1 &lt;- cox_cure_net.fit(x_mat, x_mat, dat$obs_time, dat$obs_event,
                         surv_nlambda = 10, cure_nlambda = 10,
                         surv_alpha = 0.8, cure_alpha = 0.8)

## model-fitting from given model formula
fm &lt;- paste(paste0("x", seq_len(p)), collapse = " + ")
surv_fm &lt;- as.formula(sprintf("~ %s", fm))
cure_fm &lt;- surv_fm
fit2 &lt;- cox_cure_net(surv_fm, cure_fm, data = dat,
                     time = obs_time, event = obs_event,
                     surv_alpha = 0.5, cure_alpha = 0.5)

## summary of BIC's
BIC(fit1)
BIC(fit2)

## list of coefficient estimates based on BIC
coef(fit1)
coef(fit2)


### regularized Cox cure model with uncertain event status ===========
## simulate a toy data
set.seed(123)
n_obs &lt;- 100
p &lt;- 10
x_mat &lt;- matrix(rnorm(n_obs * p), nrow = n_obs, ncol = p)
colnames(x_mat) &lt;- paste0("x", seq_len(p))
surv_beta &lt;- c(rep(0, p - 5), rep(1, 5))
cure_beta &lt;- c(rep(1, 2), rep(0, p - 2))
dat &lt;- simData4cure(nSubject = n_obs, lambda_censor = 0.01,
                    max_censor = 10, survMat = x_mat,
                    survCoef = surv_beta, cureCoef = cure_beta,
                    b0 = 0.5, p1 = 0.95, p2 = 0.95, p3 = 0.95)

## model-fitting from given design matrices
fit1 &lt;- cox_cure_net.fit(x_mat, x_mat, dat$obs_time, dat$obs_event,
                         surv_nlambda = 5, cure_nlambda = 5,
                         surv_alpha = 0.8, cure_alpha = 0.8)

## model-fitting from given model formula
fm &lt;- paste(paste0("x", seq_len(p)), collapse = " + ")
surv_fm &lt;- as.formula(sprintf("~ %s", fm))
cure_fm &lt;- surv_fm
fit2 &lt;- cox_cure_net(surv_fm, cure_fm, data = dat,
                     time = obs_time, event = obs_event,
                     surv_nlambda = 5, cure_nlambda = 5,
                     surv_alpha = 0.5, cure_alpha = 0.5)

## summary of BIC's
BIC(fit1)
BIC(fit2)

## list of coefficient estimates based on BIC
coef(fit1)
coef(fit2)
</code></pre>

<hr>
<h2 id='iCoxph'>Integrative Cox Model for Uncertain Event Times</h2><span id='topic+iCoxph'></span>

<h3>Description</h3>

<p>Fit an integrative Cox model proposed by Wang et al. (2020) for
right-censored survival data with uncertain event times due to imperfect
data integration.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>iCoxph(
  formula,
  data,
  subset,
  na.action,
  contrasts = NULL,
  start = iCoxph.start(),
  control = iCoxph.control(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="iCoxph_+3A_formula">formula</code></td>
<td>
<p><code>Survi</code> object specifying the covariates and response
variable in the model, such as <code>Survi(ID, time, event) ~ x1 + x2</code>.</p>
</td></tr>
<tr><td><code id="iCoxph_+3A_data">data</code></td>
<td>
<p>An optional data frame, list, or environment that contains the
covariates and response variables included in the model. If not found in
data, the variables are taken from <code>environment(formula)</code>, usually
the environment from which this function is called.</p>
</td></tr>
<tr><td><code id="iCoxph_+3A_subset">subset</code></td>
<td>
<p>An optional logical vector specifying a subset of observations
to be used in the fitting process.</p>
</td></tr>
<tr><td><code id="iCoxph_+3A_na.action">na.action</code></td>
<td>
<p>An optional function that indicates what should the
procedure do if the data contains <code>NA</code>s.  The default is set by the
na.action setting of <code><a href="base.html#topic+options">options</a></code>.  The &quot;factory-fresh&quot;
default is <code><a href="stats.html#topic+na.omit">na.omit</a></code>.  Other possible values include
<code><a href="stats.html#topic+na.fail">na.fail</a></code>, <code><a href="stats.html#topic+na.exclude">na.exclude</a></code>, and
<code><a href="stats.html#topic+na.pass">na.pass</a></code>.  <code>help(na.fail)</code> for details.</p>
</td></tr>
<tr><td><code id="iCoxph_+3A_contrasts">contrasts</code></td>
<td>
<p>An optional list, whose entries are values (numeric
matrices or character strings naming functions) to be used as
replacement values for the contrasts replacement function and whose
names are the names of columns of data containing factors.  See
<code>contrasts.arg</code> of <code><a href="stats.html#topic+model.matrix.default">model.matrix.default</a></code> for
details.</p>
</td></tr>
<tr><td><code id="iCoxph_+3A_start">start</code></td>
<td>
<p>A list returned by function <code><a href="#topic+iCoxph.start">iCoxph.start</a></code>
specifying starting values of the parameters to be estimated in the
model. Please refer to the arguments of <code><a href="#topic+iCoxph.start">iCoxph.start</a></code> for
the available parameters.</p>
</td></tr>
<tr><td><code id="iCoxph_+3A_control">control</code></td>
<td>
<p>A list returned by function <code><a href="#topic+iCoxph.control">iCoxph.control</a></code>
specifying control parameters for the model estimation procedure.
Please refer to the arguments of <code><a href="#topic+iCoxph.control">iCoxph.control</a></code> for the
available parameters.</p>
</td></tr>
<tr><td><code id="iCoxph_+3A_...">...</code></td>
<td>
<p>Other arguments for future usage.  A warning will be thrown if
any invalid argument is specified.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code><a href="#topic+iCoxph-class">iCoxph-class</a></code> object, whose slots include
</p>

<ul>
<li> <p><code>call</code>: Function call.
</p>
</li>
<li> <p><code>formula</code>: Formula used in the model fitting.
</p>
</li>
<li> <p><code>data</code>: A processed data frame used for model fitting.
</p>
</li>
<li> <p><code>nObs</code>: Number of observation.
</p>
</li>
<li> <p><code>estimates</code>:
</p>

<ul>
<li> <p><code>beta</code>: Coefficient estimates.
</p>
</li>
<li> <p><code>pi</code>: Estimated parameters in prior multinomial
distribution indicating the probabilities of corresponding
record being true.
</p>
</li>
<li> <p><code>baseline</code>: A data frame that contains estimated
baseline hazard function with columns named <code>time</code> and
<code>h0</code>.
</p>
</li></ul>

</li>
<li> <p><code>start</code>: The initial guesses <code>beta_mat</code> and
<code>pi_mat</code> specified for the parameters to be estimated,
and the set of initial guess <code>beta_start</code> and <code>pi_start</code>
that resulted in the largest objective function, i.e.,
the observed-data likelihood function.
</p>
</li>
<li> <p><code>control</code>: The control list specified for model fitting.
</p>
</li>
<li> <p><code>na.action</code>: The procedure specified to deal with
missing values in the covariate.
</p>
</li>
<li> <p><code>xlevels</code>: A list that records the levels in
each factor variable.
</p>
</li>
<li> <p><code>contrasts</code>: Contrasts specified and used for each
factor variable.
</p>
</li>
<li> <p><code>convergeCode</code>: <code>code</code> returned by function
<code><a href="stats.html#topic+nlm">nlm</a></code>, which is an integer indicating why the
optimization process terminated. <code>help(nlm)</code> for details.
</p>
</li>
<li> <p><code>logL</code>: A numeric vector containing the observed-data
log-likelihood over iterations.
</p>
</li></ul>



<h3>References</h3>

<p>Wang, W., Aseltine, R. H., Chen, K., &amp; Yan, J. (2020). Integrative Survival
Analysis with Uncertain Event Times in Application to A Suicide Risk
Study. <em>Annals of Applied Statistics</em>, 14(1), 51&ndash;73.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+iCoxph.start">iCoxph.start</a></code> and <code><a href="#topic+iCoxph.control">iCoxph.control</a></code>, respectively,
for starting and controlling iCoxph fitting;
<code><a href="#topic+summary+2CiCoxph-method">summary,iCoxph-method</a></code> for summary of fitted model;
<code><a href="#topic+coef+2CiCoxph-method">coef,iCoxph-method</a></code> for estimated covariate coefficients;
<code><a href="#topic+bootSe">bootSe</a></code> for SE estimates from bootstrap methods.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(intsurv)
## generate simulated survival data with uncertain records
set.seed(123)
simuDat &lt;- simData4iCoxph(nSubject = 200)
## fit the integertive Cox model
fit &lt;- iCoxph(Survi(ID, time, event) ~ x1 + x2 + x3 + x4,
              data = simuDat, start = iCoxph.start(methods = "nearest"),
              control = iCoxph.control(tol_beta = 1e-5))
## estimated covariate coefficients
coef(fit)
## get SE estimates by bootstrap
fit &lt;- bootSe(fit, B = 30)
## summary of the fitted model
summary(fit)
</code></pre>

<hr>
<h2 id='iCoxph-class'>An S4 Class to Represent a Fitted Integrative Cox Model</h2><span id='topic+iCoxph-class'></span>

<h3>Description</h3>

<p>The <code>iCoxph</code> class is an S4 class that represents a fitted model.
Function <code><a href="#topic+iCoxph">iCoxph</a></code> produces objects of this class.  See &ldquo;Slots&rdquo;
for details.
</p>


<h3>Slots</h3>


<dl>
<dt><code>call</code></dt><dd><p>Function call.</p>
</dd>
<dt><code>formula</code></dt><dd><p>Model formula.</p>
</dd>
<dt><code>nObs</code></dt><dd><p>A positive integer.</p>
</dd>
<dt><code>data</code></dt><dd><p>A data frame.</p>
</dd>
<dt><code>estimates</code></dt><dd><p>A list.</p>
</dd>
<dt><code>start</code></dt><dd><p>A list.</p>
</dd>
<dt><code>control</code></dt><dd><p>A list.</p>
</dd>
<dt><code>na.action</code></dt><dd><p>A length-one character vector.</p>
</dd>
<dt><code>xlevels</code></dt><dd><p>A list.</p>
</dd>
<dt><code>contrasts</code></dt><dd><p>A list.</p>
</dd>
<dt><code>convergeCode</code></dt><dd><p>A non-negative integer.</p>
</dd>
<dt><code>logL</code></dt><dd><p>A numeric value.</p>
</dd>
</dl>


<h3>See Also</h3>

<p><code><a href="#topic+iCoxph">iCoxph</a></code> for details of slots.
</p>

<hr>
<h2 id='iCoxph.control'>Auxiliary for Controlling iCoxph Fitting</h2><span id='topic+iCoxph.control'></span>

<h3>Description</h3>

<p>Auxiliary function for <code><a href="#topic+iCoxph">iCoxph</a></code> that enable users to specify the
control parameters of the model estimation procedure.  Internally, the
arguments <code>cm_gradtol</code>, <code>cm_stepmax</code>, <code>cm_steptol</code>, and
<code>cm_max_iter</code> are passed to function <code><a href="stats.html#topic+nlm">nlm</a></code> as
<code>gradtol</code>, <code>stepmax</code>, <code>steptol</code>, and <code>iterlim</code>,
respectively.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>iCoxph.control(
  tol_beta = 1e-06,
  tol_pi = 1e-08,
  cm_gradtol = 1e-06,
  cm_stepmax = 100,
  cm_steptol = 1e-06,
  cm_max_iter = 100,
  ecm_max_iter = 200,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="iCoxph.control_+3A_tol_beta">tol_beta</code></td>
<td>
<p>A positive value specifying the tolerance that concludes the
convergence of the covariate coefficient estimates. The tolerance is
compared with the relative change between the estimates from two
consecutive iterations that is measured by ratio of the L2-norm of their
difference to the sum of their L2-norm.  The default value is
<code>1e-6</code>.</p>
</td></tr>
<tr><td><code id="iCoxph.control_+3A_tol_pi">tol_pi</code></td>
<td>
<p>A positive value specifying the tolerance that concludes the
convergence of the probability estimates of uncertain records being
true.  The tolerance is compared with the relative change between the
estimates from two consecutive iterations measured by ratio of L2-norm
of their difference to the L2-norm of their sum.  The default value is
<code>1e-8</code>.</p>
</td></tr>
<tr><td><code id="iCoxph.control_+3A_cm_gradtol">cm_gradtol</code></td>
<td>
<p>A positive scalar giving the tolerance at which the scaled
gradient is considered close enough to zero to terminate CM steps.  The
default value is <code>1e-6</code>.</p>
</td></tr>
<tr><td><code id="iCoxph.control_+3A_cm_stepmax">cm_stepmax</code></td>
<td>
<p>A positive scalar that gives the maximum allowable scaled
step length in CM steps.  The default value is <code>1e2</code>.</p>
</td></tr>
<tr><td><code id="iCoxph.control_+3A_cm_steptol">cm_steptol</code></td>
<td>
<p>A positive scalar providing the minimum allowable relative
step length in CM step.  The default value is <code>1e-6</code>.</p>
</td></tr>
<tr><td><code id="iCoxph.control_+3A_cm_max_iter">cm_max_iter</code></td>
<td>
<p>A positive integer specifying the maximum number of
iterations to be performed before each CM step is terminated. The
default value is <code>1e2</code>.</p>
</td></tr>
<tr><td><code id="iCoxph.control_+3A_ecm_max_iter">ecm_max_iter</code></td>
<td>
<p>A positive integer specifying the maximum number of
iterations to be performed before the ECM algorithm is terminated. The
default value is <code>2e2</code>.</p>
</td></tr>
<tr><td><code id="iCoxph.control_+3A_...">...</code></td>
<td>
<p>Other arguments for future usage.  A warning will be thrown if
any invalid argument is specified.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of class <code>intsurv-iCoxph.control</code> containing all
specified control parameters.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+iCoxph">iCoxph</a></code> for fitting integrative Cox model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See examples of function 'iCoxph'.

</code></pre>

<hr>
<h2 id='iCoxph.start'>Auxiliary for Starting iCoxph Fitting</h2><span id='topic+iCoxph.start'></span>

<h3>Description</h3>

<p>Auxiliary function for <code><a href="#topic+iCoxph">iCoxph</a></code> that enable users
to specify the starting values of the model estimation procedure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>iCoxph.start(
  beta_vec = NULL,
  beta_mat = NULL,
  methods = c("nearest_hazard", "unit_hazard"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="iCoxph.start_+3A_beta_vec">beta_vec</code></td>
<td>
<p>A numeric vector for starting values of coefficient
estimates. The default values are the coefficient estimates from the
regular Cox model only fitting on records without uncertainty.  If
censoring rate among subjects having unique certain records is extremely
high (&gt; 99
indicator and one predictor, the starting values will be reset to be all
zeros.</p>
</td></tr>
<tr><td><code id="iCoxph.start_+3A_beta_mat">beta_mat</code></td>
<td>
<p>A numeric matrix that consists of additional starting values
of coefficient estimates in columns.  The default value is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="iCoxph.start_+3A_methods">methods</code></td>
<td>
<p>A character vector specifying the initialization methods for
probabilities of uncertain records being true.  The available methods
are <code>"nearest_hazard"</code> for initializing baseline hazard by nearest
(left) neighbor, and <code>"unit_hazard"</code> for initializing unit baseline
hazard.  Partial matching on method names is supported for ease of
typing.  By default, both methods are used.  See Wang et al. (2020) for
details of the initialization methods.</p>
</td></tr>
<tr><td><code id="iCoxph.start_+3A_...">...</code></td>
<td>
<p>Other arguments for future usage.  A warning will be thrown if
any invalid argument is specified.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of class <code>intsurv-iCoxph.start</code> containing all specified
starting values of the parameters to be estimated from the model.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+iCoxph">iCoxph</a></code> for fitting integrative Cox model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See examples of function 'iCoxph'.

</code></pre>

<hr>
<h2 id='show-method'>Show Methods</h2><span id='topic+show-method'></span><span id='topic+show+2CiCoxph-method'></span><span id='topic+show+2Csummary.iCoxph-method'></span>

<h3>Description</h3>

<p>S4 class methods that display or summarize certain objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'iCoxph'
show(object)

## S4 method for signature 'summary.iCoxph'
show(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="show-method_+3A_object">object</code></td>
<td>
<p>An object used to dispatch a method.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> For <code><a href="#topic+iCoxph-class">iCoxph-class</a></code> object, it prints out a brief summary
of the fitted model.
</p>
</li>
<li><p> For <code><a href="#topic+summary.iCoxph-class">summary.iCoxph-class</a></code> object, it prints out summary
of a fitted model.
</p>
</li></ul>



<h3>Value</h3>

<p>object input (invisibly).
</p>

<hr>
<h2 id='simData4cure'>Simulate Data from Cox Cure Model with Uncertain Event Status</h2><span id='topic+simData4cure'></span>

<h3>Description</h3>

<p>Simulate Data from Cox Cure Model with Uncertain Event Status
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simData4cure(
  nSubject = 1000,
  shape = 2,
  scale = 0.1,
  lambda_censor = 1,
  max_censor = Inf,
  p1 = 0.9,
  p2 = 0.9,
  p3 = 0.9,
  survMat,
  cureMat = survMat,
  b0 = stats::binomial()$linkfun(0.7),
  survCoef = rep(1, ncol(survMat)),
  cureCoef = rep(1, ncol(cureMat)),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simData4cure_+3A_nsubject">nSubject</code></td>
<td>
<p>A positive integer specifying number of subjects.</p>
</td></tr>
<tr><td><code id="simData4cure_+3A_shape">shape</code></td>
<td>
<p>A positive number specifying the shape parameter of the
distribution of the event times.</p>
</td></tr>
<tr><td><code id="simData4cure_+3A_scale">scale</code></td>
<td>
<p>A positive number specifying the scale parameter of the
distribution of the event times.</p>
</td></tr>
<tr><td><code id="simData4cure_+3A_lambda_censor">lambda_censor</code></td>
<td>
<p>A positive number specifying the rate parameter of the
exponential distribution for generating censoring times.</p>
</td></tr>
<tr><td><code id="simData4cure_+3A_max_censor">max_censor</code></td>
<td>
<p>A positive number specifying the largest censoring time.</p>
</td></tr>
<tr><td><code id="simData4cure_+3A_p1">p1</code></td>
<td>
<p>A number between 0 and 1 specifying the probability of simulating
events with observed event indicators given the simulated event times.</p>
</td></tr>
<tr><td><code id="simData4cure_+3A_p2">p2</code></td>
<td>
<p>A number between 0 and 1 specifying the probability of simulating
susceptible censoring times with observed event status given the
simulated susceptible censoring times.</p>
</td></tr>
<tr><td><code id="simData4cure_+3A_p3">p3</code></td>
<td>
<p>A number between 0 and 1 specifying the probability of simulating
cured censoring times with observed event status given the simulated
cured censoring times.</p>
</td></tr>
<tr><td><code id="simData4cure_+3A_survmat">survMat</code></td>
<td>
<p>A numeric matrix representing the design matrix of the
survival model part.</p>
</td></tr>
<tr><td><code id="simData4cure_+3A_curemat">cureMat</code></td>
<td>
<p>A numeric matrix representing the design matrix excluding
intercept of the cure rate model part.</p>
</td></tr>
<tr><td><code id="simData4cure_+3A_b0">b0</code></td>
<td>
<p>A number representing the intercept term for the cure rate model
part.</p>
</td></tr>
<tr><td><code id="simData4cure_+3A_survcoef">survCoef</code></td>
<td>
<p>A numeric vector for the covariate coefficients of the
survival model part.</p>
</td></tr>
<tr><td><code id="simData4cure_+3A_curecoef">cureCoef</code></td>
<td>
<p>A numeric vector for the covariate coefficients of the
cure model part.</p>
</td></tr>
<tr><td><code id="simData4cure_+3A_...">...</code></td>
<td>
<p>Other arguments not used currently.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame with the following columns:
</p>

<ul>
<li> <p><code>obs_time</code>: Observed event/survival times.
</p>
</li>
<li> <p><code>obs_event</code>: Observed event status.
</p>
</li>
<li> <p><code>event_time</code>: Underlying true event times.
</p>
</li>
<li> <p><code>censor_time</code>: underlying true censoring times.
</p>
</li>
<li> <p><code>oracle_event</code>: underlying true event indicators.
</p>
</li>
<li> <p><code>oracle_cure</code>: underlying true cure indicators.
</p>
</li>
<li> <p><code>case</code>: underlying true case labels.
</p>
</li></ul>



<h3>References</h3>

<p>Wang, W., Luo, C., Aseltine, R. H., Wang, F., Yan, J., &amp; Chen, K. (2020).
Suicide Risk Modeling with Uncertain Diagnostic Records. <em>arXiv
preprint arXiv:2009.02597</em>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## see examples of function cox_cure
</code></pre>

<hr>
<h2 id='simData4iCoxph'>Simulated Survival Data with Uncertain Records</h2><span id='topic+simData4iCoxph'></span>

<h3>Description</h3>

<p>Generate survival data with uncertain records.  An integrative Cox model can
be fitted for the simulated data by function <code><a href="#topic+iCoxph">iCoxph</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simData4iCoxph(
  nSubject = 1000,
  beta0Vec,
  xMat,
  maxNum = 2,
  nRecordProb = c(0.9, 0.1),
  matchCensor = 0.1,
  matchEvent = 0.1,
  censorMin = 0.5,
  censorMax = 12.5,
  lambda = 0.005,
  rho = 0.7,
  fakeLambda1 = lambda * exp(-3),
  fakeRho1 = rho,
  fakeLambda2 = lambda * exp(3),
  fakeRho2 = rho,
  mixture = 0.5,
  randomMiss = TRUE,
  eventOnly = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simData4iCoxph_+3A_nsubject">nSubject</code></td>
<td>
<p>Number of subjects.</p>
</td></tr>
<tr><td><code id="simData4iCoxph_+3A_beta0vec">beta0Vec</code></td>
<td>
<p>Time-invariant covariate coefficients.</p>
</td></tr>
<tr><td><code id="simData4iCoxph_+3A_xmat">xMat</code></td>
<td>
<p>Design matrix. By default, three continuous variables following
standard normal distribution and one binary variable following Bernoulli
distribution with equal probability are used.</p>
</td></tr>
<tr><td><code id="simData4iCoxph_+3A_maxnum">maxNum</code></td>
<td>
<p>Maximum number of uncertain records.</p>
</td></tr>
<tr><td><code id="simData4iCoxph_+3A_nrecordprob">nRecordProb</code></td>
<td>
<p>Probability of the number of uncertain records.</p>
</td></tr>
<tr><td><code id="simData4iCoxph_+3A_matchcensor">matchCensor</code></td>
<td>
<p>The matching rate for subjects actually having censoring
times.</p>
</td></tr>
<tr><td><code id="simData4iCoxph_+3A_matchevent">matchEvent</code></td>
<td>
<p>The matching rate for subjects actually having event
times.</p>
</td></tr>
<tr><td><code id="simData4iCoxph_+3A_censormin">censorMin</code></td>
<td>
<p>The lower boundary of the uniform distribution for
generating censoring time.</p>
</td></tr>
<tr><td><code id="simData4iCoxph_+3A_censormax">censorMax</code></td>
<td>
<p>The upper boundary of the uniform distribution for
generating censoring time.</p>
</td></tr>
<tr><td><code id="simData4iCoxph_+3A_lambda">lambda</code></td>
<td>
<p>A positive number, scale parameter in baseline rate function
for true event times.</p>
</td></tr>
<tr><td><code id="simData4iCoxph_+3A_rho">rho</code></td>
<td>
<p>A positive number, shape parameter in baseline rate function for
true event times.</p>
</td></tr>
<tr><td><code id="simData4iCoxph_+3A_fakelambda1">fakeLambda1</code></td>
<td>
<p>A positive number, scale parameter in baseline rate
function for fake event times from one distribution.</p>
</td></tr>
<tr><td><code id="simData4iCoxph_+3A_fakerho1">fakeRho1</code></td>
<td>
<p>A positive number, shape parameter in baseline rate function
for fake event times from one distribution.</p>
</td></tr>
<tr><td><code id="simData4iCoxph_+3A_fakelambda2">fakeLambda2</code></td>
<td>
<p>A positive number, scale parameter in baseline rate
function for fake event times from another distribution.</p>
</td></tr>
<tr><td><code id="simData4iCoxph_+3A_fakerho2">fakeRho2</code></td>
<td>
<p>A positive number, shape parameter in baseline rate function
for fake event times from another distribution.</p>
</td></tr>
<tr><td><code id="simData4iCoxph_+3A_mixture">mixture</code></td>
<td>
<p>The mixture weights, i.e., the probabilities (summing up to
one) of fake event times coming from different mixture components.</p>
</td></tr>
<tr><td><code id="simData4iCoxph_+3A_randommiss">randomMiss</code></td>
<td>
<p>A logical value specifying whether the labels of the true
records are missing completely at random (MCAR) or missing not at random
(MNAR). The default value is <code>TRUE</code> for MCAR.</p>
</td></tr>
<tr><td><code id="simData4iCoxph_+3A_eventonly">eventOnly</code></td>
<td>
<p>A logical value specifying whether the uncertain records
only include possible events. The default value is <code>FALSE</code>, which
considers the censoring cases as the possible truth in addition to event
records.</p>
</td></tr>
<tr><td><code id="simData4iCoxph_+3A_...">...</code></td>
<td>
<p>Other arguments for future usage.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The event times are simulated from a Weibull proportional hazard model of
given shape and baseline scale.  The censoring times follow uniform
distribution of specified boundaries.
</p>


<h3>Value</h3>

<p>A data frame with the following columns,
</p>

<ul>
<li> <p><code>ID</code>: subject ID
</p>
</li>
<li> <p><code>time</code>: observed event times
</p>
</li>
<li> <p><code>event</code>: event indicators
</p>
</li>
<li> <p><code>isTure</code>: latent labels indicating the true records
</p>
</li></ul>

<p>and the corresponding covariates.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See examples of function iCoxph
</code></pre>

<hr>
<h2 id='summary+2CiCoxph-method'>Summary of a Fitted Model</h2><span id='topic+summary+2CiCoxph-method'></span><span id='topic+summary.iCoxph'></span>

<h3>Description</h3>

<p>For <code><a href="#topic+iCoxph">iCoxph</a></code> object, the function returns a
<code><a href="#topic+summary.iCoxph">summary.iCoxph</a></code> object whose slots include
</p>

<ul>
<li> <p><code>call</code>: Function call of model fitting.
</p>
</li>
<li> <p><code>coefMat</code>: Estimated covariate coefficients.
</p>
</li>
<li> <p><code>logL</code>: Log-likelihood under observed data.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'iCoxph'
summary(object, showCall = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary+2B2CiCoxph-method_+3A_object">object</code></td>
<td>
<p><code><a href="#topic+iCoxph-class">iCoxph-class</a></code> object.</p>
</td></tr>
<tr><td><code id="summary+2B2CiCoxph-method_+3A_showcall">showCall</code></td>
<td>
<p>A logic value with default <code>TRUE</code>, indicating whether
<code>show</code> method prints out the original call information of
<code>iCoxph</code>.  Set <code>FALSE</code> for a more concise printout.</p>
</td></tr>
<tr><td><code id="summary+2B2CiCoxph-method_+3A_...">...</code></td>
<td>
<p>Other arguments for future usage.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>summary.iCoxph</code> class object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+iCoxph">iCoxph</a></code> for model fitting;
<code><a href="#topic+coef+2CiCoxph-method">coef,iCoxph-method</a></code> for coefficient estimates.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See examples of function iCoxph
</code></pre>

<hr>
<h2 id='summary.cox_cure'>Summary of a Fitted Model</h2><span id='topic+summary.cox_cure'></span><span id='topic+summary.cox_cure_uncer'></span>

<h3>Description</h3>

<p>Summarize a fitted Cox cure rate model with possible uncertain event status.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cox_cure'
summary(object, ...)

## S3 method for class 'cox_cure_uncer'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.cox_cure_+3A_object">object</code></td>
<td>
<p>Object representing a fitted model.</p>
</td></tr>
<tr><td><code id="summary.cox_cure_+3A_...">...</code></td>
<td>
<p>Other arguments for future usage.  A warning will be thrown if
any invalid argument is specified.</p>
</td></tr>
</table>

<hr>
<h2 id='summary.iCoxph-class'>An S4 Class to Represent Summary of a fitted integrative Cox model</h2><span id='topic+summary.iCoxph-class'></span>

<h3>Description</h3>

<p>The <code>summary.intsurv</code> class is an S4 class that represents a summarized
model.  Function <code><a href="#topic+summary+2CiCoxph-method">summary,iCoxph-method</a></code> produces objects of
this class.  See &ldquo;Slots&rdquo; for details.
</p>


<h3>Slots</h3>


<dl>
<dt><code>call</code></dt><dd><p>Function call.</p>
</dd>
<dt><code>coefMat</code></dt><dd><p>A matrix.</p>
</dd>
<dt><code>logL</code></dt><dd><p>A numeric value.</p>
</dd>
</dl>


<h3>See Also</h3>

<p><code><a href="#topic+summary+2CiCoxph-method">summary,iCoxph-method</a></code> for meaning of slots.
</p>

<hr>
<h2 id='Survi'>Formula Response for Survival Data With Uncertain Event Times</h2><span id='topic+Survi'></span>

<h3>Description</h3>

<p><code>Survi</code> returns an S4 class that represents formula response for
survival data with uncertain records due to imperfect data integration.  The
last letter 'i' in <code>Survi</code> represents 'integration'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Survi(ID, time, event, check = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Survi_+3A_id">ID</code></td>
<td>
<p>Identificator of each subject.</p>
</td></tr>
<tr><td><code id="Survi_+3A_time">time</code></td>
<td>
<p>Event times (whether certain or uncertain) or censoring times.</p>
</td></tr>
<tr><td><code id="Survi_+3A_event">event</code></td>
<td>
<p>The status indicator, 0 = censored, 1 = event.</p>
</td></tr>
<tr><td><code id="Survi_+3A_check">check</code></td>
<td>
<p>A logical value specifying whether to perform check on input
data.</p>
</td></tr>
<tr><td><code id="Survi_+3A_...">...</code></td>
<td>
<p>Other arguments for future usage.  A warning will be thrown if
any invalid argument is specified.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>Survi</code> object.  See <code><a href="#topic+Survi-class">Survi-class</a></code> for details.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See examples of function 'iCoxph'
</code></pre>

<hr>
<h2 id='Survi-class'>An S4 Class Representing Formula Response</h2><span id='topic+Survi-class'></span>

<h3>Description</h3>

<p>An S4 Class Representing Formula Response
</p>


<h3>Slots</h3>


<dl>
<dt><code>.Data</code></dt><dd><p>A numeric matrix object.</p>
</dd>
<dt><code>ID</code></dt><dd><p>Identificator of each subject.</p>
</dd>
</dl>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
