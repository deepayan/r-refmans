<!DOCTYPE html><html><head><title>Help for package phase</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {phase}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#allActograms'><p>Generate actograms</p></a></li>
<li><a href='#allPeriodogramsAct'><p>Periodogram analysis for activity data</p></a></li>
<li><a href='#allPeriodogramsSleep'><p>Periodogram analysis for sleep data</p></a></li>
<li><a href='#allSomnograms'><p>Generate actograms for sleep data (Somnograms)</p></a></li>
<li><a href='#anticipationAct'><p>Compute anticipation for activity data</p></a></li>
<li><a href='#binData'><p>Bin activity data to desired intervals</p></a></li>
<li><a href='#CoM'><p>Objectively quantify and visualise phases and calculate consolidation in pre-defined time-windows</p></a></li>
<li><a href='#df'><p>Example DAM data</p></a></li>
<li><a href='#indActogram'><p>Plot actogram of individual fly</p></a></li>
<li><a href='#indPeriodogramAct'><p>Periodogram plot for activity data of individual flies</p></a></li>
<li><a href='#indPeriodogramSleep'><p>Periodogram plot for sleep data of individual flies</p></a></li>
<li><a href='#indSomnogram'><p>Generate actograms for sleep data (Somnograms) for individual flies</p></a></li>
<li><a href='#peakIdentifier'><p>Phase identifier for activity data</p></a></li>
<li><a href='#profilesAct'><p>Compute and plot activity profiles</p></a></li>
<li><a href='#profilesSleep'><p>Compute and plot sleep profiles</p></a></li>
<li><a href='#rosePlotsAct'><p>Generate rose plots for averaged activity data</p></a></li>
<li><a href='#rosePlotsSleep'><p>Generate rose plots for averaged sleep data</p></a></li>
<li><a href='#sleepData'><p>Equivalent of binData() but for sleep data</p></a></li>
<li><a href='#sleepOnsetBoutLength'><p>Computes, tabulates and plots day-time and night-time onset of sleep bouts and their respective lengths</p></a></li>
<li><a href='#sleepStages'><p>Plot sleep stages in individual flies</p></a></li>
<li><a href='#sleepStat'><p>Computes and tabulates day-time and night-time sleep statistics</p></a></li>
<li><a href='#transitionProbs'><p>Plot and generate data for transition frequencies between sleep stages</p></a></li>
<li><a href='#trimData'><p>Trim data for downstream analyses</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Analyse Biological Time-Series Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.9</td>
</tr>
<tr>
<td>Author:</td>
<td>Lakshman Abhilash <a href="https://orcid.org/0000-0002-9933-8989"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Lakshman Abhilash &lt;labhilash@gc.cuny.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Compiles functions to trim, bin, visualise, and analyse activity/sleep time-series data collected from the Drosophila Activity Monitor (DAM) system (Trikinetics, USA). The following methods were used to compute periodograms - Chi-square periodogram: Sokolove and Bushell (1978) &lt;<a href="https://doi.org/10.1016%2F0022-5193%2878%2990022-X">doi:10.1016/0022-5193(78)90022-X</a>&gt;, Lomb-Scargle periodogram: Lomb (1976) &lt;<a href="https://doi.org/10.1007%2FBF00648343">doi:10.1007/BF00648343</a>&gt;, Scargle (1982) &lt;<a href="https://doi.org/10.1086%2F160554">doi:10.1086/160554</a>&gt; and Ruf (1999) &lt;<a href="https://doi.org/10.1076%2Fbrhm.30.2.178.1422">doi:10.1076/brhm.30.2.178.1422</a>&gt;, and Autocorrelation: Eijzenbach et al. (1986) &lt;<a href="https://doi.org/10.1111%2Fj.1440-1681.1986.tb00943.x">doi:10.1111/j.1440-1681.1986.tb00943.x</a>&gt;. Identification of activity peaks is done after using a Savitzky-Golay filter (Savitzky and Golay (1964) &lt;<a href="https://doi.org/10.1021%2Fac60214a047">doi:10.1021/ac60214a047</a>&gt;) to smooth raw activity data. Three methods to estimate anticipation of activity are used based on the following papers - Slope method: Fernandez et al. (2020) &lt;<a href="https://doi.org/10.1016%2Fj.cub.2020.04.025">doi:10.1016/j.cub.2020.04.025</a>&gt;, Harrisingh method: Harrisingh et al. (2007) &lt;<a href="https://doi.org/10.1523%2FJNEUROSCI.3680-07.2007">doi:10.1523/JNEUROSCI.3680-07.2007</a>&gt;, and Stoleru method: Stoleru et al. (2004) &lt;<a href="https://doi.org/10.1038%2Fnature02926">doi:10.1038/nature02926</a>&gt;. Rose plots and circular analysis are based on methods from - Batschelet (1981) &lt;ISBN:0120810506&gt; and Zar (2010) &lt;ISBN:0321656865&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-03-08 22:28:45 UTC; abhilashlakshman</td>
</tr>
<tr>
<td>Imports:</td>
<td>circular, lubridate, plotly, pracma, signal, zeitgebr, zoo,
behavr, wesanderson, shiny, shinythemes, shinydashboard,
shinycssloaders, shinyFiles</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-03-09 00:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='allActograms'>Generate actograms</h2><span id='topic+allActograms'></span>

<h3>Description</h3>

<p>This function generates a composite figure with actograms for all flies in a DAM scanned monitor file. Input for this function must be an output from the binData() function. The output of this function is a large plotly object. This function requires the packages &quot;plotly&quot; and &quot;zoo&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>allActograms(data, bin = 30, t.cycle = 24, color = rgb(0, 0, 0, 1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="allActograms_+3A_data">data</code></td>
<td>
<p>Input data file. The input for this function must be the output of the function binData(). See ??binData().</p>
</td></tr>
<tr><td><code id="allActograms_+3A_bin">bin</code></td>
<td>
<p>Intervals in which data are saved (in minutes). This defaults to 30.</p>
</td></tr>
<tr><td><code id="allActograms_+3A_t.cycle">t.cycle</code></td>
<td>
<p>Define the period of the environmental cycle or a single day in hours. This defaults to 24.</p>
</td></tr>
<tr><td><code id="allActograms_+3A_color">color</code></td>
<td>
<p>Color of actograms in rgb format. The input for this must be a vector with 4 values, i.e., r,g,b,transparency. The values for r,g,b can only be between 0 and 1. 0,0,0 would be black and 1,1,1 would be white. Transparency values can also go from 0 to 1, 0 being fully transparent and 1 being fully opaque.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>plotly</code> <code>htmlwidget</code> with 32 actograms in a 4-by-8 array.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>td &lt;- trimData(data = df, start.date = "19 Dec 20", start.time = "21:00",
n.days = 3, bin = 1, t.cycle = 24)
bd &lt;- binData(data = td)
actograms &lt;- allActograms(data = bd)
</code></pre>

<hr>
<h2 id='allPeriodogramsAct'>Periodogram analysis for activity data</h2><span id='topic+allPeriodogramsAct'></span>

<h3>Description</h3>

<p>This function generates a composite figure with periodogram plots for all flies in a DAM scanned monitor file. Input for this function must be an output from the trimData() function. The output of this function is a list with two components - (a) large plotly object with periodogram plots for all flies, and (b) a table which has channel wise information of significant period and adjusted power values, from the chosen time-series analysis method. This function requires the packages &quot;plotly&quot; and &quot;zeitgebr&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>allPeriodogramsAct(
  data,
  bin = 1,
  method = "ChiSquare",
  low.per = 16,
  high.per = 32,
  alpha = 0.05,
  time.res = 20
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="allPeriodogramsAct_+3A_data">data</code></td>
<td>
<p>Input data file. If the method for analysis is &quot;ChiSquare&quot;, then the input for this function must be the output of the function trimData(). See ??trimData(). Otherwise, the input for this function must be the output of the function binData(). See ??binData().</p>
</td></tr>
<tr><td><code id="allPeriodogramsAct_+3A_bin">bin</code></td>
<td>
<p>Intervals in which input data are sampled (in minutes). This defaults to 1. This must be changed appropriately depending on method of analysis and the input data set.</p>
</td></tr>
<tr><td><code id="allPeriodogramsAct_+3A_method">method</code></td>
<td>
<p>Choose the method for performing time-series analysis. Currently, three methods are implemented for analysis - &quot;ChiSquare&quot;, &quot;Autocorrelation&quot;, and &quot;LombScargle&quot;. This defaults to &quot;ChiSquare&quot;.</p>
</td></tr>
<tr><td><code id="allPeriodogramsAct_+3A_low.per">low.per</code></td>
<td>
<p>Choose the lowest period (in hours) for analysis. This defaults to 16.</p>
</td></tr>
<tr><td><code id="allPeriodogramsAct_+3A_high.per">high.per</code></td>
<td>
<p>Choose the highest period (in hours) for analysis. This defaults to 32.</p>
</td></tr>
<tr><td><code id="allPeriodogramsAct_+3A_alpha">alpha</code></td>
<td>
<p>Choose the significance level for periodogram analysis. This defaults to 0.05.</p>
</td></tr>
<tr><td><code id="allPeriodogramsAct_+3A_time.res">time.res</code></td>
<td>
<p>Resolution of periods (in minutes) to analyse while using the &quot;ChiSquare&quot; periodogram. For instance, if users wish to scan periods from low.per to high.per in the following manner: 16, 16.5, 17, 17.5, and so on, then time.res must be 30. This defaults to 20.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>list</code> with two items:
</p>

<dl>
<dt>Plots</dt><dd><p>A <code>plotly</code> <code>htmlwidget</code> with all periodograms in a 4-by-8 array.</p>
</dd>
<dt>Data</dt><dd><p>A <code>matrix</code> <code>array</code> with 32 rows (one for each fly) and 2 columns (Period and Adjusted Power).</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
td &lt;- trimData(data = df, start.date = "19 Dec 20", start.time = "21:00",
n.days = 5, bin = 1, t.cycle = 24)
all.periodograms.act &lt;- allPeriodogramsAct(data = td[,1:15])

## End(Not run)
</code></pre>

<hr>
<h2 id='allPeriodogramsSleep'>Periodogram analysis for sleep data</h2><span id='topic+allPeriodogramsSleep'></span>

<h3>Description</h3>

<p>This function generates a composite figure with periodogram plots for all flies in a DAM scanned monitor file. Input for this function must be an output from the sleepData() function. The output of this function is a list with two components - (a) large plotly object with periodogram plots for all flies, and (b) a table which has channel wise information of significant period and adjusted power values, from the chosen time-series analysis method. This function requires the packages &quot;plotly&quot; and &quot;zeitgebr&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>allPeriodogramsSleep(
  data,
  bin = 30,
  method = "ChiSquare",
  low.per = 16,
  high.per = 32,
  alpha = 0.05,
  time.res = 20
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="allPeriodogramsSleep_+3A_data">data</code></td>
<td>
<p>Input data file. The input for this function must be an output from one of either sleepData(). See ??sleepData().</p>
</td></tr>
<tr><td><code id="allPeriodogramsSleep_+3A_bin">bin</code></td>
<td>
<p>Intervals in which input data is saved (in minutes). This defaults to 30.</p>
</td></tr>
<tr><td><code id="allPeriodogramsSleep_+3A_method">method</code></td>
<td>
<p>Choose the method for performing time-series analysis. Currently, three methods are implemented for analysis - &quot;ChiSquare&quot;, &quot;Autocorrelation&quot;, and &quot;LombScargle&quot;. This defaults to &quot;ChiSquare&quot;.</p>
</td></tr>
<tr><td><code id="allPeriodogramsSleep_+3A_low.per">low.per</code></td>
<td>
<p>Choose the lowest period (in hours) for analysis. This defaults to 16.</p>
</td></tr>
<tr><td><code id="allPeriodogramsSleep_+3A_high.per">high.per</code></td>
<td>
<p>Choose the highest period (in hours) for analysis. This defaults to 32.</p>
</td></tr>
<tr><td><code id="allPeriodogramsSleep_+3A_alpha">alpha</code></td>
<td>
<p>Choose the significance level for periodogram analysis. This defaults to 0.05.</p>
</td></tr>
<tr><td><code id="allPeriodogramsSleep_+3A_time.res">time.res</code></td>
<td>
<p>Resolution of periods (in minutes) to analyse while using the ChiSquare periodogram. For instance, if users wish to scan periods from low.per to high.per in the following manner: 16, 16.5, 17, 17.5, and so on, then time.res must be 30. This defaults to 20.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>list</code> with two items:
</p>

<dl>
<dt>Plots</dt><dd><p>A <code>plotly</code> <code>htmlwidget</code> with all periodograms in a 4-by-8 array.</p>
</dd>
<dt>Data</dt><dd><p>A <code>matrix</code> <code>array</code> with 32 rows (one for each fly) and 2 columns (Period and Adjusted Power).</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>td &lt;- trimData(data = df, start.date = "19 Dec 20", start.time = "21:00",
n.days = 5, bin = 1, t.cycle = 24)
sd &lt;- sleepData(td)
all.periodograms.sleep &lt;- allPeriodogramsSleep(data = sd[,1:6])
</code></pre>

<hr>
<h2 id='allSomnograms'>Generate actograms for sleep data (Somnograms)</h2><span id='topic+allSomnograms'></span>

<h3>Description</h3>

<p>This function generates a composite figure with actograms (referred to as somnograms, here) for all flies in a DAM scanned monitor file. Input for this function must be an output from the trimData() function. The output of this function is a large plotly object. This function requires the packages &quot;plotly&quot; and &quot;zoo&quot;.
In a particular bin, sleep is calculated as the total minutes of inactivity equal to or greater than the defined threshold (sleep.def; typically, 5-minutes).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>allSomnograms(
  data,
  sleep.def = c(5),
  bin = 30,
  t.cycle = 24,
  color = rgb(0, 0, 0, 1)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="allSomnograms_+3A_data">data</code></td>
<td>
<p>Input data file. The input for this function must be the output of the function trimData(). See ??trimData().</p>
</td></tr>
<tr><td><code id="allSomnograms_+3A_sleep.def">sleep.def</code></td>
<td>
<p>Definition of sleep. Traditionally, a single bout of sleep is defined as any duration of inactivity that is equal to or greater than 5-minutes. However, sometimes it may be of interest to examine longer bouts of sleep or specific bout durations; sleep.def allows users to change the definition of sleep. The default input is a single value vector of value 5. If users wish to analyse sleep only between 5 to 20 mins, the input must be c(5,20).</p>
</td></tr>
<tr><td><code id="allSomnograms_+3A_bin">bin</code></td>
<td>
<p>Intervals in which data are saved (in minutes). This defaults to 30. The value of bin cannot be lower than that of sleep.def.</p>
</td></tr>
<tr><td><code id="allSomnograms_+3A_t.cycle">t.cycle</code></td>
<td>
<p>Define the period of the environmental cycle or a single day in hours. This defaults to 24.</p>
</td></tr>
<tr><td><code id="allSomnograms_+3A_color">color</code></td>
<td>
<p>Color of somnograms in rgb format. The input for this must be a vector with 4 values, i.e., r,g,b,transparency. The values for r,g,b can only be between 0 and 1. 0,0,0 would be black and 1,1,1 would be white. Transparency values can also go from 0 to 1, 0 being fully transparent and 1 being fully opaque.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>plotly</code> <code>htmlwidget</code> with 32 somnograms in a 4-by-8 array.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>td &lt;- trimData(data = df, start.date = "19 Dec 20", start.time = "21:00",
n.days = 3, bin = 1, t.cycle = 24)
somnograms &lt;- allSomnograms(data = td[,1:15])
</code></pre>

<hr>
<h2 id='anticipationAct'>Compute anticipation for activity data</h2><span id='topic+anticipationAct'></span>

<h3>Description</h3>

<p>This function calculates anticipation of activity in user-defined windows. The input for this function must be the output of the trimData() function. There are three choices for the estimation of anticipation. The &quot;Slope&quot; method simply finds best-fitting lines to activity data in the defined windows (by using linear regressions). The slope of this line, for each fly, is used as a measure of anticipation. The &quot;Stoleru&quot; method is based on the estimates used in the paper by Stoleru et al., 2004 (https://doi.org/10.1038/nature02926). The authors estimate progressive increase in activity before environmental transitions, scaled by the startle response (immediately post-transition). The &quot;Harrisingh&quot; method is based on the method used by Harrisingh et al., 2007 (10.1523/JNEUROSCI.3680-07.2007). In this method, the authors simply examine activity in a 3-hour interval before environmental transitions, scaled by activity in the 6-hour interval before the transitions. Only if method = &quot;Slope&quot;, the output of this function is a list with three elements, i.e., plots of the regression line along with the activity in the morning window, plots of the regression line along with the activity in the evening window, and a table with the morning and evening anticipation values. In the other two cases, the output of this function is only a table with the morning and evening anticipation values. No plots will be generated.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anticipationAct(
  data,
  method = "Slope",
  t.cycle = 24,
  morn.win.start,
  eve.win.start,
  eve.win.end,
  rm.channels = c(),
  max.y.morn = "auto",
  max.y.eve = "auto"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="anticipationAct_+3A_data">data</code></td>
<td>
<p>Input data file. The input for this function must be the output of the function trimData(). See ??trimData().</p>
</td></tr>
<tr><td><code id="anticipationAct_+3A_method">method</code></td>
<td>
<p>Choose the method for estimating anticipation. The three possible choices are, (i) &quot;Slope&quot;, (ii) &quot;Stoleru&quot; and (iii) &quot;Harrisingh&quot;. This defaults to &quot;Slope&quot;. See Description for more details on these methods.</p>
</td></tr>
<tr><td><code id="anticipationAct_+3A_t.cycle">t.cycle</code></td>
<td>
<p>Define the period of the environmental cycle or a single day in hours. This defaults to 24.</p>
</td></tr>
<tr><td><code id="anticipationAct_+3A_morn.win.start">morn.win.start</code></td>
<td>
<p>Define the start of morning window in ZT. ZT00 is the onset of zeitgeber; in case of light/dark cycles, ZT00 is the time at which lights turn ON. The end of the morning window is considered as ZT00.</p>
</td></tr>
<tr><td><code id="anticipationAct_+3A_eve.win.start">eve.win.start</code></td>
<td>
<p>Define the start of evening window in ZT.</p>
</td></tr>
<tr><td><code id="anticipationAct_+3A_eve.win.end">eve.win.end</code></td>
<td>
<p>Define the end of evening window.</p>
</td></tr>
<tr><td><code id="anticipationAct_+3A_rm.channels">rm.channels</code></td>
<td>
<p>A vector of channels from a DAM monitor that must be discarded from analysis. If channels 1 to 5 must be removed, type in c(1:5). If channels 1 to 5 and 10 to 13 and 15 and 17 must be removed, type in c(1:5,10:13,15,17). Default is to include all individuals.</p>
</td></tr>
<tr><td><code id="anticipationAct_+3A_max.y.morn">max.y.morn</code></td>
<td>
<p>Set the upper limit of the y-axis in the plot for morning window.</p>
</td></tr>
<tr><td><code id="anticipationAct_+3A_max.y.eve">max.y.eve</code></td>
<td>
<p>Set the upper limit of the y-axis in the plot for evening window.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If method = &quot;Slope&quot;, a <code>list</code> with two items, else a <code>matrix</code> <code>array</code> with 32 rows (one for each fly) and 3 columns (Channel/Fly identity, Morning anticipation index and Evening anticipation index).
</p>

<p>If method = &quot;Slope&quot;:
</p>
<dl>
<dt>Plot.morn</dt><dd><p>A <code>plotly</code> <code>htmlwidget</code> with the anticipation estimates for the morning window.</p>
</dd>
<dt>Plot.eve</dt><dd><p>A <code>plotly</code> <code>htmlwidget</code> with the anticipation estimates for the evening window.</p>
</dd>
<dt>Data</dt><dd><p>A <code>matrix</code> <code>array</code> with 32 rows (one for each fly) and 3 columns (Channel/Fly identity, Morning anticipation index and Evening anticipation index).</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>td &lt;- trimData(data = df, start.date = "19 Dec 20", start.time = "21:00",
n.days = 10, bin = 1, t.cycle = 24)
anticip &lt;- anticipationAct(data = td, method = "Stoleru", t.cycle = 24,
                           morn.win.start = 21,
                           eve.win.start = 9, eve.win.end = 12,
                           rm.channels = c())
</code></pre>

<hr>
<h2 id='binData'>Bin activity data to desired intervals</h2><span id='topic+binData'></span>

<h3>Description</h3>

<p>Allows users to bin data sets into intervals of time different from the data collection interval. The input for this function must be the output of the trimData() function. The output of this function is a data frame. The first column of which stores Zeitgeber Time values (assuming that the start.time in the trimData() function was set at Zeitgeber Time 00). All subsequent columns have binned activity data for each fly.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>binData(data, input.bin = 1, output.bin = 30, t.cycle = 24)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="binData_+3A_data">data</code></td>
<td>
<p>Input data file. The input for this function must be the output of the function trimData(). See ??trimData().</p>
</td></tr>
<tr><td><code id="binData_+3A_input.bin">input.bin</code></td>
<td>
<p>Define the bin size (in minutes) in the input file. This defaults to 1.</p>
</td></tr>
<tr><td><code id="binData_+3A_output.bin">output.bin</code></td>
<td>
<p>Define the desired output bin size (in minutes). This defaults to 30.</p>
</td></tr>
<tr><td><code id="binData_+3A_t.cycle">t.cycle</code></td>
<td>
<p>Define the period of the environmental cycle or a single day in hours. This defaults to 24.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>matrix</code> <code>array</code> with 33 columns (number of rows depends on number of days, and the input parameters of this function):
</p>

<dl>
<dt>ZT</dt><dd><p>ZT values starting at ZT00 (time at which light turns ON).</p>
</dd>
<dt>I1:I32</dt><dd><p>Columns of binned locomotor activity data (each column represents a single fly).</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>td &lt;- trimData(data = df, start.date = "19 Dec 20", start.time = "21:00",
n.days = 10, bin = 1, t.cycle = 24)
bd &lt;- binData(data = td)
bd &lt;- binData(data = td, input.bin = 1, output.bin = 15, t.cycle = 24)
</code></pre>

<hr>
<h2 id='CoM'>Objectively quantify and visualise phases and calculate consolidation in pre-defined time-windows</h2><span id='topic+CoM'></span>

<h3>Description</h3>

<p>This function calculates phase of center of mass of either activity or sleep data, and generates polar plots. The function also computes consolidation of activity or sleep in the defined windows of time. The output of this function is a list, the elements of which are a polar plot with the phases in each window for each fly, depicted, and a table which has the window specific times in ZT units and the consolidation values. For this function to work as expected, users must start the analysis at ZT00.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CoM(
  input,
  data = "Activity",
  bin = 30,
  t.cycle = 24,
  window = list(c(21, 3), c(9, 15)),
  rm.channels = c()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CoM_+3A_input">input</code></td>
<td>
<p>Input data file. The input for this function must be the output of the function binData(), sleepData() or ??wakeData(). See ??binData(), ??sleepData() and ??wakeData().</p>
</td></tr>
<tr><td><code id="CoM_+3A_data">data</code></td>
<td>
<p>If the input for this function is the output of binData() or sleepData(), then this must be &quot;Activity&quot; or &quot;Sleep&quot;, respectively.</p>
</td></tr>
<tr><td><code id="CoM_+3A_bin">bin</code></td>
<td>
<p>Intervals in which input data are saved (in minutes). This defaults to 30.</p>
</td></tr>
<tr><td><code id="CoM_+3A_t.cycle">t.cycle</code></td>
<td>
<p>Define the period of the environmental cycle or a single day in hours. This defaults to 24.</p>
</td></tr>
<tr><td><code id="CoM_+3A_window">window</code></td>
<td>
<p>A list of vectors, each defining the start and end ZT values of the window of interest. For instance, if users want to define the morning window as ZT21 to ZT03 and evening window as ZT09 to ZT15, then this should be list(c(21,3), c(9,15)). This defaults to list(c(18,6), c(6,18)). For the purposes of the polar plot, data from only the first two windows are used. But, for the data table, users can define as many windows as they like, and the function should work as expected.</p>
</td></tr>
<tr><td><code id="CoM_+3A_rm.channels">rm.channels</code></td>
<td>
<p>A vector of channels from a DAM monitor that must be discarded from analysis. If channels 1 to 5 must be removed, type in c(1:5). If channels 1 to 5 and 10 to 13 and 15 and 17 must be removed, type in c(1:5,10:13,15,17). Default is to include all individuals.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>list</code> with two items:
</p>

<dl>
<dt>Plot</dt><dd><p>A <code>plotly</code> <code>htmlwidget</code> with the center of mass plotted and averages plotted for each window.</p>
</dd>
<dt>Data</dt><dd><p>A <code>data.frame</code> with 32 rows (one for each fly) and 1 + (number of user defined windows * 2) columns (First column contains channel/fly identity and the remaining columns contain the fly-wise consolidation and center of mass values.)</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>td &lt;- trimData(data = df, start.date = "19 Dec 20", start.time = "21:00",
n.days = 10, bin = 1, t.cycle = 24)
bd &lt;- binData(td)
phase &lt;- CoM(input = bd)
</code></pre>

<hr>
<h2 id='df'>Example DAM data</h2><span id='topic+df'></span>

<h3>Description</h3>

<p>A sample <code>data.frame</code> which has beam crossing data was collected every minute to facilitate activity and sleep analysis. Data is collected for wildtype flies under LD 12:12 and DD at 25 degree Celsius using the Drosophila Activity Monitoring (DAM) system, Trikinetics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>df
</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> containing 28234 rows and 42 variables:
</p>

<dl>
<dt>V1:V10</dt><dd><p>Several columns of information generated by DAMScan. Only two columns here are of interest to us. Column V2 which has date information and column V3 which has time of day information.</p>
</dd>
<dt>V11:V42</dt><dd><p>Activity counts for each of the 32 flies recorded in a single activity monitor.</p>
</dd>
</dl>


<hr>
<h2 id='indActogram'>Plot actogram of individual fly</h2><span id='topic+indActogram'></span>

<h3>Description</h3>

<p>Allows users to generate individual actograms. The input for this function must be the output of the binData() function. The output of this function is a plotly object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>indActogram(
  data,
  bin = 30,
  t.cycle = 24,
  ind = 1,
  key.acto = 1,
  color = rgb(0, 0, 0, 1)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="indActogram_+3A_data">data</code></td>
<td>
<p>Input data file. The input for this function must be the output of the function binData(). See ??binData().</p>
</td></tr>
<tr><td><code id="indActogram_+3A_bin">bin</code></td>
<td>
<p>Define the bin size (in minutes) in which input data is saved.</p>
</td></tr>
<tr><td><code id="indActogram_+3A_t.cycle">t.cycle</code></td>
<td>
<p>Define the period of the environmental cycle or a single day in hours. This defaults to 24.</p>
</td></tr>
<tr><td><code id="indActogram_+3A_ind">ind</code></td>
<td>
<p>The channel number (or individual) whose actogram must be plotted.</p>
</td></tr>
<tr><td><code id="indActogram_+3A_key.acto">key.acto</code></td>
<td>
<p>Key for reactive input tables in the shiny app.</p>
</td></tr>
<tr><td><code id="indActogram_+3A_color">color</code></td>
<td>
<p>Color of actograms in rgb format. The input for this must be a vector with 4 values, i.e., r,g,b,transparency. The values for r,g,b can only be between 0 and 1. 0,0,0 would be black and 1,1,1 would be white. Transparency values can also go from 0 to 1, 0 being fully transparent and 1 being fully opaque.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>plotly</code> <code>htmlwidget</code> with the actogram of a user defined fly.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
td &lt;- trimData(data = df, start.date = "19 Dec 20", start.time = "21:00",
n.days = 10, bin = 1, t.cycle = 24)
bd &lt;- binData(td)
ind.actogram &lt;- indActogram(data = bd, bin = 30, ind = 2)

## End(Not run)
</code></pre>

<hr>
<h2 id='indPeriodogramAct'>Periodogram plot for activity data of individual flies</h2><span id='topic+indPeriodogramAct'></span>

<h3>Description</h3>

<p>This function generates a periodogram for the activity data of a single fly. Input for this function must be an output from the trimData() function. The output of this function is a plotly object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>indPeriodogramAct(
  data,
  bin = 1,
  method = "ChiSquare",
  low.per = 16,
  high.per = 32,
  alpha = 0.05,
  time.res = 20,
  ind = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="indPeriodogramAct_+3A_data">data</code></td>
<td>
<p>Input data file. If the method for analysis is &quot;ChiSquare&quot;, then the input for this function must be the output of the function trimData(). See ??trimData(). Otherwise, the input for this function must be the output of the function binData(). See ??binData().</p>
</td></tr>
<tr><td><code id="indPeriodogramAct_+3A_bin">bin</code></td>
<td>
<p>Intervals in which data are sampled (in minutes). This defaults to 1. This must be changed appropriately depending on method of analysis and the input data set.</p>
</td></tr>
<tr><td><code id="indPeriodogramAct_+3A_method">method</code></td>
<td>
<p>Choose the method for performing time-series analysis. Currently, three methods are implemented for analysis - &quot;ChiSquare&quot;, &quot;Autocorrelation&quot;, and &quot;LombScargle&quot;. This defaults to &quot;ChiSquare&quot;.</p>
</td></tr>
<tr><td><code id="indPeriodogramAct_+3A_low.per">low.per</code></td>
<td>
<p>Choose the lowest period (in hours) for analysis. This defaults to 16.</p>
</td></tr>
<tr><td><code id="indPeriodogramAct_+3A_high.per">high.per</code></td>
<td>
<p>Choose the highest period (in hours) for analysis. This defaults to 32.</p>
</td></tr>
<tr><td><code id="indPeriodogramAct_+3A_alpha">alpha</code></td>
<td>
<p>Choose the significance level for periodogram analysis. This defaults to 0.05.</p>
</td></tr>
<tr><td><code id="indPeriodogramAct_+3A_time.res">time.res</code></td>
<td>
<p>Resolution of periods (in minutes) to analyse while using the ChiSquare periodogram. For instance, if users wish to scan periods from low.per to high.per in the following manner: 16, 16.5, 17, 17.5, and so on, then time.res must be 30. This defaults to 20.</p>
</td></tr>
<tr><td><code id="indPeriodogramAct_+3A_ind">ind</code></td>
<td>
<p>The channel number (or individual) whose periodogram must be plotted.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>plotly</code> <code>htmlwidget</code> with the individual periodogram of a user defined fly.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>td &lt;- trimData(data = df, start.date = "19 Dec 20", start.time = "21:00",
n.days = 10, bin = 1, t.cycle = 24)
ind.periodogram.act &lt;- indPeriodogramAct(data = td, ind = 13)
</code></pre>

<hr>
<h2 id='indPeriodogramSleep'>Periodogram plot for sleep data of individual flies</h2><span id='topic+indPeriodogramSleep'></span>

<h3>Description</h3>

<p>This function generates a periodogram for the sleep data of a single fly. The output of this function is a plotly object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>indPeriodogramSleep(
  data,
  bin = 30,
  method = "ChiSquare",
  low.per = 16,
  high.per = 32,
  alpha = 0.05,
  time.res = 20,
  ind = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="indPeriodogramSleep_+3A_data">data</code></td>
<td>
<p>Input data file. The input for this function must be an output from one of either sleepData(), deepSleepData() or lightSleepData() functions. See ??sleepData(), ??deepSleepData() and/or ??lightSleepData().</p>
</td></tr>
<tr><td><code id="indPeriodogramSleep_+3A_bin">bin</code></td>
<td>
<p>Intervals in which input data is saved (in minutes). This defaults to 30.</p>
</td></tr>
<tr><td><code id="indPeriodogramSleep_+3A_method">method</code></td>
<td>
<p>Choose the method for performing time-series analysis. Currently, three methods are implemented for analysis - &quot;ChiSquare&quot;, &quot;Autocorrelation&quot;, and &quot;LombScargle&quot;. This defaults to &quot;ChiSquare&quot;.</p>
</td></tr>
<tr><td><code id="indPeriodogramSleep_+3A_low.per">low.per</code></td>
<td>
<p>Choose the lowest period (in hours) for analysis. This defaults to 16.</p>
</td></tr>
<tr><td><code id="indPeriodogramSleep_+3A_high.per">high.per</code></td>
<td>
<p>Choose the highest period (in hours) for analysis. This defaults to 32.</p>
</td></tr>
<tr><td><code id="indPeriodogramSleep_+3A_alpha">alpha</code></td>
<td>
<p>Choose the significance level for periodogram analysis. This defaults to 0.05.</p>
</td></tr>
<tr><td><code id="indPeriodogramSleep_+3A_time.res">time.res</code></td>
<td>
<p>Resolution of periods (in minutes) to analyse while using the ChiSquare periodogram. For instance, if users wish to scan periods from low.per to high.per in the following manner: 16, 16.5, 17, 17.5, and so on, then time.res must be 30. This defaults to 20.</p>
</td></tr>
<tr><td><code id="indPeriodogramSleep_+3A_ind">ind</code></td>
<td>
<p>The channel number (or individual) whose periodogram must be plotted.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>plotly</code> <code>htmlwidget</code> with the individual periodogram of a user defined fly.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>td &lt;- trimData(data = df, start.date = "19 Dec 20", start.time = "21:00",
n.days = 3, bin = 1, t.cycle = 24)
sd &lt;- sleepData(td)
ind.periodogram.sleep &lt;- indPeriodogramSleep(data = sd, ind = 10)
</code></pre>

<hr>
<h2 id='indSomnogram'>Generate actograms for sleep data (Somnograms) for individual flies</h2><span id='topic+indSomnogram'></span>

<h3>Description</h3>

<p>This function generates a somnogram for a single fly. Input for this function must be an output from the trimData() function. The output of this function is a plotly object.
In a particular bin, sleep is calculated as the total minutes of inactivity equal to or greater than the defined threshold (sleep.def; typically, 5-minutes).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>indSomnogram(
  data,
  sleep.def = c(5),
  bin = 30,
  t.cycle = 24,
  ind = 1,
  key.somno = 1,
  color = rgb(0, 0, 0, 1)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="indSomnogram_+3A_data">data</code></td>
<td>
<p>Input data file. The input for this function must be the output of the function trimData(). See ??trimData().</p>
</td></tr>
<tr><td><code id="indSomnogram_+3A_sleep.def">sleep.def</code></td>
<td>
<p>Definition of sleep. Traditionally, a single bout of sleep is defined as any duration of inactivity that is equal to or greater than 5-minutes. However, sometimes it may be of interest to examine longer bouts of sleep; sleep.def allows users to change the definition of sleep. This defaults to 5.</p>
</td></tr>
<tr><td><code id="indSomnogram_+3A_bin">bin</code></td>
<td>
<p>Intervals in which data are saved (in minutes). This defaults to 30. The value of bin cannot be lower than that of sleep.def.</p>
</td></tr>
<tr><td><code id="indSomnogram_+3A_t.cycle">t.cycle</code></td>
<td>
<p>Define the period of the environmental cycle or a single day in hours. This defaults to 24.</p>
</td></tr>
<tr><td><code id="indSomnogram_+3A_ind">ind</code></td>
<td>
<p>The channel number (or individual) whose periodogram must be plotted.</p>
</td></tr>
<tr><td><code id="indSomnogram_+3A_key.somno">key.somno</code></td>
<td>
<p>Key for reactive input tables in the shiny app.</p>
</td></tr>
<tr><td><code id="indSomnogram_+3A_color">color</code></td>
<td>
<p>Color of somnograms in rgb format. The input for this must be a vector with 4 values, i.e., r,g,b,transparency. The values for r,g,b can only be between 0 and 1. 0,0,0 would be black and 1,1,1 would be white. Transparency values can also go from 0 to 1, 0 being fully transparent and 1 being fully opaque.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>plotly</code> <code>htmlwidget</code> with the somnogram of a user defined fly.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>td &lt;- trimData(data = df, start.date = "19 Dec 20", start.time = "21:00",
n.days = 10, bin = 1, t.cycle = 24)
somnogram &lt;- indSomnogram(data = td, ind = 21)
</code></pre>

<hr>
<h2 id='peakIdentifier'>Phase identifier for activity data</h2><span id='topic+peakIdentifier'></span>

<h3>Description</h3>

<p>This function generates a list of outputs. The first element is a plot of raw activity along with the smoothed data and objectively estimated phases of peak of activity data. Smoothing of activity is done using a Savitzky-Golay filter. The input of this function must be the output of the trimData function. This function requires the packages &quot;plotly&quot;, &quot;pracma&quot; and &quot;signal&quot;. As of now, this function works only for 24-hour T-cycles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>peakIdentifier(
  data,
  filt.order = 3,
  filt.length = 51,
  min.peak.dist = 100,
  peak.ht.scal = 0.5,
  ZT = c(0, 12),
  rm.channels = c()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="peakIdentifier_+3A_data">data</code></td>
<td>
<p>Input data file. The input for this function must be the output of the function trimData(). See ??trimData(). This assumes that the output from trimData has data binned in 1-min intervals.</p>
</td></tr>
<tr><td><code id="peakIdentifier_+3A_filt.order">filt.order</code></td>
<td>
<p>The filter order. This defaults to 3.</p>
</td></tr>
<tr><td><code id="peakIdentifier_+3A_filt.length">filt.length</code></td>
<td>
<p>The length of filter in indices. This defaults to 51.</p>
</td></tr>
<tr><td><code id="peakIdentifier_+3A_min.peak.dist">min.peak.dist</code></td>
<td>
<p>The minimum distance between peaks to be picked (in indices). This defaults to 100.</p>
</td></tr>
<tr><td><code id="peakIdentifier_+3A_peak.ht.scal">peak.ht.scal</code></td>
<td>
<p>A scaling factor to identify peaks. This defaults to 0.5. A value of 0.5 will only find peaks that are at least half as tall as that of the tallest peak.</p>
</td></tr>
<tr><td><code id="peakIdentifier_+3A_zt">ZT</code></td>
<td>
<p>A vector defining the regions around which the algorithm must looks for peaks. This defaults to c(0,12). The first value in this vector is always assumed to be the morning peak.</p>
</td></tr>
<tr><td><code id="peakIdentifier_+3A_rm.channels">rm.channels</code></td>
<td>
<p>All the channels that users want to remove from their averaging. This must be a vector, i.e., channels must be separated by commas. For instance, if users choose to remove channels 1 to 5, 25 and 32, then the input should be either c(1,2,3,4,5,25,32) or c(1:5,25,32). This defaults to an empty vector, meaning no individuals are removed from analysis.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>list</code> with two items:
</p>

<dl>
<dt>Plots</dt><dd><p>A <code>plotly</code> <code>htmlwidget</code> with all the averaged activity overlayed with the smoothed data and markers to point out identified peaks in a 4-by-8 array.</p>
</dd>
<dt>Data</dt><dd><p>A <code>matrix</code> <code>array</code> with 32 rows (one for each fly) and 9 columns (Channel/Fly identity, Phases of morning peak onset, maxima and offset, Morning peak height, Phases of evening peak onset, maxima and offset, and Evening peak height (all phases are measured in ZT)).</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>td &lt;- trimData(data = df, start.date = "19 Dec 20", start.time = "21:00",
n.days = 3, bin = 1, t.cycle = 24)
pks &lt;- peakIdentifier(data = td)
</code></pre>

<hr>
<h2 id='profilesAct'>Compute and plot activity profiles</h2><span id='topic+profilesAct'></span>

<h3>Description</h3>

<p>Users can compute average profiles and visualise the same. Averages can be performed either over Flies, Days, Both or None. Except in the case of &quot;None&quot; the output of this function will be a list with two elements. One is the generated plot and the other is a table with the activity values and corresponding standard errors of the mean.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>profilesAct(
  data,
  bin = 30,
  t.cycle = 24,
  average.type = "Both",
  rm.channels = c()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="profilesAct_+3A_data">data</code></td>
<td>
<p>Input data file. The input for this function must be the output of the function binData(). See ??binData().</p>
</td></tr>
<tr><td><code id="profilesAct_+3A_bin">bin</code></td>
<td>
<p>Intervals in which data are saved (in minutes). This defaults to 30. This value must be the same as that for binData().</p>
</td></tr>
<tr><td><code id="profilesAct_+3A_t.cycle">t.cycle</code></td>
<td>
<p>Define the period of the environmental cycle or a single day in hours. This defaults to 24. This value must be the same as that for binData().</p>
</td></tr>
<tr><td><code id="profilesAct_+3A_average.type">average.type</code></td>
<td>
<p>Define how the averaging must be done for computing profiles. There are 4 choices; i) &quot;Flies&quot;: This will average over all the flies for the number of days of data that there are, and produce an averaged time-series, ii) &quot;Days&quot;: This will average activity over all the days but for each fly and provide 32 averaged plots, iii) &quot;Both&quot;: This will average over both flies and days and provide one composite average profile, iv) &quot;None&quot;: This will not average and produce any plots; the output will be the same as the input file. This defaults to &quot;Both&quot;.</p>
</td></tr>
<tr><td><code id="profilesAct_+3A_rm.channels">rm.channels</code></td>
<td>
<p>All the channels that users want to remove from their averaging. This must be a vector, i.e., channels must be separated by commas. For instance, if users choose to remove channels 1 to 5, 25 and 32, then the input should be either c(1,2,3,4,5,25,32) or c(1:5,25,32). This defaults to an empty vector, meaning no individuals are removed from analysis.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Except when average.type = &quot;None&quot;, a <code>list</code> with two items. When average.type = &quot;None&quot;, input file is returned.
</p>

<p>If average.type = &quot;Days&quot;:
</p>
<dl>
<dt>Profiles</dt><dd>

<dl>
<dt>ZT</dt><dd><p>Column with ZT values.</p>
</dd>
<dt>I1:I32</dt><dd><p>Data averaged over days for each of 32 flies.</p>
</dd>
<dt>ZT</dt><dd><p>Column with ZT values.</p>
</dd>
<dt>I1:I32</dt><dd><p>SEM (across days) for each of 32 flies.</p>
</dd>
</dl>

</dd>
<dt>Plot</dt><dd><p>A <code>plotly</code> <code>htmlwidget</code> with the activity profiles in a 4-by-8 array.</p>
</dd>
</dl>
<p>If average.type = &quot;Flies&quot;:
</p>
<dl>
<dt>Profiles</dt><dd>

<dl>
<dt>ZT</dt><dd><p>Column with ZT values.</p>
</dd>
<dt>Mean</dt><dd><p>Data averaged over all 32 flies for the entire duration of chosen days.</p>
</dd>
<dt>SEM</dt><dd><p>SEM (across flies).</p>
</dd>
</dl>

</dd>
<dt>Plot</dt><dd><p>A <code>plotly</code> <code>htmlwidget</code> with the activity time-series.</p>
</dd>
</dl>
<p>If average.type = &quot;Both&quot;:
</p>
<dl>
<dt>Profiles</dt><dd>

<dl>
<dt>ZT</dt><dd><p>Column with ZT values.</p>
</dd>
<dt>Mean</dt><dd><p>Data averaged over all days and all 32 flies.</p>
</dd>
<dt>SEM</dt><dd><p>SEM (across flies).</p>
</dd>
</dl>

</dd>
<dt>Plot</dt><dd><p>A <code>plotly</code> <code>htmlwidget</code> with the activity profile.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>td &lt;- trimData(data = df, start.date = "19 Dec 20", start.time = "21:00",
n.days = 10, bin = 1, t.cycle = 24)
bd &lt;- binData(td)
pro &lt;- profilesAct(data = bd)
pro &lt;- profilesAct(data = bd, bin = 60, t.cycle = 32,
average.type = "Days", rm.channels = c(1:5,25,32))
</code></pre>

<hr>
<h2 id='profilesSleep'>Compute and plot sleep profiles</h2><span id='topic+profilesSleep'></span>

<h3>Description</h3>

<p>Users can compute average profiles and visualise the same. Averages can be performed either over Flies, Days, Both or None. Except in the case of &quot;None&quot; the output of this function will be a list with two elements. One is the generated plot and the other is a table with the activity values and corresponding standard errors of the mean.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>profilesSleep(
  data,
  bin = 30,
  t.cycle = 24,
  average.type = "Both",
  rm.channels = c()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="profilesSleep_+3A_data">data</code></td>
<td>
<p>Input data file. The input for this function must be the output of the function sleepData(). See ??sleepData().</p>
</td></tr>
<tr><td><code id="profilesSleep_+3A_bin">bin</code></td>
<td>
<p>Intervals in which data are saved (in minutes). This defaults to 30. This value must be the same as that for sleepData().</p>
</td></tr>
<tr><td><code id="profilesSleep_+3A_t.cycle">t.cycle</code></td>
<td>
<p>Define the period of the environmental cycle or a single day in hours. This defaults to 24. This value must be the same as that for sleepData().</p>
</td></tr>
<tr><td><code id="profilesSleep_+3A_average.type">average.type</code></td>
<td>
<p>Define how the averaging must be done for computing profiles. There are 4 choices; i) &quot;Flies&quot;: This will average over all the flies for the number of days of data that there are, and produce an averaged time-series, ii) &quot;Days&quot;: This will average activity over all the days but for each fly and provide 32 averaged plots, iii) &quot;Both&quot;: This will average over both flies and days and provide one composite average profile, iv) &quot;None&quot;: This will not average and produce any plots; the output will be the same as the input file. This defaults to &quot;Both&quot;.</p>
</td></tr>
<tr><td><code id="profilesSleep_+3A_rm.channels">rm.channels</code></td>
<td>
<p>All the channels that users want to remove from their averaging. This must be a vector, i.e., channels must be separated by commas. For instance, if users choose to remove channels 1 to 5, 25 and 32, then the input should be either c(1,2,3,4,5,25,32) or c(1:5,25,32). This defaults to an empty vector, meaning no individuals are removed from analysis.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Except when average.type = &quot;None&quot;, a <code>list</code> with two items. When average.type = &quot;None&quot;, input file is returned.
</p>

<p>If average.type = &quot;Days&quot;:
</p>
<dl>
<dt>Profiles</dt><dd>

<dl>
<dt>ZT</dt><dd><p>Column with ZT values.</p>
</dd>
<dt>I1:I32</dt><dd><p>Data averaged over days for each of 32 flies.</p>
</dd>
<dt>ZT</dt><dd><p>Column with ZT values.</p>
</dd>
<dt>I1:I32</dt><dd><p>SEM (across days) for each of 32 flies.</p>
</dd>
</dl>

</dd>
<dt>Plot</dt><dd><p>A <code>plotly</code> <code>htmlwidget</code> with the sleep profiles in a 4-by-8 array.</p>
</dd>
</dl>
<p>If average.type = &quot;Flies&quot;:
</p>
<dl>
<dt>Profiles</dt><dd>

<dl>
<dt>ZT</dt><dd><p>Column with ZT values.</p>
</dd>
<dt>Mean</dt><dd><p>Data averaged over all 32 flies for the entire duration of chosen days.</p>
</dd>
<dt>SEM</dt><dd><p>SEM (across flies).</p>
</dd>
</dl>

</dd>
<dt>Plot</dt><dd><p>A <code>plotly</code> <code>htmlwidget</code> with the sleep time-series.</p>
</dd>
</dl>
<p>If average.type = &quot;Both&quot;:
</p>
<dl>
<dt>Profiles</dt><dd>

<dl>
<dt>ZT</dt><dd><p>Column with ZT values.</p>
</dd>
<dt>Mean</dt><dd><p>Data averaged over all days and all 32 flies.</p>
</dd>
<dt>SEM</dt><dd><p>SEM (across flies).</p>
</dd>
</dl>

</dd>
<dt>Plot</dt><dd><p>A <code>plotly</code> <code>htmlwidget</code> with the sleep profile.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>td &lt;- trimData(data = df, start.date = "19 Dec 20", start.time = "21:00",
n.days = 3, bin = 1, t.cycle = 24)
sd &lt;- sleepData(td)
pro &lt;- profilesSleep(data = sd)
</code></pre>

<hr>
<h2 id='rosePlotsAct'>Generate rose plots for averaged activity data</h2><span id='topic+rosePlotsAct'></span>

<h3>Description</h3>

<p>Users can generate rose plots for the averaged activity data. The input for this function must be output from binData(). The output of this function is a plotly object. By default the averaging of profiles is done over all flies and days.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rosePlotsAct(data, bin = 30, t.cycle = 24, rm.channels = c())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rosePlotsAct_+3A_data">data</code></td>
<td>
<p>Input data file. The input for this function must be the output of the function binData(). See ??binData().</p>
</td></tr>
<tr><td><code id="rosePlotsAct_+3A_bin">bin</code></td>
<td>
<p>Intervals in which data are saved (in minutes). This defaults to 30. This value must be the same as that for binData().</p>
</td></tr>
<tr><td><code id="rosePlotsAct_+3A_t.cycle">t.cycle</code></td>
<td>
<p>Define the period of the environmental cycle or a single day in hours. This defaults to 24. This value must be the same as that for binData().</p>
</td></tr>
<tr><td><code id="rosePlotsAct_+3A_rm.channels">rm.channels</code></td>
<td>
<p>All the channels that users want to remove from their averaging. This must be a vector, i.e., channels must be separated by commas. For instance, if users choose to remove channels 1 to 5, 25 and 32, then the input should be either c(1,2,3,4,5,25,32) or c(1:5,25,32). This defaults to an empty vector, meaning no individuals are removed from analysis.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>plotly</code> htmlwidget with rose plots for locomotor activity.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>td &lt;- trimData(data = df, start.date = "19 Dec 20", start.time = "21:00",
n.days = 10, bin = 1, t.cycle = 24)
bd &lt;- binData(td)
r.plot &lt;- rosePlotsAct(data = bd)
</code></pre>

<hr>
<h2 id='rosePlotsSleep'>Generate rose plots for averaged sleep data</h2><span id='topic+rosePlotsSleep'></span>

<h3>Description</h3>

<p>Users can generate rose plots for the averaged sleep data. The input for this function must be output from sleepData(). The output of this function is a plotly object. By default the averaging of profiles is done over all flies and days.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rosePlotsSleep(data, bin = 30, t.cycle = 24, rm.channels = c())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rosePlotsSleep_+3A_data">data</code></td>
<td>
<p>Input data file. The input for this function must be the output of the function sleepData(). See ??sleepData().</p>
</td></tr>
<tr><td><code id="rosePlotsSleep_+3A_bin">bin</code></td>
<td>
<p>Intervals in which data are saved (in minutes). This defaults to 30. This value must be the same as that for sleepData().</p>
</td></tr>
<tr><td><code id="rosePlotsSleep_+3A_t.cycle">t.cycle</code></td>
<td>
<p>Define the period of the environmental cycle or a single day in hours. This defaults to 24. This value must be the same as that for sleepData().</p>
</td></tr>
<tr><td><code id="rosePlotsSleep_+3A_rm.channels">rm.channels</code></td>
<td>
<p>All the channels that users want to remove from their averaging. This must be a vector, i.e., channels must be separated by commas. For instance, if users choose to remove channels 1 to 5, 25 and 32, then the input should be either c(1,2,3,4,5,25,32) or c(1:5,25,32). This defaults to an empty vector, meaning no individuals are removed from analysis.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>#' @return A <code>plotly</code> htmlwidget with rose plots for sleep data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>td &lt;- trimData(data = df, start.date = "19 Dec 20", start.time = "21:00",
n.days = 1, bin = 1, t.cycle = 24)
sd &lt;- sleepData(td)
r.plot &lt;- rosePlotsSleep(data = sd)
</code></pre>

<hr>
<h2 id='sleepData'>Equivalent of binData() but for sleep data</h2><span id='topic+sleepData'></span>

<h3>Description</h3>

<p>Allows users to bin data sets into intervals of time different from the data collection interval. The input for this function must be the output of the trimData() function. The output of this function is a data frame. The first column of which stores Zeitgeber Time values (assuming that the start.time in the trimData() function was set at Zeitgeber Time 00). All subsequent columns have binned sleep data for each fly.
In a particular bin, sleep is calculated as the total minutes of inactivity equal to or greater than the defined threshold (sleep.def; typically, 5-minutes).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sleepData(data, sleep.def = c(5), bin = 30, t.cycle = 24)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sleepData_+3A_data">data</code></td>
<td>
<p>Input data file. The input for this function must be the output of the function trimData(). See ??trimData().</p>
</td></tr>
<tr><td><code id="sleepData_+3A_sleep.def">sleep.def</code></td>
<td>
<p>Definition of sleep. Traditionally, a single bout of sleep is defined as any duration of inactivity that is equal to or greater than 5-minutes. However, sometimes it may be of interest to examine longer bouts of sleep or specific bout durations; sleep.def allows users to change the definition of sleep. The default input is a single value vector of value 5. If users wish to analyse sleep only between 5 to 20 mins, the input must be c(5,20).</p>
</td></tr>
<tr><td><code id="sleepData_+3A_bin">bin</code></td>
<td>
<p>Intervals in which data are saved (in minutes). This defaults to 30. The value of bin cannot be lower than that of sleep.def.</p>
</td></tr>
<tr><td><code id="sleepData_+3A_t.cycle">t.cycle</code></td>
<td>
<p>Define the period of the environmental cycle or a single day in hours. This defaults to 24.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.frame</code> with 33 columns (number of rows depends on number of days, and the input parameters of this function):
</p>

<dl>
<dt>ZT</dt><dd><p>ZT values starting at ZT00 (time at which light turns ON).</p>
</dd>
<dt>I1:I32</dt><dd><p>Columns of binned sleep data (each column represents a single fly).</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>td &lt;- trimData(data = df, start.date = "19 Dec 20", start.time = "21:00",
n.days = 4, bin = 1, t.cycle = 24)
sd &lt;- sleepData(data = td[,1:15])
</code></pre>

<hr>
<h2 id='sleepOnsetBoutLength'>Computes, tabulates and plots day-time and night-time onset of sleep bouts and their respective lengths</h2><span id='topic+sleepOnsetBoutLength'></span>

<h3>Description</h3>

<p>This function allows users to compute day-time and night-time onset of sleep bouts and their respective bout lengths. Also generates a plot to visualise and compare within and across day and night-time windows. The input for this function must be the output from the trimData() function. Number of days to analyse must be at least 2 days. If the number of days is more than 2 days, the function will compute statistics for the first day only. The output of this function is a list with three elements, i.e., &quot;Daytime.Data&quot; is a data frame which has the onset of sleep bout (minutes since the start of the day window) and the length of that bout (in minutes) for each fly, &quot;Nighttime.Data&quot; which is the same as &quot;Daytime.Data&quot; but for the night window, and &quot;Plots&quot; which allows the visualisation of the two data sets.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sleepOnsetBoutLength(data, sleep.def = c(5), t.cycle = 24, photoperiod = 12)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sleepOnsetBoutLength_+3A_data">data</code></td>
<td>
<p>Input data file. The input for this function must be the output of the function trimData(). See ??trimData().</p>
</td></tr>
<tr><td><code id="sleepOnsetBoutLength_+3A_sleep.def">sleep.def</code></td>
<td>
<p>Definition of sleep. Traditionally, a single bout of sleep is defined as any duration of inactivity that is equal to or greater than 5-minutes. However, sometimes it may be of interest to examine longer bouts of sleep or specific bout durations; sleep.def allows users to change the definition of sleep. The default input is a single value vector of value 5. If users wish to analyse sleep only between 5 to 20 mins, the input must be c(5,20).</p>
</td></tr>
<tr><td><code id="sleepOnsetBoutLength_+3A_t.cycle">t.cycle</code></td>
<td>
<p>Define the period of the environmental cycle or a single day in hours. This defaults to 24.</p>
</td></tr>
<tr><td><code id="sleepOnsetBoutLength_+3A_photoperiod">photoperiod</code></td>
<td>
<p>Duration (in hours) of what can be considered day-phase. This defaults to 12.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>list</code> with three items:
</p>

<dl>
<dt>Daytime.Data</dt><dd>

<dl>
<dt>Channel</dt><dd><p>Fly identity.</p>
</dd>
<dt>Start</dt><dd><p>Onset of sleep bout (in minutes since the start of day window)</p>
</dd>
<dt>BoutLength</dt><dd><p>Length of the sleep bout (in minutes)</p>
</dd>
</dl>

</dd>
<dt>Nighttim.Data</dt><dd>

<dl>
<dt>Channel</dt><dd><p>Fly identity.</p>
</dd>
<dt>Start</dt><dd><p>Onset of sleep bout (in minutes since the start of night window)</p>
</dd>
<dt>BoutLength</dt><dd><p>Length of the sleep bout (in minutes)</p>
</dd>
</dl>

</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>td &lt;- trimData(data = df, start.date = "28 Dec 20", start.time = "21:00",
n.days = 2, bin = 1, t.cycle = 24)
bout.onset.vs.length &lt;- sleepOnsetBoutLength(data = td)
</code></pre>

<hr>
<h2 id='sleepStages'>Plot sleep stages in individual flies</h2><span id='topic+sleepStages'></span>

<h3>Description</h3>

<p>Allows users to generate individual plots of sleep stages in flies. Sleep stages are defined as follows: 5 to 30-min as short sleep (light blue), 30 to 60-min as intermediate sleep (medium blue) and 60 to 720-min as deep sleep (dark blue). Activity is plotted in red. The input for this function must be the output of the trimData() function. The output of this function is a plot. Note: At this moment, this works accurately only for 24-h days.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sleepStages(data, n.days, channel = 1, photoperiod = 12)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sleepStages_+3A_data">data</code></td>
<td>
<p>Input data file. The input for this function must be the output of the function trimData(). See ??trimData().</p>
</td></tr>
<tr><td><code id="sleepStages_+3A_n.days">n.days</code></td>
<td>
<p>The number of cycles for which sleep stages must be visualized.</p>
</td></tr>
<tr><td><code id="sleepStages_+3A_channel">channel</code></td>
<td>
<p>The channel number of the fly to be visualized.</p>
</td></tr>
<tr><td><code id="sleepStages_+3A_photoperiod">photoperiod</code></td>
<td>
<p>This value determines the duration of photo-phase and scoto-phase of the 24-h day. Defaults to 12.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>plot</code> with the day-time and night-time sleep stages of a user defined fly for the number of cycles provided by the user.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
td &lt;- trimData(data = df, start.date = "19 Dec 20", start.time = "21:00",
n.days = 2, bin = 1, t.cycle = 24)
sleepStages(data = td, n.days = 1)

## End(Not run)
</code></pre>

<hr>
<h2 id='sleepStat'>Computes and tabulates day-time and night-time sleep statistics</h2><span id='topic+sleepStat'></span>

<h3>Description</h3>

<p>This function allows users to estimate day-time and night-time average sleep bout duration, number and latency. Sleep bout latency is defined as the time taken (in minutes) for the occurrence of the first sleep bout since respective transitions. The input for this function must be the output from the trimData() function. The output of this function is a matrix which contains fly-wise (each row) data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sleepStat(data, sleep.def = c(5), t.cycle = 24, photoperiod = 12)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sleepStat_+3A_data">data</code></td>
<td>
<p>Input data file. The input for this function must be the output of the function trimData(). See ??trimData().</p>
</td></tr>
<tr><td><code id="sleepStat_+3A_sleep.def">sleep.def</code></td>
<td>
<p>Definition of sleep. Traditionally, a single bout of sleep is defined as any duration of inactivity that is equal to or greater than 5-minutes. However, sometimes it may be of interest to examine longer bouts of sleep or specific bout durations; sleep.def allows users to change the definition of sleep. The default input is a single value vector of value 5. If users wish to analyse sleep only between 5 to 20 mins, the input must be c(5,20).</p>
</td></tr>
<tr><td><code id="sleepStat_+3A_t.cycle">t.cycle</code></td>
<td>
<p>Define the period of the environmental cycle or a single day in hours. This defaults to 24.</p>
</td></tr>
<tr><td><code id="sleepStat_+3A_photoperiod">photoperiod</code></td>
<td>
<p>Duration (in hours) of what can be considered day-phase. This defaults to 12.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>matrix</code> <code>array</code> matrix with 32 rows (one for each fly) and 9 columns:
</p>

<dl>
<dt>Channel</dt><dd><p>Fly identity.</p>
</dd>
<dt>Day.BoutNumber</dt><dd><p>Number of sleep bouts in the user defined day time.</p>
</dd>
<dt>Day.BoutDuration.Mean</dt><dd><p>Mean sleep duration in the user defined day time.</p>
</dd>
<dt>Day.BoutDuration.Median</dt><dd><p>Median sleep duration in the user defined day time.</p>
</dd>
<dt>Day.Latency</dt><dd><p>Time taken for the first sleep bout to occur in the user defined day time.</p>
</dd>
<dt>Day.Total</dt><dd><p>Total minutes of daytime sleep.</p>
</dd>
<dt>Night.BoutNumber</dt><dd><p>Number of sleep bouts in the user defined night time.</p>
</dd>
<dt>Night.BoutDuration.Mean</dt><dd><p>Mean sleep duration in the user defined night time.</p>
</dd>
<dt>Night.BoutDuration.Median</dt><dd><p>Median sleep duration in the user defined night time.</p>
</dd>
<dt>Night.Latency</dt><dd><p>Time taken for the first sleep bout to occur in the user defined night time.</p>
</dd>
<dt>Night.Total</dt><dd><p>Total minutes of nighttime sleep.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>td &lt;- trimData(data = df, start.date = "19 Dec 20", start.time = "21:00",
n.days = 10, bin = 1, t.cycle = 24)
slp.stat &lt;- sleepStat(data = td)
</code></pre>

<hr>
<h2 id='transitionProbs'>Plot and generate data for transition frequencies between sleep stages</h2><span id='topic+transitionProbs'></span>

<h3>Description</h3>

<p>This function generates a sankey plot enabling the visualization of percentage of times transtions from various states of activity and sleep occur. This function also generates a data table to download individual values of these transition percentages. Sleep stages are defined as follows: 5 to 30-min as short sleep (light blue), 30 to 60-min as intermediate sleep (medium blue) and 60 to 720-min as deep sleep (dark blue). Activity is defined as the standard number of beam crosses. The input for this function must be the output of the trimData() function. The output of this function is a list. Note: At this moment, this works accurately only for 24-h days.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>transitionProbs(data, n.days, photoperiod = 12)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="transitionProbs_+3A_data">data</code></td>
<td>
<p>Input data file. The input for this function must be the output of the function trimData(). See ??trimData().</p>
</td></tr>
<tr><td><code id="transitionProbs_+3A_n.days">n.days</code></td>
<td>
<p>The number of cycles for which sleep stages must be visualized.</p>
</td></tr>
<tr><td><code id="transitionProbs_+3A_photoperiod">photoperiod</code></td>
<td>
<p>This value determines the duration of photo-phase and scoto-phase of the 24-h day. Defaults to 12.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>list</code> with two items:
</p>

<dl>
<dt>Plots</dt><dd><p>A <code>plotly</code> <code>htmlwidget</code> with the Sankey diagram (representing the average transition percentages).</p>
</dd>
<dt>Data</dt><dd><p>A <code>matrix</code> <code>array</code> with individual wise transition percentages.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
td &lt;- trimData(data = df, start.date = "19 Dec 20", start.time = "21:00",
n.days = 2, bin = 1, t.cycle = 24)
tp &lt;- transitionProbs(data = td, n.days = 1)

## End(Not run)
</code></pre>

<hr>
<h2 id='trimData'>Trim data for downstream analyses</h2><span id='topic+trimData'></span>

<h3>Description</h3>

<p>trimData() allows users to define start date, start time and number of days for analysing data sets.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trimData(data, start.date, start.time, n.days, bin = 1, t.cycle = 24)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="trimData_+3A_data">data</code></td>
<td>
<p>Input data file. This must be DAM scanned monitor files, saved in 1-min intervals starting at time 00:00.</p>
</td></tr>
<tr><td><code id="trimData_+3A_start.date">start.date</code></td>
<td>
<p>Define starting date for analysis. Date inputs must be in this form: &quot;DD Mon YY&quot;; August 6, 2020 must be input as &quot;6 Aug 20&quot;. Any other form will result in computation errors.</p>
</td></tr>
<tr><td><code id="trimData_+3A_start.time">start.time</code></td>
<td>
<p>Define start time for analysis. Times must be input in the 24-h format and in the following form: &quot;HH:MM&quot;; 10 AM must be &quot;10:00&quot; and 10 PM must be &quot;22:00&quot;.</p>
</td></tr>
<tr><td><code id="trimData_+3A_n.days">n.days</code></td>
<td>
<p>Number of days to analyse.</p>
</td></tr>
<tr><td><code id="trimData_+3A_bin">bin</code></td>
<td>
<p>Intervals in which data are sampled (in minutes). This defaults to 1.</p>
</td></tr>
<tr><td><code id="trimData_+3A_t.cycle">t.cycle</code></td>
<td>
<p>Define the period of the environmental cycle or a single day in hours. This defaults to 24.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.frame</code> containing trimmed data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>td &lt;- trimData(data = df, start.date = "19 Dec 20", start.time = "21:00",
n.days = 10, bin = 1, t.cycle = 24)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
