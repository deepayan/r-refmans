<!DOCTYPE html><html lang="en"><head><title>Help for package gimms</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {gimms}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#gimms-package'><p>Download and Process GIMMS NDVI3g Data</p></a></li>
<li><a href='#bale3g.v1'><p>Bale Mountains NDVI3g.v1</p></a></li>
<li><a href='#downloadGimms'><p>Download GIMMS NDVI3g Data</p></a></li>
<li><a href='#kili3g.v0'><p>Kilimanjaro NDVI3g.v0</p></a></li>
<li><a href='#monthlyComposite'><p>Calculate Monthly Composite Images</p></a></li>
<li><a href='#monthlyIndices'><p>Create Monthly Indices from NDVI3g Files</p></a></li>
<li><a href='#oldNaming'><p>Create Traditional GIMMS NDVI3g File Names</p></a></li>
<li><a href='#qualityControl'><p>Perform Quality Control on GIMMS NDVI3g Data</p></a></li>
<li><a href='#rasterizeGimms'><p>Rasterize GIMMS NDVI3g Data</p></a></li>
<li><a href='#rearrangeFiles'><p>Rearrange GIMMS NDVI3g.v0 Files</p></a></li>
<li><a href='#significantTau'><p>Compute (Pre-Whitened) Kendall's <code class="reqn">\tau</code></p></a></li>
<li><a href='#updateInventory'><p>Update GIMMS NDVI3g File Inventory</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Download and Process GIMMS NDVI3g Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.2</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/environmentalinformatics-marburg/gimms">https://github.com/environmentalinformatics-marburg/gimms</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/environmentalinformatics-marburg/gimms/issues">https://github.com/environmentalinformatics-marburg/gimms/issues</a></td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Florian Detsch &lt;fdetsch@web.de&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>This is a set of functions to retrieve information about GIMMS
    NDVI3g files currently available online; download (and re-arrange, in the 
    case of NDVI3g.v0) the half-monthly data sets; import downloaded files from 
    ENVI binary (NDVI3g.v0) or NetCDF format (NDVI3g.v1) directly into R based 
    on the widespread 'raster' package; conduct quality control; and generate 
    monthly composites (e.g., maximum values) from the half-monthly input data. 
    As a special gimmick, a method is included to conveniently apply the 
    Mann-Kendall trend test upon 'Raster*' images, optionally featuring 
    trend-free pre-whitening to account for lag-1 autocorrelation.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5), raster, methods</td>
</tr>
<tr>
<td>Imports:</td>
<td>curl, parallel, Kendall, ncdf4, zyp</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Suggests:</td>
<td>tinytest</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-09 18:38:06 UTC; Linda Schulte</td>
</tr>
<tr>
<td>Author:</td>
<td>Florian Detsch [cre, aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-09 19:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='gimms-package'>Download and Process GIMMS NDVI3g Data</h2><span id='topic+gimms-package'></span>

<h3>Description</h3>

<p>Download and Process GIMMS NDVI3g Data
</p>


<h3>Details</h3>

<p>This is a set of functions to retrieve information about GIMMS NDVI3g files
currently available online; download (and re-arrange, in the case of
NDVI3g.v0) the half-monthly data sets; import downloaded files from ENVI
binary (NDVI3g.v0) or NetCDF format (NDVI3g.v1) directly into R based on the
widespread <strong>raster</strong> package; conduct quality control; and generate
monthly composites (e.g., maximum values) from the half-monthly input data.
As a special gimmick, a method is included to conveniently apply the
Mann-Kendall trend test upon <code>Raster*</code> images, optionally featuring
trend-free pre-whitening to account for lag-1 autocorrelation.
</p>


<h3>Author(s)</h3>

<p>Florian Detsch
</p>


<h3>References</h3>

<p>Pinzon, JE &amp; Tucker, CJ (2014). A Non-Stationary 1981-2012 AVHRR
NDVI3g Time Series. Remote Sensing, 6(8), 6929-6960, <a href="https://doi.org/10.3390/rs6086929">doi:10.3390/rs6086929</a>.
</p>
<p>The National Center for Atmospheric Research (2018). A Big Earth Data
Platform for Three Poles. Global GIMMS NDVI3g v1 dataset (1981-2015).
Available online at <a href="http://poles.tpdc.ac.cn/en/data/9775f2b4-7370-4e5e-a537-3482c9a83d88/">http://poles.tpdc.ac.cn/en/data/9775f2b4-7370-4e5e-a537-3482c9a83d88/</a>
(accessed on 2021-04-15).
</p>

<hr>
<h2 id='bale3g.v1'>Bale Mountains NDVI3g.v1</h2><span id='topic+bale3g.v1'></span>

<h3>Description</h3>

<p>Bale Mountains NDVI3g.v1.
</p>


<h3>Format</h3>

<p><code>raster::RasterStack</code>
</p>


<h3>Details</h3>

<p>This dataset contains NDVI3g.v1 observations for the Bale Mountains
National Park, southern Ethiopia (Jul 1981 to Dec 2015).
</p>

<hr>
<h2 id='downloadGimms'>Download GIMMS NDVI3g Data</h2><span id='topic+downloadGimms'></span><span id='topic+downloadGimms+2CdateORmissing+2CdateORmissing-method'></span><span id='topic+downloadGimms+2CDate-method'></span><span id='topic+downloadGimms+2CnumericORmissing+2CnumericORmissing-method'></span><span id='topic+downloadGimms+2Cnumeric-method'></span><span id='topic+downloadGimms+2Ccharacter+2CANY-method'></span><span id='topic+downloadGimms+2Ccharacter-method'></span><span id='topic+downloadGimms+2Cmissing+2Cmissing-method'></span><span id='topic+downloadGimms+2Cmissing-method'></span>

<h3>Description</h3>

<p>Download GIMMS NDVI3g data, optionally for a given period of time. NDVI3g.v1
(NetCDF, until end 2015) is available from the <code>"poles"</code> and
<code>"ecocast"</code> servers, whereas NDVI3g.v0 (ENVI binary, until end 2013) is
<code>"ecocast"</code> and <code>"nasanex"</code> exclusive.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'dateORmissing,dateORmissing'
downloadGimms(
  x,
  y,
  version = 1L,
  dsn = getwd(),
  overwrite = FALSE,
  quiet = TRUE,
  mode = "wb",
  cores = 1L,
  server = c("poles", "nasanex", "ecocast"),
  ...
)

## S4 method for signature 'numericORmissing,numericORmissing'
downloadGimms(
  x,
  y,
  version = 1L,
  dsn = getwd(),
  overwrite = FALSE,
  quiet = TRUE,
  mode = "wb",
  cores = 1L,
  server = c("poles", "nasanex", "ecocast"),
  ...
)

## S4 method for signature 'character,ANY'
downloadGimms(
  x,
  dsn = getwd(),
  overwrite = FALSE,
  quiet = TRUE,
  mode = "wb",
  cores = 1L,
  ...
)

## S4 method for signature 'missing,missing'
downloadGimms(
  version = 1L,
  dsn = getwd(),
  overwrite = FALSE,
  quiet = TRUE,
  mode = "wb",
  cores = 1L,
  server = c("poles", "nasanex", "ecocast"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="downloadGimms_+3A_x">x</code></td>
<td>
<p>Start time for data download as either <code>Date</code> object (e.g.,
<code>as.Date("2000-01-01")</code>) or <code>numeric</code> year (e.g., <code>2000</code>).
Alternatively, a <code>character</code> vector of online filepaths to download
created from <code><a href="#topic+updateInventory">updateInventory</a></code>. If <code>missing</code>, all files
available online are being downloaded.</p>
</td></tr>
<tr><td><code id="downloadGimms_+3A_y">y</code></td>
<td>
<p>End time for data download as either <code>Date</code> object or
<code>numeric</code> year. Ignored if 'x' is a <code>character</code> object or missing.</p>
</td></tr>
<tr><td><code id="downloadGimms_+3A_version">version</code></td>
<td>
<p><code>integer</code> (or any other convertible class), defaults to
<code>1L</code>. Specifies desired GIMMS NDVI3g product version, see 'Details' in
<code><a href="#topic+updateInventory">updateInventory</a></code>. Ignored if 'x' is a <code>character</code> object.</p>
</td></tr>
<tr><td><code id="downloadGimms_+3A_dsn">dsn</code></td>
<td>
<p><code>character</code>, defaults to the current working directory.
Target folder for file download.</p>
</td></tr>
<tr><td><code id="downloadGimms_+3A_overwrite">overwrite</code></td>
<td>
<p><code>logical</code>, defaults to <code>FALSE</code>. If <code>TRUE</code>,
identically named files in 'dsn' will be overwritten.</p>
</td></tr>
<tr><td><code id="downloadGimms_+3A_quiet">quiet</code></td>
<td>
<p><code>logical</code>. If <code>TRUE</code> (default), console output is
reduced.</p>
</td></tr>
<tr><td><code id="downloadGimms_+3A_mode">mode</code></td>
<td>
<p><code>character</code>. See <code><a href="utils.html#topic+download.file">download.file</a></code>.</p>
</td></tr>
<tr><td><code id="downloadGimms_+3A_cores">cores</code></td>
<td>
<p><code>integer</code>, defaults to <code>1L</code>. Number of cores used for
parallel processing. Note that a fast internet connection is required in
order for parallelization to take effect.</p>
</td></tr>
<tr><td><code id="downloadGimms_+3A_server">server</code></td>
<td>
<p>See <code><a href="#topic+updateInventory">updateInventory</a></code>.</p>
</td></tr>
<tr><td><code id="downloadGimms_+3A_...">...</code></td>
<td>
<p>Further arguments passed to <code><a href="utils.html#topic+download.file">download.file</a></code>, e.g.
'method'.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>character</code> vector of local filepaths.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+updateInventory">updateInventory</a></code>, <code><a href="utils.html#topic+download.file">download.file</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
tmp &lt;- tempdir()

## 'Date' method
gimms_files_date &lt;- downloadGimms(x = as.Date("2000-01-01"),
                                  y = as.Date("2000-12-31"),
                                  dsn = tmp)

## 'numeric' method (i.e., particular years)
gimms_files_year &lt;- downloadGimms(x = 2000,
                                  y = 2002,
                                  dsn = tmp)

## 'character' method (i.e., particular files)
ecocast &lt;- system.file("extdata", "inventory_ecv1.rds", package = "gimms")
gimms_files_char &lt;- readRDS(ecocast)
gimms_files_char &lt;- downloadGimms(x = gimms_files_char[1:6],
                                  dsn = tmp)

## 'missing' method (i.e., entire collection)
gimms_files_full &lt;- downloadGimms(dsn = tmp)

## End(Not run)

</code></pre>

<hr>
<h2 id='kili3g.v0'>Kilimanjaro NDVI3g.v0</h2><span id='topic+kili3g.v0'></span>

<h3>Description</h3>

<p>Kilimanjaro NDVI3g.v0.
</p>


<h3>Format</h3>

<p><code>raster::RasterStack</code>
</p>


<h3>Details</h3>

<p>This dataset contains NDVI3g.v0 observations for the Kilimanjaro
region, northern Tanzania (Jul 1981 to Dec 2013).
</p>

<hr>
<h2 id='monthlyComposite'>Calculate Monthly Composite Images</h2><span id='topic+monthlyComposite'></span><span id='topic+monthlyComposite+2CRasterStackBrick-method'></span><span id='topic+monthlyComposite+2Ccharacter-method'></span>

<h3>Description</h3>

<p>Based on a user-defined function, e.g. <code>max</code> for maximum value
composites (MVC), aggregate half-monthly GIMMS data sets to monthly composites.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'RasterStackBrick'
monthlyComposite(x, indices, fun = max, cores = 1L, filename = "", ...)

## S4 method for signature 'character'
monthlyComposite(
  x,
  version = 1L,
  pos1 = ifelse(version == 1, 15L, 4L),
  pos2 = ifelse(version == 1, 23L, 8L),
  fun = max,
  cores = 1L,
  filename = "",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="monthlyComposite_+3A_x">x</code></td>
<td>
<p>Multi-layered <code>Raster*</code> object or <code>character</code> vector of
filenames. If the latter applies and 'pos1', 'pos2' are not specified, the
function will try to retrieve monthly indices from
<code><a href="#topic+monthlyIndices">monthlyIndices</a></code>. Note that the specification of NDVI3g.v0 ENVI
binary files is hereby not allowed and in such a case,
<code><a href="#topic+rasterizeGimms">rasterizeGimms</a></code> should be run beforehand.</p>
</td></tr>
<tr><td><code id="monthlyComposite_+3A_indices">indices</code></td>
<td>
<p><code>numeric</code>. Indices to denote layers or files from
identical months.</p>
</td></tr>
<tr><td><code id="monthlyComposite_+3A_fun">fun</code></td>
<td>
<p><code>function</code>. Used to calculate monthly composite layers,
defaults to <code><a href="base.html#topic+max">max</a></code>. Note that a separate 'na.rm' argument is
passed down to <code><a href="raster.html#topic+stackApply">stackApply</a></code> via '...' and hence should not be
included here.</p>
</td></tr>
<tr><td><code id="monthlyComposite_+3A_cores">cores</code></td>
<td>
<p><code>integer</code>. Number of cores for parallel computing.</p>
</td></tr>
<tr><td><code id="monthlyComposite_+3A_filename">filename</code></td>
<td>
<p><code>character</code>. Optional output filename passed to
<code><a href="raster.html#topic+stackApply">stackApply</a></code>.</p>
</td></tr>
<tr><td><code id="monthlyComposite_+3A_...">...</code></td>
<td>
<p>Further arguments passed to <code><a href="raster.html#topic+stackApply">stackApply</a></code> (i.e.,
'na.rm') and its underlying <code><a href="raster.html#topic+writeRaster">writeRaster</a></code> call.</p>
</td></tr>
<tr><td><code id="monthlyComposite_+3A_version">version</code></td>
<td>
<p><code>integer</code> (or any other class convertible to
<code>integer</code>). Specifies GIMMS NDVI3g product version, see 'Details' in
<code><a href="#topic+updateInventory">updateInventory</a></code>.</p>
</td></tr>
<tr><td><code id="monthlyComposite_+3A_pos1">pos1</code>, <code id="monthlyComposite_+3A_pos2">pos2</code></td>
<td>
<p><code>integer</code>. If 'x' is a vector of filenames, the first
and last element of the date string to build monthly indices from. Defaults
to the 'version'-specific NDVI3g naming convention, see
<code><a href="#topic+monthlyIndices">monthlyIndices</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>length(x) == 2</code>, a single <code>RasterLayer</code> object, else a
<code>RasterStack</code> object with monthly composite layers.
</p>


<h3>See Also</h3>

<p><code><a href="raster.html#topic+stackApply">stackApply</a></code>, <code><a href="#topic+monthlyIndices">monthlyIndices</a></code>,
<code><a href="raster.html#topic+writeRaster">writeRaster</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("bale3g.v1")

## select layers from 1981 only
fls &lt;- system.file("extdata/inventory_ecv1.rds", package = "gimms")
fls &lt;- readRDS(fls)[1]
rst &lt;- bale3g.v1[[1:12]]

## aggregate to monthly mvc layers
mvc &lt;- monthlyComposite(rst, indices = monthlyIndices(fls))

</code></pre>

<hr>
<h2 id='monthlyIndices'>Create Monthly Indices from NDVI3g Files</h2><span id='topic+monthlyIndices'></span>

<h3>Description</h3>

<p>Create numeric monthly indices from (local or online) GIMMS NDVI3g filenames
as input for the <code><a href="#topic+monthlyComposite">monthlyComposite</a></code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>monthlyIndices(
  x,
  version = 1L,
  pos1 = ifelse(version == 1, 15L, 4L),
  pos2 = ifelse(version == 1, 23L, 8L),
  timestamp = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="monthlyIndices_+3A_x">x</code></td>
<td>
<p><code>character</code>. Vector of (local or online) filenames.</p>
</td></tr>
<tr><td><code id="monthlyIndices_+3A_version">version</code></td>
<td>
<p><code>integer</code> (or any other class convertible to
<code>integer</code>). Specifies GIMMS NDVI3g product version, see 'Details' in
<code><a href="#topic+updateInventory">updateInventory</a></code>.</p>
</td></tr>
<tr><td><code id="monthlyIndices_+3A_pos1">pos1</code>, <code id="monthlyIndices_+3A_pos2">pos2</code></td>
<td>
<p><code>numeric</code>. The first and last element of the date
string in 'x', defaults to the GIMMS naming convention of the specified
product version.</p>
</td></tr>
<tr><td><code id="monthlyIndices_+3A_timestamp">timestamp</code></td>
<td>
<p><code>logical</code>, defaults to <code>FALSE</code>. If <code>TRUE</code>, an
actual <code>Date</code> object is returned rather than a <code>numeric</code> vector of
indices.</p>
</td></tr>
<tr><td><code id="monthlyIndices_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>numeric</code> vector with unique monthly indices or, if
<code>timestamp = TRUE</code>, the actual timestamps as <code>Date</code> objects.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+monthlyComposite">monthlyComposite</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## NDVI3g.v1
gimms_files_v1 &lt;- readRDS(system.file("extdata", "inventory_ecv1.rds", package = "gimms"))

monthlyIndices(gimms_files_v1[1], version = 1)                   # indices
monthlyIndices(gimms_files_v1[1], version = 1, timestamp = TRUE) # dates

## Similarly, NDVI3g.v0
gimms_files_v0 &lt;- readRDS(system.file("extdata", "inventory_ecv0.rds", package = "gimms"))
gimms_files_v0 &lt;- rearrangeFiles(gimms_files_v0) # reorder by date

monthlyIndices(gimms_files_v0[1:12], version = 0)
monthlyIndices(gimms_files_v0[1:12], version = 0, timestamp = TRUE)

</code></pre>

<hr>
<h2 id='oldNaming'>Create Traditional GIMMS NDVI3g File Names</h2><span id='topic+oldNaming'></span>

<h3>Description</h3>

<p>Reformat the names of local NDVI3g.v1 files according to &quot;traditional&quot;
NDVI3g.v0 naming convention.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>oldNaming(x, suffix = "")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="oldNaming_+3A_x">x</code></td>
<td>
<p><code>character</code>. GIMMS NDVI3g.v1 file names to reformat, see
'Details'.</p>
</td></tr>
<tr><td><code id="oldNaming_+3A_suffix">suffix</code></td>
<td>
<p><code>character</code>. Optional suffix to append to the resulting
file names, e.g. <code>".tif"</code> for GeoTiff files (see also
<code><a href="raster.html#topic+writeFormats">writeFormats</a></code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The satellite number, which was an essential constituent of the NDVI3g.v0
file naming convention (see 'References'), has been removed from NDVI3g.v1
file names. However, it can easily be accessed via <code><a href="ncdf4.html#topic+ncvar_get">ncvar_get</a></code>
given that the file has previously been downloaded. If an NDVI3g.v1 file
specified to 'x' is not available locally, by contrast, the satellite number
is retrieved from the built-in NDVI3g.v0 file inventory (until end 2013; see
'Examples') and newer files are tagged with <code>"XX"</code> indicating missing
information.
</p>


<h3>Value</h3>

<p>A <code>character</code> vector of file names following the &quot;traditional&quot; NDVI3g.v0
naming convention.
</p>


<h3>References</h3>

<p><a href="http://nasanex.s3.amazonaws.com/AVHRR/GIMMS/3G/00READMEgeo.txt">http://nasanex.s3.amazonaws.com/AVHRR/GIMMS/3G/00READMEgeo.txt</a>
(accessed on 2021-04-15).
</p>


<h3>See Also</h3>

<p><code><a href="ncdf4.html#topic+nc_open">nc_open</a></code>, <code><a href="ncdf4.html#topic+ncvar_get">ncvar_get</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fls &lt;- system.file("extdata", "inventory_ecv1.rds", package = "gimms")
fls &lt;- basename(readRDS(fls))

oldNaming(fls[64:65], suffix = ".tif") # adds .tif extension
oldNaming(fls[65:66])                  # tags newer files with 'XX'

</code></pre>

<hr>
<h2 id='qualityControl'>Perform Quality Control on GIMMS NDVI3g Data</h2><span id='topic+qualityControl'></span><span id='topic+qualityControl+2CRasterStackBrick-method'></span>

<h3>Description</h3>

<p>Perform quality control on GIMMS NDVI3g data based on the companion flag
information. This is merely a wrapper around <code><a href="raster.html#topic+overlay">overlay</a></code> and, since
quality control is readily available through <code><a href="#topic+rasterizeGimms">rasterizeGimms</a></code>, it
is strongly recommended to use the latter function for this purpose.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'RasterStackBrick'
qualityControl(x, keep = NULL, filename = "", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="qualityControl_+3A_x">x</code></td>
<td>
<p>A single 2-layered <code>RasterStack</code> object (NDVI and flags).</p>
</td></tr>
<tr><td><code id="qualityControl_+3A_keep">keep</code></td>
<td>
<p><code>integer</code>. Accepted flag values (see 'Details').</p>
</td></tr>
<tr><td><code id="qualityControl_+3A_filename">filename</code></td>
<td>
<p><code>character</code>. Optional output filename.</p>
</td></tr>
<tr><td><code id="qualityControl_+3A_...">...</code></td>
<td>
<p>Further arguments passed to <code><a href="raster.html#topic+writeRaster">writeRaster</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If 'keep' is missing, the function will automatically skip quality control
and return the input object.
</p>


<h3>Value</h3>

<p>A quality-controlled 'RasterLayer' object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rasterizeGimms">rasterizeGimms</a></code>, <code><a href="raster.html#topic+overlay">overlay</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
tmp &lt;- tempdir()

## Download NDVI3g.v1 sample data
ecocast &lt;- system.file("extdata", "inventory_ecv1.rds", package = "gimms")
gimms_files &lt;- downloadGimms(readRDS(ecocast)[1], dsn = tmp)

## Import data as 'Raster*' objects
ndvi &lt;- raster::raster(gimms_files, varname = "ndvi")
ndvi[ndvi[] %in% c(-32768, -3000)] &lt;- NA
ndvi &lt;- ndvi / 1e4

flag &lt;- floor(raster::raster(gimms_files, varname = "percentile") / 2e3)

## Perform quality control and visualize
to_check &lt;- stack(ndvi[[1]], flag[[1]])
qcl &lt;- qualityControl(to_check, keep = 0)

plot(qcl)

## End(Not run)

## see also 'Examples' section in ?rasterizeGimms for automated quality check

</code></pre>

<hr>
<h2 id='rasterizeGimms'>Rasterize GIMMS NDVI3g Data</h2><span id='topic+rasterizeGimms'></span>

<h3>Description</h3>

<p>Import GIMMS NDVI3g (binary or NetCDF) data into R as <code>Raster*</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rasterizeGimms(
  x,
  ext = NULL,
  snap = "out",
  keep = NULL,
  split = FALSE,
  cores = 1L,
  filename = "",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rasterizeGimms_+3A_x">x</code></td>
<td>
<p><code>character</code>. Vector of local filepaths. Note that product
versions must not be mixed, i.e. 'x' should represent files originating from
either NDVI3g.v1 or NDVI3g.v0 only.</p>
</td></tr>
<tr><td><code id="rasterizeGimms_+3A_ext">ext</code></td>
<td>
<p><code>Extent</code>, or any object from which an <code>Extent</code> can be
extracted, see <code><a href="raster.html#topic+crop">crop</a></code>.</p>
</td></tr>
<tr><td><code id="rasterizeGimms_+3A_snap">snap</code></td>
<td>
<p><code>character</code>, defaults to &quot;out&quot;. Other available options are
&quot;in&quot; and &quot;near&quot;, see <code><a href="raster.html#topic+crop">crop</a></code>.</p>
</td></tr>
<tr><td><code id="rasterizeGimms_+3A_keep">keep</code></td>
<td>
<p><code>integer</code>. Flag values of NDVI3g pixels to spare during
quality control. Pixels with non-included flag values are set to <code>NA</code>.
If not specified (i.e., <code>NULL</code>; default), quality control is skipped.</p>
</td></tr>
<tr><td><code id="rasterizeGimms_+3A_split">split</code></td>
<td>
<p><code>logical</code>, defaults to <code>FALSE</code>. If <code>TRUE</code>, a
<code>list</code> of <code>RasterStack</code> objects (of <code>length(x)</code>) is returned
rather than a single <code>RasterStack</code>.</p>
</td></tr>
<tr><td><code id="rasterizeGimms_+3A_cores">cores</code></td>
<td>
<p><code>integer</code>. Number of cores for parallel computing.</p>
</td></tr>
<tr><td><code id="rasterizeGimms_+3A_filename">filename</code></td>
<td>
<p><code>character</code>. Optional output filename. If specified,
this must be of the same length as 'x'.</p>
</td></tr>
<tr><td><code id="rasterizeGimms_+3A_...">...</code></td>
<td>
<p>Further arguments passed to <code><a href="raster.html#topic+writeRaster">writeRaster</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>split = TRUE</code>, a list of NDVI3g <code>RasterStack</code> objects
corresponding to the files specified in 'x'; else a single NDVI3g
<code>RasterStack</code> object.
</p>


<h3>See Also</h3>

<p><code><a href="raster.html#topic+crop">crop</a></code>, <code><a href="#topic+qualityControl">qualityControl</a></code>,
<code><a href="raster.html#topic+writeRaster">writeRaster</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
tmp &lt;- tempdir()

## Download NDVI3g.v1 sample data
gimms_files &lt;- downloadGimms(x = as.Date("2000-01-01"),
                             y = as.Date("2000-12-31"),
                             dsn = tmp)

## Extent for clipping
shp &lt;- getData("GADM", country = "DEU", level = 0, path = tmp)

## Rasterize without quality control
gimms_raster &lt;- rasterizeGimms(x = gimms_files,
                               ext = shp) # clipping
plot(gimms_raster[[1]])
lines(shp)

## Rasterize with quality control
gimms_rasterq &lt;- rasterizeGimms(x = gimms_files,
                                ext = shp, # clipping
                                keep = 0)  # quality control
plot(gimms_rasterq[[1]])
lines(shp)

## End(Not run)

</code></pre>

<hr>
<h2 id='rearrangeFiles'>Rearrange GIMMS NDVI3g.v0 Files</h2><span id='topic+rearrangeFiles'></span>

<h3>Description</h3>

<p>Rearrange local GIMMS NDVI3g.v0 files in ascending order of time. Since the
naming convention has significantly changed towards NDVI3g.v1, such a measure
should only be relevant for older file formats.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rearrangeFiles(
  x,
  dsn = getwd(),
  pattern = "^geo.*.VI3g$",
  pos = c(4, 6, 11),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rearrangeFiles_+3A_x">x</code></td>
<td>
<p><code>character</code>. Vector of local filepaths. If missing, 'dsn' will
be searched for available files via pattern matching.</p>
</td></tr>
<tr><td><code id="rearrangeFiles_+3A_dsn">dsn</code></td>
<td>
<p><code>character</code>, defaults to the current working directory. Path
to look for GIMMS-related data if 'x' is missing.</p>
</td></tr>
<tr><td><code id="rearrangeFiles_+3A_pattern">pattern</code></td>
<td>
<p><code>character</code>, defaults to <code>"^geo.*.VI3g$"</code> for
standard NDVI3g.v0 files. A regular expression passed to <code><a href="base.html#topic+list.files">list.files</a></code>.</p>
</td></tr>
<tr><td><code id="rearrangeFiles_+3A_pos">pos</code></td>
<td>
<p><code>integer</code>, defaults to <code>c(4, 6, 11)</code> for standard
NDVI3g.v0 files. The start positions of year, month and part of the month
('a' or 'b') in the target GIMMS files.</p>
</td></tr>
<tr><td><code id="rearrangeFiles_+3A_...">...</code></td>
<td>
<p>Further arguments passed to <code><a href="base.html#topic+list.files">list.files</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>character</code> vector of filepaths arranged in ascending order of time.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+list.files">list.files</a></code>
</p>

<hr>
<h2 id='significantTau'>Compute (Pre-Whitened) Kendall's <code class="reqn">\tau</code></h2><span id='topic+significantTau'></span><span id='topic+significantTau+2Cnumeric-method'></span><span id='topic+significantTau+2CRasterStackBrick-method'></span>

<h3>Description</h3>

<p>Apply the Mann-Kendall trend test (Mann, 1945) to a series of observations
and return Kendall's <code class="reqn">\tau</code> (Kendall, 1938) based on a predefined
significance level. In contrast to other readily available implementations,
it is up to the user to decide whether or not to apply pre-whitening as
described in the <strong>zyp</strong> package vignette (Bronaugh and Werner, 2013).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'numeric'
significantTau(
  x,
  p = 0.001,
  prewhitening = TRUE,
  method = c("yuepilon", "zhang"),
  df = FALSE
)

## S4 method for signature 'RasterStackBrick'
significantTau(
  x,
  p = 0.001,
  prewhitening = TRUE,
  method = c("yuepilon", "zhang"),
  filename = "",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="significantTau_+3A_x">x</code></td>
<td>
<p>Either a <code>Raster*</code> object or a <code>numeric</code> vector.</p>
</td></tr>
<tr><td><code id="significantTau_+3A_p">p</code></td>
<td>
<p><code>numeric</code>, defaults to <code>0.001</code>. Significance level to be
tested.</p>
</td></tr>
<tr><td><code id="significantTau_+3A_prewhitening">prewhitening</code></td>
<td>
<p><code>logical</code>. If <code>TRUE</code> (default), pre-whitening
is applied prior to the Mann-Kendall trend test.</p>
</td></tr>
<tr><td><code id="significantTau_+3A_method">method</code></td>
<td>
<p><code>character</code>. The prewhitening method to apply, see
<code><a href="zyp.html#topic+zyp.trend.vector">zyp.trend.vector</a></code>.</p>
</td></tr>
<tr><td><code id="significantTau_+3A_df">df</code></td>
<td>
<p><code>logical</code>, defaults to <code>FALSE</code>. If <code>TRUE</code>, a
<code>data.frame</code> holding the value of Kendall's <code class="reqn">\tau</code> and the referring
significance level.</p>
</td></tr>
<tr><td><code id="significantTau_+3A_filename">filename</code></td>
<td>
<p><code>character</code>. Optional output filename.</p>
</td></tr>
<tr><td><code id="significantTau_+3A_...">...</code></td>
<td>
<p>Further arguments passed to <code><a href="raster.html#topic+writeRaster">writeRaster</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If available, the function will automatically use open multi-core clusters
for parallel processing (see <code><a href="raster.html#topic+beginCluster">beginCluster</a></code> and Examples).
</p>


<h3>Value</h3>


<ul>
<li><p><code>numeric</code> input: If <code>df = FALSE</code> (default), a single
<code>numeric</code> or <code>logical</code> (i.e., <code>NA</code>) depending on whether or
not 'p' was exceeded; else a <code>data.frame</code> with Kendall's <code class="reqn">\tau</code> and
the corresponding significance level.
</p>
</li>
<li><p><code>RasterStackBrick</code> input: A <code>RasterLayer</code> with values of
Kendall's <code class="reqn">\tau</code>. Values exceeding the specified 'p' are discarded.
</p>
</li></ul>



<h3>References</h3>

<p>Kendall, M.G. (1938). A new measure of rank correlation. <em>Biometrika</em>
30(1/2), 81-93, doi: 10.2307/2332226.
</p>
<p>Mann, H.B. (1945). Nonparametric tests against trend. <em>Econometrica</em>
13(3), 245-259, doi: 10.2307/1907187.
</p>
<p>Zhang, X., Vincent, L.A., Hogg, W.D. and A. Niitsoo (2000). Temperature and
Precipitation Trends in Canada during the 20th Century. <em>Atmosphere-Ocean</em>
38(3), 395-429, <a href="https://doi.org/10.1080/07055900.2000.9649654">doi:10.1080/07055900.2000.9649654</a>.
</p>
<p>Yue, S., Pilon, P., Phinney, B. and G. Cavadias (2002). The influence of
autocorrelation on the ability to detect trend in hydrological series.
<em>Hydrological Processes</em> 16, 1807-1829,<a href="https://doi.org/10.1002/hyp.1095">doi:10.1002/hyp.1095</a>.
</p>


<h3>See Also</h3>

<p><code><a href="Kendall.html#topic+MannKendall">MannKendall</a></code>, <code><a href="zyp.html#topic+zyp.trend.vector">zyp.trend.vector</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Example taken from ?Kendall::MannKendall
library(Kendall)
data(PrecipGL)
plot(PrecipGL)

## Mann-Kendall trend test without pre-whitening
x &lt;- as.numeric(PrecipGL)
significantTau(x, p = 0.001, prewhitening = FALSE, df = TRUE)

## Mann-Kendall trend test with pre-whitening
significantTau(x, p = 0.001, prewhitening = TRUE, df = TRUE)

#############################################################################
### use case: significant mann-kendall trends in ndvi3g.v0          #########
#############################################################################

## Not run: 
## Sample data from 1982 to 2013
data("kili3g.v0")
rst &lt;- kili3g.v0[[13:nlayers(kili3g.v0)]]

## Remove seasonal signal
library(remote)
dsn &lt;- deseason(rst, cycle.window = 24)

## Apply trend-free pre-whitened Mann-Kendall test (note that
## non-significant pixels are set to NA)
trd1 &lt;- significantTau(dsn, p = 0.01, prewhitening = TRUE)
plot(trd1)

## Or, alternatively, use multi-core functionality
cores &lt;- parallel::detectCores() - 1
if (require(snow)) {
  beginCluster(cores)
  trd2 &lt;- significantTau(dsn, p = 0.01, prewhitening = TRUE)
  endCluster()
}

## End(Not run)

</code></pre>

<hr>
<h2 id='updateInventory'>Update GIMMS NDVI3g File Inventory</h2><span id='topic+updateInventory'></span>

<h3>Description</h3>

<p>Download the latest version of the GIMMS NDVI3g file inventory from the
National Center for Atmospheric Research, NASA Earth Exchange (NEX) Amazon
AWS or Ames Ecological Forecasting Lab (ECOCAST). If the specified endpoint
is not reachable (e.g., if there is no active internet connection), the
latest local version of the file inventory is used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>updateInventory(
  server = c("poles", "nasanex", "ecocast"),
  version = 1L,
  quiet = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="updateInventory_+3A_server">server</code></td>
<td>
<p><code>character</code>. Specifies the remote server to use. Currently
available options are <code>"poles"</code> (default), <code>"nasanex"</code> and
<code>"ecocast"</code>.</p>
</td></tr>
<tr><td><code id="updateInventory_+3A_version">version</code></td>
<td>
<p><code>integer</code> (or any other convertible class), defaults to
<code>1L</code>. Specifies desired GIMMS NDVI3g product version, see 'Details'.
Currently ignored if <code>server != "ecocast"</code>.</p>
</td></tr>
<tr><td><code id="updateInventory_+3A_quiet">quiet</code></td>
<td>
<p><code>logical</code>, defaults to <code>FALSE</code>. If <code>TRUE</code>,
console output is disabled.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>GIMMS NDVI3g.v1 is currently available from ECOCAST and The National Center
for Atmospheric Research until end 2015 and comes in NetCDF (<code>.nc4</code>)
format. In contrast, NDVI3g.v0 is available as ENVI binary imagery and
available from ECOCAST (NASANEX) until end 2013 (2012) only.
</p>


<h3>Value</h3>

<p>A <code>character</code> vector of online filepaths.
</p>


<h3>References</h3>

<p>The National Center for Atmospheric Research (2018). A Big Earth Data
Platform for Three Poles. Global GIMMS NDVI3g v1 dataset (1981-2015).
Available online at <a href="http://poles.tpdc.ac.cn/en/data/9775f2b4-7370-4e5e-a537-3482c9a83d88/">http://poles.tpdc.ac.cn/en/data/9775f2b4-7370-4e5e-a537-3482c9a83d88/</a>
(accessed on 2021-04-15).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rearrangeFiles">rearrangeFiles</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
updateInventory()
updateInventory(server = "nasanex", version = 0)

## End(Not run)

## note that local versions of the online file inventories are also available
ofl_ecv1 &lt;- system.file("extdata", "inventory_ecv1.rds", package = "gimms")
readRDS(ofl_ecv1)

ofl_v0 &lt;- system.file("extdata", "inventory_ecv0.rds", package = "gimms")
readRDS(ofl_v0)

ofl_plv1 &lt;- system.file("extdata", "inventory_plv1.rds", package = "gimms")
readRDS(ofl_plv1)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
