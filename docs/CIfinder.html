<!DOCTYPE html><html><head><title>Help for package CIfinder</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {CIfinder}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ppv_npv_ci'><p>Estimate the confidence intervals for positive predictive value (PPV) and negative predictive value (NPV) based on different methods</p></a></li>
<li><a href='#single_prop_ci'><p>Compute the confidence interval for a single proportion based on different methods</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Estimate the Confidence Intervals for Predictive Values</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0.0</td>
</tr>
<tr>
<td>Author:</td>
<td>Dadong Zhang &lt;dzhang4@illumina.com&gt;,
        Jingye Wang &lt;jwang16@illumina.com&gt;,
        Suqin Cai &lt;scai1@illumina.com&gt;,
        Johan Surtihadi &lt;jsurtihadi@illumina.com&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Dadong Zhang &lt;dzhang4@illumina.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Computes confidence intervals for the positive predictive value (PPV) and negative predictive value (NPV) based on varied scenarios. In situations where the proportion of diseased subjects does not correspond to the disease prevalence (e.g. case-control studies), this package provides two types of solutions: 1) five methods for estimating confidence intervals for PPV and NPV via ratio of two binomial proportions including Gart &amp; Nam (1988), Walter (1975), MOVER-J (Laud, 2017), Fieller (1954), and Bootstrap (Efron, 1979); 2) three direct methods that compute the confidence intervals including Pepe (2003), Zhou (2007), and Delta. In prospective studies where the proportion of diseased subjects is an unbiased estimate of the disease prevalence, this package provides several methods for calculating the confidence intervals for PPV and NPV including Clopper-Pearson, Wald, Wilson, Agresti-Coull, and Beta. See the Details and References sections in the corresponding functions.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Imports:</td>
<td>ratesci, stats, boot, Rdpack, kableExtra</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>Rdpack</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-04-12 20:42:48 UTC; dzhang4</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-04-12 21:10:13 UTC</td>
</tr>
</table>
<hr>
<h2 id='ppv_npv_ci'>Estimate the confidence intervals for positive predictive value (PPV) and negative predictive value (NPV) based on different methods</h2><span id='topic+ppv_npv_ci'></span>

<h3>Description</h3>

<p>Estimate the confidence intervals for positive predictive value (PPV) and negative predictive value (NPV) based on different methods
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ppv_npv_ci(
  x1,
  n1,
  x0,
  n0,
  prevalence,
  method = "gart and nam",
  conf.level = 0.95,
  bias_correction = FALSE,
  continuity.correction = FALSE,
  n_bootstraps = 1000,
  boot.type = "bca",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ppv_npv_ci_+3A_x1">x1</code></td>
<td>
<p>number of positives for both reference(true) marker and testing marker.</p>
</td></tr>
<tr><td><code id="ppv_npv_ci_+3A_n1">n1</code></td>
<td>
<p>number of positives for reference (true) marker.</p>
</td></tr>
<tr><td><code id="ppv_npv_ci_+3A_x0">x0</code></td>
<td>
<p>number of negatives for both reference(true) marker and testing marker.</p>
</td></tr>
<tr><td><code id="ppv_npv_ci_+3A_n0">n0</code></td>
<td>
<p>number of negatives for reference (true) marker.</p>
</td></tr>
<tr><td><code id="ppv_npv_ci_+3A_prevalence">prevalence</code></td>
<td>
<p>disease prevalence.</p>
</td></tr>
<tr><td><code id="ppv_npv_ci_+3A_method">method</code></td>
<td>
<p>current support &quot;gart and nam&quot;, &quot;walter&quot;, &quot;mover-j&quot;, &quot;pepe&quot;, &quot;zhou&quot;, &quot;delta&quot;, &quot;fieller&quot;, &quot;bootstrap&quot;; Default is &quot;gart and nam&quot;; Check the <code>Details</code> for additional information for each method.</p>
</td></tr>
<tr><td><code id="ppv_npv_ci_+3A_conf.level">conf.level</code></td>
<td>
<p>confidence level. default 0.95.</p>
</td></tr>
<tr><td><code id="ppv_npv_ci_+3A_bias_correction">bias_correction</code></td>
<td>
<p>Logical, indicating whether to apply bias correction in the score denominator. default FALSE. This argument can be used only for 'gart and nam' method.</p>
</td></tr>
<tr><td><code id="ppv_npv_ci_+3A_continuity.correction">continuity.correction</code></td>
<td>
<p>logical. default FALSE. 0.5 will be applied if TRUE except the <code>zhou</code>'s method where <code class="reqn">\frac{z_{\alpha/2}^2}{2}</code> is used.</p>
</td></tr>
<tr><td><code id="ppv_npv_ci_+3A_n_bootstraps">n_bootstraps</code></td>
<td>
<p>number of bootstraps for bootstrap method, default 1000</p>
</td></tr>
<tr><td><code id="ppv_npv_ci_+3A_boot.type">boot.type</code></td>
<td>
<p>A character string representing the type of intervals for bootstrap. The value should be any of the values c(&quot;bca&quot;, &quot;norm&quot;, &quot;perc&quot;), default bca.</p>
</td></tr>
<tr><td><code id="ppv_npv_ci_+3A_...">...</code></td>
<td>
<p>Other arguments passed on to method (e.g., defining the 'Beta(ai,bi)' prior distributions in mover-j method for each group (default 'ai = bi = 0.5' for Jeffreys method))</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Eight methods are supported in current version: &quot;gart and nam&quot;, &quot;walter&quot;, &quot;mover-j&quot;, &quot;pepe&quot;, &quot;zhou&quot;, &quot;delta&quot;, &quot;fieller&quot;, and &quot;bootstrap&quot;.
</p>
<p>Among those, <strong>gart and nam</strong>, <strong>mover-j</strong>, <strong>walter</strong>, and <strong>fieller</strong> construct the confidence intervals for PPV and NPV by converting the confidence intervals for the ratio of two binomial proportions (<code class="reqn">\phi=\frac{p_1}{p_0}</code>) where
<code class="reqn">\phi_{PPV}=\frac{(1-specificity)}{sensitivity}</code> and <code class="reqn">\phi_{NPV}=\frac{(1-sensitivity)}{specificity}</code>.
The sensitivity is estimated by <code class="reqn">sensitivity=\frac{x_1}{n_1}</code> and the specificity by <code class="reqn">specificity=\frac{x_0}{n_0}</code>. The confidence intervals for <code class="reqn">\phi_{PPV}</code> and <code class="reqn">\phi_{NPV}</code>
are converted to the corresponding confidence intervals for PPV and NPV using the following equations:
</p>

<ul>
<li> <p><code class="reqn">PPV=\frac{\rho}{\rho+(1-\rho)*\phi_{PPV}}</code>
</p>
</li>
<li> <p><code class="reqn">NPV=\frac{1-\rho}{(1-\rho)+\rho*\phi_{NPV}}</code>
</p>
<p>where <code class="reqn">\rho</code> denotes the <code>prevalence</code>.
</p>
</li></ul>


<ol>
<li><p> The <strong>gart and nam</strong> method constructs the confidence interval for <code class="reqn">\phi</code> based on score method with skewness correction. See the details in the paper listed in the <code>Reference</code> section.
This method can be applied to special situations where 'x1=n1' or 'x0=n0' but not for 'x1=0' and/or 'x0=0'. 'continuity.correction' can be considered where 'x1=0' and/or 'x0=0'.
</p>
</li>
<li><p> The <strong>mover-j</strong> method constructs the confidence interval for <code class="reqn">\phi</code> from separate intervals for the individual group rates (i.e., <code class="reqn">p_1</code> and <code class="reqn">p_0</code>).
By applying the equal-tailed Jeffreys method (default 0.5 to each group), it may achieve a skewness-corrected interval for <code class="reqn">\phi</code>. <br />
</p>
</li>
<li><p> The <strong>walter</strong> method constructs the confidence interval for <code class="reqn">\phi</code> based on <code class="reqn">log(\phi)</code>. 0.5 is added to 'x1', 'x0', 'n1', and 'n0'. Thus, no continuity correct should be applied additionally. This method has shown skewness concerns for
small ratios and sample sizes.
</p>
</li>
<li><p> The <strong>fieller</strong> method constructs the confidence interval for <code class="reqn">\phi</code> by solving the roots of a quadratic equation, see the reference for details. <br />
<br />
The <strong>pepe</strong>, <strong>zhou</strong>, and <strong>delta</strong> are three direct confidence interval methods for PPV and NPV.
<br />
</p>
</li>
<li><p> The <strong>pepe</strong> method finds the confidence intervals for PPV and NPV via diagnostic likelihood ratios (DLR) and associated logit(PPV) and logit(NPV). This method is not applicable for special
cases when 'x1=0', 'x0=0', 'x1=n1' or 'x0=n0'. Continuity correction should be considered for those special cases.
</p>
</li>
<li><p> The <strong>zhou</strong> method can return confidence intervals from the four methods described in the paper. Without continuity correction, it will return the confidence intervals
for PPV and NPV based on standard delta method and based on logit transformed method. If <code>continuity.correction=TRUE</code>, <code class="reqn">\frac{z_{\alpha/2}^2}{2}</code> will be added to 'x1', 'x0', 'n1', and 'n0', and the function will return the adjusted and adjusted logit confidence intervals
as described in the paper.
</p>
</li>
<li><p> The <strong>delta</strong> method constructs the confidence intervals based on the Wald-type formulation. The estimates and variances of PPV and NPV are calculated based equations described in the Zhou's paper listed in the <code>Reference</code> section.
</p>
</li>
<li><p> The <strong>boot</strong> method constructs the confidence intervals based on bootstrap method.
</p>
</li></ol>



<h3>Value</h3>

<p>A list object contains the method and the estimates of sensitivity, specificity, PPV, NPV and their confidence intervals.
</p>


<h3>References</h3>


<ol>
<li> <p>Gart JJ, Nam J (1988).
&ldquo;Approximate Interval Estimation of the Ratio of Binomial Parameters: A Review and Corrections for Skewness.&rdquo;
<em>Biometrics</em>, <b>44</b>(2), 323-338.
</p>
</li>
<li> <p>Mercaldo ND, Lau KF, Zhou XH (2007).
&ldquo;Confidence intervals for predictive values with an emphasis to case-control studies.&rdquo;
<em>Statistics in Medicine</em>, <b>26</b>, 2170-2183.
</p>
</li>
<li> <p>Laud PJ (2017).
&ldquo;Equal-tailed confidence intervals for comparison of rates.&rdquo;
<em>Pharmaceutical Statistics</em>, <b>16</b>(5), 334-348.
</p>
</li>
<li> <p>Pepe MS (2003).
<em>The Statistical Evaluation of Medical Tests for Classification and Prediction</em>.
Oxford University Press, New York.
</p>
</li>
<li> <p>Fieller EC (1954).
&ldquo;Some problems in interval estimation.&rdquo;
<em>Journal of the Royal Statistical Society: Series B (Methodological)</em>, <b>16</b>(2), 175-185.
</p>
</li></ol>



<h3>Examples</h3>

<pre><code class='language-R'>ppv_npv_ci(60, 65, 113, 113, prevalence = 0.02)
</code></pre>

<hr>
<h2 id='single_prop_ci'>Compute the confidence interval for a single proportion based on different methods</h2><span id='topic+single_prop_ci'></span>

<h3>Description</h3>

<p>Compute the confidence interval for a single proportion based on different methods
</p>


<h3>Usage</h3>

<pre><code class='language-R'>single_prop_ci(
  x,
  n,
  method = "all",
  alternative = "two.sided",
  conf.level = 0.95,
  prior = c(1, 1)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="single_prop_ci_+3A_x">x</code></td>
<td>
<p>number of successes</p>
</td></tr>
<tr><td><code id="single_prop_ci_+3A_n">n</code></td>
<td>
<p>number of trials</p>
</td></tr>
<tr><td><code id="single_prop_ci_+3A_method">method</code></td>
<td>
<p>one of these options &quot;all&quot;, &quot;clopper.pearson&quot;, &quot;wald&quot;, &quot;wislon&quot;, &quot;wislon.correct&quot;, &quot;agresti&quot;, or &quot;beta&quot;</p>
</td></tr>
<tr><td><code id="single_prop_ci_+3A_alternative">alternative</code></td>
<td>
<p>indicates &quot;two.sided&quot;, &quot;one.sided&quot;</p>
</td></tr>
<tr><td><code id="single_prop_ci_+3A_conf.level">conf.level</code></td>
<td>
<p>confidence level</p>
</td></tr>
<tr><td><code id="single_prop_ci_+3A_prior">prior</code></td>
<td>
<p>the prior values for &quot;beta&quot; method</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Estimated confidence intervals for the probability of success
</p>


<h3>Examples</h3>

<pre><code class='language-R'>single_prop_ci(53, 57, method = "all")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
