<!DOCTYPE html><html><head><title>Help for package CopulaDTA</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {CopulaDTA}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ascus'><p>ASCUS dataset</p></a></li>
<li><a href='#cdtafit-class'><p>Class cdtafit</p></a></li>
<li><a href='#cdtamodel'><p>Specify the copula based bivariate beta-binomial distribution to fit to the diagnostic data.</p></a></li>
<li><a href='#cdtamodel-class'><p>Class cdtamodel</p></a></li>
<li><a href='#fit'><p>A function to fit the model.</p></a></li>
<li><a href='#fit.cdtamodel'><p>Fit copula based bivariate beta-binomial distribution to diagnostic data.</p></a></li>
<li><a href='#forestplot.cdtafit'><p>Produce forest plots for categorical covariates.</p></a></li>
<li><a href='#ft'><p>Compute transform omega to ktau.</p></a></li>
<li><a href='#plot'><p>A function to produce forest plots.</p></a></li>
<li><a href='#prep.data'><p>Prepare the data</p></a></li>
<li><a href='#print.cdtafit'><p>Print a summary of the fitted model.</p></a></li>
<li><a href='#show,cdtamodel-method'><p>A function to print the model.</p></a></li>
<li><a href='#summary.cdtafit'><p>Function to generate a summary  a cdtafit object.</p></a></li>
<li><a href='#telomerase'><p>Telomerase dataset</p></a></li>
<li><a href='#traceplot'><p>A function to produce traceplots.</p></a></li>
<li><a href='#traceplot.cdtafit'><p>Trace plot using ggplot2.</p></a></li>
<li><a href='#waic'><p>Compute log pointwise predictive density, effective number of parameters and WAIC.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Copula Based Bivariate Beta-Binomial Model for Diagnostic Test
Accuracy Studies</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-02-20</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.2.0), rstan (&ge; 2.21.8)</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, ggplot2 (&ge; 3.4.1), plyr (&ge; 1.8.8), stats (&ge;
4.2.2), reshape2 (&ge; 1.4.4), grDevices (&ge; 4.2.2)</td>
</tr>
<tr>
<td>Description:</td>
<td>Modelling of sensitivity and specificity on their natural scale
    using copula based bivariate beta-binomial distribution to yield marginal
    mean sensitivity and specificity. The intrinsic negative correlation between
    sensitivity and specificity is modelled using a copula function. A forest plot
    can be obtained for categorical covariates or for the model with intercept only.
    Nyaga VN, Arbyn M, Aerts M (2017) &lt;<a href="https://doi.org/10.18637%2Fjss.v082.c01">doi:10.18637/jss.v082.c01</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, loo, Rmisc, httr, bayesplot, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-02-25 10:57:20 UTC; dries</td>
</tr>
<tr>
<td>Author:</td>
<td>Victoria N Nyaga [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Victoria N Nyaga &lt;victoria.nyaga@outlook.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-02-27 09:32:45 UTC</td>
</tr>
</table>
<hr>
<h2 id='ascus'>ASCUS dataset</h2><span id='topic+ascus'></span>

<h3>Description</h3>

<p>Arbyn et al. (2013) performed a Cochrane review on the accuracy of human papillomavirus
testing (HC2)and repeat cytology (RepC) to triage of women with an equivocal Pap smear to diagnose cervical precancer.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ascus)
</code></pre>


<h3>Format</h3>

<p>A data frame of 20 observations and six variables:
</p>

<dl>
<dt>StudyID</dt><dd><p>Study identifier</p>
</dd>
<dt>Test</dt><dd><p>Type of diagnostic test</p>
</dd>
<dt>TP</dt><dd><p>Number of true positives</p>
</dd>
<dt>FN</dt><dd><p>number of false negatives</p>
</dd>
<dt>TN</dt><dd><p>number of true negatives</p>
</dd>
<dt>FP</dt><dd><p>number of false positives</p>
</dd>
</dl>



<h3>References</h3>

<p>Arbyn M, Roelens J, Simoens C, Buntinx F, Paraskevaidis E, Martin-Hirsch PPL, Prendiville W (2013). Human Papillomavirus Testing Versus Repeat
Cytology for Triage of Minor Cytological Cervical Lesions.&quot; Cochrane Database of Systematic Reviews, pp. 31-201.
</p>
<p>Nyaga VN, Arbyn M, Aerts M (2017). CopulaDTA: An R Package for Copula-Based Beta-Binomial Models for Diagnostic Test Accuracy
Studies in a Bayesian Framework. Journal of Statistical Software, 82(1), 1-27. doi:10.18637/jss.v082.c01
</p>

<hr>
<h2 id='cdtafit-class'>Class cdtafit</h2><span id='topic+cdtafit-class'></span>

<h3>Description</h3>

<p>A cdtafit class in the CopulaDTA package.
</p>


<h3>Slots</h3>


<dl>
<dt><code>data</code></dt><dd><p>a data-frame with no missing values containing TP, TN, FP, FN, 'SID' and co-variables(if necessary).</p>
</dd>
<dt><code>SID</code></dt><dd><p>A string indicating the name of the column with the study identifier.</p>
</dd>
<dt><code>copula</code></dt><dd><p>copula function, 'fgm', 'gauss', 'c90', '270', or 'frank'.</p>
</dd>
<dt><code>modelargs</code></dt><dd><p>list containing control parameters for the prior distributions.</p>
</dd>
<dt><code>fit</code></dt><dd><p>an object of class stanfit returned by the function sampling.</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>Victoria N Nyaga <a href="mailto:victoria.nyaga@outlook.com">victoria.nyaga@outlook.com</a>
</p>


<h3>See Also</h3>

<p><a href="#topic+fit">fit</a>
</p>
<p>Other cdta: 
<code><a href="#topic+cdtamodel-class">cdtamodel-class</a></code>
</p>

<hr>
<h2 id='cdtamodel'>Specify the copula based bivariate beta-binomial distribution to fit to the diagnostic data.</h2><span id='topic+cdtamodel'></span>

<h3>Description</h3>

<p>Specify the copula based bivariate beta-binomial distribution to fit to the diagnostic data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cdtamodel(copula, modelargs = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cdtamodel_+3A_copula">copula</code></td>
<td>
<p>a description of the copula function used to model the correlation between sensitivity and specificity.
This is a string naming the copula function. The choices are &quot;fgm&quot;, &quot;frank&quot;, &quot;gauss&quot;, &quot;c90&quot; and &quot;c270&quot;.</p>
</td></tr>
<tr><td><code id="cdtamodel_+3A_modelargs">modelargs</code></td>
<td>
<p>a (optional) list of control parameter for the prior distributions. The parameters in the list include:
</p>

<ul>
<li><p>formula.se An  object of class &quot;formula&quot;: A symbolic description of a linear model to be fitted to mean E(x) of sensitivity in the logit scale.
the default (when no covariates are included) symbolic description is SID ~ 1 corresponds to the model formula E(x) = mu = exp(a)/(1 + exp(a)) where a is the intercept.
When the covariates are categorical and the relative measures are needed it is important to remove the intercept from the model to obtain meaningful parameters. EG for
a covariate 'Test' with two levels(A and B) and relative sensitivity of B versus A is needed, then the correct formula is SID ~ Test - 1 or SID ~ Test + 0. See <a href="stats.html#topic+formula">formula</a>.
For further information on interpretation of parameters in logistic regression see Agresti A(2002) Chapter 5.
</p>
</li>
<li><p>formula.sp An object of class &quot;formula&quot;: A symbolic description of a linear model to be fitted to specificity data.
By default the covariate information for sensitivity is used.
</p>
</li>
<li><p>formula.omega An object of class &quot;formula&quot;: A symbolic description of a linear model to be fitted to the copula function.
By default the covariate information for sensitivity is used.
</p>
</li>
<li><p>transform.omega A logical value indicating whether a constrained correlation parameter should be mapped into an non-constrained scale.
This applies to all the allowed copula functions except &quot;frank&quot;. The default is TRUE.
</p>
</li>
<li><p>param indication of the parameterisation used to map the marginal mean and precision/dispersion to the alpha and beta parameters of the beta distribution.
There are two choices: param=1 which uses </p>
<p style="text-align: center;"><code class="reqn">alpha = mu*phi, beta = (1 - mu)*phi</code>
</p>
<p> where </p>
<p style="text-align: center;"><code class="reqn">mu = alpha/(alpha + beta), 0&lt;=mu&lt;=1,</code>
</p>
<p> and
</p>
<p style="text-align: center;"><code class="reqn">phi = alpha + beta, phi &gt;= 0.</code>
</p>

<p>param=2 uses </p>
<p style="text-align: center;"><code class="reqn">alpha = ((1 - phi)/phi)*mu</code>
</p>

<p style="text-align: center;"><code class="reqn">beta = ((1 - phi)/phi)*(1 - mu)</code>
</p>
<p> where </p>
<p style="text-align: center;"><code class="reqn">mu = alpha/(alpha + beta); 0&lt;=mu&lt;=1,</code>
</p>
<p> and
</p>
<p style="text-align: center;"><code class="reqn">phi = 1/( 1 + alpha + beta); 0&lt;=phi&lt;=1.</code>
</p>

</li>
<li><p>prior.lseA description of prior distribution of the marginal mean sensitivity in the logit scale. The default is &quot;normal&quot; distribution.
For other distributions see stan documentation at <a href="https://mc-stan.org/documentation/">https://mc-stan.org/documentation/</a>.
</p>
</li>
<li><p>par.lse1A numeric value indicating the location of the prior distribution of the marginal mean sensitivity in the logit scale.
The default is 0 which implying a distribution centered around 0.5 in the 0-1 scale.
</p>
</li>
<li><p>par.lse2A numeric value indicating the spread(standard deviation) pf the prior distribution of the marginal mean sensitivity in the logit scale
and can be interpreted as the quantity of prior information.
vague and non-informative priors are specified by a distribution with large variance. The default is sd=10 implying that the variance is 100.
</p>
</li>
<li><p>prior.lspA  description of prior distribution of the marginal mean specificity in the logit scale. The default is &quot;normal&quot; distribution.
</p>
</li>
<li><p> par.lsp1A numeric value indicating the location of the prior distribution of the marginal mean specificity in the logit scale.
The default is 0 which implying a distribution centered around 0.5 in the 0-1 scale.
</p>
</li>
<li><p>par.lsp2A numeric value indicating the spread(standard deviation) pf the prior distribution of the marginal mean specificity in the logit scale
and can be interpreted as the quantity of prior information.
vague and non-informative priors are specified by a distribution with large variance. The default is sd=10 implying that the variance is 100.
</p>
</li>
<li><p>prior.omegaA description of prior distribution of the correlation parameter(s). The default is &quot;normal&quot; distribution since &quot;transform.omega=TRUE&quot;.
When &quot;transform.omega=FALSE&quot; the candidate prior distributions are U[-1, 1] for fgm and gaussian copulas, and half-cauchy(0, 2.5), gamma(0.001, 0.001) for the C90 and C270.
</p>
</li>
<li><p>par.omega1A numeric value indicating the location of the prior distribution of the correlation parameter(s). The default is 0.
</p>
</li>
<li><p>par.omega2A numeric value indicating the scale/spread(standard deviation) of the prior distribution of the correlation parameter(s). The default is sd=10.
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of cdtamodel class.
</p>


<h3>Author(s)</h3>

<p>Victoria N Nyaga
</p>


<h3>References</h3>

<p>Nyaga VN, Arbyn M, Aerts M (2017). CopulaDTA: An R Package for Copula-Based Beta-Binomial Models for Diagnostic Test Accuracy
Studies in a Bayesian Framework. Journal of Statistical Software, 82(1), 1-27. doi:10.18637/jss.v082.c01
</p>
<p>Agresti A (2002). Categorical Data Analysis. John Wiley &amp; Sons, Inc.
</p>
<p>Clayton DG (1978). A model for Association in Bivariate Life Tables and its Application in
Epidemiological Studies of Familial Tendency in Chronic Disease Incidence. Biometrika,65(1), 141-151.
</p>
<p>Frank MJ (1979). On The Simultaneous Associativity of F(x, y) and x + y - F(x, y). Aequationes Mathematicae, pp. 194-226.
</p>
<p>Farlie DGJ (1960). The Performance of Some Correlation Coefficients for a General Bivariate
Distribution. Biometrika, 47, 307-323.
</p>
<p>Gumbel EJ (1960). Bivariate Exponential Distributions. Journal of the American Statistical Association, 55, 698-707.
</p>
<p>Meyer C (2013). The Bivariate Normal Copula. Communications in Statistics - Theory and Methods, 42(13), 2402-2422.
</p>
<p>Morgenstern D (1956). Einfache Beispiele Zweidimensionaler Verteilungen. Mitteilungsblatt furMathematische Statistik, 8, 23 - 235.
</p>
<p>Sklar A (1959). Fonctions de Repartition a n Dimensions et Leurs Marges. Publications de l'Institut de Statistique de L'Universite de Paris, 8, 229-231.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(telomerase)
model1 &lt;-  cdtamodel(copula = 'fgm')

model2 &lt;- cdtamodel(copula = 'fgm',
               modelargs=list(param=2,
                              prior.lse='normal',
                              par.lse1=0,
                              par.lse2=5,
                              prior.lsp='normal',
                              par.lsp1=0,
                              par.lsp2=5))

model3 &lt;-  cdtamodel(copula = 'fgm',
               modelargs = list(formula.se = StudyID ~ Test - 1))
</code></pre>

<hr>
<h2 id='cdtamodel-class'>Class cdtamodel</h2><span id='topic+cdtamodel-class'></span>

<h3>Description</h3>

<p>A cdtamodel class in the CopulaDTA package.
</p>


<h3>Slots</h3>


<dl>
<dt><code>copula</code></dt><dd><p>copula function, 'fgm', 'gauss', 'c90', '270', or 'frank'.</p>
</dd>
<dt><code>modelcode</code></dt><dd><p>character with the model code as returned by the model function</p>
</dd>
<dt><code>modelargs</code></dt><dd><p>list containing control parameters for the prior distributions</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>Victoria N Nyaga <a href="mailto:victoria.nyaga@outlook.com">victoria.nyaga@outlook.com</a>
</p>


<h3>See Also</h3>

<p><a href="#topic+cdtamodel">cdtamodel</a>
</p>
<p>Other cdta: 
<code><a href="#topic+cdtafit-class">cdtafit-class</a></code>
</p>

<hr>
<h2 id='fit'>A function to fit the model.</h2><span id='topic+fit'></span><span id='topic+fit+2Ccdtamodel-method'></span>

<h3>Description</h3>

<p>A function to fit the model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit(object, ...)

## S4 method for signature 'cdtamodel'
fit(
  object,
  data,
  SID,
  cores = 3,
  chains = 3,
  iter = 6000,
  warmup = 1000,
  thin = 10,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_+3A_object">object</code></td>
<td>
<p>A cdtamodel object created by <a href="#topic+cdtamodel">cdtamodel</a> function.</p>
</td></tr>
<tr><td><code id="fit_+3A_...">...</code></td>
<td>
<p>Other optional parameters as specified in <a href="rstan.html#topic+stan">stan</a>.</p>
</td></tr>
<tr><td><code id="fit_+3A_data">data</code></td>
<td>
<p>A data-frame with no missing values containing TP, TN, FP, FN, 'SID' and co-variables(if necessary).</p>
</td></tr>
<tr><td><code id="fit_+3A_sid">SID</code></td>
<td>
<p>A string indicating the name of the column with the study identifier.</p>
</td></tr>
<tr><td><code id="fit_+3A_cores">cores</code></td>
<td>
<p>A positive numeric values specifying the number of cores to use to execute parallel sampling. When the hardware has more at least 4 cores,
the default is 3 cores and otherwise 1 core.</p>
</td></tr>
<tr><td><code id="fit_+3A_chains">chains</code></td>
<td>
<p>A positive numeric value specifying the number of chains, default is 3.</p>
</td></tr>
<tr><td><code id="fit_+3A_iter">iter</code></td>
<td>
<p>A positive numeric value specifying the number of iterations per chain. The default is 6000.</p>
</td></tr>
<tr><td><code id="fit_+3A_warmup">warmup</code></td>
<td>
<p>A positive numeric value (&lt;iter) specifying the number of iterations to be discarded(burn-in/warm-up). The default is 1000.</p>
</td></tr>
<tr><td><code id="fit_+3A_thin">thin</code></td>
<td>
<p>A positive numeric value specifying the interval in which the samples are stored. The default is 10.</p>
</td></tr>
</table>

<hr>
<h2 id='fit.cdtamodel'>Fit copula based bivariate beta-binomial distribution to diagnostic data.</h2><span id='topic+fit.cdtamodel'></span>

<h3>Description</h3>

<p>Fit copula based bivariate beta-binomial distribution to diagnostic data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit.cdtamodel(
  cdtamodel,
  data,
  SID,
  cores = 3,
  chains = 3,
  iter = 6000,
  warmup = 1000,
  thin = 10,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit.cdtamodel_+3A_cdtamodel">cdtamodel</code></td>
<td>
<p>An object of cdtamodel class from <a href="#topic+cdtamodel">cdtamodel</a>.</p>
</td></tr>
<tr><td><code id="fit.cdtamodel_+3A_data">data</code></td>
<td>
<p>A data-frame with no missing values containing TP, TN, FP, FN, 'SID' and co-variables(if necessary).</p>
</td></tr>
<tr><td><code id="fit.cdtamodel_+3A_sid">SID</code></td>
<td>
<p>A string indicating the name of the column with the study identifier.</p>
</td></tr>
<tr><td><code id="fit.cdtamodel_+3A_cores">cores</code></td>
<td>
<p>A positive numeric values specifying the number of cores to use to execute parallel sampling. When the hardware has more at least 4 cores,
the default is 3 cores and otherwise 1 core.</p>
</td></tr>
<tr><td><code id="fit.cdtamodel_+3A_chains">chains</code></td>
<td>
<p>A positive numeric value specifying the number of chains, default is 3.</p>
</td></tr>
<tr><td><code id="fit.cdtamodel_+3A_iter">iter</code></td>
<td>
<p>A positive numeric value specifying the number of iterations per chain. The default is 6000.</p>
</td></tr>
<tr><td><code id="fit.cdtamodel_+3A_warmup">warmup</code></td>
<td>
<p>A positive numeric value (&lt;iter) specifying the number of iterations to be discarded(burn-in/warm-up). The default is 1000.</p>
</td></tr>
<tr><td><code id="fit.cdtamodel_+3A_thin">thin</code></td>
<td>
<p>A positive numeric value specifying the interval in which the samples are stored. The default is 10.</p>
</td></tr>
<tr><td><code id="fit.cdtamodel_+3A_...">...</code></td>
<td>
<p>Other optional parameters as specified in <a href="rstan.html#topic+stan">stan</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of cdtafit class.
</p>


<h3>Author(s)</h3>

<p>Victoria N Nyaga &lt;victoria.nyaga@outlook.com&gt;
</p>


<h3>References</h3>

<p>Nyaga VN, Arbyn M, Aerts M (2017). CopulaDTA: An R Package for Copula-Based Beta-Binomial Models for Diagnostic Test Accuracy
Studies in a Bayesian Framework. Journal of Statistical Software, 82(1), 1-27. doi:10.18637/jss.v082.c01
</p>
<p>Agresti A (2002). Categorical Data Analysis. John Wiley &amp; Sons, Inc.
</p>
<p>Clayton DG (1978). A model for Association in Bivariate Life Tables and its Application in
Epidemiological Studies of Familial Tendency in Chronic Disease Incidence. Biometrika,65(1), 141-151.
</p>
<p>Frank MJ (1979). On The Simultaneous Associativity of F(x, y) and x + y - F(x, y). Aequationes Mathematicae, pp. 194-226.
</p>
<p>Farlie DGJ (1960). The Performance of Some Correlation Coefficients for a General Bivariate
Distribution. Biometrika, 47, 307-323.
</p>
<p>Gumbel EJ (1960). Bivariate Exponential Distributions. Journal of the American Statistical Association, 55, 698-707.
</p>
<p>Meyer C (2013). The Bivariate Normal Copula. Communications in Statistics - Theory and Methods, 42(13), 2402-2422.
</p>
<p>Morgenstern D (1956). Einfache Beispiele Zweidimensionaler Verteilungen. Mitteilungsblatt furMathematische Statistik, 8, 23 - 235.
</p>
<p>Sklar A (1959). Fonctions de Repartition a n Dimensions et Leurs Marges. Publications de l'Institut de Statistique de L'Universite de Paris, 8, 229-231.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(telomerase)
model1 &lt;-  cdtamodel(copula = 'fgm')

model2 &lt;- cdtamodel(copula = 'fgm',
               modelargs=list(param=2,
                              prior.lse='normal',
                              par.lse1=0,
                              par.lse2=5,
                              prior.lsp='normal',
                              par.lsp1=0,
                              par.lsp2=5))

model3 &lt;-  cdtamodel(copula = 'fgm',
               modelargs = list(formula.se = StudyID ~ Test - 1))
## Not run: 
fit1 &lt;- fit(model1,
                SID='ID',
                data=telomerase,
                iter=2000,
                warmup=1000,
                thin=1,
                seed=3)


fit2 &lt;- fit(model2,
                SID='StudyID',
                data=ascus,
                iter=2000,
                warmup=1000,
                thin=1,
                seed=3)

## End(Not run)

</code></pre>

<hr>
<h2 id='forestplot.cdtafit'>Produce forest plots for categorical covariates.</h2><span id='topic+forestplot.cdtafit'></span>

<h3>Description</h3>

<p>Produce forest plots for categorical covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>forestplot.cdtafit(
  x,
  title.1 = NULL,
  title.2 = NULL,
  title.3 = NULL,
  graph = NULL,
  width = 0.2,
  shape.1 = 19,
  size.1 = 2.5,
  shape.2 = 8,
  size.2 = 2.5,
  shape.O = 9,
  size.O = 3.5,
  cols.1 = NULL,
  cols.2 = NULL,
  digits = 3,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="forestplot.cdtafit_+3A_x">x</code></td>
<td>
<p>A cdtafit object from <a href="#topic+fit">fit</a>.</p>
</td></tr>
<tr><td><code id="forestplot.cdtafit_+3A_title.1">title.1</code></td>
<td>
<p>An optional string indicating the title of graph 1.</p>
</td></tr>
<tr><td><code id="forestplot.cdtafit_+3A_title.2">title.2</code></td>
<td>
<p>An optional string indicating the title of graph 2.</p>
</td></tr>
<tr><td><code id="forestplot.cdtafit_+3A_title.3">title.3</code></td>
<td>
<p>An optional string indicating the title of graph 3.</p>
</td></tr>
<tr><td><code id="forestplot.cdtafit_+3A_graph">graph</code></td>
<td>
<p>An optional numeric value indicating which forest to plot(s) to graph. Valid values are:0 - for no graph, 1 - yielding a forest plot of the
sensitivity and specificity with a 95 percent exact confidence intervals, 2 - yielding a forest plot of the posterior study-specific sensitivity and specificity
and the marginal mean sensitivity and specificity and their corresponding 95 percent credible intervals, 3 - yielding a combination of 1 and 2 in one plot, and NULL(default) - yielding plots of
1, 2 and 3.</p>
</td></tr>
<tr><td><code id="forestplot.cdtafit_+3A_width">width</code></td>
<td>
<p>An optional numeric value to adjust the dogding position. The default is 0.2.</p>
</td></tr>
<tr><td><code id="forestplot.cdtafit_+3A_shape.1">shape.1</code></td>
<td>
<p>An optional numeric value(0-255) indicating the symbol to plot in graph 1. The default is 19 which is a solid circle. See <a href="graphics.html#topic+points">points</a> for more details.</p>
</td></tr>
<tr><td><code id="forestplot.cdtafit_+3A_size.1">size.1</code></td>
<td>
<p>An optional positive numeric value indicating the size of symbols in graph 1. The default is 2.5.</p>
</td></tr>
<tr><td><code id="forestplot.cdtafit_+3A_shape.2">shape.2</code></td>
<td>
<p>An optional numeric value(0-255) indicating the symbol to plot in graph 2. The default is 8 which is a star. See <a href="graphics.html#topic+points">points</a> for more details.</p>
</td></tr>
<tr><td><code id="forestplot.cdtafit_+3A_size.2">size.2</code></td>
<td>
<p>An optional positive numeric value indicating the size of symbols in graph 2. The default is 2.5.</p>
</td></tr>
<tr><td><code id="forestplot.cdtafit_+3A_shape.o">shape.O</code></td>
<td>
<p>An optional numeric value(0-255) indicating the symbol representing the posterior marginal mean in graph 2. The default is 19 which is a solid circle. See <a href="graphics.html#topic+points">points</a> for more details.</p>
</td></tr>
<tr><td><code id="forestplot.cdtafit_+3A_size.o">size.O</code></td>
<td>
<p>An optional numeric value indicating the size of symbols representing the posterior marginal means in graph 2.</p>
</td></tr>
<tr><td><code id="forestplot.cdtafit_+3A_cols.1">cols.1</code></td>
<td>
<p>An optional string vector specifying colours of shapes in graph 1.</p>
</td></tr>
<tr><td><code id="forestplot.cdtafit_+3A_cols.2">cols.2</code></td>
<td>
<p>An optional string vector specifying colours of shapes in graph 2.</p>
</td></tr>
<tr><td><code id="forestplot.cdtafit_+3A_digits">digits</code></td>
<td>
<p>An optional positive value to control the number of digits to print when printing numeric values. The default is 3.</p>
</td></tr>
<tr><td><code id="forestplot.cdtafit_+3A_...">...</code></td>
<td>
<p>other <a href="rstan.html#topic+stan">stan</a> options.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>forest plots by ggplot2.
</p>


<h3>Author(s)</h3>

<p>Victoria N Nyaga &lt;victoria.nyaga@outlook.com&gt;
</p>


<h3>References</h3>

<p>Watanabe S (2010). Asymptotic Equivalence of Bayes Cross Validation and Widely Applicable Information Criterion in Singular
Learning Theory. Journal of Machine Learning Research, 11, 3571-3594.
</p>
<p>Vehtari A, Gelman A (2014). WAIC and Cross-validation in Stan. Unpublished, pp. 1-14.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(telomerase)
model1 =  cdtamodel(copula = 'fgm')

model2 = cdtamodel(copula = 'fgm',
               modelargs=list(param=2,
                              prior.lse='normal',
                              par.lse1=0,
                              par.lse2=5,
                              prior.lsp='normal',
                              par.lsp1=0,
                              par.lsp2=5))

model3 =  cdtamodel(copula = 'fgm',
               modelargs = list(formula.se = StudyID ~ Test - 1))
## Not run: 
fit1 &lt;- fit(model1,
                SID='ID',
                data=telomerase,
                iter=2000,
                warmup=1000,
                thin=1,
                seed=3)

plot(fit1)

## End(Not run)
</code></pre>

<hr>
<h2 id='ft'>Compute transform omega to ktau.</h2><span id='topic+ft'></span>

<h3>Description</h3>

<p>Compute transform omega to ktau.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ft(t)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ft_+3A_theta">theta</code></td>
<td>
<p>correlation parameter(s) from the frank copula function.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Victoria N Nyaga
</p>

<hr>
<h2 id='plot'>A function to produce forest plots.</h2><span id='topic+plot'></span><span id='topic+plot+2Ccdtafit-method'></span>

<h3>Description</h3>

<p>A function to produce forest plots.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot(object, ...)

## S4 method for signature 'cdtafit'
plot(
  object,
  title.1 = NULL,
  title.2 = NULL,
  title.3 = NULL,
  graph = NULL,
  width = 0.2,
  shape.1 = 19,
  size.1 = 2.5,
  shape.2 = 8,
  size.2 = 2.5,
  shape.O = 9,
  size.O = 3.5,
  cols.1 = NULL,
  cols.2 = NULL,
  digits = 3,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_+3A_object">object</code></td>
<td>
<p>A cdtafit object from <a href="#topic+fit">fit</a>.</p>
</td></tr>
<tr><td><code id="plot_+3A_...">...</code></td>
<td>
<p>other <a href="rstan.html#topic+stan">stan</a> options.</p>
</td></tr>
<tr><td><code id="plot_+3A_title.1">title.1</code></td>
<td>
<p>An optional string indicating the title of graph 1.</p>
</td></tr>
<tr><td><code id="plot_+3A_title.2">title.2</code></td>
<td>
<p>An optional string indicating the title of graph 2.</p>
</td></tr>
<tr><td><code id="plot_+3A_title.3">title.3</code></td>
<td>
<p>An optional string indicating the title of graph 3.</p>
</td></tr>
<tr><td><code id="plot_+3A_graph">graph</code></td>
<td>
<p>An optional numeric value indicating which forest to plot(s) to graph. Valid values are:0 - for no graph, 1 - yielding a forest plot of the
sensitivity and specificity with a 95 percent exact confidence intervals, 2 - yielding a forest plot of the posterior study-specific sensitivity and specificity
and the marginal mean sensitivity and specificity and their corresponding 95 percent credible intervals, 3 - yielding a combination of 1 and 2 in one plot, and NULL(default) - yielding plots of
1, 2 and 3.</p>
</td></tr>
<tr><td><code id="plot_+3A_width">width</code></td>
<td>
<p>An optional numeric value to adjust the dogding position. The default is 0.2.</p>
</td></tr>
<tr><td><code id="plot_+3A_shape.1">shape.1</code></td>
<td>
<p>An optional numeric value(0-255) indicating the symbol to plot in graph 1. The default is 19 which is a solid circle. See <a href="graphics.html#topic+points">points</a> for more details.</p>
</td></tr>
<tr><td><code id="plot_+3A_size.1">size.1</code></td>
<td>
<p>An optional positive numeric value indicating the size of symbols in graph 1. The default is 2.5.</p>
</td></tr>
<tr><td><code id="plot_+3A_shape.2">shape.2</code></td>
<td>
<p>An optional numeric value(0-255) indicating the symbol to plot in graph 2. The default is 8 which is a star. See <a href="graphics.html#topic+points">points</a> for more details.</p>
</td></tr>
<tr><td><code id="plot_+3A_size.2">size.2</code></td>
<td>
<p>An optional positive numeric value indicating the size of symbols in graph 2. The default is 2.5.</p>
</td></tr>
<tr><td><code id="plot_+3A_shape.o">shape.O</code></td>
<td>
<p>An optional numeric value(0-255) indicating the symbol representing the posterior marginal mean in graph 2. The default is 19 which is a solid circle. See <a href="graphics.html#topic+points">points</a> for more details.</p>
</td></tr>
<tr><td><code id="plot_+3A_size.o">size.O</code></td>
<td>
<p>An optional numeric value indicating the size of symbols representing the posterior marginal means in graph 2.</p>
</td></tr>
<tr><td><code id="plot_+3A_cols.1">cols.1</code></td>
<td>
<p>An optional string vector specifying colours of shapes in graph 1.</p>
</td></tr>
<tr><td><code id="plot_+3A_cols.2">cols.2</code></td>
<td>
<p>An optional string vector specifying colours of shapes in graph 2.</p>
</td></tr>
<tr><td><code id="plot_+3A_digits">digits</code></td>
<td>
<p>An optional positive value to control the number of digits to print when printing numeric values. The default is 3.</p>
</td></tr>
</table>

<hr>
<h2 id='prep.data'>Prepare the data</h2><span id='topic+prep.data'></span>

<h3>Description</h3>

<p>Prepare the data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prep.data(data, SID, formula.se, formula.sp, formula.omega)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prep.data_+3A_data">data</code></td>
<td>
<p>A data-frame with no missing values containing TP, TN, FP, FN, 'SID' and co-variables(if necessary).</p>
</td></tr>
<tr><td><code id="prep.data_+3A_sid">SID</code></td>
<td>
<p>A string indicating the name of the column with the study ID.</p>
</td></tr>
<tr><td><code id="prep.data_+3A_formula.se">formula.se</code></td>
<td>
<p>An optional object of class &quot;formula&quot;: A symbolic description of a linear model to be fitted to mean E(x) of sensitivity in the logit scale.
the default (when no covariates are included) symbolic description is SID ~ 1 corresponds to the model formula E(x) = mu = exp(a)/(1 + exp(a)) where a is the intercept.
When the covariates are categorical and the relative measures are needed it is important to remove the intercept from the model to obtain meaningful parameters. EG for
a covariate 'Test' with two levels(A and B) and relative sensitivity of B versus A is needed, then the correct formula is SID ~ Test - 1. See **** .
Further information on interpretation of parameters in logistic regression see ***</p>
</td></tr>
<tr><td><code id="prep.data_+3A_formula.sp">formula.sp</code></td>
<td>
<p>An optional object of class &quot;formula&quot;: A symbolic description of a linear model to be fitted to specificity data.
When no covariates are included, the formula is not necessary. By default the covariate information for sensitivity is used.</p>
</td></tr>
<tr><td><code id="prep.data_+3A_formula.omega">formula.omega</code></td>
<td>
<p>An optional object of class &quot;formula&quot;: A symbolic description of a linear model to be fitted to the copula function.
When no covariates are included, the formula is not necessary. By default the covariate information for sensitivity is used.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Victoria N Nyaga
</p>

<hr>
<h2 id='print.cdtafit'>Print a summary of the fitted model.</h2><span id='topic+print.cdtafit'></span>

<h3>Description</h3>

<p>Print a summary of the fitted model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cdtafit'
print(x, digits = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.cdtafit_+3A_x">x</code></td>
<td>
<p>An cdtafit object from <a href="#topic+fit">fit</a>.</p>
</td></tr>
<tr><td><code id="print.cdtafit_+3A_digits">digits</code></td>
<td>
<p>An optional positive value to control the number of digits to print when printing numeric values. The default is 3.</p>
</td></tr>
<tr><td><code id="print.cdtafit_+3A_...">...</code></td>
<td>
<p>other <a href="rstan.html#topic+stan">stan</a> options.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The posterior mean and 95 percent credible intervals, n_eff, Rhat and WAIC.
</p>


<h3>Author(s)</h3>

<p>Victoria N Nyaga
</p>


<h3>References</h3>

<p>Watanabe S (2010). Asymptotic Equivalence of Bayes Cross Validation and Widely Applicable Information Criterion in Singular
Learning Theory. Journal of Machine Learning Research, 11, 3571-3594.
</p>
<p>Vehtari A, Gelman A (2014). WAIC and Cross-validation in Stan. Unpublished, pp. 1-14.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(telomerase)
model1 &lt;-  cdtamodel(copula = 'fgm')

model2 &lt;- cdtamodel(copula = 'fgm',
               modelargs=list(param=2,
                              prior.lse='normal',
                              par.lse1=0,
                              par.lse2=5,
                              prior.lsp='normal',
                              par.lsp1=0,
                              par.lsp2=5))

model3 &lt;-  cdtamodel(copula = 'fgm',
               modelargs = list(formula.se = StudyID ~ Test - 1))
## Not run: 

fit1 &lt;- fit(model1,
                SID='ID',
                data=telomerase,
                iter=2000,
                warmup=1000,
                thin=1,
                seed=3)

print(fit1)


## End(Not run)
</code></pre>

<hr>
<h2 id='show+2Ccdtamodel-method'>A function to print the model.</h2><span id='topic+show+2Ccdtamodel-method'></span><span id='topic+show+2Ccdtafit-method'></span>

<h3>Description</h3>

<p>A function to print the model.
</p>
<p>A function to print the results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'cdtamodel'
show(object)

## S4 method for signature 'cdtafit'
show(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="show+2B2Ccdtamodel-method_+3A_object">object</code></td>
<td>
<p>A cdtamodel object returned by <a href="#topic+cdtamodel">cdtamodel</a> function.</p>
</td></tr>
</table>

<hr>
<h2 id='summary.cdtafit'>Function to generate a summary  a cdtafit object.</h2><span id='topic+summary.cdtafit'></span>

<h3>Description</h3>

<p>Function to generate a summary  a cdtafit object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cdtafit'
summary(object, digits = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.cdtafit_+3A_object">object</code></td>
<td>
<p>An object from <a href="#topic+fit">fit</a>.</p>
</td></tr>
<tr><td><code id="summary.cdtafit_+3A_digits">digits</code></td>
<td>
<p>An optional positive value to control the number of digits to print when printing numeric values.</p>
</td></tr>
<tr><td><code id="summary.cdtafit_+3A_...">...</code></td>
<td>
<p>other <a href="rstan.html#topic+stan">stan</a> options.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The posterior mean and 95 percent credible intervals, n_eff, Rhat and WAIC.
</p>


<h3>Author(s)</h3>

<p>Victoria N Nyaga
</p>


<h3>References</h3>

<p>Nyaga VN, Arbyn M, Aerts M (2017). CopulaDTA: An R Package for Copula-Based Beta-Binomial Models for Diagnostic Test Accuracy
Studies in a Bayesian Framework. Journal of Statistical Software, 82(1), 1-27. doi:10.18637/jss.v082.c01
</p>
<p>Watanabe S (2010). Asymptotic Equivalence of Bayes Cross Validation and Widely Applicable Information Criterion in Singular
Learning Theory. Journal of Machine Learning Research, 11, 3571-3594.
</p>
<p>Vehtari A, Gelman A (2014). WAIC and Cross-validation in Stan. Unpublished, pp. 1-14.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(telomerase)
model1 &lt;-  cdtamodel(copula = 'fgm')

model2 &lt;- cdtamodel(copula = 'fgm',
               modelargs=list(param=2,
                              prior.lse='normal',
                              par.lse1=0,
                              par.lse2=5,
                              prior.lsp='normal',
                              par.lsp1=0,
                              par.lsp2=5))

model3 &lt;-  cdtamodel(copula = 'fgm',
               modelargs = list(formula.se = StudyID ~ Test - 1))
## Not run: 

fit1 &lt;- fit(model1,
                SID='ID',
                data=telomerase,
                iter=2000,
                warmup=1000,
                thin=1,
                seed=3)

ss &lt;- summary(fit1)


## End(Not run)
</code></pre>

<hr>
<h2 id='telomerase'>Telomerase dataset</h2><span id='topic+telomerase'></span>

<h3>Description</h3>

<p>Glas et al. (2003) systematically reviewed the sensitivity and specificity of cytology and other
markers including telomerase for primary diagnosis of bladder cancer.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(telomerase)
</code></pre>


<h3>Format</h3>

<p>A data frame of ten observations and five variables:
</p>

<dl>
<dt>ID</dt><dd><p>Study identifier</p>
</dd>
<dt>TP</dt><dd><p>Number of true positives</p>
</dd>
<dt>FN</dt><dd><p>number of false negatives</p>
</dd>
<dt>TN</dt><dd><p>number of true negatives</p>
</dd>
<dt>FP</dt><dd><p>number of false positives</p>
</dd>
</dl>



<h3>References</h3>

<p>Glas AS, Roos D, Deutekom M, Zwinderman AH, Bossuyt PMM, Kurth KH (2003). Tumor Markers in the Diagnosis of Primary Bladder Cancer.
A Systematic Review. The Journal of Urology, 169(6), 1975-1982.
</p>
<p>Nyaga VN, Arbyn M, Aerts M (2017). CopulaDTA: An R Package for Copula-Based Beta-Binomial Models for Diagnostic Test Accuracy
Studies in a Bayesian Framework. Journal of Statistical Software, 82(1), 1-27. doi:10.18637/jss.v082.c01
</p>

<hr>
<h2 id='traceplot'>A function to produce traceplots.</h2><span id='topic+traceplot'></span><span id='topic+traceplot+2Ccdtafit-method'></span>

<h3>Description</h3>

<p>A function to produce traceplots.
</p>
<p>A function to produce traceplots.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>traceplot(object, ...)

## S4 method for signature 'cdtafit'
traceplot(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="traceplot_+3A_object">object</code></td>
<td>
<p>A cdtafit object from <a href="#topic+fit">fit</a></p>
</td></tr>
<tr><td><code id="traceplot_+3A_...">...</code></td>
<td>
<p>Extra optional arguments as defined in <a href="rstan.html#topic+stan_trace">stan_trace</a>.</p>
</td></tr>
</table>

<hr>
<h2 id='traceplot.cdtafit'>Trace plot using ggplot2.</h2><span id='topic+traceplot.cdtafit'></span>

<h3>Description</h3>

<p>Trace plot using ggplot2.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>traceplot.cdtafit(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="traceplot.cdtafit_+3A_x">x</code></td>
<td>
<p>An cdtafit object from <a href="#topic+fit">fit</a>.</p>
</td></tr>
<tr><td><code id="traceplot.cdtafit_+3A_...">...</code></td>
<td>
<p>additional options. See <a href="rstan.html#topic+stan_trace">stan_trace</a> for more details.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot object of the parameters of the models mean structure.
</p>


<h3>Author(s)</h3>

<p>Victoria N Nyaga
</p>


<h3>References</h3>

<p>Nyaga VN, Arbyn M, Aerts M (2017). CopulaDTA: An R Package for Copula-Based Beta-Binomial Models for Diagnostic Test Accuracy
Studies in a Bayesian Framework. Journal of Statistical Software, 82(1), 1-27. doi:10.18637/jss.v082.c01
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(telomerase)
model1 &lt;-  cdtamodel(copula = 'fgm')

model2 &lt;- cdtamodel(copula = 'fgm',
               modelargs=list(param=2,
                              prior.lse='normal',
                              par.lse1=0,
                              par.lse2=5,
                              prior.lsp='normal',
                              par.lsp1=0,
                              par.lsp2=5))

model3 &lt;-  cdtamodel(copula = 'fgm',
               modelargs = list(formula.se = StudyID ~ Test - 1))
## Not run: 
fit1 &lt;- fit(model1,
                SID='ID',
                data=telomerase,
                iter=2000,
                warmup=1000,
                thin=1,
                seed=3)

traceplot(fit1)

traceplot(fit1) +
theme(axis.text.x = element_text(size=10, colour='black'),
      axis.text.y = element_text(size=10, colour='black'),
      axis.title.x = element_text(size=10, colour='black'),
      strip.text = element_text(size = 10, colour='black'),
      axis.title.y= element_text(size=10, angle=0, colour='black'),
      strip.text.y = element_text(size = 10, colour='black'),
      strip.text.x = element_text(size = 10, colour='black'),
      plot.background = element_rect(fill = "white", colour='white'),
      panel.grid.major = element_blank(),
      panel.background = element_blank(),
      strip.background = element_blank(),
      axis.line.x = element_line(color = 'black'),
      axis.line.y = element_line(color = 'black'))

## End(Not run)
</code></pre>

<hr>
<h2 id='waic'>Compute log pointwise predictive density, effective number of parameters and WAIC.</h2><span id='topic+waic'></span>

<h3>Description</h3>

<p>Compute log pointwise predictive density, effective number of parameters and WAIC.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>waic(model)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="waic_+3A_model">model</code></td>
<td>
<p>stanfit object</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Victoria N Nyaga
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
