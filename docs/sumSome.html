<!DOCTYPE html><html><head><title>Help for package sumSome</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {sumSome}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#sumSome-package'>
<p>True Discovery Guarantee by Sum-Based Tests</p></a></li>
<li><a href='#brainPvals'><p>Permutation p-Values for Brain Imaging</p></a></li>
<li><a href='#brainScores'><p>Permutation t-Scores for Brain Imaging</p></a></li>
<li><a href='#clusterAnalysis'><p>True Discovery Guarantee for Cluster Analysis</p></a></li>
<li><a href='#discoveries'><p>Confidence Bound for the Number of True Discoveries</p></a></li>
<li><a href='#fdp'><p>Confidence Bound for the FDP</p></a></li>
<li><a href='#findClusters'><p>Suprathreshold Clusters for Brain Imaging</p></a></li>
<li><a href='#simData'><p>Simulating Matrix of Statistics</p></a></li>
<li><a href='#sumPvals'><p>True Discovery Guarantee for p-Value Combinations</p></a></li>
<li><a href='#sumStats'><p>True Discovery Guarantee for Generic Statistics</p></a></li>
<li><a href='#tdp'><p>Confidence Bound for the TDP</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Permutation True Discovery Guarantee by Sum-Based Tests</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-11-23</td>
</tr>
<tr>
<td>Author:</td>
<td>Anna Vesely</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Anna Vesely &lt;anna.vesely@phd.unipd.it&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>It allows to quickly perform permutation-based closed testing by sum-based global tests, and construct lower confidence bounds for the TDP, simultaneously over all subsets of hypotheses. As a main feature, it produces simultaneous lower confidence bounds for the proportion of active voxels in different clusters for fMRI cluster analysis. Details may be found in Vesely, Finos, and Goeman (2020) &lt;<a href="https://doi.org/10.48550/arXiv.2102.11759">doi:10.48550/arXiv.2102.11759</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0.5), pARI, ARIbrain, RNifti</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/annavesely/sumSome/issues">https://github.com/annavesely/sumSome/issues</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/annavesely/sumSome">https://github.com/annavesely/sumSome</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-11-23 20:28:01 UTC; annav</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-11-24 08:10:11 UTC</td>
</tr>
</table>
<hr>
<h2 id='sumSome-package'>
True Discovery Guarantee by Sum-Based Tests
</h2><span id='topic+sumSome-package'></span><span id='topic+sumSome'></span>

<h3>Description</h3>

<p>It provides permutation-based true discovery guarantees, using sum-based global statistics 
(sum of t-scores, p-value combinations, etc.). As a main feature, it produces simultaneous lower confidence bounds
for the number of active voxels in different clusters for fMRI cluster analysis.
</p>


<h3>Author(s)</h3>

<p>Anna Vesely.
</p>
<p>Maintainer: Anna Vesely &lt;anna.vesely@phd.unipd.it&gt;
</p>


<h3>References</h3>

<p>Goeman, J. J., and Solari, A. (2011). Multiple testing for exploratory research. Statistical Science 26 (4) 584-597.
</p>
<p>Vesely, A., Finos, L., and Goeman, J. J. (2020). Permutation-based true discovery guarantee by sum tests. Pre-print arXiv:2102.11759.
</p>


<h3>See Also</h3>

<p>True discovery guarantee: <code><a href="#topic+sumStats">sumStats</a></code>, <code><a href="#topic+sumPvals">sumPvals</a></code>
</p>
<p>Permutation statistics for brain imaging: <code><a href="#topic+brainScores">brainScores</a></code>, <code><a href="#topic+brainPvals">brainPvals</a></code>
</p>
<p>True discovery guarantee for cluster analysis: <code><a href="#topic+clusterAnalysis">clusterAnalysis</a></code>
</p>

<hr>
<h2 id='brainPvals'>Permutation p-Values for Brain Imaging</h2><span id='topic+brainPvals'></span>

<h3>Description</h3>

<p>This function computes p-value combinations for different permutations of brain imaging data.
A voxel's p-value is calculated by performing the one-sample t test
for the null hypothesis that its mean contrast over the different subjects is zero.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>brainPvals(copes, mask = NULL, alternative = "two.sided", alpha = 0.05, B = 200, 
           seed = NULL, truncFrom = NULL, truncTo = 0.5,
           type = "vovk.wang", r = 0, rand = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="brainPvals_+3A_copes">copes</code></td>
<td>
<p>list of 3D numeric arrays (contrasts maps for each subject).</p>
</td></tr>
<tr><td><code id="brainPvals_+3A_mask">mask</code></td>
<td>
<p>3D logical array, where <code>TRUE</code> values correspond to voxels inside the brain, or character for a Nifti file name.</p>
</td></tr>
<tr><td><code id="brainPvals_+3A_alternative">alternative</code></td>
<td>
<p>direction of the alternative hypothesis (<code>greater</code>, <code>lower</code>, <code>two.sided</code>).</p>
</td></tr>
<tr><td><code id="brainPvals_+3A_alpha">alpha</code></td>
<td>
<p>significance level.</p>
</td></tr>
<tr><td><code id="brainPvals_+3A_b">B</code></td>
<td>
<p>number of permutations, including the identity.</p>
</td></tr>
<tr><td><code id="brainPvals_+3A_seed">seed</code></td>
<td>
<p>seed.</p>
</td></tr>
<tr><td><code id="brainPvals_+3A_truncfrom">truncFrom</code></td>
<td>
<p>truncation parameter: values greater than <code>truncFrom</code> are truncated.
If <code>NULL</code>, it is set to <code>alpha</code>.</p>
</td></tr>
<tr><td><code id="brainPvals_+3A_truncto">truncTo</code></td>
<td>
<p>truncation parameter: truncated values are set to <code>truncTo</code>.
If <code>NULL</code>, p-values are not truncated.</p>
</td></tr>
<tr><td><code id="brainPvals_+3A_type">type</code></td>
<td>
<p>p-value combination among <code>edgington</code>, <code>fisher</code>, <code>pearson</code>, <code>liptak</code>,
<code>cauchy</code>, <code>vovk.wang</code> (see details).</p>
</td></tr>
<tr><td><code id="brainPvals_+3A_r">r</code></td>
<td>
<p>parameter for Vovk and Wang's p-value combination.</p>
</td></tr>
<tr><td><code id="brainPvals_+3A_rand">rand</code></td>
<td>
<p>logical, <code>TRUE</code> to compute p-values by permutation distribution.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A p-value <code>p</code> is transformed as following.
</p>

<ul>
<li><p> Edgington: <code>-p</code>
</p>
</li>
<li><p> Fisher: <code>-log(p)</code>
</p>
</li>
<li><p> Pearson: <code>log(1-p)</code>
</p>
</li>
<li><p> Liptak: <code>-qnorm(p)</code>
</p>
</li>
<li><p> Cauchy: <code>tan(0.5 - p)/p</code>
</p>
</li>
<li><p> Vovk and Wang: <code>- sign(r)p^r</code>
</p>
</li></ul>

<p>An error message is returned if the transformation produces infinite values.
</p>
<p>Truncation parameters should be such that <code>truncTo</code> is not smaller than <code>truncFrom</code>.
As Pearson's and Liptak's transformations produce infinite values in 1, for such methods
<code>truncTo</code> should be strictly smaller than 1.
</p>
<p>The significance level <code>alpha</code> should be in the interval [1/<code>B</code>, 1).
</p>


<h3>Value</h3>

<p><code>brainPvals</code> returns an object of class <code>sumBrain</code>, containing
</p>

<ul>
<li> <p><code>statistics</code>: numeric matrix of p-values, where columns correspond to voxels inside the brain, and rows to permutations.
The first permutation is the identity
</p>
</li>
<li> <p><code>mask</code>: 3D logical array, where <code>TRUE</code> values correspond to voxels inside the brain
</p>
</li>
<li> <p><code>alpha</code>: significance level
</p>
</li>
<li> <p><code>truncFrom</code>: transformed first truncation parameter
</p>
</li>
<li> <p><code>truncTo</code>: transformed second truncation parameter
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Anna Vesely.
</p>


<h3>References</h3>

<p>Goeman, J. J. and Solari, A. (2011). Multiple testing for exploratory research. Statistical Science, 26(4):584-597.
</p>
<p>Hemerik, J. and Goeman, J. J. (2018). False discovery proportion estimation by permutations: confidence for significance analysis of microarrays. JRSS B, 80(1):137-155.
</p>
<p>Vesely, A., Finos, L., and Goeman, J. J. (2020). Permutation-based true discovery guarantee by sum tests. Pre-print arXiv:2102.11759.
</p>


<h3>See Also</h3>

<p>Permutation statistics for brain imaging using t scores: <code><a href="#topic+brainScores">brainScores</a></code>
</p>
<p>True discovery guarantee for cluster analysis: <code><a href="#topic+clusterAnalysis">clusterAnalysis</a></code>
</p>
<p>Suprathreshold clusters: <code><a href="#topic+findClusters">findClusters</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># simulate 20 copes with dimensions 10x10x10
set.seed(42)
copes &lt;- list()
for(i in seq(20)){copes[[i]] &lt;- array(rnorm(10^3, mean = -10, sd = 30), dim=c(10,10,10))}

# cluster map where t scores are grater than 2.8, in absolute value
thr &lt;- 2.8
cl &lt;- findClusters(copes = copes, thr = thr)

# create object of class sumBrain (combination: Cauchy)
res &lt;- brainPvals(copes = copes, alpha = 0.2, seed = 42, type = "cauchy")
res
summary(res)

# confidence bound for the number of true discoveries and the TDP within clusters
out &lt;- clusterAnalysis(res, clusters = cl$clusters)
</code></pre>

<hr>
<h2 id='brainScores'>Permutation t-Scores for Brain Imaging</h2><span id='topic+brainScores'></span>

<h3>Description</h3>

<p>This function computes t-scores for different permutations of brain imaging data.
A voxel's score is calculated by performing the one-sample t test
for the null hypothesis that its mean contrast over the different subjects is zero.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>brainScores(copes, mask = NULL, alternative = "two.sided", alpha = 0.05, B = 200,
            seed = NULL, truncFrom = 3.2, truncTo = 0, squares = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="brainScores_+3A_copes">copes</code></td>
<td>
<p>list of 3D numeric arrays (contrasts maps for each subject).</p>
</td></tr>
<tr><td><code id="brainScores_+3A_mask">mask</code></td>
<td>
<p>3D logical array, where <code>TRUE</code> values correspond to voxels inside the brain, or character for a Nifti file name.</p>
</td></tr>
<tr><td><code id="brainScores_+3A_alternative">alternative</code></td>
<td>
<p>direction of the alternative hypothesis (<code>greater</code>, <code>lower</code>, <code>two.sided</code>).</p>
</td></tr>
<tr><td><code id="brainScores_+3A_alpha">alpha</code></td>
<td>
<p>significance level.</p>
</td></tr>
<tr><td><code id="brainScores_+3A_b">B</code></td>
<td>
<p>number of permutations, including the identity.</p>
</td></tr>
<tr><td><code id="brainScores_+3A_seed">seed</code></td>
<td>
<p>seed.</p>
</td></tr>
<tr><td><code id="brainScores_+3A_truncfrom">truncFrom</code></td>
<td>
<p>truncation parameter: values less extreme than <code>truncFrom</code> are truncated.
If <code>NULL</code>, statistics are not truncated.</p>
</td></tr>
<tr><td><code id="brainScores_+3A_truncto">truncTo</code></td>
<td>
<p>truncation parameter: truncated values are set to <code>truncTo</code>.
If <code>NULL</code>, statistics are not truncated.</p>
</td></tr>
<tr><td><code id="brainScores_+3A_squares">squares</code></td>
<td>
<p>logical, <code>TRUE</code> to use squared t-scores.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Truncation parameters should be such that <code>truncTo</code> is not more extreme than <code>truncFrom</code>.
</p>
<p>The significance level <code>alpha</code> should be in the interval [1/<code>B</code>, 1).
</p>


<h3>Value</h3>

<p><code>brainScores</code> returns an object of class <code>sumBrain</code>, containing
</p>

<ul>
<li> <p><code>statistics</code>: numeric matrix of t-scores, where columns correspond to voxels inside the brain, and rows to permutations.
The first permutation is the identity
</p>
</li>
<li> <p><code>mask</code>: 3D logical array, where <code>TRUE</code> values correspond to voxels inside the brain
</p>
</li>
<li> <p><code>alpha</code>: significance level
</p>
</li>
<li> <p><code>truncFrom</code>: transformed first truncation parameter
</p>
</li>
<li> <p><code>truncTo</code>: transformed second truncation parameter
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Anna Vesely.
</p>


<h3>References</h3>

<p>Goeman, J. J. and Solari, A. (2011). Multiple testing for exploratory research. Statistical Science, 26(4):584-597.
</p>
<p>Hemerik, J. and Goeman, J. J. (2018). False discovery proportion estimation by permutations: confidence for significance analysis of microarrays. JRSS B, 80(1):137-155.
</p>
<p>Vesely, A., Finos, L., and Goeman, J. J. (2020). Permutation-based true discovery guarantee by sum tests. Pre-print arXiv:2102.11759.
</p>


<h3>See Also</h3>

<p>Permutation statistics for brain imaging using p-values: <code><a href="#topic+brainPvals">brainPvals</a></code>
</p>
<p>True discovery guarantee for cluster analysis: <code><a href="#topic+clusterAnalysis">clusterAnalysis</a></code>
</p>
<p>Suprathreshold clusters: <code><a href="#topic+findClusters">findClusters</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># simulate 20 copes with dimensions 10x10x10
set.seed(42)
copes &lt;- list()
for(i in seq(20)){copes[[i]] &lt;- array(rnorm(10^3, mean = -10, sd = 30), dim=c(10,10,10))}

# cluster map where t scores are grater than 2.8, in absolute value
thr &lt;- 2.8
cl &lt;- findClusters(copes = copes, thr = thr)

# create object of class sumBrain
res &lt;- brainScores(copes = copes, alpha = 0.2, seed = 42, truncFrom = thr)
res
summary(res)

# confidence bound for the number of true discoveries and the TDP within clusters
out &lt;- clusterAnalysis(res, clusters = cl$clusters)
</code></pre>

<hr>
<h2 id='clusterAnalysis'>True Discovery Guarantee for Cluster Analysis</h2><span id='topic+clusterAnalysis'></span>

<h3>Description</h3>

<p>This function determines a true discovery guarantee for fMRI cluster analysis.
It computes confidence bounds for the number of true discoveries and the true discovery proportion
within each cluster. The bounds are simultaneous over all sets, and remain valid under post-hoc selection.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clusterAnalysis(sumBrain, clusters, nMax = 50, silent = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clusterAnalysis_+3A_sumbrain">sumBrain</code></td>
<td>
<p>an object of class sumBrain, as returned by the functions <code><a href="#topic+brainScores">brainScores</a></code> and <code><a href="#topic+brainPvals">brainPvals</a></code>.</p>
</td></tr>
<tr><td><code id="clusterAnalysis_+3A_clusters">clusters</code></td>
<td>
<p>3D numeric array of cluster indices, or character for a Nifti file name.
If NULL, the whole brain is considered.</p>
</td></tr>
<tr><td><code id="clusterAnalysis_+3A_nmax">nMax</code></td>
<td>
<p>maximum number of iterations per cluster.</p>
</td></tr>
<tr><td><code id="clusterAnalysis_+3A_silent">silent</code></td>
<td>
<p>logical, <code>FALSE</code> to print the summary.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>clusterAnalysis</code> returns a list containing <code>summary</code> (matrix) and
<code>TDPmap</code> (3D numeric array of the true discovery proportions).
The matrix <code>summary</code> contains, for each cluster,
</p>

<ul>
<li> <p><code>size</code>: size
</p>
</li>
<li> <p><code>TD</code>: lower (1-<code>alpha</code>)-confidence bound for the number of true discoveries
</p>
</li>
<li> <p><code>maxTD</code>: maximum value of <code>TD</code> that could be found under convergence of the algorithm
</p>
</li>
<li> <p><code>TDP</code>: lower (1-<code>alpha</code>)-confidence bound for the true discovery proportion
</p>
</li>
<li> <p><code>maxTD</code>: maximum value of <code>TDP</code> that could be found under convergence of the algorithm
</p>
</li>
<li> <p><code>dim1</code>, <code>dim2</code>, <code>dim3</code>: coordinates of the center of mass.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Anna Vesely.
</p>


<h3>References</h3>

<p>Goeman, J. J. and Solari, A. (2011). Multiple testing for exploratory research. Statistical Science, 26(4):584-597.
</p>
<p>Hemerik, J. and Goeman, J. J. (2018). False discovery proportion estimation by permutations: confidence for significance analysis of microarrays. JRSS B, 80(1):137-155.
</p>
<p>Vesely, A., Finos, L., and Goeman, J. J. (2020). Permutation-based true discovery guarantee by sum tests. Pre-print arXiv:2102.11759.
</p>


<h3>See Also</h3>

<p>Permutation statistics for brain imaging: <code><a href="#topic+brainScores">brainScores</a></code>, <code><a href="#topic+brainPvals">brainPvals</a></code>
</p>
<p>Suprathreshold clusters: <code><a href="#topic+findClusters">findClusters</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># simulate 20 copes with dimensions 10x10x10
set.seed(42)
copes &lt;- list()
for(i in seq(20)){copes[[i]] &lt;- array(rnorm(10^3, mean = -10, sd = 30), dim=c(10,10,10))}

# cluster map where t scores are grater than 2.8, in absolute value
thr &lt;- 2.8
cl &lt;- findClusters(copes = copes, thr = thr)

# create object of class sumBrain
res &lt;- brainScores(copes = copes, alpha = 0.2, seed = 42, truncFrom = thr)
res
summary(res)

# confidence bound for the number of true discoveries and the TDP within clusters
out &lt;- clusterAnalysis(res, clusters = cl$clusters)
</code></pre>

<hr>
<h2 id='discoveries'>Confidence Bound for the Number of True Discoveries</h2><span id='topic+discoveries'></span><span id='topic+discoveries.sumObj'></span>

<h3>Description</h3>

<p>This function determines a lower confidence bound for the number of true discoveries
within a set of interest. The bound remains valid under post-hoc selection.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>discoveries(object)

## S3 method for class 'sumObj'
discoveries(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="discoveries_+3A_object">object</code></td>
<td>
<p>an object of class <code>sumObj</code>, as returned by
the functions <code><a href="#topic+sumStats">sumStats</a></code> and <code><a href="#topic+sumPvals">sumPvals</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>discoveries</code> returns a lower (1-<code>alpha</code>)-confidence bound
for the number of true discoveries in the set.
</p>


<h3>Author(s)</h3>

<p>Anna Vesely.
</p>


<h3>References</h3>

<p>Goeman, J. J. and Solari, A. (2011). Multiple testing for exploratory research. Statistical Science, 26(4):584-597.
</p>
<p>Hemerik, J. and Goeman, J. J. (2018). False discovery proportion estimation by permutations: confidence for significance analysis of microarrays. JRSS B, 80(1):137-155.
</p>
<p>Vesely, A., Finos, L., and Goeman, J. J. (2020). Permutation-based true discovery guarantee by sum tests. Pre-print arXiv:2102.11759.
</p>


<h3>See Also</h3>

<p>Create a <code>sumObj</code> object: <code><a href="#topic+sumStats">sumStats</a></code>, <code><a href="#topic+sumPvals">sumPvals</a></code>
</p>
<p>Lower confidence bound for the TDP: <code><a href="#topic+tdp">tdp</a></code>
</p>
<p>Upper confidence bound for the FDP: <code><a href="#topic+fdp">fdp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generate matrix of p-values for 5 variables and 10 permutations
G &lt;- simData(prop = 0.6, m = 5, B = 10, alpha = 0.4, seed = 42)

# subset of interest (variables 1 and 2)
S &lt;- c(1,2)
 
# create object of class sumObj
# combination: harmonic mean (Vovk and Wang with r = -1)
res &lt;- sumPvals(G, S, alpha = 0.4, r = -1)
res
summary(res)

# lower confidence bound for the number of true discoveries in S
discoveries(res)

# lower confidence bound for the true discovery proportion in S
tdp(res)

# upper confidence bound for the false discovery proportion in S
fdp(res)
</code></pre>

<hr>
<h2 id='fdp'>Confidence Bound for the FDP</h2><span id='topic+fdp'></span><span id='topic+fdp.sumObj'></span>

<h3>Description</h3>

<p>This function determines an upper confidence bound for the false discovery proportion
within a set of interest. The bound remains valid under post-hoc selection.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fdp(object)

## S3 method for class 'sumObj'
fdp(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fdp_+3A_object">object</code></td>
<td>
<p>an object of class <code>sumObj</code>, as returned by
the functions <code><a href="#topic+sumStats">sumStats</a></code> and <code><a href="#topic+sumPvals">sumPvals</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>fdp</code> returns an upper (1-<code>alpha</code>)-confidence bound
for the false discovery proportion in the set.
</p>


<h3>Author(s)</h3>

<p>Anna Vesely.
</p>


<h3>References</h3>

<p>Goeman, J. J. and Solari, A. (2011). Multiple testing for exploratory research. Statistical Science, 26(4):584-597.
</p>
<p>Hemerik, J. and Goeman, J. J. (2018). False discovery proportion estimation by permutations: confidence for significance analysis of microarrays. JRSS B, 80(1):137-155.
</p>
<p>Vesely, A., Finos, L., and Goeman, J. J. (2020). Permutation-based true discovery guarantee by sum tests. Pre-print arXiv:2102.11759.
</p>


<h3>See Also</h3>

<p>Create a <code>sumObj</code> object: <code><a href="#topic+sumStats">sumStats</a></code>, <code><a href="#topic+sumPvals">sumPvals</a></code>
</p>
<p>Lower confidence bound for the number of true discoveries: <code><a href="#topic+discoveries">discoveries</a></code>
</p>
<p>Lower confidence bound for the TDP: <code><a href="#topic+tdp">tdp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generate matrix of p-values for 5 variables and 10 permutations
G &lt;- simData(prop = 0.6, m = 5, B = 10, alpha = 0.4, seed = 42)

# subset of interest (variables 1 and 2)
S &lt;- c(1,2)
 
# create object of class sumObj
# combination: harmonic mean (Vovk and Wang with r = -1)
res &lt;- sumPvals(G, S, alpha = 0.4, r = -1)
res
summary(res)

# lower confidence bound for the number of true discoveries in S
discoveries(res)

# lower confidence bound for the true discovery proportion in S
tdp(res)

# upper confidence bound for the false discovery proportion in S
fdp(res)
</code></pre>

<hr>
<h2 id='findClusters'>Suprathreshold Clusters for Brain Imaging</h2><span id='topic+findClusters'></span>

<h3>Description</h3>

<p>This function determines spatially connected clusters, where t-scores are more extreme than a given threshold.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>findClusters(copes, mask = NULL, thr = 3.2, alternative = "two.sided", silent = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="findClusters_+3A_copes">copes</code></td>
<td>
<p>list of 3D numeric arrays (contrasts maps for each subject).</p>
</td></tr>
<tr><td><code id="findClusters_+3A_mask">mask</code></td>
<td>
<p>3D logical array, where <code>TRUE</code> values correspond to voxels inside the brain, or character for a Nifti file name.</p>
</td></tr>
<tr><td><code id="findClusters_+3A_thr">thr</code></td>
<td>
<p>threshold.</p>
</td></tr>
<tr><td><code id="findClusters_+3A_alternative">alternative</code></td>
<td>
<p>direction of the alternative hypothesis (<code>greater</code>, <code>lower</code>, <code>two.sided</code>).</p>
</td></tr>
<tr><td><code id="findClusters_+3A_silent">silent</code></td>
<td>
<p>logical, <code>FALSE</code> to print the number of clusters.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>findClusters</code> returns a 3D numeric array, with integer values corresponding to clusters,
and 0 to other voxels.
</p>


<h3>Author(s)</h3>

<p>Anna Vesely.
</p>


<h3>See Also</h3>

<p>Permutation statistics for brain imaging: <code><a href="#topic+brainScores">brainScores</a></code>, <code><a href="#topic+brainPvals">brainPvals</a></code>
</p>
<p>True discovery guarantee for cluster analysis: <code><a href="#topic+clusterAnalysis">clusterAnalysis</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># simulate 20 copes with dimensions 10x10x10
set.seed(42)
copes &lt;- list()
for(i in seq(20)){copes[[i]] &lt;- array(rnorm(10^3, mean = -10, sd = 30), dim=c(10,10,10))}

# cluster map where t scores are grater than 2.8, in absolute value
thr &lt;- 2.8
cl &lt;- findClusters(copes = copes, thr = thr)

# create object of class sumBrain
res &lt;- brainScores(copes = copes, alpha = 0.2, seed = 42, truncFrom = thr)
res
summary(res)

# confidence bound for the number of true discoveries and the TDP within clusters
out &lt;- clusterAnalysis(res, clusters = cl$clusters)
</code></pre>

<hr>
<h2 id='simData'>Simulating Matrix of Statistics</h2><span id='topic+simData'></span>

<h3>Description</h3>

<p>This function simulates a matrix of permutation statistics,
by performing a t test on normal data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simData(prop, m, B = 200, rho = 0, n = 50, alpha = 0.05, pw = 0.8, p = TRUE, seed = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simData_+3A_prop">prop</code></td>
<td>
<p>proportion of non-null hypotheses.</p>
</td></tr>
<tr><td><code id="simData_+3A_m">m</code></td>
<td>
<p>total number of variables.</p>
</td></tr>
<tr><td><code id="simData_+3A_b">B</code></td>
<td>
<p>number of permutations, including the identity.</p>
</td></tr>
<tr><td><code id="simData_+3A_rho">rho</code></td>
<td>
<p>level of equicorrelation between pairs of variables.</p>
</td></tr>
<tr><td><code id="simData_+3A_n">n</code></td>
<td>
<p>number of observations.</p>
</td></tr>
<tr><td><code id="simData_+3A_alpha">alpha</code></td>
<td>
<p>significance level.</p>
</td></tr>
<tr><td><code id="simData_+3A_pw">pw</code></td>
<td>
<p>power of the t test.</p>
</td></tr>
<tr><td><code id="simData_+3A_p">p</code></td>
<td>
<p>logical, <code>TRUE</code> to compute p-values, <code>FALSE</code> to compute t-scores.</p>
</td></tr>
<tr><td><code id="simData_+3A_seed">seed</code></td>
<td>
<p>seed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function applies the one-sample two-sided t test to a matrix of simulated data,
for <code>B</code> data permutations.
Data is obtained by simulating <code>n</code> independent observations from a multivariate normal distribution,
where a proportion <code>prop</code> of the variables has non-null mean.
This mean is such that the one-sample t test with significance level <code>alpha</code> has power equal to <code>pw</code>.
Each pair of distinct variables has equicorrelation <code>rho</code>.
</p>


<h3>Value</h3>

<p><code>simData</code> returns a matrix where the <code>B</code> rows correspond to permutations (the first is the identity),
and the <code>m</code> columns correspond to variables.
The matrix contains p-values if <code>p</code> is <code>TRUE</code>, and t-scores otherwise.
The first columns (a proportion <code>prop</code>) correspond to non-null hypotheses.
</p>


<h3>Author(s)</h3>

<p>Anna Vesely.
</p>


<h3>See Also</h3>

<p>True discovery guarantee: <code><a href="#topic+sumStats">sumStats</a></code>, <code><a href="#topic+sumPvals">sumPvals</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generate matrix of p-values for 5 variables and 10 permutations
G &lt;- simData(prop = 0.6, m = 5, B = 10, alpha = 0.4, seed = 42)

# subset of interest (variables 1 and 2)
S &lt;- c(1,2)
 
# create object of class sumObj
# combination: harmonic mean (Vovk and Wang with r = -1)
res &lt;- sumPvals(G, S, alpha = 0.4, r = -1)
res
summary(res)

# lower confidence bound for the number of true discoveries in S
discoveries(res)

# lower confidence bound for the true discovery proportion in S
tdp(res)

# upper confidence bound for the false discovery proportion in S
fdp(res)
</code></pre>

<hr>
<h2 id='sumPvals'>True Discovery Guarantee for p-Value Combinations</h2><span id='topic+sumPvals'></span>

<h3>Description</h3>

<p>This function determines confidence bounds for the number of true discoveries, the true discovery proportion
and the false discovery proportion within a set of interest, when using p-values as test statistics.
The bounds are simultaneous over all sets, and remain valid under post-hoc selection.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sumPvals(G, S = NULL, alpha = 0.05, truncFrom = NULL, truncTo = 0.5,
         type = "vovk.wang", r = 0, nMax = 50)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sumPvals_+3A_g">G</code></td>
<td>
<p>numeric matrix of p-values, where columns correspond to variables, and rows to data transformations (e.g. permutations).
The first transformation is the identity.</p>
</td></tr>
<tr><td><code id="sumPvals_+3A_s">S</code></td>
<td>
<p>vector of indices for the variables of interest (if not specified, all variables).</p>
</td></tr>
<tr><td><code id="sumPvals_+3A_alpha">alpha</code></td>
<td>
<p>significance level.</p>
</td></tr>
<tr><td><code id="sumPvals_+3A_truncfrom">truncFrom</code></td>
<td>
<p>truncation parameter: values greater than <code>truncFrom</code> are truncated.
If <code>NULL</code>, it is set to <code>alpha</code>.</p>
</td></tr>
<tr><td><code id="sumPvals_+3A_truncto">truncTo</code></td>
<td>
<p>truncation parameter: truncated values are set to <code>truncTo</code>.
If <code>NULL</code>, p-values are not truncated.</p>
</td></tr>
<tr><td><code id="sumPvals_+3A_type">type</code></td>
<td>
<p>p-value combination among <code>edgington</code>, <code>fisher</code>, <code>pearson</code>, <code>liptak</code>,
<code>cauchy</code>, <code>vovk.wang</code> (see details).</p>
</td></tr>
<tr><td><code id="sumPvals_+3A_r">r</code></td>
<td>
<p>parameter for Vovk and Wang's p-value combination.</p>
</td></tr>
<tr><td><code id="sumPvals_+3A_nmax">nMax</code></td>
<td>
<p>maximum number of iterations.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A p-value <code>p</code> is transformed as following.
</p>

<ul>
<li><p> Edgington: <code>-p</code>
</p>
</li>
<li><p> Fisher: <code>-log(p)</code>
</p>
</li>
<li><p> Pearson: <code>log(1-p)</code>
</p>
</li>
<li><p> Liptak: <code>-qnorm(p)</code>
</p>
</li>
<li><p> Cauchy: <code>tan(0.5 - p)/p</code>
</p>
</li>
<li><p> Vovk and Wang: <code>- sign(r)p^r</code>
</p>
</li></ul>

<p>An error message is returned if the transformation produces infinite values.
</p>
<p>Truncation parameters should be such that <code>truncTo</code> is not smaller than <code>truncFrom</code>.
As Pearson's and Liptak's transformations produce infinite values in 1, for such methods
<code>truncTo</code> should be strictly smaller than 1.
</p>
<p>The significance level <code>alpha</code> should be in the interval [1/<code>B</code>, 1), where
<code>B</code> is the number of data transformations (rows in <code>G</code>).
</p>


<h3>Value</h3>

<p><code>sumPvals</code> returns an object of class <code>sumObj</code>, containing
</p>

<ul>
<li> <p><code>total</code>: total number of variables (columns in <code>G</code>)
</p>
</li>
<li> <p><code>size</code>: size of <code>S</code>
</p>
</li>
<li> <p><code>alpha</code>: significance level
</p>
</li>
<li> <p><code>TD</code>: lower (1-<code>alpha</code>)-confidence bound for the number of true discoveries in <code>S</code>
</p>
</li>
<li> <p><code>maxTD</code>: maximum value of <code>TD</code> that could be found under convergence of the algorithm
</p>
</li>
<li> <p><code>iterations</code>: number of iterations of the algorithm
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Anna Vesely.
</p>


<h3>References</h3>

<p>Goeman, J. J. and Solari, A. (2011). Multiple testing for exploratory research. Statistical Science, 26(4):584-597.
</p>
<p>Hemerik, J. and Goeman, J. J. (2018). False discovery proportion estimation by permutations: confidence for significance analysis of microarrays. JRSS B, 80(1):137-155.
</p>
<p>Vesely, A., Finos, L., and Goeman, J. J. (2020). Permutation-based true discovery guarantee by sum tests. Pre-print arXiv:2102.11759.
</p>


<h3>See Also</h3>

<p>True discovery guarantee using generic statistics: <code><a href="#topic+sumStats">sumStats</a></code>
</p>
<p>Access a <code>sumObj</code> object: <code><a href="#topic+discoveries">discoveries</a></code>, <code><a href="#topic+tdp">tdp</a></code>, <code><a href="#topic+fdp">fdp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generate matrix of p-values for 5 variables and 10 permutations
G &lt;- simData(prop = 0.6, m = 5, B = 10, alpha = 0.4, seed = 42)

# subset of interest (variables 1 and 2)
S &lt;- c(1,2)
 
# create object of class sumObj
# combination: harmonic mean (Vovk and Wang with r = -1)
res &lt;- sumPvals(G, S, alpha = 0.4, r = -1)
res
summary(res)

# lower confidence bound for the number of true discoveries in S
discoveries(res)

# lower confidence bound for the true discovery proportion in S
tdp(res)

# upper confidence bound for the false discovery proportion in S
fdp(res)
</code></pre>

<hr>
<h2 id='sumStats'>True Discovery Guarantee for Generic Statistics</h2><span id='topic+sumStats'></span>

<h3>Description</h3>

<p>This function determines confidence bounds for the number of true discoveries, the true discovery proportion
and the false discovery proportion within a set of interest.
The bounds are simultaneous over all sets, and remain valid under post-hoc selection.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sumStats(G, S = NULL, alternative = "greater", alpha = 0.05,
         truncFrom = NULL, truncTo = NULL, nMax = 50)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sumStats_+3A_g">G</code></td>
<td>
<p>numeric matrix of statistics, where columns correspond to variables, and rows to data transformations (e.g. permutations).
The first transformation is the identity.</p>
</td></tr>
<tr><td><code id="sumStats_+3A_s">S</code></td>
<td>
<p>vector of indices for the variables of interest (if not specified, all variables).</p>
</td></tr>
<tr><td><code id="sumStats_+3A_alternative">alternative</code></td>
<td>
<p>direction of the alternative hypothesis (<code>greater</code>, <code>lower</code>, <code>two.sided</code>).</p>
</td></tr>
<tr><td><code id="sumStats_+3A_alpha">alpha</code></td>
<td>
<p>significance level.</p>
</td></tr>
<tr><td><code id="sumStats_+3A_truncfrom">truncFrom</code></td>
<td>
<p>truncation parameter: values less extreme than <code>truncFrom</code> are truncated.
If <code>NULL</code>, statistics are not truncated.</p>
</td></tr>
<tr><td><code id="sumStats_+3A_truncto">truncTo</code></td>
<td>
<p>truncation parameter: truncated values are set to <code>truncTo</code>.
If <code>NULL</code>, statistics are not truncated.</p>
</td></tr>
<tr><td><code id="sumStats_+3A_nmax">nMax</code></td>
<td>
<p>maximum number of iterations.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Truncation parameters should be such that <code>truncTo</code> is not more extreme than <code>truncFrom</code>.
</p>
<p>The significance level <code>alpha</code> should be in the interval [1/<code>B</code>, 1), where
<code>B</code> is the number of data transformations (rows in <code>G</code>).
</p>


<h3>Value</h3>

<p><code>sumStats</code> returns an object of class <code>sumObj</code>, containing
</p>

<ul>
<li> <p><code>total</code>: total number of variables (columns in <code>G</code>)
</p>
</li>
<li> <p><code>size</code>: size of <code>S</code>
</p>
</li>
<li> <p><code>alpha</code>: significance level
</p>
</li>
<li> <p><code>TD</code>: lower (1-<code>alpha</code>)-confidence bound for the number of true discoveries in <code>S</code>
</p>
</li>
<li> <p><code>maxTD</code>: maximum value of <code>TD</code> that could be found under convergence of the algorithm
</p>
</li>
<li> <p><code>iterations</code>: number of iterations of the algorithm
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Anna Vesely.
</p>


<h3>References</h3>

<p>Goeman, J. J. and Solari, A. (2011). Multiple testing for exploratory research. Statistical Science, 26(4):584-597.
</p>
<p>Hemerik, J. and Goeman, J. J. (2018). False discovery proportion estimation by permutations: confidence for significance analysis of microarrays. JRSS B, 80(1):137-155.
</p>
<p>Vesely, A., Finos, L., and Goeman, J. J. (2020). Permutation-based true discovery guarantee by sum tests. Pre-print arXiv:2102.11759.
</p>


<h3>See Also</h3>

<p>True discovery guarantee using p-values: <code><a href="#topic+sumPvals">sumPvals</a></code>
</p>
<p>Access a <code>sumObj</code> object: <code><a href="#topic+discoveries">discoveries</a></code>, <code><a href="#topic+tdp">tdp</a></code>, <code><a href="#topic+fdp">fdp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generate matrix of t-scores for 5 variables and 10 permutations
G &lt;- simData(prop = 0.6, m = 5, B = 10, alpha = 0.4, p = FALSE, seed = 42)
 
# subset of interest (variables 1 and 2)
S &lt;- c(1,2)
 
# create object of class sumObj
res &lt;- sumStats(G, S, alpha = 0.4, truncFrom = 0.7, truncTo = 0)
res
summary(res)

# lower confidence bound for the number of true discoveries in S
discoveries(res)

# lower confidence bound for the true discovery proportion in S
tdp(res)

# upper confidence bound for the false discovery proportion in S
fdp(res)
</code></pre>

<hr>
<h2 id='tdp'>Confidence Bound for the TDP</h2><span id='topic+tdp'></span><span id='topic+tdp.sumObj'></span>

<h3>Description</h3>

<p>This function determines a lower confidence bound for the true discovery proportion
within a set of interest. The bound remains valid under post-hoc selection.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tdp(object)

## S3 method for class 'sumObj'
tdp(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tdp_+3A_object">object</code></td>
<td>
<p>an object of class <code>sumObj</code>, as returned by
the functions <code><a href="#topic+sumStats">sumStats</a></code> and <code><a href="#topic+sumPvals">sumPvals</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>tdp</code> returns a lower (1-<code>alpha</code>)-confidence bound
for the true discovery proportion in the set.
</p>


<h3>Author(s)</h3>

<p>Anna Vesely.
</p>


<h3>References</h3>

<p>Goeman, J. J. and Solari, A. (2011). Multiple testing for exploratory research. Statistical Science, 26(4):584-597.
</p>
<p>Hemerik, J. and Goeman, J. J. (2018). False discovery proportion estimation by permutations: confidence for significance analysis of microarrays. JRSS B, 80(1):137-155.
</p>
<p>Vesely, A., Finos, L., and Goeman, J. J. (2020). Permutation-based true discovery guarantee by sum tests. Pre-print arXiv:2102.11759.
</p>


<h3>See Also</h3>

<p>Create a <code>sumObj</code> object: <code><a href="#topic+sumStats">sumStats</a></code>, <code><a href="#topic+sumPvals">sumPvals</a></code>
</p>
<p>Lower confidence bound for the number of true discoveries: <code><a href="#topic+discoveries">discoveries</a></code>
</p>
<p>Upper confidence bound for the FDP: <code><a href="#topic+fdp">fdp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generate matrix of p-values for 5 variables and 10 permutations
G &lt;- simData(prop = 0.6, m = 5, B = 10, alpha = 0.4, seed = 42)

# subset of interest (variables 1 and 2)
S &lt;- c(1,2)
 
# create object of class sumObj
# combination: harmonic mean (Vovk and Wang with r = -1)
res &lt;- sumPvals(G, S, alpha = 0.4, r = -1)
res
summary(res)

# lower confidence bound for the number of true discoveries in S
discoveries(res)

# lower confidence bound for the true discovery proportion in S
tdp(res)

# upper confidence bound for the false discovery proportion in S
fdp(res)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
