<!DOCTYPE html><html><head><title>Help for package rTG</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {rTG}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#data_dendrometers'><p>data_dendrometers</p></a></li>
<li><a href='#data_trees'><p>data_trees</p></a></li>
<li><a href='#double_gompertz'><p>double_gompertz</p></a></li>
<li><a href='#parameters'><p>parameters</p></a></li>
<li><a href='#XPSgrowth'><p>XPSgrowth</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Methods to Analyse Seasonal Radial Tree Growth Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.2</td>
</tr>
<tr>
<td>Author:</td>
<td>Jernej Jevsenak [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jernej Jevsenak &lt;jernej.jevsenak@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Methods for comparing different regression algorithms for 
    describing the temporal dynamics of secondary tree growth (xylem and 
    phloem). Users can compare the accuracy of the most common fitting methods 
    usually used to analyse xylem and phloem data, i.e., Gompertz function, 
    Double Gompertz function, General Additive Models (GAMs); and an algorithm 
    newly introduced to the field, i.e., Bayesian Regularised Neural Networks 
    (brnn). The core function of the package is XPSgrowth(), while the results 
    can be interpreted using implemented generic S3 methods, such as plot() and 
    summary().</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2(&ge; 2.2.0), mgcv (&ge; 1.8-34), knitr(&ge; 1.19), dplyr(&ge;
0.1.0), magrittr(&ge; 1.5), methods</td>
</tr>
<tr>
<td>Depends:</td>
<td>R(&ge; 3.5), brnn(&ge; 0.6), minpack.lm (&ge; 1.2-4)</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/jernejjevsenak/rTG">https://github.com/jernejjevsenak/rTG</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/jernejjevsenak/rTG/issues">https://github.com/jernejjevsenak/rTG/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-03 18:18:38 UTC; JernejJ</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-03 18:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='data_dendrometers'>data_dendrometers</h2><span id='topic+data_dendrometers'></span>

<h3>Description</h3>

<p>A data set with dendrometer data from sugar maple and black spruce from
Simoncouche site, Canada.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data_dendrometers
</code></pre>


<h3>Format</h3>

<p>A data frame with 718 rows and 6 variables:
</p>

<dl>
<dt>site</dt><dd><p>Simoncouche</p>
</dd>
<dt>species</dt><dd><p>sugar maple and black spruce</p>
</dd>
<dt>tree</dt><dd><p>tree identifier</p>
</dd>
<dt>year</dt><dd><p>2017, 2020</p>
</dd>
<dt>doy</dt><dd><p>day Of a Year</p>
</dd>
<dt>width</dt><dd><p>width expressed in relative terms</p>
</dd>
</dl>



<h3>Source</h3>

<p>Data belongs to Sergio Rossi
</p>

<hr>
<h2 id='data_trees'>data_trees</h2><span id='topic+data_trees'></span>

<h3>Description</h3>

<p>A dataset with intra-seasonal radial tree growth data. It was collected in
three different years, at three sites, each with six trees. Please see
references for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data_trees
</code></pre>


<h3>Format</h3>

<p>A data frame with 945 rows and 7 variables:
</p>

<dl>
<dt>Tissue</dt><dd><p>XYLEM or PHLOEM</p>
</dd>
<dt>Species</dt><dd><p>Fagus sylvatica (FASY), Picea abies (PIAB), Quercus pubescens (QUPE)</p>
</dd>
<dt>Site</dt><dd><p>Panska reka (PAN), Karst (KRAS)</p>
</dd>
<dt>Year</dt><dd><p>2011, 2017</p>
</dd>
<dt>Tree</dt><dd><p>Tree ID indicators ranging from 1 to 6</p>
</dd>
<dt>doy</dt><dd><p>Day Of a Year</p>
</dd>
<dt>width</dt><dd><p>The total number of radial cells / the total ring width</p>
</dd>
</dl>



<h3>Source</h3>

<p>Gričar, J., Prislan, P., De Luis, M., Gryc, V., Hacurová, J.,
Vavrčík, H., Čufar, K., 2015. Plasticity in variation of xylem and phloem
cell characteristics of Norway spruce under different local conditions.
Frontiers in plant science 6, 730.
Gričar, J., Zavadlav, S., Jyske, T., Lavrič, M., Laakso, T., Hafner, P.,
Eler, K., Vodnik, D., 2019. Effect of soil water availability on intra-annual
xylem and phloem formation and non-structural carbohydrate pools in stem of
Quercus pubescens. Tree Physiol. 39, 222-233.
Prislan, P., Gričar, J., Čufar, K., de Luis, M., Merela, M., Rossi, S., 2019.
Growing season and radial growth predicted for Fagus sylvatica under climate
change. Clim. Change 153, 181-197.
</p>

<hr>
<h2 id='double_gompertz'>double_gompertz</h2><span id='topic+double_gompertz'></span>

<h3>Description</h3>

<p>A method to fit the double Gompertz function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>double_gompertz(x, a1, b1, k1, a2, b2, k2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="double_gompertz_+3A_x">x</code></td>
<td>
<p>independent variable</p>
</td></tr>
<tr><td><code id="double_gompertz_+3A_a1">a1</code></td>
<td>
<p>parameter a1</p>
</td></tr>
<tr><td><code id="double_gompertz_+3A_b1">b1</code></td>
<td>
<p>parameter b1</p>
</td></tr>
<tr><td><code id="double_gompertz_+3A_k1">k1</code></td>
<td>
<p>parameter k1</p>
</td></tr>
<tr><td><code id="double_gompertz_+3A_a2">a2</code></td>
<td>
<p>parameter a2</p>
</td></tr>
<tr><td><code id="double_gompertz_+3A_b2">b2</code></td>
<td>
<p>parameter b2</p>
</td></tr>
<tr><td><code id="double_gompertz_+3A_k2">k2</code></td>
<td>
<p>parameter k2</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a nls object with the function fit
</p>

<hr>
<h2 id='parameters'>parameters</h2><span id='topic+parameters'></span>

<h3>Description</h3>

<p>data frame with model fitting parameters for different regression methods.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parameters
</code></pre>


<h3>Format</h3>

<p>A data frame with 79 rows and 2 variables:
</p>

<dl>
<dt>Tissue</dt><dd><p>XYLEM or PHLOEM</p>
</dd>
<dt>Species</dt><dd><p>Fagus sylvatica (FASY), Picea abies (PIAB), Quercus pubescens (QUPE)</p>
</dd>
<dt>Site</dt><dd><p>Panska reka (PAN), Karst (KRAS)</p>
</dd>
<dt>Year</dt><dd><p>2011, 2017</p>
</dd>
<dt>Tree</dt><dd><p>Tree ID indicators ranging from 1 to 6</p>
</dd>
<dt>gom_a</dt><dd><p>The initial value for the Gompertz parameter a</p>
</dd>
<dt>gom_b</dt><dd><p>The initial value for the Gompertz parameter b</p>
</dd>
<dt>gom_k</dt><dd><p>The initial value for the Gompertz parameter c</p>
</dd>
<dt>brnn_neurons</dt><dd><p>The number of neurons for BRNN method</p>
</dd>
<dt>gam_k</dt><dd><p>The k parameter value for GAM method</p>
</dd>
<dt>gam_sp</dt><dd><p>The sp parameter value for GAM method</p>
</dd>
</dl>


<hr>
<h2 id='XPSgrowth'>XPSgrowth</h2><span id='topic+XPSgrowth'></span>

<h3>Description</h3>

<p>XylemPhloemSeasonalGrowth: This Function fits and compares the selected
methods for modeling seasonal xylem and phloem data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>XPSgrowth(
  data_trees,
  parameters = NULL,
  search_initial_gom = FALSE,
  search_initial_double_gom = FALSE,
  fitting_method = c("gompertz", "GAM", "brnn"),
  ID_vars = NULL,
  fitted_save = FALSE,
  add_zeros = TRUE,
  add_zeros_before = "min",
  post_process = TRUE,
  unified_parameters = FALSE,
  gom_a = NA,
  gom_b = NA,
  gom_k = NA,
  d_gom_a1 = NA,
  d_gom_a2 = NA,
  d_gom_b1 = NA,
  d_gom_b2 = NA,
  d_gom_k1 = NA,
  d_gom_k2 = NA,
  brnn_neurons = NA,
  gam_k = NA,
  gam_sp = NA,
  gom_a_range = c(0, 3000, 500),
  gom_b_range = seq(0, 1000, 50),
  gom_k_range = seq(0, 500, 2),
  d_gom_a1_range = seq(0, 1, by = 0.001),
  d_gom_a2_range = seq(0, 5, by = 0.01),
  d_gom_b1_range = seq(0, 5, by = 0.001),
  d_gom_b2_range = seq(0, 10, by = 0.1),
  d_gom_k1_range = seq(0, 1, by = 0.001),
  d_gom_k2_range = seq(0, 1, by = 0.001)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="XPSgrowth_+3A_data_trees">data_trees</code></td>
<td>
<p>a data frame with ID variables and wood formation data with
columns doy and width</p>
</td></tr>
<tr><td><code id="XPSgrowth_+3A_parameters">parameters</code></td>
<td>
<p>a data frame with ID variables and initial parameter values
for the selected methods</p>
</td></tr>
<tr><td><code id="XPSgrowth_+3A_search_initial_gom">search_initial_gom</code></td>
<td>
<p>logical, should the algorithm to search initial
Gompertz parameters be applied? This argument also overwrites manually
defined Gompertz parameter values</p>
</td></tr>
<tr><td><code id="XPSgrowth_+3A_search_initial_double_gom">search_initial_double_gom</code></td>
<td>
<p>logical, should the algorithm to search
initial parameters for double Gompertz function be applied? This argument
also overwrites manually defined parameter values for double Gompertz</p>
</td></tr>
<tr><td><code id="XPSgrowth_+3A_fitting_method">fitting_method</code></td>
<td>
<p>vector of one or more methods to be compared:
&quot;gompertz&quot;, &quot;double_gompertz&quot;, &quot;gam&quot;, &quot;brnn&quot;</p>
</td></tr>
<tr><td><code id="XPSgrowth_+3A_id_vars">ID_vars</code></td>
<td>
<p>character vector of variables which indicate column names of
ID variables</p>
</td></tr>
<tr><td><code id="XPSgrowth_+3A_fitted_save">fitted_save</code></td>
<td>
<p>logical, should the fitted curves be saved in current
working directory?</p>
</td></tr>
<tr><td><code id="XPSgrowth_+3A_add_zeros">add_zeros</code></td>
<td>
<p>logical, should zero observations at the beginning of
growing season be added?</p>
</td></tr>
<tr><td><code id="XPSgrowth_+3A_add_zeros_before">add_zeros_before</code></td>
<td>
<p>if 'min' (character) then zeros will be added prior
to the first observation in each year. Alternatively, users can specify
absolute doy prior which zeros will be added.</p>
</td></tr>
<tr><td><code id="XPSgrowth_+3A_post_process">post_process</code></td>
<td>
<p>logical, should the post-process algorithm be applied?</p>
</td></tr>
<tr><td><code id="XPSgrowth_+3A_unified_parameters">unified_parameters</code></td>
<td>
<p>logical, if TRUE, the algorithm will use only
manually selected function parameters. See the arguments 'gom_a', 'gom_b',
'd_gom_k', 'd_gom_a1', 'd_gom_a2', 'd_gom_b1', 'd_gom_b2', 'd_gom_k1',
'd_gom_k2', 'brnn_neurons', 'gam_k' and 'gam_sp'. Default is FALSE</p>
</td></tr>
<tr><td><code id="XPSgrowth_+3A_gom_a">gom_a</code></td>
<td>
<p>numeric, the parameter a for the Gompertz function</p>
</td></tr>
<tr><td><code id="XPSgrowth_+3A_gom_b">gom_b</code></td>
<td>
<p>numeric, the parameter b for the Gompertz function</p>
</td></tr>
<tr><td><code id="XPSgrowth_+3A_gom_k">gom_k</code></td>
<td>
<p>numeric, the parameter k for the Gompertz function</p>
</td></tr>
<tr><td><code id="XPSgrowth_+3A_d_gom_a1">d_gom_a1</code></td>
<td>
<p>numeric, the parameter a1 for the double Gompertz function</p>
</td></tr>
<tr><td><code id="XPSgrowth_+3A_d_gom_a2">d_gom_a2</code></td>
<td>
<p>numeric, the parameter a2 for the double Gompertz function</p>
</td></tr>
<tr><td><code id="XPSgrowth_+3A_d_gom_b1">d_gom_b1</code></td>
<td>
<p>numeric, the parameter b1 for the double Gompertz function</p>
</td></tr>
<tr><td><code id="XPSgrowth_+3A_d_gom_b2">d_gom_b2</code></td>
<td>
<p>numeric, the parameter b2 for the double Gompertz function</p>
</td></tr>
<tr><td><code id="XPSgrowth_+3A_d_gom_k1">d_gom_k1</code></td>
<td>
<p>numeric, the parameter k1 for the double Gompertz function</p>
</td></tr>
<tr><td><code id="XPSgrowth_+3A_d_gom_k2">d_gom_k2</code></td>
<td>
<p>numeric, the parameter k2 for the double Gompertz function</p>
</td></tr>
<tr><td><code id="XPSgrowth_+3A_brnn_neurons">brnn_neurons</code></td>
<td>
<p>positive integer, the number of neurons to be used by
the BRNN method</p>
</td></tr>
<tr><td><code id="XPSgrowth_+3A_gam_k">gam_k</code></td>
<td>
<p>numeric, the parameter k for General Additive Model (GAM)</p>
</td></tr>
<tr><td><code id="XPSgrowth_+3A_gam_sp">gam_sp</code></td>
<td>
<p>numeric, the parameter sp for General Additive Model (GAM)</p>
</td></tr>
<tr><td><code id="XPSgrowth_+3A_gom_a_range">gom_a_range</code></td>
<td>
<p>a numerical vector of the possible values of the
parameter a, which is considered in the search for the initial Gompertz
parameter values</p>
</td></tr>
<tr><td><code id="XPSgrowth_+3A_gom_b_range">gom_b_range</code></td>
<td>
<p>a numerical vector of the possible values of the
parameter b, which is considered in the search for the initial Gompertz
parameter values</p>
</td></tr>
<tr><td><code id="XPSgrowth_+3A_gom_k_range">gom_k_range</code></td>
<td>
<p>a numerical vector of the possible values of the
parameter k, which is considered in the search for the initial Gompertz
parameter values</p>
</td></tr>
<tr><td><code id="XPSgrowth_+3A_d_gom_a1_range">d_gom_a1_range</code></td>
<td>
<p>A numerical vector representing the range of potential
values for the 'a1' parameter within the double Gompertz function.</p>
</td></tr>
<tr><td><code id="XPSgrowth_+3A_d_gom_a2_range">d_gom_a2_range</code></td>
<td>
<p>A numerical vector representing the range of potential
values for the 'a2' parameter within the double Gompertz function.</p>
</td></tr>
<tr><td><code id="XPSgrowth_+3A_d_gom_b1_range">d_gom_b1_range</code></td>
<td>
<p>A numerical vector representing the range of potential
values for the 'b1' parameter within the double Gompertz function.</p>
</td></tr>
<tr><td><code id="XPSgrowth_+3A_d_gom_b2_range">d_gom_b2_range</code></td>
<td>
<p>A numerical vector representing the range of potential
values for the 'b2' parameter within the double Gompertz function.</p>
</td></tr>
<tr><td><code id="XPSgrowth_+3A_d_gom_k1_range">d_gom_k1_range</code></td>
<td>
<p>A numerical vector representing the range of potential
values for the 'k1' parameter within the double Gompertz function.</p>
</td></tr>
<tr><td><code id="XPSgrowth_+3A_d_gom_k2_range">d_gom_k2_range</code></td>
<td>
<p>A numerical vector representing the range of potential
values for the 'k2' parameter within the double Gompertz function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with the following elements:
</p>

<ol>
<li><p> $fitted - a data frame with fitted wood formation data
</p>
</li>
<li><p> $gompertz_grid_search - a data frame that contains a curated selection of initial parameter values for the Gompertz function.
</p>
</li>
<li><p> $gompertz_grid_search_errors - a data frame with unsuccessful cases of Gompertz grid search
</p>
</li>
<li><p> $double_gompertz_grid_search - a data frame that contains a curated selection of initial parameter values for the double Gompertz function.
</p>
</li>
<li><p> $double_gompertz_grid_search_errors - a data frame with unsuccessful cases of double Gompertz grid search
</p>
</li></ol>



<h3>Examples</h3>

<pre><code class='language-R'>library(rTG)

# 1 Example on xylem and phloem data
data(parameters)
data(data_trees)
data_trees &lt;- data_trees[c(1:27),]

# 1a Example using neural network
simulation_1a &lt;- XPSgrowth(data_trees = data_trees,
     parameters = parameters,
     ID_vars = c("Species", "Tissue", "Site", "Year", "Tree"),
     fitting_method = c("brnn"),
     fitted_save = FALSE,
     search_initial_gom = FALSE,
     add_zeros = TRUE,
     add_zeros_before = 'min',
     post_process = TRUE)

## Not run: 
#' # 1b Example on Double Gompertz function
simulation_1b &lt;- XPSgrowth(data_trees = data_trees,
     parameters = parameters,
     ID_vars = c("Species", "Tissue", "Site", "Year"),
     fitting_method = c("double_gompertz"),
     fitted_save = FALSE,
     search_initial_double_gom = FALSE,
     unified_parameters = TRUE,
     add_zeros = TRUE,
     add_zeros_before = 'min',
     d_gom_a1 = 0.204, d_gom_a2 = 0.240,
     d_gom_b1 = 2.433, d_gom_b2 = 2.900,
     d_gom_k1 = 0.974, d_gom_k2 = 0.963,
     post_process = TRUE)

## End(Not run)

# 2 Example on dendrometer data
data("data_dendrometers")

simulation_2 &lt;- XPSgrowth(data_dendrometers, unified_parameters = TRUE,
                  ID_vars = c("site", "species", "year", "tree"),
                  fitting_method = c("brnn", "gam"),
                  brnn_neurons = 2, gam_k = 9, gam_sp = 0.5,
                  search_initial_gom = TRUE, add_zeros = FALSE,
                  post_process = TRUE)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
