<!DOCTYPE html><html><head><title>Help for package OrthoPanels</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {OrthoPanels}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#OrthoPanels-package'><p>OrthoPanels: Orthogonalized Panel Model</p></a></li>
<li><a href='#abond_panel'><p>UK Company Data Panel</p></a></li>
<li><a href='#BES_panel'><p>Responses from the 2010 British Election Study</p></a></li>
<li><a href='#caterplot'><p>Caterpillar Plots of <code>opm</code> Model Parameters</p></a></li>
<li><a href='#caterplot_longRun'><p>Caterpillar Plots of long run effects based on <code>opm</code> Model Parameters</p></a></li>
<li><a href='#confint.opm'><p>Credible Intervals for Model Parameters</p></a></li>
<li><a href='#DIC'><p>Deviance Information Criterion (DIC)</p></a></li>
<li><a href='#hist.opm'><p>Histogram of an <code>opm</code> Object</p></a></li>
<li><a href='#longRunEffects'><p>Long run effects based on the <code>opm</code> Model Parameters</p></a></li>
<li><a href='#opm'><p>Fitting orthogonal panel models</p></a></li>
<li><a href='#p_rho'><p>Returns the posterior density <code class="reqn">p(\rho|\Theta)</code></p></a></li>
<li><a href='#plot.opm'><p>Plot Method for an <code>opm</code> Object</p></a></li>
<li><a href='#quantile.opm'><p>Posterior Sample Quantiles</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Dynamic Panel Models with Orthogonal Reparameterization of Fixed
Effects</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2-4</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements the orthogonal reparameterization
    approach recommended by Lancaster (2002) to estimate dynamic panel
    models with fixed effects (and optionally: panel specific
    intercepts). The approach uses a likelihood-based estimator and
    produces estimates that are asymptotically unbiased as N goes to
    infinity, with a T as low as 2.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, knitr, rmarkdown</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Mark Pickup &lt;mark.pickup@sfu.ca&gt;</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-06-08 23:23:30 UTC; b.stojkova</td>
</tr>
<tr>
<td>Author:</td>
<td>Davor Cubranic [aut],
  Mark Pickup [aut, cre],
  Paul Gustafson [aut],
  Geoffrey Evans [aut],
  Jonoska Stojkova Biljana [ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-06-09 05:20:01 UTC</td>
</tr>
</table>
<hr>
<h2 id='OrthoPanels-package'>OrthoPanels: Orthogonalized Panel Model</h2><span id='topic+OrthoPanels-package'></span>

<h3>Description</h3>

<p>This package includes the function <code>opm()</code>, which implements the
orthogonal reparameterization approach recommended by Lancaster
(2002) to estimate dynamic panel models with fixed effects (and
optionally: panel specific intercepts). The OLS estimator for such
models is biased with a fixed (small) <code class="reqn">N</code> (Nickell 1981). Equivalently,
a maximum likelihood estimation leads to an incidental parameters
problem (Neyman and Scott 1948; Lancaster 2000). The approach by
Lancaster (2002) uses an orthogonal reparameterization of the fixed
effects to produce a likelihood-based estimator of the remaining
parameters that is exact and consistent as <code class="reqn">N</code> approaches infinity
for <code class="reqn">T</code> greater than or equal to 2.
</p>


<h3>Details</h3>

<p>Orthopanels can accomodate unbalanced panel data, in that some
respondents may drop out early (attrition) and some respondents may
enter the panel late (refreshment). It is assumed that once
respondents enter the panel, they will have observations up until
they dropout and then NAs in subsequent waves. The estimation is
conducted under the assumption that the data is missing at random
</p>


<h3>References</h3>

<p>Lancaster, T. (2000) The incidental parameter problem since 1948.
<em>Journal of Econometrics</em>, <b>95</b>, 391&ndash;413.
</p>
<p>Lancaster, T. (2002) Orthogonal parameters and panel data.
<em>Review of Economic Studies</em>, <b>69</b>, 647&ndash;666.
</p>
<p>Neyman, J. and Scott, E. L. (1948) Consistent estimation from
partially consistent observations. <em>Econometrica</em>, <b>16</b>,
1&ndash;32.
</p>
<p>Nickell, S. (1981) Biases in dynamic models with fixed effects.
<em>Econometrica</em>, <b>49</b>, 1417&ndash;1426.
</p>

<hr>
<h2 id='abond_panel'>UK Company Data Panel</h2><span id='topic+abond_panel'></span>

<h3>Description</h3>

<p>The dynamics of labour demand of firm <code class="reqn">id</code> in the United Kingdom
in year <code class="reqn">year</code> as a function of real product wages, gross capital
stock and industry output. This is done using the data used by
Arellano and Bond (1991).
</p>


<h3>Format</h3>

<p>A data frame with 813 rows and 16 variables
</p>


<h3>Details</h3>

<p>A survey of 1845 respondents using 3 waves of panel survey data
from the 2010 British Election Study. The variables are as follows:
</p>

<ul>
<li><p> id case number
</p>
</li>
<li><p> year time wave
</p>
</li>
<li><p> n log of employment in firm <code>id</code> at time <code>year</code>
</p>
</li>
<li><p> w natural log of the real product wage
</p>
</li>
<li><p> k natural log of gross capital stock
</p>
</li>
<li><p> ys natural log of industry output
</p>
</li>
<li><p> l_w lag of <code>w</code>
</p>
</li>
<li><p> l_k lag of <code>k</code>
</p>
</li>
<li><p> l2_k two-step lag of <code>k</code>
</p>
</li>
<li><p> l_ys lag of <code>ys</code>
</p>
</li>
<li><p> l2_ys two-step lag of <code>ys</code>
</p>
</li>
<li><p> yr1980..yr1984 time dummies
</p>
</li></ul>



<h3>References</h3>

<p>Arrelano M., and Bond S. (1991) Some Tests of Specification for
Panel Data: Monte Carlo Evidence and an Application to Employment
Equations. <em>Review of Economic Studies</em>, <b>58(2)</b>,
277&ndash;297.
</p>

<hr>
<h2 id='BES_panel'>Responses from the 2010 British Election Study</h2><span id='topic+BES_panel'></span>

<h3>Description</h3>

<p>A survey of 1845 respondents using 3 waves of panel survey data
from the 2010 British Election Study. The variables are as follows:
</p>


<h3>Format</h3>

<p>A data frame with 5535 rows and 11 variables
</p>


<h3>Details</h3>


<ul>
<li><p> n case number
</p>
</li>
<li><p> t time wave
</p>
</li>
<li><p> Econ Assessment of change in the national economic situation over the past 12 months
(1-5, 1=&lsquo;got a lot worse&rsquo;, 5=&lsquo;got a lot better&rsquo;)
</p>
</li>
<li><p> Clegg Evaluation of Liberal Party leader Nick Clegg
(0-10, 0=&lsquo;strongly dislike&rsquo; and 10=&lsquo;strongly like&rsquo;)
</p>
</li>
<li><p> Brown Evaluation of Labour Party leader Gordon Brown
</p>
</li>
<li><p> Cameron Evaluation of Conservative Party leader David Cameron
</p>
</li>
<li><p> Approve Approval of the government, as expressed by feeling about the ruling Labour Party
(0-10, 0=&lsquo;strongly dislike&rsquo;, 10=&lsquo;strongly like&rsquo;)
</p>
</li>
<li><p> NHS Assesment of the current government's handling of the National Health
Service (1-5, 1=&lsquo;very badly&rsquo;, 5=&lsquo;very well&rsquo;)
</p>
</li>
<li><p> Terror Assesment of the current government's handling of terrorism
(1-5, 1=&lsquo;very badly&rsquo;, 5=&lsquo;very well&rsquo;)
</p>
</li>
<li><p> PID Personal identification with the Labour Party
(0/1, 0=&lsquo;no&rsquo;, 1=&lsquo;yes&rsquo;)
</p>
</li>
<li><p> Tax Preference for policy on taxes and health and social spending
(0-10, 0=&lsquo;cut taxes a lot and spend much less&rsquo;,
10=&lsquo;increase taxes a lot and spend much more&rsquo;)
</p>
</li></ul>


<hr>
<h2 id='caterplot'>Caterpillar Plots of <code>opm</code> Model Parameters</h2><span id='topic+caterplot'></span>

<h3>Description</h3>

<p>Creates side-by-side plots of equal-tailed credible intervals of <code>opm</code>
model parameters. The intervals are displayed as horizontal lines,
with 90% interval using a thicker line width and 95% interval a
thinner one. The posterior median is indicated with a dot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>caterplot(
  x,
  parm,
  main = paste("Caterpillar plot of", xname),
  xlab = "Range of parameter samples",
  labels = colnames(ranges)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="caterplot_+3A_x">x</code></td>
<td>
<p>an instance of class <code>opm</code></p>
</td></tr>
<tr><td><code id="caterplot_+3A_parm">parm</code></td>
<td>
<p>a specification of which parameters are to be plotted,
either a vector of names (&quot;<code>rho</code>&quot;, &quot;<code>sig2</code>&quot;
and &quot;<code>beta</code>&quot; are the only legal values) or a vector of positional
indices. If missing, all parameters are considered.</p>
</td></tr>
<tr><td><code id="caterplot_+3A_main">main</code>, <code id="caterplot_+3A_xlab">xlab</code></td>
<td>
<p>useful defaults for the plot title and X-axis label</p>
</td></tr>
<tr><td><code id="caterplot_+3A_labels">labels</code></td>
<td>
<p>labels for each parameter's interval: see <code><a href="graphics.html#topic+axis">axis</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of 2.5%, 5%, 50%, 95%, and 97.5% quantiles for
each of the desired parameters, with parameters arranged in
columns.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
caterplot(o, main = NULL, labels = expression(alpha, beta, sigma^2))

## End(Not run)

</code></pre>

<hr>
<h2 id='caterplot_longRun'>Caterpillar Plots of long run effects based on <code>opm</code> Model Parameters</h2><span id='topic+caterplot_longRun'></span>

<h3>Description</h3>

<p>Creates side-by-side plots of equal-tailed credible intervals of <code>opm</code>
the long run effects parameters. The intervals are displayed as horizontal lines,
with 90% interval using a thicker line width and 95% interval a
thinner one. The posterior median is indicated with a dot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>caterplot_longRun(
  x,
  parm = NULL,
  main = "Caterpillar plot of long run effects",
  xlab = "Range of parameter samples",
  probs = c(0.025, 0.05, 0.5, 0.95, 0.975),
  labels = colnames(ranges)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="caterplot_longRun_+3A_x">x</code></td>
<td>
<p>an instance of class <code>opm</code></p>
</td></tr>
<tr><td><code id="caterplot_longRun_+3A_parm">parm</code></td>
<td>
<p>a specification of which parameters are to be plotted,
a vector of names are the only legal values. If missing, all parameters are considered.</p>
</td></tr>
<tr><td><code id="caterplot_longRun_+3A_main">main</code>, <code id="caterplot_longRun_+3A_xlab">xlab</code></td>
<td>
<p>useful defaults for the plot title and X-axis label</p>
</td></tr>
<tr><td><code id="caterplot_longRun_+3A_probs">probs</code></td>
<td>
<p>a vector specifying the quantiles, the defaults is 2.5%, 5%, 50%, 95%, and 97.5% quantiles</p>
</td></tr>
<tr><td><code id="caterplot_longRun_+3A_labels">labels</code></td>
<td>
<p>labels for each parameter's interval: see <code><a href="graphics.html#topic+axis">axis</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of 2.5%, 5%, 50%, 95%, and 97.5% quantiles for
each of the desired parameters, with model parameters arranged in
columns.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
caterplot_longRun(o, main = NULL)

## End(Not run)

</code></pre>

<hr>
<h2 id='confint.opm'>Credible Intervals for Model Parameters</h2><span id='topic+confint.opm'></span>

<h3>Description</h3>

<p>Computes equal-tailed credible intervals for one or more parameters
in a fitted <code>opm</code> model. The method used is the quantile
interval of the posterior sample.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'opm'
confint(object, parm, level = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="confint.opm_+3A_object">object</code></td>
<td>
<p>an instance of class <code>opm</code> whose credible
intervals are wanted</p>
</td></tr>
<tr><td><code id="confint.opm_+3A_parm">parm</code></td>
<td>
<p>a specification of which parameters are to be given
credible intervals, either a vector of names (&quot;<code>rho</code>&quot;, &quot;<code>sig2</code>&quot;,
and &quot;<code>beta</code>&quot; are the only legal values) or a vector
of positional indices. If missing, all parameters are
considered.</p>
</td></tr>
<tr><td><code id="confint.opm_+3A_level">level</code></td>
<td>
<p>the size of the interval (e.g., 0.95 for 95% C.I.)</p>
</td></tr>
<tr><td><code id="confint.opm_+3A_...">...</code></td>
<td>
<p>additional argument(s) for methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix with columns giving lower and upper limits of the
credible interval for each parameter. These will be labeled as (1 -
level/2) and 1 - (1 - level)/2 in % (by default, &quot;2.5%&quot; and
&quot;97.5%&quot;).
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+confint">confint</a></code>
</p>

<hr>
<h2 id='DIC'>Deviance Information Criterion (DIC)</h2><span id='topic+DIC'></span>

<h3>Description</h3>

<p>Computes the Deviance Information Criterion (DIC), which is a
generalization of the Akaike Information Criterion. Models with
smaller DIC are considered to fit better than models with larger
DIC.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DIC(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DIC_+3A_object">object</code></td>
<td>
<p>an instance of class <code>opm</code> whose DIC is wanted.</p>
</td></tr>
<tr><td><code id="DIC_+3A_...">...</code></td>
<td>
<p>further arguments passed to other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>DIC is defined as <code class="reqn">DIC = 2*\bar{D} - D_\theta</code>
where:
<code class="reqn">\bar{D} = -2 mean(log-likelihood at parameter samples)</code>
<code class="reqn">D_\theta = -2 * log(likelihood at expected value of parameters)</code>
</p>
<p>DIC is calculated as: <code>2 * (-2 * mean(log-likelihood at each element of parameter samples)) - (-2 * log(likelihood at mean parameter sample value))</code>
</p>


<h3>Value</h3>

<p>a numeric value with the corresponding DIC
</p>


<h3>Note</h3>

<p>Note the speed of computation of the DIC in proportional to
the number of sampled values of the parameters in the opm
object.
</p>

<hr>
<h2 id='hist.opm'>Histogram of an <code>opm</code> Object</h2><span id='topic+hist.opm'></span>

<h3>Description</h3>

<p>Method for <code><a href="graphics.html#topic+hist">hist</a></code> applied to <code><a href="#topic+opm">opm</a></code> objects.
Each parameter will be plotted in a separate figure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'opm'
hist(
  x,
  parm,
  ask = dev.interactive(),
  plot = TRUE,
  main = NULL,
  xlab = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hist.opm_+3A_x">x</code></td>
<td>
<p>an instance of class <code>opm</code></p>
</td></tr>
<tr><td><code id="hist.opm_+3A_parm">parm</code></td>
<td>
<p>a specification of which parameters are to be plotted,
either a vector of names (&quot;<code>rho</code>&quot;, &quot;<code>sig2</code>&quot;
and &quot;<code>beta</code>&quot; are the only legal values) or a vector of positional
indices. If missing, all parameters are considered.</p>
</td></tr>
<tr><td><code id="hist.opm_+3A_ask">ask</code></td>
<td>
<p>if &quot;<code>TRUE</code>&quot;, and the R session is interactive, the
user is asked to press a key before a new figure (i.e., histogram
of the next model parameter) is drawn.</p>
</td></tr>
<tr><td><code id="hist.opm_+3A_plot">plot</code></td>
<td>
<p>if &quot;<code>TRUE</code>&quot; (default), the resulting object of
class &quot;<code>histogram</code>&quot; is plotted by <code>plot.hist</code>.</p>
</td></tr>
<tr><td><code id="hist.opm_+3A_main">main</code>, <code id="hist.opm_+3A_xlab">xlab</code></td>
<td>
<p>(optional) vector of titles and X-axis labels
for <em>each</em> figure.</p>
</td></tr>
<tr><td><code id="hist.opm_+3A_...">...</code></td>
<td>
<p>further arguments passed to the <code><a href="graphics.html#topic+hist">hist</a></code>
function operating on the individual parameter's samples</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of objects of class &quot;<code>histogram</code>&quot;, one for each
requested model parameter. The elements are named after the
parameter.
</p>

<hr>
<h2 id='longRunEffects'>Long run effects based on the <code>opm</code> Model Parameters</h2><span id='topic+longRunEffects'></span>

<h3>Description</h3>

<p>Computes long run effects and confidence intervals of <code>opm</code> Model Parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>longRunEffects(opm_obj, parm = NULL, probs = c(0.025, 0.5, 0.975))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="longRunEffects_+3A_opm_obj">opm_obj</code></td>
<td>
<p>an instance of class <code>opm</code></p>
</td></tr>
<tr><td><code id="longRunEffects_+3A_parm">parm</code></td>
<td>
<p>a specification of which parameters are to be plotted,
a vector of names are the only legal values. If missing, all parameters are considered.</p>
</td></tr>
<tr><td><code id="longRunEffects_+3A_probs">probs</code></td>
<td>
<p>a vector of specified quantiles, by default, the c(0.025,0.5,0.975) are (&quot;<code>probs</code>&quot;)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix with quantiles on the rows, with number of rows specified as length of the <code>probs</code> vector for the specified quantiles, with covariates on the columns
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
longRunEffects(opm_obj)
longRunEffects(opm_obj,probs=c(0.975, 0.16, 0.5, 0.84, 0.025))

## End(Not run)

</code></pre>

<hr>
<h2 id='opm'>Fitting orthogonal panel models</h2><span id='topic+opm'></span><span id='topic+opm.default'></span><span id='topic+opm.formula'></span>

<h3>Description</h3>

<p><code>opm</code> is used to fit orthogonal panel models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>opm(x, ...)

## Default S3 method:
opm(x, y, n.samp, add.time.indicators = FALSE, ...)

## S3 method for class 'formula'
opm(x, data = environment(x), subset = NULL, index = 1:2, n.samp, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="opm_+3A_x">x</code></td>
<td>
<p>a formula (see description of parameter <code>formula</code>
below) or an array of dimension <code>time x variable x case</code> of terms.</p>
</td></tr>
<tr><td><code id="opm_+3A_...">...</code></td>
<td>
<p>further arguments passed to other methods.</p>
</td></tr>
<tr><td><code id="opm_+3A_y">y</code></td>
<td>
<p>a matrix of dimensions <code>time x case</code> of responses.</p>
</td></tr>
<tr><td><code id="opm_+3A_n.samp">n.samp</code></td>
<td>
<p>number of samples to use to estimate the parameters.</p>
</td></tr>
<tr><td><code id="opm_+3A_add.time.indicators">add.time.indicators</code></td>
<td>
<p>(logical) if <code>TRUE</code>, adds dummy
variables for time.</p>
</td></tr>
<tr><td><code id="opm_+3A_data">data</code></td>
<td>
<p>an optional data frame, list, or environment containing
the variables in the model. If not found in <code>data</code>, the
variables are taken from <code>environment(x)</code>, typically the
environment from which <code>opm</code> is called.</p>
</td></tr>
<tr><td><code id="opm_+3A_subset">subset</code></td>
<td>
<p>an optional vector specifying a subset of
observations to be used in the fitting process.</p>
</td></tr>
<tr><td><code id="opm_+3A_index">index</code></td>
<td>
<p>a two-element vector containing the index of the case
and time variables, respectively. Variable indices can be specifed
by name or position. This argument is ignored if the model is not
specified by the formula, because the index is implicit in the
organization of the terms and response arrays.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The model can be either specified symbolically with the formula
<code>response ~ term1 + term2 ...</code> or with the terms and response
given as a pair of 3- and 2-dimensional arrays, <code>x</code> and
<code>y</code> respectively. The arrays have to be in the format
<code>time x variable x case</code> for terms and <code>time x case</code> for
the response.
</p>
<p>The lagged dependent variable does not need to be included in the
formula or data, as it is included automatically.
</p>


<h3>Value</h3>

<p>An object of class <code>opm</code> with the following elements:
</p>

<dl>
<dt><code>samples</code></dt><dd><p>parameter samples used to estimate the model,
as a list with following elements:</p>
</dd>
</dl>

<dl>
<dt><code>rho</code></dt><dd><p>a vector of <code>n.samp</code> samples of <code class="reqn">\rho</code>.</p>
</dd>
<dt><code>v</code></dt><dd><p>a vector of <code>n.samp</code> samples of <code class="reqn">\frac{1}{\sigma^2}</code>.</p>
</dd>
<dt><code>beta</code></dt><dd><p>an <code>n.samp x variable</code> matrix of samples of <code class="reqn">\beta</code>.</p>
</dd>
</dl>

<dl>
<dt><code>call</code></dt><dd><p>the matched call</p>
</dd>
<dt><code>index</code></dt><dd><p>the index variables, when using the formula interface</p>
</dd>
<dt><code>time.indicators</code></dt><dd><p><code>TRUE</code> if dummy time variables are used (see Notes), <code>FALSE</code> otherwise</p>
</dd>
<dt><code>terms</code></dt><dd><p>the <code>terms</code> object used</p>
</dd>
</dl>

<p>The function <code>summary</code> (i.e., <code>summary.opm</code>) can be used
to obtain or print a summary of the results. The generic accessor
functions <code>coefficients</code>, <code>fitted.values</code>,
<code>residuals</code>, <code>logLik</code>, and <code>df.residual</code> can be used
to extract various useful features of the value returned by <code>opm</code>.
</p>


<h3>Note</h3>

<p>Dummy time variables exist as an additional column for each
wave of data, excluding the first and second wave (i.e., at
<code class="reqn">t=0</code> and <code class="reqn">t=1</code> using the terminology from Lancaster
(2000)). The new variables are named <code>tind.</code><code class="reqn">t</code>, where
<code class="reqn">t = 2, ...</code>, and appear as such as elements of the estimated
<code>beta</code> coefficient.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
N &lt;- 5
T &lt;- 2
beta &lt;- .5
rho &lt;- .5
v &lt;- 1

f &lt;- runif(N, -2, 2)
K &lt;- length(beta)
beta &lt;- matrix(beta, K, 1)

## $x_i = 0.75 f + N(0, 1)$:
x &lt;- array(.75*f, dim=c(N, K, (T+1))) + rnorm(N*K*(T+1))

## $y_{i,t} = \rho y_{i,t-1} + \beta x_{i,t} + f_i + N(0,1)$:
y &lt;- matrix(0, N, T+1)
for (t in seq_len(T+1)) {
    yy &lt;- if (t&gt;1) y[,t-1] else 0
    y[,t] &lt;- rho * yy + f  + x[,,t] %*% beta + rnorm(N, sd = sqrt(1/v))
}

d &lt;- data.frame(i = rep(seq(N), T+1),
                t = rep(seq(T+1), each = N),
                as.data.frame(matrix(aperm(x, c(1, 3, 2)), N*(T+1), K,
                                     dimnames = list(NULL, paste0('x', seq(K))))),
                y = c(y))
opm(y~x1, d, n.samp = 10)

</code></pre>

<hr>
<h2 id='p_rho'>Returns the posterior density <code class="reqn">p(\rho|\Theta)</code></h2><span id='topic+p_rho'></span>

<h3>Description</h3>

<p>Returns the posterior density <code class="reqn">p(\rho|\Theta)</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>p_rho(x, y, rho, log.p = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="p_rho_+3A_x">x</code></td>
<td>
<p>an array of dimension <code>time x variable x case</code> of terms.</p>
</td></tr>
<tr><td><code id="p_rho_+3A_y">y</code></td>
<td>
<p>a matrix of dimension <code>time x case</code> of responses.</p>
</td></tr>
<tr><td><code id="p_rho_+3A_rho">rho</code></td>
<td>
<p>vector of quantiles.</p>
</td></tr>
<tr><td><code id="p_rho_+3A_log.p">log.p</code></td>
<td>
<p>if <code>TRUE</code>, probabilities are given as <code>log(p)</code>.</p>
</td></tr>
</table>

<hr>
<h2 id='plot.opm'>Plot Method for an <code>opm</code> Object</h2><span id='topic+plot.opm'></span>

<h3>Description</h3>

<p>Method for <code><a href="base.html#topic+plot">plot</a></code> applied to <code><a href="#topic+opm">opm</a></code> objects.
Each parameter will be plotted as a density plot in a separate
figure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'opm'
plot(x, parm, ask = dev.interactive(), main = NULL, xlab = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.opm_+3A_x">x</code></td>
<td>
<p>an instance of class <code>opm</code></p>
</td></tr>
<tr><td><code id="plot.opm_+3A_parm">parm</code></td>
<td>
<p>a specification of which parameters are to be plotted,
either a vector of names (&quot;<code>rho</code>&quot;, &quot;<code>sig2</code>&quot;
and &quot;<code>beta</code>&quot; are the only legal values) or a vector of positional
indices. If missing, all parameters are considered.</p>
</td></tr>
<tr><td><code id="plot.opm_+3A_ask">ask</code></td>
<td>
<p>if &quot;<code>TRUE</code>&quot;, and the R session is interactive, the
user is asked to press a key before a new figure (i.e., histogram
of the next model parameter) is drawn.</p>
</td></tr>
<tr><td><code id="plot.opm_+3A_main">main</code>, <code id="plot.opm_+3A_xlab">xlab</code></td>
<td>
<p>(optional) vector of titles and X-axis labels
for <em>each</em> figure.</p>
</td></tr>
<tr><td><code id="plot.opm_+3A_...">...</code></td>
<td>
<p>further arguments passed to the <code><a href="base.html#topic+plot">plot</a></code>
function operating on the individual parameter's samples</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of objects of class &quot;<code>density</code>&quot;, one for each
requested model parameter. The elements are named after the
parameter.
</p>

<hr>
<h2 id='quantile.opm'>Posterior Sample Quantiles</h2><span id='topic+quantile.opm'></span>

<h3>Description</h3>

<p>Produces quantiles of the posterior samples corresponding to the
given probabilities. In other words, it is equivalent to computing
&quot;<code>quantile(x, ...)</code>&quot;, where &quot;<code>x</code>&quot; is the original Monte
Carlo sample of the parameter &quot;<code>parm</code>&quot;, as produced by
<code><a href="#topic+opm">opm</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'opm'
quantile(x, parm, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="quantile.opm_+3A_x">x</code></td>
<td>
<p>an instance of class <code>opm</code> whose sample quantiles are
wanted</p>
</td></tr>
<tr><td><code id="quantile.opm_+3A_parm">parm</code></td>
<td>
<p>a specification of which parameters are to be given
quantiles, either a vector of names (&quot;<code>rho</code>&quot;, &quot;<code>sig2</code>&quot;,
and &quot;<code>beta</code>&quot; are the only legal values) or a vector of positional
indices. If missing, all parameters are considered.</p>
</td></tr>
<tr><td><code id="quantile.opm_+3A_...">...</code></td>
<td>
<p>further arguments passed to the <code><a href="stats.html#topic+quantile">quantile</a></code>
function operating on the individual parameter's samples</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of quantiles for each of the desired parameters,
with parameters arranged in columns. If arguments include
&quot;<code>names = FALSE</code>&quot;, the quantile labels won't be included
(i.e., the rownames of the matrix will be <code>NULL</code>).
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+quantile">quantile</a></code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
