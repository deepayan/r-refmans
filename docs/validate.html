<!DOCTYPE html><html><head><title>Help for package validate</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {validate}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#validate'><p>Data Validation Infrastructure</p></a></li>
<li><a href='#.PKGOPT'><p>Services for extending 'validate'</p></a></li>
<li><a href='#+5B+2Cexpressionset-method'><p>Select a subset</p></a></li>
<li><a href='#+5B+5B+26lt+3B-+2Cexpressionset-method'><p>Replace a rule in a ruleseta</p></a></li>
<li><a href='#+5B+26lt+3B-+2Cexpressionset-method'><p>Replace a subset of an expressionset with another expressionset</p></a></li>
<li><a href='#+25vin+25'><p>A consistent set membership operator</p></a></li>
<li><a href='#+2B+2Cindicator+2Cindicator-method'><p>Combine two indicator objects</p></a></li>
<li><a href='#+2B+2Cvalidator+2Cvalidator-method'><p>Combine two validator objects</p></a></li>
<li><a href='#add_indicators'><p>Add indicator values as columns to a data frame</p></a></li>
<li><a href='#aggregate+2Cvalidation-method'><p>Aggregate validation results</p></a></li>
<li><a href='#all+2Cvalidation-method'><p>Test if all validations resulted in TRUE</p></a></li>
<li><a href='#any+2Cvalidation-method'><p>Test if any validation resulted in TRUE</p></a></li>
<li><a href='#as.data.frame'><p>Coerce to <code>data.frame</code></p></a></li>
<li><a href='#as.data.frame+2CcellComparison-method'><p>Translate cellComparison objects to data frame</p></a></li>
<li><a href='#as.data.frame+2Cconfrontation-method'><p>Coerce a confrontation object to data frame</p></a></li>
<li><a href='#as.data.frame+2Cexpressionset-method'><p>Translate an expressionset to data.frame</p></a></li>
<li><a href='#as.data.frame+2CvalidatorComparison-method'><p>Translate a validatorComparison object to data frame</p></a></li>
<li><a href='#barplot+2CcellComparison-method'><p>Barplot of cellComparison object</p></a></li>
<li><a href='#barplot+2Cvalidation-method'><p>Plot number of violations</p></a></li>
<li><a href='#barplot+2CvalidatorComparison-method'><p>Barplot of validatorComparison object</p></a></li>
<li><a href='#cells'><p>Cell counts and differences for a series of datasets</p></a></li>
<li><a href='#check_that'><p>Simple data validation interface</p></a></li>
<li><a href='#compare'><p>Compare similar data sets</p></a></li>
<li><a href='#confront'><p>Confront data with a (set of) expressionset(s)</p></a></li>
<li><a href='#confrontation-class'><p>Superclass storing results of confronting data with rules</p></a></li>
<li><a href='#contains_exactly'><p>Check records using a predifined table of (im)possible values</p></a></li>
<li><a href='#created'><p>Creation timestamp</p></a></li>
<li><a href='#description'><p>Rule description</p></a></li>
<li><a href='#do_by'><p>split-apply-combine for vectors, with equal-length outptu</p></a></li>
<li><a href='#errors'><p>Get messages from  a confrontation object</p></a></li>
<li><a href='#event'><p>Get or set event information metadata from a 'confrontation' object.</p></a></li>
<li><a href='#exists_any'><p>Test for (unique) existence</p></a></li>
<li><a href='#export_yaml'><p>Export to yaml file</p></a></li>
<li><a href='#expr'><p>Get expressions</p></a></li>
<li><a href='#expressionset-class'><p>Superclass for storing a set of rich expressions.</p></a></li>
<li><a href='#field_format'><p>Check whether a field conforms to a regular expression</p></a></li>
<li><a href='#field_length'><p>Check number of code points</p></a></li>
<li><a href='#hb'><p>Hiridoglu-Berthelot function</p></a></li>
<li><a href='#hierarchy'><p>Check aggregates defined by a hierarchical code list</p></a></li>
<li><a href='#in_range'><p>Check variable range</p></a></li>
<li><a href='#indication-class'><p>Store results of evaluating indicators</p></a></li>
<li><a href='#indicator'><p>Define indicators for data</p></a></li>
<li><a href='#indicator-class'><p>Store a set of rich indicator expressions</p></a></li>
<li><a href='#is_complete'><p>Test for completeness of records</p></a></li>
<li><a href='#is_linear_sequence'><p>Check whether a variable represents a linear sequence</p></a></li>
<li><a href='#is_unique'><p>Test for uniquenes of records</p></a></li>
<li><a href='#keyset'><p>Get key set stored with a confrontation</p></a></li>
<li><a href='#label'><p>Rule label</p></a></li>
<li><a href='#lbj_cells-class'><p>Logging object to use with the lumberjack package</p></a></li>
<li><a href='#lbj_rules-class'><p>Logging object to use with the lumberjack package</p></a></li>
<li><a href='#length+2Cexpressionset-method'><p>Determine the number of elements in an object.</p></a></li>
<li><a href='#match_cells'><p>Create matching subsets of a sequence of data</p></a></li>
<li><a href='#meta'><p>Get or set rule metadata</p></a></li>
<li><a href='#nace_rev2'><p>NACE classification code table</p></a></li>
<li><a href='#names+26lt+3B-+2Crule+2Ccharacter-method'><p>Extract or set names</p></a></li>
<li><a href='#number_format'><p>Check the layouts of numbers.</p></a></li>
<li><a href='#origin'><p>Origin of rules</p></a></li>
<li><a href='#part_whole_relation'><p>Test whether details combine to a chosen aggregate</p></a></li>
<li><a href='#plot+2CcellComparison-method'><p>Line graph of a cellComparison object.</p></a></li>
<li><a href='#plot+2Cvalidation-method'><p>Plot validation results</p></a></li>
<li><a href='#plot+2Cvalidator-method'><p>Plot a validator object</p></a></li>
<li><a href='#plot+2CvalidatorComparison-method'><p>Line graph of validatorComparison object</p></a></li>
<li><a href='#retailers'><p>data on Dutch supermarkets</p></a></li>
<li><a href='#rule-class'><p>A rich expression</p></a></li>
<li><a href='#run_validation_file'><p>Run a file with confrontations. Capture results</p></a></li>
<li><a href='#rx'><p>Label objects for interpretation as pattern</p></a></li>
<li><a href='#samplonomy'><p>Economic data on Samplonia</p></a></li>
<li><a href='#satisfying'><p>Select records (not) satisfying rules</p></a></li>
<li><a href='#sdmx_codelist'><p>Get code list from an SDMX REST API endpoint.</p></a></li>
<li><a href='#sdmx_endpoint'><p>Get URL for known SDMX registry endpoints</p></a></li>
<li><a href='#sort+2Cvalidation-method'><p>Aggregate and sort the results of a validation.</p></a></li>
<li><a href='#summary'><p>Create a summary</p></a></li>
<li><a href='#syntax'><p>Syntax to define validation or indicator rules</p></a></li>
<li><a href='#validation-class'><p>Store results of evaluating validating expressions</p></a></li>
<li><a href='#validator'><p>Define validation rules for data</p></a></li>
<li><a href='#validator_from_dsd'><p>Extract a rule set from an SDMX DSD file</p></a></li>
<li><a href='#validator-class'><p>Store a set of rich validating rules.</p></a></li>
<li><a href='#values'><p>Get values from object</p></a></li>
<li><a href='#variables'><p>Get variable names</p></a></li>
<li><a href='#voptions'><p>Set or get options globally or per object.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Maintainer:</td>
<td>Mark van der Loo &lt;mark.vanderloo@gmail.com&gt;</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Title:</td>
<td>Data Validation Infrastructure</td>
</tr>
<tr>
<td>LazyData:</td>
<td>no</td>
</tr>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Description:</td>
<td>Declare data validation rules and data quality indicators;
        confront data with them and analyze or visualize the results.
        The package supports rules that are per-field, in-record,
        cross-record or cross-dataset. Rules can be automatically
        analyzed for rule type and connectivity. Supports checks implied
        by an SDMX DSD file as well. See also Van der Loo
        and De Jonge (2018) &lt;<a href="https://doi.org/10.1002%2F9781118897126">doi:10.1002/9781118897126</a>&gt;, Chapter 6
        and the JSS paper (2021) &lt;<a href="https://doi.org/10.18637%2Fjss.v097.i10">doi:10.18637/jss.v097.i10</a>&gt;.</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.5</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), methods</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/data-cleaning/validate">https://github.com/data-cleaning/validate</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/data-cleaning/validate/issues">https://github.com/data-cleaning/validate/issues</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, graphics, grid, settings, yaml</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rsdmx, tinytest (&ge; 0.9.6), knitr, bookdown, lumberjack,
rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Collate:</td>
<td>'rule.R' 'sugar.R' 'validate_pkg.R' 'parse.R'
'expressionset.R' 'indicator.R' 'validator.R' 'confrontation.R'
'compare.R' 'factory.R' 'genericrules.R' 'lumberjack.R'
'plot.R' 'retailers.R' 'run_validation.R' 'sdmx.R' 'syntax.R'
'utils.R' 'yaml.R'</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-13 12:49:37 UTC; mark</td>
</tr>
<tr>
<td>Author:</td>
<td>Mark van der Loo <a href="https://orcid.org/0000-0002-9807-4686"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [cre, aut],
  Edwin de Jonge <a href="https://orcid.org/0000-0002-6580-4718"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Paul Hsieh [ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-14 10:30:44 UTC</td>
</tr>
</table>
<hr>
<h2 id='validate'>Data Validation Infrastructure</h2><span id='topic+validate'></span><span id='topic+validate-package'></span><span id='topic+package-validate'></span>

<h3>Description</h3>

<p>Data often suffer from errors and missing values. A necessary step before data
analysis is verifying and validating your data. Package <code>validate</code> is a
toolbox for creating validation rules and checking data against these rules.
</p>


<h3>Getting started</h3>

<p>The easiest way to get started is through the examples given in <code><a href="#topic+check_that">check_that</a></code>. 
</p>
<p>The general workflow in <code>validate</code> follows the following pattern.
</p>

<ul>
<li><p> Define a set of rules or quality indicator using <code><a href="#topic+validator">validator</a></code> or <code><a href="#topic+indicator">indicator</a></code>. 
</p>
</li>
<li> <p><code><a href="#topic+confront">confront</a></code> data with the rules or indicators,
</p>
</li>
<li><p> Examine the results either graphically or by summary.
</p>
</li></ul>

<p>There are several convenience functions that allow one to define rules from
the commandline, through a (freeform or yaml) file and to investigate and
maintain the rules themselves. Please have a look at the
<a href="../doc/cookbook.html">cookbook</a> for a comprehensive introduction.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Mark van der Loo <a href="mailto:mark.vanderloo@gmail.com">mark.vanderloo@gmail.com</a> (<a href="https://orcid.org/0000-0002-9807-4686">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Edwin de Jonge (<a href="https://orcid.org/0000-0002-6580-4718">ORCID</a>)
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Paul Hsieh [contributor]
</p>
</li></ul>



<h3>References</h3>

<p>An overview of this package, its underlying ideas and many examples
can be found in MPJ van der Loo and E. de Jonge (2018) <em>Statistical
data cleaning with applications in R</em> John Wiley &amp; Sons.
</p>
<p>Please use <code>citation("validate")</code> to get a citation for (scientific)
publications.
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/data-cleaning/validate">https://github.com/data-cleaning/validate</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/data-cleaning/validate/issues">https://github.com/data-cleaning/validate/issues</a>
</p>
</li></ul>


<hr>
<h2 id='.PKGOPT'>Services for extending 'validate'</h2><span id='topic+.PKGOPT'></span><span id='topic+.ini_expressionset_cli'></span><span id='topic+.ini_expressionset_df'></span><span id='topic+.ini_expressionset_yml'></span><span id='topic+.show_expressionset'></span><span id='topic+.get_exprs'></span><span id='topic+.blocks_expressionset'></span>

<h3>Description</h3>

<p>Functions exported silently to allow for cross-package inheritance 
of the <code><a href="#topic+expressionset">expressionset</a></code> object. These functions are never
needed in scripts or statistical production code.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.PKGOPT(..., .__defaults = FALSE, .__reset = FALSE)

.ini_expressionset_cli(obj, ..., .prefix = "R")

.ini_expressionset_df(obj, dat, .prefix = "R")

.ini_expressionset_yml(obj, file, .prefix = "R")

.show_expressionset(obj)

.get_exprs(
  x,
  ...,
  expand_assignments = FALSE,
  expand_groups = TRUE,
  vectorize = TRUE,
  replace_dollar = TRUE,
  replace_in = TRUE,
  lin_eq_eps = x$options("lin.eq.eps"),
  lin_ineq_eps = x$options("lin.ineq.eps"),
  dat = NULL
)

.blocks_expressionset(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".PKGOPT_+3A_...">...</code></td>
<td>
<p>Comma-separated list of expressions</p>
</td></tr>
<tr><td><code id=".PKGOPT_+3A_.__defaults">.__defaults</code></td>
<td>
<p>toggle default options</p>
</td></tr>
<tr><td><code id=".PKGOPT_+3A_.__reset">.__reset</code></td>
<td>
<p>togle reset options</p>
</td></tr>
<tr><td><code id=".PKGOPT_+3A_obj">obj</code></td>
<td>
<p>an expressionset object</p>
</td></tr>
<tr><td><code id=".PKGOPT_+3A_.prefix">.prefix</code></td>
<td>
<p>Prefix to use in default names.</p>
</td></tr>
<tr><td><code id=".PKGOPT_+3A_dat">dat</code></td>
<td>
<p>Optionally, a <code>data.frame</code> containing the data to which the
expressions will be applied. When provided, the only equalities <code>A==B</code>
that will be translated to <code>abs(A-B)&lt;lin.eq.eps</code> are those where all 
occurring variables are numeric in <code>dat</code>.</p>
</td></tr>
<tr><td><code id=".PKGOPT_+3A_file">file</code></td>
<td>
<p>a filename</p>
</td></tr>
<tr><td><code id=".PKGOPT_+3A_x">x</code></td>
<td>
<p>An expressionset object</p>
</td></tr>
<tr><td><code id=".PKGOPT_+3A_expand_assignments">expand_assignments</code></td>
<td>
<p>Substitute assignments?</p>
</td></tr>
<tr><td><code id=".PKGOPT_+3A_expand_groups">expand_groups</code></td>
<td>
<p>Expand groups?</p>
</td></tr>
<tr><td><code id=".PKGOPT_+3A_vectorize">vectorize</code></td>
<td>
<p>Vectorize if-statements?</p>
</td></tr>
<tr><td><code id=".PKGOPT_+3A_replace_dollar">replace_dollar</code></td>
<td>
<p>Replace dollar with bracket index?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is aimed at developers importing the package and 
not at direct users of <span class="pkg">validate</span>.
</p>

<hr>
<h2 id='+5B+2Cexpressionset-method'>Select a subset</h2><span id='topic++5B+2Cexpressionset-method'></span><span id='topic++5B+5B+2Cexpressionset-method'></span><span id='topic++5B+2Cconfrontation-method'></span>

<h3>Description</h3>

<p>Select a subset
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'expressionset'
x[i, j, ..., drop = TRUE]

## S4 method for signature 'expressionset'
x[[i, j, ..., exact = TRUE]]

## S4 method for signature 'confrontation'
x[i, j, ..., drop = TRUE]
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="+2B5B+2B2Cexpressionset-method_+3A_x">x</code></td>
<td>
<p>An R object</p>
</td></tr>
<tr><td><code id="+2B5B+2B2Cexpressionset-method_+3A_i">i</code></td>
<td>
<p>an index (numeric, boolean, character)</p>
</td></tr>
<tr><td><code id="+2B5B+2B2Cexpressionset-method_+3A_j">j</code></td>
<td>
<p>not implemented</p>
</td></tr>
<tr><td><code id="+2B5B+2B2Cexpressionset-method_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to other methods</p>
</td></tr>
<tr><td><code id="+2B5B+2B2Cexpressionset-method_+3A_drop">drop</code></td>
<td>
<p>not implemented</p>
</td></tr>
<tr><td><code id="+2B5B+2B2Cexpressionset-method_+3A_exact">exact</code></td>
<td>
<p>Not implemented</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An new object, of the same class as <code>x</code> subsetted according to <code>i</code>.
</p>


<h3>Details</h3>

<p>The <code>options</code> attribute will be cloned
</p>


<h3>See Also</h3>

<p>Other confrontation-methods: 
<code><a href="#topic+as.data.frame+2Cconfrontation-method">as.data.frame,confrontation-method</a></code>,
<code><a href="#topic+confront">confront</a>()</code>,
<code><a href="#topic+confrontation-class">confrontation-class</a></code>,
<code><a href="#topic+errors">errors</a>()</code>,
<code><a href="#topic+event">event</a>()</code>,
<code><a href="#topic+keyset">keyset</a>()</code>,
<code><a href="#topic+length+2Cexpressionset-method">length,expressionset-method</a></code>,
<code><a href="#topic+values">values</a>()</code>
</p>

<hr>
<h2 id='+5B+5B+26lt+3B-+2Cexpressionset-method'>Replace a rule in a ruleseta</h2><span id='topic++5B+5B+3C-+2Cexpressionset-method'></span>

<h3>Description</h3>

<p>Replace a rule in a ruleseta
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 replacement method for signature 'expressionset'
x[[i]] &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="+2B5B+2B5B+2B26lt+2B3B-+2B2Cexpressionset-method_+3A_x">x</code></td>
<td>
<p>an R object</p>
</td></tr>
<tr><td><code id="+2B5B+2B5B+2B26lt+2B3B-+2B2Cexpressionset-method_+3A_i">i</code></td>
<td>
<p>index of length 1</p>
</td></tr>
<tr><td><code id="+2B5B+2B5B+2B26lt+2B3B-+2B2Cexpressionset-method_+3A_value">value</code></td>
<td>
<p>object of class <code><a href="#topic+rule">rule</a></code></p>
</td></tr>
</table>

<hr>
<h2 id='+5B+26lt+3B-+2Cexpressionset-method'>Replace a subset of an expressionset with another expressionset</h2><span id='topic++5B+3C-+2Cexpressionset-method'></span>

<h3>Description</h3>

<p>Replace a subset of an expressionset with another expressionset
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 replacement method for signature 'expressionset'
x[i] &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="+2B5B+2B26lt+2B3B-+2B2Cexpressionset-method_+3A_x">x</code></td>
<td>
<p>an R object inheriting from <code>expressionset</code></p>
</td></tr>
<tr><td><code id="+2B5B+2B26lt+2B3B-+2B2Cexpressionset-method_+3A_i">i</code></td>
<td>
<p>a <code>logical</code>, <code>character</code>, or <code>numeric</code> index</p>
</td></tr>
<tr><td><code id="+2B5B+2B26lt+2B3B-+2B2Cexpressionset-method_+3A_value">value</code></td>
<td>
<p>an R object of the same class as <code>x</code></p>
</td></tr>
</table>

<hr>
<h2 id='+25vin+25'>A consistent set membership operator</h2><span id='topic++25vin+25'></span>

<h3>Description</h3>

<p>A set membership operator like <code><a href="base.html#topic+match">%in%</a></code> that handles
<code>NA</code> more consistently with R's other logical comparison operators.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x %vin% table
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="+2B25vin+2B25_+3A_x">x</code></td>
<td>
<p>vector or <code>NULL</code>: the values to be matched</p>
</td></tr>
<tr><td><code id="+2B25vin+2B25_+3A_table">table</code></td>
<td>
<p>vector or <code>NULL</code>: the values to be matched against.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>R's basic comparison operators (almost) always return <code>NA</code> when one 
of the operands is <code>NA</code>. The <code>%in%</code> operator is an exception.
Compare for example <code>NA %in% NA</code> with <code>NA == NA</code>: the first
results in <code>TRUE</code>, while the latter results in <code>NA</code> as expected.
The <code>%vin%</code> operator acts consistent with operators such as <code>==</code>.
Specifically, <code>NA</code> results in the following cases.
</p>

<ul>
<li><p>For each position where <code>x</code> is <code>NA</code>, the result is <code>NA</code>.
</p>
</li>
<li><p>When <code>table</code> contains an <code>NA</code>, each non-matched value in 
<code>x</code> results in <code>NA</code>.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># we cannot be sure about the first element:
c(NA, "a") %vin% c("a","b")

# we cannot be sure about the 2nd and 3rd element (but note that they
# cannot both be TRUE):
c("a","b","c") %vin% c("a",NA)

# we can be sure about all elements:
c("a","b") %in% character(0)

</code></pre>

<hr>
<h2 id='+2B+2Cindicator+2Cindicator-method'>Combine two indicator objects</h2><span id='topic++2B+2Cindicator+2Cindicator-method'></span>

<h3>Description</h3>

<p>Combine two <code><a href="#topic+indicator">indicator</a></code> objects by addition. A new <code>indicator</code> 
object is created with default (global) option values. Previously set options
are ignored.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'indicator,indicator'
e1 + e2
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="+2B2B+2B2Cindicator+2B2Cindicator-method_+3A_e1">e1</code></td>
<td>
<p>a <code><a href="#topic+validator">validator</a></code></p>
</td></tr>
<tr><td><code id="+2B2B+2B2Cindicator+2B2Cindicator-method_+3A_e2">e2</code></td>
<td>
<p>a <code><a href="#topic+validator">validator</a></code></p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>indicator(mean(x)) + indicator(x/median(x))
</code></pre>

<hr>
<h2 id='+2B+2Cvalidator+2Cvalidator-method'>Combine two validator objects</h2><span id='topic++2B+2Cvalidator+2Cvalidator-method'></span>

<h3>Description</h3>

<p>Combine two <code><a href="#topic+validator">validator</a></code> objects by addition. A new <code>validator</code> 
object is created with default (global) option values. Previously set options
are ignored.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'validator,validator'
e1 + e2
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="+2B2B+2B2Cvalidator+2B2Cvalidator-method_+3A_e1">e1</code></td>
<td>
<p>a <code><a href="#topic+validator">validator</a></code></p>
</td></tr>
<tr><td><code id="+2B2B+2B2Cvalidator+2B2Cvalidator-method_+3A_e2">e2</code></td>
<td>
<p>a <code><a href="#topic+validator">validator</a></code></p>
</td></tr>
</table>


<h3>Note</h3>

<p>The <code>names</code> of the resulting object are made unique using <code><a href="base.html#topic+make.names">make.names</a></code>.
</p>


<h3>See Also</h3>

<p>Other validator-methods: 
<code><a href="#topic+plot+2Cvalidator-method">plot,validator-method</a></code>,
<code><a href="#topic+validator">validator</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>validator(x&gt;0) + validator(x&lt;=1)
</code></pre>

<hr>
<h2 id='add_indicators'>Add indicator values as columns to a data frame</h2><span id='topic+add_indicators'></span>

<h3>Description</h3>

<p>Compute and add externally defined indicators to data frame.
If necessary, values are recycled over records.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_indicators(dat, x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_indicators_+3A_dat">dat</code></td>
<td>
<p><code>[data.frame]</code></p>
</td></tr>
<tr><td><code id="add_indicators_+3A_x">x</code></td>
<td>
<p><code>[indicator]</code> or <code>[indication]</code> object. See examples.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>dat</code> with extra columns defined by <code>x</code> attached.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ii &lt;- indicator(
 hihi = 2*sqrt(height)
 , haha = log10(weight)
 , lulz = mean(height)
 , wo0t = median(weight)
)

# note: mean and median are repeated
add_indicators(women, ii)

# compute indicators first, then add
out &lt;- confront(women, ii)
add_indicators(women, out)

</code></pre>

<hr>
<h2 id='aggregate+2Cvalidation-method'>Aggregate validation results</h2><span id='topic+aggregate+2Cvalidation-method'></span>

<h3>Description</h3>

<p>Aggregate results of a validation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'validation'
aggregate(x, by = c("rule", "record"), drop = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aggregate+2B2Cvalidation-method_+3A_x">x</code></td>
<td>
<p>An object of class <code><a href="#topic+validation">validation</a></code></p>
</td></tr>
<tr><td><code id="aggregate+2B2Cvalidation-method_+3A_by">by</code></td>
<td>
<p>Report on violations per rule (default) or per record?</p>
</td></tr>
<tr><td><code id="aggregate+2B2Cvalidation-method_+3A_drop">drop</code></td>
<td>
<p>drop list attribute if the result is list of length 1</p>
</td></tr>
<tr><td><code id="aggregate+2B2Cvalidation-method_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>By default, a <code>data.frame</code> with the following columns.
</p>

<table>
<tr>
 <td style="text-align: left;">
  keys </td><td style="text-align: left;"> If confront was called with <code>key=</code></td>
</tr>
<tr>
 <td style="text-align: left;">
  <code>npass</code> </td><td style="text-align: left;"> Number of items passed</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code>nfail</code> </td><td style="text-align: left;"> Number of items failing</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code>nNA</code> </td><td style="text-align: left;"> Number of items resulting in <code>NA</code></td>
</tr>
<tr>
 <td style="text-align: left;">
  <code>rel.pass</code> </td><td style="text-align: left;"> Relative number of items passed</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code>rel.fail</code> </td><td style="text-align: left;"> Relative number of items failing</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code>rel.NA</code> </td><td style="text-align: left;"> Relative number of items resulting in <code>NA</code>
</td>
</tr>

</table>

<p>If <code>by='rule'</code> the relative numbers are computed with respect to the number 
of records for which the rule was evaluated. If <code>by='record'</code> the relative numbers
are computed with respect to the number of rules the record was tested agains. 
</p>
<p>When <code>by='record'</code> and not all validation results have the same dimension structure,
a list of <code>data.frames</code> is returned.
</p>


<h3>See Also</h3>

<p>Other validation-methods: 
<code><a href="#topic+all+2Cvalidation-method">all,validation-method</a></code>,
<code><a href="#topic+any+2Cvalidation-method">any,validation-method</a></code>,
<code><a href="#topic+barplot+2Cvalidation-method">barplot,validation-method</a></code>,
<code><a href="#topic+check_that">check_that</a>()</code>,
<code><a href="#topic+compare">compare</a>()</code>,
<code><a href="#topic+confront">confront</a>()</code>,
<code><a href="#topic+event">event</a>()</code>,
<code><a href="#topic+names+3C-+2Crule+2Ccharacter-method">names&lt;-,rule,character-method</a></code>,
<code><a href="#topic+plot+2Cvalidation-method">plot,validation-method</a></code>,
<code><a href="#topic+sort+2Cvalidation-method">sort,validation-method</a></code>,
<code><a href="#topic+summary">summary</a>()</code>,
<code><a href="#topic+validation-class">validation-class</a></code>,
<code><a href="#topic+values">values</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(retailers)
retailers$id &lt;- paste0("ret",1:nrow(retailers))
v &lt;- validator(
    staff.costs/staff &lt; 25
  , turnover + other.rev==total.rev)

cf &lt;- confront(retailers,v,key="id")
a &lt;- aggregate(cf,by='record')
head(a)

# or, get a sorted result:
s &lt;- sort(cf, by='record')
head(s)


</code></pre>

<hr>
<h2 id='all+2Cvalidation-method'>Test if all validations resulted in TRUE</h2><span id='topic+all+2Cvalidation-method'></span>

<h3>Description</h3>

<p>Test if all validations resulted in TRUE
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'validation'
all(x, ..., na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="all+2B2Cvalidation-method_+3A_x">x</code></td>
<td>
<p><code>validation</code> object (see <code>confront</code>).</p>
</td></tr>
<tr><td><code id="all+2B2Cvalidation-method_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="all+2B2Cvalidation-method_+3A_na.rm">na.rm</code></td>
<td>
<p>[<code>logical</code>] If <code>TRUE</code>, <code>NA</code> values
are removed before the result is computed.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other validation-methods: 
<code><a href="#topic+aggregate+2Cvalidation-method">aggregate,validation-method</a></code>,
<code><a href="#topic+any+2Cvalidation-method">any,validation-method</a></code>,
<code><a href="#topic+barplot+2Cvalidation-method">barplot,validation-method</a></code>,
<code><a href="#topic+check_that">check_that</a>()</code>,
<code><a href="#topic+compare">compare</a>()</code>,
<code><a href="#topic+confront">confront</a>()</code>,
<code><a href="#topic+event">event</a>()</code>,
<code><a href="#topic+names+3C-+2Crule+2Ccharacter-method">names&lt;-,rule,character-method</a></code>,
<code><a href="#topic+plot+2Cvalidation-method">plot,validation-method</a></code>,
<code><a href="#topic+sort+2Cvalidation-method">sort,validation-method</a></code>,
<code><a href="#topic+summary">summary</a>()</code>,
<code><a href="#topic+validation-class">validation-class</a></code>,
<code><a href="#topic+values">values</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>val &lt;- check_that(women, height&gt;60, weight&gt;0)
all(val)
</code></pre>

<hr>
<h2 id='any+2Cvalidation-method'>Test if any validation resulted in TRUE</h2><span id='topic+any+2Cvalidation-method'></span>

<h3>Description</h3>

<p>Test if any validation resulted in TRUE
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'validation'
any(x, ..., na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="any+2B2Cvalidation-method_+3A_x">x</code></td>
<td>
<p><code>validation</code> object (see <code>confront</code>).</p>
</td></tr>
<tr><td><code id="any+2B2Cvalidation-method_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="any+2B2Cvalidation-method_+3A_na.rm">na.rm</code></td>
<td>
<p>[<code>logical</code>] If <code>TRUE</code>, <code>NA</code> values
are removed before the result is computed.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other validation-methods: 
<code><a href="#topic+aggregate+2Cvalidation-method">aggregate,validation-method</a></code>,
<code><a href="#topic+all+2Cvalidation-method">all,validation-method</a></code>,
<code><a href="#topic+barplot+2Cvalidation-method">barplot,validation-method</a></code>,
<code><a href="#topic+check_that">check_that</a>()</code>,
<code><a href="#topic+compare">compare</a>()</code>,
<code><a href="#topic+confront">confront</a>()</code>,
<code><a href="#topic+event">event</a>()</code>,
<code><a href="#topic+names+3C-+2Crule+2Ccharacter-method">names&lt;-,rule,character-method</a></code>,
<code><a href="#topic+plot+2Cvalidation-method">plot,validation-method</a></code>,
<code><a href="#topic+sort+2Cvalidation-method">sort,validation-method</a></code>,
<code><a href="#topic+summary">summary</a>()</code>,
<code><a href="#topic+validation-class">validation-class</a></code>,
<code><a href="#topic+values">values</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>val &lt;- check_that(women, height&gt;60, weight&gt;0)
any(val)
</code></pre>

<hr>
<h2 id='as.data.frame'>Coerce to <code>data.frame</code></h2><span id='topic+as.data.frame'></span>

<h3>Description</h3>

<p>Coerce to <code>data.frame</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.data.frame(x, row.names = NULL, optional = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.data.frame_+3A_x">x</code></td>
<td>
<p>Object to coerce</p>
</td></tr>
<tr><td><code id="as.data.frame_+3A_row.names">row.names</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="as.data.frame_+3A_optional">optional</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="as.data.frame_+3A_...">...</code></td>
<td>
<p>arguments passed to other methods</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other expressionset-methods: 
<code><a href="#topic+as.data.frame+2Cexpressionset-method">as.data.frame,expressionset-method</a></code>,
<code><a href="#topic+created">created</a>()</code>,
<code><a href="#topic+description">description</a>()</code>,
<code><a href="#topic+label">label</a>()</code>,
<code><a href="#topic+meta">meta</a>()</code>,
<code><a href="#topic+names+3C-+2Crule+2Ccharacter-method">names&lt;-,rule,character-method</a></code>,
<code><a href="#topic+origin">origin</a>()</code>,
<code><a href="#topic+plot+2Cvalidator-method">plot,validator-method</a></code>,
<code><a href="#topic+summary">summary</a>()</code>,
<code><a href="#topic+variables">variables</a>()</code>,
<code><a href="#topic+voptions">voptions</a>()</code>
</p>

<hr>
<h2 id='as.data.frame+2CcellComparison-method'>Translate cellComparison objects to data frame</h2><span id='topic+as.data.frame+2CcellComparison-method'></span>

<h3>Description</h3>

<p>Versions of a data set can be cellwise compared using
<code><a href="#topic+cells">cells</a></code>. The result is a <code>cellComparison</code> object, 
which can usefully be translated into a data frame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'cellComparison'
as.data.frame(x, row.names = NULL, optional = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.data.frame+2B2CcellComparison-method_+3A_x">x</code></td>
<td>
<p>Object to coerce</p>
</td></tr>
<tr><td><code id="as.data.frame+2B2CcellComparison-method_+3A_row.names">row.names</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="as.data.frame+2B2CcellComparison-method_+3A_optional">optional</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="as.data.frame+2B2CcellComparison-method_+3A_...">...</code></td>
<td>
<p>arguments passed to other methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with the following columns.
</p>

<ul>
<li><p><code>status</code>: Row names of the <code>cellComparison</code> object.
</p>
</li>
<li><p><code>version</code>: Column names of the <code>cellComparison</code> object.
</p>
</li>
<li><p><code>count</code>: Contents of the <code>cellComparison</code> object.
</p>
</li></ul>



<h3>See Also</h3>

<p>Other comparing: 
<code><a href="#topic+as.data.frame+2CvalidatorComparison-method">as.data.frame,validatorComparison-method</a></code>,
<code><a href="#topic+barplot+2CcellComparison-method">barplot,cellComparison-method</a></code>,
<code><a href="#topic+barplot+2CvalidatorComparison-method">barplot,validatorComparison-method</a></code>,
<code><a href="#topic+cells">cells</a>()</code>,
<code><a href="#topic+compare">compare</a>()</code>,
<code><a href="#topic+match_cells">match_cells</a>()</code>,
<code><a href="#topic+plot+2CcellComparison-method">plot,cellComparison-method</a></code>,
<code><a href="#topic+plot+2CvalidatorComparison-method">plot,validatorComparison-method</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(retailers)

# start with raw data
step0 &lt;- retailers

# impute turnovers
step1 &lt;- step0
step1$turnover[is.na(step1$turnover)] &lt;- mean(step1$turnover,na.rm=TRUE)

# flip sign of negative revenues
step2 &lt;- step1
step2$other.rev &lt;- abs(step2$other.rev)
  

# create an overview of differences, comparing to the previous step
cells(raw = step0, imputed = step1, flipped = step2, compare="sequential")

# create an overview of differences compared to raw data
out &lt;- cells(raw = step0, imputed = step1, flipped = step2)
out

# Graphical overview of the changes
plot(out)
barplot(out)

# transform data to data.frame (easy for use with ggplot)
as.data.frame(out)


</code></pre>

<hr>
<h2 id='as.data.frame+2Cconfrontation-method'>Coerce a confrontation object to data frame</h2><span id='topic+as.data.frame+2Cconfrontation-method'></span>

<h3>Description</h3>

<p>Results of confronting data with validation rules or indicators
are created by a <code><a href="#topic+confront">confront</a></code>ation. The result is an
object (inheriting from) <code>confrontation</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'confrontation'
as.data.frame(x, row.names = NULL, optional = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.data.frame+2B2Cconfrontation-method_+3A_x">x</code></td>
<td>
<p>Object to coerce</p>
</td></tr>
<tr><td><code id="as.data.frame+2B2Cconfrontation-method_+3A_row.names">row.names</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="as.data.frame+2B2Cconfrontation-method_+3A_optional">optional</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="as.data.frame+2B2Cconfrontation-method_+3A_...">...</code></td>
<td>
<p>arguments passed to other methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.frame</code> with columns
</p>

<ul>
<li><p><code>key</code> Where relevant, and only if <code>key</code> was specified 
in the call to <code><a href="#topic+confront">confront</a></code>
</p>
</li>
<li><p><code>name</code> Name of the rule
</p>
</li>
<li><p><code>value</code> Value after evaluation
</p>
</li>
<li><p><code>expression</code> evaluated expression
</p>
</li></ul>



<h3>See Also</h3>

<p>Other confrontation-methods: 
<code><a href="#topic++5B+2Cexpressionset-method">[,expressionset-method</a></code>,
<code><a href="#topic+confront">confront</a>()</code>,
<code><a href="#topic+confrontation-class">confrontation-class</a></code>,
<code><a href="#topic+errors">errors</a>()</code>,
<code><a href="#topic+event">event</a>()</code>,
<code><a href="#topic+keyset">keyset</a>()</code>,
<code><a href="#topic+length+2Cexpressionset-method">length,expressionset-method</a></code>,
<code><a href="#topic+values">values</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cf &lt;- check_that(women, height &gt; 0, sd(weight) &gt; 0)
as.data.frame(cf)

# add id-column
women$id &lt;- letters[1:15]
i &lt;- indicator(mw = mean(weight), ratio = weight/height)
as.data.frame(confront(women, i, key="id"))

</code></pre>

<hr>
<h2 id='as.data.frame+2Cexpressionset-method'>Translate an expressionset to data.frame</h2><span id='topic+as.data.frame+2Cexpressionset-method'></span>

<h3>Description</h3>

<p>Expressions are deparsed and combined in a <code>data.frame</code> with (some
of) their metadata. Observe that some information may be lost (e.g. options
local to the object).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'expressionset'
as.data.frame(x, expand_assignments = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.data.frame+2B2Cexpressionset-method_+3A_x">x</code></td>
<td>
<p>Object to coerce</p>
</td></tr>
<tr><td><code id="as.data.frame+2B2Cexpressionset-method_+3A_expand_assignments">expand_assignments</code></td>
<td>
<p>Toggle substitution of ':=' assignments.</p>
</td></tr>
<tr><td><code id="as.data.frame+2B2Cexpressionset-method_+3A_...">...</code></td>
<td>
<p>arguments passed to other methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.frame</code> with elements <code>rule</code>, <code>name</code>,
<code>label</code>, <code>origin</code>, <code>description</code>, and <code>created</code>.
</p>


<h3>See Also</h3>

<p>Other expressionset-methods: 
<code><a href="#topic+as.data.frame">as.data.frame</a>()</code>,
<code><a href="#topic+created">created</a>()</code>,
<code><a href="#topic+description">description</a>()</code>,
<code><a href="#topic+label">label</a>()</code>,
<code><a href="#topic+meta">meta</a>()</code>,
<code><a href="#topic+names+3C-+2Crule+2Ccharacter-method">names&lt;-,rule,character-method</a></code>,
<code><a href="#topic+origin">origin</a>()</code>,
<code><a href="#topic+plot+2Cvalidator-method">plot,validator-method</a></code>,
<code><a href="#topic+summary">summary</a>()</code>,
<code><a href="#topic+variables">variables</a>()</code>,
<code><a href="#topic+voptions">voptions</a>()</code>
</p>

<hr>
<h2 id='as.data.frame+2CvalidatorComparison-method'>Translate a validatorComparison object to data frame</h2><span id='topic+as.data.frame+2CvalidatorComparison-method'></span>

<h3>Description</h3>

<p>The performance of versions of a data set with regard to rule-based quality
requirements can be compared using using <code><a href="#topic+compare">compare</a></code>. The result is a
<code>validatorComparison</code> object, which can usefully be translated into a data
frame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'validatorComparison'
as.data.frame(x, row.names = NULL, optional = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.data.frame+2B2CvalidatorComparison-method_+3A_x">x</code></td>
<td>
<p>Object to coerce</p>
</td></tr>
<tr><td><code id="as.data.frame+2B2CvalidatorComparison-method_+3A_row.names">row.names</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="as.data.frame+2B2CvalidatorComparison-method_+3A_optional">optional</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="as.data.frame+2B2CvalidatorComparison-method_+3A_...">...</code></td>
<td>
<p>arguments passed to other methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with the following columns.
</p>

<ul>
<li><p><code>status</code>: Row names of the <code>validatorComparison</code> object.
</p>
</li>
<li><p><code>version</code>: Column names of the <code>validatorComparison</code> object.
</p>
</li>
<li><p><code>count</code>: Contents of the <code>validatorComparison</code> object.
</p>
</li></ul>



<h3>See Also</h3>

<p>Other comparing: 
<code><a href="#topic+as.data.frame+2CcellComparison-method">as.data.frame,cellComparison-method</a></code>,
<code><a href="#topic+barplot+2CcellComparison-method">barplot,cellComparison-method</a></code>,
<code><a href="#topic+barplot+2CvalidatorComparison-method">barplot,validatorComparison-method</a></code>,
<code><a href="#topic+cells">cells</a>()</code>,
<code><a href="#topic+compare">compare</a>()</code>,
<code><a href="#topic+match_cells">match_cells</a>()</code>,
<code><a href="#topic+plot+2CcellComparison-method">plot,cellComparison-method</a></code>,
<code><a href="#topic+plot+2CvalidatorComparison-method">plot,validatorComparison-method</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(retailers)

rules &lt;- validator(turnover &gt;=0, staff&gt;=0, other.rev&gt;=0)

# start with raw data
step0 &lt;- retailers

# impute turnovers
step1 &lt;- step0
step1$turnover[is.na(step1$turnover)] &lt;- mean(step1$turnover,na.rm=TRUE)

# flip sign of negative revenues
step2 &lt;- step1
step2$other.rev &lt;- abs(step2$other.rev)
  
# create an overview of differences, comparing to the previous step
compare(rules, raw = step0, imputed = step1, flipped = step2, how="sequential")

# create an overview of differences compared to raw data
out &lt;- compare(rules, raw = step0, imputed = step1, flipped = step2)
out

# graphical overview
plot(out)
barplot(out)

# transform data to data.frame (easy for use with ggplot)
as.data.frame(out)


</code></pre>

<hr>
<h2 id='barplot+2CcellComparison-method'>Barplot of cellComparison object</h2><span id='topic+barplot+2CcellComparison-method'></span>

<h3>Description</h3>

<p>Versions of a data set can be compared cell by cell using <code><a href="#topic+cells">cells</a></code>.
The result is a <code>cellComparison</code> object. This method creates a stacked bar
plot of the results.  See also <code><a href="#topic+plot+2CcellComparison-method">plot,cellComparison-method</a></code> for a
line chart.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'cellComparison'
barplot(
  height,
  las = 1,
  cex.axis = 0.8,
  cex.legend = cex.axis,
  wrap = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="barplot+2B2CcellComparison-method_+3A_height">height</code></td>
<td>
<p>object of class <code>cellComparison</code></p>
</td></tr>
<tr><td><code id="barplot+2B2CcellComparison-method_+3A_las">las</code></td>
<td>
<p>[<code>numeric</code>] in <code>{0,1,2,3}</code> determining axis label rotation</p>
</td></tr>
<tr><td><code id="barplot+2B2CcellComparison-method_+3A_cex.axis">cex.axis</code></td>
<td>
<p>[<code>numeric</code>] Magnification with respect to the current
setting of <code>cex</code> for axis annotation.</p>
</td></tr>
<tr><td><code id="barplot+2B2CcellComparison-method_+3A_cex.legend">cex.legend</code></td>
<td>
<p>[<code>numeric</code>] Magnification with respect to the current
setting of <code>cex</code> for legend annotation and title.</p>
</td></tr>
<tr><td><code id="barplot+2B2CcellComparison-method_+3A_wrap">wrap</code></td>
<td>
<p>[<code>logical</code>] Toggle wrapping of x-axis labels when their width
exceeds the width of the column.</p>
</td></tr>
<tr><td><code id="barplot+2B2CcellComparison-method_+3A_...">...</code></td>
<td>
<p>Graphical parameters passed to <code><a href="graphics.html#topic+barplot.default">barplot.default</a></code>.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Before plotting, underscores (<code>_</code>) and dots (<code>.</code>) in x-axis 
labels are replaced with spaces.
</p>


<h3>See Also</h3>

<p>Other comparing: 
<code><a href="#topic+as.data.frame+2CcellComparison-method">as.data.frame,cellComparison-method</a></code>,
<code><a href="#topic+as.data.frame+2CvalidatorComparison-method">as.data.frame,validatorComparison-method</a></code>,
<code><a href="#topic+barplot+2CvalidatorComparison-method">barplot,validatorComparison-method</a></code>,
<code><a href="#topic+cells">cells</a>()</code>,
<code><a href="#topic+compare">compare</a>()</code>,
<code><a href="#topic+match_cells">match_cells</a>()</code>,
<code><a href="#topic+plot+2CcellComparison-method">plot,cellComparison-method</a></code>,
<code><a href="#topic+plot+2CvalidatorComparison-method">plot,validatorComparison-method</a></code>
</p>

<hr>
<h2 id='barplot+2Cvalidation-method'>Plot number of violations</h2><span id='topic+barplot+2Cvalidation-method'></span>

<h3>Description</h3>

<p>Plot number of violations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'validation'
barplot(
  height,
  ...,
  order_by = c("fails", "passes", "nNA"),
  stack_by = c("fails", "passes", "nNA"),
  topn = Inf,
  add_legend = TRUE,
  add_exprs = TRUE,
  colors = c(fails = "#FB9A99", passes = "#B2DF8A", nNA = "#FDBF6F")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="barplot+2B2Cvalidation-method_+3A_height">height</code></td>
<td>
<p>an R object defining height of bars (here, a <code>validation</code> object)</p>
</td></tr>
<tr><td><code id="barplot+2B2Cvalidation-method_+3A_...">...</code></td>
<td>
<p>parameters to be passed to <code><a href="graphics.html#topic+barplot">barplot</a></code> but not 
<code>height</code>, <code>horiz</code>, <code>border</code>,<code>las</code>, and <code>las</code>.</p>
</td></tr>
<tr><td><code id="barplot+2B2Cvalidation-method_+3A_order_by">order_by</code></td>
<td>
<p>(single <code>character</code>) order bars decreasingly from top to bottom by the 
number of fails, passes or <code>NA</code>'s.</p>
</td></tr>
<tr><td><code id="barplot+2B2Cvalidation-method_+3A_stack_by">stack_by</code></td>
<td>
<p>(3-vector of <code>characters</code>) Stacking order for bar chart (left to right)</p>
</td></tr>
<tr><td><code id="barplot+2B2Cvalidation-method_+3A_topn">topn</code></td>
<td>
<p>If specified, plot only the top n most violated calls</p>
</td></tr>
<tr><td><code id="barplot+2B2Cvalidation-method_+3A_add_legend">add_legend</code></td>
<td>
<p>Display legend?</p>
</td></tr>
<tr><td><code id="barplot+2B2Cvalidation-method_+3A_add_exprs">add_exprs</code></td>
<td>
<p>Display rules?</p>
</td></tr>
<tr><td><code id="barplot+2B2Cvalidation-method_+3A_colors">colors</code></td>
<td>
<p>Bar colors for validations yielding NA or a violation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list, containing the bar locations as in <code><a href="graphics.html#topic+barplot">barplot</a></code>
</p>


<h3>Credits</h3>

<p>The default colors were generated with the <code>RColorBrewer</code> package of Erich Neuwirth.
</p>


<h3>See Also</h3>

<p>Other validation-methods: 
<code><a href="#topic+aggregate+2Cvalidation-method">aggregate,validation-method</a></code>,
<code><a href="#topic+all+2Cvalidation-method">all,validation-method</a></code>,
<code><a href="#topic+any+2Cvalidation-method">any,validation-method</a></code>,
<code><a href="#topic+check_that">check_that</a>()</code>,
<code><a href="#topic+compare">compare</a>()</code>,
<code><a href="#topic+confront">confront</a>()</code>,
<code><a href="#topic+event">event</a>()</code>,
<code><a href="#topic+names+3C-+2Crule+2Ccharacter-method">names&lt;-,rule,character-method</a></code>,
<code><a href="#topic+plot+2Cvalidation-method">plot,validation-method</a></code>,
<code><a href="#topic+sort+2Cvalidation-method">sort,validation-method</a></code>,
<code><a href="#topic+summary">summary</a>()</code>,
<code><a href="#topic+validation-class">validation-class</a></code>,
<code><a href="#topic+values">values</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(retailers)
cf &lt;- check_that(retailers
    , staff.costs &lt; total.costs
    , turnover + other.rev == total.rev
    , other.rev &gt; 0
    , total.rev &gt; 0)
barplot(cf)

</code></pre>

<hr>
<h2 id='barplot+2CvalidatorComparison-method'>Barplot of validatorComparison object</h2><span id='topic+barplot+2CvalidatorComparison-method'></span>

<h3>Description</h3>

<p>The performance of versions of a data set with regard to rule-based quality
requirements can be compared using using <code><a href="#topic+compare">compare</a></code>. The result is a
<code>validatorComparison</code> object. This method creates a stacked bar plot of
the results.  See also <code><a href="#topic+plot+2CvalidatorComparison-method">plot,validatorComparison-method</a></code> for a line
chart.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'validatorComparison'
barplot(
  height,
  las = 1,
  cex.axis = 0.8,
  cex.legend = cex.axis,
  wrap = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="barplot+2B2CvalidatorComparison-method_+3A_height">height</code></td>
<td>
<p>object of class <code>validatorComparison</code></p>
</td></tr>
<tr><td><code id="barplot+2B2CvalidatorComparison-method_+3A_las">las</code></td>
<td>
<p>[<code>numeric</code>] in <code>{0,1,2,3}</code> determining axis label rotation</p>
</td></tr>
<tr><td><code id="barplot+2B2CvalidatorComparison-method_+3A_cex.axis">cex.axis</code></td>
<td>
<p>[<code>numeric</code>] Magnification with respect to the current
setting of <code>cex</code> for axis annotation.</p>
</td></tr>
<tr><td><code id="barplot+2B2CvalidatorComparison-method_+3A_cex.legend">cex.legend</code></td>
<td>
<p>[<code>numeric</code>] Magnification with respect to the current
setting of <code>cex</code> for legend annotation and title.</p>
</td></tr>
<tr><td><code id="barplot+2B2CvalidatorComparison-method_+3A_wrap">wrap</code></td>
<td>
<p>[<code>logical</code>] Toggle wrapping of x-axis labels when their width
exceeds the width of the column.</p>
</td></tr>
<tr><td><code id="barplot+2B2CvalidatorComparison-method_+3A_...">...</code></td>
<td>
<p>Graphical parameters passed to <code><a href="graphics.html#topic+barplot.default">barplot.default</a></code>.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Before plotting, underscores (<code>_</code>) and dots (<code>.</code>) in x-axis labels
are replaced with spaces.
</p>


<h3>See Also</h3>

<p>Other comparing: 
<code><a href="#topic+as.data.frame+2CcellComparison-method">as.data.frame,cellComparison-method</a></code>,
<code><a href="#topic+as.data.frame+2CvalidatorComparison-method">as.data.frame,validatorComparison-method</a></code>,
<code><a href="#topic+barplot+2CcellComparison-method">barplot,cellComparison-method</a></code>,
<code><a href="#topic+cells">cells</a>()</code>,
<code><a href="#topic+compare">compare</a>()</code>,
<code><a href="#topic+match_cells">match_cells</a>()</code>,
<code><a href="#topic+plot+2CcellComparison-method">plot,cellComparison-method</a></code>,
<code><a href="#topic+plot+2CvalidatorComparison-method">plot,validatorComparison-method</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(retailers)

rules &lt;- validator(turnover &gt;=0, staff&gt;=0, other.rev&gt;=0)

# start with raw data
step0 &lt;- retailers

# impute turnovers
step1 &lt;- step0
step1$turnover[is.na(step1$turnover)] &lt;- mean(step1$turnover,na.rm=TRUE)

# flip sign of negative revenues
step2 &lt;- step1
step2$other.rev &lt;- abs(step2$other.rev)
  
# create an overview of differences, comparing to the previous step
compare(rules, raw = step0, imputed = step1, flipped = step2, how="sequential")

# create an overview of differences compared to raw data
out &lt;- compare(rules, raw = step0, imputed = step1, flipped = step2)
out

# graphical overview
plot(out)
barplot(out)

# transform data to data.frame (easy for use with ggplot)
as.data.frame(out)


</code></pre>

<hr>
<h2 id='cells'>Cell counts and differences for a series of datasets</h2><span id='topic+cells'></span>

<h3>Description</h3>

<p>Cell counts and differences for a series of datasets
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cells(..., .list = NULL, compare = c("to_first", "sequential"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cells_+3A_...">...</code></td>
<td>
<p>For <code>cells</code>: data frames, comma separated. Names will become
column names in the output. For <code>plot</code> or <code>barplot</code>: graphical parameters
(see <code><a href="graphics.html#topic+par">par</a></code>).</p>
</td></tr>
<tr><td><code id="cells_+3A_.list">.list</code></td>
<td>
<p>A <code>list</code> of data frames; will be concatenated with 
objects in <code>...</code></p>
</td></tr>
<tr><td><code id="cells_+3A_compare">compare</code></td>
<td>
<p>How to compare the datasets.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>cellComparison</code>, which is really an array 
with a few extra attributes. It counts the total number of cells, the number of 
missings, the number of altered values and changes therein as compared to 
the reference defined in <code>how</code>.
</p>


<h3>Comparing datasets cell by cell</h3>

<p>When comparing the contents of two data sets, the total number of cells
in the current data set can be partitioned as in the following figure.
</p>
<p><img src="../help/figures/cellsplit.png" width=80% alt="rulewise splitting" />

</p>
<p>This function computes the partition for two or more
datasets, comparing the current set to the first (default) or to the 
previous (by setting <code>compare='sequential'</code>).
</p>


<h3>Details</h3>

<p>This function assumes that the datasets have the same dimensions and that both
rows and columns are ordered similarly.
</p>


<h3>References</h3>

<p>The figure is reproduced from MPJ van der Loo and E. De Jonge (2018)
<em>Statistical Data Cleaning with applications in R</em> (John Wiley &amp; Sons).
</p>


<h3>See Also</h3>

<p>Other comparing: 
<code><a href="#topic+as.data.frame+2CcellComparison-method">as.data.frame,cellComparison-method</a></code>,
<code><a href="#topic+as.data.frame+2CvalidatorComparison-method">as.data.frame,validatorComparison-method</a></code>,
<code><a href="#topic+barplot+2CcellComparison-method">barplot,cellComparison-method</a></code>,
<code><a href="#topic+barplot+2CvalidatorComparison-method">barplot,validatorComparison-method</a></code>,
<code><a href="#topic+compare">compare</a>()</code>,
<code><a href="#topic+match_cells">match_cells</a>()</code>,
<code><a href="#topic+plot+2CcellComparison-method">plot,cellComparison-method</a></code>,
<code><a href="#topic+plot+2CvalidatorComparison-method">plot,validatorComparison-method</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(retailers)

# start with raw data
step0 &lt;- retailers

# impute turnovers
step1 &lt;- step0
step1$turnover[is.na(step1$turnover)] &lt;- mean(step1$turnover,na.rm=TRUE)

# flip sign of negative revenues
step2 &lt;- step1
step2$other.rev &lt;- abs(step2$other.rev)
  

# create an overview of differences, comparing to the previous step
cells(raw = step0, imputed = step1, flipped = step2, compare="sequential")

# create an overview of differences compared to raw data
out &lt;- cells(raw = step0, imputed = step1, flipped = step2)
out

# Graphical overview of the changes
plot(out)
barplot(out)

# transform data to data.frame (easy for use with ggplot)
as.data.frame(out)


</code></pre>

<hr>
<h2 id='check_that'>Simple data validation interface</h2><span id='topic+check_that'></span>

<h3>Description</h3>

<p>Simple data validation interface
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_that(dat, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_that_+3A_dat">dat</code></td>
<td>
<p>an R object carrying data</p>
</td></tr>
<tr><td><code id="check_that_+3A_...">...</code></td>
<td>
<p>a comma-separated set of validating expressions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code><a href="#topic+validation">validation</a></code>
</p>


<h3>Details</h3>

<p>Creates an object of class <code><a href="#topic+validator">validator</a></code> and <code><a href="#topic+confront">confront</a></code>s it with the data.
This function is easy to use in combination with the <span class="pkg">magrittr</span> pipe operator.
</p>


<h3>See Also</h3>

<p>Other validation-methods: 
<code><a href="#topic+aggregate+2Cvalidation-method">aggregate,validation-method</a></code>,
<code><a href="#topic+all+2Cvalidation-method">all,validation-method</a></code>,
<code><a href="#topic+any+2Cvalidation-method">any,validation-method</a></code>,
<code><a href="#topic+barplot+2Cvalidation-method">barplot,validation-method</a></code>,
<code><a href="#topic+compare">compare</a>()</code>,
<code><a href="#topic+confront">confront</a>()</code>,
<code><a href="#topic+event">event</a>()</code>,
<code><a href="#topic+names+3C-+2Crule+2Ccharacter-method">names&lt;-,rule,character-method</a></code>,
<code><a href="#topic+plot+2Cvalidation-method">plot,validation-method</a></code>,
<code><a href="#topic+sort+2Cvalidation-method">sort,validation-method</a></code>,
<code><a href="#topic+summary">summary</a>()</code>,
<code><a href="#topic+validation-class">validation-class</a></code>,
<code><a href="#topic+values">values</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
cf &lt;- check_that(women, height&gt;0, height/weight &lt; 0.5)
cf
summary(cf)
barplot(cf)


## Not run: 
# this works only after loading the 'magrittr' package
women %&gt;% 
  check_that(height&gt;0, height/weight &lt; 0.5) %&gt;%
  summary()

## End(Not run)

</code></pre>

<hr>
<h2 id='compare'>Compare similar data sets</h2><span id='topic+compare'></span><span id='topic+compare+2Cvalidator-method'></span><span id='topic+compare+2Cindicator-method'></span>

<h3>Description</h3>

<p>Compare versions of a data set by comparing their performance against a
set of rules or other quality indicators. This function takes two or
more data sets and compares the perfomance of data set <code class="reqn">2,3,\ldots</code>
against that of the first data set (default) or to the previous one
(by setting <code>how='sequential'</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compare(x, ...)

## S4 method for signature 'validator'
compare(x, ..., .list = list(), how = c("to_first", "sequential"))

## S4 method for signature 'indicator'
compare(x, ..., .list = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compare_+3A_x">x</code></td>
<td>
<p>An R object</p>
</td></tr>
<tr><td><code id="compare_+3A_...">...</code></td>
<td>
<p>data frames, comma separated. Names become column names in
the output.</p>
</td></tr>
<tr><td><code id="compare_+3A_.list">.list</code></td>
<td>
<p>Optional list of data sets, will be concatenated with <code>...</code>.</p>
</td></tr>
<tr><td><code id="compare_+3A_how">how</code></td>
<td>
<p>how to compare</p>
</td></tr>
</table>


<h3>Value</h3>

<p>For <code>validator</code>: An array where each column represents 
one dataset. 
The rows count the following attributes:
</p>

<ul>
<li><p>Number of validations performed
</p>
</li>
<li><p>Number of validations that evaluate to <code>NA</code> (unverifiable)
</p>
</li>
<li><p>Number of validations that evaluate to a logical (verifiable)
</p>
</li>
<li><p>Number of validations that evaluate to <code>TRUE</code>
</p>
</li>
<li><p>Number of validations that evaluate to <code>FALSE</code>
</p>
</li>
<li><p>Number of extra validations that evaluate to <code>NA</code> (new unverifiable)
</p>
</li>
<li><p>Number of validations that still evaluate to <code>NA</code> (still unverifialble)
</p>
</li>
<li><p>Number of validations that still evaluate to <code>TRUE</code>
</p>
</li>
<li><p>Number of extra validations that evaluate to <code>TRUE</code> 
</p>
</li>
<li><p>Number of validations that still evaluate to <code>FALSE</code>
</p>
</li>
<li><p>Number of extra validations that evaluate to <code>FALSE</code>
</p>
</li></ul>

<p>For <code>indicator</code>: A list with the following components:
</p>

<ul>
<li><p><code>numeric</code>: An array collecting results of scalar indicator (e.g. <code>mean(x)</code>).
</p>
</li>
<li><p><code>nonnumeric</code>: An array collecting results of nonnumeric scalar indicators (e.g. names(which.max(table(x))))
</p>
</li>
<li><p><code>array</code>: A list of arrays, collecting results of vector-indicators (e.g. x/mean(x))
</p>
</li></ul>



<h3>Comparing datasets by performance against validator objects</h3>

<p>Suppose we have a current and a previous version of a data set. Both
can be inspected by <code><a href="#topic+confront">confront</a></code>ing them with a rule set.
The status changes in rule violations can be partitioned as shown in the 
following figure.
<img src="../help/figures/rulesplit.png" width=80% alt="cellwise splitting" />

This function computes the partition for two or more
datasets, comparing the current set to the first (default) or to the 
previous (by setting <code>compare='sequential'</code>).
</p>


<h3>References</h3>

<p>The figure is reproduced from MPJ van der Loo and E. De Jonge (2018)
<em>Statistical Data Cleaning with applications in R</em> (John Wiley &amp; Sons).
</p>


<h3>See Also</h3>

<p>Other validation-methods: 
<code><a href="#topic+aggregate+2Cvalidation-method">aggregate,validation-method</a></code>,
<code><a href="#topic+all+2Cvalidation-method">all,validation-method</a></code>,
<code><a href="#topic+any+2Cvalidation-method">any,validation-method</a></code>,
<code><a href="#topic+barplot+2Cvalidation-method">barplot,validation-method</a></code>,
<code><a href="#topic+check_that">check_that</a>()</code>,
<code><a href="#topic+confront">confront</a>()</code>,
<code><a href="#topic+event">event</a>()</code>,
<code><a href="#topic+names+3C-+2Crule+2Ccharacter-method">names&lt;-,rule,character-method</a></code>,
<code><a href="#topic+plot+2Cvalidation-method">plot,validation-method</a></code>,
<code><a href="#topic+sort+2Cvalidation-method">sort,validation-method</a></code>,
<code><a href="#topic+summary">summary</a>()</code>,
<code><a href="#topic+validation-class">validation-class</a></code>,
<code><a href="#topic+values">values</a>()</code>
</p>
<p>Other comparing: 
<code><a href="#topic+as.data.frame+2CcellComparison-method">as.data.frame,cellComparison-method</a></code>,
<code><a href="#topic+as.data.frame+2CvalidatorComparison-method">as.data.frame,validatorComparison-method</a></code>,
<code><a href="#topic+barplot+2CcellComparison-method">barplot,cellComparison-method</a></code>,
<code><a href="#topic+barplot+2CvalidatorComparison-method">barplot,validatorComparison-method</a></code>,
<code><a href="#topic+cells">cells</a>()</code>,
<code><a href="#topic+match_cells">match_cells</a>()</code>,
<code><a href="#topic+plot+2CcellComparison-method">plot,cellComparison-method</a></code>,
<code><a href="#topic+plot+2CvalidatorComparison-method">plot,validatorComparison-method</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(retailers)

rules &lt;- validator(turnover &gt;=0, staff&gt;=0, other.rev&gt;=0)

# start with raw data
step0 &lt;- retailers

# impute turnovers
step1 &lt;- step0
step1$turnover[is.na(step1$turnover)] &lt;- mean(step1$turnover,na.rm=TRUE)

# flip sign of negative revenues
step2 &lt;- step1
step2$other.rev &lt;- abs(step2$other.rev)
  
# create an overview of differences, comparing to the previous step
compare(rules, raw = step0, imputed = step1, flipped = step2, how="sequential")

# create an overview of differences compared to raw data
out &lt;- compare(rules, raw = step0, imputed = step1, flipped = step2)
out

# graphical overview
plot(out)
barplot(out)

# transform data to data.frame (easy for use with ggplot)
as.data.frame(out)


</code></pre>

<hr>
<h2 id='confront'>Confront data with a (set of) expressionset(s)</h2><span id='topic+confront'></span><span id='topic+confront+2Cdata.frame+2Cindicator+2CANY-method'></span><span id='topic+confront+2Cdata.frame+2Cindicator+2Cenvironment-method'></span><span id='topic+confront+2Cdata.frame+2Cindicator+2Cdata.frame-method'></span><span id='topic+confront+2Cdata.frame+2Cindicator+2Clist-method'></span><span id='topic+confront+2Cdata.frame+2Cvalidator+2CANY-method'></span><span id='topic+confront+2Cdata.frame+2Cvalidator+2Cenvironment-method'></span><span id='topic+confront+2Cdata.frame+2Cvalidator+2Cdata.frame-method'></span><span id='topic+confront+2Cdata.frame+2Cvalidator+2Clist-method'></span>

<h3>Description</h3>

<p>An expressionset is a general class storing rich expressions (basically
expressions and some meta data) which we call 'rules'. Examples of
expressionset implementations are <code><a href="#topic+validator">validator</a></code> objects, storing
validation rules and <code><a href="#topic+indicator">indicator</a></code> objects, storing data quality
indicators. The <code>confront</code> function evaluates the expressions one by one
on a dataset while recording some process meta data. All results are stored in
a (subclass of a) <code>confrontation</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>confront(dat, x, ref, ...)

## S4 method for signature 'data.frame,indicator,ANY'
confront(dat, x, key = NULL, ...)

## S4 method for signature 'data.frame,indicator,environment'
confront(dat, x, ref, key = NULL, ...)

## S4 method for signature 'data.frame,indicator,data.frame'
confront(dat, x, ref, key = NULL, ...)

## S4 method for signature 'data.frame,indicator,list'
confront(dat, x, ref, key = NULL, ...)

## S4 method for signature 'data.frame,validator,ANY'
confront(dat, x, key = NULL, ...)

## S4 method for signature 'data.frame,validator,environment'
confront(dat, x, ref, key = NULL, ...)

## S4 method for signature 'data.frame,validator,data.frame'
confront(dat, x, ref, key = NULL, ...)

## S4 method for signature 'data.frame,validator,list'
confront(dat, x, ref, key = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="confront_+3A_dat">dat</code></td>
<td>
<p>An R object carrying data</p>
</td></tr>
<tr><td><code id="confront_+3A_x">x</code></td>
<td>
<p>An R object carrying <code><a href="#topic+rule">rule</a></code>s.</p>
</td></tr>
<tr><td><code id="confront_+3A_ref">ref</code></td>
<td>
<p>Optionally, an R object carrying reference data. See examples for usage.</p>
</td></tr>
<tr><td><code id="confront_+3A_...">...</code></td>
<td>
<p>Options used at execution time (especially <code>'raise'</code>). 
See <code><a href="#topic+voptions">voptions</a></code>.</p>
</td></tr>
<tr><td><code id="confront_+3A_key">key</code></td>
<td>
<p>(optional) name of identifying variable in x.</p>
</td></tr>
</table>


<h3>Reference data</h3>

<p>Reference data is typically a <code>list</code> with a items such as
a code list, or a data frame of which rows match the rows of the
data under scrutiny.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+voptions">voptions</a></code>
</p>
<p>Other confrontation-methods: 
<code><a href="#topic++5B+2Cexpressionset-method">[,expressionset-method</a></code>,
<code><a href="#topic+as.data.frame+2Cconfrontation-method">as.data.frame,confrontation-method</a></code>,
<code><a href="#topic+confrontation-class">confrontation-class</a></code>,
<code><a href="#topic+errors">errors</a>()</code>,
<code><a href="#topic+event">event</a>()</code>,
<code><a href="#topic+keyset">keyset</a>()</code>,
<code><a href="#topic+length+2Cexpressionset-method">length,expressionset-method</a></code>,
<code><a href="#topic+values">values</a>()</code>
</p>
<p>Other validation-methods: 
<code><a href="#topic+aggregate+2Cvalidation-method">aggregate,validation-method</a></code>,
<code><a href="#topic+all+2Cvalidation-method">all,validation-method</a></code>,
<code><a href="#topic+any+2Cvalidation-method">any,validation-method</a></code>,
<code><a href="#topic+barplot+2Cvalidation-method">barplot,validation-method</a></code>,
<code><a href="#topic+check_that">check_that</a>()</code>,
<code><a href="#topic+compare">compare</a>()</code>,
<code><a href="#topic+event">event</a>()</code>,
<code><a href="#topic+names+3C-+2Crule+2Ccharacter-method">names&lt;-,rule,character-method</a></code>,
<code><a href="#topic+plot+2Cvalidation-method">plot,validation-method</a></code>,
<code><a href="#topic+sort+2Cvalidation-method">sort,validation-method</a></code>,
<code><a href="#topic+summary">summary</a>()</code>,
<code><a href="#topic+validation-class">validation-class</a></code>,
<code><a href="#topic+values">values</a>()</code>
</p>
<p>Other indication-methods: 
<code><a href="#topic+event">event</a>()</code>,
<code><a href="#topic+indication-class">indication-class</a></code>,
<code><a href="#topic+summary">summary</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# a basic validation example
v &lt;- validator(height/weight &lt; 0.5, mean(height) &gt;= 0)
cf &lt;- confront(women, v)
summary(cf)
plot(cf)
as.data.frame(cf)

# an example checking metadata
v &lt;- validator(nrow(.) == 15, ncol(.) &gt; 2)
summary(confront(women, v))

# An example using reference data
v &lt;- validator(weight == ref$weight)
summary(confront(women, v, women))

# Usging custom names for reference data
v &lt;- validator(weight == test$weight)
summary( confront(women,v, list(test=women)) )

# Reference data in an environment
e &lt;- new.env()
e$test &lt;- women
v &lt;- validator(weight == test$weight)
summary( confront(women, v, e) )

# the effect of using a key
w &lt;- women
w$id &lt;- letters[1:nrow(w)]
v &lt;- validator(weight == ref$weight)

# with complete data; already matching
values( confront(w, v, w, key='id'))

# with scrambled rows in reference data (reference gets sorted according to dat)
i &lt;- sample(nrow(w))
values(confront(w, v, w[i,],key='id'))

# with incomplete reference data
values(confront(w, v, w[1:10,],key='id'))


</code></pre>

<hr>
<h2 id='confrontation-class'>Superclass storing results of confronting data with rules</h2><span id='topic+confrontation-class'></span><span id='topic+confrontation'></span>

<h3>Description</h3>

<p>Superclass storing results of confronting data with rules
</p>


<h3>Details</h3>

<p>This class is aimed at developers of this package or packages depending on 
it. It is the parent of classes <code><a href="#topic+indication">indication</a></code> and 
<code><a href="#topic+validation">validation</a></code> which are user-facing.
</p>
<p>Using <code><a href="#topic+confront">confront</a></code>, a set of rules can be executed in the context
of one or more (nested) environments holding data. The results of such evaluations
are stored in a <code>confrontation</code> object along with metadata. 
</p>
<p>We strongly advise against accessing the data fields or methods internal to
this object directly, as we may change or remove them without notice. Use
the exported methods listed below in stead.
</p>


<h3>See Also</h3>

<p>Other confrontation-methods: 
<code><a href="#topic++5B+2Cexpressionset-method">[,expressionset-method</a></code>,
<code><a href="#topic+as.data.frame+2Cconfrontation-method">as.data.frame,confrontation-method</a></code>,
<code><a href="#topic+confront">confront</a>()</code>,
<code><a href="#topic+errors">errors</a>()</code>,
<code><a href="#topic+event">event</a>()</code>,
<code><a href="#topic+keyset">keyset</a>()</code>,
<code><a href="#topic+length+2Cexpressionset-method">length,expressionset-method</a></code>,
<code><a href="#topic+values">values</a>()</code>
</p>

<hr>
<h2 id='contains_exactly'>Check records using a predifined table of (im)possible values</h2><span id='topic+contains_exactly'></span><span id='topic+contains_at_least'></span><span id='topic+contains_at_most'></span><span id='topic+does_not_contain'></span>

<h3>Description</h3>

<p>Given a set of keys or key combinations, check whether all thos combinations
occur, or check that they do not occur.  Supports globbing and regular
expressions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>contains_exactly(keys, by = NULL, allow_duplicates = FALSE)

contains_at_least(keys, by = NULL)

contains_at_most(keys, by = NULL)

does_not_contain(keys)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="contains_exactly_+3A_keys">keys</code></td>
<td>
<p>A data frame or bare (unquoted) name of a data
frame passed as a reference to <code>confront</code> (see examples).
The column names of <code>keys</code> must also occurr in the columns
of the data under scrutiny.</p>
</td></tr>
<tr><td><code id="contains_exactly_+3A_by">by</code></td>
<td>
<p>A bare (unquoted) variable or list of variable names that occur in
the data under scrutiny. The data will be split into groups according to
these variables and the check is performed on each group.</p>
</td></tr>
<tr><td><code id="contains_exactly_+3A_allow_duplicates">allow_duplicates</code></td>
<td>
<p><code>[logical]</code> toggle whether key combinations can occur 
more than once.</p>
</td></tr>
</table>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
  <code>contains_exactly</code> </td><td style="text-align: left;"> dataset contains exactly the key set, no more, no less. </td>
</tr>
<tr>
 <td style="text-align: left;">
  <code>contains_at_least</code></td><td style="text-align: left;"> dataset contains at least the given keys. </td>
</tr>
<tr>
 <td style="text-align: left;">
  <code>contains_at_most</code> </td><td style="text-align: left;"> all keys in the data set are contained the given keys. </td>
</tr>
<tr>
 <td style="text-align: left;">
  <code>does_not_contain</code> </td><td style="text-align: left;"> The keys are interpreted as forbidden key combinations. </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Value</h3>

<p>For <code>contains_exactly</code>, <code>contains_at_least</code>, and
<code>contains_at_most</code> a <code>logical</code> vector with one entry for each
record in the dataset. Any group not conforming to the test keys will have
<code>FALSE</code> assigned to each record in the group (see examples).
</p>
<p>For <code>contains_at_least</code>: a <code>logical</code> vector equal to the number of
records under scrutiny. It is <code>FALSE</code> where key combinations do not match
any value in <code>keys</code>.
</p>
<p>For <code>does_not_contain</code>:  a <code>logical</code> vector with size equal to the
number of records under scrutiny. It is <code>FALSE</code> where key combinations
do not match any value in <code>keys</code>.
</p>


<h3>Globbing</h3>

<p>Globbing is a simple method of defining string patterns where the asterisks
(<code>*</code>) is used a wildcard. For example, the globbing pattern
<code>"abc*"</code> stands for any string starting with <code>"abc"</code>.
</p>


<h3>See Also</h3>

<p>Other cross-record-helpers: 
<code><a href="#topic+do_by">do_by</a>()</code>,
<code><a href="#topic+exists_any">exists_any</a>()</code>,
<code><a href="#topic+hb">hb</a>()</code>,
<code><a href="#topic+hierarchy">hierarchy</a>()</code>,
<code><a href="#topic+is_complete">is_complete</a>()</code>,
<code><a href="#topic+is_linear_sequence">is_linear_sequence</a>()</code>,
<code><a href="#topic+is_unique">is_unique</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Check that data is present for all quarters in 2018-2019
dat &lt;- data.frame(
    year    = rep(c("2018","2019"),each=4)
  , quarter = rep(sprintf("Q%d",1:4), 2)
  , value   = sample(20:50,8)
)

# Method 1: creating a data frame in-place (only for simple cases)
rule &lt;- validator(contains_exactly(
           expand.grid(year=c("2018","2019"), quarter=c("Q1","Q2","Q3","Q4"))
          )
        )
out &lt;- confront(dat, rule)
values(out)

# Method 2: pass the keyset to 'confront', and reference it in the rule.
# this scales to larger key sets but it needs a 'contract' between the
# rule definition and how 'confront' is called.

keyset &lt;- expand.grid(year=c("2018","2019"), quarter=c("Q1","Q2","Q3","Q4"))
rule &lt;- validator(contains_exactly(all_keys))
out &lt;- confront(dat, rule, ref=list(all_keys = keyset))
values(out)

## Globbing (use * as a wildcard)

# transaction data 
transactions &lt;- data.frame(
    sender   = c("S21", "X34", "S45","Z22")
  , receiver = c("FG0", "FG2", "DF1","KK2")
  , value    = sample(70:100,4)
)

# forbidden combinations: if the sender starts with "S", 
# the receiver can not start "FG"
forbidden &lt;- data.frame(sender="S*",receiver = "FG*")

rule &lt;- validator(does_not_contain(glob(forbidden_keys)))
out &lt;- confront(transactions, rule, ref=list(forbidden_keys=forbidden))
values(out)


## Quick interactive testing
# use 'with':
with(transactions, does_not_contain(forbidden)) 



## Grouping 

# data in 'long' format
dat &lt;- expand.grid(
  year = c("2018","2019")
  , quarter = c("Q1","Q2","Q3","Q4")
  , variable = c("import","export")
)
dat$value &lt;- sample(50:100,nrow(dat))


periods &lt;- expand.grid(
  year = c("2018","2019")
  , quarter = c("Q1","Q2","Q3","Q4")
)

rule &lt;- validator(contains_exactly(all_periods, by=variable))

out &lt;- confront(dat, rule, ref=list(all_periods=periods))
values(out)

# remove one  export record

dat1 &lt;- dat[-15,]
out1 &lt;- confront(dat1, rule, ref=list(all_periods=periods))
values(out1)
values(out1)

</code></pre>

<hr>
<h2 id='created'>Creation timestamp</h2><span id='topic+created'></span><span id='topic+created+3C-'></span><span id='topic+created+2Crule-method'></span><span id='topic+created+3C-+2Crule+2CPOSIXct-method'></span><span id='topic+created+2Cexpressionset-method'></span><span id='topic+created+3C-+2Cexpressionset+2CPOSIXct-method'></span>

<h3>Description</h3>

<p>Creation timestamp
</p>


<h3>Usage</h3>

<pre><code class='language-R'>created(x, ...)

created(x) &lt;- value

## S4 method for signature 'rule'
created(x, ...)

## S4 replacement method for signature 'rule,POSIXct'
created(x) &lt;- value

## S4 method for signature 'expressionset'
created(x, ...)

## S4 replacement method for signature 'expressionset,POSIXct'
created(x) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="created_+3A_x">x</code></td>
<td>
<p>and R object</p>
</td></tr>
<tr><td><code id="created_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to other methods</p>
</td></tr>
<tr><td><code id="created_+3A_value">value</code></td>
<td>
<p>Value to set</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>POSIXct</code> vector.
</p>


<h3>See Also</h3>

<p>Other expressionset-methods: 
<code><a href="#topic+as.data.frame">as.data.frame</a>()</code>,
<code><a href="#topic+as.data.frame+2Cexpressionset-method">as.data.frame,expressionset-method</a></code>,
<code><a href="#topic+description">description</a>()</code>,
<code><a href="#topic+label">label</a>()</code>,
<code><a href="#topic+meta">meta</a>()</code>,
<code><a href="#topic+names+3C-+2Crule+2Ccharacter-method">names&lt;-,rule,character-method</a></code>,
<code><a href="#topic+origin">origin</a>()</code>,
<code><a href="#topic+plot+2Cvalidator-method">plot,validator-method</a></code>,
<code><a href="#topic+summary">summary</a>()</code>,
<code><a href="#topic+variables">variables</a>()</code>,
<code><a href="#topic+voptions">voptions</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# retrieve properties
v &lt;- validator(turnover &gt; 0, staff.costs&gt;0)

# number of rules in v:
length(v)

# per-rule
created(v)
origin(v)
names(v)

# set properties
names(v)[1] &lt;- "p1"

label(v)[1] &lt;- "turnover positive"
description(v)[1] &lt;- "
According to the official definition,
only positive values can be considered
valid turnovers.
"

# short description is also printed:
v

# print all info for first rule
v[[1]]



# retrieve properties
v &lt;- validator(turnover &gt; 0, staff.costs&gt;0)

# number of rules in v:
length(v)

# per-rule
created(v)
origin(v)
names(v)

# set properties
names(v)[1] &lt;- "p1"

label(v)[1] &lt;- "turnover positive"
description(v)[1] &lt;- "
According to the official definition,
only positive values can be considered
valid turnovers.
"

# short description is also printed:
v

# print all info for first rule
v[[1]]


</code></pre>

<hr>
<h2 id='description'>Rule description</h2><span id='topic+description'></span><span id='topic+description+3C-'></span><span id='topic+description+2Crule-method'></span><span id='topic+description+3C-+2Crule+2Ccharacter-method'></span><span id='topic+description+2Cexpressionset-method'></span><span id='topic+description+3C-+2Cexpressionset+2Ccharacter-method'></span>

<h3>Description</h3>

<p>A longer (typically one-paragraph) description of a rule.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>description(x, ...)

description(x) &lt;- value

## S4 method for signature 'rule'
description(x, ...)

## S4 replacement method for signature 'rule,character'
description(x) &lt;- value

## S4 method for signature 'expressionset'
description(x, ...)

## S4 replacement method for signature 'expressionset,character'
description(x) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="description_+3A_x">x</code></td>
<td>
<p>and R object</p>
</td></tr>
<tr><td><code id="description_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to other methods</p>
</td></tr>
<tr><td><code id="description_+3A_value">value</code></td>
<td>
<p>Value to set</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>character</code> vector.
</p>


<h3>See Also</h3>

<p>Other expressionset-methods: 
<code><a href="#topic+as.data.frame">as.data.frame</a>()</code>,
<code><a href="#topic+as.data.frame+2Cexpressionset-method">as.data.frame,expressionset-method</a></code>,
<code><a href="#topic+created">created</a>()</code>,
<code><a href="#topic+label">label</a>()</code>,
<code><a href="#topic+meta">meta</a>()</code>,
<code><a href="#topic+names+3C-+2Crule+2Ccharacter-method">names&lt;-,rule,character-method</a></code>,
<code><a href="#topic+origin">origin</a>()</code>,
<code><a href="#topic+plot+2Cvalidator-method">plot,validator-method</a></code>,
<code><a href="#topic+summary">summary</a>()</code>,
<code><a href="#topic+variables">variables</a>()</code>,
<code><a href="#topic+voptions">voptions</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# retrieve properties
v &lt;- validator(turnover &gt; 0, staff.costs&gt;0)

# number of rules in v:
length(v)

# per-rule
created(v)
origin(v)
names(v)

# set properties
names(v)[1] &lt;- "p1"

label(v)[1] &lt;- "turnover positive"
description(v)[1] &lt;- "
According to the official definition,
only positive values can be considered
valid turnovers.
"

# short description is also printed:
v

# print all info for first rule
v[[1]]



# retrieve properties
v &lt;- validator(turnover &gt; 0, staff.costs&gt;0)

# number of rules in v:
length(v)

# per-rule
created(v)
origin(v)
names(v)

# set properties
names(v)[1] &lt;- "p1"

label(v)[1] &lt;- "turnover positive"
description(v)[1] &lt;- "
According to the official definition,
only positive values can be considered
valid turnovers.
"

# short description is also printed:
v

# print all info for first rule
v[[1]]


</code></pre>

<hr>
<h2 id='do_by'>split-apply-combine for vectors, with equal-length outptu</h2><span id='topic+do_by'></span><span id='topic+sum_by'></span><span id='topic+mean_by'></span><span id='topic+min_by'></span><span id='topic+max_by'></span>

<h3>Description</h3>

<p>Group <code>x</code> by one or more categorical variables, compute
an aggregate, repeat that aggregate to match the size of the
group, and combine results. The functions <code>sum_by</code> and 
so on are convenience wrappers that call <code>do_by</code> internally.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>do_by(x, by, fun, ...)

sum_by(x, by, na.rm = FALSE)

mean_by(x, by, na.rm = FALSE)

min_by(x, by, na.rm = FALSE)

max_by(x, by, na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="do_by_+3A_x">x</code></td>
<td>
<p>A bare variable name</p>
</td></tr>
<tr><td><code id="do_by_+3A_by">by</code></td>
<td>
<p>a bare variable name, or a list of bare variable names, used to
split <code>x</code> into groups.</p>
</td></tr>
<tr><td><code id="do_by_+3A_fun">fun</code></td>
<td>
<p><code>[function]</code> A function that aggregates <code>x</code> to a single value.</p>
</td></tr>
<tr><td><code id="do_by_+3A_...">...</code></td>
<td>
<p>passed as extra arguments to <code>fun</code> (e.g. <code>na.rm=TRUE</code></p>
</td></tr>
<tr><td><code id="do_by_+3A_na.rm">na.rm</code></td>
<td>
<p>Toggle ignoring <code>NA</code></p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other cross-record-helpers: 
<code><a href="#topic+contains_exactly">contains_exactly</a>()</code>,
<code><a href="#topic+exists_any">exists_any</a>()</code>,
<code><a href="#topic+hb">hb</a>()</code>,
<code><a href="#topic+hierarchy">hierarchy</a>()</code>,
<code><a href="#topic+is_complete">is_complete</a>()</code>,
<code><a href="#topic+is_linear_sequence">is_linear_sequence</a>()</code>,
<code><a href="#topic+is_unique">is_unique</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- 1:10
y &lt;- rep(letters[1:2], 5)
do_by(x, by=y, fun=max)
do_by(x, by=y, fun=sum)

</code></pre>

<hr>
<h2 id='errors'>Get messages from  a confrontation object</h2><span id='topic+errors'></span><span id='topic+errors+2Cconfrontation-method'></span><span id='topic+warnings+2Cconfrontation-method'></span>

<h3>Description</h3>

<p>Get messages from  a confrontation object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>errors(x, ...)

## S4 method for signature 'confrontation'
errors(x, ...)

## S4 method for signature 'confrontation'
warnings(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="errors_+3A_x">x</code></td>
<td>
<p>An object of class <code><a href="#topic+confrontation">confrontation</a></code></p>
</td></tr>
<tr><td><code id="errors_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to other methods.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other confrontation-methods: 
<code><a href="#topic++5B+2Cexpressionset-method">[,expressionset-method</a></code>,
<code><a href="#topic+as.data.frame+2Cconfrontation-method">as.data.frame,confrontation-method</a></code>,
<code><a href="#topic+confront">confront</a>()</code>,
<code><a href="#topic+confrontation-class">confrontation-class</a></code>,
<code><a href="#topic+event">event</a>()</code>,
<code><a href="#topic+keyset">keyset</a>()</code>,
<code><a href="#topic+length+2Cexpressionset-method">length,expressionset-method</a></code>,
<code><a href="#topic+values">values</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# create an error, by using a non-existent variable name
cf &lt;- check_that(women, hite &gt; 0, weight &gt; 0)
# retrieve error messages
errors(cf)


</code></pre>

<hr>
<h2 id='event'>Get or set event information metadata from a 'confrontation' object.</h2><span id='topic+event'></span><span id='topic+event+3C-'></span><span id='topic+event+2Cconfrontation-method'></span><span id='topic+event+3C-+2Cconfrontation-method'></span>

<h3>Description</h3>

<p>The purpose of event information is to store information that allows for
identification of the confronting event.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>event(x)

event(x) &lt;- value

## S4 method for signature 'confrontation'
event(x)

## S4 replacement method for signature 'confrontation'
event(x) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="event_+3A_x">x</code></td>
<td>
<p>an object of class <code>confrontation</code></p>
</td></tr>
<tr><td><code id="event_+3A_value">value</code></td>
<td>
<p><code>[character]</code> vector of length 4 with event identifiers.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A a character vector with elements
<code>"agent"</code>, which defaults to the R version and platform returned by
<code>R.version</code>, a timestamp (<code>"time"</code>)  in ISO 8601 format and a
<code>"actor"</code> which is the user name returned by <code>Sys.info()</code>. The
last element is called <code>"trigger"</code> (default <code>NA_character_</code>), which
can be used to administrate the event that triggered the confrontation.
</p>


<h3>References</h3>

<p>Mark van der Loo and Olav ten Bosch (2017) 
<a href="https://markvanderloo.eu/files/share/loo2017design.pdf">Design of a generic machine-readable validation report structure</a>, 
version 1.0.0.
</p>


<h3>See Also</h3>

<p>Other confrontation-methods: 
<code><a href="#topic++5B+2Cexpressionset-method">[,expressionset-method</a></code>,
<code><a href="#topic+as.data.frame+2Cconfrontation-method">as.data.frame,confrontation-method</a></code>,
<code><a href="#topic+confront">confront</a>()</code>,
<code><a href="#topic+confrontation-class">confrontation-class</a></code>,
<code><a href="#topic+errors">errors</a>()</code>,
<code><a href="#topic+keyset">keyset</a>()</code>,
<code><a href="#topic+length+2Cexpressionset-method">length,expressionset-method</a></code>,
<code><a href="#topic+values">values</a>()</code>
</p>
<p>Other validation-methods: 
<code><a href="#topic+aggregate+2Cvalidation-method">aggregate,validation-method</a></code>,
<code><a href="#topic+all+2Cvalidation-method">all,validation-method</a></code>,
<code><a href="#topic+any+2Cvalidation-method">any,validation-method</a></code>,
<code><a href="#topic+barplot+2Cvalidation-method">barplot,validation-method</a></code>,
<code><a href="#topic+check_that">check_that</a>()</code>,
<code><a href="#topic+compare">compare</a>()</code>,
<code><a href="#topic+confront">confront</a>()</code>,
<code><a href="#topic+names+3C-+2Crule+2Ccharacter-method">names&lt;-,rule,character-method</a></code>,
<code><a href="#topic+plot+2Cvalidation-method">plot,validation-method</a></code>,
<code><a href="#topic+sort+2Cvalidation-method">sort,validation-method</a></code>,
<code><a href="#topic+summary">summary</a>()</code>,
<code><a href="#topic+validation-class">validation-class</a></code>,
<code><a href="#topic+values">values</a>()</code>
</p>
<p>Other indication-methods: 
<code><a href="#topic+confront">confront</a>()</code>,
<code><a href="#topic+indication-class">indication-class</a></code>,
<code><a href="#topic+summary">summary</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(retailers)
rules &lt;- validator(turnover &gt;= 0, staff &gt;=0)
cf &lt;- confront(retailers, rules)
event(cf)

# adapt event information
u &lt;- event(cf)
u["trigger"] &lt;- "spontaneous validation"
event(cf) &lt;- u
event(cf)

</code></pre>

<hr>
<h2 id='exists_any'>Test for (unique) existence</h2><span id='topic+exists_any'></span><span id='topic+exists_one'></span>

<h3>Description</h3>

<p>Group records according to (zero or more) classifying variables.  Test for
each group whether at least one (<code>exists</code>) or precisely one
(<code>exists_one</code>) record satisfies a condition.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exists_any(rule, by = NULL, na.rm = FALSE)

exists_one(rule, by = NULL, na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="exists_any_+3A_rule">rule</code></td>
<td>
<p><code>[expression]</code> A validation rule</p>
</td></tr>
<tr><td><code id="exists_any_+3A_by">by</code></td>
<td>
<p>A bare (unquoted) variable name or a list of bare variable
names, that will be used to group the data.</p>
</td></tr>
<tr><td><code id="exists_any_+3A_na.rm">na.rm</code></td>
<td>
<p><code>[logical]</code> Toggle to ignore results that yield <code>NA</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>logical</code> vector, with the same number of entries as there
are rows in the entire data under scrutiny. If a test fails, all records in
the group are labeled with <code>FALSE</code>.
</p>


<h3>See Also</h3>

<p>Other cross-record-helpers: 
<code><a href="#topic+contains_exactly">contains_exactly</a>()</code>,
<code><a href="#topic+do_by">do_by</a>()</code>,
<code><a href="#topic+hb">hb</a>()</code>,
<code><a href="#topic+hierarchy">hierarchy</a>()</code>,
<code><a href="#topic+is_complete">is_complete</a>()</code>,
<code><a href="#topic+is_linear_sequence">is_linear_sequence</a>()</code>,
<code><a href="#topic+is_unique">is_unique</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Test whether each household has exactly one 'head of household'

dd &lt;- data.frame(
   hhid   = c(1,  1,  2,  1,  2,  2,  3 )
 , person = c(1,  2,  3,  4,  5,  6,  7 )
 , hhrole = c("h","h","m","m","h","m","m")
)
v &lt;- validator(exists_one(hhrole=="h", hhid))
values(confront(dd, v))

# same, but now with missing value in the data
dd &lt;- data.frame(
    hhid   = c(1,  1,  2,  1,  2,  2,  3 )
  , person = c(1,  2,  3,  4,  5,  6,  7 )
  , hhrole = c("h",NA,"m","m","h","m","h")
)
values(confront(dd, v))

# same, but now we ignore the missing values
v &lt;- validator(exists_one(hhrole=="h", hhid, na.rm=TRUE))
values(confront(dd, v))

</code></pre>

<hr>
<h2 id='export_yaml'>Export to yaml file</h2><span id='topic+export_yaml'></span><span id='topic+as_yaml'></span><span id='topic+export_yaml+2Cexpressionset-method'></span><span id='topic+as_yaml+2Cexpressionset-method'></span>

<h3>Description</h3>

<p>Translate an object to yaml format and write to file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>export_yaml(x, file, ...)

as_yaml(x, ...)

## S4 method for signature 'expressionset'
export_yaml(x, file, ...)

## S4 method for signature 'expressionset'
as_yaml(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="export_yaml_+3A_x">x</code></td>
<td>
<p>An R object</p>
</td></tr>
<tr><td><code id="export_yaml_+3A_file">file</code></td>
<td>
<p>A file location or connection (passed to <code>base::<a href="base.html#topic+write">write</a></code>).</p>
</td></tr>
<tr><td><code id="export_yaml_+3A_...">...</code></td>
<td>
<p>Options passed to <code>yaml::<a href="yaml.html#topic+as.yaml">as.yaml</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Both <code><a href="#topic+validator">validator</a></code> and <code><a href="#topic+indicator">indicator</a></code> objects can be
exported.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
v &lt;- validator(x &gt; 0, y &gt; 0, x + y == z)
txt &lt;- as_yaml(v)
cat(txt)


# NOTE: you can safely run the code below. It is enclosed in 'not run'
# statements to prevent the code from being run at test-time on CRAN
## Not run: 
export_yaml(v, file="my_rules.txt")

## End(Not run)

</code></pre>

<hr>
<h2 id='expr'>Get expressions</h2><span id='topic+expr'></span><span id='topic+expr+2Crule-method'></span>

<h3>Description</h3>

<p>Get expressions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expr(x, ...)

## S4 method for signature 'rule'
expr(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="expr_+3A_x">x</code></td>
<td>
<p>Object</p>
</td></tr>
<tr><td><code id="expr_+3A_...">...</code></td>
<td>
<p>options to be passed to other functions</p>
</td></tr>
</table>

<hr>
<h2 id='expressionset-class'>Superclass for storing a set of rich expressions.</h2><span id='topic+expressionset-class'></span><span id='topic+expressionset'></span>

<h3>Description</h3>

<p>Superclass for storing a set of rich expressions.
</p>


<h3>Details</h3>

<p>This class is aimed at developers of this package or packages depending on
it, not at users. It is the parent object of both the <code><a href="#topic+validator">validator</a></code>
and the <code><a href="#topic+indicator">indicator</a></code> class.
</p>
<p>An <code>expressionset</code> is a reference class storing a list of
<code><a href="#topic+rule">rule</a></code>s. It contains a number of methods that are not exported
and may change or dissapear without notice. We strongly encourage developers
to use the exported S4 generics to set or extract variables
</p>


<h3>Exported S4 methods for <code>expressionset</code></h3>


<ul>
<li><p><code><a href="#topic+variables">variables</a></code>
</p>
</li>
<li><p><code><a href="base.html#topic+names">names</a></code>
</p>
</li>
<li><p><code><a href="#topic+length+2Cexpressionset-method">length,expressionset-method</a></code>
</p>
</li>
<li><p><code><a href="#topic+created">created</a></code>
</p>
</li>
<li><p><code><a href="#topic+origin">origin</a></code>
</p>
</li>
<li><p><code><a href="base.html#topic+labels">labels</a></code>
</p>
</li>
<li><p><code><a href="#topic+description">description</a></code>
</p>
</li>
<li><p><code><a href="#topic++5B+2Cexpressionset-method">[,expressionset-method</a></code>
</p>
</li>
<li><p><code><a href="#topic++5B+5B+2Cexpressionset-method">[[,expressionset-method</a></code>
</p>
</li>
<li><p><code><a href="#topic+summary+2Cexpressionset-method">summary,expressionset-method</a></code>
</p>
</li></ul>



<h3>Private S4 methods for <code>expressionset</code></h3>


<ul>
<li><p>validating
</p>
</li>
<li><p>linear
</p>
</li>
<li><p>is_tran_assign
</p>
</li></ul>



<h3>See also</h3>


<ul>
<li><p><code><a href="#topic+rule">rule</a></code>
</p>
</li>
<li><p><code><a href="#topic+validator">validator</a></code>
</p>
</li>
<li><p><code><a href="#topic+indicator">indicator</a></code>
</p>
</li></ul>


<hr>
<h2 id='field_format'>Check whether a field conforms to a regular expression</h2><span id='topic+field_format'></span>

<h3>Description</h3>

<p>A convenience wrapper around <code>grepl</code> to make rule sets more readable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>field_format(x, pattern, type = c("glob", "regex"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="field_format_+3A_x">x</code></td>
<td>
<p>Bare (unquoted) name of a variable. 
Otherwise a vector of class <code>character</code>. Coerced to character as 
necessary.</p>
</td></tr>
<tr><td><code id="field_format_+3A_pattern">pattern</code></td>
<td>
<p><code>[character]</code> a regular expression</p>
</td></tr>
<tr><td><code id="field_format_+3A_type">type</code></td>
<td>
<p><code>[character]</code> How to interpret <code>pattern</code>. In globbing,
the asterisk (&lsquo;*') is used as a wildcard that stands for &rsquo;zero or more
characters'.</p>
</td></tr>
<tr><td><code id="field_format_+3A_...">...</code></td>
<td>
<p>passed to grepl</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other format-checkers: 
<code><a href="#topic+field_length">field_length</a>()</code>,
<code><a href="#topic+number_format">number_format</a>()</code>
</p>

<hr>
<h2 id='field_length'>Check number of code points</h2><span id='topic+field_length'></span>

<h3>Description</h3>

<p>A convenience function testing for field length.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>field_length(x, n = NULL, min = NULL, max = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="field_length_+3A_x">x</code></td>
<td>
<p>Bare (unquoted) name of a variable. 
Otherwise a vector of class <code>character</code>. Coerced to character as 
necessary.</p>
</td></tr>
<tr><td><code id="field_length_+3A_n">n</code></td>
<td>
<p>Number of code points required.</p>
</td></tr>
<tr><td><code id="field_length_+3A_min">min</code></td>
<td>
<p>Mimimum number of code points</p>
</td></tr>
<tr><td><code id="field_length_+3A_max">max</code></td>
<td>
<p>Maximum number of code points</p>
</td></tr>
<tr><td><code id="field_length_+3A_...">...</code></td>
<td>
<p>passed to <code>nchar</code> (for example <code>type="width"</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>[logical]</code> of size <code>length(x)</code>.
</p>


<h3>Details</h3>

<p>The number of code points (string length) may depend on current locale
settings or encoding issues, including those caused by inconsistent choices
of <code>UTF</code> normalization.
</p>


<h3>See Also</h3>

<p>Other format-checkers: 
<code><a href="#topic+field_format">field_format</a>()</code>,
<code><a href="#topic+number_format">number_format</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
df &lt;- data.frame(id = 11001:11003, year = c("2018","2019","2020"), value = 1:3)
rule &lt;- validator(field_length(year, 4), field_length(id, 5))
out &lt;- confront(df, rule) 
as.data.frame(out)

</code></pre>

<hr>
<h2 id='hb'>Hiridoglu-Berthelot function</h2><span id='topic+hb'></span>

<h3>Description</h3>

<p>A function to measure &lsquo;outlierness&rsquo; for skew distributed data with long
right tails. The method works by measuring deviation from a reference
value, by default the median. Deviation from above is measured as the
ratio between observed and refence values. Deviation from below is
measured as the inverse: the ratio between reference value and 
observed values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hb(x, ref = stats::median, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hb_+3A_x">x</code></td>
<td>
<p><code>[numeric]</code></p>
</td></tr>
<tr><td><code id="hb_+3A_ref">ref</code></td>
<td>
<p><code>[function]</code> or <code>[numeric]</code></p>
</td></tr>
<tr><td><code id="hb_+3A_...">...</code></td>
<td>
<p>arguments passed to <code>ref</code> after <code>x</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p><code class="reqn">\max\{x/ref(x), ref(x)/x\}-1</code> if <code>ref</code> is a function,
otherwise <code class="reqn">\max\{x/ref, ref/x\}-1</code>
</p>


<h3>References</h3>

<p>Hidiroglou, M. A., &amp; Berthelot, J. M. (1986). Statistical editing and
imputation for periodic business surveys. Survey methodology, 12(1), 73-83.
</p>


<h3>See Also</h3>

<p>Other cross-record-helpers: 
<code><a href="#topic+contains_exactly">contains_exactly</a>()</code>,
<code><a href="#topic+do_by">do_by</a>()</code>,
<code><a href="#topic+exists_any">exists_any</a>()</code>,
<code><a href="#topic+hierarchy">hierarchy</a>()</code>,
<code><a href="#topic+is_complete">is_complete</a>()</code>,
<code><a href="#topic+is_linear_sequence">is_linear_sequence</a>()</code>,
<code><a href="#topic+is_unique">is_unique</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- seq(1,20,by=0.1)
plot(x,hb(x), 'l')

</code></pre>

<hr>
<h2 id='hierarchy'>Check aggregates defined by a hierarchical code list</h2><span id='topic+hierarchy'></span>

<h3>Description</h3>

<p>Check all aggregates defined by a code hierarchy.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hierarchy(
  values,
  labels,
  hierarchy,
  by = NULL,
  tol = 1e-08,
  na_value = TRUE,
  aggregator = sum,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hierarchy_+3A_values">values</code></td>
<td>
<p>bare (unquoted) name of a variable that holds values that
must aggregate according to the <code>hierarchy</code>.</p>
</td></tr>
<tr><td><code id="hierarchy_+3A_labels">labels</code></td>
<td>
<p>bare (unquoted) name of variable holding a grouping variable (a code
from a hierarchical code list)</p>
</td></tr>
<tr><td><code id="hierarchy_+3A_hierarchy">hierarchy</code></td>
<td>
<p><code>[data.frame]</code> defining a hierarchical code list. The
first column must contain (child) codes, and the second column contains their
corresponding parents.</p>
</td></tr>
<tr><td><code id="hierarchy_+3A_by">by</code></td>
<td>
<p>A bare (unquoted) variable or list of variable names that occur in
the data under scrutiny. The data will be split into groups according 
to these variables and the check is performed on each group.</p>
</td></tr>
<tr><td><code id="hierarchy_+3A_tol">tol</code></td>
<td>
<p><code>[numeric]</code> tolerance for equality checking</p>
</td></tr>
<tr><td><code id="hierarchy_+3A_na_value">na_value</code></td>
<td>
<p><code>[logical]</code> or <code>NA</code>. Value assigned to values that
do not occurr in checks.</p>
</td></tr>
<tr><td><code id="hierarchy_+3A_aggregator">aggregator</code></td>
<td>
<p><code>[function]</code> that aggregates children to their parents.</p>
</td></tr>
<tr><td><code id="hierarchy_+3A_...">...</code></td>
<td>
<p>arguments passed to <code>aggregator</code> (e.g. <code>na.rm=TRUE</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>logical</code> vector with the size of <code>length(values)</code>. Every
element involved in an aggregation error is labeled <code>FALSE</code> (aggregate
plus aggregated elements). Elements that are involved in correct
aggregations are set to <code>TRUE</code>, elements that are not involved in 
any check get the value <code>na_value</code> (by default: <code>TRUE</code>).
</p>


<h3>See Also</h3>

<p>Other cross-record-helpers: 
<code><a href="#topic+contains_exactly">contains_exactly</a>()</code>,
<code><a href="#topic+do_by">do_by</a>()</code>,
<code><a href="#topic+exists_any">exists_any</a>()</code>,
<code><a href="#topic+hb">hb</a>()</code>,
<code><a href="#topic+is_complete">is_complete</a>()</code>,
<code><a href="#topic+is_linear_sequence">is_linear_sequence</a>()</code>,
<code><a href="#topic+is_unique">is_unique</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># We check some data against the built-in NACE revision 2 classification.
data(nace_rev2)
head(nace_rev2[1:4]) # columns 3 and 4 contain the child-parent relations.

d &lt;- data.frame(
     nace   = c("01","01.1","01.11","01.12", "01.2")
   , volume = c(100 ,70    , 30    ,40     , 25    )
)
# It is possible to perform checks interactively
d$nacecheck &lt;- hierarchy(d$volume, labels = d$nace, hierarchy=nace_rev2[3:4])
# we have that "01.1" == "01.11" + "01.12", but not "01" == "01.1" +  "01.2"
print(d)

# Usage as a valiation rule is as follows
rules &lt;- validator(hierarchy(volume, labels = nace, hierarchy=validate::nace_rev_2[3:4]))
confront(d, rules)

# you can also pass a hierarchy as a reference, for example.

rules &lt;- validator(hierarchy(volume, labels = nace, hierarchy=ref$nacecodes))
out &lt;- confront(d, rules, ref=list(nacecodes=nace_rev2[3:4]))
summary(out)

# set a output to NA when a code does not occur in the code list.
d &lt;- data.frame(
     nace   = c("01","01.1","01.11","01.12", "01.2", "foo")
   , volume = c(100 ,70    , 30    ,40     , 25     , 60)
)

d$nacecheck &lt;- hierarchy(d$volume, labels = d$nace, hierarchy=nace_rev2[3:4]
                         , na_value = NA)
# we have that "01.1" == "01.11" + "01.12", but not "01" == "01.1" +  "01.2"
print(d)

</code></pre>

<hr>
<h2 id='in_range'>Check variable range</h2><span id='topic+in_range'></span><span id='topic+in_range.default'></span><span id='topic+in_range.character'></span>

<h3>Description</h3>

<p>Test wether a variable falls within a range.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>in_range(x, min, max, ...)

## Default S3 method:
in_range(x, min, max, strict = FALSE, ...)

## S3 method for class 'character'
in_range(x, min, max, strict = FALSE, format = "auto", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="in_range_+3A_x">x</code></td>
<td>
<p>A bare (unquoted) variable name.</p>
</td></tr>
<tr><td><code id="in_range_+3A_min">min</code></td>
<td>
<p>lower bound</p>
</td></tr>
<tr><td><code id="in_range_+3A_max">max</code></td>
<td>
<p>upper bound</p>
</td></tr>
<tr><td><code id="in_range_+3A_...">...</code></td>
<td>
<p>arguments passed to other methods</p>
</td></tr>
<tr><td><code id="in_range_+3A_strict">strict</code></td>
<td>
<p><code>[logical]</code> Toggle between including the range boundaries
(default) or not including them (when strict=TRUE).</p>
</td></tr>
<tr><td><code id="in_range_+3A_format">format</code></td>
<td>
<p><code>[character]</code> of <code>NULL</code>. If <code>format=NULL</code> the
character vector is interpreted as is. And the whether a character lies
within a character range is determined by the collation order set by the
current locale. See the details of &quot;<code><a href="base.html#topic++3C">&lt;</a></code>&quot;.  If <code>format</code> is
not <code>NULL</code>, it specifies how to interpret the character vector as a
time period.  It can take the value <code>"auto"</code> for automatic detection or
a specification passed to <code><a href="base.html#topic+strptime">strptime</a></code>. Automatically detected
periods are of the form year: <code>"2020"</code>, yearMmonth: <code>"2020M01"</code>,
yearQquarter: <code>"2020Q3"</code>, or year-Qquarter: <code>"2020-Q3"</code>.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
d &lt;- data.frame(
   number = c(3,-2,6)
 , time   = as.Date(c("2018-02-01", "2018-03-01", "2018-04-01"))
 , period = c("2020Q1", "2021Q2", "2020Q3") 
)

rules &lt;- validator(
   in_range(number, min=-2, max=7, strict=TRUE)
 , in_range(time,   min=as.Date("2017-01-01"), max=as.Date("2018-12-31"))
 , in_range(period, min="2020Q1", max="2020Q4")
)

result &lt;- confront(d, rules)
values(result)


</code></pre>

<hr>
<h2 id='indication-class'>Store results of evaluating indicators</h2><span id='topic+indication-class'></span><span id='topic+indication'></span>

<h3>Description</h3>

<p><b>This feature is currently experimental and may change in the future</b>
</p>


<h3>Details</h3>

<p>An <code>indication</code> stores a set of results generated by evaluating
an <code><a href="#topic+indicator">indicator</a></code> in the context of data along with some metadata.
</p>


<h3>Exported S4 methods for <code>indication</code></h3>


<ul>
<li><p>Methods exported for objects of class <code><a href="#topic+confrontation">confrontation</a></code>
</p>
</li>
<li><p><code><a href="#topic+summary+2Cindication-method">summary,indication-method</a></code>
</p>
</li>
<li><p><code><a href="#topic+values+2Cindication-method">values,indication-method</a></code>
</p>
</li></ul>



<h3>See also</h3>


<ul>
<li><p><code><a href="#topic+confront">confront</a></code>
</p>
</li>
<li><p><code><a href="#topic+validation-class">validation-class</a></code>
</p>
</li></ul>



<h3>See Also</h3>

<p>Other indication-methods: 
<code><a href="#topic+confront">confront</a>()</code>,
<code><a href="#topic+event">event</a>()</code>,
<code><a href="#topic+summary">summary</a>()</code>
</p>

<hr>
<h2 id='indicator'>Define indicators for data</h2><span id='topic+indicator'></span>

<h3>Description</h3>

<p>An indicator maps a data frame, or each record in a data frame to a number.
The purpose of this class is to store and apply expressions that define
indicators.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>indicator(..., .file, .data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="indicator_+3A_...">...</code></td>
<td>
<p>A comma-separated list of indicator definitions</p>
</td></tr>
<tr><td><code id="indicator_+3A_.file">.file</code></td>
<td>
<p>(optional) A character vector of file locations</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+syntax">syntax</a></code>, <code><a href="#topic+add_indicators">add_indicators</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># create an indicator for the number of missing x in data set


I &lt;- indicator( 
 sum(is.na(.))               # number of missing variables
 , sum(is.na(.[c("x","y")])) # number of missing x and y
 , mean(is.na(.))            # fraction of missing variables
 , sum(x)
 , mean(x)
) 

dat &lt;- data.frame(x=1:2, y=c(NA,1))
C &lt;- confront(dat, I)
values(C)
</code></pre>

<hr>
<h2 id='indicator-class'>Store a set of rich indicator expressions</h2><span id='topic+indicator-class'></span>

<h3>Description</h3>

<p><b>This feature is currently experimental and may change in future versions</b>
</p>


<h3>Details</h3>

<p>An indicator stores a set of indicators. It is a child class of <code><a href="#topic+expressionset">expressionset</a></code> and
can be constructed with  <code><a href="#topic+indicator">indicator</a></code>.
</p>


<h3>Exported S4 methods for <code>validator</code></h3>


<ul>
<li><p>Methods inherited from <code><a href="#topic+expressionset">expressionset</a></code>
</p>
</li>
<li><p><code><a href="#topic+confront">confront</a></code>
</p>
</li>
<li><p><code><a href="#topic+compare">compare</a></code>
</p>
</li></ul>



<h3>See also</h3>


<ul>
<li><p><code><a href="#topic+expressionset">expressionset</a></code>
</p>
</li></ul>


<hr>
<h2 id='is_complete'>Test for completeness of records</h2><span id='topic+is_complete'></span><span id='topic+all_complete'></span>

<h3>Description</h3>

<p>Utility function to make common tests easier.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_complete(...)

all_complete(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is_complete_+3A_...">...</code></td>
<td>
<p>When used in a validation rule: a bare (unquoted) list of variable names.
When used directly, a comma-separated list of vectors of equal length.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>For <code>is_complete</code> A logical vector that is <code>FALSE</code> for each record
that has at least one missing value.
</p>
<p>For <code>all_unique</code> a single <code>TRUE</code> or <code>FALSE</code>.
</p>


<h3>See Also</h3>

<p>Other cross-record-helpers: 
<code><a href="#topic+contains_exactly">contains_exactly</a>()</code>,
<code><a href="#topic+do_by">do_by</a>()</code>,
<code><a href="#topic+exists_any">exists_any</a>()</code>,
<code><a href="#topic+hb">hb</a>()</code>,
<code><a href="#topic+hierarchy">hierarchy</a>()</code>,
<code><a href="#topic+is_linear_sequence">is_linear_sequence</a>()</code>,
<code><a href="#topic+is_unique">is_unique</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d &lt;- data.frame(X = c('a','b',NA,'b'), Y = c(NA,'apple','banana','apple'), Z=1:4)
v &lt;- validator(is_complete(X, Y))
values(confront(d, v))

</code></pre>

<hr>
<h2 id='is_linear_sequence'>Check whether a variable represents a linear sequence</h2><span id='topic+is_linear_sequence'></span><span id='topic+is_linear_sequence.numeric'></span><span id='topic+is_linear_sequence.Date'></span><span id='topic+is_linear_sequence.POSIXct'></span><span id='topic+is_linear_sequence.character'></span><span id='topic+in_linear_sequence'></span><span id='topic+in_linear_sequence.character'></span><span id='topic+in_linear_sequence.numeric'></span><span id='topic+in_linear_sequence.Date'></span><span id='topic+in_linear_sequence.POSIXct'></span>

<h3>Description</h3>

<p>A variable <code class="reqn">X = (x_1, x_2,\ldots, x_n)</code> (<code class="reqn">n\geq 0</code>) represents a
<em>linear sequence</em> when <code class="reqn">x_{j+1} - x_j</code> is constant for all
<code class="reqn">j\geq 1</code>. That is,  elements in the series are equidistant and without
gaps.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_linear_sequence(x, by = NULL, ...)

## S3 method for class 'numeric'
is_linear_sequence(
  x,
  by = NULL,
  begin = NULL,
  end = NULL,
  sort = TRUE,
  tol = 1e-08,
  ...
)

## S3 method for class 'Date'
is_linear_sequence(x, by = NULL, begin = NULL, end = NULL, sort = TRUE, ...)

## S3 method for class 'POSIXct'
is_linear_sequence(
  x,
  by = NULL,
  begin = NULL,
  end = NULL,
  sort = TRUE,
  tol = 1e-06,
  ...
)

## S3 method for class 'character'
is_linear_sequence(
  x,
  by = NULL,
  begin = NULL,
  end = NULL,
  sort = TRUE,
  format = "auto",
  ...
)

in_linear_sequence(x, ...)

## S3 method for class 'character'
in_linear_sequence(
  x,
  by = NULL,
  begin = NULL,
  end = NULL,
  sort = TRUE,
  format = "auto",
  ...
)

## S3 method for class 'numeric'
in_linear_sequence(
  x,
  by = NULL,
  begin = NULL,
  end = NULL,
  sort = TRUE,
  tol = 1e-08,
  ...
)

## S3 method for class 'Date'
in_linear_sequence(x, by = NULL, begin = NULL, end = NULL, sort = TRUE, ...)

## S3 method for class 'POSIXct'
in_linear_sequence(
  x,
  by = NULL,
  begin = NULL,
  end = NULL,
  sort = TRUE,
  tol = 1e-06,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is_linear_sequence_+3A_x">x</code></td>
<td>
<p>An R vector.</p>
</td></tr>
<tr><td><code id="is_linear_sequence_+3A_by">by</code></td>
<td>
<p>bare (unquoted) variable name or a list of unquoted variable names, 
used to split <code>x</code> into groups. The check is executed for each group.</p>
</td></tr>
<tr><td><code id="is_linear_sequence_+3A_...">...</code></td>
<td>
<p>Arguments passed to other methods.</p>
</td></tr>
<tr><td><code id="is_linear_sequence_+3A_begin">begin</code></td>
<td>
<p>Optionally, a value that should equal <code>min(x)</code></p>
</td></tr>
<tr><td><code id="is_linear_sequence_+3A_end">end</code></td>
<td>
<p>Optionally, a value that should equal <code>max(x)</code></p>
</td></tr>
<tr><td><code id="is_linear_sequence_+3A_sort">sort</code></td>
<td>
<p><code>[logical]</code>. When set to <code>TRUE</code>, <code>x</code>
is sorted within each group before testing.</p>
</td></tr>
<tr><td><code id="is_linear_sequence_+3A_tol">tol</code></td>
<td>
<p>numerical tolerance for gaps.</p>
</td></tr>
<tr><td><code id="is_linear_sequence_+3A_format">format</code></td>
<td>
<p><code>[character]</code>. How to interpret <code>x</code> as a time period.
Either <code>"auto"</code> for automatic detection or a specification passed to
<code><a href="base.html#topic+strptime">strptime</a></code>. Automatically detected periods are of the form year:
<code>"2020"</code>, yearMmonth: <code>"2020M01"</code>,  yearQquarter: <code>"2020Q3"</code>,
or year-Qquarter: <code>"2020-Q3"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Presence of a missing value (<code>NA</code>) in <code>x</code> will result in <code>NA</code>,
except when <code>length(x) &lt;= 2</code> and <code>start</code> and <code>end</code> are
<code>NULL</code>. Any sequence of length <code class="reqn">\leq 2</code> is a linear sequence.
</p>


<h3>Value</h3>

<p>For <code>is_linear_sequence</code>: a single <code>TRUE</code> or <code>FALSE</code>,
equal to <code>all(in_linear_sequence)</code>.
</p>
<p>For <code>in_linear_sequence</code>: a <code>logical</code> vector with the same length as <code>x</code>.
</p>


<h3>See Also</h3>

<p>Other cross-record-helpers: 
<code><a href="#topic+contains_exactly">contains_exactly</a>()</code>,
<code><a href="#topic+do_by">do_by</a>()</code>,
<code><a href="#topic+exists_any">exists_any</a>()</code>,
<code><a href="#topic+hb">hb</a>()</code>,
<code><a href="#topic+hierarchy">hierarchy</a>()</code>,
<code><a href="#topic+is_complete">is_complete</a>()</code>,
<code><a href="#topic+is_unique">is_unique</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
is_linear_sequence(1:5) # TRUE
is_linear_sequence(c(1,3,5,4,2)) # FALSE
is_linear_sequence(c(1,3,5,4,2), sort=TRUE) # TRUE 
is_linear_sequence(NA_integer_) # TRUE
is_linear_sequence(NA_integer_, begin=4) # FALSE
is_linear_sequence(c(1, NA, 3)) # FALSE


d &lt;- data.frame(
    number = c(pi, exp(1), 7)
  , date = as.Date(c("2015-12-17","2015-12-19","2015-12-21"))
  , time = as.POSIXct(c("2015-12-17","2015-12-19","2015-12-20"))
)

rules &lt;- validator(
    is_linear_sequence(number)  # fails
  , is_linear_sequence(date)    # passes
  , is_linear_sequence(time)    # fails
)
summary(confront(d,rules))

## check groupwise data
dat &lt;- data.frame(
   time = c(2012, 2013, 2012, 2013, 2015)
 , type = c("hi", "hi", "ha", "ha", "ha")
)
rule &lt;- validator(in_linear_sequence(time, by=type))
values(confront(dat, rule)) ## 2xT, 3xF


rule &lt;- validator(in_linear_sequence(time, type))
values( confront(dat, rule) )

</code></pre>

<hr>
<h2 id='is_unique'>Test for uniquenes of records</h2><span id='topic+is_unique'></span><span id='topic+all_unique'></span><span id='topic+n_unique'></span>

<h3>Description</h3>

<p>Test for uniqueness of columns or combinations of columns.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_unique(...)

all_unique(...)

n_unique(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is_unique_+3A_...">...</code></td>
<td>
<p>When used in a validation rule: a bare (unquoted) list of variable names.
When used directly, a comma-separated list of vectors of equal length.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>For <code>is_unique</code> A logical vector that is <code>FALSE</code> for each record
that has a duplicate.
</p>
<p>For <code>all_unique</code> a single <code>TRUE</code> or <code>FALSE</code>.
</p>
<p>For <code>number_unique</code> a single number representing the number
of unique values or value combinations in the arguments.
</p>


<h3>See Also</h3>

<p>Other cross-record-helpers: 
<code><a href="#topic+contains_exactly">contains_exactly</a>()</code>,
<code><a href="#topic+do_by">do_by</a>()</code>,
<code><a href="#topic+exists_any">exists_any</a>()</code>,
<code><a href="#topic+hb">hb</a>()</code>,
<code><a href="#topic+hierarchy">hierarchy</a>()</code>,
<code><a href="#topic+is_complete">is_complete</a>()</code>,
<code><a href="#topic+is_linear_sequence">is_linear_sequence</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
d &lt;- data.frame(X = c('a','b','c','b'), Y = c('banana','apple','banana','apple'), Z=1:4)
v &lt;- validator(is_unique(X, Y))
values(confront(d, v))

# example with groupwise test
df &lt;- data.frame(x=c(rep("a",3), rep("b",3)),y=c(1,1,2,1:3))
v &lt;- validator(is_unique(y, by=x))
values(confront(d,v))

</code></pre>

<hr>
<h2 id='keyset'>Get key set stored with a confrontation</h2><span id='topic+keyset'></span><span id='topic+keyset+2Cconfrontation-method'></span>

<h3>Description</h3>

<p>Get key set stored with a confrontation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>keyset(x)

## S4 method for signature 'confrontation'
keyset(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="keyset_+3A_x">x</code></td>
<td>
<p>an object of class <code>confrontation</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>If a confrontation is created with the <code>key=</code> option
set, this function returns the key set, otherwise <code>NULL</code>
</p>


<h3>See Also</h3>

<p>Other confrontation-methods: 
<code><a href="#topic++5B+2Cexpressionset-method">[,expressionset-method</a></code>,
<code><a href="#topic+as.data.frame+2Cconfrontation-method">as.data.frame,confrontation-method</a></code>,
<code><a href="#topic+confront">confront</a>()</code>,
<code><a href="#topic+confrontation-class">confrontation-class</a></code>,
<code><a href="#topic+errors">errors</a>()</code>,
<code><a href="#topic+event">event</a>()</code>,
<code><a href="#topic+length+2Cexpressionset-method">length,expressionset-method</a></code>,
<code><a href="#topic+values">values</a>()</code>
</p>

<hr>
<h2 id='label'>Rule label</h2><span id='topic+label'></span><span id='topic+label+3C-'></span><span id='topic+label+2Crule-method'></span><span id='topic+label+3C-+2Crule+2Ccharacter-method'></span><span id='topic+label+2Cexpressionset-method'></span><span id='topic+label+3C-+2Cexpressionset+2Ccharacter-method'></span>

<h3>Description</h3>

<p>A short (typically two or three word) description of a rule.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>label(x, ...)

label(x) &lt;- value

## S4 method for signature 'rule'
label(x, ...)

## S4 replacement method for signature 'rule,character'
label(x) &lt;- value

## S4 method for signature 'expressionset'
label(x, ...)

## S4 replacement method for signature 'expressionset,character'
label(x) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="label_+3A_x">x</code></td>
<td>
<p>and R object</p>
</td></tr>
<tr><td><code id="label_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to other methods</p>
</td></tr>
<tr><td><code id="label_+3A_value">value</code></td>
<td>
<p>Value to set</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>character</code> vector.
</p>


<h3>See Also</h3>

<p>Other expressionset-methods: 
<code><a href="#topic+as.data.frame">as.data.frame</a>()</code>,
<code><a href="#topic+as.data.frame+2Cexpressionset-method">as.data.frame,expressionset-method</a></code>,
<code><a href="#topic+created">created</a>()</code>,
<code><a href="#topic+description">description</a>()</code>,
<code><a href="#topic+meta">meta</a>()</code>,
<code><a href="#topic+names+3C-+2Crule+2Ccharacter-method">names&lt;-,rule,character-method</a></code>,
<code><a href="#topic+origin">origin</a>()</code>,
<code><a href="#topic+plot+2Cvalidator-method">plot,validator-method</a></code>,
<code><a href="#topic+summary">summary</a>()</code>,
<code><a href="#topic+variables">variables</a>()</code>,
<code><a href="#topic+voptions">voptions</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# retrieve properties
v &lt;- validator(turnover &gt; 0, staff.costs&gt;0)

# number of rules in v:
length(v)

# per-rule
created(v)
origin(v)
names(v)

# set properties
names(v)[1] &lt;- "p1"

label(v)[1] &lt;- "turnover positive"
description(v)[1] &lt;- "
According to the official definition,
only positive values can be considered
valid turnovers.
"

# short description is also printed:
v

# print all info for first rule
v[[1]]



# retrieve properties
v &lt;- validator(turnover &gt; 0, staff.costs&gt;0)

# number of rules in v:
length(v)

# per-rule
created(v)
origin(v)
names(v)

# set properties
names(v)[1] &lt;- "p1"

label(v)[1] &lt;- "turnover positive"
description(v)[1] &lt;- "
According to the official definition,
only positive values can be considered
valid turnovers.
"

# short description is also printed:
v

# print all info for first rule
v[[1]]


</code></pre>

<hr>
<h2 id='lbj_cells-class'>Logging object to use with the lumberjack package</h2><span id='topic+lbj_cells-class'></span><span id='topic+lbj_cells'></span>

<h3>Description</h3>

<p>Logging object to use with the lumberjack package
</p>


<h3>Format</h3>

<p>A reference class object
</p>


<h3>Methods</h3>


<dl>
<dt><code>add(meta, input, output)</code></dt><dd><p>Add logging info based on in- and output</p>
</dd>
<dt><code>dump(file = NULL, verbose = TRUE, ...)</code></dt><dd><p>Dump logging info to csv file. 
All arguments in '...' except row.names are passed to 'write.csv'</p>
</dd>
<dt><code>initialize(..., verbose = TRUE, label = "")</code></dt><dd><p>Create object. Optionally toggle verbosity.</p>
</dd>
<dt><code>log_data()</code></dt><dd><p>Return logged data as a data.frame</p>
</dd>
</dl>


<h3>Details</h3>

<p>This obeject can used with the function composition ('pipe') operator of the 
<code><a href="lumberjack.html#topic+lumberjack">lumberjack</a></code> package. The logging is based on
validate's <code><a href="#topic+cells">cells</a></code> function. The output is written to a
<code>csv</code> file wich contains the following columns.
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>step</code>           </td><td style="text-align: left;"><code>integer</code>  </td><td style="text-align: left;"> Step number  </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>time</code>           </td><td style="text-align: left;"><code>POSIXct</code>  </td><td style="text-align: left;"> Timestamp    </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>expr</code>           </td><td style="text-align: left;"><code>character</code></td><td style="text-align: left;"> Expression used on data </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>cells</code>          </td><td style="text-align: left;"><code>integer</code>  </td><td style="text-align: left;"> Total nr of cells in dataset</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>available</code>      </td><td style="text-align: left;"><code>integer</code>  </td><td style="text-align: left;"> Nr of non-NA cells</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>missing</code>        </td><td style="text-align: left;"><code>integer</code>  </td><td style="text-align: left;"> Nr of empty (NA) cells</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>still_available</code></td><td style="text-align: left;"><code>integer</code>  </td><td style="text-align: left;"> Nr of cells still available after expr</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>unadapted</code>      </td><td style="text-align: left;"><code>integer</code>  </td><td style="text-align: left;"> Nr of cells still available and unaltered</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>unadapted</code>      </td><td style="text-align: left;"><code>integer</code>  </td><td style="text-align: left;"> Nr of cells still available and altered</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>imputed</code>        </td><td style="text-align: left;"><code>integer</code>  </td><td style="text-align: left;"> Nr of cells not missing anymore</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Note</h3>

<p>This logger is suited only for operations that do not change the dimensions 
of the dataset.
</p>


<h3>See Also</h3>

<p>Other loggers: 
<code><a href="#topic+lbj_rules-class">lbj_rules-class</a></code>
</p>

<hr>
<h2 id='lbj_rules-class'>Logging object to use with the lumberjack package</h2><span id='topic+lbj_rules-class'></span><span id='topic+lbj_rules'></span>

<h3>Description</h3>

<p>Logging object to use with the lumberjack package
</p>


<h3>Methods</h3>


<dl>
<dt><code>dump(file = NULL, ...)</code></dt><dd><p>Dump logging info to csv file. 
All arguments in '...' except row.names are passed to 'write.csv'</p>
</dd>
<dt><code>initialize(rules, verbose = TRUE, label = "")</code></dt><dd><p>Create object. Optionally toggle verbosity.</p>
</dd>
<dt><code>log_data()</code></dt><dd><p>Return logged data as a data.frame</p>
</dd>
<dt><code>plot()</code></dt><dd><p>plot rule comparisons</p>
</dd>
</dl>


<h3>See Also</h3>

<p>Other loggers: 
<code><a href="#topic+lbj_cells-class">lbj_cells-class</a></code>
</p>

<hr>
<h2 id='length+2Cexpressionset-method'>Determine the number of elements in an object.</h2><span id='topic+length+2Cexpressionset-method'></span><span id='topic+length+2Cconfrontation-method'></span>

<h3>Description</h3>

<p>Determine the number of elements in an object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'expressionset'
length(x)

## S4 method for signature 'confrontation'
length(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="length+2B2Cexpressionset-method_+3A_x">x</code></td>
<td>
<p>An R object</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other confrontation-methods: 
<code><a href="#topic++5B+2Cexpressionset-method">[,expressionset-method</a></code>,
<code><a href="#topic+as.data.frame+2Cconfrontation-method">as.data.frame,confrontation-method</a></code>,
<code><a href="#topic+confront">confront</a>()</code>,
<code><a href="#topic+confrontation-class">confrontation-class</a></code>,
<code><a href="#topic+errors">errors</a>()</code>,
<code><a href="#topic+event">event</a>()</code>,
<code><a href="#topic+keyset">keyset</a>()</code>,
<code><a href="#topic+values">values</a>()</code>
</p>

<hr>
<h2 id='match_cells'>Create matching subsets of a sequence of data</h2><span id='topic+match_cells'></span>

<h3>Description</h3>

<p>Create matching subsets of a sequence of data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>match_cells(..., .list = NULL, id = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="match_cells_+3A_...">...</code></td>
<td>
<p>A sequence of <code>data.frame</code>s, possibly in the form of <code>&lt;name&gt;=&lt;value&gt;</code> pairs.</p>
</td></tr>
<tr><td><code id="match_cells_+3A_.list">.list</code></td>
<td>
<p>A list of <code>data.frame</code>s; will be concatenated with <code>...</code>.</p>
</td></tr>
<tr><td><code id="match_cells_+3A_id">id</code></td>
<td>
<p>Names or indices of columns to use as index.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of <code>data.frames</code>, subsetted and sorted so that all cells correspond.
</p>


<h3>See Also</h3>

<p>Other comparing: 
<code><a href="#topic+as.data.frame+2CcellComparison-method">as.data.frame,cellComparison-method</a></code>,
<code><a href="#topic+as.data.frame+2CvalidatorComparison-method">as.data.frame,validatorComparison-method</a></code>,
<code><a href="#topic+barplot+2CcellComparison-method">barplot,cellComparison-method</a></code>,
<code><a href="#topic+barplot+2CvalidatorComparison-method">barplot,validatorComparison-method</a></code>,
<code><a href="#topic+cells">cells</a>()</code>,
<code><a href="#topic+compare">compare</a>()</code>,
<code><a href="#topic+plot+2CcellComparison-method">plot,cellComparison-method</a></code>,
<code><a href="#topic+plot+2CvalidatorComparison-method">plot,validatorComparison-method</a></code>
</p>

<hr>
<h2 id='meta'>Get or set rule metadata</h2><span id='topic+meta'></span><span id='topic+meta+3C-'></span><span id='topic+meta+2Crule-method'></span><span id='topic+meta+3C-+2Crule+2Ccharacter-method'></span><span id='topic+meta+2Cexpressionset-method'></span><span id='topic+meta+3C-+2Cexpressionset+2Ccharacter-method'></span>

<h3>Description</h3>

<p>Rule metadata are key-value pairs where the value is a simple (atomic)
string or number.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>meta(x, ...)

meta(x, name) &lt;- value

## S4 method for signature 'rule'
meta(x, ...)

## S4 replacement method for signature 'rule,character'
meta(x, name) &lt;- value

## S4 method for signature 'expressionset'
meta(x, simplify = TRUE, ...)

## S4 replacement method for signature 'expressionset,character'
meta(x, name) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="meta_+3A_x">x</code></td>
<td>
<p>an R object</p>
</td></tr>
<tr><td><code id="meta_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to other methods</p>
</td></tr>
<tr><td><code id="meta_+3A_name">name</code></td>
<td>
<p><code>[character]</code> metadata key</p>
</td></tr>
<tr><td><code id="meta_+3A_value">value</code></td>
<td>
<p>Value to set</p>
</td></tr>
<tr><td><code id="meta_+3A_simplify">simplify</code></td>
<td>
<p>Gather all metadata into a dataframe?</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other expressionset-methods: 
<code><a href="#topic+as.data.frame">as.data.frame</a>()</code>,
<code><a href="#topic+as.data.frame+2Cexpressionset-method">as.data.frame,expressionset-method</a></code>,
<code><a href="#topic+created">created</a>()</code>,
<code><a href="#topic+description">description</a>()</code>,
<code><a href="#topic+label">label</a>()</code>,
<code><a href="#topic+names+3C-+2Crule+2Ccharacter-method">names&lt;-,rule,character-method</a></code>,
<code><a href="#topic+origin">origin</a>()</code>,
<code><a href="#topic+plot+2Cvalidator-method">plot,validator-method</a></code>,
<code><a href="#topic+summary">summary</a>()</code>,
<code><a href="#topic+variables">variables</a>()</code>,
<code><a href="#topic+voptions">voptions</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
v &lt;- validator(x &gt; 0, y &gt; 0)

# metadata is recycled over rules
meta(v,"foo") &lt;- "bar" 

# assign metadata to a selection of rules
meta(v[1],"fu") &lt;- 2

# retrieve metadata as data.frame
meta(v)

# retrieve metadata as list
meta(v,simplify=TRUE)

</code></pre>

<hr>
<h2 id='nace_rev2'>NACE classification code table</h2><span id='topic+nace_rev2'></span>

<h3>Description</h3>

<p>Statistical Classification of Economic Activities. 
</p>
 
<ul>
<li><p> Order <code>[integer]</code>
</p>
</li>
<li><p> Level <code>[integer]</code> NACE level
</p>
</li>
<li><p> Code  <code>[character]</code> NACE code
</p>
</li>
<li><p> Parent <code>[character]</code> parent code of <code>"Code"</code>
</p>
</li>
<li><p> Description <code>[character]</code>
</p>
</li>
<li><p> This_item_includes <code>[character]</code>
</p>
</li>
<li><p> This_item_also_includes <code>[character]</code>
</p>
</li>
<li><p> Rulings <code>[character]</code>
</p>
</li>
<li><p> This_item_excludes <code>[character]</code>
</p>
</li>
<li><p> Reference_to_ISIC_Rev._4 <code>[character]</code>
</p>
</li></ul>



<h3>Format</h3>

<p>A csv file, one NACE code per row.
</p>


<h3>References</h3>

<p>This codelist was downloaded on 2020-10-21 from 
<a href="https://ec.europa.eu/eurostat/ramon/nomenclatures/index.cfm?TargetUrl=LST_CLS_DLD&amp;StrNom=NACE_REV2&amp;StrLanguageCode=EN&amp;StrLayoutCode=HIERARCHIC#">Eurostat</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+hierarchy">hierarchy</a></code>
</p>
<p>Other datasets: 
<code><a href="#topic+retailers">retailers</a></code>,
<code><a href="#topic+samplonomy">samplonomy</a></code>
</p>

<hr>
<h2 id='names+26lt+3B-+2Crule+2Ccharacter-method'>Extract or set names</h2><span id='topic+names+3C-+2Crule+2Ccharacter-method'></span><span id='topic+names+2Cexpressionset-method'></span><span id='topic+names+3C-+2Cexpressionset+2Ccharacter-method'></span><span id='topic+names+2Cconfrontation-method'></span>

<h3>Description</h3>

<p>Extract or set names
</p>
<p>When setting names, <code>value</code>s are recycled and made unique with
<code><a href="base.html#topic+make.names">make.names</a></code>
</p>
<p>Get names from <code>confrontation</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 replacement method for signature 'rule,character'
names(x) &lt;- value

## S4 method for signature 'expressionset'
names(x)

## S4 replacement method for signature 'expressionset,character'
names(x) &lt;- value

## S4 method for signature 'confrontation'
names(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="names+2B26lt+2B3B-+2B2Crule+2B2Ccharacter-method_+3A_x">x</code></td>
<td>
<p>An R object</p>
</td></tr>
<tr><td><code id="names+2B26lt+2B3B-+2B2Crule+2B2Ccharacter-method_+3A_value">value</code></td>
<td>
<p>Value to set</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>character</code> vector
</p>


<h3>See Also</h3>

<p>Other expressionset-methods: 
<code><a href="#topic+as.data.frame">as.data.frame</a>()</code>,
<code><a href="#topic+as.data.frame+2Cexpressionset-method">as.data.frame,expressionset-method</a></code>,
<code><a href="#topic+created">created</a>()</code>,
<code><a href="#topic+description">description</a>()</code>,
<code><a href="#topic+label">label</a>()</code>,
<code><a href="#topic+meta">meta</a>()</code>,
<code><a href="#topic+origin">origin</a>()</code>,
<code><a href="#topic+plot+2Cvalidator-method">plot,validator-method</a></code>,
<code><a href="#topic+summary">summary</a>()</code>,
<code><a href="#topic+variables">variables</a>()</code>,
<code><a href="#topic+voptions">voptions</a>()</code>
</p>
<p>Other validation-methods: 
<code><a href="#topic+aggregate+2Cvalidation-method">aggregate,validation-method</a></code>,
<code><a href="#topic+all+2Cvalidation-method">all,validation-method</a></code>,
<code><a href="#topic+any+2Cvalidation-method">any,validation-method</a></code>,
<code><a href="#topic+barplot+2Cvalidation-method">barplot,validation-method</a></code>,
<code><a href="#topic+check_that">check_that</a>()</code>,
<code><a href="#topic+compare">compare</a>()</code>,
<code><a href="#topic+confront">confront</a>()</code>,
<code><a href="#topic+event">event</a>()</code>,
<code><a href="#topic+plot+2Cvalidation-method">plot,validation-method</a></code>,
<code><a href="#topic+sort+2Cvalidation-method">sort,validation-method</a></code>,
<code><a href="#topic+summary">summary</a>()</code>,
<code><a href="#topic+validation-class">validation-class</a></code>,
<code><a href="#topic+values">values</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# retrieve properties
v &lt;- validator(turnover &gt; 0, staff.costs&gt;0)

# number of rules in v:
length(v)

# per-rule
created(v)
origin(v)
names(v)

# set properties
names(v)[1] &lt;- "p1"

label(v)[1] &lt;- "turnover positive"
description(v)[1] &lt;- "
According to the official definition,
only positive values can be considered
valid turnovers.
"

# short description is also printed:
v

# print all info for first rule
v[[1]]



# retrieve properties
v &lt;- validator(turnover &gt; 0, staff.costs&gt;0)

# number of rules in v:
length(v)

# per-rule
created(v)
origin(v)
names(v)

# set properties
names(v)[1] &lt;- "p1"

label(v)[1] &lt;- "turnover positive"
description(v)[1] &lt;- "
According to the official definition,
only positive values can be considered
valid turnovers.
"

# short description is also printed:
v

# print all info for first rule
v[[1]]


</code></pre>

<hr>
<h2 id='number_format'>Check the layouts of numbers.</h2><span id='topic+number_format'></span>

<h3>Description</h3>

<p>Convenience function to check layout of numbers stored as
a character vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>number_format(x, format = NULL, min_dig = NULL, max_dig = NULL, dec = ".")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="number_format_+3A_x">x</code></td>
<td>
<p><code>[character]</code> vector. If <code>x</code> is not of type
<code>character</code> it will be converted.</p>
</td></tr>
<tr><td><code id="number_format_+3A_format">format</code></td>
<td>
<p><code>[character]</code> denoting the number format (see below).</p>
</td></tr>
<tr><td><code id="number_format_+3A_min_dig">min_dig</code></td>
<td>
<p><code>[numeric]</code> minimal number of digits after decimal separator.</p>
</td></tr>
<tr><td><code id="number_format_+3A_max_dig">max_dig</code></td>
<td>
<p><code>[numeric]</code> maximum number of digits after decimal separator.</p>
</td></tr>
<tr><td><code id="number_format_+3A_dec">dec</code></td>
<td>
<p><code>[character]</code> decimal seperator.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>format</code> is specified, then <code>min_dig</code>, <code>max_dig</code> and <code>dec</code>
are ignored.
</p>
<p>Numerical formats can be specified as a sequence of characters. There are a few 
special characters:
</p>

<ul>
<li><p><code>d</code> Stands for digit.
</p>
</li>
<li><p><code>*</code> (digit globbing) zero or more digits
</p>
</li></ul>

<p>Here are some examples.
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>"d.dd"</code>   </td><td style="text-align: left;"> One digit, a decimal point followed by two digits.</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"d.ddddddddEdd"</code></td><td style="text-align: left;"> Scientific notation with eight digits behind the decimal point.</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"0.ddddddddEdd"</code></td><td style="text-align: left;"> Same, but starting with a zero.</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"d,dd*"</code> </td><td style="text-align: left;"> one digit before the comma and at least two behind it.</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>See Also</h3>

<p>Other format-checkers: 
<code><a href="#topic+field_format">field_format</a>()</code>,
<code><a href="#topic+field_length">field_length</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>df &lt;- data.frame(number = c("12.34","0.23E55","0.98765E12"))
rules &lt;- validator(
   number_format(number, format="dd.dd")
   , number_format(number, "0.ddEdd")
   , number_format(number, "0.*Edd")
)

out &lt;- confront(df, rules)
values(out)

# a few examples, without 'validator'
number_format("12.345", min_dig=2) # TRUE
number_format("12.345", min_dig=4) # FALSE
number_format("12.345", max_dig=2) # FALSE
number_format("12.345", max_dig=5) # TRUE
number_format("12,345", min_dig=2, max_dig=3, dec=",") # TRUE

</code></pre>

<hr>
<h2 id='origin'>Origin of rules</h2><span id='topic+origin'></span><span id='topic+origin+3C-'></span><span id='topic+origin+2Crule-method'></span><span id='topic+origin+3C-+2Crule+2Ccharacter-method'></span><span id='topic+origin+2Cexpressionset-method'></span><span id='topic+origin+3C-+2Cexpressionset+2Ccharacter-method'></span>

<h3>Description</h3>

<p>A slot to store where the rule originated, e.g. a filename
or <code>"command-line"</code> for interactively defined rules.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>origin(x, ...)

origin(x) &lt;- value

## S4 method for signature 'rule'
origin(x, ...)

## S4 replacement method for signature 'rule,character'
origin(x) &lt;- value

## S4 method for signature 'expressionset'
origin(x, ...)

## S4 replacement method for signature 'expressionset,character'
origin(x) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="origin_+3A_x">x</code></td>
<td>
<p>and R object</p>
</td></tr>
<tr><td><code id="origin_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to other methods</p>
</td></tr>
<tr><td><code id="origin_+3A_value">value</code></td>
<td>
<p>Value to set</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>character</code> vector.
</p>


<h3>See Also</h3>

<p>Other expressionset-methods: 
<code><a href="#topic+as.data.frame">as.data.frame</a>()</code>,
<code><a href="#topic+as.data.frame+2Cexpressionset-method">as.data.frame,expressionset-method</a></code>,
<code><a href="#topic+created">created</a>()</code>,
<code><a href="#topic+description">description</a>()</code>,
<code><a href="#topic+label">label</a>()</code>,
<code><a href="#topic+meta">meta</a>()</code>,
<code><a href="#topic+names+3C-+2Crule+2Ccharacter-method">names&lt;-,rule,character-method</a></code>,
<code><a href="#topic+plot+2Cvalidator-method">plot,validator-method</a></code>,
<code><a href="#topic+summary">summary</a>()</code>,
<code><a href="#topic+variables">variables</a>()</code>,
<code><a href="#topic+voptions">voptions</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# retrieve properties
v &lt;- validator(turnover &gt; 0, staff.costs&gt;0)

# number of rules in v:
length(v)

# per-rule
created(v)
origin(v)
names(v)

# set properties
names(v)[1] &lt;- "p1"

label(v)[1] &lt;- "turnover positive"
description(v)[1] &lt;- "
According to the official definition,
only positive values can be considered
valid turnovers.
"

# short description is also printed:
v

# print all info for first rule
v[[1]]



# retrieve properties
v &lt;- validator(turnover &gt; 0, staff.costs&gt;0)

# number of rules in v:
length(v)

# per-rule
created(v)
origin(v)
names(v)

# set properties
names(v)[1] &lt;- "p1"

label(v)[1] &lt;- "turnover positive"
description(v)[1] &lt;- "
According to the official definition,
only positive values can be considered
valid turnovers.
"

# short description is also printed:
v

# print all info for first rule
v[[1]]


</code></pre>

<hr>
<h2 id='part_whole_relation'>Test whether details combine to a chosen aggregate</h2><span id='topic+part_whole_relation'></span>

<h3>Description</h3>

<p>Data in 'long' format often contain records representing totals
(or other aggregates) as well as records that contain details
that add up to the total. This function facilitates checking the
part-whole relation in such cases.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>part_whole_relation(
  values,
  labels,
  whole,
  part = NULL,
  aggregator = sum,
  tol = 1e-08,
  by = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="part_whole_relation_+3A_values">values</code></td>
<td>
<p>A bare (unquoted) variable name holding the values to aggregate</p>
</td></tr>
<tr><td><code id="part_whole_relation_+3A_labels">labels</code></td>
<td>
<p>A bare (unquoted) variable name holding the labels indicating
whether a value is an aggregate or a detail.</p>
</td></tr>
<tr><td><code id="part_whole_relation_+3A_whole">whole</code></td>
<td>
<p><code>[character]</code> literal label or pattern recognizing a whole
in <code>labels</code>. Use <code><a href="#topic+glob">glob</a></code> or <code><a href="#topic+rx">rx</a></code> to label
as a globbing or regular expression pattern (see examples).</p>
</td></tr>
<tr><td><code id="part_whole_relation_+3A_part">part</code></td>
<td>
<p><code>[character]</code> vector of label values or pattern recognizing
a part in <code>labels</code>. Use <code><a href="#topic+glob">glob</a></code> or <code><a href="#topic+rx">rx</a></code>
to label as a globbing or regular expression pattern. When labeled
with <code>glob</code> or <code>rx</code>, it must be a single string. If 'part' is
left unspecified, all values not recognized as an aggregate are
interpreted as details that must be aggregated to the whole.</p>
</td></tr>
<tr><td><code id="part_whole_relation_+3A_aggregator">aggregator</code></td>
<td>
<p><code>[function]</code> used to aggregate subsets of <code>x</code>. It should
accept a <code>numeric</code> vector and return a single number.</p>
</td></tr>
<tr><td><code id="part_whole_relation_+3A_tol">tol</code></td>
<td>
<p><code>[numeric]</code> tolerance for equality checking</p>
</td></tr>
<tr><td><code id="part_whole_relation_+3A_by">by</code></td>
<td>
<p>Name of variable, or <code>list</code> of bare variable names, used to
split the values and labels before computing the aggregates.</p>
</td></tr>
<tr><td><code id="part_whole_relation_+3A_...">...</code></td>
<td>
<p>Extra arguments passed to aggregator (for example <code>na.rm=TRUE</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>logical</code> vector of size <code>length(value)</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>df &lt;- data.frame(
   id = 10011:10020
 , period   = rep(c("2018Q1", "2018Q2", "2018Q3", "2018Q4","2018"),2)
 , direction = c(rep("import",5), rep("export", 5))
 , value     = c(1,2,3,4,10, 3,3,3,3,13)
)
## use 'rx' to interpret 'whole' as a regular expression.
rules &lt;- validator(
  part_whole_relation(value, period, whole=rx("^\\d{4}$")
  , by=direction)
)

out &lt;- confront(df, rules, key="id")
as.data.frame(out)
</code></pre>

<hr>
<h2 id='plot+2CcellComparison-method'>Line graph of a cellComparison object.</h2><span id='topic+plot+2CcellComparison-method'></span>

<h3>Description</h3>

<p>Versions of a data set can be compared cell by cell
using <code><a href="#topic+cells">cells</a></code>. The result is a <code>cellComparison</code>
object. This method creates a line-graph, thus suggesting an
that an ordered sequence of data sets have been compared.
See also <code><a href="#topic+barplot+2CcellComparison-method">barplot,cellComparison-method</a></code> for an
unordered version.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'cellComparison'
plot(x, xlab = "", ylab = "", las = 2, cex.axis = 0.8, cex.legend = 0.8, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot+2B2CcellComparison-method_+3A_x">x</code></td>
<td>
<p>a <code>cellComparison</code> object.</p>
</td></tr>
<tr><td><code id="plot+2B2CcellComparison-method_+3A_xlab">xlab</code></td>
<td>
<p>[<code>character</code>] label for x axis (default none)</p>
</td></tr>
<tr><td><code id="plot+2B2CcellComparison-method_+3A_ylab">ylab</code></td>
<td>
<p>[<code>character</code>] label for y axis (default none)</p>
</td></tr>
<tr><td><code id="plot+2B2CcellComparison-method_+3A_las">las</code></td>
<td>
<p>[<code>numeric</code>] in <code>{0,1,2,3}</code> determining axis label rotation</p>
</td></tr>
<tr><td><code id="plot+2B2CcellComparison-method_+3A_cex.axis">cex.axis</code></td>
<td>
<p>[<code>numeric</code>] Magnification with respect to the current
setting of <code>cex</code> for axis annotation.</p>
</td></tr>
<tr><td><code id="plot+2B2CcellComparison-method_+3A_cex.legend">cex.legend</code></td>
<td>
<p>[<code>numeric</code>] Magnification with respect to the current
setting of <code>cex</code> for legend annotation and title.</p>
</td></tr>
<tr><td><code id="plot+2B2CcellComparison-method_+3A_...">...</code></td>
<td>
<p>Graphical parameters, passed to <code>plot</code>. See <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other comparing: 
<code><a href="#topic+as.data.frame+2CcellComparison-method">as.data.frame,cellComparison-method</a></code>,
<code><a href="#topic+as.data.frame+2CvalidatorComparison-method">as.data.frame,validatorComparison-method</a></code>,
<code><a href="#topic+barplot+2CcellComparison-method">barplot,cellComparison-method</a></code>,
<code><a href="#topic+barplot+2CvalidatorComparison-method">barplot,validatorComparison-method</a></code>,
<code><a href="#topic+cells">cells</a>()</code>,
<code><a href="#topic+compare">compare</a>()</code>,
<code><a href="#topic+match_cells">match_cells</a>()</code>,
<code><a href="#topic+plot+2CvalidatorComparison-method">plot,validatorComparison-method</a></code>
</p>

<hr>
<h2 id='plot+2Cvalidation-method'>Plot validation results</h2><span id='topic+plot+2Cvalidation-method'></span>

<h3>Description</h3>

<p>Creates a barplot of validation result. For each validation rule, a stacked bar
is plotted with percentages of failing, passing, and missing results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'validation'
plot(
  x,
  y,
  fill = c("#FE2712", "#66B032", "#dddddd"),
  col = fill,
  rulenames = names(x),
  labels = c("Fails", "Passing", "Missing", "Total"),
  title = NULL,
  xlab = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot+2B2Cvalidation-method_+3A_x">x</code></td>
<td>
<p>a confrontation object.</p>
</td></tr>
<tr><td><code id="plot+2B2Cvalidation-method_+3A_y">y</code></td>
<td>
<p>not used</p>
</td></tr>
<tr><td><code id="plot+2B2Cvalidation-method_+3A_fill">fill</code></td>
<td>
<p><code>[character]</code> vector of length 3. Colors representing fails, passes, and missings</p>
</td></tr>
<tr><td><code id="plot+2B2Cvalidation-method_+3A_col">col</code></td>
<td>
<p>Edge colors for the bars.</p>
</td></tr>
<tr><td><code id="plot+2B2Cvalidation-method_+3A_rulenames">rulenames</code></td>
<td>
<p><code>[character]</code> vector of size <code>length(x)</code>. If not specified, names
are taken from <code>x</code>.</p>
</td></tr>
<tr><td><code id="plot+2B2Cvalidation-method_+3A_labels">labels</code></td>
<td>
<p><code>[character]</code> vector of length 4. Replace legend annotation.</p>
</td></tr>
<tr><td><code id="plot+2B2Cvalidation-method_+3A_title">title</code></td>
<td>
<p><code>[character]</code> Change the default title.</p>
</td></tr>
<tr><td><code id="plot+2B2Cvalidation-method_+3A_xlab">xlab</code></td>
<td>
<p><code>[character]</code> Change the title</p>
</td></tr>
<tr><td><code id="plot+2B2Cvalidation-method_+3A_...">...</code></td>
<td>
<p>not used</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The plot function tries to be smart about placing labels on the y axis. When 
the number of bars becomes too large, no y axis annotation will be shown and the 
bars will become space-filling.
</p>


<h3>See Also</h3>

<p>Other validation-methods: 
<code><a href="#topic+aggregate+2Cvalidation-method">aggregate,validation-method</a></code>,
<code><a href="#topic+all+2Cvalidation-method">all,validation-method</a></code>,
<code><a href="#topic+any+2Cvalidation-method">any,validation-method</a></code>,
<code><a href="#topic+barplot+2Cvalidation-method">barplot,validation-method</a></code>,
<code><a href="#topic+check_that">check_that</a>()</code>,
<code><a href="#topic+compare">compare</a>()</code>,
<code><a href="#topic+confront">confront</a>()</code>,
<code><a href="#topic+event">event</a>()</code>,
<code><a href="#topic+names+3C-+2Crule+2Ccharacter-method">names&lt;-,rule,character-method</a></code>,
<code><a href="#topic+sort+2Cvalidation-method">sort,validation-method</a></code>,
<code><a href="#topic+summary">summary</a>()</code>,
<code><a href="#topic+validation-class">validation-class</a></code>,
<code><a href="#topic+values">values</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rules &lt;- validator( r1 = staff.costs &lt; total.costs
                  , r2 = turnover + other.rev == total.rev
                  , r3 = other.rev &gt; 0
                  , r4 = total.rev &gt; 0
                  , r5 = nace %in% c("A", "B")
                  )
plot(rules, cex=0.8, show_legend=TRUE)

data(retailers)
cf &lt;- confront(retailers, rules)
plot(cf, main="Retailers check")
</code></pre>

<hr>
<h2 id='plot+2Cvalidator-method'>Plot a validator object</h2><span id='topic+plot+2Cvalidator-method'></span>

<h3>Description</h3>

<p>The matrix of variables x rules is plotted, in which rules that are
recognized as linear (in)equations are differently colored. 
The augmented matrix is returned, but can also be calculated using
<code>variables(x, as="matrix")</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'validator'
plot(
  x,
  y,
  use_blocks = TRUE,
  col = c("#b2df8a", "#a6cee3"),
  cex = 1,
  show_legend = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot+2B2Cvalidator-method_+3A_x">x</code></td>
<td>
<p>validator object with rules</p>
</td></tr>
<tr><td><code id="plot+2B2Cvalidator-method_+3A_y">y</code></td>
<td>
<p>not used</p>
</td></tr>
<tr><td><code id="plot+2B2Cvalidator-method_+3A_use_blocks">use_blocks</code></td>
<td>
<p><code>logical</code> if <code>TRUE</code> the matrix is sorted
according to the connected sub sets of variables (aka blocks).</p>
</td></tr>
<tr><td><code id="plot+2B2Cvalidator-method_+3A_col">col</code></td>
<td>
<p><code>character</code> with color codes for plotting variables.</p>
</td></tr>
<tr><td><code id="plot+2B2Cvalidator-method_+3A_cex">cex</code></td>
<td>
<p>size of the variables plotted.</p>
</td></tr>
<tr><td><code id="plot+2B2Cvalidator-method_+3A_show_legend">show_legend</code></td>
<td>
<p>should a legend explaining the colors be drawn?</p>
</td></tr>
<tr><td><code id="plot+2B2Cvalidator-method_+3A_...">...</code></td>
<td>
<p>passed to image</p>
</td></tr>
</table>


<h3>Value</h3>

<p>(invisible) the matrix
</p>


<h3>See Also</h3>

<p><code><a href="#topic+variables">variables</a></code>
</p>
<p>Other validator-methods: 
<code><a href="#topic++2B+2Cvalidator+2Cvalidator-method">+,validator,validator-method</a></code>,
<code><a href="#topic+validator">validator</a></code>
</p>
<p>Other expressionset-methods: 
<code><a href="#topic+as.data.frame">as.data.frame</a>()</code>,
<code><a href="#topic+as.data.frame+2Cexpressionset-method">as.data.frame,expressionset-method</a></code>,
<code><a href="#topic+created">created</a>()</code>,
<code><a href="#topic+description">description</a>()</code>,
<code><a href="#topic+label">label</a>()</code>,
<code><a href="#topic+meta">meta</a>()</code>,
<code><a href="#topic+names+3C-+2Crule+2Ccharacter-method">names&lt;-,rule,character-method</a></code>,
<code><a href="#topic+origin">origin</a>()</code>,
<code><a href="#topic+summary">summary</a>()</code>,
<code><a href="#topic+variables">variables</a>()</code>,
<code><a href="#topic+voptions">voptions</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rules &lt;- validator( r1 = staff.costs &lt; total.costs
                  , r2 = turnover + other.rev == total.rev
                  , r3 = other.rev &gt; 0
                  , r4 = total.rev &gt; 0
                  , r5 = nace %in% c("A", "B")
                  )
plot(rules, cex=0.8, show_legend=TRUE)

data(retailers)
cf &lt;- confront(retailers, rules)
plot(cf, main="Retailers check")
</code></pre>

<hr>
<h2 id='plot+2CvalidatorComparison-method'>Line graph of validatorComparison object</h2><span id='topic+plot+2CvalidatorComparison-method'></span>

<h3>Description</h3>

<p>The performance of versions of a data set with regard to rule-based quality
requirements can be compared using using <code><a href="#topic+compare">compare</a></code>. The result is a
<code>validatorComparison</code> object. This method creates a line-graph, thus
suggesting an that an ordered sequence of data sets have been compared.  See
also <code><a href="#topic+barplot+2CvalidatorComparison-method">barplot,validatorComparison-method</a></code> for an unordered version.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'validatorComparison'
plot(x, xlab = "", ylab = "", las = 2, cex.axis = 0.8, cex.legend = 0.8, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot+2B2CvalidatorComparison-method_+3A_x">x</code></td>
<td>
<p>Object of class <code>validatorComparison</code>.</p>
</td></tr>
<tr><td><code id="plot+2B2CvalidatorComparison-method_+3A_xlab">xlab</code></td>
<td>
<p>[<code>character</code>] label for x axis (default none)</p>
</td></tr>
<tr><td><code id="plot+2B2CvalidatorComparison-method_+3A_ylab">ylab</code></td>
<td>
<p>[<code>character</code>] label for y axis (default none)</p>
</td></tr>
<tr><td><code id="plot+2B2CvalidatorComparison-method_+3A_las">las</code></td>
<td>
<p>[<code>numeric</code>] in <code>{0,1,2,3}</code> determining axis label rotation</p>
</td></tr>
<tr><td><code id="plot+2B2CvalidatorComparison-method_+3A_cex.axis">cex.axis</code></td>
<td>
<p>[<code>numeric</code>] Magnification with respect to the current
setting of <code>cex</code> for axis annotation.</p>
</td></tr>
<tr><td><code id="plot+2B2CvalidatorComparison-method_+3A_cex.legend">cex.legend</code></td>
<td>
<p>[<code>numeric</code>] Magnification with respect to the current
setting of <code>cex</code> for legend annotation and title.</p>
</td></tr>
<tr><td><code id="plot+2B2CvalidatorComparison-method_+3A_...">...</code></td>
<td>
<p>Graphical parameters, passed to <code>plot</code>. See <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other comparing: 
<code><a href="#topic+as.data.frame+2CcellComparison-method">as.data.frame,cellComparison-method</a></code>,
<code><a href="#topic+as.data.frame+2CvalidatorComparison-method">as.data.frame,validatorComparison-method</a></code>,
<code><a href="#topic+barplot+2CcellComparison-method">barplot,cellComparison-method</a></code>,
<code><a href="#topic+barplot+2CvalidatorComparison-method">barplot,validatorComparison-method</a></code>,
<code><a href="#topic+cells">cells</a>()</code>,
<code><a href="#topic+compare">compare</a>()</code>,
<code><a href="#topic+match_cells">match_cells</a>()</code>,
<code><a href="#topic+plot+2CcellComparison-method">plot,cellComparison-method</a></code>
</p>

<hr>
<h2 id='retailers'>data on Dutch supermarkets</h2><span id='topic+retailers'></span><span id='topic+SBS2000'></span>

<h3>Description</h3>

<p>Anonymized and distorted data on revenue and cost structure for
60 retailers. Currency is in thousands of Euros. There are two
data sets. The <code>SBS2000</code> dataset is equal to the <code>retailers</code>
data set except that it has a record identifier (called <code>id</code>) column.
</p>

<ul>
<li><p> id: A unique identifier (only in SBS2000)
</p>
</li>
<li><p> size: Size class (0=undetermined)
</p>
</li>
<li><p> incl.prob: Probability of inclusion in the sample
</p>
</li>
<li><p> staff: Number of staff
</p>
</li>
<li><p> turnover: Amount of turnover
</p>
</li>
<li><p> other.rev: Amount of other revenue
</p>
</li>
<li><p> total.rev: Total revenue
</p>
</li>
<li><p> staff.costs: Costs assiciated to staff
</p>
</li>
<li><p> total.costs: Total costs made
</p>
</li>
<li><p> profit: Amount of profit
</p>
</li>
<li><p> vat: Turnover reported for Value Added Tax
</p>
</li></ul>



<h3>Format</h3>

<p>A csv file, one retailer per row.
</p>


<h3>See Also</h3>

<p>Other datasets: 
<code><a href="#topic+nace_rev2">nace_rev2</a></code>,
<code><a href="#topic+samplonomy">samplonomy</a></code>
</p>

<hr>
<h2 id='rule-class'>A rich expression</h2><span id='topic+rule-class'></span><span id='topic+rule'></span>

<h3>Description</h3>

<p>A rich expression
</p>


<h3>Details</h3>

<p>Technically, <code>rule</code> is a <code>call</code> object endowed with extra
attributes such as a name, a label and a description description, creation
time and a reference to its origin. Rule objects are not for direct use by
users of the package, but may be of interest for developers of this package,
or packages depending on it.
</p>


<h3>Exported S4 methods for <code>rule</code></h3>


<ul>
<li><p><code>show</code>
</p>
</li>
<li><p><code><a href="#topic+origin">origin</a></code>
</p>
</li>
<li><p><code><a href="#topic+label">label</a></code>
</p>
</li>
<li><p><code><a href="#topic+description">description</a></code>
</p>
</li>
<li><p><code><a href="#topic+created">created</a></code>
</p>
</li></ul>



<h3>Private S4 methods for <code>rule</code></h3>


<ul>
<li><p>validating
</p>
</li>
<li><p>linear
</p>
</li>
<li><p>expr
</p>
</li>
<li><p>is_tran_assign
</p>
</li></ul>



<h3>See also</h3>


<ul>
<li><p><code><a href="#topic+expressionset-class">expressionset-class</a></code>
</p>
</li></ul>


<hr>
<h2 id='run_validation_file'>Run a file with confrontations. Capture results</h2><span id='topic+run_validation_file'></span><span id='topic+run_validation_dir'></span><span id='topic+print.validations'></span><span id='topic+summary.validations'></span>

<h3>Description</h3>

<p>A validation script is a regular R script, intersperced with <code>confront</code>
or <code>check_that</code> statements. This function will run the script file 
and capture all output from calls to these functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>run_validation_file(file, verbose = TRUE)

run_validation_dir(dir = "./", pattern = "^validate.+[rR]", verbose = TRUE)

## S3 method for class 'validations'
print(x, ...)

## S3 method for class 'validations'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="run_validation_file_+3A_file">file</code></td>
<td>
<p><code>[character]</code> location of an R file.</p>
</td></tr>
<tr><td><code id="run_validation_file_+3A_verbose">verbose</code></td>
<td>
<p><code>[logical]</code> toggle verbose output.</p>
</td></tr>
<tr><td><code id="run_validation_file_+3A_dir">dir</code></td>
<td>
<p><code>[character]</code> path to directory.</p>
</td></tr>
<tr><td><code id="run_validation_file_+3A_pattern">pattern</code></td>
<td>
<p><code>[characer]</code> regular expression that selects validation files to run.</p>
</td></tr>
<tr><td><code id="run_validation_file_+3A_x">x</code></td>
<td>
<p>An R object</p>
</td></tr>
<tr><td><code id="run_validation_file_+3A_...">...</code></td>
<td>
<p>Unused</p>
</td></tr>
<tr><td><code id="run_validation_file_+3A_object">object</code></td>
<td>
<p>An R object</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>run_validation_file</code>: An object of class <code>validations</code>. This is 
a <code>list</code> of objects of class <code><a href="#topic+validation">validation</a></code>.
</p>
<p><code>run_validation_dir</code>: An object of class <code>validations</code>. This is 
a <code>list</code> of objects of class <code><a href="#topic+validation">validation</a></code>.
</p>
<p><code>print</code>: <code>NULL</code>, invisibly.
</p>
<p><code>summary</code>: A data frame similar to the data frame returned
when summarizing a <code><a href="#topic+validation">validation</a></code> object. There are extra columns listing
each call, file and first and last line where the code occurred.
</p>

<hr>
<h2 id='rx'>Label objects for interpretation as pattern</h2><span id='topic+rx'></span><span id='topic+glob'></span>

<h3>Description</h3>

<p>Label objects  (typically strings or data frames containing keys combinations) 
to be interpreted as regular expression or globbing pattern.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rx(x)

glob(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rx_+3A_x">x</code></td>
<td>
<p>Object to label as regular expression (<code>rx(x)</code>) or globbing
(<code>glob(x)</code>) pattern.</p>
</td></tr>
</table>

<hr>
<h2 id='samplonomy'>Economic data on Samplonia</h2><span id='topic+samplonomy'></span>

<h3>Description</h3>

<p>Simulated economic time series representing GDP, Import, Export and
Balance of Trade (BOT) of Samplonia. Samplonia is a fictional Island
invented by Jelke Bethelehem (2009). The country has 10 000 inhabitants.
It consists of two provinces: Agria and Induston. Agria is a rural
province consisting of the mostly fruit and vegetable producing district
of Wheaton and the mostly cattle producing Greenham. Induston has four
districts. Two districts with heavy industry named Smokeley and Mudwater.
Newbay is a young, developing district while Crowdon is where the rich
Samplonians retire. The current data set contains several time series
from Samplonia's national accounts system in long format.
</p>
<p>There are annual and quarterly time series on GDP, Import, Export and
Balance of Trade, for Samplonia as a whole, for each province and each
district. BOT is defined as Export-Import for each region and period;
quarterly figures are expected to add up to annual figures for each
region and measure, and subregions are expected to add up to their
super-regions.
</p>

<ul>
<li><p> region:  Region (Samplonia, one if its 2 provinces, or one of its 6 districts)
</p>
</li>
<li><p> freq:    Frequency of the time series
</p>
</li>
<li><p> period:  Period (year or quarter)
</p>
</li>
<li><p> measure: The economic variable (gdp, import, export, balance)
</p>
</li>
<li><p> value:   The value 
</p>
</li></ul>

<p>The data set has been endowed with the following errors.
</p>

<ul>
<li><p> For Agria, the 2015 GDP record is not present.
</p>
</li>
<li><p> For Induston, the 2018Q3 export value is missing (<code>NA</code>)
</p>
</li>
<li><p> For Induston, there are two different values for the 2018Q2 Export
</p>
</li>
<li><p> For Crowdon, the 2015Q1 balance value is missing (<code>NA</code>).
</p>
</li>
<li><p> For Wheaton, the 2019Q2 import is missing (<code>NA</code>).
</p>
</li></ul>



<h3>Format</h3>

<p>An RData file.
</p>


<h3>References</h3>

<p>J. Bethlehem (2009), Applied Survey Methods: A Statistical Perspective. John
Wiley &amp; Sons, Hoboken, NJ.
</p>


<h3>See Also</h3>

<p>Other datasets: 
<code><a href="#topic+nace_rev2">nace_rev2</a></code>,
<code><a href="#topic+retailers">retailers</a></code>
</p>

<hr>
<h2 id='satisfying'>Select records (not) satisfying rules</h2><span id='topic+satisfying'></span><span id='topic+violating'></span><span id='topic+violating.default'></span><span id='topic+lacking'></span>

<h3>Description</h3>

<p>Apply validation rules or validation results to a data set and select only
those that satisfy all or violate at least one rule.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>satisfying(x, y, include_missing = FALSE, ...)

violating(x, y, include_missing = FALSE, ...)

## Default S3 method:
violating(x, y, include_missing = FALSE, ...)

lacking(x, y, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="satisfying_+3A_x">x</code></td>
<td>
<p>A <code>data.frame</code></p>
</td></tr>
<tr><td><code id="satisfying_+3A_y">y</code></td>
<td>
<p>a <code><a href="#topic+validator">validator</a></code> object or a <code><a href="#topic+validation">validation</a></code> object.</p>
</td></tr>
<tr><td><code id="satisfying_+3A_include_missing">include_missing</code></td>
<td>
<p>Toggle: also select records that have <code>NA</code> output for a rule?</p>
</td></tr>
<tr><td><code id="satisfying_+3A_...">...</code></td>
<td>
<p>options passed to <code><a href="#topic+confront">confront</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>For <code>satisfying</code>, the records in <code>x</code> satisfying all rules or
validation outcomes in <code>y</code>. For <code>violating</code> the records in
<code>x</code> violating at least one of the rules or validation outcomes
in <code>y</code>
</p>


<h3>Note</h3>

<p>An error is thrown if the rules or validation results in <code>y</code> can not be
interpreted record-by record (e.g. when one of the rules is of the form
<code>mean(foo)&gt;0</code>).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rules &lt;- validator(speed &gt;= 12, dist &lt; 100)
satisfying(cars, rules)
violating(cars, rules)

out &lt;- confront(cars, rules)
summary(out)
satisfying(cars, out)
violating(cars, out)

</code></pre>

<hr>
<h2 id='sdmx_codelist'>Get code list from an SDMX REST API endpoint.</h2><span id='topic+sdmx_codelist'></span><span id='topic+estat_codelist'></span><span id='topic+global_codelist'></span>

<h3>Description</h3>

<p><code>sdmx_codelist</code> constructs an URL for <code>rsdmx::readSDMX</code> and
extracts the code IDs.  Code lists are downloaded once and cached for the
duration of the R session.
</p>
<p><code>estat_codelist</code> gets a code list from the REST API provided at
<code>ec.europa.eu/tools/cspa_services_global/sdmxregistry</code>. It is a
convenience wrapper that calls <code>sdmx_codelist</code>.
</p>
<p><code>global_codelist</code> gets a code list from the REST API provided at
<code>https://registry.sdmx.org/webservice/data.html</code>.  It is a convenience
wrapper that calls <code>sdmx_codelist</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sdmx_codelist(
  endpoint,
  agency_id,
  resource_id,
  version = "latest",
  what = c("id", "all")
)

estat_codelist(resource_id, agency_id = "ESTAT", version = "latest")

global_codelist(resource_id, agency_id = "SDMX", version = "latest")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sdmx_codelist_+3A_endpoint">endpoint</code></td>
<td>
<p><code>[character]</code> REST API endpoint of the SDMX registry</p>
</td></tr>
<tr><td><code id="sdmx_codelist_+3A_agency_id">agency_id</code></td>
<td>
<p><code>[character]</code> Agency ID (e.g. <code>"ESTAT"</code>)</p>
</td></tr>
<tr><td><code id="sdmx_codelist_+3A_resource_id">resource_id</code></td>
<td>
<p><code>[character]</code> Resource ID (e.g. <code>"CL_ACTIVITY"</code>)</p>
</td></tr>
<tr><td><code id="sdmx_codelist_+3A_version">version</code></td>
<td>
<p><code>[character]</code> Version of the code list.</p>
</td></tr>
<tr><td><code id="sdmx_codelist_+3A_what">what</code></td>
<td>
<p><code>[character]</code> Return a <code>character</code> with code id's, or
a data frame with all information.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other sdmx: 
<code><a href="#topic+sdmx_endpoint">sdmx_endpoint</a>()</code>,
<code><a href="#topic+validator_from_dsd">validator_from_dsd</a>()</code>
</p>
<p>Other sdmx: 
<code><a href="#topic+sdmx_endpoint">sdmx_endpoint</a>()</code>,
<code><a href="#topic+validator_from_dsd">validator_from_dsd</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> 

 # here we download the CL_ACTIVITY codelist from the  ESTAT registry.
## Not run: 
 codelist &lt;- sdmx_codelist(
   endpoint = "https://registry.sdmx.org/ws/public/sdmxapi/rest/"
   , agency_id = "ESTAT"
   , resource_id = "CL_ACTIVITY" 

## End(Not run)

## Not run: 
  estat_codelist("CL_ACTIVITY")

## End(Not run)
## Not run: 
  global_codelist("CL_AGE") )
  global_codelist("CL_CONF_STATUS")
  global_codelist("CL_SEX")

## End(Not run)
# An example of using SDMX information, downloaded from the SDMX global
# registry
## Not run: 
 # economic data from the country of Samplonia
 data(samplonomy)
 head(samplonomy)

 rules &lt;- validator(
   , freq %in% global_codelist("CL_FREQ")
   , value &gt;= 0
 )
 cf &lt;- confront(samplonomy, rules) 
 summary(cf)


## End(Not run)
</code></pre>

<hr>
<h2 id='sdmx_endpoint'>Get URL for known SDMX registry endpoints</h2><span id='topic+sdmx_endpoint'></span>

<h3>Description</h3>

<p>Convenience function storing URLs for SDMX endpoints.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sdmx_endpoint(registry = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sdmx_endpoint_+3A_registry">registry</code></td>
<td>
<p><code>[character]</code> name of the endpoint (case insensitve). If <code>registry</code>
is <code>NULL</code> (the default), the list of supported endpoints is returned.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other sdmx: 
<code><a href="#topic+sdmx_codelist">sdmx_codelist</a>()</code>,
<code><a href="#topic+validator_from_dsd">validator_from_dsd</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sdmx_endpoint()
sdmx_endpoint("ESTAT")
sdmx_endpoint("global")

</code></pre>

<hr>
<h2 id='sort+2Cvalidation-method'>Aggregate and sort the results of a validation.</h2><span id='topic+sort+2Cvalidation-method'></span>

<h3>Description</h3>

<p>Aggregate and sort the results of a validation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'validation'
sort(x, decreasing = FALSE, by = c("rule", "record"), drop = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sort+2B2Cvalidation-method_+3A_x">x</code></td>
<td>
<p>An object of class <code><a href="#topic+validation">validation</a></code></p>
</td></tr>
<tr><td><code id="sort+2B2Cvalidation-method_+3A_decreasing">decreasing</code></td>
<td>
<p>Sort by decreasing number of passes?</p>
</td></tr>
<tr><td><code id="sort+2B2Cvalidation-method_+3A_by">by</code></td>
<td>
<p>Report on violations per rule (default) or per record?</p>
</td></tr>
<tr><td><code id="sort+2B2Cvalidation-method_+3A_drop">drop</code></td>
<td>
<p>drop list attribute if the result has a single argument.</p>
</td></tr>
<tr><td><code id="sort+2B2Cvalidation-method_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.frame</code> with the following columns.
</p>

<table>
<tr>
 <td style="text-align: left;">
  keys </td><td style="text-align: left;"> If confront was called with <code>key=</code></td>
</tr>
<tr>
 <td style="text-align: left;">
  <code>npass</code> </td><td style="text-align: left;"> Number of items passed</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code>nfail</code> </td><td style="text-align: left;"> Number of items failing</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code>nNA</code> </td><td style="text-align: left;"> Number of items resulting in <code>NA</code></td>
</tr>
<tr>
 <td style="text-align: left;">
  <code>rel.pass</code> </td><td style="text-align: left;"> Relative number of items passed</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code>rel.fail</code> </td><td style="text-align: left;"> Relative number of items failing</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code>rel.NA</code> </td><td style="text-align: left;"> Relative number of items resulting in <code>NA</code>
</td>
</tr>

</table>

<p>If <code>by='rule'</code> the relative numbers are computed with respect to the number 
of records for which the rule was evaluated. If <code>by='record'</code> the relative numbers
are computed with respect to the number of rules the record was tested agains. By default
the most failed validations and records with the most fails are on the top. 
</p>
<p>When <code>by='record'</code> and not all validation results have the same dimension structure,
a list of <code>data.frames</code> is returned.
</p>


<h3>See Also</h3>

<p>Other validation-methods: 
<code><a href="#topic+aggregate+2Cvalidation-method">aggregate,validation-method</a></code>,
<code><a href="#topic+all+2Cvalidation-method">all,validation-method</a></code>,
<code><a href="#topic+any+2Cvalidation-method">any,validation-method</a></code>,
<code><a href="#topic+barplot+2Cvalidation-method">barplot,validation-method</a></code>,
<code><a href="#topic+check_that">check_that</a>()</code>,
<code><a href="#topic+compare">compare</a>()</code>,
<code><a href="#topic+confront">confront</a>()</code>,
<code><a href="#topic+event">event</a>()</code>,
<code><a href="#topic+names+3C-+2Crule+2Ccharacter-method">names&lt;-,rule,character-method</a></code>,
<code><a href="#topic+plot+2Cvalidation-method">plot,validation-method</a></code>,
<code><a href="#topic+summary">summary</a>()</code>,
<code><a href="#topic+validation-class">validation-class</a></code>,
<code><a href="#topic+values">values</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(retailers)
retailers$id &lt;- paste0("ret",1:nrow(retailers))
v &lt;- validator(
    staff.costs/staff &lt; 25
  , turnover + other.rev==total.rev)

cf &lt;- confront(retailers,v,key="id")
a &lt;- aggregate(cf,by='record')
head(a)

# or, get a sorted result:
s &lt;- sort(cf, by='record')
head(s)


</code></pre>

<hr>
<h2 id='summary'>Create a summary</h2><span id='topic+summary'></span><span id='topic+summary+2Cexpressionset-method'></span><span id='topic+summary+2Cindication-method'></span><span id='topic+validate-summary'></span><span id='topic+summary+2Cvalidation-method'></span>

<h3>Description</h3>

<p>Create a summary
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summary(object, ...)

## S4 method for signature 'expressionset'
summary(object, ...)

## S4 method for signature 'indication'
summary(object, ...)

## S4 method for signature 'validation'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary_+3A_object">object</code></td>
<td>
<p>An R object</p>
</td></tr>
<tr><td><code id="summary_+3A_...">...</code></td>
<td>
<p>Currently unused</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.frame</code> with the information mentioned below is returned.
</p>


<h3>Validator and indicator objects</h3>

<p>For these objects, the ruleset is split into subsets (blocks) that are disjunct in the
sense that they do not share any variables. For each block the number of variables, 
the number of rules and the number of rules that are linear are reported.
</p>


<h3>Indication</h3>

<p>Some basic information per evaluated indicator is reported: the number 
of items to which the indicator was applied, the output <code>class</code>, 
some statistics (min, max, mean , number of NA)
and wether an exception occurred (warnings or errors). The evaluated 
expression is reported as well.
</p>


<h3>Validation</h3>

<p>Some basic information per evaluated validation rule is reported: the number of
items to which the rule was applied, the output <code>class</code>, some statistics
(passes, fails, number of NA) and wether an exception occurred (warnings or
errors). The evaluated expression is reported as well.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot+2Cvalidator-method">plot,validator-method</a></code>
</p>
<p>Other expressionset-methods: 
<code><a href="#topic+as.data.frame">as.data.frame</a>()</code>,
<code><a href="#topic+as.data.frame+2Cexpressionset-method">as.data.frame,expressionset-method</a></code>,
<code><a href="#topic+created">created</a>()</code>,
<code><a href="#topic+description">description</a>()</code>,
<code><a href="#topic+label">label</a>()</code>,
<code><a href="#topic+meta">meta</a>()</code>,
<code><a href="#topic+names+3C-+2Crule+2Ccharacter-method">names&lt;-,rule,character-method</a></code>,
<code><a href="#topic+origin">origin</a>()</code>,
<code><a href="#topic+plot+2Cvalidator-method">plot,validator-method</a></code>,
<code><a href="#topic+variables">variables</a>()</code>,
<code><a href="#topic+voptions">voptions</a>()</code>
</p>
<p>Other indication-methods: 
<code><a href="#topic+confront">confront</a>()</code>,
<code><a href="#topic+event">event</a>()</code>,
<code><a href="#topic+indication-class">indication-class</a></code>
</p>
<p>Other validation-methods: 
<code><a href="#topic+aggregate+2Cvalidation-method">aggregate,validation-method</a></code>,
<code><a href="#topic+all+2Cvalidation-method">all,validation-method</a></code>,
<code><a href="#topic+any+2Cvalidation-method">any,validation-method</a></code>,
<code><a href="#topic+barplot+2Cvalidation-method">barplot,validation-method</a></code>,
<code><a href="#topic+check_that">check_that</a>()</code>,
<code><a href="#topic+compare">compare</a>()</code>,
<code><a href="#topic+confront">confront</a>()</code>,
<code><a href="#topic+event">event</a>()</code>,
<code><a href="#topic+names+3C-+2Crule+2Ccharacter-method">names&lt;-,rule,character-method</a></code>,
<code><a href="#topic+plot+2Cvalidation-method">plot,validation-method</a></code>,
<code><a href="#topic+sort+2Cvalidation-method">sort,validation-method</a></code>,
<code><a href="#topic+validation-class">validation-class</a></code>,
<code><a href="#topic+values">values</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(retailers)
v &lt;- validator(staff &gt; 0, staff.costs/staff &lt; 20, turnover+other.revenue == total.revenue)
summary(v)

cf &lt;- confront(retailers,v)
summary(cf)


</code></pre>

<hr>
<h2 id='syntax'>Syntax to define validation or indicator rules</h2><span id='topic+syntax'></span>

<h3>Description</h3>

<p>A concise overview of the <code>validate</code> syntax.
</p>


<h3>Basic syntax</h3>

<p>The basic rule is that an R-statement that evaluates to a <code>logical</code> is a
validating statement. This is established by static code inspection when
<code>validator</code> reads a (set of) user-defined validation rule(s).
</p>


<h3>Comparisons</h3>

<p>All basic comparisons, including <code>&gt;, &gt;=, ==, !=, &lt;=, &lt;</code>, <code>%in%</code>
are validating statements. When executing a validating statement, the
<code>%in%</code> operator is replaced with <code><a href="#topic+vin">%vin%</a></code>.
</p>


<h3>Logical operations</h3>

<p>Unary logical operators '<code>!</code>', <code>all()</code> and <code>any</code> define
validating statements. Binary logical operations including <code>&amp;, &amp;&amp;, |,
||</code>, are validating when <code>P</code> and <code>Q</code> in e.g. <code>P &amp; Q</code> are
validating. (note that the short-circuits <code>&amp;&amp;</code> and <code>&amp;</code> onnly return
the first logical value, in cases where for <code>P &amp;&amp; Q</code>, <code>P</code> and/or
<code>Q</code> are vectors. Binary logical implication <code class="reqn">P\Rightarrow Q</code> (P
implies Q) is implemented as <code>if ( P ) Q</code>. The latter is interpreted as
<code>!(P) | Q</code>.
</p>


<h3>Type checking</h3>

<p>Any function starting with <code>is.</code> (e.g. <code>is.numeric</code>) is a
validating expression.
</p>


<h3>Text search</h3>

<p><code>grepl</code> is a validating expression.
</p>


<h3>Functional dependencies</h3>

<p>Armstrong's functional dependencies, of the form <code class="reqn">A + B \to C + D</code> are
represented using the <code>~</code>, e.g. <code>A + B ~ C + D</code>. For example
<code>postcode ~ city</code> means, that when two records have the same value for
<code>postcode</code>, they must have the same value for <code>city</code>.
</p>


<h3>Reference the dataset as a whole</h3>

<p>Metadata such as numer of rows, columns, column names and so on can be 
tested by referencing the whole data set with the '<code>.</code>'. For example,
the rule <code>nrow(.) == 15</code> checks whether there are 15 rows in the
dataset at hand.
</p>


<h3>Uniqueness, completeness</h3>

<p>These can be tested in principle with the 'dot' syntax. However, there are
some convenience functions: <code><a href="#topic+is_complete">is_complete</a></code>, <code><a href="#topic+all_complete">all_complete</a></code>
<code><a href="#topic+is_unique">is_unique</a></code>, <code><a href="#topic+all_unique">all_unique</a></code>.
</p>


<h3>Local, transient assignment</h3>

<p>The operator '<code>:=</code>' can be used to set up local variables (during, for
example, validation) to save time (the rhs of an assignment is computed only
once) or to make your validation code more maintainable.  Assignments work more
or less like common R assignments: they are only valid for statements coming
after the assignment and they may be overwritten. The result of computing the
rhs is not part of a <code><a href="#topic+confront">confront</a></code>ation with data.
</p>


<h3>Groups</h3>

<p>Often the same constraints/rules are valid for groups of variables. 
<code>validate</code> allows for compact notation. Variable groups can be used
in-statement or by defining them with the <code>:=</code> operator.
</p>
<p><code>validator( var_group(a,b) &gt; 0 )</code>
</p>
<p>is equivalent to
</p>
<p><code>validator(G := var_group(a,b), G &gt; 0)</code>
</p>
<p>is equivalent to
</p>
<p><code>validator(a&gt;0,b&gt;0)</code>.
</p>
<p>Using two groups results in the cartesian product of checks. So the statement
</p>
<p><code>validator( f=var_group(c,d), g=var_group(a,b), g &gt; f)</code>
</p>
<p>is equivalent to
</p>
<p><code>validator(a &gt; c, b &gt; c, a &gt; d, b &gt; d)</code>
</p>


<h3>File parsing</h3>

<p>Please see the cookbook on how to read rules from and write rules to file:
</p>
<p><code>vignette("cookbook",package="validate")</code>
</p>

<hr>
<h2 id='validation-class'>Store results of evaluating validating expressions</h2><span id='topic+validation-class'></span><span id='topic+validation'></span>

<h3>Description</h3>

<p>Store results of evaluating validating expressions
</p>


<h3>Details</h3>

<p>A object of class <code>validation</code> stores a set of results generated by
evaluating an <code><a href="#topic+validator">validator</a></code> in the context of data along with some
metadata.
</p>


<h3>See Also</h3>

<p>Other validation-methods: 
<code><a href="#topic+aggregate+2Cvalidation-method">aggregate,validation-method</a></code>,
<code><a href="#topic+all+2Cvalidation-method">all,validation-method</a></code>,
<code><a href="#topic+any+2Cvalidation-method">any,validation-method</a></code>,
<code><a href="#topic+barplot+2Cvalidation-method">barplot,validation-method</a></code>,
<code><a href="#topic+check_that">check_that</a>()</code>,
<code><a href="#topic+compare">compare</a>()</code>,
<code><a href="#topic+confront">confront</a>()</code>,
<code><a href="#topic+event">event</a>()</code>,
<code><a href="#topic+names+3C-+2Crule+2Ccharacter-method">names&lt;-,rule,character-method</a></code>,
<code><a href="#topic+plot+2Cvalidation-method">plot,validation-method</a></code>,
<code><a href="#topic+sort+2Cvalidation-method">sort,validation-method</a></code>,
<code><a href="#topic+summary">summary</a>()</code>,
<code><a href="#topic+values">values</a>()</code>
</p>

<hr>
<h2 id='validator'>Define validation rules for data</h2><span id='topic+validator'></span>

<h3>Description</h3>

<p>Define validation rules for data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>validator(..., .file, .data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="validator_+3A_...">...</code></td>
<td>
<p>A comma-separated list of validating expressions</p>
</td></tr>
<tr><td><code id="validator_+3A_.file">.file</code></td>
<td>
<p>(optional) A character vector of file locations (see also the
section on file parsing in the <code><a href="#topic+syntax">syntax</a></code> help file).</p>
</td></tr>
<tr><td><code id="validator_+3A_.data">.data</code></td>
<td>
<p>(optional) A <code>data.frame</code> with columns <code>"rule"</code>,
<code>"name"</code>, and <code>"description"</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>validator</code> (see <code><a href="#topic+validator-class">validator-class</a></code>).
</p>


<h3>Validating expressions</h3>

<p>Each validating expression should evaluate to a <code>logical</code>. Allowed syntax of
the expression is described in <code><a href="#topic+syntax">syntax</a></code>.
</p>


<h3>See Also</h3>

<p>Other validator-methods: 
<code><a href="#topic++2B+2Cvalidator+2Cvalidator-method">+,validator,validator-method</a></code>,
<code><a href="#topic+plot+2Cvalidator-method">plot,validator-method</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
v &lt;- validator(
  height&gt;0
  ,weight&gt;0
  ,height &lt; 1.5*mean(height)
)
cf &lt;- confront(women, v)
summary(cf)

</code></pre>

<hr>
<h2 id='validator_from_dsd'>Extract a rule set from an SDMX DSD file</h2><span id='topic+validator_from_dsd'></span>

<h3>Description</h3>

<p>Data Structure Definitions contain references to code lists.
This function extracts those references and generates rules
that check data against code lists in an SDMX registry.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>validator_from_dsd(endpoint, agency_id, resource_id, version = "latest")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="validator_from_dsd_+3A_endpoint">endpoint</code></td>
<td>
<p><code>[character]</code> REST API endpoint of the SDMX registry</p>
</td></tr>
<tr><td><code id="validator_from_dsd_+3A_agency_id">agency_id</code></td>
<td>
<p><code>[character]</code> Agency ID (e.g. <code>"ESTAT"</code>)</p>
</td></tr>
<tr><td><code id="validator_from_dsd_+3A_resource_id">resource_id</code></td>
<td>
<p><code>[character]</code> Resource ID (e.g. <code>"CL_ACTIVITY"</code>)</p>
</td></tr>
<tr><td><code id="validator_from_dsd_+3A_version">version</code></td>
<td>
<p><code>[character]</code> Version of the code list.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code><a href="#topic+validator">validator</a></code>.
</p>


<h3>See Also</h3>

<p>Other sdmx: 
<code><a href="#topic+sdmx_codelist">sdmx_codelist</a>()</code>,
<code><a href="#topic+sdmx_endpoint">sdmx_endpoint</a>()</code>
</p>

<hr>
<h2 id='validator-class'>Store a set of rich validating rules.</h2><span id='topic+validator-class'></span>

<h3>Description</h3>

<p>Store a set of rich validating rules.
</p>


<h3>Details</h3>

<p>A validator stores a set of validatin rules. It is a child class of 
<code><a href="#topic+expressionset">expressionset</a></code> and
can be constructed with  <code><a href="#topic+validator">validator</a></code>. <code>validator</code> contains
an extra slot <code>"language"</code> stating the language in which the validation
rule is expressed. The default, and currently only supported language is
the <code>validate</code> language implemented by this package.
</p>


<h3>Exported S4 methods for <code>validator</code></h3>


<ul>
<li><p>Methods inherited from <code><a href="#topic+expressionset">expressionset</a></code>
</p>
</li>
<li><p><code><a href="#topic+confront">confront</a></code>
</p>
</li>
<li><p><code><a href="#topic+compare">compare</a></code>
</p>
</li></ul>



<h3>See also</h3>


<ul>
<li><p><code><a href="#topic+expressionset">expressionset</a></code>
</p>
</li></ul>


<hr>
<h2 id='values'>Get values from object</h2><span id='topic+values'></span><span id='topic+values+2Cconfrontation-method'></span><span id='topic+values+2Cvalidation-method'></span><span id='topic+values+2Cindication-method'></span>

<h3>Description</h3>

<p>Get values from object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>values(x, ...)

## S4 method for signature 'confrontation'
values(x, ...)

## S4 method for signature 'validation'
values(x, simplify = TRUE, drop = TRUE, ...)

## S4 method for signature 'indication'
values(x, simplify = TRUE, drop = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="values_+3A_x">x</code></td>
<td>
<p>an R object</p>
</td></tr>
<tr><td><code id="values_+3A_...">...</code></td>
<td>
<p>Arguments to pass to or from other methods</p>
</td></tr>
<tr><td><code id="values_+3A_simplify">simplify</code></td>
<td>
<p>Combine results with similar dimension structure into arrays?</p>
</td></tr>
<tr><td><code id="values_+3A_drop">drop</code></td>
<td>
<p>if a single vector or array results, drop 'list' attribute?</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other confrontation-methods: 
<code><a href="#topic++5B+2Cexpressionset-method">[,expressionset-method</a></code>,
<code><a href="#topic+as.data.frame+2Cconfrontation-method">as.data.frame,confrontation-method</a></code>,
<code><a href="#topic+confront">confront</a>()</code>,
<code><a href="#topic+confrontation-class">confrontation-class</a></code>,
<code><a href="#topic+errors">errors</a>()</code>,
<code><a href="#topic+event">event</a>()</code>,
<code><a href="#topic+keyset">keyset</a>()</code>,
<code><a href="#topic+length+2Cexpressionset-method">length,expressionset-method</a></code>
</p>
<p>Other validation-methods: 
<code><a href="#topic+aggregate+2Cvalidation-method">aggregate,validation-method</a></code>,
<code><a href="#topic+all+2Cvalidation-method">all,validation-method</a></code>,
<code><a href="#topic+any+2Cvalidation-method">any,validation-method</a></code>,
<code><a href="#topic+barplot+2Cvalidation-method">barplot,validation-method</a></code>,
<code><a href="#topic+check_that">check_that</a>()</code>,
<code><a href="#topic+compare">compare</a>()</code>,
<code><a href="#topic+confront">confront</a>()</code>,
<code><a href="#topic+event">event</a>()</code>,
<code><a href="#topic+names+3C-+2Crule+2Ccharacter-method">names&lt;-,rule,character-method</a></code>,
<code><a href="#topic+plot+2Cvalidation-method">plot,validation-method</a></code>,
<code><a href="#topic+sort+2Cvalidation-method">sort,validation-method</a></code>,
<code><a href="#topic+summary">summary</a>()</code>,
<code><a href="#topic+validation-class">validation-class</a></code>
</p>

<hr>
<h2 id='variables'>Get variable names</h2><span id='topic+variables'></span><span id='topic+variables+2Crule-method'></span><span id='topic+variables+2Clist-method'></span><span id='topic+variables+2Cdata.frame-method'></span><span id='topic+variables+2Cenvironment-method'></span><span id='topic+variables+2Cexpressionset-method'></span>

<h3>Description</h3>

<p>Generic function that extracts names of variables ocurring
in R objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>variables(x, ...)

## S4 method for signature 'rule'
variables(x, ...)

## S4 method for signature 'list'
variables(x, ...)

## S4 method for signature 'data.frame'
variables(x, ...)

## S4 method for signature 'environment'
variables(x, ...)

## S4 method for signature 'expressionset'
variables(x, as = c("vector", "matrix", "list"), dummy = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="variables_+3A_x">x</code></td>
<td>
<p>An R object</p>
</td></tr>
<tr><td><code id="variables_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to other methods.</p>
</td></tr>
<tr><td><code id="variables_+3A_as">as</code></td>
<td>
<p>how to return variables: 
</p>

<ul>
<li><p><code>'vector'</code> Return the uniqe vector of variables occurring in <code>x</code>.
</p>
</li>
<li><p><code>'matrix'</code> Return a boolean matrix, each row representing a rule, each column representing a variable.
</p>
</li>
<li><p><code>'list'</code> Return a named <code>list</code>, each entry containing a character vector with variable names.
</p>
</li></ul>
</td></tr>
<tr><td><code id="variables_+3A_dummy">dummy</code></td>
<td>
<p>Also retrieve transient variables set with the <code>:=</code> operator.</p>
</td></tr>
</table>


<h3>Methods (by class)</h3>


<ul>
<li> <p><code>variables(rule)</code>: Retrieve unique variable names
</p>
</li>
<li> <p><code>variables(list)</code>: Alias to <code>names.list</code>
</p>
</li>
<li> <p><code>variables(data.frame)</code>: Alias to <code>names.data.frame</code>
</p>
</li>
<li> <p><code>variables(environment)</code>: Alias to <code>ls</code>
</p>
</li>
<li> <p><code>variables(expressionset)</code>: Variables occuring in <code>x</code> either as a single list, or per rule.
</p>
</li></ul>


<h3>See Also</h3>

<p>Other expressionset-methods: 
<code><a href="#topic+as.data.frame">as.data.frame</a>()</code>,
<code><a href="#topic+as.data.frame+2Cexpressionset-method">as.data.frame,expressionset-method</a></code>,
<code><a href="#topic+created">created</a>()</code>,
<code><a href="#topic+description">description</a>()</code>,
<code><a href="#topic+label">label</a>()</code>,
<code><a href="#topic+meta">meta</a>()</code>,
<code><a href="#topic+names+3C-+2Crule+2Ccharacter-method">names&lt;-,rule,character-method</a></code>,
<code><a href="#topic+origin">origin</a>()</code>,
<code><a href="#topic+plot+2Cvalidator-method">plot,validator-method</a></code>,
<code><a href="#topic+summary">summary</a>()</code>,
<code><a href="#topic+voptions">voptions</a>()</code>
</p>
<p>Other expressionset-methods: 
<code><a href="#topic+as.data.frame">as.data.frame</a>()</code>,
<code><a href="#topic+as.data.frame+2Cexpressionset-method">as.data.frame,expressionset-method</a></code>,
<code><a href="#topic+created">created</a>()</code>,
<code><a href="#topic+description">description</a>()</code>,
<code><a href="#topic+label">label</a>()</code>,
<code><a href="#topic+meta">meta</a>()</code>,
<code><a href="#topic+names+3C-+2Crule+2Ccharacter-method">names&lt;-,rule,character-method</a></code>,
<code><a href="#topic+origin">origin</a>()</code>,
<code><a href="#topic+plot+2Cvalidator-method">plot,validator-method</a></code>,
<code><a href="#topic+summary">summary</a>()</code>,
<code><a href="#topic+voptions">voptions</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
v &lt;- validator(
  root = y := sqrt(x)
 , average = mean(x) &gt; 3
 , sum = x + y == z
)
variables(v)
variables(v,dummy=TRUE)
variables(v,matrix=TRUE)
variables(v,matrix=TRUE,dummy=TRUE)


</code></pre>

<hr>
<h2 id='voptions'>Set or get options globally or per object.</h2><span id='topic+voptions'></span><span id='topic+voptions+2CANY-method'></span><span id='topic+validate_options'></span><span id='topic+reset'></span><span id='topic+reset+2CANY-method'></span><span id='topic+voptions+2Cexpressionset-method'></span><span id='topic+reset+2Cexpressionset-method'></span>

<h3>Description</h3>

<p>There are three ways to specify options for this package.
</p>

<ul>
<li><p>Globally. Setting <code>voptions(option1=value1,option2=value2,...)</code>
sets global options.
</p>
</li>
<li><p>Per object. Setting <code>voptions(x=&lt;object&gt;, option1=value1,...)</code>,
causes all relevant functions that use that object (e.g. 
<code><a href="#topic+confront">confront</a></code>) to use those local settings.
</p>
</li>
<li><p>At execution time. Relevant functions (e.g. <code><a href="#topic+confront">confront</a></code>) take
optional arguments allowing one
to define options to be used during the current function call
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>voptions(x = NULL, ...)

## S4 method for signature 'ANY'
voptions(x = NULL, ...)

validate_options(...)

reset(x = NULL)

## S4 method for signature 'ANY'
reset(x = NULL)

## S4 method for signature 'expressionset'
voptions(x = NULL, ...)

## S4 method for signature 'expressionset'
reset(x = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="voptions_+3A_x">x</code></td>
<td>
<p>(optional) an object inheriting from <code>expressionset</code> such as <code><a href="#topic+validator">validator</a></code> or <code><a href="#topic+indicator">indicator</a></code>.</p>
</td></tr>
<tr><td><code id="voptions_+3A_...">...</code></td>
<td>
<p>Name of an option (character) to retrieve options or <code>option = value</code> pairs to set options.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>When requesting option settings: a <code>list</code>. When setting options,
the whole options list is returned silently.
</p>


<h3>Options for the validate package</h3>

<p>Currently the following options are supported.
</p>

<ul>
<li><p><code>na.value</code> (<code>NA</code>,<code>TRUE</code>,<code>FALSE</code>; <code>NA</code>) Value
to return when a validating statement results in <code>NA</code>.
</p>
</li>
<li><p><code>raise</code> (<code>"none"</code>,<code>"error"</code>,<code>"all"</code>;
<code>"none"</code>) Control if the <code><a href="#topic+confront">confront</a></code> methods catch or raise
exceptions.
The 'all' setting is useful when debugging validation scripts.
</p>
</li>
<li><p><code>lin.eq.eps</code> ('numeric'; 1e-8) The precision used when evaluating
linear equalities. To be used to control for machine rounding.
</p>
</li>
<li><p><code>"reset"</code> Reset to factory settings.
</p>
</li></ul>



<h3>See Also</h3>

<p>Other expressionset-methods: 
<code><a href="#topic+as.data.frame">as.data.frame</a>()</code>,
<code><a href="#topic+as.data.frame+2Cexpressionset-method">as.data.frame,expressionset-method</a></code>,
<code><a href="#topic+created">created</a>()</code>,
<code><a href="#topic+description">description</a>()</code>,
<code><a href="#topic+label">label</a>()</code>,
<code><a href="#topic+meta">meta</a>()</code>,
<code><a href="#topic+names+3C-+2Crule+2Ccharacter-method">names&lt;-,rule,character-method</a></code>,
<code><a href="#topic+origin">origin</a>()</code>,
<code><a href="#topic+plot+2Cvalidator-method">plot,validator-method</a></code>,
<code><a href="#topic+summary">summary</a>()</code>,
<code><a href="#topic+variables">variables</a>()</code>
</p>
<p>Other expressionset-methods: 
<code><a href="#topic+as.data.frame">as.data.frame</a>()</code>,
<code><a href="#topic+as.data.frame+2Cexpressionset-method">as.data.frame,expressionset-method</a></code>,
<code><a href="#topic+created">created</a>()</code>,
<code><a href="#topic+description">description</a>()</code>,
<code><a href="#topic+label">label</a>()</code>,
<code><a href="#topic+meta">meta</a>()</code>,
<code><a href="#topic+names+3C-+2Crule+2Ccharacter-method">names&lt;-,rule,character-method</a></code>,
<code><a href="#topic+origin">origin</a>()</code>,
<code><a href="#topic+plot+2Cvalidator-method">plot,validator-method</a></code>,
<code><a href="#topic+summary">summary</a>()</code>,
<code><a href="#topic+variables">variables</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# set an option, local to a validator object:
v &lt;- validator(x + y &gt; z)
voptions(v,raise='all')
# check that local option was set:
voptions(v,'raise')
# check that global options have not changed:
voptions('raise')
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
