<!DOCTYPE html><html lang="en"><head><title>Help for package SBICgraph</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SBICgraph}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#addition'><p>Enrichment step for constructing the model pool</p></a></li>
<li><a href='#comparison'><p>Comparing the real and estimated adjacency matrix</p></a></li>
<li><a href='#deletion'><p>Pruning step for constructing the model pool</p></a></li>
<li><a href='#mle'><p>Estimate the precision matrix for multivariate normal distribution with given adjacency matrix using maximum likelihood</p></a></li>
<li><a href='#modelset'><p>Construct model pool using the two-step algorithm</p></a></li>
<li><a href='#sbic'><p>Structural Bayesian information criterion for multivariate normal data with a given graph structure</p></a></li>
<li><a href='#sggm'><p>Model selection of Gaussian graphical model based on SBIC</p></a></li>
<li><a href='#simulate'><p>Randomly generate a adjacency matrix based on which to simulate data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Structural Bayesian Information Criterion for Graphical Models</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Description:</td>
<td>This is the implementation of the novel structural Bayesian information criterion by Zhou, 2020 (under review).
   In this method, the prior structure is modeled and incorporated into the Bayesian information criterion framework. 
   Additionally, we also provide the implementation of a two-step algorithm to generate the candidate model pool.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>glmnet, MASS, network</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-03-01 16:13:33 UTC; quang</td>
</tr>
<tr>
<td>Author:</td>
<td>Quang Nguyen <a href="https://orcid.org/0000-0002-2072-3279"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [cre, aut],
  Jie Zhou [aut],
  Anne Hoen [aut],
  Jiang Gui [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Quang Nguyen &lt;Quang.P.Nguyen.GR@dartmouth.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-03-02 19:10:09 UTC</td>
</tr>
</table>
<hr>
<h2 id='addition'>Enrichment step for constructing the model pool</h2><span id='topic+addition'></span>

<h3>Description</h3>

<p>This is the esnrichment step in the two-step algorithm to construct the model pool (internal use only)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>addition(data, lambda, P)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="addition_+3A_data">data</code></td>
<td>
<p>An <code>n</code> by <code>p</code> matrix of observations</p>
</td></tr>
<tr><td><code id="addition_+3A_lambda">lambda</code></td>
<td>
<p>Vector of tuning parameter</p>
</td></tr>
<tr><td><code id="addition_+3A_p">P</code></td>
<td>
<p>Prior adjacency matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of model objects
</p>


<h3>Author(s)</h3>

<p>Jie Zhou
</p>

<hr>
<h2 id='comparison'>Comparing the real and estimated adjacency matrix</h2><span id='topic+comparison'></span>

<h3>Description</h3>

<p>Comparing the two adjacency matrices for false discovery rate and positive selection rate. Used
for model validation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>comparison(real, estimate)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="comparison_+3A_real">real</code></td>
<td>
<p>The real matrix <code>p</code> by <code>p</code> adjacency matrix likely from simulated data</p>
</td></tr>
<tr><td><code id="comparison_+3A_estimate">estimate</code></td>
<td>
<p>The estimated matrix <code>p</code> by <code>p</code> adjacency matrix likely estimated using the SBIC procedure</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of the following evaluation metrics 
</p>
<table role = "presentation">
<tr><td><code>PSR</code></td>
<td>
<p>Positive Selection Rate</p>
</td></tr>
<tr><td><code>FDR</code></td>
<td>
<p>False Discovery rate</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jie Zhou
</p>

<hr>
<h2 id='deletion'>Pruning step for constructing the model pool</h2><span id='topic+deletion'></span>

<h3>Description</h3>

<p>This is the pruning step in the two-step algorithm to construct the model pool (internal use only)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>deletion(data, lambda, P)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="deletion_+3A_data">data</code></td>
<td>
<p>An <code>n</code> by <code>p</code> matrix of observations</p>
</td></tr>
<tr><td><code id="deletion_+3A_lambda">lambda</code></td>
<td>
<p>Vector of tuning parameter</p>
</td></tr>
<tr><td><code id="deletion_+3A_p">P</code></td>
<td>
<p>Prior adjacency matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of model objects
</p>


<h3>Author(s)</h3>

<p>Jie Zhou
</p>

<hr>
<h2 id='mle'>Estimate the precision matrix for multivariate normal distribution with given adjacency matrix using maximum likelihood</h2><span id='topic+mle'></span>

<h3>Description</h3>

<p>This function find the maximum likelihood estimate of the 
precision matrix with given adjacency matrix for multivariate normal distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mle(data, priori)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mle_+3A_data">data</code></td>
<td>
<p>An <code>n</code> by <code>p</code> dataframe representing the observations</p>
</td></tr>
<tr><td><code id="mle_+3A_priori">priori</code></td>
<td>
<p>A <code>p</code> by <code>p</code> matrix representing the given adjacency matrix</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The methods are based on the relationship between precision matrix of the 
multivariate normal distribution and regression coefficients.
</p>


<h3>Value</h3>

<p>Returns a <code>p</code> by <code>p</code> matrix estimate of the precision matrix
</p>


<h3>Author(s)</h3>

<p>Jie Zhou
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  set.seed(1)
  d=simulate(n=100,p=200, m1=100, m2=30)
  data=d$data
  priori=d$realnetwork
  precision=mle(data=data,priori=priori)
</code></pre>

<hr>
<h2 id='modelset'>Construct model pool using the two-step algorithm</h2><span id='topic+modelset'></span>

<h3>Description</h3>

<p>For a given prior graph, the two-step algorithm, including edge enrichment and pruning, 
is used to construct the model pool
</p>


<h3>Usage</h3>

<pre><code class='language-R'>modelset(data, lambda, P)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="modelset_+3A_data">data</code></td>
<td>
<p>A <code>n</code> by <code>p</code> data frame of observations</p>
</td></tr>
<tr><td><code id="modelset_+3A_lambda">lambda</code></td>
<td>
<p>Tuning parameter vector</p>
</td></tr>
<tr><td><code id="modelset_+3A_p">P</code></td>
<td>
<p>Prior adjacency matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list including all the candidate models in the model pool. 
Each model is represented by a <code>p</code> by <code>p</code> adjacency matrix
</p>


<h3>Author(s)</h3>

<p>Jie Zhou
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  set.seed(1)
  d=simulate(n=100, p=100, m1 = 100, m2 = 30)
  data=d$data
  P=d$priornetwork
  lambda=exp(seq(-5,5,length=100))
  candidates=modelset(data=data,lambda=lambda, P=P)

</code></pre>

<hr>
<h2 id='sbic'>Structural Bayesian information criterion for multivariate normal data with a given graph structure</h2><span id='topic+sbic'></span>

<h3>Description</h3>

<p>This function estimates the novel structural Bayesian information criterion given the data and
a given graph structure
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sbic(data, theta, prob, P)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sbic_+3A_data">data</code></td>
<td>
<p>A <code>n</code> by <code>p</code> dataframe representing observations</p>
</td></tr>
<tr><td><code id="sbic_+3A_theta">theta</code></td>
<td>
<p>The <code>p</code> by <code>p</code> matrix representing the given graph structure</p>
</td></tr>
<tr><td><code id="sbic_+3A_prob">prob</code></td>
<td>
<p>The expected error rate</p>
</td></tr>
<tr><td><code id="sbic_+3A_p">P</code></td>
<td>
<p>The prior adjacency matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The value of sbic with given temperature parameter and prior adjacency matrix
</p>


<h3>Author(s)</h3>

<p>Jie Zhou
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  set.seed(1)
  d=simulate(n=100, p=100, m1 = 100, m2 = 30)
  data=d$data
  P=d$priornetwork
  theta=d$realnetwork
  prob=0.15
  index=sbic(data=data, theta=theta, prob=prob, P=P)

</code></pre>

<hr>
<h2 id='sggm'>Model selection of Gaussian graphical model based on SBIC</h2><span id='topic+sggm'></span>

<h3>Description</h3>

<p>Select the model based on the SBIC criterion and the two-step algorithm
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sggm(data, lambda, M, prob)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sggm_+3A_data">data</code></td>
<td>
<p>An n by p dataframe representing the observations</p>
</td></tr>
<tr><td><code id="sggm_+3A_lambda">lambda</code></td>
<td>
<p>A vector of tuning parameters used to build the model pool</p>
</td></tr>
<tr><td><code id="sggm_+3A_m">M</code></td>
<td>
<p>The prior adjacency matrix</p>
</td></tr>
<tr><td><code id="sggm_+3A_prob">prob</code></td>
<td>
<p>The mean error rate</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of objects containing: 
</p>
<table role = "presentation">
<tr><td><code>networkhat</code></td>
<td>
<p>The final selected adjacency matrix</p>
</td></tr>
<tr><td><code>candidates</code></td>
<td>
<p>The model pool</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jie Zhou
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
   set.seed(1)
   m1 = 100
   m2 = 30
   p = 100
   n = 100
   d=simulate(n=n,p=p, m1 = m1, m2 = m2) # simulate fake data 
   lambda=exp(seq(-5,5,length=100)) # tuning parameter
   data=d$data # data from the simulation
   M=d$priornetwork # prior network from simulation
   # calculating the error rate 
   r1=m2/m1
   r2=m2/(p*(p-1)/2-m1)
   r=(r1+r2)/2
   # apply sggm 
   result=sggm(data=data, lambda=lambda, M=M, prob=r)
   # compare the final network and the true network 
   result$networkhat
   d$realnetwork

</code></pre>

<hr>
<h2 id='simulate'>Randomly generate a adjacency matrix based on which to simulate data</h2><span id='topic+simulate'></span>

<h3>Description</h3>

<p>According to a given edge density, first generate the adjacency matrix P of a graph. 
Based on P, the simulated multivariate normal data is generated with
mean zero and a specified given precision matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate(n, p, m1, m2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simulate_+3A_n">n</code></td>
<td>
<p>Sample size</p>
</td></tr>
<tr><td><code id="simulate_+3A_p">p</code></td>
<td>
<p>The number of vertices in graph or the number of variables</p>
</td></tr>
<tr><td><code id="simulate_+3A_m1">m1</code></td>
<td>
<p>The number of edges in the true graph</p>
</td></tr>
<tr><td><code id="simulate_+3A_m2">m2</code></td>
<td>
<p>The number of elements in adjacency matrix that stay in different states, 
i.e., 0 or 1, in true and prior graphs</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list including the simulated data, real adjacency matrix and a prior adjacency matrix
</p>
<table role = "presentation">
<tr><td><code>data</code></td>
<td>
<p>simulated data</p>
</td></tr>
<tr><td><code>realnetwork</code></td>
<td>
<p>real adjacency matrix</p>
</td></tr>
<tr><td><code>priornetowrk</code></td>
<td>
<p>prior adjacency matrix</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jie Zhou
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  set.seed(1)
  d=simulate(n=100,p=200, m1=100, m2=30)
  d$data
  d$realnetwork
  d$priornetwork
  
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
