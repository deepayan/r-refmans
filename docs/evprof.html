<!DOCTYPE html><html><head><title>Help for package evprof</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {evprof}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#california_ev_model'><p>EV model example</p></a></li>
<li><a href='#california_ev_sessions'><p>EV charging sessions example</p></a></li>
<li><a href='#california_ev_sessions_profiles'><p>Clustered EV charging sessions example</p></a></li>
<li><a href='#california_GMM'><p>Gaussian Mixture Models examples</p></a></li>
<li><a href='#choose_k_GMM'><p>Visualize BIC indicator to choose the number of clusters</p></a></li>
<li><a href='#cluster_sessions'><p>Cluster sessions with <code>mclust</code> package</p></a></li>
<li><a href='#convert_time_dt_to_plot_dt'><p>Modify datetime values according evprof.start.hour</p></a></li>
<li><a href='#convert_time_dt_to_plot_num'><p>Convert datetime values to sorted numeric values considering a start time</p></a></li>
<li><a href='#convert_time_num_to_chr'><p>Convert numeric time value (hour-based) to character hour in %H:%M format</p></a></li>
<li><a href='#convert_time_num_to_period'><p>Convert numeric time value to a datetime period (hour-based)</p></a></li>
<li><a href='#cut_sessions'><p>Cut outliers based on minimum and maximum limits of ConnectionHours and ConnectionStartDateTime variables</p></a></li>
<li><a href='#define_clusters'><p>Define each cluster with a user profile interpretation</p></a></li>
<li><a href='#detect_outliers'><p>Detect outliers</p></a></li>
<li><a href='#divide_by_disconnection'><p>Divide sessions by disconnection day</p></a></li>
<li><a href='#divide_by_timecycle'><p>Divide sessions by time-cycle</p></a></li>
<li><a href='#drop_outliers'><p>Drop outliers</p></a></li>
<li><a href='#get_charging_rates_distribution'><p>Get charging rates distribution in percentages</p></a></li>
<li><a href='#get_connection_model_mclust_object'><p>Perform <code>mclust::Mclust</code> clustering for multivariate GMM</p></a></li>
<li><a href='#get_connection_model_params'><p>Extract models parameters from mclust object</p></a></li>
<li><a href='#get_connection_models'><p>Get a tibble of connection GMM for every user profile</p></a></li>
<li><a href='#get_daily_avg_n_sessions'><p>Get the daily average number of sessions given a range of years, months and weekdays</p></a></li>
<li><a href='#get_daily_n_sessions'><p>Get daily number of sessions given a range of years, months and weekdays</p></a></li>
<li><a href='#get_dbscan_params'><p>Get the minPts and eps values for DBSCAN to label only a specific percentage as noise</p></a></li>
<li><a href='#get_division_line'><p>ggplot2 type function to plot a division line</p></a></li>
<li><a href='#get_energy_model_mclust_object'><p>Get Mclust object of univariate Gaussian Mixture Models</p></a></li>
<li><a href='#get_energy_model_parameters'><p>Get energy univariate Gaussian Mixture Model</p></a></li>
<li><a href='#get_energy_models'><p>Get a tibble of energy GMM for every user profile</p></a></li>
<li><a href='#get_ev_model'><p>Get the EV model object of class <code>evmodel</code></p></a></li>
<li><a href='#mutate_to_log'><p>Logarithmic transformation to ConnectionStartDateTime and ConnectionHours variables</p></a></li>
<li><a href='#plot_bivarGMM'><p>Plot Bivariate Gaussian Mixture Models</p></a></li>
<li><a href='#plot_density_2D'><p>Density plot in 2D, considering Start time and Connection duration as variables</p></a></li>
<li><a href='#plot_density_3D'><p>Density plot in 3D, considering Start time and Connection duration as variables</p></a></li>
<li><a href='#plot_division_lines'><p>Iteration over evprof::plot_division_line function to plot multiple lines</p></a></li>
<li><a href='#plot_energy_models'><p>Compare density of estimated energy with density of real energy vector</p></a></li>
<li><a href='#plot_histogram'><p>Histogram of a variable from sessions data set</p></a></li>
<li><a href='#plot_histogram_grid'><p>Grid of multiple variable histograms</p></a></li>
<li><a href='#plot_kNNdist'><p>Plot kNNdist</p></a></li>
<li><a href='#plot_model_clusters'><p>Plot all bi-variable GMM (clusters) with the colors corresponding</p>
to the assigned user profile. This shows which clusters correspond to which
user profile, and the proportion of every user profile.</a></li>
<li><a href='#plot_outliers'><p>Plot outlying sessions</p></a></li>
<li><a href='#plot_points'><p>Scatter plot of sessions</p></a></li>
<li><a href='#print.evmodel'><p><code>print</code> method for <code>evmodel</code> object class</p></a></li>
<li><a href='#read_ev_model'><p>Read an EV model JSON file and convert it to object of class <code>evmodel</code></p></a></li>
<li><a href='#round_to_half'><p>Round numeric time value to half hour basis.</p></a></li>
<li><a href='#round_to_interval'><p>Round to nearest interval</p></a></li>
<li><a href='#save_clustering_iterations'><p>Save iteration plots in PDF file</p></a></li>
<li><a href='#save_ev_model'><p>Save the EV model object of class <code>evmodel</code> to a JSON file</p></a></li>
<li><a href='#sessions_feature_names'><p>Names of standard features of a sessions dataset</p></a></li>
<li><a href='#sessions_summary_feature_names'><p>Names of features to summarise in evprof functions</p></a></li>
<li><a href='#set_profiles'><p>Classify sessions into user profiles</p></a></li>
<li><a href='#summarise_sessions'><p>Statistic summary of sessions features</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Electric Vehicle Charging Sessions Profiling and Modelling</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.2</td>
</tr>
<tr>
<td>Description:</td>
<td>Tools for modelling electric vehicle charging sessions into
    generic groups with similar connection patterns called "user profiles",
    using Gaussian Mixture Models clustering. The clustering and profiling
    methodology is described in Cañigueral and Meléndez (2021, ISBN:0142-0615) 
    &lt;<a href="https://doi.org/10.1016%2Fj.ijepes.2021.107195">doi:10.1016/j.ijepes.2021.107195</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/mcanigueral/evprof/">https://github.com/mcanigueral/evprof/</a>,
<a href="https://mcanigueral.github.io/evprof/">https://mcanigueral.github.io/evprof/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/mcanigueral/evprof/issues">https://github.com/mcanigueral/evprof/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>cowplot, dbscan, dplyr, ggplot2, jsonlite, lubridate, MASS,
mclust, plotly, purrr, rlang, tibble, tidyr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, spelling, testthat (&ge; 3.0.0), utils</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-14 14:18:04 UTC; mcanigueral</td>
</tr>
<tr>
<td>Author:</td>
<td>Marc Cañigueral <a href="https://orcid.org/0000-0001-9724-5829"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre, cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Marc Cañigueral &lt;marc.canigueral@udg.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-14 14:50:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='california_ev_model'>EV model example</h2><span id='topic+california_ev_model'></span>

<h3>Description</h3>

<p>Example of an <code>evmodel</code> object created with <code>evprof</code> for testing purposes.
It has been created using an Open source data set of EV charging sessions
provided by <a href="https://acnportal.readthedocs.io/en/latest/">ACN</a>.
More information about the development of the model in the evprof website:
<a href="https://mcanigueral.github.io/evprof/articles/california.html">https://mcanigueral.github.io/evprof/articles/california.html</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>california_ev_model
</code></pre>


<h3>Format</h3>



<h4><code>california_ev_model</code></h4>

<p>An <code>evmodel</code> object.
</p>

<dl>
<dt>metadata</dt><dd><p>Information about the characteristics of the model</p>
</dd>
<dt>model</dt><dd><p>Gaussian Mixture Models for connection times and energy</p>
</dd>
</dl>




<h3>Source</h3>

<p><a href="https://mcanigueral.github.io/evprof/articles/california.html">https://mcanigueral.github.io/evprof/articles/california.html</a>
</p>

<hr>
<h2 id='california_ev_sessions'>EV charging sessions example</h2><span id='topic+california_ev_sessions'></span>

<h3>Description</h3>

<p>Example of an charging sessions data set ready to use by <code>evprof</code> functions.
It is the open source data set downloaded from the
<a href="https://ev.caltech.edu/dataset">ACN-Data website</a>, transformed according
to the standard names defined by <code>evprof</code>
(see <a href="https://mcanigueral.github.io/evprof/articles/sessions-format.html">this</a> article).
More information about the analysis of this data set in the evprof website:
<a href="https://mcanigueral.github.io/evprof/articles/california.html">https://mcanigueral.github.io/evprof/articles/california.html</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>california_ev_sessions
</code></pre>


<h3>Format</h3>



<h4><code>california_ev_sessions</code></h4>

<p>A <code>tibble</code> object with standard variable names defined by <code>evprof</code>
</p>



<h3>Source</h3>

<p><a href="https://ev.caltech.edu/dataset">https://ev.caltech.edu/dataset</a>
</p>

<hr>
<h2 id='california_ev_sessions_profiles'>Clustered EV charging sessions example</h2><span id='topic+california_ev_sessions_profiles'></span>

<h3>Description</h3>

<p>Example of an charging sessions data set that has been clustered by <code>evprof</code> functions.
(see <a href="https://mcanigueral.github.io/evprof/articles/california.html#sessions-classification-into-user-profiles">this article</a>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>california_ev_sessions_profiles
</code></pre>


<h3>Format</h3>



<h4><code>california_ev_sessions_profiles</code></h4>

<p>A <code>tibble</code> object with standard variable names defined by <code>evprof</code>
</p>



<h3>Source</h3>

<p><a href="https://ev.caltech.edu/dataset">https://ev.caltech.edu/dataset</a>
</p>

<hr>
<h2 id='california_GMM'>Gaussian Mixture Models examples</h2><span id='topic+california_GMM'></span>

<h3>Description</h3>

<p>Example of connection and energy GMM obtained from functions
<code>get_connection_models</code> and <code>get_energy_models</code> respectively.
They have been created using an Open source data set of EV charging sessions
provided by <a href="https://acnportal.readthedocs.io/en/latest/">ACN</a>.
More information about the development of the model in the evprof website:
<a href="https://mcanigueral.github.io/evprof/articles/california.html">https://mcanigueral.github.io/evprof/articles/california.html</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>california_GMM
</code></pre>


<h3>Format</h3>

<p>list
</p>

<dl>
<dt>connection_models</dt><dd><p>Tibble with the parameters of the bi-variate
(connection start time and connection duration) GMM from the working/weekend days
sessions of the California data set obtained from <code>get_connection_models</code></p>
</dd>
<dt>energy_models</dt><dd><p>Tibble with the parameters of the uni-variate
(energy) GMM from the working/weekend days sessions of the California data set
obtained from <code>get_energy_models</code></p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://mcanigueral.github.io/evprof/articles/california.html">https://mcanigueral.github.io/evprof/articles/california.html</a>
</p>

<hr>
<h2 id='choose_k_GMM'>Visualize BIC indicator to choose the number of clusters</h2><span id='topic+choose_k_GMM'></span>

<h3>Description</h3>

<p>The Baysian Information Criterion (BIC) is the value of the maximized
loglikelihood with a penalty on the number of parameters in the model,
and allows comparison of models with differing parameterizations and/or
differing numbers of clusters. In general the larger the value of the BIC,
the stronger the evidence for the model and number of clusters
(see, e.g. Fraley and Raftery 2002a).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>choose_k_GMM(
  sessions,
  k,
  mclust_tol = 1e-08,
  mclust_itmax = 10000,
  log = FALSE,
  start = getOption("evprof.start.hour")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="choose_k_GMM_+3A_sessions">sessions</code></td>
<td>
<p>tibble, sessions data set in evprof
<a href="https://mcanigueral.github.io/evprof/articles/sessions-format.html">standard format</a>.</p>
</td></tr>
<tr><td><code id="choose_k_GMM_+3A_k">k</code></td>
<td>
<p>sequence with the number of clusters, for example 1:10, for 1 to 10 clusters.</p>
</td></tr>
<tr><td><code id="choose_k_GMM_+3A_mclust_tol">mclust_tol</code></td>
<td>
<p>tolerance parameter for clustering</p>
</td></tr>
<tr><td><code id="choose_k_GMM_+3A_mclust_itmax">mclust_itmax</code></td>
<td>
<p>maximum number of iterations</p>
</td></tr>
<tr><td><code id="choose_k_GMM_+3A_log">log</code></td>
<td>
<p>logical, whether to transform <code>ConnectionStartDateTime</code> and
<code>ConnectionHours</code> variables to natural logarithmic scale (base = <code>exp(1)</code>).</p>
</td></tr>
<tr><td><code id="choose_k_GMM_+3A_start">start</code></td>
<td>
<p>integer, start hour in the x axis of the plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>BIC plot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
choose_k_GMM(california_ev_sessions, k = 1:4, start = 3)



</code></pre>

<hr>
<h2 id='cluster_sessions'>Cluster sessions with <code>mclust</code> package</h2><span id='topic+cluster_sessions'></span>

<h3>Description</h3>

<p>Cluster sessions with <code>mclust</code> package
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cluster_sessions(
  sessions,
  k,
  seed,
  mclust_tol = 1e-08,
  mclust_itmax = 10000,
  log = FALSE,
  start = getOption("evprof.start.hour")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cluster_sessions_+3A_sessions">sessions</code></td>
<td>
<p>tibble, sessions data set in evprof
<a href="https://mcanigueral.github.io/evprof/articles/sessions-format.html">standard format</a>.</p>
</td></tr>
<tr><td><code id="cluster_sessions_+3A_k">k</code></td>
<td>
<p>number of clusters</p>
</td></tr>
<tr><td><code id="cluster_sessions_+3A_seed">seed</code></td>
<td>
<p>random seed</p>
</td></tr>
<tr><td><code id="cluster_sessions_+3A_mclust_tol">mclust_tol</code></td>
<td>
<p>tolerance parameter for clustering</p>
</td></tr>
<tr><td><code id="cluster_sessions_+3A_mclust_itmax">mclust_itmax</code></td>
<td>
<p>maximum number of iterations</p>
</td></tr>
<tr><td><code id="cluster_sessions_+3A_log">log</code></td>
<td>
<p>logical, whether to transform <code>ConnectionStartDateTime</code> and
<code>ConnectionHours</code> variables to natural logarithmic scale (base = <code>exp(1)</code>).</p>
</td></tr>
<tr><td><code id="cluster_sessions_+3A_start">start</code></td>
<td>
<p>integer, start hour in the x axis of the plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list with two attributes: sessions and models
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)

# Select working day sessions (`Timecycle == 1`) that
# disconnect the same day (`Disconnection == 1`)
sessions_day &lt;- california_ev_sessions %&gt;%
  divide_by_timecycle(
    months_cycles = list(1:12), # Not differentiation between months
    wdays_cycles = list(1:5, 6:7) # Differentiation between workdays/weekends
  ) %&gt;%
  divide_by_disconnection(
    division_hour = 10, start = 3
  ) %&gt;%
  filter(
    Disconnection == 1, Timecycle == 1
  ) %&gt;%
  sample_frac(0.05)
plot_points(sessions_day, start = 3)

# Identify two clusters
sessions_clusters &lt;- cluster_sessions(
  sessions_day, k=2, seed = 1234, log = TRUE
)

# The column `Cluster` has been added
names(sessions_clusters$sessions)
plot_points(sessions_clusters$sessions) +
  ggplot2::aes(color = Cluster)

</code></pre>

<hr>
<h2 id='convert_time_dt_to_plot_dt'>Modify datetime values according evprof.start.hour</h2><span id='topic+convert_time_dt_to_plot_dt'></span>

<h3>Description</h3>

<p>Modify datetime values according evprof.start.hour
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convert_time_dt_to_plot_dt(time_dt, start = getOption("evprof.start.hour"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="convert_time_dt_to_plot_dt_+3A_time_dt">time_dt</code></td>
<td>
<p>Datetime value</p>
</td></tr>
<tr><td><code id="convert_time_dt_to_plot_dt_+3A_start">start</code></td>
<td>
<p>Start hour (int)</p>
</td></tr>
</table>

<hr>
<h2 id='convert_time_dt_to_plot_num'>Convert datetime values to sorted numeric values considering a start time</h2><span id='topic+convert_time_dt_to_plot_num'></span>

<h3>Description</h3>

<p>Convert datetime values to sorted numeric values considering a start time
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convert_time_dt_to_plot_num(time_dt, start = getOption("evprof.start.hour"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="convert_time_dt_to_plot_num_+3A_time_dt">time_dt</code></td>
<td>
<p>Datetime value</p>
</td></tr>
<tr><td><code id="convert_time_dt_to_plot_num_+3A_start">start</code></td>
<td>
<p>Start hour (int)</p>
</td></tr>
</table>

<hr>
<h2 id='convert_time_num_to_chr'>Convert numeric time value (hour-based) to character hour in %H:%M format</h2><span id='topic+convert_time_num_to_chr'></span>

<h3>Description</h3>

<p>Convert numeric time value (hour-based) to character hour in %H:%M format
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convert_time_num_to_chr(time_num)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="convert_time_num_to_chr_+3A_time_num">time_num</code></td>
<td>
<p>Numeric time value (hour-based)</p>
</td></tr>
</table>

<hr>
<h2 id='convert_time_num_to_period'>Convert numeric time value to a datetime period (hour-based)</h2><span id='topic+convert_time_num_to_period'></span>

<h3>Description</h3>

<p>Convert numeric time value to a datetime period (hour-based)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convert_time_num_to_period(time_num)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="convert_time_num_to_period_+3A_time_num">time_num</code></td>
<td>
<p>Numeric time value (hour-based)</p>
</td></tr>
</table>

<hr>
<h2 id='cut_sessions'>Cut outliers based on minimum and maximum limits of ConnectionHours and ConnectionStartDateTime variables</h2><span id='topic+cut_sessions'></span>

<h3>Description</h3>

<p>Cut outliers based on minimum and maximum limits of ConnectionHours and ConnectionStartDateTime variables
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cut_sessions(
  sessions,
  connection_hours_min = NA,
  connection_hours_max = NA,
  connection_start_min = NA,
  connection_start_max = NA,
  log = FALSE,
  start = getOption("evprof.start.hour")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cut_sessions_+3A_sessions">sessions</code></td>
<td>
<p>tibble, sessions data set in evprof
<a href="https://mcanigueral.github.io/evprof/articles/sessions-format.html">standard format</a>.</p>
</td></tr>
<tr><td><code id="cut_sessions_+3A_connection_hours_min">connection_hours_min</code></td>
<td>
<p>numeric, minimum of connection hours (duration). If NA the minimum value is considered.</p>
</td></tr>
<tr><td><code id="cut_sessions_+3A_connection_hours_max">connection_hours_max</code></td>
<td>
<p>numeric, maximum of connection hours (duration). If NA the maximum value is considered.</p>
</td></tr>
<tr><td><code id="cut_sessions_+3A_connection_start_min">connection_start_min</code></td>
<td>
<p>numeric, minimum hour of connection start (hour as numeric). If NA the minimum value is considered.</p>
</td></tr>
<tr><td><code id="cut_sessions_+3A_connection_start_max">connection_start_max</code></td>
<td>
<p>numeric, maximum hour of connection start (hour as numeric). If NA the maximum value is considered.</p>
</td></tr>
<tr><td><code id="cut_sessions_+3A_log">log</code></td>
<td>
<p>logical, whether to transform <code>ConnectionStartDateTime</code> and
<code>ConnectionHours</code> variables to natural logarithmic scale (base = <code>exp(1)</code>).</p>
</td></tr>
<tr><td><code id="cut_sessions_+3A_start">start</code></td>
<td>
<p>integer, start hour in the x axis of the plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>session dataframe
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)
# Localize the outlying sessions above a certain threshold
california_ev_sessions %&gt;%
  sample_frac(0.05) %&gt;%
  plot_points(start = 3)

# For example sessions that start before 5 AM or that are
# longer than 20 hours are considered outliers
sessions_clean &lt;- california_ev_sessions %&gt;%
  sample_frac(0.05) %&gt;%
  cut_sessions(
    start = 3,
    connection_hours_max = 20,
    connection_start_min = 5
  )
plot_points(sessions_clean, start = 3)

</code></pre>

<hr>
<h2 id='define_clusters'>Define each cluster with a user profile interpretation</h2><span id='topic+define_clusters'></span>

<h3>Description</h3>

<p>Every cluster has a centroid (i.e. average start time and duration) that can
be related to a daily human behaviour or connection pattern
(e.g. Worktime, Dinner, etc.). In this function, a user profile name is
assigned to every cluster.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>define_clusters(
  models,
  interpretations = NULL,
  profile_names = NULL,
  log = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="define_clusters_+3A_models">models</code></td>
<td>
<p>tibble, parameters of the clusters' GMM models obtained with
function <code>cluster_sessions()</code> (object <code>models</code> of the returned list)</p>
</td></tr>
<tr><td><code id="define_clusters_+3A_interpretations">interpretations</code></td>
<td>
<p>character vector with interpretation sentences of each cluster (arranged by cluster number)</p>
</td></tr>
<tr><td><code id="define_clusters_+3A_profile_names">profile_names</code></td>
<td>
<p>character vector with user profile assigned to each cluster (arranged by cluster number)</p>
</td></tr>
<tr><td><code id="define_clusters_+3A_log">log</code></td>
<td>
<p>logical, whether to transform <code>ConnectionStartDateTime</code> and
<code>ConnectionHours</code> variables to natural logarithmic scale (base = <code>exp(1)</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>tibble object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)

# Select working day sessions (`Timecycle == 1`) that
# disconnect the same day (`Disconnection == 1`)
sessions_day &lt;- california_ev_sessions %&gt;%
  divide_by_timecycle(
    months_cycles = list(1:12), # Not differentiation between months
    wdays_cycles = list(1:5, 6:7) # Differentiation between workdays/weekends
  ) %&gt;%
  divide_by_disconnection(
    division_hour = 10, start = 3
  ) %&gt;%
  filter(
    Disconnection == 1, Timecycle == 1
  ) %&gt;%
  sample_frac(0.05)
plot_points(sessions_day, start = 3)

# Identify two clusters
sessions_clusters &lt;- cluster_sessions(
  sessions_day, k=2, seed = 1234, log = TRUE
)

# Plot the clusters found
plot_bivarGMM(
  sessions = sessions_clusters$sessions,
  models = sessions_clusters$models,
  log = TRUE, start = 3
)

# Define the clusters with user profile interpretations
define_clusters(
  models = sessions_clusters$models,
  interpretations = c(
    "Connections during working hours",
    "Connections during all day (high variability)"
  ),
  profile_names = c("Workers", "Visitors"),
  log = TRUE
)

</code></pre>

<hr>
<h2 id='detect_outliers'>Detect outliers</h2><span id='topic+detect_outliers'></span>

<h3>Description</h3>

<p>Detect outliers
</p>


<h3>Usage</h3>

<pre><code class='language-R'>detect_outliers(
  sessions,
  MinPts = NULL,
  eps = NULL,
  noise_th = 2,
  log = FALSE,
  start = getOption("evprof.start.hour")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="detect_outliers_+3A_sessions">sessions</code></td>
<td>
<p>tibble, sessions data set in evprof
<a href="https://mcanigueral.github.io/evprof/articles/sessions-format.html">standard format</a>.</p>
</td></tr>
<tr><td><code id="detect_outliers_+3A_minpts">MinPts</code></td>
<td>
<p>MinPts parameter for DBSCAN clustering</p>
</td></tr>
<tr><td><code id="detect_outliers_+3A_eps">eps</code></td>
<td>
<p>eps parameter for DBSCAN clustering</p>
</td></tr>
<tr><td><code id="detect_outliers_+3A_noise_th">noise_th</code></td>
<td>
<p>noise threshold</p>
</td></tr>
<tr><td><code id="detect_outliers_+3A_log">log</code></td>
<td>
<p>logical, whether to transform <code>ConnectionStartDateTime</code> and
<code>ConnectionHours</code> variables to natural logarithmic scale (base = <code>exp(1)</code>).</p>
</td></tr>
<tr><td><code id="detect_outliers_+3A_start">start</code></td>
<td>
<p>integer, start hour in the x axis of the plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>sessions tibble with extra boolean column <code>Outlier</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)
sessions_outliers &lt;- california_ev_sessions %&gt;%
  sample_frac(0.05) %&gt;%
  detect_outliers(start = 3, noise_th = 5, eps = 2.5)

</code></pre>

<hr>
<h2 id='divide_by_disconnection'>Divide sessions by disconnection day</h2><span id='topic+divide_by_disconnection'></span>

<h3>Description</h3>

<p>Divide sessions by disconnection day
</p>


<h3>Usage</h3>

<pre><code class='language-R'>divide_by_disconnection(
  sessions,
  division_hour,
  start = getOption("evprof.start.hour")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="divide_by_disconnection_+3A_sessions">sessions</code></td>
<td>
<p>tibble, sessions data set in evprof
<a href="https://mcanigueral.github.io/evprof/articles/sessions-format.html">standard format</a>.</p>
</td></tr>
<tr><td><code id="divide_by_disconnection_+3A_division_hour">division_hour</code></td>
<td>
<p>Hour to divide the groups according to disconnection time</p>
</td></tr>
<tr><td><code id="divide_by_disconnection_+3A_start">start</code></td>
<td>
<p>integer, start hour in the x axis of the plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>same sessions data set with extra column &quot;Disconnection&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)
sessions_disconnection &lt;- california_ev_sessions %&gt;%
  sample_frac(0.05) %&gt;%
  divide_by_disconnection(
    start = 2, division_hour = 5
  )

# The column `Disconnection` has been added
names(sessions_disconnection)

library(ggplot2)
sessions_disconnection %&gt;%
  tidyr::drop_na() %&gt;%
  plot_points() +
  facet_wrap(vars(Disconnection))

</code></pre>

<hr>
<h2 id='divide_by_timecycle'>Divide sessions by time-cycle</h2><span id='topic+divide_by_timecycle'></span>

<h3>Description</h3>

<p>Divide sessions by time-cycle
</p>


<h3>Usage</h3>

<pre><code class='language-R'>divide_by_timecycle(
  sessions,
  months_cycles = list(1:12),
  wdays_cycles = list(1:5, 6:7),
  start = getOption("evprof.start.hour")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="divide_by_timecycle_+3A_sessions">sessions</code></td>
<td>
<p>tibble, sessions data set in evprof
<a href="https://mcanigueral.github.io/evprof/articles/sessions-format.html">standard format</a>.</p>
</td></tr>
<tr><td><code id="divide_by_timecycle_+3A_months_cycles">months_cycles</code></td>
<td>
<p>list containing Monthly cycles</p>
</td></tr>
<tr><td><code id="divide_by_timecycle_+3A_wdays_cycles">wdays_cycles</code></td>
<td>
<p>list containing Weekdays cycles</p>
</td></tr>
<tr><td><code id="divide_by_timecycle_+3A_start">start</code></td>
<td>
<p>integer, start hour in the x axis of the plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>same sessions data set with extra column &quot;Timecycle&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)
sessions_timecycles &lt;- california_ev_sessions %&gt;%
  sample_frac(0.05) %&gt;%
  divide_by_timecycle(
    months_cycles = list(1:12),
    wdays_cycles = list(1:5, 6:7)
  )

# The column `Timecycle` has been added
names(sessions_timecycles)

library(ggplot2)
plot_points(sessions_timecycles) +
  facet_wrap(vars(Timecycle))

</code></pre>

<hr>
<h2 id='drop_outliers'>Drop outliers</h2><span id='topic+drop_outliers'></span>

<h3>Description</h3>

<p>Drop outliers
</p>


<h3>Usage</h3>

<pre><code class='language-R'>drop_outliers(sessions)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="drop_outliers_+3A_sessions">sessions</code></td>
<td>
<p>tibble, sessions data set in evprof
<a href="https://mcanigueral.github.io/evprof/articles/sessions-format.html">standard format</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>sessions without outliers nor column <code>Outlier</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)
sessions_outliers &lt;- california_ev_sessions %&gt;%
  sample_frac(0.05) %&gt;%
  detect_outliers(start = 3, noise_th = 5, eps = 2.5)

plot_outliers(sessions_outliers, start = 3)

sessions_clean &lt;- drop_outliers(sessions_outliers)

plot_points(sessions_clean, start = 3)


</code></pre>

<hr>
<h2 id='get_charging_rates_distribution'>Get charging rates distribution in percentages</h2><span id='topic+get_charging_rates_distribution'></span>

<h3>Description</h3>

<p>Get charging rates distribution in percentages
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_charging_rates_distribution(sessions, unit = "year")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_charging_rates_distribution_+3A_sessions">sessions</code></td>
<td>
<p>tibble, sessions data set in evprof
<a href="https://mcanigueral.github.io/evprof/articles/sessions-format.html">standard format</a>.</p>
</td></tr>
<tr><td><code id="get_charging_rates_distribution_+3A_unit">unit</code></td>
<td>
<p>character, lubridate <code>floor_date</code> unit parameter</p>
</td></tr>
</table>


<h3>Value</h3>

<p>tibble
</p>


<h3>Examples</h3>

<pre><code class='language-R'>get_charging_rates_distribution(california_ev_sessions, unit="month")
get_charging_rates_distribution(california_ev_sessions, unit="month")

</code></pre>

<hr>
<h2 id='get_connection_model_mclust_object'>Perform <code>mclust::Mclust</code> clustering for multivariate GMM</h2><span id='topic+get_connection_model_mclust_object'></span>

<h3>Description</h3>

<p>Perform <code>mclust::Mclust</code> clustering for multivariate GMM
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_connection_model_mclust_object(
  sessions,
  k,
  mclust_tol = 1e-08,
  mclust_itmax = 10000,
  log = FALSE,
  start = getOption("evprof.start.hour")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_connection_model_mclust_object_+3A_sessions">sessions</code></td>
<td>
<p>tibble, sessions data set in evprof
<a href="https://mcanigueral.github.io/evprof/articles/sessions-format.html">standard format</a>.</p>
</td></tr>
<tr><td><code id="get_connection_model_mclust_object_+3A_k">k</code></td>
<td>
<p>number of clusters</p>
</td></tr>
<tr><td><code id="get_connection_model_mclust_object_+3A_mclust_tol">mclust_tol</code></td>
<td>
<p>tolerance parameter for clustering</p>
</td></tr>
<tr><td><code id="get_connection_model_mclust_object_+3A_mclust_itmax">mclust_itmax</code></td>
<td>
<p>maximum number of iterations</p>
</td></tr>
<tr><td><code id="get_connection_model_mclust_object_+3A_log">log</code></td>
<td>
<p>logical, whether to transform <code>ConnectionStartDateTime</code> and
<code>ConnectionHours</code> variables to natural logarithmic scale (base = <code>exp(1)</code>).</p>
</td></tr>
<tr><td><code id="get_connection_model_mclust_object_+3A_start">start</code></td>
<td>
<p>integer, start hour in the x axis of the plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>mclust object
</p>

<hr>
<h2 id='get_connection_model_params'>Extract models parameters from mclust object</h2><span id='topic+get_connection_model_params'></span>

<h3>Description</h3>

<p>Extract models parameters from mclust object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_connection_model_params(mclust_obj)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_connection_model_params_+3A_mclust_obj">mclust_obj</code></td>
<td>
<p><code>mclust::Mclust</code> object</p>
</td></tr>
</table>

<hr>
<h2 id='get_connection_models'>Get a tibble of connection GMM for every user profile</h2><span id='topic+get_connection_models'></span>

<h3>Description</h3>

<p>Get a tibble of connection GMM for every user profile
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_connection_models(
  subsets_clustering = list(),
  clusters_definition = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_connection_models_+3A_subsets_clustering">subsets_clustering</code></td>
<td>
<p>list with clustering results of each subset
(direct output from function <code>cluser_sessions()</code>)</p>
</td></tr>
<tr><td><code id="get_connection_models_+3A_clusters_definition">clusters_definition</code></td>
<td>
<p>list of tibbles with clusters definitions
(direct output from function <code>define_clusters()</code>) of each sub-set</p>
</td></tr>
</table>


<h3>Value</h3>

<p>tibble
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)

# Select working day sessions (`Timecycle == 1`) that
# disconnect the same day (`Disconnection == 1`)
sessions_day &lt;- california_ev_sessions %&gt;%
  divide_by_timecycle(
    months_cycles = list(1:12), # Not differentiation between months
    wdays_cycles = list(1:5, 6:7) # Differentiation between workdays/weekends
  ) %&gt;%
  divide_by_disconnection(
    division_hour = 10, start = 3
  ) %&gt;%
  filter(
    Disconnection == 1, Timecycle == 1
  ) %&gt;%
  sample_frac(0.05)
plot_points(sessions_day, start = 3)

# Identify two clusters
sessions_clusters &lt;- cluster_sessions(
  sessions_day, k=2, seed = 1234, log = TRUE
)

# Plot the clusters found
plot_bivarGMM(
  sessions = sessions_clusters$sessions,
  models = sessions_clusters$models,
  log = TRUE, start = 3
)

# Define the clusters with user profile interpretations
clusters_definitions &lt;- define_clusters(
  models = sessions_clusters$models,
  interpretations = c(
    "Connections during working hours",
    "Connections during all day (high variability)"
  ),
  profile_names = c("Workers", "Visitors"),
  log = TRUE
)

# Create a table with the connection GMM parameters
get_connection_models(
  subsets_clustering = list(sessions_clusters),
  clusters_definition = list(clusters_definitions)
)


</code></pre>

<hr>
<h2 id='get_daily_avg_n_sessions'>Get the daily average number of sessions given a range of years, months and weekdays</h2><span id='topic+get_daily_avg_n_sessions'></span>

<h3>Description</h3>

<p>Get the daily average number of sessions given a range of years, months and weekdays
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_daily_avg_n_sessions(sessions, years, months, wdays)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_daily_avg_n_sessions_+3A_sessions">sessions</code></td>
<td>
<p>tibble, sessions data set in evprof
<a href="https://mcanigueral.github.io/evprof/articles/sessions-format.html">standard format</a>.</p>
</td></tr>
<tr><td><code id="get_daily_avg_n_sessions_+3A_years">years</code></td>
<td>
<p>vector of integers, range of years to consider</p>
</td></tr>
<tr><td><code id="get_daily_avg_n_sessions_+3A_months">months</code></td>
<td>
<p>vector of integers, range of months to consider</p>
</td></tr>
<tr><td><code id="get_daily_avg_n_sessions_+3A_wdays">wdays</code></td>
<td>
<p>vector of integers, range of weekdays to consider</p>
</td></tr>
</table>


<h3>Value</h3>

<p>tibble with the number of sessions of each date in the given time period
</p>


<h3>Examples</h3>

<pre><code class='language-R'>get_daily_avg_n_sessions(
  california_ev_sessions,
  year = 2018, months = c(5, 6), wdays = 1
)

</code></pre>

<hr>
<h2 id='get_daily_n_sessions'>Get daily number of sessions given a range of years, months and weekdays</h2><span id='topic+get_daily_n_sessions'></span>

<h3>Description</h3>

<p>Get daily number of sessions given a range of years, months and weekdays
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_daily_n_sessions(sessions, years, months, wdays)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_daily_n_sessions_+3A_sessions">sessions</code></td>
<td>
<p>tibble, sessions data set in evprof
<a href="https://mcanigueral.github.io/evprof/articles/sessions-format.html">standard format</a>.</p>
</td></tr>
<tr><td><code id="get_daily_n_sessions_+3A_years">years</code></td>
<td>
<p>vector of integers, range of years to consider</p>
</td></tr>
<tr><td><code id="get_daily_n_sessions_+3A_months">months</code></td>
<td>
<p>vector of integers, range of months to consider</p>
</td></tr>
<tr><td><code id="get_daily_n_sessions_+3A_wdays">wdays</code></td>
<td>
<p>vector of integers, range of weekdays to consider</p>
</td></tr>
</table>


<h3>Value</h3>

<p>tibble with the number of sessions of each date in the given time period
</p>


<h3>Examples</h3>

<pre><code class='language-R'>get_daily_n_sessions(
  california_ev_sessions,
  year = 2018, months = c(5, 6), wdays = 1
)

</code></pre>

<hr>
<h2 id='get_dbscan_params'>Get the minPts and eps values for DBSCAN to label only a specific percentage as noise</h2><span id='topic+get_dbscan_params'></span>

<h3>Description</h3>

<p>Get the minPts and eps values for DBSCAN to label only a specific percentage as noise
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_dbscan_params(
  sessions,
  MinPts,
  eps0,
  noise_th = 2,
  eps_offset_pct = 0.9,
  eps_inc_pct = 0.02,
  log = FALSE,
  start = getOption("evprof.start.hour")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_dbscan_params_+3A_sessions">sessions</code></td>
<td>
<p>tibble, sessions data set in evprof
<a href="https://mcanigueral.github.io/evprof/articles/sessions-format.html">standard format</a>.</p>
</td></tr>
<tr><td><code id="get_dbscan_params_+3A_minpts">MinPts</code></td>
<td>
<p>DBSCAN MinPts parameter</p>
</td></tr>
<tr><td><code id="get_dbscan_params_+3A_eps0">eps0</code></td>
<td>
<p>DBSCAN eps parameter corresponding to the elbow of kNN dist plot</p>
</td></tr>
<tr><td><code id="get_dbscan_params_+3A_noise_th">noise_th</code></td>
<td>
<p>noise threshold</p>
</td></tr>
<tr><td><code id="get_dbscan_params_+3A_eps_offset_pct">eps_offset_pct</code></td>
<td>
<p>eps_offset_pct</p>
</td></tr>
<tr><td><code id="get_dbscan_params_+3A_eps_inc_pct">eps_inc_pct</code></td>
<td>
<p>eps_inc_pct</p>
</td></tr>
<tr><td><code id="get_dbscan_params_+3A_log">log</code></td>
<td>
<p>logical, whether to transform <code>ConnectionStartDateTime</code> and
<code>ConnectionHours</code> variables to natural logarithmic scale (base = <code>exp(1)</code>).</p>
</td></tr>
<tr><td><code id="get_dbscan_params_+3A_start">start</code></td>
<td>
<p>integer, start hour in the x axis of the plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>tibble with minPts and eps parameters, and the corresponding noise
</p>

<hr>
<h2 id='get_division_line'>ggplot2 type function to plot a division line</h2><span id='topic+get_division_line'></span>

<h3>Description</h3>

<p>ggplot2 type function to plot a division line
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_division_line(day_n, division_hour)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_division_line_+3A_day_n">day_n</code></td>
<td>
<p>Number of the day below the line</p>
</td></tr>
<tr><td><code id="get_division_line_+3A_division_hour">division_hour</code></td>
<td>
<p>Hour to divide the groups according to disconnection time</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot2 function
</p>

<hr>
<h2 id='get_energy_model_mclust_object'>Get Mclust object of univariate Gaussian Mixture Models</h2><span id='topic+get_energy_model_mclust_object'></span>

<h3>Description</h3>

<p>Get Mclust object of univariate Gaussian Mixture Models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_energy_model_mclust_object(energy_vct, log = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_energy_model_mclust_object_+3A_energy_vct">energy_vct</code></td>
<td>
<p>numeric vector, energy from sessions</p>
</td></tr>
<tr><td><code id="get_energy_model_mclust_object_+3A_log">log</code></td>
<td>
<p>logical, whether to transform <code>ConnectionStartDateTime</code> and
<code>ConnectionHours</code> variables to natural logarithmic scale (base = <code>exp(1)</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>object of class <code>dnstyMcl</code>
</p>

<hr>
<h2 id='get_energy_model_parameters'>Get energy univariate Gaussian Mixture Model</h2><span id='topic+get_energy_model_parameters'></span>

<h3>Description</h3>

<p>This function outputs a similar ellipses plot than function <code>plot_bivarGMM()</code>
but using a different color for each user profile instead of clusters
(the clusters of a same profile have the same color now).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_energy_model_parameters(mclust_obj)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_energy_model_parameters_+3A_mclust_obj">mclust_obj</code></td>
<td>
<p>object of class <code>dnstyMcl</code> from function <code>get_energy_model_mclust_object</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>tibble
</p>

<hr>
<h2 id='get_energy_models'>Get a tibble of energy GMM for every user profile</h2><span id='topic+get_energy_models'></span>

<h3>Description</h3>

<p>This function simulates random energy values, makes the density curve and overlaps
the simulated density curve with the real density curve of the user profile's energy values.
This is useful to appreciate how the modeled values fit the real ones and increase
or decrease the number of Gaussian components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_energy_models(sessions_profiles, log = TRUE, by_power = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_energy_models_+3A_sessions_profiles">sessions_profiles</code></td>
<td>
<p>tibble, sessions data set in evprof
<a href="https://mcanigueral.github.io/evprof/articles/sessions-format.html">standard format</a>
with user profile attribute <code>Profile</code></p>
</td></tr>
<tr><td><code id="get_energy_models_+3A_log">log</code></td>
<td>
<p>logical, whether to transform <code>ConnectionStartDateTime</code> and
<code>ConnectionHours</code> variables to natural logarithmic scale (base = <code>exp(1)</code>).</p>
</td></tr>
<tr><td><code id="get_energy_models_+3A_by_power">by_power</code></td>
<td>
<p>Logical, true to fit the energy models for every charging rate separately</p>
</td></tr>
</table>


<h3>Value</h3>

<p>tibble
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(dplyr)

# Classify each session to the corresponding user profile
sessions_profiles &lt;- california_ev_sessions_profiles %&gt;%
  dplyr::sample_frac(0.05)

# Get a table with the energy GMM parameters
get_energy_models(sessions_profiles, log = TRUE)

# If there is a `Power` variable in the data set
# you can create an energy model per power rate and user profile
# First it is convenient to round the `Power` values for more generic models
sessions_profiles &lt;- sessions_profiles %&gt;%
  mutate(Power = round_to_interval(Power, 3.7)) %&gt;%
  filter(Power &lt; 11)
sessions_profiles$Power[sessions_profiles$Power == 0] &lt;- 3.7
get_energy_models(sessions_profiles, log = TRUE, by_power = TRUE)





</code></pre>

<hr>
<h2 id='get_ev_model'>Get the EV model object of class <code>evmodel</code></h2><span id='topic+get_ev_model'></span>

<h3>Description</h3>

<p>Get the EV model object of class <code>evmodel</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_ev_model(
  names,
  months_lst = list(1:12, 1:12),
  wdays_lst = list(1:5, 6:7),
  connection_GMM,
  energy_GMM,
  connection_log,
  energy_log,
  data_tz
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_ev_model_+3A_names">names</code></td>
<td>
<p>character vector with the given names of each time-cycle model</p>
</td></tr>
<tr><td><code id="get_ev_model_+3A_months_lst">months_lst</code></td>
<td>
<p>list of integer vectors with the corresponding months of the year for each time-cycle model</p>
</td></tr>
<tr><td><code id="get_ev_model_+3A_wdays_lst">wdays_lst</code></td>
<td>
<p>list of integer vectors with the corresponding days of the week for each model (week start = 1)</p>
</td></tr>
<tr><td><code id="get_ev_model_+3A_connection_gmm">connection_GMM</code></td>
<td>
<p>list of different connection bivariate GMM obtained from <code>get_connection_models</code></p>
</td></tr>
<tr><td><code id="get_ev_model_+3A_energy_gmm">energy_GMM</code></td>
<td>
<p>list of different energy univariate GMM obtained from <code>get_energy_models</code></p>
</td></tr>
<tr><td><code id="get_ev_model_+3A_connection_log">connection_log</code></td>
<td>
<p>logical, true if connection models have logarithmic transformations</p>
</td></tr>
<tr><td><code id="get_ev_model_+3A_energy_log">energy_log</code></td>
<td>
<p>logical, true if energy models have logarithmic transformations</p>
</td></tr>
<tr><td><code id="get_ev_model_+3A_data_tz">data_tz</code></td>
<td>
<p>character, time zone of the original data (necessary to properly simulate new sessions)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>object of class <code>evmodel</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># The package evprof provides example objects of connection and energy
# Gaussian Mixture Models obtained from California's open data set
# (see California article in package website) created with functions
# `get_connection models` and `get_energy models`.

# For workdays sessions
workdays_connection_models &lt;- evprof::california_GMM$workdays$connection_models
workdays_energy_models &lt;- evprof::california_GMM$workdays$energy_models

# For weekends sessions
weekends_connection_models &lt;- evprof::california_GMM$weekends$connection_models
weekends_energy_models &lt;- evprof::california_GMM$weekends$energy_models

# Get the whole model
ev_model &lt;- get_ev_model(
  names = c("Workdays", "Weekends"),
  months_lst = list(1:12, 1:12),
  wdays_lst = list(1:5, 6:7),
  connection_GMM = list(workdays_connection_models, weekends_connection_models),
  energy_GMM = list(workdays_energy_models, weekends_energy_models),
  connection_log = TRUE,
  energy_log = TRUE,
  data_tz = "America/Los_Angeles"
)


</code></pre>

<hr>
<h2 id='mutate_to_log'>Logarithmic transformation to ConnectionStartDateTime and ConnectionHours variables</h2><span id='topic+mutate_to_log'></span>

<h3>Description</h3>

<p>Logarithmic transformation to ConnectionStartDateTime and ConnectionHours variables
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mutate_to_log(sessions, start = getOption("evprof.start.hour"), base = exp(1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mutate_to_log_+3A_sessions">sessions</code></td>
<td>
<p>sessions data set in standard format.</p>
</td></tr>
<tr><td><code id="mutate_to_log_+3A_start">start</code></td>
<td>
<p>integer, start hour in the x axis of the plot.</p>
</td></tr>
<tr><td><code id="mutate_to_log_+3A_base">base</code></td>
<td>
<p>logarithmic base</p>
</td></tr>
</table>

<hr>
<h2 id='plot_bivarGMM'>Plot Bivariate Gaussian Mixture Models</h2><span id='topic+plot_bivarGMM'></span>

<h3>Description</h3>

<p>Plot Bivariate Gaussian Mixture Models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_bivarGMM(
  sessions,
  models,
  profiles_names = seq(1, nrow(models)),
  points_size = 0.25,
  lines_size = 1,
  legend_nrow = 2,
  log = FALSE,
  start = getOption("evprof.start.hour")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_bivarGMM_+3A_sessions">sessions</code></td>
<td>
<p>tibble, sessions data set in evprof
<a href="https://mcanigueral.github.io/evprof/articles/sessions-format.html">standard format</a>.</p>
</td></tr>
<tr><td><code id="plot_bivarGMM_+3A_models">models</code></td>
<td>
<p>tibble, parameters of the clusters' GMM models obtained with
function <code>cluster_sessions</code> (object <code>models</code> of the returned list)</p>
</td></tr>
<tr><td><code id="plot_bivarGMM_+3A_profiles_names">profiles_names</code></td>
<td>
<p>names of profiles</p>
</td></tr>
<tr><td><code id="plot_bivarGMM_+3A_points_size">points_size</code></td>
<td>
<p>size of scatter points in the plot</p>
</td></tr>
<tr><td><code id="plot_bivarGMM_+3A_lines_size">lines_size</code></td>
<td>
<p>size of lines in the plot</p>
</td></tr>
<tr><td><code id="plot_bivarGMM_+3A_legend_nrow">legend_nrow</code></td>
<td>
<p>number of rows in legend</p>
</td></tr>
<tr><td><code id="plot_bivarGMM_+3A_log">log</code></td>
<td>
<p>logical, whether to transform <code>ConnectionStartDateTime</code> and
<code>ConnectionHours</code> variables to natural logarithmic scale (base = <code>exp(1)</code>).</p>
</td></tr>
<tr><td><code id="plot_bivarGMM_+3A_start">start</code></td>
<td>
<p>integer, start hour in the x axis of the plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot2 plot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)

# Select working day sessions (`Timecycle == 1`) that
# disconnect the same day (`Disconnection == 1`)
sessions_day &lt;- california_ev_sessions %&gt;%
  divide_by_timecycle(
    months_cycles = list(1:12), # Not differentiation between months
    wdays_cycles = list(1:5, 6:7) # Differentiation between workdays/weekends
  ) %&gt;%
  divide_by_disconnection(
    division_hour = 10, start = 3
  ) %&gt;%
  filter(
    Disconnection == 1, Timecycle == 1
  ) %&gt;%
  sample_frac(0.05)
plot_points(sessions_day, start = 3)

# Identify two clusters
sessions_clusters &lt;- cluster_sessions(
  sessions_day, k=2, seed = 1234, log = TRUE
)

# Plot the clusters found
plot_bivarGMM(
  sessions = sessions_clusters$sessions,
  models = sessions_clusters$models,
  log = TRUE, start = 3
)

</code></pre>

<hr>
<h2 id='plot_density_2D'>Density plot in 2D, considering Start time and Connection duration as variables</h2><span id='topic+plot_density_2D'></span>

<h3>Description</h3>

<p>Density plot in 2D, considering Start time and Connection duration as variables
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_density_2D(
  sessions,
  bins = 15,
  by = c("wday", "month", "year"),
  start = getOption("evprof.start.hour"),
  log = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_density_2D_+3A_sessions">sessions</code></td>
<td>
<p>tibble, sessions data set in evprof
<a href="https://mcanigueral.github.io/evprof/articles/sessions-format.html">standard format</a>.</p>
</td></tr>
<tr><td><code id="plot_density_2D_+3A_bins">bins</code></td>
<td>
<p>integer, parameter to pass to <code>ggplot2::stat_density_2d</code></p>
</td></tr>
<tr><td><code id="plot_density_2D_+3A_by">by</code></td>
<td>
<p>variable to facet the plot. Character being &quot;wday&quot;, &quot;month&quot; or &quot;year&quot;, considering the week to start at wday=1.</p>
</td></tr>
<tr><td><code id="plot_density_2D_+3A_start">start</code></td>
<td>
<p>integer, start hour in the x axis of the plot.</p>
</td></tr>
<tr><td><code id="plot_density_2D_+3A_log">log</code></td>
<td>
<p>logical, whether to transform <code>ConnectionStartDateTime</code> and
<code>ConnectionHours</code> variables to natural logarithmic scale (base = <code>exp(1)</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot2 plot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)

california_ev_sessions %&gt;%
  sample_frac(0.05) %&gt;%
  plot_density_2D(by = "wday", start = 3, bins = 15, log = FALSE)

</code></pre>

<hr>
<h2 id='plot_density_3D'>Density plot in 3D, considering Start time and Connection duration as variables</h2><span id='topic+plot_density_3D'></span>

<h3>Description</h3>

<p>Density plot in 3D, considering Start time and Connection duration as variables
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_density_3D(
  sessions,
  start = getOption("evprof.start.hour"),
  eye = list(x = -1.5, y = -1.5, z = 1.5),
  log = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_density_3D_+3A_sessions">sessions</code></td>
<td>
<p>tibble, sessions data set in evprof
<a href="https://mcanigueral.github.io/evprof/articles/sessions-format.html">standard format</a>.</p>
</td></tr>
<tr><td><code id="plot_density_3D_+3A_start">start</code></td>
<td>
<p>integer, start hour in the x axis of the plot.</p>
</td></tr>
<tr><td><code id="plot_density_3D_+3A_eye">eye</code></td>
<td>
<p>list containing x, y and z points of view. Example: <code>list(x = -1.5, y = -1.5, z = 1.5)</code></p>
</td></tr>
<tr><td><code id="plot_density_3D_+3A_log">log</code></td>
<td>
<p>logical, whether to transform <code>ConnectionStartDateTime</code> and
<code>ConnectionHours</code> variables to natural logarithmic scale (base = <code>exp(1)</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>plotly plot (html)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)
california_ev_sessions %&gt;%
  sample_frac(0.05) %&gt;%
  plot_density_3D(start = 3)

</code></pre>

<hr>
<h2 id='plot_division_lines'>Iteration over evprof::plot_division_line function to plot multiple lines</h2><span id='topic+plot_division_lines'></span>

<h3>Description</h3>

<p>Iteration over evprof::plot_division_line function to plot multiple lines
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_division_lines(ggplot_points, n_lines, division_hour)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_division_lines_+3A_ggplot_points">ggplot_points</code></td>
<td>
<p>ggplot2 returned by evprof::plot_points function</p>
</td></tr>
<tr><td><code id="plot_division_lines_+3A_n_lines">n_lines</code></td>
<td>
<p>number of lines to plot</p>
</td></tr>
<tr><td><code id="plot_division_lines_+3A_division_hour">division_hour</code></td>
<td>
<p>Hour to divide the groups according to disconnection time</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot2 function
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)
california_ev_sessions %&gt;%
  sample_frac(0.05) %&gt;%
  plot_points(start = 3) %&gt;%
  plot_division_lines(n_lines = 1, division_hour = 5)

</code></pre>

<hr>
<h2 id='plot_energy_models'>Compare density of estimated energy with density of real energy vector</h2><span id='topic+plot_energy_models'></span>

<h3>Description</h3>

<p>Compare density of estimated energy with density of real energy vector
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_energy_models(energy_models, nrow = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_energy_models_+3A_energy_models">energy_models</code></td>
<td>
<p>energy models returned by function <code>get_energy_models</code></p>
</td></tr>
<tr><td><code id="plot_energy_models_+3A_nrow">nrow</code></td>
<td>
<p>integer, number of rows in the plot grid (passed to <code>cowplot::plot_grid</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot
</p>


<h3>Examples</h3>

<pre><code class='language-R'># The package evprof provides example objects of connection and energy
# Gaussian Mixture Models obtained from California's open data set
# (see California article in package website) created with functions
# `get_connection models` and `get_energy models`.

# Get the working days energy models
energy_models &lt;- evprof::california_GMM$workdays$energy_models

# Plot energy models
plot_energy_models(energy_models)


</code></pre>

<hr>
<h2 id='plot_histogram'>Histogram of a variable from sessions data set</h2><span id='topic+plot_histogram'></span>

<h3>Description</h3>

<p>Histogram of a variable from sessions data set
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_histogram(sessions, var, binwidth = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_histogram_+3A_sessions">sessions</code></td>
<td>
<p>tibble, sessions data set in evprof
<a href="https://mcanigueral.github.io/evprof/articles/sessions-format.html">standard format</a>.</p>
</td></tr>
<tr><td><code id="plot_histogram_+3A_var">var</code></td>
<td>
<p>character, column name to compute the histogram for</p>
</td></tr>
<tr><td><code id="plot_histogram_+3A_binwidth">binwidth</code></td>
<td>
<p>integer, with of histogram bins</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot plot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot_histogram(california_ev_sessions, "Power", binwidth = 2)
plot_histogram(california_ev_sessions, "Power", binwidth = 0.1)

</code></pre>

<hr>
<h2 id='plot_histogram_grid'>Grid of multiple variable histograms</h2><span id='topic+plot_histogram_grid'></span>

<h3>Description</h3>

<p>Grid of multiple variable histograms
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_histogram_grid(
  sessions,
  vars = evprof::sessions_summary_feature_names,
  binwidths = rep(1, length(vars)),
  nrow = NULL,
  ncol = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_histogram_grid_+3A_sessions">sessions</code></td>
<td>
<p>tibble, sessions data set in evprof
<a href="https://mcanigueral.github.io/evprof/articles/sessions-format.html">standard format</a>.</p>
</td></tr>
<tr><td><code id="plot_histogram_grid_+3A_vars">vars</code></td>
<td>
<p>vector of characters, variables to plot</p>
</td></tr>
<tr><td><code id="plot_histogram_grid_+3A_binwidths">binwidths</code></td>
<td>
<p>vector of integers, binwidths of each variable histogram.
The length of the vector must correspond to the length of the <code>vars</code> parameter.</p>
</td></tr>
<tr><td><code id="plot_histogram_grid_+3A_nrow">nrow</code></td>
<td>
<p>integer, number of rows of the plot grid</p>
</td></tr>
<tr><td><code id="plot_histogram_grid_+3A_ncol">ncol</code></td>
<td>
<p>integer, number of columns of the plot grid</p>
</td></tr>
</table>


<h3>Value</h3>

<p>grid plot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot_histogram_grid(california_ev_sessions)
plot_histogram_grid(california_ev_sessions, vars = c("Energy", "Power"))

</code></pre>

<hr>
<h2 id='plot_kNNdist'>Plot kNNdist</h2><span id='topic+plot_kNNdist'></span>

<h3>Description</h3>

<p>Plot the kNN (k-nearest neighbors) distance plot to visually detect the
&quot;elbow&quot; and define an appropriate value for <code>eps</code> DBSCAN parameter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_kNNdist(
  sessions,
  MinPts = NULL,
  log = FALSE,
  start = getOption("evprof.start.hour")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_kNNdist_+3A_sessions">sessions</code></td>
<td>
<p>tibble, sessions data set in evprof
<a href="https://mcanigueral.github.io/evprof/articles/sessions-format.html">standard format</a>.</p>
</td></tr>
<tr><td><code id="plot_kNNdist_+3A_minpts">MinPts</code></td>
<td>
<p>integer, DBSCAN MinPts parameter. If null, a value of 200 will be considered.</p>
</td></tr>
<tr><td><code id="plot_kNNdist_+3A_log">log</code></td>
<td>
<p>logical, whether to transform <code>ConnectionStartDateTime</code> and
<code>ConnectionHours</code> variables to natural logarithmic scale (base = <code>exp(1)</code>).</p>
</td></tr>
<tr><td><code id="plot_kNNdist_+3A_start">start</code></td>
<td>
<p>integer, start hour in the x axis of the plot.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The kNN (k-nearest neighbors) distance plot can provide insights into
setting the <code>eps</code> parameter in DBSCAN. The &quot;elbow&quot; in the kNN distance plot
is the point where the distances start to increase significantly. At the
same time, for DBSCAN, the eps parameter defines the radius within which a
specified number of points must exist for a data point to be considered a
core point. Therefore, the &quot;elbow&quot; of the kNN distance plot can provide a
sense of the scale of the data and help you choose a reasonable range for
the <code>eps</code> parameter in DBSCAN.
</p>


<h3>Value</h3>

<p>plot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)
california_ev_sessions %&gt;%
  sample_frac(0.05) %&gt;%
  plot_kNNdist(start = 3, log = TRUE)

</code></pre>

<hr>
<h2 id='plot_model_clusters'>Plot all bi-variable GMM (clusters) with the colors corresponding
to the assigned user profile. This shows which clusters correspond to which
user profile, and the proportion of every user profile.</h2><span id='topic+plot_model_clusters'></span>

<h3>Description</h3>

<p>Plot all bi-variable GMM (clusters) with the colors corresponding
to the assigned user profile. This shows which clusters correspond to which
user profile, and the proportion of every user profile.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_model_clusters(
  subsets_clustering = list(),
  clusters_definition = list(),
  profiles_ratios,
  log = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_model_clusters_+3A_subsets_clustering">subsets_clustering</code></td>
<td>
<p>list with clustering results of each subset
(direct output from function <code>cluser_sessions()</code>)</p>
</td></tr>
<tr><td><code id="plot_model_clusters_+3A_clusters_definition">clusters_definition</code></td>
<td>
<p>list of tibbles with clusters definitions
(direct output from function <code>define_clusters()</code>) of each sub-set</p>
</td></tr>
<tr><td><code id="plot_model_clusters_+3A_profiles_ratios">profiles_ratios</code></td>
<td>
<p>tibble with columns <code>profile</code> and <code>ratio</code></p>
</td></tr>
<tr><td><code id="plot_model_clusters_+3A_log">log</code></td>
<td>
<p>logical, whether to transform <code>ConnectionStartDateTime</code> and
<code>ConnectionHours</code> variables to natural logarithmic scale (base = <code>exp(1)</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot2
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)

# Select working day sessions (`Timecycle == 1`) that
# disconnect the same day (`Disconnection == 1`)
sessions_day &lt;- evprof::california_ev_sessions_profiles %&gt;%
  filter(Timecycle == "Workday") %&gt;%
  sample_frac(0.05)
plot_points(sessions_day, start = 3)

# Identify two clusters
sessions_clusters &lt;- cluster_sessions(
  sessions_day, k=2, seed = 1234, log = TRUE
)

# Plot the clusters found
plot_bivarGMM(
  sessions = sessions_clusters$sessions,
  models = sessions_clusters$models,
  log = TRUE, start = 3
)

# Define the clusters with user profile interpretations
clusters_definitions &lt;- define_clusters(
  models = sessions_clusters$models,
  interpretations = c(
    "Connections during all day (high variability)",
    "Connections during working hours"#'
  ),
  profile_names = c("Visitors", "Workers"),
  log = TRUE
)

# Create a table with the connection GMM parameters
connection_models &lt;- get_connection_models(
  subsets_clustering = list(sessions_clusters),
  clusters_definition = list(clusters_definitions)
)

# Plot all bi-variable GMM (clusters) with the colors corresponding
# to their assigned user profile
plot_model_clusters(
  subsets_clustering = list(sessions_clusters),
  clusters_definition = list(clusters_definitions),
  profiles_ratios = connection_models[c("profile", "ratio")]
)


</code></pre>

<hr>
<h2 id='plot_outliers'>Plot outlying sessions</h2><span id='topic+plot_outliers'></span>

<h3>Description</h3>

<p>Plot outlying sessions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_outliers(
  sessions,
  start = getOption("evprof.start.hour"),
  log = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_outliers_+3A_sessions">sessions</code></td>
<td>
<p>tibble, sessions data set in evprof
<a href="https://mcanigueral.github.io/evprof/articles/sessions-format.html">standard format</a>.</p>
</td></tr>
<tr><td><code id="plot_outliers_+3A_start">start</code></td>
<td>
<p>integer, start hour in the x axis of the plot.</p>
</td></tr>
<tr><td><code id="plot_outliers_+3A_log">log</code></td>
<td>
<p>logical, whether to transform <code>ConnectionStartDateTime</code> and
<code>ConnectionHours</code> variables to natural logarithmic scale (base = <code>exp(1)</code>).</p>
</td></tr>
<tr><td><code id="plot_outliers_+3A_...">...</code></td>
<td>
<p>arguments to pass to function ggplot2::plot_point</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot2 plot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)
sessions_outliers &lt;- california_ev_sessions %&gt;%
  sample_frac(0.05) %&gt;%
  detect_outliers(start = 3, noise_th = 5, eps = 2.5)
plot_outliers(sessions_outliers, start = 3)
plot_outliers(sessions_outliers, start = 3, log = TRUE)

</code></pre>

<hr>
<h2 id='plot_points'>Scatter plot of sessions</h2><span id='topic+plot_points'></span>

<h3>Description</h3>

<p>Scatter plot of sessions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_points(sessions, start = getOption("evprof.start.hour"), log = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_points_+3A_sessions">sessions</code></td>
<td>
<p>tibble, sessions data set in evprof
<a href="https://mcanigueral.github.io/evprof/articles/sessions-format.html">standard format</a>.</p>
</td></tr>
<tr><td><code id="plot_points_+3A_start">start</code></td>
<td>
<p>integer, start hour in the x axis of the plot.</p>
</td></tr>
<tr><td><code id="plot_points_+3A_log">log</code></td>
<td>
<p>logical, whether to transform <code>ConnectionStartDateTime</code> and
<code>ConnectionHours</code> variables to natural logarithmic scale (base = <code>exp(1)</code>).</p>
</td></tr>
<tr><td><code id="plot_points_+3A_...">...</code></td>
<td>
<p>arguments to <code>ggplot2::geom_point</code> function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot scatter plot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)
california_ev_sessions %&gt;%
  sample_frac(0.05) %&gt;%
  plot_points()
california_ev_sessions %&gt;%
  sample_frac(0.05) %&gt;%
  plot_points(start = 3)
california_ev_sessions %&gt;%
  sample_frac(0.05) %&gt;%
  plot_points(log = TRUE)

</code></pre>

<hr>
<h2 id='print.evmodel'><code>print</code> method for <code>evmodel</code> object class</h2><span id='topic+print.evmodel'></span>

<h3>Description</h3>

<p><code>print</code> method for <code>evmodel</code> object class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'evmodel'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.evmodel_+3A_x">x</code></td>
<td>
<p><code>evmodel</code> object
(see this <a href="https://mcanigueral.github.io/evprof/articles/evmodel.html">link</a> for more information)</p>
</td></tr>
<tr><td><code id="print.evmodel_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>nothing but prints information about the <code>evmodel</code> object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>print(california_ev_model)


</code></pre>

<hr>
<h2 id='read_ev_model'>Read an EV model JSON file and convert it to object of class <code>evmodel</code></h2><span id='topic+read_ev_model'></span>

<h3>Description</h3>

<p>Read an EV model JSON file and convert it to object of class <code>evmodel</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_ev_model(file)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_ev_model_+3A_file">file</code></td>
<td>
<p>path to the JSON file</p>
</td></tr>
</table>


<h3>Value</h3>

<p>object of class <code>evmodel</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ev_model &lt;- california_ev_model # Model of example

save_ev_model(ev_model, file = file.path(tempdir(), "evmodel.json"))

read_ev_model(file = file.path(tempdir(), "evmodel.json"))

</code></pre>

<hr>
<h2 id='round_to_half'>Round numeric time value to half hour basis.</h2><span id='topic+round_to_half'></span>

<h3>Description</h3>

<p>Round numeric time value to half hour basis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>round_to_half(time_num)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="round_to_half_+3A_time_num">time_num</code></td>
<td>
<p>Numeric time value (hour-based)</p>
</td></tr>
</table>

<hr>
<h2 id='round_to_interval'>Round to nearest interval</h2><span id='topic+round_to_interval'></span>

<h3>Description</h3>

<p>Round to nearest interval
</p>


<h3>Usage</h3>

<pre><code class='language-R'>round_to_interval(dbl, interval)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="round_to_interval_+3A_dbl">dbl</code></td>
<td>
<p>number to round</p>
</td></tr>
<tr><td><code id="round_to_interval_+3A_interval">interval</code></td>
<td>
<p>rounding interval</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric value
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1)
random_vct &lt;- rnorm(10, 5, 5)
round_to_interval(random_vct, 2.5)

</code></pre>

<hr>
<h2 id='save_clustering_iterations'>Save iteration plots in PDF file</h2><span id='topic+save_clustering_iterations'></span>

<h3>Description</h3>

<p>Save iteration plots in PDF file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>save_clustering_iterations(
  sessions,
  k,
  filename,
  it = 12,
  seeds = round(runif(it, min = 1, max = 1000)),
  plot_scale = 2,
  points_size = 0.25,
  mclust_tol = 1e-08,
  mclust_itmax = 10000,
  log = FALSE,
  start = getOption("evprof.start.hour")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="save_clustering_iterations_+3A_sessions">sessions</code></td>
<td>
<p>tibble, sessions data set in evprof
<a href="https://mcanigueral.github.io/evprof/articles/sessions-format.html">standard format</a>.</p>
</td></tr>
<tr><td><code id="save_clustering_iterations_+3A_k">k</code></td>
<td>
<p>number of clusters</p>
</td></tr>
<tr><td><code id="save_clustering_iterations_+3A_filename">filename</code></td>
<td>
<p>string defining the PDF output file path (with extension .pdf)</p>
</td></tr>
<tr><td><code id="save_clustering_iterations_+3A_it">it</code></td>
<td>
<p>number of iterations</p>
</td></tr>
<tr><td><code id="save_clustering_iterations_+3A_seeds">seeds</code></td>
<td>
<p>seed for each iteration</p>
</td></tr>
<tr><td><code id="save_clustering_iterations_+3A_plot_scale">plot_scale</code></td>
<td>
<p>scale of each iteration plot for a good visualization in pdf file</p>
</td></tr>
<tr><td><code id="save_clustering_iterations_+3A_points_size">points_size</code></td>
<td>
<p>integer, size of points in the scatter plot</p>
</td></tr>
<tr><td><code id="save_clustering_iterations_+3A_mclust_tol">mclust_tol</code></td>
<td>
<p>tolerance parameter for clustering</p>
</td></tr>
<tr><td><code id="save_clustering_iterations_+3A_mclust_itmax">mclust_itmax</code></td>
<td>
<p>maximum number of iterations</p>
</td></tr>
<tr><td><code id="save_clustering_iterations_+3A_log">log</code></td>
<td>
<p>logical, whether to transform <code>ConnectionStartDateTime</code> and
<code>ConnectionHours</code> variables to natural logarithmic scale (base = <code>exp(1)</code>).</p>
</td></tr>
<tr><td><code id="save_clustering_iterations_+3A_start">start</code></td>
<td>
<p>integer, start hour in the x axis of the plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>nothing, but a PDF file is saved in the path specified by parameter <code>filename</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
temp_file &lt;- file.path(tempdir(), "iteration.pdf")
save_clustering_iterations(california_ev_sessions, k = 2, it = 4, filename = temp_file)



</code></pre>

<hr>
<h2 id='save_ev_model'>Save the EV model object of class <code>evmodel</code> to a JSON file</h2><span id='topic+save_ev_model'></span>

<h3>Description</h3>

<p>Save the EV model object of class <code>evmodel</code> to a JSON file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>save_ev_model(evmodel, file)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="save_ev_model_+3A_evmodel">evmodel</code></td>
<td>
<p>object of class <code>evmodel</code>
(see this <a href="https://mcanigueral.github.io/evprof/articles/evmodel.html">link</a> for more information)</p>
</td></tr>
<tr><td><code id="save_ev_model_+3A_file">file</code></td>
<td>
<p>character string with the path or name of the file</p>
</td></tr>
</table>


<h3>Value</h3>

<p>nothing but saves the <code>evmodel</code> object in a JSON file
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ev_model &lt;- california_ev_model # Model of example

save_ev_model(ev_model, file = file.path(tempdir(), "evmodel.json"))

</code></pre>

<hr>
<h2 id='sessions_feature_names'>Names of standard features of a sessions dataset</h2><span id='topic+sessions_feature_names'></span>

<h3>Description</h3>

<p>A vector with the standard names of sessions features
for this package functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sessions_feature_names
</code></pre>


<h3>Format</h3>

<p>A vector
</p>

<hr>
<h2 id='sessions_summary_feature_names'>Names of features to summarise in evprof functions</h2><span id='topic+sessions_summary_feature_names'></span>

<h3>Description</h3>

<p>A vector with the summary features
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sessions_summary_feature_names
</code></pre>


<h3>Format</h3>

<p>A vector
</p>

<hr>
<h2 id='set_profiles'>Classify sessions into user profiles</h2><span id='topic+set_profiles'></span>

<h3>Description</h3>

<p>Joins all sub-sets from the list, adding a new column <code>Profile</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set_profiles(sessions_clustered = list(), clusters_definition = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="set_profiles_+3A_sessions_clustered">sessions_clustered</code></td>
<td>
<p>list of tibbles with sessions clustered
(<code>sessions</code>object of the output from function <code>cluser_sessions()</code>) from each sub-set</p>
</td></tr>
<tr><td><code id="set_profiles_+3A_clusters_definition">clusters_definition</code></td>
<td>
<p>list of tibbles with clusters definitions
(direct output from function <code>define_clusters()</code>) of each sub-set</p>
</td></tr>
</table>


<h3>Value</h3>

<p>tibble
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)

# Select working day sessions (`Timecycle == 1`) that
# disconnect the same day (`Disconnection == 1`)
sessions_day &lt;- california_ev_sessions %&gt;%
  divide_by_timecycle(
    months_cycles = list(1:12), # Not differentiation between months
    wdays_cycles = list(1:5, 6:7) # Differentiation between workdays/weekends
  ) %&gt;%
  divide_by_disconnection(
    division_hour = 10, start = 3
  ) %&gt;%
  filter(
    Disconnection == 1, Timecycle == 1
  ) %&gt;%
  sample_frac(0.05)

# Identify two clusters
sessions_clusters &lt;- cluster_sessions(
  sessions_day, k=2, seed = 1234, log = TRUE
)

# Plot the clusters found
plot_bivarGMM(
  sessions = sessions_clusters$sessions,
  models = sessions_clusters$models,
  log = TRUE, start = 3
)

# Define the clusters with user profile interpretations
clusters_definitions &lt;- define_clusters(
  models = sessions_clusters$models,
  interpretations = c(
    "Connections during working hours",
    "Connections during all day (high variability)"
  ),
  profile_names = c("Workers", "Visitors"),
  log = TRUE
)

# Classify each session to the corresponding user profile
sessions_profiles &lt;- set_profiles(
  sessions_clustered = list(sessions_clusters$sessions),
  clusters_definition = list(clusters_definitions)
)

</code></pre>

<hr>
<h2 id='summarise_sessions'>Statistic summary of sessions features</h2><span id='topic+summarise_sessions'></span>

<h3>Description</h3>

<p>Statistic summary of sessions features
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summarise_sessions(
  sessions,
  .funs,
  vars = evprof::sessions_summary_feature_names
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summarise_sessions_+3A_sessions">sessions</code></td>
<td>
<p>tibble, sessions data set in evprof
<a href="https://mcanigueral.github.io/evprof/articles/sessions-format.html">standard format</a>.
<a href="https://mcanigueral.github.io/evprof/articles/sessions-format.html">standard format</a>.</p>
</td></tr>
<tr><td><code id="summarise_sessions_+3A_.funs">.funs</code></td>
<td>
<p>A function to compute, e.g. <code>mean</code>, <code>max</code>, etc.</p>
</td></tr>
<tr><td><code id="summarise_sessions_+3A_vars">vars</code></td>
<td>
<p>character vector, variables to compute the histogram for</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Summary table
</p>


<h3>Examples</h3>

<pre><code class='language-R'>summarise_sessions(california_ev_sessions, mean)


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
