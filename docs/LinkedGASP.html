<!DOCTYPE html><html><head><title>Help for package LinkedGASP</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {LinkedGASP}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#emp_GASP_plot'>
<p>Empirical linked GASP plot</p></a></li>
<li><a href='#eval_GASP_RFP'>
<p>Evaluation of parameters of a Gaussian stochastic process emulator of a computer model.</p></a></li>
<li><a href='#eval_TGASP'>
<p>T-GASP emulator</p></a></li>
<li><a href='#eval_type1_GASP'>
<p>The first type of an emulator of a computer model</p></a></li>
<li><a href='#eval_type2_GASP'>
<p>The second type of an emulator of a computer model</p></a></li>
<li><a href='#GASP_plot'>
<p>Plot of the GASP</p></a></li>
<li><a href='#link'>
<p>Linking two emulators</p></a></li>
<li><a href='#NGASPmetrics'>
<p>GASP performance assessment measures</p></a></li>
<li><a href='#TGASP_plot'>
<p>T-GASP plot</p></a></li>
<li><a href='#TGASPmetrics'>
<p>Performance measurement of a T-GASP</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Linked Emulator of a Coupled System of Simulators</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2018-11-24</td>
</tr>
<tr>
<td>Author:</td>
<td>Ksenia N. Kyzyurova, kseniak.ucoz.net</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ksenia N. Kyzyurova &lt;ksenia.kyzyurova@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>nloptr, spBayes</td>
</tr>
<tr>
<td>Suggests:</td>
<td>MASS</td>
</tr>
<tr>
<td>Description:</td>
<td>Prototypes for construction of a Gaussian Stochastic Process emulator (GASP) of a computer model. This is done within the objective Bayesian implementation of the GASP. The package allows for construction of a linked GASP of the composite computer model. Computational implementation follows the mathematical exposition given in publication: Ksenia N. Kyzyurova, James O. Berger, Robert L. Wolpert. Coupling computer models through linking their statistical emulators. SIAM/ASA Journal on Uncertainty Quantification, 6(3): 1151-1171, (2018).&lt;<a href="https://doi.org/10.1137%2F17M1157702">doi:10.1137/17M1157702</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-12-04 15:02:55 UTC; kseniak</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-12-09 16:50:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='emp_GASP_plot'>
Empirical linked GASP plot
</h2><span id='topic+emp_GASP_plot'></span>

<h3>Description</h3>

<p>Function plots the empirical true linked emulator in case of one-dimensional input.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>emp_GASP_plot(em, fun, data, emul_type, exp.ql, exp.qu, labels, ylab, xlab, ylim,
col_CI_area, col_points, col_fun, col_mean, points)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="emp_GASP_plot_+3A_em">em</code></td>
<td>

<p>the returned output from the function eval_type1_GASP(...) or eval_type2_GASP(...).
</p>
</td></tr>
<tr><td><code id="emp_GASP_plot_+3A_fun">fun</code></td>
<td>

<p>Simulator function. Currently only one-dimensional input is supported.
</p>
</td></tr>
<tr><td><code id="emp_GASP_plot_+3A_data">data</code></td>
<td>

<p>Training data and smoothness. The same as supplied to eval_GASP_RFP(...) for construction of the GASP.
</p>
</td></tr>
<tr><td><code id="emp_GASP_plot_+3A_emul_type">emul_type</code></td>
<td>

<p>A text string which provides description of an emulator.
</p>
</td></tr>
<tr><td><code id="emp_GASP_plot_+3A_exp.ql">exp.ql</code></td>
<td>

<p>Quantile 0.025
</p>
</td></tr>
<tr><td><code id="emp_GASP_plot_+3A_exp.qu">exp.qu</code></td>
<td>

<p>Quantile 0.975
</p>
</td></tr>
<tr><td><code id="emp_GASP_plot_+3A_labels">labels</code></td>
<td>

<p>As in standard R plot.
</p>
</td></tr>
<tr><td><code id="emp_GASP_plot_+3A_ylab">ylab</code></td>
<td>

<p>As in standard R plot.
</p>
</td></tr>
<tr><td><code id="emp_GASP_plot_+3A_xlab">xlab</code></td>
<td>

<p>As in standard R plot.
</p>
</td></tr>
<tr><td><code id="emp_GASP_plot_+3A_ylim">ylim</code></td>
<td>

<p>As in standard R plot.
</p>
</td></tr>
<tr><td><code id="emp_GASP_plot_+3A_col_ci_area">col_CI_area</code></td>
<td>

<p>Color of a credible area.
</p>
</td></tr>
<tr><td><code id="emp_GASP_plot_+3A_col_points">col_points</code></td>
<td>

<p>Color of the training points.
</p>
</td></tr>
<tr><td><code id="emp_GASP_plot_+3A_col_fun">col_fun</code></td>
<td>

<p>Color of a simulator function.
</p>
</td></tr>
<tr><td><code id="emp_GASP_plot_+3A_col_mean">col_mean</code></td>
<td>

<p>Color of the emulator of the GASP mean.
</p>
</td></tr>
<tr><td><code id="emp_GASP_plot_+3A_points">points</code></td>
<td>

<p>Default is FALSE. To plot or not the training points.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Plot
</p>


<h3>Author(s)</h3>

<p>Ksenia N. Kyzyurova, kseniak.ucoz.net
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Function f1 is a simulator
f1&lt;-function(x){sin(pi*x)}
## Function f2 is a simulator
f2&lt;-function(x){cos(5*x)}

## Function f2(f1) is a simulator of a composite model
f2f1 &lt;- function(x){f2(f1(x))}

## One-dimensional inputs are x1
x1 &lt;- seq(-1,1,.37)

## The following contains the list of data inputs (training) and outputs (fD) together with the
## assumed fixed smoothness of a computer model output.
data.f1 &lt;- list(training = x1,fD = f1(x1), smooth = 1.99)

## Evaluation of GASP parameters
f1_MLEs = eval_GASP_RFP(data.f1,list(function(x){x^0},function(x){x^1}),1,FALSE)

## Evaluate the emulator
xn = seq(-1,1,.01)
GASP_type2_f1 &lt;- eval_type2_GASP(as.matrix(xn),f1_MLEs)

par(mfrow = c(1,1))
par(mar = c(6.1, 6.1, 5.1, 2.1))
ylim = c(-1.5,1.5)
GASP_plot(GASP_type2_f1,f1,data.f1,"Type 2 GASP",ylab = " f",xlab = "x",
ylim = ylim, plot_training = TRUE)

s = GASP_type2_f1$mu
s.var = diag(GASP_type2_f1$var)

x2 = seq(-0.95,0.95,length = 6)#f1(x1)
data.f2 &lt;- list(training = x2,fD = f2(x2), smooth = 2) # linking requires this emulator 
## to have smoothness parameter equal to 2

f2_MLEs = eval_GASP_RFP(data.f2,list(function(x){x^0},function(x){x^1}),1,FALSE)

GASP_type1_f2 &lt;- eval_type1_GASP(as.matrix(seq(-3.5,3.5,.01)),f2_MLEs)
GASP_type2_f2 &lt;- eval_type2_GASP(as.matrix(seq(-1,1,.01)),f2_MLEs)
TGASP_f2 &lt;- eval_TGASP(as.matrix(seq(-1,1,.01)),f2_MLEs)

ylim = c(-1.5,1.5)
# labels = c(expression(phantom(x)*phantom(x)*phantom(x)*f(x[1])),
# expression(f(x[2])*phantom(x)*phantom(x)*phantom(x)),
# expression(f(x[3])),expression(f(x[4])),
# expression(f(x[5])),expression(f(x[6])))

par(mar = c(6.1, 6.1, 5.1, 2.1))
GASP_plot(GASP_type2_f2,f2,data.f2, "Type 2 GASP",labels = x2,xlab= "z",ylab = " g",
ylim = ylim,plot_training = TRUE)

le &lt;- link(f1_MLEs, f2_MLEs, as.matrix(xn))

## Construct an empirical emulator
n.samples = 100
em2.runs&lt;-mat.or.vec(n.samples,length(s))
library(MASS)
for(i in 1:n.samples) {
  GASP = eval_type2_GASP(as.matrix(mvrnorm(1,s,diag(s.var))),f2_MLEs)
  em2.runs[i,] &lt;- mvrnorm(1,GASP$mu, GASP$var)
}

## Plot the empirical GASP emulator
data.f2f1 &lt;- list(training = x1,fD = f2f1(x1), smooth = 2)

par(mar = c(6.1, 6.1, 5.1, 2.1))
emp_GASP_plot(le$em2,f2f1,data.f2f1,"Linked",apply(em2.runs,2,quantile,probs = 0.025),
              apply(em2.runs,2,quantile,probs = 0.975),
              ylab = expression("g" ~ scriptscriptstyle(O) ~ "f"),xlab = "x, input",ylim = ylim)
</code></pre>

<hr>
<h2 id='eval_GASP_RFP'>
Evaluation of parameters of a Gaussian stochastic process emulator of a computer model.
</h2><span id='topic+eval_GASP_RFP'></span>

<h3>Description</h3>

<p>This function evaluates parameters of a Gaussian stochastic process emulator of a computer model based on a few observations which are available from the simulator of a computer model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eval_GASP_RFP(data, basis, corr.cols, nugget)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eval_GASP_RFP_+3A_data">data</code></td>
<td>

<p>list which consists of three objects: training input values (which may be multivariate, along several dimensions), corresponding output values of a simulator (scalar) and a vector of smoothness parameter(s) along each input direction.
</p>
</td></tr>
<tr><td><code id="eval_GASP_RFP_+3A_basis">basis</code></td>
<td>

<p>A set of functions in the mean of a Gaussian process. Typically assumed to be linear in one or several dimensions.
</p>
</td></tr>
<tr><td><code id="eval_GASP_RFP_+3A_corr.cols">corr.cols</code></td>
<td>

<p>specifies which input directions must be included in the specification of a correlation function.
</p>
</td></tr>
<tr><td><code id="eval_GASP_RFP_+3A_nugget">nugget</code></td>
<td>

<p>Parameter which accounts for possible small stochastisity in the output of a computer model. Default is FALSE.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See examples which illustrate inputs specification to the function.
</p>


<h3>Value</h3>


<p>Function returns a list of objects, including estimates of parameters, which is subsequently may be used for construction of a GASP approximation with the estimated parameters and the data involved.
</p>
<table>
<tr><td><code>delta</code></td>
<td>
<p>Estimates of range parameters in the correlation function.</p>
</td></tr>
<tr><td><code>eta</code></td>
<td>
<p>Estimates of a nugget.</p>
</td></tr>
<tr><td><code>sigma.sq</code></td>
<td>
<p>Estimates of variance.</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>Input parameter returned for convenience.</p>
</td></tr>
<tr><td><code>nugget</code></td>
<td>
<p>Input parameter returned for convenience.</p>
</td></tr>
<tr><td><code>basis</code></td>
<td>
<p>Input parameter returned for convenience.</p>
</td></tr>
<tr><td><code>corr.cols</code></td>
<td>
<p>Input parameter returned for convenience.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ksenia N. Kyzyurova, kseniak.ucoz.net.
</p>


<h3>References</h3>

<p>Ksenia N. Kyzyurova, James O. Berger, and Robert L. Wolpert. Coupling computer models through linking their statistical emulators. SIAM/ASA Journal on Uncertainty Quantification, 6(3): 1151-1171, 2018
</p>
<p>Gu, M., Wang, X., Berger, J. O. et al. (2018) Robust Gaussian stochastic process emulation. The Annals of Statistics, 46, 3038-3066.</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Function f1 is a simulator
f1&lt;-function(x){sin(pi*x)}

## One-dimensional inputs are x1
x1 &lt;- seq(-1,1,.37)

## data.f1 contains the list of data inputs (training) and outputs (fD) together with the assumed
## fixed smoothness of a computer model output. This corresponds to the smoothness in a product 
## power exponential correlation function used for construction of the emulator.
data.f1 &lt;- list(training = x1,fD = f1(x1), smooth = 1.99)

## Evaluation of GASP parameters
f1_MLEs = eval_GASP_RFP(data.f1,list(function(x){x^0},function(x){x^1}),1,FALSE)
</code></pre>

<hr>
<h2 id='eval_TGASP'>
T-GASP emulator
</h2><span id='topic+eval_TGASP'></span>

<h3>Description</h3>

<p>This function evaluates the third GASP of a computer model within objective Bayesian (OB) implementation of the GASP, resulting in T-GASP.</p>


<h3>Usage</h3>

<pre><code class='language-R'>eval_TGASP(input, GASPparams)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eval_TGASP_+3A_input">input</code></td>
<td>

<p>Input values (the same dimension as training input data in the next argument GASPparams)
</p>
</td></tr>
<tr><td><code id="eval_TGASP_+3A_gaspparams">GASPparams</code></td>
<td>

<p>The output of the function eval_GASP_RFP.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Function returns a list of three objects
</p>
<table>
<tr><td><code>x</code></td>
<td>
<p>Inputs.</p>
</td></tr>
<tr><td><code>mu</code></td>
<td>
<p>Mean of an emulator.</p>
</td></tr>
<tr><td><code>var</code></td>
<td>
<p>Covariance matrix of an emulator.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ksenia N. Kyzyurova, kseniak.ucoz.net.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Function f2 is a simulator
f2&lt;-function(x){cos(5*x)}

## One-dimensional inputs x2
x2 = seq(-0.95,0.95,length = 6)
data.f2 &lt;- list(training = x2,fD = f2(x2), smooth = 2)

## Evaluation of GASP parameters
f2_MLEs = eval_GASP_RFP(data.f2,list(function(x){x^0},function(x){x^1}),1,FALSE)

## Evaluation of a T-GASP emulator
TGASP_f2 &lt;- eval_TGASP(as.matrix(seq(-1,1,.01)),f2_MLEs)
</code></pre>

<hr>
<h2 id='eval_type1_GASP'>
The first type of an emulator of a computer model
</h2><span id='topic+eval_type1_GASP'></span>

<h3>Description</h3>

<p>This function evaluates the first GASP of a computer model using maximum a posteriori estimates (MAP) of parameters of the GASP.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eval_type1_GASP(input, GASPparams)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eval_type1_GASP_+3A_input">input</code></td>
<td>

<p>input values (the same dimension as training input data in the next argument GASPparams)
</p>
</td></tr>
<tr><td><code id="eval_type1_GASP_+3A_gaspparams">GASPparams</code></td>
<td>

<p>The output of the function eval_GASP_RFP.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See examples which illustrate inputs specification to the function.
</p>


<h3>Value</h3>

<p>Function returns a list of three objects
</p>
<table>
<tr><td><code>x</code></td>
<td>
<p>Inputs.</p>
</td></tr>
<tr><td><code>mu</code></td>
<td>
<p>Mean of an emulator.</p>
</td></tr>
<tr><td><code>var</code></td>
<td>
<p>Covariance matrix of an emulator.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ksenia N. Kyzyurova, kseniak.ucoz.net.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Function f1 is a simulator
f1&lt;-function(x){sin(pi*x)}

## One-dimensional inputs are x1
x1 &lt;- seq(-1,1,.37)

## The following contains the list of data inputs (training) and outputs (fD) together with the 
## assumed fixed smoothness of a computer model output.
data.f1 &lt;- list(training = x1,fD = f1(x1), smooth = 1.99)

## Evaluation of GASP parameters
f1_MLEs = eval_GASP_RFP(data.f1,list(function(x){x^0},function(x){x^1}),1,FALSE)

## Evaluate the emulator
xn = seq(-1,1,.01)
GASP_type1_f1 &lt;- eval_type1_GASP(as.matrix(xn),f1_MLEs)
</code></pre>

<hr>
<h2 id='eval_type2_GASP'>
The second type of an emulator of a computer model
</h2><span id='topic+eval_type2_GASP'></span>

<h3>Description</h3>

<p>This function evaluates the second GASP of a computer model within partial objective Bayesian (POB) implementation of the GASP.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eval_type2_GASP(input, GASPparams)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eval_type2_GASP_+3A_input">input</code></td>
<td>

<p>input values (the same dimension as training input data in the next argument GASPparams)
</p>
</td></tr>
<tr><td><code id="eval_type2_GASP_+3A_gaspparams">GASPparams</code></td>
<td>

<p>The output of the function eval_GASP_RFP.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See examples which illustrate inputs specification to the function.
</p>


<h3>Value</h3>

<p>Function returns a list of three objects
</p>
<table>
<tr><td><code>x</code></td>
<td>
<p>Inputs.</p>
</td></tr>
<tr><td><code>mu</code></td>
<td>
<p>Mean of an emulator.</p>
</td></tr>
<tr><td><code>var</code></td>
<td>
<p>Covariance matrix of an emulator.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ksenia N. Kyzyurova, kseniak.ucoz.net.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Function f2 is a simulator
f2&lt;-function(x){cos(5*x)}

## One-dimensional inputs x2
x2 = seq(-0.95,0.95,length = 6)
data.f2 &lt;- list(training = x2,fD = f2(x2), smooth = 2)

## Evaluation of GASP parameters
f2_MLEs = eval_GASP_RFP(data.f2,list(function(x){x^0},function(x){x^1}),1,FALSE)

## Evaluation of a second type GASP emulator
GASP_type2_f2 &lt;- eval_type2_GASP(as.matrix(seq(-1,1,.01)),f2_MLEs)

</code></pre>

<hr>
<h2 id='GASP_plot'>
Plot of the GASP
</h2><span id='topic+GASP_plot'></span>

<h3>Description</h3>

<p>Function allows to plot the GASP in case of one-dimensional input.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GASP_plot(em, fun, data, emul_type, labels, yax, ylab, xlab,ylim,
col_CI_area,col_points,col_fun,col_mean,plot_training = FALSE, plot_fun = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GASP_plot_+3A_em">em</code></td>
<td>

<p>the returned output from the function eval_type1_GASP(...) or eval_type2_GASP(...).
</p>
</td></tr>
<tr><td><code id="GASP_plot_+3A_fun">fun</code></td>
<td>

<p>Simulator function. Currently only one-dimensional input is supported.
</p>
</td></tr>
<tr><td><code id="GASP_plot_+3A_data">data</code></td>
<td>

<p>Training data and smoothness. The same as supplied to eval_GASP_RFP(...) for construction of the GASP.
</p>
</td></tr>
<tr><td><code id="GASP_plot_+3A_emul_type">emul_type</code></td>
<td>

<p>A text string which provides description of an emulator.
</p>
</td></tr>
<tr><td><code id="GASP_plot_+3A_labels">labels</code></td>
<td>

<p>As in standard R plot.
</p>
</td></tr>
<tr><td><code id="GASP_plot_+3A_yax">yax</code></td>
<td>

<p>As in standard R plot.
</p>
</td></tr>
<tr><td><code id="GASP_plot_+3A_ylab">ylab</code></td>
<td>

<p>As in standard R plot.
</p>
</td></tr>
<tr><td><code id="GASP_plot_+3A_xlab">xlab</code></td>
<td>

<p>As in standard R plot.
</p>
</td></tr>
<tr><td><code id="GASP_plot_+3A_ylim">ylim</code></td>
<td>

<p>As in standard R plot.
</p>
</td></tr>
<tr><td><code id="GASP_plot_+3A_col_ci_area">col_CI_area</code></td>
<td>

<p>Color of a credible area.
</p>
</td></tr>
<tr><td><code id="GASP_plot_+3A_col_points">col_points</code></td>
<td>

<p>Color of the training points.
</p>
</td></tr>
<tr><td><code id="GASP_plot_+3A_col_fun">col_fun</code></td>
<td>

<p>Color of a simulator function.
</p>
</td></tr>
<tr><td><code id="GASP_plot_+3A_col_mean">col_mean</code></td>
<td>

<p>Color of the emulator of the GASP mean.
</p>
</td></tr>
<tr><td><code id="GASP_plot_+3A_plot_training">plot_training</code></td>
<td>

<p>(Not) to plot the training points. Default is FALSE. 
</p>
</td></tr>
<tr><td><code id="GASP_plot_+3A_plot_fun">plot_fun</code></td>
<td>

<p>(Not) to plot the simulator function. Default is TRUE. 
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Plot
</p>


<h3>Note</h3>

<p>The function requires further development to be automated for visualization along a single dimension out of multiple dimensions and along two dimensions out of multiple dimensions.
</p>


<h3>Author(s)</h3>

<p>Ksenia N. Kyzyurova, kseniak.ucoz.net
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Function f1 is a simulator
f1&lt;-function(x){sin(pi*x)}

## One-dimensional inputs are x1
x1 &lt;- seq(-1,1,.37)

## The following contains the list of data inputs (training) and outputs (fD) together with the 
## assumed fixed smoothness of a computer model output.
data.f1 &lt;- list(training = x1,fD = f1(x1), smooth = 1.99)

## Evaluation of GASP parameters
f1_MLEs = eval_GASP_RFP(data.f1,list(function(x){x^0},function(x){x^1}),1,FALSE)

## Evaluate the emulator
xn = seq(-1,1,.01)
GASP_type1_f1 &lt;- eval_type1_GASP(as.matrix(xn),f1_MLEs)

## Plot the emulator
par(mfrow = c(1,1))
par(mar = c(6.1, 6.1, 5.1, 2.1))
ylim = c(-1.5,1.5)
GASP_plot(GASP_type1_f1,fun = f1,data = data.f1,"",ylim = ylim, plot_training = TRUE)
</code></pre>

<hr>
<h2 id='link'>
Linking two emulators
</h2><span id='topic+link'></span>

<h3>Description</h3>

<p>Function constructs a linked GASP emulator of a composite computer model f2(f1).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>link(f1_MLEs, f2_MLEs, test_input)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="link_+3A_f1_mles">f1_MLEs</code></td>
<td>

<p>Parameters of the emulator of a simulator f1.
</p>
</td></tr>
<tr><td><code id="link_+3A_f2_mles">f2_MLEs</code></td>
<td>

<p>Parameters of the emulator of a simulator f2.
</p>
</td></tr>
<tr><td><code id="link_+3A_test_input">test_input</code></td>
<td>

<p>Testing inputs.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See examples which illustrate inputs specification to the function.
</p>


<h3>Value</h3>

<p>Four types of the linked GASP.
</p>
<table>
<tr><td><code>em1</code></td>
<td>
<p>Type 1 emulator, which uses MAP estimates of parameters.</p>
</td></tr>
<tr><td><code>em2</code></td>
<td>
<p>Type 2 emulator within partial objective Bayesian (POB) implementation.</p>
</td></tr>
<tr><td><code>emT</code></td>
<td>
<p>T-GASP emulator within objective Bayesian (OB) implementation.</p>
</td></tr>
<tr><td><code>em3</code></td>
<td>
<p>Approximated T-GASP emulator with the Gaussian distribution.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ksenia N. Kyzyurova, kseniak.ucoz.net
</p>


<h3>References</h3>

<p> Ksenia N. Kyzyurova, James O. Berger, and Robert L. Wolpert. Coupling computer models through linking their statistical emulators. SIAM/ASA Journal on Uncertainty Quantification, 6(3): 1151-1171, 2018</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Function f1 is a simulator
f1&lt;-function(x){sin(pi*x)}
## Function f2 is a simulator
f2&lt;-function(x){cos(5*x)}

## Function f2(f1) is a simulator of a composite model
f2f1 &lt;- function(x){f2(f1(x))}

## One-dimensional inputs are x1
x1 &lt;- seq(-1,1,.37)

## The following contains the list of data inputs (training) and outputs (fD) together with 
## the assumed fixed smoothness of a computer model output.
data.f1 &lt;- list(training = x1,fD = f1(x1), smooth = 1.99)

## Evaluation of GASP parameters
f1_MLEs = eval_GASP_RFP(data.f1,list(function(x){x^0},function(x){x^1}),1,FALSE)

## Evaluate the emulator
xn = seq(-1,1,.01)
GASP_type2_f1 &lt;- eval_type2_GASP(as.matrix(xn),f1_MLEs)

par(mfrow = c(1,1))
par(mar = c(6.1, 6.1, 5.1, 2.1))
ylim = c(-1.5,1.5)
GASP_plot(GASP_type2_f1,f1,data.f1,"Type 2 GASP",ylab = " f",xlab = "x",
ylim = ylim, plot_training = TRUE)

s = GASP_type2_f1$mu
s.var = diag(GASP_type2_f1$var)

x2 = seq(-0.95,0.95,length = 6)#f1(x1)
data.f2 &lt;- list(training = x2,fD = f2(x2), smooth = 2) # linking requires this emulator 
# to have smoothness parameter equal to 2

f2_MLEs = eval_GASP_RFP(data.f2,list(function(x){x^0},function(x){x^1}),1,FALSE)

GASP_type1_f2 &lt;- eval_type1_GASP(as.matrix(seq(-3.5,3.5,.01)),f2_MLEs)
GASP_type2_f2 &lt;- eval_type2_GASP(as.matrix(seq(-1,1,.01)),f2_MLEs)
TGASP_f2 &lt;- eval_TGASP(as.matrix(seq(-1,1,.01)),f2_MLEs)

ylim = c(-1.5,1.5)
# labels = c(expression(phantom(x)*phantom(x)*phantom(x)*f(x[1])),
# expression(f(x[2])*phantom(x)*phantom(x)*phantom(x)),
# expression(f(x[3])),expression(f(x[4])),
# expression(f(x[5])),expression(f(x[6])))

par(mar = c(6.1, 6.1, 5.1, 2.1))
GASP_plot(GASP_type2_f2,f2,data.f2, "Type 2 GASP",labels = x2,xlab= "z",ylab = " g",
ylim = ylim,plot_training = TRUE)

le &lt;- link(f1_MLEs, f2_MLEs, as.matrix(xn))

## Plot second type of the linked GASP
data.f2f1 &lt;- list(training = x1,fD = f2f1(x1), smooth = 2)

par(mar = c(6.1, 6.1, 5.1, 2.1))
GASP_plot(le$em2,f2f1,data.f2f1,"Linked",labels = x1,
ylab = expression("g" ~ scriptscriptstyle(O) ~ "f"),xlab = "x",ylim = ylim)
</code></pre>

<hr>
<h2 id='NGASPmetrics'>
GASP performance assessment measures
</h2><span id='topic+NGASPmetrics'></span>

<h3>Description</h3>

<p>Evaluates frequentist performance of the GASP.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NGASPmetrics(GASP, true_output, ref_output)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NGASPmetrics_+3A_gasp">GASP</code></td>
<td>

<p>GASP emulator.
</p>
</td></tr>
<tr><td><code id="NGASPmetrics_+3A_true_output">true_output</code></td>
<td>

<p>Output from the simulator.
</p>
</td></tr>
<tr><td><code id="NGASPmetrics_+3A_ref_output">ref_output</code></td>
<td>

<p>Heuristic emulator output.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of performance measures.
</p>
<table>
<tr><td><code>RMSPE_base</code></td>
<td>
<p>Root mean square predictive error with respect to the heuristic emulator output.</p>
</td></tr>
<tr><td><code>RMSPE</code></td>
<td>
<p>Root mean square predictive error for the emulator output</p>
</td></tr>
<tr><td><code>ratio</code></td>
<td>
<p>ratio of RMSPE_base to RMSPE. Ratio = RMSPE_base/RMSPE</p>
</td></tr>
<tr><td><code>CIs</code></td>
<td>
<p>95% central credible intervals</p>
</td></tr>
<tr><td><code>emp_cov</code></td>
<td>
<p>95% empirical coverage within the CIs</p>
</td></tr>
<tr><td><code>length_CIs</code></td>
<td>
<p>Average lenght of 95% central credible intervals</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ksenia N. Kyzyurova, ksenia.ucoz.net
</p>


<h3>References</h3>

<p>Ksenia N. Kyzyurova, James O. Berger, and Robert L. Wolpert. Coupling computer models through linking their statistical emulators. SIAM/ASA Journal on Uncertainty Quantification, 6(3): 1151-1171, 2018</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Function f1 is a simulator
f1&lt;-function(x){sin(pi*x)}

## One-dimensional inputs are x1
x1 &lt;- seq(-1,1,.37)

## The following contains the list of data inputs (training) and outputs (fD) together with 
## the assumed fixed smoothness of a computer model output.
data.f1 &lt;- list(training = x1,fD = f1(x1), smooth = 1.99)

## Evaluation of GASP parameters
f1_MLEs = eval_GASP_RFP(data.f1,list(function(x){x^0},function(x){x^1}),1,FALSE)

## Evaluate the emulator
xn = seq(-1,1,.01)
GASP_type2_f1 &lt;- eval_type2_GASP(as.matrix(xn),f1_MLEs)

## Plot the emulator
par(mar = c(6.1, 6.1, 5.1, 2.1))
GASP_plot(GASP_type2_f1,data = data.f1,emul_type = "",ylim = ylim, plot_training = TRUE)

## Measure performance of an emulator
NGASPmetrics(GASP_type2_f1,f1(xn),mean(f1(xn)))
</code></pre>

<hr>
<h2 id='TGASP_plot'>
T-GASP plot
</h2><span id='topic+TGASP_plot'></span>

<h3>Description</h3>

<p>Function allows to plot the TGASP in case of one-dimensional input. Black-and-white version.</p>


<h3>Usage</h3>

<pre><code class='language-R'>TGASP_plot(tem, fun, data, labels, ylim, points)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TGASP_plot_+3A_tem">tem</code></td>
<td>

<p>TGasP emulator.
</p>
</td></tr>
<tr><td><code id="TGASP_plot_+3A_fun">fun</code></td>
<td>

<p>Simulator function.
</p>
</td></tr>
<tr><td><code id="TGASP_plot_+3A_data">data</code></td>
<td>

<p>Training data and smoothness. The same as supplied to eval_GASP_RFP(...) for construction of a GASP.
</p>
</td></tr>
<tr><td><code id="TGASP_plot_+3A_labels">labels</code></td>
<td>

<p>As in standard R plot.
</p>
</td></tr>
<tr><td><code id="TGASP_plot_+3A_ylim">ylim</code></td>
<td>

<p>As in standard R plot.
</p>
</td></tr>
<tr><td><code id="TGASP_plot_+3A_points">points</code></td>
<td>

<p>(Not) to plot the training points.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See examples.
</p>


<h3>Value</h3>

<p>Plot
</p>


<h3>Note</h3>

<p>The function requires further development to be automated for visualization along a single dimension out of multiple dimensions and along two dimensions out of multiple dimensions.
</p>
<p>This function needs to be automated to allow for fast visualization of a single emualtor (with no comparison to the actual simulator function), etc.
</p>


<h3>Author(s)</h3>

<p>Ksenia N. Kyzyurova, kseniak.ucoz.net
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Function f1 is a simulator
f1&lt;-function(x){sin(pi*x)}

## One-dimensional inputs are x1
x1 &lt;- seq(-1,1,.37)

## The following contains the list of data inputs (training) and outputs (fD) together with 
## the assumed fixed smoothness of a computer model output.
data.f1 &lt;- list(training = x1,fD = f1(x1), smooth = 1.99)

## Evaluation of GASP parameters
f1_MLEs = eval_GASP_RFP(data.f1,list(function(x){x^0},function(x){x^1}),1,FALSE)

## Evaluate the emulator
xn = seq(-1,1,.01)
TGASP_f1 &lt;- eval_TGASP(as.matrix(xn),f1_MLEs)

## Plot the emulator
par(mfrow = c(1,1))
par(mar = c(6.1, 6.1, 5.1, 2.1))
ylim = c(-1.5,1.5)
TGASP_plot(TGASP_f1,f1,data.f1,ylim = ylim)
</code></pre>

<hr>
<h2 id='TGASPmetrics'>
Performance measurement of a T-GASP
</h2><span id='topic+TGASPmetrics'></span>

<h3>Description</h3>

<p>Evaluates frequentist performance of a T-GASP.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TGASPmetrics(TGASP, true_output, ref_output)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TGASPmetrics_+3A_tgasp">TGASP</code></td>
<td>

<p>TGASP emulator (in the paper this is done within an objective Bayesian implementation - OB emulator.)
</p>
</td></tr>
<tr><td><code id="TGASPmetrics_+3A_true_output">true_output</code></td>
<td>

<p>Output from the simulator.
</p>
</td></tr>
<tr><td><code id="TGASPmetrics_+3A_ref_output">ref_output</code></td>
<td>

<p>Heuristic emulator output.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See examples which illustrate the use of the function.
</p>


<h3>Value</h3>

<p>List of performance measures.
</p>
<table>
<tr><td><code>RMSPE_base</code></td>
<td>
<p>Root mean square predictive error with respect to the heuristic emulator output.</p>
</td></tr>
<tr><td><code>RMSPE</code></td>
<td>
<p>Root mean square predictive error for the emulator output</p>
</td></tr>
<tr><td><code>ratio</code></td>
<td>
<p>ratio of RMSPE_base to RMSPE. Ratio = RMSPE_base/RMSPE</p>
</td></tr>
<tr><td><code>CIs</code></td>
<td>
<p>95% central credible intervals</p>
</td></tr>
<tr><td><code>emp_cov</code></td>
<td>
<p>95% empirical coverage within the CIs</p>
</td></tr>
<tr><td><code>length_CIs</code></td>
<td>
<p>Average lenght of 95% central credible intervals</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ksenia N. Kyzyurova, ksenia.ucoz.net
</p>


<h3>References</h3>

<p>Ksenia N. Kyzyurova, James O. Berger, and Robert L. Wolpert. Coupling computer models through linking their statistical emulators. SIAM/ASA Journal on Uncertainty Quantification, 6(3): 1151-1171, 2018</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Function f1 is a simulator
f1&lt;-function(x){sin(pi*x)}

## One-dimensional inputs are x1
x1 &lt;- seq(-1,1,.37)

## The following contains the list of data inputs (training) and outputs (fD) together with 
## the assumed fixed smoothness of a computer model output.
data.f1 &lt;- list(training = x1,fD = f1(x1), smooth = 1.99)

## Evaluation of GASP parameters
f1_MLEs = eval_GASP_RFP(data.f1,list(function(x){x^0},function(x){x^1}),1,FALSE)

## Evaluate the emulator
xn = seq(-1,1,.01)
TGASP_f1 &lt;- eval_TGASP(as.matrix(xn),f1_MLEs)

## Plot the emulator
par(mfrow = c(1,1))
par(mar = c(6.1, 6.1, 5.1, 2.1))
ylim = c(-1.5,1.5)
TGASP_plot(TGASP_f1,f1,data.f1,ylim = ylim)

## Measure the performance of the emulator
TGASPmetrics(TGASP_f1,f1(xn),mean(f1(xn)))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
