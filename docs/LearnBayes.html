<!DOCTYPE html><html><head><title>Help for package LearnBayes</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {LearnBayes}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#achievement'><p>School achievement data</p></a></li>
<li><a href='#baseball.1964'><p>Team records in the 1964 National League baseball season</p></a></li>
<li><a href='#bayes.influence'><p>Observation sensitivity analysis in beta-binomial model</p></a></li>
<li><a href='#bayes.model.selection'><p>Bayesian regression model selection using G priors</p></a></li>
<li><a href='#bayes.probit'><p>Simulates from a probit binary response regression model using data augmentation and Gibbs sampling</p></a></li>
<li><a href='#bayesresiduals'><p>Computation of posterior residual outlying probabilities for a linear regression model</p></a></li>
<li><a href='#bermuda.grass'><p>Bermuda grass experiment data</p></a></li>
<li><a href='#beta.select'><p>Selection of Beta Prior Given Knowledge of Two Quantiles</p></a></li>
<li><a href='#betabinexch'><p>Log posterior of logit mean and log precision for Binomial/beta exchangeable model</p></a></li>
<li><a href='#betabinexch0'><p>Log posterior of mean and precision for Binomial/beta exchangeable model</p></a></li>
<li><a href='#bfexch'><p>Logarithm of integral of Bayes factor for testing homogeneity of proportions</p></a></li>
<li><a href='#bfindep'><p>Bayes factor against independence assuming alternatives close to independence</p></a></li>
<li><a href='#binomial.beta.mix'><p>Computes the posterior for binomial sampling and a mixture of betas prior</p></a></li>
<li><a href='#birdextinct'><p>Bird measurements from British islands</p></a></li>
<li><a href='#birthweight'><p>Birthweight regression study</p></a></li>
<li><a href='#blinreg'><p>Simulation from Bayesian linear regression model</p></a></li>
<li><a href='#blinregexpected'><p>Simulates values of expected response for linear regression model</p></a></li>
<li><a href='#blinregpred'><p>Simulates values of predicted response for linear regression model</p></a></li>
<li><a href='#bprobit.probs'><p>Simulates fitted probabilities for a probit regression model</p></a></li>
<li><a href='#bradley.terry.post'><p>Log posterior of a Bradley Terry random effects model</p></a></li>
<li><a href='#breastcancer'><p>Survival experience of women with breast cancer under treatment</p></a></li>
<li><a href='#calculus.grades'><p>Calculus grades dataset</p></a></li>
<li><a href='#cancermortality'><p>Cancer mortality data</p></a></li>
<li><a href='#careertraj.setup'><p>Setup for Career Trajectory Application</p></a></li>
<li><a href='#cauchyerrorpost'><p>Log posterior of median and log scale parameters for Cauchy sampling</p></a></li>
<li><a href='#chemotherapy'><p>Chemotherapy treatment effects on ovarian cancer</p></a></li>
<li><a href='#ctable'><p>Bayes factor against independence using uniform priors</p></a></li>
<li><a href='#darwin'><p>Darwin's data on plants</p></a></li>
<li><a href='#discint'><p>Highest probability interval for a discrete distribution</p></a></li>
<li><a href='#discrete.bayes'><p>Posterior distribution with discrete priors</p></a></li>
<li><a href='#discrete.bayes.2'><p>Posterior distribution of two parameters with discrete priors</p></a></li>
<li><a href='#dmnorm'><p>The probability density function for the multivariate normal (Gaussian) probability distribution</p></a></li>
<li><a href='#dmt'><p>Probability density function for multivariate t</p></a></li>
<li><a href='#donner'><p>Donner survival study</p></a></li>
<li><a href='#election'><p>Florida election data</p></a></li>
<li><a href='#election.2008'><p>Poll data from 2008 U.S. Presidential Election</p></a></li>
<li><a href='#footballscores'><p>Game outcomes and point spreads for American football</p></a></li>
<li><a href='#gibbs'><p>Metropolis within Gibbs sampling algorithm of a posterior distribution</p></a></li>
<li><a href='#groupeddatapost'><p>Log posterior of normal parameters when data is in grouped form</p></a></li>
<li><a href='#hearttransplants'><p>Heart transplant mortality data</p></a></li>
<li><a href='#hiergibbs'><p>Gibbs sampling for a hierarchical regression model</p></a></li>
<li><a href='#histprior'><p>Density function of a histogram distribution</p></a></li>
<li><a href='#howardprior'><p>Logarithm of Howard's dependent prior for two proportions</p></a></li>
<li><a href='#impsampling'><p>Importance sampling using a t proposal density</p></a></li>
<li><a href='#indepmetrop'><p>Independence Metropolis independence chain of a posterior distribution</p></a></li>
<li><a href='#iowagpa'><p>Admissions data for an university</p></a></li>
<li><a href='#jeter2004'><p>Hitting data for Derek Jeter</p></a></li>
<li><a href='#laplace'><p>Summarization of a posterior density by the Laplace method</p></a></li>
<li><a href='#lbinorm'><p>Logarithm of bivariate normal density</p></a></li>
<li><a href='#logctablepost'><p>Log posterior of difference and sum of logits in a 2x2 table</p></a></li>
<li><a href='#logisticpost'><p>Log posterior for a binary response model with a logistic link and a uniform prior</p></a></li>
<li><a href='#logpoissgamma'><p>Log posterior with Poisson sampling and gamma prior</p></a></li>
<li><a href='#logpoissnormal'><p>Log  posterior with Poisson sampling and normal prior</p></a></li>
<li><a href='#marathontimes'><p>Marathon running times</p></a></li>
<li><a href='#mnormt.onesided'><p>Bayesian test of one-sided hypothesis about a normal mean</p></a></li>
<li><a href='#mnormt.twosided'><p>Bayesian test of a two-sided hypothesis about a normal mean</p></a></li>
<li><a href='#mycontour'><p>Contour plot of a bivariate density function</p></a></li>
<li><a href='#normal.normal.mix'><p>Computes the posterior for normal sampling and a mixture of normals prior</p></a></li>
<li><a href='#normal.select'><p>Selection of Normal Prior Given Knowledge of Two Quantiles</p></a></li>
<li><a href='#normchi2post'><p>Log posterior density for mean and variance for normal sampling</p></a></li>
<li><a href='#normnormexch'><p>Log posterior of mean and log standard deviation for Normal/Normal exchangeable model</p></a></li>
<li><a href='#normpostpred'><p>Posterior predictive simulation from Bayesian normal sampling model</p></a></li>
<li><a href='#normpostsim'><p>Simulation from Bayesian normal sampling model</p></a></li>
<li><a href='#ordergibbs'><p>Gibbs sampling for a hierarchical regression model</p></a></li>
<li><a href='#pbetap'><p>Predictive distribution for a binomial sample with a beta prior</p></a></li>
<li><a href='#pbetat'><p>Bayesian test of a proportion</p></a></li>
<li><a href='#pdisc'><p>Posterior distribution for a proportion with discrete priors</p></a></li>
<li><a href='#pdiscp'><p>Predictive distribution for a binomial sample with a discrete prior</p></a></li>
<li><a href='#poissgamexch'><p>Log posterior of Poisson/gamma exchangeable model</p></a></li>
<li><a href='#poisson.gamma.mix'><p>Computes the posterior for Poisson sampling and a mixture of gammas prior</p></a></li>
<li><a href='#predplot'><p>Plot of predictive distribution for binomial sampling with a beta prior</p></a></li>
<li><a href='#prior.two.parameters'><p>Construct discrete uniform prior for two parameters</p></a></li>
<li><a href='#puffin'><p>Bird measurements from British islands</p></a></li>
<li><a href='#rdirichlet'><p>Random draws from a Dirichlet distribution</p></a></li>
<li><a href='#reg.gprior.post'><p>Computes the log posterior of a normal regression model with a g prior.</p></a></li>
<li><a href='#regroup'><p>Collapses a matrix by summing over rows</p></a></li>
<li><a href='#rejectsampling'><p>Rejecting sampling using a t proposal density</p></a></li>
<li><a href='#rigamma'><p>Random number generation for inverse gamma distribution</p></a></li>
<li><a href='#rmnorm'><p>Random number generation for multivariate normal</p></a></li>
<li><a href='#rmt'><p>Random number generation for multivariate t</p></a></li>
<li><a href='#robustt'><p>Gibbs sampling for a robust regression model</p></a></li>
<li><a href='#rtruncated'><p>Simulates from a truncated probability distribution</p></a></li>
<li><a href='#rwmetrop'><p>Random walk Metropolis algorithm of a posterior distribution</p></a></li>
<li><a href='#schmidt'><p>Batting data for Mike Schmidt</p></a></li>
<li><a href='#simcontour'><p>Simulated draws from a bivariate density function on a grid</p></a></li>
<li><a href='#sir'><p>Sampling importance resampling</p></a></li>
<li><a href='#sluggerdata'><p>Hitting statistics for ten great baseball players</p></a></li>
<li><a href='#soccergoals'><p>Goals scored by professional soccer team</p></a></li>
<li><a href='#stanfordheart'><p>Data from Stanford Heart Transplanation Program</p></a></li>
<li><a href='#strikeout'><p>Baseball strikeout data</p></a></li>
<li><a href='#studentdata'><p>Student dataset</p></a></li>
<li><a href='#transplantpost'><p>Log posterior of a Pareto model for survival data</p></a></li>
<li><a href='#triplot'><p>Plot of prior, likelihood and posterior for a proportion</p></a></li>
<li><a href='#weibullregpost'><p>Log posterior of a Weibull proportional odds model for survival data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Functions for Learning Bayesian Inference</td>
</tr>
<tr>
<td>Version:</td>
<td>2.15.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2018-03-18</td>
</tr>
<tr>
<td>Author:</td>
<td>Jim Albert</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jim Albert &lt;albert@bgsu.edu&gt;</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>Description:</td>
<td>A collection of functions helpful in learning the basic tenets of Bayesian statistical inference.  It contains functions for summarizing basic one and two parameter posterior distributions and predictive distributions.  It contains MCMC algorithms for summarizing posterior distributions defined by the user.  It also contains functions for regression models, hierarchical models, Bayesian tests, and illustrations of Gibbs sampling.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-03-18 17:46:55 UTC; jamesalbert</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-03-18 20:41:13 UTC</td>
</tr>
</table>
<hr>
<h2 id='achievement'>School achievement data</h2><span id='topic+achievement'></span>

<h3>Description</h3>

<p>Achievement data for a group of Austrian school children
</p>


<h3>Usage</h3>

<pre><code class='language-R'>achievement
</code></pre>


<h3>Format</h3>

<p>A data frame with 109 observations on the following 7 variables.
</p>

<dl>
<dt>Gen</dt><dd><p>gender of child where 0 is male and 1 is female</p>
</dd>
<dt>Age</dt><dd><p>age in months</p>
</dd>
<dt>IQ</dt><dd><p>iq score</p>
</dd>
<dt>math1</dt><dd><p>test score on mathematics computation</p>
</dd>
<dt>math2</dt><dd><p>test score on mathematics problem solving</p>
</dd>
<dt>read1</dt><dd><p>test score on reading speed</p>
</dd>
<dt>read2</dt><dd><p>test score on reading comprehension</p>
</dd>
</dl>



<h3>Source</h3>

<p>Abraham, B., and Ledolter, J. (2006), Introduction to Regression Modeling, 
Duxbury.
</p>

<hr>
<h2 id='baseball.1964'>Team records in the 1964 National League baseball season</h2><span id='topic+baseball.1964'></span>

<h3>Description</h3>

<p>Head to head records for all teams in the 1964 National League baseball
season.  Teams are coded as Cincinnati (1), Chicago (2), Houston (3),
Los Angeles (4), Milwaukee (5), New York (6), Philadelphia (7),
Pittsburgh (8), San Francisco (9), and St. Louis (10).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>baseball.1964
</code></pre>


<h3>Format</h3>

<p>A data frame with 45 observations on the following 4 variables.
</p>

<dl>
<dt>Team.1</dt><dd><p>Number of team 1</p>
</dd>
<dt>Team.2</dt><dd><p>Number of team 2</p>
</dd>
<dt>Wins.Team1</dt><dd><p>Number of games won by team 1</p>
</dd>
<dt>Wins.Team2</dt><dd><p>Number of games won by team 2</p>
</dd>
</dl>



<h3>Source</h3>

<p>www.baseball-reference.com website.
</p>

<hr>
<h2 id='bayes.influence'>Observation sensitivity analysis in beta-binomial model</h2><span id='topic+bayes.influence'></span>

<h3>Description</h3>

<p>Computes probability intervals for the log precision parameter K
in a beta-binomial model for all &quot;leave one out&quot; models using sampling
importance resampling 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bayes.influence(theta,data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bayes.influence_+3A_theta">theta</code></td>
<td>
<p>matrix of simulated draws from the posterior of (logit eta, log K)</p>
</td></tr>
<tr><td><code id="bayes.influence_+3A_data">data</code></td>
<td>
<p>matrix with columns of counts and sample sizes</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>summary</code></td>
<td>
<p>vector of 5th, 50th, 95th percentiles of log K for complete sample posterior</p>
</td></tr>
<tr><td><code>summary.obs</code></td>
<td>
<p>matrix where the ith row contains the 5th, 50th, 95th percentiles
of log K for posterior when the ith observation is removed</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(cancermortality)
start=array(c(-7,6),c(1,2))
fit=laplace(betabinexch,start,cancermortality)
tpar=list(m=fit$mode,var=2*fit$var,df=4)
theta=sir(betabinexch,tpar,1000,cancermortality)
intervals=bayes.influence(theta,cancermortality)
</code></pre>

<hr>
<h2 id='bayes.model.selection'>Bayesian regression model selection using G priors</h2><span id='topic+bayes.model.selection'></span>

<h3>Description</h3>

<p>Using Zellner's G priors, computes the log marginal density for all possible regression models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bayes.model.selection(y, X, c, constant=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bayes.model.selection_+3A_y">y</code></td>
<td>
<p>vector of response values</p>
</td></tr>
<tr><td><code id="bayes.model.selection_+3A_x">X</code></td>
<td>
<p>matrix of covariates</p>
</td></tr>
<tr><td><code id="bayes.model.selection_+3A_c">c</code></td>
<td>
<p>parameter of the G prior</p>
</td></tr>
<tr><td><code id="bayes.model.selection_+3A_constant">constant</code></td>
<td>
<p>logical variable indicating if a constant term is in the matrix X</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>mod.prob</code></td>
<td>
<p>data frame specifying the model, the value of the log marginal density and
the value of the posterior model probability</p>
</td></tr>
<tr><td><code>converge</code></td>
<td>
<p>logical vector indicating if the laplace algorithm converged for each model</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(birdextinct)
logtime=log(birdextinct$time)
X=cbind(1,birdextinct$nesting,birdextinct$size,birdextinct$status)
bayes.model.selection(logtime,X,100)
</code></pre>

<hr>
<h2 id='bayes.probit'>Simulates from a probit binary response regression model using data augmentation and Gibbs sampling</h2><span id='topic+bayes.probit'></span>

<h3>Description</h3>

<p>Gives a simulated sample from the joint posterior distribution of the regression
vector for a binary response regression model with a probit link and a 
informative normal(beta, P) prior.  Also computes the log marginal likelihood when
a subjective prior is used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bayes.probit(y,X,m,prior=list(beta=0,P=0))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bayes.probit_+3A_y">y</code></td>
<td>
<p>vector of binary responses</p>
</td></tr>
<tr><td><code id="bayes.probit_+3A_x">X</code></td>
<td>
<p>covariate matrix</p>
</td></tr>
<tr><td><code id="bayes.probit_+3A_m">m</code></td>
<td>
<p>number of simulations desired</p>
</td></tr>
<tr><td><code id="bayes.probit_+3A_prior">prior</code></td>
<td>
<p>list with components beta, the prior mean, and P, the prior precision matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>beta</code></td>
<td>
<p>matrix of simulated draws of regression vector beta where each row corresponds to one draw</p>
</td></tr>
<tr><td><code>log.marg</code></td>
<td>
<p>simulation estimate at log marginal likelihood of the model</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>response=c(0,1,0,0,0,1,1,1,1,1)
covariate=c(1,2,3,4,5,6,7,8,9,10)
X=cbind(1,covariate)
prior=list(beta=c(0,0),P=diag(c(.5,10)))
m=1000
s=bayes.probit(response,X,m,prior)
</code></pre>

<hr>
<h2 id='bayesresiduals'>Computation of posterior residual outlying probabilities for a linear regression model</h2><span id='topic+bayesresiduals'></span>

<h3>Description</h3>

<p>Computes the posterior probabilities that Bayesian residuals exceed a cutoff value for a 
linear regression model with a noninformative prior
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bayesresiduals(lmfit,post,k)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bayesresiduals_+3A_lmfit">lmfit</code></td>
<td>
<p>output of the regression function lm</p>
</td></tr>
<tr><td><code id="bayesresiduals_+3A_post">post</code></td>
<td>
<p>list with components beta, matrix of simulated draws of regression parameter, and 
sigma, vector of simulated draws of sampling standard deviation</p>
</td></tr>
<tr><td><code id="bayesresiduals_+3A_k">k</code></td>
<td>
<p>cut-off value that defines an outlier</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector of posterior outlying probabilities
</p>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>chirps=c(20,16.0,19.8,18.4,17.1,15.5,14.7,17.1,15.4,16.2,15,17.2,16,17,14.1)
temp=c(88.6,71.6,93.3,84.3,80.6,75.2,69.7,82,69.4,83.3,78.6,82.6,80.6,83.5,76.3)
X=cbind(1,chirps)
lmfit=lm(temp~X)
m=1000
post=blinreg(temp,X,m)
k=2
bayesresiduals(lmfit,post,k)
</code></pre>

<hr>
<h2 id='bermuda.grass'>Bermuda grass experiment data</h2><span id='topic+bermuda.grass'></span>

<h3>Description</h3>

<p>Yields of bermuda grass for a factorial design of nutrients
nitrogen,
phosphorus, and potassium.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bermuda.grass
</code></pre>


<h3>Format</h3>

<p>A data frame with 64 observations on the following 4 variables.
</p>

<dl>
<dt>y</dt><dd><p>yield of bermuda grass in tons per acre</p>
</dd>
<dt>Nit</dt><dd><p>level of nitrogen</p>
</dd>
<dt>Phos</dt><dd><p>level of phosphorus</p>
</dd>
<dt>Pot</dt><dd><p>level of potassium</p>
</dd>
</dl>



<h3>Source</h3>

<p>McCullagh, P., and Nelder, J. (1989), Generalized Linear Models,
Chapman and Hall.
</p>

<hr>
<h2 id='beta.select'>Selection of Beta Prior Given Knowledge of Two Quantiles</h2><span id='topic+beta.select'></span>

<h3>Description</h3>

<p>Finds the shape parameters of a beta density that matches knowledge of
two quantiles of the distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>beta.select(quantile1, quantile2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="beta.select_+3A_quantile1">quantile1</code></td>
<td>
<p>list with components p, the value of the first probability,
and x, the value of the first quantile</p>
</td></tr>
<tr><td><code id="beta.select_+3A_quantile2">quantile2</code></td>
<td>
<p>list with components p, the value of the second probability,
and x, the value of the second quantile</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector of shape parameters of the matching beta distribution
</p>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'># person believes the median of the prior is 0.25 
# and the 90th percentile of the prior is 0.45
quantile1=list(p=.5,x=0.25)
quantile2=list(p=.9,x=0.45)
beta.select(quantile1,quantile2)
</code></pre>

<hr>
<h2 id='betabinexch'>Log posterior of logit mean and log precision for Binomial/beta exchangeable model</h2><span id='topic+betabinexch'></span>

<h3>Description</h3>

<p>Computes the log posterior density of logit mean and log precision for a Binomial/beta exchangeable model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>betabinexch(theta,data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="betabinexch_+3A_theta">theta</code></td>
<td>
<p>vector of parameter values of logit eta and log K</p>
</td></tr>
<tr><td><code id="betabinexch_+3A_data">data</code></td>
<td>
<p>a matrix with columns y (counts) and n (sample sizes)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>value of the log posterior
</p>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>n=c(20,20,20,20,20)
y=c(1,4,3,6,10)
data=cbind(y,n)
theta=c(-1,0)
betabinexch(theta,data)
</code></pre>

<hr>
<h2 id='betabinexch0'>Log posterior of mean and precision for Binomial/beta exchangeable model</h2><span id='topic+betabinexch0'></span>

<h3>Description</h3>

<p>Computes the log posterior density of mean and precision for a Binomial/beta exchangeable model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>betabinexch0(theta,data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="betabinexch0_+3A_theta">theta</code></td>
<td>
<p>vector of parameter values of eta and K</p>
</td></tr>
<tr><td><code id="betabinexch0_+3A_data">data</code></td>
<td>
<p>a matrix with columns y (counts) and n (sample sizes)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>value of the log posterior</p>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>n=c(20,20,20,20,20)
y=c(1,4,3,6,10)
data=cbind(y,n)
theta=c(.1,10)
betabinexch0(theta,data)
</code></pre>

<hr>
<h2 id='bfexch'>Logarithm of integral of Bayes factor for testing homogeneity of proportions</h2><span id='topic+bfexch'></span>

<h3>Description</h3>

<p>Computes the logarithm of the integral of the Bayes factor for testing homogeneity of a set of proportions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bfexch(theta,datapar)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bfexch_+3A_theta">theta</code></td>
<td>
<p>value of the logit of the prior mean hyperparameter</p>
</td></tr>
<tr><td><code id="bfexch_+3A_datapar">datapar</code></td>
<td>
<p>list with components data, matrix with columns y (counts) and n (sample sizes), and K, prior
precision hyperparameter</p>
</td></tr>
</table>


<h3>Value</h3>

<p>value of the logarithm of the integral
</p>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>y=c(1,3,2,4,6,4,3)
n=c(10,10,10,10,10,10,10)
data=cbind(y,n)
K=20
datapar=list(data=data,K=K)
theta=1
bfexch(theta,datapar)
</code></pre>

<hr>
<h2 id='bfindep'>Bayes factor against independence assuming alternatives close to independence</h2><span id='topic+bfindep'></span>

<h3>Description</h3>

<p>Computes a Bayes factor against independence for a two-way contingency table assuming
a &quot;close to independence&quot; alternative model</p>


<h3>Usage</h3>

<pre><code class='language-R'>bfindep(y,K,m)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bfindep_+3A_y">y</code></td>
<td>
<p>matrix of counts</p>
</td></tr>
<tr><td><code id="bfindep_+3A_k">K</code></td>
<td>
<p>Dirichlet precision hyperparameter</p>
</td></tr>
<tr><td><code id="bfindep_+3A_m">m</code></td>
<td>
<p>number of simulations</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>bf</code></td>
<td>
<p>value of the Bayes factor against hypothesis of independence</p>
</td></tr>
<tr><td><code>nse</code></td>
<td>
<p>estimate of the simulation standard error of the computed Bayes factor</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>y=matrix(c(10,4,6,3,6,10),c(2,3))
K=20
m=1000
bfindep(y,K,m)
</code></pre>

<hr>
<h2 id='binomial.beta.mix'>Computes the posterior for binomial sampling and a mixture of betas prior</h2><span id='topic+binomial.beta.mix'></span>

<h3>Description</h3>

<p>Computes the parameters and mixing probabilities for a binomial sampling problem
where the prior is a discrete mixture of beta densities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>binomial.beta.mix(probs,betapar,data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="binomial.beta.mix_+3A_probs">probs</code></td>
<td>
<p>vector of probabilities of the beta components of the prior</p>
</td></tr>
<tr><td><code id="binomial.beta.mix_+3A_betapar">betapar</code></td>
<td>
<p>matrix where each row contains the shape parameters for a beta component of the prior</p>
</td></tr>
<tr><td><code id="binomial.beta.mix_+3A_data">data</code></td>
<td>
<p>vector of number of successes and number of failures</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>probs</code></td>
<td>
<p>vector of  probabilities of the beta components of the posterior</p>
</td></tr>
<tr><td><code>betapar</code></td>
<td>
<p>matrix where each row contains the shape parameters for a beta component of the posterior</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>probs=c(.5, .5)
beta.par1=c(15,5)
beta.par2=c(10,10)
betapar=rbind(beta.par1,beta.par2)
data=c(20,15)
binomial.beta.mix(probs,betapar,data)
</code></pre>

<hr>
<h2 id='birdextinct'>Bird measurements from British islands</h2><span id='topic+birdextinct'></span>

<h3>Description</h3>

<p>Measurements on breedings pairs of landbird species were collected from 16
islands about Britain over several decades.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>birdextinct
</code></pre>


<h3>Format</h3>

<p>A data frame with 62 observations on the following 5 variables.
</p>

<dl>
<dt>species</dt><dd><p>name of bird species</p>
</dd>
<dt>time</dt><dd><p>average time of extinction on the islands</p>
</dd>
<dt>nesting</dt><dd><p>average number of nesting pairs</p>
</dd>
<dt>size</dt><dd><p>size of the species, 1 or 0 if large or small</p>
</dd>
<dt>status</dt><dd><p>staus of the species, 1 or 0 if resident or migrant</p>
</dd>
</dl>



<h3>Source</h3>

<p>Pimm, S., Jones, H., and Diamond, J. (1988),
On the risk of extinction,
American Naturalists, 132, 757-785.
</p>

<hr>
<h2 id='birthweight'>Birthweight regression study</h2><span id='topic+birthweight'></span>

<h3>Description</h3>

<p>Dobson describes a study where one is interested in predicting 
a baby's birthweight based on the gestational age and the baby's
gender.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>birthweight
</code></pre>


<h3>Format</h3>

<p>A data frame with 24 observations on the following 3 variables.
</p>

<dl>
<dt>age</dt><dd><p>gestational age in weeks</p>
</dd>
<dt>gender</dt><dd><p>gender of the baby where 0 (1) is male (female)</p>
</dd>
<dt>weight</dt><dd><p>birthweight of baby in grams</p>
</dd>
</dl>



<h3>Source</h3>

<p>Dobson, A. (2001), An Introduction to Generalized Linear Models, New York:
Chapman and Hall.</p>

<hr>
<h2 id='blinreg'>Simulation from Bayesian linear regression model</h2><span id='topic+blinreg'></span>

<h3>Description</h3>

<p>Gives a simulated sample from the joint posterior distribution of the regression
vector and the error standard deviation for a linear regression model with a 
noninformative or g prior.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>blinreg(y,X,m,prior=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="blinreg_+3A_y">y</code></td>
<td>
<p>vector of responses</p>
</td></tr>
<tr><td><code id="blinreg_+3A_x">X</code></td>
<td>
<p>design matrix</p>
</td></tr>
<tr><td><code id="blinreg_+3A_m">m</code></td>
<td>
<p>number of simulations desired</p>
</td></tr>
<tr><td><code id="blinreg_+3A_prior">prior</code></td>
<td>
<p>list with components c0 and beta0 of Zellner's g prior</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>beta</code></td>
<td>
<p>matrix of simulated draws of beta where each row corresponds to one draw</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>vector of simulated draws of the error standard deviation</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>chirps=c(20,16.0,19.8,18.4,17.1,15.5,14.7,17.1,15.4,16.2,15,17.2,16,17,14.1)
temp=c(88.6,71.6,93.3,84.3,80.6,75.2,69.7,82,69.4,83.3,78.6,82.6,80.6,83.5,76.3)
X=cbind(1,chirps)
m=1000
s=blinreg(temp,X,m)
</code></pre>

<hr>
<h2 id='blinregexpected'>Simulates values of expected response for linear regression model</h2><span id='topic+blinregexpected'></span>

<h3>Description</h3>

<p>Simulates draws of the posterior distribution of an expected response for
a linear regression model with a noninformative prior</p>


<h3>Usage</h3>

<pre><code class='language-R'>blinregexpected(X1,theta.sample)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="blinregexpected_+3A_x1">X1</code></td>
<td>
<p>matrix where each row corresponds to a covariate set</p>
</td></tr>
<tr><td><code id="blinregexpected_+3A_theta.sample">theta.sample</code></td>
<td>
<p>list with components beta, matrix of simulated draws of regression vector,
and sigma, vector of simulated draws of sampling error standard deviation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>matrix where a column corresponds to the simulated draws of the expected response for a given
covariate set
</p>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>chirps=c(20,16.0,19.8,18.4,17.1,15.5,14.7,17.1,15.4,16.2,15,17.2,16,17,14.1)
temp=c(88.6,71.6,93.3,84.3,80.6,75.2,69.7,82,69.4,83.3,78.6,82.6,80.6,83.5,76.3)
X=cbind(1,chirps)
m=1000
theta.sample=blinreg(temp,X,m)
covset1=c(1,15)
covset2=c(1,20)
X1=rbind(covset1,covset2)
blinregexpected(X1,theta.sample)
</code></pre>

<hr>
<h2 id='blinregpred'>Simulates values of predicted response for linear regression model</h2><span id='topic+blinregpred'></span>

<h3>Description</h3>

<p>Simulates draws of the predictive distribution of a future response for
a linear regression model with a noninformative prior</p>


<h3>Usage</h3>

<pre><code class='language-R'>blinregpred(X1,theta.sample)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="blinregpred_+3A_x1">X1</code></td>
<td>
<p>matrix where each row corresponds to a covariate set</p>
</td></tr>
<tr><td><code id="blinregpred_+3A_theta.sample">theta.sample</code></td>
<td>
<p>list with components beta, matrix of simulated draws of regression vector,
and sigma, vector of simulated draws of sampling error standard deviation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>matrix where a column corresponds to the simulated draws of the predicted response for a given
covariate set
</p>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>chirps=c(20,16.0,19.8,18.4,17.1,15.5,14.7,17.1,15.4,16.2,15,17.2,16,17,14.1)
temp=c(88.6,71.6,93.3,84.3,80.6,75.2,69.7,82,69.4,83.3,78.6,82.6,80.6,83.5,76.3)
X=cbind(1,chirps)
m=1000
theta.sample=blinreg(temp,X,m)
covset1=c(1,15)
covset2=c(1,20)
X1=rbind(covset1,covset2)
blinregpred(X1,theta.sample)
</code></pre>

<hr>
<h2 id='bprobit.probs'>Simulates fitted probabilities for a probit regression model</h2><span id='topic+bprobit.probs'></span>

<h3>Description</h3>

<p>Gives a simulated sample for fitted probabilities for a binary response
regression model with a probit link and noninformative prior.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bprobit.probs(X1,fit)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bprobit.probs_+3A_x1">X1</code></td>
<td>
<p>matrix where each row corresponds to a covariate set</p>
</td></tr>
<tr><td><code id="bprobit.probs_+3A_fit">fit</code></td>
<td>
<p>simulated matrix of draws of the regression vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>matrix of simulated draws of the fitted probabilities, where a column corresponds to a
particular covariate set
</p>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>response=c(0,1,0,0,0,1,1,1,1,1)
covariate=c(1,2,3,4,5,6,7,8,9,10)
X=cbind(1,covariate)
m=1000
fit=bayes.probit(response,X,m)
x1=c(1,3)
x2=c(1,8)
X1=rbind(x1,x2)
fittedprobs=bprobit.probs(X1,fit$beta)
</code></pre>

<hr>
<h2 id='bradley.terry.post'>Log posterior of a Bradley Terry random effects model</h2><span id='topic+bradley.terry.post'></span>

<h3>Description</h3>

<p>Computes the log posterior density of the talent parameters and the log 
standard deviation for a Bradley Terry model with normal
random effects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bradley.terry.post(theta,data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bradley.terry.post_+3A_theta">theta</code></td>
<td>
<p>vector of talent parameters and log standard deviation</p>
</td></tr>
<tr><td><code id="bradley.terry.post_+3A_data">data</code></td>
<td>
<p>data matrix with columns team1, team2, wins by team1, and
wins by team2</p>
</td></tr>
</table>


<h3>Value</h3>

<p>value of the log posterior</p>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(baseball.1964)
team.strengths=rep(0,10)
log.sigma=0
bradley.terry.post(c(team.strengths,log.sigma),baseball.1964)
</code></pre>

<hr>
<h2 id='breastcancer'>Survival experience of women with breast cancer under treatment</h2><span id='topic+breastcancer'></span>

<h3>Description</h3>

<p>Collett (1994) describes a study to evaluate the effectiveness of a
histochemical marker in predicting the survival experience of women with
breast cancer.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>breastcancer
</code></pre>


<h3>Format</h3>

<p>A data frame with 45 observations on the following 3 variables.
</p>

<dl>
<dt>time</dt><dd><p>survival time in months</p>
</dd>
<dt>status</dt><dd><p>censoring indicator where 1 (0) indicates a complete (censored) survival time</p>
</dd>
<dt>stain</dt><dd><p>indicates by a 0 (1) if tumor was negatively (positively) stained</p>
</dd>
</dl>



<h3>Source</h3>

<p>Collett, D. (1994), Modelling Survival Data in Medical Research, London:
Chapman and Hall.</p>

<hr>
<h2 id='calculus.grades'>Calculus grades dataset</h2><span id='topic+calculus.grades'></span>

<h3>Description</h3>

<p>Grades and other variables collected for a 
sample of calculus students.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculus.grades
</code></pre>


<h3>Format</h3>

<p>A data frame with 100 observations on the following 3 variables.
</p>

<dl>
<dt>grade</dt><dd><p>indicates if student received a A or B in class</p>
</dd>
<dt>prev.grade</dt><dd><p>indicates if student received a A in prerequisite math class</p>
</dd>
<dt>act</dt><dd><p>score on the ACT math test</p>
</dd>
</dl>



<h3>Source</h3>

<p>Collected by a colleague of the author at his university.</p>

<hr>
<h2 id='cancermortality'>Cancer mortality data</h2><span id='topic+cancermortality'></span>

<h3>Description</h3>

<p>Number of cancer deaths and number at risk for 20 cities in Missouri.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cancermortality
</code></pre>


<h3>Format</h3>

<p>A data frame with 20 observations on the following 2 variables.
</p>

<dl>
<dt>y</dt><dd><p>number of cancer deaths</p>
</dd>
<dt>n</dt><dd><p>number at risk</p>
</dd>
</dl>



<h3>Source</h3>

<p>Tsutakawa, R., Shoop, G., and Marienfeld, C. (1985),
Empirical Bayes Estimation
of Cancer Mortality Rates, Statistics in Medicine, 4, 201-212.
</p>

<hr>
<h2 id='careertraj.setup'>Setup for Career Trajectory Application</h2><span id='topic+careertraj.setup'></span>

<h3>Description</h3>

<p>Setups the data matrices for the use of WinBUGS
in the career trajectory application. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>careertraj.setup(data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="careertraj.setup_+3A_data">data</code></td>
<td>
<p>data matrix for ballplayers with variables Player, Year, Age, G, AB, R, H, X2B, X3B, HR, RBI, BB, SO</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>player.names</code></td>
<td>
<p>vector of player names</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>matrix of home runs for players where a row corresponds to the home runs for a player during
all the years of his career</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>matrix of AB-SO for all players</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>matrix of ages for all players for all years of their careers</p>
</td></tr>
<tr><td><code>T</code></td>
<td>
<p>vector of number of seasons for all players</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>number of players</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sluggerdata)
careertraj.setup(sluggerdata)
</code></pre>

<hr>
<h2 id='cauchyerrorpost'>Log posterior of median and log scale parameters for Cauchy sampling</h2><span id='topic+cauchyerrorpost'></span>

<h3>Description</h3>

<p>Computes the log posterior density of (M,log S)  when
a sample is taken from a Cauchy density with location M and scale S and a uniform
prior distribution is taken on (M, log S)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cauchyerrorpost(theta,data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cauchyerrorpost_+3A_theta">theta</code></td>
<td>
<p>vector of parameter values of M and log S</p>
</td></tr>
<tr><td><code id="cauchyerrorpost_+3A_data">data</code></td>
<td>
<p>vector containing sample of observations</p>
</td></tr>
</table>


<h3>Value</h3>

<p>value of the log posterior
</p>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>data=c(108, 51, 7, 43, 52, 54, 53, 49, 21, 48)
theta=c(40,1)
cauchyerrorpost(theta,data)
</code></pre>

<hr>
<h2 id='chemotherapy'>Chemotherapy treatment effects on ovarian cancer</h2><span id='topic+chemotherapy'></span>

<h3>Description</h3>

<p>Edmunson et al (1979) studied the effect of different chemotherapy
treatments following surgical treatment of ovarian cancer.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chemotherapy
</code></pre>


<h3>Format</h3>

<p>A data frame with 26 observations on the following 5 variables.
</p>

<dl>
<dt>patient</dt><dd><p>patient number</p>
</dd>
<dt>time</dt><dd><p>survival time in days following treatment</p>
</dd>
<dt>status</dt><dd><p>indicates if time is censored (0) or actually observed (1)</p>
</dd>
<dt>treat</dt><dd><p>control group (0) or treatment group (1)</p>
</dd>
<dt>age</dt><dd><p>age of the patient</p>
</dd>
</dl>



<h3>Source</h3>

<p>Edmonson, J., Felming, T., Decker, D., Malkasian, G., Jorgensen, E.,
Jefferies,
J.,Webb, M., and Kvols, L. (1979), Different chemotherapeutic sensitivities
and host factors affecting prognosis in advanced ovarian carcinoma versus
minimal residual disease, Cancer Treatment Reports, 63, 241-247.
</p>

<hr>
<h2 id='ctable'>Bayes factor against independence using uniform priors</h2><span id='topic+ctable'></span>

<h3>Description</h3>

<p>Computes a Bayes factor against independence for a two-way contingency table assuming
uniform prior distributions</p>


<h3>Usage</h3>

<pre><code class='language-R'>ctable(y,a)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ctable_+3A_y">y</code></td>
<td>
<p>matrix of counts</p>
</td></tr>
<tr><td><code id="ctable_+3A_a">a</code></td>
<td>
<p>matrix of prior hyperparameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>value of the Bayes factor against independence
</p>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>y=matrix(c(10,4,6,3,6,10),c(2,3))
a=matrix(rep(1,6),c(2,3))
ctable(y,a)
</code></pre>

<hr>
<h2 id='darwin'>Darwin's data on plants</h2><span id='topic+darwin'></span>

<h3>Description</h3>

<p>Fifteen differences of the heights of cross and self fertilized plants quoted by
Fisher (1960)</p>


<h3>Usage</h3>

<pre><code class='language-R'>darwin
</code></pre>


<h3>Format</h3>

<p>A data frame with 15 observations on the following 1 variable.
</p>

<dl>
<dt>difference</dt><dd><p>difference of heights of two types of plants</p>
</dd>
</dl>



<h3>Source</h3>

<p>Fisher, R. (1960), Statistical Methods for Research Workers,
Edinburgh: Oliver and Boyd.</p>

<hr>
<h2 id='discint'>Highest probability interval for a discrete distribution</h2><span id='topic+discint'></span>

<h3>Description</h3>

<p>Computes a highest probability interval for a discrete probability
distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>discint(dist, prob)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="discint_+3A_dist">dist</code></td>
<td>
<p>probability distribution written as a matrix where
the first column contain the values and the second column 
the probabilities</p>
</td></tr>
<tr><td><code id="discint_+3A_prob">prob</code></td>
<td>
<p>probability content of interest</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>prob</code></td>
<td>
<p>exact probability content of interval</p>
</td></tr>
<tr><td><code>set</code></td>
<td>
<p>set of values of the probability interval</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>x=0:10
probs=dbinom(x,size=10,prob=.3)
dist=cbind(x,probs)
pcontent=.8
discint(dist,pcontent)
</code></pre>

<hr>
<h2 id='discrete.bayes'>Posterior distribution with discrete priors</h2><span id='topic+discrete.bayes'></span><span id='topic+print.bayes'></span><span id='topic+plot.bayes'></span><span id='topic+summary.bayes'></span>

<h3>Description</h3>

<p>Computes the posterior distribution for an arbitrary one parameter distribution
for a discrete prior
distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>discrete.bayes(df,prior,y,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="discrete.bayes_+3A_df">df</code></td>
<td>
<p>name of the function defining the sampling density</p>
</td></tr>
<tr><td><code id="discrete.bayes_+3A_prior">prior</code></td>
<td>
<p>vector defining the prior density; names of the vector
define the parameter values and entries of the vector define 
the prior probabilities</p>
</td></tr>
<tr><td><code id="discrete.bayes_+3A_y">y</code></td>
<td>
<p>vector of data values</p>
</td></tr>
<tr><td><code id="discrete.bayes_+3A_...">...</code></td>
<td>
<p>any further fixed parameter values used in the sampling density
function</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>prob</code></td>
<td>
<p>vector of posterior probabilities</p>
</td></tr>
<tr><td><code>pred</code></td>
<td>
<p>scalar with prior predictive probability</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>prior=c(.25,.25,.25,.25)
names(prior)=c(.2,.25,.3,.35)
y=5
n=10
discrete.bayes(dbinom,prior,y,size=n)
</code></pre>

<hr>
<h2 id='discrete.bayes.2'>Posterior distribution of two parameters with discrete priors</h2><span id='topic+discrete.bayes.2'></span><span id='topic+plot.bayes2'></span>

<h3>Description</h3>

<p>Computes the posterior distribution for an arbitrary two parameter distribution
for a discrete prior
distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>discrete.bayes.2(df,prior,y=NULL,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="discrete.bayes.2_+3A_df">df</code></td>
<td>
<p>name of the function defining the sampling density of
two parameters</p>
</td></tr>
<tr><td><code id="discrete.bayes.2_+3A_prior">prior</code></td>
<td>
<p>matrix defining the prior density; the row names and column names
of the matrix define respectively the values of parameter 1 and values of
parameter 2 and the entries of the matrix give the prior probabilities</p>
</td></tr>
<tr><td><code id="discrete.bayes.2_+3A_y">y</code></td>
<td>
<p>y is a matrix of data values, where each row corresponds to a 
single observation</p>
</td></tr>
<tr><td><code id="discrete.bayes.2_+3A_...">...</code></td>
<td>
<p>any further fixed parameter values 
used in the sampling density function</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>prob</code></td>
<td>
<p>matrix of posterior probabilities</p>
</td></tr>
<tr><td><code>pred</code></td>
<td>
<p>scalar with prior predictive probability</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>p1 = seq(0.1, 0.9, length = 9)
p2 = p1
prior = matrix(1/81, 9, 9)
dimnames(prior)[[1]] = p1
dimnames(prior)[[2]] = p2
discrete.bayes.2(twoproplike,prior)
</code></pre>

<hr>
<h2 id='dmnorm'>The probability density function for the multivariate normal (Gaussian) probability distribution </h2><span id='topic+dmnorm'></span>

<h3>Description</h3>

<p>Computes the density of a multivariate normal distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dmnorm(x, mean = rep(0, d), varcov, log = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dmnorm_+3A_x">x</code></td>
<td>
<p>vector of length d or matrix with d columns, giving the coordinates of points where density is to evaluated</p>
</td></tr>
<tr><td><code id="dmnorm_+3A_mean">mean</code></td>
<td>
<p>numeric vector giving the location parameter of the distribution</p>
</td></tr>
<tr><td><code id="dmnorm_+3A_varcov">varcov</code></td>
<td>
<p>a positive definite matrix representing the scale matrix of the distribution</p>
</td></tr>
<tr><td><code id="dmnorm_+3A_log">log</code></td>
<td>
<p>a logical value; if TRUE, the logarithm of the density is to be computed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector of density values
</p>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>mu &lt;- c(1,12,2)
Sigma &lt;- matrix(c(1,2,0,2,5,0.5,0,0.5,3), 3, 3)
x &lt;- c(2,14,0)
f &lt;- dmnorm(x, mu, Sigma)
</code></pre>

<hr>
<h2 id='dmt'>Probability density function for multivariate t</h2><span id='topic+dmt'></span>

<h3>Description</h3>

<p>Computes the density of a multivariate t distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dmt(x, mean = rep(0, d), S, df = Inf, log=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dmt_+3A_x">x</code></td>
<td>
<p>vector of length d or matrix with d columns, giving the coordinates of points where density is to evaluated</p>
</td></tr>
<tr><td><code id="dmt_+3A_mean">mean</code></td>
<td>
<p>numeric vector giving the location parameter of the distribution</p>
</td></tr>
<tr><td><code id="dmt_+3A_s">S</code></td>
<td>
<p>a positive definite matrix representing the scale matrix of the distribution</p>
</td></tr>
<tr><td><code id="dmt_+3A_df">df</code></td>
<td>
<p>degrees of freedom</p>
</td></tr>
<tr><td><code id="dmt_+3A_log">log</code></td>
<td>
<p>a logical value; if TRUE, the logarithm of the density is to be computed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector of density values
</p>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>mu &lt;- c(1,12,2)
Sigma &lt;- matrix(c(1,2,0,2,5,0.5,0,0.5,3), 3, 3)
df &lt;- 4
x &lt;- c(2,14,0)
f &lt;- dmt(x, mu, Sigma, df)
</code></pre>

<hr>
<h2 id='donner'>Donner survival study</h2><span id='topic+donner'></span>

<h3>Description</h3>

<p>Data contains the age, gender and survival status for 45 members of the Donner Party
who experienced difficulties in crossing the Sierra Nevada mountains in California.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>donner
</code></pre>


<h3>Format</h3>

<p>A data frame with 45 observations on the following 3 variables.
</p>

<dl>
<dt>age</dt><dd><p>age of person</p>
</dd>
<dt>male</dt><dd><p>gender that is 1 (0) if person is male (female)</p>
</dd>
<dt>survival</dt><dd><p>survival status, 1 or 0 if person survived or died</p>
</dd>
</dl>



<h3>Source</h3>

<p>Grayson, D. (1960), Donner party deaths:  a demographic
assessment, Journal of Anthropological Assessment, 46, 223-242.</p>

<hr>
<h2 id='election'>Florida election data</h2><span id='topic+election'></span>

<h3>Description</h3>

<p>For each of the Florida counties in the 2000 presidential election, the number of
votes for George Bush, Al Gore, and Pat Buchanan is recorded.  Also the number of
votes for the minority candidate Ross Perot in the 1996 presidential election is
recorded.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>election
</code></pre>


<h3>Format</h3>

<p>A data frame with 67 observations on the following 5 variables.
</p>

<dl>
<dt>county</dt><dd><p>name of Florida county</p>
</dd>
<dt>perot</dt><dd><p>number of votes for Ross Perot in 1996 election</p>
</dd>
<dt>gore</dt><dd><p>number of votes for Al Gore in 2000 election</p>
</dd>
<dt>bush</dt><dd><p>number of votes for George Bush in 2000 election</p>
</dd>
<dt>buchanan</dt><dd><p>number of votes for Pat Buchanan in 2000 election</p>
</dd>
</dl>


<hr>
<h2 id='election.2008'>Poll data from 2008 U.S. Presidential Election</h2><span id='topic+election.2008'></span>

<h3>Description</h3>

<p>Results of recent state polls in the 2008 United States Presidential
Election between Barack Obama and John McCain.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>election.2008
</code></pre>


<h3>Format</h3>

<p>A data frame with 51 observations on the following 4 variables.
</p>

<dl>
<dt>State</dt><dd><p>name of the state</p>
</dd>
<dt>M.pct</dt><dd><p>percentage of poll survey for McCain</p>
</dd>
<dt>O.pct</dt><dd><p>precentage of poll survey for Obama</p>
</dd>
<dt>EV</dt><dd><p>number of electoral votes</p>
</dd>
</dl>



<h3>Source</h3>

<p>Data collected by author in November 2008 from www.cnn.com website.</p>

<hr>
<h2 id='footballscores'>Game outcomes and point spreads for American football</h2><span id='topic+footballscores'></span>

<h3>Description</h3>

<p>Game outcomes and point spreads for 672 professional
American football games.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>footballscores
</code></pre>


<h3>Format</h3>

<p>A data frame with 672 observations on the following 8 variables.
</p>

<dl>
<dt>year</dt><dd><p>year of game</p>
</dd>
<dt>home</dt><dd><p>indicates if favorite is the home team</p>
</dd>
<dt>favorite</dt><dd><p>score of favorite team</p>
</dd>
<dt>underdog</dt><dd><p>score of underdog team</p>
</dd>
<dt>spread</dt><dd><p>point spread</p>
</dd>
<dt>favorite.name</dt><dd><p>name of favorite team</p>
</dd>
<dt>underdog.name</dt><dd><p>name of underdog team</p>
</dd>
<dt>week</dt><dd><p>week number of the season</p>
</dd>
</dl>



<h3>Source</h3>

<p>Gelman, A., Carlin, J., Stern, H., and Rubin, D. (2003),
Bayesian Data Analysis, Chapman and Hall.</p>

<hr>
<h2 id='gibbs'>Metropolis within Gibbs sampling algorithm of a posterior distribution</h2><span id='topic+gibbs'></span>

<h3>Description</h3>

<p>Implements a Metropolis-within-Gibbs sampling algorithm for an arbitrary real-valued
posterior density defined by the user
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gibbs(logpost,start,m,scale,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gibbs_+3A_logpost">logpost</code></td>
<td>
<p>function defining the log posterior density</p>
</td></tr>
<tr><td><code id="gibbs_+3A_start">start</code></td>
<td>
<p>array with a single row that gives the starting value of the parameter vector</p>
</td></tr>
<tr><td><code id="gibbs_+3A_m">m</code></td>
<td>
<p>the number of iterations of the chain</p>
</td></tr>
<tr><td><code id="gibbs_+3A_scale">scale</code></td>
<td>
<p>vector of scale parameters for the random walk Metropolis steps</p>
</td></tr>
<tr><td><code id="gibbs_+3A_...">...</code></td>
<td>
<p>data that is used in the function logpost</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>par</code></td>
<td>
<p>a matrix of simulated values where each row corresponds to a value of the vector parameter</p>
</td></tr>
<tr><td><code>accept</code></td>
<td>
<p>vector of acceptance rates of the Metropolis steps of the algorithm</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>data=c(6,2,3,10)
start=array(c(1,1),c(1,2))
m=1000
scale=c(2,2)
s=gibbs(logctablepost,start,m,scale,data)
</code></pre>

<hr>
<h2 id='groupeddatapost'>Log posterior of normal parameters when data is in grouped form</h2><span id='topic+groupeddatapost'></span>

<h3>Description</h3>

<p>Computes the log posterior density of (M,log S) for normal sampling where the data is
observed in grouped form
</p>


<h3>Usage</h3>

<pre><code class='language-R'>groupeddatapost(theta,data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="groupeddatapost_+3A_theta">theta</code></td>
<td>
<p>vector of parameter values M and log S</p>
</td></tr>
<tr><td><code id="groupeddatapost_+3A_data">data</code></td>
<td>
<p>list with components int.lo, a vector of left endpoints,
int.hi, a vector of right endpoints, and f, a vector of bin frequencies</p>
</td></tr>
</table>


<h3>Value</h3>

<p>value of the log posterior
</p>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>int.lo=c(-Inf,10,15,20,25)
int.hi=c(10,15,20,25,Inf)
f=c(2,5,8,4,2)
data=list(int.lo=int.lo,int.hi=int.hi,f=f)
theta=c(20,1)
groupeddatapost(theta,data)
</code></pre>

<hr>
<h2 id='hearttransplants'>Heart transplant mortality data</h2><span id='topic+hearttransplants'></span>

<h3>Description</h3>

<p>The number of deaths within 30 days of heart transplant surgery for 94 U.S. hospitals
that performed at least 10 heart transplant surgeries.  Also the exposure, the expected number of deaths, is 
recorded for each hospital.</p>


<h3>Usage</h3>

<pre><code class='language-R'>hearttransplants
</code></pre>


<h3>Format</h3>

<p>A data frame with 94 observations on the following 2 variables.
</p>

<dl>
<dt>e</dt><dd><p>expected number of deaths (the exposure)</p>
</dd>
<dt>y</dt><dd><p>observed number of deaths within 30 days of heart transplant surgery</p>
</dd>
</dl>



<h3>Source</h3>

<p>Christiansen, C. and Morris, C. (1995), Fitting and checking
a two-level Poisson model:  modeling patient mortality rates in heart
transplant patients, in Berry, D. and Stangl, D., eds, Bayesian
Biostatistics, Marcel Dekker.</p>

<hr>
<h2 id='hiergibbs'>Gibbs sampling for a hierarchical regression model</h2><span id='topic+hiergibbs'></span>

<h3>Description</h3>

<p>Implements Gibbs sampling for estimating a two-way table of means
under a hierarchical regression model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hiergibbs(data,m)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hiergibbs_+3A_data">data</code></td>
<td>
<p>data matrix with columns observed sample means, sample sizes, and values of two covariates</p>
</td></tr>
<tr><td><code id="hiergibbs_+3A_m">m</code></td>
<td>
<p>number of cycles of Gibbs sampling</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>beta</code></td>
<td>
<p>matrix of simulated values of regression vector</p>
</td></tr>
<tr><td><code>mu</code></td>
<td>
<p>matrix of simulated values of cell means</p>
</td></tr>
<tr><td><code>var</code></td>
<td>
<p>vector of simulated values of second-stage prior variance</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(iowagpa)
m=1000
s=hiergibbs(iowagpa,m)
</code></pre>

<hr>
<h2 id='histprior'>Density function of a histogram distribution</h2><span id='topic+histprior'></span>

<h3>Description</h3>

<p>Computes the density of a probability distribution defined on a set
of equal-width intervals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>histprior(p,midpts,prob)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="histprior_+3A_p">p</code></td>
<td>
<p>vector of values for which density is to be computed</p>
</td></tr>
<tr><td><code id="histprior_+3A_midpts">midpts</code></td>
<td>
<p>vector of midpoints of the intervals</p>
</td></tr>
<tr><td><code id="histprior_+3A_prob">prob</code></td>
<td>
<p>vector of probabilities of the intervals</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector of values of the probability density
</p>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>midpts=c(.1,.3,.5,.7,.9)
prob=c(.2,.2,.4,.1,.1)
p=seq(.01,.99,by=.01)
plot(p,histprior(p,midpts,prob),type="l")
</code></pre>

<hr>
<h2 id='howardprior'>Logarithm of Howard's dependent prior for two proportions</h2><span id='topic+howardprior'></span>

<h3>Description</h3>

<p>Computes the logarithm of a dependent prior on two proportions
proposed by Howard in a Statistical Science paper in 1998.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>howardprior(xy,par)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="howardprior_+3A_xy">xy</code></td>
<td>
<p>vector of proportions p1 and p2</p>
</td></tr>
<tr><td><code id="howardprior_+3A_par">par</code></td>
<td>
<p>vector containing parameter values alpha, beta, gamma, delta, sigma</p>
</td></tr>
</table>


<h3>Value</h3>

<p>value of the log posterior
</p>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>param=c(1,1,1,1,2)
p=c(.1,.5)
howardprior(p,param)
</code></pre>

<hr>
<h2 id='impsampling'>Importance sampling using a t proposal density</h2><span id='topic+impsampling'></span>

<h3>Description</h3>

<p>Implements importance sampling to compute the posterior mean of a function
using a multivariate t proposal density 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>impsampling(logf,tpar,h,n,data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="impsampling_+3A_logf">logf</code></td>
<td>
<p>function that defines the logarithm of the density of interest</p>
</td></tr>
<tr><td><code id="impsampling_+3A_tpar">tpar</code></td>
<td>
<p>list of parameters of t proposal density including the mean m, scale matrix var, 
and degrees of freedom df</p>
</td></tr> 
<tr><td><code id="impsampling_+3A_h">h</code></td>
<td>
<p>function that defines h(theta)</p>
</td></tr>
<tr><td><code id="impsampling_+3A_n">n</code></td>
<td>
<p>number of simulated draws from proposal density</p>
</td></tr>
<tr><td><code id="impsampling_+3A_data">data</code></td>
<td>
<p>data and or parameters used in the function logf</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>est</code></td>
<td>
<p>estimate at the posterior mean</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p>simulation standard error of estimate</p>
</td></tr>
<tr><td><code>theta</code></td>
<td>
<p>matrix of simulated draws from proposal density</p>
</td></tr>
<tr><td><code>wt</code></td>
<td>
<p>vector of importance sampling weights</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(cancermortality)
start=c(-7,6)
fit=laplace(betabinexch,start,cancermortality)
tpar=list(m=fit$mode,var=2*fit$var,df=4)
myfunc=function(theta) return(theta[2])
theta=impsampling(betabinexch,tpar,myfunc,1000,cancermortality)
</code></pre>

<hr>
<h2 id='indepmetrop'>Independence Metropolis independence chain of a posterior distribution</h2><span id='topic+indepmetrop'></span>

<h3>Description</h3>

<p>Simulates iterates of an independence Metropolis chain with a normal proposal density for an arbitrary real-valued
posterior density defined by the user</p>


<h3>Usage</h3>

<pre><code class='language-R'>indepmetrop(logpost,proposal,start,m,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="indepmetrop_+3A_logpost">logpost</code></td>
<td>
<p>function defining the log posterior density</p>
</td></tr>
<tr><td><code id="indepmetrop_+3A_proposal">proposal</code></td>
<td>
<p>a list containing mu, an estimated mean and var, an estimated variance-covariance matrix, of the normal proposal density</p>
</td></tr> 
<tr><td><code id="indepmetrop_+3A_start">start</code></td>
<td>
<p>vector containing the starting value of the parameter</p>
</td></tr>
<tr><td><code id="indepmetrop_+3A_m">m</code></td>
<td>
<p>the number of iterations of the chain</p>
</td></tr>
<tr><td><code id="indepmetrop_+3A_...">...</code></td>
<td>
<p>data that is used in the function logpost</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>par</code></td>
<td>
<p>a matrix of simulated values where each row corresponds to a value of the vector parameter</p>
</td></tr>
<tr><td><code>accept</code></td>
<td>
<p>the acceptance rate of the algorithm</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>data=c(6,2,3,10)
proposal=list(mu=array(c(2.3,-.1),c(2,1)),var=diag(c(1,1)))
start=array(c(0,0),c(1,2))
m=1000
fit=indepmetrop(logctablepost,proposal,start,m,data)
</code></pre>

<hr>
<h2 id='iowagpa'>Admissions data for an university</h2><span id='topic+iowagpa'></span>

<h3>Description</h3>

<p>Students at a major university are categorized with respect to their
high school rank and their ACT score.  For each combination of high school rank and
ACT score, one records the mean grade point average (GPA).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>iowagpa
</code></pre>


<h3>Format</h3>

<p>A data frame with 40 observations on the following 4 variables.
</p>

<dl>
<dt>gpa</dt><dd><p>mean grade point average</p>
</dd>
<dt>n</dt><dd><p>sample size</p>
</dd>
<dt>HSR</dt><dd><p>high school rank</p>
</dd>
<dt>ACT</dt><dd><p>act score</p>
</dd>
</dl>



<h3>Source</h3>

<p>Albert, J. (1994), A Bayesian approach to estimation of GPA's
of University of Iowa freshmen under order restrictions,
Journal of Educational Statistics, 19, 1-22.</p>

<hr>
<h2 id='jeter2004'>Hitting data for Derek Jeter</h2><span id='topic+jeter2004'></span>

<h3>Description</h3>

<p>Batting data for the baseball player Derek Jeter for all 154 games in the 2004 season.</p>


<h3>Usage</h3>

<pre><code class='language-R'>jeter2004
</code></pre>


<h3>Format</h3>

<p>A data frame with 154 observations on the following 10 variables.
</p>

<dl>
<dt>Game</dt><dd><p>the game number</p>
</dd>
<dt>AB</dt><dd><p>the number of at-bats</p>
</dd>
<dt>R</dt><dd><p>the number of runs scored</p>
</dd>
<dt>H</dt><dd><p>the number of hits</p>
</dd>
<dt>X2B</dt><dd><p>the number of doubles</p>
</dd>
<dt>X3B</dt><dd><p>the number of triples</p>
</dd>
<dt>HR</dt><dd><p>the number of home runs</p>
</dd>
<dt>RBI</dt><dd><p>the number of runs batted in</p>
</dd>
<dt>BB</dt><dd><p>the number of walks</p>
</dd>
<dt>SO</dt><dd><p>the number of strikeouts</p>
</dd>
</dl>



<h3>Source</h3>

<p>Collected from game log data from www.retrosheet.org.</p>

<hr>
<h2 id='laplace'>Summarization of a posterior density by the Laplace method</h2><span id='topic+laplace'></span>

<h3>Description</h3>

<p>For a general posterior density, computes the posterior mode, 
the associated variance-covariance matrix, and an estimate at the
logarithm at the normalizing constant.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>laplace(logpost,mode,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="laplace_+3A_logpost">logpost</code></td>
<td>
<p>function that defines the logarithm of the posterior density</p>
</td></tr>
<tr><td><code id="laplace_+3A_mode">mode</code></td>
<td>
<p>vector that is a guess at the posterior mode</p>
</td></tr>
<tr><td><code id="laplace_+3A_...">...</code></td>
<td>
<p>vector or list of parameters associated with the function logpost</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>mode</code></td>
<td>
<p>current estimate at the posterior mode</p>
</td></tr>
<tr><td><code>var</code></td>
<td>
<p>current estimate at the associated variance-covariance matrix</p>
</td></tr>
<tr><td><code>int</code></td>
<td>
<p>estimate at the logarithm of the normalizing constant</p>
</td></tr>
<tr><td><code>converge</code></td>
<td>
<p>indication (TRUE or FALSE) if the algorithm converged</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>logpost=function(theta,data)
{
s=5
sum(-log(1+(data-theta)^2/s^2))
}
data=c(10,12,14,13,12,15)
start=10
laplace(logpost,start,data)
</code></pre>

<hr>
<h2 id='lbinorm'>Logarithm of bivariate normal density</h2><span id='topic+lbinorm'></span>

<h3>Description</h3>

<p>Computes the logarithm of a bivariate normal density
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lbinorm(xy,par)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lbinorm_+3A_xy">xy</code></td>
<td>
<p>vector of values of two variables x and y</p>
</td></tr>
<tr><td><code id="lbinorm_+3A_par">par</code></td>
<td>
<p>list with components m, a vector of means, and v, a variance-covariance matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>value of the kernel of the log density
</p>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>mean=c(0,0)
varcov=diag(c(1,1))
value=c(1,1)
param=list(m=mean,v=varcov)
lbinorm(value,param)
</code></pre>

<hr>
<h2 id='logctablepost'>Log posterior of difference and sum of logits in a 2x2 table</h2><span id='topic+logctablepost'></span>

<h3>Description</h3>

<p>Computes the log posterior density for the difference and sum of logits
in a 2x2 contingency table for independent binomial samples and uniform
prior placed on the logits
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logctablepost(theta,data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logctablepost_+3A_theta">theta</code></td>
<td>
<p>vector of parameter values &quot;difference of logits&quot; and &quot;sum of logits&quot;)</p>
</td></tr>
<tr><td><code id="logctablepost_+3A_data">data</code></td>
<td>
<p>vector containing number of successes and failures for first sample, and then second sample</p>
</td></tr>
</table>


<h3>Value</h3>

<p>value of the log posterior
</p>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>s1=6; f1=2; s2=3; f2=10
data=c(s1,f1,s2,f2)
theta=c(2,4)
logctablepost(theta,data)
</code></pre>

<hr>
<h2 id='logisticpost'>Log posterior for a binary response model with a logistic link and a uniform prior</h2><span id='topic+logisticpost'></span>

<h3>Description</h3>

<p>Computes the log posterior density of (beta0, beta1)  when
yi are independent binomial(ni, pi) and logit(pi)=beta0+beta1*xi and
a uniform prior is placed on (beta0, beta1)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logisticpost(beta,data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logisticpost_+3A_beta">beta</code></td>
<td>
<p>vector of parameter values beta0 and beta1</p>
</td></tr>
<tr><td><code id="logisticpost_+3A_data">data</code></td>
<td>
<p>matrix of columns of covariate values x, sample sizes n, and number of successes y</p>
</td></tr>
</table>


<h3>Value</h3>

<p>value of the log posterior
</p>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>x = c(-0.86,-0.3,-0.05,0.73)
n = c(5,5,5,5)
y = c(0,1,3,5)
data = cbind(x, n, y)
beta=c(2,10)
logisticpost(beta,data)
</code></pre>

<hr>
<h2 id='logpoissgamma'>Log posterior with Poisson sampling and gamma prior</h2><span id='topic+logpoissgamma'></span>

<h3>Description</h3>

<p>Computes the logarithm of the posterior density of a Poisson log mean
with a gamma prior
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logpoissgamma(theta,datapar)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logpoissgamma_+3A_theta">theta</code></td>
<td>
<p>vector of values of the log mean parameter</p>
</td></tr>
<tr><td><code id="logpoissgamma_+3A_datapar">datapar</code></td>
<td>
<p>list with components data, vector of observations, and par, vector of
parameters of the gamma prior</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector of values of the log posterior for all values in theta
</p>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>data=c(2,4,3,6,1,0,4,3,10,2)
par=c(1,1)
datapar=list(data=data,par=par)
theta=c(-1,0,1,2)
logpoissgamma(theta,datapar)
</code></pre>

<hr>
<h2 id='logpoissnormal'>Log  posterior with Poisson sampling and normal prior</h2><span id='topic+logpoissnormal'></span>

<h3>Description</h3>

<p>Computes the logarithm of the posterior density of a Poisson log mean
with a normal prior
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logpoissnormal(theta,datapar)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logpoissnormal_+3A_theta">theta</code></td>
<td>
<p>vector of values of the log mean parameter</p>
</td></tr>
<tr><td><code id="logpoissnormal_+3A_datapar">datapar</code></td>
<td>
<p>list with components data, vector of observations, and par, vector of
parameters of the normal prior</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector of values of the log posterior for all values in theta
</p>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>data=c(2,4,3,6,1,0,4,3,10,2)
par=c(0,1)
datapar=list(data=data,par=par)
theta=c(-1,0,1,2)
logpoissnormal(theta,datapar)
</code></pre>

<hr>
<h2 id='marathontimes'>Marathon running times</h2><span id='topic+marathontimes'></span>

<h3>Description</h3>

<p>Running times in minutes for twenty male runners between the ages 20 and 29
who ran the New York Marathon.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>marathontimes
</code></pre>


<h3>Format</h3>

<p>A data frame with 20 observations on the following 1 variable.
</p>

<dl>
<dt>time</dt><dd><p>running time</p>
</dd>
</dl>



<h3>Source</h3>

<p>www.nycmarathon.org website.</p>

<hr>
<h2 id='mnormt.onesided'>Bayesian test of one-sided hypothesis about a normal mean</h2><span id='topic+mnormt.onesided'></span>

<h3>Description</h3>

<p>Computes a Bayesian test of the hypothesis that a normal mean is 
less than or equal to a specified value</p>


<h3>Usage</h3>

<pre><code class='language-R'>mnormt.onesided(m0,normpar,data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mnormt.onesided_+3A_m0">m0</code></td>
<td>
<p>value of the normal mean to be tested</p>
</td></tr>
<tr><td><code id="mnormt.onesided_+3A_normpar">normpar</code></td>
<td>
<p>vector of mean and standard deviation of the normal prior distribution</p>
</td></tr>
<tr><td><code id="mnormt.onesided_+3A_data">data</code></td>
<td>
<p>vector of sample mean, sample size, and known value of the population standard deviation</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>BF</code></td>
<td>
<p>Bayes factor in support of the null hypothesis</p>
</td></tr>
<tr><td><code>prior.odds</code></td>
<td>
<p>prior odds of the null hypothesis</p>
</td></tr>
<tr><td><code>post.odds</code></td>
<td>
<p>posterior odds of the null hypothesis</p>
</td></tr>
<tr><td><code>postH</code></td>
<td>
<p>posterior probability of the null hypothesis</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>y=c(182,172,173,176,176,180,173,174,179,175)
pop.s=3
data=c(mean(y),length(data),pop.s)
m0=175
normpar=c(170,1000)
mnormt.onesided(m0,normpar,data)
</code></pre>

<hr>
<h2 id='mnormt.twosided'>Bayesian test of a two-sided hypothesis about a normal mean</h2><span id='topic+mnormt.twosided'></span>

<h3>Description</h3>

<p>Bayesian test that a normal mean is equal to a specified
value using a normal prior</p>


<h3>Usage</h3>

<pre><code class='language-R'>mnormt.twosided(m0, prob, t, data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mnormt.twosided_+3A_m0">m0</code></td>
<td>
<p>value of the mean to be tested </p>
</td></tr>
<tr><td><code id="mnormt.twosided_+3A_prob">prob</code></td>
<td>
<p>prior probability of the hypothesis</p>
</td></tr>
<tr><td><code id="mnormt.twosided_+3A_t">t</code></td>
<td>
<p>vector of values of the prior standard
deviation under the alternative hypothesis</p>
</td></tr>
<tr><td><code id="mnormt.twosided_+3A_data">data</code></td>
<td>
<p>vector containing the sample mean,
the sample size, and the known value of the
population standard deviation</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>bf</code></td>
<td>
<p>vector of values of the Bayes factor
in support of the null hypothesis</p>
</td></tr>
<tr><td><code>post</code></td>
<td>
<p>vector of posterior probabilities
of the null hypothesis</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>m0=170
prob=.5
tau=c(.5,1,2,4,8)
samplesize=10
samplemean=176
popsd=3
data=c(samplemean,samplesize,popsd)
mnormt.twosided(m0,prob,tau,data)
</code></pre>

<hr>
<h2 id='mycontour'>Contour plot of a bivariate density function</h2><span id='topic+mycontour'></span>

<h3>Description</h3>

<p>For a general two parameter density, draws a contour graph where the
contour lines are drawn at 10 percent, 1 percent, and .1 percent of 
the height at the mode.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mycontour(logf,limits,data,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mycontour_+3A_logf">logf</code></td>
<td>
<p>function that defines the logarithm of the  density</p>
</td></tr>
<tr><td><code id="mycontour_+3A_limits">limits</code></td>
<td>
<p>limits (xlo, xhi, ylo, yhi) where the graph is to be drawn</p>
</td></tr>
<tr><td><code id="mycontour_+3A_data">data</code></td>
<td>
<p>vector or list of parameters associated with the function logpost</p>
</td></tr>
<tr><td><code id="mycontour_+3A_...">...</code></td>
<td>
<p>further arguments to pass to contour</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A contour graph of the density is drawn
</p>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>m=array(c(0,0),c(2,1))
v=array(c(1,.6,.6,1),c(2,2))
normpar=list(m=m,v=v)
mycontour(lbinorm,c(-4,4,-4,4),normpar)
</code></pre>

<hr>
<h2 id='normal.normal.mix'>Computes the posterior for normal sampling and a mixture of normals prior</h2><span id='topic+normal.normal.mix'></span>

<h3>Description</h3>

<p>Computes the parameters and mixing probabilities for a normal sampling problem, variance known,
where the prior is a discrete mixture of normal densities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>normal.normal.mix(probs,normalpar,data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="normal.normal.mix_+3A_probs">probs</code></td>
<td>
<p>vector of probabilities of the normal components of the prior</p>
</td></tr>
<tr><td><code id="normal.normal.mix_+3A_normalpar">normalpar</code></td>
<td>
<p>matrix where each row contains the mean and variance parameters for a normal component of the prior</p>
</td></tr>
<tr><td><code id="normal.normal.mix_+3A_data">data</code></td>
<td>
<p>vector of observation and sampling variance</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>probs</code></td>
<td>
<p>vector of  probabilities of the normal components of the posterior</p>
</td></tr>
<tr><td><code>normalpar</code></td>
<td>
<p>matrix where each row contains the mean and variance parameters for a normal component of the posterior</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>probs=c(.5, .5)
normal.par1=c(0,1)
normal.par2=c(2,.5)
normalpar=rbind(normal.par1,normal.par2)
y=1; sigma2=.5
data=c(y,sigma2)
normal.normal.mix(probs,normalpar,data)
</code></pre>

<hr>
<h2 id='normal.select'>Selection of Normal Prior Given Knowledge of Two Quantiles</h2><span id='topic+normal.select'></span>

<h3>Description</h3>

<p>Finds the mean and standard deviation of a normal density that matches knowledge of
two quantiles of the distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>normal.select(quantile1, quantile2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="normal.select_+3A_quantile1">quantile1</code></td>
<td>
<p>list with components p, the value of the first probability,
and x, the value of the first quantile</p>
</td></tr>
<tr><td><code id="normal.select_+3A_quantile2">quantile2</code></td>
<td>
<p>list with components p, the value of the second probability,
and x, the value of the second quantile</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>mean</code></td>
<td>
<p>mean of the matching normal distribution</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>standard deviation of the matching normal distribution</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'># person believes the 15th percentile of the prior is 100
# and the 70th percentile of the prior is 150
quantile1=list(p=.15,x=100)
quantile2=list(p=.7,x=150)
normal.select(quantile1,quantile2)
</code></pre>

<hr>
<h2 id='normchi2post'>Log posterior density for mean and variance for normal sampling</h2><span id='topic+normchi2post'></span>

<h3>Description</h3>

<p>Computes the log of the posterior density of a mean M and a variance S2 when a sample is taken from a normal density and a standard noninformative prior is used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>normchi2post(theta,data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="normchi2post_+3A_theta">theta</code></td>
<td>
<p>vector of parameter values M and S2</p>
</td></tr>
<tr><td><code id="normchi2post_+3A_data">data</code></td>
<td>
<p>vector containing the sample observations</p>
</td></tr>
</table>


<h3>Value</h3>

<p>value of the log posterior
</p>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>parameter=c(25,5)
data=c(20, 32, 21, 43, 33, 21, 32)
normchi2post(parameter,data)
</code></pre>

<hr>
<h2 id='normnormexch'>Log posterior of mean and log standard deviation for Normal/Normal exchangeable model</h2><span id='topic+normnormexch'></span>

<h3>Description</h3>

<p>Computes the log posterior density of mean and log standard deviation for a Normal/Normal exchangeable model where (mean, log sd) is given a uniform prior.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>normnormexch(theta,data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="normnormexch_+3A_theta">theta</code></td>
<td>
<p>vector of parameter values of mu and log tau</p>
</td></tr>
<tr><td><code id="normnormexch_+3A_data">data</code></td>
<td>
<p>a matrix with columns y (observations) and v (sampling variances)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>value of the log posterior
</p>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>s.var &lt;- c(0.05, 0.05, 0.05, 0.05, 0.05)
y.means &lt;- c(1, 4, 3, 6,10)
data=cbind(y.means, s.var)
theta=c(-1, 0)
normnormexch(theta,data)
</code></pre>

<hr>
<h2 id='normpostpred'>Posterior predictive simulation from Bayesian normal sampling model</h2><span id='topic+normpostpred'></span>

<h3>Description</h3>

<p>Given simulated draws from the posterior from a normal sampling model, outputs
simulated draws from the posterior predictive distribution of a statistic of interest.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>normpostpred(parameters,sample.size,f=min)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="normpostpred_+3A_parameters">parameters</code></td>
<td>
<p>list of simulated draws from the posterior where mu contains the normal mean
and sigma2 contains the normal variance</p>
</td></tr>
<tr><td><code id="normpostpred_+3A_sample.size">sample.size</code></td>
<td>
<p>size of sample of future sample</p>
</td></tr>
<tr><td><code id="normpostpred_+3A_f">f</code></td>
<td>
<p>function defining the statistic</p>
</td></tr>
</table>


<h3>Value</h3>

<p>simulated sample of the posterior predictive distribution of the statistic</p>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'># finds posterior predictive distribution of the min statistic of a future sample of size 15
data(darwin)
s=normpostsim(darwin$difference)
sample.size=15
sim.stats=normpostpred(s,sample.size,min)
</code></pre>

<hr>
<h2 id='normpostsim'>Simulation from Bayesian normal sampling model</h2><span id='topic+normpostsim'></span>

<h3>Description</h3>

<p>Gives a simulated sample from the joint posterior distribution of the mean and
variance for a normal sampling prior with a noninformative or
informative prior.  The prior assumes mu and sigma2 are independent with
mu assigned a normal prior with mean mu0 and variance tau2, and sigma2 is
assigned a inverse gamma prior with parameters a and b.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>normpostsim(data,prior=NULL,m=1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="normpostsim_+3A_data">data</code></td>
<td>
<p>vector of observations</p>
</td></tr>
<tr><td><code id="normpostsim_+3A_prior">prior</code></td>
<td>
<p>list with components mu, a vector with the prior mean 
and variance, and sigma2, a vector of the inverse gamma parameters</p>
</td></tr>
<tr><td><code id="normpostsim_+3A_m">m</code></td>
<td>
<p>number of simulations desired</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>mu</code></td>
<td>
<p>vector of simulated draws of normal mean</p>
</td></tr>
<tr><td><code>sigma2</code></td>
<td>
<p>vector of simulated draws of normal variance</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(darwin)
s=normpostsim(darwin$difference)
</code></pre>

<hr>
<h2 id='ordergibbs'>Gibbs sampling for a hierarchical regression model</h2><span id='topic+ordergibbs'></span>

<h3>Description</h3>

<p>Implements Gibbs sampling for estimating a two-way table of means
under a order restriction.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ordergibbs(data,m)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ordergibbs_+3A_data">data</code></td>
<td>
<p>data matrix with first two columns observed sample means and sample sizes</p>
</td></tr>
<tr><td><code id="ordergibbs_+3A_m">m</code></td>
<td>
<p>number of cycles of Gibbs sampling</p>
</td></tr>
</table>


<h3>Value</h3>

<p>matrix of simulated draws of the normal means where each row represents one simulated draw
</p>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(iowagpa)
m=1000
s=ordergibbs(iowagpa,m)
</code></pre>

<hr>
<h2 id='pbetap'>Predictive distribution for a binomial sample with a beta prior</h2><span id='topic+pbetap'></span>

<h3>Description</h3>

<p>Computes predictive distribution for number of successes of
future binomial experiment
with a beta prior distribution for the proportion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pbetap(ab, n, s)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pbetap_+3A_ab">ab</code></td>
<td>
<p>vector of parameters of the beta prior</p>
</td></tr>
<tr><td><code id="pbetap_+3A_n">n</code></td>
<td>
<p>size of future binomial sample</p>
</td></tr>
<tr><td><code id="pbetap_+3A_s">s</code></td>
<td>
<p>vector of number of successes for future binomial experiment</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector of predictive probabilities for the values in the vector s
</p>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>ab=c(3,12)
n=10
s=0:10
pbetap(ab,n,s)
</code></pre>

<hr>
<h2 id='pbetat'>Bayesian test of a proportion</h2><span id='topic+pbetat'></span>

<h3>Description</h3>

<p>Bayesian test that a proportion is equal to a specified
value using a beta prior</p>


<h3>Usage</h3>

<pre><code class='language-R'>pbetat(p0,prob,ab,data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pbetat_+3A_p0">p0</code></td>
<td>
<p>value of the proportion to be tested </p>
</td></tr>
<tr><td><code id="pbetat_+3A_prob">prob</code></td>
<td>
<p>prior probability of the hypothesis</p>
</td></tr>
<tr><td><code id="pbetat_+3A_ab">ab</code></td>
<td>
<p>vector of parameter values of the beta prior under the alternative hypothesis</p>
</td></tr>
<tr><td><code id="pbetat_+3A_data">data</code></td>
<td>
<p>vector containing the number of successes and number of failures</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>bf</code></td>
<td>
<p>the Bayes factor
in support of the null hypothesis</p>
</td></tr>
<tr><td><code>post</code></td>
<td>
<p>the posterior probability
of the null hypothesis</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>p0=.5
prob=.5
ab=c(10,10)
data=c(5,15)
pbetat(p0,prob,ab,data)
</code></pre>

<hr>
<h2 id='pdisc'>Posterior distribution for a proportion with discrete priors</h2><span id='topic+pdisc'></span>

<h3>Description</h3>

<p>Computes the posterior distribution for a proportion for a discrete prior
distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pdisc(p, prior, data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pdisc_+3A_p">p</code></td>
<td>
<p>vector of proportion values</p>
</td></tr>
<tr><td><code id="pdisc_+3A_prior">prior</code></td>
<td>
<p>vector of prior probabilities</p>
</td></tr>
<tr><td><code id="pdisc_+3A_data">data</code></td>
<td>
<p>vector consisting of number of successes and number of
failures</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector of posterior probabilities
</p>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>p=c(.2,.25,.3,.35)
prior=c(.25,.25,.25,.25)
data=c(5,10)
pdisc(p,prior,data)
</code></pre>

<hr>
<h2 id='pdiscp'>Predictive distribution for a binomial sample with a discrete prior</h2><span id='topic+pdiscp'></span>

<h3>Description</h3>

<p>Computes predictive distribution for number of successes of
future binomial experiment
with a discrete distribution for the proportion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pdiscp(p, probs, n, s)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pdiscp_+3A_p">p</code></td>
<td>
<p>vector of proportion values</p>
</td></tr>
<tr><td><code id="pdiscp_+3A_probs">probs</code></td>
<td>
<p>vector of probabilities</p>
</td></tr>
<tr><td><code id="pdiscp_+3A_n">n</code></td>
<td>
<p>size of future binomial sample</p>
</td></tr>
<tr><td><code id="pdiscp_+3A_s">s</code></td>
<td>
<p>vector of number of successes for future binomial experiment</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector of predictive probabilities for the values in the vector s
</p>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>p=c(.1,.2,.3,.4,.5,.6,.7,.8,.9)
prob=c(0.05,0.10,0.10,0.15,0.20,0.15,0.10,0.10,0.05)
n=10
s=0:10
pdiscp(p,prob,n,s)
</code></pre>

<hr>
<h2 id='poissgamexch'>Log posterior of Poisson/gamma exchangeable model</h2><span id='topic+poissgamexch'></span>

<h3>Description</h3>

<p>Computes the log posterior density of log alpha and log mu for a Poisson/gamma exchangeable model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>poissgamexch(theta,datapar)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="poissgamexch_+3A_theta">theta</code></td>
<td>
<p>vector of parameter values of log alpha and log mu</p>
</td></tr>
<tr><td><code id="poissgamexch_+3A_datapar">datapar</code></td>
<td>
<p>list with components data, a matrix with columns e and y, and z0, prior hyperparameter</p>
</td></tr>
</table>


<h3>Value</h3>

<p>value of the log posterior
</p>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>e=c(532,584,672,722,904)
y=c(0,0,2,1,1)
data=cbind(e,y)
theta=c(-4,0)
z0=.5
datapar=list(data=data,z0=z0)
poissgamexch(theta,datapar)
</code></pre>

<hr>
<h2 id='poisson.gamma.mix'>Computes the posterior for Poisson sampling and a mixture of gammas prior</h2><span id='topic+poisson.gamma.mix'></span>

<h3>Description</h3>

<p>Computes the parameters and mixing probabilities for a Poisson sampling problem
where the prior is a discrete mixture of gamma densities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>poisson.gamma.mix(probs,gammapar,data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="poisson.gamma.mix_+3A_probs">probs</code></td>
<td>
<p>vector of probabilities of the gamma components of the prior</p>
</td></tr>
<tr><td><code id="poisson.gamma.mix_+3A_gammapar">gammapar</code></td>
<td>
<p>matrix where each row contains the shape and rate parameters for a gamma component of the prior</p>
</td></tr>
<tr><td><code id="poisson.gamma.mix_+3A_data">data</code></td>
<td>
<p>list with components y, vector of counts, and t, vector of time intervals</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>probs</code></td>
<td>
<p>vector of  probabilities of the gamma components of the posterior</p>
</td></tr>
<tr><td><code>gammapar</code></td>
<td>
<p>matrix where each row contains the shape and rate parameters for a gamma component of the posterior</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>probs=c(.5, .5)
gamma.par1=c(1,1)
gamma.par2=c(10,2)
gammapar=rbind(gamma.par1,gamma.par2)
y=c(1,3,2,4,10); t=c(1,1,1,1,1)
data=list(y=y,t=t)
poisson.gamma.mix(probs,gammapar,data)</code></pre>

<hr>
<h2 id='predplot'>Plot of predictive distribution for binomial sampling with a beta prior</h2><span id='topic+predplot'></span>

<h3>Description</h3>

<p>For a proportion problem with a beta prior, plots the prior predictive distribution
of the number of successes in n trials and displays the observed number of successes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predplot(prior,n,yobs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predplot_+3A_prior">prior</code></td>
<td>
<p>vector of parameters for beta prior</p>
</td></tr>
<tr><td><code id="predplot_+3A_n">n</code></td>
<td>
<p>sample size</p>
</td></tr>
<tr><td><code id="predplot_+3A_yobs">yobs</code></td>
<td>
<p>observed number of successes</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>prior=c(3,10)  # proportion has a beta(3, 10) prior
n=20   # sample size
yobs=10  # observed number of successes
predplot(prior,n,yobs)
</code></pre>

<hr>
<h2 id='prior.two.parameters'>Construct discrete uniform prior for two parameters</h2><span id='topic+prior.two.parameters'></span>

<h3>Description</h3>

<p>Constructs a discrete uniform prior distribution for two parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prior.two.parameters(parameter1, parameter2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prior.two.parameters_+3A_parameter1">parameter1</code></td>
<td>
<p>vector of values of first parameter</p>
</td></tr>
<tr><td><code id="prior.two.parameters_+3A_parameter2">parameter2</code></td>
<td>
<p>vector of values of second parameter</p>
</td></tr>
</table>


<h3>Value</h3>

<p>matrix of uniform probabilities where the rows and columns are
labelled with the parameter values
</p>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>prior.two.parameters(c(1,2,3,4),c(2,4,7))
</code></pre>

<hr>
<h2 id='puffin'>Bird measurements from British islands</h2><span id='topic+puffin'></span>

<h3>Description</h3>

<p>Measurements on breedings of the common puffin on different
habits at Great Island, Newfoundland.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>puffin
</code></pre>


<h3>Format</h3>

<p>A data frame with 38 observations on the following 5 variables.
</p>

<dl>
<dt>Nest</dt><dd><p>nesting frequency (burrows per 9 square meters)</p>
</dd>
<dt>Grass</dt><dd><p>grass cover (percentage)</p>
</dd>
<dt>Soil</dt><dd><p>mean soil depth (in centimeters)</p>
</dd>
<dt>Angle</dt><dd><p>angle of slope (in degrees)</p>
</dd>
<dt>Distance</dt><dd><p>distance from cliff edge (in meters)</p>
</dd>
</dl>



<h3>Source</h3>

<p>Peck, R., Devore, J., and Olsen, C. (2005), Introduction to Statistics 
And Data Analysis, Thomson Learning.</p>

<hr>
<h2 id='rdirichlet'>Random draws from a Dirichlet distribution</h2><span id='topic+rdirichlet'></span>

<h3>Description</h3>

<p>Simulates a sample from a Dirichlet distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rdirichlet(n,par)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rdirichlet_+3A_n">n</code></td>
<td>
<p>number of simulations required</p>
</td></tr>
<tr><td><code id="rdirichlet_+3A_par">par</code></td>
<td>
<p>vector of parameters of the Dirichlet distribution</p>
</td></tr>
</table>


<h3>Value</h3>

<p>matrix of simulated draws where each row corresponds to a single draw
</p>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>par=c(2,5,4,10)
n=10
rdirichlet(n,par)
</code></pre>

<hr>
<h2 id='reg.gprior.post'>Computes the log posterior of a normal regression model with a g prior.</h2><span id='topic+reg.gprior.post'></span>

<h3>Description</h3>

<p>Computes the log posterior of (beta, log sigma) for a normal regression
model with a g prior with parameters beta0 and c0.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reg.gprior.post(theta, dataprior)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="reg.gprior.post_+3A_theta">theta</code></td>
<td>
<p>vector of components of beta and log sigma</p>
</td></tr>
<tr><td><code id="reg.gprior.post_+3A_dataprior">dataprior</code></td>
<td>
<p>list with components data and prior; data is a list
with components y and X, prior is a list with components b0 and c0</p>
</td></tr>
</table>


<h3>Value</h3>

<p>value of the log posterior
</p>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(puffin)
data=list(y=puffin$Nest, X=cbind(1,puffin$Distance))
prior=list(b0=c(0,0), c0=10)
reg.gprior.post(c(20,-.5,1),list(data=data,prior=prior))
</code></pre>

<hr>
<h2 id='regroup'>Collapses a matrix by summing over rows</h2><span id='topic+regroup'></span>

<h3>Description</h3>

<p>Collapses a matrix by summing over a specific number of rows 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>regroup(data,g)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="regroup_+3A_data">data</code></td>
<td>
<p>a matrix</p>
</td></tr>
<tr><td><code id="regroup_+3A_g">g</code></td>
<td>
<p>a positive integer beween 1 and the number of rows of data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>reduced matrix found by summing over rows
</p>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>data=matrix(c(1:20),nrow=4,ncol=5)
g=2
regroup(data,2)
</code></pre>

<hr>
<h2 id='rejectsampling'>Rejecting sampling using a t proposal density</h2><span id='topic+rejectsampling'></span>

<h3>Description</h3>

<p>Implements a rejection sampling algorithm for a probability density
using a multivariate t proposal density 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rejectsampling(logf,tpar,dmax,n,data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rejectsampling_+3A_logf">logf</code></td>
<td>
<p>function that defines the logarithm of the density of interest</p>
</td></tr>
<tr><td><code id="rejectsampling_+3A_tpar">tpar</code></td>
<td>
<p>list of parameters of t proposal density including the mean m, scale matrix var, 
and degrees of freedom df</p>
</td></tr> 
<tr><td><code id="rejectsampling_+3A_dmax">dmax</code></td>
<td>
<p>logarithm of the rejection sampling constant</p>
</td></tr>
<tr><td><code id="rejectsampling_+3A_n">n</code></td>
<td>
<p>number of simulated draws from proposal density</p>
</td></tr>
<tr><td><code id="rejectsampling_+3A_data">data</code></td>
<td>
<p>data and or parameters used in the function logf</p>
</td></tr>
</table>


<h3>Value</h3>

<p>matrix of simulated draws from density of interest
</p>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(cancermortality)
start=c(-7,6)
fit=laplace(betabinexch,start,cancermortality)
tpar=list(m=fit$mode,var=2*fit$var,df=4)
theta=rejectsampling(betabinexch,tpar,-569.2813,1000,cancermortality)
</code></pre>

<hr>
<h2 id='rigamma'>Random number generation for inverse gamma distribution</h2><span id='topic+rigamma'></span>

<h3>Description</h3>

<p>Simulates from a inverse gamma (a, b) distribution with density 
proportional to $y^(-a-1) exp(-b/y)$
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rigamma(n, a, b)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rigamma_+3A_n">n</code></td>
<td>
<p>number of random numbers to be generated</p>
</td></tr>
<tr><td><code id="rigamma_+3A_a">a</code></td>
<td>
<p>inverse gamma shape parameter</p>
</td></tr>
<tr><td><code id="rigamma_+3A_b">b</code></td>
<td>
<p>inverse gamma rate parameter</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector of n simulated draws
</p>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>a=10
b=5
n=20
rigamma(n,a,b)
</code></pre>

<hr>
<h2 id='rmnorm'>Random number generation for multivariate normal</h2><span id='topic+rmnorm'></span>

<h3>Description</h3>

<p>Simulates from a multivariate normal distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rmnorm(n = 1, mean = rep(0, d), varcov)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rmnorm_+3A_n">n</code></td>
<td>
<p>number of random numbers to be generated</p>
</td></tr>
<tr><td><code id="rmnorm_+3A_mean">mean</code></td>
<td>
<p>numeric vector giving the mean of the distribution</p>
</td></tr>
<tr><td><code id="rmnorm_+3A_varcov">varcov</code></td>
<td>
<p>a positive definite matrix representing the variance-covariance matrix of the distribution</p>
</td></tr>
</table>


<h3>Value</h3>

<p>matrix of n rows of random vectors
</p>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>mu &lt;- c(1,12,2)
Sigma &lt;- matrix(c(1,2,0,2,5,0.5,0,0.5,3), 3, 3)
x &lt;- rmnorm(10, mu, Sigma)
</code></pre>

<hr>
<h2 id='rmt'>Random number generation for multivariate t</h2><span id='topic+rmt'></span>

<h3>Description</h3>

<p>Simulates from a multivariate t distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rmt(n = 1, mean = rep(0, d), S, df = Inf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rmt_+3A_n">n</code></td>
<td>
<p>number of random numbers to be generated</p>
</td></tr>
<tr><td><code id="rmt_+3A_mean">mean</code></td>
<td>
<p>numeric vector giving the location parameter of the distribution</p>
</td></tr>
<tr><td><code id="rmt_+3A_s">S</code></td>
<td>
<p>a positive definite matrix representing the scale matrix of the distribution</p>
</td></tr>
<tr><td><code id="rmt_+3A_df">df</code></td>
<td>
<p>degrees of freedom</p>
</td></tr>
</table>


<h3>Value</h3>

<p>matrix of n rows of random vectors
</p>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>mu &lt;- c(1,12,2)
Sigma &lt;- matrix(c(1,2,0,2,5,0.5,0,0.5,3), 3, 3)
df &lt;- 4
x &lt;- rmt(10, mu, Sigma, df)
</code></pre>

<hr>
<h2 id='robustt'>Gibbs sampling for a robust regression model</h2><span id='topic+robustt'></span>

<h3>Description</h3>

<p>Implements Gibbs sampling for a robust t sampling model with location mu, scale sigma, and degrees of freedom v </p>


<h3>Usage</h3>

<pre><code class='language-R'>robustt(y,v,m)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="robustt_+3A_y">y</code></td>
<td>
<p>vector of data values</p>
</td></tr>
<tr><td><code id="robustt_+3A_v">v</code></td>
<td>
<p>degrees of freedom for t model</p>
</td></tr> 
<tr><td><code id="robustt_+3A_m">m</code></td>
<td>
<p>the number of cycles of the Gibbs sampler</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>mu</code></td>
<td>
<p>vector of simulated values of mu</p>
</td></tr>
<tr><td><code>s2</code></td>
<td>
<p>vector of simulated values of sigma2</p>
</td></tr>
<tr><td><code>lam</code></td>
<td>
<p>matrix of simulated draws of lambda, where each row corresponds to a single draw</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>data=c(-67,-48,6,8,14,16,23,24,28,29,41,49,67,60,75)
fit=robustt(data,4,1000)
</code></pre>

<hr>
<h2 id='rtruncated'>Simulates from a truncated probability distribution</h2><span id='topic+rtruncated'></span>

<h3>Description</h3>

<p>Simulates a sample from a truncated distribution where the functions for the cdf and inverse cdf are available.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rtruncated(n,lo,hi,pf,qf,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rtruncated_+3A_n">n</code></td>
<td>
<p>size of simulated sample</p>
</td></tr>
<tr><td><code id="rtruncated_+3A_lo">lo</code></td>
<td>
<p>low truncation point</p>
</td></tr>
<tr><td><code id="rtruncated_+3A_hi">hi</code></td>
<td>
<p>high truncation point</p>
</td></tr>
<tr><td><code id="rtruncated_+3A_pf">pf</code></td>
<td>
<p>function containing cdf of untruncated distribution</p>
</td></tr>
<tr><td><code id="rtruncated_+3A_qf">qf</code></td>
<td>
<p>function containing inverse cdf of untruncated distribution</p>
</td></tr>
<tr><td><code id="rtruncated_+3A_...">...</code></td>
<td>
<p>parameters used in the functions pf and qf</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector of simulated draws from distribution</p>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'># want a sample of 10 from normal(2, 1) distribution truncated below by 3
n=10
lo=3
hi=Inf
rtruncated(n,lo,hi,pnorm,qnorm,mean=2,sd=1)
# want a sample of 20 from beta(2, 5) distribution truncated to (.3, .8)
n=20
lo=0.3
hi=0.8
rtruncated(n,lo,hi,pbeta,qbeta,2,5)
</code></pre>

<hr>
<h2 id='rwmetrop'>Random walk Metropolis algorithm of a posterior distribution</h2><span id='topic+rwmetrop'></span>

<h3>Description</h3>

<p>Simulates iterates of a random walk Metropolis chain for an arbitrary  real-valued
posterior density defined by the user
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rwmetrop(logpost,proposal,start,m,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rwmetrop_+3A_logpost">logpost</code></td>
<td>
<p>function defining the log posterior density</p>
</td></tr>
<tr><td><code id="rwmetrop_+3A_proposal">proposal</code></td>
<td>
<p>a list containing var, an estimated variance-covariance matrix, and scale, the Metropolis scale factor</p>
</td></tr> 
<tr><td><code id="rwmetrop_+3A_start">start</code></td>
<td>
<p>vector containing the starting value of the parameter</p>
</td></tr>
<tr><td><code id="rwmetrop_+3A_m">m</code></td>
<td>
<p>the number of iterations of the chain</p>
</td></tr>
<tr><td><code id="rwmetrop_+3A_...">...</code></td>
<td>
<p>data that is used in the function logpost</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>par</code></td>
<td>
<p>a matrix of simulated values where each row corresponds to a value of the vector parameter</p>
</td></tr>
<tr><td><code>accept</code></td>
<td>
<p>the acceptance rate of the algorithm</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>data=c(6,2,3,10)
varcov=diag(c(1,1))
proposal=list(var=varcov,scale=2)
start=array(c(1,1),c(1,2))
m=1000
s=rwmetrop(logctablepost,proposal,start,m,data)
</code></pre>

<hr>
<h2 id='schmidt'>Batting data for Mike Schmidt</h2><span id='topic+schmidt'></span>

<h3>Description</h3>

<p>Batting statistics for the baseball player Mike Schmidt
during all the seasons of his career.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>schmidt
</code></pre>


<h3>Format</h3>

<p>A data frame with 18 observations on the following 14 variables.
</p>

<dl>
<dt>Year</dt><dd><p>year of the season</p>
</dd>
<dt>Age</dt><dd><p>Schmidt's age that season</p>
</dd>
<dt>G</dt><dd><p>games played</p>
</dd>
<dt>AB</dt><dd><p>at-bats</p>
</dd>
<dt>R</dt><dd><p>runs scored</p>
</dd>
<dt>H</dt><dd><p>number of hits</p>
</dd>
<dt>X2B</dt><dd><p>number of doubles</p>
</dd>
<dt>X3B</dt><dd><p>number of triples</p>
</dd>
<dt>HR</dt><dd><p>number of home runs</p>
</dd>
<dt>RBI</dt><dd><p>number of runs batted in</p>
</dd>
<dt>SB</dt><dd><p>number of stolen bases</p>
</dd>
<dt>CS</dt><dd><p>number of times caught stealing</p>
</dd>
<dt>BB</dt><dd><p>number of walks</p>
</dd>
<dt>SO</dt><dd><p>number of strikeouts</p>
</dd>
</dl>



<h3>Source</h3>

<p>Sean Lahman's baseball database from www.baseball1.com.</p>

<hr>
<h2 id='simcontour'>Simulated draws from a bivariate density function on a grid</h2><span id='topic+simcontour'></span>

<h3>Description</h3>

<p>For a general two parameter density defined on a grid, simulates a random sample.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simcontour(logf,limits,data,m)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simcontour_+3A_logf">logf</code></td>
<td>
<p>function that defines the logarithm of the  density</p>
</td></tr>
<tr><td><code id="simcontour_+3A_limits">limits</code></td>
<td>
<p>limits (xlo, xhi, ylo, yhi) that cover the joint probability density</p>
</td></tr>
<tr><td><code id="simcontour_+3A_data">data</code></td>
<td>
<p>vector or list of parameters associated with the function logpost</p>
</td></tr>
<tr><td><code id="simcontour_+3A_m">m</code></td>
<td>
<p>size of simulated sample</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>x</code></td>
<td>
<p>vector of simulated draws of the first parameter</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>vector of simulated draws of the second parameter</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>m=array(c(0,0),c(2,1))
v=array(c(1,.6,.6,1),c(2,2))
normpar=list(m=m,v=v)
s=simcontour(lbinorm,c(-4,4,-4,4),normpar,1000)
plot(s$x,s$y)
</code></pre>

<hr>
<h2 id='sir'>Sampling importance resampling</h2><span id='topic+sir'></span>

<h3>Description</h3>

<p>Implements sampling importance resampling for a multivariate
t proposal density. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sir(logf,tpar,n,data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sir_+3A_logf">logf</code></td>
<td>
<p>function defining logarithm of density of interest</p>
</td></tr>
<tr><td><code id="sir_+3A_tpar">tpar</code></td>
<td>
<p>list of parameters of multivariate t proposal density including
the mean m, the scale matrix var, and the degrees of freedom df</p>
</td></tr>
<tr><td><code id="sir_+3A_n">n</code></td>
<td>
<p>number of simulated draws from the posterior</p>
</td></tr>
<tr><td><code id="sir_+3A_data">data</code></td>
<td>
<p>data and parameters used in the function logf</p>
</td></tr>
</table>


<h3>Value</h3>

<p>matrix of simulated draws from the posterior where each row corresponds to a single draw
</p>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(cancermortality)
start=c(-7,6)
fit=laplace(betabinexch,start,cancermortality)
tpar=list(m=fit$mode,var=2*fit$var,df=4)
theta=sir(betabinexch,tpar,1000,cancermortality)
</code></pre>

<hr>
<h2 id='sluggerdata'>Hitting statistics for ten great baseball players</h2><span id='topic+sluggerdata'></span>

<h3>Description</h3>

<p>Career hitting statistics for ten great baseball players
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sluggerdata
</code></pre>


<h3>Format</h3>

<p>A data frame with 199 observations on the following 13 variables.
</p>

<dl>
<dt>Player</dt><dd><p>names of the ballplayer</p>
</dd>
<dt>Year</dt><dd><p>season played</p>
</dd>
<dt>Age</dt><dd><p>age of the player during the season</p>
</dd>
<dt>G</dt><dd><p>games played</p>
</dd>
<dt>AB</dt><dd><p>number of at-bats</p>
</dd>
<dt>R</dt><dd><p>number of runs scored</p>
</dd>
<dt>H</dt><dd><p>number of hits</p>
</dd>
<dt>X2B</dt><dd><p>number of doubles</p>
</dd>
<dt>X3B</dt><dd><p>number of triples</p>
</dd>
<dt>HR</dt><dd><p>number of home runs</p>
</dd>
<dt>RBI</dt><dd><p>runs batted in</p>
</dd>
<dt>BB</dt><dd><p>number of base on balls</p>
</dd>
<dt>SO</dt><dd><p>number of strikeouts</p>
</dd>
</dl>



<h3>Source</h3>

<p>Sean Lahman's baseball database from www.baseball1.com.</p>

<hr>
<h2 id='soccergoals'>Goals scored by professional soccer team</h2><span id='topic+soccergoals'></span>

<h3>Description</h3>

<p>Number of goals scored by a single professional soccer team
during the 2006 Major League Soccer season</p>


<h3>Usage</h3>

<pre><code class='language-R'>soccergoals
</code></pre>


<h3>Format</h3>

<p>A data frame with 35 observations on the following 1 variable.
</p>

<dl>
<dt>goals</dt><dd><p>number of goals scored</p>
</dd>
</dl>



<h3>Source</h3>

<p>Collected by author from the www.espn.com website.</p>

<hr>
<h2 id='stanfordheart'>Data from Stanford Heart Transplanation Program</h2><span id='topic+stanfordheart'></span>

<h3>Description</h3>

<p>Heart transplant data for 82 patients from Stanford Heart Transplanation Program</p>


<h3>Usage</h3>

<pre><code class='language-R'>stanfordheart
</code></pre>


<h3>Format</h3>

<p>A data frame with 82 observations on the following 4 variables.
</p>

<dl>
<dt>survtime</dt><dd><p>survival time in months</p>
</dd>
<dt>transplant</dt><dd><p>variable that is 1 or 0 if patient had transplant or not</p>
</dd>
<dt>timetotransplant</dt><dd><p>time a transplant patient waits for operation</p>
</dd>
<dt>state</dt><dd><p>variable that is 1 or 0 if time is censored or not</p>
</dd>
</dl>



<h3>Source</h3>

<p>Turnbull, B., Brown, B. and Hu, M. (1974), Survivorship 
analysis of heart transplant data, Journal of the 
American Statistical Association, 69, 74-80.</p>

<hr>
<h2 id='strikeout'>Baseball strikeout data</h2><span id='topic+strikeout'></span>

<h3>Description</h3>

<p>For all professional baseball players in the 2004 season, dataset gives the
number of strikeouts and at-bats when runners are in scoring position and when
runners are not in scoring position.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>strikeout
</code></pre>


<h3>Format</h3>

<p>A data frame with 438 observations on the following 4 variables.
</p>

<dl>
<dt>r</dt><dd><p>number of strikeouts of player when runners are not in scoring position</p>
</dd>
<dt>n</dt><dd><p>number of at-bats of player when runners are not in scoring position</p>
</dd>
<dt>s</dt><dd><p>number of strikeouts of player when runners are in scoring position</p>
</dd>
<dt>m</dt><dd><p>number of at-bats of player when runners are in scoring position</p>
</dd>
</dl>



<h3>Source</h3>

<p>Collected from www.espn.com website.</p>

<hr>
<h2 id='studentdata'>Student dataset</h2><span id='topic+studentdata'></span>

<h3>Description</h3>

<p>Answers to a sheet of questions given to a large number
of students in introductory statistics classes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>studentdata
</code></pre>


<h3>Format</h3>

<p>A data frame with 657 observations on the following 11 variables.
</p>

<dl>
<dt>Student</dt><dd><p>student number</p>
</dd>
<dt>Height</dt><dd><p>height in inches</p>
</dd>
<dt>Gender</dt><dd><p>gender</p>
</dd>
<dt>Shoes</dt><dd><p>number of pairs of shoes owned</p>
</dd>
<dt>Number</dt><dd><p>number chosen between 1 and 10</p>
</dd>
<dt>Dvds</dt><dd><p>name of movie dvds owned</p>
</dd>
<dt>ToSleep</dt><dd><p>time the person went to sleep the previous night (hours past midnight)</p>
</dd>
<dt>WakeUp</dt><dd><p>time the person woke up the next morning</p>
</dd>
<dt>Haircut</dt><dd><p>cost of last haircut including tip</p>
</dd>
<dt>Job</dt><dd><p>number of hours working on a job per week</p>
</dd>
<dt>Drink</dt><dd><p>usual drink at suppertime among milk, water, and pop</p>
</dd>
</dl>



<h3>Source</h3>

<p>Collected by the author during the Fall 2006 semester.</p>

<hr>
<h2 id='transplantpost'>Log posterior of a Pareto model for survival data</h2><span id='topic+transplantpost'></span>

<h3>Description</h3>

<p>Computes the log posterior density of (log tau, log lambda, log p)  for a Pareto
model for survival data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>transplantpost(theta,data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="transplantpost_+3A_theta">theta</code></td>
<td>
<p>vector of parameter values of log tau, log lambda, and log p</p>
</td></tr>
<tr><td><code id="transplantpost_+3A_data">data</code></td>
<td>
<p>data matrix with columns survival time, transplant indicator, time to transplant, and
censoring indicator</p>
</td></tr>
</table>


<h3>Value</h3>

<p>value of the log posterior
</p>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(stanfordheart)
theta=c(0,3,-1)
transplantpost(theta,stanfordheart)
</code></pre>

<hr>
<h2 id='triplot'>Plot of prior, likelihood and posterior for a proportion</h2><span id='topic+triplot'></span>

<h3>Description</h3>

<p>For a proportion problem with a beta prior, plots the prior, likelihood and posterior
on one graph.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>triplot(prior,data,where="topright")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="triplot_+3A_prior">prior</code></td>
<td>
<p>vector of parameters for beta prior</p>
</td></tr>
<tr><td><code id="triplot_+3A_data">data</code></td>
<td>
<p>vector consisting of number of successes and number of
failures</p>
</td></tr>
<tr><td><code id="triplot_+3A_where">where</code></td>
<td>
<p>the location of the legend for the plot</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>prior=c(3,10)  # proportion has a beta(3, 10) prior
data=c(10,6)   # observe 10 successes and 6 failures
triplot(prior,data)
</code></pre>

<hr>
<h2 id='weibullregpost'>Log posterior of a Weibull proportional odds model for survival data</h2><span id='topic+weibullregpost'></span>

<h3>Description</h3>

<p>Computes the log posterior density of (log sigma, mu, beta) for a Weibull
proportional odds regression model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>weibullregpost(theta,data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="weibullregpost_+3A_theta">theta</code></td>
<td>
<p>vector of parameter values log sigma, mu, and beta</p>
</td></tr>
<tr><td><code id="weibullregpost_+3A_data">data</code></td>
<td>
<p>data matrix with columns survival time, censoring variable, and covariate matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>value of the log posterior
</p>


<h3>Author(s)</h3>

<p>Jim Albert</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(chemotherapy)
attach(chemotherapy)
d=cbind(time,status,treat-1,age)
theta=c(-.6,11,.6,0)
weibullregpost(theta,d)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
