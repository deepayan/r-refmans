<!DOCTYPE html><html><head><title>Help for package tsfknn</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {tsfknn}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#tsfknn-package'><p>tsfknn: Time Series Forecasting Using Nearest Neighbors</p></a></li>
<li><a href='#autoplot.knnForecast'><p>Create a ggplot object from a knnForecast object</p></a></li>
<li><a href='#knn_examples'><p>Examples of the model associated with a prediction</p></a></li>
<li><a href='#knn_forecasting'><p>Time series forecasting using KNN regression</p></a></li>
<li><a href='#n_training_examples'><p>Number of training examples</p></a></li>
<li><a href='#nearest_neighbors'><p>Nearest neighbors associated with predictions</p></a></li>
<li><a href='#plot.knnForecastRO'><p>Plot a prediction of a test set</p></a></li>
<li><a href='#predict.knnForecast'><p>Predict method for KNN models for time series forecasting.</p></a></li>
<li><a href='#rolling_origin'><p>Assessing forecasting accuracy with rolling origin</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Time Series Forecasting Using Nearest Neighbors</td>
</tr>
<tr>
<td>Version:</td>
<td>0.6.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Allows forecasting time series using nearest neighbors regression
    Francisco Martinez, Maria P. Frias, Maria D. Perez-Godoy and Antonio J.
    Rivera (2019) &lt;<a href="https://doi.org/10.1007%2Fs10462-017-9593-z">doi:10.1007/s10462-017-9593-z</a>&gt;. When the forecasting horizon
    is higher than 1, two multi-step ahead forecasting strategies can be used.
    The model built is autoregressive, that is, it is only based on the 
    observations of the time series. The nearest neighbors used in a prediction
    can be consulted and plotted.</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Francisco Martinez &lt;fmartin@ujaen.es&gt;</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2 (&ge; 3.1.1), graphics, Rcpp, stats, utils</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/franciscomartinezdelrio/tsfknn">https://github.com/franciscomartinezdelrio/tsfknn</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/franciscomartinezdelrio/tsfknn/issues">https://github.com/franciscomartinezdelrio/tsfknn/issues</a></td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-12-20 16:08:59 UTC; UJA</td>
</tr>
<tr>
<td>Author:</td>
<td>Francisco Martinez [aut, cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-12-20 16:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='tsfknn-package'>tsfknn: Time Series Forecasting Using Nearest Neighbors</h2><span id='topic+tsfknn'></span><span id='topic+tsfknn-package'></span>

<h3>Description</h3>

<p>Allows forecasting time series using nearest neighbors regression Francisco Martinez, Maria P. Frias, Maria D. Perez-Godoy and Antonio J. Rivera (2019) <a href="https://doi.org/10.1007/s10462-017-9593-z">doi:10.1007/s10462-017-9593-z</a>. When the forecasting horizon is higher than 1, two multi-step ahead forecasting strategies can be used. The model built is autoregressive, that is, it is only based on the observations of the time series. The nearest neighbors used in a prediction can be consulted and plotted.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Francisco Martinez <a href="mailto:fmartin@ujaen.es">fmartin@ujaen.es</a>
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/franciscomartinezdelrio/tsfknn">https://github.com/franciscomartinezdelrio/tsfknn</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/franciscomartinezdelrio/tsfknn/issues">https://github.com/franciscomartinezdelrio/tsfknn/issues</a>
</p>
</li></ul>


<hr>
<h2 id='autoplot.knnForecast'>Create a ggplot object from a knnForecast object</h2><span id='topic+autoplot.knnForecast'></span>

<h3>Description</h3>

<p>It uses a knnForecast object to create a ggplot object that plots a time
series and its forecast using KNN regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'knnForecast'
autoplot(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="autoplot.knnForecast_+3A_object">object</code></td>
<td>
<p>An object of class <code>knnForecast</code>.</p>
</td></tr>
<tr><td><code id="autoplot.knnForecast_+3A_...">...</code></td>
<td>
<p>additional parameter, see details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Commonly used parameters are:
</p>

<ul>
<li> <p><code>highlight</code>. A character string indicating what elements should be highlighted. Possible values are
<code>"none"</code>, <code>"points"</code> and <code>"neighbors"</code>. The default value is <code>"none"</code>.
</p>
</li>
<li> <p><code>faceting</code>. Logical. This applies only if the <code>highlight</code> parameter is
set to <code>"neighbors"</code>. It indicates whether the different nearest neighbors
should be seen in different plots (<code>TRUE</code>, the default value) or in one
plot.
</p>
</li></ul>



<h3>Value</h3>

<p>The ggplot object representing a plotting with the forecast.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pred &lt;- knn_forecasting(USAccDeaths, h = 12, lags = 1:12, k = 2)
library(ggplot2)
autoplot(pred)
autoplot(pred, highlight = "neighbors")
</code></pre>

<hr>
<h2 id='knn_examples'>Examples of the model associated with a prediction</h2><span id='topic+knn_examples'></span>

<h3>Description</h3>

<p>It allows to see the examples of the model associated to a
<code>knnForecast</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>knn_examples(forecast)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="knn_examples_+3A_forecast">forecast</code></td>
<td>
<p>A <code>knnForecast</code> object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix including the features and targets of the examples
associated with the model of a <code>knnForecast</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pred &lt;- knn_forecasting(ts(1:8), h = 1, lags = 1:2, k = 2)
knn_examples(pred)
</code></pre>

<hr>
<h2 id='knn_forecasting'>Time series forecasting using KNN regression</h2><span id='topic+knn_forecasting'></span>

<h3>Description</h3>

<p>It applies KNN regression to forecast the future values of a time series.
The lags used as autoregressive variables are set with the <code>lags</code>
parameter. If the user does not set the number of nearest neighbors or
the lags, these values are selected automatically.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>knn_forecasting(
  timeS,
  h,
  lags = NULL,
  k = c(3, 5, 7),
  msas = c("recursive", "MIMO"),
  cf = c("mean", "median", "weighted"),
  transform = c("additive", "multiplicative", "none")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="knn_forecasting_+3A_times">timeS</code></td>
<td>
<p>A numeric vector or time series of class <code>ts</code>.</p>
</td></tr>
<tr><td><code id="knn_forecasting_+3A_h">h</code></td>
<td>
<p>A positive integer. Number of values to forecast.</p>
</td></tr>
<tr><td><code id="knn_forecasting_+3A_lags">lags</code></td>
<td>
<p>An integer vector in increasing order expressing the lags used
as autoregressive variables.</p>
</td></tr>
<tr><td><code id="knn_forecasting_+3A_k">k</code></td>
<td>
<p>A positive integer. The k parameter in KNN regression. A vector of
k values can also be used. In that case, the forecast is the average
of the forecasts produced by the different models with the different k
parameters.</p>
</td></tr>
<tr><td><code id="knn_forecasting_+3A_msas">msas</code></td>
<td>
<p>A string indicating the Multiple-Step Ahead Strategy used when
more than one value is predicted. It can be &quot;recursive&quot; or &quot;MIMO&quot; (the
default).</p>
</td></tr>
<tr><td><code id="knn_forecasting_+3A_cf">cf</code></td>
<td>
<p>A string. It indicates the combination function used to aggregate
the targets associated with the nearest neighbors. It can be &quot;median&quot;,
&quot;weighted&quot; or &quot;mean&quot; (the default).</p>
</td></tr>
<tr><td><code id="knn_forecasting_+3A_transform">transform</code></td>
<td>
<p>A character value indicating whether the training samples
are transformed. If the time series has a trend it is recommended. By
default is <code>"multiplicative"</code> (multiplicative transformation). It is also
possible a multiplicative transformation or no transformation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>"knnForecast"</code>. The
function <code><a href="base.html#topic+summary">summary</a></code> can be used to obtain or print a
summary of the results.
</p>
<div class="sourceCode"><pre>An object of class \code{"knnForecast"} is a list containing at least
the following components:
</pre></div>
<table>
<tr><td><code>call</code></td>
<td>
<p>the matched call.</p>
</td></tr>
<tr><td><code>msas</code></td>
<td>
<p>the Multi-Step Ahead Strategy.</p>
</td></tr>
<tr><td><code>prediction</code></td>
<td>
<p>a time series with the forecast.</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>an object of class <code>"knnModel"</code> with the KNN
model</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>pred &lt;- knn_forecasting(USAccDeaths, h = 12, lags = 1:12, k = 2)
pred$prediction # To see a time series with the forecasts
plot(pred) # To see a plot with the forecast
</code></pre>

<hr>
<h2 id='n_training_examples'>Number of training examples</h2><span id='topic+n_training_examples'></span>

<h3>Description</h3>

<p>It computes the number of training examples that would have a KNN model
with the specified parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>n_training_examples(timeS, h, lags, msas = c("MIMO", "recursive"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="n_training_examples_+3A_times">timeS</code></td>
<td>
<p>A numeric vector or time series of class <code>ts</code>.</p>
</td></tr>
<tr><td><code id="n_training_examples_+3A_h">h</code></td>
<td>
<p>A positive integer. Number of values to forecast.</p>
</td></tr>
<tr><td><code id="n_training_examples_+3A_lags">lags</code></td>
<td>
<p>An integer vector in increasing order expressing the lags used
as autoregressive variables.</p>
</td></tr>
<tr><td><code id="n_training_examples_+3A_msas">msas</code></td>
<td>
<p>A string indicating the Multiple-Step Ahead Strategy used when
more than one value is predicted. It can be &quot;recursive&quot; or &quot;MIMO&quot; (the
default).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An integer.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n_training_examples(ts(1:10), h = 2, lags = 1:3, msas = "MIMO")
n_training_examples(ts(1:10), h = 2, lags = 1:3, msas = "recursive")
</code></pre>

<hr>
<h2 id='nearest_neighbors'>Nearest neighbors associated with predictions</h2><span id='topic+nearest_neighbors'></span>

<h3>Description</h3>

<p>It allows to check the new instances and their nearest neighbors used in a
prediction associated with a &quot;knnForecast&quot; object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nearest_neighbors(forecast)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nearest_neighbors_+3A_forecast">forecast</code></td>
<td>
<p>A <code>knnForecast</code> object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list including the new instances used in KNN regression and their
nearest neighbors.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pred &lt;- knn_forecasting(UKgas, h = 4, lags = 1:4, k = 2, msas = "MIMO")
nearest_neighbors(pred)
</code></pre>

<hr>
<h2 id='plot.knnForecastRO'>Plot a prediction of a test set</h2><span id='topic+plot.knnForecastRO'></span>

<h3>Description</h3>

<p>It uses a test set generated with the function <code><a href="#topic+rolling_origin">rolling_origin</a></code>
and plots its forecast.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'knnForecastRO'
plot(x, h = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.knnForecastRO_+3A_x">x</code></td>
<td>
<p>the object obtained from a call to <code><a href="#topic+rolling_origin">rolling_origin</a></code>.</p>
</td></tr>
<tr><td><code id="plot.knnForecastRO_+3A_h">h</code></td>
<td>
<p>an integer. The forecasting horizon. If <code>NULL</code>, the maximum
forecasting horizon of all the test sets is used.</p>
</td></tr>
<tr><td><code id="plot.knnForecastRO_+3A_...">...</code></td>
<td>
<p>Other plotting parameters to affect the plot.</p>
</td></tr>
</table>

<hr>
<h2 id='predict.knnForecast'>Predict method for KNN models for time series forecasting.</h2><span id='topic+predict.knnForecast'></span>

<h3>Description</h3>

<p>Predicted values based on a KNN model for time series forecasting.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'knnForecast'
predict(object, h, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.knnForecast_+3A_object">object</code></td>
<td>
<p>a <code>knnForecast</code> object obtained by a call to the
<code><a href="#topic+knn_forecasting">knn_forecasting</a></code> function.</p>
</td></tr>
<tr><td><code id="predict.knnForecast_+3A_h">h</code></td>
<td>
<p>an integer. The forecasting horizon.</p>
</td></tr>
<tr><td><code id="predict.knnForecast_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the models uses the MIMO strategy for multiple-step ahead prediction,
the forecasting horizon is fixed to the model forecasting horizon.
</p>


<h3>Value</h3>

<p>a <code>knnForecast</code> object with the prediction and information
about the KNN model, see the documentation of <code><a href="#topic+knn_forecasting">knn_forecasting</a></code>
for the structure of <code>knnForecast</code> objects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pred &lt;- knn_forecasting(UKgas, h = 4, k = 1, msas = "recursive")
new_pred &lt;- predict(pred, h = 6)
print(new_pred$prediction)
plot(new_pred) # To see a plot with the forecast

</code></pre>

<hr>
<h2 id='rolling_origin'>Assessing forecasting accuracy with rolling origin</h2><span id='topic+rolling_origin'></span>

<h3>Description</h3>

<p>It uses the model and the time series associated with the <code>knnForecast</code>
object to asses the forecasting accuracy of the model using the last
<code>h</code> values of the time series to build test sets applying a rolling
origin evaluation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rolling_origin(knnf, h = NULL, rolling = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rolling_origin_+3A_knnf">knnf</code></td>
<td>
<p>A <code>knnForecast</code> object.</p>
</td></tr>
<tr><td><code id="rolling_origin_+3A_h">h</code></td>
<td>
<p>A positive integer. The forecast horizon. If <code>NULL</code> the
prediction horizon of the <code>knnForecast</code> object is used.</p>
</td></tr>
<tr><td><code id="rolling_origin_+3A_rolling">rolling</code></td>
<td>
<p>A logical. If <code>TRUE</code> (the default), forecasting
horizons from 1 to <code>h</code> are used. Otherwise, only horizon
<code>h</code> is used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function assesses the forecast accuracy of the model used by the
<code>knnForecast</code> object. It uses <code>h</code> different test and training
sets. The first test set consists of the last <code>h</code> values of the time
series (the training set is formed by the previous values). The next test
set consists of the last <code class="reqn">h - 1</code> values of the time series and so on
(the last test set is formed by the last value of the time series).
</p>


<h3>Value</h3>

<p>A list containing at least the following fields:
</p>
<table>
<tr><td><code>test_sets</code></td>
<td>
<p>a matrix containing the test sets used in the
evaluation. Every row contains a different test set.</p>
</td></tr>
<tr><td><code>predictions</code></td>
<td>
<p>The predictions for the test sets.</p>
</td></tr>
<tr><td><code>errors</code></td>
<td>
<p>The errors for the test sets.</p>
</td></tr>
<tr><td><code>global_accu</code></td>
<td>
<p>Different measures of accuracy applied to all the
errors.</p>
</td></tr>
<tr><td><code>h_accu</code></td>
<td>
<p>Different measures of accuracy applied to all the
errors for every forecasting horizon.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>pred &lt;- knn_forecasting(UKgas, h = 4, lags = 1:4, k = 2)
ro &lt;- rolling_origin(pred)
print(ro$global_accu)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
