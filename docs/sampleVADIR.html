<!DOCTYPE html><html><head><title>Help for package sampleVADIR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {sampleVADIR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#checkData'><p>Compare old and new versions of VADIR to find repeats</p></a></li>
<li><a href='#fixTypos'><p>Fix typos in VADIR dataset</p></a></li>
<li><a href='#getData'><p>Data import function to accommodate multiple filetypes</p></a></li>
<li><a href='#rankDat'><p>Rank to pay grade data</p></a></li>
<li><a href='#sampleVADIR'><p>Draw stratified samples from VADIR database</p></a></li>
<li><a href='#testStrata'><p>Return correlations for demographics between population and sample</p></a></li>
<li><a href='#VADIR_fake'><p>Fake VADIR data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Draw Stratified Samples from the VADIR Database</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Trevor Swanson &lt;trevorswanson222@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Affords researchers the ability to draw stratified samples from the U.S. Department of Veteran's Affairs/Department of Defense Identity Repository (VADIR) database according to a variety of population characteristics. The VADIR database contains information for all veterans who were separated from the military after 1980. The central utility of the present package is to integrate data cleaning and formatting for the VADIR database with the stratification methods described by Mahto (2019) <a href="https://CRAN.R-project.org/package=splitstackshape">https://CRAN.R-project.org/package=splitstackshape</a>. Data from VADIR are not provided as part of this package.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/tswanson222/sampleVADIR">https://github.com/tswanson222/sampleVADIR</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/tswanson222/sampleVADIR/issues">https://github.com/tswanson222/sampleVADIR/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Imports:</td>
<td>lubridate, methods, splitstackshape</td>
</tr>
<tr>
<td>Suggests:</td>
<td>haven, rio</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-10-27 03:47:44 UTC; t092s958@home.ku.edu</td>
</tr>
<tr>
<td>Author:</td>
<td>Trevor Swanson [aut, cre],
  Kelsie Forbush [aut],
  Joanna Wiese [ctb],
  Melinda Gaddy [ctb],
  Mary Oehlert [ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-10-27 14:40:04 UTC</td>
</tr>
</table>
<hr>
<h2 id='checkData'>Compare old and new versions of VADIR to find repeats</h2><span id='topic+checkData'></span>

<h3>Description</h3>

<p>Can be used to identify whether a new version of VADIR contains any old
responses. Can also automatically remove repeated responses.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>checkData(old, new, fix = FALSE, dates = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="checkData_+3A_old">old</code></td>
<td>
<p>Past version of VADIR</p>
</td></tr>
<tr><td><code id="checkData_+3A_new">new</code></td>
<td>
<p>New version of VADIR</p>
</td></tr>
<tr><td><code id="checkData_+3A_fix">fix</code></td>
<td>
<p>Logical. Determines whether to automatically remove repeated
responses.</p>
</td></tr>
<tr><td><code id="checkData_+3A_dates">dates</code></td>
<td>
<p>Logical. Determines whether to include date variables when
comparing datasets. Recommended to keep <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a message that no repeated responses exist if there are none.
Otherwise, returns either a warning that repeated responses exist, or
returns the new VADIR dataset without repeated responses if <code>fix =
  TRUE</code>.
</p>

<hr>
<h2 id='fixTypos'>Fix typos in VADIR dataset</h2><span id='topic+fixTypos'></span>

<h3>Description</h3>

<p>If there are known typos, the correct values of those incorrect responses can
be provided and fixed across the dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fixTypos(data, old, new = NULL, var = "RANK_CD")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fixTypos_+3A_data">data</code></td>
<td>
<p>VADIR dataset</p>
</td></tr>
<tr><td><code id="fixTypos_+3A_old">old</code></td>
<td>
<p>Character vector containing typos</p>
</td></tr>
<tr><td><code id="fixTypos_+3A_new">new</code></td>
<td>
<p>Character vector in the same order as <code>old</code>, containing
corresponding values to fix typos to.</p>
</td></tr>
<tr><td><code id="fixTypos_+3A_var">var</code></td>
<td>
<p>Variable name for which typos should be corrected</p>
</td></tr>
</table>


<h3>Value</h3>

<p>VADIR dataset with typos corrected
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- fixTypos(data = VADIR_fake, old = c('CW02', 'CW0-2', 'PV1'),
                 new = c('CWO2', 'CWO2', 'PVT'), var = 'RANK_CD')
</code></pre>

<hr>
<h2 id='getData'>Data import function to accommodate multiple filetypes</h2><span id='topic+getData'></span>

<h3>Description</h3>

<p>Allows for easy data importation. Automatically detects filetype and applies
appropriate function for importing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getData(filename, filetype = "csv", fixDates = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getData_+3A_filename">filename</code></td>
<td>
<p>Character string specifying the path to desired datafile</p>
</td></tr>
<tr><td><code id="getData_+3A_filetype">filetype</code></td>
<td>
<p>Character string indicating filetype. Useful if no file
extension is provided in <code>filename</code>. If file extension is provided in
<code>filename</code> (recommended), then this argument is ignored. Accommodates
<code>"csv", "rds", "xlsx", "rdata", "sav", "txt"</code></p>
</td></tr>
<tr><td><code id="getData_+3A_fixdates">fixDates</code></td>
<td>
<p>Logical. Determines whether to adjust date format.</p>
</td></tr>
<tr><td><code id="getData_+3A_...">...</code></td>
<td>
<p>Additional arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Imported datafile
</p>

<hr>
<h2 id='rankDat'>Rank to pay grade data</h2><span id='topic+rankDat'></span>

<h3>Description</h3>

<p>Serves as a key for relating certain military rank designations with pay
grades. Used in the <code><a href="#topic+sampleVADIR">sampleVADIR</a></code> function for stratifying based on pay
grade rather than rank.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rankDat
</code></pre>


<h3>Format</h3>

<p>A data frame with six variables that links pay grades to military
ranks within each military branch. <code>PayGrade</code> indicates the pay grade
associated with a specific job title (<code>Title</code>) within a given
<code>Branch</code> of the military. <code>Title</code> designates the job title, where
<code>Initials</code> is the shorthand for each title (this is how the
<code>RANK_CD</code> variable is coded in the VADIR dataset). <code>Branch</code>
designates the military branch, where <code>"N"</code> stands for Navy, <code>"A"</code>
stands for Army, <code>"M"</code> stands for Marines, and <code>"F"</code> stands for
Air Force. <code>PayCat4</code> represents one coding scheme that categorizes
different pay grades into four categories, where <code>"E"</code> stands for
enlisted, <code>"NCO"</code> stands for non-commissioned officer, <code>"W"</code>
stands for warrant officer, and <code>"O"</code> stands for commissioned officer.
<code>PayCat7</code> represents an alternative categorization that breaks pay
grades into seven categories, wherein <code>"SNCO"</code> stands for senior
non-commissioned officer, <code>"FGO"</code> stands for field grade officer,
<code>"CGO"</code> stands for company grade officer, and <code>"GO"</code> stands for
general officer.
</p>


<h3>Details</h3>

<p>The way these data are used in the <code><a href="#topic+sampleVADIR">sampleVADIR</a></code> function is by
indexing the values of the <code>RANK_CD</code> variable of the VADIR dataset
against the <code>Initials</code> variable in the present dataset, and then the
<code>RANK_CD</code> value is replaced with the associated value in either the
<code>PayCat4</code> or <code>PayCat7</code> variable depending on what is specified in
the <code><a href="#topic+sampleVADIR">sampleVADIR</a></code> function. The purpose of this is to make the
<code>RANK_CD</code> variable more amenable to stratification, given the difficultly
of stratifying across values of a categorical variable with so many unique
values.
</p>

<hr>
<h2 id='sampleVADIR'>Draw stratified samples from VADIR database</h2><span id='topic+sampleVADIR'></span>

<h3>Description</h3>

<p>Core function used to pull a stratified sample from VADIR based on a variety
of parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sampleVADIR(
  data,
  n = 4500,
  vars = "all",
  rankDat = "rankDat",
  payRanks = 4,
  post911 = TRUE,
  dischargedAfter = FALSE,
  until = NULL,
  ageDischarge = TRUE,
  ageEnlist = FALSE,
  ageNow = FALSE,
  yearsServed = FALSE,
  dateformat = "%m/%d/%Y",
  params = NULL,
  formats = "default",
  typos = list(),
  rmDeviates = FALSE,
  timeCats = FALSE,
  saveData = TRUE,
  onlyIDs = FALSE,
  oversample = FALSE,
  exclude = FALSE,
  seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sampleVADIR_+3A_data">data</code></td>
<td>
<p>VADIR dataset</p>
</td></tr>
<tr><td><code id="sampleVADIR_+3A_n">n</code></td>
<td>
<p>Total desired sample size</p>
</td></tr>
<tr><td><code id="sampleVADIR_+3A_vars">vars</code></td>
<td>
<p>Character vector indicating which variables to use in
stratification</p>
</td></tr>
<tr><td><code id="sampleVADIR_+3A_rankdat">rankDat</code></td>
<td>
<p>Dataset linking ranks to pay grade, or character string
indicating where to pull that dataset from. Recommended to leave as
<code>"rankDat"</code> in order to use package-supplied dataset.</p>
</td></tr>
<tr><td><code id="sampleVADIR_+3A_payranks">payRanks</code></td>
<td>
<p>Number of pay grades to use when converting rank variable.
Only options are either 4 or 7.</p>
</td></tr>
<tr><td><code id="sampleVADIR_+3A_post911">post911</code></td>
<td>
<p>Logical. Determines whether to only consider individuals
deployed after 9/11/2001</p>
</td></tr>
<tr><td><code id="sampleVADIR_+3A_dischargedafter">dischargedAfter</code></td>
<td>
<p>Character string indicating what date to restrict
sampling to based on discharge date. Can set to <code>FALSE</code> if this is to
be ignored. Can also set to <code>'past-year'</code> in order to only sample
people who were discharged within the past year (given the current date).</p>
</td></tr>
<tr><td><code id="sampleVADIR_+3A_until">until</code></td>
<td>
<p>Upper limit to when service was started. <code>NULL</code> means there
is no upper limit</p>
</td></tr>
<tr><td><code id="sampleVADIR_+3A_agedischarge">ageDischarge</code></td>
<td>
<p>Logical. Determines whether to use age at discharge as a
stratum.</p>
</td></tr>
<tr><td><code id="sampleVADIR_+3A_ageenlist">ageEnlist</code></td>
<td>
<p>Logical. Determines whether to use age at enlist as a
stratum.</p>
</td></tr>
<tr><td><code id="sampleVADIR_+3A_agenow">ageNow</code></td>
<td>
<p>Logical. Determines whether to use current age as a stratum.</p>
</td></tr>
<tr><td><code id="sampleVADIR_+3A_yearsserved">yearsServed</code></td>
<td>
<p>Logical. Determines whether to use total years served as a
stratum.</p>
</td></tr>
<tr><td><code id="sampleVADIR_+3A_dateformat">dateformat</code></td>
<td>
<p>Character string indicating the expected date format.
Should be automatically detected.</p>
</td></tr>
<tr><td><code id="sampleVADIR_+3A_params">params</code></td>
<td>
<p>Optional list of parameters to override defaults in function.
Creates an easy way to interface with the function if performing the
stratification multiple times. Allows the user to avoid writing the same
arguments multiple times.</p>
</td></tr>
<tr><td><code id="sampleVADIR_+3A_formats">formats</code></td>
<td>
<p>Should be <code>"default"</code></p>
</td></tr>
<tr><td><code id="sampleVADIR_+3A_typos">typos</code></td>
<td>
<p>List containing typos to be fixed, as well as what they should
be changed to. Leave at <code>list()</code> to ignore. Typos can also be fixed
prior to stratification by using the <code><a href="#topic+fixTypos">fixTypos</a></code> function.</p>
</td></tr>
<tr><td><code id="sampleVADIR_+3A_rmdeviates">rmDeviates</code></td>
<td>
<p>Logical. Determines whether rows with unexpected response
values are removed. If <code>FALSE</code>, and deviate response values are
detected, the function will stop.</p>
</td></tr>
<tr><td><code id="sampleVADIR_+3A_timecats">timeCats</code></td>
<td>
<p>Logical or numeric. Determines whether the time-related
variables should be treated as categorical variables. If <code>TRUE</code>, this
defaults to 4.</p>
</td></tr>
<tr><td><code id="sampleVADIR_+3A_savedata">saveData</code></td>
<td>
<p>Logical. Determines whether to save the full dataset in the
output. Specifically, returns the full dataset of candidates (i.e., some
people may be removed from consideration due to errors or unexpected
responses).</p>
</td></tr>
<tr><td><code id="sampleVADIR_+3A_onlyids">onlyIDs</code></td>
<td>
<p>Logical. Determines whether to only return ID values for
selected individuals rather than a full dataset.</p>
</td></tr>
<tr><td><code id="sampleVADIR_+3A_oversample">oversample</code></td>
<td>
<p>Logical. Determines whether to oversample or undersample
based on limitations due to available proportions of strata in subsample.</p>
</td></tr>
<tr><td><code id="sampleVADIR_+3A_exclude">exclude</code></td>
<td>
<p>Logical. Determines whether to exclude people missing a zip
code, as well as people with <code>"NTC"</code> as their zip code value.</p>
</td></tr>
<tr><td><code id="sampleVADIR_+3A_seed">seed</code></td>
<td>
<p>Numeric value indicating the seed to set for the stratification
procedure. Allows for reproducible results.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Performs stratification separately for males and females, where males and
females are sampled at a 1:1 ratio, regardless of population ratio.
</p>
<p>With a large dataset (which is typical for VADIR), setting any of the
date-related variables to <code>TRUE</code> can drastically increase computation
time. The relevant arguments include: <code>ageDischarge, ageEnlist, ageNow,
yearsServed</code>.
</p>


<h3>Value</h3>

<p>A list containing the males and females who were sampled from VADIR
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
params &lt;- list(
  n = 7000,
  vars = c('PN_Sex_CD', 'PN_BRTH_DT', 'SVC_CD', 'PNL_CAT_CD', 'RANK_CD',
           'PNL_TERM_DT', 'PNL_BGN_DT', 'OMB_RACE_CD',
           'OMB_ETHNC_NAT_ORIG_CD', 'POST_911_DPLY_IND_CD'),
  rankDat = 'rankDat',
  payRanks = 4,
  post911 = FALSE,
  until = NULL,
  dischargedAfter = FALSE,
  ageDischarge = TRUE,
  ageEnlist = FALSE,
  ageNow = FALSE,
  yearsServed = FALSE,
  dateformat = '%m/%d/%Y',
  formats = 'default',
  rmDeviates = FALSE,
  timeCats = TRUE,
  saveData = TRUE,
  onlyIDs = FALSE,
  oversample = TRUE,
  exclude = FALSE,
  typos = list()
)

out &lt;- sampleVADIR(VADIR_fake, params = params, seed = 19)

</code></pre>

<hr>
<h2 id='testStrata'>Return correlations for demographics between population and sample</h2><span id='topic+testStrata'></span>

<h3>Description</h3>

<p>Used to evaluate the representativeness of the sample with regard to the
population. Males and females evaluated separately.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>testStrata(out, data = NULL, metric = cor, zeros = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="testStrata_+3A_out">out</code></td>
<td>
<p>Output of <code><a href="#topic+sampleVADIR">sampleVADIR</a></code></p>
</td></tr>
<tr><td><code id="testStrata_+3A_data">data</code></td>
<td>
<p>Original VADIR data</p>
</td></tr>
<tr><td><code id="testStrata_+3A_metric">metric</code></td>
<td>
<p>Function for measuring similarity between population and sample</p>
</td></tr>
<tr><td><code id="testStrata_+3A_zeros">zeros</code></td>
<td>
<p>Should empty strata be included?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Similarity values for males and females
</p>

<hr>
<h2 id='VADIR_fake'>Fake VADIR data</h2><span id='topic+VADIR_fake'></span>

<h3>Description</h3>

<p>Simulated VADIR data based solely on the variable names and appropriate
response options for each. Values of variables were generated based on
population proportions identified in a subsample of approximately 140,000
veterans from a version of the VADIR database obtained in 2020. However, this
simulated dataset does not fully represent population characteristics of
VADIR, and is simply meant as a faux tool for testing functions in the
<code>sampleVADIR</code> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>VADIR_fake
</code></pre>


<h3>Format</h3>

<p>A data frame with ten variables, representing variables as they are
formatted within the actual VADIR database.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
