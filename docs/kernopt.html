<!DOCTYPE html><html lang="en"><head><title>Help for package kernopt</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {kernopt}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cv_bandwidth'><p>Cross-Validation function for bandwidth parameter selection of discrete</p>
kernel</a></li>
<li><a href='#discrete_binomial'><p>Discrete binomial kernel</p></a></li>
<li><a href='#discrete_epanech'><p>Discrete Epanechnikov kernel</p></a></li>
<li><a href='#discrete_kernel'><p>Discrete kernel function</p></a></li>
<li><a href='#discrete_optimal'><p>Discrete optimal kernel</p></a></li>
<li><a href='#discrete_triang'><p>Discrete triangular kernel</p></a></li>
<li><a href='#estim_kernel'><p>Discrete Kernel Density Estimator</p></a></li>
<li><a href='#fish_data'><p>Fish dataset from the SIMTAP project</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Estimating Count Data Distributions with Discrete Optimal
Symmetric Kernel</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Thomas Fillon &lt;thomas.fillon@univ-ubs.fr&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Implementation of Discrete Symmetric Optimal Kernel for estimating count data distributions, as described by T. Senga Kiessé and G. Durrieu (2024) &lt;<a href="https://doi.org/10.1016%2Fj.spl.2024.110078">doi:10.1016/j.spl.2024.110078</a>&gt;.The nonparametric estimator using the discrete symmetric optimal kernel was illustrated on simulated data sets and a real-word data set included in the package, in comparison with two other discrete symmetric kernels.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://thomasfillon.github.io/kernopt/">https://thomasfillon.github.io/kernopt/</a>,
<a href="https://github.com/thomasfillon/kernopt">https://github.com/thomasfillon/kernopt</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/thomasfillon/kernopt/issues">https://github.com/thomasfillon/kernopt/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-03-18 14:11:14 UTC; rstudio</td>
</tr>
<tr>
<td>Author:</td>
<td>Tristan Senga Kiesse
    <a href="https://orcid.org/0000-0003-2710-5825"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Gilles Durrieu <a href="https://orcid.org/0000-0003-0375-912X"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Thomas Fillon <a href="https://orcid.org/0000-0003-1207-8414"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  INRAE, Institut Agro, CNRS - UMR SAS [cph],
  Université de Bretagne Sud, CNRS - UMR 6205 LMBA [cph]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-03-19 13:20:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='cv_bandwidth'>Cross-Validation function for bandwidth parameter selection of discrete
kernel</h2><span id='topic+cv_bandwidth'></span>

<h3>Description</h3>

<p>Cross-Validation function for bandwidth parameter selection of discrete
kernel
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cv_bandwidth(
  kernel = c("optimal", "triang", "epanech", "binomial"),
  v,
  h,
  k = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cv_bandwidth_+3A_kernel">kernel</code></td>
<td>
<p>the type of kernel. Currently supported kernels are limited to:
&quot;optimal&quot;, &quot;triang&quot;, &quot;epanech&quot; and &quot;binomial&quot;</p>
</td></tr>
<tr><td><code id="cv_bandwidth_+3A_v">v</code></td>
<td>
<p>the vector of observations</p>
</td></tr>
<tr><td><code id="cv_bandwidth_+3A_h">h</code></td>
<td>
<p>the list of bandwidth parameters to test in cross validation</p>
</td></tr>
<tr><td><code id="cv_bandwidth_+3A_k">k</code></td>
<td>
<p>Optional: the integer (positive) parameter that defined the support
of the kernel function (corresponds to parameter 'a' for triangular
kernel). It is only used for optimal and triangular kernel</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the optimal bandwidth value
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n &lt;- 250
mu &lt;- 2 # Mean
y &lt;- sort(rpois(n, mu))
# kernel support parameter
k &lt;- 1
H &lt;- seq((max(y) - min(y)) / 200, (max(y) - min(y)) / 2, length.out = 50)
hcv &lt;- cv_bandwidth(kernel = "optimal", y, h = H, k = k)
</code></pre>

<hr>
<h2 id='discrete_binomial'>Discrete binomial kernel</h2><span id='topic+discrete_binomial'></span>

<h3>Description</h3>

<p>Discrete binomial kernel
</p>


<h3>Usage</h3>

<pre><code class='language-R'>discrete_binomial(x, z, h)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="discrete_binomial_+3A_x">x</code></td>
<td>
<p>the target point at which the density is calculated</p>
</td></tr>
<tr><td><code id="discrete_binomial_+3A_z">z</code></td>
<td>
<p>the vector of observations</p>
</td></tr>
<tr><td><code id="discrete_binomial_+3A_h">h</code></td>
<td>
<p>the bandwidth (or smoothing parameter) which should match the
condition 0&lt;= h &lt; 1</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the value of the associated kernel function according to the
target x and the bandwidth h.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Basic usage of discrete_binomial() to compute a Discrete Binomial Kernel
discrete_binomial(x = 25, z = 1:50, h = 0.5)
</code></pre>

<hr>
<h2 id='discrete_epanech'>Discrete Epanechnikov kernel</h2><span id='topic+discrete_epanech'></span>

<h3>Description</h3>

<p>Discrete Epanechnikov kernel
</p>


<h3>Usage</h3>

<pre><code class='language-R'>discrete_epanech(x, z, h)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="discrete_epanech_+3A_x">x</code></td>
<td>
<p>the target point at which the density is calculated</p>
</td></tr>
<tr><td><code id="discrete_epanech_+3A_z">z</code></td>
<td>
<p>the vector of observations</p>
</td></tr>
<tr><td><code id="discrete_epanech_+3A_h">h</code></td>
<td>
<p>the bandwidth (or smoothing parameter)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the value of the associated kernel function according to the
target x and the bandwidth h.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Basic usage of discrete_epanech() to compute a discrete Epanechnikov kernel
discrete_epanech(x = 25, z = 1:50, h = 20)

</code></pre>

<hr>
<h2 id='discrete_kernel'>Discrete kernel function</h2><span id='topic+discrete_kernel'></span>

<h3>Description</h3>

<p>Discrete kernel function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>discrete_kernel(
  kernel = c("optimal", "triang", "epanech", "binomial"),
  x,
  z,
  h,
  k = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="discrete_kernel_+3A_kernel">kernel</code></td>
<td>
<p>the type of kernel. Currently supported kernels are limited to:
&quot;optimal&quot;, &quot;triang&quot;, &quot;epanech&quot; and &quot;binomial&quot;</p>
</td></tr>
<tr><td><code id="discrete_kernel_+3A_x">x</code></td>
<td>
<p>the target point at which the density is calculated</p>
</td></tr>
<tr><td><code id="discrete_kernel_+3A_z">z</code></td>
<td>
<p>the vector of observations</p>
</td></tr>
<tr><td><code id="discrete_kernel_+3A_h">h</code></td>
<td>
<p>the bandwidth (or smoothing parameter)</p>
</td></tr>
<tr><td><code id="discrete_kernel_+3A_k">k</code></td>
<td>
<p>Optional: the integer (positive) parameter that defined the support
of the kernel function (corresponds to parameter 'a' for triangular
kernel). It is only used for optimal and triangular kernel</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the value of the associated kernel function
</p>


<h3>See Also</h3>

<p><code><a href="#topic+discrete_optimal">discrete_optimal()</a></code>, <code><a href="#topic+discrete_triang">discrete_triang()</a></code>, <code><a href="#topic+discrete_epanech">discrete_epanech()</a></code>,
<code><a href="#topic+discrete_binomial">discrete_binomial()</a></code>  which this function wraps.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>discrete_kernel(kernel = "optimal", x = 25, z = 1:50, h = 0.9, k = 20)
discrete_kernel(kernel = "triang", x = 25, z = 1:50, h = 10, k = 20)
discrete_kernel(kernel = "epanech", x = 25, z = 1:50, h = 20)
discrete_kernel(kernel = "binomial", x = 25, z = 1:50, h = 0.5)
</code></pre>

<hr>
<h2 id='discrete_optimal'>Discrete optimal kernel</h2><span id='topic+discrete_optimal'></span>

<h3>Description</h3>

<p>Discrete optimal kernel
</p>


<h3>Usage</h3>

<pre><code class='language-R'>discrete_optimal(x, z, h, k)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="discrete_optimal_+3A_x">x</code></td>
<td>
<p>the target point at which the density is calculated</p>
</td></tr>
<tr><td><code id="discrete_optimal_+3A_z">z</code></td>
<td>
<p>the vector of observations</p>
</td></tr>
<tr><td><code id="discrete_optimal_+3A_h">h</code></td>
<td>
<p>the bandwidth (or smoothing parameter), which should match the
condition (3 / 5) * (1 - 1 / k)) &lt; h &lt; 1</p>
</td></tr>
<tr><td><code id="discrete_optimal_+3A_k">k</code></td>
<td>
<p>the integer (positive) parameter that defined the support of
the kernel function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the value of the associated kernel function according to
the target x and the bandwidth h.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>discrete_optimal(x = 25, z = 1:50, h = 0.9, k = 20)

</code></pre>

<hr>
<h2 id='discrete_triang'>Discrete triangular kernel</h2><span id='topic+discrete_triang'></span>

<h3>Description</h3>

<p>Discrete triangular kernel
</p>


<h3>Usage</h3>

<pre><code class='language-R'>discrete_triang(x, z, h, a)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="discrete_triang_+3A_x">x</code></td>
<td>
<p>the target point at which the density is calculated</p>
</td></tr>
<tr><td><code id="discrete_triang_+3A_z">z</code></td>
<td>
<p>the vector of observations</p>
</td></tr>
<tr><td><code id="discrete_triang_+3A_h">h</code></td>
<td>
<p>the bandwidth (or smoothing parameter)</p>
</td></tr>
<tr><td><code id="discrete_triang_+3A_a">a</code></td>
<td>
<p>the integer (positive) parameter that defined the support
of the kernel function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the value of the associated kernel function according
to the target x and the bandwidth h.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Basic usage of discrete_triang() to compute a Discrete triangular kernel
discrete_triang(x = 25, z = 1:50, h = 10, a = 20)

</code></pre>

<hr>
<h2 id='estim_kernel'>Discrete Kernel Density Estimator</h2><span id='topic+estim_kernel'></span>

<h3>Description</h3>

<p>Discrete Kernel Density Estimator
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estim_kernel(
  kernel = c("optimal", "triang", "epanech", "binomial"),
  x,
  h,
  v,
  k = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="estim_kernel_+3A_kernel">kernel</code></td>
<td>
<p>the type of kernel. Currently supported kernels are limited to:
&quot;optimal&quot;, &quot;triang&quot;, &quot;epanech&quot; and &quot;binomial&quot;</p>
</td></tr>
<tr><td><code id="estim_kernel_+3A_x">x</code></td>
<td>
<p>the list of target points at which the density is calculated</p>
</td></tr>
<tr><td><code id="estim_kernel_+3A_h">h</code></td>
<td>
<p>the bandwidth (or smoothing parameter)</p>
</td></tr>
<tr><td><code id="estim_kernel_+3A_v">v</code></td>
<td>
<p>the vector of observations</p>
</td></tr>
<tr><td><code id="estim_kernel_+3A_k">k</code></td>
<td>
<p>Optional: the integer (positive) parameter that defined the support
of the kernel function (corresponds to parameter 'a' for triangular
kernel). It is only used for optimal and triangular kernel</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The estimated discrete kernel density values
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n &lt;- 250
mu &lt;- 2 # Mean
x &lt;- 0:10 # target values
y &lt;- sort(rpois(n, mu)) # simulated Poisson observations
# kernel parameters
kernel &lt;- "optimal"
k &lt;- 1
# Cross Validation
H &lt;- seq((max(y) - min(y)) / 200, (max(y) - min(y)) / 2, length.out = 50)
hcv &lt;- cv_bandwidth(kernel = kernel, y, h = H, k = k)
# Kernel estimation
fn_opt_k &lt;- estim_kernel(kernel = kernel, x = x, h = hcv, v = y, k = k)
</code></pre>

<hr>
<h2 id='fish_data'>Fish dataset from the SIMTAP project</h2><span id='topic+fish_data'></span>

<h3>Description</h3>

<p>The SIMTAP project (Self-sufficient Integrated Multi-Trophic AquaPonic
systems)  aimed to develop sustainable aquaculture production system
that, in particular, contributes to reduce fish feed inputs and
resources consumption. We used data from an experiment in which gilthead
seabream (sparus aurata) were stocked in 1.6 m3 tanks at a density
of 1.5 kg·m-3 .
Fish were reared for 46 days in a single recirculating aquaculture system
composed of three rearing tanks. At the beginning of the experiment, a number
n =200 of the fish were individually weighed (dg), and their length
at the caudal fork (mm) was measured.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fish_data
</code></pre>


<h3>Format</h3>



<h4><code>fish_data</code></h4>

<p>A data frame with 200 rows and 2 columns:
</p>

<dl>
<dt>length</dt><dd><p>Length in mm</p>
</dd>
<dt>weight</dt><dd><p>Weight in dg</p>
</dd>
</dl>
<p>...

</p>



<h3>Source</h3>

<p><a href="https://www.simtap.eu">https://www.simtap.eu</a>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
