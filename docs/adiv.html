<!DOCTYPE html><html lang="en"><head><title>Help for package adiv</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {adiv}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#adiv-package'>
<p>Analysis of Diversity</p></a></li>
<li><a href='#abgdivparam'>
<p>Apportionment of Parametric Indices of Diversity</p></a></li>
<li><a href='#abgevodivparam'>
<p>Apportionment of Parametric Indices of Phylogenetic Diversity</p></a></li>
<li><a href='#aptree'>
<p>Hierarchical Partitioning of Evolutionary and Ecological Patterns in the Organization of Phylogenetically-Structured Species Assemblages</p></a></li>
<li><a href='#batcomm'>
<p>Bat Abundance and Phylogeny Along a Disturbance Gradient in a Neotropical Rainforest</p></a></li>
<li><a href='#betastat'>
<p>Multiple-Site Dissimilarity Measure for Species Presence/Absence</p>
Data</a></li>
<li><a href='#betaTreeUniqueness'><p>Plot-to-plot functional or phylogenetic dissimilarity and uniqueness</p></a></li>
<li><a href='#betaUniqueness'><p>Algorithmic index of plot-to-plot functional (or phylogenetic) dissimilarity and uniqueness</p></a></li>
<li><a href='#birdData'>
<p>Avian Communities along Successional Forest Gradients</p></a></li>
<li><a href='#CF'>
<p>Matrices of Intra- and Inter-Specific Similarities</p></a></li>
<li><a href='#crossdpcoa'>
<p>Crossed-DPCoA</p></a></li>
<li><a href='#dbMANOVAspecies'><p>Indicator species analysis in the framework of multivariate analysis of variance</p></a></li>
<li><a href='#decdiv'>
<p>Decomposition of trait-based diversity along the nodes of a phylogenetic tree</p></a></li>
<li><a href='#dislptransport'><p>Algorithmic index of plot-to-plot functional (or phylogenetic) dissimilarity</p></a></li>
<li><a href='#dissABC'>
<p>Phylogenetic and Functional Similarity between Communities</p></a></li>
<li><a href='#dissRicotta'>
<p>Plot-to-Plot Functional or Phylogenetic Dissimilarity</p></a></li>
<li><a href='#distinctAb'>
<p>Abundance-based measures of species' rarity, functional or phylogenetic distinctiveness and functional or phylogenetic effective originality</p></a></li>
<li><a href='#distinctDis'>
<p>Dissimilarity-based Species' Originality</p></a></li>
<li><a href='#distinctTopo'>
<p>Topology-based Species' Originality</p></a></li>
<li><a href='#distinctTree'>
<p>Tree-based Species' Originality</p></a></li>
<li><a href='#distinctUltra'>
<p>Ultrametric Tree-based Species' Originality</p></a></li>
<li><a href='#distMS'>
<p>Marczewski-Steinhaus Coefficient</p></a></li>
<li><a href='#divparam'>
<p>Parametric Indices of Species Diversity</p></a></li>
<li><a href='#DP'><p>Plot-to-plot functional or phylogenetic dissimilarity</p></a></li>
<li><a href='#dsimcom'>
<p>Functional or Phylogenetic Similarity between Species and Communities</p></a></li>
<li><a href='#dspca'>
<p>Double similarity principal component analysis</p></a></li>
<li><a href='#EH'>
<p>Faith Phylogenetic Diversity</p></a></li>
<li><a href='#EqRao'>
<p>Apportionment of Diversity</p></a></li>
<li><a href='#eveparam'>
<p>Parametric Indices of Species Evenness</p></a></li>
<li><a href='#evoCA'>
<p>Evolutionary Correspondence Analysis</p></a></li>
<li><a href='#evodiss'>
<p>Pair-wise Phylogenetic Dissimilarities between Communities</p></a></li>
<li><a href='#evodiss_family'>
<p>A Family of Indices Dedicated to Pair-wise Phylogenetic Dissimilarities between Communities</p></a></li>
<li><a href='#evodiv'>
<p>Indices of Phylogenetic Diversity</p></a></li>
<li><a href='#evodivparam'>
<p>Parametric Indices of Phylogenetic Diversity</p></a></li>
<li><a href='#evoeveparam'>
<p>Parametric Indices of Phylogenetic evenness</p></a></li>
<li><a href='#evoNSCA'>
<p>Evolutionary Non-Symmetric Correspondence Analysis</p></a></li>
<li><a href='#evopca'>
<p>Evolutionary Principal Component analyses</p></a></li>
<li><a href='#evouniparam'>
<p>Parametric Indices of Phylogenetic Uniqueness</p></a></li>
<li><a href='#FPdivparam'>
<p>Parametric Indices of Functional and Phylogenetic Diversity</p></a></li>
<li><a href='#FunImbalance'><p>Indices of functional imbalance</p></a></li>
<li><a href='#generalized_Tradidiss'>
<p>Plot-to-plot dissimilarity taking account of functional dissimilarities between species</p></a></li>
<li><a href='#K'>
<p>Indices K, Kstar and Kw of Phylogenetic Signal</p></a></li>
<li><a href='#optimEH'>
<p>Nee and May's Optimizing Process</p></a></li>
<li><a href='#orisaved'>
<p>Maximal or Minimal Amount of Originality Saved under Optimal Conditions</p></a></li>
<li><a href='#PADDis'>
<p>Functional Dissimilarity Measures for Presence-Absence Data</p></a></li>
<li><a href='#plot.phylo4d'>
<p>Plots for phylogenetic tree and data</p></a></li>
<li><a href='#qDT'>
<p>Mean Diversity along a Phylogenetic Tree</p></a></li>
<li><a href='#QE'>
<p>Quadratic Entropy</p></a></li>
<li><a href='#qHdiv'>
<p>Biodiversity Measure that Includes Consistent Interspecific and Intraspecific Components</p></a></li>
<li><a href='#randEH'>
<p>Amount of Evolutionary History Preserved when Random Species are Saved</p></a></li>
<li><a href='#rare_Rao'>
<p>Functional Rarefaction for Species Abundance Data</p></a></li>
<li><a href='#RDMCCP16'>
<p>Theoretical Data Set used in Ricotta et al. (2016)</p></a></li>
<li><a href='#Rentropy'>
<p>Pavoine et al. (2017) functional or phylogenetic entropy</p></a></li>
<li><a href='#rlqESLTP'>
<p>Linking Patterns in Phylogeny, Traits, Abiotic Variables</p>
and Space</a></li>
<li><a href='#rockfish'>
<p>Rockfish Phylogenetic Diversity in Southern California Bight</p></a></li>
<li><a href='#RP15EI'>
<p>Theoretical Data Set used in Ricotta and Pavoine (2015) in Ecological Indicators</p></a></li>
<li><a href='#RP15JVS'>
<p>Theoretical Data Set used in Ricotta and Pavoine (2015) in Journal of Vegetation Science</p></a></li>
<li><a href='#RPP16EE'>
<p>Theoretical Data Set used in Ricotta et al. (2016) in Ecology and Evolution</p></a></li>
<li><a href='#RutorGlacier'>
<p>Functional and phylogenetic composition of plant communities along a primary succession on glacial deposits.</p></a></li>
<li><a href='#speciesdiv'>
<p>Indices of Species Diversity</p></a></li>
<li><a href='#specieseve'>
<p>Indices of Species Evenvess</p></a></li>
<li><a href='#treeUniqueness'>
<p>Community-level phylogenetic (or functional) redundancy</p></a></li>
<li><a href='#twoHmax'>
<p>Maximization of the Diversity Index TwoH</p></a></li>
<li><a href='#uniqueness'>
<p>Functional Uniqueness and Functional Redundancy of Biological Communities</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Analysis of Diversity</td>
</tr>
<tr>
<td>Version:</td>
<td>2.2.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-02-05</td>
</tr>
<tr>
<td>Author:</td>
<td>Sandrine Pavoine </td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Sandrine Pavoine &lt;sandrine.pavoine@mnhn.fr&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions, data sets and examples for the calculation of various indices of biodiversity including species, functional and phylogenetic diversity. Part of the indices are expressed in terms of equivalent numbers of species. The package also provides ways to partition biodiversity across spatial or temporal scales (alpha, beta, gamma diversities). In addition to the quantification of biodiversity, ordination approaches are available which rely on diversity indices and allow the detailed identification of species, functional or phylogenetic differences between communities.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>ade4, adegraphics, ape, cluster, graphics, grDevices, lpSolve,
methods, phylobase, phytools, rgl, stats, utils</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-05 08:15:52 UTC; SandrineP</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-19 13:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='adiv-package'>
Analysis of Diversity
</h2><span id='topic+adiv-package'></span><span id='topic+adiv'></span>

<h3>Description</h3>

<p>Package adiv focuses on the analysis of biodiversity
</p>


<h3>Details</h3>

<p>Package <code>adiv</code> is dedicated to biodiversity indices used in ecology and conservation biology (see e.g. functions <code>divparam</code>, <code>optimEH</code>, <code>QE</code>). It also treats the concepts of species' originality (e.g. <code>distinctDis</code>, <code>distinctTree</code>, <code>distinctUltra</code>) and of dissimilarities between species and communities (e.g. <code>dissABC</code>, <code>dissRicotta</code>, <code>dsimcom</code>). Focus is placed on species, functional and phylogenetic diversity and on the apportionment of biodiversity across spatial and temporal scales (see for notably functions <code>EqRao</code>, <code>EqRS</code>, <code>EqRSintra</code>). Ordination methods are also available to depict in detail biodiversity patterns in space and/or time (e.g. <code>crossdpcoa</code>, <code>dspca</code>, <code>evoCA</code>, <code>evoNSCA</code>, <code>evopca</code>).
</p>


<h3>Author(s)</h3>

<p>Sandrine Pavoine 
</p>
<p>Maintainer: Sandrine Pavoine &lt;sandrine.pavoine@mnhn.fr&gt;
</p>

<hr>
<h2 id='abgdivparam'>
Apportionment of Parametric Indices of Diversity
</h2><span id='topic+abgdivparam'></span><span id='topic+plot.abgdivparam'></span>

<h3>Description</h3>

<p>Function <code>abgdivparam</code> calculates alpha, beta and gamma components of species diversity using parametric indices derived from Tsallis (HCDT) and Hill compositional indices. Alpha is for within-community diversity, beta for between-community diversity and gamma for the diversity of all combined communities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>abgdivparam(comm, w = c("speciesab", "even"),
method = c("hillCJC", "hillR", "tsallis"), q = 2, 
option = c("multiplicative", "additive", "proportional", 
"C", "U", "V", "S", "Renyi"), tol = 1e-08)

## S3 method for class 'abgdivparam'
plot(x, legend = TRUE, 
legendposi = "topright", type = "b", 
col = if (is.numeric(x)) NULL else 1:nrow(x$div), 
lty = if (is.numeric(x)) NULL else rep(1, nrow(x$div)), 
pch = if (is.numeric(x)) NULL else 1:nrow(x$div), 
ylim1 = range(x$div[c("Alpha", "Gamma"), ]), ylim2 = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="abgdivparam_+3A_comm">comm</code></td>
<td>
<p>a data frame or a matrix typically with communities as rows, species as columns and an index of abundance as entries.</p>
</td></tr>
<tr><td><code id="abgdivparam_+3A_w">w</code></td>
<td>
<p>either a numeric vector giving weights for communities (same order as in comm), or a code: one of <code>"even"</code> and <code>"speciesab"</code>. If several codes are given, only the first one is used. See details.</p>
</td></tr>
<tr><td><code id="abgdivparam_+3A_method">method</code></td>
<td>
<p>a string with one of the following codes: <code>"tsallis"</code>, <code>"hillR"</code>, or <code>"hillCJC"</code>. See details.</p>
</td></tr>
<tr><td><code id="abgdivparam_+3A_q">q</code></td>
<td>
<p>a vector with nonnegative value(s) for parameter <code>q</code>. See details.</p>
</td></tr>
<tr><td><code id="abgdivparam_+3A_option">option</code></td>
<td>
<p>a string code: either <code>"multiplicative"</code>, <code>"additive"</code> or <code>"proportional"</code>. If several codes are given, only the first one is used. Only, with <code>method</code>=<code>"hillCJC"</code>, other options are possible: <code>"C"</code>, <code>"U"</code>, <code>"V"</code>, <code>"S"</code>, <code>"Renyi"</code>. See details.</p>
</td></tr>
<tr><td><code id="abgdivparam_+3A_tol">tol</code></td>
<td>
<p>numeric tolerance threshold: values between -<code>tol</code> and <code>tol</code> are considered equal to zero.</p>
</td></tr>
<tr><td><code id="abgdivparam_+3A_x">x</code></td>
<td>
<p>an object of class <code>abgdivparam</code> obtained with function <code>abgdivparam</code>.</p>
</td></tr>
<tr><td><code id="abgdivparam_+3A_legend">legend</code></td>
<td>
<p>a logical. If TRUE a legend is given with the colour, the type of line (etc.) used to define the diversity curve of each diversity level (gamma, alpha, beta).</p>
</td></tr>
<tr><td><code id="abgdivparam_+3A_legendposi">legendposi</code></td>
<td>
<p>a string that gives the position of the legend to be passed to function <code>legend</code> of the base of R.</p>
</td></tr>
<tr><td><code id="abgdivparam_+3A_type">type</code></td>
<td>
<p>a string to be passed to the graphic argument <code>type</code> of functions <code>plot</code> and <code>lines</code> used to draw the diversity curve of each diversity level (gamma, alpha, beta).</p>
</td></tr>
<tr><td><code id="abgdivparam_+3A_col">col</code></td>
<td>
<p>vector of colours to be passed to the graphic argument <code>col</code> of functions <code>plot</code> and <code>lines</code> to define the colour of the diversity curve of each diversity level (gamma, alpha, beta, in that order).</p>
</td></tr>
<tr><td><code id="abgdivparam_+3A_lty">lty</code></td>
<td>
<p>vector of types of line (plain, broken etc.) to be passed to the graphic argument <code>lty</code> of functions <code>plot</code> and <code>lines</code> used to draw the diversity curve of each diversity level (gamma, alpha, beta, in that order).</p>
</td></tr>
<tr><td><code id="abgdivparam_+3A_pch">pch</code></td>
<td>
<p>vector of types of point (open circle, close circle, square etc.) to be passed to the graphic argument <code>pch</code> of functions <code>plot</code> and <code>lines</code> used to draw the diversity level (gamma, alpha, beta, in that order).</p>
</td></tr>
<tr><td><code id="abgdivparam_+3A_ylim1">ylim1</code></td>
<td>
<p>a vector with two numerics indicating the range to be used to display alpha and gamma diversity.</p>
</td></tr>
<tr><td><code id="abgdivparam_+3A_ylim2">ylim2</code></td>
<td>
<p>a vector with two numerics indicating the range to be used to display beta diversity.</p>
</td></tr>
<tr><td><code id="abgdivparam_+3A_...">...</code></td>
<td>
<p>other arguments can be added and passed to the functions <code>plot</code> and <code>lines</code> used to draw the graphic.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Consider <em>j</em> a community (<em>j</em>=1,...,<em>m</em>), <code class="reqn">a_{jk}</code> the abundance of species <em>k</em> in community <em>j</em>. <em>q</em> is the parameter that increases with the importance given to abundant species compared to rare species in diversity.
</p>
<p>The methods available are:
<code>tsallis</code> (decomposition of Tsallis or HCDT entropy (Harvda and Charvat 1967; Daroczy 1970; Tsallis 1988) into alpha, beta, gamma components):
</p>
<p style="text-align: center;"><code class="reqn">^q\gamma_{Tsallis}=\left[1-\sum_k \left(\sum_{j=1}^m w_j \frac{a_{jk}}{\sum_k a_{jk}}\right)^q \right]/(q-1)</code>
</p>

<p style="text-align: center;"><code class="reqn">^q\alpha_{Tsallis}=\sum_{j=1}^m w_j \left[1-\sum_k  \left( \frac{a_{jk}}{\sum_k a_{jk}}\right)^q\right]/(q-1)</code>
</p>

<p><code>hillR</code> (Routledge decomposition of Hill diversity into alpha, beta, gamma components):
</p>
<p style="text-align: center;"><code class="reqn">^q\gamma_{Hill}=\left[\sum_k \left(\sum_{j=1}^m w_j \frac{a_{jk}}{\sum_k a_{jk}}\right)^q \right]^{1/(1-q)}</code>
</p>

<p style="text-align: center;"><code class="reqn">^q\alpha_{Hill-R}=\left[\sum_{j=1}^m w_j \sum_k \left( \frac{a_{jk}}{\sum_k a_{jk}}\right)^q\right]^{1/(1-q)}</code>
</p>

<p><code>hillCJC</code> (Chiu et al. (2014) decomposition of species diversity into alpha, beta, gamma components, see Supplementary material Appendix 2 in Pavoine (2016) for a justification of the formulas):
</p>
<p style="text-align: center;"><code class="reqn">^q\gamma_{Hill}=\left[\sum_k \left(\sum_{j=1}^m w_j \frac{a_{jk}}{\sum_k a_{jk}}\right)^q \right]^{1/(1-q)}</code>
</p>

<p style="text-align: center;"><code class="reqn">^q\alpha_{Hill-CJC}=\frac{1}{m}\left[\sum_k \sum_{j=1}^m (w_j)^q \left( \frac{a_{jk}}{\sum_k a_{jk}}\right)^q\right]^{1/(1-q)}</code>
</p>

<p>Then option <code>"additive"</code> calculates <code class="reqn">\beta</code> diversity as <code class="reqn">\gamma-\alpha</code>.
Option <code>"proportional"</code> calculates <code class="reqn">\beta</code> as <code class="reqn">(\gamma-\alpha)/\gamma</code>.
Option <code>"multiplicative"</code> calculates <code class="reqn">\beta</code> diversity as <code class="reqn">\gamma/\alpha</code>.
Only for <code>method</code>=<code>"hillCJC"</code>, options <code>"C"</code>, <code>"U"</code>, <code>"V"</code>, <code>"S"</code>, use the multiplicative option and also calculate one of the transformations introduced by Chiu et al. (2014): indices <code class="reqn">1-C_{qm}</code>, <code class="reqn">1-U_{qm}</code>, <code class="reqn">1-V_{qm}</code>, and <code class="reqn">1-S_{qm}</code>, respectively. <code>"Renyi"</code> calculates <code class="reqn">\beta</code> diversity as <code class="reqn">ln(\gamma/\alpha)/ln(m)</code>.
</p>
<p>The weights of the sites (argument <code>w</code>) can be <code>"even"</code> (even weights), or <code>"speciesab"</code> (proportional to the summed abundances of all species). 
</p>


<h3>Value</h3>

<p>If only one value of <code>q</code> is given, abgdivparam returns a vector with alpha, beta, and gamma diversities.
If more than one value of <code>q</code> is given, it returns a list of two objects: 
</p>
<table role = "presentation">
<tr><td><code>q</code></td>
<td>
<p>the numeric vector of values for <code>q</code>.</p>
</td></tr>
<tr><td><code>div</code></td>
<td>
<p>a data frame with alpha, beta, gamma calculated for all values of <code>q</code>.</p>
</td></tr>
</table>
<p>Only if <code>method</code>=<code>"hillCJC"</code> and <code>option</code>= <code>"C"</code>, <code>"U"</code>, <code>"V"</code>,  <code>"S"</code>, or <code>"Renyi"</code>, the index <code class="reqn">1-C_{qm}</code> (for <code>"C"</code>), <code class="reqn">1-U_{qm}</code> (for <code>"U"</code>), <code class="reqn">1-V_{qm}</code> (for <code>"V"</code>), <code class="reqn">1-S_{qm}</code> (for <code>"S"</code>) or the Renyi transformation (see above, for <code>"Renyi"</code>) is also provided in the <code>div</code> data frame under the name &quot;transformed.beta&quot;.
</p>
<p>The function <code>plot.abgdivparam</code> returns a graphic.
</p>


<h3>Author(s)</h3>

<p>Sandrine Pavoine <a href="mailto:sandrine.pavoine@mnhn.fr">sandrine.pavoine@mnhn.fr</a>
</p>


<h3>References</h3>

<p>Chiu, C.-H., Jost, L., Chao, A. (2014) Phylogenetic beta diversity, similarity, and differentiation measures based on Hill numbers. <em>Ecological Monographs</em>, <b>84</b>, 21&ndash;44.
</p>
<p>Daroczy, Z. (1970) Generalized information functions. <em>Information and Control</em>, <b>16</b>, 36&ndash;51.
</p>
<p>Havrda, M., Charvat F. (1967) Quantification method of classification processes: concept of structural alpha-
entropy. <em>Kybernetik</em>, <b>3</b>, 30&ndash;35
</p>
<p>Hill, M.O. (1973) Diversity and evenness: a unifying notation and its consequences. <em>Ecology</em>, <b>54</b>, 427&ndash;432.
</p>
<p>Pavoine, S. (2016) A guide through a family of phylogenetic dissimilarity measures among sites. <em>Oikos</em>, <b>125</b>, 1719&ndash;1732. 
</p>
<p>Rao, C.R. (1986) Rao's axiomatization of diversity measures. In: Kotz S, Johnson NL, editors. <em>Encyclopedia of Statistical Sciences</em>. New York: Wiley and Sons. pp. 614&ndash;617.
</p>
<p>Routledge, R.D. (1979) Diversity indices: which ones are admissible? <em>Journal of Theoretical Biology</em>, <b>76</b>, 503&ndash;515.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+divparam">divparam</a></code>, <code><a href="#topic+abgevodivparam">abgevodivparam</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(batcomm)
abgdivparam(batcomm$ab)
plot(abgdivparam(batcomm$ab))
abgdivparam(batcomm$ab, q=0:4)
plot(abgdivparam(batcomm$ab, q=0:4))
</code></pre>

<hr>
<h2 id='abgevodivparam'>
Apportionment of Parametric Indices of Phylogenetic Diversity
</h2><span id='topic+abgevodivparam'></span><span id='topic+plot.abgevodivparam'></span>

<h3>Description</h3>

<p>Function <code>abgevodivparam</code> calculates alpha, beta and gamma components of phylogenetic diversity using parametric indices derived from Tsallis (HCDT) and Hill compositional indices. Alpha is for within-community diversity, beta for between-community diversity and gamma for the diversity of all combined communities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>abgevodivparam(phyl, comm, w = c("evoab", "even", "speciesab"),
method = c("hillCJC", "hillR", "tsallis"), q = 2, 
option = c("multiplicative", "additive", "proportional", 
"C", "U", "V", "S", "Renyi"), tol = 1e-08)

## S3 method for class 'abgevodivparam'
plot(x, legend = TRUE, 
legendposi = "topright", type = "b", 
col = if (is.numeric(x)) NULL else 1:nrow(x$div), 
lty = if (is.numeric(x)) NULL else rep(1, nrow(x$div)), 
pch = if (is.numeric(x)) NULL else 1:nrow(x$div), 
ylim1 = range(x$div[c("Alpha", "Gamma"), ]), ylim2 = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="abgevodivparam_+3A_phyl">phyl</code></td>
<td>
<p>an object inheriting the class <code>phylo</code> (see package ape), <code>phylo4</code> (see package phylobase), or <code>hclust</code>.</p>
</td></tr>
<tr><td><code id="abgevodivparam_+3A_comm">comm</code></td>
<td>
<p>a data frame or a matrix typically with communities as rows, species as columns and an index of abundance as entries. Species should be labeled as in the phylogenetic tree where they are the tips.</p>
</td></tr>
<tr><td><code id="abgevodivparam_+3A_w">w</code></td>
<td>
<p>either a numeric vector giving weights for communities (same order as in comm), or a code: one of <code>"even"</code>, <code>"evoab"</code>, and <code>"speciesab"</code>. If several codes are given, only the first one is used. See details.</p>
</td></tr>
<tr><td><code id="abgevodivparam_+3A_method">method</code></td>
<td>
<p>a string with one of the following codes: <code>"tsallis"</code>, <code>"hillR"</code>, or <code>"hillCJC"</code>. See details.</p>
</td></tr>
<tr><td><code id="abgevodivparam_+3A_q">q</code></td>
<td>
<p>a vector with nonnegative value(s) for parameter <code>q</code>. See details.</p>
</td></tr>
<tr><td><code id="abgevodivparam_+3A_option">option</code></td>
<td>
<p>a string code: either <code>"multiplicative"</code>, <code>"additive"</code> or <code>"proportional"</code>. If several codes are given, only the first one is used. Only, with <code>method</code>=<code>"hillCJC"</code>, other options are possible: <code>"C"</code>, <code>"U"</code>, <code>"V"</code>, <code>"S"</code>, <code>"Renyi"</code>. See details.</p>
</td></tr>
<tr><td><code id="abgevodivparam_+3A_tol">tol</code></td>
<td>
<p>numeric tolerance threshold: values between -<code>tol</code> and <code>tol</code> are considered equal to zero.</p>
</td></tr>
<tr><td><code id="abgevodivparam_+3A_x">x</code></td>
<td>
<p>an object of class <code>abgevodivparam</code> obtained with function <code>abgevodivparam</code>.</p>
</td></tr>
<tr><td><code id="abgevodivparam_+3A_legend">legend</code></td>
<td>
<p>a logical. If TRUE a legend is given with the colour, the type of line (etc.) used to define the diversity curve of each diversity level (gamma, alpha, beta).</p>
</td></tr>
<tr><td><code id="abgevodivparam_+3A_legendposi">legendposi</code></td>
<td>
<p>a string that gives the position of the legend to be passed to function <code>legend</code> of the base of R.</p>
</td></tr>
<tr><td><code id="abgevodivparam_+3A_type">type</code></td>
<td>
<p>a string to be passed to the graphic argument <code>type</code> of functions <code>plot</code> and <code>lines</code> used to draw the diversity curve of each diversity level (gamma, alpha, beta).</p>
</td></tr>
<tr><td><code id="abgevodivparam_+3A_col">col</code></td>
<td>
<p>vector of colours to be passed to the graphic argument <code>col</code> of functions <code>plot</code> and <code>lines</code> to define the colour of the diversity curve of each diversity level (gamma, alpha, beta, in that order).</p>
</td></tr>
<tr><td><code id="abgevodivparam_+3A_lty">lty</code></td>
<td>
<p>vector of types of line (plain, broken etc.) to be passed to the graphic argument <code>lty</code> of functions <code>plot</code> and <code>lines</code> used to draw the diversity curve of each diversity level (gamma, alpha, beta, in that order).</p>
</td></tr>
<tr><td><code id="abgevodivparam_+3A_pch">pch</code></td>
<td>
<p>vector of types of point (open circle, close circle, square etc.) to be passed to the graphic argument <code>pch</code> of functions <code>plot</code> and <code>lines</code> used to draw the diversity level (gamma, alpha, beta, in that order).</p>
</td></tr>
<tr><td><code id="abgevodivparam_+3A_ylim1">ylim1</code></td>
<td>
<p>a vector with two numerics indicating the range to be used to display alpha and gamma diversity.</p>
</td></tr>
<tr><td><code id="abgevodivparam_+3A_ylim2">ylim2</code></td>
<td>
<p>a vector with two numerics indicating the range to be used to display beta diversity.</p>
</td></tr>
<tr><td><code id="abgevodivparam_+3A_...">...</code></td>
<td>
<p>other arguments can be added and passed to the functions <code>plot</code> and <code>lines</code> used to draw the graphic.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Consider a phylogenetic tree <em>T</em>, <code class="reqn">b_T</code> the set of branches in <em>T</em>, <em>k</em> a branch, <code class="reqn">L_k</code> the length of branch <em>k</em>, <em>j</em> a community (<em>j</em>=1,...,<em>m</em>), <code class="reqn">a_{jk}</code> the abundance associated with branch <em>k</em> in community <em>j</em> (sum of abundance of all species descending from the branch). <em>q</em> is the parameter that increases with the importance given to abundant species compared to rare species in diversity.
</p>
<p>The methods available are:
<code>tsallis</code> (decomposition of Tsallis or HCDT entropy (Harvda and Charvat 1967; Daroczy 1970; Tsallis 1988) into alpha, beta, gamma components adapted here to phylogenetic diversity):
</p>
<p style="text-align: center;"><code class="reqn">^q\gamma_{evoTsallis}=\left[1-\sum_{k \in b_T} L_k \left(\sum_{j=1}^m w_j \frac{a_{jk}}{\sum_{k \in b_T} L_k a_{jk}}\right)^q \right]/(q-1)</code>
</p>

<p style="text-align: center;"><code class="reqn">^q\alpha_{evoTsallis}=\sum_{j=1}^m w_j \left[1-\sum_{k \in b_T} L_k \left( \frac{a_{jk}}{\sum_{k \in b_T} L_k a_{jk}}\right)^q\right]/(q-1)</code>
</p>

<p><code>hillR</code> (Routledge decomposition of Hill diversity into alpha, beta, gamma components adapted hete to phylogenetic diversity):
</p>
<p style="text-align: center;"><code class="reqn">^q\gamma_{evoHill}=\left[\sum_{k \in b_T} L_k \left(\sum_{j=1}^m w_j \frac{a_{jk}}{\sum_{k \in b_T} L_k a_{jk}}\right)^q \right]^{1/(1-q)}</code>
</p>

<p style="text-align: center;"><code class="reqn">^q\alpha_{evoHill-R}=\left[\sum_{j=1}^m w_j \sum_{k \in b_T} L_k \left( \frac{a_{jk}}{\sum_{k \in b_T} L_k a_{jk}}\right)^q\right]^{1/(1-q)}</code>
</p>

<p><code>hillCJC</code> (Chiu et al. (2014) decomposition of phylogenetic diversity into alpha, beta, gamma components, see Supplementary material Appendix 2 in Pavoine (2016) for a justification of the formulas):
</p>
<p style="text-align: center;"><code class="reqn">^q\gamma_{evoHill}=\left[\sum_{k \in b_T} L_k \left(\sum_{j=1}^m w_j \frac{a_{jk}}{\sum_{k \in b_T} L_k a_{jk}}\right)^q \right]^{1/(1-q)}</code>
</p>

<p style="text-align: center;"><code class="reqn">^q\alpha_{evoHill-CJC}=\frac{1}{m}\left[\sum_{k \in b_T} L_k \sum_{j=1}^m (w_j)^q \left( \frac{a_{jk}}{\sum_{k \in b_T} L_k a_{jk}}\right)^q\right]^{1/(1-q)}</code>
</p>

<p>Then option <code>"additive"</code> calculates <code class="reqn">\beta</code> diversity as <code class="reqn">\gamma-\alpha</code>.
Option <code>"proportional"</code> calculates <code class="reqn">\beta</code> as <code class="reqn">(\gamma-\alpha)/\gamma</code>.
Option <code>"multiplicative"</code> calculates <code class="reqn">\beta</code> diversity as <code class="reqn">\gamma/\alpha</code>.
Only for <code>method</code>=<code>"hillCJC"</code>, options <code>"C"</code>, <code>"U"</code>, <code>"V"</code>, <code>"S"</code>, use the multiplicative option and also calculate one of the transformations introduced by Chiu et al. (2014): indices <code class="reqn">1-C_{qm}</code>, <code class="reqn">1-U_{qm}</code>, <code class="reqn">1-V_{qm}</code>, and <code class="reqn">1-S_{qm}</code>, respectively. <code>"Renyi"</code> is the <code class="reqn">^qevoD_{Renyi}</code> index introduced in Pavoine (2016), see also Supplementary material Appendix 1 in Pavoine (2016).
</p>
<p>The weights of the sites (argument <code>w</code>) can be <code>"even"</code> (even weights), <code>"evoab"</code> (proportional to the summed abundances of all evolutionary units), or <code>"speciesab"</code> (proportional to the summed abundances of all species). Note that if the phylogenetic tree is ultrametric (the distance from any species to the root is constant), then options <code>"evoab"</code> and <code>"speciesab"</code> are equivalent.
</p>


<h3>Value</h3>

<p>If only one value of <code>q</code> is given, abgevodivparam returns a vector with alpha, beta, and gamma diversities.
If more than one value of <code>q</code> is given, it returns a list of two objects: 
</p>
<table role = "presentation">
<tr><td><code>q</code></td>
<td>
<p>the numeric vector of values for <code>q</code>.</p>
</td></tr>
<tr><td><code>div</code></td>
<td>
<p>a data frame with alpha, beta, gamma calculated for all values of <code>q</code>.</p>
</td></tr>
</table>
<p>Only if <code>method</code>=<code>"hillCJC"</code> and <code>option</code>= <code>"C"</code>, <code>"U"</code>, <code>"V"</code>, <code>"S"</code>, or <code>"Renyi"</code>, the index <code class="reqn">1-C_{qm}</code> (for <code>"C"</code>), <code class="reqn">1-U_{qm}</code> (for <code>"U"</code>), <code class="reqn">1-V_{qm}</code> (for <code>"V"</code>), <code class="reqn">1-S_{qm}</code> (for <code>"S"</code>) or the Renyi transformation (see above, for <code>"Renyi"</code> is also provided in the <code>div</code> data frame under the name &quot;transformed.beta&quot;.
</p>
<p>The function <code>plot.abgevodivparam</code> returns a graphic.
</p>


<h3>Author(s)</h3>

<p>Sandrine Pavoine <a href="mailto:sandrine.pavoine@mnhn.fr">sandrine.pavoine@mnhn.fr</a>
</p>


<h3>References</h3>

<p>The methodologies and scripts were presented in 
</p>
<p>Pavoine, S. (2016) A guide through a family of phylogenetic dissimilarity measures among sites. <em>Oikos</em>, <b>125</b>, 1719&ndash;1732. 
</p>
<p>using earlier work by
</p>
<p>Daroczy, Z. (1970) Generalized information functions. <em>Information and Control</em>, <b>16</b>, 36&ndash;51.
</p>
<p>Havrda, M., Charvat F. (1967) Quantification method of classification processes: concept of structural alpha-
entropy. <em>Kybernetik</em>, <b>3</b>, 30&ndash;35
</p>
<p>Hill, M.O. (1973) Diversity and evenness: a unifying notation and its consequences. <em>Ecology</em>, <b>54</b>, 427&ndash;432.
</p>
<p>Routledge, R.D. (1979) Diversity indices: which ones are admissible? <em>Journal of Theoretical Biology</em>, <b>76</b>, 503&ndash;515.
</p>
<p>Rao, C.R. (1986) Rao's axiomatization of diversity measures. In: Kotz S, Johnson NL, editors. <em>Encyclopedia of Statistical Sciences</em>. New York: Wiley and Sons. pp. 614&ndash;617.
</p>
<p>Chiu, C.-H., Jost, L., Chao, A. (2014) Phylogenetic beta diversity, similarity, and differentiation measures based on Hill numbers. <em>Ecological Monographs</em>, <b>84</b>, 21&ndash;44.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+evodiss">evodiss</a></code>, <code><a href="#topic+divparam">divparam</a></code>, <code><a href="#topic+evodivparam">evodivparam</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
if(require(ape)){
data(batcomm)
phy &lt;- read.tree(text=batcomm$tre)
ab &lt;- batcomm$ab[,phy$tip.label]
abgevodivparam(phy, ab)
plot(abgevodivparam(phy, ab))
abgevodivparam(phy, ab, q=0:4)
plot(abgevodivparam(phy, ab, q=0:4))
}

## End(Not run)
</code></pre>

<hr>
<h2 id='aptree'>
Hierarchical Partitioning of Evolutionary and Ecological Patterns in the Organization of Phylogenetically-Structured Species Assemblages
</h2><span id='topic+apd'></span><span id='topic+aptree'></span><span id='topic+plot.aptree'></span><span id='topic+abgaptree'></span><span id='topic+rtestaptree'></span><span id='topic+plot.rtestaptree'></span><span id='topic+tecAptree'></span><span id='topic+pIa'></span>

<h3>Description</h3>

<p><code>apd</code> performs Hardy (2008)'s test for phylogenetic structure in species abundance distribution; 
</p>
<p><code>aptree</code> apportions the diversity (according to index <code class="reqn">I_a</code> by Pavoine et al. 2009) within one or several communities between evolutionary periods; 
</p>
<p><code>plot.aptree</code> displays the phylogenetic tree with vertical lines at each speciation event (limits of the evolutionary periods), the first period starts at the tips and the last one ends at the root node; the phylogenetic tree is pruned retaining only the species present in at least one of the observed communities;
</p>
<p><code>abgaptree</code> provides the apportionment of alpha, beta and gamma diversities between evolutionary periods, according to index <code class="reqn">I_a</code> by Pavoine et al. (2009);
</p>
<p><code>rtestaptree</code> performs the test of phylogenetic signal in the differences between communities at each evolutionary periods; 
</p>
<p><code>plot.rtestaptree</code> displays the phylogenetic tree with vertical lines at each speciation event (limits of the evolutionary periods; see above); colours are used to highlight the periods where the dissimilarities between communities are different from that expected at random;
</p>
<p><code>tecAptree</code> provides technical information for the apportionment of diversity between evolutionary periods; 
</p>
<p><code>pIa</code> calculates the index <code class="reqn">I_a</code> by Pavoine et al. (2009) within each community.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>apd(phyl, comm, wcom = c("even", "speciesab"), nrep = 99, 
alter = "two-sided", tol = 1e-08)

aptree(phyl, comm, exponent = 2, tol = 1e-08)

## S3 method for class 'aptree'
plot(x, col.line = 'blue', ...)

abgaptree(phyl, comm, exponent = 2, 
wcom = c("even", "speciesab"), tol = 1e-08)

rtestaptree(phyl, comm, nrep = 99, alter = "two-sided", 
exponent = 2, wcom = c("even", "speciesab"), tol = 1e-08)

## S3 method for class 'rtestaptree'
plot(x, col.line = c("blue", "red"), 
alpha = 0.05, ...)

tecAptree(phyl, v = NULL, tol = 1e-08)

pIa(phyl, comm, exponent = 2, tol = 1e-08)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="aptree_+3A_phyl">phyl</code></td>
<td>

<p>an object inheriting the class <code>phylo</code> (see package ape), <code>phylo4</code> (see package phylobase), or <code>hclust</code>.
</p>
</td></tr>
<tr><td><code id="aptree_+3A_comm">comm</code></td>
<td>

<p>a data frame or a matrix typically with communities as rows, species as columns and presence/absence or an index of abundance as entries. Species should be labeled as in the phylogenetic tree where they are the tips. In function <code>aptree</code>, <code>comm</code> can be a vector that provides the presence/absence or an index of abundance within a single community.
</p>
</td></tr>
<tr><td><code id="aptree_+3A_wcom">wcom</code></td>
<td>

<p>a numeric vector that gives the weight attributed to the community. The weights must be positive and their sum equals 1.
</p>
</td></tr>
<tr><td><code id="aptree_+3A_nrep">nrep</code></td>
<td>

<p>a numeric that gives the number of permutations.
</p>
</td></tr>
<tr><td><code id="aptree_+3A_alter">alter</code></td>
<td>

<p>a string specifying the alternative hypothesis; it must be one of &quot;greater&quot;, &quot;less&quot; or &quot;two-sided&quot;.
</p>
</td></tr>
<tr><td><code id="aptree_+3A_tol">tol</code></td>
<td>

<p>a numeric. If the absolute value of a statistic is less than tol, this statistic is considered equal to zero.
</p>
</td></tr>
<tr><td><code id="aptree_+3A_exponent">exponent</code></td>
<td>

<p>a numeric that gives the value of parameter <em>a</em> in index <code class="reqn">I_a</code>.
</p>
</td></tr>
<tr><td><code id="aptree_+3A_x">x</code></td>
<td>

<p>in <code>plot.aptree</code>, <code>x</code> is an object inheriting class <code>aptree</code> obtained with function <code>aptree</code>. In <code>plot.rtestaptree</code>, <code>x</code> is an object inheriting class <code>rtestaptree</code> obtained with function <code>rtestaptree</code>.
</p>
</td></tr>
<tr><td><code id="aptree_+3A_col.line">col.line</code></td>
<td>

<p>in <code>plot.aptree</code>, <code>col.line</code> is a string which attributes a colour to the vertical lines placed at each speciation event and defining the evolutionary periods. In <code>plot.rtestaptree</code>, it is a vector with two strings. These strings give colours to the vertical lines placed at each speciation event. The first colour is used when the differences between communities at the evolutionary period are not significantly different from random; the second colour is used when they are. 
</p>
</td></tr>
<tr><td><code id="aptree_+3A_alpha">alpha</code></td>
<td>

<p>a numeric: the nominal alpha level for significancy (the p-values calculated with function <code>rtestaptree</code> are compared to alpha to determine the result of the test).
</p>
</td></tr>
<tr><td><code id="aptree_+3A_...">...</code></td>
<td>

<p>further arguments passed to or from other methods.
</p>
</td></tr>
<tr><td><code id="aptree_+3A_v">v</code></td>
<td>

<p>either <code>NULL</code> or a vector that provides the presence/absence or an index of abundance of species within a single community.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The approaches developed in these functions rely on a parametric index of phylogenetic diversity named <code class="reqn">I_a</code>. The parameter <em>a</em> controls the importance given to rare versus abundant species in communities. Index <code class="reqn">I_a</code> generalizes Rao's quadratic entropy (QE) applied to phylogenetic distances between species (when <em>a</em>=2) and Faith's Phylogenetic Diversity index (PD) (when <em>a</em>=0). When <em>a</em> tends towards 1, the index is a generalization of the Shannon index of diversity applied to phylogenetic data in addition to abundance data. In Pavoine et al. (2009), we developed this index and demonstrated how it can be used to partition diversity simultaneously across evolutionary periods in the phylogeny and across spatial (e.g. local communities in a region) and/or time units (e.g. a community investigated yearly).
</p>


<h3>Value</h3>

<p>The function <code>apd</code> returns an object of class <code>randtest</code> with the results of the test (see function <code>randtest</code> in package ade4).
</p>
<p>The function <code>aptree</code> returns a data frame with the evolutionary periods as rows, the communities as columns and the diversity values as entries.
</p>
<p>The function <code>plot.aptree</code> returns a graph.
</p>
<p>The function <code>abgaptree</code> returns a data frame with the evolutionary periods as rows, alpha diversity, beta diversity and gamma diversity as columns and the diversity values as entries.
</p>
<p>The function <code>rtestaptree</code> returns an object of class <code>krandtest</code> with the results of the permutation tests. (see function <code>krandtest</code> in package ade4)
</p>
<p>The function <code>plot.rtestaptree</code> returns a graph.
</p>
<p>The function <code>tecAptree</code> returns a list. If <code>v</code> is <code>NULL</code>, the values of the list are:
</p>
<table role = "presentation">
<tr><td><code>h</code></td>
<td>
<p>the height at which each evolutionary period ends;</p>
</td></tr>
<tr><td><code>plength</code></td>
<td>
<p>period length;</p>
</td></tr> 
<tr><td><code>ngroups</code></td>
<td>
<p>number of monophyletic groups per evolutionary period;</p>
</td></tr>
<tr><td><code>list</code></td>
<td>
<p>list of the species per monophyletic group at each evolutionary period;</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>original call.</p>
</td></tr>
</table>
<p>If <code>v</code> contains a vector of presence/absence or abundance, the following object is added in the output: 
</p>
<table role = "presentation">
<tr><td><code>relab</code></td>
<td>
<p>the relative abundance (sum of species' presences or abundances depending on <code>v</code>) of each monophyletic group at each evolutionary period.</p>
</td></tr>
</table>
<p>The function <code>pIa</code> returns a data frame with communities as rows and only one column. This column gives, for each community, the value taken by index <code class="reqn">I_a</code> of phylogenetic diversity developed by Pavoine et al. (2009).  
</p>


<h3>Author(s)</h3>

<p>Sandrine Pavoine <a href="mailto:sandrine.pavoine@mnhn.fr">sandrine.pavoine@mnhn.fr</a>
with contributions of Stephane Dray.
</p>


<h3>References</h3>

<p>Pavoine, S., Love, M., Bonsall, M.B. (2009) Hierarchical partitioning of evolutionary and ecological patterns in the organization of phylogenetically-structured species assemblages: application to rockfish (genus: Sebastes) in the Southern California Bight. <em>Ecology Letters</em>, <b>12</b>, 898&ndash;908.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+QE">QE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
if(require(ape)){
data(rockfish)
phy &lt;- read.tree(text=rockfish$tre)
ABG &lt;- abgaptree(phy, rockfish$fau, wcom="speciesab")
colSums(ABG)
A &lt;- aptree(phy, rockfish$fau)
colSums(A)
plot(A, cex=0.5)
P &lt;- pIa(phy, rockfish$fau)
P
T &lt;- apd(phy, rockfish$fau)
plot(T)
#R &lt;- rtestaptree(phy, rockfish$fau, nrep=999, wcom="speciesab")
#plot(R)
TA &lt;- tecAptree(phy)
TA$h
}

## End(Not run)
</code></pre>

<hr>
<h2 id='batcomm'>
Bat Abundance and Phylogeny Along a Disturbance Gradient in a Neotropical Rainforest
</h2><span id='topic+batcomm'></span>

<h3>Description</h3>

<p>The data were collected by Medellin et al. (2000) on bats in four habitats in the Selva Lacandona of Chiapas, Mexico. 
Two phylogenetic trees were obtained, one with Fritz et al. (2009) phylogeny pruned for retaining only the species present in Medellin et al. data set; the other one using a consensus tree obtained from 9999 credible trees developed by Upham et al. (2019) and obtained from vertlife.org (see Pavoine and Ricotta (2021) for more details).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("batcomm")</code></pre>


<h3>Format</h3>

<p><code>batcomm</code> is a list of two components:
</p>
<p><code>ab</code>, a data frame with habitats as rows, species as columns and abundance of species in habitats as entries.
</p>
<p><code>tre</code>, a phylogenetic tree in newick format for all bat species in <code>ab</code>.
</p>
<p><code>ab2</code>, a data frame with habitats as rows, species as columns and abundance of species in habitats as entries.
</p>
<p><code>tre2</code>, a phylogenetic tree in newick format for all bat species in <code>ab</code>.
</p>


<h3>Details</h3>

<p>In <code>ab</code> and <code>ab2</code>, four habitat types were analyzed: F=rainforest; P=cacao plantations; O=old fields; C=cornfields (Pavoine 2016). 
</p>
<p><code>ab</code> and <code>tre</code> contain species names as in Medellin et al. (2000).
<code>ab2</code> and <code>tre2</code> contain species names as in Upham et al. (2019).
</p>
<p>Synonyms used are: Pteronotus_parnelii / Pteronotus_parnellii; Phyllostomus_stenops / Phylloderma_stenops; Tonatia_brasiliense / Lophostoma_brasiliense; Tonatia_evotis / Lophostoma_evotis; Micronycteris_brachyotis / Lampronycteris_brachyotis; Vampyrodes_major / Vampyrodes_caraccioli. 
</p>
<p><code>tre</code> was obtained using Fritz et al. (2009) and <code>tre2</code> using Upham et al. (2019). The resolution of the bat phylogeny obtained from Fritz is uncertain especially at the older nodes (Pavoine 2016).
</p>


<h3>Source</h3>

<p><a href="http://www.oikosjournal.org/appendix/oik-03262">http://www.oikosjournal.org/appendix/oik-03262</a>
</p>


<h3>References</h3>

<p>Fritz, S.A., Bininda-Emonds, O.R.P., Purvis, A. (2009) Geographic variation in predictors of mammalian extinction risk: big is bad, but only in the tropics. <em>Ecology Letters</em>, <b>12</b>, 538&ndash;549.
</p>
<p>Medellin, R., Equihua M., Amin,  M.A. (2000) Bat diversity and abundance as indicators of disturbance in Neotropical rainforest. <em>Conservation Biology</em>, <b>14</b>, 1666&ndash;1675.
</p>
<p>Pavoine, S. (2016) A guide through a family of phylogenetic dissimilarity measures among sites. <em>Oikos</em>, <b>125</b>, 1719&ndash;1732. 
</p>
<p>Pavoine, S., Ricotta, C. (2021) On the relationships between rarity, uniqueness, distinctiveness, originality and functional/phylogenetic diversity. <em>Contact authors for information on this study</em>
</p>
<p>Upham, N.S., Esselstyn, J.A., Jetz, W. (2019) Inferring the mammal tree: Species-level sets of phylogenies for questions in ecology, evolution, and conservation. <em>PloS Biology</em>, <b>17</b>, e3000494. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
if(require(ape)){
data(batcomm)
phy &lt;- read.tree(text=batcomm$tre)
plot(phy)
ab &lt;- batcomm$ab[,phy$tip.label]
plot(abgevodivparam(phy, ab, q=0:4))

phy2 &lt;- read.tree(text=batcomm$tre2)
plot(phy2)
ab2 &lt;- batcomm$ab2[,phy2$tip.label]
plot(abgevodivparam(phy2, ab2, q=0:4))
}

## End(Not run)
</code></pre>

<hr>
<h2 id='betastat'>
Multiple-Site Dissimilarity Measure for Species Presence/Absence
Data
</h2><span id='topic+betastatjac'></span><span id='topic+betastatsor'></span>

<h3>Description</h3>

<p>Functions <code>betastatjac</code> and <code>betastatsor</code> calculate multiple-site dissimilarity (beta diversity). The first one is derived from Jaccard coefficient of similarity and the second from Sorensen coefficient. These proposed dissimilarity indices are additively partitioned into species nestedness and turnover.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>betastatjac(comm)

betastatsor(comm)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="betastat_+3A_comm">comm</code></td>
<td>

<p>a data frame typically with communities as rows, species as columns and presence/absence (1/0) as entries. 
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The two functions return a vector of 4 values:
</p>
<table role = "presentation">
<tr><td><code>beta</code></td>
<td>
<p>Ricotta and Pavoine (2015) <code class="reqn">\beta^+</code> relative measure of additive beta diversity (multiple-site dissimilarity);</p>
</td></tr>
<tr><td><code>betaT</code></td>
<td>
<p>Ricotta and Pavoine (2015) <code class="reqn">\beta_T</code> contribution of species turnover to multiple-site dissimilarity;</p>
</td></tr>
<tr><td><code>betaN</code></td>
<td>
<p>Ricotta and Pavoine (2015) <code class="reqn">\beta_N</code> contribution of species nestedness to multiple-site dissimilarity;</p>
</td></tr>
<tr><td><code>sim</code></td>
<td>
<p>Ricotta and Pavoine (2015) <code class="reqn">\bar{\beta}^{\times}</code> relative measure of multiple-site similarity.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sandrine Pavoine <a href="mailto:sandrine.pavoine@mnhn.fr">sandrine.pavoine@mnhn.fr</a>
</p>


<h3>References</h3>

<p>Ricotta, C. and Pavoine, S. (2015) A multiple-site dissimilarity measure for species presence/absence data and its relationship with nestedness and turnover. <em>Ecological Indicators</em>, <b>54</b>, 203&ndash;206.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(RP15EI)
# Scripts used in Figure 1 of Ricotta and Pavoine (2015)
betastatjac(RP15EI$M1)
betastatjac(RP15EI$M2)
betastatjac(RP15EI$M3)
betastatjac(RP15EI$M4)

#see also
betastatsor(RP15EI$M1)
betastatsor(RP15EI$M2)
betastatsor(RP15EI$M3)
betastatsor(RP15EI$M4)
</code></pre>

<hr>
<h2 id='betaTreeUniqueness'>Plot-to-plot functional or phylogenetic dissimilarity and uniqueness</h2><span id='topic+betaTreeUniqueness'></span>

<h3>Description</h3>

<p>The function <code>betaTreeUniqueness</code> calculates Ricotta et al. (2020) plot-to-plot functional or phylogenetic beta uniqueness (index named <code class="reqn">U_F</code> for functional data and <code class="reqn">U_P</code> for phylogenetic data in Ricotta et al. 2020).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>betaTreeUniqueness(mtree, comm, height = NULL, tol = 0.001)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="betaTreeUniqueness_+3A_mtree">mtree</code></td>
<td>
<p>an object inheriting the class <code>phylo</code> (see package ape), <code>phylo4</code> (see package phylobase), or <code>hclust</code>. The tree must be ultrametric: equal distance from any tip to the root.</p>
</td></tr>
<tr><td><code id="betaTreeUniqueness_+3A_comm">comm</code></td>
<td>
<p>a matrix containing the relative or absolute abundance of all species in plots. Columns are species and plots are rows. Column labels (species names) should be assigned as in <code>mtree</code>.</p>
</td></tr>
<tr><td><code id="betaTreeUniqueness_+3A_height">height</code></td>
<td>
<p>either <code>NULL</code> or a numeric. See details.</p>
</td></tr>
<tr><td><code id="betaTreeUniqueness_+3A_tol">tol</code></td>
<td>
<p>a tolerance threshold. A value between -<code>tol</code> and <code>tol</code> is considered as zero. See details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Object <code>mtree</code> defines a tree with species as tips. If argument <code>height</code> is <code>NULL</code>, then the root of the tree will be placed at the most recent common ancestor of all species occurring in the set of plots (given in object <code>comm</code>). An alternative position for the root can be given by specifying the height of the tree (argument <code>height</code>). In that case, <code>height</code> must be higher than the distance between tips and the most recent common ancestor of all species.
</p>
<p>The tolerance threshold <code>tol</code> is particularly important if your tree is not exactly ultrametric due to approximation problems. In that case, the distance from tip to root varies according to the tip considered, although it should not (variations are due to approximation problems). A difference smaller than <code>tol</code> in the  distance to root for two species will thus be considered as null.
</p>


<h3>Value</h3>

<p>The function returns a matrix with the values of the functional or phylogenetic beta uniqueness for each pair of plots. 
</p>


<h3>Author(s)</h3>

<p>Sandrine Pavoine <a href="mailto:sandrine.pavoine@mnhn.fr">sandrine.pavoine@mnhn.fr</a>
</p>


<h3>References</h3>

<p>Ricotta, C., Laroche, F., Szeidl, L., Pavoine, S. (2020) From alpha to beta functional and phylogenetic redundancy. <em>Methods in Ecology and Evolution</em>, <b>11</b>, 487&ndash;493.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DP">DP</a></code> for plot-to-plot dissimilarities, <code><a href="#topic+treeUniqueness">treeUniqueness</a></code> for alpha uniqueness
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
if(require(ape)){
data(RutorGlacier)
phy &lt;- read.tree(text=RutorGlacier$TreeNW)
plot(phy)

ab &lt;- RutorGlacier$Abund[, phy$tip.label]

# Phylogenetic beta Uniqueness between plots
# (Ricotta et al. 2020)
Up &lt;- betaTreeUniqueness(phy, ab, tol=0.00001)
}

## End(Not run)
</code></pre>

<hr>
<h2 id='betaUniqueness'>Algorithmic index of plot-to-plot functional (or phylogenetic) dissimilarity and uniqueness</h2><span id='topic+betaUniqueness'></span>

<h3>Description</h3>

<p>The function <code>betaUniqueness</code> calculates uniqueness and redundancy taking account of functional dissimilarities between species using equation 5 and 6 in Ricotta et al. (2021). Note that functional dissimilarities could be replaced by any other type of dissimilarities between species, including phylogenetic dissimilarities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>betaUniqueness(comm, dis, Nind = 10000)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="betaUniqueness_+3A_comm">comm</code></td>
<td>
<p>a matrix containing the relative or absolute abundance of all species in plots. Columns are species and plots are rows. Column labels (species names) should be assigned as in <code>dis</code>.</p>
</td></tr>
<tr><td><code id="betaUniqueness_+3A_dis">dis</code></td>
<td>
<p>a matrix or an object of class dist providing the functional dissimilarities between species (dissimilarities are nonnegative, symmetric, and the dissimilarity between a species and itself is zero). <b>Species here must be in the same order as in the columns of comm</b>.</p>
</td></tr>
<tr><td><code id="betaUniqueness_+3A_nind">Nind</code></td>
<td>
<p>an integer. The algorithmic index will be applied by assuming that each plot contains <code>Nind</code> individuals. The highest <code>Nind</code>, the most precise the index value will be (see Gregorius et al. 2003, for more details).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function <code>betaUniqueness</code> returns a list with the following objects:
</p>
<p>- betaUniqueness: a matrix with the values of the proposed beta uniqueness (<code class="reqn">U\beta</code>=DKG/DR) for each pair of plots (Ricotta et al. (2021), eq. 6);
</p>
<p>- betaRedundancy: a matrix with the values of the proposed beta redundancy (<code class="reqn">R\beta</code>=1-DKG/DR) for each pair of plots (Ricotta et al. (2021), eq. 5);
</p>
<p>- dissimilarityGap: a matrix with the values of the dissimilarity gap index (DR-DKG) for each pair of plots;
</p>
<p>- DR: a matrix with the values of the species-based (Rogers) dissimilarity index (DR) for each pair of plots (Ricotta et al. (2021), eq. 4);
</p>
<p>- DKG: a matrix with the values of the algorithmic functional dissimilarity index (DKG) for each pair of plots (Ricotta et al. (2021), eq. 3).
</p>


<h3>Author(s)</h3>

<p>Sandrine Pavoine <a href="mailto:sandrine.pavoine@mnhn.fr">sandrine.pavoine@mnhn.fr</a>
</p>


<h3>References</h3>

<p>Ricotta, C., Kosman, E., Laroche, F., Pavoine, S. (2021) Beta redundancy for functional ecology. <em>Methods in Ecology and Evolution</em>, <b>12</b>, 1062&ndash;1069. <a href="https://doi.org/10.1111/2041-210X.13587">doi:10.1111/2041-210X.13587</a>
</p>
<p>Gregorius, H.-R., Gillet, E.M., Ziehe, M. (2003) Measuring differences of trait distributions between populations. <em>Biometrical Journal</em>, <b>8</b>, 959&ndash;973. <a href="https://doi.org/10.1002/bimj.200390063">doi:10.1002/bimj.200390063</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+betaTreeUniqueness">betaTreeUniqueness</a></code> adapted to the use of phylogenetic trees with species as tips, <code><a href="#topic+dislptransport">dislptransport</a></code> for the algorithmic functional dissimilarity index (DKG in Ricotta et al. 2021), and <code><a href="#topic+uniqueness">uniqueness</a></code> for alpha uniqueness
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(RutorGlacier)
fundis &lt;- dist(scale(RutorGlacier$Traits2[1:6]))
fundis &lt;- fundis/max(fundis)
frameDKG &lt;- betaUniqueness(RutorGlacier$Abund, fundis)

f1 &lt;- unlist(sapply(1:58, function(i) rep(RutorGlacier$Fac[i], 59-i)))
f2 &lt;- unlist(sapply(1:58, function(i) RutorGlacier$Fac[-(1:i)]))
f &lt;- paste(f1, f2, sep="-")
F &lt;- factor(f, levels=c("early-early", "mid-mid", "late-late", "early-mid", 
    "mid-late", "early-late"))

vbetaU_A &lt;- as.vector(as.dist(frameDKG$betaUniqueness))

boxplot(vbetaU_A~F, ylab="Beta uniqueness", xlab="Compared successional stages")
# See Ricotta et al. 2021 Electronic Appendix 3 for for details

## End(Not run)
</code></pre>

<hr>
<h2 id='birdData'>
Avian Communities along Successional Forest Gradients
</h2><span id='topic+birdData'></span>

<h3>Description</h3>

<p>The density of bird species in 3 locations in the Mediterranean region and 2 locations in the central Europe region were collected by Blondel and Farre (1988) along a gradient of habitats.
The densities and a phylogenetic tree are provided for all observed species.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("birdData")</code></pre>


<h3>Format</h3>

<p><code>birdData</code> is a list of 4 objects:
</p>
<p><code>fau</code>, a data frame with communities as rows, species as columns and densities as entries. The names of the communities start with the first three letters of the location and end with the seral stage number. See details.
</p>
<p><code>tre</code>, a string. It contains the phylogeny in a newick format.
</p>
<p><code>facA</code>, a factor. It indicates which location each community belongs to.
</p>
<p><code>facB</code>, a factor. It indicates which seral stage each community belongs to.
</p>


<h3>Details</h3>

<p>The locations are Alg = Algeria, Bur = Burgundy, Cor = Corsica Island, Pol = Poland, Pro = Provence.
</p>
<p>Three are in the Mediterranean region (Provence, southern France; Corsica Island, southern France; and north east Algeria) and two in the central European region (Burgundy, central France; and Poland). 
</p>
<p>In each location, a habitat gradient has been conventionally divided into six seral stages (intermediate stages found in forest ecosystems advancing towards their climax stage after a disturbance event) in such a way that all five selected habitat gradients match one another reasonably well in terms of the number, patterns and overall structure of habitats: from low bushy vegetation, less than 1 m height (stage 1), to forests with trees at least 20 m high (stage 6). 
</p>
<p>The composite phylogenetic tree was obtained based on Davis' supertree: a strict consensus of 2000 trees (see details in Text S5 of Pavoine et al. 2013).  
</p>


<h3>Source</h3>

<p>Dataset S1 in Pavoine et al. (2013)
</p>


<h3>References</h3>

<p>Blondel, J. and Farre, H. (1988) The convergent trajectories of bird communities along ecological successions in European forests. <em>OEcologia (Berlin)</em>, <b>75</b>, 83&ndash;93.
</p>
<p>Davis, K.E. (2008) <em>Reweaving the tapestry: a supertree of birds</em> [PhD thesis]. Glasgow, U.K.: University of Glasgow.
</p>
<p>Pavoine, S., Blondel, J., Dufour, A.-B., Gasc, A., Bonsall, M.B. (2013) A new technique for analysing interacting factors affecting biodiversity patterns: crossed-DPCoA. <em>PloS One</em>, <b>8</b>, e54530. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
if(require(ape) &amp;&amp; require(adephylo)){
data(birdData)
phy &lt;- read.tree(text=birdData$tre)
phydis &lt;- sqrt(distTips(phy, method="nNodes")+1)

fau &lt;- birdData$fau[, phy$tip.label]
facA &lt;- birdData$facA
facB &lt;- birdData$facB

cd_mainB &lt;- crossdpcoa_maineffect(fau, facB, facA, phydis, w=rep(1/30, 30), scannf = FALSE)
s.label(cd_mainB$l2)
}

## End(Not run)
</code></pre>

<hr>
<h2 id='CF'>
Matrices of Intra- and Inter-Specific Similarities
</h2><span id='topic+CFbinary'></span><span id='topic+multiCFbinary'></span><span id='topic+CFprop'></span><span id='topic+multiCFprop'></span>

<h3>Description</h3>

<p>The function <code>CFprop</code> calculates the matrix CF of intra- (diagonal) and inter-specific (off-diagonal) similarities as defined in the main text of Pavoine and Izsak (2014), and matrix CwF as defined in Appendix S3 of Pavoine and Izsak (2014) for weighting functional attributes. The function <code>multiCFprop</code> calculates matrices CwmF1, CwmF2, CwmF3 when several functional traits are considered (Appendix S3 of Pavoine and Izsak 2014). Traits and the attributes of the traits can be weighted. These two functions consider functional traits expressed as proportion (compositional) vectors. The functions <code>CFbinary</code> and <code>multiCFbinary</code> are the equivalents of <code>CFprop</code> and <code>multiCFprop</code> when traits are expressed as binary vectors as shown in Appendix S3 of Pavoine and Izsak (2014).</p>


<h3>Usage</h3>

<pre><code class='language-R'>CFbinary(df, wA = rep(1, ncol(df)))

multiCFbinary(Ktab, w.attributes = lapply(Ktab, function(x) rep(1, ncol(x))), 
w.traits = rep(1/length(Ktab), length(Ktab)), 
labels = rownames(Ktab[[1]]), solution = c(2, 1))

CFprop(df, wA = rep(1, ncol(df)))

multiCFprop(Ktab, w.attributes = lapply(Ktab, function(x) rep(1, ncol(x))), 
w.traits = rep(1/length(Ktab), length(Ktab)), 
labels = rownames(Ktab[[1]]), solution = c(2, 1))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CF_+3A_df">df</code></td>
<td>
<p>a data frame or a matrix with species (or any entities of interest) as rows, functional attributes as columns, and proportions (for <code>CFprop</code>) or 0/1 values (for <code>CFbinary</code>) as entries. The sum of the columns will be standardized to equal 1 in function <code>CFprop</code> but not in <code>CFbinary</code>.</p>
</td></tr>
<tr><td><code id="CF_+3A_wa">wA</code></td>
<td>
<p>a vector of weights that should be given to the attributes (same order as the columns of df).</p>
</td></tr>
<tr><td><code id="CF_+3A_ktab">Ktab</code></td>
<td>
<p>a list of data frames, each of which represents a trait. For a given trait, the data frame should have species (or any entities of interest) as rows, functional attributes as columns, and proportions (for <code>multiCFprop</code>) or 0/1 values (for <code>multiCFbinary</code>) as entries. The sum of the columns will be standardized to equal 1 in function <code>multiCFprop</code> but not in <code>multiCFbinary</code>.</p>
</td></tr>
<tr><td><code id="CF_+3A_w.attributes">w.attributes</code></td>
<td>
<p>a list of weights that should be given to the attributes of each trait. Traits should be in the same order as they appear in the list of tables <code>Ktab</code>. The attributes of a trait should be ordered as the columns of the corresponding data frame in <code>Ktab</code>.</p>
</td></tr>
<tr><td><code id="CF_+3A_w.traits">w.traits</code></td>
<td>
<p>a numeric vector of weights that should be given to the traits (same order as the tables of <code>Ktab</code>).</p>
</td></tr>
<tr><td><code id="CF_+3A_labels">labels</code></td>
<td>
<p>a vector of strings that gives the names of the species (or the other entities of interest; same order as the rows of all tables in <code>Ktab</code>).</p>
</td></tr>
<tr><td><code id="CF_+3A_solution">solution</code></td>
<td>
<p>a numeric value (either 1 or 2) that indicates which equations are used to summarize the information given by several traits among the 2 approaches given in Appendix S3 of Pavoine and Izsak (2014) page 9. If a vector is given, only the first value of the vector is considered.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix with nonnegative values
</p>


<h3>Author(s)</h3>

<p>Sandrine Pavoine <a href="mailto:sandrine.pavoine@mnhn.fr">sandrine.pavoine@mnhn.fr</a>
</p>


<h3>References</h3>

<p>Pavoine, S. and Izsak, J. (2014) New biodiversity measure that includes consistent interspecific and intraspecific components. <em>Methods in Ecology and Evolution</em>, <b>5</b>, 165&ndash;172.</p>


<h3>See Also</h3>

<p><code><a href="#topic+qHdiv">qHdiv</a></code>
</p>

<hr>
<h2 id='crossdpcoa'>
Crossed-DPCoA
</h2><span id='topic+crossdpcoa_maineffect'></span><span id='topic+crossdpcoa_version1'></span><span id='topic+crossdpcoa_version2'></span>

<h3>Description</h3>

<p>Crossed-DPCoA typically analyzes the phylogenetic or functional compositions of communities according to two factors affecting the communities (e.g. space and time; habitat and region)
</p>
<p>The function <code>crossdpcoa_maineffect</code> obtains the space of DPCoA (the double principal coordinate analysis) where species are placed according to their functional traits or phylogeny and communities are placed at the center of their species. Next, levels of each factor are placed at the center of their communities. The function <code>crossdpcoa_maineffect</code> determines the principal axes of the positions of the levels of one of the factors in this space and projects species' points on
these principal axes. The main effect of the factor named <code>facA</code> is analysed by this process (Pavoine et al. 2013).
</p>
<p>The function <code>crossdpcoa_version1</code> performs version 1 of the crossed DPCoA in Pavoine et al. (2013) where the effect of factor <code>facA</code> on the diversity of communities, given factor <code>facB</code>, is analysed.
</p>
<p>The function <code>crossdpcoa_version2</code> performs version 2 of the crossed DPCoA in Pavoine et al. (2013) where the effect of factor <code>facA</code> on the diversity of communities, given factor <code>facB</code>, is also analysed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crossdpcoa_maineffect(df, facA, facB, dis = NULL, 
scannf = TRUE, nf = 2, w = c("classic", "independence"), 
tol = 1e-07)

crossdpcoa_version1(df, facA, facB, dis = NULL, 
scannf = TRUE, nf = 2, w = c("classic", "independence"), 
tol = 1e-07)

crossdpcoa_version2(df, facA, facB, dis = NULL, 
scannf = TRUE, nf = 2, w = c("classic", "independence"), 
tol = 1e-07)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="crossdpcoa_+3A_df">df</code></td>
<td>

<p>a data frame or a matrix of 0/1 or nonnegative values. As an exemple, I consider below a communities x species data frame or matrix with abundances as entries.
</p>
</td></tr>
<tr><td><code id="crossdpcoa_+3A_faca">facA</code></td>
<td>

<p>a factor with the same length as the number of rows (communities) in df.</p>
</td></tr>
<tr><td><code id="crossdpcoa_+3A_facb">facB</code></td>
<td>

<p>another factor with the same length as the number of rows (communities) in df.</p>
</td></tr>
<tr><td><code id="crossdpcoa_+3A_dis">dis</code></td>
<td>

<p>an object of class <code>dist</code> that contains the distances among species (e.g. functional or phylogenetic distances). If <code>NULL</code> equidistances are used among species. The distances must have Euclidean properties. Distances are integrated in the Euclidean Diversity Index (Champely and Chessel 2002), which corresponds to a particular formulation of Rao (1982) quadratic entropy. For example the diversity within a community <em>i</em> is <code class="reqn">EDI=\sum_{k=1}^S\sum_{l=1}^S p_{k|i}p_{k|j}\frac{d_{kl}^2}{2}</code>, where <em>S</em> is  the  number  of  species, <code class="reqn">p_{k|i}</code> is the relative abundance of species <em>k</em> within community <em>i</em>; <code class="reqn">d_{kl}</code> is the (phylogenetic or functional) dissimilarity between species <em>k</em> and <em>l</em>.</p>
</td></tr>
<tr><td><code id="crossdpcoa_+3A_scannf">scannf</code></td>
<td>

<p>a logical value indicating whether the screeplot (with eigenvalues) should be displayed.</p>
</td></tr>
<tr><td><code id="crossdpcoa_+3A_nf">nf</code></td>
<td>

<p>if <code>scannf</code> is <code>FALSE</code>, an integer indicating the number of kept axes.</p>
</td></tr>
<tr><td><code id="crossdpcoa_+3A_w">w</code></td>
<td>

<p>either a string or a numeric vector of positive values that indicates how the rows of <code>df</code> (the communities) should be weighted. If <code>w="classic"</code>, the weights are defined from the sum of the values in each row (e.g. sum of all species abundances within a community). If <code>w="independence"</code>, then the weight attributed to a row of <code>df</code> (a community) is the product of the weight attributed to a level of factor A with the weight attributed to a level of factor B. If a vector of strings is given, only the first one is retained. If numeric, values in <code>w</code> must be in the same order as the rows of <code>df</code> (see Pavoine et al. 2013 for details on the definition of these weights).</p>
</td></tr>
<tr><td><code id="crossdpcoa_+3A_tol">tol</code></td>
<td>

<p>a numeric tolerance threshold: a value between -<code>tol</code> and <code>tol</code> is considered as null.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The functions <code>crossdpcoa_maineffect</code>, <code>crossdpcoa_version1</code> and <code>crossdpcoa_version2</code> return a list containing the following information used for computing the crossed-DPCoA:
</p>
<table role = "presentation">
<tr><td><code>l1</code></td>
<td>
<p>coordinates of the columns of <code>df</code> (the species).</p>
</td></tr>
<tr><td><code>l2</code></td>
<td>
<p>coordinates of the levels of factor A.</p>
</td></tr>
<tr><td><code>l3</code></td>
<td>
<p>(for functions <code>crossdpcoa_version1</code> and <code>crossdpcoa_version2</code> only) coordinates of the rows of <code>df</code> (the communities).</p>
</td></tr>
<tr><td><code>eig</code></td>
<td>
<p>the eigenvalues.</p>
</td></tr>
<tr><td><code>lX</code></td>
<td>
<p>the weights attributed to the columns of <code>df</code> (species).</p>
</td></tr>
<tr><td><code>lA</code></td>
<td>
<p>the weights attributed to the levels of factor A.</p>
</td></tr>
<tr><td><code>lB</code></td>
<td>
<p>the weights attributed to the levels of factor B.</p>
</td></tr>
<tr><td><code>lC</code></td>
<td>
<p>the weights attributed to the rows of <code>df</code> (communities).</p>
</td></tr>
<tr><td><code>div</code></td>
<td>
<p>a numeric vector with the apportionment of Rao's quadratic diversity (APQE).</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the <code>call</code> function.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sandrine Pavoine <a href="mailto:sandrine.pavoine@mnhn.fr">sandrine.pavoine@mnhn.fr</a>
</p>


<h3>References</h3>

<p>Pavoine, S., Blondel, J., Dufour, A.-B., Gasc, A., Bonsall, M.B. (2013) A new technique for analysing interacting factors affecting biodiversity patterns: crossed-DPCoA. <em>PloS One</em>, <b>8</b>, e54530. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
if(require(ape) &amp;&amp; require(phylobase) &amp;&amp; require(adephylo) 
   &amp;&amp; require(adegraphics)){
O &lt;- adegpar()$plabels$optim
adegpar("plabels.optim" = TRUE)

data(birdData)
phy &lt;- read.tree(text=birdData$tre)
phydis &lt;- sqrt(distTips(phy, method="nNodes")+1)

fau &lt;- birdData$fau[, phy$tip.label]
facA &lt;- birdData$facA
facB &lt;- birdData$facB

#Here factor B is put first to analyze 
#the main effect of the strata:
cd_mainB &lt;- crossdpcoa_maineffect(fau, facB, facA, phydis, w=rep(1/30, 30), scannf = FALSE)
barplot(cd_mainB$eig)
cd_mainB$eig[1:2]/sum(cd_mainB$eig)

#Positions of the levels of factor B on its principal axes:
s.label(cd_mainB$l2)
# The "d" value on graphs indicates the length of the edge of a grid cell (scale of the graphic). 

#The coordinates of the species on the same axes 
# can be displayed in front of the phylogeny 
# (several possibilities are provided below, 
# the last one use package adephylo)):
mainBl1.4d &lt;- phylo4d(phy, as.matrix(cd_mainB$l1))
dotp4d(mainBl1.4d, center = FALSE, scale = FALSE)
barp4d(mainBl1.4d, center = FALSE, scale = FALSE)
gridp4d(mainBl1.4d, center = FALSE, scale = FALSE)
parmar &lt;- par()$mar
par(mar=rep(.1,4))
table.phylo4d(mainBl1.4d, show.node=FALSE, symbol="squares",
    center=FALSE, scale=FALSE, cex.label=0.5, ratio.tree=0.7)
par(mar=parmar)

#If factor A is put first, the analysis focus 
#on the main effect of the region:
cd_mainA &lt;- crossdpcoa_maineffect(fau, facA, facB, phydis, w=rep(1/30, 30), scannf = FALSE)
barplot(cd_mainA$eig)
cd_mainA$eig[1:2]/sum(cd_mainA$eig)

#Positions of the levels of factor A on its principal axes:
s.label(cd_mainA$l2)
# The "d" value on graphs indicates the length of the edge of a grid cell (scale of the graphic). 

#The coordinates of the species on the same axes 
# can be displayed in front of the phylogeny
# (several possibilities are provided below, 
# the last one use package adephylo)):
mainAl1.4d &lt;- phylo4d(phy, as.matrix(cd_mainA$l1))
dotp4d(mainAl1.4d, center = FALSE, scale = FALSE)
barp4d(mainAl1.4d, center = FALSE, scale = FALSE)
gridp4d(mainAl1.4d, center = FALSE, scale = FALSE)
parmar &lt;- par()$mar
par(mar=rep(.1,4))
table.phylo4d(mainAl1.4d, show.node=FALSE, symbol="squares", 
   center=FALSE, scale=FALSE, cex.label=0.5, ratio.tree=0.7)
par(mar=parmar)

#Crossed DPCoA Version 1
cd_v1 &lt;- crossdpcoa_version1(fau, facA, facB, phydis, w=rep(1/30, 30), scannf = FALSE)
#Proportion of SS(A) expressed by the two first axes:
cd_v1$eig[1:2]/sum(cd_v1$eig)
#To view the positions of the locations on the first two axes, write:
s.label(cd_v1$l2)
#To view the positions of all communities on the first two axes, write:
s.label(cd_v1$l3)
#To view the positions of the species on the first two axes in front of the phylogeny, write:
v1l1.4d &lt;- phylo4d(phy, as.matrix(cd_v1$l1))
# (then several functions can be used as shown below, 
# the last function, table.phylo4d, is from package adephylo)):
dotp4d(v1l1.4d, center = FALSE, scale = FALSE)
barp4d(v1l1.4d, center = FALSE, scale = FALSE)
gridp4d(v1l1.4d, center = FALSE, scale = FALSE)
parmar &lt;- par()$mar
par(mar=rep(.1,4))
table.phylo4d(v1l1.4d, show.node=FALSE, symbol="squares", 
   center=FALSE, scale=FALSE, cex.label=0.5, ratio.tree=0.7)
par(mar=parmar)

#Crossed DPCoA Version 2
#Crossed DPCoA version 2 can now be performed as follows:
cd_v2 &lt;- crossdpcoa_version2(fau, facA, facB, phydis, w=rep(1/30, 30), scannf = FALSE)
#Proportion of variation among levels of factor A 
#in the subspace orthogonal to the principal axes of B
#expressed by the two first axes:
cd_v2$eig[1:2]/sum(cd_v2$eig)
#To view the positions of the locations on the first two axes, write:
s.label(cd_v2$l2)
#To view the positions of all communities on the first two axes, write:
s.label(cd_v2$l3)
#To view the positions of the species on the first two axes in front of the phylogeny, write:
v2l1.4d &lt;- phylo4d(phy, as.matrix(cd_v2$l1))
# (then several functions can be used as shown below, 
# the last function, table.phylo4d, is from package adephylo)):
dotp4d(v2l1.4d, center = FALSE, scale = FALSE)
barp4d(v2l1.4d, center = FALSE, scale = FALSE)
gridp4d(v2l1.4d, center = FALSE, scale = FALSE)
parmar &lt;- par()$mar
par(mar=rep(.1,4))
table.phylo4d(v2l1.4d, show.node=FALSE, symbol="squares", 
   center=FALSE, scale=FALSE, cex.label=0.5, ratio.tree=0.7)
par(mar=parmar)

adegpar("plabels.optim" = O)
}

## End(Not run)
</code></pre>

<hr>
<h2 id='dbMANOVAspecies'>Indicator species analysis in the framework of multivariate analysis of variance</h2><span id='topic+dbMANOVAspecies'></span><span id='topic+dbMANOVAspecies_pairwise'></span><span id='topic+summary.dbMANOVAspecies_pairwise'></span>

<h3>Description</h3>

<p>&quot;Consider N plots distributed among K groups; plots are composed of species whose abundances within each plot are known. The QT, QB and QW statistics defined in [Ricotta et al. 2021] aim at evaluating the average difference, in terms of species identity and abundance, between any two plots (QT), between two plots within a group (QW), and the gap between QT and QW (=QB) due to compositional differences between groups of plots. The function <code>dbMANOVAspecies</code> calculates QT, QB and QW as in [Ricotta et al. 2021] and the species-centered components QTs, QBs and QWs. It also calculates the SES values (equation 7 [in Ricotta et al. 2021]) associated with QB and QBs and allows tests for the significance of the SES values (H0 = the SES value is similar as that expected by randomly permuting plots among groups of plots and H1 = the SES value of is greater than that expected by randomly permuting plots among groups of plots). The function <code>dbMANOVAspecies_pairwise</code> complements function <code>dbMANOVAspecies</code> by performing post-hoc tests for all pairs of groups. It must be executed in the same R environment (workspace) as function <code>dbMANOVAspecies</code>. A third function named <code>summary.dbMANOVAspecies_pairwise</code> provides a short summary of the results of function <code>dbMANOVAspecies_pairwise</code> (with SES and P values)&quot; (Ricotta et al. 2021, Appendix 3).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dbMANOVAspecies(comm, groups, nrep = 999, method = c("Euclidean", "Manhattan", 
    "Canberra", "BrayCurtis"), global = TRUE, species = TRUE, padjust = "none", 
    tol = 1e-8)
    
    dbMANOVAspecies_pairwise(dbobj, signif = TRUE, salpha = 0.05, nrep = NULL)
    
    ## S3 method for class 'dbMANOVAspecies_pairwise'
summary(object, DIGITS = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dbMANOVAspecies_+3A_comm">comm</code></td>
<td>
<p>a matrix of N plots <code class="reqn">\times</code> S species containing the relative or absolute abundance of all species. Columns are species and plots are rows.</p>
</td></tr>
<tr><td><code id="dbMANOVAspecies_+3A_groups">groups</code></td>
<td>
<p>a vector of characters or a factor with the names of the groups associated with plots. Names of groups must be listed in the same order as plots in object comm. For example, the first value of groups gives the name of the group for the first plot (first row in object comm).</p>
</td></tr>
<tr><td><code id="dbMANOVAspecies_+3A_nrep">nrep</code></td>
<td>
<p>a numeric that gives the number of permutations to be done. nrep can be set to NULL in function <code>dbMANOVAspecies_pairwise</code>, in which case the number of permutations used to built object dbobj (first argument of function <code>dbMANOVAspecies_pairwise</code>) is used by default.</p>
</td></tr>
<tr><td><code id="dbMANOVAspecies_+3A_method">method</code></td>
<td>
<p>a string, one of <code>"Euclidean"</code> (to perform the Euclidean distance), <code>"Manhattan"</code> (to select the Manhattan distance), <code>"Canberra"</code> (to perform the Canberra distance), <code>"BrayCurtis"</code> (to opt for the BrayCurtis distance).</p>
</td></tr>
<tr><td><code id="dbMANOVAspecies_+3A_global">global</code></td>
<td>
<p>a logical. If <code>TRUE</code> the global test (using the SES of QB) is performed. The global test can be performed in addition to one test per species.</p>
</td></tr>
<tr><td><code id="dbMANOVAspecies_+3A_species">species</code></td>
<td>
<p>a logical. If <code>TRUE</code> one test per species is performed. If <code>species = FALSE</code>, then argument global is ignored and the global test is performed.</p>
</td></tr>
<tr><td><code id="dbMANOVAspecies_+3A_padjust">padjust</code></td>
<td>
<p>a method of correction for multiple tests one of p.adjust.methods (see <code>?p.adjust.methods</code> for possible choices); choose <code>"none"</code> if you don't need any correction for multiple tests. The argument <code>padjust</code> is ignored if <code>species = FALSE</code>.</p>
</td></tr>
<tr><td><code id="dbMANOVAspecies_+3A_tol">tol</code></td>
<td>
<p>a numeric tolerance threshold. Any value between <code>-tol</code> and <code>tol</code> will be considered as equal to zero.</p>
</td></tr>
<tr><td><code id="dbMANOVAspecies_+3A_dbobj">dbobj</code></td>
<td>
<p>an object of class <code>"dbMANOVAspecies"</code> obtained with function <code>dbMANOVAspecies</code>.</p>
</td></tr>
<tr><td><code id="dbMANOVAspecies_+3A_signif">signif</code></td>
<td>
<p>a logical. If <code>TRUE</code>, the post-hoc tests are performed only for species that were associated with significant tests in object dbobj.</p>
</td></tr>
<tr><td><code id="dbMANOVAspecies_+3A_salpha">salpha</code></td>
<td>
<p>a numeric. The level of significance (nominal alpha error) for P values (must be between 0 and 1). Ignored if <code>signif = FALSE</code>.</p>
</td></tr>
<tr><td><code id="dbMANOVAspecies_+3A_object">object</code></td>
<td>
<p>an object of class <code>"dbMANOVAspecies_pairwise"</code> obtained with function <code>dbMANOVAspecies_pairwise</code>.</p>
</td></tr>
<tr><td><code id="dbMANOVAspecies_+3A_digits">DIGITS</code></td>
<td>
<p>integer indicating the number of decimal places to retain when displaying the results. If NULL, all decimals are retained.</p>
</td></tr>
<tr><td><code id="dbMANOVAspecies_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>dbMANOVAspecies</code> returns a list with the following objects:
</p>
<p>-<code>observations</code>: a vector or a data frame with the observed values of statistics (QT, QB and QW) (if global = TRUE) and/or the contribution each species has to these statistics (if species = TRUE);
</p>
<p>-<code>test</code>: an object of class randtest or krandtest with the results of the test for the global differences, in terms of species composition, between groups of plots (if global = TRUE) and/or for the contribution each species has in these differences (if species = TRUE). <code>dbMANOVAspecies_pairwise</code> provides in a list the same objects as function <code>dbMANOVAspecies</code> but for each pair of groups (see examples below).
</p>
<p>If only a global test was performed, <code>summary.dbMANOVAspecies_pairwise</code> provides a data frame with two rows named &quot;SES&quot; for the SES values (of the QB statistic) and &quot;pvalue&quot; for the P values and as many columns as there are pairs of groups of plots. Columns are named according to the two groups that are compared. For example, if there are two groups named Group1 and Group2, they are compared in column named &quot;Group1:Group2&quot;. Else, it provides a data frame with species names as rows (in addition to a row named GLOBAL if a global test was also performed) and as columns the SES, P values, and if relevant adjusted P values, for each combination of two groups. Consider that Group1 and Group2 are the names of two groups. The column names that correspond to the comparison between Group1 and Group2 are written Group1:Group2.SES (for the SES values), Group1:Group2.pvalue (for the P values), and Group1:Group2.adj.pvalue (for the P values adjusted after correction for multiple tests, if a correction was done). NAs (= missing values) may be present in the data frame for species that are absent from two compared groups of plots. NAs may also be present in the data frame if signif = TRUE was used in function <code>dbMANOVAspecies_pairwise</code> for species that were associated to a non-significant test when performing function <code>dbMANOVAspecies</code>.
</p>


<h3>Author(s)</h3>

<p>Sandrine Pavoine <a href="mailto:sandrine.pavoine@mnhn.fr">sandrine.pavoine@mnhn.fr</a>
</p>


<h3>References</h3>

<p>Ricotta, C., Pavoine, S., Cerabolini, B.E.L., Pillar, V.D. (2021) A new method for indicator species analysis in the framework of multivariate analysis of variance. <em>Journal of Vegetation Science</em>, <b>32</b>, e13013. <a href="https://doi.org/10.1111/jvs.13013">doi:10.1111/jvs.13013</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(RutorGlacier)
Qspecies &lt;- dbMANOVAspecies(RutorGlacier$Abund, RutorGlacier$Fac, 
    nrep=9999, global=TRUE)
Qspecies_adj &lt;- dbMANOVAspecies(RutorGlacier$Abund, RutorGlacier$Fac, 
    nrep=9999, global=FALSE, padj = "BY")
# In Qspecies and Qspecies_adj, Column "Std.Obs" contains the SES values.
# Now for all species that showed significant compositional difference among 
# the three groups of plots (with a nominal alpha error of 0.05), we can test for 
# pairwise differences among all pairs of groups thanks to function 
# dbMANOVAspecies_pairwise as shown below:

# without any correction for multiple tests
Qspeciespairwise &lt;- dbMANOVAspecies_pairwise(Qspecies)
summary(Qspeciespairwise)
# NAs are present in the data frame above for species that were associated 
# to non-significant test in object Qspecies (where tests were done over all groups);
# and also, for species that are absent from the two compared groups of plots 
# (e.g. species Adenostyles leucophylla, in mid- and late-successional stages).

# with correction for multiple test
Qspeciespairwise_adj &lt;- dbMANOVAspecies_pairwise(Qspecies_adj)
summary(Qspeciespairwise_adj)
# Here again, NAs are present in the data frame above for species that were 
# associated to non-significant test in object Qspecies_adj 
# (where tests were done over all groups); and also, for species that are absent 
# from the two compared groups of plots (e.g. species Adenostyles leucophylla, 
# in mid- and late-successional stages).

# See Ricotta et al. 2021 Appendix 3 for details.

## End(Not run)
</code></pre>

<hr>
<h2 id='decdiv'>
Decomposition of trait-based diversity along the nodes of a phylogenetic tree
</h2><span id='topic+decdiv'></span><span id='topic+plot.decdiv'></span><span id='topic+rtestdecdiv'></span>

<h3>Description</h3>

<p>The function <code>decdiv</code> calculates trait-based differences between the lineages that descend from a node of a phylogenetic tree in one or several communities (using presence/absence or abundance data).  
</p>
<p>The function <code>plot.decdiv</code> plots the result of function decdiv for one of the communities. 
</p>
<p>The function <code>rtestdecdiv</code> tests, for one community (with presence/absence or abundance data), if the representation of trait diversity on the phylogenetic tree highlights a nonrandom pattern. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>decdiv(phyl, comm, dis = NULL, tol = 1e-08, option = 1:5, 
     formula = c("QE", "EDI"))

## S3 method for class 'decdiv'
plot(x, ncom = 1, col = "black", 
    csize = 1, legend = TRUE, ...)

rtestdecdiv(phyl, vecab, dis = NULL, tol = 1e-08, 
    option = 1:5, formula = c("QE", "EDI"), 
    vranking = c("complexity", "droot"), 
    ties.method = c("average", "first", "last", "random", 
    "max", "min"), statistic = 1:3, optiontest = NULL, nrep = 99)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="decdiv_+3A_phyl">phyl</code></td>
<td>

<p>an object inheriting the class <code>phylo</code> (see package ape), <code>phylo4</code> (see package phylobase) or <code>hclust</code> with species as tips. To ease the interpretation of the results, I advise you to add labels to the nodes of the phylogeny. For example, If your phylogeny is named 'tree' and is of class <code>phylo</code>, you can name the nodes with the following command:
<code>tree$node.label &lt;- paste("n", 1:tree$Nnode, sep="")</code>. Use <code>plot(tree, show.node.label=TRUE)</code> to see the result. If it is of class <code>phylo4</code>, you can use: <code>nodeLabels(tree) &lt;- paste("n", 1:nNodes(tree), sep="")</code>. 
</p>
</td></tr>
<tr><td><code id="decdiv_+3A_comm">comm</code></td>
<td>

<p>a vector with species presence/absence or an index of abundance as entries, or a data frame or a matrix typically with communities as rows, species as columns and presence/absence or an index of abundance as entries. Species names in <code>comm</code> must be similar as in <code>phyl</code>. Even if <code>comm</code> is a vector, each entry needs to have a species name (use function <code>name</code> to attribute names to a vector).
</p>
</td></tr>
<tr><td><code id="decdiv_+3A_dis">dis</code></td>
<td>

<p>either <code>NULL</code> or an object of class <code>dist</code> that contains the trait-based distances among species. If <code>NULL</code>, the Gini-Simpson index is used.
</p>
</td></tr>
<tr><td><code id="decdiv_+3A_tol">tol</code></td>
<td>

<p>a tolerance threshold (a value between -<code>tol</code> and <code>tol</code> is considered equal to zero)</p>
</td></tr>
<tr><td><code id="decdiv_+3A_option">option</code></td>
<td>
<p>a numeric (either 1, 2, 3, 4 or 5) indicating the option to use to calculate the contribution of each node of the phylogenetic tree to trait-based diversity. See details. If several values are given, the function retains only the first one.</p>
</td></tr>
<tr><td><code id="decdiv_+3A_formula">formula</code></td>
<td>

<p>either <code>"QE"</code> (default) or <code>"EDI"</code>. See details. If several values are given, the function retains only the first one.
</p>
</td></tr>
<tr><td><code id="decdiv_+3A_x">x</code></td>
<td>

<p>an object of class <code>decdiv</code>.
</p>
</td></tr>
<tr><td><code id="decdiv_+3A_ncom">ncom</code></td>
<td>

<p>if <code>comm</code> is a matrix, the number of its row corresponding to the focal community for which the results of decdiv will be plotted. Igored if <code>comm</code> is a vector. 
</p>
</td></tr>
<tr><td><code id="decdiv_+3A_col">col</code></td>
<td>

<p>the color of circles displayed at each node.
</p>
</td></tr>
<tr><td><code id="decdiv_+3A_csize">csize</code></td>
<td>

<p>a positive numeric giving the scale for plotting the circle at each node. 1 is the default size; if zero, no circle is drawn.
</p>
</td></tr>
<tr><td><code id="decdiv_+3A_legend">legend</code></td>
<td>

<p>a logical indicating whether the legend for the circle size needs to be displayed.
</p>
</td></tr>
<tr><td><code id="decdiv_+3A_...">...</code></td>
<td>

<p>further arguments that can be specified to the internal use of function <code>plot.phylo</code> (argument <code>y.lim</code> cannot be modified).
</p>
</td></tr>
<tr><td><code id="decdiv_+3A_vecab">vecab</code></td>
<td>
<p>a numeric vector giving the presence/absence(1/0) or abundance(non-negative value) of species in a community.</p>
</td></tr>
<tr><td><code id="decdiv_+3A_vranking">vranking</code></td>
<td>
<p>a string with 2 possible values: either &quot;complexity&quot; for a ranking according to the complexity of the subtree rooted on each interior node (see Pavoine et al. 2010 for an explanation), or &quot;droot&quot; for ordering interior nodes by the distance between them and the root node of the tree.</p>
</td></tr>
<tr><td><code id="decdiv_+3A_ties.method">ties.method</code></td>
<td>
<p>a string to be passed to function <code>rank</code> of the base of R. It can be one of &quot;average&quot;, &quot;first&quot;, &quot;last&quot;, &quot;random&quot;, &quot;max&quot;, &quot;min&quot;.</p>
</td></tr>
<tr><td><code id="decdiv_+3A_statistic">statistic</code></td>
<td>
<p>a numeric value or a vector of numeric values. Possible values are 1, 2, or 3. They correspond to the three statistics S1, S2 and S3, respectively, developed by Pavoine et al. (eqs. 5 to 7 in Pavoine et al. 2010).</p>
</td></tr>
<tr><td><code id="decdiv_+3A_optiontest">optiontest</code></td>
<td>
<p>a vector of strings specifying the alternative hypothesis of each test, which must be one of &quot;greater&quot;, &quot;less&quot; or &quot;two-sided&quot;. If null, then statistic=1 is associated with &quot;greater&quot; and statistic=2 and =3 with &quot;two-sided&quot;. See function <code>as.randtest</code> of package ade4 for details on these alternatives. The length of the vector given to <code>optiontest</code> must be equal to that given to  <code>statistic</code>.</p>
</td></tr>
<tr><td><code id="decdiv_+3A_nrep">nrep</code></td>
<td>
<p>numeric; the number of permutations to be done in each permutation test.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>decdiv</code> relies on Rao's (1982) quadratic entropy (QE) to measure the trait-based diversity of a set of species. Two formulas for QE have been introduced in the literature one is the original formula by Rao (1982) (which corresponds to <code>formula = "QE"</code>) and the other one introduced by Champely and Chessel (2002), named Euclidean Diversity Index (which corresponds to <code>formula = "EDI"</code>). See function <code><a href="#topic+QE">QE</a></code> for more details.
</p>
<p>In function <code>decdiv</code>, each node has a weight proportional to the summed relative abundance of its descending species (or to the relative number of descending species if presence/absence data are used). 
</p>
<p>With <code>option = 1</code>, the function <code>decdiv</code> apportions trait-based diversity across the nodes of a phylogenetic tree using the algorithm defined in Pavoine et al. (2010). In that case the value at a given node is equal to the weight of a node times a measure of beta trait-based diversity between the lineages that descend from the node. The sum of all values attributed to the nodes of a phylogeny is equal to the total trait-based diversity of the species (tips of the phylogeny) as defined by Rao's quadratic entropy. 
In case of dichotomic trees, only two lineages descend from a given node. Here I consider a more general case where more than two lineages may descend from a node (polytomy). The beta trait-based diversity among the lineages that descend from a node is measured here as the average trait-based dissimilarity between any two of these descending lineages. With <code>option = 1</code>, the trait-based dissimilarity between two lineages is measured by Rao's DISC index (gamma diversity [average trait-based dissimilarity between any two species descending from the node] - alpha diversity [average trait-based dissimilarity between any two species descending from one of the lineages branched to the node]).   
</p>
<p>In the present version of function <code>decdiv</code>, I have added other options. Options 2 and 3 code different ways of measuring trait-based differences between lineages, standardized between 0 and 1: with <code>option = 2</code>, the formula is (gamma - alpha) / (1 - alpha) * M / (M - 1), where gamma and alpha are defined above (for <code>option = 1</code>) and M is the number of lineages descending from the node; with <code>option = 3</code>, the formula is (gamma - alpha) / (1 - gamma) / (M - 1).
</p>
<p>Options 4 and 5 decompose the result given by <code>option = 1</code>. <code>option = 4</code> returns gamma minus alpha (a measure of beta functional diversity between the lineages that descend from a node). <code>option = 5</code> returns the weights of the nodes (the summed relative abundance of its descending species or the relative number of descending species if presence/absence data are used). 
</p>
<p>Values for <code>option</code> different from 1 needs that values in <code>dis</code> (the trait-based dissimilarities between species) are bounded between 0 and 1 if <code>formula = QE</code> or sqrt(2) if <code>formula = EDI</code>. If they are not bounded, the function <code>decdiv</code> will bound them using the maximum observed value in <code>dis</code>. 
</p>
<p>The argument <code>ties.method</code> in <code>rtestdecdiv</code> allows you to explicitly take into account potential ties when ranking nodes according to their complexity or their distance to root (see Pavoine et al. 2010 for more details on the permutation test implemented in rtestdecdiv).
</p>


<h3>Value</h3>

<p>Function <code>decdiv</code> returns a matrix with nodes of the phylogenetic tree as rows and the decomposition of trait-based diversity in communities as columns. 
An attribute of this matrix is the phylogenetic tree (of class <code>phylo</code> with specified names for nodes). If the nodes of <code>phyl</code> had no names, the function <code>decdiv</code> automatically attributed names to them. 
</p>


<h3>Author(s)</h3>

<p>Sandrine Pavoine <a href="mailto:sandrine.pavoine@mnhn.fr">sandrine.pavoine@mnhn.fr</a>
</p>


<h3>References</h3>

<p>Champely, S. and Chessel, D. (2002) Measuring biological diversity using Euclidean metrics. <em>Environmental and Ecological Statistics</em>, <b>9</b>, 167&ndash;177.
</p>
<p>Pavoine, S., Baguette, M., Bonsall, M.B. (2010) Decomposition of trait diversity among the nodes of a phylogenetic tree. <em>Ecological Monographs</em>, <b>80</b>, 485&ndash;507.
</p>
<p>Rao, C.R. (1982) Diversity and dissimilarity coefficients: a unified approach. <em>Theoretical Population Biology</em>, <b>21</b>, 24&ndash;43.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
if(require(ape) &amp;&amp; require(adephylo)){
data(ungulates)
ung.phy &lt;- read.tree(text=ungulates$tre)
ung.phy$node.label
plot(ung.phy, show.node.label=TRUE)
# Regaring traits, we log-tranformed the first three traits 
# measuring volumes 
# and we standardized all the traits (mean=0; variance=1).
tab &lt;- cbind.data.frame(afbw = log(ungulates$tab$afbw),
mnw = log(ungulates$tab$mnw), fnw = log(ungulates$tab$fnw),
ls = ungulates$tab$ls)
ung.tab0 &lt;- data.frame(scalewt(tab))
ung.tab0 &lt;- data.frame(scalewt(log(ungulates$tab)))
ung.pres &lt;- rep(1, nrow(ung.tab0))
names(ung.pres) &lt;- rownames(ung.tab0)
ung.dec1 &lt;- decdiv(ung.phy, ung.pres, dist(ung.tab0), 
    option=1, formula = "EDI")
plot.decdiv(ung.dec1)

ung.dec2 &lt;- decdiv(ung.phy, ung.pres, dist(ung.tab0), 
    option=2, formula = "EDI")
plot.decdiv(ung.dec2)

ung.dec3 &lt;- decdiv(ung.phy, ung.pres, dist(ung.tab0), 
    option=3, formula = "EDI")
plot.decdiv(ung.dec3)

ung.dec4 &lt;- decdiv(ung.phy, ung.pres, dist(ung.tab0), 
    option=4, formula = "EDI")
plot.decdiv(ung.dec4)

ung.dec5 &lt;- decdiv(ung.phy, ung.pres, dist(ung.tab0), 
    option=5, formula = "EDI")
plot.decdiv(ung.dec5)
}

## End(Not run)
</code></pre>

<hr>
<h2 id='dislptransport'>Algorithmic index of plot-to-plot functional (or phylogenetic) dissimilarity</h2><span id='topic+dislptransport'></span>

<h3>Description</h3>

<p>The function <code>dislptransport</code> calculates the DKG measure of dissimilarity (Kosman 1996; Gregorius et al. 2003) applied here to functional differences between plots (eq. 3 in Ricotta et al. 2021).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dislptransport(comm, dis, diag = FALSE, upper = FALSE, Nind = 10000)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dislptransport_+3A_comm">comm</code></td>
<td>
<p>a matrix containing the relative or absolute abundance of all species in plots. Columns are species and plots are rows. Column labels (species names) should be assigned as in <code>dis</code>.</p>
</td></tr>
<tr><td><code id="dislptransport_+3A_dis">dis</code></td>
<td>
<p>a matrix or an object of class dist providing the functional dissimilarities between species (dissimilarities are nonnegative, symmetric, and the dissimilarity between a species and itself is zero). <b>Species here must be in the same order as in the columns of comm</b>.</p>
</td></tr>
<tr><td><code id="dislptransport_+3A_diag">diag</code></td>
<td>
<p>logical value indicating whether the diagonal of the dissimilarity matrix should be printed by <code>print.dist</code>.</p>
</td></tr>
<tr><td><code id="dislptransport_+3A_upper">upper</code></td>
<td>
<p>logical value indicating whether the upper triangle of the distance matrix should be printed by <code>print.dist</code>.</p>
</td></tr>
<tr><td><code id="dislptransport_+3A_nind">Nind</code></td>
<td>
<p>an integer. The algorithmic index will be applied by assuming that each plot contains <code>Nind</code> individuals. The highest <code>Nind</code>, the most precise the index value will be (see Gregorius et al. 2003, for more details).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function <code>dislptransport</code> returns an object of class <code>dist</code> matrix with the values of the dissimilarity index DKG (Ricotta et al. 2021) for each pair of plots. 
</p>


<h3>Author(s)</h3>

<p>Sandrine Pavoine <a href="mailto:sandrine.pavoine@mnhn.fr">sandrine.pavoine@mnhn.fr</a>
</p>


<h3>References</h3>

<p>Ricotta, C., Kosman, E., Laroche, F., Pavoine, S. (2021) Beta redundancy for functional ecology. <em>Methods in Ecology and Evolution</em>, <b>12</b>, 1062&ndash;1069. <a href="https://doi.org/10.1111/2041-210X.13587">doi:10.1111/2041-210X.13587</a>
</p>
<p>Gregorius, H.-R., Gillet, E.M., Ziehe, M. (2003) Measuring differences of trait distributions between populations. <em>Biometrical Journal</em>, <b>8</b>, 959&ndash;973. <a href="https://doi.org/10.1002/bimj.200390063">doi:10.1002/bimj.200390063</a>
</p>
<p>Kosman, E. (1996) Difference and diversity of plant pathogen populations: a new approach for measuring. <em>Phytopathology</em>, <b>86</b>, 1152&ndash;1155.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+betaUniqueness">betaUniqueness</a></code> for plot-to-plot functional (or phylogenetic) uniqueness indices.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(RutorGlacier)
fundis &lt;- dist(scale(RutorGlacier$Traits2[1:6]))
fundis &lt;- fundis/max(fundis)
DKG &lt;- dislptransport(RutorGlacier$Abund, fundis)

## End(Not run)
</code></pre>

<hr>
<h2 id='dissABC'>
Phylogenetic and Functional Similarity between Communities
</h2><span id='topic+dissABC'></span>

<h3>Description</h3>

<p>Coefficients of similarity between communities that rely on the presence/absence of species are generally based on various combinations of the matching/mismatching components of the classical 2 x 2 contingency table. Three of these components are: a=the number of species shared by the two communities; b=the number of species in the first community that are not in the second; c=the number of species in the second community that are not in the first. These coefficients are extended in <code>dissABC</code> to include phylogenetic or functional information on species (Ricotta and Pavoine 2015).</p>


<h3>Usage</h3>

<pre><code class='language-R'>dissABC(comm, dis, option = 1:4, method = c("J", "S", "O", "K", "SS","Si"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dissABC_+3A_comm">comm</code></td>
<td>

<p>a data frame or a matrix typically with communities as rows, species as columns and relative abundance or absolute abundance as entries. Column labels (species names) should be assigned as in the object <code>dis</code>.
</p>
</td></tr>
<tr><td><code id="dissABC_+3A_dis">dis</code></td>
<td>
<p>a matrix (or data frame) of (phylogenetic or functional) dissimilarities among species rescaled in the range [0, 1] or an object of class <code>dist</code> containing these dissimilarities [obtained by functions like <code><a href="#topic+dsimFun">dsimFun</a></code> in this package adiv, <code>vegdist</code> in package vegan, <code>gowdis</code> in package FD, or <code>dist.ktab</code> in package ade4 for functional dissimilarities, or functions like <code><a href="#topic+dsimTree">dsimTree</a></code> in this package adiv, <code>cophenetic.phylo</code> in package ape or <code>distTips</code> in package adephylo for phylogenetic dissimilarities]. See also function <code><a href="#topic+dsimTaxo">dsimTaxo</a></code> for taxonomic data. Note that dissimilarities among species need first to be rescaled in the range [0, 1]. If the dissimilarities are outside the range 0-1, a warning message is displayed and each dissimilarity is divided by the maximum over all pair-wise dissimilarities.</p>
</td></tr>
<tr><td><code id="dissABC_+3A_option">option</code></td>
<td>

<p>a numeric, either 1, 2, 3, or 4 (if several values are given only the first one is considered). See details.
</p>
</td></tr>
<tr><td><code id="dissABC_+3A_method">method</code></td>
<td>

<p>a character or string, either <code>"J"</code>, <code>"S"</code>, <code>"O"</code>, <code>"K"</code>, <code>"SS"</code>, or <code>"Si"</code> (if several values are given only the first one is considered). See details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To obtain the dissimilarities among plots, one needs to choose the equations to be used for the (phylogenetic or functional) components A, B, and C thanks to argument <code>option</code> and the way the components will be combined, thanks to argument <code>method</code>.
</p>
<p>Let <code class="reqn">\mathbf{D}=(d_{ij})</code> a matrix of (functional, morphological or phylogenetic) dissimilarities between pairs of species with <code class="reqn">d_{ij} = d_{ji}</code> and <code class="reqn">d_{ii} = 0</code>. If the dissimilarity coefficient <em>d</em> is in the range [0, 1], it is possible to define a corresponding similarity coefficient <em>s</em> as the complement of <em>d</em>: <em>s</em> = 1 - <em>d</em>. Let <code class="reqn">x_{ik}</code> the abundance of species <em>i</em> in community <em>k</em>. <em>S(kh)</em> is the number of species in the pooled communities <em>k</em> and <em>h</em> (i.e. the species for which <code class="reqn">min\{x_{ik}, x_{ih}\} &gt; 0</code>). The (absolute) abundance of species similar to <em>i</em> in plot <em>k</em> is
</p>
<p style="text-align: center;"><code class="reqn">Z_{ik}=\sum_{j=1}^{S(kh)}x_{jk}s_{ij}</code>
</p>
<p>. 
</p>
<p>If <code>option=1</code>, equations 6-8 of the main text of Ricotta and Pavoine (2015) are used for calculating components A, B, C:
</p>
<p style="text-align: center;"><code class="reqn">A=\sum_{i=1}^{S(kh)}min\{Z_{ik}, Z_{ih}\}</code>
</p>

<p style="text-align: center;"><code class="reqn">B=\sum_{i=1}^{S(kh)}(max\{Z_{ik}, Z_{ih}\}-Z_{ih})</code>
</p>

<p style="text-align: center;"><code class="reqn">C=\sum_{i=1}^{S(kh)}(max\{Z_{ik}, Z_{ih}\}-Z_{ik})</code>
</p>

<p>If <code>option=2</code>, equations A1-A3 from Appendix S1 of Ricotta and Pavoine (2015) are used. 
</p>
<p>If <code>option=3</code>, equations A5-A7 from Appendix S1 of Ricotta and Pavoine (2015) are used. 
</p>
<p>If <code>option=4</code>, equations A10-A12 from Appendix S1 of Ricotta and Pavoine (2015) are used.
</p>
<p>If <code>method="J"</code>=the Jaccard index is used: 
</p>
<p style="text-align: center;"><code class="reqn">\frac{A}{A+B+C}</code>
</p>

<p>If <code>method="S"</code>=the Sorensen index is used: 
</p>
<p style="text-align: center;"><code class="reqn">\frac{2A}{2A+B+C}</code>
</p>

<p>If <code>method="O"</code>=the Ochiai index is used: </p>
<p style="text-align: center;"><code class="reqn">A/(\sqrt{A+B}\sqrt{A+C})</code>
</p>

<p>If <code>method="K"</code>, the Kulczynski index is used:
</p>
<p style="text-align: center;"><code class="reqn">\frac{1}{2}\left(\frac{A}{A+B}+\frac{A}{A+C}\right)</code>
</p>

<p>If <code>method="SS"</code>, the Sokal-Sneath index is used:
</p>
<p style="text-align: center;"><code class="reqn">\frac{A}{A+2B+2C}</code>
</p>

<p>If <code>method="Si"</code>, the Simpson index is used:
</p>
<p style="text-align: center;"><code class="reqn">\frac{A}{A+min(B,C)}</code>
</p>



<h3>Value</h3>

<p>Function <code>dissABC</code> returns a matrix with the values of the proposed similarities among communities based on interspecies resemblances.
</p>


<h3>Author(s)</h3>

<p>Sandrine Pavoine <a href="mailto:sandrine.pavoine@mnhn.fr">sandrine.pavoine@mnhn.fr</a>
</p>


<h3>References</h3>

<p>Ricotta, C. and Pavoine, S. (2015) Measuring similarity among plots including similarity among species: an extension of traditional approaches. <em>Journal of Vegetation Science</em>, <b>26</b>, 1061&ndash;1067.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+discomQE">discomQE</a></code>, <code><a href="#topic+evodiss">evodiss</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(RP15JVS)
dissABC(RP15JVS$ab, RP15JVS$D1, method="J", option=1)
J &lt;- as.matrix(dissABC(RP15JVS$ab, RP15JVS$D1, method="J", option=1))[, 1]
SS &lt;- as.matrix(dissABC(RP15JVS$ab, RP15JVS$D1, method="SS", option=1))[, 1]
S &lt;- as.matrix(dissABC(RP15JVS$ab, RP15JVS$D1, method="S", option=1))[, 1]
O &lt;- as.matrix(dissABC(RP15JVS$ab, RP15JVS$D1, method="O", option=1))[, 1]
K &lt;- as.matrix(dissABC(RP15JVS$ab, RP15JVS$D1, method="K", option=1))[, 1]
plot(1:9, J, 
xlab="Number of the plots which plot 1 is compared to",
 ylab="Similarity", type="b", ylim=c(0,1), pch=18)
lines(1:9, SS, type="b", pch=15)
lines(1:9, S, type="b", pch=17)
lines(1:9, O, type="b", pch=12)
lines(1:9, K, type="b", pch=1)
legend("bottomleft", 
c("Jaccard","Sokal-Sneath","Sorensen","Ochiai","Kulczynski"), 
pch=c(18,15,17,12,1), lty=1)
</code></pre>

<hr>
<h2 id='dissRicotta'>
Plot-to-Plot Functional or Phylogenetic Dissimilarity 
</h2><span id='topic+dissRicotta'></span>

<h3>Description</h3>

<p>The function calculates plot-to-plot functional or phylogenetic dissimilarity based on index <code class="reqn">D_{AB}</code> in Ricotta et al. (2015).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dissRicotta(comm, dis)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dissRicotta_+3A_comm">comm</code></td>
<td>

<p>a matrix of the relative or absolute abundance of species in communities. Columns are species and communities are rows. Column labels (species names) should be assigned as in <code>dis</code>.</p>
</td></tr>
<tr><td><code id="dissRicotta_+3A_dis">dis</code></td>
<td>

<p>a matrix of (functional or phylogenetic) dissimilarities rescaled in the range [0, 1] or an object of class <code>dist</code> [obtained by functions like <code><a href="#topic+dsimFun">dsimFun</a></code> in this package adiv, <code>vegdist</code> in package vegan, <code>gowdis</code> in package FD, or <code>dist.ktab</code> in package ade4 for functional dissimilarities, or functions like <code><a href="#topic+dsimTree">dsimTree</a></code> in this package adiv, <code>cophenetic.phylo</code> in package ape or <code>distTips</code> in package adephylo for phylogenetic dissimilarities; See also function <code><a href="#topic+dsimTaxo">dsimTaxo</a></code> for taxonomic data].</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a semi-matrix of class <code>dist</code> with the values of the proposed dissimilarities for each pair of plots. Note that dissimilarities among species need first to be rescaled in the range [0, 1]. If the dissimilarities are outside the range 0-1 (as it is usually the case in phylogenetic studies for instance), a warning message is displayed and all dissimilarities are divided by the maximum observed dissimilarity.</p>


<h3>Author(s)</h3>

<p>Giovanni Bacaro
and
Sandrine Pavoine <a href="mailto:sandrine.pavoine@mnhn.fr">sandrine.pavoine@mnhn.fr</a>
</p>


<h3>References</h3>

<p>Ricotta, C., Bacaro, G., Pavoine, S. (2015) A cautionary note on some phylogenetic dissimilarity measures. <em>Journal of Plant Ecology</em>, <b>8</b>, 12&ndash;16.</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
if(require(ape)){
# Phylogenetic tree
s&lt;-"test(((v:20,w:20):10,(x:20,y:20):10):15,z:45):5;"
plot(test &lt;- read.tree(text=s))

# Phylogenetic distances among species
tdist &lt;- cophenetic(test)/100

# Matrix of abundances of the species in four communities; 
# communities A and C are identical;
# communities B and D are identical;
comm &lt;- t(data.frame(A = rep(0.2, 5), 
B = c(0.1, 0.2, 0.2, 0, 0.5), C = rep(0.2, 5), 
D = c(0.1, 0.2, 0.2, 0, 0.5), row.names = letters[22:26]))

# Index DAB
dissRicotta(comm, tdist)
}

## End(Not run)
</code></pre>

<hr>
<h2 id='distinctAb'>
Abundance-based measures of species' rarity, functional or phylogenetic distinctiveness and functional or phylogenetic effective originality 
</h2><span id='topic+distinctAb'></span>

<h3>Description</h3>

<p>The function calculates parametric indices of species' rarity and functional or phylogenetic distinctiveness and effective originality according to Pavoine and Ricotta (2021).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>distinctAb(comm, disORtree, method = c("Q", "KY", "KstarI"), palpha = 2, 
    option = c("asymmetric", "symmetric"), tol = 1e-10)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="distinctAb_+3A_comm">comm</code></td>
<td>
<p>a data frame or a matrix typically with communities as rows, species as columns and abundance as entry. Species should be labelled as in object <code>disORtree</code>.</p>
</td></tr>
<tr><td><code id="distinctAb_+3A_disortree">disORtree</code></td>
<td>
<p>an object inheriting the class <code>dist</code>, giving the FP-dissimilarities between species, or inheriting the class <code>phylo</code> (see package ape), <code>phylo4</code> (see package phylobase), or <code>hclust</code>, where species are tips.</p>
</td></tr>
<tr><td><code id="distinctAb_+3A_method">method</code></td>
<td>
<p>a string either <code>"Q"</code> for the quadratic entropy, <code>"KY"</code> for index <code class="reqn">^{\alpha}K</code> (if <code>disORtree</code> is of class <code>dist</code>) or <code class="reqn">^{\alpha}Y</code> if <code>disORtree</code> is of class <code>phylo</code>, <code>phylo4</code> or <code>hclust</code>; or <code>"KstarI"</code> for index <code class="reqn">^{\alpha}K*</code> (if <code>disORtree</code> is of class <code>dist</code>) or <code class="reqn">^{\alpha}I</code> if <code>disORtree</code> is of class <code>phylo</code>, <code>phylo4</code> or <code>hclust</code>. If several values are given, only the first one is considered.</p>
</td></tr>
<tr><td><code id="distinctAb_+3A_palpha">palpha</code></td>
<td>
<p>a numeric, nonnegative value for parameter <code class="reqn">\alpha</code>. <code>palpha</code> is ignored if <code>method = "Q"</code>.</p>
</td></tr>
<tr><td><code id="distinctAb_+3A_option">option</code></td>
<td>
<p>a string either <code>"asymmetric"</code>, or<code>"symmetric"</code> The parameter <code>option</code> is only used if <code>disORtree</code> is of class <code>phylo</code>, <code>phylo4</code> or <code>hclust</code> If <code>option="symmetric"</code>, the distance between two tips on a tree is defined as half the sum of branch length on the smallest path that connects the two species; while if <code>option="asymmetric"</code> the distance between a tip <em>i</em> and a tip <em>j</em> on a tree is defined as the sum of branch lengths between tip <em>i</em> and its most recent ancestor with tip <em>j</em>. If the tree is ultrametric, the two options are equivalent.</p>
</td></tr>
<tr><td><code id="distinctAb_+3A_tol">tol</code></td>
<td>
<p>numeric tolerance threshold: values between -<code>tol</code> and <code>tol</code> are considered equal to zero.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>palpha</code> &lt;= 1, then, the function returns a list of four objects of class <code>data.frame</code> (with communities as rows and species as columns):
<code>TotContr</code> provides for each species in each community the effective originality multiplied by the relative abundance;
<code>EffOriPres</code> provides for each species present in each community the effective originality; NA for absent species;
<code>DistinctPres</code> provides for each species present in each community the distinctiveness; NA for absent species;
<code>Rarity</code> provides for each species in each community the rarity (maximum rarity for absent species).
</p>
<p>Else, the function returns a list with the three objects of class <code>data.frame</code> presented above and two additional objects also of class <code>data.frame</code>:
<code>EffOriAll</code> provides for each species its effective originality compared with the composition of each community; even absent species have a value considering they have zero abundance so maximum rarity and considering their functional dissimilarity or phylogenetic dissimilarity with all species present in each community;
<code>DistinctAll</code> provides for each species its effective originality compared with the composition of each community; even absent species have a value considering they have zero abundance so maximum rarity and considering their functional dissimilarity or phylogenetic dissimilarity with all species present in each community.
</p>


<h3>Author(s)</h3>

<p>Sandrine Pavoine <a href="mailto:sandrine.pavoine@mnhn.fr">sandrine.pavoine@mnhn.fr</a>
</p>


<h3>References</h3>

<p>Pavoine, S., Ricotta, C. (2021) On the relationships between rarity, uniqueness, distinctiveness, originality and functional/phylogenetic diversity. <em>BiorXiv</em>. <a href="https://doi.org/10.1101/2021.08.09.455640">doi:10.1101/2021.08.09.455640</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+distinctDis">distinctDis</a></code>, <code><a href="#topic+distinctTopo">distinctTopo</a></code>, <code><a href="#topic+distinctTree">distinctTree</a></code>, <code><a href="#topic+distinctUltra">distinctUltra</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
if(require(ape) &amp;&amp; require(adephylo) &amp;&amp; require(phylobase)){
data(batcomm)
phy &lt;- read.tree(text=batcomm$tre2)
disAb &lt;- distinctAb(batcomm$ab2, phy, method="Q") 
U.4d &lt;- phylo4d(phy, t(disAb[[2]]))
dotp4d(U.4d, center = FALSE, scale = FALSE, data.xlim = range(t(disAb[[2]]), na.rm=TRUE), 
    tree.ratio = 0.20, dot.cex=2)
title("Effective originality associated with quadratic entropy (diversity)")
}

## End(Not run)
</code></pre>

<hr>
<h2 id='distinctDis'>
Dissimilarity-based Species' Originality 
</h2><span id='topic+distinctDis'></span>

<h3>Description</h3>

<p>The function calculates five indices of species' originality.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>distinctDis(dis, method = c("Rb", "AV", "FV", "NN", "Dstar", "full"), 
    palpha = 0, standardized = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="distinctDis_+3A_dis">dis</code></td>
<td>

<p>an object of class <code>dist</code> containing pair-wise (functional or phylogenetic) dissimilarities between species.
</p>
</td></tr>
<tr><td><code id="distinctDis_+3A_method">method</code></td>
<td>

<p>a vector of strings. Possible values are <code>"Rb"</code>, <code>"AV"</code>, 
<code>"FV"</code>, <code>"NN"</code>, <code>"Dstar"</code> and <code>"full"</code>. 
<code>"Rb"</code> is for Pavoine et al. (2017) index Rb; <code>"AV"</code> is for AV, the 
average dissimilarity between a species and all others in a set (Eiswerth and 
Haney 1992; Ricotta 2004); <code>"FV"</code> is for FV, the average dissimilarity 
between a species and any other (including the focal species itself) (Schmera 
et al. 2009); <code>"NN"</code> is for the minimum dissimilarity between a species 
and any other (the dissimilarity to its Nearest Neighbor) (Pavoine et al. 
2017);  <code>Dstar</code> is the parametric indices <code class="reqn">^{\alpha}D*</code> developed by Pavoine and Ricotta (2021, Appendix B); <code>"full"</code> returns all indices.</p>
</td></tr> 
<tr><td><code id="distinctDis_+3A_palpha">palpha</code></td>
<td>
<p>a numeric which provides the value of parameter <code class="reqn">\alpha</code> in index <code class="reqn">^{\alpha}D*</code> developed by Pavoine and Ricotta (2021, Appendix B).</p>
</td></tr>
<tr><td><code id="distinctDis_+3A_standardized">standardized</code></td>
<td>

<p>a logical. If <code>TRUE</code>, the vector of originalities is divided by its sum (transforming absolute originalities into relative originalities).
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with species as rows and originality indices as columns.
</p>


<h3>Author(s)</h3>

<p>Sandrine Pavoine <a href="mailto:sandrine.pavoine@mnhn.fr">sandrine.pavoine@mnhn.fr</a>
</p>


<h3>References</h3>

<p>Eiswerth, M.E. and Haney, J.C. (1992) Allocating conservation expenditures: accounting for inter-species genetic distinctiveness. <em>Ecological Economics</em>, <b>5</b>, 235&ndash;249.
</p>
<p>Pavoine, S., Bonsall, M.B., Dupaix, A., Jacob, U., Ricotta, C. (2017) From phylogenetic to functional originality: guide through indices and new developments. <em>Ecological Indicators</em>, <b>82</b>, 196&ndash;205.
</p>
<p>Pavoine, S., Ricotta, C. (2021) On the relationships between rarity, uniqueness, distinctiveness, originality and functional/phylogenetic diversity. <em>BiorXiv</em>. <a href="https://doi.org/10.1101/2021.08.09.455640">doi:10.1101/2021.08.09.455640</a>
</p>
<p>Ricotta, C. (2004) A parametric diversity measure combining the relative abundances and taxonomic distinctiveness of species. <em>Diversity and Distributions</em>, <b>10</b>, 143&ndash;146.
</p>
<p>Schmera, D., Podani, J., Eros, T. (2009) Measuring the contribution of community members to functional diversity. <em>Oikos</em>, <b>118</b>, 961&ndash;971.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+distinctTopo">distinctTopo</a></code>, <code><a href="#topic+distinctTree">distinctTree</a></code>, <code><a href="#topic+distinctUltra">distinctUltra</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>e &lt;- rlnorm(10)
e &lt;- sort(e)
names(e) &lt;- paste("s", 1:10, sep="")
d &lt;- dist(e)
barplot(e)

D &lt;- distinctDis(d, standardized = TRUE)

par(mfrow=c(4,2))
plot(e, D[,1], xlab="trait", ylab="Rb")
plot(e, D[,2], xlab="trait", ylab="AV")
plot(e, D[,3], xlab="trait", ylab="FV")
plot(e, D[,4], xlab="trait", ylab="NN")

plot(D[,1], D[,2], xlab="Rb", ylab="AV")
plot(D[,1], D[,3], xlab="Rb", ylab="FV")
plot(D[,2], D[,3], xlab="AV", ylab="FV")
plot(D[,2], D[,4], xlab="AV", ylab="NN")
par(mfrow=c(1,1))
</code></pre>

<hr>
<h2 id='distinctTopo'>
Topology-based Species' Originality 
</h2><span id='topic+distinctTopo'></span>

<h3>Description</h3>

<p>The function calculates three indices of species' originality that rely on the topology of (phylogenetic) trees. Trees with polytomies are allowed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>distinctTopo(phyl, method = c("VW","M","A","full"), standardized = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="distinctTopo_+3A_phyl">phyl</code></td>
<td>

<p>an object inheriting the class <code>phylo</code> (see package ape), <code>phylo4</code> (see package phylobase), or <code>hclust</code>.
</p>
</td></tr>
<tr><td><code id="distinctTopo_+3A_method">method</code></td>
<td>

<p>a character or string or a vector of characters/strings. Possible values are <code>"VW"</code>, <code>"M"</code>, <code>"A"</code> and <code>"full"</code>. <code>"VW"</code> is for Vane-Wright et al. index (Vane-Wright et al. 1991); <code>"M"</code> is for May index (May 1990); <code>"A"</code> is for Pavoine et al. index of originality derived from Abouheif (1999) (Pavoine et al. 2008); and &quot;full&quot; returns all indices.
</p>
</td></tr>
<tr><td><code id="distinctTopo_+3A_standardized">standardized</code></td>
<td>

<p>a logical. If <code>FALSE</code>, the minimum score is scaled to 1 as in May (1990). If <code>TRUE</code>, the vector of originalities is divided by its sum (transforming absolute originalities into relative originalities).
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with species as rows and originality indices as columns.
</p>


<h3>Author(s)</h3>

<p>Sandrine Pavoine <a href="mailto:sandrine.pavoine@mnhn.fr">sandrine.pavoine@mnhn.fr</a>
with contributions of Stephane Dray
</p>


<h3>References</h3>

<p>May, R.M. (1990) Taxonomy as destiny. <em>Nature</em>, <b>347</b>, 129&ndash;130.
</p>
<p>Vane-Wright, R.I., Humphries, C.J., Williams, P.H. (1991) What to protect? Systematics and the agony of choice. <em>Biological Conservation</em>, <b>55</b>, 235&ndash;254.
</p>
<p>Abouheif, E. (1999) A method for testing the assumption of phylogenetic independence in comparative data. <em>Evolutionary Ecology Research</em>, <b>1</b>, 895&ndash;909.
</p>
<p>Pavoine, S., Ollier, S., Pontier, D., Chessel, D. (2008) Testing for phylogenetic signal in phenotypic traits: new matrices of phylogenetic proximities. <em>Theoretical Population Biology</em>, <b>73</b>, 79&ndash;91.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+distinctDis">distinctDis</a></code>, <code><a href="#topic+distinctTree">distinctTree</a></code>, <code><a href="#topic+distinctUltra">distinctUltra</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
if(require(ape) &amp;&amp; require(adephylo) &amp;&amp; require(phylobase)){
data(carni70, package = "adephylo")
tre &lt;- read.tree(text=carni70$tre)
U &lt;- distinctTopo(tre, standardized = TRUE)
U.4d &lt;- phylo4d(tre, as.matrix(U))
dotp4d(U.4d, center = FALSE, scale = FALSE)
barp4d(U.4d, center = FALSE, scale = FALSE)
gridp4d(U.4d, center = FALSE, scale = FALSE)

parmar &lt;- par()$mar
par(mar=rep(.1,4))
table.phylo4d(U.4d, show.node=FALSE, symbol="squares", center=FALSE, scale=FALSE, cex.symbol=2)
par(mar=parmar)
}

## End(Not run)
</code></pre>

<hr>
<h2 id='distinctTree'>
Tree-based Species' Originality 
</h2><span id='topic+distinctTree'></span>

<h3>Description</h3>

<p>The function calculates indices of species' originality that rely on the structure and branch lengths of (phylogenetic) trees. Trees with polytomies are allowed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>distinctTree(phyl, method = c("ED", "ES", "Delta*"), palpha = 0, standardized = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="distinctTree_+3A_phyl">phyl</code></td>
<td>

<p>an object inheriting the class <code>phylo</code> (see package ape), <code>phylo4</code> (see package phylobase) or <code>hclust</code>. 
</p>
</td></tr>
<tr><td><code id="distinctTree_+3A_method">method</code></td>
<td>

<p>a string or a vector of strings. Possible values are <code>"ED"</code>, 
<code>"ES"</code>, and <code>"Delta*"</code>. <code>"ED"</code> is for the evolutionary 
distinctiveness, also named fair-proportion, index (Redding 2003; Isaac et 
al. 2007); <code>"ES"</code> is for the Equal-Splits index (Redding and Mooers 
2006); <code>"Delta*"</code> is for the parametric <code class="reqn">^{\alpha}\Delta</code> index of 
Pavoine and Ricotta (2021).</p>
</td></tr>
<tr><td><code id="distinctTree_+3A_palpha">palpha</code></td>
<td>
<p>a numeric value or a numeric vector of values for parameter <code class="reqn">\alpha</code> of <code class="reqn">^{\alpha}\Delta</code> index by 
Pavoine and Ricotta (2021).</p>
</td></tr> 
<tr><td><code id="distinctTree_+3A_standardized">standardized</code></td>
<td>

<p>a logical. If <code>TRUE</code>, the vector of originalities is divided by its sum (transforming absolute originalities into relative originalities).
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with species as rows and originality indices as columns.
</p>


<h3>Author(s)</h3>

<p>Sandrine Pavoine <a href="mailto:sandrine.pavoine@mnhn.fr">sandrine.pavoine@mnhn.fr</a>
</p>


<h3>References</h3>

<p>Isaac, N.J., Turvey, S.T., Collen, B., Waterman, C., Baillie, J.E. (2007) Mammals on the EDGE: conservation priorities based on threat and phylogeny. <em>PloS ONE</em>, <b>2</b>, e296.
</p>
<p>Pavoine, S., Ricotta, C. (2021) On the relationships between rarity, uniqueness, distinctiveness, originality and functional/phylogenetic diversity. <em>BiorXiv</em>. <a href="https://doi.org/10.1101/2021.08.09.455640">doi:10.1101/2021.08.09.455640</a>
</p>
<p>Redding, D.W. (2003) <em>Incorporating genetic distinctness and reserve occupancy into a conservation priorisation approach</em>. Master thesis: University of East Anglia, Norwich.
</p>
<p>Redding, D.W., Mooers, A.O. (2006) Incorporating evolutionary measures into conservation prioritization. <em>Conservation Biology</em>, <b>20</b>, 1670&ndash;1678.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+distinctDis">distinctDis</a></code>, <code><a href="#topic+distinctTopo">distinctTopo</a></code>, <code><a href="#topic+distinctUltra">distinctUltra</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
if(require(ape) &amp;&amp; require(adephylo) &amp;&amp; require(phylobase)){
data(carni70, package = "adephylo")
tre &lt;- read.tree(text=carni70$tre)
U &lt;- distinctTree(tre, standardize = TRUE)
U.4d &lt;- phylo4d(tre, as.matrix(U))
dotp4d(U.4d, center = FALSE, scale = FALSE)
barp4d(U.4d, center = FALSE, scale = FALSE)
gridp4d(U.4d, center = FALSE, scale = FALSE)

parmar &lt;- par()$mar
par(mar=rep(.1,4))
table.phylo4d(U.4d, show.node=FALSE, symbol="squares", center=FALSE, scale=FALSE, cex.symbol=2)
par(mar=parmar)
}

## End(Not run)
</code></pre>

<hr>
<h2 id='distinctUltra'>
Ultrametric Tree-based Species' Originality 
</h2><span id='topic+distinctUltra'></span>

<h3>Description</h3>

<p>The function calculates two indices of species' originality that rely on the structure and branch lengths of ultrametric (phylogenetic) trees. Trees with polytomies are allowed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>distinctUltra(phyl, method = c("Qb","2Hb"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="distinctUltra_+3A_phyl">phyl</code></td>
<td>

<p>an object inheriting the class <code>phylo</code> (see package ape), <code>phylo4</code> (see package phylobase), or <code>hclust</code>, with ultrametric properties.
</p>
</td></tr>
<tr><td><code id="distinctUltra_+3A_method">method</code></td>
<td>

<p>a string or a vector of strings. Possible values are <code>Qb</code> and <code>2Hb</code>. <code>Qb</code> is for the Pavoine et al. QE-based (also named Qb) index (Pavoine et al. 2005); <code>2Hb</code> is for Pavoine et al. 2H-based index (which could also be named more shortly as 2Hb) (vector that maximizes index <code class="reqn">^2H</code>, Pavoine and Izsak 2014).
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with species as rows and originality indices as columns.
</p>


<h3>Author(s)</h3>

<p>Sandrine Pavoine <a href="mailto:sandrine.pavoine@mnhn.fr">sandrine.pavoine@mnhn.fr</a>
with contributions of Stephane Dray
</p>


<h3>References</h3>

<p>Pavoine, S., Ollier, S., Dufour, A.B. (2005) Is the originality of a species measurable? <em>Ecology Letters</em>, <b>8</b>, 579&ndash;586.
</p>
<p>Pavoine, S. and Izsak, J. (2014) New biodiversity measure that includes consistent interspecific and intraspecific components. <em>Methods in Ecology and Evolution</em>, <b>5</b>, 165&ndash;172.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+distinctDis">distinctDis</a></code>, <code><a href="#topic+distinctTopo">distinctTopo</a></code>, <code><a href="#topic+distinctTree">distinctTree</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
if(require(ape) &amp;&amp; require(adephylo) &amp;&amp; require(phylobase)){
data(carni70, package = "adephylo")
tre &lt;- read.tree(text=carni70$tre)
U &lt;- distinctUltra(tre)
U.4d &lt;- phylo4d(tre, as.matrix(U))

dotp4d(U.4d, center = FALSE, scale = FALSE)
barp4d(U.4d, center = FALSE, scale = FALSE)
gridp4d(U.4d, center = FALSE, scale = FALSE)

parmar &lt;- par()$mar
par(mar=rep(.1,4))
table.phylo4d(U.4d, show.node=FALSE, symbol="squares", center=FALSE, scale=FALSE, cex.symbol=2)
par(mar=parmar)
}

## End(Not run)
</code></pre>

<hr>
<h2 id='distMS'>
Marczewski-Steinhaus Coefficient
</h2><span id='topic+distMS'></span>

<h3>Description</h3>

<p>The function calculates the Marczewski-Steinhaus coefficient of dissimilarity between pairs of entities (e.g. communities)</p>


<h3>Usage</h3>

<pre><code class='language-R'>distMS(comm, diag = FALSE, upper = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="distMS_+3A_comm">comm</code></td>
<td>

<p>a data frame or a matrix of nonnegative values (e.g. abundance of species (columns) within communities (rows) to obtain dissimilarities between communities).
</p>
</td></tr>
<tr><td><code id="distMS_+3A_diag">diag</code></td>
<td>

<p>a logical value indicating whether the diagonal of the distance matrix should be printed by function <code>print.dist</code>.
</p>
</td></tr>
<tr><td><code id="distMS_+3A_upper">upper</code></td>
<td>

<p>a logical value indicating whether the upper triangle of the distance matrix should be printed by function <code>print.dist</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class <code>dist</code>
</p>


<h3>Note</h3>

<p>This function is a modification of function <code>dist.quant</code> from library ade4 where other dissimilarity coefficients can be found.
</p>


<h3>Author(s)</h3>

<p>Sandrine Pavoine <a href="mailto:sandrine.pavoine@mnhn.fr">sandrine.pavoine@mnhn.fr</a>
</p>


<h3>References</h3>

<p>Orloci, L. (1978) <em>Multivariate Analysis in Vegetation Research</em>. The Hague: Junk.
</p>
<p>Legendre, P. and Legendre, L. (1998) Numerical Ecology. Amsterdam: Elsevier.
</p>
<p>Ricotta, C., de Bello, F., Moretti, M., Caccianiga, M., Cerabolini, B.E., Pavoine, S. (2016). Measuring the functional redundancy of biological communities: a quantitative guide. <em>Methods in Ecology and Evolution</em>, <b>7</b>, 1386&ndash;1395.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(birdData)
distMS(birdData$fau)
</code></pre>

<hr>
<h2 id='divparam'>
Parametric Indices of Species Diversity
</h2><span id='topic+divparam'></span><span id='topic+plot.divparam'></span>

<h3>Description</h3>

<p>The function <code>divparam</code> calculates parametric diversity indices. The parameter controls the relative importance given to rare versus abundant species in a community.
The function <code>plot.divparam</code> plots the results of function <code>divparam</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>divparam(comm, method = c("hill", "tsallis", "renyi"), q = 2, tol = 1e-08)

## S3 method for class 'divparam'
plot(x, legend = TRUE, 
legendposi = "topright", axisLABEL = "Diversity", type = "b", 
col = if (is.numeric(x)) NULL 
else sample(colors(distinct = TRUE), nrow(x$div)), 
lty = if (is.numeric(x)) NULL else rep(1, nrow(x$div)), 
pch = if (is.numeric(x)) NULL else rep(19, nrow(x$div)), 
...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="divparam_+3A_comm">comm</code></td>
<td>

<p>a data frame or a matrix typically with communities as rows, species as columns and abundance as entry. 
</p>
</td></tr>
<tr><td><code id="divparam_+3A_method">method</code></td>
<td>

<p>a string: either &quot;hill&quot; for the Hill numbers (Hill 1973), &quot;tsallis&quot; for the Tsallis or HCDT entropy (Harvda and Charvat 1967; Daroczy 1970; Tsallis 1988), or &quot;renyi&quot; for Renyi's entropy (Renyi 1960).
</p>
</td></tr>
<tr><td><code id="divparam_+3A_q">q</code></td>
<td>

<p>a positive numeric or a vector of positive numerics that gives values for the <code>q</code> parameter.
</p>
</td></tr>
<tr><td><code id="divparam_+3A_tol">tol</code></td>
<td>

<p>numeric tolerance threshold: values between -tol and tol are considered equal to zero.
</p>
</td></tr>
<tr><td><code id="divparam_+3A_x">x</code></td>
<td>

<p>an object of class <code>divparam</code> obtained with function <code>divparam</code>.
</p>
</td></tr>
<tr><td><code id="divparam_+3A_legend">legend</code></td>
<td>

<p>a logical. If TRUE a legend is given with the colour, the type of line (etc.) used to define the diversity curve of each community.
</p>
</td></tr>
<tr><td><code id="divparam_+3A_legendposi">legendposi</code></td>
<td>

<p>a string or a numeric that gives the position of the legend to be passed to function <code>legend</code> of the base of R.
</p>
</td></tr>
<tr><td><code id="divparam_+3A_axislabel">axisLABEL</code></td>
<td>

<p>a string to display on the main axis of the plot to designate what we are measuring. The default is <code>"Diversity"</code>. 
</p>
</td></tr>
<tr><td><code id="divparam_+3A_type">type</code></td>
<td>

<p>a string to be passed to the graphic argument <code>type</code> of functions <code>plot</code> and <code>lines</code> used to draw the diversity curve of each community.
</p>
</td></tr>
<tr><td><code id="divparam_+3A_col">col</code></td>
<td>

<p>colours to be passed to the graphic argument <code>col</code> of functions <code>plot</code> and <code>lines</code> to define the colour of the diversity curve of each community.
</p>
</td></tr>
<tr><td><code id="divparam_+3A_lty">lty</code></td>
<td>

<p>type of line (plain, broken etc.) to be passed to the graphic argument <code>lty</code> of functions <code>plot</code> and <code>lines</code> used to draw the diversity curve of each community.
</p>
</td></tr>
<tr><td><code id="divparam_+3A_pch">pch</code></td>
<td>

<p>type of point (open circle, close circle, square etc.) to be passed to the graphic argument <code>pch</code> of functions <code>plot</code> and <code>lines</code> used to draw the diversity curve of each community.
</p>
</td></tr>
<tr><td><code id="divparam_+3A_...">...</code></td>
<td>

<p>other arguments can be added and passed to the functions <code>plot</code> and <code>lines</code> used to draw the graphic.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If only a single value of <code>q</code> is given, function <code>divparam</code> returns a vector with the diversities of the communities. If more than one value of <code>q</code> is given, a list of two objects is returned: 
</p>
<table role = "presentation">
<tr><td><code>q</code></td>
<td>
<p>the vector of values for <code>q</code></p>
</td></tr>
<tr><td><code>div</code></td>
<td>
<p>a data frame with the diversities of the communities calculated for all values of <code>q</code></p>
</td></tr>
</table>
<p>The function <code>plot.divparam</code> returns a graphic.
</p>


<h3>Author(s)</h3>

<p>Sandrine Pavoine <a href="mailto:sandrine.pavoine@mnhn.fr">sandrine.pavoine@mnhn.fr</a>
</p>


<h3>References</h3>

<p>Daroczy, Z. (1970) Generalized information functions. <em>Information and Control</em>, <b>16</b>, 36&ndash;51.
</p>
<p>Havrda, M., Charvat, F. (1967) Quantification method of classification processes: concept of structural alpha-entropy. <em>Kybernatica</em>, <b>3</b>, 30&ndash;35.
</p>
<p>Hill, M.O. (1973) Diversity and evenness: a unifying notation and its consequences. <em>Ecology</em>, <b>54</b>, 427&ndash;432.
</p>
<p>Renyi, A. (1960) On measures of entropy and information. <em>Proceedings of the Fourth Berkeley Symposium on Mathematical Statistics and Probability</em>, <b>1</b>, 547&ndash;561.
</p>
<p>Tsallis, C. (1988) Possible generalization of Boltzmann-Gibbs statistics. <em>Journal of Statistical Physics</em>, <b>52</b>, 480&ndash;487.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(batcomm)
ab &lt;- batcomm$ab
plot(divparam(ab))
plot(divparam(ab, q=0:4))
</code></pre>

<hr>
<h2 id='DP'>Plot-to-plot functional or phylogenetic dissimilarity</h2><span id='topic+DP'></span>

<h3>Description</h3>

<p>The function <code>DP</code> calculates Ricotta et al. (2020) plot-to-plot functional or phylogenetic beta uniqueness (index named <code class="reqn">D_F</code> for functional data and <code class="reqn">D_P</code> for phylogenetic data, calculated with equation 2 in Ricotta et al. 2020).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DP(mtree, comm, height = NULL, diag = FALSE, upper = FALSE, tol = 0.001)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DP_+3A_mtree">mtree</code></td>
<td>
<p>an object inheriting the class <code>phylo</code> (see package ape), <code>phylo4</code> (see package phylobase), or <code>hclust</code>. The tree must be ultrametric: equal distance from any tip to the root.</p>
</td></tr>
<tr><td><code id="DP_+3A_comm">comm</code></td>
<td>
<p>a matrix containing the relative or absolute abundance of all species in plots. Columns are species and plots are rows. Column labels (species names) should be assigned as in <code>mtree</code>.</p>
</td></tr>
<tr><td><code id="DP_+3A_height">height</code></td>
<td>
<p>either <code>NULL</code> or a numeric. See details.</p>
</td></tr>
<tr><td><code id="DP_+3A_diag">diag</code></td>
<td>
<p>a logical value indicating whether the diagonal of the distance matrix should be printed by function <code><a href="stats.html#topic+print.dist">print.dist</a></code>.</p>
</td></tr>
<tr><td><code id="DP_+3A_upper">upper</code></td>
<td>
<p>a logical value indicating whether the upper triangle of the distance matrix should be printed by function <code><a href="stats.html#topic+print.dist">print.dist</a></code>.</p>
</td></tr>
<tr><td><code id="DP_+3A_tol">tol</code></td>
<td>
<p>a tolerance threshold. A value between -<code>tol</code> and <code>tol</code> is considered as zero. See details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Object <code>mtree</code> defines a tree with species as tips. If argument <code>height</code> is <code>NULL</code>, then the root of the tree will be placed at the most recent common ancestor of all species occurring in the set of plots (given in object <code>comm</code>). An alternative position for the root can be given by specifying the height of the tree (argument <code>height</code>). In that case, <code>height</code> must be higher than the distance between tips and the most recent common ancestor of all species.
</p>
<p>The tolerance threshold <code>tol</code> is particularly important if your tree is not exactly ultrametric due to approximation problems. In that case, the distance from tip to root varies according to the tip considered, although it should not (variations are due to approximation problems). A difference smaller than <code>tol</code> in the  distance to root for two species will thus be considered as null.
</p>


<h3>Value</h3>

<p>The function returns a (semi-)matrix of class <code>dist</code> with the values of the proposed dissimilarities for each pair of plots. 
</p>


<h3>Author(s)</h3>

<p>Sandrine Pavoine <a href="mailto:sandrine.pavoine@mnhn.fr">sandrine.pavoine@mnhn.fr</a>
</p>


<h3>References</h3>

<p>Ricotta, C., Laroche, F., Szeidl, L., Pavoine, S. (2020) From alpha to beta functional and phylogenetic redundancy. <em>Methods in Ecology and Evolution</em>. In press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+betaTreeUniqueness">betaTreeUniqueness</a></code> for beta uniqueness, <code><a href="#topic+treeUniqueness">treeUniqueness</a></code> for alpha uniqueness
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
if(require(ape) &amp;&amp; require(ade4)){
data(RutorGlacier)
phy &lt;- read.tree(text=RutorGlacier$TreeNW)
plot(phy)

ab &lt;- RutorGlacier$Abund[, phy$tip.label]

# Phylogenetic dissimilarities between plots
# (Ricotta et al. 2020)
Dp &lt;- DP(phy, ab, tol=0.00001)
# Principal Coordinate Analysis of the dissimilarities
pcoDp &lt;- dudi.pco(sqrt(Dp), full=TRUE)
s.class(pcoDp$li, as.factor(RutorGlacier$Fac))
}

## End(Not run)
</code></pre>

<hr>
<h2 id='dsimcom'>
Functional or Phylogenetic Similarity between Species and Communities
</h2><span id='topic+dsimcom'></span><span id='topic+SQ'></span><span id='topic+dsimTaxo'></span><span id='topic+dsimFun'></span><span id='topic+dsimTree'></span>

<h3>Description</h3>

<p>The R function <code>dsimcom</code> calculates Pavoine and Ricotta (2014) coefficients SSokal-Sneath, SJaccard, SSorensen, SOchiai, and Sbeta of similarities among communities or their complements (1-S, dissimilarities).
</p>
<p>Function <code>SQ</code> calculates Pavoine and Ricotta (2014) index <code class="reqn">S_Q</code> (similarities between communities) and its complements <code class="reqn">1-S_Q</code> (dissimilarities between communities).
</p>
<p>The functions <code>dsimTax</code> and <code>dsimTree</code> calculate pair-wise taxonomic and phylogenetic (dis)similarities between species, respectively. <code>dsimTree</code> can also be used to calculate pair-wise functional (dis)similarities between species if a functional dendrogram is used to describe species.
</p>
<p>Function <code>dsimFun</code> calculates pair-wise functional (dis)similaties between species.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dsimcom(comm, Sigma = NULL, method = 1:5, 
option = c("relative", "absolute"), 
type = c("similarity", "dissimilarity"))

SQ(comm, Sigma = NULL, type = c("similarity", "dissimilarity"))

dsimTaxo(tax, method = c(1, 2, 3, 4, 5), 
type = c("similarity", "dissimilarity"))

dsimTree(phyl, method = c(1, 2, 3, 4, 5), rootedge = NULL, 
type = c("similarity", "dissimilarity"))

dsimFun(df, vartype = c("Q", "N", "M", "P"), method = 1:5, 
type = c("similarity", "dissimilarity"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dsimcom_+3A_comm">comm</code></td>
<td>
<p>a data frame or matrix with communities as rows, species as columns and non-negative values as entries.</p>
</td></tr>
<tr><td><code id="dsimcom_+3A_sigma">Sigma</code></td>
<td>
<p>matrix of similarities among species (species as rows and columns in the same order as in <code>comm</code>; values in <code>Sigma</code> are bounded between 0 and 1). The matrix must be nonnegative definite, i.e. all its eigenvalues are nonnegative. Functions <code>dsimTaxo</code>, <code>dsimTree</code> and <code>dsimFun</code> can be used to obtain <code>Sigma</code> as these functions lead to nonnegative definite matrices.</p>
</td></tr>
<tr><td><code id="dsimcom_+3A_method">method</code></td>
<td>

<p>an  integer  (1, 2, 3, 4, 5)  indicating  which basic coefficient  should  be  used: Sokal-Sneath, Jaccard, Sorensen, Ochiai, beta, respectively.</p>
</td></tr>
<tr><td><code id="dsimcom_+3A_option">option</code></td>
<td>

<p>a  string. If  <code>option = "relative"</code>,  the  rows  of  <code>comm</code>  are  standardized  into proportions that sum to 1.  If <code>option = "absolute"</code>, raw values are retained in <code>comm</code>.</p>
</td></tr>
<tr><td><code id="dsimcom_+3A_tax">tax</code></td>
<td>
<p>an object of class <code>taxo</code> (of package ade4).</p>
</td></tr>
<tr><td><code id="dsimcom_+3A_type">type</code></td>
<td>
<p>a string. If <code>type = "similarity"</code>, the functions <code>dsimcom</code> and <code>SQ</code> calculates  similarities (S) between communities and the functions <code>dsimTaxo</code>, <code>dsimTree</code> and <code>dsimFun</code> calculates similarities between species. If <code>type = "dissimilarity"</code>, the functions <code>dsimcom</code> and <code>SQ</code> calculates  dissimilarities (1-S) between communities and the functions <code>dsimTaxo</code>, <code>dsimTree</code> and <code>dsimFun</code> calculates dissimilarities between species.</p>
</td></tr>
<tr><td><code id="dsimcom_+3A_phyl">phyl</code></td>
<td>
<p>an object inheriting the class <code>phylo</code> (see package ape), <code>phylo4</code> (see package phylobase), or <code>hclust</code>.</p>
</td></tr>
<tr><td><code id="dsimcom_+3A_rootedge">rootedge</code></td>
<td>
<p>a numeric equal to the length of the branch at the nearest common ancestor of  all  species (here referred to as the root node). This branch is thus anterior to the root.  It is ignored if <code>rootedge</code> is NULL.</p>
</td></tr>
<tr><td><code id="dsimcom_+3A_df">df</code></td>
<td>
<p>either a data frame, a matrix or an object of class <code>ktab</code> of package ade4. If class <code>ktab</code> is used, each data frame must contain a single type of traits (see argument <code>vartype</code>).</p>
</td></tr>
<tr><td><code id="dsimcom_+3A_vartype">vartype</code></td>
<td>
<p>a vector of characters indicating the type of traits used in each data frame of <code>df</code>: <code>"Q"</code> for quantitative; <code>"N"</code> for nominal; <code>"M"</code> for multichoice; <code>"P"</code> for traits that can be expressed as proportions. Values in type must be in the same order as data frames in <code>df</code> (one value per table).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Formulas for the indices are given in Pavoine and Ricotta (2014) main text and appendixes.
</p>


<h3>Value</h3>

<p>If <code>type = "similarities"</code>, a matrix of similarities between communities.
If <code>type = "dissimilarities"</code>, an object of class <code>dist</code> with the dissimilarities between communities.
</p>


<h3>Author(s)</h3>

<p>Sandrine Pavoine <a href="mailto:sandrine.pavoine@mnhn.fr">sandrine.pavoine@mnhn.fr</a>
</p>


<h3>References</h3>

<p>Pavoine, S., Ricotta, C. (2014) Functional and phylogenetic similarity among communities. <em>Methods in Ecology and Evolution</em>, <b>5</b>, 666&ndash;675.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
if(require(ade4)){
data(macroloire, package="ade4") 

Ssokalsneath &lt;- dsimcom(t(macroloire$fau), method=1, option=c("relative"))
Sjaccard &lt;- dsimcom(t(macroloire$fau), method=2, option=c("relative"))
Ssorensen &lt;- dsimcom(t(macroloire$fau), method=3, option=c("relative"))
Sochiai &lt;- dsimcom(t(macroloire$fau), method=4, option=c("relative"))
Sbeta &lt;- dsimcom(t(macroloire$fau), method=5, option=c("relative"))

SQUNIF &lt;- SQ(t(macroloire$fau))

# The taxonomy is contained in macroloire$taxo

s_species_sokalsneath_taxo &lt;- dsimTaxo(macroloire$taxo, method=1) # Using formula a/(a+2b+2c) 
# (see notations below)
s_species_jaccard_taxo &lt;- dsimTaxo(macroloire$taxo, method=2) # Using formula a/(a+b+c) 
s_species_sorensen_taxo &lt;- dsimTaxo(macroloire$taxo, method=3) # Using formula 2a/(2a+b+c) 
s_species_ochiai_taxo &lt;- dsimTaxo(macroloire$taxo, method=4) # Using a/sqrt((a+b)(a+c)) 
s_species_beta_taxo &lt;- dsimTaxo(macroloire$taxo, method=5) # Using 4a/(4a+b+c)


# To check that these matrices of taxonomic similarities 
# among species are positive semidefinite (p.s.d.)
# we have to verify that their eigenvalues are all nonnegative:
all(eigen(s_species_sokalsneath_taxo)$val&gt;-(1e-8))
all(eigen(s_species_jaccard_taxo)$val&gt;-(1e-8))
all(eigen(s_species_sorensen_taxo)$val&gt;-(1e-8))
all(eigen(s_species_ochiai_taxo)$val&gt;-(1e-8))
all(eigen(s_species_beta_taxo)$val&gt;-(1e-8))

# Compositions of the communities
m &lt;- t(macroloire$fau[rownames(s_species_sokalsneath_taxo), ])
# Taxomonic similarities among species
s &lt;- s_species_sokalsneath_taxo

Ssokalsneath_taxo &lt;- dsimcom(m, s, method = 1)
SQwith_species_sokalsneath_taxo &lt;- SQ(m, s)

# Compositions of the communities
m &lt;- t(macroloire$fau[rownames(s_species_jaccard_taxo), ])
# Taxonomic similarities among species
s &lt;- s_species_jaccard_taxo  
Sjaccard_taxo &lt;- dsimcom(m, s, method = 2)
SQwith_species_jaccard_taxo &lt;- SQ(m, s)

# Compositions of the communities
m &lt;- t(macroloire$fau[rownames(s_species_sorensen_taxo), ])
# Taxonomic similarities among species
s &lt;- s_species_sorensen_taxo  

Ssorensen_taxo &lt;- dsimcom(m, s, method = 3)
SQwith_species_sorensen_taxo &lt;- SQ(m, s)

# Compositions of the communities
m &lt;- t(macroloire$fau[rownames(s_species_ochiai_taxo), ])
# Taxonomic similarities among species
s &lt;- s_species_ochiai_taxo  

Sochiai_taxo &lt;- dsimcom(m, s, method = 4)
SQwith_species_ochiai_taxo &lt;- SQ(m, s)


# Compositions of the communities
m &lt;- t(macroloire$fau[rownames(s_species_beta_taxo), ])
# Taxonomic similarities among species
s &lt;- s_species_beta_taxo  

Sbeta_taxo &lt;- dsimcom(m, s, method = 5)
SQwith_species_beta_taxo &lt;- SQ(m, s)

# The matrix named feed below contains feeding attributes as rows,
# species as columns, and affinities (proportions) as entries.
feed &lt;- macroloire$traits[ ,-(1:4)]

# Feeding habits comprise seven categories: engulfers, shredders, scrapers,
# deposit-feeders, active filter-feeders, passive filter-feeders and piercers, in this order.

# Functional similarities among species are computed as indicated in the main text
s_species_sokalsneath_feed &lt;- dsimFun(feed, vartype = "P", method=1)
s_species_jaccard_feed &lt;- dsimFun(feed, vartype = "P", method=2)
s_species_sorensen_feed &lt;- dsimFun(feed, vartype = "P", method=3)
s_species_ochiai_feed &lt;- dsimFun(feed, vartype = "P", method=4)
s_species_beta_feed &lt;- dsimFun(feed, vartype = "P", method=5)

all(eigen(s_species_sokalsneath_feed)$val&gt;-(1e-8))
all(eigen(s_species_jaccard_feed)$val&gt;-(1e-8))
all(eigen(s_species_sorensen_feed)$val&gt;-(1e-8))
all(eigen(s_species_ochiai_feed)$val&gt;-(1e-8))
all(eigen(s_species_beta_feed)$val&gt;-(1e-8))

Ssokalsneath_feed &lt;- dsimcom(t(macroloire$fau), s_species_sokalsneath_feed, method=1)
SQwith_species_sokalsneath_feed &lt;- SQ(t(macroloire$fau), s_species_sokalsneath_feed)

Sjaccard_feed &lt;- dsimcom(t(macroloire$fau), s_species_jaccard_feed, method=2)
SQwith_species_jaccard_feed &lt;- SQ(t(macroloire$fau), s_species_jaccard_feed)

Ssorensen_feed &lt;- dsimcom(t(macroloire$fau), s_species_sorensen_feed, method=3)
SQwith_species_sorensen_feed &lt;- SQ(t(macroloire$fau), s_species_sorensen_feed)

Sochiai_feed &lt;- dsimcom(t(macroloire$fau), s_species_ochiai_feed, method=4)
SQwith_species_ochiai_feed &lt;- SQ(t(macroloire$fau), s_species_ochiai_feed)

Sbeta_feed &lt;- dsimcom(t(macroloire$fau), s_species_sorensen_feed, method=5)


all(eigen(Ssokalsneath_feed)$val&gt;-(1e-8))
all(eigen(Sjaccard_feed)$val&gt;-(1e-8))
all(eigen(Ssorensen_feed)$val&gt;-(1e-8))
all(eigen(Sochiai_feed)$val&gt;-(1e-8))
all(eigen(Sbeta_feed)$val&gt;-(1e-8))


par(mfrow=c(3, 5))
plot(SQUNIF, Ssokalsneath, xlim=c(0,1), ylim=c(0,1), asp=1)
segments(0, 0, 1,1)
plot(SQUNIF, Sjaccard, xlim=c(0,1), ylim=c(0,1) , asp=1)
segments(0, 0, 1,1)
plot(SQUNIF, Ssorensen, xlim=c(0,1), ylim=c(0,1) , asp=1)
segments(0, 0, 1,1)
plot(SQUNIF, Sochiai, xlim=c(0,1), ylim=c(0,1) , asp=1)
segments(0, 0, 1,1)
plot(SQUNIF, Sbeta, xlim=c(0,1), ylim=c(0,1) , asp=1)
segments(0, 0, 1,1)

plot(SQwith_species_sokalsneath_taxo, Ssokalsneath_taxo, xlim=c(0,1), ylim=c(0,1), asp=1)
segments(0, 0, 1,1)
plot(SQwith_species_jaccard_taxo, Sjaccard_taxo, xlim=c(0,1), ylim=c(0,1) , asp=1)
segments(0, 0, 1,1)
plot(SQwith_species_sorensen_taxo, Ssorensen_taxo, xlim=c(0,1), ylim=c(0,1) , asp=1)
segments(0, 0, 1,1)
plot(SQwith_species_ochiai_taxo, Sochiai_taxo, xlim=c(0,1), ylim=c(0,1) , asp=1)
segments(0, 0, 1,1)
plot(SQwith_species_beta_taxo, Sbeta_taxo, xlim=c(0,1), ylim=c(0,1) , asp=1)
segments(0, 0, 1,1)

plot(SQwith_species_sokalsneath_feed, Ssokalsneath_feed, xlim=c(0,1), ylim=c(0,1), asp=1)
segments(0, 0, 1,1)
plot(SQwith_species_jaccard_feed, Sjaccard_feed, xlim=c(0,1), ylim=c(0,1) , asp=1)
segments(0, 0, 1,1)
plot(SQwith_species_sorensen_feed, Ssorensen_feed, xlim=c(0,1), ylim=c(0,1) , asp=1)
segments(0, 0, 1,1)
plot(SQwith_species_ochiai_feed, Sochiai_feed, xlim=c(0,1), ylim=c(0,1) , asp=1)
segments(0, 0, 1,1)
plot(SQwith_species_sorensen_feed, Sbeta_feed, xlim=c(0,1), ylim=c(0,1) , asp=1)
segments(0, 0, 1,1)

par(mfrow=c(1,1))
}

## End(Not run)
</code></pre>

<hr>
<h2 id='dspca'>
Double similarity principal component analysis
</h2><span id='topic+dspca'></span><span id='topic+plot.dspca'></span>

<h3>Description</h3>

<p>The function <code>dspca</code> performs the double similarity principal component analysis (DSPCA) (Pavoine 2019): an ordination approach to analyse functional or phylogenetic similarities between species communities. The function <code>plot.dspca</code> displays factorial maps of dspca.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dspca(comm, S=NULL, tol=1e-8)

## S3 method for class 'dspca'
plot(x, xaxis = 1, yaxis = 2, labels = TRUE,
    arrows = TRUE, points = FALSE, autolab = TRUE, title = NULL,
    colors = NULL, type = c("X&amp;Y","X","Y"), zoom = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dspca_+3A_comm">comm</code></td>
<td>

<p>a data frame or a matrix typically with communities (or sites, plots, etc.) as rows, species as columns and presence/absence (1/0) or an index of abundance as entries. 
</p>
</td></tr>
<tr><td><code id="dspca_+3A_s">S</code></td>
<td>

<p>a matrix of functional or phylogenetic similarities between species (species as rows and columns in the same order as in comm).
</p>
</td></tr>
<tr><td><code id="dspca_+3A_tol">tol</code></td>
<td>

<p>a numeric tolerance threshold: a value between -tol and tol is considered as zero.
</p>
</td></tr>
<tr><td><code id="dspca_+3A_x">x</code></td>
<td>

<p>an object of class <code>dspca</code>.
</p>
</td></tr>
<tr><td><code id="dspca_+3A_xaxis">xaxis</code></td>
<td>

<p>the number of the DSPCA axis chosen for the x-axis of the 3d plot.
</p>
</td></tr>
<tr><td><code id="dspca_+3A_yaxis">yaxis</code></td>
<td>

<p>the number of the DSPCA axis chosen for the y-axis of the 3d plot.
</p>
</td></tr>
<tr><td><code id="dspca_+3A_labels">labels</code></td>
<td>

<p>a logical specifying whether the names of the species and those of the communities must be displayed in the factorial maps.
</p>
</td></tr>
<tr><td><code id="dspca_+3A_arrows">arrows</code></td>
<td>

<p>a logical specifying whether arrows must be used to indicate the positions of the species and those of the communities.
</p>
</td></tr>
<tr><td><code id="dspca_+3A_points">points</code></td>
<td>

<p>a logical specifying whether points must be used to indicate the positions of the species and those of the communities.
</p>
</td></tr> 
<tr><td><code id="dspca_+3A_autolab">autolab</code></td>
<td>

<p>a logical indicating if a function autoLab extracted from package <code>FactoMineR</code> version 2.6 must be used to display the labels. If there are more than 50 species or more than 50 communities, this option may be time-consuming. If <code>autolab = FALSE</code>, the names of species and those of the communities will be placed quickly but may overlap.
</p>
</td></tr>
<tr><td><code id="dspca_+3A_title">title</code></td>
<td>

<p>a string (if <code>type="X"</code> or <code>type="Y"</code>) or a vector of strings (if <code>type="X&amp;Y"</code>) giving the title of each graph.
</p>
</td></tr>
<tr><td><code id="dspca_+3A_colors">colors</code></td>
<td>

<p>a vector (if <code>type="X"</code> or <code>type="Y"</code>) providing the color or the colors to be used for species names, points and arrows (if <code>type="X"</code>), or community names, points and arrows (if <code>type="Y"</code>), OR, if <code>type="X&amp;Y"</code>, a list of two vectors, the first one with the colors to be used for species names, points and arrows and the other one for community names, points and arrows.  
</p>
</td></tr>
<tr><td><code id="dspca_+3A_type">type</code></td>
<td>

<p>a string that can be <code>"X&amp;Y"</code>,<code>"X"</code>,<code>"Y"</code>. If <code>type="X"</code>, species scores are displayed. If <code>type="Y"</code>, community scores are displayed. If <code>"X&amp;Y"</code>, both species and community scores are displayed.
</p>
</td></tr>
<tr><td><code id="dspca_+3A_zoom">zoom</code></td>
<td>

<p>a logical indicating if the graphs must zoom on the positions of the species and those of the communities (defaults to <code>TRUE</code>). If <code>zoom=FALSE</code> then species and communities are positioned in the full circle of unit radius.
</p>
</td></tr>
<tr><td><code id="dspca_+3A_...">...</code></td>
<td>

<p>further arguments passed to or from other methods. These must be common to functions plot, arrows, points, and autoLab or text.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Coordinates can be visualized with graphic tools available in R. Examples are provided below (see section named &quot;examples&quot;).
</p>


<h3>Value</h3>

<p><code>dspca</code> returns a list of the following objects:
</p>
<table role = "presentation">
<tr><td><code>eig</code></td>
<td>
<p>Final eigenvalues: positive eigenvalues of the matrix of similarities among communities.</p>
</td></tr>
<tr><td><code>X</code></td>
<td>
<p>final coordinates of the species (<code class="reqn">\mathbf{X}_{final}</code>): matrix with the coordinates of the species on the principal components associated with the matrix of similarities among communities. The names of the matrix start with &quot;CPC&quot; indicating &quot;communities' principal component&quot;.</p>
</td></tr>
<tr><td><code>Y</code></td>
<td>
<p>final coordinates of the communities (<code class="reqn">\mathbf{Y}_{final}</code>): matrix with the coordinates of
the communities on the principal components associated with the matrix of similarities among communities. The names of the matrix start with &quot;CPC&quot; indicating &quot;communities' principal component&quot;.</p>
</td></tr> 
<tr><td><code>Scom</code></td>
<td>
<p>matrix of similarities among communities (obtained with coefficient SOchiai (Pavoine and Ricotta 2014))</p>
</td></tr></table>
<p>.
</p>


<h3>Author(s)</h3>

<p>Sandrine Pavoine <a href="mailto:sandrine.pavoine@mnhn.fr">sandrine.pavoine@mnhn.fr</a>
</p>


<h3>References</h3>

<p>Pavoine, S. (2019) An ordination approach to explore similarities among communities. <em>Journal of Theoretical Biology</em>, <b>462</b>, 85&ndash;96.
</p>
<p>Pavoine, S. and Ricotta, C. (2014) Functional and phylogenetic similarity among communities. <em>Methods in Ecology and Evolution</em>, <b>5</b>, 666&ndash;675.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+evoNSCA">evoNSCA</a></code>, <code><a href="#topic+evopcachord">evopcachord</a></code>, <code><a href="#topic+evopcahellinger">evopcahellinger</a></code>, <code><a href="#topic+dsimcom">dsimcom</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
if(require(ade4)){

data(macroloire, package="ade4") 
# Analysis of the feeding habits of macroinvertebrates in the Loire river, France

# The matrix named feed below contains feeding attributes as rows,
# species as columns, and affinities (proportions) as entries.
feed &lt;- macroloire$traits[, -(1:4)]

# Feeding habits comprise seven categories: engulfers, shredders, scrapers,
# deposit-feeders, active filter-feeders, passive filter-feeders and piercers, in this order.

# Functional similarities among species are computed as indicated in Pavoine and Ricotta (2014)
s_species_ochiai_feed &lt;- dsimFun(feed, vartype = "P", method=4)

# To check that this matrix of trait-based similarities 
# among species is positive semidefinite (p.s.d.)
# we have to verify that its eigenvalues are all nonnegative:
all(eigen(s_species_ochiai_feed)$val&gt;-(1e-8))

dspca_feed &lt;- dspca(t(macroloire$fau), s_species_ochiai_feed)

# eigenvalue distribution:
barplot(dspca_feed$eig)
# The eigenvalues show strong similarities in the composition of the sites 
# regarding the feeding habits of the macroinvertebrates.

# In this data set, communities (sites) are named from S1 to S38 from upstream to downstream
rownames(t(macroloire$fau))

# species are coded from E1 to E40
colnames(t(macroloire$fau))

plot(dspca_feed,  autolab=TRUE, 
    colors= list(ifelse(feed[,6]&gt;0.5,"red","black"), 
    hcl.colors(38, "cyan")))

# The graphical display shows that most sites are characterized by the dominance of a few species 
# (which are mostly passive filter-feeders, in red). 
# In a few sites mostly upstream (in blue), the diversity in feeding habits is higher. 
}

## End(Not run)
</code></pre>

<hr>
<h2 id='EH'>
Faith Phylogenetic Diversity
</h2><span id='topic+EH'></span>

<h3>Description</h3>

<p>Function <code>EH</code> computes the sum of branch lengths on a phylogenetic tree.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EH(phyl, select = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="EH_+3A_phyl">phyl</code></td>
<td>
<p>an object inheriting the class <code>phylo</code> (see package ape), <code>phylo4</code> (see package phylobase) or <code>hclust</code>.</p>
</td></tr>
<tr><td><code id="EH_+3A_select">select</code></td>
<td>
<p>a vector containing the numbers of the leaves (species) which must be considered in the computation of Phylogenetic Diversity (PD) (or merely sum of branch lengths on the tree). This argument allows the calculation of PD for a subset of species (including the branch between the subtree and the most ancient node of the full tree).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Function <code>EH</code> returns a real value
</p>


<h3>Author(s)</h3>

<p>Sandrine Pavoine <a href="mailto:sandrine.pavoine@mnhn.fr">sandrine.pavoine@mnhn.fr</a>
with contributions of Stephane Dray
</p>


<h3>References</h3>

<p>Faith, D.P. (1992). Conservation evaluation and phylogenetic diversity. <em>Biological Conservation</em>, <b>61</b>, 1&ndash;10.
</p>
<p>Nee, S. and May, R.M. (1997) Extinction and the loss of evolutionary history. <em>Science</em>, <b>278</b>, 692&ndash;694. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+optimEH">optimEH</a></code>, <code><a href="#topic+randEH">randEH</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
if(require(ape) &amp;&amp; require(adephylo)){
data(carni70, package = "adephylo")
tre &lt;- read.tree(text = carni70$tre)
adiv:::EH(tre)
adiv:::EH(tre, select=c("Mustela.nigripes", "Mustela.frenata", "Puma.concolor"))
adiv:::EH(tre, select=c(1,68,70))
}

## End(Not run)
</code></pre>

<hr>
<h2 id='EqRao'>
Apportionment of Diversity
</h2><span id='topic+EqRS'></span><span id='topic+EqRSintra'></span><span id='topic+EqRao'></span><span id='topic+wapqe'></span><span id='topic+rtestEqRS'></span><span id='topic+rtestEqRSintra'></span><span id='topic+rtestEqRao'></span><span id='topic+rtestwapqe'></span>

<h3>Description</h3>

<p>Eight functions are available.
</p>
<p><code>EqRS</code> performs the first decomposition of diversity developed in Pavoine et al. (2016) and <code>rtestEqRS</code> can be used for the associated permutation tests. 
</p>
<p><code>EqRSintra</code> performs the second decomposition of diversity developed in Pavoine et al. (2016) and <code>rtestEqRSintra</code> can be used for the associated permutation tests. 
</p>
<p><code>EqRao</code> performs the third decomposition of diversity introduced in Pavoine et al. (2016) and <code>rtestEqRao</code> can be used for the associated permutation tests. 
</p>
<p><code>wapqe</code> performs the apportionment of quadratic entropy (Rao 1986) and <code>rtestwapqe</code> associated permutation tests (Pavoine et al. 2016).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EqRS(comm, dis = NULL, structures = NULL, 
option = c("eq", "normed1", "normed2"), 
formula = c("QE", "EDI"), tol = 1e-08)

EqRSintra(comm, dis = NULL, structures = NULL, 
option = c("eq", "normed1", "normed2"), 
formula = c("QE", "EDI"), tol = 1e-08, 
metmean = c("harmonic", "arithmetic"))

EqRao(comm, dis = NULL, structures = NULL, 
option = c("eq", "normed1", "normed2"), 
formula = c("QE", "EDI"), wopt = c("even", "speciesab"), 
tol = 1e-08, metmean = c("harmonic", "arithmetic"))

wapqe(comm, dis = NULL, structures = NULL, 
formula = c("QE", "EDI"), wopt = c("even", "speciesab"), 
tol = 1e-08)

rtestEqRS(comm, dis = NULL, structures = NULL, 
formula = c("QE", "EDI"), 
option = c("normed1", "normed2", "eq"), 
popt = c("aggregated", "independent"), level = 1, nrep = 99, 
alter = c("greater", "less", "two-sided"), tol = 1e-08)

rtestEqRSintra(comm, dis = NULL, structures = NULL, 
formula = c("QE", "EDI"), 
option = c("normed1", "normed2", "eq"), 
popt = c("aggregated", "independent"), level = 1, 
nrep = 99, alter = c("greater", "less", "two-sided"), 
tol = 1e-08, metmean = c("harmonic", "arithmetic"))

rtestEqRao(comm, dis = NULL, structures = NULL, 
formula = c("QE", "EDI"), 
option = c("normed1", "normed2", "eq"), 
wopt = c("even", "speciesab"), 
popt = c("aggregated", "independent"), level = 1, nrep = 99, 
alter = c("greater", "less", "two-sided"), tol = 1e-08, 
metmean = c("harmonic", "arithmetic"))

rtestwapqe(comm, dis = NULL, structures = NULL, 
formula = c("QE", "EDI"), wopt = c("even", "speciesab"), 
popt = c("aggregated", "independent"), 
level = 1, nrep = 99, alter = c("greater", "less", "two-sided"),
tol = 1e-08)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="EqRao_+3A_comm">comm</code></td>
<td>

<p>a data frame or a matrix with communities as rows and species as columns. Entries are abundances of species within sites.</p>
</td></tr>
<tr><td><code id="EqRao_+3A_dis">dis</code></td>
<td>

<p>either <code>NULL</code> or an object of class <code>dist</code> that contains the (functional or phylogenetic) distances among species. If <code>NULL</code>, the Gini-Simpson index is used.</p>
</td></tr>
<tr><td><code id="EqRao_+3A_structures">structures</code></td>
<td>

<p>either <code>NULL</code> or a data frame that contains, in the <em>j</em>th row and the <em>k</em>th column, the name of the group of level <em>k</em> to which the <em>j</em>th community belongs. Communities in <code>structures</code> should be in the same order as in <code>comm</code>. See details.</p>
</td></tr>
<tr><td><code id="EqRao_+3A_option">option</code></td>
<td>

<p><code>"eq"</code>, <code>"normed1"</code> or <code>"normed2"</code> (if a vector with several codes is given, only the first one is considered). <code>"eq"</code> means that the diversity components are given in terms of equivalent number (E) of species, sites, regions etc. <code>"normed1"</code> means that the normed components of diversity will be returned with formula (1 - 1 / E) / (1  - 1 / Emax);  <code>"normed2"</code> means that the normed components of diversity will be returned with formula (E - 1) / (Emax - 1). Emax is the maximum possible value for E. For Ealpha (local diversity) and Egamma (global diversity), Emax=S (the number of species in the data set).</p>
</td></tr>
<tr><td><code id="EqRao_+3A_formula">formula</code></td>
<td>

<p>either <code>"QE"</code> (default) or <code>"EDI"</code>. See details.
</p>
</td></tr>
<tr><td><code id="EqRao_+3A_wopt">wopt</code></td>
<td>

<p>either <code>"even"</code> (default), <code>"speciesab"</code>, or a numeric vector. If <code>w="speciesab"</code>, then the communities will be weighted by their sum of species' abundances. If <code>w="even"</code>, the communities will be evenly weighted within the factors defined by the argument <code>structures</code>.</p>
</td></tr>
<tr><td><code id="EqRao_+3A_popt">popt</code></td>
<td>

<p>a sring: either <code>"aggregated"</code> or <code>"independent"</code>. This choice will define the permutation test within communities (level 1 of the permutation scheme). If <code>"aggregated"</code> is chosen, sampled individuals will be considered to be aggregated in space so that. (For example, consider that fish are sampled by net, and fish are aggregated in space, then when using the net, one might have zero abundance once because the net was not placed in a shoal of fish and a very high abundance another time because the net was placed in a shoal of fish; the permutation scheme was developed for this scenario). In that case, the abundance values of each species are permuted between communities. Permutations leading to an empty community (with all species abundances equal to zero) are excluded. If <code>"independent"</code> is chosen, sampled individuals will be considered independent from each other and now abundances are randomly defined with the only constraints that the sum of species abundance within a community is kept constant and the sum of abundance of a species across all communities (if argument <code>structures</code> is <code>NULL</code> or across the communities of a group (of level 2, see argument <code>level</code>) if <code>structures</code> is not <code>NULL</code>. Decimals are not allowed for abundance data with <code>popt = "independent"</code>.
</p>
</td></tr>
<tr><td><code id="EqRao_+3A_tol">tol</code></td>
<td>

<p>a tolerance threshold (a value between -<code>tol</code> and <code>tol</code> is considered equal to zero).</p>
</td></tr>
<tr><td><code id="EqRao_+3A_metmean">metmean</code></td>
<td>

<p>a string: either <code>"arithmetic"</code> or <code>"harmonic"</code> (default).</p>
</td></tr>
<tr><td><code id="EqRao_+3A_level">level</code></td>
<td>

<p>a number. The number is discarded if the argument <code>structures</code> is set to <code>NULL</code>. If <code>structures</code> is different from <code>NULL</code> then <code>1</code> means test for differences among communities, within the levels of the first factor given in argument <code>structures</code> (column 1), <code>2</code> means test for differences among levels of the first factor given in argument <code>structures</code> (column 1) but within levels of the second factor given in argument <code>structures</code> (column 2) (if available), etc. <code>level</code> should thus be between 1 and 1+the number of columns in <code>structures</code>. See details for concrete examples.</p>
</td></tr>
<tr><td><code id="EqRao_+3A_nrep">nrep</code></td>
<td>

<p>the number of permutations.
</p>
</td></tr>
<tr><td><code id="EqRao_+3A_alter">alter</code></td>
<td>

<p>a string specifying the alternative hypothesis, must be one of <code>"greater"</code> (default), <code>"less"</code> or <code>"two-sided"</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>formula = "QE"</code>, the definition of the quadratic entropy is:
</p>
<p style="text-align: center;"><code class="reqn">QE(\mathbf{p}_i,\mathbf{D})=\sum_{k=1}^S\sum_{l=1}^S p_{k|i}p_{k|j}d_{kl}</code>
</p>

<p>where <code class="reqn">\mathbf{p}_i=(p_{1|i}, ..., p_{k|i}, ..., p_{S|i})</code> is the vector of relative species abundance within community <em>i</em>; <em>S</em> is  the  number  of  species; <code class="reqn">\mathbf{D}=(d_{kl})</code> is the  matrix  of  (phylogenetic  or functional)  dissimilarities  among  species,  and <code class="reqn">d_{kl}</code> is the (phylogenetic or functional) dissimilarity between species 
<em>k</em> and <em>l</em>.  
</p>
<p>If <code>formula = "EDI"</code>, the definition of the quadratic entropy is: 
</p>
<p style="text-align: center;"><code class="reqn">EDI(\mathbf{p}_i,\mathbf{D})=\sum_{k=1}^S\sum_{l=1}^S p_{k|i}p_{k|j}\frac{d_{kl}^2}{2}</code>
</p>

<p>EDI stands for the Euclidean Diversity Index of Champely and Chessel (2002). For example, applying EqRao with the distances <code>dis</code>=mydis and <code>formula=QE</code> corresponds to applying it with <code>dis</code>=sqrt(2*mydis) and <code>formula=EDI</code>.
</p>
<p>The argument <code>level</code> permits to choose the component of 
beta diversity that will be tested for significance.
</p>
<p>Examples are given below:
</p>
<p>Scenario 1: Imagine that <code>structures</code> is <code>NULL</code>, then we only have a set of communities, species within them and a matrix of (functional or phylogenetic) dissimilarities among species. Then there is only one level of beta diversity which represents the average dissimilarities among communities. The functions <code>rtestEqRS</code>, <code>rtestEqRSintra</code>, <code>rtestEqRao</code>, and <code>rtestwapqe</code> will always, in that case, test for the significance of the dissimilarities among communities (whatever the value given to argument <code>level</code>).
</p>
<p>Scenario 2:
Imagine that <code>structures</code> is a data frame with sites as rows and only one column representing how sites are distributed among regions. Then, there are two levels of beta diversity: beta1 diversity represents the (functional or phylogenetic) dissimilarities among sites within regions; and beta2 diversity represents the (functional or phylogenetic) dissimilarities among regions. If <code>level = 1</code> then functions <code>rtestEqRS</code>, <code>rtestEqRSintra</code>, <code>rtestEqRao</code>, and <code>rtestwapqe</code> will test for the significance of the dissimilarities among sites within regions (beta1 diversity); in contrast, if <code>level = 2</code> functions <code>rtestEqRS</code>, <code>rtestEqRSintra</code>, <code>rtestEqRao</code>, and <code>rtestwapqe</code> will test for the significance of the dissimilarities among regions (beta2 diversity). As there is only one column in argument <code>structures</code> and thus only two levels of diversity, <code>level</code> cannot be higher than 2.
</p>
<p>Scenario 3:
Imagine now that argument <code>comm</code> contains quadrats
as rows and species as columns and that <code>structures</code> is a data frame with quadrats as rows and three columns
representing how quadrats are organized in three nested factors: hamlets, towns, and counties. Then there would be four levels of beta diversity: beta1 diversity represents the (functional or phylogenetic) dissimilarities among quadrats within hamlets, towns, and counties; beta2 diversity represents the dissimilarities among hamlets within towns and counties; beta3 diversity represents the dissimilarities among towns within counties; and beta4 diversity represents the dissimilarities among counties. If <code>level = 1</code> then functions <code>rtestEqRS</code>, <code>rtestEqRSintra</code>, <code>rtestEqRao</code>, and <code>rtestwapqe</code> will test for the significance of the dissimilarities among quadrats within hamlets, towns, and counties (beta1 diversity); if <code>level = 2</code> functions <code>rtestEqRS</code>, <code>rtestEqRSintra</code>, <code>rtestEqRao</code>, and <code>rtestwapqe</code> will test for the significance of the dissimilarities among hamlets within towns and regions (beta2 diversity); if <code>level = 3</code> functions <code>rtestEqRS</code>, <code>rtestEqRSintra</code>, <code>rtestEqRao</code>, and <code>rtestwapqe</code> will test for the significance of the dissimilarities among towns within regions (beta3 diversity); if <code>level = 4</code> functions <code>rtestEqRS</code>, <code>rtestEqRSintra</code>, <code>rtestEqRao</code>, and <code>rtestwapqe</code> will test for the significance of the dissimilarities among regions (beta4 diversity). As there are only three columns in argument <code>structures</code> and thus only four levels of diversity, <code>level</code> cannot be higher than 4.
Test for <code>level=1</code> is performed by permuting the 
abundances of each species across quadrats but within hamlets, towns, and counties. Test for <code>level=2</code> is performed by permuting the quadrats among hamlets within towns and counties. Test for <code>level=3</code> is performed by permuting the hamlets among towns within counties. Test for <code>level=4</code> is performed by permuting the towns among counties.
</p>
<p>Other permutation schemes will be added in the future.
</p>


<h3>Value</h3>

<p>The functions <code>EqRS</code>, <code>EqRSintra</code>, <code>EqRao</code>, <code>wapqe</code> return a data frame with each component of the selected diversity decomposition. The functions <code>rtestEqRS</code>, <code>rtestEqRSintra</code>, <code>rtestEqRao</code>, and <code>rtestwapqe</code> return a list of class <code>randtest</code> or <code>krandtest</code> (classes of package ade4).
</p>


<h3>Author(s)</h3>

<p>Sandrine Pavoine <a href="mailto:sandrine.pavoine@mnhn.fr">sandrine.pavoine@mnhn.fr</a>
</p>


<h3>References</h3>

<p>Pavoine, S., Marcon, E., Ricotta, C. (2016) &quot;Equivalent numbers&quot; for species, phylogenetic, or functional diversity in a nested hierarchy of multiple scales. <em>Methods in Ecology and Evolution</em>, <b>7</b>, 1152&ndash;1163.
</p>
<p>Champely, S. and Chessel, D. (2002) Measuring biological diversity using Euclideanmetrics. <em>Environmental and Ecological Statistics</em>, <b>9</b>, 167&ndash;177.
</p>
<p>Rao, C.R. (1986) Rao's axiomatization of diversity measures. In: <em>Encyclopedia of Statistical Sciences</em>. Vol. 7 (eds S. Kotz and N.L. Johnson), pp. 614&ndash;617. New York: Wiley and Sons.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
if(require(ade4)){

data(macroloire, package="ade4")

# Taxonomic dissimilarities among species:
dTaxo &lt;- dist.taxo(macroloire$taxo)^2/2
dTaxo &lt;- dTaxo/max(dTaxo)
# Size-based dissimilarities among species
dSize &lt;- dist.prop(macroloire$traits[ ,1:4], method = 2)
# Dissimilarities among species in terms of feeding categories
dFeed &lt;- dist.prop(macroloire$traits[ ,5:11], method = 2)
# Dissimilarities among species in terms of 
# both size and feeding categories
dSF &lt;- (dSize+dFeed)/2

# Table with sites as rows (stations), 
# species as columns and abundances as entries
ab &lt;- as.data.frame(t(macroloire$fau))
# Table with sites as rows and one column only. 
# Entries indicate the geological region associated 
# with each site
stru &lt;- macroloire$envir["Morphoregion"]

EqRao(ab, , stru, option="eq")
EqRao(ab, dTaxo, stru, formula = "QE", option="eq")
EqRao(ab, dSize, stru, formula = "QE", option="eq")
EqRao(ab, dFeed, stru, formula = "QE", option="eq")
EqRao(ab, dSF, stru, formula = "QE", option="eq")

EqRao(ab, , stru, option="normed2")
EqRao(ab, dTaxo, stru, formula = "QE", option="normed2")
EqRao(ab, dSize, stru, formula = "QE", option="normed2")
EqRao(ab, dFeed, stru, formula = "QE", option="normed2")
EqRao(ab, dSF, stru, formula = "QE", option="normed2")

# Tests for dissimilarities among sites within regions:
### TIME CONSUMING

rb1_GS &lt;- rtestEqRao(ab, , stru, level=1, nrep=999, option="normed2")
rb1_GS
plot(rb1_GS)
rb1_Taxo &lt;- rtestEqRao(ab, dTaxo, stru, formula = "QE", 
level=1, nrep=999, option="normed2")
rb1_Taxo
plot(rb1_Taxo)
rb1_Size &lt;- rtestEqRao(ab, dSize, stru, formula = "QE", 
level=1, nrep=999, option="normed2")
rb1_Size
plot(rb1_Size)
rb1_Feed &lt;- rtestEqRao(ab, dFeed, stru, formula = "QE", 
level=1, nrep=999, option="normed2")
rb1_Feed
plot(rb1_Feed)
rb1_SF &lt;- rtestEqRao(ab, dSF, stru, formula = "QE", 
level=1, nrep=999, option="normed2")
rb1_SF
plot(rb1_SF)

# Tests for dissimilarities among regions:
### TIME CONSUMING

r2_GS &lt;- rtestEqRao(ab, , stru, level=2, nrep=999, option="normed2")
r2_GS
plot(r2_GS)
r2_Taxo &lt;- rtestEqRao(ab, dTaxo, stru, formula = "QE", 
level=2, nrep=999, option="normed2")
r2_Taxo
plot(r2_Taxo)
r2_Size &lt;- rtestEqRao(ab, dSize, stru, formula = "QE", 
level=2, nrep=999, option="normed2", w="even")
r2_Size
plot(r2_Size)
r2_Feed &lt;- rtestEqRao(ab, dFeed, stru, formula = "QE", 
level=2, nrep=999, option="normed2", w="even")
r2_Feed
plot(r2_Feed)
r2_SF &lt;- rtestEqRao(ab, dSF, stru, formula = "QE", 
level=2, nrep=999, option="normed2", w="even")
r2_SF
plot(r2_SF)
}

## End(Not run)
</code></pre>

<hr>
<h2 id='eveparam'>
Parametric Indices of Species Evenness
</h2><span id='topic+eveparam'></span><span id='topic+plot.eveparam'></span>

<h3>Description</h3>

<p>The function <code>eveparam</code> calculates parametric evenness indices. The parameter controls the relative importance given to rare versus abundant species in a community.
The function <code>plot.eveparam</code> plots the results of function <code>eveparam</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eveparam(comm, method = c("hill", "tsallis", "renyi"), q = 2, tol = 1e-08)

## S3 method for class 'eveparam'
plot(x, legend = TRUE, 
legendposi = "topright", axisLABEL = "Evenness", type = "b", 
col = if (is.numeric(x)) NULL 
else sample(colors(distinct = TRUE), nrow(x$eve)), 
lty = if (is.numeric(x)) NULL else rep(1, nrow(x$eve)), 
pch = if (is.numeric(x)) NULL else rep(19, nrow(x$eve)), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eveparam_+3A_comm">comm</code></td>
<td>

<p>a data frame or a matrix typically with communities as rows, species as columns and abundance as entry. 
</p>
</td></tr>
<tr><td><code id="eveparam_+3A_method">method</code></td>
<td>

<p>a string: either &quot;hill&quot; for the Hill numbers (Hill 1973), &quot;tsallis&quot; for the Tsallis or HCDT entropy (Harvda and Charvat 1967; Daroczy 1970; Tsallis 1988), or &quot;renyi&quot; for Renyi's entropy (Renyi 1960). These indices are divided by the value they would have if all species had even abundances.
</p>
</td></tr>
<tr><td><code id="eveparam_+3A_q">q</code></td>
<td>

<p>a positive numeric or a vector of positive numerics that give values for the <code>q</code> parameter.
</p>
</td></tr>
<tr><td><code id="eveparam_+3A_tol">tol</code></td>
<td>

<p>numeric tolerance threshold: values between -tol and tol are considered equal to zero.
</p>
</td></tr>
<tr><td><code id="eveparam_+3A_x">x</code></td>
<td>

<p>an object of class <code>eveparam</code> obtained with function <code>eveparam</code>.
</p>
</td></tr>
<tr><td><code id="eveparam_+3A_legend">legend</code></td>
<td>

<p>a logical. If TRUE a legend is given with the colour, the type of line (etc.) used to define the evenness curve of each community.
</p>
</td></tr>
<tr><td><code id="eveparam_+3A_legendposi">legendposi</code></td>
<td>

<p>a string or a numeric that gives the position of the legend to be passed to function <code>legend</code> of the base of R.
</p>
</td></tr>
<tr><td><code id="eveparam_+3A_axislabel">axisLABEL</code></td>
<td>

<p>a string to display on the main axis of the plot to designate what we are measuring. The default is <code>"Evenness"</code>. 
</p>
</td></tr>
<tr><td><code id="eveparam_+3A_type">type</code></td>
<td>

<p>a string to be passed to the graphic argument <code>type</code> of functions <code>plot</code> and <code>lines</code> used to draw the evenness curve of each community.
</p>
</td></tr>
<tr><td><code id="eveparam_+3A_col">col</code></td>
<td>

<p>colours to be passed to the graphic argument <code>col</code> of functions <code>plot</code> and <code>lines</code> to define the colour of the evenness curve of each community.
</p>
</td></tr>
<tr><td><code id="eveparam_+3A_lty">lty</code></td>
<td>

<p>type of line (plain, broken etc.) to be passed to the graphic argument <code>lty</code> of functions <code>plot</code> and <code>lines</code> used to draw the evenness curve of each community.
</p>
</td></tr>
<tr><td><code id="eveparam_+3A_pch">pch</code></td>
<td>

<p>type of point (open circle, close circle, square etc.) to be passed to the graphic argument <code>pch</code> of functions <code>plot</code> and <code>lines</code> used to draw the evenness curve of each community.
</p>
</td></tr>
<tr><td><code id="eveparam_+3A_...">...</code></td>
<td>

<p>other arguments can be added and passed to the functions <code>plot</code> and <code>lines</code> used to draw the graphic.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Function <code>eveparam</code>, if only one value of <code>q</code> is given, returns a vector with the evenness in the communities. If more than one value of <code>q</code> is given, a list of two objects is returned: 
</p>
<table role = "presentation">
<tr><td><code>q</code></td>
<td>
<p>the vector of values for <code>q</code>;</p>
</td></tr>
<tr><td><code>div</code></td>
<td>
<p>a data frame with the evenness in the communities calculated for all values of <code>q</code>.</p>
</td></tr>
</table>
<p>The function <code>plot.eveparam</code> returns a graphic.
</p>


<h3>Author(s)</h3>

<p>Sandrine Pavoine <a href="mailto:sandrine.pavoine@mnhn.fr">sandrine.pavoine@mnhn.fr</a>
</p>


<h3>References</h3>

<p>Daroczy, Z. (1970) Generalized information functions. <em>Information and Control</em>, <b>16</b>, 36&ndash;51.
</p>
<p>Havrda, M., Charvat, F. (1967) Quantification method of classification processes: concept of structural alpha-entropy. <em>Kybernatica</em>, <b>3</b>, 30&ndash;35.
</p>
<p>Hill, M.O. (1973) Diversity and evenness: a unifying notation and its consequences. <em>Ecology</em>, <b>54</b>, 427&ndash;432.
</p>
<p>Renyi, A. (1960) On measures of entropy and information. <em>Proceedings of the Fourth Berkeley Symposium on Mathematical Statistics and Probability</em>, <b>1</b>, 547&ndash;561.
</p>
<p>Tsallis, C. (1988) Possible generalization of Boltzmann-Gibbs statistics. <em>Journal of Statistical Physics</em>, <b>52</b>, 480&ndash;487.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(batcomm)
ab &lt;- batcomm$ab
plot(eveparam(ab))
plot(eveparam(ab, q=0:4))
</code></pre>

<hr>
<h2 id='evoCA'>
Evolutionary Correspondence Analysis
</h2><span id='topic+evoCA'></span><span id='topic+plot.evoCA'></span>

<h3>Description</h3>

<p>The function <code>evoCA</code> performs the evolutionary correspondence analysis (evoCA) (Pavoine 2016): an adaptation of the correspondence analysis (CA) to analyse the distributions of lineages among sites and, simultaneously, to analyse the phylogenetic composition of sites. The function <code>plot.evoCA</code> displays the phylogeny on the factorial maps of evoCA.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evoCA(phyl, comm, scannf = TRUE, nf = 2, abundance = TRUE)

## S3 method for class 'evoCA'
plot(x, xaxis = 1, yaxis = 2, graph = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="evoCA_+3A_phyl">phyl</code></td>
<td>

<p>an object inheriting the class <code>phylo</code> (see package ape), <code>phylo4</code> (see package phylobase) or <code>hclust</code>. To ease the interpretation of factorial maps, it is advised to use a rooted phylogenetic tree and to add labels to the nodes of the phylogeny. For example, If you phylogeny is named 'tree' and is of class <code>phylo</code>, you can root the phylogeny using <code>tree$root.edge &lt;- 0</code> and you can name the nodes with the following command:
<code>tree$node.label &lt;- paste("n", 1:tree$Nnode, sep="")</code>. Use <code>plot(tree, show.node.label=TRUE)</code> to see the result. If it is rooted and of class <code>phylo4</code>, you can use: <code>nodeLabels(tree) &lt;- paste("n", 1:nNodes(tree), sep="")</code>.
</p>
</td></tr>
<tr><td><code id="evoCA_+3A_comm">comm</code></td>
<td>

<p>a data frame or a matrix typically with communities (or sites, plots, etc.) as rows, species as columns and presence/absence (1/0) or an index of abundance as entries. Species should be labeled as in the phylogenetic tree where they are the tips.
</p>
</td></tr>
<tr><td><code id="evoCA_+3A_scannf">scannf</code></td>
<td>

<p>a logical value indicating whether the screeplot (eigenvalues) should be displayed for choosing the number of axes to be kept.
</p>
</td></tr>
<tr><td><code id="evoCA_+3A_nf">nf</code></td>
<td>

<p>if <code>scannf</code> is <code>FALSE</code>, an integer indicating the number of axes to be kept.
</p>
</td></tr>
<tr><td><code id="evoCA_+3A_abundance">abundance</code></td>
<td>

<p>a logical value, if <code>FALSE</code>, only the presences/absences of the <b>evolutionary units</b> in sites are considered.
</p>
</td></tr>
<tr><td><code id="evoCA_+3A_x">x</code></td>
<td>

<p>an object of class <code>evoCA</code></p>
</td></tr>
<tr><td><code id="evoCA_+3A_xaxis">xaxis</code></td>
<td>

<p>the number of the evoCA axis chosen for the x-axis of the 3d plot.
</p>
</td></tr>
<tr><td><code id="evoCA_+3A_yaxis">yaxis</code></td>
<td>

<p>the number of the evoCA axis chosen for the y-axis of the 3d plot.
</p>
</td></tr>
<tr><td><code id="evoCA_+3A_graph">graph</code></td>
<td>

<p>a logical value. <code>plot.evoCA</code> depends on package <code>rgl</code>. This package will only work if you have graphics support on your computer. If you do have graphics support, choose graph = TRUE and you will be able to visualize the 3d plot with coordinates for species and phylogenetic nodes.
</p>
</td></tr>
<tr><td><code id="evoCA_+3A_...">...</code></td>
<td>

<p>other arguments can be added and passed to the function <code>plot3d</code> of package rgl.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>evoCA</code> returns an object of class <code>evoCA</code> and of class <code>dudi</code> (see package ade4, <code>?dudi</code>). Graphical tools are associated with class <code>dudi</code> in packages ade4 and adegraphics (see example section below and <code>?scatter.dudi</code>).
</p>
<p>The returned object contains the following components:
</p>
<table role = "presentation">
<tr><td><code>tab</code></td>
<td>
<p>a data frame with n rows and p columns, with communities as rows and nodes of the phylogeny as columns; the entries of the data frame evaluate the degree of dependence (values that depart from zero)/independence(close-to-zero values) between the occurrence in a community and the position in the phylogeny;</p>
</td></tr>
<tr><td><code>cw</code></td>
<td>
<p>weights attributed to the nodes of the phylogeny, a vector with p components;</p>
</td></tr>
<tr><td><code>lw</code></td>
<td>
<p>weights attributed to the communities, a vector with n components;</p>
</td></tr>
<tr><td><code>eig</code></td>
<td>
<p>vector of eigenvalues;</p>
</td></tr>
<tr><td><code>rank</code></td>
<td>
<p>integer, number of axes;</p>
</td></tr>
<tr><td><code>nf</code></td>
<td>
<p>integer, number of kept axes;</p>
</td></tr>
<tr><td><code>c1</code></td>
<td>
<p>normed scores for the nodes of the phylogeny, data frame with p rows and nf columns;</p>
</td></tr>
<tr><td><code>l1</code></td>
<td>
<p>normed scores for the communities, data frame with n rows and nf columns;</p>
</td></tr>
<tr><td><code>co</code></td>
<td>
<p>scores for the nodes of the phylogeny, data frame with p rows and nf columns;</p>
</td></tr>
<tr><td><code>li</code></td>
<td>
<p>scores for the communities, data frame with n rows and nf columns;</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the original call.</p>
</td></tr>
</table>
<p>If X is an object of class <code>evoCA</code>, then <code>attributes(X)$phy</code> contains the phylogenetic tree (of class <code>phylo</code>) with names for internal nodes. 
</p>
<p><code>plot.evoCA</code> returns a dynamics 3-dimensional plot
</p>


<h3>Author(s)</h3>

<p>Sandrine Pavoine <a href="mailto:sandrine.pavoine@mnhn.fr">sandrine.pavoine@mnhn.fr</a>
</p>


<h3>References</h3>

<p>Pavoine, S. (2016) A guide through a family of phylogenetic dissimilarity measures among sites. <em>Oikos</em>, <b>125</b>, 1719&ndash;1732.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+evoNSCA">evoNSCA</a></code>, <code><a href="#topic+evopcachord">evopcachord</a></code>, <code><a href="#topic+evopcahellinger">evopcahellinger</a></code>, <code><a href="#topic+evodiss">evodiss</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
if(require(ade4) &amp;&amp; require(ape) &amp;&amp; require(adegraphics)){
O &lt;- adegpar()$plabels$optim
adegpar("plabels.optim" = TRUE)

data(batcomm)
ab &lt;- batcomm$ab
phy &lt;- read.tree(text=batcomm$tre)
plot(phy, show.node=TRUE)
evoCAbat &lt;- evoCA(phy, ab, scan=FALSE, nf=2)
evoCAbat$eig/sum(evoCAbat$eig)
s.label(evoCAbat$li)
s.label(evoCAbat$co)
s.arrow(evoCAbat$co)
inertia.dudi(evoCAbat, row=TRUE)$row.abs
inertia.dudi(evoCAbat, col=TRUE)$col.abs

evoCAbat &lt;- evoCA(phy, ab, scan=FALSE, nf=3) ## All axes are now retained
# The Euclidean (canonical) distances among habitat points on the evoCA space is
dist(evoCAbat$li)
# which is equal to evoDchi2:
evodiss(phy, ab, "chi2")

# Run the following commands only 
# if you have graphics support to use 
# the rgl package on your computer:
plot(evoCAbat, graph = TRUE)
# With argument "graph = TRUE"
# you will be able to vizualize the 3d plot.

# See also,
plot(evoCAbat, xaxis=1, yaxis=3, graph = TRUE)
adegpar("plabels.optim" = O)

}

## End(Not run)
</code></pre>

<hr>
<h2 id='evodiss'>
Pair-wise Phylogenetic Dissimilarities between Communities
</h2><span id='topic+evodiss'></span>

<h3>Description</h3>

<p>The function calculates PD-dissimilarity indices described and/or discussed in Pavoine (2016). Part of them are parametric indices. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evodiss(phyl, comm, method = NULL, q = NULL, 
w = c("evoab", "even", "speciesab"), diag = FALSE, 
upper = FALSE, tol = 1e-08)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="evodiss_+3A_phyl">phyl</code></td>
<td>

<p>an object inheriting the class <code>phylo</code> (see package ape), <code>phylo4</code> (see package phylobase) or <code>hclust</code>.
</p>
</td></tr>
<tr><td><code id="evodiss_+3A_comm">comm</code></td>
<td>

<p>a data frame typically with communities as rows, species as columns and an index of abundance as entries. Species should be labeled as in the phylogenetic tree where they are the tips.
</p>
</td></tr>
<tr><td><code id="evodiss_+3A_method">method</code></td>
<td>

<p>one of the following string codes: <code>"Minkowski"</code>, <code>"Euclidean"</code>, <code>"Manhattan"</code>, <code>"Chord"</code>, <code>"ScaledCanberra"</code>, <code>"Divergence"</code>, <code>"BC"</code>, <code>"MH"</code>, <code>"LG"</code>, <code>"Hellinger"</code>, <code>"chi2"</code>, <code>"Hill"</code>, <code>"Renyi"</code>, <code>"C"</code>, <code>"U"</code>, <code>"S"</code>. See Details.
</p>
</td></tr>
<tr><td><code id="evodiss_+3A_q">q</code></td>
<td>

<p>a vector with nonnegative value(s) for parameter <code>q</code> only used with <code>method="Minkowski"</code>, <code>"Hill"</code>, <code>"Renyi"</code> (parametric indices). <code>q</code> controls the importance given to rare compared to abundant evolutionary units. See Details.
</p>
</td></tr>
<tr><td><code id="evodiss_+3A_w">w</code></td>
<td>

<p>either a numeric vector giving weights for communities (same order as in <code>comm</code>), or a string among <code>"even"</code>, <code>"evoab"</code>, and <code>"speciesab"</code>. If several strings are given, only the first one is used. <code>w</code> is used only if <code>method="Hill"</code>, <code>"Renyi"</code>, <code>"C"</code>, <code>"U"</code>, or <code>"S"</code> is chosen. See details.
</p>
</td></tr>
<tr><td><code id="evodiss_+3A_diag">diag</code></td>
<td>

<p>logical argument passed to function as.dist (R base).
</p>
</td></tr>
<tr><td><code id="evodiss_+3A_upper">upper</code></td>
<td>

<p>logical argument passed to function as.dist (R base).
</p>
</td></tr>
<tr><td><code id="evodiss_+3A_tol">tol</code></td>
<td>

<p>numeric tolerance threshold: values between -<code>tol</code> and <code>tol</code> are considered equal to zero.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The indices available are (formulas can be found in Supplementary material Appendix 1 of Pavoine 2016):
</p>
<p><code>"Minkowski"</code>:<code class="reqn">^qevoD_{Minkowski}</code>
</p>
<p><code>"Euclidean"</code>: <code class="reqn">evoD_{Euclidean}</code>
</p>
<p><code>"Manhattan"</code>: <code class="reqn">evoD_{Manhattan}</code>
</p>
<p><code>Chord</code>: <code class="reqn">evoD_{Chord}</code>
</p>
<p><code>ScaledCanberra</code>: <code class="reqn">evoD_{ScaledCanberra}</code>
</p>
<p><code>Divergence</code>: <code class="reqn">evoD_{Divergence}</code>
</p>
<p><code>BC</code>: <code class="reqn">evoD_{Bray-Curtis}</code>
</p>
<p><code>MH</code>: <code class="reqn">evoD_{Morisita-Horn}</code>
</p>
<p><code>LG</code>: <code class="reqn">evoD_{Profile}</code>
</p>
<p><code>Hellinger</code>: <code class="reqn">evoD_{Hellinger}</code>
</p>
<p><code>chi2</code>: <code class="reqn">evoD_{Chi2}</code>
</p>
<p><code>Hill</code>: <code class="reqn">1-\bar{V}_{q2}</code>
</p>
<p><code>Renyi</code>: <code class="reqn">^qevoD_{Renyi}</code>
</p>
<p><code>C</code>: <code class="reqn">1-\bar{C}_{q2}</code>
</p>
<p><code>U</code>: <code class="reqn">1-\bar{U}_{q2}</code>
</p>
<p><code>S</code>: <code class="reqn">1-\bar{S}_{q2}</code>
</p>
<p>The weights of the communities (argument <code>w</code>) can be <code>"even"</code> (even weights, i.e. relative abundances are considered for evolutionary units), <code>"evoab"</code> (proportional to the summed abundances of all evolutionary units, i.e. absolute abundances are considered for evolutionary units), or <code>"speciesab"</code> (proportional to the summed abundances of all species). Note that if the phylogenetic tree is ultrametric (the distance from any species to the root is constant), then
options <code>"evoab"</code> and <code>"speciesab"</code> are equivalent.</p>


<h3>Value</h3>

<p>An object of class <code>dist</code> containing the PD-dissimilarities (phylogenetic dissimilarities) between communities.
</p>


<h3>Author(s)</h3>

<p>Sandrine Pavoine <a href="mailto:sandrine.pavoine@mnhn.fr">sandrine.pavoine@mnhn.fr</a>
</p>


<h3>References</h3>

<p>The methodologies are presented in 
</p>
<p>Pavoine, S. (2016) A guide through a family of phylogenetic dissimilarity measures among sites. <em>Oikos</em>, <b>125</b>, 1719&ndash;1732. 
</p>
<p>They gather, in a common framework, indices introduced in  
</p>
<p>Chiu, C.-H., Jost, L., Chao, A. (2014) Phylogenetic beta diversity, similarity and differentiation measures based on Hill numbers. <em>Ecological Monographs</em>, <b>84</b>, 21&ndash;44.
</p>
<p>and earlier work extended here in a phylogenetic context and reviewed in 
</p>
<p>Legendre, P. and De Caceres, M. (2013) Beta diversity as the variance of community data: dissimilarity coefficients and partitioning. <em>Ecology Letters</em>, <b>16</b>, 951&ndash;963.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+evodiss_family">evodiss_family</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
if(require(ape)){

data(batcomm)
phy &lt;- read.tree(text=batcomm$tre)
ab &lt;- batcomm$ab[,phy$tip.label]

evodiss(phy, ab, "LG")
evodiss(phy, ab, "Hellinger")
evodiss(phy, ab, "Chord")

evodiss(phy, ab, "Hill", q=2)
evodiss(phy, ab, "Hill", q=2, w="even")

}

## End(Not run)
</code></pre>

<hr>
<h2 id='evodiss_family'>
A Family of Indices Dedicated to Pair-wise Phylogenetic Dissimilarities between Communities
</h2><span id='topic+evodiss_family'></span><span id='topic+evodiss_ternaryplot'></span>

<h3>Description</h3>

<p>The function <code>evodiss_family</code> was written thanks to function <code>dist.binary</code> of package ade4. Function <code>dist.binary</code> calculates specific compositional distances. The new function here replaces species with evolutionary units. It calculates Nipperess et al. (2010) parameters a, b, c, d (with incidence data), or A, B, C, D (with abundance data) and then use these parameters to compute pair-wise phylogenetic dissimilarities between communities.
</p>
<p>The graphical function <code>evodiss_ternaryplot</code> displays Nipperess et al. (2010) parameters a, b, c (with incidence data), or A, B, C (with abundance data) on a ternary plot (see Koleff et al. 2003).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evodiss_family(phyl, comm, method = NULL, abundance = TRUE,
squareroot = TRUE, diag = FALSE, upper = FALSE, tol = 1e-08)

evodiss_ternaryplot(phyl, comm, abundance = TRUE, 
tol = 1e-08, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="evodiss_family_+3A_phyl">phyl</code></td>
<td>

<p>an object inheriting the class <code>phylo</code> (see package ape), <code>phylo4</code> (see package phylobase) or <code>hclust</code>.
</p>
</td></tr>
<tr><td><code id="evodiss_family_+3A_comm">comm</code></td>
<td>

<p>a data frame typically with communities as rows, species as columns and presence/absence or an index of abundance as entries. Species should be labeled as in the phylogenetic tree where they are the tips.
</p>
</td></tr>
<tr><td><code id="evodiss_family_+3A_method">method</code></td>
<td>

<p>either NULL or a number between 1 and 14. If <code>NULL</code>, the choice is made with a console message. See details.
</p>
</td></tr>
<tr><td><code id="evodiss_family_+3A_abundance">abundance</code></td>
<td>

<p>a logical indicating whether abundance data (if <code>TRUE</code>) or incidence data (presence/absence if <code>FALSE</code>) must be used.</p>
</td></tr>
<tr><td><code id="evodiss_family_+3A_squareroot">squareroot</code></td>
<td>

<p>a logical. First a similarity index (<em>S</em>) is calculated (see details). Then if <code>squareroot=TRUE</code>, the dissimilarity is calculated as <code class="reqn">\sqrt{1-S}</code>. If squareroot=FALSE, it is calculated as 1-<em>S</em>. The square root is useful to obtain Euclidean properties for the PD-dissimilarity indices (with methods 1 to 10).</p>
</td></tr>
<tr><td><code id="evodiss_family_+3A_diag">diag</code></td>
<td>

<p>logical argument passed to function as.dist (R base).
</p>
</td></tr>
<tr><td><code id="evodiss_family_+3A_upper">upper</code></td>
<td>

<p>logical argument passed to function as.dist (R base).
</p>
</td></tr>
<tr><td><code id="evodiss_family_+3A_tol">tol</code></td>
<td>

<p>numeric tolerance threshold: values between -<code>tol</code> and <code>tol</code> are considered equal to zero.
</p>
</td></tr>
<tr><td><code id="evodiss_family_+3A_...">...</code></td>
<td>

<p>other arguments can be added and passed to the function <code>triangle.plot</code> of the ade4 package (labels cannot be changed and are defined thanks to the row names of <code>comm</code>).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function was written thanks to function <code>dist.binary</code> of package ade4. Function <code>dist.binary</code> calculates specific compositional distances. The new function here replaces species with evolutionary units and adds several indices. It calculates Nipperess et al. (2010) parameters a, b, c, d (with incidence data), or A, B, C, D (with abundance data). Then, the parameters are combined thanks to one out of 14 methods as defined below:
</p>
<p><code>method = 1</code>: Jaccard index (1901); S3 coefficient of Gower and Legendre (1986) = a / (a+b+c).
</p>
<p><code>method = 2</code>: Simple matching coefficient of Sokal and Michener (1958); S4 coefficient of Gower and Legendre (1986) = (a+d) / (a+b+c+d).
</p>
<p><code>method = 3</code>: Sokal and Sneath(1963); S5 coefficient of Gower and Legendre (1986) = a / (a + 2(b + c)).
</p>
<p><code>method = 4</code>: Rogers and Tanimoto (1960); S6 coefficient of Gower and Legendre (1986) = (a + d) / (a + 2(b + c) +d).
</p>
<p><code>method = 5</code>: Dice (1945) or Sorensen (1948); S7 coefficient of Gower and Legendre (1986) = 2a / (2a + b + c).
</p>
<p><code>method = 6</code>: Hamann coefficient; S9 index of Gower and Legendre (1986) = (a - (b + c) + d) / (a + b + c + d).
</p>
<p><code>method = 7</code>: Ochiai (1957); S12 coefficient of Gower and Legendre (1986) = a / sqrt((a + b)(a + c)).
</p>
<p><code>method = 8</code>: Sokal and Sneath (1963); S13 coefficient of Gower and Legendre (1986) = ad / sqrt((a + b)(a + c)(d + b)(d + c)).
</p>
<p><code>method = 9</code>: Phi of Pearson; S14 coefficient of Gower and Legendre (1986) = (ad - bc) / sqrt((a + b)(a + c)(d + b)(d + c)).
</p>
<p><code>method = 10</code>: S2 coefficient of Gower and Legendre (1986) = a / (a + b + c + d) (imposed unit self-similarity).
</p>
<p><code>method = 11</code>: Kulczynski index; S10 coefficient of Gower and Legendre (1986) = 0.5 * (a/(a+b) + a/(a+c))
</p>
<p><code>method = 12</code>: S11 coefficient of Gower and Legendre (1986) = 0.25 * (a/(a+b) + a/(a+c) + d/(b+d) + d/(c+d)) 
</p>
<p><code>method = 13</code>: S8 coefficient of Gower and Legendre (1986)  = (a+d)/(a+0.5*(b+c)+d)
</p>
<p><code>method = 14</code>: Simpson coefficient  = a/(a+min(b,c))
</p>


<h3>Value</h3>

<p>Function <code>evodiss_family</code> returns an object of class <code>dist</code> containing the PD-dissimilarities (phylogenetic dissimilarities) between communities.
</p>
<p>Function <code>evodiss_ternaryplot</code> returns a graph.
</p>


<h3>Author(s)</h3>

<p>Sandrine Pavoine <a href="mailto:sandrine.pavoine@mnhn.fr">sandrine.pavoine@mnhn.fr</a>
</p>


<h3>References</h3>

<p>The methodologies are presented in 
Pavoine, S. (2016) A guide through a family of phylogenetic dissimilarity measures among sites. <em>Oikos</em>, <b>125</b>, 1719&ndash;1732. 
</p>
<p>They gather in a common framework and extend earlier work introduced in  
Koleff, P., Gaston, K.J., Lennon, J.J. (2003) Measuring beta diversity for presence-absence data. <em>Journal of Animal Ecology</em>, <b>72</b>, 367&ndash;382.
</p>
<p>Nipperess, D.A., Faith, D.P., Barton, K.(2010) Resemblance in phylogenetic diversity among ecological assemblages. <em>Journal of Vegetation Science</em>, <b>21</b>, 809&ndash;820.
</p>
<p>Dice, L.R. (1945) Measures of the amount of ecologic association between species. <em>Ecology</em>, <b>26</b>, 297&ndash;302.
</p>
<p>Gower, J.C., Legendre, P. (1986) Metric and Euclidean properties of dissimilarity coefficients. <em>Journal of Classification</em>, <b>3</b>, 5&ndash;48.
</p>
<p>Jaccard, P. (1901) Etude comparative de la distribution florale dans une portion des Alpes et des Jura. <em>Bulletin de la Societe Vaudoise des Sciences Naturelles</em>, <b>37</b>, 547&ndash;579.
</p>
<p>Ochiai, A. (1957) Zoogeographic studies on the soleoid fishes found in Japan and its neighbouring regions. <em>Bulletin of the Japanese Society of Scientific Fisheries</em>, <b>22</b>, 526&ndash;530.
</p>
<p>Rogers, J.S. and Tanimoto, T.T. (1960) A computer program for classifying plants. <em>Science</em>, <b>132</b>, 1115&ndash;1118.
</p>
<p>Sokal, R.R. and Michener, C.D. (1958) A Statistical Method for Evaluating Systematic Relationships. <em>The University of Kansas Science Bulletin</em>, <b>38</b>, 1409&ndash;1438.
</p>
<p>Sokal, R.R. and Sneath, P.H.A. (1963) <em>Principles of numerical taxonomy</em>. San Francisco: W. H. Freeman.
</p>
<p>Sorensen, T. (1948) A method of establishing groups of equal amplitude in plant sociology based on similarity of species content. <em>Kongelige Danske Videnskabernes Selskabs Biologiske Skrifter</em>, <b>5</b>, 1&ndash;34.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+evodiss">evodiss</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
if(require(ape)){

data(batcomm)
phy &lt;- read.tree(text=batcomm$tre)
ab &lt;- batcomm$ab[,phy$tip.label]

# PD-dissimilarity indices that use Nipperess et al. (2010)
# parameters can be obtained thanks to function evodiss_family. 
# For example, with incidence data, 
# indices evoDJaccard, evoDSorensen, and evoDOchiai 
# (supplementary Appendix 1 in Pavoine 2016) 
# can be obtained as follows:

evodiss_family(phy, ab, method=1, abundance=FALSE) # Jaccard
evodiss_family(phy, ab, method=5, abundance=FALSE) # Sorensen
evodiss_family(phy, ab, method=7, abundance=FALSE) # Ochiai

# With abundance data, indices evoDTJ, evoDTS, evoDTO 
# (supplementary Appendix 1 in Pavoine 2016) 
# can be obtained as follows:

evodiss_family(phy, ab, method=1) # evoDTJ
evodiss_family(phy, ab, method=5) # evoDTS
evodiss_family(phy, ab, method=7) # evoDTO

# Ternary plots can be obtained for Nipperess et al. (2010) 
# parameters a, b, c (incidence data) 
# (see Supplementary material Appendix 4 in Pavoine 2016):

evodiss_ternaryplot(phy, ab, abundance = FALSE)

# and for Nipperess et al. (2010) parameters A, B, C 
# (abundance data):

evodiss_ternaryplot(phy, ab, abundance = TRUE)

# The ternary plots can be adjusted thanks 
# to the arguments of function triangle.plot (package ade4). 
# For example, full triangles can be obtained as follows 
# (previous graphs were zoomed on the smallest principal 
# equilateral triangle that contained the points, 
# as indicated by the embedded close grey triangle 
# at the left-hand corner of ternary plot given above):

evodiss_ternaryplot(phy, ab, abundance = FALSE, adjust=FALSE, showposition=FALSE)
# Incidence data

evodiss_ternaryplot(phy, ab, abundance = TRUE, adjust=FALSE, showposition=FALSE)
# abundance data

}

## End(Not run)
</code></pre>

<hr>
<h2 id='evodiv'>
Indices of Phylogenetic Diversity
</h2><span id='topic+evodiv'></span>

<h3>Description</h3>

<p>The function <code>evodiv</code> calculates diversity indices that rely on the relative or absolute abundance of features on a phylogenetic tree, with the assumption that the number of features on a given branch of a phylogenetic tree is equal to the length of this branch (see Pavoine 2016).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evodiv(phyl, comm, method = "full", tol = 1e-8)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="evodiv_+3A_phyl">phyl</code></td>
<td>
<p>an object inheriting the class <code>phylo</code> (see package ape), <code>phylo4</code> (see package phylobase), or <code>hclust</code>.</p>
</td></tr>
<tr><td><code id="evodiv_+3A_comm">comm</code></td>
<td>
<p>a data frame or a matrix typically with communities as rows, species as columns and an index of abundance as entries. Species should be labeled as in the phylogenetic tree where they are the tips. Note that with presence/absence (0/1) data, only feature richness will be calculated correctly.</p>
</td></tr>
<tr><td><code id="evodiv_+3A_method">method</code></td>
<td>

<p>a string or a vector of strings: one or several of &quot;richness&quot;, &quot;GiniSimpson&quot;, &quot;Simpson&quot;, &quot;Shannon&quot;, &quot;Margalef&quot;, &quot;Menhinick&quot;, &quot;McIntosh&quot;, &quot;full&quot;. See details.
</p>
</td></tr>
<tr><td><code id="evodiv_+3A_tol">tol</code></td>
<td>

<p>a tolerance threshold (a value between -<code>tol</code> and <code>tol</code> is considered equal to zero)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let <code class="reqn">L_b</code> the length of branch b in the phylogenetic tree. Let <code class="reqn">a_bi</code> the absolute abundance of branch <em>b</em> in community <em>i</em> (sum of abundance of all species descending from it in the phylogenetic tree). <code class="reqn">p_{bi} = a_{bi}/\sum_b L_b a_{bi}</code> is the relative abundance of branch <em>b</em> in community <em>i</em>.
If <code>method="richness"</code>, the diversity index is the number of features (branch units): <code class="reqn">\sum_b L_b</code>. It corresponds to Faith (1992) Phylogenetic Diversity index.
If <code>method="GiniSimpson"</code>, the diversity index is that of Gini (1912) and Simpson (1949): <code class="reqn">1-\sum_b L_b p_{bi}^2</code>.
If <code>method="Simpson"</code>, the diversity index is that of Simpson (1949): <code class="reqn">1/\sum_b L_b p_{bi}^2</code>.
If <code>method="Shannon"</code>, the diversity index is that of Shannon (1948) with neperian logarithm: <code class="reqn">-\sum_b L_b p_{bi} log(p_{bi})</code>.
If <code>method="Margalef"</code>, the diversity index is that of Margalef (1972): <code class="reqn">(\sum_b L_b-1)/log(\sum_b L_b a_{bi})</code>.
If <code>method="Menhinick"</code>, the diversity index is that of Menhinick (1964): <code class="reqn">\sum_b L_b/\sqrt{sum_b L_b a_bi}</code>.
If <code>method="McIntosh"</code>, the diversity index is that of McIntosh (1967): <code class="reqn">(\sum_b L_b a_{bi}-\sqrt{\sum_b L_b a_{bi}^2})/(\sum_b L_b a_{bi}-\sqrt{\sum_b L_b a_{bi}})</code>.
If one of the strings is &quot;full&quot;, then all indices are calculated.
</p>
<p><b>For the indices relying on relative abundances to be valid, each species must support at least one feature. If this is not the case and one of these indices has to be calculated, the phylogenetic tree is re-scaled so that the shortest distance from tip to root is equal to 1. This means that the scale of the branch lengths will be changed, which will impact the calculation of feature richness (method=&quot;richness&quot;) and the indices of Margalef, Menhinick and McIntosh.</b>
</p>
<p>In the rare cases where this scaling will be necessary, a better option is that the scaling be done by the user itself (prior to the use of the evodiv function). Indeed, this will unable them to choose an appropriate scaling. For example, if branch lengths are expressed as billion years of evolution and the sum of branch lengths from tip to root is lower than one billion. Then expressing branch lengths in million years of evolution may solve the problem, leading to sum of branch lengths from tip to root higher than 1 million years.  
</p>
<p>If the phylogenetic tree has no branch lengths, all branches are set to a length of 1.
</p>


<h3>Value</h3>

<p>Function <code>evodiv</code> returns a matrix with communities as rows and the diversity indices as columns. 
</p>


<h3>Author(s)</h3>

<p>Sandrine Pavoine <a href="mailto:sandrine.pavoine@mnhn.fr">sandrine.pavoine@mnhn.fr</a>
</p>


<h3>References</h3>

<p>Gini, C. (1912) Variabilita e mutabilita. Studi economicoaguridici delle facoltta di giurizprudenza dell, Universite di Cagliari III, Parte II.
</p>
<p>Magurran, A.E. (2004) Measuring biological diversity. Blackwell Publishing, Oxford, U.K.
</p>
<p>Margalef, R. (1972) Homage to Evelyn Hutchinson, or why is there an upper limit to diversity? <em>Transactions of the Connecticut Academy of Arts and Sciences</em>, <b>44</b>, 211&ndash;235.
</p>
<p>McIntosh, R.P. (1967) An index of diversity and the relation of certain conepts to diversity. <em>Ecology</em>, <b>48</b>, 392&ndash;404. 
</p>
<p>Menhinick, E.F. (1964) A Comparison of Some Species-Individuals Diversity Indices Applied to Samples ofField Insects. <em>Ecology</em>, <b>45</b>, 859&ndash;861.
</p>
<p>Pavoine, S. (2016) A guide through a family of phylogenetic dissimilarity measures among sites. <em>Oikos</em>, <b>125</b>, 1719&ndash;1732. 
</p>
<p>Pavoine, S., Ricotta, C. (2019) A simple translation from indices of species diversity to indices of phylogenetic diversity. <em>Ecological Indicators</em>, <b>101</b>, 552&ndash;561.
</p>
<p>Shannon, C.E. (1948) A mathematical theory of communication. <em>Bell System technical journal</em>, <b>27</b>, 379&ndash;423, 623&ndash;656.
</p>
<p>Simpson, E.H. (1949) Measurement of diversity. <em>Nature</em>, <b>163</b>, 688.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+evodivparam">evodivparam</a></code>, <code><a href="#topic+speciesdiv">speciesdiv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
if(require(ape)){
data(batcomm)
phy &lt;- read.tree(text=batcomm$tre)
ab &lt;- batcomm$ab[,phy$tip.label]
evodiv(phy, ab)
}

## End(Not run)
</code></pre>

<hr>
<h2 id='evodivparam'>
Parametric Indices of Phylogenetic Diversity
</h2><span id='topic+evodivparam'></span><span id='topic+plot.evodivparam'></span>

<h3>Description</h3>

<p>Function <code>evodivparam</code> calculates phylogenetic diversity in communities using parametric indices derived from Tsallis and Hill compositional indices. It can also be applied to functional trees rather than phylogenies, to calculate a functional diversity.
The function <code>plot.evodivparam</code> plots the results of function <code>evodivparam</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evodivparam(phyl, comm, 
    method = c("hill", "tsallis", "renyi"), 
    q = 2, tol = 1e-08)

## S3 method for class 'evodivparam'
plot(x, legend = TRUE, 
    legendposi = "topright", axisLABEL = "Tree-based diversity", 
    type="b", col = if(is.numeric(x)) NULL 
    else sample(colors(distinct = TRUE), nrow(x$div)), 
    lty = if(is.numeric(x)) NULL else rep(1, nrow(x$div)), 
    pch = if(is.numeric(x)) NULL else rep(19, nrow(x$div)), 
    ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="evodivparam_+3A_phyl">phyl</code></td>
<td>
<p>an object inheriting the class <code>phylo</code> (see package ape), <code>phylo4</code> (see package phylobase), or <code>hclust</code>.</p>
</td></tr>
<tr><td><code id="evodivparam_+3A_comm">comm</code></td>
<td>
<p>a data frame or a matrix typically with communities as rows, species as columns and abundance as entry. Species should be labeled as in the phylogenetic tree where they are the tips.</p>
</td></tr>
<tr><td><code id="evodivparam_+3A_method">method</code></td>
<td>
<p>a string: either &quot;hill&quot; for the Hill numbers (Hill 1973), &quot;tsallis&quot; for the Tsallis or HCDT entropy (Harvda and Charvat 1967; Daroczy 1970; Tsallis 1988), or &quot;renyi&quot; for Renyi's entropy (Renyi 1960). If several values are given, only the first one is considered. See details.</p>
</td></tr>
<tr><td><code id="evodivparam_+3A_q">q</code></td>
<td>
<p>a vector with nonnegative value(s) for parameter <code>q</code>. See details.</p>
</td></tr>
<tr><td><code id="evodivparam_+3A_tol">tol</code></td>
<td>
<p>numeric tolerance threshold: values between -<code>tol</code> and <code>tol</code> are considered equal to zero.</p>
</td></tr>
<tr><td><code id="evodivparam_+3A_x">x</code></td>
<td>
<p>an object of class <code>evodivparam</code> obtained with function <code>evodivparam</code>.</p>
</td></tr>
<tr><td><code id="evodivparam_+3A_legend">legend</code></td>
<td>
<p>a logical. If TRUE a legend is given with the colour, the type of line (etc.) used to define the diversity curve of each community.</p>
</td></tr>
<tr><td><code id="evodivparam_+3A_legendposi">legendposi</code></td>
<td>
<p>a string that gives the position of the legend to be passed to function <code>legend</code> of the base of R.</p>
</td></tr>
<tr><td><code id="evodivparam_+3A_axislabel">axisLABEL</code></td>
<td>

<p>a string to display on the main axis of the plot to designate what we are measuring. The default is <code>"Tree-based diversity"</code>.</p>
</td></tr> 
<tr><td><code id="evodivparam_+3A_type">type</code></td>
<td>
<p>a string to be passed to the graphic argument <code>type</code> of functions <code>plot</code> and <code>lines</code> used to draw the diversity curve of each community.</p>
</td></tr>
<tr><td><code id="evodivparam_+3A_col">col</code></td>
<td>
<p>vector of colours to be passed to the graphic argument <code>col</code> of functions <code>plot</code> and <code>lines</code> to define the colour of the diversity curve of each community.</p>
</td></tr>
<tr><td><code id="evodivparam_+3A_lty">lty</code></td>
<td>
<p>vector of type of line (plain, broken etc.) to be passed to the graphic argument <code>lty</code> of functions <code>plot</code> and <code>lines</code> used to draw the diversity curve of each community.</p>
</td></tr>
<tr><td><code id="evodivparam_+3A_pch">pch</code></td>
<td>
<p>type of point (open circle, close circle, square etc.) to be passed to the graphic argument <code>pch</code> of functions <code>plot</code> and <code>lines</code> used to draw the diversity level of each community.</p>
</td></tr>
<tr><td><code id="evodivparam_+3A_...">...</code></td>
<td>
<p>other arguments can be added and passed to the functions <code>plot</code> and <code>lines</code> used to draw the graphic.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Consider a phylogenetic tree <em>T</em>, <code class="reqn">b_T</code> the set of branches in <em>T</em>, <em>k</em> a branch, <code class="reqn">L_k</code> the length of branch <em>k</em>, <em>j</em> a community (<em>j</em>=1,...,<em>m</em>), <code class="reqn">a_{jk}</code> the abundance associated with branch <em>k</em> in community <em>j</em> (sum of abundance of all species descending from the branch). <em>q</em> is the parameter that increases with the importance given to abundant species compared to rare species in diversity.
</p>
<p>The methods available to calculate the phylogenetic diversity in community <em>j</em> are:
<code>tsallis</code>:
</p>
<p style="text-align: center;"><code class="reqn">^q{evoTsallis}_j=
\left[1-\sum_{k \in b_T} L_k \left(\frac{a_{jk}}{\sum_{k \in b_T} L_k a_{jk}}\right)^q \right]/(q-1)</code>
</p>

<p><code>hill</code>:
</p>
<p style="text-align: center;"><code class="reqn">^q{evoHill}_j=\left[\sum_{k \in b_T} L_k \left(\frac{a_{jk}}{\sum_{k \in b_T} L_k a_{jk}}\right)^q \right]^{1/(1-q)}</code>
</p>

<p><code>renyi</code>:
</p>
<p style="text-align: center;"><code class="reqn">^q{evoRenyi}_j=log(^q{evoHill}_j)</code>
</p>



<h3>Value</h3>

<p>If only one value of <code>q</code> is given, a vector with the phylogenetic diversity of each community is returned.
If more than one value of <code>q</code> is given, a list of two objects is returned: 
</p>
<table role = "presentation">
<tr><td><code>q</code></td>
<td>
<p>the vector of values for <code>q</code>;</p>
</td></tr>
<tr><td><code>div</code></td>
<td>
<p>a data frame with the phylogenetic diversity of each community calculated for all values of <code>q</code>.</p>
</td></tr>
</table>
<p>The function <code>plot.evodivparam</code> returns a graphic.
</p>


<h3>Author(s)</h3>

<p>Sandrine Pavoine <a href="mailto:sandrine.pavoine@mnhn.fr">sandrine.pavoine@mnhn.fr</a>
</p>


<h3>References</h3>

<p>The methodologies and scripts were developed by
</p>
<p>Pavoine, S., Ricotta, C. (2019) A simple translation from indices of species diversity to indices of phylogenetic diversity. <em>Ecological Indicators</em>, <b>101</b>, 552&ndash;561.
</p>
<p>using earlier work by:
</p>
<p>Chao, A., Chiu, C.-H., Jost, L. (2010) Phylogenetic diversity measures based on Hill numbers. <em>Philosophical Transactions of the Royal Society London Series B</em>, <b>365</b>, 3599&ndash;3609.
</p>
<p>Daroczy, Z. (1970) Generalized information functions. <em>Information and Control</em>, <b>16</b>, 36&ndash;51.
</p>
<p>Havrda, M., Charvat F. (1967) Quantification method of classification processes: concept of structural alpha-
entropy. <em>Kybernetik</em>, <b>3</b>, 30&ndash;35.
</p>
<p>Hill, M.O. (1973) Diversity and evenness: a unifying notation and its consequences. <em>Ecology</em>, <b>54</b>, 427&ndash;432.
</p>
<p>Pavoine, S. (2016) A guide through a family of phylogenetic dissimilarity measures among sites. <em>Oikos</em>, <b>125</b>, 1719&ndash;1732. 
</p>
<p>Renyi, A. (1960) On measures of entropy and information. <em>Proceedings of the Fourth Berkeley Symposium on Mathematical Statistics and Probability</em>, <b>1</b>, 547&ndash;561.
</p>
<p>Tsallis, C. (1988) Possible generalization of Boltzmann-Gibbs statistics. <em>Journal of Statistical Physics</em>, <b>52</b>, 480&ndash;487.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+abgevodivparam">abgevodivparam</a></code>, <code><a href="#topic+divparam">divparam</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
if(require(ape)){

data(batcomm)
phy &lt;- read.tree(text=batcomm$tre)
ab &lt;- batcomm$ab[, phy$tip.label]
plot(evodivparam(phy, ab))
plot(evodivparam(phy, ab, q=seq(0, 10, length=20)))

}

## End(Not run)
</code></pre>

<hr>
<h2 id='evoeveparam'>
Parametric Indices of Phylogenetic evenness
</h2><span id='topic+evoeveparam'></span><span id='topic+plot.evoeveparam'></span>

<h3>Description</h3>

<p>Function <code>evoeveparam</code> calculates phylogenetic evenness (evenness in features, which are branch units of a phylogenetic tree) in communities. It uses parametric indices derived from Tsallis and Hill compositional indices, and named qfeveHCDT, qfeveHill, and qfeveRenyi in Pavoine and Ricotta (2019). <code>evoeveparam</code> can also be applied to functional trees rather than phylogenies, to calculate a functional evenness.
The function <code>plot.evoeveparam</code> plots the results of function <code>evoeveparam</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evoeveparam(phyl, comm, method = c("hill", "tsallis", "renyi"), 
    q = 2, option = 1:3, H = NULL, tol = 1e-8)

## S3 method for class 'evoeveparam'
plot(x, legend = TRUE, 
    legendposi = "topright", axisLABEL = "Tree-based evenness", 
    type="b", col = if(is.numeric(x)) NULL 
    else sample(colors(distinct = TRUE), nrow(x$eve)), 
    lty = if(is.numeric(x)) NULL else rep(1, nrow(x$eve)), 
    pch = if(is.numeric(x)) NULL else rep(19, nrow(x$eve)), 
    ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="evoeveparam_+3A_phyl">phyl</code></td>
<td>
<p>an object inheriting the class <code>phylo</code> (see package ape), <code>phylo4</code> (see package phylobase), or <code>hclust</code>.</p>
</td></tr>
<tr><td><code id="evoeveparam_+3A_comm">comm</code></td>
<td>
<p>a data frame or a matrix typically with communities as rows, species as columns and abundance as entry. Species should be labeled as in the phylogenetic tree (object <code>phyl</code>) where they are the tips.</p>
</td></tr>
<tr><td><code id="evoeveparam_+3A_method">method</code></td>
<td>
<p>a string: either &quot;hill&quot; for qfeveHill using the Hill numbers (Hill 1973), &quot;tsallis&quot; for qfeveHCDT using the Tsallis or HCDT entropy (Harvda and Charvat 1967; Daroczy 1970; Tsallis 1988), or &quot;renyi&quot; for qfeveRenyi using Renyi's entropy (Renyi 1960). If several values are given, only the first one is considered. See details.</p>
</td></tr>
<tr><td><code id="evoeveparam_+3A_q">q</code></td>
<td>
<p>a vector with nonnegative value(s) for parameter <code>q</code> of functions qfeveHCDT, qfeveHill, and qfeveRenyi.</p>
</td></tr>
<tr><td><code id="evoeveparam_+3A_option">option</code></td>
<td>
<p>an integer (either 1, 2 or 3). If 1, the (Hill, Tsallis or Renyi) diversity index is divided by the value it would have if species had same abundance and were independent, if 2, the diversity is divided by the value it would have if species had same abundance, were independent, and at the maximum observed distance from tip to root, if 3, the diversity is divided by the value it would have if species had same abundance, were independent, and at a distance equal to H from the root of the tree. Options 1 and 2 are equivalent in case of an ultrametric tree.</p>
</td></tr>
<tr><td><code id="evoeveparam_+3A_h">H</code></td>
<td>
<p>a numeric; <code>H</code> must be higher than the largest observed distance from tip to root.</p>
</td></tr>
<tr><td><code id="evoeveparam_+3A_tol">tol</code></td>
<td>
<p>numeric tolerance threshold: values between -<code>tol</code> and <code>tol</code> are considered equal to zero.</p>
</td></tr>
<tr><td><code id="evoeveparam_+3A_x">x</code></td>
<td>
<p>an object of class <code>evoeveparam</code> obtained with function <code>evoeveparam</code>.</p>
</td></tr>
<tr><td><code id="evoeveparam_+3A_legend">legend</code></td>
<td>
<p>a logical. If TRUE a legend is given with the colour, the type of line (etc.) used to define the evenness curve of each community.</p>
</td></tr>
<tr><td><code id="evoeveparam_+3A_legendposi">legendposi</code></td>
<td>
<p>a string that gives the position of the legend to be passed to function <code>legend</code> of the base of R.</p>
</td></tr>
<tr><td><code id="evoeveparam_+3A_axislabel">axisLABEL</code></td>
<td>

<p>a string to display on the main axis of the plot to designate what we are measuring. The default is <code>"Tree-based evenness"</code>.</p>
</td></tr> 
<tr><td><code id="evoeveparam_+3A_type">type</code></td>
<td>
<p>a string to be passed to the graphic argument <code>type</code> of functions <code>plot</code> and <code>lines</code> used to draw the evenness curve of each community.</p>
</td></tr>
<tr><td><code id="evoeveparam_+3A_col">col</code></td>
<td>
<p>vector of colours to be passed to the graphic argument <code>col</code> of functions <code>plot</code> and <code>lines</code> to define the colour of the evenness curve of each community.</p>
</td></tr>
<tr><td><code id="evoeveparam_+3A_lty">lty</code></td>
<td>
<p>vector of type of line (plain, broken etc.) to be passed to the graphic argument <code>lty</code> of functions <code>plot</code> and <code>lines</code> used to draw the evenness curve of each community.</p>
</td></tr>
<tr><td><code id="evoeveparam_+3A_pch">pch</code></td>
<td>
<p>type of point (open circle, close circle, square etc.) to be passed to the graphic argument <code>pch</code> of functions <code>plot</code> and <code>lines</code> used to draw the evenness level of each community.</p>
</td></tr>
<tr><td><code id="evoeveparam_+3A_...">...</code></td>
<td>
<p>other arguments can be added and passed to the functions <code>plot</code> and <code>lines</code> used to draw the graphic.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function <code>evoeveparam</code> calculates feature evenness (features = branch units on a phylogenetic [or functional] tree) using parametric indices qfeveHCDT (with <code>method=tsallis</code>), qfeveHill (with <code>method=hill</code>), qfeveRenyi (with <code>method=renyi</code>) developed in Pavoine and Ricotta (2019). Note that Pavoine and Ricotta (2019) recommend the use of index qfeveHill (with <code>method=hill</code>). 
</p>


<h3>Value</h3>

<p>If only one value of <code>q</code> is given, the function <code>evoeveparam</code> returns a vector with the evenness values for the communities.
If more than one value of <code>q</code> is given, a list of two objects is returned: 
</p>
<table role = "presentation">
<tr><td><code>q</code></td>
<td>
<p>the vector of values for <code>q</code>;</p>
</td></tr>
<tr><td><code>eve</code></td>
<td>
<p>a data frame with the phylogenetic evenness in each community calculated for all values of <code>q</code>.</p>
</td></tr>
</table>
<p>The function <code>plot.evoeveparam</code> returns a graphic.
</p>


<h3>Author(s)</h3>

<p>Sandrine Pavoine <a href="mailto:sandrine.pavoine@mnhn.fr">sandrine.pavoine@mnhn.fr</a>
</p>


<h3>References</h3>

<p>The methodologies and scripts were developed by
</p>
<p>Pavoine, S., Ricotta, C. (2019) A simple translation from indices of species diversity to indices of phylogenetic diversity. <em>Ecological Indicators</em>, <b>101</b>, 552&ndash;561.
</p>
<p>using earlier work by:
</p>
<p>Chao, A., Chiu, C.-H., Jost, L. (2010) Phylogenetic diversity measures based on Hill numbers. <em>Philosophical Transactions of the Royal Society London Series B</em>, <b>365</b>, 3599&ndash;3609.
</p>
<p>Daroczy, Z. (1970) Generalized information functions. <em>Information and Control</em>, <b>16</b>, 36&ndash;51.
</p>
<p>Havrda, M., Charvat F. (1967) Quantification method of classification processes: concept of structural alpha-
entropy. <em>Kybernetik</em>, <b>3</b>, 30&ndash;35.
</p>
<p>Hill, M.O. (1973) Diversity and evenness: a unifying notation and its consequences. <em>Ecology</em>, <b>54</b>, 427&ndash;432.
</p>
<p>Pavoine, S. (2016) A guide through a family of phylogenetic dissimilarity measures among sites. <em>Oikos</em>, <b>125</b>, 1719&ndash;1732. 
</p>
<p>Renyi, A. (1960) On measures of entropy and information. <em>Proceedings of the Fourth Berkeley Symposium on Mathematical Statistics and Probability</em>, <b>1</b>, 547&ndash;561.
</p>
<p>Tsallis, C. (1988) Possible generalization of Boltzmann-Gibbs statistics. <em>Journal of Statistical Physics</em>, <b>52</b>, 480&ndash;487.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+evodivparam">evodivparam</a></code>, <code><a href="#topic+evouniparam">evouniparam</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
if(require(ape)){

data(batcomm)
phy &lt;- read.tree(text=batcomm$tre)
ab &lt;- batcomm$ab[, phy$tip.label]
plot(evoeveparam(phy, ab))
plot(evoeveparam(phy, ab, q=seq(0, 10, length=20)))

}

## End(Not run)
</code></pre>

<hr>
<h2 id='evoNSCA'>
Evolutionary Non-Symmetric Correspondence Analysis
</h2><span id='topic+evoNSCA'></span>

<h3>Description</h3>

<p>The function performs evoNSCA (Pavoine 2016): an adaptation of the non-symmetric correspondence analysis (NSCA) (see e.g. Kroonenberg and Lombardo 1999) to analyse the distributions of lineages among sites and, simultaneously, to analyse the phylogenetic composition of sites.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evoNSCA(phyl, comm, scannf = TRUE, nf = 2, abundance = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="evoNSCA_+3A_phyl">phyl</code></td>
<td>

<p>an object inheriting the class <code>phylo</code> (see package ape), <code>phylo4</code> (see package phylobase) or <code>hclust</code>. To ease the interpretation of factorial maps, it is advised to use a rooted phylogenetic tree and to add labels to the nodes of the phylogeny. For example, If your phylogeny is named 'tree' and is of class <code>phylo</code>, you can root the phylogeny using <code>tree$root.edge &lt;- 0</code> and you can name the nodes with the following command:
<code>tree$node.label &lt;- paste("n", 1:tree$Nnode, sep="")</code>. Use <code>plot(tree, show.node.label=TRUE)</code> to see the result. If it is rooted and of class <code>phylo4</code>, you can use: <code>nodeLabels(tree) &lt;- paste("n", 1:nNodes(tree), sep="")</code>.
</p>
</td></tr>
<tr><td><code id="evoNSCA_+3A_comm">comm</code></td>
<td>

<p>a data frame or a matrix typically with communities as rows, species as columns and presence/absence (1/0) or an index of abundance as entries. Species should be labeled as in the phylogenetic tree where they are the tips.
</p>
</td></tr>
<tr><td><code id="evoNSCA_+3A_scannf">scannf</code></td>
<td>

<p>a logical value indicating whether the screeplot (eigenvalues) should be displayed for choosing the number of axes to be kept.
</p>
</td></tr>
<tr><td><code id="evoNSCA_+3A_nf">nf</code></td>
<td>

<p>if scannf is <code>FALSE</code>, an integer indicating the number of axes to be kept.
</p>
</td></tr>
<tr><td><code id="evoNSCA_+3A_abundance">abundance</code></td>
<td>

<p>a logical value, if <code>FALSE</code>, only the presences/absences of the <b>evolutionary units</b> in sites are considered.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>evoNSCA</code> returns an object of class <code>evoNSCA</code> and of class <code>dudi</code> (see package ade4). Graphical tools are associated with class <code>dudi</code> in packages ade4 and adegraphics (see section &quot;Examples&quot; below).
</p>
<p>The returned object contains the following components:
</p>
<table role = "presentation">
<tr><td><code>tab</code></td>
<td>
<p>a data frame with n rows and p columns, with communities as rows and nodes of the phylogeny as columns. Internal data frame used by the algorithm;</p>
</td></tr>
<tr><td><code>cw</code></td>
<td>
<p>weights attributed to the nodes of the phylogeny, a vector with p components;</p>
</td></tr>
<tr><td><code>lw</code></td>
<td>
<p>weights attributed to the communities, a vector with n components;</p>
</td></tr>
<tr><td><code>eig</code></td>
<td>
<p>vector of eigenvalues;</p>
</td></tr>
<tr><td><code>rank</code></td>
<td>
<p>integer, number of axes;</p>
</td></tr>
<tr><td><code>nf</code></td>
<td>
<p>integer, number of kept axes;</p>
</td></tr>
<tr><td><code>c1</code></td>
<td>
<p>normed scores for the nodes of the phylogeny, data frame with p rows and nf columns;</p>
</td></tr>
<tr><td><code>l1</code></td>
<td>
<p>normed scores for the communities, data frame with n rows and nf columns;</p>
</td></tr>
<tr><td><code>co</code></td>
<td>
<p>scores for the nodes of the phylogeny, data frame with p rows and nf columns;</p>
</td></tr>
<tr><td><code>li</code></td>
<td>
<p>scores for the communities, data frame with n rows and nf columns;</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the original call.</p>
</td></tr>
</table>
<p>If X is an object of class <code>evoNSCA</code>, then <code>attributes(X)$phy</code> contains the phylogenetic tree (of class <code>phylo</code>) with names for internal nodes. 
</p>


<h3>Author(s)</h3>

<p>Sandrine Pavoine <a href="mailto:sandrine.pavoine@mnhn.fr">sandrine.pavoine@mnhn.fr</a>
</p>


<h3>References</h3>

<p>Pavoine, S. (2016) A guide through a family of phylogenetic dissimilarity measures among sites. <em>Oikos</em>, <b>125</b>, 1719&ndash;1732. 
</p>
<p>Kroonenberg PM, Lombardo R (1999) Nonsymmetric correspondence analysis: a tool for analysing contingency tables with a dependence structure. <em>Multivariate Behavioral Research</em>, <b>34</b>, 367&ndash;396.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+evoCA">evoCA</a></code>, <code><a href="#topic+evopcachord">evopcachord</a></code>, <code><a href="#topic+evopcahellinger">evopcahellinger</a></code>, <code><a href="#topic+evodiss">evodiss</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
if(require(ade4) &amp;&amp; require(ape) &amp;&amp; require(adegraphics)){
O &lt;- adegpar()$plabels$optim
adegpar("plabels.optim" = TRUE)

data(batcomm)
ab &lt;- batcomm$ab
phy &lt;- read.tree(text=batcomm$tre)
plot(phy, show.node=TRUE)
evoNSCAbat &lt;- evoNSCA(phy, ab, scan=FALSE, nf=2)
evoNSCAbat$eig/sum(evoNSCAbat$eig)
s.label(evoNSCAbat$li)
s.label(evoNSCAbat$co)
s.arrow(evoNSCAbat$co)
inertia.dudi(evoNSCAbat, row=TRUE)$row.abs
inertia.dudi(evoNSCAbat, col=TRUE)$col.abs

evoNSCAbat &lt;- evoNSCA(phy, ab, scan=FALSE, nf=3) ## All axes are now retained
# The Euclidean (canonical) distances among habitat points on the evoNSCA space is
dist(evoNSCAbat$li)
# which is equal to evoDprofile (see function evodiss):
evodiss(phy, ab, "LG")

adegpar("plabels.optim" = O)
}

## End(Not run)
</code></pre>

<hr>
<h2 id='evopca'>
Evolutionary Principal Component analyses
</h2><span id='topic+evopcachord'></span><span id='topic+evopcahellinger'></span>

<h3>Description</h3>

<p>The functions <code>evopcachord</code> and <code>evopcahellinger</code> perform two adaptations of Principal Component Analysis (PCA) for the analysis of phylogenetic diversity patterns across species communities: the evolutionary PCA based on Chord distance (evoPCAChord) and the evolutionary PCA based on Hellinger distance (evoPCAHellinger) (Pavoine 2016).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evopcachord(phyl, comm, option = c("centred", "decentred"), 
w = c("evoab", "even", "speciesab"), scannf = TRUE, 
nf = 2, abundance = TRUE)

evopcahellinger(phyl, comm, option = c("centred", "decentred"),
w = c("evoab", "even", "speciesab"), scannf = TRUE, 
nf = 2, abundance = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="evopca_+3A_phyl">phyl</code></td>
<td>

<p>an object inheriting the class <code>phylo</code> (see package ape), <code>phylo4</code> (see package phylobase) or <code>hclust</code>. To ease the interpretation of factorial maps, it is advised to use a rooted phylogenetic tree and to add labels to the nodes of the phylogeny. For example, If your phylogeny is named 'tree' and is of class <code>phylo</code>, you can root the phylogeny using <code>tree$root.edge &lt;- 0</code> and you can name the nodes with the following command:
<code>tree$node.label &lt;- paste("n", 1:tree$Nnode, sep="")</code>. Use <code>plot(tree, show.node.label=TRUE)</code> to see the result. If it is rooted and of class <code>phylo4</code>, you can use: <code>nodeLabels(tree) &lt;- paste("n", 1:nNodes(tree), sep="")</code>. 
</p>
</td></tr>
<tr><td><code id="evopca_+3A_comm">comm</code></td>
<td>

<p>a data frame or a matrix typically with communities as rows, species as columns and presence/absence (1/0) or an index of abundance as entries. Species should be labeled as in the phylogenetic tree where they are the tips.
</p>
</td></tr>
<tr><td><code id="evopca_+3A_option">option</code></td>
<td>

<p>a string: either <code>"centered"</code> or <code>"decentered"</code>. If several strings are given, only the first one is used. See details.</p>
</td></tr>
<tr><td><code id="evopca_+3A_w">w</code></td>
<td>

<p>a string: either <code>"evoab"</code>, <code>"even"</code>, or <code>"speciesab"</code>. If several strings are given, only the first one is used. See details.
</p>
</td></tr>
<tr><td><code id="evopca_+3A_scannf">scannf</code></td>
<td>

<p>a logical value indicating whether the screeplot (eigenvalues) should be displayed for choosing the number of axes to be kept.
</p>
</td></tr>
<tr><td><code id="evopca_+3A_nf">nf</code></td>
<td>

<p>if <code>scannf</code> is <code>FALSE</code>, an integer indicating the number of axes to be kept.
</p>
</td></tr>
<tr><td><code id="evopca_+3A_abundance">abundance</code></td>
<td>

<p>a logical value. If <code>FALSE</code>, only the presences/absences of the <b>evolutionary units</b> in communities are considered.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let <code class="reqn">L_k</code> be the length of branch <em>k</em> in the phylogenetic tree (out of <em>K</em> branches); <code class="reqn">a_{jk}</code> the sum of abundances, in community <em>j</em>, for all species descending from branch <em>k</em>; <code class="reqn">w_j</code> a positive weight attributed to community <em>j</em> (the definition for <code class="reqn">w_j</code> is flexible with the only requirement that <code class="reqn">\sum_{j=1}^m w_j=1</code>); 
<code class="reqn">a_{j+}=\sum_{k=1}^K L_k a_{jk}</code>; <code class="reqn">a_{+k}=\sum_{j=1}^m a_{jk}</code>; <code class="reqn">a_{++}=\sum_{j=1}^m\sum_{k=1}^K L_k a_{jk}</code>. 
</p>
<p>The weights of the communities (argument <code>w</code>) can be <code>"even"</code> (even weights, i.e. relative abundances
are considered for evolutionary units), <code>"evoab"</code> (proportional to the summed abundances of all evolutionary units, i.e. absolute abundances are considered for evolutionary units), or <code>"speciesab"</code> (proportional to the summed abundances of all species). Note that if the phylogenetic tree is ultrametric (the distance from any species to the root is constant), then options <code>"evoab"</code> and <code>"speciesab"</code> are equivalent.
</p>
<p>In <code>evopcahellinger</code>, as recommended by Rao (1995), the vector used to centre matrix <code class="reqn">(\sqrt{a_{jk}/a_{j+}})_{j,k}</code> in PCA can be defined as
</p>
<p style="text-align: center;"><code class="reqn">\left(\sum_{j=1}^m w_j \sqrt{a_{jk}/a_{j+}}\right)_k</code>
</p>
 
<p>(ordinary weighted mean, option <code>"centered"</code>) 
or as 
</p>
<p style="text-align: center;"><code class="reqn">\left(\sqrt{(\sum_{j=1}^m w_j a_{jk})/(\sum_{k=1}^K L_k \sum_{j=1}^m w_j a_{jk})}\right)_k</code>
</p>
 
<p>(option <code>"decentered"</code>); see Pavoine (2016) for an introduction of all ordination approaches.
</p>
<p>Similarly, in <code>evopcachord</code>, the vector used to centre matrix <code class="reqn">(a_{jk}/\sqrt{\sum_{k=1}^K a_{jk}^2})_{j,k}</code> can be defined as 
</p>
<p style="text-align: center;"><code class="reqn">\left(\sum_{j=1}^m w_j a_{jk}/\sqrt{\sum_{k=1}^K a_{jk}^2}\right)_k</code>
</p>
 
<p>(ordinary weighted mean, option <code>"centered"</code>) 
or as 
</p>
<p style="text-align: center;"><code class="reqn">\left((\sum_{j=1}^m w_j a_{jk})/\sqrt{\sum_{k=1}^K L_k (\sum_{j=1}^m w_j a_{jk})^2}\right)_k</code>
</p>
 
<p>(option <code>"decentered"</code>).
</p>


<h3>Value</h3>

<p><code>evopcachord</code> and <code>evopcahellinger</code> both return an object of class <code>evopca</code> and of class <code>dudi</code> (see package ade4). Graphical tools are associated with class <code>dudi</code> in packages ade4 and adegraphics (see section &quot;Examples&quot; below).
</p>
<p>The returned object contains the following components:
</p>
<table role = "presentation">
<tr><td><code>tab</code></td>
<td>
<p>a data frame with n rows and p columns, with communities as rows and nodes of the phylogeny as columns. Internal data frame used by the algorithm;</p>
</td></tr>
<tr><td><code>cw</code></td>
<td>
<p>weights attributed to the nodes of the phylogeny, a vector with p components;</p>
</td></tr>
<tr><td><code>lw</code></td>
<td>
<p>weights attributed to the communities, a vector with n components;</p>
</td></tr>
<tr><td><code>eig</code></td>
<td>
<p>vector of eigenvalues;</p>
</td></tr>
<tr><td><code>rank</code></td>
<td>
<p>integer, number of axes;</p>
</td></tr>
<tr><td><code>nf</code></td>
<td>
<p>integer, number of kept axes;</p>
</td></tr>
<tr><td><code>c1</code></td>
<td>
<p>normed scores for the nodes of the phylogeny, data frame with p rows and nf columns;</p>
</td></tr>
<tr><td><code>l1</code></td>
<td>
<p>normed scores for the communities, data frame with n rows and nf columns;</p>
</td></tr>
<tr><td><code>co</code></td>
<td>
<p>scores for the nodes of the phylogeny, data frame with p rows and nf columns;</p>
</td></tr>
<tr><td><code>li</code></td>
<td>
<p>scores for the communities, data frame with n rows and nf columns;</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the original call.</p>
</td></tr>
</table>
<p>If X is an object of class <code>evopca</code>, then <code>attributes(X)$phy</code> contains the phylogenetic tree (of class <code>phylo</code>) with names for internal nodes. 
</p>


<h3>Author(s)</h3>

<p>Sandrine Pavoine <a href="mailto:sandrine.pavoine@mnhn.fr">sandrine.pavoine@mnhn.fr</a>
</p>


<h3>References</h3>

<p>Pavoine, S. (2016) A guide through a family of phylogenetic dissimilarity measures among sites. <em>Oikos</em>, <b>125</b>, 1719&ndash;1732.
</p>
<p>Rao, C.R. (1995) A review of canonical coordinates and an alternative to correspondence analysis using Hellinger distance.
<em>Questiio</em>, <b>19</b>, 23&ndash;63. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+evoCA">evoCA</a></code>, <code><a href="#topic+evoNSCA">evoNSCA</a></code>, <code><a href="#topic+evodiss">evodiss</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
if(require(ade4) &amp;&amp; require(ape) &amp;&amp; require(adegraphics)){
O &lt;- adegpar()$plabels$optim
adegpar("plabels.optim" = TRUE)

data(batcomm)
ab &lt;- batcomm$ab
phy &lt;- read.tree(text=batcomm$tre)
plot(phy, show.node=TRUE)

evopcaHbat &lt;- evopcahellinger(phy, ab, scan=FALSE, nf=3)
dist(evopcaHbat$li)
evodiss(phy, ab, "Hellinger")

evopcaHbat$eig/sum(evopcaHbat$eig)
s.label(evopcaHbat$li)
s.label(evopcaHbat$co)
s.arrow(evopcaHbat$co)
inertia.dudi(evopcaHbat, row=TRUE)$row.abs
inertia.dudi(evopcaHbat, col=TRUE)$col.abs

evopcaCbat &lt;- evopcachord(phy, ab, scan=FALSE, nf=3)
dist(evopcaCbat$li)
evodiss(phy, ab, "Chord")

evopcaCbat$eig/sum(evopcaCbat$eig)
s.label(evopcaCbat$li)
s.label(evopcaCbat$co)
s.arrow(evopcaCbat$co)
inertia.dudi(evopcaCbat, row=TRUE)$row.abs
inertia.dudi(evopcaCbat, col=TRUE)$col.abs

adegpar("plabels.optim" = O)
}

## End(Not run)
</code></pre>

<hr>
<h2 id='evouniparam'>
Parametric Indices of Phylogenetic Uniqueness
</h2><span id='topic+evouniparam'></span><span id='topic+plot.evouniparam'></span>

<h3>Description</h3>

<p>Function <code>evouniparam</code> calculates phylogenetic uniqueness in communities using parametric indices derived from Tsallis and Hill compositional indices. <code>evouniparam</code> can also be applied to functional trees rather than phylogenies, to calculate a functional uniqueness.
The function <code>plot.evouniparam</code> plots the results of function <code>evouniparam</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evouniparam(phyl, comm, 
    method = c("hill", "tsallis", "renyi"), 
    q = 2, tol = 1e-08)

## S3 method for class 'evouniparam'
plot(x, legend = TRUE, 
    legendposi = "topright", 
    axisLABEL = "Tree-based uniqueness",
    type="b", col = if(is.numeric(x)) NULL 
    else sample(colors(distinct = TRUE), nrow(x$uni)), 
    lty = if(is.numeric(x)) NULL else rep(1, nrow(x$uni)), 
    pch = if(is.numeric(x)) NULL else rep(19, nrow(x$uni)), 
    ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="evouniparam_+3A_phyl">phyl</code></td>
<td>
<p>an object inheriting the class <code>phylo</code> (see package ape), <code>phylo4</code> (see package phylobase), or <code>hclust</code>.</p>
</td></tr>
<tr><td><code id="evouniparam_+3A_comm">comm</code></td>
<td>
<p>a data frame or a matrix typically with communities as rows, species as columns and abundance as entry. Species should be labeled as in the phylogenetic tree where they are the tips.</p>
</td></tr>
<tr><td><code id="evouniparam_+3A_method">method</code></td>
<td>
<p>a string: either &quot;hill&quot; for the Hill numbers (Hill 1973), &quot;tsallis&quot; for the Tsallis or HCDT entropy (Harvda and Charvat 1967; Daroczy 1970; Tsallis 1988), or &quot;renyi&quot; for Renyi's entropy (Renyi 1960). If several values are given, only the first one is considered. See details.</p>
</td></tr>
<tr><td><code id="evouniparam_+3A_q">q</code></td>
<td>
<p>a vector with nonnegative value(s) for parameter <code>q</code>. See details.</p>
</td></tr>
<tr><td><code id="evouniparam_+3A_tol">tol</code></td>
<td>
<p>numeric tolerance threshold: values between -<code>tol</code> and <code>tol</code> are considered equal to zero.</p>
</td></tr>
<tr><td><code id="evouniparam_+3A_x">x</code></td>
<td>
<p>an object of class <code>evouniparam</code> obtained with function <code>evouniparam</code>.</p>
</td></tr>
<tr><td><code id="evouniparam_+3A_legend">legend</code></td>
<td>
<p>a logical. If TRUE a legend is given with the colour, the type of line (etc.) used to define the uniqueness curve of each community.</p>
</td></tr>
<tr><td><code id="evouniparam_+3A_legendposi">legendposi</code></td>
<td>
<p>a string that gives the position of the legend to be passed to function <code>legend</code> of the base of R.</p>
</td></tr>
<tr><td><code id="evouniparam_+3A_axislabel">axisLABEL</code></td>
<td>

<p>a string to display on the main axis of the plot to designate what we are measuring. The default is <code>"Tree-based uniqueness"</code>.</p>
</td></tr> 
<tr><td><code id="evouniparam_+3A_type">type</code></td>
<td>
<p>a string to be passed to the graphic argument <code>type</code> of functions <code>plot</code> and <code>lines</code> used to draw the uniqueness curve of each community.</p>
</td></tr>
<tr><td><code id="evouniparam_+3A_col">col</code></td>
<td>
<p>vector of colours to be passed to the graphic argument <code>col</code> of functions <code>plot</code> and <code>lines</code> to define the colour of the uniqueness curve of each community.</p>
</td></tr>
<tr><td><code id="evouniparam_+3A_lty">lty</code></td>
<td>
<p>vector of type of line (plain, broken etc.) to be passed to the graphic argument <code>lty</code> of functions <code>plot</code> and <code>lines</code> used to draw the uniqueness curve of each community.</p>
</td></tr>
<tr><td><code id="evouniparam_+3A_pch">pch</code></td>
<td>
<p>type of point (open circle, close circle, square etc.) to be passed to the graphic argument <code>pch</code> of functions <code>plot</code> and <code>lines</code> used to draw the uniqueness level of each community.</p>
</td></tr>
<tr><td><code id="evouniparam_+3A_...">...</code></td>
<td>
<p>other arguments can be added and passed to the functions <code>plot</code> and <code>lines</code> used to draw the graphic.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function <code>evouniparam</code> calculates feature uniqueness (features = branch units on a phylogenetic [or functional] tree) using parametric indices qfuniHCDT (with <code>method=tsallis</code>), qfuniHill (with <code>method=hill</code>), qfuniRenyi (with <code>method=renyi</code>) developed in Pavoine and Ricotta (2019). Note that Pavoine and Ricotta (2019) recommend the use of index qfuniHill (with <code>method=hill</code>). 
</p>


<h3>Value</h3>

<p>If only one value of <code>q</code> is given, the function <code>evouniparam</code>  returns a vector with the phylogenetic uniqueness of each community.
If more than one value of <code>q</code> is given, a list of two objects is returned: 
</p>
<table role = "presentation">
<tr><td><code>q</code></td>
<td>
<p>the vector of values for <code>q</code>;</p>
</td></tr>
<tr><td><code>uni</code></td>
<td>
<p>a data frame with the phylogenetic uniqueness in each community calculated for all values of <code>q</code>.</p>
</td></tr>
</table>
<p>The function <code>plot.evouniparam</code> returns a graphic.
</p>


<h3>Author(s)</h3>

<p>Sandrine Pavoine <a href="mailto:sandrine.pavoine@mnhn.fr">sandrine.pavoine@mnhn.fr</a>
</p>


<h3>References</h3>

<p>The methodologies and scripts were developed by
</p>
<p>Pavoine, S., Ricotta, C. (2019) A simple translation from indices of species diversity to indices of phylogenetic diversity. <em>Ecological Indicators</em>, <b>101</b>, 552&ndash;561.
</p>
<p>using earlier work by:
</p>
<p>Chao, A., Chiu, C.-H., Jost, L. (2010) Phylogenetic diversity measures based on Hill numbers. <em>Philosophical Transactions of the Royal Society London Series B</em>, <b>365</b>, 3599&ndash;3609.
</p>
<p>Daroczy, Z. (1970) Generalized information functions. <em>Information and Control</em>, <b>16</b>, 36&ndash;51.
</p>
<p>Havrda, M., Charvat F. (1967) Quantification method of classification processes: concept of structural alpha-
entropy. <em>Kybernetik</em>, <b>3</b>, 30&ndash;35.
</p>
<p>Hill, M.O. (1973) Diversity and evenness: a unifying notation and its consequences. <em>Ecology</em>, <b>54</b>, 427&ndash;432.
</p>
<p>Pavoine, S. (2016) A guide through a family of phylogenetic dissimilarity measures among sites. <em>Oikos</em>, <b>125</b>, 1719&ndash;1732. 
</p>
<p>Renyi, A. (1960) On measures of entropy and information. <em>Proceedings of the Fourth Berkeley Symposium on Mathematical Statistics and Probability</em>, <b>1</b>, 547&ndash;561.
</p>
<p>Tsallis, C. (1988) Possible generalization of Boltzmann-Gibbs statistics. <em>Journal of Statistical Physics</em>, <b>52</b>, 480&ndash;487.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+evodivparam">evodivparam</a></code>, <code><a href="#topic+evoeveparam">evoeveparam</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
if(require(ape)){

data(batcomm)
phy &lt;- read.tree(text=batcomm$tre)
ab &lt;- batcomm$ab[, phy$tip.label]
plot(evouniparam(phy, ab))
plot(evouniparam(phy, ab, q=seq(0, 10, length=20)))

}

## End(Not run)
</code></pre>

<hr>
<h2 id='FPdivparam'>
Parametric Indices of Functional and Phylogenetic Diversity
</h2><span id='topic+FPdivparam'></span><span id='topic+plot.FPdivparam'></span>

<h3>Description</h3>

<p>Function <code>FPivparam</code> calculates functional or phylogenetic (FP-)diversity in communities using parametric indices <code class="reqn">^{\alpha}K</code>, <code class="reqn">^{\alpha}K*</code>, <code class="reqn">^{\alpha}Y</code> and <code class="reqn">^{\alpha}I</code> discussed and developed in Pavoine and Ricotta (2021). 
The function <code>plot.FPdivparam</code> plots the results of function <code>FPdivparam</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FPdivparam(comm, disORtree, method = c("KY", "KstarI"), palpha = 2, 
    equivalent = FALSE, option = c("asymmetric", "symmetric"), 
    dmax = NULL, tol = 1e-8)

## S3 method for class 'FPdivparam'
plot(x, legend = TRUE, 
    legendposi = "topright", axisLABEL = "FP-diversity", 
    type="b", col = if(is.numeric(x)) NULL 
    else sample(colors(distinct = TRUE), nrow(x$div)), 
    lty = if(is.numeric(x)) NULL else rep(1, nrow(x$div)), 
    pch = if(is.numeric(x)) NULL else rep(19, nrow(x$div)), 
    ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FPdivparam_+3A_comm">comm</code></td>
<td>
<p>a data frame or a matrix typically with communities as rows, species as columns and abundance as entry. Species should be labelled as in object disORtree.</p>
</td></tr>
<tr><td><code id="FPdivparam_+3A_disortree">disORtree</code></td>
<td>
<p>an object inheriting the class <code>dist</code>, giving the FP-dissimilarities between species, or inheriting the class <code>phylo</code> (see package ape), <code>phylo4</code> (see package phylobase), or <code>hclust</code>, where species are tips.</p>
</td></tr>
<tr><td><code id="FPdivparam_+3A_method">method</code></td>
<td>
<p>a string either <code>"KY"</code> for index <code class="reqn">^{\alpha}K</code> (if <code>disORtree</code> is of class <code>dist</code>) or <code class="reqn">^{\alpha}Y</code> if <code>disORtree</code> is of class <code>phylo</code>, <code>phylo4</code> or <code>hclust</code>; or <code>"KstarI"</code> for index <code class="reqn">^{\alpha}K*</code> (if <code>disORtree</code> is of class <code>dist</code>) or <code class="reqn">^{\alpha}I</code> if <code>disORtree</code> is of class <code>phylo</code>, <code>phylo4</code> or <code>hclust</code>. If several values are given, only the first one is considered.</p>
</td></tr>
<tr><td><code id="FPdivparam_+3A_palpha">palpha</code></td>
<td>
<p>a vector with nonnegative value(s) for parameter <code class="reqn">\alpha</code>.</p>
</td></tr>
<tr><td><code id="FPdivparam_+3A_equivalent">equivalent</code></td>
<td>
<p>a logical. If TRUE, the diversity values are calculated in terms of equivalent number of species (see Pavoine and Ricotta, 2021).</p>
</td></tr>
<tr><td><code id="FPdivparam_+3A_option">option</code></td>
<td>
<p>a string either <code>"asymmetric"</code> or <code>"symmetric"</code>. The parameter <code>option</code> is only used if <code>disORtree</code> is of class <code>phylo</code>, <code>phylo4</code> or <code>hclust</code> If <code>option="symmetric"</code>, the distance between two tips on a tree is defined as half the sum of branch length on the smallest path that connects the two species; while if <code>option="asymmetric"</code> the distance between a tip <em>i</em> and a tip <em>j</em> on a tree is defined as the sum of branch lengths between tip <em>i</em> and its most recent ancestor with tip <em>j</em>. If the tree is ultrametric, the two options are equivalent.</p>
</td></tr>
<tr><td><code id="FPdivparam_+3A_dmax">dmax</code></td>
<td>
<p>a nonnegative numeric indicating the maximum possible dissimilarity between two species. <code>dmax</code> must be higher than or equal to the maximum observed dissimilarity between two species.</p>
</td></tr>
<tr><td><code id="FPdivparam_+3A_tol">tol</code></td>
<td>
<p>a numeric tolerance threshold: values between -<code>tol</code> and <code>tol</code> are considered equal to zero.</p>
</td></tr>
<tr><td><code id="FPdivparam_+3A_x">x</code></td>
<td>
<p>an object of class <code>FPdivparam</code> obtained with function <code>FPdivparam</code>.</p>
</td></tr>
<tr><td><code id="FPdivparam_+3A_legend">legend</code></td>
<td>
<p>a logical. If TRUE a legend is given with the colour, the type of line (etc.) used to define the diversity curve of each community.</p>
</td></tr>
<tr><td><code id="FPdivparam_+3A_legendposi">legendposi</code></td>
<td>
<p>a string that gives the position of the legend to be passed to function <code>legend</code> of the base of R.</p>
</td></tr>
<tr><td><code id="FPdivparam_+3A_axislabel">axisLABEL</code></td>
<td>
<p>a string to display on the main axis of the plot to designate what we are measuring. The default is <code>"FP-diversity"</code>.</p>
</td></tr> 
<tr><td><code id="FPdivparam_+3A_type">type</code></td>
<td>
<p>a string to be passed to the graphic argument <code>type</code> of functions <code>plot</code> and <code>lines</code> used to draw the diversity curve of each community.</p>
</td></tr>
<tr><td><code id="FPdivparam_+3A_col">col</code></td>
<td>
<p>vector of colours to be passed to the graphic argument <code>col</code> of functions <code>plot</code> and <code>lines</code> to define the colour of the diversity curve of each community.</p>
</td></tr>
<tr><td><code id="FPdivparam_+3A_lty">lty</code></td>
<td>
<p>vector of type of line (plain, broken etc.) to be passed to the graphic argument <code>lty</code> of functions <code>plot</code> and <code>lines</code> used to draw the diversity curve of each community.</p>
</td></tr>
<tr><td><code id="FPdivparam_+3A_pch">pch</code></td>
<td>
<p>type of point (open circle, close circle, square etc.) to be passed to the graphic argument <code>pch</code> of functions <code>plot</code> and <code>lines</code> used to draw the diversity level of each community.</p>
</td></tr>
<tr><td><code id="FPdivparam_+3A_...">...</code></td>
<td>
<p>other arguments can be added and passed to the functions <code>plot</code> and <code>lines</code> used to draw the graphic.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If only one value of <code>palpha</code> is given, function <code>FPdivparam</code> returns a vector with the phylogenetic diversity of each community.
If more than one value of <code>palpha</code> is given, a list of two objects is returned: 
</p>
<table role = "presentation">
<tr><td><code>palpha</code></td>
<td>
<p>the vector of values for <code>palpha</code>;</p>
</td></tr>
<tr><td><code>div</code></td>
<td>
<p>a data frame with the phylogenetic diversity of each community calculated for all values of <code>palpha</code>.</p>
</td></tr>
</table>
<p>The function <code>plot.FPdivparam</code> returns a graphic.
</p>


<h3>Author(s)</h3>

<p>Sandrine Pavoine <a href="mailto:sandrine.pavoine@mnhn.fr">sandrine.pavoine@mnhn.fr</a>
</p>


<h3>References</h3>

<p>The methodologies and scripts were developed by
</p>
<p>Pavoine, S., Ricotta, C. (2021) On the relationships between rarity, uniqueness, distinctiveness, originality and functional/phylogenetic diversity. <em>BiorXiv</em>. <a href="https://doi.org/10.1101/2021.08.09.455640">doi:10.1101/2021.08.09.455640</a>
</p>
<p>unifying and extending earlier work by:
</p>
<p>Pavoine, S., Love, M., Bonsall, M. (2009) Hierarchical partitioning of evolutionary and ecological patterns in the organization of phylogenetically-structured species assemblages: application to rockfish (genus: Sebastes) in the Southern California Bight. <em>Ecology Letters</em>, <b>12</b>, 898&ndash;908.
</p>
<p>and
</p>
<p>Ricotta, C., Szeidl, L. (2006) Towards a unifying approach to diversity measures: Bridging the gap between the Shannon entropy and Rao's quadratic index. <em>Theoretical Population Biology</em>, <b>70</b>, 237&ndash;243.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pIa">pIa</a></code>, <code><a href="#topic+evodivparam">evodivparam</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
if(require(ape)){

data(batcomm)
phy2 &lt;- read.tree(text=batcomm$tre2)
ab2 &lt;- batcomm$ab2[, phy2$tip.label]
plot(FPdivparam(ab2, phy2))
plot(FPdivparam(ab2, phy2, palpha=seq(0, 10, length=20)))

}

## End(Not run)
</code></pre>

<hr>
<h2 id='FunImbalance'>Indices of functional imbalance</h2><span id='topic+FunImbalance'></span>

<h3>Description</h3>

<p>The function <code>FunImbalance</code> calculates functional imbalance within species communities, as an indicator of the strength of interaction between
species abundances and their functional dissimilarities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FunImbalance(comm, dis, method = c("CorB", "SESB", "QB"), nrep = 10000, tol = 1e-16) 
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FunImbalance_+3A_comm">comm</code></td>
<td>
<p>matrix or data frame with communities as rows, species as columns and abundance data as entries.</p>
</td></tr>
<tr><td><code id="FunImbalance_+3A_dis">dis</code></td>
<td>
<p>an object of class dist that provides the functional dissimilarities between species.</p>
</td></tr>
<tr><td><code id="FunImbalance_+3A_method">method</code></td>
<td>
<p>a character string: one or a vector of &quot;CorB&quot;, &quot;SESB&quot;, and &quot;QB&quot;. The strings indicate the name of the index of functional imbalance that must be used.</p>
</td></tr>
<tr><td><code id="FunImbalance_+3A_nrep">nrep</code></td>
<td>
<p>an integer. The number of repetitions (permutations) to use in the calculation of SESB and QB.</p>
</td></tr>
<tr><td><code id="FunImbalance_+3A_tol">tol</code></td>
<td>
<p>a tolerance number: a value in [-tol, tol] is considered as zero.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function <code>betaUniqueness</code> returns a data frame with communities as rows and the selected indices of functional imbalance as columns.
</p>


<h3>Author(s)</h3>

<p>Sandrine Pavoine <a href="mailto:sandrine.pavoine@mnhn.fr">sandrine.pavoine@mnhn.fr</a>
</p>


<h3>References</h3>

<p>Ricotta, C., Bacaro, G., Maccherini, S., Pavoine, S. (2022) Functional imbalance not functional evenness is the third component of community structure, <em>Contact author for information</em>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(RutorGlacier)
fundis &lt;- dist(scale(RutorGlacier$Traits2[1:6]))
fundis &lt;- fundis/max(fundis)
funImb &lt;- FunImbalance(RutorGlacier$Abund, fundis, method = "CorB")
funImb
</code></pre>

<hr>
<h2 id='generalized_Tradidiss'>
Plot-to-plot dissimilarity taking account of functional dissimilarities between species
</h2><span id='topic+generalized_Tradidiss'></span>

<h3>Description</h3>

<p>Given a matrix of <em>S</em> species' relative or absolute abundance values in <em>N</em> plots, together with an <em>S</em> x <em>S</em> (functional) dissimilarity matrix, the function <code>generalized_Tradidiss</code> calculates a semimatrix with the values of a plot-to-plot dissimilarity index, as proposed in Pavoine and Ricotta (2019).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generalized_Tradidiss(comm, dis, method = c("GC", "MS", "PE"),
    abundance = c("relative", "absolute", "none"), 
    weights = c("uneven", "even"), tol = 1e-8)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="generalized_Tradidiss_+3A_comm">comm</code></td>
<td>

<p>a data frame typically with communities as rows, species as columns and an index of abundance as entries. Species must be labeled as in the object <code>dis</code>.
</p>
</td></tr>
<tr><td><code id="generalized_Tradidiss_+3A_dis">dis</code></td>
<td>

<p>an object of class <code>dist</code> or a matrix containing pair-wise (functional or phylogenetic) dissimilarities between species [obtained by functions like vegdist in package vegan (Oksanen et al. 2013), gowdis in package FD (Laliberte and Shipley 2011), or dist.ktab in package ade4 for functional dissimilarities (Dray et al. 2007), or functions like cophenetic.phylo in package ape (Paradis et al. 2004) or distTips in package adephylo (Jombart and Dray 2010) for phylogenetic dissimilarities]. If the dissimilarities are outside the range 0-1, a warning message is displayed and each dissimilarity is divided by the maximum over all pairwise dissimilarities.
</p>
</td></tr>
<tr><td><code id="generalized_Tradidiss_+3A_method">method</code></td>
<td>

<p>one of the following strings: <code>"GC"</code>, <code>"MS"</code>, <code>"PE"</code>. See Details.
</p>
</td></tr>
<tr><td><code id="generalized_Tradidiss_+3A_abundance">abundance</code></td>
<td>

<p>a string with three possible values: &quot;relative&quot; for the use of relative species abundance, &quot;absolute&quot; for the use of absolute species abundance, and &quot;none&quot; for the use of presence/absence data (1/0). 
</p>
</td></tr>
<tr><td><code id="generalized_Tradidiss_+3A_weights">weights</code></td>
<td>

<p>a string. Two types of weights are available in the function: <code>"uneven"</code> (Eq. 5 in Pavoine and Ricotta (2009)) or <code>"even"</code> (1/S, where S is the number of species in the two compared plots).</p>
</td></tr>
<tr><td><code id="generalized_Tradidiss_+3A_tol">tol</code></td>
<td>

<p>numeric tolerance threshold: values between -<code>tol</code> and <code>tol</code> are considered equal to zero.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The plot-to-plot dissimilarity coefficients used in this function are as follows:
<code>"GC"</code>: Equation 6 in Pavoine and Ricotta (2019)
<code>"MS"</code>: Equation 8 in Pavoine and Ricotta (2019)
<code>"PE"</code>: Equations 9 and 10 in Pavoine and Ricotta (2019)
</p>


<h3>Value</h3>

<p>The function returns an object of class <code>"dist"</code> with the values of the proposed dissimilarities for each pair of plots. 
</p>


<h3>Author(s)</h3>

<p>Sandrine Pavoine <a href="mailto:sandrine.pavoine@mnhn.fr">sandrine.pavoine@mnhn.fr</a>
</p>


<h3>References</h3>

<p>Pavoine, S. and Ricotta, C. (2019) Measuring functional dissimilarity among plots: adapting old methods to new questions. <em>Ecological Indicators</em>, <b>97</b>, 67&ndash;72.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
if(require(ade4) &amp;&amp; require(adephylo) &amp;&amp; require(ape)){

data(birdData)
phy &lt;- read.tree(text=birdData$tre)
phydis &lt;- sqrt(distTips(phy, method="nNodes")+1)
fau &lt;- birdData$fau[1:6, phy$tip.label]
disGC &lt;- generalized_Tradidiss(fau, phydis, method="GC")
disGC

### The second example is a bit TIME CONSUMING
data(mafragh)
namspe &lt;- rownames(mafragh$traits[[1]])
M &lt;- mafragh$flo
colnames(M) &lt;- namspe
Bin &lt;- prep.binary(mafragh$traits$tabBinary, c(3, 4))
distraits &lt;- dist.ktab(ktab.list.df(list(mafragh$traits$tabOrdinal[,2:3], Bin)), 
    c("O","B"), scan=FALSE)
disGC &lt;- generalized_Tradidiss(M, distraits, method="GC")
pcoGC &lt;- dudi.pco(as.dist(cailliez(disGC)), full=TRUE)
s.value(mafragh$xy, pcoGC$li[,1])
}

## End(Not run)
</code></pre>

<hr>
<h2 id='K'>
Indices K, Kstar and Kw of Phylogenetic Signal
</h2><span id='topic+K'></span><span id='topic+Kstar'></span><span id='topic+Kw'></span>

<h3>Description</h3>

<p>The functions <code>K</code>, <code>Kstar</code> and <code>Kw</code> calculate Blomberg et al. (2003) statistics <em>K</em>, and <em>K*</em> and Pavoine and Ricotta (2013) statistic <code class="reqn">K_w</code>, respectively. Then they perform a permutation test where species identities are maintained in the phylogeny while the trait values of species are randomly shuffled (permuted) (Pavoine and Ricotta 2013).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>K(phyl, trait, nrep = 999, alter = c("greater", "less", "two-sided"))

Kstar(phyl, trait, nrep = 999, alter = c("greater", "less", "two-sided"))

Kw(phyl, trait, nrep = 999, alter = c("greater", "less", "two-sided"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="K_+3A_phyl">phyl</code></td>
<td>

<p>an object inheriting the class <code>phylo</code> (see package ape), <code>phylo4</code> (see package phylobase) or <code>hclust</code>.
</p>
</td></tr>
<tr><td><code id="K_+3A_trait">trait</code></td>
<td>

<p>a vector with the trait value for each species (tip) in the phylogenetic tree. Trait values for species must be in the same order as species in the phylogenetic tree.
</p>
</td></tr>
<tr><td><code id="K_+3A_nrep">nrep</code></td>
<td>

<p>a numeric: the number of randomizations.
</p>
</td></tr>
<tr><td><code id="K_+3A_alter">alter</code></td>
<td>

<p>a string specifying the alternative hypothesis; it must be one of <code>"greater"</code> (phylogenetic signal; the default), <code>"less"</code> or <code>"two-sided"</code>. If several values are given, only the first one is retained.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Blomberg et al. (2003) introduced two statistics of phylogenetic signal:
</p>
<p style="text-align: center;"><code class="reqn">K = MSE0 / MSE</code>
</p>

<p style="text-align: center;"><code class="reqn">K^* = MSE^* / MSE</code>
</p>

<p>where <em>MSE</em> is the mean squared error of the trait values calculated using the variance-covariance matrix derived from the phylogenetic tree, <em>MSE0</em> is the mean squared error of the tip trait values, measured from a phylogenetically correct mean of tip trait values and <em>MSE*</em> is the mean squared error of the tip trait values, measured from the estimate of the mean of the raw tip trait values. In both statistics <em>K</em> and <em>K*</em>, the value of <em>MSE</em> will be relatively small if the phylogenetic tree accurately describes the variance-covariance pattern observed in the data, leading to high values for <em>K</em> and <em>K*</em> (meaning high phylogenetic signal). In functions <code>K</code> and <code>Kstar</code>, <em>K</em> and <em>K*</em>, respectively, are divided (normalized) by their expected value if the trait evolved under a Brownian motion along the branches of the phylogenetic tree (this expected value is invariant under permutation of trait values among the tips of the phylogeny).
</p>
<p>To test for phylogenetic signal, Blomberg et al. (2003) actually considered neither <em>K</em> nor <em>K*</em> but <em>MSE</em> as the core statistic associated with random permutations of trait values among tips of the phylogenetic tree. Although the literature on phylogenetic signal has currently mostly ignored <em>K*</em> focusing on statistic <em>K</em>, <em>K*</em> could thus actually have been considered as the core statistic of Blomberg et al. (2003) test for phylogenetic signal. Indeed, as <em>MSE*</em> is independent of permutations of trait values among the tips of the phylogeny while <em>MSE0</em> is, Blomberg et al. (2003) approach corresponds to considering <em>K*</em> and not <em>K</em> as the statistic of the test of phylogenetic signal in traits. This test is also equivalent to an alternative implemented via phylogenetically independent contrasts also proposed by Blomberg et al. (2003).
</p>
<p>Function <code>KW</code> implements index <code class="reqn">K_w</code>, a modified version of <em>K*</em> that grants a higher importance in the calculation of phylogenetic signal to the tips that have many closely related tips (Pavoine and Ricotta 2013).
</p>
<p>In functions, <code>K</code>, <code>Kstar</code> and <code>Kw</code>, I considered the same permutation scheme as in Blomberg et al. (2003) but used <em>K</em>, <em>K*</em> and <code class="reqn">K_w</code>, as the core statistic, respectively. The test developed by Blomberg et al. (2003) thus corresponds to function <code>Kstar</code>.
</p>


<h3>Value</h3>

<p>Each function returns an object of class <code>randtest</code> with the results of the permutation tests. (see function <code>randtest</code> in package ade4)
</p>


<h3>Author(s)</h3>

<p>Sandrine Pavoine <a href="mailto:sandrine.pavoine@mnhn.fr">sandrine.pavoine@mnhn.fr</a>
</p>


<h3>References</h3>

<p>Blomberg, S.P., Garland, T., Ives, A.R. (2003) Testing for phylogenetic signal in comparative data: behavioral traits are more labile. <em>Evolution</em>, <b>57</b>, 717&ndash;745.
</p>
<p>Pavoine, S., Ricotta, C. (2013) Testing for phylogenetic signal in biological traits: the ubiquity of cross-product statistics. <em>Evolution</em>, <b>67</b>, 828&ndash;840.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Kstar">Kstar</a></code>, <code><a href="#topic+Kw">Kw</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
if(require(ape) &amp;&amp; require(ade4)){

data(rockfish)
phy &lt;- read.tree(text=rockfish$tre)

theK &lt;- K(phy, rockfish$traits[phy$tip.label, 1])
theK
plot(theK)

theKstar &lt;- Kstar(phy, rockfish$traits[phy$tip.label, 1])
theKstar
plot(theKstar)

theKw &lt;- Kw(phy, rockfish$traits[phy$tip.label, 1])
theKw
plot(theKw)

}

## End(Not run)
</code></pre>

<hr>
<h2 id='optimEH'>
Nee and May's Optimizing Process 
</h2><span id='topic+optimEH'></span>

<h3>Description</h3>

<p>The function <code>optimEH</code> performs Nee and May's optimizing scheme. When branch lengths in an ultrametric phylogenetic tree are expressed as divergence times, the total sum of branch lengths in that tree expresses the amount of evolutionary history. Nee and May's algorithm optimizes the amount of evolutionary history preserved if only <em>k</em> species out of <em>n</em> were to be saved. The <em>k</em>-1 closest-to-root nodes are selected, which defines <em>k</em> clades; one species from each clade is picked. At this last step, we decide to select the most original species of each of the <em>k</em> clades. </p>


<h3>Usage</h3>

<pre><code class='language-R'>optimEH(phyl, nbofsp, tol = 1e-08, give.list = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="optimEH_+3A_phyl">phyl</code></td>
<td>

<p>an object inheriting the class <code>phylo</code> (see package ape), <code>phylo4</code> (see package phylobase) or <code>hclust</code>.
</p>
</td></tr>
<tr><td><code id="optimEH_+3A_nbofsp">nbofsp</code></td>
<td>

<p>an integer indicating the number of species saved (<em>k</em>).
</p>
</td></tr>
<tr><td><code id="optimEH_+3A_tol">tol</code></td>
<td>

<p>a tolerance threshold for null values (a value less than <code>tol</code> in absolute terms is considered as zero). </p>
</td></tr>
<tr><td><code id="optimEH_+3A_give.list">give.list</code></td>
<td>

<p>a logical indicating whether a list of optimizing species should be provided. If <code>give.list = TRUE</code>, <code>optimEH</code> provides the list of the <em>k</em> species that optimize the amount of evolutionary history preserved and are the most original species in their clades. If <code>give.list = FALSE</code>, <code>optimEH</code> returns directly the real value giving the amount of evolutionary history preserved.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>give.list=FALSE</code>, function <code>optimEH</code> returns a numeric.
</p>
<p>If <code>give.list=TRUE</code>, function <code>optimEH</code> returns a list containing:
</p>
<table role = "presentation">
<tr><td><code>value</code></td>
<td>
<p>a real value providing the amount of evolutionary history preserved;</p>
</td></tr>
<tr><td><code>selected.sp</code></td>
<td>
<p>a data frame containing the list of the k species which optimize the amount of evolutionary history preserved and are the most original species in their clades.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sandrine Pavoine <a href="mailto:sandrine.pavoine@mnhn.fr">sandrine.pavoine@mnhn.fr</a>
with contributions of Stephane Dray
</p>


<h3>References</h3>

<p>Pavoine, S., Ollier, S. and Dufour, A.-B. (2005) Is the originality of a species measurable? <em>Ecology Letters</em>, <b>8</b>, 579&ndash;586. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+randEH">randEH</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
if(require(ape) &amp;&amp; require(adephylo)){

data(carni70, package="adephylo")
tre &lt;- read.tree(text=carni70$tre)
adiv:::EH(tre)
adiv:::optimEH(tre, 10)

}

## End(Not run)
</code></pre>

<hr>
<h2 id='orisaved'>
Maximal or Minimal Amount of Originality Saved under Optimal Conditions
</h2><span id='topic+orisaved'></span>

<h3>Description</h3>

<p>Function <code>orisaved</code> computes the maximal or minimal amount of originality saved over all combinations of species optimizing the amount of evolutionary history preserved. The originality of a species is measured with the QE-based index (Pavoine et al. 2005).</p>


<h3>Usage</h3>

<pre><code class='language-R'>orisaved(phyl, rate = 0.1, method = 1:2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="orisaved_+3A_phyl">phyl</code></td>
<td>

<p>an object inheriting the class <code>phylo</code> (see package ape), <code>phylo4</code> (see package phylobase) or <code>hclust</code>.
</p>
</td></tr>
<tr><td><code id="orisaved_+3A_rate">rate</code></td>
<td>

<p>a real value (between 0 and 1) indicating how many species will be saved for each calculation. For example, if the total number of species is 70 and 'rate = 0.1' then the calculations will be done at a rate of 10% i.e. for 0 (= 0 %), 7 (= 10 %), 14 (= 20 %), 21 (= 30 %), ..., 63 (= 90 %) and 70(= 100 %) species saved. If 'rate = 0.5' then the calculations will be done for only 0 (= 0 %), 35 (= 50 %) and 70(= 100 %) species saved.
</p>
</td></tr>
<tr><td><code id="orisaved_+3A_method">method</code></td>
<td>

<p>an integer either 1 or 2 (see details).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>1 = maximum amount of originality saved 2 = minimum amount of originality saved
</p>


<h3>Value</h3>

<p>Returns a numeric vector. 
</p>


<h3>Author(s)</h3>

<p>Sandrine Pavoine <a href="mailto:sandrine.pavoine@mnhn.fr">sandrine.pavoine@mnhn.fr</a>
with contributions of Stephane Dray
</p>


<h3>References</h3>

<p>Pavoine, S., Ollier, S. and Dufour, A.-B. (2005) Is the originality of a species measurable? <em>Ecology Letters</em>, <b>8</b>, 579&ndash;586. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+optimEH">optimEH</a></code>, <code><a href="#topic+randEH">randEH</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
if(require(ape) &amp;&amp; require(adephylo)){

data(carni70, package="adephylo")
tre &lt;- read.tree(text=carni70$tre)
tmax &lt;- adiv:::orisaved(tre, rate = 1 / 70, method = 1) 
tmin &lt;- adiv:::orisaved(tre, rate = 1 / 70, method = 2) 
plot(c(0, 1:70), tmax, xlab = "nb of species saved", ylab = "Originality saved", type = "l") 
lines(c(0, 1:70), tmin, lty = 2) 

}

## End(Not run)
</code></pre>

<hr>
<h2 id='PADDis'>
Functional Dissimilarity Measures for Presence-Absence Data</h2><span id='topic+PADDis'></span><span id='topic+DJac'></span><span id='topic+Jac'></span>

<h3>Description</h3>

<p>Functions <code>PADDis</code>, <code>DJac</code> and <code>Jac</code> calculate the dissimilarity coefficients introduced in Ricotta et al. (2016). These dissimilarity coefficients use traditional mismatching components a, b and c of the 2 x 2 contingency table expressed as to include functional or phylogenetic differences among species and noted A, B, C. Components B and C represent the functional or phylogenetic uniqueness of community X compared with community Y and vice versa. Component A represents the functional or phylogenetic similarities between communities X and Y.</p>


<h3>Usage</h3>

<pre><code class='language-R'>PADDis(comm, dis, method = NULL, diag = FALSE, upper = FALSE)

DJac(comm, dis, diag = FALSE, upper = FALSE)

Jac(comm, diag = FALSE, upper = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PADDis_+3A_comm">comm</code></td>
<td>

<p>a matrix or a data frame with communities (or plots, assemblages, etc.) as rows and species as columns containing the incidence (0/1) of all species in the communities.</p>
</td></tr>
<tr><td><code id="PADDis_+3A_dis">dis</code></td>
<td>

<p>an object of class <code>dist</code> containing the (functional) dissimilarities among species.</p>
</td></tr>
<tr><td><code id="PADDis_+3A_method">method</code></td>
<td>

<p>an integer between 0 and 6. If <code>NULL</code> the choice is made with a console message. See details.</p>
</td></tr>
<tr><td><code id="PADDis_+3A_diag">diag</code></td>
<td>

<p>a logical value indicating whether the diagonal of the distance matrix should be printed by function <code>print.dist</code>.</p>
</td></tr>
<tr><td><code id="PADDis_+3A_upper">upper</code></td>
<td>

<p>a logical value indicating whether the upper triangle of the distance matrix should be printed by function <code>print.dist</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In <code>PADDIS</code>, dissimilarities among communities are calculated with the following formulas:
</p>
<p>Generalized Jaccard dissimilarity, with method = 1
</p>
<p style="text-align: center;"><code class="reqn">\frac{B+C}{a+b+c}</code>
</p>

<p>Generalized Sorensen dissimilarity, with method = 2
</p>
<p style="text-align: center;"><code class="reqn">\frac{B+C}{2a+b+c}</code>
</p>

<p>Generalized Sokal and Sneath dissimilarity, with method = 3
</p>
<p style="text-align: center;"><code class="reqn">\frac{2(B+C)}{a+2(b+c)}</code>
</p>

<p>Generalized Ochiai dissimilarity, with method = 4
</p>
<p style="text-align: center;"><code class="reqn">\frac{\sqrt{A+B}\sqrt{A+C}-A}{\sqrt{a+b}\sqrt{a+c}}</code>
</p>

<p>Generalized Simpson dissimilarity, with method = 5
</p>
<p style="text-align: center;"><code class="reqn">\frac{min\{B+C\}}{a+min\{b+c\}}</code>
</p>

<p>Generalized Kulczynski dissimilarity, with method = 6
</p>
<p style="text-align: center;"><code class="reqn">0.5*(\frac{B}{a+b}+\frac{C}{a+c})</code>
</p>

<p><code>DJac</code> and <code>Jac</code> use the additive decomposition of the Jaccard index into turnover and richness difference. <code>DJac</code> takes into account the (functional or phylogenetic) dissimilarities among species while <code>Jac</code> does not.
</p>


<h3>Value</h3>

<p>In function <code>PADDis</code>, if <code>method=0</code>, then the function <code>PADDis</code> returns 6 matrices corresponding to the a, b, c, A, B, and C values per pair of communities. Otherwise, it returns an object of class <code>dist</code> corresponding to the dissimilarities among communities.
</p>
<p>Functions <code>DJac</code> and <code>Jac</code> return a list of three objects of class <code>dist</code>:
</p>
<table role = "presentation">
<tr><td><code>J</code></td>
<td>
<p>for the full dissimilarities between communities;</p>
</td></tr>
<tr><td><code>JRepl</code></td>
<td>
<p>for the turnover component of the dissimilarities;</p>
</td></tr>
<tr><td><code>JRich</code></td>
<td>
<p>for the component of difference in richness.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sandrine Pavoine <a href="mailto:sandrine.pavoine@mnhn.fr">sandrine.pavoine@mnhn.fr</a>
</p>


<h3>References</h3>

<p>Ricotta, C., Podani, J., Pavoine, S. (2016) A family of functional dissimilarity measures for presence and absence data. <em>Ecology and Evolution</em>, <b>6</b>, 5383&ndash;5389</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(RPP16EE)
Com &lt;- RPP16EE$Com
Dis &lt;- as.dist(RPP16EE$Dis)
J &lt;- Jac(Com)
DJ &lt;- DJac(Com, Dis)

plot(c(as.matrix(DJ$J)[1,]), ylab="Dissimilarity", 
xlab="Plot-to-plot comparison", pch=15, type="b", 
ylim=c(0,1), main="Jaccard")

lines(c(as.matrix(J$J)[1,]), type="b", pch=18)

legend("bottomright", legend=c("P/A scores", "functional data"), 
pch=c(15,18), lty=1)

plot(c(as.matrix(DJ$JRepl)[1,]), ylab="Dissimilarity",
xlab="Plot-to-plot comparison", pch=15, type="b", 
ylim=c(0,1), main="Species replacement")

lines(c(as.matrix(J$JRepl)[1,]), type="b", pch=18)

legend("bottomright", legend=c("P/A scores", "functional data"), 
pch=c(15,18), lty=1)


#Use the following instruction to obtain all components:

PADDis(Com, Dis, method=0)
</code></pre>

<hr>
<h2 id='plot.phylo4d'>
Plots for phylogenetic tree and data
</h2><span id='topic+plot.phylo4d'></span><span id='topic+barp4d'></span><span id='topic+dotp4d'></span><span id='topic+gridp4d'></span>

<h3>Description</h3>

<p>Functions <code>barp4d</code>, <code>dotp4d</code> and <code>gridp4d</code> provide plots for phylo4d objects (i.e. phylogenetic tree and data). Function <code>plot.phylo4d</code> provides a general interface for all other functions. Function <code>barp4d</code> uses barplots of trait values along the phylogenetic tree. Function <code>dotp4d</code> uses dotplots of trait values along the phylogenetic tree, and function <code>gridp4d</code> gridplots. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'phylo4d'
plot(x, trait = names(tdata(p4d)), center = TRUE, 
    scale = TRUE, plot.type = "barplot", tree.ladderize = FALSE, 
    tree.type = "phylogram", tree.ratio = NULL, 
    tree.xlim = NULL, tree.open.angle = 0, 
    tree.open.crown = TRUE, show.tip = TRUE, tip.labels = NULL, 
    tip.col = "black", tip.cex = 1, tip.font = 3, tip.adj = 0, 
    data.xlim = NULL, bar.lwd = 10, bar.col = "grey35", 
    show.data.axis = TRUE, dot.col = "black", dot.pch = 20, 
    dot.cex = 2, cell.col = topo.colors(100), 
    show.color.scale = TRUE, show.trait = TRUE, 
    trait.labels = NULL, trait.col = "black", 
    trait.cex = 1, trait.font = 1, trait.bg.col = "grey90", 
    error.bar.sup = NULL, error.bar.inf = NULL, 
    error.bar.col = 1, show.box = FALSE, grid.vertical = TRUE,
    grid.horizontal = FALSE, grid.col = "grey25", 
    grid.lty = "dashed", ...) 

barp4d(height, trait = names(tdata(height)), 
    center = TRUE, scale = TRUE, tree.ladderize = FALSE, 
    tree.type = "phylogram", tree.ratio = NULL, 
    tree.xlim = NULL, tree.open.angle = 0, 
    tree.open.crown = TRUE, show.tip = TRUE, tip.labels = NULL, 
    tip.col = "black", tip.cex = 1, tip.font = 3, tip.adj = 0, 
    data.xlim = NULL, bar.lwd = 10, bar.col = "grey35", 
    show.data.axis = TRUE, show.trait = TRUE, 
    trait.labels = NULL, trait.col = "black", trait.cex = 1,
    trait.font = 1, trait.bg.col = "grey90", 
    error.bar.sup = NULL, error.bar.inf = NULL, 
    error.bar.col = 1, show.box = FALSE, grid.vertical = TRUE, 
    grid.horizontal = FALSE, grid.col = "grey25", 
    grid.lty = "dashed", ...) 

dotp4d(p4d, trait = names(tdata(p4d)), center = TRUE, 
    scale = TRUE, tree.ladderize = FALSE, 
    tree.type = "phylogram", tree.ratio = NULL, 
    tree.xlim = NULL, tree.open.angle = 0, 
    tree.open.crown = TRUE, show.tip = TRUE, tip.labels = NULL,
    tip.col = "black", tip.cex = 1, tip.font = 3, 
    tip.adj = 0, data.xlim = NULL, show.data.axis = TRUE, 
    dot.col = "black", dot.pch = 20, dot.cex = 2, 
    show.trait = TRUE, trait.labels = NULL, trait.col = "black", 
    trait.cex = 1, trait.font = 1, trait.bg.col = "grey90", 
    error.bar.sup = NULL, error.bar.inf = NULL, 
    error.bar.col = 1, show.box = FALSE, grid.vertical = FALSE,
    grid.horizontal = TRUE, grid.col = "grey25", 
    grid.lty = "dashed", ...) 

gridp4d(p4d, trait = names(tdata(p4d)), center = TRUE, 
    scale = TRUE, tree.ladderize = FALSE, 
    tree.type = "phylogram", tree.ratio = NULL, 
    tree.xlim = NULL, tree.open.angle = 0, 
    tree.open.crown = TRUE, show.tip = TRUE, tip.labels = NULL, 
    tip.col = "black", tip.cex = 1, tip.font = 3, tip.adj = 0,
    cell.col = topo.colors(100), show.color.scale = TRUE, 
    show.trait = TRUE, trait.labels = NULL, trait.col = "black", 
    trait.cex = 0.7, trait.font = 1, trait.bg.col = "grey90", 
    show.box = FALSE, grid.vertical = FALSE, 
    grid.horizontal = FALSE, grid.col = "grey25", 
    grid.lty = "dashed", ...) 

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.phylo4d_+3A_x">x</code>, <code id="plot.phylo4d_+3A_p4d">p4d</code>, <code id="plot.phylo4d_+3A_height">height</code></td>
<td>
<p>a <code>phylo4d</code> object.</p>
</td></tr>
<tr><td><code id="plot.phylo4d_+3A_trait">trait</code></td>
<td>
<p>the traits in the <code>phylo4d</code> object to include in the plot. Can be a character vector giving the name of the traits or numbers giving the column index in the table of the data slot of the <code>p4d</code> or <code>height</code> object. Can be used to reorder the traits in the plot.</p>
</td></tr>
<tr><td><code id="plot.phylo4d_+3A_center">center</code></td>
<td>
<p>a logical indicating whether traits values should be centered.</p>
</td></tr>
<tr><td><code id="plot.phylo4d_+3A_scale">scale</code></td>
<td>
<p>a logical indicating whether traits values should be scaled.</p>
</td></tr>
<tr><td><code id="plot.phylo4d_+3A_plot.type">plot.type</code></td>
<td>
<p>a character string specifying the type of plot for traits data. Can be <code>"barplot"</code>, <code>"dotplot"</code> or <code>"gridplot"</code>.</p>
</td></tr>
<tr><td><code id="plot.phylo4d_+3A_tree.ladderize">tree.ladderize</code></td>
<td>
<p>a logical indicating whether the tree should be (right) ladderized.</p>
</td></tr>
<tr><td><code id="plot.phylo4d_+3A_tree.type">tree.type</code></td>
<td>
<p>a character string specifying the type of phylogeny to be drawn. Can be <code>"phylogram"</code>, <code>"cladogram"</code> or <code>"fan"</code>.</p>
</td></tr>
<tr><td><code id="plot.phylo4d_+3A_tree.ratio">tree.ratio</code></td>
<td>
<p>a numeric value in [0, 1] giving the proportion of width of the figure for the tree.</p>
</td></tr>
<tr><td><code id="plot.phylo4d_+3A_tree.xlim">tree.xlim</code></td>
<td>
<p>a numeric vector of length 2 giving the limits of the x-axis for the tree. If NULL, it is determined automatically.</p>
</td></tr>
<tr><td><code id="plot.phylo4d_+3A_tree.open.angle">tree.open.angle</code></td>
<td>
<p>a numeric value giving the angle in degrees left blank if <code>tree.type = "fan"</code>.</p>
</td></tr>
<tr><td><code id="plot.phylo4d_+3A_tree.open.crown">tree.open.crown</code></td>
<td>
<p>a logical indicating whether the crowns should be drawn following the value of <code>tree.open.angle</code> (default <code>TRUE</code>).</p>
</td></tr>
<tr><td><code id="plot.phylo4d_+3A_show.tip">show.tip</code></td>
<td>
<p>logical indicating whether tips labels should be drawn.</p>
</td></tr>
<tr><td><code id="plot.phylo4d_+3A_tip.labels">tip.labels</code></td>
<td>
<p>character vector to label the tips. If <code>NULL</code> the tips labels of the <code>phylo4d</code> object are used.</p>
</td></tr>
<tr><td><code id="plot.phylo4d_+3A_tip.col">tip.col</code></td>
<td>
<p>a vector of R colors to use for the tips labels. Recycled if necessary.</p>
</td></tr>
<tr><td><code id="plot.phylo4d_+3A_tip.cex">tip.cex</code></td>
<td>
<p>a numeric vector to control character size of the tips labels. Recycled if necessary.</p>
</td></tr>
<tr><td><code id="plot.phylo4d_+3A_tip.font">tip.font</code></td>
<td>
<p>an integer vector specifying the type of font for the tips labels: 1 (plain text), 2 (bold), 3 (italic), or 4 (bold italic). Recycled if necessary.</p>
</td></tr>
<tr><td><code id="plot.phylo4d_+3A_tip.adj">tip.adj</code></td>
<td>
<p>a vector of numeric in [0, 1] to control tips labels justification: 0 (left-justification), 0.5 (centering), or 1 (right-justification). Recycled if necessary.</p>
</td></tr>
<tr><td><code id="plot.phylo4d_+3A_data.xlim">data.xlim</code></td>
<td>
<p>numeric vector of length 2 or matrix giving the x coordinates range for the barplots/dotplots.</p>
</td></tr>
<tr><td><code id="plot.phylo4d_+3A_bar.lwd">bar.lwd</code></td>
<td>
<p>a vector of numeric giving bar widths of the barplot(s). Recycled along the tips, reapeated for each trait.</p>
</td></tr>
<tr><td><code id="plot.phylo4d_+3A_bar.col">bar.col</code></td>
<td>
<p>a vector of R colors to use for the bars. Recycled along the tips, reapeated for each trait. The user can also provide a matrix for a finer tuning.</p>
</td></tr>
<tr><td><code id="plot.phylo4d_+3A_show.data.axis">show.data.axis</code></td>
<td>
<p>logical indicating whether barplots/dotplots axes should be drawn.</p>
</td></tr>
<tr><td><code id="plot.phylo4d_+3A_dot.col">dot.col</code></td>
<td>
<p>a vector of R colors to use for the points. Recycled along the tips, reapeated for each trait. The user can also provide a matrix for a finer tuning.</p>
</td></tr>
<tr><td><code id="plot.phylo4d_+3A_dot.pch">dot.pch</code></td>
<td>
<p>a numerical vector of symbol to use for the points. Recycled along the tips, reapeated for each trait. The user can also provide a matrix for a finer tuning.</p>
</td></tr>
<tr><td><code id="plot.phylo4d_+3A_dot.cex">dot.cex</code></td>
<td>
<p>a numerical vector. Character (or symbol) expansion for the points. Recycled along the tips, reapeated for each trait. The user can also provide a matrix for a finer tuning.</p>
</td></tr>
<tr><td><code id="plot.phylo4d_+3A_cell.col">cell.col</code></td>
<td>
<p>a vector of colors for <code>gridplot</code> cells. Easily generated by <code><a href="grDevices.html#topic+heat.colors">heat.colors</a></code>, <code><a href="grDevices.html#topic+topo.colors">topo.colors</a></code>, <code><a href="grDevices.html#topic+terrain.colors">terrain.colors</a></code> or other functions created with <code>link{colorRampPalette}</code>.</p>
</td></tr>
<tr><td><code id="plot.phylo4d_+3A_show.color.scale">show.color.scale</code></td>
<td>
<p>logical indicating whether color scale should be drawn.</p>
</td></tr>
<tr><td><code id="plot.phylo4d_+3A_show.trait">show.trait</code></td>
<td>
<p>logical indicating whether traits labels should be drawn.</p>
</td></tr>
<tr><td><code id="plot.phylo4d_+3A_trait.labels">trait.labels</code></td>
<td>
<p>character vector to label the traits. If <code>NULL</code> the traits labels of the <code>phylo4d</code> object are used.</p>
</td></tr>
<tr><td><code id="plot.phylo4d_+3A_trait.col">trait.col</code></td>
<td>
<p>a vector of R colors to use for the traits labels. Recycled if necessary.</p>
</td></tr>
<tr><td><code id="plot.phylo4d_+3A_trait.cex">trait.cex</code></td>
<td>
<p>a numeric vector to control character size of the trait labels. Recycled if necessary.</p>
</td></tr>
<tr><td><code id="plot.phylo4d_+3A_trait.font">trait.font</code></td>
<td>
<p>an integer vector specifying the type of font for the traits labels: 1 (plain text), 2 (bold), 3 (italic), or 4 (bold italic). Recycled if necessary.</p>
</td></tr>
<tr><td><code id="plot.phylo4d_+3A_trait.bg.col">trait.bg.col</code></td>
<td>
<p>a vector of R colors to use for the background of the barplots. Recycled if necessary.</p>
</td></tr>
<tr><td><code id="plot.phylo4d_+3A_error.bar.sup">error.bar.sup</code></td>
<td>
<p>a matrix giving the superior limit for error bars. Columns and rows names must match with traits and tips labels, respectively.</p>
</td></tr>
<tr><td><code id="plot.phylo4d_+3A_error.bar.inf">error.bar.inf</code></td>
<td>
<p>	a matrix giving the inferior limit for error bars. Columns and rows names must match with traits and tips labels, respectively.</p>
</td></tr>
<tr><td><code id="plot.phylo4d_+3A_error.bar.col">error.bar.col</code></td>
<td>
<p>	a vector of R colors to draw error bars.</p>
</td></tr>
<tr><td><code id="plot.phylo4d_+3A_show.box">show.box</code></td>
<td>
<p>a logical indicating whether a box should be drawn around the plots.</p>
</td></tr>
<tr><td><code id="plot.phylo4d_+3A_grid.vertical">grid.vertical</code></td>
<td>
<p>	a logical incating whether vertical lines of the grid should be drawn.</p>
</td></tr>
<tr><td><code id="plot.phylo4d_+3A_grid.horizontal">grid.horizontal</code></td>
<td>
<p>a logical incating whether horizontal lines of the grid should be drawn.</p>
</td></tr>
<tr><td><code id="plot.phylo4d_+3A_grid.col">grid.col</code></td>
<td>
<p>a vector of R colors to use for the lines of the grid.</p>
</td></tr>
<tr><td><code id="plot.phylo4d_+3A_grid.lty">grid.lty</code></td>
<td>
<p>the lines type of the grid. Possibly a vector.</p>
</td></tr>
<tr><td><code id="plot.phylo4d_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to <code>plot.phylo</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>The four functions were written by Francois Keck in the package named phylosignal. Functions were there named as follows: multiplot.phylo4d, barplot.phylo4d, dotplot.phylo4d, and gridplot.phylo4d.
At the end of 2019, the package was orphaned and the functions were integrated in package <code>adiv</code>. The versions of the functions have been slightly modified compared to those developed by Francois Keck.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if(require(ape) &amp;&amp; require(phylobase)){
data(batcomm)
# Phylogenetic tree for bat species
phy &lt;- read.tree(text = batcomm$tre)
# Abondance data plotted in front of the phylogeny
# F = rainforest, P = cacao plantation
# O = oldfields, C = cornfields
ab.4d &lt;- phylo4d(phy, t(batcomm$ab))
barp4d(ab.4d, center = FALSE, scale = FALSE, 
    data.xlim = c(0, max(batcomm$ab)))
dotp4d(ab.4d, center = FALSE, scale = FALSE, 
    data.xlim = c(0, max(batcomm$ab)))
gridp4d(ab.4d, center = FALSE, scale = FALSE)
}
</code></pre>

<hr>
<h2 id='qDT'>
Mean Diversity along a Phylogenetic Tree
</h2><span id='topic+qDT'></span>

<h3>Description</h3>

<p>Function <code>qDT</code> calculates the <code class="reqn">^qD(T)</code> index developed by Chao et al. (2010) as the mean diversity of order <em>q</em> over <em>T</em> years in a phylogenetic tree. In function <code>qDT</code>, the index is computed over the whole tree from root to tips. It uses the formula of the <code class="reqn">^qD(T)</code> index extended to non-ultrametric trees (where the distance from tip to root varies) (Chao et al. 2010, equation 4.5) . 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qDT(phyl, comm, q = 2, tol = 1e-08)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="qDT_+3A_phyl">phyl</code></td>
<td>
<p>an object inheriting the class <code>phylo</code> (see package ape), <code>phylo4</code> (see package phylobase), or <code>hclust</code>.</p>
</td></tr>
<tr><td><code id="qDT_+3A_comm">comm</code></td>
<td>
<p>a data frame or a matrix typically with communities as rows, species as columns and abundance as entry. Species should be labeled as in the phylogenetic tree where they are the tips.</p>
</td></tr>
<tr><td><code id="qDT_+3A_q">q</code></td>
<td>
<p>a vector with nonnegative value(s) for parameter <code>q</code>. See details.</p>
</td></tr>
<tr><td><code id="qDT_+3A_tol">tol</code></td>
<td>
<p>numeric tolerance threshold: values between -<code>tol</code> and <code>tol</code> are considered equal to zero.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If only one value of <code>q</code> is given, a vector with the phylogenetic diversity of each community is returned.
If more than one value of <code>q</code> is given, a list of two objects is returned: 
</p>
<table role = "presentation">
<tr><td><code>q</code></td>
<td>
<p>the vector of values for <code>q</code>;</p>
</td></tr>
<tr><td><code>div</code></td>
<td>
<p>a data frame with the phylogenetic diversity of each community calculated for all values of <code>q</code>.</p>
</td></tr>
</table>
<p>The results of function <code>plot.qDT</code> are of class <code>"evodivparam"</code>. As such, function <code><a href="#topic+plot.evodivparam">plot.evodivparam</a></code> allows to plot the results of function <code>qDT</code>.
</p>


<h3>Author(s)</h3>

<p>Sandrine Pavoine <a href="mailto:sandrine.pavoine@mnhn.fr">sandrine.pavoine@mnhn.fr</a>
</p>


<h3>References</h3>

<p>Chao, A., Chiu, C.-H., Jost, L. (2010) Phylogenetic diversity measures based on Hill numbers. <em>Philosophical Transactions of the Royal Society London Series B</em>, <b>365</b>, 3599&ndash;3609.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+evodivparam">evodivparam</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
if(require(ape)){

data(batcomm)
phy &lt;- read.tree(text=batcomm$tre)
ab &lt;- batcomm$ab[, phy$tip.label]
plot(qDT(phy, ab))
plot(qDT(phy, ab, q=seq(0, 10, length=20)))

}

## End(Not run)
</code></pre>

<hr>
<h2 id='QE'>
Quadratic Entropy
</h2><span id='topic+QE'></span><span id='topic+discomQE'></span>

<h3>Description</h3>

<p>Function <code>QE</code> calculates Rao's quadratic entropy within communities
</p>
<p>Function <code>discomQE</code> calculates Rao's dissimilarities between communities
</p>


<h3>Usage</h3>

<pre><code class='language-R'>QE(comm, dis = NULL, formula = c("QE", "EDI"), scale = FALSE)

discomQE(comm, dis = NULL, structures = NULL, formula = c("QE", "EDI"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="QE_+3A_comm">comm</code></td>
<td>
<p>a data frame or a matrix with communities as rows and species as columns. Entries are abundances of species within communities. If presences/absences (1/0) are used a given species in a community of S species will be considered to have a relative abundance of 1/S.</p>
</td></tr>
<tr><td><code id="QE_+3A_dis">dis</code></td>
<td>

<p>either <code>NULL</code> or an object of class <code>dist</code> that contains the (functional or phylogenetic) distances among species. If <code>NULL</code> the Gini-Simpson index is used. See details.
</p>
</td></tr>
<tr><td><code id="QE_+3A_formula">formula</code></td>
<td>

<p>either <code>"QE"</code> (default) or <code>"EDI"</code>. See details.
</p>
</td></tr>
<tr><td><code id="QE_+3A_scale">scale</code></td>
<td>

<p>a logical value indicating whether or not the diversity coefficient should be scaled by its maximal value over all species abundance distributions.
</p>
</td></tr>
<tr><td><code id="QE_+3A_structures">structures</code></td>
<td>

<p>either NULL or a data frame that contains, in the <em>j</em>th row and the <em>k</em>th column, the name of the group of level <em>k</em> to which the <em>j</em>th community belongs. Communities in <code>structures</code> should be in the same order as in <code>comm</code>. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>formula = "QE"</code>, the definition of the quadratic entropy is:
</p>
<p style="text-align: center;"><code class="reqn">QE(\mathbf{p}_i,\mathbf{D})=\sum_{k=1}^S\sum_{l=1}^S p_{k|i}p_{k|j}d_{kl}</code>
</p>

<p>where <code class="reqn">\mathbf{p}_i=(p_{1|i}, ..., p_{k|i}, ..., p_{S|i})</code> is the vector of relative species abundance within community <em>i</em>; <em>S</em> is  the  number  of  species; <code class="reqn">\mathbf{D}=(d_{kl})</code> is the  matrix  of  (phylogenetic  or functional)  dissimilarities  among  species,  and <code class="reqn">d_{kl}</code> is the (phylogenetic or functional) dissimilarity between species 
<em>k</em> and <em>l</em>. For the calculations of dissimilarities between communities see the description of the apportionment of quadratic entropy in Pavoine et al. (2016) and references therein. 
</p>
<p>If <code>formula = "EDI"</code>, the definition of the quadratic entropy is: 
</p>
<p style="text-align: center;"><code class="reqn">EDI(\mathbf{p}_i,\mathbf{D})=\sum_{k=1}^S\sum_{l=1}^S p_{k|i}p_{k|j}\frac{d_{kl}^2}{2}</code>
</p>

<p>EDI stands for the Euclidean Diversity Index of Champely and Chessel (2002) (equation 3 in Pavoine et al. 2004). If EDI is used, the dissimilarities between communities calculated by <code>discomQE</code> are obtained as in equation 4 in Pavoine et al. (2004).
</p>
<p>In both cases, if <code>dis = NULL</code>, the quadratic entropy is equal to Gini-Simpson entropy:
</p>
<p style="text-align: center;"><code class="reqn">H_{GS}(\mathbf{p}_i)=1 - \sum_{k=1}^S p_{k|i}^2</code>
</p>
<p>.
</p>
<p>For using function <code>discomQE</code>, the Euclidean properties are expected for object <code>dis</code>. See function <code>is.euclid</code> of package ade4. These properties are not necessary for using function <code>QE</code>. Note that <code>discomQE</code> can be used if <code>dis = NULL</code>. In that case species are considered to be equidifferent (i.e. the dissimilarity between any two species is a constant; such dissimilarities have Euclidean properties).
</p>


<h3>Value</h3>

<p>Function <code>QE</code> returns a data frame with communities as rows and the diversity within communities as columns.
</p>
<p>If <code>structures</code> is <code>NULL</code>, function <code>discomQE</code> returns an object of class <code>dist</code>. Otherwise it returns a list of objects of class <code>dist</code>.
</p>


<h3>Author(s)</h3>

<p>Sandrine Pavoine <a href="mailto:sandrine.pavoine@mnhn.fr">sandrine.pavoine@mnhn.fr</a>
</p>


<h3>References</h3>

<p>Gini, C. (1912) <em>Variabilita e mutabilita</em>. Universite di Cagliari III, Parte II.
</p>
<p>Simpson, E.H. (1949) Measurement of diversity. <em>Nature</em>, <b>163</b>, 688. 
</p>
<p>Rao, C.R. (1982) Diversity and dissimilarity coefficients: a unified approach. <em>Theoretical Population Biology</em>, <b>21</b>, 24&ndash;43.
</p>
<p>Champely, S. and Chessel, D. (2002) Measuring biological diversity using Euclidean metrics. <em>Environmental and Ecological Statistics</em>, <b>9</b>, 167&ndash;177.
</p>
<p>Pavoine, S., Dufour, A.B., Chessel, D. (2004) From dissimilarities among species to dissimilarities among communities: a double principal coordinate analysis. <em>Journal of Theoretical Biology</em>, <b>228:</b>, 523&ndash;537.
</p>
<p>Pavoine, S., Marcon, E., Ricotta, C. (2016) &quot;Equivalent numbers&quot; for species, phylogenetic, or functional diversity in a nested hierarchy of multiple scales. <em>Methods in Ecology and Evolution</em>, <b>7</b>, 1152&ndash;1163.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
if(require(ade4)){

# First case study (community level, bird diversity):
data(ecomor, package="ade4")
# taxonomic dissimilarities between species
dtaxo &lt;- dist.taxo(ecomor$taxo)
# quadratic entropy
QE(t(ecomor$habitat), dtaxo, formula="EDI")
QE(t(ecomor$habitat), dtaxo^2/2, formula="QE")
table.value(as.matrix(discomQE(t(ecomor$habitat), dtaxo, formula="EDI")))
EDIcom &lt;- discomQE(t(ecomor$habitat), dtaxo, formula="EDI")
QEcom &lt;- discomQE(t(ecomor$habitat), dtaxo^2/2, formula="QE")
QEcom 
EDIcom^2/2

# display of the results
bird.QE &lt;- QE(t(ecomor$habitat), dtaxo, formula="EDI")
dotchart(bird.QE$diversity, labels = rownames(bird.QE), 
    xlab = "Taxonomic diversity", ylab="Habitats")

# Second case study (population level, human genetic diversity):
data(humDNAm, package="ade4")
# quadratic entropy
QE(t(humDNAm$samples), humDNAm$distances/2, formula="QE")
QE(t(humDNAm$samples), sqrt(humDNAm$distances), formula="EDI")
QEhumDNA.dist &lt;- discomQE(t(humDNAm$samples), 
humDNAm$distances/2, humDNAm$structures)
is.euclid(QEhumDNA.dist$communities)
is.euclid(QEhumDNA.dist$regions)

EDIhumDNA.dist &lt;- discomQE(t(humDNAm$samples), 
sqrt(humDNAm$distances), humDNAm$structures, formula="EDI")
is.euclid(EDIhumDNA.dist$communities)
is.euclid(EDIhumDNA.dist$regions)

QEhumDNA.dist$communities
EDIhumDNA.dist$communities^2/2

# display of the results
hum.QE &lt;- QE(t(humDNAm$samples), humDNAm$distances/2, formula="QE")
dotchart(hum.QE$diversity, labels = rownames(hum.QE), 
    xlab = "Genetic diversity", ylab="Populations")

}

## End(Not run)
</code></pre>

<hr>
<h2 id='qHdiv'>
Biodiversity Measure that Includes Consistent Interspecific and Intraspecific Components
</h2><span id='topic+qHdiv'></span>

<h3>Description</h3>

<p>Function <code>qHdiv</code> calculates the parametric diversity index developed by Pavoine and Izsak (2014)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qHdiv(comm, C, q = 2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="qHdiv_+3A_comm">comm</code></td>
<td>

<p>a data frame or a matrix typically with communities as rows, species as columns and an index of abundance as entries.
</p>
</td></tr>
<tr><td><code id="qHdiv_+3A_c">C</code></td>
<td>

<p>a matrix that contains measures of the chosen intraspecific components (as defined in Pavoine and Izsak 2014) on the diagonal and measures of interspecific components off diagonal. These interspecific components reflect functional or phylogenetic similarities among species.
</p>
</td></tr>
<tr><td><code id="qHdiv_+3A_q">q</code></td>
<td>

<p>a positive numeric for the value of the parameter <code>q</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector with the diversity in each of the communities (same order as in <code>comm</code>).
</p>


<h3>Author(s)</h3>

<p>Sandrine Pavoine <a href="mailto:sandrine.pavoine@mnhn.fr">sandrine.pavoine@mnhn.fr</a>
</p>


<h3>References</h3>

<p>Pavoine, S., Izsak, J. (2014) New biodiversity measure that includes consistent interspecific and intraspecific components. <em>Methods in Ecology and Evolution</em>, <b>5</b>, 165&ndash;172.</p>


<h3>See Also</h3>

<p><code><a href="#topic+twoHmax">twoHmax</a></code>, <code><a href="#topic+CFprop">CFprop</a></code>, <code><a href="#topic+CFbinary">CFbinary</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
if(require(ape)){

# First case study on phylogenetic diversity:
# Below is a phylogenetic tree in newick format
tre &lt;-"((((((sA:4,sB:1):1,sC:3):2,((sD:2,sE:1):1,sF:1):2):1,sG:7):1,sH:1):3,(sI:2,sJ:1):2):0;"
#The number of tips is kept in parameter n:
n&lt;-10
# Next we need to obtain matrix CP (see Pavoine and Izsak 2014). 
phyape &lt;- read.tree(text = tre)
plot(phyape)
CP &lt;- vcv(phyape)
WP &lt;- diag(diag(CP))
# With this particular illustration, a maximizing vector, 
# for 2H applied to CP, that does not contain any zero can be found. 
# This maximizing vector can thus be obtained directly, 
# instead of being estimated. 
# Two equivalent equations have been given to obtain 
# the maximizing vector in Appendix S1 of 
# Pavoine and Izsak (2014). 
# We use the first one below:

Pmax&lt;-(solve(CP^2)%*%diag(CP))/sum(solve(CP^2)%*%diag(CP))
Pmax

# The second equation equivalently provides:

Z &lt;- ((diag(1/sqrt(diag(CP))))%*%CP%*%(diag(1/sqrt(diag(CP)))))^2
Pmax&lt;-(solve(WP)%*%solve(Z)%*%rep(1,n))/sum(solve(WP)%*%solve(Z))
Pmax

# Applied to our case study, the function twoHmax 
# provides a good approximation of the maximizing vector:

twoHmax(CP)

# Second case study on the redundancy among variables:
data(rhone, package="ade4")
V &lt;- rhone$tab
# First consider the covariances among the variables:
C &lt;- cov(V)
# A vector that maximizes 2H applied to C is estimated 
# as follows:
pmax_covariances &lt;- twoHmax(C)$vector
dotchart(as.matrix(pmax_covariances))

# If we apply 2H only to the diagonal matrix with the variances 
# of the variables, the vector that maximizes 2H is:
W &lt;- diag(diag(C))
rownames(W)&lt;-colnames(W)&lt;-rownames(C)
pmax_variances &lt;- twoHmax(W)$vector
dotchart(as.matrix(pmax_variances))

# If C contains the correlations among variables, 
# a vector that maximizes 2H applied to C is estimated 
# as follows:
C &lt;- cor(V)
pmax_correlations &lt;- twoHmax(C)$vector
dotchart(as.matrix(pmax_correlations))

# By attributing equal weights to the variables, 
# 2H applied to the correlation matrix measures 
# the number of effective variables:
# from 0 if all variables are completely correlated 
# with each other to n if they are not correlated. 
# Similarly, by attributing equal weights to the variables, 
# 2H applied to the covariance matrix measures 
# the effective amount of variation:
# from 0 if all variables are completely correlated 
# with each other to n if they are not correlated 
# and have similar variances.

#Even if the data set contains 15 variables, 
# the effective number of variables is lower:
C &lt;- cor(V)
equalproportions &lt;- cbind.data.frame(rep(1/ncol(C), ncol(C)))
names(equalproportions) &lt;- "equalprop"
equalproportions &lt;- t(equalproportions)
qHdiv(equalproportions, C)

# When considering the covariances, instead of the correlations, 
# the effective number of variables is even lower,
# indicating also an imbalance in the variances 
# of the variables.
C &lt;- cov(V)
qHdiv(equalproportions, C)

}

## End(Not run)
</code></pre>

<hr>
<h2 id='randEH'>
Amount of Evolutionary History Preserved when Random Species are Saved
</h2><span id='topic+randEH'></span>

<h3>Description</h3>

<p>When branch lengths in an ultrametric phylogenetic tree are expressed as divergence times, the total sum of branch lengths in that tree expresses the amount of evolutionary history. The function <code>randEH</code> calculates the amount of evolutionary history preserved when <em>k</em> random species out of <em>n</em> original species are saved. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>randEH(phyl, nbofsp, nrep = 10)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="randEH_+3A_phyl">phyl</code></td>
<td>

<p>an object inheriting the class <code>phylo</code> (see package ape), <code>phylo4</code> (see package phylobase) or <code>hclust</code>.
</p>
</td></tr>
<tr><td><code id="randEH_+3A_nbofsp">nbofsp</code></td>
<td>

<p>an integer indicating the number of species saved (<em>k</em>).</p>
</td></tr>
<tr><td><code id="randEH_+3A_nrep">nrep</code></td>
<td>

<p>an integer indicating the number of random sampling.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Function <code>randEH</code> returns a numeric vector with the amount of evolutionary history preserved by each random drawing of the <em>k</em> species to be saved.
</p>


<h3>Author(s)</h3>

<p>Sandrine Pavoine <a href="mailto:sandrine.pavoine@mnhn.fr">sandrine.pavoine@mnhn.fr</a>
with contributions of Stephane Dray
</p>


<h3>References</h3>

<p>Nee, S. and May, R.M. (1997) Extinction and the loss of evolutionary history. <em>Science</em>, <b>278</b>, 692&ndash;694.
</p>
<p>Pavoine, S., Ollier, S. and Dufour, A.-B. (2005) Is the originality of a species measurable? <em>Ecology Letters</em>, <b>8</b>, 579&ndash;586.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+optimEH">optimEH</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
if(require(ape) &amp;&amp; require(adephylo)){

data(carni70, package = "adephylo")
tre &lt;- read.tree(text=carni70$tre)
adiv:::EH(tre)
R &lt;- adiv:::randEH(tre, 10, nrep=1000)
hist(R)

}

## End(Not run)
</code></pre>

<hr>
<h2 id='rare_Rao'>
Functional Rarefaction for Species Abundance Data
</h2><span id='topic+rare_Rao'></span>

<h3>Description</h3>

<p>The function <code>Rare_Rao</code> performs distance-based rarefaction curves using species abundance data. It finds the expected functional diversity (if functional distances between species are used) as a function of the sampling effort. Two approaches are available: an analytical solution, a resampling approach.</p>


<h3>Usage</h3>

<pre><code class='language-R'>rare_Rao(comm, dis, sim = TRUE, resampling = 999, formula = c("QE", "EDI"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rare_Rao_+3A_comm">comm</code></td>
<td>

<p>a data frame or a matrix with samples as rows, species as columns, and abundance or frequency as entries. If presences/absences (1/0) are given, the relative abundance of a given species in a community of S species will be considered equal to 1/S.
</p>
</td></tr>
<tr><td><code id="rare_Rao_+3A_dis">dis</code></td>
<td>

<p>an object of class <code>dist</code> containing pairwise distances among species. The distance matrix should be squared Euclidean or simply Euclidean (see definition and details in Appendix S1 of Ricotta et al. (2012)). Alternatively, if <code>dis</code> is <code>NULL</code>, the Gini-Simpson index is used.
</p>
</td></tr>
<tr><td><code id="rare_Rao_+3A_sim">sim</code></td>
<td>

<p>a logical; if <code>TRUE</code>, the resampling approach is used; if <code>FALSE</code>, the analytical solution is given. 
</p>
</td></tr>
<tr><td><code id="rare_Rao_+3A_resampling">resampling</code></td>
<td>

<p>a numeric; number of times data are resampled to calculate the mean functional rarefaction curve (used if <code>sim=TRUE</code>).
</p>
</td></tr>
<tr><td><code id="rare_Rao_+3A_formula">formula</code></td>
<td>

<p>either <code>"QE"</code> (default) or <code>"EDI"</code>. See details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>formula = "QE"</code>, the definition of the quadratic entropy is:
</p>
<p style="text-align: center;"><code class="reqn">QE(\mathbf{p}_i,\mathbf{D})=\sum_{k=1}^S\sum_{l=1}^S p_{k|i}p_{k|j}d_{kl}</code>
</p>

<p>where <code class="reqn">\mathbf{p}_i=(p_{1|i}, ..., p_{k|i}, ..., p_{S|i})</code> is the vector of relative species abundance within sample <em>i</em>; <em>S</em> is  the  number  of  species; <code class="reqn">\mathbf{D}=(d_{kl})</code> is the  matrix  of  (phylogenetic  or functional)  dissimilarities  among  species,  and <code class="reqn">d_{kl}</code> is the (phylogenetic or functional) dissimilarity between species 
<em>k</em> and <em>l</em>.  
</p>
<p>If <code>formula = "EDI"</code>, the definition of the quadratic entropy is: 
</p>
<p style="text-align: center;"><code class="reqn">EDI(\mathbf{p}_i,\mathbf{D})=\sum_{k=1}^S\sum_{l=1}^S p_{k|i}p_{k|j}\frac{d_{kl}^2}{2}</code>
</p>

<p>EDI stands for the Euclidean Diversity Index of Champely and Chessel (2002) (equation 3 in Pavoine et al. 2004). 
</p>
<p>In both cases, if <code>dis = NULL</code>, the quadratic entropy is equal to Gini-Simpson entropy:
</p>
<p style="text-align: center;"><code class="reqn">H_{GS}(\mathbf{p}_i)=1 - \sum_{k=1}^S p_{k|i}^2</code>
</p>



<h3>Value</h3>

<p>If <code>sim = TRUE</code>, the function returns a data frame containing the Expected Rao Quadratic Entropy (column 'ExpRao'), the limits of the 95% Confidence Interval (columns 'LeftIC' and 'RightIC') for each subsample dimension (M) out of the total set of samples (N). If <code>sim = FALSE</code>, the function returns a data frame containing the analytical solution for the Expected Rao Quadratic Entropy (column 'ExpRao') for each subsample dimension (M) out of the total set of samples (N).
</p>


<h3>Author(s)</h3>

<p>Giovanni Bacaro
and
Sandrine Pavoine <a href="mailto:sandrine.pavoine@mnhn.fr">sandrine.pavoine@mnhn.fr</a>
</p>


<h3>References</h3>

<p>Ricotta, C., Pavoine, S., Bacaro, G., Acosta, A. (2012) Functional rarefaction for species abundance data. <em>Methods in Ecology and Evolution</em>, <b>3</b>, 519&ndash;525.
</p>
<p>Champely, S. and Chessel, D. (2002) Measuring biological diversity using Euclideanmetrics. <em>Environmental and Ecological Statistics</em>, <b>9</b>, 167&ndash;177.
</p>
<p>Pavoine, S., Dufour, A.B., Chessel, D. (2004) From dissimilarities among species to dissimilarities among communities: a double principal coordinate analysis. <em>Journal of Theoretical Biology</em>, <b>228</b>, 523&ndash;537.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+QE">QE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
if(require(ade4)){

data(aviurba, package="ade4")

# Trait-based distances between bird species:
distances&lt;-dist.ktab(ktab.list.df(list(aviurba$traits)), type = "N")
# The distances should be squared Euclidean; 
# note that Euclidean distances can be used 
# as they also are squared Euclidean.

# Species abundances in sites
abundances&lt;- aviurba$fau

# Rarefaction of functional diversity
rare_Rao(abundances, distances, sim = TRUE, resampling = 100)
rare_Rao(abundances, distances, sim = FALSE)

}

## End(Not run)
</code></pre>

<hr>
<h2 id='RDMCCP16'>
Theoretical Data Set used in Ricotta et al. (2016)
</h2><span id='topic+RDMCCP16'></span>

<h3>Description</h3>

<p>Hypothetical communities C1-C9 composed of nine species
S1-S9 with varying abundances divided into three groups of three species (S1-S3, S4-S6 and S7-S9) (say, legumes, herbs and forbs). For simplicity, all species within the same group are functionally identical to each other, while two species belonging to different groups are always maximally dissimilar (Ricotta et al. 2016).</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("RDMCCP16")</code></pre>


<h3>Format</h3>

<p>A list of two objects:
</p>
<p><code>ab</code>, a matrix with communities as rows, species as columns and abundance values as entries.
</p>
<p><code>dis</code>, an object of class <code>dist</code> that contains theoretical dissimilarities between species.
</p>


<h3>Source</h3>

<p>Table 1 in Ricotta et al. (2016)
</p>


<h3>References</h3>

<p>Ricotta, C., de Bello, F., Moretti, M., Caccianiga, M., Cerabolini, B.E., Pavoine, S. (2016). Measuring the functional redundancy of biological communities: A quantitative guide. <em>Methods in Ecology and Evolution</em>, <b>7</b>, 1386&ndash;1395.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(RDMCCP16)
uniqueness(RDMCCP16$ab, as.dist(RDMCCP16$dis))
</code></pre>

<hr>
<h2 id='Rentropy'>
Pavoine et al. (2017) functional or phylogenetic entropy
</h2><span id='topic+Rentropy'></span>

<h3>Description</h3>

<p>Function <code>Rentropy</code> calculates Pavoine et al. (2017) functional or phylogenetic R entropy within communities; this index is closely related to Rao's quadratic entropy 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Rentropy(comm, dis = NULL, scale = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Rentropy_+3A_comm">comm</code></td>
<td>
<p>a data frame or a matrix with communities as rows and species as columns. Entries are abundances of species within sites.</p>
</td></tr>
<tr><td><code id="Rentropy_+3A_dis">dis</code></td>
<td>

<p>either <code>NULL</code> or an object of class <code>dist</code> that contains the (functional or phylogenetic) distances among species. If <code>NULL</code> species are said equidistant with a distance of 1 between any two species and a distance of 0 between a species and itself. 
</p>
</td></tr>
<tr><td><code id="Rentropy_+3A_scale">scale</code></td>
<td>

<p>a logical value indicating whether or not the diversity coefficient should be scaled by its maximal value over all species abundance distributions.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The definition of the R entropy is:
</p>
<p style="text-align: center;"><code class="reqn">R(\mathbf{p}_i,\mathbf{D})=\sum_{k=1}^S\sum_{l=1}^S \sqrt{p_{k|i}}\sqrt{p_{k|j}}d_{kl}</code>
</p>

<p>where <code class="reqn">\mathbf{p}_i=(p_{1|i}, ..., p_{k|i}, ..., p_{S|i})</code> is the vector of relative species abundance within community <em>i</em>; <em>S</em> is  the  number  of  species; <code class="reqn">\mathbf{D}=(d_{kl})</code> is the  matrix  of  (phylogenetic  or functional)  dissimilarities  among  species,  and <code class="reqn">d_{kl}</code> is the (phylogenetic or functional) dissimilarity between species 
<em>k</em> and <em>l</em>.  
</p>


<h3>Value</h3>

<p>Function <code>Rentropy</code> returns a data frame with communities as rows and the R entropy within communities as columns.
</p>


<h3>Author(s)</h3>

<p>Sandrine Pavoine <a href="mailto:sandrine.pavoine@mnhn.fr">sandrine.pavoine@mnhn.fr</a>
</p>


<h3>References</h3>

<p>Pavoine, S., Bonsall, M.B., Dupaix, A., Jacob, U., Ricotta, C. (2017) From phylogenetic to functional originality: guide through indices and new developments. <em>Ecological Indicators</em>, <b>82</b>, 196&ndash;205.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
if(require(ade4)){

data(ecomor, package="ade4")
dtaxo &lt;- dist.taxo(ecomor$taxo)
bird.R &lt;- Rentropy(t(ecomor$habitat), dtaxo^2/2)
dotchart(bird.R$diversity, labels = rownames(bird.R))

}

## End(Not run)

## Not run: 
if(require(ape)){

data(batcomm)
phy &lt;- read.tree(text=batcomm$tre)
dphy &lt;- as.dist(cophenetic(phy))/2
ab &lt;- batcomm$ab[, phy$tip.label]
bat.R &lt;- Rentropy(ab, dphy)
dotchart(bat.R$diversity, labels = rownames(bat.R), xlab = "Entropy")

}

## End(Not run)
</code></pre>

<hr>
<h2 id='rlqESLTP'>
Linking Patterns in Phylogeny, Traits, Abiotic Variables
and Space</h2><span id='topic+rlqESLTP'></span><span id='topic+plot.rlqESLTP'></span><span id='topic+summary.rlqESLTP'></span>

<h3>Description</h3>

<p>An extention of the RLQ approach to identify potential environmental filters in species' traits in a phylogenetic and spatial context. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rlqESLTP(dudiE, dudiS, dudiL, dudiT, dudiP, ...)

## S3 method for class 'rlqESLTP'
plot(x, which = NULL, phyl = NULL, 
    xy = NULL, traits = NULL, env = NULL, type = NULL, 
    ax = 1, disp = c("dots", "bars", "grid"), ...)

## S3 method for class 'rlqESLTP'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rlqESLTP_+3A_dudie">dudiE</code></td>
<td>

<p>an object of class <code>dudi</code> of package ade4 (e.g. a principal component applied to environmental variables or a principal coordinate analysis applied to environmental distances between plots). Plots must be weighted as in <code>dudiL</code>. <code>dudiE</code> can be set to <code>NULL</code> if <code>dudiS</code> is not.
</p>
</td></tr>
<tr><td><code id="rlqESLTP_+3A_dudis">dudiS</code></td>
<td>

<p>an object of class <code>dudi</code> of package ade4 (e.g. an eigenvector decomposition applied to a spatial neighbourhood matrix (see Pavoine et al. 2011 for exemples)). Plots must be weighted as in <code>dudiL</code>. <code>dudiS</code> can be set to <code>NULL</code> if <code>dudiE</code> is not.
</p>
</td></tr>
<tr><td><code id="rlqESLTP_+3A_dudil">dudiL</code></td>
<td>

<p>an object of class <code>dudi</code> obtained with function <code>dudi.coa</code> of ade4 applied to a plot (rows) by species (columns) data frame. <code>dudiL</code> cannot be set to <code>NULL</code>.
</p>
</td></tr>
<tr><td><code id="rlqESLTP_+3A_dudit">dudiT</code></td>
<td>

<p>an object of class <code>dudi</code> of package ade4 (e.g. a principal component analysis applied to functional traits of species or a principal coordinate analysis applied to functional distances between species). Species must be weighted as in <code>dudiL</code>. <code>dudiT</code> can be set to <code>NULL</code> if <code>dudiP</code> is not.
</p>
</td></tr>
<tr><td><code id="rlqESLTP_+3A_dudip">dudiP</code></td>
<td>

<p>an object of class <code>dudi</code> of package ade4 (e.g. a principal coordinate analysis applied to phylogenetic distances between species). Species must be weighted as in <code>dudiL</code>. <code>dudiP</code> can be set to <code>NULL</code> if <code>dudiT</code> is not.
</p>
</td></tr>
<tr><td><code id="rlqESLTP_+3A_x">x</code></td>
<td>

<p>an object of class <code>rlqESTP</code> (obtained with function <code>rqlESTP</code>).</p>
</td></tr>
<tr><td><code id="rlqESLTP_+3A_object">object</code></td>
<td>

<p>an object of class <code>rlqESTP</code> (obtained with function <code>rqlESTP</code>).</p>
</td></tr>
<tr><td><code id="rlqESLTP_+3A_which">which</code></td>
<td>

<p>a character that might be <code>"E"</code> (in that case arguments <code>env</code> and <code>type</code> must be given); <code>"S"</code> (in that case argument <code>xy</code> must be given); <code>"T"</code> (in that case arguments <code>traits</code> and <code>type</code> must be given); or <code>"P"</code> (in that case argument <code>phyl</code> must be given).</p>
</td></tr>
<tr><td><code id="rlqESLTP_+3A_phyl">phyl</code></td>
<td>

<p>an object inheriting the class <code>phylo</code> (see package ape), <code>phylo4</code> (see package phylobase) or <code>hclust</code>.
</p>
</td></tr>
<tr><td><code id="rlqESLTP_+3A_xy">xy</code></td>
<td>

<p>a data frame with two columns giving the coordinates of the plots (longitude, latitude in that order).</p>
</td></tr>
<tr><td><code id="rlqESLTP_+3A_traits">traits</code></td>
<td>

<p>a list of data frames for the traits, each data frame contains variables from a single statistical type (see argument <code>type</code> below). NAs are allowed. However, in that case, the calculations depend, for each trait, on the subset of available data only.</p>
</td></tr>
<tr><td><code id="rlqESLTP_+3A_env">env</code></td>
<td>

<p>a list of data frames for the environmental variables, each data frame contains variables from a single statistical type (see argument <code>type</code> below). NAs are allowed. However, in that case, the calculations depend, for each variable, on the subset of available data only.</p>
</td></tr>
<tr><td><code id="rlqESLTP_+3A_type">type</code></td>
<td>

<p>a vector that provides the type of each table to be analysed in <code>env</code> (if environemental variables should be displayed) or <code>traits</code> (if the focus is on species' traits). The possible types are <code>"Q"</code> (quantitative, numeric), <code>"O"</code> (ordinal), <code>"N"</code> (nominal), <code>"D"</code> (dichotomous), <code>"F"</code> (fuzzy, or expressed as a proportion), <code>"B"</code> (multichoice nominal variables, coded by binary columns), <code>"C"</code> (circular). Values in type must be in the same order as in <code>env</code> or <code>traits</code>.</p>
</td></tr>
<tr><td><code id="rlqESLTP_+3A_ax">ax</code></td>
<td>

<p>a numeric indicating the axis of interest.</p>
</td></tr>
<tr><td><code id="rlqESLTP_+3A_disp">disp</code></td>
<td>

<p>a string indicating which method to use to display species scores in front of the phylogeny: one of <code>"dots"</code> (for a dot plot), <code>"bars"</code> (for a barplot), and <code>"grid"</code> (for a gridplot for vizualizing scores by a color gradient).</p>
</td></tr>
<tr><td><code id="rlqESLTP_+3A_...">...</code></td>
<td>

<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Function <code>rlqESLTP</code> returns an object of classes <code>rlqESLTP</code>, <code>rlq</code> and <code>dudi</code>.
It is a list of 26 objects:
</p>
<table role = "presentation">
<tr><td><code>tab</code></td>
<td>
<p>a data frame. Crossed Table (CT): crossing the columns of the merged trait and phylogenetic table with those of the merged environmental and spatial table.</p>
</td></tr>
<tr><td><code>cw</code></td>
<td>
<p>a vector of numerics. Weights attributed to the columns of the merged trait and phylogenetic table.</p>
</td></tr>
<tr><td><code>lw</code></td>
<td>
<p>a vector of numerics. weights attributed to the columns of the merged environmental and spatial table.</p>
</td></tr>
<tr><td><code>eig</code></td>
<td>
<p>a vector of numerics. The vector of eigenvalues.</p>
</td></tr>
<tr><td><code>rank</code></td>
<td>
<p>an integer. The total number of axes in the analysis.</p>
</td></tr>
<tr><td><code>nf</code></td>
<td>
<p>a numeric. The number of axes kept.</p>
</td></tr>
<tr><td><code>c1</code></td>
<td>
<p>a data frame. Principal axes. Normed scores for the columns of merged trait and phylogenetic table.</p>
</td></tr>
<tr><td><code>co</code></td>
<td>
<p>a data frame. Scores for the columns of merged trait and phylogenetic table.</p>
</td></tr>
<tr><td><code>l1</code></td>
<td>
<p>a data frame. Principal axes. Normed scores for the columns of merged environmental and spatial table.</p>
</td></tr>
<tr><td><code>li</code></td>
<td>
<p>a data frame. Scores for the columns of merged environmental and spatial table.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>call</p>
</td></tr>
<tr><td><code>lQ</code></td>
<td>
<p>data frame. Scores for the species.</p>
</td></tr>       
<tr><td><code>mQ</code></td>
<td>
<p>data frame. Normed scores for the species.</p>
</td></tr>
<tr><td><code>lR</code></td>
<td>
<p>data frame. Scores of the plots.</p>
</td></tr>
<tr><td><code>mR</code></td>
<td>
<p>data frame. Normed scores for the plots.</p>
</td></tr>
<tr><td><code>aQ</code></td>
<td>
<p>data frame. Correlations trait/phylogeny axes / coinertia axes.</p>
</td></tr>
<tr><td><code>aR</code></td>
<td>
<p>data frame. Correlations environment/space axes / coinertia axes.</p>
</td></tr>
<tr><td><code>lR_givenE</code></td>
<td>
<p>data frame. Contributions of environmental information to plot scores.</p>
</td></tr>
<tr><td><code>lR_givenS</code></td>
<td>
<p>data frame. Contributions of spatial information to plot scores.</p>
</td></tr>
<tr><td><code>lQ_givenT</code></td>
<td>
<p>data frame. Contributions of trait information to species scores.</p>
</td></tr>
<tr><td><code>lQ_givenP</code></td>
<td>
<p>data frame. Contributions of phylogenetic information to species scores.</p>
</td></tr>
<tr><td><code>row.w</code></td>
<td>
<p>a vector. Weights attributed to plots.</p>
</td></tr>
<tr><td><code>col.w</code></td>
<td>
<p>a vector. Weights attributed to species.</p>
</td></tr>
<tr><td><code>dudiL</code></td>
<td>
<p>object of class <code>dudi</code> (<code>dudiL</code>).</p>
</td></tr>    
<tr><td><code>dudiR</code></td>
<td>
<p>object of class <code>dudi</code> (merging information on environment and space).</p>
</td></tr>
<tr><td><code>dudiQ</code></td>
<td>
<p>object of class <code>dudi</code> (merging information on traits and phylogeny).</p>
</td></tr> 
</table>


<h3>Author(s)</h3>

<p>Sandrine Pavoine <a href="mailto:sandrine.pavoine@mnhn.fr">sandrine.pavoine@mnhn.fr</a>
</p>


<h3>References</h3>

<p>Pavoine, S., Vela, E., Gachet, S., de Belair, G., Bonsall, M.B. (2011) Linking patterns in phylogeny, traits, abiotic variables and space: a novel approach to linking environmental filtering and plant community assembly. <em>Journal of Ecology</em>, <b>99</b>, 165&ndash;175.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
if(require(ade4) &amp;&amp; require(adegraphics) &amp;&amp; require(ape)){
O &lt;- adegpar()$plabels$optim
adegpar("plabels.optim" = TRUE)

data(mafragh, package="ade4")
xy &lt;- mafragh$xy
#The object that defines the neighbourhood between plots is in
mneig &lt;- mafragh$neig
#mneig is an object of class neig
s.label(mafragh$xy, nb = mafragh$nb, paxes.draw = FALSE)

#The environmental variables are in
env &lt;- mafragh$env
names(env)
#The abundance data are in
flo &lt;- mafragh$flo
# Adjustement of the writing of species names
names &lt;- gsub(" ", "_", mafragh$spenames[colnames(flo), 1])
for(i in 1:26){
names &lt;- gsub(LETTERS[i], letters[i], names)
}
names &lt;- gsub("alisma_plantago", "alisma_plantago_aquatica", names)
colnames(flo) &lt;- names
#The data on traits are in
traits &lt;- lapply(mafragh$traits, function(x) x[colnames(flo), , drop=FALSE])
#The phylogenetic tree is in
phy &lt;- read.tree(text=mafragh$tre)
plot(phy)

#Traits are separated by statistical type. The object traits is a list of data frames.
tabBinary &lt;- prep.binary(traits$tabBinary, c(3, 4))
tabQuantitative &lt;- traits$tabQuantitative
tabCircular &lt;- prep.circular(traits$tabCircular, 1, 12)
tabOrdinal &lt;- traits$tabOrdinal

#Analyses:
coaflo &lt;- dudi.coa(flo, scan = FALSE, nf = 55)
vecspa &lt;- scores.neig(mneig)
pcaspa &lt;- dudi.pca(vecspa, coaflo$lw, scan = FALSE, nf = 96)
#We first removed environmental variables
env &lt;- env[-(8:10)]
env[4:8] &lt;- log(env[4:8])
pcaenv &lt;- dudi.pca(env, coaflo$lw, scale = FALSE, scan = FALSE, nf = 8)
disT &lt;- dist.ktab(ktab.list.df(list(tabBinary,
tabOrdinal[c("Spikiness", "Hairy leaves")])), c("B", "O"))
# The definition of the functional distances between species 
# were slightly different in Pavoine et al. (2011).

pcotraits &lt;- dudi.pco(disT, coaflo$cw, full = TRUE)
pcophy &lt;- dudi.pco(sqrt(as.dist(cophenetic(phy)[names(flo), names(flo)])/2), coaflo$cw, full = TRUE)


rlqmix &lt;- rlqESLTP(pcaenv, pcaspa, coaflo, pcotraits, pcophy, scan = FALSE, nf = 2)
barplot(rlqmix$eig)
rlqmix$eig[1]/sum(rlqmix$eig)
plot(rlqmix, xy=xy, ax=1, wh="S")
plot(rlqmix, phy=phy, ax=1, wh="P")
plot(rlqmix, traits=tabBinary, ax=1, type="B", wh="T")
plot(rlqmix, traits=tabOrdinal[2:3], ax=1, type="O", wh="T")
plot(rlqmix, env=env, ax=1, type="Q", wh="E")

adegpar("plabels.optim" = O)
}

## End(Not run)
</code></pre>

<hr>
<h2 id='rockfish'>
Rockfish Phylogenetic Diversity in Southern California Bight
</h2><span id='topic+rockfish'></span>

<h3>Description</h3>

<p>The data set was analyzed in Pavoine et al. (2009) to determine whether the observed decrease in the number of individuals and species in the Southern California Bight through years due to fishing activities was accompanied by changes in the phylogenetic structure of the community.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("rockfish")</code></pre>


<h3>Format</h3>

<p>The format is a list of 3 objects:
</p>
<p><code>tre</code>, a string: the phylogenetic tree in newick format.
</p>
<p><code>fau</code>, a data frame with years as rows, species as columns (genus: Sebastes), and abundance as entries.
</p>
<p><code>traits</code>, a data frame with species as rows (same as in <code>fau</code>) and two variables as columns: <code>MaxSize</code>, the maximum body size; and <code>Vul</code>, an index of species' vulnerability.
</p>


<h3>Details</h3>

<p>The abundance data were obtained from the Marine Recreational Fishery Statistics Survey (MRFSS). We considered the compositions
of rockfish assemblages caught by party and charter boats with hooks and lines from 1980-1986, 1993-1994, 1996, 1998-2007. The phylogenetic tree was obtained from Hyde and Vetter (2007).</p>


<h3>Source</h3>

<p>Appendixes of Pavoine et al. (2009).
</p>


<h3>References</h3>

<p>Pavoine, S., Love, M., Bonsall, M. (2009) Hierarchical partitioning of evolutionary and ecological patterns in the organization of phylogenetically-structured species assemblages: application to rockfish (genus: <em>Sebastes</em>) in the Southern California Bight. <em>Ecology Letters</em>, <b>12</b>, 898&ndash;908.
</p>
<p>Hyde, J.R. and Vetter, R.D. (2007). The origin, evolution, and
diversification of rockfishes of the genus Sebastes (Cuvier). <em>Molecular Phylogenetics and Evolution</em>, <b>44</b>, 790&ndash;811.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
if(require(ape)){
data(rockfish)
phy &lt;- read.tree(text=rockfish$tre)
plot(phy)
}

## End(Not run)
</code></pre>

<hr>
<h2 id='RP15EI'>
Theoretical Data Set used in Ricotta and Pavoine (2015) in Ecological Indicators
</h2><span id='topic+RP15EI'></span>

<h3>Description</h3>

<p>The data set was used in Ricotta and Pavoine (2015) to show how the coefficients of multi-site dissimilarity that they developed can be applied to data.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("RP15EI")</code></pre>


<h3>Format</h3>

<p>The format is a list of 4 data frames. Each data frame gives the presence (1) and absence (0) of 10 species (columns, S1-S10) in 8 plots (rows P1-P8). These data are characterized by different levels of nestedness and turnover in species compositions between sites.
</p>
<p><code>M1</code>: Intermediate nestedness and turnover.
</p>
<p><code>M2</code>: Perfectly nested pattern.
</p>
<p><code>M3</code>: Very high species turnover.
</p>
<p><code>M4</code>: Random configuration.
</p>


<h3>Source</h3>

<p>Figure 1 of Ricotta and Pavoine (2015)
</p>


<h3>References</h3>

<p>Ricotta, C. and Pavoine, S. (2015) A multiple-site dissimilarity measure for species presence/absence data and its relationship with nestedness and turnover. <em>Ecological Indicators</em>, <b>54</b>,203&ndash;206.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(RP15EI)
betastatjac(RP15EI$M1)
</code></pre>

<hr>
<h2 id='RP15JVS'>
Theoretical Data Set used in Ricotta and Pavoine (2015) in Journal of Vegetation Science
</h2><span id='topic+RP15JVS'></span>

<h3>Description</h3>

<p>The data set was used in Ricotta and Pavoine (2015) to illustrate the relationships between the coefficients of similarity between communities that they developed. These data represent an artificial ecological gradient. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("RP15JVS")</code></pre>


<h3>Format</h3>

<p>The format is a list of four objects:
</p>
<p><code>ab</code>, a data frame with communities as rows, species as columns, and number of indivuduals as entries.
</p>
<p><code>D1</code>, a data frame of pairwise dissimilarities between species. In <code>D1</code>, dissimilarities reflect the species ecological differences along the artificial gradient of table <code>ab</code>: interspecies dissimilarities were set roughly proportional to the distance between the locations of the species optima and to the difference between their optimal abundances (see Ricotta and Pavoine 2015 for details).
</p>
<p><code>D2</code>, a data frame of pairwise dissimilarities between species. In <code>D2</code>, dissimilarities were randomly assigned using an even distribution.
</p>
<p><code>D3</code>, a data frame of pairwise dissimilarities between species. In <code>D3</code>, dissimilarities were uniformly set to 2/3.
</p>


<h3>Source</h3>

<p>Appendixes of Ricotta and Pavoine (2015)
</p>


<h3>References</h3>

<p>Ricotta, C. and Pavoine, S. (2015) Measuring similarity among plots including similarity among species: An extension of traditional approaches. <em>Journal of Vegetation Science</em>, <b>26</b>, 1061&ndash;1067
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(RP15JVS)
dissABC(RP15JVS$ab, RP15JVS$D1, method="J", option=1)
</code></pre>

<hr>
<h2 id='RPP16EE'>
Theoretical Data Set used in Ricotta et al. (2016) in Ecology and Evolution
</h2><span id='topic+RPP16EE'></span>

<h3>Description</h3>

<p>The data set was used in Ricotta et al. (2016) to show how the coefficients of plot-to-plot dissimilarity that they developed can be applied to data.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("RPP16EE")</code></pre>


<h3>Format</h3>

<p>The format is a list of 2 objects:
</p>
<p><code>Com</code>, a data frame. Artificial data table composed of 15 species (S1-S15) (columns) and 9 plots (P1-P9) (rows).
</p>
<p><code>Dis</code>, a data frame with the artificial dissimilarities between species.
</p>


<h3>Source</h3>

<p>Appendixes 1 and 2 of Ricotta et al. (2016)
</p>


<h3>References</h3>

<p>Ricotta, C., Podani, J., Pavoine, S. (2016) A family of functional dissimilarity measures for presence and absence data. <em>Ecology and Evolution</em>, <b>6</b>, 5383&ndash;5389.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(RPP16EE)
RPP16EE$Com
Jac(RPP16EE$Com)
## Not run: 
if(require(ade4) &amp;&amp; require(adegraphics)){
oldparamadeg &lt;- adegpar()
adegpar("plegend.drawKey" = FALSE)
table.value(RPP16EE$Com)
adegpar(oldparamadeg)
# In this graph, black squares indicate 
# which species (S1-S15) are present in which plot (P1-P9)
}

## End(Not run)
</code></pre>

<hr>
<h2 id='RutorGlacier'>
Functional and phylogenetic composition of plant communities along a primary succession on glacial deposits. 
</h2><span id='topic+RutorGlacier'></span>

<h3>Description</h3>

<p>59 plots, each of about 25 m2 in size, were sampled above the tree line at the foreland of the Rutor Glacier (Italy). The abundance of plant species were collected by Caccianiga et al. (2006); Ricotta et al. (2016) established trait data using Grime's (1974) plant strategy theory, Caccianiga et al. (2006) established morpho-functional traits, and Ricotta et al. (2015) the phylogenetic tree using the dated Daphne phylogeny (Durka and Michalski 2012) for European flora.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("RutorGlacier")</code></pre>


<h3>Format</h3>

<p><code>RutorGlacier</code> is a list of five components:
</p>
<p><code>Abund</code>, a data frame with plots as rows, species as columns and abundance of species in plots as entries.
</p>
<p><code>Traits</code>, a data frame with species as rows and three traits (named C, S, and R) as columns. Species were classified in terms of Grime's (1974) plant strategy theory, as competitors (C), stress tolerators (S) and ruderals (R) with fuzzy-coded values in the range 0-100, such that the sum of C+S+R was equal to 100.
</p>
<p><code>Traits2</code>, a data frame with species as rows and morpho-functional traits as columns. Traits are: <code>"C_height"</code> = canopy height (mm), <code>"LDMC"</code> = leaf dry matter content (%), <code>"LDW"</code> = leaf dry weight (mg), <code>"SLA"</code> = specific leaf area (mm^2 mg^-1), <code>"LNC"</code> = leaf nitrogen content (%), <code>"LCC"</code> = leaf carbon content (%), <code>"Flowering_period"</code> =  flowering period length (months), <code>"Flowering_start"</code> = flowering start (1 to 6 denote March to August, respectively), <code>"Lateral_spread"</code> = lateral spread (1 = plant short-lived, 2 = loosely tufted ramets (graminoids), compactly tufted, lacking thickened rootstock (non-graminoids), 3 = compactly tufted ramets (gram.), compactly tufted with thickened rootstock (non-gram.), 4 = shortly creeping (&lt;40 mm), 5 = creeping (40-79 mm), 6 = widely creeping (&gt;79 mm)),  CHMH = canopy height/maximum height ratio, <code>Succulence</code> = succulence index, <code>Clonality</code> = clonality (0 = sparse individuals, 1 = limited clonal growth, 2 = extensive clonal patches), <code>"NecroPersi"</code> = necromass persistence (0 = necromass absent, 1 = fibrous sheaths, 2 = entire persistent sheaths or leaves).
</p>
<p><code>TreeNW</code>, a phylogenetic tree in newick format for all plant species in <code>Abund</code> and <code>traits</code>.
</p>
<p><code>Fac</code>, a vector of strings defining in which successional stage each plot belongs to: &quot;early&quot; = early-successional stage, &quot;mid&quot; = mid-successional stage and &quot;late&quot; = late-successional stage.
</p>


<h3>References</h3>

<p>Caccianiga, M., Luzzaro, A., Pierce, S., Ceriani, R.M., Cerabolini, B.E.L. (2006) The functional basis of a primary succession resolved by CSR classification. <em>Oikos</em>, <b>112</b>, 10&ndash;20.
</p>
<p>Durka, W., Michalski, S.G. (2012) Daphne: a dated phylogeny of a large European flora for phylogenetically informed ecological analyses. <em>Ecology</em>, <b>93</b>, 2297.
</p>
<p>Grime, J.P. (1974) Vegetation classification by reference to strategies. <em>Nature</em>, <b>250</b>, 26&ndash;31.
</p>
<p>Ricotta, C., Bacaro, G., Caccianiga, M., Cerabolini, B.E.L., Moretti, M. (2015) A classical measure of phylogenetic dissimilarity and its relationship with beta diversity. <em>Basic and Applied Ecology</em>, <b>16</b>, 10&ndash;18.
</p>
<p>Ricotta, C., de Bello, F., Moretti, M., Caccianiga, M., Cerabolini, B.E.L., Pavoine, S. (2016) Measuring the functional redundancy of biological communities: a quantitative guide. <em>Methods in Ecology and Evolution</em>, <b>7</b>, 1386&ndash;1395.
</p>
<p>Ricotta, C., Laroche, F., Szeidl, L., Pavoine, S. (2020) From alpha to beta functional and phylogenetic redundancy. <em>Methods in Ecology and Evolution</em>. In press.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
if(require(ape) &amp;&amp; require(ade4)){
data(RutorGlacier)
phy &lt;- read.tree(text=RutorGlacier$TreeNW)
plot(phy)
ab &lt;- RutorGlacier$Abund[, phy$tip.label]
plot(abgevodivparam(phy, ab, q=0:4))

# Phylogenetic dissimilarities between plots
# (Ricotta et al. 2020)
Dp &lt;- DP(phy, ab, tol=0.00001)
pcoDp &lt;- dudi.pco(sqrt(Dp), full=TRUE)
s.class(pcoDp$li, as.factor(RutorGlacier$Fac))

# Phylogenetic beta uniqueness (Ricotta et al. 2020)
Up &lt;- betaTreeUniqueness(phy, ab, tol=0.00001)
# Average uniqueness between two plots at each successional stage
fac &lt;- as.factor(RutorGlacier$Fac)
mean(Up[fac == "early", fac == "early"])
mean(Up[fac == "mid", fac == "mid"])
mean(Up[fac == "late", fac == "late"])
}

## End(Not run)
</code></pre>

<hr>
<h2 id='speciesdiv'>
Indices of Species Diversity
</h2><span id='topic+speciesdiv'></span>

<h3>Description</h3>

<p>The function <code>speciesdiv</code> calculates diversity indices that rely on relative or absolute species abundance. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>speciesdiv(comm, method = "full", tol = 1e-8)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="speciesdiv_+3A_comm">comm</code></td>
<td>

<p>a data frame or a matrix typically with communities as rows, species as columns and presence/absence or abundance as entry. Note that with presence/absence (0/1) data, only species richness will be calculated correctly.
</p>
</td></tr>
<tr><td><code id="speciesdiv_+3A_method">method</code></td>
<td>

<p>a string or a vector of strings: one or several of &quot;richness&quot;, &quot;GiniSimpson&quot;, &quot;Simpson&quot;, &quot;Shannon&quot;, &quot;Margalef&quot;, &quot;Menhinick&quot;, &quot;McIntosh&quot;, &quot;full&quot;. See details.
</p>
</td></tr>
<tr><td><code id="speciesdiv_+3A_tol">tol</code></td>
<td>

<p>a tolerance threshold (a value between -<code>tol</code> and <code>tol</code> is considered equal to zero)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let <em>S_i</em> be the number of species in community <em>i</em>, <code class="reqn">n_{ij}</code> be the absolute abundance of species <em>j</em> in community <em>i</em>, <code class="reqn">N_i</code> the sum of all species abundance in community <em>i</em> (<code class="reqn">N_i=\sum_j n_{ij}</code>; the sum of row <em>i</em> in <code>comm</code>), <code class="reqn">p_{ij}</code> the relative abundance of species <em>j</em> in community <em>i</em> (<code class="reqn">p_{ij}=n_{ij}/N_i</code>).
If <code>method="richness"</code>, the diversity index is the number of species.
If <code>method="GiniSimpson"</code>, the diversity index is that of Gini (1912) and Simpson (1949): <code class="reqn">1-\sum_j p_{ij}^2</code>.
If <code>method="Simpson"</code>, the diversity index is (Simpson 1949): <code class="reqn">1/\sum_j p_{ij}^2</code>.
If <code>method="Shannon"</code>, the diversity index is that of Shannon (1948) with neperian logarithm: <code class="reqn">-\sum_j p_{ij}log(p_{ij})</code>.
If <code>method="Margalef"</code>, the diversity index is that of Margalef (1972): <code class="reqn">(S_i-1)/log(N_i)</code>.
If <code>method="Menhinick"</code>, the diversity index is that of Menhinick (1964): <code class="reqn">S_i/\sqrt{N_i}</code>.
If <code>method="McIntosh"</code>, the diversity index is that of McIntosh (1967): <code class="reqn">(N_i-\sqrt{\sum_j n_{ij}^2})/(N_i-\sqrt{N_i})</code>.
If one of the strings is &quot;full&quot;, then all indices are calculated.
</p>


<h3>Value</h3>

<p>Function <code>speciesdiv</code> returns a matrix with communities as rows and the diversity indices as columns. 
</p>


<h3>Author(s)</h3>

<p>Sandrine Pavoine <a href="mailto:sandrine.pavoine@mnhn.fr">sandrine.pavoine@mnhn.fr</a>
</p>


<h3>References</h3>

<p>Gini, C. (1912) Variabilita e mutabilita. Studi economicoaguridici delle facoltta di giurizprudenza dell, Universite di Cagliari III, Parte II.
</p>
<p>Magurran, A.E. (2004) Measuring biological diversity. Blackwell Publishing, Oxford, U.K.
</p>
<p>Margalef, R. (1972) Homage to Evelyn Hutchinson, or why is there an upper limit to diversity? <em>Transactions of the Connecticut Academy of Arts and Sciences</em>, <b>44</b>, 211&ndash;235.
</p>
<p>McIntosh, R.P. (1967) An index of diversity and the relation of certain concepts to diversity. <em>Ecology</em>, <b>48</b>, 392&ndash;404. 
</p>
<p>Menhinick, E.F. (1964) A Comparison of some species-individuals diversity indices applied to samples of field insects. <em>Ecology</em>, <b>45</b>, 859&ndash;861.
</p>
<p>Shannon, C.E. (1948) A mathematical theory of communication. <em>Bell System technical journal</em>, <b>27</b>, 379&ndash;423, 623&ndash;656.
</p>
<p>Simpson, E.H. (1949) Measurement of diversity. <em>Nature</em>, <b>163</b>, 688.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(batcomm)
ab &lt;- batcomm$ab
speciesdiv(ab)
</code></pre>

<hr>
<h2 id='specieseve'>
Indices of Species Evenvess
</h2><span id='topic+specieseve'></span>

<h3>Description</h3>

<p>The function <code>specieseve</code> calculates evenness indices that rely on relative or absolute species abundance. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>specieseve(comm, method = "full", tol = 1e-8)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="specieseve_+3A_comm">comm</code></td>
<td>

<p>a data frame or a matrix typically with communities as rows, species as columns and abundance as entry. 
</p>
</td></tr>
<tr><td><code id="specieseve_+3A_method">method</code></td>
<td>

<p>a string or a vector of strings: one or several of &quot;GiniSimpson&quot;, &quot;Simpson&quot;, &quot;Shannon&quot;, &quot;Heip&quot;, &quot;McIntosh&quot;, &quot;SmithWilson&quot;, &quot;full&quot;. See details.
</p>
</td></tr>
<tr><td><code id="specieseve_+3A_tol">tol</code></td>
<td>

<p>a tolerance threshold (a value between -<code>tol</code> and <code>tol</code> is considered equal to zero)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let <em>S_i</em> be the number of species in community <em>i</em>, <code class="reqn">n_{ij}</code> be the absolute abundance of species <em>j</em> in community <em>i</em>, <code class="reqn">N_i</code> the sum of all species abundance in community <em>i</em> (<code class="reqn">N_i=\sum_j n_{ij}</code>; the sum of row <em>i</em> in <code>comm</code>), <code class="reqn">p_{ij}</code> the relative abundance of species <em>j</em> in community <em>i</em> (<code class="reqn">p_{ij}=n_{ij}/N_i</code>).
If <code>method="GiniSimpson"</code>, the evenness index is that associated with Gini (1912) and Simpson (1949) diversity index: <code class="reqn">(1-\sum_j p_{ij}^2)*S_i/(S_i-1)</code>.
If <code>method="Simpson"</code>, the evenness index is (Simpson 1949; Magurran 2004): <code class="reqn">(1/\sum_j p_{ij}^2)/S_i</code>.
If <code>method="Shannon"</code>, the evenness index is that associated with Shannon (1948) diversity index with neperian logarithm: <code class="reqn">(-\sum_j p_{ij}ln(p_{ij}))/ln(S_i)</code>.
If <code>method="Heip"</code>, the evenness index is that of Heip (1974) (Magurran 2004): <code class="reqn">[exp(-\sum_j p_{ij}log(p_{ij})) - 1]/(S_i-1)</code>.
If <code>method="McIntosh"</code>, the evenness index is that of Pielou (1975) associated with McIntosh (1967) index of diversity: <code class="reqn">(N_i-\sqrt{\sum_j n_{ij}^2})/(N_i-N_i/\sqrt{S_i})</code>.
If <code>method="SmithWilson"</code>, the Smith and Wilson (1996) evenness index is calculated (Magurran 2004): <code class="reqn">1-[(2/\pi)(arctan(\sum_{j=1}^{S_i} (log n_{ij} - \sum_{k=1}^{S_i} log n_{ik}/S_i)^2/S_i))]</code>. The function uses neperian logarithm for all indices. If one of the strings is &quot;full&quot;, then all indices are calculated.
</p>


<h3>Value</h3>

<p>Function <code>specieseve</code> returns a matrix with communities as rows and the evenness indices as columns. 
</p>


<h3>Author(s)</h3>

<p>Sandrine Pavoine <a href="mailto:sandrine.pavoine@mnhn.fr">sandrine.pavoine@mnhn.fr</a>
</p>


<h3>References</h3>

<p>Gini, C. (1912) <em>Variabilita e mutabilita</em>. Studi economicoaguridici delle facoltta di giurizprudenza dell, Universite di Cagliari III, Parte II.
</p>
<p>Heip, C. (1974) A new index measuring evenness. <em>Journal of the Marine Biological Association UK</em>, <b>54</b>, 555&ndash;557.
</p>
<p>Magurran, A.E. (2004) <em>Measuring biological diversity</em>. Oxford, UK: Blackwell Publishing.
</p>
<p>McIntosh, R.P. (1967) An index of diversity and the relation of certain conepts to diversity. <em>Ecology</em>, <b>48</b>, 392&ndash;404. 
</p>
<p>Pielou, E.C. (1975) <em>Ecological diversity</em>. New York: Wiley InterScience.
</p>
<p>Shannon, C.E. (1948) A mathematical theory of communication. <em>Bell System technical journal</em>, <b>27</b>, 379&ndash;423, 623&ndash;656.
</p>
<p>Simpson, E.H. (1949) Measurement of diversity. <em>Nature</em>, <b>163</b>, 688.
</p>
<p>Smith, B. and Wilson, J.B. (1996) A consumer's guide to evenness measures. <em>Oikos</em>, <b>76</b>, 70&ndash;82.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(batcomm)
ab &lt;- batcomm$ab
specieseve(ab)
</code></pre>

<hr>
<h2 id='treeUniqueness'>
Community-level phylogenetic (or functional) redundancy
</h2><span id='topic+treeUniqueness'></span>

<h3>Description</h3>

<p>The function <code>treeUniqueness</code> calculates community-level phylogenetic (or tree-based) redundancy taking into account the branching pattern of the underlying phylogenetic tree (or any other tree, like a functional dendrogram).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>treeUniqueness(phyl, comm, index = 
    c("richness", "GiniSimpson", "Shannon"), tol = 0.001)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="treeUniqueness_+3A_phyl">phyl</code></td>
<td>

<p>an object inheriting the class <code>phylo</code> (see package ape), <code>phylo4</code> (see package phylobase), or <code>hclust</code>.
</p>
</td></tr>
<tr><td><code id="treeUniqueness_+3A_comm">comm</code></td>
<td>

<p>a data frame or a matrix typically with communities as rows, species as columns and presence/absence (1/0) or an index of abundance as entries. Species should be labeled as in the tree named <code>phyl</code> where they are the tips.
</p>
</td></tr>
<tr><td><code id="treeUniqueness_+3A_index">index</code></td>
<td>

<p>a string. <code>treeUniqueness</code> computes tree-based (phylogenetic) species richness (&quot;richness&quot;) or the tree-based analogue of the Shannon (shannon) or Gini-Simpson diversity (&quot;GiniSimpson&quot;); &quot;richness&quot; is assumed as the default value.
</p>
</td></tr>
<tr><td><code id="treeUniqueness_+3A_tol">tol</code></td>
<td>

<p>a numeric. A value between -tol and tol is considered as zero. See details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The tolerance threshold <code>tol</code> is particularly important if your tree is not exactly ultrametric due to approximation problems. In that case, the distance from tip to root varies according to the tip considered, although it should not (variations are due to approximation problems). A difference smaller than tol in the distance to root for two species will thus be considered as null.
</p>


<h3>Value</h3>

<p>An object of class <code>data.frame</code> is returned containing the following statistics:
</p>
<table role = "presentation">
<tr><td><code>DK</code></td>
<td>
<p>the present-day diversity of all plots in the data frame.</p>
</td></tr>
<tr><td><code>DP</code></td>
<td>
<p>the tree-based (phylogenetic) diversity <code class="reqn">D_P</code> of all plots in the data frame obtained by averaging the diversities <code class="reqn">D_k</code> over the corresponding tree periods after rescaling the tip-to-root length of the tree to unit (for details, see Ricotta et al. 2018).</p>
</td></tr>
<tr><td><code>U</code></td>
<td>
<p>tree-based (phylogenetic) uniqueness calculated as the ratio between tree-based (phylogenetic) diversity and present-day diversity <code class="reqn">D_P/D_K</code>.</p>
</td></tr>
<tr><td><code>R</code></td>
<td>
<p>tree-based (phylogenetic) redundancy, calculated as <code class="reqn">1-U</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ricotta et al. (2018) with modifications by Sandrine Pavoine <a href="mailto:sandrine.pavoine@mnhn.fr">sandrine.pavoine@mnhn.fr</a>
</p>


<h3>References</h3>

<p>Ricotta, C., Bacaro, G., Caccianiga, M., Cerabolini, B.E.L., Pavoine, S. (2018) A new method for quantifying the phylogenetic redundancy of biological communities. <em>Oecologia</em>, <b>186</b>, 339&ndash;346.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+uniqueness">uniqueness</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
if(require(ape)){
data(rockfish)
phy &lt;- read.tree(text = rockfish$tre)
R &lt;- treeUniqueness(phy, rockfish$fau, index = "Shannon")
}

## End(Not run)
</code></pre>

<hr>
<h2 id='twoHmax'>
Maximization of the Diversity Index TwoH
</h2><span id='topic+twoHmax'></span>

<h3>Description</h3>

<p>The R function <code>twoHmax</code> maximizes function 2H (Pavoine and Izsak 2014) for a given matrix <b>C</b> of (functional or phylogenetic) similarities between species. It is based on function <code>divcmax</code> of the ade4 package in R. As function <code>divcmax</code> of package ade4, function <code>twoHmax</code> uses an optimization technique based on Rosen's projection gradient algorithm and is verified using the Kuhn-Tucker conditions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>twoHmax(C, epsilon = 1e-08, smooth = TRUE, comment = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="twoHmax_+3A_c">C</code></td>
<td>

<p>a matrix that contains measures of the chosen intraspecific components (see functions <code>CFprop</code>, <code>multiCFprop</code>, <code>CFbinary</code>, <code>multiCFbinary</code>) on the diagonal and measures of interspecific components off diagonal. These interspecific components reflect functional or phylogenetic similarities among species.
</p>
</td></tr>
<tr><td><code id="twoHmax_+3A_epsilon">epsilon</code></td>
<td>

<p>a numeric tolerance threshold: a frequency is non null if it is higher than epsilon.
</p>
</td></tr>
<tr><td><code id="twoHmax_+3A_smooth">smooth</code></td>
<td>

<p>a logical value: if <code>TRUE</code>, the estimated positive proportions are checked and re-estimated with exact matrix products.</p>
</td></tr>
<tr><td><code id="twoHmax_+3A_comment">comment</code></td>
<td>

<p>a logical value indicating whether or not comments on the optimization technique should be printed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of two objects:
</p>
<table role = "presentation">
<tr><td><code>value</code></td>
<td>
<p>the maximum value of index 2H (see function <code>qHdiv</code>);</p>
</td></tr>
<tr><td><code>vector</code></td>
<td>
<p>a data frame with the vector pmax that maximizes index 2H (see function <code>qHdiv</code>).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sandrine Pavoine <a href="mailto:sandrine.pavoine@mnhn.fr">sandrine.pavoine@mnhn.fr</a>
</p>
<p>The code is a modification of function divcmax of package ade4 written by Stephane Champely.
</p>


<h3>References</h3>

<p>Pavoine, S. and Izsak, J. (2014) New biodiversity measure that includes consistent interspecific and intraspecific components. <em>Methods in Ecology and Evolution</em>, <b>5</b>, 165&ndash;172.</p>


<h3>See Also</h3>

<p><code><a href="#topic+qHdiv">qHdiv</a></code>, <code><a href="#topic+CFprop">CFprop</a></code>, <code><a href="#topic+CFbinary">CFbinary</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
if(require(ape)){

tre &lt;-"((((((sA:4,sB:1):1,sC:3):2,((sD:2,sE:1):1,sF:1):2):1,sG:7):1,sH:1):3,(sI:2,sJ:1):2):0;"
#The number of tips is kept in parameter n:
n&lt;-10
# Next we need to obtain matrix CP. 
phyape &lt;- read.tree(text = tre)
plot(phyape)
CP &lt;- vcv(phyape)
WP &lt;- diag(diag(CP))
# With this particular illustration, a maximizing vector, 
# for 2H used with CP, that does not contain any zero can be found. 
# This maximizing vector can thus be obtained directly, 
# instead of being estimated. Two equivalent equations 
# have been given to obtain the maximizing vector in 
# Appendix S1 of Pavoine and Izsak (2014). 
# We use the first one below
Pmax&lt;-(solve(CP^2)%*%diag(CP))/sum(solve(CP^2)%*%diag(CP))
Pmax

# The second equation equivalently provides
Z &lt;- ((diag(1/sqrt(diag(CP))))%*%CP%*%(diag(1/sqrt(diag(CP)))))^2
Pmax&lt;-(solve(WP)%*%solve(Z)%*%rep(1,n))/sum(solve(WP)%*%solve(Z))
Pmax

# Applied to our case study, the function twoHmax provides good approximations
twoHmax(CP)

# Redundancy among variables:
data(rhone, package="ade4")
V &lt;- rhone$tab
# First consider the covariances among the variables:
C &lt;- cov(V)
# A vector that maximizes 2H applied to C is estimated as follows:
pmax_covariances &lt;- twoHmax(C)$vector
dotchart(as.matrix(pmax_covariances))

# If we apply 2H only to the diagonal matrix with the variances 
# of the variables, the vector that maximizes 2H is:
W &lt;- diag(diag(C))
rownames(W)&lt;-colnames(W)&lt;-rownames(C)
pmax_variances &lt;- twoHmax(W)$vector
dotchart(as.matrix(pmax_variances))

# If C contains the correlations among variables, 
# a vector that maximizes 2H applied to C is estimated as follows:
C &lt;- cor(V)
pmax_correlations &lt;- twoHmax(C)$vector
dotchart(as.matrix(pmax_correlations))


# By attributing equal weights to the variables, 
# 2H applied to the correlation matrix measures 
# the number of effective variables:
# from 0 if all variables are completely correlated 
# with each other to n if they are not correlated. 
# Similarly, by attributing equal weights to the variables, 
# 2H applied to the covariance matrix measures
# the effective amount of variation:
# from 0 if all variables are completely correlated 
# with each other to n if they are not correlated 
# and have similar variances.

#Even if the data set contains 15 variables, 
# the effective number of variables is lower.
C &lt;- cor(V)
equalproportions &lt;- cbind.data.frame(rep(1/ncol(C), ncol(C)))
names(equalproportions) &lt;- "equalprop"
equalproportions &lt;- t(equalproportions)
qHdiv(equalproportions, C)

# When considering the covariances among species, 
# instead of the correlations, the effective number 
# of variables is even lower, indicating also an imbalance 
# in the variances of the variables.
C &lt;- cov(V)
qHdiv(equalproportions, C)

}

## End(Not run)
</code></pre>

<hr>
<h2 id='uniqueness'>
Functional Uniqueness and Functional Redundancy of Biological Communities
</h2><span id='topic+uniqueness'></span>

<h3>Description</h3>

<p>The function <code>Uniqueness</code> calculates community-level functional uniqueness and redundancy.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>uniqueness(comm, dis, tol = 1e-08, abundance = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="uniqueness_+3A_comm">comm</code></td>
<td>

<p>a matrix or a data frame containing the abundance or incidence (0/1) of species in communities (or plots). Columns are species and communities are rows.
</p>
</td></tr>
<tr><td><code id="uniqueness_+3A_dis">dis</code></td>
<td>

<p>an object of class <code>dist</code> containing the functional distances among species. Values in dis must be bounded between 0 and 1. If they are not bounded, the function divides all values in dis by the highest observed value in dis.</p>
</td></tr>
<tr><td><code id="uniqueness_+3A_tol">tol</code></td>
<td>

<p>a tolerance threshold (a value between -<code>tol</code> and <code>tol</code> is considered as null).
</p>
</td></tr>
<tr><td><code id="uniqueness_+3A_abundance">abundance</code></td>
<td>

<p>a logical. If <code>TRUE</code>, abundance data are used when available; if <code>FALSE</code>, incidence (0/1) data are used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function uniqueness returns a list of three data frames:
</p>
<p><code>kbar</code>: this first data frame gives values for Ricotta et al. (2016) coefficient <code class="reqn">\bar{K}_i</code>'s per species (rows) and community (columns).
</p>
<p><code>V</code>: this second data frame gives values for Ricotta et al. (2016) coefficient <code class="reqn">V_i</code>'s per species (rows) and community (columns).
</p>
<p><code>red</code>: this third data set gives values, per community, for Ricotta et al. (2016) coefficients <code>N</code> (species richness), <code>Q</code> (quadratic diversity), <code>D</code> (Simpson diversity), <code>U=Q/D</code>  (uniqueness), <code>R=1-U</code>  (redundancy), and Pavoine and Ricotta (2019) <code>Ustar=(1-D)/(1-Q)</code>  (uniqueness) and <code>Rstar=1-Ustar</code> (redundancy); in this third data frame, coefficients are columns and communities are rows, the coefficients are thus calculated per community only.
</p>


<h3>Author(s)</h3>

<p>Sandrine Pavoine <a href="mailto:sandrine.pavoine@mnhn.fr">sandrine.pavoine@mnhn.fr</a>
</p>


<h3>References</h3>

<p>Ricotta, C., de Bello, F., Moretti, M., Caccianiga, M., Cerabolini, B.E., Pavoine, S. (2016). Measuring the functional redundancy of biological communities: A quantitative guide. <em>Methods in Ecology and Evolution</em>, <b>7</b>, 1386&ndash;1395.
</p>
<p>Pavoine, S., Ricotta, C. (2019). A simple translation from indices of species diversity to indices of phylogenetic diversity. <em>Ecological Indicators</em>, <b>101</b>, 552&ndash;561.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+QE">QE</a></code>, <code><a href="#topic+treeUniqueness">treeUniqueness</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(RDMCCP16)
uniqueness(RDMCCP16$ab, as.dist(RDMCCP16$dis))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
