<!DOCTYPE html><html><head><title>Help for package esmtools</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {esmtools}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#add_script_to_rmd'><p>Add Custom CSS and JavaScript to R Markdown Document</p></a></li>
<li><a href='#button'><p>Create an HTML button with optional toggleable content</p></a></li>
<li><a href='#calendar_plot'><p>Generate a calendar plot</p></a></li>
<li><a href='#codebook_table'><p>Create Codebook Table</p></a></li>
<li><a href='#controws'><p>Get Context of Rows</p></a></li>
<li><a href='#dataInfo'><p>Display information regarding the dataset in a succinct way.</p></a></li>
<li><a href='#endbutton'><p>End the HTML button container</p></a></li>
<li><a href='#esmdata_preprocessed'><p>Preprocessed ESM data set</p></a></li>
<li><a href='#esmdata_raw'><p>Raw ESM data set</p></a></li>
<li><a href='#esmdata_sim'><p>Simulated ESM Data Set</p></a></li>
<li><a href='#folrows'><p>Extract Following Rows from a Dataframe</p></a></li>
<li><a href='#getEsmtoolsEnv'><p>Get the internal package environment</p></a></li>
<li><a href='#heatcalendar_plot'><p>Generate a heatmap calendar plot</p></a></li>
<li><a href='#longstring'><p>Calculate Longstring Value</p></a></li>
<li><a href='#participants_book'><p>Generate a participants' book</p></a></li>
<li><a href='#print.dataInfo'><p>Print method of the dataInfo object</p></a></li>
<li><a href='#randrows'><p>Randomly Sample Rows from a Dataframe</p></a></li>
<li><a href='#txt'><p>Custom Text for Rmarkdown with Counting</p></a></li>
<li><a href='#use_template'><p>Import esmtools RMarkdown Templates</p></a></li>
<li><a href='#vars_consist'><p>Create Unique Values Dataframe</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Preprocessing Experience Sampling Method (ESM) Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jordan Revol &lt;jordan.revol@kuleuven.be&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Tailored explicitly for Experience Sampling Method (ESM)
    data, it contains a suite of functions designed to simplify
    preprocessing steps and create subsequent reporting. It empowers
    users with capabilities to extract critical insights during
    preprocessing, conducts thorough data quality assessments (e.g., design
    and sampling scheme checks, compliance rate, careless responses), and
    generates visualizations and concise summary tables tailored
    specifically for ESM data. Additionally, it streamlines the creation
    of informative and interactive preprocessing reports, enabling
    researchers to transparently share their dataset preprocessing
    methodologies. Finally, it is part of a larger ecosystem which
    includes a framework and a web gallery
    (<a href="https://preprocess.esmtools.com/">https://preprocess.esmtools.com/</a>).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://gitlab.kuleuven.be/ppw-okpiv/researchers/u0148925/esmtools/">https://gitlab.kuleuven.be/ppw-okpiv/researchers/u0148925/esmtools/</a>,
<a href="https://package.esmtools.com/">https://package.esmtools.com/</a>, <a href="https://preprocess.esmtools.com/">https://preprocess.esmtools.com/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://gitlab.kuleuven.be/ppw-okpiv/researchers/u0148925/esmtools/-/issues">https://gitlab.kuleuven.be/ppw-okpiv/researchers/u0148925/esmtools/-/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>base64enc (&ge; 0.1-3), dplyr (&ge; 1.1.0), DT (&ge; 0.28), fs (&ge;
1.6.0), ggplot2 (&ge; 3.4.0), ggpubr (&ge; 0.6.0), grDevices,
htmltools, jsonlite (&ge; 1.8.0), kableExtra (&ge; 1.3.0), knitr
(&ge; 1.43), lubridate (&ge; 1.9.0), stats, stringr (&ge; 1.5.0),
tidyr (&ge; 1.3.0), tools</td>
</tr>
<tr>
<td>Suggests:</td>
<td>readxl (&ge; 1.4.2), spelling, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-13 18:26:54 UTC; Jr</td>
</tr>
<tr>
<td>Author:</td>
<td>Jordan Revol <a href="https://orcid.org/0000-0001-5511-3617"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre, cph],
  Koen Niemeijer <a href="https://orcid.org/0000-0002-0816-534X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-13 19:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='add_script_to_rmd'>Add Custom CSS and JavaScript to R Markdown Document</h2><span id='topic+add_script_to_rmd'></span>

<h3>Description</h3>

<p>This function adds custom CSS and JavaScript code to an R Markdown document.
The function reads CSS and JavaScript code from specific files (e.g., 'button.css'
and 'button.js') located in the &quot;esmtools&quot; package. It then creates appropriate
HTML elements to include the code within the R Markdown document.
This function is automatically called when importing the esmtools package and
rendering the rmarkdown package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_script_to_rmd()
</code></pre>


<h3>Value</h3>

<p>Returns an text object marked as HTML containing the combined CSS and JavaScript code stored within the inst folder of the package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (interactive()) {
  add_script_to_rmd()
}

</code></pre>

<hr>
<h2 id='button'>Create an HTML button with optional toggleable content</h2><span id='topic+button'></span>

<h3>Description</h3>

<p>This function generates an HTML button with optional toggleable content.
When used in an RMarkdown document, the content following the button will be hidden
by default and can be toggled on and off by clicking the button.
To use it, simply call the function within inline R code, do not call this function within a chunk.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>button(text = "Description")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="button_+3A_text">text</code></td>
<td>
<p>The text to display on the button. Default is &quot;Description&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character string containing the HTML code for the button and optional
toggleable content. In RMarkdown, this will be displayed as an HTML button.
In regular R scripts, this function will return an empty string.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># In RMarkdown, use inline code (e.g., `r button()` and `r endbutton()`)
# to create a toggleable button.

if (interactive()) {
  button("Supplementary materials")
  # Hidden content goes here.
  endbutton()
}

</code></pre>

<hr>
<h2 id='calendar_plot'>Generate a calendar plot</h2><span id='topic+calendar_plot'></span>

<h3>Description</h3>

<p>The 'calendar_plot()' function creates a calendar visualization that displays the number of occurrences of beeps over one or more years in a calendar format.
The function utilizes the 'ggplot2' package to create the calendar plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calendar_plot(
  .data,
  timevar = NULL,
  interval = "halfyear",
  week_start = getOption("lubridate.week.start", 1),
  weight_heights = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calendar_plot_+3A_.data">.data</code></td>
<td>
<p>A dataframe that contains the time variable</p>
</td></tr>
<tr><td><code id="calendar_plot_+3A_timevar">timevar</code></td>
<td>
<p>The time variable name</p>
</td></tr>
<tr><td><code id="calendar_plot_+3A_interval">interval</code></td>
<td>
<p>Specifies the time interval over which to group and display data in the calendar plot, with options &quot;halfyear&quot; (default) or &quot;year.&quot;</p>
</td></tr>
<tr><td><code id="calendar_plot_+3A_week_start">week_start</code></td>
<td>
<p>When set to 1 (by default), the week starts on Monday, when set to 7, the week starts on Sunday following USA calendar.</p>
</td></tr>
<tr><td><code id="calendar_plot_+3A_weight_heights">weight_heights</code></td>
<td>
<p>A list of weights for adjusting the height of individual plots in the output. Default is NULL.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The 'calendar_plot()' function generates a calendar plot where each cell represents a day of the year,
and the color intensity of the cell (and the occurence number if text_count=TRUE) reflects the number of beep occurrences on that day.
This allows for easy identification of patterns and trends in beep occurrences over time.
</p>


<h3>Value</h3>

<p>A ggplot object, a calendar plot.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (interactive()) {
  esmdata_sim$sent &lt;- as.POSIXct(esmdata_sim$sent)
  calendar_plot(esmdata_sim, timevar = "sent", interval = "halfyear")
  calendar_plot(esmdata_sim, timevar = "sent", interval = "year")
}

</code></pre>

<hr>
<h2 id='codebook_table'>Create Codebook Table</h2><span id='topic+codebook_table'></span>

<h3>Description</h3>

<p>The <code>codebook_table()</code> function generates a codebook table for a given dataframe,
providing descriptive statistics and visualizations for each variable.
See an example here: <a href="https://preprocess.esmtools.com/pages/90_Codebook_table_esmtools.html">https://preprocess.esmtools.com/pages/90_Codebook_table_esmtools.html</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>codebook_table(
  df,
  origin_cbook = NULL,
  origin_vars = "Variable",
  n_unique_thres = 6,
  include_txt = FALSE,
  include_date = TRUE,
  histograms = TRUE,
  boxplots = TRUE,
  html_output = NULL,
  kable_out = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="codebook_table_+3A_df">df</code></td>
<td>
<p>The dataframe for which the codebook table is generated.</p>
</td></tr>
<tr><td><code id="codebook_table_+3A_origin_cbook">origin_cbook</code></td>
<td>
<p>A dataframe of a hand-maid codebook table that is stored in an csv of xlsx file.
The file must be first imported in the R session.
If the variable containing the basis codebook, the resulting codebook table will include
the original codebook information.
This allows merging and incorporating a hand-made codebook into the output.
Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="codebook_table_+3A_origin_vars">origin_vars</code></td>
<td>
<p>A character string specifying the name of the variable column in the <code>origin_cbook</code>.
Default is &quot;Variable&quot;.</p>
</td></tr>
<tr><td><code id="codebook_table_+3A_n_unique_thres">n_unique_thres</code></td>
<td>
<p>The threshold for the number of unique values to consider a variable as categorical.
Default is 6.</p>
</td></tr>
<tr><td><code id="codebook_table_+3A_include_txt">include_txt</code></td>
<td>
<p>Logical indicating whether to include text variable statistics in the codebook table.
Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="codebook_table_+3A_include_date">include_date</code></td>
<td>
<p>Logical indicating whether to include date variable statistics in the codebook table.
Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="codebook_table_+3A_histograms">histograms</code></td>
<td>
<p>Logical indicating whether to include histograms in the codebook table.
Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="codebook_table_+3A_boxplots">boxplots</code></td>
<td>
<p>Logical indicating whether to include boxplots in the codebook table.
Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="codebook_table_+3A_html_output">html_output</code></td>
<td>
<p>Define a file name (e.g., &quot;path/to/codebook_table.html&quot;) to create an html output version of the codebook table.</p>
</td></tr>
<tr><td><code id="codebook_table_+3A_kable_out">kable_out</code></td>
<td>
<p>When TRUE, output is in kable version. If FALSE, use DT package.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A a codebook table generated using kable or the DT package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (interactive()) {
 # Load library 
 library(esmtools)
 library(readxl) 

 # Load the hand-made codebook
 path_original &lt;- system.file("extdata", "cbook_part1.xlsx", package = "esmtools")
 original_codebook &lt;- read_excel(path_original)

 # Create codebook table based on the hand-made codebook and the dataset
 codebook_table(df = esmdata_sim, origin_cbook = original_codebook)
}
</code></pre>

<hr>
<h2 id='controws'>Get Context of Rows</h2><span id='topic+controws'></span>

<h3>Description</h3>

<p>This function extracts specific rows from a data frame along with their context, based on a given range.
It can take either a vector of row numbers or a boolean vector as input. Additionally, the function allows
specifying the direction of the context (above, below, or both) and marks each row as either targeted or context.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>controws(data, input, context = 1, direction = "both")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="controws_+3A_data">data</code></td>
<td>
<p>A data frame from which rows and their context will be extracted.</p>
</td></tr>
<tr><td><code id="controws_+3A_input">input</code></td>
<td>
<p>A numeric vector of row numbers or a logical vector. If a logical vector is given, the function
will extract rows where the vector is TRUE.</p>
</td></tr>
<tr><td><code id="controws_+3A_context">context</code></td>
<td>
<p>An integer specifying the number of rows above and/or below the target row to include as context.
Default is 1.</p>
</td></tr>
<tr><td><code id="controws_+3A_direction">direction</code></td>
<td>
<p>A character string specifying the direction of context to include. Valid options are &quot;up&quot; for
rows above, &quot;down&quot; for rows below, and &quot;both&quot; for both directions. Default is &quot;both&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe containing the targeted rows and their contextual rows. An additional column
'.RowType' indicates whether it is a row given as input (&quot;-&gt;&quot;) or part of the context (&quot;&quot;).
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example dataframe
data &lt;- data.frame(matrix(rnorm(100), ncol = 5))

# Get context for rows 8 and 15 (using row numbers)
result &lt;- controws(data, c(8, 15), 1, "both")
result

</code></pre>

<hr>
<h2 id='dataInfo'>Display information regarding the dataset in a succinct way.</h2><span id='topic+dataInfo'></span>

<h3>Description</h3>

<p>The 'dataInfo()' function displays detailed information about a dataset in a similar style as 'sessionInfo()'.
It provides various details such as size, creation and update times,
number of columns and rows, number of participants, variable names, and more.
This information is useful for reproducibility, tracking the dataset, and ensuring transparency in data analysis workflows.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dataInfo(
  file_path = NULL,
  read_fun = NULL,
  idvar = NULL,
  timevar = NULL,
  validvar = NULL,
  citation = NULL,
  URL = NULL,
  DOI = NULL,
  path = TRUE,
  variables = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dataInfo_+3A_file_path">file_path</code></td>
<td>
<p>The path or URL of the dataset file.</p>
</td></tr>
<tr><td><code id="dataInfo_+3A_read_fun">read_fun</code></td>
<td>
<p>The function used to read the dataset file.</p>
</td></tr>
<tr><td><code id="dataInfo_+3A_idvar">idvar</code></td>
<td>
<p>The identifier variable(s) in the dataset, represented as a character vector.</p>
</td></tr>
<tr><td><code id="dataInfo_+3A_timevar">timevar</code></td>
<td>
<p>A time variable(s) name in the dataset. Preference is to use the sent timestamp variable (the time when the beep was sent to the participant).</p>
</td></tr>
<tr><td><code id="dataInfo_+3A_validvar">validvar</code></td>
<td>
<p>The validation variable name in the dataset, represented as a numerical vector. If NULL, the function do not display compliance rate information.</p>
</td></tr>
<tr><td><code id="dataInfo_+3A_citation">citation</code></td>
<td>
<p>A character element to cite the article or document associated with the script.</p>
</td></tr>
<tr><td><code id="dataInfo_+3A_url">URL</code></td>
<td>
<p>The citation information for the dataset (article associated), represented as a character string. If NULL, the function will not display the citation information.</p>
</td></tr>
<tr><td><code id="dataInfo_+3A_doi">DOI</code></td>
<td>
<p>The Digital Object Identifier (DOI) of the dataset, if applicable. If NULL, the function will not display the DOI information.</p>
</td></tr>
<tr><td><code id="dataInfo_+3A_path">path</code></td>
<td>
<p>If TRUE, the function will display the path information.</p>
</td></tr>
<tr><td><code id="dataInfo_+3A_variables">variables</code></td>
<td>
<p>A logical value indicating whether to display the names of the dataset's variables. Set to TRUE to display variable information, and FALSE to omit it. The default is TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The 'dataInfo()' function provides a comprehensive summary of information about the dataset. The information returned includes:
</p>

<ul>
<li><p> Size: The size of the dataset in octets.
</p>
</li>
<li><p> File extension
</p>
</li>
<li><p> Creation and Update Times: The date and time when the data file was created and last updated.
</p>
</li>
<li><p> Number of Columns and Rows
</p>
</li>
<li><p> Number of Participants
</p>
</li>
<li><p> Average Observations per Participant
</p>
</li>
<li><p> Compliance Mean: The mean compliance value for the dataset.
</p>
</li>
<li><p> Data Collection Period: The duration or period during which the data was collected.
</p>
</li>
<li><p> Path: The path or URL of the dataset file.
</p>
</li>
<li><p> Variable Names: The names of the variables in the dataset.
</p>
</li>
<li><p> Associated Links: Any associated URL, DOI, or citation links for the dataset.
</p>
</li></ul>



<h3>Value</h3>

<p>The 'dataInfo()' function displays detailed information about the dataset. It can also be store as a list in a variable.
</p>
<p>A kable object that summarizes the information on the data, the current R session, and the article or document associated with the script.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)

# Load data
file_path &lt;- system.file("extdata", "esmdata_sim.csv", package = "esmtools")

# Create a function to read the data
read_fun &lt;- function(x) read.csv2(x) %&gt;% 
    mutate(sent = as.POSIXct(as.character(sent), format="%Y-%m-%d %H:%M:%S"))

# Get data information
dataInfo(
  file_path = file_path, read_fun = read_fun,
  idvar = "id", timevar = "sent"
)
</code></pre>

<hr>
<h2 id='endbutton'>End the HTML button container</h2><span id='topic+endbutton'></span>

<h3>Description</h3>

<p>This function ends the HTML container for the button and optional toggleable content
created using the 'button()' function. When used in an RMarkdown document,
it closes the container and ensures proper rendering.
To use it, simply call the function within inline R code, do not call this function within a chunk.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>endbutton()
</code></pre>


<h3>Value</h3>

<p>A character string containing the closing HTML tags for the button container.
In RMarkdown, this will ensure that the content following the button is properly
displayed. In regular R scripts, this function will return an empty string.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># In RMarkdown, use inline code (e.g., `r button()` and `r endbutton()`)
# to create a toggleable button.

if (interactive()) {
  button("Supplementary materials")
  # Hidden content goes here.
  endbutton()
}

</code></pre>

<hr>
<h2 id='esmdata_preprocessed'>Preprocessed ESM data set</h2><span id='topic+esmdata_preprocessed'></span>

<h3>Description</h3>

<p>This dataset has undergone random value alterations to ensure privacy and cannot be utilized for formal research purposes.
For additional information, refer to the associated article.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>esmdata_preprocessed
</code></pre>


<h3>Format</h3>

<p>A data frame with 6 rows and 20 columns:
</p>

<dl>
<dt>dyad</dt><dd><p>Dyad identification number</p>
</dd>
<dt>id</dt><dd><p>Participant identification number</p>
</dd>
<dt>role</dt><dd><p>Role of a participant within a dyad, indicated by a character (0=father or 1=mother)</p>
</dd>
<dt>age</dt><dd><p>Age of the participant</p>
</dd>
<dt>compliance</dt><dd><p>Participant's proportion of completed surveys</p>
</dd>
<dt>obsno</dt><dd><p>ESM questionnaire (beep) number indicating serial order</p>
</dd>
<dt>daycum</dt><dd><p>Cumulative day count</p>
</dd>
<dt>beepno</dt><dd><p>Beep number within a day</p>
</dd>
<dt>valid</dt><dd><p>Indicator of observation validity (1=valid, 0=invalid)</p>
</dd>
<dt>scheduled</dt><dd><p>Timestamps (e.g., “2023/04/14 10:23:47”) of when the ESM questionnaire was scheduled </p>
</dd>
<dt>sent</dt><dd><p>Timestamps (e.g., “2023/04/14 10:23:47”) of when the ESM questionnaire was sent </p>
</dd>
<dt>start</dt><dd><p>Timestamps (e.g., “2023/04/14 10:23:47”) of when the ESM questionnaire was opened by the participant </p>
</dd>
<dt>end</dt><dd><p>Timestamps (e.g., “2023/04/14 10:23:47”) of when the ESM questionnaire was ended by the participant </p>
</dd>
<dt>pos_aff</dt><dd><p>Positive affect score (0-100)</p>
</dd>
<dt>neg_aff</dt><dd><p>Negative affect score (0-100)</p>
</dd>
<dt>perc_stress_child</dt><dd><p>parents reported if their child did experience a stressful event since the last beep</p>
</dd>
<dt>perc_fun_child</dt><dd><p>parents reported if their child had experienced anything fun since the last beep (yes/no)</p>
</dd>
<dt>perc_fun_signaled</dt><dd><p>parents rated to which extent their child showed they experienced this fun event (0-100)</p>
</dd>
<dt>pos_aff_pc</dt><dd><p>Person-centered positive affect score</p>
</dd>
<dt>neg_aff_pc</dt><dd><p>Person-centered negative affect score</p>
</dd>
</dl>


<hr>
<h2 id='esmdata_raw'>Raw ESM data set</h2><span id='topic+esmdata_raw'></span>

<h3>Description</h3>

<p>Raw dataset from a pilot ESM study.
This dataset has undergone random value alterations to ensure privacy and cannot be utilized for formal research purposes.
For additional information, refer to the associated article.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>esmdata_raw
</code></pre>


<h3>Format</h3>

<p>A data frame with 6 rows and 13 columns:
</p>

<dl>
<dt>dyad</dt><dd><p>Dyad identification number</p>
</dd>
<dt>id</dt><dd><p>Participant identification number</p>
</dd>
<dt>role</dt><dd><p>Role of a participant within a dyad, indicated by a character (0=father or 1=mother)</p>
</dd>
<dt>age</dt><dd><p>Age of the participant</p>
</dd>
<dt>scheduled</dt><dd><p>Timestamps (e.g., “2023/04/14 10:23:47”) of when the ESM questionnaire was scheduled </p>
</dd>
<dt>sent</dt><dd><p>Timestamps (e.g., “2023/04/14 10:23:47”) of when the ESM questionnaire was sent </p>
</dd>
<dt>start</dt><dd><p>Timestamps (e.g., “2023/04/14 10:23:47”) of when the ESM questionnaire was opened by the participant </p>
</dd>
<dt>end</dt><dd><p>Timestamps (e.g., “2023/04/14 10:23:47”) of when the ESM questionnaire was ended by the participant </p>
</dd>
<dt>pos_aff</dt><dd><p>Positive affect score (0-100)</p>
</dd>
<dt>neg_aff</dt><dd><p>Negative affect score (0-100)</p>
</dd>
<dt>perc_stress_child</dt><dd><p>parents reported if their child did experience a stressful event since the last beep</p>
</dd>
<dt>perc_fun_child</dt><dd><p>parents reported if their child had experienced anything fun since the last beep (yes/no)</p>
</dd>
<dt>perc_fun_signaled</dt><dd><p>parents rated to which extent their child showed they experienced this fun event (0-100)</p>
</dd>
</dl>


<hr>
<h2 id='esmdata_sim'>Simulated ESM Data Set</h2><span id='topic+esmdata_sim'></span>

<h3>Description</h3>

<p>Mimic the structure of a dataset from a heterosexual romantic couples study (i.e., ESM dyadic design).
This simulated study focuses on the emotional affect dynamics of romantic partners taking into account
the context (location and contact with the partner). In addition, this study assumes that couples are
randomized into two treatments. Thus, the dataset includes a baseline phase and a treatment phase,
where couples are randomly allocated to one of the two treatments. Here are the general characteristics
of the dataset.
More information on: <a href="https://preprocess.esmtools.com/terminology.html/">https://preprocess.esmtools.com/terminology.html/</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>esmdata_sim
</code></pre>


<h3>Format</h3>

<p>A data frame with 4200 rows and 18 columns:
</p>

<dl>
<dt>dyad</dt><dd><p>Dyad identification number</p>
</dd>
<dt>id</dt><dd><p>Participant identification number</p>
</dd>
<dt>role</dt><dd><p>Role of a participant within a dyad (make the partner distinguishable)</p>
</dd>
<dt>age</dt><dd><p>Age of the participant</p>
</dd>
<dt>cond_dyad</dt><dd><p>Treatment condition to which the dyad was assigned, as follows: 0=control group and 1=experimental group</p>
</dd>
<dt>obsno</dt><dd><p>ESM questionnaire (beep) number of the observation that indicates their serial order</p>
</dd>
<dt>scheduled</dt><dd><p>Timestamps (e.g., “2023/04/14 10:23:47”) of when the ESM questionnaire was scheduled</p>
</dd>
<dt>sent</dt><dd><p>Timestamps (e.g., “2023/04/14 10:23:47”) of when the ESM questionnaire was sent</p>
</dd>
<dt>start</dt><dd><p>Timestamps (e.g., “2023/04/14 10:23:47”) of when the ESM questionnaire was opened by the participant</p>
</dd>
<dt>end</dt><dd><p>Timestamps (e.g., “2023/04/14 10:23:47”) of when the ESM questionnaire was item ended by the participant</p>
</dd>
<dt>PA1</dt><dd><p>A positive affect (PA) item with a slider scale (1-100)</p>
</dd>
<dt>PA2</dt><dd><p>A positive affect (PA) item with a slider scale (1-100)</p>
</dd>
<dt>PA3</dt><dd><p>A positive affect (PA) item with a slider scale (1-100)</p>
</dd>
<dt>NA1</dt><dd><p>A negative affect (NA) item with a slider scale (1-100)</p>
</dd>
<dt>NA2</dt><dd><p>A negative affect (NA) item with a slider scale (1-100)</p>
</dd>
<dt>NA3</dt><dd><p>A negative affect (NA) item with a slider scale (1-100)</p>
</dd>
<dt>location</dt><dd><p>Categorical item with 4 possible answers (home, work, public space, other)</p>
</dd>
<dt>contact</dt><dd><p>Dichotomous item (1=contact, 0=no contact)</p>
</dd>
</dl>


<hr>
<h2 id='folrows'>Extract Following Rows from a Dataframe</h2><span id='topic+folrows'></span>

<h3>Description</h3>

<p>The <code>folrows()</code> function extracts a specified number of consecutive rows,
including the starting row, from a dataframe.
Rows are selected consecutively from randomly chosen starting positions.
The function ensures that the selected rows fall within the valid row range of the dataframe.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>folrows(.data, n = 5, nb_sample = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="folrows_+3A_.data">.data</code></td>
<td>
<p>The dataframe from which rows are to be extracted.</p>
</td></tr>
<tr><td><code id="folrows_+3A_n">n</code></td>
<td>
<p>The number of consecutive rows to be extracted, including the starting row.
Default is 5.</p>
</td></tr>
<tr><td><code id="folrows_+3A_nb_sample">nb_sample</code></td>
<td>
<p>The number of random starting positions to be sampled.
Default is 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe containing the consecutive rows extracted from the randomly chosen starting positions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Extract 3 consecutive rows starting from a random position in the dataset
folrows(esmdata_sim, n = 3)

# Extract 4 consecutive rows starting from 2 random positions in a custom dataframe
folrows(esmdata_sim, n = 4, nb_sample = 2)

</code></pre>

<hr>
<h2 id='getEsmtoolsEnv'>Get the internal package environment</h2><span id='topic+getEsmtoolsEnv'></span>

<h3>Description</h3>

<p>This function provides access to the internal environment used by
the esmtools package. This environment is used for internal state
management and should be used with caution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getEsmtoolsEnv()
</code></pre>


<h3>Value</h3>

<p>An environment object used internally by the esmtools package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>esmtools_env &lt;- getEsmtoolsEnv()
print(esmtools_env)
</code></pre>

<hr>
<h2 id='heatcalendar_plot'>Generate a heatmap calendar plot</h2><span id='topic+heatcalendar_plot'></span>

<h3>Description</h3>

<p>The 'heatcalendar_plot()' function creates a heatmap-style calendar visualization that represents the density of events over time.
Each cell in the heatmap represents a specific day, and its color intensity reflects the number of events that occurred on that day.
This function utilizes the 'ggplot2' R package to create the heatmap calendar plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>heatcalendar_plot(
  .data,
  timevar = NULL,
  week_start = getOption("lubridate.week.start", 1)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="heatcalendar_plot_+3A_.data">.data</code></td>
<td>
<p>A dataframe that contains the time variable</p>
</td></tr>
<tr><td><code id="heatcalendar_plot_+3A_timevar">timevar</code></td>
<td>
<p>The time variable name</p>
</td></tr>
<tr><td><code id="heatcalendar_plot_+3A_week_start">week_start</code></td>
<td>
<p>When set to 1 (by default), the week starts on Monday, when set to 7, the week starts on Sunday following USA calendar.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The 'heatcalendar_plot()' function generates a heatmap-style calendar plot where each cell corresponds to a day of the year. The color intensity of each cell represents the event density, allowing for the identification of patterns and trends in event occurrences over time.
</p>


<h3>Value</h3>

<p>A heatmap calendar plot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (interactive()) {
  esmdata_sim$sent &lt;- as.POSIXct(as.character(esmdata_sim$sent))
  heatcalendar_plot(esmdata_sim, timevar = "sent")
}
</code></pre>

<hr>
<h2 id='longstring'>Calculate Longstring Value</h2><span id='topic+longstring'></span>

<h3>Description</h3>

<p>This function calculates the longstring value for a given vector of values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>longstring(x, tolerance = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="longstring_+3A_x">x</code></td>
<td>
<p>A vector of values for which the longstring value needs to be calculated.</p>
</td></tr>
<tr><td><code id="longstring_+3A_tolerance">tolerance</code></td>
<td>
<p>An optional parameter indicating the tolerance for considering consecutive values as equal (default is NULL).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe containing the following information:
</p>

<dl>
<dt>val</dt><dd><p>The longstring value(s) based on the most frequent value(s) or the unique value(s).</p>
</dd>
<dt>longstr</dt><dd><p>The length of the longest run of consecutive values.</p>
</dd>
<dt>avgstr</dt><dd><p>The average length of non-NA runs of consecutive values (not computed when tolerance is used).</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>df &lt;- data.frame(
  rbind(
    c(1, 1, 2, 2, 2, 3, 3, 3, 3),
    c(1, 2, 3, 4, 4, 4, 4, 2, 6)
  )
)
# Example 1: Without tolerance
longstring(df)

# Example 2: With tolerance
longstring(df, tolerance = 1)

</code></pre>

<hr>
<h2 id='participants_book'>Generate a participants' book</h2><span id='topic+participants_book'></span>

<h3>Description</h3>

<p>The 'participants_book()' function creates a participants' book, which provides a concise summary of participants' data
from an intensive longitudinal study, such as Experience Sampling Method (ESM).
The book is generated using the DT package, and each participant is represented by a row in the table.
The participants' book displays various information about participants' response behaviors, including compliance rate,
study duration, and start time. Additionally, it provides descriptive statistics and time series plots for the variables of interest.
See an example here: <a href="https://preprocess.esmtools.com/pages/90_Participant_book.html">https://preprocess.esmtools.com/pages/90_Participant_book.html</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>participants_book(
  df,
  idvar = "id",
  obsnovar = "obsno",
  focusvar = NULL,
  timevar = NULL,
  validvar = NULL,
  compliancevar = NULL,
  obsno_max = NULL,
  list_behaviors = c("min_date", "max_date", "nb_answer", "compliance"),
  list_stats = c("mean", "sd", "n_length", "n_unique"),
  viz = list(c("ts", "hist")),
  html_output = NULL,
  kable_out = TRUE,
  min_max_regularize = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="participants_book_+3A_df">df</code></td>
<td>
<p>A dataframe containing the participant data</p>
</td></tr>
<tr><td><code id="participants_book_+3A_idvar">idvar</code></td>
<td>
<p>The name of the column in the dataframe that represents the participant identifier</p>
</td></tr>
<tr><td><code id="participants_book_+3A_obsnovar">obsnovar</code></td>
<td>
<p>The name of the column in the dataframe that represents the beep number</p>
</td></tr>
<tr><td><code id="participants_book_+3A_focusvar">focusvar</code></td>
<td>
<p>A vector of variable names representing the variables of interest in the dataframe</p>
</td></tr>
<tr><td><code id="participants_book_+3A_timevar">timevar</code></td>
<td>
<p>The name of the column in the dataframe that represents the timestamp</p>
</td></tr>
<tr><td><code id="participants_book_+3A_validvar">validvar</code></td>
<td>
<p>The name of the column in the dataframe that represents the validity of responses</p>
</td></tr>
<tr><td><code id="participants_book_+3A_compliancevar">compliancevar</code></td>
<td>
<p>The name of the column in the dataframe that represents the compliance rate (alternatively, if NULL, the compliance score is computed as the number of rows divided by obsno_max)</p>
</td></tr>
<tr><td><code id="participants_book_+3A_obsno_max">obsno_max</code></td>
<td>
<p>The maximum number of beeps for computing the compliance score (only used if compliancevar is NULL)</p>
</td></tr>
<tr><td><code id="participants_book_+3A_list_behaviors">list_behaviors</code></td>
<td>
<p>A vector indicating the types of participants' response behavior information to display. Valid options are &quot;min_date&quot;, &quot;max_date&quot;, &quot;nb_answer&quot;, and &quot;compliance&quot;.</p>
</td></tr>
<tr><td><code id="participants_book_+3A_list_stats">list_stats</code></td>
<td>
<p>A vector indicating the types of descriptive statistics to display. Valid options are &quot;mean&quot;, &quot;sd&quot;, &quot;range&quot;, &quot;n_length&quot;, and &quot;n_unique&quot;.</p>
</td></tr>
<tr><td><code id="participants_book_+3A_viz">viz</code></td>
<td>
<p>A vector indicating the visualization type to display for each focusvar variable. Valid options are &quot;ts&quot; (time series plot) and &quot;hist&quot; (histogram).</p>
</td></tr>
<tr><td><code id="participants_book_+3A_html_output">html_output</code></td>
<td>
<p>Define a file name (e.g., &quot;path/to/participant_book.html&quot;) to create an html output version of the participant book.</p>
</td></tr>
<tr><td><code id="participants_book_+3A_kable_out">kable_out</code></td>
<td>
<p>When TRUE, output is in kable version. If FALSE, use DT package.</p>
</td></tr>
<tr><td><code id="participants_book_+3A_min_max_regularize">min_max_regularize</code></td>
<td>
<p>Whether to regularize the y-axis or x-axis limits across plots based on the global minimum and maximum values. Default is TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A kable or datatable object (from the DT package), representing the participants' book.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 participants_book(esmdata_preprocessed,
   idvar = "id",
   obsnovar = "obsno",
   focusvar = c("pos_aff", "neg_aff"),
   timevar = "start",
   validvar = "valid",
   obsno_max = 70,
   list_behaviors = c("min_date", "max_date", "nb_answer", "compliance"),
   list_stats = c("mean", "sd", "range", "n_length", "n_unique"),
   viz = list(c("ts", "hist"), c("ts", "hist"))
 )


</code></pre>

<hr>
<h2 id='print.dataInfo'>Print method of the dataInfo object</h2><span id='topic+print.dataInfo'></span>

<h3>Description</h3>

<p>This function provides a customized print method for objects created by the 'dataInfo()' function.
It displays each element of the data information list in a user-friendly format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dataInfo'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.dataInfo_+3A_x">x</code></td>
<td>
<p>A list of data information from the 'dataInfo' function.</p>
</td></tr>
<tr><td><code id="print.dataInfo_+3A_...">...</code></td>
<td>
<p>Dots are for compatibility and not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns the kable object invisibly from the 'dataInfo()' function, allowing for its use in further function calls or
command chaining without printing the object again.
</p>

<hr>
<h2 id='randrows'>Randomly Sample Rows from a Dataframe</h2><span id='topic+randrows'></span>

<h3>Description</h3>

<p>The <code>randrows()</code> function randomly samples a specified number of rows from a dataframe.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>randrows(.data, n = 5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="randrows_+3A_.data">.data</code></td>
<td>
<p>The dataframe from which rows are to be sampled.</p>
</td></tr>
<tr><td><code id="randrows_+3A_n">n</code></td>
<td>
<p>The number of rows to be randomly sampled. Default is 5.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe containing the randomly sampled rows.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Randomly sample 3 rows from the dataset
randrows(esmdata_sim, n = 3)
</code></pre>

<hr>
<h2 id='txt'>Custom Text for Rmarkdown with Counting</h2><span id='topic+txt'></span>

<h3>Description</h3>

<p>This function generates custom text and provides the option to include an
optional count that can be integrated into the text. It creates an HTML
span element with a unique identifier (ID). This identifier can be used for
customizing the appearance of the text using CSS code. Default identifiers are &quot;text_issue&quot;, &quot;text_inspect&quot;, &quot;text_mod&quot;.
To use it, simply call the function within inline code, do not call this function within a chunk.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>txt(
  id = "text_issue",
  title = "Issue",
  text = "",
  count = TRUE,
  output_file = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="txt_+3A_id">id</code></td>
<td>
<p>A character string specifying the unique identifier for the HTML span element. Default identifiers are &quot;text_issue&quot;, &quot;text_inspect&quot;, &quot;text_mod&quot;.</p>
</td></tr>
<tr><td><code id="txt_+3A_title">title</code></td>
<td>
<p>A character string containing the text to display.</p>
</td></tr>
<tr><td><code id="txt_+3A_text">text</code></td>
<td>
<p>Descriptive text.</p>
</td></tr>
<tr><td><code id="txt_+3A_count">count</code></td>
<td>
<p>A logical value indicating whether to include a count in the text.</p>
</td></tr>
<tr><td><code id="txt_+3A_output_file">output_file</code></td>
<td>
<p>A character string specifying the json file should be created.
If not provided, the template will be copied to the current working directory.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character string containing the HTML span element with the specified ID and text.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (interactive()) {
  # In RMarkdown, use 'r txt()`.
  # Do not call this function within a chunk

  txt("text_issue", "Issue", text = "Wrong participant number")
  txt("text_mod", "Modification", text = "Change the participant number from 1 to 32", 
      count = FALSE)
}

</code></pre>

<hr>
<h2 id='use_template'>Import esmtools RMarkdown Templates</h2><span id='topic+use_template'></span>

<h3>Description</h3>

<p>The <code>use_template()</code> function allows you to copy esmtools RMarkdown templates
from the package to your working directory for further customization and usage.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>use_template(template_name, output_dir, overwrite = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="use_template_+3A_template_name">template_name</code></td>
<td>
<p>A character string specifying the name of the template to be copied.
Valid options are &quot;preprocess_esm&quot;, &quot;advanced_preprocess_esm&quot;, and &quot;data_characteristics_report&quot;.</p>
</td></tr>
<tr><td><code id="use_template_+3A_output_dir">output_dir</code></td>
<td>
<p>A mandatory character string specifying the directory where the template should be copied.</p>
</td></tr>
<tr><td><code id="use_template_+3A_overwrite">overwrite</code></td>
<td>
<p>Logical indicating whether to overwrite existing files with the same name in the output directory.
Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Invisible <code>NULL</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (interactive()) {
  # Copy and paste the "preprocess_esm" template to the current working directory
  use_template("preprocess_esm")

  # Copy and paste the "advanced_preprocess_esm" template to a specific directory
  use_template("advanced_preprocess_esm", output_dir = "/path/to/templates")

  # Copy and paste the "data_characteristics_report" template to the current working directory
  # and overwrite existing file (if any).
  use_template("data_characteristics_report", overwrite = TRUE)
}
</code></pre>

<hr>
<h2 id='vars_consist'>Create Unique Values Dataframe</h2><span id='topic+vars_consist'></span>

<h3>Description</h3>

<p>This function takes a dataframe, a group variable, and a vector of variables. It creates a new dataframe that contains unique values for each variable within each group modality.
Only one group variable should be used, otherwise, an error will be thrown.
The resulting dataframe has the group variable as the first column and each variable's unique values as subsequent columns.
The <code>merge_val</code> function is applied to merge the unique values within each group.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vars_consist(.df, group, vars, max_length = 4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vars_consist_+3A_.df">.df</code></td>
<td>
<p>A dataframe containing the data.</p>
</td></tr>
<tr><td><code id="vars_consist_+3A_group">group</code></td>
<td>
<p>The name of the group variable.</p>
</td></tr>
<tr><td><code id="vars_consist_+3A_vars">vars</code></td>
<td>
<p>A vector of variable names to consider.</p>
</td></tr>
<tr><td><code id="vars_consist_+3A_max_length">max_length</code></td>
<td>
<p>The maximum length of the merged values. If the length of the merged values exceeds this value, the values are truncated and an ellipsis is added at the end. Default is 4.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with unique values for each variable within each group modality.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>vars_consist(esmdata_sim, group = "id", vars = c("age", "cond_dyad"))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
