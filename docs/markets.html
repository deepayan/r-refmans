<!DOCTYPE html><html><head><title>Help for package markets</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {markets}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#coef'><p>Market fit coefficients</p></a></li>
<li><a href='#equation_classes'><p>Equation classes</p></a></li>
<li><a href='#estimate'><p>Model estimation</p></a></li>
<li><a href='#formula,market_model-method'><p>Market model formula</p></a></li>
<li><a href='#houses'><p>Credit market data for US housing starts</p></a></li>
<li><a href='#logLik.market_fit'><p>Log likelihood of a fitted market model</p></a></li>
<li><a href='#marginal_effects'><p>Marginal effects</p></a></li>
<li><a href='#market_aggregation'><p>Market side aggregation</p></a></li>
<li><a href='#market_descriptives'><p>Market force data descriptive statistics</p></a></li>
<li><a href='#market_fit-class'><p>Market model fit</p></a></li>
<li><a href='#market_models'><p>Market model classes</p></a></li>
<li><a href='#market_quantities'><p>Estimated market quantities</p></a></li>
<li><a href='#market_simulation'><p>Market model simulation</p></a></li>
<li><a href='#markets'><p>Estimation of models for markets in equilibrium and disequilibrium</p></a></li>
<li><a href='#model_description'><p>Short model and market descriptions</p></a></li>
<li><a href='#model_initialization'><p>Model initialization</p></a></li>
<li><a href='#model_likelihoods'><p>Model likelihoods and derivatives</p></a></li>
<li><a href='#model_logger-class'><p>Logger class</p></a></li>
<li><a href='#ncoef'><p>Number of coefficients</p></a></li>
<li><a href='#nobs,market_model-method'><p>Number of observations</p></a></li>
<li><a href='#plot,market_fit-method'><p>Plots the fitted model</p></a></li>
<li><a href='#shortage_analysis'><p>Analysis of shortages</p></a></li>
<li><a href='#show,market_model-method'><p>Prints a short description of the model</p></a></li>
<li><a href='#single_call_estimation'><p>Single call estimation</p></a></li>
<li><a href='#summary'><p>Model and fit summaries</p></a></li>
<li><a href='#system_classes'><p>System classes</p></a></li>
<li><a href='#variable_names'><p>Variable name access</p></a></li>
<li><a href='#vcov,market_fit-method'><p>Variance-covariance matrix for a fitted market model</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Estimation Methods for Markets in Equilibrium and Disequilibrium</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.5</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-02-17</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides estimation methods for markets in equilibrium and
    disequilibrium. Supports the estimation of an equilibrium and
    four disequilibrium models with both correlated and independent shocks.
    Also provides post-estimation analysis tools, such as aggregation,
    marginal effect, and shortage calculations. See Karapanagiotis (2024)
    &lt;<a href="https://doi.org/10.18637%2Fjss.v108.i02">doi:10.18637/jss.v108.i02</a>&gt; for an overview of the functionality 
    and examples. The estimation methods are based on full information
    maximum likelihood techniques given in
    Maddala and Nelson (1974) &lt;<a href="https://doi.org/10.2307%2F1914215">doi:10.2307/1914215</a>&gt;. They are implemented
    using the analytic derivative expressions calculated in
    Karapanagiotis (2020) &lt;<a href="https://doi.org/10.2139%2Fssrn.3525622">doi:10.2139/ssrn.3525622</a>&gt;. Standard
    errors can be estimated by adjusting for heteroscedasticity or clustering.
    The equilibrium estimation constitutes a case of a system of linear,
    simultaneous equations. Instead, the disequilibrium models replace the
    market-clearing condition with a non-linear,
    short-side rule and allow for different specifications of price dynamics. </td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/pi-kappa-devel/markets/">https://github.com/pi-kappa-devel/markets/</a>,
<a href="https://markets.pikappa.eu/">https://markets.pikappa.eu/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/pi-kappa-devel/markets/issues">https://github.com/pi-kappa-devel/markets/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr (&ge; 0.7.6), Formula, MASS (&ge; 7.3-50), methods, rlang
(&ge; 0.2.1), Rcpp, RcppGSL, RcppParallel, stats</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Suggests:</td>
<td>ggplot2 (&ge; 3.0.0), knitr (&ge; 1.20), numDeriv (&ge;
2016.8.1.1), rmarkdown (&ge; 1.10), testthat (&ge; 2.0.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Collate:</td>
<td>'data.R' 'equation_base.R' 'system_base.R' 'model_logger.R'
'market_model.R' 'disequilibrium_model.R' 'diseq_basic.R'
'diseq_deterministic_adjustment.R' 'diseq_directional.R'
'diseq_stochastic_adjustment.R' 'equation_basic.R'
'equation_deterministic_adjustment.R' 'equation_directional.R'
'equation_stochastic_adjustment.R' 'equilibrium_model.R'
'system_basic.R' 'gradient_basic.R'
'system_deterministic_adjustment.R'
'gradient_deterministic_adjustment.R' 'system_directional.R'
'gradient_directional.R' 'system_equilibrium.R'
'gradient_equilibrium.R' 'system_stochastic_adjustment.R'
'gradient_stochastic_adjustment.R' 'hessian_basic.R'
'hessian_directional.R' 'likelihood_basic.R'
'likelihood_deterministic_adjustment.R'
'likelihood_directional.R' 'likelihood_equilibrium.R'
'likelihood_stochastic_adjustment.R' 'market_fit.R' 'markets.R'
'model_simulation.R'</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppGSL</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-16 23:59:51 UTC; ntelispak</td>
</tr>
<tr>
<td>Author:</td>
<td>Pantelis Karapanagiotis
    <a href="https://orcid.org/0000-0001-9871-1908"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Pantelis Karapanagiotis &lt;pikappa.devel@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-17 10:50:07 UTC</td>
</tr>
</table>
<hr>
<h2 id='coef'>Market fit coefficients</h2><span id='topic+coef'></span><span id='topic+coef+2Cmarket_fit-method'></span><span id='topic+coefficients+2Cmarket_fit-method'></span>

<h3>Description</h3>

<p>Returns the coefficients of the fitted market model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'market_fit'
coef(object)

## S4 method for signature 'market_fit'
coefficients(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef_+3A_object">object</code></td>
<td>
<p>A fitted model object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named vector of estimated model coefficients.
</p>


<h3>Methods (by class)</h3>


<ul>
<li> <p><code>coef(market_fit)</code>: Estimated coefficients.
</p>
</li>
<li> <p><code>coefficients(market_fit)</code>: Estimated coefficients alias.
</p>
</li></ul>


<h3>Examples</h3>

<pre><code class='language-R'>
# estimate a model using the houses dataset
fit &lt;- diseq_deterministic_adjustment(
  HS | RM | ID | TREND ~
    RM + TREND + W + CSHS + L1RM + L2RM + MONTH |
      RM + TREND + W + L1RM + MA6DSF + MA3DHF + MONTH,
  fair_houses(),
  correlated_shocks = FALSE,
  estimation_options = list(control = list(maxit = 1e+6))
)

# access the estimated coefficients
coef(fit)
coefficients(fit)

</code></pre>

<hr>
<h2 id='equation_classes'>Equation classes</h2><span id='topic+equation_classes'></span><span id='topic+equation_basic-class'></span><span id='topic+equation_deterministic_adjustment-class'></span><span id='topic+equation_directional-class'></span><span id='topic+equation_stochastic_adjustment-class'></span>

<h3>Description</h3>

<p>Classes with data and functionality describing equations of model systems.
</p>


<h3>Details</h3>



<h4><code>equation_base</code></h4>

<p>Equation base class</p>



<h4><code>equation_basic</code></h4>

<p>Basic disequilibrium model equation class</p>



<h4><code>equation_deterministic_adjustment</code></h4>

<p>Deterministic adjustment disequilibrium model equation class</p>



<h4><code>equation_directional</code></h4>

<p>Directional disequilibrium model equation class</p>



<h4><code>equation_stochastic_adjustment</code></h4>

<p>Stochastic adjustment disequilibrium model equation class</p>



<h3>Slots</h3>


<dl>
<dt><code>formula</code></dt><dd><p>The equation formula using prefixed variables.</p>
</dd>
<dt><code>name</code></dt><dd><p>The name of the equation.</p>
</dd>
<dt><code>variable_prefix</code></dt><dd><p>A prefix string for the variables of the equation.</p>
</dd>
<dt><code>dependent_vector</code></dt><dd><p>The vector of the response.</p>
</dd>
<dt><code>independent_matrix</code></dt><dd><p>A model data matrix with columns corresponding to the set
of independent variables.</p>
</dd>
<dt><code>price_vector</code></dt><dd><p>The vector of prices.</p>
</dd>
<dt><code>control_matrix</code></dt><dd><p>A model data matrix with columns corresponding to the set
of independent variables without prices.</p>
</dd>
<dt><code>alpha_beta</code></dt><dd><p>A vector of right hand side coefficients.</p>
</dd>
<dt><code>alpha</code></dt><dd><p>The price coefficient.</p>
</dd>
<dt><code>beta</code></dt><dd><p>A vector of right hand side coefficient without the price coefficient.</p>
</dd>
<dt><code>var</code></dt><dd><p>The variance of the equation's shock.</p>
</dd>
<dt><code>sigma</code></dt><dd><p>The standard deviation of the equation's shock.</p>
</dd>
<dt><code>h</code></dt><dd><p style="text-align: center;"><code class="reqn">h_{x} = \frac{x - \mathrm{E} x}{\sqrt{\mathrm{Var} x}}</code>
</p>
</dd>
<dt><code>z</code></dt><dd><p style="text-align: center;"><code class="reqn">z_{xy} = \frac{h_{x} - \rho_{xy}h_{y}}{\sqrt{1 - \rho_{xy}^2}}</code>
</p>
</dd>
<dt><code>psi</code></dt><dd><p style="text-align: center;"><code class="reqn">\psi_{x} = \phi(h_{x})</code>
</p>
</dd>
<dt><code>Psi</code></dt><dd><p style="text-align: center;"><code class="reqn">\Psi_{x} = 1 - \Phi(z_{xy})</code>
</p>
</dd>
<dt><code>mu_Q</code></dt><dd><p style="text-align: center;"><code class="reqn">\mu_{Q} = \mathrm{E}Q</code>
</p>
</dd>
<dt><code>var_Q</code></dt><dd><p style="text-align: center;"><code class="reqn">V_{Q} = \mathrm{Var}Q</code>
</p>
</dd>
<dt><code>sigma_Q</code></dt><dd><p style="text-align: center;"><code class="reqn">\sigma_{Q} = \sqrt{\mathrm{Var}Q}</code>
</p>
</dd>
<dt><code>rho_QP</code></dt><dd><p style="text-align: center;"><code class="reqn">\rho_{Q} =
\frac{\mathrm{Cov}(Q,P)}{\sqrt{\mathrm{Var}Q\mathrm{Var}P}}</code>
</p>
</dd>
<dt><code>rho_1QP</code></dt><dd><p style="text-align: center;"><code class="reqn">\rho_{1,QP} = \frac{1}{\sqrt{1 - \rho_{QP}}}</code>
</p>
</dd>
<dt><code>rho_2QP</code></dt><dd><p style="text-align: center;"><code class="reqn">\rho_{2,QP} = \rho_{QP}\rho_{1,QP}</code>
</p>
</dd>
<dt><code>sigma_QP</code></dt><dd><p style="text-align: center;"><code class="reqn">\sigma_{QP} = \mathrm{Cov}(Q,P)</code>
</p>
</dd>
<dt><code>h_Q</code></dt><dd><p>As in slot <code>h</code></p>
</dd>
<dt><code>z_PQ</code></dt><dd><p>As in slot <code>z</code></p>
</dd>
<dt><code>z_QP</code></dt><dd><p>As in slot <code>z</code></p>
</dd>
<dt><code>separation_subset</code></dt><dd><p>A vector of indicators specifying the observations of the
sample described by this equation according to the separation rule of the model.</p>
</dd>
</dl>

<hr>
<h2 id='estimate'>Model estimation</h2><span id='topic+estimate'></span><span id='topic+estimate+2Cmarket_model-method'></span><span id='topic+estimate+2Cequilibrium_model-method'></span>

<h3>Description</h3>

<p>All models are estimated using full information maximum likelihood. The
<code><a href="#topic+equilibrium_model-class">equilibrium_model</a></code> can also be estimated using two-stage
least squares. The maximum likelihood estimation is based on
<code><a href="stats.html#topic+optim">optim</a></code>. If no starting values are provided, the function uses
linear regression estimates as initializing values. The default optimization method is
BFGS. For other alternatives see <code><a href="stats.html#topic+optim">optim</a></code>. The implementation of
the two-stage least square estimation of the <code><a href="#topic+equilibrium_model-class">equilibrium_model</a></code>
is based on <code><a href="stats.html#topic+lm">lm</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimate(object, ...)

## S4 method for signature 'market_model'
estimate(
  object,
  gradient = "calculated",
  hessian = "calculated",
  standard_errors = "homoscedastic",
  ...
)

## S4 method for signature 'equilibrium_model'
estimate(object, method = "BFGS", optimizer = "optim", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estimate_+3A_object">object</code></td>
<td>
<p>A model object.</p>
</td></tr>
<tr><td><code id="estimate_+3A_...">...</code></td>
<td>
<p>Additional parameter used in the model's estimation. These are
passed further down to the optimization call. For the
<code><a href="#topic+equilibrium_model-class">equilibrium_model</a></code> model, the parameters are passed to
<code><a href="stats.html#topic+lm">lm</a></code>, if the method is set to
<code>2SLS</code>, or to <code><a href="stats.html#topic+optim">optim</a></code> for any other method. For the rest of
the models, the parameters are passed to <code><a href="stats.html#topic+optim">optim</a></code>.</p>
</td></tr>
<tr><td><code id="estimate_+3A_gradient">gradient</code></td>
<td>
<p>One of two potential options: <code>"numerical"</code> and
<code>"calculated"</code>. By default, all the models are estimated using the
analytic expressions of their likelihoods' gradients.</p>
</td></tr>
<tr><td><code id="estimate_+3A_hessian">hessian</code></td>
<td>
<p>One of three potential options: <code>"skip"</code>,
<code>"numerical"</code>, and <code>"calculated"</code>. The default is to use the
<code>"calculated"</code> Hessian for the models that expressions are
available and the <code>"numerical"</code> Hessian in other cases. Calculated
Hessian expressions are available for the basic and directional models.</p>
</td></tr>
<tr><td><code id="estimate_+3A_standard_errors">standard_errors</code></td>
<td>
<p>One of three potential options:
<code>"homoscedastic"</code>, <code>"heteroscedastic"</code>, or a vector with
variables names for which standard error clusters are to be created. The
default value is <code>"homoscedastic"</code>. If the option
<code>"heteroscedastic"</code> is passed, the variance-covariance matrix is
calculated using heteroscedasticity adjusted (Huber-White) standard errors.
If a vector with variable names is supplied, the variance-covariance
matrix is calculated by grouping the score matrix based on the
passed variables.</p>
</td></tr>
<tr><td><code id="estimate_+3A_method">method</code></td>
<td>
<p>A string specifying the estimation method. When the passed value is
among <code>"Nelder-Mead"</code>, <code>"BFGS"</code>, <code>"CG"</code>, <code>"L-BFGS-B"</code>,
<code>"SANN"</code>, and <code>"Brent"</code>, the model is estimated using
full information maximum likelihood based on <code><a href="stats.html#topic+optim">optim</a></code> functionality.
When <code>"2SLS"</code> is supplied, the model is estimated using two-stage least squares
via <code><a href="stats.html#topic+lm">lm</a></code>. In this case, the function returns a
list containing the first and second stage estimates. The default value is
<code>"BFGS"</code>.</p>
</td></tr>
<tr><td><code id="estimate_+3A_optimizer">optimizer</code></td>
<td>
<p>One of two options:
<code>"optim"</code>, <code>"gsl"</code>. The default value is <code>"optim"</code>. If the
option <code>"gsl"</code> is set, the equilibrium likelihood is maximized using
<a href="https://www.gnu.org/software/gsl/doc/html/multimin.html"><code>GSL</code></a>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The likelihood of the equilibrium model can be optimized either by using <code>optim</code>
(the default option) or native
<a href="https://www.gnu.org/software/gsl/doc/html/multimin.html"><code>GSL</code></a> routines.
The caller can override the default behavior by setting the <code>optimizer</code> argument
equal to <code>"gsl"</code>, in which case <code>GSL</code> routines are used. This does not
necessarily result to faster execution times. This functionality is primarily
intended for advanced usage. The <code><a href="stats.html#topic+optim">optim</a></code> functionality is a fast,
analysis-oriented alternative, which is more suitable for most use case.
</p>
<p>When <code>optimizer = "gsl"</code> is used, the only available optimization method is BFGS.
Additionally, the caller needs to specify in the control list values for the
optimization step (<code>step</code>), the objective's optimization tolerance
(<code>objective_tolerance</code>), the gradient's optimization tolerance
(<code>gradient_tolerance</code>, and the maximum allowed number of iterations (<code>maxit</code>).
If the <code>GSL</code> library is not available in the calling machine, the function
returns a trivial result list with convergence status set equal to -1. If the
<a href="https://en.cppreference.com/w/cpp/algorithm/execution_policy_tag_t">C++17 execution policies</a>
are available, the implementation of the optimization is parallelized.
</p>


<h3>Value</h3>

<p>A market fit object holding the estimation result.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>estimate(market_model)</code>: Full information maximum likelihood estimation.
</p>
</li>
<li> <p><code>estimate(equilibrium_model)</code>: Equilibrium model estimation.
</p>
</li></ul>


<h3>Examples</h3>

<pre><code class='language-R'>
# initialize the model using the houses dataset
model &lt;- new(
  "diseq_deterministic_adjustment", # model type
  subject = ID, time = TREND, quantity = HS, price = RM,
  demand = RM + TREND + W + CSHS + L1RM + L2RM + MONTH,
  supply = RM + TREND + W + L1RM + MA6DSF + MA3DHF + MONTH,
  fair_houses(), # data
  correlated_shocks = FALSE # let shocks be independent
)

# estimate the model object (BFGS is used by default)
fit &lt;- estimate(model)

# estimate the model by specifying the optimization details passed to the optimizer.
fit &lt;- estimate(model, control = list(maxit = 1e+6))

# summarize results
summary(fit)


# simulate an equilibrium model
model &lt;- simulate_model(
  "equilibrium_model", list(
    # observed entities, observed time points
    nobs = 500, tobs = 3,
    # demand coefficients
    alpha_d = -1.9, beta_d0 = 24.9, beta_d = c(2.3, -1.2), eta_d = c(2.0, -1.5),
    # supply coefficients
    alpha_s = .9, beta_s0 = 8.2, beta_s = c(3.3), eta_s = c(1.5, -2.2)
  ),
  seed = 99
)

# maximize the model's log-likelihood
fit &lt;- estimate(
  model,
  optimizer = "gsl", control = list(
    step = 1e-2, objective_tolerance = 1e-8,
    gradient_tolerance = 1e-2, maxit = 1e+3
  )
)

summary(fit)

</code></pre>

<hr>
<h2 id='formula+2Cmarket_model-method'>Market model formula</h2><span id='topic+formula+2Cmarket_model-method'></span><span id='topic+market_model_formula'></span>

<h3>Description</h3>

<p>Market model formula
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'market_model'
formula(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="formula+2B2Cmarket_model-method_+3A_x">x</code></td>
<td>
<p>A market model object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Market model formulas adhere to the following specification:
</p>
<p><code>quantity | price | subject | time ~ demand | supply</code>
</p>
<p>where
</p>

<ul>
<li><p>quantity: The model's traded (observed) quantity variable.
</p>
</li>
<li><p>price: The model's price variable.
</p>
</li>
<li><p>quantity: The model's subject (e.g. firm) identification variable.
</p>
</li>
<li><p>quantity: The model's time identification variable.
</p>
</li>
<li><p>demand: The right hand side of the model's demand equation.
</p>
</li>
<li><p>supply: The right hand side of the model's supply equation.
</p>
</li></ul>

<p>The <code><a href="#topic+diseq_stochastic_adjustment-class">diseq_stochastic_adjustment</a></code> additionally specify
price dynamics by appending the right hand side of the equation at the end
of the formula, i.e.
</p>
<p><code>quantity | price | subject | time ~ demand | supply | price_dynamics</code>
</p>
<p>The left hand side part of the model formula specifies the elements that
are needed for initializing the model. The market models of the package
prepare the data based on these four variables using their respective
identification assumptions. See <a href="#topic+market_models">market model classes</a>
for more details.
</p>
<p>The function provides access to the formula used in model initialization.
</p>


<h3>Value</h3>

<p>The model's formula
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
model &lt;- simulate_model(
  "diseq_stochastic_adjustment", list(
    # observed entities, observed time points
    nobs = 500, tobs = 3,
    # demand coefficients
    alpha_d = -0.1, beta_d0 = 9.8, beta_d = c(0.3, -0.2), eta_d = c(0.6, -0.1),
    # supply coefficients
    alpha_s = 0.1, beta_s0 = 6.1, beta_s = c(0.9), eta_s = c(-0.5, 0.2),
    # price equation coefficients
    gamma = 1.2, beta_p0 = 3.1, beta_p = c(0.8)
  ),
  seed = 31
)

# access the model's formula
formula(model)

</code></pre>

<hr>
<h2 id='houses'>Credit market data for US housing starts</h2><span id='topic+houses'></span><span id='topic+fair_houses'></span>

<h3>Description</h3>

<p>Credit market data for US housing starts
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(houses)

fair_houses()
</code></pre>


<h3>Format</h3>

<p>A data frame with 138 rows and 7 columns
</p>


<h3>Details</h3>



<h4>The basic houses dataset (<code>houses</code>)</h4>

<p>A dataset containing the monthly mortgage rates and other attributes of the US market
for new, non-farm houses from January 1958 to December 1969 (144 observations).
The variables are as follows:
</p>

<ul>
<li> <p><code>DATE</code> The date of the record.
</p>
</li>
<li> <p><code>HS</code> Private non-farm housing starts in thousands of units
(Not seasonally adjusted).
</p>
</li>
<li> <p><code>RM</code> FHA Mortgage rate series on new homes in units of 100 (
beginning-of-month Data).
</p>
</li>
<li> <p><code>DSLA</code> Savings capital (deposits) of savings and loan associations in
millions of dollars.
</p>
</li>
<li> <p><code>DMSB</code> Deposits of mutual savings banks in millions of dollars.
</p>
</li>
<li> <p><code>DHLB</code> Advances of the federal home loan bank to savings and loan
associations in million of dollars.
</p>
</li>
<li> <p><code>W</code> Number of working days in month.
</p>
</li></ul>




<h4>Generate the variables of the Fair &amp; Jaffee (1972) dataset.
(<code>fair_houses</code>)</h4>

<p>Loads the <code><a href="#topic+houses">houses</a></code> dataset and creates the additional variables used by
Fair &amp; Jaffee (1972) <a href="https://doi.org/10.2307/1913181">doi:10.2307/1913181</a>. These are
</p>

<ul>
<li> <p><code>ID</code> A dummy entity identifier that is always equal to one since the
houses data have only a time series component.
</p>
</li>
<li> <p><code>DSF</code> Flow of deposits in savings and loan associations and mutual
savings banks in million of dollars. Equal to </p>
<p style="text-align: center;"><code class="reqn">DSLA_{t} + DMSB_{t} - (DSLA_{t-1}
+ DMSB_{t-1}).</code>
</p>

</li>
<li> <p><code>DHF</code> Flow of advances of the federal home loan bank to savings and loan
associations in million of dollars. Equal to </p>
<p style="text-align: center;"><code class="reqn">DHLB_{t} - DHLB_{t-1}.</code>
</p>

</li>
<li> <p><code>MONTH</code> The month of the date of the observation.
</p>
</li>
<li> <p><code>L1RM</code> FHA Mortgage rate series on new homes in units of 100, lagged by
one date.
</p>
</li>
<li> <p><code>L2RM</code> FHA Mortgage rate series on new homes in units of 100, lagged by
two dates.
</p>
</li>
<li> <p><code>L1HS</code> Private non-farm housing starts in thousands of units (Not
seasonally adjusted), lagged by one date.
</p>
</li>
<li> <p><code>CSHS</code> The cumulative sum of past housing starts. Used to proxy the
stock of houses
</p>
</li>
<li> <p><code>MA6DSF</code> Moving average of order 6 of the flow of deposits in savings
associations and loan associations and  mutual savings banks.
</p>
</li>
<li> <p><code>MA3DHF</code> Moving average of order 3 of the flow of advances of the
federal home loan bank to savings and loan associations.
</p>
</li>
<li> <p><code>TREND</code> A time trend variable.
</p>
</li></ul>

<p>Returns A modified version of the <code>houses</code> dataset.
</p>



<h3>Functions</h3>


<ul>
<li> <p><code>fair_houses()</code>: Generate Fair &amp; Jaffee (1972) dataset
</p>
</li></ul>


<h3>Source</h3>


<ul>
<li> <p><code>HS</code> <a href="https://fraser.stlouisfed.org/title/economic-report-president-45?browse=1940s">Economic Reports of the President</a>
</p>
</li>
<li> <p><code>RM</code> <a href="https://fairmodel.econ.yale.edu/RAYFAIR/pdf/1971EI.PDF">Fair (1971)</a>
</p>
</li>
<li> <p><code>DSLA</code> <a href="https://fraser.stlouisfed.org/title/federal-reserve-bulletin-62?browse=1910s">Federal Reserve Bulletins</a>
</p>
</li>
<li> <p><code>DMSB</code> <a href="https://fraser.stlouisfed.org/title/federal-reserve-bulletin-62?browse=1910s">Federal Reserve Bulletins</a>
</p>
</li>
<li> <p><code>DHLB</code> <a href="https://fraser.stlouisfed.org/title/federal-reserve-bulletin-62?browse=1910s">Federal Reserve Bulletins</a>
</p>
</li>
<li> <p><code>W</code> <a href="https://www.timeanddate.com/date/workdays.html">Manually calculated</a>
</p>
</li></ul>



<h3>References</h3>


<ul>
<li><p> Fair, R. C. (1971). A short-run forecasting model of the United States
economy. Heath Lexington Books.
</p>
</li>
<li><p> Fair, R. C., &amp; Jaffee, D. M. (1972). Methods of Estimation for Markets in
Disequilibrium. Econometrica, 40(3), 497. <a href="https://doi.org/10.2307/1913181">doi:10.2307/1913181</a>
</p>
</li>
<li><p> Maddala, G. S., &amp; Nelson, F. D. (1974). Maximum Likelihood Methods for
Models of Markets in Disequilibrium. Econometrica, 42(6), 1013. <a href="https://doi.org/10.2307/1914215">doi:10.2307/1914215</a>
</p>
</li>
<li><p> Hwang, H. (1980). A test of a disequilibrium model. Journal of Econometrics,
12(3), 319–333. <a href="https://doi.org/10.1016/0304-4076%2880%2990059-7">doi:10.1016/0304-4076(80)90059-7</a>
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>data(houses)
head(houses)
head(fair_houses())
</code></pre>

<hr>
<h2 id='logLik.market_fit'>Log likelihood of a fitted market model</h2><span id='topic+logLik.market_fit'></span><span id='topic+logLik+2Cmarket_fit-method'></span>

<h3>Description</h3>

<p>Specializes the <code><a href="stats.html#topic+logLik">logLik</a></code> function for the market models
of the package estimated with full information minimum likelihood. It
returns <code>NULL</code> for the equilibrium model estimated with two stage
least squares (<code>method = "2SLS"</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'market_fit'
logLik(object, ...)

## S4 method for signature 'market_fit'
logLik(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logLik.market_fit_+3A_object">object</code></td>
<td>
<p>A fitted model object.</p>
</td></tr>
<tr><td><code id="logLik.market_fit_+3A_...">...</code></td>
<td>
<p>Additional arguments. Unused.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="stats.html#topic+logLik">logLik</a></code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# estimate a model using the houses dataset
fit &lt;- diseq_deterministic_adjustment(
  HS | RM | ID | TREND ~
    RM + TREND + W + CSHS + L1RM + L2RM + MONTH |
      RM + TREND + W + L1RM + MA6DSF + MA3DHF + MONTH,
  fair_houses(),
  correlated_shocks = FALSE,
  estimation_options = list(control = list(maxit = 1e+6))
)

# get the log likelihood object
logLik(fit)

</code></pre>

<hr>
<h2 id='marginal_effects'>Marginal effects</h2><span id='topic+marginal_effects'></span><span id='topic+shortage_marginal'></span><span id='topic+shortage_probability_marginal'></span><span id='topic+shortage_marginal+2Cmissing+2CANY+2Cmarket_model+2CANY-method'></span><span id='topic+shortage_probability_marginal+2Cmissing+2CANY+2CANY+2Cmarket_model+2CANY-method'></span><span id='topic+shortage_marginal+2Cmarket_fit+2CANY+2Cmissing+2Cmissing-method'></span><span id='topic+shortage_probability_marginal+2Cmarket_fit+2CANY+2CANY+2Cmissing+2Cmissing-method'></span>

<h3>Description</h3>

<p>Returns the estimated effect of a variable. The effect accounts for both sides
of the market. If the given variable belongs only to the demand side, the name of
result is prefixed by <code>"D_"</code>. If the given variable belongs only to the supply
side, the name of result is prefixed by <code>"S_"</code>. If the variable can be found
both sides, the result name is prefixed by <code>"B_"</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shortage_marginal(fit, variable, model, parameters)

shortage_probability_marginal(
  fit,
  variable,
  aggregate = "mean",
  model,
  parameters
)

## S4 method for signature 'missing,ANY,market_model,ANY'
shortage_marginal(variable, model, parameters)

## S4 method for signature 'missing,ANY,ANY,market_model,ANY'
shortage_probability_marginal(variable, aggregate, model, parameters)

## S4 method for signature 'missing,ANY,market_model,ANY'
shortage_marginal(variable, model, parameters)

## S4 method for signature 'market_fit,ANY,missing,missing'
shortage_marginal(fit, variable)

## S4 method for signature 'market_fit,ANY,ANY,missing,missing'
shortage_probability_marginal(fit, variable, aggregate)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="marginal_effects_+3A_fit">fit</code></td>
<td>
<p>A fitted market model.</p>
</td></tr>
<tr><td><code id="marginal_effects_+3A_variable">variable</code></td>
<td>
<p>Variable name for which the effect is calculated.</p>
</td></tr>
<tr><td><code id="marginal_effects_+3A_model">model</code></td>
<td>
<p>A market model object.</p>
</td></tr>
<tr><td><code id="marginal_effects_+3A_parameters">parameters</code></td>
<td>
<p>A vector of parameters.</p>
</td></tr>
<tr><td><code id="marginal_effects_+3A_aggregate">aggregate</code></td>
<td>
<p>Mode of aggregation. Valid options are &quot;mean&quot; (the
default) and &quot;at_the_mean&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The estimated effect of the passed variable.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>shortage_marginal()</code>: Marginal effect on market system
</p>
<p>Returns the estimated marginal effect of a variable on the market system. For a
system variable <code class="reqn">x</code> with demand coefficient <code class="reqn">\beta_{d, x}</code> and supply
coefficient <code class="reqn">\beta_{s, x}</code>, the marginal effect on the market system  is
given by
</p>
<p style="text-align: center;"><code class="reqn">M_{x} = \frac{\beta_{d, x} - \beta_{s, x}}{\sqrt{\sigma_{d}^{2} +
\sigma_{s}^{2} - 2 \rho_{ds} \sigma_{d} \sigma_{s}}}.</code>
</p>

</li>
<li> <p><code>shortage_probability_marginal()</code>: Marginal effect on shortage probabilities
</p>
<p>Returns the estimated marginal effect of a variable on the probability of
observing a shortage state. The mean marginal effect (<code>aggregate = "mean"</code>) on
the shortage probability is given by
</p>
<p style="text-align: center;"><code class="reqn">M_{x} \mathrm{E} \phi\left(\frac{D - S}{\sqrt{\sigma_{d}^2 + \sigma_{s}^2 - 2 rho \sigma_{d} \sigma_{s}}}\right)</code>
</p>
<p>.
and the marginal effect at the mean (<code>aggregate = "at_the_mean"</code>) by
</p>
<p style="text-align: center;"><code class="reqn">M_{x} \phi\left(\mathrm{E}\frac{D - S}{\sqrt{\sigma_{d}^2 + \sigma_{s}^2 - 2 rho \sigma_{d} \sigma_{s}}}\right)</code>
</p>

<p>where <code class="reqn">M_{x}</code> is the marginal effect on the system, <code class="reqn">D</code> is the demanded
quantity, <code class="reqn">S</code> the supplied quantity, and <code class="reqn">\phi</code> is the standard normal
density.
</p>
</li></ul>


<h3>Examples</h3>

<pre><code class='language-R'>
# estimate a model using the houses dataset
fit &lt;- diseq_deterministic_adjustment(
  HS | RM | ID | TREND ~
    RM + TREND + W + CSHS + L1RM + L2RM + MONTH |
      RM + TREND + W + L1RM + MA6DSF + MA3DHF + MONTH,
  fair_houses(),
  correlated_shocks = FALSE,
  estimation_options = list(control = list(maxit = 1e+5))
)

# mean marginal effect of variable "RM" on the shortage probabilities
#' shortage_probability_marginal(fit, "RM")

# marginal effect at the mean of variable "RM" on the shortage probabilities
shortage_probability_marginal(fit, "CSHS", aggregate = "at_the_mean")

# marginal effect of variable "RM" on the system
shortage_marginal(fit, "RM")

</code></pre>

<hr>
<h2 id='market_aggregation'>Market side aggregation</h2><span id='topic+market_aggregation'></span><span id='topic+aggregate_demand'></span><span id='topic+aggregate_demand+2Cmissing+2Cmarket_model+2CANY-method'></span><span id='topic+aggregate_supply'></span><span id='topic+aggregate_supply+2Cmissing+2Cmarket_model+2CANY-method'></span><span id='topic+aggregate_demand+2Cmarket_fit+2Cmissing+2Cmissing-method'></span><span id='topic+aggregate_supply+2Cmarket_fit+2Cmissing+2Cmissing-method'></span>

<h3>Description</h3>

<p>Market side aggregation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aggregate_demand(fit, model, parameters)

## S4 method for signature 'missing,market_model,ANY'
aggregate_demand(model, parameters)

aggregate_supply(fit, model, parameters)

## S4 method for signature 'missing,market_model,ANY'
aggregate_supply(model, parameters)

## S4 method for signature 'market_fit,missing,missing'
aggregate_demand(fit)

## S4 method for signature 'market_fit,missing,missing'
aggregate_supply(fit)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="market_aggregation_+3A_fit">fit</code></td>
<td>
<p>A fitted market model object.</p>
</td></tr>
<tr><td><code id="market_aggregation_+3A_model">model</code></td>
<td>
<p>A model object.</p>
</td></tr>
<tr><td><code id="market_aggregation_+3A_parameters">parameters</code></td>
<td>
<p>A vector of model's parameters.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculates the sample's aggregate demand or supply using the
estimated coefficients of a fitted model. Alternatively, the function
calculates aggregates using a model and a set of parameters passed
separately. If the model's data have multiple distinct subjects at each
date (e.g., panel data), aggregation is calculated over subjects per unique date.
If the model has time series data, namely a single subject per time point, aggregation
is calculated over all time points.
</p>


<h3>Value</h3>

<p>The sum of the estimated demanded or supplied quantities evaluated at the
given parameters.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>aggregate_demand()</code>: Demand aggregation.
</p>
</li>
<li> <p><code>aggregate_supply()</code>: Supply aggregation.
</p>
</li></ul>


<h3>See Also</h3>

<p><code><a href="#topic+demanded_quantities">demanded_quantities</a></code>, <code><a href="#topic+supplied_quantities">supplied_quantities</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
fit &lt;- diseq_basic(
  HS | RM | ID | TREND ~
    RM + TREND + W + CSHS + L1RM + L2RM + MONTH |
      RM + TREND + W + L1RM + MA6DSF + MA3DHF + MONTH,
  fair_houses(),
  correlated_shocks = FALSE
)

# get estimated aggregate demand
aggregate_demand(fit)

# simulate the deterministic adjustment model
model &lt;- simulate_model(
  "diseq_deterministic_adjustment", list(
    # observed entities, observed time points
    nobs = 500, tobs = 3,
    # demand coefficients
    alpha_d = -0.6, beta_d0 = 9.8, beta_d = c(0.3, -0.2), eta_d = c(0.6, -0.1),
    # supply coefficients
    alpha_s = 0.2, beta_s0 = 4.1, beta_s = c(0.9), eta_s = c(-0.5, 0.2),
    # price equation coefficients
    gamma = 0.9
  ),
  seed = 1356
)

# estimate the model object
fit &lt;- estimate(model)

# get estimated aggregate demand
aggregate_demand(fit)

# get estimated aggregate demand
aggregate_supply(fit)

</code></pre>

<hr>
<h2 id='market_descriptives'>Market force data descriptive statistics</h2><span id='topic+market_descriptives'></span><span id='topic+demand_descriptives'></span><span id='topic+supply_descriptives'></span><span id='topic+demand_descriptives+2Cmarket_model-method'></span><span id='topic+supply_descriptives+2Cmarket_model-method'></span>

<h3>Description</h3>

<p>Market force data descriptive statistics
</p>


<h3>Usage</h3>

<pre><code class='language-R'>demand_descriptives(object)

supply_descriptives(object)

## S4 method for signature 'market_model'
demand_descriptives(object)

## S4 method for signature 'market_model'
supply_descriptives(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="market_descriptives_+3A_object">object</code></td>
<td>
<p>A model object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculates and returns basic descriptive statistics for the model's demand
or supply side data. Factor variables are excluded from the calculations. The function
calculates and returns:
</p>

<ul>
<li> <p><code>nobs</code> Number of observations.
</p>
</li>
<li> <p><code>nmval</code> Number of missing values.
</p>
</li>
<li> <p><code>min</code> Minimum observation.
</p>
</li>
<li> <p><code>max</code> Maximum observation.
</p>
</li>
<li> <p><code>range</code> Observations' range.
</p>
</li>
<li> <p><code>sum</code> Sum of observations.
</p>
</li>
<li> <p><code>median</code> Median observation.
</p>
</li>
<li> <p><code>mean</code> Mean observation.
</p>
</li>
<li> <p><code>mean_se</code> Mean squared error.
</p>
</li>
<li> <p><code>mean_ce</code> Confidence interval bound.
</p>
</li>
<li> <p><code>var</code> Variance.
</p>
</li>
<li> <p><code>sd</code> Standard deviation.
</p>
</li>
<li> <p><code>coef_var</code> Coefficient of variation.
</p>
</li></ul>



<h3>Value</h3>

<p>A data frame containing descriptive statistics.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>demand_descriptives()</code>: Demand descriptive statistics.
</p>
</li>
<li> <p><code>supply_descriptives()</code>: Supply descriptive statistics.
</p>
</li></ul>


<h3>Examples</h3>

<pre><code class='language-R'># initialize the basic model using the houses dataset
model &lt;- new(
  "diseq_basic", # model type
  subject = ID, time = TREND, quantity = HS, price = RM,
  demand = RM + TREND + W + CSHS + L1RM + L2RM + MONTH,
  supply = RM + TREND + W + L1RM + MA6DSF + MA3DHF + MONTH,
  fair_houses(), # data
  correlated_shocks = FALSE # allow shocks to be correlated
)

# get descriptive statistics of demand side variables
demand_descriptives(model)

# get descriptive statistics of supply side variables
supply_descriptives(model)
</code></pre>

<hr>
<h2 id='market_fit-class'>Market model fit</h2><span id='topic+market_fit-class'></span>

<h3>Description</h3>

<p>This is the estimation output class for all market models of the package. It couples
a market model object with estimation results. It provides a common user interface
for accessing estimation results, irrespective of the underlying market model used.
The estimation results are intended to be accessed by passing <code>market_fit</code>
objects to methods such as <code><a href="graphics.html#topic+plot">plot</a></code>, <code><a href="#topic+summary">summary</a></code>, and
<code><a href="stats.html#topic+logLik">logLik</a></code>.
</p>


<h3>Details</h3>

<p>The <code>market_fit</code> class composes the <code><a href="#topic+market_models">market_models</a></code>
class with the estimation results obtained by <code><a href="stats.html#topic+optim">optim</a></code>,
<code><a href="stats.html#topic+lm">lm</a></code> or <code>GSL</code>. All the public functionality of the
underlying market model is also directly accessible from the output class.
</p>
<p>Furthermore, the class is responsible for harmonizing the heterogeneous
outputs resulting from different estimation methods of market models. For
example, a <code>2SLS</code> estimation of the
<code><a href="#topic+equilibrium_model-class">equilibrium_model</a></code> returns a list of linear regression
models (the first stage, demand, and supply models), while the maximum
likelihood estimation of <code><a href="#topic+diseq_basic-class">diseq_basic</a></code> returns an
<code><a href="stats.html#topic+optim">optim</a></code> list. In both cases, the <code>market_fit</code>
stores the estimation output in the member <code>fit</code> of type <code>list</code>
and produces additional harmonized list elements. Methods of the class
examine the type of the <code>fit</code> and direct execution accordingly to different
branches to produce a unified experience for the caller.
</p>


<h3>Slots</h3>


<dl>
<dt><code>model</code></dt><dd><p>The underlying market model object.</p>
</dd>
<dt><code>fit</code></dt><dd><p>A list holding estimation outputs.</p>
</dd>
</dl>


<h3>See Also</h3>

<p><code><a href="#topic+market_models">market_models</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># estimate an equilibrium  model using the houses dataset
fit &lt;- equilibrium_model(
  HS | RM | ID | TREND ~
    RM + TREND + W + CSHS + L1RM + L2RM + MONTH |
      RM + TREND + W + L1RM + MA6DSF + MA3DHF + MONTH,
  fair_houses(),
  estimation_options = list(method = "2SLS")
)

# access an method of the underlying model
aggregate_demand(fit)

# summary of results
summary(fit)
</code></pre>

<hr>
<h2 id='market_models'>Market model classes</h2><span id='topic+market_models'></span><span id='topic+disequilibrium_model-class'></span><span id='topic+diseq_basic-class'></span><span id='topic+diseq_deterministic_adjustment-class'></span><span id='topic+diseq_directional-class'></span><span id='topic+diseq_stochastic_adjustment-class'></span><span id='topic+equilibrium_model-class'></span>

<h3>Description</h3>



<h4>Basic disequilibrium model with unknown sample separation
(<code>diseq_basic</code>)</h4>

<p>The basic disequilibrium model consists of three equations. Two of them
are the demand and supply equations. In addition, the model replaces the
market clearing condition with the short side rule. The model is estimated
using full information maximum likelihood.
</p>
<p style="text-align: center;"><code class="reqn">D_{nt} = X_{d,nt}'\beta_{d} + u_{d,nt},</code>
</p>

<p style="text-align: center;"><code class="reqn">S_{nt} = X_{s,nt}'\beta_{s} + u_{s,nt},</code>
</p>

<p style="text-align: center;"><code class="reqn">Q_{nt} = \min\{D_{nt},S_{nt}\}.</code>
</p>




<h4>Disequilibrium model with deterministic price dynamics
(<code>diseq_deterministic_adjustment</code>)</h4>

<p>The disequilibrium model with deterministic price adjustment consists
of four equations. The two market equations, the short side rule and price
evolution equation. The first two equations are stochastic. The price
equation is deterministic. The sample is separated based on the sign of
the price changes as in the <code><a href="#topic+diseq_directional-class">diseq_directional</a></code> model.
The model is estimated using full information maximum likelihood.
</p>
<p style="text-align: center;"><code class="reqn">D_{nt} = X_{d,nt}'\beta_{d} + P_{nt}\alpha_{d} + u_{d,nt},</code>
</p>

<p style="text-align: center;"><code class="reqn">S_{nt} = X_{s,nt}'\beta_{s} + P_{nt}\alpha_{s} + u_{s,nt},</code>
</p>

<p style="text-align: center;"><code class="reqn">Q_{nt} = \min\{D_{nt},S_{nt}\},</code>
</p>

<p style="text-align: center;"><code class="reqn">\Delta P_{nt} = \frac{1}{\gamma} \left( D_{nt} - S_{nt} \right).</code>
</p>




<h4>Directional disequilibrium model with sample separation
(<code>diseq_directional</code>)</h4>

<p>The directional disequilibrium model consists of three equations and a
separation rule. The market is described by a linear demand, a linear supply
equation and the short side rule. The separation rule splits the sample
into states of excess supply and excess demand. If a price change is
positive at the time point of the observation, then the observation is
classified as being in an excess demand state. Otherwise, it is assumed
that it represents an excess supply state. The
model is estimated using full information maximum likelihood.
</p>
<p style="text-align: center;"><code class="reqn">D_{nt} = X_{d,nt}'\beta_{d} + u_{d,nt},</code>
</p>

<p style="text-align: center;"><code class="reqn">S_{nt} = X_{s,nt}'\beta_{s} + u_{s,nt},</code>
</p>

<p style="text-align: center;"><code class="reqn">Q_{nt} = \min\{D_{nt},S_{nt}\},</code>
</p>

<p style="text-align: center;"><code class="reqn">\Delta P_{nt} \ge 0 \Longrightarrow D_{nt} \ge S_{nt}.</code>
</p>




<h4>Disequilibrium model with stochastic price dynamics
(<code>diseq_stochastic_adjustment</code>)</h4>

<p>The disequilibrium model with stochastic price adjustment is described
by a system of four equations. Three of of them form a stochastic linear system of
market equations equations coupled with a stochastic price evolution equation. The
fourth equation is the short side rule. In contrast to the deterministic counterpart,
the model does not impose any separation rule on the sample. It is estimated using
full information maximum likelihood.
</p>
<p style="text-align: center;"><code class="reqn">D_{nt} = X_{d,nt}'\beta_{d} + P_{nt}\alpha_{d} + u_{d,nt},</code>
</p>

<p style="text-align: center;"><code class="reqn">S_{nt} = X_{s,nt}'\beta_{s} + P_{nt}\alpha_{s} + u_{s,nt},</code>
</p>

<p style="text-align: center;"><code class="reqn">Q_{nt} = \min\{D_{nt},S_{nt}\},</code>
</p>

<p style="text-align: center;"><code class="reqn">\Delta P_{nt} =
    \frac{1}{\gamma} \left( D_{nt} - S_{nt} \right) +  X_{p,nt}'\beta_{p} + u_{p,nt}.</code>
</p>




<h4>Equilibrium model (<code>equilibrium_model</code>)</h4>

<p>The equilibrium model consists of thee equations. The demand, the
supply and the market clearing equations. The model can be estimated using both full
information maximum likelihood and two-stage least squares.
</p>
<p style="text-align: center;"><code class="reqn">D_{nt} = X_{d,nt}'\beta_{d} + P_{nt}\alpha_{d} + u_{d,nt},</code>
</p>

<p style="text-align: center;"><code class="reqn">S_{nt} = X_{s,nt}'\beta_{s} + P_{nt}\alpha_{s} + u_{s,nt},</code>
</p>

<p style="text-align: center;"><code class="reqn">Q_{nt} = D_{nt} = S_{nt}.</code>
</p>

<p>A necessary identification condition is that
there is at least one control that is exclusively part of the demand and one control
that is exclusively part of the supply equation. In the first stage of the two-stage
least square estimation, prices are regressed on remaining controls from both the
demand and supply equations. In the second stage, the demand and supply equation is
estimated using the fitted prices instead of the observed.
</p>



<h3>Slots</h3>


<dl>
<dt><code>logger</code></dt><dd><p>Logger object.</p>
</dd>
<dt><code>subject_columns</code></dt><dd><p>Column name for the subject identifier.</p>
</dd>
<dt><code>time_column</code></dt><dd><p>Column name for the time point identifier.</p>
</dd>
<dt><code>explanatory_columns</code></dt><dd><p>Vector of explanatory column names for all model's
equations.</p>
</dd>
<dt><code>data_columns</code></dt><dd><p>Vector of model's data column names. This is the union of the
quantity, price and explanatory columns.</p>
</dd>
<dt><code>columns</code></dt><dd><p>Vector of primary key and data column names for all model's equations.</p>
</dd>
<dt><code>data</code></dt><dd><p>Model data frame.</p>
</dd>
<dt><code>model_name</code></dt><dd><p>Model name string.</p>
</dd>
<dt><code>market_type</code></dt><dd><p>Market type string.</p>
</dd>
<dt><code>system</code></dt><dd><p>Model's system of equations.</p>
</dd>
</dl>


<h3>See Also</h3>

<p><a href="#topic+model_initialization">model_initialization</a>
</p>

<hr>
<h2 id='market_quantities'>Estimated market quantities</h2><span id='topic+market_quantities'></span><span id='topic+demanded_quantities'></span><span id='topic+demanded_quantities+2Cmissing+2Cmarket_model+2CANY-method'></span><span id='topic+supplied_quantities'></span><span id='topic+supplied_quantities+2Cmissing+2Cmarket_model+2CANY-method'></span><span id='topic+demanded_quantities+2Cmarket_fit+2Cmissing+2Cmissing-method'></span><span id='topic+supplied_quantities+2Cmarket_fit+2Cmissing+2Cmissing-method'></span>

<h3>Description</h3>

<p>Estimated market quantities
</p>


<h3>Usage</h3>

<pre><code class='language-R'>demanded_quantities(fit, model, parameters)

## S4 method for signature 'missing,market_model,ANY'
demanded_quantities(model, parameters)

supplied_quantities(fit, model, parameters)

## S4 method for signature 'missing,market_model,ANY'
supplied_quantities(model, parameters)

## S4 method for signature 'market_fit,missing,missing'
demanded_quantities(fit)

## S4 method for signature 'market_fit,missing,missing'
supplied_quantities(fit)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="market_quantities_+3A_fit">fit</code></td>
<td>
<p>A fitted model object.</p>
</td></tr>
<tr><td><code id="market_quantities_+3A_model">model</code></td>
<td>
<p>A model object.</p>
</td></tr>
<tr><td><code id="market_quantities_+3A_parameters">parameters</code></td>
<td>
<p>A vector of model's parameters.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculates and returns the estimated demanded or supplied quantities for
each observation at the passed vector of parameters.
</p>


<h3>Value</h3>

<p>A vector with the market quantities evaluated at the given parameter vector.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>demanded_quantities()</code>: Estimated demanded quantities.
</p>
</li>
<li> <p><code>supplied_quantities()</code>: Estimated supplied quantities.
</p>
</li></ul>


<h3>Examples</h3>

<pre><code class='language-R'>
fit &lt;- diseq_basic(
  HS | RM | ID | TREND ~
    RM + TREND + W + CSHS + L1RM + L2RM + MONTH |
      RM + TREND + W + L1RM + MA6DSF + MA3DHF + MONTH,
  fair_houses(),
  correlated_shocks = FALSE
)

# get estimated demanded and supplied quantities
head(cbind(
  demanded_quantities(fit),
  supplied_quantities(fit)
))

</code></pre>

<hr>
<h2 id='market_simulation'>Market model simulation</h2><span id='topic+market_simulation'></span><span id='topic+simulate_data'></span><span id='topic+simulate_data+2CANY-method'></span><span id='topic+simulate_model'></span><span id='topic+simulate_model+2CANY-method'></span>

<h3>Description</h3>

<p>Market data and model simulation functionality based on the data
generating process induced by the market model specifications.
</p>


<h4><code>simulate_data</code></h4>

<p>Returns a data frame with simulated data from a generating process that
matches the passed model string. By default, the simulated observations of the
controls are drawn from a normal distribution.
</p>



<h4><code>simulate_model</code></h4>

<p>Simulates a data frame based on the generating process of the passed model
and uses it to initialize a model object. Data are simulated using the
<code><a href="#topic+simulate_data">simulate_data</a></code> function.
</p>



<h3>Usage</h3>

<pre><code class='language-R'>simulate_data(
  model_type_string,
  nobs = NA_integer_,
  tobs = NA_integer_,
  alpha_d = NA_real_,
  beta_d0 = NA_real_,
  beta_d = NA_real_,
  eta_d = NA_real_,
  alpha_s = NA_real_,
  beta_s0 = NA_real_,
  beta_s = NA_real_,
  eta_s = NA_real_,
  gamma = NA_real_,
  beta_p0 = NA_real_,
  beta_p = NA_real_,
  sigma_d = 1,
  sigma_s = 1,
  sigma_p = 1,
  rho_ds = 0,
  rho_dp = 0,
  rho_sp = 0,
  seed = NA_integer_,
  price_generator = function(n) stats::rnorm(n = n),
  control_generator = function(n) stats::rnorm(n = n),
  verbose = 0
)

## S4 method for signature 'ANY'
simulate_data(
  model_type_string,
  nobs = NA_integer_,
  tobs = NA_integer_,
  alpha_d = NA_real_,
  beta_d0 = NA_real_,
  beta_d = NA_real_,
  eta_d = NA_real_,
  alpha_s = NA_real_,
  beta_s0 = NA_real_,
  beta_s = NA_real_,
  eta_s = NA_real_,
  gamma = NA_real_,
  beta_p0 = NA_real_,
  beta_p = NA_real_,
  sigma_d = 1,
  sigma_s = 1,
  sigma_p = 1,
  rho_ds = 0,
  rho_dp = 0,
  rho_sp = 0,
  seed = NA_integer_,
  price_generator = function(n) stats::rnorm(n = n),
  control_generator = function(n) stats::rnorm(n = n),
  verbose = 0
)

simulate_model(
  model_type_string,
  simulation_parameters,
  seed = NA,
  verbose = 0,
  correlated_shocks = TRUE
)

## S4 method for signature 'ANY'
simulate_model(
  model_type_string,
  simulation_parameters,
  seed = NA,
  verbose = 0,
  correlated_shocks = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="market_simulation_+3A_model_type_string">model_type_string</code></td>
<td>
<p>Model type. It should be among <code>equilibrium_model</code>,
<code>diseq_basic</code>, <code>diseq_directional</code>,
<code>diseq_deterministic_adjustment</code>, and <code>diseq_stochastic_adjustment</code>.</p>
</td></tr>
<tr><td><code id="market_simulation_+3A_nobs">nobs</code></td>
<td>
<p>Number of simulated entities.</p>
</td></tr>
<tr><td><code id="market_simulation_+3A_tobs">tobs</code></td>
<td>
<p>Number of simulated dates.</p>
</td></tr>
<tr><td><code id="market_simulation_+3A_alpha_d">alpha_d</code></td>
<td>
<p>Price coefficient of demand.</p>
</td></tr>
<tr><td><code id="market_simulation_+3A_beta_d0">beta_d0</code></td>
<td>
<p>Constant coefficient of demand.</p>
</td></tr>
<tr><td><code id="market_simulation_+3A_beta_d">beta_d</code></td>
<td>
<p>Coefficients of exclusive demand controls.</p>
</td></tr>
<tr><td><code id="market_simulation_+3A_eta_d">eta_d</code></td>
<td>
<p>Demand coefficients of common controls.</p>
</td></tr>
<tr><td><code id="market_simulation_+3A_alpha_s">alpha_s</code></td>
<td>
<p>Price coefficient of supply.</p>
</td></tr>
<tr><td><code id="market_simulation_+3A_beta_s0">beta_s0</code></td>
<td>
<p>Constant coefficient of supply.</p>
</td></tr>
<tr><td><code id="market_simulation_+3A_beta_s">beta_s</code></td>
<td>
<p>Coefficients of exclusive supply controls.</p>
</td></tr>
<tr><td><code id="market_simulation_+3A_eta_s">eta_s</code></td>
<td>
<p>Supply coefficients of common controls.</p>
</td></tr>
<tr><td><code id="market_simulation_+3A_gamma">gamma</code></td>
<td>
<p>Price equation's stability factor.</p>
</td></tr>
<tr><td><code id="market_simulation_+3A_beta_p0">beta_p0</code></td>
<td>
<p>Price equation's constant coefficient.</p>
</td></tr>
<tr><td><code id="market_simulation_+3A_beta_p">beta_p</code></td>
<td>
<p>Price equation's control coefficients.</p>
</td></tr>
<tr><td><code id="market_simulation_+3A_sigma_d">sigma_d</code></td>
<td>
<p>Demand shock's standard deviation.</p>
</td></tr>
<tr><td><code id="market_simulation_+3A_sigma_s">sigma_s</code></td>
<td>
<p>Supply shock's standard deviation.</p>
</td></tr>
<tr><td><code id="market_simulation_+3A_sigma_p">sigma_p</code></td>
<td>
<p>Price equation shock's standard deviation.</p>
</td></tr>
<tr><td><code id="market_simulation_+3A_rho_ds">rho_ds</code></td>
<td>
<p>Demand and supply shocks' correlation coefficient.</p>
</td></tr>
<tr><td><code id="market_simulation_+3A_rho_dp">rho_dp</code></td>
<td>
<p>Demand and price shocks' correlation coefficient.</p>
</td></tr>
<tr><td><code id="market_simulation_+3A_rho_sp">rho_sp</code></td>
<td>
<p>Supply and price shocks' correlation coefficient.</p>
</td></tr>
<tr><td><code id="market_simulation_+3A_seed">seed</code></td>
<td>
<p>Pseudo random number generator seed.</p>
</td></tr>
<tr><td><code id="market_simulation_+3A_price_generator">price_generator</code></td>
<td>
<p>Pseudo random number generator callback for prices. The
default generator is <code class="reqn">N(0, 1)</code>.</p>
</td></tr>
<tr><td><code id="market_simulation_+3A_control_generator">control_generator</code></td>
<td>
<p>Pseudo random number generator callback for non-price
controls. The default generator is <code class="reqn">N(0, 1)</code>.</p>
</td></tr>
<tr><td><code id="market_simulation_+3A_verbose">verbose</code></td>
<td>
<p>Verbosity level.</p>
</td></tr>
<tr><td><code id="market_simulation_+3A_simulation_parameters">simulation_parameters</code></td>
<td>
<p>List of parameters used in model simulation. See the
<code><a href="#topic+simulate_data">simulate_data</a></code> function for details.</p>
</td></tr>
<tr><td><code id="market_simulation_+3A_correlated_shocks">correlated_shocks</code></td>
<td>
<p>Should the model be estimated using correlated shocks?</p>
</td></tr>
</table>


<h3>Value</h3>



<h4><code>simulate_data</code></h4>

<p>The simulated data.</p>



<h4><code>simulate_model</code></h4>

<p>The simulated model</p>
<p>.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>simulate_data()</code>: Simulate model data.
</p>
</li>
<li> <p><code>simulate_model()</code>: Simulate model.
</p>
</li></ul>


<h3>Examples</h3>

<pre><code class='language-R'>
model &lt;- simulate_model(
  "diseq_stochastic_adjustment", list(
    # observed entities, observed time points
    nobs = 500, tobs = 3,
    # demand coefficients
    alpha_d = -0.1, beta_d0 = 9.8, beta_d = c(0.3, -0.2), eta_d = c(0.6, -0.1),
    # supply coefficients
    alpha_s = 0.1, beta_s0 = 6.1, beta_s = c(0.9), eta_s = c(-0.5, 0.2),
    # price equation coefficients
    gamma = 1.2, beta_p0 = 3.1, beta_p = c(0.8)
  ),
  seed = 31
)

</code></pre>

<hr>
<h2 id='markets'>Estimation of models for markets in equilibrium and disequilibrium</h2><span id='topic+markets'></span><span id='topic+markets-package'></span>

<h3>Description</h3>

<p>The <code>markets</code> package provides tools to estimate and analyze an equilibrium and
four disequilibrium models. The equilibrium model can be estimated with either
two-stage least squares or with full information maximum likelihood. The methods are
asymptotically equivalent. The disequilibrium models are estimated using full
information maximum likelihood. All maximum likelihood models can be estimated both
with independent and correlated demand and supply shocks. The disequilibrium
estimation is based on Maddala and Nelson (1974) <a href="https://doi.org/10.2307/1914215">doi:10.2307/1914215</a>. The package
is using the expressions of the gradients of the likelihoods derived in
Karapanagiotis (2020) <a href="https://doi.org/10.2139/ssrn.3525622">doi:10.2139/ssrn.3525622</a>.
</p>


<h3>Details</h3>

<p>Overview
</p>
<p>This page gives an overview of the market model classes and the available
documentation options of the package.
</p>


<h4>Usage</h4>

<p>The easiest way to get accustomed with the functionality of the package is to check
the accompanying vignettes and the <a href="../README.html">README</a> file. These can be
found in the following links:
</p>

<dl>
<dt><a href="../doc/basic_usage.html">basic_usage</a></dt><dd>
<p><code>vignette("basic_usage", package = "markets")</code></p>
</dd>
<dt><a href="../doc/market_clearing_assessment.html">equilibrium_assessment</a></dt><dd>
<p><code>vignette("market_clearing_assessment", package = "markets")</code></p>
</dd>
</dl>

<p>Additionally, one can use the documentation examples. Some of them illustrate the
package functionality using the <code><a href="#topic+houses">houses</a></code> dataset.
</p>



<h4>Market model classes</h4>

<p>The model hierarchy is described in the <a href="../README.html">README</a> file. See
the documentation of the classes for initialization details.
</p>
<p><strong>Equilibrium model classes:</strong>
</p>

<dl>
<dt><code><a href="#topic+equilibrium_model-class">equilibrium_model</a></code></dt><dd><p>Equilibrium model that can be
estimated using full information maximum likelihood or two-stage least squares.</p>
</dd>
</dl>

<p><strong>Disequilibrium model classes:</strong>
</p>

<dl>
<dt><code><a href="#topic+diseq_basic-class">diseq_basic</a></code></dt><dd>
<p>Disequilibrium model only with a basic short side rule.</p>
</dd>
<dt><code><a href="#topic+diseq_directional-class">diseq_directional</a></code></dt><dd>
<p>Disequilibrium model with directional sample separation.</p>
</dd>
<dt><code><a href="#topic+diseq_deterministic_adjustment-class">diseq_deterministic_adjustment</a></code></dt><dd>
<p>Disequilibrium model with deterministic price dynamics.</p>
</dd>
<dt><code><a href="#topic+diseq_stochastic_adjustment-class">diseq_stochastic_adjustment</a></code></dt><dd>
<p>Disequilibrium model with stochastic price dynamics.</p>
</dd>
</dl>




<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Pantelis Karapanagiotis <a href="mailto:pikappa.devel@gmail.com">pikappa.devel@gmail.com</a> (<a href="https://orcid.org/0000-0001-9871-1908">ORCID</a>)
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/pi-kappa-devel/markets/">https://github.com/pi-kappa-devel/markets/</a>
</p>
</li>
<li> <p><a href="https://markets.pikappa.eu/">https://markets.pikappa.eu/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/pi-kappa-devel/markets/issues">https://github.com/pi-kappa-devel/markets/issues</a>
</p>
</li></ul>


<hr>
<h2 id='model_description'>Short model and market descriptions</h2><span id='topic+model_description'></span><span id='topic+name'></span><span id='topic+describe'></span><span id='topic+market_type'></span><span id='topic+name+2Cmarket_model-method'></span><span id='topic+describe+2Cmarket_model-method'></span><span id='topic+market_type+2Cmarket_model-method'></span><span id='topic+name+2Cmarket_fit-method'></span><span id='topic+describe+2Cmarket_fit-method'></span><span id='topic+market_type+2Cmarket_fit-method'></span>

<h3>Description</h3>



<h4><code>name</code></h4>

<p>A unique identifying string for the model.</p>



<h4><code>describe</code></h4>

<p>A short (one-liner) description of the market model.</p>



<h4><code>market_type</code></h4>

<p>A market type string (equilibrium or disequilibrium) for a given model.</p>



<h3>Usage</h3>

<pre><code class='language-R'>name(object)

describe(object)

market_type(object)

## S4 method for signature 'market_model'
name(object)

## S4 method for signature 'market_model'
describe(object)

## S4 method for signature 'market_model'
market_type(object)

## S4 method for signature 'market_fit'
name(object)

## S4 method for signature 'market_fit'
describe(object)

## S4 method for signature 'market_fit'
market_type(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="model_description_+3A_object">object</code></td>
<td>
<p>A model object.</p>
</td></tr>
</table>


<h3>Value</h3>



<h4><code>name</code></h4>

<p>The model's name.</p>



<h4><code>describe</code></h4>

<p>The model's description.</p>



<h4><code>market_type</code></h4>

<p>The model's market type.</p>



<h3>Functions</h3>


<ul>
<li> <p><code>name()</code>: Model name
</p>
</li>
<li> <p><code>describe()</code>: Model description
</p>
</li>
<li> <p><code>market_type()</code>: Market type
</p>
</li></ul>


<h3>Examples</h3>

<pre><code class='language-R'># initialize the equilibrium using the houses dataset
model &lt;- new(
  "diseq_basic", # model type
  subject = ID, time = TREND, quantity = HS, price = RM,
  demand = RM + TREND + W + CSHS + L1RM + L2RM + MONTH,
  supply = RM + TREND + W + L1RM + MA6DSF + MA3DHF + MONTH,
  fair_houses()
)

# model name
name(model)
# model description
describe(model)
# market type
market_type(model)
</code></pre>

<hr>
<h2 id='model_initialization'>Model initialization</h2><span id='topic+model_initialization'></span><span id='topic+initialize+2Cdiseq_basic-method'></span><span id='topic+initialize+2Cdiseq_deterministic_adjustment-method'></span><span id='topic+initialize+2Cdiseq_directional-method'></span><span id='topic+initialize+2Cdiseq_stochastic_adjustment-method'></span><span id='topic+initialize+2Cequilibrium_model-method'></span>

<h3>Description</h3>

<p>Model initialization
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'diseq_basic'
initialize(
  .Object,
  quantity,
  price,
  demand,
  supply,
  subject,
  time,
  data,
  correlated_shocks = TRUE,
  verbose = 0
)

## S4 method for signature 'diseq_deterministic_adjustment'
initialize(
  .Object,
  quantity,
  price,
  demand,
  supply,
  subject,
  time,
  data,
  correlated_shocks = TRUE,
  verbose = 0
)

## S4 method for signature 'diseq_directional'
initialize(
  .Object,
  quantity,
  price,
  demand,
  supply,
  subject,
  time,
  data,
  correlated_shocks = TRUE,
  verbose = 0
)

## S4 method for signature 'diseq_stochastic_adjustment'
initialize(
  .Object,
  quantity,
  price,
  demand,
  supply,
  price_dynamics,
  subject,
  time,
  data,
  correlated_shocks = TRUE,
  verbose = 0
)

## S4 method for signature 'equilibrium_model'
initialize(
  .Object,
  quantity,
  price,
  demand,
  supply,
  subject,
  time,
  data,
  correlated_shocks = TRUE,
  verbose = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="model_initialization_+3A_.object">.Object</code></td>
<td>
<p>The object to be Constructed.</p>
</td></tr>
<tr><td><code id="model_initialization_+3A_quantity">quantity</code></td>
<td>
<p>The quantity variable of the system.</p>
</td></tr>
<tr><td><code id="model_initialization_+3A_price">price</code></td>
<td>
<p>The price variable of the system.</p>
</td></tr>
<tr><td><code id="model_initialization_+3A_demand">demand</code></td>
<td>
<p>A formula representation of the right hand side of the
demand equation.</p>
</td></tr>
<tr><td><code id="model_initialization_+3A_supply">supply</code></td>
<td>
<p>A formula representation of the right hand side of the
supply equation.</p>
</td></tr>
<tr><td><code id="model_initialization_+3A_subject">subject</code></td>
<td>
<p>The subject identifier of the data set.</p>
</td></tr>
<tr><td><code id="model_initialization_+3A_time">time</code></td>
<td>
<p>The time identifier of the data set.</p>
</td></tr>
<tr><td><code id="model_initialization_+3A_data">data</code></td>
<td>
<p>The data set.</p>
</td></tr>
<tr><td><code id="model_initialization_+3A_correlated_shocks">correlated_shocks</code></td>
<td>
<p>Should the model be estimated using correlated shocks?</p>
</td></tr>
<tr><td><code id="model_initialization_+3A_verbose">verbose</code></td>
<td>
<p>Verbosity level.</p>
</td></tr>
<tr><td><code id="model_initialization_+3A_price_dynamics">price_dynamics</code></td>
<td>
<p>A formula representation of the price equation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The following two subsections describe the common initialization steps of all market
model classes.
</p>


<h4>Variable construction</h4>

<p>The constructor prepares the model's variables using the passed
specifications. The specification variables are expected to be of type
<code>language</code>. The right hand side specifications of the system are
expected to follow the syntax of <code><a href="stats.html#topic+formula">formula</a></code>. The
construction of the model's data uses the variables extracted by these
specification. The demand variables are extracted by a
formula that uses the <code>quantity</code> on the left hand side and the
<code>demand</code> on the right hand side of the formula. The supply
variables are constructed by the <code>quantity</code> and the
<code>supply</code> inputs. In the case of the
<code><a href="#topic+diseq_stochastic_adjustment-class">diseq_stochastic_adjustment</a></code> model, the price dynamics'
variables are extracted using the <code>price dynamics</code> input.
The <code>price dynamics</code> for the <code><a href="#topic+diseq_stochastic_adjustment-class">diseq_stochastic_adjustment</a></code>
should contain only terms other than that of excess demand. The excess demand term of
the price equation is automatically generated by the constructor.
</p>



<h4>Data preparation</h4>

<p>1. If the passed data set contains rows with NA values, they are dropped. If the
verbosity level allows warnings, a warning is emitted reporting how many rows were
dropped.
</p>
<p>2. After dropping the rows, factor levels may be invalidated. If needed, the
constructor readjusts the factor variables by removing the unobserved levels. Factor
indicators and interaction terms are automatically created.
</p>
<p>3. The primary key column is constructed by pasting the values of the columns of
the subject and time variables.
</p>
<p>4. In the cases of the <code><a href="#topic+diseq_directional-class">diseq_directional</a></code>,
<code><a href="#topic+diseq_deterministic_adjustment-class">diseq_deterministic_adjustment</a></code>, and
the <code><a href="#topic+diseq_stochastic_adjustment-class">diseq_stochastic_adjustment</a></code> models, a column with lagged
prices is constructed. Since lagged prices are unavailable for the observations of
the first time point, these observations are dropped. If the verbosity level allows
the emission of information messages, the constructor prints the number of dropped
observations.
</p>
<p>5. In the cases of the <code><a href="#topic+diseq_directional-class">diseq_directional</a></code>
and the <code><a href="#topic+diseq_stochastic_adjustment-class">diseq_stochastic_adjustment</a></code> models, a column with price
differences is created.
</p>



<h3>Value</h3>

<p>The initialized model.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>initialize(diseq_basic)</code>: Basic disequilibrium model base
constructor
</p>
</li>
<li> <p><code>initialize(diseq_deterministic_adjustment)</code>: Disequilibrium model with deterministic price
adjustment constructor
</p>
</li>
<li> <p><code>initialize(diseq_directional)</code>: Directional disequilibrium model base constructor
</p>
</li>
<li> <p><code>initialize(diseq_stochastic_adjustment)</code>: Disequilibrium model with stochastic price
adjustment constructor
</p>
</li>
<li> <p><code>initialize(equilibrium_model)</code>: Equilibrium model constructor
</p>
</li></ul>


<h3>Examples</h3>

<pre><code class='language-R'>simulated_data &lt;- simulate_data(
  "diseq_basic", 500, 3, # model type, observed entities, observed time points
  -0.9, 8.9, c(0.3, -0.2), c(-0.03, -0.01), # demand coefficients
  0.9, 6.2, c(0.03), c(-0.05, 0.02) # supply coefficients
)

# initialize the model
model &lt;- new(
  "diseq_basic", # model type
  subject = id, time = date, quantity = Q, price = P,
  demand = P + Xd1 + Xd2 + X1 + X2, supply = P + Xs1 + X1 + X2,
  simulated_data, # data
  correlated_shocks = FALSE # use independent shocks
)

show(model)
simulated_data &lt;- simulate_data(
  # model type, observed entities and time points
  "diseq_deterministic_adjustment", 500, 3,
  # demand coefficients
  -0.9, 8.9, c(0.03, -0.02), c(-0.03, -0.01),
  # supply coefficients
  0.9, 4.2, c(0.03), c(0.05, 0.02),
  # price adjustment coefficient
  1.4
)

# initialize the model
model &lt;- new(
  "diseq_deterministic_adjustment", # model type
  subject = id, time = date, quantity = Q, price = P,
  demand = P + Xd1 + Xd2 + X1 + X2, supply = P + Xs1 + X1 + X2,
  simulated_data, # data
  correlated_shocks = TRUE # allow shocks to be correlated
)

show(model)

simulated_data &lt;- simulate_data(
  "diseq_directional", 500, 3, # model type, observed entities, observed time points
  -0.2, 4.3, c(0.03, 0.02), c(0.03, 0.01), # demand coefficients
  0.0, 4.0, c(0.03), c(0.05, 0.02) # supply coefficients
)

# in the directional model prices cannot be included in both demand and supply
model &lt;- new(
  "diseq_directional", # model type
  subject = id, time = date, quantity = Q, price = P,
  demand = P + Xd1 + Xd2 + X1 + X2, supply = Xs1 + X1 + X2,
  simulated_data, # data
  correlated_shocks = TRUE # allow shocks to be correlated
)

show(model)

simulated_data &lt;- simulate_data(
  # model type, observed entities and time points
  "diseq_stochastic_adjustment", 500, 3,
  # demand coefficients
  -0.1, 9.8, c(0.3, -0.2), c(0.6, 0.1),
  # supply coefficients
  0.1, 7.1, c(0.9), c(-0.5, 0.2),
  # price adjustment coefficient
  1.4, 3.1, c(0.8)
)

# initialize the model
model &lt;- new(
  "diseq_stochastic_adjustment", # model type
  subject = id, time = date, quantity = Q, price = P,
  demand = P + Xd1 + Xd2 + X1 + X2, supply = P + Xs1 + X1 + X2,
  price_dynamics = Xp1,
  simulated_data, # data
  correlated_shocks = TRUE # allow shocks to be correlated
)

show(model)
simulated_data &lt;- simulate_data(
  "equilibrium_model", 500, 3, # model type, observed entities and time points
  -0.9, 14.9, c(0.3, -0.2), c(-0.03, -0.01), # demand coefficients
  0.9, 3.2, c(0.3), c(0.5, 0.02) # supply coefficients
)

# initialize the model
model &lt;- new(
  "equilibrium_model", # model type
  subject = id, time = date, quantity = Q, price = P,
  demand = P + Xd1 + Xd2 + X1 + X2, supply = P + Xs1 + X1 + X2,
  simulated_data, # data
  correlated_shocks = TRUE # allow shocks to be correlated
)

show(model)
</code></pre>

<hr>
<h2 id='model_likelihoods'>Model likelihoods and derivatives</h2><span id='topic+model_likelihoods'></span><span id='topic+log_likelihood'></span><span id='topic+gradient'></span><span id='topic+hessian'></span><span id='topic+scores'></span><span id='topic+log_likelihood+2Cdiseq_basic-method'></span><span id='topic+gradient+2Cdiseq_basic-method'></span><span id='topic+scores+2Cdiseq_basic+2CANY+2CANY-method'></span><span id='topic+log_likelihood+2Cdiseq_deterministic_adjustment-method'></span><span id='topic+gradient+2Cdiseq_deterministic_adjustment-method'></span><span id='topic+scores+2Cdiseq_deterministic_adjustment+2CANY+2CANY-method'></span><span id='topic+log_likelihood+2Cdiseq_directional-method'></span><span id='topic+gradient+2Cdiseq_directional-method'></span><span id='topic+scores+2Cdiseq_directional+2CANY+2CANY-method'></span><span id='topic+log_likelihood+2Cdiseq_stochastic_adjustment-method'></span><span id='topic+gradient+2Cdiseq_stochastic_adjustment-method'></span><span id='topic+scores+2Cdiseq_stochastic_adjustment+2CANY+2CANY-method'></span><span id='topic+log_likelihood+2Cequilibrium_model-method'></span><span id='topic+gradient+2Cequilibrium_model-method'></span><span id='topic+scores+2Cequilibrium_model+2CANY+2CANY-method'></span><span id='topic+hessian+2Cdiseq_basic-method'></span><span id='topic+hessian+2Cdiseq_directional-method'></span><span id='topic+scores+2Cmissing+2Cmissing+2Cmarket_fit-method'></span>

<h3>Description</h3>

<p>Methods that calculate the likelihoods, scores, gradients, and Hessians
of market models. The likelihood functions are based on
Maddala and Nelson (1974) <a href="https://doi.org/10.2307/1914215">doi:10.2307/1914215</a>. The likelihoods, gradient, and
Hessian expressions that the function uses are derived in
Karapanagiotis (2020) <a href="https://doi.org/10.2139/ssrn.3525622">doi:10.2139/ssrn.3525622</a>.
</p>


<h4><code>log_likelihood</code></h4>

<p>Returns the log-likelihood. The function calculates the model's log likelihood by
evaluating the log likelihood of each observation in the sample and summing the
evaluation results.</p>



<h4><code>gradient</code></h4>

<p>Returns the gradient of the log-likelihood
evaluated at the passed parameters.</p>



<h4><code>hessian</code></h4>

<p>Returns the hessian of the log-likelihood evaluated
at the passed parameters.</p>



<h4><code>scores</code></h4>

<p>It calculates the gradient of the likelihood at the given parameter point
for each observation in the sample. It, therefore, returns an n x k matrix,
where n denotes the number of observations in the sample and k the number
of estimated parameters. The ordering of the parameters is the same as
the one that is used in the summary of the results. The method can be
called either using directly a fitted model object, or by separately
providing a model object and a parameter vector.</p>



<h3>Usage</h3>

<pre><code class='language-R'>log_likelihood(object, parameters)

gradient(object, parameters)

hessian(object, parameters)

scores(object, parameters, fit)

## S4 method for signature 'diseq_basic'
log_likelihood(object, parameters)

## S4 method for signature 'diseq_basic'
gradient(object, parameters)

## S4 method for signature 'diseq_basic,ANY,ANY'
scores(object, parameters)

## S4 method for signature 'diseq_deterministic_adjustment'
log_likelihood(object, parameters)

## S4 method for signature 'diseq_deterministic_adjustment'
gradient(object, parameters)

## S4 method for signature 'diseq_deterministic_adjustment,ANY,ANY'
scores(object, parameters)

## S4 method for signature 'diseq_directional'
log_likelihood(object, parameters)

## S4 method for signature 'diseq_directional'
gradient(object, parameters)

## S4 method for signature 'diseq_directional,ANY,ANY'
scores(object, parameters)

## S4 method for signature 'diseq_stochastic_adjustment'
log_likelihood(object, parameters)

## S4 method for signature 'diseq_stochastic_adjustment'
gradient(object, parameters)

## S4 method for signature 'diseq_stochastic_adjustment,ANY,ANY'
scores(object, parameters)

## S4 method for signature 'equilibrium_model'
log_likelihood(object, parameters)

## S4 method for signature 'equilibrium_model'
gradient(object, parameters)

## S4 method for signature 'equilibrium_model,ANY,ANY'
scores(object, parameters)

## S4 method for signature 'diseq_basic'
hessian(object, parameters)

## S4 method for signature 'diseq_directional'
hessian(object, parameters)

## S4 method for signature 'missing,missing,market_fit'
scores(fit)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="model_likelihoods_+3A_object">object</code></td>
<td>
<p>A model object.</p>
</td></tr>
<tr><td><code id="model_likelihoods_+3A_parameters">parameters</code></td>
<td>
<p>A vector of parameters at which the function is to be evaluated.</p>
</td></tr>
<tr><td><code id="model_likelihoods_+3A_fit">fit</code></td>
<td>
<p>A fitted model object.</p>
</td></tr>
</table>


<h3>Value</h3>



<h4><code>log_likelihood</code></h4>

<p>The sum of the likelihoods evaluated for each observation.</p>



<h4><code>gradient</code></h4>

<p>The log likelihood's gradient.</p>



<h4><code>hessian</code></h4>

<p>The log likelihood's hessian.</p>



<h4><code>scores</code></h4>

<p>The score matrix.</p>



<h3>Examples</h3>

<pre><code class='language-R'>
model &lt;- simulate_model(
  "diseq_basic", list(
    # observed entities, observed time points
    nobs = 500, tobs = 3,
    # demand coefficients
    alpha_d = -0.9, beta_d0 = 8.9, beta_d = c(0.6), eta_d = c(-0.2),
    # supply coefficients
    alpha_s = 0.9, beta_s0 = 7.9, beta_s = c(0.03, 1.2), eta_s = c(0.1)
  ),
  seed = 7523
)

# estimate the model object (BFGS is used by default)
fit &lt;- estimate(model)

# Calculate the score matrix
head(scores(model, coef(fit)))

</code></pre>

<hr>
<h2 id='model_logger-class'>Logger class</h2><span id='topic+model_logger-class'></span>

<h3>Description</h3>

<p>Logger class
</p>


<h3>Slots</h3>


<dl>
<dt><code>verbosity</code></dt><dd><p>Controls the intensity of output messages. Errors are always printed.
Other than this, a value of
</p>

<dl>
<dt>1</dt><dd><p>prints warnings,</p>
</dd>
<dt>2</dt><dd><p>prints basic information,</p>
</dd>
<dt>3</dt><dd><p>prints verbose information and,</p>
</dd>
<dt>4</dt><dd><p>prints debug information.</p>
</dd>
</dl>
</dd>
</dl>

<hr>
<h2 id='ncoef'>Number of coefficients</h2><span id='topic+ncoef'></span><span id='topic+ncoef+2Cmarket_model-method'></span><span id='topic+ncoef+2Cmarket_fit-method'></span>

<h3>Description</h3>

<p>Returns the number of model's coefficients. This is the sum of demand, supply, price
equation, and the variance-covariance matrix coefficients.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ncoef(object)

## S4 method for signature 'market_model'
ncoef(object)

## S4 method for signature 'market_fit'
ncoef(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ncoef_+3A_object">object</code></td>
<td>
<p>A model object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The number of model coefficients.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
model &lt;- new(
  "diseq_basic", # model type
  subject = ID, time = TREND, quantity = HS, price = RM,
  demand = RM + TREND + W + CSHS + L1RM + L2RM + MONTH,
  supply = RM + TREND + W + L1RM + MA6DSF + MA3DHF + MONTH,
  fair_houses()
)

# get the number of model coefficients
ncoef(model)

</code></pre>

<hr>
<h2 id='nobs+2Cmarket_model-method'>Number of observations</h2><span id='topic+nobs+2Cmarket_model-method'></span><span id='topic+nobs+2Cmarket_fit-method'></span>

<h3>Description</h3>

<p>Returns the number of observations that are used by an initialized model. If there
are missing values, the number of used observations may differ from the numbers
of observations of the data set that was passed to the model's initialization.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'market_model'
nobs(object)

## S4 method for signature 'market_fit'
nobs(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nobs+2B2Cmarket_model-method_+3A_object">object</code></td>
<td>
<p>A model object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The number of used observations.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
model &lt;- new(
  "diseq_basic", # model type
  subject = ID, time = TREND, quantity = HS, price = RM,
  demand = RM + TREND + W + CSHS + L1RM + L2RM + MONTH,
  supply = RM + TREND + W + L1RM + MA6DSF + MA3DHF + MONTH,
  fair_houses()
)

# get the number observations
nobs(model)

</code></pre>

<hr>
<h2 id='plot+2Cmarket_fit-method'>Plots the fitted model</h2><span id='topic+plot+2Cmarket_fit-method'></span>

<h3>Description</h3>

<p>Displays a graphical illustration of the passed fitted model object. The
function creates a scatter plot of quantity-price pairs for the records
corresponding to the given subject and time identifiers. Then, it plots
the average fitted demand and supply quantities for the same data subset
letting prices vary between the minimum and maximum price
points observed in the data subset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'market_fit'
plot(x, subject, time, show_scatter = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot+2B2Cmarket_fit-method_+3A_x">x</code></td>
<td>
<p>A model object.</p>
</td></tr>
<tr><td><code id="plot+2B2Cmarket_fit-method_+3A_subject">subject</code></td>
<td>
<p>A vector of subject identifiers to be used in the
visualization.</p>
</td></tr>
<tr><td><code id="plot+2B2Cmarket_fit-method_+3A_time">time</code></td>
<td>
<p>A vector of time identifiers to be used in the visualization.</p>
</td></tr>
<tr><td><code id="plot+2B2Cmarket_fit-method_+3A_show_scatter">show_scatter</code></td>
<td>
<p>Should the price-quantity scatter be plotted? By default
<code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot+2B2Cmarket_fit-method_+3A_...">...</code></td>
<td>
<p>Additional parameters to be used for styling the figure.
Specifically <code>xlab</code>, <code>ylab</code>, and <code>main</code> are currently
handled by the function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the <code>subject</code> argument is missing, all subjects are used. If the
<code>time</code> argument is missing, all time points are used. The scatter
plot of the quantity-price data can be suppressed by setting
<code>show_scatter = FALSE</code>.
</p>


<h3>Value</h3>

<p>No return value, called for for side effects (visualization).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# estimate a model using the houses dataset
fit &lt;- diseq_deterministic_adjustment(
  HS | RM | ID | TREND ~
    RM + TREND + W + CSHS + L1RM + L2RM + MONTH |
      RM + TREND + W + L1RM + MA6DSF + MA3DHF + MONTH,
  fair_houses(),
  correlated_shocks = FALSE,
  estimation_options = list(control = list(maxit = 1e+6))
)

# show model's illustration plot
plot(fit)

</code></pre>

<hr>
<h2 id='shortage_analysis'>Analysis of shortages</h2><span id='topic+shortage_analysis'></span><span id='topic+shortages'></span><span id='topic+normalized_shortages'></span><span id='topic+relative_shortages'></span><span id='topic+shortage_probabilities'></span><span id='topic+shortage_indicators'></span><span id='topic+shortage_standard_deviation'></span><span id='topic+shortages+2Cmissing+2Cmarket_model+2CANY-method'></span><span id='topic+normalized_shortages+2Cmissing+2Cmarket_model+2CANY-method'></span><span id='topic+relative_shortages+2Cmissing+2Cmarket_model+2CANY-method'></span><span id='topic+shortage_probabilities+2Cmissing+2Cmarket_model+2CANY-method'></span><span id='topic+shortage_indicators+2Cmissing+2Cmarket_model+2CANY-method'></span><span id='topic+shortage_standard_deviation+2Cmissing+2Cmarket_model+2CANY-method'></span><span id='topic+shortage_standard_deviation+2Cmissing+2Cdiseq_stochastic_adjustment+2CANY-method'></span><span id='topic+shortages+2Cmarket_fit+2Cmissing+2Cmissing-method'></span><span id='topic+normalized_shortages+2Cmarket_fit+2Cmissing+2Cmissing-method'></span><span id='topic+relative_shortages+2Cmarket_fit+2Cmissing+2Cmissing-method'></span><span id='topic+shortage_probabilities+2Cmarket_fit+2Cmissing+2Cmissing-method'></span><span id='topic+shortage_indicators+2Cmarket_fit+2Cmissing+2Cmissing-method'></span><span id='topic+shortage_standard_deviation+2Cmarket_fit+2Cmissing+2Cmissing-method'></span>

<h3>Description</h3>

<p>The following methods offer functionality for analyzing estimated
shortages of the market models. The methods can be called either
using directly a fitted model object, or by separately providing a model
object and a parameter vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shortages(fit, model, parameters)

normalized_shortages(fit, model, parameters)

relative_shortages(fit, model, parameters)

shortage_probabilities(fit, model, parameters)

shortage_indicators(fit, model, parameters)

shortage_standard_deviation(fit, model, parameters)

## S4 method for signature 'missing,market_model,ANY'
shortages(model, parameters)

## S4 method for signature 'missing,market_model,ANY'
normalized_shortages(model, parameters)

## S4 method for signature 'missing,market_model,ANY'
relative_shortages(model, parameters)

## S4 method for signature 'missing,market_model,ANY'
shortage_probabilities(model, parameters)

## S4 method for signature 'missing,market_model,ANY'
shortage_indicators(model, parameters)

## S4 method for signature 'missing,market_model,ANY'
shortage_standard_deviation(model, parameters)

## S4 method for signature 'missing,diseq_stochastic_adjustment,ANY'
shortage_standard_deviation(model, parameters)

## S4 method for signature 'market_fit,missing,missing'
shortages(fit)

## S4 method for signature 'market_fit,missing,missing'
normalized_shortages(fit)

## S4 method for signature 'market_fit,missing,missing'
relative_shortages(fit)

## S4 method for signature 'market_fit,missing,missing'
shortage_probabilities(fit)

## S4 method for signature 'market_fit,missing,missing'
shortage_indicators(fit)

## S4 method for signature 'market_fit,missing,missing'
shortage_standard_deviation(fit)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="shortage_analysis_+3A_fit">fit</code></td>
<td>
<p>A fitted model object.</p>
</td></tr>
<tr><td><code id="shortage_analysis_+3A_model">model</code></td>
<td>
<p>A market model object.</p>
</td></tr>
<tr><td><code id="shortage_analysis_+3A_parameters">parameters</code></td>
<td>
<p>A vector of parameters at which the shortages are evaluated.</p>
</td></tr>
</table>


<h3>Details</h3>



<h4>shortages</h4>

<p>Returns the predicted shortages at a given point.
</p>



<h4>normalized_shortages</h4>

<p>Returns the shortages normalized by the variance of the difference of the shocks
at a given point.
</p>



<h4>relative_shortages</h4>

<p>Returns the shortages normalized by the supplied quantity at a given point.
</p>



<h4>shortage_probabilities</h4>

<p>Returns the shortage probabilities, i.e. the probabilities of an
observation coming from an excess demand state, at the given point.
</p>



<h4>shortage_indicators</h4>

<p>Returns a vector of indicators (Boolean values) for each observation. An
element of the vector is TRUE for observations at which the estimated
shortages are non-negative, i.e. the market at in an excess demand state.
The remaining elements are FALSE. The evaluation of the shortages is
performed using the passed parameter vector.
</p>



<h4>shortage_standard_deviation</h4>

<p>Returns the standard deviation of excess demand.
</p>



<h3>Value</h3>

<p>A vector with the (estimated) shortages.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>shortages()</code>: Shortages.
</p>
</li>
<li> <p><code>normalized_shortages()</code>: Normalized shortages.
</p>
</li>
<li> <p><code>relative_shortages()</code>: Relative shortages.
</p>
</li>
<li> <p><code>shortage_probabilities()</code>: Shortage probabilities.
</p>
</li>
<li> <p><code>shortage_indicators()</code>: Shortage indicators.
</p>
</li>
<li> <p><code>shortage_standard_deviation()</code>: Shortage standard deviation.
</p>
</li></ul>


<h3>Examples</h3>

<pre><code class='language-R'>
# estimate a model using the houses dataset
fit &lt;- diseq_deterministic_adjustment(
  HS | RM | ID | TREND ~
    RM + TREND + W + CSHS + L1RM + L2RM + MONTH |
      RM + TREND + W + L1RM + MA6DSF + MA3DHF + MONTH,
  fair_houses(),
  correlated_shocks = FALSE,
  estimation_options = list(control = list(maxit = 1e+5))
)

# get estimated normalized shortages
head(normalized_shortages(fit))

# get estimated relative shortages
head(relative_shortages(fit))

# get the estimated shortage probabilities
head(shortage_probabilities(fit))

# get the estimated shortage indicators
head(shortage_indicators(fit))

# get the estimated shortages
head(shortages(fit))

# get the estimated shortage standard deviation
shortage_standard_deviation(fit)

</code></pre>

<hr>
<h2 id='show+2Cmarket_model-method'>Prints a short description of the model</h2><span id='topic+show+2Cmarket_model-method'></span><span id='topic+show+2Cmarket_fit-method'></span>

<h3>Description</h3>

<p>Sends basic information about the model to standard output.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'market_model'
show(object)

## S4 method for signature 'market_fit'
show(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="show+2B2Cmarket_model-method_+3A_object">object</code></td>
<td>
<p>A model object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for side effects (print basic model information).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
fit &lt;- equilibrium_model(
  HS | RM | ID | TREND ~
    RM + TREND + W + CSHS + L1RM + L2RM + MONTH |
      RM + TREND + W + L1RM + MA6DSF + MA3DHF + MONTH,
  fair_houses(),
  estimation_options = list(method = "2SLS")
)

# print model information
show(fit@model)

# print fit information
show(fit)

</code></pre>

<hr>
<h2 id='single_call_estimation'>Single call estimation</h2><span id='topic+single_call_estimation'></span><span id='topic+diseq_basic'></span><span id='topic+diseq_basic+2Cformula-method'></span><span id='topic+diseq_deterministic_adjustment'></span><span id='topic+diseq_deterministic_adjustment+2Cformula-method'></span><span id='topic+diseq_directional'></span><span id='topic+diseq_directional+2Cformula-method'></span><span id='topic+diseq_stochastic_adjustment'></span><span id='topic+diseq_stochastic_adjustment+2Cformula-method'></span><span id='topic+equilibrium_model'></span><span id='topic+equilibrium_model+2Cformula-method'></span>

<h3>Description</h3>

<p>Single call estimation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>diseq_basic(
  specification,
  data,
  correlated_shocks = TRUE,
  verbose = 0,
  estimation_options = list()
)

## S4 method for signature 'formula'
diseq_basic(
  specification,
  data,
  correlated_shocks = TRUE,
  verbose = 0,
  estimation_options = list()
)

diseq_deterministic_adjustment(
  specification,
  data,
  correlated_shocks = TRUE,
  verbose = 0,
  estimation_options = list()
)

## S4 method for signature 'formula'
diseq_deterministic_adjustment(
  specification,
  data,
  correlated_shocks = TRUE,
  verbose = 0,
  estimation_options = list()
)

diseq_directional(
  specification,
  data,
  correlated_shocks = TRUE,
  verbose = 0,
  estimation_options = list()
)

## S4 method for signature 'formula'
diseq_directional(
  specification,
  data,
  correlated_shocks = TRUE,
  verbose = 0,
  estimation_options = list()
)

diseq_stochastic_adjustment(
  specification,
  data,
  correlated_shocks = TRUE,
  verbose = 0,
  estimation_options = list()
)

## S4 method for signature 'formula'
diseq_stochastic_adjustment(
  specification,
  data,
  correlated_shocks = TRUE,
  verbose = 0,
  estimation_options = list()
)

equilibrium_model(
  specification,
  data,
  correlated_shocks = TRUE,
  verbose = 0,
  estimation_options = list()
)

## S4 method for signature 'formula'
equilibrium_model(
  specification,
  data,
  correlated_shocks = TRUE,
  verbose = 0,
  estimation_options = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="single_call_estimation_+3A_specification">specification</code></td>
<td>
<p>The model's formula.</p>
</td></tr>
<tr><td><code id="single_call_estimation_+3A_data">data</code></td>
<td>
<p>The data to be used with the model.</p>
</td></tr>
<tr><td><code id="single_call_estimation_+3A_correlated_shocks">correlated_shocks</code></td>
<td>
<p>Should the model's system entail correlated shocks?
By default the argument is set to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="single_call_estimation_+3A_verbose">verbose</code></td>
<td>
<p>The verbosity with which operations on the model print
messages. By default the value is set to <code>0</code>, which prints only errors.</p>
</td></tr>
<tr><td><code id="single_call_estimation_+3A_estimation_options">estimation_options</code></td>
<td>
<p>A list with options to be used in the estimation
call. See <code><a href="#topic+estimate">estimate</a></code> for the available options.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The functions of this section combine model initialization and estimation
into a single call. They also provide a less verbose interface to the
functionality of the package. The functions expect a formula following the
specification described in <a href="#topic+market_model_formula">formula</a>, a
dataset, and optionally further initialization and
estimation options (see <a href="#topic+model_initialization">model initialization</a>
and <a href="#topic+estimate">model estimation</a> respectively).
</p>
<p>Estimation options are expected to be given in the argument
<code>estimation_options</code> in a form of a <code><a href="base.html#topic+list">list</a></code>. The list
names should correspond to variables of the <code><a href="#topic+estimate">estimate</a></code>
function. As a result, optimization options, which are customized using
the <code>control</code> argument of <code><a href="#topic+estimate">estimate</a></code> can be passed
as an element of <code>estimation_options</code>.
</p>
<p>Each of these functions parses the given formula, initializes the model
specified by the function's name, fits the model to the given data using
the estimation options and returns fitted model.
</p>


<h3>Value</h3>

<p>The fitted model.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>diseq_basic()</code>: Basic disequilibrium model.
</p>
</li>
<li> <p><code>diseq_deterministic_adjustment()</code>: Disequilibrium model with deterministic
price adjustments.
</p>
</li>
<li> <p><code>diseq_directional()</code>: Directional disequilibrium model.
</p>
</li>
<li> <p><code>diseq_stochastic_adjustment()</code>: Disequilibrium model with stochastic
price adjustments.
</p>
</li>
<li> <p><code>equilibrium_model()</code>: Equilibrium model
</p>
</li></ul>


<h3>Examples</h3>

<pre><code class='language-R'>
# An example of estimating the equilibrium model
eq &lt;- equilibrium_model(
  HS | RM | ID | TREND ~ RM + TREND + W + CSHS + L1RM + L2RM + MONTH |
    RM + TREND + W + L1RM + MA6DSF + MA3DHF + MONTH,
  fair_houses(), estimation_options = list(control = list(maxit = 5000))
)

# An example of estimating the deterministic adjustment model
da &lt;- diseq_deterministic_adjustment(
  HS | RM | ID | TREND ~ RM + TREND + W + CSHS + L1RM + L2RM + MONTH |
    RM + TREND + W + L1RM + MA6DSF + MA3DHF + MONTH,
  fair_houses(),
  verbose = 2,
  estimation_options = list(control = list(maxit = 5000))
)

# An example of estimating the directional model
dr &lt;- diseq_directional(
  HS | RM | ID | TREND ~ TREND + W + CSHS + L1RM + L2RM |
    RM + TREND + W + MA6DSF + MA3DHF + MONTH,
  fair_houses(), estimation_options = list(
    method = "Nelder-Mead", control = list(maxit = 5000)
  )
)

# An example of estimating the basic model
start &lt;- coef(eq)
start &lt;- start[names(start) != "RHO"]
bs &lt;- diseq_basic(
  HS | RM | ID | TREND ~ RM + TREND + W + CSHS + L1RM + L2RM + MONTH |
    RM + TREND + W + L1RM + MA6DSF + MA3DHF + MONTH,
  fair_houses(), verbose = 2, correlated_shocks = FALSE,
  estimation_options = list(
    start = start,
    control = list(maxit = 5000)
  )
)

# An example of estimating the stochastic adjustment model
sa &lt;- diseq_stochastic_adjustment(
  HS | RM | ID | TREND ~ RM + TREND + W + CSHS + MONTH |
    RM + TREND + W + L1RM + L2RM + MA6DSF + MA3DHF + MONTH |
    TREND + L2RM + L3RM,
  fair_houses() |&gt; dplyr::mutate(L3RM = dplyr::lag(RM, 3)),
  correlated_shocks = FALSE,
  estimation_options = list(
    control = list(maxit = 5000), standard_errors = c("W")
  )
)

</code></pre>

<hr>
<h2 id='summary'>Model and fit summaries</h2><span id='topic+summary'></span><span id='topic+summary+2Cmarket_model-method'></span><span id='topic+summary+2Cmarket_fit-method'></span>

<h3>Description</h3>

<p>Methods that summarize models and their estimates.
</p>
<p><code>market_model</code>: Prints basic information about the
passed model object. In addition to the output of
the <code><a href="methods.html#topic+show">show</a></code> method, <code>summary</code> prints
</p>

<ul>
<li><p> the number of observations,
</p>
</li>
<li><p> the number of observations in each equation for models with sample
separation, and
</p>
</li>
<li><p> various categories of variables.
</p>
</li></ul>

<p><code>market_fit</code>: Prints basic information about the
passed model fit. In addition to the output of
the model's <code>summary</code> method, the function prints basic
estimation results. For a maximum likelihood estimation, the function prints
</p>

<ul>
<li><p> the used optimization method,
</p>
</li>
<li><p> the maximum number of allowed iterations,
</p>
</li>
<li><p> the relative convergence tolerance (see <code><a href="stats.html#topic+optim">optim</a></code>),
</p>
</li>
<li><p> the convergence status,
</p>
</li>
<li><p> the initializing parameter values,
</p>
</li>
<li><p> the estimated coefficients, their standard errors, Z values, and P values, and
</p>
</li>
<li> <p><code class="reqn">-2 \log L</code> evaluated at the maximum.
</p>
</li></ul>

<p>For a linear estimation of the equilibrium system, the function prints
</p>

<ul>
<li><p> the used method,
</p>
</li>
<li><p> the summary of the first stage regression,
</p>
</li>
<li><p> the summary of the demand (second stage) regression, and
</p>
</li>
<li><p> the summary of the supply (second stage) regression.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'market_model'
summary(object)

## S4 method for signature 'market_fit'
summary(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary_+3A_object">object</code></td>
<td>
<p>An object to be summarized.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for for side effects (print summary).
</p>


<h3>Methods (by class)</h3>


<ul>
<li> <p><code>summary(market_model)</code>: Summarizes the model.
</p>
</li>
<li> <p><code>summary(market_fit)</code>: Summarizes the model's fit.
</p>
</li></ul>


<h3>Examples</h3>

<pre><code class='language-R'>
model &lt;- simulate_model(
  "diseq_stochastic_adjustment", list(
    # observed entities, observed time points
    nobs = 500, tobs = 3,
    # demand coefficients
    alpha_d = -0.1, beta_d0 = 9.8, beta_d = c(0.3, -0.2), eta_d = c(0.6, -0.1),
    # supply coefficients
    alpha_s = 0.1, beta_s0 = 5.1, beta_s = c(0.9), eta_s = c(-0.5, 0.2),
    # price equation coefficients
    gamma = 1.2, beta_p0 = 3.1, beta_p = c(0.8)
  ),
  seed = 556
)

# print model summary
summary(model)

# estimate
fit &lt;- estimate(model)

# print estimation summary
summary(fit)

</code></pre>

<hr>
<h2 id='system_classes'>System classes</h2><span id='topic+system_classes'></span><span id='topic+system_basic-class'></span><span id='topic+system_deterministic_adjustment-class'></span><span id='topic+system_directional-class'></span><span id='topic+system_equilibrium-class'></span><span id='topic+system_stochastic_adjustment-class'></span>

<h3>Description</h3>

<p>Classes with data and functionality describing systems of models.
</p>


<h3>Details</h3>



<h4><code>system_base</code></h4>

<p>System base class</p>



<h4><code>system_basic</code></h4>

<p>Basic model's system class</p>



<h4><code>system_deterministic_adjustment</code></h4>

<p>Deterministic adjustment model's system class</p>



<h4><code>system_directional</code></h4>

<p>Directional system class</p>



<h4><code>system_equilibrium</code></h4>

<p>Equilibrium model's system class</p>



<h4><code>system_stochastic_adjustment</code></h4>

<p>Stochastic adjustment model's system class</p>



<h3>Slots</h3>


<dl>
<dt><code>demand</code></dt><dd><p>Demand equation.</p>
</dd>
<dt><code>supply</code></dt><dd><p>Supply equation.</p>
</dd>
<dt><code>correlated_shocks</code></dt><dd><p>Boolean indicating whether the shock of the
equations of the system are correlated.</p>
</dd>
<dt><code>sample_separation</code></dt><dd><p>Boolean indicating whether the sample of the
system is separated.</p>
</dd>
<dt><code>quantity_vector</code></dt><dd><p>A vector with the system's observed quantities.</p>
</dd>
<dt><code>price_vector</code></dt><dd><p>A vector with the system's observed prices.</p>
</dd>
<dt><code>rho</code></dt><dd><p>Correlation coefficient of demand and supply shocks.</p>
</dd>
<dt><code>rho1</code></dt><dd><p style="text-align: center;"><code class="reqn">\rho_{1} = \frac{1}{\sqrt{1 - \rho}}</code>
</p>
</dd>
<dt><code>rho2</code></dt><dd><p style="text-align: center;"><code class="reqn">\rho_{2} = \rho\rho_{1}</code>
</p>
</dd>
<dt><code>lh</code></dt><dd><p>Likelihood values for each observation.</p>
</dd>
<dt><code>gamma</code></dt><dd><p>Excess demand coefficient.</p>
</dd>
<dt><code>delta</code></dt><dd><p style="text-align: center;"><code class="reqn">\delta = \gamma + \alpha_{d} - \alpha_{s}</code>
</p>
</dd>
<dt><code>mu_P</code></dt><dd><p style="text-align: center;"><code class="reqn">\mu_{P} = \mathrm{E}P</code>
</p>
</dd>
<dt><code>var_P</code></dt><dd><p style="text-align: center;"><code class="reqn">V_{P} = \mathrm{Var}P</code>
</p>
</dd>
<dt><code>sigma_P</code></dt><dd><p style="text-align: center;"><code class="reqn">\sigma_{P} = \sqrt{V_{P}}</code>
</p>
</dd>
<dt><code>h_P</code></dt><dd><p style="text-align: center;"><code class="reqn">h_{P} = \frac{P - \mu_{P}}{\sigma_{P}}</code>
</p>
</dd>
<dt><code>lagged_price_vector</code></dt><dd><p>A vector with the system's observed prices lagged by
one date.</p>
</dd>
<dt><code>mu_Q</code></dt><dd><p style="text-align: center;"><code class="reqn">\mu_{Q} = \mathrm{E}Q</code>
</p>
</dd>
<dt><code>var_Q</code></dt><dd><p style="text-align: center;"><code class="reqn">V_{Q} = \mathrm{Var}Q</code>
</p>
</dd>
<dt><code>sigma_Q</code></dt><dd><p style="text-align: center;"><code class="reqn">\sigma_{Q} = \sqrt{V_{Q}}</code>
</p>
</dd>
<dt><code>h_Q</code></dt><dd><p style="text-align: center;"><code class="reqn">h_{Q} = \frac{Q - \mu_{Q}}{\sigma_{Q}}</code>
</p>
</dd>
<dt><code>rho_QP</code></dt><dd><p style="text-align: center;"><code class="reqn">\rho_{QP} =
\frac{\mathrm{Cov}(Q,P)}{\sqrt{\mathrm{Var}Q\mathrm{Var}P}}</code>
</p>
</dd>
<dt><code>rho_1QP</code></dt><dd><p style="text-align: center;"><code class="reqn">\rho_{1,QP} = \frac{1}{\sqrt{1 - \rho_{QP}^2}}</code>
</p>
</dd>
<dt><code>rho_2QP</code></dt><dd><p style="text-align: center;"><code class="reqn">\rho_{2,QP} = \rho_{QP}\rho_{1,QP}</code>
</p>
</dd>
<dt><code>z_QP</code></dt><dd><p style="text-align: center;"><code class="reqn">z_{QP} = \frac{h_{Q} - \rho_{QP}h_{P}}{\sqrt{1 - \rho_{QP}^2}}</code>
</p>
</dd>
<dt><code>z_PQ</code></dt><dd><p style="text-align: center;"><code class="reqn">z_{PQ} = \frac{h_{P} - \rho_{PQ}h_{Q}}{\sqrt{1 - \rho_{PQ}^2}}</code>
</p>
</dd>
<dt><code>price_equation</code></dt><dd><p>Price equation.</p>
</dd>
<dt><code>zeta</code></dt><dd><p style="text-align: center;"><code class="reqn">\zeta = \sqrt{1 - \rho_{DS}^2 - \rho_{DP}^2 - \rho_{SP}^2 +
2 \rho_DP \rho_DS \rho_SP}</code>
</p>
</dd>
<dt><code>zeta_DD</code></dt><dd><p style="text-align: center;"><code class="reqn">\zeta_{DD} = 1 - \rho_{SP}^2</code>
</p>
</dd>
<dt><code>zeta_DS</code></dt><dd><p style="text-align: center;"><code class="reqn">\zeta_{DS} = \rho_{DS} - \rho_{DP}\rho_{SP}</code>
</p>
</dd>
<dt><code>zeta_DP</code></dt><dd><p style="text-align: center;"><code class="reqn">\zeta_{DP} = \rho_{DP} - \rho_{DS}\rho_{SP}</code>
</p>
</dd>
<dt><code>zeta_SS</code></dt><dd><p style="text-align: center;"><code class="reqn">\zeta_{SS} = 1 - \rho_{DP}^2</code>
</p>
</dd>
<dt><code>zeta_SP</code></dt><dd><p style="text-align: center;"><code class="reqn">\zeta_{SP} = \rho_{SP} - \rho_{DS}\rho_{DP}</code>
</p>
</dd>
<dt><code>zeta_PP</code></dt><dd><p style="text-align: center;"><code class="reqn">\zeta_{PP} = 1 - \rho_{DS}^2</code>
</p>
</dd>
<dt><code>mu_D</code></dt><dd><p style="text-align: center;"><code class="reqn">\mu_{D} = \mathrm{E}D</code>
</p>
</dd>
<dt><code>var_D</code></dt><dd><p style="text-align: center;"><code class="reqn">V_{D} = \mathrm{Var}D</code>
</p>
</dd>
<dt><code>sigma_D</code></dt><dd><p style="text-align: center;"><code class="reqn">\sigma_{D} = \sqrt{V_{D}}</code>
</p>
</dd>
<dt><code>mu_S</code></dt><dd><p style="text-align: center;"><code class="reqn">\mu_{S} = \mathrm{E}S</code>
</p>
</dd>
<dt><code>var_S</code></dt><dd><p style="text-align: center;"><code class="reqn">V_{S} = \mathrm{Var}S</code>
</p>
</dd>
<dt><code>sigma_S</code></dt><dd><p style="text-align: center;"><code class="reqn">\sigma_{S} = \sqrt{V_{S}}</code>
</p>
</dd>
<dt><code>sigma_DP</code></dt><dd><p style="text-align: center;"><code class="reqn">\sigma_{DP} = \mathrm{Cov}(D, P)</code>
</p>
</dd>
<dt><code>sigma_DS</code></dt><dd><p style="text-align: center;"><code class="reqn">\sigma_{DS} = \mathrm{Cov}(D, S)</code>
</p>
</dd>
<dt><code>sigma_SP</code></dt><dd><p style="text-align: center;"><code class="reqn">\sigma_{SP} = \mathrm{Cov}(S, P)</code>
</p>
</dd>
<dt><code>rho_DS</code></dt><dd><p style="text-align: center;"><code class="reqn">\rho_{DS} =
\frac{\mathrm{Cov}(D,S)}{\sqrt{\mathrm{Var}D\mathrm{Var}S}}</code>
</p>
</dd>
<dt><code>rho_DP</code></dt><dd><p style="text-align: center;"><code class="reqn">\rho_{DP} =
\frac{\mathrm{Cov}(D,P)}{\sqrt{\mathrm{Var}D\mathrm{Var}P}}</code>
</p>
</dd>
<dt><code>rho_SP</code></dt><dd><p style="text-align: center;"><code class="reqn">\rho_{SP} =
\frac{\mathrm{Cov}(S,P)}{\sqrt{\mathrm{Var}S\mathrm{Var}P}}</code>
</p>
</dd>
<dt><code>h_D</code></dt><dd><p style="text-align: center;"><code class="reqn">h_{D} = \frac{D - \mu_{D}}{\sigma_{D}}</code>
</p>
</dd>
<dt><code>h_S</code></dt><dd><p style="text-align: center;"><code class="reqn">h_{S} = \frac{S - \mu_{S}}{\sigma_{S}}</code>
</p>
</dd>
<dt><code>z_DP</code></dt><dd><p style="text-align: center;"><code class="reqn">z_{DP} = \frac{h_{D} - \rho_{DP}h_{P}}{\sqrt{1 - \rho_{DP}^2}}</code>
</p>
</dd>
<dt><code>z_PD</code></dt><dd><p style="text-align: center;"><code class="reqn">z_{PD} = \frac{h_{P} - \rho_{PD}h_{D}}{\sqrt{1 - \rho_{PD}^2}}</code>
</p>
</dd>
<dt><code>z_SP</code></dt><dd><p style="text-align: center;"><code class="reqn">z_{SP} = \frac{h_{S} - \rho_{SP}h_{P}}{\sqrt{1 - \rho_{SP}^2}}</code>
</p>
</dd>
<dt><code>z_PS</code></dt><dd><p style="text-align: center;"><code class="reqn">z_{PS} = \frac{h_{P} - \rho_{PS}h_{S}}{\sqrt{1 - \rho_{PS}^2}}</code>
</p>
</dd>
<dt><code>omega_D</code></dt><dd><p style="text-align: center;"><code class="reqn">\omega_{D} = \frac{h_{D}\zeta_{DD} - h_{S}\zeta_{DS} -
h_{P}\zeta_{DP}}{\zeta_{DD}}</code>
</p>
</dd>
<dt><code>omega_S</code></dt><dd><p style="text-align: center;"><code class="reqn">\omega_{S} = \frac{h_{S}\zeta_{SS} - h_{S}\zeta_{SS} -
h_{P}\zeta_{SP}}{\zeta_{SS}}</code>
</p>
</dd>
<dt><code>w_D</code></dt><dd><p style="text-align: center;"><code class="reqn">w_{D} = - \frac{h_{D}^2 - 2 h_{D} h_{P} \rho_{DP} +
h_{P}^2}{2\zeta_{SS}}</code>
</p>
</dd>
<dt><code>w_S</code></dt><dd><p style="text-align: center;"><code class="reqn">w_{S} = - \frac{h_{S}^2 - 2 h_{S} h_{P} \rho_{SP} +
h_{P}^2}{2\zeta_{DD}}</code>
</p>
</dd>
<dt><code>psi_D</code></dt><dd><p style="text-align: center;"><code class="reqn">\psi_{D} = \phi\left(\frac{\omega_{D}}{\zeta}\right)</code>
</p>
</dd>
<dt><code>psi_S</code></dt><dd><p style="text-align: center;"><code class="reqn">\psi_{S} = \phi\left(\frac{\omega_{S}}{\zeta}\right)</code>
</p>
</dd>
<dt><code>Psi_D</code></dt><dd><p style="text-align: center;"><code class="reqn">\Psi_{D} = 1 - \Phi\left(\frac{\omega_{D}}{\zeta}\right)</code>
</p>
</dd>
<dt><code>Psi_S</code></dt><dd><p style="text-align: center;"><code class="reqn">\Psi_{S} = 1 - \Phi\left(\frac{\omega_{S}}{\zeta}\right)</code>
</p>
</dd>
<dt><code>g_D</code></dt><dd><p style="text-align: center;"><code class="reqn">g_{D} = \frac{\psi_{D}}{\Psi_{D}}</code>
</p>
</dd>
<dt><code>g_S</code></dt><dd><p style="text-align: center;"><code class="reqn">g_{S} = \frac{\psi_{S}}{\Psi_{S}}</code>
</p>
</dd>
<dt><code>rho_ds</code></dt><dd><p>Shadows <code>rho</code> in the <a href="#topic+diseq_stochastic_adjustment-class">diseq_stochastic_adjustment</a> model</p>
</dd>
<dt><code>rho_dp</code></dt><dd><p>Correlation of demand and price equations' shocks.</p>
</dd>
<dt><code>rho_sp</code></dt><dd><p>Correlation of supply and price equations' shocks.</p>
</dd>
<dt><code>L_D</code></dt><dd><p>Likelihood conditional on excess supply.</p>
</dd>
<dt><code>L_S</code></dt><dd><p>Likelihood conditional on excess demand.</p>
</dd>
</dl>

<hr>
<h2 id='variable_names'>Variable name access</h2><span id='topic+variable_names'></span><span id='topic+prefixed_const_variable'></span><span id='topic+prefixed_independent_variables'></span><span id='topic+prefixed_price_variable'></span><span id='topic+prefixed_control_variables'></span><span id='topic+prefixed_variance_variable'></span><span id='topic+prefixed_quantity_variable'></span><span id='topic+prefixed_const_variable+2Cequation_base-method'></span><span id='topic+prefixed_independent_variables+2Cequation_base-method'></span><span id='topic+prefixed_price_variable+2Cequation_base-method'></span><span id='topic+prefixed_control_variables+2Cequation_base-method'></span><span id='topic+prefixed_variance_variable+2Cequation_base-method'></span><span id='topic+prefixed_quantity_variable+2Cequation_base-method'></span><span id='topic+lagged_price_variable'></span><span id='topic+price_differences_variable'></span><span id='topic+lagged_price_variable+2Csystem_base-method'></span><span id='topic+price_differences_variable+2Csystem_base-method'></span>

<h3>Description</h3>

<p>Methods that provide access to the prefixed variable names that the
package uses.
</p>
<p><code>prefixed_const_variable</code>: The constant coefficient name is
constructed by concatenating the equation prefix with <code>CONST</code>.
</p>
<p><code>prefixed_independent_variables</code>: The names of the independent
variables are constructed by concatenating the equation prefix with the column names
of the model's data frame.
</p>
<p><code>prefixed_price_variable</code>: The price variable name is
constructed by concatenating the equation prefix with the name of the price column.
</p>
<p><code>prefixed_control_variables</code>: The controls of the equation are the
independent variables without the price variable. Their names are constructed by
concatenating the equation prefix with the name of the price column.
</p>
<p><code>prefixed_control_variables</code>: The variance variable is
constructed by concatenating the equation prefix with <code>VARIANCE</code>.
</p>
<p><code>prefixed_quantity_variable</code>: The quantity variable name is
constructed by concatenating the equation prefix with the name of the quantity
column.
</p>
<p><code>lagged_price_variable</code>: The lagged price variable name is
constructed by concatenating <code>LAGGED</code> with the price variable name.
</p>
<p><code>price_differences_variable</code>: The price difference variable name is
constructed by concatenating the price variable name with <code>DIFF</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prefixed_const_variable(object)

prefixed_independent_variables(object)

prefixed_price_variable(object)

prefixed_control_variables(object)

prefixed_variance_variable(object)

prefixed_quantity_variable(object)

## S4 method for signature 'equation_base'
prefixed_const_variable(object)

## S4 method for signature 'equation_base'
prefixed_independent_variables(object)

## S4 method for signature 'equation_base'
prefixed_price_variable(object)

## S4 method for signature 'equation_base'
prefixed_control_variables(object)

## S4 method for signature 'equation_base'
prefixed_variance_variable(object)

## S4 method for signature 'equation_base'
prefixed_quantity_variable(object)

lagged_price_variable(object)

price_differences_variable(object)

## S4 method for signature 'system_base'
lagged_price_variable(object)

## S4 method for signature 'system_base'
price_differences_variable(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="variable_names_+3A_object">object</code></td>
<td>
<p>An equation object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The prefixed variable name(s).
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>prefixed_const_variable()</code>: Constant coefficient variable name.
</p>
</li>
<li> <p><code>prefixed_independent_variables()</code>: Independent variable names.
</p>
</li>
<li> <p><code>prefixed_price_variable()</code>: Price coefficient variable name.
</p>
</li>
<li> <p><code>prefixed_control_variables()</code>: Control variable names.
</p>
</li>
<li> <p><code>prefixed_variance_variable()</code>: Variance variable name.
</p>
</li>
<li> <p><code>prefixed_quantity_variable()</code>: Quantity variable name.
</p>
</li>
<li> <p><code>lagged_price_variable()</code>: Lagged price variable name.
</p>
</li>
<li> <p><code>price_differences_variable()</code>: Price differences variable name.
</p>
</li></ul>

<hr>
<h2 id='vcov+2Cmarket_fit-method'>Variance-covariance matrix for a fitted market model</h2><span id='topic+vcov+2Cmarket_fit-method'></span>

<h3>Description</h3>

<p>Returns the variance-covariance matrix of the estimated coefficients for
the fitted model. Specializes the <code><a href="stats.html#topic+vcov">vcov</a></code> function for
fitted market models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'market_fit'
vcov(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vcov+2B2Cmarket_fit-method_+3A_object">object</code></td>
<td>
<p>A fitted model object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of covariances for the estimated model coefficients.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# estimate a model using the houses dataset
fit &lt;- diseq_deterministic_adjustment(
  HS | RM | ID | TREND ~
    RM + TREND + W + CSHS + L1RM + L2RM + MONTH |
      RM + TREND + W + L1RM + MA6DSF + MA3DHF + MONTH,
  fair_houses(),
  correlated_shocks = FALSE,
  estimation_options = list(control = list(maxit = 1e+6))
)

# access the variance-covariance matrix
head(vcov(fit))

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
