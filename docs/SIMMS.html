<!DOCTYPE html><html lang="en"><head><title>Help for package SIMMS</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SIMMS}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#SIMMS-package'><p>SIMMS - Subnetwork Integration for Multi-Modal Signatures</p></a></li>
<li><a href='#calculate.meta.survival'><p>Fit a meta-analytic Cox proportional hazards model to a single feature</p></a></li>
<li><a href='#calculate.network.coefficients'><p>Calculate Cox statistics for input dataset</p></a></li>
<li><a href='#calculate.sensitivity.stats'><p>Computes sensitivity measures</p></a></li>
<li><a href='#centre.scale.dataset'><p>Centre and scale a data matrix</p></a></li>
<li><a href='#create.classifier.multivariate'><p>Trains and tests a multivariate survival model</p></a></li>
<li><a href='#create.classifier.univariate'><p>Trains and tests a univariate (per subnetwork module) survival model</p></a></li>
<li><a href='#create.KM.plot'><p>Plots Kaplan-meier survival curve for a given risk grouping &amp; survival</p>
params</a></li>
<li><a href='#create.sensitivity.plot'><p>Plots sensitivity analysis for class label dichotomization at supplied</p>
survtime cutoffs</a></li>
<li><a href='#create.survivalplots'><p>Plots Kaplan-meier survival curves</p></a></li>
<li><a href='#create.survobj'><p>Utility function for loading meta-analysis lists</p></a></li>
<li><a href='#derive.network.features'><p>Derive univariate features from pathway-derived networks</p></a></li>
<li><a href='#dichotomize.dataset'><p>Dichotomize a single dataset</p></a></li>
<li><a href='#dichotomize.meta.dataset'><p>Dichotomize and unlist a meta-analysis list</p></a></li>
<li><a href='#fit.coxmodel'><p>Fit a Cox proportional hazards model</p></a></li>
<li><a href='#fit.interaction.model'><p>Cox model two features separately and together</p></a></li>
<li><a href='#fit.survivalmodel'><p>Trains a multivariate survival model</p></a></li>
<li><a href='#get.adjacency.matrix'><p>A utility function to convert tab delimited networks file into adjacency</p>
matrices</a></li>
<li><a href='#get.chisq.stats'><p>Applies survdiff function</p></a></li>
<li><a href='#get.program.defaults'><p>A utility function to return the inst/ directory of the installed package</p>
and other default settings</a></li>
<li><a href='#load.cancer.datasets'><p>Load all cancer meta-analysis datasets</p></a></li>
<li><a href='#make.matrix'><p>Utility function used by <code>get.adjacency.matrix()</code></p></a></li>
<li><a href='#pred.survivalmodel'><p>Apply a multivariate survival model to validation datasets</p></a></li>
<li><a href='#prepare.training.validation.datasets'><p>Prepare training and validation datasets</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>1.3.2</td>
</tr>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Subnetwork Integration for Multi-Modal Signatures</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-04-22</td>
</tr>
<tr>
<td>Author:</td>
<td>Syed Haider [aut, cre],
  Paul C. Boutros [aut],
  Michal Grzadkowski [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Syed Haider &lt;Syed.Haider@icr.ac.uk&gt;</td>
</tr>
<tr>
<td>Imports:</td>
<td>randomForestSRC (&ge; 2.9.1)</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2.0), survival (&ge; 2.36-2), MASS (&ge; 7.3-12), glmnet
(&ge; 1.9-8), doParallel (&ge; 1.0.10), foreach (&ge; 1.4.3)</td>
</tr>
<tr>
<td>Description:</td>
<td>Algorithms to create prognostic biomarkers using biological genesets or networks.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr (&ge; 1.4), rmarkdown (&ge; 0.9.5), xtable (&ge; 1.7-4)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.0</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-04-22 15:11:30 UTC; shaider</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-04-24 14:50:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='SIMMS-package'>SIMMS - Subnetwork Integration for Multi-Modal Signatures</h2><span id='topic+SIMMS-package'></span><span id='topic+SIMMS'></span>

<h3>Description</h3>

<p>Algorithms to create prognostic biomarkers using biological networks
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;"> Package: </td><td style="text-align: left;"> SIMMS</td>
</tr>
<tr>
 <td style="text-align: left;"> Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;"> License: </td><td style="text-align: left;">
GPL-2</td>
</tr>
<tr>
 <td style="text-align: left;"> LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;"> </td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Syed Haider, Michal Grzadkowski &amp; Paul C. Boutros
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
options("warn" = -1);

# get data directory 
data.directory &lt;- get.program.defaults(networks.database = "test")[["test.data.dir"]];

# initialise params
output.directory  &lt;- tempdir();
data.types &lt;- c("mRNA");
feature.selection.datasets &lt;- c("Breastdata1");
training.datasets &lt;- c("Breastdata1");
validation.datasets &lt;- c("Breastdata2");
feature.selection.p.thresholds &lt;- c(0.5);
feature.selection.p.threshold &lt;- 0.5;
learning.algorithms &lt;- c("backward", "forward", "glm");
top.n.features &lt;- 5;

# compute network HRs for all the subnet features
derive.network.features(
  data.directory = data.directory,
  output.directory = output.directory,
  data.types = data.types,
  feature.selection.datasets = feature.selection.datasets,
  feature.selection.p.thresholds = feature.selection.p.thresholds,
  networks.database = "test"
  );

# preparing training and validation datasets.
# Normalisation &amp; patientwise subnet feature scores
prepare.training.validation.datasets(
  data.directory = data.directory,
  output.directory = output.directory,
  data.types = data.types,
  p.threshold = feature.selection.p.threshold,
  feature.selection.datasets = feature.selection.datasets,
  datasets = unique(c(training.datasets, validation.datasets)),
  networks.database = "test"
  );

# create classifier assessing univariate prognostic power of subnetwork modules (Train and Validate)
create.classifier.univariate(
  data.directory = data.directory,
  output.directory = output.directory,
  feature.selection.datasets = feature.selection.datasets,
  feature.selection.p.threshold = feature.selection.p.threshold,
  training.datasets = training.datasets,
  validation.datasets = validation.datasets,
  top.n.features = top.n.features
  );

# create a multivariate classifier (Train and Validate)
create.classifier.multivariate(
  data.directory = data.directory,
  output.directory = output.directory,
  feature.selection.datasets = feature.selection.datasets,
  feature.selection.p.threshold = feature.selection.p.threshold,
  training.datasets = training.datasets,
  validation.datasets = validation.datasets,
  learning.algorithms = learning.algorithms,
  top.n.features = top.n.features
  );

# (optional) plot Kaplan-Meier survival curves and perform senstivity analysis
if (FALSE){
  create.survivalplots(
    data.directory = data.directory,
    output.directory = output.directory,
    training.datasets = training.datasets,
    validation.datasets = validation.datasets,
    top.n.features = top.n.features,
    learning.algorithms = learning.algorithms,
    survtime.cutoffs = c(5),
    KM.plotting.fun = "create.KM.plot",
    resolution = 100
    );
  }

</code></pre>

<hr>
<h2 id='calculate.meta.survival'>Fit a meta-analytic Cox proportional hazards model to a single feature</h2><span id='topic+calculate.meta.survival'></span>

<h3>Description</h3>

<p>Takes a meta-analysis data object and fits a Cox proportional hazards model
(possibly with adjustment for some specific covariates) by
median-dichotomizing patients within each individual dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate.meta.survival(
  feature.name,
  expression.data,
  survival.data,
  rounding = 3,
  other.data = NULL,
  data.type.ordinal = FALSE,
  centre.data = "median"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculate.meta.survival_+3A_feature.name">feature.name</code></td>
<td>
<p>Character indicate what feature (gene/probe/etc.) should
be extracted for analysis</p>
</td></tr>
<tr><td><code id="calculate.meta.survival_+3A_expression.data">expression.data</code></td>
<td>
<p>A list where each component is an expression matrix
(patients = columns, genes = rows) for a different dataset</p>
</td></tr>
<tr><td><code id="calculate.meta.survival_+3A_survival.data">survival.data</code></td>
<td>
<p>A list where each component is an object of class Surv</p>
</td></tr>
<tr><td><code id="calculate.meta.survival_+3A_rounding">rounding</code></td>
<td>
<p>How many digits after the decimal place to include</p>
</td></tr>
<tr><td><code id="calculate.meta.survival_+3A_other.data">other.data</code></td>
<td>
<p>A list of other covariates to be passed to the Cox model
(all elements in this list are used</p>
</td></tr>
<tr><td><code id="calculate.meta.survival_+3A_data.type.ordinal">data.type.ordinal</code></td>
<td>
<p>Logical indicating whether to treat this datatype
as ordinal. Defaults to FALSE</p>
</td></tr>
<tr><td><code id="calculate.meta.survival_+3A_centre.data">centre.data</code></td>
<td>
<p>A character string specifying the centre value to be used for 
scaling data. Valid values are: 'median', 'mean', or a user defined numeric threshold
e.g. '0.3' when modelling methylation beta values. This value is used for both scaling
as well as for dichotomising data for estimating univariate betas from Cox model.
Defaults to 'median'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a vector containing the HR, p-value, n, and 95% confidence
limits of the HR (see fit.coxmodel() for details)
</p>


<h3>Author(s)</h3>

<p>Paul C. Boutros
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data.directory &lt;- get.program.defaults()[["test.data.dir"]];
data.types &lt;- c("mRNA");
x1 &lt;- load.cancer.datasets(
  datasets.to.load = c('Breastdata1'),
  data.types = data.types,
  data.directory = data.directory
  );
x2 &lt;- calculate.meta.survival(
  feature.name = "1000_at",
  expression.data = x1$all.data[[data.types[1]]],
  survival.data = x1$all.survobj
  );

</code></pre>

<hr>
<h2 id='calculate.network.coefficients'>Calculate Cox statistics for input dataset</h2><span id='topic+calculate.network.coefficients'></span>

<h3>Description</h3>

<p>Function to compute hazard ratios for the genes in pathway-derived networks,
by aggregating input datasets into one training cohort. The hazard ratios
are computed for each pair by calculating the HR of each gene independently
and as an interaction (i.e. y = HR(A) + HR(B) + HR(A:B)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate.network.coefficients(
  data.directory = ".",
  output.directory = ".",
  training.datasets = NULL,
  data.types = c("mRNA"),
  data.types.ordinal = c("cna"),
  centre.data = "median",
  subnets.file.flattened = NULL,
  truncate.survival = 100,
  subset = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculate.network.coefficients_+3A_data.directory">data.directory</code></td>
<td>
<p>Path to the directory containing datasets as specified
by <code>training.datasets</code></p>
</td></tr>
<tr><td><code id="calculate.network.coefficients_+3A_output.directory">output.directory</code></td>
<td>
<p>Path to the output folder where intermediate and
results files will be saved</p>
</td></tr>
<tr><td><code id="calculate.network.coefficients_+3A_training.datasets">training.datasets</code></td>
<td>
<p>A vector containing names of training datasets</p>
</td></tr>
<tr><td><code id="calculate.network.coefficients_+3A_data.types">data.types</code></td>
<td>
<p>A vector of molecular datatypes to load. Defaults to
c('mRNA')</p>
</td></tr>
<tr><td><code id="calculate.network.coefficients_+3A_data.types.ordinal">data.types.ordinal</code></td>
<td>
<p>A vector of molecular datatypes to be treated as
ordinal. Defaults to c('cna')</p>
</td></tr>
<tr><td><code id="calculate.network.coefficients_+3A_centre.data">centre.data</code></td>
<td>
<p>A character string specifying the centre value to be used for 
scaling data. Valid values are: 'median', 'mean', or a user defined numeric threshold
e.g. '0.3' when modelling methylation beta values. This value is used for both scaling
as well as for dichotomising data for estimating univariate betas from Cox model.
Defaults to 'median'</p>
</td></tr>
<tr><td><code id="calculate.network.coefficients_+3A_subnets.file.flattened">subnets.file.flattened</code></td>
<td>
<p>File containing all the binary ineractions
derived from pathway-derived networks</p>
</td></tr>
<tr><td><code id="calculate.network.coefficients_+3A_truncate.survival">truncate.survival</code></td>
<td>
<p>A numeric value specifying survival truncation in
years. Defaults to 100 years which effectively means no truncation</p>
</td></tr>
<tr><td><code id="calculate.network.coefficients_+3A_subset">subset</code></td>
<td>
<p>A list with a Field and Entry component specifying a subset of
patients to be selected whose annotation Field matches Entry</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list of matrices for each of the data types. Matrices
contain nodes HR/P, edges HR and edges P.
</p>


<h3>Author(s)</h3>

<p>Syed Haider &amp; Paul C. Boutros
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
options("warn" = -1);
program.data &lt;- get.program.defaults(networks.database = "test");
data.directory &lt;- program.data[["test.data.dir"]];
subnets.file.flattened &lt;- program.data[["subnets.file.flattened"]];
output.directory = tempdir();
coef.nodes.edges &lt;- calculate.network.coefficients(
  data.directory = data.directory,
  output.directory = output.directory,
  training.datasets = c("Breastdata1"),
  data.types = c("mRNA"),
  subnets.file.flattened = subnets.file.flattened
  );

</code></pre>

<hr>
<h2 id='calculate.sensitivity.stats'>Computes sensitivity measures</h2><span id='topic+calculate.sensitivity.stats'></span>

<h3>Description</h3>

<p>Computes sensitivity measures: TP, FP, TN, FN, Sensitivity, Specificity,
Accuracy
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate.sensitivity.stats(all.data = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculate.sensitivity.stats_+3A_all.data">all.data</code></td>
<td>
<p>A data matrix containing predicted and real risk groups</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector containing TP, FP, TN, FN, Sensitivity, Specificity,
Accuracy
</p>


<h3>Author(s)</h3>

<p>Syed Haider
</p>

<hr>
<h2 id='centre.scale.dataset'>Centre and scale a data matrix</h2><span id='topic+centre.scale.dataset'></span>

<h3>Description</h3>

<p>Centre and scale a data matrix. Scaling is done on each column separately
</p>


<h3>Usage</h3>

<pre><code class='language-R'>centre.scale.dataset(x = NULL, centre.data = "median")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="centre.scale.dataset_+3A_x">x</code></td>
<td>
<p>A sample by feature data matrix</p>
</td></tr>
<tr><td><code id="centre.scale.dataset_+3A_centre.data">centre.data</code></td>
<td>
<p>A character string specifying the centre value to be used for 
scaling data. Valid values are: 'median', 'mean', or a user defined numeric threshold
e.g. '0.3' when modelling methylation beta values. This value is used for both scaling
as well as for dichotomising data for estimating univariate betas from Cox model.
Defaults to 'median'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A centred and scaled data matrix
</p>


<h3>Author(s)</h3>

<p>Syed Haider
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
tmp &lt;- matrix(data = rnorm(100, 10, 2), nrow = 20);
tmp.scaled.median &lt;- centre.scale.dataset(x = tmp);
tmp.scaled.mean &lt;- centre.scale.dataset(x = tmp, centre.data = "mean");
tmp.scaled.custom &lt;- centre.scale.dataset(x = tmp, centre.data = 0.3);

</code></pre>

<hr>
<h2 id='create.classifier.multivariate'>Trains and tests a multivariate survival model</h2><span id='topic+create.classifier.multivariate'></span>

<h3>Description</h3>

<p>Trains a model on training datasets. Predicts the risk score for all the
training &amp; datasets, independently. This function also predicts the risk
score for combined training datasets cohort and validation datasets cohort.
The risk score estimation is done by multivariate models fit by
<code>fit.survivalmodel</code>. The function also predicts risk scores for each of
the <code>top.n.features</code> independently.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create.classifier.multivariate(
  data.directory = ".",
  output.directory = ".",
  feature.selection.datasets = NULL,
  feature.selection.p.threshold = 0.05,
  training.datasets = NULL,
  validation.datasets = NULL,
  top.n.features = 25,
  models = c("1", "2", "3"),
  learning.algorithms = c("backward", "forward"),
  alpha.glm = c(1),
  k.fold.glm = 10,
  seed.value = 51214,
  cores.glm = 1,
  rf.ntree = 1000,
  rf.mtry = NULL,
  rf.nodesize = 15,
  rf.samptype = "swor",
  rf.sampsize = function(x) {     x * 0.66 },
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="create.classifier.multivariate_+3A_data.directory">data.directory</code></td>
<td>
<p>Path to the directory containing datasets as specified
by <code>feature.selection.datasets</code>, <code>training.datasets</code>,
<code>validation.datasets</code></p>
</td></tr>
<tr><td><code id="create.classifier.multivariate_+3A_output.directory">output.directory</code></td>
<td>
<p>Path to the output folder where intermediate and
results files will be saved</p>
</td></tr>
<tr><td><code id="create.classifier.multivariate_+3A_feature.selection.datasets">feature.selection.datasets</code></td>
<td>
<p>A vector containing names of datasets used
for feature selection in function <code>derive.network.features()</code></p>
</td></tr>
<tr><td><code id="create.classifier.multivariate_+3A_feature.selection.p.threshold">feature.selection.p.threshold</code></td>
<td>
<p>One of the P values that were used for
feature selection in function <code>derive.network.features()</code>. This
function does not support vector of P values as used in
<code>derive.network.features()</code> for performance reasons</p>
</td></tr>
<tr><td><code id="create.classifier.multivariate_+3A_training.datasets">training.datasets</code></td>
<td>
<p>A vector containing names of training datasets</p>
</td></tr>
<tr><td><code id="create.classifier.multivariate_+3A_validation.datasets">validation.datasets</code></td>
<td>
<p>A vector containing names of validation datasets</p>
</td></tr>
<tr><td><code id="create.classifier.multivariate_+3A_top.n.features">top.n.features</code></td>
<td>
<p>A numeric value specifying how many top ranked
features will be used for univariate survival modelling</p>
</td></tr>
<tr><td><code id="create.classifier.multivariate_+3A_models">models</code></td>
<td>
<p>A character vector specifying which of the models ('1' = N+E,
'2' = N, '3' = E) to run</p>
</td></tr>
<tr><td><code id="create.classifier.multivariate_+3A_learning.algorithms">learning.algorithms</code></td>
<td>
<p>A character vector specifying which learning
algorithm to be used for model fitting and feature selection. Defaults to
c('backward', 'forward'). Available options are: c('backward', 'forward',
'glm', 'randomforest')</p>
</td></tr>
<tr><td><code id="create.classifier.multivariate_+3A_alpha.glm">alpha.glm</code></td>
<td>
<p>A numeric vector specifying elastic-net mixing parameter
alpha, with range alpha raning from [0,1]. 1 for LASSO (default) and 0 for
ridge. For multiple values of alpha, most optimal value is selected through
cross validation on training set</p>
</td></tr>
<tr><td><code id="create.classifier.multivariate_+3A_k.fold.glm">k.fold.glm</code></td>
<td>
<p>A numeric value specifying k-fold cross validation if glm
was chosen in <code>learning.algorithms</code></p>
</td></tr>
<tr><td><code id="create.classifier.multivariate_+3A_seed.value">seed.value</code></td>
<td>
<p>A numeric value specifying seed for glm k-fold cross or random forest
validation if glm was chosen in <code>learning.algorithms</code></p>
</td></tr>
<tr><td><code id="create.classifier.multivariate_+3A_cores.glm">cores.glm</code></td>
<td>
<p>An integer value specifying number of cores to be used for
glm if it was chosen in <code>learning.algorithms</code></p>
</td></tr>
<tr><td><code id="create.classifier.multivariate_+3A_rf.ntree">rf.ntree</code></td>
<td>
<p>An integer value specifying the number of trees in random forest. 
Defaults to 1000. This should be tuned after starting with a large forest such as 1000 
in the initial run and assessing the results in output\/OOB_error__TRAINING_* to see 
where the OOB error rate stablises, and then rerunning with the stablised rf.ntree 
parameter</p>
</td></tr>
<tr><td><code id="create.classifier.multivariate_+3A_rf.mtry">rf.mtry</code></td>
<td>
<p>An integer value specifying the number of variables randomly selected 
for splitting a node. Defaults to sqrt(features), which is the same as in the 
underlying R package random survival forest <code>randomForestSRC::rfsrc</code></p>
</td></tr>
<tr><td><code id="create.classifier.multivariate_+3A_rf.nodesize">rf.nodesize</code></td>
<td>
<p>An integer value specifying number of unique cases in a terminal 
node. Defaults to 15, which is the same as in the underlying R package random survival 
forest <code>randomForestSRC::rfsrc</code></p>
</td></tr>
<tr><td><code id="create.classifier.multivariate_+3A_rf.samptype">rf.samptype</code></td>
<td>
<p>An character string specifying name of sampling. Defaults to 
sampling without replacement 'swor'. Available options are: c('swor', 'swr')</p>
</td></tr>
<tr><td><code id="create.classifier.multivariate_+3A_rf.sampsize">rf.sampsize</code></td>
<td>
<p>A function specifying sampling size when <code>rf.samptype</code> is set 
to sampling without replacement ('swor'). Defaults to 66%: <code>function(x){x * .66}</code></p>
</td></tr>
<tr><td><code id="create.classifier.multivariate_+3A_...">...</code></td>
<td>
<p>other params to be passed on to the random forest call to the underlying 
R package random survival forest <code>randomForestSRC::rfsrc</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>The output files are stored under <code>output.directory</code>/output/
</p>


<h3>Author(s)</h3>

<p>Syed Haider &amp; Vincent Stimper
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# see package's main documentation

</code></pre>

<hr>
<h2 id='create.classifier.univariate'>Trains and tests a univariate (per subnetwork module) survival model</h2><span id='topic+create.classifier.univariate'></span>

<h3>Description</h3>

<p>Trains a model on training datasets. Predicts the risk score for all the
training &amp; datasets, independently. This function also predicts the risk
score for combined training datasets cohort and validation datasets cohort.
The risk score estimation is done by multivariate models fit by
<code>fit.survivalmodel</code>. The function also predicts risk scores for each of
the <code>top.n.features</code> independently.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create.classifier.univariate(
  data.directory = ".",
  output.directory = ".",
  feature.selection.datasets = NULL,
  feature.selection.p.threshold = 0.05,
  training.datasets = NULL,
  validation.datasets = NULL,
  top.n.features = 25,
  models = c("1", "2", "3")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="create.classifier.univariate_+3A_data.directory">data.directory</code></td>
<td>
<p>Path to the directory containing datasets as specified
by <code>feature.selection.datasets</code>, <code>training.datasets</code>,
<code>validation.datasets</code></p>
</td></tr>
<tr><td><code id="create.classifier.univariate_+3A_output.directory">output.directory</code></td>
<td>
<p>Path to the output folder where intermediate and
results files will be saved</p>
</td></tr>
<tr><td><code id="create.classifier.univariate_+3A_feature.selection.datasets">feature.selection.datasets</code></td>
<td>
<p>A vector containing names of datasets used
for feature selection in function <code>derive.network.features()</code></p>
</td></tr>
<tr><td><code id="create.classifier.univariate_+3A_feature.selection.p.threshold">feature.selection.p.threshold</code></td>
<td>
<p>One of the P values that were used for
feature selection in function <code>derive.network.features()</code>. This
function does not support vector of P values as used in
<code>derive.network.features()</code> for performance reasons</p>
</td></tr>
<tr><td><code id="create.classifier.univariate_+3A_training.datasets">training.datasets</code></td>
<td>
<p>A vector containing names of training datasets</p>
</td></tr>
<tr><td><code id="create.classifier.univariate_+3A_validation.datasets">validation.datasets</code></td>
<td>
<p>A vector containing names of validation datasets</p>
</td></tr>
<tr><td><code id="create.classifier.univariate_+3A_top.n.features">top.n.features</code></td>
<td>
<p>A numeric value specifying how many top ranked
features will be used for univariate survival modelling</p>
</td></tr>
<tr><td><code id="create.classifier.univariate_+3A_models">models</code></td>
<td>
<p>A character vector specifying which of the models ('1' = N+E,
'2' = N, '3' = E) to run</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The output files are stored under <code>output.directory</code>/output/
</p>


<h3>Author(s)</h3>

<p>Syed Haider
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# see package's main documentation

</code></pre>

<hr>
<h2 id='create.KM.plot'>Plots Kaplan-meier survival curve for a given risk grouping &amp; survival
params</h2><span id='topic+create.KM.plot'></span>

<h3>Description</h3>

<p>A generic method to plot KM curves
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create.KM.plot(
  riskgroup = NULL,
  survtime = NULL,
  survstat = NULL,
  file.name = NULL,
  main.title = "",
  resolution = 100
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="create.KM.plot_+3A_riskgroup">riskgroup</code></td>
<td>
<p>A vector containing dichotomized risk groups</p>
</td></tr>
<tr><td><code id="create.KM.plot_+3A_survtime">survtime</code></td>
<td>
<p>A vector containing survival time of the samples</p>
</td></tr>
<tr><td><code id="create.KM.plot_+3A_survstat">survstat</code></td>
<td>
<p>A vector containing survival status of the samples</p>
</td></tr>
<tr><td><code id="create.KM.plot_+3A_file.name">file.name</code></td>
<td>
<p>A string containing full qualified path of the output tiff
file</p>
</td></tr>
<tr><td><code id="create.KM.plot_+3A_main.title">main.title</code></td>
<td>
<p>A string specifying main title of the image</p>
</td></tr>
<tr><td><code id="create.KM.plot_+3A_resolution">resolution</code></td>
<td>
<p>A numeric value specifying resolution of the tiff image of
KM survival curves. Defaults to 100</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The KM survival curves are stored under <code>output.dir</code>/graphs/
</p>


<h3>Author(s)</h3>

<p>Syed Haider
</p>

<hr>
<h2 id='create.sensitivity.plot'>Plots sensitivity analysis for class label dichotomization at supplied
survtime cutoffs</h2><span id='topic+create.sensitivity.plot'></span>

<h3>Description</h3>

<p>A method to computer sensitivity, specificity and accuracy at all the
survtime cutoff steps provided
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create.sensitivity.plot(
  riskscore = NULL,
  riskgroup = NULL,
  survtime = NULL,
  survstat = NULL,
  survtime.cutoffs = c(seq(5, 10, 1)),
  output.directory = ".",
  file.stem = NULL,
  main.title = "",
  resolution = 100
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="create.sensitivity.plot_+3A_riskscore">riskscore</code></td>
<td>
<p>A vector containing predicted risk scores</p>
</td></tr>
<tr><td><code id="create.sensitivity.plot_+3A_riskgroup">riskgroup</code></td>
<td>
<p>A vector containing dichotomized risk groups</p>
</td></tr>
<tr><td><code id="create.sensitivity.plot_+3A_survtime">survtime</code></td>
<td>
<p>A vector containing survival time of the samples</p>
</td></tr>
<tr><td><code id="create.sensitivity.plot_+3A_survstat">survstat</code></td>
<td>
<p>A vector containing survival status of the samples</p>
</td></tr>
<tr><td><code id="create.sensitivity.plot_+3A_survtime.cutoffs">survtime.cutoffs</code></td>
<td>
<p>A vector containing cutoff time points used to
dichotomize patients into low- and high-risk groups</p>
</td></tr>
<tr><td><code id="create.sensitivity.plot_+3A_output.directory">output.directory</code></td>
<td>
<p>Path to the output folder where intermediate and
results files will be saved</p>
</td></tr>
<tr><td><code id="create.sensitivity.plot_+3A_file.stem">file.stem</code></td>
<td>
<p>A string containing base name for image and text files
produced by this method</p>
</td></tr>
<tr><td><code id="create.sensitivity.plot_+3A_main.title">main.title</code></td>
<td>
<p>A string specifying main title of the image</p>
</td></tr>
<tr><td><code id="create.sensitivity.plot_+3A_resolution">resolution</code></td>
<td>
<p>A numeric value specifying resolution of the tiff image of
KM survival curves. Defaults to 100</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The sensitivity analysis plots are stored under
<code>output.directory</code>/graphs/. The sensitivity analysis results are stored
under <code>output.directory</code>/output/
</p>


<h3>Author(s)</h3>

<p>Syed Haider
</p>

<hr>
<h2 id='create.survivalplots'>Plots Kaplan-meier survival curves</h2><span id='topic+create.survivalplots'></span>

<h3>Description</h3>

<p>Plots Kaplan-meier survival curves for all the training &amp; datasets,
independently as well as combined training datasets cohort and validation
datasets cohort. The function also plots KM survival curves for each of the
<code>top.n.features</code> independently.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create.survivalplots(
  data.directory = ".",
  output.directory = ".",
  training.datasets = NULL,
  validation.datasets = NULL,
  top.n.features = 25,
  learning.algorithms = c("backward", "forward"),
  truncate.survival = 100,
  survtime.cutoffs = c(seq(5, 10, 1)),
  main.title = FALSE,
  KM.plotting.fun = "create.KM.plot",
  plot.univariate.data = FALSE,
  plot.multivariate.data = TRUE,
  resolution = 100
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="create.survivalplots_+3A_data.directory">data.directory</code></td>
<td>
<p>Path to the directory containing datasets as specified
by <code>training.datasets</code>, <code>validation.datasets</code></p>
</td></tr>
<tr><td><code id="create.survivalplots_+3A_output.directory">output.directory</code></td>
<td>
<p>Path to the output folder where intermediate and
results files were saved</p>
</td></tr>
<tr><td><code id="create.survivalplots_+3A_training.datasets">training.datasets</code></td>
<td>
<p>A vector containing names of training datasets</p>
</td></tr>
<tr><td><code id="create.survivalplots_+3A_validation.datasets">validation.datasets</code></td>
<td>
<p>A vector containing names of validation datasets</p>
</td></tr>
<tr><td><code id="create.survivalplots_+3A_top.n.features">top.n.features</code></td>
<td>
<p>A numeric value specifying how many top ranked
features will be used for univariate survival modelling</p>
</td></tr>
<tr><td><code id="create.survivalplots_+3A_learning.algorithms">learning.algorithms</code></td>
<td>
<p>A character vector specifying which learning
algorithm to be used for model fitting and feature selection. Defaults to
c('backward', 'forward'). Available options are: c('backward', 'forward',
'glm', 'randomforest')</p>
</td></tr>
<tr><td><code id="create.survivalplots_+3A_truncate.survival">truncate.survival</code></td>
<td>
<p>A numeric value specifying survival truncation in
years. Defaults to 100 years which effectively means no truncation</p>
</td></tr>
<tr><td><code id="create.survivalplots_+3A_survtime.cutoffs">survtime.cutoffs</code></td>
<td>
<p>A vector containing survival cutoff time points to
be used for dichotomization of patients into risk groups for senstivity
analysis</p>
</td></tr>
<tr><td><code id="create.survivalplots_+3A_main.title">main.title</code></td>
<td>
<p>A logical to specify plot's main title. Defaults to FASLE</p>
</td></tr>
<tr><td><code id="create.survivalplots_+3A_km.plotting.fun">KM.plotting.fun</code></td>
<td>
<p>A string containing the name of the method to use for
plotting KM curves. Defaults to <code>create.KM.plot</code></p>
</td></tr>
<tr><td><code id="create.survivalplots_+3A_plot.univariate.data">plot.univariate.data</code></td>
<td>
<p>Logical to indicate whether to plot univariate
results for all subnetworks. Default to FALSE</p>
</td></tr>
<tr><td><code id="create.survivalplots_+3A_plot.multivariate.data">plot.multivariate.data</code></td>
<td>
<p>Logical to indicate whether to plot
multivariate results for all subnetworks. Defaults to TRUE</p>
</td></tr>
<tr><td><code id="create.survivalplots_+3A_resolution">resolution</code></td>
<td>
<p>A numeric value specifying resolution of the png images of
KM survival curves. Defaults to 100</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The KM survival curves are stored under
<code>output.directory</code>/graphs/
</p>


<h3>Author(s)</h3>

<p>Syed Haider
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# see package's main documentation

</code></pre>

<hr>
<h2 id='create.survobj'>Utility function for loading meta-analysis lists</h2><span id='topic+create.survobj'></span>

<h3>Description</h3>

<p>Create Surv objects from an annotation-matrix with handling for different
time units.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create.survobj(annotation = NULL, truncate.survival = 100)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="create.survobj_+3A_annotation">annotation</code></td>
<td>
<p>A patient annotation matrix (patients = rows) with (at
least) columns for survtime, survstat, and survtime.unit</p>
</td></tr>
<tr><td><code id="create.survobj_+3A_truncate.survival">truncate.survival</code></td>
<td>
<p>A numeric value specifying survival truncation in
years. Defaults to 100 years which effectively means no truncation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an object of class Surv
</p>


<h3>Author(s)</h3>

<p>Paul C. Boutros
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
annotation.file &lt;- paste(
  get.program.defaults()[["test.data.dir"]],
  "/Breastdata2/patient_annotation.txt", sep = ""
  );
annotation &lt;- read.table(
  annotation.file,
  header = TRUE,
  row.names = 1,
  sep = "\t"
  );

# select the appropriate survtime and survstat variable for this dataset
annotation$survstat      &lt;- annotation[,'e.dfs'];
annotation$survtime      &lt;- annotation[,'t.dfs'];
annotation$survtime.unit &lt;- annotation[,'t.dfs.unit'];

# only keep samples with survival data
annotation &lt;- annotation[!is.na(annotation$survstat) &amp; !is.na(annotation$survstat),];

surv.obj &lt;- create.survobj(annotation = annotation);

</code></pre>

<hr>
<h2 id='derive.network.features'>Derive univariate features from pathway-derived networks</h2><span id='topic+derive.network.features'></span>

<h3>Description</h3>

<p>This function fits Cox model to features as well as interaction between
features. The coefficients of features are subsequently used to compute
impact score of each of the pathway-derived networks.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>derive.network.features(
  data.directory = ".",
  output.directory = ".",
  data.types = c("mRNA"),
  data.types.ordinal = c("cna"),
  centre.data = "median",
  feature.selection.fun = "calculate.network.coefficients",
  feature.selection.datasets = NULL,
  feature.selection.p.thresholds = c(0.05),
  truncate.survival = 100,
  networks.database = "default",
  subset = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="derive.network.features_+3A_data.directory">data.directory</code></td>
<td>
<p>Path to the directory containing datasets as specified
by <code>feature.selection.datasets</code></p>
</td></tr>
<tr><td><code id="derive.network.features_+3A_output.directory">output.directory</code></td>
<td>
<p>Path to the output folder where intermediate and
results files will be saved</p>
</td></tr>
<tr><td><code id="derive.network.features_+3A_data.types">data.types</code></td>
<td>
<p>A vector of molecular datatypes to load. Defaults to
c('mRNA')</p>
</td></tr>
<tr><td><code id="derive.network.features_+3A_data.types.ordinal">data.types.ordinal</code></td>
<td>
<p>A vector of molecular datatypes to be treated as
ordinal. Defaults to c('cna')</p>
</td></tr>
<tr><td><code id="derive.network.features_+3A_centre.data">centre.data</code></td>
<td>
<p>A character string specifying the centre value to be used for 
scaling data. Valid values are: 'median', 'mean', or a user defined numeric threshold
e.g. '0.3' when modelling methylation beta values. This value is used for both scaling
as well as for dichotomising data for estimating univariate betas from Cox model.
Defaults to 'median'</p>
</td></tr>
<tr><td><code id="derive.network.features_+3A_feature.selection.fun">feature.selection.fun</code></td>
<td>
<p>Name of the function to be used to estimate
network coefficients. Defaults to 'calculate.network.coefficients'</p>
</td></tr>
<tr><td><code id="derive.network.features_+3A_feature.selection.datasets">feature.selection.datasets</code></td>
<td>
<p>A vector containing names of training
datasets to be used to compute cox statistics</p>
</td></tr>
<tr><td><code id="derive.network.features_+3A_feature.selection.p.thresholds">feature.selection.p.thresholds</code></td>
<td>
<p>A vector containing P values to be
used as threshold for including features into overall impact score of a
network</p>
</td></tr>
<tr><td><code id="derive.network.features_+3A_truncate.survival">truncate.survival</code></td>
<td>
<p>A numeric value specifying survival truncation in
years. Defaults to 100 years which effectively means no truncation</p>
</td></tr>
<tr><td><code id="derive.network.features_+3A_networks.database">networks.database</code></td>
<td>
<p>Name of the pathway networks database. Default to
NCI PID/Reactome/Biocarta i-e &quot;default&quot;</p>
</td></tr>
<tr><td><code id="derive.network.features_+3A_subset">subset</code></td>
<td>
<p>A list with a Field and Entry component specifying a subset of
patients to be selected from each dataset whose annotation Field matches
Entry</p>
</td></tr>
<tr><td><code id="derive.network.features_+3A_...">...</code></td>
<td>
<p>other params to be passed on to user-defined method for
estimating coefficients of network features</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The output files are stored under <code>data.directory</code>/output/
</p>


<h3>Author(s)</h3>

<p>Syed Haider
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
options("warn" = -1);

# get data directory 
data.directory &lt;- get.program.defaults(networks.database = "test")[["test.data.dir"]];

# initialise params
output.directory &lt;- tempdir();
data.types &lt;- c("mRNA");
feature.selection.datasets &lt;- c("Breastdata1");
feature.selection.p.thresholds &lt;- c(0.05);

# estimate network coefficients for all the subnet features
derive.network.features(
  data.directory = data.directory,
  output.directory = output.directory,
  data.types = data.types,
  feature.selection.fun = "calculate.network.coefficients",
  feature.selection.datasets = feature.selection.datasets,
  feature.selection.p.thresholds = feature.selection.p.thresholds,
  networks.database = "test"
  );

</code></pre>

<hr>
<h2 id='dichotomize.dataset'>Dichotomize a single dataset</h2><span id='topic+dichotomize.dataset'></span>

<h3>Description</h3>

<p>Split a dataset into two groups by median-dichotomization
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dichotomize.dataset(x, split.at = "median")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dichotomize.dataset_+3A_x">x</code></td>
<td>
<p>A vector of values to be dichotomized</p>
</td></tr>
<tr><td><code id="dichotomize.dataset_+3A_split.at">split.at</code></td>
<td>
<p>An character string or a numeric value that is be used to dichotomize. 
Valid values are: 'median', 'mean', or a user defined numeric threshold. Defaults to
'median'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of the data dichotomized onto a 0/1 (low/high) scale.
</p>


<h3>Author(s)</h3>

<p>Syed Haider &amp; Paul C. Boutros
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
tmp &lt;- rnorm(100);
tmp.groups.median &lt;- dichotomize.dataset(tmp);
tmp.groups.mean &lt;- dichotomize.dataset(tmp, split.at = "mean");
tmp.groups.custom &lt;- dichotomize.dataset(tmp, split.at = 0.3);

</code></pre>

<hr>
<h2 id='dichotomize.meta.dataset'>Dichotomize and unlist a meta-analysis list</h2><span id='topic+dichotomize.meta.dataset'></span>

<h3>Description</h3>

<p>Takes a meta-analysis list (and possibly extra data) and dichotomizes
based on a specific gene, then returns the unlisted data to the caller.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dichotomize.meta.dataset(
  feature.name,
  expression.data,
  survival.data,
  other.data = NULL,
  data.type.ordinal = FALSE,
  centre.data = "median"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dichotomize.meta.dataset_+3A_feature.name">feature.name</code></td>
<td>
<p>Character indicate what feature (gene/probe/etc.) should
be extracted for analysis</p>
</td></tr>
<tr><td><code id="dichotomize.meta.dataset_+3A_expression.data">expression.data</code></td>
<td>
<p>A list where each component is an expression matrix
(patients = columns, genes = rows) for a different dataset</p>
</td></tr>
<tr><td><code id="dichotomize.meta.dataset_+3A_survival.data">survival.data</code></td>
<td>
<p>A list where each component is an object of class Surv</p>
</td></tr>
<tr><td><code id="dichotomize.meta.dataset_+3A_other.data">other.data</code></td>
<td>
<p>A list of other covariates to be unlisted in the final
output (all elements in this list are used)</p>
</td></tr>
<tr><td><code id="dichotomize.meta.dataset_+3A_data.type.ordinal">data.type.ordinal</code></td>
<td>
<p>Logical indicating whether to treat this datatype
as ordinal. Defaults to FALSE</p>
</td></tr>
<tr><td><code id="dichotomize.meta.dataset_+3A_centre.data">centre.data</code></td>
<td>
<p>A character string specifying the centre value to be used for 
scaling data. Valid values are: 'median', 'mean', or a user defined numeric threshold
e.g. '0.3' when modelling methylation beta values. This value is used for both scaling
as well as for dichotomising data for estimating univariate betas from Cox model.
Defaults to 'median'</p>
</td></tr>
</table>


<h3>Details</h3>

<p>NB: other.data handling of missing components (i.e. those present in only
some datasets) has not been debugged (but may work regardless).
</p>


<h3>Value</h3>

<p>Returns a list containing components groups (after dichotomization),
survtime (in the units of the input data), and survstat.
Additional vectors are unlisted from other.data if that parameter is not
NULL.
</p>


<h3>Author(s)</h3>

<p>Syed Haider &amp; Paul C. Boutros
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data.directory &lt;- get.program.defaults()[["test.data.dir"]];
data.types &lt;- c("mRNA");
x1 &lt;- load.cancer.datasets(
  datasets.to.load = c('Breastdata1'),
  data.types = data.types,
  data.directory = data.directory
  );
x2 &lt;- dichotomize.meta.dataset(
  feature.name = "1000_at",
  expression.data = x1$all.data[[data.types[1]]],
  survival.data = x1$all.survobj
  );

</code></pre>

<hr>
<h2 id='fit.coxmodel'>Fit a Cox proportional hazards model</h2><span id='topic+fit.coxmodel'></span>

<h3>Description</h3>

<p>Fit a Cox model (possibly with some linear adjustments) and return key
statistics about the fit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit.coxmodel(
  groups,
  survobj,
  stages = NA,
  rounding = 3,
  other.data = NULL,
  data.type.ordinal = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fit.coxmodel_+3A_groups">groups</code></td>
<td>
<p>Grouping of patients (passed directly to coxph, so factors &amp;
continuous variables are okay)</p>
</td></tr>
<tr><td><code id="fit.coxmodel_+3A_survobj">survobj</code></td>
<td>
<p>An object of class Surv (from the survival package) &ndash;
patient ordering needs to be identical as for groups</p>
</td></tr>
<tr><td><code id="fit.coxmodel_+3A_stages">stages</code></td>
<td>
<p>DEPRECATED!  Use other.data instead.</p>
</td></tr>
<tr><td><code id="fit.coxmodel_+3A_rounding">rounding</code></td>
<td>
<p>How many digits of precision should be returned?</p>
</td></tr>
<tr><td><code id="fit.coxmodel_+3A_other.data">other.data</code></td>
<td>
<p>A data-frame (or matrix?) of variables to be controlled in
the Cox model. If null, no adjustment is done.  No interactions are fit.</p>
</td></tr>
<tr><td><code id="fit.coxmodel_+3A_data.type.ordinal">data.type.ordinal</code></td>
<td>
<p>Logical indicating whether to treat this datatype
as ordinal. Defaults to FALSE</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing two elements. <code>cox.stats</code> containing a vector
or matrix: HR, lower 95% CI of HR, upper 95% CI of HR, P-value (for
groups), number of samples (total with group assignments, although some may
not be included in fit for other reasons so this is an upper-limit).
<code>cox.obj</code> containing coxph model object
</p>


<h3>Author(s)</h3>

<p>Syed Haider &amp; Paul C. Boutros
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
survtime &lt;- sample(seq(0.1,10,0.1), 100, replace = TRUE);
survstat &lt;- sample(c(0,1), 100, replace = TRUE);
survobj &lt;- Surv(survtime, survstat);
groups &lt;- sample(c('A','B'), 100, replace = TRUE);
fit.coxmodel(
  groups = as.factor(groups),
  survobj = survobj
  );

</code></pre>

<hr>
<h2 id='fit.interaction.model'>Cox model two features separately and together</h2><span id='topic+fit.interaction.model'></span>

<h3>Description</h3>

<p>Using a meta-analysis dataset take two features and Cox model them
separately and together and extract HRs and p-values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit.interaction.model(
  feature1,
  feature2,
  expression.data,
  survival.data,
  data.type.ordinal = FALSE,
  centre.data = "median"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fit.interaction.model_+3A_feature1">feature1</code></td>
<td>
<p>String indicate what feature (gene/probe/etc.) should be
extracted for analysis</p>
</td></tr>
<tr><td><code id="fit.interaction.model_+3A_feature2">feature2</code></td>
<td>
<p>String indicate what feature (gene/probe/etc.) should be
extracted for analysis</p>
</td></tr>
<tr><td><code id="fit.interaction.model_+3A_expression.data">expression.data</code></td>
<td>
<p>A list where each component is an expression matrix
(patients = columns, features = rows) for a different dataset</p>
</td></tr>
<tr><td><code id="fit.interaction.model_+3A_survival.data">survival.data</code></td>
<td>
<p>A list where each component is an object of class Surv</p>
</td></tr>
<tr><td><code id="fit.interaction.model_+3A_data.type.ordinal">data.type.ordinal</code></td>
<td>
<p>Logical indicating whether to treat this datatype
as ordinal. Defaults to FALSE</p>
</td></tr>
<tr><td><code id="fit.interaction.model_+3A_centre.data">centre.data</code></td>
<td>
<p>A character string specifying the centre value to be used for 
scaling data. Valid values are: 'median', 'mean', or a user defined numeric threshold
e.g. '0.3' when modelling methylation beta values. This value is used for both scaling
as well as for dichotomising data for estimating univariate betas from Cox model.
Defaults to 'median'</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The interaction model compares cases where feature1 and feature2 concord
(both high or both low) to those where they do not. That is, the model is y
= x1 + x2 + (x1 == x2) and not the typical y = x1 + x2 + x1:x2
</p>


<h3>Value</h3>

<p>Returns a vector of six elements containing (HR,P) pairs for
feature1, feature2, and the interaction
</p>


<h3>Author(s)</h3>

<p>Syed Haider &amp; Paul C. Boutros
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data.dir &lt;- get.program.defaults()[["test.data.dir"]];
data.types &lt;- c("mRNA");
x1 &lt;- load.cancer.datasets(
  datasets.to.load = c('Breastdata1'),
  data.types = data.types,
  data.directory = data.dir
  );
x2 &lt;- fit.interaction.model(
  feature1 = "1000_at", 
  feature2 = "2549_at",
  expression.data = x1$all.data[[data.types[1]]],
  survival.data = x1$all.survobj
  );

</code></pre>

<hr>
<h2 id='fit.survivalmodel'>Trains a multivariate survival model</h2><span id='topic+fit.survivalmodel'></span>

<h3>Description</h3>

<p>Trains a multivariate survival model and conducts feature selection using
both backward elimination and forward selection, independently. TO BE
DEPRECATED AND HAS BEEN REPLACED BY <code>create.classifier.multivariate</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit.survivalmodel(
  data.directory = ".",
  output.directory = ".",
  feature.selection.datasets = NULL,
  feature.selection.p.threshold = 0.05,
  training.datasets = NULL,
  top.n.features = 25,
  models = c("1", "2", "3")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fit.survivalmodel_+3A_data.directory">data.directory</code></td>
<td>
<p>Path to the directory containing datasets as specified
by <code>feature.selection.datasets</code>, <code>training.datasets</code></p>
</td></tr>
<tr><td><code id="fit.survivalmodel_+3A_output.directory">output.directory</code></td>
<td>
<p>Path to the output folder where intermediate and
results files will be saved</p>
</td></tr>
<tr><td><code id="fit.survivalmodel_+3A_feature.selection.datasets">feature.selection.datasets</code></td>
<td>
<p>A vector containing names of datasets used
for feature selection in function <code>derive.network.features()</code></p>
</td></tr>
<tr><td><code id="fit.survivalmodel_+3A_feature.selection.p.threshold">feature.selection.p.threshold</code></td>
<td>
<p>One of the P values that were used for
feature selection in function <code>derive.network.features()</code>. This
function does not support vector of P values as used in
<code>derive.network.features()</code> for performance reasons</p>
</td></tr>
<tr><td><code id="fit.survivalmodel_+3A_training.datasets">training.datasets</code></td>
<td>
<p>A vector containing names of training datasets to
be used to train multivariate survival model</p>
</td></tr>
<tr><td><code id="fit.survivalmodel_+3A_top.n.features">top.n.features</code></td>
<td>
<p>A numeric value specifying how many top ranked
features will be used to train the multivariate survival model</p>
</td></tr>
<tr><td><code id="fit.survivalmodel_+3A_models">models</code></td>
<td>
<p>A character vector specifying which models ('1' = N+E, '2' =
N, '3' = E) to run</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The output files are stored under <code>output.directory</code>/output/
</p>


<h3>Author(s)</h3>

<p>Syed Haider
</p>


<h3>See Also</h3>

<p><code>create.classifier.multivariate</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# see package's main documentation

</code></pre>

<hr>
<h2 id='get.adjacency.matrix'>A utility function to convert tab delimited networks file into adjacency
matrices</h2><span id='topic+get.adjacency.matrix'></span>

<h3>Description</h3>

<p>A utility function to convert tab-delimited networks file into adjacency
matrices
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.adjacency.matrix(subnets.file = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get.adjacency.matrix_+3A_subnets.file">subnets.file</code></td>
<td>
<p>A tab-delimited file containing networks. New networks
start with a new line with '#' at the begining of network name and
subsequent lines contain a binary interaction per line</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of adjacency matrices
</p>


<h3>Author(s)</h3>

<p>Syed Haider
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
subnets.file &lt;- get.program.defaults()[["subnets.file"]];
all.adjacency.matrices &lt;- get.adjacency.matrix(subnets.file);

</code></pre>

<hr>
<h2 id='get.chisq.stats'>Applies survdiff function</h2><span id='topic+get.chisq.stats'></span>

<h3>Description</h3>

<p>Applies survdiff on different prognoses groups and computes Logrank P using
chisquare statistics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.chisq.stats(groups, survobj)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get.chisq.stats_+3A_groups">groups</code></td>
<td>
<p>Grouping of patients (passed directly to survdiff, so factors
&amp; continuous variables are okay)</p>
</td></tr>
<tr><td><code id="get.chisq.stats_+3A_survobj">survobj</code></td>
<td>
<p>An object of class Surv (from the survival package) &ndash;
patient ordering needs to be identical as for groups</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector containing: Chisq, degrees of freedom (DOF) and Logrank
P-value.
</p>


<h3>Author(s)</h3>

<p>Syed Haider
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
survtime &lt;- sample(seq(0.1,10,0.1), 100, replace = TRUE);
survstat &lt;- sample(c(0,1), 100, replace = TRUE);
survobj &lt;- Surv(survtime, survstat);
groups &lt;- sample(c('A','B'), 100, replace = TRUE);
get.chisq.stats(
  groups = as.factor(groups),
  survobj = survobj
  );

</code></pre>

<hr>
<h2 id='get.program.defaults'>A utility function to return the inst/ directory of the installed package
and other default settings</h2><span id='topic+get.program.defaults'></span>

<h3>Description</h3>

<p>A utility function to return the inst/ directory of the installed package to
get the test datasets and other program related data contents
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.program.defaults(networks.database = "default")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get.program.defaults_+3A_networks.database">networks.database</code></td>
<td>
<p>Name of the pathway networks database. Default to
NCI PID/Reactome/Biocarta i-e &quot;default&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list of paths to the input directories/files where the
contents of this package are installed
</p>


<h3>Author(s)</h3>

<p>Syed Haider
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
program.data &lt;- get.program.defaults();

</code></pre>

<hr>
<h2 id='load.cancer.datasets'>Load all cancer meta-analysis datasets</h2><span id='topic+load.cancer.datasets'></span>

<h3>Description</h3>

<p>Returns a list of lists containing all cancer meta-analysis datasets
</p>


<h3>Usage</h3>

<pre><code class='language-R'>load.cancer.datasets(
  tumour.only = TRUE,
  with.survival.only = TRUE,
  truncate.survival = 100,
  datasets.to.load = "all",
  data.types = c("mRNA"),
  datasets.file = "datasets.txt",
  data.directory = ".",
  verbose = FALSE,
  subset = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="load.cancer.datasets_+3A_tumour.only">tumour.only</code></td>
<td>
<p>Logical indicating if we should only load tumour samples
(TRUE, the default)</p>
</td></tr>
<tr><td><code id="load.cancer.datasets_+3A_with.survival.only">with.survival.only</code></td>
<td>
<p>Logical indicating if we should only load samples
with survival data (TRUE, the default)</p>
</td></tr>
<tr><td><code id="load.cancer.datasets_+3A_truncate.survival">truncate.survival</code></td>
<td>
<p>A numeric value specifying survival truncation in
years. Defaults to 100 years which effectively means no truncation</p>
</td></tr>
<tr><td><code id="load.cancer.datasets_+3A_datasets.to.load">datasets.to.load</code></td>
<td>
<p>A vector of datasets to be loaded.  If 'all', then
all available datasets are loaded</p>
</td></tr>
<tr><td><code id="load.cancer.datasets_+3A_data.types">data.types</code></td>
<td>
<p>A vector of molecular datatypes to load. Defaults to
c('mRNA')</p>
</td></tr>
<tr><td><code id="load.cancer.datasets_+3A_datasets.file">datasets.file</code></td>
<td>
<p>A file in data.directory containing a listing of all
usable datasets</p>
</td></tr>
<tr><td><code id="load.cancer.datasets_+3A_data.directory">data.directory</code></td>
<td>
<p>A directory containing all data-files to be loaded</p>
</td></tr>
<tr><td><code id="load.cancer.datasets_+3A_verbose">verbose</code></td>
<td>
<p>Logical indicating whether or not status messages should be
given</p>
</td></tr>
<tr><td><code id="load.cancer.datasets_+3A_subset">subset</code></td>
<td>
<p>A list with a Field and Entry component specifying a subset of
patients to be selected whose annotation Field matches Entry</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a meta-analysis list of lists
</p>


<h3>Author(s)</h3>

<p>Syed Haider &amp; Paul C. Boutros
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data.dir &lt;- get.program.defaults()[["test.data.dir"]];
x1 &lt;- load.cancer.datasets(
  datasets.to.load = c('Breastdata1'),
  data.types = c("mRNA"),
  data.directory = data.dir
  );

</code></pre>

<hr>
<h2 id='make.matrix'>Utility function used by <code>get.adjacency.matrix()</code></h2><span id='topic+make.matrix'></span>

<h3>Description</h3>

<p>Utility function used by <code>get.adjacency.matrix()</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make.matrix(vertices, interactions)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="make.matrix_+3A_vertices">vertices</code></td>
<td>
<p>Comma separated list of nodes</p>
</td></tr>
<tr><td><code id="make.matrix_+3A_interactions">interactions</code></td>
<td>
<p>Comma separated list of edges</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns adjacency matrix
</p>


<h3>Author(s)</h3>

<p>Syed Haider
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
x1 &lt;- make.matrix("a,b,c", "a:b,b:c");

</code></pre>

<hr>
<h2 id='pred.survivalmodel'>Apply a multivariate survival model to validation datasets</h2><span id='topic+pred.survivalmodel'></span>

<h3>Description</h3>

<p>Predicts the risk score for all the training &amp; validation datasets, independently. This
function also predicts the risk score for combined training datasets cohort
and validation datasets cohort. The risk score estimation is done by
multivariate models fit by <code>fit.survivalmodel</code>. The function also
predicts risk scores for each of the <code>top.n.features</code> independently. TO
BE DEPRECATED AND HAS BEEN REPLACED BY <code>create.classifier.multivariate</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pred.survivalmodel(
  data.directory = ".",
  output.directory = ".",
  feature.selection.datasets = NULL,
  feature.selection.p.threshold = 0.05,
  training.datasets = NULL,
  validation.datasets = NULL,
  top.n.features = 25,
  models = c("1", "2", "3"),
  write.risk.data = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pred.survivalmodel_+3A_data.directory">data.directory</code></td>
<td>
<p>Path to the directory containing datasets as specified
by <code>feature.selection.datasets</code>, <code>training.datasets</code>,
<code>validation.datasets</code></p>
</td></tr>
<tr><td><code id="pred.survivalmodel_+3A_output.directory">output.directory</code></td>
<td>
<p>Path to the output folder where intermediate and
results files will be saved</p>
</td></tr>
<tr><td><code id="pred.survivalmodel_+3A_feature.selection.datasets">feature.selection.datasets</code></td>
<td>
<p>A vector containing names of datasets used
for feature selection in function <code>derive.network.features()</code></p>
</td></tr>
<tr><td><code id="pred.survivalmodel_+3A_feature.selection.p.threshold">feature.selection.p.threshold</code></td>
<td>
<p>One of the P values that were used for
feature selection in function <code>derive.network.features()</code>. This
function does not support vector of P values as used in
<code>derive.network.features()</code> for performance reasons</p>
</td></tr>
<tr><td><code id="pred.survivalmodel_+3A_training.datasets">training.datasets</code></td>
<td>
<p>A vector containing names of training datasets</p>
</td></tr>
<tr><td><code id="pred.survivalmodel_+3A_validation.datasets">validation.datasets</code></td>
<td>
<p>A vector containing names of validation datasets</p>
</td></tr>
<tr><td><code id="pred.survivalmodel_+3A_top.n.features">top.n.features</code></td>
<td>
<p>A numeric value specifying how many top ranked
features will be used for univariate survival modelling</p>
</td></tr>
<tr><td><code id="pred.survivalmodel_+3A_models">models</code></td>
<td>
<p>A character vector specifying which of the models ('1' = N+E,
'2' = N, '3' = E) to run</p>
</td></tr>
<tr><td><code id="pred.survivalmodel_+3A_write.risk.data">write.risk.data</code></td>
<td>
<p>A toggle to control whether risk scores and patient
risk groups should be written to file</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The output files are stored under <code>output.directory</code>/output/
</p>


<h3>Author(s)</h3>

<p>Syed Haider
</p>


<h3>See Also</h3>

<p><code>create.classifier.multivariate</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# see package's main documentation

</code></pre>

<hr>
<h2 id='prepare.training.validation.datasets'>Prepare training and validation datasets</h2><span id='topic+prepare.training.validation.datasets'></span>

<h3>Description</h3>

<p>Computes per-patient pathway-derived network impact scores across all input
datasets, independently
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prepare.training.validation.datasets(
  data.directory = ".",
  output.directory = ".",
  data.types = c("mRNA"),
  data.types.ordinal = c("cna"),
  min.ordinal.threshold = c(cna = 3),
  centre.data = "median",
  p.threshold = 0.5,
  feature.selection.datasets = NULL,
  datasets = NULL,
  truncate.survival = 100,
  networks.database = "default",
  write.normed.datasets = TRUE,
  subset = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="prepare.training.validation.datasets_+3A_data.directory">data.directory</code></td>
<td>
<p>Path to the directory containing datasets as specified
by <code>datasets</code></p>
</td></tr>
<tr><td><code id="prepare.training.validation.datasets_+3A_output.directory">output.directory</code></td>
<td>
<p>Path to the output folder where intermediate and
results files will be saved</p>
</td></tr>
<tr><td><code id="prepare.training.validation.datasets_+3A_data.types">data.types</code></td>
<td>
<p>A vector of molecular datatypes to load. Defaults to
c('mRNA')</p>
</td></tr>
<tr><td><code id="prepare.training.validation.datasets_+3A_data.types.ordinal">data.types.ordinal</code></td>
<td>
<p>A vector of molecular datatypes to be treated as
ordinal. Defaults to c('cna')</p>
</td></tr>
<tr><td><code id="prepare.training.validation.datasets_+3A_min.ordinal.threshold">min.ordinal.threshold</code></td>
<td>
<p>A named vector specifying minimum percent
threshold for each ordinal data type to be used prior to estimating
coefficients. Coefficient for features not satisfying minimum threshold will
not be estimated, and set to 0. Defaults to cna threshold as 3 percent</p>
</td></tr>
<tr><td><code id="prepare.training.validation.datasets_+3A_centre.data">centre.data</code></td>
<td>
<p>A character string specifying the centre value to be used for 
scaling data. Valid values are: 'median', 'mean', or a user defined numeric threshold
e.g. '0.3' when modelling methylation beta values. This value is used for both scaling
as well as for dichotomising data for estimating univariate betas from Cox model.
Defaults to 'median'</p>
</td></tr>
<tr><td><code id="prepare.training.validation.datasets_+3A_p.threshold">p.threshold</code></td>
<td>
<p>Cox P value threshold to be applied for selecting features 
(e.g. genes) which will contribute to patient risk score estimation. Defaults to 0.5</p>
</td></tr>
<tr><td><code id="prepare.training.validation.datasets_+3A_feature.selection.datasets">feature.selection.datasets</code></td>
<td>
<p>A vector containing names of datasets used
for feature selection in function <code>derive.network.features()</code></p>
</td></tr>
<tr><td><code id="prepare.training.validation.datasets_+3A_datasets">datasets</code></td>
<td>
<p>A vector containing names of all the datasets to be later
used for training and validation purposes</p>
</td></tr>
<tr><td><code id="prepare.training.validation.datasets_+3A_truncate.survival">truncate.survival</code></td>
<td>
<p>A numeric value specifying survival truncation in
years. Defaults to 100 years which effectively means no truncation</p>
</td></tr>
<tr><td><code id="prepare.training.validation.datasets_+3A_networks.database">networks.database</code></td>
<td>
<p>Name of the pathway networks database. Default to
NCI PID/Reactome/Biocarta i-e &quot;default&quot;</p>
</td></tr>
<tr><td><code id="prepare.training.validation.datasets_+3A_write.normed.datasets">write.normed.datasets</code></td>
<td>
<p>A toggle to control whether processed mRNA and
survival data should be written to file</p>
</td></tr>
<tr><td><code id="prepare.training.validation.datasets_+3A_subset">subset</code></td>
<td>
<p>A list with a Field and Entry component specifying a subset of
patients to be selected whose annotation Field matches Entry</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The output files are stored under <code>output.directory</code>/output/
</p>


<h3>Author(s)</h3>

<p>Syed Haider
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# get data directory 
data.directory &lt;- get.program.defaults()[["test.data.dir"]];

# initialise params
output.directory &lt;- tempdir();
data.types &lt;- c("mRNA");
feature.selection.datasets &lt;- c("Breastdata1");
training.datasets &lt;- c("Breastdata1");
validation.datasets &lt;- c("Breastdata1", "Breastdata2");

# preparing training and validation datasets.
# Normalisation &amp; patientwise subnet feature scores
prepare.training.validation.datasets(
  data.directory = data.directory,
  output.directory = output.directory,
  data.types =  data.types,
  feature.selection.datasets = feature.selection.datasets,
  datasets = unique(c(training.datasets, validation.datasets)),
  networks.database = "test"
  );

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
