<!DOCTYPE html><html><head><title>Help for package quickNmix</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {quickNmix}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#anmu'><p>Ancient Murrelet Chick Counts</p></a></li>
<li><a href='#Ax_log'><p>FUNCTION_TITLE</p></a></li>
<li><a href='#eagles'><p>Golden Eagle Counts Data</p></a></li>
<li><a href='#fitNmix'><p>Fit Asymptotic N-mixture Model</p></a></li>
<li><a href='#fitNmixPara'><p>Fit Asymptotic N-mixture Model Using optimParallel</p></a></li>
<li><a href='#log_tp_MAT_lse'><p>FUNCTION_TITLE</p></a></li>
<li><a href='#logSubtractExp'><p>FUNCTION_TITLE</p></a></li>
<li><a href='#logSumExp'><p>FUNCTION_TITLE</p></a></li>
<li><a href='#nll'><p>Negative Log Likelihood</p></a></li>
<li><a href='#Pab'><p>FUNCTION_TITLE</p></a></li>
<li><a href='#Pab_asymptotic'><p>FUNCTION_TITLE</p></a></li>
<li><a href='#Pab_gamma'><p>FUNCTION_TITLE</p></a></li>
<li><a href='#Pab_omega'><p>FUNCTION_TITLE</p></a></li>
<li><a href='#pCountOpenFFT'><p>Fit FFT N-mixture Model</p></a></li>
<li><a href='#quickNmix-package'><p>quickNmix: Asymptotic N-Mixture Model Fitting</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Asymptotic N-Mixture Model Fitting</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-02-28</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Matthew RP Parker &lt;mrparker909@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>For fitting N-mixture models using either FFT or asymptotic approaches. FFT N-mixture models extend the work of Cowen et al. (2017) &lt;<a href="https://doi.org/10.1111%2Fbiom.12701">doi:10.1111/biom.12701</a>&gt;. Asymptotic N-mixture models extend the work of Dail and Madsen (2011) &lt;<a href="https://doi.org/10.1111%2Fj.1541-0420.2010.01465.x">doi:10.1111/j.1541-0420.2010.01465.x</a>&gt;, to consider asymptotic solutions to the open population N-mixture models. The FFT models are derived and described in "Parker, M.R.P., Elliott, L., Cowen, L.L.E. (2022). Computational efficiency and precision for replicated-count and batch-marked hidden population models [Manuscript in preparation]. Department of Statistics and Actuarial Sciences, Simon Fraser University.". The asymptotic models are derived and described in: "Parker, M.R.P., Elliott, L., Cowen, L.L.E., Cao, J. (2022). Fast asymptotic solutions for N-mixtures on large populations [Manuscript in preparation]. Department of Statistics and Actuarial Sciences, Simon Fraser University.".</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, knitr, rmarkdown</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Imports:</td>
<td>foreach, parallel, optimParallel, doParallel,</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-03-19 17:29:54 UTC; Matthew</td>
</tr>
<tr>
<td>Author:</td>
<td>Matthew RP Parker <a href="https://orcid.org/0000-0003-3021-7959"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Lloyd Elliott <a href="https://orcid.org/0000-0003-2187-7314"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Laura LE Cowen <a href="https://orcid.org/0000-0002-0853-1450"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Jiguo Cao <a href="https://orcid.org/0000-0001-7417-6330"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-03-21 08:00:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='anmu'>Ancient Murrelet Chick Counts</h2><span id='topic+anmu'></span>

<h3>Description</h3>

<p>Parker et al. (2020) include a data set collected by the
Laskeek Bay Conservation Society on yearly Ancient Murrelet chick counts
from the year 1990 to 2006. The data is collected for six sampling sites
on East Limestone Island.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anmu
</code></pre>


<h3>Format</h3>

<p>A matrix with 6 rows and 17 columns. Each row represents a sampling location, and each column represents a sampling occasion:
</p>


<h3>Source</h3>

<p>Parker et al. (2020) doi: <a href="https://doi.org/10.1007/s10651-020-00455-3">10.1007/s10651-020-00455-3</a>
</p>


<h3>References</h3>

<p>Parker, M.R.P., Pattison, V. &amp; Cowen, L.L.E. Estimating population abundance using counts from an auxiliary population. Environ Ecol Stat 27, 509â€“526 (2020). doi: <a href="https://doi.org/10.1007/s10651-020-00455-3">10.1007/s10651-020-00455-3</a>
</p>

<hr>
<h2 id='Ax_log'>FUNCTION_TITLE</h2><span id='topic+Ax_log'></span>

<h3>Description</h3>

<p>FUNCTION_DESCRIPTION
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Ax_log(logA, logx)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Ax_log_+3A_loga">logA</code></td>
<td>
<p>PARAM_DESCRIPTION</p>
</td></tr>
<tr><td><code id="Ax_log_+3A_logx">logx</code></td>
<td>
<p>PARAM_DESCRIPTION</p>
</td></tr>
</table>


<h3>Details</h3>

<p>DETAILS
</p>


<h3>Value</h3>

<p>OUTPUT_DESCRIPTION
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
if(interactive()){
 #EXAMPLE1
 }

## End(Not run)
</code></pre>

<hr>
<h2 id='eagles'>Golden Eagle Counts Data</h2><span id='topic+eagles'></span>

<h3>Description</h3>

<p>Golden Eagle counts for the years 1993 to 2020, collected by the Rocky Mountain Eagle Research Foundation (RMERF). Counts are made during the spring from April 1st until March 22nd each year. Data is available from Eaglewatch.ca.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eagles
</code></pre>


<h3>Format</h3>

<p>A data frame with 28 rows and 11 columns. Each row represents a spring observation period, and each column represents a variable:
</p>

<dl>
<dt>Year</dt><dd><p>observation year</p>
</dd>
<dt>Hours</dt><dd><p>hours spent collecting observations</p>
</dd>
<dt>Eagles</dt><dd><p>number of Golden Eagles observed</p>
</dd>
<dt>TotPrec</dt><dd><p>total precipitation measured in mm</p>
</dd>
<dt>UniqueObservers</dt><dd><p>number of principle observers who performed observations</p>
</dd>
<dt>PeterSherrington_Year</dt><dd><p>indicator variable which is 1 for years in which Peter Sherrington was the most prevalent principle observer</p>
</dd>
<dt>observerPC1</dt><dd><p>top 5 principal component scores calculated from the top twelve most prevalent principal observers</p>
</dd>
<dt>observerPC2</dt><dd><p>top 5 principal component scores calculated from the top twelve most prevalent principal observers</p>
</dd>
<dt>observerPC3</dt><dd><p>top 5 principal component scores calculated from the top twelve most prevalent principal observers</p>
</dd>
<dt>observerPC4</dt><dd><p>top 5 principal component scores calculated from the top twelve most prevalent principal observers</p>
</dd>
<dt>observerPC5</dt><dd><p>top 5 principal component scores calculated from the top twelve most prevalent principal observers</p>
</dd>
</dl>



<h3>Source</h3>

<p>RMERF (2020) EagleWatch.ca
</p>


<h3>References</h3>

<p>Rocky Mountain Eagle Research Foundation (RMERF). EagleWatch.ca. (2020).
</p>

<hr>
<h2 id='fitNmix'>Fit Asymptotic N-mixture Model</h2><span id='topic+fitNmix'></span>

<h3>Description</h3>

<p>Fit an open population N-mixture model using the asymptotic approximation. The four parameters are mean initial site abundance lambda, mean recruitments gamma, survival probability omega, and probability of detection pdet. Parameters can be made to vary over sites and over times by including parameter covariates. Note that this function is essentially a wrapper for optim acting on the nll function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitNmix(
  nit,
  K = NULL,
  starts = NULL,
  l_s_c = NULL,
  g_s_c = NULL,
  g_t_c = NULL,
  o_s_c = NULL,
  o_t_c = NULL,
  p_s_c = NULL,
  p_t_c = NULL,
  SMALL_a_CORRECTION = FALSE,
  VERBOSE = FALSE,
  outfile = NULL,
  method = "BFGS",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitNmix_+3A_nit">nit</code></td>
<td>
<p>Matrix of counts data. Rows represent sites, columns represent sampling occasions. Note that if the data is a vector, then it will be converted to a matrix with a single row.</p>
</td></tr>
<tr><td><code id="fitNmix_+3A_k">K</code></td>
<td>
<p>Upper bound on summations in the likelihood function. K should be chosen large enough that the negative log likelihood function is stable (unchanging as K increases). If K=NULL, K=5*max(nit) will be used as default. Default: NULL</p>
</td></tr>
<tr><td><code id="fitNmix_+3A_starts">starts</code></td>
<td>
<p>Either NULL for default starting values, or a vector of parameter values: <code>c(log(lambda), log(gamma), logit(omega), logit(pdet))</code>. Note that the parameter vector will need to be longer by one for each parameter coefficient if covariate values are supplied. The order of coefficients is: <code>c(lambda, l_s_c, gamma, g_s_c, g_t_c, omega, o_s_c, o_t_c, pdet, p_s_c, p_t_c)</code></p>
</td></tr>
<tr><td><code id="fitNmix_+3A_l_s_c">l_s_c</code></td>
<td>
<p>List of lambda site covariates, Default: NULL</p>
</td></tr>
<tr><td><code id="fitNmix_+3A_g_s_c">g_s_c</code></td>
<td>
<p>List of gamma site covariates, Default: NULL</p>
</td></tr>
<tr><td><code id="fitNmix_+3A_g_t_c">g_t_c</code></td>
<td>
<p>List of gamma time covariates, Default: NULL</p>
</td></tr>
<tr><td><code id="fitNmix_+3A_o_s_c">o_s_c</code></td>
<td>
<p>List of omega site covariates, Default: NULL</p>
</td></tr>
<tr><td><code id="fitNmix_+3A_o_t_c">o_t_c</code></td>
<td>
<p>List of omega time covariates, Default: NULL</p>
</td></tr>
<tr><td><code id="fitNmix_+3A_p_s_c">p_s_c</code></td>
<td>
<p>List of pdet site covariates, Default: NULL</p>
</td></tr>
<tr><td><code id="fitNmix_+3A_p_t_c">p_t_c</code></td>
<td>
<p>List of pdet time covariates, Default: NULL</p>
</td></tr>
<tr><td><code id="fitNmix_+3A_small_a_correction">SMALL_a_CORRECTION</code></td>
<td>
<p>If TRUE will apply the small a correction when calculating the transition probability matrix, Default: FALSE</p>
</td></tr>
<tr><td><code id="fitNmix_+3A_verbose">VERBOSE</code></td>
<td>
<p>If TRUE, will print additional information during model fitting, Default: FALSE</p>
</td></tr>
<tr><td><code id="fitNmix_+3A_outfile">outfile</code></td>
<td>
<p>Location of csv file to write/append parameter values, can be used to checkpoint long running model fits. Default: NULL</p>
</td></tr>
<tr><td><code id="fitNmix_+3A_method">method</code></td>
<td>
<p>Optimization method, passed to optim function, options include: &quot;BFGS&quot;, &quot;Nelder-Mead&quot;, &quot;CG&quot;. Default: &quot;BFGS&quot;</p>
</td></tr>
<tr><td><code id="fitNmix_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to the optimization function optim. For example: <code>control = list(trace=1, REPORT=1, reltol=1e-10)</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the fitted model object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (interactive()) {
nit = matrix(c(1,1,0,1,1), nrow=1) # observations for 1 site, 5 sampling occassions
model1 = fitNmix(nit, K=2)        # fit the model with population upper bound K=2
}
</code></pre>

<hr>
<h2 id='fitNmixPara'>Fit Asymptotic N-mixture Model Using optimParallel</h2><span id='topic+fitNmixPara'></span>

<h3>Description</h3>

<p>Fit an open population N-mixture model using the asymptotic approximation. The four parameters are mean initial site abundance lambda, mean recruitments gamma, survival probability omega, and probability of detection pdet. Parameters can be made to vary over sites and over times by including parameter covariates. Note that this function is essentially a wrapper for optim acting on the nll function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitNmixPara(
  cluster,
  nit,
  K = NULL,
  starts = NULL,
  l_s_c = NULL,
  g_s_c = NULL,
  g_t_c = NULL,
  o_s_c = NULL,
  o_t_c = NULL,
  p_s_c = NULL,
  p_t_c = NULL,
  SMALL_a_CORRECTION = FALSE,
  VERBOSE = FALSE,
  outfile = NULL,
  LowerBounds = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitNmixPara_+3A_cluster">cluster</code></td>
<td>
<p>cluster object created using makeCluster, for example: <code>cl &lt;- makeCluster(parallel::detectCores()-1)</code></p>
</td></tr>
<tr><td><code id="fitNmixPara_+3A_nit">nit</code></td>
<td>
<p>Matrix of counts data. Rows represent sites, columns represent sampling occasions. Note that if the data is a vector, then it will be converted to a matrix with a single row.</p>
</td></tr>
<tr><td><code id="fitNmixPara_+3A_k">K</code></td>
<td>
<p>Upper bound on summations in the likelihood function. K should be chosen large enough that the negative log likelihood function is stable (unchanging as K increases). If K=NULL, K=5*max(nit) will be used as default. Default: NULL</p>
</td></tr>
<tr><td><code id="fitNmixPara_+3A_starts">starts</code></td>
<td>
<p>Either NULL for default starting values, or a vector of parameter values: <code>c(log(lambda), log(gamma), logit(omega), logit(pdet))</code>. Note that the parameter vector will need to be longer by one for each parameter coefficient if covariate values are supplied. The order of coefficients is: <code>c(lambda, l_s_c, gamma, g_s_c, g_t_c, omega, o_s_c, o_t_c, pdet, p_s_c, p_t_c)</code></p>
</td></tr>
<tr><td><code id="fitNmixPara_+3A_l_s_c">l_s_c</code></td>
<td>
<p>List of lambda site covariates, Default: NULL</p>
</td></tr>
<tr><td><code id="fitNmixPara_+3A_g_s_c">g_s_c</code></td>
<td>
<p>List of gamma site covariates, Default: NULL</p>
</td></tr>
<tr><td><code id="fitNmixPara_+3A_g_t_c">g_t_c</code></td>
<td>
<p>List of gamma time covariates, Default: NULL</p>
</td></tr>
<tr><td><code id="fitNmixPara_+3A_o_s_c">o_s_c</code></td>
<td>
<p>List of omega site covariates, Default: NULL</p>
</td></tr>
<tr><td><code id="fitNmixPara_+3A_o_t_c">o_t_c</code></td>
<td>
<p>List of omega time covariates, Default: NULL</p>
</td></tr>
<tr><td><code id="fitNmixPara_+3A_p_s_c">p_s_c</code></td>
<td>
<p>List of pdet site covariates, Default: NULL</p>
</td></tr>
<tr><td><code id="fitNmixPara_+3A_p_t_c">p_t_c</code></td>
<td>
<p>List of pdet time covariates, Default: NULL</p>
</td></tr>
<tr><td><code id="fitNmixPara_+3A_small_a_correction">SMALL_a_CORRECTION</code></td>
<td>
<p>If TRUE will apply the small a correction when calculating the transition probability matrix, Default: FALSE</p>
</td></tr>
<tr><td><code id="fitNmixPara_+3A_verbose">VERBOSE</code></td>
<td>
<p>If TRUE, will print additional information during model fitting, Default: FALSE</p>
</td></tr>
<tr><td><code id="fitNmixPara_+3A_outfile">outfile</code></td>
<td>
<p>Location of csv file to write/append parameter values, can be used to checkpoint long running model fits. Default: NULL</p>
</td></tr>
<tr><td><code id="fitNmixPara_+3A_lowerbounds">LowerBounds</code></td>
<td>
<p>Lower bounds to be passed to optimParallel (if NULL, default values will be used), you may need to set this manually if you receive errors such as: &quot;L-BFGS-B needs finite values of 'fn'&quot;.</p>
</td></tr>
<tr><td><code id="fitNmixPara_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to the optimization function optimParallel.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the fitted model object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (interactive()) {
cl &lt;- makeCluster(parallel::detectCores()-1) # number of clusters should be 2*p+1 for optimal gains
nit = matrix(c(1,1,0,1,1,2,2), nrow=1) # observations for 1 site, 7 sampling occassions
model1 = fitNmixPara(cl, nit, K=100) # fit the model with population upper bound K=100
parallel::stopCluster(cl)
}
</code></pre>

<hr>
<h2 id='log_tp_MAT_lse'>FUNCTION_TITLE</h2><span id='topic+log_tp_MAT_lse'></span>

<h3>Description</h3>

<p>FUNCTION_DESCRIPTION
</p>


<h3>Usage</h3>

<pre><code class='language-R'>log_tp_MAT_lse(M, omeg, gamm, corrections)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="log_tp_MAT_lse_+3A_m">M</code></td>
<td>
<p>PARAM_DESCRIPTION</p>
</td></tr>
<tr><td><code id="log_tp_MAT_lse_+3A_omeg">omeg</code></td>
<td>
<p>PARAM_DESCRIPTION</p>
</td></tr>
<tr><td><code id="log_tp_MAT_lse_+3A_gamm">gamm</code></td>
<td>
<p>PARAM_DESCRIPTION</p>
</td></tr>
<tr><td><code id="log_tp_MAT_lse_+3A_corrections">corrections</code></td>
<td>
<p>PARAM_DESCRIPTION</p>
</td></tr>
</table>


<h3>Details</h3>

<p>DETAILS
</p>


<h3>Value</h3>

<p>OUTPUT_DESCRIPTION
</p>


<h3>See Also</h3>

<p><code><a href="foreach.html#topic+foreach">foreach</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
if(interactive()){
 #EXAMPLE1
 }

## End(Not run)
</code></pre>

<hr>
<h2 id='logSubtractExp'>FUNCTION_TITLE</h2><span id='topic+logSubtractExp'></span>

<h3>Description</h3>

<p>FUNCTION_DESCRIPTION
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logSubtractExp(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logSubtractExp_+3A_x">x</code></td>
<td>
<p>PARAM_DESCRIPTION</p>
</td></tr>
</table>


<h3>Details</h3>

<p>DETAILS
</p>


<h3>Value</h3>

<p>OUTPUT_DESCRIPTION
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
if(interactive()){
 #EXAMPLE1
 }

## End(Not run)
</code></pre>

<hr>
<h2 id='logSumExp'>FUNCTION_TITLE</h2><span id='topic+logSumExp'></span>

<h3>Description</h3>

<p>FUNCTION_DESCRIPTION
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logSumExp(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logSumExp_+3A_x">x</code></td>
<td>
<p>PARAM_DESCRIPTION</p>
</td></tr>
</table>


<h3>Details</h3>

<p>DETAILS
</p>


<h3>Value</h3>

<p>OUTPUT_DESCRIPTION
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
if(interactive()){
 #EXAMPLE1
 }

## End(Not run)
</code></pre>

<hr>
<h2 id='nll'>Negative Log Likelihood</h2><span id='topic+nll'></span>

<h3>Description</h3>

<p>Computes the negative log likelihood function for the open population asymptotic N-mixtures model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nll(
  par,
  nit,
  K,
  l_s_c = NULL,
  g_s_c = NULL,
  g_t_c = NULL,
  o_s_c = NULL,
  o_t_c = NULL,
  p_s_c = NULL,
  p_t_c = NULL,
  SMALL_a_CORRECTION = FALSE,
  VERBOSE = FALSE,
  outfile = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nll_+3A_par">par</code></td>
<td>
<p>Vector of parameter values: c(log(lambda), log(gamma), logit(omega), logit(pdet)). Note that the parameter vector will need to be longer if covariate values are supplied.</p>
</td></tr>
<tr><td><code id="nll_+3A_nit">nit</code></td>
<td>
<p>Matrix of counts data. Rows represent sites, columns represent sampling occasions. Note that if the data is a vector, then it will be converted to a matrix with a single row.</p>
</td></tr>
<tr><td><code id="nll_+3A_k">K</code></td>
<td>
<p>Upper bound on summations in the likelihood function. K should be chosen large enough that the negative log likelihood function is stable (unchanging as K increases).</p>
</td></tr>
<tr><td><code id="nll_+3A_l_s_c">l_s_c</code></td>
<td>
<p>List of lambda site covariates, Default: NULL</p>
</td></tr>
<tr><td><code id="nll_+3A_g_s_c">g_s_c</code></td>
<td>
<p>List of gamma site covariates, Default: NULL</p>
</td></tr>
<tr><td><code id="nll_+3A_g_t_c">g_t_c</code></td>
<td>
<p>List of gamma time covariates, Default: NULL</p>
</td></tr>
<tr><td><code id="nll_+3A_o_s_c">o_s_c</code></td>
<td>
<p>List of omega site covariates, Default: NULL</p>
</td></tr>
<tr><td><code id="nll_+3A_o_t_c">o_t_c</code></td>
<td>
<p>List of omega time covariates, Default: NULL</p>
</td></tr>
<tr><td><code id="nll_+3A_p_s_c">p_s_c</code></td>
<td>
<p>List of pdet site covariates, Default: NULL</p>
</td></tr>
<tr><td><code id="nll_+3A_p_t_c">p_t_c</code></td>
<td>
<p>List of pdet time covariates, Default: NULL</p>
</td></tr>
<tr><td><code id="nll_+3A_small_a_correction">SMALL_a_CORRECTION</code></td>
<td>
<p>If TRUE will apply the small a correction when calculating the transition probability matrix, Default: FALSE</p>
</td></tr>
<tr><td><code id="nll_+3A_verbose">VERBOSE</code></td>
<td>
<p>If TRUE, will print additional information, Default: FALSE</p>
</td></tr>
<tr><td><code id="nll_+3A_outfile">outfile</code></td>
<td>
<p>Location of csv file to write/append parameter values, Default: NULL</p>
</td></tr>
</table>


<h3>Details</h3>

<p>DETAILS
</p>


<h3>Value</h3>

<p>Returns the negative log likelihood function evaluated at par.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (interactive()) {
nit = matrix(c(1,1,0,1,1), nrow=1) # observations for 1 site, 5 sampling occassions
par = c(1,1,1,0) # parameter values at which to calculate the negative log likelihood (nll)
nll(par, nit, K=10) # nll with K=10
nll(par, nit, K=10, SMALL_a_CORRECTION=TRUE) # nll with small a correction
}
</code></pre>

<hr>
<h2 id='Pab'>FUNCTION_TITLE</h2><span id='topic+Pab'></span>

<h3>Description</h3>

<p>FUNCTION_DESCRIPTION
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Pab(a, b, omega, gamma)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Pab_+3A_a">a</code></td>
<td>
<p>PARAM_DESCRIPTION</p>
</td></tr>
<tr><td><code id="Pab_+3A_b">b</code></td>
<td>
<p>PARAM_DESCRIPTION</p>
</td></tr>
<tr><td><code id="Pab_+3A_omega">omega</code></td>
<td>
<p>PARAM_DESCRIPTION</p>
</td></tr>
<tr><td><code id="Pab_+3A_gamma">gamma</code></td>
<td>
<p>PARAM_DESCRIPTION</p>
</td></tr>
</table>


<h3>Details</h3>

<p>DETAILS
</p>


<h3>Value</h3>

<p>OUTPUT_DESCRIPTION
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
if(interactive()){
 #EXAMPLE1
 }

## End(Not run)
</code></pre>

<hr>
<h2 id='Pab_asymptotic'>FUNCTION_TITLE</h2><span id='topic+Pab_asymptotic'></span>

<h3>Description</h3>

<p>FUNCTION_DESCRIPTION
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Pab_asymptotic(a, b, omega, gamma, corrections = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Pab_asymptotic_+3A_a">a</code></td>
<td>
<p>PARAM_DESCRIPTION</p>
</td></tr>
<tr><td><code id="Pab_asymptotic_+3A_b">b</code></td>
<td>
<p>PARAM_DESCRIPTION</p>
</td></tr>
<tr><td><code id="Pab_asymptotic_+3A_omega">omega</code></td>
<td>
<p>PARAM_DESCRIPTION</p>
</td></tr>
<tr><td><code id="Pab_asymptotic_+3A_gamma">gamma</code></td>
<td>
<p>PARAM_DESCRIPTION</p>
</td></tr>
<tr><td><code id="Pab_asymptotic_+3A_corrections">corrections</code></td>
<td>
<p>PARAM_DESCRIPTION, Default: FALSE</p>
</td></tr>
</table>


<h3>Details</h3>

<p>DETAILS
</p>


<h3>Value</h3>

<p>OUTPUT_DESCRIPTION
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
if(interactive()){
 #EXAMPLE1
 }

## End(Not run)
</code></pre>

<hr>
<h2 id='Pab_gamma'>FUNCTION_TITLE</h2><span id='topic+Pab_gamma'></span>

<h3>Description</h3>

<p>FUNCTION_DESCRIPTION
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Pab_gamma(a, b, gamma)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Pab_gamma_+3A_a">a</code></td>
<td>
<p>PARAM_DESCRIPTION</p>
</td></tr>
<tr><td><code id="Pab_gamma_+3A_b">b</code></td>
<td>
<p>PARAM_DESCRIPTION</p>
</td></tr>
<tr><td><code id="Pab_gamma_+3A_gamma">gamma</code></td>
<td>
<p>PARAM_DESCRIPTION</p>
</td></tr>
</table>


<h3>Details</h3>

<p>DETAILS
</p>


<h3>Value</h3>

<p>OUTPUT_DESCRIPTION
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
if(interactive()){
 #EXAMPLE1
 }

## End(Not run)
</code></pre>

<hr>
<h2 id='Pab_omega'>FUNCTION_TITLE</h2><span id='topic+Pab_omega'></span>

<h3>Description</h3>

<p>FUNCTION_DESCRIPTION
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Pab_omega(a, b, omega)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Pab_omega_+3A_a">a</code></td>
<td>
<p>PARAM_DESCRIPTION</p>
</td></tr>
<tr><td><code id="Pab_omega_+3A_b">b</code></td>
<td>
<p>PARAM_DESCRIPTION</p>
</td></tr>
<tr><td><code id="Pab_omega_+3A_omega">omega</code></td>
<td>
<p>PARAM_DESCRIPTION</p>
</td></tr>
</table>


<h3>Details</h3>

<p>DETAILS
</p>


<h3>Value</h3>

<p>OUTPUT_DESCRIPTION
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
if(interactive()){
 #EXAMPLE1
 }

## End(Not run)
</code></pre>

<hr>
<h2 id='pCountOpenFFT'>Fit FFT N-mixture Model</h2><span id='topic+pCountOpenFFT'></span>

<h3>Description</h3>

<p>Fit an open population N-mixture model using the FFT method of computing the Transition Probability matrix. The four parameters are mean initial site abundance lambda, mean recruitments gamma, survival probability omega, and probability of detection pdet. Parameters can be made to vary over sites and over times by including parameter covariates. Note that this function is essentially a wrapper for optim acting on the nll_FFT function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pCountOpenFFT(
  nit,
  K = NULL,
  starts = NULL,
  l_s_c = NULL,
  g_s_c = NULL,
  g_t_c = NULL,
  o_s_c = NULL,
  o_t_c = NULL,
  p_s_c = NULL,
  p_t_c = NULL,
  VERBOSE = FALSE,
  outfile = NULL,
  method = "BFGS",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pCountOpenFFT_+3A_nit">nit</code></td>
<td>
<p>Matrix of counts data. Rows represent sites, columns represent sampling occasions. Note that if the data is a vector, then it will be converted to a matrix with a single row.</p>
</td></tr>
<tr><td><code id="pCountOpenFFT_+3A_k">K</code></td>
<td>
<p>Upper bound on summations in the likelihood function. K should be chosen large enough that the negative log likelihood function is stable (unchanging as K increases). If K=NULL, K=5*max(nit) will be used as default. Default: NULL</p>
</td></tr>
<tr><td><code id="pCountOpenFFT_+3A_starts">starts</code></td>
<td>
<p>Either NULL for default starting values, or a vector of parameter values: <code>c(log(lambda), log(gamma), logit(omega), logit(pdet))</code>. Note that the parameter vector will need to be longer by one for each parameter coefficient if covariate values are supplied. The order of coefficients is: <code>c(lambda, l_s_c, gamma, g_s_c, g_t_c, omega, o_s_c, o_t_c, pdet, p_s_c, p_t_c)</code></p>
</td></tr>
<tr><td><code id="pCountOpenFFT_+3A_l_s_c">l_s_c</code></td>
<td>
<p>List of lambda site covariates, Default: NULL</p>
</td></tr>
<tr><td><code id="pCountOpenFFT_+3A_g_s_c">g_s_c</code></td>
<td>
<p>List of gamma site covariates, Default: NULL</p>
</td></tr>
<tr><td><code id="pCountOpenFFT_+3A_g_t_c">g_t_c</code></td>
<td>
<p>List of gamma time covariates, Default: NULL</p>
</td></tr>
<tr><td><code id="pCountOpenFFT_+3A_o_s_c">o_s_c</code></td>
<td>
<p>List of omega site covariates, Default: NULL</p>
</td></tr>
<tr><td><code id="pCountOpenFFT_+3A_o_t_c">o_t_c</code></td>
<td>
<p>List of omega time covariates, Default: NULL</p>
</td></tr>
<tr><td><code id="pCountOpenFFT_+3A_p_s_c">p_s_c</code></td>
<td>
<p>List of pdet site covariates, Default: NULL</p>
</td></tr>
<tr><td><code id="pCountOpenFFT_+3A_p_t_c">p_t_c</code></td>
<td>
<p>List of pdet time covariates, Default: NULL</p>
</td></tr>
<tr><td><code id="pCountOpenFFT_+3A_verbose">VERBOSE</code></td>
<td>
<p>If TRUE, will print additional information during model fitting, Default: FALSE</p>
</td></tr>
<tr><td><code id="pCountOpenFFT_+3A_outfile">outfile</code></td>
<td>
<p>Location of csv file to write/append parameter values, can be used to checkpoint long running model fits. Default: NULL (no csv file created).</p>
</td></tr>
<tr><td><code id="pCountOpenFFT_+3A_method">method</code></td>
<td>
<p>Optimization method, passed to optim function, options include: &quot;BFGS&quot;, &quot;Nelder-Mead&quot;, &quot;CG&quot;. Default: &quot;BFGS&quot;</p>
</td></tr>
<tr><td><code id="pCountOpenFFT_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to the optimization function optim. For example: <code>control = list(trace=1, REPORT=1, reltol=1e-10)</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the fitted model object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (interactive()) {
# No Covariates
nit = matrix(c(1,1,0,2,3), nrow=1) # observations for 1 site, 5 sampling occassions
model1 = pCountOpenFFT(nit, K=10)  # fit the model with population upper bound K=10

# Site Covariates
o_s_c = list(cov1=c(0,0,1)) # omega site covariates, cov1 is categorical
nit = matrix(c(1,1,0,2,3, 
               1,0,1,3,2, 
               4,1,3,2,0), nrow=3, byrow=T) # 3 sites, 5 sampling occassions
model2 = pCountOpenFFT(nit, K=20, o_s_c=o_s_c) # fit the model with population upper bound K=20

# Time Covariates
g_t_c = list(temp=c(0.5,0.3,0.6,0.7,NA)) # transition covariates: only first T-1=4 values used 
model3 = pCountOpenFFT(nit, K=10, g_t_c=g_t_c)  # fit the model with population upper bound K=10
}
</code></pre>

<hr>
<h2 id='quickNmix-package'>quickNmix: Asymptotic N-Mixture Model Fitting</h2><span id='topic+quickNmix'></span><span id='topic+quickNmix-package'></span>

<h3>Description</h3>

<p>For fitting N-mixture models using either FFT or asymptotic approaches. FFT N-mixture models extend the work of Cowen et al. (2017) &lt;doi:10.1111/biom.12701&gt;. Asymptotic N-mixture models extend the work of Dail and Madsen (2011) &lt;doi:10.1111/j.1541-0420.2010.01465.x&gt;, to consider asymptotic solutions to the open population N-mixture models. The FFT models are derived and described in &quot;Parker, M.R.P., Elliott, L., Cowen, L.L.E. (2022). Computational efficiency and precision for replicated-count and batch-marked hidden population models [Manuscript in preparation]. Department of Statistics and Actuarial Sciences, Simon Fraser University.&quot;. The asymptotic models are derived and described in: &quot;Parker, M.R.P., Elliott, L., Cowen, L.L.E., Cao, J. (2022). Fast asymptotic solutions for N-mixtures on large populations [Manuscript in preparation]. Department of Statistics and Actuarial Sciences, Simon Fraser University.&quot;.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Matthew RP Parker <a href="mailto:mrparker909@gmail.com">mrparker909@gmail.com</a> (<a href="https://orcid.org/0000-0003-3021-7959">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Lloyd Elliott <a href="mailto:lloyd_elliott@sfu.ca">lloyd_elliott@sfu.ca</a> (<a href="https://orcid.org/0000-0003-2187-7314">ORCID</a>)
</p>
</li>
<li><p> Laura LE Cowen <a href="mailto:lcowen@uvic.ca">lcowen@uvic.ca</a> (<a href="https://orcid.org/0000-0002-0853-1450">ORCID</a>)
</p>
</li>
<li><p> Jiguo Cao <a href="mailto:jiguo_cao@sfu.ca">jiguo_cao@sfu.ca</a> (<a href="https://orcid.org/0000-0001-7417-6330">ORCID</a>)
</p>
</li></ul>


</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
