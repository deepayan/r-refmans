<!DOCTYPE html><html><head><title>Help for package BinOrdNonNor</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {BinOrdNonNor}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#BinOrdNonNor-package'>
<p>Concurrent generation of binary, ordinal and continuous data</p></a></li>
<li><a href='#cmat.star.BinOrdNN'><p>Computes the intermediate correlation matrix</p></a></li>
<li><a href='#Fleishman.coef.NN'><p>Computes the Fleishman coefficients for each continuous variable</p></a></li>
<li><a href='#genBinOrdNN'><p>Generates a data set with binary, ordinal and continuous variables</p></a></li>
<li><a href='#IntermediateNonNor'><p>Computes the intermediate correlations for all continuous pairs</p></a></li>
<li><a href='#IntermediateONN'><p>Computes the intermediate (biserial/polyserial) correlations given the point-biserial/polyserial correlations for binary/ordinal-continuous pairs prior to dichotomization/ordinalization</p></a></li>
<li><a href='#LimitforNN'><p>Finds the feasible correlation range for a pair of continuous variables</p></a></li>
<li><a href='#LimitforONN'><p>Finds the feasible correlation range for a pair of binary/ordinal and continuous variables</p></a></li>
<li><a href='#valid.limits.BinOrdNN'><p>Computes the lower and upper bounds of correlation in the form of two matrices</p></a></li>
<li><a href='#validate.target.cormat.BinOrdNN'><p>Checks the validity of the target correlation matrix</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Concurrent Generation of Binary, Ordinal and Continuous Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.5.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-03-21</td>
</tr>
<tr>
<td>Author:</td>
<td>Hakan Demirtas, Yue Wang, Rawan Allozi, Ran Gao</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ran Gao &lt;rgao8@uic.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Generation of samples from a mix of binary, ordinal and continuous random variables with a pre-specified correlation matrix and marginal distributions. The details of the method are explained in Demirtas et al. (2012) &lt;<a href="https://doi.org/10.1002%2Fsim.5362">doi:10.1002/sim.5362</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>GenOrd, OrdNor</td>
</tr>
<tr>
<td>Imports:</td>
<td>BB, corpcor, Matrix, mvtnorm</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-03-21 22:18:40 UTC; rangao</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-03-21 22:50:10 UTC</td>
</tr>
</table>
<hr>
<h2 id='BinOrdNonNor-package'>
Concurrent generation of binary, ordinal and continuous data 
</h2><span id='topic+BinOrdNonNor-package'></span><span id='topic+BinOrdNonNor'></span>

<h3>Description</h3>

<p>This package implements a procedure for generating samples from a mix of binary, ordinal and continuous random variables with a pre-specified correlation matrix and marginal distributions based on the methodology proposed by Demirtas et al. (2012) and its extensions.
</p>
<p>This package consists of nine functions. The function <code><a href="#topic+Fleishman.coef.NN">Fleishman.coef.NN</a></code> computes the Fleishman coefficients for each continuous variable with pre-specified skewness and kurtosis values. The functions <code><a href="#topic+LimitforNN">LimitforNN</a></code> and <code><a href="#topic+LimitforONN">LimitforONN</a></code> return the lower and upper correlation bounds of a pairwise correlation between two continuous variables, and between a binary/ordinal variable and a continuous variable, respectively. The function <code><a href="#topic+valid.limits.BinOrdNN">valid.limits.BinOrdNN</a></code> computes the lower and upper bounds for the correlation entries based on the marginal distributions of the variables. The function <code><a href="#topic+validate.target.cormat.BinOrdNN">validate.target.cormat.BinOrdNN</a></code> checks the validity of the values of pairwise correlations. The function <code><a href="#topic+IntermediateNonNor">IntermediateNonNor</a></code> and <code><a href="#topic+IntermediateONN">IntermediateONN</a></code> compute the intermediate correlations for continuous pairs, and binary/ordinal-continuous pairs, respectively. The function <code><a href="#topic+cmat.star.BinOrdNN">cmat.star.BinOrdNN</a></code> assembles the intermediate correlation matrix. The engine function <code><a href="#topic+genBinOrdNN">genBinOrdNN</a></code> generates mixed data in accordance with a given correlation matrix and marginal distributions.
</p>
<p>The key packages and functions that we call in this package include <code>GenOrd</code>, <code>OrdNor</code>, <code>BBsolve</code>, <code>rmvnorm</code>, and <code>nearPD</code>. 
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> BinOrdNonNor</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.5.2</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2021-03-21</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2 | GPL-3</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>


<h3>Author(s)</h3>

<p>Hakan Demirtas, Yue Wang, Rawan Allozi, Ran Gao
</p>
<p>Maintainer: Ran Gao &lt;rgao8@uic.edu&gt;
</p>


<h3>References</h3>

<p>Demirtas, H. and Hedeker, D. (2011). A practical way for computing approximate lower and upper correlation bounds. The American Statistician, 65(2), 104-109.
</p>
<p>Demirtas, H. and Hedeker, D. (2016). Computing the point-biserial correlation under any underlying continuous distribution. Communications in Statistics - Simulation and Computation, 45(8), 2744-2751.
</p>
<p>Demirtas, H., Hedeker, D., and Mermelstein, R.J. (2012). Simulation of massive public health data by power polynomials. Statistics in Medicine, 31(27), 3337-3346.
</p>
<p>Demirtas, H. and Yavuz Y. (2015). Concurrent generation of ordinal and normal data. Journal of Biopharmaceutical Statistics, 25(4), 635-650.
</p>
<p>Fleishman, A.I. (1978). A method for simulating non-normal distributions. Psychometrika, 43(4), 521-532.
</p>
<p>Vale, C.D., and Maurelli, V.A. (1983). Simulating multivariate nonnormal distributions. Psychometrika, 48(3), 465-471.
</p>

<hr>
<h2 id='cmat.star.BinOrdNN'>Computes the intermediate correlation matrix
</h2><span id='topic+cmat.star.BinOrdNN'></span>

<h3>Description</h3>

<p>The function computes the correlations of intermediate multivariate normal data prior to subsequent dichotomization (for binary variables), ordinalization (for ordinal variables), and transformation (for continuous variables)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cmat.star.BinOrdNN(plist, skew.vec, kurto.vec, no.bin, no.ord, no.NN, CorrMat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cmat.star.BinOrdNN_+3A_plist">plist</code></td>
<td>
<p>A list of probability vectors corresponding to each binary/ordinal variable. The i-th element of <code>plist</code> is a vector of the cumulative probabilities defining the marginal distribution of the i-th component of the multivariate variables, which is binary/ordinal. If the i-th variable is binary, the i-th vector of <code>plist</code> will contain 1 probability value. If the i-th variable is ordinal with k categories (k &gt; 2), the i-th vector of <code>plist</code> will contain (k-1) probability values. The k-th element is implicitly 1.</p>
</td></tr>
<tr><td><code id="cmat.star.BinOrdNN_+3A_skew.vec">skew.vec</code></td>
<td>
<p>The skewness vector for continuous variables.</p>
</td></tr>
<tr><td><code id="cmat.star.BinOrdNN_+3A_kurto.vec">kurto.vec</code></td>
<td>
<p>The kurtosis vector for continuous variables.</p>
</td></tr>
<tr><td><code id="cmat.star.BinOrdNN_+3A_no.bin">no.bin</code></td>
<td>
<p>Number of binary variables.</p>
</td></tr>
<tr><td><code id="cmat.star.BinOrdNN_+3A_no.ord">no.ord</code></td>
<td>
<p>Number of ordinal variables.</p>
</td></tr>
<tr><td><code id="cmat.star.BinOrdNN_+3A_no.nn">no.NN</code></td>
<td>
<p>Number of continuous variables.</p>
</td></tr>
<tr><td><code id="cmat.star.BinOrdNN_+3A_corrmat">CorrMat</code></td>
<td>
<p>The target correlation matrix which must be positive definite and within the valid limits.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An intermediate correlation of size <code>(no.bin + no.ord + no.NN)*(no.bin + no.ord + no.NN)</code></p>


<h3>See Also</h3>

<p><code><a href="#topic+validate.target.cormat.BinOrdNN">validate.target.cormat.BinOrdNN</a></code>, <code><a href="#topic+IntermediateNonNor">IntermediateNonNor</a></code>, <code><a href="#topic+IntermediateONN">IntermediateONN</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:
no.bin &lt;- 1
no.ord &lt;- 2
no.NN &lt;- 4
q &lt;- no.bin + no.ord + no.NN
set.seed(54321)

Sigma &lt;- diag(q)
Sigma[lower.tri(Sigma)] &lt;- runif((q*(q-1)/2),-0.4,0.4)
Sigma &lt;- Sigma + t(Sigma)
diag(Sigma) &lt;- 1

marginal &lt;- list(0.3, cumsum(c(0.30, 0.40) ), cumsum(c(0.4, 0.2, 0.3) ) )
cmat.star &lt;- cmat.star.BinOrdNN(plist=marginal, skew.vec=c(1,2,2,3), 
kurto.vec=c(2,7,25,25),no.bin=1, no.ord=2, no.NN=4, CorrMat=Sigma) 
## End(Not run)
</code></pre>

<hr>
<h2 id='Fleishman.coef.NN'>Computes the Fleishman coefficients for each continuous variable</h2><span id='topic+Fleishman.coef.NN'></span>

<h3>Description</h3>

<p>The function checks whether the skewness and kurtosis parameters violates the universal equality given in Demirtas, Hedeker, Mermelstein (2012) and computes the Fleishman coefficients for each continuous variable with pre-specified skewness and kurtosis values by solving the Fleishman's polynomial equations using <code>BBsolve</code> function in <code>BB</code> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Fleishman.coef.NN(skew.vec, kurto.vec)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Fleishman.coef.NN_+3A_skew.vec">skew.vec</code></td>
<td>
<p>The skewness vector for continuous variables.</p>
</td></tr>
<tr><td><code id="Fleishman.coef.NN_+3A_kurto.vec">kurto.vec</code></td>
<td>
<p>The kurtosis vector for continuous variables.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An matrix with four columns corresponding to the four Fleishman coefficients, and number of rows corresponding to number of continuous variables. The i-th row contains the estimates of the four Fleishman coefficients a, b, c and d for the i-th continuous variable with i-th pre-specified skewness and kurtosis values.</p>


<h3>References</h3>

<p>Demirtas, H., Hedeker, D., and Mermelstein, R.J. (2012). Simulation of massive public health data by power polynomials. Statistics in Medicine, 31(27), 3337-3346.
</p>
<p>Fleishman, A.I. (1978). A method for simulating non-normal distributions. Psychometrika, 43(4), 521-532.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Consider four continuous variables, which come from
# Exp(1),Beta(4,4),Beta(4,2) and Gamma(10,10), respectively.
# Skewness and kurtosis values of these variables are as follows:

skew.vec &lt;- c(2,0,-0.4677,0.6325)
kurto.vec &lt;- c(6,-0.5455,-0.3750,0.6)
coef.est &lt;- Fleishman.coef.NN(skew.vec, kurto.vec)
</code></pre>

<hr>
<h2 id='genBinOrdNN'>Generates a data set with binary, ordinal and continuous variables
</h2><span id='topic+genBinOrdNN'></span>

<h3>Description</h3>

<p>The function simulates a sample of size <code>n</code> from a multivariate binary, ordinal and continuous variables with intermediate correlation matrix <code>cmat.star</code>, and pre-specified marginal distributions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>genBinOrdNN(n, plist, mean.vec, var.vec, skew.vec, kurto.vec, no.bin, no.ord, 
no.NN, cmat.star)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="genBinOrdNN_+3A_n">n</code></td>
<td>
<p>Number of rows.</p>
</td></tr>
<tr><td><code id="genBinOrdNN_+3A_plist">plist</code></td>
<td>
<p>A list of probability vectors corresponding to each binary/ordinal variable. The i-th element of <code>plist</code> is a vector of the cumulative probabilities defining the marginal distribution of the i-th component of the multivariate variables, which is binary/ordinal. If the i-th variable is binary, the i-th vector of <code>plist</code> will contain 1 probability value. If the i-th variable is ordinal with k categories (k &gt; 2), the i-th vector of <code>plist</code> will contain (k-1) probability values. The k-th element is implicitly 1.</p>
</td></tr>
<tr><td><code id="genBinOrdNN_+3A_mean.vec">mean.vec</code></td>
<td>
<p>Mean vector for continuous variables.</p>
</td></tr>
<tr><td><code id="genBinOrdNN_+3A_var.vec">var.vec</code></td>
<td>
<p>Variance vector for continuous variables</p>
</td></tr>
<tr><td><code id="genBinOrdNN_+3A_skew.vec">skew.vec</code></td>
<td>
<p>The skewness vector for continuous variables.</p>
</td></tr>
<tr><td><code id="genBinOrdNN_+3A_kurto.vec">kurto.vec</code></td>
<td>
<p>The kurtosis vector for continuous variables.</p>
</td></tr>
<tr><td><code id="genBinOrdNN_+3A_no.bin">no.bin</code></td>
<td>
<p>Number of binary variables.</p>
</td></tr>
<tr><td><code id="genBinOrdNN_+3A_no.ord">no.ord</code></td>
<td>
<p>Number of ordinal variables.</p>
</td></tr>
<tr><td><code id="genBinOrdNN_+3A_no.nn">no.NN</code></td>
<td>
<p>Number of continuous variables.</p>
</td></tr>
<tr><td><code id="genBinOrdNN_+3A_cmat.star">cmat.star</code></td>
<td>
<p>The intermediate correlation matrix obtained from <code><a href="#topic+cmat.star.BinOrdNN">cmat.star.BinOrdNN</a></code> function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of size <code>n*(no.bin + no.ord + no.NN)</code>, of which the first <code>no.bin</code> columns are binary variables, the next <code>no.ord</code> columns are ordinal variables, and the last <code>no.NN</code> columns are continuous variables.</p>


<h3>References</h3>

<p>Demirtas, H., Hedeker, D., and Mermelstein, R.J. (2012). Simulation of massive public health data by power polynomials. Statistics in Medicine, 31(27), 3337-3346.
</p>
<p>Demirtas, H. and Yavuz Y. (2015). Concurrent generation of ordinal and normal data. Journal of Biopharmaceutical Statistics, 25(4), 635-650.
</p>
<p>Vale, C.D., and Maurelli, V.A. (1983). Simulating multivariate nonnormal distributions. Psychometrika, 48(3), 465-471.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cmat.star.BinOrdNN">cmat.star.BinOrdNN</a></code>, <code><a href="#topic+Fleishman.coef.NN">Fleishman.coef.NN</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:
set.seed(54321)
no.bin &lt;- 1
no.ord &lt;- 1
no.NN &lt;- 4
q &lt;- no.bin + no.ord + no.NN

marginal &lt;- list(0.4, cumsum(c(0.4, 0.2, 0.3)))

skewness.vec &lt;- c(2,0,-0.4677,0.6325)
kurtosis.vec &lt;- c(6,-0.5455,-0.3750,0.6)

corr.mat &lt;- matrix(c(1.0,-0.3,-0.3,-0.3,-0.3,-0.3,
                    -0.3, 1.0,-0.3,-0.3,-0.3,-0.3,
                    -0.3,-0.3, 1.0, 0.4, 0.5, 0.6,
                    -0.3,-0.3, 0.4, 1.0, 0.7, 0.8,
                    -0.3,-0.3, 0.5, 0.7, 1.0, 0.9,
                    -0.3,-0.3, 0.6, 0.8, 0.9, 1.0),
                    q,byrow=TRUE)

corr.mat.star &lt;- cmat.star.BinOrdNN(plist=marginal, skew.vec=skewness.vec, 
kurto.vec=kurtosis.vec, no.bin=1, no.ord=1, no.NN=4, CorrMat=corr.mat)

sim.data &lt;- genBinOrdNN(n=100000, plist=marginal, mean.vec=c(2,3,4,5), 
var.vec=c(3,5,10,20), skew.vec=skewness.vec, kurto.vec=kurtosis.vec,
no.bin=1, no.ord=1, no.NN=4, cmat.star=corr.mat.star) 

## End(Not run)
</code></pre>

<hr>
<h2 id='IntermediateNonNor'>Computes the intermediate correlations for all continuous pairs</h2><span id='topic+IntermediateNonNor'></span>

<h3>Description</h3>

<p>The function computes the intermediate correlation values of pairwise correlations between continuous variables.</p>


<h3>Usage</h3>

<pre><code class='language-R'>IntermediateNonNor(skew.vec, kurto.vec, cormat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="IntermediateNonNor_+3A_skew.vec">skew.vec</code></td>
<td>
<p>The skewness vector for continuous variables.</p>
</td></tr>
<tr><td><code id="IntermediateNonNor_+3A_kurto.vec">kurto.vec</code></td>
<td>
<p>The kurtosis vector for continuous variables.</p>
</td></tr>
<tr><td><code id="IntermediateNonNor_+3A_cormat">cormat</code></td>
<td>
<p>A matrix of pairwise target correlation between continuous variables. It is a symmetric square matrix with diagonal elements being 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A pairwise correlation matrix of intermediate correlation for continuous variables.
</p>


<h3>References</h3>

<p>Demirtas, H., Hedeker, D., and Mermelstein, R.J. (2012). Simulation of massive public health data by power polynomials. Statistics in Medicine, 31(27), 3337-3346.
</p>
<p>Vale, C.D., and Maurelli, V.A.(1983). Simulating multivariate nonnormal distributions. Psychometrika, 48(3), 465-471.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+IntermediateONN">IntermediateONN</a></code>, <code><a href="#topic+cmat.star.BinOrdNN">cmat.star.BinOrdNN</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>IntermediateNonNor(skew.vec=c(1,2), kurto.vec=c(2, 7), 
                   cormat=matrix(c(1,-0.47,-0.47,1),2,2))
</code></pre>

<hr>
<h2 id='IntermediateONN'>Computes the intermediate (biserial/polyserial) correlations given the point-biserial/polyserial correlations for binary/ordinal-continuous pairs prior to dichotomization/ordinalization</h2><span id='topic+IntermediateONN'></span>

<h3>Description</h3>

<p>This function computes the intermediate correlation values of pairwise correlations between binary/ordinal and continuous variables.</p>


<h3>Usage</h3>

<pre><code class='language-R'>IntermediateONN(plist, skew.vec, kurto.vec, ONNCorrMat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="IntermediateONN_+3A_plist">plist</code></td>
<td>
<p>A list of probability vectors corresponding to each binary/ordinal variable. The i-th element of <code>plist</code> is a vector of the cumulative probabilities defining the marginal distribution of the i-th component of the multivariate variables, which is binary/ordinal. If the i-th variable is binary, the i-th vector of <code>plist</code> will contain 1 probability value. If the i-th variable is ordinal with k categories (k &gt; 2), the i-th vector of <code>plist</code> will contain (k-1) probability values. The k-th element is implicitly 1.</p>
</td></tr>
<tr><td><code id="IntermediateONN_+3A_skew.vec">skew.vec</code></td>
<td>
<p>The skewness vector for continuous variables.</p>
</td></tr>
<tr><td><code id="IntermediateONN_+3A_kurto.vec">kurto.vec</code></td>
<td>
<p>The kurtosis vector for continuous variables.</p>
</td></tr>
<tr><td><code id="IntermediateONN_+3A_onncorrmat">ONNCorrMat</code></td>
<td>
<p>A matrix of pairwise target (point-biserial/polyserial) correlations between binary/ordinal and continuous variables. This is a submatrix of the overall correlation matrix, and it is pertinent to the binary/ordinal-continuous part. Hence, the matrix may or may not be square. Even when it is square, it may not be symmetric.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A pairwise correlation matrix of intermediate correlations, where rows and columns represent continuous and binary/ordinal variables, respectively.</p>


<h3>References</h3>

<p>Demirtas, H., Hedeker, D., and Mermelstein, R.J. (2012). Simulation of massive public health data by power polynomials. Statistics in Medicine, 31(27), 3337-3346.
</p>
<p>Demirtas, H. and Hedeker, D. (2016). Computing the point-biserial correlation under any underlying continuous distribution. Communications in Statistics - Simulation and Computation, 45(8), 2744-2751.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+IntermediateNonNor">IntermediateNonNor</a></code>, <code><a href="#topic+cmat.star.BinOrdNN">cmat.star.BinOrdNN</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>no.bin &lt;- 1
no.ord &lt;- 2
no.NN &lt;- 4
q &lt;- no.bin + no.ord + no.NN
set.seed(54321)

Sigma &lt;- diag(q)
Sigma[lower.tri(Sigma)] &lt;- runif((q*(q-1)/2),-0.4,0.4)
Sigma &lt;- Sigma + t(Sigma)
diag(Sigma) &lt;- 1

marginal &lt;- list(0.3, cumsum( c(0.30, 0.40) ), cumsum(c(0.4, 0.2, 0.3) ) )
ONNCorrMat &lt;- Sigma[4:7, 1:3]
IntermediateONN(marginal, skew.vec=c(1,2,2,3), kurto.vec=c(2,7,25,25), ONNCorrMat)
</code></pre>

<hr>
<h2 id='LimitforNN'>Finds the feasible correlation range for a pair of continuous variables</h2><span id='topic+LimitforNN'></span><span id='topic+Limit_forNN'></span>

<h3>Description</h3>

<p>The function computes the lower and upper correlation bounds of a pairwise correlation between two continuous variables using generate, sort, and correlate (GSC) algorithm in Demirtas and Hedeker (2011).</p>


<h3>Usage</h3>

<pre><code class='language-R'>LimitforNN(skew.vec, kurto.vec)
Limit_forNN(skew.vec, kurto.vec) #Deprecated
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LimitforNN_+3A_skew.vec">skew.vec</code></td>
<td>
<p>The skewness vector for continuous variables.</p>
</td></tr>
<tr><td><code id="LimitforNN_+3A_kurto.vec">kurto.vec</code></td>
<td>
<p>The kurtosis vector for continuous variables.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of two elements. The first element is the lower bound and the second element is the upper bound.</p>


<h3>References</h3>

<p>Demirtas, H., Hedeker, D. (2011). A practical way for computing approximate lower and upper correlation bounds. The American Statistician, 65(2), 104-109.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Fleishman.coef.NN">Fleishman.coef.NN</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>LimitforNN(skew.vec=c(1,2),kurto.vec=c(2,7))
</code></pre>

<hr>
<h2 id='LimitforONN'>Finds the feasible correlation range for a pair of binary/ordinal and continuous variables</h2><span id='topic+LimitforONN'></span><span id='topic+Limit_forONN'></span>

<h3>Description</h3>

<p>The function computes the lower and upper correlation bounds of a pairwise correlation between a binary/ordinal variable and a continuous variable using GSC algorithm in Demirtas and Hedeker (2011).</p>


<h3>Usage</h3>

<pre><code class='language-R'>LimitforONN(pvec1, skew1, kurto1)
Limit_forONN(pvec1, skew1, kurto1) #Deprecated
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LimitforONN_+3A_pvec1">pvec1</code></td>
<td>
<p>A vector of the cumulative probabilities defining the marginal distribution for the binary/ordinal variable of the pair. If the variable is binary, the probability vector will contain only 1 probability value. If the variable is ordinal with k categories (k &gt; 2), the probability vector will contain (k-1) values. The k-th element is implicitly 1. </p>
</td></tr>
<tr><td><code id="LimitforONN_+3A_skew1">skew1</code></td>
<td>
<p>The skewness value for continuous variable of the pair.</p>
</td></tr>
<tr><td><code id="LimitforONN_+3A_kurto1">kurto1</code></td>
<td>
<p>The kurtosis value for continuous variable of the pair.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of two elements. The first element is the lower correlation bound and the second element is the upper correlation bound.</p>


<h3>References</h3>

<p>Demirtas, H., Hedeker, D. (2011). A practical way for computing approximate lower and upper correlation bounds. The American Statistician, 65(2), 104-109.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Fleishman.coef.NN">Fleishman.coef.NN</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>LimitforONN(pvec1=c(0.2, 0.5), skew1=1, kurto1=2)
</code></pre>

<hr>
<h2 id='valid.limits.BinOrdNN'>Computes the lower and upper bounds of correlation in the form of two matrices
</h2><span id='topic+valid.limits.BinOrdNN'></span>

<h3>Description</h3>

<p>The function computes the lower and upper bounds for the correlation entries based on the marginal distributions of the variables.</p>


<h3>Usage</h3>

<pre><code class='language-R'>valid.limits.BinOrdNN(plist, skew.vec, kurto.vec, no.bin, no.ord, no.NN)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="valid.limits.BinOrdNN_+3A_plist">plist</code></td>
<td>
<p>A list of probability vectors corresponding to each binary/ordinal variable. The i-th element of <code>plist</code> is a vector of the cumulative probabilities defining the marginal distribution of the i-th component of the multivariate variables, which is binary/ordinal. If the i-th variable is binary, the i-th vector of <code>plist</code> will contain 1 probability value. If the i-th variable is ordinal with k categories (k &gt; 2), the i-th vector of <code>plist</code> will contain (k-1) probability values. The k-th element is implicitly 1.</p>
</td></tr>
<tr><td><code id="valid.limits.BinOrdNN_+3A_skew.vec">skew.vec</code></td>
<td>
<p>The skewness vector for continuous variables.</p>
</td></tr>
<tr><td><code id="valid.limits.BinOrdNN_+3A_kurto.vec">kurto.vec</code></td>
<td>
<p>The kurtosis vector for continuous variables.</p>
</td></tr>
<tr><td><code id="valid.limits.BinOrdNN_+3A_no.bin">no.bin</code></td>
<td>
<p>Number of binary variables.</p>
</td></tr>
<tr><td><code id="valid.limits.BinOrdNN_+3A_no.ord">no.ord</code></td>
<td>
<p>Number of ordinal variables.</p>
</td></tr>
<tr><td><code id="valid.limits.BinOrdNN_+3A_no.nn">no.NN</code></td>
<td>
<p>Number of continuous variables.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of two matrices. The one named lower contains the lower bounds and the other named upper contains the upper bounds of the feasible correlations.</p>


<h3>See Also</h3>

<p><code><a href="#topic+LimitforNN">LimitforNN</a></code>, <code><a href="#topic+LimitforONN">LimitforONN</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>marginal &lt;- list(0.2, c(0.4, 0.7, 0.9))
valid.limits.BinOrdNN(plist=marginal, skew.vec=c(1,2), kurto.vec=c(2,7), 
                      no.bin=1, no.ord=1, no.NN=2)
</code></pre>

<hr>
<h2 id='validate.target.cormat.BinOrdNN'>Checks the validity of the target correlation matrix
</h2><span id='topic+validate.target.cormat.BinOrdNN'></span>

<h3>Description</h3>

<p>The function checks the validity of pairwise correlations. In addition, it checks positive definiteness, symmetry, and correct dimensions.</p>


<h3>Usage</h3>

<pre><code class='language-R'>validate.target.cormat.BinOrdNN(plist, skew.vec, kurto.vec, no.bin, no.ord, 
no.NN, CorrMat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="validate.target.cormat.BinOrdNN_+3A_plist">plist</code></td>
<td>
<p>A list of probability vectors corresponding to each binary/ordinal variable. The i-th element of <code>plist</code> is a vector of the cumulative probabilities defining the marginal distribution of the i-th component of the multivariate variables, which is binary/ordinal. If the i-th variable is binary, the i-th vector of <code>plist</code> will contain 1 probability value. If the i-th variable is ordinal with k categories (k &gt; 2), the i-th vector of <code>plist</code> will contain (k-1) probability values. The k-th element is implicitly 1.</p>
</td></tr>
<tr><td><code id="validate.target.cormat.BinOrdNN_+3A_skew.vec">skew.vec</code></td>
<td>
<p>The skewness vector for continuous variables.</p>
</td></tr>
<tr><td><code id="validate.target.cormat.BinOrdNN_+3A_kurto.vec">kurto.vec</code></td>
<td>
<p>The kurtosis vector for continuous variables.</p>
</td></tr>
<tr><td><code id="validate.target.cormat.BinOrdNN_+3A_no.bin">no.bin</code></td>
<td>
<p>Number of binary variables.</p>
</td></tr>
<tr><td><code id="validate.target.cormat.BinOrdNN_+3A_no.ord">no.ord</code></td>
<td>
<p>Number of ordinal variables.</p>
</td></tr>
<tr><td><code id="validate.target.cormat.BinOrdNN_+3A_no.nn">no.NN</code></td>
<td>
<p>Number of continuous variables.</p>
</td></tr>
<tr><td><code id="validate.target.cormat.BinOrdNN_+3A_corrmat">CorrMat</code></td>
<td>
<p>The target correlation matrix which must be positive definite and within the valid limits.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>In addition to being positive definite and symmetric, the values of pairwise correlations in the target correlation matrix must also fall within the limits imposed by the marginal distributions of the variables. The function ensures that the supplied correlation matrix is valid for simulation. If a violation occurs, an error message is displayed that identifies the violation. The function returns a logical value <code>TRUE</code> when no such violation occurs.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+valid.limits.BinOrdNN">valid.limits.BinOrdNN</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>Sigma &lt;- diag(4)
Sigma[lower.tri(Sigma)] &lt;- c(0.42, 0.55, 0.29, 0.37, 0.14, 0.26)
Sigma &lt;- Sigma + t(Sigma)
diag(Sigma) &lt;- 1

marginal &lt;- list(0.2, c(0.4, 0.7, 0.9))

validate.target.cormat.BinOrdNN(plist=marginal, skew.vec=c(1,2), kurto.vec=c(2,7), 
                                no.bin=1, no.ord=1, no.NN=2, CorrMat=Sigma)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
