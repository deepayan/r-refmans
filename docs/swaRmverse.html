<!DOCTYPE html><html><head><title>Help for package swaRmverse</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {swaRmverse}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#swaRmverse'><p>swaRmverse: Swarm Space Creation</p></a></li>
<li><a href='#add_rel_pos_coords'><p>Relative Position Coordinates</p></a></li>
<li><a href='#add_set_vels'><p>Add Velocity Timeseries</p></a></li>
<li><a href='#add_velocities'><p>Add Velocity Timeseries Across Sets</p></a></li>
<li><a href='#calc_dur_per_event'><p>Duration of Each Event</p></a></li>
<li><a href='#calc_events_averages'><p>Events Averages</p></a></li>
<li><a href='#calc_global_metrics'><p>Calculation of Group Metrics</p></a></li>
<li><a href='#calc_n_events'><p>Number of Events (Internal)</p></a></li>
<li><a href='#calc_nn_metrics'><p>Relative Position of Nearest Neighbor Function to Parallelize</p></a></li>
<li><a href='#calc_obb'><p>Minimum Bounding Box</p></a></li>
<li><a href='#calc_pairwise_metrics'><p>Pairwise Metrics</p></a></li>
<li><a href='#col_motion_metrics'><p>Collective Motion Metrics</p></a></li>
<li><a href='#col_motion_metrics_from_raw'><p>Collective Motion Metrics from Raw Data</p></a></li>
<li><a href='#define_events'><p>Define Events of Collective Motion</p></a></li>
<li><a href='#do_add_set_vels'><p>Call Add Velocity Timeseries</p></a></li>
<li><a href='#do_add_vels'><p>Adding Velocity Information for Individuals in Parallel without Progress Updates</p></a></li>
<li><a href='#do_pca'><p>Perform PCA</p></a></li>
<li><a href='#do_tsne'><p>Performs t-SNE</p></a></li>
<li><a href='#event_ids_per_set'><p>Event Indexes per Set</p></a></li>
<li><a href='#event_metrics'><p>Metrics of Collective Motion</p></a></li>
<li><a href='#events_dur'><p>Total Duration of All Events</p></a></li>
<li><a href='#events_n'><p>Number of Events</p></a></li>
<li><a href='#events_summary'><p>Events Summary</p></a></li>
<li><a href='#expand_pca_swarm_space'><p>Expand Existing Swarm Space (PCA)</p></a></li>
<li><a href='#frontness'><p>Frontness</p></a></li>
<li><a href='#get_event_ids'><p>Event Indexes</p></a></li>
<li><a href='#group_metrics'><p>Group Metrics of Collective Motion</p></a></li>
<li><a href='#group_metrics_per_set'><p>Group Metrics of Collective Motion in a Dataset</p></a></li>
<li><a href='#group_shape'><p>Group Shape Based on a OOBB</p></a></li>
<li><a href='#moving_average'><p>Moving Average</p></a></li>
<li><a href='#multi_species_metrics'><p>Multi-Species Collective Motion Metrics</p></a></li>
<li><a href='#multi_species_pca'><p>Multi-Species PCA</p></a></li>
<li><a href='#multi_species_pca_data'><p>Multi-Species PCA Data</p></a></li>
<li><a href='#new_species_metrics'><p>The Collective Motion Metrics of a New Species</p></a></li>
<li><a href='#nn_metrics'><p>Nearest Neighbour Metrics</p></a></li>
<li><a href='#nnba'><p>Bearing Angle to Nearest Neighbor</p></a></li>
<li><a href='#normalize_data'><p>Normalize Data</p></a></li>
<li><a href='#pairwise_metrics'><p>Pairwise Metrics of Collective Motion in a Dataset</p></a></li>
<li><a href='#par_calc_global_metrics'><p>Calculation of Group Metrics in Parallel</p></a></li>
<li><a href='#par_nn_metrics'><p>Adding Motion Properties in Parallel - Verbose</p></a></li>
<li><a href='#parAddVels'><p>Adding Motion Properties in Parallel without Progress Updates</p></a></li>
<li><a href='#parAddVelsVerb'><p>Adding Individual Velocity Information in Parallel - Verbose</p></a></li>
<li><a href='#perIdVels'><p>Speed and Heading Calculation based on <code>swaRm</code> Package.</p></a></li>
<li><a href='#pick_threshold'><p>Pick a Threshold for the Events' Definition</p></a></li>
<li><a href='#set_data_format'><p>Data Formatting</p></a></li>
<li><a href='#swarm_space'><p>Create a Swarm Space</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Swarm Space Creation</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-02-29</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Marina Papadopoulou &lt;m.papadopoulou.rug@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides a pipeline for the comparative analysis of 
  collective movement data (e.g. fish schools, bird flocks, baboon troops) by 
  processing 2-dimensional positional data (x,y,t) from GPS trackers or computer
  vision tracking systems, discretizing events of collective motion, calculating
  a set of established metrics that characterize each event, and placing the
  events in a multi-dimensional swarm space constructed from these metrics.
  The swarm space concept, the metrics and data sets included are described in:
  Papadopoulou Marina, Furtbauer Ines, O'Bryan Lisa R., Garnier Simon, 
  Georgopoulou Dimitra G., Bracken Anna M., Christensen Charlotte and King
  Andrew J. (2023) &lt;<a href="https://doi.org/10.1098%2Frstb.2022.0068">doi:10.1098/rstb.2022.0068</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://marinapapa.github.io/swaRmverse/">https://marinapapa.github.io/swaRmverse/</a>,
<a href="https://github.com/marinapapa/swaRmverse">https://github.com/marinapapa/swaRmverse</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/marinapapa/swaRmverse/issues">https://github.com/marinapapa/swaRmverse/issues</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5)</td>
</tr>
<tr>
<td>Imports:</td>
<td>parallel, pbapply, Rtsne, trackdf, swaRm, geosphere</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, ggplot2, testthat (&ge; 3.0.0), covr</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-26 11:17:18 UTC; 2GSWARM</td>
</tr>
<tr>
<td>Author:</td>
<td>Marina Papadopoulou
    <a href="https://orcid.org/0000-0002-6478-8365"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  Simon Garnier <a href="https://orcid.org/0000-0002-3886-3974"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb, cph]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-26 17:00:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='swaRmverse'>swaRmverse: Swarm Space Creation</h2><span id='topic+swaRmverse-package'></span><span id='topic+swaRmverse'></span>

<h3>Description</h3>

<p>The <code>swaRmverse</code> package provides a pipeline for the comparative
analysis of collective movement data (e.g. fish schools, bird flocks, baboon
troops) by processing 2-dimensional positional data (x,y,t) from GPS
trackers or computer vision tracking systems, discretizing events of
collective motion, calculating a set of established metrics that characterize
each event, and placing the events in a multi-dimensional 'swarm space'
constructed from these metrics.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
 Package: </td><td style="text-align: left;"> swaRmverse</td>
</tr>
<tr>
 <td style="text-align: left;">
 Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
 Version: </td><td style="text-align: left;"> 0.1.0</td>
</tr>
<tr>
 <td style="text-align: left;">
 Date: </td><td style="text-align: left;"> 2024-02-29</td>
</tr>
<tr>
 <td style="text-align: left;">
 License: </td><td style="text-align: left;"> GPL-3</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Marina Papadopoulou &lt;m.papadopoulou.rug@gmail.com&gt;
</p>
<p>Simon Garnier &lt;garnier@njit.edu&gt;
</p>
<p>Maintainer: Marina Papadopoulou &lt;m.papadopoulou.rug@gmail.com&gt;
</p>


<h3>References</h3>

<p>Papadopoulou Marina, FÃ¼rtbauer Ines, O'Bryan Lisa R., Garnier Simon,
Georgopoulou Dimitra G., Bracken Anna M., Christensen Charlotte and King
Andrew J. 2023. Dynamics of collective motion across time and species. Phil.
Trans. R. Soc. B 378: 20220068. http://doi.org/10.1098/rstb.2022.0068
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://marinapapa.github.io/swaRmverse/">https://marinapapa.github.io/swaRmverse/</a>
</p>
</li>
<li> <p><a href="https://github.com/marinapapa/swaRmverse">https://github.com/marinapapa/swaRmverse</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/marinapapa/swaRmverse/issues">https://github.com/marinapapa/swaRmverse/issues</a>
</p>
</li></ul>


<hr>
<h2 id='add_rel_pos_coords'>Relative Position Coordinates</h2><span id='topic+add_rel_pos_coords'></span>

<h3>Description</h3>

<p>This function calculates the x and y coordinates of a neighbor
in the reference frame of the focal individual.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_rel_pos_coords(data, focal_heading = c(0, 1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_rel_pos_coords_+3A_data">data</code></td>
<td>
<p>Dataframe with the bearing angle and
distance of each individual to specific neighbors.
Column names must include: bangl, nnd.</p>
</td></tr>
<tr><td><code id="add_rel_pos_coords_+3A_focal_heading">focal_heading</code></td>
<td>
<p>The heading of the focal individual,
default = c(0,1) for plotting neighbor heading north.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The input dataframe with additional <code>nnx</code> (nearest neighbor x coordinate)
and <code>nny</code> (nearest neighbor y coordinate) columns.
</p>


<h3>Author(s)</h3>

<p>Marina Papadopoulou <a href="mailto:m.papadopoulou.rug@gmail.com">m.papadopoulou.rug@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data &lt;- data.frame(
bangl = runif(25, 0, pi),
nnd = runif(25)
)
data &lt;- add_rel_pos_coords(data)

</code></pre>

<hr>
<h2 id='add_set_vels'>Add Velocity Timeseries</h2><span id='topic+add_set_vels'></span>

<h3>Description</h3>

<p>This function calculates the headings and speeds of individuals based on
two location points and the time taken to travel between those points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_set_vels(
  data,
  geo = FALSE,
  verbose = FALSE,
  parallelize = FALSE,
  independent_call = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_set_vels_+3A_data">data</code></td>
<td>
<p>A dataframe with the time series of individuals' positions.
Columns must include: <code>t</code>, <code>id</code>, <code>x</code>, <code>y</code>.</p>
</td></tr>
<tr><td><code id="add_set_vels_+3A_geo">geo</code></td>
<td>
<p>Logical, whether positions are geographic coordinates, default = TRUE.</p>
</td></tr>
<tr><td><code id="add_set_vels_+3A_verbose">verbose</code></td>
<td>
<p>Logical, whether to post updates on progress, default = FALSE.</p>
</td></tr>
<tr><td><code id="add_set_vels_+3A_parallelize">parallelize</code></td>
<td>
<p>Logical, whether to run the function in parallel, default = FALSE.</p>
</td></tr>
<tr><td><code id="add_set_vels_+3A_independent_call">independent_call</code></td>
<td>
<p>Logical, whether the function is called by itself or
as part of the package pipeline (through <code><a href="#topic+add_velocities">add_velocities</a></code>). The default is
set to TRUE, reflecting the direct call of the function by the user.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The input dataframe with a new speed and heading (rotational, in rads) columns.
</p>


<h3>Author(s)</h3>

<p>Marina Papadopoulou <a href="mailto:m.papadopoulou.rug@gmail.com">m.papadopoulou.rug@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+add_velocities">add_velocities</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data &lt;- data.frame(
x = rnorm(25, sd = 3),
y = rnorm(25, sd = 3),
t = as.POSIXct(1:25, origin = Sys.time()),
id = rep(1, 25)
)

data &lt;- add_set_vels(data, geo = FALSE)

</code></pre>

<hr>
<h2 id='add_velocities'>Add Velocity Timeseries Across Sets</h2><span id='topic+add_velocities'></span>

<h3>Description</h3>

<p>This function calculates and adds the speed and heading of each individual
over time in the dataset, and splits it in a list of dataframes based
on the defined sets.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_velocities(data, geo = FALSE, verbose = FALSE, parallelize = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_velocities_+3A_data">data</code></td>
<td>
<p>A data frame with time series of individual's positional data,
as exported by the <code>set_data_format</code> function.
Columns needed: <code>set</code>, <code>t</code>, <code>id</code>, <code>x</code>, <code>y</code>.</p>
</td></tr>
<tr><td><code id="add_velocities_+3A_geo">geo</code></td>
<td>
<p>Logical, whether positions are geographic coordinates,
default = FALSE.</p>
</td></tr>
<tr><td><code id="add_velocities_+3A_verbose">verbose</code></td>
<td>
<p>Logical, whether to post updates on progress, default = FALSE.</p>
</td></tr>
<tr><td><code id="add_velocities_+3A_parallelize">parallelize</code></td>
<td>
<p>Logical, whether to run the function in parallel over individuals,
default = FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of dataframes, an element per set from the input dataframe
with new columns: <code>head</code> and <code>speed</code>.
</p>


<h3>Author(s)</h3>

<p>Marina Papadopoulou <a href="mailto:m.papadopoulou.rug@gmail.com">m.papadopoulou.rug@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+add_set_vels">add_set_vels</a></code>, <code><a href="#topic+set_data_format">set_data_format</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- data.frame(
set = rep(1, 25),
x = rnorm(25, sd = 3),
y = rnorm(25, sd = 3),
t = as.POSIXct(1:25, origin = Sys.time()),
id = rep(1, 25)
)

data_list &lt;- add_velocities(data, geo = FALSE)

</code></pre>

<hr>
<h2 id='calc_dur_per_event'>Duration of Each Event</h2><span id='topic+calc_dur_per_event'></span>

<h3>Description</h3>

<p>This function calculates the duration of each event of
collective motion in a dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_dur_per_event(data, step2time)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calc_dur_per_event_+3A_data">data</code></td>
<td>
<p>A dataframe with an <code>event</code> column (added by
<code><a href="#topic+get_event_ids">get_event_ids</a></code>), indicating the event ID that each timestep
belongs to. Timesteps that are not part of an event should not be included
in the data.</p>
</td></tr>
<tr><td><code id="calc_dur_per_event_+3A_step2time">step2time</code></td>
<td>
<p>The sampling frequency of the dataframe (how many seconds
are between each row of the data).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with two columns, event ID and duration in seconds.
</p>


<h3>Author(s)</h3>

<p>Marina Papadopoulou <a href="mailto:m.papadopoulou.rug@gmail.com">m.papadopoulou.rug@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+events_dur">events_dur</a></code>, <code><a href="#topic+get_event_ids">get_event_ids</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data &lt;- data.frame(
set = c(rep('1', 50), rep('2', 50)),
event = c(rep(NA, 10), rep(1, 40), rep(2, 30), rep(NA, 20))
)

time_per_row &lt;- 1 # seconds

calc_dur_per_event(data, time_per_row)

</code></pre>

<hr>
<h2 id='calc_events_averages'>Events Averages</h2><span id='topic+calc_events_averages'></span>

<h3>Description</h3>

<p>This function calculates all metrics per event.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_events_averages(df)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calc_events_averages_+3A_df">df</code></td>
<td>
<p>data frame with time series of group measurements. Columns must
include: <code>event</code>, <code>set</code>, <code>N</code>, <code>mean_nnd</code>, <code>sd_nnd</code>,
<code>pol</code>, <code>speed</code>, <code>sd_front</code>, <code>mean_bangl</code>, and
<code>shape</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a dataframe with a metric value per event.
</p>


<h3>Author(s)</h3>

<p>Marina Papadopoulou <a href="mailto:m.papadopoulou.rug@gmail.com">m.papadopoulou.rug@gmail.com</a>
</p>

<hr>
<h2 id='calc_global_metrics'>Calculation of Group Metrics</h2><span id='topic+calc_global_metrics'></span>

<h3>Description</h3>

<p>This function calculates the average speed,
polarization and shape of the group through time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_global_metrics(x, geo)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calc_global_metrics_+3A_x">x</code></td>
<td>
<p>A dataframe of a timestep of a group.</p>
</td></tr>
<tr><td><code id="calc_global_metrics_+3A_geo">geo</code></td>
<td>
<p>Logical, whether positions are
geographic coordinates, default = FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with one row,
with the group metrics for that timesteps, with columns:
<code>set</code>, <code>t</code>, <code>pol</code>, <code>speed</code>, <code>shape</code>, <code>N</code> (number of individuals),
<code>missing_ind</code> (whether some individuals are missing).
</p>


<h3>Author(s)</h3>

<p>Marina Papadopoulou <a href="mailto:m.papadopoulou.rug@gmail.com">m.papadopoulou.rug@gmail.com</a>
</p>

<hr>
<h2 id='calc_n_events'>Number of Events (Internal)</h2><span id='topic+calc_n_events'></span>

<h3>Description</h3>

<p>This function calculates the number of events of collective
motion per set, given by <code><a href="#topic+events_n">events_n</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_n_events(data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calc_n_events_+3A_data">data</code></td>
<td>
<p>The dataframe of one set (splitted by the <code><a href="#topic+events_n">events_n</a></code>
function) with a <code>keep</code> column.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An integer corresponding to the number of events of collective motion
(sequences of <code>keep == TRUE</code>).
</p>


<h3>Author(s)</h3>

<p>Marina Papadopoulou <a href="mailto:m.papadopoulou.rug@gmail.com">m.papadopoulou.rug@gmail.com</a>
</p>

<hr>
<h2 id='calc_nn_metrics'>Relative Position of Nearest Neighbor Function to Parallelize</h2><span id='topic+calc_nn_metrics'></span>

<h3>Description</h3>

<p>This function calculates the bearing angle and distance from a focal
individual to its nearest neighbor.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_nn_metrics(thists, geo)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calc_nn_metrics_+3A_thists">thists</code></td>
<td>
<p>A timestep of individual positions, ids and headings.</p>
</td></tr>
<tr><td><code id="calc_nn_metrics_+3A_geo">geo</code></td>
<td>
<p>Logical, whether positions are geographic coordinates.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The input dataframe with new columns for <code>nnd</code> (nearest neighbor distance),
<code>nn_id</code> (its id) and <code>bangl</code> (nearest neighbor bearing angle).
</p>


<h3>Author(s)</h3>

<p>Marina Papadopoulou <a href="mailto:m.papadopoulou.rug@gmail.com">m.papadopoulou.rug@gmail.com</a>
</p>

<hr>
<h2 id='calc_obb'>Minimum Bounding Box</h2><span id='topic+calc_obb'></span>

<h3>Description</h3>

<p>This function calculates the minimum bounding box of a group of
objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_obb(x, y, geo = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calc_obb_+3A_x">x</code></td>
<td>
<p>A vector of x (or longitude) coordinates.</p>
</td></tr>
<tr><td><code id="calc_obb_+3A_y">y</code></td>
<td>
<p>A vector of y (or latitude) coordinates.</p>
</td></tr>
<tr><td><code id="calc_obb_+3A_geo">geo</code></td>
<td>
<p>A logical value indicating whether the locations are defined by
geographic coordinates (pairs of longitude/latitude values). Default: FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the bounding box coordinates, its height, width, and the
orientation of the longest side in degrees.
</p>


<h3>Author(s)</h3>

<p>Marina Papadopoulou, <a href="mailto:m.papadopoulou.rug@gmail.com">m.papadopoulou.rug@gmail.com</a>
</p>

<hr>
<h2 id='calc_pairwise_metrics'>Pairwise Metrics</h2><span id='topic+calc_pairwise_metrics'></span>

<h3>Description</h3>

<p>This function calculates group averages of pairwise measures.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_pairwise_metrics(df)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calc_pairwise_metrics_+3A_df">df</code></td>
<td>
<p>A data frame with time series of pairwise measurements. Columns
must include: <code>set</code>, <code>t</code>, <code>id</code>, <code>nnd</code>, <code>bangl</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with average and standard deviation of pairwise
measurements for a group at a single time step.
</p>


<h3>Author(s)</h3>

<p>Marina Papadopoulou <a href="mailto:m.papadopoulou.rug@gmail.com">m.papadopoulou.rug@gmail.com</a>
</p>

<hr>
<h2 id='col_motion_metrics'>Collective Motion Metrics</h2><span id='topic+col_motion_metrics'></span>

<h3>Description</h3>

<p>This function calculates metrics of collective motion across sets
and events.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>col_motion_metrics(
  timeseries_data,
  global_metrics,
  step2time = 1,
  verbose = TRUE,
  speed_lim = NA,
  pol_lim = NA,
  noise_thresh = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="col_motion_metrics_+3A_timeseries_data">timeseries_data</code></td>
<td>
<p>A data frame with time series of individual's
positional data through time with nearest neighbor analysis conducted</p>
</td></tr>
<tr><td><code id="col_motion_metrics_+3A_global_metrics">global_metrics</code></td>
<td>
<p>A data frame with the global metrics timeseries.</p>
</td></tr>
<tr><td><code id="col_motion_metrics_+3A_step2time">step2time</code></td>
<td>
<p>Numeric, the sampling frequency of the dataset
(the relation between a time step and real time in seconds).</p>
</td></tr>
<tr><td><code id="col_motion_metrics_+3A_verbose">verbose</code></td>
<td>
<p>Logical, whether to post updates on progress.</p>
</td></tr>
<tr><td><code id="col_motion_metrics_+3A_speed_lim">speed_lim</code></td>
<td>
<p>Numeric, the threshold of speed for the definition of
an event. For more info see: <code><a href="#topic+pick_threshold">pick_threshold</a></code>.</p>
</td></tr>
<tr><td><code id="col_motion_metrics_+3A_pol_lim">pol_lim</code></td>
<td>
<p>Numeric, the threshold of polarization for the definition of
an event. For more info see: <code><a href="#topic+pick_threshold">pick_threshold</a></code>.</p>
</td></tr>
<tr><td><code id="col_motion_metrics_+3A_noise_thresh">noise_thresh</code></td>
<td>
<p>Numeric, the limit of time difference between consecutive
events to be considered the same event. Default value is 0 (no event merging).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with metrics of collective motion per event.
</p>


<h3>Author(s)</h3>

<p>Marina Papadopoulou <a href="mailto:m.papadopoulou.rug@gmail.com">m.papadopoulou.rug@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+define_events">define_events</a>, <a href="#topic+group_metrics">group_metrics</a>, <a href="#topic+pairwise_metrics">pairwise_metrics</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## A dataframe with group timeseries
g_df &lt;- data.frame(
 t = as.POSIXct(1:25, origin = "2024-03-18 14:56:05"),
 set = rep(1, 25),
 pol = c(rnorm(25)),
 pol_av = c(rnorm(25)),
 speed = c(rnorm(25)),
 speed_av = c(rnorm(25)),
 shape = c(rnorm(25)),
 event = rep(1, 25),
 N = rep(3, 25)
 )

## A dataframe with individual timeseries
p_df &lt;- data.frame(
 t = as.POSIXct(rep(1:25, 3), origin = "2024-03-18 14:56:05"),
 set = rep(1, 75),
 nnd = c(rnorm(75)),
 bangl = runif(75, 0, pi),
 id = c(rep(1, 25), rep(2, 25), rep(3, 25)),
 nn_id = c(
  sample(c(2,3), 25, replace = TRUE),
  sample(c(1,3), 25, replace = TRUE),
  sample(c(2,1), 25, replace = TRUE)),
 event = rep(1, 75)
)
p_df$only_time &lt;- format(p_df$t, "%H:%M:%OS2")

metrics &lt;- col_motion_metrics(
 timeseries_data = p_df,
 global_metrics = g_df,
 step2time = 1,
 speed_lim = 0,
 pol_lim = 0,
 noise_thresh = 1
)

</code></pre>

<hr>
<h2 id='col_motion_metrics_from_raw'>Collective Motion Metrics from Raw Data</h2><span id='topic+col_motion_metrics_from_raw'></span>

<h3>Description</h3>

<p>This function calculates metrics of collective motion across sets and events.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>col_motion_metrics_from_raw(
  data,
  mov_av_time_window,
  step2time = 1,
  geo = FALSE,
  verbose = FALSE,
  speed_lim = NA,
  pol_lim = NA,
  parallelize_all = FALSE,
  noise_thresh = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="col_motion_metrics_from_raw_+3A_data">data</code></td>
<td>
<p>A data frame with time series of individual's positional
data through time. Columns must include: <code>id</code>, <code>set</code>, <code>t</code>, <code>x</code>, <code>y</code>.</p>
</td></tr>
<tr><td><code id="col_motion_metrics_from_raw_+3A_mov_av_time_window">mov_av_time_window</code></td>
<td>
<p>Numeric, a time window to average over for
speed and polarization timeseries (in timesteps).</p>
</td></tr>
<tr><td><code id="col_motion_metrics_from_raw_+3A_step2time">step2time</code></td>
<td>
<p>Numeric, the sampling frequency of the dateset
(the relation between a time step and real time in seconds).</p>
</td></tr>
<tr><td><code id="col_motion_metrics_from_raw_+3A_geo">geo</code></td>
<td>
<p>Logical, whether positions are geographic coordinates,
default = FALSE.</p>
</td></tr>
<tr><td><code id="col_motion_metrics_from_raw_+3A_verbose">verbose</code></td>
<td>
<p>Logical, whether to post updates on progress, default = FALSE.</p>
</td></tr>
<tr><td><code id="col_motion_metrics_from_raw_+3A_speed_lim">speed_lim</code></td>
<td>
<p>Numeric, the threshold of speed for the definition of
an event. For more info see: <code><a href="#topic+pick_threshold">pick_threshold</a></code>.</p>
</td></tr>
<tr><td><code id="col_motion_metrics_from_raw_+3A_pol_lim">pol_lim</code></td>
<td>
<p>Numeric, the threshold of polarization for the definition of
an event. For more info see: <code><a href="#topic+pick_threshold">pick_threshold</a></code>.</p>
</td></tr>
<tr><td><code id="col_motion_metrics_from_raw_+3A_parallelize_all">parallelize_all</code></td>
<td>
<p>Logical, whether or not to parallelize over timesteps.</p>
</td></tr>
<tr><td><code id="col_motion_metrics_from_raw_+3A_noise_thresh">noise_thresh</code></td>
<td>
<p>Numeric, the limit of time difference between consecutive events
to be considered the same event. Default value is 0 (no event merging).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with metrics of collective motion per event.
</p>


<h3>Author(s)</h3>

<p>Marina Papadopoulou <a href="mailto:m.papadopoulou.rug@gmail.com">m.papadopoulou.rug@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+add_velocities">add_velocities</a>, <a href="#topic+group_metrics">group_metrics</a>, <a href="#topic+pairwise_metrics">pairwise_metrics</a>, <a href="#topic+moving_average">moving_average</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- data.frame(
 set = rep(1, 75),
 x = rnorm(75, sd = 3),
 y = rnorm(75, sd = 3),
 t = as.POSIXct(rep(1:25, 3), origin = Sys.time()),
 id = c(rep(1, 25), rep(2, 25), rep(3, 25))
 )

metrics &lt;- col_motion_metrics_from_raw(data,
 mov_av_time_window = 5,
 step2time = 1,
 geo = FALSE,
 speed_lim = 0,
 pol_lim = 0,
 noise_thresh = 1
 )

</code></pre>

<hr>
<h2 id='define_events'>Define Events of Collective Motion</h2><span id='topic+define_events'></span>

<h3>Description</h3>

<p>This function adds a keep TRUE/FALSE column in the input dataframe based on
whether the average speed and polarization of the group is larger than the
input thresholds, reflecting whether a timestep is considered part of a
collective event or not.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>define_events(df, sp_lim, pol_lim, step2time, noise_thresh = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="define_events_+3A_df">df</code></td>
<td>
<p>A dataframe with a <code>pol_av</code> and <code>speed_av</code> columns for
polarization and speed, respectively (as calculated by the
<code><a href="#topic+group_metrics_per_set">group_metrics_per_set</a></code> function).</p>
</td></tr>
<tr><td><code id="define_events_+3A_sp_lim">sp_lim</code></td>
<td>
<p>The (lower) threshold of speed to use for defining which
timesteps are part of an events of collective motion. In other words, during
an event the group should have an average speed of at least <code>sp_lim</code>.</p>
</td></tr>
<tr><td><code id="define_events_+3A_pol_lim">pol_lim</code></td>
<td>
<p>The (lower) threshold of polarization to use for defining
which timesteps are part of an events of collective motion. In other words,
during an event the group's polarization should be at least <code>pol_lim</code>.</p>
</td></tr>
<tr><td><code id="define_events_+3A_step2time">step2time</code></td>
<td>
<p>Sampling frequency, i.e. the relation between time steps
(rows) in the input dataframe and real time (in seconds).</p>
</td></tr>
<tr><td><code id="define_events_+3A_noise_thresh">noise_thresh</code></td>
<td>
<p>The limit of time difference between consecutive events
to be considered the same event. The default value is 0 (no event merging).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the dataframe that was given as input with an extra <code>keep</code>
column. The function also prints the number and duration of the defined
events.
</p>


<h3>Author(s)</h3>

<p>Marina Papadopoulou <a href="mailto:m.papadopoulou.rug@gmail.com">m.papadopoulou.rug@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pick_threshold">pick_threshold</a>, <a href="#topic+group_metrics_per_set">group_metrics_per_set</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- data.frame(
set = rep('1', 50),
pol_av = rnorm(50, mean = 0.5, sd = 0.2),
speed_av = rnorm(50, mean = 5)
)
data &lt;- define_events(data, sp_lim = 5, pol_lim = 0.4, step2time = 1)

</code></pre>

<hr>
<h2 id='do_add_set_vels'>Call Add Velocity Timeseries</h2><span id='topic+do_add_set_vels'></span>

<h3>Description</h3>

<p>This function calculates the headings and speeds of individuals based on
two location points and the time taken to travel between those points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>do_add_set_vels(data, geo = FALSE, verbose = FALSE, parallelize = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="do_add_set_vels_+3A_data">data</code></td>
<td>
<p>A dataframe with the time series of individuals' positions.
Columns must include: <code>t</code>, <code>id</code>, <code>x</code>, <code>y</code>.</p>
</td></tr>
<tr><td><code id="do_add_set_vels_+3A_geo">geo</code></td>
<td>
<p>Logical, whether positions are geographic coordinates, default = TRUE.</p>
</td></tr>
<tr><td><code id="do_add_set_vels_+3A_verbose">verbose</code></td>
<td>
<p>Logical, whether to post updates on progress, default = FALSE.</p>
</td></tr>
<tr><td><code id="do_add_set_vels_+3A_parallelize">parallelize</code></td>
<td>
<p>Logical, whether to run the function in parallel, default = FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The input dataframe with a new speed and heading (rotational, in rads) columns.
</p>


<h3>Author(s)</h3>

<p>Marina Papadopoulou <a href="mailto:m.papadopoulou.rug@gmail.com">m.papadopoulou.rug@gmail.com</a>
</p>

<hr>
<h2 id='do_add_vels'>Adding Velocity Information for Individuals in Parallel without Progress Updates</h2><span id='topic+do_add_vels'></span>

<h3>Description</h3>

<p>This function calculates headings and speeds based on
two location points and the time taken to travel between those points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>do_add_vels(per_id, geo = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="do_add_vels_+3A_per_id">per_id</code></td>
<td>
<p>Dataframe with the time series of individuals' positional data.
Columns must include: <code>t</code>, <code>id</code>, <code>x</code>, <code>y</code>.</p>
</td></tr>
<tr><td><code id="do_add_vels_+3A_geo">geo</code></td>
<td>
<p>Logical, whether positions are geographic coordinates, default = FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the input dataframe with a new speed and heading (rotational) column.
</p>


<h3>Author(s)</h3>

<p>Marina Papadopoulou <a href="mailto:m.papadopoulou.rug@gmail.com">m.papadopoulou.rug@gmail.com</a>
</p>

<hr>
<h2 id='do_pca'>Perform PCA</h2><span id='topic+do_pca'></span>

<h3>Description</h3>

<p>This function runs a PCA to place events on collective motion into less-dimentional space.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>do_pca(df)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="do_pca_+3A_df">df</code></td>
<td>
<p>A dataframe with the metrics of collective motion
per event.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with the swarm space (a dataframe with PC1, PC2, PC3
coordinates per event) and the complete pca object.
</p>


<h3>Author(s)</h3>

<p>Marina Papadopoulou <a href="mailto:m.papadopoulou.rug@gmail.com">m.papadopoulou.rug@gmail.com</a>
</p>

<hr>
<h2 id='do_tsne'>Performs t-SNE</h2><span id='topic+do_tsne'></span>

<h3>Description</h3>

<p>This function calculates the coordinates of each event in the t-SNE space.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>do_tsne(df, tsne_rand_seed, tsne_perplexity)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="do_tsne_+3A_df">df</code></td>
<td>
<p>A dataframe with the metrics of collective motion
per event.</p>
</td></tr>
<tr><td><code id="do_tsne_+3A_tsne_rand_seed">tsne_rand_seed</code></td>
<td>
<p>Random seed to be able to reproduce the t-SNE analysis.</p>
</td></tr>
<tr><td><code id="do_tsne_+3A_tsne_perplexity">tsne_perplexity</code></td>
<td>
<p>Perplexity parameter for tsne. Usually between 10-50.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with X and Y coordinates per event in the t-SNE space.
</p>


<h3>Author(s)</h3>

<p>Marina Papadopoulou <a href="mailto:m.papadopoulou.rug@gmail.com">m.papadopoulou.rug@gmail.com</a>
</p>

<hr>
<h2 id='event_ids_per_set'>Event Indexes per Set</h2><span id='topic+event_ids_per_set'></span>

<h3>Description</h3>

<p>The execution of <code>event_ids</code> per set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>event_ids_per_set(setdf, ev_idx)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="event_ids_per_set_+3A_setdf">setdf</code></td>
<td>
<p>The dataframe for one set of the data. It should not have
discontinuities in time.</p>
</td></tr>
<tr><td><code id="event_ids_per_set_+3A_ev_idx">ev_idx</code></td>
<td>
<p>The last event index added so far at the dataset (e.g., from a
previous set).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with the timeseries of event indexes for the input set.
</p>


<h3>Author(s)</h3>

<p>Marina Papadopoulou <a href="mailto:m.papadopoulou.rug@gmail.com">m.papadopoulou.rug@gmail.com</a>
</p>

<hr>
<h2 id='event_metrics'>Metrics of Collective Motion</h2><span id='topic+event_metrics'></span>

<h3>Description</h3>

<p>This function calculates metrics of collective motion across
sets and events.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>event_metrics(global_df, pairwise_df)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="event_metrics_+3A_global_df">global_df</code></td>
<td>
<p>A data frame with time series of global group measurements.
Columns must include: <code>set</code>, <code>t</code>, <code>event</code>, <code>pol</code>,
<code>shape</code>, <code>speed</code>.</p>
</td></tr>
<tr><td><code id="event_metrics_+3A_pairwise_df">pairwise_df</code></td>
<td>
<p>A data frame with time series of pairwise measurements.
Columns must include: <code>set</code>, <code>t</code>, <code>id</code>, <code>nnd</code>,
<code>bangl</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with 10 metrics per event.
</p>


<h3>Author(s)</h3>

<p>Marina Papadopoulou <a href="mailto:m.papadopoulou.rug@gmail.com">m.papadopoulou.rug@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+group_metrics">group_metrics</a></code>, <code><a href="#topic+nn_metrics">nn_metrics</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## A dataframe with group timeseries
g_df &lt;- data.frame(
t = 1:25,
set = rep(1, 25),
pol = c(rnorm(25)),
speed = c(rnorm(25)),
shape = c(rnorm(25)),
event = rep(1, 25),
N = rep(2, 25)
)

## A dataframe with individual timeseries
p_df &lt;- data.frame(
t = rep(1:25, 2),
set = rep(1, 50),
nnd = c(rnorm(50)),
bangl = runif(25, 0, pi),
id = c(rep(1, 25), rep(2, 25)),
event = rep(1, 50)
)

events_dataframe &lt;- event_metrics(g_df, p_df)

</code></pre>

<hr>
<h2 id='events_dur'>Total Duration of All Events</h2><span id='topic+events_dur'></span>

<h3>Description</h3>

<p>This function calculates the total duration (in seconds) of
events of collective motion in a dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>events_dur(data, step2time)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="events_dur_+3A_data">data</code></td>
<td>
<p>A dataframe with a <code>keep</code> column, representing which rows
are defined as events of collective motion (added by the
<code><a href="#topic+define_events">define_events</a></code> function).</p>
</td></tr>
<tr><td><code id="events_dur_+3A_step2time">step2time</code></td>
<td>
<p>The sampling frequency of the dataframe (how many seconds
are between each row of the data).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric corresponding to the total duration of events in the
dataset in seconds.
</p>


<h3>Author(s)</h3>

<p>Marina Papadopoulou <a href="mailto:m.papadopoulou.rug@gmail.com">m.papadopoulou.rug@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+define_events">define_events</a></code>, <code><a href="#topic+events_n">events_n</a></code>
</p>

<hr>
<h2 id='events_n'>Number of Events</h2><span id='topic+events_n'></span>

<h3>Description</h3>

<p>This function calculates the number of events of collective
motion in a dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>events_n(data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="events_n_+3A_data">data</code></td>
<td>
<p>A dataframe with a <code>keep</code> column (representing which rows
are defined as events of collective motion) and a <code>set</code> column.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an integer with the number of events of collective motion (sequences
of <code>keep == TRUE</code>).
</p>


<h3>Author(s)</h3>

<p>Marina Papadopoulou <a href="mailto:m.papadopoulou.rug@gmail.com">m.papadopoulou.rug@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+define_events">define_events</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data &lt;- data.frame(
set = c(rep('1', 50), rep('2', 50)),
keep = c(rep(FALSE, 10), rep(TRUE, 70), rep(FALSE, 20))
)

events_n(data) ## 2 events

</code></pre>

<hr>
<h2 id='events_summary'>Events Summary</h2><span id='topic+events_summary'></span>

<h3>Description</h3>

<p>This function summarizes the number of events and their total
duration in the dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>events_summary(data, step2time)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="events_summary_+3A_data">data</code></td>
<td>
<p>A dataframe with a <code>keep</code> column (representing which rows
are defined as events of collective motion) and a set column.</p>
</td></tr>
<tr><td><code id="events_summary_+3A_step2time">step2time</code></td>
<td>
<p>The sampling frequency of the dataframe (how many seconds
are between each row of the data).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with 3 columns: <code>set</code>, <code>ev_count</code> (number of
events), and <code>dur</code> (duration of events in seconds).
</p>


<h3>Author(s)</h3>

<p>Marina Papadopoulou <a href="mailto:m.papadopoulou.rug@gmail.com">m.papadopoulou.rug@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+events_dur">events_dur</a></code>, <code><a href="#topic+events_n">events_n</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data &lt;- data.frame(
set = c(rep('1', 50), rep('2', 50)),
keep = c(rep(FALSE, 10), rep(TRUE, 70), rep(FALSE, 20))
)

time_per_row &lt;- 1 # seconds

events_summary(data, time_per_row)

</code></pre>

<hr>
<h2 id='expand_pca_swarm_space'>Expand Existing Swarm Space (PCA)</h2><span id='topic+expand_pca_swarm_space'></span>

<h3>Description</h3>

<p>This function predicts the positions of new event data in an
existing PCA space using the <code>stats::predict</code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expand_pca_swarm_space(metrics_data, pca_space, event_dur_limit = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="expand_pca_swarm_space_+3A_metrics_data">metrics_data</code></td>
<td>
<p>A dataframe with the new metrics data to add in swarm space.</p>
</td></tr>
<tr><td><code id="expand_pca_swarm_space_+3A_pca_space">pca_space</code></td>
<td>
<p>The PCA object to predict from, the output of the
<code>stats::prcomp</code> function or the pca element of the list output
of the <code>swarm_space</code> function.</p>
</td></tr>
<tr><td><code id="expand_pca_swarm_space_+3A_event_dur_limit">event_dur_limit</code></td>
<td>
<p>Numeric, capturing an event duration value in seconds.
Used to filter out events that are shorter that this value.
Default = NA, no filtering is applied.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with the x and y coordinates in the input swarm space
per event of the new species.
</p>


<h3>Author(s)</h3>

<p>Marina Papadopoulou <a href="mailto:m.papadopoulou.rug@gmail.com">m.papadopoulou.rug@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+swarm_space">swarm_space</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(multi_species_metrics)
data(multi_species_pca)
ss &lt;- expand_pca_swarm_space(multi_species_metrics,
multi_species_pca)

</code></pre>

<hr>
<h2 id='frontness'>Frontness</h2><span id='topic+frontness'></span>

<h3>Description</h3>

<p>Given the bearing angle of an object to another, this function
calculates the frontness, a value that ranges from 0 to 1 and represents how
in front the focal object is from its neighbor.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>frontness(bs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="frontness_+3A_bs">bs</code></td>
<td>
<p>A vector of bearing angles (in rad) between objects.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of the same length as bs representing the frontness of
a focal object to its neighbor.
</p>


<h3>Author(s)</h3>

<p>Marina Papadopoulou, <a href="mailto:m.papadopoulou.rug@gmail.com">m.papadopoulou.rug@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+nnba">nnba</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>bs &lt;- runif(25, max = pi)
frontness(bs)

</code></pre>

<hr>
<h2 id='get_event_ids'>Event Indexes</h2><span id='topic+get_event_ids'></span>

<h3>Description</h3>

<p>This function returns a vector with the timeseries of event IDs
according to the input keep column of the dataframe.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_event_ids(df)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_event_ids_+3A_df">df</code></td>
<td>
<p>A dataframe with a set and a keep column to get the timeseries of
event IDs. The <code>keep</code> column is added by the
<code><a href="#topic+define_events">define_events</a></code> function and represents whether each timestep is
part of an event or not (whether it should be kept in for the rest of the
analysis). Each set of the dataframe should be ordered in time.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of the same length as the rows of the input dataframe with
the timeseries of event IDs.
</p>


<h3>Author(s)</h3>

<p>Marina Papadopoulou <a href="mailto:m.papadopoulou.rug@gmail.com">m.papadopoulou.rug@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+define_events">define_events</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- data.frame(
set = c(rep('1', 50), rep('2', 50)),
keep = c(rep(FALSE, 10), rep(TRUE, 70), rep(FALSE, 20))
)
data$event &lt;- get_event_ids(data)

</code></pre>

<hr>
<h2 id='group_metrics'>Group Metrics of Collective Motion</h2><span id='topic+group_metrics'></span>

<h3>Description</h3>

<p>This function calculates the average speed, polarization
and shape of a group through time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>group_metrics(data, geo, step2time = 1, parallelize = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="group_metrics_+3A_data">data</code></td>
<td>
<p>A dataframe of (ordered) time series of headings,
positions, and speeds per individual. The dataframe may contain
several individuals. Should include the columns:
<code>id</code>, <code>t</code>, <code>speed</code>, <code>x</code>, <code>y</code>, <code>head</code>, <code>set</code>.</p>
</td></tr>
<tr><td><code id="group_metrics_+3A_geo">geo</code></td>
<td>
<p>Logical, whether positions are geographic coordinates,
default = FALSE.</p>
</td></tr>
<tr><td><code id="group_metrics_+3A_step2time">step2time</code></td>
<td>
<p>Numeric, the sampling frequency of the data
(the relation between a row in the data and real time in seconds).</p>
</td></tr>
<tr><td><code id="group_metrics_+3A_parallelize">parallelize</code></td>
<td>
<p>Logical, whether to parallelize over time.
Suggested only for very large datasets.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with the group average timeseries, with columns:
<code>set</code>, <code>t</code>, <code>pol</code>, <code>speed</code>, <code>shape</code>, <code>N</code> (number of individuals),
<code>missing_ind</code> (whether some individuals are missing).
</p>


<h3>Author(s)</h3>

<p>Marina Papadopoulou <a href="mailto:m.papadopoulou.rug@gmail.com">m.papadopoulou.rug@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+group_shape">group_shape</a>, <a href="#topic+add_velocities">add_velocities</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- data.frame(
 set = rep("1", 50),
 t = as.POSIXct(rep(1:25, 2), origin = Sys.time()),
 id = c(rep(1, 25), rep(2, 25)),
 x = rnorm(50),
 y = rnorm(50),
 head = runif(50, 0, 2 * pi),
 speed = rnorm(50)
 )

gm &lt;- group_metrics(data,
 geo = FALSE,
 step2time = 1)

</code></pre>

<hr>
<h2 id='group_metrics_per_set'>Group Metrics of Collective Motion in a Dataset</h2><span id='topic+group_metrics_per_set'></span>

<h3>Description</h3>

<p>This function calculates the timeseries of average speed,
polarization and shape of all set in a dataset
</p>


<h3>Usage</h3>

<pre><code class='language-R'>group_metrics_per_set(
  data_list,
  mov_av_time_window,
  geo,
  step2time,
  parallelize = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="group_metrics_per_set_+3A_data_list">data_list</code></td>
<td>
<p>A list of dataframes with groups timeseries per set.
Columns must include: <code>id</code>, <code>t</code>, <code>set</code>, <code>head</code>,
<code>x</code>, <code>y</code>, <code>speed</code>.</p>
</td></tr>
<tr><td><code id="group_metrics_per_set_+3A_mov_av_time_window">mov_av_time_window</code></td>
<td>
<p>Integer, timesteps to use as a sliding window
for average speed and polarization.</p>
</td></tr>
<tr><td><code id="group_metrics_per_set_+3A_geo">geo</code></td>
<td>
<p>Logical, whether positions are geographic coordinates,
default = FALSE.</p>
</td></tr>
<tr><td><code id="group_metrics_per_set_+3A_step2time">step2time</code></td>
<td>
<p>Double, the sampling frequency of the data (the relation
between a time step and real time in seconds).</p>
</td></tr>
<tr><td><code id="group_metrics_per_set_+3A_parallelize">parallelize</code></td>
<td>
<p>Logical, whether or not to parallelize over the
timesteps of each set.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with the group average timeseries for each set, with columns:
<code>set</code>, <code>t</code>, <code>pol</code>, <code>speed</code>, <code>shape</code>, <code>N</code> (number of individuals),
<code>missing_ind</code> (whether some individuals are missing), <code>pol_av</code> (moving average
of polarization based on input time window) and <code>speed_av</code> (moving average of
speed based on input time window).
</p>


<h3>Author(s)</h3>

<p>Marina Papadopoulou <a href="mailto:m.papadopoulou.rug@gmail.com">m.papadopoulou.rug@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+group_metrics">group_metrics</a></code>, <code><a href="#topic+moving_average">moving_average</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data &lt;- data.frame(
 set = rep("1", 50),
 t = as.POSIXct(rep(1:25, 2), origin = Sys.time()),
 id = c(rep(1, 25), rep(2, 25)),
 x = rnorm(50),
 y = rnorm(50),
 head = runif(50, 0, 2 * pi),
 speed = rnorm(50)
 )

gm &lt;- group_metrics_per_set(list(data),
 mov_av_time_window = 5,
 geo = FALSE,
 step2time = 1
 )
</code></pre>

<hr>
<h2 id='group_shape'>Group Shape Based on a OOBB</h2><span id='topic+group_shape'></span>

<h3>Description</h3>

<p>Calculates how oblong the shape of a group is, relative to its
average moving direction, along with the properties of the minimum object
oriented bounding box (OOBB) around all objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>group_shape(x, y, hs, geo = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="group_shape_+3A_x">x</code></td>
<td>
<p>A vector of x (or longitude) coordinates.</p>
</td></tr>
<tr><td><code id="group_shape_+3A_y">y</code></td>
<td>
<p>A vector of y (or latitude) coordinates.</p>
</td></tr>
<tr><td><code id="group_shape_+3A_hs">hs</code></td>
<td>
<p>A vector of headings of the objects (in degrees).</p>
</td></tr>
<tr><td><code id="group_shape_+3A_geo">geo</code></td>
<td>
<p>A logical value indicating whether the locations are defined by
geographic coordinates (pairs of longitude/latitude values). Default: FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the estimate of how oblong the group is, and the details
of the bounding box, i.e. its coordinates, height, width, and orientation of
its longest side in degrees.
</p>


<h3>Author(s)</h3>

<p>Marina Papadopoulou, <a href="mailto:m.papadopoulou.rug@gmail.com">m.papadopoulou.rug@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
x &lt;- rnorm(25)
y &lt;- rnorm(25, sd = 3)
h &lt;- runif(25, 0, 2 * pi)
group_shape(x, y, h, geo = FALSE)

</code></pre>

<hr>
<h2 id='moving_average'>Moving Average</h2><span id='topic+moving_average'></span>

<h3>Description</h3>

<p>This function calculates the moving average of a time series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>moving_average(timeseries, window)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="moving_average_+3A_timeseries">timeseries</code></td>
<td>
<p>Vector of doubles representing a timeseries.</p>
</td></tr>
<tr><td><code id="moving_average_+3A_window">window</code></td>
<td>
<p>Double, the time-window to average over (in timesteps).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of doubles (average over the window).
</p>


<h3>Author(s)</h3>

<p>Marina Papadopoulou <a href="mailto:m.papadopoulou.rug@gmail.com">m.papadopoulou.rug@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>bs &lt;- rnorm(20, mean = 10, sd = 1)
moving_average(bs, 5)

</code></pre>

<hr>
<h2 id='multi_species_metrics'>Multi-Species Collective Motion Metrics</h2><span id='topic+multi_species_metrics'></span>

<h3>Description</h3>

<p>A dataset containing the metrics of collective motion for 4
species: stickleback fish, homing pigeons, goats, and chacma baboons. They
were used for the construction of the initial swarm space in:
</p>
<p>Papadopoulou Marina, FÃ¼rtbauer Ines, O'Bryan Lisa R., Garnier Simon,
Georgopoulou Dimitra G., Bracken Anna M., Christensen Charlotte and King
Andrew J. 2023. Dynamics of collective motion across time and species. Phil.
Trans. R. Soc. B 378: 20220068. http://doi.org/10.1098/rstb.2022.0068
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data('multi_species_metrics')
</code></pre>


<h3>Format</h3>

<p>A dataframe with 118 rows and 12 columns:
</p>

<dl>
<dt>mean_mean_nnd</dt><dd><p>Average nearest neighbor distance</p>
</dd>
<dt>mean_sd_nnd</dt><dd><p>Average within-group variation in nearest neighbor
distance</p>
</dd>
<dt>sd_mean_nnd</dt><dd><p>Temporal variation in average nearest neighbor
distance</p>
</dd>
<dt>mean_pol</dt><dd><p>Average polarization</p>
</dd>
<dt>sd_pol</dt><dd><p>Temporal variation in polarization</p>
</dd>
<dt>stdv_speed</dt><dd><p>Temporal variation in speed</p>
</dd>
<dt>mean_sd_front</dt><dd><p>Average within-group variation in frontness</p>
</dd>
<dt>mean_mean_bangl</dt><dd><p>Average bearing angle</p>
</dd>
<dt>mean_shape</dt><dd><p>Average group shape (rads)</p>
</dd>
<dt>sd_shape</dt><dd><p>Temporal variation in group shape (rads)</p>
</dd>
<dt>species</dt><dd><p>Species id</p>
</dd>
<dt>event</dt><dd><p>Event id</p>
</dd>
</dl>



<h3>References</h3>

<p>Papadopoulou Marina, FÃ¼rtbauer Ines, O'Bryan Lisa R., Garnier Simon,
Georgopoulou Dimitra G., Bracken Anna M., Christensen Charlotte and King
Andrew J. 2023. Dynamics of collective motion across time and species. Phil.
Trans. R. Soc. B 378: 20220068. http://doi.org/10.1098/rstb.2022.0068
</p>

<hr>
<h2 id='multi_species_pca'>Multi-Species PCA</h2><span id='topic+multi_species_pca'></span>

<h3>Description</h3>

<p>The swarm space PCA of 4 species: stickleback fish, homing
pigeons, goats and chacma baboons. First published as part of:
</p>
<p>Papadopoulou Marina, FÃ¼rtbauer Ines, O'Bryan Lisa R., Garnier Simon,
Georgopoulou Dimitra G., Bracken Anna M., Christensen Charlotte and King
Andrew J. 2023. Dynamics of collective motion across time and species. Phil.
Trans. R. Soc. B 378: 20220068. http://doi.org/10.1098/rstb.2022.0068
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data('multi_species_pca')
</code></pre>


<h3>Format</h3>

<p>A list of 5 elements, exported by the <code>stats::prcomp function</code>.
</p>


<h3>References</h3>

<p>Papadopoulou Marina, FÃ¼rtbauer Ines, O'Bryan Lisa R., Garnier Simon,
Georgopoulou Dimitra G., Bracken Anna M., Christensen Charlotte and King
Andrew J. 2023. Dynamics of collective motion across time and species. Phil.
Trans. R. Soc. B 378: 20220068. http://doi.org/10.1098/rstb.2022.0068
</p>


<h3>See Also</h3>

<p><code><a href="#topic+multi_species_pca_data">multi_species_pca_data</a></code>
</p>

<hr>
<h2 id='multi_species_pca_data'>Multi-Species PCA Data</h2><span id='topic+multi_species_pca_data'></span>

<h3>Description</h3>

<p>The positions of events from 4 species: stickleback fish, homing
pigeons, goats and chacma baboons, in the PCA swarm space (see
<code><a href="#topic+multi_species_pca">multi_species_pca</a></code>. First published as part of:
</p>
<p>Papadopoulou Marina, FÃ¼rtbauer Ines, O'Bryan Lisa R., Garnier Simon,
Georgopoulou Dimitra G., Bracken Anna M., Christensen Charlotte and King
Andrew J. 2023. Dynamics of collective motion across time and species. Phil.
Trans. R. Soc. B 378: 20220068. http://doi.org/10.1098/rstb.2022.0068
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data('multi_species_pca_data')
</code></pre>


<h3>Format</h3>

<p>A dataframe of 3 columns: species, PC1, PC2, PC3.
</p>


<h3>References</h3>

<p>Papadopoulou Marina, FÃ¼rtbauer Ines, O'Bryan Lisa R., Garnier Simon,
Georgopoulou Dimitra G., Bracken Anna M., Christensen Charlotte and King
Andrew J. 2023. Dynamics of collective motion across time and species. Phil.
Trans. R. Soc. B 378: 20220068. http://doi.org/10.1098/rstb.2022.0068
</p>


<h3>See Also</h3>

<p><code><a href="#topic+multi_species_pca">multi_species_pca</a></code>
</p>

<hr>
<h2 id='new_species_metrics'>The Collective Motion Metrics of a New Species</h2><span id='topic+new_species_metrics'></span>

<h3>Description</h3>

<p>The output dataset of vignette 2, containing the metrics of 
collective motion for a new species.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data('new_species_metrics')
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 60 rows and 16 columns.
</p>

<hr>
<h2 id='nn_metrics'>Nearest Neighbour Metrics</h2><span id='topic+nn_metrics'></span>

<h3>Description</h3>

<p>This function calculates the bearing angle and distance from
all focal individuals in a group to their nearest neighbor over time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nn_metrics(
  data,
  add_coords = FALSE,
  geo = FALSE,
  verbose = FALSE,
  parallelize = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nn_metrics_+3A_data">data</code></td>
<td>
<p>A dataframe with the group's positional timeseries for one set.
Column names must include: <code>id</code>, <code>t</code>, <code>head</code>, <code>x</code>, <code>y</code>.
The calculations are based on the <code>swaRm</code> package.</p>
</td></tr>
<tr><td><code id="nn_metrics_+3A_add_coords">add_coords</code></td>
<td>
<p>Logical, whether the data on relative positions of
nearest neighbours should be converted into
coordinates in the reference frame of the focal individual (<code>nnx</code>, <code>nny</code>). This
can be useful for visualization purposes but it is not used in the package
pipeling. Default = 'FALSE'.</p>
</td></tr>
<tr><td><code id="nn_metrics_+3A_geo">geo</code></td>
<td>
<p>Logical, whether positions are geographic coordinates, default = FALSE.</p>
</td></tr>
<tr><td><code id="nn_metrics_+3A_verbose">verbose</code></td>
<td>
<p>Logical, whether to post updates on progress.</p>
</td></tr>
<tr><td><code id="nn_metrics_+3A_parallelize">parallelize</code></td>
<td>
<p>Logical, whether to parallelize the function over time.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The input dataframe with new columns for nearest neighbor id (<code>nn_id</code>),
bearing angle (<code>bangl</code>), and distance (<code>nnd</code>).
If <code>add_coords</code> is TRUE, the columns <code>nnx</code> and <code>nny</code> are  added.
</p>


<h3>Author(s)</h3>

<p>Marina Papadopoulou <a href="mailto:m.papadopoulou.rug@gmail.com">m.papadopoulou.rug@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+add_rel_pos_coords">add_rel_pos_coords</a>, <a href="#topic+group_metrics">group_metrics</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data &lt;- data.frame(
 set = rep("1", 50),
 t = as.POSIXct(rep(1:25, 2), origin = Sys.time()),
 id = c(rep(1, 25), rep(2, 25)),
 x = rnorm(50),
 y = rnorm(50),
 head = runif(50, 0, 2 * pi)
 )

nnm &lt;- nn_metrics(data, geo = FALSE)

</code></pre>

<hr>
<h2 id='nnba'>Bearing Angle to Nearest Neighbor</h2><span id='topic+nnba'></span>

<h3>Description</h3>

<p>Given the locations and headings of different objects,
this function determines the angle between the heading of each object
and the position to the nearest neighboring object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nnba(x, y, hs, geo = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nnba_+3A_x">x</code></td>
<td>
<p>A vector of x (or longitude) coordinates.</p>
</td></tr>
<tr><td><code id="nnba_+3A_y">y</code></td>
<td>
<p>A vector of y (or latitude) coordinates.</p>
</td></tr>
<tr><td><code id="nnba_+3A_hs">hs</code></td>
<td>
<p>A vector of headings (angle in rads).</p>
</td></tr>
<tr><td><code id="nnba_+3A_geo">geo</code></td>
<td>
<p>A logical value indicating whether the locations are defined by
geographic coordinates (pairs of longitude/latitude values). Default: FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of the same length as x and y representing the distance to
the nearest neighboring object for each object.
</p>


<h3>Author(s)</h3>

<p>Simon Garnier, <a href="mailto:garnier@njit.edu">garnier@njit.edu</a>,
Marina Papadopoulou, <a href="mailto:m.papadopoulou.rug@gmail.com">m.papadopoulou.rug@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="swaRm.html#topic+pdist">pdist</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- rnorm(25)
y &lt;- rnorm(25, sd = 3)
hs &lt;- rnorm(25, sd = 1)
nnba(x, y, hs)

</code></pre>

<hr>
<h2 id='normalize_data'>Normalize Data</h2><span id='topic+normalize_data'></span>

<h3>Description</h3>

<p>This function rescales a vector to values between 0 and 1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>normalize_data(vec)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="normalize_data_+3A_vec">vec</code></td>
<td>
<p>A numerical vector to normalize.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of doubles, the normalized values of the input vector.
</p>


<h3>Author(s)</h3>

<p>Marina Papadopoulou <a href="mailto:m.papadopoulou.rug@gmail.com">m.papadopoulou.rug@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d &lt;- rnorm(20, mean = 10, sd = 1)
normalize_data(d)

</code></pre>

<hr>
<h2 id='pairwise_metrics'>Pairwise Metrics of Collective Motion in a Dataset</h2><span id='topic+pairwise_metrics'></span>

<h3>Description</h3>

<p>This function calculates the bearing angle and distance from each
focal individual of a group to its nearest neighbor over time, across
the sets of a dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pairwise_metrics(
  data_list,
  geo = FALSE,
  verbose = FALSE,
  parallelize = FALSE,
  add_coords = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pairwise_metrics_+3A_data_list">data_list</code></td>
<td>
<p>A list of dataframes with groups timeseries per set.
Columns must include: <code>id</code>, <code>t</code>, <code>set</code>, <code>head</code>,
<code>x</code>, <code>y</code>.</p>
</td></tr>
<tr><td><code id="pairwise_metrics_+3A_geo">geo</code></td>
<td>
<p>Logical, whether positions are geographic coordinates,
default = FALSE.</p>
</td></tr>
<tr><td><code id="pairwise_metrics_+3A_verbose">verbose</code></td>
<td>
<p>Logical, whether to post updates on progress, default = FALSE.</p>
</td></tr>
<tr><td><code id="pairwise_metrics_+3A_parallelize">parallelize</code></td>
<td>
<p>Logical, whether to run the function in parallel over
timesteps, default = FALSE.</p>
</td></tr>
<tr><td><code id="pairwise_metrics_+3A_add_coords">add_coords</code></td>
<td>
<p>Logical, whether data on relative positions are converted
into geographic coordinates, default = 'FALSE'.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe format of the input list, with new columns for nearest neighbor id (<code>nn_id</code>),
bearing angles (<code>bangl</code>), and distances (<code>nnd</code>). If <code>add_coords</code> is TRUE, the columns
<code>nnx</code> and <code>nny</code> are also added.
</p>


<h3>Author(s)</h3>

<p>Marina Papadopoulou <a href="mailto:m.papadopoulou.rug@gmail.com">m.papadopoulou.rug@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+nn_metrics">nn_metrics</a>, <a href="#topic+group_metrics_per_set">group_metrics_per_set</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data &lt;- data.frame(
 set = rep("1", 50),
 t = as.POSIXct(rep(1:25, 2), origin = Sys.time()),
 id = c(rep(1, 25), rep(2, 25)),
 x = rnorm(50),
 y = rnorm(50),
 head = runif(50, 0, 2 * pi)
 )

pm &lt;- pairwise_metrics(list(data), geo = FALSE)

</code></pre>

<hr>
<h2 id='par_calc_global_metrics'>Calculation of Group Metrics in Parallel</h2><span id='topic+par_calc_global_metrics'></span>

<h3>Description</h3>

<p>This function calls calc_global_metrics in parallel.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>par_calc_global_metrics(dfs_per_time, geo)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="par_calc_global_metrics_+3A_dfs_per_time">dfs_per_time</code></td>
<td>
<p>A list of dataframes per timestep.</p>
</td></tr>
<tr><td><code id="par_calc_global_metrics_+3A_geo">geo</code></td>
<td>
<p>Logical, whether positions are
geographic coordinates, default = FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with the group average timeseries, with columns:
<code>set</code>, <code>t</code>, <code>pol</code>, <code>speed</code>, <code>shape</code>, <code>N</code> (number of individuals),
<code>missing_ind</code> (whether some individuals are missing).
</p>


<h3>Author(s)</h3>

<p>Marina Papadopoulou <a href="mailto:m.papadopoulou.rug@gmail.com">m.papadopoulou.rug@gmail.com</a>
</p>

<hr>
<h2 id='par_nn_metrics'>Adding Motion Properties in Parallel - Verbose</h2><span id='topic+par_nn_metrics'></span>

<h3>Description</h3>

<p>This function calculates the bearing angle and distance from
a focal individual to its nearest neighbor at the given timestep.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>par_nn_metrics(per_time, geo = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="par_nn_metrics_+3A_per_time">per_time</code></td>
<td>
<p>A groups positional data at a single timestep.
Columns must include: <code>id</code>, <code>t</code>, <code>head</code>, <code>x</code>, <code>y</code>.</p>
</td></tr>
<tr><td><code id="par_nn_metrics_+3A_geo">geo</code></td>
<td>
<p>Logical, whether positions are geographic coordinates, default = FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The input dataframe with new columns for <code>nnd</code> (nearest neighbor distance),
<code>nn_id</code> (its id) and  <code>bangl</code> (nearest neighbor bearing angle).
</p>


<h3>Author(s)</h3>

<p>Marina Papadopoulou <a href="mailto:m.papadopoulou.rug@gmail.com">m.papadopoulou.rug@gmail.com</a>
</p>

<hr>
<h2 id='parAddVels'>Adding Motion Properties in Parallel without Progress Updates</h2><span id='topic+parAddVels'></span>

<h3>Description</h3>

<p>This function calculates headings and speeds based on
two location points and the time taken to travel between those points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parAddVels(per_id, geo = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="parAddVels_+3A_per_id">per_id</code></td>
<td>
<p>Dataframe with the time series of individuals' positional data.
Columns must include: <code>t</code>, <code>id</code>, <code>x</code>, <code>y</code>.</p>
</td></tr>
<tr><td><code id="parAddVels_+3A_geo">geo</code></td>
<td>
<p>Logical, whether positions are geographic coordinates, default = FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the input dataframe with a new speed and heading (rotational) column.
</p>


<h3>Author(s)</h3>

<p>Marina Papadopoulou <a href="mailto:m.papadopoulou.rug@gmail.com">m.papadopoulou.rug@gmail.com</a>
</p>

<hr>
<h2 id='parAddVelsVerb'>Adding Individual Velocity Information in Parallel - Verbose</h2><span id='topic+parAddVelsVerb'></span>

<h3>Description</h3>

<p>This function calculates headings and speeds based on
two location points and the time taken to travel between those points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parAddVelsVerb(per_id, geo = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="parAddVelsVerb_+3A_per_id">per_id</code></td>
<td>
<p>Dataframe, the time series of individuals' positional data.
Columns must include: <code>t</code>, <code>id</code>, <code>x</code>, <code>y</code>.</p>
</td></tr>
<tr><td><code id="parAddVelsVerb_+3A_geo">geo</code></td>
<td>
<p>Logical, whether positions are geographic coordinates, default = FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the input dataframe with a new speed and heading (rotational) column.
</p>


<h3>Author(s)</h3>

<p>Marina Papadopoulou <a href="mailto:m.papadopoulou.rug@gmail.com">m.papadopoulou.rug@gmail.com</a>
</p>

<hr>
<h2 id='perIdVels'>Speed and Heading Calculation based on <code>swaRm</code> Package.</h2><span id='topic+perIdVels'></span>

<h3>Description</h3>

<p>This function calculates headings and speeds based on
consecutive locations of 1 individual. Based on the <code>heading</code> and the
<code>linear_speed</code> functions of <code>swaRm</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>perIdVels(per_id, geo)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="perIdVels_+3A_per_id">per_id</code></td>
<td>
<p>Time series of 1 individual's positional data.</p>
</td></tr>
<tr><td><code id="perIdVels_+3A_geo">geo</code></td>
<td>
<p>whether positions are geographic coordinates, default = FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the input dataframe with a new speed and heading (rotational) column.
</p>


<h3>Author(s)</h3>

<p>Marina Papadopoulou <a href="mailto:m.papadopoulou.rug@gmail.com">m.papadopoulou.rug@gmail.com</a>
</p>

<hr>
<h2 id='pick_threshold'>Pick a Threshold for the Events' Definition</h2><span id='topic+pick_threshold'></span>

<h3>Description</h3>

<p>An interactive function that calculates and prints the quantiles
of the input distribution and asks the user to input the threshold value
they want to keep. If a threshold is given as input, then the function
checks that the threshold type is correct and returns it. In the swaRmverse
framework, the timesteps with lower values than the threshold will be
labelled as not part of an event.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pick_threshold(data_distr, var, threshold = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pick_threshold_+3A_data_distr">data_distr</code></td>
<td>
<p>A numeric vector to pick a threshold for. In the package's
pipeline it is the timeseries of polarization and average speed of a group.</p>
</td></tr>
<tr><td><code id="pick_threshold_+3A_var">var</code></td>
<td>
<p>A string, the of the distribution to use at the interactive step
to ask the user for input.</p>
</td></tr>
<tr><td><code id="pick_threshold_+3A_threshold">threshold</code></td>
<td>
<p>If NA (the default), the function runs in interactive mode
and the user inputs a given value to return. If numeric, the function just
returns this input (interactive case is off).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the selected or input value of the user for the lower threshold, of
the variable to be used for the definition of an event.
</p>


<h3>Author(s)</h3>

<p>Marina Papadopoulou <a href="mailto:m.papadopoulou.rug@gmail.com">m.papadopoulou.rug@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+define_events">define_events</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d &lt;- rnorm(25, sd = 1)
d_variable_name &lt;- "a variable"
the_threshold &lt;- 0
pick_threshold(d, d_variable_name, threshold = the_threshold)

## If the threshold is not known, run the interactive version
## without giving a threshold as input.
</code></pre>

<hr>
<h2 id='set_data_format'>Data Formatting</h2><span id='topic+set_data_format'></span>

<h3>Description</h3>

<p>This function is a wrapper for the  <code>track</code> function of the <code>trackdf</code> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set_data_format(
  raw_x,
  raw_y,
  raw_t,
  raw_id,
  origin,
  period,
  tz,
  proj,
  format,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="set_data_format_+3A_raw_x">raw_x</code></td>
<td>
<p>A numeric vector representing the x coordinates of individual(s).</p>
</td></tr>
<tr><td><code id="set_data_format_+3A_raw_y">raw_y</code></td>
<td>
<p>A numeric vector representing the y coordinates of individual(s).</p>
</td></tr>
<tr><td><code id="set_data_format_+3A_raw_t">raw_t</code></td>
<td>
<p>A numeric vector that can be coerced to date-time objects by as
datetime representing the times (or frames) at which each location
was recorded.</p>
</td></tr>
<tr><td><code id="set_data_format_+3A_raw_id">raw_id</code></td>
<td>
<p>A vector representing the identity of each coordinate
recording.</p>
</td></tr>
<tr><td><code id="set_data_format_+3A_origin">origin</code></td>
<td>
<p>Something that can be coerced to a date-time object by as_
datetime representing the start date and time of the observations when t is
a numeric vector.</p>
</td></tr>
<tr><td><code id="set_data_format_+3A_period">period</code></td>
<td>
<p>A character vector in a shorthand format (e.g. &quot;1 second&quot;)
or ISO 8601 specification. This is used when t is a numeric vector to
represent time unit of the observations.</p>
</td></tr>
<tr><td><code id="set_data_format_+3A_tz">tz</code></td>
<td>
<p>A time zone name. See OlsonNames.</p>
</td></tr>
<tr><td><code id="set_data_format_+3A_proj">proj</code></td>
<td>
<p>A character string or a <code>sp::CRS</code> object representing
the projection of the coordinates. Leave empty if the coordinates are
not projected (e.g., output of video tracking). &quot;+proj=longlat&quot; is suitable
for the output of most GPS trackers.</p>
</td></tr>
<tr><td><code id="set_data_format_+3A_format">format</code></td>
<td>
<p>A character string indicating the formatting of 't'.
See strptime for how to specify this parameter.</p>
</td></tr>
<tr><td><code id="set_data_format_+3A_...">...</code></td>
<td>
<p>Additional vectors representing categories that the data
should be split by. If none, only the date will be used as a unit of data
separation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A track dataframe table, which is a colloquial term for an
object of class track.
</p>


<h3>Author(s)</h3>

<p>Marina Papadopoulou <a href="mailto:m.papadopoulou.rug@gmail.com">m.papadopoulou.rug@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
raw_data &lt;- data.frame(
 frame = rep(1:25, 3),
 x = rnorm(75),
 y = rnorm(75),
 id = c(rep(1, 25), rep(2, 25), rep(3, 25))
 )

data &lt;- set_data_format(
 raw_x = raw_data$x,
 raw_y = raw_data$y,
 raw_t = raw_data$frame,
 raw_id = raw_data$id,
 period = 1,
 origin = Sys.time(),
 tz = "Africa/Windhoek"
 )

</code></pre>

<hr>
<h2 id='swarm_space'>Create a Swarm Space</h2><span id='topic+swarm_space'></span>

<h3>Description</h3>

<p>This function runs a PCA (Principal component analysis)
or a t-SNE (t-distributed Stochastic Neighbor Embedding) over the
global and pairwise metrics of collective motion per each event to
produce a swarm space. The PCA is computed with the <code>stats::prcomp</code>
function and the t-SNE with the <code>Rtsne::Rtsne</code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>swarm_space(
  metrics_data,
  space_type = "pca",
  event_dur_limit = NA,
  tsne_rand_seed = NA,
  tsne_perplexity = 25
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="swarm_space_+3A_metrics_data">metrics_data</code></td>
<td>
<p>A dataframe with metrics of collective motion per event.</p>
</td></tr>
<tr><td><code id="swarm_space_+3A_space_type">space_type</code></td>
<td>
<p>A string, stating the choice between PCA (&quot;pca&quot;)
and t-SNE (&quot;tsne&quot;), default = &quot;pca&quot;.</p>
</td></tr>
<tr><td><code id="swarm_space_+3A_event_dur_limit">event_dur_limit</code></td>
<td>
<p>Numeric, capturing an event duration value in seconds.
Used to filter out events that are shorter that this value.
Default = NA, no filtering is applied.</p>
</td></tr>
<tr><td><code id="swarm_space_+3A_tsne_rand_seed">tsne_rand_seed</code></td>
<td>
<p>Numeric, the random seed for the t-SNE analysis, to
ensure reproducibility. Default = NA, but a value should be given if the
t-SNE analysis is selected.</p>
</td></tr>
<tr><td><code id="swarm_space_+3A_tsne_perplexity">tsne_perplexity</code></td>
<td>
<p>Numeric, the perplexity parameter for the t-SNE analysis.
Usually between 10-50, default = 25.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with 3 elements: a dataframe representing the
swarm space (x and y coordinates per event of each species), a reference dataframe
(<code>ref</code>) including all the additional event information from the input metric data
dataframe, a dataframe for the t-SNE analysis (<code>tsne_setup</code>) that includes the
input parameters used, and a list for the PCA analysis (pca) with the output
of the <code>stats::prcomp</code> command.
</p>


<h3>Author(s)</h3>

<p>Marina Papadopoulou <a href="mailto:m.papadopoulou.rug@gmail.com">m.papadopoulou.rug@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+group_metrics">group_metrics</a>, <a href="#topic+pairwise_metrics">pairwise_metrics</a>, <a href="#topic+nn_metrics">nn_metrics</a>, <a href="#topic+col_motion_metrics">col_motion_metrics</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(multi_species_metrics)
ss &lt;- swarm_space(multi_species_metrics)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
