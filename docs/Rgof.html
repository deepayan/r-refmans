<!DOCTYPE html><html lang="en"><head><title>Help for package Rgof</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {Rgof}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Rgof-package'><p>Rgof: 1d Goodness of Fit Tests</p></a></li>
<li><a href='#bincounter'><p>count events in bins. Useful for power calculations. Replaces hist command from R.</p></a></li>
<li><a href='#calcTS'><p>This function calculates the test statistics</p></a></li>
<li><a href='#case.studies'><p>This function creates the functions needed to run the various case studies.</p></a></li>
<li><a href='#check.functions'><p>This function checks whether the inputs have the correct format</p></a></li>
<li><a href='#chi_power_cont'><p>This function finds the power of various chi-square tests for continuous data</p></a></li>
<li><a href='#chi_power_disc'><p>This function finds the power of various chi-square tests for continuous data</p></a></li>
<li><a href='#chi_test_cont'><p>This function performs a number of chi-square gof tests for continuous data</p></a></li>
<li><a href='#chi_test_disc'><p>This function performs a number of chi-square gof tests for continuous data</p></a></li>
<li><a href='#Cpporder'><p>sort vector y by values in vector x</p></a></li>
<li><a href='#gof_cont'><p>run gof tests for continuous data</p></a></li>
<li><a href='#gof_disc'><p>run gof tests for discrete data</p></a></li>
<li><a href='#gof_power'><p>Find the power of various gof tests for continuous data.</p></a></li>
<li><a href='#gof_power_cont'><p>Find the power of various gof tests for continuous data.</p></a></li>
<li><a href='#gof_power_disc'><p>Find the power of various gof tests for discrete data.</p></a></li>
<li><a href='#gof_test'><p>This function performs a number of gof tests</p></a></li>
<li><a href='#gof_test_adjusted_pvalue'><p>This function performs a number of gof tests and finds the adjusted p value for the combined test</p></a></li>
<li><a href='#gof_test_cont'><p>This function performs a number of gof tests for continuous data</p></a></li>
<li><a href='#gof_test_cont_adj'><p>This function performs a number of gof tests for continuous data and finds the adjusted p value</p></a></li>
<li><a href='#gof_test_disc'><p>This function performs a number of gof tests for discrete data.</p></a></li>
<li><a href='#gof_test_disc_adj'><p>This function performs a number of gof tests for discrete data and finds the adjusted p value</p></a></li>
<li><a href='#make_bins_cont'><p>This function creates several type of bins for continuous data</p></a></li>
<li><a href='#make_bins_disc'><p>This function creates several types of bins for discrete data</p></a></li>
<li><a href='#newTSdisc'><p>a local function needed for the vignette</p></a></li>
<li><a href='#plot_power'><p>This function draws the power graph, with curves sorted by the mean power and smoothed for easier reading.</p></a></li>
<li><a href='#power_cont'><p>find power of gof tests for continuous data</p></a></li>
<li><a href='#power_cont_R'><p>Find the power of various gof tests for continuous data.</p></a></li>
<li><a href='#power_disc'><p>find power of gof tests for continuous data</p></a></li>
<li><a href='#power_disc_R'><p>Find the power of various gof tests for discrete data.</p></a></li>
<li><a href='#power_newtest'><p>This function estimates the power of test routines that calculate p value(s)</p></a></li>
<li><a href='#power_studies_results'><p>power_studies_results</p></a></li>
<li><a href='#pvaluecdf'><p>pvaluecdf</p></a></li>
<li><a href='#run.studies'><p>This function runs the case studies included in the package</p></a></li>
<li><a href='#signif.digits'><p>This function does some rounding to nice numbers</p></a></li>
<li><a href='#timecheck'><p>estimate run time function</p></a></li>
<li><a href='#TS_cont'><p>Find test statistics for continuous data</p></a></li>
<li><a href='#TS_disc'><p>Find test statistics for discrete data</p></a></li>
<li><a href='#TSw_cont'><p>Find test statistics for continuous data with weights</p></a></li>
<li><a href='#TSw_disc'><p>Find test statistics for discrete data</p></a></li>
<li><a href='#wbincounter'><p>Find counts or sum of weights in bins. Useful for power calculations. Replaces hist command from R.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>1d Goodness of Fit Tests</td>
</tr>
<tr>
<td>Version:</td>
<td>3.1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Routines that allow the user to run a large number of goodness-of-fit tests.  
     It allows for data to be continuous or discrete. It includes routines to estimate
     the power of the tests and display them as a power graph.
     The routine run.studies allows a user to quickly study the power of a new method and 
     how it compares to some of the standard ones.      </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp, parallel, ggplot2, stats, graphics, microbenchmark</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rmarkdown, knitr</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-03-13 18:52:57 UTC; Wolfgang</td>
</tr>
<tr>
<td>Author:</td>
<td>Wolfgang Rolke <a href="https://orcid.org/0000-0002-3514-726X"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Wolfgang Rolke &lt;wolfgang.rolke@upr.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-03-13 19:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='Rgof-package'>Rgof: 1d Goodness of Fit Tests</h2><span id='topic+Rgof'></span><span id='topic+Rgof-package'></span>

<h3>Description</h3>

<p>Routines that allow the user to run a large number of goodness-of-fit tests. It allows for data to be continuous or discrete. It includes routines to estimate the power of the tests and display them as a power graph. The routine run.studies allows a user to quickly study the power of a new method and how it compares to some of the standard ones.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Wolfgang Rolke <a href="mailto:wolfgang.rolke@upr.edu">wolfgang.rolke@upr.edu</a> (<a href="https://orcid.org/0000-0002-3514-726X">ORCID</a>)
</p>

<hr>
<h2 id='bincounter'>count events in bins. Useful for power calculations. Replaces hist command from R.</h2><span id='topic+bincounter'></span>

<h3>Description</h3>

<p>count events in bins. Useful for power calculations. Replaces hist command from R.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bincounter(x, bins)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bincounter_+3A_x">x</code></td>
<td>
<p>numeric vector</p>
</td></tr>
<tr><td><code id="bincounter_+3A_bins">bins</code></td>
<td>
<p>numeric vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Integer vector of counts
</p>

<hr>
<h2 id='calcTS'>This function calculates the test statistics</h2><span id='topic+calcTS'></span>

<h3>Description</h3>

<p>This function calculates the test statistics
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calcTS(dta, pnull, param, TS, typeTS, TSextra)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calcTS_+3A_dta">dta</code></td>
<td>
<p>list with data set</p>
</td></tr>
<tr><td><code id="calcTS_+3A_pnull">pnull</code></td>
<td>
<p>cdf under the null hypothesis</p>
</td></tr>
<tr><td><code id="calcTS_+3A_param">param</code></td>
<td>
<p>estimated parameters (or some constant)</p>
</td></tr>
<tr><td><code id="calcTS_+3A_ts">TS</code></td>
<td>
<p>routine</p>
</td></tr>
<tr><td><code id="calcTS_+3A_typets">typeTS</code></td>
<td>
<p>format of TS</p>
</td></tr>
<tr><td><code id="calcTS_+3A_tsextra">TSextra</code></td>
<td>
<p>list passed to TS function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of numbers
</p>

<hr>
<h2 id='case.studies'>This function creates the functions needed to run the various case studies.</h2><span id='topic+case.studies'></span>

<h3>Description</h3>

<p>This function creates the functions needed to run the various case studies.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>case.studies(which, nsample = 500)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="case.studies_+3A_which">which</code></td>
<td>
<p>name of the case study.</p>
</td></tr>
<tr><td><code id="case.studies_+3A_nsample">nsample</code></td>
<td>
<p>=500, sample size.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of functions
</p>

<hr>
<h2 id='check.functions'>This function checks whether the inputs have the correct format</h2><span id='topic+check.functions'></span>

<h3>Description</h3>

<p>This function checks whether the inputs have the correct format
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check.functions(pnull, rnull, phat = function(x) -99, vals, x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check.functions_+3A_pnull">pnull</code></td>
<td>
<p>cdf under the null hypothesis</p>
</td></tr>
<tr><td><code id="check.functions_+3A_rnull">rnull</code></td>
<td>
<p>routine to generate data under the null hypothesis</p>
</td></tr>
<tr><td><code id="check.functions_+3A_phat">phat</code></td>
<td>
<p>=function(x) -99, function to estimate parameters from the data, or -99</p>
</td></tr>
<tr><td><code id="check.functions_+3A_vals">vals</code></td>
<td>
<p>vector of discrete values</p>
</td></tr>
<tr><td><code id="check.functions_+3A_x">x</code></td>
<td>
<p>data</p>
</td></tr>
</table>

<hr>
<h2 id='chi_power_cont'>This function finds the power of various chi-square tests for continuous data</h2><span id='topic+chi_power_cont'></span>

<h3>Description</h3>

<p>This function finds the power of various chi-square tests for continuous data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chi_power_cont(
  pnull,
  ralt,
  param_alt,
  qnull = NA,
  phat = function(x) -99,
  w = function(x) -99,
  alpha = 0.05,
  Range = c(-99999, 99999),
  B = 1000,
  nbins = c(50, 10),
  rate = 0,
  minexpcount = 5,
  ChiUsePhat = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="chi_power_cont_+3A_pnull">pnull</code></td>
<td>
<p>function to find cdf under  null hypothesis</p>
</td></tr>
<tr><td><code id="chi_power_cont_+3A_ralt">ralt</code></td>
<td>
<p>function to generate data under  alternative hypothesis</p>
</td></tr>
<tr><td><code id="chi_power_cont_+3A_param_alt">param_alt</code></td>
<td>
<p>vector of parameter values for distribution under alternative hypothesis</p>
</td></tr>
<tr><td><code id="chi_power_cont_+3A_qnull">qnull</code></td>
<td>
<p>=NA function to find quantiles under null hypothesis, if available</p>
</td></tr>
<tr><td><code id="chi_power_cont_+3A_phat">phat</code></td>
<td>
<p>=function(x) -99, function to estimate parameters</p>
</td></tr>
<tr><td><code id="chi_power_cont_+3A_w">w</code></td>
<td>
<p>=function(x) -99, optional weight function</p>
</td></tr>
<tr><td><code id="chi_power_cont_+3A_alpha">alpha</code></td>
<td>
<p>=0.05, the level of the hypothesis test</p>
</td></tr>
<tr><td><code id="chi_power_cont_+3A_range">Range</code></td>
<td>
<p>=c(-99999, 99999) limits of possible observations, if any</p>
</td></tr>
<tr><td><code id="chi_power_cont_+3A_b">B</code></td>
<td>
<p>=1000 number of simulation runs to find power</p>
</td></tr>
<tr><td><code id="chi_power_cont_+3A_nbins">nbins</code></td>
<td>
<p>=c(50,10), number of bins for chi square tests</p>
</td></tr>
<tr><td><code id="chi_power_cont_+3A_rate">rate</code></td>
<td>
<p>=0 rate of Poisson if sample size is random, 0 if sample size is fixed</p>
</td></tr>
<tr><td><code id="chi_power_cont_+3A_minexpcount">minexpcount</code></td>
<td>
<p>=5 minimal expected bin count required</p>
</td></tr>
<tr><td><code id="chi_power_cont_+3A_chiusephat">ChiUsePhat</code></td>
<td>
<p>=TRUE, if TRUE param is estimated parameters and no minimization is used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric matrix of power values.
</p>

<hr>
<h2 id='chi_power_disc'>This function finds the power of various chi-square tests for continuous data</h2><span id='topic+chi_power_disc'></span>

<h3>Description</h3>

<p>This function finds the power of various chi-square tests for continuous data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chi_power_disc(
  pnull,
  ralt,
  param_alt,
  phat = function(x) -99,
  alpha = 0.05,
  B = 1000,
  nbins = c(50, 10),
  rate = 0,
  minexpcount = 5,
  ChiUsePhat = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="chi_power_disc_+3A_pnull">pnull</code></td>
<td>
<p>function to find cdf under  null hypothesis</p>
</td></tr>
<tr><td><code id="chi_power_disc_+3A_ralt">ralt</code></td>
<td>
<p>function to generate data under  alternative hypothesis</p>
</td></tr>
<tr><td><code id="chi_power_disc_+3A_param_alt">param_alt</code></td>
<td>
<p>vector of parameter values for distribution under alternative hypothesis</p>
</td></tr>
<tr><td><code id="chi_power_disc_+3A_phat">phat</code></td>
<td>
<p>=function(x) -99, routine to estimate parameters</p>
</td></tr>
<tr><td><code id="chi_power_disc_+3A_alpha">alpha</code></td>
<td>
<p>=0.05, the level of the hypothesis test</p>
</td></tr>
<tr><td><code id="chi_power_disc_+3A_b">B</code></td>
<td>
<p>=1000 number of simulation runs to find power</p>
</td></tr>
<tr><td><code id="chi_power_disc_+3A_nbins">nbins</code></td>
<td>
<p>=c(50,10), number of bins for chi square tests</p>
</td></tr>
<tr><td><code id="chi_power_disc_+3A_rate">rate</code></td>
<td>
<p>=0 rate of Poisson if sample size is random, 0 if sample size is fixed</p>
</td></tr>
<tr><td><code id="chi_power_disc_+3A_minexpcount">minexpcount</code></td>
<td>
<p>=5 minimal expected bin count required</p>
</td></tr>
<tr><td><code id="chi_power_disc_+3A_chiusephat">ChiUsePhat</code></td>
<td>
<p>= TRUE, should chi square use minimum chi square method?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric matrix of power values.
</p>

<hr>
<h2 id='chi_test_cont'>This function performs a number of chi-square gof tests for continuous data</h2><span id='topic+chi_test_cont'></span>

<h3>Description</h3>

<p>This function performs a number of chi-square gof tests for continuous data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chi_test_cont(
  x,
  pnull,
  w = function(x) -99,
  phat = function(x) -99,
  qnull = NA,
  nbins = c(50, 10),
  rate = 0,
  Range = c(-99999, 99999),
  minexpcount = 5,
  ChiUsePhat = TRUE,
  allbins
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="chi_test_cont_+3A_x">x</code></td>
<td>
<p>data set</p>
</td></tr>
<tr><td><code id="chi_test_cont_+3A_pnull">pnull</code></td>
<td>
<p>cdf under the null hypothesis</p>
</td></tr>
<tr><td><code id="chi_test_cont_+3A_w">w</code></td>
<td>
<p>function to find weights of observations, returns -99 if data is unweighted</p>
</td></tr>
<tr><td><code id="chi_test_cont_+3A_phat">phat</code></td>
<td>
<p>=function(x) -99, estimated parameters, or starting values of multi-D minimum chi square minimization, or -99 if no estimation is done</p>
</td></tr>
<tr><td><code id="chi_test_cont_+3A_qnull">qnull</code></td>
<td>
<p>=NA quantile function, if available</p>
</td></tr>
<tr><td><code id="chi_test_cont_+3A_nbins">nbins</code></td>
<td>
<p>=c(50, 10) number of bins for chi-square tests</p>
</td></tr>
<tr><td><code id="chi_test_cont_+3A_rate">rate</code></td>
<td>
<p>=0, rate of Poisson if sample size is random</p>
</td></tr>
<tr><td><code id="chi_test_cont_+3A_range">Range</code></td>
<td>
<p>=c(-99999, 99999) limits of possible observations, if any</p>
</td></tr>
<tr><td><code id="chi_test_cont_+3A_minexpcount">minexpcount</code></td>
<td>
<p>=5 minimal expected bin count required</p>
</td></tr>
<tr><td><code id="chi_test_cont_+3A_chiusephat">ChiUsePhat</code></td>
<td>
<p>=TRUE, if TRUE param is estimated parameters and no minimization is used</p>
</td></tr>
<tr><td><code id="chi_test_cont_+3A_allbins">allbins</code></td>
<td>
<p>set of bins to use</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric matrix of test statistics, degrees of freedom and p.values
</p>

<hr>
<h2 id='chi_test_disc'>This function performs a number of chi-square gof tests for continuous data</h2><span id='topic+chi_test_disc'></span>

<h3>Description</h3>

<p>This function performs a number of chi-square gof tests for continuous data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chi_test_disc(
  x,
  pnull,
  phat = function(x) -99,
  nbins = c(50, 10),
  rate = 0,
  minexpcount = 5,
  ChiUsePhat = TRUE,
  allbins
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="chi_test_disc_+3A_x">x</code></td>
<td>
<p>data set</p>
</td></tr>
<tr><td><code id="chi_test_disc_+3A_pnull">pnull</code></td>
<td>
<p>cdf under the null hypothesis</p>
</td></tr>
<tr><td><code id="chi_test_disc_+3A_phat">phat</code></td>
<td>
<p>=function(x) -99, function to estimate parameters, or starting values of multi-D minimum chi square minimization, or -99 if no parameters are estimated</p>
</td></tr>
<tr><td><code id="chi_test_disc_+3A_nbins">nbins</code></td>
<td>
<p>=c(50, 10) number of bins for chi-square tests</p>
</td></tr>
<tr><td><code id="chi_test_disc_+3A_rate">rate</code></td>
<td>
<p>=0, rate of Poisson if sample size is random</p>
</td></tr>
<tr><td><code id="chi_test_disc_+3A_minexpcount">minexpcount</code></td>
<td>
<p>=5 minimal expected bin count required</p>
</td></tr>
<tr><td><code id="chi_test_disc_+3A_chiusephat">ChiUsePhat</code></td>
<td>
<p>= TRUE, if TRUE param is estimated parameter, otherwise minimum chi square method is used.</p>
</td></tr>
<tr><td><code id="chi_test_disc_+3A_allbins">allbins</code></td>
<td>
<p>set of bins to use</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric matrix of test statistics, degrees of freedom and p.values
</p>

<hr>
<h2 id='Cpporder'>sort vector y by values in vector x</h2><span id='topic+Cpporder'></span>

<h3>Description</h3>

<p>sort vector y by values in vector x
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Cpporder(y, x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Cpporder_+3A_y">y</code></td>
<td>
<p>numeric vector</p>
</td></tr>
<tr><td><code id="Cpporder_+3A_x">x</code></td>
<td>
<p>numeric vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric vector
</p>

<hr>
<h2 id='gof_cont'>run gof tests for continuous data</h2><span id='topic+gof_cont'></span>

<h3>Description</h3>

<p>run gof tests for continuous data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gof_cont(x, pnull, rnull, phat, TS, typeTS, TSextra, B = 5000L)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gof_cont_+3A_x">x</code></td>
<td>
<p>A numeric vector of data</p>
</td></tr>
<tr><td><code id="gof_cont_+3A_pnull">pnull</code></td>
<td>
<p>R function (cdf)</p>
</td></tr>
<tr><td><code id="gof_cont_+3A_rnull">rnull</code></td>
<td>
<p>R function (generate data under null hypothesis)</p>
</td></tr>
<tr><td><code id="gof_cont_+3A_phat">phat</code></td>
<td>
<p>function to set or estimate parameters of pnull</p>
</td></tr>
<tr><td><code id="gof_cont_+3A_ts">TS</code></td>
<td>
<p>function that calculates test statistics</p>
</td></tr>
<tr><td><code id="gof_cont_+3A_typets">typeTS</code></td>
<td>
<p>integer indicating type of test statistic</p>
</td></tr>
<tr><td><code id="gof_cont_+3A_tsextra">TSextra</code></td>
<td>
<p>list to pass to TS</p>
</td></tr>
<tr><td><code id="gof_cont_+3A_b">B</code></td>
<td>
<p>(=5000) Number of simulation runs</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of numbers
</p>

<hr>
<h2 id='gof_disc'>run gof tests for discrete data</h2><span id='topic+gof_disc'></span>

<h3>Description</h3>

<p>run gof tests for discrete data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gof_disc(x, pnull, rnull, vals, phat, TS, typeTS, TSextra, rate = 0, B = 5000L)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gof_disc_+3A_x">x</code></td>
<td>
<p>an integer vector of counts</p>
</td></tr>
<tr><td><code id="gof_disc_+3A_pnull">pnull</code></td>
<td>
<p>cumulative distribution function under the null hypothesis</p>
</td></tr>
<tr><td><code id="gof_disc_+3A_rnull">rnull</code></td>
<td>
<p>R function (generate data under null hypothesis)</p>
</td></tr>
<tr><td><code id="gof_disc_+3A_vals">vals</code></td>
<td>
<p>numeric vector of values of discrete random variables.</p>
</td></tr>
<tr><td><code id="gof_disc_+3A_phat">phat</code></td>
<td>
<p>function to estimate parameters</p>
</td></tr>
<tr><td><code id="gof_disc_+3A_ts">TS</code></td>
<td>
<p>function that calculates test statistics</p>
</td></tr>
<tr><td><code id="gof_disc_+3A_typets">typeTS</code></td>
<td>
<p>type of test statistic</p>
</td></tr>
<tr><td><code id="gof_disc_+3A_tsextra">TSextra</code></td>
<td>
<p>list passed to TS, if desired</p>
</td></tr>
<tr><td><code id="gof_disc_+3A_rate">rate</code></td>
<td>
<p>=0, rate of sample size, if random</p>
</td></tr>
<tr><td><code id="gof_disc_+3A_b">B</code></td>
<td>
<p>(=5000) Number of simulation runs</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of numbers
</p>

<hr>
<h2 id='gof_power'>Find the power of various gof tests for continuous data.</h2><span id='topic+gof_power'></span>

<h3>Description</h3>

<p>Find the power of various gof tests for continuous data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gof_power(
  pnull,
  vals = NA,
  rnull,
  ralt,
  param_alt,
  w = function(x) -99,
  phat = function(x) -99,
  TS,
  TSextra = NA,
  alpha = 0.05,
  Range = c(-Inf, Inf),
  B = 1000,
  nbins = c(50, 10),
  rate = 0,
  maxProcessor,
  minexpcount = 5,
  ChiUsePhat = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gof_power_+3A_pnull">pnull</code></td>
<td>
<p>function to find cdf under  null hypothesis</p>
</td></tr>
<tr><td><code id="gof_power_+3A_vals">vals</code></td>
<td>
<p>=NA, values of rv, if data is discrete, NA if data is continuous</p>
</td></tr>
<tr><td><code id="gof_power_+3A_rnull">rnull</code></td>
<td>
<p>function to generate data under  null hypothesis</p>
</td></tr>
<tr><td><code id="gof_power_+3A_ralt">ralt</code></td>
<td>
<p>function to generate data under  alternative hypothesis</p>
</td></tr>
<tr><td><code id="gof_power_+3A_param_alt">param_alt</code></td>
<td>
<p>vector of parameter values for distribution under alternative hypothesis</p>
</td></tr>
<tr><td><code id="gof_power_+3A_w">w</code></td>
<td>
<p>(Optional) function to calculate weights, returns -99 if no weights</p>
</td></tr>
<tr><td><code id="gof_power_+3A_phat">phat</code></td>
<td>
<p>=function(x) -99 function to estimate parameters from the data, or -99</p>
</td></tr>
<tr><td><code id="gof_power_+3A_ts">TS</code></td>
<td>
<p>user supplied function to find test statistics</p>
</td></tr>
<tr><td><code id="gof_power_+3A_tsextra">TSextra</code></td>
<td>
<p>=NA, list provided to TS</p>
</td></tr>
<tr><td><code id="gof_power_+3A_alpha">alpha</code></td>
<td>
<p>=0.05, the level of the hypothesis test</p>
</td></tr>
<tr><td><code id="gof_power_+3A_range">Range</code></td>
<td>
<p>=c(-Inf, Inf) limits of possible observations, if any</p>
</td></tr>
<tr><td><code id="gof_power_+3A_b">B</code></td>
<td>
<p>=1000 number of simulation runs</p>
</td></tr>
<tr><td><code id="gof_power_+3A_nbins">nbins</code></td>
<td>
<p>=c(100,10), number of bins for chi square tests.</p>
</td></tr>
<tr><td><code id="gof_power_+3A_rate">rate</code></td>
<td>
<p>=0 rate of Poisson if sample size is random, 0 if sample size is fixed</p>
</td></tr>
<tr><td><code id="gof_power_+3A_maxprocessor">maxProcessor</code></td>
<td>
<p>maximum of number of processors to use, 1 if no parallel processing is needed or number of cores-1 if missing</p>
</td></tr>
<tr><td><code id="gof_power_+3A_minexpcount">minexpcount</code></td>
<td>
<p>=5 minimal expected bin count required</p>
</td></tr>
<tr><td><code id="gof_power_+3A_chiusephat">ChiUsePhat</code></td>
<td>
<p>= TRUE, if TRUE param is estimated parameter, otherwise minimum chi square method is used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric matrix of power values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Power of tests when null hypothesis specifies the standard normal distribution but 
# true data comes from a normal distribution with mean different from 0.
pnull = function(x) pnorm(x)
rnull = function()  rnorm(50)
ralt = function(mu)  rnorm(50, mu)
TSextra = list(qnull=function(x) qnorm(x))
gof_power(pnull, NA, rnull, ralt, c(0.25, 0.5), TSextra=TSextra, B=200)
# Power of tests when null hypothesis specifies normal distribution and 
# mean and standard deviation are estimated from the data. 
# Example is not run because it takes several minutes.
# true data comes from a normal distribution with mean different from 0.
pnull = function(x, p=c(0, 1)) pnorm(x, p[1], ifelse(p[2]&gt;0.001, p[2], 0.001))
rnull = function(p=c(0, 1))  rnorm(50, p[1], ifelse(p[2]&gt;0.001, p[2], 0.001))
phat = function(x) c(mean(x), sd(x))
TSextra = list(qnull = function(x, p=c(0, 1)) qnorm(x, p[1],  
               ifelse(p[2]&gt;0.001, p[2], 0.001))) 
gof_power(pnull, NA, rnull, ralt, c(0, 1), phat=phat, TSextra=TSextra, B=200)
# Power of tests when null hypothesis specifies Poisson rv with rate 100 and 
# true rate is 100.5
vals = 0:250
pnull = function() ppois(0:250, 100)
rnull =function () table(c(0:250, rpois(1000, 100)))-1
ralt =function (p) table(c(0:250, rpois(1000, p)))-1
gof_power(pnull, vals, rnull, ralt, param_alt=100.5,  B=200)
# Power of tests when null hypothesis specifies a Binomial n=10 distribution 
# with the success probability estimated
vals = 0:10
pnull=function(p) pbinom(0:10, 10, ifelse(0&lt;p&amp;p&lt;1, p, 0.001))
rnull=function(p) table(c(0:10, rbinom(1000, 10, ifelse(0&lt;p&amp;p&lt;1, p, 0.001))))-1
ralt=function(p) table(c(0:10, rbinom(1000, 10, p)))-1
phat=function(x) mean(rep(0:10,x))/10
gof_power(pnull, vals, rnull, ralt, c(0.5, 0.6), phat=phat, B=200)

</code></pre>

<hr>
<h2 id='gof_power_cont'>Find the power of various gof tests for continuous data.</h2><span id='topic+gof_power_cont'></span>

<h3>Description</h3>

<p>Find the power of various gof tests for continuous data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gof_power_cont(
  pnull,
  rnull,
  ralt,
  param_alt,
  w = function(x) -99,
  phat = function(x) -99,
  TS,
  TSextra = NA,
  alpha = 0.05,
  Range = c(-Inf, Inf),
  B = 1000,
  nbins = c(100, 10),
  rate = 0,
  maxProcessor,
  minexpcount = 5,
  ChiUsePhat = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gof_power_cont_+3A_pnull">pnull</code></td>
<td>
<p>function to find cdf under  null hypothesis</p>
</td></tr>
<tr><td><code id="gof_power_cont_+3A_rnull">rnull</code></td>
<td>
<p>function to generate data under  null hypothesis</p>
</td></tr>
<tr><td><code id="gof_power_cont_+3A_ralt">ralt</code></td>
<td>
<p>function to generate data under  alternative hypothesis</p>
</td></tr>
<tr><td><code id="gof_power_cont_+3A_param_alt">param_alt</code></td>
<td>
<p>vector of parameter values for distribution under alternative hypothesis</p>
</td></tr>
<tr><td><code id="gof_power_cont_+3A_w">w</code></td>
<td>
<p>=function(x) -99, function to calculate weights, returns -99 if no weights</p>
</td></tr>
<tr><td><code id="gof_power_cont_+3A_phat">phat</code></td>
<td>
<p>=function(x) -99, function to estimate parameters from the data, or -99 if no parameters aare estimated</p>
</td></tr>
<tr><td><code id="gof_power_cont_+3A_ts">TS</code></td>
<td>
<p>user supplied function to find test statistics, if any</p>
</td></tr>
<tr><td><code id="gof_power_cont_+3A_tsextra">TSextra</code></td>
<td>
<p>=NA, list provided to TS</p>
</td></tr>
<tr><td><code id="gof_power_cont_+3A_alpha">alpha</code></td>
<td>
<p>=0.05, the level of the hypothesis test</p>
</td></tr>
<tr><td><code id="gof_power_cont_+3A_range">Range</code></td>
<td>
<p>=c(-Inf, Inf) limits of possible observations, if any</p>
</td></tr>
<tr><td><code id="gof_power_cont_+3A_b">B</code></td>
<td>
<p>=1000 number of simulation runs</p>
</td></tr>
<tr><td><code id="gof_power_cont_+3A_nbins">nbins</code></td>
<td>
<p>=c(100,10), number of bins for chi square tests.</p>
</td></tr>
<tr><td><code id="gof_power_cont_+3A_rate">rate</code></td>
<td>
<p>=0 rate of Poisson if sample size is random, 0 if sample size is fixed</p>
</td></tr>
<tr><td><code id="gof_power_cont_+3A_maxprocessor">maxProcessor</code></td>
<td>
<p>maximum of number of processors to use, 1 if no parallel processing is needed or number of cores-1 if missing</p>
</td></tr>
<tr><td><code id="gof_power_cont_+3A_minexpcount">minexpcount</code></td>
<td>
<p>=5 minimal expected bin count required</p>
</td></tr>
<tr><td><code id="gof_power_cont_+3A_chiusephat">ChiUsePhat</code></td>
<td>
<p>=TRUE, if TRUE param is estimated parameter, otherwise minimum chi square method is used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric matrix of power values.
</p>

<hr>
<h2 id='gof_power_disc'>Find the power of various gof tests for discrete data.</h2><span id='topic+gof_power_disc'></span>

<h3>Description</h3>

<p>Find the power of various gof tests for discrete data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gof_power_disc(
  pnull,
  rnull,
  vals,
  ralt,
  param_alt,
  phat = function(x) -99,
  TS,
  TSextra = NA,
  alpha = 0.05,
  B = 1000,
  nbins = c(100, 10),
  rate = 0,
  maxProcessor,
  minexpcount = 5,
  ChiUsePhat = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gof_power_disc_+3A_pnull">pnull</code></td>
<td>
<p>cumulative distribution function under the null hypothesis</p>
</td></tr>
<tr><td><code id="gof_power_disc_+3A_rnull">rnull</code></td>
<td>
<p>a function to generate data under  null hypothesis</p>
</td></tr>
<tr><td><code id="gof_power_disc_+3A_vals">vals</code></td>
<td>
<p>values of discrete rv.</p>
</td></tr>
<tr><td><code id="gof_power_disc_+3A_ralt">ralt</code></td>
<td>
<p>function to generate data under  alternative hypothesis</p>
</td></tr>
<tr><td><code id="gof_power_disc_+3A_param_alt">param_alt</code></td>
<td>
<p>vector of parameter values for distribution under alternative hypothesis</p>
</td></tr>
<tr><td><code id="gof_power_disc_+3A_phat">phat</code></td>
<td>
<p>=function(x) -99, function to estimate parameters from the data, -99 if no parameters are estimated</p>
</td></tr>
<tr><td><code id="gof_power_disc_+3A_ts">TS</code></td>
<td>
<p>user supplied function to find test statistics, if any</p>
</td></tr>
<tr><td><code id="gof_power_disc_+3A_tsextra">TSextra</code></td>
<td>
<p>=NA, list passed to TS, if desired</p>
</td></tr>
<tr><td><code id="gof_power_disc_+3A_alpha">alpha</code></td>
<td>
<p>=0.05, the level of the hypothesis test</p>
</td></tr>
<tr><td><code id="gof_power_disc_+3A_b">B</code></td>
<td>
<p>=1000 number of simulation runs</p>
</td></tr>
<tr><td><code id="gof_power_disc_+3A_nbins">nbins</code></td>
<td>
<p>=c(100, 10) number of bins for chi square tests</p>
</td></tr>
<tr><td><code id="gof_power_disc_+3A_rate">rate</code></td>
<td>
<p>rate of Poisson if sample size is random</p>
</td></tr>
<tr><td><code id="gof_power_disc_+3A_maxprocessor">maxProcessor</code></td>
<td>
<p>maximum of number of processors to use, 1 if no parallel processing is needed or number of cores-1 if missing</p>
</td></tr>
<tr><td><code id="gof_power_disc_+3A_minexpcount">minexpcount</code></td>
<td>
<p>=5 minimal number of expected counts in each bin for chi square tests</p>
</td></tr>
<tr><td><code id="gof_power_disc_+3A_chiusephat">ChiUsePhat</code></td>
<td>
<p>= TRUE, if TRUE param is estimated parameter, otherwise minimum chi square method is used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric matrix of power values.
</p>

<hr>
<h2 id='gof_test'>This function performs a number of gof tests</h2><span id='topic+gof_test'></span>

<h3>Description</h3>

<p>This function performs a number of gof tests
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gof_test(
  x,
  vals = NA,
  pnull,
  rnull,
  w = function(x) -99,
  phat = function(x) -99,
  TS,
  TSextra = NA,
  nbins = c(50, 10),
  rate = 0,
  Range = c(-Inf, Inf),
  B = 5000,
  minexpcount = 5,
  ChiUsePhat = TRUE,
  maxProcessor = 1,
  doMethods = "all"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gof_test_+3A_x">x</code></td>
<td>
<p>data set</p>
</td></tr>
<tr><td><code id="gof_test_+3A_vals">vals</code></td>
<td>
<p>=NA, values of discrete RV, or NA if data is continuous</p>
</td></tr>
<tr><td><code id="gof_test_+3A_pnull">pnull</code></td>
<td>
<p>cdf under the null hypothesis</p>
</td></tr>
<tr><td><code id="gof_test_+3A_rnull">rnull</code></td>
<td>
<p>routine to generate data under the null hypothesis</p>
</td></tr>
<tr><td><code id="gof_test_+3A_w">w</code></td>
<td>
<p>(Optional) function to calculate weights, returns -99 if no weights</p>
</td></tr>
<tr><td><code id="gof_test_+3A_phat">phat</code></td>
<td>
<p>=function(x) -99, function to estimate parameters from the data, or -99 if no parameters are estimated</p>
</td></tr>
<tr><td><code id="gof_test_+3A_ts">TS</code></td>
<td>
<p>user supplied function to find test statistics, if any</p>
</td></tr>
<tr><td><code id="gof_test_+3A_tsextra">TSextra</code></td>
<td>
<p>=NA, list passed to TS, if desired, or NA</p>
</td></tr>
<tr><td><code id="gof_test_+3A_nbins">nbins</code></td>
<td>
<p>=c(100, 10) number of bins for chi-square tests</p>
</td></tr>
<tr><td><code id="gof_test_+3A_rate">rate</code></td>
<td>
<p>=0 rate of Poisson if sample size is random, 0 if sample size is fixed</p>
</td></tr>
<tr><td><code id="gof_test_+3A_range">Range</code></td>
<td>
<p>=c(-Inf, Inf) limits of possible observations, if any, for chi-square tests</p>
</td></tr>
<tr><td><code id="gof_test_+3A_b">B</code></td>
<td>
<p>=5000  number of simulation runs</p>
</td></tr>
<tr><td><code id="gof_test_+3A_minexpcount">minexpcount</code></td>
<td>
<p>=5 minimal expected bin count required</p>
</td></tr>
<tr><td><code id="gof_test_+3A_chiusephat">ChiUsePhat</code></td>
<td>
<p>= TRUE, if TRUE param is estimated parameter, otherwise minimum chi square method is used.</p>
</td></tr>
<tr><td><code id="gof_test_+3A_maxprocessor">maxProcessor</code></td>
<td>
<p>=1, number of processors to use in parallel processing.</p>
</td></tr>
<tr><td><code id="gof_test_+3A_domethods">doMethods</code></td>
<td>
<p>Methods to include in tests</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with vectors of test statistics and p.values
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Tests to see whether data comes from a standard normal distribution.
pnull = function(x) pnorm(x)
rnull = function()  rnorm(100)
x = rnorm(100)
gof_test(x, NA, pnull, rnull, B=500)
# Tests to see whether data comes from a normal distribution with standard deviation 1 
# and the mean estimated.
pnull=function(x, m) pnorm(x, m)
rnull=function(m) rnorm(100, m)
TSextra = list(qnull=function(x, m=0) qnorm(x, m), 
          pnull=function(x, m=0) pnorm(x, m), phat=function(x) mean(x))
phat=function(x) mean(x)
x = rnorm(100, 1, 2)
gof_test(x, NA, pnull, rnull, phat=phat, TSextra=TSextra, B=500)
# Tests to see whether data comes from a binomial (10, 0.5) distribution.
vals=0:10
pnull = function() pbinom(0:10, 10, 0.5)
rnull = function() table(c(0:10, rbinom(1000, 10, 0.5)))-1
x = rnull() 
gof_test(x, vals, pnull, rnull, doMethods="all", B=500)
# Tests to see whether data comes from a binomial distribution with 
# the success probability estimated from the data.
pnull = function(p=0.5) pbinom(0:10, 10, ifelse(p&gt;0&amp;&amp;p&lt;1, p, 0.001))
rnull = function(p=0.5) table(c(0:10, rbinom(1000, 10, 
                  ifelse(p&gt;0&amp;&amp;p&lt;1, p, 0.001))))-1
phat=function(x) mean(rep(0:10,x))/10 
gof_test(x, vals, pnull, rnull, phat=phat, B=500) 

</code></pre>

<hr>
<h2 id='gof_test_adjusted_pvalue'>This function performs a number of gof tests and finds the adjusted p value for the combined test</h2><span id='topic+gof_test_adjusted_pvalue'></span>

<h3>Description</h3>

<p>This function performs a number of gof tests and finds the adjusted p value for the combined test
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gof_test_adjusted_pvalue(
  x,
  vals = NA,
  pnull,
  rnull,
  w = function(x) -99,
  phat = function(x) -99,
  TS,
  TSextra = NA,
  nbins = c(50, 10),
  rate = 0,
  Range = c(-Inf, Inf),
  B = c(5000, 1000),
  minexpcount = 5,
  ChiUsePhat = TRUE,
  doMethods
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gof_test_adjusted_pvalue_+3A_x">x</code></td>
<td>
<p>data set</p>
</td></tr>
<tr><td><code id="gof_test_adjusted_pvalue_+3A_vals">vals</code></td>
<td>
<p>=NA, values of discrete RV, or NA if data is continuous</p>
</td></tr>
<tr><td><code id="gof_test_adjusted_pvalue_+3A_pnull">pnull</code></td>
<td>
<p>cdf under the null hypothesis</p>
</td></tr>
<tr><td><code id="gof_test_adjusted_pvalue_+3A_rnull">rnull</code></td>
<td>
<p>routine to generate data under the null hypothesis</p>
</td></tr>
<tr><td><code id="gof_test_adjusted_pvalue_+3A_w">w</code></td>
<td>
<p>(Optional) function to calculate weights, returns -99 if no weights</p>
</td></tr>
<tr><td><code id="gof_test_adjusted_pvalue_+3A_phat">phat</code></td>
<td>
<p>=function(x) -99, function to estimate parameters from the data, or -99 if no parameters are estimated</p>
</td></tr>
<tr><td><code id="gof_test_adjusted_pvalue_+3A_ts">TS</code></td>
<td>
<p>user supplied function to find test statistics, if any</p>
</td></tr>
<tr><td><code id="gof_test_adjusted_pvalue_+3A_tsextra">TSextra</code></td>
<td>
<p>=NA, list passed to TS, if desired, or NA</p>
</td></tr>
<tr><td><code id="gof_test_adjusted_pvalue_+3A_nbins">nbins</code></td>
<td>
<p>=c(100, 10) number of bins for chi-square tests</p>
</td></tr>
<tr><td><code id="gof_test_adjusted_pvalue_+3A_rate">rate</code></td>
<td>
<p>=0 rate of Poisson if sample size is random, 0 if sample size is fixed</p>
</td></tr>
<tr><td><code id="gof_test_adjusted_pvalue_+3A_range">Range</code></td>
<td>
<p>=c(-Inf, Inf) limits of possible observations, if any, for chi-square tests</p>
</td></tr>
<tr><td><code id="gof_test_adjusted_pvalue_+3A_b">B</code></td>
<td>
<p>=c(5000,1000)  number of simulation runs for individual and for adjusted p values</p>
</td></tr>
<tr><td><code id="gof_test_adjusted_pvalue_+3A_minexpcount">minexpcount</code></td>
<td>
<p>=5 minimal expected bin count required</p>
</td></tr>
<tr><td><code id="gof_test_adjusted_pvalue_+3A_chiusephat">ChiUsePhat</code></td>
<td>
<p>= TRUE, if TRUE param is estimated parameter, otherwise minimum chi square method is used.</p>
</td></tr>
<tr><td><code id="gof_test_adjusted_pvalue_+3A_domethods">doMethods</code></td>
<td>
<p>Methods to include in tests</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Tests to see whether data comes from a standard normal distribution.
pnull = function(x) pnorm(x)
rnull = function()  rnorm(100)
x = rnorm(100)
gof_test_adjusted_pvalue(x, NA, pnull, rnull, B=c(500, 200))
# Tests to see whether data comes from a normal distribution with standard deviation 1 
# and the mean estimated.
pnull=function(x, m) pnorm(x, m)
rnull=function(m) rnorm(100, m)
TSextra = list(qnull=function(x, m=0) qnorm(x, m), 
          pnull=function(x, m=0) pnorm(x, m), phat=function(x) mean(x))
phat=function(x) mean(x)
x = rnorm(100, 1, 2)
gof_test_adjusted_pvalue(x, NA, pnull, rnull, phat=phat, TSextra=TSextra, B=c(500, 200))
# Tests to see whether data comes from a binomial (10, 0.5) distribution.
vals=0:10
pnull = function() pbinom(0:10, 10, 0.5)
rnull = function() table(c(0:10, rbinom(1000, 10, 0.5)))-1
x = rnull() 
gof_test_adjusted_pvalue(x, vals, pnull, rnull, B=c(500, 200))
# Tests to see whether data comes from a binomial distribution with 
# the success probability estimated from the data.
pnull = function(p=0.5) pbinom(0:10, 10, ifelse(p&gt;0&amp;&amp;p&lt;1, p, 0.001))
rnull = function(p=0.5) table(c(0:10, rbinom(1000, 10, 
                  ifelse(p&gt;0&amp;&amp;p&lt;1, p, 0.001))))-1
phat=function(x) mean(rep(0:10,x))/10 
gof_test_adjusted_pvalue(x, vals, pnull, rnull, phat=phat, B=c(500, 200)) 

</code></pre>

<hr>
<h2 id='gof_test_cont'>This function performs a number of gof tests for continuous data</h2><span id='topic+gof_test_cont'></span>

<h3>Description</h3>

<p>This function performs a number of gof tests for continuous data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gof_test_cont(
  x,
  pnull,
  rnull,
  w = function(x) -99,
  phat = function(x) -99,
  TS,
  TSextra = NA,
  nbins = c(50, 10),
  rate = 0,
  Range = c(-Inf, Inf),
  B = 5000,
  minexpcount = 5,
  ChiUsePhat = TRUE,
  maxProcessor = 1,
  doMethods = "all"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gof_test_cont_+3A_x">x</code></td>
<td>
<p>data set</p>
</td></tr>
<tr><td><code id="gof_test_cont_+3A_pnull">pnull</code></td>
<td>
<p>cdf under the null hypothesis</p>
</td></tr>
<tr><td><code id="gof_test_cont_+3A_rnull">rnull</code></td>
<td>
<p>routine to generate data under the null hypothesis</p>
</td></tr>
<tr><td><code id="gof_test_cont_+3A_w">w</code></td>
<td>
<p>(Optional) function to calculate weights, returns -99 if no weights</p>
</td></tr>
<tr><td><code id="gof_test_cont_+3A_phat">phat</code></td>
<td>
<p>=function(x) -99, function to estimate parameters from the data, or -99 if no parameters aare estimated</p>
</td></tr>
<tr><td><code id="gof_test_cont_+3A_ts">TS</code></td>
<td>
<p>user supplied function to find test statistics, if any</p>
</td></tr>
<tr><td><code id="gof_test_cont_+3A_tsextra">TSextra</code></td>
<td>
<p>=NA, list passed to TS, if desired</p>
</td></tr>
<tr><td><code id="gof_test_cont_+3A_nbins">nbins</code></td>
<td>
<p>=c(50, 10) number of bins for chi-square tests</p>
</td></tr>
<tr><td><code id="gof_test_cont_+3A_rate">rate</code></td>
<td>
<p>=0 rate of Poisson if sample size is random, 0 if sample size is fixed</p>
</td></tr>
<tr><td><code id="gof_test_cont_+3A_range">Range</code></td>
<td>
<p>=c(-Inf, Inf) limits of possible observations, if any, for chi-square tests</p>
</td></tr>
<tr><td><code id="gof_test_cont_+3A_b">B</code></td>
<td>
<p>=5000  number of simulation runs</p>
</td></tr>
<tr><td><code id="gof_test_cont_+3A_minexpcount">minexpcount</code></td>
<td>
<p>=5 minimal expected bin count required</p>
</td></tr>
<tr><td><code id="gof_test_cont_+3A_chiusephat">ChiUsePhat</code></td>
<td>
<p>=TRUE, if TRUE param is estimated parameter, otherwise minimum chi square method is used.</p>
</td></tr>
<tr><td><code id="gof_test_cont_+3A_maxprocessor">maxProcessor</code></td>
<td>
<p>=1, number of processors to use in parallel processing. If missing single processor is used.</p>
</td></tr>
<tr><td><code id="gof_test_cont_+3A_domethods">doMethods</code></td>
<td>
<p>Methods to include in tests</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with vectors of test statistics and p.values
</p>

<hr>
<h2 id='gof_test_cont_adj'>This function performs a number of gof tests for continuous data and finds the adjusted p value</h2><span id='topic+gof_test_cont_adj'></span>

<h3>Description</h3>

<p>This function performs a number of gof tests for continuous data and finds the adjusted p value
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gof_test_cont_adj(
  x,
  pnull,
  rnull,
  w = function(x) -99,
  phat = function(x) 0,
  TS,
  TSextra = NA,
  nbins = c(50, 10),
  rate = 0,
  Range = c(-Inf, Inf),
  B = c(5000, 1000),
  minexpcount = 5,
  ChiUsePhat = TRUE,
  doMethods = c("W", "ZC", "AD", "ES-s-P")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gof_test_cont_adj_+3A_x">x</code></td>
<td>
<p>data set</p>
</td></tr>
<tr><td><code id="gof_test_cont_adj_+3A_pnull">pnull</code></td>
<td>
<p>cdf under the null hypothesis</p>
</td></tr>
<tr><td><code id="gof_test_cont_adj_+3A_rnull">rnull</code></td>
<td>
<p>routine to generate data under the null hypothesis</p>
</td></tr>
<tr><td><code id="gof_test_cont_adj_+3A_w">w</code></td>
<td>
<p>=function(x) =99 (Optional) function to calculate weights, returns -99 if no weights</p>
</td></tr>
<tr><td><code id="gof_test_cont_adj_+3A_phat">phat</code></td>
<td>
<p>=function(x) -99, function to estimate parameters from the data, or -99 if no parameters aare estimated</p>
</td></tr>
<tr><td><code id="gof_test_cont_adj_+3A_ts">TS</code></td>
<td>
<p>user supplied function to find test statistics, if any</p>
</td></tr>
<tr><td><code id="gof_test_cont_adj_+3A_tsextra">TSextra</code></td>
<td>
<p>=NA, list passed to TS, if desired</p>
</td></tr>
<tr><td><code id="gof_test_cont_adj_+3A_nbins">nbins</code></td>
<td>
<p>=c(50, 10) number of bins for chi-square tests</p>
</td></tr>
<tr><td><code id="gof_test_cont_adj_+3A_rate">rate</code></td>
<td>
<p>=0 rate of Poisson if sample size is random, 0 if sample size is fixed</p>
</td></tr>
<tr><td><code id="gof_test_cont_adj_+3A_range">Range</code></td>
<td>
<p>=c(-Inf, Inf) limits of possible observations, if any, for chi-square tests</p>
</td></tr>
<tr><td><code id="gof_test_cont_adj_+3A_b">B</code></td>
<td>
<p>=c(5000,1000)  number of simulation runs for p values and for p value distribution</p>
</td></tr>
<tr><td><code id="gof_test_cont_adj_+3A_minexpcount">minexpcount</code></td>
<td>
<p>=5 minimal expected bin count required</p>
</td></tr>
<tr><td><code id="gof_test_cont_adj_+3A_chiusephat">ChiUsePhat</code></td>
<td>
<p>=TRUE, if TRUE param is estimated parameter, otherwise minimum chi square method is used.</p>
</td></tr>
<tr><td><code id="gof_test_cont_adj_+3A_domethods">doMethods</code></td>
<td>
<p>Methods to include in tests</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None
</p>

<hr>
<h2 id='gof_test_disc'>This function performs a number of gof tests for discrete data.</h2><span id='topic+gof_test_disc'></span>

<h3>Description</h3>

<p>This function performs a number of gof tests for discrete data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gof_test_disc(
  x,
  pnull,
  rnull,
  vals,
  phat = function(x) -99,
  TS,
  TSextra = NA,
  nbins = c(50, 10),
  rate = 0,
  B = 5000,
  minexpcount = 5,
  ChiUsePhat = TRUE,
  maxProcessor = 1,
  doMethods = "Default"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gof_test_disc_+3A_x">x</code></td>
<td>
<p>data set (the counts)</p>
</td></tr>
<tr><td><code id="gof_test_disc_+3A_pnull">pnull</code></td>
<td>
<p>cumulative distribution function under the null hypothesis</p>
</td></tr>
<tr><td><code id="gof_test_disc_+3A_rnull">rnull</code></td>
<td>
<p>routine to generate data under the null hypothesis</p>
</td></tr>
<tr><td><code id="gof_test_disc_+3A_vals">vals</code></td>
<td>
<p>a vector of values of discrete random variables</p>
</td></tr>
<tr><td><code id="gof_test_disc_+3A_phat">phat</code></td>
<td>
<p>=function(x) -99, function to estimate parameters from the data, or -99 if no parameters aare estimated</p>
</td></tr>
<tr><td><code id="gof_test_disc_+3A_ts">TS</code></td>
<td>
<p>=NA, user supplied function to find test statistics</p>
</td></tr>
<tr><td><code id="gof_test_disc_+3A_tsextra">TSextra</code></td>
<td>
<p>=NA, list passed to TS, if desired</p>
</td></tr>
<tr><td><code id="gof_test_disc_+3A_nbins">nbins</code></td>
<td>
<p>=c(50, 10) number of bins for chi-square tests</p>
</td></tr>
<tr><td><code id="gof_test_disc_+3A_rate">rate</code></td>
<td>
<p>=0 rate of Poisson if sample size is random, 0 if sample size is fixed</p>
</td></tr>
<tr><td><code id="gof_test_disc_+3A_b">B</code></td>
<td>
<p>=5000  number of simulation runs</p>
</td></tr>
<tr><td><code id="gof_test_disc_+3A_minexpcount">minexpcount</code></td>
<td>
<p>=5 minimal expected bin count required</p>
</td></tr>
<tr><td><code id="gof_test_disc_+3A_chiusephat">ChiUsePhat</code></td>
<td>
<p>= TRUE, if TRUE param is estimated parameter, otherwise minimum chi square method is used.</p>
</td></tr>
<tr><td><code id="gof_test_disc_+3A_maxprocessor">maxProcessor</code></td>
<td>
<p>=1, number of processors to use in parallel processing. If missing single processor is used.</p>
</td></tr>
<tr><td><code id="gof_test_disc_+3A_domethods">doMethods</code></td>
<td>
<p>Methods to include in tests</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric matrix of test statistics and p.values
</p>

<hr>
<h2 id='gof_test_disc_adj'>This function performs a number of gof tests for discrete data and finds the adjusted p value</h2><span id='topic+gof_test_disc_adj'></span>

<h3>Description</h3>

<p>This function performs a number of gof tests for discrete data and finds the adjusted p value
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gof_test_disc_adj(
  x,
  pnull,
  rnull,
  vals,
  phat = function(x) -99,
  TS,
  TSextra = NA,
  nbins = c(50, 10),
  rate = 0,
  B = c(5000, 1000),
  minexpcount = 5,
  ChiUsePhat = TRUE,
  doMethods = c("Wassp1", "W", "AD", "s-P")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gof_test_disc_adj_+3A_x">x</code></td>
<td>
<p>data set (the counts)</p>
</td></tr>
<tr><td><code id="gof_test_disc_adj_+3A_pnull">pnull</code></td>
<td>
<p>cumulative distribution function under the null hypothesis</p>
</td></tr>
<tr><td><code id="gof_test_disc_adj_+3A_rnull">rnull</code></td>
<td>
<p>routine to generate data under the null hypothesis</p>
</td></tr>
<tr><td><code id="gof_test_disc_adj_+3A_vals">vals</code></td>
<td>
<p>a vector of values of discrete random variables</p>
</td></tr>
<tr><td><code id="gof_test_disc_adj_+3A_phat">phat</code></td>
<td>
<p>=function(x) -99, function to estimate parameters from the data, or -99 if no parameters aare estimated</p>
</td></tr>
<tr><td><code id="gof_test_disc_adj_+3A_ts">TS</code></td>
<td>
<p>=NA, user supplied function to find test statistics</p>
</td></tr>
<tr><td><code id="gof_test_disc_adj_+3A_tsextra">TSextra</code></td>
<td>
<p>=NA, list passed to TS, if desired</p>
</td></tr>
<tr><td><code id="gof_test_disc_adj_+3A_nbins">nbins</code></td>
<td>
<p>=c(50, 10) number of bins for chi-square tests</p>
</td></tr>
<tr><td><code id="gof_test_disc_adj_+3A_rate">rate</code></td>
<td>
<p>=0 rate of Poisson if sample size is random, 0 if sample size is fixed</p>
</td></tr>
<tr><td><code id="gof_test_disc_adj_+3A_b">B</code></td>
<td>
<p>=c(5000, 1000)  number of simulation runs for p values and for adjusted p value</p>
</td></tr>
<tr><td><code id="gof_test_disc_adj_+3A_minexpcount">minexpcount</code></td>
<td>
<p>=5 minimal expected bin count required</p>
</td></tr>
<tr><td><code id="gof_test_disc_adj_+3A_chiusephat">ChiUsePhat</code></td>
<td>
<p>= TRUE, if TRUE param is estimated parameter, otherwise minimum chi square method is used.</p>
</td></tr>
<tr><td><code id="gof_test_disc_adj_+3A_domethods">doMethods</code></td>
<td>
<p>Methods to include in tests</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric matrix of test statistics and p.values
</p>

<hr>
<h2 id='make_bins_cont'>This function creates several type of bins for continuous data</h2><span id='topic+make_bins_cont'></span>

<h3>Description</h3>

<p>This function creates several type of bins for continuous data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_bins_cont(
  x,
  pnull,
  qnull = NA,
  phat = function(x) -99,
  DataBased = FALSE,
  nbins = c(50, 10),
  minexpcount = 5,
  Range = c(-99999, 99999)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="make_bins_cont_+3A_x">x</code></td>
<td>
<p>data set</p>
</td></tr>
<tr><td><code id="make_bins_cont_+3A_pnull">pnull</code></td>
<td>
<p>cdf under the null hypothesis</p>
</td></tr>
<tr><td><code id="make_bins_cont_+3A_qnull">qnull</code></td>
<td>
<p>=NA quantile function, if available</p>
</td></tr>
<tr><td><code id="make_bins_cont_+3A_phat">phat</code></td>
<td>
<p>=function(x) -99  parameters for pnull</p>
</td></tr>
<tr><td><code id="make_bins_cont_+3A_databased">DataBased</code></td>
<td>
<p>=FALSE bins based on data, not expected counts</p>
</td></tr>
<tr><td><code id="make_bins_cont_+3A_nbins">nbins</code></td>
<td>
<p>=c(50, 10) number of bins</p>
</td></tr>
<tr><td><code id="make_bins_cont_+3A_minexpcount">minexpcount</code></td>
<td>
<p>=5 smallest expected count per bin</p>
</td></tr>
<tr><td><code id="make_bins_cont_+3A_range">Range</code></td>
<td>
<p>=c(-99999, 99999) limits of possible observations, if any</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of bins and bin probabilities
</p>

<hr>
<h2 id='make_bins_disc'>This function creates several types of bins for discrete data</h2><span id='topic+make_bins_disc'></span>

<h3>Description</h3>

<p>This function creates several types of bins for discrete data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_bins_disc(
  x,
  pnull,
  phat = function(x) -99,
  nbins = c(50, 10),
  minexpcount = 5
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="make_bins_disc_+3A_x">x</code></td>
<td>
<p>counts</p>
</td></tr>
<tr><td><code id="make_bins_disc_+3A_pnull">pnull</code></td>
<td>
<p>cumulative distribution function</p>
</td></tr>
<tr><td><code id="make_bins_disc_+3A_phat">phat</code></td>
<td>
<p>=function(x) -99, function to estimated parameters, or -99</p>
</td></tr>
<tr><td><code id="make_bins_disc_+3A_nbins">nbins</code></td>
<td>
<p>=c(50, 10) number of bins</p>
</td></tr>
<tr><td><code id="make_bins_disc_+3A_minexpcount">minexpcount</code></td>
<td>
<p>=5 smallest expected count per bin</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of indices
</p>

<hr>
<h2 id='newTSdisc'>a local function needed for the vignette</h2><span id='topic+newTSdisc'></span>

<h3>Description</h3>

<p>a local function needed for the vignette
</p>


<h3>Usage</h3>

<pre><code class='language-R'>newTSdisc(x, pnull, param, vals)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="newTSdisc_+3A_x">x</code></td>
<td>
<p>An integer vector.</p>
</td></tr>
<tr><td><code id="newTSdisc_+3A_pnull">pnull</code></td>
<td>
<p>cdf.</p>
</td></tr>
<tr><td><code id="newTSdisc_+3A_param">param</code></td>
<td>
<p>parameters for pnull in case of parameter estimation.</p>
</td></tr>
<tr><td><code id="newTSdisc_+3A_vals">vals</code></td>
<td>
<p>A numeric vector with the values of the discrete rv.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with test statistics
</p>

<hr>
<h2 id='plot_power'>This function draws the power graph, with curves sorted by the mean power and smoothed for easier reading.</h2><span id='topic+plot_power'></span>

<h3>Description</h3>

<p>This function draws the power graph, with curves sorted by the mean power and smoothed for easier reading.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_power(pwr, xname = " ", title, Smooth = TRUE, span = 0.25)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_power_+3A_pwr">pwr</code></td>
<td>
<p>a matrix of power values, usually from the twosample_power command</p>
</td></tr>
<tr><td><code id="plot_power_+3A_xname">xname</code></td>
<td>
<p>Name of variable on x axis</p>
</td></tr>
<tr><td><code id="plot_power_+3A_title">title</code></td>
<td>
<p>(Optional) title of graph</p>
</td></tr>
<tr><td><code id="plot_power_+3A_smooth">Smooth</code></td>
<td>
<p>=TRUE lines are smoothed for easier reading</p>
</td></tr>
<tr><td><code id="plot_power_+3A_span">span</code></td>
<td>
<p>=0.25bandwidth of smoothing method</p>
</td></tr>
</table>


<h3>Value</h3>

<p>plt, an object of class ggplot.
</p>

<hr>
<h2 id='power_cont'>find power of gof tests for continuous data</h2><span id='topic+power_cont'></span>

<h3>Description</h3>

<p>find power of gof tests for continuous data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>power_cont(pnull, rnull, ralt, param_alt, phat, TS, typeTS, TSextra, B = 1000L)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="power_cont_+3A_pnull">pnull</code></td>
<td>
<p>R function (cdf)</p>
</td></tr>
<tr><td><code id="power_cont_+3A_rnull">rnull</code></td>
<td>
<p>R function (generate data under null hypothesis)</p>
</td></tr>
<tr><td><code id="power_cont_+3A_ralt">ralt</code></td>
<td>
<p>R function to generate data under alternative</p>
</td></tr>
<tr><td><code id="power_cont_+3A_param_alt">param_alt</code></td>
<td>
<p>parameters of ralt</p>
</td></tr>
<tr><td><code id="power_cont_+3A_phat">phat</code></td>
<td>
<p>function to estimate parameters from the data</p>
</td></tr>
<tr><td><code id="power_cont_+3A_ts">TS</code></td>
<td>
<p>function to calculate test statistics</p>
</td></tr>
<tr><td><code id="power_cont_+3A_typets">typeTS</code></td>
<td>
<p>integer indicating type of test statistic</p>
</td></tr>
<tr><td><code id="power_cont_+3A_tsextra">TSextra</code></td>
<td>
<p>list to pass to TS</p>
</td></tr>
<tr><td><code id="power_cont_+3A_b">B</code></td>
<td>
<p>=1000 Number of simulation runs</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of powers
</p>

<hr>
<h2 id='power_cont_R'>Find the power of various gof tests for continuous data.</h2><span id='topic+power_cont_R'></span>

<h3>Description</h3>

<p>Find the power of various gof tests for continuous data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>power_cont_R(
  pnull,
  rnull,
  ralt,
  param_alt,
  phat = function(x) -99,
  TS,
  typeTS,
  TSextra,
  alpha = 0.05,
  B = 1000,
  maxProcessor
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="power_cont_R_+3A_pnull">pnull</code></td>
<td>
<p>function to find cdf under  null hypothesis</p>
</td></tr>
<tr><td><code id="power_cont_R_+3A_rnull">rnull</code></td>
<td>
<p>function to generate data under  null hypothesis</p>
</td></tr>
<tr><td><code id="power_cont_R_+3A_ralt">ralt</code></td>
<td>
<p>function to generate data under  alternative hypothesis</p>
</td></tr>
<tr><td><code id="power_cont_R_+3A_param_alt">param_alt</code></td>
<td>
<p>vector of parameter values for distribution under alternative hypothesis</p>
</td></tr>
<tr><td><code id="power_cont_R_+3A_phat">phat</code></td>
<td>
<p>=function(x) -99, function to estimate parameters from the data, or -99 if no parameters are estimated</p>
</td></tr>
<tr><td><code id="power_cont_R_+3A_ts">TS</code></td>
<td>
<p>user supplied function to find test statistics, if any</p>
</td></tr>
<tr><td><code id="power_cont_R_+3A_typets">typeTS</code></td>
<td>
<p>format of TS routine</p>
</td></tr>
<tr><td><code id="power_cont_R_+3A_tsextra">TSextra</code></td>
<td>
<p>list provided to TS</p>
</td></tr>
<tr><td><code id="power_cont_R_+3A_alpha">alpha</code></td>
<td>
<p>=0.05, the level of the hypothesis test</p>
</td></tr>
<tr><td><code id="power_cont_R_+3A_b">B</code></td>
<td>
<p>=1000 number of simulation runs</p>
</td></tr>
<tr><td><code id="power_cont_R_+3A_maxprocessor">maxProcessor</code></td>
<td>
<p>maximum of number of processors to use, 1 if no parallel processing is needed or number of cores-1 if missing</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric matrix of power values
</p>

<hr>
<h2 id='power_disc'>find power of gof tests for continuous data</h2><span id='topic+power_disc'></span>

<h3>Description</h3>

<p>find power of gof tests for continuous data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>power_disc(
  pnull,
  rnull,
  vals,
  ralt,
  param_alt,
  phat,
  TS,
  typeTS,
  TSextra,
  B = 1000L
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="power_disc_+3A_pnull">pnull</code></td>
<td>
<p>R function (cdf)</p>
</td></tr>
<tr><td><code id="power_disc_+3A_rnull">rnull</code></td>
<td>
<p>R function (generate data under null hypothesis)</p>
</td></tr>
<tr><td><code id="power_disc_+3A_vals">vals</code></td>
<td>
<p>values of discrete distribution</p>
</td></tr>
<tr><td><code id="power_disc_+3A_ralt">ralt</code></td>
<td>
<p>R function to generate data under alternative</p>
</td></tr>
<tr><td><code id="power_disc_+3A_param_alt">param_alt</code></td>
<td>
<p>parameters of ralt</p>
</td></tr>
<tr><td><code id="power_disc_+3A_phat">phat</code></td>
<td>
<p>function to estimate parameters from the data</p>
</td></tr>
<tr><td><code id="power_disc_+3A_ts">TS</code></td>
<td>
<p>function to calculate test statistics</p>
</td></tr>
<tr><td><code id="power_disc_+3A_typets">typeTS</code></td>
<td>
<p>integer indicating type of test statistic</p>
</td></tr>
<tr><td><code id="power_disc_+3A_tsextra">TSextra</code></td>
<td>
<p>list to pass to TS</p>
</td></tr>
<tr><td><code id="power_disc_+3A_b">B</code></td>
<td>
<p>=1000 Number of simulation runs</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of powers
</p>

<hr>
<h2 id='power_disc_R'>Find the power of various gof tests for discrete data.</h2><span id='topic+power_disc_R'></span>

<h3>Description</h3>

<p>Find the power of various gof tests for discrete data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>power_disc_R(
  pnull,
  rnull,
  vals,
  ralt,
  param_alt,
  phat = function(x) -99,
  TS,
  typeTS,
  TSextra,
  alpha = 0.05,
  B = 1000,
  maxProcessor
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="power_disc_R_+3A_pnull">pnull</code></td>
<td>
<p>function to find cdf under  null hypothesis</p>
</td></tr>
<tr><td><code id="power_disc_R_+3A_rnull">rnull</code></td>
<td>
<p>function to generate data under  null hypothesis</p>
</td></tr>
<tr><td><code id="power_disc_R_+3A_vals">vals</code></td>
<td>
<p>values of discrete distribution</p>
</td></tr>
<tr><td><code id="power_disc_R_+3A_ralt">ralt</code></td>
<td>
<p>function to generate data under  alternative hypothesis</p>
</td></tr>
<tr><td><code id="power_disc_R_+3A_param_alt">param_alt</code></td>
<td>
<p>vector of parameter values for distribution under alternative hypothesis</p>
</td></tr>
<tr><td><code id="power_disc_R_+3A_phat">phat</code></td>
<td>
<p>=function(x) -99, function to estimate parameters from the data, or -99 if no parameters are estimated</p>
</td></tr>
<tr><td><code id="power_disc_R_+3A_ts">TS</code></td>
<td>
<p>user supplied function to find test statistics, if any</p>
</td></tr>
<tr><td><code id="power_disc_R_+3A_typets">typeTS</code></td>
<td>
<p>format of TS routine</p>
</td></tr>
<tr><td><code id="power_disc_R_+3A_tsextra">TSextra</code></td>
<td>
<p>list provided to TS</p>
</td></tr>
<tr><td><code id="power_disc_R_+3A_alpha">alpha</code></td>
<td>
<p>=0.05, the level of the hypothesis test</p>
</td></tr>
<tr><td><code id="power_disc_R_+3A_b">B</code></td>
<td>
<p>=1000 number of simulation runs</p>
</td></tr>
<tr><td><code id="power_disc_R_+3A_maxprocessor">maxProcessor</code></td>
<td>
<p>maximum of number of processors to use, 1 if no parallel processing is needed or number of cores-1 if missing</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric matrix of power values
</p>

<hr>
<h2 id='power_newtest'>This function estimates the power of test routines that calculate p value(s)</h2><span id='topic+power_newtest'></span>

<h3>Description</h3>

<p>This function estimates the power of test routines that calculate p value(s)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>power_newtest(
  TS,
  vals = NA,
  pnull,
  ralt,
  param_alt,
  phat,
  TSextra,
  alpha = 0.05,
  B = 1000
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="power_newtest_+3A_ts">TS</code></td>
<td>
<p>routine to calculate test statistics.</p>
</td></tr>
<tr><td><code id="power_newtest_+3A_vals">vals</code></td>
<td>
<p>=NA if data is discrete, a vector of possible values</p>
</td></tr>
<tr><td><code id="power_newtest_+3A_pnull">pnull</code></td>
<td>
<p>routine to calculate the cdf under the null hypothesis</p>
</td></tr>
<tr><td><code id="power_newtest_+3A_ralt">ralt</code></td>
<td>
<p>generate data under altenative hypothesis</p>
</td></tr>
<tr><td><code id="power_newtest_+3A_param_alt">param_alt</code></td>
<td>
<p>values of parameter under the alternative hypothesis.</p>
</td></tr>
<tr><td><code id="power_newtest_+3A_phat">phat</code></td>
<td>
<p>function to estimate parameters, function(x) -99 if no parameter estimation</p>
</td></tr>
<tr><td><code id="power_newtest_+3A_tsextra">TSextra</code></td>
<td>
<p>list (possibly) passed to TS</p>
</td></tr>
<tr><td><code id="power_newtest_+3A_alpha">alpha</code></td>
<td>
<p>=0.05  type I error.</p>
</td></tr>
<tr><td><code id="power_newtest_+3A_b">B</code></td>
<td>
<p>= 1000 number of simulation runs to estimate the power.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of power values
</p>

<hr>
<h2 id='power_studies_results'>power_studies_results</h2><span id='topic+power_studies_results'></span>

<h3>Description</h3>

<p>the results of the included power studies
</p>


<h3>Usage</h3>

<pre><code class='language-R'>power_studies_results
</code></pre>


<h3>Format</h3>



<h4>'power_studies_results'</h4>

<p>A list of matrices with powers
</p>


<hr>
<h2 id='pvaluecdf'>pvaluecdf</h2><span id='topic+pvaluecdf'></span>

<h3>Description</h3>

<p>the info needed to draw a graph
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pvaluecdf
</code></pre>


<h3>Format</h3>



<h4>'pvaluecdf'</h4>

<p>A matrix
</p>


<hr>
<h2 id='run.studies'>This function runs the case studies included in the package</h2><span id='topic+run.studies'></span>

<h3>Description</h3>

<p>This function runs the case studies included in the package
</p>


<h3>Usage</h3>

<pre><code class='language-R'>run.studies(
  TS,
  study,
  TSextra = list(aaa = 1),
  With.p.value = FALSE,
  BasicComparison = TRUE,
  nsample = 500,
  alpha = 0.05,
  param_alt,
  maxProcessor,
  B = 1000
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="run.studies_+3A_ts">TS</code></td>
<td>
<p>routine to calculate test statistic(s) or p value(s).</p>
</td></tr>
<tr><td><code id="run.studies_+3A_study">study</code></td>
<td>
<p>either the name of the study, or its number. If missing all the studies are run.</p>
</td></tr>
<tr><td><code id="run.studies_+3A_tsextra">TSextra</code></td>
<td>
<p>=list(aaa=1), list passed to TS.</p>
</td></tr>
<tr><td><code id="run.studies_+3A_with.p.value">With.p.value</code></td>
<td>
<p>=FALSE does user supplied routine return p values?</p>
</td></tr>
<tr><td><code id="run.studies_+3A_basiccomparison">BasicComparison</code></td>
<td>
<p>=TRUE if true compares tests on one default value of parameter of the alternative distribution.</p>
</td></tr>
<tr><td><code id="run.studies_+3A_nsample">nsample</code></td>
<td>
<p>= 500, desired sample size.</p>
</td></tr>
<tr><td><code id="run.studies_+3A_alpha">alpha</code></td>
<td>
<p>=0.05  type I error</p>
</td></tr>
<tr><td><code id="run.studies_+3A_param_alt">param_alt</code></td>
<td>
<p>(list of) values of parameter under the alternative hypothesis. If missing included values are used.</p>
</td></tr>
<tr><td><code id="run.studies_+3A_maxprocessor">maxProcessor</code></td>
<td>
<p>number of cores to use for parallel programming</p>
</td></tr>
<tr><td><code id="run.studies_+3A_b">B</code></td>
<td>
<p>= 1000 number of simulation runs</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A (list of ) matrices of p.values
</p>


<h3>Examples</h3>

<pre><code class='language-R'># New test is a simple chi-square test: 
chitest=function(x, pnull, param, TSextra) {
    nbins=TSextra$nbins
    bins=quantile(x, (0:nbins)/nbins)
    O=hist(x, bins, plot=FALSE)$counts
    if(param[1]!=-99) { #with parameter estimation
        E=length(x)*diff(pnull(bins, param))
        chi=sum((O-E)^2/E)
        pval=1-pchisq(chi, nbins-1-length(param))
    }
    else {
      E=length(x)*diff(pnull(bins))
      chi=sum((O-E)^2/E)
      pval=1-pchisq(chi,nbins-1)
    }  
    out=ifelse(TSextra$statistic, chi, pval)
    names(out)="ChiSquare"
    out
}
TSextra=list(nbins=10, statistic=FALSE) # Use 10 bins, test routine returns p-value
run.studies(chitest, TSextra=TSextra, With.p.value=TRUE, maxProcessor=1, B=200)
</code></pre>

<hr>
<h2 id='signif.digits'>This function does some rounding to nice numbers</h2><span id='topic+signif.digits'></span>

<h3>Description</h3>

<p>This function does some rounding to nice numbers
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'digits'
signif(x, d = 4)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="signif.digits_+3A_x">x</code></td>
<td>
<p>a list of two vectors</p>
</td></tr>
<tr><td><code id="signif.digits_+3A_d">d</code></td>
<td>
<p>=4 number of digits to round to</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with rounded vectors
</p>

<hr>
<h2 id='timecheck'>estimate run time function</h2><span id='topic+timecheck'></span>

<h3>Description</h3>

<p>estimate run time function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>timecheck(x, pnull, phatx, wx, TS, typeTS, TSextra)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="timecheck_+3A_x">x</code></td>
<td>
<p>data set</p>
</td></tr>
<tr><td><code id="timecheck_+3A_pnull">pnull</code></td>
<td>
<p>function to find cdf under  null hypothesis</p>
</td></tr>
<tr><td><code id="timecheck_+3A_phatx">phatx</code></td>
<td>
<p>parameter estimates</p>
</td></tr>
<tr><td><code id="timecheck_+3A_wx">wx</code></td>
<td>
<p>vector of wights</p>
</td></tr>
<tr><td><code id="timecheck_+3A_ts">TS</code></td>
<td>
<p>test statistic</p>
</td></tr>
<tr><td><code id="timecheck_+3A_typets">typeTS</code></td>
<td>
<p>format of TS</p>
</td></tr>
<tr><td><code id="timecheck_+3A_tsextra">TSextra</code></td>
<td>
<p>additional info TS</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Mean computation time
</p>

<hr>
<h2 id='TS_cont'>Find test statistics for continuous data</h2><span id='topic+TS_cont'></span>

<h3>Description</h3>

<p>Find test statistics for continuous data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TS_cont(x, pnull, param, qnull)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="TS_cont_+3A_x">x</code></td>
<td>
<p>A numeric vector.</p>
</td></tr>
<tr><td><code id="TS_cont_+3A_pnull">pnull</code></td>
<td>
<p>cdf.</p>
</td></tr>
<tr><td><code id="TS_cont_+3A_param">param</code></td>
<td>
<p>parameters for pnull  in case of parameter estimation.</p>
</td></tr>
<tr><td><code id="TS_cont_+3A_qnull">qnull</code></td>
<td>
<p>An R function, the quantile function under the null hypothesis.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector with test statistics
</p>

<hr>
<h2 id='TS_disc'>Find test statistics for discrete data</h2><span id='topic+TS_disc'></span>

<h3>Description</h3>

<p>Find test statistics for discrete data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TS_disc(x, pnull, param, vals)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="TS_disc_+3A_x">x</code></td>
<td>
<p>An integer vector.</p>
</td></tr>
<tr><td><code id="TS_disc_+3A_pnull">pnull</code></td>
<td>
<p>cdf.</p>
</td></tr>
<tr><td><code id="TS_disc_+3A_param">param</code></td>
<td>
<p>parameters for pnull in case of parameter estimation.</p>
</td></tr>
<tr><td><code id="TS_disc_+3A_vals">vals</code></td>
<td>
<p>A numeric vector with the values of the discrete rv.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with test statistics
</p>

<hr>
<h2 id='TSw_cont'>Find test statistics for continuous data with weights</h2><span id='topic+TSw_cont'></span>

<h3>Description</h3>

<p>Find test statistics for continuous data with weights
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TSw_cont(x, pnull, param, w)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="TSw_cont_+3A_x">x</code></td>
<td>
<p>A numeric vector.</p>
</td></tr>
<tr><td><code id="TSw_cont_+3A_pnull">pnull</code></td>
<td>
<p>cdf.</p>
</td></tr>
<tr><td><code id="TSw_cont_+3A_param">param</code></td>
<td>
<p>parameters for pnull in case of parameter estimation.</p>
</td></tr>
<tr><td><code id="TSw_cont_+3A_w">w</code></td>
<td>
<p>numeric vector of weights</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector with test statistics
</p>

<hr>
<h2 id='TSw_disc'>Find test statistics for discrete data</h2><span id='topic+TSw_disc'></span>

<h3>Description</h3>

<p>Find test statistics for discrete data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TSw_disc(x, pnull, param, vals, w)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="TSw_disc_+3A_x">x</code></td>
<td>
<p>An integer vector.</p>
</td></tr>
<tr><td><code id="TSw_disc_+3A_pnull">pnull</code></td>
<td>
<p>cdf.</p>
</td></tr>
<tr><td><code id="TSw_disc_+3A_param">param</code></td>
<td>
<p>parameters for pnull in case of parameter estimation.</p>
</td></tr>
<tr><td><code id="TSw_disc_+3A_vals">vals</code></td>
<td>
<p>A numeric vector with the values of the discrete rv.</p>
</td></tr>
<tr><td><code id="TSw_disc_+3A_w">w</code></td>
<td>
<p>weights</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with test statistics
</p>

<hr>
<h2 id='wbincounter'>Find counts or sum of weights in bins. Useful for power calculations. Replaces hist command from R.</h2><span id='topic+wbincounter'></span>

<h3>Description</h3>

<p>Find counts or sum of weights in bins. Useful for power calculations. Replaces hist command from R.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wbincounter(x, bins, w)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="wbincounter_+3A_x">x</code></td>
<td>
<p>numeric vector</p>
</td></tr>
<tr><td><code id="wbincounter_+3A_bins">bins</code></td>
<td>
<p>numeric vector</p>
</td></tr>
<tr><td><code id="wbincounter_+3A_w">w</code></td>
<td>
<p>numeric vector of weights</p>
</td></tr>
</table>


<h3>Value</h3>

<p>sum of weights in bins
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
