<!DOCTYPE html><html><head><title>Help for package Rgof</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {Rgof}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bincounter_cpp'><p>count occurances in bins. Useful for power calculations. Replaces hist command from R.</p></a></li>
<li><a href='#binner_cont'><p>routine to bin continuous data and assure expected counts&gt;5</p></a></li>
<li><a href='#binner_disc'><p>routine to bin discrete data and assure expected counts&gt;5</p></a></li>
<li><a href='#check.functions'><p>This function checks whether the inputs have the correct format</p></a></li>
<li><a href='#chi_stat_cont'><p>chi square statistic for continuous data</p></a></li>
<li><a href='#chi_stat_disc'><p>chi square statistic for discrete data</p></a></li>
<li><a href='#chi_test_cont'><p>This function performs a number of chisquare gof tests for continuous data</p></a></li>
<li><a href='#chi_test_disc'><p>This function performs a number of chisquare gof tests for discrete data</p></a></li>
<li><a href='#gof_cont'><p>run gof tests for continuous data</p></a></li>
<li><a href='#gof_disc'><p>run gof tests for discrete data</p></a></li>
<li><a href='#gof_power_cont'><p>Find the power of various gof tests for continuous data.</p></a></li>
<li><a href='#gof_power_disc'><p>Find the power of various gof tests for discrete data.</p></a></li>
<li><a href='#gof_test_cont'><p>This function performs a number of gof tests for continuous data</p></a></li>
<li><a href='#gof_test_disc'><p>This function performs a number of gof tests for discrete data.</p></a></li>
<li><a href='#nm_calc'><p>calculate a matrix of numbers needed for Zhangs tests for discrete data</p></a></li>
<li><a href='#plot_power'><p>This function draws the power graph, with curves sorted by the mean power and smoothed for easier reading.</p></a></li>
<li><a href='#power_cont'><p>find power of gof tests for continuous data</p></a></li>
<li><a href='#power_disc'><p>find power of gof tests for discrete data</p></a></li>
<li><a href='#TS_cont'><p>Find test statistics for continuous data</p></a></li>
<li><a href='#TS_disc'><p>Find test statistics for discrete data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>1d Goodness of Fit Tests</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.2</td>
</tr>
<tr>
<td>Description:</td>
<td>Routines that allow the user to run a large number of goodness-of-fit tests.  
     It allows for data to be continuous or discrete. It includes routines to estimate
     the power of the tests and display them as a power graph.      </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp, parallel, ggplot2, stats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rmarkdown, knitr</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-10-25 13:48:14 UTC; Wolfgang</td>
</tr>
<tr>
<td>Author:</td>
<td>Wolfgang Rolke <a href="https://orcid.org/0000-0002-3514-726X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Wolfgang Rolke &lt;wolfgang.rolke@upr.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-10-30 20:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='bincounter_cpp'>count occurances in bins. Useful for power calculations. Replaces hist command from R.</h2><span id='topic+bincounter_cpp'></span>

<h3>Description</h3>

<p>count occurances in bins. Useful for power calculations. Replaces hist command from R.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bincounter_cpp(x, bins)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bincounter_cpp_+3A_x">x</code></td>
<td>
<p>numeric vector</p>
</td></tr>
<tr><td><code id="bincounter_cpp_+3A_bins">bins</code></td>
<td>
<p>numeric vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Integer vector of counts
</p>

<hr>
<h2 id='binner_cont'>routine to bin continuous data and assure expected counts&gt;5</h2><span id='topic+binner_cont'></span>

<h3>Description</h3>

<p>routine to bin continuous data and assure expected counts&gt;5
</p>


<h3>Usage</h3>

<pre><code class='language-R'>binner_cont(
  x,
  pnull,
  param,
  k = 10L,
  which = 1L,
  Range = as.numeric(c(-99999, 99999)),
  minexpcount = 2
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="binner_cont_+3A_x">x</code></td>
<td>
<p>A numeric vector of numbers.</p>
</td></tr>
<tr><td><code id="binner_cont_+3A_pnull">pnull</code></td>
<td>
<p>function to find CDF</p>
</td></tr>
<tr><td><code id="binner_cont_+3A_param">param</code></td>
<td>
<p>parameter of pnull</p>
</td></tr>
<tr><td><code id="binner_cont_+3A_k">k</code></td>
<td>
<p>=10, number of bins</p>
</td></tr>
<tr><td><code id="binner_cont_+3A_which">which</code></td>
<td>
<p>=1, 1=equal probability bins, 2-equal size bins</p>
</td></tr>
<tr><td><code id="binner_cont_+3A_range">Range</code></td>
<td>
<p>=(-99999,99999) limits of possible observations, if any</p>
</td></tr>
<tr><td><code id="binner_cont_+3A_minexpcount">minexpcount</code></td>
<td>
<p>=2 minimal expected bin count required</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vectors of bin edges
</p>

<hr>
<h2 id='binner_disc'>routine to bin discrete data and assure expected counts&gt;5</h2><span id='topic+binner_disc'></span>

<h3>Description</h3>

<p>routine to bin discrete data and assure expected counts&gt;5
</p>


<h3>Usage</h3>

<pre><code class='language-R'>binner_disc(x, p, k = 10L, minexpcount = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="binner_disc_+3A_x">x</code></td>
<td>
<p>An integer vector of counts.</p>
</td></tr>
<tr><td><code id="binner_disc_+3A_p">p</code></td>
<td>
<p>cumulative distribution function values at vals</p>
</td></tr>
<tr><td><code id="binner_disc_+3A_k">k</code></td>
<td>
<p>number of desired bins</p>
</td></tr>
<tr><td><code id="binner_disc_+3A_minexpcount">minexpcount</code></td>
<td>
<p>=2 minimal expected bin count required</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An integer vector of indices
</p>

<hr>
<h2 id='check.functions'>This function checks whether the inputs have the correct format</h2><span id='topic+check.functions'></span>

<h3>Description</h3>

<p>This function checks whether the inputs have the correct format
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check.functions(pnull, rnull, qnull, phat, vals, x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check.functions_+3A_pnull">pnull</code></td>
<td>
<p>cdf under the null hypothesis</p>
</td></tr>
<tr><td><code id="check.functions_+3A_rnull">rnull</code></td>
<td>
<p>routine to generate data under the null hypothesis</p>
</td></tr>
<tr><td><code id="check.functions_+3A_qnull">qnull</code></td>
<td>
<p>routine to calculate quantiles under null hypothesis</p>
</td></tr>
<tr><td><code id="check.functions_+3A_phat">phat</code></td>
<td>
<p>function to estimate parameters from the data</p>
</td></tr>
<tr><td><code id="check.functions_+3A_vals">vals</code></td>
<td>
<p>vector of discrete values</p>
</td></tr>
<tr><td><code id="check.functions_+3A_x">x</code></td>
<td>
<p>data</p>
</td></tr>
</table>

<hr>
<h2 id='chi_stat_cont'>chi square statistic for continuous data</h2><span id='topic+chi_stat_cont'></span>

<h3>Description</h3>

<p>chi square statistic for continuous data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chi_stat_cont(param, x, pnull, bins, formula, rate = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="chi_stat_cont_+3A_param">param</code></td>
<td>
<p>Vector of parameters of pnull</p>
</td></tr>
<tr><td><code id="chi_stat_cont_+3A_x">x</code></td>
<td>
<p>Vector of observations</p>
</td></tr>
<tr><td><code id="chi_stat_cont_+3A_pnull">pnull</code></td>
<td>
<p>Function to calculate probabilities (pmf)</p>
</td></tr>
<tr><td><code id="chi_stat_cont_+3A_bins">bins</code></td>
<td>
<p>bins to use</p>
</td></tr>
<tr><td><code id="chi_stat_cont_+3A_formula">formula</code></td>
<td>
<p>type of chi square formula to use</p>
</td></tr>
<tr><td><code id="chi_stat_cont_+3A_rate">rate</code></td>
<td>
<p>rate of Poisson if sample size is random, 0 otherwise</p>
</td></tr>
</table>


<h3>Value</h3>

<p>chi square statistic
</p>

<hr>
<h2 id='chi_stat_disc'>chi square statistic for discrete data</h2><span id='topic+chi_stat_disc'></span>

<h3>Description</h3>

<p>chi square statistic for discrete data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chi_stat_disc(param, x, pnull, bins, formula, rate = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="chi_stat_disc_+3A_param">param</code></td>
<td>
<p>parameter for pnull</p>
</td></tr>
<tr><td><code id="chi_stat_disc_+3A_x">x</code></td>
<td>
<p>Vector of observations</p>
</td></tr>
<tr><td><code id="chi_stat_disc_+3A_pnull">pnull</code></td>
<td>
<p>cumulative distribution function under the null hypothesis</p>
</td></tr>
<tr><td><code id="chi_stat_disc_+3A_bins">bins</code></td>
<td>
<p>vector of indices of bins</p>
</td></tr>
<tr><td><code id="chi_stat_disc_+3A_formula">formula</code></td>
<td>
<p>type of chi square formula to use</p>
</td></tr>
<tr><td><code id="chi_stat_disc_+3A_rate">rate</code></td>
<td>
<p>rate of Poisson if sample size is random, 0 otherwise</p>
</td></tr>
</table>


<h3>Value</h3>

<p>chi square statistic
</p>

<hr>
<h2 id='chi_test_cont'>This function performs a number of chisquare gof tests for continuous data</h2><span id='topic+chi_test_cont'></span>

<h3>Description</h3>

<p>This function performs a number of chisquare gof tests for continuous data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chi_test_cont(
  x,
  pnull,
  param,
  formula = "Pearson",
  rate = 0,
  nbins = as.integer(c(100, 10)),
  Range = as.numeric(c(-99999, 99999)),
  Minimize = 0L,
  minexpcount = 2
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="chi_test_cont_+3A_x">x</code></td>
<td>
<p>data set</p>
</td></tr>
<tr><td><code id="chi_test_cont_+3A_pnull">pnull</code></td>
<td>
<p>cdf under the null hypothesis</p>
</td></tr>
<tr><td><code id="chi_test_cont_+3A_param">param</code></td>
<td>
<p>starting values of multi-D minimum chi square minimization</p>
</td></tr>
<tr><td><code id="chi_test_cont_+3A_formula">formula</code></td>
<td>
<p>Formula of chi square to use</p>
</td></tr>
<tr><td><code id="chi_test_cont_+3A_rate">rate</code></td>
<td>
<p>rate of Poisson if sample size is random</p>
</td></tr>
<tr><td><code id="chi_test_cont_+3A_nbins">nbins</code></td>
<td>
<p>=c(100, 10) number of bins for chisquare tests</p>
</td></tr>
<tr><td><code id="chi_test_cont_+3A_range">Range</code></td>
<td>
<p>=(-99999, 99999) limits of possible observations, if any</p>
</td></tr>
<tr><td><code id="chi_test_cont_+3A_minimize">Minimize</code></td>
<td>
<p>Should minimum chi square be found?</p>
</td></tr>
<tr><td><code id="chi_test_cont_+3A_minexpcount">minexpcount</code></td>
<td>
<p>=2 minimal expected bin count required</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric matrix of test statistics, degrees of freedom and p values
</p>

<hr>
<h2 id='chi_test_disc'>This function performs a number of chisquare gof tests for discrete data</h2><span id='topic+chi_test_disc'></span>

<h3>Description</h3>

<p>This function performs a number of chisquare gof tests for discrete data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chi_test_disc(
  x,
  pnull,
  param,
  nbins = as.integer(c(100, 10)),
  formula = "Pearson",
  rate = 0,
  Minimize = 0L,
  minexpcount = 2
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="chi_test_disc_+3A_x">x</code></td>
<td>
<p>data set</p>
</td></tr>
<tr><td><code id="chi_test_disc_+3A_pnull">pnull</code></td>
<td>
<p>cdf under the null hypothesis</p>
</td></tr>
<tr><td><code id="chi_test_disc_+3A_param">param</code></td>
<td>
<p>starting values of multi-D minimum chi square minimization</p>
</td></tr>
<tr><td><code id="chi_test_disc_+3A_nbins">nbins</code></td>
<td>
<p>=c(100, 10) number of bins for chisquare tests</p>
</td></tr>
<tr><td><code id="chi_test_disc_+3A_formula">formula</code></td>
<td>
<p>type of chi square formula to use</p>
</td></tr>
<tr><td><code id="chi_test_disc_+3A_rate">rate</code></td>
<td>
<p>rate of Poisson if sample size is random, 0 otherwise</p>
</td></tr>
<tr><td><code id="chi_test_disc_+3A_minimize">Minimize</code></td>
<td>
<p>Should minimum chi square be found?</p>
</td></tr>
<tr><td><code id="chi_test_disc_+3A_minexpcount">minexpcount</code></td>
<td>
<p>=2 minimal expected bin count required</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric matrix of test statistics, degrees of freedom and p values
</p>

<hr>
<h2 id='gof_cont'>run gof tests for continuous data</h2><span id='topic+gof_cont'></span>

<h3>Description</h3>

<p>run gof tests for continuous data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gof_cont(x, pnull, rnull, qnull, phat, TS, B = 5000L)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gof_cont_+3A_x">x</code></td>
<td>
<p>A numeric vector of data</p>
</td></tr>
<tr><td><code id="gof_cont_+3A_pnull">pnull</code></td>
<td>
<p>R function (cdf)</p>
</td></tr>
<tr><td><code id="gof_cont_+3A_rnull">rnull</code></td>
<td>
<p>R function (generate data under null hypothesis)</p>
</td></tr>
<tr><td><code id="gof_cont_+3A_qnull">qnull</code></td>
<td>
<p>R function (quantiles under null hypothesis)</p>
</td></tr>
<tr><td><code id="gof_cont_+3A_phat">phat</code></td>
<td>
<p>function to set or estimate parameters of pnull</p>
</td></tr>
<tr><td><code id="gof_cont_+3A_ts">TS</code></td>
<td>
<p>function that calculates test statistics</p>
</td></tr>
<tr><td><code id="gof_cont_+3A_b">B</code></td>
<td>
<p>(=5000) Number of simulation runs</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of numbers
</p>

<hr>
<h2 id='gof_disc'>run gof tests for discrete data</h2><span id='topic+gof_disc'></span>

<h3>Description</h3>

<p>run gof tests for discrete data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gof_disc(x, pnull, rnull, vals, phat, TS, rate = 0, B = 5000L)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gof_disc_+3A_x">x</code></td>
<td>
<p>an integer vector of counts</p>
</td></tr>
<tr><td><code id="gof_disc_+3A_pnull">pnull</code></td>
<td>
<p>cumulative distribution function under the null hypothesis</p>
</td></tr>
<tr><td><code id="gof_disc_+3A_rnull">rnull</code></td>
<td>
<p>R function (generate data under null hypothesis)</p>
</td></tr>
<tr><td><code id="gof_disc_+3A_vals">vals</code></td>
<td>
<p>numeric vector of values of discrete random variables.</p>
</td></tr>
<tr><td><code id="gof_disc_+3A_phat">phat</code></td>
<td>
<p>function to estimate parameters</p>
</td></tr>
<tr><td><code id="gof_disc_+3A_ts">TS</code></td>
<td>
<p>function that calculates test statistics</p>
</td></tr>
<tr><td><code id="gof_disc_+3A_rate">rate</code></td>
<td>
<p>=0 rate of Poisson if sample size is random, 0 otherwise.</p>
</td></tr>
<tr><td><code id="gof_disc_+3A_b">B</code></td>
<td>
<p>(=5000) Number of simulation runs</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of numbers
</p>

<hr>
<h2 id='gof_power_cont'>Find the power of various gof tests for continuous data.</h2><span id='topic+gof_power_cont'></span>

<h3>Description</h3>

<p>Find the power of various gof tests for continuous data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gof_power_cont(
  pnull,
  rnull,
  qnull,
  ralt,
  param_alt,
  phat,
  TS,
  alpha = 0.05,
  Range = c(-Inf, Inf),
  B = c(1000, 1000),
  nbins = c(100, 10),
  rate = 0,
  maxProcessors,
  minexpcount = 2
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gof_power_cont_+3A_pnull">pnull</code></td>
<td>
<p>function to find cdf under  null hypothesis</p>
</td></tr>
<tr><td><code id="gof_power_cont_+3A_rnull">rnull</code></td>
<td>
<p>function to generate data under  null hypothesis</p>
</td></tr>
<tr><td><code id="gof_power_cont_+3A_qnull">qnull</code></td>
<td>
<p>quantile function (inverse cdf). If missing Wasserstein test can not be done.</p>
</td></tr>
<tr><td><code id="gof_power_cont_+3A_ralt">ralt</code></td>
<td>
<p>function to generate data under  alternative hypothesis</p>
</td></tr>
<tr><td><code id="gof_power_cont_+3A_param_alt">param_alt</code></td>
<td>
<p>vector of parameter values for distribution under alternative hypothesis</p>
</td></tr>
<tr><td><code id="gof_power_cont_+3A_phat">phat</code></td>
<td>
<p>function to estimate parameters from the data</p>
</td></tr>
<tr><td><code id="gof_power_cont_+3A_ts">TS</code></td>
<td>
<p>user supplied function to find test statistics</p>
</td></tr>
<tr><td><code id="gof_power_cont_+3A_alpha">alpha</code></td>
<td>
<p>=0.05, the level of the hypothesis test</p>
</td></tr>
<tr><td><code id="gof_power_cont_+3A_range">Range</code></td>
<td>
<p>=c(-Inf, Inf) limits of possible observations, if any</p>
</td></tr>
<tr><td><code id="gof_power_cont_+3A_b">B</code></td>
<td>
<p>=c(1000, 1000), number of simulation runs to find power and null distribution</p>
</td></tr>
<tr><td><code id="gof_power_cont_+3A_nbins">nbins</code></td>
<td>
<p>=c(100,10), number of bins for chi square tests.</p>
</td></tr>
<tr><td><code id="gof_power_cont_+3A_rate">rate</code></td>
<td>
<p>=0 rate of Poisson if sample size is random, 0 if sample size is fixed</p>
</td></tr>
<tr><td><code id="gof_power_cont_+3A_maxprocessors">maxProcessors</code></td>
<td>
<p>maximum of number of processors to use, 1 if no parallel processing is needed or number of cores-1 if missing</p>
</td></tr>
<tr><td><code id="gof_power_cont_+3A_minexpcount">minexpcount</code></td>
<td>
<p>=2 minimal expected bin count required</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric matrix of power values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Power of tests when null hypothesis specifies the standard normal distribution but 
# true data comes from a normal distribution with mean different from 0.
pnull = function(x) pnorm(x)
qnull = function(x) qnorm(x)
rnull = function()  rnorm(50)
ralt = function(mu)  rnorm(50, mu)
gof_power_cont(pnull, rnull, qnull, ralt, c(0.25, 0.5), B=c(500, 500))
# Power of tests when null hypothesis specifies normal distribution and 
# mean and standard deviation are estimated from the data. 
# Example is not run because it takes several minutes.
# true data comes from a normal distribution with mean different from 0.
pnull = function(x, p=c(0, 1)) pnorm(x, p[1], ifelse(p[2]&gt;0.001, p[2], 0.001))
qnull = function(x, p=c(0, 1)) qnorm(x, p[1],  ifelse(p[2]&gt;0.001, p[2], 0.001))
rnull = function(p=c(0, 1))  rnorm(50, p[1], ifelse(p[2]&gt;0.001, p[2], 0.001))
phat = function(x) c(mean(x), sd(x))
gof_power_cont(pnull, rnull, qnull, ralt, c(0, 1), phat, B=c(200, 200), maxProcessor=2)
</code></pre>

<hr>
<h2 id='gof_power_disc'>Find the power of various gof tests for discrete data.</h2><span id='topic+gof_power_disc'></span>

<h3>Description</h3>

<p>Find the power of various gof tests for discrete data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gof_power_disc(
  pnull,
  rnull,
  vals,
  ralt,
  param_alt,
  phat,
  TS,
  alpha = 0.05,
  B = c(1000, 1000),
  nbins = c(100, 10),
  rate = 0,
  maxProcessors,
  minexpcount = 2
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gof_power_disc_+3A_pnull">pnull</code></td>
<td>
<p>cumulative distribution function under the null hypothesis</p>
</td></tr>
<tr><td><code id="gof_power_disc_+3A_rnull">rnull</code></td>
<td>
<p>a function to generate data under  null hypothesis</p>
</td></tr>
<tr><td><code id="gof_power_disc_+3A_vals">vals</code></td>
<td>
<p>values of discrete rv.</p>
</td></tr>
<tr><td><code id="gof_power_disc_+3A_ralt">ralt</code></td>
<td>
<p>function to generate data under  alternative hypothesis</p>
</td></tr>
<tr><td><code id="gof_power_disc_+3A_param_alt">param_alt</code></td>
<td>
<p>vector of parameter values for distribution under alternative hypothesis</p>
</td></tr>
<tr><td><code id="gof_power_disc_+3A_phat">phat</code></td>
<td>
<p>function to estimate parameters from the data</p>
</td></tr>
<tr><td><code id="gof_power_disc_+3A_ts">TS</code></td>
<td>
<p>user supplied function to find test statistics</p>
</td></tr>
<tr><td><code id="gof_power_disc_+3A_alpha">alpha</code></td>
<td>
<p>=0.05, the level of the hypothesis test</p>
</td></tr>
<tr><td><code id="gof_power_disc_+3A_b">B</code></td>
<td>
<p>=c(1000, 1000), number of simulation runs to find power and null distribution</p>
</td></tr>
<tr><td><code id="gof_power_disc_+3A_nbins">nbins</code></td>
<td>
<p>=c(100,10), number of bins for chisquare tests.</p>
</td></tr>
<tr><td><code id="gof_power_disc_+3A_rate">rate</code></td>
<td>
<p>=0 rate of Poisson if sample size is random, 0 if sample size is fixed</p>
</td></tr>
<tr><td><code id="gof_power_disc_+3A_maxprocessors">maxProcessors</code></td>
<td>
<p>maximum of number of processors to use, 1 if no parallel processing is needed or number of cores-1 if missing</p>
</td></tr>
<tr><td><code id="gof_power_disc_+3A_minexpcount">minexpcount</code></td>
<td>
<p>=2 minimal expected bin count required</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric matrix of power values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Power of tests when null hypothesis specifies a binomial N=10, p=0.5 distribution but 
# true data comes from a binomial distribution with success probability 0.55 or 0.6.
vals=0:10
pnull = function() pbinom(0:10, 10, 0.5)
rnull = function() table(c(0:10, rbinom(1000, 10, 0.5)))-1
ralt = function(p) table(c(0:10, rbinom(1000, 10, p)))-1
gof_power_disc(pnull, rnull, vals, ralt, c(0.515, 0.53), B=c(500, 500))
# Power of tests when null hypothesis specifies a binomial N=10 distribution and
# p is estimated from the data. 
pnull=function(p=0.5)  pbinom(0:10, 10, p)
rnull = function(p=0.5) table(c(0:10, rbinom(1000, 10, p)))-1
ralt = function(p=0.5) table(c(0:10, rbinom(1000, 10, p)))-1
phat = function(x) mean(rep(0:10, x))/10
gof_power_disc(pnull, rnull, vals, ralt, phat, param_alt=0.6, B=c(100, 100), maxProcessors = 2)
</code></pre>

<hr>
<h2 id='gof_test_cont'>This function performs a number of gof tests for continuous data</h2><span id='topic+gof_test_cont'></span>

<h3>Description</h3>

<p>This function performs a number of gof tests for continuous data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gof_test_cont(
  x,
  pnull,
  rnull,
  qnull,
  phat,
  TS,
  nbins = c(100, 10),
  rate = 0,
  Range = c(-Inf, Inf),
  B = 5000,
  minexpcount = 2,
  maxProcessors = 1,
  doMethod = "Default"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gof_test_cont_+3A_x">x</code></td>
<td>
<p>data set</p>
</td></tr>
<tr><td><code id="gof_test_cont_+3A_pnull">pnull</code></td>
<td>
<p>cdf under the null hypothesis</p>
</td></tr>
<tr><td><code id="gof_test_cont_+3A_rnull">rnull</code></td>
<td>
<p>routine to generate data under the null hypothesis</p>
</td></tr>
<tr><td><code id="gof_test_cont_+3A_qnull">qnull</code></td>
<td>
<p>routine to calculate quantiles under null hypothesis</p>
</td></tr>
<tr><td><code id="gof_test_cont_+3A_phat">phat</code></td>
<td>
<p>function to estimate parameters from the data</p>
</td></tr>
<tr><td><code id="gof_test_cont_+3A_ts">TS</code></td>
<td>
<p>user supplied function to find test statistics</p>
</td></tr>
<tr><td><code id="gof_test_cont_+3A_nbins">nbins</code></td>
<td>
<p>=c(100, 10) number of bins for chi-square tests</p>
</td></tr>
<tr><td><code id="gof_test_cont_+3A_rate">rate</code></td>
<td>
<p>=0 rate of Poisson if sample size is random, 0 if sample size is fixed</p>
</td></tr>
<tr><td><code id="gof_test_cont_+3A_range">Range</code></td>
<td>
<p>=c(-Inf, Inf) limits of possible observations, if any, for chi-square tests</p>
</td></tr>
<tr><td><code id="gof_test_cont_+3A_b">B</code></td>
<td>
<p>=5000  number of simulation runs</p>
</td></tr>
<tr><td><code id="gof_test_cont_+3A_minexpcount">minexpcount</code></td>
<td>
<p>=2 minimal expected bin count required</p>
</td></tr>
<tr><td><code id="gof_test_cont_+3A_maxprocessors">maxProcessors</code></td>
<td>
<p>=1number of processors to use in parallel processing. If missing single processor is used.</p>
</td></tr>
<tr><td><code id="gof_test_cont_+3A_domethod">doMethod</code></td>
<td>
<p>Methods to include in tests</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with vectors of test statistics and p values
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Tests to see whether data comes from a standard normal distribution.
pnull = function(x) pnorm(x)
qnull = function(x) qnorm(x)
rnull = function()  rnorm(100)
x = rnorm(100) 
gof_test_cont(x, pnull, rnull, qnull, doMethod="all")
# Tests to see whether data comes from a normal distribution with 
# mean and standard deviation estimated from the data.
pnull = function(x, p=c(0, 1)) pnorm(x, p[1], ifelse(p[2]&gt;0.001, p[2], 0.001))
qnull = function(x, p=c(0, 1)) qnorm(x, p[1],  ifelse(p[2]&gt;0.001, p[2], 0.001))
rnull = function(p=c(0, 1))  rnorm(100, p[1], ifelse(p[2]&gt;0.001, p[2], 0.001))
phat = function(x) c(mean(x), sd(x))
gof_test_cont(x, pnull, rnull, qnull, phat)

</code></pre>

<hr>
<h2 id='gof_test_disc'>This function performs a number of gof tests for discrete data.</h2><span id='topic+gof_test_disc'></span>

<h3>Description</h3>

<p>This function performs a number of gof tests for discrete data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gof_test_disc(
  x,
  pnull,
  rnull,
  vals,
  phat,
  TS,
  nbins = c(100, 10),
  rate = 0,
  B = 5000,
  minexpcount = 2,
  maxProcessors = 1,
  doMethod = "Default"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gof_test_disc_+3A_x">x</code></td>
<td>
<p>data set (the counts)</p>
</td></tr>
<tr><td><code id="gof_test_disc_+3A_pnull">pnull</code></td>
<td>
<p>cumulative distribution function under the null hypothesis</p>
</td></tr>
<tr><td><code id="gof_test_disc_+3A_rnull">rnull</code></td>
<td>
<p>routine to generate data under the null hypothesis</p>
</td></tr>
<tr><td><code id="gof_test_disc_+3A_vals">vals</code></td>
<td>
<p>a vector of values of discrete random variables</p>
</td></tr>
<tr><td><code id="gof_test_disc_+3A_phat">phat</code></td>
<td>
<p>a function to estimate parameters from the data</p>
</td></tr>
<tr><td><code id="gof_test_disc_+3A_ts">TS</code></td>
<td>
<p>user supplied function to find test statistics</p>
</td></tr>
<tr><td><code id="gof_test_disc_+3A_nbins">nbins</code></td>
<td>
<p>=c(100, 10) number of bins for chi-square tests</p>
</td></tr>
<tr><td><code id="gof_test_disc_+3A_rate">rate</code></td>
<td>
<p>=0 rate of Poisson if sample size is random, 0 if sample size is fixed</p>
</td></tr>
<tr><td><code id="gof_test_disc_+3A_b">B</code></td>
<td>
<p>=5000  number of simulation runs</p>
</td></tr>
<tr><td><code id="gof_test_disc_+3A_minexpcount">minexpcount</code></td>
<td>
<p>=2 minimal expected bin count required</p>
</td></tr>
<tr><td><code id="gof_test_disc_+3A_maxprocessors">maxProcessors</code></td>
<td>
<p>=1 number of processors to use in parallel processing. If missing single processor is used.</p>
</td></tr>
<tr><td><code id="gof_test_disc_+3A_domethod">doMethod</code></td>
<td>
<p>Methods to include in tests</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric matrix of test statistics and p values
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Tests to see whether data comes from a binomial (10, 0.5) distribution.
vals=0:10
pnull = function() pbinom(0:10, 10, 0.5)
rnull = function() table(c(0:10, rbinom(1000, 10, 0.5)))-1
x = rnull() 
gof_test_disc(x, pnull, rnull, vals, doMethod="all")
# Tests to see whether data comes from a binomial distribution with the success probability 
# estimated from the data.
pnull = function(p=0.5) pbinom(0:10, 10, ifelse(p&gt;0&amp;&amp;p&lt;1,p,0.001))
rnull = function(p=0.5) table(c(0:10, rbinom(1000, 10, ifelse(p&gt;0&amp;&amp;p&lt;1,p,0.001))))-1
phat = function(x) mean(0:10*x)/1000 
gof_test_disc(x, pnull, rnull, vals, phat)  
</code></pre>

<hr>
<h2 id='nm_calc'>calculate a matrix of numbers needed for Zhangs tests for discrete data</h2><span id='topic+nm_calc'></span>

<h3>Description</h3>

<p>calculate a matrix of numbers needed for Zhangs tests for discrete data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nm_calc(n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nm_calc_+3A_n">n</code></td>
<td>
<p>An integer.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of numbers
</p>

<hr>
<h2 id='plot_power'>This function draws the power graph, with curves sorted by the mean power and smoothed for easier reading.</h2><span id='topic+plot_power'></span>

<h3>Description</h3>

<p>This function draws the power graph, with curves sorted by the mean power and smoothed for easier reading.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_power(pwr, xname = " ", Smooth = TRUE, span = 0.25)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_power_+3A_pwr">pwr</code></td>
<td>
<p>a matrix of power values, usually from the twosample_power command</p>
</td></tr>
<tr><td><code id="plot_power_+3A_xname">xname</code></td>
<td>
<p>Name of variable on x axis</p>
</td></tr>
<tr><td><code id="plot_power_+3A_smooth">Smooth</code></td>
<td>
<p>=TRUE lines are smoothed for easier reading</p>
</td></tr>
<tr><td><code id="plot_power_+3A_span">span</code></td>
<td>
<p>=0.25bandwidth of smoothing method</p>
</td></tr>
</table>


<h3>Value</h3>

<p>plt, an object of class ggplot.
</p>

<hr>
<h2 id='power_cont'>find power of gof tests for continuous data</h2><span id='topic+power_cont'></span>

<h3>Description</h3>

<p>find power of gof tests for continuous data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>power_cont(
  pnull,
  rnull,
  qnull,
  ralt,
  param_alt,
  phat,
  TS,
  nbins = as.integer(c(100, 10)),
  rate = 0,
  Range = as.numeric(c(-99999, 99999)),
  B = as.integer(c(1000, 1000)),
  alpha = 0.05,
  minexpcount = 2
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="power_cont_+3A_pnull">pnull</code></td>
<td>
<p>R function (cdf)</p>
</td></tr>
<tr><td><code id="power_cont_+3A_rnull">rnull</code></td>
<td>
<p>R function (generate data under null hypothesis)</p>
</td></tr>
<tr><td><code id="power_cont_+3A_qnull">qnull</code></td>
<td>
<p>R function (quantiles under null hypothesis)</p>
</td></tr>
<tr><td><code id="power_cont_+3A_ralt">ralt</code></td>
<td>
<p>R function to generate data under alternative</p>
</td></tr>
<tr><td><code id="power_cont_+3A_param_alt">param_alt</code></td>
<td>
<p>parameters of ralt</p>
</td></tr>
<tr><td><code id="power_cont_+3A_phat">phat</code></td>
<td>
<p>function to estimate parameters from the data</p>
</td></tr>
<tr><td><code id="power_cont_+3A_ts">TS</code></td>
<td>
<p>function to calculate test statistics</p>
</td></tr>
<tr><td><code id="power_cont_+3A_nbins">nbins</code></td>
<td>
<p>=c(100,10) number of bins to use</p>
</td></tr>
<tr><td><code id="power_cont_+3A_rate">rate</code></td>
<td>
<p>rate of Poisson if sample size is random</p>
</td></tr>
<tr><td><code id="power_cont_+3A_range">Range</code></td>
<td>
<p>=(-99999, 99999) limits of possible observations, if any</p>
</td></tr>
<tr><td><code id="power_cont_+3A_b">B</code></td>
<td>
<p>=c(1000, 1000) Number of simulation runs for power and null distribution</p>
</td></tr>
<tr><td><code id="power_cont_+3A_alpha">alpha</code></td>
<td>
<p>=0.05, type I error of test</p>
</td></tr>
<tr><td><code id="power_cont_+3A_minexpcount">minexpcount</code></td>
<td>
<p>=2 minimal expected bin count required</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of powers
</p>

<hr>
<h2 id='power_disc'>find power of gof tests for discrete data</h2><span id='topic+power_disc'></span>

<h3>Description</h3>

<p>find power of gof tests for discrete data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>power_disc(
  pnull,
  rnull,
  vals,
  ralt,
  param_alt,
  phat,
  TS,
  nbins = as.integer(c(100, 10)),
  rate = 0,
  B = as.integer(c(1000, 1000)),
  alpha = 0.05,
  minexpcount = 2
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="power_disc_+3A_pnull">pnull</code></td>
<td>
<p>R function (cdf)</p>
</td></tr>
<tr><td><code id="power_disc_+3A_rnull">rnull</code></td>
<td>
<p>R function (generate data under null hypothesis)</p>
</td></tr>
<tr><td><code id="power_disc_+3A_vals">vals</code></td>
<td>
<p>vector of values of discrete random variable</p>
</td></tr>
<tr><td><code id="power_disc_+3A_ralt">ralt</code></td>
<td>
<p>R function to generate data under alternative</p>
</td></tr>
<tr><td><code id="power_disc_+3A_param_alt">param_alt</code></td>
<td>
<p>parameters of function ralt</p>
</td></tr>
<tr><td><code id="power_disc_+3A_phat">phat</code></td>
<td>
<p>function to estimate parameters from the data</p>
</td></tr>
<tr><td><code id="power_disc_+3A_ts">TS</code></td>
<td>
<p>function to calculate test statistics</p>
</td></tr>
<tr><td><code id="power_disc_+3A_nbins">nbins</code></td>
<td>
<p>=c(100,10) number of bins to use</p>
</td></tr>
<tr><td><code id="power_disc_+3A_rate">rate</code></td>
<td>
<p>rate of Poisson if sample size is random, 0 otherwise</p>
</td></tr>
<tr><td><code id="power_disc_+3A_b">B</code></td>
<td>
<p>=c(1000, 1000) Number of simulation runs for power and null distribution</p>
</td></tr>
<tr><td><code id="power_disc_+3A_alpha">alpha</code></td>
<td>
<p>=0.05, type I error of test</p>
</td></tr>
<tr><td><code id="power_disc_+3A_minexpcount">minexpcount</code></td>
<td>
<p>=2 minimal expected bin count required</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of powers
</p>

<hr>
<h2 id='TS_cont'>Find test statistics for continuous data</h2><span id='topic+TS_cont'></span>

<h3>Description</h3>

<p>Find test statistics for continuous data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TS_cont(x, Fx, param, qnull)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TS_cont_+3A_x">x</code></td>
<td>
<p>A numeric vector.</p>
</td></tr>
<tr><td><code id="TS_cont_+3A_fx">Fx</code></td>
<td>
<p>numeric vector of cdf probabilities.</p>
</td></tr>
<tr><td><code id="TS_cont_+3A_param">param</code></td>
<td>
<p>parameters for pnull</p>
</td></tr>
<tr><td><code id="TS_cont_+3A_qnull">qnull</code></td>
<td>
<p>An R function, the quantile function under the null hypothesis.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector with test statistics
</p>

<hr>
<h2 id='TS_disc'>Find test statistics for discrete data</h2><span id='topic+TS_disc'></span>

<h3>Description</h3>

<p>Find test statistics for discrete data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TS_disc(x, Fx, nm, vals)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TS_disc_+3A_x">x</code></td>
<td>
<p>An integer vector.</p>
</td></tr>
<tr><td><code id="TS_disc_+3A_fx">Fx</code></td>
<td>
<p>A numeric vector of cumulative probabilities.</p>
</td></tr>
<tr><td><code id="TS_disc_+3A_nm">nm</code></td>
<td>
<p>A matrix of pre-calculated (with nm_calc.cpp) numbers needed for Zhangs tests.</p>
</td></tr>
<tr><td><code id="TS_disc_+3A_vals">vals</code></td>
<td>
<p>A numeric vector with the values of the discrete rv.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with test statistics
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
