<!DOCTYPE html><html><head><title>Help for package ars</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ars}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ars'><p>Adaptive Rejection Sampling</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Adaptive Rejection Sampling</td>
</tr>
<tr>
<td>Version:</td>
<td>0.7</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-04-04</td>
</tr>
<tr>
<td>Author:</td>
<td>Paulino Perez Rodriguez &lt;perpdgo@colpos.mx&gt; original C++ code
        from Arnost Komarek based on ars.f written by P. Wild and W. R.
        Gilks</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Paulino Perez Rodriguez &lt;perpdgo@colpos.mx&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1.2)</td>
</tr>
<tr>
<td>Description:</td>
<td>Adaptive Rejection Sampling, Original version.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-04-05 15:14:36 UTC; pperez</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-04-05 16:03:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='ars'>Adaptive Rejection Sampling</h2><span id='topic+ars'></span>

<h3>Description</h3>

<p>Adaptive Rejection Sampling from log-concave density functions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ars(n=1,f,fprima,x=c(-4,1,4),ns=100,m=3,emax=64,lb=FALSE,ub=FALSE,xlb=0,xub=0,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ars_+3A_n">n</code></td>
<td>
<p>sample size</p>
</td></tr>
<tr><td><code id="ars_+3A_f">f</code></td>
<td>
<p>function that computes log(f(u,...)), for given u, where f(u) is proportional to the density we want to sample from</p>
</td></tr>
<tr><td><code id="ars_+3A_fprima">fprima</code></td>
<td>
<p>d/du log(f(u,...))</p>
</td></tr>
<tr><td><code id="ars_+3A_x">x</code></td>
<td>
<p>some starting points in wich log(f(u,...) is defined</p>
</td></tr>
<tr><td><code id="ars_+3A_ns">ns</code></td>
<td>
<p>maximum number of points defining the hulls</p>
</td></tr>
<tr><td><code id="ars_+3A_m">m</code></td>
<td>
<p>number of starting points</p>
</td></tr>
<tr><td><code id="ars_+3A_emax">emax</code></td>
<td>
<p>large value for which it is possible to compute an exponential</p>
</td></tr>
<tr><td><code id="ars_+3A_lb">lb</code></td>
<td>
<p>boolean indicating if there is a lower bound to the domain</p>
</td></tr>
<tr><td><code id="ars_+3A_xlb">xlb</code></td>
<td>
<p>value of the lower bound </p>
</td></tr>
<tr><td><code id="ars_+3A_ub">ub</code></td>
<td>
<p>boolean indicating if there is a upper bound to the domain</p>
</td></tr>
<tr><td><code id="ars_+3A_xub">xub</code></td>
<td>
<p>value of the upper bound bound </p>
</td></tr>
<tr><td><code id="ars_+3A_...">...</code></td>
<td>
<p>arguments to be passed to f and fprima</p>
</td></tr>
</table>


<h3>Details</h3>

<p><b>ifault codes, subroutine initial</b>
</p>

<dl>
<dt>0:</dt><dd><p>successful initialisation</p>
</dd>
<dt>1:</dt><dd><p>not enough starting points</p>
</dd>
<dt>2:</dt><dd><p>ns is less than m</p>
</dd>
<dt>3:</dt><dd><p>no abscissae to left of mode (if lb = false)</p>
</dd>
<dt>4:</dt><dd><p>no abscissae to right of mode (if ub = false)</p>
</dd>
<dt>5:</dt><dd><p>non-log-concavity detect</p>
</dd>
</dl>

<p><b>ifault codes, subroutine sample</b>
</p>

<dl>
<dt>0:</dt><dd><p>successful sampling</p>
</dd>
<dt>5:</dt><dd><p>non-concavity detected</p>
</dd>
<dt>6:</dt><dd><p>random number generator generated zero</p>
</dd>
<dt>7:</dt><dd><p>numerical instability</p>
</dd>
</dl>



<h3>Value</h3>

<p>a sampled value from density 
</p>


<h3>Author(s)</h3>

<p>Paulino Perez Rodriguez, original C++ code from Arnost Komarek based on ars.f written by P. Wild and W. R. Gilks
</p>


<h3>References</h3>

<p>Gilks, W.R., P. Wild. (1992)
Adaptive Rejection Sampling  for Gibbs Sampling, <em>Applied Statistics</em>
<b>41</b>:337&ndash;348.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(ars)

#Example 1: sample 20 values from the normal distribution N(2,3)
f&lt;-function(x,mu=0,sigma=1){-1/(2*sigma^2)*(x-mu)^2}
fprima&lt;-function(x,mu=0,sigma=1){-1/sigma^2*(x-mu)}
mysample&lt;-ars(20,f,fprima,mu=2,sigma=3)
mysample
hist(mysample)

#Example 2: sample 20 values from a gamma(2,0.5)
f1&lt;-function(x,shape,scale=1){(shape-1)*log(x)-x/scale}
f1prima&lt;-function(x,shape,scale=1) {(shape-1)/x-1/scale}
mysample1&lt;-ars(20,f1,f1prima,x=4.5,m=1,lb=TRUE,xlb=0,shape=2,scale=0.5)
mysample1
hist(mysample1)

#Example 3: sample 20 values from a beta(1.3,2.7) distribution
f2&lt;-function(x,a,b){(a-1)*log(x)+(b-1)*log(1-x)}
f2prima&lt;-function(x,a,b){(a-1)/x-(b-1)/(1-x)}
mysample2&lt;-ars(20,f2,f2prima,x=c(0.3,0.6),m=2,lb=TRUE,xlb=0,ub=TRUE,xub=1,a=1.3,b=2.7)
mysample2
hist(mysample2)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
