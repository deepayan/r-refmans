<!DOCTYPE html><html><head><title>Help for package opentripplanner</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {opentripplanner}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#opentripplanner-package'><p>OpenTripPlanner of R</p></a></li>
<li><a href='#json_example_drive'><p>Example JSON for driving</p></a></li>
<li><a href='#json_example_long_drive'><p>Example JSON for driving long distance</p></a></li>
<li><a href='#json_example_transit'><p>Example JSON for transit</p></a></li>
<li><a href='#otp_build_graph'><p>Build an OTP Graph</p></a></li>
<li><a href='#otp_check_java'><p>Check Java version</p></a></li>
<li><a href='#otp_check_version'><p>Check the what version of OTP the server is running</p></a></li>
<li><a href='#otp_connect'><p>Set up and confirm a connection to an OTP instance.</p></a></li>
<li><a href='#otp_dl_demo'><p>Download Demo Data</p></a></li>
<li><a href='#otp_dl_jar'><p>Download OTP Jar File</p></a></li>
<li><a href='#otp_geocode'><p>Use OTP Geo-coder to find a location</p></a></li>
<li><a href='#otp_isochrone'><p>Get the Isochrones from a location</p></a></li>
<li><a href='#otp_make_config'><p>Make Config Object</p></a></li>
<li><a href='#otp_make_surface'><p>Make a Surface</p></a></li>
<li><a href='#otp_plan'><p>Get get a route or routes from the OTP</p></a></li>
<li><a href='#otp_pointset'><p>Create a pointset</p></a></li>
<li><a href='#otp_routing_options'><p>Make routingOptions object</p></a></li>
<li><a href='#otp_setup'><p>Set up an OTP instance.</p></a></li>
<li><a href='#otp_stop'><p>Stop and OTP Instance</p></a></li>
<li><a href='#otp_surface'><p>Evaluate a surface against a pointset</p></a></li>
<li><a href='#otp_surface_isochrone'><p>Make an isochrone from a surface</p></a></li>
<li><a href='#otp_traveltime'><p>Get travel times between points</p></a></li>
<li><a href='#otp_validate_config'><p>Validate Config Object</p></a></li>
<li><a href='#otp_validate_routing_options'><p>Validate routingOptions object</p></a></li>
<li><a href='#otp_write_config'><p>Write config object as json file</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Setup and connect to 'OpenTripPlanner'</td>
</tr>
<tr>
<td>Version:</td>
<td>0.5.2</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Malcolm Morgan &lt;m.morgan1@leeds.ac.uk&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Setup and connect to 'OpenTripPlanner' (OTP) <a href="http://www.opentripplanner.org/">http://www.opentripplanner.org/</a>.
    OTP is an open source platform for multi-modal and multi-agency
    journey planning written in 'Java'. The package allows you to manage a local version or 
    connect to remote OTP server to find walking, cycling, driving, or transit routes.
    This package has been peer-reviewed by rOpenSci (v. 0.2.0.0).</td>
</tr>
<tr>
<td>Language:</td>
<td>EN-GB</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/ropensci/opentripplanner">https://github.com/ropensci/opentripplanner</a>,
<a href="https://docs.ropensci.org/opentripplanner/">https://docs.ropensci.org/opentripplanner/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/ropensci/opentripplanner/issues">https://github.com/ropensci/opentripplanner/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>checkmate, data.table, geodist, googlePolylines, curl, rjson,
purrr (&ge; 1.0.0), RcppSimdJson (&ge; 0.1.2), progressr, sf (&ge;
0.9.3), sfheaders</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>covr, knitr, rmarkdown, testthat, terra, tibble</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-05-06 06:27:00 UTC; earmmor</td>
</tr>
<tr>
<td>Author:</td>
<td>Malcolm Morgan <a href="https://orcid.org/0000-0002-9488-9183"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Marcus Young <a href="https://orcid.org/0000-0003-4627-1116"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Robin Lovelace <a href="https://orcid.org/0000-0001-5679-6536"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Layik Hama <a href="https://orcid.org/0000-0003-1912-4890"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-05-06 07:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='opentripplanner-package'>OpenTripPlanner of R</h2><span id='topic+opentripplanner'></span><span id='topic+opentripplanner-package'></span>

<h3>Description</h3>

<p>The goal of OpenTripPlanner for R is to provide a simple R interface
to OpenTripPlanner (OTP).
The OTP is a multimodal trip planning service.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Malcolm Morgan <a href="mailto:m.morgan1@leeds.ac.uk">m.morgan1@leeds.ac.uk</a> (<a href="https://orcid.org/0000-0002-9488-9183">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Marcus Young <a href="mailto:M.A.Young@soton.ac.uk">M.A.Young@soton.ac.uk</a> (<a href="https://orcid.org/0000-0003-4627-1116">ORCID</a>)
</p>
</li>
<li><p> Robin Lovelace <a href="mailto:rob00x@gmail.com">rob00x@gmail.com</a> (<a href="https://orcid.org/0000-0001-5679-6536">ORCID</a>)
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Layik Hama <a href="mailto:layik.hama@gmail.com">layik.hama@gmail.com</a> (<a href="https://orcid.org/0000-0003-1912-4890">ORCID</a>) [contributor]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/ropensci/opentripplanner">https://github.com/ropensci/opentripplanner</a>
</p>
</li>
<li> <p><a href="https://docs.ropensci.org/opentripplanner/">https://docs.ropensci.org/opentripplanner/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/ropensci/opentripplanner/issues">https://github.com/ropensci/opentripplanner/issues</a>
</p>
</li></ul>


<hr>
<h2 id='json_example_drive'>Example JSON for driving</h2><span id='topic+json_example_drive'></span>

<h3>Description</h3>

<p>Example JSON response from OTP
This is used for internal testing and has no use
</p>


<h3>Usage</h3>

<pre><code class='language-R'>json_example_drive
</code></pre>


<h3>Format</h3>

<p>json
</p>

<hr>
<h2 id='json_example_long_drive'>Example JSON for driving long distance</h2><span id='topic+json_example_long_drive'></span>

<h3>Description</h3>

<p>Example JSON response from OTP
This is used for internal testing and has no use
</p>


<h3>Usage</h3>

<pre><code class='language-R'>json_example_long_drive
</code></pre>


<h3>Format</h3>

<p>json
</p>

<hr>
<h2 id='json_example_transit'>Example JSON for transit</h2><span id='topic+json_example_transit'></span>

<h3>Description</h3>

<p>Example JSON response from OTP
This is used for internal testing and has no use
</p>


<h3>Usage</h3>

<pre><code class='language-R'>json_example_transit
</code></pre>


<h3>Format</h3>

<p>json
</p>

<hr>
<h2 id='otp_build_graph'>Build an OTP Graph</h2><span id='topic+otp_build_graph'></span>

<h3>Description</h3>

<p>OTP is run in Java and requires Java commands to be typed into
the command line. The function allows the parameters to be defined in R and
automatically passed to Java. This function builds a OTP graph from the
Open Street Map and other files.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>otp_build_graph(
  otp = NULL,
  dir = NULL,
  memory = 2048,
  router = "default",
  flag64bit = TRUE,
  quiet = TRUE,
  otp_version = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="otp_build_graph_+3A_otp">otp</code></td>
<td>
<p>A character string, path to the OTP .jar file</p>
</td></tr>
<tr><td><code id="otp_build_graph_+3A_dir">dir</code></td>
<td>
<p>A character string, path to a directory containing the necessary
files, see details</p>
</td></tr>
<tr><td><code id="otp_build_graph_+3A_memory">memory</code></td>
<td>
<p>A positive integer. Amount of memory to assign to the OTP in
MB, default is 2048</p>
</td></tr>
<tr><td><code id="otp_build_graph_+3A_router">router</code></td>
<td>
<p>A character string for the name of the router, must subfolder
of  dir/graphs, default &quot;default&quot;. See vignettes for details.</p>
</td></tr>
<tr><td><code id="otp_build_graph_+3A_flag64bit">flag64bit</code></td>
<td>
<p>Logical, if true the -d64 flag is added to Java instructions,
ignored if otp_version &gt;= 2</p>
</td></tr>
<tr><td><code id="otp_build_graph_+3A_quiet">quiet</code></td>
<td>
<p>Logical, if FALSE the Java commands will be printed to console</p>
</td></tr>
<tr><td><code id="otp_build_graph_+3A_otp_version">otp_version</code></td>
<td>
<p>Numeric, version of OTP to build, default NULL when version
is auto-detected</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The OTP .jar file can be downloaded from
https://repo1.maven.org/maven2/org/opentripplanner/otp/
</p>
<p>To build an OTP graph requires the following files to be in the directory
specified by the dir variable.
</p>
<p>/graphs - A sub-directory
</p>
<p>/default - A sub-directory with the name of the OTP router used in router'
variable
</p>
<p>osm.pbf - Required, pbf file containing the Open Street Map
</p>
<p>router-config.json - Required, json file containing configurations settings
for the OTP
</p>
<p>gtfs.zip - Optional, and number of GTFS files with transit timetables
</p>
<p>terrain.tif - Optional, GeoTiff image of terrain map
</p>
<p>The function will accept any file name for the .jar file, but it must be
the only .jar file in that directory OTP can support multiple routers (e.g.
different regions), each router must have its own sub-directory in the
graphs directory
</p>


<h3>Value</h3>

<p>Character vector of messages produced by OTP, and will return the
message &quot;Graph built&quot; if successful
</p>


<h3>See Also</h3>

<p>Other setup: 
<code><a href="#topic+otp_check_java">otp_check_java</a>()</code>,
<code><a href="#topic+otp_check_version">otp_check_version</a>()</code>,
<code><a href="#topic+otp_dl_demo">otp_dl_demo</a>()</code>,
<code><a href="#topic+otp_dl_jar">otp_dl_jar</a>()</code>,
<code><a href="#topic+otp_make_config">otp_make_config</a>()</code>,
<code><a href="#topic+otp_setup">otp_setup</a>()</code>,
<code><a href="#topic+otp_stop">otp_stop</a>()</code>,
<code><a href="#topic+otp_validate_config">otp_validate_config</a>()</code>,
<code><a href="#topic+otp_write_config">otp_write_config</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
log &lt;- otp_build_graph(otp = "C:/otp/otp.jar", dir = "C:/data")

## End(Not run)
</code></pre>

<hr>
<h2 id='otp_check_java'>Check Java version</h2><span id='topic+otp_check_java'></span>

<h3>Description</h3>

<p>Check if you have the correct version of Java for running OTP locally
</p>


<h3>Usage</h3>

<pre><code class='language-R'>otp_check_java(otp_version = 1.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="otp_check_java_+3A_otp_version">otp_version</code></td>
<td>
<p>numeric, OTP version number default 1.5</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other setup: 
<code><a href="#topic+otp_build_graph">otp_build_graph</a>()</code>,
<code><a href="#topic+otp_check_version">otp_check_version</a>()</code>,
<code><a href="#topic+otp_dl_demo">otp_dl_demo</a>()</code>,
<code><a href="#topic+otp_dl_jar">otp_dl_jar</a>()</code>,
<code><a href="#topic+otp_make_config">otp_make_config</a>()</code>,
<code><a href="#topic+otp_setup">otp_setup</a>()</code>,
<code><a href="#topic+otp_stop">otp_stop</a>()</code>,
<code><a href="#topic+otp_validate_config">otp_validate_config</a>()</code>,
<code><a href="#topic+otp_write_config">otp_write_config</a>()</code>
</p>

<hr>
<h2 id='otp_check_version'>Check the what version of OTP the server is running</h2><span id='topic+otp_check_version'></span>

<h3>Description</h3>

<p>Check the what version of OTP the server is running
</p>


<h3>Usage</h3>

<pre><code class='language-R'>otp_check_version(otpcon, warn = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="otp_check_version_+3A_otpcon">otpcon</code></td>
<td>
<p>otpcon object from otp_connect()</p>
</td></tr>
<tr><td><code id="otp_check_version_+3A_warn">warn</code></td>
<td>
<p>logical, if TRUE will check that OTP version matches contents of otpcon</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other setup: 
<code><a href="#topic+otp_build_graph">otp_build_graph</a>()</code>,
<code><a href="#topic+otp_check_java">otp_check_java</a>()</code>,
<code><a href="#topic+otp_dl_demo">otp_dl_demo</a>()</code>,
<code><a href="#topic+otp_dl_jar">otp_dl_jar</a>()</code>,
<code><a href="#topic+otp_make_config">otp_make_config</a>()</code>,
<code><a href="#topic+otp_setup">otp_setup</a>()</code>,
<code><a href="#topic+otp_stop">otp_stop</a>()</code>,
<code><a href="#topic+otp_validate_config">otp_validate_config</a>()</code>,
<code><a href="#topic+otp_write_config">otp_write_config</a>()</code>
</p>

<hr>
<h2 id='otp_connect'>Set up and confirm a connection to an OTP instance.</h2><span id='topic+otp_connect'></span>

<h3>Description</h3>

<p>Defines the parameters required to connect to a router on an OTP instance
and, if required, confirms that the instance and router are query-able.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>otp_connect(
  hostname = "localhost",
  router = "default",
  url = NULL,
  port = 8080,
  ssl = FALSE,
  check = TRUE,
  timezone = Sys.timezone(),
  otp_version = 1.5
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="otp_connect_+3A_hostname">hostname</code></td>
<td>
<p>A string, e.g.
&quot;ec2-34-217-73-26.us-west-2.compute.amazonaws.com&quot;. Optional, default is
&quot;localhost&quot;.</p>
</td></tr>
<tr><td><code id="otp_connect_+3A_router">router</code></td>
<td>
<p>A string, e.g. &quot;UK2018&quot;. Optional, default is &quot;default&quot;. OTP
can support multiple routers see advanced vignette for details.</p>
</td></tr>
<tr><td><code id="otp_connect_+3A_url">url</code></td>
<td>
<p>If a non-standard URL structure is used provide a full url,
default is NULL</p>
</td></tr>
<tr><td><code id="otp_connect_+3A_port">port</code></td>
<td>
<p>A positive integer. Optional, default is 8080.</p>
</td></tr>
<tr><td><code id="otp_connect_+3A_ssl">ssl</code></td>
<td>
<p>Logical, indicates whether to use https. Optional, default is
FALSE.</p>
</td></tr>
<tr><td><code id="otp_connect_+3A_check">check</code></td>
<td>
<p>Logical. If TRUE connection object is only returned if OTP
instance and router are confirmed reachable. Optional, default is TRUE.</p>
</td></tr>
<tr><td><code id="otp_connect_+3A_timezone">timezone</code></td>
<td>
<p>Character, timezone, defaults to local timezone</p>
</td></tr>
<tr><td><code id="otp_connect_+3A_otp_version">otp_version</code></td>
<td>
<p>Numeric, OTP Version in use default 1.5, if check is TRUE
then 'otp_check_version()' is called and otp_version is updated</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The default URL structure for the OTP API is:
http://&lt;hostname&gt;:&lt;port&gt;/otp/routers/&lt;router&gt; For example:
http://localhost:8080/otp/routers/default
</p>
<p>Functions construct the URL from the parameters provided in otpconnect
objects. However some websites hosting OTP have modified the default URL
structure. If this is the case you can use the <code>url</code> parameter to bypass
the URL construction and provide a fully formed URL. In this case the
<code>hostname</code>, <code>router</code>, <code>port</code>, and <code>ssl</code> are ignored.
</p>


<h3>Value</h3>

<p>Returns an S3 object of class otpconnect. If <code>check</code> is TRUE and
the router is not reachable the object is not returned.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
otpcon &lt;- otp_connect()
otpcon &lt;- otp_connect(
  router = "UK2018",
  ssl = TRUE
)
otpcon &lt;- otp_connect(
  hostname = "ec2.us-west-2.compute.amazonaws.com",
  router = "UK2018",
  port = 8888,
  ssl = TRUE
)
otpcon &lt;- otp_connect(
  url = "https://api.digitransit.fi:443/routing/v1/routers/hsl"
)

## End(Not run)
</code></pre>

<hr>
<h2 id='otp_dl_demo'>Download Demo Data</h2><span id='topic+otp_dl_demo'></span>

<h3>Description</h3>

<p>Download the demonstration data for the Isle of Wight
</p>


<h3>Usage</h3>

<pre><code class='language-R'>otp_dl_demo(
  path_data = NULL,
  url = paste0("https://github.com/ropensci/opentripplanner/",
    "releases/download/0.1/isle-of-wight-demo.zip"),
  quiet = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="otp_dl_demo_+3A_path_data">path_data</code></td>
<td>
<p>path to folder where data for OTP is to be stored</p>
</td></tr>
<tr><td><code id="otp_dl_demo_+3A_url">url</code></td>
<td>
<p>URL to data</p>
</td></tr>
<tr><td><code id="otp_dl_demo_+3A_quiet">quiet</code></td>
<td>
<p>logical, passed to download.file, default FALSE</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other setup: 
<code><a href="#topic+otp_build_graph">otp_build_graph</a>()</code>,
<code><a href="#topic+otp_check_java">otp_check_java</a>()</code>,
<code><a href="#topic+otp_check_version">otp_check_version</a>()</code>,
<code><a href="#topic+otp_dl_jar">otp_dl_jar</a>()</code>,
<code><a href="#topic+otp_make_config">otp_make_config</a>()</code>,
<code><a href="#topic+otp_setup">otp_setup</a>()</code>,
<code><a href="#topic+otp_stop">otp_stop</a>()</code>,
<code><a href="#topic+otp_validate_config">otp_validate_config</a>()</code>,
<code><a href="#topic+otp_write_config">otp_write_config</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
otp_dl_demo(tempdir())

## End(Not run)
</code></pre>

<hr>
<h2 id='otp_dl_jar'>Download OTP Jar File</h2><span id='topic+otp_dl_jar'></span>

<h3>Description</h3>

<p>Download the OTP jar file from maven.org
</p>


<h3>Usage</h3>

<pre><code class='language-R'>otp_dl_jar(
  path = NULL,
  version = "1.5.0",
  file_name = paste0("otp-", version, "-shaded.jar"),
  url = "https://repo1.maven.org/maven2/org/opentripplanner/otp",
  quiet = FALSE,
  cache = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="otp_dl_jar_+3A_path">path</code></td>
<td>
<p>path to folder where OTP is to be stored</p>
</td></tr>
<tr><td><code id="otp_dl_jar_+3A_version">version</code></td>
<td>
<p>a character string of the version number default is &quot;1.5.0&quot;</p>
</td></tr>
<tr><td><code id="otp_dl_jar_+3A_file_name">file_name</code></td>
<td>
<p>file name to give the otp default &quot;otp.jar&quot;</p>
</td></tr>
<tr><td><code id="otp_dl_jar_+3A_url">url</code></td>
<td>
<p>URL to the download server</p>
</td></tr>
<tr><td><code id="otp_dl_jar_+3A_quiet">quiet</code></td>
<td>
<p>logical, passed to download.file, default FALSE</p>
</td></tr>
<tr><td><code id="otp_dl_jar_+3A_cache">cache</code></td>
<td>
<p>logical, default TRUE, see details</p>
</td></tr>
</table>


<h3>Details</h3>

<p>As of version 0.3.0.0 'otp_dl_jar' will cache the JAR file within
the package and ignore the 'path' argument. You can force a new download to
be saved in the 'path' location by setting 'cache = FALSE'.
</p>


<h3>Value</h3>

<p>The path to the OTP file
</p>


<h3>See Also</h3>

<p>Other setup: 
<code><a href="#topic+otp_build_graph">otp_build_graph</a>()</code>,
<code><a href="#topic+otp_check_java">otp_check_java</a>()</code>,
<code><a href="#topic+otp_check_version">otp_check_version</a>()</code>,
<code><a href="#topic+otp_dl_demo">otp_dl_demo</a>()</code>,
<code><a href="#topic+otp_make_config">otp_make_config</a>()</code>,
<code><a href="#topic+otp_setup">otp_setup</a>()</code>,
<code><a href="#topic+otp_stop">otp_stop</a>()</code>,
<code><a href="#topic+otp_validate_config">otp_validate_config</a>()</code>,
<code><a href="#topic+otp_write_config">otp_write_config</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
otp_dl_jar(tempdir())

## End(Not run)
</code></pre>

<hr>
<h2 id='otp_geocode'>Use OTP Geo-coder to find a location</h2><span id='topic+otp_geocode'></span>

<h3>Description</h3>

<p>Geo-coding converts a named place, such as a street name into a
lng/lat pair.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>otp_geocode(
  otpcon = NULL,
  query = NULL,
  autocomplete = FALSE,
  stops = TRUE,
  clusters = FALSE,
  corners = TRUE,
  type = "SF"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="otp_geocode_+3A_otpcon">otpcon</code></td>
<td>
<p>OTP connection object produced by otp_connect()</p>
</td></tr>
<tr><td><code id="otp_geocode_+3A_query">query</code></td>
<td>
<p>Character, The query string we want to geocode</p>
</td></tr>
<tr><td><code id="otp_geocode_+3A_autocomplete">autocomplete</code></td>
<td>
<p>logical Whether we should use the query
string to do a prefix match, default FALSE</p>
</td></tr>
<tr><td><code id="otp_geocode_+3A_stops">stops</code></td>
<td>
<p>Logical, Search for stops, either by name or
stop code, default TRUE</p>
</td></tr>
<tr><td><code id="otp_geocode_+3A_clusters">clusters</code></td>
<td>
<p>Logical, Search for clusters by their name,
default FALSE</p>
</td></tr>
<tr><td><code id="otp_geocode_+3A_corners">corners</code></td>
<td>
<p>Logical, Search for street corners using at
least one of the street names, default TRUE</p>
</td></tr>
<tr><td><code id="otp_geocode_+3A_type">type</code></td>
<td>
<p>Character, How should results be returned can
be &quot;SF&quot; or &quot;Coordinates&quot; or &quot;Both&quot;, Default &quot;SF&quot;</p>
</td></tr>
</table>


<h3>Details</h3>

<p>OTP will return a maximum of 10 results
</p>


<h3>Value</h3>

<p>Returns a data.frame of SF POINTS or Coordinates of all
the locations that match 'query'
</p>


<h3>See Also</h3>

<p>Other routing: 
<code><a href="#topic+otp_isochrone">otp_isochrone</a>()</code>,
<code><a href="#topic+otp_plan">otp_plan</a>()</code>,
<code><a href="#topic+otp_pointset">otp_pointset</a>()</code>,
<code><a href="#topic+otp_routing_options">otp_routing_options</a>()</code>,
<code><a href="#topic+otp_validate_routing_options">otp_validate_routing_options</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
locations &lt;- otp_geocode(otpcon, "High Street")

## End(Not run)
</code></pre>

<hr>
<h2 id='otp_isochrone'>Get the Isochrones from a location</h2><span id='topic+otp_isochrone'></span>

<h3>Description</h3>

<p>Get the Isochrones from a location
</p>


<h3>Usage</h3>

<pre><code class='language-R'>otp_isochrone(
  otpcon = NA,
  fromPlace = NA,
  fromID = NULL,
  mode = "CAR",
  date_time = Sys.time(),
  arriveBy = FALSE,
  maxWalkDistance = 1000,
  routingOptions = NULL,
  cutoffSec = c(600, 1200, 1800, 2400, 3000, 3600),
  ncores = max(round(parallel::detectCores() * 1.25) - 1, 1),
  timezone = otpcon$timezone
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="otp_isochrone_+3A_otpcon">otpcon</code></td>
<td>
<p>OTP connection object produced by otp_connect()</p>
</td></tr>
<tr><td><code id="otp_isochrone_+3A_fromplace">fromPlace</code></td>
<td>
<p>Numeric vector, Longitude/Latitude pair,
e.g. 'c(-0.134649,51.529258)',
or 2 column matrix of Longitude/Latitude pairs, or sf
data frame of POINTS</p>
</td></tr>
<tr><td><code id="otp_isochrone_+3A_fromid">fromID</code></td>
<td>
<p>character vector same length as fromPlace</p>
</td></tr>
<tr><td><code id="otp_isochrone_+3A_mode">mode</code></td>
<td>
<p>character vector of one or more modes of travel valid values
&quot;TRANSIT&quot;,&quot;BUS&quot;, &quot;RAIL&quot;, &quot;SUBWAY&quot;,&quot;TRAM&quot;, &quot;FERRY&quot;, &quot;GONDOLA&quot;, &quot;FUNICULAR&quot;,
&quot;AIRPLANE&quot;, &quot;CABLE_CAR&quot;, &quot;WALK&quot;, &quot;BICYCLE&quot;, &quot;BICYCLE_RENT&quot;, &quot;BICYCLE_PARK&quot;,
&quot;CAR&quot;, &quot;CAR_PARK&quot;, &quot;CAR_HAIL&quot;, &quot;CARPOOL&quot;, &quot;CAR_DROPOFF&quot;, &quot;CAR_PICKUP&quot;, default
CAR. Not all combinations are valid e.g. c(&quot;WALK&quot;,&quot;BUS&quot;) is valid but
c(&quot;WALK&quot;,&quot;CAR&quot;) is not.</p>
</td></tr>
<tr><td><code id="otp_isochrone_+3A_date_time">date_time</code></td>
<td>
<p>POSIXct, a date and time, defaults to current
date and time</p>
</td></tr>
<tr><td><code id="otp_isochrone_+3A_arriveby">arriveBy</code></td>
<td>
<p>Logical, Whether the trip should depart or
arrive at the specified date and time, default FALSE</p>
</td></tr>
<tr><td><code id="otp_isochrone_+3A_maxwalkdistance">maxWalkDistance</code></td>
<td>
<p>maximum distance to walk in metres</p>
</td></tr>
<tr><td><code id="otp_isochrone_+3A_routingoptions">routingOptions</code></td>
<td>
<p>named list passed to OTP see 'otp_routing_options()'</p>
</td></tr>
<tr><td><code id="otp_isochrone_+3A_cutoffsec">cutoffSec</code></td>
<td>
<p>Numeric vector, number of seconds to define
the break points of each Isochrone</p>
</td></tr>
<tr><td><code id="otp_isochrone_+3A_ncores">ncores</code></td>
<td>
<p>number of cores to use in parallel processing</p>
</td></tr>
<tr><td><code id="otp_isochrone_+3A_timezone">timezone</code></td>
<td>
<p>character, timezone to use, default from otpcon</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Isochrones are maps of equal travel time,
for a given location a map is produced showing how long it takes to reach
each location.
</p>
<p>Isochrones are only available from OTP v1.x and will not work with v2.0
</p>


<h3>Value</h3>

<p>Returns a SF data.frame of POLYGONs
</p>


<h3>See Also</h3>

<p>Other routing: 
<code><a href="#topic+otp_geocode">otp_geocode</a>()</code>,
<code><a href="#topic+otp_plan">otp_plan</a>()</code>,
<code><a href="#topic+otp_pointset">otp_pointset</a>()</code>,
<code><a href="#topic+otp_routing_options">otp_routing_options</a>()</code>,
<code><a href="#topic+otp_validate_routing_options">otp_validate_routing_options</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
isochrone1 &lt;- otp_isochrone(otpcon, fromPlace = c(-0.1346, 51.5292))
isochrone2 &lt;- otp_isochrone(otpcon,
  fromPlace = c(-0.1346, 51.5292),
  mode = c("WALK", "TRANSIT"), cutoffSec = c(600, 1200, 1800)
)

## End(Not run)
</code></pre>

<hr>
<h2 id='otp_make_config'>Make Config Object</h2><span id='topic+otp_make_config'></span>

<h3>Description</h3>

<p>OTP can be configured using three json files 'otp-config.json',
'build-config.json', and 'router-config.json'. This function
creates a named list for each config file and
populates the defaults values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>otp_make_config(type, version = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="otp_make_config_+3A_type">type</code></td>
<td>
<p>Which type of config file to create, &quot;otp&quot;, &quot;build&quot;, &quot;router&quot;</p>
</td></tr>
<tr><td><code id="otp_make_config_+3A_version">version</code></td>
<td>
<p>version of OPT e.g. 1 or 2</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For more details see:
http://docs.opentripplanner.org/en/latest/Configuration
</p>


<h3>See Also</h3>

<p>Other setup: 
<code><a href="#topic+otp_build_graph">otp_build_graph</a>()</code>,
<code><a href="#topic+otp_check_java">otp_check_java</a>()</code>,
<code><a href="#topic+otp_check_version">otp_check_version</a>()</code>,
<code><a href="#topic+otp_dl_demo">otp_dl_demo</a>()</code>,
<code><a href="#topic+otp_dl_jar">otp_dl_jar</a>()</code>,
<code><a href="#topic+otp_setup">otp_setup</a>()</code>,
<code><a href="#topic+otp_stop">otp_stop</a>()</code>,
<code><a href="#topic+otp_validate_config">otp_validate_config</a>()</code>,
<code><a href="#topic+otp_write_config">otp_write_config</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>{
  conf &lt;- otp_make_config("build")
  conf &lt;- otp_make_config("router")
}
</code></pre>

<hr>
<h2 id='otp_make_surface'>Make a Surface</h2><span id='topic+otp_make_surface'></span>

<h3>Description</h3>

<p>Requires OTP 1.x and the analyst
</p>


<h3>Usage</h3>

<pre><code class='language-R'>otp_make_surface(
  otpcon = NULL,
  fromPlace = c(-1.17502, 50.6459),
  mode = "CAR",
  date_time = Sys.time(),
  maxWalkDistance = 1000,
  arriveBy = FALSE,
  routeOptions = NULL,
  timezone = otpcon$timezone,
  ncores = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="otp_make_surface_+3A_otpcon">otpcon</code></td>
<td>
<p>OTP connection object produced by otp_connect()</p>
</td></tr>
<tr><td><code id="otp_make_surface_+3A_fromplace">fromPlace</code></td>
<td>
<p>Numeric vector, Longitude/Latitude pair, e.g.
'c(-0.134649,51.529258)', or 2 column matrix of Longitude/Latitude pairs,
or sf data frame of POINTS with CRS 4326</p>
</td></tr>
<tr><td><code id="otp_make_surface_+3A_mode">mode</code></td>
<td>
<p>character vector of one or more modes of travel valid values
TRANSIT, WALK, BICYCLE, CAR, BUS, RAIL, SUBWAY, TRAM, FERRY, default CAR.
Not all combinations are valid e.g. c(&quot;WALK&quot;,&quot;BUS&quot;) is valid but
c(&quot;WALK&quot;,&quot;CAR&quot;) is not.</p>
</td></tr>
<tr><td><code id="otp_make_surface_+3A_date_time">date_time</code></td>
<td>
<p>POSIXct, a date and time, defaults to current date and time</p>
</td></tr>
<tr><td><code id="otp_make_surface_+3A_maxwalkdistance">maxWalkDistance</code></td>
<td>
<p>Numeric passed to OTP in metres</p>
</td></tr>
<tr><td><code id="otp_make_surface_+3A_arriveby">arriveBy</code></td>
<td>
<p>Logical, Whether the trip should depart or arrive at the
specified date and time, default FALSE</p>
</td></tr>
<tr><td><code id="otp_make_surface_+3A_routeoptions">routeOptions</code></td>
<td>
<p>Named list of values passed to OTP use</p>
</td></tr>
<tr><td><code id="otp_make_surface_+3A_timezone">timezone</code></td>
<td>
<p>Character, what timezone to use, see as.POSIXct, default is
local timezone</p>
</td></tr>
<tr><td><code id="otp_make_surface_+3A_ncores">ncores</code></td>
<td>
<p>How many cores to use default = 1</p>
</td></tr>
</table>


<h3>Details</h3>

<p>THis function requires the analysis and pointset features to be
enabled during 'otp_setup()'. Thus it will only work with OTP 1.x. For more
detail see the analyst vignette.
</p>


<h3>Value</h3>

<p>Returns a list with information about the surface created
</p>


<h3>See Also</h3>

<p>Other analyst: 
<code><a href="#topic+otp_traveltime">otp_traveltime</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
surface &lt;- otp_make_surface(otpcon, c(-1.17502, 50.64590))

## End(Not run)
</code></pre>

<hr>
<h2 id='otp_plan'>Get get a route or routes from the OTP</h2><span id='topic+otp_plan'></span>

<h3>Description</h3>

<p>This is the main routing function for OTP and can find single or
multiple routes between 'fromPlace' and 'toPlace'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>otp_plan(
  otpcon = NA,
  fromPlace = NA,
  toPlace = NA,
  fromID = NULL,
  toID = NULL,
  mode = "CAR",
  date_time = Sys.time(),
  arriveBy = FALSE,
  maxWalkDistance = 1000,
  numItineraries = 3,
  routeOptions = NULL,
  full_elevation = FALSE,
  get_geometry = TRUE,
  ncores = max(round(parallel::detectCores() * 1.25) - 1, 1),
  timezone = otpcon$timezone,
  distance_balance = FALSE,
  get_elevation = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="otp_plan_+3A_otpcon">otpcon</code></td>
<td>
<p>OTP connection object produced by otp_connect()</p>
</td></tr>
<tr><td><code id="otp_plan_+3A_fromplace">fromPlace</code></td>
<td>
<p>Numeric vector, Longitude/Latitude pair, e.g.
'c(-0.134649,51.529258)', or 2 column matrix of Longitude/Latitude pairs,
or sf data frame of POINTS with CRS 4326</p>
</td></tr>
<tr><td><code id="otp_plan_+3A_toplace">toPlace</code></td>
<td>
<p>Numeric vector, Longitude/Latitude pair, e.g.
'c(-0.088780,51.506383)', or 2 column matrix of Longitude/Latitude pairs,
or sf data frame of POINTS with CRS 4326</p>
</td></tr>
<tr><td><code id="otp_plan_+3A_fromid">fromID</code></td>
<td>
<p>character vector same length as fromPlace</p>
</td></tr>
<tr><td><code id="otp_plan_+3A_toid">toID</code></td>
<td>
<p>character vector same length as toPlace</p>
</td></tr>
<tr><td><code id="otp_plan_+3A_mode">mode</code></td>
<td>
<p>character vector of one or more modes of travel valid values
&quot;TRANSIT&quot;,&quot;BUS&quot;, &quot;RAIL&quot;, &quot;SUBWAY&quot;,&quot;TRAM&quot;, &quot;FERRY&quot;, &quot;GONDOLA&quot;, &quot;FUNICULAR&quot;,
&quot;AIRPLANE&quot;, &quot;CABLE_CAR&quot;, &quot;WALK&quot;, &quot;BICYCLE&quot;, &quot;BICYCLE_RENT&quot;, &quot;BICYCLE_PARK&quot;,
&quot;CAR&quot;, &quot;CAR_PARK&quot;, &quot;CAR_HAIL&quot;, &quot;CARPOOL&quot;, &quot;CAR_DROPOFF&quot;, &quot;CAR_PICKUP&quot;,
default &quot;CAR&quot;. Not all combinations are valid e.g. c(&quot;WALK&quot;,&quot;BUS&quot;) is valid but
c(&quot;WALK&quot;,&quot;CAR&quot;) is not.</p>
</td></tr>
<tr><td><code id="otp_plan_+3A_date_time">date_time</code></td>
<td>
<p>POSIXct, a date and time, defaults to current date and time</p>
</td></tr>
<tr><td><code id="otp_plan_+3A_arriveby">arriveBy</code></td>
<td>
<p>Logical, Whether the trip should depart or arrive at the
specified date and time, default FALSE</p>
</td></tr>
<tr><td><code id="otp_plan_+3A_maxwalkdistance">maxWalkDistance</code></td>
<td>
<p>Numeric passed to OTP in meters</p>
</td></tr>
<tr><td><code id="otp_plan_+3A_numitineraries">numItineraries</code></td>
<td>
<p>The maximum number of possible itineraries to return</p>
</td></tr>
<tr><td><code id="otp_plan_+3A_routeoptions">routeOptions</code></td>
<td>
<p>Named list of values passed to OTP use
'otp_route_options()' to make template object.</p>
</td></tr>
<tr><td><code id="otp_plan_+3A_full_elevation">full_elevation</code></td>
<td>
<p>Logical, should the full elevation profile be returned,
default FALSE</p>
</td></tr>
<tr><td><code id="otp_plan_+3A_get_geometry">get_geometry</code></td>
<td>
<p>Logical, should the route geometry be returned, default
TRUE, see details</p>
</td></tr>
<tr><td><code id="otp_plan_+3A_ncores">ncores</code></td>
<td>
<p>Numeric, number of cores to use when batch processing, default
1, see details</p>
</td></tr>
<tr><td><code id="otp_plan_+3A_timezone">timezone</code></td>
<td>
<p>Character, what timezone to use, see as.POSIXct, default is
local timezone</p>
</td></tr>
<tr><td><code id="otp_plan_+3A_distance_balance">distance_balance</code></td>
<td>
<p>Logical, use distance balancing, default false, see
details</p>
</td></tr>
<tr><td><code id="otp_plan_+3A_get_elevation">get_elevation</code></td>
<td>
<p>Logical, default FALSE, if true XYZ coordinates returned
else XY coordinates returned.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function returns a SF data.frame with one row for each leg of
the journey (a leg is defined by a change in mode). For transit, more than
one route option may be returned and is indicated by the 'route_option'
column. The number of different itineraries can be set with the
'numItineraries' variable.
</p>
<p>## Batch Routing
</p>
<p>When passing a matrix or SF data frame object to fromPlace and toPlace
'otp_plan' will route in batch mode. In this case the 'ncores' variable
will be used. Increasing 'ncores' will enable multicore routing, the max
'ncores' should be 1.25 times the number of cores on your system. The
default is 1.25 timees -1 for improved stability.
</p>
<p>## Distance Balancing
</p>
<p>When using multicore routing each task does not take the same amount of
time. This can result in wasted time between batches. Distance Balancing
sorts the routing by the euclidean distance between fromPlace and toPlace
before routing. This offers a small performance improvement of around five
percent. As the original order of the inputs is lost fromID and toID must
be provided.
</p>
<p>## Elevation
</p>
<p>OTP supports elevation data and can return the elevation profile of the
route if available. OTP returns the elevation profile separately from the
XY coordinates, this means there is not direct match between the number of
XY points and the number of Z points.  OTP also only returns the elevation
profile for the first leg of the route (this appears to be a bug). If
'get_elevation' is TRUE the otp_plan function matches the elevation profile
to the XY coordinates to return an SF linestring with XYZ coordinates. If
you require a more detailed elevation profile, the full_elevation parameter
will return a nested data.frame with three columns. first and second are
returned from OTP, while distance is the cumulative distance along the
route and is derived from First.
</p>
<p>## Route Geometry
</p>
<p>The 'get_geometry' provides the option to not return the route geometry,
and just return the meta-data (e.g. journey time). This may be useful when
creating an Origin:Destination matrix and also provides a small performance
boost by reduced processing of geometries.
</p>


<h3>Value</h3>

<p>Returns an SF data frame of LINESTRINGs
</p>


<h3>See Also</h3>

<p>Other routing: 
<code><a href="#topic+otp_geocode">otp_geocode</a>()</code>,
<code><a href="#topic+otp_isochrone">otp_isochrone</a>()</code>,
<code><a href="#topic+otp_pointset">otp_pointset</a>()</code>,
<code><a href="#topic+otp_routing_options">otp_routing_options</a>()</code>,
<code><a href="#topic+otp_validate_routing_options">otp_validate_routing_options</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
otpcon &lt;- otp_connect()
otp_plan(otpcon, c(0.1, 55.3), c(0.6, 52.1))
otp_plan(otpcon, c(0.1, 55.3), c(0.6, 52.1),
  mode = c("WALK", "TRANSIT")
)
otp_plan(otpcon, c(0.1, 55.3), c(0.6, 52.1),
  mode = "BICYCLE", arriveBy = TRUE,
  date_time = as.POSIXct(strptime("2018-06-03 13:30", "%Y-%m-%d %H:%M"))
)

## End(Not run)

</code></pre>

<hr>
<h2 id='otp_pointset'>Create a pointset</h2><span id='topic+otp_pointset'></span>

<h3>Description</h3>

<p>Pointsets are text files tha can be used by the Analyist feature in OTP 1.5
</p>


<h3>Usage</h3>

<pre><code class='language-R'>otp_pointset(points = NULL, name = NULL, dir = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="otp_pointset_+3A_points">points</code></td>
<td>
<p>sf data frame of POINTS with CRS 4326</p>
</td></tr>
<tr><td><code id="otp_pointset_+3A_name">name</code></td>
<td>
<p>Character, name for pointset</p>
</td></tr>
<tr><td><code id="otp_pointset_+3A_dir">dir</code></td>
<td>
<p>A character string, path to a directory containing the necessary
files, see details</p>
</td></tr>
</table>


<h3>Details</h3>

<p>OTP will return a maximum of 10 results
</p>


<h3>Value</h3>

<p>Returns a data.frame of SF POINTS or Coordinates of all
the locations that match 'query'
</p>


<h3>See Also</h3>

<p>Other routing: 
<code><a href="#topic+otp_geocode">otp_geocode</a>()</code>,
<code><a href="#topic+otp_isochrone">otp_isochrone</a>()</code>,
<code><a href="#topic+otp_plan">otp_plan</a>()</code>,
<code><a href="#topic+otp_routing_options">otp_routing_options</a>()</code>,
<code><a href="#topic+otp_validate_routing_options">otp_validate_routing_options</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
locations &lt;- otp_geocode(otpcon, "High Street")

## End(Not run)
</code></pre>

<hr>
<h2 id='otp_routing_options'>Make routingOptions object</h2><span id='topic+otp_routing_options'></span>

<h3>Description</h3>

<p>OTP supports a wide selection of routing options 'otp_plan()' accepts a
named list of these options. This function produces an empty named list
of valid options supported by both this package and OTP.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>otp_routing_options()
</code></pre>


<h3>Details</h3>

<p>Supports almost all of the possible options in OTP 1.4. Note that some
of the most popular option (mode, date, time, etc.) are set directly
in 'otp_plan()'. If you want to permenaty set an option many are supported
in the config files, see help on 'otp_make_config()'.
</p>
<p>http://dev.opentripplanner.org/apidoc/1.4.0/resource_PlannerResource.html
</p>


<h3>See Also</h3>

<p>Other routing: 
<code><a href="#topic+otp_geocode">otp_geocode</a>()</code>,
<code><a href="#topic+otp_isochrone">otp_isochrone</a>()</code>,
<code><a href="#topic+otp_plan">otp_plan</a>()</code>,
<code><a href="#topic+otp_pointset">otp_pointset</a>()</code>,
<code><a href="#topic+otp_validate_routing_options">otp_validate_routing_options</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
routingOptions &lt;- otp_routing_options()
routingOptions$walkSpeed &lt;- 1.5
routingOptions &lt;- otp_validate_routing_options(routingOptions)

## End(Not run)
</code></pre>

<hr>
<h2 id='otp_setup'>Set up an OTP instance.</h2><span id='topic+otp_setup'></span>

<h3>Description</h3>

<p>OTP is run in Java and requires Java commands to be typed into the
command line. The function allows the parameters to be defined in
R and automatically passed to Java. This function sets up a local
instance of OTP, for remote versions see documentation.
</p>
<p>The function assumes you have run otp_build_graph()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>otp_setup(
  otp = NULL,
  dir = NULL,
  memory = 2048,
  router = "default",
  port = 8080,
  securePort = 8081,
  analyst = FALSE,
  pointsets = FALSE,
  wait = TRUE,
  flag64bit = TRUE,
  quiet = TRUE,
  otp_version = NULL,
  open_browser = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="otp_setup_+3A_otp">otp</code></td>
<td>
<p>A character string, path to the OTP .jar file</p>
</td></tr>
<tr><td><code id="otp_setup_+3A_dir">dir</code></td>
<td>
<p>A character string, path to a directory containing the
necessary files, see details</p>
</td></tr>
<tr><td><code id="otp_setup_+3A_memory">memory</code></td>
<td>
<p>A positive integer. Amount of memory to assign to
the OTP in MB, default is 2048</p>
</td></tr>
<tr><td><code id="otp_setup_+3A_router">router</code></td>
<td>
<p>A character for the name of the router to use, must
be subfolder of dir/graphs, default &quot;default&quot;. See
vignettes for details.</p>
</td></tr>
<tr><td><code id="otp_setup_+3A_port">port</code></td>
<td>
<p>A positive integer. Optional, default is 8080.</p>
</td></tr>
<tr><td><code id="otp_setup_+3A_secureport">securePort</code></td>
<td>
<p>A positive integer. Optional, default is 8081.</p>
</td></tr>
<tr><td><code id="otp_setup_+3A_analyst">analyst</code></td>
<td>
<p>Logical. Should the analyst features be loaded?
Default FALSE</p>
</td></tr>
<tr><td><code id="otp_setup_+3A_pointsets">pointsets</code></td>
<td>
<p>Logical. Should the pointsets be loaded?
Default FALSE</p>
</td></tr>
<tr><td><code id="otp_setup_+3A_wait">wait</code></td>
<td>
<p>Logical, Should R wait until OTP has loaded before
running next line of code, default TRUE</p>
</td></tr>
<tr><td><code id="otp_setup_+3A_flag64bit">flag64bit</code></td>
<td>
<p>Logical, if true the -d64 flag is added to Java instructions,
ignored if otp_version &gt;= 2</p>
</td></tr>
<tr><td><code id="otp_setup_+3A_quiet">quiet</code></td>
<td>
<p>Logical, if FALSE the Java commands will be printed to console</p>
</td></tr>
<tr><td><code id="otp_setup_+3A_otp_version">otp_version</code></td>
<td>
<p>Numeric, version of OTP to build, default NULL when version
is auto-detected</p>
</td></tr>
<tr><td><code id="otp_setup_+3A_open_browser">open_browser</code></td>
<td>
<p>Logical, if TRUE web browser is loaded when OTP is ready</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To run an OTP graph must have been created using otp_build_graph
and the following files to be in the directory specified by the
dir variable.
</p>
<p>/graphs - A sub-directory
</p>
<p>/default - A sub-directory with the name of the OTP router used in 'router' variable
</p>
<p>graph.obj  OTP graph
</p>


<h3>Value</h3>

<p>This function does not return a value to R. If wait is TRUE R
will wait until OTP is running (maximum of 5 minutes).
After 5 minutes (or if wait is FALSE) the function will return
R to your control, but the OTP will keep loading.
</p>


<h3>See Also</h3>

<p>Other setup: 
<code><a href="#topic+otp_build_graph">otp_build_graph</a>()</code>,
<code><a href="#topic+otp_check_java">otp_check_java</a>()</code>,
<code><a href="#topic+otp_check_version">otp_check_version</a>()</code>,
<code><a href="#topic+otp_dl_demo">otp_dl_demo</a>()</code>,
<code><a href="#topic+otp_dl_jar">otp_dl_jar</a>()</code>,
<code><a href="#topic+otp_make_config">otp_make_config</a>()</code>,
<code><a href="#topic+otp_stop">otp_stop</a>()</code>,
<code><a href="#topic+otp_validate_config">otp_validate_config</a>()</code>,
<code><a href="#topic+otp_write_config">otp_write_config</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
otp_setup(
  otp = "C:/otp/otp.jar",
  dir = "C:/data"
)
otp_setup(
  otp = "C:/otp/otp.jar",
  dir = "C:/data",
  memory = 5000,
  analyst = TRUE
)

## End(Not run)
</code></pre>

<hr>
<h2 id='otp_stop'>Stop and OTP Instance</h2><span id='topic+otp_stop'></span>

<h3>Description</h3>

<p>OTP is run in Java and requires Java commands to be typed
into the command line. The function allows the parameters
to be defined in R and automatically passed to Java.
This function stops an already running OTP instance
</p>


<h3>Usage</h3>

<pre><code class='language-R'>otp_stop(warn = TRUE, kill_all = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="otp_stop_+3A_warn">warn</code></td>
<td>
<p>Logical, should you get a warning message</p>
</td></tr>
<tr><td><code id="otp_stop_+3A_kill_all">kill_all</code></td>
<td>
<p>Logical, should all Java instances be killed?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function assumes you have run otp_setup()
</p>


<h3>Value</h3>

<p>This function return a message but no object
</p>


<h3>See Also</h3>

<p>Other setup: 
<code><a href="#topic+otp_build_graph">otp_build_graph</a>()</code>,
<code><a href="#topic+otp_check_java">otp_check_java</a>()</code>,
<code><a href="#topic+otp_check_version">otp_check_version</a>()</code>,
<code><a href="#topic+otp_dl_demo">otp_dl_demo</a>()</code>,
<code><a href="#topic+otp_dl_jar">otp_dl_jar</a>()</code>,
<code><a href="#topic+otp_make_config">otp_make_config</a>()</code>,
<code><a href="#topic+otp_setup">otp_setup</a>()</code>,
<code><a href="#topic+otp_validate_config">otp_validate_config</a>()</code>,
<code><a href="#topic+otp_write_config">otp_write_config</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
otp_stop(kill_all = FALSE)

## End(Not run)
</code></pre>

<hr>
<h2 id='otp_surface'>Evaluate a surface against a pointset</h2><span id='topic+otp_surface'></span>

<h3>Description</h3>

<p>Evaluate a surface created with 'otp_make_surface' against a pointset made
with 'otp_pointset' to get travel times and statitics from the analysit in
OTP 1.x
</p>


<h3>Usage</h3>

<pre><code class='language-R'>otp_surface(
  otpcon = NULL,
  surface = NULL,
  pointsset = NULL,
  get_data = TRUE,
  ncores = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="otp_surface_+3A_otpcon">otpcon</code></td>
<td>
<p>OTP connection object produced by otp_connect()</p>
</td></tr>
<tr><td><code id="otp_surface_+3A_surface">surface</code></td>
<td>
<p>A surface list from otp_make_surface()</p>
</td></tr>
<tr><td><code id="otp_surface_+3A_pointsset">pointsset</code></td>
<td>
<p>character, name of pointset</p>
</td></tr>
<tr><td><code id="otp_surface_+3A_get_data">get_data</code></td>
<td>
<p>Logical, should data be returned or just travel times.</p>
</td></tr>
<tr><td><code id="otp_surface_+3A_ncores">ncores</code></td>
<td>
<p>Integer, number of cores to use</p>
</td></tr>
</table>


<h3>Details</h3>

<p>THis function requires the analysis and pointset features to be
enabled during 'otp_setup()'. Thus it will only work with OTP 1.x. For more
detail see the analyst vignette.
</p>


<h3>Value</h3>

<p>Returns a list of data.frames of travel times
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
times &lt;- otp_surface(otpcon, c(-1.17502, 50.64590), "lsoa", path_data)

## End(Not run)
</code></pre>

<hr>
<h2 id='otp_surface_isochrone'>Make an isochrone from a surface</h2><span id='topic+otp_surface_isochrone'></span>

<h3>Description</h3>

<p>Make a raster image (picture) of travel time using the surface features in
OTP 1.x
</p>


<h3>Usage</h3>

<pre><code class='language-R'>otp_surface_isochrone(otpcon = NULL, surface = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="otp_surface_isochrone_+3A_otpcon">otpcon</code></td>
<td>
<p>OTP connection object produced by otp_connect()</p>
</td></tr>
<tr><td><code id="otp_surface_isochrone_+3A_surface">surface</code></td>
<td>
<p>A surface list from otp_make_surface()</p>
</td></tr>
</table>


<h3>Details</h3>

<p>THis function requires the analysis and pointset features to be
enabled during 'otp_setup()'. Thus it will only work with OTP 1.x. For more
detail see the analyst vignette.
</p>


<h3>Value</h3>

<p>Returns a data.frame of travel times
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
times &lt;- otp_surface(otpcon, c(-1.17502, 50.64590), "lsoa", path_data)

## End(Not run)
</code></pre>

<hr>
<h2 id='otp_traveltime'>Get travel times between points</h2><span id='topic+otp_traveltime'></span>

<h3>Description</h3>

<p>This function requires OTP 1.x and the analyst
</p>


<h3>Usage</h3>

<pre><code class='language-R'>otp_traveltime(
  otpcon = NA,
  path_data = NULL,
  fromPlace = NA,
  toPlace = NA,
  fromID = NULL,
  toID = NULL,
  mode = "CAR",
  date_time = Sys.time(),
  arriveBy = FALSE,
  maxWalkDistance = 1000,
  numItineraries = 3,
  routeOptions = NULL,
  ncores = max(round(parallel::detectCores() * 1.25) - 1, 1),
  timezone = otpcon$timezone
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="otp_traveltime_+3A_otpcon">otpcon</code></td>
<td>
<p>OTP connection object produced by otp_connect()</p>
</td></tr>
<tr><td><code id="otp_traveltime_+3A_path_data">path_data</code></td>
<td>
<p>Path to data used in otp_build_graph()</p>
</td></tr>
<tr><td><code id="otp_traveltime_+3A_fromplace">fromPlace</code></td>
<td>
<p>Numeric vector, Longitude/Latitude pair, e.g.
'c(-0.134649,51.529258)', or 2 column matrix of Longitude/Latitude pairs,
or sf data frame of POINTS with CRS 4326</p>
</td></tr>
<tr><td><code id="otp_traveltime_+3A_toplace">toPlace</code></td>
<td>
<p>Numeric vector, Longitude/Latitude pair, e.g.
'c(-0.088780,51.506383)', or 2 column matrix of Longitude/Latitude pairs,
or sf data frame of POINTS with CRS 4326</p>
</td></tr>
<tr><td><code id="otp_traveltime_+3A_fromid">fromID</code></td>
<td>
<p>character vector same length as fromPlace</p>
</td></tr>
<tr><td><code id="otp_traveltime_+3A_toid">toID</code></td>
<td>
<p>character vector same length as toPlace</p>
</td></tr>
<tr><td><code id="otp_traveltime_+3A_mode">mode</code></td>
<td>
<p>character vector of one or more modes of travel valid values
TRANSIT, WALK, BICYCLE, CAR, BUS, RAIL, default CAR. Not all combinations
are valid e.g. c(&quot;WALK&quot;,&quot;BUS&quot;) is valid but c(&quot;WALK&quot;,&quot;CAR&quot;) is not.</p>
</td></tr>
<tr><td><code id="otp_traveltime_+3A_date_time">date_time</code></td>
<td>
<p>POSIXct, a date and time, defaults to current date and time</p>
</td></tr>
<tr><td><code id="otp_traveltime_+3A_arriveby">arriveBy</code></td>
<td>
<p>Logical, Whether the trip should depart or arrive at the
specified date and time, default FALSE</p>
</td></tr>
<tr><td><code id="otp_traveltime_+3A_maxwalkdistance">maxWalkDistance</code></td>
<td>
<p>Numeric passed to OTP in metres</p>
</td></tr>
<tr><td><code id="otp_traveltime_+3A_numitineraries">numItineraries</code></td>
<td>
<p>The maximum number of possible itineraries to return</p>
</td></tr>
<tr><td><code id="otp_traveltime_+3A_routeoptions">routeOptions</code></td>
<td>
<p>Named list of values passed to OTP use
'otp_route_options()' to make template object.</p>
</td></tr>
<tr><td><code id="otp_traveltime_+3A_ncores">ncores</code></td>
<td>
<p>Numeric, number of cores to use when batch processing, default
1, see details</p>
</td></tr>
<tr><td><code id="otp_traveltime_+3A_timezone">timezone</code></td>
<td>
<p>Character, what timezone to use, see as.POSIXct, default is
local timezone</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Make a travel time matrix using the analyst features in OPT 1.x
</p>


<h3>Value</h3>

<p>Returns an  data frame
</p>


<h3>See Also</h3>

<p>Other analyst: 
<code><a href="#topic+otp_make_surface">otp_make_surface</a>()</code>
</p>

<hr>
<h2 id='otp_validate_config'>Validate Config Object</h2><span id='topic+otp_validate_config'></span>

<h3>Description</h3>

<p>Checks if the list of OTP configuration options is valid
</p>


<h3>Usage</h3>

<pre><code class='language-R'>otp_validate_config(config, type = attributes(config)$config_type, version = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="otp_validate_config_+3A_config">config</code></td>
<td>
<p>A named list made/modified from 'otp_make_config()'</p>
</td></tr>
<tr><td><code id="otp_validate_config_+3A_type">type</code></td>
<td>
<p>type of config file</p>
</td></tr>
<tr><td><code id="otp_validate_config_+3A_version">version</code></td>
<td>
<p>version of OPT e.g. 1 or 2</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Performs basic validity checks on class, max/min values etc as appropriate,
some of more complex parameters are not checked. For more details see:
</p>
<p>http://docs.opentripplanner.org/en/latest/Configuration
http://dev.opentripplanner.org/javadoc/1.3.0/org/opentripplanner/routing/core/RoutingRequest.html
</p>


<h3>See Also</h3>

<p>Other setup: 
<code><a href="#topic+otp_build_graph">otp_build_graph</a>()</code>,
<code><a href="#topic+otp_check_java">otp_check_java</a>()</code>,
<code><a href="#topic+otp_check_version">otp_check_version</a>()</code>,
<code><a href="#topic+otp_dl_demo">otp_dl_demo</a>()</code>,
<code><a href="#topic+otp_dl_jar">otp_dl_jar</a>()</code>,
<code><a href="#topic+otp_make_config">otp_make_config</a>()</code>,
<code><a href="#topic+otp_setup">otp_setup</a>()</code>,
<code><a href="#topic+otp_stop">otp_stop</a>()</code>,
<code><a href="#topic+otp_write_config">otp_write_config</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
conf &lt;- otp_make_config("build")
otp_validate_config(conf)

## End(Not run)
</code></pre>

<hr>
<h2 id='otp_validate_routing_options'>Validate routingOptions object</h2><span id='topic+otp_validate_routing_options'></span>

<h3>Description</h3>

<p>OTP supports a wide selection of routing options 'otp_plan()' accepts a
named list of these options. This function validates a named list of inputs
and removes any empty inputs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>otp_validate_routing_options(opts)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="otp_validate_routing_options_+3A_opts">opts</code></td>
<td>
<p>a named list of options possibly from 'otp_routing_options()'</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Supports almost all of the possible options in OTP 1.4. Note that some
of the most popular option (mode, date, time, etc.) are set directly
in 'otp_plan()'. If you want to permenaty set an option many are supported
in the config files, see help on 'otp_make_config()'.
http://dev.opentripplanner.org/apidoc/1.4.0/resource_PlannerResource.html
</p>


<h3>See Also</h3>

<p>Other routing: 
<code><a href="#topic+otp_geocode">otp_geocode</a>()</code>,
<code><a href="#topic+otp_isochrone">otp_isochrone</a>()</code>,
<code><a href="#topic+otp_plan">otp_plan</a>()</code>,
<code><a href="#topic+otp_pointset">otp_pointset</a>()</code>,
<code><a href="#topic+otp_routing_options">otp_routing_options</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
routingOptions &lt;- otp_routing_options()
routingOptions$walkSpeed &lt;- 1.5
routingOptions &lt;- otp_validate_routing_options(routingOptions)

## End(Not run)
</code></pre>

<hr>
<h2 id='otp_write_config'>Write config object as json file</h2><span id='topic+otp_write_config'></span>

<h3>Description</h3>

<p>Takes a config list produced by 'otp_make_config()' and saves it
as json file for OTP
</p>


<h3>Usage</h3>

<pre><code class='language-R'>otp_write_config(config, dir = NULL, router = "default")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="otp_write_config_+3A_config">config</code></td>
<td>
<p>A named list made/modified from 'otp_make_config()'</p>
</td></tr>
<tr><td><code id="otp_write_config_+3A_dir">dir</code></td>
<td>
<p>Path to folder where data for OTP is to be stored</p>
</td></tr>
<tr><td><code id="otp_write_config_+3A_router">router</code></td>
<td>
<p>name of the router, default is &quot;default&quot;, must be a subfolder
of dir/graphs</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other setup: 
<code><a href="#topic+otp_build_graph">otp_build_graph</a>()</code>,
<code><a href="#topic+otp_check_java">otp_check_java</a>()</code>,
<code><a href="#topic+otp_check_version">otp_check_version</a>()</code>,
<code><a href="#topic+otp_dl_demo">otp_dl_demo</a>()</code>,
<code><a href="#topic+otp_dl_jar">otp_dl_jar</a>()</code>,
<code><a href="#topic+otp_make_config">otp_make_config</a>()</code>,
<code><a href="#topic+otp_setup">otp_setup</a>()</code>,
<code><a href="#topic+otp_stop">otp_stop</a>()</code>,
<code><a href="#topic+otp_validate_config">otp_validate_config</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
conf &lt;- otp_make_config("build")
otp_write_config(conf, dir = tempdir())

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
