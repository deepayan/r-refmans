<!DOCTYPE html><html lang="en"><head><title>Help for package MNB</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MNB}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#alzheimer'><p>Alzheimer data</p></a></li>
<li><a href='#envelope.MNB'><p>Simulation envelope</p></a></li>
<li><a href='#fit.MNB'><p>Maximum likelihood estimation</p></a></li>
<li><a href='#global.MNB'><p>Global influence</p></a></li>
<li><a href='#local.MNB'><p>Local influence</p></a></li>
<li><a href='#MNB'><p>Diagnostic tools for a multivariate negative binomial model</p></a></li>
<li><a href='#qMNB'><p>Randomized quantile residual</p></a></li>
<li><a href='#re.MNB'><p>Residual analysis</p></a></li>
<li><a href='#rMNB'><p>Generating Multivariate Negative Binomial Data</p></a></li>
<li><a href='#seizures'><p>Seizures data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Diagnostic Tools for a Multivariate Negative Binomial Regression
Model</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2025-03-05</td>
</tr>
<tr>
<td>Author:</td>
<td>Jalmar Carrasco [aut, cre],
  Cristian Lobos [aut],
  Lizandra Fabio [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jalmar Carrasco &lt;carrascojalmar@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Diagnostic tools as residual analysis, global, 
    local and total-local influence for the multivariate model 
    from the random intercept Poisson generalized log gamma model 
    are available in this package. Including also, the estimation 
    process by maximum likelihood method, for details see 
    Fabio, L. C; Villegas, C. L.; Carrasco, J.M.F and de Castro, M. (2023) 
    &lt;<a href="https://doi.org/10.1080%2F03610926.2021.1939380">doi:10.1080/03610926.2021.1939380</a>&gt; and Fábio, L. C.; Villegas, C.; 
    Mamun, A. S. M. A. and Carrasco, J. M. F. (2025) &lt;<a href="https://doi.org/10.28951%2Fbjb.v43i1.728">doi:10.28951/bjb.v43i1.728</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>Imports:</td>
<td>flexsurv, numDeriv, graphics, methods,</td>
</tr>
<tr>
<td>Suggests:</td>
<td>stats,</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-03-05 07:44:36 UTC; jalmarcarrasco</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-03-06 00:00:16 UTC</td>
</tr>
</table>
<hr>
<h2 id='alzheimer'>Alzheimer data</h2><span id='topic+alzheimer'></span>

<h3>Description</h3>

<p>The Alzheimer’s data is presented in Hand and Taylor (1987) and Hand and
Crowder (1996) to assess deterioration aspects of intellect, self-care and
personality in senile patients with Alzheimer’s disease. Two groups of patients
were compared, one of which received a placebo and the other treatment with
lecithin. In the data, each of the subjects, 26 in the placebo group and 22
in the lecithin group, were measured on five occasions (initially, 1st, 2nd, 4th and 6th).
The measurements were the number of words that the patients could recalled from lists of words.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(alzheimer)
</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<ul>
<li><p> Y: The number of words that the patients could recalled from lists of words.
</p>
</li>
<li><p> trt: Placebo ano lecithin groups.
</p>
</li>
<li><p> ind: Indicator on the ith patient.
</p>
</li>
<li><p> time:  initially, 1st, 2nd, 4th and 6th visit.
</p>
</li></ul>



<h3>References</h3>


<ul>
<li><p> Hand, D. J. and Crowder, M. (1996). Practical Longitudinal Data Analysis. London: Chapman and Hall.
</p>
</li>
<li><p> Hand, D. J. and Taylor, C. C. (1987). Analysis of Variance and Repeated Measures. London: Chapman and Hall.
</p>
</li>
<li><p> Fabio, L. C., Villegas, C., Carrasco, J. M. F., and de Castro, M. (2023). Diagnostic tools for a multivariate negative binomial model for fitting correlated data with overdispersion. Communications in Statistics - Theory and Methods, 52, 1833–1853.
</p>
</li>
<li><p> Fabio, L. C., Villegas, C., Mamun, A. S., and Carrasco, J. M. F. (2025). Residual analysis for discrete correlated data in the multivariate approach. Brazilian Journal of Biometrics, 43, e43728.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
data(alzheimer)
head(alzheimer)

</code></pre>

<hr>
<h2 id='envelope.MNB'>Simulation envelope</h2><span id='topic+envelope.MNB'></span>

<h3>Description</h3>

<p>Simulated envelopes in normal probability plots
</p>


<h3>Usage</h3>

<pre><code class='language-R'>envelope.MNB(star, formula, dataSet, n.r, nsim, plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="envelope.MNB_+3A_star">star</code></td>
<td>
<p>Initial values for the parameters to be optimized over.</p>
</td></tr>
<tr><td><code id="envelope.MNB_+3A_formula">formula</code></td>
<td>
<p>The structure matrix of covariates of dimension n x p (in models that include an intercept x
should contain a column of ones).</p>
</td></tr>
<tr><td><code id="envelope.MNB_+3A_dataset">dataSet</code></td>
<td>
<p>data</p>
</td></tr>
<tr><td><code id="envelope.MNB_+3A_n.r">n.r</code></td>
<td>
<p>Indicator which residual type graphics. 1 - weighted, 2 - Standardized weighted, 3 - Pearson, 4 - Standardized Pearson, 5 - standardized deviance component residuals and 6 - randomized quantile residuals.</p>
</td></tr>
<tr><td><code id="envelope.MNB_+3A_nsim">nsim</code></td>
<td>
<p>Number of Monte Carlo replicates.</p>
</td></tr>
<tr><td><code id="envelope.MNB_+3A_plot">plot</code></td>
<td>
<p>TRUE or FALSE. Indicates if a graph should be plotted.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Atkinson (1985), suggests the use of simulated envelopes in normal probability
plots to facilitate the goodness of fit.
</p>


<h3>Value</h3>

<p>L, residuals and simulation envelopes in normal probability plots
</p>


<h3>Author(s)</h3>

<p>Jalmar M F Carrasco &lt;carrascojalmar@gmail.com&gt;,
Cristian M Villegas Lobos &lt;master.villegas@gmail.com&gt; and Lizandra C Fabio &lt;lizandrafabio@gmail.com&gt;
</p>


<h3>References</h3>


<ul>
<li><p> Atkinson A.C. (1985). Plots, Transformations and Regression: An Introduction to Graphical Methods of Diagnostic
Regression Analysis. Oxford University Press, New York.
</p>
</li>
<li><p> Fabio, L. C., Villegas, C., Carrasco, J. M. F., and de Castro, M. (2023).
Diagnostic tools for a multivariate negative binomial
model for fitting correlated data with overdispersion. Communications in
Statistics - Theory and Methods, 52, 1833–1853.
</p>
</li>
<li><p> Fabio, L. C., Villegas, C., Mamun, A. S., and Carrasco, J. M. F. (2025).
Residual analysis for discrete correlated data in the multivariate approach.
Brazilian Journal of Biometrics, 43, e43728.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>


data(seizures)
head(seizures)

star &lt;-list(phi=1, beta0=1, beta1=1, beta2=1, beta3=1)

envelope.MNB(formula=Y ~ trt + period + trt:period +
offset(weeks),star=star,nsim=21,n.r=6,
dataSet=seizures,plot=FALSE)

data(alzheimer)
head(alzheimer)

star &lt;- list(phi=10,beta1=2, beta2=0.2)
envelope.MNB(formula=Y ~ trat, star=star, nsim=21, n.r=6,
dataSet = alzheimer,plot=FALSE)


</code></pre>

<hr>
<h2 id='fit.MNB'>Maximum likelihood estimation</h2><span id='topic+fit.MNB'></span>

<h3>Description</h3>

<p>Estimate parameters by quasi-Newton algorithms.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit.MNB(star, formula, dataSet, tab = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fit.MNB_+3A_star">star</code></td>
<td>
<p>Initial values for the parameters to be optimized over.</p>
</td></tr>
<tr><td><code id="fit.MNB_+3A_formula">formula</code></td>
<td>
<p>The structure matrix of covariates of dimension n x p (in models that include an intercept x
should contain a column of ones).</p>
</td></tr>
<tr><td><code id="fit.MNB_+3A_dataset">dataSet</code></td>
<td>
<p>data</p>
</td></tr>
<tr><td><code id="fit.MNB_+3A_tab">tab</code></td>
<td>
<p>Logical. Print a summary of the coefficients,
standard errors and p-value for class &quot;MNB&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Method &quot;BFGS&quot; is a quasi-Newton method, specifically that published
simultaneously in 1970 by Broyden, Fletcher, Goldfarb and Shanno. This uses function
values and gradients to build up a picture of the surface to be optimized.
</p>


<h3>Value</h3>

<p>Returns a list of summary statistics
of the fitted multivariate negative binomial model.
</p>


<h3>Author(s)</h3>

<p>Jalmar M F Carrasco &lt;carrascojalmar@gmail.com&gt;,
Cristian M Villegas Lobos &lt;master.villegas@gmail.com&gt; and Lizandra C Fabio &lt;lizandrafabio@gmail.com&gt;
</p>


<h3>References</h3>


<ul>
<li><p> Fabio, L., Paula, G. A., and de Castro, M. (2012). A Poisson mixed model
with nonormal random effect distribution. Computational Statistics and
Data Analysis, 56, 1499-1510.
</p>
</li>
<li><p> Fabio, L. C., Villegas, C., Carrasco, J. M. F., and de Castro, M. (2023).
Diagnostic tools for a multivariate negative binomial
model for fitting correlated data with overdispersion. Communications in
Statistics - Theory and Methods, 52, 1833–1853.
</p>
</li>
<li><p> Fabio, L. C., Villegas, C., Mamun, A. S., and Carrasco, J. M. F. (2025).
Residual analysis for discrete correlated data in the multivariate approach.
Brazilian Journal of Biometrics, 43, e43728.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>


data(seizures)
head(seizures)

star &lt;-list(phi=1, beta0=1, beta1=1, beta2=1, beta3=1)

mod1 &lt;- fit.MNB(formula=Y ~ trt + period +
trt:period + offset(log(weeks)), star=star, dataSet=seizures)

mod1

seizures49 &lt;- seizures[-c(241,242,243,244,245),]

mod2 &lt;- fit.MNB(formula=Y ~ trt + period +
trt:period + offset(log(weeks)), star=star, dataSet=seizures49)

mod2



</code></pre>

<hr>
<h2 id='global.MNB'>Global influence</h2><span id='topic+global.MNB'></span>

<h3>Description</h3>

<p>It performers influence analysis by a global influence to evaluate the impact on the parameter
estimates when we remove a particular observation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>global.MNB(formula, star, dataSet, plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="global.MNB_+3A_formula">formula</code></td>
<td>
<p>The structure matrix of covariates of dimension n x p (in models that include an intercept x
should contain a column of ones).</p>
</td></tr>
<tr><td><code id="global.MNB_+3A_star">star</code></td>
<td>
<p>Initial values for the parameters to be optimized over.</p>
</td></tr>
<tr><td><code id="global.MNB_+3A_dataset">dataSet</code></td>
<td>
<p>data</p>
</td></tr>
<tr><td><code id="global.MNB_+3A_plot">plot</code></td>
<td>
<p>TRUE or FALSE. Indicates if a graph should be plotted.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function returns a list (L) with the generalized Cook distance, Likelihood displacement and
index plot.
</p>


<h3>Value</h3>

<p>L and graphics
</p>


<h3>Author(s)</h3>

<p>Jalmar M F Carrasco &lt;carrascojalmar@gmail.com&gt;,
Cristian M Villegas Lobos &lt;master.villegas@gmail.com&gt; and Lizandra C Fabio &lt;lizandrafabio@gmail.com&gt;
</p>


<h3>References</h3>


<ul>
<li><p> Fabio, L. C., Villegas, C., Carrasco, J. M. F., and de Castro, M. (2023).
Diagnostic tools for a multivariate negative binomial
model for fitting correlated data with overdispersion. Communications in
Statistics - Theory and Methods, 52, 1833–1853.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>


data(seizures)
head(seizures)

star &lt;-list(phi=1, beta0=1, beta1=1, beta2=1, beta3=1)
global.MNB(formula=Y ~ trt + period +
trt:period + offset(log(weeks)),star=star,dataSet=seizures,plot=FALSE)



</code></pre>

<hr>
<h2 id='local.MNB'>Local influence</h2><span id='topic+local.MNB'></span>

<h3>Description</h3>

<p>It performes influence analysis by a local influence approach by Cook (1986). It is considering
three perturbation schemes: Case weights, explanatory variable and dispersion parameter perturbation. Another
procedure which considering is the total local curvature corresponding to the ith element approach by
Lesaffre and Verbeke (1998).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>local.MNB(star, formula, dataSet, schemes, cova, plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="local.MNB_+3A_star">star</code></td>
<td>
<p>Initial values for the parameters to be optimized over.</p>
</td></tr>
<tr><td><code id="local.MNB_+3A_formula">formula</code></td>
<td>
<p>The structure matrix of covariates of dimension n x p (in models that include an intercept x
should contain a column of ones).</p>
</td></tr>
<tr><td><code id="local.MNB_+3A_dataset">dataSet</code></td>
<td>
<p>data</p>
</td></tr>
<tr><td><code id="local.MNB_+3A_schemes">schemes</code></td>
<td>
<p>Perturbation scheme. Possible values: &quot;cases&quot; for Case weights perturbation on ith subject
or cluster, &quot;cases.obs&quot; for Case weights perturbation on jth measurement
taken on the ith subject or cluster, &quot;cova.pertu&quot; for explanatory variable perturbation, &quot;dispersion&quot; for
dispersion parameter perturbation</p>
</td></tr>
<tr><td><code id="local.MNB_+3A_cova">cova</code></td>
<td>
<p>Indicator which column from dataset (continuous covariate) must be perturbation.</p>
</td></tr>
<tr><td><code id="local.MNB_+3A_plot">plot</code></td>
<td>
<p>TRUE or FALSE. Indicates if a graph should be plotted.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function returns a list (L) with the eigenvector associated with the maximum curvature, the total
local influence and the index plot.
</p>


<h3>Value</h3>

<p>L and graphics
</p>


<h3>Author(s)</h3>

<p>Jalmar M F Carrasco &lt;carrascojalmar@gmail.com&gt;,
Cristian M Villegas Lobos &lt;master.villegas@gmail.com&gt; and Lizandra C Fabio &lt;lizandrafabio@gmail.com&gt;
</p>


<h3>References</h3>


<ul>
<li><p> Cook, R. D. (1986). Assessment of local influence (with discussion). Journal of
the Royal Statistical Society B, 48, 133-169.
</p>
</li>
<li><p> Lesaffre E. and Verbeke G. (1998). Local influence in linear mixed models. Biometrics, 54, 570-582.
</p>
</li>
<li><p> Fabio, L. C., Villegas, C., Carrasco, J. M. F., and de Castro, M. (2023).
Diagnostic tools for a multivariate negative binomial
model for fitting correlated data with overdispersion. Communications in
Statistics - Theory and Methods, 52, 1833–1853.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>


data(seizures)
head(seizures)

star &lt;-list(phi=1, beta0=1, beta1=1, beta2=1, beta3=1)

local.MNB(formula=Y ~ trt + period + trt:period + offset(log(weeks)),star=star,dataSet=seizures,
schemes="weight",plot=FALSE)

local.MNB(formula=Y ~ trt + period + trt:period + offset(log(weeks)),star=star,dataSet=seizures,
schemes="weight.obs",plot=FALSE)

local.MNB(formula=Y ~ trt + period + trt:period + offset(log(weeks)),star=star,dataSet=seizures,
schemes="dispersion",plot=FALSE)


</code></pre>

<hr>
<h2 id='MNB'>Diagnostic tools for a multivariate negative binomial model</h2><span id='topic+MNB'></span><span id='topic+package'></span>

<h3>Description</h3>

<p>Diagnostic tools as residual analysis, global, local and total-local influence
for the multivariate model from the random intercept Poisson-GlG mode. Including
also, the estimation process by maximum likelihood and generating multivariate
negative binomial data.
</p>


<h3>MNB package functions</h3>


<ul>
<li> <p><code><a href="#topic+rMNB">rMNB</a></code>
</p>
</li>
<li> <p><code><a href="#topic+fit.MNB">fit.MNB</a></code>
</p>
</li>
<li> <p><code><a href="#topic+qMNB">qMNB</a></code>
</p>
</li>
<li> <p><code><a href="#topic+re.MNB">re.MNB</a></code>
</p>
</li>
<li> <p><code><a href="#topic+envelope.MNB">envelope.MNB</a></code>
</p>
</li>
<li> <p><code><a href="#topic+global.MNB">global.MNB</a></code>
</p>
</li>
<li> <p><code><a href="#topic+local.MNB">local.MNB</a></code>
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Jalmar M F Carrasco &lt;carrascojalmar@gmail.com&gt;,
Cristian M Villegas Lobos &lt;master.villegas@gmail.com&gt; and Lizandra C Fabio &lt;lizandrafabio@gmail.com&gt;
</p>


<h3>References</h3>


<ul>
<li><p> Fabio, L. C., Villegas, C., Carrasco, J. M. F., and de Castro, M. (2023).
Diagnostic tools for a multivariate negative binomial
model for fitting correlated data with overdispersion. Communications in
Statistics - Theory and Methods, 52, 1833–1853.
</p>
</li>
<li><p> Fabio, L. C., Villegas, C., Mamun, A. S., and Carrasco, J. M. F. (2025).
Residual analysis for discrete correlated data in the multivariate approach.
Brazilian Journal of Biometrics, 43, e43728.
</p>
</li></ul>


<hr>
<h2 id='qMNB'>Randomized quantile residual</h2><span id='topic+qMNB'></span>

<h3>Description</h3>

<p>randomized quantile residual is available to assess possible departures
from the multivariate negative binomial model for fitting correlated data with overdispersion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qMNB(par, formula, dataSet)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="qMNB_+3A_par">par</code></td>
<td>
<p>the maximum likelihood estimates.</p>
</td></tr>
<tr><td><code id="qMNB_+3A_formula">formula</code></td>
<td>
<p>The structure matrix of covariates of dimension n x p (in models that include an intercept x
should contain a column of ones).</p>
</td></tr>
<tr><td><code id="qMNB_+3A_dataset">dataSet</code></td>
<td>
<p>data</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The randomized quantile residual (Dunn and Smyth, 1996), which
follow a standard normal distribution is used to assess departures from the multivariate negative binomial model.
</p>


<h3>Value</h3>

<p>Randomized quantile Residuals
</p>


<h3>Author(s)</h3>

<p>Jalmar M F Carrasco &lt;carrascojalmar@gmail.com&gt;,
Cristian M Villegas Lobos &lt;master.villegas@gmail.com&gt; and Lizandra C Fabio &lt;lizandrafabio@gmail.com&gt;
</p>


<h3>References</h3>


<ul>
<li><p> Dunn, P. K. and Smyth, G. K. (1996). Randomized quantile residuals. Journal of Computational and Graphical
Statistics, 5, 236-244.
</p>
</li>
<li><p> Fabio, L. C., Villegas, C., Carrasco, J. M. F., and de Castro, M. (2023).
Diagnostic tools for a multivariate negative binomial
model for fitting correlated data with overdispersion. Communications in
Statistics - Theory and Methods, 52, 1833–1853.
</p>
</li>
<li><p> Fabio, L. C., Villegas, C., Mamun, A. S., and Carrasco, J. M. F. (2025).
Residual analysis for discrete correlated data in the multivariate approach.
Brazilian Journal of Biometrics, 43, e43728.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
data(seizures)
head(seizures)

star &lt;-list(phi=1, beta0=1, beta1=1, beta2=1, beta3=1)
mod &lt;- fit.MNB(formula=Y ~ trt + period +
trt:period + offset(log(weeks)),star=star,dataSet=seizures,tab=FALSE)
par &lt;- mod$par
names(par)&lt;-c()

res.q &lt;- qMNB(par=par,formula=Y ~ trt + period + trt:period +
offset(log(weeks)),dataSet=seizures)

plot(res.q,ylim=c(-3,4.5),ylab="Randomized quantile residual",
xlab="Index",pch=15,cex.lab = 1.5, cex = 0.6, bg = 5)
abline(h=c(-2,0,2),lty=3)
#identify(res.q)


data(alzheimer)
head(alzheimer)

star &lt;- list(phi=10,beta1=2, beta2=0.2)
mod &lt;- fit.MNB(formula = Y ~ trat, star = star, dataSet = alzheimer,tab=FALSE)

par&lt;- mod$par
names(par) &lt;- c()
re.q &lt;- qMNB(par=par,formula = Y ~ trat, dataSet = alzheimer)
head(re.q)

</code></pre>

<hr>
<h2 id='re.MNB'>Residual analysis</h2><span id='topic+re.MNB'></span>

<h3>Description</h3>

<p>Weighted, standardized weighted, Pearson, standardized Pearson and
standardized deviance component residuals are available to assess possible departures
from the multivariate negative binomial model for fitting correlated data with overdispersion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>re.MNB(star, formula, dataSet)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="re.MNB_+3A_star">star</code></td>
<td>
<p>Initial values for the parameters to be optimized over.</p>
</td></tr>
<tr><td><code id="re.MNB_+3A_formula">formula</code></td>
<td>
<p>The structure matrix of covariates of dimension n x p (in models that include an intercept x
should contain a column of ones).</p>
</td></tr>
<tr><td><code id="re.MNB_+3A_dataset">dataSet</code></td>
<td>
<p>data</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Similarly to GLMs theory (Agresti, 2015; Faraway, 2016), weighted and
the standardized weighted residuals are deduced trough Fisher scoring iterative process.
Based in the Pearson residual, Fabio (2017) suggest the standardized Pearson residuals
for the multivariate model from the random intercept Poisson-GLG model. In addition,
it is available the standardized deviance component residual for the ith subject
(Fabio et al., 2012).
</p>


<h3>Value</h3>

<p>Residuals
</p>


<h3>Author(s)</h3>

<p>Jalmar M F Carrasco &lt;carrascojalmar@gmail.com&gt;,
Cristian M Villegas Lobos &lt;master.villegas@gmail.com&gt; and Lizandra C Fabio &lt;lizandrafabio@gmail.com&gt;
</p>


<h3>References</h3>


<ul>
<li><p> Agresti, A. (2015). Foundations of Linear and Generalized Linear Models. Wiley.
</p>
</li>
<li><p> Faraway, F. (2016). Extending the Linear Model with R: Generalized Linear,
Mixed Effects and nonparametric regression models. Taylor &amp; Francis, New York.
</p>
</li>
<li><p> Fabio, L., Paula, G. A., and de Castro, M. (2012). A Poisson mixed model
with nonormal random effect distribution. Computational Statistics and
Data Analysis, 56, 1499-1510.
</p>
</li>
<li><p> Fabio, L. C., Villegas, C., Carrasco, J. M. F., and de Castro, M. (2023).
Diagnostic tools for a multivariate negative binomial
model for fitting correlated data with overdispersion. Communications in
Statistics - Theory and Methods, 52, 1833–1853.
</p>
</li>
<li><p> Fabio, L. C., Villegas, C., Mamun, A. S., and Carrasco, J. M. F. (2025).
Residual analysis for discrete correlated data in the multivariate approach.
Brazilian Journal of Biometrics, 43, e43728.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
data(seizures)
head(seizures)

star &lt;-list(phi=1, beta0=1, beta1=1, beta2=1, beta3=1)

r &lt;- re.MNB(formula=Y ~ trt + period + trt:period +
offset(weeks),star=star,dataSet=seizures)

plot(r$ij.Sweighted.residual,cex.axis = 1.2, cex.lab = 1.2,
pch = 15,cex = 0.6, bg = 5,ylab="weighted.residual")

abline(h=c(-3,0,3),lwd = 2, lty = 2)

data(alzheimer)
head(alzheimer)

star &lt;- list(phi=10,beta1=2, beta2=0.2)
r &lt;- re.MNB(formula = Y ~ trat,star=star,dataSet=alzheimer)
names(r)

</code></pre>

<hr>
<h2 id='rMNB'>Generating Multivariate Negative Binomial Data</h2><span id='topic+rMNB'></span>

<h3>Description</h3>

<p>It simulates a multivariate response variable, <code class="reqn">Y_{ij}</code>, that is jth measurement
taken on the ith subject or cluster, i = 1,...,n and j= 1,...,mi.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rMNB(n, mi, formula, p.fix)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rMNB_+3A_n">n</code></td>
<td>
<p>Length of the sample.</p>
</td></tr>
<tr><td><code id="rMNB_+3A_mi">mi</code></td>
<td>
<p>replicates on the ith subject or cluster.</p>
</td></tr>
<tr><td><code id="rMNB_+3A_formula">formula</code></td>
<td>
<p>The structure matrix of covariates of dimension n x p (in models that include an intercept x
should contain a column of ones)</p>
</td></tr>
<tr><td><code id="rMNB_+3A_p.fix">p.fix</code></td>
<td>
<p>Vector of theoretical regression parameters of length p.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Generated response (<code class="reqn">Y_{ij}</code>)
</p>


<h3>Author(s)</h3>

<p>Jalmar M F Carrasco &lt;carrascojalmar@gmail.com&gt;,
Cristian M Villegas Lobos &lt;master.villegas@gmail.com&gt; and Lizandra C Fabio &lt;lizandrafabio@gmail.com&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
n &lt;- 100
mi &lt;- 3
x1 &lt;- rep(rnorm(n,0,1),each=mi)
x2 &lt;- rep(c(0,1),each=150)
p.fix &lt;- c(10,2.0,0.5,1)

#generating a sample
sample.ex &lt;- rMNB(n=n,mi=mi,formula=~x1+x2, p.fix=p.fix)
head(sample.ex)

</code></pre>

<hr>
<h2 id='seizures'>Seizures data</h2><span id='topic+seizures'></span>

<h3>Description</h3>

<p>The data set described in Diggle et.al (2013) refers to an experiment in which 59 epileptic patients
were randomly assigned to one of two treatment groups: treatment (progabide drug) and placebo groups.
The number of seizures experienced by each patient during the baseline period (week eight) and the four consecutive
periods (every two weeks) was recorded. The main goal of this application is to analyze the drug effect with
respect to the placebo. Two dummies covariates are considered in this study; Group which assumes values equal
to 1 if the patient belongs to treatment group and 0 otherwise, and Period which assumes values equal to 1 if the
number of seizures are recorded during the treatment and 0 if are measured in the baseline period. It is taking
into account the Time covariate which represents the number of weeks required for the counting of seizures in each
patient of the placebo and treatment groups.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(seizures)
</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<ul>
<li><p> Y: The number epileptic seizure.
</p>
</li>
<li><p> trt: Treatment: binary indicators for the prograbide and placebo groups.
</p>
</li>
<li><p> period: binary indicator for the baseline period.
</p>
</li>
<li><p> week: number od weeks
</p>
</li>
<li><p> ind: Indicator on the ith patient.
</p>
</li></ul>



<h3>References</h3>


<ul>
<li><p> Diggle, P. J., Liang, K. Y., and Zeger, S. L. (2013). Analysis of Longitudinal Data. Oxford
University Press, N.Y., 2 edition.
</p>
</li>
<li><p> Fabio, L. C., Villegas, C., Carrasco, J. M. F., and de Castro, M. (2023).
Diagnostic tools for a multivariate negative binomial
model for fitting correlated data with overdispersion. Communications in
Statistics - Theory and Methods, 52, 1833–1853.
</p>
</li>
<li><p> Fabio, L. C., Villegas, C., Mamun, A. S., and Carrasco, J. M. F. (2025).
Residual analysis for discrete correlated data in the multivariate approach.
Brazilian Journal of Biometrics, 43, e43728.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
data(seizures)
head(seizures)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
