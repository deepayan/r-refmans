<!DOCTYPE html><html><head><title>Help for package SCtools</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SCtools}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#SCtools-package'><p>SCTools: Tools for Synthetic Control Methods</p></a></li>
<li><a href='#alcohol'><p>World Alcohol per Capita Consumption</p></a></li>
<li><a href='#generate.placebos'><p>Function to generate placebo synthetic controls</p></a></li>
<li><a href='#is_tdf'><p>Test if the object is a tdf object</p></a></li>
<li><a href='#is_tdf_multi'><p>Test if the object is a tdf_multi object</p></a></li>
<li><a href='#mspe.plot'><p>Plot the post/pre-treatment MSPE ratio</p></a></li>
<li><a href='#mspe.test'><p>Function to compute the post/pre treatment MSPE ratio for the</p>
treated unit and placebos</a></li>
<li><a href='#multiple.synth'><p>Function to Apply Synthetic Controls to Multiple Treated Units</p></a></li>
<li><a href='#plac.dist'><p>Plot the distribution of placebo samples for synthetic control</p>
analysis with multiple treated units.</a></li>
<li><a href='#plot_placebos'><p>Function to plot placebos of a synthetic control analysis</p></a></li>
<li><a href='#synth.data'><p>Synth Data</p>
Synthetic data that can be used to explore SCtools.</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Extensions for Synthetic Controls Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-04-26</td>
</tr>
<tr>
<td>Description:</td>
<td>Extends the functionality of the package 'Synth' as detailed in Abadie, Diamond, and Hainmueller (2011) &lt;<a href="https://doi.org/10.18637%2Fjss.v042.i13">doi:10.18637/jss.v042.i13</a>&gt;. Includes generating and plotting placebos, post/pre-MSPE (Mean Squared Prediction Error) significance tests and plots, and calculating average treatment effects for multiple treated units. </td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/bcastanho/SCtools/issues">https://github.com/bcastanho/SCtools/issues</a></td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Bruno Castanho Silva &lt;b.paula.castanho.e.silva@fu-berlin.de&gt;</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5), future (&ge; 1.6.2)</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2, Synth, stringr, stats, cvTools, furrr, dplyr, purrr,
tidyr, magrittr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0), knitr, rmarkdown</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-04-30 12:17:49 UTC; brno</td>
</tr>
<tr>
<td>Author:</td>
<td>Bruno Castanho Silva
    <a href="https://orcid.org/0000-0001-9363-4704"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  Michael DeWitt <a href="https://orcid.org/0000-0001-8940-1967"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-05-01 18:32:15 UTC</td>
</tr>
</table>
<hr>
<h2 id='SCtools-package'>SCTools: Tools for Synthetic Control Methods</h2><span id='topic+SCtools'></span><span id='topic+SCtools-package'></span>

<h3>Description</h3>

<p>A set of functions to extend the synthetic controls analyses 
performed by the package 'Synth'. Includes generating and plotting placebos, 
significance tests and plots, and calculating average treatment effects 
for multiple treated units.
</p>


<h3>Details</h3>

<p>It has several goals:
</p>

<ul>
<li><p> Allow easy generation of placebos
</p>
</li>
<li><p> Generate figures for inference on SCM outputs
</p>
</li>
<li><p> Extend the existing Synth package
</p>
</li></ul>



<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Bruno Castanho Silva <a href="mailto:b.paula.castanho.e.silva@fu-berlin.de">b.paula.castanho.e.silva@fu-berlin.de</a> (<a href="https://orcid.org/0000-0001-9363-4704">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Michael DeWitt <a href="mailto:me.dewitt.jr@gmail.com">me.dewitt.jr@gmail.com</a> (<a href="https://orcid.org/0000-0001-8940-1967">ORCID</a>)
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li><p> Report bugs at <a href="https://github.com/bcastanho/SCtools/issues">https://github.com/bcastanho/SCtools/issues</a>
</p>
</li></ul>


<hr>
<h2 id='alcohol'>World Alcohol per Capita Consumption</h2><span id='topic+alcohol'></span>

<h3>Description</h3>

<p>This data set has been compiled from data from the World Health
Organization (WHO) and the World Bank (WB). The primary purpose was to investigate
the effects of policy changes in the Russian Federation enacted in 2003
around alcohol consumption. This is an excellent case study for SCM 
approaches to be used. You can read more about the policy changes at
<a href="https://www.theguardian.com/world/2019/oct/01/russian-alcohol-consumption-down-40-since-2003-who">https://www.theguardian.com/world/2019/oct/01/russian-alcohol-consumption-down-40-since-2003-who</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>alcohol
</code></pre>


<h3>Format</h3>

<p>a data.frame with 5107 rows and 8 columns:
</p>

<dl>
<dt>country_name</dt><dd><p>The name of the country</p>
</dd>
<dt>year</dt><dd><p>year</p>
</dd>
<dt>consumption</dt><dd><p>Alcohol consumption per capita (liters/person); all types</p>
</dd>
<dt>country_code</dt><dd><p>Three letter country code</p>
</dd>
<dt>labor_force_participation_rate</dt><dd><p>Labor force participation rate, total (percent of total population ages 15+)</p>
</dd>
<dt>mobile_cellular_subscriptions</dt><dd><p>Mobile cellular subscriptions (per 100 people)</p>
</dd>
<dt>inflation</dt><dd><p>Inflation, consumer prices (annual percent)</p>
</dd>
<dt>manufacturing</dt><dd><p>Manufacturing, value added (percent of GDP)</p>
</dd>
<dt>country_num</dt><dd><p>The country number</p>
</dd>
</dl>



<h3>Details</h3>

<p>WHO data available at <a href="https://apps.who.int/gho/data/node.main.A1039?lang=en">https://apps.who.int/gho/data/node.main.A1039?lang=en</a>.
</p>
<p>WB data available at <a href="https://data.worldbank.org/">https://data.worldbank.org/</a>.
</p>

<hr>
<h2 id='generate.placebos'>Function to generate placebo synthetic controls</h2><span id='topic+generate.placebos'></span><span id='topic+generate_placebos'></span>

<h3>Description</h3>

<p>Constructs a synthetic control unit for each unit in the 
donor pool of an implementation of the synthetic control method for a 
single treated unit. Used for placebo tests (see <a href="#topic+plot_placebos">plot_placebos</a>, 
<a href="#topic+mspe.test">mspe.test</a>, <a href="#topic+mspe.plot">mspe.plot</a>) to assess the strength and 
significance of a causal inference based on the synthetic control method. 
On placebo tests, see Abadie and Gardeazabal (2003), and Abadie, Diamond, 
and Hainmueller (2010, 2011, 2014).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generate.placebos(
  dataprep.out,
  synth.out,
  Sigf.ipop = 5,
  strategy = "sequential"
)

generate_placebos(
  dataprep.out,
  synth.out,
  Sigf.ipop = 5,
  strategy = "sequential"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="generate.placebos_+3A_dataprep.out">dataprep.out</code></td>
<td>
<p>A data.prep object produced by the <code>dataprep</code> command</p>
</td></tr>
<tr><td><code id="generate.placebos_+3A_synth.out">synth.out</code></td>
<td>
<p>A synth.out object produced by the <code>synth</code> command</p>
</td></tr>
<tr><td><code id="generate.placebos_+3A_sigf.ipop">Sigf.ipop</code></td>
<td>
<p>The Precision setting for the ipop optimization routine. 
Default of 5.</p>
</td></tr>
<tr><td><code id="generate.placebos_+3A_strategy">strategy</code></td>
<td>
<p>The processing method you wish to use 
&quot;sequential&quot;, &quot;multicore&quot; or &quot;multisession&quot;. Use &quot;multicore&quot; or &quot;multisession&quot; to parallelize operations
and reduce computing time. Default is <code>sequential</code>. Since SCtools &gt;= 0.3.2 &quot;multiprocess&quot; is deprecated.</p>
</td></tr>
</table>


<h3>Value</h3>


<dl>
<dt>df </dt><dd><p>Data frame with outcome data for each control unit and their 
respective synthetic control and for the original treated and its control</p>
</dd>
<dt>mspe.placs </dt><dd><p>Mean squared prediction error for the pretreatment 
period for each placebo</p>
</dd>
<dt>t0</dt><dd><p>First time unit in <code>time.optimize.ssr</code></p>
</dd>
<dt>t1</dt><dd><p>First time unit after the highest value in <code>time.optimize.ssr</code></p>
</dd>
<dt>tr</dt><dd><p>Unit number of the treated unit</p>
</dd>
<dt>names.and.numbers</dt><dd><p>Dataframe with two columns showing all unit 
numbers and names from control units</p>
</dd>
<dt>n</dt><dd><p>Number of control units</p>
</dd>
<dt>treated.name</dt><dd><p>Unit name of the treated unit</p>
</dd>
<dt>loss.v</dt><dd><p>Pretreatment MSPE of the treated unit's synthetic control</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>
## Example with toy data from Synth
library(Synth)
# Load the simulated data
data(synth.data)

# Execute dataprep to produce the necessary matrices for synth
dataprep.out&lt;-
  dataprep(
    foo = synth.data,
    predictors = c("X1"),
    predictors.op = "mean",
    dependent = "Y",
    unit.variable = "unit.num",
    time.variable = "year",
    special.predictors = list(
      list("Y", 1991, "mean")
    ),
    treatment.identifier = 7,
    controls.identifier = c(29, 2, 13, 17),
    time.predictors.prior = c(1984:1989),
    time.optimize.ssr = c(1984:1990),
    unit.names.variable = "name",
    time.plot = 1984:1996
)

# run the synth command to create the synthetic control
synth.out &lt;- synth(dataprep.out, Sigf.ipop=2)

## run the generate.placebos command to reassign treatment status
## to each unit listed as control, one at a time, and generate their
## synthetic versions. Sigf.ipop = 2 for faster computing time. 
## Increase to the default of 5 for better estimates. 
tdf &lt;- generate.placebos(dataprep.out,synth.out, Sigf.ipop = 2)

</code></pre>

<hr>
<h2 id='is_tdf'>Test if the object is a tdf object</h2><span id='topic+is_tdf'></span>

<h3>Description</h3>

<p>This function returns 'TRUE' for the object returned from the 
<code>generate.placebos</code> function.
and 'FALSE' for all other objects, including regular data frames.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_tdf(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is_tdf_+3A_x">x</code></td>
<td>
<p>An object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>'TRUE' if the object inherits from the 'tdf' class.
</p>

<hr>
<h2 id='is_tdf_multi'>Test if the object is a tdf_multi object</h2><span id='topic+is_tdf_multi'></span>

<h3>Description</h3>

<p>This function returns 'TRUE' for the object returned from the 
<code>multiple.synth</code> function.
and 'FALSE' for all other objects, including regular data frames.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_tdf_multi(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is_tdf_multi_+3A_x">x</code></td>
<td>
<p>An object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>'TRUE' if the object inherits from the 'tdf_multi' class.
</p>

<hr>
<h2 id='mspe.plot'>Plot the post/pre-treatment MSPE ratio</h2><span id='topic+mspe.plot'></span><span id='topic+mspe_plot'></span>

<h3>Description</h3>

<p>Plots the post/pre-treatment mean square prediction error ratio 
for the treated unit and placebos.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mspe.plot(
  tdf,
  discard.extreme = FALSE,
  mspe.limit = 20,
  plot.hist = FALSE,
  title = NULL,
  xlab = "Post/Pre MSPE ratio",
  ylab = NULL
)

mspe_plot(
  tdf,
  discard.extreme = FALSE,
  mspe.limit = 20,
  plot.hist = FALSE,
  title = NULL,
  xlab = "Post/Pre MSPE ratio",
  ylab = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mspe.plot_+3A_tdf">tdf</code></td>
<td>
<p>An object constructed by <code><a href="#topic+generate.placebos">generate.placebos</a></code>.</p>
</td></tr>
<tr><td><code id="mspe.plot_+3A_discard.extreme">discard.extreme</code></td>
<td>
<p>Logical. Whether or not placebos with high 
pre-treatement MSPE should be excluded from the plot.</p>
</td></tr>
<tr><td><code id="mspe.plot_+3A_mspe.limit">mspe.limit</code></td>
<td>
<p>Numerical. Used if <code>discard.extreme</code> is <code>TRUE</code>. 
It indicates how many times the pretreatment MSPE of a placebo should 
be higher than that of the treated unit to be considered extreme and 
discarded. Default is <code>20</code>.</p>
</td></tr>
<tr><td><code id="mspe.plot_+3A_plot.hist">plot.hist</code></td>
<td>
<p>Logical. If <code>FALSE</code>, a dotplot with each unit name 
and its post/pre treatment MSPE ratio is produced. If <code>TRUE</code>, 
a histogram is produced, with the frequency of each ratio. 
Should be set to <code>TRUE</code> when there are many controls, to make 
visualization easier.</p>
</td></tr>
<tr><td><code id="mspe.plot_+3A_title">title</code></td>
<td>
<p>Character. Optional. Title of the plot.</p>
</td></tr>
<tr><td><code id="mspe.plot_+3A_xlab">xlab</code></td>
<td>
<p>Character. Optional. Label of the x axis.</p>
</td></tr>
<tr><td><code id="mspe.plot_+3A_ylab">ylab</code></td>
<td>
<p>Character. Optional. Label of the y axis.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Post/pre-treatement mean square prediction error ratio is the 
difference between the observed outcome of a unit and its synthetic 
control, before and after treatement. A higher ratio means a small 
pretreatment prediction error (a good synthetic control), and a high 
post-treatment MSPE, meaning a large difference between the unit and 
its synthetic control after the intervention. By calculating this ratio 
for all placebos, the test can be interpreted as looking at how likely 
the result obtained for a single treated case with a synthetic control 
analysis could have occurred by chance given no treatement. 
For more detailed description, see Abadie, Diamond, and Hainmueller (2011, 2014).
</p>


<h3>Value</h3>


<dl>
<dt>p.dot </dt><dd><p>Plot with the post/pre MSPE ratios for the treated unit and
each placebo indicated individually. Returned if <code>plot.hist</code> is 
<code>FALSE</code>.</p>
</dd>
<dt>p.dens </dt><dd><p>Histogram of the distribution of post/pre MSPE ratios for
all placebos and the treated unit. Returned if <code>plot.hist</code> is 
<code>TRUE</code>.</p>
</dd>
</dl>



<h3>References</h3>

<p>Abadie, A., Diamond, A., Hainmueller, J. (2014). 
Comparative Politics and the Synthetic Control Method. 
American Journal of Political Science Forthcoming 2014.
</p>
<p>Synthetic : An R Package for Synthetic Control Methods in Comparative 
Case Studies. Journal of Statistical Software 42 (13) 1–17.
</p>
<p>Abadie, A., Diamond, A., Hainmueller, J. (2011). Synth: An R Package for 
Synthetic Control Methods in Comparative Case Studies. 
Journal of Statistical Software 42 (13) 1–17.
</p>
<p>Abadie A, Diamond A, Hainmueller J (2010). Synthetic Control Methods for 
Comparative Case Studies: Estimating the Effect of California's Tobacco 
Control Program. Journal of the American Statistical Association 
105 (490) 493–505.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+generate.placebos">generate.placebos</a></code>, <code><a href="#topic+mspe.test">mspe.test</a></code>, 
<code><a href="#topic+plot_placebos">plot_placebos</a></code>, <code><a href="Synth.html#topic+synth">synth</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Example with toy data from 'Synth'
library(Synth)
# Load the simulated data
data(synth.data)

# Execute dataprep to produce the necessary matrices for 'Synth'
dataprep.out&lt;-
  dataprep(
    foo = synth.data,
    predictors = c("X1"),
    predictors.op = "mean",
    dependent = "Y",
    unit.variable = "unit.num",
    time.variable = "year",
    special.predictors = list(
      list("Y", 1991, "mean")
    ),
    treatment.identifier = 7,
    controls.identifier = c(29, 2, 13, 17),
    time.predictors.prior = c(1984:1989),
    time.optimize.ssr = c(1984:1990),
    unit.names.variable = "name",
    time.plot = 1984:1996
)

# run the synth command to create the synthetic control
synth.out &lt;- synth(dataprep.out, Sigf.ipop=2)

## run the generate.placebos command to reassign treatment status
## to each unit listed as control, one at a time, and generate their
## synthetic versions. Sigf.ipop = 2 for faster computing time. 
## Increase to the default of 5 for better estimates. 
tdf &lt;- generate.placebos(dataprep.out,synth.out, Sigf.ipop = 2)

## Test how extreme was the observed treatment effect given the placebos:
ratio &lt;- mspe.test(tdf)
ratio$p.val

mspe.plot(tdf, discard.extreme = FALSE)
   
</code></pre>

<hr>
<h2 id='mspe.test'>Function to compute the post/pre treatment MSPE ratio for the 
treated unit and placebos</h2><span id='topic+mspe.test'></span><span id='topic+mspe_test'></span>

<h3>Description</h3>

<p>Computes the post/pre treatement mean square prediction error 
ratio for a treated unit in a synthetic control analysis and all placebos 
produced with <code><a href="#topic+generate.placebos">generate.placebos</a></code>. Returns a matrix with 
ratios and a p-value of how extreme the treated unit's ratio is in 
comparison with that of placebos. Equivalent to a significance testing 
of a synthetic controls result.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mspe.test(tdf, discard.extreme = FALSE, mspe.limit = 20)

mspe_test(tdf, discard.extreme = FALSE, mspe.limit = 20)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mspe.test_+3A_tdf">tdf</code></td>
<td>
<p>An object constructed by <code><a href="#topic+generate.placebos">generate.placebos</a></code></p>
</td></tr>
<tr><td><code id="mspe.test_+3A_discard.extreme">discard.extreme</code></td>
<td>
<p>Logical. Whether or not placebos with high 
pre-treatement MSPE should be excluded from the count and significance 
testing.</p>
</td></tr>
<tr><td><code id="mspe.test_+3A_mspe.limit">mspe.limit</code></td>
<td>
<p>Numerical. Used if <code>discard.extreme</code> is <code>TRUE</code>. 
It indicates how many times the pretreatment MSPE of a placebo should be 
higher than that of the treated unit to be considered extreme and 
discarded. Default is <code>20</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Post/pre-treatement mean square prediction error ratio is the 
difference between the observed outcome of a unit and its synthetic 
control, before and after treatement. A higher ratio means a small 
pre-treatment prediction error (a good synthetic control), and a 
high post-treatment MSPE, meaning a large difference between the unit 
and its synthetic control after the intervention. 
By calculating this ratio for all placebos, the test can be interpreted 
as looking at how likely the result obtained for a single treated case 
with a synthetic control analysis could have occurred by chance given 
no treatement. For more detailed description, see Abadie, Diamond, 
and Hainmueller (2011, 2014).
</p>


<h3>Value</h3>


<dl>
<dt>p.val</dt><dd><p>The p-value of the treated unit post/pre MSPE ratio. 
It is the proportion of units (placebos and treated) that have a ratio 
equal or higher that of the treated unit</p>
</dd>
<dt>test</dt><dd><p>Dataframe with two columns. The first is the post/pre MSPE 
ratio for each unit. The second indicates unit names</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+generate.placebos">generate.placebos</a></code>, <code><a href="#topic+mspe.plot">mspe.plot</a></code>, 
<code><a href="Synth.html#topic+synth">synth</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Example with toy data from 'Synth'
library(Synth)
# Load the simulated data
data(synth.data)

# Execute dataprep to produce the necessary matrices for 'Synth'
dataprep.out&lt;-
  dataprep(
    foo = synth.data,
    predictors = c("X1"),
    predictors.op = "mean",
    dependent = "Y",
    unit.variable = "unit.num",
    time.variable = "year",
    special.predictors = list(
      list("Y", 1991, "mean")
    ),
    treatment.identifier = 7,
    controls.identifier = c(29, 2, 13, 17),
    time.predictors.prior = c(1984:1989),
    time.optimize.ssr = c(1984:1990),
    unit.names.variable = "name",
    time.plot = 1984:1996
)

# run the synth command to create the synthetic control
synth.out &lt;- synth(dataprep.out, Sigf.ipop=2)

## run the generate.placebos command to reassign treatment status
## to each unit listed as control, one at a time, and generate their
## synthetic versions. Sigf.ipop = 2 for faster computing time. 
## Increase to the default of 5 for better estimates. 
tdf &lt;- generate.placebos(dataprep.out,synth.out, Sigf.ipop = 2)

## Test how extreme was the observed treatment effect given the placebos:
ratio &lt;- mspe.test(tdf)
ratio$p.val

mspe.plot(tdf, discard.extreme = FALSE)
   
</code></pre>

<hr>
<h2 id='multiple.synth'>Function to Apply Synthetic Controls to Multiple Treated Units</h2><span id='topic+multiple.synth'></span><span id='topic+multiple_synth'></span>

<h3>Description</h3>

<p>Generates one synthetic control for each treated unit and calculates 
the difference between the treated and the synthetic control for each. 
Returns a vector with outcome values for the synthetic controls, 
a plot of average treatment effects, and if required generates placebos 
out of the donor pool to be used in conjunction with <code><a href="#topic+plac.dist">plac.dist</a></code>. 
All arguments are the same used for <code><a href="Synth.html#topic+dataprep">dataprep</a></code> in the <code><a href="Synth.html#topic+synth">Synth</a></code>
package, except for <code>treated.units</code>, <code>treatment.time</code>, and 
<code><a href="#topic+generate.placebos">generate.placebos</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multiple.synth(
  foo,
  predictors,
  predictors.op,
  dependent,
  unit.variable,
  time.variable,
  special.predictors,
  treated.units,
  control.units,
  time.predictors.prior,
  time.optimize.ssr,
  unit.names.variable,
  time.plot,
  treatment.time,
  gen.placebos = FALSE,
  strategy = "sequential",
  Sigf.ipop = 5
)

multiple_synth(
  foo,
  predictors,
  predictors.op,
  dependent,
  unit.variable,
  time.variable,
  special.predictors,
  treated.units,
  control.units,
  time.predictors.prior,
  time.optimize.ssr,
  unit.names.variable,
  time.plot,
  treatment.time,
  gen.placebos = FALSE,
  strategy = "sequential",
  Sigf.ipop = 5
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="multiple.synth_+3A_foo">foo</code></td>
<td>
<p>Dataframe with the panel data.</p>
</td></tr>
<tr><td><code id="multiple.synth_+3A_predictors">predictors</code></td>
<td>
<p>Vector of column numbers or column-name character strings 
that identifies the predictors' columns. All predictors have to be numeric.</p>
</td></tr>
<tr><td><code id="multiple.synth_+3A_predictors.op">predictors.op</code></td>
<td>
<p>A character string identifying the method (operator) 
to be used on the predictors. Default is <code>mean</code>.</p>
</td></tr>
<tr><td><code id="multiple.synth_+3A_dependent">dependent</code></td>
<td>
<p>The column number or a string with the column name that 
corresponds to the dependent variable.</p>
</td></tr>
<tr><td><code id="multiple.synth_+3A_unit.variable">unit.variable</code></td>
<td>
<p>The column number or a string with the column name 
that identifies unit numbers. The variable must be numeric.</p>
</td></tr>
<tr><td><code id="multiple.synth_+3A_time.variable">time.variable</code></td>
<td>
<p>The column number or a string with the column name 
that identifies the period (time) data. The variable must be numeric.</p>
</td></tr>
<tr><td><code id="multiple.synth_+3A_special.predictors">special.predictors</code></td>
<td>
<p>A list object identifying additional predictors and 
their pre-treatment years and operators.</p>
</td></tr>
<tr><td><code id="multiple.synth_+3A_treated.units">treated.units</code></td>
<td>
<p>A vector identifying the <code>unit.variable</code> numbers of 
the treated units.</p>
</td></tr>
<tr><td><code id="multiple.synth_+3A_control.units">control.units</code></td>
<td>
<p>A vector identifying the <code>unit.variable</code> numbers of 
the control units.</p>
</td></tr>
<tr><td><code id="multiple.synth_+3A_time.predictors.prior">time.predictors.prior</code></td>
<td>
<p>A numeric vector identifying the pretreatment 
periods over which the values for the outcome predictors should be averaged.</p>
</td></tr>
<tr><td><code id="multiple.synth_+3A_time.optimize.ssr">time.optimize.ssr</code></td>
<td>
<p>A numeric vector identifying the periods of the 
dependent variable over which the loss function should be minimized 
between each treated unit and its synthetic control.</p>
</td></tr>
<tr><td><code id="multiple.synth_+3A_unit.names.variable">unit.names.variable</code></td>
<td>
<p>The column number or string with column name 
identifying the variable with units' names. The variable must be a character.</p>
</td></tr>
<tr><td><code id="multiple.synth_+3A_time.plot">time.plot</code></td>
<td>
<p>A vector identifying the periods over which results are 
to be plotted with <code><a href="Synth.html#topic+path.plot">path.plot</a></code></p>
</td></tr>
<tr><td><code id="multiple.synth_+3A_treatment.time">treatment.time</code></td>
<td>
<p>A numeric value with the value in <code>time.variable</code>
that marks the intervention.</p>
</td></tr>
<tr><td><code id="multiple.synth_+3A_gen.placebos">gen.placebos</code></td>
<td>
<p>Logical. Whether a placebo (a synthetic control) 
for each unit in the donor pool should be constructed. Will increase 
computation time.</p>
</td></tr>
<tr><td><code id="multiple.synth_+3A_strategy">strategy</code></td>
<td>
<p>The processing method you wish to use 
&quot;sequential&quot;, &quot;multicore&quot; or &quot;multisession&quot; . Use &quot;multicore&quot; or &quot;multisession&quot; to parallelize operations
and reduce computing time. Default is <code>sequential</code>. Since SCtools &gt;= 0.3.2 &quot;multiprocess&quot; is deprecated.</p>
</td></tr>
<tr><td><code id="multiple.synth_+3A_sigf.ipop">Sigf.ipop</code></td>
<td>
<p>The Precision setting for the ipop optimization routine. 
Default of 5.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function runs <code><a href="Synth.html#topic+dataprep">dataprep</a></code> and <code><a href="Synth.html#topic+synth">synth</a></code> 
for each unit identified in <code>treated.units</code>. It saves the vector with 
predicted values for each synthetic control, to be used in estimating 
average treatment effects in applications of Synthetic Controls for 
multiple treated units.
</p>
<p>For further details on the arguments, see the documentation of 
<code><a href="Synth.html#topic+synth">Synth</a></code>.
</p>


<h3>Value</h3>

<p>Data frame. Each column contains the outcome values for every 
time-point for one unit or its synthetic control. The last column contains 
the time-points.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Using the toy data from 'Synth':

library(Synth)
data(synth.data)
set.seed(42)

multi &lt;- multiple.synth(foo = synth.data,
                       predictors = c("X1"),
                       predictors.op = "mean",
                       dependent = "Y",
                       unit.variable = "unit.num",
                       time.variable = "year",
                       treatment.time = 1990,
                       special.predictors = list(
                         list("Y", 1991, "mean")
                       ),
                       treated.units = c(2,7),
                       control.units = c(29, 13, 17),
                       time.predictors.prior = c(1984:1989),
                       time.optimize.ssr = c(1984:1990),
                       unit.names.variable = "name",
                       time.plot = 1984:1996, gen.placebos =  FALSE, 
                       Sigf.ipop = 2)
## Plot with the average path of the treated units and the average of their
## respective synthetic controls:

multi$p

</code></pre>

<hr>
<h2 id='plac.dist'>Plot the distribution of placebo samples for synthetic control 
analysis with multiple treated units.</h2><span id='topic+plac.dist'></span><span id='topic+plac_dist'></span>

<h3>Description</h3>

<p>Takes the output object of <code><a href="#topic+multiple.synth">multiple.synth</a></code> creates a 
distribution of placebo average treatment effects, to test the 
significance of the observed ATE. Does so by sampling k placebos 
(where k = the number of treated units) nboots times, and calculating 
the average treatment effect of the k placebos each time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plac.dist(multiple.synth, nboots = 500)

plac_dist(multiple.synth, nboots = 500)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plac.dist_+3A_multiple.synth">multiple.synth</code></td>
<td>
<p>An object returned by the function 
<code><a href="#topic+multiple.synth">multiple.synth</a></code></p>
</td></tr>
<tr><td><code id="plac.dist_+3A_nboots">nboots</code></td>
<td>
<p>Number of bootstrapped samples of placebos to take.
Default is <code>500</code>. It should be higher for more reliable inference.</p>
</td></tr>
</table>


<h3>Value</h3>


<dl>
<dt>p</dt><dd><p>The plot.</p>
</dd>
<dt>att.t</dt><dd><p>The observed average treatment effect.</p>
</dd>
<dt>df</dt><dd><p>Dataframe where each row is the ATT for one bootstrapped placebo 
sample, used to build the distribution plot.</p>
</dd>
<dt>p.value</dt><dd><p>Proportion of bootstrapped placebo samples ATTs which are
more extreme than the observed average treatment effect. Equivalent to a 
p-value in a two-tailed test.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>
## Using the toy data from Synth:
library(Synth)
data(synth.data)
set.seed(42)
## Run the function similar to the dataprep() setup:
multi &lt;- multiple.synth(foo = synth.data,
                       predictors = c("X1", "X2", "X3"),
                       predictors.op = "mean",
                       dependent = "Y",
                       unit.variable = "unit.num",
                       time.variable = "year",
                       treatment.time = 1990,
                       special.predictors = list(
                         list("Y", 1991, "mean"),
                         list("Y", 1985, "mean"),
                         list("Y", 1980, "mean")
                       ),
                       treated.units = c(2,7),
                       control.units = c(29, 13, 17, 32),
                       time.predictors.prior = c(1984:1989),
                       time.optimize.ssr = c(1984:1990),
                       unit.names.variable = "name",
                       time.plot = 1984:1996, gen.placebos = TRUE, Sigf.ipop = 2,
                       strategy = 'multicore' )

## Plot with the average path of the treated units and the average of their
## respective synthetic controls:

multi$p

## Bootstrap the placebo units to get a distribution of placebo average
## treatment effects, and plot the distribution with a vertical line 
## indicating the actual ATT:

att.test &lt;- plac.dist(multi)
att.test$p


</code></pre>

<hr>
<h2 id='plot_placebos'>Function to plot placebos of a synthetic control analysis</h2><span id='topic+plot_placebos'></span>

<h3>Description</h3>

<p>Creates plots with the difference between observed units 
and synthetic controls for the treated and control units. 
See Abadie, Diamond, and Hainmueller (2011).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_placebos(
  tdf = tdf,
  discard.extreme = FALSE,
  mspe.limit = 20,
  xlab = NULL,
  ylab = NULL,
  title = NULL,
  alpha.placebos = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_placebos_+3A_tdf">tdf</code></td>
<td>
<p>An object with a list of outcome values for placebos, 
constructed by <code><a href="#topic+generate.placebos">generate.placebos</a></code>.</p>
</td></tr>
<tr><td><code id="plot_placebos_+3A_discard.extreme">discard.extreme</code></td>
<td>
<p>Logical. Whether or not units with high pre-treatement 
MSPE should be excluded from the plot. Takes a default of <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot_placebos_+3A_mspe.limit">mspe.limit</code></td>
<td>
<p>Numerical. Used if <code>discard.extreme</code> is <code>TRUE</code>. 
It indicates how many times the pre-treatment MSPE of a placebo should 
be higher than that of the treated unit to be considered extreme and 
discarded. Default is <code>20</code>.</p>
</td></tr>
<tr><td><code id="plot_placebos_+3A_xlab">xlab</code></td>
<td>
<p>Character. Optional. Label of the x axis.</p>
</td></tr>
<tr><td><code id="plot_placebos_+3A_ylab">ylab</code></td>
<td>
<p>Character. Optional. Label of the y axis.</p>
</td></tr>
<tr><td><code id="plot_placebos_+3A_title">title</code></td>
<td>
<p>Character. Optional. Title of the plot.</p>
</td></tr>
<tr><td><code id="plot_placebos_+3A_alpha.placebos">alpha.placebos</code></td>
<td>
<p>the transparency setting, default of <code>1</code></p>
</td></tr>
<tr><td><code id="plot_placebos_+3A_...">...</code></td>
<td>
<p>optional arguments (currently not used)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>p.gaps Gaps plot indicating difference between the treated unit, 
the placebos, and their respective synthetic controls.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+generate.placebos">generate.placebos</a></code>, <code><a href="Synth.html#topic+gaps.plot">gaps.plot</a></code>, 
<code><a href="Synth.html#topic+synth">synth</a></code>, <code><a href="Synth.html#topic+dataprep">dataprep</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Example with toy data from Synth
library(Synth)
# Load the simulated data
data(synth.data)

# Execute dataprep to produce the necessary matrices for synth
dataprep.out&lt;-
  dataprep(
    foo = synth.data,
    predictors = c("X1"),
    predictors.op = "mean",
    dependent = "Y",
    unit.variable = "unit.num",
    time.variable = "year",
    special.predictors = list(
      list("Y", 1991, "mean")
    ),
    treatment.identifier = 7,
    controls.identifier = c(29, 2, 13, 17),
    time.predictors.prior = c(1984:1989),
    time.optimize.ssr = c(1984:1990),
    unit.names.variable = "name",
    time.plot = 1984:1996
)

# run the synth command to create the synthetic control
synth.out &lt;- synth(dataprep.out, Sigf.ipop=2)

## run the generate.placebos command to reassign treatment status
## to each unit listed as control, one at a time, and generate their
## synthetic versions. Sigf.ipop = 2 for faster computing time. 
## Increase to the default of 5 for better estimates. 
tdf &lt;- generate.placebos(dataprep.out,synth.out, Sigf.ipop = 2, strategy='multicore')

## Plot the gaps in outcome values over time of each unit --
## treated and placebos -- to their synthetic controls

p &lt;- plot_placebos(tdf,discard.extreme=TRUE, mspe.limit=10, xlab='Year')
p

</code></pre>

<hr>
<h2 id='synth.data'>Synth Data
Synthetic data that can be used to explore SCtools.</h2><span id='topic+synth.data'></span>

<h3>Description</h3>

<p>Synth Data
Synthetic data that can be used to explore SCtools.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>synth.data
</code></pre>


<h3>Format</h3>

<p>a data.frame with 168 rows and 7 columns:
</p>

<dl>
<dt>unit.num</dt><dd><p>The experimental unit number</p>
</dd>
<dt>year</dt><dd><p>year</p>
</dd>
<dt>name</dt><dd><p>name of the experimental unit</p>
</dd>
<dt>Y</dt><dd><p>outcome of interest</p>
</dd>
<dt>X1</dt><dd><p>Covariate 1</p>
</dd>
<dt>X2</dt><dd><p>Covariate 2</p>
</dd>
<dt>X3</dt><dd><p>Covariate 3</p>
</dd>
</dl>


</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
