<!DOCTYPE html><html lang="en"><head><title>Help for package catR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {catR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#aStratified'><p>Item membership assessment for a-stratified sampling</p></a></li>
<li><a href='#breakBank'><p>Breaking the item bank in item parameters and group membership (for content balancing)</p></a></li>
<li><a href='#cat_pav'><p>Items parameters of the CAT_PAV data set (with item names)</p></a></li>
<li><a href='#checkStopRule'><p>Checking whether the stopping rule is satisfied</p></a></li>
<li><a href='#eapEst'><p>EAP ability estimation (dichotomous and polytomous IRT models)</p></a></li>
<li><a href='#eapSem'><p>Standard error of EAP ability estimation (dichotomous and polytomous IRT models)</p></a></li>
<li><a href='#EPV'><p>Expected Posterior Variance (EPV)</p></a></li>
<li><a href='#fullDist'><p>Full distribution of ability estimator (dichotomous models only)</p></a></li>
<li><a href='#GDI'><p>Global-discrimination index (GDI) and posterior global-discrimination index (GDIP) for item selection</p></a></li>
<li><a href='#genDichoMatrix'><p>Item bank generation (dichotomous models)</p></a></li>
<li><a href='#genPattern'><p>Random generation of item response patterns under dichotomous and polytomous IRT models</p></a></li>
<li><a href='#genPolyMatrix'><p>Item bank generation (polytomous models)</p></a></li>
<li><a href='#Ii'><p>Item information functions, first and second derivatives (dichotomous and polytomous models)</p></a></li>
<li><a href='#integrate.catR'><p>Numerical integration by linear interpolation (for catR internal use)</p></a></li>
<li><a href='#Ji'><p>Function <code class="reqn">J(\theta)</code> for weighted likelihood estimation (dichotomous and polytomous IRT models)</p></a></li>
<li><a href='#KL'><p>Kullback-Leibler (KL) and posterior Kullback-Leibler (KLP) values for item selection</p></a></li>
<li><a href='#MEI'><p>(Maximum) Expected Information (MEI)</p></a></li>
<li><a href='#MWI'><p>Maximum likelihood weighted information (MLWI) and maximum posterior weighted information (MPWI)</p></a></li>
<li><a href='#nextItem'><p>Selection of the next item</p></a></li>
<li><a href='#OIi'><p>Observed information function (dichotomous and polytomous models)</p></a></li>
<li><a href='#Pi'><p>Item response probabilities, first, second and third derivatives (dichotomous and polytomous models)</p></a></li>
<li><a href='#randomCAT'><p>Random generation of adaptive tests (dichotomous and polytomous models)</p></a></li>
<li><a href='#semTheta'><p>Standard error of ability estimation (dichotomous and polytomous models)</p></a></li>
<li><a href='#simulateRespondents'><p>Simulation of multiple examinees of adaptive tests</p></a></li>
<li><a href='#startItems'><p>Selection of the first items</p></a></li>
<li><a href='#tcals'><p>Items parameters of the TCALS 1998 data set and subgroups of items</p></a></li>
<li><a href='#test.cbList'><p>Testing the format of the list for content balancing under dichotomous or polytomous IRT models</p></a></li>
<li><a href='#testList'><p>Testing the format of the input lists</p></a></li>
<li><a href='#thetaEst'><p>Ability estimation (dichotomous and polytomous models)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Generation of IRT Response Patterns under Computerized Adaptive
Testing</td>
</tr>
<tr>
<td>Version:</td>
<td>3.17</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-06-23</td>
</tr>
<tr>
<td>Author:</td>
<td>David Magis (U Liege, Belgium), Gilles Raiche (UQAM, Canada), Juan Ramon Barrada (U Zaragoza, Spain)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Cheng Hua &lt;chuabest@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0)</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides routines for the generation of response patterns under unidimensional dichotomous and polytomous computerized adaptive testing (CAT) framework. It holds many standard functions to estimate ability, select the first item(s) to administer and optimally select the next item, as well as several stopping rules. Options to control for item exposure and content balancing are also available (Magis and Barrada (2017) &lt;<a href="https://doi.org/10.18637%2Fjss.v076.c01">doi:10.18637/jss.v076.c01</a>&gt;).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.0</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-06-24 00:03:18 UTC; chenghua</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-06-24 08:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='aStratified'>Item membership assessment for a-stratified sampling</h2><span id='topic+aStratified'></span>

<h3>Description</h3>

<p>This command allocates each item from the bank into its specified stratum, defined by increasing discrimination parameters for a-stratified sampling.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aStratified(itemBank, K, model = NULL)
 </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="aStratified_+3A_itembank">itemBank</code></td>
<td>
<p>a matrix or data frame of item parameters. Must refer to either nay dichotomous IRT model or to polytomous GRM, MGRM or GPCM models. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="aStratified_+3A_k">K</code></td>
<td>
<p>either a single integer value specifying the number of strata, or an integer vector of required numbers of items per strata.</p>
</td></tr>
<tr><td><code id="aStratified_+3A_model">model</code></td>
<td>
<p>either <code>NULL</code> (default) for dichotomous models, or any suitable acronym for allowed polytomous models. Possible values are <code>"GRM"</code>, <code>"MGRM"</code> and <code>"GPCM"</code>. See <b>Details</b>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>a-stratified sampling (Chang and Ying, 1999) is a content balancing technique that splits the item bank into several strata, the latter being set by increasing discrimination (a) parameters. The first stratum holds the least discriminative items, the second stratum the second set of least discriminative items etc., and the last stratum the most discriminative items. Content balancing item selection is then performed with equiprobable item selection across the strata.
</p>
<p>The specification of the strata can be done in two ways, through the <code>K</code> argument. First, <code>K</code> can take any positive integer value (larger than one and smaller than the number of items): it specifies then the number of strata to create. Each stratum will hold approximately the same number of items, and in case the ratio between the number of items in the bank and <code>K</code> is not an integer value, then the last stratum will hold more items than the other ones. Second, <code>K</code> can be a vector of integer values that specify the number of items per strata. In this second case, the first stratum will hold as many items as the first component of <code>K</code>, the second startum as many items as the second component of <code>K</code>, and so on. Note that the sum of <code>K</code> shoudl coincide with the number of items in the bank.
</p>
<p>Dichotomous IRT models are considered whenever <code>model</code> is set to <code>NULL</code> (default value). In this case, <code>it</code> must be a matrix with one row per item and four columns, with the values of the discrimination, the difficulty, the pseudo-guessing and the inattention parameters (in this order). These are the parameters of the four-parameter logistic (4PL) model
(Barton and Lord, 1981). 
</p>
<p>Polytomous IRT models are specified by their respective acronym: <code>"GRM"</code> for Graded Response Model, <code>"MGRM"</code> for Modified Graded Response Model and <code>"GPCM"</code> for Generalized Partial Credit Model. <em>Other polytomous IRT models are not allowed for this function and an error message will be returned if the input item bank does not follow one of the three aforementioned models</em>. The <code>it</code> still holds one row per item, end the number of columns and their content depends on the model. See <code><a href="#topic+genPolyMatrix">genPolyMatrix</a></code> for further information and illustrative examples of suitable polytomous item banks.
</p>
<p>The output is a vector with character values <code>"Group1"</code> for the first startum, <code>"Group2"</code> for the second stratum etc. It has the same length as the number of items in the <code>itemBank</code> matrix and permits one-to-one identification of the items in each stratum.
</p>


<h3>Value</h3>

<p>A vector with as many components as the number of items in the bank, with values <code>Group1</code> to <code>GroupG</code> where <code>G</code> is the number of strata (i.e. either <code>K</code>) or the length of vector <code>K</code>).</p>


<h3>Author(s)</h3>

<p>David Magis <br />
Department of Psychology, University of Liege, Belgium <br />
<a href="mailto:david.magis@uliege.be">david.magis@uliege.be</a>
</p>


<h3>References</h3>

<p>Barton, M.A., and Lord, F.M. (1981). <em>An upper asymptote for the three-parameter logistic item-response model</em>. Research Bulletin 81-20. Princeton, NJ: Educational Testing Service.
</p>
<p>Chang, H.-H., and Ying, Z. (1999). A-stratified multistage computerized adaptive testing. <em>Applied Psychological Measurement, 23</em>, 211-222. doi: <a href="https://doi.org/10.1177/01466219922031338">10.1177/01466219922031338</a>
</p>
<p>Magis, D. and Barrada, J. R. (2017). Computerized Adaptive Testing with R: Recent Updates of the Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>Code Snippets</em>, <em>76(1)</em>, 1-18. doi: <a href="https://doi.org/10.18637/jss.v076.c01">10.18637/jss.v076.c01</a>
</p>
<p>Magis, D., and Raiche, G. (2012). Random Generation of Response Patterns under Computerized Adaptive Testing with the R Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>48 (8)</em>, 1-31. doi: <a href="https://doi.org/10.18637/jss.v048.i08">10.18637/jss.v048.i08</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+genPolyMatrix">genPolyMatrix</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Dichotomous models ##

 # Loading the 'tcals' parameters 
 data(tcals)

 # Selecting item parameters only
 tcals &lt;- as.matrix(tcals[,1:4])

 # Creation of five strata with equal length (17 items each)
 aStratified(tcals, 5)

 # Creation of four strata with prespecified lengths 
 res &lt;- aStratified(tcals, K = c(20, 25, 10, 30))
 table(res) # as expected


## Polytomous models ##

 # GRM with 100 items
 mat &lt;- genPolyMatrix(100, 4, model = "GRM")

 # Creation of four strata with equal length (25 items each)
 aStratified(mat, 5, model = "GRM")
 </code></pre>

<hr>
<h2 id='breakBank'>Breaking the item bank in item parameters and group membership (for content balancing)</h2><span id='topic+breakBank'></span>

<h3>Description</h3>

<p>This command &quot;breaks&quot; the item bank in two parts, the item parameters as a numeric matrix, and the group membership of the items as a vector of factor levels. These two elements can be used separately for content balancing purposes, among others.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>breakBank(itemBank)
 </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="breakBank_+3A_itembank">itemBank</code></td>
<td>
<p>a matrix or data frame with item parameters in the first columns and group membership in the last column.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>breakBank</code> function is useful to split the original item bank in two parts, one holding the item parameters only, and one containing the names of item group membership. The former can then directly be plugged in adequate functions such as <code><a href="#topic+thetaEst">thetaEst</a></code>.
</p>
<p>The function works with both dichotomous and polytomous IRT item banks. In both cases, the group membership must be located as the last column of the matrix or data frame.  
</p>
<p>Note that there is no check that the input is correct (that is, the group membership is located in the last column), as <code>breakBank</code> is mostly devoted to be used at the early stages of the <code><a href="#topic+randomCAT">randomCAT</a></code> function.
</p>


<h3>Value</h3>

<p>A list with two arguments:
</p>
<table role = "presentation">
<tr><td><code>itemPar</code></td>
<td>
<p>a numeric matrix with the item parameters.</p>
</td></tr>
<tr><td><code>cbGroup</code></td>
<td>
<p>a vector with factor names of item membership, with one name per item in <code>itemPar</code> element of the output list.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>David Magis <br />
Department of Psychology, University of Liege, Belgium <br />
<a href="mailto:david.magis@uliege.be">david.magis@uliege.be</a>
</p>


<h3>References</h3>

<p>Magis, D. and Barrada, J. R. (2017). Computerized Adaptive Testing with R: Recent Updates of the Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>Code Snippets</em>, <em>76(1)</em>, 1-18. doi: <a href="https://doi.org/10.18637/jss.v076.c01">10.18637/jss.v076.c01</a>
</p>
<p>Magis, D., and Raiche, G. (2012). Random Generation of Response Patterns under Computerized Adaptive Testing with the R Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>48 (8)</em>, 1-31. doi: <a href="https://doi.org/10.18637/jss.v048.i08">10.18637/jss.v048.i08</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+randomCAT">randomCAT</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Dichotomous models ##

 # Loading the 'tcals' parameters 
 data(tcals)

 # Breaking 'tcals'
 breakBank(tcals)


## Polytomous models ##

 # Creation of the 'cbList' list with arbitrary proportions
 cbList &lt;- list(names =c ("Audio1", "Audio2", "Written1", "Written2",
        "Written3"), props = c(0.1, 0.2, 0.2, 0.2, 0.3))

 # NRM with 100 items
 mat &lt;- genPolyMatrix(100, 4, model = "NRM", cbControl = cbList)

 # Breaking 'mat'
 breakBank(mat)
 </code></pre>

<hr>
<h2 id='cat_pav'>Items parameters of the CAT_PAV data set (with item names)</h2><span id='topic+cat_pav'></span>

<h3>Description</h3>

<p>The CAT-PAV questionnaire (D.O. Santos, 2017) was developed to propose a computer-adaptive assessment of productive and contextualized academic English vocabulary, piloted with students at Iowa State University (USA). Items are presented as two sentences drawn from the academic subset of the COCA corpus, with one common missing word to be identified by test takers. In case of an incorrect first answer, synonyms are exhibited as a hint. Th item is scored 2 if a correct answer was provided from first attempt, 1 if a correct answer was provided after the hint being shown, and 0 in case of an incorrect answer after the hint was shown.
</p>


<h3>Format</h3>

<p>A matrix with 96 rows and three columns, respectively holding the discrimination, first threshold and second threshold under a GPCM calibration of the items of CAT-PAV study. Item names are available as row names, each item name corresponding to the word being tested by the item.
</p>


<h3>Source</h3>

<p>The original items of CAT-PAV were developed by D.O. Santos (2017), field tested at Iowa State University and calibrated using the Jmetrik software (Meyer, 2015).
</p>


<h3>References</h3>

<p>Meyer, P. (2015). <em>Jmetrik (version 4.0.3)</em> [Computer software]. Psychomeasurement Systems, LLC.
</p>
<p>D.O. Santos, V. (2017). <em>A computer-adaptive test of of productive and contextualized academic vocabulary breadth in English (CAT-PAV): Development and validation</em>. Graduate Theses and Dissertations, 16292. Ames, IA: Iowa State University. http://lib.dr.iastate.edu/etd/16292
</p>

<hr>
<h2 id='checkStopRule'>Checking whether the stopping rule is satisfied</h2><span id='topic+checkStopRule'></span>

<h3>Description</h3>

<p>This command tests whether one of the specified stopping rules is satisfied in order to stop the CAT.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>checkStopRule(th, se, N, it = NULL, model = NULL, D = 1, stop)
 </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="checkStopRule_+3A_th">th</code></td>
<td>
<p>numeric: the current ability estimate.</p>
</td></tr>
<tr><td><code id="checkStopRule_+3A_se">se</code></td>
<td>
<p>numeric: the current standard error estimate.</p>
</td></tr>
<tr><td><code id="checkStopRule_+3A_n">N</code></td>
<td>
<p>numeric: the current number of administered items.</p>
</td></tr>
<tr><td><code id="checkStopRule_+3A_it">it</code></td>
<td>
<p>the matrix of parameters of currently available items (default is <code>NULL</code>). Ignored if element <code>$rule</code> of <code>stop</code> list does not hold the value <code>"minInfo"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="checkStopRule_+3A_model">model</code></td>
<td>
<p>either <code>NULL</code> (default) for dichotomous models, or any suitable acronym for polytomous models. Possible values are <code>"GRM"</code>, <code>"MGRM"</code>, <code>"PCM"</code>, <code>"GPCM"</code>, <code>"RSM"</code> and <code>"NRM"</code>. Ignored if element <code>$rule</code> of <code>stop</code> list does not hold the value <code>"minInfo"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="checkStopRule_+3A_d">D</code></td>
<td>
<p>numeric: the metric constant. Default is <code>D=1</code> (for logistic metric); <code>D=1.702</code> yields approximately the normal metric (Haley, 1952). Ignored if <code>model</code> is not <code>NULL</code> or if element <code>$rule</code> of <code>stop</code> list does not hold the value <code>"minInfo"</code>. </p>
</td></tr> 
<tr><td><code id="checkStopRule_+3A_stop">stop</code></td>
<td>
<p>a list with valuable element names and contents to set the stopping rule, as an input of the <code>randomCAT</code> or <code>simulateRespondents</code> functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>checkStopRule</code> function checks whether at least one of the stopping rules was satisfied at the current step of the CAT test process. It mainly serves as an internal application for<code><a href="#topic+randomCAT">randomCAT</a></code> function. 
</p>
<p>The <code>stop</code> list must be supplied accordingly to the requested list in the <code>randomCAT()</code> and in the <code>simulateRespondents()</code> functions.
</p>
<p>Three input values must be supplied: <code>th</code> as the current ability estimate; <code>se</code> as the current standard error value related to <code>th</code> estimate; and <code>N</code> as the current test length (i.e., number of administered items). In addition, if the <code>stop$rule</code> vector holds the option <code>"minInfo"</code>, three additional input value smust be supplied: <code>it</code> with the item parameters or all available items in the bank (i.e., previously administered items should not be set as input); <code>model</code> to specify the type of IRT model, either dichotomous or polytomous (see <code><a href="#topic+Pi">Pi</a></code> fir further details); and possibly the scaling constant <code>D</code> set to one by default.
</p>
<p>All stopping rules are being assessed and if at least one of them is satisfied, the output list will hold the vector of rules's nmaes that were satisfied through the <code>rule</code> argument). If none of the stopping rules were satisfied, this <code>rule</code> output argument is simply <code>NULL</code>. 
</p>


<h3>Value</h3>

<p>A list with two arguments:
</p>
<table role = "presentation">
<tr><td><code>decision</code></td>
<td>
<p>a logical value indicating whether at least one of the stopping rules was satisfied (<code>TRUE</code>) or not (<code>FALSE</code>).</p>
</td></tr>
<tr><td><code>rule</code></td>
<td>
<p>either a vector with the names of the stopping rules that were satisfied, or <code>NULL</code> if <code>decision</code> is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>David Magis <br />
Department of Psychology, University of Liege, Belgium <br />
<a href="mailto:david.magis@uliege.be">david.magis@uliege.be</a>
</p>


<h3>References</h3>

<p>Haley, D.C. (1952). <em>Estimation of the dosage mortality relationship when the dose is subject to error</em>. Technical report no 15. Palo Alto, CA: Applied Mathematics and Statistics Laboratory, Stanford University. 
</p>
<p>Magis, D. and Barrada, J. R. (2017). Computerized Adaptive Testing with R: Recent Updates of the Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>Code Snippets</em>, <em>76(1)</em>, 1-18. doi: <a href="https://doi.org/10.18637/jss.v076.c01">10.18637/jss.v076.c01</a>
</p>
<p>Magis, D., and Raiche, G. (2012). Random Generation of Response Patterns under Computerized Adaptive Testing with the R Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>48 (8)</em>, 1-31. doi: <a href="https://doi.org/10.18637/jss.v048.i08">10.18637/jss.v048.i08</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+randomCAT">randomCAT</a></code>, <code><a href="#topic+simulateRespondents">simulateRespondents</a></code>, <code><a href="#topic+Pi">Pi</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Creation of a 'stop' list with two possible rules
 stop &lt;- list(rule = c("length", "precision"), thr = c(20, 0.3))

# Example of successful 'length' rule
 checkStopRule(th = 0.35, se = 0.41, N = 20, stop = stop)

# Example of successful 'precision' rule
 checkStopRule(th = 0.35, se = 0.29, N = 15, stop = stop)

# Example of jointly successful 'length' and 'precision' rules
 checkStopRule(th = 0.35, se = 0.29, N = 20, stop = stop)

# Example without sucessfull rule
 checkStopRule(th = 0.35, se = 0.31, N = 18, stop = stop) 

# Creation of a short bank of available items under 2PL
 it &lt;- genDichoMatrix(items = 5, model = "2PL", seed = 1)

# Computation of maximum information at ability level 0.35
maxI &lt;- max(Ii(0.35, it)$Ii)

# Creation of a 'stop' list with four possible rules and too large threshold for 'minInfo'
 stop &lt;- list(rule = c("length", "precision", "classification", "minInfo"), 
              thr = c(20, 0.3, 1, maxI-0.01), alpha = 0.05)

# Example with sucessfull 'classification' rule only
 checkStopRule(th = 0.35, se = 0.31, N = 18, it = it, stop = stop) 

# Creation of a 'stop' list with four possible rules and too large threshold for 'minInfo'
 stop &lt;- list(rule = c("length", "precision", "classification", "minInfo"), 
              thr = c(20, 0.3, 1, maxI+0.01), alpha = 0.05)

# Example with sucessfull 'minInfo' rule only
 checkStopRule(th = 0.35, se = 0.55, N = 18, it = it, stop = stop) 

</code></pre>

<hr>
<h2 id='eapEst'>EAP ability estimation (dichotomous and polytomous IRT models)</h2><span id='topic+eapEst'></span>

<h3>Description</h3>

<p>This command returns the EAP (expected a posteriori) ability estimate for a given response pattern and a given matrix of item parameters, either under the 4PL model or any suitable polytomous IRT model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eapEst(it, x, model = NULL, D = 1, priorDist = "norm", priorPar = c(0, 1), 
 	lower = -4, upper = 4, nqp = 33)
 </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eapEst_+3A_it">it</code></td>
<td>
<p>numeric: a suitable matrix of item parameters. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="eapEst_+3A_x">x</code></td>
<td>
<p>numeric: a vector of item responses.</p>
</td></tr>
<tr><td><code id="eapEst_+3A_model">model</code></td>
<td>
<p>either <code>NULL</code> (default) for dichotomous models, or any suitable acronym for polytomous models. Possible values are <code>"GRM"</code>, <code>"MGRM"</code>, <code>"PCM"</code>, <code>"GPCM"</code>, <code>"RSM"</code> and <code>"NRM"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="eapEst_+3A_d">D</code></td>
<td>
<p>numeric: the metric constant. Default is <code>D=1</code> (for logistic metric); <code>D=1.702</code> yields approximately the normal metric (Haley, 1952). Ignored if <code>model</code> is not <code>NULL</code>.</p>
</td></tr> 
<tr><td><code id="eapEst_+3A_priordist">priorDist</code></td>
<td>
<p>character: specifies the prior distribution. Possible values are <code>"norm"</code> (default), <code>"unif"</code> and <code>"Jeffreys"</code>.</p>
</td></tr>
<tr><td><code id="eapEst_+3A_priorpar">priorPar</code></td>
<td>
<p>numeric: vector of two components specifying the prior parameters (default is <code>c(0,1)</code>). Ignored if <code>priorDist="Jeffreys"</code>.
See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="eapEst_+3A_lower">lower</code></td>
<td>
<p>numeric: the lower bound for numercal integration (default is -4).</p>
</td></tr>
<tr><td><code id="eapEst_+3A_upper">upper</code></td>
<td>
<p>numeric: the upper bound for numercal integration (default is 4).</p>
</td></tr>
<tr><td><code id="eapEst_+3A_nqp">nqp</code></td>
<td>
<p>numeric: the number of quadrature points (default is 33).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The EAP (expected a posteriori) ability estimator (Bock and Mislevy, 1982) is obtained by computing the average of the posterior distribution of ability, the latter being set as the prior distribution times the likelihood function. 
</p>
<p>Dichotomous IRT models are considered whenever <code>model</code> is set to <code>NULL</code> (default value). In this case, <code>it</code> must be a matrix with one row per item and four columns, with the values of the discrimination, the difficulty, the pseudo-guessing and the inattention parameters (in this order). These are the parameters of the four-parameter logistic (4PL) model
(Barton and Lord, 1981). 
</p>
<p>Polytomous IRT models are specified by their respective acronym: <code>"GRM"</code> for Graded Response Model, <code>"MGRM"</code> for Modified Graded Response Model, <code>"PCM"</code> for Partical Credit Model, <code>"GPCM"</code> for Generalized Partial Credit Model, <code>"RSM"</code> for Rating Scale Model and <code>"NRM"</code> for Nominal Response Model. The <code>it</code> still holds one row per item, end the number of columns and their content depends on the model. See <code><a href="#topic+genPolyMatrix">genPolyMatrix</a></code> for further information and illustrative examples of suitable polytomous item banks.
</p>
<p>Three prior distributions are available: the normal distribution, the uniform distribution and Jeffreys' prior distribution (Jeffreys, 1939, 1946).
The prior distribution is specified by the argument <code>priorPar</code>, with values <code>"norm"</code>, <code>"unif"</code> and <code>"Jeffreys"</code>, respectively. 
</p>
<p>The argument <code>priorPar</code> determines either the prior mean and standard deviation of the normal prior distribution (if 
<code>priorDist="norm"</code>), or the range for defining the prior uniform distribution (if <code>priorDist="unif"</code>). This argument is ignored if <code>priorDist="Jeffreys"</code>.
</p>
<p>The required integrals are approximated by numerical adaptive quadrature. This is achieved by using the <code><a href="#topic+integrate.catR">integrate.catR</a></code> function. Arguments <code>lower</code>, <code>upper</code> and <code>nqp</code> define respectively the lower and upper bounds for numerical integration, and the number 
of quadrature points. By default, the numerical integration runs with 33 quadrature points on the range [-4; 4], that is, a sequence of values from -4 to 4 by steps of 0.25.
</p>


<h3>Value</h3>

<p>The estimated EAP ability level.
</p>


<h3>Author(s)</h3>

<p>David Magis <br />
Department of Psychology, University of Liege, Belgium <br />
<a href="mailto:david.magis@uliege.be">david.magis@uliege.be</a>
</p>


<h3>References</h3>

<p>Barton, M.A., and Lord, F.M. (1981). <em>An upper asymptote for the three-parameter logistic item-response model</em>. Research Bulletin 81-20. Princeton, NJ: Educational Testing Service.
</p>
<p>Bock, R. D., and Mislevy, R. J. (1982). Adaptive EAP estimation of ability in a microcomputer environment. <em>Applied Psychological Measurement, 6</em>, 431-444. doi: <a href="https://doi.org/10.1177/014662168200600405">10.1177/014662168200600405</a>
</p>
<p>Haley, D.C. (1952). <em>Estimation of the dosage mortality relationship when the dose is subject to error</em>. Technical report no 15. Palo Alto, CA: Applied Mathematics and Statistics Laboratory, Stanford University. 
</p>
<p>Jeffreys, H. (1939). <em>Theory of probability</em>. Oxford, UK: Oxford University Press.
</p>
<p>Jeffreys, H. (1946). An invariant form for the prior probability in estimation problems. <em>Proceedings of the Royal Society of London. Series A, Mathematical and Physical Sciences, 186</em>, 453-461.
</p>
<p>Magis, D. and Barrada, J. R. (2017). Computerized Adaptive Testing with R: Recent Updates of the Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>Code Snippets</em>, <em>76(1)</em>, 1-18. doi: <a href="https://doi.org/10.18637/jss.v076.c01">10.18637/jss.v076.c01</a>
</p>
<p>Magis, D., and Raiche, G. (2012). Random Generation of Response Patterns under Computerized Adaptive Testing with the R Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>48 (8)</em>, 1-31. doi: <a href="https://doi.org/10.18637/jss.v048.i08">10.18637/jss.v048.i08</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+thetaEst">thetaEst</a></code>, <code><a href="#topic+genPolyMatrix">genPolyMatrix</a></code>, <code><a href="#topic+integrate.catR">integrate.catR</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Dichotomous models ##

 # Loading the 'tcals' parameters 
 data(tcals)

 # Selecting item parameters only
 tcals &lt;- as.matrix(tcals[,1:4])
 
 # Creation of a response pattern (tcals item parameters,
 # true ability level 0)
 set.seed(1)
 x &lt;- genPattern(0, tcals)

 # EAP estimation, standard normal prior distribution
 eapEst(tcals, x)

 # EAP estimation, uniform prior distribution upon range [-2,2]
 eapEst(tcals, x, priorDist = "unif", priorPar = c(-2, 2))

 # EAP estimation, Jeffreys' prior distribution  
 eapEst(tcals, x, priorDist = "Jeffreys")

 # Changing the integration settings
 eapEst(tcals, x, nqp = 100)


## Polytomous models ##

 # Generation of an item bank under GRM with 100 items and at most 4 categories
 m.GRM &lt;- genPolyMatrix(100, 4, "GRM")
 m.GRM &lt;- as.matrix(m.GRM)

 # Creation of a response pattern (true ability level 0)
 set.seed(1)
 x &lt;- genPattern(0, m.GRM, model = "GRM")

 # EAP estimation, standard normal prior distribution
 eapEst(m.GRM, x, model = "GRM")

 # EAP estimation, uniform prior distribution upon range [-2,2]
 eapEst(m.GRM, x, model = "GRM", priorDist = "unif", priorPar = c(-2, 2))

 # EAP estimation, Jeffreys' prior distribution  
 eapEst(m.GRM, x, model = "GRM", priorDist = "Jeffreys")


 # Loading the cat_pav data
 data(cat_pav)
 cat_pav &lt;- as.matrix(cat_pav)

 # Creation of a response pattern (true ability level 0)
 set.seed(1)
 x &lt;- genPattern(0, cat_pav, model = "GPCM")

 # EAP estimation, standard normal prior distribution
 eapEst(cat_pav, x, model = "GPCM")

 # EAP estimation, uniform prior distribution upon range [-2,2]
 eapEst(cat_pav, x, model = "GPCM", priorDist = "unif", priorPar = c(-2, 2))

 # EAP estimation, Jeffreys' prior distribution  
 eapEst(cat_pav, x, model = "GPCM", priorDist = "Jeffreys")
 </code></pre>

<hr>
<h2 id='eapSem'>Standard error of EAP ability estimation (dichotomous and polytomous IRT models)</h2><span id='topic+eapSem'></span>

<h3>Description</h3>

<p>This command returns the estimated standard error of the ability estimate, for a given response pattern and a given matrix of item parameters, either under the 4PL model or any suitable polytomous IRT model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eapSem(thEst, it, x, model = NULL, D = 1, priorDist = "norm", 
 	priorPar = c(0, 1), lower = -4, upper = 4, nqp = 33)
 </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eapSem_+3A_thest">thEst</code></td>
<td>
<p>numeric: the EAP ability estimate.</p>
</td></tr>
<tr><td><code id="eapSem_+3A_it">it</code></td>
<td>
<p>numeric: a suitable matrix of item parameters. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="eapSem_+3A_x">x</code></td>
<td>
<p>numeric: a vector of item responses.</p>
</td></tr>
<tr><td><code id="eapSem_+3A_model">model</code></td>
<td>
<p>either <code>NULL</code> (default) for dichotomous models, or any suitable acronym for polytomous models. Possible values are <code>"GRM"</code>, <code>"MGRM"</code>, <code>"PCM"</code>, <code>"GPCM"</code>, <code>"RSM"</code> and <code>"NRM"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="eapSem_+3A_d">D</code></td>
<td>
<p>numeric: the metric constant. Default is <code>D=1</code> (for logistic metric); <code>D=1.702</code> yields approximately the normal metric (Haley, 1952). Ignored if <code>model</code> is not <code>NULL</code>.</p>
</td></tr> 
<tr><td><code id="eapSem_+3A_priordist">priorDist</code></td>
<td>
<p>character: specifies the prior distribution. Possible values are <code>"norm"</code> (default), <code>"unif"</code> and <code>"Jeffreys"</code>.</p>
</td></tr>
<tr><td><code id="eapSem_+3A_priorpar">priorPar</code></td>
<td>
<p>numeric: vector of two components specifying the prior parameters (default is <code>c(0,1)</code>). Ignored if <code>priorDist="Jeffreys"</code>.
See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="eapSem_+3A_lower">lower</code></td>
<td>
<p>numeric: the lower bound for numercal integration (default is -4).</p>
</td></tr>
<tr><td><code id="eapSem_+3A_upper">upper</code></td>
<td>
<p>numeric: the upper bound for numercal integration (default is 4).</p>
</td></tr>
<tr><td><code id="eapSem_+3A_nqp">nqp</code></td>
<td>
<p>numeric: the number of quadrature points (default is 33).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This command computes the standard error of the EAP (expected a posteriori) ability estimator (Bock and Mislevy, 1982).
</p>
<p>Dichotomous IRT models are considered whenever <code>model</code> is set to <code>NULL</code> (default value). In this case, <code>it</code> must be a matrix with one row per item and four columns, with the values of the discrimination, the difficulty, the pseudo-guessing and the inattention parameters (in this order). These are the parameters of the four-parameter logistic (4PL) model
(Barton and Lord, 1981). 
</p>
<p>Polytomous IRT models are specified by their respective acronym: <code>"GRM"</code> for Graded Response Model, <code>"MGRM"</code> for Modified Graded Response Model, <code>"PCM"</code> for Partical Credit Model, <code>"GPCM"</code> for Generalized Partial Credit Model, <code>"RSM"</code> for Rating Scale Model and <code>"NRM"</code> for Nominal Response Model. The <code>it</code> still holds one row per item, end the number of columns and their content depends on the model. See <code><a href="#topic+genPolyMatrix">genPolyMatrix</a></code> for further information and illustrative examples of suitable polytomous item banks.
</p>
<p>Three prior distributions are available: the normal distribution, the uniform distribution and Jeffreys' prior distribution (Jeffreys, 1939, 1946).
The prior distribution is specified by the argument <code>priorPar</code>, with values <code>"norm"</code>, <code>"unif"</code> and <code>"Jeffreys"</code>, respectively. 
</p>
<p>The argument <code>priorPar</code> determines either the prior mean and standard deviation of the normal prior distribution (if 
<code>priorDist="norm"</code>), or the range for defining the prior uniform distribution (if <code>priorDist="unif"</code>). This argument is ignored if <code>priorDist="Jeffreys"</code>.
</p>
<p>The required integrals are approximated by numerical adaptive quadrature. This is achieved by using the <code><a href="#topic+integrate.catR">integrate.catR</a></code> function. Arguments <code>lower</code>, <code>upper</code> and <code>nqp</code> define respectively the lower and upper bounds for numerical integration, and the number
of quadrature points. By default, the numerical integration runs with 33 quadrature points on the range [-4; 4], that is, a sequence of values from -4 to 4 by steps of 0.25.
</p>
<p>Note that in the current version, the EAP ability estimate must be specified through the <code>thEst</code> argument.
</p>


<h3>Value</h3>

<p>The estimated standard error of the EAP ability level.
</p>


<h3>Author(s)</h3>

<p>David Magis <br />
Department of Psychology, University of Liege, Belgium <br />
<a href="mailto:david.magis@uliege.be">david.magis@uliege.be</a>
</p>


<h3>References</h3>

<p>Barton, M.A., and Lord, F.M. (1981). <em>An upper asymptote for the three-parameter logistic item-response model</em>. Research Bulletin 81-20. Princeton, NJ: Educational Testing Service.
</p>
<p>Bock, R. D., and Mislevy, R. J. (1982). Adaptive EAP estimation of ability in a microcomputer environment. <em>Applied Psychological Measurement, 6</em>, 431-444. doi: <a href="https://doi.org/10.1177/014662168200600405">10.1177/014662168200600405</a>
</p>
<p>Haley, D.C. (1952). <em>Estimation of the dosage mortality relationship when the dose is subject to error</em>. Technical report no 15. Palo Alto, CA: Applied Mathematics and Statistics Laboratory, Stanford University. 
</p>
<p>Jeffreys, H. (1939). <em>Theory of probability</em>. Oxford, UK: Oxford University Press.
</p>
<p>Jeffreys, H. (1946). An invariant form for the prior probability in estimation problems. <em>Proceedings of the Royal Society of London. Series A, Mathematical and Physical Sciences, 186</em>, 453-461.
</p>
<p>Magis, D. and Barrada, J. R. (2017). Computerized Adaptive Testing with R: Recent Updates of the Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>Code Snippets</em>, <em>76(1)</em>, 1-18. doi: <a href="https://doi.org/10.18637/jss.v076.c01">10.18637/jss.v076.c01</a>
</p>
<p>Magis, D., and Raiche, G. (2012). Random Generation of Response Patterns under Computerized Adaptive Testing with the R Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>48 (8)</em>, 1-31. doi: <a href="https://doi.org/10.18637/jss.v048.i08">10.18637/jss.v048.i08</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+thetaEst">thetaEst</a></code>, <code><a href="#topic+genPolyMatrix">genPolyMatrix</a></code>, <code><a href="#topic+integrate.catR">integrate.catR</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Dichotomous models ##

 # Loading the 'tcals' parameters 
 data(tcals)

 # Selecting item parameters only
 tcals &lt;- as.matrix(tcals[,1:4])

 # Creation of a response pattern (tcals item parameters,
 # true ability level 0)
 set.seed(1)
 x &lt;- genPattern(0, tcals)

 # EAP estimation, standard normal prior distribution
 th &lt;- eapEst(tcals, x)
 c(th, eapSem(th, tcals, x))

 # EAP estimation, uniform prior distribution upon range [-2,2]
 th &lt;- eapEst(tcals, x, priorDist = "unif", priorPar = c(-2, 2))
 c(th, eapSem(th, tcals, x, priorDist = "unif", priorPar=c(-2, 2)))

 # EAP estimation, Jeffreys' prior distribution  
 th &lt;- eapEst(tcals, x, priorDist = "Jeffreys")
 c(th, eapSem(th, tcals, x, priorDist = "Jeffreys"))

## Not run: 

## Polytomous models ##

 # Generation of an item bank under GRM with 100 items and at most 4 categories
 m.GRM &lt;- genPolyMatrix(100, 4, "GRM")
 m.GRM &lt;- as.matrix(m.GRM)

 # Creation of a response pattern (true ability level 0)
 set.seed(1)
 x &lt;- genPattern(0, m.GRM, model = "GRM")

 # EAP estimation, standard normal prior distribution
 th &lt;- eapEst(m.GRM, x, model = "GRM")
 c(th, eapSem(th, m.GRM, x, model = "GRM"))

 # EAP estimation, uniform prior distribution upon range [-2,2]
 th &lt;- eapEst(m.GRM, x, model = "GRM", priorDist = "unif", priorPar = c(-2, 2))
 c(th, eapSem(th, m.GRM, x, model = "GRM", priorDist = "unif", priorPar = c(-2, 2)))

 # EAP estimation, Jeffreys' prior distribution  
 th &lt;- eapEst(m.GRM, x, model = "GRM", priorDist = "Jeffreys")
 c(th, eapSem(th, m.GRM, x, model = "GRM", priorDist = "Jeffreys"))


# Loading the cat_pav data
 data(cat_pav)
 cat_pav &lt;- as.matrix(cat_pav)

 # Creation of a response pattern (true ability level 0)
 set.seed(1)
 x &lt;- genPattern(0, cat_pav, model = "GPCM")

 # EAP estimation, standard normal prior distribution
 th &lt;- eapEst(cat_pav, x, model = "GPCM")
 c(th, eapSem(th, cat_pav, x, model = "GPCM"))

 # EAP estimation, uniform prior distribution upon range [-2,2]
 th &lt;- eapEst(cat_pav, x, model = "GPCM", priorDist = "unif", priorPar = c(-2, 2))
 c(th, eapSem(th, cat_pav, x, model = "GPCM", priorDist = "unif", priorPar = c(-2, 2)))

 # EAP estimation, Jeffreys' prior distribution  
 th &lt;- eapEst(cat_pav, x, model = "GPCM", priorDist = "Jeffreys")
 c(th, eapSem(th, cat_pav, x, model = "GPCM", priorDist = "Jeffreys"))
 
## End(Not run)
</code></pre>

<hr>
<h2 id='EPV'>Expected Posterior Variance (EPV)</h2><span id='topic+EPV'></span>

<h3>Description</h3>

<p>This command returns the expected posterior variance (EPV) for a given item under dichotomous and polytomous IRT models, as used for Minimum Expected Posterior Variance (MEPV) criterion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EPV(itemBank, item, x, theta, it.given, model = NULL, priorDist = "norm", 
 	priorPar = c(0, 1), D = 1, parInt = c(-4, 4, 33))
 </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="EPV_+3A_itembank">itemBank</code></td>
<td>
<p>numeric: a suitable matrix of item parameters. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="EPV_+3A_item">item</code></td>
<td>
<p>numeric: the item (referred to as its rank in the item bank) for which the expected posterior variance must be computed.</p>
</td></tr>
<tr><td><code id="EPV_+3A_x">x</code></td>
<td>
<p>numeric: a vector of item responses, coded as 0 or 1 only (for dichotomous items) or from 0 to the number of response categories minus one (for polytomous items).</p>
</td></tr>
<tr><td><code id="EPV_+3A_theta">theta</code></td>
<td>
<p>numeric: the provisional ability estimate.</p>
</td></tr>
<tr><td><code id="EPV_+3A_it.given">it.given</code></td>
<td>
<p>numeric: a suitable matrix of item parameters for previously administered items. The number of rows of <code>it.given</code> must be equal to the length of <code>x</code>.</p>
</td></tr>
<tr><td><code id="EPV_+3A_model">model</code></td>
<td>
<p>either <code>NULL</code> (default) for dichotomous models, or any suitable acronym for polytomous models. Possible values are <code>"GRM"</code>, <code>"MGRM"</code>, <code>"PCM"</code>, <code>"GPCM"</code>, <code>"RSM"</code> and <code>"NRM"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="EPV_+3A_priordist">priorDist</code></td>
<td>
<p>character: specifies the prior distribution. Possible values are <code>"norm"</code> (default) and <code>"unif"</code>.</p>
</td></tr>
<tr><td><code id="EPV_+3A_priorpar">priorPar</code></td>
<td>
<p>numeric: vector of two components specifying the prior parameters (default is <code>c(0,1)</code>) of the prior ability distribution.</p>
</td></tr>
<tr><td><code id="EPV_+3A_d">D</code></td>
<td>
<p>numeric: the metric constant. Default is <code>D=1</code> (for logistic metric); <code>D=1.702</code> yields approximately the normal metric (Haley, 1952). Ignored if <code>model</code> is not <code>NULL</code>.</p>
</td></tr> 
<tr><td><code id="EPV_+3A_parint">parInt</code></td>
<td>
<p>numeric: vector of three components, defining the sequence of ability values for computing the posterior variance. See <b>Details</b>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The EPV can be used as a rule for selecting the next item in the CAT process (Choi and Swartz, 2009; Owen, 1975; van der Linden, 1998). This command serves as a subroutine for the <code><a href="#topic+nextItem">nextItem</a></code> function.
</p>
<p>Dichotomous IRT models are considered whenever <code>model</code> is set to <code>NULL</code> (default value). In this case, <code>itemBank</code> must be a matrix with one row per item and four columns, with the values of the discrimination, the difficulty, the pseudo-guessing and the inattention parameters (in this order). These are the parameters of the four-parameter logistic (4PL) model (Barton and Lord, 1981). 
</p>
<p>Polytomous IRT models are specified by their respective acronym: <code>"GRM"</code> for Graded Response Model, <code>"MGRM"</code> for Modified Graded Response Model, <code>"PCM"</code> for Partical Credit Model, <code>"GPCM"</code> for Generalized Partial Credit Model, <code>"RSM"</code> for Rating Scale Model and <code>"NRM"</code> for Nominal Response Model. The <code>itemBank</code> still holds one row per item, end the number of columns and their content depends on the model. See <code><a href="#topic+genPolyMatrix">genPolyMatrix</a></code> for further information and illustrative examples of suitable polytomous item banks.
</p>
<p>Under polytomous IRT models, let <em>k</em> be the number of administered items, and set <code class="reqn">x_1, ..., x_k</code> as the provisional response pattern (where each response <code class="reqn">x_l</code> takes values in <code class="reqn">\{0, 1, ..., g_l\}</code>). Set <code class="reqn">\hat{\theta}_k</code> as the provisional ability estimate (with the first <em>k</em> responses) and let <em>j</em> be the item of interest (not previously administered). Set also <code class="reqn">P_{jt}(\theta)</code>
as the probability of answering response category <em>t</em> to item <em>j</em> for a given ability level <code class="reqn">\theta</code> (thus <code class="reqn">t \in \{0, ..., g_j\}</code>). Finally, set <code class="reqn">Var(\theta | x_1, ..., x_k, t)</code> as the posterior variance of <code class="reqn">\theta</code>, given the provisional response pattern (updated by response <code class="reqn">t</code>). Then, the EPV for item <em>j</em> equals
</p>
<p style="text-align: center;"><code class="reqn">EPV_j = \sum_{t=0}^{g_j} P_{jt}(\hat{\theta}_k)\,Var(\theta | x_1, ..., x_k, t)</code>
</p>
<p>.
</p>
<p>In case of dichotomous IRT models, all <code class="reqn">g_l</code> values reduce to 1, so that item responses <code class="reqn">x_l</code> equal either 0 or 1. Set simply <code class="reqn">P_j(\theta)</code> as the probability of answering item <em>j</em> correctly for a given ability level <code class="reqn">\theta</code>, and set <code class="reqn">Q_j(\theta)=1-P_j(\theta)</code>. Finally, set <code class="reqn">Var(\theta | x_1, ..., x_k, 0)</code> and <code class="reqn">Var(\theta | x_1, ..., x_k, 1)</code> as the posterior variances of <code class="reqn">\theta</code>, given the provisional response pattern (updated by response 0 and 1 respectively). Then, the EPV for item <em>j</em> reduces to
</p>
<p style="text-align: center;"><code class="reqn">EPV_j = P_j(\hat{\theta}_k)\,Var(\theta | x_1, ..., x_k, 1) +  Q_j(\hat{\theta}_k)\,Var(\theta | x_1, ..., x_k, 0)</code>
</p>
<p>.
</p>
<p>The posterior variances <code class="reqn">Var(\theta | x_1, ..., x_k, x_j)</code> (where <code class="reqn">x_j</code> takes value 0 or 1 for dichotomous models, and 0, 1, ..., or <code class="reqn">g_j</code> for polytomous models) is computed as the squared standard error of the EAP estimate of ability, using the response pattern <code class="reqn">(x_1, ..., x_k, x_j)</code>. This is done by a joint use of the <code><a href="#topic+eapEst">eapEst</a></code> and <code><a href="#topic+eapSem">eapSem</a></code> functions. 
</p>
<p>The prior distribution is set up by the arguments <code>priorDist</code> and <code>priorPar</code>, with the by-default standard normal distribution. The range of integration is defined by the <code>parInt</code> argument, with by default, the sequence from -4 to 4 and of length 33 (or, by steps of 0.25). See the function
<code><a href="#topic+eapEst">eapEst</a></code> for further details. 
</p>
<p>The provisional response pattern and the related item parameters are provided by the arguments <code>x</code> and <code>it.given</code> respectively. The target item (for which the maximum information computed) is given by its number in the item bank, through the
<code>item</code> argument. 
</p>
<p>Note that the provisional response pattern <code>x</code> can also be set to <code>NULL</code> (which is useful when the number <code>nrItems</code> of starting items is set to zero). In this case, <code>it.given</code> must be a matrix with zero rows, such as e.g., <code>itemBank[NULL,]</code>. 
</p>


<h3>Value</h3>

<p>The expected posterior variance for the selected item.
</p>


<h3>Author(s)</h3>

<p>David Magis <br />
Department of Psychology, University of Liege, Belgium <br />
<a href="mailto:david.magis@uliege.be">david.magis@uliege.be</a>
</p>


<h3>References</h3>

<p>Barton, M.A., and Lord, F.M. (1981). <em>An upper asymptote for the three-parameter logistic item-response model</em>. Research Bulletin 81-20. Princeton, NJ: Educational Testing Service.
</p>
<p>Choi, S. W., and Swartz, R. J. (2009). Comparison of CAT item selection criteria for polytomous items. <em>Applied Psychological Measurement, 32</em>, 419-440. doi: <a href="https://doi.org/10.1177/0146621608327801">10.1177/0146621608327801</a>
</p>
<p>Haley, D.C. (1952). <em>Estimation of the dosage mortality relationship when the dose is subject to error</em>. Technical report no 15. Palo Alto, CA: Applied Mathematics and Statistics Laboratory, Stanford University. 
</p>
<p>Magis, D. and Barrada, J. R. (2017). Computerized Adaptive Testing with R: Recent Updates of the Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>Code Snippets</em>, <em>76(1)</em>, 1-18. doi: <a href="https://doi.org/10.18637/jss.v076.c01">10.18637/jss.v076.c01</a>
</p>
<p>Magis, D., and Raiche, G. (2012). Random Generation of Response Patterns under Computerized Adaptive Testing with the R Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>48 (8)</em>, 1-31. doi: <a href="https://doi.org/10.18637/jss.v048.i08">10.18637/jss.v048.i08</a>
</p>
<p>Owen, R. J. (1975). A Bayesian sequential procedure for quantal response in the context of adaptive mental testing.  <em>Journal of the American Statistical Association, 70</em>, 351-356. doi: <a href="https://doi.org/10.1080/01621459.1975.10479871">10.1080/01621459.1975.10479871</a>
</p>
<p>van der Linden, W. J. (1998). Bayesian item selection criteria for adaptive testing. <em>Psychometrika, 63</em>, 201-216. doi: <a href="https://doi.org/10.1007/BF02294775">10.1007/BF02294775</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+nextItem">nextItem</a></code>, <code><a href="#topic+eapEst">eapEst</a></code>, <code><a href="#topic+eapSem">eapSem</a></code>, <code><a href="#topic+genPolyMatrix">genPolyMatrix</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Dichotomous models ##

 # Loading the 'tcals' parameters 
 data(tcals)

 # Selecting item parameters only
 bank &lt;- as.matrix(tcals[,1:4])
 
 # Selection of two arbitrary items (15 and 20) of the
 # 'tcals' data set
 it.given &lt;- bank[c(15,20),]

 # Creation of a response pattern
 x &lt;- c(0, 1)

 # EPV for item 1, provisional ability level 0
 EPV(bank, 1, x, 0, it.given)

 # With prior standard deviation 2
 EPV(bank, 1, x, 0, it.given, priorPar = c(0,2))


## Polytomous models ##

 # Generation of an item bank under GRM with 100 items and at most 4 categories
 m.GRM &lt;- genPolyMatrix(100, 4, "GRM")
 m.GRM &lt;- as.matrix(m.GRM)

 # Selection of two arbitrary items (15 and 20) 
 it.given &lt;- m.GRM[c(15,20),]

 # Generation of a response pattern (true ability level 0)
 x &lt;- genPattern(0, it.given, model = "GRM")

 # EPV for item 1, provisional ability level 0
 EPV(m.GRM, 1, x, 0, it.given, model = "GRM")

 # With prior standard deviation 2
 EPV(m.GRM, 1, x, 0, it.given, model = "GRM", priorPar = c(0, 2))


 # Loading the cat_pav data
 data(cat_pav)
 cat_pav &lt;- as.matrix(cat_pav)

 # Selection of two arbitrary items (15 and 20) 
 it.given &lt;- cat_pav[c(15, 20),]

 # Generation of a response pattern (true ability level 0)
 x &lt;- genPattern(0, it.given, model = "GPCM")

 # EPV for item 1, provisional ability level 0
 EPV(cat_pav, 1, x, 0, it.given, model = "GPCM")

 # With prior standard deviation 2
 EPV(cat_pav, 1, x, 0, it.given, model = "GPCM", priorPar = c(0, 2))
 </code></pre>

<hr>
<h2 id='fullDist'>Full distribution of ability estimator (dichotomous models only)</h2><span id='topic+fullDist'></span>

<h3>Description</h3>

<p>This command returns the full distribution of the selected ability estimator, that is, the set of all possible ability estimates and related probabilities, for a given matrix of item parameters and ability estimate (or true value).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fullDist(th, it, method = "BM", priorDist = "norm", priorPar = c(0,1), 
 	weight = "Huber", tuCo  = 1, range = c(-4 ,4), parInt = c(-4, 4, 33))
 </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fullDist_+3A_th">th</code></td>
<td>
<p>numeric: the ability estimate of interest (can be a vector of estimates too).</p>
</td></tr>
<tr><td><code id="fullDist_+3A_it">it</code></td>
<td>
<p>numeric: a suitable matrix of item parameters. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="fullDist_+3A_method">method</code></td>
<td>
<p>character: the ability estimator. Possible values are <code>"BM"</code> (default), <code>"ML"</code>, <code>"WL"</code>, <code>"EAP"</code> and <code>"ROB"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="fullDist_+3A_priordist">priorDist</code></td>
<td>
<p>character: specifies the prior distribution. Possible values are <code>"norm"</code> (default), <code>"unif"</code> and <code>"Jeffreys"</code>. Ignored if <code>method</code> is neither <code>"BM"</code> nor <code>"EAP"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="fullDist_+3A_priorpar">priorPar</code></td>
<td>
<p>numeric: vector of two components specifying the prior parameters (default is <code>c(0,1)</code>) of the prior ability distribution. Ignored if <code>method</code> is neither <code>"BM"</code> nor <code>"EAP"</code>, or if <code>priorDist="Jeffreys"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="fullDist_+3A_weight">weight</code></td>
<td>
<p>character: the type of weight function for the robust estimator. Possible values are <code>"Huber"</code> (default) and <code>"Tukey"</code>. Ignored if <code>method</code> is not <code>"ROB"</code> or if <code>model</code> is not <code>NULL</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="fullDist_+3A_tuco">tuCo</code></td>
<td>
<p>numeric: the value of the tuning constant for the weight function (default is 1, suitable with <code>"Huber"</code> weight). Ignored if <code>method</code> is not <code>"ROB"</code> or if <code>model</code> is not <code>NULL</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="fullDist_+3A_range">range</code></td>
<td>
<p>numeric: vector of two components specifying the range wherein the ability estimate must be looked for (default is <code>c(-4,4)</code>). Ignored if <code>method=="EAP"</code>.</p>
</td></tr>
<tr><td><code id="fullDist_+3A_parint">parInt</code></td>
<td>
<p>numeric: vector of three components, holding respectively the values of the arguments <code>lower</code>, <code>upper</code> and <code>nqp</code> of the <code><a href="#topic+eapEst">eapEst</a></code> command. Default vector is (-4, 4, 33). Ignored if <code>method</code> is not <code>"EAP"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The computation of the full distribution of an ability estimator is required to determine the exact standard error of ability, compared to the asympotic SE (ASE) displayed by former versions of the <code><a href="#topic+semTheta">semTheta</a></code> function. This distribution is computed as follows. 
</p>
<p>First, all possible response patterns (for the given test length fixed by the number of items specified by <code>it</code> argument) are generated through the internal <code>dataGen</code> function. Second, ability estimation is performed with each generated pattern, and the corresponding pattern probability is computed using the set of item parameters <code>it</code> and the predefined ability level <code>th</code> of interest. These to components are eventually returned as the full distribution. 
</p>
<p>In case of the Rasch (1PL) model, this long process can be shortened as the total test score is a proxy for ability estimation. Hence, with <code class="reqn">n</code> items, only <code class="reqn">(n+1)</code> patterns must be created, one for each test score from zero to <code class="reqn">n</code>. Related probabilities can be derived using the Lord-Wingersky algorithm (1984) that is implemented internally through the <code>LW()</code> function.
</p>
<p>Dichotomous IRT models are considered whenever <code>model</code> is set to <code>NULL</code> (default value). In this case, <code>it</code> must be a matrix with one row per item and four columns, with the values of the discrimination, the difficulty, the pseudo-guessing and the inattention parameters (in this order). These are the parameters of the four-parameter logistic (4PL) model
(Barton and Lord, 1981). 
</p>
<p>Five ability estimators are available: the maximum likelihood (ML) estimator (Lord, 1980), the Bayes modal (BM) estimator (Birnbaum, 1969), the expected a posteriori (EAP) estimator (Bock and Mislevy, 1982), the weighted likelihood (WL) estimator (Warm, 1989) and the robust estimator (Schuster &amp; Yuan, 2011). The selected estimator is specified by the <code>method</code> argument, with values <code>"ML"</code>, <code>"BM"</code>, <code>"EAP"</code>, <code>"WL"</code> and <code>"ROB"</code> respectively.
</p>
<p>For the BM and EAP estimators, three prior distributions are available: the normal distribution, the uniform distribution and the Jeffreys' prior distribution (Jeffreys, 1939, 1946). The prior distribution is specified by the argument <code>priorPar</code>, with values <code>"norm"</code>, <code>"unif"</code> and <code>"Jeffreys"</code>, respectively. The <code>priorPar</code> argument is ignored if <code>method="ML"</code> or <code>method="WL"</code>.
</p>
<p>The argument <code>priorPar</code> determines either: the prior mean and standard deviation of the normal prior distribution (if <code>priorDist="norm"</code>), or the range for defining the prior uniform distribution (if <code>priorDist="unif"</code>). This argument is ignored if <code>priorDist="Jeffreys"</code>.
</p>
<p>The <code>eapPar</code> argument sets the range and the number of quadrature points for numerical integration in the EAP process. By default, it takes the vector value (-4, 4, 33), that is, 33 quadrature points on the range [-4; 4] (or, by steps of 0.25). See <code><a href="#topic+eapEst">eapEst</a></code> for further details. 
</p>
<p>Robust estimation requires an appropriate weight function that depends on an accurate tuning constant. Suggested functions are the Huber weight (Schuester and Yuan, 2011) and the Tukey weight (Mosteller and Tukey, 1977). Both can be set by the <code>weight</code> argument, with respective values <code>"Huber"</code> and <code>"Tukey"</code>. Default function is Huber. Moreover, the <code>tuCo</code> argument specifies the tuning constant for the weight function. Default value is 1 and suggested for Huber weight (also by default), and value 4 is suggested for Tukey weight (Schuester and Yuan, 2011).
</p>
<p>The ability level of interest (that is, for which the probability distribution must be computed) is specified by the<code>th</code> argument. Note that it can hold a vector of ability levels too; in this case, the probability distribution is computed for each component of <code>th</code>.
</p>


<h3>Value</h3>

<p>A matrix with <code class="reqn">(t+1)</code> columns (where <code class="reqn">t</code> is the length of vector <code>th</code>), the first column holding all observable ability estimates and columns 2 to <code class="reqn">(t+1)</code> with related probabilities of the corresponding components of <code>th</code>.
</p>


<h3>Note</h3>

<p>Under the Rasch (1PL) model, the computation of the full distribution is very efficient even for a large test: due to the Lord-Wingersky algorithm, only <code class="reqn">(n+1)</code> patterns (where <code class="reqn">n</code> is the number of items) must be created, one for each possible test score. But for other models, <code class="reqn">2^n</code> patterns must be generated and used for ability estimation, which can become computationally intensive with long tests. Therefore it is recommended not to make use of this function with more than ten items (except under the Rasch model).
</p>


<h3>Author(s)</h3>

<p>David Magis <br />
Department of Psychology, University of Liege, Belgium <br />
<a href="mailto:david.magis@uliege.be">david.magis@uliege.be</a>
</p>
<p>Lianne Ippel <br />
Department of Psychology, University of Liege, Belgium <br />
<a href="mailto:g.j.e.ippel@gmail.com">g.j.e.ippel@gmail.com</a>
</p>


<h3>References</h3>

<p>Barton, M.A., and Lord, F.M. (1981). <em>An upper asymptote for the three-parameter logistic item-response model</em>.
Research Bulletin 81-20. Princeton, NJ: Educational Testing Service.
</p>
<p>Birnbaum, A. (1969). Statistical theory for logistic mental test models with a prior distribution of ability. <em>Journal of Mathematical Psychology, 6</em>, 258-276. doi: <a href="https://doi.org/10.1016/0022-2496(69)90005-4">10.1016/0022-2496(69)90005-4</a>
</p>
<p>Bock, R. D., and Mislevy, R. J. (1982). Adaptive EAP estimation of ability in a microcomputer environment. <em>Applied Psychological Measurement, 6</em>, 431-444. doi: <a href="https://doi.org/10.1177/014662168200600405">10.1177/014662168200600405</a>
</p>
<p>Haley, D.C. (1952). <em>Estimation of the dosage mortality relationship when the dose is subject to error</em>. 
Technical report no 15. Palo Alto, CA: Applied Mathematics and Statistics Laboratory, Stanford University. 
</p>
<p>Jeffreys, H. (1939). <em>Theory of probability</em>. Oxford, UK: Oxford University Press.
</p>
<p>Jeffreys, H. (1946). An invariant form for the prior probability in estimation problems. <em>Proceedings of the Royal Society of London. Series A, Mathematical and Physical Sciences, 186</em>, 453-461.
</p>
<p>Lord, F.M. (1980). <em>Applications of item response theory to practical testing problems</em>. Hillsdale, NJ: Lawrence Erlbaum.
</p>
<p>Lord, F. M., and Wingersky, M. S. (1984). Comparison of IRT true-score and equipercentile observed-score equatings. <em>Applied Psychological Measurement, 8</em>, 453-461.  doi: <a href="https://doi.org/10.1177/014662168400800409">10.1177/014662168400800409</a>
</p>
<p>Magis, D. and Barrada, J. R. (2017). Computerized Adaptive Testing with R: Recent Updates of the Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>Code Snippets</em>, <em>76(1)</em>, 1-18. doi: <a href="https://doi.org/10.18637/jss.v076.c01">10.18637/jss.v076.c01</a>
</p>
<p>Magis, D., and Raiche, G. (2012). Random Generation of Response Patterns under Computerized Adaptive Testing with the R Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>48 (8)</em>, 1-31. doi: <a href="https://doi.org/10.18637/jss.v048.i08">10.18637/jss.v048.i08</a>
</p>
<p>Mosteller, F., and Tukey, J. (1977). <em>Exploratory data analysis and regression</em>. Reading, MA: Addison-Wesley.
</p>
<p>Schuester, C., and Yuan, K.-H. (2011). Robust estimation of latent ability in item response models. <em>Journal of Educational and Behavioral Statistics, 36</em>, 720)735.doi: <a href="https://doi.org/10.3102/1076998610396890">10.3102/1076998610396890</a>
</p>
<p>Warm, T.A. (1989). Weighted likelihood estimation of ability in item response models. <em>Psychometrika, 54</em>, 427-450. doi: <a href="https://doi.org/10.1007/BF02294627">10.1007/BF02294627</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+semTheta">semTheta</a></code>, <code><a href="#topic+thetaEst">thetaEst</a></code>, 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Dichotomous models ##

 # Generation of ten items under 1PL model
 it &lt;- genDichoMatrix(10, model = "1PL")
 
 # Full distribution of ML estimator for ability level zero
 fullDist(0, it, method = "ML")

 # Idem with BM estimator (probabilities don't change, only estimated abilities)
 fullDist(0, it, method = "BM")

 # Idem with ability level 1 (only probabilities change)
 fullDist(1, it, method = "BM")

 # Distributions with two ability levels 1 and 0.5
 fullDist(c(1, 0.5), it, method = "BM")

 # Generation of ten items under 2PL model
 it2 &lt;- genDichoMatrix(10, model = "2PL")
 
 # Full distribution of ML estimator for ability level zero
 fullDist(0, it2, method = "ML")
 </code></pre>

<hr>
<h2 id='GDI'>Global-discrimination index (GDI) and posterior global-discrimination index (GDIP) for item selection</h2><span id='topic+GDI'></span>

<h3>Description</h3>

<p>This command returns the value of the global-discrimination index (GDI) and posterior global-discrimination index (GDIP) for a given item, an item bank and a set of previously administered items.</p>


<h3>Usage</h3>

<pre><code class='language-R'>GDI(itemBank, item, x, it.given, model = NULL, lower = -4, upper = 4, nqp = 33, 
 	type = "GDI", priorDist="norm", priorPar = c(0, 1), D = 1, X = NULL, 
 	lik = NULL)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GDI_+3A_itembank">itemBank</code></td>
<td>
<p>numeric: a suitable matrix of item parameters. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="GDI_+3A_item">item</code></td>
<td>
<p>numeric: the item (referred to as its rank in the item bank) for which the GDI or GDIP must be computed.</p>
</td></tr>
<tr><td><code id="GDI_+3A_x">x</code></td>
<td>
<p>numeric: a vector of item responses, coded as 0 or 1 only (for dichotomous items) or from 0 to the number of response categories minus one (for polytomous items).</p>
</td></tr>
<tr><td><code id="GDI_+3A_it.given">it.given</code></td>
<td>
<p>numeric: a matrix with one row per item and four columns, with the values of the discrimination, the difficulty, the pseudo-guessing and the inattention parameters (in this order). The number of rows of <code>it</code> must be equal to the length of <code>x</code>.</p>
</td></tr>
<tr><td><code id="GDI_+3A_model">model</code></td>
<td>
<p>now only <code>NULL</code> (default) for dichotomous models is allowed.</p>
</td></tr>
<tr><td><code id="GDI_+3A_lower">lower</code></td>
<td>
<p>numeric: the lower bound for numercal integration (default is -4).</p>
</td></tr>
<tr><td><code id="GDI_+3A_upper">upper</code></td>
<td>
<p>numeric: the upper bound for numercal integration (default is 4).</p>
</td></tr>
<tr><td><code id="GDI_+3A_nqp">nqp</code></td>
<td>
<p>numeric: the number of quadrature points (default is 33).</p>
</td></tr>
<tr><td><code id="GDI_+3A_type">type</code></td>
<td>
<p>character: the type of index to be computed. Possible values are <code>"GDI"</code> (default) and <code>"GDIP"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="GDI_+3A_priordist">priorDist</code></td>
<td>
<p>character: the prior ability distribution. Possible values are <code>"norm"</code> (default) for the normal distribution, and <code>"unif"</code> for the uniform distribution. Ignored if <code>type</code> is <code>"GDI"</code>.</p>
</td></tr>
<tr><td><code id="GDI_+3A_priorpar">priorPar</code></td>
<td>
<p>numeric: a vector of two components with the prior parameters. If <code>priorDist</code> is <code>"norm"</code>, then <code>priorPar</code> contains the mean and the standard deviation of the normal distribution. If <code>priorDist</code> is <code>"unif"</code>, then <code>priorPar</code> contains the bounds of the uniform distribution. The default values are 0 and 1 respectively. Ignored if <code>type</code> is <code>"GDI"</code>.</p>
</td></tr>
<tr><td><code id="GDI_+3A_d">D</code></td>
<td>
<p>numeric: the metric constant. Default is <code>D=1</code> (for logistic metric); <code>D=1.702</code> yields approximately the normal metric (Haley, 1952).</p>
</td></tr> 
<tr><td><code id="GDI_+3A_x">X</code></td>
<td>
<p>either a vector of numeric values or <code>NULL</code> (default). See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="GDI_+3A_lik">lik</code></td>
<td>
<p>either a vector of numeric values or <code>NULL</code> (default). See <b>Details</b>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Global-discrimination index  can be used as a rule for selecting the next item in the CAT process (Kaplan, de la Torre, and Barrada, 2015). This command serves as a subroutine for the <code><a href="#topic+nextItem">nextItem</a></code> function.
</p>
<p>Dichotomous IRT models are considered whenever <code>model</code> is set to <code>NULL</code> (default value). In this case, <code>itemBank</code> must be a matrix with one row per item and four columns, with the values of the discrimination, the difficulty, the pseudo-guessing and the inattention parameters (in this order). These are the parameters of the four-parameter logistic (4PL) model (Barton and Lord, 1981). 
</p>
<p>Currently both GDI and GDIP are not implemented for polytomous IRT models.
</p>
<p>The integrals within GDI and GDIP are approximated by the <code><a href="#topic+integrate.catR">integrate.catR</a></code> function. The range of integration is set up by the arguments <code>lower</code>, <code>upper</code> and <code>nqp</code>, giving respectively the lower bound, the upper bound and the number of quadrature points. The default range goes from -4 to 4 with length 33 (that is, by steps of 0.25).
</p>
<p>To speed up the computation, both the range of integration of values <code class="reqn">\theta</code> and the values of the likelihood function <code class="reqn">L(\theta)</code> can be directly provided to the function through the arguments <code>X</code> and <code>lik</code>. If <code>X</code> is set to <code>NULL</code> (default), the sequence of ability values for integration is determined by the arguments <code>lower</code>, <code>upper</code> and <code>nqp</code> as explained above. If <code>lik</code> is <code>NULL</code> (default), it is also internally computed from an implementation of the likelihood function.
</p>
<p>The provisional response pattern and the related item parameters are provided by the arguments <code>x</code> and <code>it.given</code> respectively. The target item (for which the KL information is computed) is given by its rank number in the item bank, through the <code>item</code> argument. 
</p>
<p>The argument <code>type</code> defines the type of KL information to be computed. The default value, <code>"GDI"</code>, computes the GDI indexinformation, while the posterior GDI index is obtained with <code>type="GDIP"</code>. For the latter, the <code>priorDist</code> and <code>priorPar</code> arguments fix the prior ability distribution. The normal distribution is set up by <code>priorDist="norm"</code> and then, <code>priorPar</code> contains the mean and the standard deviation of the normal distribution. If <code>priorDist</code> is <code>"unif"</code>, then the uniform distribution is considered, and <code>priorPar</code> fixes the lower and upper bounds of that uniform distribution. By default, the standard normal prior distribution is assumed. These arguments are ignored whenever <code>method</code> is <code>"GDI"</code>.
</p>


<h3>Value</h3>

<p>The required GDI or GDIP value for the selected item.
</p>


<h3>Author(s)</h3>

<p>David Magis <br />
Department of Psychology, University of Liege, Belgium <br />
<a href="mailto:david.magis@uliege.be">david.magis@uliege.be</a>
</p>
<p>Juan Ramon Barrada <br />
Department of Psychology and Sociology, Universidad Zaragoza, Spain <br />
<a href="mailto:barrada@unizar.es">barrada@unizar.es</a>
</p>


<h3>References</h3>

<p>Barton, M.A., and Lord, F.M. (1981). <em>An upper asymptote for the three-parameter logistic item-response model</em>.
Research Bulletin 81-20. Princeton, NJ: Educational Testing Service.
</p>
<p>Haley, D.C. (1952). <em>Estimation of the dosage mortality relationship when the dose is subject to error</em>. Technical report no 15. Palo Alto, CA: Applied Mathematics and Statistics Laboratory, Stanford University. 
</p>
<p>Kaplan, M., de la Torre, J., and Barrada, J. R. (2015). New item selection methods for cognitive diagnosis computerized adaptive testing. <em>Applied Psychological Measurement, 39</em>, 167-188. doi: <a href="https://doi.org/10.1177/0146621614554650">10.1177/0146621614554650</a>
</p>
<p>Magis, D. and Barrada, J. R. (2017). Computerized Adaptive Testing with R: Recent Updates of the Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>Code Snippets</em>, <em>76(1)</em>, 1-18. doi: <a href="https://doi.org/10.18637/jss.v076.c01">10.18637/jss.v076.c01</a>
</p>
<p>Magis, D., and Raiche, G. (2012). Random Generation of Response Patterns under Computerized Adaptive Testing with the R Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>48 (8)</em>, 1-31. doi: <a href="https://doi.org/10.18637/jss.v048.i08">10.18637/jss.v048.i08</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+integrate.catR">integrate.catR</a></code>, <code><a href="#topic+nextItem">nextItem</a></code>, <code><a href="#topic+genPolyMatrix">genPolyMatrix</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Dichotomous models ##

 # Loading the 'tcals' parameters 
 data(tcals)

 # Selecting item parameters only
 bank &lt;- as.matrix(tcals[,1:4])
 
 # Selection of two arbitrary items (15 and 20) of the
 # 'tcals' data set
 it.given &lt;- bank[c(15, 20),]

 # Creation of a response pattern
 x &lt;- c(0, 1)

 # GDI for item 1
 GDI(bank, 1, x, it.given)

 # GDIP for item 1
 GDI(bank, 1, x, it.given, type = "GDIP")

 # GDIP for item 1, different integration range
 GDI(bank, 1, x, it.given, type = "GDIP", lower = -2, upper = 2, nqp = 20)

 # GDIP for item 1, uniform prior distribution on the range [-2,2]
 GDI(bank, 1, x, it.given, type = "GDIP", priorDist = "unif", 
    priorPar = c(-2, 2))

 # Computation of likelihood function beforehand
 L &lt;- function(th, r, param) 
  prod(Pi(th, param)$Pi^r * (1 - Pi(th,param)$Pi)^(1 - r))
 xx &lt;- seq(from = -4, to = 4, length = 33)
 y &lt;- sapply(xx, L, x, it.given) 
 GDI(bank, 1, x, it.given, X = xx, lik = y)
 </code></pre>

<hr>
<h2 id='genDichoMatrix'>Item bank generation (dichotomous models)</h2><span id='topic+genDichoMatrix'></span>

<h3>Description</h3>

<p>This command generates an item bank from prespecified parent distributions for use with dichotomous IRT models. Subgroups of items can also be specified for content balancing purposes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>genDichoMatrix(items = 100, cbControl = NULL, model = "4PL", 
  aPrior = c("norm", 1, 0.2), bPrior = c("norm", 0, 1), 
  cPrior = c("unif", 0, 0.25), dPrior = c("unif", 0.75, 1), seed = 1)
 </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="genDichoMatrix_+3A_items">items</code></td>
<td>
<p>integer: the number of items to include in the generated item bank.</p>
</td></tr>
<tr><td><code id="genDichoMatrix_+3A_cbcontrol">cbControl</code></td>
<td>
<p>either a list to define subgroups for content balancing or <code>NULL</code> (default). See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="genDichoMatrix_+3A_model">model</code></td>
<td>
<p>character: the name of the logistic IRT model, with possible values <code>"1PL"</code>, <code>"2PL"</code>, <code>"3PL"</code> or <code>"4PL"</code> (default).</p>
</td></tr>
<tr><td><code id="genDichoMatrix_+3A_aprior">aPrior</code></td>
<td>
<p>vector of three components, specifying the prior distribution and item parameters for generating the item discrimination levels. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="genDichoMatrix_+3A_bprior">bPrior</code></td>
<td>
<p>vector of three components, specifying the prior distribution and item parameters for generating the item difficulty levels. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="genDichoMatrix_+3A_cprior">cPrior</code></td>
<td>
<p>vector of three components, specifying the prior distribution and item parameters for generating the item lower asymptote levels. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="genDichoMatrix_+3A_dprior">dPrior</code></td>
<td>
<p>vector of three components, specifying the prior distribution and item parameters for generating the item upper asymptote levels. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="genDichoMatrix_+3A_seed">seed</code></td>
<td>
<p>numeric: the random seed number for the generation of item parameters (default is 1). See <code><a href="base.html#topic+set.seed">set.seed</a></code> for further details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function permits to generate an item bank under dichotomous IRT models that is compatible for use with <code><a href="#topic+randomCAT">randomCAT</a></code>. 
</p>
<p>The number of items to be included in the bank is specified by the <code>items</code> argument. Corresponding item parameters are drawn from distributions to be specified by arguments <code>aPrior</code>, <code>bPrior</code>, <code>cPrior</code> and <code>dPrior</code> for respective parameters <code class="reqn">a_i</code>, <code class="reqn">b_i</code>, <code class="reqn">c_i</code> and <code class="reqn">d_i</code> (Barton and Lord, 1981). Each of these arguments is of length 3, the first component containing the name of the distribution and the last two components coding the distribution parameters. 
</p>
<p>Possible distributions are:
</p>

<ul>
<li><p>the <em>normal distribution</em> <code class="reqn">N(\mu, \sigma^2)</code>, available for parameters <code class="reqn">a_i</code> and <code class="reqn">b_i</code>. It is specified by <code>"norm"</code> as first argument while the latter two arguments contain the values of <code class="reqn">\mu</code> and <code class="reqn">\sigma</code> respectively.
</p>
</li>
<li><p>the <em>log-normal distribution</em> <code class="reqn">\log N(\mu, \sigma^2)</code>, available for parameter <code class="reqn">a_i</code> only. It is specified by <code>"lnorm"</code> as first argument while the latter two arguments contain the values of <code class="reqn">\mu</code> and <code class="reqn">\sigma</code> respectively.
</p>
</li>
<li><p>the <em>uniform distribution</em> <code class="reqn">U([a,b])</code>, available for all parameters. It is specified by <code>"unif"</code> as first argument while the latter two arguments contain the values of <code class="reqn">a</code> and <code class="reqn">b</code> respectively. Note that taking <code class="reqn">a</code> and <code class="reqn">b</code> equal to a common value, say <code class="reqn">t</code>, makes all parameters to be equal to <code class="reqn">t</code>.
</p>
</li>
<li><p>the <em>Beta distribution</em> <code class="reqn">Beta(\alpha, \beta)</code>, available for parameters <code class="reqn">c_i</code> and <code class="reqn">d_i</code>. It is specified by <code>"beta"</code> as first argument while the latter two arguments contain the values of <code class="reqn">\alpha</code> and <code class="reqn">\beta</code> respectively.
</p>
</li></ul>

<p>Inattention parameters <code class="reqn">d_i</code> are fixed to 1 if <code>model</code> is not <code>"4PL"</code>; pseudo-guessing parameters <code class="reqn">c_i</code> are fixed to zero if <code>model</code> is either <code>"1PL"</code> or <code>"2PL"</code>; and discrimination parameters <code class="reqn">a_i</code> are
fixed to 1 if <code>model="1PL"</code>. The random generation of item parameters can be controlled by the <code>seed</code> argument.
</p>
<p>If required, the distribution of the items across subgroups with specified names can be performed. To do so, the <code>cbControl</code> argument must be supplied with a list of two arguments: (a) the first argument is called <code>$names</code> and contains the different names of the subgroups of items; (b) the second argument is called <code>$props</code> and contains a vector of numeric values, of the same length of <code>names</code> element, with only positive numbers but not necessarily summing to one. For instance, if <code>props</code> is set as <code>c(1, 2, 2)</code> and <code>items</code> to <code>100</code>, then the three subgroups will hold respectively 20, 40 and 40 items.
</p>
<p>Several constraints apply to the arguments of the <code>cbControl</code> list. First, both arguments of <code>cbControl</code> must be of the same length. Second, as already explained, <code>cbControl$props</code> must either sum to 1 (in case of proportions) or to <code>items</code> (in case of integer values). Finally, if proportions are provided to <code>cbControl$props</code>, one can ensure that when multiplied by <code>items</code> they return integer values (so that they can sum up to <code>items</code>).
</p>
<p>The random generation of item parameters and the random allocation of items to subgroups of items are both under control by the <code>seed</code> argument.
</p>
<p>The output is a data frame with at least four arguments, with names <code>a</code>, <code>b</code>, <code>c</code> and <code>d</code> for respectively the discrimination <code class="reqn">a_i</code>, the difficulty <code class="reqn">b_i</code>, the lower asymptote <code class="reqn">c_i</code> and the upper asymptote <code class="reqn">d_i</code> parameters. A fifth argument contains optionally the subgroup names that have been randomly assigned to the generated items, in the proportions specified by the <code>$props</code> argument of the <code>cbControl</code> list. 
</p>


<h3>Value</h3>

<p>A data frame with four or five arguments:
</p>
<table role = "presentation">
<tr><td><code>a</code></td>
<td>
<p>the generated item discrimination parameters.</p>
</td></tr>
<tr><td><code>b</code></td>
<td>
<p>the generated item difficulty parameters.</p>
</td></tr>
<tr><td><code>c</code></td>
<td>
<p>the generated item lower asymptote parameters.</p>
</td></tr>
<tr><td><code>d</code></td>
<td>
<p>the generated item upper asymptote parameters.</p>
</td></tr>
<tr><td><code>Group</code></td>
<td>
<p>(optional) the distribution of subgroup names across items. Ignored if <code>cbControl</code> is <code>NULL</code>.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The current version of <code>genItemBank</code> is only designed for dichotomous IRT models. Future extensions will hopefully provide the same tool for polytomous IRT models.
</p>


<h3>Author(s)</h3>

<p>David Magis <br />
Department of Psychology, University of Liege, Belgium <br />
<a href="mailto:david.magis@uliege.be">david.magis@uliege.be</a>
</p>


<h3>References</h3>

<p>Barton, M.A., and Lord, F.M. (1981). <em>An upper asymptote for the three-parameter logistic item-response model</em>. Research Bulletin 81-20. Princeton, NJ: Educational Testing Service.
</p>
<p>Magis, D. and Barrada, J. R. (2017). Computerized Adaptive Testing with R: Recent Updates of the Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>Code Snippets</em>, <em>76(1)</em>, 1-18. doi: <a href="https://doi.org/10.18637/jss.v076.c01">10.18637/jss.v076.c01</a>
</p>
<p>Magis, D., and Raiche, G. (2012). Random Generation of Response Patterns under Computerized Adaptive Testing with the R Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>48 (8)</em>, 1-31. doi: <a href="https://doi.org/10.18637/jss.v048.i08">10.18637/jss.v048.i08</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+nextItem">nextItem</a></code>, <code><a href="#topic+randomCAT">randomCAT</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 # Item bank generation with 500 items
 genDichoMatrix(items = 500)

 # Item bank generation with 100 items, 2PL model and log-normal distribution with 
 # parameters (0, 0.1225) for discriminations
 genDichoMatrix(items = 100, model = "2PL", aPrior = c("lnorm", 0, 0.1225))

 # A completely identical method as for previous example
 genDichoMatrix(items = 100, aPrior = c("lnorm", 0, 0.1225), 
  cPrior = c("unif", 0, 0), dPrior = c("unif", 1, 1))

 # Item bank generation with prespecified content balancing control options 
 cbList &lt;- list(names = c("Group1", "Group2", "Group3", "Group4"), 
        props = c(0.2,0.4,0.3,0.1))
 genDichoMatrix(items = 100, cbControl = cbList)

 # With proportions that do not sum to one
 cbList &lt;- list(names = c("Group1", "Group2", "Group3", "Group4"), props=c(2, 4, 3, 1))
 genDichoMatrix(items = 100, cbControl = cbList)

 </code></pre>

<hr>
<h2 id='genPattern'>Random generation of item response patterns under dichotomous and polytomous IRT models</h2><span id='topic+genPattern'></span>

<h3>Description</h3>

<p>This command generates item responses patterns for a given matrix of item parameters of any specified dichotomous or polytomous IRT model and a given (set of) ability value(s). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>genPattern(th, it, model = NULL, D = 1, seed = NULL)
 </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="genPattern_+3A_th">th</code></td>
<td>
<p>numeric: a vector of true underlynig ability values (can be a singlre value too).</p>
</td></tr>
<tr><td><code id="genPattern_+3A_it">it</code></td>
<td>
<p>numeric: a suitable matrix of item parameters. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="genPattern_+3A_model">model</code></td>
<td>
<p>either <code>NULL</code> (default) for dichotomous models, or any suitable acronym for polytomous models. Possible values are <code>"GRM"</code>, <code>"MGRM"</code>, <code>"PCM"</code>, <code>"GPCM"</code>, <code>"RSM"</code> and <code>"NRM"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="genPattern_+3A_d">D</code></td>
<td>
<p>numeric: the metric constant. Default is <code>D=1</code> (for logistic metric); <code>D=1.702</code> yields approximately the normal metric (Haley, 1952). Ignored if <code>model</code> is not <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="genPattern_+3A_seed">seed</code></td>
<td>
<p>either the random seed value or <code>NULL</code> (default). See <b>Details</b>.</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>This function permits to randomly generate item responses for a set of given ability levels, specified by the argument <code>thr</code>, and for a given matrix of item parameters, specified by the argument <code>it</code>. Both dichotomous and polytomous IRT models can be considered and item responses are generated accordingly.
</p>
<p>For dichotomous models, item responses are generated from Bernoulli draws, using the <code><a href="stats.html#topic+rbinom">rbinom</a></code> function. For polytomous models they are generated from darws from a multinomial distribution, using the <code><a href="stats.html#topic+rmultinom">rmultinom</a></code> function. In both cases, success probabilities are obtained from the <code><a href="#topic+Pi">Pi</a></code> function.
</p>
<p>Note that for polytomous models, item responses are coded as 0 (for the first response category), 1 (for the second category), ..., until <code class="reqn">g_j</code> (for the last category), in agreement with the notations used in the help files of, e.g., the <code><a href="#topic+genPolyMatrix">genPolyMatrix</a></code> function.
</p>
<p>Dichotomous IRT models are considered whenever <code>model</code> is set to <code>NULL</code> (default value). In this case, <code>it</code> must be a matrix with one row per item and four columns, with the values of the discrimination, the difficulty, the pseudo-guessing and the inattention parameters (in this order). These are the parameters of the four-parameter logistic (4PL) model
(Barton and Lord, 1981). 
</p>
<p>Polytomous IRT models are specified by their respective acronym: <code>"GRM"</code> for Graded Response Model, <code>"MGRM"</code> for Modified Graded Response Model, <code>"PCM"</code> for Partical Credit Model, <code>"GPCM"</code> for Generalized Partial Credit Model, <code>"RSM"</code> for Rating Scale Model and <code>"NRM"</code> for Nominal Response Model. The <code>it</code> still holds one row per item, end the number of columns and their content depends on the model. See <code><a href="#topic+genPolyMatrix">genPolyMatrix</a></code> for further information and illustrative examples of suitable polytomous item banks.
</p>
<p>The random pattern generation can be fixed by setting <code>seed</code> to some numeric value. By default, <code>seed</code> is <code>NULL</code> and the random seed is not fixed.
</p>


<h3>Value</h3>

<p>If <code>th</code> holds a single value, output is a vector with the item responses in the order of appearance of the items in the <code>it</code> matrix. If <code>th</code> is a vector of numeric values, output is a response matrix with one row per <code>th</code> value and one column per item.
</p>


<h3>Author(s)</h3>

<p>David Magis <br />
Department of Psychology, University of Liege, Belgium <br />
<a href="mailto:david.magis@uliege.be">david.magis@uliege.be</a>
</p>


<h3>References</h3>

<p>Barton, M.A., and Lord, F.M. (1981). <em>An upper asymptote for the three-parameter logistic item-response model</em>. Research Bulletin 81-20. Princeton, NJ: Educational Testing Service.
</p>
<p>Haley, D.C. (1952). <em>Estimation of the dosage mortality relationship when the dose is subject to error</em>. Technical report no 15. Palo Alto, CA: Applied Mathematics and Statistics Laboratory, Stanford University.
</p>
<p>Magis, D. and Barrada, J. R. (2017). Computerized Adaptive Testing with R: Recent Updates of the Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>Code Snippets</em>, <em>76(1)</em>, 1-18. doi: <a href="https://doi.org/10.18637/jss.v076.c01">10.18637/jss.v076.c01</a>
</p>
<p>Magis, D., and Raiche, G. (2012). Random Generation of Response Patterns under Computerized Adaptive Testing with the R Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>48 (8)</em>, 1-31. doi: <a href="https://doi.org/10.18637/jss.v048.i08">10.18637/jss.v048.i08</a>
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+rbinom">rbinom</a></code> and <code><a href="stats.html#topic+rmultinom">rmultinom</a></code> for random draws; <code><a href="#topic+genPolyMatrix">genPolyMatrix</a></code>, <code><a href="#topic+Pi">Pi</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Dichotomous models ##
 
 # Loading the 'tcals' parameters 
 data(tcals)

 # Selecting item parameters only
 tcals &lt;- as.matrix(tcals[,1:4])
 
 # Generation of a response pattern for ability level 0
 genPattern(th = 0, tcals)

 # Generation of 10 response patterns for ability levels randomly drawn from N(0,1)
 genPattern(th = rnorm(10), tcals)

 # Generation of a single response for the first item only
 genPattern(th = 0, tcals[1,])

## Polytomous models ##

 # Generation of an item bank under GRM with 100 items and at most 4 categories
 m.GRM &lt;- genPolyMatrix(100, 4, "GRM")
 m.GRM &lt;- as.matrix(m.GRM)

 # Generation of a response pattern for ability level 0
 genPattern(0, m.GRM, model = "GRM")

 # Generation of 10 response patterns for ability levels randomly drawn from N(0,1)
 genPattern(rnorm(10), m.GRM, model = "GRM")

 # Generation of a single response for the first item only
 genPattern(0, m.GRM[1,], model = "GRM")

 # Loading the cat_pav data
 data(cat_pav)
 cat_pav &lt;- as.matrix(cat_pav)

 # Generation of a response pattern for ability level 0
 genPattern(0, cat_pav, model = "GPCM")

 # Generation of a single response for the first item only
 genPattern(0, cat_pav[1,], model = "GPCM")
 </code></pre>

<hr>
<h2 id='genPolyMatrix'>Item bank generation (polytomous models)</h2><span id='topic+genPolyMatrix'></span>

<h3>Description</h3>

<p>This command generates an item bank from prespecified parent distributions for use with polytomous IRT models. Subgroups of items can also be specified for content balancing purposes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>genPolyMatrix(items = 100, nrCat = 3, model = "GRM", seed = 1, same.nrCat = FALSE,
 	cbControl = NULL)
 </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="genPolyMatrix_+3A_items">items</code></td>
<td>
<p>integer: the number of items to generate (default is 100).</p>
</td></tr>
<tr><td><code id="genPolyMatrix_+3A_nrcat">nrCat</code></td>
<td>
<p>integer: the (maximum) number of response categories to generate (default is 3).</p>
</td></tr>
<tr><td><code id="genPolyMatrix_+3A_model">model</code></td>
<td>
<p>character: the type of polytomous IRT model. Possible values are <code>"GRM"</code> (default), <code>"MGRM"</code>, <code>"PCM"</code>, <code>"GPCM"</code> and <code>"NRM"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="genPolyMatrix_+3A_seed">seed</code></td>
<td>
<p>numeric: the random seed for item parameter generation (default is 1).</p>
</td></tr>
<tr><td><code id="genPolyMatrix_+3A_same.nrcat">same.nrCat</code></td>
<td>
<p>logical: should all items have the same number of response categories? (default is <code>FALSE</code>. Ignored if <code>model</code> is either <code>"MGRM"</code> or <code>"RSM"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="genPolyMatrix_+3A_cbcontrol">cbControl</code></td>
<td>
<p>either a list of accurate format to control for content balancing, or <code>NULL</code>. See <b>Details</b>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>genPolyMatrix</code> permits to quickly generate a polytomous item bank in suitable format for further use in e.g. computing item response probabilities with the <code><a href="#topic+Pi">Pi</a></code>. 
</p>
<p>The six polytomous IRT models that are supported are: 
</p>

<ol>
<li><p>the <em>Graded Response Model</em> (GRM; Samejima, 1969);
</p>
</li>
<li><p>the <em>Modified Graded Response Model</em> (MGRM; Muraki, 1990);
</p>
</li>
<li><p>the <em>Partial Credit Model</em> (PCM; Masters, 1982);
</p>
</li>
<li><p>the <em>Generalized Partial Credit Model</em> (GPCM; Muraki, 1992);
</p>
</li>
<li><p>the <em>Rating Scale Model</em> (RSM; Andrich, 1978);
</p>
</li>
<li><p>the <em>Nominal Response Model</em> (NRM; Bock, 1972).
</p>
</li></ol>

<p>Each model is specified through the <code>model</code> argument, with its accronym surrounded by double quotes (i.e. <code>"GRM"</code> for GRM, <code>"PCM"</code> for PCM, etc.). The default value is <code>"GRM"</code>.
</p>
<p>For any item <code class="reqn">j</code>, set <code class="reqn">(0, ..., g_j)</code> as the <code class="reqn">g_j+1</code> possible response categories. The maximum number of response categories can differ across items under the GRM, PCM, GPCM and NRM, but they are obviously equal across items under the MGRM and RSM. In the latter, set <code class="reqn">g</code> as the (same) number of response categories for all items. It is possible however to require all items to have the same number of response categories, by fixing the <code>same.nrCat</code> argument to <code>TRUE</code>.
</p>
<p>In case of GRM, PCM, GPCM or NRM with <code>same.nrCat</code> being <code>FALSE</code>, the number of response categories <code class="reqn">g_j+1</code> per item is drawn from a Poisson distribution with parameter <code>nrCat</code>, and this number is restricted to the interval [2; <code>nrCat</code>]. This ensure at least two response categories and at most <code>nrCat</code> categories. In all other cases, each <code class="reqn">g_j+1</code> is trivially fixed to <code class="reqn">g+1 = </code> <code>nrCat</code>.
</p>
<p>Denote further <code class="reqn">P_{jk}(\theta)</code> as the probability of answering response category <code class="reqn">k \in \{0, ..., g_j\}</code> of item <code class="reqn">j</code>. For GRM and MGRM, response probabilities <code class="reqn">P_{jk}(\theta)</code> are defined through cumulative probabilities, while for PCM, GPCM, RSM and NRM they are directly computed.
</p>
<p>For GRM and MGRM, set <code class="reqn">P_{jk}^*(\theta)</code> as the (cumulative) probability of asnwering response category <code class="reqn">k</code> or &quot;above&quot;, that is <code class="reqn">P_{jk}^*(\theta) = Pr(X_j \geq k | \theta)</code> where <code class="reqn">X_j</code> is the item response. It follows obviously that for any <code class="reqn">\theta</code>, <code class="reqn">P_{j0}^*(\theta) = 1</code> and <code class="reqn">P_{jk}^*(\theta) = 0</code> when <code class="reqn">k&gt;g_j</code>. Furthermore, response category probabilities are found back by the relationship <code class="reqn">P_{jk}(\theta)= P_{jk}^*(\theta)-P_{j,k+1}^*(\theta)</code>. Then, the GRM is defined by (Samejima, 1969)
</p>
<p style="text-align: center;"><code class="reqn">P_{jk}^*(\theta)=\frac{\exp\,[\alpha_j\,(\theta-\beta_{jk})]}{1+\exp\,[\alpha_j\,(\theta-\beta_{jk})]}</code>
</p>
 
<p>and the MGRM by (Muraki, 1990)
</p>
<p style="text-align: center;"><code class="reqn">P_{jk}^*(\theta)=\frac{\exp\,[\alpha_j\,(\theta-b_j+c_k)]}{1+\exp\,[\alpha_j\,(\theta-b_j+c_k)]}.</code>
</p>

<p>The PCM, GPCM, RSM and NRM are defined as &quot;divide-by-total&quot; models (Embretson and Reise, 2000). The PCM has following response category probability (Masters, 1982):
</p>
<p style="text-align: center;"><code class="reqn">P_{jk}(\theta)=\frac{\exp\,\sum_{t=0}^k (\theta-\delta_{jt})}{\sum_{r=0}^{g_j}\,\exp\, \sum_{t=0}^r (\theta-\delta_{jt})}\quad \mbox{with} \quad  \sum_{t=0}^0 (\theta-\delta_{jt})=0.</code>
</p>

<p>The GPCM has following response category probability (Muraki, 1992):
</p>
<p style="text-align: center;"><code class="reqn">P_{jk}(\theta)=\frac{\exp\,\sum_{t=0}^k \alpha_j\,(\theta-\delta_{jt})}{\sum_{r=0}^{g_j}\,\exp\, \sum_{t=0}^r \alpha_j\,(\theta-\delta_{jt})}\quad \mbox{with} \quad  \sum_{t=0}^0 \alpha_j\,(\theta-\delta_{jt})=0.</code>
</p>

<p>The RSM has following response category probability (Andrich, 1978):
</p>
<p style="text-align: center;"><code class="reqn">P_{jk}(\theta)=\frac{\exp\,\sum_{t=0}^k [\theta-(\lambda_j+\delta_t)]}{\sum_{r=0}^{g_j}\,\exp\, \sum_{t=0}^r [\theta-(\lambda_j+\delta_t)]}\quad \mbox{with} \quad  \sum_{t=0}^0 [\theta-(\lambda_j+\delta_t)]=0.</code>
</p>

<p>Finally, the NRM has following response category probability (Bock, 1972):
</p>
<p style="text-align: center;"><code class="reqn">P_{jk}(\theta)=\frac{\exp (\alpha_{jk}\,\theta+c_{jk})}{\sum_{r=0}^{g_j} \exp (\alpha_{jr}\,\theta+c_{jr})}\quad \mbox{with} \quad  \alpha_{j0}\,\theta+c_{j0}=0.</code>
</p>

<p>The following parent distributions are considered to generate the different item parameters. The <code class="reqn">\alpha_j</code> parameters of GRM, MGRM and GPCM, as well as the <code class="reqn">\alpha_{jk}</code> parameters of the NRM, are drawn from a log-normal distribution with mean 0 and standard deviation 0.1225. All other parameters are drawn from a standard normal distribution. Moreover, the <code class="reqn">\beta_{jk}</code> parameters of the GRM and the <code class="reqn">c_k</code> parameters of the MGRM are sorted respectively in increasing and decreasing order of <code class="reqn">k</code>, to ensure decreasing trend in the cumulative <code class="reqn">P_{jk}^*(\theta)</code> probabilities.
</p>
<p>The output is a matrix with one row per item and as many columns as required to hold all item parameters. In case of missing response categories, the corresponding parameters are replaced by <code>NA</code> values. Column names refer to the corresponding model parameters. See <b>Details</b> for further explanations and <b>Examples</b> for illustrative examples.
</p>
<p>Finally, the output matrix can contain an additional vector with the names of the subgroups to be used for content balancing purposes. To do so, the argument <code>cbControl</code> (with default value is <code>NULL</code>) must contain a list of two elements: (a) the <code>names</code> element with the names of the subgroups, and (b) the <code>props</code> elements with proportions of items per subgroup (of the same length of <code>names</code> element, with only positive numbers but not necessarily summing to one). The <code>cbControl</code> argument is similar to the one in <code><a href="#topic+nextItem">nextItem</a></code> and <code><a href="#topic+randomCAT">randomCAT</a></code> functions to control for content balancing. The output matrix contains then an additional column, with the names of the subgroups randomly allocated to each item by using random multinomial draws with the probabilities given by <code>cbControl$props</code>. 
</p>


<h3>Value</h3>

<p>A matrix with <code>items</code> rows and as many columns as required for the considered IRT model: 
</p>

<ul>
<li><p><code class="reqn">\max_j \,g_j+1</code> columns, holding parameters <code class="reqn">(\alpha_j, \beta_{j1}, ..., \beta_{j,g_j})</code> if <code>model</code> is <code>"GRM"</code>;
</p>
</li>
<li><p><code class="reqn">g+2</code> columns, holding parameters <code class="reqn">(\alpha_j, b_j, c_1, ..., c_g)</code> if <code>model</code> is <code>"MGRM"</code>;
</p>
</li>
<li><p><code class="reqn">\max_j \,g_j</code> columns, holding parameters <code class="reqn">(\delta_{j1}, ..., \delta_{j,g_j})</code>  if <code>model</code> is <code>"PCM"</code>;
</p>
</li>
<li><p><code class="reqn">\max_j \,g_j+1</code> columns, holding parameters <code class="reqn">(\alpha_j, \delta_{j1}, ..., \delta_{j,g_j})</code> if <code>model</code> is <code>"GPCM"</code>;
</p>
</li>
<li><p><code class="reqn">g+1</code> columns, holding parameters <code class="reqn">(\lambda_j, \delta_1, ..., \delta_g)</code> if <code>model</code> is <code>"RSM"</code>;
</p>
</li>
<li><p><code class="reqn">2\,\max_j\, g_j</code> columns, holding parameters <code class="reqn">(\alpha_{j1}, c_{j1}, \alpha_{j2}, c_{j2}, ..., \alpha_{j,g_j}, c_{j, g_j})</code> if <code>model</code> is <code>"NRM"</code>.
</p>
</li></ul>

<p>If <code>cbControl</code> is not <code>NULL</code>, the output matrix contains an additional colum for item membership is included.
</p>


<h3>Author(s)</h3>

<p>David Magis <br />
Department of Psychology, University of Liege, Belgium <br />
<a href="mailto:david.magis@uliege.be">david.magis@uliege.be</a>
</p>


<h3>References</h3>

<p>Andrich, D. (1978). A rating formulation for ordered response categories. <em>Psychometrika, 43</em>, 561-573. doi: <a href="https://doi.org/10.1007/BF02293814">10.1007/BF02293814</a>
</p>
<p>Bock, R. D. (1972). Estimating item parameters and latent ability when responses are scored in two or more nominal categories. <em>Psychometrika, 37</em>, 29-51. doi: <a href="https://doi.org/10.1007/BF02291411">10.1007/BF02291411</a>
</p>
<p>Embretson, S. E., and Reise, S. P. (2000). <em>Item response theory for psychologists</em>. Mahwah, NJ: Lawrence Erlbaum Associates.
</p>
<p>Magis, D. and Barrada, J. R. (2017). Computerized Adaptive Testing with R: Recent Updates of the Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>Code Snippets</em>, <em>76(1)</em>, 1-18. doi: <a href="https://doi.org/10.18637/jss.v076.c01">10.18637/jss.v076.c01</a>
</p>
<p>Magis, D., and Raiche, G. (2012). Random Generation of Response Patterns under Computerized Adaptive Testing with the R Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>48 (8)</em>, 1-31. doi: <a href="https://doi.org/10.18637/jss.v048.i08">10.18637/jss.v048.i08</a>
</p>
<p>Masters, G. N. (1982). A Rasch model for partial credit scoring. <em>Psychometrika, 47</em>, 149-174. doi: <a href="https://doi.org/10.1007/BF02296272">10.1007/BF02296272</a>
</p>
<p>Muraki, E. (1990). Fitting a polytomous item response model to Likert-type data. <em>Applied Psychological Measurement, 14</em>, 59-71. doi: <a href="https://doi.org/10.1177/014662169001400106">10.1177/014662169001400106</a>
</p>
<p>Muraki, E. (1992). A generalized partial credit model: Application of an EM algorithm. <em>Applied Psychological Measurement, 16</em>, 19-176. doi: <a href="https://doi.org/10.1177/014662169201600206">10.1177/014662169201600206</a>
</p>
<p>Samejima, F. (1969). <em>Estimation of latent ability using a response pattern of graded scores</em>. Psychometrika Monograph (vol. 17).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Pi">Pi</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# All generated item banks have 10 items and at most four response categories

 # GRM 
 genPolyMatrix(10, 4, model = "GRM")

 # GRM with same number of response categories
 genPolyMatrix(10, 4, model = "GRM", same.nrCat = TRUE)

 # MGRM 
 genPolyMatrix(10, 4, model = "MGRM")

 # MGRM with same number of response categories
 genPolyMatrix(10, 4, model = "MGRM", same.nrCat = TRUE) # same result

 # PCM 
 genPolyMatrix(10, 4, model = "PCM")

 # PCM with same number of response categories
 genPolyMatrix(10, 4, model = "PCM", same.nrCat = TRUE) 

 # GPCM 
 genPolyMatrix(10, 4, model = "GPCM")

 # GPCM with same number of response categories
 genPolyMatrix(10, 4, model = "GPCM", same.nrCat = TRUE) 

 # RSM 
 genPolyMatrix(10, 4, model = "RSM")

 # RSM with same number of response categories
 genPolyMatrix(10, 4, model = "RSM", same.nrCat = TRUE) # same result

 # NRM 
 genPolyMatrix(10, 4, model = "NRM")

 # NRM with same number of response categories
 genPolyMatrix(10, 4, model = "NRM", same.nrCat = TRUE)  

## Content balancing

 # Creation of the 'cbList' list with arbitrary proportions
 cbList &lt;- list(names = c("Audio1", "Audio2", "Written1", "Written2", "Written3"), 
        props = c(0.1, 0.2, 0.2, 0.2, 0.3))

 # NRM with 100 items
 genPolyMatrix(100, 4, model = "NRM", cbControl = cbList)
 </code></pre>

<hr>
<h2 id='Ii'>Item information functions, first and second derivatives (dichotomous and polytomous models)</h2><span id='topic+Ii'></span>

<h3>Description</h3>

<p>This command returns the Fisher information functions for a given ability value and a given matrix of item parameters under either the 4PL model or any suitable polytomous model. Numerical values of the first and second derivatives of the item information functions are also returned.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Ii(th, it, model = NULL, D = 1)
 </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Ii_+3A_th">th</code></td>
<td>
<p>numeric: the ability value.</p>
</td></tr>
<tr><td><code id="Ii_+3A_it">it</code></td>
<td>
<p>numeric: a suitable matrix of item parameters. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="Ii_+3A_model">model</code></td>
<td>
<p>either <code>NULL</code> (default) for dichotomous models, or any suitable acronym for polytomous models. Possible values are <code>"GRM"</code>, <code>"MGRM"</code>, <code>"PCM"</code>, <code>"GPCM"</code>, <code>"RSM"</code> and <code>"NRM"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="Ii_+3A_d">D</code></td>
<td>
<p>numeric: the metric constant. Default is <code>D=1</code> (for logistic metric); <code>D=1.702</code> yields approximately the normal metric (Haley, 1952). Ignored if <code>model</code> is not <code>NULL</code>.</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>The first and second derivatives are computed algebraically, either from the four-parameter logistic (4PL) model
(Barton and Lord, 1981) or from the corresponding polytomous model. These derivatives are necessary for both the estimation of ability and the computation of related standard errors. 
</p>
<p>Dichotomous IRT models are considered whenever <code>model</code> is set to <code>NULL</code> (default value). In this case, <code>it</code> must be a matrix with one row per item and four columns, with the values of the discrimination, the difficulty, the pseudo-guessing and the inattention parameters (in this order). These are the parameters of the four-parameter logistic (4PL) model
(Barton and Lord, 1981). 
</p>
<p>Polytomous IRT models are specified by their respective acronym: <code>"GRM"</code> for Graded Response Model, <code>"MGRM"</code> for Modified Graded Response Model, <code>"PCM"</code> for Partical Credit Model, <code>"GPCM"</code> for Generalized Partial Credit Model, <code>"RSM"</code> for Rating Scale Model and <code>"NRM"</code> for Nominal Response Model. The <code>it</code> still holds one row per item, end the number of columns and their content depends on the model. See <code><a href="#topic+genPolyMatrix">genPolyMatrix</a></code> for further information and illustrative examples of suitable polytomous item banks.
</p>


<h3>Value</h3>

<p>A list with three arguments:
</p>
<table role = "presentation">
<tr><td><code>Ii</code></td>
<td>
<p>the vector with item informations (one value per item).</p>
</td></tr>
<tr><td><code>dIi</code></td>
<td>
<p>the vector with first derivatives of the item information functions (one value per item).</p>
</td></tr>
<tr><td><code>d2Ii</code></td>
<td>
<p>the vector with second derivatives of the item information functions (one value per item).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>David Magis <br />
Department of Psychology, University of Liege, Belgium <br />
<a href="mailto:david.magis@uliege.be">david.magis@uliege.be</a>
</p>


<h3>References</h3>

<p>Barton, M.A., and Lord, F.M. (1981). <em>An upper asymptote for the three-parameter logistic item-response model</em>. Research Bulletin 81-20. Princeton, NJ: Educational Testing Service.
</p>
<p>Haley, D.C. (1952). <em>Estimation of the dosage mortality relationship when the dose is subject to error</em>. Technical report no 15. Palo Alto, CA: Applied Mathematics and Statistics Laboratory, Stanford University.
</p>
<p>Magis, D. and Barrada, J. R. (2017). Computerized Adaptive Testing with R: Recent Updates of the Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>Code Snippets</em>, <em>76(1)</em>, 1-18. doi: <a href="https://doi.org/10.18637/jss.v076.c01">10.18637/jss.v076.c01</a>
</p>
<p>Magis, D., and Raiche, G. (2012). Random Generation of Response Patterns under Computerized Adaptive Testing with the R Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>48 (8)</em>, 1-31. doi: <a href="https://doi.org/10.18637/jss.v048.i08">10.18637/jss.v048.i08</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Pi">Pi</a></code>, <code><a href="#topic+thetaEst">thetaEst</a></code>, <code><a href="#topic+genPolyMatrix">genPolyMatrix</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Dichotomous models ##
 
 # Loading the 'tcals' parameters 
 data(tcals)

 # Selecting item parameters only
 tcals &lt;- as.matrix(tcals[,1:4])
 
 # Item information functions and derivatives
 # (various th and D values)
 Ii(th = 0, tcals)
 Ii(th = 0, tcals, D = 1.702)
 Ii(th = 1, tcals)

## Polytomous models ##

 # Generation of an item bank under GRM with 100 items and at most 4 categories
 m.GRM &lt;- genPolyMatrix(100, 4, "GRM")
 m.GRM &lt;- as.matrix(m.GRM)

 # Computation of item information and derivatives for ability level 0
 Ii(0, m.GRM, model = "GRM")

 # Loading the cat_pav data
 data(cat_pav)
 cat_pav &lt;- as.matrix(cat_pav)

 # Computation of item information and derivatives for ability level 1
 Ii(1, cat_pav, model = "GPCM")
 </code></pre>

<hr>
<h2 id='integrate.catR'>Numerical integration by linear interpolation (for catR internal use)</h2><span id='topic+integrate.catR'></span>

<h3>Description</h3>

<p>This command computes the integral of function <em>f(x)</em> by providing values of <em>x</em> and <em>f(x)</em>, similarly to the <code>integrate.xy</code> function of the R package <code>sfsmisc</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>integrate.catR(x, y)
 </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="integrate.catR_+3A_x">x</code></td>
<td>
<p>numeric: a vector of <em>x</em> values for numerical integration.</p>
</td></tr>
<tr><td><code id="integrate.catR_+3A_y">y</code></td>
<td>
<p>numeric: a vector of numerical values corresponding to <em>f(x)</em> values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function was written to compute &quot;cheap&quot; numerical integration by providing sequences of <em>x</em> values and corresponding computed values <em>f(x)</em>. It works similarly as the <code>integrate.xy</code> function when <code>use.spline=FALSE</code> is required. It was developed internally to eventually remove dependency of <code>catR</code> package to package <code>sfsmisc</code>.
</p>


<h3>Value</h3>

<p>The approximated integral.
</p>


<h3>Author(s)</h3>

<p>David Magis <br />
Department of Psychology, University of Liege, Belgium <br />
<a href="mailto:david.magis@uliege.be">david.magis@uliege.be</a>
</p>


<h3>References</h3>

<p>Maechler, M. et al. (2012). <em>sfsmisc: Utilities from Seminar fuer Statistik ETH Zurich</em>. R package version 1.0-23.
http://CRAN.R-project.org/package=sfsmisc
</p>


<h3>See Also</h3>

<p><code><a href="#topic+KL">KL</a></code> and the <code>integrate.xy</code> function in package <code>sfsmisc</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 # Loading the 'tcals' parameters 
 x &lt;- seq(from = -4, to = 4, length = 33)
 y &lt;- exp(x)
 integrate.catR(x, y) # 54.86381

## Not run: 
 # Comparison with integrate.xy
 require(sfsmisc)
 integrate.xy(x, y, use.spline = FALSE) # 54.86381
 integrate.xy(x, y) # 54.58058
 
## End(Not run)
 </code></pre>

<hr>
<h2 id='Ji'>Function <code class="reqn">J(\theta)</code> for weighted likelihood estimation (dichotomous and polytomous IRT models)</h2><span id='topic+Ji'></span>

<h3>Description</h3>

<p>This command returns the <code class="reqn">J(\theta)</code> function that is necessary to obtain the weighted likelihood estimation of ability with dichotomous and polytomous IRT models, as well as its asymptotic standard error.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Ji(th, it, model = NULL, D = 1)
 </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Ji_+3A_th">th</code></td>
<td>
<p>numeric: the ability value.</p>
</td></tr>
<tr><td><code id="Ji_+3A_it">it</code></td>
<td>
<p>numeric: a suitable matrix of item parameters. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="Ji_+3A_model">model</code></td>
<td>
<p>either <code>NULL</code> (default) for dichotomous models, or any suitable acronym for polytomous models. Possible values are <code>"GRM"</code>, <code>"MGRM"</code>, <code>"PCM"</code>, <code>"GPCM"</code>, <code>"RSM"</code> and <code>"NRM"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="Ji_+3A_d">D</code></td>
<td>
<p>numeric: the metric constant. Default is <code>D=1</code> (for logistic metric); <code>D=1.702</code> yields approximately the normal metric (Haley, 1952). Ignored if <code>model</code> is not <code>NULL</code>.</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>The <code class="reqn">J(\theta)</code> fucntion is defined by (Samejima, 1998):
</p>
<p style="text-align: center;"><code class="reqn">J(\theta)=\sum_{j=1}^n \,\sum_{k=0}^{g_j} \frac{P_{jk}'(\theta)\,P_{jk}''(\theta)}{P_{jk}(\theta)}</code>
</p>

<p>where <code class="reqn">n</code> is the number of items; <code class="reqn">g_j</code> the number of response categories for item <em>j</em> (<code class="reqn">j=1, ..., n</code>); <code class="reqn">P_{jk}(\theta)</code> the response category probabilities and <code class="reqn">P_{jk}'(\theta)</code> and <code class="reqn">P_{jk}''(\theta)</code> the first and second derivatives with respect to <code class="reqn">\theta</code>. In case of dichotomous IRT models, this reduces to (Warm, 1989):
</p>
<p style="text-align: center;"><code class="reqn">J(\theta)=\sum_{j=1}^n \frac{P_j'(\theta)\,P_j''(\theta)}{P_j(\theta)\,Q_j(\theta)}</code>
</p>

<p>with <code class="reqn">Q_j(\theta)=1-P_j(\theta)</code>.
</p>
<p>This function is useful to compute the weighted likelihood estimates of ability with dichotomous and polytomous IRT models as well as their related asymptotic standard errors. 
</p>
<p>Dichotomous IRT models are considered whenever <code>model</code> is set to <code>NULL</code> (default value). In this case, <code>it</code> must be a matrix with one row per item and four columns, with the values of the discrimination, the difficulty, the pseudo-guessing and the inattention parameters (in this order). These are the parameters of the four-parameter logistic (4PL) model
(Barton and Lord, 1981). 
</p>
<p>Polytomous IRT models are specified by their respective acronym: <code>"GRM"</code> for Graded Response Model, <code>"MGRM"</code> for Modified Graded Response Model, <code>"PCM"</code> for Partical Credit Model, <code>"GPCM"</code> for Generalized Partial Credit Model, <code>"RSM"</code> for Rating Scale Model and <code>"NRM"</code> for Nominal Response Model. The <code>it</code> still holds one row per item, end the number of columns and their content depends on the model. See <code><a href="#topic+genPolyMatrix">genPolyMatrix</a></code> for further information and illustrative examples of suitable polytomous item banks.
</p>


<h3>Value</h3>

<p>A list with two arguments:
</p>
<table role = "presentation">
<tr><td><code>Ji</code></td>
<td>
<p>the vector with <code class="reqn">J(\theta)</code> values (one value per item).</p>
</td></tr>
<tr><td><code>dJi</code></td>
<td>
<p>the vector with first derivatives of the <code class="reqn">J(\theta)</code> values (one value per item).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>David Magis <br />
Department of Psychology, University of Liege, Belgium <br />
<a href="mailto:david.magis@uliege.be">david.magis@uliege.be</a>
</p>


<h3>References</h3>

<p>Barton, M.A., and Lord, F.M. (1981). <em>An upper asymptote for the three-parameter logistic item-response model</em>. Research Bulletin 81-20. Princeton, NJ: Educational Testing Service.
</p>
<p>Haley, D.C. (1952). <em>Estimation of the dosage mortality relationship when the dose is subject to error</em>. Technical report no 15. Palo Alto, CA: Applied Mathematics and Statistics Laboratory, Stanford University. 
</p>
<p>Magis, D. and Barrada, J. R. (2017). Computerized Adaptive Testing with R: Recent Updates of the Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>Code Snippets</em>, <em>76(1)</em>, 1-18. doi: <a href="https://doi.org/10.18637/jss.v076.c01">10.18637/jss.v076.c01</a>
</p>
<p>Magis, D., and Raiche, G. (2012). Random Generation of Response Patterns under Computerized Adaptive Testing with the R Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>48 (8)</em>, 1-31. doi: <a href="https://doi.org/10.18637/jss.v048.i08">10.18637/jss.v048.i08</a>
</p>
<p>Samejima, F. (1998, April). <em>Expansion of Warm's weighted likelihood estimator of ability for the three-parameter logistic model to generate discrete responses.</em> PPaper presented at the annual meeting of the National Council on Measurement in Education, San Diego, CA.
</p>
<p>Warm, T.A. (1989). Weighted likelihood estimation of ability in item response models. <em>Psychometrika, 54</em>, 427-450. doi: <a href="https://doi.org/10.1007/BF02294627">10.1007/BF02294627</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+thetaEst">thetaEst</a></code>, <code><a href="#topic+semTheta">semTheta</a></code>, <code><a href="#topic+genPolyMatrix">genPolyMatrix</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Dichotomous models ##
 
 # Loading the 'tcals' parameters 
 data(tcals)

 # Selecting item parameters only
 tcals &lt;- as.matrix(tcals[,1:4])
 
 # Various J functions and derivatives
 # (various th and D values)
 Ji(th = 0, tcals)
 Ji(th = 0, tcals, D = 1.702)
 Ji(th = 1, tcals)

## Polytomous models ##

 # Generation of an item bank under GRM with 100 items and at most 4 categories
 m.GRM &lt;- genPolyMatrix(100, 4, "GRM")
 m.GRM &lt;- as.matrix(m.GRM)

 # Computation of J function and derivatives for ability level 0
 Ji(0, m.GRM, model = "GRM")

 # Loading the cat_pav data
 data(cat_pav)
 cat_pav &lt;- as.matrix(cat_pav)

 # Computation of J function and derivatives for ability level 1
 Ji(1, cat_pav, model = "GPCM")
 </code></pre>

<hr>
<h2 id='KL'>Kullback-Leibler (KL) and posterior Kullback-Leibler (KLP) values for item selection</h2><span id='topic+KL'></span>

<h3>Description</h3>

<p>This command returns the value of the Kullback-Leibler (KL) or posterior Kullback-Leibler (KLP) for a given item, an item bank and a set of previously administered items.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>KL(itemBank, item, x, it.given, model = NULL, theta = NULL, lower = -4, 
  upper = 4, nqp = 33, type = "KL", priorDist = "norm", priorPar = c(0, 1), 
  D = 1, X = NULL, lik = NULL) 
 </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="KL_+3A_itembank">itemBank</code></td>
<td>
<p>numeric: a suitable matrix of item parameters. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="KL_+3A_item">item</code></td>
<td>
<p>numeric: the item (referred to as its rank in the item bank) for which the KL or KLP must be computed.</p>
</td></tr>
<tr><td><code id="KL_+3A_x">x</code></td>
<td>
<p>numeric: a vector of item responses, coded as 0 or 1 only (for dichotomous items) or from 0 to the number of response categories minus one (for polytomous items).</p>
</td></tr>
<tr><td><code id="KL_+3A_it.given">it.given</code></td>
<td>
<p>numeric: a matrix with one row per item and four columns, with the values of the discrimination, the difficulty, the pseudo-guessing and the inattention parameters (in this order). The number of rows of <code>it</code> must be equal to the length of <code>x</code>.</p>
</td></tr>
<tr><td><code id="KL_+3A_model">model</code></td>
<td>
<p>either <code>NULL</code> (default) for dichotomous models, or any suitable acronym for polytomous models. Possible values are <code>"GRM"</code>, <code>"MGRM"</code>, <code>"PCM"</code>, <code>"GPCM"</code>, <code>"RSM"</code> and <code>"NRM"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="KL_+3A_theta">theta</code></td>
<td>
<p>either a numeric value for provisional ability estimate or <code>NULL</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="KL_+3A_lower">lower</code></td>
<td>
<p>numeric: the lower bound for numercal integration (default is -4).</p>
</td></tr>
<tr><td><code id="KL_+3A_upper">upper</code></td>
<td>
<p>numeric: the upper bound for numercal integration (default is 4).</p>
</td></tr>
<tr><td><code id="KL_+3A_nqp">nqp</code></td>
<td>
<p>numeric: the number of quadrature points (default is 33).</p>
</td></tr>
<tr><td><code id="KL_+3A_type">type</code></td>
<td>
<p>character: the type of information to be computed. Possible values are <code>"KL"</code> (default) and <code>"KLP"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="KL_+3A_priordist">priorDist</code></td>
<td>
<p>character: the prior ability distribution. Possible values are <code>"norm"</code> (default) for the normal distribution, and <code>"unif"</code> for the uniform distribution. Ignored if <code>type</code> is <code>"KL"</code>.</p>
</td></tr>
<tr><td><code id="KL_+3A_priorpar">priorPar</code></td>
<td>
<p>numeric: a vector of two components with the prior parameters. If <code>priorDist</code> is <code>"norm"</code>, then <code>priorPar</code> contains the mean and the standard deviation of the normal distribution. If <code>priorDist</code> is <code>"unif"</code>, then <code>priorPar</code> contains the bounds of the uniform distribution. The default values are 0 and 1 respectively. Ignored if <code>type</code> is <code>"KL"</code>.</p>
</td></tr>
<tr><td><code id="KL_+3A_d">D</code></td>
<td>
<p>numeric: the metric constant. Default is <code>D=1</code> (for logistic metric); <code>D=1.702</code> yields approximately the normal metric (Haley, 1952).</p>
</td></tr> 
<tr><td><code id="KL_+3A_x">X</code></td>
<td>
<p>either a vector of numeric values or <code>NULL</code> (default). See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="KL_+3A_lik">lik</code></td>
<td>
<p>either a vector of numeric values or <code>NULL</code> (default). See <b>Details</b>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Kullback-Leibler information can be used as a rule for selecting the next item in the CAT process (Barrada, Olea, Ponsoda and Abad, 2010; Chang and Ying, 1996), both with dichotomous and polytomous IRT models. This command serves as a subroutine for the <code><a href="#topic+nextItem">nextItem</a></code> function.
</p>
<p>Dichotomous IRT models are considered whenever <code>model</code> is set to <code>NULL</code> (default value). In this case, <code>itemBank</code> must be a matrix with one row per item and four columns, with the values of the discrimination, the difficulty, the pseudo-guessing and the inattention parameters (in this order). These are the parameters of the four-parameter logistic (4PL) model (Barton and Lord, 1981). 
</p>
<p>Polytomous IRT models are specified by their respective acronym: <code>"GRM"</code> for Graded Response Model, <code>"MGRM"</code> for Modified Graded Response Model, <code>"PCM"</code> for Partical Credit Model, <code>"GPCM"</code> for Generalized Partial Credit Model, <code>"RSM"</code> for Rating Scale Model and <code>"NRM"</code> for Nominal Response Model. The <code>itemBank</code> still holds one row per item, end the number of columns and their content depends on the model. See <code><a href="#topic+genPolyMatrix">genPolyMatrix</a></code> for further information and illustrative examples of suitable polytomous item banks.
</p>
<p>Under polytomous IRT models, let <em>k</em> be the number of administered items, and set <code class="reqn">x_1, ..., x_k</code> as the provisional response pattern (where each response <code class="reqn">x_l</code> takes values in <code class="reqn">\{0, 1, ..., g_l\}</code>). Set <code class="reqn">\hat{\theta}_k</code> as the provisional ability estimate (with the first <em>k</em> responses) and let <em>j</em> be the item of interest (not previously administered). Set also <code class="reqn">L(\theta | x_1, ..., x_k) </code> as the likelihood function of the first <code class="reqn">k</code> items and evaluated at <code class="reqn">\theta</code>. Set finally <code class="reqn">P_{jt}(\theta)</code> as the probability of answering response category <em>t</em> to item <em>j</em> for a given ability level <code class="reqn">\theta</code>. Then, Kullack-Leibler (KL) information is defined as
</p>
<p style="text-align: center;"><code class="reqn">KL_j(\theta || \hat{\theta}_k) = \sum_{t=0}^{g_j} \,P_{jt}(\hat{\theta}_k) \,\log \left( \frac{P_{jt}(\hat{\theta}_k)}{P_{jt}(\theta)}\right).</code>
</p>

<p>In case of dichotomous IRT models, all <code class="reqn">g_l</code> values reduce to 1, so that item responses <code class="reqn">x_l</code> equal either 0 or 1. Set simply <code class="reqn">P_j(\theta)</code> as the probability of answering item <em>j</em> correctly for a given ability level <code class="reqn">\theta</code>. Then, KL information reduces to
</p>
<p style="text-align: center;"><code class="reqn">KL_j(\theta || \hat{\theta}) = P_j(\hat{\theta}) \,\log \left( \frac{P_j(\hat{\theta}_k)}{P_j(\theta)}\right) + [1-P_j(\hat{\theta}_k)] \,\log \left( \frac{1-P_j(\hat{\theta}_k)}{1-P_j(\theta)}\right).</code>
</p>

<p>The quantity that is returned by this <code>KL</code> function is either: the likelihood function weighted by Kullback-Leibler information (the KL value):
</p>
<p style="text-align: center;"><code class="reqn">KL_j(\hat{\theta}_k) = \int KL_j(\theta || \hat{\theta}_k) \, L(\theta | x_1, ..., x_k) \,d\theta</code>
</p>

<p>or the posterior function weighted by Kullback-Leibler information (the KLP value):
</p>
<p style="text-align: center;"><code class="reqn">KLP_j(\hat{\theta}) = \int KL_j(\theta || \hat{\theta}_k) \, \pi(\theta) \,L(\theta | x_1, ..., x_k) \,d\theta</code>
</p>

<p>where <code class="reqn">\pi(\theta)</code> is the prior distribution of the ability level.
</p>
<p>These integrals are approximated by the <code><a href="#topic+integrate.catR">integrate.catR</a></code> function. The range of integration is set up 
by the arguments <code>lower</code>, <code>upper</code> and <code>nqp</code>, giving respectively the lower bound, the upper bound and the number of quadrature points. The default range goes from -4 to 4 with length 33 (that is, by steps of 0.25).
</p>
<p>To speed up the computation, both the range of integration of values <code class="reqn">\theta</code> and the values of the likelihood function <code class="reqn">L(\theta)</code> can be directly provided to the function through the arguments <code>X</code> and <code>lik</code>. If <code>X</code> is set to <code>NULL</code> (default), the sequence of ability values for integration is determined by the arguments <code>lower</code>, <code>upper</code> and <code>nqp</code> as explained above. If <code>lik</code> is <code>NULL</code> (default), it is also internally computed from an implementation of the likelihood function.
</p>
<p>The provisional response pattern and the related item parameters are provided by the arguments <code>x</code> and <code>it.given</code> respectively. The target item (for which the KL information is computed) is given by its rank number in the item bank, through the <code>item</code> argument. 
</p>
<p>An ability level estimate must be provided to compute KL and KLP information values. Either the value is specified through the <code>theta</code> argument, or it is left equal to <code>NULL</code> (default). In this case, ability estimate is computed internally by maximum likelihood, using the <code><a href="#topic+thetaEst">thetaEst</a></code> function with arguments <code>it.given</code> and <code>x</code>.
</p>
<p>Note that the provisional response pattern <code>x</code> can also be set to <code>NULL</code> (which is useful when the number <code>nrItems</code> of starting items is set to zero). In this case, <code>it.given</code> must be a matrix with zero rows, such as e.g., <code>itemBank[NULL,]</code>. In this very specific configuration, the likelihood function <code class="reqn">L(\theta | x_1, ..., x_k)</code> reduces to the constant value 1 on the whole <code class="reqn">\theta</code> range (that is, a uniform likelihood). 
</p>
<p>The argument <code>type</code> defines the type of KL information to be computed. The default value, <code>"KL"</code>, computes the usual Kullback-Leibler information, while the posterior Kullback-Leibler value is obtained with <code>type="KLP"</code>. For the latter, the <code>priorDist</code> and <code>priorPar</code> arguments fix the prior ability distribution. The normal distribution is set up by <code>priorDist="norm"</code> and then, <code>priorPar</code> contains the mean and the standard deviation of the normal distribution. If <code>priorDist</code> is <code>"unif"</code>, then the uniform distribution is considered, and <code>priorPar</code> fixes the lower and upper bounds of that uniform distribution. By default, the standard normal prior distribution is assumed. These arguments are ignored whenever <code>method</code> is <code>"KL"</code>.
</p>


<h3>Value</h3>

<p>The required KL or KLP value for the selected item.
</p>


<h3>Author(s)</h3>

<p>David Magis <br />
Department of Psychology, University of Liege, Belgium <br />
<a href="mailto:david.magis@uliege.be">david.magis@uliege.be</a>
</p>
<p>Juan Ramon Barrada <br />
Department of Psychology and Sociology, Universidad Zaragoza, Spain <br />
<a href="mailto:barrada@unizar.es">barrada@unizar.es</a>
</p>


<h3>References</h3>

<p>Barrada, J. R., Olea, J., Ponsoda, V., and Abad, F. J. (2010). A method for the comparison of item selection rules in computerized adaptive testing. <em>Applied Psychological Measurement</em>, <em>20</em>, 213-229. doi: <a href="https://doi.org/10.1177/0146621610370152">10.1177/0146621610370152</a>
</p>
<p>Barton, M.A., and Lord, F.M. (1981). <em>An upper asymptote for the three-parameter logistic item-response model</em>.
Research Bulletin 81-20. Princeton, NJ: Educational Testing Service.
</p>
<p>Chang, H.-H., and Ying, Z. (1996). A global information approach to computerized adaptive testing. <em>Applied Psychological Measurement, 34</em>, 438-452. doi: <a href="https://doi.org/10.1177/014662169602000303">10.1177/014662169602000303</a>
</p>
<p>Haley, D.C. (1952). <em>Estimation of the dosage mortality relationship when the dose is subject to error</em>. Technical report no 15. Palo Alto, CA: Applied Mathematics and Statistics Laboratory, Stanford University. 
</p>
<p>Magis, D. and Barrada, J. R. (2017). Computerized Adaptive Testing with R: Recent Updates of the Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>Code Snippets</em>, <em>76(1)</em>, 1-18. doi: <a href="https://doi.org/10.18637/jss.v076.c01">10.18637/jss.v076.c01</a>
</p>
<p>Magis, D., and Raiche, G. (2012). Random Generation of Response Patterns under Computerized Adaptive Testing with the R Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>48 (8)</em>, 1-31. doi: <a href="https://doi.org/10.18637/jss.v048.i08">10.18637/jss.v048.i08</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+integrate.catR">integrate.catR</a></code>, <code><a href="#topic+nextItem">nextItem</a></code>, <code><a href="#topic+genPolyMatrix">genPolyMatrix</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Dichotomous models ##

 # Loading the 'tcals' parameters 
 data(tcals)

 # Selecting item parameters only
 bank &lt;- as.matrix(tcals[,1:4])
 
 # Selection of two arbitrary items (15 and 20) of the
 # 'tcals' data set
 it.given &lt;- bank[c(15, 20),]

 # Creation of a response pattern
 x &lt;- c(0, 1)

 # KL for item 1, ML estimate of ability computed
 KL(bank, 1, x, it.given)

 # Current (ML) ability estimate 
 theta &lt;- thetaEst(it.given, x, method = "ML")
 KL(bank, 1, x, it.given, theta = theta)

 # WL ability estimate instead
 theta &lt;- thetaEst(it.given, x, method = "WL")
 KL(bank, 1, x, it.given, theta = theta)

 # KLP for item 1
 KL(bank, 1, x, it.given, theta = theta, type = "KLP")

 # KLP for item 1, different integration range
 KL(bank, 1, x, it.given, theta = theta, type = "KLP", lower = -2, upper = 2, nqp = 20)

 # KL for item 1, uniform prior distribution on the range [-2,2]
 KL(bank, 1, x, it.given, theta = theta, type = "KLP", priorDist = "unif", 
    priorPar = c(-2, 2))

 # Computation of likelihood function beforehand
 L &lt;- function(th, r, param) 
  prod(Pi(th, param)$Pi^r * (1 - Pi(th,param)$Pi)^(1 - r))
 xx &lt;- seq(from = -4, to = 4, length = 33)
 y &lt;- sapply(xx, L, x, it.given) 
 KL(bank, 1, x, it.given, theta = theta, X = xx, lik = y)


## Polytomous models ##

 # Generation of an item bank under GRM with 100 items and at most 4 categories
 m.GRM &lt;- genPolyMatrix(100, 4, "GRM")
 m.GRM &lt;- as.matrix(m.GRM)

 # Selection of two arbitrary items (15 and 20) 
 it.given &lt;- m.GRM[c(15, 20),]

 # Generation of a response pattern (true ability level 0)
 x &lt;- genPattern(0, it.given, model = "GRM")

 # KL for item 1, ML estimate of ability computed
 KL(m.GRM, 1, x, it.given, model = "GRM")

 # Current (ML) ability estimate 
 theta &lt;- thetaEst(it.given, x, method = "ML", model = "GRM")
 KL(m.GRM, 1, x, it.given, theta = theta, model = "GRM")

 # WL ability estimate instead
 theta &lt;- thetaEst(it.given, x, method = "WL", model = "GRM")
 KL(m.GRM, 1, x, it.given, theta = theta, model = "GRM")

 # KLP for item 1
 KL(m.GRM, 1, x, it.given, theta = theta, model = "GRM", type = "KLP")

 # KLP for item 1, different integration range
 KL(m.GRM, 1, x, it.given, theta = theta, model = "GRM", type = "KLP", lower = -2, 
    upper = 2, nqp = 20)

 # KL for item 1, uniform prior distribution on the range [-2,2]
 KL(m.GRM, 1, x, it.given, theta = theta, model = "GRM", type = "KLP", 
    priorDist = "unif", priorPar = c(-2, 2))


 # Loading the cat_pav data
 data(cat_pav)
 cat_pav &lt;- as.matrix(cat_pav)

 # Selection of two arbitrary items (15 and 20) 
 it.given &lt;- cat_pav[c(15, 20),]

 # Generation of a response pattern (true ability level 0)
 x &lt;- genPattern(0, it.given, model = "GPCM")

  # KL for item 1, ML estimate of ability computed
 KL(cat_pav, 1, x, it.given, model = "GPCM")

 # Current (ML) ability estimate 
 theta &lt;- thetaEst(it.given, x, method = "ML", model = "GPCM")
 KL(cat_pav, 1, x, it.given, theta = theta, model = "GPCM")

 # WL ability estimate instead
 theta &lt;- thetaEst(it.given, x, method = "WL", model = "GPCM")
 KL(cat_pav, 1, x, it.given, theta = theta, model = "GPCM")

 # KLP for item 1
 KL(cat_pav, 1, x, it.given, theta = theta, model = "GPCM", type = "KLP")

 # KLP for item 1, different integration range
 KL(cat_pav, 1, x, it.given, theta = theta, model = "GPCM", type = "KLP", lower = -2, 
    upper = 2, nqp = 20)

 # KL for item 1, uniform prior distribution on the range [-2,2]
 KL(cat_pav, 1, x, it.given, theta = theta, model = "GPCM", type = "KLP", 
    priorDist = "unif", priorPar = c(-2, 2))
 </code></pre>

<hr>
<h2 id='MEI'>(Maximum) Expected Information (MEI)</h2><span id='topic+MEI'></span>

<h3>Description</h3>

<p>This command returns the expected information (EI) for a given item (under dichotomous and polytomous IRT models), as used for Maximum Expected Information (MEI) criterion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MEI(itemBank, item, x, theta, it.given, model = NULL, method = "BM", 
 	priorDist = "norm", priorPar = c(0, 1), D = 1, range = c(-4, 4), 
 	parInt = c(-4, 4, 33), infoType = "observed")
 </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MEI_+3A_itembank">itemBank</code></td>
<td>
<p>numeric: a suitable matrix of item parameters. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="MEI_+3A_item">item</code></td>
<td>
<p>numeric: the item (referred to as its rank in the item bank) for which the expected information must be computed.</p>
</td></tr>
<tr><td><code id="MEI_+3A_x">x</code></td>
<td>
<p>numeric: a vector of item responses, coded as 0 or 1 only (for dichotomous items) or from 0 to the number of response categories minus one (for polytomous items).</p>
</td></tr>
<tr><td><code id="MEI_+3A_theta">theta</code></td>
<td>
<p>numeric: the provisional ability estimate.</p>
</td></tr>
<tr><td><code id="MEI_+3A_it.given">it.given</code></td>
<td>
<p>numeric: a suitable matrix of item parameters for previously administered items. The number of rows of <code>it.given</code> must be equal to the length of <code>x</code>.</p>
</td></tr>
<tr><td><code id="MEI_+3A_model">model</code></td>
<td>
<p>either <code>NULL</code> (default) for dichotomous models, or any suitable acronym for polytomous models. Possible values are <code>"GRM"</code>, <code>"MGRM"</code>, <code>"PCM"</code>, <code>"GPCM"</code>, <code>"RSM"</code> and <code>"NRM"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="MEI_+3A_method">method</code></td>
<td>
<p>character: the ability estimator. Possible values are <code>"BM"</code> (default), <code>"ML"</code> and <code>"WL"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="MEI_+3A_priordist">priorDist</code></td>
<td>
<p>character: specifies the prior distribution. Possible values are <code>"norm"</code> (default), <code>"unif"</code> and <code>"Jeffreys"</code>.
Ignored if <code>method</code> is neither <code>"BM"</code> nor <code>"EAP"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="MEI_+3A_priorpar">priorPar</code></td>
<td>
<p>numeric: vector of two components specifying the prior parameters (default is <code>c(0,1)</code>) of the prior ability distribution. Ignored if <code>method</code> is neither <code>"BM"</code>
nor <code>"EAP"</code>, or if <code>priorDist="Jeffreys"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="MEI_+3A_d">D</code></td>
<td>
<p>numeric: the metric constant. Default is <code>D=1</code> (for logistic metric); <code>D=1.702</code> yields approximately the normal metric (Haley, 1952).</p>
</td></tr> 
<tr><td><code id="MEI_+3A_range">range</code></td>
<td>
<p>numeric: vector of two components specifying the range wherein the ability estimate must be looked for (default is <code>c(-4,4)</code>). Ignored if <code>method=="EAP"</code>.</p>
</td></tr>
<tr><td><code id="MEI_+3A_parint">parInt</code></td>
<td>
<p>numeric: vector of three components, holding respectively the values of the arguments <code>lower</code>, <code>upper</code> and <code>nqp</code> of the
<code><a href="#topic+eapEst">eapEst</a></code> command. Default vector is (-4, 4, 33). Ignored if <code>method</code> is not <code>"EAP"</code>.</p>
</td></tr>
<tr><td><code id="MEI_+3A_infotype">infoType</code></td>
<td>
<p>character: the type of information function to be used. Possible values are <code>"observed"</code> (default) for observed information function, and <code>"Fisher"</code> for Fisher information function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The MEI (van der Linden, 1998; van der Linden and Pashley, 2000) can be used as a rule for selecting the next item in the CAT process (see also Choi and Swartz, 2009), both with dichotomous and polytomous IRT models. This command serves as a subroutine for the <code><a href="#topic+nextItem">nextItem</a></code> function.
</p>
<p>Dichotomous IRT models are considered whenever <code>model</code> is set to <code>NULL</code> (default value). In this case, <code>itemBank</code> must be a matrix with one row per item and four columns, with the values of the discrimination, the difficulty, the pseudo-guessing and the inattention parameters (in this order). These are the parameters of the four-parameter logistic (4PL) model (Barton and Lord, 1981). 
</p>
<p>Polytomous IRT models are specified by their respective acronym: <code>"GRM"</code> for Graded Response Model, <code>"MGRM"</code> for Modified Graded Response Model, <code>"PCM"</code> for Partical Credit Model, <code>"GPCM"</code> for Generalized Partial Credit Model, <code>"RSM"</code> for Rating Scale Model and <code>"NRM"</code> for Nominal Response Model. The <code>itemBank</code> still holds one row per item, end the number of columns and their content depends on the model. See <code><a href="#topic+genPolyMatrix">genPolyMatrix</a></code> for further information and illustrative examples of suitable polytomous item banks.
</p>
<p>Under polytomous IRT models, let <em>k</em> be the number of administered items, and set <code class="reqn">x_1, ..., x_k</code> as the provisional response pattern (where each response <code class="reqn">x_l</code> takes values in <code class="reqn">\{0, 1, ..., g_l\}</code>). Set <code class="reqn">\hat{\theta}_k</code> as the provisional ability estimate (with the first <em>k</em> responses) and let <em>j</em> be the item of interest (not previously administered). Set also <code class="reqn">P_{jt}(\theta)</code> as the probability of answering response category <em>t</em> to item <em>j</em> for a given ability level <code class="reqn">\theta</code>. Finally, set
<code class="reqn">\hat{\theta}_{k+1}^t</code> as the ability estimates computed under the condition that the response to item <em>j</em> is <em>t</em> (with <code class="reqn">t=0, ..., g_j</code>). Then, the EI for item <em>j</em> equals
</p>
<p style="text-align: center;"><code class="reqn">EI_j = \sum_{t=0}^{g_j} P_{jt}(\hat{\theta}_k)\,I_j(\hat{\theta}_{k+1}^t)</code>
</p>
 
<p>where <code class="reqn">I_j(\theta)</code> is the information function for item <em>j</em>.
</p>
<p>In case of dichotomous IRT models, all <code class="reqn">g_l</code> values reduce to 1, so that item responses <code class="reqn">x_l</code> equal either 0 or 1. Set simply <code class="reqn">P_j(\theta)</code> as the probability of answering item <em>j</em> correctly for a given ability level <code class="reqn">\theta</code>, and  set <code class="reqn">Q_j(\theta)=1-P_j(\theta)</code>. Finally, set <code class="reqn">\hat{\theta}_{k+1}^0</code> and <code class="reqn">\hat{\theta}_{k+1}^1</code> as the ability estimates computed under the condition that the response to item <em>j</em> is 0 or 1 respectively (that is, if the response pattern is updated by 0 or 1 for item <em>j</em>). Then, the EI for item <em>j</em> reduces to
</p>
<p style="text-align: center;"><code class="reqn">EI_j = P_j(\hat{\theta}_k)\,I_j(\hat{\theta}_{k+1}^1) +  Q_j(\hat{\theta}_k)\,I_j(\hat{\theta}_{k+1}^0)</code>
</p>
<p>.
</p>
<p>Two types of information functions are available. The first one is the observed information function, defined as 
</p>
<p style="text-align: center;"><code class="reqn">OI_j(\theta) = -\frac{\partial^2}{\partial \theta^2} \,\log L(\theta | x_j)</code>
</p>

<p>(van der Linden, 1998), where <code class="reqn">L(\theta | x_j)</code> is the likelihood related to item <em>j</em>. The second one is Fisher information function:
</p>
<p style="text-align: center;"><code class="reqn">I_j(\theta) = -E\,\left[\frac{\partial^2}{\partial\,\theta^2} \,\log L(\theta | x_j))\right].</code>
</p>

<p>Under the 1PL and the 2PL models, these functions are identical (Veerkamp, 1996). See also <code><a href="#topic+OIi">OIi</a></code>. 
</p>
<p>The observed and Fisher information functions are specified by the <code>infoType</code> argument, with respective values <code>"observed"</code> and <code>"Fisher"</code>. By default, the observed information function is considered (Choi and Swartz, 2009; van der Linden, 1998).
</p>
<p>The estimator of provisional ability is defined by means of the arguments <code>method</code>, <code>priorDist</code>, <code>priorPar</code>, <code>D</code>, <code>range</code> and <code>parInt</code> of the <code><a href="#topic+thetaEst">thetaEst</a></code> function. See the corresponding help file for further details.
</p>
<p>The provisional response pattern and the related item parameters are provided by the arguments <code>x</code> and <code>it.given</code> respectively. The target item (for which the maximum information computed) is given by its number in the item bank, through the
<code>item</code> argument. 
</p>
<p>Note that the provisional response pattern <code>x</code> can also be set to <code>NULL</code> (which is useful when the number <code>nrItems</code> of starting items is set to zero). In this case, <code>it.given</code> must be a matrix with zero rows, such as e.g., <code>itemBank[NULL,]</code>. 
</p>


<h3>Value</h3>

<p>The required expected information for the selected item.
</p>


<h3>Author(s)</h3>

<p>David Magis <br />
Department of Psychology, University of Liege, Belgium <br />
<a href="mailto:david.magis@uliege.be">david.magis@uliege.be</a>
</p>


<h3>References</h3>

<p>Barton, M.A., and Lord, F.M. (1981). <em>An upper asymptote for the three-parameter logistic item-response model</em>.
Research Bulletin 81-20. Princeton, NJ: Educational Testing Service.
</p>
<p>Choi, S. W., and Swartz, R. J. (2009). Comparison of CAT item selection criteria for polytomous items. <em>Applied Psychological Measurement, 32</em>, 419-440. doi: <a href="https://doi.org/10.1177/0146621608327801">10.1177/0146621608327801</a>
</p>
<p>Haley, D.C. (1952). <em>Estimation of the dosage mortality relationship when the dose is subject to error</em>. Technical report no 15. Palo Alto, CA: Applied Mathematics and Statistics Laboratory, Stanford University. 
</p>
<p>Magis, D. and Barrada, J. R. (2017). Computerized Adaptive Testing with R: Recent Updates of the Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>Code Snippets</em>, <em>76(1)</em>, 1-18. doi: <a href="https://doi.org/10.18637/jss.v076.c01">10.18637/jss.v076.c01</a>
</p>
<p>Magis, D., and Raiche, G. (2012). Random Generation of Response Patterns under Computerized Adaptive Testing with the R Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>48 (8)</em>, 1-31. doi: <a href="https://doi.org/10.18637/jss.v048.i08">10.18637/jss.v048.i08</a>
</p>
<p>van der Linden, W. J. (1998). Bayesian item selection criteria for adaptive testing. <em>Psychometrika, 63</em>, 201-216. doi: <a href="https://doi.org/10.1007/BF02294775">10.1007/BF02294775</a>
</p>
<p>van der Linden, W. J., and Pashley, P. J. (2000). Item selection and ability estimation in adaptive testing. In W. J. van der Linden and C. A. W. Glas (Eds.), <em>Computerized adaptive testing. Theory and practice</em> (pp. 1-25). Boston, MA: Kluwer. 
</p>
<p>Veerkamp, W. J. J. (1996). <em>Statistical inference for adaptive testing</em>. Internal report. Enschede, The Netherlands: 
University of Twente. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Ii">Ii</a></code>, <code><a href="#topic+OIi">OIi</a></code>, <code><a href="#topic+nextItem">nextItem</a></code>, <code><a href="#topic+thetaEst">thetaEst</a></code>, <code><a href="#topic+genPolyMatrix">genPolyMatrix</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Dichotomous models ##

 # Loading the 'tcals' parameters 
 data(tcals)

 # Selecting item parameters only
 bank &lt;- as.matrix(tcals[,1:4])
 
 # Selection of two arbitrary items (15 and 20) of the
 # 'tcals' data set
 it.given &lt;- bank[c(15, 20),]

 # Creation of a response pattern
 x &lt;- c(0, 1)

 # MEI for item 1, provisional ability level 0
 MEI(bank, 1, x, 0, it.given)

 # With Fisher information instead
 MEI(bank, 1, x, 0, it.given, infoType = "Fisher")

 # With WL estimator instead
 MEI(bank, 1, x, 0, it.given, method = "WL")


## Polytomous models ##

 # Generation of an item bank under GRM with 100 items and at most 4 categories
 m.GRM &lt;- genPolyMatrix(100, 4, "GRM")
 m.GRM &lt;- as.matrix(m.GRM)

 # Selection of two arbitrary items (15 and 20) 
it.given &lt;- m.GRM[c(15, 20),]

 # Generation of a response pattern (true ability level 0)
 x &lt;- genPattern(0, it.given, model = "GRM")

 # EPV for item 1, provisional ability level 0
 MEI(m.GRM, 1, x, 0, it.given, model = "GRM")

 # With WL method
 MEI(m.GRM, 1, x, 0, it.given, model = "GRM", method = "WL")

 # With Fisher information
 MEI(m.GRM, 1, x, 0, it.given, model = "GRM", infoType = "Fisher")

 # Loading the cat_pav data
 data(cat_pav)
 cat_pav &lt;- as.matrix(cat_pav)

 # Selection of two arbitrary items (15 and 20) 
 it.given &lt;- cat_pav[c(15, 20),]

 # Generation of a response pattern (true ability level 0)
 x &lt;- genPattern(0, it.given, model = "GPCM")

 # EPV for item 1, provisional ability level 0
 MEI(cat_pav, 1, x, 0, it.given, model = "GPCM")

 # With WL method
 MEI(cat_pav, 1, x, 0, it.given, model = "GPCM", method = "WL")

 # With Fisher information
 MEI(cat_pav, 1, x, 0, it.given, model = "GPCM", infoType = "Fisher") 
 </code></pre>

<hr>
<h2 id='MWI'>Maximum likelihood weighted information (MLWI) and maximum posterior weighted information (MPWI)</h2><span id='topic+MWI'></span>

<h3>Description</h3>

<p>This command returns the value of the likelihood (MLWI) or the posterior (MPWI) weighted information for a given item and an item bank (both under dichotomous and polytomous IRT models).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MWI(itemBank, item, x, it.given, model = NULL, lower = -4, upper = 4, nqp = 33,
 	type = "MLWI", priorDist = "norm", priorPar = c(0, 1), D = 1)
 </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MWI_+3A_itembank">itemBank</code></td>
<td>
<p>numeric: a suitable matrix of item parameters. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="MWI_+3A_item">item</code></td>
<td>
<p>numeric: the item (referred to as its rank in the item bank) for which the expected information must be computed.</p>
</td></tr>
<tr><td><code id="MWI_+3A_x">x</code></td>
<td>
<p>numeric: a vector of item responses, coded as 0 or 1 only (for dichotomous items) or from 0 to the number of response categories minus one (for polytomous items). </p>
</td></tr>
<tr><td><code id="MWI_+3A_it.given">it.given</code></td>
<td>
<p>numeric: a suitable matrix of item parameters for previously administered items. The number of rows of <code>it.given</code> must be equal to the length of <code>x</code>.</p>
</td></tr>
<tr><td><code id="MWI_+3A_model">model</code></td>
<td>
<p>either <code>NULL</code> (default) for dichotomous models, or any suitable acronym for polytomous models. Possible values are <code>"GRM"</code>, <code>"MGRM"</code>, <code>"PCM"</code>, <code>"GPCM"</code>, <code>"RSM"</code> and <code>"NRM"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="MWI_+3A_lower">lower</code></td>
<td>
<p>numeric: the lower bound for numerical integration (default is -4).</p>
</td></tr>
<tr><td><code id="MWI_+3A_upper">upper</code></td>
<td>
<p>numeric: the upper bound for numerical integration (default is 4).</p>
</td></tr>
<tr><td><code id="MWI_+3A_nqp">nqp</code></td>
<td>
<p>numeric: the number of quadrature points (default is 33).</p>
</td></tr>
<tr><td><code id="MWI_+3A_type">type</code></td>
<td>
<p>character: the type of information to be computed. Possible values are <code>"MLWI"</code> (default) and <code>"MPWI"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="MWI_+3A_priordist">priorDist</code></td>
<td>
<p>character: the prior ability distribution. Possible values are <code>"norm"</code> (default) for the normal distribution, and <code>"unif"</code> for the uniform distribution. Ignored if <code>type</code> is not <code>"MPWI"</code>.</p>
</td></tr>
<tr><td><code id="MWI_+3A_priorpar">priorPar</code></td>
<td>
<p>numeric: a vector of two components with the prior parameters. If <code>priorDist</code> is <code>"norm"</code>, then <code>priorPar</code> contains the mean and the standard deviation of the normal distribution. If <code>priorDist</code> is <code>"unif"</code>, then <code>priorPar</code> contains the bounds of the uniform distribution. The default values are 0 and 1 respectively. Ignored if <code>type</code> is not <code>"MPWI"</code>.</p>
</td></tr>
<tr><td><code id="MWI_+3A_d">D</code></td>
<td>
<p>numeric: the metric constant. Default is <code>D=1</code> (for logistic metric); <code>D=1.702</code> yields approximately the normal metric (Haley, 1952). Ignored if <code>model</code> is not <code>NULL</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Both the MLWI (Veerkamp and Berger, 1997) and the MPWI (van der Linden, 1998; van der Linden and Pashley, 2000) can be used as rules for selecting the next item in the CAT process (see also Choi and Swartz, 2009), both under dichotomous and polytomous IRT models. This command serves as a subroutine for the <code><a href="#topic+nextItem">nextItem</a></code> function.
</p>
<p>Dichotomous IRT models are considered whenever <code>model</code> is set to <code>NULL</code> (default value). In this case, <code>itemBank</code> must be a matrix with one row per item and four columns, with the values of the discrimination, the difficulty, the pseudo-guessing and the inattention parameters (in this order). These are the parameters of the four-parameter logistic (4PL) model (Barton and Lord, 1981).
</p>
<p>Polytomous IRT models are specified by their respective acronym: <code>"GRM"</code> for Graded Response Model, <code>"MGRM"</code> for Modified Graded Response Model, <code>"PCM"</code> for Partical Credit Model, <code>"GPCM"</code> for Generalized Partial Credit Model, <code>"RSM"</code> for Rating Scale Model and <code>"NRM"</code> for Nominal Response Model. The <code>itemBank</code> still holds one row per item, end the number of columns and their content depends on the model. See <code><a href="#topic+genPolyMatrix">genPolyMatrix</a></code> for further information and illustrative examples of suitable polytomous item banks.
</p>
<p>Under polytomous IRT models, let <em>k</em> be the number of administered items, and set <code class="reqn">x_1, ..., x_k</code> as the provisional response pattern (where each response <code class="reqn">x_l</code> takes values in <code class="reqn">\{0, 1, ..., g_l\}</code>). Set also
<code class="reqn">I_j(\theta)</code> as the information function of item <em>j</em> evaluated at <code class="reqn">\theta</code>, and set <code class="reqn">L(\theta | x_1, ..., x_k)</code> as the likelihood function evaluated at <code class="reqn">\theta</code>, given the provisional response pattern. Then, the LWI for item <em>j</em> is given by
</p>
<p style="text-align: center;"><code class="reqn">LWI_j = \int I_j(\theta) L(\theta | x_1, ..., x_k) d\theta</code>
</p>
<p> and the PWI by
</p>
<p style="text-align: center;"><code class="reqn">PWI_j = \int I_j(\theta) \pi(\theta) L(\theta | x_1, ..., x_k) d\theta</code>
</p>

<p>where <code class="reqn">\pi(\theta)</code> is the prior distribution of the ability level.
</p>
<p>In case of dichotomous IRT models, all <code class="reqn">g_l</code> values reduce to 1, so that item responses <code class="reqn">x_l</code> equal either 0 or 1. But except from this difference, the previous definitions of LWI and PWI remain valid.
</p>
<p>These integrals are approximated by the <code><a href="#topic+integrate.catR">integrate.catR</a></code> function. The range of integration is set up
by the arguments <code>lower</code>, <code>upper</code> and <code>nqp</code>, giving respectively the lower bound, the upper bound and the number of quadrature points. The default range goes from -4 to 4 with length 33 (that is, by steps of 0.25).
</p>
<p>The argument <code>type</code> defines the type of information to be computed. The default value, <code>"MLWI"</code>, computes the MLWI value, while the MPWI value is obtained with <code>type="MPWI"</code>. For the latter, the <code>priorDist</code> and <code>priorPar</code> arguments fix the prior ability distribution.
The normal distribution is set up by <code>priorDist="norm"</code> and then, <code>priorPar</code> contains the mean and the standard deviation of the normal distribution. If <code>priorDist</code> is <code>"unif"</code>, then the uniform distribution is considered, and <code>priorPar</code> fixes the lower and upper bounds of that
uniform distribution. By default, the standard normal prior distribution is assumed. This argument is ignored whenever <code>method</code> is not <code>"MPWI"</code>.
</p>
<p>The provisional response pattern and the related item parameters are provided by the arguments <code>x</code> and <code>it.given</code> respectively. The target item (for which the maximum information is computed) is given by its rank number in the item bank, through the <code>item</code> argument.
</p>
<p>Note that the provisional response pattern <code>x</code> can also be set to <code>NULL</code> (which is useful when the number <code>nrItems</code> of starting items is set to zero). In this case, <code>it.given</code> must be a matrix with zero rows, such as e.g., <code>itemBank[NULL,]</code>. In this very specific configuration, the likelihood function <code class="reqn">L(\theta | x_1, ..., x_k)</code> reduces to the constant value 1 on the whole <code class="reqn">\theta</code> range (that is, a uniform likelihood).
</p>


<h3>Value</h3>

<p>The required (likelihood or posterior) weighted information for the selected item.
</p>


<h3>Author(s)</h3>

<p>David Magis <br />
Department of Psychology, University of Liege, Belgium <br />
<a href="mailto:david.magis@uliege.be">david.magis@uliege.be</a>
</p>


<h3>References</h3>

<p>Barton, M.A., and Lord, F.M. (1981). <em>An upper asymptote for the three-parameter logistic item-response model</em>.
Research Bulletin 81-20. Princeton, NJ: Educational Testing Service.
</p>
<p>Choi, S. W., and Swartz, R. J. (2009). Comparison of CAT item selection criteria for polytomous items. <em>Applied Psychological Measurement, 32</em>, 419-440. doi: <a href="https://doi.org/10.1177/0146621608327801">10.1177/0146621608327801</a>
</p>
<p>Haley, D.C. (1952). <em>Estimation of the dosage mortality relationship when the dose is subject to error</em>. Technical report no 15. Palo Alto, CA: Applied Mathematics and Statistics Laboratory, Stanford University.
</p>
<p>Magis, D. and Barrada, J. R. (2017). Computerized Adaptive Testing with R: Recent Updates of the Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>Code Snippets</em>, <em>76(1)</em>, 1-18. doi: <a href="https://doi.org/10.18637/jss.v076.c01">10.18637/jss.v076.c01</a>
</p>
<p>Magis, D., and Raiche, G. (2012). Random Generation of Response Patterns under Computerized Adaptive Testing with the R Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>48 (8)</em>, 1-31. doi: <a href="https://doi.org/10.18637/jss.v048.i08">10.18637/jss.v048.i08</a>
</p>
<p>van der Linden, W. J. (1998). Bayesian item selection criteria for adaptive testing. <em>Psychometrika, 63</em>, 201-216. doi: <a href="https://doi.org/10.1007/BF02294775">10.1007/BF02294775</a>
</p>
<p>van der Linden, W. J., and Pashley, P. J. (2000). Item selection and ability estimation in adaptive testing. In W. J. van der Linden and C. A. W. Glas (Eds.), <em>Computerized adaptive testing. Theory and practice</em> (pp. 1-25). Boston, MA: Kluwer.
</p>
<p>Veerkamp, W. J. J., and Berger, M. P. F. (1997). Some new item selection criteria for adaptive testing. <em>Journal of Educational and Behavioral Statistics, 22</em>, 203-226. doi: <a href="https://doi.org/10.3102/10769986022002203">10.3102/10769986022002203</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Ii">Ii</a></code>, <code><a href="#topic+nextItem">nextItem</a></code>, <code><a href="#topic+integrate.catR">integrate.catR</a></code>, <code><a href="#topic+genPolyMatrix">genPolyMatrix</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Dichotomous models ##

 # Loading the 'tcals' parameters
 data(tcals)

 # Selecting item parameters only
 bank &lt;- as.matrix(tcals[,1:4])

  # Selection of two arbitrary items (15 and 20) of the
 # 'tcals' data set
 it.given &lt;- bank[c(15, 20),]

 # Creation of a response pattern
 x &lt;- c(0, 1)

 # MLWI for item 1
 MWI(bank, 1, x, it.given)

 # MPWI for item 1
 MWI(bank, 1, x, it.given, type = "MPWI")

 # MLWI for item 1, different integration range
 MWI(bank, 1, x, it.given, lower = -2, upper = 2, nqp = 20)

 # MPWI for item 1, uniform prior distribution on the range [-2,2]
 MWI(bank, 1, x, it.given, type = "MPWI", priorDist = "unif", priorPar = c(-2, 2))


## Polytomous models ##

 # Generation of an item bank under GRM with 100 items and at most 4 categories
 m.GRM &lt;- genPolyMatrix(100, 4, "GRM")
 m.GRM &lt;- as.matrix(m.GRM)

 # Selection of two arbitrary items (15 and 20)
 it.given &lt;- m.GRM[c(15, 20),]

 # Generation of a response pattern (true ability level 0)
 x &lt;- genPattern(0, it.given, model = "GRM")

 # MLWI for item 1
 MWI(m.GRM, 1, x, it.given, model = "GRM")

 # MPWI for item 1
 MWI(m.GRM, 1, x, it.given, model = "GRM", type = "MPWI")

 # MLWI for item 1, different integration range
 MWI(m.GRM, 1, x, it.given, model = "GRM", lower = -2, upper = 2, nqp = 20)

 # MPWI for item 1, uniform prior distribution on the range [-2,2]
 MWI(m.GRM, 1, x, it.given, model = "GRM", type = "MPWI", priorDist = "unif",
 priorPar = c(-2, 2))


 # Loading the cat_pav data
 data(cat_pav)
 cat_pav &lt;- as.matrix(cat_pav)

 # Selection of two arbitrary items (15 and 20)
 it.given &lt;- cat_pav[c(15, 20),]

 # Generation of a response pattern (true ability level 0)
 x &lt;- genPattern(0, it.given, model = "GPCM")

  # MLWI for item 1
 MWI(cat_pav, 1, x, it.given, model = "GPCM")

 # MPWI for item 1
 MWI(cat_pav, 1, x, it.given, model = "GPCM", type = "MPWI")

 # MLWI for item 1, different integration range
 MWI(cat_pav, 1, x, it.given, model = "GPCM", lower = -2, upper = 2, nqp = 20)

 # MPWI for item 1, uniform prior distribution on the range [-2,2]
 MWI(cat_pav, 1, x, it.given, model = "GPCM", type = "MPWI", priorDist = "unif",
 priorPar = c(-2, 2))
 </code></pre>

<hr>
<h2 id='nextItem'>Selection of the next item</h2><span id='topic+nextItem'></span>

<h3>Description</h3>

<p>This command selects the next item to be administered, given the list of previously administered items and the current
ability estimate, with several possible criteria. Item exposure and content balancing can also be controlled.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nextItem(itemBank, model = NULL, theta = 0, out = NULL, x = NULL, 
 	criterion = "MFI", method = "BM", priorDist = "norm", priorPar = c(0, 1), 
 	D = 1, range = c(-4, 4), parInt = c(-4, 4, 33), infoType = "observed", 
 	randomesque = 1, random.seed = NULL, rule = "length", thr = 20, SETH = NULL, 
 	AP = 1, nAvailable = NULL, maxItems = 50, cbControl = NULL, cbGroup = NULL) 
 </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nextItem_+3A_itembank">itemBank</code></td>
<td>
<p>numeric: a suitable matrix of item parameters. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="nextItem_+3A_model">model</code></td>
<td>
<p>either <code>NULL</code> (default) for dichotomous models, or any suitable acronym for polytomous models. Possible values are <code>"GRM"</code>, <code>"MGRM"</code>, <code>"PCM"</code>, <code>"GPCM"</code>, <code>"RSM"</code> and <code>"NRM"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="nextItem_+3A_theta">theta</code></td>
<td>
<p>numeric: the current value of the ability estimate (default is 0). Ignored if <code>criterion</code> is either <code>"MLWI"</code>, <code>"MPWI"</code> or <code>"random"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="nextItem_+3A_out">out</code></td>
<td>
<p>either a vector of integer values specifying the items previously administered, or <code>NULL</code> (default).</p>
</td></tr> 
<tr><td><code id="nextItem_+3A_x">x</code></td>
<td>
<p>numeric: the provisional response pattern, with the same length as <code>out</code> (and <code>NULL</code> by default). Ignored if <code>criterion</code> is either <code>"MFI"</code>, <code>"bOtp"</code>, <code>"thOpt"</code>, <code>"proportional"</code>, <code>"progressive"</code> or <code>"random"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="nextItem_+3A_criterion">criterion</code></td>
<td>
<p>character: the method for next item selection. Possible values are <code>"MFI"</code> (default), <code>"bOpt"</code>, <code>"thOpt"</code>, <code>"MLWI"</code>, <code>"MPWI"</code>, <code>"MEI"</code>, <code>"MEPV"</code>, <code>"progressive"</code>, <code>"proportional"</code>, <code>"KL"</code>, <code>"KLP"</code>, <code>"GDI"</code>, <code>"GDIP"</code> and <code>random</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="nextItem_+3A_method">method</code></td>
<td>
<p>character: the ability estimator. Possible values are <code>"BM"</code> (default), <code>"ML"</code> and <code>"WL"</code>. Ignored if <code>method</code> is not <code>"MEI"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="nextItem_+3A_priordist">priorDist</code></td>
<td>
<p>character: the prior ability distribution. Possible values are <code>"norm"</code> (default) for the normal distribution, and <code>"unif"</code> for the uniform distribution. Ignored if <code>type</code> is not <code>"MPWI"</code>, <code>"KLP"</code> or <code>"GDIP"</code>.</p>
</td></tr>
<tr><td><code id="nextItem_+3A_priorpar">priorPar</code></td>
<td>
<p>numeric: a vector of two components with the prior parameters. If <code>priorDist</code> is <code>"norm"</code>, then <code>priorPar</code> contains the mean and the standard deviation of the normal distribution. If <code>priorDist</code> is <code>"unif"</code>, then <code>priorPar</code> contains the bounds of the uniform distribution. The default values are 0 and 1 respectively. Ignored if <code>type</code> is neither <code>"MPWI"</code> nor <code>"KLP"</code>.</p>
</td></tr>
<tr><td><code id="nextItem_+3A_d">D</code></td>
<td>
<p>numeric: the metric constant. Default is <code>D=1</code> (for logistic metric); <code>D=1.702</code> yields approximately the normal metric (Haley, 1952).</p>
</td></tr> 
<tr><td><code id="nextItem_+3A_range">range</code></td>
<td>
<p>numeric: vector of two components specifying the range wherein the ability estimate must be looked for (default is <code>c(-4,4)</code>).</p>
</td></tr>
<tr><td><code id="nextItem_+3A_parint">parInt</code></td>
<td>
<p>numeric: a vector of three numeric values, specifying respectively the lower bound, the upper bound and the number of quadrature points for numerical integration (default is <code>c(-4,4,33)</code>). Ignored if <code>method</code> is either <code>"MFI"</code>, <code>"bOpt"</code>, <code>"thOpt"</code>, <code>"progressive"</code>, <code>"proportional"</code> or <code>"random"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="nextItem_+3A_infotype">infoType</code></td>
<td>
<p>character: the type of information function to be used. Possible values are <code>"observed"</code> (default) and <code>"Fisher"</code>. Ignored if <code>criterion</code> is not <code>"MEI"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="nextItem_+3A_randomesque">randomesque</code></td>
<td>
<p>integer: the number of items to be chosen from the next item selection rule, among those the next item to be administered will be randomly picked up. Default value is 1 and leads to usual selection of the optimal item for the specified <code>criterion</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="nextItem_+3A_random.seed">random.seed</code></td>
<td>
<p>either <code>NULL</code> (default) or a numeric value to fix the random seed of randomesque selection of the items. Ignored if <code>randomesque</code> is equal to one.</p>
</td></tr>
<tr><td><code id="nextItem_+3A_rule">rule</code></td>
<td>
<p>character: the type of stopping rule for next item selection. Possible values are <code>"length"</code> (default) or <code>"precision"</code>. Ignored if <code>criterion</code> is any other value than <code>"progressive"</code> or <code>"proportional"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="nextItem_+3A_thr">thr</code></td>
<td>
<p>numeric: the threshold related to the stopping rule. Ignored if <code>criterion</code> is neither <code>"progressive"</code> nor <code>"proportional"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="nextItem_+3A_seth">SETH</code></td>
<td>
<p>either a numeric value for the provisional standard error<code>NULL</code> (default). Ignored if <code>criterion</code> is neither <code>"progressive"</code> nor <code>"proportional"</code>, or if <code>rule</code> is not <code>"precision"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="nextItem_+3A_ap">AP</code></td>
<td>
<p>numeric: the value of the acceleration parameter  (default value is 1). Ignored if <code>criterion</code> is neither <code>"progressive"</code> nor <code>"proportional"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="nextItem_+3A_navailable">nAvailable</code></td>
<td>
<p>either a numeric vector of zero and one entries to denote respectively which items are not available and are availbale, or <code>NULL</code> (default). Used for content balancing purposes only. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="nextItem_+3A_maxitems">maxItems</code></td>
<td>
<p>integer: the maximum number of items to be administered during the adaptive test (default value is 50). See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="nextItem_+3A_cbcontrol">cbControl</code></td>
<td>
<p>either a list of accurate format to control for content balancing, or <code>NULL</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="nextItem_+3A_cbgroup">cbGroup</code></td>
<td>
<p>either a factor vector of accurate format to control for content balancing, or <code>NULL</code>. See <b>Details</b>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Currently twelve methods are available for selecting the next item to be administered in the adaptive test. All are avilable with dichotomous items and ten out of the twelve are also available for polytomous items. For a given current ability estimate, the next item is selected (among the available items) by using: 
</p>

<ol>
<li><p>the maximum Fisher information (MFI) criterion,
</p>
</li>
<li><p>the so-called <code>bOpt</code> procedure (Urry, 1970) (<b>not</b> for polytomous items),
</p>
</li>
<li><p>the so-called <code>thOpt</code> procedure (see e.g., Barrada, Mazuela and Olea, 2006; Magis, 2013) (<b>not</b> for polytomous items),
</p>
</li>
<li><p>the maximum likelihood weighted information (MLWI) (Veerkamp and Berger, 1997),
</p>
</li>
<li><p>the maximum posterior weighted information (MPWI)
(van der Linden, 1998),
</p>
</li>
<li><p>the maximum expected information (MEI) criterion (van der Linden, 1998),
</p>
</li>
<li><p>the minimum expected posterior variance (MEPV),
</p>
</li>
<li><p>the Kullback-Leibler (KL) divergency criterion (Chang and Ying, 1996),
</p>
</li>
<li><p>the posterior Kullback-Leibler (KLP) criterion (Chang and Ying, 1996),
</p>
</li>
<li><p>the progressive method (Barrada, Olea, Ponsoda, and Abad, 2008, 2010; Revuelta and Ponsoda, 1998),
</p>
</li>
<li><p>the proportional method (Barrada, Olea, Ponsoda, and Abad, 2008, 2010; Segall, 2004),
</p>
</li>
<li><p>the global-discrimination index (GDI) (Kaplan, de la Torre, and Barrada, 2015),
</p>
</li>
<li><p>the posterior global-discrimination index (GDIP) (Kaplan, de la Torre, and Barrada, 2015),
</p>
</li>
<li><p>or by selecting the next item completely <em>randomly</em> among the available items.
</p>
</li></ol>

<p>The MFI criterion selects the next item as the one which maximizes the item information function (Baker, 1992). The most informative item is selected from the item informations computed from the bank of items specified with <code>itemBank</code>. 
</p>
<p>The so-called <code>bOpt</code> method (formerly referred to as <em>Urry's procedure</em>) consists in selecting as next the item whose difficulty level is closest to the current ability estimate. Under the 1PL model, both bOpt and MFI methods are equivalent. This method is not available with polytomous items.
</p>
<p>The so-called <code>thOpt</code> method consists in selecting the item for which optimal <code class="reqn">\theta</code> value (that is, the value <code class="reqn">\theta^*</code> for which item information is maximal) is closest to the current ability estimate. Under the 1PL and 2PL models, both bOpt and thOpt methods are equivalent. This method is not available with polytomous items.
</p>
<p>The MLWI and MPWI criteria select the next item as the one with maximal information, weighted either by the likelihood function or the posterior distribution. See the function <code><a href="#topic+MWI">MWI</a></code> for further details. 
</p>
<p>The MEI criterion selects the item with maximum expected information, computed with the <code><a href="#topic+MEI">MEI</a></code> function. 
</p>
<p>The MEPV criterion selects the item with minimum expected posterior variance, computed with the <code><a href="#topic+EPV">EPV</a></code> function.
</p>
<p>The KL and KLP criteria select the item with maximum Kullback-Leibler (KL) information (or the posterior KL information in case of KLP criterion). This information is computed by the <code><a href="#topic+KL">KL</a></code> function.
</p>
<p>With the progressive method the item selected is the one that maximizes the sum of two elements, a random part and a part determined by the Fisher information. At the beginning of the test, the importance of the random element is maximum; as the test advances, the information increases its relevance in the item selection. The speed for the transition from purely random selection to purely information based selection is determined by the acceleration parameter, set by the argument <code>AP</code>, where higher values imply a greater importance of the random element during the test. This method is not available with <code>rule="classification"</code>.
</p>
<p>In the proportional method the items are randomly selected with probabilities of selection determined by their Fisher information  raised to a given power. This power is equal to 0 at the beginning of the test and increases as the test advances. This implies that the test starts with completely random selection and approaches the MFI at the end of the test. Here, the acceleration parameter, set by the argument <code>AP</code>, plays a similar role than with the progressive method. This method is not available with <code>rule="classification"</code>.
</p>
<p>The GDI and GDIP criteria select the item with maximum global-discrimination index (GDI),  or the posterior GDI  in case of GDIP criterion. This index is computed by the <code><a href="#topic+GDI">GDI</a></code> function.
</p>
<p>The method for next item selection is specified by the <code>criterion</code> argument. Possible values are <code>"MFI"</code> for maximum Fisher information criterion, <code>"bOpt"</code> for bOpt's method, <code>"thOpt"</code> for the eponym method, <code>"MLWI"</code> for maximum likelihood weighted information criterion, <code>"MPWI"</code> for the maximum posterior weighted information criterion, <code>"MEI"</code> for the maximum expected information criterion, <code>"MEPV"</code> for minimum expected posterior variance, <code>"KL"</code> for Kullback-Leibler information method, <code>"KLP"</code> for posterior Kullback-Leibler information method, <code>"progressive"</code> for the progressive method, <code>"proportional"</code> for the proportional method, <code>"GDI"</code> for global-discrimination index method, <code>"KLP"</code> for posterior global-discrimination index method, and <code>"random"</code> for random selection. Other values return an error message. 
</p>
<p>For all methods but MLWI, MPWI, GDI, GDIP and random criteria, the provisional ability estimate must be supplied throught the <code>theta</code> argument (by default, it is equal to zero). For MLWI, MPWI, G and random criteria, this argument is ignored. 
</p>
<p>The available items are those that are not specified in the <code>out</code> argument. By default, <code>out</code> is <code>NULL</code>, which means that all items are available. Typically <code>out</code> contains the item numbers that have been already administered. Alternatively one can reduce the number of available items by specifying the argument <code>nAvailable</code> appropriately. The latter is a vector of 0 and 1 values, where 1 corresponds to an available item and 0 to a non-availbale item. It works similarly as for the function <code><a href="#topic+startItems">startItems</a></code>. If both <code>out</code> and <code>nAvailable</code> are supplied, then all items from both vectors are discarded for next item selection.
</p>
<p>For MEI, MEPV, MLWI, MPWI, KL, KLP, GDI, and GDIP methods, the provisional response pattern must be provided through the <code>x</code> argument. It must be of 0/1 entries and of the same length as the <code>out</code> argument. It is ignored with MFI, bOpt, thOpt, progressive, proportional and random criteria. Moreover, the range of integration (or posterior variance computation) is specified by the triplet <code>parInt</code>, where the first, second, and third value correspond to the arguments <code>lower</code>, <code>upper</code> and <code>nqp</code> of e.g., the <code><a href="#topic+MWI">MWI</a></code> function, respectively. 
</p>
<p>The <code>method</code>, <code>priorDist</code>, <code>priorPar</code>, <code>D</code>, <code>range</code> and <code>intPar</code> arguments fix the choice of the ability estimator for MEI method. See the <code><a href="#topic+thetaEst">thetaEst</a></code> function for further details. Note that <code>priorDist</code> and <code>priorPar</code> are also used to select the prior distribution with the MPWI and KLP methods. Finally, <code>parInt</code> is also used for numerical integration, among others for MLWI, MPWI, MEPV, KL and KLP methods. 
</p>
<p>Finally, for MEI criterion, the type of information function must be supplied through the <code>infoType</code> argument. It is equal to <code>"observed"</code> by default, which refers to the observed information function, and the other possible value is <code>"Fisher"</code> for Fisher information function. See the <code><a href="#topic+MEI">MEI</a></code> funtion for further details. This argument is ignored if <code>criterion</code> is not <code>"MEI"</code>.
</p>
<p>The so-called <em>randomesque</em> approach is used to improve item exposure control (Kingsbury and Zara, 1989), which consists in selecting more than one item as the best items to be administered (according to the specified <code>criterion</code>). The final item that is administered is randomly chosen among this set of optimal items.  The argument <code>randomesque</code> controls for the number of optimal items to be selected. The default value is 1, which corresponds to the usual framework of selecting the optimal item for next administration. Note that, for compatibility issues, if the number of remaining items is smaller than <code>randomesque</code>, the latter is replaced by this number of remaining items. The  <em>randomesque</em> approach is not considered with the progressive or proportional item selection rules.
</p>
<p>Dichotomous IRT models are considered whenever <code>model</code> is set to <code>NULL</code> (default value). In this case, <code>itemBank</code> must be a matrix with one row per item and four columns, with the values of the discrimination, the difficulty, the pseudo-guessing and the inattention parameters (in this order). These are the parameters of the four-parameter logistic (4PL) model (Barton and Lord, 1981). 
</p>
<p>Polytomous IRT models are specified by their respective acronym: <code>"GRM"</code> for Graded Response Model, <code>"MGRM"</code> for Modified Graded Response Model, <code>"PCM"</code> for Partical Credit Model, <code>"GPCM"</code> for Generalized Partial Credit Model, <code>"RSM"</code> for Rating Scale Model and <code>"NRM"</code> for Nominal Response Model. The <code>itemBank</code> still holds one row per item, end the number of columns and their content depends on the model. See <code><a href="#topic+genPolyMatrix">genPolyMatrix</a></code> for further information and illustrative examples of suitable polytomous item banks.
</p>
<p>Control for content balancing is also possible, given two conditions: (a) the <code>cbGroup</code> argument is a vector with the names of the subgroups of items for content balancing (one value per item), and (b) the argument <code>cbControl</code> is a correctly specified list. The correct format for <code>cbControl</code> is a list with two elements. The first one is called <code>names</code> and holds the names of the subgroups of items (in the order that is prespecified by the user). The second element is called <code>props</code> and contains the (theoretical) proportions of items to be administered from each subgroup for content balancing. These proportions must be strictly positive but may not sum to one; in this case they are internally normalized to sum to one. Note that <code>cbControl</code> should be tested with the <code><a href="#topic+test.cbList">test.cbList</a></code> function prior to using <code><a href="#topic+nextItem">nextItem</a></code>.
</p>
<p>Under content balancing, the selection of the next item is done in several steps.
</p>

<ol>
<li><p>If no item was administered yet, one subgroup is randomly picked up and the optimal item from this subgroup is selected.
</p>
</li>
<li><p>If at least one subgroup wasn't targeted yet by item selection, one of these subgroups is randomly picked up and the optimal item
from this subgroup is selected.
</p>
</li>
<li><p>If at least one item per subgroup was already administered, the empirical relative proportions of items administered per subgroup are computed, and 
the subgroup(s) whose difference between empirical and theoretical (i.e. given by <code>cbControl$props</code>) proportions is (are) selected. The optimal
item is then selected from this subgroup for next administration (in case of several such groups, one group is randomly picked up first).
</p>
</li></ol>

<p>See Kingsbury and Zara (1989) for further details.
</p>
<p>In case of content balancing control, three vectors of proportions are returned in the output list: <code>$prior.prop</code> contains the empirical relative proportions for items already administered (i.e.
passed through the <code>out</code> argument); <code>$post.prop</code> contains the same empirical relative proportions but including the optimal item that was just selected;
and <code>$th.prop</code> contains the theoretical proportions (i.e. those from <code>cbControl$props</code> or the normalized values). Note that <code>NA</code> values are returned when no control for content balancing is specified.
</p>


<h3>Value</h3>

<p>A list with nine arguments:
</p>
<table role = "presentation">
<tr><td><code>item</code></td>
<td>
<p>the selected item (identified by its number in the item bank).</p>
</td></tr>
<tr><td><code>par</code></td>
<td>
<p>the vector of item parameters of the selected item.</p>
</td></tr>
<tr><td><code>info</code></td>
<td>
<p>the value of the MFI, Fisher's information, the MLWI, the MPWI, the MEI, the EPV, the unsigned distance between estimated ability and difficulty parameter (or the ability value were maximum Fisher information is provided) or NA (for <code>"random"</code> criterion) for the selected item and the current ability estimate.</p>
</td></tr>
<tr><td><code>criterion</code></td>
<td>
<p>the value of the <code>criterion</code> argument.</p>
</td></tr>
<tr><td><code>randomesque</code></td>
<td>
<p>the value of the <code>randomesque</code> argument.</p>
</td></tr>
<tr><td><code>name</code></td>
<td>
<p>either the name of the selected item (provided as the row name of the appropriate row in the item bank matrix) or <code>NULL</code>.</p>
</td></tr>
<tr><td><code>prior.prop</code></td>
<td>
<p>a vector with empirical proportions of items previously administered for each subgroup of items set by <code>cbControl</code>.</p>
</td></tr>
<tr><td><code>post.prop</code></td>
<td>
<p>a vector with empirical proportions of items previously administered, together with the one currently selected, for each subgroup
of items set by <code>cbControl</code>.</p>
</td></tr>
<tr><td><code>th.prop</code></td>
<td>
<p>a vector with theoretical proportions given by <code>cbControl$props</code>.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>van der linden (1998) also introduced the Maximum Expected Posterior Weighted Information (MEPWI) criterion, as
a mix of both MEI and MPWI methods (see also van der Linden and Pashley, 2000). However, Choi and Swartz (2009) established that this method is completely equivalent to
MPWI. For this reason, MEPWI was not implemented here. 
</p>


<h3>Author(s)</h3>

<p>David Magis <br />
Department of Psychology, University of Liege, Belgium <br />
<a href="mailto:david.magis@uliege.be">david.magis@uliege.be</a>
</p>
<p>Juan Ramon Barrada <br />
Department of Psychology and Sociology, Universidad Zaragoza, Spain <br />
<a href="mailto:barrada@unizar.es">barrada@unizar.es</a>
</p>
<p>Guido Corradi <br />
Department of Psychology and Sociology, Universidad Zaragoza, Spain <br />
<a href="mailto:guidocor@gmail.com">guidocor@gmail.com</a>
</p>


<h3>References</h3>

<p>Baker, F.B. (1992). <em>Item response theory: parameter estimation techniques</em>. New York, NY: Marcel Dekker.
</p>
<p>Barrada, J. R., Mazuela, P., and Olea, J. (2006). Maximum information stratification method for controlling item exposure in computerized adaptive testing. <em>Psicothema, 18</em>, 156-159. 
</p>
<p>Barrada, J. R., Olea, J., Ponsoda, V., and Abad, F. J. (2008). Incorporating randomness to the Fisher information for improving item exposure control in CATS. <em>British Journal of Mathematical and Statistical Psychology, 61</em>, 493-513. doi: <a href="https://doi.org/10.1348/000711007X230937">10.1348/000711007X230937</a>
</p>
<p>Barrada, J. R., Olea, J., Ponsoda, V., and Abad, F. J. (2010). A method for the comparison of item selection rules in computerized adaptive testing. <em>Applied Psychological Measurement</em>, <em>34</em>, 438-452. doi: <a href="https://doi.org/10.1177/0146621610370152">10.1177/0146621610370152</a>
</p>
<p>Barton, M.A., and Lord, F.M. (1981). <em>An upper asymptote for the three-parameter logistic item-response model</em>.
Research Bulletin 81-20. Princeton, NJ: Educational Testing Service.
</p>
<p>Chang, H.-H., and Ying, Z. (1996). A global information approach to computerized adaptive testing. <em>Applied Psychological Measurement, 20</em>, 213-229. doi: <a href="https://doi.org/10.1177/014662169602000303">10.1177/014662169602000303</a>
</p>
<p>Choi, S. W., and Swartz, R. J. (2009). Comparison of CAT item selection criteria for polytomous items. <em>Applied Psychological Measurement, 32</em>, 419-440. doi: <a href="https://doi.org/10.1177/0146621608327801">10.1177/0146621608327801</a>
</p>
<p>Haley, D.C. (1952). <em>Estimation of the dosage mortality relationship when the dose is subject to error</em>. Technical report no 15. Palo Alto, CA: Applied Mathematics and Statistics Laboratory, Stanford University. 
</p>
<p>Kaplan, M., de la Torre, J., and Barrada, J. R. (2015). New item selection methods for cognitive diagnosis computerized adaptive testing. <em>Applied Psychological Measurement, 39</em>, 167-188. doi: <a href="https://doi.org/10.1177/0146621614554650">10.1177/0146621614554650</a>
</p>
<p>Kingsbury, G. G., and Zara, A. R. (1989). Procedures for selecting items for computerized adaptive tests. <em>Applied Measurement in Education, 2</em>, 359-375. doi: <a href="https://doi.org/10.1207/s15324818ame0204_6">10.1207/s15324818ame0204_6</a>
</p>
<p>Leroux, A. J., Lopez, M., Hembry, I. and Dodd, B. G. (2013). A comparison of exposure control procedures in CATs using the 3PL model. <em>Educational and Psychological Measurement, 73</em>, 857-874. doi: <a href="https://doi.org/10.1177/0013164413486802">10.1177/0013164413486802</a>
</p>
<p>Magis, D. (2013). A note on the item information function of the four-parameter logistic model. <em>Applied Psychological Measurement, 37</em>, 304-315. doi: <a href="https://doi.org/10.1177/0146621613475471">10.1177/0146621613475471</a>
</p>
<p>Magis, D. and Barrada, J. R. (2017). Computerized Adaptive Testing with R: Recent Updates of the Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>Code Snippets</em>, <em>76(1)</em>, 1-18. doi: <a href="https://doi.org/10.18637/jss.v076.c01">10.18637/jss.v076.c01</a>
</p>
<p>Magis, D., and Raiche, G. (2012). Random Generation of Response Patterns under Computerized Adaptive Testing with the R Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>48 (8)</em>, 1-31. doi: <a href="https://doi.org/10.18637/jss.v048.i08">10.18637/jss.v048.i08</a>
</p>
<p>Revuelta, J., and Ponsoda, V. (1998). A comparison of item exposure control methods in computerized adaptive testing. <em>Journal of Educational Measurement, 35</em>, 311-327. doi: <a href="https://doi.org/10.1111/j.1745-3984.1998.tb00541.x">10.1111/j.1745-3984.1998.tb00541.x</a>
</p>
<p>Segall, D. O. (2004). A sharing item response theory model for computerized adaptive testing. <em>Journal of Educational and Behavioral Statistics, 29</em>, 439-460. doi: <a href="https://doi.org/10.3102/10769986029004439">10.3102/10769986029004439</a>
</p>
<p>Urry, V. W. (1970). <em>A Monte Carlo investigation of logistic test models.</em> Unpublished doctoral dissertation. West Lafayette, IN: Purdue University.
</p>
<p>van der Linden, W. J. (1998). Bayesian item selection criteria for adaptive testing. <em>Psychometrika, 63</em>, 201-216. doi: <a href="https://doi.org/10.1007/BF02294775">10.1007/BF02294775</a>
</p>
<p>van der Linden, W. J., and Pashley, P. J. (2000). Item selection and ability estimation in adaptive testing. In W. J. van der Linden and C. A. W. Glas (Eds.), <em>Computerized adaptive testing. Theory and practice</em> (pp. 1-25). Boston, MA: Kluwer. 
</p>
<p>Veerkamp, W. J. J., and Berger, M. P. F. (1997). Some new item selection criteria for adaptive testing. <em>Journal of Educational and Behavioral Statistics, 22</em>, 203-226. doi: <a href="https://doi.org/10.3102/10769986022002203">10.3102/10769986022002203</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MWI">MWI</a></code>, <code><a href="#topic+MEI">MEI</a></code>, <code><a href="#topic+KL">KL</a></code>, <code><a href="#topic+thetaEst">thetaEst</a></code>, <code><a href="#topic+test.cbList">test.cbList</a></code>, <code><a href="#topic+randomCAT">randomCAT</a></code>, <code><a href="#topic+genPolyMatrix">genPolyMatrix</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Dichotomous models ##

 # Loading the 'tcals' parameters 
 data(tcals)
 
 # Item bank creation with 'tcals' item parameters
 prov &lt;- breakBank(tcals)
 bank &lt;- prov$itemPar
 cbGroup &lt;- prov$cbGroup

 ## MFI criterion

 # Selecting the next item, current ability estimate is 0
 nextItem(bank, theta = 0) # item 63 is selected

 # Selecting the next item, current ability estimate is 0 and item 63 is removed
 nextItem(bank, theta = 0, out = 63) # item 10 is selected

 # Selecting the next item, current ability estimate is 0 and items 63 and 10 are 
 # removed
 nextItem(bank, theta = 0, out = c(63, 10)) # item 62 is selected

 # Item exposure control by selecting three items (selected item will be either 10, 62 
 # or 63)
 nextItem(bank, theta = 0, randomesque = 3)

 # Fixing the random seed for randomesque selection
 nextItem(bank, theta = 0, randomesque = 3, random.seed = 1)


 ## bOpt method

 # Selecting the next item, current ability estimate is 0
 nextItem(bank, theta = 0, criterion = "bOpt") # item 24 is selected

 # Selecting the next item, current ability estimate is 0 and item 24 is removed
 nextItem(bank, theta = 0, out = 24, criterion = "bOpt")


 ## thOpt method

 # Selecting the next item, current ability estimate is 0
 nextItem(bank, theta = 0, criterion = "thOpt") # item 76 is selected

 # Selecting the next item, current ability estimate is 0 and item 76 is removed
 nextItem(bank, theta = 0, out = 76, criterion = "thOpt") # item 70 is selected


 ## MLWI and MPWI methods

 # Selecting the next item, current response pattern is 0 and item 63 was administered 
 # first
 nextItem(bank, x = 0, out = 63, criterion = "MLWI") 
 nextItem(bank, x = 0, out = 63, criterion = "MPWI")

 # Selecting the next item, current response pattern is (0,1) and item 19 is removed
 nextItem(bank, x = c(0, 1), out = c(63, 19), criterion = "MLWI")
 nextItem(bank, x = c(0, 1), out = c(63, 19), criterion = "MPWI")

## Not run: 

 ## MEI method

 # Selecting the next item, current response pattern is 0 and item 63 was administered 
 # first
 # Ability estimation by WL method
 th &lt;- thetaEst(rbind(bank[63,]), 0, method = "WL")
 nextItem(bank, x = 0, out = 63, theta = th, criterion = "MEI") # item 49 is selected

 # With Fisher information
 nextItem(bank, x = 0, out = 63, theta = th, criterion = "MEI", infoType = "Fisher") 
   # item 10 is selected


 ## MEPV method

 # Selecting the next item, current response pattern is 0 and item 63 was administered 
 # first
 # Ability estimation by WL method
 nextItem(bank, x = 0, out = 63, theta = th, criterion = "MEPV") # item 19 is selected


 ## KL and KLP methods

 # Selecting the next item, current response pattern is 0 and item 63 was administered 
 # first
 # Ability estimation by WL method
 nextItem(bank, x = 0, out = 63, theta = th, criterion = "KL") # item 19 is selected
 nextItem(bank, x = 0, out = 63, theta = th, criterion = "KLP") # item 44 is selected


## GDI and GDIP methods

 # Selecting the next item, current response pattern is 0 and item 63 was administered 
 # first
 nextItem(bank, x = 0, out = 63, criterion = "GDI") # item 49 is selected
 nextItem(bank, x = 0, out = 63, criterion = "GDIP") # item 44 is selected


 ## Progressive method

 # Selecting the next item, current ability estimate is 0 and item 63 was administered 
 # first
 # (default options: "length" rule with "thr = 20")
 nextItem(bank, out = 63, theta = 0, criterion = "progressive") 
 nextItem(bank, out = 63, theta = 0, criterion = "progressive")
  # result can be different!


 ## Proportional method

 # Selecting the next item, current ability estimate is 0 and item 63 was administered 
 # first
 # (default options: "length" rule with "thr = 20")
 nextItem(bank, out = 63, theta = 0, criterion = "proportional") 
 nextItem(bank, out = 63, theta = 0, criterion = "proportional")
  # result can be different!


 ## Random method

 # Selecting the next item, item 63 was administered first
 nextItem(bank, out = 63, criterion = "random") 
 nextItem(bank, out = 63, criterion = "random")  # may produce a different result


 ## Content balancing

 # Creation of the 'cbList' list with arbitrary proportions
 cbList &lt;- list(names = c("Audio1", "Audio2", "Written1", "Written2", "Written3"), 
        props = c(0.1, 0.2, 0.2, 0.2, 0.3))

 # Selecting the next item, MFI criterion, current ability estimate is 0, items 12, 33, 
 # 46 and 63 previously administered
 nextItem(bank, theta = 0, out = c(12, 33, 46, 63), cbControl = cbList, 
          cbGroup = cbGroup)  # item 70 is selected


## Polytomous models ##

 # Generation of an item bank under GRM with 100 items and at most 4 categories
 m.GRM &lt;- genPolyMatrix(100, 4, "GRM")
 m.GRM &lt;- as.matrix(m.GRM)

 # Current ability estimate is 0
 # Selecting the next item, current response pattern is 1 and item 70 was administered 
 # first

 ## MFI method
 nextItem(m.GRM, model = "GRM", theta = 0, criterion = "MFI", out = 70)

 ## Progressive method
 nextItem(m.GRM, model = "GRM", theta = 0, criterion = "progressive", out = 70)

 ## KL method
 nextItem(m.GRM, model = "GRM", theta = 0, criterion = "KL", out = 70, x = 1)

 ## MFI with content balancing
 cbList &lt;- list(names = c("Audio1","Audio2","Written1","Written2", "Written3"), 
        props = c(0.1,0.2,0.2,0.2,0.3))
 m.GRM&lt;-genPolyMatrix(100, 4, model = "GRM", cbControl = cbList)
 bank&lt;-breakBank(m.GRM)
 nextItem(bank$itemPar, model = "GRM", theta = 0, criterion = "MFI", out = 70,
  cbControl = cbList, cbGroup = bank$cbGroup)


 # Loading the cat_pav data
 data(cat_pav)
 cat_pav &lt;- as.matrix(cat_pav)

 # Current ability estimate is 0
 # Selecting the next item, current response pattern is 1 and item 15 was administered 
 # first

 ## MFI method
 nextItem(cat_pav, model = "GPCM", theta = 0, criterion = "MFI", out = 15)

 ## Progressive method
 nextItem(cat_pav, model = "GPCM", theta = 0, criterion = "progressive", out = 15)

 ## KL method
 nextItem(cat_pav, model = "GPCM", theta = 0, criterion = "KL", out = 15, x = 1)

 ## MFI with content balancing
 cbList &lt;- list(names = c("Audio1", "Audio2", "Written1", "Written2", "Written3"), 
        props = c(0.1, 0.2, 0.2, 0.2, 0.3))
 cat_pav&lt;-genPolyMatrix(100, 4, model = "GPCM", cbControl = cbList)
 bank&lt;-breakBank(cat_pav)
 nextItem(bank$itemPar, model = "GPCM", theta = 0, criterion = "MFI", out = 15, 
          cbControl = cbList, cbGroup = bank$cbGroup)
 
## End(Not run)
</code></pre>

<hr>
<h2 id='OIi'>Observed information function (dichotomous and polytomous models)</h2><span id='topic+OIi'></span>

<h3>Description</h3>

<p>This command returns the observed information functions for a given ability value and a given matrix of item parameters, either under the 4PL model or any suitable polytomous IRT model. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>OIi(th, it, x, model = NULL, D = 1)
 </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="OIi_+3A_th">th</code></td>
<td>
<p>numeric: the ability value.</p>
</td></tr>
<tr><td><code id="OIi_+3A_it">it</code></td>
<td>
<p>numeric: a suitable matrix of item parameters. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="OIi_+3A_x">x</code></td>
<td>
<p>numeric: a vector of item responses.</p>
</td></tr>
<tr><td><code id="OIi_+3A_model">model</code></td>
<td>
<p>either <code>NULL</code> (default) for dichotomous models, or any suitable acronym for polytomous models. Possible values are <code>"GRM"</code>, <code>"MGRM"</code>, <code>"PCM"</code>, <code>"GPCM"</code>, <code>"RSM"</code> and <code>"NRM"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="OIi_+3A_d">D</code></td>
<td>
<p>numeric: the metric constant. Default is <code>D=1</code> (for logistic metric); <code>D=1.702</code> yields approximately the normal metric (Haley, 1952). Ignored if <code>model</code> is not <code>NULL</code>.</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>The observed information function for item <em>j</em> is given by
</p>
<p style="text-align: center;"><code class="reqn">OI_j= -\frac{\partial^2}{\partial \theta^2} \,\log L(\theta | x_j)</code>
</p>

<p>where <code class="reqn">\theta</code> is the ability level, <code class="reqn">L</code> is the likelihood function and <code class="reqn">x_j</code> is the item response. 
</p>
<p>For dichotomous IRT models with success probability <code class="reqn">P_j(\theta)</code>, it takes the following form:
</p>
<p style="text-align: center;"><code class="reqn">OI_j = \frac{P_j \,Q_j \,{P_j'}^2- (x_j-P_j) \,[P_j \,Q_j \,P_j'' + {P_j}^2 \,(P_j-Q_j]}{{P_j}^2 \,{Q_j}^2}</code>
</p>

<p>where <code class="reqn">P_j=P_j(\theta)</code>, <code class="reqn">Q_j=1-P_j</code> and <code class="reqn">P_j'</code> and <code class="reqn">P_j''</code> are the first and second derivatives of <code class="reqn">P_j</code> respectively. 
</p>
<p>For polytomous IRT models, set $X_j$ as the item response, taking values <code class="reqn">k \in \{0, 1, ..., g_j\}</code>. Set <code class="reqn">P_{jk}(\theta)=Pr(X_j=k | \theta)</code> as the probability of answering response category <code class="reqn">k</code> and set <code class="reqn">\tau_{jk}</code> as the boolean factor equal to 1 if <code class="reqn">X_j=k</code> and 0 otherwise. Then, the observed information function for item <code class="reqn">j</code> takes the following form:
</p>
<p style="text-align: center;"><code class="reqn">OI_j = \sum_{k=0}^{g_j} \tau_{jk}\,\left( \frac{{P_{jk}'(\theta)}^2}{{P_{jk}(\theta)}^2}-\frac{P_{jk}''(\theta)}{P_{jk}(\theta)}\right)</code>
</p>

<p>with the same notations for the first and second derivatives as above.
</p>
<p>Under the 2PL model, the observed information function is exactly equal to Fisher's information function
</p>
<p style="text-align: center;"><code class="reqn">I_j=-E \left[\frac{\partial^2}{\partial \theta^2} \,\log L(\theta | x_j)\right] = \frac{{P_j'}^2}{P_j Q_j}</code>
</p>

<p>(van der Linden, 1998; Veerkamp, 1996).
</p>
<p>Dichotomous IRT models are considered whenever <code>model</code> is set to <code>NULL</code> (default value). In this case, <code>it</code> must be a matrix with one row per item and four columns, with the values of the discrimination, the difficulty, the pseudo-guessing and the inattention parameters (in this order). These are the parameters of the four-parameter logistic (4PL) model
(Barton and Lord, 1981). 
</p>
<p>Polytomous IRT models are specified by their respective acronym: <code>"GRM"</code> for Graded Response Model, <code>"MGRM"</code> for Modified Graded Response Model, <code>"PCM"</code> for Partical Credit Model, <code>"GPCM"</code> for Generalized Partial Credit Model, <code>"RSM"</code> for Rating Scale Model and <code>"NRM"</code> for Nominal Response Model. The <code>it</code> still holds one row per item, end the number of columns and their content depends on the model. See <code><a href="#topic+genPolyMatrix">genPolyMatrix</a></code> for further information and illustrative examples of suitable polytomous item banks.
</p>
<p>The observed information function is used to compute some item selection criteria, such as the Maximum Expected Information (MEI). See <code><a href="#topic+nextItem">nextItem</a></code> and <code><a href="#topic+MEI">MEI</a></code> for further details.
</p>


<h3>Value</h3>

<p>A vector with the observed item informations (one per item).
</p>


<h3>Author(s)</h3>

<p>David Magis <br />
Department of Psychology, University of Liege, Belgium <br />
<a href="mailto:david.magis@uliege.be">david.magis@uliege.be</a>
</p>


<h3>References</h3>

<p>Barton, M.A., and Lord, F.M. (1981). <em>An upper asymptote for the three-parameter logistic item-response model</em>.
Research Bulletin 81-20. Princeton, NJ: Educational Testing Service.
</p>
<p>Haley, D.C. (1952). <em>Estimation of the dosage mortality relationship when the dose is subject to error</em>. Technical report no 15. Palo Alto, CA: Applied Mathematics and Statistics Laboratory, Stanford University.
</p>
<p>Magis, D. and Barrada, J. R. (2017). Computerized Adaptive Testing with R: Recent Updates of the Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>Code Snippets</em>, <em>76(1)</em>, 1-18. doi: <a href="https://doi.org/10.18637/jss.v076.c01">10.18637/jss.v076.c01</a>
</p>
<p>Magis, D., and Raiche, G. (2012). Random Generation of Response Patterns under Computerized Adaptive Testing with the R Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>48 (8)</em>, 1-31. doi: <a href="https://doi.org/10.18637/jss.v048.i08">10.18637/jss.v048.i08</a>
</p>
<p>van der Linden, W. (1998). Bayesian item selection criteria for adaptive testing. <em>Psychometrika, 63</em>, 201-216. doi: <a href="https://doi.org/10.1007/BF02294775">10.1007/BF02294775</a>
</p>
<p>Veerkamp, W. J. J. (1996). <em>Statistical inference for adaptive testing</em>. Internal report. Enschede, The Netherlands: 
University of Twente. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+nextItem">nextItem</a></code>, <code><a href="#topic+MEI">MEI</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Dichotomous models ##

 # Loading the 'tcals' parameters 
 data(tcals)
 
 # Selecting item parameters only
 tcals &lt;- as.matrix(tcals[,1:4])
 
 # Observed information functions 
 # (various th, x and D values)
 OIi(th = 0, tcals, x = 0)
 OIi(th = 0, tcals, x = 0, D = 1.702)
 OIi(th = 0, tcals, x = 1)
 OIi(th = 1, tcals, x = 1)


## Polytomous models ##

 # Generation of an item bank under GRM with 100 items and at most 4 categories
 m.GRM &lt;- genPolyMatrix(100, 4, "GRM")
 m.GRM &lt;- as.matrix(m.GRM)

 # Creation of a response pattern (true ability level 0)
 set.seed(1)
 x &lt;- genPattern(0, m.GRM, model = "GRM")

 # Observed information functions (various th values)
 OIi(th = 0, m.GRM, x, model = "GRM")
 OIi(th = 1, m.GRM, x, model = "GRM")

 # Loading the cat_pav data
 data(cat_pav)
 cat_pav &lt;- as.matrix(cat_pav)

 # Creation of a response pattern (true ability level 0)
 set.seed(1)
 x &lt;- genPattern(0, cat_pav, model = "GPCM")

 # Observed information functions (various 'th' values)
 OIi(th = 0, cat_pav, x, model = "GPCM")
 OIi(th = 1, cat_pav, x, model = "GPCM")
 </code></pre>

<hr>
<h2 id='Pi'>Item response probabilities, first, second and third derivatives (dichotomous and polytomous models)</h2><span id='topic+Pi'></span>

<h3>Description</h3>

<p>This command returns the item response probabilities for a given ability value and a given matrix of item parameters under either the 4PL model or any suitable polytomous model. Numerical values of the first, second and third derivatives of the response probabilities are also returned.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Pi(th, it, model = NULL, D = 1)
 </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Pi_+3A_th">th</code></td>
<td>
<p>numeric: the ability value.</p>
</td></tr>
<tr><td><code id="Pi_+3A_it">it</code></td>
<td>
<p>numeric: a suitable matrix of item parameters. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="Pi_+3A_model">model</code></td>
<td>
<p>either <code>NULL</code> (default) for dichotomous models, or any suitable acronym for polytomous models. Possible values are <code>"GRM"</code>, <code>"MGRM"</code>, <code>"PCM"</code>, <code>"GPCM"</code>, <code>"RSM"</code> and <code>"NRM"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="Pi_+3A_d">D</code></td>
<td>
<p>numeric: the metric constant. Default is <code>D=1</code> (for logistic metric); <code>D=1.702</code> yields approximately the normal metric (Haley, 1952). Ignored if <code>model</code> is not <code>NULL</code>.</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>Whatever the IRT model, the response probabilities and first, second, and third derivatives are computed algebraically. These derivatives are necessary for both the estimation of ability and the computation of related standard errors. 
</p>
<p>Dichotomous IRT models are considered whenever <code>model</code> is set to <code>NULL</code> (default value). In this case, <code>it</code> must be a matrix with one row per item and four columns, with the values of the discrimination, the difficulty, the pseudo-guessing and the inattention parameters (in this order). These are the parameters of the four-parameter logistic (4PL) model
(Barton and Lord, 1981). 
</p>
<p>Polytomous IRT models are specified by their respective acronym: <code>"GRM"</code> for Graded Response Model (Samejima, 1969), <code>"MGRM"</code> for Modified Graded Response Model (Muraki, 1990), <code>"PCM"</code> for Partical Credit Model (Masters, 1982), <code>"GPCM"</code> for Generalized Partial Credit Model (Muraki, 1992), <code>"RSM"</code> for Rating Scale Model (Andrich, 1978) and <code>"NRM"</code> for Nominal Response Model (Bock, 1972). The <code>it</code> still holds one row per item, end the number of columns and their content depends on the model. See <code><a href="#topic+genPolyMatrix">genPolyMatrix</a></code> for further information and illustrative examples of suitable polytomous item banks.
</p>
<p>The output list contains the response probabilities and the respective derivatives. In case of dichotomous models, only a vector of such values is returned, with one value per item. In case of polytomous models, matrices are returned instead, with one row per item and one column per response category. In case of unequal numbers of response categories (which may happen under GRM, PCM, GPCM and NRM), values for empty response categories are returned as <code>NA</code> values.
</p>


<h3>Value</h3>

<p>Under dichotomous IRT models, a list with four arguments:
</p>
<table role = "presentation">
<tr><td><code>Pi</code></td>
<td>
<p>the vector with response probabilities (one value per item).</p>
</td></tr>
<tr><td><code>dPi</code></td>
<td>
<p>the vector with first derivatives of the response probabilities (one value per item).</p>
</td></tr>
<tr><td><code>d2Pi</code></td>
<td>
<p>the vector with second derivatives of the response probabilities (one value per item).</p>
</td></tr>
<tr><td><code>d3Pi</code></td>
<td>
<p>the vector with third derivatives of the response probabilities (one value per item).</p>
</td></tr>
</table>
<p>Under polytomous IRT models, the aforementioned vectors are replaced by matrices with one row per item (labeled as <code>Item1</code>, <code>Item2</code> etc.) and one row per response category. 
</p>


<h3>Note</h3>

<p>For dichotomous IRT models, response probabilites exactly equal to zero are returned as <code>1e-10</code> values, as well as probabilities exactly equal to one which are returned as <code>1-1e-10</code> values. This is to permit the computation of ability estimates (with the <code><a href="#topic+thetaEst">thetaEst</a></code> function) in such extreme cases.
</p>
<p>Many thanks to Pan Tong (University of Texas MD Anderson Cancer Center, USA) who noticed this problem.
</p>


<h3>Author(s)</h3>

<p>David Magis <br />
Department of Psychology, University of Liege, Belgium <br />
<a href="mailto:david.magis@uliege.be">david.magis@uliege.be</a>
</p>


<h3>References</h3>

<p>Andrich, D. (1978). A rating formulation for ordered response categories. <em>Psychometrika, 43</em>, 561-573. doi: <a href="https://doi.org/10.1007/BF02293814">10.1007/BF02293814</a>
</p>
<p>Barton, M.A., and Lord, F.M. (1981). <em>An upper asymptote for the three-parameter logistic item-response model</em>.
Research Bulletin 81-20. Princeton, NJ: Educational Testing Service.
</p>
<p>Bock, R. D. (1972). Estimating item parameters and latent ability when responses are scored in two or more nominal categories. <em>Psychometrika, 37</em>, 29-51. doi: <a href="https://doi.org/10.1007/BF02291411">10.1007/BF02291411</a>
</p>
<p>Haley, D.C. (1952). <em>Estimation of the dosage mortality relationship when the dose is subject to error</em>. Technical report no 15. Palo Alto, CA: Applied Mathematics and Statistics Laboratory, Stanford University. 
</p>
<p>Magis, D. and Barrada, J. R. (2017). Computerized Adaptive Testing with R: Recent Updates of the Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>Code Snippets</em>, <em>76(1)</em>, 1-18. doi: <a href="https://doi.org/10.18637/jss.v076.c01">10.18637/jss.v076.c01</a>
</p>
<p>Magis, D., and Raiche, G. (2012). Random Generation of Response Patterns under Computerized Adaptive Testing with the R Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>48 (8)</em>, 1-31. doi: <a href="https://doi.org/10.18637/jss.v048.i08">10.18637/jss.v048.i08</a>
</p>
<p>Masters, G. N. (1982). A Rasch model for partial credit scoring. <em>Psychometrika, 47</em>, 149-174. doi: <a href="https://doi.org/10.1007/BF02296272">10.1007/BF02296272</a>
</p>
<p>Muraki, E. (1990). Fitting a polytomous item response model to Likert-type data. <em>Applied Psychological Measurement, 14</em>, 59-71. doi: <a href="https://doi.org/10.1177/014662169001400106">10.1177/014662169001400106</a>
</p>
<p>Muraki, E. (1992). A generalized partial credit model: Application of an EM algorithm. <em>Applied Psychological Measurement, 16</em>, 19-176. doi: <a href="https://doi.org/10.1177/014662169201600206">10.1177/014662169201600206</a>
</p>
<p>Samejima, F. (1969). <em>Estimation of latent ability using a response pattern of graded scores</em>. Psychometrika Monograph (vol. 17).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Ii">Ii</a></code>, <code><a href="#topic+thetaEst">thetaEst</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Dichotomous models ##

 # Loading the 'tcals' parameters 
 data(tcals)
 
 # Selecting item parameters only
 tcals &lt;- as.matrix(tcals[,1:4])
 
 # Response probabilities and derivatives (various th and D values)
 Pi(th = 0, tcals)
 Pi(th = 0, tcals, D = 1.702)
 Pi(th = 1, tcals)

## Polytomous models ##

 # Generation of an item bank under GRM with 100 items and at most 4 categories
 m.GRM &lt;- genPolyMatrix(100, 4, "GRM")
 m.GRM &lt;- as.matrix(m.GRM)

 # Computation of probabilities and derivatives for ability level 0
 Pi(0, m.GRM, model = "GRM")

 # Loading the cat_pav data
 data(cat_pav)
 cat_pav &lt;- as.matrix(cat_pav)

 # Computation of probabilities and derivatives for ability level 1
 Pi(1, cat_pav, model = "GPCM")
 </code></pre>

<hr>
<h2 id='randomCAT'>Random generation of adaptive tests (dichotomous and polytomous models)</h2><span id='topic+randomCAT'></span><span id='topic+print.cat'></span><span id='topic+plot.cat'></span>

<h3>Description</h3>

<p>This command generates a response pattern to an adaptive test, for a given item bank (with either dichotomous or polytomous models), a true ability level, and several lists of CAT parameters (starting items, stopping rule, provisional and final ability estimators).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>randomCAT(trueTheta, itemBank, model = NULL, responses = NULL, min.length = 0, 
 	a.stratified = NULL, genSeed = NULL, cbControl = NULL, nAvailable = NULL, 
 	start = list(fixItems = NULL, seed = NULL, nrItems = 1, theta = 0, D = 1, 
 	randomesque = 1, random.seed = NULL, startSelect = "MFI", cb.control = FALSE, 
 	random.cb = NULL), test = list(method = "BM", priorDist = "norm", 
 	priorPar = c(0, 1), weight = "Huber", tuCo = 1, sem.type = "classic", 
 	sem.exact = FALSE, se.ase = 10, range = c(-4, 4), D = 1, parInt = c(-4, 4, 33), 
 	itemSelect = "MFI", infoType = "observed", randomesque = 1, 
 	random.seed = NULL, AP = 1, proRule = "length", proThr = 20, 
 	constantPatt = NULL), stop = list(rule = "length", thr = 20, alpha = 0.05), 
 	final = list(method = "BM", priorDist = "norm", priorPar = c(0, 1), 
 	weight = "Huber", tuCo = 1, sem.type = "classic", sem.exact = FALSE, 
 	range = c(-4, 4), D = 1, parInt = c(-4, 4, 33), alpha = 0.05), 
 	allTheta = FALSE, save.output = FALSE, output = c("path", "name", "csv"))
## S3 method for class 'cat'
print(x, ...)
## S3 method for class 'cat'
plot(x, ci = FALSE, alpha = 0.05, trueTh = TRUE, classThr = NULL, 
 	save.plot = FALSE, save.options = c("path", "name", "pdf"),...)
 </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="randomCAT_+3A_truetheta">trueTheta</code></td>
<td>
<p>numeric: the value of the true ability level.</p>
</td></tr>
<tr><td><code id="randomCAT_+3A_itembank">itemBank</code></td>
<td>
<p>numeric: a suitable matrix of item parameters (possibly augmented by group membership for content balancing). See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="randomCAT_+3A_model">model</code></td>
<td>
<p>either <code>NULL</code> (default) for dichotomous models, or any suitable acronym for polytomous models. Possible values are <code>"GRM"</code>, <code>"MGRM"</code>, <code>"PCM"</code>, <code>"GPCM"</code>, <code>"RSM"</code> and <code>"NRM"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="randomCAT_+3A_responses">responses</code></td>
<td>
<p>either <code>NULL</code> (default) or a vector of pre-specified item responses with as many components as the rows of <code>itemBank</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="randomCAT_+3A_min.length">min.length</code></td>
<td>
<p>integer: the minimum number of items to administer default is zero so no minimum test length). The CAT will not stop before the number of administered items equals <code>min.length</code>, even if the stopping rule is satisfied.</p>
</td></tr>
<tr><td><code id="randomCAT_+3A_a.stratified">a.stratified</code></td>
<td>
<p>either <code>NULL</code> (default), an integer value or a vector of integer values to set up a-stratified sampling. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="randomCAT_+3A_genseed">genSeed</code></td>
<td>
<p>either a numeric value to fix the random generation of responses pattern or <code>NULL</code> (default). Ignored if <code>responses</code> is not <code>NULL</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="randomCAT_+3A_cbcontrol">cbControl</code></td>
<td>
<p>either a list of accurate format to control for content balancing, or <code>NULL</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="randomCAT_+3A_navailable">nAvailable</code></td>
<td>
<p>either a boolean vector indicating which items (denoted by 1's) are available at the start of the test and which (denoted by 0's) are not, or <code>NULL</code> (default). See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="randomCAT_+3A_start">start</code></td>
<td>
<p>a list with the options for starting the adaptive test. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="randomCAT_+3A_test">test</code></td>
<td>
<p>a list with the options for provisional ability estimation and next item selection. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="randomCAT_+3A_stop">stop</code></td>
<td>
<p>a list with the options of the stopping rule. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="randomCAT_+3A_final">final</code></td>
<td>
<p>a list with the options for final ability estimation. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="randomCAT_+3A_alltheta">allTheta</code></td>
<td>
<p>logical: should all provisional ability estimates and standard errors be computed and returned (including among the starting items)? Default is <code>FALSE</code>, meaning that provisional ability estimates and standard errors are computed only after the selection of the starting items. Ignored if the <code>$nrItems</code> of the <code>start</code> list is equal to zero.</p>
</td></tr>
<tr><td><code id="randomCAT_+3A_save.output">save.output</code></td>
<td>
<p>logical: should the output be saved in an external text file? (default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="randomCAT_+3A_output">output</code></td>
<td>
<p>character: a vector of three components. The first component is either the file path to save the output of <code>"path"</code> (default), the second component is the name of the output file, and the third component is the file type, either <code>"txt"</code> or <code>"csv"</code> (default). See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="randomCAT_+3A_x">x</code></td>
<td>
<p>an object of class &quot;cat&quot;, typically an output of <code>randomCAT</code> function.</p>
</td></tr>
<tr><td><code id="randomCAT_+3A_ci">ci</code></td>
<td>
<p>logical: should the confidence intervals be plotted for each provisional ability estimate? (default is <code>TRUE</code>).</p>
</td></tr>
<tr><td><code id="randomCAT_+3A_alpha">alpha</code></td>
<td>
<p>numeric: the significance level for provisional confidence intervals (default is 0.05). Ignored if <code>ci</code> is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="randomCAT_+3A_trueth">trueTh</code></td>
<td>
<p>logical: should the true ability level be drawn by a horizontal line? (default is TRUE).</p>
</td></tr>
<tr><td><code id="randomCAT_+3A_classthr">classThr</code></td>
<td>
<p>either a numeric value giving the classification threshold to be displayed, or <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="randomCAT_+3A_save.plot">save.plot</code></td>
<td>
<p>logical: should the plot be saved in an external figure? (default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="randomCAT_+3A_save.options">save.options</code></td>
<td>
<p>character: a vector of three components. The first component is either the file path or <code>"path"</code> (default), the second component is the name of the output file or ,<code>"name"</code> (default), and the third component is the file extension, either <code>"pdf"</code> (default) or <code>"jpeg"</code>. Ignored if <code>save.plot</code> is <code>FALSE</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="randomCAT_+3A_...">...</code></td>
<td>
<p>other generic arguments to be passed to <code>print</code> and <code>plot</code> functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>randomCAT</code> function generates an adaptive test using an item bank specified by arguments <code>itemBank</code> and <code>model</code>, and for a given true ability level specified by argument <code>trueTheta</code>. 
</p>
<p>Dichotomous IRT models are considered whenever <code>model</code> is set to <code>NULL</code> (default value). In this case, <code>itemBank</code> must be a matrix with one row per item and four columns, with the values of the discrimination, the difficulty, the pseudo-guessing and the inattention parameters (in this order). These are the parameters of the four-parameter logistic (4PL) model (Barton and Lord, 1981). 
</p>
<p>Polytomous IRT models are specified by their respective acronym: <code>"GRM"</code> for Graded Response Model, <code>"MGRM"</code> for Modified Graded Response Model, <code>"PCM"</code> for Partical Credit Model, <code>"GPCM"</code> for Generalized Partial Credit Model, <code>"RSM"</code> for Rating Scale Model and <code>"NRM"</code> for Nominal Response Model. The <code>itemBank</code> still holds one row per item, end the number of columns and their content depends on the model. See <code><a href="#topic+genPolyMatrix">genPolyMatrix</a></code> for further information and illustrative examples of suitable polytomous item banks.
</p>
<p>By default all item responses will be randomly drawn from parent distribution set by the item bank parameters of the <code>itemBank</code> matrix (using the <code><a href="#topic+genPattern">genPattern</a></code> function for instance). Moreover, the random generation of the item responses can be fixed (for e.g., replication purposes) by assigning some numeric value to the <code>genSeed</code> argument. By default this argument is equal to <code>NULL</code> so the random seed is not fixed (and two successive runs of <code>randomCAT</code> will usually lead to different response patterns).
</p>
<p>It is possible, however, to provide a full response pattern of previously recorded responses to each of the item bank, for instance for post-hoc simulations. This is done by providing to the <code>responses</code> argument a vector of binary entries (without missing values). By default <code>responses</code> is set to <code>NULL</code> and item responses will be drawn from the item bank parameters.
</p>
<p>With the aforementioned item bank structures, content balancing cannot be controled and <code>cbControl</code> must be set to <code>NULL</code> (default value). Otherwise this will most often lead to an error. In order to allow for content balancing control:
</p>

<ol>
<li><p>the <code>itemBank</code> must be updated with an additional column holding the group names;
</p>
</li>
<li><p>the <code>cbControl</code> argument must be set properly as a list with group names and theoretical proportions for content balancing.
</p>
</li></ol>

<p>See the <code><a href="#topic+nextItem">nextItem</a></code> function for further details on how to specify <code>cbControl</code> properly and under which conditions it is operational (see Kingsbury and Zara, 1989, for further details). Separation of the item parameters and the vector of group membership is performed internally through the <code><a href="#topic+breakBank">breakBank</a></code> function (and thus should not be performed prior to CAT generation).
</p>
<p>An alternative method to control for content balancing is to performed a-stratified sampling (Chang and Ying, 1999). This is specified by providing the <code>a.stratified</code> argument either an integer value (i.e., the number of strata) or a vector of integer values (i.e., the number of items per strata). The value to be provided corresponds to the <code>K</code> argument of the <code><a href="#topic+aStratified">aStratified</a></code> function. Note that this is allowed only with dichotomous IRT models and polytomous GRM, MGRM and GPCM models. By default, <code>a.stratified</code> is <code>NULL</code> and a-stratified sampling is not performed.
</p>
<p>The test specification is made by means of four lists of options: one list for the selection of the starting items, 
one list with the options for provisional ability estimation, one list to define the stopping rule, and one list with
the options for final ability estimation. These lists are specified respectively by the arguments <code>start</code>, <code>test</code>, <code>stop</code> and <code>final</code>. 
</p>
<p>The <code>start</code> list can contain one or several of the following arguments:
</p>

<ul>
<li><p><code>fixItems</code>: either a vector of integer values, setting the items to be administered as first items, or <code>NULL</code> (default) to let the function select the items.
</p>
</li>
<li><p><code>seed</code>: either a numeric value to fix the random seed for item selection, <code>NA</code> to randomly select the items withour fixing the random seed, or <code>NULL</code> (default) to select the items on the basis of their difficulty level. Ignored if <code>fixItems</code> is not <code>NULL</code>.
</p>
</li>
<li><p><code>nrItems</code>: numeric, the number of starting items to be randomly selected (default is 1). Can be equal to zero to avoid initial selection of items (see <b>Details</b>). Used only if <code>fixItems</code> is <code>NULL</code> and <code>seed</code> is not <code>NULL</code>.
</p>
</li>
<li><p><code>theta</code>: numeric, a vector of the initial ability levels for selecting the first items (default is the single value 0). Ignored if either <code>fixItems</code> or <code>seed</code> is not <code>NULL</code>. See <code><a href="#topic+startItems">startItems</a></code> for further details.
</p>
</li>
<li><p><code>D</code>: numeric, the metric constant. Default is <code>D=1</code> (for logistic metric); <code>D=1.702</code> yields approximately the normal metric (Haley, 1952). Ignored if <code>model</code> is not <code>NULL</code> and if <code>startSelect</code> is not <code>"MFI"</code>. 
</p>
</li>
<li><p><code>randomesque</code>: integer, the number of 'randomesque' items to be picked up optimally for each value of <code>theta</code> vector, before random selection of a single one. Ignored if either <code>fixItems</code> or <code>seed</code> is not <code>NULL</code>. See <code><a href="#topic+startItems">startItems</a></code> for further details.
</p>
</li>
<li><p><code>random.seed</code>: either <code>NULL</code> (default) or a numeric value to fix the random seed of randomesque selection of the items. Ignored if either <code>fixItems</code> or <code>seed</code> is not <code>NULL</code>.
</p>
</li>
<li><p><code>startSelect</code>: the method for selecting the first items of the test, with possible values <code>"bOpt"</code> and <code>"MFI"</code> (default). Ignored if either <code>fixItems</code> or <code>seed</code> is not <code>NULL</code>. See <code><a href="#topic+startItems">startItems</a></code> for further details.
</p>
</li>
<li><p><code>cb.control</code>: logical value indicating whether control for content balancing should also be done when selecting the starting items. Default is <code>FALSE</code>. Ignored if argument <code>cbControl</code> is <code>NULL</code>.
</p>
</li>
<li><p><code>random.cb</code>: either <code>NULL</code> (default) or a numeric value to fix the selection of subgroups of items in case of content balancing control with starting items. Ignored if either <code>cbControl</code> is <code>NULL</code> or if <code>start$cb.control</code> is <code>FALSE</code>.
</p>
</li></ul>

<p>These arguments are passed to the function <code><a href="#topic+startItems">startItems</a></code> to select the first items of the test.
</p>
<p>If the argument <code>nrItems</code> is set to zero, then no starting item is selected and the adaptive process starts with a provisional ability level equal to the value of argument <code>theta</code> (or its default). Moreover, the likelihood function is then set as a flat, uniform function on the whole ability range. See the <code><a href="#topic+nextItem">nextItem</a></code> function for further details.
</p>
<p>The <code>test</code> list can contain one or several of the following arguments:
</p>

<ul>
<li><p><code>method</code>: a character string to specify the method for ability estimation. Possible values are: <code>"BM"</code> (default) for Bayesian modal estimation (Birnbaum, 1969), <code>"ML"</code> for maximum likelihood estimation (Lord, 1980), <code>"EAP"</code> for expected a posteriori (EAP) estimation (Bock and Mislevy, 1982), <code>"WL"</code> for weighted likelihood estimation (Warm, 1989) and <code>"ROB"</code> for robust estimation (Schuester and Yuan, 2011).
</p>
</li>
<li><p><code>priorDist</code>: a character string which sets the prior distribution. Possible values are: <code>"norm"</code> (default) for normal distribution, <code>"unif"</code> for uniform distribution, and <code>"Jeffreys"</code> for Jeffreys' noninformative prior distribution (Jeffreys, 1939, 1946). Ignored if <code>method</code> is neither <code>"BM"</code> nor <code>"EAP"</code>.
</p>
</li>
<li><p><code>priorPar</code>: a vector of two numeric components, which sets the parameters of the prior distribution. If (<code>method="BM"</code> or <code>method=="EAP"</code>) and <code>priorDist="norm"</code>, the components of <code>priorPar</code> are respectively the mean and the standard deviation of the prior normal density. If (<code>method="BM"</code> or <code>method="EAP"</code>) and <code>priorDist="unif"</code>, the components of <code>priorPar</code> are respectively the lower and upper bound of the prior uniform density. Ignored in all other cases. By default, <code>priorPar</code> takes the parameters of the prior standard normal distribution (i.e., <code>priorPar=c(0,1)</code>). In addition, <code>priorPar</code> also provides the prior parameters for the computation of MLWI and MPWI values for next item selection (see <code><a href="#topic+nextItem">nextItem</a></code> for further details).
</p>
</li>
<li><p><code>weight</code>: the type of weight function for the robust estimator. Possible values are <code>"Huber"</code> (default) and <code>"Tukey"</code>. Ignored if <code>method</code> is not <code>"ROB"</code> or if <code>model</code> is not <code>NULL</code>.
</p>
</li>
<li><p><code>tuCo</code>: the value of the tuning constant for the weight function (default is 1, suitable with <code>"Huber"</code> weight). Ignored if <code>method</code> is not <code>"ROB"</code> or if <code>model</code> is not <code>NULL</code>.
</p>
</li>
<li><p><code>sem.type</code>: the type of ASE formula to be used, either <code>"classic"</code> (default) or <code>"new"</code>. Ignored if <code>method</code> is neither <code>"BM"</code> nor <code>"WL"</code>, or if <code>model</code> is not <code>NULL</code>.
</p>
</li>
<li><p><code>sem.exact</code>: a logical value indicating whether <em>exact</em> standard error should be computed instead of asymptotic standard error. (default is <code>FALSE</code>). Ignored if <code>model</code> is not <code>NULL</code>.
</p>
</li>
<li><p><code>se.ase</code>: an integer value specifying the maximum number of item responses that are considered for computing the exact SE values, before switching to ASE values (due to computational time constraints). Default is 10; that is, ASE values are computed from the 11-th administered item on. Ignored if <code>model</code> is not <code>NULL</code> or if <code>sem.exact</code> id <code>FALSE</code>.
</p>
</li>
<li><p><code>range</code>: the maximal range of ability levels, set as a vector of two numeric components. The ability estimate will always lie to this interval (set by default to [-4, 4]). Ignored if <code>method=="EAP"</code>.
</p>
</li>
<li><p><code>D</code>: the value of the metric constant. Default is <code>D=1</code> for logistic metric. Setting <code>D=1.702</code> yields approximately the normal metric (Haley, 1952). Ignored if <code>model</code> is not <code>NULL</code>.
</p>
</li>
<li><p><code>parInt</code>: a numeric vector of three components, holding respectively the values of the arguments <code>lower</code>, <code>upper</code> and <code>nqp</code> of the <code><a href="#topic+eapEst">eapEst</a></code>, <code><a href="#topic+eapSem">eapSem</a></code> and <code>MWI</code> commands. It specifies the range of quadrature points for numerical integration, and is used for computing the EAP estimate, its standard error, and the MLWI and MPWI values for next item selection. Default vector is (-4, 4, 33), thus setting the range from -4 to 4 by steps of 0.25. Ignored if <code>method</code> is not <code>"EAP"</code> and if <code>itemSelect</code> is neither <code>"MLWI"</code> nor <code>"MPWI"</code>.
</p>
</li>
<li><p><code>itemSelect</code>: the rule for next item selecion, with possible values <code>"MFI"</code> (default) for maximum Fisher information criterion; <code>"bOpt"</code> for optimal ability-difficulty match (or Urry's procedure) (not available if <code>model</code> is not <code>NULL</code>); <code>"thOpt"</code> for optimal theta selection (not available if <code>model</code> is not <code>NULL</code>); <code>"MLWI"</code> and <code>"MPWI"</code> for respectively maximum likelihood and posterior weighted information criterion; <code>"MEPV"</code> for minimum expected posterior variance; <code>"MEI"</code> for maximum expected information; <code>"KL"</code> and <code>"KLP"</code> for Kullback-Leibler and posterior Kullback-Leibler information methods; <code>"progressive"</code> and <code>"proportional"</code> for progressive and proportional methods; ; and <code>"random"</code> for random selection. For further details, see <code><a href="#topic+nextItem">nextItem</a></code>.
</p>
</li>
<li><p><code>infoType</code>: character: the type of information function to be used for next item selection. Possible values are <code>"observed"</code> (default) for observed information function, and <code>"Fisher"</code> for Fisher information function. Ignored if <code>itemselect</code> is not <code>"MEI"</code>.
</p>
</li>
<li><p><code>randomesque</code>: integer: the number of items to be chosen from the next item selection rule, among those the next item to be administered will be randomly picked up. Default value is 1 and leads to usual selection of the optimal item (Kingsbury and Zara, 1989).
</p>
</li>
<li><p><code>random.seed</code>: either <code>NULL</code> (default) or a numeric value to fix the random seed of randomesque selection of the items. Ignored if either <code>fixItems</code> or <code>seed</code> is not <code>NULL</code>.
</p>
</li>
<li><p><code>AP</code>: the acceleration parameter required for progressive and proportional methods, with default value 1. Ignored with all other selection methods.
</p>
</li>
<li><p><code>proRule</code>: the stopping rule considered for progressive and proportional methods, with possible values <code>"length"</code> (default), <code>"precision"</code> or both. Ignored with all other selection methods.
</p>
</li>
<li><p><code>proThr</code>: the stopping rule threshold considered for progressive and proportional methods. Default value is 20. Ignored with all other selection methods.
</p>
</li>
<li><p><code>constantPatt</code>: character: the method to estimate ability in case of constant pattern (i.e. only correct or only incorrect responses). Can be either <code>NULL</code> (default), <code>"BM"</code>, <code>"EAP"</code>, <code>"WL"</code>, <code>"fixed4"</code>, <code>"fixed7"</code> or <code>"var"</code>. <em>Currently only implemented for dichotomous IRT models</em>.
</p>
</li></ul>

<p>These arguments are passed to the functions <code><a href="#topic+thetaEst">thetaEst</a></code> and <code><a href="#topic+semTheta">semTheta</a></code> to estimate the ability level and the standard error of this estimate. In addition, some arguments are passed to <code><a href="#topic+nextItem">nextItem</a></code> to select the next item appropriately.
</p>
<p>The <code>stop</code> list can contain one or several of the following arguments:
</p>

<ul>
<li><p><code>rule</code>: a vector of character strings specifying the stopping rules. Possible values are: <code>"length"</code> (default), to stop the test after a pre-specified number of items administered; <code>"precision"</code>, to stop the test 
when the provisional standard error of ability becomes less than or equal to the pre-specified value; <code>"classification"</code>, for which the test ends whenever the provisional confidence interval (set by the <code>alpha</code> argument) does not hold the classification threshold anymore (this is also called the ACI rule; see e.g. Thomson, 2009); and <code>"minInfo"</code> to stop the test if the maximum item information of the available items at current ability estimate is smaller than the prespecified threshold. Can take a single value.
</p>
</li>
<li><p><code>thr</code>: a vector of numeric values fixing the threshold(s) of the stopping rule(s). If <code>rule="length"</code>, <code>thr</code> is the maximal number of items to be administered. If <code>rule="precision"</code>, <code>thr</code> is the precision level (i.e. the standard error) to be reached before stopping. If <code>rule="classification"</code>, <code>thr</code> corresponds to the ability level which serves as a classification rule (i.e. which must not be covered by the provisional confidence interval). Finally, If <code>rule="minInfo"</code>, <code>thr</code> corresponds to the minimum item information that can be observed in the bank of remaining available items. The <code>"classification"</code> rule is not available for the progressive and proportional item selection rules.
</p>
</li>
<li><p><code>alpha</code>: the significance (or <code class="reqn">\alpha</code>) level for computing the priovisional confidence interval of ability.
Ignored if <code>rule</code> is not <code>"classification"</code>. <em>Important:</em> the <code>thr</code> value smust be sorted in the same order of appearance as the <code>rule</code> methods. 
</p>
</li></ul>

<p>Eventually, the <code>final</code> list can contain one or several arguments of the <code>test</code> list (with possiblly different values), as well as the additional <code>alpha</code> argument. The latter specifies the <code class="reqn">\alpha</code> level of the final confidence interval of ability, which is computed as
</p>
<p style="text-align: center;"><code class="reqn">[\hat{\theta}-z_{1-\alpha/2} \; se(\hat{\theta}) ; \hat{\theta}+z_{1-\alpha/2} \; se(\hat{\theta})]</code>
</p>

<p>where <code class="reqn">\hat{\theta}</code> and <code class="reqn">se(\hat{\theta})</code> are respectively the ability estimate and its standard error. Note that the argument <code>itemSelect</code> of the <code>test</code> list is not used for final estimation of the ability level, and is therefore not allowed into the <code>final</code> list.
</p>
<p>If some arguments of these lists are missing, they are automatically set to their default value. The contents of the lists is checked with the <code><a href="#topic+testList">testList</a></code> function, and the adaptive test is generated only if the lists are adequately defined. Otherwise, a message error is printed. Note that the <code><a href="#topic+testList">testList</a></code> function works for both dichotomous and polytomous models.
</p>
<p>Usually the ability estimates and related standard errors are computed right after the administration of the starting items (that is, if <em>k</em> starting items are administered, the first <em>(k-1)</em> ability levels and standard errors are missing). This can however be avoided by fixing the argument <code>allTheta</code> to <code>TRUE</code> (by default it is <code>FALSE</code>). In this case, all provisional ability estimates and standard errors are computed and returned, but in the display of th output file, the first <em>(k-1)</em> abilities and standard errors are printed in parentheses (otherwise they are returned as <code>NA</code> values). Note that <code>allTheta</code> is ignored if no starting item was selected (that is, if argument <code>nrItems</code> of the <code>start</code> list is set to zero).
</p>
<p>The output of <code>randomCAT</code>, as displayed by the <code>print.cat</code> function, can be stored in a text file provided that  <code>save.output</code> is set to <code>TRUE</code> (the default value <code>FALSE</code> does not execute the storage). In this case, the <code>(output</code> argument mus hold three character values: the path to where the output file must be stored, the name of  the output file, and the type of output file. If the path is not provided (i.e. left to its default value <code>"path"</code>), it will be saved in the default working directory. The default name is <code>"name"</code>, and the default type is <code>"csv"</code>. Any other value yields a text file. See the <b>Examples</b> section for an illustration. 
</p>
<p>The function <code>plot.cat</code> represents the set of provisional and final ability estimates througghout the test. Corresponding confidence intervals (with confidence level defined by the argument <code>alpha</code>) are also drawn if <code>ci=TRUE</code> (which is <em>not</em> the default value), except when stepsize adjustment was made for constant patterns (as the standard error cannot be estimated at this stage). The true ability level can be drawn by a horizontal solid line by specifying <code>trueTh=TRUE</code> (which is the default value); setting it to <code>FALSE</code> will undo the drawing. Finally, any classification threshold can be additionally displayed by specifying a numeric value to the argument <code>classThr</code>. The default value <code>NULL</code> does not display any threshold.
</p>
<p>Finally, the plot can be saved in an external file, either as PDF or JPEG format. First, the argument <code>save.plot</code> must be set to <code>TRUE</code> (default is <code>FALSE</code>). Then, the file path for figure storage, the name of the figure and its format are specified through the argument <code>save.options</code>, all as character strings. See the <code>Examples</code> section for further information and a practical example.
</p>


<h3>Value</h3>

<p>The function <code>randomCAT</code> returns a list of class &quot;cat&quot; with the following arguments:
</p>
<table role = "presentation">
<tr><td><code>trueTheta</code></td>
<td>
<p>the value of the <code>trueTheta</code> argument.</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>the value of the <code>model</code> argument.</p>
</td></tr>
<tr><td><code>testItems</code></td>
<td>
<p>a vector with the items that were administered during the test.</p>
</td></tr>
<tr><td><code>itemPar</code></td>
<td>
<p>a matrix with the parameters of the items administered during the test.</p>
</td></tr>
<tr><td><code>itemNames</code></td>
<td>
<p>either a vector wit the names of the selected items during the CAT, or <code>NULL</code>.</p>
</td></tr>
<tr><td><code>pattern</code></td>
<td>
<p>the generated response pattern (as vector of 0 and 1 entries).</p>
</td></tr>
<tr><td><code>thetaProv</code></td>
<td>
<p>a vector with the provisional ability estimates.</p>
</td></tr>
<tr><td><code>seProv</code></td>
<td>
<p>a vector with the standard errors of the provisional ability estimates.</p>
</td></tr>
<tr><td><code>ruleFinal</code></td>
<td>
<p>either the stopping rule(s) that was (were) satisfied to make the CAT stop, or <code>NULL</code>.</p>
</td></tr>
<tr><td><code>thFinal</code></td>
<td>
<p>the final ability estimate.</p>
</td></tr>
<tr><td><code>seFinal</code></td>
<td>
<p>the standard error of the final ability estimate.</p>
</td></tr>
<tr><td><code>ciFinal</code></td>
<td>
<p>the confidence interval of the final ability estimate.</p>
</td></tr>
<tr><td><code>min.length</code></td>
<td>
<p>the value of the <code>min.length</code> argument.</p>
</td></tr>
<tr><td><code>a.stratified</code></td>
<td>
<p>the value of the <code>a.stratified</code> argument.</p>
</td></tr>
<tr><td><code>genSeed</code></td>
<td>
<p>the value of the <code>genSeed</code> argument.</p>
</td></tr>
<tr><td><code>startFixItems</code></td>
<td>
<p>the value of the <code>start$fixItems</code> argument (or its default value if missing).</p>
</td></tr>
<tr><td><code>startSeed</code></td>
<td>
<p>the value of the <code>start$seed</code> argument (or its default value if missing).</p>
</td></tr>
<tr><td><code>startNrItems</code></td>
<td>
<p>the value of the <code>start$nrItems</code> argument (or its default value if missing).</p>
</td></tr>
<tr><td><code>startTheta</code></td>
<td>
<p>the value of the <code>start$theta</code> argument (or its default value if missing).</p>
</td></tr>
<tr><td><code>startD</code></td>
<td>
<p>the value of the <code>start$D</code> argument (or its default value if missing).</p>
</td></tr>
<tr><td><code>startRandomesque</code></td>
<td>
<p>the value of the <code>start$randomesque</code> argument (or its default value if missing).</p>
</td></tr>
<tr><td><code>startThStart</code></td>
<td>
<p>the starting ability values used for selecting the first items of the test.</p>
</td></tr>
<tr><td><code>startSelect</code></td>
<td>
<p>the value of the <code>start$startSelect</code> argument (or its default value if missing).</p>
</td></tr>
<tr><td><code>startCB</code></td>
<td>
<p>logical value, being <code>TRUE</code> if both <code>cbControl</code> is not <code>NULL</code> and <code>start$cb.control</code> is <code>TRUE</code>, and <code>FALSE</code> otherwise.</p>
</td></tr>
<tr><td><code>provMethod</code></td>
<td>
<p>the value of the <code>test$method</code> argument (or its default value if missing).</p>
</td></tr>
<tr><td><code>provDist</code></td>
<td>
<p>the value of the <code>test$priorDist</code> argument (or its default value if missing).</p>
</td></tr>
<tr><td><code>provPar</code></td>
<td>
<p>the value of the <code>test$priorPar</code> argument (or its default value if missing).</p>
</td></tr>
<tr><td><code>provWeight</code></td>
<td>
<p>the value of the <code>test$weight</code> argument (or its default value if missing).</p>
</td></tr>
<tr><td><code>provTuCo</code></td>
<td>
<p>the value of the <code>test$tuCo</code> argument (or its default value if missing).</p>
</td></tr>
<tr><td><code>provSemType</code></td>
<td>
<p>the value of the <code>test$sem.type</code> argument (or its default value if missing).</p>
</td></tr>
<tr><td><code>provSemExact</code></td>
<td>
<p>the value of the <code>test$sem.exact</code> argument (or its default value if missing).</p>
</td></tr>
<tr><td><code>se.ase</code></td>
<td>
<p>the value of the <code>test$se.ase</code> argument (or its default value if missing).</p>
</td></tr>
<tr><td><code>provRange</code></td>
<td>
<p>the value of the <code>test$range</code> argument (or its default value if missing).</p>
</td></tr>
<tr><td><code>provD</code></td>
<td>
<p>the value of the <code>test$D</code> argument (or its default value if missing)or <code>NA</code> if <code>model</code> is not <code>NULL</code>.</p>
</td></tr>
<tr><td><code>itemSelect</code></td>
<td>
<p>the value of the <code>test$itemSelect</code> argument (or its default value if missing).</p>
</td></tr>
<tr><td><code>infoType</code></td>
<td>
<p>the value of the <code>test$infoType</code> argument (or its default value if missing). Not returned if <code>model</code> is not <code>NULL</code>.</p>
</td></tr>
<tr><td><code>randomesque</code></td>
<td>
<p>the value of the <code>test$randomesque</code> argument (or its default value if missing).</p>
</td></tr>
<tr><td><code>AP</code></td>
<td>
<p>the value of the <code>test$AP</code> argument (or its default value if missing).</p>
</td></tr>
<tr><td><code>constantPattern</code></td>
<td>
<p>the value of the <code>test$constantPatt</code> argument (or its default value if missing).</p>
</td></tr>
<tr><td><code>cbControl</code></td>
<td>
<p>the value of the <code>cbControl</code> argument (or its default value if missing).</p>
</td></tr>
<tr><td><code>cbGroup</code></td>
<td>
<p>the value of the <code>itemBank$cbGroup</code> element of the item bank <code>itemBank</code> (for dichotomous IRT models), or the <code>cbGroup</code> element returned by the <code><a href="#topic+breakBank">breakBank</a></code> function (for polytomous IRT models), or <code>NULL</code>.</p>
</td></tr>
<tr><td><code>stopRule</code></td>
<td>
<p>the value of the <code>stop$rule</code> argument (or its default value if missing).</p>
</td></tr>
<tr><td><code>stopThr</code></td>
<td>
<p>the value of the <code>stop$thr</code> argument (or its default value if missing).</p>
</td></tr>
<tr><td><code>stopAlpha</code></td>
<td>
<p>the value of the <code>stop$alpha</code> argument (or its default value if missing).</p>
</td></tr>
<tr><td><code>endWarning</code></td>
<td>
<p>a logical indactor indicating whether the adaptive test stopped because the stopping rule(s) was (were) satisfied, or becasue all items in the bank were administered.</p>
</td></tr>
<tr><td><code>finalMethod</code></td>
<td>
<p>the value of the <code>final$method</code> argument (or its default value if missing).</p>
</td></tr>
<tr><td><code>finalDist</code></td>
<td>
<p>the value of the <code>final$priorDist</code> argument (or its default value if missing).</p>
</td></tr>
<tr><td><code>finalPar</code></td>
<td>
<p>the value of the <code>final$priorPar</code> argument (or its default value if missing).</p>
</td></tr>
<tr><td><code>finalWeight</code></td>
<td>
<p>the value of the <code>final$weight</code> argument (or its default value if missing).</p>
</td></tr>
<tr><td><code>finalTuCo</code></td>
<td>
<p>the value of the <code>final$tuCo</code> argument (or its default value if missing).</p>
</td></tr>
<tr><td><code>finalSemType</code></td>
<td>
<p>the value of the <code>final$sem.type</code> argument (or its default value if missing).</p>
</td></tr>
<tr><td><code>finalSemExact</code></td>
<td>
<p>the value of the <code>final$sem.exact</code> argument (or its default value if missing).</p>
</td></tr>
<tr><td><code>finalRange</code></td>
<td>
<p>the value of the <code>final$range</code> argument (or its default value if missing).</p>
</td></tr>
<tr><td><code>finalD</code></td>
<td>
<p>the value of the <code>final$D</code> argument (or its default value if missing), or <code>NA</code> if <code>model</code> is not <code>NULL</code>.</p>
</td></tr>
<tr><td><code>finalAlpha</code></td>
<td>
<p>the value of the <code>final$alpha</code> argument (or its default value if missing).</p>
</td></tr>
<tr><td><code>save.output</code></td>
<td>
<p>the value of the <code>save.output</code> argument.</p>
</td></tr>
<tr><td><code>output</code></td>
<td>
<p>the value of the <code>output</code> argument.</p>
</td></tr>
<tr><td><code>assigned.responses</code></td>
<td>
<p>a logical value, being <code>TRUE</code> if <code>responses</code> was provided or <code>FALSE</code> <code>responses</code> was set to <code>NULL</code>.</p>
</td></tr>
</table>
<p>The function <code>print.cat</code> returns similar (but differently organized) results. 
</p>


<h3>Note</h3>

<p>When computing the exact standard errors, the number of test items should not be larger than 10 under the 2PL model or any more complex model. This constraint does not hold under the 1PL model.
</p>


<h3>Author(s)</h3>

<p>David Magis <br />
Department of Psychology, University of Liege, Belgium <br />
<a href="mailto:david.magis@uliege.be">david.magis@uliege.be</a>
</p>
<p>Juan Ramon Barrada <br />
Department of Psychology and Sociology, Universidad Zaragoza, Spain <br />
<a href="mailto:barrada@unizar.es">barrada@unizar.es</a>
</p>


<h3>References</h3>

<p>Barrada, J. R., Olea, J., Ponsoda, V., and Abad, F. J. (2010). A method for the comparison of item selection rules in computerized adaptive testing. <em>Applied Psychological Measurement</em>, <em>20</em>, 213-229. doi: <a href="https://doi.org/10.1177/0146621610370152">10.1177/0146621610370152</a>
</p>
<p>Barton, M.A., and Lord, F.M. (1981). <em>An upper asymptote for the three-parameter logistic item-response model</em>.
Research Bulletin 81-20. Princeton, NJ: Educational Testing Service.
</p>
<p>Birnbaum, A. (1969). Statistical theory for logistic mental test models with a prior distribution of ability.
<em>Journal of Mathematical Psychology, 6</em>, 258-276. doi: <a href="https://doi.org/10.1016/0022-2496(69)90005-4">10.1016/0022-2496(69)90005-4</a>
</p>
<p>Bock, R. D., and Mislevy, R. J. (1982). Adaptive EAP estimation of ability in a microcomputer environment. 
<em>Applied Psychological Measurement, 6</em>, 431-444. doi: <a href="https://doi.org/10.1177/014662168200600405">10.1177/014662168200600405</a>
</p>
<p>Chang, H.-H., and Ying, Z. (1999). A-stratified multistage computerized adaptive testing. <em>Applied Psychological Measurement, 23</em>, 211-222. doi: <a href="https://doi.org/10.1177/01466219922031338">10.1177/01466219922031338</a>
</p>
<p>Haley, D.C. (1952). <em>Estimation of the dosage mortality relationship when the dose is subject to error</em>. Technical report no 15. Palo Alto, CA: Applied Mathematics and Statistics Laboratory, Stanford University. 
</p>
<p>Jeffreys, H. (1939). <em>Theory of probability</em>. Oxford, UK: Oxford University Press.
</p>
<p>Jeffreys, H. (1946). An invariant form for the prior probability in estimation problems. <em>Proceedings of the Royal Society of London. Series A, Mathematical and Physical Sciences, 186</em>, 453-461.
</p>
<p>Kingsbury, G. G., and Zara, A. R. (1989). Procedures for selecting items for computerized adaptive tests. <em>Applied Measurement in Education, 2</em>, 359-375. doi: <a href="https://doi.org/10.1207/s15324818ame0204_6">10.1207/s15324818ame0204_6</a>
</p>
<p>Lord, F. M. (1980). <em>Applications of item response theory to practical testing problems</em>. Hillsdale, NJ: Lawrence Erlbaum.
</p>
<p>Magis, D. and Barrada, J. R. (2017). Computerized Adaptive Testing with R: Recent Updates of the Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>Code Snippets</em>, <em>76(1)</em>, 1-18. doi: <a href="https://doi.org/10.18637/jss.v076.c01">10.18637/jss.v076.c01</a>
</p>
<p>Magis, D., and Raiche, G. (2012). Random Generation of Response Patterns under Computerized Adaptive Testing with the R Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>48 (8)</em>, 1-31. doi: <a href="https://doi.org/10.18637/jss.v048.i08">10.18637/jss.v048.i08</a>
</p>
<p>Schuester, C., and Yuan, K.-H. (2011). Robust estimation of latent ability in item response models. <em>Journal of Educational and Behavioral Statistics, 36</em>, 720)735.doi: <a href="https://doi.org/10.3102/1076998610396890">10.3102/1076998610396890</a>
</p>
<p>Thompson, N. A. (2009). Item selection in computerized classification testing. <em>Educational and Psychological Measurement, 69</em>, 778-793. doi: <a href="https://doi.org/10.1177/0013164408324460">10.1177/0013164408324460</a>
</p>
<p>Urry, V. W. (1970). <em>A Monte Carlo investigation of logistic test models.</em> Unpublished doctoral dissertation. West Lafayette, IN: Purdue University.
</p>
<p>van der Linden, W. J. (1998). Bayesian item selection criteria for adaptive testing. <em>Psychometrika, 63</em>, 201-216. doi: <a href="https://doi.org/10.1007/BF02294775">10.1007/BF02294775</a>
</p>
<p>Veerkamp, W. J. J., and Berger, M. P. F. (1997). Some new item selection criteria for adaptive testing. <em>Journal of Educational and Behavioral Statistics, 22</em>, 203-226. doi: <a href="https://doi.org/10.3102/10769986022002203">10.3102/10769986022002203</a>
</p>
<p>Warm, T.A. (1989). Weighted likelihood estimation of ability in item response models. <em>Psychometrika, 54</em>, 427-450. doi: <a href="https://doi.org/10.1007/BF02294627">10.1007/BF02294627</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+testList">testList</a></code>, <code><a href="#topic+startItems">startItems</a></code>, <code><a href="#topic+nextItem">nextItem</a></code>, <code><a href="#topic+thetaEst">thetaEst</a></code>, <code><a href="#topic+semTheta">semTheta</a></code>, <code><a href="#topic+eapEst">eapEst</a></code>,
<code><a href="#topic+eapSem">eapSem</a></code>, <code><a href="#topic+MWI">MWI</a></code>, <code><a href="#topic+MEI">MEI</a></code>, <code><a href="#topic+KL">KL</a></code>, <code><a href="#topic+breakBank">breakBank</a></code>, <code><a href="#topic+genPolyMatrix">genPolyMatrix</a></code>,
<code><a href="#topic+genPattern">genPattern</a></code>, <code><a href="#topic+aStratified">aStratified</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Dichotomous models ##

 # Loading the 'tcals' parameters 
 data(tcals)

 # Matrix of item parameters (with no content balancing)
 bank &lt;- as.matrix(tcals[,1:4])
 
 # Creation of a starting list: 5 items with evenly spread theta values
 start &lt;- list(theta = -2:2)

 # Creation of 'test' list: weighted likelihood estimation of provisional ability, 
 # and MFI criterion for next item selection
 test &lt;- list(method = "WL", itemSelect = "MFI")

 # Creation of 'final' list: EAP estimation of final ability
 final &lt;- list(method = "EAP")

 # Creation of a stopping rule: precision criterion, standard error to be reached 0.3
 stop &lt;- list(rule = "precision", thr = 0.3)

 # CAT test
 res &lt;- randomCAT(0, bank, start = start, test = test, stop = stop, final = final)

## Not run: 
 # Update of the stopping rule: by adding a length criterion, with threshold of 10 items
 stop &lt;- list(rule = c("precision", "length"), thr = c(0.3, 10))

 # CAT test
 res &lt;- randomCAT(0, bank, start = start, test = test, stop = stop, final = final)

 # Modifying 'start', 'test' and 'final' lists to compute exact SEs
 start.exact &lt;- list(theta = c(-1, 1))
 test.exact &lt;- list(method = "WL", itemSelect = "MFI", sem.exact = TRUE)
 final.exact &lt;- list(method = "WL", sem.exact = TRUE)
 res.exact &lt;- randomCAT(0, bank, start = start.exact, test = test.exact, 
                        stop = stop, final = final.exact)

 # Creation of a (purely artificial) response pattern for post-hoc simulation
 resp &lt;- rbinom(nrow(bank), 1, 0.5)
 res.ph &lt;- randomCAT(0, bank, start = start, test = test, stop = stop, final = final,
        responses = resp)

 # New 'test' and 'final' rules (BM and EAP estimation with Jeffreys' prior, 
 # randomesque value 5)
 test2 &lt;- list(method = "BM", priorDist = "Jeffreys", randomesque = 5)
 final2 &lt;- list(method = "EAP", priorDist = "Jeffreys")

 # New stopping rule: classification criterion, with classification threshold 0 and 
 # alpha level 0.05
 stop2 &lt;- list(rule = "classification", thr = 0, alpha = 0.05)

 # CAT test with new 'test', 'stop' and 'final' rules
 res2 &lt;- randomCAT(0, bank, start = start, test = test2, stop = stop2, final = final2)

 # New stopping rule: classification criterion, with classification threshold 0.5
 # and alpha level 0.05
 stop3 &lt;- list(rule = "classification", thr = 0.5, alpha = 0.05)

 # CAT test with new 'stop' rule
 res3 &lt;- randomCAT(0, bank, start = start, test = test2, stop = stop3, final=final2)

 # new 'test' and 'stop' rule for next item selection
 test3 &lt;- list(method = "WL", itemSelect = "MLWI")
 stop4 &lt;- list(rule = "length",thr = 10)
 res4 &lt;- randomCAT(0, bank, start = start, test = test3, stop = stop4, final = final2)

 # Creation of the 'cbList' list with arbitrary proportions
 cbList &lt;- list(names = c("Audio1", "Audio2", "Written1", "Written2",
        "Written3"), props = c(0.1, 0.2, 0.2, 0.2, 0.3))

 # CAT test with 'start', 'test', 'stop4' and 'final2' lists and content balancing 
 # using 'cbList' ('tcals' must be used now for content balancing)
 stop4 &lt;- list(rule = "length",thr = 10)
 res5 &lt;- randomCAT(0, tcals, start = start, test = test, stop = stop4, final = final2, 
      cbControl = cbList)

 # new 'start' list to force content balancing control at the starting step
 start2 &lt;- list(seed = 1, nrItems = 3, cb.control = TRUE)
 res6 &lt;- randomCAT(0, tcals, start = start2, test = test, stop = stop4, final = final2, 
      cbControl = cbList)

 # Using progressive item selection rule and requiring all ability estimates and SEs
 test4 &lt;- list(itemSelect = "progressive")
 res6 &lt;- randomCAT(0, tcals, start = start, test = test4, stop = stop4, final = final, 
      cbControl = cbList, allTheta = TRUE)

 # Saving the output in the external 'out' text file within folder 'Program Files' 
 # of hard drive 'C'
 res5 &lt;- randomCAT(0, tcals, start = start, test = test, stop = stop4, final = final2, 
      cbControl = cbList, save.output = TRUE, 
      output = c("c:/Program Files/", "out", "txt"))

 # Plotting results
 plot(res)
 plot(res, ci = TRUE)
 plot(res, ci = TRUE, trueTh = FALSE)
 plot(res, ci = TRUE, classThr = 1)

 # Saving last figure into PDF file 'figure' within folder 'C:/Program Files/'
 plot(res, ci = TRUE, classThr = 1, save.plot = TRUE,
      save.options = c("c:/Program Files/", "figure", "pdf"))

 # With mistake
 plot(res, ci = 0.05)
 plot(res, classThr = TRUE)


## Polytomous models ##

 # Generation of an item bank under GRM with 100 items and at most 4 categories
 m.GRM &lt;- genPolyMatrix(100, 4, "GRM")
 m.GRM &lt;- as.matrix(m.GRM)

 # CAT options
 start &lt;- list(theta = c(-1, 0),startSelect = "MFI")
 test &lt;- list(method = "BM", itemSelect = "KL")
 stop &lt;- list(rule = "precision", thr = 0.4)
 final &lt;- list(method = "EAP")

 # CAT test
 res &lt;- randomCAT(0, m.GRM,model = "GRM", start = start, test = test, stop = stop,
 	final = final)
 res


 # Creation of an appropriate list for content balancing
 # Equal proprotions across subgroups of items
 cbList &lt;- list(names = c("Group1", "Group2", "Group3", "Group4"), props = rep(1,4))

 # With content balancing, all ability estimates and progressive method
 m.GRM &lt;- genPolyMatrix(100, 4, "GRM", cbControl = cbList)
 test &lt;- list(method = "BM", itemSelect = "progressive")
 res &lt;- randomCAT(0, m.GRM, model = "GRM", start = start, test = test, stop = stop, 
 	final = final, cbControl = cbList, allTheta = TRUE)
 res

 # Loading the cat_pav data
 data(cat_pav)
 cat_pav &lt;- as.matrix(cat_pav)

 stop &lt;- list(rule = "length", thr = 10)
 res &lt;- randomCAT(0, cat_pav, model = "GPCM", start = start, test = test, stop = stop, 
 	final = final, allTheta = TRUE)
 res
 
## End(Not run)
</code></pre>

<hr>
<h2 id='semTheta'>Standard error of ability estimation (dichotomous and polytomous models)</h2><span id='topic+semTheta'></span>

<h3>Description</h3>

<p>This command returns the estimated standard error of the ability estimate, for a given response pattern and a given matrix of item parameters, either under the 4PL model or any suitable polytomous IRT model. Exact standard errors are available for dichotomous models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>semTheta(thEst, it, x = NULL, model = NULL, D = 1, method = "BM", 
  	priorDist = "norm", priorPar = c(0, 1), weight = "Huber", tuCo = 1, 
  	sem.type = "classic", parInt = c(-4, 4, 33), constantPatt = NULL,
  	sem.exact = FALSE, trueTh = NULL, range = c(-4, 4))
 </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="semTheta_+3A_thest">thEst</code></td>
<td>
<p>numeric: the ability estimate.</p>
</td></tr>
<tr><td><code id="semTheta_+3A_it">it</code></td>
<td>
<p>numeric: a suitable matrix of item parameters. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="semTheta_+3A_x">x</code></td>
<td>
<p>numeric: a vector of item responses (default is <code>NULL</code>). Can also hold missing data (coded as <code>NA</code>s). Ignored if <code>method</code> is not <code>"EAP"</code> but must be provided in presence of missing responses. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="semTheta_+3A_model">model</code></td>
<td>
<p>either <code>NULL</code> (default) for dichotomous models, or any suitable acronym for polytomous models. Possible values are <code>"GRM"</code>, <code>"MGRM"</code>, <code>"PCM"</code>, <code>"GPCM"</code>, <code>"RSM"</code> and <code>"NRM"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="semTheta_+3A_d">D</code></td>
<td>
<p>numeric: the metric constant. Default is <code>D=1</code> (for logistic metric); <code>D=1.702</code> yields approximately the normal metric (Haley, 1952).</p>
</td></tr> 
<tr><td><code id="semTheta_+3A_method">method</code></td>
<td>
<p>character: the ability estimator. Possible values are <code>"BM"</code> (default), <code>"ML"</code>, <code>"WL"</code>, <code>"EAP"</code> and <code>"ROB"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="semTheta_+3A_priordist">priorDist</code></td>
<td>
<p>character: specifies the prior distribution. Possible values are <code>"norm"</code> (default), <code>"unif"</code> and <code>"Jeffreys"</code>.
Ignored if <code>method</code> is neither <code>"BM"</code> nor <code>"EAP"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="semTheta_+3A_priorpar">priorPar</code></td>
<td>
<p>numeric: vector of two components specifying the prior parameters (default is <code>c(0,1)</code>) of the prior ability distribution. Ignored if <code>method</code> is neither <code>"BM"</code>
nor <code>"EAP"</code>, or if <code>priorDist="Jeffreys"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="semTheta_+3A_weight">weight</code></td>
<td>
<p>character: the type of weight function for the robust estimator. Possible values are <code>"Huber"</code> (default) and <code>"Tukey"</code>. Ignored if <code>method</code> is not <code>"ROB"</code> or if <code>model</code> is not <code>NULL</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="semTheta_+3A_tuco">tuCo</code></td>
<td>
<p>numeric: the value of the tuning constant for the weight function (default is 1, suitable with <code>"Huber"</code> weight). Ignored if <code>method</code> is not <code>"ROB"</code> or if <code>model</code> is not <code>NULL</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="semTheta_+3A_sem.type">sem.type</code></td>
<td>
<p>character: the type of ASE formula to be used, either <code>"classic"</code> (default) or <code>"new"</code>. Ignored if <code>method</code> is neither <code>"BM"</code> nor <code>"WL"</code>, or if <code>model</code> is not <code>NULL</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="semTheta_+3A_parint">parInt</code></td>
<td>
<p>numeric: vector of three components, holding respectively the values of the arguments <code>lower</code>, <code>upper</code> and <code>nqp</code> of the
<code><a href="#topic+eapEst">eapEst</a></code> command. Default vector is (-4, 4, 33). Ignored if <code>method</code> is not <code>"EAP"</code>.</p>
</td></tr>
<tr><td><code id="semTheta_+3A_constantpatt">constantPatt</code></td>
<td>
<p>character: the method to estimate ability in case of constant pattern (i.e. only correct or only incorrect responses). Can be eitehr <code>NULL</code> (default), <code>"BM"</code>, <code>"EAP"</code>, <code>"WL"</code>, <code>"fixed4"</code>, <code>"fixed7"</code> or <code>"var"</code>. <em>Currently only implemented for dichotomous IRT models</em>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="semTheta_+3A_sem.exact">sem.exact</code></td>
<td>
<p>logical: should <em>exact</em> standard error be computed instead of asymptotic standard error? (default is <code>FALSE</code>). Ignored if <code>model</code> is not <code>NULL</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="semTheta_+3A_trueth">trueTh</code></td>
<td>
<p>(For simulation study purposes only) either <code>NULL</code> (default) or the true ability level of interest. Ignored if <code>sem.exact</code> is <code>FALSE</code> or if <code>model</code> is not <code>NULL</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="semTheta_+3A_range">range</code></td>
<td>
<p>numeric: vector of two components specifying the range wherein the ability estimate must be looked for (default is <code>c(-4,4)</code>). Used only to compute exact standard errors. Ignored if <code>sem.exact</code> is <code>FALSE</code> or if <code>model</code> is not <code>NULL</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Dichotomous IRT models are considered whenever <code>model</code> is set to <code>NULL</code> (default value). In this case, <code>it</code> must be a matrix with one row per item and four columns, with the values of the discrimination, the difficulty, the pseudo-guessing and the inattention parameters (in this order). These are the parameters of the four-parameter logistic (4PL) model
(Barton and Lord, 1981). 
</p>
<p>Polytomous IRT models are specified by their respective acronym: <code>"GRM"</code> for Graded Response Model, <code>"MGRM"</code> for Modified Graded Response Model, <code>"PCM"</code> for Partical Credit Model, <code>"GPCM"</code> for Generalized Partial Credit Model, <code>"RSM"</code> for Rating Scale Model and <code>"NRM"</code> for Nominal Response Model. The <code>it</code> still holds one row per item, end the number of columns and their content depends on the model. See <code><a href="#topic+genPolyMatrix">genPolyMatrix</a></code> for further information and illustrative examples of suitable polytomous item banks.
</p>
<p>The vector of response patterns <code>x</code> can also hold missing responses (more useful in linear testing, not in CAT). In this case the missing responses must be coded as <code>NA</code> values. They are discarded from the ability estimation process. Note that in presence of missing responses, the pattern <code>x</code> must be provided indepedently of the estimation method (to discard items with missing responses from the computation). 
</p>
<p>Five ability estimators are available: the maximum likelihood (ML) estimator (Lord, 1980), the Bayes modal (BM) estimator (Birnbaum, 1969), the expected a posteriori (EAP) estimator (Bock and Mislevy, 1982), the weighted likelihood (WL) estimator (Warm, 1989) and the robust estimator (Schuster &amp; Yuan, 2011). The selected estimator is specified by the <code>method</code> argument, with values <code>"ML"</code>, <code>"BM"</code>, <code>"EAP"</code>, <code>"WL"</code> and <code>"ROB"</code> respectively.
</p>
<p>For the BM and EAP estimators, three prior distributions are available: the normal distribution, the uniform distribution and the Jeffreys' prior distribution (Jeffreys, 1939, 1946). The prior distribution is specified by the argument <code>priorPar</code>, with values <code>"norm"</code>, <code>"unif"</code> and <code>"Jeffreys"</code>, respectively. The <code>priorPar</code> argument is ignored if <code>method="ML"</code> or <code>method="WL"</code>.
</p>
<p>The argument <code>priorPar</code> determines either: the prior mean and standard deviation of the normal prior distribution (if <code>priorDist="norm"</code>), or the range for defining the prior uniform distribution (if <code>priorDist="unif"</code>). This argument is ignored if <code>priorDist="Jeffreys"</code>.
</p>
<p>The <code>eapPar</code> argument sets the range and the number of quadrature points for numerical integration in the EAP process. By default, it takes the vector value (-4, 4, 33), that is, 33 quadrature points on the range [-4; 4] (or, by steps of 0.25). See <code><a href="#topic+eapEst">eapEst</a></code> for further details. 
</p>
<p>Robust estimation requires an appropriate weight function that depends on an accurate tuning constant. Suggested functions are the Huber weight (Schuester and Yuan, 2011) and the Tukey weight (Mosteller and Tukey, 1977). Both can be set by the <code>weight</code> argument, with respective values <code>"Huber"</code> and <code>"Tukey"</code>. Default function is Huber. Moreover, the <code>tuCo</code> argument specifies the tuning constant for the weight function. Default value is 1 and suggested for Huber weight (also by default), and value 4 is suggested for Tukey weight (Schuester and Yuan, 2011).
</p>
<p>New ASE formulas, proposed by Magis (2016), are now available. They can be supplied by the <code>sem.type</code> argument, which takes the default value <code>"classic"</code> (so usual ASEs are computed) or <code>"new"</code> (for the newly suggested formulas). Note that new ASEs are available only for BM and WL estimators, as for other estimators the classic and new versions are identical. Note also that these new ASE formulas are available for dichotomous IRT models only.
</p>
<p>Note that in the current version, the ability estimate must be specified through the <code>thEst</code> argument. Moreover, the response pattern must be specified through the <code>x</code> argument to compute the standard error of the EAP estimate. For the other estimation methods, this is not  necessary, and <code>x</code> is set to <code>NULL</code> by default for this purpose.
</p>
<p>Note also that if specific stepsize adjustment was required for constant patterns with the <code>constantPatt</code> argument (that is, if it takes value <code>"fixed4"</code>, <code>"fixed7"</code> or <code>"var"</code>) then an infinite value <code>Inf</code> is being returned. 
</p>
<p>Finally, exact standard errors can be computed with dichotomous IRT models only (Magis, 2014). This is requested by setting argument <code>sem.exact</code> to <code>TRUE</code> (default is <code>FALSE</code> so regular, asymptotic formula is considered). The exact standard error is computed using the full ability distribution provided by the <code>link{fullDist}</code> function. Two additional arguments can be set up: <code>range</code> to define the range of estimated ability levels during the derivation of the full distribution, and <code>trueTh</code> that can be used to specify the true ability level in addition to the estimated one (through <code>thEst</code> argument). The latter argument is for simulation study purposes, as the set of all observable ability estimates in <code><a href="#topic+fullDist">fullDist</a></code> must then be computed only once. If <code>trueTh</code> is provided some real value, then two SEs are returned: the <em>exact</em> SE obtained with the estimated <code>thEst</code> level, and the <em>true</em> SE derived as the exact SE with true <code>trueTh</code> level.
</p>
<p><b>Important</b>: The computation of the exact standard error is very efficient under the Rasch (1PL) model due to the ue of the Lord-Wingersky algorithm (Lord and Wingersky, 1984).  Therefore, any test length can be considered for computing the exact SE under this model. But for other dichotomous IRT models, the computatinal effort becomes very demanding even with a limited set of <code class="reqn">n</code> items, since <code class="reqn">2^n</code> patterns must be generated and ability estimated with each such pattern. For this reason, it is recommended not to consider exact SE with models other than the Rasch (1PL) with more than 10 items.
</p>


<h3>Value</h3>

<p>The estimated standard error of the ability level (or <code>Inf</code> if the response pattern is constant and <code>constantPatt</code> is not <code>NULL</code>). 
</p>
<p>If exact standard error is computed (<code>sem.exact = TRUE</code>) and <code>trueTh</code> argument takes some numeric value, then output is a vector of two components with the two exact standard errors, the first SE corresponding to the <code>thEst</code> value and the second SE to the <code>trueTh</code> value.
</p>


<h3>Note</h3>

<p>The classic asymptotic standard error of the WL estimator is computed with the same formula as that of the ML estimator (up to the plug-in of the WL estimate instead of the ML estimate). Note however that versions of <code>catR</code> prior to 3.0 hold a different formula mentioned in Magis and raiche (2012), but it appeared that this formula can lead to negative values of the square of the standard error. So the usual suggestion by Warm (1989) of using the same asymptotic formulas for ML and WL is the currently used formula for classic asymptotic computation of the standard error.
</p>


<h3>Author(s)</h3>

<p>David Magis <br />
Department of Psychology, University of Liege, Belgium <br />
<a href="mailto:david.magis@uliege.be">david.magis@uliege.be</a>
</p>
<p>Lianne Ippel <br />
Department of Psychology, University of Liege, Belgium <br />
<a href="mailto:g.j.e.ippel@gmail.com">g.j.e.ippel@gmail.com</a>
</p>


<h3>References</h3>

<p>Barton, M.A., and Lord, F.M. (1981). <em>An upper asymptote for the three-parameter logistic item-response model</em>.
Research Bulletin 81-20. Princeton, NJ: Educational Testing Service.
</p>
<p>Birnbaum, A. (1969). Statistical theory for logistic mental test models with a prior distribution of ability. <em>Journal of Mathematical Psychology, 6</em>, 258-276. doi: <a href="https://doi.org/10.1016/0022-2496(69)90005-4">10.1016/0022-2496(69)90005-4</a>
</p>
<p>Bock, R. D., and Mislevy, R. J. (1982). Adaptive EAP estimation of ability in a microcomputer environment. <em>Applied Psychological Measurement, 6</em>, 431-444. doi: <a href="https://doi.org/10.1177/014662168200600405">10.1177/014662168200600405</a>
</p>
<p>Dodd, B. G., De Ayala, R. J., and Koch, W. R. (1995). Computerized adaptive testing with polytomous items. <em>Applied Psychological Measurement, 19</em>, 5-22. doi: <a href="https://doi.org/10.1177/014662169501900103">10.1177/014662169501900103</a>
</p>
<p>Haley, D.C. (1952). <em>Estimation of the dosage mortality relationship when the dose is subject to error</em>. 
Technical report no 15. Palo Alto, CA: Applied Mathematics and Statistics Laboratory, Stanford University. 
</p>
<p>Jeffreys, H. (1939). <em>Theory of probability</em>. Oxford, UK: Oxford University Press.
</p>
<p>Jeffreys, H. (1946). An invariant form for the prior probability in estimation problems. <em>Proceedings of the Royal Society of London. Series A, Mathematical and Physical Sciences, 186</em>, 453-461.
</p>
<p>Lord, F.M. (1980). <em>Applications of item response theory to practical testing problems</em>. Hillsdale, NJ: Lawrence Erlbaum.
</p>
<p>Lord, F. M., and Wingersky, M. S. (1984). Comparison of IRT true-score and equipercentile observed-score equatings. <em>Applied Psychological Measurement, 8</em>, 453-461.  doi: <a href="https://doi.org/10.1177/014662168400800409">10.1177/014662168400800409</a>
</p>
<p>Magis, D. (2014). Accuracy of asymptotic standard errors of the maximum and weighted likelihood estimators of proficiency levels with short tests. <em>Applied Psychological Measurement, 38</em>, 105-121. doi: <a href="https://doi.org/10.1177/0146621613496890">10.1177/0146621613496890</a>
</p>
<p>Magis, D. (2016). Efficient standard errors formulas of ability estimators with dichotomous item response models. <em>Psychometrika, 81</em>, 184-200. doi: <a href="https://doi.org/10.1007/s11336-015-9443-3">10.1007/s11336-015-9443-3</a>
</p>
<p>Magis, D. and Barrada, J. R. (2017). Computerized Adaptive Testing with R: Recent Updates of the Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>Code Snippets</em>, <em>76(1)</em>, 1-18. doi: <a href="https://doi.org/10.18637/jss.v076.c01">10.18637/jss.v076.c01</a>
</p>
<p>Magis, D., and Raiche, G. (2012). Random Generation of Response Patterns under Computerized Adaptive Testing with the R Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>48 (8)</em>, 1-31. doi: <a href="https://doi.org/10.18637/jss.v048.i08">10.18637/jss.v048.i08</a>
</p>
<p>Mosteller, F., and Tukey, J. (1977). <em>Exploratory data analysis and regression</em>. Reading, MA: Addison-Wesley.
</p>
<p>Schuester, C., and Yuan, K.-H. (2011). Robust estimation of latent ability in item response models. <em>Journal of Educational and Behavioral Statistics, 36</em>, 720)735.doi: <a href="https://doi.org/10.3102/1076998610396890">10.3102/1076998610396890</a>
</p>
<p>Warm, T.A. (1989). Weighted likelihood estimation of ability in item response models. <em>Psychometrika, 54</em>, 427-450. doi: <a href="https://doi.org/10.1007/BF02294627">10.1007/BF02294627</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+eapSem">eapSem</a></code>, <code><a href="#topic+thetaEst">thetaEst</a></code>, <code><a href="#topic+genPolyMatrix">genPolyMatrix</a></code>, <code><a href="#topic+fullDist">fullDist</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Dichotomous models ##

 # Loading the 'tcals' parameters 
 data(tcals)
 
 # Selecting item parameters only
 tcals &lt;- as.matrix(tcals[,1:4])

 # Creation of a response pattern (tcals item parameters, true ability level 0)
 x &lt;- genPattern(0, tcals, seed = 1)

 # ML estimation
 th &lt;- thetaEst(tcals, x, method = "ML")
 c(th, semTheta(th, tcals, method = "ML"))

 # ML estimation, new ASE formula (=&gt; yields the same result)
 c(th, semTheta(th, tcals, method = "ML", sem.type = "new"))

 # With first two responses missing
 x.mis &lt;- x
 x.mis[1:2] &lt;- NA
 th &lt;- thetaEst(tcals, x.mis, method = "ML")
 c(th, semTheta(th, tcals, x.mis, method = "ML"))

 # BM estimation, standard normal prior distribution
 th &lt;- thetaEst(tcals, x)
 c(th, semTheta(th, tcals))

 # BM estimation and new ASE formula
 c(th, semTheta(th, tcals, sem.type = "new"))

 # BM estimation, uniform prior distribution upon range [-2,2]
 th &lt;- thetaEst(tcals, x, method = "BM", priorDist = "unif",
                priorPar = c(-2, 2))
 c(th, semTheta(th, tcals, method = "BM", priorDist = "unif",
		    priorPar = c(-2, 2)))

 # BM estimation, Jeffreys' prior distribution  
 th &lt;- thetaEst(tcals, x, method = "BM", priorDist = "Jeffreys")
 c(th, semTheta(th, tcals, method = "BM", priorDist = "Jeffreys"))

 # EAP estimation, standard normal prior distribution
 th &lt;- thetaEst(tcals, x, method = "EAP")
 c(th, semTheta(th, tcals, x, method = "EAP"))

## Not run: 

 # EAP estimation, uniform prior distribution upon range [-2,2]
 th &lt;- thetaEst(tcals, x, method = "EAP", priorDist = "unif",
                priorPar = c(-2, 2))
 c(th, semTheta(th, tcals, x, method = "EAP", priorDist = "unif",
		    priorPar = c(-2, 2)))

 # EAP estimation, Jeffreys' prior distribution  
 th &lt;- thetaEst(tcals, x, method = "EAP", priorDist = "Jeffreys")
 c(th, semTheta(th, tcals, x, method = "EAP", priorDist = "Jeffreys"))

 # WL estimation
 th &lt;- thetaEst(tcals, x, method = "WL")
 c(th, semTheta(th, tcals, method = "WL"))

 # WL estimation, new ASE formula
 c(th, semTheta(th, tcals, method = "WL", sem.type = "new"))

 # 'fixed4' adjustment for constant pattern
 th &lt;- thetaEst(tcals, rep(0, nrow(tcals)), constantPatt = "fixed4")
 c(th, semTheta(th, tcals, constantPatt = "fixed4"))

 # Robust estimation
 th &lt;- thetaEst(tcals, x, method = "ROB")
 c(th, semTheta(th, tcals, method = "ROB"))

 # Robust estimation, Huber weight and tuning constant 2
 th &lt;- thetaEst(tcals, x, method = "ROB", tuCo = 2)
 c(th, semTheta(th, tcals, method = "ROB", tuCo = 2))

 # Robust estimation, Tukey weight and tuning constant 4
 th &lt;- thetaEst(tcals, x, method = "ROB", weight = "Tukey", tuCo = 4)
 c(th, semTheta(th, tcals, method = "ROB", weight = "Tukey", tuCo = 4))

 ## Exact SE computation under 1PL model: 
 # Creation of a 1PL item bank with difficulties from 'tcals' (85 items)
 tcals2 &lt;- cbind(1, tcals[, 2],  0, 1)

 # Pattern generation for true ability level 1
 x2 &lt;- genPattern(1, tcals2, seed = 1)

 # ML estimation
 th2 &lt;- thetaEst(tcals2, x2, method = "ML")
 c(th2, semTheta(th2, tcals2, x2, method = "ML", sem.exact = TRUE))

 # ML estimation, true SE in addition
 c(th2, semTheta(th2, tcals2, x2, method = "ML", sem.exact = TRUE, trueTh = 1))

 ## Exact SE computation under 2PL model: 
 # Creation of a 2PL item bank with ten items
 it &lt;- genDichoMatrix(10, model = "2PL", seed = 1)

 # Pattern generation for true ability level 1
 x3 &lt;- genPattern(1, it, seed = 1)

 # ML estimation
 th3 &lt;- thetaEst(it, x3, method = "ML")
 c(th3, semTheta(th3, it, x3, method = "ML", sem.exact = TRUE))

 # ML estimation, true SE in addition
 c(th3, semTheta(th3, it, x3, method = "ML", sem.exact = TRUE, trueTh = 1))

## End(Not run)

## Polytomous models ##

 # Generation of an item bank under GRM with 100 items and at most 4 categories
 m.GRM &lt;- genPolyMatrix(100, 4, "GRM")
 m.GRM &lt;- as.matrix(m.GRM)

 # Creation of a response pattern (true ability level 0)
 set.seed(1)
 x &lt;- genPattern(0, m.GRM, model = "GRM")

# ML estimation
 th &lt;- thetaEst(m.GRM, x, model = "GRM", method = "ML")
 c(th, semTheta(th, m.GRM, model = "GRM", method = "ML"))

 # BM estimation, standard normal prior distribution
 th &lt;- thetaEst(m.GRM, x, model = "GRM")
 c(th, semTheta(th, m.GRM, model = "GRM"))

 # BM estimation, uniform prior distribution upon range [-2,2]
 th &lt;- thetaEst(m.GRM, x, model = "GRM", method = "BM", priorDist = "unif", 
    priorPar = c(-2, 2))
 c(th, semTheta(th, m.GRM, model = "GRM", method = "BM", priorDist = "unif", 
  priorPar = c(-2, 2)))

 # BM estimation, Jeffreys' prior distribution  
 th &lt;- thetaEst(m.GRM, x, model = "GRM", method = "BM", priorDist = "Jeffreys")
 c(th, semTheta(th, m.GRM, model = "GRM", method = "BM", priorDist = "Jeffreys"))

 # EAP estimation, standard normal prior distribution
 th &lt;- thetaEst(m.GRM, x, model = "GRM", method = "EAP")
 c(th, semTheta(th, m.GRM, x, model = "GRM", method = "EAP") )

## Not run: 

 # EAP estimation, uniform prior distribution upon range [-2,2]
 th &lt;- thetaEst(m.GRM, x, model = "GRM", method = "EAP", priorDist = "unif", 
    priorPar = c(-2, 2))
 c(th, semTheta(th, m.GRM, x, model = "GRM", method = "EAP", priorDist = "unif", 
  priorPar = c(-2, 2)))

 # EAP estimation, Jeffreys' prior distribution  
 th &lt;- thetaEst(m.GRM, x, model = "GRM", method = "EAP", priorDist = "Jeffreys")
 c(th, semTheta(th, m.GRM, x, model = "GRM", method = "EAP", priorDist = "Jeffreys"))

 # WL estimation
 th &lt;- thetaEst(m.GRM, x, model = "GRM", method = "WL")
 c(th, semTheta(th, m.GRM, model = "GRM", method = "WL"))


 # Loading the cat_pav data
 data(cat_pav)
 cat_pav &lt;- as.matrix(cat_pav)

 # Creation of a response pattern (true ability level 0)
 set.seed(1)
 x &lt;- genPattern(0, cat_pav, model = "GPCM")

# ML estimation
 th &lt;- thetaEst(cat_pav, x, model = "GPCM", method = "ML")
 c(th, semTheta(th, cat_pav, model = "GPCM", method = "ML"))

 # BM estimation, standard normal prior distribution
 th &lt;- thetaEst(cat_pav, x, model = "GPCM")
 c(th, semTheta(th, cat_pav, model = "GPCM"))

 # BM estimation, uniform prior distribution upon range [-2,2]
 th &lt;- thetaEst(cat_pav, x, model = "GPCM", method = "BM", priorDist = "unif", 
    priorPar = c(-2, 2))
 c(th, semTheta(th, cat_pav, model = "GPCM", method = "BM", priorDist = "unif", 
  priorPar = c(-2, 2)))

 # BM estimation, Jeffreys' prior distribution  
 th &lt;- thetaEst(cat_pav, x, model = "GPCM", method = "BM", priorDist = "Jeffreys")
 c(th, semTheta(th, cat_pav, model = "GPCM", method = "BM", priorDist = "Jeffreys"))

 # EAP estimation, standard normal prior distribution
 th &lt;- thetaEst(cat_pav, x, model = "GPCM", method = "EAP")
 c(th, semTheta(th, cat_pav, x, model = "GPCM", method = "EAP"))

 # EAP estimation, uniform prior distribution upon range [-2,2]
 th &lt;- thetaEst(cat_pav, x, model = "GPCM", method = "EAP", priorDist = "unif", 
    priorPar = c(-2, 2))
 c(th, semTheta(th, cat_pav, x, model = "GPCM", method = "EAP", priorDist = "unif", 
  priorPar = c(-2, 2)))

 # EAP estimation, Jeffreys' prior distribution  
 th &lt;- thetaEst(cat_pav, x, model = "GPCM", method = "EAP", priorDist = "Jeffreys")
 c(th, semTheta(th, cat_pav, x, model = "GPCM", method = "EAP", priorDist = "Jeffreys"))

 # WL estimation
 th &lt;- thetaEst(cat_pav, x, model = "GPCM", method = "WL")
 c(th, semTheta(th, cat_pav, model = "GPCM", method = "WL"))

## End(Not run)
 </code></pre>

<hr>
<h2 id='simulateRespondents'>Simulation of multiple examinees of adaptive tests</h2><span id='topic+simulateRespondents'></span><span id='topic+print.catResult'></span><span id='topic+plot.catResult'></span>

<h3>Description</h3>

<p>This command runs a set of adaptive tests, for a given item bank, a set of ability levels, a possible matrix of item responses, and several lists of CAT parameters (starting items, stopping rule, provisional and final ability estimators).</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulateRespondents(thetas, itemBank, responsesMatrix = NULL, model = NULL, 
  	genSeed = NULL, cbControl = NULL, rmax = 1, Mrmax = "restricted", 
  	start = list(fixItems = NULL, seed = NULL, nrItems = 1, theta = 0, 
  	D = 1, randomesque = 1, random.seed = NULL, startSelect = "MFI", 
  	cb.control = FALSE, random.cb = NULL), test = list(method = "BM", 
  	priorDist = "norm", priorPar = c(0,1), weight = "Huber", tuCo = 1, 
  	sem.type = "classic", sem.exact = FALSE, se.ase = 10, range = c(-4, 4), 
  	D = 1, parInt = c(-4, 4, 33), itemSelect = "MFI", infoType = "observed", 
  	randomesque = 1, random.seed = NULL, AP = 1, proRule = "length", 
  	proThr = 20, constantPatt = NULL), stop = list(rule = "length", 
  	thr = 20, alpha = 0.05), final = list(method = "BM", priorDist = "norm", 
  	priorPar = c(0,1), weight = "Huber", tuCo = 1, sem.type = "classic", 
  	sem.exact = FALSE, range = c(-4, 4), D = 1, parInt = c(-4, 4, 33), 
  	alpha = 0.05), save.output = FALSE, output = c("", "catR", "csv"))
## S3 method for class 'catResult'
print(x, ...)
## S3 method for class 'catResult'
plot(x, type = "all", deciles = "theta", save.plot = FALSE, 
  	save.options = c("", "plot", "pdf"), res = 300, ...)
 </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simulateRespondents_+3A_thetas">thetas</code></td>
<td>
<p>numeric: a vector of true ability values for which a CAT must be generated for each component.</p>
</td></tr>
<tr><td><code id="simulateRespondents_+3A_itembank">itemBank</code></td>
<td>
<p>numeric: a suitable matrix of item parameters (possibly augmented by group membership for content balancing). See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="simulateRespondents_+3A_responsesmatrix">responsesMatrix</code></td>
<td>
<p>numeric: either <code>NULL</code> (default) or a suitable matrix of item responses. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="simulateRespondents_+3A_model">model</code></td>
<td>
<p>either <code>NULL</code> (default) for dichotomous models, or any suitable acronym for polytomous models. Possible values are <code>"GRM"</code>, <code>"MGRM"</code>, <code>"PCM"</code>, <code>"GPCM"</code>, <code>"RSM"</code> and <code>"NRM"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="simulateRespondents_+3A_genseed">genSeed</code></td>
<td>
<p>either a vector of numeric values to fix the random seed of each generated pattern, or <code>NULL</code> (default). Ignored if <code>responsesMatrix</code> is not <code>NULL</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="simulateRespondents_+3A_cbcontrol">cbControl</code></td>
<td>
<p>either a list of accurate format to control for content balancing, or <code>NULL</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="simulateRespondents_+3A_rmax">rmax</code></td>
<td>
<p>numeric: the maximum exposure rate (default is 1).</p>
</td></tr>
<tr><td><code id="simulateRespondents_+3A_mrmax">Mrmax</code></td>
<td>
<p>character: the method for controlling maximum exposure rate. Possible values are <code>"restricted"</code>(default) or <code>"IE"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="simulateRespondents_+3A_start">start</code></td>
<td>
<p>a list with the options for starting the adaptive test. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="simulateRespondents_+3A_test">test</code></td>
<td>
<p>a list with the options for provisional ability estimation and next item selection. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="simulateRespondents_+3A_stop">stop</code></td>
<td>
<p>a list with the options of the stopping rule. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="simulateRespondents_+3A_final">final</code></td>
<td>
<p>a list with the options for final ability estimation. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="simulateRespondents_+3A_save.output">save.output</code></td>
<td>
<p>logical: should the output be saved in an external text file? (default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="simulateRespondents_+3A_output">output</code></td>
<td>
<p>character: a vector of three components. The first component is either the file path to save the output or <code>""</code> (default), the second component is either the initial part of the name of the output file or <code>"catR"</code>, and the third component is the file type, either <code>"txt"</code> or <code>"csv"</code> (default). See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="simulateRespondents_+3A_x">x</code></td>
<td>
<p>an object of class &quot;cat&quot;, typically an output of <code>simulateRespondents</code> function.</p>
</td></tr>
<tr><td><code id="simulateRespondents_+3A_type">type</code></td>
<td>
<p>character: the type of plot to display. Possible values are <code>"all"</code> (default), <code>"trueEst"</code>, <code>"expRate"</code>, <code>"cumExpRate"</code>,
<code>"cumNumberItems"</code>, <code>"expRatePara"</code>, <code>"condBias"</code>, <code>"condRMSE"</code>, <code>"numberItems"</code>, <code>"sError"</code> and <code>="condThr"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="simulateRespondents_+3A_deciles">deciles</code></td>
<td>
<p>whether the deciles number (<code>"deciles"</code>) or the mean ability level per decile (<code>"theta"</code>) will be used in the axis of the plots.</p>
</td></tr>
<tr><td><code id="simulateRespondents_+3A_save.plot">save.plot</code></td>
<td>
<p>logical: should the plot be saved in an external figure? (default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="simulateRespondents_+3A_save.options">save.options</code></td>
<td>
<p>character: a vector of three components. The first component is either the file path or <code>""</code> (default), the second component is the name of the output file or ,<code>"plot"</code> (default), and the third component is the file extension, either <code>"pdf"</code> (default) or <code>"jpeg"</code>. Ignored if <code>save.plot</code> is <code>FALSE</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="simulateRespondents_+3A_res">res</code></td>
<td>
<p>numeric: the resolution for JPEG figures (default value is 300).</p>
</td></tr>
<tr><td><code id="simulateRespondents_+3A_...">...</code></td>
<td>
<p>other generic arguments to be passed to <code>print</code> and <code>plot</code> functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>simulateRespondents</code> function permits to generate several adaptive tests to a set of respondents defined by their ability levels. It makes a repeated call to an adaptive test using an item bank specified by arguments <code>itemBank</code> <code>model</code>, and with the same <code>start</code>, <code>test</code>, <code>stop</code> and <code>final</code> lists. Content balancing can also be controlled for each respondent with the <code>cbControl</code> argument. All arguments of <code>simulateRespondents</code> are used in exactly the same manner as in <code><a href="#topic+randomCAT">randomCAT</a></code> (so refer to this function for further information), except the following four.
</p>
<p>First, <code>thetas</code> is now a vector of ability levels, and a CAT will be generated for each component of <code>thetas</code>. If <code>responsesMatrix</code> is <code>NULL</code>, item responses are generated from the IRT model, item bank parameters, and the ability levels. In this case, <code>thetas</code> can be considered as real ability levels. Otherwise, <code>responsesMatrix</code> must be provided as a matrix with as many rows as the length of <code>thetas</code> and as many columns as the number of items in <code>itemBank</code>. Each row contains the response pattern of one examinee whose ability level is given by the value of the corresponding component of <code>thetas</code>. Note that only allowable item responses can be included in <code>responsesMatrix</code> and missing values are not accepted. Fixing the random seed can also be done with the <code>genSeed</code> argument. The latter must hold as many components as the vector <code>thetas</code>, otherwise an error message is returned. Each component of <code>genSeed</code> is used to fix the seed for ach pattern generation.
</p>
<p>The option of providing a response matrix through <code>responsesMatrix</code> is considered for two possible uses: 
</p>

<ol>
<li><p><em>post-hoc simulations</em>: examinees provided responses to the full item bank and one wants to test the performance of a CAT with those responses,
</p>
</li>
<li><p>simulations considering <em>item parameter estimation errors</em>: responses to the full bank are generated with the real parameters and the CAT is run is the estimated parameters and the responses from the correct model.
</p>
</li></ol>

<p>Note that if <code>thetas</code> holds a single value, then the function simply calls <code><a href="#topic+randomCAT">randomCAT</a></code> and returns its output instead.
</p>
<p>Second, <code>rmax</code> fixes the desired maximum exposure rate for all items. Default value is 1, allowing thus items to be administered to all respondents without restrictions.
</p>
<p>Third, the <code>Mrmax</code> argument fixes the method to constraint exposure rates to be smaller than the maximum allowed rate. Possible methods are the restricted method (<code>"restricted"</code>; Revuelta and Ponsoda, 1998) and the item-eligibility method (<code>"IE"</code>; van der Linden and Veldkamp, 2004). A description of both methods can be found in Barrada, Abad and Veldkamp (2009)
</p>
<p>Fourth, if the length of <code>thetas</code> is greater than 1, <code>save.output</code> for <code><a href="#topic+randomCAT">randomCAT</a></code> is fixed to <code>"FALSE"</code>. Otherwise, the same file would be overwritten for each new respondent.
</p>
<p>The output of <code>simulateRespondents</code>, as displayed by the <code>print.catResult</code> function, proposes summary statistics related to overall accuracy (bias, RMSE, etc), conditional accuracy per decile, and item exposure control (minimum and maximum exposure rates, test overlap rate, etc) among all generated CATs. This output can be saved when <code>save.output</code> is set to <code>TRUE</code>, and if so, three outpout files are returned: (1) one with the main summary statistics, with overall results and conditional on decile results; (2) the file with respondents' patterns, items administered and provisional ability estimates; and (3) a table with true and estimated ability levels, final standard errors and numbers of items administered per respondent. Specific information provided and saved depends on the <code>rule</code> used in <code>stop</code>.
</p>
<p>This output can also be graphically displayed with the <code>plot.catResult</code> function. In addition to the output of the function and the item bank, it takes the argument <code>type</code> to determine which plot should be returned. Ten different single plots can be displayed:
</p>

<ol>
<li><p><code>"trueEst"</code>: the scatterplot of true vs. estimated ability levels.
</p>
</li>
<li><p><code>"expRate"</code>: the exposure rates of the items, having ranked them according to these exposure rates.
</p>
</li>
<li><p><code>"cumExpRate"</code>: the cumulative exposure rates of the items, having ranked them according to these exposure rates.
</p>
</li>
<li><p><code>"cumNumberItems"</code>: the test length as a function of cumulative percent of examinees. This plot is not available when <code>rule</code> is 'length'.
</p>
</li>
<li><p><code>"expRatePara"</code>: the scatterplot of item exposure rates vs. item discrimination parameters. This plot is not available when <code>model</code> is 'PCM' or 'NRM', as in those IRT models there are no discrimination parameters.
</p>
</li>
<li><p><code>"condBias"</code>: the conditional bias of ability estimation as a function of the deciles of the true ability levels.
</p>
</li>
<li><p><code>"condRMSE"</code>: the conditional RMSE of ability estimation as a function of the deciles of the true ability levels.
</p>
</li>
<li><p><code>"numberItems"</code>: the conditional test length as a function of the deciles of the true ability levels. This plot is not available when <code>rule</code> is 'length'.
</p>
</li>
<li><p><code>"sError"</code>: the conditional standard error of ability estimation as a function of the deciles of the true ability levels.
</p>
</li>
<li><p><code>"condThr"</code>: the conditional proportions of CATs satisfying the 'precision' or 'classification' stopping rule, as a function of the deciles of the true ability levels. This plot is not available when <code>rule</code> is 'length'.
</p>
</li></ol>

<p>In addition, the value <code>"all"</code> (default value) displays several available plots in a single panel. Displayed plots depend on the <code>rule</code> used in <code>stop</code>: (a) with 'length', <code>"trueEst"</code>, <code>"condBias"</code>, <code>"condRMSE"</code>, <code>"expRate"</code>, <code>"cumExpRate"</code>, <code>"expRatePara"</code>; (b) with 'precision' and 'classification', all the plots but <code>"cumExpRate"</code>.
</p>
<p>These plots can be saved as external PDF or JPEG files, by setting <code>save.plot</code> to <code>TRUE</code> and defining the arguments of <code>save.options</code> accurately (see <code><a href="#topic+randomCAT">randomCAT</a></code> for further explanations and the <b>Examples</b> section below).
</p>


<h3>Value</h3>

<p>The function <code>simulateRespondents</code> returns a list of class &quot;catResult&quot; with the following arguments:
</p>
<table role = "presentation">
<tr><td><code>thetas</code></td>
<td>
<p>the value of the <code>thetas</code> argument.</p>
</td></tr>
<tr><td><code>itemBank</code></td>
<td>
<p>the value of the <code>itemBank</code> argument.</p>
</td></tr>
<tr><td><code>responsesMatrix</code></td>
<td>
<p>the value of the <code>responsesMatrix</code> argument.</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>the value of the <code>model</code> argument.</p>
</td></tr>
<tr><td><code>genSeed</code></td>
<td>
<p>the value of the <code>genSeed</code> argument.</p>
</td></tr>
<tr><td><code>cbControl</code></td>
<td>
<p>the value of the <code>cbControl</code> argument.</p>
</td></tr>
<tr><td><code>rmax</code></td>
<td>
<p>the value of the <code>rmax</code> argument.</p>
</td></tr>
<tr><td><code>Mrmax</code></td>
<td>
<p>the value of the <code>Mrmax</code> argument.</p>
</td></tr>
<tr><td><code>start</code></td>
<td>
<p>the value of the <code>start</code> argument.</p>
</td></tr>
<tr><td><code>test</code></td>
<td>
<p>the value of the <code>test</code> argument.</p>
</td></tr>
<tr><td><code>stop</code></td>
<td>
<p>the value of the <code>stop</code> argument.</p>
</td></tr>
<tr><td><code>final</code></td>
<td>
<p>the value of the <code>final</code> argument.</p>
</td></tr>
<tr><td><code>save.output</code></td>
<td>
<p>the value of the <code>save.output</code> argument.</p>
</td></tr>
<tr><td><code>output</code></td>
<td>
<p>the value of the <code>output</code> argument.</p>
</td></tr>
<tr><td><code>estimatedThetas</code></td>
<td>
<p>a vector with (final) estimated ability levels.</p>
</td></tr> 
<tr><td><code>correlation</code></td>
<td>
<p>the correlation between the <code>thetas</code> vector and estimated ability levels.</p>
</td></tr> 
<tr><td><code>bias</code></td>
<td>
<p>the value of the bias between true and estimated ability levels.</p>
</td></tr> 
<tr><td><code>RMSE</code></td>
<td>
<p>the value of the RMSE between true and estimated ability levels.</p>
</td></tr>
<tr><td><code>thrOK</code></td>
<td>
<p>a vector indicating whether the respondents finished the test satisfying (1) or not (0) the stop criteria.</p>
</td></tr>
<tr><td><code>exposureRates</code></td>
<td>
<p>a vector with empirical exposure rates of all item in the bank.</p>
</td></tr> 
<tr><td><code>testLength</code></td>
<td>
<p>the mean test length.</p>
</td></tr> 
<tr><td><code>overlap</code></td>
<td>
<p>the item overlap rate.</p>
</td></tr>
<tr><td><code>numberItems</code></td>
<td>
<p>a vector with the lengths of each adaptive test (i.e. the number of items administered).</p>
</td></tr>
<tr><td><code>condTheta</code></td>
<td>
<p>a vector with the mean ability level per decile.</p>
</td></tr>
<tr><td><code>condBias</code></td>
<td>
<p>a vector with conditional mean bias per decile.</p>
</td></tr>
<tr><td><code>condRMSE</code></td>
<td>
<p>a vector with conditional RMSE per decile.</p>
</td></tr>
<tr><td><code>condnItems</code></td>
<td>
<p>a vector with conditional mean test length per decile.</p>
</td></tr>
<tr><td><code>condSE</code></td>
<td>
<p>a vector with conditional mean standard error per decile.</p>
</td></tr>
<tr><td><code>condthrOK</code></td>
<td>
<p>a vector with conditional proportion of respondents that finish the test satisfying the stop criteria per decile.</p>
</td></tr>
<tr><td><code>ndecile</code></td>
<td>
<p>a vector with the number of respondents per decile.</p>
</td></tr>
<tr><td><code>final.values.df</code></td>
<td>
<p>a data frame with true ability levels, final ability estimates and standard errors, and test lengths.</p>
</td></tr>
<tr><td><code>responses.df</code></td>
<td>
<p>a data frame with all items administered, all item responses and all provisional ability estimates. -99 is displayed when the actual test length is smaller than the maximum test length for those item positions where no item was administered as the stop criterion was already reached.</p>
</td></tr>
<tr><td><code>start.time</code></td>
<td>
<p>the CPU time at the start of the CAT generation.</p>
</td></tr>
<tr><td><code>finish.time</code></td>
<td>
<p>the CPU time at the end of all CAT generations.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Juan Ramon Barrada <br />
Department of Psychology and Sociology, Universidad Zaragoza, Spain <br />
<a href="mailto:barrada@unizar.es">barrada@unizar.es</a>
</p>
<p>David Magis <br />
Department of Psychology, University of Liege, Belgium <br />
<a href="mailto:david.magis@uliege.be">david.magis@uliege.be</a>
</p>
<p>Guido Corradi <br />
Department of Psychology and Sociology, Universidad Zaragoza, Spain <br />
<a href="mailto:guidocor@gmail.com">guidocor@gmail.com</a>
</p>


<h3>References</h3>

<p>Barrada, J. R., Abad, F. J., and Veldkamp, B. P. (2009). Comparison of methods for controlling maximum exposure rates in computerized adaptive testing. <em>Psicothema</em>, <em>21</em>, 313-320.
</p>
<p>Magis, D. and Barrada, J. R. (2017). Computerized Adaptive Testing with R: Recent Updates of the Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>Code Snippets</em>, <em>76(1)</em>, 1-18. doi: <a href="https://doi.org/10.18637/jss.v076.c01">10.18637/jss.v076.c01</a>
</p>
<p>Magis, D., and Raiche, G. (2012). Random Generation of Response Patterns under Computerized Adaptive Testing with the R Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>48 (8)</em>, 1-31. doi: <a href="https://doi.org/10.18637/jss.v048.i08">10.18637/jss.v048.i08</a>
</p>
<p>Revuelta, J., and Ponsoda, V. (1998). A comparison of item exposure control methods in computerized adaptive testing. <em>Journal of Educational Measurement, 35</em>, 311-327. doi: <a href="https://doi.org/10.1111/j.1745-3984.1998.tb00541.x">10.1111/j.1745-3984.1998.tb00541.x</a>
</p>
<p>van der Linden, W.J., and Veldkamp, B.P. (2004). Constraining item exposure in computerized adaptive testing with shadow tests. <em>Journal of Educational and Behavioral Statistics, 29</em>, 273-291. doi: <a href="https://doi.org/10.3102/10769986029003273">10.3102/10769986029003273</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+randomCAT">randomCAT</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Dichotomous IRT model ##

 # Loading the 'tcals' parameters 
 data(tcals)
 bank &lt;- as.matrix(tcals[,1:4])
 
 # Creation of a starting list with three theta values
 start &lt;- list(theta = -1:1, randomesque = 5)

 # Creation of 'test' list: maximum likelihood estimation and
 # progressive method
 test &lt;- list(method = "ML", itemSelect = "progressive")

 # Creation of a stopping rule: precision criterion, standard
 # error to be reached 0.3
 stop &lt;- list(rule = "precision", thr = 0.3)

 # Creation of 'final' list: ML estimation of final ability
 final &lt;- list(method = "ML")

 # Generation of ten respondents
 set.seed(1)
 thetas &lt;- rnorm(10)

 # Default CAT generations, output not saved
 res &lt;- simulateRespondents(thetas, bank, start = start, test = test, stop = stop, 
  final = final)

 # Maximum exposure restricted to 0.8
 res2 &lt;- simulateRespondents(thetas, bank, start = start, test = test, stop = stop, 
  final = final, rmax = 0.8)

## Not run: 

 # Output saved
 res3 &lt;- simulateRespondents(thetas, bank, start = start, test = test, stop = stop, 
  final = final, save.output = TRUE, output = c("C:/Program Files/", "out", "txt"))

## End(Not run)

 # With content balancing #

 # Creation of an appropriate list for content balancing
 # Equal proportions across subgroups of items
 cbList &lt;- list(names = c("Audio1", "Audio2", "Written1", "Written2", "Written3"), 
        props = c(0.1, 0.2, 0.2, 0.2, 0.3))

 # CAT test (same options as above)
 res4 &lt;- simulateRespondents(thetas, tcals, start = start, test = test, stop = stop, 
  final = final, cbControl = cbList)

 # Plotting and saving output #

 # Plotting all possible panels
 plot(res)
 plot(res, deciles = "deciles")

## Not run: 

 # Saving the plot in the "fig" pdf file in "c:/Program Files/"
 plot(res, save.plot = TRUE, save.options = c("c:/Program Files/", "fig", "pdf"))

## End(Not run)

 # Plotting the 'trueEst' type of plot
 plot(res, type = "trueEst")
 </code></pre>

<hr>
<h2 id='startItems'>Selection of the first items</h2><span id='topic+startItems'></span>

<h3>Description</h3>

<p>This command selects the first items of the adaptive test, either randomly or on the basis of their information function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>startItems(itemBank, model = NULL, fixItems = NULL, seed = NULL, nrItems = 1, 
 	 theta = 0, D = 1, randomesque = 1, random.seed = NULL, startSelect = "MFI",
 	 nAvailable = NULL, cbControl = NULL, cbGroup = NULL, random.cb=NULL) 
 </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="startItems_+3A_itembank">itemBank</code></td>
<td>
<p>numeric: a suitable matrix of item parameters. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="startItems_+3A_model">model</code></td>
<td>
<p>either <code>NULL</code> (default) for dichotomous models, or any suitable acronym for polytomous models. Possible values are <code>"GRM"</code>, <code>"MGRM"</code>, <code>"PCM"</code>, <code>"GPCM"</code>, <code>"RSM"</code> and <code>"NRM"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="startItems_+3A_fixitems">fixItems</code></td>
<td>
<p>either a vector of integer values or <code>NULL</code> (default). See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="startItems_+3A_seed">seed</code></td>
<td>
<p>either a numeric value, <code>NA</code> or <code>NULL</code> (default). Ignored if <code>fixItems</code> is not <code>NULL</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="startItems_+3A_nritems">nrItems</code></td>
<td>
<p>numeric: the number of starting items to be randomly selected (default is 1). Can be equal to zero to avoid initial selection of items (see <b>Details</b>). Used only if <code>fixItems</code> is <code>NULL</code> and <code>seed</code> is not <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="startItems_+3A_theta">theta</code></td>
<td>
<p>numeric: a vector of the initial ability levels for selecting the first items (default is the single value 0). Ignored if either <code>fixItems</code> or <code>seed</code> is not <code>NULL</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="startItems_+3A_d">D</code></td>
<td>
<p>numeric: the metric constant. Default is <code>D=1</code> (for logistic metric); <code>D=1.702</code> yields approximately the normal metric (Haley, 1952). Ignored if <code>model</code> is not <code>NULL</code> and if <code>startSelect</code> is not <code>"MFI"</code>.</p>
</td></tr> 
<tr><td><code id="startItems_+3A_randomesque">randomesque</code></td>
<td>
<p>integer: the number of 'randomesque' items to be picked up optimally for each value of <code>theta</code> vector, before random selection of a single one. Ignored if either <code>fixItems</code> or <code>seed</code> is not <code>NULL</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="startItems_+3A_random.seed">random.seed</code></td>
<td>
<p>either <code>NULL</code> (default) or a numeric value to fix the random seed of randomesque selection of the items. Ignored if either <code>fixItems</code> or <code>seed</code> is not <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="startItems_+3A_startselect">startSelect</code></td>
<td>
<p>character: the criterion for selecting the first items. Possible values are <code>"bOpt"</code>, <code>"thOpt"</code>, <code>"progressive"</code>, <code>"proportional"</code>, and <code>"MFI"</code> (default). See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="startItems_+3A_navailable">nAvailable</code></td>
<td>
<p>either a boolean vector indicating which items (denoted by 1's) are available at the start of the test and which (denoted by 0's) are not, or <code>NULL</code> (default). See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="startItems_+3A_cbcontrol">cbControl</code></td>
<td>
<p>either a list of accurate format to control for content balancing, or <code>NULL</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="startItems_+3A_cbgroup">cbGroup</code></td>
<td>
<p>either a factor vector of accurate format to control for content balancing, or <code>NULL</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="startItems_+3A_random.cb">random.cb</code></td>
<td>
<p>either <code>NULL</code> (default) or a numeric value to fix the selection of subgroups of items for random sampling the starting items. See <b>Details</b>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function permits to select the first item(s) of the test. It works with both dichotomous and polytomous item banks.
</p>
<p>Dichotomous IRT models are considered whenever <code>model</code> is set to <code>NULL</code> (default value). In this case, <code>it</code> must be a matrix with one row per item and four columns, with the values of the discrimination, the difficulty, the pseudo-guessing and the inattention parameters (in this order). These are the parameters of the four-parameter logistic (4PL) model
(Barton and Lord, 1981). 
</p>
<p>Polytomous IRT models are specified by their respective acronym: <code>"GRM"</code> for Graded Response Model, <code>"MGRM"</code> for Modified Graded Response Model, <code>"PCM"</code> for Partical Credit Model, <code>"GPCM"</code> for Generalized Partial Credit Model, <code>"RSM"</code> for Rating Scale Model and <code>"NRM"</code> for Nominal Response Model. The <code>it</code> still holds one row per item, end the number of columns and their content depends on the model. See <code><a href="#topic+genPolyMatrix">genPolyMatrix</a></code> for further information and illustrative examples of suitable polytomous item banks.
</p>
<p>The number of starting items is given by the length of <code>fixItems</code> argument, the <code>nrItems</code> argument (in case of random selection) or by the length of <code>theta</code> argument (in case of optimal selection), with default value 1 in all cases. It can be set to zero; in this case, only <code>NULL</code> values are returned in the output list and the CAT process will start without starting items. 
</p>
<p>The first item(s) of the adaptive test can be selected by one of the following methods.
</p>

<ol>
<li><p>By specifying the item(s) to be administered. The argument <code>fixItems</code> then holds the item number(s) as listed in the item bank. Setting <code>fixItems</code> to <code>NULL</code> (default value) disables this method.
</p>
</li>
<li><p>By selecting it (them) randomly into the item bank. The argument <code>seed</code> permits to fix the random selection by 
specifying the random seed number and the number of selected items is fixed by the <code>nrItems</code> argument. Setting <code>seed</code> to <code>NA</code> disables the random seed (though items are still picked up randomly in the bank); in other words, successive runs of <code>startItems</code> with <code>seed=NA</code> may lead to different item(s) selection. Setting <code>seed</code> to <code>NULL</code> (default value) disables this selection method.
</p>
</li>
<li><p>By selecting the item(s) according to an initial sequence of ability values set by the <code>theta</code> argument. In this case, five criteria can be used, specified through the <code>startSelect</code> argument:  
</p>

<ol>
<li><p><code>"MFI"</code> (default): one selects the most informative item(s) for the given initial ability value(s);
</p>
</li>
<li><p><code>"bOpt"</code>: one selects the item(s) whose difficulty level is as close as possible to the inital ability value(s);
</p>
</li>
<li><p><code>"thOpt"</code>: one selects the item(s) with the ability value where they get their maximum Fisher information is as close as possible to the inital ability value(s) (see Magis, 2013, for further details);
</p>
</li>
<li><p><code>"progressive"</code> for the <em>progressive</em> method (see <code><a href="#topic+nextItem">nextItem</a></code>);
</p>
</li>
<li><p><code>"proportional"</code> for the <em>proportional</em> method (see <code><a href="#topic+nextItem">nextItem</a></code>).
</p>
</li></ol>

<p>If the <code>"progressive"</code> or <code>"proportional"</code> methods are selected, this will force the values of <code>fixItems</code> to <code>NULL</code>, <code>seed</code> to <code>NULL</code>, and <code>nrItems</code> to 1. Thus, a single item will be selected randomly.</p>
</li></ol>

<p>The third method above will be used if and only if both <code>fixItems</code> and <code>seed</code> arguments are fixed to <code>NULL</code>.
Otherwise, one of the first two methods will be used (see also <code><a href="#topic+testList">testList</a></code> for details about debugging 
misspecifications of the starting arguments).
</p>
<p>The sequence of initial ability estimates is specified by the argument <code>theta</code>. For each component of <code>theta</code> one item will be picked up optimally according to the chosen <code>startSelect</code> argument. however, it is possible to perform randomesque selection at this stage by setting the <code>randomesque</code> argument to an integer value larger than one. In this case, the <code>randomesque</code> most optimal items are chosen per value of <code>theta</code>, and the final starting item is chosen randomly among the <code>randomesque</code> items. By default, only one item is picked up per ability level (and is therefore <em>the</em> most optimal one).
</p>
<p>Only part of the full item bank can be made available for the selection of the first item(s), while others can be dropped out from this first step. This is fixed by the <code>nAvailable</code> argument, which is a vector with as many components as items in the bank and with zeros and ones only. Values 1 code for available items, values 0 for non-available items. By default, <code>nAvailable</code> is <code>NULL</code> and all items are available. Note that <code>nrItems</code> should never be larger than the number of available items (i.e. <code>sum(nAvailable)</code>). Otherwise an error message is returned.
</p>
<p>Finally, in case of random selection of the first item(s), it is possible to force this selection to approximately match the content balancing control options set by arguments <code>cbControl</code>  and <code>cbGroup</code>. Detailed description of these arguments (and their accurate format) are described in <code><a href="#topic+nextItem">nextItem</a></code> function. Note that <code>cbControl</code> should be tested with the <code><a href="#topic+test.cbList">test.cbList</a></code> function prior to using <code><a href="#topic+startItems">startItems</a></code>.
</p>
<p>In practice, when fixing both the number of items to select (through <code>nrItems</code>) and the proportions of items per subgroups (through <code>cbControl$props</code>), the selection is made in two steps. First, the number of items per each subgroup is determined in order to reach closest distribution to the theoretical one. Second, within each subgroup the required number of items are randomly drawn (this draw can be fixed with the <code>seed</code> argument; fixing it to <code>NA</code> withdraws this option).
</p>
<p>In the first step, it is possible that several subgroups are equally proable for selection; in this case the selection of the subgroups can be fixed by the argument <code>random.cb</code>. Otherwise the subgroups are sampled without any random seed control.
</p>


<h3>Value</h3>

<p>A list with five arguments:
</p>
<table role = "presentation">
<tr><td><code>items</code></td>
<td>
<p>the selected items (identified by their number in the item bank) or <code>NULL</code> (if <code>nrItems</code> is 0).</p>
</td></tr>
<tr><td><code>par</code></td>
<td>
<p>the matrix of item parameters of the selected items (one row per item) or <code>NULL</code> (if <code>nrItems</code> is 0).</p>
</td></tr>
<tr><td><code>thStart</code></td>
<td>
<p>the sequence of starting ability values used for selecting the items or <code>NA</code> (if not applicable) or <code>NULL</code> (if <code>nrItems</code> is 0).</p>
</td></tr>
<tr><td><code>startSelect</code></td>
<td>
<p>the value of the <code>startSelect</code> argument or <code>NA</code> (if not applicable) or <code>NULL</code> (if <code>nrItems</code> is 0).</p>
</td></tr>
<tr><td><code>names</code></td>
<td>
<p>either a vector with the names of the selected item(s) or <code>NULL</code> (if the item bank has no item names).</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Currently only the <code>"MFI"</code> value for <code>startSelect</code> is allowed for polytomous IRT models (i.e., when <code>model</code> is not <code>NULL</code>). Otherwise an error message is returned.
</p>


<h3>Author(s)</h3>

<p>David Magis <br />
Department of Psychology, University of Liege, Belgium <br />
<a href="mailto:david.magis@uliege.be">david.magis@uliege.be</a>
</p>
<p>Juan Ramon Barrada <br />
Department of Psychology and Sociology, Universidad Zaragoza, Spain <br />
<a href="mailto:barrada@unizar.es">barrada@unizar.es</a>
</p>


<h3>References</h3>

<p>Barton, M.A., and Lord, F.M. (1981). <em>An upper asymptote for the three-parameter logistic item-response model</em>. Research Bulletin 81-20. Princeton, NJ: Educational Testing Service.
</p>
<p>Haley, D.C. (1952). <em>Estimation of the dosage mortality relationship when the dose is subject to error.</em> 
Technical report no 15. Palo Alto, CA: Applied Mathematics and Statistics Laboratory, Stanford University. 
</p>
<p>Magis, D. (2013). A note on the item information function of the four-parameter logistic model. <em>Applied Psychological Measurement</em>, <em>37</em>, 304-315. doi: <a href="https://doi.org/10.1177/0146621613475471">10.1177/0146621613475471</a>
</p>
<p>Magis, D. and Barrada, J. R. (2017). Computerized Adaptive Testing with R: Recent Updates of the Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>Code Snippets</em>, <em>76(1)</em>, 1-18. doi: <a href="https://doi.org/10.18637/jss.v076.c01">10.18637/jss.v076.c01</a>
</p>
<p>Magis, D., and Raiche, G. (2012). Random Generation of Response Patterns under Computerized Adaptive Testing with the R Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>48 (8)</em>, 1-31. doi: <a href="https://doi.org/10.18637/jss.v048.i08">10.18637/jss.v048.i08</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+testList">testList</a></code>, <code><a href="#topic+genPolyMatrix">genPolyMatrix</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Dichotomous models ##

 # Loading the 'tcals' parameters 
 data(tcals)

 # Item bank creation with 'tcals' item parameters
 bank &lt;- as.matrix(tcals[,1:4])
 
 # Random selection of 4 starting items
 startItems(bank, seed = 1, nrItems = 4)

 # Random selection of 4 starting items without fixing the seed
 startItems(bank, seed = NA, nrItems = 4)
 startItems(bank, seed = NA, nrItems = 4) # may provide a different result!

 ## With content balancing control
 prov &lt;- breakBank(tcals)
 cbGroup &lt;- prov$cbGroup

 # Creation of the 'cbList' list with arbitrary proportions
 cbList &lt;- list(names = c("Audio1", "Audio2", "Written1", "Written2", "Written3"), 
        props = c(0.1, 0.2, 0.2, 0.2, 0.3))

 startItems(bank, seed = 1, nrItems = 3, cbControl = cbList, cbGroup = cbGroup)
 startItems(bank, seed = NA, nrItems = 3, cbControl = cbList, cbGroup = cbGroup,
            random.cb = 1)

 # Selection of the first 5 starting items
 startItems(bank, fixItems = 1:5)

 # Selecting 1 starting item, initial ability estimate is 0
 startItems(bank) 

 # Selecting 3 starting items for ability levels -1, 0 and 2
 startItems(bank, theta = c(-1, 0, 2)) 

 # Same with 5 randomesque items per theta value
 startItems(bank, theta = c(-1, 0, 2), randomesque = 5)

 # 5 randomesque items per theta value, with fixed random seed number
 startItems(bank, theta = c(-1, 0, 2), randomesque = 5, random.seed = 1) 

 # Idem but with 'bOpt' criterion
 startItems(bank, theta = c(-1, 0, 2), startSelect = "bOpt")

 # Selecting only the first 10 items as available items
 avail &lt;- c(rep(1, 10), rep(0, nrow(bank)-10))
 startItems(bank, theta = c(-1, 0, 2), nAvailable = avail) 

## Not run: 
 # Selecting too many items among available ones
 startItems(bank, nrItems = 11, theta = 2, halfRange = 3, nAvailable = avail) 

## End(Not run)

## Polytomous models ##

 # Generation of an item bank under GRM with 100 items and at most 4 categories
 m.GRM &lt;- genPolyMatrix(100, 4, "GRM")
 m.GRM &lt;- as.matrix(m.GRM)

 # Random selection of 4 starting items
 startItems(m.GRM, model = "GRM", seed = 1, nrItems = 4)

 # Selection of the first 5 starting items
 startItems(m.GRM, model = "GRM", fixItems = 1:5)

 # Selecting 3 starting items for theta values -1, 0 and 2
 startItems(m.GRM, model = "GRM", theta = c(-1, 0, 2))

## Not run: 

 # Idem but with 'bOpt' criterion
 startItems(m.GRM, model = "GRM", nrItems = 3, theta = 1, halfRange = 2, 
            startSelect = "bOpt")
 
## End(Not run)

 # Selecting only the first 10 items as available items
 avail &lt;- c(rep(1, 10), rep(0, nrow(m.GRM)-10))
 startItems(m.GRM, model = "GRM", theta = c(-1, 0, 2), 
            nAvailable = avail) 

## Not run: 

 # Selecting too many items among available ones
 startItems(m.GRM, model = "GRM", theta = seq(from = -2, to = 2, length = 11), 
            nAvailable = avail) 

## End(Not run)

 # Loading the cat_pav data
 data(cat_pav)
 cat_pav &lt;- as.matrix(cat_pav)

 # Random selection of 4 starting items
 startItems(cat_pav, model = "GPCM", seed = 1, nrItems = 4)

 # Selection of the first 5 starting items
 startItems(cat_pav, model = "GPCM", fixItems = 1:5)

 # Selecting 3 starting items for theta values -1, 0 and 2
 startItems(cat_pav, model = "GPCM", theta = c(-1, 0, 2)) 

## Not run: 

 # Idem but with 'bOpt' criterion
 startItems(cat_pav, model = "GPCM", theta = c(-1, 0, 2), startSelect = "bOpt")
 
## End(Not run)

 # Selecting only the first 10 items as available items
 avail &lt;- c(rep(1, 10), rep(0, nrow(cat_pav)-10))
 startItems(cat_pav, model = "GPCM", theta = c(-1, 0, 2), nAvailable = avail) 

## Not run: 

 # Selecting too many items among available ones
 startItems(cat_pav, model = "GPCM", theta = seq(from = -2, to = 2, length = 11), 
            nAvailable = avail) 
 
## End(Not run)
 </code></pre>

<hr>
<h2 id='tcals'>Items parameters of the TCALS 1998 data set and subgroups of items</h2><span id='topic+tcals'></span>

<h3>Description</h3>

<p>The TCALS (<em>Test de Connaissance en Anglais Langue Seconde</em>) is an aptitude test of English language as a second language
in the French speaking college of Outaouais (Gatineau, QC, Canada). The test consists of 85 items and is administered 
every year to newly incoming students. The item parameters of the year 1998 have been estimated under the 3PL model.
Inattention parameters are therefore fixed to one. Subgroups of items are also included for content balancing purposes.
</p>


<h3>Format</h3>

<p>A matrix with 85 rows and five columns, respectively holding the discrimination, difficulty, pseudo-guessing and inattention parameters 
as calibrated on the results of the 1998 application of the TCALS questionnaire. The fifth column holds the name of the subgroups of items:
</p>

<ul>
<li><p><em>Audio1</em>: listening comprehension of sentences (items <b>1</b> to <b>12</b>).
</p>
</li>
<li><p><em>Audio2</em>: listening comprehension of dialogs and short texts (items <b>13</b> to <b>33</b>).
</p>
</li>
<li><p><em>Written1</em>: written vocabulary exercises (items <b>34</b> to <b>46</b>).
</p>
</li>
<li><p><em>Written2</em>: written grammar exercises (items <b>47</b> to <b>63</b>).
</p>
</li>
<li><p><em>Written3</em>: written exercises of other types: reading and mistake detection (items <b>64</b> to <b>85</b>).
</p>
</li></ul>



<h3>Source</h3>

<p>The TCALS test was originally developed by Laurier, Froio, Pearo and Fournier (1998) and item parameters were obtained from Raiche (2002).
</p>


<h3>References</h3>

<p>Laurier, M., Froio, L., Pearo C., and Fournier, M. (1998). <em>Test de classement d'anglais langue seconde au collegial</em>. Montreal, Canada: College de Maisonneuve.
</p>
<p>Magis, D. and Barrada, J. R. (2017). Computerized Adaptive Testing with R: Recent Updates of the Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>Code Snippets</em>, <em>76(1)</em>, 1-18. doi: <a href="https://doi.org/10.18637/jss.v076.c01">10.18637/jss.v076.c01</a>
</p>
<p>Magis, D., and Raiche, G. (2012). Random Generation of Response Patterns under Computerized Adaptive Testing with the R Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>48 (8)</em>, 1-31. doi: <a href="https://doi.org/10.18637/jss.v048.i08">10.18637/jss.v048.i08</a>
</p>
<p>Raiche, G. (2002). <em>Le depistage du sous-classement aux tests de classement en anglais, langue seconde, au collegial
[The detection of under classification to the collegial English as a second language placement tests]</em>. Gatineau, QC: College de l'Outaouais.
</p>

<hr>
<h2 id='test.cbList'>Testing the format of the list for content balancing under dichotomous or polytomous IRT models</h2><span id='topic+test.cbList'></span>

<h3>Description</h3>

<p>This command tests whether format of the list to be assigned to <code>cbControl</code> argument of function <code><a href="#topic+nextItem">nextItem</a></code> is appropriate for content balancing, and returns a warning message otherwise.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>test.cbList(list, cbGroup)
 </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="test.cbList_+3A_list">list</code></td>
<td>
<p>a list of arguments to be tested. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="test.cbList_+3A_cbgroup">cbGroup</code></td>
<td>
<p>a vector of character or factor names of the subgroups of items in the bank, or <code>NULL</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>test.cbList</code> function checks whether the list provided in the <code>cbControl</code> argument of the <code><a href="#topic+nextItem">nextItem</a></code> and <code><a href="#topic+randomCAT">randomCAT</a></code> functions, is accurate for controlling for content balancing. It mainly serves as an initial check for the <code><a href="#topic+randomCAT">randomCAT</a></code> function. 
</p>
<p>The function returns an <code>"ok"</code> message if the arguments of <code>list</code> match the requirement of the list <code>cbControl</code> for
content balancing. Otherwise, a message is returned with information about list - type mismatch. This will be the case
if:
</p>

<ul>
<li><p><code>list</code> is not a list or has not exactly two elements,
</p>
</li>
<li><p>at least one of the argument names is incorrect,
</p>
</li>
<li><p>the lengths of the arguments are different, or different from the number of subgroups of items,
</p>
</li>
<li><p>the 'names' element does not match with the subgroups' names,
</p>
</li>
<li><p>the 'props' element is not numeric or holds negative values.
</p>
</li></ul>

<p>Each mismatch yields a different output message to help in debugging the problem.
</p>


<h3>Value</h3>

<p>A list with two arguments:
</p>
<table role = "presentation">
<tr><td><code>test</code></td>
<td>
<p>a logical value indicating whether the format of the list is accurate (<code>TRUE</code>) or not (<code>FALSE</code>).</p>
</td></tr>
<tr><td><code>message</code></td>
<td>
<p>either a message to indicate the type of misspecification, or <code>"ok"</code> if the format is accurate.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>David Magis <br />
Department of Psychology, University of Liege, Belgium <br />
<a href="mailto:david.magis@uliege.be">david.magis@uliege.be</a>
</p>


<h3>References</h3>

<p>Magis, D. and Barrada, J. R. (2017). Computerized Adaptive Testing with R: Recent Updates of the Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>Code Snippets</em>, <em>76(1)</em>, 1-18. doi: <a href="https://doi.org/10.18637/jss.v076.c01">10.18637/jss.v076.c01</a>
</p>
<p>Magis, D., and Raiche, G. (2012). Random Generation of Response Patterns under Computerized Adaptive Testing with the R Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>48 (8)</em>, 1-31. doi: <a href="https://doi.org/10.18637/jss.v048.i08">10.18637/jss.v048.i08</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+nextItem">nextItem</a></code>, <code><a href="#topic+randomCAT">randomCAT</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Dichotomous models ##

 # Loading the 'tcals' parameters 
 data(tcals)
 
 # Vector of group membership for 'tcals' data set
 group &lt;- tcals$Group

 # Creation of a correct list with arbitrary proportions
 cbList &lt;- list(names = c("Audio1", "Audio2", "Written1", "Written2", "Written3"), 
        props = c(0.1, 0.2, 0.2, 0.2, 0.3))

 # Testing 'cbList'
 test.cbList(cbList, group)

 # Creation of an incorrect list (mismatch in first name)
 cbList &lt;- list(names = c("audio1", "Audio2", "Written1", "Written2", "Written3"), 
        props=c(0.1, 0.2, 0.2, 0.2, 0.3))
 test.cbList(cbList, group)

 # Creation of an incorrect list (mismatch in name of second
 # element)
 cbList &lt;- list(names = c("Audio1", "Audio2", "Written1", "Written2", "Written3"), 
        prop = c(0.1, 0.2, 0.2, 0.2, 0.3))
 test.cbList(cbList, group)

 # Creation of an incorrect list (second element shorter than
 # first element)
 cbList &lt;- list(names = c("Audio1", "Audio2", "Written1", "Written2", "Written3"), 
         props=c(0.1, 0.2, 0.2, 0.2))
 test.cbList(cbList, group)

 # Creation of an incorrect list (adding a third element)
 cbList &lt;- list(names = c("Audio1", "Audio2", "Written1", "Written2", "Written3"),  
        props = c(0.1, 0.2, 0.2, 0.2), third = "hi")
 test.cbList(cbList, group)


## Polytomous models ##

 # Creation of an appropriate list for content balancing
 # Equal proprotions across subgroups of items
 cbList &lt;- list(names = c("Group1", "Group2", "Group3", "Group4"), props = rep(1, 4))

 # Creation of a "wrong" list
 cbList2 &lt;- list(names=c("group1","group2"),props = c(1, 1))

 # Generation of an item bank under GRM with 100 items and at most 4 categories
 m.GRM &lt;- genPolyMatrix(100, 4, "GRM", cbControl = cbList)

 # Breaking the 'm.GRM' bank
 bank &lt;- breakBank(m.GRM)

 # Testing 'cbList' and 'cbList2'
 test.cbList(cbList, bank$cbGroup)
 test.cbList(cbList2, bank$cbGroup)

 # Generation of an item bank under PCM with 100 items, 4 categories and groups
 m.PCM &lt;- genPolyMatrix(100, 4, "PCM", same.nrCat = TRUE, cbControl = cbList2)
 
 # Breaking the 'm.PCM' bank
 bank2 &lt;- breakBank(m.PCM)

 # Testing 'cbList' and 'cbList2'
 test.cbList(cbList, bank2$cbGroup)
 test.cbList(cbList2, bank2$cbGroup)
 </code></pre>

<hr>
<h2 id='testList'>Testing the format of the input lists</h2><span id='topic+testList'></span>

<h3>Description</h3>

<p>This command tests whether format of the input lists for the random generation of adaptive tests is convenient, and returns a warning message otherwise.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>testList(list, type = "start")
 </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="testList_+3A_list">list</code></td>
<td>
<p>a list of arguments to be tested. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="testList_+3A_type">type</code></td>
<td>
<p>character: the type of list for checking. Possible values are <code>"start"</code> (default), <code>"test"</code>,
<code>"stop"</code> and <code>"final"</code>. See <b>Details</b>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>testList</code> function checks whether the list provided in the <code>list</code> argument is accurate for the selected <code>type</code>.
It mainly serves as an initial check for the <code><a href="#topic+randomCAT">randomCAT</a></code> function. 
</p>
<p>The four types of lists are: <code>"start"</code> with the parameters for selecting the first items; <code>"test"</code> with
the options of the adaptive test (i.e. method for next item selection, provisional ability estimator and related information);
<code>"stop"</code> with the options setting the stopping rule; and <code>"final"</code> with the options for final ability estimation. 
See the help file of <code><a href="#topic+randomCAT">randomCAT</a></code> for further details about the different lists, their allowed arguments and their contents.
</p>
<p>The function returns an <code>"ok"</code> message if the arguments of <code>list</code> match the requirement of the corresponding <code>type</code>. Otherwise, a message is returned with information about list - type mismatch. This will be the case
if:
</p>

<ul>
<li><p><code>list</code> is not a list, or has no argument names,
</p>
</li>
<li><p><code>list</code> has too many arguments for the <code>type</code> specified,
</p>
</li>
<li><p>at least one of the argument names is incorrect,
</p>
</li>
<li><p>the content of at least one argument is not adequate (e.g. character instead of numeric).
</p>
</li></ul>

<p>Each mismatch yields a different output message to help in debugging the problem.
</p>


<h3>Value</h3>

<p>A list with two arguments:
</p>
<table role = "presentation">
<tr><td><code>test</code></td>
<td>
<p>a logical value indicating whether the format of the list is accurate (<code>TRUE</code>) or not (<code>FALSE</code>).</p>
</td></tr>
<tr><td><code>message</code></td>
<td>
<p>either a message to indicate the type of misspecification, or <code>"ok"</code> if the format is accurate.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>David Magis <br />
Department of Psychology, University of Liege, Belgium <br />
<a href="mailto:david.magis@uliege.be">david.magis@uliege.be</a>
</p>


<h3>References</h3>

<p>Magis, D. and Barrada, J. R. (2017). Computerized Adaptive Testing with R: Recent Updates of the Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>Code Snippets</em>, <em>76(1)</em>, 1-18. doi: <a href="https://doi.org/10.18637/jss.v076.c01">10.18637/jss.v076.c01</a>
</p>
<p>Magis, D., and Raiche, G. (2012). Random Generation of Response Patterns under Computerized Adaptive Testing with the R Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>48 (8)</em>, 1-31. doi: <a href="https://doi.org/10.18637/jss.v048.i08">10.18637/jss.v048.i08</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+randomCAT">randomCAT</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

 # Creation and test of a 'start' list
 start &lt;- list(nrItems = 3, theta = c(-1, 0, 2, -2), randomesque = 2)
 testList(start, type = "start")

 # Using former 'halfRange' argument yields an error now:
 start &lt;- list(nrItems = 3, theta = 0, halfRange = 2)
 testList(start, type = "start")

 # Modification of the list to introduce a mistake
 names(start)[1] &lt;- "nrItem"
 testList(start, type = "start")
 
 # Creation and test of a 'test' list
 test &lt;- list(method = "WL", itemSelect = "bOpt")
 testList(test, type = "test")

# Creation and test of a 'stop' list
 stop &lt;- list(method = "WL")
 testList(stop, type = "test")

# Creation and test of a 'final' list (with mistake)
 final &lt;- list(method = "MAP")
 testList(final, type = "final")
 </code></pre>

<hr>
<h2 id='thetaEst'>Ability estimation (dichotomous and polytomous models)</h2><span id='topic+thetaEst'></span>

<h3>Description</h3>

<p>This command returns the ability estimate for a given response pattern and a given matrix of item parameters, either under the 4PL model or any suitable polytomous IRT model. Available estimators are maximum likelihood (ML), Bayes modal (BM), expected a posteriori (EAP), weighted likelihood (WL) and robust estimator (ROB). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>thetaEst(it, x, model = NULL, D = 1, method = "BM", priorDist = "norm", 
 	priorPar = c(0, 1), weight = "Huber", tuCo = 1, range = c(-4, 4), 
 	parInt = c(-4, 4, 33), constantPatt = NULL, current.th = 0, bRange = c(-2, 2))
 </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="thetaEst_+3A_it">it</code></td>
<td>
<p>numeric: a suitable matrix of item parameters. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="thetaEst_+3A_x">x</code></td>
<td>
<p>numeric: a vector of item responses. Can also hold missing data (coded as <code>NA</code>s). See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="thetaEst_+3A_model">model</code></td>
<td>
<p>either <code>NULL</code> (default) for dichotomous models, or any suitable acronym for polytomous models. Possible values are <code>"GRM"</code>, <code>"MGRM"</code>, <code>"PCM"</code>, <code>"GPCM"</code>, <code>"RSM"</code> and <code>"NRM"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="thetaEst_+3A_d">D</code></td>
<td>
<p>numeric: the metric constant. Default is <code>D=1</code> (for logistic metric); <code>D=1.702</code> yields approximately the normal metric (Haley, 1952). Ignored if <code>model</code> is not <code>NULL</code>.</p>
</td></tr> 
<tr><td><code id="thetaEst_+3A_method">method</code></td>
<td>
<p>character: the ability estimator. Possible values are <code>"BM"</code> (default), <code>"ML"</code>, <code>"WL"</code>, <code>"EAP"</code> and <code>"ROB"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="thetaEst_+3A_priordist">priorDist</code></td>
<td>
<p>character: specifies the prior distribution. Possible values are <code>"norm"</code> (default), <code>"unif"</code> and <code>"Jeffreys"</code>. Ignored if <code>method</code> is neither <code>"BM"</code> nor <code>"EAP"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="thetaEst_+3A_priorpar">priorPar</code></td>
<td>
<p>numeric: vector of two components specifying the prior parameters (default is <code>c(0,1)</code>) of the prior ability distribution. Ignored if <code>method</code> is neither <code>"BM"</code> nor <code>"EAP"</code>, or if <code>priorDist="Jeffreys"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="thetaEst_+3A_weight">weight</code></td>
<td>
<p>character: the type of weight function for the robust estimator. Possible values are <code>"Huber"</code> (default) and <code>"Tukey"</code>. Ignored if <code>method</code> is not <code>"ROB"</code> or if <code>model</code> is not <code>NULL</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="thetaEst_+3A_tuco">tuCo</code></td>
<td>
<p>numeric: the value of the tuning constant for the weight function (default is 1, suitable with <code>"Huber"</code> weight). Ignored if <code>method</code> is not <code>"ROB"</code> or if <code>model</code> is not <code>NULL</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="thetaEst_+3A_range">range</code></td>
<td>
<p>numeric: vector of two components specifying the range wherein the ability estimate must be looked for (default is <code>c(-4,4)</code>). Ignored if <code>method=="EAP"</code>.</p>
</td></tr>
<tr><td><code id="thetaEst_+3A_parint">parInt</code></td>
<td>
<p>numeric: vector of three components, holding respectively the values of the arguments <code>lower</code>, <code>upper</code> and <code>nqp</code> of the <code><a href="#topic+eapEst">eapEst</a></code> command. Default vector is (-4, 4, 33). Ignored if <code>method</code> is not <code>"EAP"</code>.</p>
</td></tr>
<tr><td><code id="thetaEst_+3A_constantpatt">constantPatt</code></td>
<td>
<p>character: the method to estimate ability in case of constant pattern (i.e. only correct or only incorrect responses). Can be either <code>NULL</code> (default), <code>"BM"</code>, <code>"EAP"</code>, <code>"WL"</code>, <code>"fixed4"</code>, <code>"fixed7"</code> or <code>"var"</code>. <em>Currently only implemented for dichotomous IRT models</em>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="thetaEst_+3A_current.th">current.th</code></td>
<td>
<p>numeric: the current ability estimate (default is zero). Required for ability estimation in presence of constant pattern. Ignored if <code>constantPatt</code> is neither <code>"fixed4"</code>, <code>"fixed7"</code> nor <code>"var"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="thetaEst_+3A_brange">bRange</code></td>
<td>
<p>numeric: vector of two componentns with the range of difficulty parameters in the parent item bank (default is <code>c(-2,2)</code>). <em>Currently only implemented for dichotomous IRT models</em>. See <b>Details</b>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Dichotomous IRT models are considered whenever <code>model</code> is set to <code>NULL</code> (default value). In this case, <code>it</code> must be a matrix with one row per item and four columns, with the values of the discrimination, the difficulty, the pseudo-guessing and the inattention parameters (in this order). These are the parameters of the four-parameter logistic (4PL) model
(Barton and Lord, 1981). 
</p>
<p>Polytomous IRT models are specified by their respective acronym: <code>"GRM"</code> for Graded Response Model, <code>"MGRM"</code> for Modified Graded Response Model, <code>"PCM"</code> for Partical Credit Model, <code>"GPCM"</code> for Generalized Partial Credit Model, <code>"RSM"</code> for Rating Scale Model and <code>"NRM"</code> for Nominal Response Model. The <code>it</code> still holds one row per item, end the number of columns and their content depends on the model. See <code><a href="#topic+genPolyMatrix">genPolyMatrix</a></code> for further information and illustrative examples of suitable polytomous item banks.
</p>
<p>The vector of response patterns <code>x</code> can also hold missing responses (more useful in linear testing, not in CAT). In this case the missing responses must be coded as <code>NA</code> values. They are discarded from the ability estimation process.
</p>
<p>Five ability estimators are available: the maximum likelihood (ML) estimator (Lord, 1980), the Bayes modal (BM) estimator (Birnbaum, 1969), the expected a posteriori (EAP) estimator (Bock and Mislevy, 1982), the weighted likelihood (WL) estimator (Warm, 1989) and the robust estimator (Schuster &amp; Yuan, 2011). The selected estimator is specified by the <code>method</code> argument, with values <code>"ML"</code>, <code>"BM"</code>, <code>"EAP"</code>, <code>"WL"</code> and <code>"ROB"</code> respectively.
</p>
<p>For the BM and EAP estimators, three prior distributions are available: the normal distribution, the uniform distribution and Jeffreys' prior distribution (Jeffreys, 1939, 1946). The prior distribution is specified by the argument <code>priorPar</code>, with values <code>"norm"</code>, <code>"unif"</code> and <code>"Jeffreys"</code>, respectively. The <code>priorPar</code> argument is ignored if <code>method="ML"</code> or <code>method="WL"</code>.
</p>
<p>The argument <code>priorPar</code> determines either the prior mean and standard deviation of the normal prior distribution (if 
<code>priorDist="norm"</code>), or the range for defining the prior uniform distribution (if <code>priorDist="unif"</code>). This argument
is ignored if <code>priorDist="Jeffreys"</code>.
</p>
<p>The <code>parInt</code> argument sets the range and the number of quadrature points for numerical integration in the EAP process. By default, it takes the vector value (-4, 4, 33), that is, 33 quadrature points on the range [-4; 4] (or, by steps of 0.25). See <code><a href="#topic+eapEst">eapEst</a></code> for further details. 
</p>
<p>Robust estimation requires an appropriate weight function that depends on an accurate tuning constant. Suggested functions are the Huber weight (Schuester and Yuan, 2011) and the Tukey weight (Mosteller and Tukey, 1977). Both can be set by the <code>weight</code> argument, with respective values <code>"Huber"</code> and <code>"Tukey"</code>. Default function is Huber. Moreover, the <code>tuCo</code> argument specifies the tuning constant for the weight function. Default value is 1 and suggested for Huber weight (also by default), and value 4 is suggested for Tukey weight (Schuester and Yuan, 2011).
</p>
<p>The <code>range</code> argument permits to limit the interval of investigation for the ML, BM, WL and ROB ability estimates (in particular, to avoid infinite ability estimates). The default <code>range</code> is [-4, 4].
</p>
<p>Specific ability estimation methods are available in presence of constant patterns (that is with only correct or only incorrect responses) under dichotomous IRT models. These methods are specified by the argument <code>constantPatt</code>. By default it is set to <code>NULL</code> and hence ability is estimated with the specified <code>method</code> (even in presence of constant pattern). Six methods are currently available for constant patterns: <code>"BM"</code>, <code>"EAP"</code> and <code>"WL"</code> that call for Bayes modal, expected a posteriori and weighted likelihood estimation respectively; <code>"fixed4"</code> and <code>"fixed7"</code> that perform fixed stepsize adjustment (i.e. increase or decrease of constant magnitude) with step 0.4 and 0.7 respectively; and <code>"var"</code> for variable stepsize adjustment. Note that in case odf stepsize adjustment, the range of difficultyu parameters must be provided through the <code>bRange</code> argument, as vector of two components (default value being <code>c(-2,2)</code>). See Dodd, De Ayala, and Koch (1995) for further details.
</p>


<h3>Value</h3>

<p>The estimated ability level.
</p>


<h3>Note</h3>

<p>1) It has been shown that in some cases the weighted likelihood estimator and the Bayes modal estimator with Jeffreys prior return exactly the same ability estimates. This is the case under the 2PL model, and subsequently the 1PL model (Warm, 1989) as well as under all polytomous models currently available (Magis, 2015). Nevertheless, both estimators remain available since (a) Jeffreys prior can also be considered with the EAP estimator, and (b) the 3PL and 4PL models are also available.
</p>
<p>2) So far the robust estimator is available for dichotomous IRT models only.
</p>


<h3>Author(s)</h3>

<p>David Magis <br />
Department of Psychology, University of Liege, Belgium <br />
<a href="mailto:david.magis@uliege.be">david.magis@uliege.be</a>
</p>
<p>Lianne Ippel <br />
Department of Psychology, University of Liege, Belgium <br />
<a href="mailto:g.j.e.ippel@gmail.com">g.j.e.ippel@gmail.com</a>
</p>


<h3>References</h3>

<p>Barton, M.A., and Lord, F.M. (1981). <em>An upper asymptote for the three-parameter logistic item-response model</em>. Research Bulletin 81-20. Princeton, NJ: Educational Testing Service.
</p>
<p>Birnbaum, A. (1969). Statistical theory for logistic mental test models with a prior distribution of ability. <em>Journal of Mathematical Psychology, 6</em>, 258-276. doi: <a href="https://doi.org/10.1016/0022-2496(69)90005-4">10.1016/0022-2496(69)90005-4</a>
</p>
<p>Bock, R. D., and Mislevy, R. J. (1982). Adaptive EAP estimation of ability in a microcomputer environment. <em>Applied Psychological Measurement, 6</em>, 431-444. doi: <a href="https://doi.org/10.1177/014662168200600405">10.1177/014662168200600405</a>
</p>
<p>Dodd, B. G., De Ayala, R. J., and Koch, W. R. (1995) . Computerized adaptive testing with polytomous items. <em>Applied Psychological Measurement, 19</em>, 5-22. doi: <a href="https://doi.org/10.1177/014662169501900103">10.1177/014662169501900103</a>
</p>
<p>Haley, D.C. (1952). <em>Estimation of the dosage mortality relationship when the dose is subject to error.</em> 
Technical report no 15. Palo Alto, CA: Applied Mathematics and Statistics Laboratory, Stanford University. 
</p>
<p>Jeffreys, H. (1939). <em>Theory of probability</em>. Oxford, UK: Oxford University Press.
</p>
<p>Jeffreys, H. (1946). An invariant form for the prior probability in estimation problems. <em>Proceedings of the Royal Society of London. Series A, Mathematical and Physical Sciences, 186</em>, 453-461.
</p>
<p>Lord, F.M. (1980). <em>Applications of item response theory to practical testing problems</em>. Hillsdale, NJ: Lawrence Erlbaum.
</p>
<p>Magis, D. (2015). A note on weighted likelihood and Jeffreys modal estimation of proficiency levels in polytomous item response models. <em>Psychometrika, 80</em>, 200-204. doi: <a href="https://doi.org/10.1007/S11336-013-9378-5">10.1007/S11336-013-9378-5</a>
</p>
<p>Magis, D. and Barrada, J. R. (2017). Computerized Adaptive Testing with R: Recent Updates of the Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>Code Snippets</em>, <em>76(1)</em>, 1-18. doi: <a href="https://doi.org/10.18637/jss.v076.c01">10.18637/jss.v076.c01</a>
</p>
<p>Magis, D., and Raiche, G. (2012). Random Generation of Response Patterns under Computerized Adaptive Testing with the R Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>48 (8)</em>, 1-31. doi: <a href="https://doi.org/10.18637/jss.v048.i08">10.18637/jss.v048.i08</a>
</p>
<p>Mosteller, F., and Tukey, J. (1977). <em>Exploratory data analysis and regression</em>. Reading, MA: Addison-Wesley.
</p>
<p>Schuester, C., and Yuan, K.-H. (2011). Robust estimation of latent ability in item response models. <em>Journal of Educational and Behavioral Statistics, 36</em>, 720)735.doi: <a href="https://doi.org/10.3102/1076998610396890">10.3102/1076998610396890</a>
</p>
<p>Warm, T.A. (1989). Weighted likelihood estimation of ability in item response models. <em>Psychometrika, 54</em>, 427-450. doi: <a href="https://doi.org/10.1007/BF02294627">10.1007/BF02294627</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+eapEst">eapEst</a></code>, <code><a href="#topic+semTheta">semTheta</a></code>, <code><a href="#topic+genPolyMatrix">genPolyMatrix</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Dichotomous models ##

 # Loading the 'tcals' parameters 
 data(tcals)

 # Selecting item parameters only
 tcals &lt;- as.matrix(tcals[,1:4])
 
 # Creation of a response pattern (tcals item parameters, true ability level 0)
 set.seed(1)
 x &lt;- genPattern(0, tcals)

 # ML estimation
 thetaEst(tcals, x, method = "ML")

 # With first two responses missing 
 x.mis &lt;- x
 x.mis[1:2] &lt;- NA
 thetaEst(tcals, x.mis, method = "ML")

 # BM estimation, standard normal prior distribution
 thetaEst(tcals, x)

 # BM estimation, uniform prior distribution upon range [-2,2]
 thetaEst(tcals, x, method = "BM", priorDist = "unif", priorPar = c(-2, 2))

 # BM estimation, Jeffreys' prior distribution  
 thetaEst(tcals, x, method = "BM", priorDist = "Jeffreys")

 # EAP estimation, standard normal prior distribution
 thetaEst(tcals, x, method = "EAP")

 # EAP estimation, uniform prior distribution upon range [-2,2]
 thetaEst(tcals, x, method = "EAP", priorDist = "unif", priorPar = c(-2, 2))

 # EAP estimation, Jeffreys' prior distribution  
 thetaEst(tcals, x, method = "EAP", priorDist = "Jeffreys")

 # WL estimation
 thetaEst(tcals, x, method = "WL")

 # Robust estimation, Huber weight with tuning constant 1 (default)
 thetaEst(tcals, x, method = "ROB")

 # Robust estimation, Huber weight with tuning constant 2 
 thetaEst(tcals, x, method = "ROB", tuCo = 2)

 # Robust estimation, Tukey weight with tuning constant 4 
 thetaEst(tcals, x, method = "ROB", weight = "Tukey", tuCo = 4)

 # Creation of two constant patterns and estimation with WL, 
 # 'fixed4', 'fixed7' and 'var' stepsize adjustments
 x0 &lt;- rep(0,nrow(tcals))
 x1 &lt;- x0 + 1
 thetaEst(tcals, x0, constantPatt = "WL") # equivalent to thetaEst(tcals, x0, method = "WL")
 thetaEst(tcals, x1, constantPatt = "WL") # equivalent to thetaEst(tcals, x1, method = "WL")
 thetaEst(tcals, x0, constantPatt = "fixed4") 
 thetaEst(tcals, x1, constantPatt = "fixed4") 
 thetaEst(tcals, x0, constantPatt = "fixed7") 
 thetaEst(tcals, x1, constantPatt = "fixed7") 
 thetaEst(tcals, x0, constantPatt = "var") 
 thetaEst(tcals, x1, constantPatt = "var") 

## Not run: 

## Polytomous models ##

 # Generation of an item bank under GRM with 100 items and at most 4 categories
 m.GRM &lt;- genPolyMatrix(100, 4, "GRM")
 m.GRM &lt;- as.matrix(m.GRM)

 # Creation of a response pattern (true ability level 0)
 set.seed(1)
 x &lt;- genPattern(0, m.GRM, model = "GRM")

 # ML estimation
 thetaEst(m.GRM, x, model = "GRM", method = "ML")

 # BM estimation, standard normal prior distribution
 thetaEst(m.GRM, x, model = "GRM")

 # BM estimation, uniform prior distribution upon range [-2,2]
 thetaEst(m.GRM, x, model = "GRM", method = "BM", priorDist = "unif", 
          priorPar = c(-2, 2))

 # BM estimation, Jeffreys' prior distribution  
 thetaEst(m.GRM, x, model = "GRM", method = "BM", priorDist = "Jeffreys")

 # EAP estimation, standard normal prior distribution
 thetaEst(m.GRM, x, model = "GRM", method = "EAP")

 # EAP estimation, uniform prior distribution upon range [-2,2]
 thetaEst(m.GRM, x, model = "GRM", method = "EAP", priorDist = "unif", 
          priorPar = c(-2, 2))

 # EAP estimation, Jeffreys' prior distribution  
 thetaEst(m.GRM, x, model = "GRM", method = "EAP", priorDist = "Jeffreys")

 # WL estimation
 thetaEst(m.GRM, x, model = "GRM", method = "WL")


 # Generation of an item bank under PCM with 20 items and 4 categories
 m.PCM &lt;- genPolyMatrix(20, 4, "PCM", same.nrCat = TRUE)
 m.PCM &lt;- as.matrix(m.PCM)

 # Creation of a response pattern (true ability level 0)
 set.seed(1)
 x &lt;- genPattern(0, m.PCM, model = "PCM")

 # ML estimation
 thetaEst(m.PCM, x, model = "PCM", method = "ML")

 # BM estimation, standard normal prior distribution
 thetaEst(m.PCM, x, model = "PCM")

 # BM estimation, uniform prior distribution upon range [-2,2]
 thetaEst(m.PCM, x, model = "PCM", method = "BM", priorDist = "unif", 
          priorPar = c(-2, 2))

 # BM estimation, Jeffreys' prior distribution  
 thetaEst(m.PCM, x, model = "PCM", method = "BM", priorDist = "Jeffreys")

 # EAP estimation, standard normal prior distribution
 thetaEst(m.PCM, x, model = "PCM", method = "EAP")

 # EAP estimation, uniform prior distribution upon range [-2,2]
 thetaEst(m.PCM, x, model = "PCM", method = "EAP", priorDist = "unif", 
          priorPar = c(-2, 2))

 # EAP estimation, Jeffreys' prior distribution  
 thetaEst(m.PCM, x, model = "PCM", method = "EAP", priorDist = "Jeffreys")

 # WL estimation
 thetaEst(m.PCM, x, model = "PCM", method = "WL")
 
## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
