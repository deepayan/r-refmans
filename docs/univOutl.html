<!DOCTYPE html><html><head><title>Help for package univOutl</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {univOutl}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#univOutl-package'>
<p>Detection of Univariate Outliers.</p></a></li>
<li><a href='#boxB'>
<p>BoxPlot based outlier detection</p></a></li>
<li><a href='#HBmethod'>
<p>Hidiroglou-Berthelot procedure for detecting outliers with periodic data</p></a></li>
<li><a href='#LocScaleB'>
<p>Univariate outlier detection with bounds based on robust location and scale estimates</p></a></li>
<li><a href='#plot4ratios'>
<p>Draws a scatter-plot that summarizes the findings of the Hidiroglou-Berthelot outliers' or the ratioSize detection method.</p></a></li>
<li><a href='#ratioSize'>
<p>Identifies outliers on ratios and filter them by a size measure</p></a></li>
<li><a href='#skew.misc'>
<p>Calculates some skewness measures.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Detection of Univariate Outliers</td>
</tr>
<tr>
<td>Version:</td>
<td>0.4</td>
</tr>
<tr>
<td>Author:</td>
<td>Marcello D'Orazio</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Marcello D'Orazio &lt;mdo.statmatch@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>robustbase, Hmisc</td>
</tr>
<tr>
<td>Description:</td>
<td>Well known outlier detection techniques in the univariate case. Methods to deal with skewed distribution are included too. The Hidiroglou-Berthelot (1986) method to search for outliers in ratios of historical data is implemented as well. When available, survey weights can be used in outliers detection.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/marcellodo/univOutl">https://github.com/marcellodo/univOutl</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-05-31 05:51:24 UTC; pc</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-05-31 06:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='univOutl-package'>
Detection of Univariate Outliers.
</h2><span id='topic+univOutl-package'></span><span id='topic+univOutl'></span>

<h3>Description</h3>

<p>Well known outlier detection techniques in the univariate case. Ratios of two variables are covered too. When available, survey weights can be considered.
</p>


<h3>Details</h3>

<p>The package provides few simple functions implementing well known outlier detection techniques in the univariate case. 
Methods to deal with skewed distributions are included.
The Hidiroglou-Berthelot (1986) method to search for outliers in ratios of historical data is implemented as well. When available, the survey weights can be used in outliers' detection.
</p>


<h3>Author(s)</h3>

<p>Author and Maintainer: Marcello D'Orazio <a href="mailto:mdo.statmatch@gmail.com">mdo.statmatch@gmail.com</a>
</p>


<h3>References</h3>

<p>Hidiroglou, M.A. and Berthelot, J.-M. (1986) &lsquo;Statistical editing and Imputation for Periodic Business Surveys&rsquo;. <em>Survey Methodology</em>, Vol 12, pp. 73-83.
</p>
<p>McGill, R., Tukey, J. W. and Larsen, W. A. (1978) &lsquo;Variations of box plots&rsquo;. <em>The American Statistician</em>, 32, pp. 12-16.
</p>
<p>Rousseeuw, P.J. and Croux, C. (1993) &lsquo;Alternatives to the Median Absolute Deviation&rsquo;, <em>Journal of the American Statistical Association</em> 88, pp. 1273-1283.
</p>
<p>Hubert, M., and Vandervieren, E. (2008) &lsquo;An Adjusted Boxplot for Skewed Distributions&rsquo;, <em>Computational Statistics &amp; Data Analysis</em>, 52, pp. 5186-5201
</p>

<hr>
<h2 id='boxB'>
BoxPlot based outlier detection
</h2><span id='topic+boxB'></span>

<h3>Description</h3>

<p>Identifies univariate outliers by using methods based on BoxPlots
</p>


<h3>Usage</h3>

<pre><code class='language-R'>boxB(x, k=1.5, method='asymmetric', weights=NULL, id=NULL, 
     exclude=NA, logt=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="boxB_+3A_x">x</code></td>
<td>

<p>Numeric vector that will be searched for outliers. 
</p>
</td></tr>
<tr><td><code id="boxB_+3A_k">k</code></td>
<td>

<p>Nonnegative constant that determines the extension of the 'whiskers'. Commonly used values are 1.5 (default), 2, or 3.
Note that when <code>method="adjbox"</code> then <code>k</code> is set automatically equal to 1.5
</p>
</td></tr>
<tr><td><code id="boxB_+3A_method">method</code></td>
<td>

<p>Character, identifies the method to be used: <code>method="resistant"</code> provides the &lsquo;standard&rsquo; boxplot fences; <code>method="asymmetric"</code> is a modification of standard method to deal with (moderately) skewed data; <code>method="adjbox"</code> uses Hubert and Vandervieren (2008) adjusted boxplot for skewed distributions.
</p>
</td></tr>
<tr><td><code id="boxB_+3A_weights">weights</code></td>
<td>

<p>Optional numeric vector with units' weights associated to the observations in <code>x</code>. Only nonnegative weights are allowed. Weights are used in estimating the quartiles (see Details).
</p>
</td></tr>
<tr><td><code id="boxB_+3A_id">id</code></td>
<td>

<p>Optional vector with identifiers of units in <code>x</code>. If missing (<code>id=NULL</code>, default) the identifiers will be set equal to the positions in the vector (i.e. <code>id=1:length(x)</code>). 
</p>
</td></tr>
<tr><td><code id="boxB_+3A_exclude">exclude</code></td>
<td>

<p>Values of <code>x</code> that will be excluded by the analysis. By default missing values are excluded (<code>exclude=NA</code>). 
</p>
</td></tr>
<tr><td><code id="boxB_+3A_logt">logt</code></td>
<td>

<p>Logical, if <code>TRUE</code>, before searching outliers the <code>x</code> variable is log-transformed (<code>log(x+1)</code> is considered). In this case the summary outputs (bounds, etc.) will refer to the log-transformed <code>x</code>
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When <code>method="resistant"</code> the outlying observations are those outside the interval:
</p>
<p style="text-align: center;"><code class="reqn">[Q_1 - k \times IQR;\quad  Q_3 + k \times IQR] </code>
</p>

<p>where <code class="reqn">Q_1</code> and <code class="reqn">Q_3</code> are respectively the 1st and the 3rd quartile of <code>x</code>, while <code class="reqn">IQR=(Q_3 - Q_1)</code> is the Inter-Quartile Range. The value <code class="reqn">k=1.5</code> (said 'inner fences') is commonly used when drawing a boxplot. Values <code class="reqn">k=2</code> and  <code class="reqn">k=3</code> provide middle and outer fences, respectively.
</p>
<p>When <code>method="asymmetric"</code> the outlying observations are those outside the interval: 
</p>
<p style="text-align: center;"><code class="reqn">[Q_1 - 2k \times (Q_2-Q_1);\quad  Q_3 + 2k \times (Q_3-Q_2)] </code>
</p>

<p>being <code class="reqn">Q_2</code> the median; such a modification allows to account for slight skewness of the distribution. 
</p>
<p>Finally, when <code>method="adjbox"</code> the outlying observations are identified using the method proposed by Hubert and Vandervieren (2008) and based on the Medcouple measure of skewness; in practice the bounds are: 
</p>
<p style="text-align: center;"><code class="reqn">[Q_1-1.5 \times e^{aM} \times IQR;\quad  Q_3+1.5 \times e^{bM}\times IQR ]</code>
</p>

<p>Where M is the medcouple; when <code class="reqn">M &gt; 0</code> (positive skewness) then <code class="reqn">a = -4</code> and <code class="reqn">b = 3</code>; on the contrary <code class="reqn">a = -3</code> and <code class="reqn">b = 4</code> for negative skewness (<code class="reqn">M &lt; 0</code>). This adjustment of the boxplot, according to Hubert and Vandervieren (2008), works with moderate skewness (<code class="reqn">-0.6 \leq M \leq 0.6</code>). The bounds of the adjusted boxplot are derived by applying the function <code><a href="robustbase.html#topic+adjboxStats">adjboxStats</a></code> in the package <span class="pkg">robustbase</span>.
</p>
<p>When weights are available (passed via the argument <code>weights</code>) then they are used in the computation of the quartiles. In particular, the quartiles are derived using the function  <code><a href="Hmisc.html#topic+wtd.quantile">wtd.quantile</a></code> in the package <span class="pkg">Hmisc</span>.  
</p>
<p>Remember that when asking a log transformation (argument <code>logt=TRUE</code>) all the estimates (quartiles, etc.) will refer to <code class="reqn">log(x+1)</code>.
</p>


<h3>Value</h3>

<p>The output is a list containing the following components:
</p>
<table>
<tr><td><code>quartiles</code></td>
<td>

<p>The quartiles of <code>x</code> after discarding the values in the <code>exclude</code> argument. When weights are provided they are used in quartiles estimation trough the function  <code><a href="Hmisc.html#topic+wtd.quantile">wtd.quantile</a></code> in the package <span class="pkg">Hmisc</span>.
</p>
</td></tr>
<tr><td><code>fences</code></td>
<td>

<p>The bounds of the interval, values outside the interval are detected as outliers.
</p>
</td></tr>
<tr><td><code>excluded</code></td>
<td>

<p>The identifiers or positions (when <code>id=NULL</code>) of units in <code>x</code> excluded by the computations, according to the argument <code>exclude</code>.
</p>
</td></tr>
<tr><td><code>outliers</code></td>
<td>

<p>The identifiers or positions (when <code>id=NULL</code>) of units in <code>x</code> detected as outliers.
</p>
</td></tr>
<tr><td><code>lowOutl</code></td>
<td>

<p>The identifiers or positions (when <code>id=NULL</code>) of units in <code>x</code> detected as outliers in the lower tail of the distribution.
</p>
</td></tr>
<tr><td><code>upOutl</code></td>
<td>

<p>The identifiers or positions (when <code>id=NULL</code>) of units in <code>x</code> detected as outliers in the upper tail of the distribution.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marcello D'Orazio <a href="mailto:mdo.statmatch@gmail.com">mdo.statmatch@gmail.com</a>
</p>


<h3>References</h3>

<p>McGill, R., Tukey, J. W. and Larsen, W. A. (1978) &lsquo;Variations of box plots&rsquo;. <em>The American Statistician</em>, 32, pp. 12-16.
</p>
<p>Hubert, M., and Vandervieren, E. (2008) &lsquo;An Adjusted Boxplot for Skewed Distributions&rsquo;, <em>Computational Statistics and Data Analysis</em>, 52, pp. 5186-5201.
</p>


<h3>See Also</h3>

<p><code><a href="robustbase.html#topic+adjboxStats">adjboxStats</a></code>, <code><a href="Hmisc.html#topic+wtd.quantile">wtd.quantile</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(321)
x &lt;- rnorm(30, 50, 10)
x[10] &lt;- 1
x[20] &lt;- 100

out &lt;- boxB(x = x, k = 1.5, method = 'asymmetric')
out$fences
out$outliers
x[out$outliers]

out &lt;- boxB(x = x, k = 1.5, method = 'adjbox')
out$fences
out$outliers
x[out$outliers]

x[24] &lt;- NA
x.ids &lt;- paste0('obs',1:30)
out &lt;- boxB(x = x, k = 1.5, method = 'adjbox', id = x.ids)
out$excluded
out$fences
out$outliers

set.seed(111)
w &lt;- round(runif(n = 30, min=1, max=10))
out &lt;- boxB(x = x, k = 1.5, method = 'adjbox', id = x.ids, weights = w)
out$excluded
out$fences
out$outliers

</code></pre>

<hr>
<h2 id='HBmethod'>
Hidiroglou-Berthelot procedure for detecting outliers with periodic data
</h2><span id='topic+HBmethod'></span>

<h3>Description</h3>

<p>This function implements the method proposed by Hidiroglou and Berthelot (1986) to identify outliers in periodic data, i.e. when the same variable is measured at two time points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>HBmethod(yt1, yt2, U=0.5, A=0.05, C=4, pct=0.25,
         id=NULL, std.score=FALSE, return.dataframe=FALSE, adjboxE=FALSE)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="HBmethod_+3A_yt1">yt1</code></td>
<td>

<p>Numeric vector providing the values observed at time t1.
</p>
</td></tr>
<tr><td><code id="HBmethod_+3A_yt2">yt2</code></td>
<td>

<p>Numeric vector providing the values observed at time t2 (t2 &gt; t1).
</p>
</td></tr>
<tr><td><code id="HBmethod_+3A_u">U</code></td>
<td>

<p>Numeric, parameter needed to determine the &lsquo;importance&rsquo; of a ratio. The value should lie in [0, 1] interval; commonly used values are 0.3, 0.4, or 0.5 (default) (see Details for further information).
</p>
</td></tr>
<tr><td><code id="HBmethod_+3A_a">A</code></td>
<td>

<p>Numeric, parameter needed when computing the scale measure used to derive the bounds. Hidiroglou and Berthelot (1986) suggest setting <code class="reqn">A = 0.05</code> (default) (see Details for further information).
</p>
</td></tr>
<tr><td><code id="HBmethod_+3A_c">C</code></td>
<td>

<p>Numeric, parameter determining the extension of the interval; greater values will provide larger intervals, i.e. fewer expected outliers. Values commonly used are 4 (default) or 7, but also values close or grater than 40 can be used in some particular cases. Note that two C values can be provided instead of one, the first one will be used to determine the left tail bound, while the second determines the right tail bound; this setting can help in improving outlier detection in skewed distributions (see Details for further information).
</p>
</td></tr>
<tr><td><code id="HBmethod_+3A_pct">pct</code></td>
<td>

<p>Numeric, the percentage point of the scores that will be used to calculate the lower and upper bounds. By default, <code>pct = 0.25</code>, i.e. quartiles Q1 and Q3 are considered. In some cases, as suggested by Hidiroglou and Emond (2018), using <code>pct = 0.10</code>, i.e. percentiles P10 and P90, may be a better choice. Se Details for further information.   
</p>
</td></tr>
<tr><td><code id="HBmethod_+3A_id">id</code></td>
<td>

<p>Optional numeric or character vector, with identifiers of units. If <code>id=NULL</code> units identifiers will be set equal to their position.
</p>
</td></tr>
<tr><td><code id="HBmethod_+3A_std.score">std.score</code></td>
<td>

<p>Logical, if <code>TRUE</code> the output will include a standardized score variable (see Details, for further information)
</p>
</td></tr>
<tr><td><code id="HBmethod_+3A_return.dataframe">return.dataframe</code></td>
<td>

<p>Logical, if <code>TRUE</code> the output will save all the relevant information for outlier detection in a dataframe with the following columns: 'id' (units' identifiers), &lsquo;yt1&rsquo;, &lsquo;yt2&rsquo;, &lsquo;ratio&rsquo; (= yt1/yt2), &lsquo;sizeU&rsquo; (=max(yt1, yt2)^U),&lsquo;Escore&rsquo; (the E scores, see Details), &lsquo;std.Escore&rsquo; (the standardized E scores when <code>std.score=TRUE</code>, see Details) and finally &lsquo;outliers&rsquo;, where value 1 indicates observations detected as an outlier, 0 otherwise.  
</p>
</td></tr>
<tr><td><code id="HBmethod_+3A_adjboxe">adjboxE</code></td>
<td>

<p>Logical (default <code>FALSE</code>), if <code>TRUE</code> an additional search of outliers will be done on the E-scores using the boxplot adjusted for skewness as implemented in the function <code><a href="#topic+boxB">boxB</a></code> when run with with argument <code>method = "adjbox"</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The method proposed by Hidiroglou and Berthelot (1986) to identify outliers in periodic data consists in deriving a score variable based on the ratios <code class="reqn">r_i = y_{i,t2}/y_{i,t1}</code> (<code>yt2/yt1</code>) with <code class="reqn">i=1,2,\ldots, n</code> being <code class="reqn">n</code> the number of observations after discarding NAs and 0s in both <code>yt1</code> and <code>yt2</code>.
</p>
<p>At first the ratios are centered around their median <code class="reqn">r_M</code>:
</p>
<p style="text-align: center;"><code class="reqn">s_i = 1 - r_M/r_i \qquad \mbox{if} \qquad 0 &lt; r_i &lt; r_M</code>
</p>

<p style="text-align: center;"><code class="reqn">s_i = r_i/r_M - 1  \qquad \mbox{if} \qquad r_i \geq r_M</code>
</p>

<p>Then, in order to account for the magnitude of data, the following score is derived:
</p>
<p style="text-align: center;"><code class="reqn">E_i = s_i \times [ max(y_{i,t1},y_{i,t2} ) ]^U</code>
</p>
 
<p>Finally, the interval is calculated as:
</p>
<p style="text-align: center;"><code class="reqn">(E_M-C \times d_{Q1}, E_M+C\times d_{Q3} )</code>
</p>

<p>where 
</p>
<p><code class="reqn">d_{Q1} = max( E_M - E_{Q1}, |A \times E_M| ) </code> and <code class="reqn">d_{Q3} = max( E_{Q3} - E_M, |A \times E_M| ) </code>
</p>
<p>being <code class="reqn">E_{Q1}</code>, <code class="reqn">E_M</code> and <code class="reqn">E_{Q3}</code> the quartiles of the E scores (when <code>pct = 0.25</code>, default)).
Recently Hidiroglou and Emond (2018) suggest using percentiles P10 and P90 of the E scores in replacement of respectively Q1 and Q3  to avoid the drawback of many units identified as outliers; this is likely to occur when a large proportion of units (&gt;1/4) has the same ratio. P10 and P90 are achieved by setting <code>pct = 0.10</code> when running the function. 
</p>
<p>In practice, all the units with an E score outside the interval are considered as outliers. Notice that when two <code>C</code> values are provided, then the first is used to derive the left bound while the second determines the right bound.
</p>
<p>When <code>std.score=TRUE</code> a standardized score is derived in the following manner:
</p>
<p style="text-align: center;"><code class="reqn">z_{E,i} = g \times \frac{E_i - E_M}{d_{Q1}} \qquad \mbox{if} \qquad  E_i &lt; E_M</code>
</p>

<p style="text-align: center;"><code class="reqn">z_{E,i} = g \times \frac{E_i - E_M}{d_{Q3}} \qquad \mbox{if} \qquad  E_i \geq E_M</code>
</p>

<p>The constant g is set equal to <code>qnorm(1-pct)</code> and  makes <code class="reqn">d_{Q1}</code> and  <code class="reqn">d_{Q3}</code> approximately unbiased estimators when the E scores follow the normal distribution.
</p>
<p>When <code>adjboxE = TRUE</code> outliers on the E scores will all be searched using the boxplot adjusted for skewness as implemented in the function <code><a href="#topic+boxB">boxB</a></code> when run with with argument <code>method = "adjbox"</code>.
</p>


<h3>Value</h3>

<p>A list whose components depend on the <code>return.dataframe</code> argument. When <code>return.dataframe=FALSE</code> just the following components are provided:
</p>
<table>
<tr><td><code>median.r</code></td>
<td>
<p>the median of the ratios</p>
</td></tr>
<tr><td><code>quartiles.E</code></td>
<td>
<p>Quartiles of the E score</p>
</td></tr>
<tr><td><code>bounds.E</code></td>
<td>
<p>Bounds of the interval of the E score, values outside are considered outliers.</p>
</td></tr>
<tr><td><code>excluded</code></td>
<td>

<p>The identifiers or positions (when <code>id=NULL</code>) of units in both <code>yt1</code> and <code>yt2</code> that are excluded by the outliers detection, i.e. NAs and 0s.
</p>
</td></tr>
<tr><td><code>outliers</code></td>
<td>

<p>The identifiers or positions (when <code>id=NULL</code>) of units in <code>yt1</code> or <code>yt2</code> identified as outliers.
</p>
</td></tr>
<tr><td><code>outliersBB</code></td>
<td>

<p>The identifiers or positions (when <code>id=NULL</code>) of units in <code>yt1</code> or <code>yt2</code> identified as outliers by applying the boxplot adjusted for skewness to the E scores. This component appears in the output only when <code>adjboxE = TRUE</code>.
</p>
</td></tr>
</table>
<p>When <code>return.dataframe=TRUE</code>, the first three components remain the same with, in addition, two dataframes:
</p>
<table>
<tr><td><code>excluded</code></td>
<td>

<p>A dataframe with the subset of observations excluded. The data frame has the following columns: 'id' (units' identifiers), 'yt1' columns 'yt2'</p>
</td></tr>
<tr><td><code>data</code></td>
<td>

<p>A dataframe with the the not excluded observations and the following columns: &lsquo;id&rsquo; (units' identifiers), &lsquo;yt1&rsquo;, &lsquo;yt2&rsquo;, &lsquo;ratio&rsquo; (= yt1/yt2), &lsquo;sizeU&rsquo; (=max(yt1, yt2)^U),&lsquo;Escore&rsquo; (the E scores, see Details), &lsquo;std.Escore&rsquo; (the standardized E scores when <code>std.score=TRUE</code>, see Details) and &lsquo;outliers&rsquo;, where value 1 indicates observations detected as an outlier, 0 otherwise. in addition the column &lsquo;outliersBB&rsquo; will also be included when <code>adjboxE = TRUE</code>. 
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marcello D'Orazio <a href="mailto:mdo.statmatch@gmail.com">mdo.statmatch@gmail.com</a>
</p>


<h3>References</h3>

<p>Hidiroglou, M.A. and Berthelot, J.-M. (1986) &lsquo;Statistical editing and Imputation for Periodic Business Surveys&rsquo;. <em>Survey Methodology</em>, Vol 12, pp. 73-83.
</p>
<p>Hidiroglou, M.A. and Emond, N. (2018) &lsquo;Modifying the Hidiroglou-Berthelot (HB) method&rsquo;. <em>Unpublished note</em>, Business Survey Methods Division, Statistics Canada, May 18 2018.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot4ratios">plot4ratios</a></code>, <code><a href="#topic+ratioSize">ratioSize</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(222)
x0 &lt;- rnorm(30, 50, 5)
x0[1] &lt;- NA
set.seed(333)
rr &lt;- runif(30, 0.9, 1.2)
rr[10] &lt;- 2
x1 &lt;- x0 * rr
x1[20] &lt;- 0

out &lt;- HBmethod(yt1 = x0, yt2 = x1)
out$excluded
out$median.r
out$bounds.E
out$outliers
cbind(x0[out$outliers], x1[out$outliers])

out &lt;- HBmethod(yt1 = x0, yt2 = x1,  
                return.dataframe = TRUE)
out$excluded
head(out$data)

</code></pre>

<hr>
<h2 id='LocScaleB'>
Univariate outlier detection with bounds based on robust location and scale estimates
</h2><span id='topic+LocScaleB'></span>

<h3>Description</h3>

<p>This function identifies outliers in the tails of a distribution by detecting the observations outside the bounds built using a robust estimate of both location and scale parameters.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LocScaleB(x, k=3, method='MAD',  weights=NULL, id=NULL, 
          exclude=NA, logt=FALSE, return.dataframe=FALSE)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LocScaleB_+3A_x">x</code></td>
<td>

<p>Numeric vector that will be searched for outliers.
</p>
</td></tr>
<tr><td><code id="LocScaleB_+3A_k">k</code></td>
<td>

<p>Nonnegative constant that determines the extension of bounds. Commonly used values are 2, 2.5 and 3 (default).
</p>
</td></tr>
<tr><td><code id="LocScaleB_+3A_method">method</code></td>
<td>

<p>character identifying how to estimate the scale of the distribution. Available choices are:
</p>
<p><code>method='IQR'</code> for using the Inter-Quartile Range, i.e. Q3-Q1; 
</p>
<p><code>method='IDR'</code> for using the Inter-Decile Range; i.e. P90-P10 
</p>
<p><code>method='MAD'</code> for using the Median Absolute Deviation;
</p>
<p><code>method='Gini'</code> robust scale estimate based on Gini's Mean Difference (see  <code><a href="Hmisc.html#topic+GiniMd">GiniMd</a></code>); 
</p>
<p><code>method='ScaleTau2'</code> robust tau-estimate of univariate scale, as proposed by Maronna and Zamar (2002) (see also<code><a href="robustbase.html#topic+scaleTau2">scaleTau2</a></code>); 
</p>
<p><code>method='Qn'</code> for using the Qn estimator proposed by Rousseeuw and Croux (1993) (see also <code><a href="robustbase.html#topic+Qn">Qn</a></code>); 
</p>
<p><code>method='Sn'</code> for using the Sn estimator proposed by Rousseeuw and Croux (1993) (see also <code><a href="robustbase.html#topic+Sn">Sn</a></code>). 
</p>
<p>When <code>method='dQ'</code> the estimated scale for the left tail is (Q2-Q1)/0.6745, while for the right tail it is considered (Q3-Q2)/0.6745 (Q2 is the median); this double estimate should be able to account for slight skewness.
</p>
<p>When <code>method='dD'</code> the estimated scale for the left tail is (P50-P10)/1.2816, while for the right tail it is considered (P90-P50)/1.2816 (P50 is the median); this double estimate should be able to account for skewness.
</p>
<p>Finally, when <code>method='AdjOut'</code>, bounds are based on the adjusted outlyingness method as proposed by Hubert and Van der Veeken (2008).
</p>
</td></tr>
<tr><td><code id="LocScaleB_+3A_weights">weights</code></td>
<td>

<p>Optional numeric vector that provides weights associated to observations. Only nonnegative weights  are allowed. Note that weights can only be used when <code>method='MAD'</code>, <code>method='IQR'</code>,  <code>method='IDR'</code>, <code>method='dQ'</code> or <code>method='dD'</code>.
</p>
</td></tr>
<tr><td><code id="LocScaleB_+3A_id">id</code></td>
<td>

<p>Optional numeric or character vector, with identifiers of units in <code>x</code>. If <code>id=NULL</code> (default) units' identifiers will be set equal to their position in <code>x</code>.
</p>
</td></tr>
<tr><td><code id="LocScaleB_+3A_exclude">exclude</code></td>
<td>

<p>Values of <code>x</code> that will be excluded by the analysis. By default missing values (<code>exclude = NA</code>)
</p>
</td></tr>
<tr><td><code id="LocScaleB_+3A_logt">logt</code></td>
<td>

<p>Logical, if <code>TRUE</code>, before searching outliers the <code>x</code> variable is log-transformed (<code>log(x+1)</code> is considered). Note that in this case that summary output (bounds, etc.) will refer to log-transformed variable.
</p>
</td></tr>
<tr><td><code id="LocScaleB_+3A_return.dataframe">return.dataframe</code></td>
<td>

<p>Logical, if <code>TRUE</code> the output will save all the relevant information for outlier detection in a dataframe with the following columns: &lsquo;id&rsquo; (units' identifiers), &lsquo;x&rsquo;, &lsquo;log.x&rsquo; (only if <code>logt=TRUE</code>), &lsquo;weight&rsquo; (only when argument <code>weights</code> is provided), &lsquo;score&rsquo; (the standardized scores, see Details) and, finally, &lsquo;outliers&rsquo;, where value 1 indicates observations detected as an outlier, 0 otherwise.  
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The intervals are derived by considering the median <code class="reqn">Q_2</code> as a robust location estimate while different robust scale estimators are considered:
</p>
<p style="text-align: center;"><code class="reqn">[Q_2 - k \times \tilde{s}_L; \quad Q_2 + k \times \tilde{s}_R]</code>
</p>

<p>where <code class="reqn">\tilde{s}_L</code> and <code class="reqn"> \tilde{s}_R</code> are robust scale estimates. 
With most of the methods <code class="reqn">\tilde{s}_L=\tilde{s}_R</code> with exception of <code>method='dQ'</code> and <code>method='dD'</code> where respectively:
</p>
<p style="text-align: center;"><code class="reqn">\tilde{s}_L = (Q_2 - Q_1)/0.6745 \qquad \mbox{and} \qquad \tilde{s}_R = (Q_3 - Q_2)/0.6745</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">\tilde{s}_L = (P_{50} - P_{10})/1.2816 \qquad \mbox{and} \qquad \tilde{s}_R = (P_{90} - P_{50})/1.2816</code>
</p>

<p>Note that when <code>method='dQ'</code> or <code>method='dD'</code> the function calculates and prints a the Bowley's coefficient of skewness, that uses Q1, Q2 and Q3 (they are replaced by respectively P10, P50 and P90 when <code>method='dD'</code>). 
</p>
<p>With <code>method='AdjOut'</code> the following estimates are considered: 
</p>
<p style="text-align: center;"><code class="reqn">\tilde{s}_L = (Q_2 - f_L) \qquad \mbox{and} \qquad \tilde{s}_R = (f_R - Q_2)</code>
</p>

<p>being <code class="reqn">f_R</code> and <code class="reqn">f_L</code> derived starting from the fences of the adjusted boxplot (Hubert and Vandervieren, 2008; see <code><a href="robustbase.html#topic+adjboxStats">adjboxStats</a></code>). In addition the medcouple (<code><a href="robustbase.html#topic+mc">mc</a></code>) measure of skewness is calculated and printed on the screen.
</p>
<p>When weights are available (passed via the argument <code>weights</code>) then they are used in the computation of the quartiles. In particular, the quartiles are derived using the function  <code><a href="Hmisc.html#topic+wtd.quantile">wtd.quantile</a></code> in the package <span class="pkg">Hmisc</span>. Note that their use is allowed just with <code>method='IQR'</code>, <code>method='IDR'</code>, <code>method='dQ'</code>, <code>method='dD'</code> or   <code>method='AdjOut'</code>.
</p>
<p>The &lsquo;score&rsquo; variable reported in the the <code>data</code> dataframe when <code>return.dataframe=TRUE</code> is the standardized score derived as (x - Median)/scale.  
</p>


<h3>Value</h3>

<p>A list whose components depend on the <code>return.dataframe</code> argument. When <code>return.dataframe = FALSE</code> just the following components are provided:
</p>
<table>
<tr><td><code>pars</code></td>
<td>
<p>Vector with estimated median and scale parameters</p>
</td></tr>
<tr><td><code>bounds</code></td>
<td>
<p>The bounds of the interval, values outside the interval are considered outliers.</p>
</td></tr>
<tr><td><code>excluded</code></td>
<td>

<p>The position or identifiers of <code>x</code> values excluded by outlier detection, according to the argument <code>exclude</code>
</p>
</td></tr>
<tr><td><code>outliers</code></td>
<td>

<p>The position or identifiers of <code>x</code> values detected as outliers (outside bounds).
</p>
</td></tr>
<tr><td><code>lowOutl</code></td>
<td>

<p>The identifiers or positions (when <code>id=NULL</code>) of units in <code>x</code> detected as outliers in the lower tail of the distribution.
</p>
</td></tr>
<tr><td><code>upOutl</code></td>
<td>

<p>The identifiers or positions (when <code>id=NULL</code>) of units in <code>x</code> detected as outliers in the upper tail of the distribution.
</p>
</td></tr>
</table>
<p>When <code>return.dataframe=TRUE</code> the latter two components are substituted with two dataframes:
</p>
<table>
<tr><td><code>excluded</code></td>
<td>

<p>A dataframe with the subset of observations excluded.
</p>
</td></tr>
<tr><td><code>data</code></td>
<td>

<p>A dataframe with the the not excluded observations and the following columns: &lsquo;id&rsquo; (units' identifiers), &lsquo;x&rsquo;, &lsquo;log.x&rsquo; (only if <code>logt=TRUE</code>), &lsquo;weight&rsquo; (only when argument <code>weights</code> is provided), &lsquo;score&rsquo; (the standardized scores, see Details) and, finally, &lsquo;outliers&rsquo;, where value 1 indicates observations detected as an outlier and 0 otherwise.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marcello D'Orazio <a href="mailto:mdo.statmatch@gmail.com">mdo.statmatch@gmail.com</a>
</p>


<h3>References</h3>

<p>Hubert, M. and Van der Veeken, S. (2008) &lsquo;Outlier Detection for Skewed Data&rsquo;. <em>Journal of Chemometrics</em>, 22, pp. 235-246.
</p>
<p>Maronna, R.A. and Zamar, R.H. (2002) &lsquo;Robust estimates of location and dispersion of high-dimensional datasets&rsquo; <em>Technometrics</em>, 44, pp. 307-317.
</p>
<p>Rousseeuw, P.J. and Croux, C. (1993) &lsquo;Alternatives to the Median Absolute Deviation&rsquo;, <em>Journal of the American Statistical Association</em> 88, pp. 1273-1283.
</p>
<p>Vanderviere, E. and Huber, M. (2008) &lsquo;An Adjusted Boxplot for Skewed Distributions&rsquo;, <em>Computational Statistics &amp; Data Analysis</em>, 52, pp. 5186-5201
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+mad">mad</a></code>, <code><a href="robustbase.html#topic+scaleTau2">scaleTau2</a></code>, <code><a href="robustbase.html#topic+Qn">Qn</a></code>, <code><a href="robustbase.html#topic+Sn">Sn</a></code>, <code><a href="Hmisc.html#topic+GiniMd">GiniMd</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(333)
x &lt;- rnorm(30, 50, 1)
x[10] &lt;- 1
x[20] &lt;- 100

out &lt;- LocScaleB(x = x,  k = 3, method='MAD')
out$pars
out$bounds
out$outliers
x[out$outliers]

out &lt;- LocScaleB(x = x,  k = 3, method='MAD',
                 return.dataframe = TRUE)
head(out$data)

out &lt;- LocScaleB(x = x, k = 3, method='AdjOut')
out$outliers


</code></pre>

<hr>
<h2 id='plot4ratios'>
Draws a scatter-plot that summarizes the findings of the Hidiroglou-Berthelot outliers' or the ratioSize detection method.
</h2><span id='topic+plot4ratios'></span>

<h3>Description</h3>

<p>The function gets the output of the function of <code>HBmethod</code> or <code>ratioSize</code> when they are ran with the argument <code>return.dataframe = TRUE</code>) to draw a scatter-plot of ratios vs. the corresponding importance measures.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot4ratios(out)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot4ratios_+3A_out">out</code></td>
<td>

<p>Is the output of  <code><a href="#topic+HBmethod">HBmethod</a></code> or <code><a href="#topic+ratioSize">ratioSize</a></code> when they are launched with the argument <code>return.dataframe = TRUE</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function draws a scatter-plot. With the output of <code>HBmethod</code> the ratios (=yt2/yt1) are on Y axis while their importance measure ( max(yt1, yt2)^U) are represented on the X axis. With the output of <code>ratioSize</code> on the Y axis the centered ratios are reported. In addition the acceptance bounds are drawn (blue lines); the dots (in red color) outside the bounds are the outliers. This is considered a useful diagnostic plot to understand how the procedure identifies the outliers.  
</p>


<h3>Value</h3>

<p>A scatter-plot is drawn and, in addition, the output includes a data.frame with the data used to derive the plot.
</p>


<h3>Author(s)</h3>

<p>Marcello D'Orazio <a href="mailto:mdo.statmatch@gmail.com">mdo.statmatch@gmail.com</a>
</p>


<h3>References</h3>

<p>Hidiroglou, M.A. and Berthelot, J.-M. (1986) &lsquo;Statistical editing and Imputation for Periodic Business Surveys&rsquo;. <em>Survey Methodology</em>, Vol 12, pp. 73-83.
</p>
<p>Hidiroglou, M.A. and Emond, N. (2018) &lsquo;Modifying the Hidiroglou-Berthelot (HB) method&rsquo;. <em>Unpublished note</em>, Business Survey Methods Division, Statistics Canada, May 18 2018.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+HBmethod">HBmethod</a></code>, <code><a href="#topic+ratioSize">ratioSize</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generate some data
set.seed(222)
x0 &lt;- rnorm(30, 50, 5)
set.seed(333)
rr &lt;- runif(30, 0.9, 1.2)
rr[10] &lt;- 2
x1 &lt;- x0 * rr

# run HBmethod with argument return.dataframe = TRUE
out &lt;- HBmethod(yt1 = x0, yt2 = x1,  
                return.dataframe = TRUE)
# draw the scatterplot
plot4ratios(out)

</code></pre>

<hr>
<h2 id='ratioSize'>
Identifies outliers on ratios and filter them by a size measure
</h2><span id='topic+ratioSize'></span>

<h3>Description</h3>

<p>Identifies outliers on transformed ratios (centering with respect to their median) using the adjusted boxplot for skewed distributions. Outliers can be sorted/filtered according to a size measure.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ratioSize(numerator, denominator, id=NULL,
          size=NULL, U=1, size.th=NULL, return.dataframe=FALSE)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ratioSize_+3A_numerator">numerator</code></td>
<td>

<p>Numeric vector with the values that go at numerator of the ratio
</p>
</td></tr>
<tr><td><code id="ratioSize_+3A_denominator">denominator</code></td>
<td>

<p>Numeric vector with the values that go at denominator of the ratio
</p>
</td></tr>
<tr><td><code id="ratioSize_+3A_id">id</code></td>
<td>

<p>Optional numeric or character vector, with identifiers of units. If <code>id=NULL</code> units identifiers will be set equal to their positions in <code>x</code>.
</p>
</td></tr>
<tr><td><code id="ratioSize_+3A_size">size</code></td>
<td>

<p>Optional numeric vector providing a measure of the importance of a ratio. If <code>size = NULL</code> the size measure is the maximum value between the numerator and the denominator of each ratio (makes sense if both the variables are observed using the same unit of measure). Observations' importance is also controlled by the argument <code>U</code>.
</p>
</td></tr>
<tr><td><code id="ratioSize_+3A_u">U</code></td>
<td>

<p>Numeric, constant with <code class="reqn">0 &lt; U \leq 1</code> controlling importance of each unit, in practice the final size measure is derived as (size^U). Commonly used values are 0.4, 0.5 or 1 (default).
</p>
</td></tr>
<tr><td><code id="ratioSize_+3A_size.th">size.th</code></td>
<td>

<p>Numeric, size threshold. Can be specified when a size measure is used. In such a case just outliers with a size greater than the threshold will be returned. Note that when argument <code>U</code> is not set equal to 1, then the final threshold will be <code>size.th^U</code>. 
</p>
</td></tr>
<tr><td><code id="ratioSize_+3A_return.dataframe">return.dataframe</code></td>
<td>

<p>Logical, if <code>TRUE</code> the output will save all the relevant information for outlier detection in a dataframe with the following columns: &lsquo;id&rsquo; (units' identifiers), &lsquo;numerator&rsquo;, &lsquo;denominator&rsquo;, &lsquo;ratio&rsquo; (= numerator/denominator), &lsquo;c.ratio&rsquo; (centered ratios, see Details), &lsquo;sizeU&rsquo; (size^U values) and finally &lsquo;outliers&rsquo;, where value 1 indicates observations detected as an outlier and 0 otherwise.  
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function searches for outliers starting from ratios <code>r=numerator/denominator</code>. At first the ratios are centered around their median, as in Hidiroglou Berthelot (1986) procedure (see <code><a href="#topic+HBmethod">HBmethod</a></code>), then the outlier identification is based on the adjusted boxplot for skewed distribution (Hubert and Vandervieren 2008) (see <code><a href="robustbase.html#topic+adjboxStats">adjboxStats</a></code>).
The subset of outliers is sorted in decreasing order according the size measure. If a size threshold is provided then just outliers with  (size^U) &gt; (size.th^U)  will be returned. 
</p>


<h3>Value</h3>

<p>A list whose components depend on the <code>return.dataframe</code> argument. When <code>return.dataframe = FALSE</code> just the following components are returned:
</p>
<table>
<tr><td><code>median.r</code></td>
<td>
<p>the median of the ratios</p>
</td></tr>
<tr><td><code>bounds</code></td>
<td>
<p>The bounds of the interval for centered ratios</p>
</td></tr>
<tr><td><code>excluded</code></td>
<td>

<p>The position or the identifiers of the units with values excluded by the computations because of 0s or NAs.
</p>
</td></tr>
<tr><td><code>outliers</code></td>
<td>

<p>The position or the identifiers of the units detected as outliers. Remember that when <code>size.th</code> is set, just outliers with  (size^U) &gt; (size.th^U)  will be returned.  
</p>
</td></tr>
</table>
<p>When <code>return.dataframe=TRUE</code> the latter two components are substituted with two dataframes:
</p>
<table>
<tr><td><code>excluded</code></td>
<td>

<p>A dataframe with the subset of observations excluded 
</p>
</td></tr>
<tr><td><code>data</code></td>
<td>

<p>A dataframe with the not excluded observations with the following columns: &lsquo;id&rsquo; (units' identifiers), &lsquo;numerator&rsquo;, &lsquo;denominator&rsquo;, &lsquo;ratio&rsquo; (= numerator/denominator), &lsquo;c.ratio&rsquo; (centered ratios, see Details), &lsquo;sizeU&rsquo; (size^U values) and finally &lsquo;outliers&rsquo;, where value 1 indicates observations detected as an outlier and 0 otherwise. The data frame will be sorted in decreasing manner according to size^U. Note that when a size threshold is provided then ONLY outliers with  (size^U) &gt; (size.th^U)  will be returned. 
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marcello D'Orazio <a href="mailto:mdo.statmatch@gmail.com">mdo.statmatch@gmail.com</a>
</p>


<h3>References</h3>

<p>Hidiroglou, M.A. and Berthelot, J.-M. (1986) &lsquo;Statistical editing and Imputation for Periodic Business Surveys&rsquo;. <em>Survey Methodology</em>, Vol 12, pp. 73-83.
</p>
<p>Hubert, M., and Vandervieren, E. (2008) &lsquo;An Adjusted Boxplot for Skewed Distributions&rsquo;, <em>Computational Statistics and Data Analysis</em>, 52, pp. 5186-5201.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+HBmethod">HBmethod</a></code>, <code><a href="#topic+plot4ratios">plot4ratios</a></code>, <code><a href="#topic+boxB">boxB</a></code>,<code><a href="robustbase.html#topic+adjboxStats">adjboxStats</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(444)
x1 &lt;- rnorm(30, 50, 5)
set.seed(555)
rr &lt;- runif(30, 0.9, 1.2)
rr[10] &lt;- 2
x2 &lt;- x1 * rr

out &lt;- ratioSize(numerator = x2, denominator = x1)
out

out &lt;- ratioSize(numerator = x2, denominator = x1,
                 return.dataframe = TRUE)
head(out$data)

out &lt;- ratioSize(numerator = x2, denominator = x1,
                 size.th = 65, return.dataframe = TRUE)
head(out$data)


	
</code></pre>

<hr>
<h2 id='skew.misc'>
Calculates some skewness measures.
</h2><span id='topic+skew.misc'></span>

<h3>Description</h3>

<p>The function calculates some skewness measures for the input vector data.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>skew.misc(x, weights=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="skew.misc_+3A_x">x</code></td>
<td>

<p>Input vector containing data for which skewness will be calculated.
</p>
</td></tr>
<tr><td><code id="skew.misc_+3A_weights">weights</code></td>
<td>

<p>Optional vector with eventual non-negative weights associated to the units in <code>x</code>
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calculates Pearson's skewness coefficient, the MedCouple measure of skewness and the non-parametric Bowley's measure of symmetry. The Bowley's skewness measure uses quartiles:
</p>
<p style="text-align: center;"><code class="reqn">b = \frac{(Q_3 - Q_2) - (Q_2 - Q_1) }{Q_3 - Q_1}  </code>
</p>

<p>It ranges between -1 and +1, where positive (negative) values denote right (left) skewness. A value equal to 0 indicates symmetry.
A crude measure of skewness can be obtained with a monotonic increasing function of b:
</p>
<p style="text-align: center;"><code class="reqn"> g=\frac{1+b}{1-b} </code>
</p>

<p>It ranges from 0 to Inf, g=1 indicates symmetry.
</p>
<p>A  measure of skewness similar to the Bowley's one is achieved by replacing Q3 and Q1 with respectively P90 and P10 percentiles:
</p>
<p style="text-align: center;"><code class="reqn">b_P = \frac{(P_{90} - P_{50}) - (P_{50} - P_{10}) }{P_{90} - P_{10}}  </code>
</p>

<p>Similarly
</p>
<p style="text-align: center;"><code class="reqn"> g_P=\frac{1+b_P}{1-b_P} </code>
</p>

<p>For major details see Kotz at al. (2006, vol. 12, pp. 7771-7772).
</p>
<p>The medCouple measure of skewness, M, ranges from -1 to +1 and is equal to 0 in case of symmetry, while <code class="reqn">M &gt; 0</code> indicates positive skewness. For major details see <code><a href="robustbase.html#topic+mc">mc</a></code>.
</p>
<p>Note that eventual weights, passed through the argument <code>weights</code>, are used ONLY in the calculation of the Bowley's type measures. 
</p>


<h3>Value</h3>

<p>A vector with the estimated measures of skewness.
</p>


<h3>Author(s)</h3>

<p>Marcello D'Orazio <a href="mailto:mdo.statmatch@gmail.com">mdo.statmatch@gmail.com</a>
</p>


<h3>References</h3>

<p>Kotz S. et al. (2006) <em>Encyclopedia of Statistical Sciences, Volume 12</em>. John Wiley and Sons.
</p>


<h3>See Also</h3>

<p><code><a href="robustbase.html#topic+mc">mc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(112233)
y &lt;- rnorm(n = 30, mean = 50, sd = 10)
y[20] &lt;- 100

skew.misc(x = y, weights=NULL)

# use weights
ww &lt;- runif(n = 30, min = 1, max = 10)
skew.misc(x = y, weights=ww)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
