<!DOCTYPE html><html><head><title>Help for package chngpt</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {chngpt}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#chngpt'><p>chngpt Package</p></a></li>
<li><a href='#chngpt.test'>
<p>Threshold Model Hypothesis Testing</p></a></li>
<li><a href='#chngptm'>
<p>Threshold Models Estimation</p></a></li>
<li><a href='#coef.0.ls'>
<p>Simulation Study Parameters</p></a></li>
<li><a href='#convert.coef predictx threshold.func'>
<p>Helper functions</p></a></li>
<li><a href='#dat.mtct'>
<p>An Example Dataset</p></a></li>
<li><a href='#dat.mtct.2'>
<p>An Example Dataset</p></a></li>
<li><a href='#double.hinge'>
<p>Fit Double Hinge Models</p></a></li>
<li><a href='#hinge.test'>
<p>A non-nested hypothesis testing problem for threshold regression models</p></a></li>
<li><a href='#lidar'>
<p>Light Detection and Ranging Data</p></a></li>
<li><a href='#nutrition'>
<p>Infant Nutrition Data</p></a></li>
<li><a href='#performance.unit.test'>
<p>Perform unit testing for performance evaluation.</p></a></li>
<li><a href='#sim.alphas'>
<p>Simulation Parameters</p></a></li>
<li><a href='#sim.chngpt'>
<p>Simulation Function</p></a></li>
<li><a href='#sim.hinge'>
<p>Simulation function</p></a></li>
<li><a href='#sim.my'>
<p>Simulate data</p></a></li>
<li><a href='#sim.pastor'>
<p>Simulate data according to one of the scenarios considered in Pastor-Barriuso et al 2003</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>Version:</td>
<td>2023.11-29</td>
</tr>
<tr>
<td>Title:</td>
<td>Estimation and Hypothesis Testing for Threshold Regression</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>R.rsp, RUnit, mvtnorm</td>
</tr>
<tr>
<td>Imports:</td>
<td>survival, splines, kyotil (&ge; 2020.10-12), boot, MASS,
methods, lme4, parallel, RhpcBLASctl</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>R.rsp</td>
</tr>
<tr>
<td>Description:</td>
<td>Threshold regression models are also called two-phase regression, broken-stick regression, split-point regression, structural change models, and regression kink models, with and without interaction terms. Methods for both continuous and discontinuous threshold models are included, but the support for the former is much greater. This package is described in Fong, Huang, Gilbert and Permar (2017) &lt;<a href="https://doi.org/10.1186%2Fs12859-017-1863-x">doi:10.1186/s12859-017-1863-x</a>&gt; and the package vignette.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-11-29 23:40:40 UTC; Youyi</td>
</tr>
<tr>
<td>Author:</td>
<td>Youyi Fong [cre],
  Qianqian Chen [aut],
  Shuangcheng Hua [aut],
  Hyunju Son [aut],
  Adam Elder [aut],
  Tao Yang [aut],
  Zonglin He [aut],
  Simone Giannerini [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Youyi Fong &lt;youyifong@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-12-05 15:30:07 UTC</td>
</tr>
</table>
<hr>
<h2 id='chngpt'>chngpt Package</h2><span id='topic+chngpt'></span>

<h3>Description</h3>

<p>Please see the Index link below for a list of available functions. The main testing function is chngpt.test(). The main estimation function is chngptm().
</p>

<hr>
<h2 id='chngpt.test'>
Threshold Model Hypothesis Testing
</h2><span id='topic+antoch.test'></span><span id='topic+chngpt.test'></span><span id='topic+plot.chngpt.test'></span>

<h3>Description</h3>

<p>Hypothesis testing for threshold models. Only linear models and logistic models are supported at this point.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
chngpt.test (formula.null, formula.chngpt, family=c("binomial","gaussian"), data, 
    type=c("step","hinge","segmented","stegmented"),
    test.statistic=c("lr","score"), # support for score is gradually descreasing
    chngpts=NULL, lb.quantile=.1, ub.quantile=.9, 
    chngpts.cnt=50, #this is set to 25 if int is weighted.two.sided or weighted.one.sided
    prec.weights=NULL,
    p.val.method=c("MC","param.boot"), 
    mc.n=5e4, # 1e3 won't cut it, the p values estimated could be smaller than nominal
    boot.B=1e4,
    robust=FALSE,
    keep.fits=FALSE, verbose=FALSE
) 


antoch.test (formula, data, chngpt.var, plot.=FALSE)

## S3 method for class 'chngpt.test'
plot(x, by.percentile=TRUE, both=FALSE, main=NULL, ...) 

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="chngpt.test_+3A_formula.null">formula.null</code></td>
<td>

<p>formula for the null model. 
</p>
</td></tr>
<tr><td><code id="chngpt.test_+3A_formula.chngpt">formula.chngpt</code></td>
<td>

<p>formula for the change point model. 
For example, suppose formula.null=y~z and we want to test whether I(x&gt;cutff) is a significant predictor, formula.chngpt=~x
If instead we are interested in testing the null that neither I(x&gt;cutff) nor z*I(x&gt;cutff) is a significant predictor, formula.chngpt=~x*z
</p>
</td></tr>
<tr><td><code id="chngpt.test_+3A_data">data</code></td>
<td>
<p>data frame.</p>
</td></tr>
<tr><td><code id="chngpt.test_+3A_family">family</code></td>
<td>
<p>Currently only linear and logistic regression are supported.</p>
</td></tr>
<tr><td><code id="chngpt.test_+3A_type">type</code></td>
<td>
<p>step: flat before and after change point; hinge: flat before and slope after change point; segmented: slope before and after change point</p>
</td></tr>
<tr><td><code id="chngpt.test_+3A_test.statistic">test.statistic</code></td>
<td>
<p>method for testing main effects of some threshold model.</p>
</td></tr>
<tr><td><code id="chngpt.test_+3A_chngpts">chngpts</code></td>
<td>

<p>A grid of potential change points to maximize over. If not supplied, they will be 
set to a vector of length chngpt.cnt equally spaced between lb.quantile and ub.quantile.
</p>
</td></tr>
<tr><td><code id="chngpt.test_+3A_robust">robust</code></td>
<td>

<p>Boolean.
</p>
</td></tr>
<tr><td><code id="chngpt.test_+3A_lb.quantile">lb.quantile</code></td>
<td>

<p>number. The lower bound in the search for change point in the unit of quantile.
</p>
</td></tr>
<tr><td><code id="chngpt.test_+3A_ub.quantile">ub.quantile</code></td>
<td>

<p>number. The upper bound in the search for change point in the unit of quantile.
</p>
</td></tr>
<tr><td><code id="chngpt.test_+3A_chngpts.cnt">chngpts.cnt</code></td>
<td>

<p>integer. Number of potential change points to maximize over.
</p>
</td></tr>
<tr><td><code id="chngpt.test_+3A_mc.n">mc.n</code></td>
<td>

<p>integer. Number of multivariate normal samples to generate in the Monte Carlo procedure to evaluate p-value.
</p>
</td></tr>
<tr><td><code id="chngpt.test_+3A_verbose">verbose</code></td>
<td>

<p>Boolean. 
</p>
</td></tr>
<tr><td><code id="chngpt.test_+3A_chngpt.var">chngpt.var</code></td>
<td>

<p>string. Name of the predictor to detect change point
</p>
</td></tr>
<tr><td><code id="chngpt.test_+3A_plot.">plot.</code></td>
<td>

<p>Boolean. Whether to make a plot.
</p>
</td></tr>
<tr><td><code id="chngpt.test_+3A_formula">formula</code></td>
<td>

<p>formula.
</p>
</td></tr>
<tr><td><code id="chngpt.test_+3A_x">x</code></td>
<td>

<p>An object of type chngpt.test. 
</p>
</td></tr>
<tr><td><code id="chngpt.test_+3A_...">...</code></td>
<td>
<p>arguments passed to or from methods</p>
</td></tr>
<tr><td><code id="chngpt.test_+3A_by.percentile">by.percentile</code></td>
<td>

<p>tbd
</p>
</td></tr>
<tr><td><code id="chngpt.test_+3A_both">both</code></td>
<td>

<p>tbd
</p>
</td></tr>
<tr><td><code id="chngpt.test_+3A_main">main</code></td>
<td>

<p>tbd
</p>
</td></tr>
<tr><td><code id="chngpt.test_+3A_prec.weights">prec.weights</code></td>
<td>

<p>tbd
</p>
</td></tr>
<tr><td><code id="chngpt.test_+3A_p.val.method">p.val.method</code></td>
<td>

<p>tbd
</p>
</td></tr>
<tr><td><code id="chngpt.test_+3A_boot.b">boot.B</code></td>
<td>

<p>tbd
</p>
</td></tr>
<tr><td><code id="chngpt.test_+3A_keep.fits">keep.fits</code></td>
<td>

<p>tbd
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The model under the altnerative is the model under the null plus terms involving the threshold. For example, when the type is segmented and formula.null=~z, formula.chngpt=~x, the model under the null is ~z+x and the model under the alternative is ~z+x+(x-e)_+.
</p>
<p>If there are missing values in the chngpt formula, those rows will be removed from the whole dataset, including null model and chngpt model.
</p>
<p>antoch.test is only implemented for main effect only and is based on Antoch et al. (2004). Also see Fong et al. (2014).
</p>


<h3>Value</h3>

<p>A list of class htest and chngpt.test
</p>
<table>
<tr><td><code>p.value</code></td>
<td>
<p>P-value</p>
</td></tr>
<tr><td><code>family</code></td>
<td>
<p>Family from input</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>Method from input</p>
</td></tr>
</table>


<h3>References</h3>

<p>Fong, Y., Huang, Y., Gilbert, P., Permar S. (2017) chngpt: threshold regression model estimation and inference, BMC Bioinformatics, 18(1):454.
</p>
<p>Fong Y, Di C, and Permar S. (2015) Change-Point Testing in Logistic Regression Models with Interaction Term. Statistics in Medicine. 34:1483&ndash;1494
</p>
<p>Pastor-Barriuso, R. and Guallar, E. and Coresh, J. (2003) Transition models for change-point estimation in logistic regression. Statistics in Medicine. 22:13141
</p>
<p>Antoch, J. and Gregoire, G. and Jaruskova, D. (2004) Detection of structural changes in generalized linear models. Statistics and probability letters. 69:315
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

dat=sim.chngpt("thresholded", "step", n=200, seed=1, beta=1, alpha=-1, x.distr="norm", e.=4, 
    family="binomial")
test=chngpt.test(formula.null=y~z, formula.chngpt=~x, dat, type="step", family="binomial",
    mc.n=10)
test
plot(test)

dat=sim.chngpt("thresholded", "segmented", n=200, seed=1, beta=1, alpha=-1, x.distr="norm", e.=4,
    family="binomial")
test=chngpt.test(formula.null=y~z, formula.chngpt=~x, dat, type="segmented", family="binomial",
    mc.n=10)
test
plot(test)

test = chngpt.test (formula.null=Volume~1, formula.chngpt=~Girth, family="gaussian", data=trees, 
    type="segmented", mc.n=1e4, verbose=FALSE, chngpts.cnt=100, test.statistic="lr")
test
plot(test)


## Not run: 
# not run because otherwise the examples take &gt;5s and that is a problem for R CMD check

# has interaction
test = chngpt.test(formula.null=y~z, formula.chngpt=~x*z, dat, type="step", family="binomial")
test
plot(test)


## End(Not run)


</code></pre>

<hr>
<h2 id='chngptm'>
Threshold Models Estimation
</h2><span id='topic+chngptm'></span><span id='topic+chngptm.xy'></span><span id='topic+chngptm.xy'></span><span id='topic+chngptm.xy'></span><span id='topic+coef.chngptm'></span><span id='topic+residuals.chngptm'></span><span id='topic+vcov.chngptm'></span><span id='topic+plot.chngptm'></span><span id='topic+predict.chngptm'></span><span id='topic+print.chngptm'></span><span id='topic+summary.chngptm'></span><span id='topic+logLik.chngptm'></span><span id='topic+AIC.chngptm'></span><span id='topic+lincomb'></span>

<h3>Description</h3>

<p>Estimate threshold generalized linear models, Cox proportional hazards models, and linear mixed models. Supports 14 types of two-phase (one threshold) models and 1 type of three-phase (two thresholds) model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
chngptm (formula.1, formula.2, family, data, type = c("hinge",
 "M01", "M02", "M03", "M04", "upperhinge", "M10",
 "M20", "M30", "M40", "M21", "M12", "M21c", "M12c",
 "M22", "M22c", "M31", "M13", "M33c", "segmented",
 "M11", "segmented2", "M111", "step", "stegmented"),
 formula.strat = NULL, weights = NULL, offset = NULL,
 REML = TRUE, re.choose.by.loglik = FALSE, est.method =
 c("default", "fastgrid2", "fastgrid", "grid",
 "smoothapprox"), var.type = c("default", "none",
 "robust", "model", "bootstrap", "all"), aux.fit =
 NULL, lb.quantile = 0.05, ub.quantile = 0.95,
 grid.search.max = Inf, test.inv.ci = TRUE,
 boot.test.inv.ci = FALSE, bootstrap.type =
 c("nonparametric", "wild", "sieve", "wildsieve",
 "awb"), m.out.of.n = 0, subsampling = 0, order.max =
 10, ci.bootstrap.size = 1000, alpha = 0.05, save.boot
 = TRUE, b.transition = Inf, tol = 1e-04, maxit = 100,
 chngpt.init = NULL, search.bound = 10, keep.best.fit =
 TRUE, ncpus = 1, verbose = FALSE, ...)
         
chngptm.xy(x, y, type=c("step","hinge","segmented","segmented2","stegmented"),
    ...)

## S3 method for class 'chngptm'
 coef(object, ...)
## S3 method for class 'chngptm'
 residuals(object, ...)
## S3 method for class 'chngptm'
 vcov(object, var.type=NULL, ...)
## S3 method for class 'chngptm'
 print(x, ...)
## S3 method for class 'chngptm'
 predict(object, newdata = NULL, 
 type = c("link", "response", "terms"), ...)
## S3 method for class 'chngptm'
 plot(x, which = NULL, xlim = NULL, ylim = NULL, lwd = 2,
         lcol = "red", lty = 1, add = FALSE, add.points = TRUE,
         add.ci = TRUE, breaks = 20, mark.chngpt = TRUE, xlab =
         NULL, ylab = NULL, plot.individual.line = FALSE, main
         = "", y.adj = NULL, auto.adj.y = FALSE, transform =
         NULL, ...)
## S3 method for class 'chngptm'
 summary(object, var.type = NULL, expo = FALSE,
 show.slope.post.threshold = FALSE, verbose = FALSE,
 boot.type = "perc", ...)
## S3 method for class 'chngptm'
 logLik(object, ...)
## S3 method for class 'chngptm'
 AIC(object, ...)
 

lincomb(object, comb, alpha = 0.05, boot.type = "perc")

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="chngptm_+3A_formula.1">formula.1</code></td>
<td>
<p>The part of formula that is free of terms involving thresholded variables</p>
</td></tr>
<tr><td><code id="chngptm_+3A_formula.2">formula.2</code></td>
<td>
<p>The part of formula that is only composed of thresholded variables</p>
</td></tr>
<tr><td><code id="chngptm_+3A_formula.strat">formula.strat</code></td>
<td>
<p>stratification formula</p>
</td></tr>
<tr><td><code id="chngptm_+3A_family">family</code></td>
<td>
<p>string. coxph or any valid argument that can be passed to glm. But variance estimate is only available for binomial and gaussian (only model-based for latter)</p>
</td></tr>
<tr><td><code id="chngptm_+3A_data">data</code></td>
<td>
<p>data frame.</p>
</td></tr>
<tr><td><code id="chngptm_+3A_type">type</code></td>
<td>
<p>type</p>
</td></tr>
<tr><td><code id="chngptm_+3A_transform">transform</code></td>
<td>
<p>transform</p>
</td></tr>
<tr><td><code id="chngptm_+3A_b.transition">b.transition</code></td>
<td>
<p>Numeric. Controls whether threshold model or smooth transition model. Default to Inf, which correponds to threshold model</p>
</td></tr>
<tr><td><code id="chngptm_+3A_est.method">est.method</code></td>
<td>
<p>default: estimation algorithm will be chosen optimally; fastgrid2: a super fast grid search algorithm, limited to linear regression; grid: plain grid search, works for almost all models; smoothapprox: approximates the likelihood function using a smooth function, only works for some models. fastgrid = fastgrid2, kept for backward compatibility</p>
</td></tr>
<tr><td><code id="chngptm_+3A_var.type">var.type</code></td>
<td>
<p>string. Different methods for estimating covariance matrix and constructing confidence intervals</p>
</td></tr>
<tr><td><code id="chngptm_+3A_aux.fit">aux.fit</code></td>
<td>
<p>a model fit object that is needed for model-robust estimation of covariance matrix</p>
</td></tr>
<tr><td><code id="chngptm_+3A_grid.search.max">grid.search.max</code></td>
<td>
<p>The maximum number of grid points used in grid search. When doing fast grid search, grid.search.max is set to Inf internally because it does not take more time to examine all potential thresholds.</p>
</td></tr>
<tr><td><code id="chngptm_+3A_test.inv.ci">test.inv.ci</code></td>
<td>
<p>Boolean, whether or not to find test-inversion confidence interval for threshold </p>
</td></tr>
<tr><td><code id="chngptm_+3A_ci.bootstrap.size">ci.bootstrap.size</code></td>
<td>
<p>integer, number of bootstrap </p>
</td></tr>
<tr><td><code id="chngptm_+3A_alpha">alpha</code></td>
<td>
<p>double, norminal type I error rate</p>
</td></tr>
<tr><td><code id="chngptm_+3A_save.boot">save.boot</code></td>
<td>
<p>Boolean, whether to save bootstrap samples</p>
</td></tr>
<tr><td><code id="chngptm_+3A_lb.quantile">lb.quantile</code></td>
<td>
<p>lower bound of the search range for change point estimate</p>
</td></tr>
<tr><td><code id="chngptm_+3A_ub.quantile">ub.quantile</code></td>
<td>
<p>upper bound of the search range for change point estimate</p>
</td></tr>
<tr><td><code id="chngptm_+3A_tol">tol</code></td>
<td>
<p>Numeric. Stopping criterion on the coefficient estimate.</p>
</td></tr>
<tr><td><code id="chngptm_+3A_maxit">maxit</code></td>
<td>
<p>integer. Maximum number of iterations in the outer loop of optimization.</p>
</td></tr>
<tr><td><code id="chngptm_+3A_chngpt.init">chngpt.init</code></td>
<td>
<p>numeric. Initial value for the change point.</p>
</td></tr>
<tr><td><code id="chngptm_+3A_weights">weights</code></td>
<td>
<p>passed to glm</p>
</td></tr>
<tr><td><code id="chngptm_+3A_verbose">verbose</code></td>
<td>
<p>Boolean.</p>
</td></tr>
<tr><td><code id="chngptm_+3A_add.points">add.points</code></td>
<td>
<p>Boolean.</p>
</td></tr>
<tr><td><code id="chngptm_+3A_add.ci">add.ci</code></td>
<td>
<p>Boolean.</p>
</td></tr>
<tr><td><code id="chngptm_+3A_add">add</code></td>
<td>
<p>Boolean.</p>
</td></tr>
<tr><td><code id="chngptm_+3A_breaks">breaks</code></td>
<td>
<p>integer.</p>
</td></tr>
<tr><td><code id="chngptm_+3A_ncpus">ncpus</code></td>
<td>
<p>Number of cores to use if the OS is not Windows.</p>
</td></tr>
<tr><td><code id="chngptm_+3A_keep.best.fit">keep.best.fit</code></td>
<td>
<p>Boolean.</p>
</td></tr>
<tr><td><code id="chngptm_+3A_y">y</code></td>
<td>
<p>outcome</p>
</td></tr>
<tr><td><code id="chngptm_+3A_show.slope.post.threshold">show.slope.post.threshold</code></td>
<td>
<p>boolean</p>
</td></tr>
<tr><td><code id="chngptm_+3A_x">x</code></td>
<td>
<p>chngptm fit object.</p>
</td></tr>
<tr><td><code id="chngptm_+3A_newdata">newdata</code></td>
<td>
<p>newdata</p>
</td></tr>
<tr><td><code id="chngptm_+3A_object">object</code></td>
<td>
<p>chngptm fit object.</p>
</td></tr>
<tr><td><code id="chngptm_+3A_...">...</code></td>
<td>
<p>arguments passed to glm or coxph</p>
</td></tr>
<tr><td><code id="chngptm_+3A_m.out.of.n">m.out.of.n</code></td>
<td>
<p>sample size for m-out-of-n bootstrap, default 0 for not doing this type of bootstrap</p>
</td></tr>
<tr><td><code id="chngptm_+3A_subsampling">subsampling</code></td>
<td>
<p>sample size for subsampling bootstrap, default 0 for not doing this type of bootstrap</p>
</td></tr>
<tr><td><code id="chngptm_+3A_boot.test.inv.ci">boot.test.inv.ci</code></td>
<td>
<p>whether to get test inversion CI under bootstrap</p>
</td></tr>
<tr><td><code id="chngptm_+3A_search.bound">search.bound</code></td>
<td>
<p>bounds for search for sloping parameters</p>
</td></tr>
<tr><td><code id="chngptm_+3A_which">which</code></td>
<td>
<p>an integer</p>
</td></tr>
<tr><td><code id="chngptm_+3A_y.adj">y.adj</code></td>
<td>
<p>y.adj</p>
</td></tr>
<tr><td><code id="chngptm_+3A_auto.adj.y">auto.adj.y</code></td>
<td>
<p>auto.adj.y</p>
</td></tr>
<tr><td><code id="chngptm_+3A_xlim">xlim</code></td>
<td>
<p>xlim</p>
</td></tr>
<tr><td><code id="chngptm_+3A_ylim">ylim</code></td>
<td>
<p>ylim</p>
</td></tr>
<tr><td><code id="chngptm_+3A_lwd">lwd</code></td>
<td>
<p>lwd</p>
</td></tr>
<tr><td><code id="chngptm_+3A_lcol">lcol</code></td>
<td>
<p>line col</p>
</td></tr>
<tr><td><code id="chngptm_+3A_mark.chngpt">mark.chngpt</code></td>
<td>
<p>mark.chngpt</p>
</td></tr>
<tr><td><code id="chngptm_+3A_xlab">xlab</code></td>
<td>
<p>xlab</p>
</td></tr>
<tr><td><code id="chngptm_+3A_ylab">ylab</code></td>
<td>
<p>ylab</p>
</td></tr>
<tr><td><code id="chngptm_+3A_offset">offset</code></td>
<td>
<p>offset</p>
</td></tr>
<tr><td><code id="chngptm_+3A_lty">lty</code></td>
<td>
<p>lty</p>
</td></tr>
<tr><td><code id="chngptm_+3A_boot.type">boot.type</code></td>
<td>
<p>lty</p>
</td></tr>
<tr><td><code id="chngptm_+3A_bootstrap.type">bootstrap.type</code></td>
<td>
<p>nonparametric: the default, classical Efron bootstrap, works for homoscedastic and heteroscedastic indepdendent errors; 
sieve: works for homoscedastic autocorrelated errors; 
wild: works for heteroscedastic independent errors; 
wildsieve: works for heteroscedastic autocorrelated errors; 
awb: autoregressive wild bootstrap, also works for heteroscedastic autocorrelated errors, but performance may not be as good as wildsieve</p>
</td></tr>
<tr><td><code id="chngptm_+3A_order.max">order.max</code></td>
<td>
<p>order of autocorrelation for autocorrelated errors in sieve and wildsieve bootstrap</p>
</td></tr>
<tr><td><code id="chngptm_+3A_comb">comb</code></td>
<td>
<p>a vector of combination coefficients that will be used to form an inner product with the estimated slope</p>
</td></tr>
<tr><td><code id="chngptm_+3A_expo">expo</code></td>
<td>
<p>If family is binomial and expo is TRUE, coefficients summary will be shown on the scale of odds ratio instead of slopes</p>
</td></tr>
<tr><td><code id="chngptm_+3A_reml">REML</code></td>
<td>
<p>mixed model fitting - should the estimates be chosen to optimize the REML criterion for a fixed threshold</p>
</td></tr>
<tr><td><code id="chngptm_+3A_re.choose.by.loglik">re.choose.by.loglik</code></td>
<td>
<p>mixed model fitting - should the estimates be chosen to optimize likelihood (REML nor not) or goodness of fit</p>
</td></tr>
<tr><td><code id="chngptm_+3A_plot.individual.line">plot.individual.line</code></td>
<td>
<p>boolean</p>
</td></tr>
<tr><td><code id="chngptm_+3A_main">main</code></td>
<td>
<p>character string</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Without lb.quantile and ub.quantile, finite sample performance of estimator drops considerably!<br />
When est.method is smoothapprox, Newton-Raphson is done with initial values chosen by change point hypothesis testing. The testing procedure may be less subjective to finite sample volatility. <br />
<br />
If var.method is bootstrap, summary of fitted model contains p values for each estimated slope. These p values are approximate p-values, obtained assuming that the bootstrap distributions are normal. <br />
<br />
When var.method is bootstrap and the OS is not Windows, the boot package we use under the hood takes advantage of <code>ncpus</code> cores through parallel::mclapply. <br />
<br />
lincomb can be used to get the estimate and CI for a linear combination of slopes. 
</p>


<h3>Value</h3>

<p>A an object of type chngptm with the following components
</p>
<table>
<tr><td><code>converged</code></td>
<td>
<p>Boolean</p>
</td></tr>
<tr><td><code>coefficients</code></td>
<td>
<p>vector. Estimated coefficients. The last element, named &quot;.chngpt&quot;, is the estimated change point</p>
</td></tr>
<tr><td><code>test</code></td>
<td>
<p>htest. Max score test results</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p>integer. Number of iterations</p>
</td></tr>
</table>


<h3>References</h3>

<p>Son, H, Fong, Y. (2020) Fast Grid Search and Bootstrap-based Inference for Continuous Two-phase Polynomial Regression Models, Environmetrics, in press.
</p>
<p>Elder, A., Fong, Y. (2020) Estimation and Inference for Upper Hinge Regression Models, Environmental and Ecological Statistics, 26(4):287-302.
</p>
<p>Fong, Y. (2019) Fast bootstrap confidence intervals for continuous threshold linear regression, Journal of Computational and Graphical Statistics, 28(2):466-470.
</p>
<p>Fong, Y., Huang, Y., Gilbert, P., Permar S. (2017) chngpt: threshold regression model estimation and inference, BMC Bioinformatics, 18(1):454.
</p>
<p>Fong, Y., Di, C., Huang, Y., Gilbert, P. (2017) Model-robust inference for continuous threshold regression models, Biometrics, 73(2):452-462.
</p>
<p>Pastor-Barriuso, R. and Guallar, E. and Coresh, J. (2003) Transition models for change-point estimation in logistic regression. Statistics in Medicine. 22:13141
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# also see the vignette for examples
    
# threshold linear regression
# for actual use, set ci.bootstrap.size to default or higher
par(mfrow=c(2,2))
types=c("hinge", "segmented", "M02", "M03")
for (type in types) {
    fit=chngptm(formula.1=logratio~1, formula.2=~range, lidar, type=type, family="gaussian", 
        var.type="bootstrap", ci.bootstrap.size=100)
    print(summary(fit))
    for (i in 1:3) plot(fit, which=i)
    out=predict(fit)
    plot(lidar$range, out, main=type)
}


# with weights
dat.1=sim.chngpt("thresholded", "segmented", n=200, seed=1, beta=1, alpha=-1, x.distr="norm", e.=4,
    family="gaussian")
fit.1.a=chngptm(formula.1=y~z, formula.2=~x, family="gaussian", dat.1, type="segmented", 
    est.method="fastgrid", var.type="bootstrap", weights=ifelse(dat.1$x&lt;3.5,100,1)
    , ci.bootstrap.size=10)
summary(fit.1.a)
plot(fit.1.a)
# fit.1.a$vcov$boot.samples

## Not run: 
# likelihood test, combination of slopes
dat=sim.chngpt("thresholded", "segmented", n=200, seed=1, beta=1, alpha=-1, x.distr="norm", e.=4,
    family="gaussian")
fit=chngptm(y~z, ~x, family="gaussian", dat, type="segmented", ci.bootstrap.size=100)
fit.0=lm(y~1,dat)
# likelihood ratio test using lmtest::lrtest
library(lmtest)
lrtest(fit, fit.0)
# estimate the slope after threshold using lincomb function in the chngpt package
lincomb(fit, c(0,0,1,1))

## End(Not run)


# threshold logistic regression
dat.2=sim.chngpt("thresholded", "step", n=200, seed=1, beta=1, alpha=-1, x.distr="norm", e.=4, 
    family="binomial")

fit.2=chngptm(formula.1=y~z, formula.2=~x, family="binomial", dat.2, type="step", est.method="grid")
summary(fit.2) 
# no variance estimates available for discontinuous threshold models such as step
# vcov(fit.2$best.fit) gives the variance estimates for the best model conditional on threshold est

# also supports cbind() formula on left hand side
set.seed(1)
dat.2$success=rbinom(nrow(dat.2), 10, 1/(1 + exp(-dat.2$eta)))
dat.2$failure=10-dat.2$success
fit.2a=chngptm(formula.1=cbind(success,failure)~z, formula.2=~x, family="binomial", dat.2, 
    type="step")


# Poisson example
counts &lt;- c(18,17,15,20,10,20,25,13,12,33,35)
x &lt;- 1:length(counts)
print(d.AD &lt;- data.frame(x, counts))
fit.4=chngptm(formula.1=counts ~ 1, formula.2=~x, data=d.AD, family="poisson", 
    type="segmented", var.type="bootstrap", verbose=1, ci.bootstrap.size=1)
summary(fit.4)

fit.4a=chngptm(formula.1=counts ~ 1, formula.2=~x, data=d.AD, family="quasipoisson", 
    type="segmented", var.type="bootstrap", verbose=1, ci.bootstrap.size=1)



## Not run: 
# Not run because otherwise the examples take &gt;5s and that is a problem for R CMD check

# coxph example
library(survival)
fit=chngptm(formula.1=Surv(time, status) ~ ph.ecog, formula.2=~age, data=lung, family="coxph",
    type="segmented", var.type="bootstrap", ci.bootstrap.size=10)
summary(fit)


# one interaction term (mtcars is part of R default installation)
# est.method will be grid as fastgrid not available for models with interaction terms yet
fit=chngptm(formula.1=mpg ~ hp, formula.2=~hp*drat, mtcars, type="segmented", 
    family="gaussian", var.type="bootstrap", ci.bootstrap.size=10)
summary(fit)



# interaction, upperhinge model, bootstrap
fit=chngptm(formula.1=mpg ~ hp, formula.2=~hp*drat, mtcars, type="M10", 
    family="gaussian", var.type="bootstrap", ci.bootstrap.size=10)
summary(fit)

# more than one interaction term
# subsampling bootstrap confidence interval for step model
fit=chngptm(formula.1=mpg~hp+wt, formula.2=~hp*drat+wt*drat, mtcars, type="step",
    family="gaussian", var.type="bootstrap", ci.bootstrap.size=10)
summary(fit)

# step model, subsampling bootstrap confidence intervals
fit=chngptm(formula.1=mpg~hp, formula.2=~drat, mtcars, type="step",
    family="gaussian", var.type="bootstrap", ci.bootstrap.size=10, verbose=TRUE)
summary(fit)

# higher order threshold models
dat=sim.chngpt(mean.model="thresholded", threshold.type="M22", n=500, seed=1, 
    beta=c(32,2,10, 10), x.distr="norm", e.=6, b.transition=Inf, family="gaussian", 
    alpha=0, sd=0, coef.z=0)
fit.0=chngptm(formula.1=y~z, formula.2=~x, dat, type="M22", family="gaussian", 
    est.method="fastgrid2"); plot(fit.0)

dat=sim.chngpt(mean.model="thresholded", threshold.type="M22c", n=500, seed=1, 
    beta=c(32,2,32, 10), x.distr="norm", e.=6, b.transition=Inf, family="gaussian", 
    alpha=0, sd=0, coef.z=0)
fit.0=chngptm(formula.1=y~z, formula.2=~x, dat, type="M22c", family="gaussian", 
    est.method="fastgrid2"); plot(fit.0)
    

# examples of aux.fit
fit.0=glm(yy~zz+ns(xx,df=3), data, family="binomial")
fit = chngptm (formula.1=yy~zz, formula.2=~xx, family="binomial", data, type="hinge", 
    est.method="smoothapprox", var.type="all", verbose=verbose, aux.fit=fit.0, 
    lb.quantile=0.1, ub.quantile=0.9, tol=1e-4, maxit=1e3)




## End(Not run)

# example of random intercept
dat=sim.twophase.ran.inte(threshold.type="segmented", n=50, seed=1)
fit = chngptm (formula.1=y~z+(1|id), formula.2=~x, family="gaussian", dat, 
    type="segmented", est.method="grid", var.type="bootstrap", ci.bootstrap.size=1)
plot(fit)
out=predict(fit, re.form=NA)
plot(dat$x, out)
out.1=predict(fit, type="response", re.form=NULL)# includes re
plot(dat$x, out.1, type="p", xlab="x")






</code></pre>

<hr>
<h2 id='coef.0.ls'>
Simulation Study Parameters
</h2><span id='topic+coef.0.ls'></span>

<h3>Description</h3>

<p>The true parameters used in the simulation studies.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("coef.0.ls")</code></pre>


<h3>Format</h3>

<p>The format is list of lists.
</p>

<hr>
<h2 id='convert.coef+20predictx+20threshold.func'>
Helper functions 
</h2><span id='topic+convert.coef'></span><span id='topic+predictx'></span><span id='topic+threshold.func'></span>

<h3>Description</h3>

<p>Some helper functions. predictx returns confidence bands for predictions as functions of the change point variable. threshold.func returns thresholded covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
convert.coef(coef.0, threshold.type)

predictx(fit, boot.ci.type = c("perc", "basic", "symm"), alpha
 = 0.05, xx = NULL, verbose = FALSE, return.boot =
 FALSE, include.intercept = FALSE, get.simultaneous =
 TRUE)
         
threshold.func(threshold.type, coef, xx, x.name, include.intercept=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="convert.coef+2B20predictx+2B20threshold.func_+3A_include.intercept">include.intercept</code></td>
<td>

<p>coef.0
</p>
</td></tr>
<tr><td><code id="convert.coef+2B20predictx+2B20threshold.func_+3A_coef.0">coef.0</code></td>
<td>

<p>coef.0
</p>
</td></tr>
<tr><td><code id="convert.coef+2B20predictx+2B20threshold.func_+3A_threshold.type">threshold.type</code></td>
<td>

<p>threshold.type
</p>
</td></tr>
<tr><td><code id="convert.coef+2B20predictx+2B20threshold.func_+3A_get.simultaneous">get.simultaneous</code></td>
<td>

<p>threshold.type
</p>
</td></tr>
<tr><td><code id="convert.coef+2B20predictx+2B20threshold.func_+3A_return.boot">return.boot</code></td>
<td>

<p>threshold.type
</p>
</td></tr>
<tr><td><code id="convert.coef+2B20predictx+2B20threshold.func_+3A_fit">fit</code></td>
<td>

<p>fit
</p>
</td></tr>
<tr><td><code id="convert.coef+2B20predictx+2B20threshold.func_+3A_boot.ci.type">boot.ci.type</code></td>
<td>

<p>boot.ci.type
</p>
</td></tr>
<tr><td><code id="convert.coef+2B20predictx+2B20threshold.func_+3A_alpha">alpha</code></td>
<td>

<p>alpha
</p>
</td></tr>
<tr><td><code id="convert.coef+2B20predictx+2B20threshold.func_+3A_verbose">verbose</code></td>
<td>

<p>verbose
</p>
</td></tr>
<tr><td><code id="convert.coef+2B20predictx+2B20threshold.func_+3A_coef">coef</code></td>
<td>

<p>coef
</p>
</td></tr>
<tr><td><code id="convert.coef+2B20predictx+2B20threshold.func_+3A_xx">xx</code></td>
<td>

<p>xx
</p>
</td></tr>
<tr><td><code id="convert.coef+2B20predictx+2B20threshold.func_+3A_x.name">x.name</code></td>
<td>

<p>x.name
</p>
</td></tr>
</table>

<hr>
<h2 id='dat.mtct'>
An Example Dataset
</h2><span id='topic+dat.mtct'></span>

<h3>Description</h3>

<p>A dataset from the immune correlates study of Maternal To Child Transmission of HIV-1
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("dat.mtct")</code></pre>


<h3>Format</h3>

<p>A data frame with 236 observations on the following 3 variables.
</p>

<dl>
<dt><code>y</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>birth</code></dt><dd><p>a factor with levels <code>C-section</code> <code>Vaginal</code></p>
</dd>
<dt><code>NAb_SF162LS</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>References</h3>

<p>Permar, S. R., Fong, Y., Nathan Vandergrift, Genevieve G. Fouda, Peter Gilbert, Georgia D. Tomaras, Feng Gao and Barton F. Haynes et al.
(2015) Maternal HIV-1 Envelope variable loop 3-specific IgG responses and reduced risk of perinatal
transmission. Journal of Clinical Investigation, 125(7):2702:2706.
</p>

<hr>
<h2 id='dat.mtct.2'>
An Example Dataset
</h2><span id='topic+dat.mtct.2'></span>

<h3>Description</h3>

<p>A dataset from the immune correlates study of Maternal To Child Transmission of HIV-1
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dat.mtct.2</code></pre>


<h3>Format</h3>

<p>A data frame with 248 observations on the following 2 variables.
</p>

<dl>
<dt><code>NAb_score</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>V3_BioV3B</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>References</h3>

<p>Permar, S. R., Fong, Y., Nathan Vandergrift, Genevieve G. Fouda, Peter Gilbert, Georgia D. Tomaras, Feng Gao and Barton F. Haynes et al.
(2015) Maternal HIV-1 Envelope variable loop 3-specific IgG responses and reduced risk of perinatal
transmission. Journal of Clinical Investigation, 125(7):2702:2706.
</p>

<hr>
<h2 id='double.hinge'>
Fit Double Hinge Models
</h2><span id='topic+double.hinge'></span><span id='topic+plot.double.hinge'></span><span id='topic+fitted.double.hinge'></span><span id='topic+residuals.double.hinge'></span>

<h3>Description</h3>

<p>Fit double hinge models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>double.hinge(x, y, lower.y = NULL, upper.y = NULL,
         var.type = c("none", "bootstrap"), ci.bootstrap.size =
         1000, alpha = 0.05, save.boot = TRUE, ncpus = 1, 
         boot.ci.type=c("percentile","symmetric"))

## S3 method for class 'double.hinge'
 plot(x, which = NULL, xlim = NULL, 
 lwd = 2, lcol = "red",
 lty = 1, add.points = TRUE, add.ci = TRUE, breaks =
 20, mark.chngpt = FALSE, xlab = NULL, ylab = NULL,
 ...) 
## S3 method for class 'double.hinge'
 fitted(object, ...) 
## S3 method for class 'double.hinge'
 residuals(object, ...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="double.hinge_+3A_object">object</code></td>
<td>

<p>x
</p>
</td></tr>
<tr><td><code id="double.hinge_+3A_x">x</code></td>
<td>

<p>x
</p>
</td></tr>
<tr><td><code id="double.hinge_+3A_y">y</code></td>
<td>

<p>y
</p>
</td></tr>
<tr><td><code id="double.hinge_+3A_lower.y">lower.y</code></td>
<td>

<p>lower.y
</p>
</td></tr>
<tr><td><code id="double.hinge_+3A_upper.y">upper.y</code></td>
<td>

<p>upper.y
</p>
</td></tr>
<tr><td><code id="double.hinge_+3A_var.type">var.type</code></td>
<td>

<p>var.type
</p>
</td></tr>
<tr><td><code id="double.hinge_+3A_boot.ci.type">boot.ci.type</code></td>
<td>

<p>var.type
</p>
</td></tr>
<tr><td><code id="double.hinge_+3A_ci.bootstrap.size">ci.bootstrap.size</code></td>
<td>

<p>ci.bootstrap.size
</p>
</td></tr>
<tr><td><code id="double.hinge_+3A_alpha">alpha</code></td>
<td>

<p>alpha
</p>
</td></tr>
<tr><td><code id="double.hinge_+3A_save.boot">save.boot</code></td>
<td>

<p>save.boot
</p>
</td></tr>
<tr><td><code id="double.hinge_+3A_ncpus">ncpus</code></td>
<td>

<p>ncpus
</p>
</td></tr>
<tr><td><code id="double.hinge_+3A_lcol">lcol</code></td>
<td>

<p>ncpus
</p>
</td></tr>
<tr><td><code id="double.hinge_+3A_lwd">lwd</code></td>
<td>

<p>ncpus
</p>
</td></tr>
<tr><td><code id="double.hinge_+3A_which">which</code></td>
<td>

<p>x
</p>
</td></tr>
<tr><td><code id="double.hinge_+3A_xlim">xlim</code></td>
<td>

<p>x
</p>
</td></tr>
<tr><td><code id="double.hinge_+3A_lty">lty</code></td>
<td>

<p>x
</p>
</td></tr>
<tr><td><code id="double.hinge_+3A_add.points">add.points</code></td>
<td>

<p>x
</p>
</td></tr>
<tr><td><code id="double.hinge_+3A_add.ci">add.ci</code></td>
<td>

<p>x
</p>
</td></tr>
<tr><td><code id="double.hinge_+3A_breaks">breaks</code></td>
<td>

<p>x
</p>
</td></tr>
<tr><td><code id="double.hinge_+3A_mark.chngpt">mark.chngpt</code></td>
<td>

<p>x
</p>
</td></tr>
<tr><td><code id="double.hinge_+3A_xlab">xlab</code></td>
<td>

<p>x
</p>
</td></tr>
<tr><td><code id="double.hinge_+3A_ylab">ylab</code></td>
<td>

<p>x
</p>
</td></tr>
<tr><td><code id="double.hinge_+3A_...">...</code></td>
<td>
<p>arguments passed along</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If lower.y and upper.y are not supplied, min(y) is taken as the function value when x is less than or equal to the first threshold, and max(y) is taken as the function value when x is greater than or equal to the second threshold.
</p>
<p>If the function is expected to be decreasing between the two thresholds, lower.y and upper.y should be supplied to ensure the correct fit.
</p>
<p>mse is residual sum of squares
</p>

<hr>
<h2 id='hinge.test'>
A non-nested hypothesis testing problem for threshold regression models
</h2><span id='topic+hinge.test'></span>

<h3>Description</h3>

<p>Test a hinge effect against a linear effect
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hinge.test(formula, cov.interest, family = c("binomial", "gaussian"), data, thres = NA,
    lb.quantile = 0.1, ub.quantile = 0.9, chngpts.cnt = 10, method = c("FDB", "B", "DB"),
    boot.B = 10000, B2 = NA, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hinge.test_+3A_formula">formula</code></td>
<td>

<p>formula
</p>
</td></tr>
<tr><td><code id="hinge.test_+3A_cov.interest">cov.interest</code></td>
<td>

<p>cov.interest
</p>
</td></tr>
<tr><td><code id="hinge.test_+3A_family">family</code></td>
<td>

<p>family
</p>
</td></tr>
<tr><td><code id="hinge.test_+3A_data">data</code></td>
<td>

<p>data
</p>
</td></tr>
<tr><td><code id="hinge.test_+3A_thres">thres</code></td>
<td>

<p>If supplied, this will be the threshold value to use in the hinge model.
</p>
</td></tr>
<tr><td><code id="hinge.test_+3A_lb.quantile">lb.quantile</code></td>
<td>

<p>lower bound of threshold candidates in quantile
</p>
</td></tr>
<tr><td><code id="hinge.test_+3A_ub.quantile">ub.quantile</code></td>
<td>

<p>upper bound of threshold candidates in quantile
</p>
</td></tr>
<tr><td><code id="hinge.test_+3A_chngpts.cnt">chngpts.cnt</code></td>
<td>

<p>number of candidate thresholds 
</p>
</td></tr>
<tr><td><code id="hinge.test_+3A_method">method</code></td>
<td>

<p>type of test. FDB: false double bootstrap, B: parametric bootstrap, DB: double bootstrap.
</p>
</td></tr>
<tr><td><code id="hinge.test_+3A_boot.b">boot.B</code></td>
<td>

<p>number of parametric bootstrap replicates for B and FDB
</p>
</td></tr>
<tr><td><code id="hinge.test_+3A_b2">B2</code></td>
<td>

<p>number of inner bootstrap replicates for DB
</p>
</td></tr>
<tr><td><code id="hinge.test_+3A_verbose">verbose</code></td>
<td>

<p>verbose
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of class htest
</p>
<table>
<tr><td><code>p.value</code></td>
<td>
<p>P-value</p>
</td></tr>
<tr><td><code>chngpts</code></td>
<td>
<p>Vector of change points evaluated</p>
</td></tr>
<tr><td><code>TT</code></td>
<td>
<p>Standardized absolute score statistics</p>
</td></tr>
<tr><td><code>V.S.hat</code></td>
<td>
<p>Estimated variance-covariance matrix of the score statistics</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Zonglin He
</p>


<h3>References</h3>

<p>He, Fong, Fouda, Permar. A non-nested hypothesis testing problem for threshold regression model, under review</p>


<h3>Examples</h3>

<pre><code class='language-R'>
dat=sim.hinge(threshold.type = 'NA',family = 'binomial',thres='NA',X.ditr = 'norm',mu.X = c(0,0,0),
    coef.X = c(0,.5,.5,.4),cov.X = diag(3),eps.sd = 1,seed = 1,n=100)
test=hinge.test(Y~X1+X2, "x", family="binomial", data=dat,'method'='FDB',boot.B=10)
test

</code></pre>

<hr>
<h2 id='lidar'>
Light Detection and Ranging Data
</h2><span id='topic+lidar'></span>

<h3>Description</h3>

<p>LIDAR
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("lidar")</code></pre>


<h3>Format</h3>

<p>A data frame with 221 observations on the following 2 variables.
</p>

<dl>
<dt><code>range</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>logratio</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Source</h3>

<p>Holst, U., Hossjer, O., Bjorklund, C., Ragnarson, P. and Edner, H. (1996), Locally weighted leastsquares kernel regression and statistical evaluation of LIDAR measurements, Environmetrics,7, 401-416.
Wakefield (2013), Bayesian and Frequentist Regression Methods. Chapter 11 Spline and Kernel Methods.
</p>

<hr>
<h2 id='nutrition'>
Infant Nutrition Data
</h2><span id='topic+nutrition'></span>

<h3>Description</h3>

<p>The infant nutrition dataset comprises data collected in a study on the nutrition of infants and preschool children in the north central region of the United States of America.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("nutrition")</code></pre>


<h3>Format</h3>

<p>A data frame with 72 observations on the following 2 variables.
</p>

<dl>
<dt><code>woh</code></dt><dd><p>weight/height ratio</p>
</dd>
<dt><code>age</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Source</h3>

<p>Eppright, E. S., Fox, H. M., Fryer, B. A., Lamkin, G. H., Vivian, V. M., Fuller, E. S. (1972). Nutrition of Infants and Preschool Children in the North Central Region of the United States of America. In World Review of Nutrition and Dietetics (Vol. 14, pp. 269-332). Karger Publishers.
</p>

<hr>
<h2 id='performance.unit.test'>
Perform unit testing for performance evaluation.
</h2><span id='topic+performance.unit.test'></span>

<h3>Description</h3>

<p>This function performs unit testing for performance evaulation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>performance.unit.test(formula.1, formula.2, family, data, B, I)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="performance.unit.test_+3A_formula.1">formula.1</code></td>
<td>

<p>formula.1
</p>
</td></tr>
<tr><td><code id="performance.unit.test_+3A_formula.2">formula.2</code></td>
<td>

<p>formula.2
</p>
</td></tr>
<tr><td><code id="performance.unit.test_+3A_family">family</code></td>
<td>

<p>family
</p>
</td></tr>
<tr><td><code id="performance.unit.test_+3A_data">data</code></td>
<td>

<p>data
</p>
</td></tr>
<tr><td><code id="performance.unit.test_+3A_b">B</code></td>
<td>

<p>B
</p>
</td></tr>
<tr><td><code id="performance.unit.test_+3A_i">I</code></td>
<td>

<p>I
</p>
</td></tr>
</table>

<hr>
<h2 id='sim.alphas'>
Simulation Parameters
</h2><span id='topic+sim.alphas'></span>

<h3>Description</h3>

<p>Simulation Parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(sim.alphas)</code></pre>


<h3>Format</h3>

<p>List of 6. Names: sigmoid2_norm, sigmoid2_norm3, sigmoid3_norm, sigmoid3_norm3, sigmoid4_norm, sigmoid4_norm3. Each element is a 5x4 matrix
</p>

<hr>
<h2 id='sim.chngpt'>
Simulation Function
</h2><span id='topic+sim.twophase.ran.inte'></span><span id='topic+sim.threephase'></span><span id='topic+sim.chngpt'></span>

<h3>Description</h3>

<p>Generate simulation datasets for change point Monte Carlo studies.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
sim.chngpt (mean.model = c("thresholded", "thresholdedItxn",
 "quadratic", "quadratic2b", "cubic2b", "exp",
 "flatHyperbolic", "z2", "z2hinge", "z2segmented",
 "z2linear", "logistic"), threshold.type = c("NA",
 "M01", "M02", "M03", "M10", "M20", "M30", "M11",
 "M21", "M12", "M22", "M22c", "M31", "M13", "M33c",
 "hinge", "segmented", "upperhinge", "segmented2",
 "step", "stegmented"), b.transition = Inf, family =
 c("binomial", "gaussian"), x.distr = c("norm",
 "norm3", "norm6", "imb", "lin", "mix", "gam",
 "zbinary", "gam1", "gam2", "fixnorm", "unif"), e. =
 NULL, mu.x = 4.7, sd.x = NULL, sd = 0.3, mu.z = 0,
 alpha = NULL, alpha.candidate = NULL, coef.z =
 log(1.4), beta = NULL, beta.itxn = NULL,
 logistic.slope = 15, n, seed, weighted = FALSE,
 heteroscedastic = FALSE, ar = FALSE, verbose = FALSE)

sim.twophase.ran.inte(threshold.type, n, seed)

sim.threephase(n, seed, gamma = 1, e = 3, beta_e = 5, f = 7, beta_f = 2, coef.z = 1)



</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim.chngpt_+3A_threshold.type">threshold.type</code></td>
<td>

<p>string. Types of threshold effect to simulate, only applicable when label does not start with sigmoid.
</p>
</td></tr>
<tr><td><code id="sim.chngpt_+3A_family">family</code></td>
<td>

<p>string. Glm family.
</p>
</td></tr>
<tr><td><code id="sim.chngpt_+3A_n">n</code></td>
<td>

<p>n
</p>
</td></tr>
<tr><td><code id="sim.chngpt_+3A_mu.z">mu.z</code></td>
<td>

<p>n
</p>
</td></tr>
<tr><td><code id="sim.chngpt_+3A_seed">seed</code></td>
<td>

<p>seed
</p>
</td></tr>
<tr><td><code id="sim.chngpt_+3A_weighted">weighted</code></td>
<td>

<p>beta
</p>
</td></tr>
<tr><td><code id="sim.chngpt_+3A_beta">beta</code></td>
<td>

<p>beta
</p>
</td></tr>
<tr><td><code id="sim.chngpt_+3A_coef.z">coef.z</code></td>
<td>

<p>numeric. Coefficient for z.
</p>
</td></tr>
<tr><td><code id="sim.chngpt_+3A_beta.itxn">beta.itxn</code></td>
<td>

<p>numeric. Coefficient for z.
</p>
</td></tr>
<tr><td><code id="sim.chngpt_+3A_alpha">alpha</code></td>
<td>

<p>numeric, intercept.
</p>
</td></tr>
<tr><td><code id="sim.chngpt_+3A_mu.x">mu.x</code></td>
<td>

<p>numeric
</p>
</td></tr>
<tr><td><code id="sim.chngpt_+3A_sd.x">sd.x</code></td>
<td>

<p>numeric
</p>
</td></tr>
<tr><td><code id="sim.chngpt_+3A_mean.model">mean.model</code></td>
<td>

<p>numeric
</p>
</td></tr>
<tr><td><code id="sim.chngpt_+3A_x.distr">x.distr</code></td>
<td>

<p>string. Possible values: norm (normal distribution), gam (gamma distribution). gam1 is a hack to allow e. be different
</p>
</td></tr>
<tr><td><code id="sim.chngpt_+3A_e.">e.</code></td>
<td>

<p>e.
</p>
</td></tr>
<tr><td><code id="sim.chngpt_+3A_verbose">verbose</code></td>
<td>

<p>Boolean
</p>
</td></tr>
<tr><td><code id="sim.chngpt_+3A_b.transition">b.transition</code></td>
<td>

<p>b.
</p>
</td></tr>
<tr><td><code id="sim.chngpt_+3A_sd">sd</code></td>
<td>

<p>b.
</p>
</td></tr>
<tr><td><code id="sim.chngpt_+3A_ar">ar</code></td>
<td>

<p>autocorrelation
</p>
</td></tr>
<tr><td><code id="sim.chngpt_+3A_alpha.candidate">alpha.candidate</code></td>
<td>

<p>Candidate values of alpha, used in code to determine alpha values
</p>
</td></tr>
<tr><td><code id="sim.chngpt_+3A_e">e</code></td>
<td>

<p>e
</p>
</td></tr>
<tr><td><code id="sim.chngpt_+3A_beta_e">beta_e</code></td>
<td>

<p>beta_e
</p>
</td></tr>
<tr><td><code id="sim.chngpt_+3A_f">f</code></td>
<td>

<p>f
</p>
</td></tr>
<tr><td><code id="sim.chngpt_+3A_beta_f">beta_f</code></td>
<td>

<p>beta_f
</p>
</td></tr>
<tr><td><code id="sim.chngpt_+3A_logistic.slope">logistic.slope</code></td>
<td>

<p>beta_f
</p>
</td></tr>
<tr><td><code id="sim.chngpt_+3A_gamma">gamma</code></td>
<td>

<p>beta_f
</p>
</td></tr>
<tr><td><code id="sim.chngpt_+3A_heteroscedastic">heteroscedastic</code></td>
<td>
<p>Boolean.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>mean.model, threshold.type and b.transition all affect mean models. 
</p>


<h3>Value</h3>

<p>A data frame with following columns: 
</p>
<table>
<tr><td><code>y</code></td>
<td>
<p>0/1 outcome</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>observed covariate that we are interested in</p>
</td></tr>
<tr><td><code>x.star</code></td>
<td>
<p>unobserved covariate that underlies x</p>
</td></tr>
<tr><td><code>z</code></td>
<td>
<p>additional covariate</p>
</td></tr>
</table>
<p>In addition, columns starting with 'w' are covariates that we also adjust in the model; columns starting with 'x' are covariates derived from x.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
seed=2
par(mfrow=c(2,2))
dat=sim.chngpt(mean.model="thresholded", threshold.type="hinge", family="gaussian", beta=0, n=200, 
    seed=seed, alpha=-1, x.distr="norm", e.=4, heteroscedastic=FALSE)
plot(y~z, dat)
dat=sim.chngpt(mean.model="thresholded", threshold.type="hinge", family="gaussian", beta=0, n=200, 
    seed=seed, alpha=-1, x.distr="norm", e.=4, heteroscedastic=TRUE)
plot(y~z, dat)
dat=sim.chngpt(mean.model="z2", threshold.type="hinge", family="gaussian", beta=1, n=200, 
    seed=seed, alpha=1, x.distr="norm", e.=4, heteroscedastic=FALSE)
plot(y~z, dat)
dat=sim.chngpt(mean.model="z2", threshold.type="hinge", family="gaussian", beta=1, n=200, 
    seed=seed, alpha=1, x.distr="norm", e.=4, heteroscedastic=TRUE)
plot(y~z, dat)

</code></pre>

<hr>
<h2 id='sim.hinge'>
Simulation function
</h2><span id='topic+sim.hinge'></span>

<h3>Description</h3>

<p>Simulate data for Monte Carlo study.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim.hinge(threshold.type = c("NA", "hinge"), family = c("binomial", "gaussian"),
    thres = "NA", X.ditr = "norm", mu.X, coef.X, cov.X, eps.sd, seed, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim.hinge_+3A_threshold.type">threshold.type</code></td>
<td>

<p>threshold.type
</p>
</td></tr>
<tr><td><code id="sim.hinge_+3A_family">family</code></td>
<td>

<p>family
</p>
</td></tr>
<tr><td><code id="sim.hinge_+3A_thres">thres</code></td>
<td>

<p>thres
</p>
</td></tr>
<tr><td><code id="sim.hinge_+3A_x.ditr">X.ditr</code></td>
<td>

<p>X.ditr
</p>
</td></tr>
<tr><td><code id="sim.hinge_+3A_mu.x">mu.X</code></td>
<td>

<p>mu.X
</p>
</td></tr>
<tr><td><code id="sim.hinge_+3A_coef.x">coef.X</code></td>
<td>

<p>coef.X
</p>
</td></tr>
<tr><td><code id="sim.hinge_+3A_cov.x">cov.X</code></td>
<td>

<p>cov.X
</p>
</td></tr>
<tr><td><code id="sim.hinge_+3A_eps.sd">eps.sd</code></td>
<td>

<p>eps.sd
</p>
</td></tr>
<tr><td><code id="sim.hinge_+3A_seed">seed</code></td>
<td>

<p>seed
</p>
</td></tr>
<tr><td><code id="sim.hinge_+3A_n">n</code></td>
<td>

<p>n
</p>
</td></tr>
</table>

<hr>
<h2 id='sim.my'>
Simulate data
</h2><span id='topic+sim.my'></span>

<h3>Description</h3>

<p>Simulate data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim.my(n, seed, label, alpha, beta, e. = NULL, b. = NULL, tr. = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim.my_+3A_n">n</code></td>
<td>

<p>Sample size</p>
</td></tr>
<tr><td><code id="sim.my_+3A_seed">seed</code></td>
<td>

<p>Seed for random number generator
</p>
</td></tr>
<tr><td><code id="sim.my_+3A_label">label</code></td>
<td>

<p>A character string which specifies the simulation scenario. sigmoid4, sigmoidgam4, elbow4
</p>
</td></tr>
<tr><td><code id="sim.my_+3A_alpha">alpha</code></td>
<td>

<p>regression parameter
</p>
</td></tr>
<tr><td><code id="sim.my_+3A_beta">beta</code></td>
<td>

<p>regression parameter
</p>
</td></tr>
<tr><td><code id="sim.my_+3A_e.">e.</code></td>
<td>

<p>inflection point for the logistic transformation (the log scale)
</p>
</td></tr>
<tr><td><code id="sim.my_+3A_b.">b.</code></td>
<td>

<p>slope for the logistic transformation
</p>
</td></tr>
<tr><td><code id="sim.my_+3A_tr.">tr.</code></td>
<td>

<p>threshold point
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When the label starts with elbow, the transformation on x.star is elbow shaped.
When the label starts with sigmoid, the transformation on x.star is sigmoid shaped. 
Data simulated from logit(Pr(Y==1))=alpha + beta*(transformed x.star).
</p>


<h3>Value</h3>

<p>A data frame with columns: y, x.star, x.star.expit (if label starts with sigmoid), x.star.tr (if label starts with elbow), x.bin.med (x.star dichotomized at median), x.tri (x.star trichotomized at tertiles). 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
alpha=-1; beta=log(0.2)
e.=5; b.=-30; t.=1
dat=sim.my(n=250, seed=1, label="sigmoid4", alpha, beta, e.=e., b.=b.)

</code></pre>

<hr>
<h2 id='sim.pastor'>
Simulate data according to one of the scenarios considered in Pastor-Barriuso et al 2003
</h2><span id='topic+sim.pastor'></span>

<h3>Description</h3>

<p>Simulate data according to one of the scenarios considered in Pastor-Barriuso et al 2003
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim.pastor(seed)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim.pastor_+3A_seed">seed</code></td>
<td>

<p>Seed for the random number generator.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with columns: y, x.star, x.star.expit, and x.bin.med (x.star dichotomized at median). 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
dat=sim.pastor(seed=1)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
