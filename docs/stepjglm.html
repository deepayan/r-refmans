<!DOCTYPE html><html><head><title>Help for package stepjglm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {stepjglm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bread_mixture'><p>Bread-making problem data</p></a></li>
<li><a href='#injection_molding'><p>Data from Injection molding experiment</p></a></li>
<li><a href='#stepjglm'><p>Variable selection in joint modeling of mean and dispersion</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Variable Selection for Joint Modeling of Mean and Dispersion</td>
</tr>
<tr>
<td>Version:</td>
<td>0.0.1</td>
</tr>
<tr>
<td>Description:</td>
<td>A Package for selecting variables for the joint modeling of mean and dispersion (including models for mixture experiments) based on hypothesis testing and the quality of model's fit. In each iteration of the selection process, a criterion for checking the goodness of fit is used as a filter for choosing the terms that will be evaluated by a hypothesis test. Pinto &amp; Pereira (2021) &lt;<a href="https://arxiv.org/abs/2109.07978">arXiv:2109.07978</a>&gt;.</td>
</tr>
<tr>
<td>Author:</td>
<td>Leandro A. Pereira [aut, cre],
  Edmilson R. Pinto [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Leandro A. Pereira &lt;leandro.ap@ufu.br&gt;</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), stats</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>Imports:</td>
<td>rsq</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-10-22 18:16:33 UTC; lealv</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-10-25 06:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='bread_mixture'>Bread-making problem data</h2><span id='topic+bread_mixture'></span>

<h3>Description</h3>

<p>Data from a bread-making mixture experiment, to
investigate and to value the final quality of flour.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(bread_mixture)
</code></pre>


<h3>Format</h3>

<p>A data frame containing 90 rows and 6 variables.
</p>
<p>The  response  variable  was considered as the loaf volume after baking with target value of 530 ml.
</p>
<p>Control  variables:
</p>

<ul>
<li> <p><code class="reqn">x_1</code>: Tjalve
</p>
</li>
<li> <p><code class="reqn">x_2</code>: Folke
</p>
</li>
<li> <p><code class="reqn">x_3</code>: HardRed  Spring
</p>
</li></ul>

<p>Process  variables:
</p>

<ul>
<li> <p><code class="reqn">z_1</code>:  mixing  time
</p>
</li>
<li> <p><code class="reqn">z_2</code>: proofing  (resting)  time  of the  dough
</p>
</li></ul>



<h3>Details</h3>

<p>The bread-making problem, originally presented by Faergestad
and Naes (1997),  according  to  Naes  et  al. (1998),
consisted  of  an  experiment  with three ingredients of
mixture and two noise variables,  and had as objective to
investigate and to value the final quality of flour, composed
by different mixtures of wheat flour, for production of bread.
</p>


<h3>References</h3>

<p>Faergestad,  E. M.,  Naes,  T. (1997). Evaluation of baking quality
of wheat flours: I: small scale straight dough baking test of heart bread with
variable mixing time and proofing time. In:  <em>Report MATFORSK</em>, As, Norway.
</p>
<p>Naes, T., Faergestad, E. M., Cornell, J. A. (1998).
A comparison of methods for  analyzing  data  from  a
three  component  mixture  experiment  in  the presence
of variation created by two process variables, <em>Chemometrics
and Intelligence Laboratory Systems</em>, v. 41, pp. 221-235.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bread_mixture)
head(bread_mixture)
</code></pre>

<hr>
<h2 id='injection_molding'>Data from Injection molding experiment</h2><span id='topic+injection_molding'></span>

<h3>Description</h3>

<p>The experiment was performed to study the influence of seven controllable factors and
three noise factors on the mean value and the variation in the percentage of shrinkage of
products made by injection molding.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(injection_molding)
</code></pre>


<h3>Format</h3>

<p>A data frame containing 32 rows and 11 variables.
</p>
<p>The responses were percentages of shrinkage of products made by
injection molding (Y).
</p>
<p>Controllable factors:
</p>

<ul>
<li><p> A: cycle time
</p>
</li>
<li><p> B: mould temperature
</p>
</li>
<li><p> C: cavity thickness
</p>
</li>
<li><p> D: holding pressure
</p>
</li>
<li><p> E: injection speed
</p>
</li>
<li><p> F: holding time
</p>
</li>
<li><p> G: gate size
</p>
</li></ul>

<p>At each setting of the controllable factors, four
observations were obtained from a <code class="reqn">2^{(3-1)}</code>
fractional factorial with three noise factors:
</p>

<ul>
<li><p> M: percentage regrind
</p>
</li>
<li><p> N: moisture content
</p>
</li>
<li><p> O: ambient temperature
</p>
</li></ul>



<h3>Details</h3>

<p>The data set considered is well known in the literature of
industrial experiments and has been analyzed by several
authors such as Engel (1992), Engel and Huele (1996)
and Lee and Nelder (1998). The experiment was performed to study the influence of seven controllable factors and
three noise factors on the mean value and the variation in the percentage of shrinkage of
products made by injection molding.Noise factors are fixed during the
experiment but are expected to vary randomly outside the
experimental context.
</p>
<p>The aim of the experiment was to determine the process
parameter settings so that the shrinkage percentage was
close to the target value and robust against environmental
variations.
</p>


<h3>References</h3>

<p>Engel, J. (1992). Modeling variation in industrial experiments. <em>Applied Statistics</em>, 41, 579-593.
</p>
<p>Engel, J. and Huele, A. F. (1996). A generalized linear modeling approach to robust Design. <em>Technometrics</em>, 38, 365-373.
</p>
<p>Lee, Y. and Nelder, J.A. (1998). Generalized linear models for analysis of quality improvement experiments. <em>The Canadian Journal of Statistics</em>, 26, 95-105.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(injection_molding)
head(injection_molding)
</code></pre>

<hr>
<h2 id='stepjglm'>Variable selection in joint modeling of mean and dispersion</h2><span id='topic+stepjglm'></span>

<h3>Description</h3>

<p>A Procedure for selecting variables in JMMD (including mixture models) based on hypothesis testing and the quality of the model's fit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stepjglm(model,alpha1,alpha2,datafram,family,lambda1=1,lambda2=1,startmod=1,
                 interations=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stepjglm_+3A_model">model</code></td>
<td>
<p>an object of class &quot;formula&quot; (or one that can be coerced to that class): a symbolic description of the model to be fitted. if <code>datafram</code> is a mixture data, <code>datafram</code> doesn't contain the principal mixture components.</p>
</td></tr>
<tr><td><code id="stepjglm_+3A_alpha1">alpha1</code></td>
<td>
<p>significance level for testing add new terms on the mean models.</p>
</td></tr>
<tr><td><code id="stepjglm_+3A_alpha2">alpha2</code></td>
<td>
<p>significance level for testing add new terms on the dispersion models.</p>
</td></tr>
<tr><td><code id="stepjglm_+3A_datafram">datafram</code></td>
<td>
<p>a data frame containing the data.</p>
</td></tr>
<tr><td><code id="stepjglm_+3A_family">family</code></td>
<td>
<p>a character string naming a family function or the result of a call to a family function. For <code>glm.fit</code> only the third option is supported. (See <code>family</code> for details of family functions). Describe the family function for the mean model (families implemented by package <code>stats</code>). For the dispersion model, the Gamma family whit log link is assumed.</p>
</td></tr>
<tr><td><code id="stepjglm_+3A_lambda1">lambda1</code></td>
<td>
<p>some function of the sample size to calculate the <code class="reqn">\tilde{R}_m^{2}</code>  (See Pinto and Pereira (in press) and Zhang (2017) for more details). If equal to 1 (default), uses the standard correction for the <code class="reqn">\tilde{R}_m^{2}</code>. If equal to &quot;EAIC&quot;, uses the <code class="reqn">EAIC</code> criterion.</p>
</td></tr>
<tr><td><code id="stepjglm_+3A_lambda2">lambda2</code></td>
<td>
<p>some function of the sample size to calculate the <code class="reqn">\tilde{R}_d^{2}</code>  (See Pinto and Pereira (in press) and Zhang (2017) for more details). If equal to 1 (default), uses the standard correction for the <code class="reqn">\tilde{R}_d^{2}</code>. If equal to &quot;AIC&quot;, uses the corrected <code class="reqn">AIC_c</code> criterion.</p>
</td></tr>
<tr><td><code id="stepjglm_+3A_startmod">startmod</code></td>
<td>
<p>if <code>datafram</code> is a mixture data, <code>startmod</code> is the principal mixture components, else, <code>startmod</code> must be equal to 1 (default).</p>
</td></tr>
<tr><td><code id="stepjglm_+3A_interations">interations</code></td>
<td>
<p>if <code>TRUE</code> shows the outputs of iterations procedure step by step. The default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function implements a method for selection of variables for both the mean and dispersion models in the JMMD introduced by Nelder and Lee (1991)
considering the <em>Adjusted Quasi Extended Likelihood</em> introduced by Lee and Nelder (1998).
The method is a procedure for  selecting  variables,  based  on  hypothesis  testing  and  the  quality  of  the  model's  fit.
A criterion for checking the goodness of fit is used, in each iteration of the selection process,
as a filter for choosing the terms that will be evaluated by a hypothesis test. For more details on selection algorithms, see Pinto and Pereira (in press).
</p>


<h3>Value</h3>


<table>
<tr>
 <td style="text-align: left;">
<code> model.mean</code>  </td><td style="text-align: left;">   a <code>glm</code> object with the adjustments for the mean model. </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>model.disp</code>  </td><td style="text-align: left;">   a <code>glm</code> object with the adjustments for the dispersion model. </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>EAIC</code> </td><td style="text-align: left;"> a numeric object containing the <em>Extended Akaike Information Criterion</em>.  </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;">  For details, see Wang and Zhang (2009). </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>EQD</code>  </td><td style="text-align: left;"> a numeric object containing the <em>Extended Quasi Deviance</em>. </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;">  For details, see Nelder and Lee (1991). </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>R2m</code>  </td><td style="text-align: left;"> a numeric object containing the standard correction for the <code class="reqn">\tilde{R}_m^{2}</code>.  </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> For details, see Pinto and Pereira (in press). </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>R2d</code>  </td><td style="text-align: left;"> a numeric object containing the standard correction for the <code class="reqn">\tilde{R}_d^{2}</code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> For details, see Pinto and Pereira (in press). </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Leandro Alves Pereira, Edmilson Rodrigues Pinto.
</p>


<h3>References</h3>

<p>Hu, B. and Shao, J. (2008). Generalized linear model selection using <code class="reqn">R^2</code>. <em>Journal of Statistical Planning and Inference</em>, 138, 3705-3712.
</p>
<p>Lee, Y., Nelder, J. A. (1998). Generalized linear models for analysis of quality improvement experiments. <em>The Canadian Journal of Statistics</em>, v. 26, n. 1, pp. 95-105.
</p>
<p>Nelder, J. A., Lee, Y. (1991). Generalized linear models for the analysis of Taguchi-type experiments. <em>Applied Stochastic Models and Data Analysis</em>, v. 7, pp. 107-120.
</p>
<p>Pinto, E. R., Pereira, L. A. (in press). On variable selection in joint modeling of mean and dispersion. <em>Brazilian Journal of Probability and Statistics</em>. Preprint at   <a href="https://arxiv.org/abs/2109.07978">https://arxiv.org/abs/2109.07978</a> (2021).
</p>
<p>Wang, D. and Zhang, Z. (2009). Variable selection in joint generalized linear models. <em>Chinese Journal of Applied Probability and Statistics</em>,  v. 25,  pp.245-256.
</p>
<p>Zhang, D. (2017). A coefficient of determination for generalized linear models. <em>The American Statistician</em>, v. 71, 310-316.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+glm">glm</a></code>
</p>
<p><code><a href="stats.html#topic+summary.glm">summary.glm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Application to the bread-making problem:

data(bread_mixture)

Form =
as.formula(y~ x1:x2+x1:x3+x2:x3+x1:x2:(x1-x2)+x1:x3:(x1-x3)+
            + x1:z1+x2:z1+x3:z1+x1:x2:z1
            + x1:x3:z1+x1:x2:(x1-x2):z1
            + x1:x3:(x1-x3):z1
            + x1:z2+x2:z2+x3:z2+x1:x2:z2
            + x1:x3:z2+x1:x2:(x1-x2):z2
            +x1:x3:(x1-x3):z2)

object=stepjglm(Form,0.1,0.1,bread_mixture,gaussian,sqrt(90),"AIC","-1+x1+x2+x3")

summary(object$modelo.mean)
summary(object$modelo.disp)

object$EAIC  # Print the EAIC for the final model



# Application to the injection molding data:

form = as.formula(Y ~ A*M+A*N+A*O+B*M+B*N+B*O+C*M+C*N+C*O+D*M+D*N+D*O+
                      E*M+E*N+E*O+F*M+F*N+F*O+G*M+G*N+G*O)

data(injection_molding)

obj.dt = stepjglm(form, 0.05,0.05,injection_molding,gaussian,sqrt(nrow(injection_molding)),"AIC")

summary(obj.dt$modelo.mean)
summary(obj.dt$modelo.disp)

obj.dt$EAIC  # Print the EAIC for the final model
obj.dt$EQD   # Print the EQD for the final model
obj.dt$R2m   # Print the R2m for the final model
obj.dt$R2d   # Print the R2d for the final model

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
