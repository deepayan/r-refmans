<!DOCTYPE html><html lang="en"><head><title>Help for package vandalico</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {vandalico}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#AUCuniform'><p>Calculates the uniform <em>AUC</em> and uniform <em>Se*</em></p></a></li>
<li><a href='#AUCuniform_trap'><p>Calculates the uniform <em>AUC</em> and uniform <em>Se*</em> by the</p>
trapezoidal method.</a></li>
<li><a href='#CALplot'><p>Calibration graph</p></a></li>
<li><a href='#HSgraph'><p>Suitability values distribution graph</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Evaluation of Presence-Absence Models</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-09-06</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Alberto Jiménez-Valverde &lt;alberto.jimenez.valverde@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Collection of functions to evaluate presence-absence models. It 
    comprises functions to adjust discrimination statistics for the 
    representativeness effect through case-weighting, along with functions for 
    visualizing the outcomes. Originally outlined in: 
    Jiménez-Valverde (2022) The uniform AUC: dealing with the 
    representativeness effect in presence-absence models. Methods Ecol. Evol, 
    13, 1224-1236.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>ROCR (&ge; 1.0-7), stats, graphics</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.0</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-09-06 15:48:00 UTC; User</td>
</tr>
<tr>
<td>Author:</td>
<td>Alberto Jiménez-Valverde
    <a href="https://orcid.org/0000-0001-9962-2106"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-09-06 16:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='AUCuniform'>Calculates the uniform <em>AUC</em> and uniform <em>Se*</em></h2><span id='topic+AUCuniform'></span>

<h3>Description</h3>

<p>This function computes the uniform <em>AUC</em> (<em>uAUC</em>) and
uniform <em>Se*</em> (<em>uSe*</em>) following Jiménez-Valverde (2022).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AUCuniform(
  mat,
  rep = 100,
  by = 0.1,
  deleteBins = NULL,
  plot = FALSE,
  plot.adds = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AUCuniform_+3A_mat">mat</code></td>
<td>
<p>A matrix with two columns. The first column must contain the
suitability values (i.e., the classification rule); the second column must
contain the presences and absences.</p>
</td></tr>
<tr><td><code id="AUCuniform_+3A_rep">rep</code></td>
<td>
<p>Number of sampling replications. By default, <code>rep</code> = 100.</p>
</td></tr>
<tr><td><code id="AUCuniform_+3A_by">by</code></td>
<td>
<p>Size of the suitability intervals (i.e., bins). By default,
<code>by</code> = 0.1.</p>
</td></tr>
<tr><td><code id="AUCuniform_+3A_deletebins">deleteBins</code></td>
<td>
<p>A vector (e.g., from 1 to 10 if <code>by</code> = 0.1) with the
bins that have to be excluded (1 for [0,0.1), 10 for [0.9,1]) from the
resampling procedure (trimming); <code>NULL</code> by default.</p>
</td></tr>
<tr><td><code id="AUCuniform_+3A_plot">plot</code></td>
<td>
<p>Logical. Indicates whether or not the observed ROC curve is
plotted.</p>
</td></tr>
<tr><td><code id="AUCuniform_+3A_plot.adds">plot.adds</code></td>
<td>
<p>Logical. Indicates whether or not the negative diagonal and
the point of equivalence are added to the observed ROC plot.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function performs the stratified weighted bootstrap to
calculate the uniform <em>AUC</em> (<em>uAUC</em>) and uniform <em>Se*</em>
(<em>uSe*</em>) as suggested in Jiménez-Valverde (2022).  A warning message
will be shown if the sample size of any bin is zero. Another warning message
will be shown if the sample size of any bin is lower than 15. In such case,
trimming should be considered. The <em>AUC</em> (non-uniform) is estimated
non-parametrically (Bamber 1975). <em>Se*</em> is calculated by selecting the
point that minimizes the absolute difference between sensitivity and
specificity and by doing the mean of those values (Jiménez-Valverde 2020).
</p>


<h3>Value</h3>

<p>A list with the following elements:
</p>
<p><code>AUC</code>: the <em>AUC</em> value (non-uniform), a numeric value 
between 0 and 1.
</p>
<p><code>Se</code>: the <em>Se*</em> value (non-uniform), a numeric value 
between 0 and 1.
</p>
<p><code>bins</code>: a table with the sample size of each bin.
</p>
<p><code>suit.sim</code>: a matrix with the bootstrapped suitability values.
</p>
<p><code>sp.sim</code>: a matrix with the bootstrapped presence-absence data.
</p>
<p><code>uAUC</code>: a numeric vector with the (<em>uAUC</em>) values for each
replication.
</p>
<p><code>uAUC.95CI</code>: a numeric vector with the sample (<em>uAUC</em>) 
quantiles corresponding to the probabilities 0.025, 0.5 and 0.975.
</p>
<p><code>uSe</code>: a numeric vector with the (<em>uSe*</em>) values for each
replication.
</p>
<p><code>uSe.95CI</code>: a numeric vector with the sample (<em>uSe*</em>) 
quantiles corresponding to the probabilities 0.025, 0.5 and 0.975.
</p>


<h3>References</h3>

<p>Bamber, D. (1975). The Area above the Ordinal Dominance Graph and
the Area below the Receiver Operating Characteristic Graph.
<em>J. Math. Psychol</em>., 12, 387-415.
</p>
<p>Jiménez-Valverde, A. (2020). Sample size for the evaluation of
presence-absence models. <em>Ecol. Indic</em>., 114, 106289.
</p>
<p>Jiménez-Valverde, A. (2022). The uniform AUC: dealing with the
representativeness effect in presence-absence models. <em>Methods Ecol.
Evol.</em>, 13, 1224-1236.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>suit&lt;-rbeta(100, 2, 2) #Generate suitability values
random&lt;-runif(100)
sp&lt;-ifelse(random &lt; suit, 1, 0) #Generate presence-absence data
result&lt;-AUCuniform(cbind(suit, sp), plot = TRUE, plot.adds = TRUE)
result$uAUC.95CI[2] #Get the uAUC
</code></pre>

<hr>
<h2 id='AUCuniform_trap'>Calculates the uniform <em>AUC</em> and uniform <em>Se*</em> by the
trapezoidal method.</h2><span id='topic+AUCuniform_trap'></span>

<h3>Description</h3>

<p>This function computes the uniform <em>AUC</em> (<em>uAUC</em>) and
uniform <em>Se*</em> (<em>uSe*</em>) using the weighted trapezoidal method
instead of the weighted bootstrapping method used in <code>AUCuniform</code> and
originally proposed in Jiménez-Valverde (2022). This procedure reduces bias 
and improves the coverage of confidence intervals (Jiménez-Valverde 2024). 
Additionally, the weights vector associated to each case can be customized. 
See Jiménez-Valverde (2024) for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AUCuniform_trap(
  mat,
  by = 0.1,
  deleteBins = NULL,
  w = NULL,
  plot = FALSE,
  plot.compare = FALSE,
  plot.adds = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AUCuniform_trap_+3A_mat">mat</code></td>
<td>
<p>A matrix with two columns. The first column must contain the
suitability values (i.e., the classification rule); the second column must
contain the presences and absences.</p>
</td></tr>
<tr><td><code id="AUCuniform_trap_+3A_by">by</code></td>
<td>
<p>Size of the suitability intervals (i.e., bins). By default,
<code>by</code> = 0.1.</p>
</td></tr>
<tr><td><code id="AUCuniform_trap_+3A_deletebins">deleteBins</code></td>
<td>
<p>A vector (e.g., from 1 to 10 if <code>by</code> = 0.1) with the
bins that have to be excluded (1 for [0,0.1), 10 for [0.9,1]) from the
calculation of the uniform statistics; <code>NULL</code> by default.</p>
</td></tr>
<tr><td><code id="AUCuniform_trap_+3A_w">w</code></td>
<td>
<p>A vector with the weights associated to each case. If <code>NULL</code>
(default), then the uniform <em>AUC</em> (<em>uAUC</em>) and uniform <em>Se*</em>
(<em>uSe*</em>) are calculated.</p>
</td></tr>
<tr><td><code id="AUCuniform_trap_+3A_plot">plot</code></td>
<td>
<p>Logical. Indicates whether or not the observed ROC curve is
plotted (gray dots).</p>
</td></tr>
<tr><td><code id="AUCuniform_trap_+3A_plot.compare">plot.compare</code></td>
<td>
<p>Logical. Indicates whether or not the weighed ROC curve
is plotted (black line).</p>
</td></tr>
<tr><td><code id="AUCuniform_trap_+3A_plot.adds">plot.adds</code></td>
<td>
<p>Logical. Indicates whether or not the negative diagonal and
the points of equivalence (weighted and unweighted) are added to the ROC
plot.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calculates the uniform <em>AUC</em> (<em>uAUC</em>) and
uniform <em>Se*</em> (<em>uSe*</em>) using the weighted trapezoidal method as
suggested in Jiménez-Valverde (2024). A warning message will be shown if
the sample size of any bin is zero. Another warning message will be shown if
the sample size of any bin is lower than 15. In such case, trimming should be
considered using <code>deleteBins</code> (Jiménez-Valverde 2022). Alternatively,
the weights associated to each case can be fully customized with the <code>w</code>
parameter (Jiménez-Valverde 2024). In this case, no warnings regarding
sample size issues are raised, and <code>deleteBins</code> is not used. The
<em>AUC</em> (non-uniform, unweighted) is estimated non-parametrically by the
trapezoidal rule, which is equivalent to the Wilcoxon-based estimation 
(Hanley &amp; McNeil 1982) used in <code>AUCuniform</code>. <em>Se*</em> is calculated as 
in <code>AUCuniform</code>.
</p>


<h3>Value</h3>

<p>A list with the following elements:
</p>
<p><code>AUC</code>: the <em>AUC</em> value (non-uniform, unweighted), a numeric
value between 0 and 1.
</p>
<p><code>Se</code>: the <em>Se*</em> value (non-uniform, unweighted), a numeric
value between 0 and 1.
</p>
<p><code>bins</code>: a table with the sample size of each bin (only if
<code>w = NULL</code>).
</p>
<p><code>uAUC</code>: the uniform <em>AUC</em> value (only if <code>w = NULL</code>).
</p>
<p><code>uSe</code>: the uniform <em>Se*</em> value (only if <code>w = NULL</code>).
</p>
<p><code>wAUC</code>: the weighted <em>AUC</em> estimated with the vector
<code>w</code>
</p>
<p><code>wSe</code>: the weighted <em>Se*</em> estimated with the vector
<code>w</code>
</p>


<h3>References</h3>

<p>Hanley, J. A. &amp; McNeil, B. J. (1982). The Meaning and Use of the
Area under a Receiver Operating Characteristic (ROC) Curve.
<em>Radiology</em>., 143, 29-36.
</p>
<p>Jiménez-Valverde, A. (2022). The uniform AUC: dealing with the
representativeness effect in presence-absence models. <em>Methods Ecol.
Evol.</em>, 13, 1224-1236.
</p>
<p>Jiménez-Valverde, A. (2024). Improving the uniform AUC (uAUC): towards a 
case-by-case weighting evaluation in species distribution models. 
<em>In preparation</em>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>suit&lt;-rbeta(100, 2, 2) #Generate suitability values
random&lt;-runif(100)
sp&lt;-ifelse(random &lt; suit, 1, 0) #Generate presence-absence data
result&lt;-AUCuniform_trap(cbind(suit, sp), plot = TRUE, plot.compare = TRUE)
result$AUC #Get the AUC
result$uAUC #Get the uAUC. Note how it is closer to the reference value of
            #0.83 since the suitability values are simulated to be
            #well-calibrated (see Jimenez-Valverde 2022).
</code></pre>

<hr>
<h2 id='CALplot'>Calibration graph</h2><span id='topic+CALplot'></span>

<h3>Description</h3>

<p>A function to plot a calibration graph.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CALplot(mat, by = 0.1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CALplot_+3A_mat">mat</code></td>
<td>
<p>A matrix with two columns. The first column must contain the
suitability values (i.e., the classification rule); the second column must
contain the presences and absences.</p>
</td></tr>
<tr><td><code id="CALplot_+3A_by">by</code></td>
<td>
<p>Size of the suitability intervals (bins). By default,
<code>by</code> = 0.1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Dots for bins with 15 or more cases are shown in solid black; dots
for bins with less than 15 cases are shown empty (see Jiménez-Valverde et
al. 2013). This way, by plotting the calibration graph before running
<code><a href="#topic+AUCuniform">AUCuniform</a></code>, one can get a glimpse of how reliable <em>uAUC</em>
or <em>uSe*</em> can be expected to be.
</p>


<h3>Value</h3>

<p>This function returns a calibration plot
</p>


<h3>References</h3>

<p>Jiménez-Valverde, A., Acevedo, P., Barbosa, A. M., Lobo, J. M. &amp;
Real, R. (2013).  Discrimination capacity in species distribution models
depends on the representativeness of the environmental domain.
<em>Global Ecol. Biogeogr.</em>, 22, 508-516.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>suit&lt;-rbeta(100, 2, 2) #Generate suitability values
random&lt;-runif(100)
sp&lt;-ifelse(random &lt; suit,1 , 0) #Generate presence-absence data
CALplot(cbind(suit, sp))
</code></pre>

<hr>
<h2 id='HSgraph'>Suitability values distribution graph</h2><span id='topic+HSgraph'></span>

<h3>Description</h3>

<p>A function to visualize the distribution of the suitability
values associated to presences, absences, and all cases together.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>HSgraph(mat, breaks = 10, hist.total = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="HSgraph_+3A_mat">mat</code></td>
<td>
<p>A matrix with two columns. The first column must contain the
suitability values (i.e., the classification rule); the second column must
contain the presences and absences.</p>
</td></tr>
<tr><td><code id="HSgraph_+3A_breaks">breaks</code></td>
<td>
<p>Number of cells for the total histogram. By default,
<code>breaks</code> = 10.</p>
</td></tr>
<tr><td><code id="HSgraph_+3A_hist.total">hist.total</code></td>
<td>
<p>Logical. Indicates whether or not the distribution of
suitability values for all the cases together is graphed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In blue, the distribution of the suitability values associated to
presences. In red, the distribution of the suitability values associated to
absences. This graph helps to understand why the <em>AUC</em> (or <em>Se*</em>)
is greater, equal to, or less than the <em>uAUC</em> (or <em>uSe*</em>) (see
Jiménez-Valverde 2022).
</p>


<h3>Value</h3>

<p>This function returns a multiple histogram.
</p>


<h3>References</h3>

<p>Jiménez-Valverde, A. (2022). The uniform AUC: dealing with the
representativeness effect in presence-absence models. <em>Methods Ecol.
Evol.</em>, 13, 1224-1236.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>suit&lt;-rbeta(100, 2, 2) #Generate suitability values
random&lt;-runif(100)
sp&lt;-ifelse(random &lt; suit, 1 , 0) #Generate presence-absence data
HSgraph(cbind(suit, sp), breaks = 20, hist.total = TRUE)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
