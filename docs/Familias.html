<!DOCTYPE html><html lang="en"><head><title>Help for package Familias</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {Familias}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Familias-package'><p>Familias: Inferring paternity and identification based on DNA data</p></a></li>
<li><a href='#FamiliasLocus'>
<p>Creates an object with information on a locus, including its mutation matrices</p></a></li>
<li><a href='#FamiliasPedigree'>
<p>Creates an object storing a pedigree</p></a></li>
<li><a href='#FamiliasPosterior'>
<p>Calculates posterior probabilities and likelihoods for pedigrees</p></a></li>
<li><a href='#FamiliasPrior'>
<p>Calculates a prior distribution for a list of pedigrees</p></a></li>
<li><a href='#NorwegianFrequencies'>
<p>A list of markers with allele names and frequencies</p></a></li>
<li><a href='#plot.FamiliasPedigree'><p>Plotting function for FamiliasPedigree objects</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Probabilities for Pedigrees Given DNA Data</td>
</tr>
<tr>
<td>Version:</td>
<td>2.6.2</td>
</tr>
<tr>
<td>Description:</td>
<td>An interface to the core 'Familias' functions which are
    programmed in C++. The implementation is described in Egeland, Mostad and Olaisen
    (1997) &lt;<a href="https://doi.org/10.1016%2FS1355-0306%2897%2972202-0">doi:10.1016/S1355-0306(97)72202-0</a>&gt; and Simonsson and Mostad
    (2016) &lt;<a href="https://doi.org/10.1016%2Fj.fsigen.2016.04.005">doi:10.1016/j.fsigen.2016.04.005</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://www.familias.name/openfamilias.html">https://www.familias.name/openfamilias.html</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>kinship2, R (&ge; 3.4.0), Rsolnp</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-01-08 08:46:10 UTC; theg</td>
</tr>
<tr>
<td>Author:</td>
<td>Petter Mostad [aut],
  Thore Egeland [aut, cre],
  Ivar Simonsson [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Thore Egeland &lt;Thore.Egeland@nmbu.no&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-01-08 09:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='Familias-package'>Familias: Inferring paternity and identification based on DNA data
</h2><span id='topic+Familias-package'></span><span id='topic+Familias'></span>

<h3>Description</h3>

<p>This package provides an R interface to the Windows program Familias 
(<a href="https://familias.no">https://familias.no</a>), for calculating probabilities in forensic family 
genetics. The core source code (in C++) of the Windows program is contained in 
the package.
</p>


<h3>Details</h3>

<p>The main purpose of this package is to provide an R interface to the calculation 
of likelihood ratios (LRs) in Familias. For other forensic pedigree analyses and 
visualisations we recommend the 'pedsuite' packages: 
<a href="https://magnusdv.github.io/pedsuite/">https://magnusdv.github.io/pedsuite/</a>. In particular the package 
'pedFamilias' facilitates conversion of .fam files into the 'pedsuite' format.
</p>


<h3>Author(s)</h3>

<p>Petter Mostad &lt;mostad@chalmers.se&gt; and Thore Egeland &lt;Thore.Egeland@nmbu.no&gt;.
</p>


<h3>References</h3>

<p>For more information, see <a href="https://familias.name/">https://familias.name/</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>persons &lt;- c("mother", "daughter", "AF")

# Pedigrees
ped1 &lt;- FamiliasPedigree(id = persons, 
                         dadid = c(NA, "AF", NA), 
                         momid = c(NA, "mother", NA), 
                         sex = c("female", "female", "male"))
                         
ped2 &lt;- FamiliasPedigree(id = c(persons, "TF"), 
                         dadid = c(NA, "TF", NA, NA), 
                         momid = c(NA, "mother", NA, NA), 
                         sex = c("female", "female", "male", "male"))
                         
ped3 &lt;- FamiliasPedigree(id = c(persons, "TF", "gf", "gm"), 
                         dadid = c(NA, "TF", "gf", "gf", NA, NA), 
                         momid = c(NA, "mother", "gm", "gm", NA, NA), 
                         sex = c("female", "female", "male", "male", "male", "female"))
op &lt;- par(mfrow = c(1,3))
plot(ped1); title("ped1: AF is father")
plot(ped2); title("ped2: AF is unrelated")
plot(ped3); title("ped3: AF is uncle")
par(op)

mypedigrees &lt;- list(isFather = ped1, unrelated=ped2, isUncle = ped3)

# Loci
locus1 &lt;- FamiliasLocus(frequencies = c(0.1, 0.2, 0.3, 0.4), 
                        allelenames = c("A", "B", "C", "D"), 
                        name = "locus1")
locus2 &lt;- FamiliasLocus(c(0.2, 0.3, 0.5), 
                        c(17, 18, 19), 
                        "loc2",
                        femaleMutationRate = 0.05)
myloci &lt;- list(locus1, locus2)

# Genotype data
datamatrix &lt;- data.frame(locus1.1 = c("A", "A", "A"), 
                         locus1.2 = c("B", "B", "C"), 
                         locus2.1 = c(17, 19, 19), 
                         locus2.2 = c(18, 18, 18), 
                         row.names = persons)

# Calculate LR
## Not run: 
FamiliasPosterior(mypedigrees, myloci, datamatrix)

## End(Not run)
</code></pre>

<hr>
<h2 id='FamiliasLocus'>
Creates an object with information on a locus, including its mutation matrices 
</h2><span id='topic+FamiliasLocus'></span>

<h3>Description</h3>

<p>The user provides input needed to define an autosomal locus (also called system or forensic marker) to be used for pedigree calculations.
The input is checked and if no errors are found a list with class <code>FamiliasLocus</code> is returned containing
the information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FamiliasLocus(frequencies, 
              allelenames, 
              name, 
              MutationModel = "Stepwise", 
              MutationRate  = 0, 
              MutationRange = 0.5, 
              MutationRate2 = 0, 
              MutationMatrix, 
              Stabilization = "None", 
              MaxStabilizedMutrate = 1, 
              femaleMutationModel, 
              femaleMutationRate, 
              femaleMutationRange, 
              femaleMutationRate2, 
              femaleMutationMatrix, 
              maleMutationModel, 
              maleMutationRate, 
              maleMutationRange, 
              maleMutationRate2, 
              maleMutationMatrix)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FamiliasLocus_+3A_frequencies">frequencies</code></td>
<td>

<p>The first input of FamiliasLocus may be either a vector containing allele frequencies, or a previously created FamiliasLocus object. 
In the first case, the vector may include a possible silent allele; that it is silent is indicated in the allelenames. 
The frequencies must sum to 1. 
In the second case, the new object will be identical to the old object in terms of frequencies, names of alleles, and name of locus, 
so the 'allelenames' and 'name' parameters must be missing. However, at least one Mutation parameter or the Stabilization parameter must
be non-missing, and new mutation matrices will be constructed based on these. If all Mutation parameters are missing, stabilized 
mutation matrices will be produced based on the mutation matrices of the old object. 
</p>
</td></tr>
<tr><td><code id="FamiliasLocus_+3A_allelenames">allelenames</code></td>
<td>

<p>Names of the alleles, like <code>15</code> or 'A'. Note that the last allele may be called 'Silent' (or 'silent'). 
It is then treated as a silent allele in subsequent likelihood calculations. The default is to use the names attribute of 
the frequencies, if it exists; otherwise the default is to use consecutive integers, starting at 1.
Note that if the 'Stepwise' mutation model is used, allele names (except for a silent allele) must be integers, 
with microvariants named as for example 15.2. 
</p>
</td></tr>
<tr><td><code id="FamiliasLocus_+3A_name">name</code></td>
<td>

<p>Characters like 'D3S1358', used to identify the locus (marker). The default is to use the name of the frequencies argument to this function. 
</p>
</td></tr>
<tr><td><code id="FamiliasLocus_+3A_mutationmodel">MutationModel</code></td>
<td>

<p>The mutation model, used to create the mutation matrix. It may be 'Equal', 'Proportional', 'Stepwise', or 'Custom', see Details. 
</p>
</td></tr>
<tr><td><code id="FamiliasLocus_+3A_mutationrate">MutationRate</code></td>
<td>

<p>The mutation rate; for the 'Stepwise' model the rate of integer-step mutations. It is not used when the MutationModel is 'Custom'.
</p>
</td></tr>
<tr><td><code id="FamiliasLocus_+3A_mutationrange">MutationRange</code></td>
<td>

<p>Only used when the MutationModel is 'Stepwise'. It then indicates the relative probability of mutating n+1 steps versus 
mutating n steps. 
</p>
</td></tr>
<tr><td><code id="FamiliasLocus_+3A_mutationrate2">MutationRate2</code></td>
<td>

<p>Only used when the MutationModel is 'Stepwise'. It then indicates the rate of non-integer-step mutations, e.g., mutations 
from an allele with an integer name to alleles with decimal names indicating microvariants. 
</p>
</td></tr>
<tr><td><code id="FamiliasLocus_+3A_mutationmatrix">MutationMatrix</code></td>
<td>

<p>Only used when the MutationModel is 'Custom'. It then directly specifies the mutation matrix. 
</p>
</td></tr>
<tr><td><code id="FamiliasLocus_+3A_stabilization">Stabilization</code></td>
<td>

<p>The possible values are 'None', 'DP', 'RM', and 'PM', with 'None' being the default.
The other values adjust the mutation matrices so that allele frequencies after one or 
more generations of mutations will be equal to the original allele frequencies. See Details. 
</p>
</td></tr>
<tr><td><code id="FamiliasLocus_+3A_maxstabilizedmutrate">MaxStabilizedMutrate</code></td>
<td>

<p>Not used when stabilization is 'None'. Otherwise it indicates an upper bound for the specific mutation rate
for each allele allowed in the mutation matrices after stabilization. 
</p>
</td></tr>
<tr><td><code id="FamiliasLocus_+3A_femalemutationmodel">femaleMutationModel</code></td>
<td>

<p>Specifies a separate female value for MutationModel; defaults to MutationModel. 
</p>
</td></tr>
<tr><td><code id="FamiliasLocus_+3A_femalemutationrate">femaleMutationRate</code></td>
<td>

<p>Specifies a separate female value for MutationRate; defaults to MutationRate. 
</p>
</td></tr>
<tr><td><code id="FamiliasLocus_+3A_femalemutationrange">femaleMutationRange</code></td>
<td>

<p>Specifies a separate female value for MutationRange; defaults to MutationRange. 
</p>
</td></tr>
<tr><td><code id="FamiliasLocus_+3A_femalemutationrate2">femaleMutationRate2</code></td>
<td>

<p>Specifies a separate female value for MutationRate2; defaults to MutationRate2. 
</p>
</td></tr>
<tr><td><code id="FamiliasLocus_+3A_femalemutationmatrix">femaleMutationMatrix</code></td>
<td>

<p>Specifies a separate female value for MutationMatrix; defaults to MutationMatrix. 
</p>
</td></tr>
<tr><td><code id="FamiliasLocus_+3A_malemutationmodel">maleMutationModel</code></td>
<td>

<p>Specifies a separate male value for MutationModel; defaults to MutationModel. 
</p>
</td></tr>
<tr><td><code id="FamiliasLocus_+3A_malemutationrate">maleMutationRate</code></td>
<td>

<p>Specifies a separate male value for MutationRate; defaults to MutationRate. 
</p>
</td></tr>
<tr><td><code id="FamiliasLocus_+3A_malemutationrange">maleMutationRange</code></td>
<td>

<p>Specifies a separate male value for MutationRange; defaults to MutationRange. 
</p>
</td></tr>
<tr><td><code id="FamiliasLocus_+3A_malemutationrate2">maleMutationRate2</code></td>
<td>

<p>Specifies a separate male value for MutationRate2; defaults to MutationRate2. 
</p>
</td></tr>
<tr><td><code id="FamiliasLocus_+3A_malemutationmatrix">maleMutationMatrix</code></td>
<td>

<p>Specifies a separate male value for MutationMatrix; defaults to MutationMatrix. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The probabilities for when and how mutations happen can be specified in mutation matrices, where 
the row corresponding to an allele indicates the probabilities that the allele is transferred as 
the allele indicated by the column. Mutation matrices may be specified directly 
in the MutationMatrix parameters by setting the 
value of the MutationModel parameter to 'Custom'. Otherwise they are computed based on the values 
of the MutationModel, MutationRate, MutationRate2, and MutationRange parameters. 
If MutationModel is 'Equal', there is an equal probability of mutating to any non-silent allele, given that a mutation happens.   
This model is referred to as 'Equal probability (simple and fast)' in Familias 2.0. 
If MutationModel is 'Proportional', the probability of mutating to any non-silent allele is proportional to its frequency. 
It is referred to as 'Probability proportional to frequency (stable)' in Familias 2.0.
If MutationModel is 'Stepwise', it is required that the names of all non-silent alleles are positive integers,
indicating the number of sequence repetitions of an STR marker, or decimal numbers with a single decimal, such as '15.2', 
indicating a microvariant. Mutations are then divided into two types: Those that 
add or subtract an integer to the allele, and those that add or subtract some fractional amount. 
The rate of these two types of mutations are given separately as MutationRate and MutationRate2, respectively. 
Relative probabilities of different mutatitons of the first type are specified using the MutationRange parameter. 
The model with only integer alleles is referred to as 'Probability decreasing with range (equal)' in Familias 2.0, 
while the more general model is called 'Extended stepwise' in Familias 3.0. 
Note that the probability of mutations to or from silent alleles is set to zero in all models except the 'Custom' model. 
For the mutation matrix of the 'Custom' model, the row names and column names of the matrix must coincide and be equally sorted.
Furthermore, the allele names must be the same as the row names (and hence column names) of the mutation matrix and be equally sorted.
</p>
<p>The 'Stabilization' parameter may be used to change the mutation matrices so that they become stationary relative
to the frequencies vector. See the references. 
When the 'PM' setting is used together with the 'Stepwise' MutationModel 
and all allele names are integers, the resulting model is referred to as 
'Probability decreasing with range (stable)' in Familias 2.0. 
</p>


<h3>Value</h3>

<p>A list of class <code>FamiliasLocus</code> containing 
</p>
<table role = "presentation">
<tr><td><code>locusname</code></td>
<td>
<p>The name of the locus.</p>
</td></tr>
<tr><td><code>alleles</code></td>
<td>
<p>The frequencies of the alleles. The names of the alleles are included as the vector names.</p>
</td></tr>
<tr><td><code>femaleMutationType</code></td>
<td>
<p>A string specifying the type of the female mutations.</p>
</td></tr>
<tr><td><code>femaleMutationMatrix</code></td>
<td>
<p>The mutation matrix used for female transfer.</p>
</td></tr>
<tr><td><code>maleMutationType</code></td>
<td>
<p>A string specifying the type of the male mutations.</p>
</td></tr>
<tr><td><code>maleMutationMatrix</code></td>
<td>
<p>The mutation matrix used for male transfer.</p>
</td></tr>
<tr><td><code>simpleMutationMatrices</code></td>
<td>
<p>Indicates whether the probability of mutating to an 
allele is always independent of which allele the mutation happens from. 
If this is true, some likelihood computations can be done faster.</p>
</td></tr>
<tr><td><code>Stabilization</code></td>
<td>
<p>The stabilization method used.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Egeland, Kling, Mostad: Relationship Inference with Familias and R.
(Academic press, 2016, <a href="https://www.familias.name/book.html">https://www.familias.name/book.html</a>).
Simonsson, Mostad: Stationary Mutation models (FSI: Genetics, 2016).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Simple examples
FamiliasLocus(1:4/10)
FamiliasLocus(frequencies = c(0.1, 0.2, 0.3, 0.4),
allelenames = c("A", "B", "C", "D"), name = "locus1")

#Modified to include a silent frequency
FamiliasLocus(frequencies = c(0.1, 0.2, 0.3, 0.3, 0.1),
allelenames = c("8", "9", "10", "11", "silent"), name = "locus1")

#Mutation rates added
FamiliasLocus(frequencies = c(0.1, 0.2, 0.3, 0.4),
allelenames = c("8", "9", "10", "11"), name = "locus1", 
femaleMutationRate = 0.001, maleMutationRate = 0.005)

#Mutation matrices specified directly 
MM &lt;- matrix(c(0.99, 0.005, 0.003, 0.002, 0.005, 0.99, 0.005, 0, 
               0, 0.005, 0.99, 0.005, 0.002, 0.003, 0.005, 0.99), 
             ncol = 4, nrow = 4, byrow = TRUE)
FamiliasLocus(frequencies = c(0.1, 0.2, 0.3, 0.4), 
allelenames= c("08", "09", "10", "11"), name = "locus1", 
MutationModel = "Custom", MutationMatrix = MM)

#A locus is first created, and then edited
loc &lt;- FamiliasLocus(c(0.2, 0.5, 0.3))
loc2 &lt;- FamiliasLocus(loc, maleMutationRate = 0.001)
FamiliasLocus(loc2, Stabilization = "PM")

#A locus using standard Norwegian frequencies is created
data(NorwegianFrequencies)
FamiliasLocus(NorwegianFrequencies$TH01)
</code></pre>

<hr>
<h2 id='FamiliasPedigree'>
Creates an object storing a pedigree  
</h2><span id='topic+FamiliasPedigree'></span>

<h3>Description</h3>

<p>Creates and stores an object containing a pedigree in much the same way as the 
'pedigree' function of the 'kinship2' package. It is checked that the input 
represents a correct pedigree. The main differences is that a person is allowed
to have one parent present and one absent in the pedigree. Another difference is
that no disease parameters are included. The result is an object with class 
<code>FamiliasPedigree</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FamiliasPedigree(id, dadid, momid, sex)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FamiliasPedigree_+3A_id">id</code></td>
<td>

<p>A vector containing unique identifiers of all individuals in the pedigree.
</p>
</td></tr>
<tr><td><code id="FamiliasPedigree_+3A_dadid">dadid</code></td>
<td>

<p>Indicates the fathers of individuals. The vector must have the same length as 
the id vector and contain either values from it, indicating that the individual
with this position in the id vector has the given father, or NA. 
</p>
</td></tr>
<tr><td><code id="FamiliasPedigree_+3A_momid">momid</code></td>
<td>

<p>Indicates the mothers of individuals. The vector must have the same length as 
the id vector and contain either values from it, indicating that the individual
with this position in the id vector has the given mother, or NA. 
</p>
</td></tr>
<tr><td><code id="FamiliasPedigree_+3A_sex">sex</code></td>
<td>

<p>A vector of the same length as the id vector, indicating the gender of 
individuals. Values must be either &quot;female&quot; or &quot;male&quot;. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The objects created by the <code>FamiliasPedigree</code> function represent both a simplification and a 
generalization of the objects generated by the 'pedigree' function of the 'kinship2' package. 
It is a simplification in that parameters concerning disease are dropped, but it is a generalization 
in the sense that persons are allowed to have exactly one parent present in the pedigree. 
This generalization is necessary for the Familias package, as results from the <code>FamiliasPosterior</code>
function may change when a single ancestor (father or mother) is added to a single person in a
pedigree. Such changes may occur when a non-zero mutation rate is used together with a non-stable 
mutation model. The <code>FamiliasPosterior</code> and <code>FamiliasPrior</code> functions can use either pedigree type as input. 
</p>


<h3>Value</h3>

<p>A list of class <code>FamiliasPedigree</code> containing 
</p>
<table role = "presentation">
<tr><td><code>id</code></td>
<td>
<p>The same vector as the id input.</p>
</td></tr>
<tr><td><code>findex</code></td>
<td>
<p>A vector of indices of fathers of persons. Zero indicates that the
person has no father in the pedigree.</p>
</td></tr>
<tr><td><code>mindex</code></td>
<td>
<p>A vector of indices of mothers of persons. Zero indicates that the
person has no mother in the pedigree.</p>
</td></tr>
<tr><td><code>sex</code></td>
<td>
<p>The same vector as the sex input.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Petter Mostad mostad@chalmers.se
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#A nuclear family of three: 
ped &lt;- FamiliasPedigree(c("mother", "father", "child"), 
                        c(NA, NA, "father"), 
                        c(NA, NA, "mother"), 
                        c("female", "male", "female"))
plot(ped, symbolsize = 2, cex = 2, family = "mono")

#Generating the two pedigrees needed for a traditional paternity case
ped1 &lt;- FamiliasPedigree(c("mother", "child", "AF"), 
                         c(NA, NA, NA), 
                         c(NA, "mother", NA), 
                         c("female", "female", "male"))
ped2 &lt;- FamiliasPedigree(c("mother", "child", "AF"), 
                         c(NA, "AF", NA), 
                         c(NA, "mother", NA), 
                         c("female", "female", "male"))

#Generating the two pedigrees needed for a duo case
ped1 &lt;- FamiliasPedigree(c("child", "AF"), c(NA, NA), c(NA, NA), c("male", "male"))
ped2 &lt;- FamiliasPedigree(c("child", "AF"), c("AF", NA), c(NA, NA), c("male", "male"))
</code></pre>

<hr>
<h2 id='FamiliasPosterior'>
Calculates posterior probabilities and likelihoods for pedigrees
</h2><span id='topic+FamiliasPosterior'></span>

<h3>Description</h3>

<p>The calculations of the windows version of Familias 2.0 are made available in 
an R environment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FamiliasPosterior(pedigrees, loci, datamatrix, prior, ref = 1, kinship = 0, 
                  simplifyMutations = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FamiliasPosterior_+3A_pedigrees">pedigrees</code></td>
<td>

<p>An object of type 'FamiliasPedigree' or 'pedigree', or a list of such objects.
</p>
</td></tr>
<tr><td><code id="FamiliasPosterior_+3A_loci">loci</code></td>
<td>

<p>A FamiliasLocus object or a list of such objects.
</p>
</td></tr>
<tr><td><code id="FamiliasPosterior_+3A_datamatrix">datamatrix</code></td>
<td>

<p>A data frame. The row names must be the names of the persons you have data for. The columns contain
the alleles, two columns for each marker, in the same order used in the loci list. 
</p>
</td></tr>
<tr><td><code id="FamiliasPosterior_+3A_prior">prior</code></td>
<td>

<p>A vector of non-negative probabilities summing to 1. As default a flat prior is used, with all values equal. 
</p>
</td></tr>
<tr><td><code id="FamiliasPosterior_+3A_ref">ref</code></td>
<td>

<p>The index in the list of pedigrees of the pedigree which should be used as reference when computing likelihood ratios. 
The default value is 1. 
</p>
</td></tr>
<tr><td><code id="FamiliasPosterior_+3A_kinship">kinship</code></td>
<td>

<p>A real in [0,1], commonly denoted theta in forensics included to model sub-population effects as departures
from Hardy-Weinberg equilibrium. The default value is zero.
</p>
</td></tr>
<tr><td><code id="FamiliasPosterior_+3A_simplifymutations">simplifyMutations</code></td>
<td>

<p>In pedigrees with several generations multistep mutations may happen. If the probability of mutating to an allele 
depends on which allele it mutates from, exact likelihood computations must keep track of all the possible values of 
mutated alleles in such multistage mutations, and this may slow down computations considerably. Instead, one may 
use in computations for multistage mutations a single allele that is not among those observed in the data. 
When this approach gives exact results it is always used; 
in other cases one may choose to use it as an approximation by setting 
simplifyMutations to TRUE. The properties of the extra allele is the weighted average (by population frequencies) 
of the alleles not observed in the data. 
</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>posterior</code></td>
<td>
<p>Probabilities for each pedigree.</p>
</td></tr>
<tr><td><code>prior</code></td>
<td>
<p>Prior returned for convenience and backward compatibility.</p>
</td></tr>
<tr><td><code>LR</code></td>
<td>
<p>Likelihood ratios using the pedigree indicated with the ref parameter (default value 1) as basis.</p>
</td></tr>
<tr><td><code>LRperMarker</code></td>
<td>
<p>Likelihood ratios per marker using the pedigree indicated with the ref parameter (default value 1) as basis.</p>
</td></tr>
<tr><td><code>likelihoods</code></td>
<td>
<p>For each pedigree.</p>
</td></tr>
<tr><td><code>likelihoodsPerSystem</code></td>
<td>
<p>Likelihoods for each locus and each pedigree.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Petter Mostad &lt;mostad@chalmers.se&gt; and Thore Egeland &lt;Thore.Egeland@nmbu.com&gt;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Example 1
#Data is available for "mother", "daughter" and "AF" for two loci (systems). 
#Three pedigrees are defined, with "mother" being the mother of "daughter" 
#in all cases. "AF" may be the father (ped1), unrelated (ped1) or
#uncle (ped3). The posterior probabilities for the pedigrees are calculated 
#and likelihoods are also given so that likelihood ratios can be computed. 
#Compared to the windows version of Familias it is easy to plot pedigrees and 
#define arbitrary priors for the three alternative pedigrees.
#The implementation uses the R package kinship2 to define and plot pedigrees.

persons &lt;- c("mother", "daughter", "AF")
ped1 &lt;- FamiliasPedigree(id = persons, 
                         dadid = c(NA, "AF", NA), 
                         momid = c(NA, "mother", NA), 
                         sex = c("female", "female", "male"))
ped2 &lt;- FamiliasPedigree(id = c(persons, "TF"), 
                         dadid = c(NA, "TF", NA, NA), 
                         momid = c(NA, "mother", NA, NA), 
                         sex = c("female", "female", "male", "male"))
ped3 &lt;- FamiliasPedigree(id = c(persons, "TF", "gf", "gm"),
                         dadid = c(NA, "TF", "gf", "gf", NA, NA), 
                         momid = c(NA, "mother", "gm", "gm", NA, NA), 
                         sex = c("female", "female", "male", "male", "male", "female"))
op &lt;- par(mfrow = c(1,3))
plot(ped1); title("ped1: AF is father")
plot(ped2); title("ped2: AF is unrelated")
plot(ped3); title("ped3: AF is uncle")
par(op)

mypedigrees &lt;- list(isFather = ped1, unrelated = ped2, isUncle = ped3)

locus1 &lt;- FamiliasLocus(frequencies = c(0.1, 0.2, 0.3, 0.4), 
                        allelenames = c("A", "B", "C", "D"), 
                        name = "locus1")
locus2 &lt;- FamiliasLocus(c(0.2, 0.3, 0.5), 
                        c(17, 18, 19), 
                        "loc2", 
                        femaleMutationRate = 0.05)
myloci &lt;- list(locus1, locus2)

datamatrix &lt;- data.frame(locus1.1 = c("A", "A", "A"), 
                         locus1.2 = c ("B", "B", "C"), 
                         locus2.1 = c(17, 19, 19), 
                         locus2.2 = c(18, 18, 18))
rownames(datamatrix) &lt;- persons

## Not run: 
result &lt;- FamiliasPosterior(mypedigrees, myloci, datamatrix, ref = 2)

## End(Not run)



#Example 2: Using FamiliasPedigree
persons &lt;- c("person", "AF")
sex &lt;- c("male", "male")
ped1 &lt;- FamiliasPedigree(id = persons, dadid = c(NA, NA), momid = c(NA, NA), sex = sex)
ped2 &lt;- FamiliasPedigree(id = persons, dadid = c("AF", NA), momid = c(NA, NA), sex = sex)
mypedigrees &lt;- list(unrelated = ped1, isFather = ped2)

locus1 &lt;- FamiliasLocus(c(0.1, 0.2, 0.3, 0.4), c("A", "B", "C", "D"), "locus1", 
                        maleMutationModel = "Equal", maleMutationRate = 0.005)
locus2 &lt;- FamiliasLocus(c(0.2, 0.3, 0.5), c(17, 18, 19), "locus2", 
                        maleMutationModel = "Equal", maleMutationRate = 0.005) 
myloci &lt;- list(locus1, locus2)

datamatrix &lt;- data.frame(locus1.1 = c("A", "A"), locus1.2 = c("B", "B"), 
                         locus2.1 = c(17, 19),   locus2.2 = c(18, 18))
rownames(datamatrix) &lt;- persons
## Not run: 
result &lt;- FamiliasPosterior(mypedigrees, myloci, datamatrix)

## End(Not run)

#Example 3: User-specified mutation matrices
persons &lt;- c("son", "mother", "AF")
sex &lt;- c("male", "female", "male")
ped1 &lt;- FamiliasPedigree(id = persons, dadid = c(NA, NA, NA), 
                         momid = c("mother", NA, NA), sex = sex)
ped2 &lt;- FamiliasPedigree(id = persons, dadid = c("AF", NA, NA), 
                         momid = c("mother", NA, NA), sex = sex)
mypedigrees &lt;- list(unrelated = ped1, isFather = ped2)

mut = matrix(c(0.99, 0.005, 0.003, 0.002, 
               0.004, 0.99, 0.004, 0.002, 
               0.002, 0.004, 0.99, 0.004, 
               0.002, 0.003, 0.005, 0.99), 
             4, 4, byrow = TRUE)
locus1 &lt;- FamiliasLocus(c(0.1, 0.2, 0.3, 0.4), c("A", "B", "C", "D"), "locus1", 
                        maleMutationModel = "Custom", 
                        maleMutationMatrix = mut, 
                        femaleMutationModel = "Custom", 
                        femaleMutationMatrix = mut)
   
datamatrix &lt;- data.frame(locus1.1 = c("A", "A", "C"), 
                         locus1.2 = c("B", "A", "C"))
rownames(datamatrix) &lt;- persons
## Not run: 
result &lt;- FamiliasPosterior(mypedigrees, locus1, datamatrix)

## End(Not run)

#Example 4: Adding an untyped ancestor affects the likelihood
#when subpopulation correction is used even if the mutation matrix is stationary

# ped1 is son by himself
## Not run: 
ped1 &lt;- FamiliasPedigree(id = "son", 
                         dadid = c(NA), 
                         momid = c(NA), 
                         sex = "male")

# ped2 describes son with parents
persons &lt;- c("son", "mother", "AF")
sex &lt;- c("male", "female", "male")
ped2 &lt;- FamiliasPedigree(id = persons, 
                         dadid = c("AF", NA, NA), 
                         momid = c("mother", NA, NA), 
                         sex = sex)

# only the son is typed
datamatrix &lt;- matrix(c("A", "A"), ncol = 2)
rownames(datamatrix) &lt;- "son"

f &lt;- setNames(c(0.3, 0.7), c("A", "B"))

locus1 &lt;- FamiliasLocus(f, 
                        MutationModel = "Proportional", 
                        MutationRate = 1e-2)

# if Fst=0, then ped1 and ped2 are equivalent
pr_ped1_HW &lt;- FamiliasPosterior(list(ped1), locus1, datamatrix)$likelihoods
pr_ped2_HW &lt;- FamiliasPosterior(list(ped2), locus1, datamatrix)$likelihoods

# verify calculations by hand
stopifnot(all.equal(pr_ped1_HW, pr_ped2_HW))
stopifnot(all.equal(pr_ped1_HW, as.numeric(f["A"]^2)))
stopifnot(all.equal(pr_ped2_HW, as.numeric(f["A"]^2)))

# if Fst &gt; 0, then ped1 and ped2 are not equivalent
Fst &lt;- 0.03

pr_ped1_Fst &lt;- FamiliasPosterior(list(ped1), locus1, datamatrix, kinship = Fst)$likelihoods
pr_ped2_Fst &lt;- FamiliasPosterior(list(ped2), locus1, datamatrix, kinship = Fst)$likelihoods

# pr_ped1_Fst and pr_ped2_Fst should not be equal: stop if equal
stopifnot(!isTRUE(all.equal(pr_ped1_Fst, pr_ped2_Fst)))

# compute pr_ped1_Fst by hand to verify the result
pr_ped1_Fst_manual &lt;- as.numeric(f["A"]*Fst + f["A"]^2 * (1-Fst))
stopifnot(all.equal(pr_ped1_Fst, pr_ped1_Fst_manual))

# compute pr_ped2_Fst by hand to verify the result
# computing Pr(son=A,A|ped2) with subpopulation correction and mutations
# requires an explicit sum over the two parental alleles

pr_AA &lt;- as.numeric(f["A"] * Fst + f["A"]^2 * (1-Fst))
pr_AB &lt;- 2 * as.numeric(f["A"] *f ["B"] * (1-Fst))
pr_BB &lt;- as.numeric(f["B"]*Fst + f["B"]^2 * (1-Fst))

M &lt;- locus1$maleMutationMatrix

pr_AA_given_AA &lt;- M["A","A"]^2
pr_AA_given_AB &lt;- M["A","A"] * M["B","A"]
pr_AA_given_BB &lt;- M["B","A"]^2

pr_ped2_Fst_manual &lt;- pr_AA*pr_AA_given_AA + pr_AB*pr_AA_given_AB + pr_BB*pr_AA_given_BB

stopifnot(all.equal(pr_ped2_Fst, pr_ped2_Fst_manual))

## End(Not run)

</code></pre>

<hr>
<h2 id='FamiliasPrior'>
Calculates a prior distribution for a list of pedigrees
</h2><span id='topic+FamiliasPrior'></span>

<h3>Description</h3>

<p>By default the same prior probability is assigned to all pedigrees in the list, 
but this can be adjusted with the function parameters. It is computed which 
persons are common to all the pedigrees listed, and they are handled in a 
special way: It is with relation to these persons that the number of generations
and other parameters are computed. Also, the function will search for and remove
pedigrees that are &quot;equivalent&quot; in terms of representing the relationship 
between these core persons. So if another pedigree is added, with all new 
persons, the function will return with an error message.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FamiliasPrior(pedigrees, 
              generationsParameter = 1, 
              inbreedingParameter = 1, 
              partnerParameter = 1, 
              maxGenerations)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FamiliasPrior_+3A_pedigrees">pedigrees</code></td>
<td>

<p>A list of objects of class either 'pedigree' or 'FamiliasPedigree'.
</p>
</td></tr>
<tr><td><code id="FamiliasPrior_+3A_generationsparameter">generationsParameter</code></td>
<td>

<p>Non-negative real. A value of 1 indicates no influence of the parameter. A value
above 1 (below 1) increases (decreases) the prior probability for pedigrees with
many generations.
</p>
</td></tr>
<tr><td><code id="FamiliasPrior_+3A_inbreedingparameter">inbreedingParameter</code></td>
<td>

<p>Non-negative real. A pedigree is inbred if parents are related within the 
pedigree. If 0, all inbred pedigrees are assigned a prior probability 0. A value
of 1 indicates no influence of inbreeding. A value above 1 (below 1) increases
(decreases) the prior for inbred pedigrees.
</p>
</td></tr>
<tr><td><code id="FamiliasPrior_+3A_partnerparameter">partnerParameter</code></td>
<td>

<p>Non-negative real (previously referred to as promiscuity parameter). If 0, all 
pedigrees where parents have children by different partners, are assigned prior 
0. A value of 1 indicates no influence of the parameter. A value above 1 (below
1) increases (decreases) the prior for partners having children by different 
partners. 
</p>
</td></tr>
<tr><td><code id="FamiliasPrior_+3A_maxgenerations">maxGenerations</code></td>
<td>

<p>Integer giving the maximum number of generations; pedigrees with more 
generations than this are assigned a zero prior probability. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See https://familias.name/manual.pdf for a complete description of the 
parametric models implemented.
</p>


<h3>Value</h3>

<p>The prior, i.e., a vector of real numbers summing to 1.
</p>


<h3>Author(s)</h3>

<p>Petter Mostad &lt;mostad@chalmers.se&gt; and Thore Egeland &lt;Thore.Egeland@nmbu.com&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>persons &lt;- c("mother", "daughter", "AF")
ped1 &lt;- FamiliasPedigree(id = persons, 
                         dadid = c(NA, "AF", NA), 
                         momid = c(NA, "mother", NA),
                         sex = c("female", "female", "male"))
ped2 &lt;- FamiliasPedigree(id = c(persons, "TF"), 
                         dadid = c(NA, "TF", NA, NA), 
                         momid = c(NA, "mother", NA, NA), 
                         sex = c("female", "female", "male", "male"))
ped3 &lt;- FamiliasPedigree(id = c(persons, "TF", "gf", "gm"), 
                         dadid = c(NA, "TF", "gf", "gf", NA, NA), 
                         momid = c(NA, "mother", "gm", "gm", NA, NA), 
                         sex = c("female", "female", "male", "male", "male", "female"))
                         
mypedigrees &lt;- list(isFather = ped1, unrelated = ped2, isUncle = ped3)

FamiliasPrior(mypedigrees)

granddad &lt;- FamiliasPedigree(id = c(persons, "TF", "gm"), 
                             dadid = c(NA, "TF", NA, "AF", NA),
                             momid = c(NA, "mother", NA, "gm", NA), 
                             sex = c("female", "female", "male", "male", "female"))
FamiliasPrior(c(mypedigrees, list(granddad)))
FamiliasPrior(c(mypedigrees, list(granddad)), maxGenerations = 1)
</code></pre>

<hr>
<h2 id='NorwegianFrequencies'>
A list of markers with allele names and frequencies 
</h2><span id='topic+NorwegianFrequencies'></span>

<h3>Description</h3>

<p>The information represents allele frequencies for a range of different markers based on 
a data base in Norway. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(NorwegianFrequencies)
</code></pre>


<h3>Format</h3>

<p>A list with named components, with names corresponding to the names of the loci. 
Each component is a vector of frequencies, with the names attribute of the vector 
equal to the names of the alleles. 
</p>


<h3>Source</h3>

<p>Norwegian Institute of Public Health, Department of Family Genetics: 
<cite>Dupuy et al: Frequency data for 35 autosomal STR markers in a Norwegian, an East African, 
and East Asian and Middle Asian population and simulation of adequate database size. Forensic Science 
International: Genetics Supplement Series, Volume 4, issue 1, 2013</cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(NorwegianFrequencies)

#Displaying the Norwegian frequencies of the 
NorwegianFrequencies$TPOX

#Generating a FamiliasLocus with these frequencies
FamiliasLocus(NorwegianFrequencies$TPOX)

#Including a non-zero male mutation rate
FamiliasLocus(NorwegianFrequencies$TPOX, maleMutationRate = 0.005)

#Listing the names of available markers
names(NorwegianFrequencies)
</code></pre>

<hr>
<h2 id='plot.FamiliasPedigree'>Plotting function for FamiliasPedigree objects
</h2><span id='topic+plot.FamiliasPedigree'></span>

<h3>Description</h3>

<p>The function piggybacks the plot function for pedigree objects from the kinship2
package to create a plotting function for FamiliasPedigree objects. Before 
conversion to a pedigree object, additional parents are added to the pedigree 
so that each person has either zero or two parents within the pedigree. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'FamiliasPedigree'
plot(x, y, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.FamiliasPedigree_+3A_x">x</code></td>
<td>

<p>An object of class FamiliasPedigree.
</p>
</td></tr>
<tr><td><code id="plot.FamiliasPedigree_+3A_y">y</code></td>
<td>

<p>Not used in this printing function.
</p>
</td></tr>
<tr><td><code id="plot.FamiliasPedigree_+3A_...">...</code></td>
<td>

<p>Other arguments transferred to 'kinship2::plot.pedigree()'.  
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Graphical parameters used in 'kinship2::plot.pedigree()' may be input via 
'plot.FamiliasPedigree()'. 
</p>


<h3>Value</h3>

<p>A plot is produced. 
</p>


<h3>Author(s)</h3>

<p>Petter Mostad mostad@chalmers.se 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ped &lt;- FamiliasPedigree(id = c("child", "AF"), 
                        momid = c(NA, NA), 
                        dadid = c("AF", NA), 
                        sex = c("male", "male"))
plot(ped)
dev.new()
plot(ped, symbolsize = 2, cex = 2, family = "mono")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
