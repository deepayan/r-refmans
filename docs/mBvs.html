<!DOCTYPE html><html><head><title>Help for package mBvs</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {mBvs}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#mBvs-package'>
<p>Bayesian Variable Selection Methods for Multivariate Data</p></a></li>
<li><a href='#initiate_startValues'>
<p>The function that initiates starting values</p></a></li>
<li><a href='#methods'>
<p>Methods for objects of class, <code>mvnBvs</code>, <code>mzipBvs</code>, and <code>mmzipBvs</code>.</p></a></li>
<li><a href='#mmzipBvs'>
<p>The function to perform variable selection for marginalized multivariate zero-inflated Poisson models</p></a></li>
<li><a href='#mvnBvs'>
<p>The function to perform variable selection for multivariate normal responses</p></a></li>
<li><a href='#mzipBvs'>
<p>The function to perform variable selection for conditional multivariate zero-inflated Poisson models</p></a></li>
<li><a href='#simData_cont'>
<p>A simulated data set containing multivariate normal responses and continuous covariates</p></a></li>
<li><a href='#simData_mzip'>
<p>A simulated data set containing multivariate zero-inflated count responses and a continuous covariate</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Bayesian Variable Selection Methods for Multivariate Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.92</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-4-13</td>
</tr>
<tr>
<td>Author:</td>
<td>Kyu Ha Lee, Mahlet G. Tadesse, Brent A. Coull, Jacqueline R. Starr</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Kyu Ha Lee &lt;klee15239@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Bayesian variable selection methods for data with multivariate responses and multiple covariates. The package contains implementations of multivariate Bayesian variable selection methods for continuous data (Lee et al., Biometrics, 2017 &lt;<a href="https://doi.org/10.1111%2Fbiom.12557">doi:10.1111/biom.12557</a>&gt;) and zero-inflated count data (Lee et al., Biostatistics, 2020 &lt;<a href="https://doi.org/10.1093%2Fbiostatistics%2Fkxy067">doi:10.1093/biostatistics/kxy067</a>&gt;).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Depends:</td>
<td>mvtnorm, R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-04-14 00:47:29 UTC; kyuhalee</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-04-15 21:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='mBvs-package'>
Bayesian Variable Selection Methods for Multivariate Data
</h2><span id='topic+mBvs-package'></span><span id='topic+mBvs'></span>

<h3>Description</h3>

<p>Bayesian variable selection methods for data with multivariate responses and multiple covariates. The package contains implementations of multivariate Bayesian variable selection methods for continuous data and zero-inflated count data.
</p>


<h3>Details</h3>

<p>The package includes the following function:
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>mvnBvs</code> </td><td style="text-align: left;"> Bayesian variable selection for data with multivariate continuous responses  </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>mzipBvs</code> </td><td style="text-align: left;"> Bayesian variable selection for conditional multivariate zero-inflated Poisson models </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>mmzipBvs</code> </td><td style="text-align: left;"> Bayesian variable selection for marginalized multivariate zero-inflated Poisson models </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> mBvs</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.92</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2024-4-13</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Kyu Ha Lee, Mahlet G. Tadesse, Brent A. Coull, Jacqueline R. Starr <br />
Maintainer: Kyu Ha Lee &lt;klee15239@gmail.com&gt;
</p>


<h3>References</h3>

<p>Lee, K. H., Tadesse, M. G., Baccarelli, A. A., Schwartz J., and Coull, B. A. (2017), 
Multivariate Bayesian variable selection exploiting dependence structure among outcomes: 
application to air pollution effects on DNA methylation, <em>Biometrics</em>, Volume 73, Issue 1, pages 232-241. <br />
</p>
<p>Lee, K. H., Coull, B. A., Moscicki, A.-B., Paster, B. J., Starr, J. R. (2020),
Bayesian variable selection for multivariate zero-inflated models: application to microbiome count data, <em>Biostatistics</em>, Volume 21, Issue 3, Pages 499-517 <br />
</p>

<hr>
<h2 id='initiate_startValues'>
The function that initiates starting values
</h2><span id='topic+initiate_startValues'></span>

<h3>Description</h3>

<p>The function initiates starting values. Users are allowed to set some non-null values to starting values for a set of parameters. The function will automatically generate starting values for any parameters whose values are not specified.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>initiate_startValues(Formula, Y, data, model = "MMZIP", B = NULL, beta0 = NULL, 
V = NULL, SigmaV = NULL, gamma_beta = NULL, A = NULL, alpha0 = NULL, W = NULL, 
m = NULL, gamma_alpha = NULL, sigSq_beta = NULL, sigSq_beta0 = NULL, 
sigSq_alpha = NULL, sigSq_alpha0 = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="initiate_startValues_+3A_formula">Formula</code></td>
<td>

<p>a list containing three formula objects: the first formula specifies the <code class="reqn">p_z</code> covariates for which variable selection is to be performed in the binary component of the model; the second formula specifies the <code class="reqn">p_x</code> covariates for which variable selection is to be performed in the count part of the model; the third formula specifies the <code class="reqn">p_0</code> confounders to be adjusted for (but on which variable selection is not to be performed) in the regression analysis.
</p>
</td></tr>
<tr><td><code id="initiate_startValues_+3A_y">Y</code></td>
<td>

<p>a data.frame containing <code class="reqn">q</code> count outcomes from <code>n</code> subjects. It is of dimension <code class="reqn">n\times q</code>.
</p>
</td></tr>
<tr><td><code id="initiate_startValues_+3A_data">data</code></td>
<td>

<p>a data.frame containing the variables named in the formulas in <code>lin.pred</code>.
</p>
</td></tr>
<tr><td><code id="initiate_startValues_+3A_model">model</code></td>
<td>

<p>MMZIP
</p>
</td></tr>
<tr><td><code id="initiate_startValues_+3A_b">B</code></td>
<td>

<p>starting values of <code class="reqn">B</code>
</p>
</td></tr>
<tr><td><code id="initiate_startValues_+3A_beta0">beta0</code></td>
<td>

<p>starting values of <code class="reqn">\beta_0</code>
</p>
</td></tr>
<tr><td><code id="initiate_startValues_+3A_v">V</code></td>
<td>

<p>starting values of <code class="reqn">B</code>
</p>
</td></tr>
<tr><td><code id="initiate_startValues_+3A_sigmav">SigmaV</code></td>
<td>

<p>starting values of <code class="reqn">\Sigma_V</code>
</p>
</td></tr>
<tr><td><code id="initiate_startValues_+3A_gamma_beta">gamma_beta</code></td>
<td>

<p>starting values of <code class="reqn">\gamma_{\beta}</code>
</p>
</td></tr>
<tr><td><code id="initiate_startValues_+3A_a">A</code></td>
<td>

<p>starting values of <code class="reqn">A</code>
</p>
</td></tr>
<tr><td><code id="initiate_startValues_+3A_alpha0">alpha0</code></td>
<td>

<p>starting values of <code class="reqn">\alpha_0</code>
</p>
</td></tr>
<tr><td><code id="initiate_startValues_+3A_w">W</code></td>
<td>

<p>starting values of <code class="reqn">W</code>
</p>
</td></tr>
<tr><td><code id="initiate_startValues_+3A_m">m</code></td>
<td>

<p>starting values of <code class="reqn">m</code>
</p>
</td></tr>
<tr><td><code id="initiate_startValues_+3A_gamma_alpha">gamma_alpha</code></td>
<td>

<p>starting values of <code class="reqn">\gamma_{\alpha}</code>
</p>
</td></tr>
<tr><td><code id="initiate_startValues_+3A_sigsq_beta">sigSq_beta</code></td>
<td>

<p>starting values of <code class="reqn">\sigma_{\beta}^2</code>
</p>
</td></tr>
<tr><td><code id="initiate_startValues_+3A_sigsq_beta0">sigSq_beta0</code></td>
<td>

<p>starting values of <code class="reqn">\sigma_{\beta_0}^2</code>
</p>
</td></tr>
<tr><td><code id="initiate_startValues_+3A_sigsq_alpha">sigSq_alpha</code></td>
<td>

<p>starting values of <code class="reqn">\sigma_{\alpha}^2</code>
</p>
</td></tr>
<tr><td><code id="initiate_startValues_+3A_sigsq_alpha0">sigSq_alpha0</code></td>
<td>

<p>starting values of <code class="reqn">\sigma_{\alpha_0}^2</code>
</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>initiate_startValues</code> returns a list containing starting values that can be used for <code>mmzipBvs</code>.
</p>


<h3>Author(s)</h3>

<p>Maintainer: Kyu Ha Lee &lt;klee@hsph.harvard.edu&gt;
</p>


<h3>References</h3>

<p>update..
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mmzipBvs">mmzipBvs</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See Examples in \code{\link{mmzipBvs}}.
</code></pre>

<hr>
<h2 id='methods'>
Methods for objects of class, <code>mvnBvs</code>, <code>mzipBvs</code>, and <code>mmzipBvs</code>.
</h2><span id='topic+print.mvnBvs'></span><span id='topic+print.mzipBvs'></span><span id='topic+print.mmzipBvs'></span><span id='topic+print.summ.mvnBvs'></span><span id='topic+print.summ.mzipBvs'></span><span id='topic+print.summ.mmzipBvs'></span><span id='topic+summary.mvnBvs'></span><span id='topic+summary.mzipBvs'></span><span id='topic+summary.mmzipBvs'></span>

<h3>Description</h3>

<p>The <code>mvnBvs</code> class represents results from Bayesian variable selection using multivariate normal regression models. The <code>mzipBvs</code> and <code>mmzipBvs</code> classes represent results from conditional and marginalized multivariate zero-inflated regression models, respectively.<br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mvnBvs'
print(x, digits=3, ...)
## S3 method for class 'mzipBvs'
print(x, digits=3, ...)
## S3 method for class 'mmzipBvs'
print(x, digits=3, ...)
## S3 method for class 'summ.mvnBvs'
print(x, digits=3, ...)
## S3 method for class 'summ.mzipBvs'
print(x, digits=3, ...)
## S3 method for class 'summ.mmzipBvs'
print(x, digits=3, ...)
## S3 method for class 'mvnBvs'
summary(object, digits=3, ...)
## S3 method for class 'mzipBvs'
summary(object, digits=3, ...)
## S3 method for class 'mmzipBvs'
summary(object, digits=3, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="methods_+3A_x">x</code></td>
<td>

<p>an object of class <code>mvnBvs</code>, <code>summ.mvnBvs</code>, <code>mzipBvs</code>, <code>summ.mzipBvs</code>, <code>mmzipBvs</code>, <code>summ.mmzipBvs</code>.
</p>
</td></tr>
<tr><td><code id="methods_+3A_digits">digits</code></td>
<td>

<p>a numeric value indicating the number of digits to display.
</p>
</td></tr>
<tr><td><code id="methods_+3A_object">object</code></td>
<td>

<p>an object of class <code>mvnBvs</code>, <code>mzipBvs</code>, or <code>mmzipBvs</code>.
</p>
</td></tr>
<tr><td><code id="methods_+3A_...">...</code></td>
<td>

<p>additional arguments.
</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+mvnBvs">mvnBvs</a></code>, <code><a href="#topic+mzipBvs">mzipBvs</a></code>, <code><a href="#topic+mmzipBvs">mmzipBvs</a></code>
</p>

<hr>
<h2 id='mmzipBvs'>
The function to perform variable selection for marginalized multivariate zero-inflated Poisson models
</h2><span id='topic+mmzipBvs'></span>

<h3>Description</h3>

<p>The function can be used to perform variable selection for marginalized multivariate zero-inflated Poisson models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mmzipBvs(Y, lin.pred, data, offset = NULL, zero_cutoff = 0.05, hyperParams,
 startValues, mcmcParams)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mmzipBvs_+3A_y">Y</code></td>
<td>

<p>a data.frame containing <code class="reqn">q</code> count outcomes from <code>n</code> subjects. It is of dimension <code class="reqn">n\times q</code>.
</p>
</td></tr>
<tr><td><code id="mmzipBvs_+3A_lin.pred">lin.pred</code></td>
<td>

<p>a list containing three formula objects: the first formula specifies the <code class="reqn">p_z</code> covariates for which variable selection is to be performed in the binary component of the model; the second formula specifies the <code class="reqn">p_x</code> covariates for which variable selection is to be performed in the count part of the model; the third formula specifies the <code class="reqn">p_0</code> confounders to be adjusted for (but on which variable selection is not to be performed) in the regression analysis.
</p>
</td></tr>
<tr><td><code id="mmzipBvs_+3A_data">data</code></td>
<td>

<p>a data.frame containing the variables named in the formulas in <code>lin.pred</code>.
</p>
</td></tr>
<tr><td><code id="mmzipBvs_+3A_offset">offset</code></td>
<td>

<p>an optional numeric vector with an a priori known component to be included as the
linear predictor in the count part of model.
</p>
</td></tr>
<tr><td><code id="mmzipBvs_+3A_zero_cutoff">zero_cutoff</code></td>
<td>

<p>Response variable with proportions of zeros less than <code>zero.cutoff</code> will be removed from the binary model.
</p>
</td></tr>
<tr><td><code id="mmzipBvs_+3A_hyperparams">hyperParams</code></td>
<td>

<p>(update this)
a list containing lists or vectors for hyperparameter values in hierarchical models. Components include,
<code>rho0</code> (degrees of freedom for inverse-Wishart prior for <code class="reqn">\Sigma_V</code>),
<code>Psi0</code> (a scale matrix for inverse-Wishart prior for <code class="reqn">\Sigma_V</code>),
<code>mu_alpha0</code> (hyperparameter <code class="reqn">\mu_{\alpha_0}</code> in the prior of <code class="reqn">\alpha_0</code>),
<code>mu_alpha</code> (a numeric vector of length <code class="reqn">q</code> for hyperparameter <code class="reqn">\mu_{\alpha}</code> in the prior of <code class="reqn">\alpha</code>),
<code>mu_beta0</code> (hyperparameter <code class="reqn">\mu_{\beta_0}</code> in the prior of <code class="reqn">\beta_0</code>),
<code>mu_beta</code> (a numeric vector of length <code class="reqn">q</code> for hyperparameter <code class="reqn">\mu_{\beta}</code> in the prior of <code class="reqn">\beta</code>),
<code>a_alpha0</code> (hyperparameter <code class="reqn">a_{\alpha_0}</code> in the prior of <code class="reqn">\sigma^2_{\alpha_0}</code>),
<code>b_alpha0</code> (hyperparameter <code class="reqn">b_{\alpha_0}</code> in the prior of <code class="reqn">\sigma^2_{\alpha_0}</code>),
<code>a_alpha</code> (hyperparameter <code class="reqn">a_{\alpha}</code> in the prior of <code class="reqn">\sigma^2_{\alpha}</code>),
<code>b_alpha</code> (hyperparameter <code class="reqn">b_{\alpha}</code> in the prior of <code class="reqn">\sigma^2_{\alpha}</code>),
<code>a_beta0</code> (hyperparameter <code class="reqn">a_{\beta_0}</code> in the prior of <code class="reqn">\sigma^2_{\beta_0}</code>),
<code>b_beta0</code> (hyperparameter <code class="reqn">b_{\beta_0}</code> in the prior of <code class="reqn">\sigma^2_{\beta_0}</code>),
<code>a_beta</code> (hyperparameter <code class="reqn">a_{\beta}</code> in the prior of <code class="reqn">\sigma^2_{\beta}</code>),
<code>b_beta</code> (hyperparameter <code class="reqn">b_{\beta}</code> in the prior of <code class="reqn">\sigma^2_{\beta}</code>),
<code>v_beta</code> (a numeric vector of length <code class="reqn">q</code> for the standard deviation hyperparameter <code class="reqn">v_{\beta}</code> of the regression parameter <code class="reqn">\beta</code> prior),
<code>omega_beta</code> (a numeric vector of length <code class="reqn">p_x-p_0</code> for the hyperparameter <code class="reqn">\omega_{\beta}</code> in the prior of the variable selection indicator),
<code>v_alpha</code> (a numeric vector of length <code class="reqn">q</code> for the standard deviation hyperparameter <code class="reqn">v_{\alpha}</code> of the regression parameter <code class="reqn">\alpha</code> prior),
<code>omega_alpha</code> (a numeric vector of length <code class="reqn">p_z-p_0</code> for the hyperparameter <code class="reqn">\omega_{\alpha}</code> in the prior of the variable selection indicator),
See Examples below.
</p>
</td></tr>
<tr><td><code id="mmzipBvs_+3A_startvalues">startValues</code></td>
<td>

<p>a numeric vector containing starting values for model parameters. See Examples below.
</p>
</td></tr>
<tr><td><code id="mmzipBvs_+3A_mcmcparams">mcmcParams</code></td>
<td>

<p>(update this)
a list containing variables required for MCMC sampling. Components include,
<code>run</code> (a list containing numeric values for setting the overall run: 
<code>numReps</code>, total number of scans; <code>thin</code>, extent of thinning; <code>burninPerc</code>, the proportion of burn-in).
<code>tuning</code> (a list containing numeric values relevant to tuning parameters for specific updates in Metropolis-Hastings algorithm: 
<code>beta0.prop.var</code>, variance of the proposal density for <code class="reqn">\beta_0</code>;<code>beta.prop.var</code>, variance of the proposal density for <code class="reqn">B</code>;<code>alpha.prop.var</code>, variance of the proposal density for <code class="reqn">A</code>;<code>V.prop.var</code>, variance of the proposal density for <code class="reqn">V</code>.)
See Examples below.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>mmzipBvs</code> returns an object of class <code>mmzipBvs</code>.
</p>


<h3>Author(s)</h3>

<p>Kyu Ha Lee, Brent A. Coull, Jacqueline R. Starr <br />
Maintainer: Kyu Ha Lee &lt;klee15239@gmail.com&gt;
</p>


<h3>References</h3>

<p>update this
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

# loading a data set
data(simData_mzip)
Y &lt;- simData_mzip$Y
data &lt;- simData_mzip$X

n = dim(Y)[1]
q = dim(Y)[2]

form.bin     &lt;- as.formula(~cov.1)
form.count    &lt;- as.formula(~cov.1)
form.adj    &lt;- as.formula(~1)
form &lt;- list(form.bin, form.count, form.adj)

p_adj = dim(model.frame(form[[3]], data=data))[2]
p0 &lt;- dim(model.frame(form[[1]], data=data))[2] + p_adj
p1 &lt;- dim(model.frame(form[[2]], data=data))[2] + p_adj

#####################
## Hyperparameters ##

Sigma_me &lt;- 0.5
Sigma_var &lt;- 1
rho0 &lt;- 2*Sigma_me^2/Sigma_var+q+3
psi0 &lt;- Sigma_me*(rho0-q-1)

hyperParams_mmzip &lt;- list(v_beta=rep(3, q), omega_beta=rep(0.5, p1-p_adj), 
a_beta=rep(0.5, p1), b_beta=rep(0.5, p1), mu_beta0=rep(0, q), a_beta0=0.5, b_beta0=0.5, 
v_alpha=rep(3, q), omega_alpha=rep(0.5, p0-p_adj), 
a_alpha=rep(0.5, p0), b_alpha=rep(0.5, p0), mu_alpha0=rep(0, q), a_alpha0=0.5, b_alpha0=0.5, 
rho0=rho0, Psi0=diag(psi0, q), mu_m=rep(0, q), v_m=0.5)


###################
## MCMC SETTINGS ##

run &lt;- list(numReps=100, thin=1, burninPerc=0.5)
storage &lt;- list(storeV=FALSE, storeW=FALSE)
vs &lt;- list(count=TRUE, binary=TRUE)
tuning &lt;- list(L_group=100, L_m=20, eps_group=0.00001, eps_m=0.00001, 
Mvar_group=1, Mvar_m=1, beta_prop_var=0.0001, alpha_prop_var=0.0001)

mcmc_mmzip &lt;- list(run=run, storage=storage, vs=vs, tuning=tuning)


#####################
## Starting Values

startValues_mmzip &lt;- initiate_startValues(form, Y, data, "MMZIP")

#####################
## Other settings

offset &lt;- data$total
zero_cutoff=0.05

#######################
## Fitting the MMZIP ##
#######################

fit.mmzip &lt;- mmzipBvs(Y, form, data, offset, zero_cutoff, hyperParams_mmzip, 
startValues_mmzip, mcmc_mmzip)

print(fit.mmzip)
summ.fit.mmzip &lt;- summary(fit.mmzip); names(fit.mmzip)
summ.fit.mmzip


## End(Not run)


</code></pre>

<hr>
<h2 id='mvnBvs'>
The function to perform variable selection for multivariate normal responses
</h2><span id='topic+mvnBvs'></span>

<h3>Description</h3>

<p>The function can be used to perform variable selection for multivariate normal responses incorporating not only information on the mean model, but also information on the variance-covariance structure of the outcomes. A multivariate prior is specified on the latent binary selection indicators to incorporate the dependence between outcomes into the variable selection procedure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mvnBvs(Y, lin.pred, data, model = "unstructured", hyperParams, startValues, mcmcParams)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mvnBvs_+3A_y">Y</code></td>
<td>

<p>a data.frame containing <code class="reqn">q</code> continuous multivariate outcomes from <code>n</code> subjects. It is of dimension <code class="reqn">n\times q</code>.
</p>
</td></tr>
<tr><td><code id="mvnBvs_+3A_lin.pred">lin.pred</code></td>
<td>

<p>a list containing two formula objects: the first formula specifies the <code class="reqn">p</code> covariates for which variable selection is to be performed; the second formula specifies the confounders to be adjusted for (but on which variable selection is not to be performed) in the regression analysis.
</p>
</td></tr>
<tr><td><code id="mvnBvs_+3A_data">data</code></td>
<td>

<p>a data.frame containing the variables named in the formulas in <code>lin.pred</code>.
</p>
</td></tr>
<tr><td><code id="mvnBvs_+3A_model">model</code></td>
<td>

<p>a character that specifies the covariance structure of the model: either &quot;unstructured&quot; or &quot;factor-analytic&quot;. 
</p>
</td></tr>
<tr><td><code id="mvnBvs_+3A_hyperparams">hyperParams</code></td>
<td>

<p>a list containing lists or vectors for hyperparameter values in hierarchical models. Components include, 
<code>eta</code> (a numeric value for the hyperparameter <code class="reqn">\eta</code> that regulates the extent to which the correlation between response variables influences the prior of the variable selection indicator), 
<code>v</code> (a numeric vector of length <code class="reqn">q</code> for the standard deviation hyperparameter <code class="reqn">v</code> of the regression parameter <code class="reqn">\beta</code> prior), 
<code>omega</code> (a numeric vector of length <code class="reqn">p</code> for the hyperparameter <code class="reqn">\omega</code> in the prior of the variable selection indicator), 		
<code>beta0</code> (a numeric vector of length <code class="reqn">q+1</code> for hyperparameter <code class="reqn">\mu_0</code> and <code class="reqn">h_0</code> in the prior of the intercept <code class="reqn">\beta_0</code>), 
<code>US</code> (a list containing numeric vectors for hyperparameters in the unstructured model: <code>US.Sigma</code>),
<code>FA</code> (a list containing numeric vectors for hyperparameters in the factor-analytic model: <code>lambda</code> and <code>sigmaSq</code>).
See Examples below.
</p>
</td></tr>
<tr><td><code id="mvnBvs_+3A_startvalues">startValues</code></td>
<td>

<p>a numeric vector containing starting values for model parameters: c(<code>beta0</code>, <code>B</code>, <code>gamma</code>, <code>Sigma</code>) for the unstructured model; c(<code>beta0</code>, <code>B</code>, <code>gamma</code>, <code>sigmaSq</code>, <code>lambda</code>) for the factor-analytic model. See Examples below.
</p>
</td></tr>
<tr><td><code id="mvnBvs_+3A_mcmcparams">mcmcParams</code></td>
<td>

<p>a list containing variables required for MCMC sampling. Components include,
<code>run</code> (a list containing numeric values for setting the overall run: 
<code>numReps</code>, total number of scans; <code>thin</code>, extent of thinning; <code>burninPerc</code>, the proportion of burn-in).
<code>tuning</code> (a list containing numeric values relevant to tuning parameters for specific updates in Metropolis-Hastings algorithm: 
<code>mhProp_beta_var</code>, variance of the proposal density for <code class="reqn">B</code>; <code>mhrho_prop</code>, degrees of freedom of the inverse-Wishart proposal density for <code class="reqn">\Sigma</code> in the unstructured model; 
<code>mhPsi_prop</code>, scale matrix of inverse-Wishart proposal density for <code class="reqn">\Sigma</code> in the unstructured model; 
<code>mhProp_lambda_var</code>, variance of the proposal density for <code class="reqn">\lambda</code> in the factor-analytic model.)
See Examples below.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>mvnBvs</code> returns an object of class <code>mvnBvs</code>. <br />
</p>


<h3>Author(s)</h3>

<p>Kyu Ha Lee, Mahlet G. Tadesse, Brent A. Coull <br />
Maintainer: Kyu Ha Lee &lt;klee15239@gmail.com&gt;
</p>


<h3>References</h3>

<p>Lee, K. H., Tadesse, M. G., Baccarelli, A. A., Schwartz J., and Coull, B. A. (2017),
Multivariate Bayesian variable selection exploiting dependence structure among outcomes: 
application to air pollution effects on DNA methylation, <em>Biometrics</em>, Volume 73, Issue 1, pages 232-241. <br />
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# loading a data set	
data(simData_cont)
Y &lt;- simData_cont$Y
data &lt;- simData_cont$X
form1 &lt;- as.formula( ~ cov.1+cov.2)
form2 &lt;- as.formula( ~ 1)
lin.pred &lt;- list(form1, form2)

p 		&lt;- dim(data)[2]
p_adj 	&lt;- 0
q 		&lt;- dim(Y)[2]

#####################
## Hyperparameters ##

## Common hyperparameters
##
eta = 0.1
v = rep(10, q)
omega = rep(log(0.5/(1-0.5)), p-p_adj)
common.beta0 &lt;- c(rep(0, q), 10^6)

## Unstructured model
##
rho0 	&lt;- q + 4
Psi0	&lt;- diag(3, q)
US.Sigma &lt;- c(rho0, Psi0)

## Factor-analytic model
##
FA.lam		&lt;- c(rep(0, q), 10^6)
FA.sigSq	&lt;- c(2, 1)

##
hyperParams &lt;- list(eta=eta, v=v, omega=omega, beta0=common.beta0,
					US=list(US.Sigma=US.Sigma),
					FA=list(lambda=FA.lam, sigmaSq=FA.sigSq))
                    
###################
## MCMC SETTINGS ##

## Setting for the overall run
##
numReps    &lt;- 50
thin       &lt;- 1
burninPerc &lt;- 0.5

## Tuning parameters for specific updates
##
##  - those common to all models
mhProp_beta_var  &lt;- matrix(0.5, p+p_adj, q)
##
## - those specific to the unstructured model
mhrho_prop &lt;- 1000
mhPsi_prop &lt;- diag(1, q)
##
## - those specific to the factor-analytic model
mhProp_lambda_var  &lt;- 0.5
      
##
mcmc.US &lt;- list(run=list(numReps=numReps, thin=thin, burninPerc=burninPerc),
                tuning=list(mhProp_beta_var=mhProp_beta_var,
                				mhrho_prop=mhrho_prop, mhPsi_prop=mhPsi_prop))
                
##
mcmc.FA  &lt;- list(run=list(numReps=numReps, thin=thin, burninPerc=burninPerc),
                tuning=list(mhProp_beta_var=mhProp_beta_var,
                			mhProp_lambda_var=mhProp_lambda_var))
                			
#####################
## Starting Values ##

##  - those common to all models
beta0		&lt;- rep(0, q)
B			&lt;- matrix(sample(x=c(0.3, 0), size=q, replace = TRUE), p+p_adj, q)
gamma		&lt;- B
gamma[gamma != 0]	&lt;- 1
##
## - those specific to the unstructured model
Sigma &lt;- diag(1, q) 
##
## - those specific to the factor-analytic model
lambda		&lt;- rep(0.5, q)
sigmaSq		&lt;- 1

startValues    &lt;- as.vector(c(beta0, B, gamma, Sigma))
                
####################################
## Fitting the unstructured model ##
####################################

fit.us &lt;- mvnBvs(Y, lin.pred, data, model="unstructured", hyperParams, 
				startValues, mcmcParams=mcmc.US)
				
fit.us
summ.fit.us &lt;- summary(fit.us); names(summ.fit.us)
summ.fit.us				

#######################################
## Fitting the factor-analytic model ##
#######################################
 
startValues &lt;- as.vector(c(beta0, B, gamma, sigmaSq, lambda))

fit.fa &lt;- mvnBvs(Y, lin.pred, data, model="factor-analytic", hyperParams, 
				startValues, mcmcParams=mcmc.FA)
				
fit.fa
summ.fit.fa &lt;- summary(fit.fa); names(summ.fit.fa)
summ.fit.fa				


</code></pre>

<hr>
<h2 id='mzipBvs'>
The function to perform variable selection for conditional multivariate zero-inflated Poisson models
</h2><span id='topic+mzipBvs'></span>

<h3>Description</h3>

<p>The function can be used to perform variable selection for conditional multivariate zero-inflated Poisson models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mzipBvs(Y, lin.pred, data, model = "generalized", offset = NULL, hyperParams, startValues,
 mcmcParams)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mzipBvs_+3A_y">Y</code></td>
<td>

<p>a data.frame containing <code class="reqn">q</code> count outcomes from <code>n</code> subjects. It is of dimension <code class="reqn">n\times q</code>.
</p>
</td></tr>
<tr><td><code id="mzipBvs_+3A_lin.pred">lin.pred</code></td>
<td>

<p>a list containing three formula objects: the first formula specifies the <code class="reqn">p_z</code> covariates for which variable selection is to be performed in the binary component of the model; the second formula specifies the <code class="reqn">p_x</code> covariates for which variable selection is to be performed in the count part of the model; the third formula specifies the <code class="reqn">p_0</code> confounders to be adjusted for (but on which variable selection is not to be performed) in the regression analysis.
</p>
</td></tr>
<tr><td><code id="mzipBvs_+3A_data">data</code></td>
<td>

<p>a data.frame containing the variables named in the formulas in <code>lin.pred</code>.
</p>
</td></tr>
<tr><td><code id="mzipBvs_+3A_model">model</code></td>
<td>

<p>a character that specifies the type of model: A generalized multivariate Bayesian variable selection method of Lee et al.(2018) can be implemented by setting <code>model="generalized"</code>. A simpler model that assumes one common variable selection indicator (<code class="reqn">\gamma_{j,k}=\delta_{j,k}</code>) and the same covariance pattern (<code class="reqn">R=R_V</code>) for two model parts can be used by setting <code>model="restricted1"</code>. iii) Another simpler model that assumes the same covariance pattern (<code class="reqn">R=R_V</code>) but separate variable selection indicators for the binary and count parts of the model can be implemented by setting <code>model="restricted2"</code>.
</p>
</td></tr>
<tr><td><code id="mzipBvs_+3A_offset">offset</code></td>
<td>

<p>an optional numeric vector with an a priori known component to be included as the
linear predictor in the count part of model.
</p>
</td></tr>
<tr><td><code id="mzipBvs_+3A_hyperparams">hyperParams</code></td>
<td>

<p>a list containing lists or vectors for hyperparameter values in hierarchical models. Components include,
<code>rho0</code> (degrees of freedom for inverse-Wishart prior for <code class="reqn">\Sigma_V</code>),
<code>Psi0</code> (a scale matrix for inverse-Wishart prior for <code class="reqn">\Sigma_V</code>),
<code>mu_alpha0</code> (hyperparameter <code class="reqn">\mu_{\alpha_0}</code> in the prior of <code class="reqn">\alpha_0</code>),
<code>mu_alpha</code> (a numeric vector of length <code class="reqn">q</code> for hyperparameter <code class="reqn">\mu_{\alpha}</code> in the prior of <code class="reqn">\alpha</code>),
<code>mu_beta0</code> (hyperparameter <code class="reqn">\mu_{\beta_0}</code> in the prior of <code class="reqn">\beta_0</code>),
<code>mu_beta</code> (a numeric vector of length <code class="reqn">q</code> for hyperparameter <code class="reqn">\mu_{\beta}</code> in the prior of <code class="reqn">\beta</code>),
<code>a_alpha0</code> (hyperparameter <code class="reqn">a_{\alpha_0}</code> in the prior of <code class="reqn">\sigma^2_{\alpha_0}</code>),
<code>b_alpha0</code> (hyperparameter <code class="reqn">b_{\alpha_0}</code> in the prior of <code class="reqn">\sigma^2_{\alpha_0}</code>),
<code>a_alpha</code> (hyperparameter <code class="reqn">a_{\alpha}</code> in the prior of <code class="reqn">\sigma^2_{\alpha}</code>),
<code>b_alpha</code> (hyperparameter <code class="reqn">b_{\alpha}</code> in the prior of <code class="reqn">\sigma^2_{\alpha}</code>),
<code>a_beta0</code> (hyperparameter <code class="reqn">a_{\beta_0}</code> in the prior of <code class="reqn">\sigma^2_{\beta_0}</code>),
<code>b_beta0</code> (hyperparameter <code class="reqn">b_{\beta_0}</code> in the prior of <code class="reqn">\sigma^2_{\beta_0}</code>),
<code>a_beta</code> (hyperparameter <code class="reqn">a_{\beta}</code> in the prior of <code class="reqn">\sigma^2_{\beta}</code>),
<code>b_beta</code> (hyperparameter <code class="reqn">b_{\beta}</code> in the prior of <code class="reqn">\sigma^2_{\beta}</code>),
<code>v_beta</code> (a numeric vector of length <code class="reqn">q</code> for the standard deviation hyperparameter <code class="reqn">v_{\beta}</code> of the regression parameter <code class="reqn">\beta</code> prior),
<code>omega_beta</code> (a numeric vector of length <code class="reqn">p_x-p_0</code> for the hyperparameter <code class="reqn">\omega_{\beta}</code> in the prior of the variable selection indicator),
<code>v_alpha</code> (a numeric vector of length <code class="reqn">q</code> for the standard deviation hyperparameter <code class="reqn">v_{\alpha}</code> of the regression parameter <code class="reqn">\alpha</code> prior),
<code>omega_alpha</code> (a numeric vector of length <code class="reqn">p_z-p_0</code> for the hyperparameter <code class="reqn">\omega_{\alpha}</code> in the prior of the variable selection indicator),
See Examples below.
</p>
</td></tr>
<tr><td><code id="mzipBvs_+3A_startvalues">startValues</code></td>
<td>

<p>a numeric vector containing starting values for model parameters. See Examples below.
</p>
</td></tr>
<tr><td><code id="mzipBvs_+3A_mcmcparams">mcmcParams</code></td>
<td>

<p>a list containing variables required for MCMC sampling. Components include,
<code>run</code> (a list containing numeric values for setting the overall run: 
<code>numReps</code>, total number of scans; <code>thin</code>, extent of thinning; <code>burninPerc</code>, the proportion of burn-in).
<code>tuning</code> (a list containing numeric values relevant to tuning parameters for specific updates in Metropolis-Hastings algorithm: 
<code>beta0.prop.var</code>, variance of the proposal density for <code class="reqn">\beta_0</code>;<code>beta.prop.var</code>, variance of the proposal density for <code class="reqn">B</code>;<code>alpha.prop.var</code>, variance of the proposal density for <code class="reqn">A</code>;<code>V.prop.var</code>, variance of the proposal density for <code class="reqn">V</code>.)
See Examples below.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>mzipBvs</code> returns an object of class <code>mzipBvs</code>. <br /></p>


<h3>Author(s)</h3>

<p>Kyu Ha Lee, Brent A. Coull, Jacqueline R. Starr <br />
Maintainer: Kyu Ha Lee &lt;klee15239@gmail.com&gt;
</p>


<h3>References</h3>

<p>Lee, K. H., Coull, B. A., Moscicki, A.-B., Paster, B. J., Starr, J. R. (2020),
Bayesian variable selection for multivariate zero-inflated models: application to microbiome count data, <em>Biostatistics</em>, Volume 21, Issue 3, Pages 499-517. <br />
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
# loading a data set
data(simData_mzip)
Y &lt;- simData_mzip$Y
data &lt;- simData_mzip$X

n = dim(Y)[1]
q = dim(Y)[2]

form.bin     &lt;- as.formula(~cov.1)
form.count    &lt;- as.formula(~cov.1)
form.adj    &lt;- as.formula(~1)
lin.pred &lt;- list(form.bin, form.count, form.adj)

Xmat0 &lt;- model.frame(lin.pred[[1]], data=data)
Xmat1 &lt;- model.frame(lin.pred[[2]], data=data)
Xmat_adj &lt;- model.frame(lin.pred[[3]], data=data)

p_adj = ncol(Xmat_adj)
p0 &lt;- ncol(Xmat0) + p_adj
p1 &lt;- ncol(Xmat1) + p_adj

nonz &lt;- rep(NA, q)
for(j in 1:q) nonz[j] &lt;- sum(Y[,j] != 0)

#####################
## Hyperparameters ##

## Generalized model
##
rho0     &lt;- q + 3 + 1
Psi0    &lt;- diag(3, q)

mu_alpha0     &lt;- 0
mu_alpha    &lt;- rep(0, q)

mu_beta0    &lt;- 0
mu_beta        &lt;- rep(0, q)

a_alpha0    &lt;- 0.7
b_alpha0     &lt;- 0.7

a_alpha        &lt;- rep(0.7, p0)
b_alpha     &lt;- rep(0.7, p0)

a_beta0        &lt;- 0.7
b_beta0     &lt;- 0.7

a_beta        &lt;- rep(0.7, p1)
b_beta         &lt;- rep(0.7, p1)

v_beta = rep(1, q)
omega_beta = rep(0.1, p1-p_adj)
v_alpha = rep(1, q)
omega_alpha = rep(0.1, p0-p_adj)

##
hyperParams.gen &lt;- list(rho0=rho0, Psi0=Psi0, mu_alpha0=mu_alpha0, mu_alpha=mu_alpha,
mu_beta0=mu_beta0, mu_beta=mu_beta, a_alpha0=a_alpha0, b_alpha0=b_alpha0,
a_alpha=a_alpha, b_alpha=b_alpha, a_beta0=a_beta0, b_beta0=b_beta0,
a_beta=a_beta, b_beta=b_beta, v_beta=v_beta, omega_beta=omega_beta,
v_alpha=v_alpha, omega_alpha=omega_alpha)

###################
## MCMC SETTINGS ##

## Setting for the overall run
##
numReps    &lt;- 100
thin       &lt;- 1
burninPerc &lt;- 0.5

## Settings for storage
##
storeV      &lt;-    TRUE
storeW      &lt;-    TRUE

## Tuning parameters for specific updates
##
##  - Generalized model
beta0.prop.var    &lt;- 0.5
alpha.prop.var    &lt;- 0.5
beta.prop.var    &lt;- 0.5
V.prop.var    &lt;- 0.05

##
mcmc.gen &lt;- list(run=list(numReps=numReps, thin=thin, burninPerc=burninPerc),
storage=list(storeV=storeV, storeW=storeW),
tuning=list(beta0.prop.var=beta0.prop.var, alpha.prop.var=alpha.prop.var,
beta.prop.var=beta.prop.var, V.prop.var=V.prop.var))

#####################
## Starting Values ##

## Generalized model
##
B &lt;- matrix(0.1, p1, q, byrow = T)
A &lt;- matrix(0.1, p0, q, byrow = T)

V &lt;- matrix(rnorm(n*q, 0, 0.1), n, q)
W &lt;- matrix(rnorm(n*q, 0, 0.1), n, q)

beta0 &lt;- log(as.vector(apply(Y, 2, mean)))
alpha0 &lt;- log(nonz/n / ((n-nonz)/n))

Sigma_V    &lt;- matrix(0, q, q)
diag(Sigma_V) &lt;- 1

R        &lt;- matrix(0, q, q)
diag(R) &lt;- 1

sigSq_alpha0 &lt;- 1
sigSq_alpha &lt;- rep(1, p0)
sigSq_beta0 &lt;- 1
sigSq_beta &lt;- rep(1, p1)

startValues.gen &lt;- list(B=B, A=A, V=V, W=W, beta0=beta0, alpha0=alpha0, R=R,
sigSq_alpha0=sigSq_alpha0,
sigSq_alpha=sigSq_alpha, sigSq_beta0=sigSq_beta0, sigSq_beta=sigSq_beta, Sigma_V=Sigma_V)


###################################
## Fitting the generalized model ##
###################################
fit.gen &lt;- mzipBvs(Y, lin.pred, data, model="generalized", offset=NULL, hyperParams.gen,
startValues.gen, mcmc.gen)

print(fit.gen)
summ.fit.gen &lt;- summary(fit.gen); names(summ.fit.gen)
summ.fit.gen


## End(Not run)
</code></pre>

<hr>
<h2 id='simData_cont'>
A simulated data set containing multivariate normal responses and continuous covariates
</h2><span id='topic+simData_cont'></span>

<h3>Description</h3>

<p>A simulated data set containing multivariate normal responses and continuous covariates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("simData_cont")</code></pre>


<h3>Format</h3>

<p>a list of two data frame objects. Components include, 
</p>

<dl>
<dt><code>Y</code></dt><dd><p>a data frame for 10 multivariate normal responses from 100 observations: <code>Y.1</code>-<code>Y.10</code></p>
</dd>
<dt><code>X</code></dt><dd><p>a data frame for 2 continuous covariates from 100 observations: <code>cov.1</code>-<code>cov.2</code></p>
</dd>    
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(simData_cont)
</code></pre>

<hr>
<h2 id='simData_mzip'>
A simulated data set containing multivariate zero-inflated count responses and a continuous covariate
</h2><span id='topic+simData_mzip'></span>

<h3>Description</h3>

<p>A simulated data set containing multivariate zero-inflated count responses and a continuous covariate
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("simData_mzip")</code></pre>


<h3>Format</h3>

<p>a list of two data frame objects. Components include, 
</p>

<dl>
<dt><code>Y</code></dt><dd><p>a data frame for 10 multivariate count responses from 300 observations: <code>Y.1</code>-<code>Y.10</code></p>
</dd>
<dt><code>X</code></dt><dd><p>a data frame for a single continuous covariate from 300 observations: <code>cov.1</code></p>
</dd>    
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(simData_mzip)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
