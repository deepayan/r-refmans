<!DOCTYPE html><html><head><title>Help for package simulariatools</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {simulariatools}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#contourPlot'><p>Contour plot of pollutant concentration</p></a></li>
<li><a href='#contourPlot2'><p>New contour plot of pollutant concentration field</p></a></li>
<li><a href='#createBaseMap'><p>Create base map (OBSOLETE)</p></a></li>
<li><a href='#downloadBasemap'><p>Download basemap from Italian National Geoportal</p></a></li>
<li><a href='#GeomHollowPolygon'><p>geom_hollowpolygon</p></a></li>
<li><a href='#importADSOBIN'><p>ADSO/BIN data import function</p></a></li>
<li><a href='#importRaster'><p>Import generic raster file</p></a></li>
<li><a href='#importSurferGrd'><p>Import Grid file</p></a></li>
<li><a href='#plotAvgRad'><p>Plot hourly average radiation</p></a></li>
<li><a href='#plotAvgTemp'><p>Plot average temperature</p></a></li>
<li><a href='#plotStabilityClass'><p>Plot stability class</p></a></li>
<li><a href='#removeOutliers'><p>Remove data outliers</p></a></li>
<li><a href='#rollingMax'><p>Compute rolling max</p></a></li>
<li><a href='#stabilityClass'><p>Stability class.</p></a></li>
<li><a href='#stat_hollow_contour'><p>Contour plot with hollow management</p></a></li>
<li><a href='#stMeteo'><p>Meteorological dataset with hourly values</p></a></li>
<li><a href='#vectorField'><p>Vector field plot</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Simularia Tools for the Analysis of Air Pollution Data</td>
</tr>
<tr>
<td>Version:</td>
<td>2.5.1</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Giuseppe Carlino &lt;g.carlino@simularia.it&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>A set of tools developed at Simularia for Simularia, to help
    preprocessing and post-processing of meteorological and air quality data.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.3)</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2 (&ge; 3.3), lubridate, reshape2, reticulate, scales,
terra</td>
</tr>
<tr>
<td>Suggests:</td>
<td>magick, contoureR, testthat (&ge; 3.0.0), raster, openair</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://www.simularia.it/simulariatools/">https://www.simularia.it/simulariatools/</a>,
<a href="https://github.com/Simularia/simulariatools">https://github.com/Simularia/simulariatools</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/Simularia/simulariatools/issues">https://github.com/Simularia/simulariatools/issues</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-11-08 13:51:21 UTC; beps</td>
</tr>
<tr>
<td>Author:</td>
<td>Giuseppe Carlino [aut, cre],
  Matteo Paolo Costa [ctb],
  Simularia [cph, fnd]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-11-08 14:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='contourPlot'>Contour plot of pollutant concentration</h2><span id='topic+contourPlot'></span>

<h3>Description</h3>

<p><code>contourPlot</code> plots a contour map of pollutants. This function has been
deprecated since version 2.0.0 and will be removed very soon.
Use <code><a href="#topic+contourPlot2">contourPlot2</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>contourPlot(
  data,
  domain = NULL,
  background = NULL,
  underlayer = NULL,
  overlayer = NULL,
  legend = NULL,
  levels = NULL,
  size = 0,
  cover = TRUE,
  transparency = 0.66,
  smoothness = 1,
  colors = NULL,
  bare = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="contourPlot_+3A_data">data</code></td>
<td>
<p>A dataframe containing data to be plotted in the form of X, Y and
Z (levels).</p>
</td></tr>
<tr><td><code id="contourPlot_+3A_domain">domain</code></td>
<td>
<p>An array with min X, max X, min Y, max Y, number of ticks on X
axis, number of ticks on Y axis (optional).</p>
</td></tr>
<tr><td><code id="contourPlot_+3A_background">background</code></td>
<td>
<p>String containing the path to the png file to be plotted as
a basemap (optional).</p>
</td></tr>
<tr><td><code id="contourPlot_+3A_underlayer">underlayer</code></td>
<td>
<p>Array of strings containing layers to be plotted between
basemap and contour plot (optional).</p>
</td></tr>
<tr><td><code id="contourPlot_+3A_overlayer">overlayer</code></td>
<td>
<p>Array of strings containing layers to be plotted on top of
the contour plot (optional).</p>
</td></tr>
<tr><td><code id="contourPlot_+3A_legend">legend</code></td>
<td>
<p>(string) Legend title (optional).</p>
</td></tr>
<tr><td><code id="contourPlot_+3A_levels">levels</code></td>
<td>
<p>Array of levels for contour plot. If not set, automatic levels
are plotted.</p>
</td></tr>
<tr><td><code id="contourPlot_+3A_size">size</code></td>
<td>
<p>float with the thickness of the contour line.</p>
</td></tr>
<tr><td><code id="contourPlot_+3A_cover">cover</code></td>
<td>
<p>boolean (default TRUE) to specify whether the contour plot
should be filled or not.</p>
</td></tr>
<tr><td><code id="contourPlot_+3A_transparency">transparency</code></td>
<td>
<p>float (between 0 and 1, default=0.66). Transparency level
of the contour plot.</p>
</td></tr>
<tr><td><code id="contourPlot_+3A_smoothness">smoothness</code></td>
<td>
<p>integer factor to improve the horizontal resolution
(smaller cells) by bilinear interpolation.</p>
</td></tr>
<tr><td><code id="contourPlot_+3A_colors">colors</code></td>
<td>
<p>Color palette for contour plot</p>
</td></tr>
<tr><td><code id="contourPlot_+3A_bare">bare</code></td>
<td>
<p>Boolean (default FALSE) parameter to completely remove axis,
legend, titles and any other graphical element from the plot.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a convenience function to plot contour levels of a pollutant matrix
with <code>ggplot2</code>.
</p>


<h3>Value</h3>

<p>A <code>ggplot2</code> plot.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load example data in long format
data(volcano)
volcano3d &lt;- reshape2::melt(volcano)
names(volcano3d) &lt;- c("x", "y", "z")
# Contour plot with default options
contourPlot(volcano3d)

# Import variable CONCAN from inpufile, convert km to m (k = 1000):
data &lt;- importRaster(paste0(dir, inputfile), 
                     k = 1000, 
                     variable = "CONCAN")

# Simple contour plot
contourPlot(data)

# Specifiy (sub)domain to be plotted; background image; legend title and 
# pollutant levels.
contourPlot(data, 
            domain(500000, 510000, 6000000, 6010000, 7, 7), 
            background = "img/background.png", 
            legend = "no2 [ug/m3]", 
            levels = c(10, 20, 30, 40))

# Add underlayer (same for overlayer)
library(ggplot2)
library(maptools)
perimetro &lt;- readShapeLines("path_to/perimetro.shp")
perimetro &lt;- fortify(perimetro)
strada &lt;- readShapeLines("path_to/strada.shp")
strada &lt;- fortify(strada)
myUnderlayer &lt;- vector(mode = "list", length = 2)
myUnderlayer[[1]] &lt;- geom_polygon(data = perimetro, 
                                  aes(long, lat, group = group), 
                                  colour = "black", 
                                  fill = NA, 
                                  size = 0.1, 
                                  alpha = 0.5)
myUnderlayer[[2]] &lt;- geom_path(data = strada, 
                               aes(long, lat, group = group), 
                               colour = "grey", 
                               size = 0.1, 
                               alpha = 0.5)
contourPlot(data = test, 
            background = "path_to/basemap.png", 
            underlayer = myUnderlayer)

# Change default colour palette
contourPlot(data = test, 
            colors = RColorBrewer::brewer.pal(3, name = "PiYG"))

## End(Not run)

</code></pre>

<hr>
<h2 id='contourPlot2'>New contour plot of pollutant concentration field</h2><span id='topic+contourPlot2'></span>

<h3>Description</h3>

<p><code>contourPlot2</code> plots a contour map of a given quantity, such as the
ground concentration of an airborne pollutant or odour, defined on a
regular grid.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>contourPlot2(
  data,
  x = "x",
  y = "y",
  z = "z",
  domain = NULL,
  background = NULL,
  underlayer = NULL,
  overlayer = NULL,
  legend = NULL,
  levels = NULL,
  size = 0,
  fill = TRUE,
  tile = FALSE,
  transparency = 0.75,
  colors = NULL,
  bare = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="contourPlot2_+3A_data">data</code></td>
<td>
<p>dataframe in long format, with three columns for Easting,
Northing and values to be plotted.</p>
</td></tr>
<tr><td><code id="contourPlot2_+3A_x">x</code></td>
<td>
<p>name of the column with Easting data (default &quot;x&quot;).</p>
</td></tr>
<tr><td><code id="contourPlot2_+3A_y">y</code></td>
<td>
<p>name of the column with Northing data (default &quot;y&quot;).</p>
</td></tr>
<tr><td><code id="contourPlot2_+3A_z">z</code></td>
<td>
<p>name of the column with the values to be plotted (default
&quot;z&quot;).</p>
</td></tr>
<tr><td><code id="contourPlot2_+3A_domain">domain</code></td>
<td>
<p>optional list with six numeric values defining the
boundaries of the domain to be plotted: minimum X, maximum X, minimum Y,
maximum Y, number of ticks on X axis, number of ticks on Y axis.</p>
</td></tr>
<tr><td><code id="contourPlot2_+3A_background">background</code></td>
<td>
<p>optional path to a png file to be plotted as the base map.</p>
</td></tr>
<tr><td><code id="contourPlot2_+3A_underlayer">underlayer</code></td>
<td>
<p>optional list of layers to be plotted between base map
and contour plot.</p>
</td></tr>
<tr><td><code id="contourPlot2_+3A_overlayer">overlayer</code></td>
<td>
<p>optional list of layers to be plotted on top of the contour
plot.</p>
</td></tr>
<tr><td><code id="contourPlot2_+3A_legend">legend</code></td>
<td>
<p>optional title of the legend.</p>
</td></tr>
<tr><td><code id="contourPlot2_+3A_levels">levels</code></td>
<td>
<p>numeric vector of levels for contour plot. If not set,
automatic pretty levels are computed. If <code>-Inf</code> and <code>Inf</code> are used as the lowest
and highest limits of the array, the lowest and highest bands are unbounded
and the legend shows <code>&lt;</code> and <code>&gt;=</code> symbols.</p>
</td></tr>
<tr><td><code id="contourPlot2_+3A_size">size</code></td>
<td>
<p>thickness of the contour line.</p>
</td></tr>
<tr><td><code id="contourPlot2_+3A_fill">fill</code></td>
<td>
<p>boolean (default TRUE). If TRUE the contour plot is filled with
colour.</p>
</td></tr>
<tr><td><code id="contourPlot2_+3A_tile">tile</code></td>
<td>
<p>boolean (default FALSE). If TRUE rectangular tiles are plotted.</p>
</td></tr>
<tr><td><code id="contourPlot2_+3A_transparency">transparency</code></td>
<td>
<p>transparency level of the contour plot between 0.0
(fully transparent) and 1.0 (fully opaque). Default = 0.75).</p>
</td></tr>
<tr><td><code id="contourPlot2_+3A_colors">colors</code></td>
<td>
<p>colour palette for contour plot, as an array of colours.</p>
</td></tr>
<tr><td><code id="contourPlot2_+3A_bare">bare</code></td>
<td>
<p>boolean (default FALSE). If TRUE only the bare plot is shown:
axis, legend, titles and any other graphical element of the plot are removed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a convenience function to plot contour levels of a scalar quantity
such as pollutants computed by a dispersion model, with <code>ggplot2</code>
version &gt;= 3.3.0.
</p>
<p>Data are required to be on a regular grid, typically (but not necessarily)
in UTM coordinates. The input dataframe has to be in long format, i.e. one
line per value to be plotted. The names of the columns corresponding to <code>x</code>,
<code>y</code> and <code>z</code> can be specified in the input parameters.
</p>
<p>If <code>tile = TRUE</code> data are shown as they are, without any graphical
interpolation required for contour plots. This is helpful when you want to
visualise the raw data.
Since version 2.4.0, when <code>tile = TRUE</code> the intervals include the lowest
bound and exclude the highest bound: <code style="white-space: pre;">&#8288;[min, max)&#8288;</code>. Note: In previous version
it was the opposite.
</p>
<p><code>underlayer</code> and <code>overlayer</code> layers are <code>ggplot2</code> objects to be shown at
different levels of the vertical stack of the plot. These are useful to
show topographical information related to the plot, such as sources
or receptors locations.
</p>


<h3>Value</h3>

<p>A <code>ggplot2</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load example data in long format
data(volcano)
volcano3d &lt;- reshape2::melt(volcano)
names(volcano3d) &lt;- c("x", "y", "z")
# Contour plot with default options
v &lt;- contourPlot2(volcano3d)
v

# Set levels, and properly format the legend title:
contourPlot2(volcano3d, 
             levels = c(-Inf, seq(100, 200, 20), Inf),
             legend = expression(PM[10]~"["~mu*g~m^-3~"]"))

# Sometimes, instead of a contour plot it is better to plot the original
# raster data, without any interpolation:
contourPlot2(volcano3d, 
             levels = c(-Inf, seq(100, 200, 20), Inf), 
             tile = TRUE)

# Since contourPlot2 returns a `ggplot2` object, you can add instructions as:
library(ggplot2)
v + ggtitle("Example volcano data") +
    labs(x = NULL, y = NULL)

</code></pre>

<hr>
<h2 id='createBaseMap'>Create base map (OBSOLETE)</h2><span id='topic+createBaseMap'></span>

<h3>Description</h3>

<p>Create base map. This is meant to be the deepest layer of contour plot map.
Axes coordinates are supposed to be in meters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>createBaseMap(
  imageFile,
  domain = c(0, 0, 1000, 1000, 5, 5),
  font_size = 10,
  font_family = "sans"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="createBaseMap_+3A_imagefile">imageFile</code></td>
<td>
<p>(string) Path to the background 'png' file.</p>
</td></tr>
<tr><td><code id="createBaseMap_+3A_domain">domain</code></td>
<td>
<p>Six components vector with the domain SW corner coordinates,
the X and Y extensions, and the number of breaks along the to axis (X, Y,
DX, DY, NX, NY)</p>
</td></tr>
<tr><td><code id="createBaseMap_+3A_font_size">font_size</code></td>
<td>
<p>This is the font size for axis labels</p>
</td></tr>
<tr><td><code id="createBaseMap_+3A_font_family">font_family</code></td>
<td>
<p>This is the font family for labels</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>ggplot2</code> plot.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Import image 'img'. Divide the axis with 9 ticks.
v &lt;- createBaseMap(img, c(minx, miny, extent, extent, 9, 9), font_size=10)

## End(Not run)

</code></pre>

<hr>
<h2 id='downloadBasemap'>Download basemap from Italian National Geoportal</h2><span id='topic+downloadBasemap'></span>

<h3>Description</h3>

<p>This function tries to download the aerial orthophoto of the requested
domain from the
<a href="http://www.pcn.minambiente.it/mattm/en/services/">Italian National Geoportal</a>.
The output is given in <em>png</em> format at the path given in the <code>file</code>
parameter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>downloadBasemap(
  file = file,
  xSW = 410000,
  ySW = 5000500,
  xExt = 5000,
  yExt = 5000,
  crs = 32,
  width = 1024,
  height = 1024,
  units = "px",
  res = 72
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="downloadBasemap_+3A_file">file</code></td>
<td>
<p>Path to output file.</p>
</td></tr>
<tr><td><code id="downloadBasemap_+3A_xsw">xSW</code></td>
<td>
<p>South West Easting UTM coordinate of the basemap (in metres).</p>
</td></tr>
<tr><td><code id="downloadBasemap_+3A_ysw">ySW</code></td>
<td>
<p>South West Northing UTM coordinate of the basemap (in metres).</p>
</td></tr>
<tr><td><code id="downloadBasemap_+3A_xext">xExt</code></td>
<td>
<p>Easting extension in metres.</p>
</td></tr>
<tr><td><code id="downloadBasemap_+3A_yext">yExt</code></td>
<td>
<p>Northing extension in metres.</p>
</td></tr>
<tr><td><code id="downloadBasemap_+3A_crs">crs</code></td>
<td>
<p>UTM Coordinate Reference System: either 32 or 33.</p>
</td></tr>
<tr><td><code id="downloadBasemap_+3A_width">width</code></td>
<td>
<p>The basemap width.</p>
</td></tr>
<tr><td><code id="downloadBasemap_+3A_height">height</code></td>
<td>
<p>The basemap height.</p>
</td></tr>
<tr><td><code id="downloadBasemap_+3A_units">units</code></td>
<td>
<p>The unit of measure of width and height.
It can be <code>px</code> (pixels, the default), <code style="white-space: pre;">&#8288;in&#8288;</code> (inches), <code>cm</code> or <code>mm</code></p>
</td></tr>
<tr><td><code id="downloadBasemap_+3A_res">res</code></td>
<td>
<p>The resolution in dpi.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value is returned.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Download a basemap of a domain with SW coordinates (410000, 5000500) 
# in the UTM32 CRS and extension 5000m in both directions.

downloadBasemap(file = "./basemap.png", 
                xSW = 410000, ySW = 5000500, xExt = 5000, yExt = 5000)

# Download a basemap of a domain with SW coordinates (410000, 5000500) 
# in the UTM32 CRS and extension 5000m in both directions.
# The file has to be 2048 x 2048 pixels.

downloadBasemap(file = "./basemap.png", 
                xSW = 410000, ySW = 5000500, xExt = 5000, yExt = 5000, 
                width = 2048, height = 2048)
                
# Download a basemap of a domain with SW coordinates (410000, 5000500)
# in the UTM32 CRS and extension 5000m in both directions.
# The file has to be 10cm x 10cm with a resolution of 150 dpi.

downloadBasemap(file = "./basemap.png", 
                xSW = 410000, ySW = 5000500, xExt = 5000, yExt = 5000, 
                width = 10, height = 10, units = "cm", res = 150)

## End(Not run)
</code></pre>

<hr>
<h2 id='GeomHollowPolygon'>geom_hollowpolygon</h2><span id='topic+GeomHollowPolygon'></span>

<h3>Description</h3>

<p>new geom to manage hollows in contour plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GeomHollowPolygon
</code></pre>


<h3>Format</h3>

<p>An object of class <code>GeomHollowPolygon</code> (inherits from <code>Geom</code>, <code>ggproto</code>, <code>gg</code>) of length 5.
</p>


<h3>References</h3>

<p>See http://rpubs.com/kohske/352
See http://docs.ggplot2.org/dev/vignettes/extending-ggplot2.html
</p>

<hr>
<h2 id='importADSOBIN'>ADSO/BIN data import function</h2><span id='topic+importADSOBIN'></span>

<h3>Description</h3>

<p>Import data from ADSO/BIN binary file. It requires an active Python
installation with the <code>arinfopy</code> library.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>importADSOBIN(
  file = file.choose(),
  variable = NULL,
  slice = 1,
  deadline = 1,
  k = 1,
  kz = 1,
  dx = 0,
  dy = 0,
  destaggering = FALSE,
  raster.object = FALSE,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="importADSOBIN_+3A_file">file</code></td>
<td>
<p>The ADSO/BIN file to be imported.</p>
</td></tr>
<tr><td><code id="importADSOBIN_+3A_variable">variable</code></td>
<td>
<p>A string with the name of the variable to be imported.</p>
</td></tr>
<tr><td><code id="importADSOBIN_+3A_slice">slice</code></td>
<td>
<p>An integer corresponding to the  horizontal slice (vertical
level) of 3D variables (default = 1). In the case of a 2D variable, it is
ignored.</p>
</td></tr>
<tr><td><code id="importADSOBIN_+3A_deadline">deadline</code></td>
<td>
<p>An integer representing the temporal deadline (default = 1).
It can optionally be a string with date time (see examples).</p>
</td></tr>
<tr><td><code id="importADSOBIN_+3A_k">k</code></td>
<td>
<p>A numeric factor to be applied to x and y coordinates (default = 1).</p>
</td></tr>
<tr><td><code id="importADSOBIN_+3A_kz">kz</code></td>
<td>
<p>A numeric factor to be applied to z values to rescale them (default
= 1).</p>
</td></tr>
<tr><td><code id="importADSOBIN_+3A_dx">dx</code></td>
<td>
<p>A number to shift x coordinates by dx (default = 0).</p>
</td></tr>
<tr><td><code id="importADSOBIN_+3A_dy">dy</code></td>
<td>
<p>A number to shift y coordinates by dy (default = 0).</p>
</td></tr>
<tr><td><code id="importADSOBIN_+3A_destaggering">destaggering</code></td>
<td>
<p>Use <code>TRUE</code> to apply destaggering to X and Y coordinates
(default = <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="importADSOBIN_+3A_raster.object">raster.object</code></td>
<td>
<p>Use <code>TRUE</code> to return a <code>raster</code> object instead of a
dataframe with (X, Y, Z) columns (default = <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="importADSOBIN_+3A_verbose">verbose</code></td>
<td>
<p>Use <code>TRUE</code> to print out basic statistics (default = <code>FALSE</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>importADSIOBIN()</code> function was developed to import data from an
ADSO/BIN binary file. It relies on the &lsquo;arinfopy&rsquo; (version &gt;= 2.2.0) python
library. For more information on the library see the <a href="https://github.com/Simularia/arinfopy">GitHub repository</a>.
</p>
<p>For more information on the active <code>python</code> installation, check the
documentation of <span class="pkg">reticulate</span>.
</p>


<h3>Value</h3>

<p>In standard use, <code>importADSOBIN()</code> return a data frame with
<code style="white-space: pre;">&#8288;(X, Y, Z)&#8288;</code> columns. Column Z contains the values of the requested variable.
If the <code>raster.object</code> option is set, it returns a RasterLayer object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+importRaster">importRaster()</a></code>, <code><a href="#topic+importSurferGrd">importSurferGrd()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
# Read ground level (slice = 1) value of variable M001S001.
pm10 &lt;- importADSOBIN(file = "average_2018.bin",
                      variable = "M001S001",
                      slice = 1)

# Read deadline 12 of the second vertical level of temperature:
temperature &lt;- importADSOBIN(file = "swift_surfpro_01-10_01_2018",
                             variable = "TEMPK",
                             slice = 2,
                             deadline = 12)

# Read varibale M001S001 at ground level, at given date and time,
# and print basic information:
nox &lt;- importADSOBIN(file = "conc_01-10_07_2018",
                     variable = "M001S001",
                     slice = 1,
                     deadline = "2018/07/02 12:00",
                     verbose = TRUE)

## End(Not run)

</code></pre>

<hr>
<h2 id='importRaster'>Import generic raster file</h2><span id='topic+importRaster'></span>

<h3>Description</h3>

<p>The function import the first layer of a generic raster file. Data are
imported as an array of x, y, z columns.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>importRaster(
  file = file.choose(),
  k = 1,
  kz = 1,
  dx = 0,
  dy = 0,
  destaggering = FALSE,
  variable = NULL,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="importRaster_+3A_file">file</code></td>
<td>
<p>The raster file to be imported.</p>
</td></tr>
<tr><td><code id="importRaster_+3A_k">k</code></td>
<td>
<p>A numerical factor to be applied to x and y coordinates (default =
1).</p>
</td></tr>
<tr><td><code id="importRaster_+3A_kz">kz</code></td>
<td>
<p>A numerical factor to be applied to z values (default = 1).</p>
</td></tr>
<tr><td><code id="importRaster_+3A_dx">dx</code></td>
<td>
<p>Shifts x coordinates by dx (default = 0).</p>
</td></tr>
<tr><td><code id="importRaster_+3A_dy">dy</code></td>
<td>
<p>float. Shift y coordinates by dy (default = 0).</p>
</td></tr>
<tr><td><code id="importRaster_+3A_destaggering">destaggering</code></td>
<td>
<p>Use <code>TRUE</code> to apply destaggering to X and Y coordinates
(default = FALSE).</p>
</td></tr>
<tr><td><code id="importRaster_+3A_variable">variable</code></td>
<td>
<p>The name of the variable to be imported.</p>
</td></tr>
<tr><td><code id="importRaster_+3A_verbose">verbose</code></td>
<td>
<p>If <code>TRUE</code>, prints out basic statistics (default = FALSE).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Supported files include those managed by the <span class="pkg">raster</span> package (as
netcdf),
</p>
<p>Destaggering is useful for importing data from the SPRAY model and it is not
applied by default.
</p>
<p>An optional summary output can be printed by setting the <code>verbose</code> parameter.
</p>
<p>This function is based on the <code>terra</code> package and it can import any format
managed by it.
</p>


<h3>Value</h3>

<p>It returns a dataframe with x, y and z columns.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+importADSOBIN">importADSOBIN()</a></code>, <code><a href="#topic+importSurferGrd">importSurferGrd()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Import binary (netcdf) file and convert coordinates from km to m,
# without destaggering:
mydata &lt;- importRaster(file = "/path_to_file/filename.nc",
                       k = 1000,
                       destaggering = FALSE)

# Import binary (netcdf) file and convert coordinates from km to m,
# with shift of 100 m in both directions:
mydata &lt;- importRaster(file = "/path_to_file/filename.nc",
                       k = 1000,
                       dx = 100,
                       dy = 100)

## End(Not run)
</code></pre>

<hr>
<h2 id='importSurferGrd'>Import Grid file</h2><span id='topic+importSurferGrd'></span>

<h3>Description</h3>

<p>A function to import data from Surfer text grid file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>importSurferGrd(fname, k = 1000, destaggering = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="importSurferGrd_+3A_fname">fname</code></td>
<td>
<p>Surfer grd file to be imported</p>
</td></tr>
<tr><td><code id="importSurferGrd_+3A_k">k</code></td>
<td>
<p>Factor to apply to x and y coordinates</p>
</td></tr>
<tr><td><code id="importSurferGrd_+3A_destaggering">destaggering</code></td>
<td>
<p>Boolean variable to apply or not destaggering.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Surfer grd file is imported and an array of x, y, z columns is returned
X and y coordinates can be converted from km to m (default k=1000)
and vice versa. Destaggering is applied by default.
</p>


<h3>Value</h3>

<p>A dataset with x, y and z columns is returned.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+importRaster">importRaster()</a></code>, <code><a href="#topic+importADSOBIN">importADSOBIN()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Import Surfer Grd file and convert coordinates from km to m, 
# with destaggering
mydata &lt;- importSurferGrd("/path_to_file/filename.grd", k = 1000)

# Import Surfer Grd file and do not convert coordinates, without
#  destaggering
mydata &lt;- importSurferGrd("path_to_file/filename.grd", k = 1,
                          destaggering = FALSE)

## End(Not run)
</code></pre>

<hr>
<h2 id='plotAvgRad'>Plot hourly average radiation</h2><span id='topic+plotAvgRad'></span>

<h3>Description</h3>

<p>Plot a histogram with hourly average of solar radiation, together with
hourly maxima for June and December.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotAvgRad(mydata, date = "date", rad = "radg")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotAvgRad_+3A_mydata">mydata</code></td>
<td>
<p>A data frame containing fields with solar radiation time
series.</p>
</td></tr>
<tr><td><code id="plotAvgRad_+3A_date">date</code></td>
<td>
<p>Name of the column representing date and time.</p>
</td></tr>
<tr><td><code id="plotAvgRad_+3A_rad">rad</code></td>
<td>
<p>Name of the column representing radiation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>ggplot2</code> plot.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plotStabilityClass">plotStabilityClass()</a></code>, <code><a href="#topic+plotAvgTemp">plotAvgTemp()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(stMeteo)
plotAvgRad(stMeteo, date = "date", rad = "radg")

</code></pre>

<hr>
<h2 id='plotAvgTemp'>Plot average temperature</h2><span id='topic+plotAvgTemp'></span>

<h3>Description</h3>

<p><code>plotAvgTemp</code> builds a bar plot of time average temperature and two
line plots with maximum and minimum temperature.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotAvgTemp(
  mydata,
  temp = "temp",
  avg.time = "1 month",
  ylabel = "Temperatura [C]",
  title = ""
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotAvgTemp_+3A_mydata">mydata</code></td>
<td>
<p>A data frame containing fields date and temp</p>
</td></tr>
<tr><td><code id="plotAvgTemp_+3A_temp">temp</code></td>
<td>
<p>Name of the column representing temperature</p>
</td></tr>
<tr><td><code id="plotAvgTemp_+3A_avg.time">avg.time</code></td>
<td>
<p>This defines the time period to average to
(see openair::timeAverage). Default is &quot;1 month&quot;.</p>
</td></tr>
<tr><td><code id="plotAvgTemp_+3A_ylabel">ylabel</code></td>
<td>
<p>The label to be plot along y axis</p>
</td></tr>
<tr><td><code id="plotAvgTemp_+3A_title">title</code></td>
<td>
<p>Option plot title</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot with average, min and max temperature in a given
range of time.
</p>


<h3>Note</h3>

<p><code>plotAvgTemp</code> uses <code>openair::timeAvearge</code> to compute average.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plotStabilityClass">plotStabilityClass()</a></code>, <code><a href="#topic+plotAvgRad">plotAvgRad()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Plot histogram with monthly averages together with maxima and minima 
# curves
data(stMeteo)
plotAvgTemp(stMeteo)
plotAvgTemp(stMeteo, temp = "temperature", 
            avg.time = "1 month", ylabel = "Temperatura [C]")
</code></pre>

<hr>
<h2 id='plotStabilityClass'>Plot stability class</h2><span id='topic+plotStabilityClass'></span>

<h3>Description</h3>

<p>Plot histogram of stability class on season or hour base.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotStabilityClass(mydata, sc = "sc", type = "season")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotStabilityClass_+3A_mydata">mydata</code></td>
<td>
<p>A data frame containing <code>date</code> and <code>stability class</code>
fields.</p>
</td></tr>
<tr><td><code id="plotStabilityClass_+3A_sc">sc</code></td>
<td>
<p>The name of the stability class field.</p>
</td></tr>
<tr><td><code id="plotStabilityClass_+3A_type">type</code></td>
<td>
<p>type determines how the data are split and then plotted.
Accepted values are &quot;season&quot; (default) and &quot;hour&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Numerical values of stability classes are mapped as: 1 = A, 2 = B, ..., 6 = F.
</p>


<h3>Value</h3>

<p>A <code>ggplot2</code> plot.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stabilityClass">stabilityClass()</a></code>, <code><a href="#topic+plotAvgRad">plotAvgRad()</a></code>, <code><a href="#topic+plotAvgTemp">plotAvgTemp()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(stMeteo)

# Season plot of stability class pgt
plotStabilityClass(stMeteo, sc = "pgt", type = "season")

# Hourly plot of stability class pgt
plotStabilityClass(stMeteo, sc = "pgt", type = "hour")

</code></pre>

<hr>
<h2 id='removeOutliers'>Remove data outliers</h2><span id='topic+removeOutliers'></span>

<h3>Description</h3>

<p>Remove data outliers based on the interquartile range.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>removeOutliers(x, k = 1.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="removeOutliers_+3A_x">x</code></td>
<td>
<p>vector of data.</p>
</td></tr>
<tr><td><code id="removeOutliers_+3A_k">k</code></td>
<td>
<p>factor to applied to the interquartile range (default = 1.5).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The interquartile range IQR is computed from input dataset as IQR = Q3 - Q1,
where Q1 is 25th percentile and Q3 is the 75th percentile.
Values larger than Q3 + k * IQR and smaller than Q1 - k * IQR are deemed
as outliers and substituted with NA's.
</p>
<p>The default value of k is 1.5.
</p>


<h3>Value</h3>

<p>A numeric vector with the same length as input vector.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mydata &lt;- c(-10 * runif(10), runif(10))
removeOutliers(mydata)

</code></pre>

<hr>
<h2 id='rollingMax'>Compute rolling max</h2><span id='topic+rollingMax'></span>

<h3>Description</h3>

<p>The rolling maximum value along a series of data is computed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rollingMax(mydata, length = 24)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rollingMax_+3A_mydata">mydata</code></td>
<td>
<p>A vector of data</p>
</td></tr>
<tr><td><code id="rollingMax_+3A_length">length</code></td>
<td>
<p>The length of data subset where the maximum values has
to be picked. The value must be greater or equal than 3.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It computes the maximum value centred along a subset of data.
</p>


<h3>Value</h3>

<p>A numeric vector of the same length as <code>mydata</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Compute rolling max along 24 hours on hourly time series
data(airquality)
solar.R.24 &lt;- rollingMax(mydata = airquality$Solar.R, length = 24)

</code></pre>

<hr>
<h2 id='stabilityClass'>Stability class.</h2><span id='topic+stabilityClass'></span>

<h3>Description</h3>

<p>Computes stability class given net radiation, total cloud cover and wind
speed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stabilityClass(rad, tcc, ws, option = "impact")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stabilityClass_+3A_rad">rad</code></td>
<td>
<p>The net radiation in W/m^2</p>
</td></tr>
<tr><td><code id="stabilityClass_+3A_tcc">tcc</code></td>
<td>
<p>The total cloud cover in a range from 1  to 8</p>
</td></tr>
<tr><td><code id="stabilityClass_+3A_ws">ws</code></td>
<td>
<p>wind speed in m/s</p>
</td></tr>
<tr><td><code id="stabilityClass_+3A_option">option</code></td>
<td>
<p>This is to determine which specific categories to use
to determine the stability
class. It can be <code>impact</code> to comply with ARIA Impact(tm),
<code>pasquill</code> or <code>custom</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>stabilityClass()</code> computes stability class according to IAEA method based
on net radiation, total cloud cover tcc and wind speed.
Net radiation and wind are used by day; tcc and wind are used by night.
</p>
<p>Three different alogorithms are implemented; see source code for details.
</p>


<h3>Value</h3>

<p><code>stabilityClass</code> returns a numeric vector with Pasquill
stability classes coded as: A = 1, B = 2, ... , F = 6.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plotStabilityClass">plotStabilityClass()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Compute stability class with custom algorithm
stMeteo$cst &lt;- stabilityClass(rad = stMeteo$rad,
                              tcc = stMeteo$tcc,
                              ws = stMeteo$ws,
                              option = "custom")
                              
</code></pre>

<hr>
<h2 id='stat_hollow_contour'>Contour plot with hollow management</h2><span id='topic+stat_hollow_contour'></span>

<h3>Description</h3>

<p>Contour plot with hollow management
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stat_hollow_contour(
  mapping = NULL,
  data = NULL,
  geom = "hollow_polygon",
  position = "identity",
  na.rm = FALSE,
  show.legend = NA,
  inherit.aes = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stat_hollow_contour_+3A_mapping">mapping</code></td>
<td>
<p>Set of aesthetic mappings created by <code><a href="ggplot2.html#topic+aes">aes()</a></code> or
<code><a href="ggplot2.html#topic+aes_">aes_()</a></code>. If specified and <code>inherit.aes = TRUE</code> (the
default), it is combined with the default mapping at the top level of the
plot. You must supply <code>mapping</code> if there is no plot mapping.</p>
</td></tr>
<tr><td><code id="stat_hollow_contour_+3A_data">data</code></td>
<td>
<p>The data to be displayed in this layer.</p>
</td></tr>
<tr><td><code id="stat_hollow_contour_+3A_geom">geom</code></td>
<td>
<p>The geometric object to use display the data</p>
</td></tr>
<tr><td><code id="stat_hollow_contour_+3A_position">position</code></td>
<td>
<p>Position adjustment, either as a string, or the result of
a call to a position adjustment function.</p>
</td></tr>
<tr><td><code id="stat_hollow_contour_+3A_na.rm">na.rm</code></td>
<td>
<p>If <code>FALSE</code>, the default, missing values are removed with
a warning. If <code>TRUE</code>, missing values are silently removed.</p>
</td></tr>
<tr><td><code id="stat_hollow_contour_+3A_show.legend">show.legend</code></td>
<td>
<p>logical. Should this layer be included in the legends?
<code>NA</code>, the default, includes if any aesthetics are mapped.
<code>FALSE</code> never includes, and <code>TRUE</code> always includes.
It can also be a named logical vector to finely select the aesthetics to
display.</p>
</td></tr>
<tr><td><code id="stat_hollow_contour_+3A_inherit.aes">inherit.aes</code></td>
<td>
<p>If <code>FALSE</code>, overrides the default aesthetics,
rather than combining with them. This is most useful for helper functions
that define both data and aesthetics and shouldn't inherit behaviour from
the default plot specification, e.g. <code><a href="ggplot2.html#topic+borders">borders()</a></code>.</p>
</td></tr>
<tr><td><code id="stat_hollow_contour_+3A_...">...</code></td>
<td>
<p>Other arguments passed on to <code><a href="ggplot2.html#topic+layer">layer()</a></code>.</p>
</td></tr>
</table>

<hr>
<h2 id='stMeteo'>Meteorological dataset with hourly values</h2><span id='topic+stMeteo'></span>

<h3>Description</h3>

<p>A dataset containing 8760 hourly values of some meteorological variables
corresponding to a full solar year.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stMeteo
</code></pre>


<h3>Format</h3>

<p>A data frame with 8760 rows and 7 variables:
</p>

<dl>
<dt>date</dt><dd><p>date time in yyyy-mm-hh HH:MM:SS</p>
</dd>
<dt>ws</dt><dd><p>wind speed in m/s</p>
</dd>
<dt>wd</dt><dd><p>wind direction in deg.</p>
</dd>
<dt>temp</dt><dd><p>air temperature in C</p>
</dd>
<dt>radg</dt><dd><p>Global solar radiation in W/m^2</p>
</dd>
<dt>tcc</dt><dd><p>Total cloud cover in integers ranging from 0 to 8</p>
</dd>
<dt>pgt</dt><dd><p>Pasquill-Gifford-Turner stability class</p>
</dd>
</dl>



<h3>Source</h3>

<p>Self derived dataset.
</p>

<hr>
<h2 id='vectorField'>Vector field plot</h2><span id='topic+vectorField'></span>

<h3>Description</h3>

<p>Simple function to plot a <strong>velocities</strong> vector field.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vectorField(data, scale = 1, everyx = 1, everyy = 1, size = 0.25)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vectorField_+3A_data">data</code></td>
<td>
<p>A dataframe containing data to be plotted in the form of:
<em>(x, y, u, v)</em>.</p>
</td></tr>
<tr><td><code id="vectorField_+3A_scale">scale</code></td>
<td>
<p>length factor of vector components</p>
</td></tr>
<tr><td><code id="vectorField_+3A_everyx">everyx</code></td>
<td>
<p>keep one out of every <em>everyx</em> values, along <em>x</em> direction.</p>
</td></tr>
<tr><td><code id="vectorField_+3A_everyy">everyy</code></td>
<td>
<p>keep one out of every <em>everyy</em> values, along <em>y</em> direction.</p>
</td></tr>
<tr><td><code id="vectorField_+3A_size">size</code></td>
<td>
<p>arrow size.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function plots a vector field given a data.frame with coordinates (x, y)
and corresponding velocity components (u, v). Vectors are coloured by
magnitude (speed).
The coordinates are assumed to be on a regular rectangular domain in
UTM reference system.
</p>
<p>This function is heavily inspired by snippets of code in
<em>R Graphics Cookbook</em> by Winston Chang (https://r-graphics.org/index.html).
</p>


<h3>Value</h3>

<p>A <code>ggplot2</code> plot.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
metU &lt;- importADSOBIN('/path/to/meteofile',
                      variable = 'U',
                      slice=2,
                      k = 1000,
                      verbose = TRUE)
metU &lt;- as.data.frame(metU)
metU &lt;- metU %&gt;% 
        mutate(u = z, z = NULL)

metV &lt;- importADSOBIN('/path/to/meteofile',
                      variable = 'V', 
                      slice=2, 
                      k = 1000, 
                      verbose = TRUE)
metV &lt;- as.data.frame(metV)
metV &lt;- metV %&gt;%  
        mutate(v = z, z = NULL)

met &lt;- merge(metU, metV, by = c("x", "y"))

vectorField(met, everyx = 2, everyy = 2, scalex = 10, scaley = 10) +
    coord_fixed(ratio = 1, xlim = c(0, 1000), ylim = c(0, 1000)) +
    scale_color_viridis_c()


## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
