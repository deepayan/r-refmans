<!DOCTYPE html><html><head><title>Help for package AlleleRetain</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {AlleleRetain}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#agerepro.summary'><p> Summary of Average Reproductive Success by Age</p></a></li>
<li><a href='#AlleleRetain'><p> Allele Retention, Inbreeding, and Demography</p></a></li>
<li><a href='#aRetain'><p> Allele Retention, Inbreeding, and Demography</p></a></li>
<li><a href='#aRetain.summary'><p> Summarize Demographics and Allele Retention from <code>aRetain</code></p></a></li>
<li><a href='#indiv.summary'><p> Summary of Individual Information</p></a></li>
<li><a href='#LRS.summary'><p> Summary of Lifetime Reproductive Success</p></a></li>
<li><a href='#pedigree.summary'><p> Pedigree Simulation and Summary</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Allele Retention, Inbreeding, and Demography</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0.2</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>pedigree</td>
</tr>
<tr>
<td>Date:</td>
<td>2018-01-11</td>
</tr>
<tr>
<td>Author:</td>
<td>Emily L. Weiser</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Emily Weiser &lt;emily.l.weiser@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Simulate the effect of management or demography on allele retention and inbreeding accumulation in bottlenecked populations of animals with overlapping generations.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>ZipData:</td>
<td>yes</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://sites.google.com/site/alleleretain/">https://sites.google.com/site/alleleretain/</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-01-11 18:50:13 UTC; Emily</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-01-11 19:29:41 UTC</td>
</tr>
</table>
<hr>
<h2 id='agerepro.summary'> Summary of Average Reproductive Success by Age </h2><span id='topic+agerepro.summary'></span>

<h3>Description</h3>

<p>average reproductive success, by age and sex, in the final year of the simulation
by <code>aRetain</code>.  Must be run after <code>aRetain</code> is run with <code>trackall =
TRUE</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>agerepro.summary(adata, maxage, sex)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="agerepro.summary_+3A_adata">adata</code></td>
<td>
<p> list of output from <code>aRetain</code> </p>
</td></tr>
<tr><td><code id="agerepro.summary_+3A_maxage">maxage</code></td>
<td>
<p> value of MaxAge used in <code>aRetain</code>, or the maximum age of 
interest for the summary, whichever is smaller </p>
</td></tr>
<tr><td><code id="agerepro.summary_+3A_sex">sex</code></td>
<td>
<p> sex to summarize; &quot;male&quot; or &quot;female&quot; </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix with one row for each age and seven columns:
</p>
<table>
<tr><td><code>age</code></td>
<td>
<p> age of each individual, from 0 to MaxAge </p>
</td></tr>
<tr><td><code>alive.mean</code></td>
<td>
<p> mean number of individuals that lived to this age </p>
</td></tr>
<tr><td><code>alive.sd</code></td>
<td>
<p> SD across replicates in the number of individuals that lived 
to this age </p>
</td></tr>
<tr><td><code>matings.mean</code></td>
<td>
<p> mean number of matings per individual at this age </p>
</td></tr>
<tr><td><code>matings.sd</code></td>
<td>
<p> SD among individuals in matings.mean </p>
</td></tr>
<tr><td><code>offspring.mean</code></td>
<td>
<p> mean number of offspring produced by individuals 
of this age </p>
</td></tr>
<tr><td><code>offspring.sd</code></td>
<td>
<p> SD among individuals in offspring.mean </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Emily L. Weiser <a href="mailto:emily.l.weiser@gmail.com">emily.l.weiser@gmail.com</a> </p>


<h3>References</h3>

 
<p>Weiser, E.L., Grueber, C. E., and I. G. Jamieson. 2012. AlleleRetain: A program 
to assess management options for conserving allelic diversity in small, isolated 
populations. Molecular Ecology Resources 12:1161-1167.
</p>

<hr>
<h2 id='AlleleRetain'> Allele Retention, Inbreeding, and Demography </h2><span id='topic+AlleleRetain'></span>

<h3>Description</h3>

<p>Simulates the effect of management or demography on allele retention 
and inbreeding accumulation in bottlenecked populations of animals 
with overlapping generations. 
</p>


<h3>Details</h3>

<p>Typically, the user will run <code>aRetain</code>, then <code>aRetain.summary</code> to assess characteristics of the simulated population.  <code>indiv.summary</code>, <code>pedigree.summary</code> (requires package <b>pedigree</b>),  <code>LRS.summary</code>, and  <code>agerepro.summary</code> will provide further output.
</p>

<hr>
<h2 id='aRetain'> Allele Retention, Inbreeding, and Demography </h2><span id='topic+aRetain'></span>

<h3>Description</h3>

<p>Simulate the effect of management or demography on allele retention 
and inbreeding accumulation in bottlenecked populations of animals 
with overlapping generations. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
aRetain(q0 = 0.05, sourceN = Inf, 
	startN = 20, startAge = "juvenile", startSR = 0.5, exactSSR= FALSE, 
	inisurv = c(1,1,1), addN = 0, addyrs = c(0),  addSR = 0.5, exactASR = FALSE,
	migrN = 0, migrfreq = 1, migrSR = 0.5, exactMSR = FALSE, mpriority = FALSE, 
	removeL = FALSE, harvN = 0, harvAge = "all", harvyrs = 0, K = 100, Klag = 0,
	KAdults = FALSE, reprolag = 0, mature = 1, matingSys = "monogamy", 
	matingLength = "seasonal", meanMLRS = 1, sdMLRS = 0, reproAgeM = c(1:200), 
	AgeOnMLRS = "age/age", nMatings = 1, retainBreeders = "male", MaxAge = 25, 
	SenesAge = 10, adsurvivalF = 0.80, adsurvivalM = 0.80, nonbrsurv = 0.80, 
	nonbrsurvK = 0.80, juvsurv = 0.80,  juvsurvK = 0.80, youngperF = 1.5, 
	SDypF = 0.25, ypF1 = 1, ypF1yr = 1, MAXypF = 2, MAXypFK = 2, 
	ypFsex = "female", youngSR = 0.5, trackall = TRUE, GeneCount = "adult", 
	nyears = 50, nrepl = 100, nreplprint = 10, printplots = FALSE)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aRetain_+3A_q0">q0</code></td>
<td>
<p> frequency of rare allele in the source population (range 0-1) </p>
</td></tr>
<tr><td><code id="aRetain_+3A_sourcen">sourceN</code></td>
<td>
<p> size of source population; must be &gt; startN </p>
</td></tr>
<tr><td><code id="aRetain_+3A_startn">startN</code></td>
<td>
<p> number of starters (or size of bottleneck); not all will 
become genetic founders; minimum 2 </p>
</td></tr>
<tr><td><code id="aRetain_+3A_startage">startAge</code></td>
<td>
<p> age class (&quot;juvenile&quot;, &quot;young adult&quot;, or &quot;adult&quot;) of 
starters, supplemental.  If &quot;juvenile&quot;, all individuals added are assigned
age 0; if &quot;young adult&quot;, all are assigned age at maturity; if &quot;adult&quot;, 
ages are selected randomly based on the proportion of individuals in the 
source population expected to be of each age (based on the survival rates 
and senescence specified below) </p>
</td></tr>
<tr><td><code id="aRetain_+3A_startsr">startSR</code></td>
<td>
<p> sex ratio (proportion male) of starters, supplementals, 
and migrants </p>
</td></tr>
<tr><td><code id="aRetain_+3A_exactssr">exactSSR</code></td>
<td>
<p> logical: whether startSR gives the exact sex ratio 
of individuals released </p>
</td></tr>
<tr><td><code id="aRetain_+3A_inisurv">inisurv</code></td>
<td>
<p> initial survival rate, as a proportion (range 0-1), of 
individuals released.  Given as a vector, where the first value is for 
starters, the second is for additional releases, and third is for migrants.  
Annual mortality applies after this value is used.  Defaults to 1 for all three 
groups. </p>
</td></tr>
<tr><td><code id="aRetain_+3A_addn">addN</code></td>
<td>
<p> list of numbers of individuals to release in years soon after 
population establishment (&quot;supplementals&quot;) </p>
</td></tr>
<tr><td><code id="aRetain_+3A_addyrs">addyrs</code></td>
<td>
<p> list of years in which to release supplementals.  Each year 
corresponds to the number of individuals in the same position in the addN 
list </p>
</td></tr>
<tr><td><code id="aRetain_+3A_addsr">addSR</code></td>
<td>
<p> sex ratio (proportion male) of supplementals; defaults to 0.5 
(must be between 0 and 1).  This can be either a single value, or a vector, 
with each element in the vector corresponding to each instance of 
supplementation (must be the same length as addN)</p>
</td></tr>
<tr><td><code id="aRetain_+3A_exactasr">exactASR</code></td>
<td>
<p> whether addSR gives the exact sex ratio of individuals 
released (TRUE) or sexes are assigned randomly based on the probability given 
by addSR (FALSE); defaults to FALSE.  This can be either a single value, or a 
vector, with each element in the vector corresponding to each instance of 
supplementation (must be the same length as addN)</p>
</td></tr>
<tr><td><code id="aRetain_+3A_migrn">migrN</code></td>
<td>
<p> number of migrants to add </p>
</td></tr>
<tr><td><code id="aRetain_+3A_migrfreq">migrfreq</code></td>
<td>
<p> interval (number of years) at which to add migrN 
migrants; must be between 1 and nyears, below </p>
</td></tr>
<tr><td><code id="aRetain_+3A_migrsr">migrSR</code></td>
<td>
<p> sex ratio (proportion male) of supplementals; defaults to 0.5 
(must be between 0 and 1) </p>
</td></tr>
<tr><td><code id="aRetain_+3A_exactmsr">exactMSR</code></td>
<td>
<p> whether addSR gives the exact sex ratio of individuals 
released (TRUE) or sexes are assigned randomly based on the probability given 
by migrSR (FALSE); defaults to FALSE </p>
</td></tr>
<tr><td><code id="aRetain_+3A_mpriority">mpriority</code></td>
<td>
<p> logical:  whether migrants are given priority over 
locally produced offspring to recruit into any available breeding 
vacancies </p>
</td></tr>
<tr><td><code id="aRetain_+3A_removel">removeL</code></td>
<td>
<p> logical: whether to remove the corresponding number of 
locally produced adults to make room for migrants in the population; only 
necessary if retainBreeders = &quot;both&quot;/&quot;female&quot;/&quot;male&quot;; will only come into 
play when population is at K </p>
</td></tr>
<tr><td><code id="aRetain_+3A_harvn">harvN</code></td>
<td>
<p> number to be removed in each harvest year </p>
</td></tr>
<tr><td><code id="aRetain_+3A_harvage">harvAge</code></td>
<td>
<p> age of individuals to be harvested (as for 'startAge'). If not 
enough individuals of this age are available, the harvest quota (harvN) will 
not be filled </p>
</td></tr>
<tr><td><code id="aRetain_+3A_harvyrs">harvyrs</code></td>
<td>
<p> vector of years in which harvest occurs </p>
</td></tr>
<tr><td><code id="aRetain_+3A_k">K</code></td>
<td>
<p> carrying capacity (population ceiling) </p>
</td></tr>
<tr><td><code id="aRetain_+3A_klag">Klag</code></td>
<td>
<p> number of years for which population is held at or below 
initial size (breeding still occurs); indicates a prolonged bottleneck </p>
</td></tr>
<tr><td><code id="aRetain_+3A_kadults">KAdults</code></td>
<td>
<p> logical: whether K counts only adults, or all 
individuals (subadults, nonbreeders, helpers) </p>
</td></tr>
<tr><td><code id="aRetain_+3A_reprolag">reprolag</code></td>
<td>
<p> number of years after establishment for which no 
reproduction occurs</p>
</td></tr>
<tr><td><code id="aRetain_+3A_mature">mature</code></td>
<td>
<p> average age (in years) at sexual maturity (first breeding) </p>
</td></tr>
<tr><td><code id="aRetain_+3A_matingsys">matingSys</code></td>
<td>
<p> mating system: &quot;monogamy&quot;, &quot;polygyny&quot;, or 
&quot;polygynandry&quot;; to model a polyandrous system, set to &quot;polygyny&quot; and then 
input female values for the &quot;male&quot; parameters (and male values for the 
&quot;female&quot; parameters) </p>
</td></tr>
<tr><td><code id="aRetain_+3A_matinglength">matingLength</code></td>
<td>
<p> &quot;seasonal&quot; or &quot;lifelong&quot;; determines whether 
individuals retain the same mate from year to year or divorce </p>
</td></tr>
<tr><td><code id="aRetain_+3A_meanmlrs">meanMLRS</code></td>
<td>
<p> mean lifetime reproductive success (LRS), in terms of 
number of matings that produce young (NOT number of offspring) a male gets 
over his lifetime; including those that never reproduce.  Each male will 
be assigned an individual average from a gamma distribution with this mean 
and sdMLRS (the shape of the gamma function = (meanMLRS^2)/(sdMLRS^2); 
scale = (sdMLRS^2)/meanMLRS; see help for R function &quot;rgamma&quot; for more 
information).  The gamma distribution was chosen because of its 
flexibility in shape appropriate to polygynous mating systems (from 
strongly right-skewed to nearly symmetrical).  The SD:mean ratio is more 
important than the magnitude of the mean.  This individual mean indicates 
the male's &quot;quality&quot; and will be used to assess his chance of mating, 
relative to other males present, each year (does not translate directly 
into actual LRS experienced by that male).  Not used if matingSys = 
&quot;monogamy&quot; </p>
</td></tr>
<tr><td><code id="aRetain_+3A_sdmlrs">sdMLRS</code></td>
<td>
<p> among-male standard deviation in LRS; used with meanMLRS as 
described above </p>
</td></tr>
<tr><td><code id="aRetain_+3A_reproagem">reproAgeM</code></td>
<td>
<p> list of ages at which males are able to mate 
successfully </p>
</td></tr>
<tr><td><code id="aRetain_+3A_ageonmlrs">AgeOnMLRS</code></td>
<td>
<p> expression describing the proportion of LRS achieved by 
a male at a particular age (for ages contained within reproAgeM), e.g. 
&quot;-5.4 + 1.5*age - 0.08*age^2&quot;; if there is no effect of age, use the 
default value of &quot;age/age&quot; (equals 1 so all ages will be assigned the same 
average, given by meanMLRS) </p>
</td></tr>
<tr><td><code id="aRetain_+3A_nmatings">nMatings</code></td>
<td>
<p> number of matings per female each year; only used when 
matingSys = &quot;polygynandry&quot;; must be a whole number </p>
</td></tr>
<tr><td><code id="aRetain_+3A_retainbreeders">retainBreeders</code></td>
<td>
<p> should established breeders retain their breeding 
status from year to year, and prevent young individuals from recruiting if 
the population is at K?  Specify which sex should be retained: &quot;none&quot;, 
&quot;both&quot;, &quot;male&quot;, or &quot;female&quot;.  Only used when matingSys = &quot;monogamy.&quot;  When 
&quot;none&quot;, all new recruits are added to the breeding population; individuals 
are randomly removed from that pool to truncate the population at K (so 
new recruits may randomly replace established breeders).  When adults will 
likely survive and prevent new individuals from recruiting, e.g. with 
territorial species, set this at one of the other values as appropriate 
for your species.  When pairing off widowed or divorced individuals, those 
of the retained sex(es) that bred previously will be guaranteed a new mate 
(if available); non-retained adults will compete with new recruits to mate 
with available adults.  If the population is at K, new recruits will only 
fill vacancies left by adults that died (they will not replace any 
surviving adults, including females when retainBreeders = &quot;male&quot; and vice 
versa; i.e. &quot;both&quot; functions the same as &quot;male&quot; and &quot;female&quot; in this part 
of the model) </p>
</td></tr>
<tr><td><code id="aRetain_+3A_maxage">MaxAge</code></td>
<td>
<p> maximum allowable lifespan (in years); can be Inf </p>
</td></tr>
<tr><td><code id="aRetain_+3A_senesage">SenesAge</code></td>
<td>
<p> age (in years) after which annual survival will be 
reduced by senescence.  Through this age, adult survival values are set 
according to adsurvivalF and adsurvivalM (below).  After this age, annual 
survival decreases linearly until MaxAge (at which it is 0):  new survival 
=  survival - (survival / (MaxAge - SenesAge)) * (age - SenesAge) </p>
</td></tr>
<tr><td><code id="aRetain_+3A_adsurvivalf">adsurvivalF</code></td>
<td>
<p> annual survival rate of adult females </p>
</td></tr>
<tr><td><code id="aRetain_+3A_adsurvivalm">adsurvivalM</code></td>
<td>
<p> annual survival rate of adult males </p>
</td></tr>
<tr><td><code id="aRetain_+3A_nonbrsurv">nonbrsurv</code></td>
<td>
<p> annual survival rate of nonbreeders (subadults or adults 
that have never reproduced) </p>
</td></tr>
<tr><td><code id="aRetain_+3A_nonbrsurvk">nonbrsurvK</code></td>
<td>
<p> annual survival rate of nonbreeders when population is 
at K (used instead of nonbrsurv).  If given, subadult survival probability 
in each year depends on density of the population at the beginning of that 
year, according to the Beverton-Holt function for density dependence in 
survival (as in Morris &amp; Doak 2002, Quantitative Conservation Biology):  
S(E(t)) = S(0)/(1 + beta * E(t)), where S(E(t)) is survival rate at 
population density E in year t, S(0) is survival when density is near 0, 
beta is the decline in survival as density increases, and E(t) is 
population density at time t.  &quot;Density&quot; is defined in our model as the 
proportion of K that has been filled, as there is no spatial information 
in the model.  The model solves for beta according to the user-specified 
values for nonbrsurv (S(0)) and nonbrsurvK (S at carrying capacity, where 
E = 1), then uses beta and S(0) to calculate density-dependent survival 
probability in each year </p>
</td></tr>
<tr><td><code id="aRetain_+3A_juvsurv">juvsurv</code></td>
<td>
<p> first year survival (from the stage described by 
youngperF, below, to the beginning of the next breeding season) when 
population is below K </p>
</td></tr>
<tr><td><code id="aRetain_+3A_juvsurvk">juvsurvK</code></td>
<td>
<p> first year survival when population is at K (used instead 
of juvsurv); juvenile survival is density-dependent as for nonbrsurvK </p>
</td></tr>
<tr><td><code id="aRetain_+3A_youngperf">youngperF</code></td>
<td>
<p> average number of offspring produced per mating each 
year (averaged over all pairs in population).  For a polyandrous female, 
this is the average number of offspring produced each time she mates with 
a male (each year): youngperF * nMatings = total average offspring per 
year.  youngperF can be calculated for any reproductive stage (eggs, 
chicks, independent juveniles) as long as juvsurv indicates the proportion 
of individuals that survive from this stage to the beginning of the 
following breeding season </p>
</td></tr>
<tr><td><code id="aRetain_+3A_sdypf">SDypF</code></td>
<td>
<p> among-individual standard deviation of youngperF, e.g. 0.50 
or 2.</p>
</td></tr>
<tr><td><code id="aRetain_+3A_ypf1">ypF1</code></td>
<td>
<p> where younger breeders have reduced reproductive rates, this 
can be used to define the reproductive success for first reproductive 
stage (length of that stage is determined by ypF1yr, below); given as a 
proportion of youngperF.   </p>
</td></tr>
<tr><td><code id="aRetain_+3A_ypf1yr">ypF1yr</code></td>
<td>
<p> age after which ypF1 changes to youngperF (e.g. 1 if ypF1 
applies to one-year-olds only, or 5 if it applies for the first 5 years 
and then increases to youngperF from age 6 onward) </p>
</td></tr>
<tr><td><code id="aRetain_+3A_maxypf">MAXypF</code></td>
<td>
<p> maximum annual number of offspring per individual (e.g. 
based on biological constraints such as clutch size/renesting) </p>
</td></tr>
<tr><td><code id="aRetain_+3A_maxypfk">MAXypFK</code></td>
<td>
<p> maximum annual number of offspring per individual when 
population is at K, if different from MAXypF </p>
</td></tr>
<tr><td><code id="aRetain_+3A_ypfsex">ypFsex</code></td>
<td>
<p> which member of a pair limits the reproductive output for 
the year, based on the biology of the species of interest; can be &quot;male&quot;, 
&quot;female&quot;, or &quot;both&quot; (the last will average the male's and female's values) </p>
</td></tr>
<tr><td><code id="aRetain_+3A_youngsr">youngSR</code></td>
<td>
<p> proportion of offspring that are male </p>
</td></tr>
<tr><td><code id="aRetain_+3A_trackall">trackall</code></td>
<td>
<p> logical: whether to track all individuals from the 
population through the whole simulation; must be TRUE to use indiv.summary 
or pedigree.summary after running the simulation </p>
</td></tr>
<tr><td><code id="aRetain_+3A_genecount">GeneCount</code></td>
<td>
<p> which alleles to count as retained:  those in the &quot;adult&quot; 
population only, or those in &quot;all&quot; individuals (including subadults and other 
nonbreeders)</p>
</td></tr>
<tr><td><code id="aRetain_+3A_nyears">nyears</code></td>
<td>
<p> number of years to run the simulation </p>
</td></tr>
<tr><td><code id="aRetain_+3A_nrepl">nrepl</code></td>
<td>
<p> number of iterations (replicates) to run </p>
</td></tr>
<tr><td><code id="aRetain_+3A_nreplprint">nreplprint</code></td>
<td>
<p> interval (number of replicates) at which to print a 
message with the current system time.  Allows the user to gauge model 
progress and to estimate time to completion </p>
</td></tr>
<tr><td><code id="aRetain_+3A_printplots">printplots</code></td>
<td>
<p> logical: whether to plot the population growth (number of 
individuals, as defined by KAdults, present each year) and allele frequency (in 
the pool defined by GeneCount) as they change over time (TRUE or FALSE).  One 
line will be plotted for each replicate immediately after it runs.  Can be used 
to immediately gauge the demographics of the population (e.g. if it will grow 
as expected); will slow down the simulation by ~ 10-20 percent.  Defaults to 
FALSE. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The user indicates the number of individuals released to establish the 
population (bottleneck size), along with their age class (adult or 
juvenile), sex ratio, and post-release survival rate. These individuals can 
be released all at once or gradually over a period of years. Released 
individuals are assumed to be unrelated and are randomly assigned genotypes 
(zero, one, or two copies of a hypothetical neutral allele) according to a 
user-specified frequency of the allele in the source population. The 
simulated population can be held at the initial size to simulate a 
prolonged bottleneck (while reproduction occurs) or the user can specify a 
post-release lag with no reproduction. Otherwise, released individuals 
mature and recruit according to user-specified parameters. Species with 
delayed sexual maturity are modeled by preventing subadults from breeding 
until a user-specified age. Adults are randomly sorted into monogamous or 
polygynous breeding pairs, which re-form for multiple matings within one 
season (in polygynandry systems), remain together seasonally (in monogamous 
or polygynous systems), or remain together lifelong (in monogamous systems) 
depending on user-specified settings. Reproduction occurs each year based 
on individual or population means (depending on settings for individual 
variation in reproductive output) for the number of offspring produced per 
pair per year, which can change with age of the parents. Sex is randomly 
assigned to each offspring according to the user-specified sex ratio for 
juveniles and offspring inherit alleles from their parents via Mendelian 
inheritance. When the simulated population reaches the specified carrying 
capacity, population growth ceases by either preventing recruitment of 
offspring or removing randomly selected individuals (as indicated by the 
user).  When individuals are removed at random, the user can choose to give 
priority to remain in the population to established breeders and/or 
immigrants (if any). Annual survival of individuals is determined by 
user-specified probabilities for each age class, with optional sex-specific 
survival rates for adults. The user can choose to incorporate density 
dependence into juvenile and subadult/nonbreeder survival probabilities 
and/or to specify senescence effects in survival of adults beyond a certain 
age.
</p>
<p>The model simulates immigration at regular user-specified intervals by 
adding more individuals from the original source population. Immigrants can 
be prioritized over locally produced individuals to recruit into breeding 
vacancies. This scenario may be realistic when most locally produced 
juveniles would emigrate, or when locally produced juveniles would be 
removed by managers (e.g. to contribute to other populations or to make 
room for immigrants). Emigration can be simulated in this model by reducing 
the survival value for the appropriate age class, assuming emigrants and 
their descendants do not return to the modeled population. 
</p>
<p>Frequency of the allele of interest in the simulated population is recorded 
after each year of the simulation. The proportion of iterations in which 
the allele is retained to the end of the specified time period is 
interpreted as the probability of retaining the allele in the population 
over that period. The model outputs a census of the simulated 
population (adults, subadults/nonbreeders, pairs, founders, and immigrants) 
each year, and a list of information for each individual in the simulated 
population.  The census information can be averaged across replicates with 
<code>aRetain.summary</code>.  An individual summary function (<code>indiv.summary</code>)
can output pertinent information (e.g. proportion bred, average number that 
bred per generation) about individuals of each origin (founder, local, or 
immigrant) in the population.  A pedigree summary function 
(<code>pedigree.summary</code>) can be used to describe accumulation of inbreeding 
in the population by calling R package <b>pedigree</b>.  
</p>
<p>See the AlleleRetain Model Guide (available as a PDF file with this 
installation, or from the model's website at 
https://sites.google.com/site/alleleretain/) for more details and an example.
</p>


<h3>Value</h3>

<p><code>aRetain</code> returns a list of sub-lists, with one sub-list for each replicate 
which contains two matrices: one that summarizes the population information for 
that replicate (one row for each year; columns = number of adults, number of 
breeding females, number of breeding males, number of copies of the rare allele, 
number of pairs, number of nonbreeders, number of founders remaining, number of 
migrants alive, mean age of breeding pairs), and one that gives pertinent 
information for all individuals in that replicate (one row for each individual; 
columns = ID, dam, sire, origin [1=starter, 2=supplemental, 3=local, 
4=immigrant], birth year, number of years alive in the population, number of 
years bred, year added to population).   The latter matrix includes all 
individuals if <code>trackall = TRUE</code>, or only those alive at the end of the 
simulation if <code>trackall = FALSE</code>.  Run <code>aRetain.summary</code>, 
<code>indiv.summary</code>, and <code>pedigree.summary</code> to generate useful output from 
this information (averaged across replicates).
</p>


<h3>Author(s)</h3>

<p> Emily L. Weiser <a href="mailto:emily.l.weiser@gmail.com">emily.l.weiser@gmail.com</a> </p>


<h3>References</h3>

 
<p>Weiser, E.L., Grueber, C. E., and I. G. Jamieson. 2012. AlleleRetain: A program 
to assess management options for conserving allelic diversity in small, isolated 
populations. Molecular Ecology Resources 12:1161-1167.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Simulate rare allele with frequency 0.05 in source population.
## 20 individuals are translocated to establish a new population with carrying 
## capacity = 100 individuals.  An additional 5 individuals are translocated 
## once every 10 years as immigrants. Demographic parameter values are for a 
## monogamous passerine bird species with a 5-yr average lifespan.  Only 30 
## iterations are run so the confidence intervals will be wide.

## Not run: 

aR.temp &lt;- aRetain(q0 = 0.05, sourceN = 2000, startN = 20, startAge = 
"adult", startSR = 0.5, exactSSR = FALSE, inisurv = 0.90, addN = 0, addyrs 
= c(0),  migrN = 5, migrfreq = 10, mpriority = FALSE, removeL = FALSE, K = 
100, KAdults = FALSE, mature = 1, matingSys = "monogamy", matingLength = 
"seasonal", retainBreeders = "male", MaxAge = 16, SenesAge = 5, adsurvivalF = 
0.77, adsurvivalM = 0.77, nonbrsurv = 0.70, nonbrsurvK = 0.40, juvsurv = 0.60,  
juvsurvK = 0.30, youngperF = 2.85, SDypF = 1.25, MAXypF = 6, MAXypFK = 6, 
ypFsex = "female", youngSR = 0.5, trackall = TRUE, GeneCount = "all", nyears = 
10, nrepl = 20, nreplprint = 10)

aRetain.summary(aR.temp,  GeneCount = "all", alpha=0.05, dropextinct = TRUE)


## End(Not run)

</code></pre>

<hr>
<h2 id='aRetain.summary'> Summarize Demographics and Allele Retention from <code>aRetain</code> </h2><span id='topic+aRetain.summary'></span>

<h3>Description</h3>

<p>Summarize pertinent information about the population simulated by <code>aRetain</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
aRetain.summary(adata, GeneCount, alpha=0.05, dropextinct = FALSE)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aRetain.summary_+3A_adata">adata</code></td>
<td>
<p> list of output from <code>aRetain</code> </p>
</td></tr>
<tr><td><code id="aRetain.summary_+3A_genecount">GeneCount</code></td>
<td>
<p> &quot;adult&quot; or &quot;all&quot; as specified for <code>aRetain</code> </p>
</td></tr>
<tr><td><code id="aRetain.summary_+3A_alpha">alpha</code></td>
<td>
<p> confidence level e.g. 0.05 for 95% intervals</p>
</td></tr>
<tr><td><code id="aRetain.summary_+3A_dropextinct">dropextinct</code></td>
<td>
<p> logical: should simulated populations that decline to zero 
be omitted from the summary? </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix in which the rows correspond to simulation years (0,...,nyears) and
the columns are summary variables:
</p>
<table>
<tr><td><code>MeanN</code></td>
<td>
<p> mean number of adults </p>
</td></tr>
<tr><td><code>SEN</code></td>
<td>
<p> SE for # adults </p>
</td></tr>
<tr><td><code>MeanNNonbr</code></td>
<td>
<p> mean # of nonbreeders </p>
</td></tr>
<tr><td><code>MeanBrF</code></td>
<td>
<p> mean # of breeding females </p>
</td></tr>
<tr><td><code>SEBrF</code></td>
<td>
<p> SE for # of breeding females </p>
</td></tr>
<tr><td><code>MeanBrM</code></td>
<td>
<p> mean # of breeding males </p>
</td></tr>
<tr><td><code>SEBrM</code></td>
<td>
<p> SE for # of breeding males </p>
</td></tr>
<tr><td><code>MeanNFound</code></td>
<td>
<p> mean # of founders (starters and supplemental 
individuals) remaining </p>
</td></tr>
<tr><td><code>MeanNMigr</code></td>
<td>
<p> mean # of immigrants present </p>
</td></tr>
<tr><td><code>MeanAge</code></td>
<td>
<p> mean age of breeding adults (those that are actually 
paired that year) </p>
</td></tr>
<tr><td><code>P.extant</code></td>
<td>
<p> probability that the population is extant (proportion of 
simulations in which the population does not become extinct) </p>
</td></tr>
<tr><td><code>P.xLCL</code></td>
<td>
<p> lower bound of the confidence interval for P.extant </p>
</td></tr>
<tr><td><code>P.xUCL</code></td>
<td>
<p> upper bound of the confidence interval for P.extant </p>
</td></tr>
<tr><td><code>P.retain</code></td>
<td>
<p> probability that the rare allele is present in the 
population </p>
</td></tr>
<tr><td><code>P.LCL</code></td>
<td>
<p> lower bound of the confidence interval for P.retain </p>
</td></tr>
<tr><td><code>P.UCL</code></td>
<td>
<p> upper bound of the confidence interval for P.retain </p>
</td></tr>
<tr><td><code>A.Freq</code></td>
<td>
<p> frequency of the rare allele in the simulated population (in adults or in all individuals, as per GeneCount argument in aRetain) </p>
</td></tr>
<tr><td><code>A.SE</code></td>
<td>
<p> standard error for A.Freq </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Emily L. Weiser <a href="mailto:emily.l.weiser@gmail.com">emily.l.weiser@gmail.com</a>  </p>


<h3>References</h3>

 
<p>Weiser, E.L., Grueber, C. E., and I. G. Jamieson. 2012. AlleleRetain: A program 
to assess management options for conserving allelic diversity in small, isolated 
populations. Molecular Ecology Resources 12:1161-1167.
</p>

<hr>
<h2 id='indiv.summary'> Summary of Individual Information </h2><span id='topic+indiv.summary'></span>

<h3>Description</h3>

<p>Summarize information for individuals of each origin (starters, supplementals,
locals, immigrants) simulated by <code>aRetain</code>.  Must be run after 
<code>aRetain</code> is run with <code>trackall = TRUE</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>indiv.summary(adata, genlength, alpha=0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="indiv.summary_+3A_adata">adata</code></td>
<td>
<p> list of output from <code>aRetain</code> </p>
</td></tr>
<tr><td><code id="indiv.summary_+3A_genlength">genlength</code></td>
<td>
<p> mean age of simulated individuals (breeding pairs only), as 
returned by <code>census.summary</code> (use the MeanAge value where it stabilizes 
after recovering from any founder age effects) </p>
</td></tr>
<tr><td><code id="indiv.summary_+3A_alpha">alpha</code></td>
<td>
<p> confidence level e.g. 0.05 for 95% intervals</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix with 4 rows, one for each origin (starter, supplemental, local, 
immigrant) and the columns are summary variables:
</p>
<table>
<tr><td><code>n</code></td>
<td>
<p> total number of individuals from each origin, summed within each replicate and then averaged across replicates </p>
</td></tr>
<tr><td><code>pbreed</code></td>
<td>
<p> probability of each individual breeding (proportion that bred) </p>
</td></tr>
<tr><td><code>pbreed.LCL</code></td>
<td>
<p> lower confidence limit for pbreed </p>
</td></tr>
<tr><td><code>pbreed.UCL</code></td>
<td>
<p> upper confidence limit for pbreed </p>
</td></tr>
<tr><td><code>YrsBred</code></td>
<td>
<p> mean # years bred per individual (including those that never 
bred) </p>
</td></tr>
<tr><td><code>YrsBredBr</code></td>
<td>
<p> mean # of years bred per individual (that bred at least once) </p>
</td></tr>
<tr><td><code>lifespan</code></td>
<td>
<p> mean lifespan in the population </p>
</td></tr>
<tr><td><code>effectivegen</code></td>
<td>
<p> mean # of individuals that bred each generation </p>
</td></tr>
<tr><td><code>NMatings</code></td>
<td>
<p> mean # of total lifetime matings, across individuals </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Emily L. Weiser <a href="mailto:emily.l.weiser@gmail.com">emily.l.weiser@gmail.com</a> </p>


<h3>References</h3>

 
<p>Weiser, E.L., Grueber, C. E., and I. G. Jamieson. 2012. AlleleRetain: A program 
to assess management options for conserving allelic diversity in small, isolated 
populations. Molecular Ecology Resources 12:1161-1167.
</p>

<hr>
<h2 id='LRS.summary'> Summary of Lifetime Reproductive Success </h2><span id='topic+LRS.summary'></span>

<h3>Description</h3>

<p>List of number of matings for each individual of the specified sex, over whole
lifetime and all years, as simulated by <code>aRetain</code>.  Must be run after 
<code>aRetain</code> is run with <code>trackall = TRUE</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LRS.summary(adata, sex)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LRS.summary_+3A_adata">adata</code></td>
<td>
<p> list of output from <code>aRetain</code> </p>
</td></tr>
<tr><td><code id="LRS.summary_+3A_sex">sex</code></td>
<td>
<p> sex to summarize; &quot;male&quot; or &quot;female&quot; </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix with one row for each individual and two columns:
</p>
<table>
<tr><td><code>ID</code></td>
<td>
<p> ID number of the individual. ID numbers are unique within each replicate, but will be repeated across replicates </p>
</td></tr>
<tr><td><code>NMatings</code></td>
<td>
<p> number of times the individual mated during its lifetime. The 
individual-level data is not expected to be useful, but can be used to calculate 
the mean or a histogram of mating success </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Emily L. Weiser <a href="mailto:emily.l.weiser@gmail.com">emily.l.weiser@gmail.com</a> </p>


<h3>References</h3>

 
<p>Weiser, E.L., Grueber, C. E., and I. G. Jamieson. 2012. AlleleRetain: A program 
to assess management options for conserving allelic diversity in small, isolated 
populations. Molecular Ecology Resources 12:1161-1167.
</p>

<hr>
<h2 id='pedigree.summary'> Pedigree Simulation and Summary </h2><span id='topic+pedigree.summary'></span>

<h3>Description</h3>

<p>Summarizes inbreeding accumulation in the population simulated by 
<code>aRetain</code>. Must be run after <code>aRetain</code> is run with 
<code>trackall = TRUE</code>.  
Requires package <b>pedigree</b>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
pedigree.summary(adata)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pedigree.summary_+3A_adata">adata</code></td>
<td>
<p> list of output from <code>aRetain</code> </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix in which the rows correspond to simulation years (0,...,nyears) and
the columns are summary variables:
</p>
<table>
<tr><td><code>year</code></td>
<td>
<p> year of simulation </p>
</td></tr>
<tr><td><code>meanF</code></td>
<td>
<p> mean F, averaged across individuals and then across replicates </p>
</td></tr>
<tr><td><code>varF</code></td>
<td>
<p> inter-replicate variance in F </p>
</td></tr>
<tr><td><code>indivVarF</code></td>
<td>
<p> inter-individual variance of F, averaged across replicates </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Emily L. Weiser <a href="mailto:emily.l.weiser@gmail.com">emily.l.weiser@gmail.com</a>  </p>


<h3>References</h3>

 
<p>Weiser, E.L., Grueber, C. E., and I. G. Jamieson. 2012. AlleleRetain: A program 
to assess management options for conserving allelic diversity in small, isolated 
populations. Molecular Ecology Resources 12:1161-1167.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
