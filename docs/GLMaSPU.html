<!DOCTYPE html><html><head><title>Help for package GLMaSPU</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {GLMaSPU}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#aSPU_apval'><p>Asymptotic based Sum of Powered Score (SPU) tests and adaptive SPU (aSPU) test.</p></a></li>
<li><a href='#aSPU_perm'><p>Resample based Sum of Powered Score (SPU) tests and adaptive SPU (aSPU) test.</p></a></li>
<li><a href='#generate_data'><p>Generate data for generalized linear models in simulation.</p></a></li>
<li><a href='#GLMaSPU-package'>
<p>An Adaptive Test on High Dimensional Parameters in Generalized Linear Models</p></a></li>
<li><a href='#Goeman_perm'><p>Resample based Goeman test.</p></a></li>
<li><a href='#HDGLM_perm'><p>Resample based HDGLM test.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>An Adaptive Test on High Dimensional Parameters in Generalized
Linear Models</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2016-10-10</td>
</tr>
<tr>
<td>Author:</td>
<td>Chong Wu and Wei Pan</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Chong Wu &lt;wuxx0845@umn.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Several tests for high dimensional generalized linear models have been proposed recently. In this package, we implemented a new test called adaptive  sum of powered score (aSPU) for high dimensional generalized linear models, which is often more powerful than the existing methods in a wide scenarios. We also implemented permutation based version of several existing methods for research purpose. We recommend users use the aSPU test for their real testing problem. You can learn more about the tests implemented in the package via the following papers: 1. Pan, W., Kim, J., Zhang, Y., Shen, X. and Wei, P. (2014) &lt;<a href="https://doi.org/10.1534%2Fgenetics.114.165035">doi:10.1534/genetics.114.165035</a>&gt; A powerful and adaptive association test for rare variants, Genetics, 197(4). 2. Guo, B., and Chen, S. X. (2016) &lt;<a href="https://doi.org/10.1111%2Frssb.12152">doi:10.1111/rssb.12152</a>&gt;. Tests for high dimensional generalized linear models. Journal of the Royal Statistical Society: Series B. 3. Goeman, J. J., Van Houwelingen, H. C., and Finos, L. (2011) &lt;<a href="https://doi.org/10.1093%2Fbiomet%2Fasr016">doi:10.1093/biomet/asr016</a>&gt;. Testing against a high-dimensional alternative in the generalized linear model: asymptotic type I error control. Biometrika, 98(2).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS, mnormt, Rcpp (&ge; 0.12.6)</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1.1), mvtnorm (&ge; 1.0-0)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>5.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2016-12-08 21:41:49 UTC; chong</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2016-12-09 08:58:42</td>
</tr>
</table>
<hr>
<h2 id='aSPU_apval'>Asymptotic based Sum of Powered Score (SPU) tests and adaptive SPU (aSPU) test.</h2><span id='topic+aSPU_apval'></span>

<h3>Description</h3>

<p>It gives p-values of the SPU tests and aSPU test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aSPU_apval(Y, X, cov = NULL, pow = c(1:6, Inf), resample = "boot",
  model = "gaussian", n.perm = 5000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aSPU_apval_+3A_y">Y</code></td>
<td>
<p>Response. It can be binary or continuous trait. A vector with length n (number of observations).</p>
</td></tr>
<tr><td><code id="aSPU_apval_+3A_x">X</code></td>
<td>
<p>Genotype or other data; each row for a subject, and each column for a variable of interest. An n by p matrix (n: number of observations, p: number of predictors).</p>
</td></tr>
<tr><td><code id="aSPU_apval_+3A_cov">cov</code></td>
<td>
<p>Covariates. An n by q matrix (n: number of observations, q: number of covariates).</p>
</td></tr>
<tr><td><code id="aSPU_apval_+3A_pow">pow</code></td>
<td>
<p>Gamma set used in SPU test. A vector of the powers.</p>
</td></tr>
<tr><td><code id="aSPU_apval_+3A_resample">resample</code></td>
<td>
<p>Resample methods. &quot;perm&quot; for residual permutations; &quot;boot&quot; for parametric bootstrap.</p>
</td></tr>
<tr><td><code id="aSPU_apval_+3A_model">model</code></td>
<td>
<p>corresponding to the Response. &quot;gaussian&quot; for a quantitative response; &quot;binomial&quot; for a binary response.</p>
</td></tr>
<tr><td><code id="aSPU_apval_+3A_n.perm">n.perm</code></td>
<td>
<p>number of permutations or bootstraps.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list object, Ts : test statistics for the SPU tests and the aSPU test.
pvs : p-values for the SPU and aSPU tests.
</p>


<h3>Author(s)</h3>

<p>Chong Wu and Wei Pan
</p>


<h3>References</h3>

<p>Chong Wu, Gongjun Xu and Wei Pan, &quot;An Adaptive test on high dimensional parameters in generalized linear models&quot; (Submitted)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
p = 200
n = 100
beta = c(1,3,3)
s = 0.15
non.zero = floor(p * s)
signal.r = 0.08
seed = 2
alpha = c(rep(signal.r,non.zero),rep(0,p-non.zero))
dat = generate_data(seed, n = n, p = p, beta = beta,alpha = alpha)
cov = dat$Z
X = dat$X
Y = dat$Y
aSPU_apval(Y, X, cov = cov, pow = c(1:6, Inf),resample = "perm", model = "gaussian",  n.perm = 1000)
# The p-values are similar to the resample based one

</code></pre>

<hr>
<h2 id='aSPU_perm'>Resample based Sum of Powered Score (SPU) tests and adaptive SPU (aSPU) test.</h2><span id='topic+aSPU_perm'></span>

<h3>Description</h3>

<p><code>aSPU_perm</code> returns p-values of the SPU tests and aSPU test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aSPU_perm(Y, X, cov = NULL, resample = c("perm", "boot"),
  model = c("gaussian", "binomial"), pow = c(1:6, Inf), n.perm = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aSPU_perm_+3A_y">Y</code></td>
<td>
<p>Response. It can be binary or continuous trait. A vector with length n (number of observations).</p>
</td></tr>
<tr><td><code id="aSPU_perm_+3A_x">X</code></td>
<td>
<p>Genotype or other data; each row for a subject, and each column for a variable of interest. An n by p matrix (n: number of observations, p: number of predictors).</p>
</td></tr>
<tr><td><code id="aSPU_perm_+3A_cov">cov</code></td>
<td>
<p>Covariates. An n by q matrix (n: number of observations, q: number of covariates).</p>
</td></tr>
<tr><td><code id="aSPU_perm_+3A_resample">resample</code></td>
<td>
<p>Resample methods. &quot;perm&quot; for residual permutations; &quot;boot&quot; for parametric bootstrap.</p>
</td></tr>
<tr><td><code id="aSPU_perm_+3A_model">model</code></td>
<td>
<p>corresponding to the Response. &quot;gaussian&quot; for a quantitative response; &quot;binomial&quot; for a binary response.</p>
</td></tr>
<tr><td><code id="aSPU_perm_+3A_pow">pow</code></td>
<td>
<p>Gamma set used in SPU test. A vector of the powers.</p>
</td></tr>
<tr><td><code id="aSPU_perm_+3A_n.perm">n.perm</code></td>
<td>
<p>number of permutations or bootstraps.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list object, Ts : test statistics for the SPU tests and the aSPU test.
pvs : p-values for the SPU and aSPU tests.
</p>


<h3>Author(s)</h3>

<p>Chong Wu and Wei Pan
</p>


<h3>References</h3>

<p>Wei Pan, Junghi Kim, Yiwei Zhang, Xiaotong Shen and Peng Wei (2014)
A powerful and adaptive association test for rare variants,
Genetics, 197(4), 1081-95
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
p = 200
n = 100
beta = c(1,3,3)
s = 0.15
signal.r = 0.08
non.zero = floor(p * s)
seed = 2
alpha = c(rep(signal.r,non.zero),rep(0,p-non.zero))
dat = generate_data(seed, n = n, p = p, beta = beta,alpha = alpha)
cov = dat$Z
X = dat$X
Y = dat$Y
aSPU_perm(Y, X, cov = cov, pow = c(1:6, Inf),resample = "perm", model = "gaussian",  n.perm = 1000)
# The p-values are similar to the asymptotic based one

</code></pre>

<hr>
<h2 id='generate_data'>Generate data for generalized linear models in simulation.</h2><span id='topic+generate_data'></span>

<h3>Description</h3>

<p><code>generate_data</code> returns simulated data, including response Y, covariates Z, and variable of interest X.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generate_data(seed, n, p, beta, alpha)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="generate_data_+3A_seed">seed</code></td>
<td>
<p>Random seed.</p>
</td></tr>
<tr><td><code id="generate_data_+3A_n">n</code></td>
<td>
<p>Number of samples</p>
</td></tr>
<tr><td><code id="generate_data_+3A_p">p</code></td>
<td>
<p>Dimension of variable of interest</p>
</td></tr>
<tr><td><code id="generate_data_+3A_beta">beta</code></td>
<td>
<p>Coefficients for covariates Z</p>
</td></tr>
<tr><td><code id="generate_data_+3A_alpha">alpha</code></td>
<td>
<p>Coefficients for variable of interest X</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list object
</p>


<h3>Author(s)</h3>

<p>Chong Wu and Wei Pan
</p>


<h3>References</h3>

<p>Chong Wu, Gongjun Xu and Wei Pan, &quot;An Adaptive test on high dimensional parameters in generalized linear models&quot; (Submitted)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
p = 200
n = 100
beta = c(1,3,3)
s = 0.15
signal.r = 0.08
non.zero = floor(p * s)
seed = 2
alpha = c(rep(signal.r,non.zero),rep(0,p-non.zero))
dat = generate_data(seed, n = n, p = p, beta = beta,alpha = alpha)
#X, Y, cov
#dat$X; dat$Y; dat$cov

</code></pre>

<hr>
<h2 id='GLMaSPU-package'>
An Adaptive Test on High Dimensional Parameters in Generalized Linear Models
</h2><span id='topic+GLMaSPU-package'></span><span id='topic+GLMaSPU'></span>

<h3>Description</h3>

<p>Provide various tests on high-dimensional parameters in generalized linear models.
</p>


<h3>Details</h3>

<p>Several tests for high dimensional generalized linear models have been proposed recently. In this package, we implemented a new test called aSPU for high dimensional generalized linear models, which is often more powerful than the existing methods in a wide scenarios. We also implemented permutation based version of several existing methods for research purpose. We recommend users use the aSPU test for their real testing problem.
</p>


<h3>Author(s)</h3>

<p>Chong Wu, Wei Pan
Maintainer: Chong Wu &lt;wuxx0845@umn.edu&gt;
</p>


<h3>References</h3>

<p>Chong Wu, Gongjun Xu and Wei Pan, &quot;An Adaptive test on high dimensional parameters in generalized linear models&quot; (Submitted)
</p>

<hr>
<h2 id='Goeman_perm'>Resample based Goeman test.</h2><span id='topic+Goeman_perm'></span>

<h3>Description</h3>

<p><code>Goeman_perm</code> returns resample based p-value for a test proposed by Goeman (2011).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Goeman_perm(Y, X, cov = NULL, model = c("gaussian", "binomial"),
  n.perm = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Goeman_perm_+3A_y">Y</code></td>
<td>
<p>Response. It can be binary or continuous trait. A vector with length n (number of observations).</p>
</td></tr>
<tr><td><code id="Goeman_perm_+3A_x">X</code></td>
<td>
<p>Genotype or other data; each row for a subject, and each column for a variable of interest. An n by p matrix (n: number of observations, p: number of predictors).</p>
</td></tr>
<tr><td><code id="Goeman_perm_+3A_cov">cov</code></td>
<td>
<p>Covariates. An n by q matrix (n: number of observations, q: number of covariates).</p>
</td></tr>
<tr><td><code id="Goeman_perm_+3A_model">model</code></td>
<td>
<p>corresponding to the Response. &quot;gaussian&quot; for a quantitative response; &quot;binomial&quot; for a binary response.</p>
</td></tr>
<tr><td><code id="Goeman_perm_+3A_n.perm">n.perm</code></td>
<td>
<p>number of permutations or bootstraps.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>Goeman_perm</code> calculates the resample based p-value. You can calculate the asymptotic based p-value via using R package globaltest. Based on our experience, resample based p-value is often different from the asymptotic based one, except when the dimension of X is larger than the sample size n.
</p>


<h3>Value</h3>

<p>A list object, Ts : test statistics for the SPU tests and the aSPU test.
pvs : p-values for the SPU and aSPU tests.
</p>


<h3>Author(s)</h3>

<p>Chong Wu and Wei Pan
</p>


<h3>References</h3>

<p>Goeman, J. J., Van Houwelingen, H. C. and Finos, L. (2011). Testing against a high-dimensional
alternative in the generalized linear model asymptotic type 1 error control. Biometrika, 98(2), 381-390.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
p = 200
n = 100
beta = c(1,3,3)
s = 0.15
signal.r = 0.08
non.zero = floor(p * s)
seed = 2
alpha = c(rep(signal.r,non.zero),rep(0,p-non.zero))
dat = generate_data(seed, n = n, p = p, beta = beta,alpha = alpha)
cov = dat$Z
X = dat$X
Y = dat$Y
Goeman_perm(Y, X, cov = cov,model="gaussian", n.perm=1000)

</code></pre>

<hr>
<h2 id='HDGLM_perm'>Resample based HDGLM test.</h2><span id='topic+HDGLM_perm'></span>

<h3>Description</h3>

<p><code>HDGLM_perm</code> returns resample based p-value for HDGLM test (Guo 2016).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>HDGLM_perm(Y, X, cov = NULL, model = c("gaussian", "binomial"),
  n.perm = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="HDGLM_perm_+3A_y">Y</code></td>
<td>
<p>Response. It can be binary or continuous trait. A vector with length n (number of observations).</p>
</td></tr>
<tr><td><code id="HDGLM_perm_+3A_x">X</code></td>
<td>
<p>Genotype or other data; each row for a subject, and each column for a variable of interest. An n by p matrix (n: number of observations, p: number of predictors).</p>
</td></tr>
<tr><td><code id="HDGLM_perm_+3A_cov">cov</code></td>
<td>
<p>Covariates. An n by q matrix (n: number of observations, q: number of covariates).</p>
</td></tr>
<tr><td><code id="HDGLM_perm_+3A_model">model</code></td>
<td>
<p>corresponding to the Response. &quot;gaussian&quot; for a quantitative response; &quot;binomial&quot; for a binary response.</p>
</td></tr>
<tr><td><code id="HDGLM_perm_+3A_n.perm">n.perm</code></td>
<td>
<p>number of permutations or bootstraps.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>HDGLM_perm</code> calculates the resample based p-value. You can calculate the asymptotic based p-value by using HDGLM_test function in R package HDGLM. Based on our experience, resample based p-value is often similar to the asymptotic based one, except when the signals are highly sparse.
</p>


<h3>Value</h3>

<p>A list object, Ts : test statistics for the SPU tests and the aSPU test.
pvs : p-values for the SPU and aSPU tests.
</p>


<h3>Author(s)</h3>

<p>Chong Wu and Wei Pan
</p>


<h3>References</h3>

<p>Guo, B. and S. X. Chen (2016). Tests for high dimensional generalized linear models. Journal of the Royal Statistical Society: Series B (Statistical Methodology).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
p = 200
n = 100
beta = c(1,3,3)
s = 0.15
signal.r = 0.08
seed = 2
non.zero = floor(p * s)
alpha = c(rep(signal.r,non.zero),rep(0,p-non.zero))
dat = generate_data(seed, n = n, p = p, beta = beta,alpha = alpha)
cov = dat$Z
X = dat$X
Y = dat$Y
HDGLM_perm(Y, X, cov = cov, model = "gaussian",  n.perm = 1000)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
