<!DOCTYPE html><html><head><title>Help for package detectseparation</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {detectseparation}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#check_infinite_estimates'><p>Generic method for checking for infinite estimates</p></a></li>
<li><a href='#check_infinite_estimates.glm'><p>A simple diagnostic of whether the maximum likelihood estimates are</p>
infinite</a></li>
<li><a href='#detect_infinite_estimates'><p>Detect Infinite Estimates</p></a></li>
<li><a href='#detect_separation'><p>Detect Separation</p></a></li>
<li><a href='#detect_separation_control'><p>Auxiliary function for the <code>glm</code> interface when</p>
<code>method</code> is <code>detect_separation</code>.</a></li>
<li><a href='#detectseparation'><p>detectseparation: Methods for Detecting and Checking for Separation</p>
and Infinite Maximum Likelihood Estimates</a></li>
<li><a href='#endometrial'><p>Histology grade and risk factors for 79 cases of endometrial cancer</p></a></li>
<li><a href='#lizards'><p>Habitat preferences of lizards</p></a></li>
<li><a href='#silvapulle1981'><p>Separation Example Presented in Silvapulle (1981)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Detect and Check for Separation and Infinite Maximum Likelihood
Estimates</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides pre-fit and post-fit methods for detecting separation and infinite maximum likelihood estimates in generalized linear models with categorical responses. The pre-fit methods apply on binomial-response generalized liner models such as logit, probit and cloglog regression, and can be directly supplied as fitting methods to the glm() function. They solve the linear programming problems for the detection of separation developed in Konis (2007, <a href="https://ora.ox.ac.uk/objects/uuid:8f9ee0d0-d78e-4101-9ab4-f9cbceed2a2a">https://ora.ox.ac.uk/objects/uuid:8f9ee0d0-d78e-4101-9ab4-f9cbceed2a2a</a>) using 'ROI' <a href="https://cran.r-project.org/package=ROI">https://cran.r-project.org/package=ROI</a> or 'lpSolveAPI' <a href="https://cran.r-project.org/package=lpSolveAPI">https://cran.r-project.org/package=lpSolveAPI</a>. The post-fit methods apply to models with categorical responses, including binomial-response generalized linear models and multinomial-response models, such as baseline category logits and adjacent category logits models; for example, the models implemented in the 'brglm2' <a href="https://cran.r-project.org/package=brglm2">https://cran.r-project.org/package=brglm2</a> package. The post-fit methods successively refit the model with increasing number of iteratively reweighted least squares iterations, and monitor the ratio of the estimated standard error for each parameter to what it has been in the first iteration. According to the results in Lesaffre &amp; Albert (1989, <a href="https://www.jstor.org/stable/2345845">https://www.jstor.org/stable/2345845</a>), divergence of those ratios indicates data separation.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/ikosmidis/detectseparation">https://github.com/ikosmidis/detectseparation</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/ikosmidis/detectseparation/issues">https://github.com/ikosmidis/detectseparation/issues</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>ROI, ROI.plugin.lpsolve, lpSolveAPI, pkgload</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.3.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, covr, brglm2, AER, tinytest,
ROI.plugin.ecos, ROI.plugin.glpk, ROI.plugin.alabama,
ROI.plugin.neos</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-08-26 13:50:31 UTC; yiannis</td>
</tr>
<tr>
<td>Author:</td>
<td>Ioannis Kosmidis <a href="https://orcid.org/0000-0003-1556-0302"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Dirk Schumacher [aut],
  Florian Schwendinger [aut],
  Kjell Konis [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ioannis Kosmidis &lt;ioannis.kosmidis@warwick.ac.uk&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-08-26 21:04:33 UTC</td>
</tr>
</table>
<hr>
<h2 id='check_infinite_estimates'>Generic method for checking for infinite estimates</h2><span id='topic+check_infinite_estimates'></span><span id='topic+checkInfiniteEstimates'></span>

<h3>Description</h3>

<p>Generic method for checking for infinite estimates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_infinite_estimates(object, ...)

checkInfiniteEstimates(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_infinite_estimates_+3A_object">object</code></td>
<td>
<p>a fitted model object (e.g. the result of a
<code><a href="stats.html#topic+glm">glm</a></code> call).</p>
</td></tr>
<tr><td><code id="check_infinite_estimates_+3A_...">...</code></td>
<td>
<p>other options to be passed to the method.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>check_infinite_estimates.glm
</p>

<hr>
<h2 id='check_infinite_estimates.glm'>A simple diagnostic of whether the maximum likelihood estimates are
infinite</h2><span id='topic+check_infinite_estimates.glm'></span>

<h3>Description</h3>

<p>A simple diagnostic of whether the maximum likelihood estimates are
infinite
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'glm'
check_infinite_estimates(object, nsteps = 20, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_infinite_estimates.glm_+3A_object">object</code></td>
<td>
<p>the result of a <code><a href="stats.html#topic+glm">glm</a></code> call.</p>
</td></tr>
<tr><td><code id="check_infinite_estimates.glm_+3A_nsteps">nsteps</code></td>
<td>
<p>starting from <code>maxit = 1</code>, the GLM is refitted
for <code>maxit = 2</code>, <code>maxit = 3</code>, ..., <code>maxit =
nsteps</code>. Default value is 30.</p>
</td></tr>
<tr><td><code id="check_infinite_estimates.glm_+3A_...">...</code></td>
<td>
<p>currently not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>check_infinite_estimates</code>() attempts to identify the occurrence
of infinite estimates in GLMs with binomial responses by
successively refitting the model. At each iteration the maximum
number of allowed IWLS iterations is fixed starting from 1 to
<code>nsteps</code> (by setting <code>control = glm.control(maxit = j)</code>,
where <code>j</code> takes values 1, ..., nsteps in
<code><a href="stats.html#topic+glm">glm</a></code>). For each value of <code>maxit</code>, the estimated
asymptotic standard errors are divided to the corresponding ones
from <code>control = glm.control(maxit = 1)</code>. Then, based on the
results in Lesaffre &amp; Albert (1989), if the sequence of ratios in
any column of the resultant matrix diverges, then complete or
quasi-complete separation occurs and the maximum likelihood
estimate for the corresponding parameter has value minus or plus
infinity.
</p>
<p><code>check_infinite_estimates</code>() can also be used to identify the
occurrence of infinite estimates in baseline category logit models
for nominal responses (see <code><a href="brglm2.html#topic+brmultinom">brmultinom</a>()</code> from
the <span class="pkg">brglm2</span> R package), and adjacent category logit models for
ordinal responses (see <code><a href="brglm2.html#topic+bracl">bracl</a>()</code> from the
<span class="pkg">brglm2</span> R package).
</p>


<h3>Value</h3>

<p>An object of class <code>inf_check</code> that has a <code>plot</code> method.
</p>
<p>A matrix inheriting from class <code>inf_check</code>, with <code>nsteps</code>
rows and <code>p</code> columns, where <code>p</code> is the number of model
parameters. A <code>plot</code> method is provided for <code>inf_check</code>
objects for the easy inspection of the ratios of the standard
errors.
</p>


<h3>Note</h3>

<p>For the definition of complete and quasi-complete separation, see
Albert and Anderson (1984). Kosmidis and Firth (2021) prove that
the reduced-bias estimator that results by the penalization of the
logistic regression log-likelihood by Jeffreys prior takes always
finite values, even when some of the maximum likelihood estimates
are infinite. The reduced-bias estimates can be computed using the
<span class="pkg">brglm2</span> R package.
</p>


<h3>References</h3>

<p>Lesaffre, E., &amp; Albert, A. (1989). Partial Separation in Logistic
Discrimination. *Journal of the Royal Statistical Society. Series B
(Methodological)*, **51**, 109-116
</p>
<p>Kosmidis I. and Firth D. (2021). Jeffreys-prior penalty, finiteness
and shrinkage in binomial-response generalized linear
models. *Biometrika*, **108**, 71–82
</p>


<h3>See Also</h3>

<p><code><a href="nnet.html#topic+multinom">multinom</a></code>,
<code><a href="#topic+detect_separation">detect_separation</a></code>,
<code><a href="brglm2.html#topic+brmultinom">brmultinom</a></code>,
<code><a href="brglm2.html#topic+bracl">bracl</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# endometrial data from Heinze \&amp; Schemper (2002) (see ?endometrial)
data("endometrial", package = "detectseparation")
endometrial_ml &lt;- glm(HG ~ NV + PI + EH, data = endometrial,
                      family = binomial("probit"))
# clearly the maximum likelihood estimate for the coefficient of
# NV is infinite
(estimates &lt;- check_infinite_estimates(endometrial_ml))
plot(estimates)



# Aligator data (Agresti, 2002, Table~7.1)
if (requireNamespace("brglm2", quietly = TRUE)) {
    data("alligators", package = "brglm2")
    all_ml &lt;- brglm2::brmultinom(foodchoice ~ size + lake , weights = round(freq/3),
                         data = alligators, type = "ML", ref = 1)
    # Clearly some estimated standard errors diverge as the number of
    # Fisher scoring iterations increases
    plot(check_infinite_estimates(all_ml))
    # Bias reduction the brglm2 R packages can be used to get finite estimates
    all_br &lt;- brglm2::brmultinom(foodchoice ~ size + lake , weights = round(freq/3),
                         data = alligators, ref = 1)
    plot(check_infinite_estimates(all_br))
}

</code></pre>

<hr>
<h2 id='detect_infinite_estimates'>Detect Infinite Estimates</h2><span id='topic+detect_infinite_estimates'></span><span id='topic+detectInfiniteEstimates'></span>

<h3>Description</h3>

<p>Method for <code><a href="stats.html#topic+glm">glm</a></code> that detects infinite components in
the maximum likelihood estimates of generalized linear models
with binomial responses.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>detect_infinite_estimates(
  x,
  y,
  weights = NULL,
  start = NULL,
  etastart = NULL,
  mustart = NULL,
  offset = NULL,
  family = gaussian(),
  control = list(),
  intercept = TRUE,
  singular.ok = TRUE
)

detectInfiniteEstimates(
  x,
  y,
  weights = NULL,
  start = NULL,
  etastart = NULL,
  mustart = NULL,
  offset = NULL,
  family = gaussian(),
  control = list(),
  intercept = TRUE,
  singular.ok = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="detect_infinite_estimates_+3A_x">x</code></td>
<td>
<p><code>x</code> is a design matrix of dimension <code>n * p</code>.</p>
</td></tr>
<tr><td><code id="detect_infinite_estimates_+3A_y">y</code></td>
<td>
<p><code>y</code> is a vector of observations of length <code>n</code>.</p>
</td></tr>
<tr><td><code id="detect_infinite_estimates_+3A_weights">weights</code></td>
<td>
<p>an optional vector of &lsquo;prior weights&rsquo; to be used
in the fitting process.  Should be <code>NULL</code> or a numeric vector.</p>
</td></tr>
<tr><td><code id="detect_infinite_estimates_+3A_start">start</code></td>
<td>
<p>currently not used.</p>
</td></tr>
<tr><td><code id="detect_infinite_estimates_+3A_etastart">etastart</code></td>
<td>
<p>currently not used.</p>
</td></tr>
<tr><td><code id="detect_infinite_estimates_+3A_mustart">mustart</code></td>
<td>
<p>currently not used.</p>
</td></tr>
<tr><td><code id="detect_infinite_estimates_+3A_offset">offset</code></td>
<td>
<p>this can be used to specify an <em>a priori</em> known
component to be included in the linear predictor during fitting.
This should be <code>NULL</code> or a numeric vector of length equal to
the number of cases.  One or more <code><a href="stats.html#topic+offset">offset</a></code> terms can be
included in the formula instead or as well, and if more than one is
specified their sum is used.  See <code><a href="stats.html#topic+model.offset">model.offset</a></code>.</p>
</td></tr>
<tr><td><code id="detect_infinite_estimates_+3A_family">family</code></td>
<td>
<p>a description of the error distribution and link
function to be used in the model.  For <code>glm</code> this can be a
character string naming a family function, a family function or the
result of a call to a family function.  For <code>glm.fit</code> only the
third option is supported.  (See <code><a href="stats.html#topic+family">family</a></code> for details of
family functions.)</p>
</td></tr>
<tr><td><code id="detect_infinite_estimates_+3A_control">control</code></td>
<td>
<p>a list of parameters controlling separation
detection. See <code><a href="#topic+detect_separation_control">detect_separation_control</a></code> for
details.</p>
</td></tr>
<tr><td><code id="detect_infinite_estimates_+3A_intercept">intercept</code></td>
<td>
<p>logical. Should an intercept be included in the
<em>null</em> model?</p>
</td></tr>
<tr><td><code id="detect_infinite_estimates_+3A_singular.ok">singular.ok</code></td>
<td>
<p>logical. If <code>FALSE</code>, a singular model is an
error.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For binomial-response generalized linear models with <code>"log"</code>
link, separated data allocations do not necessarily lead to
infinite maximum likelihood estimates. For this reason, for models
with the <code>"log"</code> link
<code><a href="#topic+detect_infinite_estimates">detect_infinite_estimates</a>()</code> relies on an alternative
linear optimization model developed in Schwendinger et al. (2021),
and for all the other supported links it relies on the linear
programming methods developed in Konis (2007). See
<code><a href="#topic+detect_separation">detect_separation</a>()</code> for definitions and details.
</p>
<p><code><a href="#topic+detect_infinite_estimates">detect_infinite_estimates</a>()</code> is a wrapper to the
functions <code>separator_ROI()</code>, <code>separator_lpSolveAPI()</code> (a
modified version of the <code>separator()</code> function from the
**safeBinaryRegression** R package), and <code>dielb_ROI()</code>.
</p>
<p>The <code><a href="stats.html#topic+coefficients">coefficients</a>()</code> method extracts a vector of values
for each of the model parameters under the following convention:
<code>0</code> if the maximum likelihood estimate of the parameter is
finite, and <code>Inf</code> or <code>-Inf</code> if the maximum likelihood
estimate of the parameter if plus or minus infinity. This
convention makes it easy to adjust the maximum likelihood estimates
to their actual values by element-wise addition.
</p>
<p><code><a href="#topic+detect_infinite_estimates">detect_infinite_estimates</a>()</code> can be passed directly as
a method to the <code><a href="stats.html#topic+glm">glm</a></code> function. See, examples.
</p>
<p><code>detectInfiniteEstimates</code>() is an alias for
<code>detect_infinite_estimates</code>().
</p>


<h3>Author(s)</h3>

<p>Ioannis Kosmidis [aut, cre] <a href="mailto:ioannis.kosmidis@warwick.ac.uk">ioannis.kosmidis@warwick.ac.uk</a>, Florian Schwendinger [aut] <a href="mailto:FlorianSchwendinger@gmx.at">FlorianSchwendinger@gmx.at</a>, Dirk Schumacher [aut] <a href="mailto:mail@dirk-schumacher.net">mail@dirk-schumacher.net</a>, Kjell Konis [ctb] <a href="mailto:kjell.konis@me.com">kjell.konis@me.com</a>
</p>


<h3>References</h3>

<p>Silvapulle, M. J. (1981).
On the Existence of Maximum Likelihood Estimators for the Binomial Response Models.
Journal of the Royal Statistical Society. Series B (Methodological), 43(3), 310–313.
<a href="https://www.jstor.org/stable/2984941">https://www.jstor.org/stable/2984941</a>
</p>
<p>Konis K. (2007). *Linear Programming Algorithms for Detecting
Separated Data in Binary Logistic Regression
Models*. DPhil. University of Oxford.
<a href="https://ora.ox.ac.uk/objects/uuid:8f9ee0d0-d78e-4101-9ab4-f9cbceed2a2a">https://ora.ox.ac.uk/objects/uuid:8f9ee0d0-d78e-4101-9ab4-f9cbceed2a2a</a>
</p>
<p>Konis K. (2013). safeBinaryRegression: Safe Binary Regression. R
package version 0.1-3.
<a href="https://CRAN.R-project.org/package=safeBinaryRegression">https://CRAN.R-project.org/package=safeBinaryRegression</a>
</p>
<p>Kosmidis I. and Firth D. (2021). Jeffreys-prior penalty, finiteness
and shrinkage in binomial-response generalized linear
models. *Biometrika*, **108**, 71–82. <a href="https://doi.org/10.1093/biomet/asaa052">doi:10.1093/biomet/asaa052</a>
</p>
<p>Schwendinger, F., Grün, B. &amp; Hornik, K. (2021). A comparison of
optimization solvers for log binomial regression including conic
programming.  *Computational Statistics*, **36**,
1721–1754. <a href="https://doi.org/10.1007/s00180-021-01084-5">doi:10.1007/s00180-021-01084-5</a>
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+glm.fit">glm.fit</a></code> and <code><a href="stats.html#topic+glm">glm</a></code>, <code><a href="#topic+detect_separation">detect_separation</a></code>, <code><a href="#topic+check_infinite_estimates">check_infinite_estimates</a></code>, <code><a href="brglm2.html#topic+brglm_fit">brglm_fit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># The classical example given in Silvapulle (1981) can be utilized
# to show that for the Log-Binomial model there exist data allocations
# which are separated but produce finite estimates.
data("silvapulle1981", package = "detectseparation")

# Since the data is separated the MLE does not exist for the logit link.
glm(y ~ ghqs, data = silvapulle1981, family = binomial(),
    method = "detect_infinite_estimates")

# However, for the log link all components of the MLE are finite.
glm(y ~ ghqs, data = silvapulle1981, family = binomial("log"),
    method = "detect_infinite_estimates")
glm(y ~ ghqs, data = silvapulle1981, family = binomial("log"), start = c(-1, 0))

</code></pre>

<hr>
<h2 id='detect_separation'>Detect Separation</h2><span id='topic+detect_separation'></span><span id='topic+detectSeparation'></span><span id='topic+print.detect_separation'></span>

<h3>Description</h3>

<p>Method for <code><a href="stats.html#topic+glm">glm</a></code> that tests for data separation and
finds which parameters have infinite maximum likelihood estimates
in generalized linear models with binomial responses
</p>
<p><code><a href="#topic+detect_separation">detect_separation</a>()</code> is a method for <code><a href="stats.html#topic+glm">glm</a></code>
that tests for the occurrence of complete or quasi-complete
separation in datasets for binomial response generalized linear
models, and finds which of the parameters will have infinite
maximum likelihood estimates. <code><a href="#topic+detect_separation">detect_separation</a>()</code>
relies on the linear programming methods developed in Konis (2007).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>detect_separation(
  x,
  y,
  weights = NULL,
  start = NULL,
  etastart = NULL,
  mustart = NULL,
  offset = NULL,
  family = gaussian(),
  control = list(),
  intercept = TRUE,
  singular.ok = TRUE
)

detectSeparation(
  x,
  y,
  weights = NULL,
  start = NULL,
  etastart = NULL,
  mustart = NULL,
  offset = NULL,
  family = gaussian(),
  control = list(),
  intercept = TRUE,
  singular.ok = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="detect_separation_+3A_x">x</code></td>
<td>
<p><code>x</code> is a design matrix of dimension <code>n * p</code>.</p>
</td></tr>
<tr><td><code id="detect_separation_+3A_y">y</code></td>
<td>
<p><code>y</code> is a vector of observations of length <code>n</code>.</p>
</td></tr>
<tr><td><code id="detect_separation_+3A_weights">weights</code></td>
<td>
<p>an optional vector of &lsquo;prior weights&rsquo; to be used
in the fitting process.  Should be <code>NULL</code> or a numeric vector.</p>
</td></tr>
<tr><td><code id="detect_separation_+3A_start">start</code></td>
<td>
<p>currently not used.</p>
</td></tr>
<tr><td><code id="detect_separation_+3A_etastart">etastart</code></td>
<td>
<p>currently not used.</p>
</td></tr>
<tr><td><code id="detect_separation_+3A_mustart">mustart</code></td>
<td>
<p>currently not used.</p>
</td></tr>
<tr><td><code id="detect_separation_+3A_offset">offset</code></td>
<td>
<p>this can be used to specify an <em>a priori</em> known
component to be included in the linear predictor during fitting.
This should be <code>NULL</code> or a numeric vector of length equal to
the number of cases.  One or more <code><a href="stats.html#topic+offset">offset</a></code> terms can be
included in the formula instead or as well, and if more than one is
specified their sum is used.  See <code><a href="stats.html#topic+model.offset">model.offset</a></code>.</p>
</td></tr>
<tr><td><code id="detect_separation_+3A_family">family</code></td>
<td>
<p>a description of the error distribution and link
function to be used in the model.  For <code>glm</code> this can be a
character string naming a family function, a family function or the
result of a call to a family function.  For <code>glm.fit</code> only the
third option is supported.  (See <code><a href="stats.html#topic+family">family</a></code> for details of
family functions.)</p>
</td></tr>
<tr><td><code id="detect_separation_+3A_control">control</code></td>
<td>
<p>a list of parameters controlling separation
detection. See <code><a href="#topic+detect_separation_control">detect_separation_control</a>()</code> for
details.</p>
</td></tr>
<tr><td><code id="detect_separation_+3A_intercept">intercept</code></td>
<td>
<p>logical. Should an intercept be included in the
<em>null</em> model?</p>
</td></tr>
<tr><td><code id="detect_separation_+3A_singular.ok">singular.ok</code></td>
<td>
<p>logical. If <code>FALSE</code>, a singular model is an
error.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Following the definitions in Albert and Anderson (1984), the data
for a binomial-response generalized linear model with logistic link
exhibit quasi-complete separation if there exists a non-zero
parameter vector <code class="reqn">\beta</code> such that <code class="reqn">X^0 \beta \le 0</code> and
<code class="reqn">X^1 \beta \ge 0</code>, where <code class="reqn">X^0</code> and <code class="reqn">X^1</code> are the
matrices formed by the rows of the model matrix $X$ corresponding
to zero and non-zero responses, respectively. The data exhibits
complete separation if there exists a parameter vector <code class="reqn">\beta</code> such
that the aforementioned conditions are satisfied with strict
inequalities. If there are no vectors <code class="reqn">\beta</code> that can satisfy the
conditions, then the data points are said to overlap.
</p>
<p>If the inverse link function <code class="reqn">G(t)</code> of a generalized linear
model with binomial responses is such that <code class="reqn">\log G(t)</code> and
<code class="reqn">\log (1 - G(t))</code> are concave and the model has an intercept
parameter, then overlap is a necessary and sufficient condition for
the maximum likelihood estimates to be finite (see Silvapulle, 1981
for a proof). Such link functions are, for example, the logit,
probit and complementary log-log.
</p>
<p><code><a href="#topic+detect_separation">detect_separation</a>()</code> determines whether or not the
data exhibits (quasi-)complete separation. Then, if separation is
detected and the link function <code class="reqn">G(t)</code> is such that <code class="reqn">\log
G(t)</code> and <code class="reqn">\log (1 - G(t))</code> are concave, the maximum likelihood
estimates has infinite components.
</p>
<p><code><a href="#topic+detect_separation">detect_separation</a>()</code> is a wrapper to the
<code><a href="#topic+detect_infinite_estimates">detect_infinite_estimates</a>()</code> method. Separation
detection, as separation is defined above, takes place using the
linear programming methods in Konis (2007) regardless of the link
function. The output of those methods is also used to determine
which estimates are infinite, unless the link is &quot;log&quot;. In the
latter case the linear programming methods in Schwendinger et
al. (2021) are called to establish if and which estimates are
infinite. If the link function is not one of '&quot;logit&quot;', '&quot;log&quot;',
'&quot;probit&quot;', '&quot;cauchit&quot;', '&quot;cloglog&quot;' then a warning is issued.
</p>
<p>The <code><a href="stats.html#topic+coefficients">coefficients</a></code> method extracts a vector of values
for each of the model parameters under the following convention:
<code>0</code> if the maximum likelihood estimate of the parameter is
finite, and <code>Inf</code> or <code>-Inf</code> if the maximum likelihood
estimate of the parameter if plus or minus infinity. This
convention makes it easy to adjust the maximum likelihood estimates
to their actual values by element-wise addition.
</p>
<p><code><a href="#topic+detect_separation">detect_separation</a>()</code> can be passed directly as
a method to the <code><a href="stats.html#topic+glm">glm</a></code> function. See, examples.
</p>
<p><code>detectSeparation</code>() is an alias for <code>detect_separation</code>().
</p>


<h3>Value</h3>

<p>A list that inherits from class <code>detect_separation</code>,
<code>glm</code> and <code>lm</code>. A <code>print</code> method is provided for
<code>detect_separation</code> objects.
</p>


<h3>Note</h3>

<p>For the definition of complete and quasi-complete separation, see
Albert and Anderson (1984). Kosmidis and Firth (2021) prove that
the reduced-bias estimator that results by the penalization of the
logistic regression log-likelihood by Jeffreys prior takes always
finite values, even when some of the maximum likelihood estimates
are infinite. The reduced-bias estimates can be computed using the
<span class="pkg">brglm2</span> R package.
</p>
<p><code><a href="#topic+detect_separation">detect_separation</a></code> was designed in 2017 by Ioannis
Kosmidis for the **brglm2** R package, after correspondence with
Kjell Konis, and a port of the <code>separator</code> function had been
included in **brglm2** under the permission of Kjell Konis. In
2020, <code><a href="#topic+detect_separation">detect_separation</a></code> and
<code><a href="#topic+check_infinite_estimates">check_infinite_estimates</a></code> were moved outside
**brglm2** into the dedicated **detectseparation** package. Dirk
Schumacher authored the <code>separator_ROI</code> function, which
depends on the **ROI** R package and is now the default
implementation used for detecting separation. In 2022, Florian
Schwendinger authored the <code>dielb_ROI</code> function for detecting
infinite estimates in log-binomial regression, and, with Ioannis
Kosmidis, they refactored the codebase to properly accommodate for
the support of log-binomial regression.
</p>


<h3>Author(s)</h3>

<p>Ioannis Kosmidis [aut, cre] <a href="mailto:ioannis.kosmidis@warwick.ac.uk">ioannis.kosmidis@warwick.ac.uk</a>, Dirk Schumacher [aut] <a href="mailto:mail@dirk-schumacher.net">mail@dirk-schumacher.net</a>, Florian Schwendinger [aut] <a href="mailto:FlorianSchwendinger@gmx.at">FlorianSchwendinger@gmx.at</a>, Kjell Konis [ctb] <a href="mailto:kjell.konis@me.com">kjell.konis@me.com</a>
</p>


<h3>References</h3>

<p>Konis K. (2007). *Linear Programming Algorithms for Detecting
Separated Data in Binary Logistic Regression
Models*. DPhil. University of Oxford.
<a href="https://ora.ox.ac.uk/objects/uuid:8f9ee0d0-d78e-4101-9ab4-f9cbceed2a2a">https://ora.ox.ac.uk/objects/uuid:8f9ee0d0-d78e-4101-9ab4-f9cbceed2a2a</a>
</p>
<p>Konis K. (2013). safeBinaryRegression: Safe Binary Regression. R
package version 0.1-3.
<a href="https://CRAN.R-project.org/package=safeBinaryRegression">https://CRAN.R-project.org/package=safeBinaryRegression</a>
</p>
<p>Kosmidis I. and Firth D. (2021). Jeffreys-prior penalty, finiteness
and shrinkage in binomial-response generalized linear
models. *Biometrika*, **108**, 71–82. <a href="https://doi.org/10.1093/biomet/asaa052">doi:10.1093/biomet/asaa052</a>
</p>
<p>Silvapulle, M. J. (1981).  On the Existence of Maximum Likelihood
Estimators for the Binomial Response Models.  *Journal of the Royal
Statistical Society. Series B (Methodological)*, **43**, 310–313.
<a href="https://www.jstor.org/stable/2984941">https://www.jstor.org/stable/2984941</a>
</p>
<p>Schwendinger, F., Grün, B. &amp; Hornik, K. (2021). A comparison of
optimization solvers for log binomial regression including conic
programming.  *Computational Statistics*, **36**,
1721–1754. <a href="https://doi.org/10.1007/s00180-021-01084-5">doi:10.1007/s00180-021-01084-5</a>
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+glm.fit">glm.fit</a></code> and <code><a href="stats.html#topic+glm">glm</a></code>, <code><a href="#topic+detect_infinite_estimates">detect_infinite_estimates</a></code>, <code><a href="#topic+check_infinite_estimates">check_infinite_estimates</a></code>, <code><a href="brglm2.html#topic+brglm_fit">brglm_fit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# endometrial data from Heinze \&amp; Schemper (2002) (see ?endometrial)
data("endometrial", package = "detectseparation")
endometrial_sep &lt;- glm(HG ~ NV + PI + EH, data = endometrial,
                       family = binomial("logit"),
                       method = "detect_separation")
endometrial_sep
# The maximum likelihood estimate for NV is infinite
summary(update(endometrial_sep, method = "glm.fit"))


# Example inspired by unpublished microeconometrics lecture notes by
# Achim Zeileis https://eeecon.uibk.ac.at/~zeileis/
# The maximum likelihood estimate of sourhernyes is infinite
if (requireNamespace("AER", quietly = TRUE)) {
    data("MurderRates", package = "AER")
    murder_sep &lt;- glm(I(executions &gt; 0) ~ time + income +
                      noncauc + lfp + southern, data = MurderRates,
                      family = binomial(), method = "detect_separation")
    murder_sep
    # which is also evident by the large estimated standard error for NV
    murder_glm &lt;- update(murder_sep, method = "glm.fit")
    summary(murder_glm)
    # and is also revealed by the divergence of the NV column of the
    # result from the more computationally intensive check
    plot(check_infinite_estimates(murder_glm))
    # Mean bias reduction via adjusted scores results in finite estimates
    if (requireNamespace("brglm2", quietly = TRUE))
        update(murder_glm, method = brglm2::brglm_fit)
}

</code></pre>

<hr>
<h2 id='detect_separation_control'>Auxiliary function for the <code><a href="stats.html#topic+glm">glm</a></code> interface when
<code>method</code> is <code><a href="#topic+detect_separation">detect_separation</a></code>.</h2><span id='topic+detect_separation_control'></span><span id='topic+detectSeparationControl'></span>

<h3>Description</h3>

<p>Typically only used internally by <code><a href="#topic+detect_separation">detect_separation</a></code>
but may be used to construct a <code>control</code> argument.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>detect_separation_control(
  implementation = c("ROI", "lpSolveAPI"),
  solver = "lpsolve",
  linear_program = c("primal", "dual"),
  purpose = c("find", "test"),
  tolerance = 1e-04,
  solver_control = list()
)

detectSeparationControl(
  implementation = c("ROI", "lpSolveAPI"),
  solver = "lpsolve",
  linear_program = c("primal", "dual"),
  purpose = c("find", "test"),
  tolerance = 1e-04,
  solver_control = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="detect_separation_control_+3A_implementation">implementation</code></td>
<td>
<p>should the implementation using <code>ROI</code> or
the implementation using <code>lpSolveAPI</code> be used? Default is
<code>ROI</code>.</p>
</td></tr>
<tr><td><code id="detect_separation_control_+3A_solver">solver</code></td>
<td>
<p>should the linear program be solved using the
<code>"lpsolve"</code> (using the <span class="pkg">ROI.plugin.lpsolve</span> package;
default) or another solver? Alternative solvers are
<code>"glpk"</code>, <code>"cbc"</code>, <code>"clp"</code>, <code>"cplex"</code>,
<code>"ecos"</code>, <code>"gurobi"</code>, <code>"scs"</code>,
<code>"symphony"</code>. If <span class="pkg">ROI.plugin.[solver]</span> is not
installed then the user will be prompted to install it before
continuing.</p>
</td></tr>
<tr><td><code id="detect_separation_control_+3A_linear_program">linear_program</code></td>
<td>
<p>should <code><a href="#topic+detect_separation">detect_separation</a></code> solve
the <code>"primal"</code> (default) or <code>"dual"</code> linear program
for separation detection? Only relevant if <code>implementation
= "lpSolveAPI"</code>.</p>
</td></tr>
<tr><td><code id="detect_separation_control_+3A_purpose">purpose</code></td>
<td>
<p>should <code><a href="#topic+detect_separation">detect_separation</a></code> simply
<code>"test"</code> for separation or also <code>"find"</code> (default)
which parameters are infinite? Only relevant if
<code>implementation = "lpSolveAPI"</code>.</p>
</td></tr>
<tr><td><code id="detect_separation_control_+3A_tolerance">tolerance</code></td>
<td>
<p>maximum absolute variable value from the linear
program, before separation is declared. Default is
<code>1e-04</code>.</p>
</td></tr>
<tr><td><code id="detect_separation_control_+3A_solver_control">solver_control</code></td>
<td>
<p>a list with additional control parameters for
the <code>"solver"</code>. This is solver specific, so consult the
corresponding documentation. Default is <code>list()</code> unless
<code>solver</code> is <code>"alabama"</code> when the default is <code>list(start
= rep(0, p))</code>, where p is the number of parameters.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the supplied <code>linear_program</code>, <code>solver</code>,
<code>solver_control</code>, <code>purpose</code>, <code>tolerance</code>,
<code>implementation</code>, and the matched <code>separator</code> function
(according to the value of <code>implementation</code>).
</p>

<hr>
<h2 id='detectseparation'>detectseparation: Methods for Detecting and Checking for Separation
and Infinite Maximum Likelihood Estimates</h2><span id='topic+detectseparation'></span>

<h3>Description</h3>

<p><span class="pkg">detectseparation</span> provides pre-fit and post-fit methods for
the detection of separation and of infinite maximum likelihood
estimates in binomial response generalized linear models.
</p>


<h3>Details</h3>

<p>The key methods are <code><a href="#topic+detect_separation">detect_separation</a></code> and
<code><a href="#topic+check_infinite_estimates">check_infinite_estimates</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+detect_separation">detect_separation</a></code>, <code><a href="#topic+check_infinite_estimates">check_infinite_estimates</a></code>
</p>

<hr>
<h2 id='endometrial'>Histology grade and risk factors for 79 cases of endometrial cancer</h2><span id='topic+endometrial'></span>

<h3>Description</h3>

<p>Histology grade and risk factors for 79 cases of endometrial cancer
</p>


<h3>Usage</h3>

<pre><code class='language-R'>endometrial
</code></pre>


<h3>Format</h3>

<p>A data frame with 79 rows and 4 variables:
</p>

<dl>
<dt>NV</dt><dd><p>neovasculization with coding 0 for absent and 1 for present</p>
</dd>
<dt>PI</dt><dd><p>pulsality index of arteria uterina</p>
</dd>
<dt>EH</dt><dd><p>endometrium height</p>
</dd>
<dt>HG</dt><dd><p>histology grade with coding 0 for low grade and 1 for high grade</p>
</dd>
</dl>



<h3>Source</h3>

<p>The packaged data set was downloaded in <code>.dat</code> format
from <a href="https://users.stat.ufl.edu/~aa/glm/data/">https://users.stat.ufl.edu/~aa/glm/data/</a>. The latter
link provides the data sets used in Agresti (2015).
</p>
<p>The endometrial data set was first analyzed in Heinze and
Schemper (2002), and was originally provided by Dr
E. Asseryanis from the Medical University of Vienna.
</p>


<h3>References</h3>

<p>Agresti, A. (2015). *Foundations of Linear and Generalized Linear
Models*.  Wiley Series in Probability and Statistics. Wiley
</p>
<p>Heinze, G., &amp; Schemper, M. (2002). A Solution to the Problem of
Separation in Logistic Regression. *Statistics in Medicine*, **21**, 2409–2419
</p>


<h3>See Also</h3>

<p><code><a href="brglm2.html#topic+brglm_fit">brglm_fit</a></code>
</p>

<hr>
<h2 id='lizards'>Habitat preferences of lizards</h2><span id='topic+lizards'></span>

<h3>Description</h3>

<p>The lizards data frame has 23 rows and 6 columns. Variables
<code>grahami</code> and <code>opalinus</code> are counts of two lizard species
at two different perch heights, two different perch diameters, in
sun and in shade, at three times of day.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lizards
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 23 rows and 6 columns.
</p>


<h3>Details</h3>


<ul>
<li><p> grahami. count of grahami lizards
</p>
</li>
<li><p> opalinus. count of opalinus lizards
</p>
</li>
<li><p> height. a factor with levels <code>&lt;5ft</code>, <code>&gt;=5ft</code>
</p>
</li>
<li><p> diameter. a factor with levels <code>&lt;=2in</code>, <code>&gt;2in</code>
</p>
</li>
<li><p> light. a factor with levels <code>sunny</code>, <code>shady</code>
</p>
</li>
<li><p> time. a factor with levels <code>early</code>, <code>midday</code>, <code>late</code>
</p>
</li></ul>



<h3>Source</h3>

<p>McCullagh, P. and Nelder, J. A. (1989) _Generalized Linear
Models_ (2nd Edition).  London: Chapman and Hall.
</p>
<p>Originally from
</p>
<p>Schoener, T. W. (1970) Nonsynchronous spatial overlap of lizards
in patchy habitats.  _Ecology_ *51*, 408-418.
</p>


<h3>See Also</h3>

<p><code><a href="brglm2.html#topic+brglm_fit">brglm_fit</a></code>
</p>

<hr>
<h2 id='silvapulle1981'>Separation Example Presented in Silvapulle (1981)</h2><span id='topic+silvapulle1981'></span>

<h3>Description</h3>

<p>Separation example presented in Silvapulle (1981).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>silvapulle1981
</code></pre>


<h3>Format</h3>

<p>A data frame with 35 rows and 2 variables:
</p>

<dl>
<dt>y</dt><dd><p>a factor with the levels <code>case</code> and <code>none-case</code>,
giving the outcome of a standardized psychiatric interview</p>
</dd>
<dt>ghqs</dt><dd><p>an integer giving the general health questionnaire score.</p>
</dd>
</dl>



<h3>References</h3>

<p>Silvapulle, M. J. (1981).
On the Existence of Maximum Likelihood Estimators for the Binomial Response Models.
Journal of the Royal Statistical Society. Series B (Methodological), 43(3), 310–313.
<a href="https://www.jstor.org/stable/2984941">https://www.jstor.org/stable/2984941</a>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
