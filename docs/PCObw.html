<!DOCTYPE html><html lang="en"><head><title>Help for package PCObw</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {PCObw}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#PCObw-package'>
<p>Bandwidth Selector with Penalized Comparison to Overfitting Criterion</p></a></li>
<li><a href='#bw.L2PCO'><p>Compute the full PCO bandwith</p></a></li>
<li><a href='#bw.L2PCO.diag'><p>Compute the diagonal PCO bandwith</p></a></li>
<li><a href='#gauss_1D_sample'><p>Univariate sample</p></a></li>
<li><a href='#gauss_mD_sample'><p>Multivariate sample</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Bandwidth Selector with Penalized Comparison to Overfitting
Criterion</td>
</tr>
<tr>
<td>Version:</td>
<td>0.0.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-03-16</td>
</tr>
<tr>
<td>Author:</td>
<td>S. Varet</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>S. Varet &lt;suzanne.varet@universite-paris-saclay.fr&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Bandwidth selector according to the Penalised Comparison to Overfitting (P.C.O.) 
             criterion as described in Varet, S., Lacour, C., Massart, P., Rivoirard, V., (2019)
             <a href="https://hal.archives-ouvertes.fr/hal-02002275">https://hal.archives-ouvertes.fr/hal-02002275</a>. 
             It can be used with univariate and multivariate data. </td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 0.12.17), stats(&ge; 3.5.2)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppEigen</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, mvtnorm</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-03-21 13:53:23 UTC; suzanne.varet</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-03-23 22:32:13 UTC</td>
</tr>
</table>
<hr>
<h2 id='PCObw-package'>
Bandwidth Selector with Penalized Comparison to Overfitting Criterion
</h2><span id='topic+PCObw-package'></span><span id='topic+PCObw'></span>

<h3>Description</h3>

<p>Bandwidth selector according to the Penalised Comparison to Overfitting (P.C.O.) 
criterion as described in Varet, S., Lacour, C., Massart, P., Rivoirard, V., (2019). 
It can be used with univariate and multivariate data. 
</p>


<h3>Details</h3>

<p>bw.L2PCO(x_i, ...)
</p>
<p>bw.L2PCO.diag(x_i, ...)
</p>
<p>select the optimal bandwith according to PCO criterion where x_i are the data (a numeric matrix or a numeric vector).
</p>


<h3>Author(s)</h3>

<p>S. Varet.
</p>
<p>Maintainer: S. Varet &lt;suzanne.varet@universite-paris-saclay.fr&gt;
</p>


<h3>References</h3>

<p>Varet, S., Lacour, C., Massart, P., Rivoirard, V., (2019). <em>Numerical performance of Penalized Comparison to Overfitting for multivariate kernel density estimation</em>. hal-02002275. <a href="https://hal.archives-ouvertes.fr/hal-02002275">https://hal.archives-ouvertes.fr/hal-02002275</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# load univariate data
data("gauss_1D_sample")
 
# computes the optimal bandwith for the sample x_i with all parameters set to their default value 
bw.L2PCO(gauss_1D_sample) 

  
</code></pre>

<hr>
<h2 id='bw.L2PCO'>Compute the full PCO bandwith</h2><span id='topic+bw.L2PCO'></span>

<h3>Description</h3>

<p><code>bw.L2PCO</code> tries to minimise the PCO criterion (described and studied in Varet, S., Lacour, C., Massart, P., 
Rivoirard, V., (2019)) with a gold section search. For multivariate data, 
it searches for a full matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bw.L2PCO(
  x_i,
  nh = 40,
  K_name = "gaussian",
  binning = FALSE,
  nb = 32,
  tol = 1e-06,
  adapt_nb_bin = FALSE,
  nb_bin_vect = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bw.L2PCO_+3A_x_i">x_i</code></td>
<td>
<p>the observations. Must be a matrix with d column and n lines (d the dimension and n the sample size)</p>
</td></tr>
<tr><td><code id="bw.L2PCO_+3A_nh">nh</code></td>
<td>
<p>the maximum number of PCO criterion evaluations during the golden section search. 
The default value is 40. The golden section search stop once this value is reached or 
if the tolerance is achieved, and return the middle of the interval.</p>
</td></tr>
<tr><td><code id="bw.L2PCO_+3A_k_name">K_name</code></td>
<td>
<p>name of the kernel. Can be 'gaussian', 'epanechnikov', 
or 'biweight'. The default value is 'gaussian'.</p>
</td></tr>
<tr><td><code id="bw.L2PCO_+3A_binning">binning</code></td>
<td>
<p>default value is FALSE, that is the function computes the exact PCO criterion.
If set to TRUE allows to use binning.</p>
</td></tr>
<tr><td><code id="bw.L2PCO_+3A_nb">nb</code></td>
<td>
<p>is the number of bins to use when binning is TRUE. 
For multivariate x_i, nb corresponds to the number of bins per dimension. The default value is 32.</p>
</td></tr>
<tr><td><code id="bw.L2PCO_+3A_tol">tol</code></td>
<td>
<p>is the maximum authorized length of the interval which contains the optimal h 
for univariate data. For multivariate data, it corresponds to the length of each hypercube axe.
The golden section search stop once this value is achieved or when nh is reached 
and return the middle of the interval. Its default value is 10^(-6).</p>
</td></tr>
<tr><td><code id="bw.L2PCO_+3A_adapt_nb_bin">adapt_nb_bin</code></td>
<td>
<p>is a boolean used for univariate x_i. If set to TRUE, authorises the function to increase 
the number of bins if, with nb bins, the middle of the initial interval is not an admissible solution, that is 
if the criterion at the middle is greater than the mean of the criterion at the bounds of the initial interval of search.</p>
</td></tr>
<tr><td><code id="bw.L2PCO_+3A_nb_bin_vect">nb_bin_vect</code></td>
<td>
<p>can be set to have a different number of bins on each dimension</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a scalar for univariate data or a matrix for multivariate data corresponding to the optimal bandwidth according to the PCO criterion
</p>


<h3>References</h3>

<p>Varet, S., Lacour, C., Massart, P., Rivoirard, V., (2019). <em>Numerical performance of Penalized
Comparison to Overfitting for multivariate kernel density estimation</em>. hal-02002275. <a href="https://hal.archives-ouvertes.fr/hal-02002275">https://hal.archives-ouvertes.fr/hal-02002275</a>
</p>


<h3>See Also</h3>

<p>[stats::nrd0()], [stats::nrd()], [stats::ucv()], [stats::bcv()] and [stats::SJ()] 
for other univariate bandwidth selection and [stats::density()] to compute the associated density estimation.
</p>
<p>[ks::Hlscv()], [ks::Hbcv()], [ks::ns()] for other multivariate bandwidth selection.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# an example with simulated univariate data

# load univariate data
data("gauss_1D_sample")

# computes the optimal bandwith for the sample x_i with all parameters set to their default value 
bw.L2PCO(gauss_1D_sample)


# an example with simulated multivariate data

# load multivariate data
data("gauss_mD_sample")

# computes the optimal bandwith for the sample x_i with all parameters set to their default value 
# generates a warning since the tolerance value is not reached
bw.L2PCO(gauss_mD_sample)

# To avoid this warning, it is possible to increase the parameter nh
bw.L2PCO(gauss_mD_sample, nh = 80)



</code></pre>

<hr>
<h2 id='bw.L2PCO.diag'>Compute the diagonal PCO bandwith</h2><span id='topic+bw.L2PCO.diag'></span>

<h3>Description</h3>

<p><code>bw.L2PCO.diag</code> tries to minimise the PCO criterion (described and studied in Varet, S., Lacour, C., 
Massart, P., Rivoirard, V., (2019)) with a gold section search. For multivariate data, 
it searches for a diagonal matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bw.L2PCO.diag(
  x_i,
  nh = 40,
  K_name = "gaussian",
  binning = FALSE,
  nb = 32,
  tol = 1e-06,
  adapt_nb_bin = FALSE,
  nb_bin_vect = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bw.L2PCO.diag_+3A_x_i">x_i</code></td>
<td>
<p>the observations. Must be a matrix with d column and n lines (d the dimension and n the sample size)</p>
</td></tr>
<tr><td><code id="bw.L2PCO.diag_+3A_nh">nh</code></td>
<td>
<p>the maximum of possible bandwiths tested. 
The default value is 40.</p>
</td></tr>
<tr><td><code id="bw.L2PCO.diag_+3A_k_name">K_name</code></td>
<td>
<p>name of the kernel. Can be 'gaussian', 'epanechnikov', 
or 'biweight'. The default value is 'gaussian'.</p>
</td></tr>
<tr><td><code id="bw.L2PCO.diag_+3A_binning">binning</code></td>
<td>
<p>can be set to TRUE or FALSE. 
The value TRUE allows to use binning. The default value FALSE
computes the exact PCO criterion.</p>
</td></tr>
<tr><td><code id="bw.L2PCO.diag_+3A_nb">nb</code></td>
<td>
<p>is the number of bins to use when binning is TRUE. 
For multivariate x_i, nb corresponds to the number of bins per dimension.</p>
</td></tr>
<tr><td><code id="bw.L2PCO.diag_+3A_tol">tol</code></td>
<td>
<p>is the maximum authorized length of the interval which contains the optimal h 
for univariate data. For multivariate data, it corresponds to the length of each hypercube axe.
The golden section search stop once this value is achieved or when nh is reached 
and return the middle of the interval. Its default value is 10^(-6).</p>
</td></tr>
<tr><td><code id="bw.L2PCO.diag_+3A_adapt_nb_bin">adapt_nb_bin</code></td>
<td>
<p>is a boolean used for univariate x_i. If set to TRUE, authorises the function to increase 
the number of bins if, with nb bins, the middle of the initial interval is not an admissible solution, that is 
if the criterion at the middle is greater than the mean of the criterion at the bounds of the initial interval of search.</p>
</td></tr>
<tr><td><code id="bw.L2PCO.diag_+3A_nb_bin_vect">nb_bin_vect</code></td>
<td>
<p>can be set to have a different number of bins on each dimension</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a scalar for univariate data or a vector (the diagonal of the matrix) for multivariate data corresponding to the optimal bandwidth according to the PCO criterion
</p>


<h3>References</h3>

<p>Varet, S., Lacour, C., Massart, P., Rivoirard, V., (2019). <em>Numerical performance of Penalized
Comparison to Overfitting for multivariate kernel density estimation</em>. hal-02002275. <a href="https://hal.archives-ouvertes.fr/hal-02002275">https://hal.archives-ouvertes.fr/hal-02002275</a>
</p>


<h3>See Also</h3>

<p>[stats::nrd0()], [stats::nrd()], [stats::ucv()], [stats::bcv()] and [stats::SJ()] 
for other univariate bandwidth selection and [stats::density()] to compute the associated density estimation.
</p>
<p>[ks::Hlscv.diag()], [ks::Hbcv.diag()], [ks::ns.diag()] for other multivariate bandwidth selection.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# an example with simulated univariate data

# load univariate data
data("gauss_1D_sample")

# computes the optimal bandwith for the sample x_i with all parameters set to their default value 
bw.L2PCO.diag(gauss_1D_sample)


# an example with simulated multivariate data

# load multivariate data
data("gauss_mD_sample")

# computes the optimal bandwith for the sample x_i with all parameters set to their default value 
# generates a warning since the tolerance value is not reached
bw.L2PCO.diag(gauss_mD_sample)

# To avoid this warning, it is possible to increase the parameter nh
bw.L2PCO.diag(gauss_mD_sample, nh = 80)





</code></pre>

<hr>
<h2 id='gauss_1D_sample'>Univariate sample</h2><span id='topic+gauss_1D_sample'></span>

<h3>Description</h3>

<p>A univariate sample of 100 realisations of a gaussian law with mean 0 and standard deviation 1
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("gauss_1D_sample")
</code></pre>


<h3>Format</h3>

<p>A vector with 100 rows
</p>

<hr>
<h2 id='gauss_mD_sample'>Multivariate sample</h2><span id='topic+gauss_mD_sample'></span>

<h3>Description</h3>

<p>A 2D sample of 100 realisations of a gaussian law with mean (0, 0) and covariance matrix
| 1    0.9 |
| 0.9  1   |
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("gauss_mD_sample")
</code></pre>


<h3>Format</h3>

<p>A matrix with 100 rows and 2 columns
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
