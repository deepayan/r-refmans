<!DOCTYPE html><html lang="en"><head><title>Help for package ACEsimFit</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ACEsimFit}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#fit_uniACE'><p>fit_uniACE</p></a></li>
<li><a href='#kinsim_double'><p>kinsim_double</p></a></li>
<li><a href='#kinsim_single'><p>kinsim_single</p></a></li>
<li><a href='#Power_LS'><p>Power_LS</p></a></li>
<li><a href='#rmvn'><p>rmvn</p></a></li>
<li><a href='#Sim_Fit'><p>Sim_Fit</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>ACE Kin Pair Data Simulations and Model Fitting</td>
</tr>
<tr>
<td>Version:</td>
<td>0.0.0.9</td>
</tr>
<tr>
<td>Description:</td>
<td>A few functions aim to provide a statistic tool for three purposes. First, simulate kin pairs data based on the assumption that every trait is affected by genetic effects (A), common environmental effects (C) and unique environmental effects (E).Second, use kin pairs data to fit an ACE model and get model fit output.Third, calculate power of A estimate given a specific condition. For the mechanisms of power calculation, we suggest to check Visscher(2004)&lt;<a href="https://doi.org/10.1375%2Ftwin.7.5.505">doi:10.1375/twin.7.5.505</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>Imports:</td>
<td>OpenMx (&ge; 2.19.6), stats (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, testthat (&ge; 3.0.0), rmarkdown</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-10-10 22:00:47 UTC; lyux20</td>
</tr>
<tr>
<td>Author:</td>
<td>Xuanyu Lyu [aut, cre],
  S.Mason Garrison [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Xuanyu Lyu &lt;lyux20@wfu.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-10-12 08:34:04 UTC</td>
</tr>
</table>
<hr>
<h2 id='fit_uniACE'>fit_uniACE</h2><span id='topic+fit_uniACE'></span>

<h3>Description</h3>

<p>Use OpenMx to quickly fit a univariate ACE model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_uniACE(
  data_1,
  data_2,
  GroupRel = c(1, 0.5),
  GroupR_c = c(1, 1),
  lbound = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fit_uniACE_+3A_data_1">data_1</code></td>
<td>
<p>A n by 2 <code>data.frame</code> consisting of the group1 kin pairs</p>
</td></tr>
<tr><td><code id="fit_uniACE_+3A_data_2">data_2</code></td>
<td>
<p>A n by 2 <code>data.frame</code> consisting of the group2 kin pairs</p>
</td></tr>
<tr><td><code id="fit_uniACE_+3A_grouprel">GroupRel</code></td>
<td>
<p>A numeric vector specifying two genetic relatedness values of two groups of kin pairs</p>
</td></tr>
<tr><td><code id="fit_uniACE_+3A_groupr_c">GroupR_c</code></td>
<td>
<p>A numeric vector specifying two common environment correlation coefficients of two groups of kin pairs</p>
</td></tr>
<tr><td><code id="fit_uniACE_+3A_lbound">lbound</code></td>
<td>
<p>A logical value indicating if a lower boundary of .0001 will be imposed to the estimated A, C and E components</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a <code>list</code> with the following:
</p>
<table role = "presentation">
<tr><td><code>df_nested</code></td>
<td>
<p>A <code>data.frame</code> displaying the nested comparison model between ACE, AE, CE, E models</p>
</td></tr>
<tr><td><code>fitACE</code></td>
<td>
<p>A <code>list</code> of all model fit information generated from OpenMx</p>
</td></tr>
</table>

<hr>
<h2 id='kinsim_double'>kinsim_double</h2><span id='topic+kinsim_double'></span>

<h3>Description</h3>

<p>The function to generate two groups of univariate kin pair(e.g., both MZ and DZ twins) data using a multivariate norm approach, given the ACE components.
<br />
<br />
Two approaches can be selected: a) simulate two groups of kin pairs using the genetic relatedness directly b) simulate two groups of kin pairs by combining MZ twins and DZ twins to achieve the required genetic relatedness (.5&lt;R&lt;1).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kinsim_double(
  GroupNames = c("KinPair1", "KinPair2"),
  GroupSizes = c(100, 100),
  GroupRel = c(1, 0.5),
  GroupR_c = c(1, 1),
  mu = c(0, 0),
  ace1 = c(1, 1, 1),
  ace2 = c(1, 1, 1),
  ifComb = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="kinsim_double_+3A_groupnames">GroupNames</code></td>
<td>
<p>A character vector specifying two names of the simulated kin pairs</p>
</td></tr>
<tr><td><code id="kinsim_double_+3A_groupsizes">GroupSizes</code></td>
<td>
<p>A numeric vector specifying two group sizes indicating the amount of kin pairs in respective group.</p>
</td></tr>
<tr><td><code id="kinsim_double_+3A_grouprel">GroupRel</code></td>
<td>
<p>A numeric vector specifying two genetic relatedness values of the simulated kin pairs</p>
</td></tr>
<tr><td><code id="kinsim_double_+3A_groupr_c">GroupR_c</code></td>
<td>
<p>A numeric vector specifying two common environment correlation coefficients of the simulated kin pairs</p>
</td></tr>
<tr><td><code id="kinsim_double_+3A_mu">mu</code></td>
<td>
<p>A numeric vector specifying two mean values for the generated variable of the kin pairs</p>
</td></tr>
<tr><td><code id="kinsim_double_+3A_ace1">ace1</code></td>
<td>
<p>A numeric vector specifying three variance components under an ACE (additive genetics, common environment, unique environment) structure for group1</p>
</td></tr>
<tr><td><code id="kinsim_double_+3A_ace2">ace2</code></td>
<td>
<p>A numeric vector specifying three variance components under an ACE (additive genetics, common environment, unique environment) structure for group2</p>
</td></tr>
<tr><td><code id="kinsim_double_+3A_ifcomb">ifComb</code></td>
<td>
<p>A logical value specifying the approach to achieve the required genetic relatedness value. <code>TRUE</code> = using combination approach. <code>FALSE</code> = using direct approach. (See function description for a detailed explanation of two approaches.)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns <code>data.frame</code> with the following:
</p>
<table role = "presentation">
<tr><td><code>GroupName</code></td>
<td>
<p>group name of the kin pairs</p>
</td></tr>
<tr><td><code>R</code></td>
<td>
<p>level of relatedness for the kin pair</p>
</td></tr>
<tr><td><code>r_c</code></td>
<td>
<p>level of common envrionment correlation of the kin pairs</p>
</td></tr>
<tr><td><code>id</code></td>
<td>
<p>id</p>
</td></tr>
<tr><td><code>A1</code></td>
<td>
<p>Additive genetic component for kin1 of the kin pairs</p>
</td></tr>
<tr><td><code>A2</code></td>
<td>
<p>Additive genetic component for kin2 of the kin pairs</p>
</td></tr>
<tr><td><code>C1</code></td>
<td>
<p>shared-environmental component for kin1 of the kin pairs</p>
</td></tr>
<tr><td><code>C2</code></td>
<td>
<p>shared-environmental component for kin2 of the kin pairs</p>
</td></tr>
<tr><td><code>E1</code></td>
<td>
<p>non-shared-environmental component for kin1 of the kin pairs</p>
</td></tr>
<tr><td><code>E2</code></td>
<td>
<p>non-shared-environmental component for kin2 of the kin pairs</p>
</td></tr>
<tr><td><code>y1</code></td>
<td>
<p>generated variable i for kin1</p>
</td></tr>
<tr><td><code>y2</code></td>
<td>
<p>generated variable i for kin2</p>
</td></tr>
</table>

<hr>
<h2 id='kinsim_single'>kinsim_single</h2><span id='topic+kinsim_single'></span>

<h3>Description</h3>

<p>The function to generate one group of univariate kin pair (e.g., only DZ twins) data using a multivariate norm approach, given the ACE components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kinsim_single(
  name = "KinPair1",
  Rel = 1,
  r_c = 1,
  n = 100,
  mu = 0,
  ace = c(1, 1, 1)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="kinsim_single_+3A_name">name</code></td>
<td>
<p>Assigned name for the simulated group of kin pairs</p>
</td></tr>
<tr><td><code id="kinsim_single_+3A_rel">Rel</code></td>
<td>
<p>Genetic relatedness of the simulated kin pairs</p>
</td></tr>
<tr><td><code id="kinsim_single_+3A_r_c">r_c</code></td>
<td>
<p>Assumed common enviroment correlation</p>
</td></tr>
<tr><td><code id="kinsim_single_+3A_n">n</code></td>
<td>
<p>The number of generated kin pairs.(n PAIRS of data; The total number of participants is 2n)</p>
</td></tr>
<tr><td><code id="kinsim_single_+3A_mu">mu</code></td>
<td>
<p>The mean for generated variable</p>
</td></tr>
<tr><td><code id="kinsim_single_+3A_ace">ace</code></td>
<td>
<p>Vector of variance components under an ACE (additive genetics, common environment, unique environment) structure</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns <code>data.frame</code> with the following:
</p>
<table role = "presentation">
<tr><td><code>GroupName</code></td>
<td>
<p>group name of the kin pairs</p>
</td></tr>
<tr><td><code>R</code></td>
<td>
<p>level of genetic relatedness for the kin pairs</p>
</td></tr>
<tr><td><code>r_c</code></td>
<td>
<p>level of common envrionment correlation of the kin pairs</p>
</td></tr>
<tr><td><code>id</code></td>
<td>
<p>id</p>
</td></tr>
<tr><td><code>A1</code></td>
<td>
<p>Additive genetic component for kin1 of the kin pairs</p>
</td></tr>
<tr><td><code>A2</code></td>
<td>
<p>Additive genetic component for kin2 of the kin pairs</p>
</td></tr>
<tr><td><code>C1</code></td>
<td>
<p>shared-environmental component for kin1 of the kin pairs</p>
</td></tr>
<tr><td><code>C2</code></td>
<td>
<p>shared-environmental component for kin2 of the kin pairs</p>
</td></tr>
<tr><td><code>E1</code></td>
<td>
<p>non-shared-environmental component for kin1 of the kin pairs</p>
</td></tr>
<tr><td><code>E2</code></td>
<td>
<p>non-shared-environmental component for kin2 of the kin pairs</p>
</td></tr>
<tr><td><code>y1</code></td>
<td>
<p>generated variable i for kin1</p>
</td></tr>
<tr><td><code>y2</code></td>
<td>
<p>generated variable i for kin2</p>
</td></tr>
</table>

<hr>
<h2 id='Power_LS'>Power_LS</h2><span id='topic+Power_LS'></span>

<h3>Description</h3>

<p>The function is designed for calculating the power of heritability estimation from ACE models given the parameter settings. Or calculate one of the parameter settings (N,R,h2,c2) given the rest of known parameters.
This power calculator is made based on the Least Squares theory and follows the mathematical derivation proposed by Visscher(2004).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Power_LS(N1, N2, power, p_N1 = NULL, h2, c2, R1 = 1, R2 = 0.5, alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Power_LS_+3A_n1">N1</code></td>
<td>
<p>The number of kin pairs for group1 (amount of PAIRS)</p>
</td></tr>
<tr><td><code id="Power_LS_+3A_n2">N2</code></td>
<td>
<p>The number of kin pairs for group2</p>
</td></tr>
<tr><td><code id="Power_LS_+3A_power">power</code></td>
<td>
<p>The power of heritability estimation. Specified if you want to return the required sample sizes.</p>
</td></tr>
<tr><td><code id="Power_LS_+3A_p_n1">p_N1</code></td>
<td>
<p>The proportion of kin group1 over the . Required to be specified if the user wants to calculate the N1 and N2 simultaneously.</p>
</td></tr>
<tr><td><code id="Power_LS_+3A_h2">h2</code></td>
<td>
<p>The assumed standard heritability value of the target trait. 0 &lt; h2 &lt; 1</p>
</td></tr>
<tr><td><code id="Power_LS_+3A_c2">c2</code></td>
<td>
<p>The assumed standard common environmental effects on the target trait. 0 &lt; c2 &lt; 2</p>
</td></tr>
<tr><td><code id="Power_LS_+3A_r1">R1</code></td>
<td>
<p>The genetic relatedness of kin pair group1</p>
</td></tr>
<tr><td><code id="Power_LS_+3A_r2">R2</code></td>
<td>
<p>The genetic relatedness of kin pair group2</p>
</td></tr>
<tr><td><code id="Power_LS_+3A_alpha">alpha</code></td>
<td>
<p>The type-one error rate for heritability estimation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric <code>vector</code> of power when <code>N1</code> and <code>N2</code> are both specified.
<br />
A numeric <code>vector</code> of <code>N1</code> (or <code>N2</code>) when <code>N2</code> (or <code>N1</code>) is specified. A numeric <code>vector</code> of <code>N1</code> and <code>N2</code> when <code>RatioN</code> is specified.
</p>

<hr>
<h2 id='rmvn'>rmvn</h2><span id='topic+rmvn'></span>

<h3>Description</h3>

<p>rmvn
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rmvn(n, sigma)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rmvn_+3A_n">n</code></td>
<td>
<p>Sample Size</p>
</td></tr>
<tr><td><code id="rmvn_+3A_sigma">sigma</code></td>
<td>
<p>Covariance matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Generates multivariate normal data from a covariance matrix (<code>sigma</code>) of length <code>n</code>
</p>

<hr>
<h2 id='Sim_Fit'>Sim_Fit</h2><span id='topic+Sim_Fit'></span>

<h3>Description</h3>

<p>A function to simulate a set of kin pair data and fit them with ACE models. Can be helpful with checking model performance for a given parameter setting.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Sim_Fit(
  GroupNames = c("KinPair1", "KinPair2"),
  GroupSizes = c(100, 100),
  nIter = 100,
  SSeed = 62,
  GroupRel = c(1, 0.5),
  GroupR_c = c(1, 1),
  mu = c(0, 0),
  ace1 = c(1, 1, 1),
  ace2 = c(1, 1, 1),
  ifComb = FALSE,
  lbound = FALSE,
  saveRaw = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Sim_Fit_+3A_groupnames">GroupNames</code></td>
<td>
<p>A character vector specifying two names of the simulated kin pairs</p>
</td></tr>
<tr><td><code id="Sim_Fit_+3A_groupsizes">GroupSizes</code></td>
<td>
<p>A numeric vector specifying two group sizes indicating the amount of kin pairs in respective group.</p>
</td></tr>
<tr><td><code id="Sim_Fit_+3A_niter">nIter</code></td>
<td>
<p>A numeric value specifying the number of iteration you want to run given the parameters assigned (i.e. the number of model fitting results you want to get)</p>
</td></tr>
<tr><td><code id="Sim_Fit_+3A_sseed">SSeed</code></td>
<td>
<p>An integer specifying the starting seed of the random number. This parameter will make sure the simulated results are replicable across time</p>
</td></tr>
<tr><td><code id="Sim_Fit_+3A_grouprel">GroupRel</code></td>
<td>
<p>A numeric vector specifying two genetic relatedness values of the simulated kin pairs</p>
</td></tr>
<tr><td><code id="Sim_Fit_+3A_groupr_c">GroupR_c</code></td>
<td>
<p>A numeric vector specifying two common environment correlation coefficients of the simulated kin pairs</p>
</td></tr>
<tr><td><code id="Sim_Fit_+3A_mu">mu</code></td>
<td>
<p>A numeric vector specifying two mean values for the generated variable of the kin pairs</p>
</td></tr>
<tr><td><code id="Sim_Fit_+3A_ace1">ace1</code></td>
<td>
<p>A numeric vector specifying three variance components under an ACE (additive genetics, common environment, unique environment) structure for group1</p>
</td></tr>
<tr><td><code id="Sim_Fit_+3A_ace2">ace2</code></td>
<td>
<p>A numeric vector specifying three variance components under an ACE (additive genetics, common environment, unique environment) structure for group2</p>
</td></tr>
<tr><td><code id="Sim_Fit_+3A_ifcomb">ifComb</code></td>
<td>
<p>A logical value specifying the approach to achieve the required genetic relatedness value. <code>TRUE</code> = using combination approach. <code>FALSE</code> = using direct approach. (See function description for a detailed explanation of two approaches.)</p>
</td></tr>
<tr><td><code id="Sim_Fit_+3A_lbound">lbound</code></td>
<td>
<p>A logical value indicating if a lower boundary of .0001 will be imposed to the estimated A, C and E components</p>
</td></tr>
<tr><td><code id="Sim_Fit_+3A_saveraw">saveRaw</code></td>
<td>
<p>A logical value specifying if the raw simulated data should be saved in the output list</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a two-level <code>list</code>. Level-one is the number of iterations. Level-two is the model fitting results and raw data (if <code>saveRaw = TRUE</code>) of the simulated data from the respective iteration. Level-two includes:
</p>
<table role = "presentation">
<tr><td><code>Results</code></td>
<td>
<p>A <code>list</code> including 1) A <code>data.frame</code> displaying the nested comparison model between ACE, AE, CE, E models and 2) A <code>list</code> of all model fit information generated from OpenMx</p>
</td></tr>
<tr><td><code>Data</code></td>
<td>
<p>A <code>data.frame</code> consists of the simulated raw data</p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
