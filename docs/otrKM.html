<!DOCTYPE html><html><head><title>Help for package otrKM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {otrKM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#AIWKME'><p>The (S)AIWKME estimator.</p></a></li>
<li><a href='#clipp'><p>clip function.</p></a></li>
<li><a href='#DRKMEIV'><p>The (S)DRKMEIV estimator.</p></a></li>
<li><a href='#Fprep.AIWKME'><p>Cox proportional hazards model for eta-free terms in the (S)AIWKME estimator.</p></a></li>
<li><a href='#Fprep.DRKMEIV'><p>Cox proportional hazards model for eta-free terms in the (S)DRKMEIV estimator.</p></a></li>
<li><a href='#Fps.AIWKME'><p>Logistic regression for observed treatment used for the (S)AIWKME estimator.</p></a></li>
<li><a href='#Fps.DRKMEIV'><p>Logistic regression for observed treatment and instrument used for the (S)DRKMEIV estimator.</p></a></li>
<li><a href='#Fps.IWKME'><p>Logistic regression for observed treatment used for the (S)IWKME estimator.</p></a></li>
<li><a href='#Fps.IWKMEIV'><p>Logistic regression for observed treatment and instrument used for the (S)IWKMEIV estimator.</p></a></li>
<li><a href='#Genetic.optim.AIWKME'><p>The optimal treatment regime based on the (S)AIWKME estimator.</p></a></li>
<li><a href='#Genetic.optim.DRKMEIV'><p>The optimal treatment regime based on the (S)DRKMEIV estimator.</p></a></li>
<li><a href='#Genetic.optim.IWKME'><p>The optimal treatment regime based on the (S)IWKME estimator.</p></a></li>
<li><a href='#Genetic.optim.IWKMEIV'><p>The optimal treatment regime based on the (S)IWKMEIV estimator.</p></a></li>
<li><a href='#IWKME'><p>The (S)IWKME estimator.</p></a></li>
<li><a href='#IWKMEIV'><p>The (S)IWKMEIV estimator.</p></a></li>
<li><a href='#simulation'><p>Simulation</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Optimal Treatment Regimes in Survival Contexts with
Kaplan-Meier-Like Estimators</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Provide methods for estimating optimal treatment regimes in survival contexts 
    with Kaplan-Meier-like estimators when no unmeasured confounding assumption is 
    satisfied (Jiang, R., Lu, W., Song, R., and Davidian, M. (2017) &lt;<a href="https://doi.org/10.1111%2Frssb.12201">doi:10.1111/rssb.12201</a>&gt;) 
    and when no unmeasured confounding assumption fails to hold and a binary instrument 
    is available (Xia, J., Zhan, Z., Zhang, J. (2022) &lt;<a href="https://doi.org/10.48550/arXiv.2210.05538">doi:10.48550/arXiv.2210.05538</a>&gt;).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>rgenoud, survival</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.10)</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-07-04 13:35:10 UTC; xiajunwen</td>
</tr>
<tr>
<td>Author:</td>
<td>Junwen Xia [aut, cre],
  Zishu Zhan [aut],
  Jingxiao Zhang [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Junwen Xia &lt;xiajunwen@ruc.edu.cn&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-07-06 15:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='AIWKME'>The (S)AIWKME estimator.</h2><span id='topic+AIWKME'></span>

<h3>Description</h3>

<p>Given a predetermined t0 and eta, calculate t0-year potential survival probability based on the (S)AIWKME estimator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AIWKME(eta, datalist, ps, prep, t0, smooth = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AIWKME_+3A_eta">eta</code></td>
<td>
<p>The parameters of the regime.</p>
</td></tr>
<tr><td><code id="AIWKME_+3A_datalist">datalist</code></td>
<td>
<p>A list used to calculate the (S)AIWKME estimator including treatment named <code>a</code>, observed time named <code>obs.t</code>, censoring indicator (0, censored) named <code>delta</code>, and baseline covariates used to assign treatment named <code>l</code>. Notice that all the data in the datalist should be ordered by observed time.</p>
</td></tr>
<tr><td><code id="AIWKME_+3A_ps">ps</code></td>
<td>
<p>A list including the probability of receiving treatment given baseline covariates named <code>fal</code>. <code><a href="#topic+Fps.AIWKME">Fps.AIWKME</a></code> can produce <code>ps</code> by positing logistic model.</p>
</td></tr>
<tr><td><code id="AIWKME_+3A_prep">prep</code></td>
<td>
<p>A list including the augmented terms in the numerator with treatment all to 1 named <code>gamma.num.1</code> and all to 0 named <code>gamma.num.0</code> and in the denominator with treatment all to 1 named <code>gamma.den.1</code> and all to 0 <code>named gamma.den.0</code>; <code>gamma.num.1</code> and the others are matrix with ordered observed time as rows and patients as columns. <code><a href="#topic+Fprep.AIWKME">Fprep.AIWKME</a></code> can produce <code>prep</code> by positing Cox proportional hazards model.</p>
</td></tr>
<tr><td><code id="AIWKME_+3A_t0">t0</code></td>
<td>
<p>A predetermined time.</p>
</td></tr>
<tr><td><code id="AIWKME_+3A_smooth">smooth</code></td>
<td>
<p>A logic variable indicating wether a smoothed estimator should be used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>More details can be found in references.
</p>


<h3>Value</h3>

<p>Estimated potential survival probability given eta and t0.
</p>


<h3>References</h3>

<p>Jiang, R., Lu, W., Song, R., and Davidian, M. (2017) On estimation of optimal treatment regimes for maximizing t‚Äêyear survival probability. <em>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</em>, <b>79:</b> 1165-1185. DOI:10.1111/rssb.12201
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load data
data(simulation)
simulation=simulation[order(simulation$Survival),]

# convert the data into a datalist
datalist=list(z=simulation$Instrument,a=simulation$Treatment,
              obs.t=simulation$Survival,delta=simulation$Status,
              l=cbind(simulation$Covariate1,simulation$Covariate2))

# predetermined t0 and eta
t0=5
eta=c(1,2,3)

# calculate ps and prep
ps=Fps.AIWKME(datalist)
prep=Fprep.AIWKME(datalist, t0)

AIWKME(eta, datalist, ps, prep, t0, smooth=TRUE)
</code></pre>

<hr>
<h2 id='clipp'>clip function.</h2><span id='topic+clipp'></span>

<h3>Description</h3>

<p>Limit the number not to be too large or too small.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clipp(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clipp_+3A_x">x</code></td>
<td>
<p>A vector or matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector or matrix same as the input.
</p>

<hr>
<h2 id='DRKMEIV'>The (S)DRKMEIV estimator.</h2><span id='topic+DRKMEIV'></span>

<h3>Description</h3>

<p>Given a predetermined t0 and eta, calculate t0-year potential survival probability based on the (S)DRKMEIV estimator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DRKMEIV(eta, datalist, ps, prep, t0, smooth = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DRKMEIV_+3A_eta">eta</code></td>
<td>
<p>The parameters of the regime.</p>
</td></tr>
<tr><td><code id="DRKMEIV_+3A_datalist">datalist</code></td>
<td>
<p>A list used to calculate the (S)DRKMEIV estimator including treatment named <code>a</code>, observed time named <code>obs.t</code>, censoring indicator (0, censored) named <code>delta</code>, and baseline covariates used to assign treatment named <code>l</code>. Notice that all the data in the datalist should be ordered by observed time.</p>
</td></tr>
<tr><td><code id="DRKMEIV_+3A_ps">ps</code></td>
<td>
<p>A list including the probability of receiving instrument given baseline covariates named <code>fzl</code>, the probability of receiving treatment given baseline covariates and instrument equaling 0 named <code>fal0</code>, the probability of receiving treatment given baseline covariates and instrument equaling 1 named <code>fal1</code>, and the difference between fal1 and fal0 named <code>deltal</code>. <code><a href="#topic+Fps.DRKMEIV">Fps.DRKMEIV</a></code> can produce <code>ps</code> by positing logistic model.</p>
</td></tr>
<tr><td><code id="DRKMEIV_+3A_prep">prep</code></td>
<td>
<p>A list including estimates <code class="reqn">\hat{\gamma}_1(\boldsymbol{L};s)</code> with treatment all to 1 named <code>gamma.num.1</code> and all to 0 named <code>gamma.num.0</code>, <code class="reqn">\hat{\gamma}_1'(\boldsymbol{L};s)</code> with treatment all to 1 named <code>gammaa.num.1</code> and all to 0 named <code>gammaa.num.0</code>, <code class="reqn">\hat{\gamma}_2(\boldsymbol{L};s)</code> with treatment all to 1 named <code>gamma.den.1</code> and all to 0 named <code>gamma.den.0</code>, and <code class="reqn">\hat{\gamma}_2'(\boldsymbol{L};s)</code> with treatment all to 1 named <code>gammaa.den.1</code> and all to 0 named <code>gammaa.den.0</code>; <code>gamma.num.1</code> and the others are matrix with ordered observed time as rows and patients as columns. There are also estimates for the last term of the (S)DRKMEIV estimator. More details can be found in references. <code><a href="#topic+Fprep.DRKMEIV">Fprep.DRKMEIV</a></code> can produce <code>prep</code> by positing Cox proportional hazards model.</p>
</td></tr>
<tr><td><code id="DRKMEIV_+3A_t0">t0</code></td>
<td>
<p>A predetermined time.</p>
</td></tr>
<tr><td><code id="DRKMEIV_+3A_smooth">smooth</code></td>
<td>
<p>A logic variable indicating wether a smoothed version should be used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>More details can be found in references.
</p>


<h3>Value</h3>

<p>Estimated potential survival probability given eta and t0.
</p>


<h3>References</h3>

<p>Xia, J., Zhan, Z., Zhang, J. (2022) Estimating optimal treatment regime in survival contexts using an instrumental variable. Under Review.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load data
data(simulation)
simulation=simulation[order(simulation$Survival),]

# convert the data into a datalist
datalist=list(z=simulation$Instrument,a=simulation$Treatment,
              obs.t=simulation$Survival,delta=simulation$Status,
              l=cbind(simulation$Covariate1,simulation$Covariate2))

# predetermined t0 and eta
t0=5
eta=c(1,2,3)

# calculate ps and prep
ps=Fps.DRKMEIV(datalist,t0)
prep=Fprep.DRKMEIV(datalist, ps, t0)

DRKMEIV(eta, datalist, ps, prep, t0, smooth=TRUE)
</code></pre>

<hr>
<h2 id='Fprep.AIWKME'>Cox proportional hazards model for eta-free terms in the (S)AIWKME estimator.</h2><span id='topic+Fprep.AIWKME'></span>

<h3>Description</h3>

<p>Cox proportional hazards model for eta-free terms in the (S)AIWKME estimator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Fprep.AIWKME(datalist, t0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Fprep.AIWKME_+3A_datalist">datalist</code></td>
<td>
<p>A list used to calculate the (S)AIWKME estimator including treatment named <code>a</code>, observed time named <code>obs.t</code>, censoring indicator (0, censored) named <code>delta</code>, and baseline covariates used to assign treatment named <code>l</code>. Notice that all the data in the datalist should be ordered by observed time.</p>
</td></tr>
<tr><td><code id="Fprep.AIWKME_+3A_t0">t0</code></td>
<td>
<p>A predetermined t.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>More details can be found in references, <code><a href="#topic+AIWKME">AIWKME</a></code>, and <code><a href="#topic+Genetic.optim.AIWKME">Genetic.optim.AIWKME</a></code>.
</p>


<h3>Value</h3>

<p>A list including the augmented terms in the numerator with treatment all to 1 named <code>gamma.num.1</code> and all to 0 named <code>gamma.num.0</code> and in the denominator with treatment all to 1 named <code>gamma.den.1</code> and all to 0 named <code>gamma.den.0</code>; <code>gamma.num.1</code> and the others are matrix with ordered observed time as rows and patients as columns. More details can be found in references.
</p>


<h3>References</h3>

<p>Jiang, R., Lu, W., Song, R., and Davidian, M. (2017) On estimation of optimal treatment regimes for maximizing t‚Äêyear survival probability. <em>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</em>, <b>79:</b> 1165-1185. DOI:10.1111/rssb.12201
</p>

<hr>
<h2 id='Fprep.DRKMEIV'>Cox proportional hazards model for eta-free terms in the (S)DRKMEIV estimator.</h2><span id='topic+Fprep.DRKMEIV'></span>

<h3>Description</h3>

<p>Cox proportional hazards model for eta-free terms in the (S)DRKMEIV estimator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Fprep.DRKMEIV(datalist, ps, t0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Fprep.DRKMEIV_+3A_datalist">datalist</code></td>
<td>
<p>A list used to calculate the (S)DRKMEIV estimator including treatment named <code>a</code>, observed time named <code>obs.t</code>, censoring indicator (0, censored) named <code>delta</code>, and baseline covariates used to assign treatment named <code>l</code>. Notice that all the data in the datalist should be ordered by observed time.</p>
</td></tr>
<tr><td><code id="Fprep.DRKMEIV_+3A_ps">ps</code></td>
<td>
<p>A list including the probability of receiving instrument given baseline covariates named <code>fzl</code>, the probability of receiving treatment given baseline covariates and instrument equaling 0 named <code>fal0</code>, the probability of receiving treatment given baseline covariates and instrument equaling 1 named <code>fal1</code>, and the difference between fal1 and fal0 named <code>deltal</code>. <code><a href="#topic+Fps.DRKMEIV">Fps.DRKMEIV</a></code> can produce <code>ps</code> by positing logistic model.</p>
</td></tr>
<tr><td><code id="Fprep.DRKMEIV_+3A_t0">t0</code></td>
<td>
<p>A predetermined t.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>More details can be found in references, <code><a href="#topic+DRKMEIV">DRKMEIV</a></code>, and <code><a href="#topic+Genetic.optim.DRKMEIV">Genetic.optim.DRKMEIV</a></code>.
</p>


<h3>Value</h3>

<p>A list including estimates <code class="reqn">\hat{\gamma}_1(\boldsymbol{L};s)</code> with treatment all to 1 named <code>gamma.num.1</code> and all to 0 named <code>gamma.num.0</code>, <code class="reqn">\hat{\gamma}_1'(\boldsymbol{L};s)</code> with treatment all to 1 named <code>gammaa.num.1</code> and all to 0 named <code>gammaa.num.0</code>, <code class="reqn">\hat{\gamma}_2(\boldsymbol{L};s)</code> with treatment all to 1 named <code>gamma.den.1</code> and all to 0 named <code>gamma.den.0</code>, and <code class="reqn">\hat{\gamma}_2'(\boldsymbol{L};s)</code> with treatment all to 1 named <code>gammaa.den.1</code> and all to 0 named <code>gammaa.den.0</code>; <code>gamma.num.1</code> and the others are matrix with ordered observed time as rows and patients as columns. There are also estimates for the last term of the (S)DRIWKMEIV estimator. More details can be found in references.
</p>


<h3>References</h3>

<p>Xia, J., Zhan, Z., Zhang, J. (2022) Estimating optimal treatment regime in survival contexts using an instrumental variable. Under Review.
</p>

<hr>
<h2 id='Fps.AIWKME'>Logistic regression for observed treatment used for the (S)AIWKME estimator.</h2><span id='topic+Fps.AIWKME'></span>

<h3>Description</h3>

<p>Logistic regression for observed treatment used for the (S)AIWKME estimator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Fps.AIWKME(datalist)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Fps.AIWKME_+3A_datalist">datalist</code></td>
<td>
<p>A list used to calculate the (S)AIWKME estimator including treatment named <code>a</code>, observed time named <code>obs.t</code>, censoring indicator (0, censored) named <code>delta</code>, and baseline covariates used to assign treatment named <code>l</code>. Notice that all the data in the datalist should be ordered by observed time.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>More details can be found in references, <code><a href="#topic+AIWKME">AIWKME</a></code>, and <code><a href="#topic+Genetic.optim.AIWKME">Genetic.optim.AIWKME</a></code>.
</p>


<h3>Value</h3>

<p>A list including the probability of receiving treatment given baseline covariates named <code>fal</code>.
</p>


<h3>References</h3>

<p>Jiang, R., Lu, W., Song, R., and Davidian, M. (2017) On estimation of optimal treatment regimes for maximizing t‚Äêyear survival probability. <em>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</em>, <b>79:</b> 1165-1185. DOI:10.1111/rssb.12201
</p>

<hr>
<h2 id='Fps.DRKMEIV'>Logistic regression for observed treatment and instrument used for the (S)DRKMEIV estimator.</h2><span id='topic+Fps.DRKMEIV'></span>

<h3>Description</h3>

<p>Logistic regression for observed treatment and instrument used for the (S)DRKMEIV estimator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Fps.DRKMEIV(datalist, t0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Fps.DRKMEIV_+3A_datalist">datalist</code></td>
<td>
<p>A list used to calculate the (S)DRKMEIV estimator including treatment named <code>a</code>, observed time named <code>obs.t</code>, censoring indicator (0, censored) named <code>delta</code>, and baseline covariates used to assign treatment named <code>l</code>. Notice that all the data in the datalist should be ordered by observed time.</p>
</td></tr>
<tr><td><code id="Fps.DRKMEIV_+3A_t0">t0</code></td>
<td>
<p>A predetermined t.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>More details can be found in references, <code><a href="#topic+DRKMEIV">DRKMEIV</a></code>, and <code><a href="#topic+Genetic.optim.DRKMEIV">Genetic.optim.DRKMEIV</a></code>.
</p>


<h3>Value</h3>

<p>A list including the probability of receiving instrument given baseline covariates named <code>fzl</code>, the probability of receiving treatment given baseline covariates and instrument equaling 0 named <code>fal0</code>, the probability of receiving treatment given baseline covariates and instrument equaling 1 named <code>fal1</code>, the difference between <code>fal1</code> and <code>fal0</code> named <code>deltal</code>, and the censoring survival function given baseline covariates and treatment 1 or 0 named <code>surv.C.1</code> or <code>surv.C.0</code>.
</p>


<h3>References</h3>

<p>Xia, J., Zhan, Z., Zhang, J. (2022) Estimating optimal treatment regime in survival contexts using an instrumental variable. Under Review.
</p>

<hr>
<h2 id='Fps.IWKME'>Logistic regression for observed treatment used for the (S)IWKME estimator.</h2><span id='topic+Fps.IWKME'></span>

<h3>Description</h3>

<p>Logistic regression for observed treatment used for the (S)IWKME estimator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Fps.IWKME(datalist)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Fps.IWKME_+3A_datalist">datalist</code></td>
<td>
<p>A list used to calculate the (S)IWKME estimator including treatment named <code>a</code>, observed time named <code>obs.t</code>, censoring indicator (0, censored) named <code>delta</code>, and baseline covariates used to assign treatment named <code>l</code>. Notice that all the data in the datalist should be ordered by observed time.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>More details can be found in references, <code><a href="#topic+IWKME">IWKME</a></code>, and <code><a href="#topic+Genetic.optim.IWKME">Genetic.optim.IWKME</a></code>.
</p>


<h3>Value</h3>

<p>A list including the probability of receiving treatment given baseline covariates named <code>fal</code>.
</p>


<h3>References</h3>

<p>Jiang, R., Lu, W., Song, R., and Davidian, M. (2017) On estimation of optimal treatment regimes for maximizing t‚Äêyear survival probability. <em>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</em>, <b>79:</b> 1165-1185. DOI:10.1111/rssb.12201
</p>

<hr>
<h2 id='Fps.IWKMEIV'>Logistic regression for observed treatment and instrument used for the (S)IWKMEIV estimator.</h2><span id='topic+Fps.IWKMEIV'></span>

<h3>Description</h3>

<p>Logistic regression for observed treatment and instrument used for the (S)IWKMEIV estimator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Fps.IWKMEIV(datalist, t0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Fps.IWKMEIV_+3A_datalist">datalist</code></td>
<td>
<p>A list used to calculate the (S)IWKMEIV estimator including treatment named <code>a</code>, observed time named <code>obs.t</code>, censoring indicator (0, censored) named <code>delta</code>, and baseline covariates used to assign treatment named <code>l</code>. Notice that all the data in the datalist should be ordered by observed time.</p>
</td></tr>
<tr><td><code id="Fps.IWKMEIV_+3A_t0">t0</code></td>
<td>
<p>A predetermined t.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>More details can be found in references, <code><a href="#topic+IWKMEIV">IWKMEIV</a></code>, and <code><a href="#topic+Genetic.optim.IWKMEIV">Genetic.optim.IWKMEIV</a></code>.
</p>


<h3>Value</h3>

<p>A list including the probability of receiving instrument given baseline covariates named <code>fzl</code>, the difference between fal1 and fal0 named <code>deltal</code>, where fal0 denotes the probability of receiving treatment given baseline covariates and instrument equaling 0, and fal1 denotes the probability of receiving treatment given baseline covariates and instrument equaling 1, and the censoring survival function given baseline covariates and treatment 1 or 0 named <code>surv.C.1</code> or <code>surv.C.0</code>.
</p>


<h3>References</h3>

<p>Xia, J., Zhan, Z., Zhang, J. (2022) Estimating optimal treatment regime in survival contexts using an instrumental variable. Under Review.
</p>

<hr>
<h2 id='Genetic.optim.AIWKME'>The optimal treatment regime based on the (S)AIWKME estimator.</h2><span id='topic+Genetic.optim.AIWKME'></span>

<h3>Description</h3>

<p>Given a predetermined t0, estimate the optimal treatment regime by maximizing t0-year survival probability based on the (S)AIWKME estimator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Genetic.optim.AIWKME(datalist, ps, prep, t0, smooth = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Genetic.optim.AIWKME_+3A_datalist">datalist</code></td>
<td>
<p>A list used to calculate the (S)AIWKME estimator including treatment named <code>a</code>, observed time named <code>obs.t</code>, censoring indicator (0, censored) named <code>delta</code>, and baseline covariates used to assign treatment named <code>l</code>. Notice that all the data in the datalist should be ordered by observed time.</p>
</td></tr>
<tr><td><code id="Genetic.optim.AIWKME_+3A_ps">ps</code></td>
<td>
<p>A list including the probability of receiving treatment given baseline covariates named <code>fal</code>. <code><a href="#topic+Fps.AIWKME">Fps.AIWKME</a></code> can produce <code>ps</code> by positing logistic model.</p>
</td></tr>
<tr><td><code id="Genetic.optim.AIWKME_+3A_prep">prep</code></td>
<td>
<p>A list including the augmented terms in the numerator with treatment all to 1 named <code>gamma.num.1</code> and all to 0 named <code>gamma.num.0</code> and in the denominator with treatment all to 1 named <code>gamma.den.1</code> and all to 0 named <code>gamma.den.0</code>; <code>gamma.num.1</code> and the others are matrix with ordered observed time as rows and patients as columns. <code><a href="#topic+Fprep.AIWKME">Fprep.AIWKME</a></code> can produce <code>prep</code> by positing Cox proportional hazards model.</p>
</td></tr>
<tr><td><code id="Genetic.optim.AIWKME_+3A_t0">t0</code></td>
<td>
<p>A predetermined time.</p>
</td></tr>
<tr><td><code id="Genetic.optim.AIWKME_+3A_smooth">smooth</code></td>
<td>
<p>A logic variable indicating wether a smoothed version should be used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>More details can be found in references.
</p>


<h3>Value</h3>

<p>A numeric vector in which the last number is the estimated optimal t0-year survival probability and others are the estimated parameters of the optimal treatment regime.
</p>


<h3>References</h3>

<p>Jiang, R., Lu, W., Song, R., and Davidian, M. (2017) On estimation of optimal treatment regimes for maximizing t‚Äêyear survival probability. <em>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</em>, <b>79:</b> 1165-1185. DOI:10.1111/rssb.12201
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load data
data(simulation)
simulation=simulation[order(simulation$Survival),]

# convert the data into a datalist
datalist=list(z=simulation$Instrument,a=simulation$Treatment,
              obs.t=simulation$Survival,delta=simulation$Status,
              l=cbind(simulation$Covariate1,simulation$Covariate2))

# predetermined t0
t0=5

# calculate ps and prep
ps=Fps.AIWKME(datalist)
prep=Fprep.AIWKME(datalist, t0)

Genetic.optim.AIWKME(datalist, ps, prep, t0, smooth=TRUE)
</code></pre>

<hr>
<h2 id='Genetic.optim.DRKMEIV'>The optimal treatment regime based on the (S)DRKMEIV estimator.</h2><span id='topic+Genetic.optim.DRKMEIV'></span>

<h3>Description</h3>

<p>Given a predetermined t0, estimate the optimal treatment regime by maximizing t0-year survival probability based on the (S)DRKMEIV estimator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Genetic.optim.DRKMEIV(datalist, ps, prep, t0, smooth = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Genetic.optim.DRKMEIV_+3A_datalist">datalist</code></td>
<td>
<p>A list used to calculate the (S)DRKMEIV estimator including instrument named <code>z</code>, treatment named <code>a</code>, observed time named <code>obs.t</code>, censoring indicator (0, censored) named <code>delta</code>, and baseline covariates used to assign treatment named <code>l</code>. Notice that all the data in the datalist should be ordered by observed time.</p>
</td></tr>
<tr><td><code id="Genetic.optim.DRKMEIV_+3A_ps">ps</code></td>
<td>
<p>A list including the probability of receiving instrument given baseline covariates named <code>fzl</code>, the probability of receiving treatment given baseline covariates and instrument equaling 0 named <code>fal0</code>, the probability of receiving treatment given baseline covariates and instrument equaling 1 named <code>fal1</code>, and the difference between fal1 and fal0 named <code>deltal</code>. <code><a href="#topic+Fps.DRKMEIV">Fps.DRKMEIV</a></code> can produce <code>ps</code> by positing logistic model.</p>
</td></tr>
<tr><td><code id="Genetic.optim.DRKMEIV_+3A_prep">prep</code></td>
<td>
<p>A list including estimates <code class="reqn">\hat{\gamma}_1(\boldsymbol{L};s)</code> with treatment all to 1 named <code>gamma.num.1</code> and all to 0 named <code>gamma.num.0</code>, <code class="reqn">\hat{\gamma}_1'(\boldsymbol{L};s)</code> with treatment all to 1 named <code>gammaa.num.1</code> and all to 0 named <code>gammaa.num.0</code>, <code class="reqn">\hat{\gamma}_2(\boldsymbol{L};s)</code> with treatment all to 1 named <code>gamma.den.1</code> and all to 0 named <code>gamma.den.0</code>, and <code class="reqn">\hat{\gamma}_2'(\boldsymbol{L};s)</code> with treatment all to 1 named <code>gammaa.den.1</code> and all to 0 named <code>gammaa.den.0</code>; <code>gamma.num.1</code> and the others are matrix with ordered observed time as rows and patients as columns. There are also estimates for the last term of the (S)DRKMEIV estimator. More details can be found in references. <code><a href="#topic+Fprep.DRKMEIV">Fprep.DRKMEIV</a></code> can produce <code>prep</code> by positing Cox proportional hazards model.</p>
</td></tr>
<tr><td><code id="Genetic.optim.DRKMEIV_+3A_t0">t0</code></td>
<td>
<p>A predetermined time to point out that t0-year survival probability is our estimate</p>
</td></tr>
<tr><td><code id="Genetic.optim.DRKMEIV_+3A_smooth">smooth</code></td>
<td>
<p>A logic variable indicating wether a smoothed version should be used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>More details can be found in references.
</p>


<h3>Value</h3>

<p>A numeric vector in which the last number is the estimated optimal t0-year survival probability and the others are the estimated parameter of the optimal treatment regime.
</p>


<h3>References</h3>

<p>Xia, J., Zhan, Z., Zhang, J. (2022) Estimating optimal treatment regime in survival contexts using an instrumental variable. Under Review.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load data
data(simulation)

# order the data by observed time and select the first 200 patients to speed up 
simulation=simulation[order(simulation$Survival)[1:200],]

# convert the data into a datalist
datalist=list(z=simulation$Instrument,a=simulation$Treatment,
              obs.t=simulation$Survival,delta=simulation$Status,
              l=cbind(simulation$Covariate1,simulation$Covariate2))

# predetermined t0
t0=1

# calculate ps and prep
ps=Fps.DRKMEIV(datalist, t0)
prep=Fprep.DRKMEIV(datalist, ps, t0)


Genetic.optim.DRKMEIV(datalist, ps, prep, t0, smooth=TRUE)
</code></pre>

<hr>
<h2 id='Genetic.optim.IWKME'>The optimal treatment regime based on the (S)IWKME estimator.</h2><span id='topic+Genetic.optim.IWKME'></span>

<h3>Description</h3>

<p>Given a predetermined t0, estimate the optimal treatment regime by maximizing t0-year survival probability based on the (S)IWKME estimator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Genetic.optim.IWKME(datalist, ps, t0, smooth = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Genetic.optim.IWKME_+3A_datalist">datalist</code></td>
<td>
<p>A list used to calculate the (S)IWKME estimator including treatment named <code>a</code>, observed time named <code>obs.t</code>, censoring indicator (0, censored) named <code>delta</code>, and baseline covariates used to assign treatment named <code>l</code>. Notice that all the data in the datalist should be ordered by observed time.</p>
</td></tr>
<tr><td><code id="Genetic.optim.IWKME_+3A_ps">ps</code></td>
<td>
<p>A list including the probability of receiving treatment given baseline covariates named <code>fal</code>. <code><a href="#topic+Fps.IWKME">Fps.IWKME</a></code> can produce <code>ps</code> by positing logistic model.</p>
</td></tr>
<tr><td><code id="Genetic.optim.IWKME_+3A_t0">t0</code></td>
<td>
<p>A predetermined time.</p>
</td></tr>
<tr><td><code id="Genetic.optim.IWKME_+3A_smooth">smooth</code></td>
<td>
<p>A logic variable indicating wether a smoothed version should be used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>More details can be found in references.
</p>


<h3>Value</h3>

<p>A numeric vector in which the last number is the estimated optimal t0-year survival probability and the others are the estimated parameter of the optimal treatment regime.
</p>


<h3>References</h3>

<p>Jiang, R., Lu, W., Song, R., and Davidian, M. (2017) On estimation of optimal treatment regimes for maximizing t‚Äêyear survival probability. <em>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</em>, <b>79:</b> 1165-1185. DOI:10.1111/rssb.12201
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load data
data(simulation)
simulation=simulation[order(simulation$Survival),]

# convert the data into a datalist
datalist=list(z=simulation$Instrument,a=simulation$Treatment,
              obs.t=simulation$Survival,delta=simulation$Status,
              l=cbind(simulation$Covariate1,simulation$Covariate2))

# predetermined t0
t0=5

# calculate ps
ps=Fps.IWKME(datalist)

Genetic.optim.IWKME(datalist, ps, t0, smooth=TRUE)
</code></pre>

<hr>
<h2 id='Genetic.optim.IWKMEIV'>The optimal treatment regime based on the (S)IWKMEIV estimator.</h2><span id='topic+Genetic.optim.IWKMEIV'></span>

<h3>Description</h3>

<p>Given a predetermined t0, estimate the optimal treatment regime by maximizing t0-year survival probability based on the (S)IWKMEIV estimator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Genetic.optim.IWKMEIV(datalist, ps, t0, smooth = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Genetic.optim.IWKMEIV_+3A_datalist">datalist</code></td>
<td>
<p>A list used to calculate the (S)IWKMEIV estimator including instrument named z, treatment named <code>a</code>, observed time named <code>obs.t</code>, censoring indicator (0, censored) named <code>delta</code>, and baseline covariates used to assign treatment named <code>l</code>. Notice that all the data in the datalist should be ordered by observed time.</p>
</td></tr>
<tr><td><code id="Genetic.optim.IWKMEIV_+3A_ps">ps</code></td>
<td>
<p>A list including the probability of receiving instrument given baseline covariates named <code>fzl</code> and the difference between fal1 and fal0 named <code>deltal</code>, where fal0 denotes the probability of receiving treatment given baseline covariates and instrument equaling 0, and fal1 denotes the probability of receiving treatment given baseline covariates and instrument equaling 1. <code><a href="#topic+Fps.IWKMEIV">Fps.IWKMEIV</a></code> can produce <code>ps</code> by positing logistic model.</p>
</td></tr>
<tr><td><code id="Genetic.optim.IWKMEIV_+3A_t0">t0</code></td>
<td>
<p>A predetermined time.</p>
</td></tr>
<tr><td><code id="Genetic.optim.IWKMEIV_+3A_smooth">smooth</code></td>
<td>
<p>A logic variable indicating wether a smoothed version should be used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>More details can be found in references.
</p>


<h3>Value</h3>

<p>A numeric vector in which the last number is the estimated optimal t0-year survival probability and others are the estimated parameter of the optimal treatment regime.
</p>


<h3>References</h3>

<p>Xia, J., Zhan, Z., Zhang, J. (2022) Estimating optimal treatment regime in survival contexts using an instrumental variable. Under Review.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load data
data(simulation)
simulation=simulation[order(simulation$Survival),]

# convert the data into a datalist
datalist=list(z=simulation$Instrument,a=simulation$Treatment,
              obs.t=simulation$Survival,delta=simulation$Status,
              l=cbind(simulation$Covariate1,simulation$Covariate2))

# predetermined t0
t0=1

# calculate ps and prep
ps=Fps.IWKMEIV(datalist, t0)

Genetic.optim.IWKMEIV(datalist, ps, t0, smooth=TRUE)
</code></pre>

<hr>
<h2 id='IWKME'>The (S)IWKME estimator.</h2><span id='topic+IWKME'></span>

<h3>Description</h3>

<p>Given a predetermined t0 and eta, calculate t0-year potential survival probability based on the (S)IWKME estimator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IWKME(eta, datalist, ps, t0, smooth = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="IWKME_+3A_eta">eta</code></td>
<td>
<p>The parameters of the regime.</p>
</td></tr>
<tr><td><code id="IWKME_+3A_datalist">datalist</code></td>
<td>
<p>A list used to calculate the (S)IWKME estimator including treatment named <code>a</code>, observed time named <code>obs.t</code>, censoring indicator (0, censored) named <code>delta</code>, and baseline covariates used to assign treatment named <code>l</code>. <code><a href="#topic+Fps.IWKME">Fps.IWKME</a></code> can produce <code>ps</code> by positing logistic model. Notice that all the data in the datalist should be ordered by observed time.</p>
</td></tr>
<tr><td><code id="IWKME_+3A_ps">ps</code></td>
<td>
<p>A list including the probability of receiving treatment given baseline covariates named <code>fal</code>.</p>
</td></tr>
<tr><td><code id="IWKME_+3A_t0">t0</code></td>
<td>
<p>A predetermined time.</p>
</td></tr>
<tr><td><code id="IWKME_+3A_smooth">smooth</code></td>
<td>
<p>A logic variable indicating wether a smoothed estimator should be used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>More details can be found in references.
</p>


<h3>Value</h3>

<p>Estimated potential survival probability given eta and t0.
</p>


<h3>References</h3>

<p>Jiang, R., Lu, W., Song, R., and Davidian, M. (2017) On estimation of optimal treatment regimes for maximizing t‚Äêyear survival probability. <em>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</em>, <b>79:</b> 1165-1185. DOI:10.1111/rssb.12201
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load data
data(simulation)
simulation=simulation[order(simulation$Survival),]

# convert the data into a datalist
datalist=list(z=simulation$Instrument,a=simulation$Treatment,
              obs.t=simulation$Survival,delta=simulation$Status,
              l=cbind(simulation$Covariate1,simulation$Covariate2))

# calculate ps
ps=Fps.IWKME(datalist)

# predetermined t0 and eta
t0=5
eta=c(1,2,3)

IWKME(eta, datalist, ps, t0, smooth=TRUE)
</code></pre>

<hr>
<h2 id='IWKMEIV'>The (S)IWKMEIV estimator.</h2><span id='topic+IWKMEIV'></span>

<h3>Description</h3>

<p>Given a predetermined t0 and eta, calculate t0-year potential survival probability based on the (S)IWKMEIV estimator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IWKMEIV(eta, datalist, ps, t0, smooth = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="IWKMEIV_+3A_eta">eta</code></td>
<td>
<p>The parameters of the regime.</p>
</td></tr>
<tr><td><code id="IWKMEIV_+3A_datalist">datalist</code></td>
<td>
<p>A list used to calculate the (S)IWKMEIV estimator including treatment named <code>a</code>, observed time named <code>obs.t</code>, censoring indicator (0, censored) named <code>delta</code>, and baseline covariates used to assign treatment named <code>l</code>. Notice that all the data in the datalist should be ordered by observed time.</p>
</td></tr>
<tr><td><code id="IWKMEIV_+3A_ps">ps</code></td>
<td>
<p>A list including the probability of receiving instrument given baseline covariates named <code>fzl</code> and the difference between fal1 and fal0 named <code>deltal</code>, where fal0 denotes the probability of receiving treatment given baseline covariates and instrument equaling 0, and fal1 denotes the probability of receiving treatment given baseline covariates and instrument equaling 1. <code><a href="#topic+Fps.IWKMEIV">Fps.IWKMEIV</a></code> can produce <code>ps</code> by positing logistic model.</p>
</td></tr>
<tr><td><code id="IWKMEIV_+3A_t0">t0</code></td>
<td>
<p>A predetermined time.</p>
</td></tr>
<tr><td><code id="IWKMEIV_+3A_smooth">smooth</code></td>
<td>
<p>A logic variable indicating wether a smoothed version should be used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>More details can be found in references.
</p>


<h3>Value</h3>

<p>Estimated potential survival probability given eta and t0.
</p>


<h3>References</h3>

<p>Xia, J., Zhan, Z., Zhang, J. (2022) Estimating optimal treatment regime in survival contexts using an instrumental variable. Under Review.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load data
data(simulation)
simulation=simulation[order(simulation$Survival),]

# convert the data into a datalist
datalist=list(z=simulation$Instrument,a=simulation$Treatment,
              obs.t=simulation$Survival,delta=simulation$Status,
              l=cbind(simulation$Covariate1,simulation$Covariate2))

# predetermined t0 and eta
t0=5
eta=c(1,2,3)

# calculate ps and prep
ps=Fps.IWKMEIV(datalist, t0)

IWKMEIV(eta, datalist, ps, t0, smooth=TRUE)
</code></pre>

<hr>
<h2 id='simulation'>Simulation</h2><span id='topic+simulation'></span>

<h3>Description</h3>

<p>A simulation data to help understand and implement the functions in the package. 'Instrument' denotes the binary instrumental variable. 'Treatment' denotes the binary treatment. 'Survival' denotes the observed survival time. 'Status' denotes whether the the data is censoring where '0' means censoring. 'Covariate' denotes the baseline characteristics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulation
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 500 rows and 6 columns.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  head(simulation)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
