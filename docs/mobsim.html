<!DOCTYPE html><html><head><title>Help for package mobsim</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {mobsim}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#mobsim-package'><p>mobsim: A package for spatial analysis of scale-dependent biodiversity changes.</p></a></li>
<li><a href='#abund_rect'><p>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;</p>
Get local species abundance distribution</a></li>
<li><a href='#community'><p>Create spatial community object</p></a></li>
<li><a href='#community_to_sad'><p>Get species abundance distribution from community object</p></a></li>
<li><a href='#dist_decay'><p>Distance decay of similarity</p></a></li>
<li><a href='#dist_decay_quadrats'><p>Distance decay of similarity with user-defined quadrats</p></a></li>
<li><a href='#div_rand_rect'><p>Distribution of local diversity indices</p></a></li>
<li><a href='#div_rect'><p>Get local diversity indices</p></a></li>
<li><a href='#divar'><p>Diversity-area relationships</p></a></li>
<li><a href='#plot.community'><p>Plot spatial community object</p></a></li>
<li><a href='#plot.dist_decay'><p>Plot distance decay of similarity</p></a></li>
<li><a href='#plot.divar'><p>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;</p>
Plot diversity-area relationships</a></li>
<li><a href='#plot.sad'><p>Plot species abundance distributions</p></a></li>
<li><a href='#plot.spec_sample_curve'><p>Plot species sampling curves</p></a></li>
<li><a href='#rare_curve'><p>Species rarefaction curve</p></a></li>
<li><a href='#rThomas_rcpp'><p>Thomas process individual distribution simulation for one species</p></a></li>
<li><a href='#sample_quadrats'><p>Plot-based samples from a spatially-explicit census</p></a></li>
<li><a href='#sampling_grids'><p>Creates square quadrats aligned on a regular grid</p></a></li>
<li><a href='#sampling_one_quadrat'><p>Creates one square quadrat randomly located in the landscape</p></a></li>
<li><a href='#sampling_random_bruteforce'><p>Creates coordinates (lower left corner of a quadrat) randomly distributed but without overlapping each</p>
other</a></li>
<li><a href='#sampling_random_overlap'><p>Creates coordinates (lower left corner of a quadrat) randomly distributed</p>
that may overlap each other</a></li>
<li><a href='#sampling_random_spatstat'><p>Creates coordinates (lower left corner of a quadrat) randomly distributed but</p>
without overlapping each other</a></li>
<li><a href='#sampling_transects'><p>Creates square quadrats aligned along a transect</p></a></li>
<li><a href='#sim_poisson_community'><p>Simulate community with random spatial positions.</p></a></li>
<li><a href='#sim_poisson_coords'><p>Simulate random spatial coordinates</p></a></li>
<li><a href='#sim_sad'><p>Simulate species abundance distributions</p></a></li>
<li><a href='#sim_thomas_community'><p>Simulate community with clumped spatial positions.</p></a></li>
<li><a href='#sim_thomas_coords'><p>Simulate clumped spatial coordinates</p></a></li>
<li><a href='#spec_sample'><p>Sample species richness</p></a></li>
<li><a href='#spec_sample_curve'><p>Non-spatial and spatially-explicit species sampling curves</p></a></li>
<li><a href='#summary.community'><p>Print summary of spatial community object</p></a></li>
<li><a href='#summary.sad'><p>Print summary of species abundance distribution object</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Spatial Simulation and Scale-Dependent Analysis of Biodiversity
Changes</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-03-11</td>
</tr>
<tr>
<td>Description:</td>
<td>Simulation, analysis and sampling of spatial
    biodiversity data (May, Gerstner, McGlinn, Xiao &amp; Chase 2017)
    &lt;<a href="https://doi.org/10.1111%2F2041-210x.12986">doi:10.1111/2041-210x.12986</a>&gt;.
    In the simulation tools user define the numbers of
    species and individuals, the species abundance distribution and species
    aggregation. Functions for analysis include species rarefaction 
    and accumulation curves, species-area relationships and the distance
    decay of similarity. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp, vegan, sads (&ge; 0.4.1), grDevices, utils, graphics,
stats, methods</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rmarkdown, spatstat.geom, spatstat.random, testthat (&ge;
3.0.0), mockery, knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Config/testthat/parallel:</td>
<td>true</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Language:</td>
<td>en-GB</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/MoBiodiv/mobsim">https://github.com/MoBiodiv/mobsim</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/MoBiodiv/mobsim/issues">https://github.com/MoBiodiv/mobsim/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-22 07:31:20 UTC; felix</td>
</tr>
<tr>
<td>Author:</td>
<td>Felix May <a href="https://orcid.org/0000-0002-1106-8188"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre, cph],
  Alban Sagouis <a href="https://orcid.org/0000-0002-3827-1063"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Felix May &lt;felix.may@fu-berlin.de&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-22 20:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='mobsim-package'>mobsim: A package for spatial analysis of scale-dependent biodiversity changes.</h2><span id='topic+mobsim'></span><span id='topic+mobsim-package'></span>

<h3>Description</h3>

<p>The package includes functions to simulate species distributions in space
as well as for the analysis of spatially-explicit data, where each individual
is described by its xy-coordinates and a species identity label.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Felix May <a href="mailto:felix.may@fu-berlin.de">felix.may@fu-berlin.de</a> (<a href="https://orcid.org/0000-0002-1106-8188">ORCID</a>) [copyright holder]
</p>
<p>Authors:
</p>

<ul>
<li><p> Alban Sagouis <a href="mailto:alban.sagouis@idiv.de">alban.sagouis@idiv.de</a> (<a href="https://orcid.org/0000-0002-3827-1063">ORCID</a>)
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/MoBiodiv/mobsim">https://github.com/MoBiodiv/mobsim</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/MoBiodiv/mobsim/issues">https://github.com/MoBiodiv/mobsim/issues</a>
</p>
</li></ul>


<hr>
<h2 id='abund_rect'>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;
Get local species abundance distribution</h2><span id='topic+abund_rect'></span>

<h3>Description</h3>

<p>Get local abundance distribution in rectangle bounded by x0, y0, x0 + xsize,
y0 + ysize
</p>


<h3>Usage</h3>

<pre><code class='language-R'>abund_rect(x0, y0, xsize, ysize, comm)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="abund_rect_+3A_x0">x0</code></td>
<td>
<p>x-coordinate of lower left corner</p>
</td></tr>
<tr><td><code id="abund_rect_+3A_y0">y0</code></td>
<td>
<p>y-coordinate of lower left corner</p>
</td></tr>
<tr><td><code id="abund_rect_+3A_xsize">xsize</code></td>
<td>
<p>Size of the subplot in x-direction</p>
</td></tr>
<tr><td><code id="abund_rect_+3A_ysize">ysize</code></td>
<td>
<p>Size of the subplot in y-direction</p>
</td></tr>
<tr><td><code id="abund_rect_+3A_comm">comm</code></td>
<td>
<p><code><a href="#topic+community">community</a></code> object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Integer vector with local species abundances
</p>

<hr>
<h2 id='community'>Create spatial community object</h2><span id='topic+community'></span>

<h3>Description</h3>

<p>Creates a spatial community object with defined extent and with coordinates
and species identities of all individuals in the community.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>community(x, y, spec_id, xrange = c(0, 1), yrange = c(0, 1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="community_+3A_x">x</code>, <code id="community_+3A_y">y</code></td>
<td>
<p>Coordinates of individuals (numeric)</p>
</td></tr>
<tr><td><code id="community_+3A_spec_id">spec_id</code></td>
<td>
<p>Species names or IDs; can be integers, characters or factors</p>
</td></tr>
<tr><td><code id="community_+3A_xrange">xrange</code></td>
<td>
<p>Extent of the community in x-direction (numeric vector of length 2)</p>
</td></tr>
<tr><td><code id="community_+3A_yrange">yrange</code></td>
<td>
<p>Extent of the community in y-direction (numeric vector of length 2)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Community object which includes three items:
</p>

<ol>
<li><p> census: data.frame with three columns: x, y, and species names for
each individual
</p>
</li>
<li><p> x_min_max: extent of the community in x-direction
</p>
</li>
<li><p> y_min_max: extent of the community in y-direction
</p>
</li></ol>



<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- runif(100)
y &lt;- runif(100)
species_names &lt;- rep(paste("species",1:10, sep = ""), each = 10)

com1 &lt;- community(x,y, species_names)
plot(com1)
summary(com1)

</code></pre>

<hr>
<h2 id='community_to_sad'>Get species abundance distribution from community object</h2><span id='topic+community_to_sad'></span>

<h3>Description</h3>

<p>Get species abundance distribution from community object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>community_to_sad(comm)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="community_to_sad_+3A_comm">comm</code></td>
<td>
<p>Community object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class <code>sad</code>, which contains a named integer vector
with species abundances
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sim1 &lt;- sim_poisson_community(s_pool = 200, n_sim = 20000, sad_type = "lnorm",
                              sad_coef = list("cv_abund" = 2))
sad1 &lt;- community_to_sad(sim1)
plot(sad1, method = "rank")
plot(sad1, method = "octave")

</code></pre>

<hr>
<h2 id='dist_decay'>Distance decay of similarity</h2><span id='topic+dist_decay'></span>

<h3>Description</h3>

<p>Estimate pairwise similarities of communities in subplots as
function of distance
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dist_decay(
  comm,
  prop_area = 0.005,
  n_samples = 20,
  method = "bray",
  binary = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dist_decay_+3A_comm">comm</code></td>
<td>
<p><code><a href="#topic+community">community</a></code> object</p>
</td></tr>
<tr><td><code id="dist_decay_+3A_prop_area">prop_area</code></td>
<td>
<p>Subplot size as proportion of the total area</p>
</td></tr>
<tr><td><code id="dist_decay_+3A_n_samples">n_samples</code></td>
<td>
<p>Number of randomly located subplots</p>
</td></tr>
<tr><td><code id="dist_decay_+3A_method">method</code></td>
<td>
<p>Choice of (dis)similarity index. See <code><a href="vegan.html#topic+vegdist">vegdist</a></code></p>
</td></tr>
<tr><td><code id="dist_decay_+3A_binary">binary</code></td>
<td>
<p>Perform presence/absence standardization before analysis?
See <code><a href="vegan.html#topic+vegdist">vegdist</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class  <code>dist_decay</code>: a dataframe with distances between
subplot pairs and the respective similarity indices.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sim_com1 &lt;- sim_thomas_community(100, 10000, sigma = 0.1, mother_points = 2)
dd1 &lt;- dist_decay(sim_com1, prop_area = 0.005, n_samples = 20)
plot(dd1)

</code></pre>

<hr>
<h2 id='dist_decay_quadrats'>Distance decay of similarity with user-defined quadrats</h2><span id='topic+dist_decay_quadrats'></span>

<h3>Description</h3>

<p>Estimate pairwise similarities of communities in quadrats as
function of distance. The function allows the user to compute
distance decay between the quadrats of his/her choice.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dist_decay_quadrats(samples, method = "bray", binary = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dist_decay_quadrats_+3A_samples">samples</code></td>
<td>
<p>A list given by <code><a href="#topic+sample_quadrats">sample_quadrats</a></code></p>
</td></tr>
<tr><td><code id="dist_decay_quadrats_+3A_method">method</code></td>
<td>
<p>Choice of (dis)similarity index. See <code><a href="vegan.html#topic+vegdist">vegdist</a></code></p>
</td></tr>
<tr><td><code id="dist_decay_quadrats_+3A_binary">binary</code></td>
<td>
<p>Perform presence/absence standardization before analysis?
See <code><a href="vegan.html#topic+vegdist">vegdist</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class  <code>dist_decay</code>: a dataframe with distances between
subplot pairs and the respective similarity indices.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sim_com1 &lt;- sim_thomas_community(100, 10000, sigma = 0.1, mother_points = 2)
oldpar&lt;- par(mfrow=c(1,2))
samples &lt;- sample_quadrats(sim_com1, avoid_overlap = TRUE, quadrat_area=.005,
                           n_quadrats = 50, plot = TRUE)
dd_quadrats &lt;- dist_decay_quadrats(samples)
plot(dd_quadrats)
par(oldpar)

</code></pre>

<hr>
<h2 id='div_rand_rect'>Distribution of local diversity indices</h2><span id='topic+div_rand_rect'></span>

<h3>Description</h3>

<p>Get mean and standard deviation of diversity indices in several equally
sized subplots of a community
</p>


<h3>Usage</h3>

<pre><code class='language-R'>div_rand_rect(prop_area = 0.25, comm, n_rect = 100, exclude_zeros = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="div_rand_rect_+3A_prop_area">prop_area</code></td>
<td>
<p>Size of subplots as proportion of the total area</p>
</td></tr>
<tr><td><code id="div_rand_rect_+3A_comm">comm</code></td>
<td>
<p><code><a href="#topic+community">community</a></code> object</p>
</td></tr>
<tr><td><code id="div_rand_rect_+3A_n_rect">n_rect</code></td>
<td>
<p>Number of randomly located subplots</p>
</td></tr>
<tr><td><code id="div_rand_rect_+3A_exclude_zeros">exclude_zeros</code></td>
<td>
<p>Should subplots without individuals be excluded? (logical)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector with mean and standard deviation of the following diversity
indices:
</p>

<ol>
<li><p> Number of species
</p>
</li>
<li><p> Number of endemics
</p>
</li>
<li><p> Shannon index
</p>
</li>
<li><p> Effective number of species (ENS) based on Shannon index
</p>
</li>
<li><p> Simpson index
</p>
</li>
<li><p> Effective number of species (ENS) based on Simpson index
</p>
</li></ol>

<p>See the documentation of  <code><a href="#topic+div_rect">div_rect</a></code> for detailed information on the
definition of the diversity indices.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sim1 &lt;- sim_poisson_community(100,1000)
div_rand_rect(prop_area = 0.1, comm = sim1)


</code></pre>

<hr>
<h2 id='div_rect'>Get local diversity indices</h2><span id='topic+div_rect'></span>

<h3>Description</h3>

<p>Get diversity indices including species richness, no. of endemics,
Shannon and Simpson diversity for one rectangle subplot in the community.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>div_rect(x0, y0, xsize, ysize, comm)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="div_rect_+3A_x0">x0</code></td>
<td>
<p>x-coordinate of lower left corner</p>
</td></tr>
<tr><td><code id="div_rect_+3A_y0">y0</code></td>
<td>
<p>y-coordinate of lower left corner</p>
</td></tr>
<tr><td><code id="div_rect_+3A_xsize">xsize</code></td>
<td>
<p>Size of the subplot in x-direction</p>
</td></tr>
<tr><td><code id="div_rect_+3A_ysize">ysize</code></td>
<td>
<p>Size of the subplot in y-direction</p>
</td></tr>
<tr><td><code id="div_rect_+3A_comm">comm</code></td>
<td>
<p><code><a href="#topic+community">community</a></code> object</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The effective number of species is defined as the number of equally
abundant species that produce the same value of a certain diversity index
as an observed community (Jost 2006). According to Chao et al. 2014 and
Chiu et al. 20 ENS_shannon
can be interpreted as the number of common species and ENS_simpson as the
number of dominant species in a community.
</p>


<h3>Value</h3>

<p>Named vector with six diversity indices
</p>

<ol>
<li><p> n_species: Number of species
</p>
</li>
<li><p> n_endemics: Number of endemics
</p>
</li>
<li><p> shannon: Shannon index index defined as <code class="reqn">H = - \sum p_i * log(p_i)</code>,
where <code class="reqn">p_i</code> is the relative abundance of species i:
</p>
</li>
<li><p> ens_shannon: Effective number of species (ENS) based on the Shannon index exp(H)
</p>
</li>
<li><p> simpson: Simpson index index (= probability of interspecific encounter PIE)
defined as <code class="reqn">D =  1 - \sum p_i^2</code>
</p>
</li>
<li><p> ens_simpson: Effective number of species (ENS) based on the Simpson index <code class="reqn">1/D</code>
</p>
</li></ol>



<h3>References</h3>

<p>Jost 2006. Entropy and diversity. Oikos, 113, 363-375.
</p>
<p>Chao et al. 2014. Rarefaction and extrapolation with Hill numbers: a framework
for sampling and estimation in species diversity studies.
Ecological Monographs, 84, 45-67.
</p>
<p>Hsieh et al. 2016. iNEXT: an R package for rarefaction and extrapolation of
species diversity (Hill numbers). Methods Ecol Evol, 7, 1451-1456.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sim1 &lt;- sim_poisson_community(100,1000)
div_rect(0, 0, 0.3, 0.3, sim1)

</code></pre>

<hr>
<h2 id='divar'>Diversity-area relationships</h2><span id='topic+divar'></span>

<h3>Description</h3>

<p>Estimate diversity indices in subplots of different sizes. This includes the
well-known species-area and endemics-area relationships.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>divar(
  comm,
  prop_area = seq(0.1, 1, by = 0.1),
  n_samples = 100,
  exclude_zeros = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="divar_+3A_comm">comm</code></td>
<td>
<p><code><a href="#topic+community">community</a></code> object</p>
</td></tr>
<tr><td><code id="divar_+3A_prop_area">prop_area</code></td>
<td>
<p>Subplot sizes as proportion of the total area (numeric)</p>
</td></tr>
<tr><td><code id="divar_+3A_n_samples">n_samples</code></td>
<td>
<p>Number of randomly located subplots per subplot size (single integer)</p>
</td></tr>
<tr><td><code id="divar_+3A_exclude_zeros">exclude_zeros</code></td>
<td>
<p>Should subplots without individuals be excluded? (logical)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Dataframe with the proportional area of the subplots and mean and
standard deviation of the following diversity indices:
</p>

<ol>
<li><p> Number of species
</p>
</li>
<li><p> Number of endemics
</p>
</li>
<li><p> Shannon index
</p>
</li>
<li><p> Effective number of species (ENS) based on Shannon index
</p>
</li>
<li><p> Simpson index
</p>
</li>
<li><p> Effective number of species (ENS) based on Simpson index
</p>
</li></ol>

<p>See the documentation of  <code><a href="#topic+div_rect">div_rect</a></code> for detailed information on the
definition of the diversity indices.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+div_rand_rect">div_rand_rect</a></code>, <code><a href="#topic+div_rect">div_rect</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sim1 &lt;- sim_thomas_community(100, 1000)
divar1 &lt;- divar(sim1, prop_area = seq(0.01, 1.0, length = 20))
plot(divar1)

</code></pre>

<hr>
<h2 id='plot.community'>Plot spatial community object</h2><span id='topic+plot.community'></span>

<h3>Description</h3>

<p>Plot positions and species identities of all individuals in a community object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'community'
plot(x, ..., col = NULL, pch = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.community_+3A_x">x</code></td>
<td>
<p>Community object</p>
</td></tr>
<tr><td><code id="plot.community_+3A_...">...</code></td>
<td>
<p>Other parameters to <code><a href="graphics.html#topic+plot.default">graphics::plot</a></code></p>
</td></tr>
<tr><td><code id="plot.community_+3A_col">col</code></td>
<td>
<p>Colour vector to mark species identities</p>
</td></tr>
<tr><td><code id="plot.community_+3A_pch">pch</code></td>
<td>
<p>Plotting character to mark species identities. pch 16 is advised for large datasets</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function is called for its side effects and has no return value.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sim1 &lt;- sim_thomas_community(30, 500)
plot(sim1)

</code></pre>

<hr>
<h2 id='plot.dist_decay'>Plot distance decay of similarity</h2><span id='topic+plot.dist_decay'></span>

<h3>Description</h3>

<p>Plot distance decay of similarity
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dist_decay'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.dist_decay_+3A_x">x</code></td>
<td>
<p>Dataframe generated by <code><a href="#topic+dist_decay">dist_decay</a></code></p>
</td></tr>
<tr><td><code id="plot.dist_decay_+3A_...">...</code></td>
<td>
<p>Additional graphical parameters used in <code><a href="graphics.html#topic+plot.default">praphics::plot</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function plots the similarity indices between all pairs of
subplots as function of distance. To indicate the relationship a
<code><a href="stats.html#topic+loess">stats::loess</a></code> smoother is added to the plot.
</p>


<h3>Value</h3>

<p>This function is called for its side effects and has no return value.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sim_com1 &lt;- sim_thomas_community(100, 10000)
dd1 &lt;- dist_decay(sim_com1)
plot(dd1)

</code></pre>

<hr>
<h2 id='plot.divar'>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;
Plot diversity-area relationships</h2><span id='topic+plot.divar'></span>

<h3>Description</h3>

<p>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;
Plot diversity-area relationships
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'divar'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.divar_+3A_x">x</code></td>
<td>
<p>Dataframe generated by the function <code><a href="#topic+divar">divar</a></code>.</p>
</td></tr>
<tr><td><code id="plot.divar_+3A_...">...</code></td>
<td>
<p>Additional graphical parameters used in <code><a href="graphics.html#topic+plot.default">graphics::plot</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function is called for its side effects and has no return value.
</p>

<hr>
<h2 id='plot.sad'>Plot species abundance distributions</h2><span id='topic+plot.sad'></span>

<h3>Description</h3>

<p>Plot species abundance distributions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'sad'
plot(x, ..., method = c("octave", "rank"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.sad_+3A_x">x</code></td>
<td>
<p>Vector with species abundances (integer vector)</p>
</td></tr>
<tr><td><code id="plot.sad_+3A_...">...</code></td>
<td>
<p>Additional graphical parameters used in <code><a href="graphics.html#topic+plot.default">graphics::plot</a></code>
or <code><a href="graphics.html#topic+barplot">barplot</a></code></p>
</td></tr>
<tr><td><code id="plot.sad_+3A_method">method</code></td>
<td>
<p>Plotting method, partial match to <code>"octave"</code> or <code>"rank"</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>With <code>method = "octave"</code> a histogram showing the number
species in several abundance classes is generated. The abundance class
are a simplified version of the &quot;octaves&quot; suggested by Preston (1948), which
are based on log2-binning. The first abundance class includes species
with 1 individual, the second with 2, the third with 3-4, the fourth with 5-8, etc.
</p>
<p>With <code>method = "rank"</code> rank-abundance curve is generated with
species abundance rank on the x-axis (descending) and species abundance on
the y-axis (Hubbell 2001).
</p>


<h3>Value</h3>

<p>This function is called for its side effects and has no return value.
</p>


<h3>References</h3>

<p>Preston 1948. The Commonness, and rarity, of species. Ecology 29(3):254-283.
</p>
<p>Hubbell 2001. The unified neutral theory of biodiversity and biogeography.
Princeton University Press.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>abund1 &lt;- sim_sad(s_pool = 100, n_sim = 10000, sad_type = "lnorm",
                  sad_coef = list("cv_abund" = 1))
plot(abund1, method = "octave")
plot(abund1, method = "rank")

</code></pre>

<hr>
<h2 id='plot.spec_sample_curve'>Plot species sampling curves</h2><span id='topic+plot.spec_sample_curve'></span>

<h3>Description</h3>

<p>Plot species sampling curves
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'spec_sample_curve'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.spec_sample_curve_+3A_x">x</code></td>
<td>
<p>Species sampling curve generated by <code><a href="#topic+spec_sample_curve">spec_sample_curve</a></code></p>
</td></tr>
<tr><td><code id="plot.spec_sample_curve_+3A_...">...</code></td>
<td>
<p>Additional graphical parameters used in <code><a href="graphics.html#topic+plot.default">graphics::plot</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function is called for its side effects and has no return value.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sim_com1 &lt;- sim_thomas_community(s_pool = 100, n_sim = 1000)
sac1 &lt;- spec_sample_curve(sim_com1, method = c("rare","acc"))
plot(sac1)

</code></pre>

<hr>
<h2 id='rare_curve'>Species rarefaction curve</h2><span id='topic+rare_curve'></span>

<h3>Description</h3>

<p>Expected species richness as a function of sample size
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rare_curve(abund_vec)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rare_curve_+3A_abund_vec">abund_vec</code></td>
<td>
<p>Species abundance distribution of the community (integer vector)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function essentially evaluates <code><a href="#topic+spec_sample">spec_sample</a></code> for
sample sizes from 1 to <code>sum(abund_vec)</code>. It is similar to the function
<code><a href="vegan.html#topic+rarefy">vegan:rarecurve</a></code> in the R package <code><a href="vegan.html#topic+vegan">vegan</a></code>.
</p>


<h3>Value</h3>

<p>Numeric Vector with expected species richness in samples of 1, 2, 3 ... n individuals
</p>


<h3>References</h3>

<p>Gotelli &amp; Colwell 2001. Quantifying biodiversity: procedures and pitfalls
in the measurement and comparison of species richness. Ecology Letters 4, 379&ndash;391.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sad1 &lt;- sim_sad(100, 2000, sad_type = "lnorm", sad_coef = list("meanlog" = 2,
                                                                "sdlog" = 1))
rc1 &lt;- rare_curve(sad1)
plot(rc1, type = "l", xlab = "Sample size", ylab = "Expected species richness")

</code></pre>

<hr>
<h2 id='rThomas_rcpp'>Thomas process individual distribution simulation for one species</h2><span id='topic+rThomas_rcpp'></span>

<h3>Description</h3>

<p>Usually used internally inside <code><a href="#topic+sim_thomas_coords">sim_thomas_coords</a></code>
This function randomly draws points (individuals) around one or several mother points using Rcpp.
The function is an efficient re-implementation of the rThomas function from the spatstat package.
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="rThomas_rcpp_+3A_n_points">n_points</code></td>
<td>
<p>The total number of points (individuals).</p>
</td></tr>
<tr><td><code id="rThomas_rcpp_+3A_n_mother_points">n_mother_points</code></td>
<td>
<p>Number of mother points (= cluster centres).</p>
</td></tr>
<tr><td><code id="rThomas_rcpp_+3A_xmother">xmother</code></td>
<td>
<p>Vector of <code>n_mother_points</code> x coordinates for the mother points.</p>
</td></tr>
<tr><td><code id="rThomas_rcpp_+3A_ymother">ymother</code></td>
<td>
<p>Vector of <code>n_mother_points</code> y coordinates for the mother points.</p>
</td></tr>
<tr><td><code id="rThomas_rcpp_+3A_sigma">sigma</code></td>
<td>
<p>Mean displacement (along each coordinate axes) of a point from
its mother point (= cluster centre).</p>
</td></tr>
<tr><td><code id="rThomas_rcpp_+3A_xmin">xmin</code></td>
<td>
<p>Left limit, <code>default</code>=0.</p>
</td></tr>
<tr><td><code id="rThomas_rcpp_+3A_xmax">xmax</code></td>
<td>
<p>Right limit, <code>default</code>=1.</p>
</td></tr>
<tr><td><code id="rThomas_rcpp_+3A_ymin">ymin</code></td>
<td>
<p>Bottom limit, <code>default</code>=0.</p>
</td></tr>
<tr><td><code id="rThomas_rcpp_+3A_ymax">ymax</code></td>
<td>
<p>Top limit, <code>default</code>=1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with x and y coordinates.
</p>


<h3>Author(s)</h3>

<p>Felix May, Alban Sagouis
</p>

<hr>
<h2 id='sample_quadrats'>Plot-based samples from a spatially-explicit census</h2><span id='topic+sample_quadrats'></span>

<h3>Description</h3>

<p>This function allows to sample quadratic subplots from a spatially-explicit
community. The output format are a sites x species abundance table and a
sites x xy-coordinates table. The sites x species abundance is
a classical data format used in community ecology. The table generated
can be for instance be further analysed with the package <code><a href="vegan.html#topic+vegan">vegan</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sample_quadrats(
  comm,
  n_quadrats = 20,
  quadrat_area = 0.01,
  plot = TRUE,
  method = "random",
  avoid_overlap = TRUE,
  x0 = 0,
  y0 = 0,
  delta_x = 0.1,
  delta_y = 0.1,
  seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sample_quadrats_+3A_comm">comm</code></td>
<td>
<p>Community object from which the samples are generated</p>
</td></tr>
<tr><td><code id="sample_quadrats_+3A_n_quadrats">n_quadrats</code></td>
<td>
<p>(integer) Number of sampling quadrats</p>
</td></tr>
<tr><td><code id="sample_quadrats_+3A_quadrat_area">quadrat_area</code></td>
<td>
<p>(numeric) Area of the sampling quadrats</p>
</td></tr>
<tr><td><code id="sample_quadrats_+3A_plot">plot</code></td>
<td>
<p>(logical) Should the sampling design be plotted? default to TRUE.</p>
</td></tr>
<tr><td><code id="sample_quadrats_+3A_method">method</code></td>
<td>
<p>(character) Available methods are <code>"random", "transect", "grid"</code></p>
</td></tr>
<tr><td><code id="sample_quadrats_+3A_avoid_overlap">avoid_overlap</code></td>
<td>
<p>(logical) For the random sampling try to generate a design
without overlap of quadrats . Default is TRUE.</p>
</td></tr>
<tr><td><code id="sample_quadrats_+3A_x0">x0</code>, <code id="sample_quadrats_+3A_y0">y0</code></td>
<td>
<p>(numeric value) Lower left corner of the first quadrat in transect and grid sampling</p>
</td></tr>
<tr><td><code id="sample_quadrats_+3A_delta_x">delta_x</code></td>
<td>
<p>(numeric value) Distance between consecutive quadrats in transect and grid sampling
in x-direction (the distance between the left sides is measured)</p>
</td></tr>
<tr><td><code id="sample_quadrats_+3A_delta_y">delta_y</code></td>
<td>
<p>(numeric value) Distance between consecutive quadrats in transect and grid sampling
in y-direction (the distance between the lower sides is measured)</p>
</td></tr>
<tr><td><code id="sample_quadrats_+3A_seed">seed</code></td>
<td>
<p>(integer) Any integer passed to <code>set.seed</code> for reproducibility.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with two items, <code>spec_dat</code> and <code>xy_dat</code>.
<code>spec_dat</code> is a data.frame with sampling quadrats in rows and species abundances
in columns, and <code>xy_dat</code> is a data.frame with sampling quadrats in rows
and the xy-coordinates of the quadrats (lower left corner) in columns.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(vegan)
sim_com1 &lt;- sim_poisson_community(100, 10000)
comm_mat1 &lt;- sample_quadrats(sim_com1, n_quadrats = 100,
quadrat_area = 0.002, method = "grid")
specnumber(comm_mat1$spec_dat)
diversity(comm_mat1$spec_dat, index = "shannon")

</code></pre>

<hr>
<h2 id='sampling_grids'>Creates square quadrats aligned on a regular grid</h2><span id='topic+sampling_grids'></span>

<h3>Description</h3>

<p>Creates square quadrats aligned on a regular grid
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sampling_grids(
  n_quadrats,
  xmin,
  xmax,
  ymin,
  ymax,
  x0,
  y0,
  delta_x,
  delta_y,
  quadrat_size
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sampling_grids_+3A_n_quadrats">n_quadrats</code></td>
<td>
<p>(integer) Number of sampling quadrats</p>
</td></tr>
<tr><td><code id="sampling_grids_+3A_xmin">xmin</code></td>
<td>
<p>(numeric) minimum possible value on the x axis a quadrat can cover.</p>
</td></tr>
<tr><td><code id="sampling_grids_+3A_xmax">xmax</code></td>
<td>
<p>(numeric) maximum possible value on the x axis a quadrat can cover.</p>
</td></tr>
<tr><td><code id="sampling_grids_+3A_ymin">ymin</code></td>
<td>
<p>(numeric) minimum possible value on the y axis a quadrat can cover.</p>
</td></tr>
<tr><td><code id="sampling_grids_+3A_ymax">ymax</code></td>
<td>
<p>(numeric) maximum possible value on the y axis a quadrat can cover.</p>
</td></tr>
<tr><td><code id="sampling_grids_+3A_x0">x0</code>, <code id="sampling_grids_+3A_y0">y0</code></td>
<td>
<p>(numeric value) Lower left corner of the first quadrat in transect and grid sampling</p>
</td></tr>
<tr><td><code id="sampling_grids_+3A_delta_x">delta_x</code></td>
<td>
<p>(numeric value) Distance between consecutive quadrats in transect and grid sampling
in x-direction (the distance between the left sides is measured)</p>
</td></tr>
<tr><td><code id="sampling_grids_+3A_delta_y">delta_y</code></td>
<td>
<p>(numeric value) Distance between consecutive quadrats in transect and grid sampling
in y-direction (the distance between the lower sides is measured)</p>
</td></tr>
<tr><td><code id="sampling_grids_+3A_quadrat_size">quadrat_size</code></td>
<td>
<p>(numeric) width of the quadrats.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame with 2 columns x and y giving  the coordinates of the
lower left corner of the square quadrats.
</p>

<hr>
<h2 id='sampling_one_quadrat'>Creates one square quadrat randomly located in the landscape</h2><span id='topic+sampling_one_quadrat'></span>

<h3>Description</h3>

<p>Creates one square quadrat randomly located in the landscape
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sampling_one_quadrat(xmin, xmax, ymin, ymax, seed = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sampling_one_quadrat_+3A_xmin">xmin</code></td>
<td>
<p>(numeric) minimum possible value on the x axis a quadrat can cover.</p>
</td></tr>
<tr><td><code id="sampling_one_quadrat_+3A_xmax">xmax</code></td>
<td>
<p>(numeric) maximum possible value on the x axis a quadrat can cover.</p>
</td></tr>
<tr><td><code id="sampling_one_quadrat_+3A_ymin">ymin</code></td>
<td>
<p>(numeric) minimum possible value on the y axis a quadrat can cover.</p>
</td></tr>
<tr><td><code id="sampling_one_quadrat_+3A_ymax">ymax</code></td>
<td>
<p>(numeric) maximum possible value on the y axis a quadrat can cover.</p>
</td></tr>
<tr><td><code id="sampling_one_quadrat_+3A_seed">seed</code></td>
<td>
<p>(integer) Any integer passed to <code>set.seed</code> for reproducibility.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame with 2 columns x and y giving  the coordinates of the
lower left corner of the square quadrat.
</p>

<hr>
<h2 id='sampling_random_bruteforce'>Creates coordinates (lower left corner of a quadrat) randomly distributed but without overlapping each
other</h2><span id='topic+sampling_random_bruteforce'></span>

<h3>Description</h3>

<p>This function works without having the <code>spatstat.random</code> package install.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sampling_random_bruteforce(
  n_quadrats,
  min_dist,
  xmin,
  xmax,
  ymin,
  ymax,
  seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sampling_random_bruteforce_+3A_n_quadrats">n_quadrats</code></td>
<td>
<p>Number of sampling quadrats</p>
</td></tr>
<tr><td><code id="sampling_random_bruteforce_+3A_min_dist">min_dist</code></td>
<td>
<p>(numeric) minimal distance between two points to avoid overlap.
Equal to the length of a quadrat diagonal</p>
</td></tr>
<tr><td><code id="sampling_random_bruteforce_+3A_xmin">xmin</code></td>
<td>
<p>(numeric) minimum possible value on the x axis a quadrat can cover.</p>
</td></tr>
<tr><td><code id="sampling_random_bruteforce_+3A_xmax">xmax</code></td>
<td>
<p>(numeric) maximum possible value on the x axis a quadrat can cover.</p>
</td></tr>
<tr><td><code id="sampling_random_bruteforce_+3A_ymin">ymin</code></td>
<td>
<p>(numeric) minimum possible value on the y axis a quadrat can cover.</p>
</td></tr>
<tr><td><code id="sampling_random_bruteforce_+3A_ymax">ymax</code></td>
<td>
<p>(numeric) maximum possible value on the y axis a quadrat can cover.</p>
</td></tr>
<tr><td><code id="sampling_random_bruteforce_+3A_seed">seed</code></td>
<td>
<p>(integer) Any integer passed to <code>set.seed</code> for reproducibility.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame with 2 columns x and y giving  the coordinates of the
lower left corner of the square quadrats.
</p>

<hr>
<h2 id='sampling_random_overlap'>Creates coordinates (lower left corner of a quadrat) randomly distributed
that may overlap each other</h2><span id='topic+sampling_random_overlap'></span>

<h3>Description</h3>

<p>Creates coordinates (lower left corner of a quadrat) randomly distributed
that may overlap each other
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sampling_random_overlap(
  n_quadrats,
  min_dist,
  xmin,
  xmax,
  ymin,
  ymax,
  seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sampling_random_overlap_+3A_n_quadrats">n_quadrats</code></td>
<td>
<p>Number of sampling quadrats</p>
</td></tr>
<tr><td><code id="sampling_random_overlap_+3A_min_dist">min_dist</code></td>
<td>
<p>(numeric) minimal distance between two points to avoid overlap.
Equal to the length of a quadrat diagonal</p>
</td></tr>
<tr><td><code id="sampling_random_overlap_+3A_xmin">xmin</code></td>
<td>
<p>(numeric) minimum possible value on the x axis a quadrat can cover.</p>
</td></tr>
<tr><td><code id="sampling_random_overlap_+3A_xmax">xmax</code></td>
<td>
<p>(numeric) maximum possible value on the x axis a quadrat can cover.</p>
</td></tr>
<tr><td><code id="sampling_random_overlap_+3A_ymin">ymin</code></td>
<td>
<p>(numeric) minimum possible value on the y axis a quadrat can cover.</p>
</td></tr>
<tr><td><code id="sampling_random_overlap_+3A_ymax">ymax</code></td>
<td>
<p>(numeric) maximum possible value on the y axis a quadrat can cover.</p>
</td></tr>
<tr><td><code id="sampling_random_overlap_+3A_seed">seed</code></td>
<td>
<p>(integer) Any integer passed to <code>set.seed</code> for reproducibility.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame with 2 columns x and y giving  the coordinates of the
lower left corner of the square quadrats.
</p>

<hr>
<h2 id='sampling_random_spatstat'>Creates coordinates (lower left corner of a quadrat) randomly distributed but
without overlapping each other</h2><span id='topic+sampling_random_spatstat'></span>

<h3>Description</h3>

<p>Efficient algorithm from package <code>spatstat.random</code> is used.
Produces similar results as <code><a href="#topic+sampling_random_bruteforce">sampling_random_bruteforce</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sampling_random_spatstat(
  n_quadrats,
  min_dist,
  xmin,
  xmax,
  ymin,
  ymax,
  seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sampling_random_spatstat_+3A_n_quadrats">n_quadrats</code></td>
<td>
<p>Number of sampling quadrats</p>
</td></tr>
<tr><td><code id="sampling_random_spatstat_+3A_min_dist">min_dist</code></td>
<td>
<p>(numeric) minimal distance between two points to avoid overlap.
Equal to the length of a quadrat diagonal</p>
</td></tr>
<tr><td><code id="sampling_random_spatstat_+3A_xmin">xmin</code></td>
<td>
<p>(numeric) minimum possible value on the x axis a quadrat can cover.</p>
</td></tr>
<tr><td><code id="sampling_random_spatstat_+3A_xmax">xmax</code></td>
<td>
<p>(numeric) maximum possible value on the x axis a quadrat can cover.</p>
</td></tr>
<tr><td><code id="sampling_random_spatstat_+3A_ymin">ymin</code></td>
<td>
<p>(numeric) minimum possible value on the y axis a quadrat can cover.</p>
</td></tr>
<tr><td><code id="sampling_random_spatstat_+3A_ymax">ymax</code></td>
<td>
<p>(numeric) maximum possible value on the y axis a quadrat can cover.</p>
</td></tr>
<tr><td><code id="sampling_random_spatstat_+3A_seed">seed</code></td>
<td>
<p>(integer) Any integer passed to <code>set.seed</code> for reproducibility.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame with 2 columns x and y giving the coordinates of the
lower left corner of the square quadrats.
</p>

<hr>
<h2 id='sampling_transects'>Creates square quadrats aligned along a transect</h2><span id='topic+sampling_transects'></span>

<h3>Description</h3>

<p>Creates square quadrats aligned along a transect
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sampling_transects(
  n_quadrats,
  xmin,
  xmax,
  ymin,
  ymax,
  x0,
  y0,
  delta_x,
  delta_y,
  quadrat_size
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sampling_transects_+3A_n_quadrats">n_quadrats</code></td>
<td>
<p>(integer) Number of sampling quadrats</p>
</td></tr>
<tr><td><code id="sampling_transects_+3A_xmin">xmin</code></td>
<td>
<p>(numeric) minimum possible value on the x axis a quadrat can cover.</p>
</td></tr>
<tr><td><code id="sampling_transects_+3A_xmax">xmax</code></td>
<td>
<p>(numeric) maximum possible value on the x axis a quadrat can cover.</p>
</td></tr>
<tr><td><code id="sampling_transects_+3A_ymin">ymin</code></td>
<td>
<p>(numeric) minimum possible value on the y axis a quadrat can cover.</p>
</td></tr>
<tr><td><code id="sampling_transects_+3A_ymax">ymax</code></td>
<td>
<p>(numeric) maximum possible value on the y axis a quadrat can cover.</p>
</td></tr>
<tr><td><code id="sampling_transects_+3A_x0">x0</code>, <code id="sampling_transects_+3A_y0">y0</code></td>
<td>
<p>(numeric value) Lower left corner of the first quadrat in transect and grid sampling</p>
</td></tr>
<tr><td><code id="sampling_transects_+3A_delta_x">delta_x</code></td>
<td>
<p>(numeric value) Distance between consecutive quadrats in transect and grid sampling
in x-direction (the distance between the left sides is measured)</p>
</td></tr>
<tr><td><code id="sampling_transects_+3A_delta_y">delta_y</code></td>
<td>
<p>(numeric value) Distance between consecutive quadrats in transect and grid sampling
in y-direction (the distance between the lower sides is measured)</p>
</td></tr>
<tr><td><code id="sampling_transects_+3A_quadrat_size">quadrat_size</code></td>
<td>
<p>(numeric) width of the quadrats.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame with 2 columns x and y giving  the coordinates of the
lower left corner of the square quadrats.
</p>

<hr>
<h2 id='sim_poisson_community'>Simulate community with random spatial positions.</h2><span id='topic+sim_poisson_community'></span>

<h3>Description</h3>

<p>This function simulates a community with a certain abundance distribution and
and random spatial coordinates. This function consecutively calls
<code><a href="#topic+sim_sad">sim_sad</a></code> and <code><a href="#topic+sim_poisson_coords">sim_poisson_coords</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_poisson_community(
  s_pool,
  n_sim,
  sad_type = "lnorm",
  sad_coef = list(cv_abund = 1),
  fix_s_sim = FALSE,
  xrange = c(0, 1),
  yrange = c(0, 1),
  seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim_poisson_community_+3A_s_pool">s_pool</code></td>
<td>
<p>Number of species in the pool (integer)</p>
</td></tr>
<tr><td><code id="sim_poisson_community_+3A_n_sim">n_sim</code></td>
<td>
<p>Number of individuals in the simulated community (integer)</p>
</td></tr>
<tr><td><code id="sim_poisson_community_+3A_sad_type">sad_type</code></td>
<td>
<p>Root name of the species abundance distribution model of the
species pool (character) - e.g., &quot;lnorm&quot; for the lognormal distribution
(<code><a href="stats.html#topic+rlnorm">rlnorm</a></code>); &quot;geom&quot; for the geometric distribution
(<code><a href="stats.html#topic+rgeom">rgeom</a></code>), or &quot;ls&quot; for Fisher's log-series distribution
(<code><a href="sads.html#topic+rls">rls</a></code>).
</p>
<p>See the table in <strong>Details</strong> below, or <code><a href="sads.html#topic+rsad">rsad</a></code>
for all SAD model options.</p>
</td></tr>
<tr><td><code id="sim_poisson_community_+3A_sad_coef">sad_coef</code></td>
<td>
<p>List with named arguments to be passed to the distribution
function defined by the argument <code>sad_type</code>. An overview of parameter
names is given in the table below.
</p>
<p>In <code>mobsim</code> the log-normal and the Poisson log-normal distributions
can alternatively be parameterized by the coefficient of variation (cv)
of the relative abundances in the species pool. Accordingly, <code>cv_abund</code>
is the standard deviation of abundances divided by the mean abundance
(no. of individuals / no. of species). <code>cv_abund</code> is thus negatively
correlated with the evenness of the species abundance distribution.
</p>
<p>Please note that the parameters <em>mu</em> and <em>sigma</em> are not equal
to the mean and standard deviation of the log-normal distribution.</p>
</td></tr>
<tr><td><code id="sim_poisson_community_+3A_fix_s_sim">fix_s_sim</code></td>
<td>
<p>Should the simulation constrain the number of
species in the simulated local community? (logical)</p>
</td></tr>
<tr><td><code id="sim_poisson_community_+3A_xrange">xrange</code></td>
<td>
<p>Extent of the community in x-direction (numeric vector of length 2)</p>
</td></tr>
<tr><td><code id="sim_poisson_community_+3A_yrange">yrange</code></td>
<td>
<p>Extent of the community in y-direction (numeric vector of length 2)</p>
</td></tr>
<tr><td><code id="sim_poisson_community_+3A_seed">seed</code></td>
<td>
<p>Integer. Any integer passed to <code>set.seed</code> for reproducibility.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A community object as defined by <code><a href="#topic+community">community</a></code>.
</p>


<h3>Author(s)</h3>

<p>Felix May
</p>


<h3>Examples</h3>

<pre><code class='language-R'>com1 &lt;- sim_poisson_community(s_pool = 20, n_sim = 500, sad_type = "lnorm",
sad_coef = list("meanlog" = 2, "sdlog" = 1))
plot(com1)

</code></pre>

<hr>
<h2 id='sim_poisson_coords'>Simulate random spatial coordinates</h2><span id='topic+sim_poisson_coords'></span>

<h3>Description</h3>

<p>Add random spatial positions to a species abundance distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_poisson_coords(abund_vec, xrange = c(0, 1), yrange = c(0, 1), seed = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim_poisson_coords_+3A_abund_vec">abund_vec</code></td>
<td>
<p>Species abundance vector (integer)</p>
</td></tr>
<tr><td><code id="sim_poisson_coords_+3A_xrange">xrange</code></td>
<td>
<p>Extent of the community in x-direction (numeric vector of length 2)</p>
</td></tr>
<tr><td><code id="sim_poisson_coords_+3A_yrange">yrange</code></td>
<td>
<p>Extent of the community in y-direction (numeric vector of length 2)</p>
</td></tr>
<tr><td><code id="sim_poisson_coords_+3A_seed">seed</code></td>
<td>
<p>Integer. Any integer passed to <code>set.seed</code> for reproducibility.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A community object as defined by <code><a href="#topic+community">community</a></code>.
</p>


<h3>Author(s)</h3>

<p>Felix May
</p>


<h3>Examples</h3>

<pre><code class='language-R'>abund &lt;- sim_sad(s_pool = 100, n_sim = 1000)
sim_com1 &lt;- sim_poisson_coords(abund)
plot(sim_com1)
summary(sim_com1)

</code></pre>

<hr>
<h2 id='sim_sad'>Simulate species abundance distributions</h2><span id='topic+sim_sad'></span>

<h3>Description</h3>

<p>Simulate species abundance distribution (SAD) of a local community with
user-defined number of species and relative abundance distribution in the pool,
and user-defined number of individuals in the simulated local community.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_sad(
  s_pool = NULL,
  n_sim = NULL,
  sad_type = c("lnorm", "bs", "gamma", "geom", "ls", "mzsm", "nbinom", "pareto",
    "poilog", "power", "powbend", "weibull"),
  sad_coef = list(cv_abund = 1),
  fix_s_sim = FALSE,
  drop_zeros = TRUE,
  seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim_sad_+3A_s_pool">s_pool</code></td>
<td>
<p>Number of species in the pool (integer)</p>
</td></tr>
<tr><td><code id="sim_sad_+3A_n_sim">n_sim</code></td>
<td>
<p>Number of individuals in the simulated community (integer)</p>
</td></tr>
<tr><td><code id="sim_sad_+3A_sad_type">sad_type</code></td>
<td>
<p>Root name of the species abundance distribution model of the
species pool (character) - e.g., &quot;lnorm&quot; for the lognormal distribution
(<code><a href="stats.html#topic+rlnorm">rlnorm</a></code>); &quot;geom&quot; for the geometric distribution
(<code><a href="stats.html#topic+rgeom">rgeom</a></code>), or &quot;ls&quot; for Fisher's log-series distribution
(<code><a href="sads.html#topic+rls">rls</a></code>).
</p>
<p>See the table in <strong>Details</strong> below, or <code><a href="sads.html#topic+rsad">rsad</a></code>
for all SAD model options.</p>
</td></tr>
<tr><td><code id="sim_sad_+3A_sad_coef">sad_coef</code></td>
<td>
<p>List with named arguments to be passed to the distribution
function defined by the argument <code>sad_type</code>. An overview of parameter
names is given in the table below.
</p>
<p>In <code>mobsim</code> the log-normal and the Poisson log-normal distributions
can alternatively be parameterized by the coefficient of variation (cv)
of the relative abundances in the species pool. Accordingly, <code>cv_abund</code>
is the standard deviation of abundances divided by the mean abundance
(no. of individuals / no. of species). <code>cv_abund</code> is thus negatively
correlated with the evenness of the species abundance distribution.
</p>
<p>Please note that the parameters <em>mu</em> and <em>sigma</em> are not equal
to the mean and standard deviation of the log-normal distribution.</p>
</td></tr>
<tr><td><code id="sim_sad_+3A_fix_s_sim">fix_s_sim</code></td>
<td>
<p>Should the simulation constrain the number of
species in the simulated local community? (logical)</p>
</td></tr>
<tr><td><code id="sim_sad_+3A_drop_zeros">drop_zeros</code></td>
<td>
<p>Should the function remove species with abundance zero
from the output? (logical)</p>
</td></tr>
<tr><td><code id="sim_sad_+3A_seed">seed</code></td>
<td>
<p>Integer. Any integer passed to <code>set.seed</code> for reproducibility.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>sim_sad</code> was built using code of the function
<code><a href="sads.html#topic+rsad">sads::rsad</a></code> from the R package <code><a href="sads.html#topic+sads">sads</a></code>. However, in
contrast to <code><a href="sads.html#topic+rsad">sads::rsad</a></code>, the function <code>sim_sad</code> allows to
define the number of individuals in the simulated local community. This is
implemented by converting the abundance distribution simulated based on
<code><a href="sads.html#topic+rsad">sads::rsad</a></code> into a relative abundance distribution. This
relative abundance distribution is considered as the species pool for the
local community. In a second step the required no. of individuals <code>(n_sim)</code>
is sampled (with replacement) from this relative abundance distribution.
</p>
<p>Please note that this might effect the interpretation of the parameters of
the underlying statistical distribution, e.g. the mean abundance will always
be <code>n_sim/s_pool</code> irrespective of the settings of <code>sad_coef</code>.
</p>
<p>When <code>fix_s_sim = FALSE</code> the species number in the local
community might deviate from <code>s_pool</code> due to stochastic sampling. When
<code>fix_s_sim = TRUE</code> the local number of species will equal
<code>s_pool</code>, but this constraint can result in systematic biases from the
theoretical distribution parameters. Generally, with <code>fix_s_sim = TRUE</code>
additional very rare species will be added to the community, while the abundance
of the most common ones is reduced to keep the defined number of individuals.
</p>
<p>Here is an overview of all available models (<code>sad_type</code>) and their
respective coefficients (<code>sad_coef</code>). Further information is provided
by the documentation of the specific functions that can be accesses by the
links. Please note that the coefficient <code>cv_abund</code> for the log-normal
and Poisson log-normal model are only available within <code>mobsim</code>.
</p>

<table>
<tr>
 <td style="text-align: left;">
   <strong>SAD function</strong> </td><td style="text-align: left;"> <strong>Distribution name</strong> </td><td style="text-align: left;"> <strong>coef #1</strong> </td><td style="text-align: left;"> <strong>coef #2</strong> </td><td style="text-align: left;"> <strong>coef #3</strong> </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="sads.html#topic+dbs">sads::rbs</a></code> </td><td style="text-align: left;"> Mac-Arthur's brokenstick </td><td style="text-align: left;"> N </td><td style="text-align: left;"> S </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="stats.html#topic+GammaDist">stats:rgamma</a></code> </td><td style="text-align: left;"> Gamma distribution </td><td style="text-align: left;"> shape </td><td style="text-align: left;"> rate </td><td style="text-align: left;"> scale </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="stats.html#topic+rgeom">rgeom</a></code> </td><td style="text-align: left;"> Geometric distribution </td><td style="text-align: left;"> prob </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="stats.html#topic+rlnorm">rlnorm</a></code> </td><td style="text-align: left;">	Log-normal distributions </td><td style="text-align: left;">	meanlog </td><td style="text-align: left;"> sdlog </td><td style="text-align: left;"> cv_abund </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="sads.html#topic+rls">rls</a></code> </td><td style="text-align: left;"> Fisher's log-series distribution </td><td style="text-align: left;"> N </td><td style="text-align: left;"> alpha </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="sads.html#topic+dmzsm">sads::rmzsm</a></code> </td><td style="text-align: left;"> Metacommunity zero-sum multinomial </td><td style="text-align: left;"> J </td><td style="text-align: left;"> theta </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="stats.html#topic+Binomial">stats::rnbinom</a></code> </td><td style="text-align: left;"> Negative binomial distribution </td><td style="text-align: left;"> size </td><td style="text-align: left;">	prob </td><td style="text-align: left;"> mu </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="sads.html#topic+dpareto">sads::rpareto</a></code> </td><td style="text-align: left;"> Pareto distribution </td><td style="text-align: left;"> shape </td><td style="text-align: left;"> scale </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="sads.html#topic+dpoilog">sads::rpoilog</a></code> </td><td style="text-align: left;"> Poisson-lognormal distribution </td><td style="text-align: left;">	mu	 </td><td style="text-align: left;"> sigma </td><td style="text-align: left;"> cv_abund </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="sads.html#topic+dpower">sads::rpower</a></code> </td><td style="text-align: left;"> Power discrete distributions </td><td style="text-align: left;"> s </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="sads.html#topic+dpowbend">sads::rpowbend</a></code> </td><td style="text-align: left;"> Puyeo's Power-bend discrete distribution </td><td style="text-align: left;"> s </td><td style="text-align: left;"> omega </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="stats.html#topic+Weibull">stats::rweibull</a></code> </td><td style="text-align: left;"> Weibull distribution </td><td style="text-align: left;"> shape </td><td style="text-align: left;"> scale </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Value</h3>

<p>Object of class <code>sad</code>, which contains a named integer vector
with species abundances
</p>


<h3>Author(s)</h3>

<p>Felix May
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Simulate log-normal species abundance distribution
sad_lnorm1 &lt;- sim_sad(s_pool = 100, n_sim = 10000, sad_type = "lnorm",
                      sad_coef = list("meanlog" = 5, "sdlog" = 0.5))
plot(sad_lnorm1, method = "octave")
plot(sad_lnorm1, method = "rank")

# Alternative parameterization of the log-normal distribution
sad_lnorm2 &lt;- sim_sad(s_pool = 100, n_sim = 10000, sad_type = "lnorm",
                      sad_coef = list("cv_abund" = 0.5))
plot(sad_lnorm2, method = "octave")

# Fix species richness in the simulation by adding rare species
sad_lnorm3a &lt;- sim_sad(s_pool = 500, n_sim = 10000, sad_type = "lnorm",
                       sad_coef = list("cv_abund" = 5), fix_s_sim = TRUE)
sad_lnorm3b &lt;- sim_sad(s_pool = 500, n_sim = 10000, sad_type = "lnorm",
                       sad_coef = list("cv_abund" = 5))

plot(sad_lnorm3a, method = "rank")
points(1:length(sad_lnorm3b), sad_lnorm3b, type = "b", col = 2)
legend("topright", c("fix_s_sim = TRUE","fix_s_sim = FALSE"),
       col = 1:2, pch = 1)

# Different important SAD models

# Fisher's log-series
sad_logseries &lt;- sim_sad(s_pool = NULL, n_sim = NULL, sad_type = "ls",
                         sad_coef = list("N" = 1e5, "alpha" = 20))

# Poisson log-normal
sad_poilog &lt;- sim_sad(s_pool = 100, n_sim = 10000, sad_type = "poilog",
                      sad_coef = list("mu" = 5, "sig" = 0.5))

# Mac-Arthur's broken stick
sad_broken_stick &lt;- sim_sad(s_pool = NULL, n_sim = NULL, sad_type = "bs",
                            sad_coef = list("N" = 1e5, "S" = 100))

# Plot all SADs together as rank-abundance curves
plot(sad_logseries, method = "rank")
lines(1:length(sad_lnorm2), sad_lnorm2, type = "b", col = 2)
lines(1:length(sad_poilog), sad_poilog, type = "b", col = 3)
lines(1:length(sad_broken_stick), sad_broken_stick, type = "b", col = 4)
legend("topright", c("Log-series","Log-normal","Poisson log-normal","Broken stick"),
       col = 1:4, pch = 1)
</code></pre>

<hr>
<h2 id='sim_thomas_community'>Simulate community with clumped spatial positions.</h2><span id='topic+sim_thomas_community'></span>

<h3>Description</h3>

<p>This function simulates a community with a certain abundance distribution and
with intraspecific aggregation, i.e. individuals of the same species are
distributed in clusters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_thomas_community(
  s_pool,
  n_sim,
  sad_type = "lnorm",
  sad_coef = list(cv_abund = 1),
  fix_s_sim = FALSE,
  sigma = 0.02,
  cluster_points = NA,
  mother_points = NA,
  xmother = NA,
  ymother = NA,
  xrange = c(0, 1),
  yrange = c(0, 1),
  seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim_thomas_community_+3A_s_pool">s_pool</code></td>
<td>
<p>Number of species in the pool (integer)</p>
</td></tr>
<tr><td><code id="sim_thomas_community_+3A_n_sim">n_sim</code></td>
<td>
<p>Number of individuals in the simulated community (integer)</p>
</td></tr>
<tr><td><code id="sim_thomas_community_+3A_sad_type">sad_type</code></td>
<td>
<p>Root name of the species abundance distribution model of the
species pool (character) - e.g., &quot;lnorm&quot; for the lognormal distribution
(<code><a href="stats.html#topic+rlnorm">rlnorm</a></code>); &quot;geom&quot; for the geometric distribution
(<code><a href="stats.html#topic+rgeom">rgeom</a></code>), or &quot;ls&quot; for Fisher's log-series distribution
(<code><a href="sads.html#topic+rls">rls</a></code>).
</p>
<p>See the table in <strong>Details</strong> below, or <code><a href="sads.html#topic+rsad">rsad</a></code>
for all SAD model options.</p>
</td></tr>
<tr><td><code id="sim_thomas_community_+3A_sad_coef">sad_coef</code></td>
<td>
<p>List with named arguments to be passed to the distribution
function defined by the argument <code>sad_type</code>. An overview of parameter
names is given in the table below.
</p>
<p>In <code>mobsim</code> the log-normal and the Poisson log-normal distributions
can alternatively be parameterized by the coefficient of variation (cv)
of the relative abundances in the species pool. Accordingly, <code>cv_abund</code>
is the standard deviation of abundances divided by the mean abundance
(no. of individuals / no. of species). <code>cv_abund</code> is thus negatively
correlated with the evenness of the species abundance distribution.
</p>
<p>Please note that the parameters <em>mu</em> and <em>sigma</em> are not equal
to the mean and standard deviation of the log-normal distribution.</p>
</td></tr>
<tr><td><code id="sim_thomas_community_+3A_fix_s_sim">fix_s_sim</code></td>
<td>
<p>Should the simulation constrain the number of
species in the simulated local community? (logical)</p>
</td></tr>
<tr><td><code id="sim_thomas_community_+3A_sigma">sigma</code></td>
<td>
<p>Mean displacement (along each coordinate axes) of a point from
its mother point (= cluster centre). <code>Sigma</code> correlates with cluster
extent. When <code>length(sigma) == length(abund_vec)</code>, each species
receives a specific cluster extent. Otherwise, the first value of <code>sigma</code>
is recycled and all species share the same cluster extent.
When <code>sigma</code> of any species is more than twice as large as the largest
plot dimension, a random Poisson distribution is simulated, which is more
efficient than a Thomas cluster process. The parameter <code>sigma</code> corresponds
to the <code>scale</code> parameter of the function <code><a href="spatstat.random.html#topic+rThomas">rThomas</a></code> in the package
<a href="https://CRAN.R-project.org/package=spatstat.random">spatstat.random</a>.</p>
</td></tr>
<tr><td><code id="sim_thomas_community_+3A_cluster_points">cluster_points</code></td>
<td>
<p>Mean number of points per cluster. If this is
a single value, species have the same average number of points per cluster.
If this is a vector of the same length as <code>abund_vec</code>, each species has
a specific mean number of points per cluster.  If no value is provided, the
number of points per cluster is determined from the abundance and from
<code>mother_points</code>. If <code>mother_points</code> and <code>cluster_points</code> are given OR
<code>xmother</code> and <code>ymother</code>, and cluster points are given, <code>cluster_points</code> is overridden.
If <code>mother_points</code>=0, there will be no clustering even if <code>cluster_points</code>=400 (high clustering) because
<code>cluster_points</code> is overridden.
The parameter <code>cluster_points</code> corresponds to the
<code>mu</code> parameter of <code>spatstat.random::rThomas</code>.</p>
</td></tr>
<tr><td><code id="sim_thomas_community_+3A_mother_points">mother_points</code></td>
<td>
<p>Number of mother points (= cluster centres).
If this is a single value, all species have the same number of clusters.
For example <code>mother_points = 1</code> can be used to simulate only one cluster
per species, which then represents the complete species range.
If <code>mother_points</code> is a vector of the same length as <code>abund_vec</code>,
each species has a specific number of clusters. If <code>mother_points</code> equals 0
there is no clustering and the distribution is homogeneous. If no value is provided,
the number of clusters is determined from the abundance and the number of points
per cluster (<code>cluster_points</code>).</p>
</td></tr>
<tr><td><code id="sim_thomas_community_+3A_xmother">xmother</code></td>
<td>
<p>List of length equal to the number of species. Each list element
is a vector of x coordinates for every mother points. If one element is NA, the
the corresponding species is not clustered.</p>
</td></tr>
<tr><td><code id="sim_thomas_community_+3A_ymother">ymother</code></td>
<td>
<p>List of length equal to the number of species. Each list element
is a vector of y coordinates for every mother points. If one element is NA, the
the corresponding species is not clustered.</p>
</td></tr>
<tr><td><code id="sim_thomas_community_+3A_xrange">xrange</code></td>
<td>
<p>Extent of the community in x-direction. If this a numeric vector
of length 2, all species share the same range. To specify different x ranges for
all species, <code>xrange</code> should be a data.frame with 2 columns, min and max.</p>
</td></tr>
<tr><td><code id="sim_thomas_community_+3A_yrange">yrange</code></td>
<td>
<p>Extent of the community in y-direction. If this a numeric vector
of length 2, all species share the same range. To specify different y ranges for
all species, <code>xrange</code> should be a data.frame with 2 columns, min and max.</p>
</td></tr>
<tr><td><code id="sim_thomas_community_+3A_seed">seed</code></td>
<td>
<p>Integer. Any integer passed to <code>set.seed</code> for reproducibility.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function consecutively calls <code><a href="#topic+sim_sad">sim_sad</a></code> and
<code><a href="#topic+sim_thomas_coords">sim_thomas_coords</a></code>
</p>
<p>See the documentations of <code><a href="#topic+sim_sad">sim_sad</a></code> and
<code><a href="#topic+sim_thomas_coords">sim_thomas_coords</a></code> for details.
</p>


<h3>Value</h3>

<p>A community object as defined by <code><a href="#topic+community">community</a></code>
</p>


<h3>Author(s)</h3>

<p>Felix May
</p>


<h3>Examples</h3>

<pre><code class='language-R'>com1 &lt;- sim_thomas_community(s_pool = 20, n_sim = 500, sad_type = "lnorm",
                             sad_coef = list("meanlog" = 2, "sdlog" = 1),
                             sigma = 0.01)
plot(com1)

</code></pre>

<hr>
<h2 id='sim_thomas_coords'>Simulate clumped spatial coordinates</h2><span id='topic+sim_thomas_coords'></span>

<h3>Description</h3>

<p>Add clumped (aggregated) positions to a species abundance distribution.
Clumping is simulated using a Thomas cluster process, also known as Poisson
cluster process (Morlon et al. 2008, Wiegand &amp; Moloney 2014)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_thomas_coords(
  abund_vec,
  sigma = 0.02,
  mother_points = NA,
  xmother = NA,
  ymother = NA,
  cluster_points = NA,
  xrange = c(0, 1),
  yrange = c(0, 1),
  seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim_thomas_coords_+3A_abund_vec">abund_vec</code></td>
<td>
<p>Species abundance vector (integer)</p>
</td></tr>
<tr><td><code id="sim_thomas_coords_+3A_sigma">sigma</code></td>
<td>
<p>Mean displacement (along each coordinate axes) of a point from
its mother point (= cluster centre). <code>Sigma</code> correlates with cluster
extent. When <code>length(sigma) == length(abund_vec)</code>, each species
receives a specific cluster extent. Otherwise, the first value of <code>sigma</code>
is recycled and all species share the same cluster extent.
When <code>sigma</code> of any species is more than twice as large as the largest
plot dimension, a random Poisson distribution is simulated, which is more
efficient than a Thomas cluster process. The parameter <code>sigma</code> corresponds
to the <code>scale</code> parameter of the function <code><a href="spatstat.random.html#topic+rThomas">rThomas</a></code> in the package
<a href="https://CRAN.R-project.org/package=spatstat.random">spatstat.random</a>.</p>
</td></tr>
<tr><td><code id="sim_thomas_coords_+3A_mother_points">mother_points</code></td>
<td>
<p>Number of mother points (= cluster centres).
If this is a single value, all species have the same number of clusters.
For example <code>mother_points = 1</code> can be used to simulate only one cluster
per species, which then represents the complete species range.
If <code>mother_points</code> is a vector of the same length as <code>abund_vec</code>,
each species has a specific number of clusters. If <code>mother_points</code> equals 0
there is no clustering and the distribution is homogeneous. If no value is provided,
the number of clusters is determined from the abundance and the number of points
per cluster (<code>cluster_points</code>).</p>
</td></tr>
<tr><td><code id="sim_thomas_coords_+3A_xmother">xmother</code></td>
<td>
<p>List of length equal to the number of species. Each list element
is a vector of x coordinates for every mother points. If one element is NA, the
the corresponding species is not clustered.</p>
</td></tr>
<tr><td><code id="sim_thomas_coords_+3A_ymother">ymother</code></td>
<td>
<p>List of length equal to the number of species. Each list element
is a vector of y coordinates for every mother points. If one element is NA, the
the corresponding species is not clustered.</p>
</td></tr>
<tr><td><code id="sim_thomas_coords_+3A_cluster_points">cluster_points</code></td>
<td>
<p>Mean number of points per cluster. If this is
a single value, species have the same average number of points per cluster.
If this is a vector of the same length as <code>abund_vec</code>, each species has
a specific mean number of points per cluster.  If no value is provided, the
number of points per cluster is determined from the abundance and from
<code>mother_points</code>. If <code>mother_points</code> and <code>cluster_points</code> are given OR
<code>xmother</code> and <code>ymother</code>, and cluster points are given, <code>cluster_points</code> is overridden.
If <code>mother_points</code>=0, there will be no clustering even if <code>cluster_points</code>=400 (high clustering) because
<code>cluster_points</code> is overridden.
The parameter <code>cluster_points</code> corresponds to the
<code>mu</code> parameter of <code>spatstat.random::rThomas</code>.</p>
</td></tr>
<tr><td><code id="sim_thomas_coords_+3A_xrange">xrange</code></td>
<td>
<p>Extent of the community in x-direction. If this a numeric vector
of length 2, all species share the same range. To specify different x ranges for
all species, <code>xrange</code> should be a data.frame with 2 columns, min and max.</p>
</td></tr>
<tr><td><code id="sim_thomas_coords_+3A_yrange">yrange</code></td>
<td>
<p>Extent of the community in y-direction. If this a numeric vector
of length 2, all species share the same range. To specify different y ranges for
all species, <code>xrange</code> should be a data.frame with 2 columns, min and max.</p>
</td></tr>
<tr><td><code id="sim_thomas_coords_+3A_seed">seed</code></td>
<td>
<p>Integer. Any integer passed to <code>set.seed</code> for reproducibility.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To generate a Thomas cluster process of a single species this
function uses a C++ re-implementation of the function
<code>rThomas</code> in the package
<a href="https://CRAN.R-project.org/package=spatstat.random">spatstat.random</a>.
</p>
<p>There is an inherent link between the parameters <code>abund_vec</code>,
<code>mother_points</code>, and <code>cluster_points</code>. For every species the
abundance has to be equal to the number of clusters
(<code>mother_points</code>) times the number of points per cluster
(<code>cluster_points</code>).
</p>
<p style="text-align: center;"><code class="reqn">abundance = mother_points * cluster_points</code>
</p>

<p>Accordingly, if one of the parameters is provided, the other one is directly
calculated from the abundance. Values for <code>mother_points</code> override values
for <code>cluster_points</code>. If none of the parameters is specified, it is assumed
that for every species there is a similar number of clusters and of points
per cluster.
</p>
<p style="text-align: center;"><code class="reqn">mother_points = cluster_points = \sqrt(abundance),</code>
</p>

<p>In this case rare species have few clusters with few points per
cluster, while abundant species have many clusters with many points per cluster.
</p>


<h3>Value</h3>

<p>A community object as defined by <code><a href="#topic+community">community</a></code>.
</p>


<h3>Author(s)</h3>

<p>Felix May, Alban Sagouis
</p>


<h3>References</h3>

<p>Morlon et al. 2008. A general framework for the distance-decay of similarity
in ecological communities. Ecology Letters 11, 904-917.
</p>
<p>Wiegand and Moloney 2014. Handbook of Spatial Point-Pattern Analysis in Ecology.
CRC Press
</p>


<h3>See Also</h3>

<p><code><a href="spatstat.random.html#topic+rThomas">rThomas</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
abund &lt;- c(10,20,50,100)
sim1 &lt;- sim_thomas_coords(abund, sigma = 0.02)
plot(sim1)

# Simulate species "ranges"
sim2 &lt;- sim_thomas_coords(abund, sigma = 0.02, mother_points = 1)
plot(sim2)

# Equal numbers of points per cluster
sim3 &lt;- sim_thomas_coords(abund, sigma = 0.02, cluster_points = 5)
plot(sim3)

# With large sigma the distribution will be essentially random (see Details)
sim4 &lt;- sim_thomas_coords(abund, sigma = 10)
plot(sim4)

# Some random and some clustered species with different numbers of mother points.
mother_points &lt;- sample(0:3, length(abund), replace = TRUE)
sim5 &lt;- sim_thomas_coords(abund, mother_points = mother_points, sigma=0.01)
plot(sim5)

# Specifying mother point coordinates or no-clustering (\code{NA}).
mother_points &lt;- sample(1:3, length(abund), replace = TRUE)
xmother &lt;- lapply(1:length(abund), function(i) runif(mother_points[i], 0, 1))
ymother &lt;- lapply(1:length(abund), function(i) runif(mother_points[i], 0, 1))
xmother[[1]] &lt;- NA
ymother[[1]] &lt;- NA
sim6 &lt;- sim_thomas_coords(abund, xmother=xmother, ymother=ymother, sigma=0.01)
plot(sim6)

# Species having different ranges.
xrange &lt;- data.frame(t(sapply(1:length(abund), function(i) sort(runif(2, 0, 1)))))
yrange &lt;- data.frame(t(sapply(1:length(abund), function(i) sort(runif(2, 0, 1)))))
sim7 &lt;- sim_thomas_coords(abund, mother_points=1, sigma=1, xrange=xrange, yrange=yrange)
plot(sim7)

</code></pre>

<hr>
<h2 id='spec_sample'>Sample species richness</h2><span id='topic+spec_sample'></span>

<h3>Description</h3>

<p>Expected species richness in a random sample of fixed size.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spec_sample(abund_vec, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spec_sample_+3A_abund_vec">abund_vec</code></td>
<td>
<p>Species abundance distribution of the community (integer vector)</p>
</td></tr>
<tr><td><code id="spec_sample_+3A_n">n</code></td>
<td>
<p>Sample size in terms of number of individuals (integer)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The expected number of species is calculated after Hurlbert 1971, Equation 3.
</p>
<p><code>spec_sample</code> is similar to the function <code><a href="vegan.html#topic+rarefy">rarefy</a></code>
in the R package <code><a href="vegan.html#topic+vegan">vegan</a></code>.
</p>


<h3>Value</h3>

<p>Expected number of species in a sample of n individuals
</p>


<h3>References</h3>

<p>Hurlbert, S.H. 1971. The nonconcept of species diversity: a critique and +
alternative parameters. Ecology 52, 577-586.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sad1 &lt;- sim_sad(100, 1000)
spec_sample(abund_vec = sad1, n = 20)

</code></pre>

<hr>
<h2 id='spec_sample_curve'>Non-spatial and spatially-explicit species sampling curves</h2><span id='topic+spec_sample_curve'></span>

<h3>Description</h3>

<p>Expected species richness as function of sample size (no. of individuals),
when individuals are sampled randomly (rarefaction) or when nearest-neighbours
are samples (accumulation).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spec_sample_curve(comm, method = c("accumulation", "rarefaction"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spec_sample_curve_+3A_comm">comm</code></td>
<td>
<p>Community object</p>
</td></tr>
<tr><td><code id="spec_sample_curve_+3A_method">method</code></td>
<td>
<p>Partial match to <code>accumulation</code> or <code>rarefaction</code>. Also both
methods can be included at the same time.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Non-spatial sampling corresponds to the species rarefaction curve, which only
depends on the species abundance distribution and can thus be also calculated
from abundance data (see <code><a href="#topic+rare_curve">rare_curve</a></code>).
</p>
<p>In contrast the species-accumulation curve starts from a focal individual and
only samples the nearest neighbours of the focal individual. The final
species accumulation curves is calculated as the mean over the accumulation
curves starting from all individuals.
</p>
<p>In contrast to the rarefaction curve the accumulation curve is not only
influenced by the species abundance distribution, but also by the spatial
distribution of individuals.
</p>


<h3>Value</h3>

<p>A dataframe with 2-3 columns. The first column indicates the sample
size (numbers of individuals), and the second and third column indicate
the expected species richness for spatial sampling (column: &quot;spec_accum&quot;)
and/or random sampling (column &quot;spec_rarefied&quot;)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sim_com1 &lt;- sim_thomas_community(s_pool = 100, n_sim = 1000)
sac1 &lt;- spec_sample_curve(sim_com1, method = c("rare","acc"))

head(sac1)
plot(sac1)

</code></pre>

<hr>
<h2 id='summary.community'>Print summary of spatial community object</h2><span id='topic+summary.community'></span>

<h3>Description</h3>

<p>Print summary of spatial community object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'community'
summary(object, digits = 2, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.community_+3A_object">object</code></td>
<td>
<p>Community object of class <code><a href="#topic+community">community</a></code></p>
</td></tr>
<tr><td><code id="summary.community_+3A_digits">digits</code></td>
<td>
<p>Integer. Number of digits to print</p>
</td></tr>
<tr><td><code id="summary.community_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code><a href="base.html#topic+print">print</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function is called for its side effects and has no return value.
</p>

<hr>
<h2 id='summary.sad'>Print summary of species abundance distribution object</h2><span id='topic+summary.sad'></span>

<h3>Description</h3>

<p>Print summary of species abundance distribution object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'sad'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.sad_+3A_object">object</code></td>
<td>
<p>Community object of class <code>sad</code></p>
</td></tr>
<tr><td><code id="summary.sad_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code><a href="base.html#topic+print">print</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function is called for its side effects and has no return value.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sim_sad">sim_sad</a></code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
