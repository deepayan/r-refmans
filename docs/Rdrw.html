<!DOCTYPE html><html lang="en"><head><title>Help for package Rdrw</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {Rdrw}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Rdrw'><p>Univariate and Multivariate Damped Random Walk Processes</p></a></li>
<li><a href='#drw'><p>Fitting univariate and multiviarate damped random walk processes</p></a></li>
<li><a href='#drw.sim'><p>Simulating univariate and multiviarate damped random walk processes</p></a></li>
<li><a href='#Rdrw-internal'><p>Internal <code>drw</code> functions</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>1.0.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-9-8</td>
</tr>
<tr>
<td>Title:</td>
<td>Univariate and Multivariate Damped Random Walk Processes</td>
</tr>
<tr>
<td>Author:</td>
<td>Zhirui Hu and Hyungsuk Tak</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Hyungsuk Tak &lt;hyungsuk.tak@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.2.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>mvtnorm(&ge; 1.0-11)</td>
</tr>
<tr>
<td>Description:</td>
<td>We provide a toolbox to fit and simulate a univariate or multivariate damped random walk process that is also known as an Ornstein-Uhlenbeck process or a continuous-time autoregressive model of the first order, i.e., CAR(1) or CARMA(1, 0). This process is suitable for analyzing univariate or multivariate time series data with irregularly-spaced observation times and heteroscedastic measurement errors. When it comes to the multivariate case, the number of data points (measurements/observations) available at each observation time does not need to be the same, and the length of each time series can vary. The number of time series data sets that can be modeled simultaneously is limited to ten in this version of the package. We use Kalman-filtering to evaluate the resulting likelihood function, which leads to a scalable and efficient computation in finding maximum likelihood estimates of the model parameters or in drawing their posterior samples. Please pay attention to loading the data if this package is used for astronomical data analyses; see the details in the manual. Also see Hu and Tak (2020) &lt;<a href="https://doi.org/10.48550/arXiv.2005.08049">doi:10.48550/arXiv.2005.08049</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-09-08 17:18:05 UTC; hyungsuktak</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-09-08 17:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='Rdrw'>Univariate and Multivariate Damped Random Walk Processes</h2><span id='topic+Rdrw-package'></span>

<h3>Description</h3>

<p>The R package <span class="pkg">Rdrw</span> provides a toolbox to fit and simulate univariate and multivariate damped random walk processes, possibly with known measurement error standard deviations via state-space representation. The damped random walk process is also known as an Ornstein-Uhlenbeck process or a continuous-time auto-regressive model with order one, i.e., CAR(1) or CARMA(1, 0). The package <span class="pkg">Rdrw</span> adopts Kalman-filtering to evaluate the resulting likelihood function of the model parameters, leading to a linear complexity in the number of unique observation times. The package provides two functionalities; (i) it fits the model and returns the maximum likelihood estimates or posterior samples of the model parameters; (ii) it simulates time series data following the univariate or multivariate damped random walk process.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> Rdrw</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0.2</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2020-9-8</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2</td>
</tr>
<tr>
 <td style="text-align: left;">
Main functions: </td><td style="text-align: left;"> <code><a href="#topic+drw">drw</a></code>, <code><a href="#topic+drw.sim">drw.sim</a></code></td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Zhirui Hu and Hyungsuk Tak
</p>


<h3>References</h3>

<p>Zhirui Hu and Hyungsuk Tak (2020+), &quot;Modeling Stochastic Variability in  Multi-Band Time Series Data,&quot; arXiv:2005.08049.
</p>

<hr>
<h2 id='drw'>Fitting univariate and multiviarate damped random walk processes</h2><span id='topic+drw'></span>

<h3>Description</h3>

<p>The function <code>drw</code> fits univariate and multivariate damped random walk processes on multiple time series data sets possibly with known measurement error standard deviations via state-space representation. This function <code>drw</code> evaluates the resulting likelihood function of the model parameters via Kalman-filtering whose minimum complexity is linear in the number of unique observation times. The function returns the maximum likelihood estimates or posterior samples of the model parameters. For astronomical data analyses, users need to pay attention to loading the data because R's default is to load only seven effective digits; see details below.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>drw(data1, data2, data3, data4, data5, 
    data6, data7, data8, data9, data10,
    n.datasets, method = "mle",
    bayes.n.burn, bayes.n.sample,
    mu.UNIFprior.range = c(-30, 30),
    tau.IGprior.shape = 1, tau.IGprior.scale = 1,
    sigma2.IGprior.shape = 1, sigma2.IGprior.scale = 1e-7)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="drw_+3A_data1">data1</code></td>
<td>
<p>An (<code class="reqn">n_1</code> by 3) matrix for time series data 1. The first column has <code class="reqn">n_1</code> observation times, the second column contains <code class="reqn">n_1</code> measurements (magnitudes), the third column includes <code class="reqn">n_1</code> measurement error standard deviations. If the measurement error standard deviations are unknown, the third column must be a vector of <code class="reqn">n_1</code> zeros.
</p>
</td></tr>
<tr><td><code id="drw_+3A_data2">data2</code></td>
<td>
<p>Optional if more than one time series data set are available. An (<code class="reqn">n_2</code> by 3) matrix for time series data 2. The first column has <code class="reqn">n_2</code> observation times, the second column contains <code class="reqn">n_2</code> measurements/observations/magnitudes, the third column includes <code class="reqn">n_2</code> measurement error standard deviations. If the measurement error standard deviations are unknown, the third column must be a vector of <code class="reqn">n_2</code> zeros.
</p>
</td></tr>
<tr><td><code id="drw_+3A_data3">data3</code></td>
<td>
<p>Optional if more than two time series data sets are available. An (<code class="reqn">n_3</code> by 3) matrix for time series data 3. The first column has <code class="reqn">n_3</code> observation times, the second column contains <code class="reqn">n_3</code> measurements/observations/magnitudes, the third column includes <code class="reqn">n_3</code> measurement error standard deviations. If the measurement error standard deviations are unknown, the third column must be a vector of <code class="reqn">n_3</code> zeros.
</p>
</td></tr>
<tr><td><code id="drw_+3A_data4">data4</code></td>
<td>
<p>Optional if more than three time series data sets are available. An (<code class="reqn">n_4</code> by 3) matrix for time series data 4. The first column has <code class="reqn">n_4</code> observation times, the second column contains <code class="reqn">n_4</code> measurements/observations/magnitudes, the third column includes <code class="reqn">n_4</code> measurement error standard deviations. If the measurement error standard deviations are unknown, the third column must be a vector of <code class="reqn">n_4</code> zeros.
</p>
</td></tr>
<tr><td><code id="drw_+3A_data5">data5</code></td>
<td>
<p>Optional if more than four time series data sets are available. An (<code class="reqn">n_5</code> by 3) matrix for time series data 5. The first column has <code class="reqn">n_5</code> observation times, the second column contains <code class="reqn">n_5</code> measurements/observations/magnitudes, the third column includes <code class="reqn">n_5</code> measurement error standard deviations. If the measurement error standard deviations are unknown, the third column must be a vector of <code class="reqn">n_5</code> zeros.
</p>
</td></tr>
<tr><td><code id="drw_+3A_data6">data6</code></td>
<td>
<p>Optional if more than five time series data sets are available. An (<code class="reqn">n_6</code> by 3) matrix for time series data 6. The first column has <code class="reqn">n_6</code> observation times, the second column contains <code class="reqn">n_6</code> measurements/observations/magnitudes, the third column includes <code class="reqn">n_6</code> measurement error standard deviations. If the measurement error standard deviations are unknown, the third column must be a vector of <code class="reqn">n_6</code> zeros.
</p>
</td></tr>
<tr><td><code id="drw_+3A_data7">data7</code></td>
<td>
<p>Optional if more than six time series data sets are available. An (<code class="reqn">n_7</code> by 3) matrix for time series data 7. The first column has <code class="reqn">n_7</code> observation times, the second column contains <code class="reqn">n_7</code> measurements/observations/magnitudes, the third column includes <code class="reqn">n_7</code> measurement error standard deviations. If the measurement error standard deviations are unknown, the third column must be a vector of <code class="reqn">n_7</code> zeros.
</p>
</td></tr>
<tr><td><code id="drw_+3A_data8">data8</code></td>
<td>
<p>Optional if more than seven time series data sets are available. An (<code class="reqn">n_8</code> by 3) matrix for time series data 8. The first column has <code class="reqn">n_8</code> observation times, the second column contains <code class="reqn">n_8</code> measurements/observations/magnitudes, the third column includes <code class="reqn">n_8</code> measurement error standard deviations. If the measurement error standard deviations are unknown, the third column must be a vector of <code class="reqn">n_8</code> zeros.
</p>
</td></tr>
<tr><td><code id="drw_+3A_data9">data9</code></td>
<td>
<p>Optional if more than eight time series data sets are available. An (<code class="reqn">n_9</code> by 3) matrix for time series data 9. The first column has <code class="reqn">n_9</code> observation times, the second column contains <code class="reqn">n_9</code> measurements/observations/magnitudes, the third column includes <code class="reqn">n_9</code> measurement error standard deviations. If the measurement error standard deviations are unknown, the third column must be a vector of <code class="reqn">n_9</code> zeros.
</p>
</td></tr>
<tr><td><code id="drw_+3A_data10">data10</code></td>
<td>
<p>Optional if more than nine time series data sets are available. An (<code class="reqn">n_{10}</code> by 3) matrix for time series data 10. The first column has <code class="reqn">n_{10}</code> observation times, the second column contains <code class="reqn">n_{10}</code> measurements/observations/magnitudes, the third column includes <code class="reqn">n_{10}</code> measurement error standard deviations. If the measurement error standard deviations are unknown, the third column must be a vector of <code class="reqn">n_{10}</code> zeros. The current version of package allows up to ten time series data sets. If users have more than ten time series data sets to be modeled simultaneously, please contact the authors.
</p>
</td></tr>
<tr><td><code id="drw_+3A_n.datasets">n.datasets</code></td>
<td>
<p>The number of time series data sets to be modeled simultaneously. An integer value inclusively between 1 to 10. For example, if &quot;<code>n.datasets = 3</code>&quot;, then users must enter <code>data1</code>, <code>data2</code>, and <code>data3</code> as inputs of <code>drw</code>.</p>
</td></tr>
<tr><td><code id="drw_+3A_method">method</code></td>
<td>
<p>If <code>method = "mle"</code>, it returns maximum likelihood estimates of the model parameters. If <code>method = "bayes"</code> it produces posterior samples of the model parameters.</p>
</td></tr>
<tr><td><code id="drw_+3A_bayes.n.burn">bayes.n.burn</code></td>
<td>
<p>Required for <code>method = "bayes"</code>. The number of warming-up iterations for a Markov chain Monte Carlo method.</p>
</td></tr>
<tr><td><code id="drw_+3A_bayes.n.sample">bayes.n.sample</code></td>
<td>
<p>Required for <code>method = "bayes"</code>. The size of a posterior sample for each parameter for a Markov chain Monte Carlo method.</p>
</td></tr>
<tr><td><code id="drw_+3A_mu.unifprior.range">mu.UNIFprior.range</code></td>
<td>
<p>Required for <code>method = "bayes"</code>. The range of the Uniform prior on each long-term avaerage <code class="reqn">\mu_j</code>of the process, where <code class="reqn">j</code> goes from 1 to the total number of time series data sets. The default range is (<code class="reqn">-30, 30</code>) for astronomical applications.</p>
</td></tr>
<tr><td><code id="drw_+3A_tau.igprior.shape">tau.IGprior.shape</code></td>
<td>
<p>Required for <code>method = "bayes"</code>. The shape parameter of the invserse-Gamma prior on each timescale <code class="reqn">\tau_j</code> of the process, where <code class="reqn">j</code> goes from 1 to the total number of time series data sets. The default shape parameter is one for astronomical applications.</p>
</td></tr>
<tr><td><code id="drw_+3A_tau.igprior.scale">tau.IGprior.scale</code></td>
<td>
<p>Required for <code>method = "bayes"</code>. The scale parameter of the invserse-Gamma prior on each timescale <code class="reqn">\tau_j</code>, where <code class="reqn">j</code> goes from 1 to the total number of time series data sets. The default scale parameter is one for astronomical applications.</p>
</td></tr>
<tr><td><code id="drw_+3A_sigma2.igprior.shape">sigma2.IGprior.shape</code></td>
<td>
<p>Required for <code>method = "bayes"</code>. The shape parameter of the invserse-Gamma prior on each short-term variability (variance) <code class="reqn">\sigma^2_j</code>, where <code class="reqn">j</code> goes from 1 to the total number of time series data sets. The default shape parameter is one for astronomical applications.</p>
</td></tr>
<tr><td><code id="drw_+3A_sigma2.igprior.scale">sigma2.IGprior.scale</code></td>
<td>
<p>Required for <code>method = "bayes"</code>. The scale parameter of the invserse-Gamma prior on each short-term variability (variance) <code class="reqn">\sigma^2_j</code>, where <code class="reqn">j</code> goes from 1 to the total number of time series data sets. The default shape parameter is 1e<code class="reqn">-7</code> for astronomical applications.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The multivariate damped random walk process <code class="reqn">{\bf X}(t)</code> is defined by the following stochastic differential equation:
</p>
<p style="text-align: center;"><code class="reqn">d {\bf X}(t) = -D_{{\bf\tau}}^{-1}({\bf X}(t) - {\bf\mu})dt + D_{{\bf\sigma}} d {\bf B}(t),</code>
</p>

<p>where <code class="reqn">{\bf X}(t)=\{X_1(t), \ldots, X_k(t)\}</code> is a vector of <code class="reqn">k</code> measurements/observations/magnitudes of the <code class="reqn">k</code> time series data sets in continuous time <code class="reqn">t\in R</code>, <code class="reqn">D_{\bf\tau}</code> is a <code class="reqn">k\times k</code> diagonal matrix whose diagonal elements are <code class="reqn">k</code> timescales with each <code class="reqn">\tau_j</code> representing the  timescale of the <code class="reqn">j</code>-th time series data, <code class="reqn">{\bf\mu}=\{\mu_1, \ldots, \mu_k\}</code> is a vector for long-term averages of the <code class="reqn">k</code> time series data sets, <code class="reqn">D_{{\bf\sigma}}</code> is <code class="reqn">k\times k</code> diagonal matrix whose diagonal elements are short-term variabilities (standard deviation) of <code class="reqn">k</code> time series data sets, and finally <code class="reqn">{\bf B}(t)=\{B_1(t), \ldots, B_k(t)\}</code> is a vector for <code class="reqn">k</code> standard Brownian motions whose <code class="reqn">k(k-1)/2</code> pairwise correlations are modeled by correlation parameters <code class="reqn">\rho_{jl}~(1\le j&lt;l\le k)</code> such that <code class="reqn">dB_j(t)B_l(t) = \rho_{jl} dt</code>.
</p>
<p>We evaluate this continuous-time process at <code class="reqn">n</code> discrete observation times <code class="reqn">{\bf t} = \{t_1, \ldots, t_n\}</code>.  The observed data <code class="reqn">{\bf x} = \{x_1, \ldots, x_n\}</code> are multiple time series data measured at irregularly spaced observation times <code class="reqn">{\bf t}</code> with possibly known measurement error standard deviations, <code class="reqn">\delta=\{\delta_1, \ldots, \delta_n\}</code>. Since one or more time series observations can be measured at each observation time <code class="reqn">t_i</code>, the length of a vector <code class="reqn">x_i</code> can be different, depending on how many time series observations are available at the <code class="reqn">i</code>-th observation time. We assume that these observed data <code class="reqn">{\bf x}</code> are realizations of the latent time series data sets <code class="reqn">{\bf X(t)} = \{{\bf X}(t_1), \ldots, {\bf X}(t_n)\}</code> with Gaussian measurement errors whose variances are <code class="reqn">\delta</code>. This is a typical setting of state-space modeling. We note that if the measurement error variances are unknown, <code class="reqn">\delta</code> must be set to zeros, which means that the observed data directly measure the latent values.
</p>
<p>Please note that when astronomical time series data are loaded on R by <code>read.table</code>, <code>read.csv</code>, etc., some decimal places of the the observation times are automatically rounded because R's default is to load seven effective digits. For example, R will load the observation time 51075.412789 as 51075.41. This default will produce many ties in observation times even though there is actually no tie in observation times. To prevent this, please type &quot;<code>options(digits = 11)</code>&quot; before loading the data if the observation times are in seven effective digits.
</p>


<h3>Value</h3>

<p>The outcomes of <code>drw</code> are composed of:
</p>

<dl>
<dt>mu</dt><dd><p>The maximum likelihood estimate(s) of the long-term average(s) if <code>method</code> is &quot;mle&quot;, and the posterior sample(s) of the long-term average(s) if <code>method</code> is &quot;bayes&quot;. In the former case (mle), it is a vector of length <code class="reqn">k</code>, where <code class="reqn">k</code> is the number of time series data sets used. In the later case (bayes), it is an (<code class="reqn">m</code> by <code class="reqn">k</code>) matrix where <code class="reqn">m</code> is the size of the posterior sample.</p>
</dd>
<dt>sigma</dt><dd><p>The maximum likelihood estimate(s) of the short-term variability (standard deviation) parameter(s) if <code>method</code> is &quot;mle&quot;, and the posterior sample(s) of the short-term variability parameter(s) if <code>method</code> is &quot;bayes&quot;. In the former case (mle), it is a vector of length <code class="reqn">k</code>, where <code class="reqn">k</code> is the number of time series data sets used. In the later case (bayes), it is an (<code class="reqn">m</code> by <code class="reqn">k</code>) matrix where <code class="reqn">m</code> is the size of the posterior sample.</p>
</dd>
<dt>tau</dt><dd><p>The maximum likelihood estimate(s) of the timescale(s) if <code>method</code> is &quot;mle&quot;, and the posterior sample(s) of the timescale(s) if <code>method</code> is &quot;bayes&quot;. In the former case (mle), it is a vector of length <code class="reqn">k</code>, where <code class="reqn">k</code> is the number of time series data sets used. In the later case (bayes), it is an (<code class="reqn">m</code> by <code class="reqn">k</code>) matrix where <code class="reqn">m</code> is the size of the posterior sample.</p>
</dd>
<dt>rho</dt><dd><p>Only when more than one time series data set are used. The maximum likelihood estimate(s) of the (cross-) correlation(s) if <code>method</code> is &quot;mle&quot;, and the posterior sample(s) of the (cross-) correlation(s) if <code>method</code> is &quot;bayes&quot;. In the former case (mle), it is a vector of length <code class="reqn">k(k-1)/2</code>, where <code class="reqn">k</code> is the number of time series data sets used, i.e., <code class="reqn">\rho_{12}, \ldots, \rho_{1k}, \rho_{23}, \ldots, \rho_{2k}, \ldots, \rho_{k-1, k}</code>. In the later case (bayes), it is an (<code class="reqn">m</code> by <code class="reqn">k(k-1)/2</code>) matrix where <code class="reqn">m</code> is the size of the posterior sample.</p>
</dd>
<dt>mu.accept.rate</dt><dd><p>Only when <code>method</code> is &quot;bayes&quot;. The MCMC acceptance rate(s) of the long-term average parameter(s).</p>
</dd>
<dt>sigma.accept.rate</dt><dd><p>Only when <code>method</code> is &quot;bayes&quot;. The MCMC acceptance rate(s) of the short-term variability parameter(s).</p>
</dd>
<dt>tau.accept.rate</dt><dd><p>Only when <code>method</code> is &quot;bayes&quot;. The MCMC acceptance rate(s) of the timescale(s).</p>
</dd>
<dt>rho.accept.rate</dt><dd><p>Only when more than one time series data set are used with <code>method = "bayes"</code>. The MCMC acceptance rate(s) of the (cross-) correlation(s).</p>
</dd>
<dt>data.comb</dt><dd><p>The combined data set if more than one time series data set are used, and data1 if only one time series data set is used. This output is only available when <code>method</code> is set to &quot;bayes&quot;.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Zhirui Hu and Hyungsuk Tak
</p>


<h3>References</h3>

<p>Zhirui Hu and Hyungsuk Tak (2020+), &quot;Modeling Stochastic Variability in  Multi-Band Time Series Data,&quot; arXiv:2005.08049.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>########## Fitting a univariate damped random walk process

##### Fitting a univariate damped random walk process based on a simulation

n1 &lt;- 20 
# the number of observations in the data set

obs.time1 &lt;- cumsum(rgamma(n1, shape = 3, rate = 1))
# the irregularly-spaced observation times 

y1 &lt;- rnorm(n1)
# the measurements/observations/magnitudes

measure.error.SD1 &lt;- rgamma(n1, shape = 0.01)
# optional measurement error standard deviations, 
# which is typically known in astronomical time series data
# if not known in other applications, set them to zeros, i.e.,
# measure.error.SD1 &lt;- rep(0, n1)

data1 &lt;- cbind(obs.time1, y1, measure.error.SD1)
# combine the single time series data set into an n by 3 matrix

# Note that when astronomical time series data are loaded on R (e.g., read.table, read.csv), 
# the digits of the observation times are typically rounded to seven effective digits.
# That means rounding may occur, which produces ties in observation times even though
# the original observation times are not the same.
# In this case, type the following code before loading the data.
# options(digits = 11)

res1.mle &lt;- drw(data1 = data1, n.datasets = 1, method = "mle")
# obtain maximum likelihood estimates of the model parameters and 
# assign the result to object "res1.mle"

names(res1.mle)
# to see the maximum likelihood estimates,
# type "res1.mle$mu", "res1.mle$sigma", "res1.mle$tau"


res1.bayes &lt;- drw(data1 = data1, n.datasets = 1, method = "bayes", 
                  bayes.n.burn = 10, bayes.n.sample = 10)

# obtain 10 posterior samples of each model parameter and
# save the result to object "res1.bayes"

# names(res1.bayes)
# to work on the posterior sample of each parameter, try 
# "res1.bayes$mu.accept.rate", "res1.bayes$sigma.accept.rate", "res1.bayes$tau.accept.rate"
# "hist(res1.bayes$mu)", "mean(res1.bayes$mu)", "sd(res1.bayes$mu)",
# "median(log(res1.bayes$sigma, base = 10))", 
# "quantile(log(res1.bayes$tau, base = 10), prob = c(0.025, 0.975))"


##### Fitting a multivariate damped random walk process based on simulations

n2 &lt;- 10 
# the number of observations in the second data set

obs.time2 &lt;- cumsum(rgamma(n2, shape = 3, rate = 1))
# the irregularly-spaced observation times of the second data set

y2 &lt;- rnorm(n2)
# the measurements/observations/magnitudes of the second data set

measure.error.SD2 &lt;- rgamma(n2, shape = 0.01)
# optional measurement error standard deviations of the second data set, 
# which is typically known in astronomical time series data
# if not known in other applications, set them to zeros, i.e.,
# measure.error.SD2 &lt;- rep(0, n2)

data2 &lt;- cbind(obs.time2, y2, measure.error.SD2)
# combine the single time series data set into an n by 3 matrix


res2.mle &lt;- drw(data1 = data1, data2 = data2, n.datasets = 2, method = "mle")

# obtain maximum likelihood estimates of the model parameters and 
# assign the result to object "res2.mle"


res2.bayes &lt;- drw(data1 = data1, data2 = data2, n.datasets = 2, method = "bayes", 
                  bayes.n.burn = 10, bayes.n.sample = 10)

# obtain 10 posterior samples of each model parameter and
# save the result to object "res2.bayes"

# names(res2.bayes)
# to work on the posterior sample of each parameter, try 
# "hist(res2.bayes$mu[, 1])", "colMeans(res2.bayes$mu)", "apply(res2.bayes$mu, 2, sd)",
# "hist(log(res2.bayes$sigma[, 2], base = 10))", 
# "apply(log(res2.bayes$sigma, base = 10), 2, median)", 
# "apply(log(res2.bayes$tau, base = 10), 2, quantile, prob = c(0.025, 0.975))"
</code></pre>

<hr>
<h2 id='drw.sim'>Simulating univariate and multiviarate damped random walk processes</h2><span id='topic+drw.sim'></span>

<h3>Description</h3>

<p>The function <code>drw.sim</code> simulates time series data set(s) following either univariate or multivariate damped random walk process.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>drw.sim(time, n.datasets, measure.error.SD, mu, sigma, tau, rho)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="drw.sim_+3A_time">time</code></td>
<td>
<p>A vector containing observation times. Let us use <code class="reqn">n</code> to denote the length of this vector.
</p>
</td></tr>
<tr><td><code id="drw.sim_+3A_n.datasets">n.datasets</code></td>
<td>
<p>Any positive integer value that denotes the number of time series data sets to be simulated. In simulation, there is no upper limit in the number of time series data sets. Let's use <code class="reqn">k</code> to denote this number of time series data sets.
</p>
</td></tr>
<tr><td><code id="drw.sim_+3A_measure.error.sd">measure.error.SD</code></td>
<td>
<p>Optional if measurement error standard deviations are known and available. If one time series data set is simulated, it is a vector of length <code class="reqn">n</code> containing measurement error standard deviations. If more than one time series data sets are simulated, it is an <code class="reqn">n</code> by <code class="reqn">k</code> matrix composed of measurement error standard deviations. If such information is not available, it is automatically set to zeros.</p>
</td></tr>
<tr><td><code id="drw.sim_+3A_mu">mu</code></td>
<td>
<p>A vector of length <code class="reqn">k</code>, containing the long-term average parameter(s) of the process.</p>
</td></tr>
<tr><td><code id="drw.sim_+3A_sigma">sigma</code></td>
<td>
<p>A vector of length <code class="reqn">k</code>, containing the short-term variability parameter(s) (standard deviation) of the process.</p>
</td></tr>
<tr><td><code id="drw.sim_+3A_tau">tau</code></td>
<td>
<p>A vector of length <code class="reqn">k</code>, containing the timescale parameter(s) of the process.</p>
</td></tr>
<tr><td><code id="drw.sim_+3A_rho">rho</code></td>
<td>
<p>Required if more than one time series data sets are simulated <code class="reqn">(k&gt;1)</code>. A vector of length <code class="reqn">k(k-1)/2</code>, containing the cross-correlation parameters of the process. For example, if <code class="reqn">k=3</code>, this is a vector composed of <code class="reqn">\rho_{12}</code>, <code class="reqn">\rho_{13}</code>, <code class="reqn">\rho_{23}</code>. If <code class="reqn">k=5</code>, this is a vector composed of <code class="reqn">\rho_{12}</code>, <code class="reqn">\rho_{13}</code>, <code class="reqn">\rho_{14}</code>, <code class="reqn">\rho_{15}</code>, <code class="reqn">\rho_{23}</code>, <code class="reqn">\rho_{24}</code>, <code class="reqn">\rho_{25}</code>, <code class="reqn">\rho_{34}</code>, <code class="reqn">\rho_{35}</code>, <code class="reqn">\rho_{45}</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given the <code class="reqn">n</code> observation times and model parameter values (mu, sigma, tau, rho) possibly with known measurement error standard deviations, this function simulates <code class="reqn">k</code> time series data sets.
</p>


<h3>Value</h3>

<p>The outcome of <code>drw.sim</code> is composed of:
</p>

<dl>
<dt>x</dt><dd><p>An <code class="reqn">n</code> by <code class="reqn">k</code> matrix composed of <code class="reqn">k</code> simulated time series data each with length <code class="reqn">n</code>. That is, each column is corresponding to one simulated time series data set.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Zhirui Hu and Hyungsuk Tak
</p>


<h3>References</h3>

<p>Zhirui Hu and Hyungsuk Tak (2020+), &quot;Modeling Stochastic Variability in  Multi-Band Time Series Data,&quot; arXiv:2005.08049.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>########## Simulating a multivariate damped random walk process

n &lt;- 100
k &lt;- 5
obs.time &lt;- cumsum(rgamma(n, shape = 3, rate = 1))

tau &lt;- 100 + 20 * (1 : 5) #rnorm(k, 0, 5)
sigma &lt;- 0.01 * (1 : 5)
#tau &lt;- c(1 : 5) #rnorm(k, 0, 5)
#sigma &lt;- 0.05  + 0.007 * (0 : 4) #rnorm(k, 0, 0.002)
mu &lt;- 17 + 0.5 * (1 : 5)

rho.m &lt;- matrix(0, k, k)
for(i in 1 : k) {
  for(j in 1 : k) {
    rho.m[i, j] = 1.1^(-abs(i - j))
  }
}

rho &lt;- rho.m[upper.tri(rho.m)]

measure.error.band &lt;- c(0.010, 0.014, 0.018, 0.022, 0.026)
measure.error &lt;- NULL
for(i in 1 : k) {
  measure.error &lt;- cbind(measure.error, rnorm(n, measure.error.band[i], 0.002))
}

x &lt;- drw.sim(time = obs.time, n.datasets = 5, measure.error.SD = measure.error,
             mu = mu, sigma = sigma, tau = tau, rho = rho)


plot(obs.time, x[, 1], xlim = c(min(obs.time), max(obs.time)), ylim = c(17, 20),
     xlab = "time", ylab = "observation")
points(obs.time, x[, 2], col = 2, pch = 2)
points(obs.time, x[, 3], col = 3, pch = 3)
points(obs.time, x[, 4], col = 4, pch = 4)
points(obs.time, x[, 5], col = 5, pch = 5)

########## Simulating a univariate damped random walk process

x &lt;- drw.sim(time = obs.time, n.datasets = 1, measure.error.SD = measure.error[, 1],
             mu = mu[1], sigma = sigma[1], tau = tau[1])
plot(obs.time, x)
</code></pre>

<hr>
<h2 id='Rdrw-internal'>Internal <code>drw</code> functions</h2><span id='topic+log.lik'></span><span id='topic+log.lik.single'></span><span id='topic+bayes'></span><span id='topic+bayes.single'></span>

<h3>Description</h3>

<p>Internal <code>drw</code> functions</p>


<h3>Details</h3>

<p>These are not to be called by users.</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
