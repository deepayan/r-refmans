<!DOCTYPE html><html lang="en"><head><title>Help for package archiDART</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {archiDART}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#archidraw'><p>Plotting Vectorized Root Systems</p></a></li>
<li><a href='#archigrow'><p>Computing Growth Rates and Plotting of Vectorized Root Systems</p></a></li>
<li><a href='#architect'><p>Computing Traits Describing The Global Root System Architecture</p></a></li>
<li><a href='#bottleneckdist'><p>Computing a Pairwise Bottleneck Distance Matrix</p></a></li>
<li><a href='#dartToTable'><p>Import DART Files Into a Single Data Frame</p></a></li>
<li><a href='#latdist'><p>Computing Lateral Root Length and Density Distribution</p></a></li>
<li><a href='#perhomology'><p>Topological Analysis using Persistent Homology</p></a></li>
<li><a href='#plot.barcode'><p>Plot the Persistence Barcode</p></a></li>
<li><a href='#root'><p>Computing Attributes for Each Root</p></a></li>
<li><a href='#rsmlToTable'><p>Import RSML Files Into a Single Data Frame</p></a></li>
<li><a href='#trajectory'><p>Computing Root Growth Directions and Trajectories</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Plant Root System Architecture Analysis Using DART and RSML
Files</td>
</tr>
<tr>
<td>Version:</td>
<td>3.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-02-07</td>
</tr>
<tr>
<td>Author:</td>
<td>Benjamin M Delory, Caroline Baudson, Yves Brostaux, Guillaume Lobet, Patrick du Jardin, Loic Pages, Pierre Delaplace </td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Benjamin M Delory &lt;Benjamin.Delory@leuphana.de&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Analysis of complex plant root system architectures (RSA) using the output files created by Data Analysis of Root Tracings (DART), an open-access software dedicated to the study of plant root architecture and development across time series (Le Bot et al (2010) "DART: a software to analyse root system architecture and development from captured images", Plant and Soil, &lt;<a href="https://doi.org/10.1007%2Fs11104-009-0005-2">doi:10.1007/s11104-009-0005-2</a>&gt;), and RSA data encoded with the Root System Markup Language (RSML) (Lobet et al (2015) "Root System Markup Language: toward a unified root architecture description language", Plant Physiology, &lt;<a href="https://doi.org/10.1104%2Fpp.114.253625">doi:10.1104/pp.114.253625</a>&gt;). More information can be found in Delory et al (2016) "archiDART: an R package for the automated computation of plant root architectural traits", Plant and Soil, &lt;<a href="https://doi.org/10.1007%2Fs11104-015-2673-4">doi:10.1007/s11104-015-2673-4</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, utils, graphics, gtools, grDevices, XML, geometry, sp</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rgl, TDA</td>
</tr>
<tr>
<td>Additional_repositories:</td>
<td><a href="https://archidart.github.io/drat/">https://archidart.github.io/drat/</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://archidart.github.io/">https://archidart.github.io/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/archiDART/archidart/issues">https://github.com/archiDART/archidart/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-02-08 07:39:48 UTC; Delory</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-02-11 15:40:15 UTC</td>
</tr>
</table>
<hr>
<h2 id='archidraw'>Plotting Vectorized Root Systems</h2><span id='topic+archidraw'></span>

<h3>Description</h3>

<p>Plotting vectorized root systems for selected observation dates using Data Analysis of Root Tracings (DART) output files and RSA data encoded with the Root System Markup Language (RSML). More information can be found in <cite>Delory et al (2016)</cite>, <cite>Le Bot et al (2010)</cite>, and <cite>Lobet et al (2015)</cite>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>archidraw(inputlie=NULL, inputrsml=NULL, res=NULL, unitlength="px", rsml.connect=FALSE,
          rsml.date=NULL, unitangle="d", rotation=0, numdate=NULL, finalscale=NULL,
          coldate=par("col"), twod=NULL, main=NULL, xlab=NULL, ylab=NULL, zlab=NULL, 
          xlim=NULL, ylim=NULL, zlim=NULL,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="archidraw_+3A_inputlie">inputlie</code></td>
<td>
<p>A character string specifying the path to the folder containing the lie files created by DART. This argument could be the same as <code>inputrsml</code>.</p>
</td></tr>
<tr><td><code id="archidraw_+3A_inputrsml">inputrsml</code></td>
<td>
<p>A character string specifying the path to the folder containing the RSML files. This argument could be the same as <code>inputlie</code>.</p>
</td></tr>
<tr><td><code id="archidraw_+3A_res">res</code></td>
<td>
<p>Mandatory for DART files only. <b>If images were acquired with a flatbed scanner</b>: a numeric value specifying the resolution of the images used to vectorize the root systems with DART (resolution is expressed in dots/inch). <b>If images were acquired with a digital camera</b>: the ratio between the length of a reference object located on the image expressed in pixels and the actual length of the same object expressed in inches. For DART files, this argument must be specified if <code>unitlength="mm"</code> or <code>unitlength="cm"</code>. For RSML files, the resolution is imported from the metadata and does not need to be specified as an argument.</p>
</td></tr>
<tr><td><code id="archidraw_+3A_unitlength">unitlength</code></td>
<td>
<p>A character string specifying the unit of length that must be used to plot the root systems. The value acceptable for this argument could be either &ldquo;px&rdquo; for pixels, &ldquo;cm&rdquo; for centimetres or &ldquo;mm&rdquo; for millimetres.</p>
</td></tr>
<tr><td><code id="archidraw_+3A_rsml.connect">rsml.connect</code></td>
<td>
<p>Only used for RSML files. A logical value that must be specified when <code>is.null(inputrsml)=FALSE</code>. If <code>TRUE</code>, the lateral roots are connected to their parent root (see details). If <code>FALSE</code>, no connection is made between daughter and mother roots.</p>
</td></tr>
<tr><td><code id="archidraw_+3A_rsml.date">rsml.date</code></td>
<td>
<p>Only used for RSML files. A numeric value specifying the root system age (the unit of time is defined by the user). If <code>rsml.date=NULL</code>, a default value of 1 is used by the function. If the root system age is stored as a continuous function along the root segments, a character string specifying the name/label of the function can be used (see details).</p>
</td></tr>
<tr><td><code id="archidraw_+3A_unitangle">unitangle</code></td>
<td>
<p>A character string specifying the unit that must be used to express the calculated angles. The value acceptable for this argument could be either &ldquo;d&rdquo; for degrees (default value) or &ldquo;r&rdquo; for radians.</p>
</td></tr>
<tr><td><code id="archidraw_+3A_rotation">rotation</code></td>
<td>
<p>A numeric value specifying the angle (expressed in <code>unitangle</code>) that must be used to perform a clockwise rotation of 2D root systems (see details).</p>
</td></tr>
<tr><td><code id="archidraw_+3A_numdate">numdate</code></td>
<td>
<p>A numeric value or a vector of numeric values specifying the identification number of all observation dates at which the root system(s) must be plotted (see details).</p>
</td></tr>
<tr><td><code id="archidraw_+3A_finalscale">finalscale</code></td>
<td>
<p>A logical value that must be specified when <code>is.null(numdate)=FALSE</code>. If <code>TRUE</code>, the root system architecture at the selected observation dates is plotted with the same axis scales to that used to draw the root system architecture at the last observation date. If <code>FALSE</code>, the root system architecture at each observation date is plotted using different axis ranges of coordinates (<code>xlim</code> and <code>ylim</code>).</p>
</td></tr>
<tr><td><code id="archidraw_+3A_coldate">coldate</code></td>
<td>
<p>A vector specifying the color(s) that must be used to plot the root system(s) at the selected observation dates (see details).</p>
</td></tr>
<tr><td><code id="archidraw_+3A_twod">twod</code></td>
<td>
<p>When RSML files contain 3D RSA data, should the root systems be plotted in 2D? This argument can be NULL (3D plots) or a character vector giving the name of the axes to plot (can be c(&ldquo;x&rdquo;, &ldquo;y&rdquo;), c(&ldquo;x&rdquo;, &ldquo;z&rdquo;), or c(&ldquo;y&rdquo;, &ldquo;z&rdquo;)).</p>
</td></tr>
<tr><td><code id="archidraw_+3A_main">main</code></td>
<td>
<p>A character string giving a main title for the plot. When <code>main=NULL</code>, the default title for each plot is the name of the corresponding lie/RSML file.</p>
</td></tr>
<tr><td><code id="archidraw_+3A_xlab">xlab</code></td>
<td>
<p>A character string giving a label for the X axis. When <code>xlab=NULL</code>, the default label for the X axis is X (<code>unitlength</code>).</p>
</td></tr>
<tr><td><code id="archidraw_+3A_ylab">ylab</code></td>
<td>
<p>A character string giving a label for the Y axis. When <code>ylab=NULL</code>, the default label for the Y axis is Y (<code>unitlength</code>).</p>
</td></tr>
<tr><td><code id="archidraw_+3A_zlab">zlab</code></td>
<td>
<p>A character string giving a label for the Z axis. When <code>zlab=NULL</code>, the default label for the Z axis is Z (<code>unitlength</code>).</p>
</td></tr>
<tr><td><code id="archidraw_+3A_xlim">xlim</code></td>
<td>
<p>A numeric vector (length=2) giving the X limits of the plot using the same unit as <code>unitlength</code>.</p>
</td></tr>
<tr><td><code id="archidraw_+3A_ylim">ylim</code></td>
<td>
<p>A numeric vector (length=2) giving the Y limits of the plot using the same unit as <code>unitlength</code>.</p>
</td></tr>
<tr><td><code id="archidraw_+3A_zlim">zlim</code></td>
<td>
<p>A numeric vector (length=2) giving the Z limits of the plot using the same unit as <code>unitlength</code>.</p>
</td></tr>
<tr><td><code id="archidraw_+3A_...">...</code></td>
<td>
<p>Additional graphical parameters (see details).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To run <code>archidraw</code> efficiently, DART and RSML files must have been saved with their appropriate extension (.lie or .rsml).  By default (when <code>numdate=NULL</code>), only the root system architecture at the last observation date is plotted.
</p>
<p>If the number of elements specified in <code>coldate</code> is lower than the number of observation dates, <code>archidraw</code> replicates the elements stored in <code>coldate</code> to plot the root system(s).  When the number of elements specified in <code>coldate</code> is greater than the number of observation dates, only the first corresponding elements in <code>coldate</code> are used by <code>archidraw</code> to plot the root system(s).  
</p>
<p>After reading the RSML files located in <code>inputrsml</code>, the data associated with each root system are converted into a data frame possessing the same structure as the lie files created by DART.  The <code>archidraw</code> function then uses these data frames to plot the root system(s). 
</p>
<p>The argument <code>rsml.date</code> is used to create a tps file for each root system located in <code>inputrsml</code>.  If the root system age is stored as a continuous function along the root segments, the <code>rsml.date</code> argument can be a character string specifying the name/label of the function.  For instance, the root system age at the first apparition of each node is stored as a continuous function called &ldquo;age&rdquo; in RSML files containing RSA data simulated with the ArchiSimple model (<cite>Pages et al (2013)</cite>).  The &ldquo;age&rdquo; function attaches the root system age along the root segments, so that each node is associated with one age value.  An RSML library containing 3D RSA data simulated with ArchiSimple is available here: doi: <a href="https://doi.org/10.5281/zenodo.208214">10.5281/zenodo.208214</a>.
</p>
<p>The <code>rsml.connect</code> argument can be used to connect the lateral roots to their corresponding mother root.  If <code>rsml.connect=TRUE</code>, each point starting a lateral root is connected to the nearest point located on its mother root.  DBase is approximated by the distance between the parent root base and the point located on the mother root that is closest to the point starting a lateral root.  Using RSML files, only RSA data associated with roots possessing a branching order lower or equal to 7 are used for the computation of RSA traits.
</p>
<p>Due to technical limitations, it is sometimes easier to take a picture of a root system if it is rotated before image acquisition.  In this case, the vectorized root system depicts a rotation compared with the natural plant root system.  In order to make a correction, one can use <code>rotation</code> to specify an angle value expressed in <code>unitangle</code> to rotate the vectorized root system clockwise before plotting.  
</p>
<p>Additional graphical parameters can be used to personalize the graphical outputs (see <code><a href="graphics.html#topic+par">par</a></code>).
</p>
<p>Making 3D plots with <code>twod = NULL</code> requires the <code>rgl</code> package, which is otherwise optional. If it is not installed (which can be annoying to do on some OSes), <code>archidraw()</code> will complain when you attempt a 3D plot but will still work normally for 2D.
</p>


<h3>Value</h3>

<p>Returns a plot for each vectorized root system located in <code>inputlie</code>/<code>inputrsml</code>.
</p>


<h3>Author(s)</h3>

<p>Benjamin M. Delory, Caroline Baudson, Yves Brostaux, Guillaume Lobet, Loic Pages, Patrick du Jardin, Pierre Delaplace
</p>


<h3>References</h3>

<p>Delory B.M., Baudson C., Brostaux Y., Lobet G., du Jardin P., Pages L., Delaplace P. (2016) archiDART: an R package for the automated computation of plant root architectural traits, <em>Plant and Soil</em>, DOI: 10.1007/s11104-015-2673-4.
</p>
<p>Le Bot J., Serra V., Fabre J., Draye X., Adamowicz S., Pages L. (2010) DART: a software to analyse root system architecture and development from captured images, <em>Plant and Soil</em>, DOI: 10.1007/s11104-009-0005-2.
</p>
<p>Lobet G., Pound M.P., Diener J., Pradal C., Draye X., Godin C., Javaux M., Leitner D., Meunier F., Nacry P., Pridmore T.P., Schnepf A. (2015) Root System Markup Language: Toward a Unified Root Architecture Description Language, <em>Plant Physiology</em>, DOI: 10.1104/pp.114.253625.
</p>
<p>Pages L., Becel C., Boukcim H., Moreau D., Nguyen C., Voisin, A-S. (2013) Calibration and evaluation of ArchiSimple, a simple model of root system architecture, <em>Ecological Modelling</em>, DOI: 10.1016/j.ecolmodel.2013.11.014.
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+par">par</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Locate folder with DART and RSML files
path &lt;- system.file("extdata", package="archiDART")

##-----------------
## DART files only
##-----------------

## Plot RSA at several observation dates
## One color for each observation date
archidraw(inputlie=path, res=75, unitlength="cm", numdate=c(15,31), finalscale=TRUE,
coldate=rainbow(31), lwd=2,las=1, bty="l", asp=1, xaxp=c(0,30,3), yaxp=c(0,90,9))

##-----------------
## RSML files only
##-----------------

## Plot RSA at the last observation date
## One color for each observation date
##2D plot
archidraw(inputrsml=path, unitlength="cm", rsml.date="age", coldate=rainbow(15), lwd=2,
twod=c("x", "y"), asp=1, las=1, bty="l")
          
##---------------------
## DART and RSML files
##---------------------

archidraw(inputlie=path, inputrsml=path, res=75, unitlength="cm", rsml.date="age",
coldate="black", twod=c("x", "y"), lwd=2, las=1, bty="l", asp=1)
</code></pre>

<hr>
<h2 id='archigrow'>Computing Growth Rates and Plotting of Vectorized Root Systems</h2><span id='topic+archigrow'></span>

<h3>Description</h3>

<p>Calculation of growth rate matrices and plotting of vectorized root systems for selected observation dates using Data Analysis of Root Tracings (DART) output files and RSA data encoded with the Root System Markup Language (RSML). In the final plots, the color code used for each link constituting a vectorized root system depends on its corresponding growth rate value. More information can be found in <cite>Delory et al (2016)</cite>, <cite>Le Bot et al (2010)</cite>, and <cite>Lobet et al (2015)</cite>.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>archigrow(inputlie=NULL, inputtps=NULL, inputrsml=NULL, res=NULL, unitlength="px",
          rsml.date="age", rsml.connect=TRUE, plot=TRUE, twod=NULL, export.colors=FALSE,
          unittime=NULL, unitangle="d", rotation=0, numdate=NULL, finalscale=NULL,
          coldyn=NULL, GRscale=NULL, main=NULL, xlab=NULL, ylab=NULL, zlab=NULL,
          xlim=NULL, ylim=NULL, zlim=NULL, ...)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="archigrow_+3A_inputlie">inputlie</code></td>
<td>
<p>A character string specifying the path to the folder containing the lie files created by DART. This argument could be the same as <code>inputtps</code>/<code>inputrsml</code>.</p>
</td></tr>
<tr><td><code id="archigrow_+3A_inputtps">inputtps</code></td>
<td>
<p>A character string specifying the path to the folder containing the tps files created by DART. This argument could be the same as <code>inputlie</code>/<code>inputrsml</code>.</p>
</td></tr>
<tr><td><code id="archigrow_+3A_inputrsml">inputrsml</code></td>
<td>
<p>A character string specifying the path to the folder containing the RSML files. This argument could be the same as <code>inputlie</code>/<code>inputtps</code>.</p>
</td></tr>
<tr><td><code id="archigrow_+3A_res">res</code></td>
<td>
<p>Mandatory for DART files only. <b>If images were acquired with a flatbed scanner</b>: a numeric value specifying the resolution of the images used to vectorize the root systems with DART (resolution is expressed in dots/inch). <b>If images were acquired with a digital camera</b>: the ratio between the length of a reference object located on the image expressed in pixels and the actual length of the same object expressed in inches. For DART files, this argument must be specified if <code>unitlength="mm"</code> or <code>unitlength="cm"</code>. For RSML files, the resolution is imported from the metadata and does not need to be specified as an argument.</p>
</td></tr>
<tr><td><code id="archigrow_+3A_unitlength">unitlength</code></td>
<td>
<p>A character string specifying the unit of length that must be used by the function to plot the root systems. The value acceptable for this argument could be either &ldquo;px&rdquo; for pixels, &ldquo;cm&rdquo; for centimetres or &ldquo;mm&rdquo; for millimetres.</p>
</td></tr>
<tr><td><code id="archigrow_+3A_rsml.date">rsml.date</code></td>
<td>
<p>Only used for RSML files. A numeric value specifying the root system age (the unit of time is defined by the user). If <code>rsml.date=NULL</code>, a default value of 1 is used by the function. If the root system age is stored as a continuous function along the root segments, a character string specifying the name/label of the function can be used (see details).</p>
</td></tr>
<tr><td><code id="archigrow_+3A_rsml.connect">rsml.connect</code></td>
<td>
<p>Only used for RSML files. A logical value that must be specified when <code>is.null(inputrsml)=FALSE</code>. If <code>TRUE</code>, the lateral roots are connected to their parent root (see details). If <code>FALSE</code>, no connection is made between daughter and mother roots.</p>
</td></tr>
<tr><td><code id="archigrow_+3A_plot">plot</code></td>
<td>
<p>A logical value. Should the root system(s) be plotted? <code>TRUE</code> is yes, <code>FALSE</code> is no.</p>
</td></tr>
<tr><td><code id="archigrow_+3A_twod">twod</code></td>
<td>
<p>When RSML files contain 3D RSA data, should the root systems be plotted in 2D? This argument can be NULL (3D plots) or a character vector giving the name of the axes to plot (can be c(&ldquo;x&rdquo;, &ldquo;y&rdquo;), c(&ldquo;x&rdquo;, &ldquo;z&rdquo;), or c(&ldquo;y&rdquo;, &ldquo;z&rdquo;)).</p>
</td></tr>
<tr><td><code id="archigrow_+3A_export.colors">export.colors</code></td>
<td>
<p>A logical value. Should the color values be exported? If <code>TRUE</code>, a matrix giving the color code of each root at each observation date is exported. If <code>FALSE</code>, no color matrix is exported.</p>
</td></tr>
<tr><td><code id="archigrow_+3A_unittime">unittime</code></td>
<td>
<p>A character string specifying the unit of time used to express the data (all character strings are valid for this argument). For RSML files, unittime is imported from the metadata and does not need to be specified as an argument.</p>
</td></tr>
<tr><td><code id="archigrow_+3A_unitangle">unitangle</code></td>
<td>
<p>A character string specifying the unit that must be used by the function to express the calculated angles. The value acceptable for this argument could be either &ldquo;d&rdquo; for degrees (default value) or &ldquo;r&rdquo; for radians.</p>
</td></tr>
<tr><td><code id="archigrow_+3A_rotation">rotation</code></td>
<td>
<p>A numeric value specifying the angle (expressed in <code>unitangle</code>) that must be used to perform a clockwise rotation of 2D root systems (see details).</p>
</td></tr>
<tr><td><code id="archigrow_+3A_numdate">numdate</code></td>
<td>
<p>A numeric value or a vector of numeric values specifying the identification number of all observation dates at which the root system(s) must be plotted (see details).</p>
</td></tr>
<tr><td><code id="archigrow_+3A_finalscale">finalscale</code></td>
<td>
<p>A logical value that must be specified when <code>is.null(numdate)=FALSE</code>. If <code>TRUE</code>, the root system architecture at the selected observation dates is plotted with the same axis scales to that used to draw the root system architecture at the last observation date. If <code>FALSE</code>, the root system architecture at each observation date is plotted using different axis ranges of coordinates (<code>xlim</code> and <code>ylim</code>).</p>
</td></tr>
<tr><td><code id="archigrow_+3A_coldyn">coldyn</code></td>
<td>
<p>A vector specifying the color(s) that must be used to plot the root system(s) at the selected observation dates. The function colors each link constituting a vectorized root system depending on its corresponding growth rate value. To do so, <code>archigrow</code> interpolates the color(s) contained in <code>coldyn</code> between the minimum and the maximum values of the computed standardized growth rate matrix (if <code>is.null(GRscale)=TRUE</code>) or between <code>min(GRscale)</code> and <code>max(GRscale)</code> (if <code>is.null(GRscale)=FALSE</code>).</p>
</td></tr>
<tr><td><code id="archigrow_+3A_grscale">GRscale</code></td>
<td>
<p>A numeric vector (length=2) specifying the minimum and the maximum growth rate values (expressed in <code>unitlength</code>/<code>unittime</code>) that must be used to plot each vectorized root system.</p>
</td></tr>
<tr><td><code id="archigrow_+3A_main">main</code></td>
<td>
<p>A character string giving a main title for the plot. When <code>is.null(main)=TRUE</code>, the default title for each plot is the name of the corresponding lie/RSML file.</p>
</td></tr>
<tr><td><code id="archigrow_+3A_xlab">xlab</code></td>
<td>
<p>A character string giving a label for the X axis. When <code>is.null(xlab)=TRUE</code>, the default label for the X axis is X (<code>unitlength</code>).</p>
</td></tr>
<tr><td><code id="archigrow_+3A_ylab">ylab</code></td>
<td>
<p>A character string giving a label for the Y axis. When <code>is.null(ylab)=TRUE</code>, the default label for the Y axis is Y (<code>unitlength</code>).</p>
</td></tr>
<tr><td><code id="archigrow_+3A_zlab">zlab</code></td>
<td>
<p>A character string giving a label for the Z axis. When <code>is.null(zlab)=TRUE</code>, the default label for the Z axis is Z (<code>unitlength</code>).</p>
</td></tr>
<tr><td><code id="archigrow_+3A_xlim">xlim</code></td>
<td>
<p>A numeric vector (length=2) giving the X limits of the plot using the same unit as <code>unitlength</code>.</p>
</td></tr>
<tr><td><code id="archigrow_+3A_ylim">ylim</code></td>
<td>
<p>A numeric vector (length=2) giving the Y limits of the plot using the same unit as <code>unitlength</code>.</p>
</td></tr>
<tr><td><code id="archigrow_+3A_zlim">zlim</code></td>
<td>
<p>A numeric vector (length=2) giving the Z limits of the plot using the same unit as <code>unitlength</code>.</p>
</td></tr>
<tr><td><code id="archigrow_+3A_...">...</code></td>
<td>
<p>Additional graphical parameters (see details).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To run <code>archigrow</code> efficiently, DART and RSML files must have been saved with their appropriate extension (.lie, .tps, or .rsml).  By default (when <code>numdate=NULL</code>), only the root system architecture at the last observation date is plotted.
</p>
<p>If <code>inputtps</code> contains more than one tps file, the number of tps files in <code>inputtps</code> must be equal to the number of lie files in <code>inputlie</code> and corresponding lie and tps files must have the same name.
</p>
<p>After reading the RSML files located in <code>inputrsml</code>, the data associated with each root system are converted into a data frame possessing the same structure as the lie files created by DART.  The <code>archigrow</code> function then uses these data frames to plot the root system(s). 
</p>
<p>The argument <code>rsml.date</code> is used to create a tps file for each root system located in <code>inputrsml</code>.  If the root system age is stored as a continuous function along the root segments, the <code>rsml.date</code> argument can be a character string specifying the name/label of the function.  For instance, the root system age at the first apparition of each node is stored as a continuous function called &ldquo;age&rdquo; in RSML files containing RSA data simulated with the ArchiSimple model (<cite>Pages et al (2013)</cite>).  The &ldquo;age&rdquo; function attaches the root system age along the root segments, so that each node is associated with one age value.  An RSML library containing 3D RSA data simulated with ArchiSimple is available here: doi: <a href="https://doi.org/10.5281/zenodo.208214">10.5281/zenodo.208214</a>.
</p>
<p>The <code>rsml.connect</code> argument can be used to connect the lateral roots to their corresponding mother root.  If <code>rsml.connect=TRUE</code>, each point starting a lateral root is connected to the nearest point located on its mother root.  DBase is approximated by the distance between the parent root base and the point located on the mother root that is closest to the point starting a lateral root.  Using RSML files, only RSA data associated with roots possessing a branching order lower or equal to 7 are used for the computation of RSA traits.
</p>
<p>Due to technical limitations, it is sometimes easier to take a picture of a root system if it is rotated before image acquisition.  In this case, the vectorized root system depicts a rotation compared with the natural plant root system.  In order to make a correction, one can use <code>rotation</code> to specify an angle value expressed in <code>unitangle</code> to rotate the vectorized root system clockwise before plotting.  
</p>
<p>Additional graphical parameters can be used to personalize the graphical outputs (see <code><a href="graphics.html#topic+par">par</a></code>).
</p>
<p>Making 3D plots with <code>twod = NULL</code> requires the <code>rgl</code> package, which is otherwise optional. If it is not installed (which can be annoying to do on some OSes), <code>archigrow()</code> will complain when you attempt a 3D plot but will still work normally for 2D.
</p>
<p>Growth rates are calculated as follows:  
</p>

<ul>
<li><p> For the first observation date, it is calculated as the ratio of the root length to the root system age.  
</p>
</li>
<li><p> For other observation dates (t), it is calculated as the difference between the root length at time t and t-1 divided by the difference between the root system age at time t and t-1.</p>
</li></ul>



<h3>Value</h3>

<p>Returns a list of secondary lists. Each element of the primary list is named as its corresponding lie/RSML file. For each lie/RSML file, the secondary list contains the following items:
</p>
<table role = "presentation">
<tr><td><code>unit</code></td>
<td>
<p>The unit of length/time used to express the results.</p>
</td></tr>
<tr><td><code>time</code></td>
<td>
<p>A data frame containing the following columns: <b>Date</b> (the identification number of each observation date) and <b>Age</b> (the root system age).</p>
</td></tr>
<tr><td><code>GR</code></td>
<td>
<p>A matrix containing the growth rate values computed by the function. The matrix contains the following columns: <b>Root</b> (the identification number of each root constituting a vectorized root system), <b>Ord</b> (the branching order; only for DART files or for RSML files with <code>rsml.connect=TRUE</code>), <b>DateX</b> (the growth rate value of each root at the observation date X).</p>
</td></tr>
<tr><td><code>colors</code></td>
<td>
<p>Only if <code>export.colors=TRUE</code>. A matrix containing the colors used to plot the root system. The matrix contains the following columns: <b>Root</b> (the identification number of each root constituting a vectorized root system), <b>DateX</b> (the color used to plot each root at the observation date X).</p>
</td></tr>
</table>
<p>If <code>plot=TRUE</code>, returns a plot for each vectorized root system located in <code>inputlie</code>/<code>inputrsml</code>.
</p>


<h3>Author(s)</h3>

<p>Benjamin M. Delory, Caroline Baudson, Yves Brostaux, Guillaume Lobet, Loic Pages, Patrick du Jardin, Pierre Delaplace
</p>


<h3>References</h3>

<p>Delory B.M., Baudson C., Brostaux Y., Lobet G., du Jardin P., Pages L., Delaplace P. (2016) archiDART: an R package for the automated computation of plant root architectural traits, <em>Plant and Soil</em>, DOI: 10.1007/s11104-015-2673-4.
</p>
<p>Le Bot J., Serra V., Fabre J., Draye X., Adamowicz S., Pages L. (2010) DART: a software to analyse root system architecture and development from captured images, <em>Plant and Soil</em>, DOI: 10.1007/s11104-009-0005-2.
</p>
<p>Lobet G., Pound M.P., Diener J., Pradal C., Draye X., Godin C., Javaux M., Leitner D., Meunier F., Nacry P., Pridmore T.P., Schnepf A. (2015) Root System Markup Language: Toward a Unified Root Architecture Description Language, <em>Plant Physiology</em>, DOI: 10.1104/pp.114.253625.
</p>
<p>Pages L., Becel C., Boukcim H., Moreau D., Nguyen C., Voisin, A-S. (2013) Calibration and evaluation of ArchiSimple, a simple model of root system architecture, <em>Ecological Modelling</em>, DOI: 10.1016/j.ecolmodel.2013.11.014.
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+par">par</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##---------------------------------------------
## Create a function (legendGR) to add a legend
##---------------------------------------------

legendGR&lt;-function(list, coldyn, GRscale=NULL, raster=c(0.1,0.1,0.6,1), textx=0.8, l=10, ...){
start.col&lt;-ncol(list$GR)-length(grep("Date", colnames(list$GR)))+1
end.col&lt;-ncol(list$GR)
growthrate&lt;-list$GR[,start.col:end.col]
colorlegend&lt;-colorRampPalette(coldyn)(1000)
legendimage&lt;-as.raster(matrix(rev(colorlegend), ncol=1))
par(mar=c(1,1,2,1))
plot(c(0,1),c(0,1),type="n", axes=FALSE, xlab="", ylab="", ...)
if (is.null(GRscale)==TRUE) {text(x=textx, y=seq(raster[2],raster[4],l=l),
labels=round(seq(round(min(growthrate),1),round(max(growthrate),1),l=l),1),...)}
else {text(x=textx, y=seq(raster[2],raster[4],l=l), labels=round(seq(round(min(GRscale),1),
round(max(GRscale),1),l=l),1),...)}
rasterImage(legendimage,xleft=raster[1],ybottom=raster[2],xright=raster[3],ytop=raster[4])}

## Locate folder with DART and RSML files
path &lt;- system.file("extdata", package="archiDART")

##----------------
## DART files only
##----------------

layout(matrix(1:2,ncol=2),widths = c(3,1),heights = c(1,1))
par(mar=c(5,4,4,2)+0.1)
res1a &lt;- archigrow(inputlie=path, inputtps=path, res=75, unittime="day",
unitlength="cm", plot=TRUE, export.colors=TRUE, coldyn=c("blue", "orange", "red"),
las=1, bty="l", asp=1, xaxp=c(0,30,3), lwd=2)
legendGR(list=res1a$ch7, coldyn=c("blue", "orange", "red"))

##--------------------
## DART and RSML files
##--------------------

layout(1)
par(mar=c(5,4,4,2)+0.1)
res1b &lt;- archigrow(inputlie=path, inputtps=path, inputrsml=path, res=75, unittime="day",
unitlength="cm", rsml.connect=TRUE, rsml.date="age", plot=TRUE, export.colors=TRUE,
coldyn=c("black", "orange", "red"), las=1, bty="l", asp=1, xaxp=c(0,30,3), lwd=2,
twod=c("x", "y"))
unit&lt;-res1b$`monocot-archisimple`$unit
legendGR(list=res1b$`monocot-archisimple`, coldyn=c("black", "orange", "red"),
main=paste("Growth rate monocot-archisimple (", unit, ")", sep=""), raster=c(0.2,0,0.7,1))
</code></pre>

<hr>
<h2 id='architect'>Computing Traits Describing The Global Root System Architecture</h2><span id='topic+architect'></span>

<h3>Description</h3>

<p>Calculation of common root system architecture (RSA) traits from Data Analysis of Root Tracings (DART) output files and RSA data encoded with the Root System Markup Language (RSML). More information can be found in <cite>Delory et al (2016)</cite>, <cite>Le Bot et al (2010)</cite>, and <cite>Lobet et al (2015)</cite>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>architect(inputrac=NULL, inputtps=NULL, inputrsml=NULL, res=NULL, unitlength="px",
          rsml.date=NULL, rsml.connect=FALSE, vertical3d="y",
          fitter=FALSE)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="architect_+3A_inputrac">inputrac</code></td>
<td>
<p>A dartToTable object or a character string specifying the path to the folder containing the rac files created by DART. If <code>inputrac</code> is a character string, it can be the same as <code>inputtps</code>/<code>inputrsml</code>.</p>
</td></tr>
<tr><td><code id="architect_+3A_inputtps">inputtps</code></td>
<td>
<p>A character string specifying the path to the folder containing the tps files created by DART. This argument can be the same as <code>inputrac</code>/<code>inputrsml</code>. This argument will not be used if <code>inputrac</code> is a dartToTable object.</p>
</td></tr>
<tr><td><code id="architect_+3A_inputrsml">inputrsml</code></td>
<td>
<p>A rsmlToTable object or a character string specifying the path to the folder containing the RSML files. If <code>inputrsml</code> is a character string, it can be the same as <code>inputrac</code>/<code>inputtps</code>.</p>
</td></tr>
<tr><td><code id="architect_+3A_res">res</code></td>
<td>
<p>Mandatory for DART files only. <b>If images were acquired with a flatbed scanner</b>: a numeric value specifying the resolution of the images used to vectorize the root systems with DART (resolution is expressed in dots/inch). <b>If images were acquired with a digital camera</b>: the ratio between the length of a reference object located on the image expressed in pixels and the actual length of the same object expressed in inches. For DART files, this argument must be specified if <code>inputrac</code> is not a dartToTable object and if <code>unitlength="mm"</code> or <code>unitlength="cm"</code>. For RSML files, the resolution is imported from the metadata and does not need to be specified as an argument.</p>
</td></tr>
<tr><td><code id="architect_+3A_unitlength">unitlength</code></td>
<td>
<p>A character string specifying the unit of length that must be used to express the results. The value acceptable for this argument could be either &ldquo;px&rdquo; for pixels, &ldquo;cm&rdquo; for centimetres or &ldquo;mm&rdquo; for millimetres. This argument will not be used if <code>inputrac</code> is a dartToTable object and/or <code>inputrsml</code> is a rsmlToTable object.</p>
</td></tr>
<tr><td><code id="architect_+3A_rsml.date">rsml.date</code></td>
<td>
<p>Only used if <code>inputrsml</code> is not a rsmlToTable object. A numeric value specifying the root system age (the unit of time is defined by the user). If <code>rsml.date=NULL</code>, a default value of 1 is used by the function. If the root system age is stored as a continuous function along the root segments, a character string specifying the name/label of the function can be used (see details).</p>
</td></tr>
<tr><td><code id="architect_+3A_rsml.connect">rsml.connect</code></td>
<td>
<p>Only used if <code>inputrsml</code> is not a rsmlToTable object. A logical value that must be specified when <code>is.null(inputrsml)=FALSE</code>. If <code>TRUE</code>, the lateral roots are connected to their parent root (see details). If <code>FALSE</code>, no connection is made between daughter and mother roots.</p>
</td></tr>
<tr><td><code id="architect_+3A_vertical3d">vertical3d</code></td>
<td>
<p>The vertical axis for 3D RSA data (x, y, or z).</p>
</td></tr>
<tr><td><code id="architect_+3A_fitter">fitter</code></td>
<td>
<p>A logical value. Should the Fitter topological indices be computed? Yes is TRUE, No is FALSE. See details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To run <code>architect</code> efficiently, DART (.rac or .tps) and RSML (.rsml) files must have been saved with their appropriate extension.
</p>
<p>If <code>inputtps</code> contains a single tps file, it is used by <code>architect</code> for each rac file located in <code>inputrac</code>.  If <code>inputtps</code> contains more than one tps file, the number of tps files in <code>inputtps</code> must be equal to the number of rac files in <code>inputrac</code> and corresponding rac and tps files must have the same name.
</p>
<p>After reading the RSML files located in <code>inputrsml</code>, the data associated with each root system are converted into a data frame possessing the same structure as the rac files created by DART.  The <code>architect</code> function then uses these data frames to calculate RSA traits describing the global architecture of each root system. 
</p>
<p>The argument <code>rsml.date</code> is used to create a tps file for each root system located in <code>inputrsml</code>.  If the root system age is stored as a continuous function along the root segments, the <code>rsml.date</code> argument can be a character string specifying the name/label of the function.  For instance, the root system age at the first apparition of each node is stored as a continuous function called &ldquo;age&rdquo; in RSML files containing RSA data simulated with the ArchiSimple model (<cite>Pages et al (2013)</cite>).  The &ldquo;age&rdquo; function attaches the root system age along the root segments, so that each node is associated with one age value.  An RSML library containing 3D RSA data simulated with ArchiSimple is available here: doi: <a href="https://doi.org/10.5281/zenodo.208214">10.5281/zenodo.208214</a>.
</p>
<p>The <code>rsml.connect</code> argument can be used to connect the lateral roots to their corresponding mother root.  If <code>rsml.connect=TRUE</code>, each point starting a lateral root is connected to the nearest point located on its mother root.  DBase is approximated by the distance between the parent root base and the point located on the mother root that is closest to the point starting a lateral root.  Using RSML files, only RSA data associated with roots possessing a branching order lower or equal to 7 are used for the computation of RSA traits.
</p>
<p>Growth rates are calculated as follows:
</p>

<ul>
<li> <p><em>First-order root growth rate</em>: for the first observation date, it is calculated as the ratio of the total first-order root length to the root system age. For other observation dates (t), it is calculated as the difference between the total first-order root length at time t and t-1 divided by the difference between the root system age at time t and t-1.
</p>
</li>
<li> <p><em>Lateral root growth rates</em>: for the first observation date, it is calculated as the ratio of the lateral root length to the root system age. For other observation dates (t), it is calculated as the difference between the lateral root length at time t and t-1 divided by the difference between the root system age at time t and t-1.
</p>
</li>
<li> <p><em>Growth rate of the root system</em>: for the first observation date, it is calculated as the ratio of the total root system length to the root system age. For other observation dates (t), it is calculated as the difference between the total root system length at time t and t-1 divided by the difference between the root system age at time t and t-1.</p>
</li></ul>

<p>If <code>inputrac</code> is a dartTotable object and/or <code>inputrsml</code> is a rsmlToTable object, topological indices described in <cite>Fitter (1986, 1987)</cite> can be calculated (<code>fitter=TRUE</code>). Here, we define each topological index as in <cite>Fitter (1986, 1987)</cite>. We recommend the reading of these papers for more information.
</p>
<p>The magnitude of a root system is equal to the number of external links in the system. Therefore, the magnitude is also equal to the number of root apices.
</p>
<p>The altitude of a root system is equal to the longest path length from one exterior link (or one root apex) to the root system base.
</p>
<p>The total exterior path length is equal to the sum of all path lengths from all exterior links (or all root apices) to the root system base.
</p>


<h3>Value</h3>

<p>Returns a data frame summarizing all RSA traits calculated for each rac/RSML file located in <code>inputrac</code>/<code>inputrsml</code>. 
</p>
<p>The data frame contains the following columns:
</p>
<p><b>FileName</b>: (the name of the rac/RSML files).
</p>
<p><b>Time</b>: the root system age expressed in the same unit (=unittime) as in the tps file(s) (for rac files) or in the same unit as <code>rsml.date</code> (for RSML files).
</p>
<p><b>TRL</b>: the total root system length expressed in <code>unitlength</code>.
</p>
<p><b>GRTR</b>: the growth rate of the root system expressed in <code>unitlength</code>/unittime.
</p>
<p><b>L1R</b>: the first-order root length expressed in <code>unitlength</code>.
</p>
<p><b>GR1R</b>: the first-order root growth rate expressed in <code>unitlength</code>/unittime.
</p>
<p><b>TN1R</b>: the total number of first-order roots.
</p>
<p><b>TNLR</b>: the total number of lateral roots.
</p>
<p><b>TLRL</b>: the total lateral root length expressed in <code>unitlength</code>.
</p>
<p><b>NxLR</b>: the total number of lateral roots with a branching order equal to x.
</p>
<p><b>LxLR</b>: the total length of lateral roots with a branching order equal to x expressed in <code>unitlength</code>.
</p>
<p><b>MLxLR</b>: the mean length of lateral roots with a branching order equal to x expressed in <code>unitlength</code>.
</p>
<p><b>GRxL</b>: the growth rate of lateral roots with a branching order equal to x expressed in <code>unitlength</code>/unittime.
</p>
<p><b>D2LR</b>: the density of secondary roots on the first-order root(s) expressed in root(s)/<code>unitlength</code>.
</p>
<p>If <code>inputrac</code> is a dartTotable object and/or <code>inputrsml</code> is a rsmlToTable object, the following parameters will be calculated:
</p>
<p><b>Height</b>: the root system height expressed in <code>unitlength</code>.
</p>
<p><b>Width</b>: the root system width expressed in <code>unitlength</code>.
</p>
<p><b>ConvexhullXY</b>: the area of the convex hull on the XY plane expressed in <code>unitlength^2</code>.
</p>
<p><b>ConvexhullXZ</b>: the area of the convex hull on the XZ plane expressed in <code>unitlength^2</code>.
</p>
<p><b>ConvexhullYZ</b>: the area of the convex hull on the YZ plane expressed in <code>unitlength^2</code>.
</p>
<p><b>Convexhull3D</b>: the volume of the convex hull expressed in <code>unitlength^3</code>.
</p>
<p><b>Magnitude</b>: the magnitude of the root system. See details for more information. Computed only if <code>fitter=TRUE</code>.
</p>
<p><b>Altitude</b>: the altitude of the root system. See details for more information. Computed only if <code>fitter=TRUE</code>.
</p>
<p><b>ExtPathLength</b>: the total exterior path length of the root system. See details for more information. Computed only if <code>fitter=TRUE</code>.
</p>
<p><b>MDx</b>: the mean diameter of roots with a branching order equal to x expressed in <code>unitlength</code>.
</p>
<p><b>MDLR</b>: the mean lateral root diameter expressed in <code>unitlength</code>.
</p>
<p><b>Sx</b>: the total surface area of roots with a branching order equal to x expressed in <code>unitlength^2</code>.
</p>
<p><b>Stot</b>: the total root surface area expressed in <code>unitlength^2</code>.
</p>
<p><b>Vx</b>: the total volume of roots with a branching order equal to x expressed in <code>unitlength^3</code>.
</p>
<p><b>Vtot</b>: the root system volume expressed in <code>unitlength^3</code>.
</p>


<h3>Author(s)</h3>

<p>Benjamin M. Delory, Caroline Baudson, Yves Brostaux, Guillaume Lobet, Loic Pages, Patrick du Jardin, Pierre Delaplace
</p>


<h3>References</h3>

<p>Delory B.M., Baudson C., Brostaux Y., Lobet G., du Jardin P., Pages L., Delaplace P. (2016) archiDART: an R package for the automated computation of plant root architectural traits, <em>Plant and Soil</em>, DOI: 10.1007/s11104-015-2673-4.
</p>
<p>Fitter A.H. (1986) The topology and geometry of plant root systems: influence of watering rate on root system topology in <em>Trifolium pratense</em>, <em>Annals of Botany</em>, 58, 91-101. 
</p>
<p>Fitter A.H. (1987) An architectural approach to the comparative ecology of plant root systems, <em>New Phytologist</em>, 106, 61-77. 
</p>
<p>Le Bot J., Serra V., Fabre J., Draye X., Adamowicz S., Pages L. (2010) DART: a software to analyse root system architecture and development from captured images, <em>Plant and Soil</em>, DOI: 10.1007/s11104-009-0005-2.
</p>
<p>Lobet G., Pound M.P., Diener J., Pradal C., Draye X., Godin C., Javaux M., Leitner D., Meunier F., Nacry P., Pridmore T.P., Schnepf A. (2015) Root System Markup Language: Toward a Unified Root Architecture Description Language, <em>Plant Physiology</em>, DOI: 10.1104/pp.114.253625.
</p>
<p>Pages L., Becel C., Boukcim H., Moreau D., Nguyen C., Voisin, A-S. (2013) Calibration and evaluation of ArchiSimple, a simple model of root system architecture, <em>Ecological Modelling</em>, DOI: 10.1016/j.ecolmodel.2013.11.014.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dartToTable">dartToTable</a></code>, <code><a href="#topic+rsmlToTable">rsmlToTable</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Locate folder with DART and RSML files
path &lt;- system.file("extdata", package="archiDART")

## Compute RSA parameters for DART and RSML files
res2a &lt;- architect(inputrac=path, inputtps=path, inputrsml=path, res=75, unitlength="cm",
rsml.connect=TRUE, rsml.date="age")

tablersml&lt;-rsmlToTable(inputrsml=path, unitlength="cm", rsml.date="age", rsml.connect=TRUE)
res2b &lt;- architect(inputrsml=tablersml, fitter=TRUE)
</code></pre>

<hr>
<h2 id='bottleneckdist'>Computing a Pairwise Bottleneck Distance Matrix</h2><span id='topic+bottleneckdist'></span>

<h3>Description</h3>

<p>Computing a pairwise distance matrix using a bottleneck distance method for the comparison of persistence barcodes. More information can be found in <cite>Li et al (2017)</cite> and <cite>Delory et al (2018)</cite>.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bottleneckdist(x, show.progress=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bottleneckdist_+3A_x">x</code></td>
<td>
<p>A perhomology object created with the <code>perhomology</code> function of this package. Mandatory.</p>
</td></tr>
<tr><td><code id="bottleneckdist_+3A_show.progress">show.progress</code></td>
<td>
<p>A logical value. Should a progress bar be shown in the R console? Yes is TRUE, No is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The bottleneck distance between two persistence barcodes is calculated with the <code>bottleneck</code> function of the TDA package (<cite>Fasy et al (2017)</cite>). <b>This package is now listed in the &ldquo;Suggests&rdquo; field of the description file and must be available in your R session (see <a href="https://archidart.github.io/drat/">https://archidart.github.io/drat/</a>)</b>. An error message will be returned if TDA is not available.
</p>
<p><code>show.progress=TRUE</code> can only be used if <code>x</code> contains more than one element.
</p>


<h3>Value</h3>

<p>Returns a pairwise distance matrix.
</p>


<h3>Author(s)</h3>

<p>Benjamin M. Delory, Guillaume Lobet
</p>


<h3>References</h3>

<p>Delory B.M., Li M., Topp C.N., Lobet G. (2018). archiDART v3.0: a new data analysis pipeline allowing the topological analysis of plant root systems, <em>F1000Research</em>, 7:22, DOI: doi: <a href="https://doi.org/10.12688/f1000research.13541.1">10.12688/f1000research.13541.1</a>
</p>
<p>Fasy B.T., Kim J., Lecci F., Maria C., Rouvreau V. (2017). TDA: Statistical Tools for Topological Data Analysis. <a href="https://CRAN.R-project.org/package=TDA">https://CRAN.R-project.org/package=TDA</a>.
</p>
<p>Li M., Duncan K., Topp C.N., Chitwood D.H. (2017) Persistent homology and the branching topologies of plants, <em>American Journal of Botany</em>, DOI: 10.3732/ajb.1700046.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+perhomology">perhomology</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Locate folder with RSML file
path &lt;- system.file("extdata", package="archiDART")

table&lt;-rsmlToTable(inputrsml=path, unitlength="cm", rsml.date="age")

#Persistent homology
ph&lt;-perhomology(table)

#Compute pairwise distance matrix
if (requireNamespace("TDA", quietly=TRUE)) {distance&lt;-bottleneckdist(ph)}
</code></pre>

<hr>
<h2 id='dartToTable'>Import DART Files Into a Single Data Frame</h2><span id='topic+dartToTable'></span>

<h3>Description</h3>

<p>Import DART files located in a folder into a single data frame. More information about DART files can be found in <cite>Le Bot et al (2010)</cite> and <cite>Delory et al (2018)</cite>.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dartToTable(inputrac, inputlie, inputtps, res=NULL, unitlength="px",
            unitangle="d", fitter=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dartToTable_+3A_inputrac">inputrac</code></td>
<td>
<p>A character string specifying the path to the folder containing the rac files created by DART. This argument could be the same as <code>inputlie</code>/<code>inputtps</code>.</p>
</td></tr>
<tr><td><code id="dartToTable_+3A_inputlie">inputlie</code></td>
<td>
<p>A character string specifying the path to the folder containing the lie files created by DART. This argument could be the same as <code>inputrac</code>/<code>inputtps</code>.</p>
</td></tr>
<tr><td><code id="dartToTable_+3A_inputtps">inputtps</code></td>
<td>
<p>A character string specifying the path to the folder containing the tps files created by DART. This argument could be the same as <code>inputrac</code>/<code>inputlie</code>.</p>
</td></tr>
<tr><td><code id="dartToTable_+3A_res">res</code></td>
<td>
<p><b>If images were acquired with a flatbed scanner</b>: a numeric value specifying the resolution of the images used to vectorize the root systems with DART (resolution is expressed in dots/inch). <b>If images were acquired with a digital camera</b>: the ratio between the length of a reference object located on the image expressed in pixels and the actual length of the same object expressed in inches. This argument must be specified if <code>unitlength="mm"</code> or <code>unitlength="cm"</code>.</p>
</td></tr>
<tr><td><code id="dartToTable_+3A_unitlength">unitlength</code></td>
<td>
<p>A character string specifying the unit of length that must be used in the final data frame. The value acceptable for this argument could be either &ldquo;px&rdquo; for pixels, &ldquo;cm&rdquo; for centimetres or &ldquo;mm&rdquo; for millimetres. The function will use the metadata inside each RSML file (unit and resolution) to make the conversion.</p>
</td></tr>
<tr><td><code id="dartToTable_+3A_unitangle">unitangle</code></td>
<td>
<p>A character string specifying the unit that must be used to express the calculated angles. The value acceptable for this argument could be either &ldquo;d&rdquo; for degrees (default value) or &ldquo;r&rdquo; for radians.</p>
</td></tr>
<tr><td><code id="dartToTable_+3A_fitter">fitter</code></td>
<td>
<p>A logical value. Should the Fitter topological indices be computed? Yes is TRUE, No is FALSE. See details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To run <code>dartToTable</code> efficiently, DART files must have been saved with their appropriate extension (.rac, .lie, and .tps).
</p>
<p>If <code>fitter=TRUE</code>, topological indices described in <cite>Fitter (1986, 1987)</cite> will be calculated. Here, we define each topological index as in <cite>Fitter (1986, 1987)</cite>. We recommend the reading of these papers for more information.
</p>
<p>The magnitude of a link is equal to the number of external links that feed into that link.
</p>
<p>The path length of a link is equal to the number of links between a given link and the root system base.
</p>


<h3>Value</h3>

<p>Returns a dartToTable object. Each line of the data frame gives the attributes of one segment. The data frame includes the following columns:
</p>
<p><b>file</b>: the name of each DART file located in <code>inputrac</code>.
</p>
<p><b>root</b>: the root identification number.
</p>
<p><b>order</b>: the root branching order.
</p>
<p><b>parentroot</b>: the identification number of the parent root.
</p>
<p><b>time</b>: the date of apparition.
</p>
<p><b>bran</b>: the branching state (&lsquo;true&rsquo; denotes a branching link while &lsquo;false&rsquo; denotes a continuing link).
</p>
<p><b>apic</b>: the apical state (&lsquo;true&rsquo; denotes a segment ending a root).
</p>
<p><b>x1</b>: the X coordinate of the node starting the segment (expressed in <code>unitlength</code>).
</p>
<p><b>y1</b>: the Y coordinate of the node starting the segment (expressed in <code>unitlength</code>).
</p>
<p><b>z1</b>: the Z coordinate of the node starting the segment (expressed in <code>unitlength</code>).
</p>
<p><b>x2</b>: the X coordinate of the node ending the segment (expressed in <code>unitlength</code>).
</p>
<p><b>y2</b>: the Y coordinate of the node ending the segment (expressed in <code>unitlength</code>).
</p>
<p><b>z2</b>: the Z coordinate of the node ending the segment (expressed in <code>unitlength</code>).
</p>
<p><b>length</b>: the length of the segment (expressed in <code>unitlength</code>).
</p>
<p><b>blength</b>: the cumulative length measured along each root (expressed in <code>unitlength</code>).
</p>
<p><b>orientation</b>: the angle between each segment and a vertical direction vector (expressed in <code>unitangle</code>).
</p>
<p><b>growth</b>: the growth rate value of each segment (expressed in <code>unitlength</code>).
</p>
<p><b>geodesic</b>: the geodesic distance measured along the roots (expressed in <code>unitlength</code>).
</p>
<p><b>magnitude</b>: the magnitude of the segment (see <cite>Fitter et al (1987)</cite>). Computed only if <code>fitter=TRUE</code>.
</p>
<p><b>pathlength</b>: the external path length of the segment (see <cite>Fitter et al (1987)</cite>). Computed only if <code>fitter=TRUE</code>.
</p>


<h3>Author(s)</h3>

<p>Benjamin M. Delory, Guillaume Lobet
</p>


<h3>References</h3>

<p>Delory B.M., Baudson C., Brostaux Y., Lobet G., du Jardin P., Pages L., Delaplace P. (2016) archiDART: an R package for the automated computation of plant root architectural traits, <em>Plant and Soil</em>, DOI: 10.1007/s11104-015-2673-4.
</p>
<p>Delory B.M., Li M., Topp C.N., Lobet G. (2018). archiDART v3.0: a new data analysis pipeline allowing the topological analysis of plant root systems, <em>F1000Research</em>, 7:22, DOI: doi: <a href="https://doi.org/10.12688/f1000research.13541.1">10.12688/f1000research.13541.1</a>
</p>
<p>Fitter A.H. (1986) The topology and geometry of plant root systems: influence of watering rate on root system topology in <em>Trifolium pratense</em>, <em>Annals of Botany</em>, 58, 91-101. 
</p>
<p>Fitter A.H. (1987) An architectural approach to the comparative ecology of plant root systems, <em>New Phytologist</em>, 106, 61-77. 
</p>
<p>Le Bot J., Serra V., Fabre J., Draye X., Adamowicz S., Pages L. (2010) DART: a software to analyse root system architecture and development from captured images, <em>Plant and Soil</em>, DOI: 10.1007/s11104-009-0005-2.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Locate folder with DART files
path &lt;- system.file("extdata", package="archiDART")

table&lt;-dartToTable(inputrac=path, inputlie=path, inputtps=path, res=75, unitlength="cm")</code></pre>

<hr>
<h2 id='latdist'>Computing Lateral Root Length and Density Distribution</h2><span id='topic+latdist'></span>

<h3>Description</h3>

<p>Analysing the lateral root length and density distribution on each mother root using Data Analysis of Root Tracings (DART) output files and RSA data encoded with the Root System Markup Language (RSML). More information can be found in <cite>Delory et al (2016)</cite>, <cite>Le Bot et al (2010)</cite>, and <cite>Lobet et al (2015)</cite>.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>latdist(inputrac=NULL, inputrsml=NULL, output=c("lrd","dtp"), res=NULL, unitlength="px",
        int.length=NULL, interpol=NULL, rsml.connect=TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="latdist_+3A_inputrac">inputrac</code></td>
<td>
<p>A character string specifying the path to the folder containing the rac files created by DART. This argument could be the same as <code>inputrsml</code>.</p>
</td></tr>
<tr><td><code id="latdist_+3A_inputrsml">inputrsml</code></td>
<td>
<p>A character string specifying the path to the folder containing the RSML files. This argument could be the same as <code>inputrac</code>.</p>
</td></tr>
<tr><td><code id="latdist_+3A_output">output</code></td>
<td>
<p>A character string specifying the type of output that is returned by the function. Two values are acceptable for this argument: &ldquo;lrd&rdquo; (default value; root length and density distribution) and &ldquo;dtp&rdquo; (distance between neighbouring lateral roots). See details.</p>
</td></tr>
<tr><td><code id="latdist_+3A_res">res</code></td>
<td>
<p>Mandatory for DART files only. <b>If images were acquired with a flatbed scanner</b>: a numeric value specifying the resolution of the images used to vectorize the root systems with DART (resolution is expressed in dots/inch). <b>If images were acquired with a digital camera</b>: the ratio between the length of a reference object located on the image expressed in pixels and the actual length of the same object expressed in inches. For DART files, this argument must be specified if <code>unitlength="mm"</code> or <code>unitlength="cm"</code>. For RSML files, the resolution is imported from the metadata and does not need to be specified as an argument.</p>
</td></tr>
<tr><td><code id="latdist_+3A_unitlength">unitlength</code></td>
<td>
<p>A character string specifying the unit of length that must be used to plot the root systems. The value acceptable for this argument could be either &ldquo;px&rdquo; for pixels, &ldquo;cm&rdquo; for centimetres or &ldquo;mm&rdquo; for millimetres.</p>
</td></tr>
<tr><td><code id="latdist_+3A_int.length">int.length</code></td>
<td>
<p>Mandatory when <code>output="lrd"</code>. A numeric value specifying the interval length (expressed in <code>unitlength</code>) used to calculate local lateral root length and density (see details).</p>
</td></tr>
<tr><td><code id="latdist_+3A_interpol">interpol</code></td>
<td>
<p>A numeric value specifying the number of points used on each mother root to calculate local lateral root length and density. By default, <code>interpol=NULL</code> means that the function calculates local lateral root length and density at each branching point of each mother root. A numeric value can be specified when <code>output="lrd"</code> (see details).</p>
</td></tr>
<tr><td><code id="latdist_+3A_rsml.connect">rsml.connect</code></td>
<td>
<p>Only used for RSML files. A logical value that must be specified when <code>is.null(inputrsml)=FALSE</code>. If <code>TRUE</code>, the lateral roots are connected to their parent root (see details). If <code>FALSE</code>, no connection is made between daughter and mother roots.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><b>DBase</b>: distance between a branching point and the parent root base.
</p>
<p>To run <code>latdist</code> efficiently, DART (.rac) and RSML (.rsml) files must have been saved with their appropriate extension.
</p>
<p>After reading the RSML files located in <code>inputrsml</code>, the data associated with each root system are converted into a data frame possessing the same structure as the rac files created by DART. The <code>latdist</code> function then uses these data frames to compute lateral root length and density distribution.
</p>
<p>The <code>rsml.connect</code> argument can be used to connect the lateral roots to their corresponding mother root.  If <code>rsml.connect=TRUE</code>, each point starting a lateral root is connected to the nearest point located on its mother root.  DBase is approximated by the distance between the parent root base and the point located on the mother root that is closest to the point starting a lateral root.  Using RSML files, only RSA data associated with roots possessing a branching order lower or equal to 7 are used for the computation of RSA traits.
</p>
<p>If <code>output="lrd"</code>, the function uses <code>interpol</code> to select the appropriate DBase values for which the calculation of RSA parameters should be performed.  Then, a lateral root density and a total lateral root length are calculated on intervals possessing a length equal to <code>int.length</code> and centred on each DBase value.
</p>


<h3>Value</h3>

<p>Returns a list including:
</p>
<table role = "presentation">
<tr><td><code>root</code></td>
<td>
<p>A list of data frames. Each element of the list is named as its corresponding rac/RSML file and contains the following columns: <b>Root</b> (the identification number of each root constituting a vectorized root system), <b>Ord</b> (the branching order), <b>LatRootNum</b> (the number of lateral roots), <b>FinalRootLength</b> (the root length at the last observation date expressed in <code>unitlength</code>), <b>LatRootDensity</b> (the lateral root density calculated as LatRootNum/FinalRootLength and expressed in root(s)/<code>unitlength</code>).</p>
</td></tr>
<tr><td><code>results</code></td>
<td>
<p>A list of secondary lists. Each element of the primary list (results) is named as its corresponding rac/RSML file. The secondary lists contain as much elements as roots constituting a vectorized root system. Each element of the secondary lists could be either a <code>NULL</code> value if a root does not have lateral roots or if no DBase value is comprised in [<code>int.length</code>/2, FinalRootLength-(<code>int.length</code>/2)], or a data frame made of two or three columns depending on the <code>output</code> value. 
</p>
<p><b>If <code>output="lrd"</code></b>: <b>DBase</b> (the distance between the branching point and the parent root base expressed in <code>unitlength</code>), <b>LRD</b> (Local lateral root density expressed in root(s)/<code>unitlength</code>), <b>LRL</b> (Local lateral root length expressed in <code>unitlength</code>/<code>unitlength</code>).
</p>
<p><b>If <code>output="dtp"</code></b>: <b>DBase</b> (the distance between the branching point and the parent root base expressed in <code>unitlength</code>), <b>DTP</b> (the distance to the previous lateral root expressed in <code>unitlength</code>).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Benjamin M. Delory, Guillaume Lobet, Loic Pages
</p>


<h3>References</h3>

<p>Delory B.M., Baudson C., Brostaux Y., Lobet G., du Jardin P., Pages L., Delaplace P. (2016) archiDART: an R package for the automated computation of plant root architectural traits, <em>Plant and Soil</em>, DOI: 10.1007/s11104-015-2673-4.
</p>
<p>Le Bot J., Serra V., Fabre J., Draye X., Adamowicz S., Pages L. (2010) DART: a software to analyse root system architecture and development from captured images, <em>Plant and Soil</em>, DOI: 10.1007/s11104-009-0005-2.
</p>
<p>Lobet G., Pound M.P., Diener J., Pradal C., Draye X., Godin C., Javaux M., Leitner D., Meunier F., Nacry P., Pridmore T.P., Schnepf A. (2015) Root System Markup Language: Toward a Unified Root Architecture Description Language, <em>Plant Physiology</em>, DOI: 10.1104/pp.114.253625.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Locate folder with DART and RSML files
path &lt;- system.file("extdata", package="archiDART")

##-----------------
## DART files only
##-----------------

## Plotting the results for the primary root
## output="lrd", interpol=NULL, int.length=5
res3a &lt;- latdist(inputrac=path, output="lrd", res=75, unitlength="cm",
int.length=5)

plot(res3a$results$ch7[[1]]$DBase, res3a$results$ch7[[1]]$LRD, pch=16, 
xlab="DBase (cm)",ylab="Lateral root density (roots/cm)", main="LRD-interpol=NULL-int.length=5",
las=1, bty="l", xaxp=c(0,90,9))

plot(res3a$results$ch7[[1]]$DBase, res3a$results$ch7[[1]]$LRL, pch=16, 
xlab="DBase (cm)",ylab="Lateral root length (cm/cm)", main="LRL-interpol=NULL-int.length=5",
las=1, bty="l", xaxp=c(0,90,9))

## output="lrd", interpol=1000, int.length=5
res3b &lt;- latdist(inputrac=path, output="lrd", res=75, unitlength="cm",
int.length=5, interpol=1000)

plot(res3b$results$ch7[[1]]$DBase, res3b$results$ch7[[1]]$LRD, pch=16, 
xlab="DBase (cm)", ylab="Lateral root density (roots/cm)", main="LRD-interpol=1000-int.length=5", 
las=1, bty="l", xaxp=c(0,90,9))

plot(res3b$results$ch7[[1]]$DBase, res3b$results$ch7[[1]]$LRL, pch=16, 
xlab="DBase (cm)", ylab="Lateral root length (cm/cm)", main="LRL-interpol=1000-int.length=5", 
las=1, bty="l", xaxp=c(0,90,9))

## output="dtp"
res3c &lt;- latdist(inputrac=path, output="dtp", res=75, unitlength="cm")

plot(res3c$results$ch7[[1]]$DBase, res3c$results$ch7[[1]]$DTP, pch=16, 
xlab="DBase (cm)", ylab="Distance to the previous root (cm)", main="DTP", las=1, bty="l",
xaxp=c(0,90,9))

##-----------------
## RSML files only
##-----------------

## output="lrd", interpol=200, int.length=1
res3d &lt;- latdist(inputrsml=path, unitlength="cm", output="lrd", int.length=1, interpol=200,
rsml.connect=TRUE)

##output="dtp"
res3e &lt;- latdist(inputrsml=path, output="dtp", unitlength="cm")

##---------------------
## DART and RSML files
##---------------------

## output="lrd", interpol=200, int.length=2
res3f &lt;- latdist(inputrac=path, inputrsml=path, output="lrd", res=75, unitlength="cm",
int.length=2, interpol=200, rsml.connect=TRUE)

## output="dtp"
res3g &lt;- latdist(inputrac=path, inputrsml=path, output="dtp", res=75, unitlength="cm")
</code></pre>

<hr>
<h2 id='perhomology'>Topological Analysis using Persistent Homology</h2><span id='topic+perhomology'></span>

<h3>Description</h3>

<p>Computing the birth and death of homology group components (path-connected components) using root system architecture data encoded with the Root System Markup Language (RSML) or exported by Data Analysis of Root Tracings (DART). More information can be found in <cite>Le Bot et al (2010)</cite>, <cite>Lobet et al (2015)</cite>, <cite>Li et al (2017)</cite>, and <cite>Delory et al (2018)</cite>.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>perhomology(x, show.progress=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="perhomology_+3A_x">x</code></td>
<td>
<p>A rsmlToTable or dartToTable object. Mandatory.</p>
</td></tr>
<tr><td><code id="perhomology_+3A_show.progress">show.progress</code></td>
<td>
<p>A logical value. Should a progress bar be shown in the R console? Yes is TRUE, No is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In mathematics, homology refers to homology groups. Because roots are path-connected components, only zero order homology (H0) branches are considered here.
</p>
<p>The persistence of each H0 branch is computed using a geodesic distance function. More information can be found in <cite>Li et al (2017)</cite>.
</p>
<p><code>show.progress=TRUE</code> can only be used if more than one root system is stored in <code>x</code>.
</p>


<h3>Value</h3>

<p>Returns a list of matrices. The list is a perhomology object. Each matrix of the list is a barcode object. Each element of the list is named as its corresponding RSML/DART file. Each matrix is associated with one root system only and possesses the following columns: 
</p>
<p><b>dimension</b>: the homology group (0 for path-connected components).
</p>
<p><b>birth</b>: the birth of an H0 branch along the distance function.
</p>
<p><b>death</b>: the death of an H0 branch along the distance function.
</p>


<h3>Author(s)</h3>

<p>Benjamin M. Delory, Guillaume Lobet
</p>


<h3>References</h3>

<p>Delory B.M., Li M., Topp C.N., Lobet G. (2018). archiDART v3.0: a new data analysis pipeline allowing the topological analysis of plant root systems, <em>F1000Research</em>, 7:22, DOI: doi: <a href="https://doi.org/10.12688/f1000research.13541.1">10.12688/f1000research.13541.1</a>
</p>
<p>Le Bot J., Serra V., Fabre J., Draye X., Adamowicz S., Pages L. (2010) DART: a software to analyse root system architecture and development from captured images, <em>Plant and Soil</em>, DOI: 10.1007/s11104-009-0005-2.
</p>
<p>Li M., Duncan K., Topp C.N., Chitwood D.H. (2017) Persistent homology and the branching topologies of plants, <em>American Journal of Botany</em>, DOI: 10.3732/ajb.1700046.
</p>
<p>Lobet G., Pound M.P., Diener J., Pradal C., Draye X., Godin C., Javaux M., Leitner D., Meunier F., Nacry P., Pridmore T.P., Schnepf A. (2015) Root System Markup Language: Toward a Unified Root Architecture Description Language, <em>Plant Physiology</em>, DOI: 10.1104/pp.114.253625.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dartToTable">dartToTable</a></code>, <code><a href="#topic+rsmlToTable">rsmlToTable</a></code>, <code><a href="#topic+plot.barcode">plot.barcode</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Locate folder with RSML file
path &lt;- system.file("extdata", package="archiDART")

table&lt;-rsmlToTable(inputrsml=path, unitlength="cm", rsml.date="age")

#Persistent homology
ph1&lt;-perhomology(table)
plot(ph1$'monocot-archisimple_1', las=1, xlab="Geodesic distance (cm)")
</code></pre>

<hr>
<h2 id='plot.barcode'>Plot the Persistence Barcode</h2><span id='topic+plot.barcode'></span>

<h3>Description</h3>

<p>Plot the persistence barcode of the topology of a root system. More information can be found in <cite>Li et al (2017)</cite> and <cite>Delory et al (2018)</cite>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'barcode'
plot(x, y = NULL, type = "p",  xlim = NULL, ylim = NULL,
        log = "", main = NULL, sub = NULL, xlab = NULL, ylab = NULL,
        ann = par("ann"), axes = TRUE, frame.plot = axes,
        panel.first = NULL, panel.last = NULL, asp = NA,
        xgap.axis = NA, ygap.axis = NA, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.barcode_+3A_x">x</code></td>
<td>
<p>A barcode object. Mandatory.</p>
</td></tr>
<tr><td><code id="plot.barcode_+3A_y">y</code></td>
<td>
<p>See <code><a href="graphics.html#topic+plot.default">plot.default</a></code></p>
</td></tr>
<tr><td><code id="plot.barcode_+3A_type">type</code></td>
<td>
<p>See <code><a href="graphics.html#topic+plot.default">plot.default</a></code></p>
</td></tr>
<tr><td><code id="plot.barcode_+3A_xlim">xlim</code></td>
<td>
<p>See <code><a href="graphics.html#topic+plot.default">plot.default</a></code></p>
</td></tr>
<tr><td><code id="plot.barcode_+3A_ylim">ylim</code></td>
<td>
<p>See <code><a href="graphics.html#topic+plot.default">plot.default</a></code></p>
</td></tr>
<tr><td><code id="plot.barcode_+3A_log">log</code></td>
<td>
<p>See <code><a href="graphics.html#topic+plot.default">plot.default</a></code></p>
</td></tr>
<tr><td><code id="plot.barcode_+3A_main">main</code></td>
<td>
<p>See <code><a href="graphics.html#topic+plot.default">plot.default</a></code></p>
</td></tr>
<tr><td><code id="plot.barcode_+3A_sub">sub</code></td>
<td>
<p>See <code><a href="graphics.html#topic+plot.default">plot.default</a></code></p>
</td></tr>
<tr><td><code id="plot.barcode_+3A_xlab">xlab</code></td>
<td>
<p>A character string giving a label for the X axis.</p>
</td></tr>
<tr><td><code id="plot.barcode_+3A_ylab">ylab</code></td>
<td>
<p>A character string giving a label for the Y axis.</p>
</td></tr>
<tr><td><code id="plot.barcode_+3A_ann">ann</code></td>
<td>
<p>See <code><a href="graphics.html#topic+plot.default">plot.default</a></code></p>
</td></tr>
<tr><td><code id="plot.barcode_+3A_axes">axes</code></td>
<td>
<p>See <code><a href="graphics.html#topic+plot.default">plot.default</a></code></p>
</td></tr>
<tr><td><code id="plot.barcode_+3A_frame.plot">frame.plot</code></td>
<td>
<p>See <code><a href="graphics.html#topic+plot.default">plot.default</a></code></p>
</td></tr>
<tr><td><code id="plot.barcode_+3A_panel.first">panel.first</code></td>
<td>
<p>See <code><a href="graphics.html#topic+plot.default">plot.default</a></code></p>
</td></tr>
<tr><td><code id="plot.barcode_+3A_panel.last">panel.last</code></td>
<td>
<p>See <code><a href="graphics.html#topic+plot.default">plot.default</a></code></p>
</td></tr>
<tr><td><code id="plot.barcode_+3A_asp">asp</code></td>
<td>
<p>See <code><a href="graphics.html#topic+plot.default">plot.default</a></code></p>
</td></tr>
<tr><td><code id="plot.barcode_+3A_xgap.axis">xgap.axis</code></td>
<td>
<p>See <code><a href="graphics.html#topic+plot.default">plot.default</a></code></p>
</td></tr>
<tr><td><code id="plot.barcode_+3A_ygap.axis">ygap.axis</code></td>
<td>
<p>See <code><a href="graphics.html#topic+plot.default">plot.default</a></code></p>
</td></tr>
<tr><td><code id="plot.barcode_+3A_...">...</code></td>
<td>
<p>Additional graphical parameters.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a plot.
</p>


<h3>Author(s)</h3>

<p>Benjamin M. Delory, Guillaume Lobet
</p>


<h3>References</h3>

<p>Delory B.M., Li M., Topp C.N., Lobet G. (2018). archiDART v3.0: a new data analysis pipeline allowing the topological analysis of plant root systems, <em>F1000Research</em>, 7:22, DOI: doi: <a href="https://doi.org/10.12688/f1000research.13541.1">10.12688/f1000research.13541.1</a>
</p>
<p>Li M., Duncan K., Topp C.N., Chitwood D.H. (2017) Persistent homology and the branching topologies of plants, <em>American Journal of Botany</em>, DOI: 10.3732/ajb.1700046.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+perhomology">perhomology</a></code>, <code><a href="graphics.html#topic+par">par</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Locate folder with RSML file
path &lt;- system.file("extdata", package="archiDART")

table&lt;-rsmlToTable(inputrsml=path, unitlength="cm", rsml.date="age")

#Persistent homology
ph&lt;-perhomology(table)

#Plot the barcode
plot(ph$'monocot-archisimple_1', las=1, xlab="Geodesic distance (cm)")
</code></pre>

<hr>
<h2 id='root'>Computing Attributes for Each Root</h2><span id='topic+root'></span>

<h3>Description</h3>

<p>Computing attributes for each individual root using root system architecture data encoded with the Root System Markup Language (RSML) or exported by Data Analysis of Root Tracings (DART). More information can be found in <cite>Le Bot et al (2010)</cite>, <cite>Lobet et al (2015)</cite>, and <cite>Delory et al (2018)</cite>.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>root(x, unitangle="d", vertical3d="y", last=TRUE, show.progress=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="root_+3A_x">x</code></td>
<td>
<p>A rsmlToTable or dartToTable object. Mandatory.</p>
</td></tr>
<tr><td><code id="root_+3A_unitangle">unitangle</code></td>
<td>
<p>A character string specifying the unit that must be used to express the calculated angles. The value acceptable for this argument could be either &ldquo;d&rdquo; for degrees (default value) or &ldquo;r&rdquo; for radians.</p>
</td></tr>
<tr><td><code id="root_+3A_vertical3d">vertical3d</code></td>
<td>
<p>The vertical axis for 3D RSA data (x, y, or z).</p>
</td></tr>
<tr><td><code id="root_+3A_last">last</code></td>
<td>
<p>Should the calculations be performed for the last observation date only? Yes is TRUE, No is FALSE.</p>
</td></tr>
<tr><td><code id="root_+3A_show.progress">show.progress</code></td>
<td>
<p>A logical value. Should a progress bar be shown in the R console? Yes is TRUE, No is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If a rsmlToTable object was created with <code>rsml.connect=FALSE</code>, DBase values are approximated by the distance between the parent root base and the point located on the mother root that is closest to the point starting a lateral root.
</p>
<p><code>show.progress=TRUE</code> can only be used if more than one root system is stored in <code>x</code>.
</p>


<h3>Value</h3>

<p>Returns a data frame. Each line of the data frame gives the attributes of one root. The data frame includes the following columns: 
</p>
<p><b>file</b>: the name of each DART or RSML file.
</p>
<p><b>plant</b>: the plant identification number. Only if <code>x</code> is a rsmlToTable object.
</p>
<p><b>root</b>: the root identification number.
</p>
<p><b>order</b>: the root branching order.
</p>
<p><b>parentroot</b>: the identification number of the parent root.
</p>
<p><b>time</b>: the root system age.
</p>
<p><b>DBase</b>: the distance between the branching point to the parent root base.
</p>
<p><b>length</b>: the root length.
</p>
<p><b>mean.diameter</b>: the mean root diameter. Only if <code>x</code> is a rsmlToTable object.
</p>
<p><b>sd.diameter</b>: the standard deviation of the root diameter. Only if <code>x</code> is a rsmlToTable object.
</p>
<p><b>nlat</b>: the number of lateral roots.
</p>
<p><b>branching.angle</b>: the branching angle expressed in <code>unitangle</code>.
</p>
<p><b>tortuosity</b>: the ratio of the final root length to the Euclidean distance between the branching point and the apex of the root.
</p>
<p><b>growth</b>: the growth rate.
</p>
<p><b>surface</b>: the total root surface area. Only if <code>x</code> is a rsmlToTable object.
</p>
<p><b>volume</b>: the total root volume. Only if <code>x</code> is a rsmlToTable object.
</p>
<p><b>lauz</b>: the length of the unbranched apical zone (see <cite>Pages et al (2010)</cite>).
</p>


<h3>Author(s)</h3>

<p>Benjamin M. Delory, Guillaume Lobet
</p>


<h3>References</h3>

<p>Delory B.M., Li M., Topp C.N., Lobet G. (2018). archiDART v3.0: a new data analysis pipeline allowing the topological analysis of plant root systems, <em>F1000Research</em>, 7:22, DOI: doi: <a href="https://doi.org/10.12688/f1000research.13541.1">10.12688/f1000research.13541.1</a>
</p>
<p>Le Bot J., Serra V., Fabre J., Draye X., Adamowicz S., Pages L. (2010) DART: a software to analyse root system architecture and development from captured images, <em>Plant and Soil</em>, DOI: 10.1007/s11104-009-0005-2.
</p>
<p>Lobet G., Pound M.P., Diener J., Pradal C., Draye X., Godin C., Javaux M., Leitner D., Meunier F., Nacry P., Pridmore T.P., Schnepf A. (2015) Root System Markup Language: Toward a Unified Root Architecture Description Language, <em>Plant Physiology</em>, DOI: 10.1104/pp.114.253625.
</p>
<p>Pages L., Serra V., Draye X., Doussan C., Pierret A. (2010) Estimating root elongation rates from morphological measurements of the root tip, <em>Plant and Soil</em>, DOI: 10.1007/s11104-009-0079-x. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dartToTable">dartToTable</a></code>, <code><a href="#topic+rsmlToTable">rsmlToTable</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Locate folder with RSML file
path &lt;- system.file("extdata", package="archiDART")

table&lt;-rsmlToTable(inputrsml=path, unitlength="cm", rsml.date="age")

#Compute attributes for all observation dates
roots&lt;-root(table, last=FALSE)
</code></pre>

<hr>
<h2 id='rsmlToTable'>Import RSML Files Into a Single Data Frame</h2><span id='topic+rsmlToTable'></span>

<h3>Description</h3>

<p>Import RSML files located in a folder into a single data frame. More information about RSML files can be found in <cite>Lobet et al (2015)</cite> and <cite>Delory et al (2018)</cite>.   
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rsmlToTable(inputrsml, unitlength="px", rsml.date=NULL, rsml.connect=TRUE,
            vertical3d="y", unitangle="d", fitter=FALSE, show.progress=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rsmlToTable_+3A_inputrsml">inputrsml</code></td>
<td>
<p>A character string specifying the path to the folder containing the RSML files. Mandatory.</p>
</td></tr>
<tr><td><code id="rsmlToTable_+3A_unitlength">unitlength</code></td>
<td>
<p>A character string specifying the unit of length that must be used in the final data frame. The value acceptable for this argument could be either &ldquo;px&rdquo; for pixels, &ldquo;cm&rdquo; for centimetres or &ldquo;mm&rdquo; for millimetres. The function will use the metadata inside each RSML file (unit and resolution) to make the conversion.</p>
</td></tr>
<tr><td><code id="rsmlToTable_+3A_rsml.date">rsml.date</code></td>
<td>
<p>A numeric value specifying the root system age (the unit of time is defined by the user). If <code>rsml.date=NULL</code> (default), a default value of 1 is used by the function. If the root system age is stored as a continuous function along the root segments, a vector of character strings specifying the names/labels of the function can be used (see details).</p>
</td></tr>
<tr><td><code id="rsmlToTable_+3A_rsml.connect">rsml.connect</code></td>
<td>
<p>A logical value. Mandatory. If <code>TRUE</code> (default), the lateral roots are connected to their parent root (see details). If <code>FALSE</code>, no connection is made between daughter and mother roots.</p>
</td></tr>
<tr><td><code id="rsmlToTable_+3A_vertical3d">vertical3d</code></td>
<td>
<p>The vertical axis for 3D RSA data (x, y, or z).</p>
</td></tr>
<tr><td><code id="rsmlToTable_+3A_unitangle">unitangle</code></td>
<td>
<p>A character string specifying the unit that must be used to express the calculated angles. The value acceptable for this argument could be either &ldquo;d&rdquo; for degrees (default value) or &ldquo;r&rdquo; for radians.</p>
</td></tr>
<tr><td><code id="rsmlToTable_+3A_fitter">fitter</code></td>
<td>
<p>A logical value. Should the Fitter topological indices be computed? Yes is TRUE, No is FALSE. See details.</p>
</td></tr>
<tr><td><code id="rsmlToTable_+3A_show.progress">show.progress</code></td>
<td>
<p>A logical value. Should a progress bar be shown in the R console? Yes is TRUE, No is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To run <code>rsmlToTable</code> efficiently, RSML (.rsml) files must have been saved with their appropriate extension.
</p>
<p>The argument <code>rsml.date</code> is used to create a tps file for each root system located in <code>inputrsml</code>.  If the root system age is stored as a continuous function along the root segments, the <code>rsml.date</code> argument can be a vector of character strings specifying the names/labels of the function.  For instance, the root system age at the first apparition of each node is stored as a continuous function called &ldquo;age&rdquo; in RSML files containing RSA data simulated with the ArchiSimple model (<cite>Pages et al (2013)</cite>).  The &ldquo;age&rdquo; function attaches the root system age along the root segments, so that each node is associated with one age value.  An RSML library containing 3D RSA data simulated with ArchiSimple is available here: doi: <a href="https://doi.org/10.5281/zenodo.208214">10.5281/zenodo.208214</a>.
</p>
<p>The <code>rsml.connect</code> argument can be used to connect the lateral roots to their corresponding mother root.  If <code>rsml.connect=TRUE</code>, each point starting a lateral root is connected to the nearest point located on its mother root.  DBase is approximated by the distance between the parent root base and the point located on the mother root that is closest to the point starting a lateral root.  Using RSML files, only RSA data associated with roots possessing a branching order lower or equal to 7 are used for the computation of RSA traits.
</p>
<p><code>show.progress=TRUE</code> can only be used if more than one RSML file is stored in <code>inputrsml</code>.
</p>
<p>If <code>fitter=TRUE</code>, topological indices described in <cite>Fitter (1986, 1987)</cite> will be calculated. Here, we define each topological index as in <cite>Fitter (1986, 1987)</cite>. We recommend the reading of these papers for more information.
</p>
<p>The magnitude of a link is equal to the number of external links that feed into that link.
</p>
<p>The path length of a link is equal to the number of links between a given link and the root system base.
</p>


<h3>Value</h3>

<p>Returns a rsmlToTable object. Each line of the data frame gives the attributes of one segment. The data frame includes the following columns:
</p>
<p><b>file</b>: the name of each RSML file located in <code>inputrsml</code>.
</p>
<p><b>plant</b>: the plant identification number.
</p>
<p><b>root</b>: the root identification number.
</p>
<p><b>order</b>: the root branching order.
</p>
<p><b>parentroot</b>: the identification number of the parent root.
</p>
<p><b>time</b>: the date of apparition.
</p>
<p><b>bran</b>: the branching state (&lsquo;true&rsquo; denotes a branching link while &lsquo;false&rsquo; denotes a continuing link).
</p>
<p><b>apic</b>: the apical state (&lsquo;true&rsquo; denotes a segment ending a root).
</p>
<p><b>x1</b>: the X coordinate of the node starting the segment (expressed in <code>unitlength</code>).
</p>
<p><b>y1</b>: the Y coordinate of the node starting the segment (expressed in <code>unitlength</code>).
</p>
<p><b>z1</b>: the Z coordinate of the node starting the segment (expressed in <code>unitlength</code>).
</p>
<p><b>x2</b>: the X coordinate of the node ending the segment (expressed in <code>unitlength</code>).
</p>
<p><b>y2</b>: the Y coordinate of the node ending the segment (expressed in <code>unitlength</code>).
</p>
<p><b>z2</b>: the Z coordinate of the node ending the segment (expressed in <code>unitlength</code>).
</p>
<p><b>diameter1</b>: the root diameter at the node starting the segment (expressed in <code>unitlength</code>).
</p>
<p><b>diameter2</b>: the root diameter at the node ending the segment (expressed in <code>unitlength</code>).
</p>
<p><b>length</b>: the length of the segment (expressed in <code>unitlength</code>).
</p>
<p><b>blength</b>: the cumulative length measured along each root (expressed in <code>unitlength</code>).
</p>
<p><b>surface</b>: the surface area of the root segment (expressed in <code>unitlength^2</code>).
</p>
<p><b>volume</b>: the volume of the root segment (expressed in <code>unitlength^3</code>).
</p>
<p><b>orientation</b>: the angle between each segment and a vertical direction vector (expressed in <code>unitangle</code>).
</p>
<p><b>growth</b>: the growth rate value of each segment (expressed in <code>unitlength</code>).
</p>
<p><b>geodesic</b>: the geodesic distance measured along the roots (expressed in <code>unitlength</code>).
</p>
<p><b>magnitude</b>: the magnitude of the segment. See details for more information. Computed only if <code>fitter=TRUE</code>.
</p>
<p><b>pathlength</b>: the path length of the segment. See details for more information. Computed only if <code>fitter=TRUE</code>.
</p>


<h3>Author(s)</h3>

<p>Benjamin M. Delory, Guillaume Lobet
</p>


<h3>References</h3>

<p>Delory B.M., Baudson C., Brostaux Y., Lobet G., du Jardin P., Pages L., Delaplace P. (2016) archiDART: an R package for the automated computation of plant root architectural traits, <em>Plant and Soil</em>, DOI: 10.1007/s11104-015-2673-4.
</p>
<p>Delory B.M., Li M., Topp C.N., Lobet G. (2018). archiDART v3.0: a new data analysis pipeline allowing the topological analysis of plant root systems, <em>F1000Research</em>, 7:22, DOI: doi: <a href="https://doi.org/10.12688/f1000research.13541.1">10.12688/f1000research.13541.1</a>
</p>
<p>Fitter A.H. (1986) The topology and geometry of plant root systems: influence of watering rate on root system topology in <em>Trifolium pratense</em>, <em>Annals of Botany</em>, 58, 91-101. 
</p>
<p>Fitter A.H. (1987) An architectural approach to the comparative ecology of plant root systems, <em>New Phytologist</em>, 106, 61-77. 
</p>
<p>Lobet G., Pound M.P., Diener J., Pradal C., Draye X., Godin C., Javaux M., Leitner D., Meunier F., Nacry P., Pridmore T.P., Schnepf A. (2015) Root System Markup Language: Toward a Unified Root Architecture Description Language, <em>Plant Physiology</em>, DOI: 10.1104/pp.114.253625.
</p>
<p>Pages L., Becel C., Boukcim H., Moreau D., Nguyen C., Voisin, A-S. (2013) Calibration and evaluation of ArchiSimple, a simple model of root system architecture, <em>Ecological Modelling</em>, DOI: 10.1016/j.ecolmodel.2013.11.014.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Locate folder with RSML file
path &lt;- system.file("extdata", package="archiDART")

table&lt;-rsmlToTable(inputrsml=path, unitlength="cm", rsml.date="age")</code></pre>

<hr>
<h2 id='trajectory'>Computing Root Growth Directions and Trajectories</h2><span id='topic+trajectory'></span>

<h3>Description</h3>

<p>Calculation of root system architecture (RSA) parameters describing the directions and the trajectories of the root system growth using Data Analysis of Root Tracings (DART) output files and RSA data encoded with the Root System Markup Language (RSML). This function allows the calculation of the branching angle of each daughter root on its corresponding mother root, statistical parameters describing the curvature of each root constituting a vectorized root system, and the root tip angles relative to a vertical direction vector at each observation date. More information can be found in <cite>Delory et al (2016)</cite>, <cite>Le Bot et al (2010)</cite>, and <cite>Lobet et al (2015)</cite>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>trajectory(inputrac=NULL, inputlie=NULL, inputtps=NULL, inputrsml=NULL, res=NULL,
          unitlength="px", unitangle="d", rotation=0, l.brangle, l.curv, l.tipangle,
          rsml.date=NULL, vertical3d="y", plot=NULL, twod=NULL, colangle=NULL,
          export.colors=FALSE, BRscale=NULL, main=NULL, xlim=NULL, ylim=NULL,
          zlim=NULL, xlab=NULL, ylab=NULL, zlab=NULL, ...)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="trajectory_+3A_inputrac">inputrac</code></td>
<td>
<p>A character string specifying the path to the folder containing the rac files created by DART. This argument could be the same as <code>inputlie</code>/<code>inputtps</code>/<code>inputrsml</code>.</p>
</td></tr>
<tr><td><code id="trajectory_+3A_inputlie">inputlie</code></td>
<td>
<p>A character string specifying the path to the folder containing the lie files created by DART. This argument could be the same as <code>inputrac</code>/<code>inputtps</code>/<code>inputrsml</code>.</p>
</td></tr>
<tr><td><code id="trajectory_+3A_inputtps">inputtps</code></td>
<td>
<p>A character string specifying the path to the folder containing the tps files created by DART. This argument could be the same as <code>inputrac</code>/<code>inputlie</code>/<code>inputrsml</code>.</p>
</td></tr>
<tr><td><code id="trajectory_+3A_inputrsml">inputrsml</code></td>
<td>
<p>A character string specifying the path to the folder containing the RSML files. This argument could be the same as <code>inputrac</code>/<code>inputlie</code>/<code>inputtps</code>.</p>
</td></tr>
<tr><td><code id="trajectory_+3A_res">res</code></td>
<td>
<p>Mandatory for DART files only. <b>If images were acquired with a flatbed scanner</b>: a numeric value specifying the resolution of the images used to vectorize the root systems with DART (resolution is expressed in dots/inch). <b>If images were acquired with a digital camera</b>: the ratio between the length of a reference object located on the image expressed in pixels and the actual length of the same object expressed in inches. For DART files, this argument must be specified if <code>unitlength="mm"</code> or <code>unitlength="cm"</code>. For RSML files, the resolution is imported from the metadata and does not need to be specified as an argument.</p>
</td></tr>
<tr><td><code id="trajectory_+3A_unitlength">unitlength</code></td>
<td>
<p>A character string specifying the unit of length that must be used to express the results. The value acceptable for this argument could be either &ldquo;px&rdquo; for pixels, &ldquo;cm&rdquo; for centimetres or &ldquo;mm&rdquo; for millimetres.</p>
</td></tr>
<tr><td><code id="trajectory_+3A_unitangle">unitangle</code></td>
<td>
<p>A character string specifying the unit that must be used to express the calculated angles. The value acceptable for this argument could be either &ldquo;d&rdquo; for degrees (default value) or &ldquo;r&rdquo; for radians.</p>
</td></tr>
<tr><td><code id="trajectory_+3A_rotation">rotation</code></td>
<td>
<p>A numeric value specifying the angle (expressed in <code>unitangle</code>) that must be used to perform a clockwise rotation of 2D root systems (see details).</p>
</td></tr>
<tr><td><code id="trajectory_+3A_l.brangle">l.brangle</code></td>
<td>
<p>A numeric value specifying the minimum root length used to calculate the branching angle of a daughter root on its corresponding mother root (see details).</p>
</td></tr>
<tr><td><code id="trajectory_+3A_l.curv">l.curv</code></td>
<td>
<p>A numeric value specifying the distance used to place equidistantly spaced interpolated points along each root before calculating the angles between the direction vectors of the successive links constituting a vectorized root (see details).</p>
</td></tr>
<tr><td><code id="trajectory_+3A_l.tipangle">l.tipangle</code></td>
<td>
<p>A numeric value specifying the distance between the root tip and an interpolated point located along a root. Each interpolated point is used by the function to calculate a direction vector following the root growth direction near the apex prior to the calculation of the root tip angle relative to a vertical direction vector at each observation date.</p>
</td></tr>
<tr><td><code id="trajectory_+3A_rsml.date">rsml.date</code></td>
<td>
<p>Only used for RSML files. A numeric value specifying the root system age (the unit of time is defined by the user). If <code>rsml.date=NULL</code>, a default value of 1 is used by the function. If the root system age is stored as a continuous function along the root segments, a character string specifying the name/label of the function can be used (see details).</p>
</td></tr>
<tr><td><code id="trajectory_+3A_vertical3d">vertical3d</code></td>
<td>
<p>The vertical axis for 3D RSA data (x, y, or z).</p>
</td></tr>
<tr><td><code id="trajectory_+3A_plot">plot</code></td>
<td>
<p>Either &ldquo;branching&rdquo; or &ldquo;direction&rdquo;. If <code>plot="branching"</code>, each root is plotted with a color code depending on the value of its branching angle. If <code>plot="direction"</code>, each root is plotted with a color code depending on the value of its growth direction angle.</p>
</td></tr>
<tr><td><code id="trajectory_+3A_twod">twod</code></td>
<td>
<p>When RSML files contain 3D RSA data, should the root systems be plotted in 2D? This argument can be NULL (3D plots) or a character vector giving the name of the axes to plot (can be c(&ldquo;x&rdquo;, &ldquo;y&rdquo;), c(&ldquo;x&rdquo;, &ldquo;z&rdquo;), or c(&ldquo;y&rdquo;, &ldquo;z&rdquo;)).</p>
</td></tr>
<tr><td><code id="trajectory_+3A_colangle">colangle</code></td>
<td>
<p>A vector specifying the color(s) that must be used to plot the root system(s). <code>trajectory</code> interpolates the color(s) contained in <code>colangle</code> between the minimum and the maximum values of the computed standardized angle matrix (if <code>is.null(BRscale)=TRUE</code>) or between <code>min(BRscale)</code> and <code>max(BRscale)</code> (if <code>is.null(BRscale)=FALSE</code>).</p>
</td></tr>
<tr><td><code id="trajectory_+3A_export.colors">export.colors</code></td>
<td>
<p>A logical value. Should the color values be exported?</p>
</td></tr>
<tr><td><code id="trajectory_+3A_brscale">BRscale</code></td>
<td>
<p>A numeric vector (length=2) specifying the minimum and the maximum angle values (expressed in <code>unitangle</code>) that must be used to plot each vectorized root system.</p>
</td></tr>
<tr><td><code id="trajectory_+3A_main">main</code></td>
<td>
<p>A character string giving a main title for the plot. When <code>is.null(main)=TRUE</code>, the default title for each plot is the name of the corresponding lie/RSML file.</p>
</td></tr>
<tr><td><code id="trajectory_+3A_xlim">xlim</code></td>
<td>
<p>A numeric vector (length=2) giving the X limits of the plot using the same unit as <code>unitlength</code>.</p>
</td></tr>
<tr><td><code id="trajectory_+3A_ylim">ylim</code></td>
<td>
<p>A numeric vector (length=2) giving the Y limits of the plot using the same unit as <code>unitlength</code>.</p>
</td></tr>
<tr><td><code id="trajectory_+3A_zlim">zlim</code></td>
<td>
<p>A numeric vector (length=2) giving the Z limits of the plot using the same unit as <code>unitlength</code>.</p>
</td></tr>
<tr><td><code id="trajectory_+3A_xlab">xlab</code></td>
<td>
<p>A character string giving a label for the X axis. When <code>is.null(xlab)=TRUE</code>, the default label for the X axis is X (<code>unitlength</code>).</p>
</td></tr>
<tr><td><code id="trajectory_+3A_ylab">ylab</code></td>
<td>
<p>A character string giving a label for the Y axis. When <code>is.null(ylab)=TRUE</code>, the default label for the Y axis is Y (<code>unitlength</code>).</p>
</td></tr>
<tr><td><code id="trajectory_+3A_zlab">zlab</code></td>
<td>
<p>A character string giving a label for the Z axis. When <code>is.null(zlab)=TRUE</code>, the default label for the Z axis is Z (<code>unitlength</code>).</p>
</td></tr>
<tr><td><code id="trajectory_+3A_...">...</code></td>
<td>
<p>Additional graphical parameters (see details).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To run <code>trajectory</code> efficiently, DART (.rac, .lie or .tps) and RSML (.rsml) files must have been saved with their appropriate extension.
</p>
<p>If <code>inputtps</code> contains a single tps file, it is used by <code>trajectory</code> for each lie/rac file located in <code>inputlie</code>/<code>inputrac</code>.  The number of lie files in <code>inputlie</code> must be equal to the number of rac files in <code>inputrac</code> and corresponding rac and lie files must have the same name.  If <code>inputps</code> contains more than one tps file, the number of tps files in <code>inputtps</code> must be equal to the number of rac/lie files in <code>inputrac</code>/<code>inputlie</code> and corresponding rac/lie and tps files must have the same name.
</p>
<p>After reading the RSML files located in <code>inputrsml</code>, the data associated with each root system are converted into data frames possessing the same structure as the lie/rac files created by DART.  The <code>trajectory</code> function then uses these data frames to compute RSA traits. 
</p>
<p>The argument <code>rsml.date</code> is used to create a tps file for each root system located in <code>inputrsml</code>.  If the root system age is stored as a continuous function along the root segments, the <code>rsml.date</code> argument can be a character string specifying the name/label of the function.  For instance, the root system age at the first apparition of each node is stored as a continuous function called &ldquo;age&rdquo; in RSML files containing RSA data simulated with the ArchiSimple model (<cite>Pages et al (2013)</cite>).  The &ldquo;age&rdquo; function attaches the root system age along the root segments, so that each node is associated with one age value.  An RSML library containing 3D RSA data simulated with ArchiSimple is available here: doi: <a href="https://doi.org/10.5281/zenodo.208214">10.5281/zenodo.208214</a>.
</p>
<p>The <code>rsml.connect</code> argument can be used to connect the lateral roots to their corresponding mother root.  If <code>rsml.connect=TRUE</code>, each point starting a lateral root is connected to the nearest point located on its mother root.  DBase is approximated by the distance between the parent root base and the point located on the mother root that is closest to the point starting a lateral root.  Using RSML files, only RSA data associated with roots possessing a branching order lower or equal to 7 are used for the computation of RSA traits.
</p>
<p>Due to technical limitations, it is sometimes easier to take a picture of a root system if it is rotated before image acquisition.  In this case, the vectorized root system depicts a rotation compared with the natural plant root system.  In order to make a correction, one can use <code>rotation</code> to specify an angle value expressed in <code>unitangle</code> to rotate the vectorized root system clockwise before plotting.  
</p>
<p>Hereafter, we will consider that the normal vector that is orthogonal to a direction vector (a,b) has the following coordinates: (b,-a).  
The direction of lateral root growth is only computed for 2D root systems. A daughter root is considered to grow at the left side of the mother root if the scalar product between a direction vector (=vector A) going from the branching point (X0) to the following point (Xd) on the daughter root and a vector (=vector B) normal to a direction vector (=vector C) going from the branching point (X0) to the following point on the mother root (Xm) is positive.  If the scalar product between A and B is negative, the daughter root is considered to grow at the right side of the mother root.  If the scalar product between A and B is equal to zero, the calculation of the scalar product between A and B will be performed again using a vector A going from the branching point (X0) to a point located on the daughter root at Xd&lt;-Xd+1 until the calculated scalar product is different from zero.  If A is always normal to B, a random lateral root growth orientation (either left or right) is defined.  See table 2 and figure 1 of <cite>Delory et al (2016)</cite> for more information.
</p>
<p>The branching angle of a daughter root on its mother root is approximated by the angle between two direction vectors going from the branching point to an interpolated point located at a distance <code>l.brangle</code> from the branching point on the mother or on the daughter root, respectively.  The distance <code>l.brangle</code> between a branching point and an interpolated point is measured along the mother and the daughter roots.  A first-order root having no mother root, the reported angle is the angle measured between a vertical direction vector and a second direction vector going from the first node of the root to an interpolated point located at a distance <code>l.brangle</code> from the first node on the first-order root. If a root has a final length lower than <code>l.brangle</code>, no branching angle can be calculated and the function returns a <code>NA</code> value for Branching.Angle.  See table 2 and figure 1 of <cite>Delory et al (2016)</cite> for more information.
</p>
<p>For each root, the growth direction angle is calculated as the angle between a vertical direction vector and a second direction vector going from the branching point to the apex of the root.
</p>
<p>The curvature of each root is evaluated by the mean and the standard deviation of the local angles formed by the direction vectors of the successive links constituting a vectorized root.  First, the function uses <code>l.curv</code> to interpolate equidistantly spaced points along each root constituting a vectorized root system.  Second, the angles between the direction vectors of successive links along each root are calculated. Then, the mean and the standard deviation of the calculated angles are determined for each root.  If a root has a final length lower than 2*<code>l.curv</code>, the function returns a <code>NA</code> value for Mean.Curv and SD.Curv. If a root has a final length lower than 3*<code>l.curv</code>, the function returns a <code>NA</code> value for SD.Curv as no standard deviation can be calculated on a single angle value.  See table 2 and figure 1 of <cite>Delory et al (2016)</cite> for more information.
</p>
<p>Making 3D plots with <code>twod = NULL</code> requires the <code>rgl</code> package, which is otherwise optional. If it is not installed (which can be annoying to do on some OSes), <code>trajectory()</code> will complain when you attempt a 3D plot but will still work normally for 2D.
</p>


<h3>Value</h3>

<p>Returns a list including:
</p>
<table role = "presentation">
<tr><td><code>root</code></td>
<td>
<p>A list of data frames. Each element of the list is named as its corresponding rac/lie/RSML file and contains the following columns: <b>Root</b> (the identification number of each root constituting the vectorized root system), <b>Mother</b> (the parent root identification number), <b>Ord</b> (the branching order), <b>DBase</b> (the distance between the branching point to the parent root base expressed in <code>unitlength</code>), <b>FinalRootLength</b> (the root length at the last observation date expressed in <code>unitlength</code>), <b>Tortuosity</b> (the ratio of the final root length to the Euclidean distance between the branching point and the apex of the root), <b>Orientation</b> (the direction of the lateral root growth; only for 2D root systems), <b>Branching.Angle</b> (the branching angle expressed in <code>unitangle</code>), <b>Growth.Direction</b> (the growth direction angle expressed in <code>unitangle</code>), <b>Mean.Curv</b> (the mean of the local angle values calculated between the direction vectors of the successive links constructed using equidistantly spaced interpolated points along each root of a vectorized root system; the calculated mean is expressed in <code>unitangle</code>), <b>SD.Curv</b> (the standard deviation of the local angle values calculated between the direction vectors of the successive links constructed using equidistantly spaced interpolated points along each root of a vectorized root system; the calculated standard deviation is expressed in <code>unitangle</code>), <b>Colors</b> (if <code>export.colors=TRUE</code>, the colors used to plot each root).</p>
</td></tr>
<tr><td><code>tip</code></td>
<td>
<p>A list of data frames. Each element of the list is named as its corresponding rac/lie/RSML file and contains the following columns: <b>Root</b> (the identification number of each root constituting the vectorized root system), <b>Ang.DateX</b> (the calculated root tip angle relative to a vertical direction vector at the observation date X expressed in <code>unitangle</code>).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Benjamin M. Delory, Guillaume Lobet, Loic Pages
</p>


<h3>References</h3>

<p>Delory B.M., Baudson C., Brostaux Y., Lobet G., du Jardin P., Pages L., Delaplace P. (2016) archiDART: an R package for the automated computation of plant root architectural traits, <em>Plant and Soil</em>, DOI: 10.1007/s11104-015-2673-4.
</p>
<p>Le Bot J., Serra V., Fabre J., Draye X., Adamowicz S., Pages L. (2010) DART: a software to analyse root system architecture and development from captured images, <em>Plant and Soil</em>, DOI: 10.1007/s11104-009-0005-2.
</p>
<p>Lobet G., Pound M.P., Diener J., Pradal C., Draye X., Godin C., Javaux M., Leitner D., Meunier F., Nacry P., Pridmore T.P., Schnepf A. (2015) Root System Markup Language: Toward a Unified Root Architecture Description Language, <em>Plant Physiology</em>, DOI: 10.1104/pp.114.253625.
</p>
<p>Pages L., Becel C., Boukcim H., Moreau D., Nguyen C., Voisin, A-S. (2013) Calibration and evaluation of ArchiSimple, a simple model of root system architecture, <em>Ecological Modelling</em>, DOI: 10.1016/j.ecolmodel.2013.11.014.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Locate folder with DART and RSML files
path &lt;- system.file("extdata", package="archiDART")

##---------------------
## DART and RSML files
##---------------------

res4 &lt;- trajectory(inputrac=path, inputlie=path, inputtps=path, inputrsml=path, res=75, 
unitlength="cm", rsml.date="age", l.brangle=1, l.curv=1, l.tipangle=0.5, vertical3d="y")

## Distribution of the calculated branching angles
hist(res4$root$ch7$Branching.Angle, breaks=seq(from=0, to=180, by=5),
main="ch7-Branching angle distribution", xlab="Branching angle (d)", las=1,
xaxp=c(0,150,15), xlim=c(0,150))

## Evolution of the root tip angle for the primary root (black) and the two longest lateral roots
## (green and red)
date&lt;-c(1:31)
plot(date, res4$tip$ch7[1,2:ncol(res4$tip$ch7)], type="l", lwd=2, bty="l",
las=1, ylim=c(0,90), ylab="ch7 - Root tip angle (d)", xlab="Time (Num)", col="black",
main="Root tip angle", yaxp=c(0,90,9))
lines(date, res4$tip$ch7[206,2:ncol(res4$tip$ch7)], lwd=2, col="green")
lines(date, res4$tip$ch7[221,2:ncol(res4$tip$ch7)], lwd=2, col="red")

## Branching angles of lateral roots
monocot&lt;-res4$root$'monocot-archisimple'
data&lt;-data.frame(Factor=c(rep("Monocot", nrow(monocot))), monocot)
boxplot(Branching.Angle[Ord==2]~Factor[Ord==2], data=data, ylab="Branching angle (d)",
ylim=c(45,70), main="Branching angle laterals - Monocot", las=1, outline=FALSE,
range=0, notch=TRUE)

## Evolution of the root tip angle for the first-order roots of the monocot root system
tip&lt;-res4$tip$'monocot-archisimple'
root&lt;-res4$root$'monocot-archisimple'
date&lt;-c(1:(ncol(tip)-1))
firstorderroots&lt;-which(root$Ord==1)
colors&lt;-colorRampPalette(c("red", "green"))(length(firstorderroots))

plot(date, tip[1,2:ncol(tip)], type="n", lwd=2, bty="l", las=1, ylim=c(0,90),
yaxp=c(0,90,9), xaxp=c(0,16,16), ylab="Root tip angle (d)", xlab="Time (Num)", col="black",
main="Monocot - Root tip angle first-order roots")

for (i in 1:length(firstorderroots)){lines(date, tip[firstorderroots[i], 2:ncol(tip)], lwd=2,
col=colors[i])}
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
