<!DOCTYPE html><html><head><title>Help for package PNAR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {PNAR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#PNAR-package'>
<p>Poisson Network Autoregressive Models</p></a></li>
<li><a href='#adja'>
<p>Generation of a network from the Stochastic Block Model</p></a></li>
<li><a href='#adja_gnp'>
<p>Generation of a network from the Erdos-Renyi model</p></a></li>
<li><a href='#crime'>
<p>Chicago crime dataset</p></a></li>
<li><a href='#crime_W'>
<p>Network matrix for Chicago crime dataset</p></a></li>
<li><a href='#getN'>
<p>Count the number of events within a specified time</p></a></li>
<li><a href='#global_optimise_LM_stnarpq'>
<p>Optimization of the score test statistic for the ST-PNAR(p) model</p></a></li>
<li><a href='#global_optimise_LM_tnarpq'>
<p>Optimization of the score test statistic for the T-PNAR(p) model</p></a></li>
<li><a href='#lin_estimnarpq'>
<p>Estimation of the linear Poisson NAR(p) model model with p lags and q</p>
covariates (PNAR(p))</a></li>
<li><a href='#lin_ic_plot'>
<p>Scatter plot of information criteria versus the number of lags in the linear Poisson NAR(p) model model with p lags and q</p>
covariates (PNAR(p))</a></li>
<li><a href='#lin_narpq_init'>
<p>Starting values for the linear Poisson NAR(p) model model with p lags and q</p>
covariates (PNAR(p))</a></li>
<li><a href='#log_lin_estimnarpq'>
<p>Estimation of the log-linear Poisson NAR(p) model with p lags and q</p>
covariates (log-PNAR(p))</a></li>
<li><a href='#log_lin_ic_plot'>
<p>Scatter plot of information criteria versus the number of lags in the log-linear Poisson NAR(p) model with p lags and q</p>
covariates (log-PNAR(p))</a></li>
<li><a href='#log_lin_narpq_init'>
<p>Starting values for the log-linear Poisson NAR(p) model with p lags and q</p>
covariates (log-PNAR(p))</a></li>
<li><a href='#poisson.MODpq'>
<p>Generation of counts from a linear Poisson NAR(p) model with</p>
q covariates (PNAR(p))</a></li>
<li><a href='#poisson.MODpq.log'>
<p>Generation of multivariate count time series from a log-linear Poisson NAR(p) model with q covariates</p>
(log-PNAR(p))</a></li>
<li><a href='#poisson.MODpq.nonlin'>
<p>Generation of multivariate count time series from a non-linear Intercept Drift Poisson NAR(p)</p>
model with q covariates (ID-PNAR(p))</a></li>
<li><a href='#poisson.MODpq.stnar'>
<p>Generation of counts from a non-linear Smooth Transition Poisson NAR(p)</p>
model with q covariates (ST-PNAR(p))</a></li>
<li><a href='#poisson.MODpq.tnar'>
<p>Generation of counts from a non-linear Threshold Poisson NAR(p)</p>
model with q covariates (T-PNAR(p))</a></li>
<li><a href='#rcopula'>
<p>Random number generation of copula functions</p></a></li>
<li><a href='#score_test_nonlinpq_h0'>
<p>Linearity test against non-linear ID-PNAR(p) model</p></a></li>
<li><a href='#score_test_stnarpq_DV'>
<p>Bound p-value for testing for smooth transition effects on PNAR(p) model</p></a></li>
<li><a href='#score_test_stnarpq_j'>
<p>Bootstrap test for smooth transition effects on PNAR(p) model</p></a></li>
<li><a href='#score_test_tnarpq_j'>
<p>Bootstrap test for threshold effects on PNAR(p) model</p></a></li>
<li><a href='#summary.DV'><p>S3 methods for extracting the results of the bound p-value for testing for smooth transition effects on PNAR(p) model</p></a></li>
<li><a href='#summary.nonlin'><p>S3 methods for extracting the results of the non-linear hypothesis test</p></a></li>
<li><a href='#summary.PNAR'><p>S3 methods for extracting the results of the estimation functions</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Poisson Network Autoregressive Models</td>
</tr>
<tr>
<td>Version:</td>
<td>1.6</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-10-09</td>
</tr>
<tr>
<td>Author:</td>
<td>Michail Tsagris [aut, cre],
  Mirko Armillotta [aut, cph],
  Konstantinos Fokianos [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Michail Tsagris &lt;mtsagris@uoc.gr&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Quasi likelihood-based methods for estimating linear and log-linear Poisson Network Autoregression models with p lags and covariates. Tools for testing the linearity versus several non-linear alternatives. Tools for simulation of multivariate count distributions, from linear and non-linear PNAR models, by using a specific copula construction. References include: Armillotta, M. and K. Fokianos (2022a). Poisson network autoregression. &lt;<a href="https://doi.org/10.48550/arXiv.2104.06296">doi:10.48550/arXiv.2104.06296</a>&gt;. Armillotta, M. and K. Fokianos (2022b). Testing linearity for network autoregressive models. &lt;<a href="https://doi.org/10.48550/arXiv.2202.03852">doi:10.48550/arXiv.2202.03852</a>&gt;. Armillotta, M., Tsagris, M. and Fokianos, K. (2022c). The R-package PNAR for modelling count network time series. &lt;<a href="https://doi.org/10.48550/arXiv.2211.02582">doi:10.48550/arXiv.2211.02582</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>doParallel, foreach, igraph, nloptr, parallel, Rfast, Rfast2,
stats</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-10-09 10:35:06 UTC; mtsag</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-10-09 13:40:14 UTC</td>
</tr>
</table>
<hr>
<h2 id='PNAR-package'>
Poisson Network Autoregressive Models
</h2><span id='topic+PNAR-package'></span><span id='topic+PNAR'></span>

<h3>Description</h3>

<p>Quasi likelihood-based methods for estimating linear and log-linear Poisson Network Autoregression models with p lags and covariates. Tools for testing the linearity versus several non-linear alternatives. Tools for simulation of multivariate count distributions, from linear and non-linear PNAR models, by using a specific copula construction. References include: Armillotta, M. and K. Fokianos (2022a). Poisson network autoregression. <a href="https://arxiv.org/abs/2104.06296">https://arxiv.org/abs/2104.06296</a>. Armillotta, M. and K. Fokianos (2022b). Testing linearity for network autoregressive models. <a href="https://arxiv.org/abs/2202.03852">https://arxiv.org/abs/2202.03852</a>. Armillotta, M., Tsagris, M. and Fokianos, K. (2022c). The R-package PNAR for modelling count network time series. <a href="https://arxiv.org/abs/2211.02582">https://arxiv.org/abs/2211.02582</a>.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> PNAR</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.6</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2023-10-09</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL(&gt;=2)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Note</h3>

<p><b>Disclaimer:</b> Dr Mirko Armillotta and Konstantinos Fokianos wrote the
initial functions. Dr Tsagris modified them, created the package and he is the
maintainer.
</p>
<p>We would to like to acknowledge Manos Papadakis for his help with the &quot;htest&quot; class object and S3 methods (print() and summary() functions).
</p>


<h3>Author(s)</h3>

<p>Michail Tsagris, Mirko Armillotta and Konstantinos Fokianos.
</p>


<h3>References</h3>

<p>Armillotta, M. and K. Fokianos (2022a). Poisson network autoregression.
<a href="https://arxiv.org/abs/2104.06296">https://arxiv.org/abs/2104.06296</a>
</p>
<p>Armillotta, M. and K. Fokianos (2022b). Testing linearity for network
autoregressive models. <a href="https://arxiv.org/abs/2202.03852">https://arxiv.org/abs/2202.03852</a>
</p>

<hr>
<h2 id='adja'>
Generation of a network from the Stochastic Block Model
</h2><span id='topic+adja'></span>

<h3>Description</h3>

<p>This function generates a network from the Stochastic Block Model with <code class="reqn">K</code> blocks.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>adja(N, K, alpha, directed = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="adja_+3A_n">N</code></td>
<td>

<p>The number of nodes on the network.
</p>
</td></tr>
<tr><td><code id="adja_+3A_k">K</code></td>
<td>

<p>The number of blocks. Each block has dimension <code class="reqn">N/K</code>. <code class="reqn">K</code>
should be chosen such that <code class="reqn">N</code> is divisible by <code class="reqn">K</code>.
</p>
</td></tr>
<tr><td><code id="adja_+3A_alpha">alpha</code></td>
<td>

<p>The network density. A value in <code class="reqn">[0,1]</code> defining the frequency of connections
in the network.
</p>
</td></tr>
<tr><td><code id="adja_+3A_directed">directed</code></td>
<td>

<p>Logical scalar, whether to generate a directed network or not. If TRUE a directed
network is generated.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For each pair of nodes it performs a Bernoulli trial with values 1 &quot;draw an edge&quot;, 0 &quot;otherwise&quot;.
The probabilities of these trials are bigger if the two nodes are in the same block, lower otherwise, and they are specified based on the number of nodes on the network <code class="reqn">N</code> and network density <code class="reqn">alpha</code>:
Probability to draw an edge for a pair of nodes in the same block: <code class="reqn">\alpha*N^{-0.3}</code>.
Probability to draw an edge for a pair of nodes in different blocks: <code class="reqn">\alpha*N^{-1}</code>.
</p>


<h3>Value</h3>

<p>A row-normalized non-negative matrix describing the network. The main diagonal
entries of the matrix are zeros, all the other entries are non-negative and the
sum of elements over the rows equals one.
</p>


<h3>Author(s)</h3>

<p>Mirko Armillotta, Michail Tsagris and Konstantinos Fokianos.
</p>


<h3>References</h3>

<p>Faust, K. and S. Wasserman (1992). Blockmodels: Interpretation and evaluation.
<em>Social Networks</em>, 14, 5-61.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+adja_gnp">adja_gnp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>W &lt;- adja(N = 20, K = 5, alpha = 0.1)
</code></pre>

<hr>
<h2 id='adja_gnp'>
Generation of a network from the Erdos-Renyi model
</h2><span id='topic+adja_gnp'></span>

<h3>Description</h3>

<p>This function generates a network from the Erdos-Renyi model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>adja_gnp(N, alpha, directed = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="adja_gnp_+3A_n">N</code></td>
<td>

<p>The number of nodes on the network.
</p>
</td></tr>
<tr><td><code id="adja_gnp_+3A_alpha">alpha</code></td>
<td>

<p>The network density. A value in <code class="reqn">[0,1]</code> defining the frequency of
connections in the network.
</p>
</td></tr>
<tr><td><code id="adja_gnp_+3A_directed">directed</code></td>
<td>

<p>Logical scalar, whether to generate a directed network. If TRUE a directed
network is generated.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For each pair of nodes it performs a Bernoulli trial with values 1 &quot;draw an edge&quot;, 0 &quot;otherwise&quot;.
Each trial has the same probability of having an edge; this is equal to <code class="reqn">\alpha*N^{-0.3}</code>, specified based on the number of nodes on the network <code class="reqn">N</code> and the network density <code>alpha</code>.
</p>


<h3>Value</h3>

<p>A row-normalized non-negative matrix describing the network. The main diagonal
entries of the matrix are zeros, all the other entries are non-negative and the
maximum sum of elements over the rows equals one.
</p>


<h3>Author(s)</h3>

<p>Mirko Armillotta, Michail Tsagris and Konstantinos Fokianos.
</p>


<h3>References</h3>

<p>Erdos, P. and A. Renyi (1959). On random graphs.
<em>Publicationes Mathematicae</em>, 6, 290-297.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+adja">adja</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>W &lt;- adja_gnp(N = 20, alpha= 0.1)
</code></pre>

<hr>
<h2 id='crime'>
Chicago crime dataset
</h2><span id='topic+crime'></span>

<h3>Description</h3>

<p>Monthly number of burglaries on the south side of Chicago (552 blocks) during
2010-2015 (72 temporal observations).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crime</code></pre>


<h3>Format</h3>

<p>A time series object (&quot;ts&quot; class) with multivariate time series, a matrix with 72 rows and 552 columns.
</p>


<h3>Source</h3>

<p>Clark and Dixon (2021), available at <a href="https://github.com/nick3703/Chicago-Data">https://github.com/nick3703/Chicago-Data</a>.
</p>


<h3>References</h3>

<p>Clark, N. J. and P. M. Dixon (2021). A class of spatially correlated
self-exciting statistical models. <em>Spatial Statistics</em>, 43, 1-18.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+crime_W">crime_W</a>, <a href="#topic+lin_estimnarpq">lin_estimnarpq</a>, <a href="#topic+log_lin_estimnarpq">log_lin_estimnarpq</a>
</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(crime)
data(crime_W)
mod1 &lt;- lin_estimnarpq( crime, crime_W, p = 1)
mod2 &lt;- log_lin_estimnarpq( crime, crime_W, p = 1)
</code></pre>

<hr>
<h2 id='crime_W'>
Network matrix for Chicago crime dataset
</h2><span id='topic+crime_W'></span>

<h3>Description</h3>

<p>Non-negative row-normized adjacency matrix describing the network structure
between Chicago census blocks.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crime_W</code></pre>


<h3>Format</h3>

<p>A matrix with 552 rows and 552 columns.
</p>


<h3>Source</h3>

<p>Clark and Dixon (2021), available at <a href="https://github.com/nick3703/Chicago-Data">https://github.com/nick3703/Chicago-Data</a>.
</p>


<h3>References</h3>

<p>Clark, N. J. and P. M. Dixon (2021). A class of spatially correlated
self-exciting statistical models. <em>Spatial Statistics</em>, 43, 1-18.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+crime">crime</a>, <a href="#topic+lin_estimnarpq">lin_estimnarpq</a>, <a href="#topic+log_lin_estimnarpq">log_lin_estimnarpq</a>
</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(crime)
data(crime_W)
mod1 &lt;- lin_estimnarpq(crime, crime_W, p = 1)
mod2 &lt;- log_lin_estimnarpq(crime, crime_W, p = 1)
</code></pre>

<hr>
<h2 id='getN'>
Count the number of events within a specified time
</h2><span id='topic+getN'></span>

<h3>Description</h3>

<p>This function counts the number of events within a specified time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getN(x, tt = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getN_+3A_x">x</code></td>
<td>

<p>A matrix of (positive) inter-event times.
</p>
</td></tr>
<tr><td><code id="getN_+3A_tt">tt</code></td>
<td>

<p>A positive time.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The number of events within time <code>tt</code> (possibly 0), for each column of
<code>x</code>.
</p>


<h3>Author(s)</h3>

<p>Mirko Armillotta, Michail Tsagris and Konstantinos Fokianos.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rcopula">rcopula</a>, <a href="#topic+poisson.MODpq">poisson.MODpq</a>, <a href="#topic+poisson.MODpq.log">poisson.MODpq.log</a>
</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- rcopula(n = 100, N = 50, rho = 0.3)
getN(x)
</code></pre>

<hr>
<h2 id='global_optimise_LM_stnarpq'>
Optimization of the score test statistic for the ST-PNAR(p) model
</h2><span id='topic+global_optimise_LM_stnarpq'></span>

<h3>Description</h3>

<p>Global optimization of the linearity test statistic for the Smooth Transition
Poisson Network Autoregressive model of order <code class="reqn">p</code> with <code class="reqn">q</code> covariates
(ST-PNAR(<code class="reqn">p</code>)) with respect to the nuisance scale parameter <code class="reqn">\gamma</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>global_optimise_LM_stnarpq(gama_L = NULL, gama_U = NULL, len = 10, b, y, W,
p, d, Z = NULL, tol = 1e-9)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="global_optimise_LM_stnarpq_+3A_gama_l">gama_L</code></td>
<td>

<p>The lower value of the <code class="reqn">\gamma</code> values to consider.
Use NULL if there is not information about its value.
See the details for default computation.
</p>
</td></tr>
<tr><td><code id="global_optimise_LM_stnarpq_+3A_gama_u">gama_U</code></td>
<td>

<p>The upper value of the <code class="reqn">\gamma</code> values to consider.
Use NULL if there is not information about its value.
See the details for default computation.
</p>
</td></tr>
<tr><td><code id="global_optimise_LM_stnarpq_+3A_len">len</code></td>
<td>

<p>The number of increments to consider for the <code class="reqn">\gamma</code> parameter.
</p>
</td></tr>
<tr><td><code id="global_optimise_LM_stnarpq_+3A_b">b</code></td>
<td>

<p>The estimated parameters from the linear model, in the following order:
(intercept, network parameters, autoregressive parameters, covariates).
The length of the vector should be <code class="reqn">2p + 1 + q</code>, where <code class="reqn">q</code> denotes the number of covariates.
</p>
</td></tr>
<tr><td><code id="global_optimise_LM_stnarpq_+3A_y">y</code></td>
<td>

<p>A <code class="reqn">TT \times N</code> time series object or a <code class="reqn">TT \times N</code> numerical matrix with the <code class="reqn">N</code> multivariate count time series over <code class="reqn">TT</code> time periods.
</p>
</td></tr>
<tr><td><code id="global_optimise_LM_stnarpq_+3A_w">W</code></td>
<td>

<p>The <code class="reqn">N \times N</code> row-normalized non-negative adjacency matrix describing
the network. The main diagonal entries of the matrix should be zeros, all the
other entries should be non-negative and the maximum sum of elements over the
rows should equal one. The function row-normalizes the matrix if a non-normalized
adjacency matrix is provided.
</p>
</td></tr>
<tr><td><code id="global_optimise_LM_stnarpq_+3A_p">p</code></td>
<td>

<p>The number of lags in the model.
</p>
</td></tr>
<tr><td><code id="global_optimise_LM_stnarpq_+3A_d">d</code></td>
<td>

<p>The lag parameter of non-linear variable (should be between 1 and <code class="reqn">p</code>).
</p>
</td></tr>
<tr><td><code id="global_optimise_LM_stnarpq_+3A_z">Z</code></td>
<td>

<p>An <code class="reqn">N \times q</code> matrix of covariates (one for each column), where <code class="reqn">q</code>
is the number of covariates in the model. Note that they must be non-negative.
</p>
</td></tr>
<tr><td><code id="global_optimise_LM_stnarpq_+3A_tol">tol</code></td>
<td>

<p>Tolerance level for the optimizer.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function optimizes the quasi score test statistic, under the null assumption of linearity, for testing linearity of Poisson Network Autoregressive model of order <code class="reqn">p</code> against the following ST-PNAR(<code class="reqn">p</code>) model, with respect to the unknown nuisance parameter (<code class="reqn">\gamma</code>). For each node of the network <code class="reqn">i=1,...,N</code> over the time sample <code class="reqn">t=1,...,TT</code>
</p>
<p style="text-align: center;"><code class="reqn">
\lambda_{i,t}=\beta_{0}+\sum_{h=1}^{p}(\beta_{1h}X_{i,t-h}+\beta_{2h}Y_{i,t-h}+\alpha_{h}e^{-\gamma X_{i,t-d}^{2}}X_{i,t-h})+\sum_{l=1}^{q}\delta_{l}Z_{i,l}
</code>
</p>

<p>where <code class="reqn">X_{i,t}=\sum_{j=1}^{N}W_{ij}Y_{j,t}</code> is the network effect, i.e. the weighted average impact of node <code class="reqn">i</code> connections, with the weights of the mean being <code class="reqn">W_{ij}</code>, the single element of the network matrix <code class="reqn">W</code>. The sequence <code class="reqn">\lambda_{i,t}</code> is the expectation of <code class="reqn">Y_{i,t}</code>, conditional to its past values.
</p>
<p>The null hypothesis of the test is defined as <code class="reqn">H_{0}: \alpha_{1}=...=\alpha_{p}=0</code>, versus the alternative that at least one among <code class="reqn">\alpha_{h}</code> is not 0. The test statistic has the form
</p>
<p style="text-align: center;"><code class="reqn">
LM(\gamma)=S^{'}(\hat{\theta},\gamma)\Sigma^{-1}(\hat{\theta},\gamma)S(\hat{\theta},\gamma)
</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">
S(\hat{\theta},\gamma)=\sum_{t=1}^{TT}\sum_{i=1}^{N}\left(\frac{Y_{i,t}}{\lambda_{i,t}(\hat{\theta},\gamma)}-1\right) \frac{\partial\lambda_{i,t}(\hat{\theta},\gamma)}{\partial\alpha}
</code>
</p>

<p>is the partition of the quasi score related to the vector of non-linear parameters <code class="reqn">\alpha=(\alpha_{1},...,\alpha_{p})</code>, evaluated at the estimated parameters <code class="reqn">\hat{\theta}</code> under the null assumption <code class="reqn">H_{0}</code> (linear model) and <code class="reqn">\Sigma(\hat{\theta},\gamma)</code> is the variance of <code class="reqn">S(\hat{\theta},\gamma)</code>.
</p>
<p>The optimization employes the Brent algorithm (Brent, 1973) applied in the interval from <code>gama_L</code> to <code>gama_U</code>. To be sure that the global optimum is found, the optimization is performed at (<code>len</code>-1) consecutive equidistant sub-intervals and then the maximum over them is taken as global optimum.
</p>
<p>The values of <code>gama_L</code> and <code>gama_U</code> are computed internally as <code>gama_L</code> <code class="reqn">=-\log(0.9)/X^{2}</code> and <code>gama_U</code> <code class="reqn">=-\log(0.1)/X^{2}</code>, where <code class="reqn">X</code> is the overall mean of <code class="reqn">X_{i,t}</code> over the nodes <code class="reqn">i=1,...,N</code> and times <code class="reqn">t=1,...,TT</code>. Since the non-linear function <code class="reqn">e^{-\gamma X_{i,t-d}^{2}}</code> ranges between 0 and 1, by considering <code class="reqn">X</code> to be a representative value for the network mean, <code>gama_U</code> and <code>gama_L</code> would be the values of <code class="reqn">\gamma</code> leading the non-linear switching function to be 0.1 and 0.9, respectively, so that in the optimization procedure the extremes of the function domain are excluded. Alternatively, their value can be supplied by the user. For details see Armillotta and Fokianos (2022b, Sec. 4-5).
</p>


<h3>Value</h3>

<p>A list including:
</p>
<table>
<tr><td><code>gama</code></td>
<td>

<p>The optimum value of the <code class="reqn">\gamma</code> parameter.
</p>
</td></tr>
<tr><td><code>supLM</code></td>
<td>

<p>The value of the objective function at the optimum.
</p>
</td></tr>
<tr><td><code>int</code></td>
<td>

<p>A vector with the extremes points of sub-intervals.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mirko Armillotta, Michail Tsagris and Konstantinos Fokianos.
</p>


<h3>References</h3>

<p>Armillotta, M. and K. Fokianos (2022a). Poisson network autoregression.
<a href="https://arxiv.org/abs/2104.06296">https://arxiv.org/abs/2104.06296</a>
</p>
<p>Armillotta, M. and K. Fokianos (2022b). Testing linearity for network
autoregressive models.
<a href="https://arxiv.org/abs/2202.03852">https://arxiv.org/abs/2202.03852</a>
</p>
<p>Armillotta, M., Tsagris, M. and Fokianos, K. (2022c). The R-package PNAR
for modelling count network time series.
<a href="https://arxiv.org/abs/2211.02582">https://arxiv.org/abs/2211.02582</a>
</p>
<p>Brent, R. (1973) Algorithms for Minimization without Derivatives.
Prentice-Hall, Englewood Cliffs N.J.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+score_test_stnarpq_j">score_test_stnarpq_j</a>, <a href="#topic+global_optimise_LM_tnarpq">global_optimise_LM_tnarpq</a>,
<a href="#topic+score_test_tnarpq_j">score_test_tnarpq_j</a>
</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(crime)
data(crime_W)
mod1 &lt;- lin_estimnarpq(crime, crime_W, p = 1)
b &lt;- mod1$coefs[, 1]
global_optimise_LM_stnarpq(b = b, y = crime, W = crime_W, p = 1, d = 1)
</code></pre>

<hr>
<h2 id='global_optimise_LM_tnarpq'>
Optimization of the score test statistic for the T-PNAR(p) model
</h2><span id='topic+global_optimise_LM_tnarpq'></span>

<h3>Description</h3>

<p>Global optimization of the linearity test statistic for the Threshold Poisson
Network Autoregressive model of order <code class="reqn">p</code> with <code class="reqn">q</code> covariates
(T-PNAR(<code class="reqn">p</code>)) with respect to the nuisance threshold parameter <code class="reqn">\gamma</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>global_optimise_LM_tnarpq(gama_L = NULL, gama_U = NULL, len = 10, b, y, W,
p, d, Z = NULL, tol = 1e-9)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="global_optimise_LM_tnarpq_+3A_gama_l">gama_L</code></td>
<td>

<p>The lower value of the <code class="reqn">\gamma</code> values to consider. Use NULL if there is not information about its value.. See the details for default computation.
</p>
</td></tr>
<tr><td><code id="global_optimise_LM_tnarpq_+3A_gama_u">gama_U</code></td>
<td>

<p>The upper value of the <code class="reqn">\gamma</code> values to consider. Use NULL if there is not information about its value.. See the details for default computation.
</p>
</td></tr>
<tr><td><code id="global_optimise_LM_tnarpq_+3A_len">len</code></td>
<td>

<p>The number of increments to consider for the <code class="reqn">\gamma</code> parameter.
</p>
</td></tr>
<tr><td><code id="global_optimise_LM_tnarpq_+3A_b">b</code></td>
<td>

<p>The estimated parameters from the linear model, in the following order:
(intercept, network parameters, autoregressive parameters, covariates).
The dimension of the vector should be <code class="reqn">2p + 1 + q</code>, where <code class="reqn">q</code> denotes the number of covariates.
</p>
</td></tr>
<tr><td><code id="global_optimise_LM_tnarpq_+3A_y">y</code></td>
<td>

<p>A <code class="reqn">TT \times N</code> time series object or a <code class="reqn">TT \times N</code> numerical matrix with the <code class="reqn">N</code> multivariate count time series over <code class="reqn">TT</code> time periods.
</p>
</td></tr>
<tr><td><code id="global_optimise_LM_tnarpq_+3A_w">W</code></td>
<td>

<p>The <code class="reqn">N \times N</code> row-normalized non-negative adjacency matrix describing
the network. The main diagonal entries of the matrix should be zeros, all the
other entries should be non-negative and the maximum sum of elements over the
rows should equal one. The function row-normalizes the matrix if a non-normalized
adjacency matrix is provided.
</p>
</td></tr>
<tr><td><code id="global_optimise_LM_tnarpq_+3A_p">p</code></td>
<td>

<p>The number of lags in the model.
</p>
</td></tr>
<tr><td><code id="global_optimise_LM_tnarpq_+3A_d">d</code></td>
<td>

<p>The lag parameter of non-linear variable (should be between 1 and <code class="reqn">p</code>).
</p>
</td></tr>
<tr><td><code id="global_optimise_LM_tnarpq_+3A_z">Z</code></td>
<td>

<p>An <code class="reqn">N</code> x <code class="reqn">q</code> matrix of covariates (one for each column), where <code class="reqn">q</code>
is the number of covariates in the model. Note that they must be non-negative.
</p>
</td></tr>
<tr><td><code id="global_optimise_LM_tnarpq_+3A_tol">tol</code></td>
<td>

<p>Tolerance level for the optimizer.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function optimizes the quasi score test statistic, under the null assumption of linearity,
for testing linearity of Poisson Network Autoregressive model of order <code class="reqn">p</code> against the following T-PNAR(<code class="reqn">p</code>) model, with respect to the unknown nuisance parameter (<code class="reqn">\gamma</code>). For each node of the network <code class="reqn">i=1,...,N</code> over
the time sample <code class="reqn">t=1,...,TT</code>
</p>
<p style="text-align: center;"><code class="reqn">
\lambda_{i,t}=\beta_{0}+\sum_{h=1}^{p}\left[\beta_{1h}X_{i,t-h}+\beta_{2h}Y_{i,t-h}+(\alpha_{0}+\alpha_{1h}X_{i,t-h} +\alpha_{2h}Y_{i,t-h})I(X_{i,t-d}\leq\gamma)\right]+\sum_{l=1}^{q}\delta_{l}Z_{i,l}
</code>
</p>

<p>where <code class="reqn">X_{i,t}=\sum_{j=1}^{N} W_{ij}Y_{j,t}</code> is the network effect, i.e. the weighted average impact of node <code class="reqn">i</code> connections, with the weights of the mean being <code class="reqn">W_{ij}</code>, the single element of the network matrix <code class="reqn">W</code>, and <code class="reqn">I()</code> is the indicator function. The sequence <code class="reqn">\lambda_{i,t}</code> is the expectation of <code class="reqn">Y_{i,t}</code>, conditional to its past values.
</p>
<p>The null hypothesis of the test is defined as <code class="reqn">H_{0}: \alpha_{0}=\alpha_{11}=...=\alpha_{2p}=0</code>, versus the alternative that at least one among <code class="reqn">\alpha_{s,h}</code> is not <code class="reqn">0</code>, for <code class="reqn">s=0,1,2</code>. The test statistic has the form
</p>
<p style="text-align: center;"><code class="reqn">
LM(\gamma)=S^{'}(\hat{\theta},\gamma)\Sigma^{-1}(\hat{\theta},\gamma)S(\hat{\theta},\gamma)
</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">
S(\hat{\theta},\gamma)=\sum_{t=1}^{TT}\sum_{i=1}^{N}\left(\frac{Y_{i,t}}{\lambda_{i,t}(\hat{\theta},\gamma)}-1\right)\frac{\partial\lambda_{i,t}(\hat{\theta},\gamma)}{\partial\alpha}
</code>
</p>

<p>is the partition of the quasi score related to the vector of non-linear parameters <code class="reqn">\alpha=(\alpha_{0},...,\alpha_{2p})</code>, evaluated at the estimated parameters <code class="reqn">\hat{\theta}</code> under the null assumption <code class="reqn">H_{0}</code> (linear model) and <code class="reqn">\Sigma(\hat{\theta},\gamma)</code> is the variance of <code class="reqn">S(\hat{\theta},\gamma)</code>.
</p>
<p>The optimization employes the Brent algorithm (Brent, 1973) applied in the interval from <code>gama_L</code> to <code>gama_U</code>. To be sure that the global optimum is found, the optimization is performed at (<code>len</code>-1) consecutive equidistant sub-intervals and then the maximum over them is taken as global optimum.
</p>
<p>The values of <code>gama_L</code> and <code>gama_U</code> are computed internally as the mean over <code class="reqn">i=1,...,N</code> of <code class="reqn">20\%</code> and <code class="reqn">80\%</code> quantile of the empirical distribution of the network mean <code class="reqn">X_{i,t}</code> for <code class="reqn">t=1,...,TT</code>. In this way the optimization is performed for values of <code class="reqn">\gamma</code> such that the indicator function <code class="reqn">I(X_{i,t-d}\leq\gamma)</code> is not always close to 0 or 1. Alternatively, their value can be supplied by the user. For details see Armillotta and Fokianos (2022b, Sec. 4-5).
</p>


<h3>Value</h3>

<p>A list including:
</p>
<table>
<tr><td><code>gama</code></td>
<td>

<p>The optimum value of the <code class="reqn">\gamma</code> parameter.
</p>
</td></tr>
<tr><td><code>supLM</code></td>
<td>

<p>The value of the objective function at the optimum.
</p>
</td></tr>
<tr><td><code>int</code></td>
<td>

<p>A vector with the extremes points of sub-intervals.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mirko Armillotta, Michail Tsagris and Konstantinos Fokianos.
</p>


<h3>References</h3>

<p>Armillotta, M. and K. Fokianos (2022a). Poisson network autoregression.
<a href="https://arxiv.org/abs/2104.06296">https://arxiv.org/abs/2104.06296</a>
</p>
<p>Armillotta, M. and K. Fokianos (2022b). Testing linearity for network
autoregressive models.
<a href="https://arxiv.org/abs/2202.03852">https://arxiv.org/abs/2202.03852</a>
</p>
<p>Armillotta, M., Tsagris, M. and Fokianos, K. (2022c). The R-package PNAR
for modelling count network time series.
<a href="https://arxiv.org/abs/2211.02582">https://arxiv.org/abs/2211.02582</a>
</p>
<p>Brent, R. (1973) Algorithms for Minimization without Derivatives.
Prentice-Hall, Englewood Cliffs N.J.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+score_test_tnarpq_j">score_test_tnarpq_j</a>, <a href="#topic+global_optimise_LM_stnarpq">global_optimise_LM_stnarpq</a>,
<a href="#topic+score_test_stnarpq_j">score_test_stnarpq_j</a>
</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(crime)
data(crime_W)
mod1 &lt;- lin_estimnarpq(crime, crime_W, p = 2)
b &lt;- mod1$coefs[, 1]
global_optimise_LM_tnarpq(b = b, y = crime, W = crime_W, p = 2, d = 1)
</code></pre>

<hr>
<h2 id='lin_estimnarpq'>
Estimation of the linear Poisson NAR(p) model model with p lags and q
covariates (PNAR(p))
</h2><span id='topic+lin_estimnarpq'></span>

<h3>Description</h3>

<p>Estimation of the linear Poisson Network Autoregressive model of order <code class="reqn">p</code>
with <code class="reqn">q</code> covariates (PNAR(<code class="reqn">p</code>)).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lin_estimnarpq(y, W, p, Z = NULL, uncons = FALSE, init = NULL,
xtol_rel = 1e-8, maxeval = 100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lin_estimnarpq_+3A_y">y</code></td>
<td>

<p>A <code class="reqn">TT \times N</code> time series object or a <code class="reqn">TT \times N</code> numerical matrix with the <code class="reqn">N</code> multivariate count time series over <code class="reqn">TT</code> time periods.
</p>
</td></tr>
<tr><td><code id="lin_estimnarpq_+3A_w">W</code></td>
<td>

<p>The <code class="reqn">N \times N</code> row-normalized non-negative adjacency matrix describing
the network. The main diagonal entries of the matrix should be zeros, all the
other entries should be non-negative and the maximum sum of elements over the
rows should equal one. The function row-normalizes the matrix if a non-normalized
adjacency matrix is provided.
</p>
</td></tr>
<tr><td><code id="lin_estimnarpq_+3A_p">p</code></td>
<td>

<p>The number of lags in the model.
</p>
</td></tr>
<tr><td><code id="lin_estimnarpq_+3A_z">Z</code></td>
<td>

<p>An <code class="reqn">N \times q</code> matrix of covariates (one for each column), where <code class="reqn">q</code>
is the number of covariates in the model. Note that they must be non-negative.
</p>
</td></tr>
<tr><td><code id="lin_estimnarpq_+3A_uncons">uncons</code></td>
<td>

<p>logical, if TRUE an unconstrained optimization is run (default is FALSE).
</p>
</td></tr>
<tr><td><code id="lin_estimnarpq_+3A_init">init</code></td>
<td>

<p>A vector of starting values for the optimization algorithm. If this is NULL,
the function computes them internally.
</p>
</td></tr>
<tr><td><code id="lin_estimnarpq_+3A_xtol_rel">xtol_rel</code></td>
<td>

<p>The stopping tolerance of the optimization algorithm.
</p>
</td></tr>
<tr><td><code id="lin_estimnarpq_+3A_maxeval">maxeval</code></td>
<td>

<p>The maximum number of evalutions the optimization algorithm will perform.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function performs constrained estimation of the linear Poisson NAR(<code class="reqn">p</code>) model with <code class="reqn">q</code> non-negative valued covariates, for each node of the network <code class="reqn">i=1,...,N</code> over the time sample <code class="reqn">t=1,...,TT</code>, defined as
</p>
<p style="text-align: center;"><code class="reqn">
\lambda_{i,t}=\beta_{0}+\sum_{h=1}^{p}(\beta_{1h}X_{i,t-h}+\beta_{2h}Y_{i,t-h})+\sum_{l=1}^{q}\delta_{l}Z_{i,l},
</code>
</p>

<p>where <code class="reqn">X_{i,t}=\sum_{j=1}^{N}W_{ij}Y_{j,t}</code> is the network effect, i.e. the weighted average impact of node <code class="reqn">i</code> connections, with the weights of the mean being <code class="reqn">W_{ij}</code>, the single element of the network matrix <code class="reqn">W</code>. The sequence <code class="reqn">\lambda_{i,t}</code> is the expecation of <code class="reqn">Y_{i,t}</code>, conditional to its past values. The parameter <code class="reqn">\beta_{0}</code> is the intercept of the model, <code class="reqn">\beta_{1h}</code> are the network coefficients, <code class="reqn">\beta_{2h}</code> are the autoregressive parameters, and <code class="reqn">\delta_{l}</code> are the coefficients assocciated to the covariates <code class="reqn">Z_{i,l}</code>.
</p>
<p>The estimation of the parameters of the model is performed by Quasi Maximum Likelihood Estimation (QMLE), maximizing the following quasi log-likelihood
</p>
<p style="text-align: center;"><code class="reqn">
l(\theta)=\sum_{t=1}^{TT}\sum_{i=1}^{N}\left[Y_{i,t}\log\lambda_{i,t}(\theta)-\lambda_{i,t}(\theta)\right]
</code>
</p>

<p>with respect to the vector of unknown parameters <code class="reqn">\theta</code> described above. The coefficients are defined only in the non-negative real line.
</p>
<p>By default, the optimization is constrained in the stationary region where <code class="reqn">\sum_{h=1}^{p}(\beta_{1h}+\beta_{2h})&lt;1</code>; this can be removed by setting <code>uncons = TRUE</code>. However, the model estimates might be inconsistent if the estimated parameters lie outside the stationary region.
</p>
<p>The ordinary least squares estimates are employed as starting values of the optimization procedure. Robust standard errors and z-tests are also returned.
</p>


<h3>Value</h3>

<p>A list with attribute class &quot;PNAR&quot; including:
</p>
<table>
<tr><td><code>coefs</code></td>
<td>

<p>A matrix with the estimated QMLE coefficients, their standard errors their Z-test statistics and the relevant p-values computed via the standard normal approximation.
</p>
</td></tr>
<tr><td><code>score</code></td>
<td>

<p>The value of the quasi score function at the optimization point.
It should be close to 0 if the optimization is successful.
</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>

<p>The value of the maximized quasi log-likelihood.
</p>
</td></tr>
<tr><td><code>ic</code></td>
<td>

<p>A vector with the Akaike information criterion (AIC), the Bayesian information criterion (BIC) and the Quasi information criterion (QIC).
</p>
</td></tr>
</table>
<p>Alternatively, these can be printed via the function <code><a href="#topic+summary.PNAR">summary.PNAR</a></code>.
</p>


<h3>Author(s)</h3>

<p>Mirko Armillotta, Michail Tsagris and Konstantinos Fokianos.
</p>


<h3>References</h3>

<p>Armillotta, M. and K. Fokianos (2022a). Poisson network autoregression.
<a href="https://arxiv.org/abs/2104.06296">https://arxiv.org/abs/2104.06296</a>
</p>
<p>Armillotta, M., Tsagris, M. and Fokianos, K. (2022c). The R-package PNAR
for modelling count network time series.
<a href="https://arxiv.org/abs/2211.02582">https://arxiv.org/abs/2211.02582</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+log_lin_estimnarpq">log_lin_estimnarpq</a>
</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(crime)
data(crime_W)
mod1 &lt;- lin_estimnarpq(crime, crime_W, p = 2)
summary(mod1)
</code></pre>

<hr>
<h2 id='lin_ic_plot'>
Scatter plot of information criteria versus the number of lags in the linear Poisson NAR(p) model model with p lags and q
covariates (PNAR(p))
</h2><span id='topic+lin_ic_plot'></span>

<h3>Description</h3>

<p>Scatter plot of information criteria versus the number of lags in the linear Poisson Network Autoregressive model of order <code class="reqn">p</code> with <code class="reqn">q</code> covariates (PNAR(<code class="reqn">p</code>)).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lin_ic_plot(y, W, p = 1:10, Z = NULL, uncons = FALSE, ic = "QIC")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lin_ic_plot_+3A_y">y</code></td>
<td>

<p>A <code class="reqn">TT</code> x <code class="reqn">N</code> time series object or a <code class="reqn">TT</code> x <code class="reqn">N</code> numerical matrix with the <code class="reqn">N</code> multivariate
count time series over <code class="reqn">TT</code> time periods.
</p>
</td></tr>
<tr><td><code id="lin_ic_plot_+3A_w">W</code></td>
<td>

<p>The <code class="reqn">N</code> x <code class="reqn">N</code> row-normalized non-negative adjacency matrix describing
the network. The main diagonal entries of the matrix should be zeros, all the
other entries should be non-negative and the maximum sum of elements over the
rows should equal one. The function row-normalizes the matrix if a non-normalized
adjacency matrix is provided.
</p>
</td></tr>
<tr><td><code id="lin_ic_plot_+3A_p">p</code></td>
<td>

<p>A vector with integer numbers, the range of lags in the model, for which the AIC,
BIC and QIC will be computed.
</p>
</td></tr>
<tr><td><code id="lin_ic_plot_+3A_z">Z</code></td>
<td>

<p>An <code class="reqn">N</code> x <code class="reqn">q</code> matrix of covariates (one for each column), where <code class="reqn">q</code>
is the number of covariates in the model. Note that they must be non-negative.
</p>
</td></tr>
<tr><td><code id="lin_ic_plot_+3A_uncons">uncons</code></td>
<td>

<p>Logical, if TRUE an unconstrained optimization without stationarity
constraints is performed (default is FALSE).
</p>
</td></tr>
<tr><td><code id="lin_ic_plot_+3A_ic">ic</code></td>
<td>

<p>The information criterion you want to plot, &quot;QIC&quot; (default value), &quot;AIC&quot; or &quot;BIC&quot;.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function computes the AIC, BIC or QIC for a range of lag orders of the
linear Poisson Network Autoregressive model of order <code class="reqn">p</code> with <code class="reqn">q</code>
covariates (PNAR(<code class="reqn">p</code>)).
</p>


<h3>Value</h3>

<p>A scatter plot with the lag order versus either QIC (default), AIC or BIC, and a vector
with their values, for each lag order.
</p>


<h3>Author(s)</h3>

<p>Mirko Armillotta, Michail Tsagris and Konstantinos Fokianos.
</p>


<h3>References</h3>

<p>Armillotta, M. and K. Fokianos (2022). Poisson network autoregression.
<a href="https://arxiv.org/abs/2104.06296">https://arxiv.org/abs/2104.06296</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lin_estimnarpq">lin_estimnarpq</a>, <a href="#topic+log_lin_ic_plot">log_lin_ic_plot</a>
</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(crime)
data(crime_W)
lin_ic_plot(crime, crime_W, p = 1:3)
</code></pre>

<hr>
<h2 id='lin_narpq_init'>
Starting values for the linear Poisson NAR(p) model model with p lags and q
covariates (PNAR(p))
</h2><span id='topic+lin_narpq_init'></span>

<h3>Description</h3>

<p>Starting values for the linear Poisson Network Autoregressive model of order
<code class="reqn">p</code> with <code class="reqn">q</code> covariates (PNAR(<code class="reqn">p</code>)).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lin_narpq_init(y, W, p, Z = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lin_narpq_init_+3A_y">y</code></td>
<td>

<p>A <code class="reqn">TT</code> x <code class="reqn">N</code> time series object or a <code class="reqn">TT</code> x <code class="reqn">N</code> numerical matrix with the <code class="reqn">N</code> multivariate
count time series over <code class="reqn">TT</code> time periods.
</p>
</td></tr>
<tr><td><code id="lin_narpq_init_+3A_w">W</code></td>
<td>

<p>The <code class="reqn">N</code> x <code class="reqn">N</code> row-normalized non-negative adjacency matrix describing
the network. The main diagonal entries of the matrix should be zeros, all the
other entries should be non-negative and the maximum sum of elements over the
rows should equal one. The function row-normalizes the matrix if a non-normalized
adjacency matrix is provided.
</p>
</td></tr>
<tr><td><code id="lin_narpq_init_+3A_p">p</code></td>
<td>

<p>The number of lags in the model.
</p>
</td></tr>
<tr><td><code id="lin_narpq_init_+3A_z">Z</code></td>
<td>

<p>An <code class="reqn">N</code> x <code class="reqn">q</code> matrix of covariates (one for each column), where <code class="reqn">q</code>
is the number of covariates in the model. Note that they must be non-negative.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function computes starting values to be used in the function <code><a href="#topic+lin_estimnarpq">lin_estimnarpq</a></code>.
These are simply the ordinary least squares estimators with a correction.
If any of the the resulting coefficients is negative they become equal to 0.001
</p>


<h3>Value</h3>

<p>A vector with the initial values.
</p>


<h3>Author(s)</h3>

<p>Mirko Armillotta, Michail Tsagris and Konstantinos Fokianos.
</p>


<h3>References</h3>

<p>Armillotta, M. and K. Fokianos (2022). Poisson network autoregression.
<a href="https://arxiv.org/abs/2104.06296">https://arxiv.org/abs/2104.06296</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lin_estimnarpq">lin_estimnarpq</a>
</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(crime)
data(crime_W)
x0 &lt;- lin_narpq_init(crime, crime_W, p = 2)
</code></pre>

<hr>
<h2 id='log_lin_estimnarpq'>
Estimation of the log-linear Poisson NAR(p) model with p lags and q
covariates (log-PNAR(p))
</h2><span id='topic+log_lin_estimnarpq'></span>

<h3>Description</h3>

<p>Estimation of the log-linear Poisson Network Autoregressive model of order
<code class="reqn">p</code> with <code class="reqn">q</code> covariates (log-PNAR(<code class="reqn">p</code>)).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>log_lin_estimnarpq(y, W, p, Z = NULL, uncons = FALSE, init = NULL,
xtol_rel = 1e-8, maxeval = 100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="log_lin_estimnarpq_+3A_y">y</code></td>
<td>

<p>A <code class="reqn">TT</code> x <code class="reqn">N</code> time series object or a <code class="reqn">TT</code> x <code class="reqn">N</code> numerical matrix with the <code class="reqn">N</code> multivariate
count time series over <code class="reqn">TT</code> time periods.
</p>
</td></tr>
<tr><td><code id="log_lin_estimnarpq_+3A_w">W</code></td>
<td>

<p>The <code class="reqn">N</code> x <code class="reqn">N</code> row-normalized non-negative adjacency matrix describing
the network. The main diagonal entries of the matrix should be zeros, all the
other entries should be non-negative and the maximum sum of elements over the
rows should equal one. The function row-normalizes the matrix if a non-normalized
adjacency matrix is provided.
</p>
</td></tr>
<tr><td><code id="log_lin_estimnarpq_+3A_p">p</code></td>
<td>

<p>The number of lags in the model.
</p>
</td></tr>
<tr><td><code id="log_lin_estimnarpq_+3A_z">Z</code></td>
<td>

<p>An <code class="reqn">N</code> x <code class="reqn">q</code> matrix of covariates (one for each column), where <code class="reqn">q</code>
is the number of covariates in the model.
</p>
</td></tr>
<tr><td><code id="log_lin_estimnarpq_+3A_uncons">uncons</code></td>
<td>

<p>logical, if TRUE an unconstrained optimization is performed (default is FALSE).
</p>
</td></tr>
<tr><td><code id="log_lin_estimnarpq_+3A_init">init</code></td>
<td>

<p>A vector of starting values for the optimization algorithm. If this is NULL,
the function computes them internally.
</p>
</td></tr>
<tr><td><code id="log_lin_estimnarpq_+3A_xtol_rel">xtol_rel</code></td>
<td>

<p>The stopping tolerance of the optimization algorithm.
</p>
</td></tr>
<tr><td><code id="log_lin_estimnarpq_+3A_maxeval">maxeval</code></td>
<td>

<p>The maximum number of evalutions the optimization algorithm will perform.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function performs a constrained estimation of the linear Poisson NAR(<code class="reqn">p</code>) model with <code class="reqn">q</code> non-negative valued covariates, for each node of the network <code class="reqn">i=1,...,N</code> over the time sample <code class="reqn">t=1,...,TT</code>, defined as
</p>
<p style="text-align: center;"><code class="reqn">
\nu_{i,t}=\beta_{0}+\sum_{h=1}^{p}(\beta_{1h}X_{i,t-h}+\beta_{2h}Y_{i,t-h})+\sum_{l=1}^{q}\delta_{l}Z_{i,l},
</code>
</p>

<p>where <code class="reqn">X_{i,t}=\sum_{j=1}^{N}W_{ij}Y_{j,t}</code> is the network effect, i.e. the weighted average impact of node <code class="reqn">i</code> connections, with the weights of the mean being <code class="reqn">W_{ij}</code>, the single element of the network matrix <code class="reqn">W</code>. The sequence <code class="reqn">\nu_{i,t}</code> is the log of the expectation of <code class="reqn">Y_{i,t}</code>, conditional to its past values. The parameter <code class="reqn">\beta_{0}</code> is the intercept of the model, <code class="reqn">\beta_{1h}</code> are the network coefficients, <code class="reqn">\beta_{2h}</code> are the autoregressive parameters, and <code class="reqn">\delta_{l}</code> are the coefficients assocciated to the covariates <code class="reqn">Z_{i,l}</code>.
</p>
<p>The estimation of the parameters of the model is performed by Quasi Maximum Likelihood Estimation (QMLE), maximizing the following quasi log-likelihood
</p>
<p style="text-align: center;"><code class="reqn">
l(\theta)=\sum_{t=1}^{TT}\sum_{i=1}^{N}\left[Y_{i,t}\nu_{i,t}(\theta)-e^{\nu_{i,t}(\theta)}\right]
</code>
</p>

<p>with respect to the vector of unknown parameters <code class="reqn">\theta</code> described above.
</p>
<p>By default, the optimization is constrained in the stationary region where <code class="reqn">\sum_{h=1}^{p}(|\beta_{1h}|+|\beta_{2h}|)&lt;1</code>; this can be removed by setting <code>uncons = TRUE</code>. However, the model estimates might be inconsistent if the estimated parameters lie outside the stationary region.
</p>
<p>The ordinary least squares estimates are employed as starting values of the optimization procedure. Robust standard errors and z-tests are also returned.
</p>


<h3>Value</h3>

<p>A list with attribute class &quot;PNAR&quot; including:
</p>
<table>
<tr><td><code>coefs</code></td>
<td>

<p>A matrix with the estimated QMLE coefficients, their standard errors, their Z-test statistics and the relevant p-values computed via the standard normal approximation.
</p>
</td></tr>
<tr><td><code>score</code></td>
<td>

<p>The value of the quasi score function at the optimization point.
It should be close to 0 if the optimization is successful.
</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>

<p>The value of the maximized quasi log-likelihood.
</p>
</td></tr>
<tr><td><code>ic</code></td>
<td>

<p>A vector with the Akaike information criterion (AIC), the Bayesian information criterion (BIC) and the Quasi information criterion (QIC).
</p>
</td></tr>
</table>
<p>Alternatively, these can be printed via the function <code><a href="#topic+summary.PNAR">summary.PNAR</a></code>.
</p>


<h3>Author(s)</h3>

<p>Mirko Armillotta, Michail Tsagris and Konstantinos Fokianos.
</p>


<h3>References</h3>

<p>Armillotta, M. and K. Fokianos (2022a). Poisson network autoregression.
<a href="https://arxiv.org/abs/2104.06296">https://arxiv.org/abs/2104.06296</a>
</p>
<p>Armillotta, M., Tsagris, M. and Fokianos, K. (2022c). The R-package PNAR
for modelling count network time series.
<a href="https://arxiv.org/abs/2211.02582">https://arxiv.org/abs/2211.02582</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lin_estimnarpq">lin_estimnarpq</a>
</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(crime)
data(crime_W)
mod1 &lt;- log_lin_estimnarpq(crime, crime_W, p = 2)
summary(mod1)
</code></pre>

<hr>
<h2 id='log_lin_ic_plot'>
Scatter plot of information criteria versus the number of lags in the log-linear Poisson NAR(p) model with p lags and q
covariates (log-PNAR(p))
</h2><span id='topic+log_lin_ic_plot'></span>

<h3>Description</h3>

<p>Scatter plot of information criteria versus the number of lags in log-linear Poisson Network Autoregressive model of order
<code class="reqn">p</code> with <code class="reqn">q</code> covariates (log-PNAR(<code class="reqn">p</code>)).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>log_lin_ic_plot(y, W, p = 1:10, Z = NULL, uncons = FALSE, ic = "QIC")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="log_lin_ic_plot_+3A_y">y</code></td>
<td>

<p>A <code class="reqn">TT</code> x <code class="reqn">N</code> time series object or a <code class="reqn">TT</code> x <code class="reqn">N</code> numerical matrix with the <code class="reqn">N</code> multivariate
count time series over <code class="reqn">TT</code> time periods.
</p>
</td></tr>
<tr><td><code id="log_lin_ic_plot_+3A_w">W</code></td>
<td>

<p>The <code class="reqn">N</code> x <code class="reqn">N</code> row-normalized non-negative adjacency matrix describing
the network. The main diagonal entries of the matrix should be zeros, all the
other entries should be non-negative and the maximum sum of elements over the
rows should equal one. The function row-normalizes the matrix if a non-normalized
adjacency matrix is provided.
</p>
</td></tr>
<tr><td><code id="log_lin_ic_plot_+3A_p">p</code></td>
<td>

<p>A vector with integer numbers, the range of lags in the model, for which the AIC,
BIC and QIC will be computed.
</p>
</td></tr>
<tr><td><code id="log_lin_ic_plot_+3A_z">Z</code></td>
<td>

<p>An <code class="reqn">N</code> x <code class="reqn">q</code> matrix of covariates (one for each column), where <code class="reqn">q</code>
is the number of covariates in the model. Note that they must be non-negative.
</p>
</td></tr>
<tr><td><code id="log_lin_ic_plot_+3A_uncons">uncons</code></td>
<td>

<p>Logical, if TRUE an unconstrained optimization without stationarity
constraints is performed (default is FALSE).
</p>
</td></tr>
<tr><td><code id="log_lin_ic_plot_+3A_ic">ic</code></td>
<td>

<p>The information criterion you want to plot, &quot;QIC&quot; (default value), &quot;AIC&quot; or &quot;BIC&quot;.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function computes the AIC, BIC or QIC for a range of lag orders of the
log-linear Poisson Network Autoregressive model of order <code class="reqn">p</code> with <code class="reqn">q</code>
covariates (PNAR(<code class="reqn">p</code>)).
</p>


<h3>Value</h3>

<p>A scatter plot with the lag order versus either QIC (default), AIC or BIC, and a vector
with their values, for each lag order.
</p>


<h3>Author(s)</h3>

<p>Mirko Armillotta, Michail Tsagris and Konstantinos Fokianos.
</p>


<h3>References</h3>

<p>Armillotta, M. and K. Fokianos (2022). Poisson network autoregression.
<a href="https://arxiv.org/abs/2104.06296">https://arxiv.org/abs/2104.06296</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+log_lin_estimnarpq">log_lin_estimnarpq</a>, <a href="#topic+lin_ic_plot">lin_ic_plot</a>
</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(crime)
data(crime_W)
log_lin_ic_plot(crime, crime_W, p = 1:3)
</code></pre>

<hr>
<h2 id='log_lin_narpq_init'>
Starting values for the log-linear Poisson NAR(p) model with p lags and q
covariates (log-PNAR(p))
</h2><span id='topic+log_lin_narpq_init'></span>

<h3>Description</h3>

<p>Starting values for the log-linear Poisson Network Autoregressive model of order
<code class="reqn">p</code> with <code class="reqn">q</code> covariates (log-PNAR(<code class="reqn">p</code>)).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>log_lin_narpq_init(y, W, p, Z = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="log_lin_narpq_init_+3A_y">y</code></td>
<td>

<p>A <code class="reqn">TT</code> x <code class="reqn">N</code> time series object or a <code class="reqn">TT</code> x <code class="reqn">N</code> numerical matrix with the <code class="reqn">N</code> multivariate
count time series over <code class="reqn">TT</code> time periods.
</p>
</td></tr>
<tr><td><code id="log_lin_narpq_init_+3A_w">W</code></td>
<td>

<p>The <code class="reqn">N</code> x <code class="reqn">N</code> row-normalized non-negative adjacency matrix describing
the network. The main diagonal entries of the matrix should be zeros, all the
other entries should be non-negative and the maximum sum of elements over the
rows should equal one. The function row-normalizes the matrix if a non-normalized
adjacency matrix is provided.
</p>
</td></tr>
<tr><td><code id="log_lin_narpq_init_+3A_p">p</code></td>
<td>

<p>The number of lags in the model.
</p>
</td></tr>
<tr><td><code id="log_lin_narpq_init_+3A_z">Z</code></td>
<td>

<p>An <code class="reqn">N</code> x <code class="reqn">q</code> matrix of covariates (one for each column), where <code class="reqn">q</code>
is the number of covariates in the model.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes initial values for the log-linear Poisson Network
Autoregressive model of order <code class="reqn">p</code> with <code class="reqn">q</code> covariates (log-PNAR(<code class="reqn">p</code>))
with stationarity conditions. These initial values are simply the ordinary least
squares estimators with a correction.
</p>


<h3>Value</h3>

<p>A vector with the initial values.
</p>


<h3>Author(s)</h3>

<p>Mirko Armillotta, Michail Tsagris and Konstantinos Fokianos.
</p>


<h3>References</h3>

<p>Armillotta, M. and K. Fokianos (2022). Poisson network autoregression.
<a href="https://arxiv.org/abs/2104.06296">https://arxiv.org/abs/2104.06296</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+log_lin_estimnarpq">log_lin_estimnarpq</a>
</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(crime)
data(crime_W)
mod1 &lt;- log_lin_narpq_init(crime, crime_W, p = 2)
</code></pre>

<hr>
<h2 id='poisson.MODpq'>
Generation of counts from a linear Poisson NAR(p) model with
q covariates (PNAR(p))
</h2><span id='topic+poisson.MODpq'></span>

<h3>Description</h3>

<p>Generation of multivariate count time series from a linear Poisson Network Autoregressive
model of order <code class="reqn">p</code> with <code class="reqn">q</code> covariates (PNAR(<code class="reqn">p</code>)).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>poisson.MODpq(b, W, p, Z = NULL, TT, N, copula = "gaussian",
corrtype = "equicorrelation", rho, dof = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="poisson.MODpq_+3A_b">b</code></td>
<td>

<p>The coefficients of the model, in the following order: (intercept, network
parameters, autoregressive parameters, covariates). The dimension of the vector
should be <code class="reqn">2p + 1 + q</code>, where <code class="reqn">q</code> denotes the number of covariates.
</p>
</td></tr>
<tr><td><code id="poisson.MODpq_+3A_w">W</code></td>
<td>

<p>The <code class="reqn">N \times N</code> row-normalized non-negative adjacency matrix describing
the network. The main diagonal entries of the matrix should be zeros, all the
other entries should be non-negative and the maximum sum of elements over the
rows should equal one. The function row-normalizes the matrix if a non-normalized
adjacency matrix is provided.
</p>
</td></tr>
<tr><td><code id="poisson.MODpq_+3A_p">p</code></td>
<td>

<p>The number of lags in the model.
</p>
</td></tr>
<tr><td><code id="poisson.MODpq_+3A_z">Z</code></td>
<td>

<p>An <code class="reqn">N \times q</code> matrix of covariates (one for each column),
where <code class="reqn">q</code> is the number of covariates in the model.
Note that they must be non-negative.
</p>
</td></tr>
<tr><td><code id="poisson.MODpq_+3A_tt">TT</code></td>
<td>

<p>The temporal sample size.
</p>
</td></tr>
<tr><td><code id="poisson.MODpq_+3A_n">N</code></td>
<td>

<p>The number of nodes on the network.
</p>
</td></tr>
<tr><td><code id="poisson.MODpq_+3A_copula">copula</code></td>
<td>

<p>Which copula function to use? The choices are &quot;gaussian&quot;, &quot;t&quot;, or &quot;clayton&quot;.
</p>
</td></tr>
<tr><td><code id="poisson.MODpq_+3A_rho">rho</code></td>
<td>

<p>The value of the copula parameter (<code class="reqn">\rho</code>). A scalar in <code class="reqn">[-1,1]</code> for
elliptical copulas (Gaussian, t), a value greater than or equal to -1 for Clayton
copula.
</p>
</td></tr>
<tr><td><code id="poisson.MODpq_+3A_corrtype">corrtype</code></td>
<td>

<p>Used only for elliptical copulas. The type of correlation matrix employed for
the copula; it will either be the &quot;equicorrelation&quot; or &quot;toeplitz&quot;. The
&quot;equicorrelation&quot; option generates a correlation matrix where all the off-diagonal
entries equal <code class="reqn">\rho</code>. The &quot;toeplitz&quot; option generates a correlation matrix
whose generic off-diagonal <code class="reqn">(i,j)</code>-element is <code class="reqn">\rho^{|i-j|}</code>.
</p>
</td></tr>
<tr><td><code id="poisson.MODpq_+3A_dof">dof</code></td>
<td>

<p>The degrees of freedom for Student's t copula.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function generates counts from a linear Poisson NAR(<code class="reqn">p</code>) model, where <code class="reqn">q</code> non time-varying
covariates are allowed as well. The counts are simulated from <code class="reqn">Y_{t}=N_{t}(\lambda_{t})</code>, where
<code class="reqn">N_{t}</code> is a sequence of <code class="reqn">N</code>-dimensional IID Poisson count processes, with intensity 1, and
whose structure of dependence is modelled through a copula construction <code class="reqn">C(\rho)</code> on their associated exponential waiting times random variables. For details see Armillotta and Fokianos (2022, Sec. 2.1-2.2).
</p>
<p>The sequence <code class="reqn">\lambda_{i,t}</code> is the expectation of <code class="reqn">Y_{i,t}</code>, conditional to its past values and it is generated by means of the following PNAR(<code class="reqn">p</code>) model. For each node of the network <code class="reqn">i=1,...,N</code> over the time sample <code class="reqn">t=1,...,TT</code>
</p>
<p style="text-align: center;"><code class="reqn">
\lambda_{i,t}=\beta_{0}+\sum_{h=1}^{p}(\beta_{1h}X_{i,t-h}+\beta_{2h}Y_{i,t-h})+\sum_{l=1}^{q}\delta_{l}Z_{i,l}
</code>
</p>

<p>where <code class="reqn">X_{i,t}=\sum_{j=1}^{N}W_{ij}Y_{j,t}</code> is the network effect, i.e. the weighted average impact of node <code class="reqn">i</code> connections, with the weights of the mean being <code class="reqn">W_{ij}</code>, the single element of the network matrix <code class="reqn">W</code>. The parameter <code class="reqn">\beta_{0}</code> is the intercept of the model, <code class="reqn">\beta_{1h}</code> are the network coefficients, <code class="reqn">\beta_{2h}</code> are the autoregressive parameters, and <code class="reqn">\delta_{l}</code> are the coefficients assocciated to the covariates <code class="reqn">Z_{i,l}</code>.
</p>


<h3>Value</h3>

<p>A list including:
</p>
<table>
<tr><td><code>p2R</code></td>
<td>

<p>The Toeplitz correlation matrix, if employed in the copula or NULL else.
</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>

<p>A <code class="reqn">TT \times N</code> time series object matrix of simulated Poisson means for <code class="reqn">N</code> time
series over <code class="reqn">TT</code>.
</p>
</td></tr>
<tr><td><code>y</code></td>
<td>

<p>A <code class="reqn">TT \times N</code> time series object matrix of simulated counts for <code class="reqn">N</code> time series
over <code class="reqn">TT</code>.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mirko Armillotta, Michail Tsagris and Konstantinos Fokianos.
</p>


<h3>References</h3>

<p>Armillotta, M. and K. Fokianos (2022). Poisson network autoregression.
<a href="https://arxiv.org/abs/2104.06296">https://arxiv.org/abs/2104.06296</a>
</p>
<p>Fokianos, K., Stove, B., Tjostheim, D., and P. Doukhan (2020).
Multivariate count autoregression. Bernoulli, 26(1), 471-499.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+poisson.MODpq.log">poisson.MODpq.log</a>, <a href="#topic+poisson.MODpq.nonlin">poisson.MODpq.nonlin</a>,
<a href="#topic+poisson.MODpq.stnar">poisson.MODpq.stnar</a>, <a href="#topic+poisson.MODpq.tnar">poisson.MODpq.tnar</a>
</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>W &lt;- adja( N = 20, K = 5, alpha= 0.5)
y &lt;- poisson.MODpq( b = c(0.5, 0.3, 0.2), W = W, p = 1, Z = NULL,
TT = 1000, N = 20, copula = "gaussian",
corrtype = "equicorrelation", rho = 0.5)$y
</code></pre>

<hr>
<h2 id='poisson.MODpq.log'>
Generation of multivariate count time series from a log-linear Poisson NAR(p) model with q covariates
(log-PNAR(p))
</h2><span id='topic+poisson.MODpq.log'></span>

<h3>Description</h3>

<p>Generation of counts from a log-linear Poisson Network Autoregressive model of
order <code class="reqn">p</code> with <code class="reqn">q</code> covariates (log-PNAR(<code class="reqn">p</code>)).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>poisson.MODpq.log(b, W, p, Z = NULL, TT, N, copula = "gaussian",
corrtype = "equicorrelation", rho, dof = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="poisson.MODpq.log_+3A_b">b</code></td>
<td>

<p>The coefficients of the model, in the following order: (intercept, network
parameters, autoregressive parameters, covariates). The dimension of the vector
should be <code class="reqn">2p + 1 + q</code>, where <code class="reqn">q</code> denotes the number of covariates.
</p>
</td></tr>
<tr><td><code id="poisson.MODpq.log_+3A_w">W</code></td>
<td>

<p>The <code class="reqn">N \times N</code> row-normalized non-negative adjacency matrix describing
the network. The main diagonal entries of the matrix should be zeros, all the
other entries should be non-negative and the maximum sum of elements over the
rows should equal one.The function row-normalizes the matrix if a non-normalized
adjacency matrix is provided.
</p>
</td></tr>
<tr><td><code id="poisson.MODpq.log_+3A_p">p</code></td>
<td>

<p>The number of lags in the model.
</p>
</td></tr>
<tr><td><code id="poisson.MODpq.log_+3A_z">Z</code></td>
<td>

<p>An <code class="reqn">N \times q</code> matrix of covariates (one for each column),
where <code class="reqn">q</code> is the number of covariates in the model.
</p>
</td></tr>
<tr><td><code id="poisson.MODpq.log_+3A_tt">TT</code></td>
<td>

<p>The temporal sample size.
</p>
</td></tr>
<tr><td><code id="poisson.MODpq.log_+3A_n">N</code></td>
<td>

<p>The number of nodes on the network.
</p>
</td></tr>
<tr><td><code id="poisson.MODpq.log_+3A_copula">copula</code></td>
<td>

<p>Which copula function to use? The &quot;gaussian&quot;, &quot;t&quot;, or &quot;clayton&quot;.
</p>
</td></tr>
<tr><td><code id="poisson.MODpq.log_+3A_rho">rho</code></td>
<td>

<p>The the value of the copula parameter (<code class="reqn">\rho</code>). A scalar in <code class="reqn">[-1,1]</code>
for elliptical copulas (Gaussian, t), a value greater or equal to -1 for
Clayton copula.
</p>
</td></tr>
<tr><td><code id="poisson.MODpq.log_+3A_corrtype">corrtype</code></td>
<td>

<p>Used only for elliptical copulas. The type of correlation matrix employed for
the copula; it will either be the &quot;equicorrelation&quot; or &quot;toeplitz&quot;. The
&quot;equicorrelation&quot; option generates a correlation matrix where all the off-diagonal
entries equal <code class="reqn">\rho</code>. The &quot;toeplitz&quot; option generates a correlation matrix
whose generic off-diagonal <code class="reqn">(i,j)</code>-element is <code class="reqn">\rho^{|i-j|}</code>.
</p>
</td></tr>
<tr><td><code id="poisson.MODpq.log_+3A_dof">dof</code></td>
<td>

<p>The degrees of freedom for Student's t copula.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function generates counts from a log-linear Poisson NAR(<code class="reqn">p</code>) model, where <code class="reqn">q</code> non time-varying covariates are allowed as well. The counts are simulated from <code class="reqn">Y_{t}=N_{t}(e^{\nu_{t}})</code>, where <code class="reqn">N_{t}</code> is a sequence of <code class="reqn">N</code>-dimensional IID Poisson count processes, with intensity 1, and whose structure of dependence is modelled through a copula construction <code class="reqn">C(\rho)</code> on their associated exponential waiting times random variables. For details see Armillotta and Fokianos (2022, Sec. 2.1-2.2).
</p>
<p>The sequence <code class="reqn">\nu_{t}</code> is the log of the expecation of <code class="reqn">Y_{t}</code>, conditional to its past values and it is generated by means of the following log-PNAR(<code class="reqn">p</code>) model. For each node of the network <code class="reqn">i=1,...,N</code> over the time sample <code class="reqn">t=1,...,TT</code>
</p>
<p style="text-align: center;"><code class="reqn">
\nu_{i,t}=\beta_{0}+\sum_{h=1}^{p}(\beta_{1h}X_{i,t-h}+\beta_{2h}Y_{i,t-h})+\sum_{l=1}^{q}\delta_{l}Z_{i,l}
</code>
</p>

<p>where <code class="reqn">X_{i,t}=\sum_{j=1}^{N}W_{ij}Y_{j,t}</code> is the network effect, i.e. the weighted average impact of node <code class="reqn">i</code> connections, with the weights of the mean being <code class="reqn">W_{ij}</code>, the single element of the network matrix <code class="reqn">W</code>. The parameter <code class="reqn">\beta_{0}</code> is the intercept of the model, <code class="reqn">\beta_{1h}</code> are the network coefficients, <code class="reqn">\beta_{2h}</code> are the autoregressive parameters, and <code class="reqn">\delta_{l}</code> are the coefficients assocciated to the covariates <code class="reqn">Z_{i,l}</code>.
</p>


<h3>Value</h3>

<p>A list including:
</p>
<table>
<tr><td><code>p2R</code></td>
<td>

<p>The Toeplitz correlation matrix, if employed in the copula or NULL else.
</p>
</td></tr>
<tr><td><code>log_lambda</code></td>
<td>

<p>A <code class="reqn">TT \times N</code> time series object matrix of simulated Poisson log-means for <code class="reqn">N</code>
time series over <code class="reqn">TT</code>.
</p>
</td></tr>
<tr><td><code>y</code></td>
<td>

<p>A <code class="reqn">TT \times N</code> time series object matrix of simulated counts for <code class="reqn">N</code> time series
over <code class="reqn">TT</code>.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mirko Armillotta, Michail Tsagris and Konstantinos Fokianos.
</p>


<h3>References</h3>

<p>Armillotta, M. and K. Fokianos (2022). Poisson network autoregression.
<a href="https://arxiv.org/abs/2104.06296">https://arxiv.org/abs/2104.06296</a>
</p>
<p>Fokianos, K., Stove, B., Tjostheim, D., and P. Doukhan (2020).
Multivariate count autoregression. Bernoulli, 26(1), 471-499.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+poisson.MODpq">poisson.MODpq</a>, <a href="#topic+poisson.MODpq.nonlin">poisson.MODpq.nonlin</a>,
<a href="#topic+poisson.MODpq.stnar">poisson.MODpq.stnar</a>, <a href="#topic+poisson.MODpq.tnar">poisson.MODpq.tnar</a>
</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>W &lt;- adja( N = 20, K = 5, alpha= 0.5)
y &lt;- poisson.MODpq.log( b = c(0.5, 0.3, 0.2), W = W, p = 1,
Z = NULL, TT = 1000, N = 20, copula = "gaussian",
corrtype = "equicorrelation", rho = 0.5)$y
</code></pre>

<hr>
<h2 id='poisson.MODpq.nonlin'>
Generation of multivariate count time series from a non-linear Intercept Drift Poisson NAR(p)
model with q covariates (ID-PNAR(p))
</h2><span id='topic+poisson.MODpq.nonlin'></span>

<h3>Description</h3>

<p>Generation of counts from a non-linear Intercept Drift Poisson Network
Autoregressive model of order <code class="reqn">p</code> with <code class="reqn">q</code> covariates (ID-PNAR(<code class="reqn">p</code>)).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>poisson.MODpq.nonlin(b, W, gama, p, d, Z = NULL, TT, N, copula = "gaussian",
corrtype = "equicorrelation", rho, dof = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="poisson.MODpq.nonlin_+3A_b">b</code></td>
<td>

<p>The linear coefficients of the model, in the following order: (intercept,
network parameters, autoregressive parameters, covariates). The dimension of
the vector should be <code class="reqn">2p + 1 + q</code>, where <code class="reqn">q</code> denotes the number of covariates.
</p>
</td></tr>
<tr><td><code id="poisson.MODpq.nonlin_+3A_w">W</code></td>
<td>

<p>The <code class="reqn">N \times N</code> row-normalized non-negative adjacency matrix describing
the network. The main diagonal entries of the matrix should be zeros, all the
other entries should be non-negative and the maximum sum of elements over the
rows should equal one. The function row-normalizes the matrix if a non-normalized
adjacency matrix is provided.
</p>
</td></tr>
<tr><td><code id="poisson.MODpq.nonlin_+3A_gama">gama</code></td>
<td>

<p>A scalar non-linear intercept drift parameter.
</p>
</td></tr>
<tr><td><code id="poisson.MODpq.nonlin_+3A_p">p</code></td>
<td>

<p>The number of lags in the model.
</p>
</td></tr>
<tr><td><code id="poisson.MODpq.nonlin_+3A_d">d</code></td>
<td>

<p>The lag parameter of non-linear variable (should be between 1 and <code class="reqn">p</code>).
</p>
</td></tr>
<tr><td><code id="poisson.MODpq.nonlin_+3A_z">Z</code></td>
<td>

<p>An <code class="reqn">N \times q</code> matrix of covariates (one for each column),
where <code class="reqn">q</code> is the number of covariates in the model.
Note that they must be non-negative.
</p>
</td></tr>
<tr><td><code id="poisson.MODpq.nonlin_+3A_tt">TT</code></td>
<td>

<p>The temporal sample size.
</p>
</td></tr>
<tr><td><code id="poisson.MODpq.nonlin_+3A_n">N</code></td>
<td>

<p>The number of nodes on the network.
</p>
</td></tr>
<tr><td><code id="poisson.MODpq.nonlin_+3A_copula">copula</code></td>
<td>

<p>Which copula function to use? The &quot;gaussian&quot;, &quot;t&quot;, or &quot;clayton&quot;.
</p>
</td></tr>
<tr><td><code id="poisson.MODpq.nonlin_+3A_rho">rho</code></td>
<td>

<p>The value of the copula parameter (<code class="reqn">\rho</code>). A scalar in <code class="reqn">[-1,1]</code> for
elliptical copulas (Gaussian, t), a value greater than or equal to -1 for
Clayton copula.
</p>
</td></tr>
<tr><td><code id="poisson.MODpq.nonlin_+3A_corrtype">corrtype</code></td>
<td>

<p>Used only for elliptical copulas. The type of correlation matrix employed for
the copula; it will either be the &quot;equicorrelation&quot; or &quot;toeplitz&quot;. The
&quot;equicorrelation&quot; option generates a correlation matrix where all the off-diagonal
entries equal <code class="reqn">\rho</code>. The &quot;toeplitz&quot; option generates a correlation matrix
whose generic off-diagonal <code class="reqn">(i,j)</code>-element is <code class="reqn">\rho^{|i-j|}</code>.
</p>
</td></tr>
<tr><td><code id="poisson.MODpq.nonlin_+3A_dof">dof</code></td>
<td>

<p>The degrees of freedom for Student's t copula.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function generates counts from a non-linear Intercept Drift Poisson NAR(<code class="reqn">p</code>) model, where <code class="reqn">q</code> non time-varying covariates are allowed as well. The counts are simulated from <code class="reqn">Y_{t}=N_{t}(\lambda_{t})</code>, where <code class="reqn">N_{t}</code> is a sequence of <code class="reqn">N</code>-dimensional IID Poisson count processes, with intensity 1, and whose structure of dependence is modelled through a copula construction <code class="reqn">C(\rho)</code> on their associated exponential waiting times random variables. For details see Armillotta and Fokianos (2022a, Sec. 2.1-2.2). The sequence <code class="reqn">\lambda_{i,t}</code> is the expecation of <code class="reqn">Y_{i,t}</code>, conditional to its past values and it is generated by means of the following ID-PNAR(<code class="reqn">p</code>) model. For each node of the network <code class="reqn">i=1,...,N</code> over the time sample <code class="reqn">t=1,...,TT</code>
</p>
<p style="text-align: center;"><code class="reqn">
\lambda_{i,t}=\frac{\beta_{0}}{(1+X_{i,t-d})^{\gamma}}+\sum_{h=1}^{p}(\beta_{1h}X_{i,t-h}+\beta_{2h}Y_{i,t-h})+\sum_{l=1}^{q}\delta_{l}Z_{i,l}
</code>
</p>

<p>where <code class="reqn">X_{i,t}=\sum_{j=1}^{N}W_{ij}Y_{j,t}</code> is the network effect, i.e. the weighted average impact of node <code class="reqn">i</code> connections, with the weights of the mean being <code class="reqn">W_{ij}</code>, the single element of the network matrix <code class="reqn">W</code>.
</p>
<p>The parameter <code class="reqn">\beta_{0}</code> is the intercept of the model, <code class="reqn">\beta_{1h}</code> are the network coefficients, <code class="reqn">\beta_{2h}</code> are the autoregressive parameters, <code class="reqn">\gamma</code> is the non-linear coefficient associated with the intercept drift, and <code class="reqn">\delta_{l}</code> are the coefficients assocciated with the covariates <code class="reqn">Z_{i,l}</code>. The coefficient <code class="reqn">d</code> is considered as an extra parameter defining the lag of the network effect in the non-linear part of the model and is left to be set by the user. For details on ID-PNAR models see Armillotta and Fokianos (2022b, Sec. 2).
</p>


<h3>Value</h3>

<p>A list including:
</p>
<table>
<tr><td><code>p2R</code></td>
<td>

<p>The Toeplitz correlation matrix, if employed in the copula or NULL else.
</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>

<p>A <code class="reqn">TT \times N</code> time series object matrix of simulated Poisson means for <code class="reqn">N</code> time
series over <code class="reqn">TT</code>.
</p>
</td></tr>
<tr><td><code>y</code></td>
<td>

<p>A <code class="reqn">TT \times N</code> time series object matrix of simulated counts for <code class="reqn">N</code> time series
over <code class="reqn">TT</code>.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mirko Armillotta, Michail Tsagris and Konstantinos Fokianos.
</p>


<h3>References</h3>

<p>Armillotta, M. and K. Fokianos (2022a). Poisson network autoregression.
<a href="https://arxiv.org/abs/2104.06296">https://arxiv.org/abs/2104.06296</a>
</p>
<p>Armillotta, M. and K. Fokianos (2022b). Testing linearity for network
autoregressive models.
<a href="https://arxiv.org/abs/2202.03852">https://arxiv.org/abs/2202.03852</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+poisson.MODpq">poisson.MODpq</a>, <a href="#topic+poisson.MODpq.log">poisson.MODpq.log</a>,
<a href="#topic+poisson.MODpq.stnar">poisson.MODpq.stnar</a>, <a href="#topic+poisson.MODpq.tnar">poisson.MODpq.tnar</a>
</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>W &lt;- adja( N = 20, K = 5, alpha= 0.5)
y &lt;- poisson.MODpq.nonlin( b = c(0.5, 0.3, 0.2), W = W, gama = 1, p = 1,
d = 1, Z = NULL, TT = 1000, N = 20, copula = "gaussian",
corrtype = "equicorrelation", rho = 0.5)$y
</code></pre>

<hr>
<h2 id='poisson.MODpq.stnar'>
Generation of counts from a non-linear Smooth Transition Poisson NAR(p)
model with q covariates (ST-PNAR(p))
</h2><span id='topic+poisson.MODpq.stnar'></span>

<h3>Description</h3>

<p>Generation of multivariate count time series from a non-linear Smooth Transition Poisson Network
Autoregressive model of order <code class="reqn">p</code> with <code class="reqn">q</code> covariates (ST-PNAR(<code class="reqn">p</code>)).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>poisson.MODpq.stnar(b, W, gama, a, p, d, Z = NULL, TT, N, copula = "gaussian",
corrtype = "equicorrelation", rho, dof = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="poisson.MODpq.stnar_+3A_b">b</code></td>
<td>

<p>The linear coefficients of the model, in the following order: (intercept, network
parameters, autoregressive parameters, covariates). The dimension of the vector
should be <code class="reqn">2p + 1 + q</code>, where <code class="reqn">q</code> denotes the number of covariates.
</p>
</td></tr>
<tr><td><code id="poisson.MODpq.stnar_+3A_w">W</code></td>
<td>

<p>The <code class="reqn">N \times N</code> row-normalized non-negative adjacency matrix describing
the network. The main diagonal entries of the matrix should be zeros, all the
other entries should be non-negative and the maximum sum of elements over the
rows should equal one. The function row-normalizes the matrix if a non-normalized
adjacency matrix is provided.
</p>
</td></tr>
<tr><td><code id="poisson.MODpq.stnar_+3A_gama">gama</code></td>
<td>

<p>The scalar nuisance smoothing parameter.
</p>
</td></tr>
<tr><td><code id="poisson.MODpq.stnar_+3A_a">a</code></td>
<td>

<p>Vector of non-linear parameters. The dimension of the vector should be <code class="reqn">p</code>.
</p>
</td></tr>
<tr><td><code id="poisson.MODpq.stnar_+3A_p">p</code></td>
<td>

<p>The number of lags in the model.
</p>
</td></tr>
<tr><td><code id="poisson.MODpq.stnar_+3A_d">d</code></td>
<td>

<p>The lag parameter of non-linear variable (should be between 1 and <code class="reqn">p</code>).
</p>
</td></tr>
<tr><td><code id="poisson.MODpq.stnar_+3A_z">Z</code></td>
<td>

<p>An <code class="reqn">N \times q</code> matrix of covariates (one for each column),
where <code class="reqn">q</code> is the number of covariates in the model.
Note that they must be non-negative.
</p>
</td></tr>
<tr><td><code id="poisson.MODpq.stnar_+3A_tt">TT</code></td>
<td>

<p>The temporal sample size.
</p>
</td></tr>
<tr><td><code id="poisson.MODpq.stnar_+3A_n">N</code></td>
<td>

<p>The number of nodes on the network.
</p>
</td></tr>
<tr><td><code id="poisson.MODpq.stnar_+3A_copula">copula</code></td>
<td>

<p>Which copula function to use? The choices are &quot;gaussian&quot;, &quot;t&quot;, or &quot;clayton&quot;.
</p>
</td></tr>
<tr><td><code id="poisson.MODpq.stnar_+3A_rho">rho</code></td>
<td>

<p>The value of the copula parameter (<code class="reqn">\rho</code>). A scalar in <code class="reqn">[-1,1]</code> for
elliptical copulas (Gaussian, t), a value greater than or equal to -1 for Clayton
copula.
</p>
</td></tr>
<tr><td><code id="poisson.MODpq.stnar_+3A_corrtype">corrtype</code></td>
<td>

<p>Used only for elliptical copulas. The type of correlation matrix employed for
the copula; it will either be the &quot;equicorrelation&quot; or &quot;toeplitz&quot;. The
&quot;equicorrelation&quot; option generates a correlation matrix where all the off-diagonal
entries equal <code class="reqn">\rho</code>. The &quot;toeplitz&quot; option generates a correlation matrix
whose generic off-diagonal <code class="reqn">(i,j)</code>-element is <code class="reqn">\rho^{|i-j|}</code>.
</p>
</td></tr>
<tr><td><code id="poisson.MODpq.stnar_+3A_dof">dof</code></td>
<td>

<p>The degrees of freedom for Student's t copula.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function generates counts from a non-linear Smooth Transition Poisson NAR(<code class="reqn">p</code>) model, where
<code class="reqn">q</code> non time-varying covariates are allowed as well. The counts are simulated from <code class="reqn">Y_{t}=N_{t}(\lambda_{t})</code>, where <code class="reqn">N_{t}</code> is a sequence of <code class="reqn">N</code>-dimensional IID Poisson count processes, with intensity 1, and whose structure of dependence is modelled through a copula construction <code class="reqn">C(\rho)</code> on their associated exponential waiting times random variables. For details see Armillotta and Fokianos (2022a, Sec. 2.1-2.2).
</p>
<p>The sequence <code class="reqn">\lambda_{i,t}</code> is the expecation of <code class="reqn">Y_{i,t}</code>, conditional to its past values and it is generated by means of the following ST-PNAR(<code class="reqn">p</code>) model. For each node of the network <code class="reqn">i=1,...,N</code> over the time sample <code class="reqn">t=1,...,TT</code>
</p>
<p style="text-align: center;"><code class="reqn">
\lambda_{i,t}=\beta_{0}+\sum_{h=1}^{p}(\beta_{1h}X_{i,t-h}+\beta_{2h}Y_{i,t-h}+\alpha_{h}e^{-\gamma X_{i,t-d}^{2}}X_{i,t-h})+\sum_{l=1}^{q}\delta_{l}Z_{i,l}
</code>
</p>

<p>where <code class="reqn">X_{i,t}=\sum_{j=1}^{N}W_{ij}Y_{j,t}</code> is the network effect, i.e. the weighted average impact of node <code class="reqn">i</code> connections, with the weights of the mean being <code class="reqn">W_{ij}</code>, the single element of the network matrix <code class="reqn">W</code>.
</p>
<p>The parameter <code class="reqn">\beta_{0}</code> is the intercept of the model, <code class="reqn">\beta_{1h}</code> are the network coefficients, <code class="reqn">\beta_{2h}</code> are the autoregressive parameters, <code class="reqn">\alpha_{h}</code> are the non-linear smooth transition parameters, <code class="reqn">\gamma</code> is the nuisance smoothing parameter, and <code class="reqn">\delta_{l}</code> are the coefficients assocciated to the covariates <code class="reqn">Z_{i,l}</code>. The coefficient <code class="reqn">d</code> is considered as an extra parameter defining the lag of the network effect in the non-linear part of the model and is left to be set by the user. For details on ST-PNAR models see Armillotta and Fokianos (2022b, Sec. 2).
</p>


<h3>Value</h3>

<p>A list including:
</p>
<table>
<tr><td><code>p2R</code></td>
<td>

<p>The Toeplitz correlation matrix, if employed in the copula or NULL else.
</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>

<p>A <code class="reqn">TT \times N</code> time series object matrix of simulated Poisson means for <code class="reqn">N</code> time
series over <code class="reqn">TT</code>.
</p>
</td></tr>
<tr><td><code>y</code></td>
<td>

<p>A <code class="reqn">TT \times N</code> time series object matrix of simulated counts for <code class="reqn">N</code> time series
over <code class="reqn">TT</code>.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mirko Armillotta, Michail Tsagris and Konstantinos Fokianos.
</p>


<h3>References</h3>

<p>Armillotta, M. and K. Fokianos (2022a). Poisson network autoregression.
<a href="https://arxiv.org/abs/2104.06296">https://arxiv.org/abs/2104.06296</a>
</p>
<p>Armillotta, M. and K. Fokianos (2022b). Testing linearity for network
autoregressive models.
<a href="https://arxiv.org/abs/2202.03852">https://arxiv.org/abs/2202.03852</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+poisson.MODpq">poisson.MODpq</a>, <a href="#topic+poisson.MODpq.log">poisson.MODpq.log</a>,
<a href="#topic+poisson.MODpq.nonlin">poisson.MODpq.nonlin</a>, <a href="#topic+poisson.MODpq.tnar">poisson.MODpq.tnar</a>
</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>W &lt;- adja( N = 20, K = 5, alpha= 0.5)
y &lt;- poisson.MODpq.stnar( b = c(0.5, 0.3, 0.2), W = W, gama = 0.2, a = 0.4,
p = 1, d = 1, Z = NULL, TT = 1000, N = 20, copula = "gaussian",
corrtype = "equicorrelation", rho = 0.5)$y
</code></pre>

<hr>
<h2 id='poisson.MODpq.tnar'>
Generation of counts from a non-linear Threshold Poisson NAR(p)
model with q covariates (T-PNAR(p))
</h2><span id='topic+poisson.MODpq.tnar'></span>

<h3>Description</h3>

<p>Generation of multivariate count time series from a non-linear Threshold Poisson network Autoregressive
model of order <code class="reqn">p</code> with <code class="reqn">q</code> covariates (T-PNAR(<code class="reqn">p</code>)).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>poisson.MODpq.tnar(b, W, gama, a, p, d, Z = NULL, TT, N, copula = "gaussian",
corrtype = "equicorrelation", rho, dof = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="poisson.MODpq.tnar_+3A_b">b</code></td>
<td>

<p>The linear coefficients of the model, in the following order: (intercept, network
parameters, autoregressive parameters, covariates). The dimension of the vector
should be <code class="reqn">2p + 1 + q</code>, where <code class="reqn">q</code> denotes the number of covariates.
</p>
</td></tr>
<tr><td><code id="poisson.MODpq.tnar_+3A_w">W</code></td>
<td>

<p>The <code class="reqn">N \times N</code> row-normalized non-negative adjacency matrix describing
the network. The main diagonal entries of the matrix should be zeros, all the
other entries should be non-negative and the maximum sum of elements over the
rows should equal one. The function row-normalizes the matrix if a non-normalized
adjacency matrix is provided.
</p>
</td></tr>
<tr><td><code id="poisson.MODpq.tnar_+3A_gama">gama</code></td>
<td>

<p>The scalar nuisance threshold parameter.
</p>
</td></tr>
<tr><td><code id="poisson.MODpq.tnar_+3A_a">a</code></td>
<td>

<p>Vector of non-linear parameters. The dimension of the vector should be
<code class="reqn">2p + 1</code>.
</p>
</td></tr>
<tr><td><code id="poisson.MODpq.tnar_+3A_p">p</code></td>
<td>

<p>The number of lags in the model.
</p>
</td></tr>
<tr><td><code id="poisson.MODpq.tnar_+3A_d">d</code></td>
<td>

<p>The lag parameter of non-linear variable (should be between 1 and <code class="reqn">p</code>).
</p>
</td></tr>
<tr><td><code id="poisson.MODpq.tnar_+3A_z">Z</code></td>
<td>

<p>An <code class="reqn">N \times q</code> matrix of covariates (one for each column),
where <code class="reqn">q</code> is the number of covariates in the model.
Note that they must be non-negative.
</p>
</td></tr>
<tr><td><code id="poisson.MODpq.tnar_+3A_tt">TT</code></td>
<td>

<p>The temporal sample size.
</p>
</td></tr>
<tr><td><code id="poisson.MODpq.tnar_+3A_n">N</code></td>
<td>

<p>The number of nodes on the network.
</p>
</td></tr>
<tr><td><code id="poisson.MODpq.tnar_+3A_copula">copula</code></td>
<td>

<p>Which copula function to use? The &quot;gaussian&quot;, &quot;t&quot;, or &quot;clayton&quot;.
</p>
</td></tr>
<tr><td><code id="poisson.MODpq.tnar_+3A_rho">rho</code></td>
<td>

<p>The value of the copula parameter (<code class="reqn">\rho</code>). A scalar in <code class="reqn">[-1,1]</code> for
elliptical copulas (Gaussian, t), a value greater than or equal to -1 for Clayton
copula.
</p>
</td></tr>
<tr><td><code id="poisson.MODpq.tnar_+3A_corrtype">corrtype</code></td>
<td>

<p>Used only for elliptical copulas. The type of correlation matrix employed for
the copula; it will either be the &quot;equicorrelation&quot; or &quot;toeplitz&quot;. The
&quot;equicorrelation&quot; option generates a correlation matrix where all the off-diagonal
entries equal <code class="reqn">\rho</code>. The &quot;toeplitz&quot; option generates a correlation matrix
whose generic off-diagonal <code class="reqn">(i,j)</code>-element is <code class="reqn">\rho^{|i-j|}</code>.
</p>
</td></tr>
<tr><td><code id="poisson.MODpq.tnar_+3A_dof">dof</code></td>
<td>

<p>The degrees of freedom for Student's t copula.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function generates counts from a non-linear Threshold Poisson NAR(<code class="reqn">p</code>) model, where <code class="reqn">q</code> non time-varying covariates are allowed as well. The counts are simulated from <code class="reqn">Y_{t}=N_{t}(\lambda_{t})</code>, where <code class="reqn">N_{t}</code> is a sequence of <code class="reqn">N</code>-dimensional IID Poisson count processes, with intensity 1, and whose structure of dependence is modelled through a copula construction <code class="reqn">C(\rho)</code> on their associated exponential waiting times random variables. For details see Armillotta and Fokianos (2022a, Sec. 2.1-2.2).
</p>
<p>The sequence <code class="reqn">\lambda_{i,t}</code> is the expecation of <code class="reqn">Y_{i,t}</code>, conditional to its past values and it is generated by means of the following T-PNAR(<code class="reqn">p</code>) model. For each node of the network <code class="reqn">i=1,...,N</code> over the time sample <code class="reqn">t=1,...,TT</code>
</p>
<p style="text-align: center;"><code class="reqn">
\lambda_{i,t}=\beta_{0}+\sum_{h=1}^{p}\left[\beta_{1h}X_{i,t-h}+\beta_{2h}Y_{i,t-h}+(\alpha_{0}+\alpha_{1h}X_{i,t-h}+\alpha_{2h}Y_{i,t-h})I(X_{i,t-d}\leq\gamma)\right]+\sum_{l=1}^{q}\delta_{l}Z_{i,l}
</code>
</p>

<p>where <code class="reqn">X_{i,t}=\sum_{j=1}^{N}W_{ij}Y_{j,t}</code> is the network effect, i.e. the weighted average impact of node <code class="reqn">i</code> connections, with the weights of the mean being <code class="reqn">W_{ij}</code>, the single element of the network matrix <code class="reqn">W</code>, and <code class="reqn">I()</code> is the indicator function.
</p>
<p>The parameter <code class="reqn">\beta_{0}</code> is the intercept of the model, <code class="reqn">\beta_{1h}</code> are the network coefficients, <code class="reqn">\beta_{2h}</code> are the autoregressive parameters, the <code class="reqn">\alpha</code> vector of non-linear parameters is divided as follows: <code class="reqn">\alpha_{0}</code> is the intercept, <code class="reqn">\alpha_{1h}</code> are the network coefficients, <code class="reqn">\alpha_{2h}</code> are the autoregressive parameters; <code class="reqn">\gamma</code> is the nuisance threshold parameter, and <code class="reqn">\delta_{l}</code> are the coefficients assocciated to the covariates <code class="reqn">Z_{i,l}</code>. The coefficient <code class="reqn">d</code> is considered as an extra parameter defining the lag of the network effect in the non-linear part of the model and is left to be set by the user. For details on T-PNAR models see Armillotta and Fokianos (2022b, Sec. 2).
</p>


<h3>Value</h3>

<p>A list including:
</p>
<table>
<tr><td><code>p2R</code></td>
<td>

<p>The Toeplitz correlation matrix, if employed in the copula or NULL else.
</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>

<p>A <code class="reqn">TT \times N</code> time series object matrix of simulated Poisson means for <code class="reqn">N</code> time
series over <code class="reqn">TT</code>.
</p>
</td></tr>
<tr><td><code>y</code></td>
<td>

<p>A <code class="reqn">TT \times N</code> time series object matrix of simulated counts for <code class="reqn">N</code> time series
over <code class="reqn">TT</code>.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mirko Armillotta, Michail Tsagris and Konstantinos Fokianos.
</p>


<h3>References</h3>

<p>Armillotta, M. and K. Fokianos (2022a). Poisson network autoregression.
<a href="https://arxiv.org/abs/2104.06296">https://arxiv.org/abs/2104.06296</a>
</p>
<p>Armillotta, M. and K. Fokianos (2022b). Testing linearity for network
autoregressive models.
<a href="https://arxiv.org/abs/2202.03852">https://arxiv.org/abs/2202.03852</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+poisson.MODpq">poisson.MODpq</a>, <a href="#topic+poisson.MODpq.log">poisson.MODpq.log</a>,
<a href="#topic+poisson.MODpq.nonlin">poisson.MODpq.nonlin</a>, <a href="#topic+poisson.MODpq.stnar">poisson.MODpq.stnar</a>
</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>W &lt;- adja( N = 20, K = 5, alpha= 0.5)
y &lt;- poisson.MODpq.tnar( b = c(0.5, 0.3, 0.2), W = W, gama = 1,
a = c(0.2, 0.2, 0.2), p = 1, d = 1, Z = NULL, TT = 1000, N = 20,
copula = "gaussian", corrtype = "equicorrelation", rho = 0.5)$y
</code></pre>

<hr>
<h2 id='rcopula'>
Random number generation of copula functions
</h2><span id='topic+rcopula'></span>

<h3>Description</h3>

<p>Random number generation of copula functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rcopula(n, N, copula = "gaussian", corrtype = "equicorrelation",
rho, dof = 1, cholR = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rcopula_+3A_n">n</code></td>
<td>

<p>The number of random values to generate.
</p>
</td></tr>
<tr><td><code id="rcopula_+3A_n">N</code></td>
<td>

<p>The number of variables for which random valeus will be generated.
</p>
</td></tr>
<tr><td><code id="rcopula_+3A_copula">copula</code></td>
<td>

<p>Which copula function to use? The &quot;gaussian&quot;, &quot;t&quot;, or &quot;clayton&quot;.
</p>
</td></tr>
<tr><td><code id="rcopula_+3A_rho">rho</code></td>
<td>

<p>The the value of the copula parameter (<code class="reqn">\rho</code>).
A scalar in <code class="reqn">[-1,1]</code> for elliptical copulas (Gaussian, t), a value
greater than or equal to -1 for Clayton copula.
</p>
</td></tr>
<tr><td><code id="rcopula_+3A_corrtype">corrtype</code></td>
<td>

<p>Used only for elliptical copulas. The type of correlation matrix employed for
the copula; it will either be the &quot;equicorrelation&quot; or &quot;toeplitz&quot;. The
&quot;equicorrelation&quot; option generates a correlation matrix where all the off-diagonal
entries equal <code class="reqn">\rho</code>. The &quot;toeplitz&quot; option generates a correlation matrix
whose generic off-diagonal <code class="reqn">(i,j)</code>-element is <code class="reqn">\rho^{|i-j|}</code>.
</p>
</td></tr>
<tr><td><code id="rcopula_+3A_dof">dof</code></td>
<td>

<p>The degrees of freedom for Student's t copula.
</p>
</td></tr>
<tr><td><code id="rcopula_+3A_cholr">cholR</code></td>
<td>

<p>An alternative input for elliptic copulas, providing directly the Cholesky
decomposition for a specific correlation matrix to be passed, otherwise leave
it NULL.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function generates random copula values from Gaussian, Student's t, or
Clayton copulas based on a single copula paremeter and different correlation
structures.
</p>


<h3>Value</h3>

<p>An <code class="reqn">n \times N</code> matrix with the simulated copula values.
</p>


<h3>Author(s)</h3>

<p>Mirko Armillotta, Michail Tsagris and Konstantinos Fokianos.
</p>


<h3>References</h3>

<p>Nelsen, Roger B. (1999). <em>An Introduction to Copulas</em>, Springer.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+getN">getN</a>, <a href="#topic+poisson.MODpq">poisson.MODpq</a>, <a href="#topic+poisson.MODpq.log">poisson.MODpq.log</a>
</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>u &lt;- rcopula(n = 100, N = 50, rho = 0.3)
</code></pre>

<hr>
<h2 id='score_test_nonlinpq_h0'>
Linearity test against non-linear ID-PNAR(p) model
</h2><span id='topic+score_test_nonlinpq_h0'></span>

<h3>Description</h3>

<p>Quasi score test for testing linearity of Poisson Network Autoregressive model
of order <code class="reqn">p</code> against the non-linear Intercep Drift (ID) version
(ID-PNAR(<code class="reqn">p</code>)).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>score_test_nonlinpq_h0(b, y, W, p, d, Z = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="score_test_nonlinpq_h0_+3A_b">b</code></td>
<td>

<p>The estimated parameters from the linear PNAR model, in the following order:
(intercept, network parameters, autoregressive parameters, covariates).
The dimension of the vector should be <code class="reqn">2p + 1 + q</code>, where <code class="reqn">q</code> denotes the number of covariates.
</p>
</td></tr>
<tr><td><code id="score_test_nonlinpq_h0_+3A_y">y</code></td>
<td>

<p>A <code class="reqn">TT \times N</code> time series object or a <code class="reqn">TT \times N</code> numerical matrix with the <code class="reqn">N</code> multivariate count time series over <code class="reqn">TT</code> time periods.
</p>
</td></tr>
<tr><td><code id="score_test_nonlinpq_h0_+3A_w">W</code></td>
<td>

<p>The <code class="reqn">N \times N</code> row-normalized non-negative adjacency matrix describing
the network. The main diagonal entries of the matrix should be zeros, all the
other entries should be non-negative and the maximum sum of elements over the
rows should equal one. The function row-normalizes the matrix if a non-normalized
adjacency matrix is provided.
</p>
</td></tr>
<tr><td><code id="score_test_nonlinpq_h0_+3A_p">p</code></td>
<td>

<p>The number of lags in the model.
</p>
</td></tr>
<tr><td><code id="score_test_nonlinpq_h0_+3A_d">d</code></td>
<td>

<p>The lag parameter of non-linear variable (should be between 1 and <code class="reqn">p</code>).
</p>
</td></tr>
<tr><td><code id="score_test_nonlinpq_h0_+3A_z">Z</code></td>
<td>

<p>An <code class="reqn">N \times q</code> matrix of covariates (one for each column),
where <code class="reqn">q</code> is the number of covariates in the model.
Note that they must be non-negative.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function computes the quasi score test for testing linearity of Poisson Network Autoregressive model of order <code class="reqn">p</code> against the following ID-PNAR(<code class="reqn">p</code>) model. For each node of the network <code class="reqn">i=1,...,N</code> over the time sample <code class="reqn">t=1,...,TT</code>
</p>
<p style="text-align: center;"><code class="reqn">
\lambda_{i,t}=\frac{\beta_{0}}{(1+X_{i,t-d})^{\gamma}}+\sum_{h=1}^{p}(\beta_{1h}X_{i,t-h}+\beta_{2h}Y_{i,t-h})+\sum_{l=1}^{q}\delta_{l}Z_{i,l}
</code>
</p>

<p>where <code class="reqn">X_{i,t}=\sum_{j=1}^{N}W_{ij}Y_{j,t}</code> is the network effect, i.e. the weighted average impact of node <code class="reqn">i</code> connections, with the weights of the mean being <code class="reqn">W_{ij}</code>, the single element of the network matrix <code class="reqn">W</code>. The sequence <code class="reqn">\lambda_{i,t}</code> is the expectation of <code class="reqn">Y_{i,t}</code> conditional to its past values.
</p>
<p>The null hypothesis of the test is defined as <code class="reqn">H_{0}: \gamma=0</code>, versus the alternative <code class="reqn">H_{1}: \gamma &gt;0</code>. The test statistic has the form
</p>
<p style="text-align: center;"><code class="reqn">
LM=S^{'}(\hat{\theta})\Sigma^{-1}(\hat{\theta})S(\hat{\theta}),
</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">
S(\hat{\theta})=\sum_{t=1}^{TT}\sum_{i=1}^{N}\left(\frac{Y_{i,t}}{\lambda_{i,t}(\hat{\theta})}-1\right)\frac{\partial\lambda_{i,t}(\hat{\theta})}{\partial\gamma}
</code>
</p>

<p>is the partition of the quasi score related to the non-linear parameter <code class="reqn">\gamma</code>, evaluated at the estimated parameters <code class="reqn">\hat{\theta}</code> under the null assumption <code class="reqn">H_{0}</code> (linear model), and <code class="reqn">\Sigma(\hat{\theta})</code> is the variance of <code class="reqn">S(\hat{\theta})</code>. Under <code class="reqn">H_{0}</code>, the test asymptotically follows the <code class="reqn">\chi^2</code> distribution with 1 degree of freedom. For details see Armillotta and Fokianos (2022b, Sec. 4).
</p>


<h3>Value</h3>

<p>A list with attribute class &quot;htest&quot; including:
</p>
<table>
<tr><td><code>statistic</code></td>
<td>

<p>The value of the <code class="reqn">\chi^2</code> test statistic.
</p>
</td></tr>
<tr><td><code>parameter</code></td>
<td>

<p>The degrees of freedom of the <code class="reqn">\chi^2</code> distribution. This is always 1.
</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>

<p>The p-value of the <code class="reqn">\chi^2</code> test statistic.
</p>
</td></tr>
<tr><td><code>null.value</code></td>
<td>

<p>The value of the <code class="reqn">\gamma</code> parameter, which is equal to 0 under the null hypothesis.
</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>

<p>The alternative hypothesis, <code class="reqn">\gamma</code> has to be greater than 0.
</p>
</td></tr>
<tr><td><code>method</code></td>
<td>

<p>The name of the test.
</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>

<p>Information on the arguments used.
</p>
</td></tr>
</table>
<p>Alternatively, these can be printed via the function <code><a href="#topic+summary.nonlin">summary.nonlin</a></code>.
</p>


<h3>Author(s)</h3>

<p>Mirko Armillotta, Michail Tsagris and Konstantinos Fokianos.
</p>


<h3>References</h3>

<p>Armillotta, M. and K. Fokianos (2022a). Poisson network autoregression.
<a href="https://arxiv.org/abs/2104.06296">https://arxiv.org/abs/2104.06296</a>
</p>
<p>Armillotta, M. and K. Fokianos (2022b). Testing linearity for network
autoregressive models.
<a href="https://arxiv.org/abs/2202.03852">https://arxiv.org/abs/2202.03852</a>
</p>
<p>Armillotta, M., Tsagris, M. and Fokianos, K. (2022c). The R-package PNAR
for modelling count network time series.
<a href="https://arxiv.org/abs/2211.02582">https://arxiv.org/abs/2211.02582</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+score_test_stnarpq_j">score_test_stnarpq_j</a>, <a href="#topic+score_test_tnarpq_j">score_test_tnarpq_j</a>,
<a href="#topic+lin_estimnarpq">lin_estimnarpq</a>
</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(crime)
data(crime_W)
mod1 &lt;- lin_estimnarpq(crime, crime_W, p = 2)
ca &lt;- mod1$coefs[, 1]
score_test_nonlinpq_h0(ca, crime, crime_W, p = 2, d = 1)
</code></pre>

<hr>
<h2 id='score_test_stnarpq_DV'>
Bound p-value for testing for smooth transition effects on PNAR(p) model
</h2><span id='topic+score_test_stnarpq_DV'></span>

<h3>Description</h3>

<p>Computation of Davies bound p-value for the sup-type test for testing linearity
of Poisson Network Autoregressive model of order <code class="reqn">p</code> (PNAR(<code class="reqn">p</code>)) versus
the non-linear Smooth Transition alternative (ST-PNAR(<code class="reqn">p</code>)).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>score_test_stnarpq_DV(b, y, W, p, d, Z = NULL, gama_L = NULL,
gama_U = NULL, len = 100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="score_test_stnarpq_DV_+3A_b">b</code></td>
<td>

<p>The estimated parameters from the linear model, in the following order:
(intercept, network parameters, autoregressive parameters, covariates).
The dimension of the vector should be <code class="reqn">2p + 1 + q</code>, where <code class="reqn">q</code> denotes the number of covariates.
</p>
</td></tr>
<tr><td><code id="score_test_stnarpq_DV_+3A_y">y</code></td>
<td>

<p>A <code class="reqn">TT \times N</code> time series object or a <code class="reqn">TT \times N</code> numerical matrix with the <code class="reqn">N</code> multivariate count time series over <code class="reqn">TT</code> time periods.
</p>
</td></tr>
<tr><td><code id="score_test_stnarpq_DV_+3A_w">W</code></td>
<td>

<p>The <code class="reqn">N \times N</code> row-normalized non-negative adjacency matrix describing
the network. The main diagonal entries of the matrix should be zeros, all the
other entries should be non-negative and the maximum sum of elements over the
rows should equal one. The function row-normalizes the matrix if a non-normalized
adjacency matrix is provided.
</p>
</td></tr>
<tr><td><code id="score_test_stnarpq_DV_+3A_p">p</code></td>
<td>

<p>The number of lags in the model.
</p>
</td></tr>
<tr><td><code id="score_test_stnarpq_DV_+3A_d">d</code></td>
<td>

<p>The lag parameter of non-linear variable (should be between 1 and <code class="reqn">p</code>).
</p>
</td></tr>
<tr><td><code id="score_test_stnarpq_DV_+3A_z">Z</code></td>
<td>

<p>An <code class="reqn">N \times q</code> matrix of covariates (one for each column),
where <code class="reqn">q</code> is the number of covariates in the model.
Note that they must be non-negative.
</p>
</td></tr>
<tr><td><code id="score_test_stnarpq_DV_+3A_gama_l">gama_L</code></td>
<td>

<p>The lower value of the nuisance parameter <code class="reqn">\gamma</code> to consider.
Use NULL if there is not information about its value.
See the details for default computation.
</p>
</td></tr>
<tr><td><code id="score_test_stnarpq_DV_+3A_gama_u">gama_U</code></td>
<td>

<p>The upper value of the nuisance parameter <code class="reqn">\gamma</code> to consider.
Use NULL if there is not information about its value.
See the details for default computation.
</p>
</td></tr>
<tr><td><code id="score_test_stnarpq_DV_+3A_len">len</code></td>
<td>

<p>The length of the grid of values of <code class="reqn">\gamma</code> values to consider.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function computes an upper-bound for the p-value of the sup-type test for testing linearity of Poisson Network
Autoregressive model of order <code class="reqn">p</code> (PNAR(<code class="reqn">p</code>)) versus the following Smooth Transition alternative (ST-PNAR(<code class="reqn">p</code>)).
For each node of the network <code class="reqn">i=1,...,N</code> over the time sample <code class="reqn">t=1,...,TT</code>
</p>
<p style="text-align: center;"><code class="reqn">
\lambda_{i,t}=\beta_{0}+\sum_{h=1}^{p}(\beta_{1h}X_{i,t-h}+\beta_{2h}Y_{i,t-h}+\alpha_{h}e^{-\gamma X_{i,t-d}^{2}}X_{i,t-h})+\sum_{l=1}^{q}\delta_{l}Z_{i,l}
</code>
</p>

<p>where <code class="reqn">X_{i,t}=\sum_{j=1}^{N}W_{ij}Y_{j,t}</code> is the network effect, i.e. the weighted average impact of node <code class="reqn">i</code> connections, with the weights of the mean being <code class="reqn">W_{ij}</code>, the single element of the network matrix <code class="reqn">W</code>. The sequence <code class="reqn">\lambda_{i,t}</code> is the expectation of <code class="reqn">Y_{i,t}</code>, conditional to its past values.
</p>
<p>The null hypothesis of the test is defined as <code class="reqn">H_{0}: \alpha_{1}=...=\alpha_{p}=0</code>, versus the alternative that at least one among <code class="reqn">\alpha_{h}</code> is not 0. The test statistic has the form
</p>
<p style="text-align: center;"><code class="reqn">
LM(\gamma)=S^{'}(\hat{\theta},\gamma)\Sigma^{-1}(\hat{\theta},\gamma)S(\hat{\theta},\gamma),
</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">
S(\hat{\theta},\gamma)=\sum_{t=1}^{TT}\sum_{i=1}^{N}\left(\frac{Y_{i,t}}{\lambda_{i,t}(\hat{\theta},\gamma)}-1\right)\frac{\partial\lambda_{i,t}(\hat{\theta},\gamma)}{\partial\alpha}
</code>
</p>

<p>is the partition of the quasi score related to the vector of non-linear parameters <code class="reqn">\alpha=(\alpha_{1},...,\alpha_{p})</code>, evaluated at the estimated parameters <code class="reqn">\hat{\theta}</code> under the null assumption <code class="reqn">H_{0}</code> (linear model), and <code class="reqn">\Sigma(\hat{\theta},\gamma)</code> is the variance of <code class="reqn">S(\hat{\theta},\gamma)</code>. Since the test statistic depends on an unknown nuisance parameter (<code class="reqn">\gamma</code>), the supremum of the statistic is considered in the test, <code class="reqn">\sup_{\gamma}LM(\gamma)</code>. The function computes the bound of the p-value, suggested by Davies (1987), for the test statistic <code class="reqn">\sup_{\gamma}LM(\gamma)</code>, with scalar nuisance parameter <code class="reqn">\gamma</code>, as follows.
</p>
<p style="text-align: center;"><code class="reqn">
P(\chi^{2}_{k} \geq M)+V M^{1/2(k-1)}\frac{e^{-M/2}2^{-k/2}}{\Gamma(k/2)}
</code>
</p>

<p>where <code class="reqn">M</code> is the maximum of the test statistic <code class="reqn">LM(\gamma)</code>, computed by the available sample, over a grid of values for the nuisance parameter <code class="reqn">\gamma_{F}=(\gamma_{L},\gamma_{1},...,\gamma_{l},\gamma_{U})</code>; <code class="reqn">k</code> is the number of non-linear parameters tested. So the first summand of the bound is just the p-value of a chi-square test with <code class="reqn">k</code> degrees of freedom. The second summand is a correction term depending on <code class="reqn">V</code>, which is the approximated total variation computed as
</p>
<p style="text-align: center;"><code class="reqn">
V=|LM^{1/2}(\gamma_{1})-LM^{1/2}(\gamma_{L})|+|LM^{1/2}(\gamma_{2})-LM^{1/2}(\gamma_{1})|+...+|LM^{1/2}(\gamma_{U})-LM^{1/2}(\gamma_{l})|.
</code>
</p>

<p>The feasible bound allows to approximate the p-values of the sup-type test in a straightforward way, by adding to the tail probability of a chi-square distribution a correction term which depends on the total variation of the process. For details see Armillotta and Fokianos (2022b, Sec. 5).
</p>
<p>The values of <code>gama_L</code> and <code>gama_U</code> are computed internally as <code>gama_L</code> <code class="reqn">=-\log(0.9)/X^{2}</code> and <code>gama_U</code> <code class="reqn">=-\log(0.1)/X^{2}</code>, where <code class="reqn">X</code> is the overall mean of <code class="reqn">X_{i,t}</code> over the nodes <code class="reqn">i=1,...,N</code> and times <code class="reqn">t=1,...,TT</code>. Since the non-linear function <code class="reqn">e^{-\gamma X_{i,t-d}^{2}}</code> ranges between 0 and 1, by considering <code class="reqn">X</code> to be a representative value for the network mean, <code>gama_U</code> and <code>gama_L</code> would be the values of <code class="reqn">\gamma</code> leading the non-linear switching function to be 0.1 and 0.9, respectively, so that in the optimization procedure the extremes of the function domain are excluded. Alternatively, their values can be supplied by the user.
</p>


<h3>Value</h3>

<p>A list including:
</p>
<table>
<tr><td><code>DV</code></td>
<td>

<p>The Davies bound of p-values for sup test.
</p>
</td></tr>
<tr><td><code>supLM</code></td>
<td>

<p>The value of the sup test statistic in the sample <code class="reqn">y</code>.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mirko Armillotta, Michail Tsagris and Konstantinos Fokianos.
</p>


<h3>References</h3>

<p>Armillotta, M. and K. Fokianos (2022a). Poisson network autoregression.
<a href="https://arxiv.org/abs/2104.06296">https://arxiv.org/abs/2104.06296</a>
</p>
<p>Armillotta, M. and K. Fokianos (2022b). Testing linearity for network
autoregressive models.
<a href="https://arxiv.org/abs/2202.03852">https://arxiv.org/abs/2202.03852</a>
</p>
<p>Davies, R. B. (1987). Hypothesis testing when a nuisance parameter is
present only under the alternative. <em>Biometrika</em> 74, 33-43.
</p>
<p>Armillotta, M., Tsagris, M. and Fokianos, K. (2022c). The R-package PNAR
for modelling count network time series.
<a href="https://arxiv.org/abs/2211.02582">https://arxiv.org/abs/2211.02582</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+score_test_stnarpq_j">score_test_stnarpq_j</a>, <a href="#topic+global_optimise_LM_stnarpq">global_optimise_LM_stnarpq</a>
</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(crime)
data(crime_W)
mod1 &lt;- lin_estimnarpq(crime, crime_W, p = 1)
ca &lt;- mod1$coefs[, 1]
score_test_stnarpq_DV(ca, crime, crime_W, p = 1, d = 1)
</code></pre>

<hr>
<h2 id='score_test_stnarpq_j'>
Bootstrap test for smooth transition effects on PNAR(p) model
</h2><span id='topic+score_test_stnarpq_j'></span>

<h3>Description</h3>

<p>Computation of bootstrap p-value for the sup-type test for testing linearity of
Poisson Network Autoregressive model of order <code class="reqn">p</code> (PNAR(<code class="reqn">p</code>)) versus the
non-linear Smooth Transition alternative (ST-PNAR(<code class="reqn">p</code>)).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>score_test_stnarpq_j(supLM, b, y, W, p, d, Z = NULL, J = 499,
gama_L = NULL, gama_U = NULL, tol = 1e-9, ncores = 1, seed = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="score_test_stnarpq_j_+3A_suplm">supLM</code></td>
<td>

<p>The optimized value of the test statistic. See the function
<code><a href="#topic+global_optimise_LM_stnarpq">global_optimise_LM_stnarpq</a></code>.
</p>
</td></tr>
<tr><td><code id="score_test_stnarpq_j_+3A_b">b</code></td>
<td>

<p>The estimated parameters from the linear model, in the following order:
(intercept, network parameters, autoregressive parameters, covariates).
The dimension of the vector should be <code class="reqn">2p + 1 + q</code>, where <code class="reqn">q</code> denotes the number of covariates.
</p>
</td></tr>
<tr><td><code id="score_test_stnarpq_j_+3A_y">y</code></td>
<td>

<p>A <code class="reqn">TT \times N</code> time series object or a <code class="reqn">TT \times N</code> numerical matrix with the <code class="reqn">N</code> multivariate count time series over <code class="reqn">TT</code> time periods.
</p>
</td></tr>
<tr><td><code id="score_test_stnarpq_j_+3A_w">W</code></td>
<td>

<p>The <code class="reqn">N \times N</code> row-normalized non-negative adjacency matrix describing
the network. The main diagonal entries of the matrix should be zeros, all the
other entries should be non-negative and the maximum sum of elements over the
rows should equal one. The function row-normalizes the matrix if a non-normalized
adjacency matrix is provided.
</p>
</td></tr>
<tr><td><code id="score_test_stnarpq_j_+3A_p">p</code></td>
<td>

<p>The number of lags in the model.
</p>
</td></tr>
<tr><td><code id="score_test_stnarpq_j_+3A_d">d</code></td>
<td>

<p>The lag parameter of non-linear variable (should be between 1 and <code class="reqn">p</code>).
</p>
</td></tr>
<tr><td><code id="score_test_stnarpq_j_+3A_z">Z</code></td>
<td>

<p>An <code class="reqn">N \times q</code> matrix of covariates (one for each column),
where <code class="reqn">q</code> is the number of covariates in the model.
Note that they must be non-negative.
</p>
</td></tr>
<tr><td><code id="score_test_stnarpq_j_+3A_j">J</code></td>
<td>

<p>The number of bootstrap samples to draw.
</p>
</td></tr>
<tr><td><code id="score_test_stnarpq_j_+3A_gama_l">gama_L</code></td>
<td>

<p>The lower value of the nuisance parameter <code class="reqn">\gamma</code> to consider.
Use NULL if there is not information about its value.
See the details for default computation.
</p>
</td></tr>
<tr><td><code id="score_test_stnarpq_j_+3A_gama_u">gama_U</code></td>
<td>

<p>The upper value of the nuisance parameter <code class="reqn">\gamma</code> to consider.
Use NULL if there is not information about its value.
See the details for default computation.
</p>
</td></tr>
<tr><td><code id="score_test_stnarpq_j_+3A_tol">tol</code></td>
<td>

<p>Tolerance level for the optimizer.
</p>
</td></tr>
<tr><td><code id="score_test_stnarpq_j_+3A_ncores">ncores</code></td>
<td>

<p>Number of cores to use for parallel computing. By default the number of
cores is set to 1 (no parallel computing). <b>Note:</b> If for some reason the
parallel does not work then load the doParallel package yourseleves.
</p>
</td></tr>
<tr><td><code id="score_test_stnarpq_j_+3A_seed">seed</code></td>
<td>

<p>To replicate the results use a seed for the generator, an integer number.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function computes a bootstrap p-value for the sup-type test for testing linearity of Poisson Network Autoregressive model of order <code class="reqn">p</code> (PNAR(<code class="reqn">p</code>)) versus the following Smooth Transition alternative (ST-PNAR(<code class="reqn">p</code>)). For each node of the network <code class="reqn">i=1,...,N</code> over the time sample <code class="reqn">t=1,...,TT</code>
</p>
<p style="text-align: center;"><code class="reqn">
\lambda_{i,t}=\beta_{0}+\sum_{h=1}^{p}(\beta_{1h}X_{i,t-h}+\beta_{2h}Y_{i,t-h}+\alpha_{h}e^{-\gamma X_{i,t-d}^{2}}X_{i,t-h})+\sum_{l=1}^{q}\delta_{l}Z_{i,l},
</code>
</p>

<p>where <code class="reqn">X_{i,t}=\sum_{j=1}^{N}W_{ij}Y_{j,t}</code> is the network effect, i.e. the weighted average impact of node <code class="reqn">i</code> connections, with the weights of the mean being <code class="reqn">W_{ij}</code>, the single element of the network matrix <code class="reqn">W</code>. The sequence <code class="reqn">\lambda_{i,t}</code> is the expectation of <code class="reqn">Y_{i,t}</code>, conditional to its past values.
</p>
<p>The null hypothesis of the test is defined as <code class="reqn">H_{0}: \alpha_{1}=...=\alpha_{p}=0</code>, versus the alternative that at least one among <code class="reqn">\alpha_{h}</code> is not <code class="reqn">0</code>. The test statistic has the form
</p>
<p style="text-align: center;"><code class="reqn">
LM(\gamma)=S^{'}(\hat{\theta},\gamma)\Sigma^{-1}(\hat{\theta},\gamma)S(\hat{\theta},\gamma)
</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">
S(\hat{\theta},\gamma)=\sum_{t=1}^{TT}\sum_{i=1}^{N}\left(\frac{Y_{i,t}}{\lambda_{i,t}(\hat{\theta},\gamma)}-1\right)\frac{\partial\lambda_{i,t}(\hat{\theta},\gamma)}{\partial\alpha}
</code>
</p>

<p>is the partition of the quasi score related to the vector of non-linear parameters <code class="reqn">\alpha=(\alpha_{1},...,\alpha_{p})</code>, evaluated at the estimated parameters <code class="reqn">\hat{\theta}</code> under the null assumption <code class="reqn">H_{0}</code> (linear model), and <code class="reqn">\Sigma(\hat{\theta},\gamma)</code> is the variance of <code class="reqn">S(\hat{\theta},\gamma)</code>.
</p>
<p>Since the test statistic depends on an unknown nuisance parameter (<code class="reqn">\gamma</code>), the supremum of the statistic is considered in the test, <code class="reqn">\sup_{\gamma}LM(\gamma)</code>. This value can be computed for the available sample by using the function <code><a href="#topic+global_optimise_LM_stnarpq">global_optimise_LM_stnarpq</a></code> and should be supplied here as an input <code>supLM</code>.
</p>
<p>The function performs the bootstrap resampling of the test statistic <code class="reqn">\sup_{\gamma}LM(\gamma)</code> by employing Gaussian perturbations of the score <code class="reqn">S(\hat{\theta},\gamma)</code>. For details see Armillotta and Fokianos (2022b, Sec. 5).
</p>
<p>The values of <code>gama_L</code> and <code>gama_U</code> are computed internally as <code>gama_L</code> <code class="reqn">=-\log(0.9)/X^{2}</code> and <code>gama_U</code> <code class="reqn">=-\log(0.1)/X^{2}</code>, where <code class="reqn">X</code> is the overall mean of <code class="reqn">X_{i,t}</code> over the nodes <code class="reqn">i=1,...,N</code> and times <code class="reqn">t=1,...,TT</code>. Since the non-linear function <code class="reqn">e^{-\gamma X_{i,t-d}^{2}}</code> ranges between 0 and 1, by considering <code class="reqn">X</code> to be a representative value for the network mean, <code>gama_U</code> and <code>gama_L</code> would be the values of <code class="reqn">\gamma</code> leading the non-linear switching function to be 0.1 and 0.9, respectively, so that in the optimization procedure the extremes of the function domain are excluded. Alternatively, their value can be supplied by the user.
</p>
<p><b>Note:</b> For large datasets the function may require few minutes to run. Parallel computing is suggested to speed up the computations.
</p>


<h3>Value</h3>

<p>A list including:
</p>
<table>
<tr><td><code>pJ</code></td>
<td>

<p>The bootstrap p-value of the sup test.
</p>
</td></tr>
<tr><td><code>cpJ</code></td>
<td>

<p>The adjusted version of bootstrap p-value of the sup test.
</p>
</td></tr>
<tr><td><code>gamaj</code></td>
<td>

<p>The optimal values of the <code class="reqn">\gamma</code> parameter for score test boostrap
replications.
</p>
</td></tr>
<tr><td><code>supLMj</code></td>
<td>

<p>The values of perturbed test statistic at the optimum point <code>gamaj</code>.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mirko Armillotta, Michail Tsagris and Konstantinos Fokianos.
</p>


<h3>References</h3>

<p>Armillotta, M. and K. Fokianos (2022a). Poisson network autoregression.
<a href="https://arxiv.org/abs/2104.06296">https://arxiv.org/abs/2104.06296</a>
</p>
<p>Armillotta, M. and K. Fokianos (2022b). Testing linearity for network
autoregressive models.
<a href="https://arxiv.org/abs/2202.03852">https://arxiv.org/abs/2202.03852</a>
</p>
<p>Armillotta, M., Tsagris, M. and Fokianos, K. (2022c). The R-package PNAR
for modelling count network time series.
<a href="https://arxiv.org/abs/2211.02582">https://arxiv.org/abs/2211.02582</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+score_test_stnarpq_DV">score_test_stnarpq_DV</a>, <a href="#topic+global_optimise_LM_stnarpq">global_optimise_LM_stnarpq</a>,
<a href="#topic+score_test_tnarpq_j">score_test_tnarpq_j</a>
</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load data
data(crime)
data(crime_W)
#estimate linear PNAR model
mod1 &lt;- lin_estimnarpq(crime, crime_W, p = 2)
b &lt;- mod1$coefs[, 1]

g &lt;- global_optimise_LM_stnarpq(b = b, y = crime, W = crime_W, p = 2, d = 1)
supg &lt;- g$supLM
score_test_stnarpq_j(supLM = supg, b = b, y = crime, W = crime_W, p = 2, d = 1, J = 5)

</code></pre>

<hr>
<h2 id='score_test_tnarpq_j'>
Bootstrap test for threshold effects on PNAR(p) model
</h2><span id='topic+score_test_tnarpq_j'></span>

<h3>Description</h3>

<p>Computation of bootstrap p-value for the sup-type test for testing linearity of
Poisson Network Autoregressive model of order <code class="reqn">p</code> (PNAR(<code class="reqn">p</code>)) versus the
non-linear Threshold alternative (T-PNAR(<code class="reqn">p</code>)).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>score_test_tnarpq_j(supLM, b, y, W, p, d, Z = NULL, J = 499,
gama_L = NULL, gama_U = NULL, tol = 1e-9, ncores = 1, seed = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="score_test_tnarpq_j_+3A_suplm">supLM</code></td>
<td>

<p>The optimized value of the test statistic. See the function
<code><a href="#topic+global_optimise_LM_tnarpq">global_optimise_LM_tnarpq</a></code>.
</p>
</td></tr>
<tr><td><code id="score_test_tnarpq_j_+3A_b">b</code></td>
<td>

<p>The estimated parameters from the linear model, in the following order:
(intercept, network parameters, autoregressive parameters, covariates).
The dimension of the vector should be <code class="reqn">2p + 1 + q</code>, where <code class="reqn">q</code> denotes the number of covariates.
</p>
</td></tr>
<tr><td><code id="score_test_tnarpq_j_+3A_y">y</code></td>
<td>

<p>A <code class="reqn">TT \times N</code> time series object or a <code class="reqn">TT \times N</code> numerical matrix with the <code class="reqn">N</code> multivariate count time series over <code class="reqn">TT</code> time periods.
</p>
</td></tr>
<tr><td><code id="score_test_tnarpq_j_+3A_w">W</code></td>
<td>

<p>The <code class="reqn">N \times N</code> row-normalized non-negative adjacency matrix describing
the network. The main diagonal entries of the matrix should be zeros,
all the other entries should be non-negative and the maximum sum of elements
over the rows should equal one. The function row-normalizes the matrix if a
non-normalized adjacency matrix is provided.
</p>
</td></tr>
<tr><td><code id="score_test_tnarpq_j_+3A_p">p</code></td>
<td>

<p>The number of lags in the model.
</p>
</td></tr>
<tr><td><code id="score_test_tnarpq_j_+3A_d">d</code></td>
<td>

<p>The lag parameter of non-linear variable (should be between 1 and <code class="reqn">p</code>).
</p>
</td></tr>
<tr><td><code id="score_test_tnarpq_j_+3A_z">Z</code></td>
<td>

<p>An <code class="reqn">N \times q</code> matrix of covariates (one for each column), where <code class="reqn">q</code>
is the number of covariates in the model. Note that they must be non-negative.
</p>
</td></tr>
<tr><td><code id="score_test_tnarpq_j_+3A_j">J</code></td>
<td>

<p>The number of bootstrap samples to draw.
</p>
</td></tr>
<tr><td><code id="score_test_tnarpq_j_+3A_gama_l">gama_L</code></td>
<td>

<p>The lower value of the nuisance parameter <code class="reqn">\gamma</code> to consider.
Use NULL if there is not information about its value.
See the details for default computation.
</p>
</td></tr>
<tr><td><code id="score_test_tnarpq_j_+3A_gama_u">gama_U</code></td>
<td>

<p>The upper value of the nuisance parameter <code class="reqn">\gamma</code> to consider.
Use NULL if there is not information about its value.
See the details for default computation.
</p>
</td></tr>
<tr><td><code id="score_test_tnarpq_j_+3A_tol">tol</code></td>
<td>

<p>Tolerance level for the optimizer.
</p>
</td></tr>
<tr><td><code id="score_test_tnarpq_j_+3A_ncores">ncores</code></td>
<td>

<p>Number of cores to use for parallel computing. By default the number of
cores is set to 1 (no parallel computing). <b>Note:</b> If for some reason the
parallel does not work then load the doParallel package yourseleves.
</p>
</td></tr>
<tr><td><code id="score_test_tnarpq_j_+3A_seed">seed</code></td>
<td>

<p>To replicate the results use a seed for the generator, an integer number.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function computes a bootstrap p-value for the sup-type test for testing linearity of Poisson Network Autoregressive model of order <code class="reqn">p</code> (PNAR(<code class="reqn">p</code>)) versus the following Threshold alternative (T-PNAR(<code class="reqn">p</code>)). For each node of the network <code class="reqn">i=1,...,N</code> over the time sample <code class="reqn">t=1,...,TT</code>
</p>
<p style="text-align: center;"><code class="reqn">
\lambda_{i,t}=\beta_{0}+\sum_{h=1}^{p}\left[\beta_{1h}X_{i,t-h}+\beta_{2h}Y_{i,t-h}+(\alpha_{0}+\alpha_{1h}X_{i,t-h}+\alpha_{2h}Y_{i,t-h})I(X_{i,t-d}\leq\gamma)\right]+\sum_{l=1}^{q}\delta_{l}Z_{i,l}
</code>
</p>

<p>where <code class="reqn">X_{i,t}=\sum_{j=1}^{N}W_{ij}Y_{j,t}</code> is the network effect, i.e. the weighted average impact of node <code class="reqn">i</code> connections, with the weights of the mean being <code class="reqn">W_{ij}</code>, the single element of the network matrix <code class="reqn">W</code>. The sequence <code class="reqn">\lambda_{i,t}</code> is the expectation of <code class="reqn">Y_{i,t}</code>, conditional to its past values.
</p>
<p>The null hypothesis of the test is defined as <code class="reqn">H_{0}: \alpha_{0}=\alpha_{11}=...=\alpha_{2p}=0</code>, versus the alternative that at least one among <code class="reqn">\alpha_{s,h}</code> is not <code class="reqn">0</code>, for <code class="reqn">s=0,1,2</code>. The test statistic has the form
</p>
<p style="text-align: center;"><code class="reqn">
LM(\gamma)=S^{'}(\hat{\theta},\gamma)\Sigma^{-1}(\hat{\theta},\gamma)S(\hat{\theta},\gamma)
</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">
S(\hat{\theta}, \gamma)=\sum_{t=1}^{TT}\sum_{i=1}^{N}\left(\frac{Y_{i,t}}{\lambda_{i,t}(\hat{\theta}, \gamma)}-1\right)\frac{\partial\lambda_{i,t}(\hat{\theta},\gamma)}{\partial\alpha}
</code>
</p>

<p>is the partition of the quasi score related to the vector of non-linear parameters <code class="reqn">\alpha=(\alpha_{0},...,\alpha_{2p})</code>, evaluated at the estimated parameters <code class="reqn">\hat{\theta}</code> under the null assumption <code class="reqn">H_{0}</code> (linear model), and <code class="reqn">\Sigma(\hat{\theta},\gamma)</code> is the variance of <code class="reqn">S(\hat{\theta},\gamma)</code>.
</p>
<p>Since the test statistic depends on an unknown nuisance parameter (<code class="reqn">\gamma</code>), the supremum of the statistic is considered in the test, <code class="reqn">\sup_{\gamma}LM(\gamma)</code>. This value can be computed for the available sample by using the function <code><a href="#topic+global_optimise_LM_tnarpq">global_optimise_LM_tnarpq</a></code> and should be supplied here as an input <code>supLM</code>.
</p>
<p>The function performs the bootstrap resampling of the test statistic <code class="reqn">\sup_{\gamma}LM(\gamma)</code> by employing Gaussian perturbations of the score <code class="reqn">S(\hat{\theta},\gamma)</code>. For details see Armillotta and Fokianos (2022b, Sec. 5).
</p>
<p>The values of <code>gama_L</code> and <code>gama_U</code> are computed internally as the mean over <code class="reqn">i=1,...,N</code> of <code class="reqn">20\%</code> and <code class="reqn">80\%</code> quantiles of the empirical distribution of the network mean <code class="reqn">X_{i,t}</code> for <code class="reqn">t=1,...,TT</code>. In this way the optimization is performed for values of <code class="reqn">\gamma</code> such that the indicator function <code class="reqn">I(X_{i,t-d}\leq\gamma)</code> is not always close to 0 or 1. Alternatively, their value can be supplied by the user. For details see Armillotta and Fokianos (2022b, Sec. 4-5).
</p>
<p><b>Note:</b> For large datasets the function may require few minutes to run. Parallel computing is suggested to speed up the computations.
</p>


<h3>Value</h3>

<p>A list including:
</p>
<table>
<tr><td><code>pJ</code></td>
<td>

<p>The bootstrap p-value of the sup test.
</p>
</td></tr>
<tr><td><code>cpJ</code></td>
<td>

<p>The adjusted version of bootstrap p-value of the sup test.
</p>
</td></tr>
<tr><td><code>gamaj</code></td>
<td>

<p>The optimal values of the <code class="reqn">\gamma</code> parameter for score test boostrap
replications.
</p>
</td></tr>
<tr><td><code>supLMj</code></td>
<td>

<p>The values of perturbed test statistic at the optimum point <code>gamaj</code>.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mirko Armillotta, Michail Tsagris and Konstantinos Fokianos.
</p>


<h3>References</h3>

<p>Armillotta, M. and K. Fokianos (2022a). Poisson network autoregression.
<a href="https://arxiv.org/abs/2104.06296">https://arxiv.org/abs/2104.06296</a>
</p>
<p>Armillotta, M. and K. Fokianos (2022b). Testing linearity for network
autoregressive models.
<a href="https://arxiv.org/abs/2202.03852">https://arxiv.org/abs/2202.03852</a>
</p>
<p>Armillotta, M., Tsagris, M. and Fokianos, K. (2022c). The R-package PNAR
for modelling count network time series.
<a href="https://arxiv.org/abs/2211.02582">https://arxiv.org/abs/2211.02582</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+global_optimise_LM_tnarpq">global_optimise_LM_tnarpq</a>,
<a href="#topic+global_optimise_LM_stnarpq">global_optimise_LM_stnarpq</a>, <a href="#topic+score_test_stnarpq_j">score_test_stnarpq_j</a>
</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load data
data(crime)
data(crime_W)
#estimate linear PNAR model
mod1 &lt;- lin_estimnarpq(crime, crime_W, p = 2)
b &lt;- mod1$coefs[, 1]

g &lt;- global_optimise_LM_tnarpq(b = b, y = crime, W = crime_W, p = 2, d = 1)
supg &lt;- g$supLM
score_test_tnarpq_j(supLM = supg, b = b, y = crime, W = crime_W, p = 2, d = 1, J = 5)

</code></pre>

<hr>
<h2 id='summary.DV'>S3 methods for extracting the results of the bound p-value for testing for smooth transition effects on PNAR(p) model
</h2><span id='topic+summary.DV'></span><span id='topic+print.summary.DV'></span><span id='topic+print.DV'></span>

<h3>Description</h3>

<p>S3 methods for extracting the results of the bound p-value for testing for smooth transition effects on PNAR(<code class="reqn">p</code>) model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'DV'
summary(object, ...)
## S3 method for class 'summary.DV'
print(x, ...)
## S3 method for class 'DV'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.DV_+3A_object">object</code></td>
<td>

<p>An object containing the results of the function <code><a href="#topic+score_test_stnarpq_DV">score_test_stnarpq_DV</a></code>.
</p>
</td></tr>
<tr><td><code id="summary.DV_+3A_x">x</code></td>
<td>

<p>An object containing the results of the function <code><a href="#topic+score_test_stnarpq_DV">score_test_stnarpq_DV</a></code>.
</p>
</td></tr>
<tr><td><code id="summary.DV_+3A_...">...</code></td>
<td>

<p>Extra arguments the user can pass.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The functions print the output of the bound p-value for testing for smooth transition effects on PNAR(<code class="reqn">p</code>) model.
</p>


<h3>Value</h3>

<p>The functions print the results of the function <code><a href="#topic+score_test_stnarpq_DV">score_test_stnarpq_DV</a></code>.
</p>


<h3>Author(s)</h3>

<p>Mirko Armillotta, Michail Tsagris and Konstantinos Fokianos.
</p>


<h3>References</h3>

<p>Armillotta, M. and K. Fokianos (2022a). Poisson network autoregression.
<a href="https://arxiv.org/abs/2104.06296">https://arxiv.org/abs/2104.06296</a>
</p>
<p>Armillotta, M. and K. Fokianos (2022b). Testing linearity for network
autoregressive models.
<a href="https://arxiv.org/abs/2202.03852">https://arxiv.org/abs/2202.03852</a>
</p>
<p>Davies, R. B. (1987). Hypothesis testing when a nuisance parameter is
present only under the alternative. <em>Biometrika</em> 74, 33-43.
</p>
<p>Armillotta, M., Tsagris, M. and Fokianos, K. (2022c). The R-package PNAR
for modelling count network time series.
<a href="https://arxiv.org/abs/2211.02582">https://arxiv.org/abs/2211.02582</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+score_test_stnarpq_DV">score_test_stnarpq_DV</a>
</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(crime)
data(crime_W)
mod1 &lt;- lin_estimnarpq(crime, crime_W, p = 1)
ca &lt;- mod1$coefs[, 1]
a &lt;- score_test_stnarpq_DV(ca, crime, crime_W, p = 1, d = 1)
print(a)
summary(a)
</code></pre>

<hr>
<h2 id='summary.nonlin'>S3 methods for extracting the results of the non-linear hypothesis test
</h2><span id='topic+summary.nonlin'></span><span id='topic+print.summary.nonlin'></span><span id='topic+print.nonlin'></span>

<h3>Description</h3>

<p>S3 methods for extracting the results of the non-linear hypothesis test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nonlin'
summary(object, ...)
## S3 method for class 'summary.nonlin'
print(x, ...)
## S3 method for class 'nonlin'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.nonlin_+3A_object">object</code></td>
<td>

<p>An object containing the results of the function <code><a href="#topic+score_test_nonlinpq_h0">score_test_nonlinpq_h0</a></code>.
</p>
</td></tr>
<tr><td><code id="summary.nonlin_+3A_x">x</code></td>
<td>

<p>An object containing the results of the function <code><a href="#topic+score_test_nonlinpq_h0">score_test_nonlinpq_h0</a></code>.
</p>
</td></tr>
<tr><td><code id="summary.nonlin_+3A_...">...</code></td>
<td>

<p>Extra arguments the user can pass.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The functions print the output of the non-linear hypothesis test.
</p>


<h3>Value</h3>

<p>The functions print the results of the function <code><a href="#topic+score_test_nonlinpq_h0">score_test_nonlinpq_h0</a></code>.
</p>


<h3>Author(s)</h3>

<p>Mirko Armillotta, Michail Tsagris and Konstantinos Fokianos.
</p>


<h3>References</h3>

<p>Armillotta, M. and K. Fokianos (2022a). Poisson network autoregression.
<a href="https://arxiv.org/abs/2104.06296">https://arxiv.org/abs/2104.06296</a>
</p>
<p>Armillotta, M. and K. Fokianos (2022b). Testing linearity for network
autoregressive models.
<a href="https://arxiv.org/abs/2202.03852">https://arxiv.org/abs/2202.03852</a>
</p>
<p>Armillotta, M., Tsagris, M. and Fokianos, K. (2022c). The R-package PNAR
for modelling count network time series.
<a href="https://arxiv.org/abs/2211.02582">https://arxiv.org/abs/2211.02582</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+score_test_nonlinpq_h0">score_test_nonlinpq_h0</a>
</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(crime)
data(crime_W)
mod1 &lt;- lin_estimnarpq(crime, crime_W, p = 2)
ca &lt;- mod1$coefs[, 1]
a &lt;- score_test_nonlinpq_h0(ca, crime, crime_W, p = 2, d = 1)
print(a)
summary(a)
</code></pre>

<hr>
<h2 id='summary.PNAR'>S3 methods for extracting the results of the estimation functions
</h2><span id='topic+summary.PNAR'></span><span id='topic+print.summary.PNAR'></span><span id='topic+print.PNAR'></span>

<h3>Description</h3>

<p>S3 methods for extracting the results of the estimation functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'PNAR'
summary(object, ...)
## S3 method for class 'summary.PNAR'
print(x, ...)
## S3 method for class 'PNAR'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.PNAR_+3A_object">object</code></td>
<td>

<p>An object containing the results of the estimation function <code><a href="#topic+lin_estimnarpq">lin_estimnarpq</a></code> or <code><a href="#topic+log_lin_estimnarpq">log_lin_estimnarpq</a></code>.
</p>
</td></tr>
<tr><td><code id="summary.PNAR_+3A_x">x</code></td>
<td>

<p>An object containing the results of the estimation function <code><a href="#topic+lin_estimnarpq">lin_estimnarpq</a></code> or <code><a href="#topic+log_lin_estimnarpq">log_lin_estimnarpq</a></code>.
</p>
</td></tr>
<tr><td><code id="summary.PNAR_+3A_...">...</code></td>
<td>

<p>Extra arguments the user can pass.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions print the output of the estimation functions.
</p>


<h3>Value</h3>

<p>The print.PNAR() function prints the coefficients of the model.
The summary.PNAR() function prints the output in the lm() style.
</p>


<h3>Author(s)</h3>

<p>Mirko Armillotta, Michail Tsagris and Konstantinos Fokianos.
</p>


<h3>References</h3>

<p>Armillotta, M. and K. Fokianos (2022a). Poisson network autoregression.
<a href="https://arxiv.org/abs/2104.06296">https://arxiv.org/abs/2104.06296</a>
</p>
<p>Armillotta, M., Tsagris, M. and Fokianos, K. (2022c). The R-package PNAR
for modelling count network time series.
<a href="https://arxiv.org/abs/2211.02582">https://arxiv.org/abs/2211.02582</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+log_lin_estimnarpq">log_lin_estimnarpq</a>
</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(crime)
data(crime_W)
mod1 &lt;- lin_estimnarpq(crime, crime_W, p = 2)
mod1
print(mod1)
summary(mod1)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
