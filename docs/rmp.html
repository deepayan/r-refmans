<!DOCTYPE html><html><head><title>Help for package rmp</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {rmp}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#dp.post.est'>
<p>Posterior probability mass function estimation with DP prior</p></a></li>
<li><a href='#ethylene'>
<p>Developmental toxicity study of ethylene glycol in mice</p></a></li>
<li><a href='#npmp'>
<p>DP mixtures of Poissons</p></a></li>
<li><a href='#rmg'>
<p>Nonparametric mixture of rounded Gaussians</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Rounded Mixture Package</td>
</tr>
<tr>
<td>Version:</td>
<td>2.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-12-12</td>
</tr>
<tr>
<td>Author:</td>
<td>Antonio Canale [aut, cre],
  Nicola Lunardon [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Antonio Canale &lt;antonio.canale@unipd.it&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Performs univariate probability mass function estimation via Bayesian nonparametric mixtures of rounded kernels as in Canale and Dunson (2011) &lt;<a href="https://doi.org/10.1198%2Fjasa.2011.tm10552">doi:10.1198/jasa.2011.tm10552</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-12-12 16:48:54 UTC; tony</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-12-13 11:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='dp.post.est'>
Posterior probability mass function estimation with DP prior
</h2><span id='topic+dp.post.est'></span>

<h3>Description</h3>

<p>Performs Bayesian probability mass function estimation under DP prior with Poisson base measure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dp.post.est(x, y, alpha, lambda)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dp.post.est_+3A_x">x</code></td>
<td>

<p>Values on which to compute the pmf.
</p>
</td></tr>
<tr><td><code id="dp.post.est_+3A_y">y</code></td>
<td>

<p>Vector of observed data.
</p>
</td></tr>
<tr><td><code id="dp.post.est_+3A_alpha">alpha</code></td>
<td>

<p>DP precision parameter
</p>
</td></tr>
<tr><td><code id="dp.post.est_+3A_lambda">lambda</code></td>
<td>

<p>Mean parameter for the Poisson base measure.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Performs probability mass function estimation under th following model
</p>
<p style="text-align: center;"><code class="reqn">y_i \mid P \sim  P, i=1, \dots, n</code>
</p>

<p style="text-align: center;"><code class="reqn">P \sim DP(\alpha, P_0),</code>
</p>

<p>where <code class="reqn">P_0</code> is Poisson with mean <code>lambda</code>.</p>


<h3>Value</h3>

<p>A vector of size <code>length(x)</code> containing the probability masses 
</p>


<h3>Author(s)</h3>

<p>Antonio Canale
</p>


<h3>References</h3>

<p>Carota, C., and Parmigiani, G. (2002), &ldquo;Semiparametric Regression for Count Data,&rdquo; <em>Biometrika</em>, <b>89</b>, 265&ndash;281.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ethylene)
y &lt;- tapply(ethylene$impl,FUN=mean,INDEX=ethylene$id)
z &lt;- tapply(ethylene$dose,FUN=mean,INDEX=ethylene$id)

# Estimate the pmf of the number of implants in the control group
y0  &lt;- y[z==0]
pmf.control = dp.post.est(0:30, y0, alpha = 1)
</code></pre>

<hr>
<h2 id='ethylene'>
Developmental toxicity study of ethylene glycol in mice
</h2><span id='topic+ethylene'></span>

<h3>Description</h3>

<p>Data from the developmental toxicity study of ethylene glycol in mice conducted by the National Toxicology Program. Pregnant mice were assigned to dose groups of 0, 750, 1,500 or 3,000 mg/kg per day, with the number of implants measured for each mouse at the end of the experiment. Group sizes are 25, 24, 23 and 23, respectively. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ethylene)</code></pre>


<h3>Format</h3>

<p>A data frame with 1192 observations on the following 7 variables.
</p>

<dl>
<dt><code>id</code></dt><dd><p>identifyer for pregnant mouse</p>
</dd>
<dt><code>dose</code></dt><dd><p>dose of ethylene glycol</p>
</dd>
<dt><code>weight</code></dt><dd><p>weight of the fetus</p>
</dd>
<dt><code>sex</code></dt><dd><p>sex of the fetus</p>
</dd>
<dt><code>impl</code></dt><dd><p>number of implants in the pregnant mouce</p>
</dd>
<dt><code>litsz</code></dt><dd><p>size of the relative litter</p>
</dd>
<dt><code>malf</code></dt><dd><p>presence of malformation in the fetus</p>
</dd>
</dl>



<h3>References</h3>

<p>Price, C. J., Kimmel, C. A., Tyl, R. W., and Marr, M. C.  (1985) &quot;The developemental toxicity of ethylene glycol in rats and mice&quot; <em>Toxicological and Applied Pharmacology</em> <b>81</b>, 113-127.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ethylene)
implants &lt;- tapply(ethylene$impl, FUN=mean, INDEX=ethylene$id)

summary(implants)
m &lt;- mean(implants)
v &lt;- var(implants)
hist(implants, main=paste("Histogram of the number of implants (Mean = ",
round(m,2), ", Var = ", round(v,2),")"))
</code></pre>

<hr>
<h2 id='npmp'>
DP mixtures of Poissons
</h2><span id='topic+dpmpoiss'></span><span id='topic+npmp'></span>

<h3>Description</h3>

<p>Performs probability mass function estimation under nonparametric mixture of Poisson kernels. </p>


<h3>Usage</h3>

<pre><code class='language-R'>npmp(y, k, nrep, nb, alpha=1, theta=alpha, sigma=0, 
mixing_hyperprior= FALSE, basemeasure_hyperprior = FALSE, mixing_type="DP", 
algo="slice",  prior="gamma", a, b, a_a=1, b_a=1, lb=NULL, ub=NULL, 
print = 1, ndisplay = nrep/4, plot.it = FALSE, pdfwrite = FALSE, ... )

dpmpoiss(y, k, nrep, nb, alpha = 1, a, b, lb = NULL, ub = NULL, print = 1,
ndisplay = nrep/4, plot.it = FALSE, pdfwrite = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="npmp_+3A_y">y</code></td>
<td>

<p>Vector of count data
</p>
</td></tr>
<tr><td><code id="npmp_+3A_k">k</code></td>
<td>

<p>Truncation level for the number of cluster in the mixture. Default is <code>length(ydis)</code>.
</p>
</td></tr>
<tr><td><code id="npmp_+3A_nrep">nrep</code></td>
<td>

<p>Number of MCMC iterations
</p>
</td></tr>
<tr><td><code id="npmp_+3A_nb">nb</code></td>
<td>

<p>Number of burn-in iteration in the MCMC to discard
</p>
</td></tr>
<tr><td><code id="npmp_+3A_alpha">alpha</code></td>
<td>

<p>Value of the precision parameter of the Dirichlet process prior
</p>
</td></tr>
<tr><td><code id="npmp_+3A_theta">theta</code></td>
<td>

<p>Value of the strength parameter of the Two-parameters-Poisson-Dirichlet process prior
</p>
</td></tr>
<tr><td><code id="npmp_+3A_sigma">sigma</code></td>
<td>

<p>Value of the discount parameter of the Two-parameters-Poisson-Dirichlet process prior
</p>
</td></tr>
<tr><td><code id="npmp_+3A_mixing_hyperprior">mixing_hyperprior</code></td>
<td>

<p>Logical. If TRUE <code>alpha</code> is random with gamma hyperprior
</p>
</td></tr>
<tr><td><code id="npmp_+3A_basemeasure_hyperprior">basemeasure_hyperprior</code></td>
<td>

<p>Logical. If TRUE also the parameters of the base measure are random, see details below.
</p>
</td></tr>
<tr><td><code id="npmp_+3A_mixing_type">mixing_type</code></td>
<td>

<p>Type of mixing distribution. Default is &quot;DP&quot; for Dirichlet process but also &quot;2PD&quot; for Two-parameters-Poisson-Dirichlet process is allowed.
</p>
</td></tr>
<tr><td><code id="npmp_+3A_algo">algo</code></td>
<td>

<p>Type of algorithm. Current choices are: slice sampler (<code>algo="slice"</code>) or polya-urn-type sampler (<code>algo="polya-urn"</code>).
</p>
</td></tr>
<tr><td><code id="npmp_+3A_prior">prior</code></td>
<td>

<p>String for the base measure prior. Default is &quot;gamma&quot; for lambda ~ Gamma(a,b). The other choice is &quot;normal&quot; for exp(lambda) ~ N(a,b)</p>
</td></tr>
<tr><td><code id="npmp_+3A_a">a</code></td>
<td>

<p>Shape (mean) hyperparameter for the gamma (normal) base measure 
</p>
</td></tr>
<tr><td><code id="npmp_+3A_b">b</code></td>
<td>

<p>Scale (sd) hyperparameter for the gamma (normal) prior
</p>
</td></tr>
<tr><td><code id="npmp_+3A_a_a">a_a</code></td>
<td>

<p>Shape hyperparameter for <code>alpha</code>
</p>
</td></tr>
<tr><td><code id="npmp_+3A_b_a">b_a</code></td>
<td>

<p>Scale  hyperparameter for <code>alpha</code>
</p>
</td></tr>
<tr><td><code id="npmp_+3A_lb">lb</code></td>
<td>

<p>Scalar integer. Lower bound for the argument of the pmf. Default is <code>max(0,min(ydis)-10)</code>.
</p>
</td></tr>
<tr><td><code id="npmp_+3A_ub">ub</code></td>
<td>

<p>Scalar integer. Upper bound for the argument of the pmf. Default is <code>max(ydis)+10</code>.
</p>
</td></tr>
<tr><td><code id="npmp_+3A_print">print</code></td>
<td>

<p>Vector of integers (from 1 to 5) indicating whether to print each step of the Gibbs sampler.  Specifically, 1 for current iteration, 2 for the DP cluster allocation, 3 for the posterior parameters of the mixture components, 4 for the precision of the DP, 5 for the posterior pmf.
</p>
</td></tr>
<tr><td><code id="npmp_+3A_ndisplay">ndisplay</code></td>
<td>

<p>Scalar integer. It gives the number of iterations to be displayed on screen (the function reports on the screen when every <code>ndisplay</code> iterations have been carried out)
</p>
</td></tr>
<tr><td><code id="npmp_+3A_plot.it">plot.it</code></td>
<td>

<p>Logical, default FALSE. If TRUE a plot with empirical and estimated posterior probability mass functions is plotted.
</p>
</td></tr>
<tr><td><code id="npmp_+3A_pdfwrite">pdfwrite</code></td>
<td>

<p>Logical, default FALSE. If TRUE a pdf file is written in the current working directory. Traceplots and other posterior quantities are drown.
</p>
</td></tr>
<tr><td><code id="npmp_+3A_...">...</code></td>
<td>

<p>Additional arguments (for future implemetantions).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>npmp</code> performs probability mass function estimation under nonparametric mixture of Poisson kernels, i.e.
</p>
<p style="text-align: center;"><code class="reqn">y_i \mid \lambda_i \sim  \mbox{Poi}(\lambda_i), i=1, \dots, n</code>
</p>

<p style="text-align: center;"><code class="reqn">\lambda_i \mid G \sim G</code>
</p>

<p style="text-align: center;"><code class="reqn">G \sim \Pi(P_0),</code>
</p>

<p>where <code class="reqn">\Pi</code> is a nonparametric prior (Dirichlet process or Two-parameters-Poisson-Dirichlet process) with base measure <code class="reqn">P_0</code>. The function <code>dppoiss</code> is a wrapper to <code>npmp</code> with <code>mixing_type="DP"</code> for back portability with version 1.0 of the package. The main part of the code is written in C language to gain computational speed. Plots and posterior summaries are in plain R code. From version 2.0 on, the blocked Gibbs sampler has been removed in place of slice samper (Kalli et al., 2011) and polya-urn sampler. Two different base measures <code class="reqn">P_0</code> are implemented: <code>prior="gamma"</code> and <code>prior="normal"</code> for 
</p>
<p style="text-align: center;"><code class="reqn">
\lambda_h \sim \mbox{Gamma}(a,b), \log(\lambda_h) \sim N(a,b), h=1,\dots
</code>
</p>

<p>respectively.</p>


<h3>Value</h3>

<table>
<tr><td><code>name</code></td>
<td>
<p>Name of the model</p>
</td></tr>
<tr><td><code>mixing_type</code></td>
<td>
<p>Name of the mixing prior</p>
</td></tr>
<tr><td><code>mcmc</code></td>
<td>
<p>Quantities about MCMC sampling</p>
</td></tr>
<tr><td><code>mcmc.chains</code></td>
<td>
<p>MCMC chains of the parameters</p>
</td></tr>
<tr><td><code>pmf</code></td>
<td>
<p>A list containing several quantities related to the probability mass function (emprical pmf, posterior mean pmf and pointwise 95% credible intervals) computed for the values from <code>lb</code> to <code>ub</code></p>
</td></tr>
<tr><td><code>parameters</code></td>
<td>
<p>A list containing the posterior mean of the cluster specific parameters (be careful of label-switching problems)</p>
</td></tr>
<tr><td><code>clustering</code></td>
<td>
<p>A list containing posterior quantities related to the clustering structure of the data</p>
</td></tr> 
</table>


<h3>Author(s)</h3>

<p>R code and porting by A. Canale, C code by A. Canale with minor contributions by N. Lunardon. 
</p>


<h3>References</h3>

<p>Canale, A. and Dunson, D. B. (2011), &quot;Bayesian Kernel Mixtures for Counts&quot;, <em>Journal of American Statistical Association</em>, <b>106</b>, 1528-1539.
</p>
<p>Kalli, M., Griffin, J., and Walker, S. (2011), &quot;Slice sampling mixture models,&quot; Statistics and Computing, <b>21</b>, 93-105.
</p>


<h3>See Also</h3>

<p>rmg
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(ethylene)
y &lt;- tapply(ethylene$impl,FUN=mean,INDEX=ethylene$id)
z &lt;- tapply(ethylene$dose,FUN=mean,INDEX=ethylene$id)

# Estimate the pmf of the number of implants in the control group
y0  &lt;- y[z==0]
pmf.control = dpmpoiss(y0, k=20, nrep=11000, nb=1000, alpha=1, a=1, b=1,
lb=5, ub=24, plot.it=TRUE)

</code></pre>

<hr>
<h2 id='rmg'>
Nonparametric mixture of rounded Gaussians
</h2><span id='topic+dpmrg'></span><span id='topic+rmg'></span>

<h3>Description</h3>

<p>Performs Bayesian probability mass function estimation under nonparametric mixture of rounded of Gaussian kernels.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rmg(ydis, k=length(ydis), nrep, nb, alpha=1, theta=alpha, sigma=0, 
mixing_hyperprior= FALSE, basemeasure_hyperprior = FALSE, mixing_type="DP", algo="slice",
mu0=mean(ydis), kap=var(ydis), 
atau=1, btau=2, a_a=1, b_a=1, lb=NULL, ub=NULL, print = 1, ndisplay = nrep/4,
plot.it = FALSE, pdfwrite = FALSE, ...)

dpmrg(ydis, k, nrep, nb, alpha, alpha_r = FALSE, mu0 = mean(ydis), kap = var(ydis), 
atau, btau, a_a = 1, b_a = 1, lb = NULL, ub = NULL, 
print = 1, ndisplay = nrep/4, 
plot.it = FALSE, pdfwrite = FALSE, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rmg_+3A_ydis">ydis</code></td>
<td>

<p>Vector of count data
</p>
</td></tr>
<tr><td><code id="rmg_+3A_k">k</code></td>
<td>

<p>Truncation level for the number of cluster in the mixture. Default is <code>length(ydis)</code>.
</p>
</td></tr>
<tr><td><code id="rmg_+3A_nrep">nrep</code></td>
<td>

<p>Number of MCMC iterations
</p>
</td></tr>
<tr><td><code id="rmg_+3A_nb">nb</code></td>
<td>

<p>Number of burn-in iteration in the MCMC to discard
</p>
</td></tr>
<tr><td><code id="rmg_+3A_alpha">alpha</code></td>
<td>

<p>Value of the precision parameter of the Dirichlet process prior
</p>
</td></tr>
<tr><td><code id="rmg_+3A_theta">theta</code></td>
<td>

<p>Value of the strength parameter of the Two-parameters-Poisson-Dirichlet process prior
</p>
</td></tr>
<tr><td><code id="rmg_+3A_sigma">sigma</code></td>
<td>

<p>Value of the discount parameter of the Two-parameters-Poisson-Dirichlet process prior
</p>
</td></tr>
<tr><td><code id="rmg_+3A_mixing_hyperprior">mixing_hyperprior</code></td>
<td>

<p>Logical. If TRUE <code>alpha</code> is random with gamma hyperprior
</p>
</td></tr>
<tr><td><code id="rmg_+3A_alpha_r">alpha_r</code></td>
<td>

<p>Logical. If TRUE <code>alpha</code> is random with gamma hyperprior
</p>
</td></tr>
<tr><td><code id="rmg_+3A_basemeasure_hyperprior">basemeasure_hyperprior</code></td>
<td>

<p>Logical. If TRUE also the parameters of the base measure are random, see details below.
</p>
</td></tr>
<tr><td><code id="rmg_+3A_mixing_type">mixing_type</code></td>
<td>

<p>Type of mixing distribution. Default is &quot;DP&quot; for Dirichlet process but also &quot;2PD&quot; for Two-parameters-Poisson-Dirichlet process is allowed.
</p>
</td></tr>
<tr><td><code id="rmg_+3A_algo">algo</code></td>
<td>

<p>Type of algorithm. Current choices are: slice sampler (<code>algo="slice"</code>) or polya-urn-type sampler (<code>algo="polya-urn"</code>).
</p>
</td></tr>
<tr><td><code id="rmg_+3A_mu0">mu0</code></td>
<td>

<p>Location hyperparameter for the latent rounded Gaussian base measure
</p>
</td></tr>
<tr><td><code id="rmg_+3A_kap">kap</code></td>
<td>

<p>Precision hyperparameter for the latent rounded Gaussian base measure
</p>
</td></tr>
<tr><td><code id="rmg_+3A_atau">atau</code></td>
<td>

<p>Shape hyperparameter for the Gamma distribution
</p>
</td></tr>
<tr><td><code id="rmg_+3A_btau">btau</code></td>
<td>

<p>Scale hyperparameter for the Gamma distribution 
</p>
</td></tr>
<tr><td><code id="rmg_+3A_a_a">a_a</code></td>
<td>

<p>Shape hyperparameter for the Gamma distribution for <code>alpha</code> 
</p>
</td></tr>
<tr><td><code id="rmg_+3A_b_a">b_a</code></td>
<td>

<p>Scale hyperparameter for the Gamma distribution for <code>alpha</code> 
</p>
</td></tr>
<tr><td><code id="rmg_+3A_lb">lb</code></td>
<td>

<p>Scalar integer. Lower bound for the argument of the pmf. Default is <code>max(0,min(ydis)-10)</code>.
</p>
</td></tr>
<tr><td><code id="rmg_+3A_ub">ub</code></td>
<td>

<p>Scalar integer. Upper bound for the argument of the pmf. Default is <code>max(ydis)+10</code>.
</p>
</td></tr>
<tr><td><code id="rmg_+3A_print">print</code></td>
<td>

<p>Vector of integers (from 1 to 6) indicating whether to print each step of the Gibbs sampler.  Specifically, 1 for current iteration, 2 for the data augmentation step simulating the latent continuous variables, 3 for the DP cluster allocation, 4 for the posterior parameters of the mixture components, 5 for the precision of the DP, 6 for the posterior pmf.
</p>
</td></tr>
<tr><td><code id="rmg_+3A_ndisplay">ndisplay</code></td>
<td>

<p>Scalar integer. It gives the number of iterations to be displayed on screen (the function reports on the screen when every <code>ndisplay</code> iterations have been carried out)
</p>
</td></tr>
<tr><td><code id="rmg_+3A_plot.it">plot.it</code></td>
<td>

<p>Logical, default FALSE. If TRUE a plot with empirical and estimated posterior probability mass functions is plotted.
</p>
</td></tr>
<tr><td><code id="rmg_+3A_pdfwrite">pdfwrite</code></td>
<td>

<p>Logical, default FALSE. If TRUE a pdf file is written in the current working directory. Traceplots and other posterior quantities are drown.
</p>
</td></tr>
<tr><td><code id="rmg_+3A_...">...</code></td>
<td>

<p>Additional arguments (for future implemetantions).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>rmg</code> function performs Bayesian probability mass function estimation under the mixture model of Canale and Dunson (2011) with Dirichlet process or Two-parameters-Poisson-Dirichlet process as prior for the mixing measure. The model is
</p>
<p style="text-align: center;"><code class="reqn">y_i \mid \mu_i, \tau_i \sim  \mbox{RG}(\mu_i, \tau_i), i=1, \dots, n</code>
</p>

<p style="text-align: center;"><code class="reqn">(\mu_i, \tau_i) \mid G \sim G</code>
</p>

<p style="text-align: center;"><code class="reqn">G \sim \Pi(P_0),</code>
</p>

<p>where <code class="reqn">\Pi</code> is the Dirichlet process or the Two-parameters-Poisson-Dirichlet process with base measure <code class="reqn">P_0</code> and <code class="reqn">RG(\mu, \tau)</code> is a rounded Gaussian kernel with location <code class="reqn">\mu</code> and precision <code class="reqn">\tau</code> and tresholds <code class="reqn">-\infty, 1, 2, \dots</code>.
The function <code>dpmrg</code> is a wrapper to <code>rmg</code> with <code>mixing_type="DP"</code> for back portability with version 1.0 of the package.
The main part of the code is written in C language to gain computational speed. Plots and posterior summaries are in plain R code. From version 2.0 on, the blocked gibbs sampler has been removed in place of slice samper (Kalli et al., 2011) and polya-urn sampler.
</p>


<h3>Value</h3>

<table>
<tr><td><code>name</code></td>
<td>
<p>Name of the model</p>
</td></tr>
<tr><td><code>mixing_type</code></td>
<td>
<p>Name of the mixing prior</p>
</td></tr>
<tr><td><code>mcmc</code></td>
<td>
<p>Quantities about MCMC sampling</p>
</td></tr>
<tr><td><code>mcmc.chains</code></td>
<td>
<p>MCMC chains of the parameters</p>
</td></tr>
<tr><td><code>pmf</code></td>
<td>
<p>A list containing several quantities related to the probability mass function (emprical pmf, posterior mean pmf and pointwise 95% credible intervals) computed for the values from <code>lb</code> to <code>ub</code></p>
</td></tr>
<tr><td><code>parameters</code></td>
<td>
<p>A list containing the posterior mean of the cluster specific parameters (be careful of label-switching problems)</p>
</td></tr>
<tr><td><code>clustering</code></td>
<td>
<p>A list containing posterior quantities related to the clustering structure of the data</p>
</td></tr> 
</table>


<h3>Author(s)</h3>

<p>R code and porting by A. Canale, C code by A. Canale with minor contributions by N. Lunardon. 
</p>


<h3>References</h3>

<p>Canale, A. and Dunson, D. B. (2011), &quot;Bayesian Kernel Mixtures for Counts&quot;, <em>Journal of American Statistical Association</em>, <b>106</b>, 1528-1539.
</p>
<p>Kalli, M., Griffin, J., and Walker, S. (2011), &quot;Slice sampling mixture models,&quot; Statistics and Computing, <b>21</b>, 93-105.
</p>


<h3>See Also</h3>

<p>dpmpoiss
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(ethylene)
y &lt;- tapply(ethylene$impl,FUN=mean,INDEX=ethylene$id)
z &lt;- tapply(ethylene$dose,FUN=mean,INDEX=ethylene$id)

# Estimate the pmf of the number of implants in the control group
y0  &lt;- y[z==0]
pmf.control = rmg(y0, k=20, nrep=11000, nb=1000, alpha=1, atau=1, btau=1,
lb=5, ub=24, plot.it= TRUE)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
