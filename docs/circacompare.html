<!DOCTYPE html><html><head><title>Help for package circacompare</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {circacompare}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#circa_single'><p>circa_single</p></a></li>
<li><a href='#circa_single_mixed'><p>circa_single_mixed</p></a></li>
<li><a href='#circacompare'><p>circacompare</p></a></li>
<li><a href='#circacompare_mixed'><p>circacompare_mixed</p></a></li>
<li><a href='#make_data'><p>make_data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Analyses of Circadian Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Uses non-linear regression to statistically compare two circadian rhythms.
    Groups are only compared if both are rhythmic (amplitude is non-zero).
    Performs analyses regarding mesor, phase, and amplitude, reporting on estimates and statistical differences, for each, between groups.
    Details can be found in Parsons et al (2020) &lt;<a href="https://doi.org/10.1093%2Fbioinformatics%2Fbtz730">doi:10.1093/bioinformatics/btz730</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2 (&ge; 2.2.1), stats, withr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0), nlme, knitr, rmarkdown</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://rwparsons.github.io/circacompare/">https://rwparsons.github.io/circacompare/</a></td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-09 20:45:58 UTC; RexParsons</td>
</tr>
<tr>
<td>Author:</td>
<td>Rex Parsons <a href="https://orcid.org/0000-0002-6053-8174"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre],
  Alexander Bender [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Rex Parsons &lt;Rex.Parsons94@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-09 21:43:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='circa_single'>circa_single</h2><span id='topic+circa_single'></span>

<h3>Description</h3>

<p><code>circa_single</code> performs an analysis on a single rhythmic dataset. It estimates the mesor, amplitude and phase of the data provided.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>circa_single(
  x,
  col_time,
  col_outcome,
  period = 24,
  alpha_threshold = 0.05,
  timeout_n = 10000,
  return_figure = TRUE,
  control = list(),
  weights = NULL,
  suppress_all = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="circa_single_+3A_x">x</code></td>
<td>
<p>data.frame.  This is the data.frame which contains the rhythmic data in a tidy format.</p>
</td></tr>
<tr><td><code id="circa_single_+3A_col_time">col_time</code></td>
<td>
<p>The name of the column within the data.frame, x, which contains time in hours at which the data were collected.</p>
</td></tr>
<tr><td><code id="circa_single_+3A_col_outcome">col_outcome</code></td>
<td>
<p>The name of the column within the data.frame, x, which contains outcome measure of interest.</p>
</td></tr>
<tr><td><code id="circa_single_+3A_period">period</code></td>
<td>
<p>The period of the rhythm. For circadian rhythms, leave this as the default value, 24.</p>
</td></tr>
<tr><td><code id="circa_single_+3A_alpha_threshold">alpha_threshold</code></td>
<td>
<p>The level of alpha for which the presence of rhythmicity is considered. Default is 0.05.</p>
</td></tr>
<tr><td><code id="circa_single_+3A_timeout_n">timeout_n</code></td>
<td>
<p>The upper limit for the model fitting attempts. Default is 10,000.</p>
</td></tr>
<tr><td><code id="circa_single_+3A_return_figure">return_figure</code></td>
<td>
<p>Whether or not to return a ggplot graph of the rhythm and cosine model.</p>
</td></tr>
<tr><td><code id="circa_single_+3A_control">control</code></td>
<td>
<p><code>list</code>. Used to control the parameterization of the model.</p>
</td></tr>
<tr><td><code id="circa_single_+3A_weights">weights</code></td>
<td>
<p>An optional numeric vector of (fixed) weights. When present, the objective function is weighted least squares.</p>
</td></tr>
<tr><td><code id="circa_single_+3A_suppress_all">suppress_all</code></td>
<td>
<p>Logical. Set to <code>TRUE</code> to avoid seeing errors or messages during model fitting procedure. Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list
</p>


<h3>Examples</h3>

<pre><code class='language-R'>df &lt;- make_data()
df &lt;- df[df$group == "g1", ]
out &lt;- circa_single(x = df, col_time = "time", col_outcome = "measure")
out

# with sample weights (arbitrary weights for demonstration)
sw &lt;- runif(n = nrow(df))
out2 &lt;- circa_single(
  x = df,
  col_time = "time",
  col_outcome = "measure",
  weights = sw,
  suppress_all = TRUE
)
out2

</code></pre>

<hr>
<h2 id='circa_single_mixed'>circa_single_mixed</h2><span id='topic+circa_single_mixed'></span>

<h3>Description</h3>

<p><code>circa_single_mixed</code> is similar to <code>circa_single</code> but allows for some simple, user-specified random-effects on the rhythmic parameters of choice.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>circa_single_mixed(
  x,
  col_time,
  col_outcome,
  col_id,
  randomeffects = c("k", "alpha", "phi"),
  period = 24,
  alpha_threshold = 0.05,
  nlme_control = list(),
  nlme_method = "ML",
  weights = NULL,
  suppress_all = FALSE,
  timeout_n = 10000,
  return_figure = TRUE,
  control = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="circa_single_mixed_+3A_x">x</code></td>
<td>
<p>data.frame.  This is the data.frame which contains the rhythmic data in a tidy format.</p>
</td></tr>
<tr><td><code id="circa_single_mixed_+3A_col_time">col_time</code></td>
<td>
<p>The name of the column within the data.frame, x, which contains time in hours at which the data were collected.</p>
</td></tr>
<tr><td><code id="circa_single_mixed_+3A_col_outcome">col_outcome</code></td>
<td>
<p>The name of the column within the data.frame, x, which contains outcome measure of interest.</p>
</td></tr>
<tr><td><code id="circa_single_mixed_+3A_col_id">col_id</code></td>
<td>
<p>The name of the column within the data.frame, <code>x</code>, which contains the identifying values for the random effect, such as <code>subject_id</code>.</p>
</td></tr>
<tr><td><code id="circa_single_mixed_+3A_randomeffects">randomeffects</code></td>
<td>
<p>which rhythmic parameters to allow random effects. The default is to include all rhythmic parameters.</p>
</td></tr>
<tr><td><code id="circa_single_mixed_+3A_period">period</code></td>
<td>
<p>The period of the rhythm. For circadian rhythms, leave this as the default value, <code>24</code>.</p>
</td></tr>
<tr><td><code id="circa_single_mixed_+3A_alpha_threshold">alpha_threshold</code></td>
<td>
<p>The level of alpha for which the presence of rhythmicity is considered. Default is to <code>0.05</code>.</p>
</td></tr>
<tr><td><code id="circa_single_mixed_+3A_nlme_control">nlme_control</code></td>
<td>
<p>A list of control values for the estimation algorithm to replace the default values returned by the function nlme::nlmeControl. Defaults to an empty list.</p>
</td></tr>
<tr><td><code id="circa_single_mixed_+3A_nlme_method">nlme_method</code></td>
<td>
<p>A character string. If &quot;REML&quot; the model is fit by maximizing the restricted log-likelihood. If &quot;ML&quot; the log-likelihood is maximized. Defaults to &quot;ML&quot;.</p>
</td></tr>
<tr><td><code id="circa_single_mixed_+3A_weights">weights</code></td>
<td>
<p>An optional numeric vector of (fixed) weights internally passed to <code>nlme::nlme()</code> via <code>nlme::varPower()</code>.
When present, the objective function is weighted least squares.</p>
</td></tr>
<tr><td><code id="circa_single_mixed_+3A_suppress_all">suppress_all</code></td>
<td>
<p>Logical. Set to <code>TRUE</code> to avoid seeing errors or messages during model fitting procedure. Default is <code>FALSE</code>. If <code>FALSE</code>, also runs <code>nlme()</code> with <code>verbose = TRUE</code>.</p>
</td></tr>
<tr><td><code id="circa_single_mixed_+3A_timeout_n">timeout_n</code></td>
<td>
<p>The upper limit for the model fitting attempts. Default is <code>10000</code>.</p>
</td></tr>
<tr><td><code id="circa_single_mixed_+3A_return_figure">return_figure</code></td>
<td>
<p>Whether or not to return a ggplot graph of the rhythm and cosine model.</p>
</td></tr>
<tr><td><code id="circa_single_mixed_+3A_control">control</code></td>
<td>
<p><code>list</code>. Used to control the parameterization of the model.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(42)
mixed_data &lt;- function(n) {
  counter &lt;- 1
  for (i in 1:n) {
    x &lt;- make_data(k1 = rnorm(1, 10, 2), alpha1 = 0, phi1 = 0)
    x$id &lt;- counter
    counter &lt;- counter + 1
    if (i == 1) {
      res &lt;- x
    } else {
      res &lt;- rbind(res, x)
    }
  }
  return(res)
}
df &lt;- mixed_data(n = 50)
out &lt;- circa_single_mixed(
  x = df, col_time = "time", col_outcome = "measure",
  col_id = "id", randomeffects = c("k")
)

# with sample weights (arbitrary weights for demonstration)
sw &lt;- runif(n = nrow(df))
out2 &lt;- circa_single_mixed(
  x = df, col_time = "time", col_outcome = "measure",
  col_id = "id", randomeffects = c("k"), weights = sw
)

</code></pre>

<hr>
<h2 id='circacompare'>circacompare</h2><span id='topic+circacompare'></span>

<h3>Description</h3>

<p><code>circacompare</code> performs a comparison between two rhythmic groups of data. It tests for rhythmicity and then fits a nonlinear model with parametrization to estimate and statistically support differences in mesor, amplitude, and phase between groups.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>circacompare(
  x,
  col_time,
  col_group,
  col_outcome,
  period = 24,
  alpha_threshold = 0.05,
  timeout_n = 10000,
  control = list(),
  weights = NULL,
  suppress_all = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="circacompare_+3A_x">x</code></td>
<td>
<p>data.frame.  This is the data.frame which contains the rhythmic data for two groups in a tidy format.</p>
</td></tr>
<tr><td><code id="circacompare_+3A_col_time">col_time</code></td>
<td>
<p>The name of the column within the data.frame, x, which contains time in hours at which the data were collected.</p>
</td></tr>
<tr><td><code id="circacompare_+3A_col_group">col_group</code></td>
<td>
<p>The name of the column within the data.frame, x, which contains the grouping variable.  This should only have two levels.</p>
</td></tr>
<tr><td><code id="circacompare_+3A_col_outcome">col_outcome</code></td>
<td>
<p>The name of the column within the data.frame, x, which contains outcome measure of interest.</p>
</td></tr>
<tr><td><code id="circacompare_+3A_period">period</code></td>
<td>
<p>The period of the rhythm. For circadian rhythms, leave this as the default value, 24.</p>
</td></tr>
<tr><td><code id="circacompare_+3A_alpha_threshold">alpha_threshold</code></td>
<td>
<p>The level of alpha for which the presence of rhythmicity is considered. Default is 0.05.</p>
</td></tr>
<tr><td><code id="circacompare_+3A_timeout_n">timeout_n</code></td>
<td>
<p>The upper limit for the model fitting attempts. Default is 10,000.</p>
</td></tr>
<tr><td><code id="circacompare_+3A_control">control</code></td>
<td>
<p><code>list</code>. Used to control the parameterization of the model.</p>
</td></tr>
<tr><td><code id="circacompare_+3A_weights">weights</code></td>
<td>
<p>An optional numeric vector of (fixed) weights. When present, the objective function is weighted least squares.</p>
</td></tr>
<tr><td><code id="circacompare_+3A_suppress_all">suppress_all</code></td>
<td>
<p>Logical. Set to <code>TRUE</code> to avoid seeing errors or messages during model fitting procedure. Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list
</p>


<h3>Examples</h3>

<pre><code class='language-R'>df &lt;- make_data(phi1 = 6)
out &lt;- circacompare(
  x = df, col_time = "time", col_group = "group",
  col_outcome = "measure"
)
out

# with sample weights (arbitrary weights for demonstration)
sw &lt;- runif(n = nrow(df))
out2 &lt;- circacompare(
  x = df, col_time = "time", col_group = "group",
  col_outcome = "measure", weights = sw
)
out2

</code></pre>

<hr>
<h2 id='circacompare_mixed'>circacompare_mixed</h2><span id='topic+circacompare_mixed'></span>

<h3>Description</h3>

<p><code>circacompare_mixed</code> is similar to <code>circacompare</code> but allows for some simple, user-specified random-effects on the rhythmic parameters of choice.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>circacompare_mixed(
  x,
  col_time,
  col_group,
  col_outcome,
  col_id,
  randomeffects = c(),
  period = 24,
  alpha_threshold = 0.05,
  nlme_control = list(),
  nlme_method = "REML",
  weights = NULL,
  suppress_all = FALSE,
  timeout_n = 10000,
  control = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="circacompare_mixed_+3A_x">x</code></td>
<td>
<p><code>data.frame</code>.  This is the data.frame which contains the rhythmic data for two groups in a tidy format.</p>
</td></tr>
<tr><td><code id="circacompare_mixed_+3A_col_time">col_time</code></td>
<td>
<p>The name of the column within the data.frame, <code>x</code>, which contains time in hours at which the data were collected.</p>
</td></tr>
<tr><td><code id="circacompare_mixed_+3A_col_group">col_group</code></td>
<td>
<p>The name of the column within the data.frame, <code>x</code>, which contains the grouping variable.  This should only have two levels.</p>
</td></tr>
<tr><td><code id="circacompare_mixed_+3A_col_outcome">col_outcome</code></td>
<td>
<p>The name of the column within the data.frame, <code>x</code>, which contains outcome measure of interest.</p>
</td></tr>
<tr><td><code id="circacompare_mixed_+3A_col_id">col_id</code></td>
<td>
<p>The name of the column within the data.frame, <code>x</code>, which contains the identifying values for the random effect, such as <code>subject_id</code>.</p>
</td></tr>
<tr><td><code id="circacompare_mixed_+3A_randomeffects">randomeffects</code></td>
<td>
<p>which rhythmic parameters to allow random effects. The default is to include no rhythmic parameters.</p>
</td></tr>
<tr><td><code id="circacompare_mixed_+3A_period">period</code></td>
<td>
<p>The period of the rhythm. For circadian rhythms, leave this as the default value, <code>24</code>.</p>
</td></tr>
<tr><td><code id="circacompare_mixed_+3A_alpha_threshold">alpha_threshold</code></td>
<td>
<p>The level of alpha for which the presence of rhythmicity is considered. Default is to <code>0.05</code>.</p>
</td></tr>
<tr><td><code id="circacompare_mixed_+3A_nlme_control">nlme_control</code></td>
<td>
<p>A list of control values for the estimation algorithm to replace the default values returned by the function nlme::nlmeControl. Defaults to an empty list.</p>
</td></tr>
<tr><td><code id="circacompare_mixed_+3A_nlme_method">nlme_method</code></td>
<td>
<p>A character string. If &quot;REML&quot; the model is fit by maximizing the restricted log-likelihood. If &quot;ML&quot; the log-likelihood is maximized. Defaults to &quot;REML&quot;.</p>
</td></tr>
<tr><td><code id="circacompare_mixed_+3A_weights">weights</code></td>
<td>
<p>An optional numeric vector of (fixed) weights internally passed to <code>nlme::nlme()</code> via <code>nlme::varPower()</code>.
When present, the objective function is weighted least squares.</p>
</td></tr>
<tr><td><code id="circacompare_mixed_+3A_suppress_all">suppress_all</code></td>
<td>
<p>Logical. Set to <code>TRUE</code> to avoid seeing errors or messages during model fitting procedure. Default is <code>FALSE</code>. If <code>FALSE</code>, also runs <code>nlme()</code> with <code>verbose = TRUE</code>.</p>
</td></tr>
<tr><td><code id="circacompare_mixed_+3A_timeout_n">timeout_n</code></td>
<td>
<p>The upper limit for the model fitting attempts. Default is <code>10000</code>.</p>
</td></tr>
<tr><td><code id="circacompare_mixed_+3A_control">control</code></td>
<td>
<p><code>list</code>. Used to control the parameterization of the model.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate some data with within-id correlation for phase-shift (phi1)

set.seed(99)
phi1_in &lt;- 3.15

mixed_data &lt;- function(n) {
  counter &lt;- 1
  for (i in 1:n) {
    x &lt;- make_data(k1 = 0, alpha1 = 0, phi1 = rnorm(1, phi1_in, 0.5), hours = 72, noise_sd = 1)
    x$id &lt;- counter
    counter &lt;- counter + 1
    if (i == 1) {
      res &lt;- x
    } else {
      res &lt;- rbind(res, x)
    }
  }
  return(res)
}
df &lt;- mixed_data(20)
out &lt;- circacompare_mixed(
  x = df,
  col_time = "time",
  col_group = "group",
  col_outcome = "measure",
  col_id = "id",
  control = list(grouped_params = c("phi"), random_params = c("phi1"))
)

# with sample weights (arbitrary weights for demonstration)
sw &lt;- runif(n = nrow(df))
out2 &lt;- circacompare_mixed(
  x = df,
  col_time = "time",
  col_group = "group",
  col_outcome = "measure",
  col_id = "id",
  control = list(grouped_params = c("phi"), random_params = c("phi1")),
  weights = sw
)


</code></pre>

<hr>
<h2 id='make_data'>make_data</h2><span id='topic+make_data'></span>

<h3>Description</h3>

<p>Generate example circadian data with specified phase shift between groups
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_data(
  k = 0,
  k1 = 3,
  alpha = 10,
  alpha1 = 4,
  phi = 0,
  phi1 = 3.15,
  tau = 24,
  hours = 48,
  noise_sd = 0.1,
  seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make_data_+3A_k">k</code></td>
<td>
<p>mesor of group 1.</p>
</td></tr>
<tr><td><code id="make_data_+3A_k1">k1</code></td>
<td>
<p>change in mesor in group 2 from group 1.</p>
</td></tr>
<tr><td><code id="make_data_+3A_alpha">alpha</code></td>
<td>
<p>amplitude rhythm for group 1.</p>
</td></tr>
<tr><td><code id="make_data_+3A_alpha1">alpha1</code></td>
<td>
<p>change in amplitude in group 2 from group 1</p>
</td></tr>
<tr><td><code id="make_data_+3A_phi">phi</code></td>
<td>
<p>phase of rhythm, in radian-hours, in group 1.</p>
</td></tr>
<tr><td><code id="make_data_+3A_phi1">phi1</code></td>
<td>
<p>change in phase, in radian-hours, in group 2 from group 1</p>
</td></tr>
<tr><td><code id="make_data_+3A_tau">tau</code></td>
<td>
<p>period of the rhythm, shared between both groups.</p>
</td></tr>
<tr><td><code id="make_data_+3A_hours">hours</code></td>
<td>
<p>the number of hours/datapoints to sample.</p>
</td></tr>
<tr><td><code id="make_data_+3A_noise_sd">noise_sd</code></td>
<td>
<p>the standard deviation of the noise term.</p>
</td></tr>
<tr><td><code id="make_data_+3A_seed">seed</code></td>
<td>
<p>random seed for generating data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.frame
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- make_data(k1 = 3, alpha1 = 4, phi1 = 6)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
