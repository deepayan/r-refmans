<!DOCTYPE html><html><head><title>Help for package multilevLCA</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {multilevLCA}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#dataIEA'>
<p>Data for understanding of good citizenship behaviour</p></a></li>
<li><a href='#dataTOY'>
<p>Artificial data set</p></a></li>
<li><a href='#multiLCA'>
<p>Estimates and plots single- and multilevel latent class models</p></a></li>
<li><a href='#multilevLCA-package'>
<p>Estimates and Plots Single-Level and Multilevel Latent Class Models</p></a></li>
<li><a href='#plot.multiLCA'>
<p>Plots conditional response probabilities</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Version:</td>
<td>1.5</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-02-15</td>
</tr>
<tr>
<td>Title:</td>
<td>Estimates and Plots Single-Level and Multilevel Latent Class
Models</td>
</tr>
<tr>
<td>Description:</td>
<td>Efficiently estimates single- and multilevel latent class models with covariates, allowing for output visualization in all specifications. For more technical details, see Lyrvall et al (2023) &lt;<a href="https://arxiv.org/abs/2305.07276">arXiv:2305.07276</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0.9), magrittr, MASS, dplyr, tidyr, klaR, foreach,
parallel</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Author:</td>
<td>Roberto Di Mari [aut, cre],
  Johan Lyrvall [aut],
  Zsuzsa Bakk [ctb],
  Jennifer Oser [ctb],
  Jouni Kuha [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Roberto Di Mari &lt;roberto.dimari@unict.it&gt;</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-15 12:07:11 UTC; roberto</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-20 23:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='dataIEA'>
Data for understanding of good citizenship behaviour
</h2><span id='topic+dataIEA'></span>

<h3>Description</h3>

<p>Data set from the International Civic and Citizenship Education Study 2016 (Schulz et al., 2018). As part of a comprehensive evaluation of education systems, the IEA conducted surveys in 1999, 2009 and 2016 in school classes of 14-year olds to investigate civic education with the same scientific rigor as the evaluation of more traditional educational skills of language and mathematics. The present study focuses on the third wave of the survey that was conducted in 2016.
</p>
<p>Questions regarding citizenship norms in all three waves asked respondents to explain their understanding of what a good adult citizen is or does. The survey then lists a variety of activities for respondents to rate in terms of how important these activities are in order to be considered a good adult citizen. The twelve items range from obeying the law and voting in elections, to protecting the environment and defending human rights.
</p>
<p>Covariates included are customary determinants of citizenship norms from the literature at the individual-level of socio-economic measures and country-level measure of gross domestic product (GDP) per capita.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("dataIEA")</code></pre>


<h3>Format</h3>

<p>A data frame with 90221 observations on the following 28 variables.
</p>

<dl>
<dt><code>ICCS_year</code></dt><dd><p>Year of survey</p>
</dd>
<dt><code>COUNTRY</code></dt><dd><p>Country</p>
</dd>
<dt><code>IDSTUD</code></dt><dd><p>Study ID</p>
</dd>
<dt><code>TOTWGTS</code></dt><dd><p>Study weight</p>
</dd>
<dt><code>obey</code></dt><dd><p>Always obeying the law</p>
</dd>
<dt><code>rights</code></dt><dd><p>Taking part in activities promoting human rights</p>
</dd>
<dt><code>local</code></dt><dd><p>Participating in activities to benefit people in the local community</p>
</dd>
<dt><code>work</code></dt><dd><p>Working hard</p>
</dd>
<dt><code>envir</code></dt><dd><p>Taking part in activities to protect the environment</p>
</dd>
<dt><code>vote</code></dt><dd><p>Voting in every national election</p>
</dd>
<dt><code>history</code></dt><dd><p>Learning about the country's history</p>
</dd>
<dt><code>respect</code></dt><dd><p>Showing respect for government representatives</p>
</dd>
<dt><code>news</code></dt><dd><p>Following political issues in the newspaper, on the radio, on TV, or on the Internet</p>
</dd>
<dt><code>protest</code></dt><dd><p>Participating in peaceful protests against laws believed to be unjust</p>
</dd>
<dt><code>discuss</code></dt><dd><p>Engaging in political discussions</p>
</dd>
<dt><code>party</code></dt><dd><p>Joining a political party</p>
</dd>
<dt><code>female</code></dt><dd><p>Female</p>
</dd>
<dt><code>books</code></dt><dd><p>Number of books at home</p>
</dd>
<dt><code>edexp</code></dt><dd><p>Educational expectations</p>
</dd>
<dt><code>ed_mom</code></dt><dd><p>Mother education</p>
</dd>
<dt><code>ed_dad</code></dt><dd><p>Father education</p>
</dd>
<dt><code>nonnat_born</code></dt><dd><p>Non-native born</p>
</dd>
<dt><code>immigrantfam</code></dt><dd><p>Immigrant family</p>
</dd>
<dt><code>nonnat_lang</code></dt><dd><p>Non-native language level</p>
</dd>
<dt><code>gdp_constant</code></dt><dd><p>GDP</p>
</dd>
<dt><code>log_gdp_constant</code></dt><dd><p>Log GDP</p>
</dd>
<dt><code>gdp_currentusd</code></dt><dd><p>GDP in USD</p>
</dd>
<dt><code>log_gdp_currentusd</code></dt><dd><p>Log GDP in USD</p>
</dd>
</dl>



<h3>References</h3>

<p>Schulz, W., Ainley, J., Fraillon, J., Losito, B., Agrusti, G., &amp; Friedman, T. (2018). Becoming
citizens in a changing world: IEA International Civic and Citizenship Education Study 2016
international report. Springer.
</p>

<hr>
<h2 id='dataTOY'>
Artificial data set
</h2><span id='topic+dataTOY'></span>

<h3>Description</h3>

<p>Artificial multilevel data set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("dataTOY")</code></pre>


<h3>Format</h3>

<p>A data frame with 3000 observations on the following 13 variables.
</p>

<dl>
<dt><code>id_high</code></dt><dd><p>High-level id</p>
</dd>
<dt><code>Y_1</code></dt><dd><p>Indicator n.1</p>
</dd>
<dt><code>Y_2</code></dt><dd><p>Indicator n.2</p>
</dd>
<dt><code>Y_3</code></dt><dd><p>Indicator n.3</p>
</dd>
<dt><code>Y_4</code></dt><dd><p>Indicator n.4</p>
</dd>
<dt><code>Y_5</code></dt><dd><p>Indicator n.5</p>
</dd>
<dt><code>Y_6</code></dt><dd><p>Indicator n.6</p>
</dd>
<dt><code>Y_7</code></dt><dd><p>Indicator n.7</p>
</dd>
<dt><code>Y_8</code></dt><dd><p>Indicator n.8</p>
</dd>
<dt><code>Y_9</code></dt><dd><p>Indicator n.9</p>
</dd>
<dt><code>Y_10</code></dt><dd><p>Indicator n.10</p>
</dd>
<dt><code>Z_low</code></dt><dd><p>Continuous low-level covariate</p>
</dd>
<dt><code>Z_high</code></dt><dd><p>Continuous high-level covariate</p>
</dd>
</dl>



<h3>References</h3>

<p>Di Mari, Bakk, Z., R., Oser, J., &amp; Kuha, J. (2023). A two-step estimator for multilevel latent class analysis with covariates. Under review. Available from <a href="https://arxiv.org/abs/2303.06091">https://arxiv.org/abs/2303.06091</a>.
</p>

<hr>
<h2 id='multiLCA'>
Estimates and plots single- and multilevel latent class models
</h2><span id='topic+multiLCA'></span>

<h3>Description</h3>

<p>The <code>multiLCA</code> function in the <code>multilevLCA</code> package estimates single- and multilevel measurement and structural latent class models. Moreover, the function performs two different strategies for model selection. Methodological details can be found in Bakk et al. (2022), Bakk and Kuha (2018), and Di Mari et al. (2023).
</p>
<p>Different output visualization tools are available for all model specifications. See, e.g., <code><a href="#topic+plot.multiLCA">plot.multiLCA</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multiLCA(
data,
Y,
iT,
id_high = NULL,
iM = NULL,
Z = NULL,
Zh = NULL,
extout = FALSE,
dataout = TRUE,
kmea = TRUE,
sequential = TRUE,
numFreeCores = 2,
maxIter = 1e3,
tol = 1e-8,
reord = TRUE,
fixedpars = 1,
NRmaxit = 100,
NRtol = 1e-6,
verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="multiLCA_+3A_data">data</code></td>
<td>

<p>Input matrix or dataframe.
</p>
</td></tr>
<tr><td><code id="multiLCA_+3A_y">Y</code></td>
<td>

<p>Names of <code>data</code> columns with indicators.
</p>
</td></tr>
<tr><td><code id="multiLCA_+3A_it">iT</code></td>
<td>

<p>Number of lower-level latent classes.
</p>
</td></tr>
<tr><td><code id="multiLCA_+3A_id_high">id_high</code></td>
<td>

<p>Name of <code>data</code> column with higher-level id. Default: <code>NULL</code>.
</p>
</td></tr>
<tr><td><code id="multiLCA_+3A_im">iM</code></td>
<td>

<p>Number of higher-level latent classes. Default: <code>NULL</code>.
</p>
</td></tr>
<tr><td><code id="multiLCA_+3A_z">Z</code></td>
<td>

<p>Names of <code>data</code> columns with lower-level covariates (non-numeric covariates are treated as nominal). Default: <code>NULL</code>.
</p>
</td></tr>
<tr><td><code id="multiLCA_+3A_zh">Zh</code></td>
<td>

<p>Names of <code>data</code> columns with higher-level covariates (non-numeric covariates are treated as nominal). Default <code>NULL</code>
</p>
</td></tr>
<tr><td><code id="multiLCA_+3A_extout">extout</code></td>
<td>

<p>Whether to output extensive model and estimation information. Default: <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="multiLCA_+3A_dataout">dataout</code></td>
<td>

<p>Whether to match class predictions to the observed data. Default: <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="multiLCA_+3A_kmea">kmea</code></td>
<td>

<p>Whether to compute starting values for single-level model using <code class="reqn">K</code>-means (<code>TRUE</code>), which is recommended for algorithmic stability, or <code class="reqn">K</code>-modes (<code>FALSE</code>). Default: <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="multiLCA_+3A_sequential">sequential</code></td>
<td>

<p>Whether to perform sequential model selection (<code>TRUE</code>) or parallelized model selection (<code>FALSE</code>). Default: <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="multiLCA_+3A_numfreecores">numFreeCores</code></td>
<td>

<p>If performing parallelized model selection, the number of CPU cores to keep free. Default: <code>2</code>.
</p>
</td></tr>
<tr><td><code id="multiLCA_+3A_maxiter">maxIter</code></td>
<td>

<p>Maximum number of iterations for EM algorithm. Default: <code>1e3</code>.
</p>
</td></tr>
<tr><td><code id="multiLCA_+3A_tol">tol</code></td>
<td>

<p>Tolerance for EM algorithm. Default: <code>1e-8</code>.
</p>
</td></tr>
<tr><td><code id="multiLCA_+3A_reord">reord</code></td>
<td>

<p>Whether to (re)order classes in decreasing order according to probability of scoring yes on all items. Default: <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="multiLCA_+3A_fixedpars">fixedpars</code></td>
<td>

<p>One-step estimator (<code>0</code>), two-step estimator (<code>1</code>) or two-stage estimator (<code>2</code>). Default: <code>1</code>.
</p>
</td></tr>
<tr><td><code id="multiLCA_+3A_nrmaxit">NRmaxit</code></td>
<td>

<p>Maximum number of iterations for Newton-Raphson algorithm. Default: <code>100</code>.
</p>
</td></tr>
<tr><td><code id="multiLCA_+3A_nrtol">NRtol</code></td>
<td>

<p>Tolerance for Newton-Raphson algorithm. Default: <code>1e-6</code>.
</p>
</td></tr>
<tr><td><code id="multiLCA_+3A_verbose">verbose</code></td>
<td>

<p>Whether to print estimation progress. Default: <code>TRUE</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The indicator columns may be coded as as consecutive sequence of integers from 0, or as characters.
</p>
<p>To directly estimate a latent class model, <code>iT</code> and (optionally) <code>iM</code> should be specified as a single positive integer. To perform model selection over range of consecutive positive integers as the number of latent classes, <code>iT</code> and/or <code>iM</code> may be specified in the form <code>iT_min:iT_max</code> and/or <code>iM_min:iM_max</code>. It is possible to specify <code>iT = iT_min:iT_max</code> with either <code>iM = NULL</code> or <code>iM</code> equal to a single positive integer, <code>iM = iM_min:iM_max</code> with <code>iT</code> equal to a single positive integer, or <code>iT = iT_min:iT_max</code> with <code>iM = iM_min:iM_max</code>. All model selection procedures return the output of the optimal model based on the BIC.
</p>
<p>In the case where both <code>iT</code> and <code>iM</code> are defined as a range of consecutive positive integers, model selection can be performed using the sequential three-stage approach (Lukociene et al., 2010) or a simultaneous approach. The sequential approach involves (first step) estimating <code>iT_min:iT_max</code> single-level models and identifying the optimal alternative <code>iT_opt1</code> based on the BIC, (second step) estimating <code>iM_min:iM_max|iT = iT_opt1</code> multilevel models and identifying the optimal alternative <code>iM_opt2</code> based on the higher-level BIC, and (third step) estimating <code>iT_min:iT_max|iM = iM_opt2</code> multilevel models and identifying the optimal alternative <code>iT_opt3</code> based on the lower-level BIC. The simultaneous approach involves devoting multiple CPU cores on the local machine to estimate all combinations in <code>iT = iT_min:iT_max, iM = iM_min:iM_max</code> and identifying the optimal alternative based on the lower-level BIC.
</p>


<h3>Value</h3>

<p>Single-level model estimation returns (if <code>extout = TRUE</code>, a subset):
</p>
<table>
<tr><td><code>vPi</code></td>
<td>
<p>Class proportions</p>
</td></tr>
<tr><td><code>mPhi</code></td>
<td>
<p>Response probabilities given the latent classes</p>
</td></tr>
<tr><td><code>mU</code></td>
<td>
<p>Matrix of posterior class assignment (proportional assignment)</p>
</td></tr>
<tr><td><code>mU_modal</code></td>
<td>
<p>Matrix of posterior class assignment (modal assignment)</p>
</td></tr>
<tr><td><code>vU_modal</code></td>
<td>
<p>Vector of posterior class assignment (modal assignment)</p>
</td></tr>
<tr><td><code>mClassErr</code></td>
<td>
<p>Expected number of classification errors</p>
</td></tr>
<tr><td><code>mClassErrProb</code></td>
<td>
<p>Expected proportion of classification errors</p>
</td></tr>
<tr><td><code>AvgClassErrProb</code></td>
<td>
<p>Average of <code>mClassErrProb</code></p>
</td></tr>
<tr><td><code>R2entr</code></td>
<td>
<p>Entropy-based R<code class="reqn">^2</code></p>
</td></tr>
<tr><td><code>BIC</code></td>
<td>
<p>Bayesian Information Criterion (BIC)</p>
</td></tr>
<tr><td><code>AIC</code></td>
<td>
<p>Akaike Information Criterion (AIC)</p>
</td></tr>
<tr><td><code>vGamma</code></td>
<td>
<p>Intercepts in logistic parametrization for class proportions</p>
</td></tr>
<tr><td><code>mBeta</code></td>
<td>
<p>Intercepts in logistic parametrization for response probabilities</p>
</td></tr>
<tr><td><code>parvec</code></td>
<td>
<p>Vector of logistic parameters</p>
</td></tr>
<tr><td><code>SEs</code></td>
<td>
<p>Standard errors</p>
</td></tr>
<tr><td><code>Varmat</code></td>
<td>
<p>Variance-covariance matrix</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p>Number of iterations for EM algorithm</p>
</td></tr>
<tr><td><code>eps</code></td>
<td>
<p>Difference between last two elements of log-likelihood sequence for EM algorithm</p>
</td></tr>
<tr><td><code>LLKSeries</code></td>
<td>
<p>Full log-likelihood series for EM algorithm</p>
</td></tr>
<tr><td><code>mScore</code></td>
<td>
<p>Contributions to log-likelihood score</p>
</td></tr>
<tr><td><code>spec</code></td>
<td>
<p>Model specification</p>
</td></tr>
</table>
<p>Single-level model estimation with covariates returns (if <code>extout = TRUE</code>, a subset):
</p>
<table>
<tr><td><code>mPi</code></td>
<td>
<p>Class proportions given the covariates</p>
</td></tr>
<tr><td><code>vPi_avg</code></td>
<td>
<p>Sample average of <code>mPi</code></p>
</td></tr>
<tr><td><code>mPhi</code></td>
<td>
<p>Response probabilities given the latent classes</p>
</td></tr>
<tr><td><code>mU</code></td>
<td>
<p>Matrix of posterior class assignment (proportional assignment)</p>
</td></tr>
<tr><td><code>mClassErr</code></td>
<td>
<p>Expected number of classification errors</p>
</td></tr>
<tr><td><code>mClassErrProb</code></td>
<td>
<p>Expected proportion of classification errors</p>
</td></tr>
<tr><td><code>AvgClassErrProb</code></td>
<td>
<p>Average of <code>mClassErrProb</code></p>
</td></tr>
<tr><td><code>R2entr</code></td>
<td>
<p>Entropy-based R<code class="reqn">^2</code></p>
</td></tr>
<tr><td><code>BIC</code></td>
<td>
<p>Bayesian Information Criterion (BIC)</p>
</td></tr>
<tr><td><code>AIC</code></td>
<td>
<p>Akaike Information Criterion (AIC)</p>
</td></tr>
<tr><td><code>cGamma</code></td>
<td>
<p>Intercept and slope parameters in logistic models for conditional class membership</p>
</td></tr>
<tr><td><code>mBeta</code></td>
<td>
<p>Intercepts in logistic parametrization for response probabilities</p>
</td></tr>
<tr><td><code>parvec</code></td>
<td>
<p>Vector of logistic parameters</p>
</td></tr>
<tr><td><code>SEs_unc</code></td>
<td>
<p>Uncorrected standard errors</p>
</td></tr>
<tr><td><code>SEs_cor</code></td>
<td>
<p>Corrected standard errors</p>
</td></tr>
<tr><td><code>SEs_cor_gamma</code></td>
<td>
<p>Corrected standard errors only for the gammas</p>
</td></tr>
<tr><td><code>mQ</code></td>
<td>
<p>Cross-derivatives for asymptotic standard error correction in two-step estimation (see Bakk &amp; Kuha, 2018; Di Mari et al., 2023)</p>
</td></tr>
<tr><td><code>Varmat_unc</code></td>
<td>
<p>Uncorrected variance-covariance matrix</p>
</td></tr>
<tr><td><code>Varmat_cor</code></td>
<td>
<p>Corrected variance-covariance matrix</p>
</td></tr>
<tr><td><code>mV2</code></td>
<td>
<p>Inverse of information matrix for structural model</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p>Number of iterations for EM algorithm</p>
</td></tr>
<tr><td><code>eps</code></td>
<td>
<p>Difference between last two elements of log-likelihood sequence for EM algorithm</p>
</td></tr>
<tr><td><code>LLKSeries</code></td>
<td>
<p>Full log-likelihood series for EM algorithm</p>
</td></tr>
<tr><td><code>spec</code></td>
<td>
<p>Model specification</p>
</td></tr>
</table>
<p>Multilevel model estimation returns (if <code>extout = TRUE</code>, a subset):
</p>
<table>
<tr><td><code>vOmega</code></td>
<td>
<p>Higher-level class proportions</p>
</td></tr>
<tr><td><code>mPi</code></td>
<td>
<p>Lower-level class proportions given the higher-level latent classes</p>
</td></tr>
<tr><td><code>mPhi</code></td>
<td>
<p>Response probabilities given the lower-level latent classes</p>
</td></tr>
<tr><td><code>cPMX</code></td>
<td>
<p>Posterior joint class assignment (proportional assignment)</p>
</td></tr>
<tr><td><code>cLogPMX</code></td>
<td>
<p>Log of <code>cPMX</code></p>
</td></tr>
<tr><td><code>cPX</code></td>
<td>
<p>Posterior lower-level class assignment given high-level class membership (proportional assignment)</p>
</td></tr>
<tr><td><code>cLogPX</code></td>
<td>
<p>Log of <code>cPX</code></p>
</td></tr>
<tr><td><code>mSumPX</code></td>
<td>
<p>Posterior higher-level class assignment for lower-level units after marginalization over the lower-level classes (proportional assignment)</p>
</td></tr>
<tr><td><code>mPW</code></td>
<td>
<p>Posterior higher-level class assignment for higher-level units (proportional assignment)</p>
</td></tr>
<tr><td><code>mlogPW</code></td>
<td>
<p>Log of <code>mPW</code></p>
</td></tr>
<tr><td><code>mPW_N</code></td>
<td>
<p>Posterior higher-level class assignment for lower-level units (proportional assignment)</p>
</td></tr>
<tr><td><code>mPMsumX</code></td>
<td>
<p>Posterior lower-level class assignment for lower-level units after marginalization over the higher-level classes (proportional assignment)</p>
</td></tr>
<tr><td><code>R2entr_low</code></td>
<td>
<p>Lower-level entropy-based R<code class="reqn">^2</code></p>
</td></tr>
<tr><td><code>R2entr_high</code></td>
<td>
<p>Higher-level entropy-based R<code class="reqn">^2</code></p>
</td></tr>
<tr><td><code>BIClow</code></td>
<td>
<p>Lower-level Bayesian Information Criterion (BIC)</p>
</td></tr>
<tr><td><code>BIChigh</code></td>
<td>
<p>Higher-level Bayesian Information Criterion (BIC)</p>
</td></tr>
<tr><td><code>ICL_BIClow</code></td>
<td>
<p>Lower-level BIC-type approximation the integrated complete likelihood</p>
</td></tr>
<tr><td><code>ICL_BIChigh</code></td>
<td>
<p>Higher-level BIC-type approximation the integrated complete likelihood</p>
</td></tr>
<tr><td><code>AIC</code></td>
<td>
<p>Akaike Information Criterion (AIC)</p>
</td></tr>
<tr><td><code>vAlpha</code></td>
<td>
<p>Intercepts in logistic parametrization for higher-level class proportions</p>
</td></tr>
<tr><td><code>mGamma</code></td>
<td>
<p>Intercepts in logistic parametrization for conditional lower-level class proportions</p>
</td></tr>
<tr><td><code>mBeta</code></td>
<td>
<p>Intercepts in logistic parametrization for response probabilities</p>
</td></tr>
<tr><td><code>parvec</code></td>
<td>
<p>Vector of logistic parameters</p>
</td></tr>
<tr><td><code>SEs</code></td>
<td>
<p>Standard errors</p>
</td></tr>
<tr><td><code>Varmat</code></td>
<td>
<p>Variance-covariance matrix</p>
</td></tr>
<tr><td><code>Infomat</code></td>
<td>
<p>Expected information matrix</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p>Number of iterations for EM algorithm</p>
</td></tr>
<tr><td><code>eps</code></td>
<td>
<p>Difference between last two elements of log-likelihood sequence for EM algorithm</p>
</td></tr>
<tr><td><code>LLKSeries</code></td>
<td>
<p>Full log-likelihood series for EM algorithm</p>
</td></tr>
<tr><td><code>vLLK</code></td>
<td>
<p>Current log-likelihood for higher-level units</p>
</td></tr>
<tr><td><code>mScore</code></td>
<td>
<p>Contributions to log-likelihood score</p>
</td></tr>
<tr><td><code>spec</code></td>
<td>
<p>Model specification</p>
</td></tr>
</table>
<p>Multilevel model estimation with lower-level covariates returns (if <code>extout = TRUE</code>, a subset):
</p>
<table>
<tr><td><code>vOmega</code></td>
<td>
<p>Higher-level class proportions</p>
</td></tr>
<tr><td><code>mPi</code></td>
<td>
<p>Lower-level class proportions given the higher-level latent classes and the covariates</p>
</td></tr>
<tr><td><code>mPi_avg</code></td>
<td>
<p>Sample average of <code>mPi</code></p>
</td></tr>
<tr><td><code>mPhi</code></td>
<td>
<p>Response probabilities given the lower-level latent classes</p>
</td></tr>
<tr><td><code>cPMX</code></td>
<td>
<p>Posterior joint class assignment (proportional assignment)</p>
</td></tr>
<tr><td><code>cLogPMX</code></td>
<td>
<p>Log of <code>cPMX</code></p>
</td></tr>
<tr><td><code>cPX</code></td>
<td>
<p>Posterior lower-level class assignment given high-level class membership (proportional assignment)</p>
</td></tr>
<tr><td><code>cLogPX</code></td>
<td>
<p>Log of <code>cPX</code></p>
</td></tr>
<tr><td><code>mSumPX</code></td>
<td>
<p>Posterior higher-level class assignment for lower-level units after marginalization over the lower-level classes (proportional assignment)</p>
</td></tr>
<tr><td><code>mPW</code></td>
<td>
<p>Posterior higher-level class assignment for higher-level units (proportional assignment)</p>
</td></tr>
<tr><td><code>mlogPW</code></td>
<td>
<p>Log of <code>mPW</code></p>
</td></tr>
<tr><td><code>mPW_N</code></td>
<td>
<p>Posterior higher-level class assignment for lower-level units (proportional assignment)</p>
</td></tr>
<tr><td><code>mPMsumX</code></td>
<td>
<p>Posterior lower-level class assignment for lower-level units after marginalization over the higher-level classes (proportional assignment)</p>
</td></tr>
<tr><td><code>R2entr_low</code></td>
<td>
<p>Lower-level entropy-based R<code class="reqn">^2</code></p>
</td></tr>
<tr><td><code>R2entr_high</code></td>
<td>
<p>Higher-level entropy-based R<code class="reqn">^2</code></p>
</td></tr>
<tr><td><code>BIClow</code></td>
<td>
<p>Lower-level Bayesian Information Criterion (BIC)</p>
</td></tr>
<tr><td><code>BIChigh</code></td>
<td>
<p>Higher-level Bayesian Information Criterion (BIC)</p>
</td></tr>
<tr><td><code>ICL_BIClow</code></td>
<td>
<p>Lower-level BIC-type approximation the integrated complete likelihood</p>
</td></tr>
<tr><td><code>ICL_BIChigh</code></td>
<td>
<p>Higher-level BIC-type approximation the integrated complete likelihood</p>
</td></tr>
<tr><td><code>AIC</code></td>
<td>
<p>Akaike Information Criterion (AIC)</p>
</td></tr>
<tr><td><code>vAlpha</code></td>
<td>
<p>Intercepts in logistic parametrization for higher-level class proportions</p>
</td></tr>
<tr><td><code>cGamma</code></td>
<td>
<p>Intercept and slope parameters in logistic models for conditional lower-level class membership</p>
</td></tr>
<tr><td><code>mBeta</code></td>
<td>
<p>Intercepts in logistic parametrization for response probabilities</p>
</td></tr>
<tr><td><code>parvec</code></td>
<td>
<p>Vector of logistic parameters</p>
</td></tr>
<tr><td><code>SEs_unc</code></td>
<td>
<p>Uncorrected standard errors</p>
</td></tr>
<tr><td><code>SEs_cor</code></td>
<td>
<p>Corrected standard errors</p>
</td></tr>
<tr><td><code>SEs_cor_gamma</code></td>
<td>
<p>Corrected standard errors only for the gammas</p>
</td></tr>
<tr><td><code>mQ</code></td>
<td>
<p>Cross-derivatives for asymptotic standard error correction in two-step estimation (see Bakk &amp; Kuha, 2018; Di Mari et al., 2023)</p>
</td></tr>
<tr><td><code>Varmat_unc</code></td>
<td>
<p>Uncorrected variance-covariance matrix</p>
</td></tr>
<tr><td><code>Varmat_cor</code></td>
<td>
<p>Corrected variance-covariance matrix</p>
</td></tr>
<tr><td><code>Infomat</code></td>
<td>
<p>Expected information matrix</p>
</td></tr>
<tr><td><code>cGamma_Info</code></td>
<td>
<p>Expected information matrix only for the gammas</p>
</td></tr>
<tr><td><code>mV2</code></td>
<td>
<p>Inverse of information matrix for structural model</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p>Number of iterations for EM algorithm</p>
</td></tr>
<tr><td><code>eps</code></td>
<td>
<p>Difference between last two elements of log-likelihood sequence for EM algorithm</p>
</td></tr>
<tr><td><code>LLKSeries</code></td>
<td>
<p>Full log-likelihood series for EM algorithm</p>
</td></tr>
<tr><td><code>vLLK</code></td>
<td>
<p>Current log-likelihood for higher-level units</p>
</td></tr>
<tr><td><code>mScore</code></td>
<td>
<p>Contributions to log-likelihood score</p>
</td></tr>
<tr><td><code>mGamma_Score</code></td>
<td>
<p>Contributions to log-likelihood score only for the gammas</p>
</td></tr>
<tr><td><code>spec</code></td>
<td>
<p>Model specification</p>
</td></tr>
</table>
<p>Multilevel model estimation with lower- and higher-level covariates returns (if <code>extout = TRUE</code>, a subset):
</p>
<table>
<tr><td><code>mOmega</code></td>
<td>
<p>Higher-level class proportions given the covariates</p>
</td></tr>
<tr><td><code>vOmega_avg</code></td>
<td>
<p>Higher-level class proportions averaged over higher-level units</p>
</td></tr>
<tr><td><code>mPi</code></td>
<td>
<p>Lower-level class proportions given the higher-level latent classes and the covariates</p>
</td></tr>
<tr><td><code>mPi_avg</code></td>
<td>
<p>Sample average of <code>mPi</code></p>
</td></tr>
<tr><td><code>mPhi</code></td>
<td>
<p>Response probabilities given the lower-level latent classes</p>
</td></tr>
<tr><td><code>cPMX</code></td>
<td>
<p>Posterior joint class assignment (proportional assignment)</p>
</td></tr>
<tr><td><code>cLogPMX</code></td>
<td>
<p>Log of <code>cPMX</code></p>
</td></tr>
<tr><td><code>cPX</code></td>
<td>
<p>Posterior lower-level class assignment given high-level class membership (proportional assignment)</p>
</td></tr>
<tr><td><code>cLogPX</code></td>
<td>
<p>Log of <code>cPX</code></p>
</td></tr>
<tr><td><code>mSumPX</code></td>
<td>
<p>Posterior higher-level class assignment for lower-level units after marginalization over the lower-level classes (proportional assignment)</p>
</td></tr>
<tr><td><code>mPW</code></td>
<td>
<p>Posterior higher-level class assignment for higher-level units (proportional assignment)</p>
</td></tr>
<tr><td><code>mlogPW</code></td>
<td>
<p>Log of <code>mPW</code></p>
</td></tr>
<tr><td><code>mPW_N</code></td>
<td>
<p>Posterior higher-level class assignment for lower-level units (proportional assignment)</p>
</td></tr>
<tr><td><code>mPMsumX</code></td>
<td>
<p>Posterior lower-level class assignment for lower-level units after marginalization over the higher-level classes (proportional assignment)</p>
</td></tr>
<tr><td><code>R2entr_low</code></td>
<td>
<p>Lower-level entropy-based R<code class="reqn">^2</code></p>
</td></tr>
<tr><td><code>R2entr_high</code></td>
<td>
<p>Higher-level entropy-based R<code class="reqn">^2</code></p>
</td></tr>
<tr><td><code>BIClow</code></td>
<td>
<p>Lower-level Bayesian Information Criterion (BIC)</p>
</td></tr>
<tr><td><code>BIChigh</code></td>
<td>
<p>Higher-level Bayesian Information Criterion (BIC)</p>
</td></tr>
<tr><td><code>ICL_BIClow</code></td>
<td>
<p>Lower-level BIC-type approximation the integrated complete likelihood</p>
</td></tr>
<tr><td><code>ICL_BIChigh</code></td>
<td>
<p>Higher-level BIC-type approximation the integrated complete likelihood</p>
</td></tr>
<tr><td><code>AIC</code></td>
<td>
<p>Akaike Information Criterion (AIC)</p>
</td></tr>
<tr><td><code>mAlpha</code></td>
<td>
<p>Intercept and slope parameters in logistic models for conditional higher-level class membership</p>
</td></tr>
<tr><td><code>cGamma</code></td>
<td>
<p>Intercept and slope parameters in logistic models for conditional lower-level class membership</p>
</td></tr>
<tr><td><code>mBeta</code></td>
<td>
<p>Intercepts in logistic parametrization for response probabilities</p>
</td></tr>
<tr><td><code>parvec</code></td>
<td>
<p>Vector of logistic parameters</p>
</td></tr>
<tr><td><code>SEs_unc</code></td>
<td>
<p>Uncorrected standard errors</p>
</td></tr>
<tr><td><code>SEs_cor</code></td>
<td>
<p>Corrected standard errors</p>
</td></tr>
<tr><td><code>SEs_cor_alpha</code></td>
<td>
<p>Corrected standard errors only for the alphas</p>
</td></tr>
<tr><td><code>SEs_cor_gamma</code></td>
<td>
<p>Corrected standard errors only for the gammas</p>
</td></tr>
<tr><td><code>mQ</code></td>
<td>
<p>Cross-derivatives for asymptotic standard error correction in two-step estimation (see Bakk &amp; Kuha, 2018; Di Mari et al., 2023)</p>
</td></tr>
<tr><td><code>Varmat_unc</code></td>
<td>
<p>Uncorrected variance-covariance matrix</p>
</td></tr>
<tr><td><code>Varmat_cor</code></td>
<td>
<p>Corrected variance-covariance matrix</p>
</td></tr>
<tr><td><code>Infomat</code></td>
<td>
<p>Expected information matrix</p>
</td></tr>
<tr><td><code>cAlpha_Info</code></td>
<td>
<p>Expected information matrix only for the alphas</p>
</td></tr>
<tr><td><code>cGamma_Info</code></td>
<td>
<p>Expected information matrix only for the gammas</p>
</td></tr>
<tr><td><code>mV2</code></td>
<td>
<p>Inverse of information matrix for structural model</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p>Number of iterations for EM algorithm</p>
</td></tr>
<tr><td><code>eps</code></td>
<td>
<p>Difference between last two elements of log-likelihood sequence for EM algorithm</p>
</td></tr>
<tr><td><code>LLKSeries</code></td>
<td>
<p>Full log-likelihood series for EM algorithm</p>
</td></tr>
<tr><td><code>vLLK</code></td>
<td>
<p>Current log-likelihood for higher-level units</p>
</td></tr>
<tr><td><code>mScore</code></td>
<td>
<p>Contributions to log-likelihood score</p>
</td></tr>
<tr><td><code>mAlpha_Score</code></td>
<td>
<p>Contributions to log-likelihood score only for the alphas</p>
</td></tr>
<tr><td><code>mGamma_Score</code></td>
<td>
<p>Contributions to log-likelihood score only for the gammas</p>
</td></tr>
<tr><td><code>spec</code></td>
<td>
<p>Model specification</p>
</td></tr>
</table>


<h3>References</h3>

<p>Bakk, Z., &amp; Kuha, J. (2018). Two-step estimation of models between latent classes and external variables. <em>Psychometrika, 83, 871-892</em>.
</p>
<p>Bakk, Z., Di Mari, R., Oser, J., &amp; Kuha, J. (2022). Two-stage multilevel latent class analysis with covariates in the presence of direct effects. <em>Structural Equation Modeling: A Multidisciplinary Journal, 29(2), 267-277</em>.
</p>
<p>Di Mari, Bakk, Z., R., Oser, J., &amp; Kuha, J. (2023). A two-step estimator for multilevel latent class analysis with covariates. Psychometrika.
</p>
<p>Lukociene, O., Varriale, R., &amp; Vermunt, J. K. (2010). The simultaneous decision(s) about the number of lower-and higher-level classes in multilevel latent class analysis. Sociological Methodology, 40(1), 247-283.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Use the artificial data set
data = dataTOY

# Define vector with names of columns with items
Y = colnames(data)[1+1:10]

# Define name of column with higher-level id
id_high = "id_high"

# Define vector with names of columns with lower-level covariates
Z = c("Z_low")

# Define vector with names of columns with higher-level covariates
Zh = c("Z_high")

# Single-level 3-class LC model with covariates
out = multiLCA(data, Y, 3, Z = Z, verbose = FALSE)
out

# Multilevel LC model
out = multiLCA(data, Y, 3, id_high, 2, verbose = FALSE)
out

# Multilevel LC model lower-level covariates
out = multiLCA(data, Y, 3, id_high, 2, Z, verbose = FALSE)
out

# Multilevel LC model lower- and higher-level covariates
out = multiLCA(data, Y, 3, id_high, 2, Z, Zh, verbose = FALSE)
out

# Model selection over single-level models with 1-3 classes
out = multiLCA(data, Y, 1:3, verbose = FALSE)
out

# Model selection over multilevel models with 1-3 lower-level classes and
# 2 higher-level classes
out = multiLCA(data, Y, 1:3, id_high, 2, verbose = FALSE)
out

# Model selection over multilevel models with 3 lower-level classes and 
# 1-2 higher-level classes
out = multiLCA(data, Y, 3, id_high, 1:2, verbose = FALSE)
out

# Model selection over multilevel models with 1-3 lower-level classes and 
# 1-2 higher-level classes using the default sequential approach
out = multiLCA(data, Y, 1:3, id_high, 1:2, verbose = FALSE)
out

</code></pre>

<hr>
<h2 id='multilevLCA-package'>
Estimates and Plots Single-Level and Multilevel Latent Class Models
</h2><span id='topic+multilevLCA-package'></span>

<h3>Description</h3>

<p>Efficiently estimates single- and multilevel latent class models with covariates, allowing for output visualization in all specifications. For more technical details, see Lyrvall et al (2023) &lt;arXiv:2305.07276&gt;.
</p>


<h3>Details</h3>

<p>For estimating latent class models, see <code><a href="#topic+multiLCA">multiLCA</a></code>.
</p>
<p>For plotting latent class models, see <code><a href="#topic+plot.multiLCA">plot.multiLCA</a></code>
</p>


<h3>Author(s)</h3>

<p>Roberto Di Mari and Johan Lyrvall.
</p>
<p>Maintainer: Roberto Di Mari &lt;roberto.dimari@unict.it&gt;
</p>


<h3>References</h3>

<p>Bakk, Z., &amp; Kuha, J. (2018). Two-step estimation of models between latent classes and external variables. <em>Psychometrika, 83, 871-892</em>.
</p>
<p>Bakk, Z., Di Mari, R., Oser, J., &amp; Kuha, J. (2022). Two-stage multilevel latent class analysis with covariates in the presence of direct effects. <em>Structural Equation Modeling: A Multidisciplinary Journal, 29(2), 267-277</em>.
</p>
<p>Di Mari, Bakk, Z., R., Oser, J., &amp; Kuha, J. (2023). A two-step estimator for multilevel latent class analysis with covariates. Psychometrika.
</p>
<p>Lukociene, O., Varriale, R., &amp; Vermunt, J. K. (2010). The simultaneous decision(s) about the number of lower-and higher-level classes in multilevel latent class analysis. Sociological Methodology, 40(1), 247-283.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data = dataIEA
Y = colnames(dataIEA)[4+1:12]

out = multiLCA(data = data, Y = Y, iT = 2)
out
plot(out, horiz = FALSE)

</code></pre>

<hr>
<h2 id='plot.multiLCA'>
Plots conditional response probabilities
</h2><span id='topic+plot.multiLCA'></span>

<h3>Description</h3>

<p>Visualizes conditional response probabilities estimated by the <code><a href="#topic+multiLCA">multiLCA</a></code> function. The method works for both single- and multilevel models.
</p>
<p>Let <code>out</code> denote the list object returned by the <code><a href="#topic+multiLCA">multiLCA</a></code> function. Executing <code>plot(out)</code> visualizes the conditional response probabilities given by the <code>mPhi</code> matrix in <code>out</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'multiLCA'
plot(x, horiz = FALSE, clab = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.multiLCA_+3A_x">x</code></td>
<td>

<p>The object returned by the <code><a href="#topic+multiLCA">multiLCA</a></code> function
</p>
</td></tr>
<tr><td><code id="plot.multiLCA_+3A_horiz">horiz</code></td>
<td>

<p>Whether item labels should be oriented horizontally (<code>TRUE</code>) or vertically (<code>FALSE</code>). Default <code>FALSE</code>
</p>
</td></tr>
<tr><td><code id="plot.multiLCA_+3A_clab">clab</code></td>
<td>

<p>A character vector with user-specified class labels, if available, in the order &quot;Class 1&quot;, &quot;Class 2&quot;, ... under the default settings, i.e. top-to-bottom. Default <code>NULL</code>
</p>
</td></tr>
<tr><td><code id="plot.multiLCA_+3A_...">...</code></td>
<td>
<p>Additional plotting arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Use IEA data
data = dataIEA

# Define vector with names of columns with items
Y = colnames(data)[4+1:12]

# Define number of (low-level) classes
iT = 3

# Estimate single-level measurement model
out = multiLCA(data = data, Y = Y, iT = iT)
out

# Plot conditional response probabilities with default settings
plot(out)

# Plot with vertical item labels and custom class labels
plot(out, horiz = FALSE, clab = c("Maximal", "Engaged", "Subject"))

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
