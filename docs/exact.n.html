<!DOCTYPE html><html><head><title>Help for package exact.n</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {exact.n}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ESTEP.rd'><p>Calculate E-P-values based on LR statistic.</p></a></li>
<li><a href='#fetch.data'><p>Download a target power library</p></a></li>
<li><a href='#inference'><p>Approximate and exact tests for single data set</p></a></li>
<li><a href='#lr.rd'><p>Likelihood ratio statistics for one-sided tests of risk difference.</p></a></li>
<li><a href='#main.function'><p>Provide sample size solutions for target size and power.</p></a></li>
<li><a href='#n1.get'><p>Find smallest value of n1 that achieves target power</p></a></li>
<li><a href='#n1.get.solution'><p>Find minimal n1 achieving target power for range of values of p0</p></a></li>
<li><a href='#n1.get.vector'><p>Find minimal n1 achieving target power for all values of n0</p></a></li>
<li><a href='#POWER'><p>Exact Power of Test for Selected Sample Sizes.</p></a></li>
<li><a href='#power.image'><p>Image plot of power</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Exact Samples Sizes and Inference for Clinical Trials with
Binary Endpoint</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-11-08</td>
</tr>
<tr>
<td>Author:</td>
<td>Chris J. Lloyd</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Chris J. Lloyd &lt;c.lloyd@mbs.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Allows the user to determine minimum sample sizes that achieve target size and power at a specified alternative. For more information, see “Exact samples sizes for clinical trials subject to size and power constraints” by Lloyd, C.J. (2022) Preprint &lt;<a href="https://doi.org/10.13140%2FRG.2.2.11828.94085">doi:10.13140/RG.2.2.11828.94085</a>&gt;. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R(&ge; 3.5)</td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, stats, httr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-11-08 08:48:27 UTC; User</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-11-09 02:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='ESTEP.rd'>Calculate E-P-values based on LR statistic.</h2><span id='topic+ESTEP.rd'></span>

<h3>Description</h3>

<p>Calculates all possible values of the E-P-value for testing p1-p0 greater
than a provided null value psi.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ESTEP.rd(n0, n1, psi = 0, J = NULL, sided = 1, dec.places = 10, prin = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ESTEP.rd_+3A_n0">n0</code></td>
<td>
<p>control sample size</p>
</td></tr>
<tr><td><code id="ESTEP.rd_+3A_n1">n1</code></td>
<td>
<p>treatment sample size</p>
</td></tr>
<tr><td><code id="ESTEP.rd_+3A_psi">psi</code></td>
<td>
<p>null value of risk difference p1-p0</p>
</td></tr>
<tr><td><code id="ESTEP.rd_+3A_j">J</code></td>
<td>
<p>index of single data set if desired</p>
</td></tr>
<tr><td><code id="ESTEP.rd_+3A_sided">sided</code></td>
<td>
<p>(1 or 2 sided test)</p>
</td></tr>
<tr><td><code id="ESTEP.rd_+3A_dec.places">dec.places</code></td>
<td>
<p>number of decimal places of output t-values and p-values.</p>
</td></tr>
<tr><td><code id="ESTEP.rd_+3A_prin">prin</code></td>
<td>
<p>outputs expected time and progress of calculation</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function can take a long time for larger sample sizes. The computation
time is of order (n0*n1)^2.
</p>


<h3>Value</h3>

<p>A list with elements </p>
<table>
<tr><td><code>y0</code>, <code>y1</code></td>
<td>
<p>data sets (scalar or vector)</p>
</td></tr>
<tr><td><code>oldP</code></td>
<td>
<p>approximate p-value(s) before E-step</p>
</td></tr> <tr><td><code>T</code>, <code>P</code></td>
<td>
<p>quasi-exact
P-value(s) and equivalent T-value(s)</p>
</td></tr> <tr><td><code>pmle</code></td>
<td>
<p>profile ML estimates of
baseline probability</p>
</td></tr> <tr><td><code>index</code></td>
<td>
<p>consistent code to select a single
outcome</p>
</td></tr> <tr><td><code>psi</code></td>
<td>
<p>scalar null value of p1-p0</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Chris J. Lloyd
</p>


<h3>References</h3>

<p>C.J. Lloyd (2022) Exact samples sizes for clinical trials subject to
size and power constraints. Preprint. <a href="https://doi.org/10.13140/RG.2.2.11828.94085">doi:10.13140/RG.2.2.11828.94085</a>
</p>

<hr>
<h2 id='fetch.data'>Download a target power library</h2><span id='topic+fetch.data'></span>

<h3>Description</h3>

<p>Function downloads one of 85 power libraries from chrislloyd.com.au.
The libraries are all four column matrices with roughly 20 million
rows and will be around 1.4Gb within R. Download should take roughly
a minute. The object will have a name of the form LIB.alpha.delta.Rdata.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fetch.data(alpha, delta, prin = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fetch.data_+3A_alpha">alpha</code></td>
<td>
<p>value of nominal size of test</p>
</td></tr>
<tr><td><code id="fetch.data_+3A_delta">delta</code></td>
<td>
<p>value of clinically relevant difference</p>
</td></tr>
<tr><td><code id="fetch.data_+3A_prin">prin</code></td>
<td>
<p>If TRUE, error and/or warning messages are printed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value. A library object will appear in the global environment.
</p>


<h3>Author(s)</h3>

<p>Chris J. Lloyd
</p>


<h3>References</h3>

<p>C.J. Lloyd (2022) Exact samples sizes for clinical trials subject to size and power constraints. <a href="https://doi.org/10.13140/RG.2.2.11828.94085">doi:10.13140/RG.2.2.11828.94085</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#'
## Not run: 
fetch.data(alpha=0.05,delta=0.10)
# Object LIB.a050.d10 will appear with 83,289,960 elements

## End(Not run)

</code></pre>

<hr>
<h2 id='inference'>Approximate and exact tests for single data set</h2><span id='topic+inference'></span>

<h3>Description</h3>

<p>For a single provided data sets (y0, n0, y1, n1) calculate approximate and quasi-exact test statistics of the null value p1-p0=psi.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>inference(y0, n0, y1, n1, psi = 0, sided = 1, dec.places = 4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="inference_+3A_y0">y0</code></td>
<td>
<p>number of successes for control</p>
</td></tr>
<tr><td><code id="inference_+3A_n0">n0</code></td>
<td>
<p>control sample size</p>
</td></tr>
<tr><td><code id="inference_+3A_y1">y1</code></td>
<td>
<p>number of successes for treatment</p>
</td></tr>
<tr><td><code id="inference_+3A_n1">n1</code></td>
<td>
<p>treatment sample size</p>
</td></tr>
<tr><td><code id="inference_+3A_psi">psi</code></td>
<td>
<p>null value of risk difference p1-p0</p>
</td></tr>
<tr><td><code id="inference_+3A_sided">sided</code></td>
<td>
<p>1-sided or 2-sided test</p>
</td></tr>
<tr><td><code id="inference_+3A_dec.places">dec.places</code></td>
<td>
<p>decimal places of output T and P values</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with elements </p>
<table>
<tr><td><code>y</code></td>
<td>
<p>the data vector y0,y1</p>
</td></tr> <tr><td><code>n</code></td>
<td>
<p>the
sample size vector n0,n1</p>
</td></tr> <tr><td><code>approx</code></td>
<td>
<p>approximate T-value and p-value</p>
</td></tr>
<tr><td><code>quasi.exact</code></td>
<td>
<p>quasi.exact T-value and p-value</p>
</td></tr> <tr><td><code>pmle</code></td>
<td>
<p>profile
maximum likelihood estimate of baseline probability</p>
</td></tr> <tr><td><code>psi</code></td>
<td>
<p>null value
of p1-p0</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Chris J. Lloyd
</p>


<h3>References</h3>

<p>C.J. Lloyd (2022) Exact samples sizes for clinical trials subject to
size and power constraints. Preprint. <a href="https://doi.org/10.13140/RG.2.2.11828.94085">doi:10.13140/RG.2.2.11828.94085</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
y0=25
y1=41
n0=65
n1=82
# Non-inferiority test of p1-p0&gt;-0.1. Evidence is strong.
inference(y0,n0,y1,n1,psi=-0.1)


</code></pre>

<hr>
<h2 id='lr.rd'>Likelihood ratio statistics for one-sided tests of risk difference.</h2><span id='topic+lr.rd'></span>

<h3>Description</h3>

<p>Calculates all possible values of the (signed) LR statistic for testing
p1-p0 greater than a provided null value psi.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lr.rd(
  n0,
  n1,
  Y0 = NULL,
  Y1 = NULL,
  psi = 0,
  sided = 1,
  mod = 1e-07,
  dec.places = 10
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lr.rd_+3A_n0">n0</code></td>
<td>
<p>control sample size</p>
</td></tr>
<tr><td><code id="lr.rd_+3A_n1">n1</code></td>
<td>
<p>treatment sample size</p>
</td></tr>
<tr><td><code id="lr.rd_+3A_y0">Y0</code></td>
<td>
<p>number of successes for control (see details)</p>
</td></tr>
<tr><td><code id="lr.rd_+3A_y1">Y1</code></td>
<td>
<p>number of successes for treatment (see details)</p>
</td></tr>
<tr><td><code id="lr.rd_+3A_psi">psi</code></td>
<td>
<p>null value of risk difference p1-p0</p>
</td></tr>
<tr><td><code id="lr.rd_+3A_sided">sided</code></td>
<td>
<p>(1 or 2 sided test)
#' @param sided 1-sided or 2-sided test</p>
</td></tr>
<tr><td><code id="lr.rd_+3A_mod">mod</code></td>
<td>
<p>A very small adjustment to account for 0*log0 in certain
likelihood calculations. Should not need adjustment.</p>
</td></tr>
<tr><td><code id="lr.rd_+3A_dec.places">dec.places</code></td>
<td>
<p>number of decimal places of t-values and p-value.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If Y0,Y1 is not supplied then all possible values are output. If specific
values for Y0, Y1 are supplied then only these outcomes of the SRLR are
calculated.
</p>


<h3>Value</h3>

<p>A list with elements </p>
<table>
<tr><td><code>y0</code>, <code>y1</code></td>
<td>
<p>data sets (scalar or vector)</p>
</td></tr>
<tr><td><code>T</code>, <code>P</code></td>
<td>
<p>quasi-exact P-value(s) and equivalent T-value(s)</p>
</td></tr>
<tr><td><code>pmle</code></td>
<td>
<p>profile ML estimates of baseline probability</p>
</td></tr>
<tr><td><code>index</code></td>
<td>
<p>consistent code to select a single outcome</p>
</td></tr> <tr><td><code>psi</code></td>
<td>
<p>scalar
null value of p1-p0</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Chris J. Lloyd
</p>


<h3>References</h3>

<p>C.J. Lloyd (2022) Exact samples sizes for clinical trials subject to
size and power constraints. Preprint. <a href="https://doi.org/10.13140/RG.2.2.11828.94085">doi:10.13140/RG.2.2.11828.94085</a>
</p>

<hr>
<h2 id='main.function'>Provide sample size solutions for target size and power.</h2><span id='topic+main.function'></span>

<h3>Description</h3>

<p>Function gives smallest values for n1 as function of n0 that achieve target
size and power.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>main.function(
  alpha,
  delta,
  beta = 0.75,
  p0 = 0.5,
  type = 2,
  plt = FALSE,
  out = (-1),
  b.lim = 5,
  prin = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="main.function_+3A_alpha">alpha</code></td>
<td>
<p>value of nominal size of test</p>
</td></tr>
<tr><td><code id="main.function_+3A_delta">delta</code></td>
<td>
<p>value of clinically relevant difference</p>
</td></tr>
<tr><td><code id="main.function_+3A_beta">beta</code></td>
<td>
<p>scalar target for power</p>
</td></tr>
<tr><td><code id="main.function_+3A_p0">p0</code></td>
<td>
<p>single value or range of values for baseline probability</p>
</td></tr>
<tr><td><code id="main.function_+3A_type">type</code></td>
<td>
<p>type of maximisation (see n1.get documentation)</p>
</td></tr>
<tr><td><code id="main.function_+3A_plt">plt</code></td>
<td>
<p>If TRUE, plot n1 solutions versus</p>
</td></tr>
<tr><td><code id="main.function_+3A_out">out</code></td>
<td>
<p>More solutions output if out &gt; 0 than out &lt; 0 (see details)</p>
</td></tr>
<tr><td><code id="main.function_+3A_b.lim">b.lim</code></td>
<td>
<p>maximum imbalance of sample sizes</p>
</td></tr>
<tr><td><code id="main.function_+3A_prin">prin</code></td>
<td>
<p>If TRUE, error messages will be printed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If out &gt; 0 all solutions (including n1=Inf) are returned. If out=0, infinite
values are suppressed. If out &lt; 0, only output satisfying the balance
criterion are output.
</p>


<h3>Value</h3>

<p>list with elements n0 and n1
</p>


<h3>Note</h3>

<p>The appropriate data file needs to have been downloaded corresponding
to the desired value of alpha and delta. This can be done with the
fetch.data() function.
</p>


<h3>Author(s)</h3>

<p>Chris J. Lloyd
</p>


<h3>References</h3>

<p>C.J. Lloyd (2022) Exact samples sizes for clinical trials subject to
size and power constraints. Preprint. <a href="https://doi.org/10.13140/RG.2.2.11828.94085">doi:10.13140/RG.2.2.11828.94085</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# We are interested in designs with power at least 0.75 when exact size
# 0.025 and delta=0.20. Therefore, you would need to have downloaded
# LIB.a025.d20 using fetch(0.015,0.20). The example below instead uses
# the toy data that comes with the package. The baseline probability is
# assumed to be between 0.3 and 0.5.
rdata_file = system.file('files', 'LIB.a025.d20.Rdata', package = 'exact.n')
load(rdata_file)
#' main.function(.025,0.20,p0=c(0.3,0.5),beta=0.75,plt=TRUE)
# The value of the function is the minimum value of n1 for a range
# of values of n0. The sample size ratio is limited to 5 by default.

</code></pre>

<hr>
<h2 id='n1.get'>Find smallest value of n1 that achieves target power</h2><span id='topic+n1.get'></span>

<h3>Description</h3>

<p>Function calculates minimum value of n1 that achieves power beta. If there
is no solution less than 500, it models observed powers as a function of n1
and then extrapolates. It returns an infinite value if the power is
unattainable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>n1.get(data, n0, beta, delta, alpha, type = 1, plt = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="n1.get_+3A_data">data</code></td>
<td>
<p>a matrix with column names beta, p0.vals, n0, n1 and 481^2 rows
(See details)</p>
</td></tr>
<tr><td><code id="n1.get_+3A_n0">n0</code></td>
<td>
<p>scalar value of n0 between 20 and 500 inclusive</p>
</td></tr>
<tr><td><code id="n1.get_+3A_beta">beta</code></td>
<td>
<p>scalar target for power</p>
</td></tr>
<tr><td><code id="n1.get_+3A_delta">delta</code></td>
<td>
<p>value of clinically relevant difference</p>
</td></tr>
<tr><td><code id="n1.get_+3A_alpha">alpha</code></td>
<td>
<p>value of nominal size of test</p>
</td></tr>
<tr><td><code id="n1.get_+3A_type">type</code></td>
<td>
<p>type of minimum solution (See details)</p>
</td></tr>
<tr><td><code id="n1.get_+3A_plt">plt</code></td>
<td>
<p>if true produce diagnostic plots</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is called by n1.get.vector and will likely never be run by the
user.
</p>
<p>The data matrix will be a subset of one of the 85 main databases. Supplying
alpha and delta loads the appropriate database and selecting a value of p0
further subsets this data base. The resulting matrix will have 4 columns and
481^2 rows corresponding to all values of n0 and n1 from 20 to 500 inclusive
and is suitable for input into n1.get.
</p>
<p>If type=1, the smallest value N1 of n1 so that power &gt; beta is returned. If
type=2, the smallest value N1 of n1 so that power &gt; beta for all n1&gt;=N1 is
returned.
</p>


<h3>Value</h3>

<p>a single scalar value of n1. An integer indicates a solution was
found in the database. A non-integer indicates an extrapolated solution. An
Inf value indicates no extrapolated solution was found.
</p>


<h3>Author(s)</h3>

<p>Chris J. Lloyd
</p>


<h3>References</h3>

<p>C.J. Lloyd (2022) Exact samples sizes for clinical trials subject to
size and power constraints. Preprint. <a href="https://doi.org/10.13140/RG.2.2.11828.94085">doi:10.13140/RG.2.2.11828.94085</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Load toy version of power library for alpha=0.025, delta=0.20.
# Alternatively, load the full library using fetch.data(alpha=0.025,delta=0.20)
rdata_file = system.file('files', 'LIB.a025.d20.Rdata', package = 'exact.n')
load(rdata_file)
data=LIB.a025.d20[LIB.a025.d20[,2]==0.5,] # select subset with p0=.5
# For given value of n0, what minimum value of n1 ensures power at least 0.7?
n1.get(data, n0=70, beta=.7, delta=.2, alpha=0.025,
       type = 1, plt = TRUE) # Explicit solution 63 found in data base
n1.get(data, n0=50, beta=.7, delta=.2, alpha=0.025,
       type = 1, plt = TRUE) # Approximate solution 131 extrapolated from toy data base
# You can check the accuracy of this extrapolated result:
# POWER(n0=50,n1=131,alpha=0.025,delta=0.2,p0=0.5,type="elr")
# The minimum power at p0=0.5 is 0.699, slightly less than 0.7.
# With the full library n1.get returns the correct answer of n1=136.
n1.get(data, n0=30, beta=.7, delta=.2, alpha=0.025,
       type = 1, plt = TRUE) # Extrapolated solution is infinite


</code></pre>

<hr>
<h2 id='n1.get.solution'>Find minimal n1 achieving target power for range of values of p0</h2><span id='topic+n1.get.solution'></span>

<h3>Description</h3>

<p>This function calls n1.get.vector, runs if for all values of p0 within the
supplied range and then takes the worst (i.e. largest) solution for n1
</p>


<h3>Usage</h3>

<pre><code class='language-R'>n1.get.solution(data, beta, p0, delta, alpha, type = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="n1.get.solution_+3A_data">data</code></td>
<td>
<p>power database for selected value of alpha and delta</p>
</td></tr>
<tr><td><code id="n1.get.solution_+3A_beta">beta</code></td>
<td>
<p>scalar target for power</p>
</td></tr>
<tr><td><code id="n1.get.solution_+3A_p0">p0</code></td>
<td>
<p>single value or range of values for baseline probability</p>
</td></tr>
<tr><td><code id="n1.get.solution_+3A_delta">delta</code></td>
<td>
<p>value of clinically relevant difference</p>
</td></tr>
<tr><td><code id="n1.get.solution_+3A_alpha">alpha</code></td>
<td>
<p>value of nominal size of test</p>
</td></tr>
<tr><td><code id="n1.get.solution_+3A_type">type</code></td>
<td>
<p>type of minimum solution (See details)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector of solutions for n1 with name vector equal to range of n0
values
</p>


<h3>Author(s)</h3>

<p>Chris J. Lloyd
</p>


<h3>References</h3>

<p>C.J. Lloyd (2022) Exact samples sizes for clinical trials subject to
size and power constraints. Preprint. <a href="https://doi.org/10.13140/RG.2.2.11828.94085">doi:10.13140/RG.2.2.11828.94085</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Load toy version of power library for alpha=0.025, delta=0.20.
rdata_file = system.file('files', 'LIB.a025.d20.Rdata', package = 'exact.n')
load(rdata_file)
# n0 solutions when p0=0.5
n1.get.solution(LIB.a025.d20,beta=.7,p0=0.5,delta=0.2,alpha=0.025,type=1)
# n0 solutions for p0 between 0.4 ad 0.5
n1.get.solution(LIB.a025.d20,beta=.7,p0=c(0.4,0.5),delta=0.2,alpha=0.025,type=1)


</code></pre>

<hr>
<h2 id='n1.get.vector'>Find minimal n1 achieving target power for all values of n0</h2><span id='topic+n1.get.vector'></span>

<h3>Description</h3>

<p>For values of n0 covered in the matrix data (typically from 20 to 500) the
function calls n1.get and finds the minimal value of n1 achieving the target
power.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>n1.get.vector(data, beta, p0, delta, alpha, type = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="n1.get.vector_+3A_data">data</code></td>
<td>
<p>power database for selected value of alpha and delta (See
details)</p>
</td></tr>
<tr><td><code id="n1.get.vector_+3A_beta">beta</code></td>
<td>
<p>scalar target for power</p>
</td></tr>
<tr><td><code id="n1.get.vector_+3A_p0">p0</code></td>
<td>
<p>scalar value of baseline probability</p>
</td></tr>
<tr><td><code id="n1.get.vector_+3A_delta">delta</code></td>
<td>
<p>value of clinically relevant difference</p>
</td></tr>
<tr><td><code id="n1.get.vector_+3A_alpha">alpha</code></td>
<td>
<p>value of nominal size of test</p>
</td></tr>
<tr><td><code id="n1.get.vector_+3A_type">type</code></td>
<td>
<p>type of minimum solution (See details)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is called by n1.get.solution and will likely never be run by
the user.
</p>
<p>The data matrix will be one of the 85 main databases.
</p>
<p>If type=1, the smallest value N1 of n1 so that power &gt; beta is returned. If
type=2, the smallest value N1 of n1 so that power &gt; beta for all n1&gt;=N1 is
returned.
</p>


<h3>Value</h3>

<p>a list with element x (giving range of values of n0) and y (giving
minimal solutions for n1 of power &gt; beta). integer indicates
</p>


<h3>Author(s)</h3>

<p>Chris J. Lloyd
</p>


<h3>References</h3>

<p>C.J. Lloyd (2022) Exact samples sizes for clinical trials subject to
size and power constraints. Preprint. <a href="https://doi.org/10.13140/RG.2.2.11828.94085">doi:10.13140/RG.2.2.11828.94085</a>
</p>

<hr>
<h2 id='POWER'>Exact Power of Test for Selected Sample Sizes.</h2><span id='topic+POWER'></span>

<h3>Description</h3>

<p>For known values of the sizes n0, this function computes the
exact probability of rejecting the null as a function of baseline
probability.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>POWER(
  n0,
  n1,
  alpha = 0.05,
  delta = 0,
  psi = 0,
  type = "lr",
  sided = 1,
  p0 = NULL,
  obj = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="POWER_+3A_n0">n0</code></td>
<td>
<p>control sample size</p>
</td></tr>
<tr><td><code id="POWER_+3A_n1">n1</code></td>
<td>
<p>treatment sample size</p>
</td></tr>
<tr><td><code id="POWER_+3A_alpha">alpha</code></td>
<td>
<p>value of nominal size of test</p>
</td></tr>
<tr><td><code id="POWER_+3A_delta">delta</code></td>
<td>
<p>value of clinically relevant difference</p>
</td></tr>
<tr><td><code id="POWER_+3A_psi">psi</code></td>
<td>
<p>null value of risk difference p1-p0</p>
</td></tr>
<tr><td><code id="POWER_+3A_type">type</code></td>
<td>
<p>either &quot;lr&quot; for approximate or &quot;elr&quot; for quasi-exact test</p>
</td></tr>
<tr><td><code id="POWER_+3A_sided">sided</code></td>
<td>
<p>(1 or 2 sided test)</p>
</td></tr>
<tr><td><code id="POWER_+3A_p0">p0</code></td>
<td>
<p>baseline probability. If missing, a grid of values is created for
plotting. A scalar value can also be supplied.</p>
</td></tr>
<tr><td><code id="POWER_+3A_obj">obj</code></td>
<td>
<p>Optional object with all possible p-values. Must be a list with
elements y0, y1, P (typically output of lr.rd or ESTEP.rd). If not supplied
then object is generated from n0, n1 and psi.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>p0 values must be between max(0,-delta) and min(1,1-delta)
</p>


<h3>Value</h3>

<p>list with element x (containing values of baseline probability)
and element y (containing corresponding exact powers)
</p>


<h3>Author(s)</h3>

<p>Chris J. Lloyd
</p>


<h3>References</h3>

<p>C.J. Lloyd (2022) Exact samples sizes for clinical trials subject to
size and power constraints. Preprint. <a href="https://doi.org/10.13140/RG.2.2.11828.94085">doi:10.13140/RG.2.2.11828.94085</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>oldpar &lt;- graphics::par()
# Typical usage
#       POWER(n0=65,n1=82,psi=0,type="lr") # Exact size of approximate lr test
#       POWER(n0=65,n1=82,psi=0,type="elr",delta=.2) # Exact power of quasi exact test
# To make examples run faster, the package includes objects that contain
# all possible values of various tests when n0=65, n1=82.
load(system.file('files', "lr.stats.Rdata", package = 'exact.n'))
# All possible values of LR statistic p-values for testing p1-p0&gt;0
load(system.file('files', "elr.stats.Rdata", package = 'exact.n'))
# All possible values of ELR statistic p-values for testing p1-p0&gt;0
load(system.file('files', "elr10.stats.Rdata", package = 'exact.n'))
# Object contains all exact p-values for testing if p1-p0&gt;0.1
# All possible values of ELR statistic p-values for testing p1-p0&gt;0.1
#
graphics::par(mfrow=c(1,2))
# When delta=0 this gives type 1 error. The first plot is for the approximate
# lr based p-value, the second is for the quasi-exact e-p-value (alpha=0.05)
plot(POWER(n0=65,n1=82,alpha=0.05,psi=0,delta=0),type="l",
     xlab=expression("p"[0]),ylab="exact size")
abline(h=.05,lty=2)
plot(POWER(obj=elr.stats,alpha=0.05,delta=0),type="l",
     xlab=expression("p"[0]),ylab="exact size")
abline(h=.05,lty=2)
#
# For these sample sizes, power curve is calculated below for
# values of delta=0.1, 0.12, 0.14, 0.16, 0.18, 0.20. Power
# is poor for detecting a difference of 0.1 (see red).
plot(POWER(obj=lr.stats,alpha=0.05,delta=0.1),type="l",
     xlab=expression("p"[0]),ylab="exact power")
TITLE=expression('Exact power of LR test of p'[1]*'-p'[0]*'&gt;0.')
title(main=TITLE,cex.main=0.8)
lines(POWER(obj=lr.stats,alpha=0.05,delta=0.12))
lines(POWER(obj=lr.stats,alpha=0.05,delta=0.14))
lines(POWER(obj=lr.stats,alpha=0.05,delta=0.16))
lines(POWER(obj=lr.stats,alpha=0.05,delta=0.18))
lines(POWER(obj=lr.stats,alpha=0.05,delta=0.20))
lines(POWER(obj=lr.stats,alpha=0.05,delta=0.10),col="red")
#
# The results below are for testing p1-p0&gt;0.1.
plot(c(0,.9),c(0,1),type="n",
     xlab=expression("p"[0]),ylab="Pr(reject null)")
lines(POWER(obj=elr10.stats,alpha=0.05,psi=0.1,delta=0.1)) # Note delta=psi
abline(h=0.05,lty=2)
lines(POWER(obj=elr10.stats,alpha=0.05,delta=0.25),col="blue")
TITLE=expression('Exact size and power of test of p'[1]*'-p'[0]*'&gt;0.1.')
title(main=TITLE,cex.main=0.8)
legend(.4,.4,lty=c(1,1),col=c("black","blue"),box.col="white",
    legend=c("size: p1-p0=0.1","power: p1-p0=0.25"),cex=.7)
# When using the package the above plots would be generated by
# lines(POWER(n0=65,n1=82,alpha=0.05,psi=0.1,delta=0.10,type="elr"))
# lines(POWER(n0=65,n1=82,alpha=0.05,psi=0.1,delta=0.25,type="elr"))
suppressWarnings(graphics::par(oldpar))

</code></pre>

<hr>
<h2 id='power.image'>Image plot of power</h2><span id='topic+power.image'></span>

<h3>Description</h3>

<p>Creates image plot of exact power for range of values of n0 and n1.
Optionally, the image plot will show where power exceeds a provided power
target.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>power.image(data, p = 0.2, binary = TRUE, beta = 0.75)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="power.image_+3A_data">data</code></td>
<td>
<p>a matrix of powers with columns named beta p0.vals, n0 and n1.</p>
</td></tr>
<tr><td><code id="power.image_+3A_p">p</code></td>
<td>
<p>a scalar value for p0.vals that is used to select the subset of data.</p>
</td></tr>
<tr><td><code id="power.image_+3A_binary">binary</code></td>
<td>
<p>If TRUE only the binary indicator of power exceeding beta is displayed.</p>
</td></tr>
<tr><td><code id="power.image_+3A_beta">beta</code></td>
<td>
<p>target value of power</p>
</td></tr>
</table>


<h3>Details</h3>

<p>data will be one of the 85 saved objects corresponding to a selected value
of alpha and delta.
</p>


<h3>Value</h3>

<p>No return value and if the 'binary' parameter is TRUE then an image will be displayed
</p>


<h3>Author(s)</h3>

<p>Chris J. Lloyd
</p>


<h3>Examples</h3>

<pre><code class='language-R'>oldpar &lt;- graphics::par()
# Load toy version of power library for alpha=0.025, delta=0.20.
rdata_file = system.file('files', 'LIB.a025.d20.Rdata', package = 'exact.n')
load(rdata_file)
graphics::par(mfrow=c(1,2))
power.image(LIB.a025.d20,p=.5,binary=FALSE)
power.image(LIB.a025.d20,p=.2,beta=.7,binary=TRUE)
suppressWarnings(graphics::par(oldpar))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
