<!DOCTYPE html><html><head><title>Help for package wqtrends</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {wqtrends}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#anlz_avgseason'><p>Extract period (seasonal) averages from fitted GAM</p></a></li>
<li><a href='#anlz_backtrans'><p>Back-transform response variable</p></a></li>
<li><a href='#anlz_fit'><p>Return summary statistics for GAM fits</p></a></li>
<li><a href='#anlz_gam'><p>Fit a generalized additive model to a water quality time series</p></a></li>
<li><a href='#anlz_metseason'><p>Extract period (seasonal) metrics from fitted GAM</p></a></li>
<li><a href='#anlz_mixmeta'><p>Fit a mixed meta-analysis regression model of trends</p></a></li>
<li><a href='#anlz_perchg'><p>Estimate percent change trends from GAM results for selected time periods</p></a></li>
<li><a href='#anlz_prd'><p>Get predicted data from fitted GAMs across period of observation</p></a></li>
<li><a href='#anlz_prdday'><p>Get predicted data from fitted GAMs across period of observation, every day</p></a></li>
<li><a href='#anlz_prdmatrix'><p>Get prediction matrix for a fitted GAM</p></a></li>
<li><a href='#anlz_pvalformat'><p>Format p-values for show functions</p></a></li>
<li><a href='#anlz_smooth'><p>Return summary statistics for smoothers of GAMs</p></a></li>
<li><a href='#anlz_sumtrndseason'><p>Estimate seasonal rates of change based on average estimates for multiple window widths</p></a></li>
<li><a href='#anlz_trans'><p>Transform response variable</p></a></li>
<li><a href='#anlz_trndseason'><p>Estimate rates of change based on seasonal metrics</p></a></li>
<li><a href='#rawdat'><p>Raw data from San Francisco Estuary (South Bay)</p></a></li>
<li><a href='#show_metseason'><p>Plot period (seasonal) averages from fitted GAM</p></a></li>
<li><a href='#show_mettrndseason'><p>Plot seasonal metrics and rates of change</p></a></li>
<li><a href='#show_perchg'><p>Plot percent change trends from GAM results for selected time periods</p></a></li>
<li><a href='#show_prd3d'><p>Plot a 3-d surface of predictions</p></a></li>
<li><a href='#show_prddoy'><p>Plot predictions for GAMs against day of year</p></a></li>
<li><a href='#show_prdseason'><p>Plot predictions for GAMs over time, by season</p></a></li>
<li><a href='#show_prdseries'><p>Plot predictions for GAMs over time series</p></a></li>
<li><a href='#show_sumtrndseason'><p>Plot seasonal rates of change based on average estimates for multiple window widths</p></a></li>
<li><a href='#show_sumtrndseason2'><p>Plot seasonal rates of change in quarters based on average estimates for multiple window widths</p></a></li>
<li><a href='#show_trndseason'><p>Plot rates of change based on seasonal metrics</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Assess Water Quality Trends with Generalized Additive Models</td>
</tr>
<tr>
<td>Version:</td>
<td>1.4.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-01-26</td>
</tr>
<tr>
<td>Description:</td>
<td>Assess Water Quality Trends for Long-Term Monitoring Data in Estuaries using
  Generalized Additive Models following Wood (2017) &lt;<a href="https://doi.org/10.1201%2F9781315370279">doi:10.1201/9781315370279</a>&gt; and Error
  Propagation with Mixed-Effects Meta-Analysis following Sera et al. (2019) &lt;<a href="https://doi.org/10.1002%2Fsim.8362">doi:10.1002/sim.8362</a>&gt;.
  Methods are available for model fitting, assessment of fit, annual and seasonal trend tests, and
  visualization of results.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5)</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, ggplot2, lubridate, mgcv, mixmeta, plotly, purrr,
tibble, tidyr, viridisLite</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://creativecommons.org/publicdomain/zero/1.0/legalcode">CC0</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>URL:</td>
<td>&lt;<a href="https://github.com/tbep-tech/wqtrends/&amp;gt;">https://github.com/tbep-tech/wqtrends/&gt;</a>,
&lt;<a href="https://tbep-tech.github.io/wqtrends/&amp;gt;">https://tbep-tech.github.io/wqtrends/&gt;</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/tbep-tech/wqtrends/issues">https://github.com/tbep-tech/wqtrends/issues</a></td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 2.1.0), covr, english, knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-26 15:06:27 UTC; MarcusBeck</td>
</tr>
<tr>
<td>Author:</td>
<td>Marcus Beck <a href="https://orcid.org/0000-0002-4996-0059"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre],
  Perry de Valpine [aut],
  Rebecca Murphy [aut],
  Ian Wren [aut],
  Ariella Chelsky [aut],
  Melissa Foley <a href="https://orcid.org/0000-0002-5832-6404"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  David Senn <a href="https://orcid.org/0000-0002-4869-3550"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Marcus Beck &lt;mbeck@tbep.org&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-26 15:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='anlz_avgseason'>Extract period (seasonal) averages from fitted GAM</h2><span id='topic+anlz_avgseason'></span>

<h3>Description</h3>

<p>Extract period (seasonal) averages from fitted GAM
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anlz_avgseason(mod, doystr = 1, doyend = 364)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="anlz_avgseason_+3A_mod">mod</code></td>
<td>
<p>input model object as returned by <code><a href="#topic+anlz_gam">anlz_gam</a></code></p>
</td></tr>
<tr><td><code id="anlz_avgseason_+3A_doystr">doystr</code></td>
<td>
<p>numeric indicating start Julian day for extracting averages</p>
</td></tr>
<tr><td><code id="anlz_avgseason_+3A_doyend">doyend</code></td>
<td>
<p>numeric indicating ending Julian day for extracting averages</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame of period averages
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)

# data to model
tomod &lt;- rawdat %&gt;%
  filter(station %in% 34) %&gt;%
  filter(param %in% 'chl') %&gt;% 
  filter(yr &gt; 2015)

mod &lt;- anlz_gam(tomod, trans = 'log10')
anlz_avgseason(mod, doystr = 90, doyend = 180)
</code></pre>

<hr>
<h2 id='anlz_backtrans'>Back-transform response variable</h2><span id='topic+anlz_backtrans'></span>

<h3>Description</h3>

<p>Back-transform response variable after fitting GAM
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anlz_backtrans(dat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="anlz_backtrans_+3A_dat">dat</code></td>
<td>
<p>input data with <code>trans</code> argument</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>dat</code> can be output from <code><a href="#topic+anlz_trans">anlz_trans</a></code> or <code><a href="#topic+anlz_prd">anlz_prd</a></code>
</p>


<h3>Value</h3>

<p><code>dat</code> with the <code>value</code> column back-transformed using info from the <code>trans</code> column
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)

tomod &lt;- rawdat %&gt;% 
  filter(station %in% 34) %&gt;% 
  filter(param %in% 'chl')
dat &lt;- anlz_trans(tomod, trans = 'log10')
backtrans &lt;- anlz_backtrans(dat)
head(backtrans)

mod &lt;- anlz_gam(tomod, trans = 'log10')
dat &lt;- anlz_prd(mod)
backtrans &lt;- anlz_backtrans(dat)
head(backtrans)
</code></pre>

<hr>
<h2 id='anlz_fit'>Return summary statistics for GAM fits</h2><span id='topic+anlz_fit'></span>

<h3>Description</h3>

<p>Return summary statistics for GAM fits
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anlz_fit(mod)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="anlz_fit_+3A_mod">mod</code></td>
<td>
<p>input model object as returned by <code><a href="#topic+anlz_gam">anlz_gam</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Results show the overall summary of the model as Akaike Information Criterion (<code>AIC</code>), the generalized cross-validation score (<code>GCV</code>), and the <code>R2</code> values.  Lower values for <code>AIC</code> and <code>GCV</code> and higher values for <code>R2</code> indicate improved model fit.
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> with summary statistics for GAM fits
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)

# data to model
tomod &lt;- rawdat %&gt;%
  filter(station %in% 34) %&gt;%
  filter(param %in% 'chl')
  
mod &lt;-  anlz_gam(tomod, trans = 'log10')
anlz_fit(mod)
</code></pre>

<hr>
<h2 id='anlz_gam'>Fit a generalized additive model to a water quality time series</h2><span id='topic+anlz_gam'></span>

<h3>Description</h3>

<p>Fit a generalized additive model to a water quality time series
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anlz_gam(moddat, kts = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="anlz_gam_+3A_moddat">moddat</code></td>
<td>
<p>input raw data, one station and paramater</p>
</td></tr>
<tr><td><code id="anlz_gam_+3A_kts">kts</code></td>
<td>
<p>optional numeric vector for the upper limit for the number of knots in the term <code>s(cont_year)</code>, see details</p>
</td></tr>
<tr><td><code id="anlz_gam_+3A_...">...</code></td>
<td>
<p>additional arguments passed to other methods, i.e., <code>trans = 'log10'</code> (default) or <code>trans = 'ident'</code> passed to <code><a href="#topic+anlz_trans">anlz_trans</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The model structure is as follows:
</p>

<dl>
<dt>model S:</dt><dd><p>chl ~ s(cont_year, k = large)</p>
</dd>
</dl>

<p>The <code>cont_year</code> vector is measured as a continuous numeric variable for the annual effect (e.g., January 1st, 2000 is 2000.0, July 1st, 2000 is 2000.5, etc.) and <code>doy</code> is the day of year as a numeric value from 1 to 366.  The function <code><a href="mgcv.html#topic+s">s</a></code> models <code>cont_year</code> as a smoothed, non-linear variable. The optimal amount of smoothing on <code>cont_year</code> is determined by cross-validation as implemented in the mgcv package and an upper theoretical upper limit on the number of knots for <code>k</code> should be large enough to allow sufficient flexibility in the smoothing term.  The upper limit of <code>k</code> was chosen as 12 times the number of years for the input data. If insufficient data are available to fit a model with the specified <code>k</code>, the number of knots is decreased until the data can be modelled, e.g., 11 times the number of years, 10 times the number of years, etc.
</p>


<h3>Value</h3>

<p>a <code><a href="mgcv.html#topic+gam">gam</a></code> model object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)
tomod &lt;- rawdat %&gt;% 
  filter(station %in% 34) %&gt;% 
  filter(param %in% 'chl')
anlz_gam(tomod, trans = 'log10')
</code></pre>

<hr>
<h2 id='anlz_metseason'>Extract period (seasonal) metrics from fitted GAM</h2><span id='topic+anlz_metseason'></span>

<h3>Description</h3>

<p>Extract period (seasonal) metrics from fitted GAM
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anlz_metseason(mod, metfun = mean, doystr = 1, doyend = 364, nsim = 10000, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="anlz_metseason_+3A_mod">mod</code></td>
<td>
<p>input model object as returned by <code><a href="#topic+anlz_gam">anlz_gam</a></code></p>
</td></tr>
<tr><td><code id="anlz_metseason_+3A_metfun">metfun</code></td>
<td>
<p>function input for metric to calculate, e.g., <code>mean</code>, <code>var</code>, <code>max</code>, etc</p>
</td></tr>
<tr><td><code id="anlz_metseason_+3A_doystr">doystr</code></td>
<td>
<p>numeric indicating start Julian day for extracting averages</p>
</td></tr>
<tr><td><code id="anlz_metseason_+3A_doyend">doyend</code></td>
<td>
<p>numeric indicating ending Julian day for extracting averages</p>
</td></tr>
<tr><td><code id="anlz_metseason_+3A_nsim">nsim</code></td>
<td>
<p>numeric indicating number of random draws for simulating uncertainty</p>
</td></tr>
<tr><td><code id="anlz_metseason_+3A_...">...</code></td>
<td>
<p>additional arguments passed to <code>metfun</code>, e.g., <code>na.rm = TRUE)</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function estimates a metric of interest for a given seasonal period each year using results from a fitted GAM (i.e., from <code><a href="#topic+anlz_gam">anlz_gam</a></code>).  The estimates are based on the predicted values for each seasonal period, with uncertainty of the metric based on repeated sampling of the predictions following uncertainty in the model coefficients.
</p>


<h3>Value</h3>

<p>A data frame of period metrics
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)

# data to model
tomod &lt;- rawdat %&gt;%
  filter(station %in% 34) %&gt;%
  filter(param %in% 'chl') %&gt;% 
  filter(yr &gt; 2015)

mod &lt;- anlz_gam(tomod, trans = 'log10')
anlz_metseason(mod, mean, doystr = 90, doyend = 180, nsim = 100)
</code></pre>

<hr>
<h2 id='anlz_mixmeta'>Fit a mixed meta-analysis regression model of trends</h2><span id='topic+anlz_mixmeta'></span>

<h3>Description</h3>

<p>Fit a mixed meta-analysis regression model of trends
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anlz_mixmeta(metseason, yrstr = 2000, yrend = 2019, yromit = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="anlz_mixmeta_+3A_metseason">metseason</code></td>
<td>
<p>output from <code><a href="#topic+anlz_metseason">anlz_metseason</a></code></p>
</td></tr>
<tr><td><code id="anlz_mixmeta_+3A_yrstr">yrstr</code></td>
<td>
<p>numeric for starting year</p>
</td></tr>
<tr><td><code id="anlz_mixmeta_+3A_yrend">yrend</code></td>
<td>
<p>numeric for ending year</p>
</td></tr>
<tr><td><code id="anlz_mixmeta_+3A_yromit">yromit</code></td>
<td>
<p>optional numeric vector for years to omit from, inherited from <code><a href="#topic+show_metseason">show_metseason</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Parameters are not back-transformed if the original GAM used a transformation of the response variable
</p>


<h3>Value</h3>

<p>A list of <code><a href="mixmeta.html#topic+mixmeta">mixmeta</a></code> fitted model objects
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)

# data to model
tomod &lt;- rawdat %&gt;%
  filter(station %in% 34) %&gt;%
  filter(param %in% 'chl') %&gt;% 
  filter(yr &gt; 2015)

mod &lt;- anlz_gam(tomod, trans = 'log10')
metseason &lt;- anlz_metseason(mod, doystr = 90, doyend = 180)
anlz_mixmeta(metseason, yrstr = 2016, yrend = 2019)
</code></pre>

<hr>
<h2 id='anlz_perchg'>Estimate percent change trends from GAM results for selected time periods</h2><span id='topic+anlz_perchg'></span>

<h3>Description</h3>

<p>Estimate percent change trends from GAM results for selected time periods
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anlz_perchg(mod, baseyr, testyr)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="anlz_perchg_+3A_mod">mod</code></td>
<td>
<p>input model object as returned by <code><a href="#topic+anlz_gam">anlz_gam</a></code></p>
</td></tr>
<tr><td><code id="anlz_perchg_+3A_baseyr">baseyr</code></td>
<td>
<p>numeric vector of starting years</p>
</td></tr>
<tr><td><code id="anlz_perchg_+3A_testyr">testyr</code></td>
<td>
<p>numeric vector of ending years</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Working components of this function were taken from the gamDiff function in the baytrends package.
</p>


<h3>Value</h3>

<p>A data frame of summary results for change between the years.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)

# data to model
tomod &lt;- rawdat %&gt;%
  filter(station %in% 34) %&gt;%
  filter(param %in% 'chl')
  
mod &lt;- anlz_gam(tomod, trans = 'log10')
anlz_perchg(mod, baseyr = 1990, testyr = 2016)
</code></pre>

<hr>
<h2 id='anlz_prd'>Get predicted data from fitted GAMs across period of observation</h2><span id='topic+anlz_prd'></span>

<h3>Description</h3>

<p>Get predicted data from fitted GAMs across period of observation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anlz_prd(mod, annual = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="anlz_prd_+3A_mod">mod</code></td>
<td>
<p>input model object as returned by <code><a href="#topic+anlz_gam">anlz_gam</a></code></p>
</td></tr>
<tr><td><code id="anlz_prd_+3A_annual">annual</code></td>
<td>
<p>logical indicating if predictions only for the <code>cont_year</code> smoother are returned</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>data.frame</code> with predictions
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)

# data to model
tomod &lt;- rawdat %&gt;%
  filter(station %in% 34) %&gt;%
  filter(param %in% 'chl') %&gt;% 
  filter(yr &gt; 2015)
  
mod &lt;- anlz_gam(tomod, trans = 'log10')
anlz_prd(mod)
</code></pre>

<hr>
<h2 id='anlz_prdday'>Get predicted data from fitted GAMs across period of observation, every day</h2><span id='topic+anlz_prdday'></span>

<h3>Description</h3>

<p>Get predicted data from fitted GAMs across period of observation, every day
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anlz_prdday(mod)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="anlz_prdday_+3A_mod">mod</code></td>
<td>
<p>input model object as returned by <code><a href="#topic+anlz_gam">anlz_gam</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>data.frame</code> with predictions
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)

# data to model
tomod &lt;- rawdat %&gt;%
  filter(station %in% 34) %&gt;%
  filter(param %in% 'chl') %&gt;% 
  filter(yr &gt; 2015)

mod &lt;- anlz_gam(tomod, trans = 'log10')
anlz_prdday(mod)
</code></pre>

<hr>
<h2 id='anlz_prdmatrix'>Get prediction matrix for a fitted GAM</h2><span id='topic+anlz_prdmatrix'></span>

<h3>Description</h3>

<p>Get prediction matrix for a fitted GAM
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anlz_prdmatrix(mod, doystr = 1, doyend = 364, avemat = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="anlz_prdmatrix_+3A_mod">mod</code></td>
<td>
<p>input model object as returned by <code><a href="#topic+anlz_gam">anlz_gam</a></code></p>
</td></tr>
<tr><td><code id="anlz_prdmatrix_+3A_doystr">doystr</code></td>
<td>
<p>numeric indicating start Julian day for extracting averages</p>
</td></tr>
<tr><td><code id="anlz_prdmatrix_+3A_doyend">doyend</code></td>
<td>
<p>numeric indicating ending Julian day for extracting averages</p>
</td></tr>
<tr><td><code id="anlz_prdmatrix_+3A_avemat">avemat</code></td>
<td>
<p>logical indicating if the prediction matrix is to be passed to <code>anlz_metseason</code> (default) or <code>anlz_avgseason</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Used internally by <code><a href="#topic+anlz_metseason">anlz_metseason</a></code>, not to be used by itself
</p>


<h3>Value</h3>

<p>a <code>data.frame</code> with predictors to use with the fitted GAM
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)

# data to model
tomod &lt;- rawdat %&gt;%
  filter(station %in% 34) %&gt;%
  filter(param %in% 'chl') %&gt;% 
  filter(yr &gt; 2015)
  
mod &lt;- anlz_gam(tomod, trans = 'log10')
anlz_prdmatrix(mod, doystr = 90, doyend = 180)
</code></pre>

<hr>
<h2 id='anlz_pvalformat'>Format p-values for show functions</h2><span id='topic+anlz_pvalformat'></span>

<h3>Description</h3>

<p>Format p-values for show functions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anlz_pvalformat(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="anlz_pvalformat_+3A_x">x</code></td>
<td>
<p>numeric input p-value</p>
</td></tr>
</table>


<h3>Value</h3>

<p>p-value formatted as a text string, one of <code>p &lt; 0.001</code>, <code>'p &lt; 0.01'</code>, <code>p &lt; 0.05</code>, or <code>ns</code> for not significant
</p>


<h3>Examples</h3>

<pre><code class='language-R'>anlz_pvalformat(0.05)
</code></pre>

<hr>
<h2 id='anlz_smooth'>Return summary statistics for smoothers of GAMs</h2><span id='topic+anlz_smooth'></span>

<h3>Description</h3>

<p>Return summary statistics for smoothers of GAMs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anlz_smooth(mod)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="anlz_smooth_+3A_mod">mod</code></td>
<td>
<p>input model object as returned by <code><a href="#topic+anlz_gam">anlz_gam</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Results show the individual effects of the modelled components of each model as the estimated degrees of freedom (<code>edf</code>), the reference degrees of freedom (<code>Ref.df</code>), the test statistic (<code>F</code>), and significance of the component (<code>p-value</code>).  The significance of the component is in part based on the difference between <code>edf</code> and <code>Ref.df</code>.
</p>


<h3>Value</h3>

<p>a <code>data.frame</code> with summary statistics for smoothers in each GAM
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)

# data to model
tomod &lt;- rawdat %&gt;%
  filter(station %in% 34) %&gt;%
  filter(param %in% 'chl')
  
mod &lt;- anlz_gam(tomod, trans = 'log10')
anlz_smooth(mod)
</code></pre>

<hr>
<h2 id='anlz_sumtrndseason'>Estimate seasonal rates of change based on average estimates for multiple window widths</h2><span id='topic+anlz_sumtrndseason'></span>

<h3>Description</h3>

<p>Estimate seasonal rates of change based on average estimates for multiple window widths
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anlz_sumtrndseason(
  mod,
  doystr = 1,
  doyend = 364,
  justify = c("center", "left", "right"),
  win = 5:15
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="anlz_sumtrndseason_+3A_mod">mod</code></td>
<td>
<p>input model object as returned by <code><a href="#topic+anlz_gam">anlz_gam</a></code></p>
</td></tr>
<tr><td><code id="anlz_sumtrndseason_+3A_doystr">doystr</code></td>
<td>
<p>numeric indicating start Julian day for extracting averages</p>
</td></tr>
<tr><td><code id="anlz_sumtrndseason_+3A_doyend">doyend</code></td>
<td>
<p>numeric indicating ending Julian day for extracting averages</p>
</td></tr>
<tr><td><code id="anlz_sumtrndseason_+3A_justify">justify</code></td>
<td>
<p>chr string indicating the justification for the trend window</p>
</td></tr>
<tr><td><code id="anlz_sumtrndseason_+3A_win">win</code></td>
<td>
<p>numeric vector indicating number of years to use for the trend window</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is a wrapper to <code><a href="#topic+anlz_trndseason">anlz_trndseason</a></code> to loop across values in <code>win</code>, using <code>useave = TRUE</code> for quicker calculation of average seasonal metrics.  It does not work with any other seasonal metric calculations.
</p>


<h3>Value</h3>

<p>A data frame of slope estimates and p-values for each year
</p>


<h3>See Also</h3>

<p>Other analyze: 
<code><a href="#topic+anlz_trans">anlz_trans</a>()</code>,
<code><a href="#topic+anlz_trndseason">anlz_trndseason</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)

# data to model
tomod &lt;- rawdat %&gt;%
  filter(station %in% 34) %&gt;%
  filter(param %in% 'chl') %&gt;% 
  filter(yr &gt; 2015)

mod &lt;- anlz_gam(tomod, trans = 'log10')
anlz_sumtrndseason(mod, doystr = 90, doyend = 180, justify = 'center', win = 2:3)
</code></pre>

<hr>
<h2 id='anlz_trans'>Transform response variable</h2><span id='topic+anlz_trans'></span>

<h3>Description</h3>

<p>Transform response variable prior to fitting GAM
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anlz_trans(moddat, trans = c("log10", "ident"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="anlz_trans_+3A_moddat">moddat</code></td>
<td>
<p>input raw data, one station and paramater</p>
</td></tr>
<tr><td><code id="anlz_trans_+3A_trans">trans</code></td>
<td>
<p>chr string indicating desired type of transformation, one of <code>log10</code> or <code>ident</code> (no transformation)</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>moddat</code> with the <code>value</code> column transformed as indicated
</p>


<h3>See Also</h3>

<p>Other analyze: 
<code><a href="#topic+anlz_sumtrndseason">anlz_sumtrndseason</a>()</code>,
<code><a href="#topic+anlz_trndseason">anlz_trndseason</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)
tomod &lt;- rawdat %&gt;% 
  filter(station %in% 34) %&gt;% 
  filter(param %in% 'chl')
anlz_trans(tomod, trans = 'log10')
</code></pre>

<hr>
<h2 id='anlz_trndseason'>Estimate rates of change based on seasonal metrics</h2><span id='topic+anlz_trndseason'></span>

<h3>Description</h3>

<p>Estimate rates of change based on seasonal metrics
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anlz_trndseason(
  mod,
  metfun = mean,
  doystr = 1,
  doyend = 364,
  justify = c("center", "left", "right"),
  win = 5,
  nsim = 10000,
  useave = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="anlz_trndseason_+3A_mod">mod</code></td>
<td>
<p>input model object as returned by <code><a href="#topic+anlz_gam">anlz_gam</a></code></p>
</td></tr>
<tr><td><code id="anlz_trndseason_+3A_metfun">metfun</code></td>
<td>
<p>function input for metric to calculate, e.g., <code>mean</code>, <code>var</code>, <code>max</code>, etc</p>
</td></tr>
<tr><td><code id="anlz_trndseason_+3A_doystr">doystr</code></td>
<td>
<p>numeric indicating start Julian day for extracting averages</p>
</td></tr>
<tr><td><code id="anlz_trndseason_+3A_doyend">doyend</code></td>
<td>
<p>numeric indicating ending Julian day for extracting averages</p>
</td></tr>
<tr><td><code id="anlz_trndseason_+3A_justify">justify</code></td>
<td>
<p>chr string indicating the justification for the trend window</p>
</td></tr>
<tr><td><code id="anlz_trndseason_+3A_win">win</code></td>
<td>
<p>numeric indicating number of years to use for the trend window, see details</p>
</td></tr>
<tr><td><code id="anlz_trndseason_+3A_nsim">nsim</code></td>
<td>
<p>numeric indicating number of random draws for simulating uncertainty</p>
</td></tr>
<tr><td><code id="anlz_trndseason_+3A_useave">useave</code></td>
<td>
<p>logical indicating if <code>anlz_avgseason</code> is used for the seasonal metric calculation</p>
</td></tr>
<tr><td><code id="anlz_trndseason_+3A_...">...</code></td>
<td>
<p>additional arguments passed to <code>metfun</code>, e.g., <code>na.rm = TRUE)</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Trends are based on the slope of the fitted linear trend within the window, where the linear trend is estimated using a meta-analysis regression model (from <code><a href="#topic+anlz_mixmeta">anlz_mixmeta</a></code>) for the seasonal metrics (from <code><a href="#topic+anlz_metseason">anlz_metseason</a></code>).
</p>
<p>Note that for left and right windows, the exact number of years in <code>win</code> is used. For example, a left-centered window for 1990 of ten years will include exactly ten years from 1990, 1991, ... , 1999.  The same applies to a right-centered window, e.g., for 1990 it would include 1981, 1982, ..., 1990 (if those years have data). However, for a centered window, picking an even number of years for the window width will create a slightly off-centered window because it is impossible to center on an even number of years.  For example, if <code>win = 8</code> and <code>justify = 'center'</code>, the estimate for 2000 will be centered on 1997 to 2004 (three years left, four years right, eight years total). Centering for window widths with an odd number of years will always create a symmetrical window, i.e., if <code>win = 7</code> and <code>justify = 'center'</code>, the estimate for 2000 will be centered on 1997 and 2003 (three years left, three years right, seven years total).
</p>


<h3>Value</h3>

<p>A data frame of slope estimates and p-values for each year
</p>


<h3>See Also</h3>

<p>Other analyze: 
<code><a href="#topic+anlz_sumtrndseason">anlz_sumtrndseason</a>()</code>,
<code><a href="#topic+anlz_trans">anlz_trans</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)

# data to model
tomod &lt;- rawdat %&gt;%
  filter(station %in% 34) %&gt;%
  filter(param %in% 'chl') %&gt;% 
  filter(yr &gt; 2015)

mod &lt;- anlz_gam(tomod, trans = 'log10')
anlz_trndseason(mod, doystr = 90, doyend = 180, justify = 'center', win = 4)
</code></pre>

<hr>
<h2 id='rawdat'>Raw data from San Francisco Estuary (South Bay)</h2><span id='topic+rawdat'></span>

<h3>Description</h3>

<p>Raw data from San Francisco Estuary (South Bay)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rawdat
</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> object with 12411 rows and 8 columns
</p>

<dl>
<dt>date</dt><dd><p>Date</p>
</dd>
<dt>station</dt><dd><p>int</p>
</dd>
<dt>param</dt><dd><p>chr</p>
</dd>
<dt>value</dt><dd><p>num</p>
</dd>
<dt>doy</dt><dd><p>num</p>
</dd>
<dt>cont_year</dt><dd><p>num</p>
</dd>
<dt>yr</dt><dd><p>num</p>
</dd>
<dt>mo</dt><dd><p>Ord.factor</p>
</dd>
</dl>



<h3>Details</h3>

<p>Data from <code>datprc</code> object in <a href="https://github.com/fawda123/SFbaytrends">https://github.com/fawda123/SFbaytrends</a>
</p>

<hr>
<h2 id='show_metseason'>Plot period (seasonal) averages from fitted GAM</h2><span id='topic+show_metseason'></span>

<h3>Description</h3>

<p>Plot period (seasonal) averages from fitted GAM
</p>


<h3>Usage</h3>

<pre><code class='language-R'>show_metseason(
  mod,
  metfun = mean,
  doystr = 1,
  doyend = 364,
  yrstr = 2000,
  yrend = 2019,
  yromit = NULL,
  ylab,
  width = 0.9,
  size = 1.5,
  nsim = 10000,
  useave = FALSE,
  base_size = 11,
  xlim = NULL,
  ylim = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="show_metseason_+3A_mod">mod</code></td>
<td>
<p>input model object as returned by <code><a href="#topic+anlz_gam">anlz_gam</a></code></p>
</td></tr>
<tr><td><code id="show_metseason_+3A_metfun">metfun</code></td>
<td>
<p>function input for metric to calculate, e.g., <code>mean</code>, <code>var</code>, <code>max</code>, etc</p>
</td></tr>
<tr><td><code id="show_metseason_+3A_doystr">doystr</code></td>
<td>
<p>numeric indicating start Julian day for extracting averages</p>
</td></tr>
<tr><td><code id="show_metseason_+3A_doyend">doyend</code></td>
<td>
<p>numeric indicating ending Julian day for extracting averages</p>
</td></tr>
<tr><td><code id="show_metseason_+3A_yrstr">yrstr</code></td>
<td>
<p>numeric for starting year for trend model, see details</p>
</td></tr>
<tr><td><code id="show_metseason_+3A_yrend">yrend</code></td>
<td>
<p>numeric for ending year for trend model, see details</p>
</td></tr>
<tr><td><code id="show_metseason_+3A_yromit">yromit</code></td>
<td>
<p>optional numeric vector for years to omit from the plot, see details</p>
</td></tr>
<tr><td><code id="show_metseason_+3A_ylab">ylab</code></td>
<td>
<p>chr string for y-axis label</p>
</td></tr>
<tr><td><code id="show_metseason_+3A_width">width</code></td>
<td>
<p>numeric for width of error bars</p>
</td></tr>
<tr><td><code id="show_metseason_+3A_size">size</code></td>
<td>
<p>numeric for point size</p>
</td></tr>
<tr><td><code id="show_metseason_+3A_nsim">nsim</code></td>
<td>
<p>numeric indicating number of random draws for simulating uncertainty</p>
</td></tr>
<tr><td><code id="show_metseason_+3A_useave">useave</code></td>
<td>
<p>logical indicating if <code>anlz_avgseason</code> is used for the seasonal metric calculation</p>
</td></tr>
<tr><td><code id="show_metseason_+3A_base_size">base_size</code></td>
<td>
<p>numeric indicating base font size, passed to <code><a href="ggplot2.html#topic+theme_bw">theme_bw</a></code></p>
</td></tr>
<tr><td><code id="show_metseason_+3A_xlim">xlim</code></td>
<td>
<p>optional numeric vector of length two for x-axis limits</p>
</td></tr>
<tr><td><code id="show_metseason_+3A_ylim">ylim</code></td>
<td>
<p>optional numeric vector of length two for y-axis limits</p>
</td></tr>
<tr><td><code id="show_metseason_+3A_...">...</code></td>
<td>
<p>additional arguments passed to <code>metfun</code>, e.g., <code>na.rm = TRUE)</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Setting <code>yrstr</code> or <code>yrend</code> to <code>NULL</code> will suppress plotting of the trend line for the meta-analysis regression model.
</p>
<p>The optional <code>omityr</code> vector can be used to omit years from the plot and trend assessment. This may be preferred if seasonal estimates for a given year have very wide confidence intervals likely due to limited data, which can skew the trend assessments.
</p>
<p>Set <code>useave = T</code> to speed up calculations if <code>metfun = mean</code>.  This will use <code><a href="#topic+anlz_avgseason">anlz_avgseason</a></code> to estimate the seasonal summary metrics using a non-stochastic equation.
</p>


<h3>Value</h3>

<p>A <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)

# data to model
tomod &lt;- rawdat %&gt;%
  filter(station %in% 34) %&gt;%
  filter(param %in% 'chl') %&gt;% 
  filter(yr &gt; 2015)
  
mod &lt;- anlz_gam(tomod, trans = 'ident')

show_metseason(mod, doystr = 90, doyend = 180, yrstr = 2016, yrend = 2019, 
     ylab = 'Chlorophyll-a (ug/L)')


# show seasonal metrics without annual trend
show_metseason(mod, doystr = 90, doyend = 180, yrstr = NULL, yrend = NULL, 
     ylab = 'Chlorophyll-a (ug/L)')
     
# omit years from the analysis
show_metseason(mod, doystr = 90, doyend = 180, yrstr = 2015, yrend = 2019,
     yromit = 2018, ylab = 'Chlorophyll-a (ug/L)')
      
</code></pre>

<hr>
<h2 id='show_mettrndseason'>Plot seasonal metrics and rates of change</h2><span id='topic+show_mettrndseason'></span>

<h3>Description</h3>

<p>Plot seasonal metrics and rates of change
</p>


<h3>Usage</h3>

<pre><code class='language-R'>show_mettrndseason(
  mod,
  metfun = mean,
  doystr = 1,
  doyend = 364,
  justify = c("center", "left", "right"),
  win = 5,
  nsim = 10000,
  useave = FALSE,
  yromit = NULL,
  ylab,
  width = 0.9,
  size = 3,
  nms = NULL,
  cols = NULL,
  cmbn = F,
  base_size = 11,
  xlim = NULL,
  ylim = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="show_mettrndseason_+3A_mod">mod</code></td>
<td>
<p>input model object as returned by <code><a href="#topic+anlz_gam">anlz_gam</a></code></p>
</td></tr>
<tr><td><code id="show_mettrndseason_+3A_metfun">metfun</code></td>
<td>
<p>function input for metric to calculate, e.g., <code>mean</code>, <code>var</code>, <code>max</code>, etc</p>
</td></tr>
<tr><td><code id="show_mettrndseason_+3A_doystr">doystr</code></td>
<td>
<p>numeric indicating start Julian day for extracting averages</p>
</td></tr>
<tr><td><code id="show_mettrndseason_+3A_doyend">doyend</code></td>
<td>
<p>numeric indicating ending Julian day for extracting averages</p>
</td></tr>
<tr><td><code id="show_mettrndseason_+3A_justify">justify</code></td>
<td>
<p>chr string indicating the justification for the trend window</p>
</td></tr>
<tr><td><code id="show_mettrndseason_+3A_win">win</code></td>
<td>
<p>numeric indicating number of years to use for the trend window, see details</p>
</td></tr>
<tr><td><code id="show_mettrndseason_+3A_nsim">nsim</code></td>
<td>
<p>numeric indicating number of random draws for simulating uncertainty</p>
</td></tr>
<tr><td><code id="show_mettrndseason_+3A_useave">useave</code></td>
<td>
<p>logical indicating if <code>anlz_avgseason</code> is used for the seasonal metric calculation</p>
</td></tr>
<tr><td><code id="show_mettrndseason_+3A_yromit">yromit</code></td>
<td>
<p>optional numeric vector for years to omit from the plot, see details</p>
</td></tr>
<tr><td><code id="show_mettrndseason_+3A_ylab">ylab</code></td>
<td>
<p>chr string for y-axis label</p>
</td></tr>
<tr><td><code id="show_mettrndseason_+3A_width">width</code></td>
<td>
<p>numeric for width of error bars</p>
</td></tr>
<tr><td><code id="show_mettrndseason_+3A_size">size</code></td>
<td>
<p>numeric for point size</p>
</td></tr>
<tr><td><code id="show_mettrndseason_+3A_nms">nms</code></td>
<td>
<p>optional character vector for trend names, see details</p>
</td></tr>
<tr><td><code id="show_mettrndseason_+3A_cols">cols</code></td>
<td>
<p>optional character vector for point colors, see details</p>
</td></tr>
<tr><td><code id="show_mettrndseason_+3A_cmbn">cmbn</code></td>
<td>
<p>logical indicating if the no trend and on estimate colors should be combined, see details</p>
</td></tr>
<tr><td><code id="show_mettrndseason_+3A_base_size">base_size</code></td>
<td>
<p>numeric indicating base font size, passed to <code><a href="ggplot2.html#topic+theme_bw">theme_bw</a></code></p>
</td></tr>
<tr><td><code id="show_mettrndseason_+3A_xlim">xlim</code></td>
<td>
<p>optional numeric vector of length two for x-axis limits</p>
</td></tr>
<tr><td><code id="show_mettrndseason_+3A_ylim">ylim</code></td>
<td>
<p>optional numeric vector of length two for y-axis limits</p>
</td></tr>
<tr><td><code id="show_mettrndseason_+3A_...">...</code></td>
<td>
<p>additional arguments passed to <code>metfun</code>, e.g., <code>na.rm = TRUE)</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The plot is the same as that returned by <code><a href="#topic+show_metseason">show_metseason</a></code> with the addition of points for the seasonal metrics colored by the trends estimated from <code><a href="#topic+anlz_trndseason">anlz_trndseason</a></code> for the specified window and justification.  
</p>
<p>Four colors are used to define increasing, decreasing, no trend, or no estimate (i.e., too few points for the window).  The names and the colors can be changed using the <code>nms</code> and <code>cols</code> arguments, respectively.  The <code>cmbn</code> argument can be used to combine the no trend and no estimate colors into one color and label. Although this may be desired for aesthetic reasons, the colors and labels may be misleading with the default names since no trend is shown for points where no estimates were made.
</p>


<h3>Value</h3>

<p>A <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)

# data to model
tomod &lt;- rawdat %&gt;%
  filter(station %in% 34) %&gt;%
  filter(param %in% 'chl') %&gt;% 
  filter(yr &gt; 2015)

mod &lt;- anlz_gam(tomod, trans = 'log10')
show_mettrndseason(mod, metfun = mean, doystr = 90, doyend = 180, justify = 'center', 
  win = 4, ylab = 'Chlorophyll-a (ug/L)')
</code></pre>

<hr>
<h2 id='show_perchg'>Plot percent change trends from GAM results for selected time periods</h2><span id='topic+show_perchg'></span>

<h3>Description</h3>

<p>Plot percent change trends from GAM results for selected time periods
</p>


<h3>Usage</h3>

<pre><code class='language-R'>show_perchg(
  mod,
  baseyr,
  testyr,
  ylab,
  base_size = 11,
  xlim = NULL,
  ylim = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="show_perchg_+3A_mod">mod</code></td>
<td>
<p>input model object as returned by <code><a href="#topic+anlz_gam">anlz_gam</a></code></p>
</td></tr>
<tr><td><code id="show_perchg_+3A_baseyr">baseyr</code></td>
<td>
<p>numeric vector of starting years</p>
</td></tr>
<tr><td><code id="show_perchg_+3A_testyr">testyr</code></td>
<td>
<p>numeric vector of ending years</p>
</td></tr>
<tr><td><code id="show_perchg_+3A_ylab">ylab</code></td>
<td>
<p>chr string for y-axis label</p>
</td></tr>
<tr><td><code id="show_perchg_+3A_base_size">base_size</code></td>
<td>
<p>numeric indicating base font size, passed to <code><a href="ggplot2.html#topic+theme_bw">theme_bw</a></code></p>
</td></tr>
<tr><td><code id="show_perchg_+3A_xlim">xlim</code></td>
<td>
<p>optional numeric vector of length two for x-axis limits</p>
</td></tr>
<tr><td><code id="show_perchg_+3A_ylim">ylim</code></td>
<td>
<p>optional numeric vector of length two for y-axis limits</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)

# data to model
tomod &lt;- rawdat %&gt;%
  filter(station %in% 34) %&gt;%
  filter(param %in% 'chl')
  
mod &lt;- anlz_gam(tomod, trans = 'log10')

show_perchg(mod, baseyr = 1990, testyr = 2016, ylab = 'Chlorophyll-a (ug/L)')
</code></pre>

<hr>
<h2 id='show_prd3d'>Plot a 3-d surface of predictions</h2><span id='topic+show_prd3d'></span>

<h3>Description</h3>

<p>Plot a 3-d surface of predictions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>show_prd3d(mod, ylab)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="show_prd3d_+3A_mod">mod</code></td>
<td>
<p>input model object as returned by <code><a href="#topic+anlz_gam">anlz_gam</a></code></p>
</td></tr>
<tr><td><code id="show_prd3d_+3A_ylab">ylab</code></td>
<td>
<p>chr string for y-axis label</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>plotly</code> surface
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)

# data to model
tomod &lt;- rawdat %&gt;%
  filter(station %in% 34) %&gt;%
  filter(param %in% 'chl') %&gt;% 
  filter(yr &gt; 2015)
  
mod &lt;- anlz_gam(tomod, trans = 'log10')

show_prd3d(mod, ylab = 'Chlorophyll-a (ug/L)')
</code></pre>

<hr>
<h2 id='show_prddoy'>Plot predictions for GAMs against day of year</h2><span id='topic+show_prddoy'></span>

<h3>Description</h3>

<p>Plot predictions for GAMs against day of year
</p>


<h3>Usage</h3>

<pre><code class='language-R'>show_prddoy(mod, ylab, size = 0.5, alpha = 1, base_size = 11)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="show_prddoy_+3A_mod">mod</code></td>
<td>
<p>input model object as returned by <code><a href="#topic+anlz_gam">anlz_gam</a></code></p>
</td></tr>
<tr><td><code id="show_prddoy_+3A_ylab">ylab</code></td>
<td>
<p>chr string for y-axis label</p>
</td></tr>
<tr><td><code id="show_prddoy_+3A_size">size</code></td>
<td>
<p>numeric indicating line size</p>
</td></tr>
<tr><td><code id="show_prddoy_+3A_alpha">alpha</code></td>
<td>
<p>numeric from 0 to 1 indicating line transparency</p>
</td></tr>
<tr><td><code id="show_prddoy_+3A_base_size">base_size</code></td>
<td>
<p>numeric indicating base font size, passed to <code><a href="ggplot2.html#topic+theme_bw">theme_bw</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)

# data to model
tomod &lt;- rawdat %&gt;%
  filter(station %in% 34) %&gt;%
  filter(param %in% 'chl')

mod &lt;- anlz_gam(tomod, trans = 'log10')

show_prddoy(mod, ylab = 'Chlorophyll-a (ug/L)')
</code></pre>

<hr>
<h2 id='show_prdseason'>Plot predictions for GAMs over time, by season</h2><span id='topic+show_prdseason'></span>

<h3>Description</h3>

<p>Plot predictions for GAMs over time, by season
</p>


<h3>Usage</h3>

<pre><code class='language-R'>show_prdseason(mod, ylab, base_size = 11, xlim = NULL, ylim = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="show_prdseason_+3A_mod">mod</code></td>
<td>
<p>input model object as returned by <code><a href="#topic+anlz_gam">anlz_gam</a></code></p>
</td></tr>
<tr><td><code id="show_prdseason_+3A_ylab">ylab</code></td>
<td>
<p>chr string for y-axis label</p>
</td></tr>
<tr><td><code id="show_prdseason_+3A_base_size">base_size</code></td>
<td>
<p>numeric indicating base font size, passed to <code><a href="ggplot2.html#topic+theme_bw">theme_bw</a></code></p>
</td></tr>
<tr><td><code id="show_prdseason_+3A_xlim">xlim</code></td>
<td>
<p>optional numeric vector of length two for x-axis limits</p>
</td></tr>
<tr><td><code id="show_prdseason_+3A_ylim">ylim</code></td>
<td>
<p>optional numeric vector of length two for y-axis limits</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)

# data to model
tomod &lt;- rawdat %&gt;%
  filter(station %in% 34) %&gt;%
  filter(param %in% 'chl') %&gt;% 
  filter(yr &gt; 2015)
  
mod &lt;- anlz_gam(tomod, trans = 'log10')
show_prdseason(mod, ylab = 'Chlorophyll-a (ug/L)')
</code></pre>

<hr>
<h2 id='show_prdseries'>Plot predictions for GAMs over time series</h2><span id='topic+show_prdseries'></span>

<h3>Description</h3>

<p>Plot predictions for GAMs over time series
</p>


<h3>Usage</h3>

<pre><code class='language-R'>show_prdseries(
  mod,
  ylab,
  alpha = 0.7,
  base_size = 11,
  xlim = NULL,
  ylim = NULL,
  col = "brown"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="show_prdseries_+3A_mod">mod</code></td>
<td>
<p>input model object as returned by <code><a href="#topic+anlz_gam">anlz_gam</a></code></p>
</td></tr>
<tr><td><code id="show_prdseries_+3A_ylab">ylab</code></td>
<td>
<p>chr string for y-axis label</p>
</td></tr>
<tr><td><code id="show_prdseries_+3A_alpha">alpha</code></td>
<td>
<p>numeric from 0 to 1 indicating line transparency</p>
</td></tr>
<tr><td><code id="show_prdseries_+3A_base_size">base_size</code></td>
<td>
<p>numeric indicating base font size, passed to <code><a href="ggplot2.html#topic+theme_bw">theme_bw</a></code></p>
</td></tr>
<tr><td><code id="show_prdseries_+3A_xlim">xlim</code></td>
<td>
<p>optional numeric vector of length two for x-axis limits</p>
</td></tr>
<tr><td><code id="show_prdseries_+3A_ylim">ylim</code></td>
<td>
<p>optional numeric vector of length two for y-axis limits</p>
</td></tr>
<tr><td><code id="show_prdseries_+3A_col">col</code></td>
<td>
<p>optional chr string for line color</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)

# data to model
tomod &lt;- rawdat %&gt;%
  filter(station %in% 34) %&gt;%
  filter(param %in% 'chl')

mod &lt;- anlz_gam(tomod, trans = 'log10')

show_prdseries(mod, ylab = 'Chlorophyll-a (ug/L)')
</code></pre>

<hr>
<h2 id='show_sumtrndseason'>Plot seasonal rates of change based on average estimates for multiple window widths</h2><span id='topic+show_sumtrndseason'></span>

<h3>Description</h3>

<p>Plot seasonal rates of change based on average estimates for multiple window widths
</p>


<h3>Usage</h3>

<pre><code class='language-R'>show_sumtrndseason(
  mod,
  doystr = 1,
  doyend = 364,
  justify = c("center", "left", "right"),
  win = 5:15,
  txtsz = 6,
  cols = c("lightblue", "lightgreen"),
  base_size = 11
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="show_sumtrndseason_+3A_mod">mod</code></td>
<td>
<p>input model object as returned by <code><a href="#topic+anlz_gam">anlz_gam</a></code></p>
</td></tr>
<tr><td><code id="show_sumtrndseason_+3A_doystr">doystr</code></td>
<td>
<p>numeric indicating start Julian day for extracting averages</p>
</td></tr>
<tr><td><code id="show_sumtrndseason_+3A_doyend">doyend</code></td>
<td>
<p>numeric indicating ending Julian day for extracting averages</p>
</td></tr>
<tr><td><code id="show_sumtrndseason_+3A_justify">justify</code></td>
<td>
<p>chr string indicating the justification for the trend window</p>
</td></tr>
<tr><td><code id="show_sumtrndseason_+3A_win">win</code></td>
<td>
<p>numeric vector indicating number of years to use for the trend window</p>
</td></tr>
<tr><td><code id="show_sumtrndseason_+3A_txtsz">txtsz</code></td>
<td>
<p>numeric for size of text labels inside the plot</p>
</td></tr>
<tr><td><code id="show_sumtrndseason_+3A_cols">cols</code></td>
<td>
<p>vector of low/high colors for trends</p>
</td></tr>
<tr><td><code id="show_sumtrndseason_+3A_base_size">base_size</code></td>
<td>
<p>numeric indicating base font size, passed to <code><a href="ggplot2.html#topic+theme_bw">theme_bw</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function plots output from <code><a href="#topic+anlz_sumtrndseason">anlz_sumtrndseason</a></code>.
</p>


<h3>Value</h3>

<p>A <code><a href="ggplot2.html#topic+ggplot2">ggplot2</a></code> plot
</p>


<h3>See Also</h3>

<p>Other show: 
<code><a href="#topic+show_sumtrndseason2">show_sumtrndseason2</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)

# data to model
tomod &lt;- rawdat %&gt;%
  filter(station %in% 34) %&gt;%
  filter(param %in% 'chl') %&gt;% 
  filter(yr &gt; 2015)

mod &lt;- anlz_gam(tomod, trans = 'log10')
show_sumtrndseason(mod, doystr = 90, doyend = 180, justify = 'center', win = 2:3)
</code></pre>

<hr>
<h2 id='show_sumtrndseason2'>Plot seasonal rates of change in quarters based on average estimates for multiple window widths</h2><span id='topic+show_sumtrndseason2'></span>

<h3>Description</h3>

<p>Plot seasonal rates of change in quarters based on average estimates for multiple window widths
</p>


<h3>Usage</h3>

<pre><code class='language-R'>show_sumtrndseason2(
  mod,
  justify = c("center", "left", "right"),
  win = 5:15,
  txtsz = 6,
  cols = c("lightblue", "lightgreen"),
  base_size = 11
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="show_sumtrndseason2_+3A_mod">mod</code></td>
<td>
<p>input model object as returned by <code><a href="#topic+anlz_gam">anlz_gam</a></code></p>
</td></tr>
<tr><td><code id="show_sumtrndseason2_+3A_justify">justify</code></td>
<td>
<p>chr string indicating the justification for the trend window</p>
</td></tr>
<tr><td><code id="show_sumtrndseason2_+3A_win">win</code></td>
<td>
<p>numeric vector indicating number of years to use for the trend window</p>
</td></tr>
<tr><td><code id="show_sumtrndseason2_+3A_txtsz">txtsz</code></td>
<td>
<p>numeric for size of text labels inside the plot</p>
</td></tr>
<tr><td><code id="show_sumtrndseason2_+3A_cols">cols</code></td>
<td>
<p>vector of low/high colors for trends</p>
</td></tr>
<tr><td><code id="show_sumtrndseason2_+3A_base_size">base_size</code></td>
<td>
<p>numeric indicating base font size, passed to <code><a href="ggplot2.html#topic+theme_bw">theme_bw</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is similar to <code><a href="#topic+show_sumtrndseason">show_sumtrndseason</a></code> but results are grouped into seasonal quarters as four separate plots with a combined color scale.
</p>


<h3>Value</h3>

<p>A <code><a href="ggplot2.html#topic+ggplot2">ggplot2</a></code> plot
</p>


<h3>See Also</h3>

<p>Other show: 
<code><a href="#topic+show_sumtrndseason">show_sumtrndseason</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)

# data to model
tomod &lt;- rawdat %&gt;%
  filter(station %in% 34) %&gt;%
  filter(param %in% 'chl') %&gt;% 
  filter(yr &gt; 2015)

mod &lt;- anlz_gam(tomod, trans = 'log10')
show_sumtrndseason2(mod, justify = 'center', win = 2:3)
</code></pre>

<hr>
<h2 id='show_trndseason'>Plot rates of change based on seasonal metrics</h2><span id='topic+show_trndseason'></span>

<h3>Description</h3>

<p>Plot rates of change based on seasonal metrics
</p>


<h3>Usage</h3>

<pre><code class='language-R'>show_trndseason(
  mod,
  metfun = mean,
  doystr = 1,
  doyend = 364,
  type = c("log10", "approx"),
  justify = c("left", "right", "center"),
  win = 5,
  ylab,
  nsim = 10000,
  useave = FALSE,
  usearrow = FALSE,
  base_size = 11,
  xlim = NULL,
  ylim = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="show_trndseason_+3A_mod">mod</code></td>
<td>
<p>input model object as returned by <code><a href="#topic+anlz_gam">anlz_gam</a></code></p>
</td></tr>
<tr><td><code id="show_trndseason_+3A_metfun">metfun</code></td>
<td>
<p>function input for metric to calculate, e.g., <code>mean</code>, <code>var</code>, <code>max</code>, etc</p>
</td></tr>
<tr><td><code id="show_trndseason_+3A_doystr">doystr</code></td>
<td>
<p>numeric indicating start Julian day for extracting averages</p>
</td></tr>
<tr><td><code id="show_trndseason_+3A_doyend">doyend</code></td>
<td>
<p>numeric indicating ending Julian day for extracting averages</p>
</td></tr>
<tr><td><code id="show_trndseason_+3A_type">type</code></td>
<td>
<p>chr string indicating if log slopes are shown (if applicable)</p>
</td></tr>
<tr><td><code id="show_trndseason_+3A_justify">justify</code></td>
<td>
<p>chr string indicating the justification for the trend window</p>
</td></tr>
<tr><td><code id="show_trndseason_+3A_win">win</code></td>
<td>
<p>numeric indicating number of years to use for the trend window, see details</p>
</td></tr>
<tr><td><code id="show_trndseason_+3A_ylab">ylab</code></td>
<td>
<p>chr string for y-axis label</p>
</td></tr>
<tr><td><code id="show_trndseason_+3A_nsim">nsim</code></td>
<td>
<p>numeric indicating number of random draws for simulating uncertainty</p>
</td></tr>
<tr><td><code id="show_trndseason_+3A_useave">useave</code></td>
<td>
<p>logical indicating if <code>anlz_avgseason</code> is used for the seasonal metric calculation</p>
</td></tr>
<tr><td><code id="show_trndseason_+3A_usearrow">usearrow</code></td>
<td>
<p>logical indicating if arrows should be used to indicate significant trend direction</p>
</td></tr>
<tr><td><code id="show_trndseason_+3A_base_size">base_size</code></td>
<td>
<p>numeric indicating base font size, passed to <code><a href="ggplot2.html#topic+theme_bw">theme_bw</a></code></p>
</td></tr>
<tr><td><code id="show_trndseason_+3A_xlim">xlim</code></td>
<td>
<p>optional numeric vector of length two for x-axis limits</p>
</td></tr>
<tr><td><code id="show_trndseason_+3A_ylim">ylim</code></td>
<td>
<p>optional numeric vector of length two for y-axis limits</p>
</td></tr>
<tr><td><code id="show_trndseason_+3A_...">...</code></td>
<td>
<p>additional arguments passed to <code>metfun</code>, e.g., <code>na.rm = TRUE)</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)

# data to model
tomod &lt;- rawdat %&gt;%
  filter(station %in% 34) %&gt;%
  filter(param %in% 'chl') %&gt;% 
  filter(yr &gt; 2015)

mod &lt;- anlz_gam(tomod, trans = 'log10')
show_trndseason(mod, doystr = 90, doyend = 180, justify = 'left', win = 4,
     ylab = 'Slope Chlorophyll-a (ug/L/yr)')
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
