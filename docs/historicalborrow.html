<!DOCTYPE html><html><head><title>Help for package historicalborrow</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {historicalborrow}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#historicalborrow-package'><p>historicalborrow: Bayesian historical borrowing models for clinical studies.</p></a></li>
<li><a href='#hb_convergence'><p>Check convergence diagnostics</p></a></li>
<li><a href='#hb_data'><p>Standardize data</p></a></li>
<li><a href='#hb_mcmc_hierarchical'><p>Hierarchical model MCMC</p></a></li>
<li><a href='#hb_mcmc_independent'><p>Independent-study model MCMC</p></a></li>
<li><a href='#hb_mcmc_mixture'><p>Mixture model MCMC</p></a></li>
<li><a href='#hb_mcmc_mixture_hyperparameters'><p>Mixture model MCMC hyperparameters</p></a></li>
<li><a href='#hb_mcmc_pool'><p>Non-longitudinal pooled MCMC</p></a></li>
<li><a href='#hb_metrics'><p>Borrowing metrics</p></a></li>
<li><a href='#hb_plot_borrow'><p>Plot a borrowing model response against the benchmark models.</p></a></li>
<li><a href='#hb_plot_group'><p>Plot the groups of a borrowing model</p>
and its benchmark models.</a></li>
<li><a href='#hb_plot_tau'><p>Plot tau</p></a></li>
<li><a href='#hb_s_tau'><p>Suggest s_tau</p></a></li>
<li><a href='#hb_sim_hierarchical'><p>Non-longitudinal hierarchical simulations.</p></a></li>
<li><a href='#hb_sim_independent'><p>Non-longitudinal independent simulations.</p></a></li>
<li><a href='#hb_sim_mixture'><p>Non-longitudinal mixture simulations.</p></a></li>
<li><a href='#hb_sim_pool'><p>Non-longitudinal pooled simulations.</p></a></li>
<li><a href='#hb_summary'><p>Model summary</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Non-Longitudinal Bayesian Historical Borrowing Models</td>
</tr>
<tr>
<td>Description:</td>
<td>Historical borrowing in clinical trials can improve
  precision and operating characteristics. This package supports
  a hierarchical model and a mixture model to borrow historical
  control data from other studies to better characterize the
  control response of the current study. It also quantifies
  the amount of borrowing through benchmark models (independent
  and pooled). Some of the methods are discussed by
  Viele et al. (2013) &lt;<a href="https://doi.org/10.1002%2Fpst.1589">doi:10.1002/pst.1589</a>&gt;.</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.4</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://wlandau.github.io/historicalborrow/">https://wlandau.github.io/historicalborrow/</a>,
<a href="https://github.com/wlandau/historicalborrow">https://github.com/wlandau/historicalborrow</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/wlandau/historicalborrow/issues">https://github.com/wlandau/historicalborrow/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, ggplot2, Matrix, posterior, rjags, rlang, stats,
tibble, tidyr, tidyselect, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, markdown, rmarkdown, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-09-12 12:46:56 UTC; c240390</td>
</tr>
<tr>
<td>Author:</td>
<td>William Michael Landau
    <a href="https://orcid.org/0000-0003-1878-3253"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  Albert Man [rev],
  Eli Lilly and Company [cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>William Michael Landau &lt;will.landau@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-09-13 10:20:10 UTC</td>
</tr>
</table>
<hr>
<h2 id='historicalborrow-package'>historicalborrow: Bayesian historical borrowing models for clinical studies.</h2><span id='topic+historicalborrow-package'></span>

<h3>Description</h3>

<p>Bayesian historical borrowing models for clinical studies.
</p>

<hr>
<h2 id='hb_convergence'>Check convergence diagnostics</h2><span id='topic+hb_convergence'></span>

<h3>Description</h3>

<p>Check the convergence diagnostics on a model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hb_convergence(mcmc)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hb_convergence_+3A_mcmc">mcmc</code></td>
<td>
<p>A wide data frame of posterior samples returned by
<code><a href="#topic+hb_mcmc_hierarchical">hb_mcmc_hierarchical()</a></code> or similar MCMC function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame of summarized convergence diagnostics.
<code>max_rhat</code> is the maximum univariate Gelman/Rubin potential scale
reduction factor over all the parameters of the model,
<code>min_ess_bulk</code> is the minimum bulk effective sample size over the
parameters, and <code>min_ess_tail</code> is the minimum tail effective
sample size. <code>max_rhat</code> should be below 1.01, and the ESS metrics
should both be above 100 times the number of MCMC chains. If
any of these conditions are not true, the MCMC did not converge,
and it is recommended to try running the model for more saved
iterations (and if <code>max_rhat</code> is high, possibly more warmup
iterations).
</p>


<h3>See Also</h3>

<p>Other mcmc: 
<code><a href="#topic+hb_mcmc_hierarchical">hb_mcmc_hierarchical</a>()</code>,
<code><a href="#topic+hb_mcmc_independent">hb_mcmc_independent</a>()</code>,
<code><a href="#topic+hb_mcmc_mixture_hyperparameters">hb_mcmc_mixture_hyperparameters</a>()</code>,
<code><a href="#topic+hb_mcmc_mixture">hb_mcmc_mixture</a>()</code>,
<code><a href="#topic+hb_mcmc_pool">hb_mcmc_pool</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- hb_sim_pool(n_continuous = 2)$data
mcmc &lt;- hb_mcmc_pool(
  data,
  n_chains = 1,
  n_adapt = 100,
  n_warmup = 200,
  n_iterations = 200
)
hb_convergence(mcmc)
</code></pre>

<hr>
<h2 id='hb_data'>Standardize data</h2><span id='topic+hb_data'></span>

<h3>Description</h3>

<p>Standardize a tidy input dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hb_data(
  data,
  response,
  study,
  study_reference,
  group,
  group_reference,
  patient,
  covariates
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hb_data_+3A_data">data</code></td>
<td>
<p>A tidy data frame or <code>tibble</code> with the data.</p>
</td></tr>
<tr><td><code id="hb_data_+3A_response">response</code></td>
<td>
<p>Character of length 1,
name of the column in <code>data</code> with the response/outcome variable.
<code>data[[response]]</code> must be a continuous variable,
and it <em>should</em> be the change from baseline of a
clinical endpoint of interest, as opposed to just
the raw response. Treatment differences
are computed directly from this scale, please supply
change from baseline unless you are absolutely certain
that treatment differences computed directly from
this quantity are clinically meaningful.</p>
</td></tr>
<tr><td><code id="hb_data_+3A_study">study</code></td>
<td>
<p>Character of length 1,
name of the column in <code>data</code> with the study ID.</p>
</td></tr>
<tr><td><code id="hb_data_+3A_study_reference">study_reference</code></td>
<td>
<p>Atomic of length 1,
element of the <code>study</code> column that indicates
the current study.
(The other studies are historical studies.)</p>
</td></tr>
<tr><td><code id="hb_data_+3A_group">group</code></td>
<td>
<p>Character of length 1,
name of the column in <code>data</code> with the group ID.</p>
</td></tr>
<tr><td><code id="hb_data_+3A_group_reference">group_reference</code></td>
<td>
<p>Atomic of length 1,
element of the <code>group</code> column that indicates
the control group.
(The other groups may be treatment groups.)</p>
</td></tr>
<tr><td><code id="hb_data_+3A_patient">patient</code></td>
<td>
<p>Character of length 1,
name of the column in <code>data</code> with the patient ID.</p>
</td></tr>
<tr><td><code id="hb_data_+3A_covariates">covariates</code></td>
<td>
<p>Character vector of column names
in <code>data</code> with the columns with baseline covariates.
These can be continuous, categorical, or binary.
Regardless, <code>historicalborrow</code> derives the appropriate
model matrix.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Users do not normally need to call this function.
It mainly serves exposes the indexing behavior of
studies and group levels to aid in interpreting
summary tables.
</p>


<h3>Value</h3>

<p>A standardized tidy data frame with one row per patient
and the following columns:
</p>

<ul>
<li> <p><code>response</code>: continuous response/outcome variable. (Should be
change from baseline of an outcome of interest.)
</p>
</li>
<li> <p><code>study_label</code>: human-readable label of the study.
</p>
</li>
<li> <p><code>study</code>: integer study index with the max index equal to the
current study (at <code>study_reference</code>).
</p>
</li>
<li> <p><code>group_label</code>: human-readable group label (e.g. treatment arm name).
</p>
</li>
<li> <p><code>group</code>: integer group index with an index of 1 equal to the control
group (at <code>group_reference</code>).
</p>
</li>
<li> <p><code>patient_label</code>: original patient ID.
</p>
</li>
<li> <p><code>patient</code>: integer patient index.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;covariate_*&#8288;</code>: baseline covariate columns.
</p>
</li></ul>



<h3>See Also</h3>

<p>Other data: 
<code><a href="#topic+hb_s_tau">hb_s_tau</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- hb_sim_independent(n_continuous = 1, n_study = 2)$data
data &lt;- dplyr::select(
  data,
  study,
  group,
  patient,
  response,
  tidyselect::everything()
)
colnames(data) &lt;- c("trial", "arm", "subject", "change", "cov1", "cov2")
data$trial &lt;- paste0("trial", data$trial)
data$arm &lt;- paste0("arm", data$arm)
hb_data(
  data = data,
  response = "change",
  study = "trial",
  study_reference = "trial1",
  group = "arm",
  group_reference = "arm1",
  patient = "subject",
  covariates = c("cov1", "cov2")
)
</code></pre>

<hr>
<h2 id='hb_mcmc_hierarchical'>Hierarchical model MCMC</h2><span id='topic+hb_mcmc_hierarchical'></span>

<h3>Description</h3>

<p>Run the hierarchical model with MCMC.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hb_mcmc_hierarchical(
  data,
  response = "response",
  study = "study",
  study_reference = max(data[[study]]),
  group = "group",
  group_reference = min(data[[group]]),
  patient = "patient",
  covariates = grep("^covariate", colnames(data), value = TRUE),
  s_delta = 30,
  s_beta = 30,
  s_sigma = 30,
  s_mu = 30,
  s_tau = 30,
  n_chains = 4,
  n_adapt = 2000,
  n_warmup = 4000,
  n_iterations = 20000,
  quiet = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hb_mcmc_hierarchical_+3A_data">data</code></td>
<td>
<p>Tidy data frame with one row per patient,
indicator columns for the response variable,
study, group, and patient,
and covariates. All columns must be atomic vectors
(e.g. not lists). The data for the mixture and simple models
should have just one study,
and the others should have
data from more than one study. The simple model can be used
to get the historical data components of <code>m_omega</code> and <code>s_omega</code>
for the mixture model.</p>
</td></tr>
<tr><td><code id="hb_mcmc_hierarchical_+3A_response">response</code></td>
<td>
<p>Character of length 1,
name of the column in <code>data</code> with the response/outcome variable.
<code>data[[response]]</code> must be a continuous variable,
and it <em>should</em> be the change from baseline of a
clinical endpoint of interest, as opposed to just
the raw response. Treatment differences
are computed directly from this scale, please supply
change from baseline unless you are absolutely certain
that treatment differences computed directly from
this quantity are clinically meaningful.</p>
</td></tr>
<tr><td><code id="hb_mcmc_hierarchical_+3A_study">study</code></td>
<td>
<p>Character of length 1,
name of the column in <code>data</code> with the study ID.</p>
</td></tr>
<tr><td><code id="hb_mcmc_hierarchical_+3A_study_reference">study_reference</code></td>
<td>
<p>Atomic of length 1,
element of the <code>study</code> column that indicates
the current study.
(The other studies are historical studies.)</p>
</td></tr>
<tr><td><code id="hb_mcmc_hierarchical_+3A_group">group</code></td>
<td>
<p>Character of length 1,
name of the column in <code>data</code> with the group ID.</p>
</td></tr>
<tr><td><code id="hb_mcmc_hierarchical_+3A_group_reference">group_reference</code></td>
<td>
<p>Atomic of length 1,
element of the <code>group</code> column that indicates
the control group.
(The other groups may be treatment groups.)</p>
</td></tr>
<tr><td><code id="hb_mcmc_hierarchical_+3A_patient">patient</code></td>
<td>
<p>Character of length 1,
name of the column in <code>data</code> with the patient ID.</p>
</td></tr>
<tr><td><code id="hb_mcmc_hierarchical_+3A_covariates">covariates</code></td>
<td>
<p>Character vector of column names
in <code>data</code> with the columns with baseline covariates.
These can be continuous, categorical, or binary.
Regardless, <code>historicalborrow</code> derives the appropriate
model matrix.</p>
</td></tr>
<tr><td><code id="hb_mcmc_hierarchical_+3A_s_delta">s_delta</code></td>
<td>
<p>Numeric of length 1, prior standard deviation
of the study-by-group effect parameters <code>delta</code>.</p>
</td></tr>
<tr><td><code id="hb_mcmc_hierarchical_+3A_s_beta">s_beta</code></td>
<td>
<p>Numeric of length 1, prior standard deviation
of the fixed effects <code>beta</code>.</p>
</td></tr>
<tr><td><code id="hb_mcmc_hierarchical_+3A_s_sigma">s_sigma</code></td>
<td>
<p>Numeric of length 1, prior upper bound
of the residual standard deviations.</p>
</td></tr>
<tr><td><code id="hb_mcmc_hierarchical_+3A_s_mu">s_mu</code></td>
<td>
<p>Positive numeric of length 1,
hyperparameter: prior standard deviation of the
mean <code>mu</code> of the study-level control means <code>alpha</code>.</p>
</td></tr>
<tr><td><code id="hb_mcmc_hierarchical_+3A_s_tau">s_tau</code></td>
<td>
<p>Positive numeric of length 1,
hyperparameter: uniform  prior upper bound of the
standard deviation <code>tau</code> of the study-level control means <code>alpha</code>.</p>
</td></tr>
<tr><td><code id="hb_mcmc_hierarchical_+3A_n_chains">n_chains</code></td>
<td>
<p>Number of MCMC chains to run.</p>
</td></tr>
<tr><td><code id="hb_mcmc_hierarchical_+3A_n_adapt">n_adapt</code></td>
<td>
<p>Number of adaptation iterations to run.</p>
</td></tr>
<tr><td><code id="hb_mcmc_hierarchical_+3A_n_warmup">n_warmup</code></td>
<td>
<p>Number of warmup iterations per chain to run.</p>
</td></tr>
<tr><td><code id="hb_mcmc_hierarchical_+3A_n_iterations">n_iterations</code></td>
<td>
<p>Number of saved MCMC iterations per chain to run.</p>
</td></tr>
<tr><td><code id="hb_mcmc_hierarchical_+3A_quiet">quiet</code></td>
<td>
<p>Logical of length 1, <code>TRUE</code> to suppress R console output.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tidy data frame of parameter samples from the
posterior distribution. Columns <code>.chain</code>, <code>.iteration</code>,
and <code>.draw</code> have the meanings documented in the
<code>posterior</code> package.
</p>


<h3>See Also</h3>

<p>Other mcmc: 
<code><a href="#topic+hb_convergence">hb_convergence</a>()</code>,
<code><a href="#topic+hb_mcmc_independent">hb_mcmc_independent</a>()</code>,
<code><a href="#topic+hb_mcmc_mixture_hyperparameters">hb_mcmc_mixture_hyperparameters</a>()</code>,
<code><a href="#topic+hb_mcmc_mixture">hb_mcmc_mixture</a>()</code>,
<code><a href="#topic+hb_mcmc_pool">hb_mcmc_pool</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (!identical(Sys.getenv("HB_TEST", unset = ""), "")) {
data &lt;- hb_sim_hierarchical(n_continuous = 2)$data
hb_mcmc_hierarchical(
  data,
  n_chains = 1,
  n_adapt = 100,
  n_warmup = 50,
  n_iterations = 50
)
}
</code></pre>

<hr>
<h2 id='hb_mcmc_independent'>Independent-study model MCMC</h2><span id='topic+hb_mcmc_independent'></span>

<h3>Description</h3>

<p>Run the independent-study model with MCMC.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hb_mcmc_independent(
  data,
  response = "response",
  study = "study",
  study_reference = max(data[[study]]),
  group = "group",
  group_reference = min(data[[group]]),
  patient = "patient",
  covariates = grep("^covariate", colnames(data), value = TRUE),
  s_alpha = 30,
  s_delta = 30,
  s_beta = 30,
  s_sigma = 30,
  n_chains = 4,
  n_adapt = 2000,
  n_warmup = 4000,
  n_iterations = 20000,
  quiet = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hb_mcmc_independent_+3A_data">data</code></td>
<td>
<p>Tidy data frame with one row per patient,
indicator columns for the response variable,
study, group, and patient,
and covariates. All columns must be atomic vectors
(e.g. not lists). The data for the mixture and simple models
should have just one study,
and the others should have
data from more than one study. The simple model can be used
to get the historical data components of <code>m_omega</code> and <code>s_omega</code>
for the mixture model.</p>
</td></tr>
<tr><td><code id="hb_mcmc_independent_+3A_response">response</code></td>
<td>
<p>Character of length 1,
name of the column in <code>data</code> with the response/outcome variable.
<code>data[[response]]</code> must be a continuous variable,
and it <em>should</em> be the change from baseline of a
clinical endpoint of interest, as opposed to just
the raw response. Treatment differences
are computed directly from this scale, please supply
change from baseline unless you are absolutely certain
that treatment differences computed directly from
this quantity are clinically meaningful.</p>
</td></tr>
<tr><td><code id="hb_mcmc_independent_+3A_study">study</code></td>
<td>
<p>Character of length 1,
name of the column in <code>data</code> with the study ID.</p>
</td></tr>
<tr><td><code id="hb_mcmc_independent_+3A_study_reference">study_reference</code></td>
<td>
<p>Atomic of length 1,
element of the <code>study</code> column that indicates
the current study.
(The other studies are historical studies.)</p>
</td></tr>
<tr><td><code id="hb_mcmc_independent_+3A_group">group</code></td>
<td>
<p>Character of length 1,
name of the column in <code>data</code> with the group ID.</p>
</td></tr>
<tr><td><code id="hb_mcmc_independent_+3A_group_reference">group_reference</code></td>
<td>
<p>Atomic of length 1,
element of the <code>group</code> column that indicates
the control group.
(The other groups may be treatment groups.)</p>
</td></tr>
<tr><td><code id="hb_mcmc_independent_+3A_patient">patient</code></td>
<td>
<p>Character of length 1,
name of the column in <code>data</code> with the patient ID.</p>
</td></tr>
<tr><td><code id="hb_mcmc_independent_+3A_covariates">covariates</code></td>
<td>
<p>Character vector of column names
in <code>data</code> with the columns with baseline covariates.
These can be continuous, categorical, or binary.
Regardless, <code>historicalborrow</code> derives the appropriate
model matrix.</p>
</td></tr>
<tr><td><code id="hb_mcmc_independent_+3A_s_alpha">s_alpha</code></td>
<td>
<p>Numeric of length 1, prior standard deviation
of the study-specific control group mean parameters <code>alpha</code>.</p>
</td></tr>
<tr><td><code id="hb_mcmc_independent_+3A_s_delta">s_delta</code></td>
<td>
<p>Numeric of length 1, prior standard deviation
of the study-by-group effect parameters <code>delta</code>.</p>
</td></tr>
<tr><td><code id="hb_mcmc_independent_+3A_s_beta">s_beta</code></td>
<td>
<p>Numeric of length 1, prior standard deviation
of the fixed effects <code>beta</code>.</p>
</td></tr>
<tr><td><code id="hb_mcmc_independent_+3A_s_sigma">s_sigma</code></td>
<td>
<p>Numeric of length 1, prior upper bound
of the residual standard deviations.</p>
</td></tr>
<tr><td><code id="hb_mcmc_independent_+3A_n_chains">n_chains</code></td>
<td>
<p>Number of MCMC chains to run.</p>
</td></tr>
<tr><td><code id="hb_mcmc_independent_+3A_n_adapt">n_adapt</code></td>
<td>
<p>Number of adaptation iterations to run.</p>
</td></tr>
<tr><td><code id="hb_mcmc_independent_+3A_n_warmup">n_warmup</code></td>
<td>
<p>Number of warmup iterations per chain to run.</p>
</td></tr>
<tr><td><code id="hb_mcmc_independent_+3A_n_iterations">n_iterations</code></td>
<td>
<p>Number of saved MCMC iterations per chain to run.</p>
</td></tr>
<tr><td><code id="hb_mcmc_independent_+3A_quiet">quiet</code></td>
<td>
<p>Logical of length 1, <code>TRUE</code> to suppress R console output.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tidy data frame of parameter samples from the
posterior distribution. Columns <code>.chain</code>, <code>.iteration</code>,
and <code>.draw</code> have the meanings documented in the
<code>posterior</code> package.
</p>


<h3>See Also</h3>

<p>Other mcmc: 
<code><a href="#topic+hb_convergence">hb_convergence</a>()</code>,
<code><a href="#topic+hb_mcmc_hierarchical">hb_mcmc_hierarchical</a>()</code>,
<code><a href="#topic+hb_mcmc_mixture_hyperparameters">hb_mcmc_mixture_hyperparameters</a>()</code>,
<code><a href="#topic+hb_mcmc_mixture">hb_mcmc_mixture</a>()</code>,
<code><a href="#topic+hb_mcmc_pool">hb_mcmc_pool</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (!identical(Sys.getenv("HB_TEST", unset = ""), "")) {
data &lt;- hb_sim_independent(n_continuous = 2)$data
hb_mcmc_independent(
  data,
  n_chains = 1,
  n_adapt = 100,
  n_warmup = 50,
  n_iterations = 50
)
}
</code></pre>

<hr>
<h2 id='hb_mcmc_mixture'>Mixture model MCMC</h2><span id='topic+hb_mcmc_mixture'></span>

<h3>Description</h3>

<p>Run the mixture model with MCMC.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hb_mcmc_mixture(
  data,
  response = "response",
  study = "study",
  study_reference = max(data[[study]]),
  group = "group",
  group_reference = min(data[[group]]),
  patient = "patient",
  covariates = grep("^covariate", colnames(data), value = TRUE),
  s_delta = 30,
  s_beta = 30,
  s_sigma = 30,
  m_omega = c(0, 0),
  s_omega = c(30, 30),
  p_omega = 1/length(m_omega),
  n_chains = 4,
  n_adapt = 2000,
  n_warmup = 4000,
  n_iterations = 20000,
  quiet = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hb_mcmc_mixture_+3A_data">data</code></td>
<td>
<p>Tidy data frame with one row per patient,
indicator columns for the response variable,
study, group, and patient,
and covariates. All columns must be atomic vectors
(e.g. not lists). The data for the mixture and simple models
should have just one study,
and the others should have
data from more than one study. The simple model can be used
to get the historical data components of <code>m_omega</code> and <code>s_omega</code>
for the mixture model.</p>
</td></tr>
<tr><td><code id="hb_mcmc_mixture_+3A_response">response</code></td>
<td>
<p>Character of length 1,
name of the column in <code>data</code> with the response/outcome variable.
<code>data[[response]]</code> must be a continuous variable,
and it <em>should</em> be the change from baseline of a
clinical endpoint of interest, as opposed to just
the raw response. Treatment differences
are computed directly from this scale, please supply
change from baseline unless you are absolutely certain
that treatment differences computed directly from
this quantity are clinically meaningful.</p>
</td></tr>
<tr><td><code id="hb_mcmc_mixture_+3A_study">study</code></td>
<td>
<p>Character of length 1,
name of the column in <code>data</code> with the study ID.</p>
</td></tr>
<tr><td><code id="hb_mcmc_mixture_+3A_study_reference">study_reference</code></td>
<td>
<p>Atomic of length 1,
element of the <code>study</code> column that indicates
the current study.
(The other studies are historical studies.)</p>
</td></tr>
<tr><td><code id="hb_mcmc_mixture_+3A_group">group</code></td>
<td>
<p>Character of length 1,
name of the column in <code>data</code> with the group ID.</p>
</td></tr>
<tr><td><code id="hb_mcmc_mixture_+3A_group_reference">group_reference</code></td>
<td>
<p>Atomic of length 1,
element of the <code>group</code> column that indicates
the control group.
(The other groups may be treatment groups.)</p>
</td></tr>
<tr><td><code id="hb_mcmc_mixture_+3A_patient">patient</code></td>
<td>
<p>Character of length 1,
name of the column in <code>data</code> with the patient ID.</p>
</td></tr>
<tr><td><code id="hb_mcmc_mixture_+3A_covariates">covariates</code></td>
<td>
<p>Character vector of column names
in <code>data</code> with the columns with baseline covariates.
These can be continuous, categorical, or binary.
Regardless, <code>historicalborrow</code> derives the appropriate
model matrix.</p>
</td></tr>
<tr><td><code id="hb_mcmc_mixture_+3A_s_delta">s_delta</code></td>
<td>
<p>Numeric of length 1, prior standard deviation
of the study-by-group effect parameters <code>delta</code>.</p>
</td></tr>
<tr><td><code id="hb_mcmc_mixture_+3A_s_beta">s_beta</code></td>
<td>
<p>Numeric of length 1, prior standard deviation
of the fixed effects <code>beta</code>.</p>
</td></tr>
<tr><td><code id="hb_mcmc_mixture_+3A_s_sigma">s_sigma</code></td>
<td>
<p>Numeric of length 1, prior upper bound
of the residual standard deviations.</p>
</td></tr>
<tr><td><code id="hb_mcmc_mixture_+3A_m_omega">m_omega</code></td>
<td>
<p>Numeric with length equal to the number of
supposed studies (but only the current study is in the data).
<code>m_omega</code> is the prior control group mean of each study.
The last element corresponds to the current study,
and the others are for historical studies.</p>
</td></tr>
<tr><td><code id="hb_mcmc_mixture_+3A_s_omega">s_omega</code></td>
<td>
<p>Numeric with length equal to the number of
supposed studies (but only the current study is in the data).
<code>s_omega</code> is the prior control group standard deviation of each study.
The last element corresponds to the current study,
and the others are for historical studies.</p>
</td></tr>
<tr><td><code id="hb_mcmc_mixture_+3A_p_omega">p_omega</code></td>
<td>
<p>Numeric with length equal to the number of
supposed studies (but only the current study is in the data).
<code>p_omega</code> is the prior control group mixture proportion of each study.
The last element corresponds to the current study,
and the others are for historical studies.</p>
</td></tr>
<tr><td><code id="hb_mcmc_mixture_+3A_n_chains">n_chains</code></td>
<td>
<p>Number of MCMC chains to run.</p>
</td></tr>
<tr><td><code id="hb_mcmc_mixture_+3A_n_adapt">n_adapt</code></td>
<td>
<p>Number of adaptation iterations to run.</p>
</td></tr>
<tr><td><code id="hb_mcmc_mixture_+3A_n_warmup">n_warmup</code></td>
<td>
<p>Number of warmup iterations per chain to run.</p>
</td></tr>
<tr><td><code id="hb_mcmc_mixture_+3A_n_iterations">n_iterations</code></td>
<td>
<p>Number of saved MCMC iterations per chain to run.</p>
</td></tr>
<tr><td><code id="hb_mcmc_mixture_+3A_quiet">quiet</code></td>
<td>
<p>Logical of length 1, <code>TRUE</code> to suppress R console output.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The study-specific components of the mixture prior are all fixed
in advance. Mixture components are normal distributions
with means in <code>m_omega</code> and standard deviations in <code>s_omega</code>.
These vectors are ordered with historical studies first
and the current study last.
These mixture components can be computed using
<code><a href="#topic+hb_mcmc_mixture_hyperparameters">hb_mcmc_mixture_hyperparameters()</a></code> on a full set of data
(all the historical studies and the current study together).
Then the <code>m_omega</code> and <code>s_omega</code> columns of the output
can be plugged directly into <code><a href="#topic+hb_mcmc_mixture">hb_mcmc_mixture()</a></code>.
See the examples for a demonstration.
</p>


<h3>Value</h3>

<p>A tidy data frame of parameter samples from the
posterior distribution. Columns <code>.chain</code>, <code>.iteration</code>,
and <code>.draw</code> have the meanings documented in the
<code>posterior</code> package.
</p>


<h3>See Also</h3>

<p>Other mcmc: 
<code><a href="#topic+hb_convergence">hb_convergence</a>()</code>,
<code><a href="#topic+hb_mcmc_hierarchical">hb_mcmc_hierarchical</a>()</code>,
<code><a href="#topic+hb_mcmc_independent">hb_mcmc_independent</a>()</code>,
<code><a href="#topic+hb_mcmc_mixture_hyperparameters">hb_mcmc_mixture_hyperparameters</a>()</code>,
<code><a href="#topic+hb_mcmc_pool">hb_mcmc_pool</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data_all_studies &lt;- hb_sim_independent(n_continuous = 2)$data
data_all_studies$study &lt;- paste0("study", data_all_studies$study)
hyperparameters &lt;- hb_mcmc_mixture_hyperparameters(
  data = data_all_studies,
  response = "response",
  study = "study",
  study_reference = "study5",
  group = "group",
  group_reference = 1,
  patient = "patient",
  n_chains = 1,
  n_adapt = 100,
  n_warmup = 50,
  n_iterations = 50
)
print(hyperparameters)
data_current_study &lt;- dplyr::filter(data_all_studies, study == max(study))
hb_mcmc_mixture(
  data = data_current_study,
  response = "response",
  study = "study",
  study_reference = "study5",
  group = "group",
  group_reference = 1,
  patient = "patient",
  m_omega = hyperparameters$m_omega, # use hyperparams from historical data
  s_omega = hyperparameters$s_omega, # use hyperparams from historical data
  p_omega = rep(1 / nrow(hyperparameters), nrow(hyperparameters)),
  n_chains = 1,
  n_adapt = 100,
  n_warmup = 50,
  n_iterations = 50
)
</code></pre>

<hr>
<h2 id='hb_mcmc_mixture_hyperparameters'>Mixture model MCMC hyperparameters</h2><span id='topic+hb_mcmc_mixture_hyperparameters'></span>

<h3>Description</h3>

<p>Run a simple model separately on each historical study
control group and compute hyperparameters for <code><a href="#topic+hb_mcmc_mixture">hb_mcmc_mixture()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hb_mcmc_mixture_hyperparameters(
  data,
  response = "response",
  study = "study",
  study_reference = max(data[[study]]),
  group = "group",
  group_reference = min(data[[group]]),
  patient = "patient",
  m_mu = 0,
  s_mu = 30,
  s_sigma = 30,
  m_omega_current = 0,
  s_omega_current = 30,
  n_chains = 4,
  n_adapt = 2000,
  n_warmup = 4000,
  n_iterations = 20000,
  quiet = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hb_mcmc_mixture_hyperparameters_+3A_data">data</code></td>
<td>
<p>Tidy data frame with one row per patient,
indicator columns for the response variable,
study, group, and patient,
and covariates. All columns must be atomic vectors
(e.g. not lists). The data for the mixture and simple models
should have just one study,
and the others should have
data from more than one study. The simple model can be used
to get the historical data components of <code>m_omega</code> and <code>s_omega</code>
for the mixture model.</p>
</td></tr>
<tr><td><code id="hb_mcmc_mixture_hyperparameters_+3A_response">response</code></td>
<td>
<p>Character of length 1,
name of the column in <code>data</code> with the response/outcome variable.
<code>data[[response]]</code> must be a continuous variable,
and it <em>should</em> be the change from baseline of a
clinical endpoint of interest, as opposed to just
the raw response. Treatment differences
are computed directly from this scale, please supply
change from baseline unless you are absolutely certain
that treatment differences computed directly from
this quantity are clinically meaningful.</p>
</td></tr>
<tr><td><code id="hb_mcmc_mixture_hyperparameters_+3A_study">study</code></td>
<td>
<p>Character of length 1,
name of the column in <code>data</code> with the study ID.</p>
</td></tr>
<tr><td><code id="hb_mcmc_mixture_hyperparameters_+3A_study_reference">study_reference</code></td>
<td>
<p>Atomic of length 1,
element of the <code>study</code> column that indicates
the current study.
(The other studies are historical studies.)</p>
</td></tr>
<tr><td><code id="hb_mcmc_mixture_hyperparameters_+3A_group">group</code></td>
<td>
<p>Character of length 1,
name of the column in <code>data</code> with the group ID.</p>
</td></tr>
<tr><td><code id="hb_mcmc_mixture_hyperparameters_+3A_group_reference">group_reference</code></td>
<td>
<p>Atomic of length 1,
element of the <code>group</code> column that indicates
the control group.
(The other groups may be treatment groups.)</p>
</td></tr>
<tr><td><code id="hb_mcmc_mixture_hyperparameters_+3A_patient">patient</code></td>
<td>
<p>Character of length 1,
name of the column in <code>data</code> with the patient ID.</p>
</td></tr>
<tr><td><code id="hb_mcmc_mixture_hyperparameters_+3A_m_mu">m_mu</code></td>
<td>
<p>Numeric of length 1, prior mean of the mean <code>mu</code> in
the simple model.</p>
</td></tr>
<tr><td><code id="hb_mcmc_mixture_hyperparameters_+3A_s_mu">s_mu</code></td>
<td>
<p>Numeric of length 1, prior standard deviation of the
mean <code>mu</code> in the simple model.</p>
</td></tr>
<tr><td><code id="hb_mcmc_mixture_hyperparameters_+3A_s_sigma">s_sigma</code></td>
<td>
<p>Numeric of length 1, uniform prior upper bound
of the residual standard deviation <code>sigma</code> in the simple model.</p>
</td></tr>
<tr><td><code id="hb_mcmc_mixture_hyperparameters_+3A_m_omega_current">m_omega_current</code></td>
<td>
<p>Numeric with length 1,
<code>m_omega</code> value of the current study.
Inserted as the final component of the <code>m_omega</code> column in the output.</p>
</td></tr>
<tr><td><code id="hb_mcmc_mixture_hyperparameters_+3A_s_omega_current">s_omega_current</code></td>
<td>
<p>Numeric with length 1,
<code>s_omega</code> value of the current study.
Inserted as the final component of the <code>s_omega</code> column in the output.</p>
</td></tr>
<tr><td><code id="hb_mcmc_mixture_hyperparameters_+3A_n_chains">n_chains</code></td>
<td>
<p>Number of MCMC chains to run.</p>
</td></tr>
<tr><td><code id="hb_mcmc_mixture_hyperparameters_+3A_n_adapt">n_adapt</code></td>
<td>
<p>Number of adaptation iterations to run.</p>
</td></tr>
<tr><td><code id="hb_mcmc_mixture_hyperparameters_+3A_n_warmup">n_warmup</code></td>
<td>
<p>Number of warmup iterations per chain to run.</p>
</td></tr>
<tr><td><code id="hb_mcmc_mixture_hyperparameters_+3A_n_iterations">n_iterations</code></td>
<td>
<p>Number of saved MCMC iterations per chain to run.</p>
</td></tr>
<tr><td><code id="hb_mcmc_mixture_hyperparameters_+3A_quiet">quiet</code></td>
<td>
<p>Logical of length 1, <code>TRUE</code> to suppress R console output.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The model is a simple Bayesian model with a normal likelihood,
an unknown mean <code>mu</code>, and an unknown standard deviation <code>sigma</code>.
For each historical study, the posterior mean of <code>mu</code> becomes
the corresponding component of <code>m_omega</code> in the output,
and the posterior standard deviation of <code>mu</code>
becomes the corresponding component of <code>s_omega</code> in the output.
See the examples in this help file for a demonstration.
<code>m_omega</code> and <code>s_omega</code> define the components of the mixture prior
in <code><a href="#topic+hb_mcmc_mixture">hb_mcmc_mixture()</a></code> that act as the contribution of the
historical studies to the model.
</p>


<h3>Value</h3>

<p>A tidy data frame of hyperparameter values for <code><a href="#topic+hb_mcmc_mixture">hb_mcmc_mixture()</a></code>.
The first several rows are for historical studies, and the last row
is for the current study. Studies/rows are sorted in the order
<code><a href="#topic+hb_mcmc_mixture">hb_mcmc_mixture()</a></code> sorts them, so you can use columns <code>m_omega</code>
and <code>s_omega</code> for the same dataset and same values of other arguments
directly in <code><a href="#topic+hb_mcmc_mixture">hb_mcmc_mixture()</a></code>.
</p>


<h3>See Also</h3>

<p>Other mcmc: 
<code><a href="#topic+hb_convergence">hb_convergence</a>()</code>,
<code><a href="#topic+hb_mcmc_hierarchical">hb_mcmc_hierarchical</a>()</code>,
<code><a href="#topic+hb_mcmc_independent">hb_mcmc_independent</a>()</code>,
<code><a href="#topic+hb_mcmc_mixture">hb_mcmc_mixture</a>()</code>,
<code><a href="#topic+hb_mcmc_pool">hb_mcmc_pool</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data_all_studies &lt;- hb_sim_independent(n_continuous = 2)$data
data_all_studies$study &lt;- paste0("study", data_all_studies$study)
hyperparameters &lt;- hb_mcmc_mixture_hyperparameters(
  data = data_all_studies,
  response = "response",
  study = "study",
  study_reference = "study5",
  group = "group",
  group_reference = 1,
  patient = "patient",
  n_chains = 1,
  n_adapt = 100,
  n_warmup = 50,
  n_iterations = 50
)
print(hyperparameters)
data_current_study &lt;- dplyr::filter(data_all_studies, study == max(study))
hb_mcmc_mixture(
  data = data_current_study,
  response = "response",
  study = "study",
  study_reference = "study5",
  group = "group",
  group_reference = 1,
  patient = "patient",
  m_omega = hyperparameters$m_omega, # use hyperparams from historical data
  s_omega = hyperparameters$s_omega, # use hyperparams from historical data
  p_omega = rep(1 / nrow(hyperparameters), nrow(hyperparameters)),
  n_chains = 1,
  n_adapt = 100,
  n_warmup = 50,
  n_iterations = 50
)
</code></pre>

<hr>
<h2 id='hb_mcmc_pool'>Non-longitudinal pooled MCMC</h2><span id='topic+hb_mcmc_pool'></span>

<h3>Description</h3>

<p>Run the non-longitudinal pooled model with MCMC.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hb_mcmc_pool(
  data,
  response = "response",
  study = "study",
  study_reference = max(data[[study]]),
  group = "group",
  group_reference = min(data[[group]]),
  patient = "patient",
  covariates = grep("^covariate", colnames(data), value = TRUE),
  s_alpha = 30,
  s_delta = 30,
  s_beta = 30,
  s_sigma = 30,
  n_chains = 4,
  n_adapt = 2000,
  n_warmup = 4000,
  n_iterations = 20000,
  quiet = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hb_mcmc_pool_+3A_data">data</code></td>
<td>
<p>Tidy data frame with one row per patient,
indicator columns for the response variable,
study, group, and patient,
and covariates. All columns must be atomic vectors
(e.g. not lists). The data for the mixture and simple models
should have just one study,
and the others should have
data from more than one study. The simple model can be used
to get the historical data components of <code>m_omega</code> and <code>s_omega</code>
for the mixture model.</p>
</td></tr>
<tr><td><code id="hb_mcmc_pool_+3A_response">response</code></td>
<td>
<p>Character of length 1,
name of the column in <code>data</code> with the response/outcome variable.
<code>data[[response]]</code> must be a continuous variable,
and it <em>should</em> be the change from baseline of a
clinical endpoint of interest, as opposed to just
the raw response. Treatment differences
are computed directly from this scale, please supply
change from baseline unless you are absolutely certain
that treatment differences computed directly from
this quantity are clinically meaningful.</p>
</td></tr>
<tr><td><code id="hb_mcmc_pool_+3A_study">study</code></td>
<td>
<p>Character of length 1,
name of the column in <code>data</code> with the study ID.</p>
</td></tr>
<tr><td><code id="hb_mcmc_pool_+3A_study_reference">study_reference</code></td>
<td>
<p>Atomic of length 1,
element of the <code>study</code> column that indicates
the current study.
(The other studies are historical studies.)</p>
</td></tr>
<tr><td><code id="hb_mcmc_pool_+3A_group">group</code></td>
<td>
<p>Character of length 1,
name of the column in <code>data</code> with the group ID.</p>
</td></tr>
<tr><td><code id="hb_mcmc_pool_+3A_group_reference">group_reference</code></td>
<td>
<p>Atomic of length 1,
element of the <code>group</code> column that indicates
the control group.
(The other groups may be treatment groups.)</p>
</td></tr>
<tr><td><code id="hb_mcmc_pool_+3A_patient">patient</code></td>
<td>
<p>Character of length 1,
name of the column in <code>data</code> with the patient ID.</p>
</td></tr>
<tr><td><code id="hb_mcmc_pool_+3A_covariates">covariates</code></td>
<td>
<p>Character vector of column names
in <code>data</code> with the columns with baseline covariates.
These can be continuous, categorical, or binary.
Regardless, <code>historicalborrow</code> derives the appropriate
model matrix.</p>
</td></tr>
<tr><td><code id="hb_mcmc_pool_+3A_s_alpha">s_alpha</code></td>
<td>
<p>Numeric of length 1, prior standard deviation
of the study-specific control group mean parameters <code>alpha</code>.</p>
</td></tr>
<tr><td><code id="hb_mcmc_pool_+3A_s_delta">s_delta</code></td>
<td>
<p>Numeric of length 1, prior standard deviation
of the study-by-group effect parameters <code>delta</code>.</p>
</td></tr>
<tr><td><code id="hb_mcmc_pool_+3A_s_beta">s_beta</code></td>
<td>
<p>Numeric of length 1, prior standard deviation
of the fixed effects <code>beta</code>.</p>
</td></tr>
<tr><td><code id="hb_mcmc_pool_+3A_s_sigma">s_sigma</code></td>
<td>
<p>Numeric of length 1, prior upper bound
of the residual standard deviations.</p>
</td></tr>
<tr><td><code id="hb_mcmc_pool_+3A_n_chains">n_chains</code></td>
<td>
<p>Number of MCMC chains to run.</p>
</td></tr>
<tr><td><code id="hb_mcmc_pool_+3A_n_adapt">n_adapt</code></td>
<td>
<p>Number of adaptation iterations to run.</p>
</td></tr>
<tr><td><code id="hb_mcmc_pool_+3A_n_warmup">n_warmup</code></td>
<td>
<p>Number of warmup iterations per chain to run.</p>
</td></tr>
<tr><td><code id="hb_mcmc_pool_+3A_n_iterations">n_iterations</code></td>
<td>
<p>Number of saved MCMC iterations per chain to run.</p>
</td></tr>
<tr><td><code id="hb_mcmc_pool_+3A_quiet">quiet</code></td>
<td>
<p>Logical of length 1, <code>TRUE</code> to suppress R console output.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tidy data frame of parameter samples from the
posterior distribution. Columns <code>.chain</code>, <code>.iteration</code>,
and <code>.draw</code> have the meanings documented in the
<code>posterior</code> package.
</p>


<h3>See Also</h3>

<p>Other mcmc: 
<code><a href="#topic+hb_convergence">hb_convergence</a>()</code>,
<code><a href="#topic+hb_mcmc_hierarchical">hb_mcmc_hierarchical</a>()</code>,
<code><a href="#topic+hb_mcmc_independent">hb_mcmc_independent</a>()</code>,
<code><a href="#topic+hb_mcmc_mixture_hyperparameters">hb_mcmc_mixture_hyperparameters</a>()</code>,
<code><a href="#topic+hb_mcmc_mixture">hb_mcmc_mixture</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (!identical(Sys.getenv("HB_TEST", unset = ""), "")) {
data &lt;- hb_sim_pool(n_continuous = 2)$data
hb_mcmc_pool(
  data,
  n_chains = 1,
  n_adapt = 100,
  n_warmup = 50,
  n_iterations = 50
)
}
</code></pre>

<hr>
<h2 id='hb_metrics'>Borrowing metrics</h2><span id='topic+hb_metrics'></span>

<h3>Description</h3>

<p>Calculate historical borrowing metrics using
summary output from a fitted borrowing model and
analogous summaries from the benchmark models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hb_metrics(borrow, pool, independent)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hb_metrics_+3A_borrow">borrow</code></td>
<td>
<p>A data frame returned by <code><a href="#topic+hb_summary">hb_summary()</a></code>
for a borrowing model,
either the hierarchical model or the mixture model.</p>
</td></tr>
<tr><td><code id="hb_metrics_+3A_pool">pool</code></td>
<td>
<p>A data frame returned by <code><a href="#topic+hb_summary">hb_summary()</a></code>
for the pooled model.</p>
</td></tr>
<tr><td><code id="hb_metrics_+3A_independent">independent</code></td>
<td>
<p>A data frame returned by <code><a href="#topic+hb_summary">hb_summary()</a></code>
for the independent model.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with borrowing metrics.
</p>


<h3>See Also</h3>

<p>Other summary: 
<code><a href="#topic+hb_summary">hb_summary</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (!identical(Sys.getenv("HB_TEST", unset = ""), "")) {
data &lt;- hb_sim_independent(n_continuous = 2)$data
mcmc_borrow &lt;- hb_mcmc_hierarchical(
  data,
  n_chains = 1,
  n_adapt = 100,
  n_warmup = 100,
  n_iterations = 200
)
mcmc_pool &lt;- hb_mcmc_pool(
  data,
  n_chains = 1,
  n_adapt = 100,
  n_warmup = 50,
  n_iterations = 50
)
mcmc_independent &lt;- hb_mcmc_independent(
  data,
  n_chains = 1,
  n_adapt = 100,
  n_warmup = 50,
  n_iterations = 50
)
borrow &lt;- hb_summary(mcmc_borrow, data)
pool &lt;- hb_summary(mcmc_pool, data)
independent &lt;- hb_summary(mcmc_independent, data)
hb_metrics(
  borrow = borrow,
  pool = pool,
  independent = independent
)
}
</code></pre>

<hr>
<h2 id='hb_plot_borrow'>Plot a borrowing model response against the benchmark models.</h2><span id='topic+hb_plot_borrow'></span>

<h3>Description</h3>

<p>Plot the response from a
borrowing model (hierarchical or mixture)
against the independent and pooled benchmark models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hb_plot_borrow(borrow, pool, independent, outcome = c("response", "diff"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hb_plot_borrow_+3A_borrow">borrow</code></td>
<td>
<p>A data frame returned by <code><a href="#topic+hb_summary">hb_summary()</a></code>
for a borrowing model,
either the hierarchical model or the mixture model.</p>
</td></tr>
<tr><td><code id="hb_plot_borrow_+3A_pool">pool</code></td>
<td>
<p>A data frame returned by <code><a href="#topic+hb_summary">hb_summary()</a></code>
for the pooled model.</p>
</td></tr>
<tr><td><code id="hb_plot_borrow_+3A_independent">independent</code></td>
<td>
<p>A data frame returned by <code><a href="#topic+hb_summary">hb_summary()</a></code>
for the independent model.</p>
</td></tr>
<tr><td><code id="hb_plot_borrow_+3A_outcome">outcome</code></td>
<td>
<p>Character of length 1, either <code>"response"</code>
or <code>"diff"</code>, the quantity to plot on the vertical axis.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>ggplot</code> object
</p>


<h3>See Also</h3>

<p>Other plot: 
<code><a href="#topic+hb_plot_group">hb_plot_group</a>()</code>,
<code><a href="#topic+hb_plot_tau">hb_plot_tau</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (!identical(Sys.getenv("HB_TEST", unset = ""), "")) {
data &lt;- hb_sim_independent(n_continuous = 2)$data
mcmc_borrow &lt;- hb_mcmc_hierarchical(
  data,
  n_chains = 1,
  n_adapt = 100,
  n_warmup = 100,
  n_iterations = 200
)
mcmc_pool &lt;- hb_mcmc_pool(
  data,
  n_chains = 1,
  n_adapt = 100,
  n_warmup = 200,
  n_iterations = 200
)
mcmc_independent &lt;- hb_mcmc_independent(
  data,
  n_chains = 1,
  n_adapt = 100,
  n_warmup = 200,
  n_iterations = 200
)
borrow &lt;- hb_summary(mcmc_borrow, data)
pool &lt;- hb_summary(mcmc_pool, data)
independent &lt;- hb_summary(mcmc_independent, data)
hb_plot_borrow(
  borrow = borrow,
  pool = pool,
  independent = independent
)
}
</code></pre>

<hr>
<h2 id='hb_plot_group'>Plot the groups of a borrowing model
and its benchmark models.</h2><span id='topic+hb_plot_group'></span>

<h3>Description</h3>

<p>Plot the groups against one another
for a borrowing model (hierarchical or mixture)
and the independent and pooled benchmark models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hb_plot_group(borrow, pool, independent, outcome = c("response", "diff"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hb_plot_group_+3A_borrow">borrow</code></td>
<td>
<p>A data frame returned by <code><a href="#topic+hb_summary">hb_summary()</a></code>
for a borrowing model,
either the hierarchical model or the mixture model.</p>
</td></tr>
<tr><td><code id="hb_plot_group_+3A_pool">pool</code></td>
<td>
<p>A data frame returned by <code><a href="#topic+hb_summary">hb_summary()</a></code>
for the pooled model.</p>
</td></tr>
<tr><td><code id="hb_plot_group_+3A_independent">independent</code></td>
<td>
<p>A data frame returned by <code><a href="#topic+hb_summary">hb_summary()</a></code>
for the independent model.</p>
</td></tr>
<tr><td><code id="hb_plot_group_+3A_outcome">outcome</code></td>
<td>
<p>Character of length 1, either <code>"response"</code>
or <code>"diff"</code>, the quantity to plot on the vertical axis.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>ggplot</code> object
</p>


<h3>See Also</h3>

<p>Other plot: 
<code><a href="#topic+hb_plot_borrow">hb_plot_borrow</a>()</code>,
<code><a href="#topic+hb_plot_tau">hb_plot_tau</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (!identical(Sys.getenv("HB_TEST", unset = ""), "")) {
data &lt;- hb_sim_independent(n_continuous = 2)$data
mcmc_borrow &lt;- hb_mcmc_hierarchical(
  data,
  n_chains = 1,
  n_adapt = 100,
  n_warmup = 100,
  n_iterations = 200
)
mcmc_pool &lt;- hb_mcmc_pool(
  data,
  n_chains = 1,
  n_adapt = 100,
  n_warmup = 200,
  n_iterations = 200
)
mcmc_independent &lt;- hb_mcmc_independent(
  data,
  n_chains = 1,
  n_adapt = 100,
  n_warmup = 200,
  n_iterations = 200
)
borrow &lt;- hb_summary(mcmc_borrow, data)
pool &lt;- hb_summary(mcmc_pool, data)
independent &lt;- hb_summary(mcmc_independent, data)
hb_plot_group(
  borrow = borrow,
  pool = pool,
  independent = independent
)
}
</code></pre>

<hr>
<h2 id='hb_plot_tau'>Plot tau</h2><span id='topic+hb_plot_tau'></span>

<h3>Description</h3>

<p>Plot the tau parameter of a fitted hierarchical model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hb_plot_tau(mcmc)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hb_plot_tau_+3A_mcmc">mcmc</code></td>
<td>
<p>Data frame of posterior samples generated by
<code><a href="#topic+hb_mcmc_hierarchical">hb_mcmc_hierarchical()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>ggplot</code> object
</p>


<h3>See Also</h3>

<p>Other plot: 
<code><a href="#topic+hb_plot_borrow">hb_plot_borrow</a>()</code>,
<code><a href="#topic+hb_plot_group">hb_plot_group</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- hb_sim_independent(n_continuous = 2)$data
mcmc &lt;- hb_mcmc_hierarchical(
  data,
  n_chains = 1,
  n_adapt = 100,
  n_warmup = 100,
  n_iterations = 200
)
hb_plot_tau(mcmc = mcmc)
</code></pre>

<hr>
<h2 id='hb_s_tau'>Suggest s_tau</h2><span id='topic+hb_s_tau'></span>

<h3>Description</h3>

<p>Suggest a value of the <code>s_tau</code> hyperparameter
to achieve a given amount of borrowing in the hierarchical model.
Only use if a diffuse prior on <code>tau</code> is not feasible.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hb_s_tau(precision_ratio = 0.5, sigma = 1, n = 100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hb_s_tau_+3A_precision_ratio">precision_ratio</code></td>
<td>
<p>Positive numeric vector of elements between 0 and 1
with target precision ratios.</p>
</td></tr>
<tr><td><code id="hb_s_tau_+3A_sigma">sigma</code></td>
<td>
<p>Positive numeric vector of residual standard deviations.</p>
</td></tr>
<tr><td><code id="hb_s_tau_+3A_n">n</code></td>
<td>
<p>Number of non-missing patients.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See the hierarchical model section of the
methods vignette for details.
</p>


<h3>Value</h3>

<p>Numeric of length equal to <code>length(precision_ratio)</code> and
<code>length(sigma)</code>, suggested values of s_tau for each element of
<code>precision_ratio</code> and <code>sigma</code>.
</p>


<h3>See Also</h3>

<p>Other data: 
<code><a href="#topic+hb_data">hb_data</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>hb_s_tau(precision_ratio = 0.5, sigma = 1, n = 100)
</code></pre>

<hr>
<h2 id='hb_sim_hierarchical'>Non-longitudinal hierarchical simulations.</h2><span id='topic+hb_sim_hierarchical'></span>

<h3>Description</h3>

<p>Simulate from the non-longitudinal hierarchical model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hb_sim_hierarchical(
  n_study = 5,
  n_group = 3,
  n_patient = 100,
  n_continuous = 0,
  n_binary = 0,
  s_delta = 1,
  s_beta = 1,
  s_sigma = 1,
  s_mu = 1,
  s_tau = 1,
  alpha = stats::rnorm(n = n_study, mean = mu, sd = tau),
  delta = stats::rnorm(n = n_group - 1, mean = 0, sd = s_delta),
  beta = stats::rnorm(n = n_study * (n_continuous + n_binary), mean = 0, sd = s_delta),
  sigma = stats::runif(n = n_study, min = 0, max = s_sigma),
  mu = stats::rnorm(n = 1, mean = 0, sd = s_mu),
  tau = stats::runif(n = 1, min = 0, max = s_tau)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hb_sim_hierarchical_+3A_n_study">n_study</code></td>
<td>
<p>Number of studies to simulate.</p>
</td></tr>
<tr><td><code id="hb_sim_hierarchical_+3A_n_group">n_group</code></td>
<td>
<p>Number of groups (e.g. study arms) to simulate per study.</p>
</td></tr>
<tr><td><code id="hb_sim_hierarchical_+3A_n_patient">n_patient</code></td>
<td>
<p>Number of patients to simulate per study per group.</p>
</td></tr>
<tr><td><code id="hb_sim_hierarchical_+3A_n_continuous">n_continuous</code></td>
<td>
<p>Number of continuous covariates to simulate
(all from independent standard normal distributions).</p>
</td></tr>
<tr><td><code id="hb_sim_hierarchical_+3A_n_binary">n_binary</code></td>
<td>
<p>Number of binary covariates to simulate
(all from independent Bernoulli distributions with p = 0.5).</p>
</td></tr>
<tr><td><code id="hb_sim_hierarchical_+3A_s_delta">s_delta</code></td>
<td>
<p>Numeric of length 1, prior standard deviation
of the study-by-group effect parameters <code>delta</code>.</p>
</td></tr>
<tr><td><code id="hb_sim_hierarchical_+3A_s_beta">s_beta</code></td>
<td>
<p>Numeric of length 1, prior standard deviation
of the fixed effects <code>beta</code>.</p>
</td></tr>
<tr><td><code id="hb_sim_hierarchical_+3A_s_sigma">s_sigma</code></td>
<td>
<p>Numeric of length 1, prior upper bound
of the residual standard deviations.</p>
</td></tr>
<tr><td><code id="hb_sim_hierarchical_+3A_s_mu">s_mu</code></td>
<td>
<p>Numeric of length 1,
prior standard deviation of <code>mu</code>.</p>
</td></tr>
<tr><td><code id="hb_sim_hierarchical_+3A_s_tau">s_tau</code></td>
<td>
<p>Numeric of length 1,
Upper bound on <code>tau</code>.</p>
</td></tr>
<tr><td><code id="hb_sim_hierarchical_+3A_alpha">alpha</code></td>
<td>
<p>Numeric vector of length 1 for the pooled
and mixture models and length <code>n_study</code> for the
independent and hierarchical models.
<code>alpha</code> is the vector of control group mean parameters.
<code>alpha</code> enters the model by multiplying with
<code style="white-space: pre;">&#8288;$matrices$x_alpha&#8288;</code> (see the return value).
The control group in the data is the one with the
<code>group</code> column equal to 1.</p>
</td></tr>
<tr><td><code id="hb_sim_hierarchical_+3A_delta">delta</code></td>
<td>
<p>Numeric vector of length <code>n_group - 1</code>
of treatment effect parameters.
<code>delta</code> enters the model by multiplying with
<code style="white-space: pre;">&#8288;$matrices$x_delta&#8288;</code> (see the return value).
The control (non-treatment) group in the data is the one with the
<code>group</code> column equal to 1.</p>
</td></tr>
<tr><td><code id="hb_sim_hierarchical_+3A_beta">beta</code></td>
<td>
<p>Numeric vector of <code>n_study * (n_continuous + n_binary)</code>
fixed effect parameters. Within each study,
the first <code>n_continuous</code> betas
are for the continuous covariates, and the rest are for
the binary covariates. All the <code>beta</code>s for one study
appear before all the <code>beta</code>s for the next study,
and studies are arranged in increasing order of
the sorted unique values in <code style="white-space: pre;">&#8288;$data$study&#8288;</code> in the output.
<code>betas</code> enters the model by multiplying with
<code style="white-space: pre;">&#8288;$matrices$x_alpha&#8288;</code> (see the return value).</p>
</td></tr>
<tr><td><code id="hb_sim_hierarchical_+3A_sigma">sigma</code></td>
<td>
<p>Numeric vector of <code>n_study</code> study-specific
residual standard deviations.</p>
</td></tr>
<tr><td><code id="hb_sim_hierarchical_+3A_mu">mu</code></td>
<td>
<p>Numeric of length 1,
mean of the control group means <code>alpha</code>.</p>
</td></tr>
<tr><td><code id="hb_sim_hierarchical_+3A_tau">tau</code></td>
<td>
<p>Numeric of length 1,
standard deviation of the control group means <code>alpha</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following elements:
</p>

<ul>
<li> <p><code>data</code>: tidy long-form dataset with the patient-level data.
one row per patient and indicator columns for the study,
group (e.g. treatment arm), and patient ID. The <code>response</code>
columns is the patient response. The other columns are
baseline covariates. The control group is the one with
the <code>group</code> column equal to 1, and the current study (non-historical)
is the one with the maximum value of the <code>study</code> column.
Only the current study has any non-control-group patients,
the historical studies have only the control group.
</p>
</li>
<li> <p><code>parameters</code>: named list of model parameter values.
See the model specification vignette for details.
</p>
</li>
<li> <p><code>matrices</code>: A named list of model matrices.
See the model specification vignette for details.
</p>
</li></ul>



<h3>See Also</h3>

<p>Other simulate: 
<code><a href="#topic+hb_sim_independent">hb_sim_independent</a>()</code>,
<code><a href="#topic+hb_sim_mixture">hb_sim_mixture</a>()</code>,
<code><a href="#topic+hb_sim_pool">hb_sim_pool</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>hb_sim_hierarchical()$data
</code></pre>

<hr>
<h2 id='hb_sim_independent'>Non-longitudinal independent simulations.</h2><span id='topic+hb_sim_independent'></span>

<h3>Description</h3>

<p>Simulate from the non-longitudinal independent model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hb_sim_independent(
  n_study = 5,
  n_group = 3,
  n_patient = 100,
  n_continuous = 0,
  n_binary = 0,
  s_alpha = 1,
  s_delta = 1,
  s_beta = 1,
  s_sigma = 1,
  alpha = stats::rnorm(n = n_study, mean = 0, sd = s_alpha),
  delta = stats::rnorm(n = n_group - 1, mean = 0, sd = s_delta),
  beta = stats::rnorm(n = n_study * (n_continuous + n_binary), mean = 0, sd = s_delta),
  sigma = stats::runif(n = n_study, min = 0, max = s_sigma)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hb_sim_independent_+3A_n_study">n_study</code></td>
<td>
<p>Number of studies to simulate.</p>
</td></tr>
<tr><td><code id="hb_sim_independent_+3A_n_group">n_group</code></td>
<td>
<p>Number of groups (e.g. study arms) to simulate per study.</p>
</td></tr>
<tr><td><code id="hb_sim_independent_+3A_n_patient">n_patient</code></td>
<td>
<p>Number of patients to simulate per study per group.</p>
</td></tr>
<tr><td><code id="hb_sim_independent_+3A_n_continuous">n_continuous</code></td>
<td>
<p>Number of continuous covariates to simulate
(all from independent standard normal distributions).</p>
</td></tr>
<tr><td><code id="hb_sim_independent_+3A_n_binary">n_binary</code></td>
<td>
<p>Number of binary covariates to simulate
(all from independent Bernoulli distributions with p = 0.5).</p>
</td></tr>
<tr><td><code id="hb_sim_independent_+3A_s_alpha">s_alpha</code></td>
<td>
<p>Numeric of length 1, prior standard deviation
of the study-specific control group mean parameters <code>alpha</code>.</p>
</td></tr>
<tr><td><code id="hb_sim_independent_+3A_s_delta">s_delta</code></td>
<td>
<p>Numeric of length 1, prior standard deviation
of the study-by-group effect parameters <code>delta</code>.</p>
</td></tr>
<tr><td><code id="hb_sim_independent_+3A_s_beta">s_beta</code></td>
<td>
<p>Numeric of length 1, prior standard deviation
of the fixed effects <code>beta</code>.</p>
</td></tr>
<tr><td><code id="hb_sim_independent_+3A_s_sigma">s_sigma</code></td>
<td>
<p>Numeric of length 1, prior upper bound
of the residual standard deviations.</p>
</td></tr>
<tr><td><code id="hb_sim_independent_+3A_alpha">alpha</code></td>
<td>
<p>Numeric vector of length 1 for the pooled
and mixture models and length <code>n_study</code> for the
independent and hierarchical models.
<code>alpha</code> is the vector of control group mean parameters.
<code>alpha</code> enters the model by multiplying with
<code style="white-space: pre;">&#8288;$matrices$x_alpha&#8288;</code> (see the return value).
The control group in the data is the one with the
<code>group</code> column equal to 1.</p>
</td></tr>
<tr><td><code id="hb_sim_independent_+3A_delta">delta</code></td>
<td>
<p>Numeric vector of length <code>n_group - 1</code>
of treatment effect parameters.
<code>delta</code> enters the model by multiplying with
<code style="white-space: pre;">&#8288;$matrices$x_delta&#8288;</code> (see the return value).
The control (non-treatment) group in the data is the one with the
<code>group</code> column equal to 1.</p>
</td></tr>
<tr><td><code id="hb_sim_independent_+3A_beta">beta</code></td>
<td>
<p>Numeric vector of <code>n_study * (n_continuous + n_binary)</code>
fixed effect parameters. Within each study,
the first <code>n_continuous</code> betas
are for the continuous covariates, and the rest are for
the binary covariates. All the <code>beta</code>s for one study
appear before all the <code>beta</code>s for the next study,
and studies are arranged in increasing order of
the sorted unique values in <code style="white-space: pre;">&#8288;$data$study&#8288;</code> in the output.
<code>betas</code> enters the model by multiplying with
<code style="white-space: pre;">&#8288;$matrices$x_alpha&#8288;</code> (see the return value).</p>
</td></tr>
<tr><td><code id="hb_sim_independent_+3A_sigma">sigma</code></td>
<td>
<p>Numeric vector of <code>n_study</code> study-specific
residual standard deviations.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following elements:
</p>

<ul>
<li> <p><code>data</code>: tidy long-form dataset with the patient-level data.
one row per patient and indicator columns for the study,
group (e.g. treatment arm), and patient ID. The <code>response</code>
columns is the patient response. The other columns are
baseline covariates. The control group is the one with
the <code>group</code> column equal to 1, and the current study (non-historical)
is the one with the maximum value of the <code>study</code> column.
Only the current study has any non-control-group patients,
the historical studies have only the control group.
</p>
</li>
<li> <p><code>parameters</code>: named list of model parameter values.
See the model specification vignette for details.
</p>
</li>
<li> <p><code>matrices</code>: A named list of model matrices.
See the model specification vignette for details.
</p>
</li></ul>



<h3>See Also</h3>

<p>Other simulate: 
<code><a href="#topic+hb_sim_hierarchical">hb_sim_hierarchical</a>()</code>,
<code><a href="#topic+hb_sim_mixture">hb_sim_mixture</a>()</code>,
<code><a href="#topic+hb_sim_pool">hb_sim_pool</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>hb_sim_independent()$data
</code></pre>

<hr>
<h2 id='hb_sim_mixture'>Non-longitudinal mixture simulations.</h2><span id='topic+hb_sim_mixture'></span>

<h3>Description</h3>

<p>Simulate from the non-longitudinal mixture model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hb_sim_mixture(
  n_study = 5,
  n_group = 3,
  n_patient = 100,
  n_continuous = 0,
  n_binary = 0,
  s_delta = 1,
  s_beta = 1,
  s_sigma = 1,
  m_omega = 0,
  s_omega = 1,
  p_omega = 1/n_study,
  alpha = omega[pi],
  delta = stats::rnorm(n = n_group - 1, mean = 0, sd = s_delta),
  beta = stats::rnorm(n = n_continuous + n_binary, mean = 0, sd = s_delta),
  sigma = stats::runif(n = 1, min = 0, max = s_sigma),
  pi = sample.int(n = n_study, size = 1, prob = p_omega),
  omega = stats::rnorm(n = n_study, mean = m_omega, sd = s_omega)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hb_sim_mixture_+3A_n_study">n_study</code></td>
<td>
<p>Number of studies to simulate.</p>
</td></tr>
<tr><td><code id="hb_sim_mixture_+3A_n_group">n_group</code></td>
<td>
<p>Number of groups (e.g. study arms) to simulate per study.</p>
</td></tr>
<tr><td><code id="hb_sim_mixture_+3A_n_patient">n_patient</code></td>
<td>
<p>Number of patients to simulate per study per group.</p>
</td></tr>
<tr><td><code id="hb_sim_mixture_+3A_n_continuous">n_continuous</code></td>
<td>
<p>Number of continuous covariates to simulate
(all from independent standard normal distributions).</p>
</td></tr>
<tr><td><code id="hb_sim_mixture_+3A_n_binary">n_binary</code></td>
<td>
<p>Number of binary covariates to simulate
(all from independent Bernoulli distributions with p = 0.5).</p>
</td></tr>
<tr><td><code id="hb_sim_mixture_+3A_s_delta">s_delta</code></td>
<td>
<p>Numeric of length 1, prior standard deviation
of the study-by-group effect parameters <code>delta</code>.</p>
</td></tr>
<tr><td><code id="hb_sim_mixture_+3A_s_beta">s_beta</code></td>
<td>
<p>Numeric of length 1, prior standard deviation
of the fixed effects <code>beta</code>.</p>
</td></tr>
<tr><td><code id="hb_sim_mixture_+3A_s_sigma">s_sigma</code></td>
<td>
<p>Numeric of length 1, prior upper bound
of the residual standard deviations.</p>
</td></tr>
<tr><td><code id="hb_sim_mixture_+3A_m_omega">m_omega</code></td>
<td>
<p>Numeric of length 1 or <code>n_study</code>,
prior control group mean of each study.
If length <code>n_study</code>,
then the last element corresponds to the current study,
and the others are for historical studies.</p>
</td></tr>
<tr><td><code id="hb_sim_mixture_+3A_s_omega">s_omega</code></td>
<td>
<p>Numeric of length 1 or <code>n_study</code>,
prior control group standard deviation of each study.
If length <code>n_study</code>,
the the last element corresponds to the current study,
and the others are for historical studies.</p>
</td></tr>
<tr><td><code id="hb_sim_mixture_+3A_p_omega">p_omega</code></td>
<td>
<p>Numeric of length <code>n_study</code>,
prior mixture proportion of each study.
If length <code>n_study</code>,
then the last element corresponds to the current study,
and the others are for historical studies.</p>
</td></tr>
<tr><td><code id="hb_sim_mixture_+3A_alpha">alpha</code></td>
<td>
<p>Numeric vector of length 1 for the pooled
and mixture models and length <code>n_study</code> for the
independent and hierarchical models.
<code>alpha</code> is the vector of control group mean parameters.
<code>alpha</code> enters the model by multiplying with
<code style="white-space: pre;">&#8288;$matrices$x_alpha&#8288;</code> (see the return value).
The control group in the data is the one with the
<code>group</code> column equal to 1.</p>
</td></tr>
<tr><td><code id="hb_sim_mixture_+3A_delta">delta</code></td>
<td>
<p>Numeric vector of length <code>n_group - 1</code>
of treatment effect parameters.
<code>delta</code> enters the model by multiplying with
<code style="white-space: pre;">&#8288;$matrices$x_delta&#8288;</code> (see the return value).
The control (non-treatment) group in the data is the one with the
<code>group</code> column equal to 1.</p>
</td></tr>
<tr><td><code id="hb_sim_mixture_+3A_beta">beta</code></td>
<td>
<p>Numeric vector of <code>n_continuous + n_binary</code>
fixed effect parameters.
The first <code>n_continuous</code> betas
are for the continuous covariates, and the rest are for
the binary covariates.
<code>betas</code> enters the model by multiplying with
<code style="white-space: pre;">&#8288;$matrices$x_alpha&#8288;</code> (see the return value).</p>
</td></tr>
<tr><td><code id="hb_sim_mixture_+3A_sigma">sigma</code></td>
<td>
<p>Numeric vector of <code>n_study</code> study-specific
residual standard deviations.</p>
</td></tr>
<tr><td><code id="hb_sim_mixture_+3A_pi">pi</code></td>
<td>
<p>Integer of length 1,
index of the mixture component randomly
chosen for <code>alpha</code>.</p>
</td></tr>
<tr><td><code id="hb_sim_mixture_+3A_omega">omega</code></td>
<td>
<p>Numeric of length <code>n_study</code>,
Candidate placebo mean parameters
drawn from each of the mixture components.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following elements:
</p>

<ul>
<li> <p><code>data</code>: tidy long-form dataset with the patient-level data.
one row per patient and indicator columns for the study,
group (e.g. treatment arm), and patient ID. The <code>response</code>
columns is the patient response. The other columns are
baseline covariates. The control group is the one with
the <code>group</code> column equal to 1, and the current study (non-historical)
is the one with the maximum value of the <code>study</code> column.
Only the current study has any non-control-group patients,
the historical studies have only the control group.
</p>
</li>
<li> <p><code>parameters</code>: named list of model parameter values.
See the model specification vignette for details.
</p>
</li>
<li> <p><code>matrices</code>: A named list of model matrices.
See the model specification vignette for details.
</p>
</li></ul>



<h3>See Also</h3>

<p>Other simulate: 
<code><a href="#topic+hb_sim_hierarchical">hb_sim_hierarchical</a>()</code>,
<code><a href="#topic+hb_sim_independent">hb_sim_independent</a>()</code>,
<code><a href="#topic+hb_sim_pool">hb_sim_pool</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>hb_sim_mixture()$data
</code></pre>

<hr>
<h2 id='hb_sim_pool'>Non-longitudinal pooled simulations.</h2><span id='topic+hb_sim_pool'></span>

<h3>Description</h3>

<p>Simulate from the non-longitudinal pooled model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hb_sim_pool(
  n_study = 5,
  n_group = 3,
  n_patient = 100,
  n_continuous = 0,
  n_binary = 0,
  s_alpha = 1,
  s_delta = 1,
  s_beta = 1,
  s_sigma = 1,
  alpha = stats::rnorm(n = 1, mean = 0, sd = s_alpha),
  delta = stats::rnorm(n = n_group - 1, mean = 0, sd = s_delta),
  beta = stats::rnorm(n = n_study * (n_continuous + n_binary), mean = 0, sd = s_delta),
  sigma = stats::runif(n = n_study, min = 0, max = s_sigma)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hb_sim_pool_+3A_n_study">n_study</code></td>
<td>
<p>Number of studies to simulate.</p>
</td></tr>
<tr><td><code id="hb_sim_pool_+3A_n_group">n_group</code></td>
<td>
<p>Number of groups (e.g. study arms) to simulate per study.</p>
</td></tr>
<tr><td><code id="hb_sim_pool_+3A_n_patient">n_patient</code></td>
<td>
<p>Number of patients to simulate per study per group.</p>
</td></tr>
<tr><td><code id="hb_sim_pool_+3A_n_continuous">n_continuous</code></td>
<td>
<p>Number of continuous covariates to simulate
(all from independent standard normal distributions).</p>
</td></tr>
<tr><td><code id="hb_sim_pool_+3A_n_binary">n_binary</code></td>
<td>
<p>Number of binary covariates to simulate
(all from independent Bernoulli distributions with p = 0.5).</p>
</td></tr>
<tr><td><code id="hb_sim_pool_+3A_s_alpha">s_alpha</code></td>
<td>
<p>Numeric of length 1, prior standard deviation
of the study-specific control group mean parameters <code>alpha</code>.</p>
</td></tr>
<tr><td><code id="hb_sim_pool_+3A_s_delta">s_delta</code></td>
<td>
<p>Numeric of length 1, prior standard deviation
of the study-by-group effect parameters <code>delta</code>.</p>
</td></tr>
<tr><td><code id="hb_sim_pool_+3A_s_beta">s_beta</code></td>
<td>
<p>Numeric of length 1, prior standard deviation
of the fixed effects <code>beta</code>.</p>
</td></tr>
<tr><td><code id="hb_sim_pool_+3A_s_sigma">s_sigma</code></td>
<td>
<p>Numeric of length 1, prior upper bound
of the residual standard deviations.</p>
</td></tr>
<tr><td><code id="hb_sim_pool_+3A_alpha">alpha</code></td>
<td>
<p>Numeric vector of length 1 for the pooled
and mixture models and length <code>n_study</code> for the
independent and hierarchical models.
<code>alpha</code> is the vector of control group mean parameters.
<code>alpha</code> enters the model by multiplying with
<code style="white-space: pre;">&#8288;$matrices$x_alpha&#8288;</code> (see the return value).
The control group in the data is the one with the
<code>group</code> column equal to 1.</p>
</td></tr>
<tr><td><code id="hb_sim_pool_+3A_delta">delta</code></td>
<td>
<p>Numeric vector of length <code>n_group - 1</code>
of treatment effect parameters.
<code>delta</code> enters the model by multiplying with
<code style="white-space: pre;">&#8288;$matrices$x_delta&#8288;</code> (see the return value).
The control (non-treatment) group in the data is the one with the
<code>group</code> column equal to 1.</p>
</td></tr>
<tr><td><code id="hb_sim_pool_+3A_beta">beta</code></td>
<td>
<p>Numeric vector of <code>n_study * (n_continuous + n_binary)</code>
fixed effect parameters. Within each study,
the first <code>n_continuous</code> betas
are for the continuous covariates, and the rest are for
the binary covariates. All the <code>beta</code>s for one study
appear before all the <code>beta</code>s for the next study,
and studies are arranged in increasing order of
the sorted unique values in <code style="white-space: pre;">&#8288;$data$study&#8288;</code> in the output.
<code>betas</code> enters the model by multiplying with
<code style="white-space: pre;">&#8288;$matrices$x_alpha&#8288;</code> (see the return value).</p>
</td></tr>
<tr><td><code id="hb_sim_pool_+3A_sigma">sigma</code></td>
<td>
<p>Numeric vector of <code>n_study</code> study-specific
residual standard deviations.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following elements:
</p>

<ul>
<li> <p><code>data</code>: tidy long-form dataset with the patient-level data.
one row per patient and indicator columns for the study,
group (e.g. treatment arm), and patient ID. The <code>response</code>
columns is the patient response. The other columns are
baseline covariates. The control group is the one with
the <code>group</code> column equal to 1, and the current study (non-historical)
is the one with the maximum value of the <code>study</code> column.
Only the current study has any non-control-group patients,
the historical studies have only the control group.
</p>
</li>
<li> <p><code>parameters</code>: named list of model parameter values.
See the model specification vignette for details.
</p>
</li>
<li> <p><code>matrices</code>: A named list of model matrices.
See the model specification vignette for details.
</p>
</li></ul>



<h3>See Also</h3>

<p>Other simulate: 
<code><a href="#topic+hb_sim_hierarchical">hb_sim_hierarchical</a>()</code>,
<code><a href="#topic+hb_sim_independent">hb_sim_independent</a>()</code>,
<code><a href="#topic+hb_sim_mixture">hb_sim_mixture</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>hb_sim_pool(n_continuous = 1)$data
</code></pre>

<hr>
<h2 id='hb_summary'>Model summary</h2><span id='topic+hb_summary'></span>

<h3>Description</h3>

<p>Summarize a fitted model in a table.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hb_summary(
  mcmc,
  data,
  response = "response",
  study = "study",
  study_reference = max(data[[study]]),
  group = "group",
  group_reference = min(data[[group]]),
  patient = "patient",
  covariates = grep("^covariate", colnames(data), value = TRUE),
  eoi = 0,
  direction = "&lt;"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hb_summary_+3A_mcmc">mcmc</code></td>
<td>
<p>A wide data frame of posterior samples returned by
<code><a href="#topic+hb_mcmc_hierarchical">hb_mcmc_hierarchical()</a></code> or similar MCMC function.</p>
</td></tr>
<tr><td><code id="hb_summary_+3A_data">data</code></td>
<td>
<p>Tidy data frame with one row per patient,
indicator columns for the response variable,
study, group, and patient,
and covariates. All columns must be atomic vectors
(e.g. not lists). The data for the mixture and simple models
should have just one study,
and the others should have
data from more than one study. The simple model can be used
to get the historical data components of <code>m_omega</code> and <code>s_omega</code>
for the mixture model.</p>
</td></tr>
<tr><td><code id="hb_summary_+3A_response">response</code></td>
<td>
<p>Character of length 1,
name of the column in <code>data</code> with the response/outcome variable.
<code>data[[response]]</code> must be a continuous variable,
and it <em>should</em> be the change from baseline of a
clinical endpoint of interest, as opposed to just
the raw response. Treatment differences
are computed directly from this scale, please supply
change from baseline unless you are absolutely certain
that treatment differences computed directly from
this quantity are clinically meaningful.</p>
</td></tr>
<tr><td><code id="hb_summary_+3A_study">study</code></td>
<td>
<p>Character of length 1,
name of the column in <code>data</code> with the study ID.</p>
</td></tr>
<tr><td><code id="hb_summary_+3A_study_reference">study_reference</code></td>
<td>
<p>Atomic of length 1,
element of the <code>study</code> column that indicates
the current study.
(The other studies are historical studies.)</p>
</td></tr>
<tr><td><code id="hb_summary_+3A_group">group</code></td>
<td>
<p>Character of length 1,
name of the column in <code>data</code> with the group ID.</p>
</td></tr>
<tr><td><code id="hb_summary_+3A_group_reference">group_reference</code></td>
<td>
<p>Atomic of length 1,
element of the <code>group</code> column that indicates
the control group.
(The other groups may be treatment groups.)</p>
</td></tr>
<tr><td><code id="hb_summary_+3A_patient">patient</code></td>
<td>
<p>Character of length 1,
name of the column in <code>data</code> with the patient ID.</p>
</td></tr>
<tr><td><code id="hb_summary_+3A_covariates">covariates</code></td>
<td>
<p>Character vector of column names
in <code>data</code> with the columns with baseline covariates.
These can be continuous, categorical, or binary.
Regardless, <code>historicalborrow</code> derives the appropriate
model matrix.</p>
</td></tr>
<tr><td><code id="hb_summary_+3A_eoi">eoi</code></td>
<td>
<p>Numeric of length at least 1,
vector of effects of interest (EOIs) for critical success factors (CSFs).</p>
</td></tr>
<tr><td><code id="hb_summary_+3A_direction">direction</code></td>
<td>
<p>Character of length <code>length(eoi)</code> indicating how
to compare the treatment effect to each EOI. <code>"&gt;"</code> means
Prob(treatment effect &gt; EOI), and <code>"&lt;"</code> means
Prob(treatment effect &lt; EOI). All elements of <code>direction</code>
must be either <code>"&gt;"</code> or <code>"&lt;"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>hb_summary()</code> function post-processes the results from
the model. It accepts MCMC samples of parameters and returns
interpretable group-level posterior summaries such as change
from baseline response and treatment effect. To arrive at these
summaries, <code>hb_summary()</code> computes marginal posteriors of
transformed parameters. The transformations derive patient-level
fitted values from model parameters, then derive group-level
responses as averages of fitted values. We refer to this style
of estimation as &quot;unconditional estimation&quot;, as opposed to
&quot;conditional estimation&quot;, which takes each group mean to be the
appropriate linear combination of the relevant <code>alpha</code> and <code>delta</code>
parameters, without using <code>beta</code> components or going through fitted
values. If the baseline covariates are balanced across studies,
unconditional and conditional estimation should produce similar
estimates of placebo and treatment effects.
</p>


<h3>Value</h3>

<p>A tidy data frame with one row per group (e.g. treatment arm)
and the columns in the following list. Unless otherwise specified,
the quantities are calculated at the group level.
Some are calculated for the current (non-historical) study only,
while others pertain to the combined dataset which includes
all historical studies.
The mixture model is an exception because the <code>data</code> argument
only includes the current study, so other quantities that include
historical information will need to borrow from an <code>hb_summary()</code>
call on one of the other models.
</p>

<ul>
<li> <p><code>group</code>: group label.
</p>
</li>
<li> <p><code>data_mean</code>: observed mean response specific to the current study.
</p>
</li>
<li> <p><code>data_sd</code>: observed standard deviation of the response
specific to the current study.
</p>
</li>
<li> <p><code>data_lower</code>: lower bound of a simple frequentist 95% confidence
interval of the observed mean specific to the current study.
</p>
</li>
<li> <p><code>data_upper</code>: upper bound of a simple frequentist 95% confidence
interval of the observed mean specific to the current study.
</p>
</li>
<li> <p><code>data_n</code>: number of non-missing observations in the combined dataset
with all studies.
</p>
</li>
<li> <p><code>data_N</code>: total number of observations (missing and non-missing)
in the combined dataset with all studies.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;data_n_study_*&#8288;</code>: number of non-missing observations separately
for each study.
The suffixes of these column names are integer study indexes.
Call <code>dplyr::distinct(hb_data(your_data), study, study_label)</code>
to see which study labels correspond to these integer indexes.
Note: the combined dataset for the mixture model
is just the current study. If all the <code style="white-space: pre;">&#8288;data_n_study_*&#8288;</code> results
across all studies
are desired, then call <code>hb_summary()</code> on a different model (e.g. pooled).
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;data_N_study_*&#8288;</code>: same as <code style="white-space: pre;">&#8288;data_n_study_*&#8288;</code> except both missing and
non-missing observations are counted (total number of observations).
</p>
</li>
<li> <p><code>response_mean</code>: Estimated posterior mean of the response
from the model specific to the current study.
Typically, the raw response is change from baseline,
in which case <code>response_mean</code> is estimating change from baseline.
</p>
</li>
<li> <p><code>response_sd</code>: Estimated posterior standard deviation of the mean
response from the model specific to the current study.
</p>
</li>
<li> <p><code>response_variance</code>: Estimated posterior variance of the mean
response from the model specific to the current study.
</p>
</li>
<li> <p><code>response_lower</code>: Lower bound of a 95% posterior interval on the mean
response from the model specific to the current study.
</p>
</li>
<li> <p><code>response_upper</code>: Upper bound of a 95% posterior interval on the mean
response from the model specific to the current study.
</p>
</li>
<li> <p><code>response_mean_mcse</code>: Monte Carlo standard error of <code>response_mean</code>.
</p>
</li>
<li> <p><code>response_sd_mcse</code>: Monte Carlo standard error of <code>response_sd</code>.
</p>
</li>
<li> <p><code>response_lower_mcse</code>: Monte Carlo standard error of <code>response_lower</code>.
</p>
</li>
<li> <p><code>response_upper_mcse</code>: Monte Carlo standard error of <code>response_upper</code>.
</p>
</li>
<li> <p><code>diff_mean</code>: Estimated treatment effect from the model
specific to the current study.
</p>
</li>
<li> <p><code>diff_lower</code>: Lower bound of a 95% posterior interval on the treatment
effect from the model specific to the current study..
</p>
</li>
<li> <p><code>diff_upper</code>: Upper bound of a 95% posterior interval on the treatment
effect from the model specific to the current study..
</p>
</li>
<li> <p><code>diff_mean_mcse</code>: Monte Carlo standard error of <code>diff_mean</code>.
</p>
</li>
<li> <p><code>diff_lower_mcse</code>: Monte Carlo standard error of <code>diff_lower</code>.
</p>
</li>
<li> <p><code>diff_upper_mcse</code>: Monte Carlo standard error of <code>diff_upper</code>.
</p>
</li>
<li> <p><code>P(diff &gt; EOI)</code>, <code>P(diff &lt; EOI)</code>: CSF probabilities on the
treatment effect specified with the <code>eoi</code> and <code>direction</code>
arguments. Specific to the current study.
</p>
</li>
<li> <p><code>effect_mean</code>: Estimated posterior mean of effect size
(treatment difference divided by residual standard deviation).
Specific to the current study.
</p>
</li>
<li> <p><code>effect_lower</code>: Lower bound of a 95% posterior interval of effect size
from the model. Specific to the current study.
</p>
</li>
<li> <p><code>effect_upper</code>: Upper bound of a 95% posterior interval of effect size
from the model. Specific to the current study.
</p>
</li>
<li> <p><code>precision_ratio</code>: For the hierarchical model only,
a model-based mean of the precision ratio. Specific to the current study.
</p>
</li>
<li> <p><code>precision_ratio_lower</code>: For the hierarchical model only, lower bound
of a model-based 95% posterior interval of the precision ratio.
Specific to the current study.
</p>
</li>
<li> <p><code>precision_ratio_upper</code>: For the hierarchical model only, upper bound
of a model-based 95% posterior interval of the precision ratio.
Specific to the current study.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;mix_prop_*&#8288;</code>: For the mixture model only, posterior mixture proportions
of each of the mixture components. The last one is for the current study
and the first ones are for the historical studies. The suffixes of these
column names are the integer study indexes.
Call <code>dplyr::distinct(hb_data(your_data), study, study_label)</code>
to see which study labels correspond to these integer indexes.
</p>
</li></ul>



<h3>See Also</h3>

<p>Other summary: 
<code><a href="#topic+hb_metrics">hb_metrics</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (!identical(Sys.getenv("HB_TEST", unset = ""), "")) {
data &lt;- hb_sim_pool(n_continuous = 2)$data
data$group &lt;- sprintf("group%s", data$group)
mcmc &lt;- hb_mcmc_pool(
  data,
  n_chains = 1,
  n_adapt = 100,
  n_warmup = 50,
  n_iterations = 50
)
hb_summary(mcmc, data)
}
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
