<!DOCTYPE html><html><head><title>Help for package refitME</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {refitME}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#anova_MCEMfit_glm'><p>An ANOVA function for fitted <code>MCEMfit_glm</code> objects</p></a></li>
<li><a href='#anova.refitME'><p>An ANOVA function for fitted <code>refitME</code> objects</p></a></li>
<li><a href='#Corymbiaeximiadata'><p>The Corymbia eximia presence-only data set</p></a></li>
<li><a href='#Framinghamdata'><p>The Framingham heart study data set</p></a></li>
<li><a href='#logLik_MCEMfit_lm'><p>Extract log-Likelihoods for <code>MCEMfit_lm</code> model objects</p></a></li>
<li><a href='#logLik.refitME'><p>Extract log-Likelihoods for <code>refitME</code> model objects</p></a></li>
<li><a href='#MCEMfit_CR'><p>Function for fitting <code>VGAM</code> capture-recapture (CR) model using the MCEM algorithm</p></a></li>
<li><a href='#MCEMfit_gam'><p>Function for wrapping the MCEM algorithm on <code>gam</code> objects</p></a></li>
<li><a href='#MCEMfit_gen'><p>Function for fitting any likelihood-based model using the MCEM algorithm</p></a></li>
<li><a href='#MCEMfit_glm'><p>Function for wrapping the MCEM algorithm on <code>lm</code> or <code>glm</code> objects</p></a></li>
<li><a href='#Priniadata'><p>The yellow-bellied Prinia <em>Prinia flaviventris</em> capture-recapture data</p></a></li>
<li><a href='#refitME'><p>A wrapper function for correcting measurement error in predictor variables via the MCEM algorithm</p></a></li>
<li><a href='#sqrt.na'><p>Function that replaces NA with zero for a matrix</p></a></li>
<li><a href='#wt.var'><p>Function that calculates a weighted variance</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Measurement Error Modelling using MCEM</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.2</td>
</tr>
<tr>
<td>Description:</td>
<td>Fits measurement error models using Monte Carlo Expectation Maximization (MCEM). For specific details on the methodology, see: Greg C. G. Wei &amp; Martin A. Tanner (1990) A Monte Carlo Implementation of the EM Algorithm and the Poor Man's Data Augmentation Algorithms, Journal of the American Statistical Association, 85:411, 699-704 &lt;<a href="https://doi.org/10.1080%2F01621459.1990.10474930">doi:10.1080/01621459.1990.10474930</a>&gt; For more examples on measurement error modelling using MCEM, see the 'RMarkdown' vignette: "'refitME' R-package tutorial".</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS, SemiPar, mgcv, VGAM, VGAMdata, caret, expm, mvtnorm,
sandwich, stats, dplyr, scales</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-08-03 06:41:42 UTC; jakubstoklosa</td>
</tr>
<tr>
<td>Author:</td>
<td>Jakub Stoklosa <a href="https://orcid.org/0000-0002-6523-4524"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Wenhan Hwang [aut, ctb],
  David Warton [aut, ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jakub Stoklosa &lt;j.stoklosa@unsw.edu.au&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-08-03 10:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='anova_MCEMfit_glm'>An ANOVA function for fitted <code>MCEMfit_glm</code> objects</h2><span id='topic+anova_MCEMfit_glm'></span>

<h3>Description</h3>

<p>An ANOVA function for fitted <code>MCEMfit_glm</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anova_MCEMfit_glm(object, ..., dispersion = NULL, test = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="anova_MCEMfit_glm_+3A_object">object</code></td>
<td>
<p>: fitted model objects of class <code>MCEMfit_glm</code>.</p>
</td></tr>
<tr><td><code id="anova_MCEMfit_glm_+3A_...">...</code></td>
<td>
<p>: further arguments passed through to <code>glm</code>.</p>
</td></tr>
<tr><td><code id="anova_MCEMfit_glm_+3A_dispersion">dispersion</code></td>
<td>
<p>: the dispersion parameter for the fitting family. By default it is obtained from the object(s).</p>
</td></tr>
<tr><td><code id="anova_MCEMfit_glm_+3A_test">test</code></td>
<td>
<p>: a character string, (partially) matching one of &quot;<code>Chisq</code>&quot;, &quot;<code>LRT</code>&quot;, &quot;<code>Rao</code>&quot;, &quot;<code>F</code>&quot; or &quot;<code>Cp</code>&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>anova_MCEMfit_glm</code> produces output identical to <code>anova.glm</code>.
</p>


<h3>Author(s)</h3>

<p>Jakub Stoklosa, Wen-Han Hwang and David I. Warton.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+anova.glm">anova.glm</a></code>
</p>

<hr>
<h2 id='anova.refitME'>An ANOVA function for fitted <code>refitME</code> objects</h2><span id='topic+anova.refitME'></span>

<h3>Description</h3>

<p>An ANOVA function for fitted <code>refitME</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'refitME'
anova(object, ..., dispersion = NULL, test = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="anova.refitME_+3A_object">object</code></td>
<td>
<p>: fitted model objects of class <code>refitME</code>.</p>
</td></tr>
<tr><td><code id="anova.refitME_+3A_...">...</code></td>
<td>
<p>: further arguments passed through to <code>lm</code> or <code>glm</code>.</p>
</td></tr>
<tr><td><code id="anova.refitME_+3A_dispersion">dispersion</code></td>
<td>
<p>: the dispersion parameter for the fitting family. By default it is obtained from the object(s).</p>
</td></tr>
<tr><td><code id="anova.refitME_+3A_test">test</code></td>
<td>
<p>: a character string, (partially) matching one of &quot;<code>Chisq</code>&quot;, &quot;<code>LRT</code>&quot;, &quot;<code>Rao</code>&quot;, &quot;<code>F</code>&quot; or &quot;<code>Cp</code>&quot;. See <code><a href="stats.html#topic+stat.anova">stat.anova</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>anova.refitME</code> produces output identical to <code>anova.lm</code>, <code>anova.glm</code> or <code>anova.gam</code>.
</p>


<h3>Author(s)</h3>

<p>Jakub Stoklosa, Wen-Han Hwang and David I. Warton.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+anova">anova</a></code>
</p>

<hr>
<h2 id='Corymbiaeximiadata'>The Corymbia eximia presence-only data set</h2><span id='topic+Corymbiaeximiadata'></span>

<h3>Description</h3>

<p>Data set consisting of presence-only records for the plant species <em>Corymbia eximia</em>, site coordinates 5 covariates for each site.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Corymbiaeximiadata
</code></pre>


<h3>Format</h3>

<p>A data set that contains: 8 columns with 86,316 observations (or sites). The columns are defined as follows:
</p>

<dl>
<dt><code>X</code></dt><dd><p>Longitude coordinate.</p>
</dd>
<dt><code>Y</code></dt><dd><p>Latitude coordinate.</p>
</dd>
<dt><code>FC</code></dt><dd><p>Recorded number of fire counts for each site.</p>
</dd>
<dt><code>MNT</code></dt><dd><p>Recorded minimum temperatures for each site.</p>
</dd>
<dt><code>MXT</code></dt><dd><p>Recorded maximum temperature for each site.</p>
</dd>
<dt><code>Rain</code></dt><dd><p>Recorded rainfall for each site.</p>
</dd>
<dt><code>D.Main</code></dt><dd><p>Recorded distance from nearest major road.</p>
</dd>
<dt><code>Y.obs</code></dt><dd><p>Presences for the plant species <em>Corymbia eximia</em> for each site.</p>
</dd>
</dl>



<h3>Source</h3>

<p>See Renner and Warton (2013) for full details on the data and study.
</p>


<h3>References</h3>

<p>Renner, I. W. and Warton, D. I. (2013). Equivalence of MAXENT and Poisson point process models for species distribution modeling in ecology. <em>Biometrics</em>, <strong>69</strong>, 274â€“281.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load the data.

data(Corymbiaeximiadata)
</code></pre>

<hr>
<h2 id='Framinghamdata'>The Framingham heart study data set</h2><span id='topic+Framinghamdata'></span>

<h3>Description</h3>

<p>Data set consisting of records of male patients with coronary heart disease collected from the Framingham heart study. The <code>Framinghamdata</code> data consists of binary responses and four predictor variables collected on 'n = 1615' patients.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Framinghamdata
</code></pre>


<h3>Format</h3>

<p>A data set that contains: 5 columns with 1,615 observations. The columns are defined as follows:
</p>

<dl>
<dt><code>Y</code></dt><dd><p>Response indicator (binary variable) of first evidence of CHD status of patient.</p>
</dd>
<dt><code>z1</code></dt><dd><p>Serum cholesterol level of patient.</p>
</dd>
<dt><code>z2</code></dt><dd><p>Age of patient.</p>
</dd>
<dt><code>z3</code></dt><dd><p>Smoking indicator - whether the patient smokes.</p>
</dd>
<dt><code>w1</code></dt><dd><p>Systolic blood pressure (SBP) of patient - this is the error contaminated variable, calculated from mean scores. The measurement error is 0.00630, see pp. 112 of Carroll <em>et al.</em> (2006).</p>
</dd>
</dl>



<h3>Source</h3>

<p>See Carroll <em>et al.</em> (2006) for full details on the data and study. Also, see <a href="https://github.com/JakubStats/refitME">https://github.com/JakubStats/refitME</a> for an RMarkdown vignette of an example that uses the data.
</p>


<h3>References</h3>

<p>Carroll, R. J., Ruppert, D., Stefanski, L. A., and Crainiceanu, C. M. (2006). <em>Measurement Error in Nonlinear Models: A Modern Perspective.</em> 2nd Ed. London: Chapman &amp; Hall/CRC.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load the data.

data(Framinghamdata)
</code></pre>

<hr>
<h2 id='logLik_MCEMfit_lm'>Extract log-Likelihoods for <code>MCEMfit_lm</code> model objects</h2><span id='topic+logLik_MCEMfit_lm'></span>

<h3>Description</h3>

<p>Extract log-Likelihoods for <code>MCEMfit_lm</code> model objects. This function subtracts the entropy term from the observed likelihood.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logLik_MCEMfit_lm(object, REML = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logLik_MCEMfit_lm_+3A_object">object</code></td>
<td>
<p>: fitted model objects of class <code>MCEMfit_lm</code>.</p>
</td></tr>
<tr><td><code id="logLik_MCEMfit_lm_+3A_reml">REML</code></td>
<td>
<p>: an optional logical value. If <code>TRUE</code> the restricted log-likelihood is returned, else, if <code>FALSE</code>, the log-likelihood is returned. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="logLik_MCEMfit_lm_+3A_...">...</code></td>
<td>
<p>: further arguments passed through to <code>lm</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>logLik_MCEMfit_lm</code> produces output identical to <code>logLik</code>.
</p>


<h3>Author(s)</h3>

<p>Jakub Stoklosa, Wen-Han Hwang and David I. Warton.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+logLik">logLik</a></code>
</p>

<hr>
<h2 id='logLik.refitME'>Extract log-Likelihoods for <code>refitME</code> model objects</h2><span id='topic+logLik.refitME'></span>

<h3>Description</h3>

<p>Extract log-Likelihoods for <code>refitME</code> model objects. This function subtracts the entropy term from the observed likelihood.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'refitME'
logLik(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logLik.refitME_+3A_object">object</code></td>
<td>
<p>: fitted model objects of class <code>refitME</code>.</p>
</td></tr>
<tr><td><code id="logLik.refitME_+3A_...">...</code></td>
<td>
<p>: further arguments passed through to <code>lm</code> or <code>glm</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>logLik.refitME</code> produces identical output to <code>logLik</code> but for <code>refitME</code> model objects.
</p>


<h3>Author(s)</h3>

<p>Jakub Stoklosa, Wen-Han Hwang and David I. Warton.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+logLik">logLik</a></code>
</p>

<hr>
<h2 id='MCEMfit_CR'>Function for fitting <code>VGAM</code> capture-recapture (CR) model using the MCEM algorithm</h2><span id='topic+MCEMfit_CR'></span>

<h3>Description</h3>

<p>Function for fitting <code>VGAM</code> capture-recapture (CR) model using the MCEM algorithm where covariates have measurement error.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MCEMfit_CR(mod, sigma.sq.u, B = 50, epsilon = 1e-05, silent = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MCEMfit_CR_+3A_mod">mod</code></td>
<td>
<p>: a <code>vglm/vgam</code> object (this is the naive CR model). Make sure the first <code class="reqn">p</code> input predictor variables in the naive model are the selected error-contaminated variables.</p>
</td></tr>
<tr><td><code id="MCEMfit_CR_+3A_sigma.sq.u">sigma.sq.u</code></td>
<td>
<p>: measurement error (ME) variance. A scalar if there is only one error-contaminated predictor variable, otherwise this must be stored as a vector (of ME variances) or a matrix if the ME covariance matrix is known.</p>
</td></tr>
<tr><td><code id="MCEMfit_CR_+3A_b">B</code></td>
<td>
<p>: the number of Monte Carlo replication values (default is set to 50).</p>
</td></tr>
<tr><td><code id="MCEMfit_CR_+3A_epsilon">epsilon</code></td>
<td>
<p>: a set convergence threshold (default is set to 0.00001).</p>
</td></tr>
<tr><td><code id="MCEMfit_CR_+3A_silent">silent</code></td>
<td>
<p>: if <code>TRUE</code>, the convergence message (which tells the user if the model has converged and reports the number of iterations required) is suppressed (default is set to <code>FALSE</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>MCEMfit_CR</code> returns model coefficient and population size estimates with standard errors and the effective sample size.
</p>


<h3>Warning</h3>

<p>This function is still under development. Currently the function can only fit the CR model used in the manuscript. IT DOES NOT SUPPORT ALL <code>VGAM</code> families.
</p>


<h3>Author(s)</h3>

<p>Jakub Stoklosa, Wen-Han Hwang and David I. Warton.
</p>


<h3>Source</h3>

<p>See <a href="https://github.com/JakubStats/refitME">https://github.com/JakubStats/refitME</a> for an RMarkdown vignette with examples.
</p>


<h3>References</h3>

<p>Stoklosa, J., Hwang, W-H., and Warton, D.I. <span class="pkg">refitME</span>: Measurement Error Modelling using Monte Carlo Expectation Maximization in R.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MCEMfit_glm">MCEMfit_glm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># A VGAM example using the Prinia flaviventris capture-recapture data.

library(refitME)
library(VGAM)

data(Priniadata)

tau &lt;- 17   # No. of capture occasions.
w1 &lt;- Priniadata$w1 # Bird wing length predictor.

CR_naiv &lt;- vglm(cbind(cap, noncap) ~ w1,
   VGAM::posbinomial(omit.constant = TRUE, parallel = TRUE ~ w1),
   data = Priniadata, trace = FALSE)

sigma.sq.u &lt;- 0.37 # ME variance.

CR_MCEM &lt;- refitME(CR_naiv, sigma.sq.u)

detach(package:VGAM)

</code></pre>

<hr>
<h2 id='MCEMfit_gam'>Function for wrapping the MCEM algorithm on <code>gam</code> objects</h2><span id='topic+MCEMfit_gam'></span>

<h3>Description</h3>

<p>Function for wrapping the MCEM algorithm on GAMs where predictors are subject to measurement error/error-in-variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MCEMfit_gam(
  mod,
  family,
  sigma.sq.u,
  B = 50,
  epsilon = 1e-05,
  silent = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MCEMfit_gam_+3A_mod">mod</code></td>
<td>
<p>: a <code>gam</code> object (this is the naive fitted model). Make sure the first <code class="reqn">p</code> input predictor variables entered in the naive model are the specified error-contaminated variables. These <code class="reqn">p</code> predictors also need the measurement error variance to be specified in <code>sigma.sq.u</code>, see below.</p>
</td></tr>
<tr><td><code id="MCEMfit_gam_+3A_family">family</code></td>
<td>
<p>: a specified family/distribution.</p>
</td></tr>
<tr><td><code id="MCEMfit_gam_+3A_sigma.sq.u">sigma.sq.u</code></td>
<td>
<p>: measurement error (ME) variance. A scalar if there is only one error-contaminated predictor variable, otherwise this must be stored as a vector (of ME variances) or a matrix if the ME covariance matrix is known.</p>
</td></tr>
<tr><td><code id="MCEMfit_gam_+3A_b">B</code></td>
<td>
<p>: the number of Monte Carlo replication values (default is set to 50).</p>
</td></tr>
<tr><td><code id="MCEMfit_gam_+3A_epsilon">epsilon</code></td>
<td>
<p>: convergence threshold (default is set to 0.00001).</p>
</td></tr>
<tr><td><code id="MCEMfit_gam_+3A_silent">silent</code></td>
<td>
<p>: if <code>TRUE</code>, the convergence message (which tells the user if the model has converged and reports the number of iterations required) is suppressed (default is set to <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="MCEMfit_gam_+3A_...">...</code></td>
<td>
<p>: further arguments passed to <code>gam</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>MCEMfit_gam</code> returns the original naive fitted model object but coefficient estimates and the covariance matrix have been replaced with the final MCEM model fit. Standard errors and the effective sample size (which diagnose how closely the proposal distribution matches the posterior, see equation (2) of Stoklosa, Hwang and Warton) have also been included as outputs.
</p>


<h3>Author(s)</h3>

<p>Jakub Stoklosa, Wen-Han Hwang and David I. Warton.
</p>


<h3>Source</h3>

<p>See <a href="https://github.com/JakubStats/refitME">https://github.com/JakubStats/refitME</a> for an RMarkdown vignette with examples.
</p>


<h3>References</h3>

<p>Ganguli, B, Staudenmayer, J., and Wand, M. P. (2005). Additive models with predictors subject to measurement error. <em>Australian &amp; New Zealand Journal of Statistics</em>, <strong>47</strong>, 193â€“202.
</p>
<p>Wand, M. P. (2018). <span class="pkg">SemiPar</span>: Semiparametic Regression. R package version 1.0-4.2., URL <a href="https://CRAN.R-project.org/package=SemiPar">https://CRAN.R-project.org/package=SemiPar</a>.
</p>
<p>Stoklosa, J., Hwang, W-H., and Warton, D.I. <span class="pkg">refitME</span>: Measurement Error Modelling using Monte Carlo Expectation Maximization in R.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MCEMfit_glm">MCEMfit_glm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># A GAM example using the air pollution data set from the SemiPar package.

library(refitME)
library(SemiPar)
library(mgcv)
library(dplyr)

data(milan.mort)

dat.air &lt;- sample_n(milan.mort, 100) # Takes a random sample of size 100.

Y &lt;- dat.air[, 6]  # Mortality counts.

n &lt;- length(Y)

z1 &lt;- (dat.air[, 1])
z2 &lt;- (dat.air[, 4])
z3 &lt;- (dat.air[, 5])
w1 &lt;- log(dat.air[, 9])  # The error-contaminated predictor (total suspended particles).

dat &lt;- data.frame(cbind(Y, w1, z1, z2, z3))

gam_naiv &lt;- gam(Y ~ s(w1), family = "poisson", data = dat)

sigma.sq.u &lt;- 0.0915 # Measurement error variance.

B &lt;- 10  # Consider increasing this if you want a more accurate answer.

gam_MCEM &lt;- refitME(gam_naiv, sigma.sq.u, B)

plot(gam_MCEM, select = 1)

detach(package:mgcv)

</code></pre>

<hr>
<h2 id='MCEMfit_gen'>Function for fitting any likelihood-based model using the MCEM algorithm</h2><span id='topic+MCEMfit_gen'></span>

<h3>Description</h3>

<p>Function for wrapping the MCEM algorithm on any likelihood-based model where predictors are subject to measurement error/error-in-variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MCEMfit_gen(
  mod,
  family,
  sigma.sq.u,
  B = 50,
  epsilon = 1e-05,
  silent = FALSE,
  theta.est = 1,
  shape.est = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MCEMfit_gen_+3A_mod">mod</code></td>
<td>
<p>: a model object (this is the naive fitted model). Make sure the first <code class="reqn">p</code> input predictor variables entered in the naive model are the specified error-contaminated variables. These <code class="reqn">p</code> predictors also need the measurement error variance to be specified in <code>sigma.sq.u</code>, see below.</p>
</td></tr>
<tr><td><code id="MCEMfit_gen_+3A_family">family</code></td>
<td>
<p>: a specified family/distribution.</p>
</td></tr>
<tr><td><code id="MCEMfit_gen_+3A_sigma.sq.u">sigma.sq.u</code></td>
<td>
<p>: measurement error (ME) variance. A scalar if there is only one error-contaminated predictor variable, otherwise this must be stored as a vector (of ME variances) or a matrix if the ME covariance matrix is known.</p>
</td></tr>
<tr><td><code id="MCEMfit_gen_+3A_b">B</code></td>
<td>
<p>: the number of Monte Carlo replication values (default is set to 50).</p>
</td></tr>
<tr><td><code id="MCEMfit_gen_+3A_epsilon">epsilon</code></td>
<td>
<p>: a set convergence threshold (default is set to 0.00001).</p>
</td></tr>
<tr><td><code id="MCEMfit_gen_+3A_silent">silent</code></td>
<td>
<p>: if <code>TRUE</code>, the convergence message (which tells the user if the model has converged and reports the number of iterations required) is suppressed (default is set to <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="MCEMfit_gen_+3A_theta.est">theta.est</code></td>
<td>
<p>: an initial value for the dispersion parameter (this is required for fitting negative binomial models).</p>
</td></tr>
<tr><td><code id="MCEMfit_gen_+3A_shape.est">shape.est</code></td>
<td>
<p>: an initial value for the shape parameter (this is required for fitting gamma models).</p>
</td></tr>
<tr><td><code id="MCEMfit_gen_+3A_...">...</code></td>
<td>
<p>: further arguments passed through to the function that was used to fit <code>mod</code>, that will be used in refitting. These need only be specified if making changes to the arguments as compared to the original call that produced <code>mod</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>MCEMfit_gen</code> returns the original naive fitted model object but coefficient estimates and residuals have been replaced with the final MCEM model fit. Standard errors are included and returned, if <code>mod</code> is a class of object accepted by the <span class="pkg">sandwich</span> package (such as <code>glm</code>, <code>gam</code>, <code>survreg</code> and many more).
</p>


<h3>Author(s)</h3>

<p>Jakub Stoklosa, Wen-Han Hwang and David I. Warton.
</p>


<h3>References</h3>

<p>Carroll, R. J., Ruppert, D., Stefanski, L. A., and Crainiceanu, C. M. (2006). <em>Measurement Error in Nonlinear Models: A Modern Perspective.</em> 2nd Ed. London: Chapman &amp; Hall/CRC.
</p>
<p>Stoklosa, J., Hwang, W-H., and Warton, D.I. <span class="pkg">refitME</span>: Measurement Error Modelling using Monte Carlo Expectation Maximization in R.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MCEMfit_glm">MCEMfit_glm</a></code> and <code><a href="#topic+MCEMfit_gam">MCEMfit_gam</a></code>
</p>

<hr>
<h2 id='MCEMfit_glm'>Function for wrapping the MCEM algorithm on <code>lm</code> or <code>glm</code> objects</h2><span id='topic+MCEMfit_glm'></span>

<h3>Description</h3>

<p>Function for wrapping the MCEM algorithm on GLMs where predictors are subject to measurement error/error-in-variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MCEMfit_glm(
  mod,
  family,
  sigma.sq.u,
  B = 50,
  epsilon = 1e-05,
  silent = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MCEMfit_glm_+3A_mod">mod</code></td>
<td>
<p>: a <code>lm/glm</code> object (this is the naive fitted model). Make sure the first <code class="reqn">p</code> input predictor variables entered in the naive model are the specified error-contaminated variables. These <code class="reqn">p</code> predictors also need the measurement error variance to be specified in <code>sigma.sq.u</code>, see below.</p>
</td></tr>
<tr><td><code id="MCEMfit_glm_+3A_family">family</code></td>
<td>
<p>: a specified family/distribution.</p>
</td></tr>
<tr><td><code id="MCEMfit_glm_+3A_sigma.sq.u">sigma.sq.u</code></td>
<td>
<p>: measurement error (ME) variance. A scalar if there is only one error-contaminated predictor variable, otherwise this must be stored as a vector (of ME variances) or a matrix if the ME covariance matrix is known.</p>
</td></tr>
<tr><td><code id="MCEMfit_glm_+3A_b">B</code></td>
<td>
<p>: the number of Monte Carlo replication values (default is set to 50).</p>
</td></tr>
<tr><td><code id="MCEMfit_glm_+3A_epsilon">epsilon</code></td>
<td>
<p>: a set convergence threshold (default is set to 0.00001).</p>
</td></tr>
<tr><td><code id="MCEMfit_glm_+3A_silent">silent</code></td>
<td>
<p>: if <code>TRUE</code>, the convergence message (which tells the user if the model has converged and reports the number of iterations required) is suppressed (default is set to <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="MCEMfit_glm_+3A_...">...</code></td>
<td>
<p>: further arguments passed to <code>lm</code> or <code>glm</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>MCEMfit_glm</code> returns the naive fitted model object where coefficient estimates, the covariance matrix, fitted values, the log-likelihood, and residuals have been replaced with the final MCEM model fit. Standard errors and the effective sample size (which diagnose how closely the proposal distribution matches the posterior, see equation (2) of Stoklosa, Hwang and Warton) have also been included as outputs.
</p>


<h3>Author(s)</h3>

<p>Jakub Stoklosa, Wen-Han Hwang and David I. Warton.
</p>


<h3>Source</h3>

<p>See <a href="https://github.com/JakubStats/refitME">https://github.com/JakubStats/refitME</a> for an RMarkdown vignette with examples.
</p>


<h3>References</h3>

<p>Carroll, R. J., Ruppert, D., Stefanski, L. A., and Crainiceanu, C. M. (2006). <em>Measurement Error in Nonlinear Models: A Modern Perspective.</em> 2nd Ed. London: Chapman &amp; Hall/CRC.
</p>
<p>Stoklosa, J., Hwang, W-H., and Warton, D.I. <span class="pkg">refitME</span>: Measurement Error Modelling using Monte Carlo Expectation Maximization in R.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MCEMfit_gam">MCEMfit_gam</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># A GLM example I - binary response data.

library(refitME)

data(Framinghamdata)

glm_naiv &lt;- glm(Y ~ w1 + z1 + z2 + z3, x = TRUE, family = binomial, data = Framinghamdata)

# The error-contaminated predictor in this example is systolic blood pressure (w1).

sigma.sq.u &lt;- 0.006295  # ME variance, as obtained from Carroll et al. (2006) monograph.

B &lt;- 50 # The number of Monte Carlo replication values.

glm_MCEM &lt;- refitME(glm_naiv, sigma.sq.u, B)

</code></pre>

<hr>
<h2 id='Priniadata'>The yellow-bellied Prinia <em>Prinia flaviventris</em> capture-recapture data</h2><span id='topic+Priniadata'></span>

<h3>Description</h3>

<p>Data set consisting of capture-recapture histories 164 uniquely captured birds across 17 weekly capture occasions. Bird wing lengths were also measured in the study.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Priniadata
</code></pre>


<h3>Format</h3>

<p>A data set that contains: 3 columns with 164 observations. The columns are defined as follows:
</p>

<dl>
<dt><code>w1</code></dt><dd><p>Bird wing lengths.</p>
</dd>
<dt><code>cap</code></dt><dd><p>Number of times the individual was captured.</p>
</dd>
<dt><code>noncap</code></dt><dd><p>Number of times the individual was not captured.</p>
</dd>
</dl>



<h3>Source</h3>

<p>See Hwang, Huang and Wang (2007) for full details on the data and study.
</p>


<h3>References</h3>

<p>Hwang, W. H., Huang, S. Y. H., and Wang, C. (2007). Effects of measurement error and conditional score estimation in capture&ndash;recapture models. <em>Statistica Sinica</em>, <strong>17</strong>, 301-316.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load the data.

data(Priniadata)
</code></pre>

<hr>
<h2 id='refitME'>A wrapper function for correcting measurement error in predictor variables via the MCEM algorithm</h2><span id='topic+refitME'></span>

<h3>Description</h3>

<p>Function that extracts the fitted (naive) model object and wraps the MCEM algorithm to correct for measurement error/error-in-variables in predictors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>refitME(mod, sigma.sq.u, B = 50, epsilon = 1e-05, silent = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="refitME_+3A_mod">mod</code></td>
<td>
<p>: any (S3 class) fitted object that responds to the generic functions <code>family</code>, <code>model.frame</code>, <code>update</code> and <code>predict</code>, and accepts weighted observations via <code>weights</code>. The <code>mod</code> argument specifies the naive fitted model. Make sure the first <code class="reqn">p</code> input predictor variables in the naive model are the selected error-contaminated predictors variables. Also, the <code>mod</code> argument allows <code>vlgm/vgam</code> (S4 class) model objects when using the <code>posbinomial</code> family &ndash; this is a specific function developed for fitting closed population capture&ndash;recapture models, see <code><a href="#topic+MCEMfit_CR">MCEMfit_CR</a></code>.</p>
</td></tr>
<tr><td><code id="refitME_+3A_sigma.sq.u">sigma.sq.u</code></td>
<td>
<p>: measurement error (ME) variance. A scalar if there is only one error-contaminated predictor variable, otherwise this must be stored as a vector (of known ME variances) or a matrix if the ME covariance matrix is known.</p>
</td></tr>
<tr><td><code id="refitME_+3A_b">B</code></td>
<td>
<p>: the number of Monte Carlo replication values (default is set 50).</p>
</td></tr>
<tr><td><code id="refitME_+3A_epsilon">epsilon</code></td>
<td>
<p>: convergence threshold (default is set to 0.00001).</p>
</td></tr>
<tr><td><code id="refitME_+3A_silent">silent</code></td>
<td>
<p>: if <code>TRUE</code>, the convergence message (which tells the user if the model has converged and reports the number of iterations required) is suppressed (default is set to <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="refitME_+3A_...">...</code></td>
<td>
<p>: further arguments passed through to the function that was used to fit <code>mod</code>, that will be used in refitting. These need only be specified if making changes to the arguments as compared to the original call that produced <code>mod</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>refitME</code> returns the naive fitted model object where coefficient estimates, the covariance matrix, fitted values, the log-likelihood, and residuals have been replaced with the final MCEM model fit. Standard errors are included and returned, if <code>mod</code> is a class of object accepted by the <span class="pkg">sandwich</span> package (such as <code>glm</code>, <code>gam</code>, <code>survreg</code> and many more). The effective sample size (which diagnose how closely the proposal distribution matches the posterior, see equation (2) of Stoklosa, Hwang and Warton) have also been included as outputs.
</p>


<h3>Author(s)</h3>

<p>Jakub Stoklosa, Wen-Han Hwang and David I. Warton.
</p>


<h3>Source</h3>

<p>See <a href="https://github.com/JakubStats/refitME">https://github.com/JakubStats/refitME</a> for an RMarkdown vignette with examples.
</p>


<h3>References</h3>

<p>Carroll, R. J., Ruppert, D., Stefanski, L. A., and Crainiceanu, C. M. (2006). <em>Measurement Error in Nonlinear Models: A Modern Perspective.</em> 2nd Ed. London: Chapman &amp; Hall/CRC.
</p>
<p>Stoklosa, J., Hwang, W-H., and Warton, D.I. <span class="pkg">refitME</span>: Measurement Error Modelling using Monte Carlo Expectation Maximization in R.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MCEMfit_glm">MCEMfit_glm</a></code>, <code><a href="#topic+MCEMfit_gam">MCEMfit_gam</a></code> and <code><a href="#topic+MCEMfit_gen">MCEMfit_gen</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># A GLM example I - binary response data.

library(refitME)

data(Framinghamdata)

glm_naiv &lt;- glm(Y ~ w1 + z1 + z2 + z3, x = TRUE, family = binomial, data = Framinghamdata)

# The error-contaminated predictor variable in this example is systolic blood pressure (w1).

sigma.sq.u &lt;- 0.01259/2 # ME variance, as obtained from Carroll et al. (2006) monograph.

B &lt;- 50  # The number of Monte Carlo replication values.

glm_MCEM &lt;- refitME(glm_naiv, sigma.sq.u, B)

</code></pre>

<hr>
<h2 id='sqrt.na'>Function that replaces NA with zero for a matrix</h2><span id='topic+sqrt.na'></span>

<h3>Description</h3>

<p>This function replaces NA with zero for a matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'na'
sqrt(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sqrt.na_+3A_x">x</code></td>
<td>
<p>: a matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>sqrt.na</code> returns a matrix.
</p>


<h3>Author(s)</h3>

<p>Jakub Stoklosa
</p>

<hr>
<h2 id='wt.var'>Function that calculates a weighted variance</h2><span id='topic+wt.var'></span>

<h3>Description</h3>

<p>This function that calculates a weighted variance for a given vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wt.var(x, w)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wt.var_+3A_x">x</code></td>
<td>
<p>: a vector of numerical data.</p>
</td></tr>
<tr><td><code id="wt.var_+3A_w">w</code></td>
<td>
<p>: a vector of equal length to <code>x</code> representing the weights.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>wt.var</code> returns a single value from analysis requested.
</p>


<h3>Source</h3>

<p>The developer of this function is Jeremy VanDerWal. See <a href="https://rdrr.io/cran/SDMTools/src/R/wt.mean.R">https://rdrr.io/cran/SDMTools/src/R/wt.mean.R</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Define simple data
x = 1:25 # Set of numbers.
wt = runif(25) # Some arbitrary weights.

# Display variances (unweighted and then weighted).
var(x)
wt.var(x, wt)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
