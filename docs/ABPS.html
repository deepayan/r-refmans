<!DOCTYPE html><html><head><title>Help for package ABPS</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ABPS}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ABPS'><p>A function for calculating the Abnormal Blood Profile Score</p></a></li>
<li><a href='#bloodcontrol'><p>Blood samples from different individuals.</p></a></li>
<li><a href='#blooddoping'><p>Blood samples from an athlete convicted of doping.</p></a></li>
<li><a href='#OFFscore'><p>function OFFscore</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>The Abnormal Blood Profile Score to Detect Blood Doping</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2018-10-18</td>
</tr>
<tr>
<td>Description:</td>
<td>An implementation of the Abnormal Blood Profile Score (ABPS,
    part of the Athlete Biological Passport program of the World Anti-Doping
    Agency), which combines several blood parameters into a single score in
    order to detect blood doping (Sottas et al. (2006)
    &lt;<a href="https://doi.org/10.2202%2F1557-4679.1011">doi:10.2202/1557-4679.1011</a>&gt;). The package also contains functions to
    calculate other scores used in anti-doping programs, such as the
    OFF-score (Gore et al. (2003) <a href="http://www.haematologica.org/content/88/3/333">http://www.haematologica.org/content/88/3/333</a>),
    as well as example data.</td>
</tr>
<tr>
<td>Imports:</td>
<td>kernlab</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.0.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-10-18 09:03:07 UTC; schutz</td>
</tr>
<tr>
<td>Author:</td>
<td>Frédéric Schütz [aut, cre],
  Alix Zollinger [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Frédéric Schütz &lt;schutz@mathgen.ch&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-10-18 12:30:10 UTC</td>
</tr>
</table>
<hr>
<h2 id='ABPS'>A function for calculating the Abnormal Blood Profile Score</h2><span id='topic+ABPS'></span>

<h3>Description</h3>

<p>The <code>ABPS</code> function computes the Abnormal Blood Profile Score
from seven haematological markers. Higher values of this composite
score are associated with a higher likelihood of blood doping.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ABPS(haemdata = NULL, HCT = NULL, HGB = NULL, MCH = NULL, MCHC = NULL,
  MCV = NULL, RBC = NULL, RETP = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ABPS_+3A_haemdata">haemdata</code></td>
<td>
<p>a vector or data frame containing (at least) the 7
haematological variables, either with the same names as the
parameters below, or (not recommended) without names but in the
same order as the parameters.</p>
</td></tr>
<tr><td><code id="ABPS_+3A_hct">HCT</code></td>
<td>
<p>haematocrit level [%]</p>
</td></tr>
<tr><td><code id="ABPS_+3A_hgb">HGB</code></td>
<td>
<p>haemoglobin level [g/dL]</p>
</td></tr>
<tr><td><code id="ABPS_+3A_mch">MCH</code></td>
<td>
<p>mean corpuscular haemoglobin [pg]</p>
</td></tr>
<tr><td><code id="ABPS_+3A_mchc">MCHC</code></td>
<td>
<p>mean corpuscular haemoglobin concentration [g/dL]</p>
</td></tr>
<tr><td><code id="ABPS_+3A_mcv">MCV</code></td>
<td>
<p>mean corpuscular volume [fL]</p>
</td></tr>
<tr><td><code id="ABPS_+3A_rbc">RBC</code></td>
<td>
<p>red blood cell count [10^6/uL]</p>
</td></tr>
<tr><td><code id="ABPS_+3A_retp">RETP</code></td>
<td>
<p>reticulocytes percent [%]</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The ABPS uses the seven haematological variables (HCT, HGB, MCH,
MCHC, MCV, RBC, RETP) in order to obtain a combined score. This
score is more sensitive to doping than the individual markers, and
allows the detection of several types of blood doping using a
single score.
</p>
<p>The combined score is based on two classification techniques, a
naive Bayesian classifier and an SVM (Support Vector Machine). The
two models were trained using a database of 591 blood profiles
(including 402 control samples from clean athletes and 189 samples
of athletes who abused of an illegal substance); the two scores
were then combined using ensemble averaging to obtain the final
ABPS score.
</p>
<p>The ABPS is part of the Athlete Biological Passport program managed
by the World Anti-Doping Agency. While it is not a primary marker
of doping, it has been used as corroborative evidence (see e.g.
<a href="https://jurisprudence.tas-cas.org/Shared%20Documents/2773.pdf">https://jurisprudence.tas-cas.org/Shared%20Documents/2773.pdf</a>)
</p>


<h3>Value</h3>

<p>a vector containing the ABPS score(s). Scores between 0 and
1 indicate a possible suspicion of doping; a score above 1 should
only be found in 1 in 1000 male athletes.
</p>


<h3>Note</h3>

<p>The values for the markers can be specified using either a data
frame containing (at least) the 7 haematological variables, or
using seven named parameters, but not both at the same time.
</p>
<p>The calculation of the ABPS depends on two sets of parameters, for
the two machine learning techniques (naive Bayesian classifier and
Support Vector Machine), which are provided in the package.
</p>
<p>Each parameter must be in a prespecified range; parameters outside
this range are constrained to the min (respectively max) values.
</p>
<p>Note that several versions of the ABPS were developed (including
several different combinations of parameters). The version provided
in this package provides the same results as the WADA version
included in their ADAMS database. However, some values calculated
with other versions of the software have also been distributed (see
the help page for the <code>blooddoping</code> dataset for an example).
</p>


<h3>References</h3>

<p>Sottas, P.E., N. Robinson, S. Giraud, et al., Statistical classification of abnormal blood profiles in athletes. Int J Biostat, 2006. 2(1): p. 1557-4679.
</p>
<p><a href="https://jurisprudence.tas-cas.org/Shared%20Documents/2773.pdf">https://jurisprudence.tas-cas.org/Shared%20Documents/2773.pdf</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ABPS(HCT=43.2, HGB=14.6, MCH=31.1, MCHC=33.8, MCV=92.1, RBC=4.69, RETP=0.48)
ABPS(data.frame(HCT=43.2, HGB=14.6, MCH=31.1, MCHC=33.8, MCV=92.1, RBC=4.69, RETP=0.48))
ABPS(c(43.2, 14.6, 31.1, 33.8, 92.1, 4.69, 0.48))
data(blooddoping); ABPS(blooddoping)
data(bloodcontrol); ABPS(bloodcontrol)

</code></pre>

<hr>
<h2 id='bloodcontrol'>Blood samples from different individuals.</h2><span id='topic+bloodcontrol'></span>

<h3>Description</h3>

<p>A dataset containing the result of the analysis of 13 blood samples
from different individuals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bloodcontrol
</code></pre>


<h3>Format</h3>

<p>A data frame with 13 rows and 12 haematological variables:
</p>

<dl>
<dt>HCT</dt><dd><p>haematocrit [%]</p>
</dd>
<dt>HGB</dt><dd><p>haemoglobin [g/dL]</p>
</dd>
<dt>IRF</dt><dd><p>immature reticulocyte fraction [%]</p>
</dd>
<dt>MCH</dt><dd><p>mean corpuscular haemoglobin [pg]</p>
</dd>
<dt>MCHC</dt><dd><p>mean corpuscular haemoglobin concentration [g/dL]</p>
</dd>
<dt>MCV</dt><dd><p>mean corpuscular volume [fL]</p>
</dd>
<dt>RBC</dt><dd><p>red blood cell count [10^6/uL]</p>
</dd>
<dt>RDW.SD</dt><dd><p>red blood cell distribution width [fL]</p>
</dd>
<dt>RETC</dt><dd><p>reticulocyte count [10^6/uL]</p>
</dd>
<dt>RETP</dt><dd><p>reticulocyte percentage [%]</p>
</dd>
<dt>OFFscore</dt><dd><p>OFF-score</p>
</dd>
<dt>ABPS</dt><dd><p>Abnormal Blood Profile Score</p>
</dd>
</dl>

<p>These samples are assumed to represent normal population.</p>


<h3>Note</h3>

<p>One of the rows actually belongs to one of the
authors of this package, who promises that he was not doped.
</p>


<h3>Source</h3>

<p>Swiss Laboratory for Doping Analyses (LAD), with some calculations
performed by the World Anti-Doping Agency (WADA).
</p>

<hr>
<h2 id='blooddoping'>Blood samples from an athlete convicted of doping.</h2><span id='topic+blooddoping'></span>

<h3>Description</h3>

<p>A dataset containing the result of the analysis of 13 blood samples,
taken over a period of 5 years, of a female athlete who was convicted
of doping on the basis of the Athlete Biological Passport.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>blooddoping
</code></pre>


<h3>Format</h3>

<p>A data frame with 13 rows and 11 variables (including 10
haematological variables):
</p>

<dl>
<dt>date</dt><dd><p>the date of test</p>
</dd>
<dt>HCT</dt><dd><p>haematocrit [%]</p>
</dd>
<dt>HGB</dt><dd><p>haemoglobin [g/dL]</p>
</dd>
<dt>MCH</dt><dd><p>mean corpuscular haemoglobin [pg]</p>
</dd>
<dt>MCHC</dt><dd><p>mean corpuscular haemoglobin concentration [g/dL]</p>
</dd>
<dt>MCV</dt><dd><p>mean corpuscular volume [fL]</p>
</dd>
<dt>RBC</dt><dd><p>red blood cell count [10^6/uL]</p>
</dd>
<dt>RETC</dt><dd><p>reticulocyte count [10^6/uL]</p>
</dd>
<dt>RETP</dt><dd><p>reticulocyte percentage [%]</p>
</dd>
<dt>OFFscore</dt><dd><p>OFF-score</p>
</dd>
<dt>ABPS</dt><dd><p>Abnormal Blood Profile Score</p>
</dd>
</dl>

<p>In November 2012, the athlete was convicted of doping by the Court
of arbitration for Sport, the evidence showing at least two occurences
of doping, in summer 2009 (shortly before the test of 2 July 2009) and
in June 2011, likely using an agent such as recombinant erythropoietin
(rhEPO).
</p>
<p>Doping is indicated in particular by high haemoglobin values associated
with very low reticulocyte % and high OFF scores (a combination of these
two variables).</p>


<h3>Note</h3>

<p>The data tables published in the original source
contain several typos, as confirmed by the World Anti-Doping
Agency (WADA). In particular, values for RETP in rows 8 and 10
were swapped and the MCHC value for row 7 was incorrect. This
package's source code contains both the original data and the
details of the corrections that were applied.
</p>
<p>The ABPS values provided are very close (within &lt;2%) to those
obtained using the <code>ABPS</code> function, but some of them were likely
calculated using different (older) versions of the ABPS code, which
may explain some of these differences.
</p>


<h3>Source</h3>

<p><a href="https://jurisprudence.tas-cas.org/Shared%20Documents/2773.pdf">https://jurisprudence.tas-cas.org/Shared%20Documents/2773.pdf</a>
</p>

<hr>
<h2 id='OFFscore'>function OFFscore</h2><span id='topic+OFFscore'></span>

<h3>Description</h3>

<p>The <code>OFFscore</code> function computes the value of the OFF-hr
score (or OFF score), a combination of the haemoglobin level and
the percentage of reticulocytes, used for detecting blood doping.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>OFFscore(haemdata = NULL, HGB = NULL, RETP = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="OFFscore_+3A_haemdata">haemdata</code></td>
<td>
<p>a vector or data frame containing (at least) the 2
haematological variables, either with the same names as the
parameters below, or (not recommended) without names but in the
same order as the parameters.</p>
</td></tr>
<tr><td><code id="OFFscore_+3A_hgb">HGB</code></td>
<td>
<p>level of haemoglobin HGB [g/dL]</p>
</td></tr>
<tr><td><code id="OFFscore_+3A_retp">RETP</code></td>
<td>
<p>percentage of reticulocytes [%]</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The OFF-hr score is defined as 10*HGB [g/dL] - 60*sqrt(RETP [%]).
</p>
<p>It is one of the parameters of the Athlete Biological Passport
(ABP) program managed by the World Anti-Doping Agency (WADA), and
is routinely used to identify athletes who use a substance
prohibited by anti-doping rules (see
e.g. <a href="https://jurisprudence.tas-cas.org/Shared%20Documents/4006.pdf">https://jurisprudence.tas-cas.org/Shared%20Documents/4006.pdf</a>).
</p>
<p>The rationale for using this score for detecting blood doping is
the following: if a manipulation (use of transfusion or of
erythropoietic stimulating agents (ESA) such as recombinant human
erythropoietin (rhEPO)) increases the number of circulating red
cells (and thus increases the level of haemoglobin), the organism
will react by stopping its own production of red blood cells. This
negative feedback will be observed in the reduced percentage of
reticulocytes (immature red blood cells). Such a combination of
elevated HGB and reduced RETP, which will produce a high OFF
score, is found neither naturally, nor as the consequence of a
medical condition, and is thus indicative of doping.
</p>
<p>The OFF score will pick up both withdrawal of blood (which induces
a reduction in haemoglobin, a rise in reticulocytes, and thus a
rise of RETP and a reduction of OFF score), and its re-infusion
(HGB concentration increases, number of reticulocytes and RETP
decrease, and OFF score increases).
</p>


<h3>Value</h3>

<p>value of the OFF score.
</p>


<h3>Note</h3>

<p>The values for HGB and RETP can be specified using either a data
frame containing (at least) the 2 haematological variables, or
using two named parameters, but not both at the same time.
</p>
<p>The original OFF-hr score, as described by Gore et al., expects
the haemoglobin level HGB to be specified in g/L. In order to be
coherent with other functions in the package, this function assumes
that HGB is specified in g/dL, and will multiply the value by 10.
A warning will be emitted if units used seem wrong.
</p>


<h3>References</h3>

<p>Gore, C.J., R. Parisotto, M.J. Ashenden, et al., Second-generation
blood tests to detect erythropoietin abuse by athletes.
Haematologica, 2003. 88(3): p. 333-44.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>OFFscore(HGB=14.6, RETP=0.48)

data(blooddoping)
OFFscore(HGB=blooddoping$HGB, RETP=blooddoping$RETP)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
