<!DOCTYPE html><html lang="en-GB"><head><title>Help for package Ternary</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {Ternary}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Ternary-package'><p>The 'Ternary' package allows the creation of ternary plots</p>
(a.k.a. ternary graphs / simplex plots / Gibbs triangles / de Finetti
diagrams) using the familiar functions of the default 'graphics' package.</a></li>
<li><a href='#.SetRegion'><p>Set plotting region</p></a></li>
<li><a href='#AddToHoldridge'><p>Add elements to ternary or Holdridge plot</p></a></li>
<li><a href='#Annotate'><p>Annotate points on a ternary plot</p></a></li>
<li><a href='#cbPalettes'><p>Palettes compatible with colour blindness</p></a></li>
<li><a href='#ColourTernary'><p>Colour a ternary plot according to the output of a function</p></a></li>
<li><a href='#holdridge'><p>Random sample of points for Holdridge plotting</p></a></li>
<li><a href='#holdridgeClasses'><p>Names of the 38 classes defined with the Holdridge system</p></a></li>
<li><a href='#HoldridgeHypsometricCol'><p>Convert a point in evapotranspiration-precipitation space to an appropriate</p>
cross-blended hypsometric colour</a></li>
<li><a href='#HoldridgePlot'><p>Plot life zones on a Holdridge plot</p></a></li>
<li><a href='#HoldridgeToXY'><p>Convert user-specified ternary coordinates into X and Y coordinates</p></a></li>
<li><a href='#OutsidePlot'><p>Is a point in the plotting area?</p></a></li>
<li><a href='#Polygon-Geometry'><p>Polygon geometry</p></a></li>
<li><a href='#ReflectedEquivalents'><p>Reflected equivalents of points outside the ternary plot</p></a></li>
<li><a href='#TernaryApp'><p>Graphical user interface for creating ternary plots</p></a></li>
<li><a href='#TernaryContour'><p>Add contours to a ternary plot</p></a></li>
<li><a href='#TernaryCoords'><p>Convert ternary coordinates to Cartesian space</p></a></li>
<li><a href='#TernaryDensityContour'><p>Add contours of estimated point density to a ternary plot</p></a></li>
<li><a href='#TernaryPlot'><p>Create a ternary plot</p></a></li>
<li><a href='#TernaryPointValues'><p>Value of a function at regularly spaced points</p></a></li>
<li><a href='#TernaryTiles'><p>Paint tiles on ternary plot</p></a></li>
<li><a href='#TernaryXRange'><p>X and Y coordinates of ternary plotting area</p></a></li>
<li><a href='#TriangleCentres'><p>Coordinates of triangle mid-points</p></a></li>
<li><a href='#TriangleInHull'><p>Does triangle overlap convex hull of points?</p></a></li>
<li><a href='#XYToTernary'><p>Cartesian coordinates to ternary point</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>2.3.3</td>
</tr>
<tr>
<td>Title:</td>
<td>Create Ternary and Holdridge Plots</td>
</tr>
<tr>
<td>Description:</td>
<td>Plots ternary diagrams (simplex plots / Gibbs triangles) and
  Holdridge life zone plots &lt;<a href="https://doi.org/10.1126%2Fscience.105.2727.367">doi:10.1126/science.105.2727.367</a>&gt; using the
  standard graphics functions.
  Allows custom annotation, interpolating, contouring and scaling of plotting
  region.
  Includes a 'Shiny' user interface for point-and-click ternary plotting.
  An alternative to 'ggtern', which uses the 'ggplot2' family of plotting 
  functions.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://ms609.github.io/Ternary/">https://ms609.github.io/Ternary/</a>,
<a href="https://github.com/ms609/Ternary/">https://github.com/ms609/Ternary/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/ms609/Ternary/issues/">https://github.com/ms609/Ternary/issues/</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Language:</td>
<td>en-GB</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>PlotTools (&ge; 0.2.0), RcppHungarian, shiny, sp,</td>
</tr>
<tr>
<td>Suggests:</td>
<td>colourpicker, knitr, readxl, rmarkdown, shinyjs, spelling,
testthat (&ge; 3.0), vdiffr,</td>
</tr>
<tr>
<td>Config/Needs/check:</td>
<td>rcmdcheck</td>
</tr>
<tr>
<td>Config/Needs/coverage:</td>
<td>covr</td>
</tr>
<tr>
<td>Config/Needs/memcheck:</td>
<td>devtools, rcmdcheck</td>
</tr>
<tr>
<td>Config/Needs/metadata:</td>
<td>codemeta</td>
</tr>
<tr>
<td>Config/Needs/revdeps:</td>
<td>revdepcheck</td>
</tr>
<tr>
<td>Config/Needs/website:</td>
<td>pkgdown</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Config/testthat/parallel:</td>
<td>false</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-08-27 12:05:18 UTC; pjjg18</td>
</tr>
<tr>
<td>Author:</td>
<td>Martin R. Smith <a href="https://orcid.org/0000-0001-5660-1727"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre, cph],
  Lilian Sanselme [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Martin R. Smith &lt;martin.smith@durham.ac.uk&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-08-27 13:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='Ternary-package'>The 'Ternary' package allows the creation of ternary plots
(a.k.a. ternary graphs / simplex plots / Gibbs triangles / de Finetti
diagrams) using the familiar functions of the default 'graphics' package.</h2><span id='topic+Ternary'></span><span id='topic+Ternary-package'></span>

<h3>Description</h3>

<p>For simple use cases, generate ternary plots using the point-and-click
Shiny app:
</p>


<h3>Details</h3>

<div class="sourceCode"><pre>install.packages('Ternary')
Ternary::TernaryApp()
</pre></div>
<p>For greater control over your plots, use the R command line;
for usage instructions, consult the guidance article
<a href="https://ms609.github.io/Ternary/articles/Ternary.html">online</a> or by
typing <code>vignette('Ternary', 'Ternary')</code> at the R console.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Martin R. Smith <a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a> (<a href="https://orcid.org/0000-0001-5660-1727">ORCID</a>) [copyright holder]
</p>
<p>Other contributors:
</p>

<ul>
<li><p> Lilian Sanselme [contributor]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://ms609.github.io/Ternary/">https://ms609.github.io/Ternary/</a>
</p>
</li>
<li> <p><a href="https://github.com/ms609/Ternary/">https://github.com/ms609/Ternary/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/ms609/Ternary/issues/">https://github.com/ms609/Ternary/issues/</a>
</p>
</li></ul>


<hr>
<h2 id='.SetRegion'>Set plotting region</h2><span id='topic+.SetRegion'></span>

<h3>Description</h3>

<p>Sets the region of the ternary plot being drawn.
Usually called from within <code>TernaryPlot()</code>; everyday users are unlikely to
need to call this function directly.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.SetRegion(region, prettify = NA_integer_, set = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".SetRegion_+3A_region">region</code></td>
<td>
<p>(optional) Named list of length two specifying the the
<code>min</code>imum and <code>max</code>imum values of each ternary axis to be drawn
(e.g. <code style="white-space: pre;">&#8288;list(min = c(40, 0, 0), max = c(100, 60, 60)&#8288;</code>);
or a set of coordinates in a format accepted by <code><a href="#topic+TernaryPoints">TernaryPoints()</a></code>.
The plotted region will correspond to the smallest equilateral triangle
that encompasses the specified ranges or coordinates.</p>
</td></tr>
<tr><td><code id=".SetRegion_+3A_prettify">prettify</code></td>
<td>
<p>If numeric, the plotting region will be expanded to allow
grid lines to be produced with <code>pretty(n = prettify)</code>. If <code>NA</code>, the
smallest region encompassing <code>region</code> will be used.</p>
</td></tr>
<tr><td><code id=".SetRegion_+3A_set">set</code></td>
<td>
<p>Logical specifying whether to set <code>options(ternRegion = region)</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>.SetRegion()</code> returns the value of <code>options(ternRegion = region)</code>
if <code>set == TRUE</code>, or the region, otherwise..
</p>


<h3>Author(s)</h3>

<p><a href="https://orcid.org/0000-0001-5660-1727">Martin R. Smith</a>
(<a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a>)
</p>


<h3>Examples</h3>

<pre><code class='language-R'># XY Coordinates under original plotting region
TernaryToXY(c(1, 2, 3))
previous &lt;- .SetRegion(rbind(min = c(20, 20, 20), max = c(60, 60, 60)))

# New region options set
getOption("ternRegion")

# Coordinates under new plotting region
TernaryToXY(c(1, 2, 3))

# Restore previous setting
options(previous)
getOption("ternRegion")
</code></pre>

<hr>
<h2 id='AddToHoldridge'>Add elements to ternary or Holdridge plot</h2><span id='topic+AddToHoldridge'></span><span id='topic+HoldridgeArrows'></span><span id='topic+HoldridgeLines'></span><span id='topic+HoldridgePoints'></span><span id='topic+HoldridgePolygon'></span><span id='topic+HoldridgeText'></span><span id='topic+AddToTernary'></span><span id='topic+TernarySegments'></span><span id='topic+TernaryArrows'></span><span id='topic+TernaryLines'></span><span id='topic+TernaryPoints'></span><span id='topic+TernaryPolygon'></span><span id='topic+TernaryText'></span><span id='topic+JoinTheDots'></span>

<h3>Description</h3>

<p>Plot shapes onto a ternary diagram created with <code><a href="#topic+TernaryPlot">TernaryPlot()</a></code>,
or a Holdridge plot created with <code><a href="#topic+HoldridgePlot">HoldridgePlot()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AddToHoldridge(PlottingFunction, pet, prec, ...)

HoldridgeArrows(fromCoordinates, toCoordinates = fromCoordinates, ...)

HoldridgeLines(pet, prec, ...)

HoldridgePoints(pet, prec, ...)

HoldridgePolygon(pet, prec, ...)

HoldridgeText(pet, prec, ...)

AddToTernary(PlottingFunction, coordinates, ...)

TernarySegments(fromCoordinates, toCoordinates = fromCoordinates, ...)

TernaryArrows(fromCoordinates, toCoordinates = fromCoordinates, ...)

TernaryLines(coordinates, ...)

TernaryPoints(coordinates, ...)

TernaryPolygon(coordinates, ...)

TernaryText(coordinates, ...)

JoinTheDots(coordinates, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AddToHoldridge_+3A_plottingfunction">PlottingFunction</code></td>
<td>
<p>Function to add data to a plot; perhaps one of
<code><a href="graphics.html#topic+points">points</a></code>,
<code><a href="graphics.html#topic+lines">lines</a></code> or
<code><a href="graphics.html#topic+text">text</a></code>.</p>
</td></tr>
<tr><td><code id="AddToHoldridge_+3A_pet">pet</code>, <code id="AddToHoldridge_+3A_prec">prec</code></td>
<td>
<p>Numeric vectors giving <em>p</em>otential <em>e</em>vapo<em>t</em>ranspiration
ratio and annual <em>prec</em>ipitation (in mm).</p>
</td></tr>
<tr><td><code id="AddToHoldridge_+3A_...">...</code></td>
<td>
<p>Additional parameters to pass to <code>PlottingFunction()</code>.
If using <code>TernaryText()</code>, this will likely include the parameter <code>labels</code>,
to specify the text to plot. Other useful
<a href="graphics.html#topic+par">graphical parameters</a> include <code>srt</code> to rotate text.</p>
</td></tr>
<tr><td><code id="AddToHoldridge_+3A_fromcoordinates">fromCoordinates</code>, <code id="AddToHoldridge_+3A_tocoordinates">toCoordinates</code></td>
<td>
<p>For <code>TernaryArrows()</code>, coordinates at
which arrows should begin and end; <em>cf.</em> <code>x0</code>, <code>y0</code>, <code>x1</code> and <code>y1</code> in
<a href="graphics.html#topic+arrows">arrows</a>.  Recycled as necessary.</p>
</td></tr>
<tr><td><code id="AddToHoldridge_+3A_coordinates">coordinates</code></td>
<td>
<p>A list, matrix, data.frame or vector in which each
element (or row) specifies
the three coordinates of a point in ternary space.</p>
</td></tr>
</table>


<h3>Functions</h3>


<ul>
<li> <p><code>HoldridgeArrows()</code>: Add  <a href="graphics.html#topic+arrows">arrows</a> to Holdridge plot
</p>
</li>
<li> <p><code>HoldridgeLines()</code>: Add <a href="graphics.html#topic+lines">lines</a> to Holdridge plot
</p>
</li>
<li> <p><code>HoldridgePoints()</code>: Add <a href="graphics.html#topic+points">points</a> to Holdridge plot
</p>
</li>
<li> <p><code>HoldridgePolygon()</code>: Add <a href="graphics.html#topic+polygon">polygons</a> to Holdridge
plot
</p>
</li>
<li> <p><code>HoldridgeText()</code>: Add <a href="graphics.html#topic+text">text</a> to Holdridge plot
</p>
</li>
<li> <p><code>TernarySegments()</code>: Add <a href="graphics.html#topic+segments">segments</a>
</p>
</li>
<li> <p><code>TernaryArrows()</code>: Add  <a href="graphics.html#topic+arrows">arrows</a>
</p>
</li>
<li> <p><code>TernaryLines()</code>: Add <a href="graphics.html#topic+lines">lines</a>
</p>
</li>
<li> <p><code>TernaryPoints()</code>: Add <a href="graphics.html#topic+points">points</a>
</p>
</li>
<li> <p><code>TernaryPolygon()</code>: Add <a href="graphics.html#topic+polygon">polygons</a>
</p>
</li>
<li> <p><code>TernaryText()</code>: Add <a href="graphics.html#topic+text">text</a>
</p>
</li>
<li> <p><code>JoinTheDots()</code>: Add points, joined by lines
</p>
</li></ul>


<h3>Author(s)</h3>

<p><a href="https://orcid.org/0000-0001-5660-1727">Martin R. Smith</a>
(<a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a>)
</p>


<h3>See Also</h3>

<p>Other Holdridge plotting functions: 
<code><a href="#topic+HoldridgeHypsometricCol">HoldridgeHypsometricCol</a>()</code>,
<code><a href="#topic+HoldridgePlot">HoldridgePlot</a>()</code>,
<code><a href="#topic+holdridge">holdridge</a></code>,
<code><a href="#topic+holdridgeClasses">holdridgeClasses</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Data to plot
coords &lt;- list(
  A = c(1, 0, 2),
  B = c(1, 1, 1),
  C = c(1.5, 1.5, 0),
  D = c(0.5, 1.5, 1)
)

# Set up plot
oPar &lt;- par(mar = rep(0, 4), xpd = NA) # reduce margins and write in them
TernaryPlot()

# Add elements to ternary diagram
AddToTernary(lines, coords, col = "darkgreen", lty = "dotted", lwd = 3)
TernaryLines(coords, col = "darkgreen")
TernaryArrows(coords[1], coords[2:4], col = "orange", length = 0.2, lwd = 1)
TernaryText(coords, cex = 0.8, col = "red", font = 2)
TernaryPoints(coords, pch = 1, cex = 2, col = "blue")
AddToTernary(graphics::points, coords, pch = 1, cex = 3)

# An equivalent syntax applies to Holdridge plots:
HoldridgePlot()
pet &lt;- c(0.8, 2, 0.42)
prec &lt;- c(250, 400, 1337)
HoldridgeText(pet, prec, c("A", "B", "C"))
AddToHoldridge(graphics::points, pet, prec, cex = 3)

# Restore original plotting parameters
par(oPar)
</code></pre>

<hr>
<h2 id='Annotate'>Annotate points on a ternary plot</h2><span id='topic+Annotate'></span>

<h3>Description</h3>

<p><code>Annotate()</code> identifies and label individual points on a ternary diagram
in the plot margins.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Annotate(
  coordinates,
  labels,
  side,
  outset = 0.16,
  line.col = col,
  lty = par("lty"),
  lwd = par("lwd"),
  col = par("col"),
  font = par("font"),
  offset = 0.5,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Annotate_+3A_coordinates">coordinates</code></td>
<td>
<p>A list, matrix, data.frame or vector in which each
element (or row) specifies
the three coordinates of a point in ternary space.</p>
</td></tr>
<tr><td><code id="Annotate_+3A_labels">labels</code></td>
<td>
<p>Character vector specifying text with which to annotate
each entry in <code>coordinates</code>.</p>
</td></tr>
<tr><td><code id="Annotate_+3A_side">side</code></td>
<td>
<p>Optional vector specifying which side of the ternary
plot each point should be labelled on, using the notation <code style="white-space: pre;">&#8288;"a", "b", "c"&#8288;</code> or
<code style="white-space: pre;">&#8288;1, 2, 3&#8288;</code>.
Entries of <code>"n"</code> or <code>0</code> will not be annotated
(but still require an entry in <code>labels</code>).
Entries of <code>NA</code> will be allocated a side automatically,
based on the midpoint of <code>coordinates</code>.</p>
</td></tr>
<tr><td><code id="Annotate_+3A_outset">outset</code></td>
<td>
<p>Numeric specifying distance from plot margins to labels.</p>
</td></tr>
<tr><td><code id="Annotate_+3A_line.col">line.col</code>, <code id="Annotate_+3A_lty">lty</code>, <code id="Annotate_+3A_lwd">lwd</code></td>
<td>
<p>parameters to <code><a href="graphics.html#topic+segments">segments()</a></code>.</p>
</td></tr>
<tr><td><code id="Annotate_+3A_col">col</code>, <code id="Annotate_+3A_font">font</code>, <code id="Annotate_+3A_offset">offset</code></td>
<td>
<p>parameters to <code><a href="graphics.html#topic+text">text()</a></code>.</p>
</td></tr>
<tr><td><code id="Annotate_+3A_...">...</code></td>
<td>
<p>Further parameters to <code><a href="graphics.html#topic+text">text()</a></code> and <code><a href="graphics.html#topic+segments">segments()</a></code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p><a href="https://orcid.org/0000-0001-5660-1727">Martin R. Smith</a>
(<a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a>)
</p>


<h3>See Also</h3>

<p><a href="https://ms609.github.io/Ternary/dev/articles/annotation.html">Annotation vignette</a> gives
further suggestions for manual annotation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load some data
data("Seatbelts")
seats &lt;- c("drivers", "front", "rear")
seat &lt;- Seatbelts[month.abb %in% "Oct", seats]
law &lt;- Seatbelts[month.abb %in% "Oct", "law"]

# Set up plot
oPar &lt;- par(mar = c(2, 0, 0, 0))
TernaryPlot(alab = seats[1], blab = seats[2], clab = seats[3])
TernaryPoints(seat, cex = 0.8, col = 2 + law)

# Annotate points by year
Annotate(seat, labels = 1969:1984, col = 2 + law)

# Restore original graphical parameters
par(oPar)  
</code></pre>

<hr>
<h2 id='cbPalettes'>Palettes compatible with colour blindness</h2><span id='topic+cbPalettes'></span><span id='topic+cbPalette8'></span><span id='topic+cbPalette13'></span><span id='topic+cbPalette15'></span>

<h3>Description</h3>

<p>Colour palettes recommended for use with colour blind audiences.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cbPalette8

cbPalette13

cbPalette15
</code></pre>


<h3>Format</h3>

<p>Character vectors of lengths 8, 13 and 15.
</p>
<p>An object of class <code>character</code> of length 8.
</p>
<p>An object of class <code>character</code> of length 13.
</p>
<p>An object of class <code>character</code> of length 15.
</p>


<h3>Details</h3>

<p>Since R 4.0, <code>cbPalette8</code> is available in base R as <code>palette.colors(8)</code>.
</p>
<p><code>cbPalette15</code> is a <a href="http://mkweb.bcgsc.ca/brewer/">Brewer palette</a>.
Because colours 4 and 7 are difficult to distinguish from colours 13 and 3,
respectively, in individuals with tritanopia, <code>cbPalette13</code> omits these
colours (i.e. <code>cbPalette13 &lt;- cbPalette15[-c(4, 7)]</code>).
</p>


<h3>Source</h3>


<ul>
<li> <p><code>cbPalette8</code>: <cite>Wong B. 2011. Color blindness. Nat. Methods. 8:441.
<a href="https://doi.org/10.1038/nmeth.1618">doi:10.1038/nmeth.1618</a></cite>
</p>
</li>
<li> <p><code>cbPalette15</code>: <a href="http://mkweb.bcgsc.ca/biovis2012/color-blindness-palette.png">http://mkweb.bcgsc.ca/biovis2012/color-blindness-palette.png</a>
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>data("cbPalette8")
plot.new()
plot.window(xlim = c(1, 16), ylim = c(0, 3))
text(1:8 * 2, 3, 1:8, col = cbPalette8)
points(1:8 * 2, rep(2, 8), col = cbPalette8, pch = 15)

data("cbPalette15")
text(1:15, 1, col = cbPalette15)
text(c(4, 7), 1, "[   ]")
points(1:15, rep(0, 15), col = cbPalette15, pch = 15)
</code></pre>

<hr>
<h2 id='ColourTernary'>Colour a ternary plot according to the output of a function</h2><span id='topic+ColourTernary'></span><span id='topic+ColorTernary'></span>

<h3>Description</h3>

<p>Colour a ternary plot according to the output of a function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ColourTernary(
  values,
  spectrum = hcl.colors(256L, palette = "viridis", alpha = 0.6),
  resolution = sqrt(ncol(values)),
  direction = getOption("ternDirection", 1L),
  legend,
  ...
)

ColorTernary(
  values,
  spectrum = hcl.colors(256L, palette = "viridis", alpha = 0.6),
  resolution = sqrt(ncol(values)),
  direction = getOption("ternDirection", 1L),
  legend,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ColourTernary_+3A_values">values</code></td>
<td>
<p>Numeric matrix, possibly created using
<code><a href="#topic+TernaryPointValues">TernaryPointValues()</a></code>, with four named rows:
<code>x</code>, <code>y</code>, cartesian coordinates of each triangle centre;
<code>z</code>, value associated with that coordinate;
<code>down</code>, triangle direction: <code>0</code> = point upwards; <code>1</code> = point downwards.</p>
</td></tr>
<tr><td><code id="ColourTernary_+3A_spectrum">spectrum</code></td>
<td>
<p>Vector of colours to use as a spectrum, or <code>NULL</code> to use
<code>values["z", ]</code>.</p>
</td></tr>
<tr><td><code id="ColourTernary_+3A_resolution">resolution</code></td>
<td>
<p>The number of triangles whose base should lie on the longest
axis of the triangle.  Higher numbers will result in smaller subdivisions and smoother
colour gradients, but at a computational cost.</p>
</td></tr>
<tr><td><code id="ColourTernary_+3A_direction">direction</code></td>
<td>
<p>(optional) Integer specifying the direction that the
current ternary plot should point: 1, up; 2, right; 3, down; 4, left.</p>
</td></tr>
<tr><td><code id="ColourTernary_+3A_legend">legend</code></td>
<td>
<p>Character vector specifying annotations for colour scale.
If not provided, no colour legend is displayed.
Specify <code>TRUE</code> to generate automatically, or a single integer to generate
<code>legend</code> annotations.</p>
</td></tr>
<tr><td><code id="ColourTernary_+3A_...">...</code></td>
<td>
<p>Further arguments to
<code><a href="PlotTools.html#topic+SpectrumLegend">SpectrumLegend()</a></code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p><a href="https://orcid.org/0000-0001-5660-1727">Martin R. Smith</a>
(<a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a>)
</p>


<h3>See Also</h3>

<p>Fine control over continuous legends:
<code><a href="PlotTools.html#topic+SpectrumLegend">PlotTools::SpectrumLegend()</a></code>
</p>
<p>Other contour plotting functions: 
<code><a href="#topic+TernaryContour">TernaryContour</a>()</code>,
<code><a href="#topic+TernaryDensityContour">TernaryDensityContour</a>()</code>,
<code><a href="#topic+TernaryPointValues">TernaryPointValues</a>()</code>
</p>
<p>Other functions for colouring and shading: 
<code><a href="#topic+TernaryTiles">TernaryTiles</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>TernaryPlot(alab = "a", blab = "b", clab = "c")

FunctionToContour &lt;- function (a, b, c) {
  a - c + (4 * a * b) + (27 * a * b * c)
}

values &lt;- TernaryPointValues(FunctionToContour, resolution = 24L)
ColourTernary(
  values,
  x = "topleft",
  bty = "n", # No box
  legend = signif(seq(max(values), min(values), length.out = 4), 3)
)
TernaryContour(FunctionToContour, resolution = 36L)


TernaryPlot()
values &lt;- TernaryPointValues(rgb, resolution = 20)
ColourTernary(values, spectrum = NULL)

# Create a helper function to place white centrally:
rgbWhite &lt;- function (r, g, b) {
  highest &lt;- apply(rbind(r, g, b), 2L, max)
  rgb(r/highest, g/highest, b/highest)
}

TernaryPlot()
values &lt;- TernaryPointValues(rgbWhite, resolution = 20)
ColourTernary(values, spectrum = NULL)


</code></pre>

<hr>
<h2 id='holdridge'>Random sample of points for Holdridge plotting</h2><span id='topic+holdridge'></span>

<h3>Description</h3>

<p>A stratified random sampling (average of 100 points) using
a global mapping of Holdridge’s scheme.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>holdridge
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 39 rows and 4 columns.
</p>


<h3>Author(s)</h3>

<p>James Lee Tsakalos
</p>


<h3>See Also</h3>

<p>Other Holdridge plotting functions: 
<code><a href="#topic+AddToHoldridge">AddToHoldridge</a>()</code>,
<code><a href="#topic+HoldridgeHypsometricCol">HoldridgeHypsometricCol</a>()</code>,
<code><a href="#topic+HoldridgePlot">HoldridgePlot</a>()</code>,
<code><a href="#topic+holdridgeClasses">holdridgeClasses</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("holdridge", package = "Ternary")
head(holdridge)
</code></pre>

<hr>
<h2 id='holdridgeClasses'>Names of the 38 classes defined with the Holdridge system</h2><span id='topic+holdridgeClasses'></span><span id='topic+holdridgeLifeZones'></span><span id='topic+holdridgeLifeZonesUp'></span><span id='topic+holdridgeClassesUp'></span>

<h3>Description</h3>

<p><code>holdridgeClasses</code> is a character vector naming, from left to right,
top to bottom, the 38 classes defined by the International Institute for
Applied Systems Analysis (IIASA).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>holdridgeClasses

holdridgeLifeZones

holdridgeLifeZonesUp

holdridgeClassesUp
</code></pre>


<h3>Format</h3>

<p>An object of class <code>character</code> of length 38.
</p>
<p>An object of class <code>character</code> of length 33.
</p>
<p>An object of class <code>character</code> of length 33.
</p>
<p>An object of class <code>character</code> of length 38.
</p>


<h3>Details</h3>

<p><code>holdridgeLifeZones</code> is a character vector naming, from left to right,
top to bottom, the 38 cells of the Holdridge classification plot.
</p>
<p><code>holdridgeClassesUp</code> and <code>holdridgeLifeZonesUp</code> replace spaces with new
lines, for more legible plotting with <code><a href="#topic+HoldridgeHexagons">HoldridgeHexagons()</a></code>.
</p>


<h3>Author(s)</h3>

<p><a href="https://orcid.org/0000-0001-5660-1727">Martin R. Smith</a>
(<a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a>)
</p>


<h3>Source</h3>

<p>Holdridge (1947),
&quot;Determination of world plant formations from simple climatic data&quot;,
<em>Science</em> 105:367–368. <a href="https://doi.org/10.1126/science.105.2727.367">doi:10.1126/science.105.2727.367</a>
</p>
<p>Holdridge (1967), <em>Life zone ecology</em>. Tropical Science Center,
San José.
</p>
<p>Leemans, R. (1990),
&quot;Possible change in natural vegetation patterns due to a global warming&quot;,
<em>International Institute for Applied Systems Analysis</em> Working paper
WP-90-08.
<a href="https://pure.iiasa.ac.at/id/eprint/3443/1/WP-90-008.pdf">https://pure.iiasa.ac.at/id/eprint/3443/1/WP-90-008.pdf</a>
</p>


<h3>See Also</h3>

<p>Other Holdridge plotting functions: 
<code><a href="#topic+AddToHoldridge">AddToHoldridge</a>()</code>,
<code><a href="#topic+HoldridgeHypsometricCol">HoldridgeHypsometricCol</a>()</code>,
<code><a href="#topic+HoldridgePlot">HoldridgePlot</a>()</code>,
<code><a href="#topic+holdridge">holdridge</a></code>
</p>

<hr>
<h2 id='HoldridgeHypsometricCol'>Convert a point in evapotranspiration-precipitation space to an appropriate
cross-blended hypsometric colour</h2><span id='topic+HoldridgeHypsometricCol'></span>

<h3>Description</h3>

<p>Used to colour <code>HoldridgeHexagons()</code>, and may also be used to aid the
interpretation of PET + precipitation data in any graphical context.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>HoldridgeHypsometricCol(pet, prec, opacity = NA)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="HoldridgeHypsometricCol_+3A_pet">pet</code>, <code id="HoldridgeHypsometricCol_+3A_prec">prec</code></td>
<td>
<p>Numeric vectors giving <em>p</em>otential <em>e</em>vapo<em>t</em>ranspiration
ratio and annual <em>prec</em>ipitation (in mm).</p>
</td></tr>
<tr><td><code id="HoldridgeHypsometricCol_+3A_opacity">opacity</code></td>
<td>
<p>Opacity level to be converted to the final two characters
of an <abbr><span class="acronym">RGBA</span></abbr> hexadecimal colour definition, e.g. <code style="white-space: pre;">&#8288;#000000FF&#8288;</code>.
Specify a character string, which will be interpreted as a hexadecimal
alpha value and appended to the six <abbr><span class="acronym">RGB</span></abbr> hexadecimal digits;
a numeric in the range 0 (transparent) to 1 (opaque);
or <code>NA</code>, to return only the six <abbr><span class="acronym">RGB</span></abbr> digits.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character vector listing <abbr><span class="acronym">RGB</span></abbr> or (if <code>opacity != NA</code>)
<abbr><span class="acronym">RGBA</span></abbr> values corresponding to each PET-precipitation value pair.
</p>


<h3>Author(s)</h3>

<p><a href="https://orcid.org/0000-0001-5660-1727">Martin R. Smith</a>
(<a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a>)
</p>


<h3>References</h3>

<p>Palette derived from the hypsometric colour scheme presented at
<a href="https://www.shadedrelief.com/hypso/hypso.html">Shaded Relief</a>.
</p>


<h3>See Also</h3>

<p>Other Holdridge plotting functions: 
<code><a href="#topic+AddToHoldridge">AddToHoldridge</a>()</code>,
<code><a href="#topic+HoldridgePlot">HoldridgePlot</a>()</code>,
<code><a href="#topic+holdridge">holdridge</a></code>,
<code><a href="#topic+holdridgeClasses">holdridgeClasses</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>HoldridgePlot(hex.col = HoldridgeHypsometricCol)
VeryTransparent &lt;- function(...) HoldridgeHypsometricCol(..., opacity = 0.3)
HoldridgePlot(hex.col = VeryTransparent)
pet &lt;- holdridge$PET
prec &lt;- holdridge$Precipitation
ptCol &lt;- HoldridgeHypsometricCol(pet, prec)
HoldridgePoints(pet, prec, pch = 21, bg = ptCol)
</code></pre>

<hr>
<h2 id='HoldridgePlot'>Plot life zones on a Holdridge plot</h2><span id='topic+HoldridgePlot'></span><span id='topic+HoldridgeBelts'></span><span id='topic+HoldridgeHexagons'></span>

<h3>Description</h3>

<p><code>HoldridgePlot()</code> creates a blank triangular plot, as proposed by
Holdridge (1947, 1967), onto which potential evapotranspiration
(<abbr><span class="acronym">PET</span></abbr>) ratio and annual precipitation data can be plotted
(using the <code><a href="#topic+AddToHoldridge">AddToHoldridge()</a></code> family of functions) in order to interpret
climatic life zones.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>HoldridgePlot(
  atip = NULL,
  btip = NULL,
  ctip = NULL,
  alab = "Potential evapotranspiration ratio",
  blab = "Annual precipitation / mm",
  clab = "Humidity province",
  lab.offset = 0.22,
  lab.col = c("#D81B60", "#1E88E5", "#111111"),
  xlim = NULL,
  ylim = NULL,
  region = NULL,
  lab.cex = 1,
  lab.font = 0,
  tip.cex = lab.cex,
  tip.font = 2,
  tip.col = "black",
  isometric = TRUE,
  atip.rotate = NULL,
  btip.rotate = NULL,
  ctip.rotate = NULL,
  atip.pos = NULL,
  btip.pos = NULL,
  ctip.pos = NULL,
  padding = 0.16,
  col = NA,
  panel.first = NULL,
  panel.last = NULL,
  grid.lines = 8,
  grid.col = c(NA, "#1E88E5", "#D81B60"),
  grid.lty = "solid",
  grid.lwd = par("lwd"),
  grid.minor.lines = 0,
  grid.minor.col = "lightgrey",
  grid.minor.lty = "solid",
  grid.minor.lwd = par("lwd"),
  hex.border = "#888888",
  hex.col = HoldridgeHypsometricCol,
  hex.lty = "solid",
  hex.lwd = par("lwd"),
  hex.cex = 0.5,
  hex.labels = NULL,
  hex.font = NULL,
  hex.text.col = "black",
  axis.cex = 0.8,
  axis.col = c(grid.col[2], grid.col[3], NA),
  axis.font = par("font"),
  axis.labels = TRUE,
  axis.lty = "solid",
  axis.lwd = 1,
  axis.rotate = TRUE,
  axis.pos = NULL,
  axis.tick = TRUE,
  ticks.lwd = axis.lwd,
  ticks.length = 0.025,
  ticks.col = grid.col,
  ...
)

HoldridgeBelts(
  grid.col = "#004D40",
  grid.lty = "dotted",
  grid.lwd = par("lwd")
)

HoldridgeHexagons(
  border = "#004D40",
  hex.col = HoldridgeHypsometricCol,
  lty = "dotted",
  lwd = par("lwd"),
  labels = NULL,
  cex = 1,
  text.col = NULL,
  font = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="HoldridgePlot_+3A_atip">atip</code>, <code id="HoldridgePlot_+3A_btip">btip</code>, <code id="HoldridgePlot_+3A_ctip">ctip</code></td>
<td>
<p>Character string specifying text to title corners,
proceeding clockwise from the corner specified in <code>point</code> (default: top).</p>
</td></tr>
<tr><td><code id="HoldridgePlot_+3A_alab">alab</code>, <code id="HoldridgePlot_+3A_blab">blab</code>, <code id="HoldridgePlot_+3A_clab">clab</code></td>
<td>
<p>Character string specifying text with which to label
the corresponding sides of the triangle.
Left or right-pointing arrows are produced by
typing <code style="white-space: pre;">&#8288;\\U2190&#8288;</code> or <code style="white-space: pre;">&#8288;\\U2192&#8288;</code>, or using <code>expression('value' %-&gt;% '')</code>.</p>
</td></tr>
<tr><td><code id="HoldridgePlot_+3A_lab.offset">lab.offset</code></td>
<td>
<p>Numeric specifying distance between midpoint of axis label
and the axis. The default value is given in the 'Usage' section; a value
of <code>0</code> will position the axis label directly on the axis.
Increase <code>padding</code> if labels are being clipped.
Use a vector of length three to specify a different offset for each label.</p>
</td></tr>
<tr><td><code id="HoldridgePlot_+3A_lab.col">lab.col</code></td>
<td>
<p>Character vector specifying colours for axis labels. Use a
vector of length three to specify a different colour for each label.</p>
</td></tr>
<tr><td><code id="HoldridgePlot_+3A_xlim">xlim</code>, <code id="HoldridgePlot_+3A_ylim">ylim</code></td>
<td>
<p>Numeric vectors of length two specifying the minimum and
maximum <em>x</em> and <em>y</em> limits of the plotted area, to which <code>padding</code> will be
added.
The default is to display the complete height or width of the plot.
Allows cropping to magnified region of the plot. (See vignette for diagram.)
May be overridden if <code>isometric = TRUE</code>; see documentation of
<code>isometric</code> parameter.</p>
</td></tr>
<tr><td><code id="HoldridgePlot_+3A_region">region</code></td>
<td>
<p>(optional) Named list of length two specifying the the
<code>min</code>imum and <code>max</code>imum values of each ternary axis to be drawn
(e.g. <code style="white-space: pre;">&#8288;list(min = c(40, 0, 0), max = c(100, 60, 60)&#8288;</code>);
or a set of coordinates in a format accepted by <code><a href="#topic+TernaryPoints">TernaryPoints()</a></code>.
The plotted region will correspond to the smallest equilateral triangle
that encompasses the specified ranges or coordinates.</p>
</td></tr>
<tr><td><code id="HoldridgePlot_+3A_lab.cex">lab.cex</code>, <code id="HoldridgePlot_+3A_tip.cex">tip.cex</code></td>
<td>
<p>Numeric specifying character expansion (font size)
for axis labels.
Use a vector of length three to specify a different value for each direction.</p>
</td></tr>
<tr><td><code id="HoldridgePlot_+3A_lab.font">lab.font</code>, <code id="HoldridgePlot_+3A_tip.font">tip.font</code></td>
<td>
<p>Numeric specifying font style (Roman, bold, italic,
bold-italic) for axis titles.
Use a vector of length three to set a different font for each direction.</p>
</td></tr>
<tr><td><code id="HoldridgePlot_+3A_isometric">isometric</code></td>
<td>
<p>Logical specifying whether to enforce an equilateral shape
for the ternary plot.
If only one of <code>xlim</code> and <code>ylim</code> is set, the other will be calculated to
maintain an equilateral plot.
If both <code>xlim</code> and <code>ylim</code> are set, but have different ranges, then the limit
with the smaller range will be scaled until its range matches that of the
other limit.</p>
</td></tr>
<tr><td><code id="HoldridgePlot_+3A_atip.rotate">atip.rotate</code>, <code id="HoldridgePlot_+3A_btip.rotate">btip.rotate</code>, <code id="HoldridgePlot_+3A_ctip.rotate">ctip.rotate</code></td>
<td>
<p>Integer specifying number of
degrees to rotate label of rightmost apex.</p>
</td></tr>
<tr><td><code id="HoldridgePlot_+3A_atip.pos">atip.pos</code>, <code id="HoldridgePlot_+3A_btip.pos">btip.pos</code>, <code id="HoldridgePlot_+3A_ctip.pos">ctip.pos</code></td>
<td>
<p>Integer specifying positioning of labels,
iff the corresponding <code>xtip.rotate</code> parameter is set.</p>
</td></tr>
<tr><td><code id="HoldridgePlot_+3A_padding">padding</code></td>
<td>
<p>Numeric specifying size of internal margin of the plot;
increase if axis labels are being clipped.</p>
</td></tr>
<tr><td><code id="HoldridgePlot_+3A_col">col</code></td>
<td>
<p>The colour for filling the plot; see
<code><a href="graphics.html#topic+polygon">polygon</a></code>.</p>
</td></tr>
<tr><td><code id="HoldridgePlot_+3A_panel.first">panel.first</code></td>
<td>
<p>An expression to be evaluated after the plot axes are
set up but before any plotting takes place.
This can be useful for drawing backgrounds, e.g. with <code><a href="#topic+ColourTernary">ColourTernary()</a></code>
or <code><a href="#topic+HorizontalGrid">HorizontalGrid()</a></code>.
Note that this works by lazy evaluation: passing this argument from other
plot methods may well not work since it may be evaluated too early.</p>
</td></tr>
<tr><td><code id="HoldridgePlot_+3A_panel.last">panel.last</code></td>
<td>
<p>An expression to be evaluated after plotting has taken
place but before the axes and box are added.  See the comments about
<code>panel.first</code>.</p>
</td></tr>
<tr><td><code id="HoldridgePlot_+3A_grid.lines">grid.lines</code></td>
<td>
<p>Integer specifying the number of grid lines to plot.
If <code>axis.labels = TRUE</code>, this will be used as a hint to <code>pretty()</code>.</p>
</td></tr>
<tr><td><code id="HoldridgePlot_+3A_grid.col">grid.col</code>, <code id="HoldridgePlot_+3A_grid.minor.col">grid.minor.col</code></td>
<td>
<p>Colours to draw the grid lines. Use a vector
of length three to set different values for each direction.</p>
</td></tr>
<tr><td><code id="HoldridgePlot_+3A_grid.lty">grid.lty</code>, <code id="HoldridgePlot_+3A_grid.minor.lty">grid.minor.lty</code></td>
<td>
<p>Character or integer vector; line type of
the grid lines. Use a vector of length three to set different values for
each direction.</p>
</td></tr>
<tr><td><code id="HoldridgePlot_+3A_grid.lwd">grid.lwd</code>, <code id="HoldridgePlot_+3A_grid.minor.lwd">grid.minor.lwd</code></td>
<td>
<p>Non-negative numeric giving line width of the
grid lines.  Use a vector of length three to set different values for each
direction.</p>
</td></tr>
<tr><td><code id="HoldridgePlot_+3A_grid.minor.lines">grid.minor.lines</code></td>
<td>
<p>Integer specifying the number of minor (unlabelled)
grid lines to plot between each major pair.</p>
</td></tr>
<tr><td><code id="HoldridgePlot_+3A_hex.border">hex.border</code>, <code id="HoldridgePlot_+3A_hex.lty">hex.lty</code>, <code id="HoldridgePlot_+3A_hex.lwd">hex.lwd</code></td>
<td>
<p>Parameters to pass to
<code>HoldridgeHexagons()</code>.  Set to <code>NA</code> to suppress hexagons.</p>
</td></tr>
<tr><td><code id="HoldridgePlot_+3A_hex.col">hex.col</code></td>
<td>
<p>Fill colour for hexagons.  Provide a vector specifying a
colour for each hexagon in turn, reading from left to right and top to
bottom, or a function that accepts two arguments, numerics <code>pet</code> and <code>prec</code>,
and returns a colour in a format accepted by
<code><a href="graphics.html#topic+polygon">polygon()</a></code>.</p>
</td></tr>
<tr><td><code id="HoldridgePlot_+3A_hex.cex">hex.cex</code>, <code id="HoldridgePlot_+3A_hex.font">hex.font</code>, <code id="HoldridgePlot_+3A_hex.text.col">hex.text.col</code></td>
<td>
<p>Parameters passed to
<code><a href="graphics.html#topic+text">text()</a></code> to plot <code>hex.labels</code>.</p>
</td></tr>
<tr><td><code id="HoldridgePlot_+3A_hex.labels">hex.labels</code></td>
<td>
<p>38-element character vector specifying label for
each hexagonal class, from top left to bottom right.</p>
</td></tr>
<tr><td><code id="HoldridgePlot_+3A_axis.cex">axis.cex</code></td>
<td>
<p>Numeric specifying character expansion (font size)
for axis labels.
Use a vector of length three to set a different value for each direction.</p>
</td></tr>
<tr><td><code id="HoldridgePlot_+3A_axis.col">axis.col</code>, <code id="HoldridgePlot_+3A_ticks.col">ticks.col</code>, <code id="HoldridgePlot_+3A_tip.col">tip.col</code></td>
<td>
<p>Colours for the axis line,
tick marks and tip labels respectively.
Use a vector of length three to set a different value for each direction.
<code>axis.col = NULL</code> means to use <code>par('fg')</code>, possibly specified
inline, and <code>ticks.col = NULL</code> means to use whatever colour
<code>axis.col</code> resolved to.</p>
</td></tr>
<tr><td><code id="HoldridgePlot_+3A_axis.font">axis.font</code></td>
<td>
<p>Font for text. Defaults to <code>par('font')</code>.</p>
</td></tr>
<tr><td><code id="HoldridgePlot_+3A_axis.labels">axis.labels</code></td>
<td>
<p>This can either be a logical value specifying whether
(numerical) annotations are to be made at the tickmarks, or a character or
expression vector of labels to be placed at the tick points,
or a list of length three, with each entry specifying labels to be placed
on each axis in turn.</p>
</td></tr>
<tr><td><code id="HoldridgePlot_+3A_axis.lty">axis.lty</code></td>
<td>
<p>Line type for both the axis line and tick marks.
Use a vector of length three to set a different value for each direction.</p>
</td></tr>
<tr><td><code id="HoldridgePlot_+3A_axis.lwd">axis.lwd</code>, <code id="HoldridgePlot_+3A_ticks.lwd">ticks.lwd</code></td>
<td>
<p>Line width for the axis line and tick marks.
Zero or negative values will suppress the line or ticks.
Use a vector of length three to set different values for each axis.</p>
</td></tr>
<tr><td><code id="HoldridgePlot_+3A_axis.rotate">axis.rotate</code></td>
<td>
<p>Logical specifying whether to rotate axis labels
to parallel grid lines, or numeric specifying custom rotation for each axis,
to be passed as <code>srt</code> parameter to <code>text()</code>.  Expand margins or set
<code>par(xpd = NA)</code> if labels are clipped.</p>
</td></tr>
<tr><td><code id="HoldridgePlot_+3A_axis.pos">axis.pos</code></td>
<td>
<p>Vector of length one or three specifying position of axis
labels, to be passed as <code>pos</code> parameter to <code>text()</code>; populated automatically
if <code>NULL</code> (the default).</p>
</td></tr>
<tr><td><code id="HoldridgePlot_+3A_axis.tick">axis.tick</code></td>
<td>
<p>Logical specifying whether to mark the axes with tick marks.</p>
</td></tr>
<tr><td><code id="HoldridgePlot_+3A_ticks.length">ticks.length</code></td>
<td>
<p>Numeric specifying distance that ticks should extend
beyond the plot margin.  Also affects position of axis labels, which are
plotted at the end of each tick.
Use a vector of length three to set a different length for each direction.</p>
</td></tr>
<tr><td><code id="HoldridgePlot_+3A_...">...</code></td>
<td>
<p>Additional parameters to <code><a href="graphics.html#topic+plot">plot</a></code>.</p>
</td></tr>
<tr><td><code id="HoldridgePlot_+3A_border">border</code></td>
<td>
<p>Colour to use for hexagon borders.</p>
</td></tr>
<tr><td><code id="HoldridgePlot_+3A_lty">lty</code>, <code id="HoldridgePlot_+3A_lwd">lwd</code>, <code id="HoldridgePlot_+3A_cex">cex</code>, <code id="HoldridgePlot_+3A_font">font</code></td>
<td>
<p><a href="graphics.html#topic+par">Graphical parameters</a> specifying
properties of hexagons to be plotted.</p>
</td></tr>
<tr><td><code id="HoldridgePlot_+3A_labels">labels</code></td>
<td>
<p>Vector specifying labels for life zone hexagons to be plotted.
Suggested values: <code><a href="#topic+holdridgeClassesUp">holdridgeClassesUp</a></code>, <code><a href="#topic+holdridgeLifeZonesUp">holdridgeLifeZonesUp</a></code>.</p>
</td></tr>
<tr><td><code id="HoldridgePlot_+3A_text.col">text.col</code></td>
<td>
<p>Colour of text to be printed in hexagons.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code><a href="#topic+HoldridgePoints">HoldridgePoints()</a></code>, <code><a href="#topic+HoldridgeText">HoldridgeText()</a></code> and related functions allow data
points to be added to an existing plot; <code><a href="#topic+AddToHoldridge">AddToHoldridge()</a></code> allows plotting
using any of the standard plotting functions.
</p>
<p><code><a href="#topic+HoldridgeBelts">HoldridgeBelts()</a></code> and <code><a href="#topic+HoldridgeHexagons">HoldridgeHexagons()</a></code> plot interpretative lines
and hexagons allowing plotted data to be linked to interpreted climate
settings.
</p>
<p>Please cite Tsakalos <em>et al.</em> (2023) when using this function.
</p>


<h3>Author(s)</h3>

<p><a href="https://orcid.org/0000-0001-5660-1727">Martin R. Smith</a>
(<a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a>)
</p>


<h3>References</h3>

<p>Holdridge (1947),
&quot;Determination of world plant formations from simple climatic data&quot;,
<em>Science</em> 105:367–368. <a href="https://doi.org/10.1126/science.105.2727.367">doi:10.1126/science.105.2727.367</a>
</p>
<p>Holdridge (1967), <em>Life zone ecology</em>.
Tropical Science Center, San José
</p>
<p>Tsakalos, Smith, Luebert &amp; Mucina (2023).
&quot;climenv: Download, extract and visualise climatic and elevation data.&quot;,
<em>Journal of Vegetation Science</em> 6:e13215. <a href="https://doi.org/10.1111/jvs.13215">doi:10.1111/jvs.13215</a>
</p>


<h3>See Also</h3>

<p>Other Holdridge plotting functions: 
<code><a href="#topic+AddToHoldridge">AddToHoldridge</a>()</code>,
<code><a href="#topic+HoldridgeHypsometricCol">HoldridgeHypsometricCol</a>()</code>,
<code><a href="#topic+holdridge">holdridge</a></code>,
<code><a href="#topic+holdridgeClasses">holdridgeClasses</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(holdridgeLifeZonesUp, package = "Ternary")
HoldridgePlot(hex.labels = holdridgeLifeZonesUp)
HoldridgeBelts()
</code></pre>

<hr>
<h2 id='HoldridgeToXY'>Convert user-specified ternary coordinates into X and Y coordinates</h2><span id='topic+HoldridgeToXY'></span><span id='topic+CoordinatesToXY'></span>

<h3>Description</h3>

<p>Accepts various formats of input data; extracts ternary coordinates and
converts to X and Y coordinates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>HoldridgeToXY(pet, prec)

CoordinatesToXY(coordinates)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="HoldridgeToXY_+3A_pet">pet</code>, <code id="HoldridgeToXY_+3A_prec">prec</code></td>
<td>
<p>Numeric vectors giving <em>p</em>otential <em>e</em>vapo<em>t</em>ranspiration
ratio and annual <em>prec</em>ipitation (in mm).</p>
</td></tr>
<tr><td><code id="HoldridgeToXY_+3A_coordinates">coordinates</code></td>
<td>
<p>A list, matrix, data.frame or vector in which each
element (or row) specifies
the three coordinates of a point in ternary space.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>CoordinatesToXY()</code> returns an array of two rows, corresponding to
the X and Y coordinates of <code>coordinates</code>.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>HoldridgeToXY()</code>: Convert from Holdridge coordinates
</p>
</li></ul>


<h3>Author(s)</h3>

<p><a href="https://orcid.org/0000-0001-5660-1727">Martin R. Smith</a>
(<a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a>)
</p>

<hr>
<h2 id='OutsidePlot'>Is a point in the plotting area?</h2><span id='topic+OutsidePlot'></span>

<h3>Description</h3>

<p>Evaluate whether a given set of coordinates lie outwith the boundaries of
a plotted ternary diagram.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>OutsidePlot(x, y, tolerance = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="OutsidePlot_+3A_x">x</code>, <code id="OutsidePlot_+3A_y">y</code></td>
<td>
<p>Vectors of <em>x</em> and <em>y</em> coordinates of points.</p>
</td></tr>
<tr><td><code id="OutsidePlot_+3A_tolerance">tolerance</code></td>
<td>
<p>Consider points this close to the edge of the plot to be
inside.  Set to negative values to count points that are just outside the
plot as inside, and to positive values to count points that are just inside
the margins as outside. Maximum positive value: 1/3.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>OutsidePlot()</code> returns a logical vector specifying whether each
pair of <em>x</em> and <em>y</em> coordinates corresponds to a point outside the plotted
ternary diagram.
</p>


<h3>Author(s)</h3>

<p><a href="https://orcid.org/0000-0001-5660-1727">Martin R. Smith</a>
(<a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a>)
</p>


<h3>See Also</h3>

<p>Other plot limits: 
<code><a href="#topic+TernaryXRange">TernaryXRange</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
TernaryPlot()
points(0.5, 0.5, col = "darkgreen")
OutsidePlot(0.5, 0.5)

points(0.1, 0.5, col = "red")
OutsidePlot(0.1, 0.5)

OutsidePlot(c(0.5, 0.1), 0.5)
</code></pre>

<hr>
<h2 id='Polygon-Geometry'>Polygon geometry</h2><span id='topic+Polygon-Geometry'></span><span id='topic+PolygonArea'></span><span id='topic+PolygonCentre'></span><span id='topic+PolygonCenter'></span><span id='topic+GrowPolygon'></span>

<h3>Description</h3>

<p>Geometry functions for irregular polygons.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PolygonArea(x, y = NULL, positive = TRUE)

PolygonCentre(x, y = NULL)

PolygonCenter(x, y = NULL)

GrowPolygon(x, y = NULL, buffer = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Polygon-Geometry_+3A_x">x</code>, <code id="Polygon-Geometry_+3A_y">y</code></td>
<td>
<p>Vectors containing the coordinates of the vertices of the polygon.</p>
</td></tr>
<tr><td><code id="Polygon-Geometry_+3A_positive">positive</code></td>
<td>
<p>If vertices are specified in an anticlockwise direction,
the polygon will be treated as a hole, with a negative area, unless
<code>positive</code> is set to TRUE.
Vertices specified in a clockwise sequence always yield a positive area.</p>
</td></tr>
<tr><td><code id="Polygon-Geometry_+3A_buffer">buffer</code></td>
<td>
<p>Numeric specifying distance by which to grow polygon.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>PolygonArea()</code> returns the area of the specified polygon.
</p>
<p><code>PolygonCentre()</code> returns a single-row matrix containing the
<em>x</em> and <em>y</em> coordinates of the geometric centre of the polygon.
</p>
<p><code>GrowPolygon()</code> returns coordinates of the vertices of <code>polygon</code>
after moving each vertex <code>buffer</code> away from the polygon's centre.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>PolygonArea()</code>: Calculate the area of an irregular polygon
</p>
</li>
<li> <p><code>PolygonCentre()</code>: Locate the centre of a polygon
</p>
</li>
<li> <p><code>GrowPolygon()</code>: Enlarge a polygon in all directions
</p>
</li></ul>


<h3>Author(s)</h3>

<p><a href="https://orcid.org/0000-0001-5660-1727">Martin R. Smith</a>
(<a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a>)
</p>


<h3>See Also</h3>

<p>Other tiling functions: 
<code><a href="#topic+TriangleCentres">TriangleCentres</a>()</code>,
<code><a href="#topic+TriangleInHull">TriangleInHull</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- c(-3, -1, 6, 3, -4)
y &lt;- c(-2, 4, 1, 10, 9)
plot(x, y, frame.plot = FALSE)
polygon(x, y)
PolygonArea(x, y)
points(PolygonCentre(x, y), pch = 3, cex = 2)
polygon(GrowPolygon(x, y, 1), border = "darkgreen",
        xpd = NA # Allow drawing beyond plot border
       )

# Negative values shrink the polygon
polygon(GrowPolygon(x, y, -1), border = "red")
</code></pre>

<hr>
<h2 id='ReflectedEquivalents'>Reflected equivalents of points outside the ternary plot</h2><span id='topic+ReflectedEquivalents'></span>

<h3>Description</h3>

<p>To avoid edge effects, it may be desirable to add the value of a point
within a ternary plot with the value of its 'reflection' across the nearest
axis or corner.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ReflectedEquivalents(x, y, direction = getOption("ternDirection", 1L))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ReflectedEquivalents_+3A_x">x</code>, <code id="ReflectedEquivalents_+3A_y">y</code></td>
<td>
<p>Vectors of <em>x</em> and <em>y</em> coordinates of points.</p>
</td></tr>
<tr><td><code id="ReflectedEquivalents_+3A_direction">direction</code></td>
<td>
<p>(optional) Integer specifying the direction that the
current ternary plot should point: 1, up; 2, right; 3, down; 4, left.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>ReflectedEquivalents()</code> returns a list of the <em>x</em>, <em>y</em> coordinates
of the points produced if the given point is reflected across each of the
edges or corners.
</p>


<h3>See Also</h3>

<p>Other coordinate translation functions: 
<code><a href="#topic+TernaryCoords">TernaryCoords</a>()</code>,
<code><a href="#topic+TriangleCentres">TriangleCentres</a>()</code>,
<code><a href="#topic+XYToTernary">XYToTernary</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>TernaryPlot(axis.labels = FALSE, point = 4)

xy &lt;- cbind(
  TernaryCoords(0.9, 0.08, 0.02),
  TernaryCoords(0.15, 0.8, 0.05),
  TernaryCoords(0.05, 0.1, 0.85)
)
x &lt;- xy[1, ]
y &lt;- xy[2, ]

points(x, y, col = "red", pch = 1:3)
ref &lt;- ReflectedEquivalents(x, y)
points(ref[[1]][, 1], ref[[1]][, 2], col = "blue", pch = 1)
points(ref[[2]][, 1], ref[[2]][, 2], col = "green", pch = 2)
points(ref[[3]][, 1], ref[[3]][, 2], col = "orange", pch = 3)
</code></pre>

<hr>
<h2 id='TernaryApp'>Graphical user interface for creating ternary plots</h2><span id='topic+TernaryApp'></span>

<h3>Description</h3>

<p><code>TernaryApp()</code> launches a 'Shiny' application for the construction of
ternary plots.  The 'app' allows data to be loaded and plotted, and provides
code to reproduce the plot in R should more sophisticated plotting functions
be desired.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TernaryApp()
</code></pre>


<h3>Details</h3>



<h4>Load data</h4>

<p>The 'Load data' input tab allows for the upload of datasets.
Data can be read from csv files, <code>.txt</code> files created with <code>write.table()</code>,
or (if the 'readxl' package is installed) Excel spreadsheets.
</p>
<p>Data should be provided as three columns, corresponding to the three axes
of the ternary plot.  Colours or point styles may be specified in columns
four to six to allow different categories of point to be plotted distinctly.
Example datasets are installed at
<code>system.file("TernaryApp", package = "Ternary")</code>.
</p>
<p>Axes are automatically labelled using column names, if present; these can be
edited manually on this tab.
</p>



<h4>Plot display</h4>

<p>Allows the orientation, colour and configuration of the plot and its axes
to be adjusted,
</p>



<h4>Grids</h4>

<p>Adjust the number, spacing and styling of major and minor grid lines.
</p>



<h4>Labels</h4>

<p>Configure the colour, position and size of tip and axis labels.
</p>



<h4>Points</h4>

<p>Choose whether to plot points, lines, connected points, or text.
Set the style of points and lines.
</p>



<h3>Exporting plots</h3>

<p>A plot can be saved to PDF or as a PNG bitmap at a specified size.
Alternatively, R script that will generate the displayed plot can be viewed
(using the 'R code' output tab) or downloaded to file.
</p>


<h3>Author(s)</h3>

<p><a href="https://orcid.org/0000-0001-5660-1727">Martin R. Smith</a>
(<a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a>)
</p>


<h3>References</h3>

<p>If you use figures produced with this package in a publication, please cite
</p>
<p>Smith, Martin R. (2017). <em>Ternary: An R Package for Creating Ternary Plots.</em>
Zenodo, doi: <a href="https://doi.org/10.5281/zenodo.1068996">doi:10.5281/zenodo.1068996</a>.
</p>


<h3>See Also</h3>

<p>Full detail of plotting with 'Ternary', including features not (yet)
implemented in the application, is provided in the accompanying
<a href="https://ms609.github.io/Ternary/articles/Ternary.html">vignette</a>.
</p>

<hr>
<h2 id='TernaryContour'>Add contours to a ternary plot</h2><span id='topic+TernaryContour'></span>

<h3>Description</h3>

<p>Draws contour lines to depict the value of a function in ternary space.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TernaryContour(
  Func,
  resolution = 96L,
  direction = getOption("ternDirection", 1L),
  region = getOption("ternRegion", ternRegionDefault),
  within = NULL,
  filled = FALSE,
  legend,
  legend... = list(),
  nlevels = 10,
  levels = pretty(zlim, nlevels),
  zlim,
  color.palette = function(n) hcl.colors(n, palette = "viridis", alpha = 0.6),
  fill.col = color.palette(length(levels) - 1),
  func... = list(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="TernaryContour_+3A_func">Func</code></td>
<td>
<p>Function taking vectors of coordinates <code>a</code>, <code>b</code> and <code>c</code>, which
returns a numeric vector whose value at each coordinate will be depicted.</p>
</td></tr>
<tr><td><code id="TernaryContour_+3A_resolution">resolution</code></td>
<td>
<p>The number of triangles whose base should lie on the longest
axis of the triangle.  Higher numbers will result in smaller subdivisions and smoother
colour gradients, but at a computational cost.</p>
</td></tr>
<tr><td><code id="TernaryContour_+3A_direction">direction</code></td>
<td>
<p>(optional) Integer specifying the direction that the
current ternary plot should point: 1, up; 2, right; 3, down; 4, left.</p>
</td></tr>
<tr><td><code id="TernaryContour_+3A_region">region</code></td>
<td>
<p>(optional) Named list of length two specifying the the
<code>min</code>imum and <code>max</code>imum values of each ternary axis to be drawn
(e.g. <code style="white-space: pre;">&#8288;list(min = c(40, 0, 0), max = c(100, 60, 60)&#8288;</code>);
or a set of coordinates in a format accepted by <code><a href="#topic+TernaryPoints">TernaryPoints()</a></code>.
The plotted region will correspond to the smallest equilateral triangle
that encompasses the specified ranges or coordinates.</p>
</td></tr>
<tr><td><code id="TernaryContour_+3A_within">within</code></td>
<td>
<p>List or matrix of <em>x, y</em> coordinates within which contours
should be evaluated, in any format supported by
<code><a href="grDevices.html#topic+xy.coords">xy.coords(x = within)</a></code>.
If <code>NULL</code>, defaults to a region slightly smaller than the ternary plot.
The <code style="white-space: pre;">&#8288;$hull&#8288;</code> entry generated by <code>TriangleInHull()</code> may also be used.</p>
</td></tr>
<tr><td><code id="TernaryContour_+3A_filled">filled</code></td>
<td>
<p>Logical; if <code>TRUE</code>, contours will be filled
(using <code><a href="graphics.html#topic+.filled.contour">.filled.contour</a>()</code>.).</p>
</td></tr>
<tr><td><code id="TernaryContour_+3A_legend">legend</code></td>
<td>
<p>Character vector specifying annotations for colour scale.
If not provided, no colour legend is displayed.
Specify <code>TRUE</code> to generate automatically, or a single integer to generate
<code>legend</code> annotations.</p>
</td></tr>
<tr><td><code id="TernaryContour_+3A_legend...">legend...</code></td>
<td>
<p>List of additional parameters to send to
<code><a href="PlotTools.html#topic+SpectrumLegend">SpectrumLegend()</a></code>.</p>
</td></tr>
<tr><td><code id="TernaryContour_+3A_nlevels">nlevels</code>, <code id="TernaryContour_+3A_levels">levels</code>, <code id="TernaryContour_+3A_zlim">zlim</code>, <code id="TernaryContour_+3A_...">...</code></td>
<td>
<p>parameters to pass to
<code><a href="graphics.html#topic+contour">contour</a>()</code>.</p>
</td></tr>
<tr><td><code id="TernaryContour_+3A_color.palette">color.palette</code></td>
<td>
<p>parameters to pass to
<code><a href="graphics.html#topic+.filled.contour">.filled.contour</a>()</code>.</p>
</td></tr>
<tr><td><code id="TernaryContour_+3A_fill.col">fill.col</code></td>
<td>
<p>Sent as <code>col</code> parameter to
<code><a href="graphics.html#topic+.filled.contour">.filled.contour</a>()</code>.
Computed from <code>color.palette</code> if not specified.</p>
</td></tr>
<tr><td><code id="TernaryContour_+3A_func...">func...</code></td>
<td>
<p>List of additional parameters to send to <code>Func()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>TernaryContour()</code>  invisibly returns a list containing:
</p>

<ul>
<li> <p><code>x</code>,<code>y</code>: the Cartesian coordinates of each evaluated point;
</p>
</li>
<li> <p><code>z</code>: The value of <code>Func()</code> at each coordinate.
</p>
</li></ul>



<h3>Author(s)</h3>

<p><a href="https://orcid.org/0000-0001-5660-1727">Martin R. Smith</a>
(<a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a>)
</p>


<h3>See Also</h3>

<p>Other contour plotting functions: 
<code><a href="#topic+ColourTernary">ColourTernary</a>()</code>,
<code><a href="#topic+TernaryDensityContour">TernaryDensityContour</a>()</code>,
<code><a href="#topic+TernaryPointValues">TernaryPointValues</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>FunctionToContour &lt;- function (a, b, c) {
  a - c + (4 * a * b) + (27 * a * b * c)
}

# Set up plot
originalPar &lt;- par(mar = rep(0, 4))
TernaryPlot(alab = "a", blab = "b", clab = "c")
values &lt;- TernaryPointValues(FunctionToContour, resolution = 24L)
ColourTernary(
  values,
  legend = signif(seq(max(values), min(values), length.out = 4), 2),
  bty = "n"
)
TernaryContour(FunctionToContour, resolution = 36L)

# Note that FunctionToContour is sent a vector.
# Instead of
BadMax &lt;- function (a, b, c) {
  max(a, b, c)
}

# Use
GoodMax &lt;- function (a, b, c) {
  pmax(a, b, c)
}
TernaryPlot(alab = "a", blab = "b", clab = "c")
ColourTernary(TernaryPointValues(GoodMax))
TernaryContour(GoodMax)

# Or, for a generalizable example,
GeneralMax &lt;- function (a, b, c) {
  apply(rbind(a, b, c), 2, max)
}
TernaryPlot(alab = "a", blab = "b", clab = "c")
# Fill the contour areas, rather than using tiles
TernaryContour(GeneralMax, filled = TRUE,
               legend = c("Max", "...", "Min"), legend... = list(bty = "n"),
               fill.col =  hcl.colors(14, palette = "viridis", alpha = 0.6))
# Re-draw edges of plot triangle over fill
TernaryPolygon(diag(3))

# Restore plotting parameters
par(originalPar)
</code></pre>

<hr>
<h2 id='TernaryCoords'>Convert ternary coordinates to Cartesian space</h2><span id='topic+TernaryCoords'></span><span id='topic+TernaryToXY.matrix'></span><span id='topic+TernaryToXY.numeric'></span><span id='topic+TernaryToXY'></span>

<h3>Description</h3>

<p>Convert coordinates of a point in ternary space, in the format
(<em>a</em>, <em>b</em>, <em>c</em>), to <em>x</em> and <em>y</em> coordinates of Cartesian space, which can be
sent to standard functions in the 'graphics' package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TernaryCoords(
  abc,
  b_coord = NULL,
  c_coord = NULL,
  direction = getOption("ternDirection", 1L),
  region = getOption("ternRegion", ternRegionDefault)
)

## S3 method for class 'matrix'
TernaryToXY(
  abc,
  b_coord = NULL,
  c_coord = NULL,
  direction = getOption("ternDirection", 1L),
  region = getOption("ternRegion", ternRegionDefault)
)

## S3 method for class 'numeric'
TernaryToXY(
  abc,
  b_coord = NULL,
  c_coord = NULL,
  direction = getOption("ternDirection", 1L),
  region = getOption("ternRegion", ternRegionDefault)
)

TernaryToXY(
  abc,
  b_coord = NULL,
  c_coord = NULL,
  direction = getOption("ternDirection", 1L),
  region = getOption("ternRegion", ternRegionDefault)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="TernaryCoords_+3A_abc">abc</code></td>
<td>
<p>A vector of length three giving the position on a ternary plot
that points in the direction specified by <code>direction</code> (1 = up, 2 = right,
3 = down, 4 = left). <code>c(100, 0, 0)</code> will plot in the <code>direction</code>-most
corner; <code>c(0, 100, 0)</code> will plot in the corner clockwise of <code>direction</code>;
<code>c(0, 0, 100)</code> will plot in the corner anti-clockwise of <code>direction</code>.
Alternatively, the a coordinate can be specified as the first parameter,
in which case the b and c coordinates must be specified via <code>b_coord</code>
and <code>c_coord</code>.
Or, a matrix with three rows, representing in turn the <code>a</code>, <code>b</code> and <code>c</code>
coordinates of points.</p>
</td></tr>
<tr><td><code id="TernaryCoords_+3A_b_coord">b_coord</code></td>
<td>
<p>The b coordinate, if <code>abc</code> is a single number.</p>
</td></tr>
<tr><td><code id="TernaryCoords_+3A_c_coord">c_coord</code></td>
<td>
<p>The c coordinate, if <code>abc</code> is a single number.</p>
</td></tr>
<tr><td><code id="TernaryCoords_+3A_direction">direction</code></td>
<td>
<p>(optional) Integer specifying the direction that the
current ternary plot should point: 1, up; 2, right; 3, down; 4, left.</p>
</td></tr>
<tr><td><code id="TernaryCoords_+3A_region">region</code></td>
<td>
<p>(optional) Named list of length two specifying the the
<code>min</code>imum and <code>max</code>imum values of each ternary axis to be drawn
(e.g. <code style="white-space: pre;">&#8288;list(min = c(40, 0, 0), max = c(100, 60, 60)&#8288;</code>);
or a set of coordinates in a format accepted by <code><a href="#topic+TernaryPoints">TernaryPoints()</a></code>.
The plotted region will correspond to the smallest equilateral triangle
that encompasses the specified ranges or coordinates.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>TernaryCoords()</code> returns a vector of length two that converts
the coordinates given in <code>abc</code> into Cartesian (<em>x</em>, <em>y</em>) coordinates
corresponding to the plot created by the last call of <code><a href="#topic+TernaryPlot">TernaryPlot()</a></code>.
</p>


<h3>Author(s)</h3>

<p><a href="https://orcid.org/0000-0001-5660-1727">Martin R. Smith</a>
(<a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a>)
</p>


<h3>See Also</h3>


<ul>
<li> <p><code><a href="#topic+TernaryPlot">TernaryPlot()</a></code>
</p>
</li></ul>

<p>Other coordinate translation functions: 
<code><a href="#topic+ReflectedEquivalents">ReflectedEquivalents</a>()</code>,
<code><a href="#topic+TriangleCentres">TriangleCentres</a>()</code>,
<code><a href="#topic+XYToTernary">XYToTernary</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>TernaryCoords(100, 0, 0)
TernaryCoords(c(0, 100, 0))

coords &lt;- matrix(1:12, nrow = 3)
TernaryToXY(coords)
</code></pre>

<hr>
<h2 id='TernaryDensityContour'>Add contours of estimated point density to a ternary plot</h2><span id='topic+TernaryDensityContour'></span>

<h3>Description</h3>

<p>Use two-dimensional kernel density estimation to plot contours of
point density.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TernaryDensityContour(
  coordinates,
  bandwidth,
  resolution = 25L,
  tolerance = -0.2/resolution,
  edgeCorrection = TRUE,
  direction = getOption("ternDirection", 1L),
  filled = FALSE,
  nlevels = 10,
  levels = pretty(zlim, nlevels),
  zlim,
  color.palette = function(n) hcl.colors(n, palette = "viridis", alpha = 0.6),
  fill.col = color.palette(length(levels) - 1),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="TernaryDensityContour_+3A_coordinates">coordinates</code></td>
<td>
<p>A list, matrix, data.frame or vector in which each
element (or row) specifies
the three coordinates of a point in ternary space.</p>
</td></tr>
<tr><td><code id="TernaryDensityContour_+3A_bandwidth">bandwidth</code></td>
<td>
<p>Vector of bandwidths for x and y directions.
Defaults to normal reference bandwidth (see <code>MASS::bandwidth.nrd</code>).
A scalar value will be taken to apply to both directions.</p>
</td></tr>
<tr><td><code id="TernaryDensityContour_+3A_resolution">resolution</code></td>
<td>
<p>The number of triangles whose base should lie on the longest
axis of the triangle.  Higher numbers will result in smaller subdivisions and smoother
colour gradients, but at a computational cost.</p>
</td></tr>
<tr><td><code id="TernaryDensityContour_+3A_tolerance">tolerance</code></td>
<td>
<p>Numeric specifying how close to the margins the contours
should be plotted, as a fraction of the size of the triangle.
Negative values will cause contour lines to extend beyond the margins of the
plot.</p>
</td></tr>
<tr><td><code id="TernaryDensityContour_+3A_edgecorrection">edgeCorrection</code></td>
<td>
<p>Logical specifying whether to correct for edge effects
(see details).</p>
</td></tr>
<tr><td><code id="TernaryDensityContour_+3A_direction">direction</code></td>
<td>
<p>(optional) Integer specifying the direction that the
current ternary plot should point: 1, up; 2, right; 3, down; 4, left.</p>
</td></tr>
<tr><td><code id="TernaryDensityContour_+3A_filled">filled</code></td>
<td>
<p>Logical; if <code>TRUE</code>, contours will be filled
(using <code><a href="graphics.html#topic+.filled.contour">.filled.contour</a>()</code>.).</p>
</td></tr>
<tr><td><code id="TernaryDensityContour_+3A_nlevels">nlevels</code>, <code id="TernaryDensityContour_+3A_levels">levels</code>, <code id="TernaryDensityContour_+3A_zlim">zlim</code>, <code id="TernaryDensityContour_+3A_...">...</code></td>
<td>
<p>parameters to pass to
<code><a href="graphics.html#topic+contour">contour</a>()</code>.</p>
</td></tr>
<tr><td><code id="TernaryDensityContour_+3A_color.palette">color.palette</code></td>
<td>
<p>parameters to pass to
<code><a href="graphics.html#topic+.filled.contour">.filled.contour</a>()</code>.</p>
</td></tr>
<tr><td><code id="TernaryDensityContour_+3A_fill.col">fill.col</code></td>
<td>
<p>Sent as <code>col</code> parameter to
<code><a href="graphics.html#topic+.filled.contour">.filled.contour</a>()</code>.
Computed from <code>color.palette</code> if not specified.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is modelled on <code>MASS::kde2d()</code>, which uses
&quot;an axis-aligned bivariate normal kernel, evaluated on a square grid&quot;.
</p>
<p>This is to say, values are calculated on a square grid, and contours fitted
between these points.  This produces a couple of artefacts.
Firstly, contours may not extend beyond the outermost point within the
diagram, which may fall some distance from the margin of the plot if a
low <code>resolution</code> is used.  Setting a negative <code>tolerance</code> parameter allows
these contours to extend closer to (or beyond) the margin of the plot.
</p>
<p>Individual points cannot fall outside the margins of the ternary diagram,
but their associated kernels can. In order to sample regions of the kernels
that have &quot;bled&quot; outside the ternary diagram, each point's value is
calculated by summing the point density at that point and at equivalent
points outside the ternary diagram, &quot;reflected&quot; across the margin of
the plot (see function <code><a href="#topic+ReflectedEquivalents">ReflectedEquivalents</a></code>).  This correction can be
disabled by setting the <code>edgeCorrection</code> parameter to <code>FALSE</code>.
</p>
<p>A model based on a triangular grid may be more appropriate in certain
situations, but is non-trivial to implement; if this distinction is
important to you, please let the maintainers known by opening a
<a href="https://github.com/ms609/Ternary/issues/new?title=Triangular+KDE">Github issue</a>.
</p>


<h3>Value</h3>

<p><code>TernaryDensityContour()</code> invisibly returns a list containing:
</p>

<ul>
<li> <p><code>x</code>,<code>y</code>: the Cartesian coordinates of each grid coordinate;
</p>
</li>
<li> <p><code>z</code>: The density at each grid coordinate.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Adapted from <code>MASS::kde2d()</code> by Martin R. Smith
</p>


<h3>See Also</h3>

<p>Other contour plotting functions: 
<code><a href="#topic+ColourTernary">ColourTernary</a>()</code>,
<code><a href="#topic+TernaryContour">TernaryContour</a>()</code>,
<code><a href="#topic+TernaryPointValues">TernaryPointValues</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate some example data
nPoints &lt;- 400L
coordinates &lt;- cbind(abs(rnorm(nPoints, 2, 3)),
                     abs(rnorm(nPoints, 1, 1.5)),
                     abs(rnorm(nPoints, 1, 0.5)))
# Set up plot
oPar &lt;- par(mar = rep(0, 4))
TernaryPlot(axis.labels = seq(0, 10, by = 1))

# Colour background by density
ColourTernary(TernaryDensity(coordinates, resolution = 10L),
              legend = TRUE, bty = "n", title = "Density")

# Plot points
TernaryPoints(coordinates, col = "red", pch = ".")

# Contour by density
TernaryDensityContour(coordinates, resolution = 30L)

# Reset plotting parameters
par(oPar)
</code></pre>

<hr>
<h2 id='TernaryPlot'>Create a ternary plot</h2><span id='topic+TernaryPlot'></span><span id='topic+HorizontalGrid'></span>

<h3>Description</h3>

<p>Create and style a blank ternary plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TernaryPlot(
  atip = NULL,
  btip = NULL,
  ctip = NULL,
  alab = NULL,
  blab = NULL,
  clab = NULL,
  lab.offset = 0.16,
  lab.col = NULL,
  point = "up",
  clockwise = TRUE,
  xlim = NULL,
  ylim = NULL,
  region = ternRegionDefault,
  lab.cex = 1,
  lab.font = 0,
  tip.cex = lab.cex,
  tip.font = 2,
  tip.col = "black",
  isometric = TRUE,
  atip.rotate = NULL,
  btip.rotate = NULL,
  ctip.rotate = NULL,
  atip.pos = NULL,
  btip.pos = NULL,
  ctip.pos = NULL,
  padding = 0.08,
  col = NA,
  panel.first = NULL,
  panel.last = NULL,
  grid.lines = 10,
  grid.col = "darkgrey",
  grid.lty = "solid",
  grid.lwd = par("lwd"),
  grid.minor.lines = 4,
  grid.minor.col = "lightgrey",
  grid.minor.lty = "solid",
  grid.minor.lwd = par("lwd"),
  axis.lty = "solid",
  axis.labels = TRUE,
  axis.cex = 0.8,
  axis.font = par("font"),
  axis.rotate = TRUE,
  axis.pos = NULL,
  axis.tick = TRUE,
  axis.lwd = 1,
  ticks.lwd = axis.lwd,
  ticks.length = 0.025,
  axis.col = "black",
  ticks.col = grid.col,
  ...
)

HorizontalGrid(
  grid.lines = 10,
  grid.col = "grey",
  grid.lty = "dotted",
  grid.lwd = par("lwd"),
  direction = getOption("ternDirection", 1L)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="TernaryPlot_+3A_atip">atip</code>, <code id="TernaryPlot_+3A_btip">btip</code>, <code id="TernaryPlot_+3A_ctip">ctip</code></td>
<td>
<p>Character string specifying text to title corners,
proceeding clockwise from the corner specified in <code>point</code> (default: top).</p>
</td></tr>
<tr><td><code id="TernaryPlot_+3A_alab">alab</code>, <code id="TernaryPlot_+3A_blab">blab</code>, <code id="TernaryPlot_+3A_clab">clab</code></td>
<td>
<p>Character string specifying text with which to label
the corresponding sides of the triangle.
Left or right-pointing arrows are produced by
typing <code style="white-space: pre;">&#8288;\\U2190&#8288;</code> or <code style="white-space: pre;">&#8288;\\U2192&#8288;</code>, or using <code>expression('value' %-&gt;% '')</code>.</p>
</td></tr>
<tr><td><code id="TernaryPlot_+3A_lab.offset">lab.offset</code></td>
<td>
<p>Numeric specifying distance between midpoint of axis label
and the axis. The default value is given in the 'Usage' section; a value
of <code>0</code> will position the axis label directly on the axis.
Increase <code>padding</code> if labels are being clipped.
Use a vector of length three to specify a different offset for each label.</p>
</td></tr>
<tr><td><code id="TernaryPlot_+3A_lab.col">lab.col</code></td>
<td>
<p>Character vector specifying colours for axis labels. Use a
vector of length three to specify a different colour for each label.</p>
</td></tr>
<tr><td><code id="TernaryPlot_+3A_point">point</code></td>
<td>
<p>Character string specifying the orientation of the ternary plot:
should the triangle point <code>"up"</code>, <code>"right"</code>, <code>"down"</code> or <code>"left"</code>?
The integers 1 to 4 can be used in place of the character strings.</p>
</td></tr>
<tr><td><code id="TernaryPlot_+3A_clockwise">clockwise</code></td>
<td>
<p>Logical specifying the direction of axes.  If <code>TRUE</code> (the
default), each axis runs from zero to its maximum value in a clockwise
direction around the plot.</p>
</td></tr>
<tr><td><code id="TernaryPlot_+3A_xlim">xlim</code>, <code id="TernaryPlot_+3A_ylim">ylim</code></td>
<td>
<p>Numeric vectors of length two specifying the minimum and
maximum <em>x</em> and <em>y</em> limits of the plotted area, to which <code>padding</code> will be
added.
The default is to display the complete height or width of the plot.
Allows cropping to magnified region of the plot. (See vignette for diagram.)
May be overridden if <code>isometric = TRUE</code>; see documentation of
<code>isometric</code> parameter.</p>
</td></tr>
<tr><td><code id="TernaryPlot_+3A_region">region</code></td>
<td>
<p>(optional) Named list of length two specifying the the
<code>min</code>imum and <code>max</code>imum values of each ternary axis to be drawn
(e.g. <code style="white-space: pre;">&#8288;list(min = c(40, 0, 0), max = c(100, 60, 60)&#8288;</code>);
or a set of coordinates in a format accepted by <code><a href="#topic+TernaryPoints">TernaryPoints()</a></code>.
The plotted region will correspond to the smallest equilateral triangle
that encompasses the specified ranges or coordinates.</p>
</td></tr>
<tr><td><code id="TernaryPlot_+3A_lab.cex">lab.cex</code>, <code id="TernaryPlot_+3A_tip.cex">tip.cex</code></td>
<td>
<p>Numeric specifying character expansion (font size)
for axis labels.
Use a vector of length three to specify a different value for each direction.</p>
</td></tr>
<tr><td><code id="TernaryPlot_+3A_lab.font">lab.font</code>, <code id="TernaryPlot_+3A_tip.font">tip.font</code></td>
<td>
<p>Numeric specifying font style (Roman, bold, italic,
bold-italic) for axis titles.
Use a vector of length three to set a different font for each direction.</p>
</td></tr>
<tr><td><code id="TernaryPlot_+3A_isometric">isometric</code></td>
<td>
<p>Logical specifying whether to enforce an equilateral shape
for the ternary plot.
If only one of <code>xlim</code> and <code>ylim</code> is set, the other will be calculated to
maintain an equilateral plot.
If both <code>xlim</code> and <code>ylim</code> are set, but have different ranges, then the limit
with the smaller range will be scaled until its range matches that of the
other limit.</p>
</td></tr>
<tr><td><code id="TernaryPlot_+3A_atip.rotate">atip.rotate</code>, <code id="TernaryPlot_+3A_btip.rotate">btip.rotate</code>, <code id="TernaryPlot_+3A_ctip.rotate">ctip.rotate</code></td>
<td>
<p>Integer specifying number of
degrees to rotate label of rightmost apex.</p>
</td></tr>
<tr><td><code id="TernaryPlot_+3A_atip.pos">atip.pos</code>, <code id="TernaryPlot_+3A_btip.pos">btip.pos</code>, <code id="TernaryPlot_+3A_ctip.pos">ctip.pos</code></td>
<td>
<p>Integer specifying positioning of labels,
iff the corresponding <code>xtip.rotate</code> parameter is set.</p>
</td></tr>
<tr><td><code id="TernaryPlot_+3A_padding">padding</code></td>
<td>
<p>Numeric specifying size of internal margin of the plot;
increase if axis labels are being clipped.</p>
</td></tr>
<tr><td><code id="TernaryPlot_+3A_col">col</code></td>
<td>
<p>The colour for filling the plot; see
<code><a href="graphics.html#topic+polygon">polygon</a></code>.</p>
</td></tr>
<tr><td><code id="TernaryPlot_+3A_panel.first">panel.first</code></td>
<td>
<p>An expression to be evaluated after the plot axes are
set up but before any plotting takes place.
This can be useful for drawing backgrounds, e.g. with <code><a href="#topic+ColourTernary">ColourTernary()</a></code>
or <code><a href="#topic+HorizontalGrid">HorizontalGrid()</a></code>.
Note that this works by lazy evaluation: passing this argument from other
plot methods may well not work since it may be evaluated too early.</p>
</td></tr>
<tr><td><code id="TernaryPlot_+3A_panel.last">panel.last</code></td>
<td>
<p>An expression to be evaluated after plotting has taken
place but before the axes and box are added.  See the comments about
<code>panel.first</code>.</p>
</td></tr>
<tr><td><code id="TernaryPlot_+3A_grid.lines">grid.lines</code></td>
<td>
<p>Integer specifying the number of grid lines to plot.
If <code>axis.labels = TRUE</code>, this will be used as a hint to <code>pretty()</code>.</p>
</td></tr>
<tr><td><code id="TernaryPlot_+3A_grid.col">grid.col</code>, <code id="TernaryPlot_+3A_grid.minor.col">grid.minor.col</code></td>
<td>
<p>Colours to draw the grid lines. Use a vector
of length three to set different values for each direction.</p>
</td></tr>
<tr><td><code id="TernaryPlot_+3A_grid.lty">grid.lty</code>, <code id="TernaryPlot_+3A_grid.minor.lty">grid.minor.lty</code></td>
<td>
<p>Character or integer vector; line type of
the grid lines. Use a vector of length three to set different values for
each direction.</p>
</td></tr>
<tr><td><code id="TernaryPlot_+3A_grid.lwd">grid.lwd</code>, <code id="TernaryPlot_+3A_grid.minor.lwd">grid.minor.lwd</code></td>
<td>
<p>Non-negative numeric giving line width of the
grid lines.  Use a vector of length three to set different values for each
direction.</p>
</td></tr>
<tr><td><code id="TernaryPlot_+3A_grid.minor.lines">grid.minor.lines</code></td>
<td>
<p>Integer specifying the number of minor (unlabelled)
grid lines to plot between each major pair.</p>
</td></tr>
<tr><td><code id="TernaryPlot_+3A_axis.lty">axis.lty</code></td>
<td>
<p>Line type for both the axis line and tick marks.
Use a vector of length three to set a different value for each direction.</p>
</td></tr>
<tr><td><code id="TernaryPlot_+3A_axis.labels">axis.labels</code></td>
<td>
<p>This can either be a logical value specifying whether
(numerical) annotations are to be made at the tickmarks, or a character or
expression vector of labels to be placed at the tick points,
or a list of length three, with each entry specifying labels to be placed
on each axis in turn.</p>
</td></tr>
<tr><td><code id="TernaryPlot_+3A_axis.cex">axis.cex</code></td>
<td>
<p>Numeric specifying character expansion (font size)
for axis labels.
Use a vector of length three to set a different value for each direction.</p>
</td></tr>
<tr><td><code id="TernaryPlot_+3A_axis.font">axis.font</code></td>
<td>
<p>Font for text. Defaults to <code>par('font')</code>.</p>
</td></tr>
<tr><td><code id="TernaryPlot_+3A_axis.rotate">axis.rotate</code></td>
<td>
<p>Logical specifying whether to rotate axis labels
to parallel grid lines, or numeric specifying custom rotation for each axis,
to be passed as <code>srt</code> parameter to <code>text()</code>.  Expand margins or set
<code>par(xpd = NA)</code> if labels are clipped.</p>
</td></tr>
<tr><td><code id="TernaryPlot_+3A_axis.pos">axis.pos</code></td>
<td>
<p>Vector of length one or three specifying position of axis
labels, to be passed as <code>pos</code> parameter to <code>text()</code>; populated automatically
if <code>NULL</code> (the default).</p>
</td></tr>
<tr><td><code id="TernaryPlot_+3A_axis.tick">axis.tick</code></td>
<td>
<p>Logical specifying whether to mark the axes with tick marks.</p>
</td></tr>
<tr><td><code id="TernaryPlot_+3A_axis.lwd">axis.lwd</code>, <code id="TernaryPlot_+3A_ticks.lwd">ticks.lwd</code></td>
<td>
<p>Line width for the axis line and tick marks.
Zero or negative values will suppress the line or ticks.
Use a vector of length three to set different values for each axis.</p>
</td></tr>
<tr><td><code id="TernaryPlot_+3A_ticks.length">ticks.length</code></td>
<td>
<p>Numeric specifying distance that ticks should extend
beyond the plot margin.  Also affects position of axis labels, which are
plotted at the end of each tick.
Use a vector of length three to set a different length for each direction.</p>
</td></tr>
<tr><td><code id="TernaryPlot_+3A_axis.col">axis.col</code>, <code id="TernaryPlot_+3A_ticks.col">ticks.col</code>, <code id="TernaryPlot_+3A_tip.col">tip.col</code></td>
<td>
<p>Colours for the axis line,
tick marks and tip labels respectively.
Use a vector of length three to set a different value for each direction.
<code>axis.col = NULL</code> means to use <code>par('fg')</code>, possibly specified
inline, and <code>ticks.col = NULL</code> means to use whatever colour
<code>axis.col</code> resolved to.</p>
</td></tr>
<tr><td><code id="TernaryPlot_+3A_...">...</code></td>
<td>
<p>Additional parameters to <code><a href="graphics.html#topic+plot">plot</a></code>.</p>
</td></tr>
<tr><td><code id="TernaryPlot_+3A_direction">direction</code></td>
<td>
<p>(optional) Integer specifying the direction that the
current ternary plot should point: 1, up; 2, right; 3, down; 4, left.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The plot will be generated using the standard 'graphics' plot functions, on
which additional elements can be added using cartesian coordinates, perhaps
using functions such as <code><a href="graphics.html#topic+arrows">arrows</a></code>,
<code><a href="graphics.html#topic+legend">legend</a></code> or <code><a href="graphics.html#topic+text">text</a></code>.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>HorizontalGrid()</code>: Add <code>grid.lines</code> horizontal lines to the ternary plot
</p>
</li></ul>


<h3>Author(s)</h3>

<p><a href="https://orcid.org/0000-0001-5660-1727">Martin R. Smith</a>
(<a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a>)
</p>


<h3>See Also</h3>


<ul>
<li> <p><code><a href="#topic+AddToTernary">AddToTernary()</a></code>: Add elements to a ternary plot
</p>
</li>
<li> <p><code><a href="#topic+TernaryCoords">TernaryCoords()</a></code>: Convert ternary coordinates to Cartesian
(<em>x</em> and <em>y</em>) coordinates
</p>
</li>
<li> <p><code><a href="#topic+TernaryXRange">TernaryXRange()</a></code>, <code><a href="#topic+TernaryYRange">TernaryYRange()</a></code>: What are the <em>x</em> and <em>y</em> limits
of the plotted region?
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>TernaryPlot(
  atip = "Top", btip = "Bottom", ctip = "Right", axis.col = "red",
  col = rgb(0.8, 0.8, 0.8)
)
HorizontalGrid(grid.lines = 2, grid.col = "blue", grid.lty = 1)
# the second line corresponds to the base of the triangle, and is not drawn
</code></pre>

<hr>
<h2 id='TernaryPointValues'>Value of a function at regularly spaced points</h2><span id='topic+TernaryPointValues'></span><span id='topic+TernaryDensity'></span>

<h3>Description</h3>

<p>Intended to facilitate coloured contour plots with <code><a href="#topic+ColourTernary">ColourTernary()</a></code>,
<code>TernaryPointValue()</code> evaluates a function at points on a triangular grid;
<code>TernaryDensity()</code> calculates the density of points in each grid cell.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TernaryPointValues(
  Func,
  resolution = 48L,
  direction = getOption("ternDirection", 1L),
  ...
)

TernaryDensity(
  coordinates,
  resolution = 48L,
  direction = getOption("ternDirection", 1L)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="TernaryPointValues_+3A_func">Func</code></td>
<td>
<p>Function taking vectors of coordinates <code>a</code>, <code>b</code> and <code>c</code>, which
returns a numeric vector whose value at each coordinate will be depicted.</p>
</td></tr>
<tr><td><code id="TernaryPointValues_+3A_resolution">resolution</code></td>
<td>
<p>The number of triangles whose base should lie on the longest
axis of the triangle.  Higher numbers will result in smaller subdivisions and smoother
colour gradients, but at a computational cost.</p>
</td></tr>
<tr><td><code id="TernaryPointValues_+3A_direction">direction</code></td>
<td>
<p>(optional) Integer specifying the direction that the
current ternary plot should point: 1, up; 2, right; 3, down; 4, left.</p>
</td></tr>
<tr><td><code id="TernaryPointValues_+3A_...">...</code></td>
<td>
<p>Additional parameters to <code>Func()</code>.</p>
</td></tr>
<tr><td><code id="TernaryPointValues_+3A_coordinates">coordinates</code></td>
<td>
<p>A list, matrix, data.frame or vector in which each
element (or row) specifies
the three coordinates of a point in ternary space.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>TernaryPointValues()</code> returns a matrix whose rows correspond to:
</p>

<ul>
<li> <p><strong>x</strong>, <strong>y</strong>: co-ordinates of the centres of smaller triangles
</p>
</li>
<li> <p><strong>z</strong>: The value of <code>Func(a, b, c, ...)</code>, where <code>a</code>, <code>b</code> and <code>c</code> are the
ternary coordinates of <code>x</code> and <code>y</code>.
</p>
</li>
<li> <p><strong>down</strong>: <code>0</code> if the triangle concerned points upwards (or right),
<code>1</code> otherwise
</p>
</li></ul>



<h3>Author(s)</h3>

<p><a href="https://orcid.org/0000-0001-5660-1727">Martin R. Smith</a>
(<a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a>)
</p>


<h3>See Also</h3>

<p>Other contour plotting functions: 
<code><a href="#topic+ColourTernary">ColourTernary</a>()</code>,
<code><a href="#topic+TernaryContour">TernaryContour</a>()</code>,
<code><a href="#topic+TernaryDensityContour">TernaryDensityContour</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>TernaryPointValues(function (a, b, c) a * b * c, resolution = 2)

TernaryPlot(grid.lines = 4)
cols &lt;- TernaryPointValues(rgb, resolution = 4)
text(as.numeric(cols["x", ]), as.numeric(cols["y", ]),
     labels =  ifelse(cols["down", ] == "1", "v", "^"),
     col = cols["z", ])

TernaryPlot(axis.labels = seq(0, 10, by = 1))

nPoints &lt;- 4000L
coordinates &lt;- cbind(abs(rnorm(nPoints, 2, 3)),
                     abs(rnorm(nPoints, 1, 1.5)),
                     abs(rnorm(nPoints, 1, 0.5)))

density &lt;- TernaryDensity(coordinates, resolution = 10L)
ColourTernary(density, legend = TRUE, bty = "n", title = "Density")
TernaryPoints(coordinates, col = "red", pch = ".")
</code></pre>

<hr>
<h2 id='TernaryTiles'>Paint tiles on ternary plot</h2><span id='topic+TernaryTiles'></span><span id='topic+TernaryUpTiles'></span><span id='topic+TernaryDownTiles'></span><span id='topic+TernaryLeftTiles'></span><span id='topic+TernaryRightTiles'></span>

<h3>Description</h3>

<p>Function to fill a ternary plot with coloured tiles.  Useful in combination with
<code><a href="#topic+TernaryPointValues">TernaryPointValues</a></code> and <code><a href="#topic+TernaryContour">TernaryContour</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TernaryTiles(
  x,
  y,
  down,
  resolution,
  col,
  direction = getOption("ternDirection", 1L)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="TernaryTiles_+3A_x">x</code>, <code id="TernaryTiles_+3A_y">y</code></td>
<td>
<p>Numeric vectors specifying <em>x</em> and <em>y</em> coordinates of centres of each triangle.</p>
</td></tr>
<tr><td><code id="TernaryTiles_+3A_down">down</code></td>
<td>
<p>Logical vector specifying <code>TRUE</code> if each triangle should point
down (or right), <code>FALSE</code> otherwise.</p>
</td></tr>
<tr><td><code id="TernaryTiles_+3A_resolution">resolution</code></td>
<td>
<p>The number of triangles whose base should lie on the longest
axis of the triangle.  Higher numbers will result in smaller subdivisions and smoother
colour gradients, but at a computational cost.</p>
</td></tr>
<tr><td><code id="TernaryTiles_+3A_col">col</code></td>
<td>
<p>Vector specifying the colour with which to fill each triangle.</p>
</td></tr>
<tr><td><code id="TernaryTiles_+3A_direction">direction</code></td>
<td>
<p>(optional) Integer specifying the direction that the
current ternary plot should point: 1, up; 2, right; 3, down; 4, left.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p><a href="https://orcid.org/0000-0001-5660-1727">Martin R. Smith</a>
(<a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a>)
</p>


<h3>See Also</h3>

<p>Other functions for colouring and shading: 
<code><a href="#topic+ColourTernary">ColourTernary</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>TernaryPlot()
TernaryXRange()
TernaryYRange()

TernaryTiles(0, 0.5, TRUE, 10, "red")
xy &lt;- TernaryCoords(c(4, 3, 3))
TernaryTiles(xy[1], xy[2], FALSE, 5, "darkblue")
</code></pre>

<hr>
<h2 id='TernaryXRange'>X and Y coordinates of ternary plotting area</h2><span id='topic+TernaryXRange'></span><span id='topic+TernaryYRange'></span>

<h3>Description</h3>

<p>X and Y coordinates of ternary plotting area
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TernaryXRange(direction = getOption("ternDirection", 1L))

TernaryYRange(direction = getOption("ternDirection", 1L))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="TernaryXRange_+3A_direction">direction</code></td>
<td>
<p>(optional) Integer specifying the direction that the
current ternary plot should point: 1, up; 2, right; 3, down; 4, left.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>TernaryXRange()</code> and <code>TernaryYRange()</code> return the minimum and
maximum X or Y coordinate of the area in which a ternary plot is drawn,
oriented in the specified direction.
Because the plotting area is a square, the triangle of the ternary plot
will not occupy the full range in one direction.
Assumes that the defaults have not been overwritten by specifying <code>xlim</code> or
<code>ylim</code>.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>TernaryYRange()</code>: Returns the minimum and maximum Y coordinate for a
ternary plot in the specified direction.
</p>
</li></ul>


<h3>Author(s)</h3>

<p><a href="https://orcid.org/0000-0001-5660-1727">Martin R. Smith</a>
(<a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a>)
</p>


<h3>See Also</h3>

<p>Other plot limits: 
<code><a href="#topic+OutsidePlot">OutsidePlot</a>()</code>
</p>

<hr>
<h2 id='TriangleCentres'>Coordinates of triangle mid-points</h2><span id='topic+TriangleCentres'></span>

<h3>Description</h3>

<p>Calculate <em>x</em> and <em>y</em> coordinates of the midpoints of triangles
tiled to cover a ternary plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TriangleCentres(resolution = 48L, direction = getOption("ternDirection", 1L))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="TriangleCentres_+3A_resolution">resolution</code></td>
<td>
<p>The number of triangles whose base should lie on the longest
axis of the triangle.  Higher numbers will result in smaller subdivisions and smoother
colour gradients, but at a computational cost.</p>
</td></tr>
<tr><td><code id="TriangleCentres_+3A_direction">direction</code></td>
<td>
<p>(optional) Integer specifying the direction that the
current ternary plot should point: 1, up; 2, right; 3, down; 4, left.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>TriangleCentres()</code> returns a matrix with three named rows:
</p>

<ul>
<li> <p><code>x</code> <em>x</em> coordinates of triangle midpoints;
</p>
</li>
<li> <p><code>y</code> <em>y</em> coordinates of triangle midpoints;
</p>
</li>
<li> <p><code>triDown</code> <code>0</code> for upwards-pointing triangles, <code>1</code> for downwards-pointing.
</p>
</li></ul>



<h3>Author(s)</h3>

<p><a href="https://orcid.org/0000-0001-5660-1727">Martin R. Smith</a>
(<a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a>)
</p>


<h3>See Also</h3>

<p>Add triangles to a plot: <code><a href="#topic+TernaryTiles">TernaryTiles()</a></code>
</p>
<p>Other coordinate translation functions: 
<code><a href="#topic+ReflectedEquivalents">ReflectedEquivalents</a>()</code>,
<code><a href="#topic+TernaryCoords">TernaryCoords</a>()</code>,
<code><a href="#topic+XYToTernary">XYToTernary</a>()</code>
</p>
<p>Other tiling functions: 
<code><a href="#topic+Polygon-Geometry">Polygon-Geometry</a></code>,
<code><a href="#topic+TriangleInHull">TriangleInHull</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>TernaryPlot(grid.lines = 4)
centres &lt;- TriangleCentres(4)
text(centres["x", ], centres["y", ], ifelse(centres["triDown", ], "v", "^"))

</code></pre>

<hr>
<h2 id='TriangleInHull'>Does triangle overlap convex hull of points?</h2><span id='topic+TriangleInHull'></span>

<h3>Description</h3>

<p>Does triangle overlap convex hull of points?
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TriangleInHull(triangles, coordinates, buffer)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="TriangleInHull_+3A_triangles">triangles</code></td>
<td>
<p>Three-row matrix as produced by <code><a href="#topic+TriangleCentres">TriangleCentres()</a></code>.</p>
</td></tr>
<tr><td><code id="TriangleInHull_+3A_coordinates">coordinates</code></td>
<td>
<p>A matrix with two or three rows specifying the
coordinates of points in <em>x, y</em> or <em>a, b, c</em> format.</p>
</td></tr>
<tr><td><code id="TriangleInHull_+3A_buffer">buffer</code></td>
<td>
<p>Include triangles whose centres lie within <code>buffer</code> triangles
widths (i.e. edge lengths) of the convex hull.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>TriangleInHull()</code> returns a list with the elements:
</p>

<ul>
<li> <p><code style="white-space: pre;">&#8288;$inside&#8288;</code>: vector specifying whether each of a
set of triangles produced by <code><a href="#topic+TriangleCentres">TriangleCentres()</a></code> overlaps the convex
hull of points specified by <code>coordinates</code>.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;$hull&#8288;</code>: Coordinates of convex hull of <code>coordinates</code>, after expansion
to cover overlapping triangles.
</p>
</li></ul>



<h3>Author(s)</h3>

<p><a href="https://orcid.org/0000-0001-5660-1727">Martin R. Smith</a>
(<a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a>)
</p>


<h3>See Also</h3>

<p>Other tiling functions: 
<code><a href="#topic+Polygon-Geometry">Polygon-Geometry</a></code>,
<code><a href="#topic+TriangleCentres">TriangleCentres</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(0)
nPts &lt;- 50
a &lt;- runif(nPts, 0.3, 0.7)
b &lt;- 0.15 + runif(nPts, 0, 0.7 - a)
c &lt;- 1 - a - b
coordinates &lt;- rbind(a, b, c)

TernaryPlot(grid.lines = 5)
TernaryPoints(coordinates, pch = 3, col = 4)
triangles &lt;- TriangleCentres(resolution = 5)
inHull &lt;- TriangleInHull(triangles, coordinates)
polygon(inHull$hull, border = 4)
values &lt;- rbind(triangles,
                z = ifelse(inHull$inside, "#33cc3333", "#cc333333"))
points(triangles["x", ], triangles["y", ],
       pch = ifelse(triangles["triDown", ], 6, 2),
       col = ifelse(inHull$inside, "#33cc33", "#cc3333"))
ColourTernary(values)
</code></pre>

<hr>
<h2 id='XYToTernary'>Cartesian coordinates to ternary point</h2><span id='topic+XYToTernary'></span><span id='topic+XYToHoldridge'></span><span id='topic+XYToPetPrec'></span>

<h3>Description</h3>

<p>Convert cartesian (<em>x</em>, <em>y</em>) coordinates to a point in ternary space.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>XYToTernary(
  x,
  y,
  direction = getOption("ternDirection", 1L),
  region = getOption("ternRegion", ternRegionDefault)
)

XYToHoldridge(x, y)

XYToPetPrec(x, y)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="XYToTernary_+3A_x">x</code>, <code id="XYToTernary_+3A_y">y</code></td>
<td>
<p>Numeric values giving the <em>x</em> and <em>y</em> coordinates of a point or
points.</p>
</td></tr>
<tr><td><code id="XYToTernary_+3A_direction">direction</code></td>
<td>
<p>(optional) Integer specifying the direction that the
current ternary plot should point: 1, up; 2, right; 3, down; 4, left.</p>
</td></tr>
<tr><td><code id="XYToTernary_+3A_region">region</code></td>
<td>
<p>(optional) Named list of length two specifying the the
<code>min</code>imum and <code>max</code>imum values of each ternary axis to be drawn
(e.g. <code style="white-space: pre;">&#8288;list(min = c(40, 0, 0), max = c(100, 60, 60)&#8288;</code>);
or a set of coordinates in a format accepted by <code><a href="#topic+TernaryPoints">TernaryPoints()</a></code>.
The plotted region will correspond to the smallest equilateral triangle
that encompasses the specified ranges or coordinates.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>XYToTernary()</code> Returns the ternary point(s) corresponding to the
specified <em>x</em> and <em>y</em> coordinates, where a + b + c = 1.
</p>


<h3>Author(s)</h3>

<p><a href="https://orcid.org/0000-0001-5660-1727">Martin R. Smith</a>
(<a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a>)
</p>


<h3>See Also</h3>

<p>Other coordinate translation functions: 
<code><a href="#topic+ReflectedEquivalents">ReflectedEquivalents</a>()</code>,
<code><a href="#topic+TernaryCoords">TernaryCoords</a>()</code>,
<code><a href="#topic+TriangleCentres">TriangleCentres</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>XYToTernary(c(0.1, 0.2), 0.5)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
