<!DOCTYPE html><html><head><title>Help for package surveyvoi</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {surveyvoi}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#surveyvoi'><p>surveyvoi: Survey Value of Information</p></a></li>
<li><a href='#approx_evdsi'><p>Approximate expected value of the decision given survey information</p></a></li>
<li><a href='#approx_near_optimal_survey_scheme'><p>Approximately near optimal survey scheme</p></a></li>
<li><a href='#approx_optimal_survey_scheme'><p>Approximately optimal survey scheme</p></a></li>
<li><a href='#env_div_survey_scheme'><p>Environmental diversity survey scheme</p></a></li>
<li><a href='#evdci'><p>Expected value of the decision given current information</p></a></li>
<li><a href='#evdsi'><p>Expected value of the decision given survey information</p></a></li>
<li><a href='#feasible_survey_schemes'><p>Find all feasible survey schemes</p></a></li>
<li><a href='#fit_hglm_occupancy_models'><p>Fit hierarchical generalized linear models to predict occupancy</p></a></li>
<li><a href='#fit_xgb_occupancy_models'><p>Fit boosted regression tree models to predict occupancy</p></a></li>
<li><a href='#geo_cov_survey_scheme'><p>Geographic coverage survey scheme</p></a></li>
<li><a href='#n_states'><p>Number of states</p></a></li>
<li><a href='#optimal_survey_scheme'><p>Optimal survey scheme</p></a></li>
<li><a href='#prior_probability_matrix'><p>Prior probability matrix</p></a></li>
<li><a href='#relative_site_richness_scores'><p>Relative site richness scores</p></a></li>
<li><a href='#relative_site_uncertainty_scores'><p>Relative site uncertainty scores</p></a></li>
<li><a href='#sim_data'><p>Simulated datasets</p></a></li>
<li><a href='#simulate_feature_data'><p>Simulate feature data</p></a></li>
<li><a href='#simulate_site_data'><p>Simulate site data</p></a></li>
<li><a href='#weighted_survey_scheme'><p>Weighted survey scheme</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.6</td>
</tr>
<tr>
<td>Title:</td>
<td>Survey Value of Information</td>
</tr>
<tr>
<td>Description:</td>
<td>Decision support tool for prioritizing sites for ecological
    surveys based on their potential to improve plans for conserving
    biodiversity (e.g. plans for establishing protected areas). Given a set of
    sites that could potentially be acquired for conservation management,
    it can be used to generate and evaluate plans for surveying additional
    sites. Specifically, plans for ecological surveys can be
    generated using various conventional approaches (e.g. maximizing expected
    species richness, geographic coverage, diversity of sampled environmental
    algorithms. After generating such survey plans, they can be evaluated using
    conditions) and maximizing value of information. Please note that several
    functions depend on the 'Gurobi' optimization software (available from
    <a href="https://www.gurobi.com">https://www.gurobi.com</a>). Additionally, the 'JAGS' software (available from
    <a href="https://mcmc-jags.sourceforge.io/">https://mcmc-jags.sourceforge.io/</a>) is required to fit hierarchical
    generalized linear models. For further details, see Hanson et al. (2022) &lt;<a href="https://doi.org/10.1111%2F1365-2664.14309">doi:10.1111/1365-2664.14309</a>&gt;.</td>
</tr>
<tr>
<td>Imports:</td>
<td>utils, methods, stats, parallel, progress (&ge; 1.2.2),
assertthat (&ge; 0.2.0), xgboost (&ge; 1.5.2.1), plyr (&ge; 1.8.4),
withr (&ge; 2.1.2), tibble (&ge; 2.1.3), scales (&ge; 1.0.0),
doParallel (&ge; 1.0.15), dplyr (&ge; 0.8.3), vegan (&ge; 2.5-6),
RcppAlgos (&ge; 2.3.6), groupdata2 (&ge; 1.3.0), Rcpp (&ge; 0.12.19),
Rsymphony (&ge; 0.1-31),</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.1.2), knitr (&ge; 1.20), roxygen2 (&ge; 6.1.0),
rmarkdown (&ge; 1.10), tidyr (&ge; 1.0.0), ggplot2 (&ge; 3.2.1),
gridExtra (&ge; 2.3), viridis (&ge; 0.5.1), PoissonBinomial (&ge;
1.1.1), gurobi (&ge; 8.1.0), Rmpfr (&ge; 0.8-1), runjags (&ge;
2.0.4.6)</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0), Matrix, sf (&ge; 0.8.0), nloptr (&ge; 1.2.2.2),</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp (&ge; 0.12.19), RcppEigen (&ge; 0.3.3.7.0), PoissonBinomial
(&ge; 1.1.1), nloptr (&ge; 1.2.2.2),</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>JAGS (&gt;= 4.3.0) (optional), fftw3 (&gt;= 3.3), gmp (&gt;=
6.2.1), gmpxx (&gt;= 6.2.1), mpfr (&gt;= 3.0.0), autoconf (&gt;= 2.69),
automake (&gt;= 1.16.5)</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://prioritizr.github.io/surveyvoi/">https://prioritizr.github.io/surveyvoi/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/prioritizr/surveyvoi/issues">https://github.com/prioritizr/surveyvoi/issues</a></td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Biarch:</td>
<td>true</td>
</tr>
<tr>
<td>Collate:</td>
<td>'RcppExports.R' 'approx_evdsi.R' 'evdsi.R' 'internal.R'
'approx_near_optimal_survey_scheme.R'
'approx_optimal_survey_scheme.R' 'cluster.R' 'data.R' 'ilp.R'
'env_div_survey_scheme.R' 'evdci.R' 'feasible_survey_schemes.R'
'fit_hglm_occupancy_models.R' 'fit_xgb_occupancy_models.R'
'geo_cov_survey_scheme.R' 'n_states.R'
'optimal_survey_scheme.R' 'package.R'
'prior_probability_matrix.R' 'relative_site_richness_scores.R'
'relative_site_uncertainty_scores.R' 'simulate_feature_data.R'
'simulate_site_data.R' 'validate.R' 'weighted_survey_scheme.R'
'zzz.R'</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-16 20:18:40 UTC; jeff</td>
</tr>
<tr>
<td>Author:</td>
<td>Jeffrey O Hanson <a href="https://orcid.org/0000-0002-4716-6134"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Iadine Chadès <a href="https://orcid.org/0000-0002-7442-2850"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Emma J Hudgins <a href="https://orcid.org/0000-0002-8402-5111"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Joseph R Bennett <a href="https://orcid.org/0000-0002-3901-9513"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jeffrey O Hanson &lt;jeffrey.hanson@uqconnect.edu.au&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-16 23:10:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='surveyvoi'>surveyvoi: Survey Value of Information</h2><span id='topic+surveyvoi'></span><span id='topic+surveyvoi-package'></span>

<h3>Description</h3>

<p>Decision support tool for prioritizing sites for ecological
surveys based on their potential to improve plans for conserving
biodiversity (e.g. plans for establishing protected areas). Given a set of
sites that could potentially be acquired for conservation management &ndash;
wherein some sites have previously been surveyed and other sites have not
&ndash; it can be used to generate and evaluate plans for
additional surveys. Specifically, plans for ecological surveys can be
generated using various conventional approaches (e.g. maximizing expected
species richness, geographic coverage, diversity of sampled environmental
conditions) and by maximizing value of information. After generating
plans for surveys, they can also be evaluated using
value of information analysis.
</p>


<h3>Details</h3>

<p>Please note that several functions depend on
the 'Gurobi' optimization software (available from <a href="https://www.gurobi.com">https://www.gurobi.com</a>)
and the <span class="pkg">gurobi</span> R package (installation instructions
<a href="https://support.gurobi.com/hc/en-us/articles/4534161999889-How-do-I-install-Gurobi-Optimizer">available online for Linux, Windows, and Mac OS</a>).
Additionally, the JAGS software
(available from <a href="https://mcmc-jags.sourceforge.io/">https://mcmc-jags.sourceforge.io/</a>) is required to fit
hierarchical generalized linear models.
</p>


<h3>Author(s)</h3>

<p>Package authors:
</p>

<ul>
<li><p> Jeffrey O. Hanson <a href="mailto:jeffrey.hanson@uqconnect.edu.au">jeffrey.hanson@uqconnect.edu.au</a> <a href="https://orcid.org/0000-0002-4716-6134">ORCID</a>
</p>
</li>
<li><p> Iadine Chadès <a href="mailto:iadine.chades@csiro.au">iadine.chades@csiro.au</a> <a href="https://orcid.org/0000-0002-7442-2850">ORCID</a>
</p>
</li>
<li><p> Emma J. Hudgins <a href="mailto:emma.hudgins@mail.mcgill.ca">emma.hudgins@mail.mcgill.ca</a> <a href="https://orcid.org/0000-0002-8402-5111">ORCID</a>
</p>
</li>
<li><p> Joseph R. Bennett <a href="mailto:joseph.bennett@carleton.ca">joseph.bennett@carleton.ca</a> <a href="https://orcid.org/0000-0002-3901-9513">ORCID</a>
</p>
</li></ul>



<h3>See Also</h3>

<p>The package vignette provides a tutorial
(accessible using the code <code>vignettes("surveyvoi")</code>).
</p>

<hr>
<h2 id='approx_evdsi'>Approximate expected value of the decision given survey information</h2><span id='topic+approx_evdsi'></span>

<h3>Description</h3>

<p>Calculate the <em>expected value of the management decision
given survey information</em>. This metric describes the value of the management
decision that is expected when the decision maker conducts a surveys a
set of sites to inform the decision. To speed up the calculations,
an approximation method is used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>approx_evdsi(
  site_data,
  feature_data,
  site_detection_columns,
  site_n_surveys_columns,
  site_probability_columns,
  site_management_cost_column,
  site_survey_scheme_column,
  site_survey_cost_column,
  feature_survey_column,
  feature_survey_sensitivity_column,
  feature_survey_specificity_column,
  feature_model_sensitivity_column,
  feature_model_specificity_column,
  feature_target_column,
  total_budget,
  site_management_locked_in_column = NULL,
  site_management_locked_out_column = NULL,
  prior_matrix = NULL,
  n_approx_replicates = 100,
  n_approx_outcomes_per_replicate = 10000,
  seed = 500
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="approx_evdsi_+3A_site_data">site_data</code></td>
<td>
<p><code><a href="sf.html#topic+sf">sf::sf()</a></code> object with site data.</p>
</td></tr>
<tr><td><code id="approx_evdsi_+3A_feature_data">feature_data</code></td>
<td>
<p><code><a href="base.html#topic+data.frame">base::data.frame()</a></code> object with feature data.</p>
</td></tr>
<tr><td><code id="approx_evdsi_+3A_site_detection_columns">site_detection_columns</code></td>
<td>
<p><code>character</code> names of <code>numeric</code>
columns in the argument to <code>site_data</code> that contain the proportion of
surveys conducted within each site that detected each feature.
Each column should correspond to a different feature, and contain
a proportion value (between zero and one). If a site has
not previously been surveyed, a value of zero should be used.</p>
</td></tr>
<tr><td><code id="approx_evdsi_+3A_site_n_surveys_columns">site_n_surveys_columns</code></td>
<td>
<p><code>character</code> names of <code>numeric</code>
columns in the argument to <code>site_data</code> that contain the total
number of surveys conducted for each each feature within each site.
Each column should correspond to a different feature, and contain
a non-negative integer number (e.g. 0, 1, 2, 3). If a site has
not previously been surveyed, a value of zero should be used.</p>
</td></tr>
<tr><td><code id="approx_evdsi_+3A_site_probability_columns">site_probability_columns</code></td>
<td>
<p><code>character</code> names of <code>numeric</code>
columns in the argument to <code>site_data</code> that contain modeled
probabilities of occupancy for each feature in each site.
Each column should correspond to a different feature, and contain
probability data (values between zero and one). No missing (<code>NA</code>)
values are permitted in these columns.</p>
</td></tr>
<tr><td><code id="approx_evdsi_+3A_site_management_cost_column">site_management_cost_column</code></td>
<td>
<p><code>character</code> name of column in the
argument to <code>site_data</code> that contains costs for managing each
site for conservation. This column should have <code>numeric</code> values that
are equal to or greater than zero. No missing (<code>NA</code>) values are
permitted in this column.</p>
</td></tr>
<tr><td><code id="approx_evdsi_+3A_site_survey_scheme_column">site_survey_scheme_column</code></td>
<td>
<p><code>character</code> name of <code>logical</code>
(<code>TRUE</code> / <code>FALSE</code>) column in the argument to <code>site_data</code>
that indicates which sites are selected in the scheme or not.
No missing <code>NA</code> values are permitted. Additionally, only sites
that are missing data can be selected or surveying (as per the
argument to <code>site_detection_columns</code>).</p>
</td></tr>
<tr><td><code id="approx_evdsi_+3A_site_survey_cost_column">site_survey_cost_column</code></td>
<td>
<p><code>character</code> name of column in the
argument to  <code>site_data</code> that contains costs for surveying each
site. This column should have <code>numeric</code> values that are equal to
or greater than zero. No missing (<code>NA</code>) values are permitted in this
column.</p>
</td></tr>
<tr><td><code id="approx_evdsi_+3A_feature_survey_column">feature_survey_column</code></td>
<td>
<p><code>character</code> name of the column in the
argument to <code>feature_data</code> that contains <code>logical</code> (<code>TRUE</code> /
<code>FALSE</code>) values indicating if the feature will be surveyed in
the planned surveys or not. Note that considering additional features will
rapidly increase computational burden, and so it is only recommended to
consider features that are of specific conservation interest.
No missing (<code>NA</code>) values are permitted in this column.</p>
</td></tr>
<tr><td><code id="approx_evdsi_+3A_feature_survey_sensitivity_column">feature_survey_sensitivity_column</code></td>
<td>
<p><code>character</code> name of the
column in the argument to <code>feature_data</code> that contains
probability of future surveys correctly detecting a presence of each
feature in a given site (i.e. the sensitivity of the survey methodology).
This column should have <code>numeric</code> values that are between zero and
one. No missing (<code>NA</code>) values are permitted in this column.</p>
</td></tr>
<tr><td><code id="approx_evdsi_+3A_feature_survey_specificity_column">feature_survey_specificity_column</code></td>
<td>
<p><code>character</code> name of the
column in the argument to <code>feature_data</code> that contains
probability of future surveys correctly detecting an absence of each
feature in a given site (i.e. the specificity of the survey methodology).
This column should have <code>numeric</code> values that are between zero and
one. No missing (<code>NA</code>) values are permitted in this column.</p>
</td></tr>
<tr><td><code id="approx_evdsi_+3A_feature_model_sensitivity_column">feature_model_sensitivity_column</code></td>
<td>
<p><code>character</code> name of the
column in the argument to <code>feature_data</code> that contains
probability of the initial models correctly predicting a presence of each
feature in a given site (i.e. the sensitivity of the models).
This column should have <code>numeric</code> values that are between zero and
one. No missing (<code>NA</code>) values are permitted in this column.
This should ideally be calculated using
<code><a href="#topic+fit_xgb_occupancy_models">fit_xgb_occupancy_models()</a></code> or
<code><a href="#topic+fit_hglm_occupancy_models">fit_hglm_occupancy_models()</a></code>.</p>
</td></tr>
<tr><td><code id="approx_evdsi_+3A_feature_model_specificity_column">feature_model_specificity_column</code></td>
<td>
<p><code>character</code> name of the
column in the argument to <code>feature_data</code> that contains
probability of the initial models correctly predicting an absence of each
feature in a given site (i.e. the specificity of the models).
This column should have <code>numeric</code> values that are between zero and
one. No missing (<code>NA</code>) values are permitted in this column.
This should ideally be calculated using
<code><a href="#topic+fit_xgb_occupancy_models">fit_xgb_occupancy_models()</a></code> or
<code><a href="#topic+fit_hglm_occupancy_models">fit_hglm_occupancy_models()</a></code>.</p>
</td></tr>
<tr><td><code id="approx_evdsi_+3A_feature_target_column">feature_target_column</code></td>
<td>
<p><code>character</code> name of the column in the
argument to <code>feature_data</code> that contains the <code class="reqn">target</code>
values used to parametrize the conservation benefit of managing of each
feature.
This column should have <code>numeric</code> values that
are equal to or greater than zero. No missing (<code>NA</code>) values are
permitted in this column.</p>
</td></tr>
<tr><td><code id="approx_evdsi_+3A_total_budget">total_budget</code></td>
<td>
<p><code>numeric</code> maximum expenditure permitted
for conducting surveys and managing sites for conservation.</p>
</td></tr>
<tr><td><code id="approx_evdsi_+3A_site_management_locked_in_column">site_management_locked_in_column</code></td>
<td>
<p><code>character</code> name of the column
in the argument to <code>site_data</code> that contains <code>logical</code>
(<code>TRUE</code> / <code>FALSE</code>) values indicating which sites should
be locked in for (<code>TRUE</code>) being managed for conservation or
(<code>FALSE</code>) not. No missing (<code>NA</code>) values are permitted in this
column. This is useful if some sites have already been earmarked for
conservation, or if some sites are already being managed for conservation.
Defaults to <code>NULL</code> such that no sites are locked in.</p>
</td></tr>
<tr><td><code id="approx_evdsi_+3A_site_management_locked_out_column">site_management_locked_out_column</code></td>
<td>
<p><code>character</code> name of the column
in the argument to <code>site_data</code> that contains <code>logical</code>
(<code>TRUE</code> / <code>FALSE</code>) values indicating which sites should
be locked out for (<code>TRUE</code>) being managed for conservation or
(<code>FALSE</code>) not. No missing (<code>NA</code>) values are permitted in this
column. This is useful if some sites could potentially be surveyed
to improve model predictions even if they cannot be managed for
conservation. Defaults to <code>NULL</code> such that no sites are locked out.</p>
</td></tr>
<tr><td><code id="approx_evdsi_+3A_prior_matrix">prior_matrix</code></td>
<td>
<p><code>numeric</code> <code>matrix</code> containing
the prior probability of each feature occupying each site.
Rows correspond to features, and columns correspond to sites.
Defaults to <code>NULL</code> such that prior data is calculated automatically
using <code><a href="#topic+prior_probability_matrix">prior_probability_matrix()</a></code>.</p>
</td></tr>
<tr><td><code id="approx_evdsi_+3A_n_approx_replicates">n_approx_replicates</code></td>
<td>
<p><code>integer</code> number of replicates to use for
approximating the expected value calculations. Defaults to 100.</p>
</td></tr>
<tr><td><code id="approx_evdsi_+3A_n_approx_outcomes_per_replicate">n_approx_outcomes_per_replicate</code></td>
<td>
<p><code>integer</code> number of outcomes to
use per replicate for approximation calculations. Defaults to 10000.</p>
</td></tr>
<tr><td><code id="approx_evdsi_+3A_seed">seed</code></td>
<td>
<p><code>integer</code> state of the random number generator for
simulating outcomes when conducting the value of information analyses.
Defaults to 500.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function uses approximation methods to estimate the
expected value calculations. The accuracy of these
calculations depend on the arguments to
<code>n_approx_replicates</code> and <code>n_approx_outcomes_per_replicate</code>, and
so you may need to increase these parameters for large problems.
</p>


<h3>Value</h3>

<p>A <code>numeric</code> vector containing the expected values for each
replicate.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+prior_probability_matrix">prior_probability_matrix()</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># set seeds for reproducibility
set.seed(123)

# load example site data
data(sim_sites)
print(sim_sites)

# load example feature data
data(sim_features)
print(sim_features)

# set total budget for managing sites for conservation
 # (i.e. 50% of the cost of managing all sites)
total_budget &lt;- sum(sim_sites$management_cost) * 0.5

# create a survey scheme that samples the first two sites that
# are missing data
sim_sites$survey_site &lt;- FALSE
sim_sites$survey_site[which(sim_sites$n1 &lt; 0.5)[1:2]] &lt;- TRUE

# calculate expected value of management decision given the survey
# information using approximation method
approx_ev_survey &lt;- approx_evdsi(
  sim_sites, sim_features,
  c("f1", "f2", "f3"), c("n1", "n2", "n3"), c("p1", "p2", "p3"),
  "management_cost", "survey_site",
  "survey_cost", "survey", "survey_sensitivity", "survey_specificity",
  "model_sensitivity", "model_specificity",
  "target", total_budget)

# print mean value
print(mean(approx_ev_survey))
</code></pre>

<hr>
<h2 id='approx_near_optimal_survey_scheme'>Approximately near optimal survey scheme</h2><span id='topic+approx_near_optimal_survey_scheme'></span>

<h3>Description</h3>

<p>Find a near optimal survey scheme that maximizes value of information.
This function uses the approximation method
for calculating the expected value of the decision given a survey scheme,
and a greedy heuristic algorithm to maximize this metric.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>approx_near_optimal_survey_scheme(
  site_data,
  feature_data,
  site_detection_columns,
  site_n_surveys_columns,
  site_probability_columns,
  site_management_cost_column,
  site_survey_cost_column,
  feature_survey_column,
  feature_survey_sensitivity_column,
  feature_survey_specificity_column,
  feature_model_sensitivity_column,
  feature_model_specificity_column,
  feature_target_column,
  total_budget,
  survey_budget,
  site_management_locked_in_column = NULL,
  site_management_locked_out_column = NULL,
  site_survey_locked_out_column = NULL,
  prior_matrix = NULL,
  n_approx_replicates = 100,
  n_approx_outcomes_per_replicate = 10000,
  seed = 500,
  n_threads = 1,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="approx_near_optimal_survey_scheme_+3A_site_data">site_data</code></td>
<td>
<p><code><a href="sf.html#topic+sf">sf::sf()</a></code> object with site data.</p>
</td></tr>
<tr><td><code id="approx_near_optimal_survey_scheme_+3A_feature_data">feature_data</code></td>
<td>
<p><code><a href="base.html#topic+data.frame">base::data.frame()</a></code> object with feature data.</p>
</td></tr>
<tr><td><code id="approx_near_optimal_survey_scheme_+3A_site_detection_columns">site_detection_columns</code></td>
<td>
<p><code>character</code> names of <code>numeric</code>
columns in the argument to <code>site_data</code> that contain the proportion of
surveys conducted within each site that detected each feature.
Each column should correspond to a different feature, and contain
a proportion value (between zero and one). If a site has
not previously been surveyed, a value of zero should be used.</p>
</td></tr>
<tr><td><code id="approx_near_optimal_survey_scheme_+3A_site_n_surveys_columns">site_n_surveys_columns</code></td>
<td>
<p><code>character</code> names of <code>numeric</code>
columns in the argument to <code>site_data</code> that contain the total
number of surveys conducted for each each feature within each site.
Each column should correspond to a different feature, and contain
a non-negative integer number (e.g. 0, 1, 2, 3). If a site has
not previously been surveyed, a value of zero should be used.</p>
</td></tr>
<tr><td><code id="approx_near_optimal_survey_scheme_+3A_site_probability_columns">site_probability_columns</code></td>
<td>
<p><code>character</code> names of <code>numeric</code>
columns in the argument to <code>site_data</code> that contain modeled
probabilities of occupancy for each feature in each site.
Each column should correspond to a different feature, and contain
probability data (values between zero and one). No missing (<code>NA</code>)
values are permitted in these columns.</p>
</td></tr>
<tr><td><code id="approx_near_optimal_survey_scheme_+3A_site_management_cost_column">site_management_cost_column</code></td>
<td>
<p><code>character</code> name of column in the
argument to <code>site_data</code> that contains costs for managing each
site for conservation. This column should have <code>numeric</code> values that
are equal to or greater than zero. No missing (<code>NA</code>) values are
permitted in this column.</p>
</td></tr>
<tr><td><code id="approx_near_optimal_survey_scheme_+3A_site_survey_cost_column">site_survey_cost_column</code></td>
<td>
<p><code>character</code> name of column in the
argument to  <code>site_data</code> that contains costs for surveying each
site. This column should have <code>numeric</code> values that are equal to
or greater than zero. No missing (<code>NA</code>) values are permitted in this
column.</p>
</td></tr>
<tr><td><code id="approx_near_optimal_survey_scheme_+3A_feature_survey_column">feature_survey_column</code></td>
<td>
<p><code>character</code> name of the column in the
argument to <code>feature_data</code> that contains <code>logical</code> (<code>TRUE</code> /
<code>FALSE</code>) values indicating if the feature will be surveyed in
the planned surveys or not. Note that considering additional features will
rapidly increase computational burden, and so it is only recommended to
consider features that are of specific conservation interest.
No missing (<code>NA</code>) values are permitted in this column.</p>
</td></tr>
<tr><td><code id="approx_near_optimal_survey_scheme_+3A_feature_survey_sensitivity_column">feature_survey_sensitivity_column</code></td>
<td>
<p><code>character</code> name of the
column in the argument to <code>feature_data</code> that contains
probability of future surveys correctly detecting a presence of each
feature in a given site (i.e. the sensitivity of the survey methodology).
This column should have <code>numeric</code> values that are between zero and
one. No missing (<code>NA</code>) values are permitted in this column.</p>
</td></tr>
<tr><td><code id="approx_near_optimal_survey_scheme_+3A_feature_survey_specificity_column">feature_survey_specificity_column</code></td>
<td>
<p><code>character</code> name of the
column in the argument to <code>feature_data</code> that contains
probability of future surveys correctly detecting an absence of each
feature in a given site (i.e. the specificity of the survey methodology).
This column should have <code>numeric</code> values that are between zero and
one. No missing (<code>NA</code>) values are permitted in this column.</p>
</td></tr>
<tr><td><code id="approx_near_optimal_survey_scheme_+3A_feature_model_sensitivity_column">feature_model_sensitivity_column</code></td>
<td>
<p><code>character</code> name of the
column in the argument to <code>feature_data</code> that contains
probability of the initial models correctly predicting a presence of each
feature in a given site (i.e. the sensitivity of the models).
This column should have <code>numeric</code> values that are between zero and
one. No missing (<code>NA</code>) values are permitted in this column.
This should ideally be calculated using
<code><a href="#topic+fit_xgb_occupancy_models">fit_xgb_occupancy_models()</a></code> or
<code><a href="#topic+fit_hglm_occupancy_models">fit_hglm_occupancy_models()</a></code>.</p>
</td></tr>
<tr><td><code id="approx_near_optimal_survey_scheme_+3A_feature_model_specificity_column">feature_model_specificity_column</code></td>
<td>
<p><code>character</code> name of the
column in the argument to <code>feature_data</code> that contains
probability of the initial models correctly predicting an absence of each
feature in a given site (i.e. the specificity of the models).
This column should have <code>numeric</code> values that are between zero and
one. No missing (<code>NA</code>) values are permitted in this column.
This should ideally be calculated using
<code><a href="#topic+fit_xgb_occupancy_models">fit_xgb_occupancy_models()</a></code> or
<code><a href="#topic+fit_hglm_occupancy_models">fit_hglm_occupancy_models()</a></code>.</p>
</td></tr>
<tr><td><code id="approx_near_optimal_survey_scheme_+3A_feature_target_column">feature_target_column</code></td>
<td>
<p><code>character</code> name of the column in the
argument to <code>feature_data</code> that contains the <code class="reqn">target</code>
values used to parametrize the conservation benefit of managing of each
feature.
This column should have <code>numeric</code> values that
are equal to or greater than zero. No missing (<code>NA</code>) values are
permitted in this column.</p>
</td></tr>
<tr><td><code id="approx_near_optimal_survey_scheme_+3A_total_budget">total_budget</code></td>
<td>
<p><code>numeric</code> maximum expenditure permitted
for conducting surveys and managing sites for conservation.</p>
</td></tr>
<tr><td><code id="approx_near_optimal_survey_scheme_+3A_survey_budget">survey_budget</code></td>
<td>
<p><code>numeric</code> maximum expenditure permitted
for conducting surveys.</p>
</td></tr>
<tr><td><code id="approx_near_optimal_survey_scheme_+3A_site_management_locked_in_column">site_management_locked_in_column</code></td>
<td>
<p><code>character</code> name of the column
in the argument to <code>site_data</code> that contains <code>logical</code>
(<code>TRUE</code> / <code>FALSE</code>) values indicating which sites should
be locked in for (<code>TRUE</code>) being managed for conservation or
(<code>FALSE</code>) not. No missing (<code>NA</code>) values are permitted in this
column. This is useful if some sites have already been earmarked for
conservation, or if some sites are already being managed for conservation.
Defaults to <code>NULL</code> such that no sites are locked in.</p>
</td></tr>
<tr><td><code id="approx_near_optimal_survey_scheme_+3A_site_management_locked_out_column">site_management_locked_out_column</code></td>
<td>
<p><code>character</code> name of the column
in the argument to <code>site_data</code> that contains <code>logical</code>
(<code>TRUE</code> / <code>FALSE</code>) values indicating which sites should
be locked out for (<code>TRUE</code>) being managed for conservation or
(<code>FALSE</code>) not. No missing (<code>NA</code>) values are permitted in this
column. This is useful if some sites could potentially be surveyed
to improve model predictions even if they cannot be managed for
conservation. Defaults to <code>NULL</code> such that no sites are locked out.</p>
</td></tr>
<tr><td><code id="approx_near_optimal_survey_scheme_+3A_site_survey_locked_out_column">site_survey_locked_out_column</code></td>
<td>
<p><code>character</code> name of the column
in the argument to <code>site_data</code> that contains <code>logical</code>
(<code>TRUE</code> / <code>FALSE</code>) values indicating which sites should
be locked out (<code>TRUE</code>) from being selected for future surveys or
(<code>FALSE</code>) not. No missing (<code>NA</code>) values are permitted in this
column. This is useful if some sites will never be considered for future
surveys (e.g. because they are too costly to survey, or have a
low chance of containing the target species).
Defaults to <code>NULL</code> such that no sites are locked out.</p>
</td></tr>
<tr><td><code id="approx_near_optimal_survey_scheme_+3A_prior_matrix">prior_matrix</code></td>
<td>
<p><code>numeric</code> <code>matrix</code> containing
the prior probability of each feature occupying each site.
Rows correspond to features, and columns correspond to sites.
Defaults to <code>NULL</code> such that prior data is calculated automatically
using <code><a href="#topic+prior_probability_matrix">prior_probability_matrix()</a></code>.</p>
</td></tr>
<tr><td><code id="approx_near_optimal_survey_scheme_+3A_n_approx_replicates">n_approx_replicates</code></td>
<td>
<p><code>integer</code> number of replicates to use for
approximating the expected value calculations. Defaults to 100.</p>
</td></tr>
<tr><td><code id="approx_near_optimal_survey_scheme_+3A_n_approx_outcomes_per_replicate">n_approx_outcomes_per_replicate</code></td>
<td>
<p><code>integer</code> number of outcomes to
use per replicate for approximation calculations. Defaults to 10000.</p>
</td></tr>
<tr><td><code id="approx_near_optimal_survey_scheme_+3A_seed">seed</code></td>
<td>
<p><code>integer</code> state of the random number generator for
simulating outcomes when conducting the value of information analyses.
Defaults to 500.</p>
</td></tr>
<tr><td><code id="approx_near_optimal_survey_scheme_+3A_n_threads">n_threads</code></td>
<td>
<p><code>integer</code> number of threads to use for computation.</p>
</td></tr>
<tr><td><code id="approx_near_optimal_survey_scheme_+3A_verbose">verbose</code></td>
<td>
<p><code>logical</code> indicating if information should be
printed during processing. Defaults to <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Ideally, the brute-force algorithm would be used to identify the optimal
survey scheme. Unfortunately, it is not feasible to apply the brute-force
to large problems because it can take an incredibly long time to complete.
In such cases, it may be desirable to obtain a &quot;relatively good&quot; survey
scheme and the greedy heuristic algorithm is provided for such cases.
The greedy heuristic algorithm &ndash; unlike the brute force algorithm &ndash;
is not guaranteed to identify an optimal solution &ndash; or even a &quot;relatively
good solution&quot; for that matter &ndash; though greedy heuristic algorithms tend to
deliver solutions that are 15\
greedy algorithms is implemented as:
</p>

<ol>
<li><p> Initialize an empty <em>list of survey scheme solutions</em>, and an
empty <em>list of approximate expected values</em>.
</p>
</li>
<li><p> Calculate the expected value of current information.
</p>
</li>
<li><p> Add a survey scheme with no sites selected for surveying to the
<em>list of survey scheme solutions</em>, and add the expected value of current
information to the <em>list of approximate expected values</em>.
</p>
</li>
<li><p> Set the <em>current survey solution</em> as the survey scheme with no
sites selected for surveying.
</p>
</li>
<li><p> For each remaining candidate site that has not been selected for
a survey, generate a new candidate survey scheme with each candidate site
added to the current survey solution.
</p>
</li>
<li><p> Calculate the approximate expected value of each
new candidate survey scheme. If the cost of a given candidate survey scheme
exceeds the survey budget, then store a missing <code style="white-space: pre;">&#8288;NA value&#8288;</code> instead.
Also if the the cost of a given candidate survey scheme plus the
management costs of locked in planning units exceeds the total budget,
then a store a missing value <code>NA</code> value too.
</p>
</li>
<li><p> If all of the new candidate survey schemes are associated with
missing <code>NA</code> values &ndash; because they all exceed the survey budget &ndash; then
go to step 12.
</p>
</li>
<li><p> Calculate the cost effectiveness of each new candidate survey
scheme. This calculated as the difference between the approximate expected
value of a given new candidate survey scheme and that of the
<em>current survey solution</em>, and dividing this difference by the the cost
of the newly selected candidate site.
</p>
</li>
<li><p> Find the new candidate survey scheme that is associated with the
highest cost-effectiveness value, ignoring any missing <code>NA</code> values.
This new candidate survey scheme is now set as the
<em>current survey scheme</em>.
</p>
</li>
<li><p> Store the <em>current survey scheme</em> in the
<em>list of survey scheme solutions</em> and store its approximate expected
value in the <em>list of approximate expected values</em>.
</p>
</li>
<li><p> Go to step 12.
</p>
</li>
<li><p> Find the solution in the <em>list of survey scheme solutions</em> that
has the highest expected value in the
<em>list of approximate expected values</em> and return this solution.
</p>
</li></ol>



<h3>Value</h3>

<p>A <code>matrix</code> of <code>logical</code> (<code>TRUE</code>/ <code>FALSE</code>)
values indicating if a site is selected in the scheme or not. Columns
correspond to sites, and rows correspond to different schemes. If there
are no ties for the best identified solution, then the the <code>matrix</code>
will only contain a single row.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># set seeds for reproducibility
set.seed(123)

# load example site data
data(sim_sites)
print(sim_sites)

# load example feature data
data(sim_features)
print(sim_features)

# set total budget for managing sites for conservation
 # (i.e. 50% of the cost of managing all sites)
total_budget &lt;- sum(sim_sites$management_cost) * 0.5

# set total budget for surveying sites for conservation
# (i.e. 40% of the cost of managing all sites)
survey_budget &lt;- sum(sim_sites$survey_cost) * 0.4

# find survey scheme using approximate method and greedy heuristic algorithm
# (using 10 replicates so that this example completes relatively quickly)
approx_near_optimal_survey &lt;- approx_near_optimal_survey_scheme(
  sim_sites, sim_features,
  c("f1", "f2", "f3"), c("n1", "n2", "n3"), c("p1", "p2", "p3"),
  "management_cost", "survey_cost",
  "survey", "survey_sensitivity", "survey_specificity",
  "model_sensitivity", "model_specificity",
  "target", total_budget, survey_budget)

# print result
print(approx_near_optimal_survey)
</code></pre>

<hr>
<h2 id='approx_optimal_survey_scheme'>Approximately optimal survey scheme</h2><span id='topic+approx_optimal_survey_scheme'></span>

<h3>Description</h3>

<p>Find the optimal survey scheme that maximizes value of information. This
function uses the approximation method
for calculating the expected value of the decision given a survey scheme.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>approx_optimal_survey_scheme(
  site_data,
  feature_data,
  site_detection_columns,
  site_n_surveys_columns,
  site_probability_columns,
  site_management_cost_column,
  site_survey_cost_column,
  feature_survey_column,
  feature_survey_sensitivity_column,
  feature_survey_specificity_column,
  feature_model_sensitivity_column,
  feature_model_specificity_column,
  feature_target_column,
  total_budget,
  survey_budget,
  site_management_locked_in_column = NULL,
  site_management_locked_out_column = NULL,
  site_survey_locked_out_column = NULL,
  prior_matrix = NULL,
  n_approx_replicates = 100,
  n_approx_outcomes_per_replicate = 10000,
  seed = 500,
  n_threads = 1,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="approx_optimal_survey_scheme_+3A_site_data">site_data</code></td>
<td>
<p><code><a href="sf.html#topic+sf">sf::sf()</a></code> object with site data.</p>
</td></tr>
<tr><td><code id="approx_optimal_survey_scheme_+3A_feature_data">feature_data</code></td>
<td>
<p><code><a href="base.html#topic+data.frame">base::data.frame()</a></code> object with feature data.</p>
</td></tr>
<tr><td><code id="approx_optimal_survey_scheme_+3A_site_detection_columns">site_detection_columns</code></td>
<td>
<p><code>character</code> names of <code>numeric</code>
columns in the argument to <code>site_data</code> that contain the proportion of
surveys conducted within each site that detected each feature.
Each column should correspond to a different feature, and contain
a proportion value (between zero and one). If a site has
not previously been surveyed, a value of zero should be used.</p>
</td></tr>
<tr><td><code id="approx_optimal_survey_scheme_+3A_site_n_surveys_columns">site_n_surveys_columns</code></td>
<td>
<p><code>character</code> names of <code>numeric</code>
columns in the argument to <code>site_data</code> that contain the total
number of surveys conducted for each each feature within each site.
Each column should correspond to a different feature, and contain
a non-negative integer number (e.g. 0, 1, 2, 3). If a site has
not previously been surveyed, a value of zero should be used.</p>
</td></tr>
<tr><td><code id="approx_optimal_survey_scheme_+3A_site_probability_columns">site_probability_columns</code></td>
<td>
<p><code>character</code> names of <code>numeric</code>
columns in the argument to <code>site_data</code> that contain modeled
probabilities of occupancy for each feature in each site.
Each column should correspond to a different feature, and contain
probability data (values between zero and one). No missing (<code>NA</code>)
values are permitted in these columns.</p>
</td></tr>
<tr><td><code id="approx_optimal_survey_scheme_+3A_site_management_cost_column">site_management_cost_column</code></td>
<td>
<p><code>character</code> name of column in the
argument to <code>site_data</code> that contains costs for managing each
site for conservation. This column should have <code>numeric</code> values that
are equal to or greater than zero. No missing (<code>NA</code>) values are
permitted in this column.</p>
</td></tr>
<tr><td><code id="approx_optimal_survey_scheme_+3A_site_survey_cost_column">site_survey_cost_column</code></td>
<td>
<p><code>character</code> name of column in the
argument to  <code>site_data</code> that contains costs for surveying each
site. This column should have <code>numeric</code> values that are equal to
or greater than zero. No missing (<code>NA</code>) values are permitted in this
column.</p>
</td></tr>
<tr><td><code id="approx_optimal_survey_scheme_+3A_feature_survey_column">feature_survey_column</code></td>
<td>
<p><code>character</code> name of the column in the
argument to <code>feature_data</code> that contains <code>logical</code> (<code>TRUE</code> /
<code>FALSE</code>) values indicating if the feature will be surveyed in
the planned surveys or not. Note that considering additional features will
rapidly increase computational burden, and so it is only recommended to
consider features that are of specific conservation interest.
No missing (<code>NA</code>) values are permitted in this column.</p>
</td></tr>
<tr><td><code id="approx_optimal_survey_scheme_+3A_feature_survey_sensitivity_column">feature_survey_sensitivity_column</code></td>
<td>
<p><code>character</code> name of the
column in the argument to <code>feature_data</code> that contains
probability of future surveys correctly detecting a presence of each
feature in a given site (i.e. the sensitivity of the survey methodology).
This column should have <code>numeric</code> values that are between zero and
one. No missing (<code>NA</code>) values are permitted in this column.</p>
</td></tr>
<tr><td><code id="approx_optimal_survey_scheme_+3A_feature_survey_specificity_column">feature_survey_specificity_column</code></td>
<td>
<p><code>character</code> name of the
column in the argument to <code>feature_data</code> that contains
probability of future surveys correctly detecting an absence of each
feature in a given site (i.e. the specificity of the survey methodology).
This column should have <code>numeric</code> values that are between zero and
one. No missing (<code>NA</code>) values are permitted in this column.</p>
</td></tr>
<tr><td><code id="approx_optimal_survey_scheme_+3A_feature_model_sensitivity_column">feature_model_sensitivity_column</code></td>
<td>
<p><code>character</code> name of the
column in the argument to <code>feature_data</code> that contains
probability of the initial models correctly predicting a presence of each
feature in a given site (i.e. the sensitivity of the models).
This column should have <code>numeric</code> values that are between zero and
one. No missing (<code>NA</code>) values are permitted in this column.
This should ideally be calculated using
<code><a href="#topic+fit_xgb_occupancy_models">fit_xgb_occupancy_models()</a></code> or
<code><a href="#topic+fit_hglm_occupancy_models">fit_hglm_occupancy_models()</a></code>.</p>
</td></tr>
<tr><td><code id="approx_optimal_survey_scheme_+3A_feature_model_specificity_column">feature_model_specificity_column</code></td>
<td>
<p><code>character</code> name of the
column in the argument to <code>feature_data</code> that contains
probability of the initial models correctly predicting an absence of each
feature in a given site (i.e. the specificity of the models).
This column should have <code>numeric</code> values that are between zero and
one. No missing (<code>NA</code>) values are permitted in this column.
This should ideally be calculated using
<code><a href="#topic+fit_xgb_occupancy_models">fit_xgb_occupancy_models()</a></code> or
<code><a href="#topic+fit_hglm_occupancy_models">fit_hglm_occupancy_models()</a></code>.</p>
</td></tr>
<tr><td><code id="approx_optimal_survey_scheme_+3A_feature_target_column">feature_target_column</code></td>
<td>
<p><code>character</code> name of the column in the
argument to <code>feature_data</code> that contains the <code class="reqn">target</code>
values used to parametrize the conservation benefit of managing of each
feature.
This column should have <code>numeric</code> values that
are equal to or greater than zero. No missing (<code>NA</code>) values are
permitted in this column.</p>
</td></tr>
<tr><td><code id="approx_optimal_survey_scheme_+3A_total_budget">total_budget</code></td>
<td>
<p><code>numeric</code> maximum expenditure permitted
for conducting surveys and managing sites for conservation.</p>
</td></tr>
<tr><td><code id="approx_optimal_survey_scheme_+3A_survey_budget">survey_budget</code></td>
<td>
<p><code>numeric</code> maximum expenditure permitted
for conducting surveys.</p>
</td></tr>
<tr><td><code id="approx_optimal_survey_scheme_+3A_site_management_locked_in_column">site_management_locked_in_column</code></td>
<td>
<p><code>character</code> name of the column
in the argument to <code>site_data</code> that contains <code>logical</code>
(<code>TRUE</code> / <code>FALSE</code>) values indicating which sites should
be locked in for (<code>TRUE</code>) being managed for conservation or
(<code>FALSE</code>) not. No missing (<code>NA</code>) values are permitted in this
column. This is useful if some sites have already been earmarked for
conservation, or if some sites are already being managed for conservation.
Defaults to <code>NULL</code> such that no sites are locked in.</p>
</td></tr>
<tr><td><code id="approx_optimal_survey_scheme_+3A_site_management_locked_out_column">site_management_locked_out_column</code></td>
<td>
<p><code>character</code> name of the column
in the argument to <code>site_data</code> that contains <code>logical</code>
(<code>TRUE</code> / <code>FALSE</code>) values indicating which sites should
be locked out for (<code>TRUE</code>) being managed for conservation or
(<code>FALSE</code>) not. No missing (<code>NA</code>) values are permitted in this
column. This is useful if some sites could potentially be surveyed
to improve model predictions even if they cannot be managed for
conservation. Defaults to <code>NULL</code> such that no sites are locked out.</p>
</td></tr>
<tr><td><code id="approx_optimal_survey_scheme_+3A_site_survey_locked_out_column">site_survey_locked_out_column</code></td>
<td>
<p><code>character</code> name of the column
in the argument to <code>site_data</code> that contains <code>logical</code>
(<code>TRUE</code> / <code>FALSE</code>) values indicating which sites should
be locked out (<code>TRUE</code>) from being selected for future surveys or
(<code>FALSE</code>) not. No missing (<code>NA</code>) values are permitted in this
column. This is useful if some sites will never be considered for future
surveys (e.g. because they are too costly to survey, or have a
low chance of containing the target species).
Defaults to <code>NULL</code> such that no sites are locked out.</p>
</td></tr>
<tr><td><code id="approx_optimal_survey_scheme_+3A_prior_matrix">prior_matrix</code></td>
<td>
<p><code>numeric</code> <code>matrix</code> containing
the prior probability of each feature occupying each site.
Rows correspond to features, and columns correspond to sites.
Defaults to <code>NULL</code> such that prior data is calculated automatically
using <code><a href="#topic+prior_probability_matrix">prior_probability_matrix()</a></code>.</p>
</td></tr>
<tr><td><code id="approx_optimal_survey_scheme_+3A_n_approx_replicates">n_approx_replicates</code></td>
<td>
<p><code>integer</code> number of replicates to use for
approximating the expected value calculations. Defaults to 100.</p>
</td></tr>
<tr><td><code id="approx_optimal_survey_scheme_+3A_n_approx_outcomes_per_replicate">n_approx_outcomes_per_replicate</code></td>
<td>
<p><code>integer</code> number of outcomes to
use per replicate for approximation calculations. Defaults to 10000.</p>
</td></tr>
<tr><td><code id="approx_optimal_survey_scheme_+3A_seed">seed</code></td>
<td>
<p><code>integer</code> state of the random number generator for
simulating outcomes when conducting the value of information analyses.
Defaults to 500.</p>
</td></tr>
<tr><td><code id="approx_optimal_survey_scheme_+3A_n_threads">n_threads</code></td>
<td>
<p><code>integer</code> number of threads to use for computation.</p>
</td></tr>
<tr><td><code id="approx_optimal_survey_scheme_+3A_verbose">verbose</code></td>
<td>
<p><code>logical</code> indicating if information should be
printed during processing. Defaults to <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The &quot;approximately&quot; optimal survey scheme is determined using a brute-force
algorithm.
Initially, all feasible (valid) survey schemes are identified given the
survey costs and the survey budget (using
<code><a href="#topic+feasible_survey_schemes">feasible_survey_schemes()</a></code>. Next, the expected value of each and
every feasible survey scheme is approximated
(using <code><a href="#topic+approx_evdsi">approx_evdsi()</a></code>).
Finally, the greatest expected value is identified, and all survey schemes
that share this greatest expected value are returned. Due to the nature of
this algorithm, it can take a very long time to complete.
</p>


<h3>Value</h3>

<p>A <code>matrix</code> of <code>logical</code> (<code>TRUE</code>/ <code>FALSE</code>)
values indicating if a site is selected in the scheme or not. Columns
correspond to sites, and rows correspond to different schemes. If
there is only one optimal survey scheme then the <code>matrix</code> will only
contain a single row.
</p>
<p>This matrix also has a <code>numeric</code> <code>"ev"</code>
attribute that contains a matrix with the approximate expected values.
Within this attribute, each row corresponds to a different survey scheme
and each column corresponds to a different replicate.
</p>


<h3>Dependencies</h3>

<p>Please note that this function requires the Gurobi optimization software
(<a href="https://www.gurobi.com/">https://www.gurobi.com/</a>) and the <span class="pkg">gurobi</span> R package if different
sites have different survey costs. Installation instruction are available
online for Linux, Windows, and Mac OS
(see <a href="https://support.gurobi.com/hc/en-us/articles/4534161999889-How-do-I-install-Gurobi-Optimizer">https://support.gurobi.com/hc/en-us/articles/4534161999889-How-do-I-install-Gurobi-Optimizer</a>).
</p>


<h3>Examples</h3>

<pre><code class='language-R'># set seeds for reproducibility
set.seed(123)

# load example site data
data(sim_sites)
print(sim_sites)

# load example feature data
data(sim_features)
print(sim_features)

# set total budget for managing sites for conservation
 # (i.e. 50% of the cost of managing all sites)
total_budget &lt;- sum(sim_sites$management_cost) * 0.5

# set total budget for surveying sites for conservation
# (i.e. 40% of the cost of surveying all sites)
survey_budget &lt;- sum(sim_sites$survey_cost) * 0.4

## Not run: 
# find optimal survey scheme using approximate method
# (using 10 replicates so that this example completes relatively quickly)
approx_opt_survey &lt;- approx_optimal_survey_scheme(
  sim_sites, sim_features,
  c("f1", "f2", "f3"), c("n1", "n2", "n3"), c("p1", "p2", "p3"),
  "management_cost", "survey_cost",
  "survey", "survey_sensitivity", "survey_specificity",
  "model_sensitivity", "model_specificity",
  "target", total_budget, survey_budget)

# print result
print(approx_opt_survey)

## End(Not run)
</code></pre>

<hr>
<h2 id='env_div_survey_scheme'>Environmental diversity survey scheme</h2><span id='topic+env_div_survey_scheme'></span>

<h3>Description</h3>

<p>Generate a survey scheme by maximizing the diversity of environmental
conditions that are surveyed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>env_div_survey_scheme(
  site_data,
  cost_column,
  survey_budget,
  env_vars_columns,
  method = "mahalanobis",
  locked_in_column = NULL,
  locked_out_column = NULL,
  exclude_locked_out = FALSE,
  solver = "auto",
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="env_div_survey_scheme_+3A_site_data">site_data</code></td>
<td>
<p><code><a href="sf.html#topic+sf">sf::sf()</a></code> object containing the candidate survey
sites.</p>
</td></tr>
<tr><td><code id="env_div_survey_scheme_+3A_cost_column">cost_column</code></td>
<td>
<p><code>character</code> name of the column in the argument to
the argument to <code>site_data</code> that contains the cost for surveying each
site. No missing (<code>NA</code>) values are permitted.</p>
</td></tr>
<tr><td><code id="env_div_survey_scheme_+3A_survey_budget">survey_budget</code></td>
<td>
<p><code>numeric</code> vector of maximum budgets for the survey
schemes. No missing (<code>NA</code>) values are permitted.</p>
</td></tr>
<tr><td><code id="env_div_survey_scheme_+3A_env_vars_columns">env_vars_columns</code></td>
<td>
<p><code>character</code> vector names of the columns in
the argument to <code>site_data</code> that contain <code>numeric</code> environmental
variables. No missing (<code>NA</code>) values are permitted.</p>
</td></tr>
<tr><td><code id="env_div_survey_scheme_+3A_method">method</code></td>
<td>
<p><code>character</code> name of the distance metric to use for
calculating environmental dissimilarity scores. See
<code><a href="vegan.html#topic+vegdist">vegan::vegdist()</a></code> documentation the <code>method</code> parameter
for other available distance metrics and more information.
No missing (<code>NA</code>) values are permitted.
Defaults to <code>"mahalanobis"</code> for Mahalanobis distances.</p>
</td></tr>
<tr><td><code id="env_div_survey_scheme_+3A_locked_in_column">locked_in_column</code></td>
<td>
<p><code>character</code> (optional) name of the column in
the argument to <code>site_data</code> that contains <code>logical</code>
(<code>TRUE</code>/ <code>FALSE</code>) values indicating if certain sites should be
locked into the survey scheme.
No missing (<code>NA</code>) values are permitted.
Defaults to <code>NULL</code> such that no sites are locked in.</p>
</td></tr>
<tr><td><code id="env_div_survey_scheme_+3A_locked_out_column">locked_out_column</code></td>
<td>
<p><code>character</code> (optional) name of the column in
the argument to <code>site_data</code> that contains <code>logical</code>
(<code>TRUE</code>/ <code>FALSE</code>) values indicating if certain sites should be
locked out of the survey scheme.
No missing (<code>NA</code>) values are permitted.
Defaults to <code>NULL</code> such that no sites are locked out.</p>
</td></tr>
<tr><td><code id="env_div_survey_scheme_+3A_exclude_locked_out">exclude_locked_out</code></td>
<td>
<p><code>logical</code> should locked out planning units
be entirely excluded from the optimization process?
Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="env_div_survey_scheme_+3A_solver">solver</code></td>
<td>
<p><code>character</code> name of the optimization solver to use
for generating survey schemes.
Available options include: <code>"Rsymphony"</code>, <code>"gurobi"</code> and <code>"auto"</code>.
The <code>"auto"</code> method will use the Gurobi optimization software if
it is available; otherwise, it will use the SYMPHONY software
via the <span class="pkg">Rsymphony</span> package.
Defaults to <code>"auto"</code>.</p>
</td></tr>
<tr><td><code id="env_div_survey_scheme_+3A_verbose">verbose</code></td>
<td>
<p><code>logical</code> indicating if information should be
printed while generating survey scheme(s). Defaults to <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The integer programming formulation of the environmental diversity
reserve selection problem (Faith &amp; Walker 1996) is used to generate survey
schemes.
</p>


<h3>Value</h3>

<p>A <code>matrix</code> of <code>logical</code> (<code>TRUE</code>/ <code>FALSE</code>)
values indicating if a site is selected in a scheme or not. Columns
correspond to sites, and rows correspond to different schemes.
</p>


<h3>Solver</h3>

<p>This function can use the <span class="pkg">Rsymphony</span> package and
the <a href="https://www.gurobi.com/">Gurobi optimization software</a> to generate
survey schemes. Although the <span class="pkg">Rsymphony</span> package
is easier to install because it is freely available on the
The Comprehensive R Archive Network (CRAN), it is strongly recommended to
install the <a href="https://www.gurobi.com/">Gurobi optimization software</a> and the
<span class="pkg">gurobi</span> R package because it can generate survey schemes much faster.
Note that special academic licenses are available at no cost.
Installation instructions are <a href="https://support.gurobi.com/hc/en-us/articles/4534161999889-How-do-I-install-Gurobi-Optimizer">available online for Linux, Windows, and Mac OS operating systems</a>.
</p>


<h3>References</h3>

<p>Faith DP &amp; Walker PA (1996) Environmental diversity: on the best-possible
use of surrogate data for assessing the relative biodiversity of sets of
areas. <em>Biodiversity &amp; Conservation</em>, <strong>5</strong>, 399&ndash;415.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># set seed for reproducibility
set.seed(123)

# simulate data
 x &lt;- sf::st_as_sf(
   tibble::tibble(x = rnorm(4), y = rnorm(4),
                  v1 = c(0.1, 0.2, 0.3, 10), # environmental axis 1
                  v2 = c(0.1, 0.2, 0.3, 10), # environmental axis 2
                  cost = rep(1, 4)),
    coords = c("x", "y"))

# plot the sites' environmental conditions
plot(x[, c("v1", "v2")], pch = 16, cex = 3)

# generate scheme with a budget of 2
s &lt;- env_div_survey_scheme(x, "cost", 2, c("v1", "v2"), "mahalanobis")

# print scheme
print(s)

# plot scheme
x$scheme &lt;- c(s)
plot(x[, "scheme"], pch = 16, cex = 3)
</code></pre>

<hr>
<h2 id='evdci'>Expected value of the decision given current information</h2><span id='topic+evdci'></span>

<h3>Description</h3>

<p>Calculate the <em>expected value of the management decision
given current information</em>. This metric describes the value of the management
decision that is expected when the decision maker is limited to
existing biodiversity data (i.e. survey data and environmental niche models).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evdci(
  site_data,
  feature_data,
  site_detection_columns,
  site_n_surveys_columns,
  site_probability_columns,
  site_management_cost_column,
  feature_survey_sensitivity_column,
  feature_survey_specificity_column,
  feature_model_sensitivity_column,
  feature_model_specificity_column,
  feature_target_column,
  total_budget,
  site_management_locked_in_column = NULL,
  site_management_locked_out_column = NULL,
  prior_matrix = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="evdci_+3A_site_data">site_data</code></td>
<td>
<p><code><a href="sf.html#topic+sf">sf::sf()</a></code> object with site data.</p>
</td></tr>
<tr><td><code id="evdci_+3A_feature_data">feature_data</code></td>
<td>
<p><code><a href="base.html#topic+data.frame">base::data.frame()</a></code> object with feature data.</p>
</td></tr>
<tr><td><code id="evdci_+3A_site_detection_columns">site_detection_columns</code></td>
<td>
<p><code>character</code> names of <code>numeric</code>
columns in the argument to <code>site_data</code> that contain the proportion of
surveys conducted within each site that detected each feature.
Each column should correspond to a different feature, and contain
a proportion value (between zero and one). If a site has
not previously been surveyed, a value of zero should be used.</p>
</td></tr>
<tr><td><code id="evdci_+3A_site_n_surveys_columns">site_n_surveys_columns</code></td>
<td>
<p><code>character</code> names of <code>numeric</code>
columns in the argument to <code>site_data</code> that contain the total
number of surveys conducted for each each feature within each site.
Each column should correspond to a different feature, and contain
a non-negative integer number (e.g. 0, 1, 2, 3). If a site has
not previously been surveyed, a value of zero should be used.</p>
</td></tr>
<tr><td><code id="evdci_+3A_site_probability_columns">site_probability_columns</code></td>
<td>
<p><code>character</code> names of <code>numeric</code>
columns in the argument to <code>site_data</code> that contain modeled
probabilities of occupancy for each feature in each site.
Each column should correspond to a different feature, and contain
probability data (values between zero and one). No missing (<code>NA</code>)
values are permitted in these columns.</p>
</td></tr>
<tr><td><code id="evdci_+3A_site_management_cost_column">site_management_cost_column</code></td>
<td>
<p><code>character</code> name of column in the
argument to <code>site_data</code> that contains costs for managing each
site for conservation. This column should have <code>numeric</code> values that
are equal to or greater than zero. No missing (<code>NA</code>) values are
permitted in this column.</p>
</td></tr>
<tr><td><code id="evdci_+3A_feature_survey_sensitivity_column">feature_survey_sensitivity_column</code></td>
<td>
<p><code>character</code> name of the
column in the argument to <code>feature_data</code> that contains
probability of future surveys correctly detecting a presence of each
feature in a given site (i.e. the sensitivity of the survey methodology).
This column should have <code>numeric</code> values that are between zero and
one. No missing (<code>NA</code>) values are permitted in this column.</p>
</td></tr>
<tr><td><code id="evdci_+3A_feature_survey_specificity_column">feature_survey_specificity_column</code></td>
<td>
<p><code>character</code> name of the
column in the argument to <code>feature_data</code> that contains
probability of future surveys correctly detecting an absence of each
feature in a given site (i.e. the specificity of the survey methodology).
This column should have <code>numeric</code> values that are between zero and
one. No missing (<code>NA</code>) values are permitted in this column.</p>
</td></tr>
<tr><td><code id="evdci_+3A_feature_model_sensitivity_column">feature_model_sensitivity_column</code></td>
<td>
<p><code>character</code> name of the
column in the argument to <code>feature_data</code> that contains
probability of the initial models correctly predicting a presence of each
feature in a given site (i.e. the sensitivity of the models).
This column should have <code>numeric</code> values that are between zero and
one. No missing (<code>NA</code>) values are permitted in this column.
This should ideally be calculated using
<code><a href="#topic+fit_xgb_occupancy_models">fit_xgb_occupancy_models()</a></code> or
<code><a href="#topic+fit_hglm_occupancy_models">fit_hglm_occupancy_models()</a></code>.</p>
</td></tr>
<tr><td><code id="evdci_+3A_feature_model_specificity_column">feature_model_specificity_column</code></td>
<td>
<p><code>character</code> name of the
column in the argument to <code>feature_data</code> that contains
probability of the initial models correctly predicting an absence of each
feature in a given site (i.e. the specificity of the models).
This column should have <code>numeric</code> values that are between zero and
one. No missing (<code>NA</code>) values are permitted in this column.
This should ideally be calculated using
<code><a href="#topic+fit_xgb_occupancy_models">fit_xgb_occupancy_models()</a></code> or
<code><a href="#topic+fit_hglm_occupancy_models">fit_hglm_occupancy_models()</a></code>.</p>
</td></tr>
<tr><td><code id="evdci_+3A_feature_target_column">feature_target_column</code></td>
<td>
<p><code>character</code> name of the column in the
argument to <code>feature_data</code> that contains the <code class="reqn">target</code>
values used to parametrize the conservation benefit of managing of each
feature.
This column should have <code>numeric</code> values that
are equal to or greater than zero. No missing (<code>NA</code>) values are
permitted in this column.</p>
</td></tr>
<tr><td><code id="evdci_+3A_total_budget">total_budget</code></td>
<td>
<p><code>numeric</code> maximum expenditure permitted
for conducting surveys and managing sites for conservation.</p>
</td></tr>
<tr><td><code id="evdci_+3A_site_management_locked_in_column">site_management_locked_in_column</code></td>
<td>
<p><code>character</code> name of the column
in the argument to <code>site_data</code> that contains <code>logical</code>
(<code>TRUE</code> / <code>FALSE</code>) values indicating which sites should
be locked in for (<code>TRUE</code>) being managed for conservation or
(<code>FALSE</code>) not. No missing (<code>NA</code>) values are permitted in this
column. This is useful if some sites have already been earmarked for
conservation, or if some sites are already being managed for conservation.
Defaults to <code>NULL</code> such that no sites are locked in.</p>
</td></tr>
<tr><td><code id="evdci_+3A_site_management_locked_out_column">site_management_locked_out_column</code></td>
<td>
<p><code>character</code> name of the column
in the argument to <code>site_data</code> that contains <code>logical</code>
(<code>TRUE</code> / <code>FALSE</code>) values indicating which sites should
be locked out for (<code>TRUE</code>) being managed for conservation or
(<code>FALSE</code>) not. No missing (<code>NA</code>) values are permitted in this
column. This is useful if some sites could potentially be surveyed
to improve model predictions even if they cannot be managed for
conservation. Defaults to <code>NULL</code> such that no sites are locked out.</p>
</td></tr>
<tr><td><code id="evdci_+3A_prior_matrix">prior_matrix</code></td>
<td>
<p><code>numeric</code> <code>matrix</code> containing
the prior probability of each feature occupying each site.
Rows correspond to features, and columns correspond to sites.
Defaults to <code>NULL</code> such that prior data is calculated automatically
using <code><a href="#topic+prior_probability_matrix">prior_probability_matrix()</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calculates the expected value and does not
use approximation methods. As such, this function can only be applied
to very small problems.
</p>


<h3>Value</h3>

<p>A <code>numeric</code> value.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+prior_probability_matrix">prior_probability_matrix()</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># set seeds for reproducibility
set.seed(123)

# load example site data
data(sim_sites)
print(sim_sites)

# load example feature data
data(sim_features)
print(sim_features)

# set total budget for managing sites for conservation
 # (i.e. 50% of the cost of managing all sites)
total_budget &lt;- sum(sim_sites$management_cost) * 0.5

# calculate expected value of management decision given current information
# using exact method
ev_current &lt;- evdci(
  sim_sites, sim_features,
  c("f1", "f2", "f3"), c("n1", "n2", "n3"), c("p1", "p2", "p3"),
  "management_cost", "survey_sensitivity", "survey_specificity",
  "model_sensitivity", "model_specificity",
  "target", total_budget)

# print exact value
print(ev_current)
</code></pre>

<hr>
<h2 id='evdsi'>Expected value of the decision given survey information</h2><span id='topic+evdsi'></span>

<h3>Description</h3>

<p>Calculate the <em>expected value of the management decision
given survey information</em>. This metric describes the value of the management
decision that is expected when the decision maker surveys a
set of sites to help inform the decision.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evdsi(
  site_data,
  feature_data,
  site_detection_columns,
  site_n_surveys_columns,
  site_probability_columns,
  site_management_cost_column,
  site_survey_scheme_column,
  site_survey_cost_column,
  feature_survey_column,
  feature_survey_sensitivity_column,
  feature_survey_specificity_column,
  feature_model_sensitivity_column,
  feature_model_specificity_column,
  feature_target_column,
  total_budget,
  site_management_locked_in_column = NULL,
  site_management_locked_out_column = NULL,
  prior_matrix = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="evdsi_+3A_site_data">site_data</code></td>
<td>
<p><code><a href="sf.html#topic+sf">sf::sf()</a></code> object with site data.</p>
</td></tr>
<tr><td><code id="evdsi_+3A_feature_data">feature_data</code></td>
<td>
<p><code><a href="base.html#topic+data.frame">base::data.frame()</a></code> object with feature data.</p>
</td></tr>
<tr><td><code id="evdsi_+3A_site_detection_columns">site_detection_columns</code></td>
<td>
<p><code>character</code> names of <code>numeric</code>
columns in the argument to <code>site_data</code> that contain the proportion of
surveys conducted within each site that detected each feature.
Each column should correspond to a different feature, and contain
a proportion value (between zero and one). If a site has
not previously been surveyed, a value of zero should be used.</p>
</td></tr>
<tr><td><code id="evdsi_+3A_site_n_surveys_columns">site_n_surveys_columns</code></td>
<td>
<p><code>character</code> names of <code>numeric</code>
columns in the argument to <code>site_data</code> that contain the total
number of surveys conducted for each each feature within each site.
Each column should correspond to a different feature, and contain
a non-negative integer number (e.g. 0, 1, 2, 3). If a site has
not previously been surveyed, a value of zero should be used.</p>
</td></tr>
<tr><td><code id="evdsi_+3A_site_probability_columns">site_probability_columns</code></td>
<td>
<p><code>character</code> names of <code>numeric</code>
columns in the argument to <code>site_data</code> that contain modeled
probabilities of occupancy for each feature in each site.
Each column should correspond to a different feature, and contain
probability data (values between zero and one). No missing (<code>NA</code>)
values are permitted in these columns.</p>
</td></tr>
<tr><td><code id="evdsi_+3A_site_management_cost_column">site_management_cost_column</code></td>
<td>
<p><code>character</code> name of column in the
argument to <code>site_data</code> that contains costs for managing each
site for conservation. This column should have <code>numeric</code> values that
are equal to or greater than zero. No missing (<code>NA</code>) values are
permitted in this column.</p>
</td></tr>
<tr><td><code id="evdsi_+3A_site_survey_scheme_column">site_survey_scheme_column</code></td>
<td>
<p><code>character</code> name of <code>logical</code>
(<code>TRUE</code> / <code>FALSE</code>) column in the argument to <code>site_data</code>
that indicates which sites are selected in the scheme or not.
No missing <code>NA</code> values are permitted. Additionally, only sites
that are missing data can be selected or surveying (as per the
argument to <code>site_detection_columns</code>).</p>
</td></tr>
<tr><td><code id="evdsi_+3A_site_survey_cost_column">site_survey_cost_column</code></td>
<td>
<p><code>character</code> name of column in the
argument to  <code>site_data</code> that contains costs for surveying each
site. This column should have <code>numeric</code> values that are equal to
or greater than zero. No missing (<code>NA</code>) values are permitted in this
column.</p>
</td></tr>
<tr><td><code id="evdsi_+3A_feature_survey_column">feature_survey_column</code></td>
<td>
<p><code>character</code> name of the column in the
argument to <code>feature_data</code> that contains <code>logical</code> (<code>TRUE</code> /
<code>FALSE</code>) values indicating if the feature will be surveyed in
the planned surveys or not. Note that considering additional features will
rapidly increase computational burden, and so it is only recommended to
consider features that are of specific conservation interest.
No missing (<code>NA</code>) values are permitted in this column.</p>
</td></tr>
<tr><td><code id="evdsi_+3A_feature_survey_sensitivity_column">feature_survey_sensitivity_column</code></td>
<td>
<p><code>character</code> name of the
column in the argument to <code>feature_data</code> that contains
probability of future surveys correctly detecting a presence of each
feature in a given site (i.e. the sensitivity of the survey methodology).
This column should have <code>numeric</code> values that are between zero and
one. No missing (<code>NA</code>) values are permitted in this column.</p>
</td></tr>
<tr><td><code id="evdsi_+3A_feature_survey_specificity_column">feature_survey_specificity_column</code></td>
<td>
<p><code>character</code> name of the
column in the argument to <code>feature_data</code> that contains
probability of future surveys correctly detecting an absence of each
feature in a given site (i.e. the specificity of the survey methodology).
This column should have <code>numeric</code> values that are between zero and
one. No missing (<code>NA</code>) values are permitted in this column.</p>
</td></tr>
<tr><td><code id="evdsi_+3A_feature_model_sensitivity_column">feature_model_sensitivity_column</code></td>
<td>
<p><code>character</code> name of the
column in the argument to <code>feature_data</code> that contains
probability of the initial models correctly predicting a presence of each
feature in a given site (i.e. the sensitivity of the models).
This column should have <code>numeric</code> values that are between zero and
one. No missing (<code>NA</code>) values are permitted in this column.
This should ideally be calculated using
<code><a href="#topic+fit_xgb_occupancy_models">fit_xgb_occupancy_models()</a></code> or
<code><a href="#topic+fit_hglm_occupancy_models">fit_hglm_occupancy_models()</a></code>.</p>
</td></tr>
<tr><td><code id="evdsi_+3A_feature_model_specificity_column">feature_model_specificity_column</code></td>
<td>
<p><code>character</code> name of the
column in the argument to <code>feature_data</code> that contains
probability of the initial models correctly predicting an absence of each
feature in a given site (i.e. the specificity of the models).
This column should have <code>numeric</code> values that are between zero and
one. No missing (<code>NA</code>) values are permitted in this column.
This should ideally be calculated using
<code><a href="#topic+fit_xgb_occupancy_models">fit_xgb_occupancy_models()</a></code> or
<code><a href="#topic+fit_hglm_occupancy_models">fit_hglm_occupancy_models()</a></code>.</p>
</td></tr>
<tr><td><code id="evdsi_+3A_feature_target_column">feature_target_column</code></td>
<td>
<p><code>character</code> name of the column in the
argument to <code>feature_data</code> that contains the <code class="reqn">target</code>
values used to parametrize the conservation benefit of managing of each
feature.
This column should have <code>numeric</code> values that
are equal to or greater than zero. No missing (<code>NA</code>) values are
permitted in this column.</p>
</td></tr>
<tr><td><code id="evdsi_+3A_total_budget">total_budget</code></td>
<td>
<p><code>numeric</code> maximum expenditure permitted
for conducting surveys and managing sites for conservation.</p>
</td></tr>
<tr><td><code id="evdsi_+3A_site_management_locked_in_column">site_management_locked_in_column</code></td>
<td>
<p><code>character</code> name of the column
in the argument to <code>site_data</code> that contains <code>logical</code>
(<code>TRUE</code> / <code>FALSE</code>) values indicating which sites should
be locked in for (<code>TRUE</code>) being managed for conservation or
(<code>FALSE</code>) not. No missing (<code>NA</code>) values are permitted in this
column. This is useful if some sites have already been earmarked for
conservation, or if some sites are already being managed for conservation.
Defaults to <code>NULL</code> such that no sites are locked in.</p>
</td></tr>
<tr><td><code id="evdsi_+3A_site_management_locked_out_column">site_management_locked_out_column</code></td>
<td>
<p><code>character</code> name of the column
in the argument to <code>site_data</code> that contains <code>logical</code>
(<code>TRUE</code> / <code>FALSE</code>) values indicating which sites should
be locked out for (<code>TRUE</code>) being managed for conservation or
(<code>FALSE</code>) not. No missing (<code>NA</code>) values are permitted in this
column. This is useful if some sites could potentially be surveyed
to improve model predictions even if they cannot be managed for
conservation. Defaults to <code>NULL</code> such that no sites are locked out.</p>
</td></tr>
<tr><td><code id="evdsi_+3A_prior_matrix">prior_matrix</code></td>
<td>
<p><code>numeric</code> <code>matrix</code> containing
the prior probability of each feature occupying each site.
Rows correspond to features, and columns correspond to sites.
Defaults to <code>NULL</code> such that prior data is calculated automatically
using <code><a href="#topic+prior_probability_matrix">prior_probability_matrix()</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calculates the expected value and does not
use approximation methods. As such, this function can only be applied
to very small problems.
</p>


<h3>Value</h3>

<p>A <code>numeric</code> value.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+prior_probability_matrix">prior_probability_matrix()</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># set seeds for reproducibility
set.seed(123)

# load example site data
data(sim_sites)
print(sim_sites)

# load example feature data
data(sim_features)
print(sim_features)

# set total budget for managing sites for conservation
 # (i.e. 50% of the cost of managing all sites)
total_budget &lt;- sum(sim_sites$management_cost) * 0.5

# create a survey scheme that samples the first two sites that
# are missing data
sim_sites$survey_site &lt;- FALSE
sim_sites$survey_site[which(sim_sites$n1 &lt; 0.5)[1:2]] &lt;- TRUE

# calculate expected value of management decision given the survey
# information using exact method
ev_survey &lt;- evdsi(
  sim_sites, sim_features,
  c("f1", "f2", "f3"), c("n1", "n2", "n3"), c("p1", "p2", "p3"),
  "management_cost", "survey_site",
  "survey_cost", "survey", "survey_sensitivity", "survey_specificity",
  "model_sensitivity", "model_specificity",
  "target", total_budget)

# print value
print(ev_survey)
</code></pre>

<hr>
<h2 id='feasible_survey_schemes'>Find all feasible survey schemes</h2><span id='topic+feasible_survey_schemes'></span>

<h3>Description</h3>

<p>Generate a <code>matrix</code> representing all possible different
survey schemes given survey costs and a fixed budget.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>feasible_survey_schemes(
  site_data,
  cost_column,
  survey_budget,
  locked_in_column = NULL,
  locked_out_column = NULL,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="feasible_survey_schemes_+3A_site_data">site_data</code></td>
<td>
<p><code><a href="sf.html#topic+sf">sf::sf()</a></code> object containing the candidate survey
sites.</p>
</td></tr>
<tr><td><code id="feasible_survey_schemes_+3A_cost_column">cost_column</code></td>
<td>
<p><code>character</code> name of the column in the argument to
the argument to <code>site_data</code> that contains the cost for surveying each
site. No missing (<code>NA</code>) values are permitted.</p>
</td></tr>
<tr><td><code id="feasible_survey_schemes_+3A_survey_budget">survey_budget</code></td>
<td>
<p><code>numeric</code> the maximum possible expenditure
permitted for conducting surveys.</p>
</td></tr>
<tr><td><code id="feasible_survey_schemes_+3A_locked_in_column">locked_in_column</code></td>
<td>
<p><code>character</code> (optional) name of the column in
the argument to <code>site_data</code> that contains <code>logical</code>
(<code>TRUE</code>/ <code>FALSE</code>) values indicating if certain sites should be
locked into the survey scheme.
No missing (<code>NA</code>) values are permitted.
Defaults to <code>NULL</code> such that no sites are locked in.</p>
</td></tr>
<tr><td><code id="feasible_survey_schemes_+3A_locked_out_column">locked_out_column</code></td>
<td>
<p><code>character</code> (optional) name of the column in
the argument to <code>site_data</code> that contains <code>logical</code>
(<code>TRUE</code>/ <code>FALSE</code>) values indicating if certain sites should be
locked out of the survey scheme.
No missing (<code>NA</code>) values are permitted.
Defaults to <code>NULL</code> such that no sites are locked out.</p>
</td></tr>
<tr><td><code id="feasible_survey_schemes_+3A_verbose">verbose</code></td>
<td>
<p><code>logical</code> indicating if information should be
printed while searching for feasible schemes. Defaults to <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>matrix</code> where each row corresponds to a different
survey scheme, and each column corresponds to a different planning unit.
Cell values are <code>logical</code> (<code>TRUE</code> / <code>FALSE</code>) indicating
if a given site is selected in a given survey scheme.
</p>


<h3>Dependencies</h3>

<p>Please note that this function requires the Gurobi optimization software
(<a href="https://www.gurobi.com/">https://www.gurobi.com/</a>) and the <span class="pkg">gurobi</span> R package if different
sites have different survey costs. Installation instruction are available
online for Linux, Windows, and Mac OS
(see <a href="https://support.gurobi.com/hc/en-us/articles/4534161999889-How-do-I-install-Gurobi-Optimizer">https://support.gurobi.com/hc/en-us/articles/4534161999889-How-do-I-install-Gurobi-Optimizer</a>).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# set seed for reproducibility
set.seed(123)

# simulate data
x &lt;- sf::st_as_sf(tibble::tibble(x = rnorm(4), y = rnorm(4),
                                 cost = c(100, 200, 0.2, 1)),
                  coords = c("x", "y"))

# print data
print(x)

# plot site locations
plot(st_geometry(x), pch = 16, cex = 3)

# generate all feasible schemes given a budget of 4
s &lt;- feasible_survey_schemes(x, "cost", survey_budget = 4)

# print schemes
print(s)

# plot first scheme
x$scheme_1 &lt;- s[1, ]
plot(x[, "scheme_1"], pch = 16, cex = 3)

## End(Not run)
</code></pre>

<hr>
<h2 id='fit_hglm_occupancy_models'>Fit hierarchical generalized linear models to predict occupancy</h2><span id='topic+fit_hglm_occupancy_models'></span>

<h3>Description</h3>

<p>Estimate probability of occupancy for a set of features in a set of
planning units. Models are fitted as hierarchical generalized linear models
that account for for imperfect detection (following Royle &amp; Link 2006)
using JAGS (via <code><a href="runjags.html#topic+run.jags">runjags::run.jags()</a></code>). To limit over-fitting,
covariate coefficients are sampled using a Laplace prior distribution
(equivalent to L1 regularization used in machine learning contexts)
(Park &amp; Casella 2008).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_hglm_occupancy_models(
  site_data,
  feature_data,
  site_detection_columns,
  site_n_surveys_columns,
  site_env_vars_columns,
  feature_survey_sensitivity_column,
  feature_survey_specificity_column,
  jags_n_samples = rep(10000, length(site_detection_columns)),
  jags_n_burnin = rep(1000, length(site_detection_columns)),
  jags_n_thin = rep(100, length(site_detection_columns)),
  jags_n_adapt = rep(1000, length(site_detection_columns)),
  jags_n_chains = rep(4, length(site_detection_columns)),
  n_folds = rep(5, length(site_detection_columns)),
  n_threads = 1,
  seed = 500,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_hglm_occupancy_models_+3A_site_data">site_data</code></td>
<td>
<p><code><a href="sf.html#topic+sf">sf::sf()</a></code> object with site data.</p>
</td></tr>
<tr><td><code id="fit_hglm_occupancy_models_+3A_feature_data">feature_data</code></td>
<td>
<p><code><a href="base.html#topic+data.frame">base::data.frame()</a></code> object with feature data.</p>
</td></tr>
<tr><td><code id="fit_hglm_occupancy_models_+3A_site_detection_columns">site_detection_columns</code></td>
<td>
<p><code>character</code> names of <code>numeric</code>
columns in the argument to <code>site_data</code> that contain the proportion of
surveys conducted within each site that detected each feature.
Each column should correspond to a different feature, and contain
a proportion value (between zero and one). If a site has
not previously been surveyed, a value of zero should be used.</p>
</td></tr>
<tr><td><code id="fit_hglm_occupancy_models_+3A_site_n_surveys_columns">site_n_surveys_columns</code></td>
<td>
<p><code>character</code> names of <code>numeric</code>
columns in the argument to <code>site_data</code> that contain the total
number of surveys conducted for each each feature within each site.
Each column should correspond to a different feature, and contain
a non-negative integer number (e.g. 0, 1, 2, 3). If a site has
not previously been surveyed, a value of zero should be used.</p>
</td></tr>
<tr><td><code id="fit_hglm_occupancy_models_+3A_site_env_vars_columns">site_env_vars_columns</code></td>
<td>
<p><code>character</code> names of columns in the
argument to <code>site_data</code> that contain environmental information
for fitting updated occupancy models based on possible survey outcomes.
Each column should correspond to a different environmental variable,
and contain <code>numeric</code>, <code>factor</code>, or <code>character</code> data.
No missing (<code>NA</code>) values are permitted in these columns.</p>
</td></tr>
<tr><td><code id="fit_hglm_occupancy_models_+3A_feature_survey_sensitivity_column">feature_survey_sensitivity_column</code></td>
<td>
<p><code>character</code> name of the
column in the argument to <code>feature_data</code> that contains
probability of future surveys correctly detecting a presence of each
feature in a given site (i.e. the sensitivity of the survey methodology).
This column should have <code>numeric</code> values that are between zero and
one. No missing (<code>NA</code>) values are permitted in this column.</p>
</td></tr>
<tr><td><code id="fit_hglm_occupancy_models_+3A_feature_survey_specificity_column">feature_survey_specificity_column</code></td>
<td>
<p><code>character</code> name of the
column in the argument to <code>feature_data</code> that contains
probability of future surveys correctly detecting an absence of each
feature in a given site (i.e. the specificity of the survey methodology).
This column should have <code>numeric</code> values that are between zero and
one. No missing (<code>NA</code>) values are permitted in this column.</p>
</td></tr>
<tr><td><code id="fit_hglm_occupancy_models_+3A_jags_n_samples">jags_n_samples</code></td>
<td>
<p><code>integer</code> number of sample to generate per chain
for MCMC analyses.
See documentation for the <code>sample</code> parameter
in <code><a href="runjags.html#topic+run.jags">runjags::run.jags()</a></code> for more information).
Defaults to 10,000 for each feature.</p>
</td></tr>
<tr><td><code id="fit_hglm_occupancy_models_+3A_jags_n_burnin">jags_n_burnin</code></td>
<td>
<p><code>integer</code> number of warm up iterations for MCMC
analyses.
See documentation for the <code>burnin</code> parameter
in <code><a href="runjags.html#topic+run.jags">runjags::run.jags()</a></code> for more information).
Defaults to 10,000 for each feature.</p>
</td></tr>
<tr><td><code id="fit_hglm_occupancy_models_+3A_jags_n_thin">jags_n_thin</code></td>
<td>
<p><code>integer</code> number of thinning iterations for MCMC
analyses.
See documentation for the <code>thin</code> parameter
in <code><a href="runjags.html#topic+run.jags">runjags::run.jags()</a></code> for more information).
Defaults to 100 for each feature.</p>
</td></tr>
<tr><td><code id="fit_hglm_occupancy_models_+3A_jags_n_adapt">jags_n_adapt</code></td>
<td>
<p><code>integer</code> number of adapting iterations for MCMC
analyses.
See documentation for the <code>adapt</code> parameter
in <code><a href="runjags.html#topic+run.jags">runjags::run.jags()</a></code> for more information).
Defaults to 1,000 for each feature.</p>
</td></tr>
<tr><td><code id="fit_hglm_occupancy_models_+3A_jags_n_chains">jags_n_chains</code></td>
<td>
<p><code>integer</code> total number of chains for MCMC analyses.
See documentation for the <code>n.chains</code> parameter
in <code><a href="runjags.html#topic+run.jags">runjags::run.jags()</a></code> for more information).
Defaults to 4 for each fold for each feature.</p>
</td></tr>
<tr><td><code id="fit_hglm_occupancy_models_+3A_n_folds">n_folds</code></td>
<td>
<p><code>numeric</code> number of folds to split the training
data into when fitting models for each feature.
Defaults to 5 for each feature.</p>
</td></tr>
<tr><td><code id="fit_hglm_occupancy_models_+3A_n_threads">n_threads</code></td>
<td>
<p><code>integer</code> number of threads to use for parameter
tuning. Defaults to 1.</p>
</td></tr>
<tr><td><code id="fit_hglm_occupancy_models_+3A_seed">seed</code></td>
<td>
<p><code>integer</code> initial random number generator state for model
fitting. Defaults to 500.</p>
</td></tr>
<tr><td><code id="fit_hglm_occupancy_models_+3A_verbose">verbose</code></td>
<td>
<p><code>logical</code> indicating if information should be
printed during computations. Defaults to <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function (i) prepares the data for model fitting,
(ii) fits the models, and (iii) assesses the performance of the
models. These analyses are performed separately for each
feature. For a given feature:
</p>

<ol>
<li><p> The data are prepared for model fitting by partitioning the data using
k-fold cross-validation (set via argument to <code>n_folds</code>). The
training and evaluation folds are constructed
in such a manner as to ensure that each training and evaluation
fold contains at least one presence and one absence observation.
</p>
</li>
<li><p> A model for fit separately for each fold (see
<code>inst/jags/model.jags</code> for model code). To assess convergence,
the multi-variate potential scale reduction factor
(MPSRF) statistic is calculated for each model.
</p>
</li>
<li><p> The performance of the cross-validation models is evaluated.
Specifically, the TSS, sensitivity, and specificity statistics are
calculated (if relevant, weighted by the argument to
<code>site_weights_data</code>). These performance values are calculated using
the models' training and evaluation folds. To assess convergence,
the maximum MPSRF statistic for the models fit for each feature
is calculated.
</p>
</li></ol>



<h3>Value</h3>

<p>A <code>list</code> object containing:
</p>

<dl>
<dt>models</dt><dd><p><code>list</code> of <code>list</code> objects containing the models.</p>
</dd>
<dt>predictions</dt><dd><p><code><a href="tibble.html#topic+tibble">tibble::tibble()</a></code> object containing
predictions for each feature.</p>
</dd>
<dt>performance</dt><dd><p><code><a href="tibble.html#topic+tibble">tibble::tibble()</a></code> object containing the
performance of the best models for each feature. It contains the following
columns:
</p>

<dl>
<dt>feature</dt><dd><p>name of the feature.</p>
</dd>
<dt>max_mpsrf</dt><dd><p>maximum multi-variate potential scale reduction factor
(MPSRF) value for the models. A MPSRF value less than 1.05 means that all
coefficients in a given model have converged, and so a value less than
1.05 in this column means that all the models fit for a given feature
have successfully converged.</p>
</dd>
<dt>train_tss_mean</dt><dd>
<p>mean TSS statistic for models calculated using training data in
cross-validation.</p>
</dd>
<dt>train_tss_std</dt><dd>
<p>standard deviation in TSS statistics for models calculated using training
data in cross-validation.</p>
</dd>
<dt>train_sensitivity_mean</dt><dd>
<p>mean sensitivity statistic for models calculated using training data in
cross-validation.</p>
</dd>
<dt>train_sensitivity_std</dt><dd>
<p>standard deviation in sensitivity statistics for models calculated using
training data in cross-validation.</p>
</dd>
<dt>train_specificity_mean</dt><dd>
<p>mean specificity statistic for models calculated using training data in
cross-validation.</p>
</dd>
<dt>train_specificity_std</dt><dd>
<p>standard deviation in specificity statistics for models calculated using
training data in cross-validation.</p>
</dd>
<dt>test_tss_mean</dt><dd>
<p>mean TSS statistic for models calculated using test data in
cross-validation.</p>
</dd>
<dt>test_tss_std</dt><dd>
<p>standard deviation in TSS statistics for models calculated using test
data in cross-validation.</p>
</dd>
<dt>test_sensitivity_mean</dt><dd>
<p>mean sensitivity statistic for models calculated using test data in
cross-validation.</p>
</dd>
<dt>test_sensitivity_std</dt><dd>
<p>standard deviation in sensitivity statistics for models calculated using
test data in cross-validation.</p>
</dd>
<dt>test_specificity_mean</dt><dd>
<p>mean specificity statistic for models calculated using test data in
cross-validation.</p>
</dd>
<dt>test_specificity_std</dt><dd>
<p>standard deviation in specificity statistics for models calculated using
test data in cross-validation.</p>
</dd>
</dl>
</dd>
</dl>



<h3>Dependencies</h3>

<p>This function requires the
<a href="https://mcmc-jags.sourceforge.io/">JAGS software</a> to be installed.
For information on installing the JAGS software, please consult
the documentation for the <span class="pkg">rjags</span> package.
</p>


<h3>References</h3>

<p>Park T &amp; Casella G (2008) The Bayesian lasso.
<em>Journal of the American Statistical Association</em>, 103: 681&ndash;686.
</p>
<p>Royle JA &amp; Link WA (2006) Generalized site occupancy models allowing for
false positive and false negative errors. <em>Ecology</em>, 87: 835&ndash;841.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# set seeds for reproducibility
set.seed(123)

# simulate data for 200 sites, 2 features, and 3 environmental variables
site_data &lt;- simulate_site_data(n_sites = 30, n_features = 2, prop = 0.1)
feature_data &lt;- simulate_feature_data(n_features = 2, prop = 1)

# print JAGS model code
cat(readLines(system.file("jags", "model.jags", package = "surveyvoi")),
    sep = "\n")

# fit models
# note that we use a small number of MCMC iterations so that the example
# finishes quickly, you probably want to use the defaults for real work
results &lt;- fit_hglm_occupancy_models(
   site_data, feature_data,
   c("f1", "f2"), c("n1", "n2"), c("e1", "e2", "e3"),
   "survey_sensitivity", "survey_specificity",
   n_folds = rep(5, 2),
   jags_n_samples = rep(250, 2), jags_n_burnin = rep(250, 2),
   jags_n_thin = rep(1, 2), jags_n_adapt = rep(100, 2),
   n_threads = 1)

# print model predictions
print(results$predictions)

# print model performance
print(results$performance, width = Inf)

## End(Not run)
</code></pre>

<hr>
<h2 id='fit_xgb_occupancy_models'>Fit boosted regression tree models to predict occupancy</h2><span id='topic+fit_xgb_occupancy_models'></span>

<h3>Description</h3>

<p>Estimate probability of occupancy for a set of features in a set of
planning units. Models are fitted using gradient boosted trees (via
<code><a href="xgboost.html#topic+xgb.train">xgboost::xgb.train()</a></code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_xgb_occupancy_models(
  site_data,
  feature_data,
  site_detection_columns,
  site_n_surveys_columns,
  site_env_vars_columns,
  feature_survey_sensitivity_column,
  feature_survey_specificity_column,
  xgb_tuning_parameters,
  xgb_early_stopping_rounds = rep(20, length(site_detection_columns)),
  xgb_n_rounds = rep(100, length(site_detection_columns)),
  n_folds = rep(5, length(site_detection_columns)),
  n_threads = 1,
  seed = 500,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_xgb_occupancy_models_+3A_site_data">site_data</code></td>
<td>
<p><code><a href="sf.html#topic+sf">sf::sf()</a></code> object with site data.</p>
</td></tr>
<tr><td><code id="fit_xgb_occupancy_models_+3A_feature_data">feature_data</code></td>
<td>
<p><code><a href="base.html#topic+data.frame">base::data.frame()</a></code> object with feature data.</p>
</td></tr>
<tr><td><code id="fit_xgb_occupancy_models_+3A_site_detection_columns">site_detection_columns</code></td>
<td>
<p><code>character</code> names of <code>numeric</code>
columns in the argument to <code>site_data</code> that contain the proportion of
surveys conducted within each site that detected each feature.
Each column should correspond to a different feature, and contain
a proportion value (between zero and one). If a site has
not previously been surveyed, a value of zero should be used.</p>
</td></tr>
<tr><td><code id="fit_xgb_occupancy_models_+3A_site_n_surveys_columns">site_n_surveys_columns</code></td>
<td>
<p><code>character</code> names of <code>numeric</code>
columns in the argument to <code>site_data</code> that contain the total
number of surveys conducted for each each feature within each site.
Each column should correspond to a different feature, and contain
a non-negative integer number (e.g. 0, 1, 2, 3). If a site has
not previously been surveyed, a value of zero should be used.</p>
</td></tr>
<tr><td><code id="fit_xgb_occupancy_models_+3A_site_env_vars_columns">site_env_vars_columns</code></td>
<td>
<p><code>character</code> names of columns in the
argument to <code>site_data</code> that contain environmental information
for fitting updated occupancy models based on possible survey outcomes.
Each column should correspond to a different environmental variable,
and contain <code>numeric</code>, <code>factor</code>, or <code>character</code> data.
No missing (<code>NA</code>) values are permitted in these columns.</p>
</td></tr>
<tr><td><code id="fit_xgb_occupancy_models_+3A_feature_survey_sensitivity_column">feature_survey_sensitivity_column</code></td>
<td>
<p><code>character</code> name of the
column in the argument to <code>feature_data</code> that contains
probability of future surveys correctly detecting a presence of each
feature in a given site (i.e. the sensitivity of the survey methodology).
This column should have <code>numeric</code> values that are between zero and
one. No missing (<code>NA</code>) values are permitted in this column.</p>
</td></tr>
<tr><td><code id="fit_xgb_occupancy_models_+3A_feature_survey_specificity_column">feature_survey_specificity_column</code></td>
<td>
<p><code>character</code> name of the
column in the argument to <code>feature_data</code> that contains
probability of future surveys correctly detecting an absence of each
feature in a given site (i.e. the specificity of the survey methodology).
This column should have <code>numeric</code> values that are between zero and
one. No missing (<code>NA</code>) values are permitted in this column.</p>
</td></tr>
<tr><td><code id="fit_xgb_occupancy_models_+3A_xgb_tuning_parameters">xgb_tuning_parameters</code></td>
<td>
<p><code>list</code> object containing the candidate
parameter values for fitting models. Valid parameters include:
<code>"max_depth"</code>, <code>"eta"</code>, <code>"lambda"</code>,
<code>"min_child_weight"</code>, <code>"subsample"</code>, <code>"colsample_by_tree"</code>,
<code>"objective"</code>. See documentation for the <code>params</code> argument in
<code><a href="xgboost.html#topic+xgb.train">xgboost::xgb.train()</a></code> for more information.</p>
</td></tr>
<tr><td><code id="fit_xgb_occupancy_models_+3A_xgb_early_stopping_rounds">xgb_early_stopping_rounds</code></td>
<td>
<p><code>numeric</code> model rounds for parameter
tuning. See <code><a href="xgboost.html#topic+xgb.train">xgboost::xgboost()</a></code> for more information.
Defaults to 10 for each feature.</p>
</td></tr>
<tr><td><code id="fit_xgb_occupancy_models_+3A_xgb_n_rounds">xgb_n_rounds</code></td>
<td>
<p><code>numeric</code> model rounds for model fitting
See <code><a href="xgboost.html#topic+xgb.train">xgboost::xgboost()</a></code> for more information.
Defaults to 100 for each feature.</p>
</td></tr>
<tr><td><code id="fit_xgb_occupancy_models_+3A_n_folds">n_folds</code></td>
<td>
<p><code>numeric</code> number of folds to split the training
data into when fitting models for each feature.
Defaults to 5 for each feature.</p>
</td></tr>
<tr><td><code id="fit_xgb_occupancy_models_+3A_n_threads">n_threads</code></td>
<td>
<p><code>integer</code> number of threads to use for parameter
tuning. Defaults to 1.</p>
</td></tr>
<tr><td><code id="fit_xgb_occupancy_models_+3A_seed">seed</code></td>
<td>
<p><code>integer</code> initial random number generator state for model
fitting. Defaults to 500.</p>
</td></tr>
<tr><td><code id="fit_xgb_occupancy_models_+3A_verbose">verbose</code></td>
<td>
<p><code>logical</code> indicating if information should be
printed during computations. Defaults to <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function (i) prepares the data for model fitting, (ii) calibrates
the tuning parameters for model fitting (see <code><a href="xgboost.html#topic+xgb.train">xgboost::xgb.train()</a></code>
for details on tuning parameters), (iii) generate predictions using
the best found tuning parameters, and (iv) assess the performance of the
best supported models. These analyses are performed separately for each
feature. For a given feature:
</p>

<ol>
<li><p> The data are prepared for model fitting by partitioning the data using
k-fold cross-validation (set via argument to <code>n_folds</code>). The
training and evaluation folds are constructed
in such a manner as to ensure that each training and evaluation
fold contains at least one presence and one absence observation.
</p>
</li>
<li><p> A grid search method is used to tune the model parameters. The
candidate values for each parameter (specified via <code>parameters</code>) are
used to generate a full set of parameter combinations, and these
parameter combinations are subsequently used for tuning the models.
To account for unbalanced datasets, the
<code>scale_pos_weight</code> <code><a href="xgboost.html#topic+xgb.train">xgboost::xgboost()</a></code> parameter
is calculated as the mean value across each of the training folds
(i.e. number of absence divided by number of presences per feature).
For a given parameter combination, models are fit using k-fold cross-
validation (via <code><a href="xgboost.html#topic+xgb.cv">xgboost::xgb.cv()</a></code>) &ndash; using the previously
mentioned training and evaluation folds &ndash; and the True Skill Statistic
(TSS) calculated using the data held out from each fold is
used to quantify the performance (i.e. <code>"test_tss_mean"</code> column in
output). These models are also fitted using the
<code>early_stopping_rounds</code> parameter to reduce time-spent
tuning models. If relevant, they are also fitted using the supplied weights
(per by the argument to <code>site_weights_data</code>). After exploring the
full set of parameter combinations, the best parameter combination is
identified, and the associated parameter values and models are stored for
later use.
</p>
</li>
<li><p> The cross-validation models associated with the best parameter
combination are used to generate predict the average probability that the
feature occupies each site. These predictions include sites that have
been surveyed before, and also sites that have not been surveyed before.
</p>
</li>
<li><p> The performance of the cross-validation models is evaluated.
Specifically, the TSS, sensitivity, and specificity statistics are
calculated (if relevant, weighted by the argument to
<code>site_weights_data</code>). These performance values are calculated using
the models' training and evaluation folds.
</p>
</li></ol>



<h3>Value</h3>

<p>A <code>list</code> object containing:
</p>

<dl>
<dt>parameters</dt><dd><p><code>list</code> of <code>list</code> objects containing the best
tuning parameters for each feature.</p>
</dd>
<dt>predictions</dt><dd><p><code><a href="tibble.html#topic+tibble">tibble::tibble()</a></code> object containing
predictions for each feature.</p>
</dd>
<dt>performance</dt><dd><p><code><a href="tibble.html#topic+tibble">tibble::tibble()</a></code> object containing the
performance of the best models for each feature. It contains the following
columns:
</p>

<dl>
<dt>feature</dt><dd><p>name of the feature.</p>
</dd>
<dt>train_tss_mean</dt><dd>
<p>mean TSS statistic for models calculated using training data in
cross-validation.</p>
</dd>
<dt>train_tss_std</dt><dd>
<p>standard deviation in TSS statistics for models calculated using training
data in cross-validation.</p>
</dd>
<dt>train_sensitivity_mean</dt><dd>
<p>mean sensitivity statistic for models calculated using training data in
cross-validation.</p>
</dd>
<dt>train_sensitivity_std</dt><dd>
<p>standard deviation in sensitivity statistics for models calculated using
training data in cross-validation.</p>
</dd>
<dt>train_specificity_mean</dt><dd>
<p>mean specificity statistic for models calculated using training data in
cross-validation.</p>
</dd>
<dt>train_specificity_std</dt><dd>
<p>standard deviation in specificity statistics for models calculated using
training data in cross-validation.</p>
</dd>
<dt>test_tss_mean</dt><dd>
<p>mean TSS statistic for models calculated using test data in
cross-validation.</p>
</dd>
<dt>test_tss_std</dt><dd>
<p>standard deviation in TSS statistics for models calculated using test
data in cross-validation.</p>
</dd>
<dt>test_sensitivity_mean</dt><dd>
<p>mean sensitivity statistic for models calculated using test data in
cross-validation.</p>
</dd>
<dt>test_sensitivity_std</dt><dd>
<p>standard deviation in sensitivity statistics for models calculated using
test data in cross-validation.</p>
</dd>
<dt>test_specificity_mean</dt><dd>
<p>mean specificity statistic for models calculated using test data in
cross-validation.</p>
</dd>
<dt>test_specificity_std</dt><dd>
<p>standard deviation in specificity statistics for models calculated using
test data in cross-validation.</p>
</dd>
</dl>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# set seeds for reproducibility
set.seed(123)

# simulate data for 30 sites, 2 features, and 3 environmental variables
site_data &lt;- simulate_site_data(
  n_sites = 30, n_features = 2, n_env_vars = 3, prop = 0.1)
feature_data &lt;- simulate_feature_data(n_features = 2, prop = 1)

# create list of possible tuning parameters for modeling
parameters &lt;- list(eta = seq(0.1, 0.5, length.out = 3),
                   lambda = 10 ^ seq(-1.0, 0.0, length.out = 3),
                   objective = "binary:logistic")

# fit models
# note that we use 10 random search iterations here so that the example
# finishes quickly, you would probably want something like 1000+
results &lt;- fit_xgb_occupancy_models(
   site_data, feature_data,
   c("f1", "f2"), c("n1", "n2"), c("e1", "e2", "e3"),
   "survey_sensitivity", "survey_specificity",
   n_folds = rep(5, 2), xgb_early_stopping_rounds = rep(100, 2),
   xgb_tuning_parameters = parameters, n_threads = 1)

# print best found model parameters
print(results$parameters)

# print model predictions
print(results$predictions)

# print model performance
print(results$performance, width = Inf)

## End(Not run)
</code></pre>

<hr>
<h2 id='geo_cov_survey_scheme'>Geographic coverage survey scheme</h2><span id='topic+geo_cov_survey_scheme'></span>

<h3>Description</h3>

<p>Generate a survey scheme by maximizing the geographic coverage
of surveys.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>geo_cov_survey_scheme(
  site_data,
  cost_column,
  survey_budget,
  locked_in_column = NULL,
  locked_out_column = NULL,
  exclude_locked_out = FALSE,
  solver = "auto",
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="geo_cov_survey_scheme_+3A_site_data">site_data</code></td>
<td>
<p><code><a href="sf.html#topic+sf">sf::sf()</a></code> object containing the candidate survey
sites.</p>
</td></tr>
<tr><td><code id="geo_cov_survey_scheme_+3A_cost_column">cost_column</code></td>
<td>
<p><code>character</code> name of the column in the argument to
the argument to <code>site_data</code> that contains the cost for surveying each
site. No missing (<code>NA</code>) values are permitted.</p>
</td></tr>
<tr><td><code id="geo_cov_survey_scheme_+3A_survey_budget">survey_budget</code></td>
<td>
<p><code>numeric</code> vector of maximum budgets for the survey
schemes. No missing (<code>NA</code>) values are permitted.</p>
</td></tr>
<tr><td><code id="geo_cov_survey_scheme_+3A_locked_in_column">locked_in_column</code></td>
<td>
<p><code>character</code> (optional) name of the column in
the argument to <code>site_data</code> that contains <code>logical</code>
(<code>TRUE</code>/ <code>FALSE</code>) values indicating if certain sites should be
locked into the survey scheme.
No missing (<code>NA</code>) values are permitted.
Defaults to <code>NULL</code> such that no sites are locked in.</p>
</td></tr>
<tr><td><code id="geo_cov_survey_scheme_+3A_locked_out_column">locked_out_column</code></td>
<td>
<p><code>character</code> (optional) name of the column in
the argument to <code>site_data</code> that contains <code>logical</code>
(<code>TRUE</code>/ <code>FALSE</code>) values indicating if certain sites should be
locked out of the survey scheme.
No missing (<code>NA</code>) values are permitted.
Defaults to <code>NULL</code> such that no sites are locked out.</p>
</td></tr>
<tr><td><code id="geo_cov_survey_scheme_+3A_exclude_locked_out">exclude_locked_out</code></td>
<td>
<p><code>logical</code> should locked out planning units
be entirely excluded from the optimization process?
Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="geo_cov_survey_scheme_+3A_solver">solver</code></td>
<td>
<p><code>character</code> name of the optimization solver to use
for generating survey schemes.
Available options include: <code>"Rsymphony"</code>, <code>"gurobi"</code> and <code>"auto"</code>.
The <code>"auto"</code> method will use the Gurobi optimization software if
it is available; otherwise, it will use the SYMPHONY software
via the <span class="pkg">Rsymphony</span> package.
Defaults to <code>"auto"</code>.</p>
</td></tr>
<tr><td><code id="geo_cov_survey_scheme_+3A_verbose">verbose</code></td>
<td>
<p><code>logical</code> indicating if information should be
printed while generating survey scheme(s). Defaults to <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The integer programming formulation of the <em>p</em>-Median
problem (Daskin &amp; Maass 2015) is used to generate survey schemes.
</p>


<h3>Value</h3>

<p>A <code>matrix</code> of <code>logical</code> (<code>TRUE</code>/ <code>FALSE</code>)
values indicating if a site is selected in a scheme or not. Columns
correspond to sites, and rows correspond to different schemes.
</p>


<h3>Solver</h3>

<p>This function can use the <span class="pkg">Rsymphony</span> package and
the <a href="https://www.gurobi.com/">Gurobi optimization software</a> to generate
survey schemes. Although the <span class="pkg">Rsymphony</span> package
is easier to install because it is freely available on the
The Comprehensive R Archive Network (CRAN), it is strongly recommended to
install the <a href="https://www.gurobi.com/">Gurobi optimization software</a> and the
<span class="pkg">gurobi</span> R package because it can generate survey schemes much faster.
Note that special academic licenses are available at no cost.
Installation instructions are <a href="https://support.gurobi.com/hc/en-us/articles/4534161999889-How-do-I-install-Gurobi-Optimizer">available online for Linux, Windows, and Mac OS operating systems</a>.
</p>


<h3>References</h3>

<p>Daskin MS &amp; Maass KL (2015) The p-median problem. In <em>Location Science</em>
(pp. 21-45). Springer, Cham.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># set seed for reproducibility
set.seed(123)

# simulate data
 x &lt;- sf::st_as_sf(
   tibble::tibble(x = rnorm(4), y = rnorm(4),
                  v1 = c(0.1, 0.2, 0.3, 10), # environmental axis 1
                  v2 = c(0.1, 0.2, 0.3, 10), # environmental axis 2
                  cost = rep(1, 4)),
    coords = c("x", "y"))

# plot the sites' locations
plot(st_geometry(x), pch = 16, cex = 3)

# generate scheme with a budget of 2
s &lt;- geo_cov_survey_scheme(x, "cost", 2)

# print scheme
print(s)

# plot scheme
x$scheme &lt;- c(s)
plot(x[, "scheme"], pch = 16, cex = 3)
</code></pre>

<hr>
<h2 id='n_states'>Number of states</h2><span id='topic+n_states'></span>

<h3>Description</h3>

<p>Calculate the total number of presence/absence states for a given
number of sites and features.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>n_states(n_sites, n_features)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="n_states_+3A_n_sites">n_sites</code></td>
<td>
<p><code>numeric</code> number of sites.</p>
</td></tr>
<tr><td><code id="n_states_+3A_n_features">n_features</code></td>
<td>
<p><code>numeric</code> number of features.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>numeric</code> value.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># calculate number of states for 3 sites and 2 features
n_states(n_sites = 2, n_features = 3)

</code></pre>

<hr>
<h2 id='optimal_survey_scheme'>Optimal survey scheme</h2><span id='topic+optimal_survey_scheme'></span>

<h3>Description</h3>

<p>Find the optimal survey scheme that maximizes value of information.
This function uses the exact method for
calculating the expected value of the decision given a survey scheme.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>optimal_survey_scheme(
  site_data,
  feature_data,
  site_detection_columns,
  site_n_surveys_columns,
  site_probability_columns,
  site_management_cost_column,
  site_survey_cost_column,
  feature_survey_column,
  feature_survey_sensitivity_column,
  feature_survey_specificity_column,
  feature_model_sensitivity_column,
  feature_model_specificity_column,
  feature_target_column,
  total_budget,
  survey_budget,
  site_management_locked_in_column = NULL,
  site_management_locked_out_column = NULL,
  site_survey_locked_out_column = NULL,
  prior_matrix = NULL,
  n_threads = 1,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="optimal_survey_scheme_+3A_site_data">site_data</code></td>
<td>
<p><code><a href="sf.html#topic+sf">sf::sf()</a></code> object with site data.</p>
</td></tr>
<tr><td><code id="optimal_survey_scheme_+3A_feature_data">feature_data</code></td>
<td>
<p><code><a href="base.html#topic+data.frame">base::data.frame()</a></code> object with feature data.</p>
</td></tr>
<tr><td><code id="optimal_survey_scheme_+3A_site_detection_columns">site_detection_columns</code></td>
<td>
<p><code>character</code> names of <code>numeric</code>
columns in the argument to <code>site_data</code> that contain the proportion of
surveys conducted within each site that detected each feature.
Each column should correspond to a different feature, and contain
a proportion value (between zero and one). If a site has
not previously been surveyed, a value of zero should be used.</p>
</td></tr>
<tr><td><code id="optimal_survey_scheme_+3A_site_n_surveys_columns">site_n_surveys_columns</code></td>
<td>
<p><code>character</code> names of <code>numeric</code>
columns in the argument to <code>site_data</code> that contain the total
number of surveys conducted for each each feature within each site.
Each column should correspond to a different feature, and contain
a non-negative integer number (e.g. 0, 1, 2, 3). If a site has
not previously been surveyed, a value of zero should be used.</p>
</td></tr>
<tr><td><code id="optimal_survey_scheme_+3A_site_probability_columns">site_probability_columns</code></td>
<td>
<p><code>character</code> names of <code>numeric</code>
columns in the argument to <code>site_data</code> that contain modeled
probabilities of occupancy for each feature in each site.
Each column should correspond to a different feature, and contain
probability data (values between zero and one). No missing (<code>NA</code>)
values are permitted in these columns.</p>
</td></tr>
<tr><td><code id="optimal_survey_scheme_+3A_site_management_cost_column">site_management_cost_column</code></td>
<td>
<p><code>character</code> name of column in the
argument to <code>site_data</code> that contains costs for managing each
site for conservation. This column should have <code>numeric</code> values that
are equal to or greater than zero. No missing (<code>NA</code>) values are
permitted in this column.</p>
</td></tr>
<tr><td><code id="optimal_survey_scheme_+3A_site_survey_cost_column">site_survey_cost_column</code></td>
<td>
<p><code>character</code> name of column in the
argument to  <code>site_data</code> that contains costs for surveying each
site. This column should have <code>numeric</code> values that are equal to
or greater than zero. No missing (<code>NA</code>) values are permitted in this
column.</p>
</td></tr>
<tr><td><code id="optimal_survey_scheme_+3A_feature_survey_column">feature_survey_column</code></td>
<td>
<p><code>character</code> name of the column in the
argument to <code>feature_data</code> that contains <code>logical</code> (<code>TRUE</code> /
<code>FALSE</code>) values indicating if the feature will be surveyed in
the planned surveys or not. Note that considering additional features will
rapidly increase computational burden, and so it is only recommended to
consider features that are of specific conservation interest.
No missing (<code>NA</code>) values are permitted in this column.</p>
</td></tr>
<tr><td><code id="optimal_survey_scheme_+3A_feature_survey_sensitivity_column">feature_survey_sensitivity_column</code></td>
<td>
<p><code>character</code> name of the
column in the argument to <code>feature_data</code> that contains
probability of future surveys correctly detecting a presence of each
feature in a given site (i.e. the sensitivity of the survey methodology).
This column should have <code>numeric</code> values that are between zero and
one. No missing (<code>NA</code>) values are permitted in this column.</p>
</td></tr>
<tr><td><code id="optimal_survey_scheme_+3A_feature_survey_specificity_column">feature_survey_specificity_column</code></td>
<td>
<p><code>character</code> name of the
column in the argument to <code>feature_data</code> that contains
probability of future surveys correctly detecting an absence of each
feature in a given site (i.e. the specificity of the survey methodology).
This column should have <code>numeric</code> values that are between zero and
one. No missing (<code>NA</code>) values are permitted in this column.</p>
</td></tr>
<tr><td><code id="optimal_survey_scheme_+3A_feature_model_sensitivity_column">feature_model_sensitivity_column</code></td>
<td>
<p><code>character</code> name of the
column in the argument to <code>feature_data</code> that contains
probability of the initial models correctly predicting a presence of each
feature in a given site (i.e. the sensitivity of the models).
This column should have <code>numeric</code> values that are between zero and
one. No missing (<code>NA</code>) values are permitted in this column.
This should ideally be calculated using
<code><a href="#topic+fit_xgb_occupancy_models">fit_xgb_occupancy_models()</a></code> or
<code><a href="#topic+fit_hglm_occupancy_models">fit_hglm_occupancy_models()</a></code>.</p>
</td></tr>
<tr><td><code id="optimal_survey_scheme_+3A_feature_model_specificity_column">feature_model_specificity_column</code></td>
<td>
<p><code>character</code> name of the
column in the argument to <code>feature_data</code> that contains
probability of the initial models correctly predicting an absence of each
feature in a given site (i.e. the specificity of the models).
This column should have <code>numeric</code> values that are between zero and
one. No missing (<code>NA</code>) values are permitted in this column.
This should ideally be calculated using
<code><a href="#topic+fit_xgb_occupancy_models">fit_xgb_occupancy_models()</a></code> or
<code><a href="#topic+fit_hglm_occupancy_models">fit_hglm_occupancy_models()</a></code>.</p>
</td></tr>
<tr><td><code id="optimal_survey_scheme_+3A_feature_target_column">feature_target_column</code></td>
<td>
<p><code>character</code> name of the column in the
argument to <code>feature_data</code> that contains the <code class="reqn">target</code>
values used to parametrize the conservation benefit of managing of each
feature.
This column should have <code>numeric</code> values that
are equal to or greater than zero. No missing (<code>NA</code>) values are
permitted in this column.</p>
</td></tr>
<tr><td><code id="optimal_survey_scheme_+3A_total_budget">total_budget</code></td>
<td>
<p><code>numeric</code> maximum expenditure permitted
for conducting surveys and managing sites for conservation.</p>
</td></tr>
<tr><td><code id="optimal_survey_scheme_+3A_survey_budget">survey_budget</code></td>
<td>
<p><code>numeric</code> maximum expenditure permitted
for conducting surveys.</p>
</td></tr>
<tr><td><code id="optimal_survey_scheme_+3A_site_management_locked_in_column">site_management_locked_in_column</code></td>
<td>
<p><code>character</code> name of the column
in the argument to <code>site_data</code> that contains <code>logical</code>
(<code>TRUE</code> / <code>FALSE</code>) values indicating which sites should
be locked in for (<code>TRUE</code>) being managed for conservation or
(<code>FALSE</code>) not. No missing (<code>NA</code>) values are permitted in this
column. This is useful if some sites have already been earmarked for
conservation, or if some sites are already being managed for conservation.
Defaults to <code>NULL</code> such that no sites are locked in.</p>
</td></tr>
<tr><td><code id="optimal_survey_scheme_+3A_site_management_locked_out_column">site_management_locked_out_column</code></td>
<td>
<p><code>character</code> name of the column
in the argument to <code>site_data</code> that contains <code>logical</code>
(<code>TRUE</code> / <code>FALSE</code>) values indicating which sites should
be locked out for (<code>TRUE</code>) being managed for conservation or
(<code>FALSE</code>) not. No missing (<code>NA</code>) values are permitted in this
column. This is useful if some sites could potentially be surveyed
to improve model predictions even if they cannot be managed for
conservation. Defaults to <code>NULL</code> such that no sites are locked out.</p>
</td></tr>
<tr><td><code id="optimal_survey_scheme_+3A_site_survey_locked_out_column">site_survey_locked_out_column</code></td>
<td>
<p><code>character</code> name of the column
in the argument to <code>site_data</code> that contains <code>logical</code>
(<code>TRUE</code> / <code>FALSE</code>) values indicating which sites should
be locked out (<code>TRUE</code>) from being selected for future surveys or
(<code>FALSE</code>) not. No missing (<code>NA</code>) values are permitted in this
column. This is useful if some sites will never be considered for future
surveys (e.g. because they are too costly to survey, or have a
low chance of containing the target species).
Defaults to <code>NULL</code> such that no sites are locked out.</p>
</td></tr>
<tr><td><code id="optimal_survey_scheme_+3A_prior_matrix">prior_matrix</code></td>
<td>
<p><code>numeric</code> <code>matrix</code> containing
the prior probability of each feature occupying each site.
Rows correspond to features, and columns correspond to sites.
Defaults to <code>NULL</code> such that prior data is calculated automatically
using <code><a href="#topic+prior_probability_matrix">prior_probability_matrix()</a></code>.</p>
</td></tr>
<tr><td><code id="optimal_survey_scheme_+3A_n_threads">n_threads</code></td>
<td>
<p><code>integer</code> number of threads to use for computation.</p>
</td></tr>
<tr><td><code id="optimal_survey_scheme_+3A_verbose">verbose</code></td>
<td>
<p><code>logical</code> indicating if information should be
printed during processing. Defaults to <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The optimal survey scheme is determined using a brute-force algorithm.
Initially, all feasible (valid) survey schemes are identified given the
survey costs and the survey budget (using
<code><a href="#topic+feasible_survey_schemes">feasible_survey_schemes()</a></code>. Next, the expected value of each and
every feasible survey scheme is computed
(using <code><a href="#topic+evdsi">evdsi()</a></code>).
Finally, the greatest expected value is identified, and all survey schemes
that share this greatest expected value are returned. Due to the nature of
this algorithm, it can take a very long time to complete.
</p>


<h3>Value</h3>

<p>A <code>matrix</code> of <code>logical</code> (<code>TRUE</code>/ <code>FALSE</code>)
values indicating if a site is selected in the scheme or not. Columns
correspond to sites, and rows correspond to different schemes. If
there is only one optimal survey scheme then the <code>matrix</code> will only
contain a single row. This matrix also has a <code>numeric</code> <code>"ev"</code>
attribute that contains the expected value of each scheme.
</p>


<h3>Dependencies</h3>

<p>Please note that this function requires the Gurobi optimization software
(<a href="https://www.gurobi.com/">https://www.gurobi.com/</a>) and the <span class="pkg">gurobi</span> R package if different
sites have different survey costs. Installation instruction are available
online for Linux, Windows, and Mac OS
(see <a href="https://support.gurobi.com/hc/en-us/articles/4534161999889-How-do-I-install-Gurobi-Optimizer">https://support.gurobi.com/hc/en-us/articles/4534161999889-How-do-I-install-Gurobi-Optimizer</a>).
</p>


<h3>Examples</h3>

<pre><code class='language-R'># set seeds for reproducibility
set.seed(123)

# load example site data
data(sim_sites)
print(sim_sites)

# load example feature data
data(sim_features)
print(sim_features)

# set total budget for managing sites for conservation
# (i.e. 50% of the cost of managing all sites)
total_budget &lt;- sum(sim_sites$management_cost) * 0.5

# set total budget for surveying sites for conservation
# (i.e. 40% of the cost of managing all sites)
survey_budget &lt;- sum(sim_sites$survey_cost) * 0.4

## Not run: 
# find optimal survey scheme using exact method
opt_survey &lt;- optimal_survey_scheme(
  sim_sites, sim_features,
  c("f1", "f2", "f3"), c("n1", "n2", "n3"), c("p1", "p2", "p3"),
  "management_cost", "survey_cost",
  "survey", "survey_sensitivity", "survey_specificity",
  "model_sensitivity", "model_specificity",
  "target", total_budget, survey_budget)

# print result
print(opt_survey)

## End(Not run)
</code></pre>

<hr>
<h2 id='prior_probability_matrix'>Prior probability matrix</h2><span id='topic+prior_probability_matrix'></span>

<h3>Description</h3>

<p>Create prior probability matrix for the value of information analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prior_probability_matrix(
  site_data,
  feature_data,
  site_detection_columns,
  site_n_surveys_columns,
  site_probability_columns,
  feature_survey_sensitivity_column,
  feature_survey_specificity_column,
  feature_model_sensitivity_column,
  feature_model_specificity_column
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prior_probability_matrix_+3A_site_data">site_data</code></td>
<td>
<p><code><a href="sf.html#topic+sf">sf::sf()</a></code> object with site data.</p>
</td></tr>
<tr><td><code id="prior_probability_matrix_+3A_feature_data">feature_data</code></td>
<td>
<p><code><a href="base.html#topic+data.frame">base::data.frame()</a></code> object with feature data.</p>
</td></tr>
<tr><td><code id="prior_probability_matrix_+3A_site_detection_columns">site_detection_columns</code></td>
<td>
<p><code>character</code> names of <code>numeric</code>
columns in the argument to <code>site_data</code> that contain the proportion of
surveys conducted within each site that detected each feature.
Each column should correspond to a different feature, and contain
a proportion value (between zero and one). If a site has
not previously been surveyed, a value of zero should be used.</p>
</td></tr>
<tr><td><code id="prior_probability_matrix_+3A_site_n_surveys_columns">site_n_surveys_columns</code></td>
<td>
<p><code>character</code> names of <code>numeric</code>
columns in the argument to <code>site_data</code> that contain the total
number of surveys conducted for each each feature within each site.
Each column should correspond to a different feature, and contain
a non-negative integer number (e.g. 0, 1, 2, 3). If a site has
not previously been surveyed, a value of zero should be used.</p>
</td></tr>
<tr><td><code id="prior_probability_matrix_+3A_site_probability_columns">site_probability_columns</code></td>
<td>
<p><code>character</code> names of <code>numeric</code>
columns in the argument to <code>site_data</code> that contain modeled
probabilities of occupancy for each feature in each site.
Each column should correspond to a different feature, and contain
probability data (values between zero and one). No missing (<code>NA</code>)
values are permitted in these columns.</p>
</td></tr>
<tr><td><code id="prior_probability_matrix_+3A_feature_survey_sensitivity_column">feature_survey_sensitivity_column</code></td>
<td>
<p><code>character</code> name of the
column in the argument to <code>feature_data</code> that contains
probability of future surveys correctly detecting a presence of each
feature in a given site (i.e. the sensitivity of the survey methodology).
This column should have <code>numeric</code> values that are between zero and
one. No missing (<code>NA</code>) values are permitted in this column.</p>
</td></tr>
<tr><td><code id="prior_probability_matrix_+3A_feature_survey_specificity_column">feature_survey_specificity_column</code></td>
<td>
<p><code>character</code> name of the
column in the argument to <code>feature_data</code> that contains
probability of future surveys correctly detecting an absence of each
feature in a given site (i.e. the specificity of the survey methodology).
This column should have <code>numeric</code> values that are between zero and
one. No missing (<code>NA</code>) values are permitted in this column.</p>
</td></tr>
<tr><td><code id="prior_probability_matrix_+3A_feature_model_sensitivity_column">feature_model_sensitivity_column</code></td>
<td>
<p><code>character</code> name of the
column in the argument to <code>feature_data</code> that contains
probability of the initial models correctly predicting a presence of each
feature in a given site (i.e. the sensitivity of the models).
This column should have <code>numeric</code> values that are between zero and
one. No missing (<code>NA</code>) values are permitted in this column.
This should ideally be calculated using
<code><a href="#topic+fit_xgb_occupancy_models">fit_xgb_occupancy_models()</a></code> or
<code><a href="#topic+fit_hglm_occupancy_models">fit_hglm_occupancy_models()</a></code>.</p>
</td></tr>
<tr><td><code id="prior_probability_matrix_+3A_feature_model_specificity_column">feature_model_specificity_column</code></td>
<td>
<p><code>character</code> name of the
column in the argument to <code>feature_data</code> that contains
probability of the initial models correctly predicting an absence of each
feature in a given site (i.e. the specificity of the models).
This column should have <code>numeric</code> values that are between zero and
one. No missing (<code>NA</code>) values are permitted in this column.
This should ideally be calculated using
<code><a href="#topic+fit_xgb_occupancy_models">fit_xgb_occupancy_models()</a></code> or
<code><a href="#topic+fit_hglm_occupancy_models">fit_hglm_occupancy_models()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>matrix</code> object containing the prior probabilities of each
feature occupying each site. Each row corresponds to a different
feature and each column corresponds to a different site.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># set seeds for reproducibility
set.seed(123)

# load example site data
data(sim_sites)
print(sim_sites)

# load example feature data
data(sim_features)
print(sim_features)

# calculate prior probability matrix
prior_matrix &lt;- prior_probability_matrix(
  sim_sites, sim_features,
  c("f1", "f2", "f3"), c("n1", "n2", "n3"), c("p1", "p2", "p3"),
  "survey_sensitivity", "survey_specificity",
  "model_sensitivity", "model_specificity")

# preview prior probability matrix
print(prior_matrix)
</code></pre>

<hr>
<h2 id='relative_site_richness_scores'>Relative site richness scores</h2><span id='topic+relative_site_richness_scores'></span>

<h3>Description</h3>

<p>Calculate relative site richness scores. Sites with greater scores
are predicted to be more likely to contain more species. Note that these
scores are relative to each other and scores calculated using different
matrices cannot be compared to each other.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>relative_site_richness_scores(site_data, site_probability_columns)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="relative_site_richness_scores_+3A_site_data">site_data</code></td>
<td>
<p><code><a href="sf.html#topic+sf">sf::sf()</a></code> object with site data.</p>
</td></tr>
<tr><td><code id="relative_site_richness_scores_+3A_site_probability_columns">site_probability_columns</code></td>
<td>
<p><code>character</code> names of <code>numeric</code>
columns in the argument to <code>site_data</code> that contain modeled
probabilities of occupancy for each feature in each site.
Each column should correspond to a different feature, and contain
probability data (values between zero and one). No missing (<code>NA</code>)
values are permitted in these columns.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The relative site richness scores are calculated using the following
procedure:
</p>

<ol>
<li><p> Let <code class="reqn">J</code> denote the set of sites (indexed by <code class="reqn">j</code>),
<code class="reqn">I</code> denote the set of features (indexed by <code class="reqn">i</code>), and
<code class="reqn">x_{ij}</code> denote the modeled probability of feature <code class="reqn">i \in I</code>
occurring in sites <code class="reqn">j \in J</code>.
</p>
</li>
<li><p> Next, we will sum the values for each site:
<code class="reqn">y_j = \sum_{i \in I} x_{ij}</code>.
</p>
</li>
<li><p> Finally, we will linearly rescale the <code class="reqn">y_j</code> values between 0.01
and 1 to produce the scores.
</p>
</li></ol>



<h3>Value</h3>

<p>A <code>numeric</code> vector of richness scores. Note that
these values are automatically rescaled between 0.01 and 1.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># set seed for reproducibility
set.seed(123)

# simulate data for 3 features and 4 planning units
x &lt;- tibble::tibble(x = rnorm(4), y = rnorm(4),
                     p1 = c(0.095, 0.032, 0.5, 0.924),
                     p2 = c(0.023, 0.014, 0.4, 0.919),
                     p3 = c(0.075, 0.046, 0.9, 0.977))
x &lt;- sf::st_as_sf(x, coords = c("x", "y"))

# print data,
# we can see that the fourth site has the highest modeled probabilities of
# occupancy across all species
print(x)

# plot sites' occupancy probabilities
plot(x[, c("p1", "p2", "p3")], pch = 16, cex = 3)

# calculate scores
s &lt;- relative_site_richness_scores(x, c("p1", "p2", "p3"))

# print scores,
# we can see that site 4 has the highest richness score
print(s)

# plot sites' richness scores
x$s &lt;- s
plot(x[, c("s")], pch = 16, cex = 3)

</code></pre>

<hr>
<h2 id='relative_site_uncertainty_scores'>Relative site uncertainty scores</h2><span id='topic+relative_site_uncertainty_scores'></span>

<h3>Description</h3>

<p>Calculate scores to describe the overall uncertainty of modeled species'
occupancy predictions for each site. Sites with greater scores are associated
with greater uncertainty. Note that these scores are relative to each other
and uncertainty values calculated using different matrices cannot be
compared to each other.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>relative_site_uncertainty_scores(site_data, site_probability_columns)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="relative_site_uncertainty_scores_+3A_site_data">site_data</code></td>
<td>
<p><code><a href="sf.html#topic+sf">sf::sf()</a></code> object with site data.</p>
</td></tr>
<tr><td><code id="relative_site_uncertainty_scores_+3A_site_probability_columns">site_probability_columns</code></td>
<td>
<p><code>character</code> names of <code>numeric</code>
columns in the argument to <code>site_data</code> that contain modeled
probabilities of occupancy for each feature in each site.
Each column should correspond to a different feature, and contain
probability data (values between zero and one). No missing (<code>NA</code>)
values are permitted in these columns.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The relative site uncertainty scores are calculated as joint Shannon's
entropy statistics. Since we assume that species occur independently of each
other, we can calculate these statistics separately for each species in each
site and then sum together the statistics for species in the same site:
</p>

<ol>
<li><p> Let <code class="reqn">J</code> denote the set of sites (indexed by <code class="reqn">j</code>),
<code class="reqn">I</code> denote the set of features (indexed by <code class="reqn">i</code>), and
<code class="reqn">x_{ij}</code> denote the modeled probability of feature <code class="reqn">i \in I</code>
occurring in sites <code class="reqn">j \in J</code>.
</p>
</li>
<li><p> Next, we will calculate the Shannon's entropy statistic for each
species in each site:
<code class="reqn">y_{ij} = - \big( (x_ij \mathit{log}_2 x_{ij}) + (1 - x_ij \mathit{log}_2 1 - x_{ij}) \big) </code>
</p>
</li>
<li><p> Finally, we will sum the entropy statistics together for each site:
<code class="reqn">s_{j} = \sum_{i \in I} y_{ij}</code>
</p>
</li></ol>



<h3>Value</h3>

<p>A <code>numeric</code> vector of uncertainty scores. Note that
these values are automatically rescaled between 0.01 and 1.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># set seed for reproducibility
set.seed(123)

# simulate data for 3 features and 5 sites
x &lt;- tibble::tibble(x = rnorm(5), y = rnorm(5),
                    p1 = c(0.5, 0, 1, 0, 1),
                    p2 = c(0.5, 0.5, 1, 0, 1),
                    p3 = c(0.5, 0.5, 0.5, 0, 1))
x &lt;- sf::st_as_sf(x, coords = c("x", "y"))

# print data,
# we can see that site (row) 3 has the least certain predictions
# because it has many values close to 0.5
print(x)

# plot sites' occupancy probabilities
plot(x[, c("p1", "p2", "p3")], pch = 16, cex = 3)

# calculate scores
s &lt;- relative_site_uncertainty_scores(x, c("p1", "p2", "p3"))

# print scores,
# we can see that site 3 has the highest uncertainty score
print(s)

# plot sites' uncertainty scores
x$s &lt;- s
plot(x[, c("s")], pch = 16, cex = 3)

</code></pre>

<hr>
<h2 id='sim_data'>Simulated datasets</h2><span id='topic+sim_data'></span><span id='topic+sim_sites'></span><span id='topic+sim_features'></span>

<h3>Description</h3>

<p>Simulated data for prioritizing sites for ecological surveys.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(sim_features)

data(sim_sites)
</code></pre>


<h3>Format</h3>


<dl>
<dt>sim_sites</dt><dd><p><code><a href="sf.html#topic+sf">sf::sf()</a></code> object.</p>
</dd>
<dt>sim_features</dt><dd><p><code><a href="tibble.html#topic+tibble">tibble::tibble()</a></code> object.</p>
</dd>
</dl>
<p>.
</p>


<h3>Details</h3>

<p>The simulated datasets provide data for six sites and three features. The
sites can potentially acquired for protected area establishment. However,
existing information on the spatial distribution of the features is
incomplete. Only some of the sites have existing ecological survey data.
To help inform management decisions, species distribution models have been
fitted to predict the probability of each species occupying each site.
</p>

<dl>
<dt><code>sim_sites</code></dt><dd><p>This object describes the sites and contains the
following data: cost of surveying the sites (<code>survey_cost</code> column),
cost of acquiring sites for conservation (<code>management_cost</code> column),
results from previous ecological surveys (<code>f1</code>, <code>f2</code>, <code>f3</code> columns),
previous survey effort (<code>n1</code>, <code>n2</code>, <code>n3</code> columns),
environmental conditions of the sites (<code>e1</code>, <code>e2</code> columns),
and modeled probability of the features occupying the sites
(<code>p1</code>, <code>p2</code>, <code>p3</code> columns).</p>
</dd>
<dt><code>sim_features</code></dt><dd><p>This object describes the features and contains
the following data:
the name of each feature (<code>name</code> column),
whether each feature should be considered in future surveys
(<code>survey</code> column),
the sensitivity and specificity of the survey methodology for each
the sensitivity and specificity of the species distribution model
for each feature (<code>model_sensitivity</code>, <code>model_specificity</code> columns),
and the representation target thresholds for each feature
(<code>target</code> column).</p>
</dd>
</dl>



<h3>See Also</h3>

<p>These datasets were simulated using <code><a href="#topic+simulate_feature_data">simulate_feature_data()</a></code>
and <code><a href="#topic+simulate_site_data">simulate_site_data()</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load data
data(sim_sites, sim_features)

# print feature data
print(sim_features, width = Inf)
# print site data
print(sim_sites, width = Inf)

</code></pre>

<hr>
<h2 id='simulate_feature_data'>Simulate feature data</h2><span id='topic+simulate_feature_data'></span>

<h3>Description</h3>

<p>Simulate feature data for developing simulated survey schemes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_feature_data(n_features, proportion_of_survey_features = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulate_feature_data_+3A_n_features">n_features</code></td>
<td>
<p><code>integer</code> number of features.</p>
</td></tr>
<tr><td><code id="simulate_feature_data_+3A_proportion_of_survey_features">proportion_of_survey_features</code></td>
<td>
<p><code>numeric</code> proportion of features
that will be examined in the new surveys. Values must be between
zero and one. Defaults to 1 such that all features should be surveyed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="tibble.html#topic+tibble">tibble::tibble()</a></code> object. It contains the following
data:
</p>

<dl>
<dt><code>name</code></dt><dd><p><code>character</code> name of each feature.</p>
</dd>
<dt><code>survey</code></dt><dd><p><code>logical</code> (<code>TRUE</code> / <code>FALSE</code>) values
indicating if each feature should be examined in surveys or not.</p>
</dd>
<dt><code>survey_sensitivity</code></dt><dd><p><code>numeric</code> sensitivity (true positive
rate) of the survey methodology for each features.</p>
</dd>
<dt><code>survey_specificity</code></dt><dd><p><code>numeric</code> specificity (true negative
rate) of the survey methodology for each features.</p>
</dd>
<dt><code>model_sensitivity</code></dt><dd><p><code>numeric</code> specificity (true positive
rate) of the occupancy models for each features.</p>
</dd>
<dt><code>model_specificity</code></dt><dd><p><code>numeric</code> specificity (true negative
rate) of the occupancy models for each features.</p>
</dd>
<dt><code>target</code></dt><dd><p><code>numeric</code> target values used to parametrize
the conservation benefit of managing of each feature (defaults to 1).</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+simulate_site_data">simulate_site_data()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># set seed for reproducibility
set.seed(123)

# simulate data
d &lt;- simulate_feature_data(n_features = 5,
                           proportion_of_survey_features = 0.5)
# print data
print(d, width = Inf)

</code></pre>

<hr>
<h2 id='simulate_site_data'>Simulate site data</h2><span id='topic+simulate_site_data'></span>

<h3>Description</h3>

<p>Simulate site data for developing simulated survey schemes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_site_data(
  n_sites,
  n_features,
  proportion_of_sites_missing_data,
  n_env_vars = 3,
  survey_cost_intensity = 20,
  survey_cost_scale = 5,
  management_cost_intensity = 100,
  management_cost_scale = 30,
  max_number_surveys_per_site = 5,
  output_probabilities = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulate_site_data_+3A_n_sites">n_sites</code></td>
<td>
<p><code>integer</code> number of sites.</p>
</td></tr>
<tr><td><code id="simulate_site_data_+3A_n_features">n_features</code></td>
<td>
<p><code>integer</code> number of features.</p>
</td></tr>
<tr><td><code id="simulate_site_data_+3A_proportion_of_sites_missing_data">proportion_of_sites_missing_data</code></td>
<td>
<p><code>numeric</code> proportion of sites
that do not have existing presence/absence data. Values must be between
zero and one.</p>
</td></tr>
<tr><td><code id="simulate_site_data_+3A_n_env_vars">n_env_vars</code></td>
<td>
<p><code>integer</code> number of environmental variables for
simulating feature distributions. Defaults to 3.</p>
</td></tr>
<tr><td><code id="simulate_site_data_+3A_survey_cost_intensity">survey_cost_intensity</code></td>
<td>
<p><code>numeric</code> intensity of the costs of
surveying sites. Larger values correspond to larger costs on average.
Defaults to 20.</p>
</td></tr>
<tr><td><code id="simulate_site_data_+3A_survey_cost_scale">survey_cost_scale</code></td>
<td>
<p><code>numeric</code> value corresponding to
the spatial homogeneity of the survey costs. Defaults to 5.</p>
</td></tr>
<tr><td><code id="simulate_site_data_+3A_management_cost_intensity">management_cost_intensity</code></td>
<td>
<p><code>numeric</code> intensity of the costs of
average cost of managing sites for conservation. Defaults to 100.</p>
</td></tr>
<tr><td><code id="simulate_site_data_+3A_management_cost_scale">management_cost_scale</code></td>
<td>
<p><code>numeric</code> value corresponding to
the spatial homogeneity of the survey costs. Defaults to 30.</p>
</td></tr>
<tr><td><code id="simulate_site_data_+3A_max_number_surveys_per_site">max_number_surveys_per_site</code></td>
<td>
<p><code>integer</code> maximum number of
surveys per site in the simulated data. Defaults to 5.</p>
</td></tr>
<tr><td><code id="simulate_site_data_+3A_output_probabilities">output_probabilities</code></td>
<td>
<p><code>logical</code> value indicating if
probability values of occupancy should be output or not. Defaults
to <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="sf.html#topic+sf">sf::sf()</a></code> object with site data.
The <code>"management_cost"</code> column contains the site protection costs,
and the <code>"survey_cost"</code> column contains the costs for surveying
each site.
Additionally, columns that start with
(i) <code>"f"</code> (e.g. <code>"f1"</code>) contain the proportion of
times that each feature was detected in each site,
(ii) <code>"n"</code> (e.g. <code>"n1"</code>) contain the number of
of surveys for each feature within each site,
(iii) <code>"p"</code> (e.g. <code>"p1"</code>) contain prior
probability data,  and
(iv) <code>"e"</code> (e.g. <code>"e1"</code>) contain environmental
data. Note that columns that contain the same integer value (excepting
environmental data columns) correspond to the same feature
(e.g. <code>"d1"</code>, <code>"n1"</code>, <code>"p1"</code> contain data that correspond
to the same feature).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+simulate_feature_data">simulate_feature_data()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># set seed for reproducibility
set.seed(123)

# simulate data
d &lt;- simulate_site_data(n_sites = 10, n_features = 4, prop = 0.5)

# print data
print(d, width = Inf)

# plot cost data
plot(d[, c("survey_cost", "management_cost")], axes = TRUE, pch = 16,
     cex = 2)

# plot environmental data
plot(d[, c("e1", "e2", "e3")], axes = TRUE, pch = 16, cex = 2)

# plot feature detection data
plot(d[, c("f1", "f2", "f3", "f4")], axes = TRUE, pch = 16, cex = 2)

# plot feature survey effort
plot(d[, c("n1", "n2", "n3", "n4")], axes = TRUE, pch = 16, cex = 2)

# plot feature prior probability data
plot(d[, c("p1", "p2", "p3", "p4")], axes = TRUE, pch = 16, cex = 2)

</code></pre>

<hr>
<h2 id='weighted_survey_scheme'>Weighted survey scheme</h2><span id='topic+weighted_survey_scheme'></span>

<h3>Description</h3>

<p>Generate a survey scheme by selecting the set of sites with the greatest
overall weight value, a maximum budget for the survey scheme.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>weighted_survey_scheme(
  site_data,
  cost_column,
  survey_budget,
  weight_column,
  locked_in_column = NULL,
  locked_out_column = NULL,
  solver = "auto",
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="weighted_survey_scheme_+3A_site_data">site_data</code></td>
<td>
<p><code><a href="sf.html#topic+sf">sf::sf()</a></code> object containing the candidate survey
sites.</p>
</td></tr>
<tr><td><code id="weighted_survey_scheme_+3A_cost_column">cost_column</code></td>
<td>
<p><code>character</code> name of the column in the argument to
the argument to <code>site_data</code> that contains the cost for surveying each
site. No missing (<code>NA</code>) values are permitted.</p>
</td></tr>
<tr><td><code id="weighted_survey_scheme_+3A_survey_budget">survey_budget</code></td>
<td>
<p><code>numeric</code> vector of maximum budgets for the survey
schemes. No missing (<code>NA</code>) values are permitted.</p>
</td></tr>
<tr><td><code id="weighted_survey_scheme_+3A_weight_column">weight_column</code></td>
<td>
<p><code>character</code> name of the column in the argument
to <code>site_data</code> with the weights for each site.</p>
</td></tr>
<tr><td><code id="weighted_survey_scheme_+3A_locked_in_column">locked_in_column</code></td>
<td>
<p><code>character</code> (optional) name of the column in
the argument to <code>site_data</code> that contains <code>logical</code>
(<code>TRUE</code>/ <code>FALSE</code>) values indicating if certain sites should be
locked into the survey scheme.
No missing (<code>NA</code>) values are permitted.
Defaults to <code>NULL</code> such that no sites are locked in.</p>
</td></tr>
<tr><td><code id="weighted_survey_scheme_+3A_locked_out_column">locked_out_column</code></td>
<td>
<p><code>character</code> (optional) name of the column in
the argument to <code>site_data</code> that contains <code>logical</code>
(<code>TRUE</code>/ <code>FALSE</code>) values indicating if certain sites should be
locked out of the survey scheme.
No missing (<code>NA</code>) values are permitted.
Defaults to <code>NULL</code> such that no sites are locked out.</p>
</td></tr>
<tr><td><code id="weighted_survey_scheme_+3A_solver">solver</code></td>
<td>
<p><code>character</code> name of the optimization solver to use
for generating survey schemes.
Available options include: <code>"Rsymphony"</code>, <code>"gurobi"</code> and <code>"auto"</code>.
The <code>"auto"</code> method will use the Gurobi optimization software if
it is available; otherwise, it will use the SYMPHONY software
via the <span class="pkg">Rsymphony</span> package.
Defaults to <code>"auto"</code>.</p>
</td></tr>
<tr><td><code id="weighted_survey_scheme_+3A_verbose">verbose</code></td>
<td>
<p><code>logical</code> indicating if information should be
printed while generating survey scheme(s). Defaults to <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let <code class="reqn">J</code> denote the set of sites (indexed by <code class="reqn">j</code>), and let
<code class="reqn">b</code> denote the maximum budget available for surveying the sites.
Next, let <code class="reqn">c_j</code> represent the cost of surveying each site
<code class="reqn">j \in J</code>, and <code class="reqn">w_j</code> denote the relative value (weight) for
surveying each site <code class="reqn">j \in J</code>. The set of sites with the greatest
overall weight values, subject to a given budget can the be identified by
solving the following integer programming problem. Here,
<code class="reqn">x_j</code> is the binary decision variable indicating each if site
is selected in the survey scheme or not.
</p>
<p style="text-align: center;"><code class="reqn">\mathit{Maximize} \space \sum_{j \in J} x_j w_i \\
  \mathit{subject \space to} \\
  \sum_{j \in J} x_j c_j \leq b</code>
</p>



<h3>Value</h3>

<p>A <code>matrix</code> of <code>logical</code> (<code>TRUE</code>/ <code>FALSE</code>)
values indicating if a site is selected in a scheme or not. Columns
correspond to sites, and rows correspond to different schemes.
</p>


<h3>Solver</h3>

<p>This function can use the <span class="pkg">Rsymphony</span> package and
the <a href="https://www.gurobi.com/">Gurobi optimization software</a> to generate
survey schemes. Although the <span class="pkg">Rsymphony</span> package
is easier to install because it is freely available on the
The Comprehensive R Archive Network (CRAN), it is strongly recommended to
install the <a href="https://www.gurobi.com/">Gurobi optimization software</a> and the
<span class="pkg">gurobi</span> R package because it can generate survey schemes much faster.
Note that special academic licenses are available at no cost.
Installation instructions are <a href="https://support.gurobi.com/hc/en-us/articles/4534161999889-How-do-I-install-Gurobi-Optimizer">available online for Linux, Windows, and Mac OS operating systems</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># set seed for reproducibility
set.seed(123)

# simulate data
x &lt;- sf::st_as_sf(
  tibble::tibble(x = rnorm(4), y = rnorm(4),
                 w = c(0.01, 10, 8, 1),
                 cost = c(1, 1, 1, 1)),
  coords = c("x", "y"))

# plot site' locations and color by weight values
plot(x[, "w"], pch = 16, cex = 3)

# generate scheme without any sites locked in
s &lt;- weighted_survey_scheme(x, cost_column = "cost", survey_budget = 2,
                             weight_column = "w")

# print solution
print(s)

# plot solution
x$s &lt;- c(s)
plot(x[, "s"], pch = 16, cex = 3)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
