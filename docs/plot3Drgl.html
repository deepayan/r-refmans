<!DOCTYPE html><html><head><title>Help for package plot3Drgl</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {plot3Drgl}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#plot3Drgl-package'>
<p>Functions to plot multi-dimensional data using <code>rgl</code>.</p></a></li>
<li><a href='#cutrgl'>
<p>Cutting a rectangular region from an rgl plot.</p></a></li>
<li><a href='#image2Drgl'>
<p>2-D image, contour, scatterplots, segments and arrows in rgl.</p></a></li>
<li><a href='#persp3Drgl'>
<p>3-D plotting functions using rgl.</p></a></li>
<li><a href='#plotrgl'>
<p>Plot 3D graphs in rgl window.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.0.4</td>
</tr>
<tr>
<td>Title:</td>
<td>Plotting Multi-Dimensional Data - Using 'rgl'</td>
</tr>
<tr>
<td>Author:</td>
<td>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>rgl, plot3D, R (&ge; 3.2.3)</td>
</tr>
<tr>
<td>Imports:</td>
<td>grDevices</td>
</tr>
<tr>
<td>Description:</td>
<td>The 'rgl' implementation of plot3D functions.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3.0)</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-01-19 12:55:11 UTC; karlines</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-01-19 18:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='plot3Drgl-package'>
Functions to plot multi-dimensional data using <code>rgl</code>.
</h2><span id='topic+plot3Drgl-package'></span><span id='topic+plot3Drgl'></span>

<h3>Description</h3>

<p>Package <code>plot3Drgl</code> provides an interface from package
<code>plot3D</code> to package <code>rgl</code>.
</p>
<p>It will plot most (but not all) features from plots generated with <code>plot3D</code>, 
except for the color keys and polygons. 
</p>
<p>It also also includes rgl implementations of 2-D functions 
(arrows, points, contours, images), 
which can be zoomed, moved, and sections selected.
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert
</p>


<h3>See Also</h3>

<p>Functions from R-package <code>plot3D</code>.
</p>
<p>Functions from R-package <code>rgl</code>.
</p>

<ul>
<li><p> For 3-D graphs:
</p>

<ul>
<li> <p><a href="#topic+plotrgl">plotrgl</a> the main function that translates plot3D graphs to rgl.
</p>
</li></ul>

</li>
<li><p> For 2-D graphs:
</p>

<ul>
<li> <p><a href="#topic+arrows2Drgl">arrows2Drgl</a> creates 2-D arrow plots.
</p>
</li>
<li> <p><a href="#topic+scatter2Drgl">scatter2Drgl</a> for point and line plots. 
</p>
</li>
<li> <p><a href="#topic+image2Drgl">image2Drgl</a>, <a href="#topic+contour2Drgl">contour2Drgl</a> an rgl implementation of the image  and contour functions.
</p>
</li></ul>

</li></ul>

<p>Apart from the usual zooming, it is also possible to move the figure in the rgl window
(based on an example in the rgl package).
</p>
<p>Rectangular areas can be selected from rgl plots, using <a href="#topic+cutrgl">cutrgl</a> while
<a href="#topic+uncutrgl">uncutrgl</a> will restore the original plot.
</p>

<hr>
<h2 id='cutrgl'>
Cutting a rectangular region from an rgl plot. 
</h2><span id='topic+cutrgl'></span><span id='topic+croprgl'></span><span id='topic+uncutrgl'></span><span id='topic+uncroprgl'></span>

<h3>Description</h3>

<p><code>cutrgl</code> zooms in on a selected region of the plot. It overwrites the current plot.
Selection is done by dragging over the plot, with the left mousekey clicked.
</p>
<p><code>croprgl</code> zooms in on a region of the plot defined by the axes limits. 
It overwrites the current plot.
</p>
<p><code>uncutrgl</code> and <code>uncroprgl</code> restore the original plot, but keep the current orientation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cutrgl (...) 
croprgl (xlim = NULL, ylim = NULL, zlim = NULL, ...) 
uncutrgl (...)
uncroprgl(...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cutrgl_+3A_xlim">xlim</code>, <code id="cutrgl_+3A_ylim">ylim</code>, <code id="cutrgl_+3A_zlim">zlim</code></td>
<td>
<p>The limits of the plot.
</p>
</td></tr>
<tr><td><code id="cutrgl_+3A_...">...</code></td>
<td>
<p>Any argument that can be passed to the function <a href="#topic+plotrgl">plotrgl</a>, 
e.g argument <code>lighting</code>, or to the <code>rgl</code> functions 
<a href="rgl.html#topic+par3d">par3d</a>, <a href="rgl.html#topic+open3d">open3d</a> or <a href="rgl.html#topic+material3d">material3d</a>.
Exceptions are <code>new</code> and <code>add</code> (which are always <code>FALSE</code>).
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the updated plotting list. See <a href="plot3D.html#topic+plotdev">plotdev</a>.
</p>


<h3>Note</h3>

<p>Both functions will not work when another active rgl window has been opened.
In that case, <code>cutrgl</code> will freeze R, and the escape key should be used.
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;</p>


<h3>See Also</h3>

<p><a href="#topic+plotrgl">plotrgl</a>, 
</p>
<p><a href="rgl.html#topic+material3d">material3d</a>, <a href="rgl.html#topic+par3d">par3d</a> for <code>rgl</code> arguments that can be passed to 
the function.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
 ribbon3D(z = volcano, zlim= c(-100, 200), image = TRUE, plot = FALSE)
 plotrgl(new = TRUE) # new window
 cutrgl()           # select region with left mouse
 cutrgl()           # second selection
 uncutrgl()         # original restored

## End(Not run)

</code></pre>

<hr>
<h2 id='image2Drgl'>
2-D image, contour, scatterplots, segments and arrows in rgl.
</h2><span id='topic+image2Drgl'></span><span id='topic+contour2Drgl'></span><span id='topic+scatter2Drgl'></span><span id='topic+lines2Drgl'></span><span id='topic+points2Drgl'></span><span id='topic+text2Drgl'></span><span id='topic+arrows2Drgl'></span><span id='topic+segments2Drgl'></span><span id='topic+rect2Drgl'></span>

<h3>Description</h3>

<p><code>image2Drgl</code> plots an image in rgl. 
</p>
<p><code>contour2Drgl</code> creates a contourplot in rgl. 
</p>
<p><code>scatter2Drgl</code> creates a scatterplot (lineplot, points, ...) in rgl. 
</p>
<p><code>points2Drgl</code> is shorthand for <code>scatter2Drgl(..., type = "p")</code>
</p>
<p><code>lines2Drgl</code> is shorthand for <code>scatter2Drgl(..., type = "l")</code>
</p>
<p><code>arrows2Drgl</code> and <code>segments3D</code> plot arrows and segments in rgl. 
</p>
<p><code>text2Drgl</code> plots labels in rgl.
</p>
<p>These functions were implemented for their side effect that rgl plots can be
zoomed, translocated, rectangular selections taken.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>image2Drgl (z, x = seq(0, 1, length.out = nrow(z)), 
          y = seq(0, 1, length.out = ncol(z)), ...,
          col = NULL, NAcol = "white", breaks = NULL, border = NA,
          facets = TRUE, colkey = NULL, contour = FALSE,
          smooth = FALSE, clim = NULL, clab = NULL, shade = NA,
          inttype = 1, dz = 0, add = FALSE)

contour2Drgl (z, x = seq(0, 1, length.out = nrow(z)),
            y = seq(0, 1, length.out = ncol(z)), ...,
            col = NULL, colkey = NULL, clim = NULL, clab = NULL, dz = 0.1,
            add = FALSE)

scatter2Drgl (x, y, colvar = NULL, ...,
          col = NULL, NAcol = "white", breaks = NULL, colkey = NULL,
          clim = NULL, clab = NULL, CI = NULL, dz = 0.1, add = FALSE)

text2Drgl (x, y, labels, colvar = NULL, ...,
          col = NULL, NAcol = "white", breaks = NULL, colkey = NULL,
          clim = NULL, clab = NULL, dz = 0.1, add = FALSE)

arrows2Drgl (x0, y0, x1, y1, colvar = NULL, ...,
           col = NULL, NAcol = "white", breaks = NULL, colkey = NULL,
           clim = NULL, clab = NULL, type = "simple", dz = 0.1, add = FALSE)

segments2Drgl (x0, y0, x1, y1, colvar = NULL, ...,
           col = NULL, NAcol = "white", breaks = NULL, colkey = NULL,
           clim = NULL, clab = NULL, dz = 0.1, add = FALSE)

rect2Drgl (x0, y0, x1, y1, colvar = NULL, ...,
           col = NULL, NAcol = "white", breaks = NULL, colkey = NULL,
           clim = NULL, clab = NULL, dz = 0.1, add = FALSE)

lines2Drgl(x, y, ...)

points2Drgl(x, y, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="image2Drgl_+3A_x">x</code>, <code id="image2Drgl_+3A_y">y</code></td>
<td>
<p>Vectors with the x- and y- values. 
</p>
</td></tr>
<tr><td><code id="image2Drgl_+3A_z">z</code></td>
<td>
<p>The variable used for coloring the image plot, or containing the 
values to be plotted for the contour plot. 
</p>
</td></tr>
<tr><td><code id="image2Drgl_+3A_x0">x0</code>, <code id="image2Drgl_+3A_y0">y0</code></td>
<td>
<p>coordinates of points <em>from</em> which to draw the arrows.  
</p>
</td></tr>
<tr><td><code id="image2Drgl_+3A_x1">x1</code>, <code id="image2Drgl_+3A_y1">y1</code></td>
<td>
<p>coordinates of points <em>to</em> which to draw the arrows. 
At least one must be supplied. 
</p>
</td></tr>
<tr><td><code id="image2Drgl_+3A_colvar">colvar</code></td>
<td>
<p>The variable used for coloring the scatter plot or the arrows. 
If <code>NULL</code>, then <code>col</code> will be used as such.
</p>
</td></tr>
<tr><td><code id="image2Drgl_+3A_labels">labels</code></td>
<td>
<p>The text to be written. A vector of length equal to length of
x, y.
</p>
</td></tr>
<tr><td><code id="image2Drgl_+3A_col">col</code></td>
<td>
<p>Color palette to be used for the <code>z</code> or <code>colvar</code> variable.
If <code>colvar</code> is <code>NULL</code>, then the colors are used as such.
</p>
</td></tr>
<tr><td><code id="image2Drgl_+3A_nacol">NAcol</code></td>
<td>
<p>Color to be used for <code>NA</code> values; default is &ldquo;white&rdquo;. 
</p>
</td></tr>
<tr><td><code id="image2Drgl_+3A_breaks">breaks</code></td>
<td>
<p>a set of finite numeric breakpoints for the colors;
must have one more breakpoint than color and be in increasing order.
Unsorted vectors will be sorted, with a warning.
</p>
</td></tr>
<tr><td><code id="image2Drgl_+3A_border">border</code></td>
<td>
<p>The color of the lines drawn around the surface facets.
The default, <code>NA</code>, will disable the drawing of borders.
</p>
</td></tr>
<tr><td><code id="image2Drgl_+3A_facets">facets</code></td>
<td>
<p>If <code>TRUE</code>, then <code>col</code> denotes the color of the surface facets.
If <code>FALSE</code>, then the surface facets are colored &ldquo;white&rdquo; and the <code>border</code>
will be colored as specified by <code>col</code>. If <code>NA</code> then the facets will be
transparent.
</p>
</td></tr>
<tr><td><code id="image2Drgl_+3A_shade">shade</code></td>
<td>
<p>the degree of shading of the surface facets.
Values of shade close to one yield shading similar to a point light
source model and values close to zero produce no shading.
Creates the illusion of perspective.
See <a href="graphics.html#topic+persp">persp</a>.
</p>
</td></tr>
<tr><td><code id="image2Drgl_+3A_contour">contour</code></td>
<td>
<p>If <code>TRUE</code>, then a <a href="graphics.html#topic+contour">contour</a> plot will be
added to the image plot. 
Also allowed is to pass a <code>list</code> with arguments for the 
<a href="plot3D.html#topic+contour2D">contour2D</a> function. 
</p>
</td></tr>
<tr><td><code id="image2Drgl_+3A_smooth">smooth</code></td>
<td>
<p>Logical, specifying whether Gouraud shading (smooth) 
or flat shading should be used. (if <code>TRUE</code> then function 
<a href="#topic+cutrgl">cutrgl</a> will not work).
</p>
</td></tr>  
<tr><td><code id="image2Drgl_+3A_colkey">colkey</code></td>
<td>
<p>A logical, NULL (default), or a list with parameters for the
color key (legend). Not all arguments from the original <a href="plot3D.html#topic+colkey">colkey</a> function
from <code>plot3D</code> are supported. For instance, color keys will always be
put on the 4th margin.
</p>
</td></tr>
<tr><td><code id="image2Drgl_+3A_clim">clim</code></td>
<td>
<p>Only if <code>colvar</code> is specified, the range of the color variable used. 
Values of <code>colvar</code> that extend the range will be put to <code>NA</code>.
</p>
</td></tr> 
<tr><td><code id="image2Drgl_+3A_clab">clab</code></td>
<td>
<p>Only if <code>colkey = TRUE</code>, the label to be written on top of the
color key. The label will be written at the same level as the main title.
to lower it, <code>clab</code> can be made a vector, with the first values empty
strings.
</p>
</td></tr>
<tr><td><code id="image2Drgl_+3A_inttype">inttype</code></td>
<td>
<p>The interpolation type to create the polygons, either
interpolating the <code>z</code> (<code>inttype = 1</code> or the <code>x, y</code>
values (<code>inttype = 2</code>) - see <a href="plot3D.html#topic+persp3D">persp3D</a>. 
</p>
</td></tr> 
<tr><td><code id="image2Drgl_+3A_ci">CI</code></td>
<td>
<p>A <code>list</code> with parameters and values for the confidence 
intervals or <code>NULL</code>.
If a list it should contain at least the item <code>x</code> or <code>y</code>. 
Other parameters should be one of (with defaults):
<code>alen = 0.01, lty = par("lty"), lwd = par("lwd"), col = NULL</code>,
to set the length of the arrow head, the line type and width, and the color.
If <code>col</code> is <code>NULL</code>, then the colors of the scatter points are used.
</p>
</td></tr>     
<tr><td><code id="image2Drgl_+3A_type">type</code></td>
<td>
<p>The type of the arrow head, one of <code>"simple"</code> 
(the default, which uses R-function <a href="graphics.html#topic+arrows">arrows</a>) or
<code>"triangle"</code>.
</p>
</td></tr>
<tr><td><code id="image2Drgl_+3A_dz">dz</code></td>
<td>
<p>The 'layer depth', The z-position is defined as 1 + dz. 
</p>
</td></tr>
<tr><td><code id="image2Drgl_+3A_add">add</code></td>
<td>
<p>Logical. If <code>TRUE</code>, then the image, contour or points will be 
added to the current plot.
If <code>FALSE</code> a new plot is started. 
</p>
</td></tr> 
<tr><td><code id="image2Drgl_+3A_...">...</code></td>
<td>
<p>additional arguments passed to the plotting methods. 
The following <a href="graphics.html#topic+persp">persp</a> arguments can be specified: 
<code>xlim, ylim, zlim, xlab, ylab, zlab, main, sub, r, d, 
    scale, expand, box, axes, nticks, ticktype, shade, ltheta, lphi</code>.      
In addition, the <a href="plot3D.html#topic+perspbox">perspbox</a> arguments
<code>col.axis, col.panel, lwd.panel, col.grid, lwd.grid</code> can 
also be given a value.
</p>
<p>Also the arguments <code>lty, lwd</code> can be specified.
</p>
<p>The arguments after ... must be matched exactly.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The first step in 2D rgl plotting consists in calling a 3-D function from package <code>plot3D</code>
with argument <code>plot</code> set to <code>FALSE</code>.
</p>
<p><code>image2Drgl</code> and <code>contour2Drgl</code> call the <a href="plot3D.html#topic+image3D">image3D</a> and <a href="plot3D.html#topic+contour3D">contour3D</a>
functions of R-package <code>plot3D</code>, with <code>colvar</code> equal to <code>z</code>. 
Functions <code>scatter2Drgl</code> and <code>arrows2Drgl</code> call <a href="plot3D.html#topic+scatter3D">scatter3D</a> and <a href="plot3D.html#topic+arrows3D">arrows3D</a>.
</p>
<p>The z value argument to the 3-D functions is set equal to <code>1 + dz</code>; 
For <code>contour3D</code>, <code>scatter3D</code> and <code>arrows3D</code>, it is by default equal to <code>1.1</code>,
while for <code>image3D</code> it is <code>1</code>.
This way, contours, points, segments and arrows will be drawn on top of the image. 
</p>
<p>The next step is to create a 3-D rgl plot, by calling <a href="#topic+plotrgl">plotrgl</a>.   
After that, the viewing arguments are set equal to 
<code>view3d(phi = 0, fov = 0)</code>, i.e. the plot is viewed at from the top.
</p>
<p>The actions of the mouse on the plots is to zoom (left, middle), and to move it (right key).
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;
</p>


<h3>See Also</h3>

<p><a href="plot3D.html#topic+image3D">image3D</a>, <a href="plot3D.html#topic+contour3D">contour3D</a>, <a href="plot3D.html#topic+scatter3D">scatter3D</a>, <a href="plot3D.html#topic+segments3D">segments3D</a>, 
<a href="plot3D.html#topic+text3D">text3D</a> and <a href="plot3D.html#topic+arrows3D">arrows3D</a> 
on which the functions are based.
</p>
<p><a href="plot3D.html#topic+image2D">image2D</a>, <a href="plot3D.html#topic+contour2D">contour2D</a>, <a href="plot3D.html#topic+scatter2D">scatter2D</a>,  <a href="plot3D.html#topic+segments2D">segments2D</a>, 
<a href="plot3D.html#topic+text2D">text2D</a>, <a href="plot3D.html#topic+arrows2D">arrows2D</a> 
for <code>plot3D</code>'s functions, to plot in ordinary R graphics.
</p>
<p><a href="#topic+cutrgl">cutrgl</a> for cutting a rectangular region from the 2D plot.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## =======================================================================
## image and points
## =======================================================================
 image2Drgl(z = volcano, contour = TRUE, main = "volcano")
 scatter2Drgl(x = seq(0, 1, by = 0.2), y = seq(0, 1, by = 0.2), 
   cex = 3, add = TRUE)

## Not run: 
  cutrgl()    # select a rectangle
  uncutrgl()

## End(Not run)

## =======================================================================
## scatter points, and lines
## =======================================================================

 scatter2Drgl(cars[,1], cars[,2], xlab = "speed", ylab = "dist")
## Not run: 
  cutrgl()

## End(Not run)
 lc &lt;- lowess(cars)
 scatter2Drgl(lc$x, lc$y, type = "l", add = TRUE, lwd = 4)
## Not run: 
  cutrgl()
  uncutrgl()

## End(Not run)

## =======================================================================
## confidence intervals
## =======================================================================
 x  &lt;- sort(rnorm(10)) 
 y  &lt;- runif(10)
 cv &lt;- sqrt(x^2 + y^2)

 CI &lt;- list(lwd = 2)
 CI$x &lt;- matrix (nrow = length(x), ncol = 2, data = rep(0.125, 2*length(x)))
 scatter2D(x, y, colvar = cv, pch = 16, cex = 2, CI = CI)

 scatter2Drgl(x, y, colvar = cv, cex = 2, CI = CI)
 
## =======================================================================
## arrows
## =======================================================================

 arrows2Drgl(x0 = 100*runif(30), y0 = runif(30), x1 = 100*runif(30), 
    y1 = runif(30), length = 0.1*runif(30), col = 1:30, angle = 15:45, 
    type = c("simple", "triangle"), lwd = 2)

 x0 &lt;- 1:30
 x1 &lt;- 2:31
 arrows2Drgl(x0 = x0, y0 = sin(x0), x1 = x1, y1 = sin(x1), 
   colvar = x1, lwd = 2)
</code></pre>

<hr>
<h2 id='persp3Drgl'>
3-D plotting functions using rgl.
</h2><span id='topic+persp3Drgl'></span><span id='topic+ribbon3Drgl'></span><span id='topic+hist3Drgl'></span><span id='topic+scatter3Drgl'></span><span id='topic+points3Drgl'></span><span id='topic+lines3Drgl'></span><span id='topic+slice3Drgl'></span><span id='topic+slicecont3Drgl'></span><span id='topic+isosurf3Drgl'></span><span id='topic+voxel3Drgl'></span><span id='topic+triangle3Drgl'></span><span id='topic+surf3Drgl'></span><span id='topic+spheresurf3Drgl'></span><span id='topic+segments3Drgl'></span><span id='topic+image3Drgl'></span><span id='topic+contour3Drgl'></span><span id='topic+box3Drgl'></span><span id='topic+border3Drgl'></span><span id='topic+rect3Drgl'></span><span id='topic+text3Drgl'></span>

<h3>Description</h3>

<p>Functions <code>persp3Drgl</code>, <code>ribbon3Drgl</code>, <code>hist3Drgl</code> produce perspective plots
using rgl; they are similar to functions <a href="plot3D.html#topic+persp3D">persp3D</a>, <a href="plot3D.html#topic+ribbon3D">ribbon3D</a>, <a href="plot3D.html#topic+hist3D">hist3D</a> 
from package <code>plot3D</code>.
</p>
<p>Functions <code>scatter3Drgl</code>, <code>points3Drgl</code>, <code>lines3D</code>, <code>segments3Drgl</code> produce scatter plots and line plots
using rgl; they are similar to functions <a href="plot3D.html#topic+scatter3D">scatter3D</a>, <a href="plot3D.html#topic+points3D">points3D</a>, <a href="plot3D.html#topic+lines3D">lines3D</a>, <a href="plot3D.html#topic+segments3D">segments3D</a> from package <code>plot3D</code>.
</p>
<p>Functions <code>slice3Drgl</code>, <code>points3Drgl</code>, <code>isosurf3Drgl</code>, <code>voxel3Drgl</code> can 
visualise volumetric (3D) data using rgl; 
they are similar to functions <a href="plot3D.html#topic+slice3D">slice3D</a>, <a href="plot3D.html#topic+slicecont3D">slicecont3D</a>, <a href="plot3D.html#topic+isosurf3D">isosurf3D</a>, <a href="plot3D.html#topic+voxel3D">voxel3D</a> from package <code>plot3D</code>.
</p>
<p>Functions <code>surf3Drgl</code>, <code>spheresurf3Drgl</code> produce surface plots
using rgl; they are similar to functions <a href="plot3D.html#topic+surf3D">surf3D</a>, <a href="plot3D.html#topic+spheresurf3D">spheresurf3D</a> from package <code>plot3D</code>.
</p>
<p>Functions <code>box3Drgl</code>, <code>border3Drgl</code>, <code>rect3Drgl</code>, <code>text3Drgl</code> produce boxes, rectangles, texts to 3D plots
using rgl; they are similar to functions <a href="plot3D.html#topic+box3D">box3D</a>, <a href="plot3D.html#topic+border3D">border3D</a>, <a href="plot3D.html#topic+rect3D">rect3D</a>, <a href="#topic+text3Drgl">text3Drgl</a> from package <code>plot3D</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>persp3Drgl(...) 
ribbon3Drgl(...)
hist3Drgl(...)
scatter3Drgl(...)
points3Drgl(...)
lines3Drgl(...)
slice3Drgl(...)
slicecont3Drgl(...)
isosurf3Drgl(...)
voxel3Drgl(...)
triangle3Drgl(...)
surf3Drgl(...)
spheresurf3Drgl(...)
segments3Drgl(...)
image3Drgl(...)
contour3Drgl(...)
box3Drgl(...)
border3Drgl(...)
rect3Drgl(...)
text3Drgl(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="persp3Drgl_+3A_...">...</code></td>
<td>
<p>arguments passed to the plotting methods of package <code>plot3D</code>,
or to the <a href="#topic+plotrgl">plotrgl</a> method. 
The following <a href="graphics.html#topic+persp">persp</a> arguments can be specified: 
<code>xlim, ylim, zlim, xlab, ylab, zlab, main, sub, r, d, 
    scale, expand, box, axes, nticks, ticktype, shade, ltheta, lphi</code>.      
In addition, the <a href="plot3D.html#topic+perspbox">perspbox</a> arguments
<code>col.axis, col.panel, lwd.panel, col.grid, lwd.grid</code> can 
also be given a value.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The first step in 3D rgl plotting consists in calling the corresponding 3-D function from package <code>plot3D</code>
with argument <code>plot</code> set to <code>FALSE</code>.
</p>
<p>The next step is to create a 3-D rgl plot, by calling <a href="#topic+plotrgl">plotrgl</a>.   
</p>
<p>The actions of the mouse on the plots is to zoom (left, middle), and to move it (right key).
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;
</p>


<h3>See Also</h3>

<p><a href="plot3D.html#topic+plotdev">plotdev</a> to plot first in ordinary R graphics and then in rgl
</p>
<p>for <a href="#topic+plotrgl">plotrgl</a> to plot first in ordinary R graphics and then in rgl
</p>
<p><a href="#topic+cutrgl">cutrgl</a> for cutting a rectangular region from the rgl plot.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## =======================================================================
## perspective plots
## =======================================================================
 persp3Drgl(z = volcano, contour = list(side = "zmax"))

# ribbon, in x--direction
 V &lt;- volcano[seq(1, nrow(volcano), by = 5), 
              seq(1, ncol(volcano), by = 5)]  # lower resolution
 ribbon3Drgl(z = V, ticktype = "detailed")
 hist3Drgl(z = V, col = "grey", border = "black", lighting = TRUE)
 
## Not run: 
  cutrgl()    # select a rectangle
  uncutrgl()

## End(Not run)

## =======================================================================
## scatter points
## =======================================================================

 with(quakes, scatter3Drgl(x = long, y = lat, z = -depth, 
   colvar = mag, cex = 3))

 plotdev()   # plots same on oridinary device...
 
## =======================================================================
## 3D surface
## =======================================================================

 M  &lt;- mesh(seq(0, 2*pi, length.out = 50), 
            seq(0, 2*pi, length.out = 50))
 u  &lt;- M$x ; v  &lt;- M$y

 x  &lt;- sin(u)
 y  &lt;- sin(v)
 z  &lt;- sin(u + v)

# alpha makes colors transparent
 surf3Drgl(x, y, z, colvar = z, border = "black", smooth  = TRUE, 
   alpha = 0.2)

## =======================================================================
## volumetric data
## =======================================================================
 x &lt;- y &lt;- z &lt;- seq(-4, 4, by = 0.2)
 M &lt;- mesh(x, y, z)

 R &lt;- with (M, sqrt(x^2 + y^2 + z^2))
 p &lt;- sin(2*R) /(R+1e-3)

 slice3Drgl(x, y, z, colvar = p, col = jet.col(alpha = 0.5), 
         xs = 0, ys = c(-4, 0, 4), zs = NULL, d = 2) 

</code></pre>

<hr>
<h2 id='plotrgl'>
Plot 3D graphs in rgl window. 
</h2><span id='topic+plotrgl'></span>

<h3>Description</h3>

<p><code>plotrgl</code> plots objects created with functions from package <code>plot3D</code> 
in an rgl window. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotrgl (lighting = FALSE, new = TRUE, add = FALSE, smooth = FALSE, ...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotrgl_+3A_lighting">lighting</code></td>
<td>
<p>Logical, when <code>TRUE</code> will add light.
Default is with lighting toggled off; this is similar to shading
</p>
</td></tr>
<tr><td><code id="plotrgl_+3A_new">new</code></td>
<td>
<p>Logical, when <code>TRUE</code> will open a new window. 
When <code>FALSE</code> will start a new plot in the same window.
Is overruled (to <code>FALSE</code>) if <code>add</code> is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="plotrgl_+3A_add">add</code></td>
<td>
<p>Logical, when <code>TRUE</code> will add to the current plot.
</p>
</td></tr>
<tr><td><code id="plotrgl_+3A_smooth">smooth</code></td>
<td>
<p>Logical, specifying whether Gouraud shading (smooth) 
or flat shading should be used. See <a href="rgl.html#topic+material3d">material3d</a> from R-package <code>rgl</code>.
(note: if <code>TRUE</code> then <a href="#topic+cutrgl">cutrgl</a> will not work). 
This only affects images.
</p>
</td></tr>  
<tr><td><code id="plotrgl_+3A_...">...</code></td>
<td>
<p>Any argument to the <code>rgl</code> functions, e.g arguments from
<a href="rgl.html#topic+par3d">par3d</a>, <a href="rgl.html#topic+open3d">open3d</a> or <a href="rgl.html#topic+material3d">material3d</a>.
</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Arrows are best reproduced with argument <code>type</code> from the <a href="plot3D.html#topic+arrows3D">arrows3D</a> 
function (package <code>plot3D</code>) set equal to <code>"cone"</code>, although this does
not always work well (there is probably a flaw in how it is implemented).
Another option is to use <code>type = "triangle"</code>, which simply maps the arrows 
on the xy-plane, ignoring the z-axis. 
In this case, only a view from above (phi = 0) will produce symmetric arrowheads
(when <code>scale = TRUE</code> and <code>expand = 1</code>).
</p>
<p>The translation of <a href="plot3D.html#topic+scatter3D">scatter3D</a> ignores the <code>pch</code> argument but displays
all symbols as squares (if <code>pch = "."</code>) or as filled circles.  
</p>
<p>The color key is not (cannot be) plotted in rgl.
</p>
<p>In <code>rgl</code>, both <code>lty</code> and <code>lwd</code> have to be one number. 
For <code>lwd</code>, this has been overruled, i.e. line widths can be a vector. 
It is still not possible to use different line types in one type of object. 
</p>
<p>The actions of the mouse on the plots is to rotate (left), to move (middle), 
and to zoom it (right).
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;</p>


<h3>See Also</h3>

<p><a href="rgl.html#topic+material3d">material3d</a>, <a href="rgl.html#topic+par3d">par3d</a> for <code>rgl</code> arguments that can be passed to 
the function.
</p>
<p>A similar function, <a href="plot3D.html#topic+plotdev">plotdev</a>, from package <code>plot3D</code> plots the
3D graphs to the current device (other than a rgl-device). 
</p>
<p>Any function of package <code>plot3D</code>: see e.g. help files of
<a href="plot3D.html#topic+persp3D">persp3D</a>, <a href="plot3D.html#topic+scatter3D">scatter3D</a>, <a href="plot3D.html#topic+arrows3D">arrows3D</a>, <a href="plot3D.html#topic+slice3D">slice3D</a>, <a href="plot3D.html#topic+surf3D">surf3D</a>.
</p>
<p>Direct rgl functions, see <a href="#topic+persp3Drgl">persp3Drgl</a>, <code>scatter3Drgl</code>, etc....
</p>


<h3>Examples</h3>

<pre><code class='language-R'># save plotting parameters
 pm &lt;- par("mfrow")
 pmar &lt;- par("mar")

## =======================================================================
## Composite image and contour in 3D
## =======================================================================
# plot reduced resolution (for speed) volcano to traditional window: 
 VV &lt;- volcano[seq(1, nrow(volcano), by = 3), seq(1, ncol(volcano), by = 3)]
 persp3D(z = VV, contour = list(side = "zmax"))

 plotrgl(new = TRUE) # new window

# add light, smooth surface change x-axis limits 
 plotrgl(new = FALSE, lighting = TRUE, 
   xlim = c(0.2, 0.8), smooth = TRUE)

# same:
# persp3Drgl(z = volcano, contour = list(side = "zmax"), 
#  lighting = TRUE, xlim = c(0.2, 0.8), smooth = TRUE)
  
## =======================================================================
## scatters with fitted surface and droplines (see ?scatter3D)
## =======================================================================

 par (mfrow = c(1, 1))
 with (mtcars, {

  # linear regression
   fit &lt;- lm(mpg ~ wt + disp)

  # predict values on regular xy grid
   wt.pred &lt;- seq(1.5, 5.5, length.out = 30)
   disp.pred &lt;- seq(71, 472, length.out = 30)
   xy &lt;- expand.grid(wt = wt.pred, 
                     disp = disp.pred)

   mpg.pred &lt;- matrix (nrow = 30, ncol = 30, 
      data = predict(fit, newdata = data.frame(xy), 
      interval = "prediction")[,1])

# fitted points for droplines to surface
   fitpoints &lt;- predict(fit) 

   scatter3D(z = mpg, x = wt, y = disp, pch = 18, cex = 2, 
      theta = 20, phi = 20, ticktype = "detailed",
      xlab = "wt", ylab = "disp", zlab = "mpg",  
      surf = list(x = wt.pred, y = disp.pred, z = mpg.pred, 
                  facets = NA, fit = fitpoints),
      main = "mtcars")
  
 })

 plotrgl()
 
## =======================================================================
## scatter3D with text
## =======================================================================
 
 with(USArrests, text3D(Murder, Assault, Rape,
    colvar = UrbanPop, col = gg.col(100), theta = 60, phi = 20,
    xlab = "Murder", ylab = "Assault", zlab = "Rape",
    main = "USA arrests",
    labels = rownames(USArrests), cex = 0.8,
    bty = "g", ticktype = "detailed", d = 2,
    clab = c("Urban","Pop"), adj = 0.5, font = 2))

 with(USArrests, scatter3D(Murder, Assault, Rape - 1,
    colvar = UrbanPop, col = gg.col(100),
    type = "h", pch = ".", add = TRUE))

 plotrgl()


## =======================================================================
## spheresurf3D
## =======================================================================

 AA &lt;- Hypsometry$z

# log transformation of color variable; full = TRUE to plot both halves
 spheresurf3D(AA, theta = 90, phi = 30, box = FALSE,
    full = TRUE, plot = FALSE) 

# change the way the left mouse reacts
 plotrgl(mouseMode = c("zAxis", "zoom", "fov"))

## =======================================================================
## Arrows - has a flaw
## =======================================================================

 z &lt;- seq(0, 2*pi, length.out = 100) 
 x &lt;- cos(z)
 y &lt;- sin(z)

 z0 &lt;- z[seq(1, by = 10, length.out = 10)]
 z1 &lt;- z[seq(9, by = 10, length.out = 10)]

# cone arrow heads
 arrows3D(x0 = 10*cos(z0), y0 = sin(z0), z0 = z0,
          x1 = 10*cos(z1), y1 = sin(z1), z1 = z1, 
          type = "cone", length = 0.4, lwd = 4,
          angle = 20, col = 1:10, plot = FALSE)

 plotrgl(lighting = TRUE)

## =======================================================================
## 2D plot
## =======================================================================

 image2D(z = volcano)
 plotrgl()
 
# reset plotting parameters 
 par(mfrow = pm)
 par(mar = pmar)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
