<!DOCTYPE html><html lang="en"><head><title>Help for package Rearrangement</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {Rearrangement}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Rearrangement-package'>
<p>Point and Interval Rearrangement</p></a></li>
<li><a href='#GrowthChart'><p>Age and Height of White Males</p></a></li>
<li><a href='#lclm'>
<p>Local Constant Estimator for Conditional Mean Functions</p></a></li>
<li><a href='#lcrq2'><p>Local Constant Estimator for Conditional Quantile Functions</p></a></li>
<li><a href='#lines.conint'>
<p>Lines Method for Simultaneous Confidence Intervals</p></a></li>
<li><a href='#lplm'>
<p>Local Linear Regression Methods for Conditional Mean Functions</p></a></li>
<li><a href='#lprq2'>
<p>Local Linear Regression Methods for Conditional Quantile Functions</p></a></li>
<li><a href='#plot.conint'>
<p>Plot Method for Simultaneous Confidence Intervals</p></a></li>
<li><a href='#points.conint'>
<p>Points Method for Simultaneous Confidence Intervals</p>
</p></a></li>
<li><a href='#polygon.conint'>
<p>polygon Method for Simultaneous Confidence Intervals</p></a></li>
<li><a href='#rconint'><p>Rearrangement of Simultaneous Confidence Intervals</p></a></li>
<li><a href='#rearrangement'><p>Rearrangement</p></a></li>
<li><a href='#simconboot'>
<p>Simultaneous Confidence Interval Estimation using Bootstrap</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Monotonize Point and Interval Functional Estimates by
Rearrangement</td>
</tr>
<tr>
<td>Version:</td>
<td>2.1</td>
</tr>
<tr>
<td>Author:</td>
<td>Wesley Graybill, Mingli Chen, Victor Chernozhukov, Ivan
        Fernandez-Val, Alfred Galichon</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ivan Fernandez-Val &lt;ivanf@bu.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>The rearrangement operator (Hardy,
        Littlewood, and Polya 1952) for univariate, bivariate, and
        trivariate point estimates of monotonic functions. The package
        additionally provides a function that creates simultaneous
        confidence intervals for univariate functions and applies the
        rearrangement operator to these confidence intervals.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Depends:</td>
<td>quantreg, splines</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2016-03-01 18:33:53 UTC; Mingli</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2016-03-02 01:48:30</td>
</tr>
</table>
<hr>
<h2 id='Rearrangement-package'>
Point and Interval Rearrangement
</h2><span id='topic+Rearrangement-package'></span><span id='topic+Rearrangement'></span>

<h3>Description</h3>

<p>This package implements the rearrangement operator (Hardy, Littlewood, and Polya 1952) for univariate, bivariate, and trivariate point estimates of monotonic functions. It additionally provides a function that creates simultaneous confidence intervals for univariate functions and applies the rearrangement operator to these confidence intervals.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> Rearrangement</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2011-09-11</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL(&gt;=2)</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>This package is used for rearranging both point and interval estimates of a target function. Given an original point estimate of a target function, one may use <code><a href="#topic+rearrangement">rearrangement</a></code> to monotonize this estimate. One may also create simultaneous confidence interval estimates using <code><a href="#topic+simconboot">simconboot</a></code> and monotonize these estimates using <code><a href="#topic+rconint">rconint</a></code>.
</p>


<h3>Author(s)</h3>

<p>Wesley Graybill, Mingli Chen, Victor Chernozhukov, Ivan Fernandez-Val, Alfred Galichon
</p>
<p>Maintainer: Ivan Fernandez-Val &lt;ivanf@bu.edu&gt;
</p>


<h3>References</h3>

<p>Chernozhukov, V., I. Fernandez-Val, and a. Galichon. 2009. Improving point and interval estimators of monotone functions by rearrangement. Biometrika 96 (3): 559-575. 
</p>
<p>Chernozhukov, V., I. Fernandez-Val, and a. Galichon. 2010. Quantile and Probability Curves Without Crossing. Econometrica 78(3): 1093-1125.
</p>
<p>Hardy, G.H., J.E. Littlewood, and G. Polya, Inequalities,2nd ed, Cambridge U. Press,1952
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##rearrangement example:
library(splines)
data(GrowthChart)
attach(GrowthChart)

ages &lt;- unique(sort(age))
aknots &lt;- c(3, 5, 8, 10, 11.5, 13, 14.5, 16, 18)
splines_age &lt;- bs(age,kn=aknots)
sformula &lt;- height~splines_age
sfunc &lt;- approxfun(age,lm(sformula)$fitted.values)
splreg &lt;- sfunc(ages)
rsplreg &lt;- rearrangement(list(ages),splreg)
plot(age,height,pch=21,bg='gray',cex=.5,xlab="Age(years)",
ylab="Height(cms)", main="CEF (Regression Splines)",col='gray')
lines(ages,splreg,col='red',lwd=3)
lines(ages,rsplreg,col='blue',lwd=2)
legend("topleft",c('Original','Rearranged'),lty=1,col=c('red','blue'),bty='n')
detach(GrowthChart)

##rconint example:
## Not run: 
data(GrowthChart)
attach(GrowthChart)

nage &lt;- 2 * pi * (age - min(age)) / (max(age) - min(age))

formula &lt;- height~I(sin(nage))+I(cos(nage))+I(sin(2*nage)) +
            I(cos(2*nage))+I(sin(3*nage))+
            I(cos(3*nage))+ I(sin(4*nage)) + I(cos(4*nage))
			
j &lt;- simconboot(nage,height,lm,formula)
k &lt;- rconint(j)
plot(k, border=NA, col='darkgray')
polygon.conint(j, border=NA, col='lightgray')
polygon.conint(k, border=NA, col='darkgray', density=50)
points(nage,height)
detach(GrowthChart)

## End(Not run)
</code></pre>

<hr>
<h2 id='GrowthChart'>Age and Height of White Males</h2><span id='topic+GrowthChart'></span>

<h3>Description</h3>

<p>This data set contains age and height of US-born white males age two through twenty. Note that age is measured in months and expressed in years, and height is measured in centimeters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(GrowthChart)</code></pre>


<h3>Format</h3>

<p>A data frame with 533 observations on the following 3 variables.
</p>

<dl>
<dt><code>sex</code></dt><dd><p>a numeric vector. Male = 1</p>
</dd>
<dt><code>height</code></dt><dd><p>a numeric vector. Height in cm</p>
</dd>
<dt><code>age</code></dt><dd><p>a numeric vector. Age in years</p>
</dd>
</dl>



<h3>Source</h3>

<p>The data consist of repeated cross sectional measurements of height and age from the 2003-2004 National Health and Nutrition Survey collected by the US National Center for Health Statistics.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(GrowthChart)
attach(GrowthChart)
plot(age,height,pch=21,bg='gray',cex=.5,
xlab="Age (years)",ylab="Height (cms)",col='gray')
detach(GrowthChart)
</code></pre>

<hr>
<h2 id='lclm'>
Local Constant Estimator for Conditional Mean Functions
</h2><span id='topic+lclm'></span>

<h3>Description</h3>

<p>Implements the local nonparametric method kernel estimator&ndash;with box kernel (default), for conditional mean functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lclm(x, y, h, xx)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lclm_+3A_x">x</code></td>
<td>
<p>The conditioning covariate</p>
</td></tr>
<tr><td><code id="lclm_+3A_y">y</code></td>
<td>
<p>The response variable </p>
</td></tr>
<tr><td><code id="lclm_+3A_h">h</code></td>
<td>
<p>The bandwidth parameter </p>
</td></tr>
<tr><td><code id="lclm_+3A_xx">xx</code></td>
<td>
<p>The points at which the function is to be estimated </p>
</td></tr> 
</table>


<h3>Details</h3>

<p>The function uses a box kernel.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>xx</code></td>
<td>
<p>The design points at which the evaluation occurs</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p>The estimated function values at these design points</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wesley Graybill, Mingli Chen, Victor Chernozhukov, Ivan Fernandez-Val, Alfred Galichon
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(GrowthChart)
attach(GrowthChart)

ages &lt;- unique(sort(age))
lclm.fit1 &lt;- lclm(age,height,h=1,xx=ages)

detach(GrowthChart)
</code></pre>

<hr>
<h2 id='lcrq2'>Local Constant Estimator for Conditional Quantile Functions</h2><span id='topic+lcrq2'></span>

<h3>Description</h3>

<p>Implements the local nonparametric method kernel estimator&ndash;with box kernel (default), for conditional quantile functions.
This is a modification of Koenker's <code><a href="quantreg.html#topic+lprq">lprq</a></code> (from package <span class="pkg">quantreg</span>). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lcrq2(x, y, h, xx, tau)
</code></pre>


<h3>Arguments</h3>

  
<table role = "presentation">
<tr><td><code id="lcrq2_+3A_x">x</code></td>
<td>
<p>The conditioning covariate</p>
</td></tr>
<tr><td><code id="lcrq2_+3A_y">y</code></td>
<td>
<p>The response variable </p>
</td></tr>
<tr><td><code id="lcrq2_+3A_h">h</code></td>
<td>
<p>The bandwidth parameter </p>
</td></tr>
<tr><td><code id="lcrq2_+3A_xx">xx</code></td>
<td>
<p>The points at which the function is to be estimated </p>
</td></tr>
<tr><td><code id="lcrq2_+3A_tau">tau</code></td>
<td>
<p>The quantile(s) to be estimated. This should be a list of quantiles if the function estimates the quantile process</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function uses a box kernel.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>xx</code></td>
<td>
<p>The design points at which the evaluation occurs</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p>The estimated function values at these design points</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wesley Graybill, Mingli Chen, Victor Chernozhukov, Ivan Fernandez-Val, Alfred Galichon
</p>


<h3>See Also</h3>

<p><code><a href="quantreg.html#topic+lprq">lprq</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(quantreg)
data(GrowthChart)
attach(GrowthChart)

ages &lt;- unique(sort(age))
lcq.fit1 &lt;- lcrq2(age,height,h=1,xx=ages,tau=0.01)

detach(GrowthChart)
</code></pre>

<hr>
<h2 id='lines.conint'>
Lines Method for Simultaneous Confidence Intervals
</h2><span id='topic+lines.conint'></span>

<h3>Description</h3>

<p>A method for the <code><a href="graphics.html#topic+lines">lines</a></code> generic. It graphs both the upper and lower end-point functions of a confidence interval as lines on a plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
## S3 method for class 'conint'
lines(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lines.conint_+3A_x">x</code></td>
<td>
<p> object of class <code>conint</code></p>
</td></tr>
<tr><td><code id="lines.conint_+3A_...">...</code></td>
<td>
<p> further arguments to <code><a href="graphics.html#topic+lines.default">lines.default</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is intended for plotting confidence intervals produced by the output of <code><a href="#topic+simconboot">simconboot</a></code> or <code><a href="#topic+rconint">rconint</a></code>.
</p>


<h3>Author(s)</h3>

<p>Wesley Graybill, Mingli Chen, Victor Chernozhukov, Ivan Fernandez-Val, Alfred Galichon
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+lines">lines</a></code>,<code><a href="#topic+plot.conint">plot.conint</a></code>,<code><a href="#topic+points.conint">points.conint</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(GrowthChart)
attach(GrowthChart)

nage &lt;- 2*pi*(age-min(age))/(max(age)-min(age))
formula&lt;-height~I(sin(nage))+I(cos(nage))+I(sin(2*nage))+
          I(cos(2*nage))+I(sin(3*nage))+ I(cos(3*nage))+I(sin(4*nage))+I(cos(4*nage))		  
		  
j&lt;-simconboot(nage,height,lm,formula)
plot(nage,height,pch=21,bg='gray',cex=.5,xlab="Age (years)",ylab="Height (cms)",col='gray',xaxt='n')
axis(1, at = seq(-2*pi*min(age)/(max(age)-min(age)), 
     2*pi+1, by=5*2*pi/(max(age)-min(age))), label = seq(0, max(age)+1, by=5))
lines(j)

detach(GrowthChart)
</code></pre>

<hr>
<h2 id='lplm'>
Local Linear Regression Methods for Conditional Mean Functions
</h2><span id='topic+lplm'></span>

<h3>Description</h3>

<p>Implements the local nonparametric method, local linear regression estimator with box kernel (default), for conditional mean functions. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lplm(x, y, h, xx)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lplm_+3A_x">x</code></td>
<td>
<p>The conditioning covariate</p>
</td></tr>
<tr><td><code id="lplm_+3A_y">y</code></td>
<td>
<p>The response variable </p>
</td></tr>
<tr><td><code id="lplm_+3A_h">h</code></td>
<td>
<p>The bandwidth parameter </p>
</td></tr>
<tr><td><code id="lplm_+3A_xx">xx</code></td>
<td>
<p>The points at which the function is to be estimated </p>
</td></tr>  
</table>


<h3>Details</h3>

<p>The function uses a box kernel.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>xx</code></td>
<td>
<p>The design points at which the evaluation occurs</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p>The estimated function values at these design points</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wesley Graybill, Mingli Chen, Victor Chernozhukov, Ivan Fernandez-Val, Alfred Galichon
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(GrowthChart)
attach(GrowthChart)

ages &lt;- unique(sort(age))
lplm.fit1 &lt;- lplm(age,height,h=1,xx=ages)

detach(GrowthChart)
</code></pre>

<hr>
<h2 id='lprq2'>
Local Linear Regression Methods for Conditional Quantile Functions
</h2><span id='topic+lprq2'></span>

<h3>Description</h3>

<p>Implements the local nonparametric method, local linear regression estimator with box kernel (default), for conditional quantile functions.
This is a modification of Koenker's <code><a href="quantreg.html#topic+lprq">lprq</a></code> ( from package <span class="pkg">quantreg</span>). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lprq2(x, y, h, xx, tau)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lprq2_+3A_x">x</code></td>
<td>
<p>The conditioning covariate</p>
</td></tr>
<tr><td><code id="lprq2_+3A_y">y</code></td>
<td>
<p>The response variable </p>
</td></tr>
<tr><td><code id="lprq2_+3A_h">h</code></td>
<td>
<p>The bandwidth parameter </p>
</td></tr>
<tr><td><code id="lprq2_+3A_xx">xx</code></td>
<td>
<p>The points at which the function is to be estimated </p>
</td></tr>
<tr><td><code id="lprq2_+3A_tau">tau</code></td>
<td>
<p>The quantile(s) to be estimated. This should be a list of quantiles if the function estimates the quantile process</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function uses a box kernel.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>xx</code></td>
<td>
<p>The design points at which the evaluation occurs</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p>The estimated function values at these design points</p>
</td></tr>	
</table>


<h3>Author(s)</h3>

<p>Wesley Graybill, Mingli Chen, Victor Chernozhukov, Ivan Fernandez-Val, Alfred Galichon
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(quantreg)
data(GrowthChart)
attach(GrowthChart)

ages &lt;- unique(sort(age))
llq.fit1 &lt;- lprq2(age,height,h=1,xx=ages,tau=0.2)
detach(GrowthChart)
</code></pre>

<hr>
<h2 id='plot.conint'>
Plot Method for Simultaneous Confidence Intervals
</h2><span id='topic+plot.conint'></span>

<h3>Description</h3>

<p>A method for the <code><a href="graphics.html#topic+plot">plot</a></code> generic. It graphs both the upper and lower end-point functions of a confidence interval as an unfilled polygon.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'conint'
plot(x, border, col, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.conint_+3A_x">x</code></td>
<td>
<p>object of class <code>conint</code></p>
</td></tr>
<tr><td><code id="plot.conint_+3A_border">border</code>, <code id="plot.conint_+3A_col">col</code></td>
<td>
<p>same usage as in <code><a href="graphics.html#topic+polygon">polygon</a></code></p>
</td></tr>
<tr><td><code id="plot.conint_+3A_...">...</code></td>
<td>
<p>further arguments to <code><a href="graphics.html#topic+plot.default">plot.default</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is intended for plotting confidence intervals produced by the output of <code><a href="#topic+simconboot">simconboot</a></code> or <code><a href="#topic+rconint">rconint</a></code>.
</p>


<h3>Author(s)</h3>

<p>Wesley Graybill, Mingli Chen, Victor Chernozhukov, Ivan Fernandez-Val, Alfred Galichon
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+plot">plot</a></code>, <code><a href="#topic+lines.conint">lines.conint</a></code>, <code><a href="#topic+points.conint">points.conint</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(GrowthChart)
attach(GrowthChart)

nage &lt;- 2 * pi * (age - min(age)) / (max(age) - min(age))
formula &lt;- height ~ I(sin(nage))+I(cos(nage))+I(sin(2*nage))+I(cos(2*nage))+
            I(sin(3*nage))+I(cos(3*nage))+ I(sin(4*nage))+I(cos(4*nage))
j&lt;-simconboot(nage,height,lm,formula)
plot(j)
points(nage,height)

detach(GrowthChart)
</code></pre>

<hr>
<h2 id='points.conint'>
Points Method for Simultaneous Confidence Intervals
</h2><span id='topic+points.conint'></span>

<h3>Description</h3>

<p>A method for the <code><a href="graphics.html#topic+points">points</a></code> generic. It graphs both the upper and lower end-point functions of a confidence interval as points on a plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'conint'
points(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="points.conint_+3A_x">x</code></td>
<td>
<p>object of class <code>conint</code></p>
</td></tr>
<tr><td><code id="points.conint_+3A_...">...</code></td>
<td>
<p>further arguments to <code><a href="graphics.html#topic+points.default">points.default</a></code></p>
</td></tr> 
</table>


<h3>Details</h3>

<p>This is intended for plotting confidence intervals produced by the output of <code><a href="#topic+simconboot">simconboot</a></code> or <code><a href="#topic+rconint">rconint</a></code>.
</p>


<h3>Author(s)</h3>

<p>Wesley Graybill, Mingli Chen, Victor Chernozhukov, Ivan Fernandez-Val, Alfred Galichon
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+points">points</a></code>, <code><a href="#topic+plot.conint">plot.conint</a></code>, <code><a href="#topic+lines.conint">lines.conint</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(GrowthChart)
attach(GrowthChart)

nage &lt;- 2 * pi * (age - min(age)) / (max(age) - min(age))
formula&lt;-height~I(sin(nage))+I(cos(nage))+I(sin(2*nage))+I(cos(2*nage))+
          I(sin(3*nage))+I(cos(3*nage))+I(sin(4*nage))+I(cos(4*nage))
j &lt;- simconboot(nage,height,lm,formula)
plot(nage,height,pch=21,bg='gray',cex=.5,xlab="Age (years)",ylab="Height (cms)",col="gray")
points(j)

detach(GrowthChart)
</code></pre>

<hr>
<h2 id='polygon.conint'>
polygon Method for Simultaneous Confidence Intervals
</h2><span id='topic+polygon.conint'></span>

<h3>Description</h3>

<p><code>polygon.conint</code> graphs both the upper and lower end-point functions of a confidence interval as a standard polygon on a plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>polygon.conint(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="polygon.conint_+3A_x">x</code></td>
<td>
<p>object of class <code>conint</code></p>
</td></tr>
<tr><td><code id="polygon.conint_+3A_...">...</code></td>
<td>
<p>further arguments to <code><a href="graphics.html#topic+polygon">polygon</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is intended for plotting confidence intervals produced by the output of <code><a href="#topic+simconboot">simconboot</a></code> or <code><a href="#topic+rconint">rconint</a></code>.
</p>


<h3>Author(s)</h3>

<p>Wesley Graybill, Mingli Chen, Victor Chernozhukov, Ivan Fernandez-Val, Alfred Galichon
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+polygon">polygon</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: data(GrowthChart)
attach(GrowthChart)

nage &lt;- 2 * pi * (age - min(age)) / (max(age) - min(age))
formula &lt;- height~I(sin(nage))+I(cos(nage))+I(sin(2*nage))+I(cos(2*nage))+
            I(sin(3*nage))+I(cos(3*nage))+I(sin(4*nage))+I(cos(4*nage))
j&lt;-simconboot(nage,height,lm,formula)
plot(nage,height,pch=21,bg='gray',cex=0.5,xlab="Age (years)",
     ylab="Height (cms)",col='gray',xaxt='n')
axis(1, at = seq(-2*pi*min(age)/(max(age)-min(age)), 
        2*pi+1,by=5*2*pi/(max(age)-min(age))), label = seq(0, max(age)+1, by=5))
polygon.conint(j, border=NA, col='darkgray')

detach(GrowthChart)
## End(Not run)

</code></pre>

<hr>
<h2 id='rconint'>Rearrangement of Simultaneous Confidence Intervals</h2><span id='topic+rconint'></span>

<h3>Description</h3>

<p>Uses <code><a href="#topic+rearrangement">rearrangement</a></code> to apply the rearrangement operator to objects of class <code>conint</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>rconint(x, n = 100, stochastic = FALSE, avg = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rconint_+3A_x">x</code></td>
<td>
<p>object of class <code>conint</code></p>
</td></tr>
<tr><td><code id="rconint_+3A_n">n</code></td>
<td>
<p>an integer denoting the number of sample points desired</p>
</td></tr>
<tr><td><code id="rconint_+3A_stochastic">stochastic</code></td>
<td>
<p>logical. If TRUE, stochastic sampling will be used</p>
</td></tr>
<tr><td><code id="rconint_+3A_avg">avg</code></td>
<td>
<p>logical. If TRUE, the average rearrangement will be computed and outputed</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Implements the rearrangement operator of <code><a href="#topic+rearrangement">rearrangement</a></code> on simultaneous confidence intervals. Intended for use on output of <code><a href="#topic+simconboot">simconboot</a></code>.
</p>


<h3>Value</h3>

<p>An object of class <code>conint</code> with the following elements:
</p>
<table role = "presentation">
<tr><td><code>x</code></td>
<td>
<p>the original x data</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>the original y data</p>
</td></tr>
<tr><td><code>sortedx</code></td>
<td>
<p>the original x data, sorted with repeated elements removed</p>
</td></tr>
<tr><td><code>Lower</code></td>
<td>
<p>the rearranged lower end-point function. Represented as a vector of values corresponding to sortedx</p>
</td></tr>
<tr><td><code>Upper</code></td>
<td>
<p>the rearranged upper end-point function. Represented as a vector of values corresponding to sortedx</p>
</td></tr>
<tr><td><code>cef</code></td>
<td>
<p>the corresponding estimates</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wesley Graybill, Mingli Chen, Victor Chernozhukov, Ivan Fernandez-Val, Alfred Galichon
</p>


<h3>References</h3>

<p>Chernozhukov, V., I. Fernandez-Val, and a. Galichon. 2009. Improving point and interval estimators of monotone functions by rearrangement. Biometrika 96 (3): 559-575. 
</p>
<p>Chernozhukov, V., I. Fernandez-Val, and a. Galichon. 2010. Quantile and Probability Curves Without Crossing. Econometrica 78(3): 1093-1125.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+simconboot">simconboot</a></code>, <code><a href="#topic+rearrangement">rearrangement</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(GrowthChart)
attach(GrowthChart)

nage &lt;- 2 * pi * (age - min(age)) / (max(age) - min(age))
formula &lt;- height ~ I(sin(nage))+I(cos(nage))+I(sin(2*nage))+I(cos(2*nage))+
            I(sin(3*nage))+I(cos(3*nage))+I(sin(4*nage))+I(cos(4*nage))
j &lt;- simconboot(nage,height,lm,formula)
k &lt;- rconint(j)
plot(k, border=NA, col='darkgray',xlab = 'Age (years)',ylab = 'Height (cms)',xaxt = "n")
axis(1, at = seq(-2*pi*min(age)/(max(age)-min(age)), 
        2*pi+1,by=5*2*pi/(max(age)-min(age))), label = seq(0, max(age)+1, by=5))
polygon.conint(j, border=NA, col='lightgray')
polygon.conint(k, border=NA, col='darkgray', density=50)
points(nage,height,col='gray80')
legend(min(nage),max(height),c("95% CI Original",
       "95% CI  Rearranged"),lty=c(1,1),lwd=c(2,2),
       col=c("lightgray","darkgray"),bty="n");
detach(GrowthChart)

## End(Not run)
</code></pre>

<hr>
<h2 id='rearrangement'>Rearrangement</h2><span id='topic+rearrangement'></span>

<h3>Description</h3>

<p>Monotonize a step function by rearrangement. Returns a matrix or array of points which are monotonic, or a monotonic function performing linear (or constant) interpolation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rearrangement(x,y,n=1000,stochastic=FALSE,avg=TRUE,order=1:length(x))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rearrangement_+3A_x">x</code></td>
<td>
<p>a list or data frame, the entries of which are vectors containing the x values corresponding to the fitted y values</p>
</td></tr>
<tr><td><code id="rearrangement_+3A_y">y</code></td>
<td>
<p>a vector, matrix, or three-dimensional array containing the fitted values of a model, typically the result of a regression</p>
</td></tr>
<tr><td><code id="rearrangement_+3A_n">n</code></td>
<td>
<p>an integer denoting the number of sample points desired</p>
</td></tr>
<tr><td><code id="rearrangement_+3A_stochastic">stochastic</code></td>
<td>
<p>logical. If TRUE, stochastic sampling will be used</p>
</td></tr>
<tr><td><code id="rearrangement_+3A_avg">avg</code></td>
<td>
<p>logical. If TRUE, the average rearrangement will be computed and outputted</p>
</td></tr>
<tr><td><code id="rearrangement_+3A_order">order</code></td>
<td>
<p>a vector containing the desired permutation of the elements of 1:length(x). The rearrangement will be performed in the order specified if avg= FALSE, otherwise all the possible orderings are computed and the average rearrangement is reported</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function applies this rearrangement operator of Hardy, Littlewood, and Polya (1952) to the estimate of a monotone function.
</p>
<p>Note: <code><a href="#topic+rearrangement">rearrangement</a></code> currently only operates on univariate, bivariate, and trivariate regressions (that is, length(x)&lt;=3). 
</p>


<h3>Value</h3>

<p><code>rearrangement</code> returns a matrix or array of equivalent dimension and size to y that is monotonically increasing in all of its dimensions.
</p>


<h3>Author(s)</h3>

<p>Wesley Graybill, Mingli Chen, Victor Chernozhukov, Ivan Fernandez-Val, Alfred Galichon
</p>


<h3>References</h3>

<p>Chernozhukov, V., I. Fernandez-Val, and a. Galichon. 2009. Improving point and interval estimators of monotone functions by rearrangement. Biometrika 96 (3): 559-575.
</p>
<p>Chernozhukov, V., I. Fernandez-Val, and a. Galichon. 2010. Quantile and Probability Curves Without Crossing. Econometrica 78(3): 1093-1125.
</p>
<p>Hardy, G.H., J.E. Littlewood, and G. Polya, Inequalities,2nd ed, Cambridge U. Press,1952
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rconint">rconint</a></code>, <code><a href="stats.html#topic+quantile">quantile</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##Univariate example:
library(splines)
data(GrowthChart)
attach(GrowthChart)

ages &lt;- unique(sort(age))
aknots &lt;- c(3, 5, 8, 10, 11.5, 13, 14.5, 16, 18)
splines_age &lt;- bs(age,kn=aknots)
sformula &lt;- height~splines_age
sfunc &lt;- approxfun(age,lm(sformula)$fitted.values)
splreg &lt;- sfunc(ages)
rsplreg &lt;- rearrangement(list(ages),splreg)
plot(age,height,pch=21,bg='gray',cex=.5,xlab="Age (years)",ylab="Height (cms)",
     main="CEF (Regression Splines)",col='gray')
lines(ages,splreg,col='red',lwd=3)
lines(ages,rsplreg,col='blue',lwd=2)
legend("topleft",c('Original','Rearranged'),lty=1,col=c('red','blue'),bty='n')
detach(GrowthChart)

##Bivariate example:
## Not run: library(quantreg)
data(GrowthChart)
attach(GrowthChart)

ages &lt;- unique(sort(age))
taus &lt;- c(1:999)/1000
nage &lt;- 2 * pi * (age - min(age)) / (max(age) - min(age))
nages &lt;- 2 * pi * (ages - min(ages)) / (max(ages) - min(ages))
fform &lt;- height ~ I(sin(nage))+I(cos(nage))+I(sin(2*nage))+I(cos(2*nage))+
          I(sin(3*nage))+I(cos(3*nage))+I(sin(4*nage))+I(cos(4*nage))
ffit &lt;- rq(fform, tau = taus)
fcoefs &lt;- t(ffit$coef)
freg &lt;- rbind(1, sin(nages), cos(nages), sin(2*nages), 
              cos(2*nages),sin(3*nages), cos(3*nages), sin(4*nages), cos(4*nages) )
fcqf &lt;- crossprod(t(fcoefs),freg)
rrfcqf &lt;- rearrangement(list(taus,ages),fcqf, avg=TRUE)
tdom &lt;-c(1,10*c(1:99),999)
adom &lt;-c(1,5*c(1:floor(length(ages)/5)), length(ages))

par(mfrow=c(2,1))
persp(taus[tdom],ages[adom],rrfcqf[tdom,adom],xlab='quantile',
      ylab='age',zlab='height',col='lightgreen',theta=315,phi=25,shade=.5)
title("CQP: Average Quantile/Age Rearrangement")
contour(taus,ages,rrfcqf,xlab='quantile',ylab='age',col='green',
        levels=10*c(ceiling(min(fcqf)/10):floor(max(fcqf)/10)))
title("CQP: Contour (RR-Quantile/Age)")

detach(GrowthChart)

## End(Not run)
</code></pre>

<hr>
<h2 id='simconboot'>
Simultaneous Confidence Interval Estimation using Bootstrap
</h2><span id='topic+simconboot'></span>

<h3>Description</h3>

<p><code>simconboot</code> obtains a simultaneous confidence interval for a function. It estimates the lower and upper endpoint functions of the interval by bootstrap.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simconboot(x,y,estimator,formula,B=200,alpha=0.05,sampsize=length(x),
           seed=8,colInt=c(5:39)/2,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simconboot_+3A_x">x</code></td>
<td>
<p>a numerical vector of x values</p>
</td></tr>
<tr><td><code id="simconboot_+3A_y">y</code></td>
<td>
<p>a numerical vector of y values</p>
</td></tr>
<tr><td><code id="simconboot_+3A_estimator">estimator</code></td>
<td>
<p>estimator to be used in regression</p>
</td></tr>
<tr><td><code id="simconboot_+3A_formula">formula</code></td>
<td>
<p>formula to be used in the estimator</p>
</td></tr>
<tr><td><code id="simconboot_+3A_b">B</code></td>
<td>
<p>an integer with the number of bootstrap repetitions</p>
</td></tr>
<tr><td><code id="simconboot_+3A_alpha">alpha</code></td>
<td>
<p>a real number between 0 and 1 reflecting the desired confidence level</p>
</td></tr>
<tr><td><code id="simconboot_+3A_sampsize">sampsize</code></td>
<td>
<p>an integer with the sample size of each bootstrap repetition</p>
</td></tr>
<tr><td><code id="simconboot_+3A_seed">seed</code></td>
<td>
<p>if desired, seed to be set for the random number generator</p>
</td></tr>
<tr><td><code id="simconboot_+3A_colint">colInt</code></td>
<td>
<p>the points to be evaluated when ploting</p>
</td></tr>
<tr><td><code id="simconboot_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to the estimator</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>estimator</code> can be any of a set of standard regression models, most commonly <code><a href="stats.html#topic+lm">lm</a></code> or <code><a href="quantreg.html#topic+rq">rq</a></code> (from package <span class="pkg">quantreg</span>)  for global
estimators and the built-in functions <code><a href="#topic+lclm">lclm</a></code>, <code><a href="#topic+lplm">lplm</a></code>, <code><a href="#topic+lcrq2">lcrq2</a></code>, <code><a href="#topic+lprq2">lprq2</a></code> for local estimators. 
</p>
<p>Note: formula=0 for all the local estimators.
</p>


<h3>Value</h3>

<p>An object of class <code>conint</code> with the following elements:
</p>
<table role = "presentation">
<tr><td><code>x</code></td>
<td>
<p>the original x data</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>the original y data</p>
</td></tr>
<tr><td><code>sortedx</code></td>
<td>
<p>the original x data, sorted with repeated elements removed</p>
</td></tr>
<tr><td><code>Lower</code></td>
<td>
<p>the lower endpoint function. Represented as a vector of values corresponding to sortedx</p>
</td></tr>
<tr><td><code>Upper</code></td>
<td>
<p>the upper endpoint function. Represented as a vector of values corresponding to sortedx</p>
</td></tr>
<tr><td><code>cef</code></td>
<td>
<p>the corresponding estimates</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wesley Graybill, Mingli Chen, Victor Chernozhukov, Ivan Fernandez-Val, Alfred Galichon
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rconint">rconint</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(GrowthChart)
attach(GrowthChart)

nage &lt;- 2 * pi * (age - min(age)) / (max(age) - min(age))
nages &lt;- unique(sort(nage))
formula &lt;- height~I(sin(nage))+I(cos(nage))+I(sin(2*nage))+I(cos(2*nage))+
            I(sin(3*nage))+I(cos(3*nage))+I(sin(4*nage))+I(cos(4*nage))
j &lt;- simconboot(nage,height,lm,formula)
plot(j, border=NA, col='darkgray',xlab = 'Age (years)',ylab = 'Height (cms)',xaxt = "n")
axis(1, at = seq(-2*pi*min(age)/(max(age)-min(age)), 2*pi+1,
        by=5*2*pi/(max(age)-min(age))), label = seq(0, max(age)+1, by=5))
points(nage,height)
lines(nages, j$cef, lty=2, col='green')

detach(GrowthChart)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
