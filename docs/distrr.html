<!DOCTYPE html><html><head><title>Help for package distrr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {distrr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#combn_char'><p>Generate all combinations of the elements of a character vector</p></a></li>
<li><a href='#dcc'><p>Data cube creation (dcc)</p></a></li>
<li><a href='#dcc6'><p>Data cube creation</p></a></li>
<li><a href='#distrr'><p>Estimate and manage empirical distributions</p></a></li>
<li><a href='#extract_unique'><p>Functions to be used in conjunction with 'dcc' family</p></a></li>
<li><a href='#Fhat_conditional_'><p>Weighted empirical cumulative distribution function (ecdf), conditional on one or more variables</p></a></li>
<li><a href='#Fhat_df_'><p>Weighted empirical cumulative distribution function (data frame version)</p></a></li>
<li><a href='#invented_wages'><p>Invented dataset with wages of men and women.</p></a></li>
<li><a href='#jointfun_'><p>A minimal function which counts the number of observations by groups in a data frame</p></a></li>
<li><a href='#only_joint'><p>Keeps only joint distribution (removes '.total').</p></a></li>
<li><a href='#reexports'><p>Objects exported from other packages</p></a></li>
<li><a href='#wq'><p>Empirical weighted quantile</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Estimate and Manage Empirical Distributions</td>
</tr>
<tr>
<td>Description:</td>
<td>Tools to estimate and manage empirical distributions,
    which should work with survey data. One of the main features is the 
    possibility to create data cubes of estimated statistics, that include
    all the combinations of the variables of interest (see for example functions
    dcc5() and dcc6()).</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1.2)</td>
</tr>
<tr>
<td>Imports:</td>
<td>magrittr (&ge; 1.5), dplyr (&ge; 0.7.4), rlang, utils, stats,
tidyr (&ge; 0.7.0)</td>
</tr>
<tr>
<td>Version:</td>
<td>0.0.6</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://gibonet.github.io/distrr">https://gibonet.github.io/distrr</a>,
<a href="https://github.com/gibonet/distrr">https://github.com/gibonet/distrr</a></td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Sandro Petrillo Burri &lt;gibo.gaf@gmail.com&gt;</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>Collate:</td>
<td>"distrr.R" "invented_data.R" "compat-lazyeval.R"
"dplyr_new_wrappers.R" "gibutils.R" "jointfuns.R"
"Fhat_conditional.R" "distrr_funs.R" "dcc_new.R" "wq_df.R"
"dcc6_fixed.R"</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-07-14 07:53:48 UTC; gibo</td>
</tr>
<tr>
<td>Author:</td>
<td>Sandro Petrillo Burri [aut, cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-07-14 09:20:07 UTC</td>
</tr>
</table>
<hr>
<h2 id='combn_char'>Generate all combinations of the elements of a character vector</h2><span id='topic+combn_char'></span>

<h3>Description</h3>

<p>Generate all combinations of the elements of a character vector
</p>


<h3>Usage</h3>

<pre><code class='language-R'>combn_char(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="combn_char_+3A_x">x</code></td>
<td>
<p>a character vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a nested list. A list whose elements are lists containing the 
character vectors with the combinations of their elements.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>combn_char(c("gender", "sector"))
combn_char(c("gender", "sector", "education"))
</code></pre>

<hr>
<h2 id='dcc'>Data cube creation (dcc)</h2><span id='topic+dcc'></span><span id='topic+dcc2'></span><span id='topic+dcc5'></span>

<h3>Description</h3>

<p>Data cube creation (dcc)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dcc(.data, .variables, .fun = jointfun_, ...)

dcc2(.data, .variables, .fun = jointfun_, order_type = extract_unique2, ...)

dcc5(
  .data,
  .variables,
  .fun = jointfun_,
  .total = "Totale",
  order_type = extract_unique4,
  .all = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dcc_+3A_.data">.data</code></td>
<td>
<p>data frame to be processed</p>
</td></tr>
<tr><td><code id="dcc_+3A_.variables">.variables</code></td>
<td>
<p>variables to split data frame by, as a character vector 
(<code>c("var1", "var2")</code>).</p>
</td></tr>
<tr><td><code id="dcc_+3A_.fun">.fun</code></td>
<td>
<p>function to apply to each piece (default: <code><a href="#topic+jointfun_">jointfun_</a></code>)</p>
</td></tr>
<tr><td><code id="dcc_+3A_...">...</code></td>
<td>
<p>additional functions passed to <code>.fun</code>.</p>
</td></tr>
<tr><td><code id="dcc_+3A_order_type">order_type</code></td>
<td>
<p>a function like <code><a href="#topic+extract_unique">extract_unique</a></code> or 
<code><a href="#topic+extract_unique2">extract_unique2</a></code>.</p>
</td></tr>
<tr><td><code id="dcc_+3A_.total">.total</code></td>
<td>
<p>character string with the name to give to the subset of data
that includes all the observations of a variable (default: <code>"Totale"</code>).</p>
</td></tr>
<tr><td><code id="dcc_+3A_.all">.all</code></td>
<td>
<p>logical, indicating if functions' have to be evaluated on the 
complete dataset.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data cube, with a column for each cateogorical variable used, and a row for each combination of all the categorical variables' modalities. In addition to all the modalities, each variable will also have a &quot;Total&quot; possibility, which includes all the others. The data cube will contain marginal, conditional and joint empirical distributions...
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("invented_wages")
str(invented_wages)
tmp &lt;- dcc(.data = invented_wages, 
           .variables = c("gender", "sector"), .fun = jointfun_)
tmp
str(tmp)
tmp2 &lt;- dcc2(.data = invented_wages, 
            .variables = c("gender", "education"), 
            .fun = jointfun_, 
            order_type = extract_unique2)
tmp2
str(tmp2)

# dcc5 works like dcc2, but has an additional optional argument, .total,
# that can be added to give a name to the groups that include all the 
# observations of a variable.
tmp5 &lt;- dcc5(.data = invented_wages, 
            .variables = c("gender", "education"),
            .fun = jointfun_,
            .total = "TOTAL",
            order_type = extract_unique2)
tmp5

</code></pre>

<hr>
<h2 id='dcc6'>Data cube creation</h2><span id='topic+dcc6'></span><span id='topic+dcc6_fixed'></span>

<h3>Description</h3>

<p>Data cube creation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dcc6(
  .data,
  .variables,
  .funs_list = list(n = ~dplyr::n()),
  .total = "Totale",
  order_type = extract_unique4,
  .all = TRUE
)

dcc6_fixed(
  .data,
  .variables,
  .funs_list = list(n = ~dplyr::n()),
  .total = "Totale",
  order_type = extract_unique5,
  .all = TRUE,
  fixed_variable = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dcc6_+3A_.data">.data</code></td>
<td>
<p>data frame to be processed.</p>
</td></tr>
<tr><td><code id="dcc6_+3A_.variables">.variables</code></td>
<td>
<p>variables to split data frame by, as a character vector 
(<code>c("var1", "var2")</code>).</p>
</td></tr>
<tr><td><code id="dcc6_+3A_.funs_list">.funs_list</code></td>
<td>
<p>a list of function calls in the form of right-hand formula.</p>
</td></tr>
<tr><td><code id="dcc6_+3A_.total">.total</code></td>
<td>
<p>character string with the name to give to the subset of data
that includes all the observations of a variable (default: <code>"Totale"</code>).</p>
</td></tr>
<tr><td><code id="dcc6_+3A_order_type">order_type</code></td>
<td>
<p>a function like <code><a href="#topic+extract_unique">extract_unique</a></code> or 
<code><a href="#topic+extract_unique2">extract_unique2</a></code>.</p>
</td></tr>
<tr><td><code id="dcc6_+3A_.all">.all</code></td>
<td>
<p>logical, indicating if functions have to be evaluated on the 
complete dataset.</p>
</td></tr>
<tr><td><code id="dcc6_+3A_fixed_variable">fixed_variable</code></td>
<td>
<p>name of the variable for which you do not want to estimate the total</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>dcc6(invented_wages,
     .variables = c("gender", "sector"), 
     .funs_list = list(n = ~dplyr::n()),
     .all = TRUE)
     
dcc6(invented_wages,
     .variables = c("gender", "sector"), 
     .funs_list = list(n = ~dplyr::n()),
     .all = FALSE)

</code></pre>

<hr>
<h2 id='distrr'>Estimate and manage empirical distributions</h2><span id='topic+distrr'></span>

<h3>Description</h3>

<p>Tools to estimate and manage empirical distributions,
which should work with survey data. One of the main features is the 
possibility to create data cubes of estimated statistics, that include
all the combinations of the variables of interest (see for example functions
dcc5() and dcc6()).
</p>

<hr>
<h2 id='extract_unique'>Functions to be used in conjunction with 'dcc' family</h2><span id='topic+extract_unique'></span><span id='topic+extract_unique2'></span><span id='topic+extract_unique3'></span><span id='topic+extract_unique4'></span><span id='topic+extract_unique5'></span>

<h3>Description</h3>

<p>Functions to be used in conjunction with 'dcc' family
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_unique(df)

extract_unique2(df)

extract_unique3(df)

extract_unique4(df)

extract_unique5(df)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extract_unique_+3A_df">df</code></td>
<td>
<p>a data frame</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list whose elements are character vectors of the unique values of each column
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("invented_wages")
tmp &lt;- extract_unique(df = invented_wages[ , c("gender", "sector")])
tmp
str(tmp)
</code></pre>

<hr>
<h2 id='Fhat_conditional_'>Weighted empirical cumulative distribution function (ecdf), conditional on one or more variables</h2><span id='topic+Fhat_conditional_'></span>

<h3>Description</h3>

<p>Weighted empirical cumulative distribution function (ecdf), conditional on one or more variables
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Fhat_conditional_(.data, .variables, x, weights)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Fhat_conditional__+3A_.data">.data</code></td>
<td>
<p>a data frame</p>
</td></tr>
<tr><td><code id="Fhat_conditional__+3A_.variables">.variables</code></td>
<td>
<p>a character vector with one or more column names</p>
</td></tr>
<tr><td><code id="Fhat_conditional__+3A_x">x</code></td>
<td>
<p>character vector of length one, with the name of the numeric column whose conditional ecdf has to be estimated</p>
</td></tr>
<tr><td><code id="Fhat_conditional__+3A_weights">weights</code></td>
<td>
<p>character vector of length one, indicating the name of the positive numeric column of weights, which will be used in the estimation of the conditional ecdf</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data frame, with the variables used to condition, the x variable, and columns wsum (aggregated sum of weights, based on unique values of x) and Fhat (the estimated conditional Fhat). In addition to data frame, the object will be of classes grouped_df, tbl_df and tbl (from package dplyr)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Fhat_conditional_(mtcars,
                 .variables = c("vs", "am"),
                 x = "mpg",
                 weights = "cyl")
</code></pre>

<hr>
<h2 id='Fhat_df_'>Weighted empirical cumulative distribution function (data frame version)</h2><span id='topic+Fhat_df_'></span>

<h3>Description</h3>

<p>Weighted empirical cumulative distribution function (data frame version)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Fhat_df_(.data, x, weights)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Fhat_df__+3A_.data">.data</code></td>
<td>
<p>a data frame</p>
</td></tr>
<tr><td><code id="Fhat_df__+3A_x">x</code></td>
<td>
<p>name of the numeric column (as character)</p>
</td></tr>
<tr><td><code id="Fhat_df__+3A_weights">weights</code></td>
<td>
<p>name of the weight column (as character)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data frame with columns: x, wcum and Fhat
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(invented_wages)
Fhat_df_(invented_wages, "wage", "sample_weights")
</code></pre>

<hr>
<h2 id='invented_wages'>Invented dataset with wages of men and women.</h2><span id='topic+invented_wages'></span>

<h3>Description</h3>

<p>This dataset has been completely invented, in order to do some examples
with the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>invented_wages
</code></pre>


<h3>Format</h3>

<p>A data frame (tibble) with 1000 rows and 5 variables:
</p>

<dl>
<dt><code>gender</code></dt><dd><p>gender of the worker (<code>men</code> or <code>women</code>)</p>
</dd>
<dt><code>sector</code></dt><dd><p>economic sector where the worker is employed (<code>secondary</code> or <code>tertiary</code>)</p>
</dd>
<dt><code>education</code></dt><dd><p>educational level of the worker (<code>I</code>, <code>II</code> or <code>III</code>)</p>
</dd>
<dt><code>wage</code></dt><dd><p>monthly wage of the worker (in an invented currency)</p>
</dd>
<dt><code>sample_weights</code></dt><dd><p>sampling weights</p>
</dd>
</dl>



<h3>Details</h3>

<p>Every row of the dataset consists in a fake/invented individual worker.
For every individual there is his/her gender, the economic sector in which
he/she works, his/her level of education and his/her wage. Furthermore
there is a column with the sampling weights.
</p>

<hr>
<h2 id='jointfun_'>A minimal function which counts the number of observations by groups in a data frame</h2><span id='topic+jointfun_'></span>

<h3>Description</h3>

<p>A minimal function which counts the number of observations by groups in a data frame
</p>


<h3>Usage</h3>

<pre><code class='language-R'>jointfun_(.data, .variables, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="jointfun__+3A_.data">.data</code></td>
<td>
<p>data frame to be processed</p>
</td></tr>
<tr><td><code id="jointfun__+3A_.variables">.variables</code></td>
<td>
<p>variables to split data frame by, as a character vector (<code>c("var1", "var2")</code>).</p>
</td></tr>
<tr><td><code id="jointfun__+3A_...">...</code></td>
<td>
<p>additional function calls to be applied on the .data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data frame, with a column for each cateogrical variable used, and a row for each combination of all the categorical variables' modalities.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("invented_wages")
tmp &lt;- jointfun_(.data = invented_wages, .variables = c("gender", "sector"))
tmp
str(tmp)
</code></pre>

<hr>
<h2 id='only_joint'>Keeps only joint distribution (removes '.total').</h2><span id='topic+only_joint'></span>

<h3>Description</h3>

<p>Removes all the rows where variables have value <code>.total</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>only_joint(.cube, .total = "Totale", .variables = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="only_joint_+3A_.cube">.cube</code></td>
<td>
<p>a datacube with 'Totale' modalities</p>
</td></tr>
<tr><td><code id="only_joint_+3A_.total">.total</code></td>
<td>
<p>modality to eliminate (filter out) (default: &quot;Totale&quot;)</p>
</td></tr>
<tr><td><code id="only_joint_+3A_.variables">.variables</code></td>
<td>
<p>a character vector with the names of the categorical variables</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a subset of the data cube with only the combinations of all variables modalities, without the &quot;margins&quot;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(invented_wages)
str(invented_wages)

vars &lt;- c("gender", "education")
tmp &lt;- dcc2(.data = invented_wages, 
            .variables = vars, 
            .fun = jointfun_, 
            order_type = extract_unique2)
tmp
str(tmp)
only_joint(tmp, .variables = vars)

# Compare dimensions (number of groups)
dim(tmp)
dim(only_joint(tmp, .variables = vars))
</code></pre>

<hr>
<h2 id='reexports'>Objects exported from other packages</h2><span id='topic+reexports'></span><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>These objects are imported from other packages. Follow the links
below to see their documentation.
</p>

<dl>
<dt>magrittr</dt><dd><p><code><a href="magrittr.html#topic+pipe">%&gt;%</a></code></p>
</dd>
</dl>

<hr>
<h2 id='wq'>Empirical weighted quantile</h2><span id='topic+wq'></span>

<h3>Description</h3>

<p>Empirical weighted quantile
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wq(x, weights, probs = c(0.5))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wq_+3A_x">x</code></td>
<td>
<p>A numeric vector</p>
</td></tr>
<tr><td><code id="wq_+3A_weights">weights</code></td>
<td>
<p>A vector of (positive) sample weights</p>
</td></tr>
<tr><td><code id="wq_+3A_probs">probs</code></td>
<td>
<p>a numeric vector with the desired quantile levels (default 0.5, the median)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The weighted quantile (a numeric vector)
</p>


<h3>References</h3>

<p>Ferrez, J., Graf, M. (2007). Enquète suisse sur la structure des
salaires. Programmes R pour l'intervalle de confiance de la médiane. 
(Rapport de méthodes No. 338-0045). Neuchâtel: Office fédéral de statistique.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>wq(x = rnorm(100), weights = runif(100))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
