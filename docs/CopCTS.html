<!DOCTYPE html><html><head><title>Help for package CopCTS</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {CopCTS}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#condQestCopC'><p>Conditional Quantile Estimation</p></a></li>
<li><a href='#estCopC'><p>Pseudo maximum likelihood estimator of the copula parameter</p></a></li>
<li><a href='#genLatentY'><p>Generation of data from the copula-based Markov model of order one</p></a></li>
<li><a href='#selectCopC'><p>The selection of copula function</p></a></li>
<li><a href='#water'>
<p>Water quality (Ammonia) data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Copula-Based Semiparametric Analysis for Time Series Data with
Detection Limits</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Author:</td>
<td>Fuyuan David Li</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Fuyuan David Li &lt;LFY@gwmail.gwu.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Semiparametric estimation for censored time series
    with lower detection limit. The latent response is a sequence of
    stationary process with Markov property
    of order one.
    Estimation of copula parameter(COPC) and Conditional quantile estimation
    are included for five available copula functions.
    Copula selection methods based on L2 distance from empirical copula function
    are also included.</td>
</tr>
<tr>
<td>Depends:</td>
<td>copula</td>
</tr>
<tr>
<td>Imports:</td>
<td>msm,copBasic,methods</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-11-27 15:02:18 UTC; lfy</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-12-03 10:52:46 UTC</td>
</tr>
</table>
<hr>
<h2 id='condQestCopC'>Conditional Quantile Estimation</h2><span id='topic+condQestCopC'></span>

<h3>Description</h3>

<p>Given estiamted copula with copula parameter and specified marginal distribution,
obtain the conditional qth quantile of Y_n+1 given Y1,...,Yn.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>condQestCopC(tao,Yc,d,delta,copula,cop=NULL,theta=NULL,nIS=10000,
MARGIN=NULL,MARGIN.inv=NULL,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="condQestCopC_+3A_tao">tao</code></td>
<td>
<p>the desired quantile level, a numeric value between 0 and 1.</p>
</td></tr>
<tr><td><code id="condQestCopC_+3A_yc">Yc</code></td>
<td>
<p>the Nx1 vector of observed responses that are subject to lower detection limit.</p>
</td></tr>
<tr><td><code id="condQestCopC_+3A_d">d</code></td>
<td>
<p>the lower detection limit.</p>
</td></tr>
<tr><td><code id="condQestCopC_+3A_delta">delta</code></td>
<td>
<p>the Nx1 vector of censoring indicator
with 1 indicating uncensored and 0 indicating left censored.</p>
</td></tr>
<tr><td><code id="condQestCopC_+3A_copula">copula</code></td>
<td>
<p>the input copula object with copula parameter plugged in.
If specified, <code>cop</code> and <code>theta</code> can be omitted.</p>
</td></tr>
<tr><td><code id="condQestCopC_+3A_cop">cop</code></td>
<td>
<p>the choice of copula function.
There are currently five available copula funcitons,
including Clayton copula, Gaussian copula, Gumbel copula, Joe copula and Frank copula.
Specify one from &quot;Clayton&quot;,&quot;Gaussian&quot;,&quot;Gumbel&quot;,&quot;Joe&quot; and &quot;Frank&quot;.</p>
</td></tr>
<tr><td><code id="condQestCopC_+3A_theta">theta</code></td>
<td>
<p>the copula parameter.</p>
</td></tr>
<tr><td><code id="condQestCopC_+3A_nis">nIS</code></td>
<td>
<p>the size for sequential importance sampling.
The default is 10000.</p>
</td></tr>
<tr><td><code id="condQestCopC_+3A_margin">MARGIN</code></td>
<td>
<p>the marginal distribution of the latent time series.</p>
</td></tr>
<tr><td><code id="condQestCopC_+3A_margin.inv">MARGIN.inv</code></td>
<td>
<p>the inverse marginal distribution of the latent time series.</p>
</td></tr>
<tr><td><code id="condQestCopC_+3A_...">...</code></td>
<td>
<p>additional parameters for the marginal distribution of the latent time series.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>condQestCopC</code> returns the conditional tao-th quantile of Y_n+1 given Y1,...,Yn
based on the specified copula function and marginal distribution.
</p>


<h3>References</h3>

<p>Li, F., Tang, Y. and Wang, H. (2018).
Copula-Based Semiparametric Analysis for Time Series Data with Detection Limits, technical report.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(20)
Y = genLatentY(cop = "Clayton", theta = 1, N = 30)
d = -0.5
delta = (Y&gt;d)
Yc = pmax(d,Y)
cq60.real = condQestCopC(0.6,Yc,d,delta,copula=claytonCopula(1),nIS = 50,
                        MARGIN=pnorm,MARGIN.inv=qnorm)
### Use selected copula
selCopC = selectCopC(cop.type = c("Clayton","Frank"),Yc,d,delta,nIS=50)
cq60.est = condQestCopC(0.6,Yc,d,delta,selCopC$Selected,nIS=50)
</code></pre>

<hr>
<h2 id='estCopC'>Pseudo maximum likelihood estimator of the copula parameter</h2><span id='topic+estCopC'></span>

<h3>Description</h3>

<p>Obtains the pseudo maximum likelihood estimator of the copula parameter based on censored time series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estCopC(cop="Gaussian",Yc,d,delta,nIS=500,jumps=NULL,MARGIN=NULL,...,interval=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estCopC_+3A_cop">cop</code></td>
<td>
<p>the choice of copula function.
There are currently five available copula funcitons,
including Clayton copula, Gaussian copula, Gumbel copula, Joe copula and Frank copula.
Specify one from &quot;Clayton&quot;,&quot;Gaussian&quot;,&quot;Gumbel&quot;,&quot;Joe&quot; and &quot;Frank&quot;.
The default is &quot;Gaussian&quot;.</p>
</td></tr>
<tr><td><code id="estCopC_+3A_yc">Yc</code></td>
<td>
<p>the Nx1 vector of observed response variable
that is subject to lower detection limit.</p>
</td></tr>
<tr><td><code id="estCopC_+3A_d">d</code></td>
<td>
<p>the lower detection limit.</p>
</td></tr>
<tr><td><code id="estCopC_+3A_delta">delta</code></td>
<td>
<p>the Nx1 vector of censoring indicator
with 1 indicating uncensored and 0 indicating left censored.</p>
</td></tr>
<tr><td><code id="estCopC_+3A_nis">nIS</code></td>
<td>
<p>the size for sequential importance sampling.
The default is 500.</p>
</td></tr>
<tr><td><code id="estCopC_+3A_jumps">jumps</code></td>
<td>
<p>the Nx1 vector indicating whether
each time t is a start of a new time series, which is deemed to be
independent from the previous series.
By default, <code>jumps</code> = c(1,rep(0,n-1)) indicating the data is one Markov sequence.</p>
</td></tr>
<tr><td><code id="estCopC_+3A_margin">MARGIN</code></td>
<td>
<p>the marginal distribution function of the latent time series.
The default is the empirical cdf:
</p>
<p style="text-align: center;"><code class="reqn">\frac{1}{n+1}\sum_{t=1}^n I_{Y_t&lt;=y}</code>
</p>
<p>.
MARGIN can also be specified as
other existing distribution functions such as pnorm.</p>
</td></tr>
<tr><td><code id="estCopC_+3A_...">...</code></td>
<td>
<p>additional parameters for the marginal distribution of the latent time series.</p>
</td></tr>
<tr><td><code id="estCopC_+3A_interval">interval</code></td>
<td>
<p>the lower and upper bound for the copula paraameter.
By default,  <code>interval</code>=
c(-1,1) for Gaussian copula,
c(-1,Inf) for Clayton copula,
c(1,Inf) for Gumbel and Joe copula and
c(-Inf,Inf) for Frank copula.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>estCopC</code> returns a list of components including.
</p>
<table>
<tr><td><code>para</code></td>
<td>
<p>the pseudo maximum likelihood estimator of the copula parameter.</p>
</td></tr>
<tr><td><code>likelihood</code></td>
<td>
<p>the negative log-likelihood value corresponding to the estimated copula parameter.</p>
</td></tr>
<tr><td><code>copula</code></td>
<td>
<p>the estimated copula object, with estimated copula parameter plugged in.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Li, F., Tang, Y. and Wang, H. (2018).
Copula-based Semiparametric Analysis for Time Series Data with Detection Limits, technical report.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Using a simulated data for demonstration:
set.seed(20)
Y = genLatentY(cop="Clayton",1,30,MARGIN.inv = qt,df=3)
d = -1
Yc = pmax(d,Y)
delta = (Y&gt;d)
## CopC estimator
estCopC(cop = "Clayton",Yc,d,delta,nIS = 50,interval = c(1,10))
## Omniscient estimator
estCopC(cop = "Clayton",Y,d,delta=rep(TRUE,length(Y)),interval = c(1,10))
## CopC estimator under true marginal
estCopC(cop = "Clayton",Yc,d,delta,nIS = 50,MARGIN=pt,df=3,interval = c(1,10))
### Analyze the water quality data:
attach(water)
Yc = TNH3[1:30]
delta = Delta[1:30]
jumps = Indep[1:30]
set.seed(1)
estCopC(cop="Clayton",Yc=Yc,d=0.02,delta=delta,jumps=jumps,interval = c(1,10),nIS=50)
</code></pre>

<hr>
<h2 id='genLatentY'>Generation of data from the copula-based Markov model of order one</h2><span id='topic+genLatentY'></span>

<h3>Description</h3>

<p>Generate the latent response variable from the assumed copula-based
Markov model in Li, Tang and Wang (2018).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>genLatentY(cop="Gaussian",theta,N,MARGIN.inv=qnorm,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="genLatentY_+3A_cop">cop</code></td>
<td>
<p>the choice of copula function.
There are currently five available copula funcitons,
including Clayton copula, Gaussian copula, Gumbel copula, Joe copula and Frank copula.
Specify one from &quot;Clayton&quot;,&quot;Gaussian&quot;,&quot;Gumbel&quot;,&quot;Joe&quot; and &quot;Frank&quot;.
The default is &quot;Gaussian&quot;.</p>
</td></tr>
<tr><td><code id="genLatentY_+3A_theta">theta</code></td>
<td>
<p>the copula parameter.</p>
</td></tr>
<tr><td><code id="genLatentY_+3A_n">N</code></td>
<td>
<p>the length of the latent response.</p>
</td></tr>
<tr><td><code id="genLatentY_+3A_margin.inv">MARGIN.inv</code></td>
<td>
<p>the inverse marginal distribution function of the latent time series.
The default is <code>qnorm(p,mean=0,sd=1)</code>, i.e., the standard normal marginal.</p>
</td></tr>
<tr><td><code id="genLatentY_+3A_...">...</code></td>
<td>
<p>additional parameters for the inverse marginal distribution funcion of the latent time series.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>genLatentY</code> returns a Nx1 vector of the latent response variable Y*
</p>


<h3>References</h3>

<p>Li, F., Tang, Y. and Wang, H. (2018) Copula-based Semiparametric Analysis for Time Series Data with Detection Limits, technical report.
</p>

<hr>
<h2 id='selectCopC'>The selection of copula function</h2><span id='topic+selectCopC'></span>

<h3>Description</h3>

<p>Among a list of copulas, select the one that gives the estimates
closest to the empirical copula function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>selectCopC(cop.type=c("Clayton","Gaussian","Gumbel","Joe","Frank"),
Yc,d,delta,nIS=500,jumps=NULL,MARGIN=NULL,...,intervals=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="selectCopC_+3A_cop.type">cop.type</code></td>
<td>
<p>a Kx1 vector containing the candidate copulas,
where K = length(cop.type) is the number of candidate copulas.
There are currently five available copula funcitons,
including Clayton copula, Gaussian copula, Gumbel copula, Joe copula and Frank copula.
Select each by specifying a vector consisting of at least one element from
c(&quot;Clayton&quot;,&quot;Gaussian&quot;,&quot;Gumbel&quot;,&quot;Joe&quot;,&quot;Frank&quot;).</p>
</td></tr>
<tr><td><code id="selectCopC_+3A_yc">Yc</code></td>
<td>
<p>the Nx1 vector of observed responses
that are subject to lower detection limit.</p>
</td></tr>
<tr><td><code id="selectCopC_+3A_d">d</code></td>
<td>
<p>the lower detection limit.</p>
</td></tr>
<tr><td><code id="selectCopC_+3A_delta">delta</code></td>
<td>
<p>the Nx1 vector of censoring indicator
with 1 indicating uncensored and 0 indicating left censored.</p>
</td></tr>
<tr><td><code id="selectCopC_+3A_nis">nIS</code></td>
<td>
<p>the size for sequential importance sampling.
The default is 500.</p>
</td></tr>
<tr><td><code id="selectCopC_+3A_jumps">jumps</code></td>
<td>
<p>the Nx1 vector indicating whether
each time t is a start of a new time series, which is deemed to be
independent from the previous series.</p>
</td></tr>
<tr><td><code id="selectCopC_+3A_margin">MARGIN</code></td>
<td>
<p>the marginal distribution of the latent time series.</p>
</td></tr>
<tr><td><code id="selectCopC_+3A_...">...</code></td>
<td>
<p>additional parameters for the marginal distribution of the latent time series.</p>
</td></tr>
<tr><td><code id="selectCopC_+3A_intervals">intervals</code></td>
<td>
<p>a 2xK matrix specifying
the lower and upper bound for the copula parameter of each candidate copula, where K is the number
of candidate copulas.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>selectCopC</code> returns a list of components including
</p>
<table>
<tr><td><code>paras</code></td>
<td>
<p>a Kx1 vector containing the estimated copula parameters for each candidate copula.</p>
</td></tr>
<tr><td><code>likelihoods</code></td>
<td>
<p>a Kx1 vector containing
the negative log-likelihood value corresponding to the estimated copula parameter
for each candidate copula.</p>
</td></tr>
<tr><td><code>estCop</code></td>
<td>
<p>a list containing the estimated copula object for each candidate.</p>
</td></tr>
<tr><td><code>L2distance</code></td>
<td>
<p>a Kx1 vector containing the L2 distance between each copula
with estimated copula parameter
and the empirical copula function.</p>
</td></tr>
<tr><td><code>Selected</code></td>
<td>
<p>The selected copula object.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Li, F., Tang, Y. and Wang, H. (2018) Copula-based Semiparametric Analysis for Time Series Data with Detection Limits, technical report.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+estCopC">estCopC</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Example with simulated data
set.seed(20)
Y = genLatentY("Clayton",1,30,MARGIN.inv = qt,df=3)
d = -1
Yc = pmax(d,Y)
delta = (Y&gt;d)
selectCopC(cop.type=c("Clayton","Frank"),Yc = Yc,d = d,delta = delta,nIS=50)
### Example with water data
attach(water)
Yc = TNH3[1:30]
delta = Delta[1:30]
jumps = Indep[1:30]
set.seed(1)
intv.Gaussian = c(-1,1)
intv.Clayton = c(0,20)
intv.Frank = c(0,15)
intervals = cbind(intv.Gaussian,intv.Clayton,intv.Frank)
cop.type = c("Gaussian","Clayton","Frank")
selCopC &lt;- selectCopC(cop.type=cop.type,Yc=Yc,d=0.02,
            delta=delta,nIS = 50,jumps=jumps,intervals=intervals)
selCopC$Selected
</code></pre>

<hr>
<h2 id='water'>
Water quality (Ammonia) data
</h2><span id='topic+water'></span>

<h3>Description</h3>

<p>This water dataset records the amount of
dissolved ammonia at Susquehanna River Basin in the United States.
The dissolved ammonia data were observed biweekly in Susquehanna River at Towanda, PA, from 1988 to 2014, consisting of 524 data points, with detection limit at 0.02 (mg/l).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(water)</code></pre>


<h3>Format</h3>

<p>A data frame with 524 observations on the following 4 variables.
</p>

<dl>
<dt><code>SDate</code></dt><dd><p>date of measuring</p>
</dd>
<dt><code>TNH3</code></dt><dd><p>response variable, the amount of dissolved ammonia</p>
</dd>
<dt><code>Delta</code></dt><dd><p>a logical vector indicating censored as 0 and uncensored as 1</p>
</dd>
<dt><code>Indep</code></dt><dd><p>a logical vector indicating the start of a new time series that is deemed to be independent from the previous one. For the water quality data, most measurements were taken biweekly but a few have longer time gaps from the previous measurements. In our analysis of the water quality data, we treat the date that is apart from the previous measurement date more than 14 days as the start of a new independent time series.</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://www.srbc.net/portals/water-quality-projects/sediment-nutrient-assessment/">https://www.srbc.net/portals/water-quality-projects/sediment-nutrient-assessment/</a>
</p>


<h3>References</h3>

<p>Li, F., Tang, Y. and Wang, H. (2018) Copula-based Semiparametric Analysis for Time Series Data with Detection Limits, technical report.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(water)
str(water)
head(water)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
