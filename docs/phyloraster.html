<!DOCTYPE html><html lang="en"><head><title>Help for package phyloraster</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {phyloraster}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#.end.type'><p>Classify Phylogenetic Endemism using rasters</p></a></li>
<li><a href='#.fit.memory'><p>Evaluate if the rasters generated in the function fits on available memory</p></a></li>
<li><a href='#.rast.ed.B'><p>Calculate Evolutionary distinctiveness for each raster cell</p></a></li>
<li><a href='#.rast.geo.phylo'><p>Calculate phylogenetic community metrics for raster data</p></a></li>
<li><a href='#.rast.pd.B'><p>Calculate phylogenetic diversity for each raster cell</p></a></li>
<li><a href='#.rast.pe.B'><p>Calculate phylogenetic endemism for a raster</p></a></li>
<li><a href='#.rast.we.B'><p>Calculate weighted endemism for each raster cell</p></a></li>
<li><a href='#arg.check'><p>Check for missing arguments in function call</p></a></li>
<li><a href='#canape.rast'><p>Classify Phylogenetic Endemism using rasters</p></a></li>
<li><a href='#dataR'><p>Presence-absence of 33 Australian tree frogs (Rosauer 2017)</p></a></li>
<li><a href='#delta.grid'><p>Delta of Diversity Metrics</p></a></li>
<li><a href='#df2rast'><p>Transform a data.frame to raster</p></a></li>
<li><a href='#geo.phylo'><p>Calculate phylogenetic community metrics for raster data</p></a></li>
<li><a href='#geo.phylo.ses'><p>Calculate phylogenetic community metrics and their standardized effect sizes</p>
for raster data</a></li>
<li><a href='#inv.range'><p>Calculate the inverse of range size</p></a></li>
<li><a href='#load.data.rosauer'><p>Load an example dataset with presence-absence data of 33 tree frogs and</p>
a phylogenetic tree for this species</a></li>
<li><a href='#phylo.pres'><p>Prepare rasters and phylogenetic tree to run community metrics</p></a></li>
<li><a href='#range_size'><p>Calculate range size for a set of species using a raster as input</p></a></li>
<li><a href='#rast.ed'><p>Calculate Evolutionary distinctiveness for raster data</p></a></li>
<li><a href='#rast.ed.ses'><p>Standardized effect size for Evolutionary distinctiveness</p></a></li>
<li><a href='#rast.pd'><p>Calculate phylogenetic diversity for raster data</p></a></li>
<li><a href='#rast.pd.ses'><p>Standardized effect size for Phylogenetic diversity</p></a></li>
<li><a href='#rast.pe'><p>Calculate phylogenetic endemism for raster data</p></a></li>
<li><a href='#rast.pe.ses'><p>Standardized effect size for Phylogenetic endemism</p></a></li>
<li><a href='#rast.sr'><p>Calculate species richness for raster data</p></a></li>
<li><a href='#rast.we'><p>Calculate weighted endemism for raster data</p></a></li>
<li><a href='#rast.we.ses'><p>Calculate weighted endemism standardized for species richness</p></a></li>
<li><a href='#shp2rast'><p>Rasterize shapefile</p></a></li>
<li><a href='#species.ed'><p>Calculate Evolutionary distinctiveness for each species</p></a></li>
<li><a href='#species.tip.length'><p>Compute species tip length</p></a></li>
<li><a href='#tip.root.path'><p>Compute tree edge lengths and node paths from root to each tip</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Evolutionary Diversity Metrics for Raster Data</td>
</tr>
<tr>
<td>Version:</td>
<td>2.2.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Phylogenetic Diversity (PD, Faith 1992), Evolutionary
    Distinctiveness (ED, Isaac et al. 2007), Phylogenetic Endemism (PE,
    Rosauer et al. 2009; Laffan et al. 2016), and Weighted Endemism (WE,
    Laffan et al. 2016) for presence-absence raster.  Faith, D. P. (1992)
    &lt;<a href="https://doi.org/10.1016%2F0006-3207%2892%2991201-3">doi:10.1016/0006-3207(92)91201-3</a>&gt; Isaac, N. J. et al. (2007)
    &lt;<a href="https://doi.org/10.1371%2Fjournal.pone.0000296">doi:10.1371/journal.pone.0000296</a>&gt; Laffan, S. W. et al. (2016)
    &lt;<a href="https://doi.org/10.1111%2F2041-210X.12513">doi:10.1111/2041-210X.12513</a>&gt; Rosauer, D. et al. (2009)
    &lt;<a href="https://doi.org/10.1111%2Fj.1365-294X.2009.04311.x">doi:10.1111/j.1365-294X.2009.04311.x</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://CRAN.R-project.org/package=phyloraster">https://CRAN.R-project.org/package=phyloraster</a>,
<a href="https://github.com/gabferreira/phyloraster">https://github.com/gabferreira/phyloraster</a>,
https:<a href="https://gabferreira.github.io/phyloraster/">https://gabferreira.github.io/phyloraster/</a>,
<a href="https://doi.org/10.1111/ecog.06902">https://doi.org/10.1111/ecog.06902</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/gabferreira/phyloraster/issues">https://github.com/gabferreira/phyloraster/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Imports:</td>
<td>ape, methods, purrr, SESraster, stats, terra</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, maps, phylobase, rmarkdown, testthat (&ge; 2.0.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>2</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-02-28 14:34:57 UTC; gabri</td>
</tr>
<tr>
<td>Author:</td>
<td>Gabriela Alves-Ferreira
    <a href="https://orcid.org/0000-0001-5661-3381"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre,
    cph],
  Flávio M. M. Mota <a href="https://orcid.org/0000-0002-0308-7151"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Neander Marcel Heming
    <a href="https://orcid.org/0000-0003-2461-5045"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Gabriela Alves-Ferreira &lt;gabriela-alves77@hotmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-02-28 15:00:01 UTC</td>
</tr>
</table>
<hr>
<h2 id='.end.type'>Classify Phylogenetic Endemism using rasters</h2><span id='topic+.end.type'></span>

<h3>Description</h3>

<p>Use the results of rast.pe.ses() to identify centers of paleo-,
neo-, super-, and mixed- endemism following the CANAPE scheme of
Mishler et al., 2014.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.end.type(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".end.type_+3A_x">x</code></td>
<td>
<p>SpatRaster. A SpatRaster object with the following layers in this
specific order:
</p>

<ul>
<li><p> pe.obs.p.upper : Upper p-value comparing the observed phylogenetic
endemism and the randomized phylogenetic endemism values
</p>
</li>
<li><p> pe.alt.obs.p.upper : Upper p-value comparing the alternate phylogenetic
endemism and the randomized alternate phylogenetic endemism
</p>
</li>
<li><p> rpe.obs.p.upper : Upper p-value comparing the relative phylogenetic
endemism and the randomized relative phylogenetic endemism
</p>
</li>
<li><p> rpe.obs.p.lower : Lower p-value comparing the relative phylogenetic
endemism and the randomized relative phylogenetic endemism
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>SpatRaster
</p>


<h3>References</h3>

<p>Mishler, B., Knerr, N., González-Orozco, C. et al. (2014)
Phylogenetic measures of biodiversity and neo- and paleo-endemism in
Australian Acacia. Nat Commun, 5: 4473. doi:10.1038/ncomms5473
</p>

<hr>
<h2 id='.fit.memory'>Evaluate if the rasters generated in the function fits on available memory</h2><span id='topic+.fit.memory'></span>

<h3>Description</h3>

<p>Tests if the amount of RAM required is available to process a SpatRaster
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.fit.memory(x, n = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".fit.memory_+3A_x">x</code></td>
<td>
<p>SpatRaster</p>
</td></tr>
<tr><td><code id=".fit.memory_+3A_n">n</code></td>
<td>
<p>positive integer. The number of copies of <code>x</code> that are needed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>logical
</p>

<hr>
<h2 id='.rast.ed.B'>Calculate Evolutionary distinctiveness for each raster cell</h2><span id='topic+.rast.ed.B'></span>

<h3>Description</h3>

<p>This function calculates evolutionary distinctiveness according
to the fair-proportion index.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.rast.ed.B(x, edge.path, branch.length, n.descen, filename = "", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".rast.ed.B_+3A_x">x</code></td>
<td>
<p>SpatRaster. A SpatRaster containing presence-absence data (0 or 1)
for a set of species. The layers (species) must be sorted according to the
tree order. See the phylo.pres function.</p>
</td></tr>
<tr><td><code id=".rast.ed.B_+3A_edge.path">edge.path</code></td>
<td>
<p>matrix. Matrix representing the paths through the tree from
root to each tip. See <code><a href="#topic+phylo.pres">phylo.pres</a></code></p>
</td></tr>
<tr><td><code id=".rast.ed.B_+3A_branch.length">branch.length</code></td>
<td>
<p>numeric. A Named numeric vector of branch length for
each species. See <code><a href="#topic+phylo.pres">phylo.pres</a></code></p>
</td></tr>
<tr><td><code id=".rast.ed.B_+3A_n.descen">n.descen</code></td>
<td>
<p>numeric. A Named numeric vector of number of descendants for
each branch. See <code><a href="#topic+phylo.pres">phylo.pres</a></code></p>
</td></tr>
<tr><td><code id=".rast.ed.B_+3A_filename">filename</code></td>
<td>
<p>character. Output filename</p>
</td></tr>
<tr><td><code id=".rast.ed.B_+3A_...">...</code></td>
<td>
<p>additional arguments passed for terra::app</p>
</td></tr>
</table>


<h3>Value</h3>

<p>SpatRaster
</p>


<h3>Author(s)</h3>

<p>Neander Marcel Heming and Gabriela Alves-Ferreira
</p>


<h3>References</h3>

<p>Isaac, N. J., Turvey, S. T., Collen, B.,
Waterman, C. and Baillie,
J. E. (2007). Mammals on the EDGE: conservation priorities
based on threat
and phylogeny. PLoS ONE 2, e296.
</p>

<hr>
<h2 id='.rast.geo.phylo'>Calculate phylogenetic community metrics for raster data</h2><span id='topic+.rast.geo.phylo'></span>

<h3>Description</h3>

<p>Calculate species richness, phylogenetic diversity, evolutionary
distinctiveness,
phylogenetic endemism and weighted endemism using rasters as input
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.rast.geo.phylo(
  x,
  inv.R,
  edge.path,
  branch.length,
  n.descen,
  filename = "",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".rast.geo.phylo_+3A_x">x</code></td>
<td>
<p>SpatRaster. A SpatRaster containing presence-absence data (0 or 1)
for a set of species. The layers (species) must be sorted according to the
tree order. See the phylo.pres function.</p>
</td></tr>
<tr><td><code id=".rast.geo.phylo_+3A_inv.r">inv.R</code></td>
<td>
<p>SpatRaster. inverse of range size calculated from
<code><a href="#topic+inv.range">inv.range</a></code></p>
</td></tr>
<tr><td><code id=".rast.geo.phylo_+3A_edge.path">edge.path</code></td>
<td>
<p>matrix. Matrix representing the paths through the tree from
root to each tip. See <code><a href="#topic+phylo.pres">phylo.pres</a></code></p>
</td></tr>
<tr><td><code id=".rast.geo.phylo_+3A_branch.length">branch.length</code></td>
<td>
<p>numeric. A named numerical vector containing the branch
length for each species.</p>
</td></tr>
<tr><td><code id=".rast.geo.phylo_+3A_n.descen">n.descen</code></td>
<td>
<p>numeric. A Named numeric vector of number of descendants for
each branch</p>
</td></tr>
<tr><td><code id=".rast.geo.phylo_+3A_filename">filename</code></td>
<td>
<p>character. Output filename</p>
</td></tr>
<tr><td><code id=".rast.geo.phylo_+3A_...">...</code></td>
<td>
<p>additional arguments passed for terra::app</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Community metrics calculated:
</p>

<ul>
<li><p>Phylogenetic diversity (Faith 1992)
</p>
</li>
<li><p>Species Richness
</p>
</li>
<li><p>Evolutionary distinctiveness by fair-proportion
(Isaac et al. 2007)
</p>
</li>
<li><p>Phylogenetic endemism (Rosauer et al. 2009)
</p>
</li>
<li><p>Weighted endemism (Crisp et al. 2001, Williams et al. 1994)
</p>
</li></ul>



<h3>Value</h3>

<p>SpatRaster with one layer for each metric
</p>


<h3>Author(s)</h3>

<p>Neander Marcel Heming
</p>


<h3>References</h3>

<p>Rosauer, D. A. N., Laffan, S. W., Crisp, M. D., Donnellan, S. C.
and Cook, L. G. (2009). Phylogenetic endemism: a new approach for identifying
geographical concentrations of evolutionary history.
Molecular ecology, 18(19),
4061-4072.
</p>
<p>Faith, D. P. (1992). Conservation evaluation and phylogenetic
diversity. Biological conservation, 61(1), 1-10.
</p>
<p>Williams, P.H., Humphries, C.J., Forey, P.L., Humphries, C.J. and
VaneWright, R.I. (1994). Biodiversity, taxonomic relatedness, and endemism in
conservation. In: Systematics and Conservation Evaluation (eds Forey PL,
Humphries C.J., Vane-Wright RI), p. 438. Oxford University Press, Oxford.
</p>
<p>Crisp, M., Laffan, S., Linder, H. and Monro, A. (2001). Endemism
in the Australian flora. Journal of Biogeography, 28, 183–198.
</p>
<p>Isaac, N. J., Turvey, S. T., Collen, B., Waterman, C. and
Baillie, J. E. (2007). Mammals on the EDGE: conservation priorities based on
threat and phylogeny. PLoS ONE 2, e296.
</p>
<p>Laffan, S. W., Rosauer, D. F., Di Virgilio, G., Miller, J. T.,
González‐Orozco, C. E., Knerr, N., ... &amp; Mishler, B. D. (2016).
Range‐weighted metrics of species and phylogenetic turnover can better
resolve biogeographic transition zones. Methods in Ecology and Evolution,
7(5), 580-588.
</p>

<hr>
<h2 id='.rast.pd.B'>Calculate phylogenetic diversity for each raster cell</h2><span id='topic+.rast.pd.B'></span>

<h3>Description</h3>

<p>Calculate the sum of the branch length for species present in
raster data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.rast.pd.B(x, edge.path, branch.length, filename = "", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".rast.pd.B_+3A_x">x</code></td>
<td>
<p>SpatRaster. A SpatRaster containing presence-absence data (0 or 1)
for a set of species. The layers (species) will be sorted according to the
tree order. See the phylo.pres function.</p>
</td></tr>
<tr><td><code id=".rast.pd.B_+3A_edge.path">edge.path</code></td>
<td>
<p>matrix. Matrix representing the paths through the tree from
root to each tip. See <code><a href="#topic+phylo.pres">phylo.pres</a></code></p>
</td></tr>
<tr><td><code id=".rast.pd.B_+3A_branch.length">branch.length</code></td>
<td>
<p>numeric. A Named numeric vector of branch length for
each species. See <code><a href="#topic+phylo.pres">phylo.pres</a></code></p>
</td></tr>
<tr><td><code id=".rast.pd.B_+3A_filename">filename</code></td>
<td>
<p>character. Output filename</p>
</td></tr>
<tr><td><code id=".rast.pd.B_+3A_...">...</code></td>
<td>
<p>additional arguments passed for terra::app</p>
</td></tr>
</table>


<h3>Value</h3>

<p>SpatRaster
</p>


<h3>Author(s)</h3>

<p>Neander Marcel Heming and Gabriela Alves-Ferreira
</p>


<h3>References</h3>

<p>Faith, D. P. (1992). Conservation evaluation and phylogenetic
diversity. Biological conservation, 61(1), 1-10.
</p>

<hr>
<h2 id='.rast.pe.B'>Calculate phylogenetic endemism for a raster</h2><span id='topic+.rast.pe.B'></span>

<h3>Description</h3>

<p>Calculate phylogenetic endemism using rasters as input and output.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.rast.pe.B(
  x,
  inv.R,
  branch.length,
  branch.length.alt,
  metric = c("pe", "pe.alt", "rpe", "all")[1],
  filename = "",
  overwrite = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".rast.pe.B_+3A_x">x</code></td>
<td>
<p>SpatRaster. A SpatRaster containing presence-absence data (0 or 1)
for a set of species. The layers (species) will be sorted according to the
tree order. See the phylo.pres function.</p>
</td></tr>
<tr><td><code id=".rast.pe.B_+3A_inv.r">inv.R</code></td>
<td>
<p>SpatRaster. Inverse of range size. See <code><a href="#topic+inv.range">inv.range</a></code></p>
</td></tr>
<tr><td><code id=".rast.pe.B_+3A_branch.length">branch.length</code></td>
<td>
<p>numeric. A Named numeric vector of branch length for
each species. See <code><a href="#topic+phylo.pres">phylo.pres</a></code></p>
</td></tr>
<tr><td><code id=".rast.pe.B_+3A_branch.length.alt">branch.length.alt</code></td>
<td>
<p>numeric. Branch length calculated by using an
alternative phylogeny with non-zero branch lengths converted to a constant
value (1) and rescaled so the sum of all branch lengths is 1.</p>
</td></tr>
<tr><td><code id=".rast.pe.B_+3A_metric">metric</code></td>
<td>
<p>character. Names of the biodiversity metrics to calculate.
Available options are: &quot;pe&quot;, &quot;pe.alt&quot;, &quot;rpe&quot;, or &quot;all&quot;. See details.</p>
</td></tr>
<tr><td><code id=".rast.pe.B_+3A_filename">filename</code></td>
<td>
<p>character. Output filename</p>
</td></tr>
<tr><td><code id=".rast.pe.B_+3A_overwrite">overwrite</code></td>
<td>
<p>logical. If TRUE, filename is overwritten</p>
</td></tr>
<tr><td><code id=".rast.pe.B_+3A_...">...</code></td>
<td>
<p>additional arguments passed for terra::app</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Metrics available are:
</p>

<ul>
<li><p> pe: Phylogenetic endemism (Rosauer et al., 2009)
</p>
</li>
<li><p> pe.alt: Alternate Phylogenetic endemism  (Mishler et al., 2014)
</p>
</li>
<li><p> rpe: Relative Phylogenetic endemism (Mishler et al., 2014)
</p>
</li>
<li><p> all: Calculate all available metrics
Alternate phylogenetic endemism (PE.alt, Mishler et al., 2014) is
calculated using an alternate phylogeny with non-zero branch lengths
converted to a constant value (here we use 1) and rescaled so the sum of all
branch lengths is 1.
Relative phylogenetic endemism (RPE, Mishler et al., 2014) is the ratio
of phylogenetic endemism (PE, Rosauer et al., 2009) measured on the
original tree versus PE measured on a alternate tree (PE.alt).
</p>
</li></ul>



<h3>Value</h3>

<p>SpatRaster
</p>


<h3>Author(s)</h3>

<p>Gabriela Alves-Ferreira and Neander Heming
</p>


<h3>References</h3>

<p>Mishler, B. D., Knerr, N., González-Orozco, C. E., Thornhill,
A. H., Laffan, S. W. and Miller, J. T. 2014. Phylogenetic measures of
biodiversity and neo- and paleo-endemism in Australian Acacia. –
Nat. Commun. 5: 4473.
</p>
<p>Rosauer, D. A. N., Laffan, S. W., Crisp, M. D., Donnellan, S. C.,
&amp; Cook, L. G. (2009). Phylogenetic endemism: a new approach for identifying
geographical concentrations of evolutionary history. Molecular ecology,
18(19), 4061-4072.
</p>

<hr>
<h2 id='.rast.we.B'>Calculate weighted endemism for each raster cell</h2><span id='topic+.rast.we.B'></span>

<h3>Description</h3>

<p>Calculate the sum of the inverse of the range size for species
present in each raster cell.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.rast.we.B(x, inv.R, filename = "", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".rast.we.B_+3A_x">x</code></td>
<td>
<p>SpatRaster. A SpatRaster containing presence-absence data (0 or 1)
for a set of species. The layers (species) will be sorted according to the
tree order. See the phylo.pres function.</p>
</td></tr>
<tr><td><code id=".rast.we.B_+3A_inv.r">inv.R</code></td>
<td>
<p>SpatRaster. Inverse of range size. See <code><a href="#topic+inv.range">inv.range</a></code></p>
</td></tr>
<tr><td><code id=".rast.we.B_+3A_filename">filename</code></td>
<td>
<p>character. Output filename</p>
</td></tr>
<tr><td><code id=".rast.we.B_+3A_...">...</code></td>
<td>
<p>additional arguments passed for terra::app</p>
</td></tr>
</table>


<h3>Value</h3>

<p>SpatRaster
</p>


<h3>Author(s)</h3>

<p>Neander Marcel Heming and Gabriela Alves-Ferreira
</p>


<h3>References</h3>

<p>Williams, P.H., Humphries, C.J., Forey, P.L., Humphries, C.J.,
VaneWright, R.I. (1994). Biodiversity, taxonomic relatedness, and endemism
in conservation. In: Systematics and Conservation Evaluation (eds Forey PL,
Humphries CJ, Vane-Wright RI), p. 438. Oxford University Press, Oxford.
</p>
<p>Crisp, M., Laffan, S., Linder, H., Monro, A. (2001). Endemism in
the Australian flora. Journal of Biogeography, 28, 183–198.
</p>

<hr>
<h2 id='arg.check'>Check for missing arguments in function call</h2><span id='topic+arg.check'></span>

<h3>Description</h3>

<p>Check for missing arguments using function call and a provided
vector with argument names to check
</p>


<h3>Usage</h3>

<pre><code class='language-R'>arg.check(
  call,
  arguments = c("LR", "inv.R", "branch.length", "n.descen", "tree")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="arg.check_+3A_call">call</code></td>
<td>
<p>match.call(). To get function call with all of the specified
arguments and their full names.</p>
</td></tr>
<tr><td><code id="arg.check_+3A_arguments">arguments</code></td>
<td>
<p>character. Arguments to be checked</p>
</td></tr>
</table>


<h3>Value</h3>

<p>logical
</p>


<h3>Author(s)</h3>

<p>Neander Marcel Heming
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
geop &lt;- function(x, tree, ...){
                f4 &lt;- arg.check(match.call(),
                                c("LR", "inv.R",
                                "branch.length", "n.descen"))
                f1 &lt;- arg.check(match.call(),
                                c("tree"))
                c(f1, f4)
                }
geop(1, 1)
geop(1)
geop(1, LR=1)

</code></pre>

<hr>
<h2 id='canape.rast'>Classify Phylogenetic Endemism using rasters</h2><span id='topic+canape.rast'></span>

<h3>Description</h3>

<p>Use the results of rast.pe.ses() to identify centers of paleo-,
neo-, super-, and mixed- endemism following the CANAPE scheme of
Mishler et al., 2014.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>canape.rast(
  pe.obs.p.upper,
  pe.alt.obs.p.upper,
  rpe.obs.p.upper,
  rpe.obs.p.lower,
  filename = NULL,
  overwrite = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="canape.rast_+3A_pe.obs.p.upper">pe.obs.p.upper</code></td>
<td>
<p>SpatRaster. Upper p-value comparing the observed
phylogenetic endemism and the randomized phylogenetic endemism values</p>
</td></tr>
<tr><td><code id="canape.rast_+3A_pe.alt.obs.p.upper">pe.alt.obs.p.upper</code></td>
<td>
<p>SpatRaster. Upper p-value comparing the alternate
phylogenetic endemism and the randomized alternate phylogenetic endemism</p>
</td></tr>
<tr><td><code id="canape.rast_+3A_rpe.obs.p.upper">rpe.obs.p.upper</code></td>
<td>
<p>SpatRaster. Upper p-value comparing the relative
phylogenetic endemism and the randomized relative phylogenetic endemism</p>
</td></tr>
<tr><td><code id="canape.rast_+3A_rpe.obs.p.lower">rpe.obs.p.lower</code></td>
<td>
<p>SpatRaster. Lower p-value comparing the relative
phylogenetic endemism and the randomized relative phylogenetic endemism</p>
</td></tr>
<tr><td><code id="canape.rast_+3A_filename">filename</code></td>
<td>
<p>character. Output filename</p>
</td></tr>
<tr><td><code id="canape.rast_+3A_overwrite">overwrite</code></td>
<td>
<p>logical. If TRUE, filename is overwritten</p>
</td></tr>
</table>


<h3>Value</h3>

<p>SpatRaster
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rast.pe.ses">rast.pe.ses</a></code>,
<code><a href="SESraster.html#topic+SESraster">SESraster</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(SESraster)
library(terra)
library(phyloraster)
x &lt;- rast(system.file("extdata", "rast.presab.tif", package="phyloraster"))
tree &lt;- ape::read.tree(system.file("extdata", "tree.nex",
package="phyloraster"))
data &lt;- phylo.pres(x, tree)
ses &lt;- rast.pe.ses(x = data$x, data$tree,
                aleats = 5, metric = "all")
# CANAPE
canape &lt;- canape.rast(ses$p.upper.PE, ses$p.upper.PE.alt,
                   ses$p.upper.RPE, ses$p.lower.RPE)
unique(canape)
plot(canape)


</code></pre>

<hr>
<h2 id='dataR'>Presence-absence of 33 Australian tree frogs (Rosauer 2017)</h2><span id='topic+dataR'></span>

<h3>Description</h3>

<p>A dataset containing presence-absence of 33 Australian tree frogs.
This dataset also provide coordinates x and y for each site.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dataR
</code></pre>


<h3>Format</h3>

<p>A matrix with 2891 rows and 35 columns.
</p>


<h3>Source</h3>

<p>Rosauer, 2017. Available on:
<a href="https://github.com/DanRosauer/phylospatial/tree/master/PhyloEndemism_in_R/Tree%20Frog%20Data">https://github.com/DanRosauer/phylospatial/tree/master/PhyloEndemism_in_R/Tree%20Frog%20Data</a>
</p>

<hr>
<h2 id='delta.grid'>Delta of Diversity Metrics</h2><span id='topic+delta.grid'></span>

<h3>Description</h3>

<p>Calculates the difference of rasterized diversity metrics
(richness, phylogenetic endemism, phylogenetic diversity, weighted endemism,
evolutionary distinctiveness) between time periods.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>delta.grid(r1, r2, filename = NULL, cores = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="delta.grid_+3A_r1">r1</code></td>
<td>
<p>SpatRaster. Rasterized diversity metrics for time 1 (e.g
phylogenetic diversity in present). To calculate some diversity metrics for
rasters see phyloraster::geo.phylo function.</p>
</td></tr>
<tr><td><code id="delta.grid_+3A_r2">r2</code></td>
<td>
<p>SpatRaster. Rasterized diversity metrics for time 2 (e.g
phylogenetic diversity in future).</p>
</td></tr>
<tr><td><code id="delta.grid_+3A_filename">filename</code></td>
<td>
<p>character. Output filename.</p>
</td></tr>
<tr><td><code id="delta.grid_+3A_cores">cores</code></td>
<td>
<p>positive integer. If cores &gt; 1, a 'parallel' package cluster
with that many cores is created and used.</p>
</td></tr>
<tr><td><code id="delta.grid_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed passed down from a calling
function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The two input rasters (r1 and r2) must have the same extent
and resolution.
</p>


<h3>Value</h3>

<p>SpatRaster
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# data
x &lt;- terra::rast(system.file("extdata", "rast.presab.tif",
package="phyloraster"))
tree &lt;- ape::read.tree(system.file("extdata", "tree.nex",
package="phyloraster"))

# metric SR richness
riq.pres &lt;- rast.sr(x)
# imagine we lost some species in the future
riq.fut &lt;- rast.sr(x[[c(1:15)]])
dg &lt;- delta.grid(riq.pres, riq.fut)
terra::plot(dg)

</code></pre>

<hr>
<h2 id='df2rast'>Transform a data.frame to raster</h2><span id='topic+df2rast'></span>

<h3>Description</h3>

<p>The function transforms a data.frame or a matrix of presence-
absence in a raster of distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>df2rast(x, CRS = "+proj=longlat +datum=WGS84", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="df2rast_+3A_x">x</code></td>
<td>
<p>data.frame. A data.frame or matrix with species names in columns
and sites in rows. The first two columns must provide longitude and latitude,
respectively.</p>
</td></tr>
<tr><td><code id="df2rast_+3A_crs">CRS</code></td>
<td>
<p>character. Description of the Coordinate Reference System
(map projection) in PROJ.4.</p>
</td></tr>
<tr><td><code id="df2rast_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed passed down from a calling
function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>SpatRaster
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
dat &lt;- phyloraster::load.data.rosauer()
df2rast(dat$presab, crs = "+proj=longlat +datum=WGS84 +ellps=WGS84
+towgs84=0,0,0")

</code></pre>

<hr>
<h2 id='geo.phylo'>Calculate phylogenetic community metrics for raster data</h2><span id='topic+geo.phylo'></span>

<h3>Description</h3>

<p>Calculate species richness, phylogenetic diversity, evolutionary
distinctiveness,
phylogenetic endemism and weighted endemism using rasters as input.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>geo.phylo(
  x,
  tree,
  inv.R,
  edge.path,
  branch.length,
  n.descen,
  full_tree_metr = TRUE,
  filename = "",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="geo.phylo_+3A_x">x</code></td>
<td>
<p>SpatRaster. A SpatRaster containing presence-absence data (0 or 1)
for a set of species. The layers (species) will be sorted according to the
tree order. See the phylo.pres function.</p>
</td></tr>
<tr><td><code id="geo.phylo_+3A_tree">tree</code></td>
<td>
<p>phylo. A dated tree.</p>
</td></tr>
<tr><td><code id="geo.phylo_+3A_inv.r">inv.R</code></td>
<td>
<p>SpatRaster. Inverse of range size. See <code><a href="#topic+inv.range">inv.range</a></code></p>
</td></tr>
<tr><td><code id="geo.phylo_+3A_edge.path">edge.path</code></td>
<td>
<p>matrix. Matrix representing the paths through the tree from
root to each tip. See <code><a href="#topic+phylo.pres">phylo.pres</a></code></p>
</td></tr>
<tr><td><code id="geo.phylo_+3A_branch.length">branch.length</code></td>
<td>
<p>numeric. A Named numeric vector of branch length for
each species. See <code><a href="#topic+phylo.pres">phylo.pres</a></code></p>
</td></tr>
<tr><td><code id="geo.phylo_+3A_n.descen">n.descen</code></td>
<td>
<p>numeric. A Named numeric vector of number of descendants for
each branch. See <code><a href="#topic+phylo.pres">phylo.pres</a></code></p>
</td></tr>
<tr><td><code id="geo.phylo_+3A_full_tree_metr">full_tree_metr</code></td>
<td>
<p>logical. Whether edge.path, branch length and number
of descendants should be calculated with the full (TRUE) or the prunned tree
(FALSE). The default is TRUE.</p>
</td></tr>
<tr><td><code id="geo.phylo_+3A_filename">filename</code></td>
<td>
<p>character. Output filename</p>
</td></tr>
<tr><td><code id="geo.phylo_+3A_...">...</code></td>
<td>
<p>additional arguments passed for terra::app</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Community metrics calculated:
</p>

<ul>
<li><p>Phylogenetic diversity (Faith 1992)
</p>
</li>
<li><p>Species Richness
</p>
</li>
<li><p>Evolutionary distinctiveness by fair-proportion
(Isaac et al. 2007)
</p>
</li>
<li><p>Phylogenetic endemism (Rosauer et al. 2009)
</p>
</li>
<li><p>Weighted endemism (Crisp et al. 2001, Williams et al. 1994)
</p>
</li></ul>



<h3>Value</h3>

<p>SpatRaster with one layer for each metric
</p>


<h3>Author(s)</h3>

<p>Neander Marcel Heming
</p>


<h3>References</h3>

<p>Rosauer, D. A. N., Laffan, S. W., Crisp, M. D., Donnellan, S. C.
and Cook, L. G. (2009). Phylogenetic endemism: a new approach for identifying
geographical concentrations of evolutionary history. Molecular ecology,
18(19), 4061-4072.
</p>
<p>Faith, D. P. (1992). Conservation evaluation and phylogenetic
diversity. Biological conservation, 61(1), 1-10.
</p>
<p>Williams, P.H., Humphries, C.J., Forey, P.L., Humphries, C.J.
and VaneWright, R.I. (1994). Biodiversity, taxonomic relatedness, and
endemism in conservation. In: Systematics and Conservation Evaluation
(eds Forey PL, Humphries C.J., Vane-Wright RI), p. 438. Oxford University
Press, Oxford.
</p>
<p>Crisp, M., Laffan, S., Linder, H. and Monro, A. (2001).
Endemism in the Australian flora. Journal of Biogeography, 28, 183–198.
</p>
<p>Isaac, N. J., Turvey, S. T., Collen, B., Waterman, C. and
Baillie, J. E. (2007). Mammals on the EDGE: conservation priorities based on
threat and phylogeny. PLoS ONE 2, e296.
</p>
<p>Laffan, S. W., Rosauer, D. F., Di Virgilio, G., Miller, J. T.,
González‐Orozco, C. E., Knerr, N., ... &amp; Mishler, B. D. (2016).
Range‐weighted metrics of species and phylogenetic turnover can better
resolve biogeographic transition zones. Methods in Ecology and Evolution,
7(5), 580-588.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+phylo.pres">phylo.pres</a></code>, <code><a href="#topic+inv.range">inv.range</a></code>,
<code><a href="#topic+rast.ed">rast.ed</a></code>, <code><a href="#topic+rast.pd">rast.pd</a></code>,
<code><a href="#topic+rast.we">rast.we</a></code>, <code><a href="#topic+rast.pe">rast.pe</a></code>, <code><a href="#topic+rast.sr">rast.sr</a></code>,
<code><a href="#topic+geo.phylo.ses">geo.phylo.ses</a></code>,
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(terra)
library(phyloraster)
x &lt;- terra::rast(system.file("extdata", "rast.presab.tif",
package="phyloraster"))[[1:10]]
tree &lt;- ape::read.tree(system.file("extdata", "tree.nex",
package="phyloraster"))
data &lt;- phylo.pres(x, tree)
inv.R &lt;- inv.range(data$x)
t &lt;- geo.phylo(data$x, inv.R = inv.R, edge.path = data$edge.path,
branch.length = data$branch.length, n.descen = data$n.descendants)
terra::plot(t)

</code></pre>

<hr>
<h2 id='geo.phylo.ses'>Calculate phylogenetic community metrics and their standardized effect sizes
for raster data</h2><span id='topic+geo.phylo.ses'></span>

<h3>Description</h3>

<p>Calculates the standardized effect size for phylogenetic
community metrics. See Details for more information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>geo.phylo.ses(
  x,
  tree,
  inv.R,
  edge.path,
  branch.length,
  n.descen,
  full_tree_metr = TRUE,
  spat_alg = "bootspat_str",
  spat_alg_args = list(rprob = NULL, rich = NULL, fr_prob = NULL),
  aleats = 10,
  cores = 1,
  filename = "",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="geo.phylo.ses_+3A_x">x</code></td>
<td>
<p>SpatRaster. A SpatRaster containing presence-absence data (0 or 1)
for a set of species. The layers (species) will be sorted according to the
tree order. See the phylo.pres function.</p>
</td></tr>
<tr><td><code id="geo.phylo.ses_+3A_tree">tree</code></td>
<td>
<p>phylo. A dated tree.</p>
</td></tr>
<tr><td><code id="geo.phylo.ses_+3A_inv.r">inv.R</code></td>
<td>
<p>SpatRaster. Inverse of range size. See <code><a href="#topic+inv.range">inv.range</a></code></p>
</td></tr>
<tr><td><code id="geo.phylo.ses_+3A_edge.path">edge.path</code></td>
<td>
<p>matrix. Matrix representing the paths through the tree from
root to each tip. See <code><a href="#topic+phylo.pres">phylo.pres</a></code></p>
</td></tr>
<tr><td><code id="geo.phylo.ses_+3A_branch.length">branch.length</code></td>
<td>
<p>numeric. A Named numeric vector of branch length for
each species. See <code><a href="#topic+phylo.pres">phylo.pres</a></code></p>
</td></tr>
<tr><td><code id="geo.phylo.ses_+3A_n.descen">n.descen</code></td>
<td>
<p>numeric. A Named numeric vector of number of descendants for
each branch. See <code><a href="#topic+phylo.pres">phylo.pres</a></code></p>
</td></tr>
<tr><td><code id="geo.phylo.ses_+3A_full_tree_metr">full_tree_metr</code></td>
<td>
<p>logical. Whether edge.path, branch length and number
of descendants should be calculated with the full (TRUE) or the prunned tree
(FALSE). The default is TRUE.</p>
</td></tr>
<tr><td><code id="geo.phylo.ses_+3A_spat_alg">spat_alg</code></td>
<td>
<p>A function with the algorithm implementing the desired
randomization method. It must work with SpatRaster objects. See examples.
Example of functions that work are: <code><a href="SESraster.html#topic+bootspat_naive">bootspat_naive</a></code>,
<code><a href="SESraster.html#topic+bootspat_str">bootspat_str</a></code>, <code><a href="SESraster.html#topic+bootspat_ff">bootspat_ff</a></code>.</p>
</td></tr>
<tr><td><code id="geo.phylo.ses_+3A_spat_alg_args">spat_alg_args</code></td>
<td>
<p>List of arguments passed to the randomization method
chosen in 'spat_alg'. See <code><a href="SESraster.html#topic+bootspat_naive">bootspat_naive</a></code>, <code><a href="SESraster.html#topic+bootspat_str">bootspat_str</a></code>,
<code><a href="SESraster.html#topic+bootspat_ff">bootspat_ff</a></code></p>
</td></tr>
<tr><td><code id="geo.phylo.ses_+3A_aleats">aleats</code></td>
<td>
<p>positive integer. A positive integer indicating how many times
the calculation should be repeated.</p>
</td></tr>
<tr><td><code id="geo.phylo.ses_+3A_cores">cores</code></td>
<td>
<p>positive integer. If <code>cores &gt; 1</code>, a 'parallel' package cluster with that many cores is created and used. You can also supply a cluster object. Ignored for functions that are implemented by terra in C++ (see under fun)</p>
</td></tr>
<tr><td><code id="geo.phylo.ses_+3A_filename">filename</code></td>
<td>
<p>character. Output filename</p>
</td></tr>
<tr><td><code id="geo.phylo.ses_+3A_...">...</code></td>
<td>
<p>additional arguments passed for terra::app</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The dependency ‘SESraster’ is used to calculate the null models.
This package currently implements six algorithms to randomize binary species
distribution with several levels of constraints:
SIM1, SIM2, SIM3, SIM5, SIM6 and SIM9 (sensu Gotelli 2000).
The methods implemented in ‘SESraster’ are based on how species
(originally rows) and sites (originally columns) are treated
(i.e. fixed, equiprobable, or proportional sums) (Gotelli 2000).
By default, the ‘phyloraster’ uses the function bootspat_ str() from the
‘SESraster’ package to conduct the randomizations, but the user is free
to choose any of the other methods mentioned above through the spat_alg
argument in the *.ses() functions of the ‘phyloraster’ package.
The bootspat_str() is equivalent to the SIM5 (proportional-fixed) method of
Gotelli (2000), which partially relaxes the spatial structure of species
distributions, but keeps the spatial structure of the observed richness
pattern across cells.
</p>
<p>The dependency ‘SESraster’ is used to calculate the null models.
This package currently implements six algorithms to randomize binary species
distribution with several levels of constraints:
SIM1, SIM2, SIM3, SIM5, SIM6 and SIM9 (sensu Gotelli 2000).
The methods implemented in ‘SESraster’ are based on how species
(originally rows) and sites (originally columns) are treated
(i.e. fixed, equiprobable, or proportional sums) (Gotelli 2000).
By default, the ‘phyloraster’ uses the function bootspat_ str() from the
‘SESraster’ package to conduct the randomizations, but the user is free
to choose any of the other methods mentioned above through the spat_alg
argument in the *.ses() functions of the ‘phyloraster’ package.
The bootspat_str() is equivalent to the SIM5 (proportional-fixed) method of
Gotelli (2000), which partially relaxes the spatial structure of species
distributions, but keeps the spatial structure of the observed richness
pattern across cells.
</p>


<h3>Value</h3>

<p>SpatRaster. The function returns the observed value of the metric,
the mean of the simulations calculated over n times, the standard deviation
of the simulations, the standardized effect size (SES) for the metric,
and the p-values.
</p>


<h3>Author(s)</h3>

<p>Neander Marcel Heming
</p>


<h3>References</h3>

<p>Gotelli, N. J. 2000.
Null model analysis of species co-occurrence patterns. –
Ecology 81: 2606–2621.
</p>
<p>Heming, N. M., Mota, F. M. M. and Alves-Ferreira, G. 2023.
SESraster: raster randomization for null hypothesis testing.
https://CRAN.R-project.org/package=SESraster.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+phylo.pres">phylo.pres</a></code>,
<code><a href="#topic+inv.range">inv.range</a></code>,
<code><a href="#topic+geo.phylo">geo.phylo</a></code>,
<code><a href="#topic+rast.ed.ses">rast.ed.ses</a></code>,
<code><a href="#topic+rast.pd.ses">rast.pd.ses</a></code>,
<code><a href="#topic+rast.we.ses">rast.we.ses</a></code>,
<code><a href="#topic+rast.pe.ses">rast.pe.ses</a></code>,
<code><a href="SESraster.html#topic+bootspat_str">bootspat_str</a></code>,
<code><a href="SESraster.html#topic+bootspat_naive">bootspat_naive</a></code>,
<code><a href="SESraster.html#topic+bootspat_ff">bootspat_ff</a></code>,
<code><a href="SESraster.html#topic+SESraster">SESraster</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(terra)
library(phyloraster)
require("SESraster")
x &lt;- terra::rast(system.file("extdata", "rast.presab.tif",
package="phyloraster"))
tree &lt;- ape::read.tree(system.file("extdata", "tree.nex",
package="phyloraster"))
tses &lt;- geo.phylo.ses(x = x,
                     tree = tree,
                      spat_alg = "bootspat_str",
                      spat_alg_args = list(rprob = NULL,
                                           rich = NULL,
                                           fr_prob = NULL),
                      aleats = 2)
terra::plot(tses)

</code></pre>

<hr>
<h2 id='inv.range'>Calculate the inverse of range size</h2><span id='topic+inv.range'></span>

<h3>Description</h3>

<p>Get range size in square kilometers for all cells that are not
NA, the inverse of range size and the inverse of range size multiplied by
branch length for multiple species using a raster of presence-absence.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>inv.range(x, filename = "", overwrite = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="inv.range_+3A_x">x</code></td>
<td>
<p>SpatRaster. A SpatRaster containing presence-absence data (0 or 1)
for a set of species. The layers (species) will be sorted according to the
tree order. See the phylo.pres function.</p>
</td></tr>
<tr><td><code id="inv.range_+3A_filename">filename</code></td>
<td>
<p>character. Output filename</p>
</td></tr>
<tr><td><code id="inv.range_+3A_overwrite">overwrite</code></td>
<td>
<p>logical. If TRUE, filename is overwritten</p>
</td></tr>
<tr><td><code id="inv.range_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed passed down from a
calling function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>SpatRaster and numeric
</p>


<h3>Author(s)</h3>

<p>Neander Marcel Heming and Gabriela Alves-Ferreira
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# calculating the inverse of range size
x &lt;- terra::rast(system.file("extdata", "rast.presab.tif",
package="phyloraster"))
inv.range(x[[5]])

</code></pre>

<hr>
<h2 id='load.data.rosauer'>Load an example dataset with presence-absence data of 33 tree frogs and
a phylogenetic tree for this species</h2><span id='topic+load.data.rosauer'></span>

<h3>Description</h3>

<p>This function load a phylogenetic tree, a raster and a
data.frame with presence-absence of 33 Australian tree frogs from Rosauer
(2017). We also provide distribution shapefiles for ten species according
to the IUCN.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>load.data.rosauer()
</code></pre>


<h3>Value</h3>

<p>data.frame, SpatRaster, SpatVector and phylo
</p>


<h3>Source</h3>

<p>Rosauer, 2017. Available on:
<a href="https://github.com/DanRosauer/phylospatial/tree/master/PhyloEndemism_in_R/Tree%20Frog%20Data/">Github</a>
</p>
<p>IUCN. 2022. The IUCN Red List of Threatened Species (spatial data).
Version 2022-1. <a href="https://www.iucnredlist.org">IUCN</a>
</p>

<hr>
<h2 id='phylo.pres'>Prepare rasters and phylogenetic tree to run community metrics</h2><span id='topic+phylo.pres'></span>

<h3>Description</h3>

<p>Reorder a stack of rasters of species distribution to
match the order
of the tips of the tree, and get branch length and number of descendants for
each species to calculate diversity metrics using phyloraster::geo.phylo().
The branch length and the number of descendants can be calculated based
on the full tree or the raster based tree subset. The names must be the
same in the phylogenetic tree and in the raster for the
same species. For example, if you have the name &quot;Leptodactylus_latrans&quot; in
the raster and &quot;Leptodactylus latrans&quot; in the tree, the function will not
work. The same goes for uppercase and lowercase letters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>phylo.pres(x, tree, full_tree_metr = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="phylo.pres_+3A_x">x</code></td>
<td>
<p>SpatRaster. A SpatRaster containing presence-absence data (0 or 1)
for a set of species.</p>
</td></tr>
<tr><td><code id="phylo.pres_+3A_tree">tree</code></td>
<td>
<p>phylo. A dated tree.</p>
</td></tr>
<tr><td><code id="phylo.pres_+3A_full_tree_metr">full_tree_metr</code></td>
<td>
<p>logical. Whether edge.path, branch length and number
of descendants should be calculated with the full (TRUE) or the prunned tree
(FALSE). The default is TRUE.</p>
</td></tr>
<tr><td><code id="phylo.pres_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed passed down from a calling
function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list containing a SpatRaster reordered according to the
order
that the species appear in the phylogenetic tree, a subtree containing only
the species that are in the stack of rasters and finally two named numerical
vectors containing the branch length and the number of descendants of
each species.
</p>


<h3>Author(s)</h3>

<p>Neander Marcel Heming and Gabriela Alves Ferreira
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(phyloraster)
x &lt;- terra::rast(system.file("extdata", "rast.presab.tif",
package="phyloraster"))
tree &lt;- ape::read.tree(system.file("extdata", "tree.nex",
package="phyloraster"))
phylo.pres(x[[1:3]], tree, full_tree_metr = TRUE)

# using the prunned tree
phylo.pres(x[[1:3]], tree, full_tree_metr = FALSE)

</code></pre>

<hr>
<h2 id='range_size'>Calculate range size for a set of species using a raster as input</h2><span id='topic+range_size'></span>

<h3>Description</h3>

<p>This function calculate range size in square meters (by default)
for all cells that are not NA. The size of the cells is constant in degrees
but not in square meters, which was considered in the method applied to
calculate the area.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>range_size(x, cellSz, unit = "m", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="range_size_+3A_x">x</code></td>
<td>
<p>SpatRaster. A SpatRaster containing presence-absence data (0 or 1)
for a set of species. The layers (species) will be sorted according to the
tree order. See the phylo.pres function.</p>
</td></tr>
<tr><td><code id="range_size_+3A_cellsz">cellSz</code></td>
<td>
<p>SpatRaster. A SpatRaster containing cellSize values.
See <code><a href="terra.html#topic+cellSize">cellSize</a></code></p>
</td></tr>
<tr><td><code id="range_size_+3A_unit">unit</code></td>
<td>
<p>character. One of &quot;m&quot;, &quot;km&quot;, or &quot;ha&quot;</p>
</td></tr>
<tr><td><code id="range_size_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed passed down from a calling
function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector
</p>


<h3>Author(s)</h3>

<p>Gabriela Alves Ferreira and Neander Marcel Heming
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
x &lt;- terra::rast(system.file("extdata", "rast.presab.tif",
package="phyloraster"))
range_size(x[[1:2]], cellSz &lt;- terra::cellSize(x))

</code></pre>

<hr>
<h2 id='rast.ed'>Calculate Evolutionary distinctiveness for raster data</h2><span id='topic+rast.ed'></span>

<h3>Description</h3>

<p>This function calculates evolutionary distinctiveness according
to the fair-proportion index. The values represents the mean ED for species
presents in each raster cell.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rast.ed(
  x,
  tree,
  edge.path,
  branch.length,
  n.descen,
  full_tree_metr = TRUE,
  filename = "",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rast.ed_+3A_x">x</code></td>
<td>
<p>SpatRaster. A SpatRaster containing presence-absence data (0 or 1)
for a set of species. The layers (species) will be sorted according to the
tree order. See the phylo.pres function.</p>
</td></tr>
<tr><td><code id="rast.ed_+3A_tree">tree</code></td>
<td>
<p>phylo. A dated tree.</p>
</td></tr>
<tr><td><code id="rast.ed_+3A_edge.path">edge.path</code></td>
<td>
<p>matrix. Matrix representing the paths through the tree from
root to each tip. See <code><a href="#topic+phylo.pres">phylo.pres</a></code></p>
</td></tr>
<tr><td><code id="rast.ed_+3A_branch.length">branch.length</code></td>
<td>
<p>numeric. A Named numeric vector of branch length for
each species. See <code><a href="#topic+phylo.pres">phylo.pres</a></code></p>
</td></tr>
<tr><td><code id="rast.ed_+3A_n.descen">n.descen</code></td>
<td>
<p>numeric. A Named numeric vector of number of descendants for
each branch. See <code><a href="#topic+phylo.pres">phylo.pres</a></code></p>
</td></tr>
<tr><td><code id="rast.ed_+3A_full_tree_metr">full_tree_metr</code></td>
<td>
<p>logical. Whether edge.path, branch length and number
of descendants should be calculated with the full (TRUE) or the prunned tree
(FALSE). The default is TRUE.</p>
</td></tr>
<tr><td><code id="rast.ed_+3A_filename">filename</code></td>
<td>
<p>character. Output filename</p>
</td></tr>
<tr><td><code id="rast.ed_+3A_...">...</code></td>
<td>
<p>additional arguments passed for terra::app</p>
</td></tr>
</table>


<h3>Value</h3>

<p>SpatRaster
</p>


<h3>Author(s)</h3>

<p>Neander Marcel Heming and Gabriela Alves-Ferreira
</p>


<h3>References</h3>

<p>Isaac, N. J., Turvey, S. T., Collen, B., Waterman, C. and
Baillie,
J. E. (2007). Mammals on the EDGE: conservation priorities based on threat
and phylogeny. PLoS ONE 2, e296.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(terra)
library(phyloraster)
x &lt;- rast(system.file("extdata", "rast.presab.tif",
package="phyloraster"))
# phylogenetic tree
tree &lt;- ape::read.tree(system.file("extdata", "tree.nex",
package="phyloraster"))
data &lt;- phylo.pres(x[[1:3]], tree)
ed &lt;- rast.ed(data$x, edge.path = data$edge.path,
              branch.length = data$branch.length,
              n.descen = data$n.descen)
plot(ed)

</code></pre>

<hr>
<h2 id='rast.ed.ses'>Standardized effect size for Evolutionary distinctiveness</h2><span id='topic+rast.ed.ses'></span>

<h3>Description</h3>

<p>Calculates the standardized effect size for evolutionary
distinctiveness. See Details for more information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rast.ed.ses(
  x,
  tree,
  edge.path,
  branch.length,
  n.descen,
  full_tree_metr = TRUE,
  spat_alg = "bootspat_str",
  spat_alg_args = list(rprob = NULL, rich = NULL, fr_prob = NULL),
  aleats = 10,
  filename = "",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rast.ed.ses_+3A_x">x</code></td>
<td>
<p>SpatRaster. A SpatRaster containing presence-absence data (0 or 1)
for a set of species. The layers (species) will be sorted according to the
tree order. See the phylo.pres function.</p>
</td></tr>
<tr><td><code id="rast.ed.ses_+3A_tree">tree</code></td>
<td>
<p>phylo. A dated tree.</p>
</td></tr>
<tr><td><code id="rast.ed.ses_+3A_edge.path">edge.path</code></td>
<td>
<p>matrix. Matrix representing the paths through the tree from
root to each tip. See <code><a href="#topic+phylo.pres">phylo.pres</a></code></p>
</td></tr>
<tr><td><code id="rast.ed.ses_+3A_branch.length">branch.length</code></td>
<td>
<p>numeric. A Named numeric vector of branch length for
each species. See <code><a href="#topic+phylo.pres">phylo.pres</a></code></p>
</td></tr>
<tr><td><code id="rast.ed.ses_+3A_n.descen">n.descen</code></td>
<td>
<p>numeric. A Named numeric vector of number of descendants for
each branch. See <code><a href="#topic+phylo.pres">phylo.pres</a></code></p>
</td></tr>
<tr><td><code id="rast.ed.ses_+3A_full_tree_metr">full_tree_metr</code></td>
<td>
<p>logical. Whether edge.path, branch length and number
of descendants should be calculated with the full (TRUE) or the prunned tree
(FALSE). The default is TRUE.</p>
</td></tr>
<tr><td><code id="rast.ed.ses_+3A_spat_alg">spat_alg</code></td>
<td>
<p>A function with the algorithm implementing the desired
randomization method. It must work with SpatRaster objects. See examples.
Example of functions that work are: <code><a href="SESraster.html#topic+bootspat_naive">bootspat_naive</a></code>,
<code><a href="SESraster.html#topic+bootspat_str">bootspat_str</a></code>, <code><a href="SESraster.html#topic+bootspat_ff">bootspat_ff</a></code>.</p>
</td></tr>
<tr><td><code id="rast.ed.ses_+3A_spat_alg_args">spat_alg_args</code></td>
<td>
<p>List of arguments passed to the randomization method
chosen in 'spat_alg'. See <code><a href="SESraster.html#topic+bootspat_naive">bootspat_naive</a></code>, <code><a href="SESraster.html#topic+bootspat_str">bootspat_str</a></code>,
<code><a href="SESraster.html#topic+bootspat_ff">bootspat_ff</a></code></p>
</td></tr>
<tr><td><code id="rast.ed.ses_+3A_aleats">aleats</code></td>
<td>
<p>positive integer. A positive integer indicating how many times
the calculation should be repeated.</p>
</td></tr>
<tr><td><code id="rast.ed.ses_+3A_filename">filename</code></td>
<td>
<p>character. Output filename</p>
</td></tr>
<tr><td><code id="rast.ed.ses_+3A_...">...</code></td>
<td>
<p>additional arguments passed for terra::app</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The dependency ‘SESraster’ is used to calculate the null models.
This package currently implements six algorithms to randomize binary species
distribution with several levels of constraints:
SIM1, SIM2, SIM3, SIM5, SIM6 and SIM9 (sensu Gotelli 2000).
The methods implemented in ‘SESraster’ are based on how species
(originally rows) and sites (originally columns) are treated
(i.e. fixed, equiprobable, or proportional sums) (Gotelli 2000).
By default, the ‘phyloraster’ uses the function bootspat_ str() from the
‘SESraster’ package to conduct the randomizations, but the user is free
to choose any of the other methods mentioned above through the spat_alg
argument in the *.ses() functions of the ‘phyloraster’ package.
The bootspat_str() is equivalent to the SIM5 (proportional-fixed) method of
Gotelli (2000), which partially relaxes the spatial structure of species
distributions, but keeps the spatial structure of the observed richness
pattern across cells.
</p>


<h3>Value</h3>

<p>SpatRaster. The function returns the observed value of the metric,
the mean of the simulations calculated over n times, the standard deviation
of the simulations, the standardized effect size (SES) for the metric,
and the p-values.
</p>


<h3>Author(s)</h3>

<p>Neander M. Heming and Gabriela Alves-Ferreira
</p>


<h3>References</h3>

<p>Gotelli, N. J. 2000.
Null model analysis of species co-occurrence patterns.
– Ecology 81: 2606–2621.
</p>
<p>Heming, N. M., Mota, F. M. M. and Alves-Ferreira, G. 2023.
SESraster: raster randomization for null hypothesis testing.
https://CRAN.R-project.org/package=SESraster.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+phylo.pres">phylo.pres</a></code>,
<code><a href="#topic+inv.range">inv.range</a></code>,
<code><a href="#topic+geo.phylo.ses">geo.phylo.ses</a></code>,
<code><a href="#topic+rast.ed.ses">rast.ed.ses</a></code>,
<code><a href="#topic+rast.pd.ses">rast.pd.ses</a></code>,
<code><a href="#topic+rast.we.ses">rast.we.ses</a></code>,
<code><a href="#topic+rast.pe.ses">rast.pe.ses</a></code>,
<code><a href="SESraster.html#topic+bootspat_str">bootspat_str</a></code>,
<code><a href="SESraster.html#topic+bootspat_naive">bootspat_naive</a></code>,
<code><a href="SESraster.html#topic+bootspat_ff">bootspat_ff</a></code>,
<code><a href="SESraster.html#topic+SESraster">SESraster</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(phyloraster)
library(SESraster)
x &lt;- terra::rast(system.file("extdata", "rast.presab.tif",
package="phyloraster"))
tree &lt;- ape::read.tree(system.file("extdata", "tree.nex",
package="phyloraster"))
t &lt;- rast.ed.ses(x[[1:10]], tree, aleats = 3)
terra::plot(t)

</code></pre>

<hr>
<h2 id='rast.pd'>Calculate phylogenetic diversity for raster data</h2><span id='topic+rast.pd'></span>

<h3>Description</h3>

<p>Calculate the sum of the branch length for species present in
each cell of the raster.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rast.pd(
  x,
  tree,
  edge.path,
  branch.length,
  full_tree_metr = TRUE,
  filename = "",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rast.pd_+3A_x">x</code></td>
<td>
<p>SpatRaster. A SpatRaster containing presence-absence data (0 or 1)
for a set of species. The layers (species) will be sorted according to the
tree order. See the phylo.pres function.</p>
</td></tr>
<tr><td><code id="rast.pd_+3A_tree">tree</code></td>
<td>
<p>phylo. A dated tree.</p>
</td></tr>
<tr><td><code id="rast.pd_+3A_edge.path">edge.path</code></td>
<td>
<p>matrix. Matrix representing the paths through the tree from
root to each tip. See <code><a href="#topic+phylo.pres">phylo.pres</a></code></p>
</td></tr>
<tr><td><code id="rast.pd_+3A_branch.length">branch.length</code></td>
<td>
<p>numeric. A Named numeric vector of branch length for
each species. See <code><a href="#topic+phylo.pres">phylo.pres</a></code></p>
</td></tr>
<tr><td><code id="rast.pd_+3A_full_tree_metr">full_tree_metr</code></td>
<td>
<p>logical. Whether edge.path, branch length and number
of descendants should be calculated with the full (TRUE) or the prunned tree
(FALSE). The default is TRUE.</p>
</td></tr>
<tr><td><code id="rast.pd_+3A_filename">filename</code></td>
<td>
<p>character. Output filename</p>
</td></tr>
<tr><td><code id="rast.pd_+3A_...">...</code></td>
<td>
<p>additional arguments passed for terra::app</p>
</td></tr>
</table>


<h3>Value</h3>

<p>SpatRaster
</p>


<h3>Author(s)</h3>

<p>Neander Marcel Heming and Gabriela Alves-Ferreira
</p>


<h3>References</h3>

<p>Faith, D. P. (1992). Conservation evaluation and
phylogenetic diversity. Biological conservation, 61(1), 1-10.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(terra)
library(phyloraster)
x &lt;- rast(system.file("extdata", "rast.presab.tif",
package="phyloraster"))
tree &lt;- ape::read.tree(system.file("extdata", "tree.nex",
package="phyloraster"))
data &lt;- phylo.pres(x[[1:3]], tree)
pd &lt;- rast.pd(data$x, data$tree)
plot(pd)

</code></pre>

<hr>
<h2 id='rast.pd.ses'>Standardized effect size for Phylogenetic diversity</h2><span id='topic+rast.pd.ses'></span>

<h3>Description</h3>

<p>Calculates the standardized effect size for phylogenetic
diversity.
See Details for more information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rast.pd.ses(
  x,
  tree,
  edge.path,
  branch.length,
  full_tree_metr = TRUE,
  spat_alg = "bootspat_str",
  spat_alg_args = list(rprob = NULL, rich = NULL, fr_prob = NULL),
  aleats = 10,
  filename = "",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rast.pd.ses_+3A_x">x</code></td>
<td>
<p>SpatRaster. A SpatRaster containing presence-absence data (0 or 1)
for a set of species. The layers (species) will be sorted according to the
tree order. See the phylo.pres function.</p>
</td></tr>
<tr><td><code id="rast.pd.ses_+3A_tree">tree</code></td>
<td>
<p>phylo. A dated tree.</p>
</td></tr>
<tr><td><code id="rast.pd.ses_+3A_edge.path">edge.path</code></td>
<td>
<p>matrix. Matrix representing the paths through the tree from
root to each tip. See <code><a href="#topic+phylo.pres">phylo.pres</a></code></p>
</td></tr>
<tr><td><code id="rast.pd.ses_+3A_branch.length">branch.length</code></td>
<td>
<p>numeric. A Named numeric vector of branch length for
each species. See <code><a href="#topic+phylo.pres">phylo.pres</a></code></p>
</td></tr>
<tr><td><code id="rast.pd.ses_+3A_full_tree_metr">full_tree_metr</code></td>
<td>
<p>logical. Whether edge.path, branch length and number
of descendants should be calculated with the full (TRUE) or the prunned tree
(FALSE). The default is TRUE.</p>
</td></tr>
<tr><td><code id="rast.pd.ses_+3A_spat_alg">spat_alg</code></td>
<td>
<p>A function with the algorithm implementing the desired
randomization method. It must work with SpatRaster objects. See examples.
Example of functions that work are: <code><a href="SESraster.html#topic+bootspat_naive">bootspat_naive</a></code>,
<code><a href="SESraster.html#topic+bootspat_str">bootspat_str</a></code>, <code><a href="SESraster.html#topic+bootspat_ff">bootspat_ff</a></code>.</p>
</td></tr>
<tr><td><code id="rast.pd.ses_+3A_spat_alg_args">spat_alg_args</code></td>
<td>
<p>List of arguments passed to the randomization method
chosen in 'spat_alg'. See <code><a href="SESraster.html#topic+bootspat_naive">bootspat_naive</a></code>, <code><a href="SESraster.html#topic+bootspat_str">bootspat_str</a></code>,
<code><a href="SESraster.html#topic+bootspat_ff">bootspat_ff</a></code></p>
</td></tr>
<tr><td><code id="rast.pd.ses_+3A_aleats">aleats</code></td>
<td>
<p>positive integer. A positive integer indicating how many times
the calculation should be repeated.</p>
</td></tr>
<tr><td><code id="rast.pd.ses_+3A_filename">filename</code></td>
<td>
<p>character. Output filename</p>
</td></tr>
<tr><td><code id="rast.pd.ses_+3A_...">...</code></td>
<td>
<p>additional arguments passed for terra::app</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The dependency ‘SESraster’ is used to calculate the null models.
This package currently implements six algorithms to randomize binary species
distribution with several levels of constraints:
SIM1, SIM2, SIM3, SIM5, SIM6 and SIM9 (sensu Gotelli 2000).
The methods implemented in ‘SESraster’ are based on how species
(originally rows) and sites (originally columns) are treated
(i.e. fixed, equiprobable, or proportional sums) (Gotelli 2000).
By default, the ‘phyloraster’ uses the function bootspat_ str() from the
‘SESraster’ package to conduct the randomizations, but the user is free
to choose any of the other methods mentioned above through the spat_alg
argument in the *.ses() functions of the ‘phyloraster’ package.
The bootspat_str() is equivalent to the SIM5 (proportional-fixed) method of
Gotelli (2000), which partially relaxes the spatial structure of species
distributions, but keeps the spatial structure of the observed richness
pattern across cells.
</p>


<h3>Value</h3>

<p>SpatRaster. The function returns the observed value of the metric,
the mean of the simulations calculated over n times, the standard deviation
of the simulations, the standardized effect size (SES) for the metric,
and the p-values.
</p>


<h3>Author(s)</h3>

<p>Gabriela Alves-Ferreira and Neander Heming
</p>


<h3>References</h3>

<p>Gotelli, N. J. 2000.
Null model analysis of species co-occurrence patterns.
– Ecology 81: 2606–2621.
</p>
<p>Heming, N. M., Mota, F. M. M. and Alves-Ferreira, G. 2023.
SESraster: raster randomization for null hypothesis testing.
https://CRAN.R-project.org/package=SESraster.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+phylo.pres">phylo.pres</a></code>, <code><a href="#topic+inv.range">inv.range</a></code>,
<code><a href="#topic+geo.phylo.ses">geo.phylo.ses</a></code>,
<code><a href="#topic+rast.ed.ses">rast.ed.ses</a></code>, <code><a href="#topic+rast.pd.ses">rast.pd.ses</a></code>,
<code><a href="#topic+rast.we.ses">rast.we.ses</a></code>, <code><a href="#topic+rast.pe.ses">rast.pe.ses</a></code>,
<code><a href="SESraster.html#topic+bootspat_str">bootspat_str</a></code>,
<code><a href="SESraster.html#topic+bootspat_naive">bootspat_naive</a></code>,
<code><a href="SESraster.html#topic+bootspat_ff">bootspat_ff</a></code>,
<code><a href="SESraster.html#topic+SESraster">SESraster</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(terra)
library(phyloraster)
library(SESraster)
x &lt;- rast(system.file("extdata", "rast.presab.tif",
package="phyloraster"))
tree &lt;- ape::read.tree(system.file("extdata", "tree.nex",
package="phyloraster"))
data &lt;- phylo.pres(x[[1:10]], tree)
t &lt;- rast.pd.ses(data$x, edge.path = data$edge.path,
                branch.length = data$branch.length, aleats = 3)
plot(t)

</code></pre>

<hr>
<h2 id='rast.pe'>Calculate phylogenetic endemism for raster data</h2><span id='topic+rast.pe'></span>

<h3>Description</h3>

<p>Calculate the sum of the inverse of the range size multiplied
by the branch length for the species present in raster data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rast.pe(
  x,
  tree,
  inv.R,
  branch.length,
  full_tree_metr = TRUE,
  filename = "",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rast.pe_+3A_x">x</code></td>
<td>
<p>SpatRaster. A SpatRaster containing presence-absence data (0 or 1)
for a set of species. The layers (species) will be sorted according to the
tree order. See the phylo.pres function.</p>
</td></tr>
<tr><td><code id="rast.pe_+3A_tree">tree</code></td>
<td>
<p>phylo. A dated tree.</p>
</td></tr>
<tr><td><code id="rast.pe_+3A_inv.r">inv.R</code></td>
<td>
<p>SpatRaster. Inverse of range size. See <code><a href="#topic+inv.range">inv.range</a></code></p>
</td></tr>
<tr><td><code id="rast.pe_+3A_branch.length">branch.length</code></td>
<td>
<p>numeric. A Named numeric vector of branch length for
each species. See <code><a href="#topic+phylo.pres">phylo.pres</a></code></p>
</td></tr>
<tr><td><code id="rast.pe_+3A_full_tree_metr">full_tree_metr</code></td>
<td>
<p>logical. Whether edge.path, branch length and number
of descendants should be calculated with the full (TRUE) or the prunned tree
(FALSE). The default is TRUE.</p>
</td></tr>
<tr><td><code id="rast.pe_+3A_filename">filename</code></td>
<td>
<p>character. Output filename</p>
</td></tr>
<tr><td><code id="rast.pe_+3A_...">...</code></td>
<td>
<p>additional arguments passed for terra::app</p>
</td></tr>
</table>


<h3>Value</h3>

<p>SpatRaster
</p>


<h3>Author(s)</h3>

<p>Gabriela Alves-Ferreira and Neander Marcel Heming
</p>


<h3>References</h3>

<p>Laffan, S. W., Rosauer, D. F., Di Virgilio, G., Miller, J. T.,
González‐Orozco, C. E., Knerr, N., ... &amp; Mishler, B. D. (2016).
Range‐weighted metrics of species and phylogenetic turnover can better
resolve biogeographic transition zones. Methods in Ecology and Evolution,
7(5), 580-588.
</p>
<p>Rosauer, D. A. N., Laffan, S. W., Crisp, M. D., Donnellan, S. C.
and Cook, L. G. (2009). Phylogenetic endemism: a new approach for
identifying geographical concentrations of evolutionary history.
Molecular ecology, 18(19), 4061-4072.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(terra)
library(phyloraster)
x &lt;- rast(system.file("extdata", "rast.presab.tif",
package = "phyloraster"))
tree &lt;- ape::read.tree(system.file("extdata", "tree.nex",
package = "phyloraster"))
pe &lt;- rast.pe(x = x[[1:3]], tree)
plot(pe)

</code></pre>

<hr>
<h2 id='rast.pe.ses'>Standardized effect size for Phylogenetic endemism</h2><span id='topic+rast.pe.ses'></span>

<h3>Description</h3>

<p>Calculates the standardized effect size for phylogenetic
endemism.
See Details for more information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rast.pe.ses(
  x,
  tree,
  branch.length,
  branch.length.alt,
  inv.R,
  full_tree_metr = TRUE,
  spat_alg = "bootspat_str",
  spat_alg_args = list(rprob = NULL, rich = NULL, fr_prob = NULL),
  metric = c("pe", "pe.alt", "rpe", "all")[4],
  aleats = 10,
  cores = 1,
  filename = "",
  overwrite = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rast.pe.ses_+3A_x">x</code></td>
<td>
<p>SpatRaster. A SpatRaster containing presence-absence data (0 or 1)
for a set of species. The layers (species) will be sorted according to the
tree order. See the phylo.pres function.</p>
</td></tr>
<tr><td><code id="rast.pe.ses_+3A_tree">tree</code></td>
<td>
<p>phylo. A dated tree.</p>
</td></tr>
<tr><td><code id="rast.pe.ses_+3A_branch.length">branch.length</code></td>
<td>
<p>numeric. A Named numeric vector of branch length for
each species. See <code><a href="#topic+phylo.pres">phylo.pres</a></code></p>
</td></tr>
<tr><td><code id="rast.pe.ses_+3A_branch.length.alt">branch.length.alt</code></td>
<td>
<p>numeric. Branch length calculated by using an
alternative phylogeny with non-zero branch lengths converted to a constant
value (1) and rescaled so the sum of all branch lengths is 1.</p>
</td></tr>
<tr><td><code id="rast.pe.ses_+3A_inv.r">inv.R</code></td>
<td>
<p>SpatRaster. Inverse of range size. See <code><a href="#topic+inv.range">inv.range</a></code></p>
</td></tr>
<tr><td><code id="rast.pe.ses_+3A_full_tree_metr">full_tree_metr</code></td>
<td>
<p>logical. Whether edge.path, branch length and number
of descendants should be calculated with the full (TRUE) or the prunned tree
(FALSE). The default is TRUE.</p>
</td></tr>
<tr><td><code id="rast.pe.ses_+3A_spat_alg">spat_alg</code></td>
<td>
<p>A function with the algorithm implementing the desired
randomization method. It must work with SpatRaster objects. See examples.
Example of functions that work are: <code><a href="SESraster.html#topic+bootspat_naive">bootspat_naive</a></code>,
<code><a href="SESraster.html#topic+bootspat_str">bootspat_str</a></code>, <code><a href="SESraster.html#topic+bootspat_ff">bootspat_ff</a></code>.</p>
</td></tr>
<tr><td><code id="rast.pe.ses_+3A_spat_alg_args">spat_alg_args</code></td>
<td>
<p>List of arguments passed to the randomization method
chosen in 'spat_alg'. See <code><a href="SESraster.html#topic+bootspat_naive">bootspat_naive</a></code>, <code><a href="SESraster.html#topic+bootspat_str">bootspat_str</a></code>,
<code><a href="SESraster.html#topic+bootspat_ff">bootspat_ff</a></code></p>
</td></tr>
<tr><td><code id="rast.pe.ses_+3A_metric">metric</code></td>
<td>
<p>character. Names of biodiversity metrics to calculate
(pe, pe_alt, rpe, all). See details.</p>
</td></tr>
<tr><td><code id="rast.pe.ses_+3A_aleats">aleats</code></td>
<td>
<p>positive integer. A positive integer indicating how many times
the calculation should be repeated.</p>
</td></tr>
<tr><td><code id="rast.pe.ses_+3A_cores">cores</code></td>
<td>
<p>positive integer. If <code>cores &gt; 1</code>, a 'parallel' package cluster with that many cores is created and used. You can also supply a cluster object. Ignored for functions that are implemented by terra in C++ (see under fun)</p>
</td></tr>
<tr><td><code id="rast.pe.ses_+3A_filename">filename</code></td>
<td>
<p>character. Output filename</p>
</td></tr>
<tr><td><code id="rast.pe.ses_+3A_overwrite">overwrite</code></td>
<td>
<p>logical. If TRUE, filename is overwritten</p>
</td></tr>
<tr><td><code id="rast.pe.ses_+3A_...">...</code></td>
<td>
<p>additional arguments passed for terra::app</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The dependency ‘SESraster’ is used to calculate the null models.
This package currently implements six algorithms to randomize binary species
distribution with several levels of constraints:
SIM1, SIM2, SIM3, SIM5, SIM6 and SIM9 (sensu Gotelli 2000).
The methods implemented in ‘SESraster’ are based on how species
(originally rows) and sites (originally columns) are treated
(i.e. fixed, equiprobable, or proportional sums) (Gotelli 2000).
By default, the ‘phyloraster’ uses the function bootspat_ str() from the
‘SESraster’ package to conduct the randomizations, but the user is free
to choose any of the other methods mentioned above through the spat_alg
argument in the *.ses() functions of the ‘phyloraster’ package.
The bootspat_str() is equivalent to the SIM5 (proportional-fixed) method of
Gotelli (2000), which partially relaxes the spatial structure of species
distributions, but keeps the spatial structure of the observed richness
pattern across cells.
Biodiversity metrics available are:
</p>

<ul>
<li><p> pe: Phylogenetic endemism (Rosauer et al., 2009)
</p>
</li>
<li><p> pe.alt: Alternate Phylogenetic endemism  (Mishler et al., 2014)
</p>
</li>
<li><p> rpe: Relative Phylogenetic endemism (Mishler et al., 2014)
</p>
</li>
<li><p> all: Calculate all available metrics
Alternate phylogenetic endemism (PE.alt, Mishler et al., 2014) is
calculated using an alternate phylogeny with non-zero branch lengths
converted to a constant value (here we use 1) and rescaled so the sum of all
branch lengths is 1.
Relative phylogenetic endemism (RPE, Mishler et al., 2014) is the ratio
of phylogenetic endemism (PE, Rosauer et al., 2009) measured on the
original tree versus PE measured on a alternate tree (PE.alt).
</p>
</li></ul>



<h3>Value</h3>

<p>SpatRaster. The function returns the observed value of the metric,
the mean of the simulations calculated over n times, the standard deviation
of the simulations, the standardized effect size (SES) for the metric,
and the p-values.
</p>


<h3>Author(s)</h3>

<p>Gabriela Alves-Ferreira and Neander Heming
</p>


<h3>References</h3>

<p>Gotelli, N. J. 2000.
Null model analysis of species co-occurrence patterns.
Ecology 81: 2606–2621.
</p>
<p>Heming, N. M., Mota, F. M. M. and Alves-Ferreira, G.
2023. SESraster: raster randomization for null hypothesis testing.
https://CRAN.R-project.org/package=SESraster.
</p>
<p>Mishler, B. D., Knerr, N., González-Orozco, C. E., Thornhill,
A. H., Laffan, S. W. and Miller, J. T. 2014. Phylogenetic measures of
biodiversity and neo- and paleo-endemism in Australian Acacia. –
Nat. Commun. 5: 4473.
</p>
<p>Rosauer, D. A. N., Laffan, S. W., Crisp, M. D., Donnellan, S. C.,
&amp; Cook, L. G. (2009). Phylogenetic endemism: a new approach for identifying
geographical concentrations of evolutionary history. Molecular ecology,
18(19), 4061-4072.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+phylo.pres">phylo.pres</a></code>,
<code><a href="#topic+inv.range">inv.range</a></code>,
<code><a href="#topic+geo.phylo.ses">geo.phylo.ses</a></code>,
<code><a href="#topic+rast.ed.ses">rast.ed.ses</a></code>,
<code><a href="#topic+rast.pd.ses">rast.pd.ses</a></code>,
<code><a href="#topic+rast.we.ses">rast.we.ses</a></code>,
<code><a href="#topic+rast.pe.ses">rast.pe.ses</a></code>,
<code><a href="SESraster.html#topic+bootspat_str">bootspat_str</a></code>,
<code><a href="SESraster.html#topic+bootspat_naive">bootspat_naive</a></code>,
<code><a href="SESraster.html#topic+bootspat_ff">bootspat_ff</a></code>,
<code><a href="SESraster.html#topic+SESraster">SESraster</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(terra)
library(phyloraster)
library(SESraster)
x &lt;- terra::rast(system.file("extdata", "rast.presab.tif",
package="phyloraster"))
tree &lt;- ape::read.tree(system.file("extdata", "tree.nex",
package="phyloraster"))
data &lt;- phylo.pres(x[[1:3]], tree)
t &lt;- rast.pe.ses(x = data$x, data$tree, aleats = 99, metric = "all")
plot(t)

</code></pre>

<hr>
<h2 id='rast.sr'>Calculate species richness for raster data</h2><span id='topic+rast.sr'></span>

<h3>Description</h3>

<p>Calculate the species richness for raster data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rast.sr(x, filename = "", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rast.sr_+3A_x">x</code></td>
<td>
<p>SpatRaster. A SpatRaster containing presence-absence data (0 or 1)
for a set of species.</p>
</td></tr>
<tr><td><code id="rast.sr_+3A_filename">filename</code></td>
<td>
<p>character. Output filename.</p>
</td></tr>
<tr><td><code id="rast.sr_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed passed down from a calling
function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>SpatRaster
</p>


<h3>Author(s)</h3>

<p>Gabriela Alves Ferreira and Neander Marcel Heming
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
x &lt;- terra::rast(system.file("extdata", "rast.presab.tif",
package="phyloraster"))
rse &lt;- phyloraster::rast.sr(x)
terra::plot(rse)

</code></pre>

<hr>
<h2 id='rast.we'>Calculate weighted endemism for raster data</h2><span id='topic+rast.we'></span>

<h3>Description</h3>

<p>Calculate the weighted endemism for species present in raster
data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rast.we(x, inv.R, filename = "", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rast.we_+3A_x">x</code></td>
<td>
<p>SpatRaster. A SpatRaster containing presence-absence data (0 or 1)
for a set of species. The layers (species) will be sorted according to the
tree order. See the phylo.pres function.</p>
</td></tr>
<tr><td><code id="rast.we_+3A_inv.r">inv.R</code></td>
<td>
<p>SpatRaster. Inverse of range size. See <code><a href="#topic+inv.range">inv.range</a></code></p>
</td></tr>
<tr><td><code id="rast.we_+3A_filename">filename</code></td>
<td>
<p>character. Output filename</p>
</td></tr>
<tr><td><code id="rast.we_+3A_...">...</code></td>
<td>
<p>additional arguments passed for terra::app</p>
</td></tr>
</table>


<h3>Value</h3>

<p>SpatRaster
</p>


<h3>Author(s)</h3>

<p>Neander Marcel Heming and Gabriela Alves Ferreira
</p>


<h3>References</h3>

<p>Laffan, S. W., Rosauer, D. F., Di Virgilio, G., Miller, J. T.,
González‐Orozco, C. E., Knerr, N., ... &amp; Mishler, B. D. (2016).
Range‐weighted
metrics of species and phylogenetic turnover can better resolve
biogeographic
transition zones. Methods in Ecology and Evolution, 7(5), 580-588.
</p>
<p>Williams, P.H., Humphries, C.J., Forey, P.L., Humphries, C.J.,
VaneWright, R.I. (1994). Biodiversity, taxonomic relatedness, and endemism
in
conservation. In: Systematics and Conservation Evaluation (eds Forey PL,
Humphries CJ, Vane-Wright RI), p. 438. Oxford University Press, Oxford.
</p>
<p>Crisp, M., Laffan, S., Linder, H., Monro, A. (2001). Endemism
in the Australian flora. Journal of Biogeography, 28, 183–198.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(terra)
library(phyloraster)
x &lt;- rast(system.file("extdata", "rast.presab.tif",
package="phyloraster"))
inv.R &lt;- inv.range(x)
we &lt;- rast.we(x, inv.R)
plot(we)

</code></pre>

<hr>
<h2 id='rast.we.ses'>Calculate weighted endemism standardized for species richness</h2><span id='topic+rast.we.ses'></span>

<h3>Description</h3>

<p>Calculates the standardized effect size for weighted endemism.
See Details for more information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rast.we.ses(
  x,
  inv.R,
  spat_alg = "bootspat_str",
  spat_alg_args = list(rprob = NULL, rich = NULL, fr_prob = NULL),
  aleats = 10,
  filename = "",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rast.we.ses_+3A_x">x</code></td>
<td>
<p>SpatRaster. A SpatRaster containing presence-absence data (0 or 1)
for a set of species. The layers (species) will be sorted according to the
tree order. See the phylo.pres function.</p>
</td></tr>
<tr><td><code id="rast.we.ses_+3A_inv.r">inv.R</code></td>
<td>
<p>SpatRaster. Inverse of range size. See <code><a href="#topic+inv.range">inv.range</a></code></p>
</td></tr>
<tr><td><code id="rast.we.ses_+3A_spat_alg">spat_alg</code></td>
<td>
<p>A function with the algorithm implementing the desired
randomization method. It must work with SpatRaster objects. See examples.
Example of functions that work are: <code><a href="SESraster.html#topic+bootspat_naive">bootspat_naive</a></code>,
<code><a href="SESraster.html#topic+bootspat_str">bootspat_str</a></code>, <code><a href="SESraster.html#topic+bootspat_ff">bootspat_ff</a></code>.</p>
</td></tr>
<tr><td><code id="rast.we.ses_+3A_spat_alg_args">spat_alg_args</code></td>
<td>
<p>List of arguments passed to the randomization method
chosen in 'spat_alg'. See <code><a href="SESraster.html#topic+bootspat_naive">bootspat_naive</a></code>, <code><a href="SESraster.html#topic+bootspat_str">bootspat_str</a></code>,
<code><a href="SESraster.html#topic+bootspat_ff">bootspat_ff</a></code></p>
</td></tr>
<tr><td><code id="rast.we.ses_+3A_aleats">aleats</code></td>
<td>
<p>positive integer. A positive integer indicating how many times
the calculation should be repeated.</p>
</td></tr>
<tr><td><code id="rast.we.ses_+3A_filename">filename</code></td>
<td>
<p>character. Output filename</p>
</td></tr>
<tr><td><code id="rast.we.ses_+3A_...">...</code></td>
<td>
<p>additional arguments passed for terra::app</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The dependency ‘SESraster’ is used to calculate the null models.
This package currently implements six algorithms to randomize binary species
distribution with several levels of constraints:
SIM1, SIM2, SIM3, SIM5, SIM6 and SIM9 (sensu Gotelli 2000).
The methods implemented in ‘SESraster’ are based on how species
(originally rows) and sites (originally columns) are treated
(i.e. fixed, equiprobable, or proportional sums) (Gotelli 2000).
By default, the ‘phyloraster’ uses the function bootspat_ str() from the
‘SESraster’ package to conduct the randomizations, but the user is free
to choose any of the other methods mentioned above through the spat_alg
argument in the *.ses() functions of the ‘phyloraster’ package.
The bootspat_str() is equivalent to the SIM5 (proportional-fixed) method of
Gotelli (2000), which partially relaxes the spatial structure of species
distributions, but keeps the spatial structure of the observed richness
pattern across cells.
</p>


<h3>Value</h3>

<p>SpatRaster. The function returns the observed value of the metric,
the mean of the simulations calculated over n times, the standard deviation
of the simulations, the standardized effect size (SES) for the metric,
and the p-values.
</p>


<h3>Author(s)</h3>

<p>Gabriela Alves-Ferreira and Neander Heming
</p>


<h3>References</h3>

<p>Gotelli, N. J. 2000.
Null model analysis of species co-occurrence patterns.
– Ecology 81: 2606–2621.
</p>
<p>Heming, N. M., Mota, F. M. M. and Alves-Ferreira, G. 2023.
SESraster: raster randomization for null hypothesis testing.
https://CRAN.R-project.org/package=SESraster.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+phylo.pres">phylo.pres</a></code>,
<code><a href="#topic+inv.range">inv.range</a></code>,
<code><a href="#topic+geo.phylo.ses">geo.phylo.ses</a></code>,
<code><a href="#topic+rast.ed.ses">rast.ed.ses</a></code>,
<code><a href="#topic+rast.pd.ses">rast.pd.ses</a></code>,
<code><a href="#topic+rast.we.ses">rast.we.ses</a></code>,
<code><a href="#topic+rast.pe.ses">rast.pe.ses</a></code>,
<code><a href="SESraster.html#topic+bootspat_str">bootspat_str</a></code>,
<code><a href="SESraster.html#topic+bootspat_naive">bootspat_naive</a></code>,
<code><a href="SESraster.html#topic+bootspat_ff">bootspat_ff</a></code>,
<code><a href="SESraster.html#topic+SESraster">SESraster</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(terra)
library(SESraster)
x &lt;- terra::rast(system.file("extdata", "rast.presab.tif",
package="phyloraster"))
t &lt;- rast.we.ses(x[[1:10]], aleats = 3)
plot(t)

</code></pre>

<hr>
<h2 id='shp2rast'>Rasterize shapefile</h2><span id='topic+shp2rast'></span>

<h3>Description</h3>

<p>The function will rasterize the shapefile using the parameters of y, a
SpatRaster. When the argument y is provided, the resolution parameter is
ignored. When the argument ymask is TRUE, y is used as a mask for x.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shp2rast(
  x,
  y = NULL,
  sps.col,
  ymask = FALSE,
  background = NA,
  touches = TRUE,
  resolution,
  values = 1,
  filename = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="shp2rast_+3A_x">x</code></td>
<td>
<p>SpatVector or a two-column matrix (point coordinates)</p>
</td></tr>
<tr><td><code id="shp2rast_+3A_y">y</code></td>
<td>
<p>SpatRaster</p>
</td></tr>
<tr><td><code id="shp2rast_+3A_sps.col">sps.col</code></td>
<td>
<p>character. It should be a variable name in x.</p>
</td></tr>
<tr><td><code id="shp2rast_+3A_ymask">ymask</code></td>
<td>
<p>logical. If TRUE, y will be used as a mask for x.</p>
</td></tr>
<tr><td><code id="shp2rast_+3A_background">background</code></td>
<td>
<p>numeric. Value to put in the cells that are not covered by any of the features of <code>x</code>. Default is <code>NA</code></p>
</td></tr>
<tr><td><code id="shp2rast_+3A_touches">touches</code></td>
<td>
<p>logical. If <code>TRUE</code>, all cells touched by lines or polygons are affected, not just those on the line render path, or whose center point is within the polygon. If <code>touches=TRUE</code>, <code>add</code> cannot be <code>TRUE</code></p>
</td></tr>
<tr><td><code id="shp2rast_+3A_resolution">resolution</code></td>
<td>
<p>numeric vector of length 1 or 2 to set the spatial resolution (see <code><a href="terra.html#topic+res">res</a></code>). If this argument is used, arguments <code>ncols</code> and <code>nrows</code> are ignored </p>
</td></tr>
<tr><td><code id="shp2rast_+3A_values">values</code></td>
<td>
<p>typically a numeric vector of length <code>1</code> or <code>nrow(x)</code>. If the length is below <code>nrow(x)</code> the values will be recycled to <code>nrow(x)</code>. Only used when <code>x</code> is a matrix. Can also be a matrix or data.frame</p>
</td></tr>
<tr><td><code id="shp2rast_+3A_filename">filename</code></td>
<td>
<p>character. Output filename</p>
</td></tr>
<tr><td><code id="shp2rast_+3A_...">...</code></td>
<td>
<p>additional arguments passed to <code>fun</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>SpatRaster
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(terra)

shp &lt;- terra::vect(system.file("extdata", "shps_iucn_spps_rosauer.shp",
                              package="phyloraster"))

# create a polygon to use as mask with an extent
e &lt;- terra::ext(113, 123, -43.64, -33.90)
p &lt;- terra::as.polygons(e, crs="")
coun.crop &lt;- terra::crop(p, terra::ext(shp))
coun.rast &lt;- terra::rasterize(coun.crop,
terra::rast(terra::ext(shp), resolution = 0.5))

plot(coun.rast, col = "green")

# rasterizing with the mask of the polygon
shp.t &lt;- shp2rast(shp, y = coun.rast, sps.col = "BINOMIAL",
ymask = TRUE, background = 0)
plot(shp.t, col = c("grey", "green"))

# rasterizing without using mask
shp.t2 &lt;- shp2rast(shp, sps.col = "BINOMIAL", ymask = FALSE,
background = NA, resolution = 0.1)
plot(shp.t2[[9]], col = c("grey", "green"))

</code></pre>

<hr>
<h2 id='species.ed'>Calculate Evolutionary distinctiveness for each species</h2><span id='topic+species.ed'></span>

<h3>Description</h3>

<p>This function calculates evolutionary distinctiveness according
to the fair-proportion index for each species.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>species.ed(tree)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="species.ed_+3A_tree">tree</code></td>
<td>
<p>phylo. A dated tree.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.frame
</p>


<h3>Author(s)</h3>

<p>Neander Marcel Heming and Gabriela Alves-Ferreira
</p>


<h3>References</h3>

<p>Isaac, N. J., Turvey, S. T., Collen, B.,
Waterman, C. and Baillie, J. E. (2007). Mammals on the EDGE:
conservation priorities based on threat and phylogeny. PLoS ONE 2, e296.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(phyloraster)
tree &lt;- ape::read.tree(system.file("extdata", "tree.nex",
package="phyloraster"))
plot(tree)
ed &lt;- species.ed(tree)
ed

</code></pre>

<hr>
<h2 id='species.tip.length'>Compute species tip length</h2><span id='topic+species.tip.length'></span>

<h3>Description</h3>

<p>Computation of species tip length using a phylogeny.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>species.tip.length(tree = NULL, edge.info = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="species.tip.length_+3A_tree">tree</code></td>
<td>
<p>phylo. A dated tree.</p>
</td></tr>
<tr><td><code id="species.tip.length_+3A_edge.info">edge.info</code></td>
<td>
<p>Object returned by <code><a href="#topic+tip.root.path">tip.root.path</a></code> consisting of
a list containing the edge matrix (H1) with the path from tip to root and and
a numeric vector (edge.length) giving the length of each branch of the tree.</p>
</td></tr>
<tr><td><code id="species.tip.length_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed passed down from a calling
function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculates tip lengths for all species in a phylogeny
</p>


<h3>Value</h3>

<p>returns a numeric vector giving the length of species branch.
</p>


<h3>Author(s)</h3>

<p>Neander M. Heming
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(phyloraster)
tree &lt;- ape::read.tree(system.file("extdata", "tree.nex",
package="phyloraster"))

species.tip.length(tree)

library(ape)
set.seed(1)
tree &lt;- rtree(n=40)

plot(tree)

species.tip.length(tree)

edge.info &lt;- tip.root.path(tree)

species.tip.length(edge.info = edge.info)

</code></pre>

<hr>
<h2 id='tip.root.path'>Compute tree edge lengths and node paths from root to each tip</h2><span id='topic+tip.root.path'></span>

<h3>Description</h3>

<p>Computation of tree edge lengths and node paths from root to each tip to
calculate PD for a entire phylogeny (= sum of all edge or branch lengths)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tip.root.path(tree)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tip.root.path_+3A_tree">tree</code></td>
<td>
<p>phylo. A dated tree.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Based on the algorithm FastXtreePhylo of Peter D. Wilson
</p>


<h3>Value</h3>

<p>returns a list with two components: matrix H1
representing the paths through the tree from root to each tip,
and edge.length a
numeric vector giving the length of each branch in the tree. Some matrix
algebra and a summation of the resulting vector gives the whole-tree
PD value.
</p>


<h3>Author(s)</h3>

<p>Peter Wilson
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(phyloraster)
tree &lt;- ape::read.tree(system.file("extdata", "tree.nex",
package="phyloraster"))

fxtp &lt;- tip.root.path(tree)
H1 &lt;- fxtp$H1
edge.length &lt;- fxtp$edge.length
# PD for the whole community
pres &lt;- rep(1, nrow(H1))
sum((crossprod(H1, pres)&gt;0) * edge.length)

# PD for a random subset of the community
pres &lt;- sample(c(1, 0), nrow(H1), TRUE)
sum((crossprod(H1, pres)&gt;0) * edge.length)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
