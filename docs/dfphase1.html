<!DOCTYPE html><html><head><title>Help for package dfphase1</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {dfphase1}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#dfphase1-package'>
<p>Phase I Control Charts (with Emphasis on Distribution-Free</p>
Methods)</a></li>
<li><a href='#changepoint'>
<p>Detection of a sustained change-point in univariate and multivariate data</p></a></li>
<li><a href='#colonscopy'><p>Colonscopy Times</p></a></li>
<li><a href='#fe'><p>Ferric Oxide data</p></a></li>
<li><a href='#gravel'><p>Gravel data</p></a></li>
<li><a href='#mphase1'>
<p>Distribution-free Phase I analysis of multivariate data</p></a></li>
<li><a href='#mphase1.methods'>
<p>Methods for objects of class <code>mphase1</code></p></a></li>
<li><a href='#mshewhart'>
<p>Multivariate Shewhart-type control charts</p></a></li>
<li><a href='#phase1Plot'>
<p>Plot of Phase 1 data</p></a></li>
<li><a href='#rsp'>
<p>Distribution-Free Phase I Analysis of Univariate Data based on</p>
Recursive Segmentation and Permutation</a></li>
<li><a href='#ryan'><p>Ryan data</p></a></li>
<li><a href='#shewhart'>
<p>Univariate Shewhart-type control charts</p></a></li>
<li><a href='#Student'><p>A simulated dataset</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Phase I Control Charts (with Emphasis on Distribution-Free
Methods)</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.0</td>
</tr>
<tr>
<td>Author:</td>
<td>Giovanna Capizzi and Guido Masarotto</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Giovanna Capizzi &lt;giovanna.capizzi@unipd.it&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Statistical methods for retrospectively detecting changes
             in location and/or dispersion of univariate and multivariate 
             variables. Data values are assumed to be independent, can be 
             individual (one observation at each instant of time) or subgrouped 
             (more than one observation at each instant of time). 
             Control limits are computed, often using a permutation approach, 
             so that a prescribed false alarm probability is guaranteed  
             without making any parametric assumptions on the stable 
             (in-control) distribution. See G. Capizzi and G. Masarotto (2018) 
             &lt;<a href="https://doi.org/10.1007%2F978-3-319-75295-2_1">doi:10.1007/978-3-319-75295-2_1</a>&gt; for an introduction to the package.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/LGPL-2">LGPL-2</a> | <a href="https://www.r-project.org/Licenses/LGPL-2.1">LGPL-2.1</a> | <a href="https://www.r-project.org/Licenses/LGPL-3">LGPL-3</a> [expanded from: LGPL (&ge; 2)]</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 0.11.1), lattice, robustbase</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-06-19 10:00:51 UTC; guido</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-06-19 13:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='dfphase1-package'>
Phase I Control Charts (with Emphasis on Distribution-Free
Methods)
</h2><span id='topic+dfphase1-package'></span><span id='topic+dfphase1'></span>

<h3>Description</h3>

<p>Statistical methods for retrospectively detecting changes in location
and/or dispersion of univariate and multivariate variables. Data values
are assumed to be independent, can be individual (one observation at
each instant of time) or subgrouped (more than one observation at each
instant of time).  Control limits are computed, often using a
permutation approach, so that a prescribed false alarm probability is
guaranteed  without making any parametric assumptions on the stable
(in-control) distribution. 
</p>


<h3>Details</h3>

<p>The main functions are:
</p>

<ul>
<li> <p><code><a href="#topic+shewhart">shewhart</a></code> and <code><a href="#topic+mshewhart">mshewhart</a></code>:
univariate and multivariate Shewhart-type control charts
based either on the original observations or on a rank transformation.
These functions are particularly useful for detecting isolated shifts
in the mean and/or variance of subgrouped observations.
Functions <code><a href="#topic+shewhart">shewhart</a></code> and <code><a href="#topic+mshewhart">mshewhart</a></code> also allow
the simultaneously use of two control charts originally
designed to detect separately location and scale shifts.
In particular, note that when more than one critical values are needed, the
false alarm probability is &ldquo;balanced&rdquo; between the
separate control charts as discussed by Capizzi (2015).
</p>
</li>
<li> <p><code><a href="#topic+changepoint">changepoint</a></code> and <code><a href="#topic+mchangepoint">mchangepoint</a></code>:
univariate or multivariate control charts useful for detecting
sustained (and other patterned) mean and/or variance shifts.
The control statistic is based on a generalized likelihood
ratio test computed under a Gaussian assumption. However, the
control limits are computed by permutation. An optional 
preliminary rank transformation can be used to improve the performance in the case of
nonnormal data.
</p>
</li>
<li>
<p><code><a href="#topic+rsp">rsp</a></code> and <code><a href="#topic+mphase1">mphase1</a></code>: the univariate and
multivariate methods introduced by
Capizzi and Masarotto (2013) and (2017) to detect multiple isolated
or step shifts in individual or subgrouped data.
</p>
</li></ul>

<p>The use of distribution-free control limits is emphasized.
However, the package also includes some functions 
for computing normal-based control limits.
As noted in the individual help pages, these limits can also be
suitable  for some non-normal distributions
(e.g., applying a multivariate rank.-transformation, normal-based
control limits mantain the desired false alarm probability 
in the class of the multivariate elliptical distributions).
Nevertheless, their use is not generally recommended.
</p>
<p>The data should be organized as follows:
</p>

<ul>
<li> <p><em>Univariate control charts:</em>
an nxm matrix, where
n and m are the size of each subgroup and
the number of subgroups, respectively.
A vector of length m is accepted  in the case of individual data, i.e.,
when n=1.
</p>
</li>
<li> <p><em>Multivariate control charts:</em>
a pxnxm array, where
p denotes the number of monitored variables.
A p x m matrix is accepted in the case of individual
data.
</p>
</li></ul>

<p>Functions <code><a href="#topic+phase1Plot">phase1Plot</a></code> and <code><a href="#topic+mphase1Plot">mphase1Plot</a></code> can
be used for plotting the data.
</p>


<h3>Author(s)</h3>

<p>Giovanna Capizzi and Guido Masarotto (maintainer: Giovanna Capizzi &lt;giovanna.capizzi@unipd.it&gt;).
</p>


<h3>References</h3>

<p>G. Capizzi (2015) &ldquo;Recent advances in process monitoring: 
Nonparametric and variable-selection
methods for Phase I and Phase II (with discussion)&rdquo;. 
<em>Quality Engineering</em>,  <b>27</b>, pp. 44&ndash;80,
<a href="https://doi.org/10.1080/08982112.2015.968046">doi:10.1080/08982112.2015.968046</a>. 
</p>
<p>G. Capizzi and G. Masarotto (2013),
&ldquo;Phase I Distribution-Free Analysis of Univariate Data&rdquo;.
<em>Journal of Quality Technology</em>, <b>45</b>, pp. 273&ndash;284, 
<a href="https://doi.org/10.1080/00224065.2013.11917938">doi:10.1080/00224065.2013.11917938</a>.
</p>
<p>G. Capizzi and G. Masarotto (2017), Phase I Distribution-Free
Analysis of Multivariate Data, <em>Technometrics</em>,
<b>59</b>, pp. 484&ndash;495, 
<a href="https://doi.org/10.1080/00401706.2016.1272494">doi:10.1080/00401706.2016.1272494</a>.
</p>
<p>G. Capizzi and G. Masarotto (2018),
&ldquo;Phase I Distribution-Free Analysis with the R
Package <code>dfphase1</code>&rdquo;.
<em>Frontiers in Statistical Quality Control 12</em>, eds. S. Knoth and
W. Schmid, pp. 3&ndash;19, Springer, 
<a href="https://doi.org/10.1007/978-3-319-75295-2_1">doi:10.1007/978-3-319-75295-2_1</a>  
</p>


<h3>See Also</h3>

<p><code><a href="#topic+shewhart">shewhart</a></code>,
<code><a href="#topic+shewhart.normal.limits">shewhart.normal.limits</a></code>,
<code><a href="#topic+mshewhart">mshewhart</a></code>,
<code><a href="#topic+mshewhart.normal.limits">mshewhart.normal.limits</a></code>,
<code><a href="#topic+changepoint">changepoint</a></code>,
<code><a href="#topic+changepoint.normal.limits">changepoint.normal.limits</a></code>,
<code><a href="#topic+mchangepoint">mchangepoint</a></code>,
<code><a href="#topic+mchangepoint.normal.limits">mchangepoint.normal.limits</a></code>,
<code><a href="#topic+rsp">rsp</a></code>,
<code><a href="#topic+mphase1">mphase1</a></code>,
<code><a href="#topic+phase1Plot">phase1Plot</a></code>,
<code><a href="#topic+mphase1Plot">mphase1Plot</a></code>.
</p>

<hr>
<h2 id='changepoint'>
Detection of a sustained change-point in univariate and multivariate data
</h2><span id='topic+changepoint'></span><span id='topic+mchangepoint'></span><span id='topic+changepoint.normal.limits'></span><span id='topic+mchangepoint.normal.limits'></span>

<h3>Description</h3>

<p><code>changepoint</code> (univariate data) and <code>mchangepoint</code>
(multivariate data) test for the presence of a
sustained location and/or dispersion shift. Both functions can be applied
to individual and subgrouped observations.
</p>
<p><code>changepoint.normal.limits</code> and
<code>mchangepoint.normal.limits</code> precompute
the corresponding control limits when the in-control distribution is
normal.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>changepoint(x, subset, score = c("Identity", "Ranks"), only.mean = FALSE,
  plot = TRUE, FAP = 0.05, seed = 11642257, L = 10000, limits = NA)

mchangepoint(x, subset, score = c("Identity", "Signed Ranks", "Spatial Signs",
  "Spatial Ranks", "Marginal Ranks"), only.mean = FALSE,
  plot = TRUE, FAP = 0.05, seed = 11642257, L = 10000, limits = NA) 

changepoint.normal.limits(n, m, score = c("Identity", "Ranks"),
  only.mean = FALSE, FAP = 0.05, seed = 11642257, L = 100000)

mchangepoint.normal.limits(p, n, m, score = c("Identity", "Signed Ranks", "Spatial Signs",
  "Spatial Ranks", "Marginal Ranks"), only.mean = FALSE,
  FAP = 0.05, seed = 11642257, L = 100000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="changepoint_+3A_x">x</code></td>
<td>

<p><code>changepoint</code>: a nxm numeric matrix or a numeric vector of
length m.
</p>
<p><code>mchangepoint</code>: a pxnxm data numeric array
or a pxm numeric vector.
</p>
<p>See below, for the meaning of p, n and m.
</p>
</td></tr>
<tr><td><code id="changepoint_+3A_p">p</code></td>
<td>

<p>integer: number of monitored variables.
</p>
</td></tr>
<tr><td><code id="changepoint_+3A_n">n</code></td>
<td>

<p>integer: size of each subgroup (number of observations gathered at
each time point).
</p>
</td></tr>
<tr><td><code id="changepoint_+3A_m">m</code></td>
<td>

<p>integer: number of subgroups (time points).
</p>
</td></tr>
<tr><td><code id="changepoint_+3A_subset">subset</code></td>
<td>

<p>an optional vector specifying a subset of subgroups/time points to be used
</p>
</td></tr>
<tr><td><code id="changepoint_+3A_score">score</code></td>
<td>

<p>character: the transformation to use; see <code><a href="#topic+mshewhart">mshewhart</a></code>.
</p>
</td></tr>
<tr><td><code id="changepoint_+3A_only.mean">only.mean</code></td>
<td>

<p>logical; if <code>TRUE</code> only a location change-point is searched.
</p>
</td></tr>
<tr><td><code id="changepoint_+3A_plot">plot</code></td>
<td>

<p>logical; if <code>TRUE</code>, the control statistic is displayed. 
</p>
</td></tr>
<tr><td><code id="changepoint_+3A_fap">FAP</code></td>
<td>

<p>numeric (between 0 and 1): the desired false alarm probability.
</p>
</td></tr>
<tr><td><code id="changepoint_+3A_seed">seed</code></td>
<td>

<p>positive integer; if not <code>NA</code>, the RNG's state is resetted
using <code>seed</code>. The current <code>.Random.seed</code> will be
preserved.     Unused by <code>mshewhart</code> when <code>limits</code> is not <code>NA</code>.
</p>
</td></tr>
<tr><td><code id="changepoint_+3A_l">L</code></td>
<td>

<p>positive integer: the number of Monte Carlo replications used to
compute the control limits.  Unused by <code>changepoint</code> and
<code>mchangepoint</code> when <code>limits</code> is not <code>NA</code>.
</p>
</td></tr>
<tr><td><code id="changepoint_+3A_limits">limits</code></td>
<td>

<p>numeric: a precomputed vector of length m containing the control limits.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>After an optional rank transformation (argument <code>score</code>),
<code>changepoint</code> and <code>mchangepoint</code> compute,
for <code class="reqn">\tau=2,\ldots,m</code>, the normal likelihood ratio test statistics
for verifying whether the mean and dispersion (or only the mean when
<code>only.mean=TRUE</code>) are the same before and after <code class="reqn">\tau</code>.
See Sullivan and Woodall (1999, 2000) and Qiu (2013), Chapter 6 and
Section 7.5. 
</p>
<p>Note that 
the control statistic is equivalent to that proposed by
Lung-Yut-Fong <em>et al.</em> (2011)
when <code>score="Marginal Ranks"</code> and <code>only.mean=TRUE</code>.
</p>
<p>As suggested by Sullivan and Woodall (1999, 2000), 
control limits proportional to the
in-control mean of the likelihood ratio test statistics
are used. Further, when <code>plot=TRUE</code>, the control
statistics divided by the time-varying control limits
are plotted with a &ldquo;pseudo-limit&rdquo; equal to one.
</p>
<p>When <code>only.mean=FALSE</code>, the decomposition of the
likelihood ratio test statistic suggested
by Sullivan and Woodall (1999, 2000)
for diagnostic purposes is also
computed, and optionally plotted.
</p>


<h3>Value</h3>

<p><code>changepoint</code> and <code>mchangepoint</code> return an
invisible list with elements
</p>
<table>
<tr><td><code>glr</code></td>
<td>

<p>control statistics.
</p>
</td></tr>
<tr><td><code>mean</code>, <code>dispersion</code></td>
<td>
<p>decomposition
of the control statistics in the two parts due to changes in the mean and
dispersion, respectively. These elements are present only when
<code>only.mean=FALSE</code>.</p>
</td></tr>
<tr><td><code>limits</code></td>
<td>
<p>control limits.</p>
</td></tr>
<tr><td><code>score</code>, <code>only.mean</code>, <code>FAP</code>, <code>L</code>, <code>seed</code></td>
<td>
<p> input arguments.</p>
</td></tr>
</table>
<p><code>changepoint.normal.limits</code> and <code>mchangepoint.normal.limits</code> return a numeric vector
containing the control limits.
</p>


<h3>Note</h3>


<ol>
<li>
<p>When <code>limits</code> is <code>NA</code>, <code>changepoint</code>
and <code>mchangepoint</code>
compute the control limits by permutation.
The resulting control charts are distribution-free.
</p>
</li>
<li>
<p>Pre-computed limits, like those computed using
<code>changepoint.normal.limits</code> and
<code>mchangepoint.normal.limits</code>,  
are recommended <em>only</em> for univariate data when <code>score=Ranks</code>.
Indeed, in all the other cases, the resulting control
chart will not be distribution-free.
</p>
</li>
<li>
<p>However, note that, when <code>score</code> is <code>Signed Ranks</code>, <code>Spatial
    Signs</code>, <code>Spatial Ranks</code> 
the normal-based control limits are distribution-free in the class
of all multivariate elliptical distributions.
</p>
</li></ol>



<h3>Author(s)</h3>

<p>Giovanna Capizzi and Guido Masarotto.
</p>


<h3>References</h3>

<p>A. Lung-Yut-Fong, C. Lévy-Leduc, O. Cappé O (2011) 
&ldquo;Homogeneity and change-point detection tests
for multivariate data using rank statistics&rdquo;. arXiv:11071971,
<a href="https://arxiv.org/abs/1107.1971">https://arxiv.org/abs/1107.1971</a>.
</p>
<p>P. Qiu (2013) <em>Introduction to Statistical Process Control</em>. Chapman &amp; Hall/CRC Press.
</p>
<p>J. H. Sullivan, W. H. Woodall (1996) &ldquo;A control chart for
preliminary analysis of individual observations&rdquo;. <em>Journal of
Quality Technology</em>, <b>28</b>, pp. 265&ndash;278, 
<a href="https://doi.org/10.1080/00224065.1996.11979677">doi:10.1080/00224065.1996.11979677</a>.    
</p>
<p>J. H. Sullivan, W. H. Woodall (2000) &ldquo;Change-point detection of mean vector or covariance matrix shifts using multivariate individual observations&rdquo;. 
<em>IIE Transactions</em>, <b>32</b>, pp. 537&ndash;549
<a href="https://doi.org/10.1080/07408170008963929">doi:10.1080/07408170008963929</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(gravel)
changepoint(gravel[1,,])
mchangepoint(gravel)
mchangepoint(gravel,score="Signed Ranks")
</code></pre>

<hr>
<h2 id='colonscopy'>Colonscopy Times</h2><span id='topic+colonscopy'></span>

<h3>Description</h3>

<p>This data set contains the colonscopy times (minutes)
for 30 subgroups of 5 patients given in Allison Jones-Farmer <em>et al.</em> (2009).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(colonscopy)</code></pre>


<h3>Format</h3>

<p>A 5x30 matrix.
</p>


<h3>References</h3>

<p>L. A. Jones-Farmer, V. Jordan, C. W. Champs (2009)
&ldquo;Distribution-free Phase I control charts for subgroup location&rdquo;,
<em>Journal of Quality Technology</em>, <b>41</b>, pp. 304&ndash;316,
<a href="https://doi.org/10.1080/00224065.2009.11917784">doi:10.1080/00224065.2009.11917784</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(colonscopy)
phase1Plot(colonscopy)
</code></pre>

<hr>
<h2 id='fe'>Ferric Oxide data</h2><span id='topic+fe'></span>

<h3>Description</h3>

<p>This data set contains 189 ferric-oxide individual measurement
collected in an aluminum smelter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(fe)</code></pre>


<h3>Format</h3>

<p>A vector of length 189.
</p>


<h3>References</h3>

<p>M. D. Holland, D. M. Hawkins (2014) &ldquo;A Control Chart Based on a
Nonparametric Multivariate Change-Point Model&rdquo;, <em>Journal of
Quality Technology</em>, <b>46</b>, pp 63&ndash;77,
<a href="https://doi.org/10.1080/00224065.2014.11917954">doi:10.1080/00224065.2014.11917954</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(fe)
phase1Plot(fe)
</code></pre>

<hr>
<h2 id='gravel'>Gravel data</h2><span id='topic+gravel'></span>

<h3>Description</h3>

<p>This data set contains 56 individual bivariate observations
from a gravel-producing plant given by Holmes
and Mergen (1993). There are two variables measuring
the percentage of the particles (by weight) that are large or medium in size, respectively.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(gravel)</code></pre>


<h3>Format</h3>

<p>A 2x56 matrix.
</p>


<h3>References</h3>

<p>D. S. Holmes, A. Mergen (1993) 
&ldquo;Improving the Performance of the <code class="reqn">T^2</code> Control Chart&rdquo;, 
<em>Quality Engineering</em>, <b>5</b>, pp. 619&ndash;625,
<a href="https://doi.org/10.1080/08982119308919004">doi:10.1080/08982119308919004</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(gravel)
mphase1Plot(gravel)
</code></pre>

<hr>
<h2 id='mphase1'>
Distribution-free Phase I analysis of multivariate data 
</h2><span id='topic+mphase1'></span>

<h3>Description</h3>

<p>Retrospective change point detection using the method  described by
Capizzi and Masarotto (2017).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mphase1(x, plot = TRUE, post.signal = TRUE, isolated = dim(x)[2] &gt; 1, step = TRUE,
        alpha = 0.05, gamma = 0.5, K = min(50, round(sqrt(dim(x)[3]))),
        lmin = 5, L = 1000, seed = 11642257)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mphase1_+3A_x">x</code></td>
<td>

<p>a pxnxm array containing the observations; <code>x[r,j,i]</code> is
the jth observation on the rth variable of the ith subgroup. 
</p>
</td></tr>
<tr><td><code id="mphase1_+3A_plot">plot</code></td>
<td>

<p>logical; if <code>FALSE</code> the diagnostic plot is not displayed.
</p>
</td></tr>
<tr><td><code id="mphase1_+3A_post.signal">post.signal</code></td>
<td>

<p>logical; if <code>FALSE</code> the diagnostic LASSO-based analysis
is not performed.
</p>
</td></tr>
<tr><td><code id="mphase1_+3A_isolated">isolated</code></td>
<td>

<p>logical; if <code>FALSE</code> isolated shifts are not detected.
</p>
</td></tr>
<tr><td><code id="mphase1_+3A_step">step</code></td>
<td>

<p>logical; if <code>FALSE</code> step shifts are not detected.
</p>
</td></tr>
<tr><td><code id="mphase1_+3A_alpha">alpha</code></td>
<td>

<p>real; the acceptable false alarm probability; if the
observed p-value is greater than <code>alpha</code>, then
the estimated mean function is a constant.
</p>
</td></tr>
<tr><td><code id="mphase1_+3A_gamma">gamma</code></td>
<td>

<p>real; the extra penalization for the extended BIC criteria.
</p>
</td></tr>
<tr><td><code id="mphase1_+3A_k">K</code></td>
<td>

<p>integer; the maximum number of shifts which the procedure
tries to detect.
</p>
</td></tr>
<tr><td><code id="mphase1_+3A_lmin">lmin</code></td>
<td>

<p>integer; the minimum length of a step shift.
</p>
</td></tr>
<tr><td><code id="mphase1_+3A_l">L</code></td>
<td>

<p>integer; the number of random permutations used to compute the p-values.
</p>
</td></tr>
<tr><td><code id="mphase1_+3A_seed">seed</code></td>
<td>

<p>integer; if not <code>NA</code>, the RNG's state is re-setted
using <code>seed</code>. The current <code>.Random.seed</code> will be preserved.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Functions <code>mphase1</code> returns an object of class <code>mphase1</code> containing
</p>
<table>
<tr><td><code>p.value</code></td>
<td>
<p>The p-value.</p>
</td></tr>
<tr><td><code>Wobs</code></td>
<td>
<p>The overall test statistic.</p>
</td></tr>
<tr><td><code>alasso</code></td>
<td>
<p>A data-frame containing the result of the
post-signal diagnosis analysis,i.e., the times and types of shifts
and the involved variables identified using the adaptive LASSO.</p>
</td></tr>
<tr><td><code>forward</code></td>
<td>
<p>A data frame containing the result of the forward search analysis, i.e.,
the times and types of the possible shifts as well as
the elementary test statistics and the estimates of their
(conditional) means and standard deviations.</p>
</td></tr>
<tr><td><code>center</code>, <code>scatter</code></td>
<td>
<p>The location vector and dispersion matrix used
to standardize the original data.</p>
</td></tr>
<tr><td><code>signed.ranks</code></td>
<td>
<p>A pxnxm array containing the signed ranks.</p>
</td></tr>
<tr><td><code>fitted</code>, <code>residuals</code></td>
<td>
<p>Two pxnxm arrays containing the fitted
means and the residuals, i.e., the difference between the
observations and the fitted values.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Giovanna Capizzi and Guido Masarotto.
</p>


<h3>References</h3>

<p>G. Capizzi and G. Masarotto (2017), Phase I Distribution-Free
Analysis of Multivariate Data, <em>Technometrics</em>,
<b>59</b>, pp. 484&ndash;495, <a href="https://doi.org/10.1080/00401706.2016.1272494">doi:10.1080/00401706.2016.1272494</a>. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+postsignal">postsignal</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  # A simulated in-control data from a Student's t distribution
  # with 3 degrees of freedom
  set.seed(123)
  x &lt;- sweep(array(rnorm(5*5*50),c(5,5,50)),c(2,3),sqrt(rchisq(5*50,3)/3),"/")
  mphase1(x)
  # Reproduction of the two examples given in Capizzi and Masarotto (2016)
  data(ryan)
  mphase1(ryan)
  data(gravel)
  mphase1(gravel)
</code></pre>

<hr>
<h2 id='mphase1.methods'>
Methods for objects of class <code>mphase1</code>
</h2><span id='topic+postsignal'></span><span id='topic+print.mphase1'></span><span id='topic+plot.mphase1'></span><span id='topic+postsignal.mphase1'></span>

<h3>Description</h3>

<p>Methods <code>print</code> and <code>plot</code> allow to write
to the console and plot (optionally changing the layout)
the result of the Phase I analysis performed with function
<code>mphase1</code>.
</p>
<p>Method <code>postsignal</code> implements the post-signal Phase I analysis
based on the adaptive LASSO described in Capizzi and Masarotto (2016).
It uses the p-value and the results on the forward search
contained in its first argument. Hence, it is
useful for re-running the analysis with different values
of <code>alpha</code> and/or <code>gamma</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mphase1'
print(x,...)
## S3 method for class 'mphase1'
plot(x,layout=c(1,p),...)
## S3 method for class 'mphase1'
postsignal(x, plot = TRUE, alpha = 0.05, gamma = 0.5,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mphase1.methods_+3A_x">x</code></td>
<td>

<p>an object returned by function <code><a href="#topic+mphase1">mphase1</a></code>.
</p>
</td></tr>
<tr><td><code id="mphase1.methods_+3A_layout">layout</code></td>
<td>

<p>an integer vector describing the multi-panel (and
possible multi-page) layout. 
</p>
</td></tr>
<tr><td><code id="mphase1.methods_+3A_plot">plot</code></td>
<td>

<p>logical; if <code>TRUE</code> the diagnostic plot is displayed.
</p>
</td></tr>
<tr><td><code id="mphase1.methods_+3A_alpha">alpha</code></td>
<td>

<p>real; the acceptable false alarm probability; if the
observed p-value is greater than <code>alpha</code>, then
the estimated mean function is a constant.
</p>
</td></tr>
<tr><td><code id="mphase1.methods_+3A_gamma">gamma</code></td>
<td>

<p>real; the extra penalization for the extended BIC criteria.
</p>
</td></tr>
<tr><td><code id="mphase1.methods_+3A_...">...</code></td>
<td>
<p>ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>mphase1</code>. See <code><a href="#topic+mphase1">mphase1</a></code>
for the description.
</p>


<h3>Author(s)</h3>

<p>Giovanna Capizzi and Guido Masarotto.
</p>


<h3>References</h3>

<p>G. Capizzi and G. Masarotto (2017), Phase I Distribution-Free
Analysis of Multivariate Data, <em>Technometrics</em>,
<b>59</b>, pp. 484&ndash;495, <a href="https://doi.org/10.1080/00401706.2016.1272494">doi:10.1080/00401706.2016.1272494</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(gravel)
  u &lt;- mphase1(gravel,plot=FALSE)
  print(u)
  plot(u,layout=c(2,1))
  postsignal(u,plot=FALSE,gamma=1)
</code></pre>

<hr>
<h2 id='mshewhart'>
Multivariate Shewhart-type control charts
</h2><span id='topic+mshewhart'></span><span id='topic+mshewhart.normal.limits'></span>

<h3>Description</h3>

<p><code>mshewhart</code> computes, and, optionally,  plots, 
several Shewhart-type Phase I control charts for detecting
location and scale changes in multivariate subgrouped data.
</p>
<p><code>mshewhart.normal.limits</code> pre-computes
the corresponding control limits when the in-control distribution is
multivariate normal.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mshewhart(x, subset, stat = c("T2Var", "T2", "Var", "Depth Ranks"), score = c("Identity",
  "Signed Ranks",  "Spatial Signs", "Spatial Ranks", "Marginal Ranks"),
  loc.scatter = c("Classic", "Robust"), plot = TRUE, FAP = 0.05,
  seed = 11642257, L = 1000, limits = NA)

mshewhart.normal.limits(p, n, m, stat = c("T2Var", "T2", "Var", "Depth Ranks"),
  score = c("Identity", "Signed Ranks",  "Spatial Signs", "Spatial Ranks",
  "Marginal Ranks"), loc.scatter = c("Classic", "Robust"),
  FAP = 0.05, seed = 11642257, L = 100000) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mshewhart_+3A_x">x</code></td>
<td>

<p>a pxnxm data numeric array
(n observations gathered at m time points on p variables).
</p>
</td></tr>
<tr><td><code id="mshewhart_+3A_p">p</code></td>
<td>

<p>integer: number of monitored variables.
</p>
</td></tr>
<tr><td><code id="mshewhart_+3A_n">n</code></td>
<td>

<p>integer: size of each subgroup (number of observations gathered at
each time point).
</p>
</td></tr>
<tr><td><code id="mshewhart_+3A_m">m</code></td>
<td>

<p>integer: number of subgroups (time points).
</p>
</td></tr>
<tr><td><code id="mshewhart_+3A_subset">subset</code></td>
<td>

<p>an optional vector specifying a subset of subgroups/time points to be used
</p>
</td></tr>
<tr><td><code id="mshewhart_+3A_stat">stat</code></td>
<td>

<p>character: control statistic[s] to use; see Details.
</p>
</td></tr>
<tr><td><code id="mshewhart_+3A_score">score</code></td>
<td>

<p>character: transformation to use; unused when
<code>stat=Depth Ranks</code>; see Details.
</p>
</td></tr>
<tr><td><code id="mshewhart_+3A_loc.scatter">loc.scatter</code></td>
<td>

<p>character: estimates of the multivariate location and scatter
to use when no preliminary rank transformation is applied.
Unused when <code>stat</code> is equal to <code>Depth Ranks</code> or <code>score</code> is 
<code>Marginal Ranks</code>. See Details.
</p>
</td></tr>
<tr><td><code id="mshewhart_+3A_plot">plot</code></td>
<td>

<p>logical; if <code>TRUE</code>, control statistic[s] is[are] displayed. 
</p>
</td></tr>
<tr><td><code id="mshewhart_+3A_fap">FAP</code></td>
<td>

<p>numeric (between 0 and 1): desired false alarm probability.
</p>
</td></tr>
<tr><td><code id="mshewhart_+3A_seed">seed</code></td>
<td>

<p>positive integer; if not <code>NA</code>, the RNG's state is resetted
using <code>seed</code>. The current <code>.Random.seed</code> will be
preserved.     Unused by <code>mshewhart</code> when <code>limits</code> is not <code>NA</code>.
</p>
</td></tr>
<tr><td><code id="mshewhart_+3A_l">L</code></td>
<td>

<p>positive integer: number of Monte Carlo replications used to
compute the control limits.  Unused by <code>mshewhart</code> when <code>limits</code> is not <code>NA</code>.
</p>
</td></tr>
<tr><td><code id="mshewhart_+3A_limits">limits</code></td>
<td>

<p>numeric: pre-computed vector of control limits.
This vector should contain <code class="reqn">(A,B)</code>
when <code>stat=T2Var</code>, <code class="reqn">(A)</code> when <code>stat=T2</code>,
<code class="reqn">(B)</code> when <code>stat=Var</code> and
<code class="reqn">(C)</code> when <code>stat=Depth Ranks</code>.
See Details for the definition of the critical values
<code class="reqn">A</code>, <code class="reqn">B</code> and <code class="reqn">C</code>. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The implemented control statistics are
</p>

<ul>
<li><p><code>T2Var</code>: combination of the <code>T2</code> and
<code>Var</code> statistics described below.
</p>
</li>
<li><p><code>T2</code>: Hotelling's <code class="reqn">T^2</code> control statistics
(see Montgomery, 2009, equation 11.19, or Qiu, 2013, equation
7.7) with control limit equal to <code class="reqn">A</code>.
</p>
</li>
<li><p><code>Var</code>: normal likelihood ratio control statistics
for detecting changes in the multivariate dispersion
(see Montgomery, 2009, equation 11.34), with control limit
equal to <code class="reqn">B</code>.
</p>
</li>
<li><p><code>Depth Ranks</code>:
control statistics based on the rank of the Mahalanobis
depths, proposed by Bell <em>et. al.</em>. As suggested Bell <em>et
al.</em>, the Mahalanobis depths are computed using the BACON estimates
of the multivariate mean vector and the mean of the subgroups sample
covariance matrices.
An alarm is signalled if any of the statistics is greater
than a positive control limit <code class="reqn">C</code>.
</p>
</li></ul>

<p>The <code>T2</code> and <code>Var</code> control statistics are computed
</p>

<ul>
<li><p><code>score=Identical:</code>
from the original data standardized
using either the classical pooled estimates of the mean vector
and dispersion matrix (Montgomery, 2009, equations 11.14&ndash;11.18;
Qiu, 2013, equations at page 269)   or the highly robust minimum covariance determinant (MCD)
estimate when argument <code>loc.scatter</code> is equal to
<code>Classic</code> or <code>Robust</code>, respectively.
</p>
</li>
<li><p><code>score=Signed Ranks, Spatial Signs, Spatial Ranks,
  Marginal Ranks</code>: from a &ldquo;rank&rdquo; transformation of the original 
data. In particular, see   Hallin and Paindaveine (2005) for the
definition of the multivariate signed ranks and Oja (2010) for those of the
spatial signs, spatial ranks, and marginal ranks. Multivariate signed
ranks, spatial signs and
ranks are &ldquo;inner&rdquo; standardized while marginal ranks are
&ldquo;outer&rdquo; standardized (see Oja (2010) for the definition of
&ldquo;inner&rdquo; and &ldquo;outer&rdquo; standardization).
When <code>loc.scatter</code> is equal to <code>Classic</code>, 
inner standardization takes into account the subgroup structure of the
data imposing that the average of the <strong>within-group</strong> covariances of the
transformed data is proportional to the identity matrix.
Otherwise, i.e., when
<code>loc.scatter</code> is equal to <code>Robust</code>,  it is based on  
a standard Hettmansperger-Randles-like scatter estimate.
Note that the <code class="reqn">T^2</code> control statistics based on the spatial
signs corresponds to the control charts suggested by
Cheng and Shiau (2015) when <code>loc.scatter</code> is equal to
<code>Robust</code>.
</p>
</li></ul>



<h3>Value</h3>

<p><code>mshewhart</code> returns an invisible list with elements:
</p>
<table>
<tr><td><code>T2</code></td>
<td>
<p><code class="reqn">T^2</code> control statistic; this element is present only if
<code>stat</code> is <code>T2Var</code> or <code>T2</code>.</p>
</td></tr>
<tr><td><code>Var</code></td>
<td>
<p><code class="reqn">Var</code> control statistic; this element is present only if
<code>stat</code> is <code>T2Var</code> or <code>Var</code>.</p>
</td></tr>
<tr><td><code>DepthRanks</code></td>
<td>
<p>control statistic based on the rank of
the Mahalanobis depths; this element is present only if
<code>stat</code> is <code>Depth Ranks</code>.</p>
</td></tr>
<tr><td><code>center</code>, <code>scatter</code></td>
<td>
<p>estimates of the
multivariate location and scatter used to standardized the observations.</p>
</td></tr>
<tr><td><code>limits</code></td>
<td>
<p>control limits.</p>
</td></tr>
<tr><td><code>stat</code>, <code>score</code>, <code>loc.scatter</code>, <code>FAP</code>, <code>L</code>, <code>seed</code></td>
<td>
<p> input arguments.</p>
</td></tr>
</table>
<p><code>mshewhart.normal.limits</code> returns a numeric vector
containing the control limits.
</p>


<h3>Note</h3>


<ol>
<li>
<p>When <code>limits</code> is <code>NA</code>, <code>mshewhart</code>
computes the control limits by permutation.
Then, the resulting control chart is distribution-free.
</p>
</li>
<li>
<p>Pre-computed limits, such as  those computed by
using <code>mshewhart.normal.limits</code>,  are not recommended.
Indeed, the resulting control
chart will not be distribution-free.
</p>
</li>
<li>
<p>However, when <code>score</code> is <code>Signed Ranks</code>, <code>Spatial
      Signs</code>, <code>Spatial Ranks</code> or <code>stat</code> is <code>Depth Ranks</code>,
the computed control limits are distribution-free in the class
of all multivariate elliptical distributions.
</p>
</li></ol>



<h3>Author(s)</h3>

<p>Giovanna Capizzi and Guido Masarotto.
</p>


<h3>References</h3>

<p>R. C. Bell, L. A. Jones-Farmer, N. Billor (2014) 
&ldquo;A distribution-free multivariate Phase I location control
chart for subgrouped data from elliptical distributions&rdquo;. 
<em>Technometrics</em>, <b>56</b>, pp. 528&ndash;538,
<a href="https://doi.org/10.1080/00401706.2013.879264">doi:10.1080/00401706.2013.879264</a>.
</p>
<p>C. R. Cheng, J. J. H. Shiau JJH (2015)
&ldquo;A distribution-free multivariate control chart for Phase I applications&rdquo;.
<em>Quality and Reliability Engineering International</em>, <b>31</b>,
pp. 97&ndash;111, 
<a href="https://doi.org/10.1002/qre.1751">doi:10.1002/qre.1751</a>.
</p>
<p>M. Hallin and D. Paindaveine (2005) &ldquo;Affine-Invariant Aligned
Rank Tests for the Multivariate General Linear Model with VARMA
Errors&rdquo;. <em>Journal of Multivariate Analysis</em>, <b>93</b>, 
pp. 122&ndash;163, <a href="https://doi.org/10.1016/j.jmva.2004.01.005">doi:10.1016/j.jmva.2004.01.005</a>.
</p>
<p>D. C. Montgomery (2009) <em>Introduction to Statistical Quality
Control</em>, 6th edn. Wiley.
</p>
<p>H. Oja (2010) <em>Multivariate Nonparametric Methods with R. An Approach Based on Spatial Signs
and Ranks</em>. Springer.
</p>
<p>P. Qiu (2013) <em>Introduction to Statistical Process Control</em>. Chapman &amp; Hall/CRC Press.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ryan)
mshewhart(ryan)
mshewhart(ryan,subset=-10)
mshewhart(ryan,subset=-c(10,20))
mshewhart(ryan,score="Signed Ranks")
mshewhart(ryan,subset=-10,score="Signed Ranks")
mshewhart(ryan,subset=-c(10,20),score="Signed Ranks")
</code></pre>

<hr>
<h2 id='phase1Plot'>
Plot of Phase 1 data
</h2><span id='topic+phase1Plot'></span><span id='topic+mphase1Plot'></span>

<h3>Description</h3>

<p><code>phase1Plot</code> and <code>mphase1Plot</code>
plot univariate or multivariate Phase 1 observations,
organized as required by  the <code>dfphase1</code> package. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>phase1Plot(x)

mphase1Plot(x, layout = c(1, p))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="phase1Plot_+3A_x">x</code></td>
<td>

<p><code>phase1Plot</code>: a nxm numeric matrix or a numeric vector of
length m.
</p>
<p><code>mphase1Plot</code>: a pxnxm data numeric array
or a pxm numeric matrix.
</p>
<p>Here, p denotes the number of variables, n the size
of each subgroup and m the number of subgroups.
</p>
</td></tr>
<tr><td><code id="phase1Plot_+3A_layout">layout</code></td>
<td>

<p>an integer vector describing the multi-panel (and
possible multi-page) layout. See the third example below.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Giovanna Capizzi and Guido Masarotto.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  x &lt;- matrix(rt(5*20,5),5)
  x[,10] &lt;- x[,10]+3
  phase1Plot(x)
  # a data set with many variables
  x &lt;- array(rnorm(20*5*50),c(20,5,50))+10*(1:20)
  mphase1Plot(x)
  # it is better to organize the plot on two pages
  if (interactive()) old &lt;- grDevices::devAskNewPage(TRUE)
  mphase1Plot(x,c(2,5,2))
  if (interactive()) grDevices::devAskNewPage(old)
</code></pre>

<hr>
<h2 id='rsp'>
Distribution-Free Phase I Analysis of Univariate Data based on
Recursive Segmentation and Permutation
</h2><span id='topic+rsp'></span>

<h3>Description</h3>

<p><code>rsp</code> implements the Phase I method described in Capizzi and Masarotto (2013).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rsp(y, plot = TRUE, L = 1000, seed = 11642257, alpha = 0.05,
    maxsteps = min(50, round(NROW(y)/15)), lmin = max(5, min(10, round(NROW(y)/10))))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rsp_+3A_y">y</code></td>
<td>

<p>Phase I data; <code>y</code> can be either (i) a vector or a 1xm matrix in the case of
individual observations or (ii) a nxm matrix for subgrouped data
(n observations gathered at m time points).
</p>
</td></tr>
<tr><td><code id="rsp_+3A_plot">plot</code></td>
<td>

<p>logical; if <code>TRUE</code>, the diagnostic plot is displayed. 
</p>
</td></tr>
<tr><td><code id="rsp_+3A_l">L</code></td>
<td>

<p>integer; the number of random permutations used to compute the p-values.
</p>
</td></tr>
<tr><td><code id="rsp_+3A_seed">seed</code></td>
<td>

<p>positive integer; if not <code>NA</code>, the RNG's state is resetted
using <code>seed</code>. The current <code>.Random.seed</code> will be preserved.
</p>
</td></tr>
<tr><td><code id="rsp_+3A_alpha">alpha</code></td>
<td>

<p>real; the significance level used to compute the level and scale
estimates; if one of the p-values is greater than
<code>alpha</code>, the corresponding estimate is a constant.
</p>
</td></tr>
<tr><td><code id="rsp_+3A_maxsteps">maxsteps</code></td>
<td>

<p>integer; the maximum number of step shifts which the procedure tries to detect.
</p>
</td></tr>
<tr><td><code id="rsp_+3A_lmin">lmin</code></td>
<td>

<p>integer; the minimum length of a step.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with elements
</p>
<table>
<tr><td><code>p</code></td>
<td>
<p>the adjusted p-values</p>
</td></tr>
<tr><td><code>stat</code></td>
<td>
<p>the summary statistics (a mx2 matrix)</p>
</td></tr>
<tr><td><code>fitted</code></td>
<td>
<p>the (possibly time-variant) estimates of the process level and
scale (a mx2 matrix).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Giovanna Capizzi and Guido Masarotto.
</p>


<h3>References</h3>

<p>G. Capizzi, G. Masarotto (2013),
&ldquo;Phase I Distribution-Free Analysis of Univariate Data&rdquo;.
<em>Journal of Quality Technology</em>, <b>45</b>, pp. 273-284,
<a href="https://doi.org/10.1080/00224065.2013.11917938">doi:10.1080/00224065.2013.11917938</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Individual observations with a transient level change
set.seed(112233)
level &lt;- c(rep(0,20),rep(3,10),rep(0,20))
x &lt;- level+rt(50,4)
rsp(x)
# Individual observations with a scale step change
scale &lt;- c(rep(1,25),rep(3,25))
x &lt;- scale*rt(50,4)
rsp(x)
data(fe)
rsp(fe)
data(colonscopy)
rsp(colonscopy)
</code></pre>

<hr>
<h2 id='ryan'>Ryan data</h2><span id='topic+ryan'></span>

<h3>Description</h3>

<p>This data set contains the data given in Table 9.2 by Ryan (2011, p. 323). The sample
comprises 20 subgroups, each with 4 observations, on two quality characteristics <code class="reqn">X_1</code> and
<code class="reqn">X_2</code>. According to Ryan (2011), the 10th and 20th subgroups are out-of-control.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ryan)</code></pre>


<h3>Format</h3>

<p>A 2x4x20 array.
</p>


<h3>References</h3>

<p>T. P. Ryan (2011), <em>Statistical Methods for Quality Improvement</em>,
3rd ed., Wiley.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ryan)
mphase1Plot(ryan)
</code></pre>

<hr>
<h2 id='shewhart'>
Univariate Shewhart-type control charts
</h2><span id='topic+shewhart'></span><span id='topic+shewhart.normal.limits'></span>

<h3>Description</h3>

<p><code>shewhart</code> computes, and, optionally,  plots, 
Shewhart-type Phase I control charts for detecting
changes in location and scale of univariate subgrouped data.
</p>
<p><code>shewhart.normal.limits</code> pre-computes
the corresponding control limits when the in-control distribution is normal.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shewhart(x, subset, 
         stat = c("XbarS", "Xbar", "S", 
                  "Rank", "lRank", "sRank",
                  "Lepage", "Cucconi"),
         aggregation = c("mean", "median"), 
         plot = TRUE, 
         FAP = 0.05,
         seed = 11642257, 
         L = 1000, 
         limits = NA)

shewhart.normal.limits(n, m, 
                       stat = c("XbarS", "Xbar", "S", 
                                "Rank", "lRank", "sRank", 
                                "Lepage", "Cucconi"),
                       aggregation = c("mean", "median"), 
                       FAP = 0.05,
                       seed = 11642257, 
                       L = 100000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="shewhart_+3A_x">x</code></td>
<td>

<p>a nxm data numeric matrix
(n observations gathered at m time points).
</p>
</td></tr>
<tr><td><code id="shewhart_+3A_subset">subset</code></td>
<td>

<p>an optional vector specifying a subset of subgroups/time points to be used
</p>
</td></tr>
<tr><td><code id="shewhart_+3A_stat">stat</code></td>
<td>

<p>character: the control statistic[s] to use; see Details.
</p>
</td></tr>
<tr><td><code id="shewhart_+3A_aggregation">aggregation</code></td>
<td>

<p>character: 
it specify how to aggregate the subgroup means and standard deviations.
Used only when <code>stat</code> is <code>XbarS</code>, <code>Xbar</code> or <code>S</code>.
</p>
</td></tr>
<tr><td><code id="shewhart_+3A_plot">plot</code></td>
<td>

<p>logical; if <code>TRUE</code>, control statistic[s] is[are] displayed. 
</p>
</td></tr>
<tr><td><code id="shewhart_+3A_fap">FAP</code></td>
<td>

<p>numeric (between 0 and 1): desired false alarm probability.
Unused by <code>shewhart</code> when <code>limits</code> is not <code>NA</code>.
</p>
</td></tr>
<tr><td><code id="shewhart_+3A_seed">seed</code></td>
<td>

<p>positive integer; if not <code>NA</code>, the RNG's state is resetted
using <code>seed</code>. The current <code>.Random.seed</code> will be
preserved.
Unused by <code>shewhart</code> when <code>limits</code> is not <code>NA</code>.
</p>
</td></tr>
<tr><td><code id="shewhart_+3A_l">L</code></td>
<td>

<p>positive integer: number of random permutations used to
compute the control limits.  Unused by <code>shewhart</code> when <code>limits</code> is not <code>NA</code>.
</p>
</td></tr>
<tr><td><code id="shewhart_+3A_limits">limits</code></td>
<td>

<p>numeric: a precomputed vector of control limits.
The vector should contain <code class="reqn">(A,B_1,B_2)</code>
when <code>stat=XbarS</code>, <code class="reqn">(A)</code> when <code>stat=Xbar</code>,
<code class="reqn">(B_1,B_2)</code> when <code>stat=S</code>,
<code class="reqn">(C,D)</code> when <code>stat=Rank</code>, <code class="reqn">(C)</code> when
<code>stat=lRank</code>, <code class="reqn">(D)</code> when <code>stat=sRank</code>,
and <code class="reqn">(E)</code> when <code>stat=Lepage</code> or <code>stat=Cucconi</code>.
See Details for the definition of the critical values
<code class="reqn">A</code>, <code class="reqn">B_1</code>,  <code class="reqn">B_2</code>, <code class="reqn">C</code>, <code class="reqn">D</code>
and <code class="reqn">E</code>. 
</p>
</td></tr>
<tr><td><code id="shewhart_+3A_n">n</code></td>
<td>

<p>integer: size of each subgroup (number of observations gathered at
each time point).
</p>
</td></tr>
<tr><td><code id="shewhart_+3A_m">m</code></td>
<td>

<p>integer: number of subgroups (time points).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The implemented control charts are:
</p>

<ul>
<li><p><code>XbarS</code>: combination of the <code>Xbar</code>
and <code>S</code> control charts described in the following.
</p>
</li>
<li><p><code>Xbar</code>: chart based on plotting the subgroup means with control limits
</p>
<p style="text-align: center;"><code class="reqn">\hat{\mu}\pm A\frac{\hat{\sigma}}{\sqrt{n}}</code>
</p>

<p>where <code class="reqn">\hat{\mu}</code> (<code class="reqn">\hat{\sigma}</code>)
denotes the estimate of the in-control mean (standard deviation)
computed as the mean or median of the subgroup means (standard
deviations).
</p>
</li>
<li><p><code>S</code>:  chart based on plotting the (unbiased) subgroup standard deviations
with lower control limit <code class="reqn">B_1\hat{\sigma}</code>  and
upper control limit <code class="reqn">B_2\hat{\sigma}</code>.
</p>
</li>
<li><p><code>Rank</code>: combination of the <code>lRank</code>
and <code>sRank</code> control charts described in the following.
</p>
</li>
<li><p><code>lRank</code>: control chart based on the standardized
rank-sum control statistic suggested by
Jones-Farmer <em>et al.</em> (2009) for detecting changes in the location parameter.
Control limits are of the type <code class="reqn">\pm C</code>.
</p>
</li>
<li><p><code>sRank</code>: chart based on the standardized
rank-sum control statistic suggested by
Jones-Farmer and Champ (2010) for detecting changes in the scale parameter.
Control limits are of the type <code class="reqn">\pm D</code>.
</p>
</li>
<li><p><code>Lepage</code>: chart based on the Lepage control statistic
suggested by Li <em>et al.</em> (2019) for detecting changes in
location and/or scale. There is only a upper control limit equal to <code class="reqn">E</code>.
</p>
</li>
<li><p><code>Cucconi</code>: chart based on the Cucconi control statistic
suggested by Li <em>et al.</em> (2020) for detecting changes in
location and/or scale. There is only a upper control limit equal to <code class="reqn">E</code>.
</p>
</li></ul>



<h3>Value</h3>

<p><code>shewhart</code> returns an invisible list with elements
</p>
<table>
<tr><td><code>Xbar</code></td>
<td>
<p>subgroup means; this element is present only if
<code>stat</code> is <code>XbarS</code> or <code>Xbar</code>.</p>
</td></tr>
<tr><td><code>S</code></td>
<td>
<p>subgroup standard deviation; this element is present only if
<code>stat</code> is <code>XbarS</code> or <code>S</code>.</p>
</td></tr>
<tr><td><code>lRank</code></td>
<td>
<p>rank-based control statistics for detecting
changes in location; this element is present only if
<code>stat</code> is <code>Rank</code> or <code>lRank</code>.</p>
</td></tr>
<tr><td><code>sRank</code></td>
<td>
<p>rank-based control-statistics for detecting
changes in scale; this element is present only if
<code>stat</code> is <code>Rank</code> or <code>sRank</code>.</p>
</td></tr>
<tr><td><code>Lepage</code>, <code>W2</code>, <code>AB2</code></td>
<td>
<p>Lepage, squared Wilcoxon
and squared Ansari-Bradley statistics; these elements are present 
only if <code>stat</code> is <code>Lepage</code>.</p>
</td></tr>
<tr><td><code>Cucconi</code>, <code>lCucconi</code>, <code>sCucconi</code></td>
<td>
<p>Cucconi control statistic and 
its location and scale components; 
these elements are present only if <code>stat</code> is <code>Cucconi</code>.</p>
</td></tr>   
<tr><td><code>limits</code></td>
<td>
<p>control limits.</p>
</td></tr>
<tr><td><code>center</code>, <code>scale</code></td>
<td>
<p>estimates
<code class="reqn">\hat{\mu}</code> and <code class="reqn">\hat{\sigma}</code> of the in-control
mean and standard deviation; these elements are present only if
<code>stat</code> is <code>XbarS</code>, <code>Xbar</code> and <code>S</code>.</p>
</td></tr>
<tr><td><code>stat</code>, <code>L</code>, <code>aggregation</code>, <code>FAP</code>, <code>seed</code></td>
<td>
<p> input arguments.</p>
</td></tr>
</table>
<p><code>shewhart.normal.limits</code> returns a numeric vector
containing the limits.
</p>


<h3>Note</h3>


<ol>
<li>
<p>If argument <code>limits</code> is <code>NA</code>, <code>shewhart</code>
computes the control limits by permutation. 
The resulting control chart are distribution-free.
</p>
</li>
<li>
<p>Pre-computed limits, such as those computed using
<code>shewhart.normal.limits</code>,  are not recommended 
when <code>stat</code> is <code>XbarS</code>, <code>Xbar</code> or <code>S</code>.
Indeed, the resulting control chart will not be distribution-free.
</p>
</li>
<li>
<p>When <code>stat</code> is <code>Rank</code>, <code>lRank</code>,
<code>sRank</code>, <code>Lepage</code> or <code>Cucconi</code> the control limits computed by
<code>shewhart.normal.limits</code> are distribution-free in the class
of all univariate continuous distributions.
So, if user plan to apply rank-based control charts on a repeated
number of samples of the same size,  pre-computing the control limits using
<code>mshewhart.normal.limits</code>
can reduce the overall computing time.
</p>
</li></ol>



<h3>Author(s)</h3>

<p>Giovanna Capizzi and Guido Masarotto.
</p>


<h3>References</h3>

<p>L. A. Jones-Farmer, V. Jordan, C. W. Champs (2009)
&ldquo;Distribution-free Phase I control charts for subgroup location&rdquo;,
<em>Journal of Quality Technology</em>, <b>41</b>, pp. 304&ndash;316,
<a href="https://doi.org/10.1080/00224065.2009.11917784">doi:10.1080/00224065.2009.11917784</a>. 
</p>
<p>L. A. Jones-Farmer, C. W. Champ (2010) 
&ldquo;A distribution-free Phase I control chart for subgroup scale&rdquo;.
<em>Journal of Quality Technology</em>, <b>42</b>, pp. 373&ndash;387,
<a href="https://doi.org/10.1080/00224065.2010.11917834">doi:10.1080/00224065.2010.11917834</a>
</p>
<p>C. Li, A. Mukherjee, Q. Su (2019) 
&ldquo;A distribution-free Phase I monitoring scheme for subgroup location and 
scale based on the multi-sample Lepage statistic&rdquo;,
<em>Computers &amp; Industrial Engineering</em>, <b>129</b>, pp. 259&ndash;273,
<a href="https://doi.org/10.1016/j.cie.2019.01.013">doi:10.1016/j.cie.2019.01.013</a> 
</p>
<p>C. Li, A. Mukherjee, M. Marozzi (2020)
&ldquo;A new distribution-free Phase-I procedure for bi-aspect
monitoring based on the multi-sample Cucconi statistic&rdquo;,
<em>Computers &amp; Industrial Engineering</em>, <b>149</b>, 
<a href="https://doi.org/10.1016/j.cie.2020.106760">doi:10.1016/j.cie.2020.106760</a>   
</p>
<p>D. C. Montgomery (2009) <em>Introduction to Statistical Quality Control</em>, 6th edn. Wiley.
</p>
<p>P. Qiu (2013) <em>Introduction to Statistical Process Control</em>. Chapman &amp; Hall/CRC Press.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># A simulated example
set.seed(12345)
y &lt;- matrix(rt(100,3),5)
y[,20] &lt;- y[,20]+3
shewhart(y)
shewhart(y, stat="Rank")
shewhart(y, stat="Lepage")
shewhart(y, stat="Cucconi")
# Reproduction of the control chart shown
# by Jones-Farmer et. al. (2009)
data(colonscopy)
u &lt;- shewhart.normal.limits(NROW(colonscopy),NCOL(colonscopy), 
                            stat="lRank", FAP=0.1, L=10000)
# In Jones-Farmer et al. (2009) is estimated as 2.748
u
shewhart(colonscopy,stat="lRank",limits=u)
# Examples of control limits for comparisons
# with Li et al. (2019) and (2020) but
# using a limited number of Monte Carlo
# replications
# Lepage: in Li et al. (2019) is estimated as 11.539
shewhart.normal.limits(5, 25, stat="Lepage", L=10000)
# Cucconi: in Li et al. (2020) is estimated as 0.266
shewhart.normal.limits(5, 25, stat="Cucconi", L=10000)
</code></pre>

<hr>
<h2 id='Student'>A simulated dataset</h2><span id='topic+Student'></span>

<h3>Description</h3>

<p>This simulated data set consists in 50 subgroups, each with 5 observations,
on 4 variables.
</p>
<p>There is an isolated location shift involving
only the first variable at time <code class="reqn">t=10</code> and
a step shift, involving the third and fourth variables,
starting from <code class="reqn">t=31</code>. The in-control distribution
is Student's t with 3 degrees of freedom, zero mean
and such that <code class="reqn">cov(X_i,X_j)=0.8^{|i-j|}</code>.
</p>
<p>See the example for the exact code used to simulate the data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Student)</code></pre>


<h3>Format</h3>

<p>A 4x5x50 array.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Student)
mphase1(Student)
#
# Replication of the simulation
#
# Generation of the in-control observations
set.seed(1)
m &lt;- 50
n &lt;- 5
p &lt;- 4
df &lt;- 3
Sigma &lt;- outer(1:p,1:p,function(i,j) 0.8^abs(i-j))
Sigma
xnorm &lt;- crossprod(chol(Sigma),matrix(rnorm(p*n*m),p))
xchisq &lt;- sqrt(rchisq(n*m,df)/(df-2))
x &lt;- array(sweep(xnorm,2,xchisq,"/"),c(p,n,m))
# Then, we add an isolated shift at time 10
# (only for the first variable)
x[1,,10] &lt;- x[1,,10]+1
# and, a step shift starting at time 31
# (only for the third and fourth variable)
x[3:4,,31:50] &lt;- x[3:4,,31:50] + c(0.50,-0.25)
dimnames(x)&lt;-list(paste("X",1:4,sep=""),NULL,NULL)
identical(x,Student)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
