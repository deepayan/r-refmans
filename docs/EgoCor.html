<!DOCTYPE html><html><head><title>Help for package EgoCor</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {EgoCor}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#birth'><p>Spatially correlated birthweight data with artificial coordinates</p></a></li>
<li><a href='#coords.plot'><p>Scatterplot of spatial coordinates</p></a></li>
<li><a href='#distance.info'><p>Pairwise distances of spatial coordinates</p></a></li>
<li><a href='#par.uncertainty'><p>Semi-variogram model parameter uncertainty</p></a></li>
<li><a href='#vario.mod'><p>Semi-variogram model fitting</p></a></li>
<li><a href='#vario.reg.prep'><p>Adjustment for covariates before semi-variogram model fitting</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Simple Presentation of Estimated Exponential Semi-Variograms</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.0</td>
</tr>
<tr>
<td>Description:</td>
<td>User friendly interface based on the R package 'gstat' to fit
    exponential parametric models to empirical semi-variograms in order to
    model the spatial correlation structure of health data. Geo-located
    health outcomes of survey participants may be used to model spatial
    effects on health in an ego-centred approach.  The package contains a
    range of functions to help explore the spatial structure of the data
    as well as visualize the fit of exponential models for various
    metaparameter combinations with respect to the number of lag intervals
    and maximal distance.  Furthermore, the outcome of interest can be
    adjusted for covariates by fitting a linear regression in a
    preliminary step before the semi-variogram fitting process.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/julia-dyck/EgoCor">https://github.com/julia-dyck/EgoCor</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/julia-dyck/EgoCor/issues">https://github.com/julia-dyck/EgoCor/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, grDevices, gstat, Rdpack, shiny, sp, SpatialTools,
stats, methods, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, lme4</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>Rdpack</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-28 16:37:38 UTC; Julia</td>
</tr>
<tr>
<td>Author:</td>
<td>Julia Dyck [aut, cre],
  Odile Sauzet [aut],
  Jan-Ole Koslik [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Julia Dyck &lt;j.dyck@uni-bielefeld.de&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-28 18:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='birth'>Spatially correlated birthweight data with artificial coordinates</h2><span id='topic+birth'></span>

<h3>Description</h3>

<p>A simulated dataset containing geo-coded birthweight data with covariates.
It is provided for exemplary applications of the functions
within the EgoCor package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>birth
</code></pre>


<h3>Format</h3>

<p>A data frame with 903 rows and 8 variables:
</p>

<dl>
<dt>x</dt><dd><p>x-coordinate given in Cartesian format in meters,</p>
</dd>
<dt>y</dt><dd><p>y-coordinate given in Cartesian format in meters,</p>
</dd>
<dt>birthweight</dt><dd><p>weight of the child in gram,</p>
</dd>
<dt>primiparous</dt><dd><p>binary: 1 = first child birth, 0 = not the first child birth,</p>
</dd>
<dt>datediff</dt><dd><p>difference between due date and birth,</p>
</dd>
<dt>bmi</dt><dd><p>BMI (body mass index) of the mother at the beginning of pregnancy,</p>
</dd>
<dt>weight</dt><dd><p>weight of the mother in kg,</p>
</dd>
<dt>inc</dt><dd><p>income quintiles 0 (low), 1, 2, 3, 4 (high).</p>
</dd>
</dl>



<h3>Details</h3>

<p>The dataset is loosely based on the BaBi study dataset
referred to in Spallek et al. (2017). The spatial correlation structure
was already modeled using an exponential model in Sauzet et al. (2021).
</p>


<h3>References</h3>

<p>Sauzet O, Breiding JH, Zolitschka KA, Breckenkamp J, Razum O (2021).
&ldquo;An ego-centred approach for the evaluation of spatial effects on health in urban areas based on parametric semi-variogram models: concept and validation.&rdquo;
<em>BMC medical research methodology</em>, <b>21</b>(1), 1&ndash;12.<br /><br /> Spallek J, Grosser A, Höller-Holtrichter C, Doyle I, Breckenkamp J, Razum O (2017).
&ldquo;Early childhood health in Bielefeld, Germany (BaBi study): study protocol of a social-epidemiological birth cohort.&rdquo;
<em>BMJ Open</em>, <b>7</b>(8).
ISSN 2044-6055, <a href="https://doi.org/10.1136/bmjopen-2017-018398">doi:10.1136/bmjopen-2017-018398</a>, <a href="https://bmjopen.bmj.com/content/7/8/e018398">https://bmjopen.bmj.com/content/7/8/e018398</a>.
</p>

<hr>
<h2 id='coords.plot'>Scatterplot of spatial coordinates</h2><span id='topic+coords.plot'></span>

<h3>Description</h3>

<p>Plot of the Cartesian coordinates of study participant with color and shape coded
indication whether the variable of interest is observed at a specific location.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coords.plot(data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coords.plot_+3A_data">data</code></td>
<td>
<p>A data frame or matrix containing
the x-coordinates in meters in the first column,
the y-coordinates in meters in the second column,
and the values of the attribute of interest in the third column.
Additional columns are ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a plot showing the points based on Cartesian coordinates. A black circle indicates that the
variable of interest is observed at that location. A red cross flags a missing value.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Example 1
xcoords = rnorm(10, mean = 0, sd = 20)
ycoords = rnorm(10, mean = 0, sd = 20)
value = c(22, 31, 10, NA, NA, 18, 9, NA, 1, 34)
dataset = cbind(xcoords, ycoords, value)
coords.plot(dataset)

## Example 2
coords.plot(birth)

</code></pre>

<hr>
<h2 id='distance.info'>Pairwise distances of spatial coordinates</h2><span id='topic+distance.info'></span>

<h3>Description</h3>

<p>A range of descriptive statistics on the distribution of the pairwise distances between observations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>distance.info(data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="distance.info_+3A_data">data</code></td>
<td>
<p>A data frame or matrix containing the x-coordinates in the first column
and the y-coordinates in the second column.
Additional columns are ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr><td><code>distmatrix</code></td>
<td>
<p>A matrix containing the pairwise Euclidean distances between
all given locations.</p>
</td></tr>
<tr><td><code>distset</code></td>
<td>
<p>A vector containing the pairwise Euclidean distances.
The elements equal the upper (or lower) triangle minus the diagonal
of the distance matrix. If the input dataset has n rows, <code>distset</code> contains <code class="reqn">n(n-1)/2</code> distances.</p>
</td></tr>
<tr><td><code>distsummary</code></td>
<td>
<p>A summary containing the minimum, 1st quartile, median, mean,
3rd quartile and maximum of the <code>distset</code>.</p>
</td></tr>
<tr><td><code>maxdist</code></td>
<td>
<p>The maximal distance.</p>
</td></tr>
</table>
<p>Moreover, the function prints a histogram of the pairwise distances saved in the list entry <code>distset</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Example 1
x = c(1,3,7,10,15)
y = c(5,19,8,3,11)
z = rnorm(5, mean = 20, sd = 40)
dataset = as.data.frame(cbind(x,y,z))
distance.info(data = dataset)

## Example 2
distance.info(birth)


</code></pre>

<hr>
<h2 id='par.uncertainty'>Semi-variogram model parameter uncertainty</h2><span id='topic+par.uncertainty'></span>

<h3>Description</h3>

<p>Standard error estimates for the nugget effect <code class="reqn">c_0</code>,  partial sill <code class="reqn">\sigma_0^2</code> and
shape parameter <code class="reqn">\phi</code> of a fitted exponential semi-variogram model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>par.uncertainty(
  vario.mod.output,
  mod.nr,
  par.est = NULL,
  data = NULL,
  max.dist = NULL,
  nbins = NULL,
  B = 1000,
  threshold.factor = 3,
  fit.method = 7,
  mc.cores = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="par.uncertainty_+3A_vario.mod.output">vario.mod.output</code></td>
<td>
<p>An output of the <code>vario.mod</code> function containing the
information of the estimated exponential semi-variogram model of interest.</p>
</td></tr>
<tr><td><code id="par.uncertainty_+3A_mod.nr">mod.nr</code></td>
<td>
<p>The index number specifiying one of the exponential semi-variogram models
listed in the <code>vario.mod.ouput</code>.</p>
</td></tr>
<tr><td><code id="par.uncertainty_+3A_par.est">par.est</code></td>
<td>
<p>A vector of length three containing the estimated parameters:
the nugget effect, the partial sill and the shape parameter
of the estimated exponential semi-variogram model.
It is automatically extracted from the <code>vario.mod.output</code>, if provided.</p>
</td></tr>
<tr><td><code id="par.uncertainty_+3A_data">data</code></td>
<td>
<p>The data frame or matrix used to estimate the exponential semi-variogram of interest
containing the x-coordinates in meters in the first column,
the y-coordinates in meters in the second column and the data values in the third column.
It is automatically extracted from the vario.mod.output, if provided.</p>
</td></tr>
<tr><td><code id="par.uncertainty_+3A_max.dist">max.dist</code></td>
<td>
<p>The maximal distance used for the estimation of the
exponential semi-variogram model of interest.
It is automatically extracted from the vario.mod.output, if provided.</p>
</td></tr>
<tr><td><code id="par.uncertainty_+3A_nbins">nbins</code></td>
<td>
<p>The number of bins used for the estimation of the exponential
semi-variogram model of interest.
It is automatically extracted from the vario.mod.output, if provided.</p>
</td></tr>
<tr><td><code id="par.uncertainty_+3A_b">B</code></td>
<td>
<p>The number of bootstrap repetitions to generate a set of re-estimates
of each parameter.</p>
</td></tr>
<tr><td><code id="par.uncertainty_+3A_threshold.factor">threshold.factor</code></td>
<td>
<p>The threshold factor specifies the filter within the filtered
bootstrap method (see details). If not specified, a default value of 1.2 is used.</p>
</td></tr>
<tr><td><code id="par.uncertainty_+3A_fit.method">fit.method</code></td>
<td>
<p>The fit method used in the semivariogram estimation with the gstat package.</p>
</td></tr>
<tr><td><code id="par.uncertainty_+3A_mc.cores">mc.cores</code></td>
<td>
<p>The number of cores used for bootstrapping, utilizing the parallel R-package. More than one core is not supported on windows systems.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><strong>Two alternative approaches for the input of the arguments:</strong>
</p>
<p>1. Provide the arguments
vario.mod.output (output object from vario.mod function) and
mod.nr (number of the model in the infotable).
</p>
<p>2. Provide the necessary information manually, namely
<code>par.est</code> (vector with estimated nugget, partial sill and shape parameters),
<code>data</code> (used to estimate the semi-variogram model parameters),
<code>max.dist</code> (semi-variogram parameter, numeric of length 1) and
<code>nbins</code> (semi-variogram parameter, numeric of length 1).
</p>
<p><strong>Filtered bootstrap method</strong>:
</p>
<p>For the semi-variogram model parameter estimation, the weighted least squares method is used
in order to make the numerical calculation possible for large sample sizes.
A filter is set up within the bootstrapping process to remove all
bootstrap estimates for which the estimation algorithm for the semi-variogram
model parameters did not converge.
</p>
<p>The parameter standard errors are estimated using the generalized bootstrap
method with check-based filtering.
The semi-variogram structure from the given model is used to remove the
spatial correlation structure within the original dataset. Then,
classical bootstrap sampling with replacement is used to generate B
bootstrap samples from the uncorrelated data.
Each bootstrap sample inherits the correlation structure back and is used to estimate
the nugget effect, partial sill and shape parameter for an exponential model.
Within the bootstrap repetitions, a test is performed to check whether
the estimated parameters lie within a probable range.
If the total variance of the bootstrap model exceeds the empirical variance
of the data times the treshold factor <code class="reqn">\tau</code>, ie.
</p>
<p style="text-align: center;"><code class="reqn">c_{0 b}^* + \sigma_{0 b}^{2*} &gt; \tau  \widehat{Var(\mathbf{z})}</code>
</p>

<p>for the bth bootstrap estimate, it is discarded. Otherwise, it is saved.
This procedure is performed until B bootstrap estimates have aggregated.
The empirical standard deviation calculated from the bootstrap estimates provides the
uncertainty estimate for each parameter.
</p>
<p>Details about the algorithm used to obtain standard errors for the parameters
of the exponential semi-variogram model are provided in Dyck and Sauzet (2023).
</p>
<p><strong>Reproducibility</strong>:
</p>
<p>In order to generate reproducible bootstrap results, set a random seed with the command <code>set.seed()</code>
before using the <code>par.uncertainty</code> function.
</p>


<h3>Value</h3>

<p>The function returns parameter estimates and corresponding standard error estimates
together and provides a list with the following objects:
</p>
<table>
<tr><td><code>se</code></td>
<td>
<p>A vector of length 3 containing the estimated standard errors of the
nugget effect, the partial sill and the shape parameter.</p>
</td></tr>
<tr><td><code>unc.table</code></td>
<td>
<p>A matrix containing the parameter estimates and the corresponding standard errors.</p>
</td></tr>
<tr><td><code>re_estimates</code></td>
<td>
<p>A matrix with B rows containing the set of bootstrap re-estimates for each parameter.</p>
</td></tr>
<tr><td><code>re_estimate.mean</code></td>
<td>
<p>A vector containing the mean parameter estimates based on the set of bootstrap re-estimates for each parameter.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>The function call.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Dyck J, Sauzet O (2023).
&ldquo;Parameter uncertainty estimation for exponential semivariogram models: Two generalized bootstrap methods with check- and quantile-based filtering.&rdquo;
Preprint.
<a href="https://arxiv.org/abs/2202.05752">https://arxiv.org/abs/2202.05752</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Example 1
# Estimate semi-variogram models:
mods = vario.mod(data = birth, max.dist = c(1000,600), nbins = 13,
                 shinyresults = FALSE, windowplots = FALSE)
print(mods$infotable)

# Estimate the parameter standard errors:

se.mod1 = par.uncertainty(vario.mod.output = mods, mod.nr = 1, B = 1000)
se.mod2 = par.uncertainty(vario.mod.output = mods, mod.nr = 2, B = 1000)


## Example 2
# Type in the specifications of the estimated exponential semi-variogram manually:

se.mod1.man = par.uncertainty(par.est = c(1021.812, 225440.3, 0),
              data = birth, max.dist = 1000, nbins = 13, B = 1000)

se.mod2.man = par.uncertainty(par.est = c(121895.486, 107232.6, 63.68720),
              data = birth, max.dist = 600, nbins = 13, B = 1000)



</code></pre>

<hr>
<h2 id='vario.mod'>Semi-variogram model fitting</h2><span id='topic+vario.mod'></span>

<h3>Description</h3>

<p>The function allows for user friendly exponential semi-variogram model fitting to data.
Based on the <code>gstat</code> function <code>variogram</code>, <code>vgm</code> and <code>fit.variogram</code>, the function fits one
or multiple exponential semi-variogram models given one or multiple maximal distances and number of bins.
All estimated model parameters are summarized in an information table.
Graphics of all models can be observed in a shiny application output
or in several plot windows, one for each empirical semi-variogram.
Additionally, a pdf file including all the figures can be
saved in a specified working directory.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vario.mod(
  data,
  max.dist = c(2000, 1500, 1000, 750, 500, 250),
  nbins = 13,
  fit.method = 7,
  shinyresults = TRUE,
  windowplots = FALSE,
  pdf = FALSE,
  pdf.directory = getwd(),
  pdf.name = "Semivariograms"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vario.mod_+3A_data">data</code></td>
<td>
<p>A data frame or matrix containing the x-coordinates  in the first column,
the y-coordinates  in the second column (by default in meters)
and the data values in the third column.
The dataset may contain more attributes in further columns. In this case, a warning is provided.
All columns beyond the third one are ignored.</p>
</td></tr>
<tr><td><code id="vario.mod_+3A_max.dist">max.dist</code></td>
<td>
<p>An optional numeric argument; the default is the vector <code>c(2000,1500,1000,750,500,250)</code>.
Either a scalar or vector containing the maximal distances can be inserted. If a vector is
provided, the <code> nbins</code> argument must be either a scalar or a vector of the same length.</p>
</td></tr>
<tr><td><code id="vario.mod_+3A_nbins">nbins</code></td>
<td>
<p>An optional argument; the default is 13 bins for all empirical semi-variograms to be estimated.
Either a scalar or vector containing the number of bins can be inserted. If a vector is
provided, the <code>max.dist</code> argument must be either a scalar or a vector of the same length.</p>
</td></tr>
<tr><td><code id="vario.mod_+3A_fit.method">fit.method</code></td>
<td>
<p>An optional argument that specifies the fit method used by the gstat function fit.variogram to fit the semivariogram.
The default value ist 7. Only values 1,2,6,7 are possible. Please see the package description of gstat for more information.</p>
</td></tr>
<tr><td><code id="vario.mod_+3A_shinyresults">shinyresults</code></td>
<td>
<p>A logical argument; by default TRUE. If <code>shinyresults = T</code>,
the information table and graphics of
all estimated semi-variogram models can be observed in an automatically generated
shiny application.</p>
</td></tr>
<tr><td><code id="vario.mod_+3A_windowplots">windowplots</code></td>
<td>
<p>A logical argument; by default FALSE. If <code>windowplots = T</code>, all graphics are
opened in new windows. They can be observed and saved manually in a wished format.</p>
</td></tr>
<tr><td><code id="vario.mod_+3A_pdf">pdf</code></td>
<td>
<p>A logical argument; by default FALSE. If <code>pdf = T</code>, all graphics are saved in a pdf file.
The file path and the name of the pdf file can be specified by the following two arguments
<code>pdf.directory</code> and <code>pdf.name</code>.</p>
</td></tr>
<tr><td><code id="vario.mod_+3A_pdf.directory">pdf.directory</code></td>
<td>
<p>A character argument to specify the folder in which the pdf file is saved.
If no file path is given, the pdf file is saved in the current working directory identified
by <code>getwd()</code>.</p>
</td></tr>
<tr><td><code id="vario.mod_+3A_pdf.name">pdf.name</code></td>
<td>
<p>A character argument to specify the name of the pdf file. If no name is provided, the
file is saved as 'Semivariograms.pdf'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><strong>Prespecification and Interpretation of max.dist and nbins arguments:</strong>
</p>
<p><code>max.dist</code>:
only data pairs with a separation smaller than the prespecified maximal distance are included in the semi-variogram
estimation. Data pairs that are separated by a higher distance are excluded.
</p>
<p><code>nbins</code>: the interval (0, <code>max.dist</code>] is separated into <code>nbins</code> equidistant
lag bins or intervals, respectively. Each pairwise distance is then assigned to one of the
bins. The point pair subsets <code class="reqn">N(h_k) := \{(\mathbf{s_i}, \mathbf{s_j}) \in D |\;\; ||\mathbf{s_i}-\mathbf{s_j}|| \in Bin_k\}</code>
are defined
and a point estimate of the semi-variogram is estimated for each <code class="reqn">Bin_k</code> for <code class="reqn">k =1,...</code><code>nbins</code>.
</p>
<p><strong>Empirical semi-variogram estimator:</strong>
</p>
<p>Using the <code>gstat</code> function <code>variogram</code> an empirical semi-variogram according to
Matheron's semi-variogram estimator (Matheron 1962)
</p>
<p style="text-align: center;"><code class="reqn">\hat{\gamma}(h) = \frac{1}{2\cdot|N(h)|} \sum_{(\mathbf{s_i},
         \mathbf{s_j}) \in N(h)}\{Z(\mathbf{s_i})- Z(\mathbf{s_j})\}^2</code>
</p>

<p>with <code class="reqn">N(h)</code> defined as above is obtained.
</p>
<p><strong>Exponential semi-variogram model:</strong>
</p>
<p>Based on the empirical semi-variogram an exponential semi-variogram model of the form
(Cressie et al. 1993)
</p>
<p style="text-align: center;"><code class="reqn">\gamma_{exp}(h) =  c_0 + \sigma_0^2 \Big\{1 - \exp\big(- \frac{h}{\phi}\big)\Big\}</code>
</p>

<p>for <code class="reqn">h &gt; 0</code>
is fitted using the <code>vgm</code> and <code>fit.variogram</code> function from package <code>gstat</code> via
weighted least squares estimation. The weights have the form
<code class="reqn"> w_k = \vert N(h_k) \vert / h_k^2</code> specified by the <code>fit.method = 7</code> argument
within the <code>fit.variogram</code> function.
</p>
<p>For the numerical optimization, starting values for the model parameters have to be provided.
The initial value for the partial sill <code class="reqn">\sigma_0^2</code> equals the empirical variance of
the observations. The starting value for the nugget effect <code class="reqn">c_0</code> is set to zero.
The initial value for the shape parameter <code class="reqn">\phi</code> is set as <code>max.dist</code> divided by 3.
</p>
<p><strong>Result statistics:</strong>
</p>
<p>The results for all models are automatically printed when running the function and can be
found under <code>function.output$infotable</code>. Part of the table contains a repetition of the
specified <code>max.dist</code> and <code>nbins</code> parameters as well as the estimated model parameters.
The additional statistics within the infotable output are the following:
</p>
<p>Practical range: In case of the exponential semi-variogram model, the
sill <code class="reqn">\sigma^2 = c_0 + \sigma_0^2</code> is only reached asymptotically. The distance <code class="reqn">H</code>
at which <code class="reqn">\gamma(h^* = 0.95 \cdot \sigma^2)</code> is called the practical range.
Formally, the practical range is
defined as
</p>
<p style="text-align: center;"><code class="reqn">prac.range = \phi ln\Big( \frac{\sigma_0^2}{0.05(c_0 + \sigma_0^2)} \Big).</code>
</p>

<p>Relative Structural Variability (RSV): The relative structural variability is a measure of
the proportion of the total variance with a spatial structure and
defined as
</p>
<p style="text-align: center;"><code class="reqn">RSV = \frac{\sigma_0^2}{c_0 + \sigma_0^2}.</code>
</p>

<p>Relative Bias: The relative bias describes the proportion of the total variance according
to the semi-variogram model to the true total variance. It is estimated as
</p>
<p style="text-align: center;"><code class="reqn">rel. bias = \frac{c_0 + \sigma_0^2}{\widehat{Var(Z)}},</code>
</p>

<p>where <code class="reqn">\widehat{Var(Z)}</code> is the sample variance or empirical variance of the attribute of
interest of the dataset at hand.
A relative bias of 1 indicates equality of
sample variance and variance according to the semi-variogram model.
</p>
<p>For more details, see Schabenberger and Gotway (2017).
</p>


<h3>Value</h3>

<p>A list containing the following arguments:
</p>
<table>
<tr><td><code>infotable</code></td>
<td>
<p>A table containing the statistics of all estimated exponential semi-variogram models.
Each row corresponds to one model.
Shown are the prespecified <code>max.dist</code> and <code>nbins</code> values, the parameter estimates for the nugget effect, partial
sill and shape, the resulting estimated practical range,
the relative structured variability (RSV) and the relative bias.</p>
</td></tr>
<tr><td><code>variog.list</code></td>
<td>
<p>A list: each list entry contains the <code>variog</code> output with further information
on the estimated empirical semi-variogram.</p>
</td></tr>
<tr><td><code>vmod.list</code></td>
<td>
<p>A list: each list entry contains the <code>variofit</code> output with further information
on the fitted parametric semi-variogram model.</p>
</td></tr>
<tr><td><code>input.arguments</code></td>
<td>
<p>A list containing the evaluated input arguments, namely the <code>$data</code> used to fit the
exponential semi-variogram, the <code>$max.dist</code> and <code>$nbins</code> specifications and the
specifications for the pdf-output, <code>$pdf</code>, <code>$pdf.directory</code> and <code>$pdf.name</code>.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>Contains the call of the function.</p>
</td></tr>
</table>
<p>The models are visualized in an automatically opened shiny application if <code>shinyresults = T</code>. Beware
that in this case the output of the <code>vario.mod</code> function is not saved in the environment, even with a variable name assigned.
In order to save the output, set <code>shinyresults = F</code>.
</p>
<p>If the argument <code>windowplots = T</code>, one or multiple graphics of the estimated
empirical semi-variograms and semi-variogram models are plotted in the R environment.
If the argument <code>pdf = T</code>, a pdf file containing the same figures is saved in the manually
specified or current working directory.
</p>


<h3>References</h3>

<p>Cressie N, Ribeiro PJ, Diggle PJ (1993).
<em>Statistics for spatial data</em>, Rev. ed. edition.
Wiley, New York.
ISBN 9781119115151.<br /><br /> Matheron G (1962).
<em>Traité de géostatistique appliquée. 1 (1962)</em>, volume 1.
Editions Technip.<br /><br /> Schabenberger O, Gotway CA (2017).
<em>Statistical methods for spatial data analysis</em>.
CRC press.
</p>


<h3>See Also</h3>

<p><code>variogram</code> in the <code>gstat</code> package for further information on
the estimation of the empirical semi-variogram;
</p>
<p><code>fit.variogram</code> and <code>vgm</code> in the <code>gstat</code> package for further information on the default settings
when fitting an exponential semi-variogram model to an empirical semi-variogram.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if(interactive()){

## Example 1
# Default options:
vario.mod(data = birth)

# This is equal to
vario.mod(data = birth, max.dist = c(2000,1500,1000,750,500,250), nbins = 13,
          shinyresults = TRUE, windowplots = FALSE,
          pdf = FALSE, pdf.directory = getwd(), pdf.name = "Semivariograms")

## Example 2
# Open graphics in regular windows and not in shiny application:
vario.mod(data = birth, max.dist = c(2000,1500,1000,750,500,250), nbins = 15:10,
          shinyresults = FALSE, windowplots = TRUE)

## Example 3
# Generate a pdf with the following command:
vario.mod(data = birth, shinyresults = FALSE, windowplots = FALSE,
          pdf = TRUE, pdf.directory = getwd())
# You find a pdf file in your current working directory.

}


</code></pre>

<hr>
<h2 id='vario.reg.prep'>Adjustment for covariates before semi-variogram model fitting</h2><span id='topic+vario.reg.prep'></span>

<h3>Description</h3>

<p>Adjustment for covariates provides the option to eliminate non-spatial effects
on the variable of interest.
Given a linear regression output of class 'lm' or 'lmerMod'
with the attribute of interest as dependent variable,
the function provides a dataset containing the coordinates of the original observations
and the studentized residuals of the regression model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vario.reg.prep(reg, data = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vario.reg.prep_+3A_reg">reg</code></td>
<td>
<p>An object of class 'lm' obtained as result of a linear regression using the function
<code>lm</code> from the package <code>stats</code> or an object of class 'lmerMod' obtained as
result of a linear mixed model regression using the function
<code>lmer</code> from the package <code>lme4</code>.</p>
</td></tr>
<tr><td><code id="vario.reg.prep_+3A_data">data</code></td>
<td>
<p>Only needed if the data argument within the regression function <code>lm</code>/<code>lmer</code> is not provided:
A data frame containing the geo-coded dataset containing
the Cartesian x- and y-coordinates in the first and second column,
the outcome of interest in the third column and
all covariates used for the regression in further columns.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The adjusted outcome is defined as the student residuals
of the linear or linear mixed regression model. They are calculated using the <code>rstudent</code> function
from package <code>stats</code>.
In case of a mixed model, the adjusted variable vector resembles the conditional studentized residuals.
</p>
<p>The geo-coded dataset used for the regression is extracted from the current environment. In order to work,
the dataset has to be loaded into the environment prior to the use of <code>vario.reg.prep</code>.
</p>
<p>If the data argument was specified within the regression function <code>lm/lmer</code>,
<code>vario.reg.prep</code> automatically extracts the name of the dataset used for regression and calls
it from the current environment.
Otherwise, the dataset has to be provided manually as input argument within <code>vario.reg.prep</code>.
</p>


<h3>Value</h3>

<p>A data frame with three columns:
</p>
<table>
<tr><td><code>x</code></td>
<td>
<p>x-coordinate in the first column.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>y-coordinate in the second column.</p>
</td></tr>
<tr><td><code>adj</code></td>
<td>
<p>Studentized residuals to be used as new variable adjusted for covariates.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code>lm</code> in the <code>stats</code> package for information on the fitting of a linear regression model;
</p>
<p><code>lmer</code> in the <code>lme4</code> package for information on the fitting of a linear mixed regression model;
</p>
<p><code>rstudent</code> in the <code>stats</code> package for information on how the attribute of interest is
adjusted for covariates.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Example 1
head(birth) #geo-coded dataset
hist(birth$birthweight) # attribute of interest

# Linear regression model
mod1 = lm(birthweight ~ primiparous + datediff + bmi
+ inc, data = birth)
summary(mod1)
data.adj1 = vario.reg.prep(mod1)

head(data.adj1)
hist(data.adj1$adj) # adjusted attribute of interest
# The data frame can be used as input for the vario.mod function.


## Example 2
# No data argument provided within lm (not recommended, but possible):
mod2 = lm(birth$birthweight ~ birth$primiparous + birth$datediff + birth$bmi
+ birth$inc)
summary(mod2)
# In this case, make sure to provide the data argument here:
data.adj2 = vario.reg.prep(reg = mod2, data = birth)


if (requireNamespace("lme4", quietly = TRUE)) {
## Example 3
# Linear mixed regression model
mod3 = lme4::lmer(birthweight ~ primiparous + datediff
                + bmi + (1|inc), data = birth)
summary(mod3)
data.adj3 = vario.reg.prep(mod3)


## Example 4
# Data argument within lmer not provided (not recommended, but possible):
mod4 = lme4::lmer(birth$birthweight ~ birth$primiparous + birth$datediff
            + birth$bmi + (1|birth$inc))
summary(mod4)
# In this case, make sure to provide the data argument here:
data.adj4 = vario.reg.prep(reg = mod4, data = birth)
}

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
