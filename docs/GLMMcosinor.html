<!DOCTYPE html><html><head><title>Help for package GLMMcosinor</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {GLMMcosinor}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#GLMMcosinor-package'><p>GLMMcosinor: A package for fitting generalized linear mixed-effects</p>
models with cosinor terms</a></li>
<li><a href='#amp_acro'><p>Used to specify a cosinor component in the model formula.</p></a></li>
<li><a href='#autoplot.cglmm'><p>Plot a cosinor model</p></a></li>
<li><a href='#cglmm'><p>Fit cosinor model with <code>{glmmTMB}</code></p></a></li>
<li><a href='#cosinor_mixed'><p>cosinor_mixed dataset for cosinor modelling examples.</p></a></li>
<li><a href='#fit_model_and_process'><p>Fit the cosinor GLMM model using the output from</p>
<code>update_formula_and_data()</code> and a new formula</a></li>
<li><a href='#polar_plot'><p>Generates a polar plot with elliptical confidence intervals</p></a></li>
<li><a href='#polar_plot.cglmm'><p>Generates a polar plot with elliptical confidence intervals</p></a></li>
<li><a href='#predict.cglmm'><p>Predict from a cosinor model</p></a></li>
<li><a href='#print.cglmm'><p>Print a brief summary of the <code>cglmm</code> model.</p></a></li>
<li><a href='#print.cglmmSubTest'><p>Print test of model</p></a></li>
<li><a href='#print.cglmmSummary'><p>Print the summary of a cosinor model</p></a></li>
<li><a href='#print.cglmmTest'><p>Print results of test of cosinor model</p></a></li>
<li><a href='#reexports'><p>Objects exported from other packages</p></a></li>
<li><a href='#sigma.cglmm'><p>Extract residual standard deviation or dispersion parameter</p></a></li>
<li><a href='#simulate_cosinor'><p>Simulate data from a cosinor model</p></a></li>
<li><a href='#summary.cglmm'><p>Summarize a cosinor model</p>
Given a time variable and optional covariates, generate inference a cosinor
fit. Gives estimates, confidence intervals, and tests for the raw parameters,
and for the mean, amplitude, and acrophase parameters. If the model includes
covariates, the function returns the estimates of the mean, amplitude, and
acrophase for the group with covariates equal to 1 and equal to 0. This may
not be the desired result for continuous covariates.</a></li>
<li><a href='#test_cosinor_components'><p>Test for differences in a cosinor model between components.</p></a></li>
<li><a href='#test_cosinor_levels'><p>Test for differences in a cosinor model between levels of the grouping</p>
variable.</a></li>
<li><a href='#update_formula_and_data'><p>Update data and formula for fitting cglmm model</p></a></li>
<li><a href='#vitamind'><p>Vitamin D dataset for cosinor modelling examples.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Fit a Cosinor Model Using a Generalised Mixed Modelling
Framework</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Allows users to fit a cosinor model using the 'glmmTMB' framework. 
    This extends on existing cosinor modelling packages, including 'cosinor' 
    and 'circacompare', by including a wide range of available link functions 
    and the capability to fit mixed models. The cosinor model is described by 
    Cornelissen (2014) &lt;<a href="https://doi.org/10.1186%2F1742-4682-11-16">doi:10.1186/1742-4682-11-16</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/ropensci/GLMMcosinor">https://github.com/ropensci/GLMMcosinor</a>,
<a href="https://ropensci.github.io/GLMMcosinor/">https://ropensci.github.io/GLMMcosinor/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/ropensci/GLMMcosinor/issues">https://github.com/ropensci/GLMMcosinor/issues</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>assertthat, cowplot, ggforce, ggplot2, glmmTMB, lme4, rlang,
scales, stats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>cosinor, covr, DHARMa, dplyr, DT, flextable, ftExtra, knitr,
rmarkdown, testthat (&ge; 3.0.0), vdiffr, withr</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-10 19:36:44 UTC; n10891277</td>
</tr>
<tr>
<td>Author:</td>
<td>Rex Parsons <a href="https://orcid.org/0000-0002-6053-8174"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre],
  Oliver Jayasinghe [aut],
  Nicole White <a href="https://orcid.org/0000-0002-9292-0773"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Oliver Rawashdeh <a href="https://orcid.org/0000-0002-7147-4778"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, fnd],
  Prasad Chunduri <a href="https://orcid.org/0000-0001-7297-7580"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb, fnd],
  Michael Sachs <a href="https://orcid.org/0000-0002-1279-8676"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [rev],
  Joaquin Cavieres <a href="https://orcid.org/0000-0001-8443-572X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [rev]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Rex Parsons &lt;rex.parsons94@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-11 10:40:10 UTC</td>
</tr>
</table>
<hr>
<h2 id='GLMMcosinor-package'>GLMMcosinor: A package for fitting generalized linear mixed-effects
models with cosinor terms</h2><span id='topic+GLMMcosinor'></span><span id='topic+GLMMcosinor-package'></span>

<h3>Description</h3>

<p>To learn more about how to use GLMMcosinor, see the vignettes at the
<a href="https://ropensci.github.io/GLMMcosinor/">website</a> or using
the following code:
</p>
<p><code>browseVignettes(package = "GLMMcosinor")</code>
</p>
<p>This package provides functions for fitting generalized linear mixed-effects
models with cosinor terms. Cosinor terms can be used to model periodic
variations in time series data, and are particularly useful in chronobiology
and sleep research. The package uses the flexible glmmTMB framework that
allows users to specify a wide range of data families, and provides tools
for visualization.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Rex Parsons <a href="mailto:rex.parsons94@gmail.com">rex.parsons94@gmail.com</a> (<a href="https://orcid.org/0000-0002-6053-8174">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Oliver Jayasinghe
</p>
</li>
<li><p> Nicole White (<a href="https://orcid.org/0000-0002-9292-0773">ORCID</a>)
</p>
</li>
<li><p> Oliver Rawashdeh (<a href="https://orcid.org/0000-0002-7147-4778">ORCID</a>) [funder]
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Prasad Chunduri (<a href="https://orcid.org/0000-0001-7297-7580">ORCID</a>) [contributor, funder]
</p>
</li>
<li><p> Michael Sachs (<a href="https://orcid.org/0000-0002-1279-8676">ORCID</a>) [reviewer]
</p>
</li>
<li><p> Joaquin Cavieres (<a href="https://orcid.org/0000-0001-8443-572X">ORCID</a>) [reviewer]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/ropensci/GLMMcosinor">https://github.com/ropensci/GLMMcosinor</a>
</p>
</li>
<li> <p><a href="https://ropensci.github.io/GLMMcosinor/">https://ropensci.github.io/GLMMcosinor/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/ropensci/GLMMcosinor/issues">https://github.com/ropensci/GLMMcosinor/issues</a>
</p>
</li></ul>


<hr>
<h2 id='amp_acro'>Used to specify a cosinor component in the model formula.</h2><span id='topic+amp_acro'></span>

<h3>Description</h3>

<p>Checks the validity of user inputs before creating an updated formula
and associated modifications to the <code>data.frame</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>amp_acro(time_col, n_components = 1, group, period, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="amp_acro_+3A_time_col">time_col</code></td>
<td>
<p>A  <code>numeric</code> column within the <code>data.frame()</code>
passed by via the <code>data</code> arg containing the time values.</p>
</td></tr>
<tr><td><code id="amp_acro_+3A_n_components">n_components</code></td>
<td>
<p>The Number of cosinor components in the model.</p>
</td></tr>
<tr><td><code id="amp_acro_+3A_group">group</code></td>
<td>
<p>A vector of the names for the group factors (column names
within the <code>data.frame()</code> passed by via the <code>data</code> arg).</p>
</td></tr>
<tr><td><code id="amp_acro_+3A_period">period</code></td>
<td>
<p>A <code>numeric</code> value or vector containing the period.
The number of values should be equal to <code>n_components</code>.</p>
</td></tr>
<tr><td><code id="amp_acro_+3A_...">...</code></td>
<td>
<p>Extra arguments for use within <code>GLMMcosinor</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.frame</code> and <code>formula</code> appropriate for use by
<code>data_processor()</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Single component cosinor model
cglmm(
  vit_d ~ amp_acro(time_col = time, group = "X", period = 12),
  data = vitamind
)

# 2-component cosinor model with simulated data
sim_data &lt;- simulate_cosinor(
  n = 500,
  mesor = 5,
  amp = c(2, 1),
  acro = c(1, 1.5),
  beta.mesor = 2,
  beta.amp = c(2, 1),
  beta.acro = c(1, 1.5),
  family = "gaussian",
  period = c(12, 6),
  n_components = 2,
  beta.group = TRUE,
)

cglmm(
  Y ~ group + amp_acro(times,
    n_components = 2,
    group = "group",
    period = c(12, 6)
  ),
  data = sim_data,
  family = gaussian
)
</code></pre>

<hr>
<h2 id='autoplot.cglmm'>Plot a cosinor model</h2><span id='topic+autoplot.cglmm'></span>

<h3>Description</h3>

<p>Given a cglmm model fit, generate a plot of the data with the fitted
values.
Optionally allows for plotting by covariates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cglmm'
autoplot(
  object,
  ci_level = 0.95,
  x_str,
  type = "response",
  xlims,
  pred.length.out,
  points_per_min_cycle_length = 20,
  superimpose.data = FALSE,
  data_opacity = 0.3,
  predict.ribbon = TRUE,
  ranef_plot = NULL,
  cov_list = NULL,
  quietly = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="autoplot.cglmm_+3A_object">object</code></td>
<td>
<p>An <code>cglmm</code> object.</p>
</td></tr>
<tr><td><code id="autoplot.cglmm_+3A_ci_level">ci_level</code></td>
<td>
<p>The level for calculated confidence intervals. Defaults to
<code>0.95</code>.</p>
</td></tr>
<tr><td><code id="autoplot.cglmm_+3A_x_str">x_str</code></td>
<td>
<p>A <code>character</code> vector naming variable(s) to be plotted.
Default has no value and plots all groups.</p>
</td></tr>
<tr><td><code id="autoplot.cglmm_+3A_type">type</code></td>
<td>
<p>A <code>character</code> that will be passed as an argument to
<code>predict.cglmm()</code>, specifying the type of prediction
(e.g, &quot;response&quot;, or &quot;link&quot;). See <code>?glmmTMB::predict.glmmTMB</code> for full
list of possible inputs.</p>
</td></tr>
<tr><td><code id="autoplot.cglmm_+3A_xlims">xlims</code></td>
<td>
<p>A vector of length two containing the limits for the x-axis.</p>
</td></tr>
<tr><td><code id="autoplot.cglmm_+3A_pred.length.out">pred.length.out</code></td>
<td>
<p>An integer value that specifies the number of
predicted data points. The larger the value, the more smooth the fitted line
will appear. If missing, uses <code>points_per_min_cycle_length</code> to generate
a sensible default value.</p>
</td></tr>
<tr><td><code id="autoplot.cglmm_+3A_points_per_min_cycle_length">points_per_min_cycle_length</code></td>
<td>
<p>Used to determine the number of samples
to create plot if <code>pred.length.out</code> is missing.</p>
</td></tr>
<tr><td><code id="autoplot.cglmm_+3A_superimpose.data">superimpose.data</code></td>
<td>
<p>A <code>logical</code>. If <code>TRUE</code>, data from the
original data used to fit the model (<code>object</code>) will be superimposed
over the predicted fit.</p>
</td></tr>
<tr><td><code id="autoplot.cglmm_+3A_data_opacity">data_opacity</code></td>
<td>
<p>A number between 0 and 1 inclusive that controls the
opacity of the superimposed data. (Used as the <code>alpha</code> when calling
<code>ggplot2::geom_point()</code>).</p>
</td></tr>
<tr><td><code id="autoplot.cglmm_+3A_predict.ribbon">predict.ribbon</code></td>
<td>
<p>A <code>logical</code>. If <code>TRUE</code>, a prediction interval
is plotted.</p>
</td></tr>
<tr><td><code id="autoplot.cglmm_+3A_ranef_plot">ranef_plot</code></td>
<td>
<p>Specify the random effects variables that you wish to plot.
If not specified, only the fixed effects will be visualised.</p>
</td></tr>
<tr><td><code id="autoplot.cglmm_+3A_cov_list">cov_list</code></td>
<td>
<p>Specify the levels of the covariates that you wish to plot as
a list. For example, if you have two covariates: var1, and var 2, you could
fix the level to be plotted as such <code>cov_list = list(var1 = 'a', var2 = 1)</code>,
where 'a' is a level in 'var1', and 1 is a level in 'var2'. See the examples
for a demonstration.
If not specified, the reference level of the covariate(s) will be used.
<code>points_per_min_cycle_length</code> is the number of points plotted per the
minimum cycle length (period) of all cosinor components in the model.</p>
</td></tr>
<tr><td><code id="autoplot.cglmm_+3A_quietly">quietly</code></td>
<td>
<p>A <code>logical</code>. If <code>TRUE</code>, shows warning messages when
wrangling data and fitting model. Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="autoplot.cglmm_+3A_...">...</code></td>
<td>
<p>Additional, ignored arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a <code>ggplot</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># A simple model
model &lt;- cglmm(
  vit_d ~ X + amp_acro(time, group = "X", period = 12),
  data = vitamind
)
autoplot(model, x_str = "X")


# Plotting a model with various covariates
test_data &lt;- vitamind[vitamind$X == 1, ]
test_data$var1 &lt;- sample(c("a", "b", "c"), size = nrow(test_data), replace = TRUE)
test_data$var2 &lt;- rnorm(n = nrow(test_data))

object &lt;- cglmm(
  vit_d ~ amp_acro(time, period = 12) + var1 + var2,
  data = test_data
)
autoplot(object,
  cov_list = list(
    var1 = "a",
    var2 = 1
  ),
  superimpose.data = TRUE
)
</code></pre>

<hr>
<h2 id='cglmm'>Fit cosinor model with <code>{glmmTMB}</code></h2><span id='topic+cglmm'></span>

<h3>Description</h3>

<p>Given an outcome and time variable, fit the cosinor model with optional
covariate effects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cglmm(
  formula,
  data,
  family = stats::gaussian(),
  quietly = TRUE,
  dispformula = ~1,
  ziformula = ~0,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cglmm_+3A_formula">formula</code></td>
<td>
<p>A <code>formula</code> specifying the cosinor model to be fit.
The cosinor portion of the formula is controlled by including
<code>amp_acro()</code> on the right hand side of the formula.
See <code><a href="#topic+amp_acro">amp_acro</a></code> for more details.</p>
</td></tr>
<tr><td><code id="cglmm_+3A_data">data</code></td>
<td>
<p>A <code>data.frame</code> containing the variables used in the model.</p>
</td></tr>
<tr><td><code id="cglmm_+3A_family">family</code></td>
<td>
<p>A <code>family</code> function or a character string naming a family
function. See <code>?family</code> and <code>?glmmTMB::family_glmmTMB</code> for options.</p>
</td></tr>
<tr><td><code id="cglmm_+3A_quietly">quietly</code></td>
<td>
<p>A <code>logical</code>. If <code>TRUE</code>, shows warning messages when
wrangling data and fitting model. Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="cglmm_+3A_dispformula">dispformula</code></td>
<td>
<p>A one-sided (i.e., no response variable) <code>formula</code>
for dispersion combining fixed and random effects, including cosinor
components using <code>amp_acro()</code>. Defaults to <code>~1</code>.</p>
</td></tr>
<tr><td><code id="cglmm_+3A_ziformula">ziformula</code></td>
<td>
<p>A one-sided (i.e., no response variable) <code>formula</code>
for zero-inflation combining fixed and random effects, including cosinor
components using <code>amp_acro()</code>. Defaults to <code>~0</code>.</p>
</td></tr>
<tr><td><code id="cglmm_+3A_...">...</code></td>
<td>
<p>Optional additional arguments passed to <code>glmmTMB::glmmTMB()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a fitted cosinor model as a <code>cglmm</code> object.
</p>


<h3>References</h3>

<p>Tong, YL. Parameter Estimation in Studying Circadian
Rhythms, Biometrics (1976). 32(1):85&ndash;94.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Single component cosinor model
cglmm(
  vit_d ~ amp_acro(time_col = time, group = "X", period = 12),
  data = vitamind
)

# 2-component cosinor model with simulated data
sim_data &lt;- simulate_cosinor(
  n = 500,
  mesor = 5,
  amp = c(2, 1),
  acro = c(1, 1.5),
  beta.mesor = 2,
  beta.amp = c(2, 1),
  beta.acro = c(1, 1.5),
  family = "gaussian",
  period = c(12, 6),
  n_components = 2,
  beta.group = TRUE,
)

cglmm(
  Y ~ group + amp_acro(times,
    n_components = 2,
    group = "group",
    period = c(12, 6)
  ),
  data = sim_data,
  family = gaussian
)
</code></pre>

<hr>
<h2 id='cosinor_mixed'>cosinor_mixed dataset for cosinor modelling examples.</h2><span id='topic+cosinor_mixed'></span>

<h3>Description</h3>

<p>Simulated data set to illustrate a mixed cosinor model. The <code>Y</code> column
contains a simulated outcome variable that varies over the time variable
(<code>times</code>). The <code>subject</code> column is a grouping variable that can be
used as a random effect. The rhythm has a period of 24 hours. Data was
simulated using <code>simulate_cosinor</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cosinor_mixed
</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> with 3 variables: <code>Y</code>, <code>times</code>, and
<code>subject</code>.
</p>

<hr>
<h2 id='fit_model_and_process'>Fit the cosinor GLMM model using the output from
<code>update_formula_and_data()</code> and a new formula</h2><span id='topic+fit_model_and_process'></span>

<h3>Description</h3>

<p>Fit the cosinor GLMM model using the output from
<code>update_formula_and_data()</code> and a new formula
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_model_and_process(obj, formula, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_model_and_process_+3A_obj">obj</code></td>
<td>
<p>Output from <code>update_formula_and_data()</code>.</p>
</td></tr>
<tr><td><code id="fit_model_and_process_+3A_formula">formula</code></td>
<td>
<p>A (optionally) new formula to use when fitting the cosinor
model (maybe with random effects) or other covariates found in the data.</p>
</td></tr>
<tr><td><code id="fit_model_and_process_+3A_...">...</code></td>
<td>
<p>Optional additional arguments passed to <code>glmmTMB::glmmTMB()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a fitted cosinor model as a <code>cglmm</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Use vitamind data but add a "patient" identifier used as a random effect
vitamind2 &lt;- vitamind
vitamind2$patient &lt;- sample(
  LETTERS[1:5],
  size = nrow(vitamind2), replace = TRUE
)

# Use update_formula_and_data() to perform wrangling steps of cglmm()
# without yet fitting the model
data_and_formula &lt;- update_formula_and_data(
  data = vitamind2,
  formula = vit_d ~ X + amp_acro(time,
    group = "X",
    period = 12
  )
)

# print formula from above
data_and_formula$newformula

# fit model while adding random effect to cosinor model formula.
mod &lt;- fit_model_and_process(
  obj = data_and_formula,
  formula = update.formula(
    data_and_formula$newformula, . ~ . + (1 | patient)
  )
)

mod
mod$fit # printing the `glmmTMB` model within shows Std.Dev. of random effect
</code></pre>

<hr>
<h2 id='polar_plot'>Generates a polar plot with elliptical confidence intervals</h2><span id='topic+polar_plot'></span>

<h3>Description</h3>

<p>Generates a polar plot with elliptical confidence intervals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>polar_plot(
  x,
  ci_level = 0.95,
  n_breaks = 5,
  component_index = NULL,
  grid_angle_segments = 8,
  radial_units = c("radians", "degrees", "period"),
  clockwise = FALSE,
  text_size = 3,
  text_opacity = 0.5,
  fill_colours,
  ellipse_opacity = 0.3,
  circle_linetype = "dotted",
  start = c("right", "left", "top", "bottom"),
  view = c("full", "zoom", "zoom_origin"),
  overlay_parameter_info = FALSE,
  quietly = TRUE,
  show_component_labels = TRUE,
  xlims,
  ylims,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="polar_plot_+3A_x">x</code></td>
<td>
<p>An object of class <code>cglmm</code></p>
</td></tr>
<tr><td><code id="polar_plot_+3A_ci_level">ci_level</code></td>
<td>
<p>The level for calculated confidence ellipses.
Defaults to 0.95.</p>
</td></tr>
<tr><td><code id="polar_plot_+3A_n_breaks">n_breaks</code></td>
<td>
<p>The number of concentric circles that will be plotted using
the <code>scales::breaks_pretty()</code> function. By default, 5 breaks will be
used. The number of breaks may be adjusted to result in an even interval.
For example, if n_breaks is 3, but the maximum plot radius is 8, instead of
plotting circles in intervals in 1.6, this interval will be rounded to 2
to result in the sequence: 0, 2, 4, 6, 8. See <code>?scales::breaks_pretty</code>
for more details.</p>
</td></tr>
<tr><td><code id="polar_plot_+3A_component_index">component_index</code></td>
<td>
<p>A number that corresponds to a particular component
from the <code>cglmm()</code> object that will be used to create polar plot.
If missing (default), then plots for all components will be arranged in the
returned plot. If a single or multiple values are provided, then these
components will be returned. (for example <code>component_index = 1</code>,
<code>component_index = c(1, 3)</code>).</p>
</td></tr>
<tr><td><code id="polar_plot_+3A_grid_angle_segments">grid_angle_segments</code></td>
<td>
<p>An <code>integer</code>. Determines the total number of
segments in the background of the polar plot. For example, a value of 4 will
create quadrants around the origin. Defaults to 8.</p>
</td></tr>
<tr><td><code id="polar_plot_+3A_radial_units">radial_units</code></td>
<td>
<p>A <code>character</code> specifying the angular units of the
plot. Possible values are one of <code>c('radians', 'degrees', 'period')</code>.
These units relate to the period of the component being visualised.
</p>

<dl>
<dt><code>'radians'</code>: <code class="reqn">[0, 2\pi]</code></dt><dd></dd>
<dt><code>'degrees'</code>: <code class="reqn">[0, 360]</code></dt><dd></dd>
<dt><code>'period'</code>: <code class="reqn">[0, period]</code></dt><dd></dd>
</dl>
</td></tr>
<tr><td><code id="polar_plot_+3A_clockwise">clockwise</code></td>
<td>
<p>A <code>logical</code>. If <code>TRUE</code>, the angles increase in a
clockwise fashion. If <code>FALSE</code>, anti-clockwise. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="polar_plot_+3A_text_size">text_size</code></td>
<td>
<p>A number controlling the font size of the text labels.
Defaults to 3.</p>
</td></tr>
<tr><td><code id="polar_plot_+3A_text_opacity">text_opacity</code></td>
<td>
<p>A <code>numeric</code> between 0 and 1 inclusive that
controls the opacity of the text labels.</p>
</td></tr>
<tr><td><code id="polar_plot_+3A_fill_colours">fill_colours</code></td>
<td>
<p>A <code>character</code> vector containing colours that will
be mapped to levels within a group. If the model has components with
different number of levels per factor, the length of this input should match
the greatest number of levels. If not, or if the number of levels exceeds the
length of the default argument (8), colours are generated using
<code>rainbow()</code>.</p>
</td></tr>
<tr><td><code id="polar_plot_+3A_ellipse_opacity">ellipse_opacity</code></td>
<td>
<p>A <code>numeric</code> between 0 and 1 inclusive that
controls the opacity of the confidence ellipses. Defaults to 0.3.</p>
</td></tr>
<tr><td><code id="polar_plot_+3A_circle_linetype">circle_linetype</code></td>
<td>
<p>A <code>character</code> or <code>numeric</code> that determines
the <code>linetype</code> of the radial circles in background of the polar plot.
See <code>?linetype</code>
for more details.</p>
</td></tr>
<tr><td><code id="polar_plot_+3A_start">start</code></td>
<td>
<p>A <code>character</code>, within
<code>c("right", "left", "top", "bottom")</code> that determines where angle 0 is
located. If <code>start = "top"</code>, and <code>clockwise = TRUE</code>, the angle
will rotate clockwise, starting at the '12 o-clock' position on a clock.</p>
</td></tr>
<tr><td><code id="polar_plot_+3A_view">view</code></td>
<td>
<p>A <code>character</code>, within
<code>c("full", "zoom", "zoom_origin")</code> that controls the view of the plots.
</p>

<dl>
<dt><code>'full'</code>: maintains a full view of the polar plot, including
the background radial circles.</dt><dd></dd>
<dt><code>'zoom'</code>: finds the minimum view window which contains all
confidence ellipses.</dt><dd></dd>
<dt><code>'zoom_origin'</code>: zooms into the confidence ellipses (like
&quot;zoom&quot;), but also keeps the origin within frame.</dt><dd></dd>
</dl>
</td></tr>
<tr><td><code id="polar_plot_+3A_overlay_parameter_info">overlay_parameter_info</code></td>
<td>
<p>A <code>logical</code> argument. If <code>TRUE</code>,
more information about the acrophase and amplitude are displayed on the
polar plots.</p>
</td></tr>
<tr><td><code id="polar_plot_+3A_quietly">quietly</code></td>
<td>
<p>Analogous to verbose, this <code>logical</code> argument controls
whether messages are displayed in the console.</p>
</td></tr>
<tr><td><code id="polar_plot_+3A_show_component_labels">show_component_labels</code></td>
<td>
<p>Logical argument, TRUE by default. When TRUE,
the polar plots have labels corresponding to their components.</p>
</td></tr>
<tr><td><code id="polar_plot_+3A_xlims">xlims</code></td>
<td>
<p>A vector of length two containing the limits for the x-axis.</p>
</td></tr>
<tr><td><code id="polar_plot_+3A_ylims">ylims</code></td>
<td>
<p>A vector of length two containing the limits for the y-axis.</p>
</td></tr>
<tr><td><code id="polar_plot_+3A_...">...</code></td>
<td>
<p>Additional, ignored arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a <code>ggplot</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(vitamind)
model &lt;- cglmm(
  vit_d ~ X + amp_acro(time, group = "X", period = 12),
  data = vitamind
)
polar_plot(model, radial_units = "period")
</code></pre>

<hr>
<h2 id='polar_plot.cglmm'>Generates a polar plot with elliptical confidence intervals</h2><span id='topic+polar_plot.cglmm'></span>

<h3>Description</h3>

<p>Generates a polar plot with elliptical confidence intervals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cglmm'
polar_plot(
  x,
  ci_level = 0.95,
  n_breaks = 5,
  component_index = NULL,
  grid_angle_segments = 8,
  radial_units = c("radians", "degrees", "period"),
  clockwise = FALSE,
  text_size = 3.5,
  text_opacity = 1,
  fill_colours,
  ellipse_opacity = 0.3,
  circle_linetype = "dotted",
  start = c("right", "left", "top", "bottom"),
  view = c("full", "zoom", "zoom_origin"),
  overlay_parameter_info = FALSE,
  quietly = TRUE,
  show_component_labels = TRUE,
  xlims,
  ylims,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="polar_plot.cglmm_+3A_x">x</code></td>
<td>
<p>An object of class <code>cglmm</code></p>
</td></tr>
<tr><td><code id="polar_plot.cglmm_+3A_ci_level">ci_level</code></td>
<td>
<p>The level for calculated confidence ellipses.
Defaults to 0.95.</p>
</td></tr>
<tr><td><code id="polar_plot.cglmm_+3A_n_breaks">n_breaks</code></td>
<td>
<p>The number of concentric circles that will be plotted using
the <code>scales::breaks_pretty()</code> function. By default, 5 breaks will be
used. The number of breaks may be adjusted to result in an even interval.
For example, if n_breaks is 3, but the maximum plot radius is 8, instead of
plotting circles in intervals in 1.6, this interval will be rounded to 2
to result in the sequence: 0, 2, 4, 6, 8. See <code>?scales::breaks_pretty</code>
for more details.</p>
</td></tr>
<tr><td><code id="polar_plot.cglmm_+3A_component_index">component_index</code></td>
<td>
<p>A number that corresponds to a particular component
from the <code>cglmm()</code> object that will be used to create polar plot.
If missing (default), then plots for all components will be arranged in the
returned plot. If a single or multiple values are provided, then these
components will be returned. (for example <code>component_index = 1</code>,
<code>component_index = c(1, 3)</code>).</p>
</td></tr>
<tr><td><code id="polar_plot.cglmm_+3A_grid_angle_segments">grid_angle_segments</code></td>
<td>
<p>An <code>integer</code>. Determines the total number of
segments in the background of the polar plot. For example, a value of 4 will
create quadrants around the origin. Defaults to 8.</p>
</td></tr>
<tr><td><code id="polar_plot.cglmm_+3A_radial_units">radial_units</code></td>
<td>
<p>A <code>character</code> specifying the angular units of the
plot. Possible values are one of <code>c('radians', 'degrees', 'period')</code>.
These units relate to the period of the component being visualised.
</p>

<dl>
<dt><code>'radians'</code>: <code class="reqn">[0, 2\pi]</code></dt><dd></dd>
<dt><code>'degrees'</code>: <code class="reqn">[0, 360]</code></dt><dd></dd>
<dt><code>'period'</code>: <code class="reqn">[0, period]</code></dt><dd></dd>
</dl>
</td></tr>
<tr><td><code id="polar_plot.cglmm_+3A_clockwise">clockwise</code></td>
<td>
<p>A <code>logical</code>. If <code>TRUE</code>, the angles increase in a
clockwise fashion. If <code>FALSE</code>, anti-clockwise. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="polar_plot.cglmm_+3A_text_size">text_size</code></td>
<td>
<p>A number controlling the font size of the text labels.
Defaults to 3.</p>
</td></tr>
<tr><td><code id="polar_plot.cglmm_+3A_text_opacity">text_opacity</code></td>
<td>
<p>A <code>numeric</code> between 0 and 1 inclusive that
controls the opacity of the text labels.</p>
</td></tr>
<tr><td><code id="polar_plot.cglmm_+3A_fill_colours">fill_colours</code></td>
<td>
<p>A <code>character</code> vector containing colours that will
be mapped to levels within a group. If the model has components with
different number of levels per factor, the length of this input should match
the greatest number of levels. If not, or if the number of levels exceeds the
length of the default argument (8), colours are generated using
<code>rainbow()</code>.</p>
</td></tr>
<tr><td><code id="polar_plot.cglmm_+3A_ellipse_opacity">ellipse_opacity</code></td>
<td>
<p>A <code>numeric</code> between 0 and 1 inclusive that
controls the opacity of the confidence ellipses. Defaults to 0.3.</p>
</td></tr>
<tr><td><code id="polar_plot.cglmm_+3A_circle_linetype">circle_linetype</code></td>
<td>
<p>A <code>character</code> or <code>numeric</code> that determines
the <code>linetype</code> of the radial circles in background of the polar plot.
See <code>?linetype</code>
for more details.</p>
</td></tr>
<tr><td><code id="polar_plot.cglmm_+3A_start">start</code></td>
<td>
<p>A <code>character</code>, within
<code>c("right", "left", "top", "bottom")</code> that determines where angle 0 is
located. If <code>start = "top"</code>, and <code>clockwise = TRUE</code>, the angle
will rotate clockwise, starting at the '12 o-clock' position on a clock.</p>
</td></tr>
<tr><td><code id="polar_plot.cglmm_+3A_view">view</code></td>
<td>
<p>A <code>character</code>, within
<code>c("full", "zoom", "zoom_origin")</code> that controls the view of the plots.
</p>

<dl>
<dt><code>'full'</code>: maintains a full view of the polar plot, including
the background radial circles.</dt><dd></dd>
<dt><code>'zoom'</code>: finds the minimum view window which contains all
confidence ellipses.</dt><dd></dd>
<dt><code>'zoom_origin'</code>: zooms into the confidence ellipses (like
&quot;zoom&quot;), but also keeps the origin within frame.</dt><dd></dd>
</dl>
</td></tr>
<tr><td><code id="polar_plot.cglmm_+3A_overlay_parameter_info">overlay_parameter_info</code></td>
<td>
<p>A <code>logical</code> argument. If <code>TRUE</code>,
more information about the acrophase and amplitude are displayed on the
polar plots.</p>
</td></tr>
<tr><td><code id="polar_plot.cglmm_+3A_quietly">quietly</code></td>
<td>
<p>Analogous to verbose, this <code>logical</code> argument controls
whether messages are displayed in the console.</p>
</td></tr>
<tr><td><code id="polar_plot.cglmm_+3A_show_component_labels">show_component_labels</code></td>
<td>
<p>Logical argument, TRUE by default. When TRUE,
the polar plots have labels corresponding to their components.</p>
</td></tr>
<tr><td><code id="polar_plot.cglmm_+3A_xlims">xlims</code></td>
<td>
<p>A vector of length two containing the limits for the x-axis.</p>
</td></tr>
<tr><td><code id="polar_plot.cglmm_+3A_ylims">ylims</code></td>
<td>
<p>A vector of length two containing the limits for the y-axis.</p>
</td></tr>
<tr><td><code id="polar_plot.cglmm_+3A_...">...</code></td>
<td>
<p>Additional, ignored arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a <code>ggplot</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>model &lt;- cglmm(
  vit_d ~ X + amp_acro(time, group = "X", period = 12),
  data = vitamind
)
polar_plot(model, radial_units = "period")
</code></pre>

<hr>
<h2 id='predict.cglmm'>Predict from a cosinor model</h2><span id='topic+predict.cglmm'></span>

<h3>Description</h3>

<p>Given a time variable and optional covariates, generate predicted values from
a cosinor fit. Default prediction is the mean value, optionally can predict
at a given month
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cglmm'
predict(object, newdata, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.cglmm_+3A_object">object</code></td>
<td>
<p>An object of class <code>cglmm</code>.</p>
</td></tr>
<tr><td><code id="predict.cglmm_+3A_newdata">newdata</code></td>
<td>
<p>Optional new data.</p>
</td></tr>
<tr><td><code id="predict.cglmm_+3A_...">...</code></td>
<td>
<p>other arguments passed to <code>glmmTMB:::predict.glmmTMB</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns predicted values from the cosinor model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
fit &lt;- cglmm(vit_d ~ X + amp_acro(time,
  group = "X",
  n_components = 1,
  period = 12
), data = vitamind)
predict(fit)

</code></pre>

<hr>
<h2 id='print.cglmm'>Print a brief summary of the <code>cglmm</code> model.</h2><span id='topic+print.cglmm'></span>

<h3>Description</h3>

<p>Print a brief summary of the <code>cglmm</code> model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cglmm'
print(x, digits = getOption("digits"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.cglmm_+3A_x">x</code></td>
<td>
<p>A <code>cglmm</code> object.</p>
</td></tr>
<tr><td><code id="print.cglmm_+3A_digits">digits</code></td>
<td>
<p>Controls the number of digits displayed in the summary output.</p>
</td></tr>
<tr><td><code id="print.cglmm_+3A_...">...</code></td>
<td>
<p>Additional, ignored arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>print(x)</code> returns <code>x</code> invisibly.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Single component cosinor model
cglmm(
  vit_d ~ amp_acro(time_col = time, group = "X", period = 12),
  data = vitamind
)
</code></pre>

<hr>
<h2 id='print.cglmmSubTest'>Print test of model</h2><span id='topic+print.cglmmSubTest'></span>

<h3>Description</h3>

<p>Print test of model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cglmmSubTest'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.cglmmSubTest_+3A_x">x</code></td>
<td>
<p>A <code>sub_test_cosinor</code> object.</p>
</td></tr>
<tr><td><code id="print.cglmmSubTest_+3A_...">...</code></td>
<td>
<p>Additional, ignored arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>print(x)</code> returns <code>x</code> invisibly.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data_2_component &lt;- simulate_cosinor(
  n = 10000,
  mesor = 5,
  amp = c(2, 5),
  acro = c(0, pi),
  beta.mesor = 4,
  beta.amp = c(3, 4),
  beta.acro = c(0, pi / 2),
  family = "gaussian",
  n_components = 2,
  period = c(10, 12),
  beta.group = TRUE
)
mod_2_component &lt;- cglmm(
  Y ~ group + amp_acro(times,
    n_components = 2, group = "group",
    period = c(10, 12)
  ),
  data = data_2_component
)
test_output &lt;- test_cosinor_levels(
  mod_2_component,
  param = "amp",
  x_str = "group"
)
print(test_output$global.test)
</code></pre>

<hr>
<h2 id='print.cglmmSummary'>Print the summary of a cosinor model</h2><span id='topic+print.cglmmSummary'></span>

<h3>Description</h3>

<p>Print the summary of a cosinor model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cglmmSummary'
print(x, digits = getOption("digits"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.cglmmSummary_+3A_x">x</code></td>
<td>
<p>An object of class <code>cglmmSummary</code></p>
</td></tr>
<tr><td><code id="print.cglmmSummary_+3A_digits">digits</code></td>
<td>
<p>Controls the number of digits displayed in the summary output</p>
</td></tr>
<tr><td><code id="print.cglmmSummary_+3A_...">...</code></td>
<td>
<p>Currently unused</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>print</code> returns <code>x</code> invisibly.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
fit &lt;- cglmm(vit_d ~ X + amp_acro(time,
  group = "X",
  n_components = 1,
  period = 12
), data = vitamind)
summary(fit)

</code></pre>

<hr>
<h2 id='print.cglmmTest'>Print results of test of cosinor model</h2><span id='topic+print.cglmmTest'></span>

<h3>Description</h3>

<p>Print results of test of cosinor model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cglmmTest'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.cglmmTest_+3A_x">x</code></td>
<td>
<p>A <code>test_cosinor</code> object.</p>
</td></tr>
<tr><td><code id="print.cglmmTest_+3A_...">...</code></td>
<td>
<p>Arguments passed to <code>print</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>print(x)</code> returns <code>x</code> invisibly.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data_2_component &lt;- simulate_cosinor(
  n = 10000,
  mesor = 5,
  amp = c(2, 5),
  acro = c(0, pi),
  beta.mesor = 4,
  beta.amp = c(3, 4),
  beta.acro = c(0, pi / 2),
  family = "gaussian",
  n_components = 2,
  period = c(10, 12),
  beta.group = TRUE
)
mod_2_component &lt;- cglmm(
  Y ~ group + amp_acro(times,
    n_components = 2, group = "group",
    period = c(10, 12)
  ),
  data = data_2_component
)
test_cosinor_levels(
  mod_2_component,
  param = "amp",
  x_str = "group"
)
</code></pre>

<hr>
<h2 id='reexports'>Objects exported from other packages</h2><span id='topic+reexports'></span><span id='topic+autoplot'></span><span id='topic+sigma'></span>

<h3>Description</h3>

<p>These objects are imported from other packages. Follow the links
below to see their documentation.
</p>

<dl>
<dt>ggplot2</dt><dd><p><code><a href="ggplot2.html#topic+autoplot">autoplot</a></code></p>
</dd>
<dt>stats</dt><dd><p><code><a href="stats.html#topic+sigma">sigma</a></code></p>
</dd>
</dl>

<hr>
<h2 id='sigma.cglmm'>Extract residual standard deviation or dispersion parameter</h2><span id='topic+sigma.cglmm'></span>

<h3>Description</h3>

<p>see <code>?glmmTMB::sigma</code> for more details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cglmm'
sigma(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sigma.cglmm_+3A_object">object</code></td>
<td>
<p>An object of class <code>cglmm</code>.</p>
</td></tr>
<tr><td><code id="sigma.cglmm_+3A_...">...</code></td>
<td>
<p>(ignored; for method compatibility)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>numeric</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>testdata_poisson &lt;- simulate_cosinor(100,
  n_period = 2,
  mesor = 7,
  amp = c(0.1, 0.5),
  acro = c(1, 1),
  beta.mesor = 4.4,
  beta.amp = c(0.1, 0.46),
  beta.acro = c(0.5, -1.5),
  family = "poisson",
  period = c(12, 6),
  n_components = 2,
  beta.group = TRUE
)

mod &lt;- cosinor_model &lt;- cglmm(
  Y ~ group + amp_acro(times,
    period = c(12, 6),
    n_components = 2,
    group = "group"
  ),
  data = testdata_poisson,
  family = glmmTMB::nbinom1()
)
sigma(mod)
</code></pre>

<hr>
<h2 id='simulate_cosinor'>Simulate data from a cosinor model</h2><span id='topic+simulate_cosinor'></span>

<h3>Description</h3>

<p>This function simulates data from a cosinor model with a single covariate,
where the time scale is month, and optionally
allows for single covariate effects on the mean,
amplitude, and acrophase.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_cosinor(
  n,
  mesor,
  amp,
  acro,
  period = 24,
  n_components,
  beta.group = FALSE,
  beta.mesor,
  beta.amp,
  beta.acro,
  n_period = 1,
  family = c("gaussian", "poisson", "binomial", "gamma"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulate_cosinor_+3A_n">n</code></td>
<td>
<p>The sample size. An <code>integer</code> greater than 0.</p>
</td></tr>
<tr><td><code id="simulate_cosinor_+3A_mesor">mesor</code></td>
<td>
<p>A <code>numeric</code>. The MESOR (midline estimating statistic of
rhythm) for <code>group = 0</code>. The MESOR is independent of the cosinor
components, so only one value is allowed even if there are multiple
components in the data being simulated.</p>
</td></tr>
<tr><td><code id="simulate_cosinor_+3A_amp">amp</code></td>
<td>
<p>A <code>numeric</code>. The amplitude value (for <code>group = 0</code> if
grouped data are being simulated (<code>beta.group = TRUE</code>)). If simulating
data with multiple components, specify a vector with values for each
component. E.g: <code>amp = c(5, 10)</code>.</p>
</td></tr>
<tr><td><code id="simulate_cosinor_+3A_acro">acro</code></td>
<td>
<p>A <code>numeric</code>. The acrophase value in radians
(for <code>group = 0</code> if grouped data are being simulated
(<code>beta.group = TRUE</code>)). If simulating data with multiple components,
specify a vector with values for each component. E.g: <code>acr = c(0, pi)</code>
for two components.</p>
</td></tr>
<tr><td><code id="simulate_cosinor_+3A_period">period</code></td>
<td>
<p>The period of the rhythm data (for <code>group = 0</code> if
grouped data are being simulated (<code>beta.group = TRUE</code>)).
If simulating data with multiple components, specify a vector with values
for each component. E.g: <code>period = c(12, 6)</code> for two components.</p>
</td></tr>
<tr><td><code id="simulate_cosinor_+3A_n_components">n_components</code></td>
<td>
<p>The number of components in the model.
This must match the length of the inputs for <code>amp</code> and <code>acro</code>.</p>
</td></tr>
<tr><td><code id="simulate_cosinor_+3A_beta.group">beta.group</code></td>
<td>
<p>A <code>logical</code>. If <code>TRUE</code> a second group of data
will be simulated and included in the returned data set. If <code>FALSE</code>,
<code>beta.acro</code>, <code>beta.mesor</code>, and <code>beta.amp</code> arguments will be
ignored.</p>
</td></tr>
<tr><td><code id="simulate_cosinor_+3A_beta.mesor">beta.mesor</code></td>
<td>
<p>A <code>numeric</code>. The MESOR value term for <code>group = 1</code></p>
</td></tr>
<tr><td><code id="simulate_cosinor_+3A_beta.amp">beta.amp</code></td>
<td>
<p>A <code>numeric</code>. The amplitude value for <code>group = 1</code>.
If simulating data with multiple components, specify a vector with values for
each component. E.g: <code>amp = c(2, 8)</code>.</p>
</td></tr>
<tr><td><code id="simulate_cosinor_+3A_beta.acro">beta.acro</code></td>
<td>
<p>A <code>numeric</code>. The acrophase value in radians
(for <code>group = 1</code>. If simulating data with multiple components,
specify a vector with values for each component. E.g: <code>acr = c(2, 5)</code>
for two components.</p>
</td></tr>
<tr><td><code id="simulate_cosinor_+3A_n_period">n_period</code></td>
<td>
<p>A <code>numeric</code>. The number of cycles of the rhythm to be
simulated.</p>
</td></tr>
<tr><td><code id="simulate_cosinor_+3A_family">family</code></td>
<td>
<p>A <code>character</code>. The family (see <code>?family</code>) of the
simulated dataset. Can handle values in <code>c("poisson", "binomial",
"gamma", "gaussian")</code>.</p>
</td></tr>
<tr><td><code id="simulate_cosinor_+3A_...">...</code></td>
<td>
<p>Extra arguments, including <code>alpha</code> that controls the
<code>shape</code> argument when sampling from a gamma distribution
(when <code>family = "gamma"</code>; default is 1), and <code>sd</code>
(standard deviation) which is used when sampling from a normal distribution
(when <code>family = "gaussian"</code>; default is 1). To specify these parameters
for the beta (treatment) group, use <code>beta.alpha</code> and <code>beta.sd</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns simulated data in a <code>data.frame</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>simulate_cosinor(
  n = 100,
  mesor = 1,
  amp = 1,
  acro = 1,
  period = 24,
  family = "gaussian"
)
</code></pre>

<hr>
<h2 id='summary.cglmm'>Summarize a cosinor model
Given a time variable and optional covariates, generate inference a cosinor
fit. Gives estimates, confidence intervals, and tests for the raw parameters,
and for the mean, amplitude, and acrophase parameters. If the model includes
covariates, the function returns the estimates of the mean, amplitude, and
acrophase for the group with covariates equal to 1 and equal to 0. This may
not be the desired result for continuous covariates.</h2><span id='topic+summary.cglmm'></span>

<h3>Description</h3>

<p>Summarize a cosinor model
Given a time variable and optional covariates, generate inference a cosinor
fit. Gives estimates, confidence intervals, and tests for the raw parameters,
and for the mean, amplitude, and acrophase parameters. If the model includes
covariates, the function returns the estimates of the mean, amplitude, and
acrophase for the group with covariates equal to 1 and equal to 0. This may
not be the desired result for continuous covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cglmm'
summary(object, ci_level = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.cglmm_+3A_object">object</code></td>
<td>
<p>An object of class <code>cglmm</code></p>
</td></tr>
<tr><td><code id="summary.cglmm_+3A_ci_level">ci_level</code></td>
<td>
<p>The level for calculated confidence intervals. Defaults to
0.95.</p>
</td></tr>
<tr><td><code id="summary.cglmm_+3A_...">...</code></td>
<td>
<p>Currently unused</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a summary of the <code>cglmm</code> model as
a <code>cglmmSummary</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

fit &lt;- cglmm(vit_d ~ X + amp_acro(time,
  group = "X",
  n_components = 1,
  period = 12
), data = vitamind)
summary(fit)

</code></pre>

<hr>
<h2 id='test_cosinor_components'>Test for differences in a cosinor model between components.</h2><span id='topic+test_cosinor_components'></span>

<h3>Description</h3>

<p>Given a time variable and optional covariates, generate inference a cosinor
fit. For the covariate named (or vector of covariates), this function
performs a Wald test comparing the group with covariates equal to 1 to the
group with covariates equal to 0. This may not be the desired result for
continuous covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>test_cosinor_components(
  x,
  x_str = NULL,
  param = "amp",
  comparison_A = 1,
  comparison_B = 2,
  level_index = 0,
  ci_level = 0.95
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="test_cosinor_components_+3A_x">x</code></td>
<td>
<p>An <code>cglmm</code> object.</p>
</td></tr>
<tr><td><code id="test_cosinor_components_+3A_x_str">x_str</code></td>
<td>
<p>A <code>character</code>. The name of the grouping variable within
which differences in the selected cosinor characteristic (amplitude or
acrophase) will be tested. If there is no grouping variable in the model,
then this can be left as NULL (default).</p>
</td></tr>
<tr><td><code id="test_cosinor_components_+3A_param">param</code></td>
<td>
<p>A <code>character</code>. Either <code>"amp"</code> or <code>"acr"</code> for
testing differences in amplitude or acrophase, respectively.</p>
</td></tr>
<tr><td><code id="test_cosinor_components_+3A_comparison_a">comparison_A</code></td>
<td>
<p>An <code>integer</code>. Refers to the component number that is
to act as the reference group.
for the comparison.</p>
</td></tr>
<tr><td><code id="test_cosinor_components_+3A_comparison_b">comparison_B</code></td>
<td>
<p>An <code>integer</code>. Refers to the component number that is
to act as the comparator group</p>
</td></tr>
<tr><td><code id="test_cosinor_components_+3A_level_index">level_index</code></td>
<td>
<p>An <code>integer</code>. If
<code>comparison_type = "components"</code>, <code>level_index</code> indicates which
level of the grouping variable is being used for the comparison between
components.</p>
</td></tr>
<tr><td><code id="test_cosinor_components_+3A_ci_level">ci_level</code></td>
<td>
<p>The level for calculated confidence intervals. Defaults to
<code>0.95</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a <code>test_cosinor</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data_2_component &lt;- simulate_cosinor(
  n = 10000,
  mesor = 5,
  amp = c(2, 5),
  acro = c(0, pi),
  beta.mesor = 4,
  beta.amp = c(3, 4),
  beta.acro = c(0, pi / 2),
  family = "gaussian",
  n_components = 2,
  period = c(10, 12),
  beta.group = TRUE
)
mod_2_component &lt;- cglmm(
  Y ~ group + amp_acro(times,
    n_components = 2, group = "group",
    period = c(10, 12)
  ),
  data = data_2_component
)
test_cosinor_components(mod_2_component, param = "amp", x_str = "group")
</code></pre>

<hr>
<h2 id='test_cosinor_levels'>Test for differences in a cosinor model between levels of the grouping
variable.</h2><span id='topic+test_cosinor_levels'></span>

<h3>Description</h3>

<p>Given a time variable and optional covariates, generate inference a cosinor
fit. For the covariate named (or vector of covariates), this function
performs a Wald test comparing the group with covariates equal to 1 to the
group with covariates equal to 0. This may not be the desired result for
continuous covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>test_cosinor_levels(
  x,
  x_str,
  param = "amp",
  comparison_A,
  comparison_B,
  component_index = 1,
  ci_level = 0.95
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="test_cosinor_levels_+3A_x">x</code></td>
<td>
<p>An <code>cglmm</code> object.</p>
</td></tr>
<tr><td><code id="test_cosinor_levels_+3A_x_str">x_str</code></td>
<td>
<p>A <code>character</code>. The name of the grouping variable within
which differences in the selected cosinor characteristic (amplitude or
acrophase) will be tested.</p>
</td></tr>
<tr><td><code id="test_cosinor_levels_+3A_param">param</code></td>
<td>
<p>A <code>character</code>. Either <code>"amp"</code> or <code>"acr"</code> for
testing differences in amplitude or acrophase, respectively.</p>
</td></tr>
<tr><td><code id="test_cosinor_levels_+3A_comparison_a">comparison_A</code></td>
<td>
<p>An <code>integer, or string</code>. Refers to the first level
within the grouping variable <code>x_str</code> that is to act as the reference
group in the comparison. Ensure that it corresponds to the name of the level
in the original dataset.</p>
</td></tr>
<tr><td><code id="test_cosinor_levels_+3A_comparison_b">comparison_B</code></td>
<td>
<p>An <code>integer, or string</code>. Refers to the second level
within the grouping variable <code>x_str</code> that is to act as the comparator
group in the comparison. Ensure that it corresponds to the name of the level
in the original dataset.</p>
</td></tr>
<tr><td><code id="test_cosinor_levels_+3A_component_index">component_index</code></td>
<td>
<p>An <code>integer</code>. If
<code>comparison_type = "levels"</code>, <code>component_index</code> indicates which
component is being compared between the levels of the grouping variable.</p>
</td></tr>
<tr><td><code id="test_cosinor_levels_+3A_ci_level">ci_level</code></td>
<td>
<p>The level for calculated confidence intervals. Defaults to
<code>0.95</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a <code>test_cosinor</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data_2_component &lt;- simulate_cosinor(
  n = 10000,
  mesor = 5,
  amp = c(2, 5),
  acro = c(0, pi),
  beta.mesor = 4,
  beta.amp = c(3, 4),
  beta.acro = c(0, pi / 2),
  family = "gaussian",
  n_components = 2,
  period = c(10, 12),
  beta.group = TRUE
)
mod_2_component &lt;- cglmm(
  Y ~ group + amp_acro(times,
    n_components = 2, group = "group",
    period = c(10, 12)
  ),
  data = data_2_component
)
test_cosinor_levels(mod_2_component, param = "amp", x_str = "group")
</code></pre>

<hr>
<h2 id='update_formula_and_data'>Update data and formula for fitting cglmm model</h2><span id='topic+update_formula_and_data'></span>

<h3>Description</h3>

<p>Update data and formula for fitting cglmm model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_formula_and_data(
  data,
  formula,
  family = "gaussian",
  quietly = TRUE,
  dispformula = ~1,
  ziformula = ~0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="update_formula_and_data_+3A_data">data</code></td>
<td>
<p>input data for fitting cglmm model.</p>
</td></tr>
<tr><td><code id="update_formula_and_data_+3A_formula">formula</code></td>
<td>
<p>model formula, specified by user including <code>amp_acro()</code>.</p>
</td></tr>
<tr><td><code id="update_formula_and_data_+3A_family">family</code></td>
<td>
<p>the model family.</p>
</td></tr>
<tr><td><code id="update_formula_and_data_+3A_quietly">quietly</code></td>
<td>
<p>controls whether messages from amp_acro are displayed.
TRUE by default</p>
</td></tr>
<tr><td><code id="update_formula_and_data_+3A_dispformula">dispformula</code></td>
<td>
<p>The formula specifying the dispersion model</p>
</td></tr>
<tr><td><code id="update_formula_and_data_+3A_ziformula">ziformula</code></td>
<td>
<p>The formula specifying the zero-inflation model</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a <code>list</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Use vitamind data but add a "patient" identifier used as a random effect
vitamind2 &lt;- vitamind
vitamind2$patient &lt;- sample(
  LETTERS[1:5],
  size = nrow(vitamind2), replace = TRUE
)

# Use update_formula_and_data() to perform wrangling steps of cglmm()
# without yet fitting the model
data_and_formula &lt;- update_formula_and_data(
  data = vitamind2,
  formula = vit_d ~ X + amp_acro(time,
    group = "X",
    period = 12
  )
)

# print formula from above
data_and_formula$newformula

# fit model while adding random effect to cosinor model formula.
mod &lt;- fit_model_and_process(
  obj = data_and_formula,
  formula = update.formula(
    data_and_formula$newformula, . ~ . + (1 | patient)
  )
)

mod
mod$fit # printing the `glmmTMB` model within shows Std.Dev. of random effect
</code></pre>

<hr>
<h2 id='vitamind'>Vitamin D dataset for cosinor modelling examples.</h2><span id='topic+vitamind'></span>

<h3>Description</h3>

<p>Simulated data set to illustrate the cosinor model. The <code>vit_d</code> column
contains the blood vitamin D levels which vary over time (<code>time</code>).
The rhythm of the vitamind D fluctuations follows a cosine function and can
be modelled with a cosinor model. The <code>X</code> column is a binary covariate
representing two groups of patients and is associated with the
characteristics of the rhythm. The rhythm has a period of about 12 hours.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vitamind
</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> with 3 variables: <code>vit_d</code>, <code>time</code>, and
<code>X</code>.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
