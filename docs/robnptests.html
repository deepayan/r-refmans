<!DOCTYPE html><html><head><title>Help for package robnptests</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {robnptests}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#calc_perm_p_value'><p>Calculation of permutation p-value</p></a></li>
<li><a href='#check_test_input'><p>Checks for input arguments</p></a></li>
<li><a href='#compute_results_asymptotic'><p>Test decision for asymptotic versions of HL1-, HL2-, and MED-tests</p></a></li>
<li><a href='#compute_results_finite'><p>Finite-sample test decision for HL1-, HL2-, and MED-tests</p></a></li>
<li><a href='#hl1_test'><p>Two-sample location tests based on one-sample Hodges-Lehmann estimator</p></a></li>
<li><a href='#hl2_test'><p>Two-sample location tests based on two-sample Hodges-Lehmann estimator.</p></a></li>
<li><a href='#hodges_lehmann'><p>One-sample Hodges-Lehmann estimator</p></a></li>
<li><a href='#hodges_lehmann_2sample'><p>Two-sample Hodges-Lehmann estimator</p></a></li>
<li><a href='#m_est'><p>M-estimator of location</p></a></li>
<li><a href='#m_est_perm_distribution'><p>Permutation distribution for M-statistics</p></a></li>
<li><a href='#m_test'><p>Two sample location test based on M-estimators</p></a></li>
<li><a href='#m_test_statistic'><p>Test statistics for the M-tests</p></a></li>
<li><a href='#med_test'><p>Two-sample location tests based on the sample median</p></a></li>
<li><a href='#perm_distribution'><p>Permutation distribution for robust test statistics</p></a></li>
<li><a href='#preprocess_data'><p>Preprocess data for the robust two sample tests</p></a></li>
<li><a href='#rob_perm_statistic'><p>Robust test statistics based on robust location estimators</p></a></li>
<li><a href='#rob_scale'><p>Robust scale estimators based on median absolute deviation</p></a></li>
<li><a href='#select_method'><p>Select principle for computing null distribution</p></a></li>
<li><a href='#trim_mean'><p>Trimmed mean</p></a></li>
<li><a href='#trimmed_t'><p>Test statistic for the two-sample trimmed t-test (Yuen's t-test)</p></a></li>
<li><a href='#trimmed_test'><p>Two-sample trimmed t-test (Yuen's t-Test)</p></a></li>
<li><a href='#win_mean'><p>Winsorized mean</p></a></li>
<li><a href='#win_var'><p>Winsorized variance</p></a></li>
<li><a href='#wobble'><p>Add random noise to remove ties</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.1.0</td>
</tr>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Robust Nonparametric Two-Sample Tests for Location/Scale</td>
</tr>
<tr>
<td>Author:</td>
<td>Sermad Abbas <a href="https://orcid.org/0000-0001-9162-9792"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Barbara Brune <a href="https://orcid.org/0000-0002-3154-8445"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Roland Fried <a href="https://orcid.org/0000-0002-9830-9713"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Sermad Abbas &lt;abbas@statistik.tu-dortmund.de&gt;</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/s-abbas/robnptests/issues">https://github.com/s-abbas/robnptests/issues</a></td>
</tr>
<tr>
<td>Description:</td>
<td>Implementations of several robust nonparametric two-sample tests
    for location or scale differences. The test statistics are based on robust
    location and scale estimators, e.g. the sample median or the Hodges-Lehmann estimators
    as described in Fried &amp; Dehling (2011) &lt;<a href="https://doi.org/10.1007%2Fs10260-011-0164-1">doi:10.1007/s10260-011-0164-1</a>&gt;.
    The p-values can be computed via the permutation principle, the randomization principle, or by using
    the asymptotic distributions of the test statistics under the null hypothesis, which ensures
    (approximate) distribution independence of the test decision. To test for a difference in
    scale, we apply the tests for location difference to transformed observations; see Fried (2012) &lt;<a href="https://doi.org/10.1016%2Fj.csda.2011.02.012">doi:10.1016/j.csda.2011.02.012</a>&gt;.
    Random noise on a small range can be added to the original observations in order to
    hold the significance level on data from discrete distributions.
    The location tests assume homoscedasticity and the scale tests require the
    location parameters to be zero.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0)</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/s-abbas/robnptests">https://github.com/s-abbas/robnptests</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rdpack, gtools, robustbase, statmod, stats, utils, checkmate</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>Rdpack</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, knitr, rmarkdown, usethis, covr</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-02-13 20:44:58 UTC; abbas</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-02-13 21:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='calc_perm_p_value'>Calculation of permutation p-value</h2><span id='topic+calc_perm_p_value'></span>

<h3>Description</h3>

<p><code>calc_perm_p_value</code> calculates the permutation p-value following Phipson and Smyth (2010).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_perm_p_value(
  statistic,
  distribution,
  m,
  n,
  randomization,
  n.rep,
  alternative
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calc_perm_p_value_+3A_statistic">statistic</code></td>
<td>
<p>observed value of the test statistic.</p>
</td></tr>
<tr><td><code id="calc_perm_p_value_+3A_distribution">distribution</code></td>
<td>
<p>a numeric vector with the permutation/randomization
distribution.</p>
</td></tr>
<tr><td><code id="calc_perm_p_value_+3A_m">m</code></td>
<td>
<p>an integer value giving size of first sample.</p>
</td></tr>
<tr><td><code id="calc_perm_p_value_+3A_n">n</code></td>
<td>
<p>an integer value giving size of second sample.</p>
</td></tr>
<tr><td><code id="calc_perm_p_value_+3A_randomization">randomization</code></td>
<td>
<p>a logical value indicating whether the p-value should be
computed from a permutation (<code>FALSE</code>, default) or a
randomization (<code>TRUE</code>) distribution.</p>
</td></tr>
<tr><td><code id="calc_perm_p_value_+3A_n.rep">n.rep</code></td>
<td>
<p>an integer value specifying the number of random splits used to
calculate the randomization distribution if <code>method = "randomization"</code>.
This argument is ignored if <code>method = "permutation"</code> or <code>method = "asymptotic"</code>.
The default is <code>n.rep = 10000</code>.</p>
</td></tr>
<tr><td><code id="calc_perm_p_value_+3A_alternative">alternative</code></td>
<td>
<p>a character string specifying the alternative hypothesis,
must be one of &quot;two.sided&quot; (default), &quot;greater&quot;, or &quot;less&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>p-value for the specified alternative.
</p>


<h3>References</h3>

<p>Phipson B, Smyth GK (2010).
&ldquo;Permutation p-values should never be zero: Calculating exact p-values when permutations are randomly drawn.&rdquo;
<em>Statistical Applications in Genetics and Molecular Biology</em>, <b>9</b>(1), Article 39.
<a href="https://doi.org/10.2202/1544-6115.1585">doi:10.2202/1544-6115.1585</a>.
</p>

<hr>
<h2 id='check_test_input'>Checks for input arguments</h2><span id='topic+check_test_input'></span>

<h3>Description</h3>

<p><code>check_test_input</code> is a helper functions that contains checks for the
input arguments of the two-sample tests.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_test_input(
  x,
  y,
  alternative,
  delta,
  method,
  scale,
  n.rep,
  na.rm,
  scale.test,
  wobble,
  wobble.seed,
  gamma = NULL,
  psi = NULL,
  k = NULL,
  test.name
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_test_input_+3A_x">x</code></td>
<td>
<p>a (non-empty) numeric vector of data values.</p>
</td></tr>
<tr><td><code id="check_test_input_+3A_y">y</code></td>
<td>
<p>a (non-empty) numeric vector of data values.</p>
</td></tr>
<tr><td><code id="check_test_input_+3A_alternative">alternative</code></td>
<td>
<p>a character string specifying the alternative hypothesis,
must be one of &quot;two.sided&quot;, &quot;greater&quot;, or &quot;less&quot;.</p>
</td></tr>
<tr><td><code id="check_test_input_+3A_delta">delta</code></td>
<td>
<p>a numeric value indicating the true difference in the location
or scale parameter, depending on whether the test should be
performed for a difference in location or in scale.</p>
</td></tr>
<tr><td><code id="check_test_input_+3A_scale">scale</code></td>
<td>
<p>a character string specifying the scale estimator used for
standardization in the test statistic; must be one of <code>"S1"</code>,
<code>"S2"</code>, <code>"S3"</code>, and <code>"S4"</code>.</p>
</td></tr>
<tr><td><code id="check_test_input_+3A_n.rep">n.rep</code></td>
<td>
<p>an integer value specifying the number of random splits used to
calculate the randomization distribution if <code>method = "randomization"</code>.</p>
</td></tr>
<tr><td><code id="check_test_input_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical value indicating whether NA values in <code>x</code> and <code>y</code>
should be stripped before the computation proceeds.</p>
</td></tr>
<tr><td><code id="check_test_input_+3A_scale.test">scale.test</code></td>
<td>
<p>a logical value testing whether the samples should be compared
for a difference in scale.</p>
</td></tr>
<tr><td><code id="check_test_input_+3A_wobble">wobble</code></td>
<td>
<p>a logical value indicating whether the sample should be checked
for duplicated values that can cause the scale estimate to be zero.
If such values are present, uniform noise is added to the sample,
see <code><a href="#topic+wobble">wobble</a></code>.</p>
</td></tr>
<tr><td><code id="check_test_input_+3A_wobble.seed">wobble.seed</code></td>
<td>
<p>an integer value used as a seed for the random number
generation in case of <code>wobble = TRUE</code> or when
<code>scale.test = TRUE</code> with one of the vectors <code>x</code> and
<code>y</code> containing zeros. When no seed is specified, it
is chosen randomly and printed in a message. The argument
is ignored if <code>scale.test = FALSE</code> and/or <code>wobble = FALSE</code>.</p>
</td></tr>
<tr><td><code id="check_test_input_+3A_gamma">gamma</code></td>
<td>
<p>a numeric value in [0, 0.5] specifying the fraction of observations
to be trimmed/replaced from each end of the sample before
trimmed mean/winsorized variance.</p>
</td></tr>
<tr><td><code id="check_test_input_+3A_psi">psi</code></td>
<td>
<p>kernel used for optimization in the computation of the M-estimates.
Must be one of <code>"bisquare"</code>, <code>"hampel"</code> and
<code>"huber"</code>.</p>
</td></tr>
<tr><td><code id="check_test_input_+3A_k">k</code></td>
<td>
<p>tuning parameter(s) for the respective psi function.</p>
</td></tr>
<tr><td><code id="check_test_input_+3A_test.name">test.name</code></td>
<td>
<p>character string specifying the two-sample test for which
the helper function is used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The two-sample tests in this package share similar arguments. To reduce the
amount of repetitive code, this function contains the argument checks so that
only <code>check_test_input</code> needs to be called within the functions for
the two-sample tests.
</p>
<p>The scale estimators <code>"S1"</code> and <code>"S2"</code> can only be used in
combination with <code>test.name = "hl1_test"</code> or <code>test.name = "hl2_test"</code>.
The estimators <code>"S3"</code> and <code>"S4"</code> can only be used with
<code>test.name = "med_test"</code>.
</p>


<h3>Value</h3>

<p>An error message if a check fails.
</p>

<hr>
<h2 id='compute_results_asymptotic'>Test decision for asymptotic versions of HL1-, HL2-, and MED-tests</h2><span id='topic+compute_results_asymptotic'></span>

<h3>Description</h3>

<p><code>compute_results_asymptotic</code> is a helper function to compute the test
decision for the HL1-, HL2-, and MED-test when <code>method = "asymptotic"</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_results_asymptotic(x, y, alternative, delta, type)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compute_results_asymptotic_+3A_x">x</code></td>
<td>
<p>a (non-empty) numeric vector of data values.</p>
</td></tr>
<tr><td><code id="compute_results_asymptotic_+3A_y">y</code></td>
<td>
<p>a (non-empty) numeric vector of data values.</p>
</td></tr>
<tr><td><code id="compute_results_asymptotic_+3A_alternative">alternative</code></td>
<td>
<p>a character string specifying the alternative hypothesis,
must be one of &quot;two.sided&quot;, &quot;greater&quot;, or &quot;less&quot;.</p>
</td></tr>
<tr><td><code id="compute_results_asymptotic_+3A_delta">delta</code></td>
<td>
<p>a numeric value indicating the true difference in the location
or scale parameter, depending on whether the test should be
performed for a difference in location or in scale.</p>
</td></tr>
<tr><td><code id="compute_results_asymptotic_+3A_type">type</code></td>
<td>
<p>a character string specifying the desired test statistic. It must
be one of <code>"HL11"</code>, <code>"HL12", "HL21", "HL22", "MED1"</code>,
and <code>"MED2"</code>, where <code>"HL1"</code>, <code>"HL2"</code> and
<code>"MED"</code> specify the location estimator and the numbers
<code>1</code> and <code>2</code> the scale estimator, see the vignette
(<code>vignette("robnptests")</code>) for more information.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named list containing the following components:
</p>
<table>
<tr><td><code>statistic</code></td>
<td>
<p>the value of the test statistic.</p>
</td></tr>
<tr><td><code>estimates</code></td>
<td>
<p>the location estimates for both samples in case of the HL1-
and the MED-tests. The estimate for the location difference
in case of the HL2-tests.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value for the test.</p>
</td></tr>
</table>

<hr>
<h2 id='compute_results_finite'>Finite-sample test decision for HL1-, HL2-, and MED-tests</h2><span id='topic+compute_results_finite'></span>

<h3>Description</h3>

<p><code>compute_results_finite</code> is a helper function to compute the test
decision for the HL1-, HL2-, and MED-test when <code>method = "randomization"</code>
or <code>method = "permutation"</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_results_finite(x, y, alternative, delta, method, n.rep, type)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compute_results_finite_+3A_x">x</code></td>
<td>
<p>a (non-empty) numeric vector of data values.</p>
</td></tr>
<tr><td><code id="compute_results_finite_+3A_y">y</code></td>
<td>
<p>a (non-empty) numeric vector of data values.</p>
</td></tr>
<tr><td><code id="compute_results_finite_+3A_alternative">alternative</code></td>
<td>
<p>a character string specifying the alternative hypothesis,
must be one of &quot;two.sided&quot;, &quot;greater&quot;, or &quot;less&quot;.</p>
</td></tr>
<tr><td><code id="compute_results_finite_+3A_delta">delta</code></td>
<td>
<p>a numeric value indicating the true difference in the location
or scale parameter, depending on whether the test should be
performed for a difference in location or in scale.</p>
</td></tr>
<tr><td><code id="compute_results_finite_+3A_method">method</code></td>
<td>
<p>a character string specifying how the p-value is computed with
possible values <code>"asymptotic"</code> for an asymptotic test
based on a normal approximation, <code>"permutation"</code> for a
permutation test, and <code>"randomization"</code> for a randomization
test. The permutation test uses all splits of the joint sample
into two samples of sizes <code>m</code> and <code>n</code>, while the
randomization test draws <code>n.rep</code> random splits with
replacement. The values <code>m</code> and <code>n</code> denote the
sample sizes.</p>
</td></tr>
<tr><td><code id="compute_results_finite_+3A_n.rep">n.rep</code></td>
<td>
<p>an integer value specifying the number of random splits used to
calculate the randomization distribution if <code>method = "randomization"</code>.</p>
</td></tr>
<tr><td><code id="compute_results_finite_+3A_type">type</code></td>
<td>
<p>a character string specifying the desired test statistic. It must
be one of <code>"HL11"</code>, <code>"HL12", "HL21", "HL22", "MED1"</code>,
and <code>"MED2"</code>, where <code>"HL1"</code>, <code>"HL2"</code> and
<code>"MED"</code> specify the location estimator and the numbers
<code>1</code> and <code>2</code> the scale estimator, see the vignette
(<code>vignette("robnptests")</code>) for more information.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named list containing the following components:
</p>
<table>
<tr><td><code>statistic</code></td>
<td>
<p>the value of the test statistic.</p>
</td></tr>
<tr><td><code>estimates</code></td>
<td>
<p>the location estimates for both samples in case of the HL1-
and the MED-tests. The estimate for the location difference
in case of the HL2-tests.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value for the test.</p>
</td></tr>
</table>

<hr>
<h2 id='hl1_test'>Two-sample location tests based on one-sample Hodges-Lehmann estimator</h2><span id='topic+hl1_test'></span>

<h3>Description</h3>

<p><code>hl1_test</code> performs a two-sample location test based on
the difference of the one-sample Hodges-Lehmann estimators of both samples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hl1_test(
  x,
  y,
  alternative = c("two.sided", "greater", "less"),
  delta = ifelse(scale.test, 1, 0),
  method = c("asymptotic", "permutation", "randomization"),
  scale = c("S1", "S2"),
  n.rep = 10000,
  na.rm = FALSE,
  scale.test = FALSE,
  wobble = FALSE,
  wobble.seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hl1_test_+3A_x">x</code></td>
<td>
<p>a (non-empty) numeric vector of data values.</p>
</td></tr>
<tr><td><code id="hl1_test_+3A_y">y</code></td>
<td>
<p>a (non-empty) numeric vector of data values.</p>
</td></tr>
<tr><td><code id="hl1_test_+3A_alternative">alternative</code></td>
<td>
<p>a character string specifying the alternative hypothesis,
must be one of &quot;two.sided&quot; (default), &quot;greater&quot;, or &quot;less&quot;.</p>
</td></tr>
<tr><td><code id="hl1_test_+3A_delta">delta</code></td>
<td>
<p>a numeric value indicating the true difference in the location or
scale parameter, depending on whether the test should be performed
for a difference in location or in scale. The default is
<code>delta = 0</code> for a location test and <code>delta = 1</code> for a scale
test. In case of <code>scale.test = TRUE</code>, <code>delta</code> represents
the ratio of the squared scale parameters.</p>
</td></tr>
<tr><td><code id="hl1_test_+3A_method">method</code></td>
<td>
<p>a character string specifying how the p-value is computed with
possible values <code>"asymptotic"</code> for an asymptotic test
based on a normal approximation, <code>"permutation"</code> for a
permutation test, and <code>"randomization"</code> for a randomization
test. The permutation test uses all splits of the joint sample
into two samples of sizes <code>m</code> and <code>n</code>, while the
randomization test draws <code>n.rep</code> random splits with
replacement. The values <code>m</code> and <code>n</code> denote the
sample sizes.
If not specified explicitly, defaults to
<code>"permutation"</code>  if <code>m &lt; 30</code>, <code>n &lt; 30</code> and
<code>n.rep &gt;= choose(m + n, m)</code>,
<code>"randomization"</code> if <code>m &lt; 30</code>, <code>n &lt; 30</code> and
<code>n.rep &lt; choose(m + n, m)</code>, and
<code>"asymptotic"</code> if <code>m &gt;= 30</code> and <code>n &gt;= 30</code>.</p>
</td></tr>
<tr><td><code id="hl1_test_+3A_scale">scale</code></td>
<td>
<p>a character string specifying the scale estimator used for standardization
of the test statistic; must be one of <code>"S1"</code> and <code>"S2"</code>.
The default is <code>"S1"</code>. Ignored if <code>method = "asymptotic"</code>;
see details for the definition of the scale estimators.</p>
</td></tr>
<tr><td><code id="hl1_test_+3A_n.rep">n.rep</code></td>
<td>
<p>an integer value specifying the number of random splits used to
calculate the randomization distribution if <code>method = "randomization"</code>.
This argument is ignored if <code>method = "permutation"</code> or <code>method = "asymptotic"</code>.
The default is <code>n.rep = 10000</code>.</p>
</td></tr>
<tr><td><code id="hl1_test_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical value indicating whether NA values in <code>x</code> and
<code>y</code> should be stripped before the computation proceeds. The
default is <code>na.rm = FALSE</code>.</p>
</td></tr>
<tr><td><code id="hl1_test_+3A_scale.test">scale.test</code></td>
<td>
<p>a logical value to specify if the samples should be compared
for a difference in scale. The default is <code>scale.test = FALSE</code>.</p>
</td></tr>
<tr><td><code id="hl1_test_+3A_wobble">wobble</code></td>
<td>
<p>a logical value indicating whether the sample should be checked for
duplicated values that can cause the scale estimate to be zero.
If such values are present, uniform noise is added to the sample,
see <code><a href="#topic+wobble">wobble</a></code>.
Only necessary for the permutation and randomization version of the test.
The default is <code>wobble = FALSE</code>.</p>
</td></tr>
<tr><td><code id="hl1_test_+3A_wobble.seed">wobble.seed</code></td>
<td>
<p>an integer value used as a seed for the random number
generation in case of <code>wobble = TRUE</code> or when
<code>scale.test = TRUE</code> with one of the vectors <code>x</code> and
<code>y</code> containing zeros. When no seed is specified, it
is chosen randomly and printed in a message. The argument
is ignored if <code>scale.test = FALSE</code> and/or <code>wobble = FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The test statistic for this test is based on the difference of the
one-sample Hodges-Lehmann estimators of <code>x</code> and <code>y</code>, see
<code><a href="#topic+hodges_lehmann">hodges_lehmann</a></code>. Three versions
of the test are implemented: randomization, permutation, and asymptotic.
</p>
<p>The test statistic for the permutation and randomization version of the test
is standardized using a robust scale estimator, see
(Fried and Dehling 2011).
</p>
<p>With <code>scale = "S1"</code>, the scale is estimated by
</p>
<p style="text-align: center;"><code class="reqn">S = med(|x_i - x_j|: 1 \le i &lt; j \le m, |y_i - y_j|, 1 \le i &lt; j \le n),</code>
</p>

<p>whereas <code>scale = "S2"</code> uses
</p>
<p style="text-align: center;"><code class="reqn">S = med(|z_i - z_j|: 1 \le i &lt; j \le m + n).</code>
</p>

<p>Here, <code class="reqn">z = (z_1, ..., z_{m + n}) = (x_1 - med(x), ..., x_m - med(x), y_1 - med(y), ..., y_n - med(y))</code>
is the median-corrected sample.
</p>
<p>The randomization distribution is based on randomly drawn splits with
replacement. The function <code><a href="statmod.html#topic+permp">permp</a></code> (Phipson and Smyth 2010)
is used to calculate the p-value. For the asymptotic test, a transformed version
of the difference of the HL1-estimators, which asymptotically follows a
normal distribution, is used. For more details on the asymptotic test, see
Fried and Dehling (2011).
</p>
<p>For <code>scale.test = TRUE</code>, the test compares the two samples for a difference
in scale. This is achieved by log-transforming the original squared observations,
i.e. <code>x</code> is replaced by <code>log(x^2)</code> and <code>y</code> by <code>log(y^2)</code>.
A potential scale difference then appears as a location difference between
the transformed samples, see Fried (2012).
Note that the samples need to have equal locations. The sample should not
contain zeros to prevent problems with the necessary log-transformation. If
it contains zeros, uniform noise is added to all variables in order to remove
zeros and a message is printed.
</p>
<p>If the sample has been modified (either because of zeros if <code>scale.test = TRUE</code>
or <code>wobble = TRUE</code>), the modified samples can be retrieved using
</p>
<p><code>set.seed(wobble.seed); wobble(x, y)</code>.
</p>
<p>Both samples need to contain at least 5 non-missing values.
</p>


<h3>Value</h3>

<p>A named list with class &quot;<code>htest</code>&quot; containing the following components:
</p>
<table>
<tr><td><code>statistic</code></td>
<td>
<p>the value of the test statistic.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value for the test.</p>
</td></tr>
<tr><td><code>estimate</code></td>
<td>
<p>the one-sample Hodges-Lehmann estimates of <code>x</code> and <code>y</code>
(if <code>scale.test = FALSE</code>) or of <code>log(x^2)</code> and
<code>log(y^2)</code> (if <code>scale.test = TRUE</code>).</p>
</td></tr>
<tr><td><code>null.value</code></td>
<td>
<p>the specified hypothesized value of the mean difference/squared
scale ratio.</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p>a character string describing the alternative hypothesis.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>a character string indicating how the p-value was computed.</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>a character string giving the names of the data.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Phipson B, Smyth GK (2010).
&ldquo;Permutation p-values should never be zero: Calculating exact p-values when permutations are randomly drawn.&rdquo;
<em>Statistical Applications in Genetics and Molecular Biology</em>, <b>9</b>(1), Article 39.
<a href="https://doi.org/10.2202/1544-6115.1585">doi:10.2202/1544-6115.1585</a>.
</p>
<p>Fried R, Dehling H (2011).
&ldquo;Robust nonparametric tests for the two-sample location problem.&rdquo;
<em>Statistical Methods &amp; Applications</em>, <b>20</b>(4), 409&ndash;422.
<a href="https://doi.org/10.1007/s10260-011-0164-1">doi:10.1007/s10260-011-0164-1</a>.
</p>
<p>Fried R (2012).
&ldquo;On the online estimation of piecewise constant volatilities.&rdquo;
<em>Computational Statistics &amp; Data Analysis</em>, <b>56</b>(11), 3080&ndash;3090.
<a href="https://doi.org/10.1016/j.csda.2011.02.012">doi:10.1016/j.csda.2011.02.012</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate random samples
set.seed(108)
x &lt;- rnorm(20); y &lt;- rnorm(20)

# Asymptotic HL1 test
hl1_test(x, y, method = "asymptotic", scale = "S1")

## Not run: 
# HL12 test using randomization principle by drawing 1000 random permutations
# with replacement

hl1_test(x, y, method = "randomization", n.rep = 1000, scale = "S2")

## End(Not run)

</code></pre>

<hr>
<h2 id='hl2_test'>Two-sample location tests based on two-sample Hodges-Lehmann estimator.</h2><span id='topic+hl2_test'></span>

<h3>Description</h3>

<p><code>hl2_test</code> performs a two-sample location test based on the two-sample
Hodges-Lehmann estimator for shift.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hl2_test(
  x,
  y,
  alternative = c("two.sided", "greater", "less"),
  delta = ifelse(scale.test, 1, 0),
  method = c("asymptotic", "permutation", "randomization"),
  scale = c("S1", "S2"),
  n.rep = 10000,
  na.rm = FALSE,
  scale.test = FALSE,
  wobble = FALSE,
  wobble.seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hl2_test_+3A_x">x</code></td>
<td>
<p>a (non-empty) numeric vector of data values.</p>
</td></tr>
<tr><td><code id="hl2_test_+3A_y">y</code></td>
<td>
<p>a (non-empty) numeric vector of data values.</p>
</td></tr>
<tr><td><code id="hl2_test_+3A_alternative">alternative</code></td>
<td>
<p>a character string specifying the alternative hypothesis,
must be one of &quot;two.sided&quot; (default), &quot;greater&quot;, or &quot;less&quot;.</p>
</td></tr>
<tr><td><code id="hl2_test_+3A_delta">delta</code></td>
<td>
<p>a numeric value indicating the true difference in the location or
scale parameter, depending on whether the test should be performed
for a difference in location or in scale. The default is
<code>delta = 0</code> for a location test and <code>delta = 1</code> for a scale
test. In case of <code>scale.test = TRUE</code>, <code>delta</code> represents
the ratio of the squared scale parameters.</p>
</td></tr>
<tr><td><code id="hl2_test_+3A_method">method</code></td>
<td>
<p>a character string specifying how the p-value is computed with
possible values <code>"asymptotic"</code> for an asymptotic test
based on a normal approximation, <code>"permutation"</code> for a
permutation test, and <code>"randomization"</code> for a randomization
test. The permutation test uses all splits of the joint sample
into two samples of sizes <code>m</code> and <code>n</code>, while the
randomization test draws <code>n.rep</code> random splits with
replacement. The values <code>m</code> and <code>n</code> denote the
sample sizes.
If not specified explicitly, defaults to
<code>"permutation"</code>  if <code>m &lt; 30</code>, <code>n &lt; 30</code> and
<code>n.rep &gt;= choose(m + n, m)</code>,
<code>"randomization"</code> if <code>m &lt; 30</code>, <code>n &lt; 30</code> and
<code>n.rep &lt; choose(m + n, m)</code>, and
<code>"asymptotic"</code> if <code>m &gt;= 30</code> and <code>n &gt;= 30</code>.</p>
</td></tr>
<tr><td><code id="hl2_test_+3A_scale">scale</code></td>
<td>
<p>a character string specifying the scale estimator used for standardization
of the test statistic; must be one of <code>"S1"</code> and <code>"S2"</code>.
The default is <code>"S1"</code>. Ignored if <code>method = "asymptotic"</code>;
see details for the definition of the scale estimators.</p>
</td></tr>
<tr><td><code id="hl2_test_+3A_n.rep">n.rep</code></td>
<td>
<p>an integer value specifying the number of random splits used to
calculate the randomization distribution if <code>method = "randomization"</code>.
This argument is ignored if <code>method = "permutation"</code> or <code>method = "asymptotic"</code>.
The default is <code>n.rep = 10000</code>.</p>
</td></tr>
<tr><td><code id="hl2_test_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical value indicating whether NA values in <code>x</code> and
<code>y</code> should be stripped before the computation proceeds. The
default is <code>na.rm = FALSE</code>.</p>
</td></tr>
<tr><td><code id="hl2_test_+3A_scale.test">scale.test</code></td>
<td>
<p>a logical value to specify if the samples should be compared
for a difference in scale. The default is <code>scale.test = FALSE</code>.</p>
</td></tr>
<tr><td><code id="hl2_test_+3A_wobble">wobble</code></td>
<td>
<p>a logical value indicating whether the sample should be checked for
duplicated values that can cause the scale estimate to be zero.
If such values are present, uniform noise is added to the sample,
see <code><a href="#topic+wobble">wobble</a></code>.
Only necessary for the permutation and randomization version of the test.
The default is <code>wobble = FALSE</code>.</p>
</td></tr>
<tr><td><code id="hl2_test_+3A_wobble.seed">wobble.seed</code></td>
<td>
<p>an integer value used as a seed for the random number
generation in case of <code>wobble = TRUE</code> or when
<code>scale.test = TRUE</code> with one of the vectors <code>x</code> and
<code>y</code> containing zeros. When no seed is specified, it
is chosen randomly and printed in a message. The argument
is ignored if <code>scale.test = FALSE</code> and/or <code>wobble = FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The test statistic for this test is based on the two-sample Hodges-Lehmann
estimator of <code>x</code> and <code>y</code>, see
<code><a href="#topic+hodges_lehmann_2sample">hodges_lehmann_2sample</a></code>. Three versions of the test
are implemented: randomization, permutation, and asymptotic.
</p>
<p>The test statistic for the permutation and randomization version of the test
is standardized using a robust scale estimator, see
(Fried and Dehling 2011).
</p>
<p>With <code>scale = "S1"</code>, the scale is estimated by
</p>
<p style="text-align: center;"><code class="reqn">S = med(|x_i - x_j|: 1 \le i &lt; j \le m, |y_i - y_j|, 1 \le i &lt; j \le n),</code>
</p>

<p>whereas <code>scale = "S2"</code> uses
</p>
<p style="text-align: center;"><code class="reqn">S = med(|z_i - z_j|: 1 \le i &lt; j \le m + n).</code>
</p>

<p>Here, <code class="reqn">z = (z_1, ..., z_{m + n}) = (x_1 - med(x), ..., x_m - med(x), y_1 - med(y), ..., y_n - med(y))</code>
is the median-corrected sample.
</p>
<p>The randomization distribution is based on randomly drawn splits with
replacement. The function <code><a href="statmod.html#topic+permp">permp</a></code> (Phipson and Smyth 2010)
is used to calculate the p-value. For the asymptotic test, a transformed version
of the HL2-estimator, which asymptotically follows a normal distribution, is
used. For more details on the asymptotic test, see Fried and Dehling (2011).
</p>
<p>For <code>scale.test = TRUE</code>, the test compares the two samples for a difference
in scale. This is achieved by log-transforming the original squared observations,
i.e. <code>x</code> is replaced by <code>log(x^2)</code> and <code>y</code> by <code>log(y^2)</code>.
A potential scale difference then appears as a location difference between
the transformed samples, see Fried (2012).
Note that the samples need to have equal locations. The sample should not
contain zeros to prevent problems with the necessary log-transformation. If
it contains zeros, uniform noise is added to all variables in order to remove
zeros and a message is printed.
</p>
<p>If the sample has been modified (either because of zeros if <code>scale.test = TRUE</code>
or <code>wobble = TRUE</code>), the modified samples can be retrieved using
</p>
<p><code>set.seed(wobble.seed); wobble(x, y)</code>.
</p>
<p>Both samples need to contain at least 5 non-missing values.
</p>


<h3>Value</h3>

<p>A named list with class &quot;<code>htest</code>&quot; containing the following components:
</p>
<table>
<tr><td><code>statistic</code></td>
<td>
<p>the value of the test statistic.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value for the test.</p>
</td></tr>
<tr><td><code>estimate</code></td>
<td>
<p>the estimated location difference between <code>x</code> and <code>y</code>
(if <code>scale.test = FALSE</code>) or of <code>log(x^2)</code> and
<code>log(y^2)</code> (if <code>scale.test = TRUE</code>) based on the
two-sample Hodges-Lehmann estimator.</p>
</td></tr>
<tr><td><code>null.value</code></td>
<td>
<p>the specified hypothesized value of the mean difference/squared
scale ratio.</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p>a character string describing the alternative hypothesis.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>a character string indicating how the p-value was computed.</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>a character string giving the names of the data.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Phipson B, Smyth GK (2010).
&ldquo;Permutation p-values should never be zero: Calculating exact p-values when permutations are randomly drawn.&rdquo;
<em>Statistical Applications in Genetics and Molecular Biology</em>, <b>9</b>(1), Article 39.
<a href="https://doi.org/10.2202/1544-6115.1585">doi:10.2202/1544-6115.1585</a>.
</p>
<p>Fried R, Dehling H (2011).
&ldquo;Robust nonparametric tests for the two-sample location problem.&rdquo;
<em>Statistical Methods &amp; Applications</em>, <b>20</b>(4), 409&ndash;422.
<a href="https://doi.org/10.1007/s10260-011-0164-1">doi:10.1007/s10260-011-0164-1</a>.
</p>
<p>Fried R (2012).
&ldquo;On the online estimation of piecewise constant volatilities.&rdquo;
<em>Computational Statistics &amp; Data Analysis</em>, <b>56</b>(11), 3080&ndash;3090.
<a href="https://doi.org/10.1016/j.csda.2011.02.012">doi:10.1016/j.csda.2011.02.012</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate random samples
set.seed(108)
x &lt;- rnorm(20); y &lt;- rnorm(20)

# Asymptotic HL2 test
hl2_test(x, y, method = "asymptotic", scale = "S1")

## Not run: 
# HL22 test using randomization principle by drawing 1000 random permutations
# with replacement

hl2_test(x, y, method = "randomization", n.rep = 1000, scale = "S2")

## End(Not run)

</code></pre>

<hr>
<h2 id='hodges_lehmann'>One-sample Hodges-Lehmann estimator</h2><span id='topic+hodges_lehmann'></span>

<h3>Description</h3>

<p><code>hodges_lehmann</code> calculates the one-sample Hodges-Lehmann estimator
of a sample.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hodges_lehmann(x, na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hodges_lehmann_+3A_x">x</code></td>
<td>
<p>a (non-empty) numeric vector of data values.</p>
</td></tr>
<tr><td><code id="hodges_lehmann_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical value indicating whether NA values in <code>x</code> and
<code>y</code> should be stripped before the computation proceeds. The
default is <code>na.rm = FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The one-sample Hodges-Lehmann estimator for a sample of size <code>n</code>
is defined as
</p>
<p style="text-align: center;"><code class="reqn">med(\frac{X_i + X_j}{2},  1 \le i &lt; j \le m).</code>
</p>



<h3>Value</h3>

<p>The one-sample Hodges-Lehmann estimator.
</p>


<h3>References</h3>

<p>Hodges JL, Lehmann EL (1963).
&ldquo;Estimates of location based on rank tests.&rdquo;
<em>The Annals of Mathematical Statistics</em>, <b>34</b>(2), 598&ndash;611.
<a href="https://doi.org/10.1214/aoms/1177704172">doi:10.1214/aoms/1177704172</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate random sample
set.seed(108)
x &lt;- rnorm(10)

# Compute one-sample Hodges-Lehmann estimator
hodges_lehmann(x)

</code></pre>

<hr>
<h2 id='hodges_lehmann_2sample'>Two-sample Hodges-Lehmann estimator</h2><span id='topic+hodges_lehmann_2sample'></span>

<h3>Description</h3>

<p><code>hodges_lehmann_2sample</code> calculates the two-sample Hodges-Lehmann
estimator for the location difference of two samples x and y.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hodges_lehmann_2sample(x, y, na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hodges_lehmann_2sample_+3A_x">x</code></td>
<td>
<p>a (non-empty) numeric vector of data values.</p>
</td></tr>
<tr><td><code id="hodges_lehmann_2sample_+3A_y">y</code></td>
<td>
<p>a (non-empty) numeric vector of data values.</p>
</td></tr>
<tr><td><code id="hodges_lehmann_2sample_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical value indicating whether NA values in <code>x</code> and
<code>y</code> should be stripped before the computation proceeds. The
default is <code>na.rm = FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The two-sample Hodges-Lehmann estimator for two samples <code>x</code>
and <code>y</code> of sizes <code>m</code> and <code>n</code> is defined as
</p>
<p style="text-align: center;"><code class="reqn">med(|x_i - y_j|, 1 \le i \le m, 1 \le j \le n).</code>
</p>



<h3>Value</h3>

<p>The two-sample Hodges-Lehmann estimator.
</p>


<h3>References</h3>

<p>Hodges JL, Lehmann EL (1963).
&ldquo;Estimates of location based on rank tests.&rdquo;
<em>The Annals of Mathematical Statistics</em>, <b>34</b>(2), 598&ndash;611.
<a href="https://doi.org/10.1214/aoms/1177704172">doi:10.1214/aoms/1177704172</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate random samples
set.seed(108)
x &lt;- rnorm(10); y &lt;- rnorm(10)

# Compute two-sample Hodges-Lehmann estimator
hodges_lehmann_2sample(x, y)

</code></pre>

<hr>
<h2 id='m_est'>M-estimator of location</h2><span id='topic+m_est'></span>

<h3>Description</h3>

<p><code>m_est</code> calculates an M-estimate of location and its variance
for different psi functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>m_est(
  x,
  psi,
  k = robustbase::.Mpsi.tuning.default(psi),
  tol = 1e-06,
  max.it = 15,
  na.rm = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="m_est_+3A_x">x</code></td>
<td>
<p>a (non-empty) numeric vector of data values.</p>
</td></tr>
<tr><td><code id="m_est_+3A_psi">psi</code></td>
<td>
<p>kernel used for optimization.
Must be one of <code>"bisquare"</code>, <code>"hampel"</code> and <code>"huber"</code>.
The default is <code>"huber"</code>.</p>
</td></tr>
<tr><td><code id="m_est_+3A_k">k</code></td>
<td>
<p>tuning parameter(s) for the respective kernel function,
defaults to parameters implemented in <code><a href="robustbase.html#topic+lmrob.control">.Mpsi.tuning.default(psi)</a></code>
in the package <a href="https://cran.r-project.org/package=robustbase">robustbase</a>.</p>
</td></tr>
<tr><td><code id="m_est_+3A_tol">tol</code></td>
<td>
<p>tolerance for convergence. The default is 1e-06.</p>
</td></tr>
<tr><td><code id="m_est_+3A_max.it">max.it</code></td>
<td>
<p>the maximum number of iterations. The default is 15.</p>
</td></tr>
<tr><td><code id="m_est_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical value indicating whether NA values in <code>x</code> and
<code>y</code> should be stripped before the computation proceeds. The
default is <code>na.rm = FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To compute the M-estimate, the iterative algorithm described in
Maronna et al. (2019) is used.
The variance is estimated as in Huber (1981).
</p>
<p>If <code>max.it</code> contains decimal places, it is truncated to an integer
value.
</p>


<h3>Value</h3>

<p>A named list containing the components:
</p>
<table>
<tr><td><code>est</code></td>
<td>
<p>estimated mean.</p>
</td></tr>
<tr><td><code>var</code></td>
<td>
<p>estimated variance.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Maronna RA, Martin DR, Yohai VJ, Salibián-Barrera M (2019).
<em>Robust Statistics: Theory and Methods (with R)</em>,  Wiley Series in Probability and Statistics, Second edition edition.
Wiley.
<a href="https://doi.org/10.1002/9781119214656">doi:10.1002/9781119214656</a>.
</p>
<p>Huber PJ (1981).
<em>Robust Statistics</em>.
Wiley, New York.
<a href="https://doi.org/10.1002/0471725250">doi:10.1002/0471725250</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Generate random sample
set.seed(108)
x &lt;- rnorm(10)

# Computer Huber's M-estimate
m_est(x, psi = "huber")

</code></pre>

<hr>
<h2 id='m_est_perm_distribution'>Permutation distribution for M-statistics</h2><span id='topic+m_est_perm_distribution'></span>

<h3>Description</h3>

<p><code>mest_perm_distribution</code> calculates the permutation distribution for the M-statistics from
<code>m_test_statistic</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>m_est_perm_distribution(x, y, psi, k, randomization = FALSE, n.rep = 10000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="m_est_perm_distribution_+3A_x">x</code></td>
<td>
<p>a (non-empty) numeric vector of data values.</p>
</td></tr>
<tr><td><code id="m_est_perm_distribution_+3A_y">y</code></td>
<td>
<p>a (non-empty) numeric vector of data values.</p>
</td></tr>
<tr><td><code id="m_est_perm_distribution_+3A_psi">psi</code></td>
<td>
<p>kernel used for optimization.
Must be one of <code>"bisquare"</code>, <code>"hampel"</code> and <code>"huber"</code>.
The default is <code>"huber"</code>.</p>
</td></tr>
<tr><td><code id="m_est_perm_distribution_+3A_k">k</code></td>
<td>
<p>tuning parameter(s) for the respective kernel function,
defaults to parameters implemented in <code><a href="robustbase.html#topic+lmrob.control">.Mpsi.tuning.default(psi)</a></code>
in the package <a href="https://cran.r-project.org/package=robustbase">robustbase</a>.</p>
</td></tr>
<tr><td><code id="m_est_perm_distribution_+3A_randomization">randomization</code></td>
<td>
<p>a logical value indicating whether the p-value should be
computed from a permutation (<code>FALSE</code>, default) or a
randomization (<code>TRUE</code>) distribution.</p>
</td></tr>
<tr><td><code id="m_est_perm_distribution_+3A_n.rep">n.rep</code></td>
<td>
<p>an integer value specifying the number of random splits used to
calculate the randomization distribution if <code>method = "randomization"</code>.
The default is <code>n.rep = 10000</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Missing values in either <code>x</code> or <code>y</code> are not allowed.
</p>


<h3>Value</h3>

<p>Vector with permutation distribution of the test statistic specified by <code>psi</code>
and <code>k</code>.
</p>


<h3>References</h3>

<p>Maechler M, Rousseeuw P, Croux C, Todorov V, Ruckstuhl A, Salibián-Barrera M, Verbeke T, Koller M, Conceicao EL, di Palma MA (2022).
<em>robustbase: Basic robust statistics</em>.
R package version 0.95-0, <a href="https://CRAN.R-project.org/package=robustbase">https://CRAN.R-project.org/package=robustbase</a>.
</p>

<hr>
<h2 id='m_test'>Two sample location test based on M-estimators</h2><span id='topic+m_test'></span>

<h3>Description</h3>

<p><code>m_test</code> performs a two-sample location test based on an M-estimator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>m_test(
  x,
  y,
  alternative = c("two.sided", "greater", "less"),
  delta = ifelse(scale.test, 1, 0),
  method = c("asymptotic", "permutation", "randomization"),
  psi = c("huber", "hampel", "bisquare"),
  k = robustbase::.Mpsi.tuning.default(psi),
  n.rep = 10000,
  na.rm = FALSE,
  scale.test = FALSE,
  wobble.seed = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="m_test_+3A_x">x</code></td>
<td>
<p>a (non-empty) numeric vector of data values.</p>
</td></tr>
<tr><td><code id="m_test_+3A_y">y</code></td>
<td>
<p>a (non-empty) numeric vector of data values.</p>
</td></tr>
<tr><td><code id="m_test_+3A_alternative">alternative</code></td>
<td>
<p>a character string specifying the alternative hypothesis,
must be one of &quot;two.sided&quot; (default), &quot;greater&quot;, or &quot;less&quot;.</p>
</td></tr>
<tr><td><code id="m_test_+3A_delta">delta</code></td>
<td>
<p>a numeric value indicating the true difference in the location or
scale parameter, depending on whether the test should be performed
for a difference in location or in scale. The default is
<code>delta = 0</code> for a location test and <code>delta = 1</code> for a scale
test. In case of <code>scale.test = TRUE</code>, <code>delta</code> represents
the ratio of the squared scale parameters.</p>
</td></tr>
<tr><td><code id="m_test_+3A_method">method</code></td>
<td>
<p>a character string specifying how the p-value is computed with
possible values <code>"asymptotic"</code> for an asymptotic test
based on a normal approximation, <code>"permutation"</code> for a
permutation test, and <code>"randomization"</code> for a randomization
test. The permutation test uses all splits of the joint sample
into two samples of sizes <code>m</code> and <code>n</code>, while the
randomization test draws <code>n.rep</code> random splits with
replacement. The values <code>m</code> and <code>n</code> denote the
sample sizes.
If not specified explicitly, defaults to
<code>"permutation"</code>  if <code>m &lt; 30</code>, <code>n &lt; 30</code> and
<code>n.rep &gt;= choose(m + n, m)</code>,
<code>"randomization"</code> if <code>m &lt; 30</code>, <code>n &lt; 30</code> and
<code>n.rep &lt; choose(m + n, m)</code>, and
<code>"asymptotic"</code> if <code>m &gt;= 30</code> and <code>n &gt;= 30</code>.</p>
</td></tr>
<tr><td><code id="m_test_+3A_psi">psi</code></td>
<td>
<p>kernel used for optimization.
Must be one of <code>"bisquare"</code>, <code>"hampel"</code> and <code>"huber"</code>.
The default is <code>"huber"</code>.</p>
</td></tr>
<tr><td><code id="m_test_+3A_k">k</code></td>
<td>
<p>tuning parameter(s) for the respective kernel function,
defaults to parameters implemented in <code><a href="robustbase.html#topic+lmrob.control">.Mpsi.tuning.default(psi)</a></code>
in the package <a href="https://cran.r-project.org/package=robustbase">robustbase</a>.</p>
</td></tr>
<tr><td><code id="m_test_+3A_n.rep">n.rep</code></td>
<td>
<p>an integer value specifying the number of random splits used to
calculate the randomization distribution if <code>method = "randomization"</code>.
This argument is ignored if <code>method = "permutation"</code> or <code>method = "asymptotic"</code>.
The default is <code>n.rep = 10000</code>.</p>
</td></tr>
<tr><td><code id="m_test_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical value indicating whether NA values in <code>x</code> and
<code>y</code> should be stripped before the computation proceeds. The
default is <code>na.rm = FALSE</code>.</p>
</td></tr>
<tr><td><code id="m_test_+3A_scale.test">scale.test</code></td>
<td>
<p>a logical value to specify if the samples should be compared
for a difference in scale. The default is <code>scale.test = FALSE</code>.</p>
</td></tr>
<tr><td><code id="m_test_+3A_wobble.seed">wobble.seed</code></td>
<td>
<p>an integer value used as a seed for the random number
generation in case that <code>scale.test = TRUE</code>
and one of the vectors <code>x</code> and
<code>y</code> contains zeros. When no seed is specified, it
is chosen randomly and printed in a message. The argument
is ignored if <code>scale.test = FALSE</code>.</p>
</td></tr>
<tr><td><code id="m_test_+3A_...">...</code></td>
<td>
<p>additional arguments <code>c1</code> and <code>c2</code> that can be passed to
the function <code>scaleTau2()</code>, which is used internally for
estimating the within-sample dispersion, in order to account for
non-normal distributions; see Maronna and Zamar (2002).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The test statistic for this test is based on the difference of the M-estimates
of location of <code>x</code> and <code>y</code>, see <code><a href="#topic+m_est">m_est</a></code>.
</p>
<p>Three different psi-functions can be used: <code>huber</code>, <code>hampel</code>, and
<code>bisquare</code>. The corresponding tuning parameter(s) can be set by the
argument <code>k</code> of the function.
</p>
<p>The estimate for the location difference is scaled by a pooled estimate for
the standard deviation. This estimate is based on the
tau-estimate of scale and is computed with the default parameter settings
of the function <code><a href="robustbase.html#topic+scaleTau2">scaleTau2</a></code>. These can be changed if
by setting <code>c1</code> and <code>c2</code>.
</p>
<p>More details on the construction of the test statistic are given in the
vignettes <code>vignette("robnptests")</code> and
<code>vignette("m_tests")</code>.
</p>
<p>Three versions of the test are implemented: randomization, permutation, and
asymptotic.
</p>
<p>The randomization distribution is based on randomly drawn splits with
replacement. The function <code><a href="statmod.html#topic+permp">permp</a></code> (Phipson and Smyth 2010)
is used to calculate the p-value. The psi-function for the the M-estimate
is computed with the implementations in the package
<a href="https://cran.r-project.org/package=robustbase">robustbase</a>.
</p>
<p>For the asymptotic test, the distribution of the test statistic is approximated
by a standard normal distribution.
However, this is only justified under the normality assumption. When the
observations do not come from a normal distribution, the tests might not keep
the desired significance level. Simulations indicate that the level is kept
under symmetric distributions if the variance exists. Under skewed
distributions, it tends to be anti-conservative, see the vignette
<code>vignette("m_tests")</code>. The test statistic can be corrected by a
factor which has to be determined individually for a specific distribution in
such cases.
</p>
<p>For <code>scale.test = TRUE</code>, the test compares the two samples for a difference
in scale. This is achieved by log-transforming the original squared observations,
i.e. <code>x</code> is replaced by <code>log(x^2)</code> and <code>y</code> by <code>log(y^2)</code>.
A potential scale difference then appears as a location difference between
the transformed samples, see Fried (2012).
Note that the samples need to have equal locations. The sample should not
contain zeros to prevent problems with the necessary log-transformation. If
it contains zeros, uniform noise is added to all variables in order to remove
zeros and a message is printed.
</p>
<p>If the sample has been modified because of zeros when <code>scale.test = TRUE</code>,
the modified samples can be retrieved using
</p>
<p><code>set.seed(wobble.seed); wobble(x, y)</code>
</p>
<p>Both samples need to contain at least 5 non-missing values.
</p>


<h3>Value</h3>

<p>A named list with class &quot;<code>htest</code>&quot; containing the following components:
</p>
<table>
<tr><td><code>statistic</code></td>
<td>
<p>the value of the test statistic.</p>
</td></tr>
<tr><td><code>parameter</code></td>
<td>
<p>the degrees of freedom for the test statistic.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value for the test.</p>
</td></tr>
<tr><td><code>estimate</code></td>
<td>
<p>the M-estimates of <code>x</code> and <code>y</code>
(if <code>scale.test = FALSE</code>) or of <code>log(x^2)</code> and
<code>log(y^2)</code> (if <code>scale.test = TRUE</code>).</p>
</td></tr>
<tr><td><code>null.value</code></td>
<td>
<p>the specified hypothesized value of the mean difference/squared
scale ratio.</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p>a character string describing the alternative hypothesis.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>a character string indicating how the p-value was computed.</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>a character string giving the names of the data.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Fried R (2012).
&ldquo;On the online estimation of piecewise constant volatilities.&rdquo;
<em>Computational Statistics &amp; Data Analysis</em>, <b>56</b>(11), 3080&ndash;3090.
<a href="https://doi.org/10.1016/j.csda.2011.02.012">doi:10.1016/j.csda.2011.02.012</a>.
</p>
<p>Maronna RA, Zamar RH (2002).
&ldquo;Robust estimates of location and dispersion of high-dimensional datasets.&rdquo;
<em>Technometrics</em>, <b>44</b>(4), 307&ndash;317.
<a href="https://doi.org/10.1198/004017002188618509">doi:10.1198/004017002188618509</a>.
</p>
<p>Phipson B, Smyth GK (2010).
&ldquo;Permutation p-values should never be zero: Calculating exact p-values when permutations are randomly drawn.&rdquo;
<em>Statistical Applications in Genetics and Molecular Biology</em>, <b>9</b>(1), Article 39.
<a href="https://doi.org/10.2202/1544-6115.1585">doi:10.2202/1544-6115.1585</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate random samples
set.seed(108)
x &lt;- rnorm(20); y &lt;- rnorm(20)

# Asymptotic test based on Huber M-estimator
m_test(x, y, method = "asymptotic", psi = "huber")

## Not run: 
# Randomization test based on Hampel M-estimator with 1000 random permutations
# drawn with replacement

m_test(x, y, method = "randomization", n.rep = 1000, psi = "hampel")

## End(Not run)

</code></pre>

<hr>
<h2 id='m_test_statistic'>Test statistics for the M-tests</h2><span id='topic+m_test_statistic'></span>

<h3>Description</h3>

<p><code>m_test_statistic</code> calculates the test statistics for
tests based on M-estimators.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>m_test_statistic(x, y, psi, k = robustbase::.Mpsi.tuning.default(psi), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="m_test_statistic_+3A_x">x</code></td>
<td>
<p>a (non-empty) numeric vector of data values.</p>
</td></tr>
<tr><td><code id="m_test_statistic_+3A_y">y</code></td>
<td>
<p>a (non-empty) numeric vector of data values.</p>
</td></tr>
<tr><td><code id="m_test_statistic_+3A_psi">psi</code></td>
<td>
<p>kernel used for optimization.
Must be one of <code>"bisquare"</code>, <code>"hampel"</code> and <code>"huber"</code>.
The default is <code>"huber"</code>.</p>
</td></tr>
<tr><td><code id="m_test_statistic_+3A_k">k</code></td>
<td>
<p>tuning parameter(s) for the respective kernel function,
defaults to parameters implemented in <code><a href="robustbase.html#topic+lmrob.control">.Mpsi.tuning.default(psi)</a></code>
in the package <a href="https://cran.r-project.org/package=robustbase">robustbase</a>.</p>
</td></tr>
<tr><td><code id="m_test_statistic_+3A_...">...</code></td>
<td>
<p>additional arguments <code>c1</code> and <code>c2</code> that can be passed to
the function <code>scaleTau2()</code>, which is used internally for
estimating the within-sample dispersion, in order to account for
non-normal distributions; see Maronna and Zamar (2002).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For details on how the test statistic is constructed, we refer to the
vignette <code>vignette("m_tests")</code>
</p>


<h3>Value</h3>

<p>A named list containing the following components:
</p>
<table>
<tr><td><code>statistic</code></td>
<td>
<p>standardized test statistic.</p>
</td></tr>
<tr><td><code>estimates</code></td>
<td>
<p>M-estimates of location for both <code>x</code> and <code>y</code>.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># Generate random samples
set.seed(108)
x &lt;- rnorm(20); y &lt;- rnorm(20)

# Compute Huber-M-statistic
m_test_statistic(x, y, psi = "huber")

</code></pre>

<hr>
<h2 id='med_test'>Two-sample location tests based on the sample median</h2><span id='topic+med_test'></span>

<h3>Description</h3>

<p><code>med_test</code> performs a two-sample location test based on
the difference of the sample medians for both samples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>med_test(
  x,
  y,
  alternative = c("two.sided", "greater", "less"),
  delta = ifelse(scale.test, 1, 0),
  method = c("asymptotic", "permutation", "randomization"),
  scale = c("S3", "S4"),
  n.rep = 10000,
  na.rm = FALSE,
  scale.test = FALSE,
  wobble = FALSE,
  wobble.seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="med_test_+3A_x">x</code></td>
<td>
<p>a (non-empty) numeric vector of data values.</p>
</td></tr>
<tr><td><code id="med_test_+3A_y">y</code></td>
<td>
<p>a (non-empty) numeric vector of data values.</p>
</td></tr>
<tr><td><code id="med_test_+3A_alternative">alternative</code></td>
<td>
<p>a character string specifying the alternative hypothesis,
must be one of &quot;two.sided&quot; (default), &quot;greater&quot;, or &quot;less&quot;.</p>
</td></tr>
<tr><td><code id="med_test_+3A_delta">delta</code></td>
<td>
<p>a numeric value indicating the true difference in the location or
scale parameter, depending on whether the test should be performed
for a difference in location or in scale. The default is
<code>delta = 0</code> for a location test and <code>delta = 1</code> for a scale
test. In case of <code>scale.test = TRUE</code>, <code>delta</code> represents
the ratio of the squared scale parameters.</p>
</td></tr>
<tr><td><code id="med_test_+3A_method">method</code></td>
<td>
<p>a character string specifying how the p-value is computed with
possible values <code>"asymptotic"</code> for an asymptotic test
based on a normal approximation, <code>"permutation"</code> for a
permutation test, and <code>"randomization"</code> for a randomization
test. The permutation test uses all splits of the joint sample
into two samples of sizes <code>m</code> and <code>n</code>, while the
randomization test draws <code>n.rep</code> random splits with
replacement. The values <code>m</code> and <code>n</code> denote the
sample sizes.
If not specified explicitly, defaults to
<code>"permutation"</code>  if <code>m &lt; 30</code>, <code>n &lt; 30</code> and
<code>n.rep &gt;= choose(m + n, m)</code>,
<code>"randomization"</code> if <code>m &lt; 30</code>, <code>n &lt; 30</code> and
<code>n.rep &lt; choose(m + n, m)</code>, and
<code>"asymptotic"</code> if <code>m &gt;= 30</code> and <code>n &gt;= 30</code>.</p>
</td></tr>
<tr><td><code id="med_test_+3A_scale">scale</code></td>
<td>
<p>a character string specifying the scale estimator used for standardization
of the test statistic, must be one of <code>"S3"</code> and <code>"S4"</code>.
The default is <code>"S3"</code>. Ignored if <code>method = "asymptotic"</code>;
see details for the definition of the scale estimators.</p>
</td></tr>
<tr><td><code id="med_test_+3A_n.rep">n.rep</code></td>
<td>
<p>an integer value specifying the number of random splits used to
calculate the randomization distribution if <code>method = "randomization"</code>.
This argument is ignored if <code>method = "permutation"</code> or <code>method = "asymptotic"</code>.
The default is <code>n.rep = 10000</code>.</p>
</td></tr>
<tr><td><code id="med_test_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical value indicating whether NA values in <code>x</code> and
<code>y</code> should be stripped before the computation proceeds. The
default is <code>na.rm = FALSE</code>.</p>
</td></tr>
<tr><td><code id="med_test_+3A_scale.test">scale.test</code></td>
<td>
<p>a logical value to specify if the samples should be compared
for a difference in scale. The default is <code>scale.test = FALSE</code>.</p>
</td></tr>
<tr><td><code id="med_test_+3A_wobble">wobble</code></td>
<td>
<p>a logical value indicating whether the sample should be checked for
duplicated values that can cause the scale estimate to be zero.
If such values are present, uniform noise is added to the sample,
see <code><a href="#topic+wobble">wobble</a></code>.
Only necessary for the permutation and randomization version of the test.
The default is <code>wobble = FALSE</code>.</p>
</td></tr>
<tr><td><code id="med_test_+3A_wobble.seed">wobble.seed</code></td>
<td>
<p>an integer value used as a seed for the random number
generation in case of <code>wobble = TRUE</code> or when
<code>scale.test = TRUE</code> with one of the vectors <code>x</code> and
<code>y</code> containing zeros. When no seed is specified, it
is chosen randomly and printed in a message. The argument
is ignored if <code>scale.test = FALSE</code> and/or <code>wobble = FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The test statistic for this test is based on the difference of the sample
medians of <code>x</code> and <code>y</code>. Three versions of the test are implemented:
randomization, permutation, and asymptotic.
</p>
<p>The test statistic for the permutation and randomization version of the test
is standardized using a robust scale estimator, see
(Fried and Dehling 2011).
</p>
<p>With <code>scale = "S3"</code>, the scale is estimated by
</p>
<p style="text-align: center;"><code class="reqn">S = 2 * (|x_1 - med(x)|, ..., |x_m - med(x)|, |y_1 - med(y)|, ..., |y_n - med(y)|),</code>
</p>

<p>whereas <code>scale = "S4"</code> uses
</p>
<p style="text-align: center;"><code class="reqn">S = (med(|x_1 - med(x)|, ..., |x_m - med(x)|) + med(|y_1 - med(y)|, ..., |y_n - med(y)|).</code>
</p>

<p>When computing the randomization distribution based on randomly drawn splits with
replacement, the function <code><a href="statmod.html#topic+permp">permp</a></code> (Phipson and Smyth 2010)
is used to calculate the p-value. For the asymptotic test, a transformed version
of the difference of the sample medians, which asymptotically follows a normal
distribution, is used. For more details on the asymptotic test, see
Fried and Dehling (2011).
</p>
<p>For <code>scale.test = TRUE</code>, the test compares the two samples for a difference
in scale. This is achieved by log-transforming the original squared observations,
i.e. <code>x</code> is replaced by <code>log(x^2)</code> and <code>y</code> by <code>log(y^2)</code>.
A potential scale difference then appears as a location difference between
the transformed samples, see Fried (2012).
Note that the samples need to have equal locations. The sample should not
contain zeros to prevent problems with the necessary log-transformation. If
it contains zeros, uniform noise is added to all variables in order to remove
zeros and a message is printed.
</p>
<p>If the sample has been modified (either because of zeros for <code>scale.test = TRUE</code>,
or <code>wobble = TRUE</code>), the modified samples can be retrieved using
</p>
<p><code>set.seed(wobble.seed); wobble(x, y)</code>
</p>
<p>Both samples need to contain at least 5 non-missing values.
</p>


<h3>Value</h3>

<p>A named list with class &quot;<code>htest</code>&quot; containing the following components:
</p>
<table>
<tr><td><code>statistic</code></td>
<td>
<p>the value of the test statistic.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value for the test.</p>
</td></tr>
<tr><td><code>estimate</code></td>
<td>
<p>the sample medians of <code>x</code> and <code>y</code>
(if <code>scale.test = FALSE</code>) or of <code>log(x^2)</code> and
<code>log(y^2)</code> (if <code>scale.test = TRUE</code>).</p>
</td></tr>
<tr><td><code>null.value</code></td>
<td>
<p>the specified hypothesized value of the mean difference/squared
scale ratio.</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p>a character string describing the alternative hypothesis.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>a character string indicating how the p-value was computed.</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>a character string giving the names of the data.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Phipson B, Smyth GK (2010).
&ldquo;Permutation p-values should never be zero: Calculating exact p-values when permutations are randomly drawn.&rdquo;
<em>Statistical Applications in Genetics and Molecular Biology</em>, <b>9</b>(1), Article 39.
<a href="https://doi.org/10.2202/1544-6115.1585">doi:10.2202/1544-6115.1585</a>.
</p>
<p>Fried R, Dehling H (2011).
&ldquo;Robust nonparametric tests for the two-sample location problem.&rdquo;
<em>Statistical Methods &amp; Applications</em>, <b>20</b>(4), 409&ndash;422.
<a href="https://doi.org/10.1007/s10260-011-0164-1">doi:10.1007/s10260-011-0164-1</a>.
</p>
<p>Fried R (2012).
&ldquo;On the online estimation of piecewise constant volatilities.&rdquo;
<em>Computational Statistics &amp; Data Analysis</em>, <b>56</b>(11), 3080&ndash;3090.
<a href="https://doi.org/10.1016/j.csda.2011.02.012">doi:10.1016/j.csda.2011.02.012</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate random samples
set.seed(108)
x &lt;- rnorm(20); y &lt;- rnorm(20)

# Asymptotic MED test
med_test(x, y, method = "asymptotic", scale = "S3")

## Not run: 
# MED2 test using randomization principle by drawing 1000 random permutations
# with replacement

med_test(x, y, method = "randomization", n.rep = 1000, scale = "S4")

## End(Not run)

</code></pre>

<hr>
<h2 id='perm_distribution'>Permutation distribution for robust test statistics</h2><span id='topic+perm_distribution'></span>

<h3>Description</h3>

<p><code>perm_distribution()</code> calculates the permutation distribution for
several test statistics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>perm_distribution(x, y, type, randomization = FALSE, n.rep = 10000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="perm_distribution_+3A_x">x</code></td>
<td>
<p>a (non-empty) numeric vector of data values.</p>
</td></tr>
<tr><td><code id="perm_distribution_+3A_y">y</code></td>
<td>
<p>a (non-empty) numeric vector of data values.</p>
</td></tr>
<tr><td><code id="perm_distribution_+3A_type">type</code></td>
<td>
<p>a character string specifying the desired test statistic. It must
be one of <code>"HL11"</code> (default),
<code>"HL12", "HL21", "HL22", "MED1"</code>, and <code>"MED2"</code>, where
<code>"HL1"</code>, <code>"HL2"</code> and <code>"MED"</code> specify the location
estimator and the numbers <code>1</code> and <code>2</code> the scale
estimator, see the vignette
<code>vignette("robnptests")</code> for more information.</p>
</td></tr>
<tr><td><code id="perm_distribution_+3A_randomization">randomization</code></td>
<td>
<p>a logical value indicating whether the p-value should be
computed from a permutation (<code>FALSE</code>, default) or a
randomization (<code>TRUE</code>) distribution.</p>
</td></tr>
<tr><td><code id="perm_distribution_+3A_n.rep">n.rep</code></td>
<td>
<p>an integer value specifying the number of random splits used to
calculate the randomization distribution if <code>method = "randomization"</code>.
The default is <code>n.rep = 10000</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Missing values in either <code>x</code> or <code>y</code> are not allowed.
</p>


<h3>Value</h3>

<p>Vector with permutation distribution of the test statistic specified
by <code>type</code>.
</p>

<hr>
<h2 id='preprocess_data'>Preprocess data for the robust two sample tests</h2><span id='topic+preprocess_data'></span>

<h3>Description</h3>

<p><code>preprocess_data</code> is a helper function that performs several
preprocessing steps on the data before performing the two-sample tests.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>preprocess_data(x, y, delta, na.rm, wobble, wobble.seed, scale.test)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="preprocess_data_+3A_x">x</code></td>
<td>
<p>a (non-empty) numeric vector of data values.</p>
</td></tr>
<tr><td><code id="preprocess_data_+3A_y">y</code></td>
<td>
<p>a (non-empty) numeric vector of data values.</p>
</td></tr>
<tr><td><code id="preprocess_data_+3A_delta">delta</code></td>
<td>
<p>a numeric value indicating the true difference in the location
or scale parameter, depending on whether the test should be
performed for a difference in location or in scale.</p>
</td></tr>
<tr><td><code id="preprocess_data_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical value indicating whether NA values in <code>x</code> and <code>y</code>
should be stripped before the computation proceeds.</p>
</td></tr>
<tr><td><code id="preprocess_data_+3A_wobble">wobble</code></td>
<td>
<p>a logical value indicating whether the sample should be checked for
duplicated values that can cause the scale estimate to be zero.
If such values are present, uniform noise is added to the sample,
see <code><a href="#topic+wobble">wobble</a></code>.</p>
</td></tr>
<tr><td><code id="preprocess_data_+3A_wobble.seed">wobble.seed</code></td>
<td>
<p>an integer value used as a seed for the random number
generation in case of <code>wobble = TRUE</code> or when
<code>scale.test = TRUE</code> with one of the vectors <code>x</code> and
<code>y</code> containing zeros. When no seed is specified, it
is chosen randomly and printed in a message. The argument
is ignored if <code>scale.test = FALSE</code> and/or <code>wobble = FALSE</code>.</p>
</td></tr>
<tr><td><code id="preprocess_data_+3A_scale.test">scale.test</code></td>
<td>
<p>a logical value to specify if the samples should be compared
for a difference in scale.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The preprocessing steps include the removal of missing values and, if
specified, wobbling and a transformation of the observations to test for
differences in scale.
</p>


<h3>Value</h3>

<p>A named list containing the following components:
</p>
<table>
<tr><td><code>x</code></td>
<td>
<p>the (possibly transformed) input vector <code>x</code>.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>the (possibly transformed) input vector <code>y</code>.</p>
</td></tr>
<tr><td><code>delta</code></td>
<td>
<p>the (possibly transformed) input value
<code>delta</code>.</p>
</td></tr>
</table>

<hr>
<h2 id='rob_perm_statistic'>Robust test statistics based on robust location estimators</h2><span id='topic+rob_perm_statistic'></span>

<h3>Description</h3>

<p><code>rob_perm_statistic</code> calculates test statistics for robust
permutation/randomization tests based on the sample median, the one-sample
Hodges-Lehmann estimator, or the two-sample Hodges-Lehmann estimator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rob_perm_statistic(
  x,
  y,
  type = c("HL11", "HL12", "HL21", "HL22", "MED1", "MED2"),
  na.rm = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rob_perm_statistic_+3A_x">x</code></td>
<td>
<p>a (non-empty) numeric vector of data values.</p>
</td></tr>
<tr><td><code id="rob_perm_statistic_+3A_y">y</code></td>
<td>
<p>a (non-empty) numeric vector of data values.</p>
</td></tr>
<tr><td><code id="rob_perm_statistic_+3A_type">type</code></td>
<td>
<p>a character string specifying the desired test statistic. It must
be one of <code>"HL11"</code> (default),
<code>"HL12", "HL21", "HL22", "MED1"</code>, and <code>"MED2"</code>, where
<code>"HL1"</code>, <code>"HL2"</code> and <code>"MED"</code> specify the location
estimator and the numbers <code>1</code> and <code>2</code> the scale
estimator, see the vignette
<code>vignette("robnptests")</code> for more information.</p>
</td></tr>
<tr><td><code id="rob_perm_statistic_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical value indicating whether NA values in <code>x</code> and
<code>y</code> should be stripped before the computation proceeds. The
default is <code>na.rm = FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The test statistics returned by <code>rob_perm_statistic</code> are of the
form </p>
<p style="text-align: center;"><code class="reqn">D_i/S_j</code>
</p>
<p> where the D_i, i = 1,...,3, are different
estimators of location and the S_j, j = 1,...,4, are estimates for
the mutual sample scale. See Fried and Dehling (2011)
or the vignette <code>vignette("robnptests")</code> for details.
</p>


<h3>Value</h3>

<p>A named list containing the following components:
</p>
<table>
<tr><td><code>statistic</code></td>
<td>
<p>the selected test statistic.</p>
</td></tr>
<tr><td><code>estimates</code></td>
<td>
<p>estimate of location for each sample if available.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Fried R, Dehling H (2011).
&ldquo;Robust nonparametric tests for the two-sample location problem.&rdquo;
<em>Statistical Methods &amp; Applications</em>, <b>20</b>(4), 409&ndash;422.
<a href="https://doi.org/10.1007/s10260-011-0164-1">doi:10.1007/s10260-011-0164-1</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate random samples
set.seed(108)
x &lt;- rnorm(20); y &lt;- rnorm(20)

# Compute HL21-statistic
rob_perm_statistic(x, y, type = "HL21")

</code></pre>

<hr>
<h2 id='rob_scale'>Robust scale estimators based on median absolute deviation</h2><span id='topic+rob_scale'></span>

<h3>Description</h3>

<p><code>rob_scale</code> calculates an estimator for the within-sample dispersion
based on two samples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rob_scale(
  x,
  y,
  type = c("S1", "S2", "S3", "S4"),
  na.rm = FALSE,
  check.for.zero = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rob_scale_+3A_x">x</code></td>
<td>
<p>a (non-empty) numeric vector of data values.</p>
</td></tr>
<tr><td><code id="rob_scale_+3A_y">y</code></td>
<td>
<p>a (non-empty) numeric vector of data values.</p>
</td></tr>
<tr><td><code id="rob_scale_+3A_type">type</code></td>
<td>
<p>character that specifies the estimator for the variance, can be
<code>"S1"</code>, <code>"S2"</code>, <code>"S3"</code> and <code>"S4"</code>;
see details for description of the scale estimators.</p>
</td></tr>
<tr><td><code id="rob_scale_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical value indicating whether NA values in <code>x</code> and
<code>y</code> should be stripped before the computation proceeds. The
default is <code>na.rm = FALSE</code>.</p>
</td></tr>
<tr><td><code id="rob_scale_+3A_check.for.zero">check.for.zero</code></td>
<td>
<p>logical value indicating a warning should be triggered
if the scale estimate is zero. The default is
<code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For definitions of the scale estimators, see Fried and Dehling (2011).
</p>
<p>If <code>check.for.zero = TRUE</code>, an error is thrown when the scale estimate
is zero. This argument is only included because the function is used in
<code><a href="#topic+rob_perm_statistic">rob_perm_statistic</a></code> to compute values of robust test statistics
where the scale estimate is used for standardization. A scale estimate of zero
leads to a non-existing test statistic, so that the corresponding test cannot
be performed.
</p>


<h3>Value</h3>

<p>An estimate of the pooled variance of the two samples.
</p>


<h3>References</h3>

<p>Fried R, Dehling H (2011).
&ldquo;Robust nonparametric tests for the two-sample location problem.&rdquo;
<em>Statistical Methods &amp; Applications</em>, <b>20</b>(4), 409&ndash;422.
<a href="https://doi.org/10.1007/s10260-011-0164-1">doi:10.1007/s10260-011-0164-1</a>.
</p>

<hr>
<h2 id='select_method'>Select principle for computing null distribution</h2><span id='topic+select_method'></span>

<h3>Description</h3>

<p><code>select_method</code> is a helper function that chooses the principle for
computing the null distribution of a two-sample test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>select_method(x, y, method, test.name, n.rep)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="select_method_+3A_x">x</code></td>
<td>
<p>a (non-empty) numeric vector of data values.</p>
</td></tr>
<tr><td><code id="select_method_+3A_y">y</code></td>
<td>
<p>a (non-empty) numeric vector of data values.</p>
</td></tr>
<tr><td><code id="select_method_+3A_method">method</code></td>
<td>
<p>a character string specifying how the p-value is computed with
possible values <code>"asymptotic"</code> for an asymptotic test
based on a normal approximation, <code>"permutation"</code> for a
permutation test, and <code>"randomization"</code> for a randomization
test. The permutation test uses all splits of the joint sample
into two samples of sizes <code>m</code> and <code>n</code>, while the
randomization test draws <code>n.rep</code> random splits with
replacement. The values <code>m</code> and <code>n</code> denote the
sample sizes.</p>
</td></tr>
<tr><td><code id="select_method_+3A_test.name">test.name</code></td>
<td>
<p>character string specifying the two-sample test for which
the helper function is used.</p>
</td></tr>
<tr><td><code id="select_method_+3A_n.rep">n.rep</code></td>
<td>
<p>an integer value specifying the number of random splits used to
calculate the randomization distribution if
<code>method = "randomization"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When the principle is specified by the user, i.e. <code>method</code> contains only
one element, the selected method is returned. Otherwise, if the user
does not specify the principle, it depends on the sample size: When both
samples contain more than 30 observations, an asymptotic test is performed.
If one of the samples contains less than 30 observations, the null
distribution is computed via the randomization principle. The number of
replications <code>n.rep</code> for the randomization test needs to be specified
outside of this function. Each test function contains the argument
<code>n.rep</code> where this can be done.
</p>
<p>If <code>n.rep</code> is larger than the maximum number of splits and
<code>method = "randomization"</code>, a permutation test is performed.
</p>


<h3>Value</h3>

<p>A character string, which specifies the principle for computing the
null distribution.
</p>

<hr>
<h2 id='trim_mean'>Trimmed mean</h2><span id='topic+trim_mean'></span>

<h3>Description</h3>

<p><code>trim_mean</code> calculates a trimmed mean of a sample.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trim_mean(x, gamma = 0.2, na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="trim_mean_+3A_x">x</code></td>
<td>
<p>a (non-empty) numeric vector of data values.</p>
</td></tr>
<tr><td><code id="trim_mean_+3A_gamma">gamma</code></td>
<td>
<p>a numeric value in [0, 0.5] specifying the fraction of observations
to be trimmed from each end of the sample before calculating the
mean. The default value is 0.2.</p>
</td></tr>
<tr><td><code id="trim_mean_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical value indicating whether NA values in <code>x</code> and
<code>y</code> should be stripped before the computation proceeds. The
default is <code>na.rm = FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a wrapper function for the function <code><a href="base.html#topic+mean">mean</a></code>.
</p>


<h3>Value</h3>

<p>The trimmed mean.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate random sample
set.seed(108)
x &lt;- rnorm(10)

# Compute 20% trimmed mean
trim_mean(x, gamma = 0.2)

</code></pre>

<hr>
<h2 id='trimmed_t'>Test statistic for the two-sample trimmed t-test (Yuen's t-test)</h2><span id='topic+trimmed_t'></span>

<h3>Description</h3>

<p><code>trimmed_t</code> calculates the test statistic for the two-sample trimmed t-test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trimmed_t(x, y, gamma = 0.2, na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="trimmed_t_+3A_x">x</code></td>
<td>
<p>a (non-empty) numeric vector of data values.</p>
</td></tr>
<tr><td><code id="trimmed_t_+3A_y">y</code></td>
<td>
<p>a (non-empty) numeric vector of data values.</p>
</td></tr>
<tr><td><code id="trimmed_t_+3A_gamma">gamma</code></td>
<td>
<p>a numeric value in [0, 0.5] specifying the fraction of observations
to be trimmed from each end of the sample before calculating the
mean. The default value is 0.2.</p>
</td></tr>
<tr><td><code id="trimmed_t_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical value indicating whether NA values in <code>x</code> and
<code>y</code> should be stripped before the computation proceeds. The
default is <code>na.rm = FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named list containing the following components:
</p>
<table>
<tr><td><code>statistic</code></td>
<td>
<p>the value of the test statistic.</p>
</td></tr>
<tr><td><code>estimates</code></td>
<td>
<p>the trimmed means for both samples.</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>the degrees of freedom for the test statistic.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Yuen KK, Dixon WT (1973).
&ldquo;The approximate behaviour and performance of the two-sample trimmed t.&rdquo;
<em>Biometrika</em>, <b>60</b>(2), 369&ndash;374.
<a href="https://doi.org/10.2307/2334550">doi:10.2307/2334550</a>.
</p>
<p>Yuen KK (1974).
&ldquo;The two-sample trimmed t for unequal population variances.&rdquo;
<em>Biometrika</em>, <b>61</b>(1), 165&ndash;170.
<a href="https://doi.org/10.2307/2334299">doi:10.2307/2334299</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate random samples
set.seed(108)
x &lt;- rnorm(20); y &lt;- rnorm(20)

# Compute trimmed t-statistic
trimmed_t(x, y, gamma = 0.2)

</code></pre>

<hr>
<h2 id='trimmed_test'>Two-sample trimmed t-test (Yuen's t-Test)</h2><span id='topic+trimmed_test'></span>

<h3>Description</h3>

<p><code>trimmed_test</code> performs the two-sample trimmed t-test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trimmed_test(
  x,
  y,
  gamma = 0.2,
  alternative = c("two.sided", "less", "greater"),
  method = c("asymptotic", "permutation", "randomization"),
  delta = ifelse(scale.test, 1, 0),
  n.rep = 1000,
  na.rm = FALSE,
  scale.test = FALSE,
  wobble.seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="trimmed_test_+3A_x">x</code></td>
<td>
<p>a (non-empty) numeric vector of data values.</p>
</td></tr>
<tr><td><code id="trimmed_test_+3A_y">y</code></td>
<td>
<p>a (non-empty) numeric vector of data values.</p>
</td></tr>
<tr><td><code id="trimmed_test_+3A_gamma">gamma</code></td>
<td>
<p>a numeric value in [0, 0.5] specifying the fraction of observations
to be trimmed from each end of the sample before calculating the
mean. The default value is 0.2.</p>
</td></tr>
<tr><td><code id="trimmed_test_+3A_alternative">alternative</code></td>
<td>
<p>a character string specifying the alternative hypothesis,
must be one of &quot;two.sided&quot; (default), &quot;greater&quot;, or &quot;less&quot;.</p>
</td></tr>
<tr><td><code id="trimmed_test_+3A_method">method</code></td>
<td>
<p>a character string specifying how the p-value is computed with
possible values <code>"asymptotic"</code> for an asymptotic test
based on a normal approximation, <code>"permutation"</code> for a
permutation test, and <code>"randomization"</code> for a randomization
test. The permutation test uses all splits of the joint sample
into two samples of sizes <code>m</code> and <code>n</code>, while the
randomization test draws <code>n.rep</code> random splits with
replacement. The values <code>m</code> and <code>n</code> denote the
sample sizes.
If not specified explicitly, defaults to
<code>"permutation"</code>  if <code>m &lt; 30</code>, <code>n &lt; 30</code> and
<code>n.rep &gt;= choose(m + n, m)</code>,
<code>"randomization"</code> if <code>m &lt; 30</code>, <code>n &lt; 30</code> and
<code>n.rep &lt; choose(m + n, m)</code>, and
<code>"asymptotic"</code> if <code>m &gt;= 30</code> and <code>n &gt;= 30</code>.</p>
</td></tr>
<tr><td><code id="trimmed_test_+3A_delta">delta</code></td>
<td>
<p>a numeric value indicating the true difference in the location or
scale parameter, depending on whether the test should be performed
for a difference in location or in scale. The default is
<code>delta = 0</code> for a location test and <code>delta = 1</code> for a scale
test. In case of <code>scale.test = TRUE</code>, <code>delta</code> represents
the ratio of the squared scale parameters.</p>
</td></tr>
<tr><td><code id="trimmed_test_+3A_n.rep">n.rep</code></td>
<td>
<p>an integer value specifying the number of random splits used to
calculate the randomization distribution if <code>method = "randomization"</code>.
This argument is ignored if <code>method = "permutation"</code> or <code>method = "asymptotic"</code>.
The default is <code>n.rep = 10000</code>.</p>
</td></tr>
<tr><td><code id="trimmed_test_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical value indicating whether NA values in <code>x</code> and
<code>y</code> should be stripped before the computation proceeds. The
default is <code>na.rm = FALSE</code>.</p>
</td></tr>
<tr><td><code id="trimmed_test_+3A_scale.test">scale.test</code></td>
<td>
<p>a logical value to specify if the samples should be compared
for a difference in scale. The default is <code>scale.test = FALSE</code>.</p>
</td></tr>
<tr><td><code id="trimmed_test_+3A_wobble.seed">wobble.seed</code></td>
<td>
<p>an integer value used as a seed for the random number
generation in case of <code>wobble = TRUE</code> or when
<code>scale.test = TRUE</code> with one of the vectors <code>x</code> and
<code>y</code> containing zeros. When no seed is specified, it
is chosen randomly and printed in a message. The argument
is ignored if <code>scale.test = FALSE</code> and/or <code>wobble = FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function performs Yuen's t-test based on the trimmed mean and winsorized
variance (Yuen and Dixon 1973).
The amount of trimming/winsorization is set in <code>gamma</code> and
defaults to 0.2, i.e. 20% of the values are removed/replaced.
In addition to the asymptotic distribution a permutation and a
randomization version of the test are implemented.
</p>
<p>When computing a randomization distribution based on randomly drawn splits
with replacement, the function <code><a href="statmod.html#topic+permp">permp</a></code> (Phipson and Smyth 2010)
is used to calculate the p-value.
</p>
<p>For <code>scale.test = TRUE</code>, the test compares the two samples for a difference
in scale. This is achieved by log-transforming the original squared observations,
i.e. <code>x</code> is replaced by <code>log(x^2)</code> and <code>y</code> by <code>log(y^2)</code>.
A potential scale difference then appears as a location difference between
the transformed samples, see Fried (2012).
Note that the samples need to have equal locations. The sample should not
contain zeros to prevent problems with the necessary log-transformation. If
it contains zeros, uniform noise is added to all variables in order to remove
zeros and a message is printed.
</p>
<p>If the sample has been modified because of zeros when <code>scale.test = TRUE</code>,
the modified samples can be retrieved using
</p>
<p><code>set.seed(wobble.seed); wobble(x, y)</code>
</p>
<p>Both samples need to contain at least 5 non-missing values.
</p>


<h3>Value</h3>

<p>A named list with class &quot;<code>htest</code>&quot; containing the following components:
</p>
<table>
<tr><td><code>statistic</code></td>
<td>
<p>the value of the test statistic.</p>
</td></tr>
<tr><td><code>parameter</code></td>
<td>
<p>the degrees of freedom for the test statistic.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value for the test.</p>
</td></tr>
<tr><td><code>estimate</code></td>
<td>
<p>the trimmed means of <code>x</code> and <code>y</code>
(if <code>scale.test = FALSE</code>) or of <code>log(x^2)</code> and
<code>log(y^2)</code> (if <code>scale.test = TRUE</code>).</p>
</td></tr>
<tr><td><code>null.value</code></td>
<td>
<p>the specified hypothesized value of the mean difference/squared
scale ratio.</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p>a character string describing the alternative hypothesis.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>a character string indicating how the p-value was computed.</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>a character string giving the names of the data.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Yuen KK, Dixon WT (1973).
&ldquo;The approximate behaviour and performance of the two-sample trimmed t.&rdquo;
<em>Biometrika</em>, <b>60</b>(2), 369&ndash;374.
<a href="https://doi.org/10.2307/2334550">doi:10.2307/2334550</a>.
</p>
<p>Yuen KK (1974).
&ldquo;The two-sample trimmed t for unequal population variances.&rdquo;
<em>Biometrika</em>, <b>61</b>(1), 165&ndash;170.
<a href="https://doi.org/10.2307/2334299">doi:10.2307/2334299</a>.
</p>
<p>Fried R (2012).
&ldquo;On the online estimation of piecewise constant volatilities.&rdquo;
<em>Computational Statistics &amp; Data Analysis</em>, <b>56</b>(11), 3080&ndash;3090.
<a href="https://doi.org/10.1016/j.csda.2011.02.012">doi:10.1016/j.csda.2011.02.012</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate random samples
set.seed(108)
x &lt;- rnorm(20); y &lt;- rnorm(20)

# Trimmed t-test
trimmed_test(x, y, gamma = 0.1)

</code></pre>

<hr>
<h2 id='win_mean'>Winsorized mean</h2><span id='topic+win_mean'></span>

<h3>Description</h3>

<p><code>win_mean</code> calculates the winsorized mean of a sample.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>win_mean(x, gamma = 0.2, na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="win_mean_+3A_x">x</code></td>
<td>
<p>a (non-empty) numeric vector of data values.</p>
</td></tr>
<tr><td><code id="win_mean_+3A_gamma">gamma</code></td>
<td>
<p>a numeric value in [0, 0.5] specifying the fraction of observations
to be replaced at each end of the sample before calculating the
mean. The default value is 0.2.</p>
</td></tr>
<tr><td><code id="win_mean_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical value indicating whether NA values in <code>x</code> and
<code>y</code> should be stripped before the computation proceeds. The
default is <code>na.rm = FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The winsorized mean.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate random samples
set.seed(108)
x &lt;- rnorm(10)

# Compute 20% winsorized mean
win_mean(x, gamma = 0.2)

</code></pre>

<hr>
<h2 id='win_var'>Winsorized variance</h2><span id='topic+win_var'></span>

<h3>Description</h3>

<p><code>win_var</code> calculates the winsorized variance of a sample.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>win_var(x, gamma = 0, na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="win_var_+3A_x">x</code></td>
<td>
<p>a (non-empty) numeric vector of data values.</p>
</td></tr>
<tr><td><code id="win_var_+3A_gamma">gamma</code></td>
<td>
<p>a numeric value in [0, 0.5] specifying the fraction of observations
to be replaced at each end of the sample before calculating the
mean. The default value is 0.2.</p>
</td></tr>
<tr><td><code id="win_var_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical value indicating whether NA values in <code>x</code> and
<code>y</code> should be stripped before the computation proceeds. The
default is <code>na.rm = FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named list containing the following items:
</p>
<table>
<tr><td><code>var</code></td>
<td>
<p>winsorized variance.</p>
</td></tr>
<tr><td><code>h</code></td>
<td>
<p>degrees of freedom used for tests based on trimmed means and the
winsorized variance.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># Generate random sample
set.seed(108)
x &lt;- rnorm(10)

# Compute 20% winsorized variance
win_var(x, gamma = 0.2)

</code></pre>

<hr>
<h2 id='wobble'>Add random noise to remove ties</h2><span id='topic+wobble'></span>

<h3>Description</h3>

<p><code>wobble</code> adds noise from a continuous uniform distribution to the
observations to remove ties.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wobble(x, y, check = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wobble_+3A_x">x</code></td>
<td>
<p>a (non-empty) numeric vector of data values.</p>
</td></tr>
<tr><td><code id="wobble_+3A_y">y</code></td>
<td>
<p>a (non-empty) numeric vector of data values.</p>
</td></tr>
<tr><td><code id="wobble_+3A_check">check</code></td>
<td>
<p>a logical value indicating whether the samples should be checked
for bindings prior to adding uniform noise or not, defaults to
<code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>check = TRUE</code> the function checks whether all values in the two numeric
input vectors are distinct. If so, it returns the original values, otherwise
the ties are removed by adding noise from a continuous uniform distribution
to all observations. If <code>check = FALSE</code>, it simply determines the number
of digits and adds uniform noise.
</p>
<p>More precisely, we determine the minimum number of digits <code>d_min</code> in the sample
and then add random numbers from the U[-0.5 10^(-<code>d_min</code>), 0.5 10^(-<code>d_min</code>)]
distribution to each of the observations.
</p>


<h3>Value</h3>

<p>A named list of length two containing the modified input samples <code>x</code> and
<code>y</code>.
</p>


<h3>References</h3>

<p>Fried R, Gather U (2007).
&ldquo;On rank tests for shift detection in time series.&rdquo;
<em>Computational Statistics &amp; Data Analysis</em>, <b>52</b>(1), 221&ndash;233.
<a href="https://doi.org/10.1016/j.csda.2006.12.017">doi:10.1016/j.csda.2006.12.017</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- rnorm(20); y &lt;- rnorm(20); x &lt;- round(x)
wobble(x, y)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
