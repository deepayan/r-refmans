<!DOCTYPE html><html><head><title>Help for package HDShOP</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {HDShOP}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Class_MeanVar_portfolio'><p>S3 class MeanVar_portfolio</p></a></li>
<li><a href='#CovarEstim'><p>Covariance matrix estimator</p></a></li>
<li><a href='#CovShrinkBGP14'><p>Linear shrinkage estimator of the covariance matrix</p>
(Bodnar et al. 2014)</a></li>
<li><a href='#HDShOP-package'><p>A set of tools for shrinkage estimation of mean-variance optimal portfolios</p></a></li>
<li><a href='#InvCovShrinkBGP16'><p>Linear shrinkage estimator of the inverse covariance matrix</p>
(Bodnar et al. 2016)</a></li>
<li><a href='#mean_bop19'><p>BOP shrinkage estimator</p></a></li>
<li><a href='#mean_bs'><p>Bayes-Stein shrinkage estimator of the mean vector</p></a></li>
<li><a href='#mean_js'><p>James-Stein shrinkage estimator of the mean vector</p></a></li>
<li><a href='#MeanEstim'><p>Mean vector estimator</p></a></li>
<li><a href='#MeanVar_portfolio'><p>A helper function for MeanVar_portfolio</p></a></li>
<li><a href='#MVShrinkPortfolio'><p>Shrinkage mean-variance portfolio</p></a></li>
<li><a href='#new_GMV_portfolio_weights_BDPS19'><p>Constructor of GMV portfolio object.</p></a></li>
<li><a href='#new_MeanVar_portfolio'><p>A constructor for class MeanVar_portfolio</p></a></li>
<li><a href='#new_MV_portfolio_traditional'><p>Traditional mean-variance portfolio</p></a></li>
<li><a href='#new_MV_portfolio_weights_BDOPS21'><p>Constructor of MV portfolio object</p></a></li>
<li><a href='#nonlin_shrinkLW'><p>nonlinear shrinkage estimator of the covariance matrix of</p>
Ledoit and Wolf (2020)</a></li>
<li><a href='#plot_frontier'><p>Plot the Bayesian efficient frontier (Bauder et al. 2021) and the</p>
provided portfolios.</a></li>
<li><a href='#RandCovMtrx'><p>Covariance matrix generator</p></a></li>
<li><a href='#Sigma_sample_estimator'><p>Sample covariance matrix</p></a></li>
<li><a href='#SP_daily_asset_returns'><p>Daily  log-returns  of selected constituents S&amp;P500.</p></a></li>
<li><a href='#test_MVSP'><p>Test for mean-variance portfolio weights</p></a></li>
<li><a href='#validate_MeanVar_portfolio'><p>A validator for objects of class MeanVar_portfolio</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>High-Dimensional Shrinkage Optimal Portfolios</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.5</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Dmitry Otryakhin &lt;d.otryakhin.acad@protonmail.ch&gt;</td>
</tr>
<tr>
<td>Author:</td>
<td>Taras Bodnar <a href="https://orcid.org/0000-0001-7855-8221"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Solomiia Dmytriv <a href="https://orcid.org/0000-0003-1855-3044"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Yarema Okhrin <a href="https://orcid.org/0000-0003-4704-5233"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Dmitry Otryakhin <a href="https://orcid.org/0000-0002-4700-7221"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Nestor Parolya <a href="https://orcid.org/0000-0003-2147-2288"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Description:</td>
<td>Constructs shrinkage estimators of high-dimensional mean-variance portfolios and performs 
    high-dimensional tests on optimality of a given portfolio. The techniques developed in 
    Bodnar et al. (2018 &lt;<a href="https://doi.org/10.1016%2Fj.ejor.2017.09.028">doi:10.1016/j.ejor.2017.09.028</a>&gt;, 2019 &lt;<a href="https://doi.org/10.1109%2FTSP.2019.2929964">doi:10.1109/TSP.2019.2929964</a>&gt;, 
    2020 &lt;<a href="https://doi.org/10.1109%2FTSP.2020.3037369">doi:10.1109/TSP.2020.3037369</a>&gt;, 2021 &lt;<a href="https://doi.org/10.1080%2F07350015.2021.2004897">doi:10.1080/07350015.2021.2004897</a>&gt;) 
    are central to the package. They provide simple and feasible estimators and tests for optimal 
    portfolio weights, which are applicable for 'large p and large n' situations where p is the 
    portfolio dimension (number of stocks) and n is the sample size. The package also includes tools
    for constructing portfolios based on shrinkage estimators of the mean vector and covariance matrix
    as well as a new Bayesian estimator for the Markowitz efficient frontier recently developed by 
    Bauder et al. (2021) &lt;<a href="https://doi.org/10.1080%2F14697688.2020.1748214">doi:10.1080/14697688.2020.1748214</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/Otryakhin-Dmitry/global-minimum-variance-portfolio">https://github.com/Otryakhin-Dmitry/global-minimum-variance-portfolio</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/Otryakhin-Dmitry/global-minimum-variance-portfolio/issues">https://github.com/Otryakhin-Dmitry/global-minimum-variance-portfolio/issues</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rdpack, lattice</td>
</tr>
<tr>
<td>Suggests:</td>
<td>ggplot2, testthat, EstimDiagnostics, MASS, corpcor, waldo</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>Rdpack</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-24 22:18:04 UTC; otryakhin-d</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-25 05:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='Class_MeanVar_portfolio'>S3 class MeanVar_portfolio</h2><span id='topic+Class_MeanVar_portfolio'></span>

<h3>Description</h3>

<p>Class MeanVar_portfolio is designed to construct mean-variance portfolios
with provided estimators of the mean vector, covariance matrix, and
inverse covariance matrix. It includes the following elements:
</p>


<h3>Slots</h3>


<table>
<tr>
 <td style="text-align: left;">
   Element </td><td style="text-align: left;"> Description </td>
</tr>
<tr>
 <td style="text-align: left;">
   call </td><td style="text-align: left;"> the function call with which it was created </td>
</tr>
<tr>
 <td style="text-align: left;">
   cov_mtrx </td><td style="text-align: left;"> the sample covariance matrix of the asset returns </td>
</tr>
<tr>
 <td style="text-align: left;">
   inv_cov_mtrx </td><td style="text-align: left;"> the inverse of the sample covariance matrix </td>
</tr>
<tr>
 <td style="text-align: left;">
   means </td><td style="text-align: left;"> sample mean vector of the asset returns </td>
</tr>
<tr>
 <td style="text-align: left;">
   weights </td><td style="text-align: left;"> portfolio weights </td>
</tr>
<tr>
 <td style="text-align: left;">
   Port_Var </td><td style="text-align: left;"> portfolio variance </td>
</tr>
<tr>
 <td style="text-align: left;">
   Port_mean_return </td><td style="text-align: left;"> expected portfolio return </td>
</tr>
<tr>
 <td style="text-align: left;">
   Sharpe </td><td style="text-align: left;"> portfolio Sharpe ratio </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>See Also</h3>

<p>summary.MeanVar_portfolio summary method for the class,
<a href="#topic+new_MeanVar_portfolio">new_MeanVar_portfolio</a> class constructor,
<a href="#topic+validate_MeanVar_portfolio">validate_MeanVar_portfolio</a> class validator,
<a href="#topic+MeanVar_portfolio">MeanVar_portfolio</a> class helper.
</p>

<hr>
<h2 id='CovarEstim'>Covariance matrix estimator</h2><span id='topic+CovarEstim'></span>

<h3>Description</h3>

<p>It is a function dispatcher for covariance matrix estimation. One can choose
between traditional and shrinkage-based estimators.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CovarEstim(x, type = c("trad", "BGP14", "LW20"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CovarEstim_+3A_x">x</code></td>
<td>
<p>a p by n matrix or a data frame of asset returns. Rows represent
different assets, columns &ndash; observations.</p>
</td></tr>
<tr><td><code id="CovarEstim_+3A_type">type</code></td>
<td>
<p>a character. The estimation method to be used.</p>
</td></tr>
<tr><td><code id="CovarEstim_+3A_...">...</code></td>
<td>
<p>arguments to pass to estimators</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The available estimation methods are:</p>

<table>
<tr>
 <td style="text-align: left;">
   Function </td><td style="text-align: left;"> Paper </td><td style="text-align: left;"> Type </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+Sigma_sample_estimator">Sigma_sample_estimator</a></code> </td><td style="text-align: left;">  </td><td style="text-align: left;"> traditional </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+CovShrinkBGP14">CovShrinkBGP14</a></code> </td><td style="text-align: left;"> Bodnar et al 2014 </td><td style="text-align: left;"> BGP14 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+nonlin_shrinkLW">nonlin_shrinkLW</a></code> </td><td style="text-align: left;"> Ledoit &amp; Wolf 2020 </td><td style="text-align: left;"> LW20 </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Value</h3>

<p>an object of class matrix
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n&lt;-3e2 # number of realizations
p&lt;-.5*n # number of assets

x &lt;- matrix(data = rnorm(n*p), nrow = p, ncol = n)

Mtrx_trad &lt;- CovarEstim(x, type="trad")

TM &lt;- matrix(0, p, p)
diag(TM) &lt;- 1
Mtrx_bgp &lt;- CovarEstim(x, type="BGP14", TM=TM)

Mtrx_lw &lt;- CovarEstim(x, type="LW20")
</code></pre>

<hr>
<h2 id='CovShrinkBGP14'>Linear shrinkage estimator of the covariance matrix
(Bodnar et al. 2014)</h2><span id='topic+CovShrinkBGP14'></span>

<h3>Description</h3>

<p>The optimal linear shrinkage estimator of the covariance matrix that
minimizes the Frobenius norm:
</p>
<p style="text-align: center;"><code class="reqn">\hat{\Sigma}_{OLSE} = \hat{\alpha} S + \hat{\beta} \Sigma_0,</code>
</p>

<p>where <code class="reqn">\hat{\alpha}</code> and <code class="reqn">\hat{\beta}</code> are optimal shrinkage
intensities given in Eq. (4.3) and (4.4) of
Bodnar et al. (2014). <code class="reqn">S</code> is the sample covariance
matrix (SCM, see <code><a href="#topic+Sigma_sample_estimator">Sigma_sample_estimator</a></code>) and <code class="reqn">\Sigma_0</code>
is a positive definite symmetric matrix used as the target matrix (TM),
for example, <code class="reqn">\frac{1}{p} I</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CovShrinkBGP14(n, TM, SCM)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CovShrinkBGP14_+3A_n">n</code></td>
<td>
<p>sample size.</p>
</td></tr>
<tr><td><code id="CovShrinkBGP14_+3A_tm">TM</code></td>
<td>
<p>the target matrix for the shrinkage estimator.</p>
</td></tr>
<tr><td><code id="CovShrinkBGP14_+3A_scm">SCM</code></td>
<td>
<p>sample covariance matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list containing an object of class matrix (S) and the estimated
shrinkage intensities <code class="reqn">\hat{\alpha}</code> and <code class="reqn">\hat{\beta}</code>.
</p>


<h3>References</h3>

<p>Bodnar T, Gupta AK, Parolya N (2014).
&ldquo;On the strong convergence of the optimal linear shrinkage estimator for large dimensional covariance matrix.&rdquo;
<em>Journal of Multivariate Analysis</em>, <b>132</b>, 215&ndash;228.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Parameter setting
n&lt;-3e2
c&lt;-0.7
p&lt;-c*n
mu &lt;- rep(0, p)
Sigma &lt;- RandCovMtrx(p=p)

# Generating observations
X &lt;- t(MASS::mvrnorm(n=n, mu=mu, Sigma=Sigma))

# Estimation
TM &lt;- matrix(0, nrow=p, ncol=p)
diag(TM) &lt;- 1/p
SCM &lt;- Sigma_sample_estimator(X)
Sigma_shr &lt;- CovShrinkBGP14(n=n, TM=TM, SCM=SCM)
Sigma_shr$S[1:6, 1:6]
</code></pre>

<hr>
<h2 id='HDShOP-package'>A set of tools for shrinkage estimation of mean-variance optimal portfolios</h2><span id='topic+HDShOP'></span><span id='topic+HDShOP-package'></span>

<h3>Description</h3>

<p>Package HDShOP has the following three important functions:
<code><a href="#topic+MVShrinkPortfolio">MVShrinkPortfolio</a></code>, <code><a href="#topic+CovarEstim">CovarEstim</a></code> and
<code><a href="#topic+MeanEstim">MeanEstim</a></code>. MVShrinkPortfolio creates mean-variance
portfolios using shrinkage estimation methods for portfolio weights.
CovarEstim computes several estimators of the covariance matrix, while
MeanEstim computes several estimators of the mean vector. Each of these
three functions is supplied a name of the method used to perform the
estimation. All portfolios are stored in objects of class MeanVar_portfolio
and some have a subclass, specific to their kind, that inherits from
MeanVar_portfolio. For the latter class constructor, validator and
helper functions are available, so that custom mean-variance portfolios
may be coded by users.
</p>


<h3>Methods</h3>

<p>MeanEstim: (Bodnar et al. 2019), James-Stein and Bayes-Stein
estimators (Jorion 1986).
</p>
<p>CovarEstim: (Bodnar et al. 2014), (Ledoit and Wolf 2020).
</p>
<p>MVShrinkPortfolio: (Bodnar et al. 2021),
(Bodnar et al. 2019).
</p>
<p>MeanVar_portfolio.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Dmitry Otryakhin <a href="mailto:d.otryakhin.acad@protonmail.ch">d.otryakhin.acad@protonmail.ch</a> (<a href="https://orcid.org/0000-0002-4700-7221">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Taras Bodnar (<a href="https://orcid.org/0000-0001-7855-8221">ORCID</a>)
</p>
</li>
<li><p> Solomiia Dmytriv (<a href="https://orcid.org/0000-0003-1855-3044">ORCID</a>)
</p>
</li>
<li><p> Yarema Okhrin (<a href="https://orcid.org/0000-0003-4704-5233">ORCID</a>)
</p>
</li>
<li><p> Nestor Parolya (<a href="https://orcid.org/0000-0003-2147-2288">ORCID</a>)
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/Otryakhin-Dmitry/global-minimum-variance-portfolio">https://github.com/Otryakhin-Dmitry/global-minimum-variance-portfolio</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/Otryakhin-Dmitry/global-minimum-variance-portfolio/issues">https://github.com/Otryakhin-Dmitry/global-minimum-variance-portfolio/issues</a>
</p>
</li></ul>


<hr>
<h2 id='InvCovShrinkBGP16'>Linear shrinkage estimator of the inverse covariance matrix
(Bodnar et al. 2016)</h2><span id='topic+InvCovShrinkBGP16'></span>

<h3>Description</h3>

<p>The optimal linear shrinkage estimator of the inverse covariance (precision)
matrix that minimizes the Frobenius norm is given by:
</p>
<p style="text-align: center;"><code class="reqn">\hat{\Pi}_{OLSE} = \hat{\alpha} \hat{\Pi} + \hat{\beta} \Pi_0,</code>
</p>

<p>where <code class="reqn">\hat{\alpha}</code> and <code class="reqn">\hat{\beta}</code> are optimal shrinkage
intensities given in Eq. (4.4) and (4.5) of Bodnar et al. (2016).
<code class="reqn">\hat{\Pi}</code> is the inverse of the sample covariance matrix (iSCM) and
<code class="reqn">\Pi_0</code> is a positive definite symmetric matrix used as the target
matrix (TM), for example, I.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>InvCovShrinkBGP16(n, p, TM, iSCM)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="InvCovShrinkBGP16_+3A_n">n</code></td>
<td>
<p>the number of observations</p>
</td></tr>
<tr><td><code id="InvCovShrinkBGP16_+3A_p">p</code></td>
<td>
<p>the number of variables (rows of the covariance matrix)</p>
</td></tr>
<tr><td><code id="InvCovShrinkBGP16_+3A_tm">TM</code></td>
<td>
<p>the target matrix for the shrinkage estimator</p>
</td></tr>
<tr><td><code id="InvCovShrinkBGP16_+3A_iscm">iSCM</code></td>
<td>
<p>the inverse of the sample covariance matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list containing an object of class matrix (S) and the estimated
shrinkage intensities <code class="reqn">\hat{\alpha}</code> and <code class="reqn">\hat{\beta}</code>.
</p>


<h3>References</h3>

<p>Bodnar T, Gupta AK, Parolya N (2016).
&ldquo;Direct shrinkage estimation of large dimensional precision matrix.&rdquo;
<em>Journal of Multivariate Analysis</em>, <b>146</b>, 223&ndash;236.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Parameter setting
n &lt;- 3e2
c &lt;- 0.7
p &lt;- c*n
mu &lt;- rep(0, p)
Sigma &lt;- RandCovMtrx(p=p)

# Generating observations
X &lt;- t(MASS::mvrnorm(n=n, mu=mu, Sigma=Sigma))

# Estimation
TM &lt;- matrix(0, nrow=p, ncol=p)
diag(TM) &lt;- 1
iSCM &lt;- solve(Sigma_sample_estimator(X))
Sigma_shr &lt;- InvCovShrinkBGP16(n=n, p=p, TM=TM, iSCM=iSCM)
Sigma_shr$S[1:6, 1:6]
</code></pre>

<hr>
<h2 id='mean_bop19'>BOP shrinkage estimator</h2><span id='topic+mean_bop19'></span>

<h3>Description</h3>

<p>Shrinkage estimator of the high-dimensional mean vector as suggested in
Bodnar et al. (2019). It uses the formula
</p>
<p style="text-align: center;"><code class="reqn">\hat \mu_{BOP} = \hat \alpha \bar x + \hat \beta \mu_0,</code>
</p>
<p> where
<code class="reqn">\hat \alpha</code> and <code class="reqn">\hat \beta</code> are shrinkage coefficients given by
Eq.(6) and Eg.(7) of Bodnar et al. (2019) that minimize
weighted quadratic loss for a given target vector <code class="reqn">\mu_0</code>
(shrinkage target). <code class="reqn">\bar x</code> stands for the sample mean vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mean_bop19(x, mu_0 = rep(1, p))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mean_bop19_+3A_x">x</code></td>
<td>
<p>a p by n matrix or a data frame of asset returns. Rows represent
different assets, columns &ndash; observations.</p>
</td></tr>
<tr><td><code id="mean_bop19_+3A_mu_0">mu_0</code></td>
<td>
<p>a numeric vector. The target vector used in the construction of
the shrinkage estimator.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a numeric vector containing the shrinkage estimator of
the mean vector
</p>


<h3>References</h3>

<p>Bodnar T, Okhrin O, Parolya N (2019).
&ldquo;Optimal shrinkage estimator for high-dimensional mean vector.&rdquo;
<em>Journal of Multivariate Analysis</em>, <b>170</b>, 63&ndash;79.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n&lt;-7e2 # number of realizations
p&lt;-.5*n # number of assets
x &lt;- matrix(data = rnorm(n*p), nrow = p, ncol = n)
mm &lt;- mean_bop19(x=x, mu_0=rep(1,p))
</code></pre>

<hr>
<h2 id='mean_bs'>Bayes-Stein shrinkage estimator of the mean vector</h2><span id='topic+mean_bs'></span>

<h3>Description</h3>

<p>Bayes-Stein shrinkage estimator of the mean vector as suggested in
Jorion (1986). The estimator is given by
</p>
<p style="text-align: center;"><code class="reqn">\hat \mu_{BS} = (1-\beta) \bar x + \beta Y_0 1,</code>
</p>
<p> where
<code class="reqn">\bar x</code> is the sample mean vector, <code class="reqn">\beta</code> and <code class="reqn">Y_0</code> are
derived using Bayesian approach (see Eq.(14) and Eq.(17) in
Jorion (1986)).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mean_bs(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mean_bs_+3A_x">x</code></td>
<td>
<p>a p by n matrix or a data frame of asset returns. Rows represent
different assets, columns &ndash; observations.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a numeric vector containing the Bayes-Stein shrinkage estimator
of the mean vector
</p>


<h3>References</h3>

<p>Jorion P (1986).
&ldquo;Bayes-Stein estimation for portfolio analysis.&rdquo;
<em>Journal of Financial and Quantitative Analysis</em>, 279&ndash;292.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n &lt;- 7e2 # number of realizations
p &lt;- .5*n # number of assets
x &lt;- matrix(data = rnorm(n*p), nrow = p, ncol = n)
mm &lt;- mean_bs(x=x)
</code></pre>

<hr>
<h2 id='mean_js'>James-Stein shrinkage estimator of the mean vector</h2><span id='topic+mean_js'></span>

<h3>Description</h3>

<p>James-Stein shrinkage estimator of the mean vector as suggested in
Jorion (1986). The estimator is given by
</p>
<p style="text-align: center;"><code class="reqn">\hat \mu_{JS} = (1-\beta) \bar x + \beta Y_0 1,</code>
</p>

<p>where <code class="reqn">\bar x</code> is the sample mean vector, <code class="reqn">\beta</code> is the shrinkage
coefficient which minimizes a quadratic loss given by Eq.(11) in
Jorion (1986).
<code class="reqn">Y_0</code> is a prespecified value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mean_js(x, Y_0 = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mean_js_+3A_x">x</code></td>
<td>
<p>a p by n matrix or a data frame of asset returns. Rows represent
different assets, columns &ndash; observations.</p>
</td></tr>
<tr><td><code id="mean_js_+3A_y_0">Y_0</code></td>
<td>
<p>a numeric variable. Shrinkage target coefficient.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a numeric vector containing the James-Stein shrinkage estimator
of the mean vector.
</p>


<h3>References</h3>

<p>Jorion P (1986).
&ldquo;Bayes-Stein estimation for portfolio analysis.&rdquo;
<em>Journal of Financial and Quantitative Analysis</em>, 279&ndash;292.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n&lt;-7e2 # number of realizations
p&lt;-.5*n # number of assets
x &lt;- matrix(data = rnorm(n*p), nrow = p, ncol = n)
mm &lt;- mean_js(x=x, Y_0 = 1)
</code></pre>

<hr>
<h2 id='MeanEstim'>Mean vector estimator</h2><span id='topic+MeanEstim'></span>

<h3>Description</h3>

<p>A user-friendly function for estimation of the mean vector.
Essentially, it is a function dispatcher for estimation of the mean vector
that chooses a method accordingly to the type argument.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MeanEstim(x, type, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MeanEstim_+3A_x">x</code></td>
<td>
<p>a p by n matrix or a data frame of asset returns. Rows represent
different assets, columns &ndash; observations.</p>
</td></tr>
<tr><td><code id="MeanEstim_+3A_type">type</code></td>
<td>
<p>a character. The estimation method to be used.</p>
</td></tr>
<tr><td><code id="MeanEstim_+3A_...">...</code></td>
<td>
<p>arguments to pass to estimators</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The available estimation methods for the mean are:</p>

<table>
<tr>
 <td style="text-align: left;">
   Function </td><td style="text-align: left;"> Paper </td><td style="text-align: left;"> Type </td>
</tr>
<tr>
 <td style="text-align: left;">
   .rowMeans </td><td style="text-align: left;">  </td><td style="text-align: left;"> trad </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+mean_bs">mean_bs</a></code> </td><td style="text-align: left;"> Jorion 1986 </td><td style="text-align: left;"> bs </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+mean_js">mean_js</a></code> </td><td style="text-align: left;"> Jorion 1986 </td><td style="text-align: left;"> js </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+mean_bop19">mean_bop19</a></code> </td><td style="text-align: left;"> Bodnar et al 2019 </td><td style="text-align: left;"> BOP19 </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Value</h3>

<p>a numeric vector&mdash; a value of the specified estimator of
the mean vector.
</p>


<h3>References</h3>

<p>Jorion P (1986).
&ldquo;Bayes-Stein estimation for portfolio analysis.&rdquo;
<em>Journal of Financial and Quantitative Analysis</em>, 279&ndash;292.
</p>
<p>Bodnar T, Okhrin O, Parolya N (2019).
&ldquo;Optimal shrinkage estimator for high-dimensional mean vector.&rdquo;
<em>Journal of Multivariate Analysis</em>, <b>170</b>, 63&ndash;79.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n&lt;-3e2 # number of realizations
p&lt;-.5*n # number of assets

x &lt;- matrix(data = rnorm(n*p), nrow = p, ncol = n)

Mean_trad &lt;- MeanEstim(x, type="trad")

mu_0 &lt;- rep(1/p, p)
Mean_BOP &lt;- MeanEstim(x, type="BOP19", mu_0=mu_0)

</code></pre>

<hr>
<h2 id='MeanVar_portfolio'>A helper function for MeanVar_portfolio</h2><span id='topic+MeanVar_portfolio'></span>

<h3>Description</h3>

<p>A user-friendly function making mean-variance portfolios for assets
with customly computed covariance matrix and mean returns.
The weights are computed in accordance with the formula
</p>
<p style="text-align: center;"><code class="reqn">\hat w_{MV} = \frac{\hat{\Sigma}^{-1} 1}{1' \hat{\Sigma}^{-1} 1} +
                    \gamma^{-1} \hat Q \hat{\mu},</code>
</p>

<p>where <code class="reqn">\hat{\Sigma}</code> is an estimator for the covariance matrix,
<code class="reqn">\hat{\mu}</code> is an estimator for the mean vector, <code class="reqn">\gamma</code> is
the coefficient of risk aversion, and <code class="reqn">\hat Q</code> is given by
</p>
<p style="text-align: center;"><code class="reqn">\hat Q = \hat{\Sigma}^{-1} - \frac{\hat{\Sigma}^{-1} 1
1' \hat{\Sigma}^{-1}}{1' \hat{\Sigma}^{-1} 1} .</code>
</p>

<p>The computation is made by <code><a href="#topic+new_MeanVar_portfolio">new_MeanVar_portfolio</a></code> and
the result is validated by <code><a href="#topic+validate_MeanVar_portfolio">validate_MeanVar_portfolio</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MeanVar_portfolio(mean_vec, cov_mtrx, gamma)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MeanVar_portfolio_+3A_mean_vec">mean_vec</code></td>
<td>
<p>mean vector of asset returns provided in the form of
a vector or a list.</p>
</td></tr>
<tr><td><code id="MeanVar_portfolio_+3A_cov_mtrx">cov_mtrx</code></td>
<td>
<p>the covariance matrix of asset returns.
It could be a matrix or a data frame.</p>
</td></tr>
<tr><td><code id="MeanVar_portfolio_+3A_gamma">gamma</code></td>
<td>
<p>a numeric variable. Coefficient of risk aversion.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Mean-variance portfolio in the form of object of
S3 class MeanVar_portfolio.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n&lt;-3e2 # number of realizations
p&lt;-.5*n # number of assets
gamma&lt;-1

x &lt;- matrix(data = rnorm(n*p), nrow = p, ncol = n)

# Simple MV portfolio
cov_mtrx &lt;- Sigma_sample_estimator(x)
means &lt;- rowMeans(x)

cust_port_simp &lt;- MeanVar_portfolio(mean_vec=means,
                                    cov_mtrx=cov_mtrx, gamma=2)
str(cust_port_simp)
</code></pre>

<hr>
<h2 id='MVShrinkPortfolio'>Shrinkage mean-variance portfolio</h2><span id='topic+MVShrinkPortfolio'></span>

<h3>Description</h3>

<p>The main function for mean-variance (also known as expected utility)
portfolio construction. It is a dispatcher using methods according to
argument type, values of gamma and dimensionality of matrix x.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MVShrinkPortfolio(x, gamma, type = c("shrinkage", "traditional"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MVShrinkPortfolio_+3A_x">x</code></td>
<td>
<p>a p by n matrix or a data frame of asset returns. Rows represent
different assets, columns &ndash; observations.</p>
</td></tr>
<tr><td><code id="MVShrinkPortfolio_+3A_gamma">gamma</code></td>
<td>
<p>a numeric variable. Coefficient of risk aversion.</p>
</td></tr>
<tr><td><code id="MVShrinkPortfolio_+3A_type">type</code></td>
<td>
<p>a character. The type of methods to use to construct the
portfolio.</p>
</td></tr>
<tr><td><code id="MVShrinkPortfolio_+3A_...">...</code></td>
<td>
<p>arguments to pass to portfolio constructors</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The sample estimator of the mean-variance portfolio weights, which results in
a traditional mean-variance portfolio, is calculated by
</p>
<p style="text-align: center;"><code class="reqn">\hat w_{MV} = \frac{S^{-1} 1}{1' S^{-1} 1} +
      \gamma^{-1} \hat Q \bar x,</code>
</p>

<p>where <code class="reqn">S^{-1}</code> and <code class="reqn">\bar x</code> are the inverse of the sample covariance
matrix and the sample mean vector of asset returns respectively, <code class="reqn">\gamma</code>
is the coefficient of risk aversion and <code class="reqn">\hat Q</code> is given by
</p>
<p style="text-align: center;"><code class="reqn">\hat Q = S^{-1} - \frac{S^{-1} 1 1' S^{-1}}{1' S^{-1} 1} .</code>
</p>

<p>In the case when <code class="reqn">p&gt;n</code>, <code class="reqn">S^{-1}</code> becomes <code class="reqn">S^{+}</code>- Moore-Penrose
inverse. The shrinkage estimator for the mean-variance portfolio weights in
a high-dimensional setting is given by
</p>
<p style="text-align: center;"><code class="reqn">\hat w_{ShMV} = \hat \alpha \hat w_{MV} + (1- \hat \alpha)b,</code>
</p>

<p>where <code class="reqn">\hat \alpha</code> is the estimated shrinkage intensity and <code class="reqn">b</code> is
a target vector with the sum of the elements equal to one.
</p>
<p>In the case <code class="reqn">\gamma \neq \infty</code>, <code class="reqn">\hat{\alpha}</code> is computed following
Eq. (2.22) of Bodnar et al. (2023) for c&lt;1 and following
Eq. (2.29) of Bodnar et al. (2023) for c&gt;1.
</p>
<p>The case of a fully risk averse investor (<code class="reqn">\gamma=\infty</code>) leads to the
traditional global minimum variance (GMV) portfolio with the weights given by
</p>
<p style="text-align: center;"><code class="reqn">\hat w_{GMV} = \frac{S^{-1} 1}{1' S^{-1} 1} .</code>
</p>

<p>The shrinkage estimator for the GMV portfolio is then calculated by
</p>
<p style="text-align: center;"><code class="reqn">\hat w_{ShGMV} = \hat\alpha \hat w_{GMV} + (1-\hat \alpha)b,</code>
</p>

<p>with <code class="reqn">\hat{\alpha}</code>  given in
Eq. (2.31) of Bodnar et al. (2018) for c&lt;1 and in
Eq. (2.33) of Bodnar et al. (2018) for c&gt;1.
</p>
<p>These estimation methods are available as separate functions employed by
MVShrinkPortfolio accordingly to the following parameter configurations:</p>

<table>
<tr>
 <td style="text-align: left;">
   Function </td><td style="text-align: left;"> Paper </td><td style="text-align: left;"> Type </td><td style="text-align: left;"> gamma </td><td style="text-align: left;"> p/n </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+new_MV_portfolio_weights_BDOPS21">new_MV_portfolio_weights_BDOPS21</a></code> </td><td style="text-align: left;"> Bodnar et al. (2023) </td><td style="text-align: left;"> shrinkage </td><td style="text-align: left;"> &lt; Inf </td><td style="text-align: left;"> &lt;1 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+new_MV_portfolio_weights_BDOPS21_pgn">new_MV_portfolio_weights_BDOPS21_pgn</a></code> </td><td style="text-align: left;"> Bodnar et al. (2023) </td><td style="text-align: left;"> shrinkage </td><td style="text-align: left;"> &lt; Inf </td><td style="text-align: left;"> &gt;1 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+new_GMV_portfolio_weights_BDPS19">new_GMV_portfolio_weights_BDPS19</a></code> </td><td style="text-align: left;"> Bodnar et al. (2018) </td><td style="text-align: left;"> shrinkage </td><td style="text-align: left;"> Inf </td><td style="text-align: left;"> &lt;1 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+new_GMV_portfolio_weights_BDPS19_pgn">new_GMV_portfolio_weights_BDPS19_pgn</a></code> </td><td style="text-align: left;"> Bodnar et al. (2018) </td><td style="text-align: left;"> shrinkage </td><td style="text-align: left;"> Inf </td><td style="text-align: left;"> &gt;1 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+new_MV_portfolio_traditional">new_MV_portfolio_traditional</a></code> </td><td style="text-align: left;">  </td><td style="text-align: left;"> traditional </td><td style="text-align: left;"> &gt; 0 </td><td style="text-align: left;"> &lt;1 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code><a href="#topic+new_MV_portfolio_traditional_pgn">new_MV_portfolio_traditional_pgn</a></code> </td><td style="text-align: left;">  </td><td style="text-align: left;"> traditional </td><td style="text-align: left;"> &gt; 0 </td><td style="text-align: left;"> &gt;1 </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Value</h3>

<p>A portfolio in the form of an object of class MeanVar_portfolio
potentially with a subclass.
See <code><a href="#topic+Class_MeanVar_portfolio">Class_MeanVar_portfolio</a></code> for the details of the class.
</p>


<h3>References</h3>

<p>Bodnar T, Okhrin Y, Parolya N (2023).
&ldquo;Optimal shrinkage-based portfolio selection in high dimensions.&rdquo;
<em>Journal of Business &amp; Economic Statistics</em>, <b>41</b>, 140-156.<br /><br /> Bodnar T, Parolya N, Schmid W (2018).
&ldquo;Estimation of the global minimum variance portfolio in high dimensions.&rdquo;
<em>European Journal of Operational Research</em>, <b>266</b>(1), 371&ndash;390.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n&lt;-3e2 # number of realizations
gamma&lt;-1

# The case p&lt;n

p&lt;-.5*n # number of assets
b&lt;-rep(1/p,p)

x &lt;- matrix(data = rnorm(n*p), nrow = p, ncol = n)

test &lt;- MVShrinkPortfolio(x=x, gamma=gamma,
                          type='shrinkage', b=b, beta = 0.05)
str(test)

test &lt;- MVShrinkPortfolio(x=x, gamma=Inf,
                          type='shrinkage', b=b, beta = 0.05)
str(test)

test &lt;- MVShrinkPortfolio(x=x, gamma=gamma, type='traditional')
str(test)

# The case p&gt;n

p&lt;-1.2*n # Re-define the number of assets
b&lt;-rep(1/p,p)

x &lt;- matrix(data = rnorm(n*p), nrow = p, ncol = n)

test &lt;- MVShrinkPortfolio(x=x, gamma=gamma, type='shrinkage',
                          b=b, beta = 0.05)
str(test)

test &lt;- MVShrinkPortfolio(x=x, gamma=Inf, type='shrinkage',
                          b=b, beta = 0.05)
str(test)

</code></pre>

<hr>
<h2 id='new_GMV_portfolio_weights_BDPS19'>Constructor of GMV portfolio object.</h2><span id='topic+new_GMV_portfolio_weights_BDPS19'></span><span id='topic+new_GMV_portfolio_weights_BDPS19_pgn'></span>

<h3>Description</h3>

<p>Constructor of global minimum variance portfolio.
new_GMV_portfolio_weights_BDPS19 is for the case p&lt;n, while
new_GMV_portfolio_weights_BDPS19_pgn is for p&gt;n, where p is the number of
assets and n is the number of observations. For more details
of the method, see <code><a href="#topic+MVShrinkPortfolio">MVShrinkPortfolio</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>new_GMV_portfolio_weights_BDPS19(x, b, beta)

new_GMV_portfolio_weights_BDPS19_pgn(x, b, beta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="new_GMV_portfolio_weights_BDPS19_+3A_x">x</code></td>
<td>
<p>a p by n matrix or a data frame of asset returns. Rows represent
different assets, columns &ndash; observations.</p>
</td></tr>
<tr><td><code id="new_GMV_portfolio_weights_BDPS19_+3A_b">b</code></td>
<td>
<p>a numeric vector. 1-beta is the confidence level of the symmetric
confidence interval, constructed for each weight.</p>
</td></tr>
<tr><td><code id="new_GMV_portfolio_weights_BDPS19_+3A_beta">beta</code></td>
<td>
<p>a numeric variable. The confidence level for weight intervals.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class MeanVar_portfolio with subclass
GMV_portfolio_weights_BDPS19.</p>

<table>
<tr>
 <td style="text-align: left;">
   Element </td><td style="text-align: left;"> Description </td>
</tr>
<tr>
 <td style="text-align: left;">
   call </td><td style="text-align: left;"> the function call with which it was created </td>
</tr>
<tr>
 <td style="text-align: left;">
   cov_mtrx </td><td style="text-align: left;"> the sample covariance matrix of the asset returns </td>
</tr>
<tr>
 <td style="text-align: left;">
   inv_cov_mtrx </td><td style="text-align: left;"> the inverse of the sample covariance matrix </td>
</tr>
<tr>
 <td style="text-align: left;">
   means </td><td style="text-align: left;"> sample mean vector estimate of the asset returns </td>
</tr>
<tr>
 <td style="text-align: left;">
   w_GMVP </td><td style="text-align: left;"> sample estimator of portfolio weights </td>
</tr>
<tr>
 <td style="text-align: left;">
   weights </td><td style="text-align: left;"> shrinkage estimator of portfolio weights </td>
</tr>
<tr>
 <td style="text-align: left;">
   alpha </td><td style="text-align: left;"> shrinkage intensity for the weights </td>
</tr>
<tr>
 <td style="text-align: left;">
   Port_Var </td><td style="text-align: left;"> portfolio variance </td>
</tr>
<tr>
 <td style="text-align: left;">
   Port_mean_return </td><td style="text-align: left;"> expected portfolio return </td>
</tr>
<tr>
 <td style="text-align: left;">
   Sharpe </td><td style="text-align: left;"> portfolio Sharpe ratio </td>
</tr>
<tr>
 <td style="text-align: left;">
   weight_intervals </td><td style="text-align: left;"> A data frame, see details </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>weight_intervals contains a shrinkage estimator of portfolio weights,
asymptotic confidence intervals for the true portfolio weights,
the value of test statistic and the p-value of the test on the equality of
the weight of each individual asset to zero
(see Section 4.3 of Bodnar et al. 2023).
weight_intervals is only computed when p&lt;n.
</p>


<h3>References</h3>

<p>Bodnar T, Dmytriv S, Parolya N, Schmid W (2019).
&ldquo;Tests for the weights of the global minimum variance portfolio in a high-dimensional setting.&rdquo;
<em>IEEE Transactions on Signal Processing</em>, <b>67</b>(17), 4479&ndash;4493.
</p>
<p>Bodnar T, Parolya N, Schmid W (2018).
&ldquo;Estimation of the global minimum variance portfolio in high dimensions.&rdquo;
<em>European Journal of Operational Research</em>, <b>266</b>(1), 371&ndash;390.
</p>
<p>Bodnar T, Dette H, Parolya N, Thorsén E (2023).
&ldquo;Corrigendum to &quot;Sampling Distributions of Optimal Portfolio Weights and Characteristics in Low and Large Dimensions.&quot;.&rdquo;
<em>Random Matrices: Theory and Applications</em>, <b>12</b>, 2392001.
<a href="https://doi.org/10.1142/S2010326323920016">doi:10.1142/S2010326323920016</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# c&lt;1

n &lt;- 3e2 # number of realizations
p &lt;- .5*n # number of assets
b &lt;- rep(1/p,p)

# Assets with a diagonal covariance matrix
x &lt;- matrix(data = rnorm(n*p), nrow = p, ncol = n)

test &lt;- new_GMV_portfolio_weights_BDPS19(x=x, b=b, beta=0.05)
str(test)

# Assets with a non-diagonal covariance matrix
Mtrx &lt;- RandCovMtrx(p=p)
x &lt;- t(MASS::mvrnorm(n=n , mu=rep(0,p), Sigma=Mtrx))

test &lt;- new_GMV_portfolio_weights_BDPS19(x=x, b=b, beta=0.05)
summary(test)

# c&gt;1

p &lt;- 1.3*n # number of assets
b &lt;- rep(1/p,p)

# Assets with a diagonal covariance matrix
x &lt;- matrix(data = rnorm(n*p), nrow = p, ncol = n)

test &lt;- new_GMV_portfolio_weights_BDPS19_pgn(x=x, b=b, beta=0.05)
str(test)

</code></pre>

<hr>
<h2 id='new_MeanVar_portfolio'>A constructor for class MeanVar_portfolio</h2><span id='topic+new_MeanVar_portfolio'></span>

<h3>Description</h3>

<p>A light-weight constructor of objects of S3 class MeanVar_portfolio.
This  function is for development purposes. A helper function equipped with
error messages and allowing more flexible input is
<code><a href="#topic+MeanVar_portfolio">MeanVar_portfolio</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>new_MeanVar_portfolio(mean_vec, cov_mtrx, gamma)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="new_MeanVar_portfolio_+3A_mean_vec">mean_vec</code></td>
<td>
<p>mean vector of asset returns</p>
</td></tr>
<tr><td><code id="new_MeanVar_portfolio_+3A_cov_mtrx">cov_mtrx</code></td>
<td>
<p>the covariance matrix of asset returns</p>
</td></tr>
<tr><td><code id="new_MeanVar_portfolio_+3A_gamma">gamma</code></td>
<td>
<p>a numeric variable. Coefficient of risk aversion.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Mean-variance portfolio in the form of object of
S3 class MeanVar_portfolio.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n&lt;-3e2 # number of realizations
p&lt;-.5*n # number of assets
gamma&lt;-1

x &lt;- matrix(data = rnorm(n*p), nrow = p, ncol = n)

# Simple MV portfolio
cov_mtrx &lt;- Sigma_sample_estimator(x)
means &lt;- rowMeans(x)

cust_port_simp &lt;- new_MeanVar_portfolio(mean_vec=means,
                                        cov_mtrx=cov_mtrx, gamma=2)
str(cust_port_simp)

# Portfolio with Bayes-Stein shrunk means
# and a Ledoit and Wolf estimator for covariance matrix
TM &lt;- matrix(0, p, p)
diag(TM) &lt;- 1
cov_mtrx &lt;- CovarEstim(x, type="LW20", TM=TM)
means &lt;- mean_bs(x)

cust_port_BS_LW &lt;- new_MeanVar_portfolio(mean_vec=means$means,
                                         cov_mtrx=cov_mtrx, gamma=2)
str(cust_port_BS_LW)
</code></pre>

<hr>
<h2 id='new_MV_portfolio_traditional'>Traditional mean-variance portfolio</h2><span id='topic+new_MV_portfolio_traditional'></span><span id='topic+new_MV_portfolio_traditional_pgn'></span>

<h3>Description</h3>

<p>Mean-variance portfolios with the traditional (sample) estimators for
the mean vector and the covariance matrix of asset returns.
For more details of the method, see <code><a href="#topic+MVShrinkPortfolio">MVShrinkPortfolio</a></code>.
new_MV_portfolio_traditional is for the case p&lt;n, while
new_MV_portfolio_traditional_pgn is for p&gt;n, where p is the number of
assets and n is the number of observations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>new_MV_portfolio_traditional(x, gamma)

new_MV_portfolio_traditional_pgn(x, gamma)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="new_MV_portfolio_traditional_+3A_x">x</code></td>
<td>
<p>a p by n matrix or a data frame of asset returns. Rows represent
different assets, columns &ndash; observations.</p>
</td></tr>
<tr><td><code id="new_MV_portfolio_traditional_+3A_gamma">gamma</code></td>
<td>
<p>a numeric variable. Coefficient of risk aversion.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class MeanVar_portfolio</p>

<table>
<tr>
 <td style="text-align: left;">
   Element </td><td style="text-align: left;"> Description </td>
</tr>
<tr>
 <td style="text-align: left;">
   call </td><td style="text-align: left;"> the function call with which it was created </td>
</tr>
<tr>
 <td style="text-align: left;">
   cov_mtrx </td><td style="text-align: left;"> the sample covariance matrix of asset returns </td>
</tr>
<tr>
 <td style="text-align: left;">
   inv_cov_mtrx </td><td style="text-align: left;"> the inverse of the sample covariance matrix </td>
</tr>
<tr>
 <td style="text-align: left;">
   means </td><td style="text-align: left;"> sample mean estimator of the asset returns </td>
</tr>
<tr>
 <td style="text-align: left;">
   W_mv_hat </td><td style="text-align: left;"> sample estimator of portfolio weights </td>
</tr>
<tr>
 <td style="text-align: left;">
   Port_Var </td><td style="text-align: left;"> portfolio variance </td>
</tr>
<tr>
 <td style="text-align: left;">
   Port_mean_return </td><td style="text-align: left;"> expected portfolio return </td>
</tr>
<tr>
 <td style="text-align: left;">
   Sharpe </td><td style="text-align: left;"> portfolio Sharpe ratio </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Examples</h3>

<pre><code class='language-R'>n &lt;- 3e2 # number of realizations
p &lt;- .5*n # number of assets
gamma &lt;- 1

x &lt;- matrix(data = rnorm(n*p), nrow = p, ncol = n)

test &lt;- new_MV_portfolio_traditional(x=x, gamma=gamma)
str(test)
</code></pre>

<hr>
<h2 id='new_MV_portfolio_weights_BDOPS21'>Constructor of MV portfolio object</h2><span id='topic+new_MV_portfolio_weights_BDOPS21'></span><span id='topic+new_MV_portfolio_weights_BDOPS21_pgn'></span>

<h3>Description</h3>

<p>Constructor of mean-variance shrinkage portfolios.
new_MV_portfolio_weights_BDOPS21 is for the case p&lt;n, while
new_MV_portfolio_weights_BDOPS21_pgn is for p&gt;n, where p is the number of
assets and n is the number of observations.
For more details of the method, see <code><a href="#topic+MVShrinkPortfolio">MVShrinkPortfolio</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>new_MV_portfolio_weights_BDOPS21(x, gamma, b, beta)

new_MV_portfolio_weights_BDOPS21_pgn(x, gamma, b, beta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="new_MV_portfolio_weights_BDOPS21_+3A_x">x</code></td>
<td>
<p>a p by n matrix or a data frame of asset returns. Rows represent
different assets, columns &ndash; observations.</p>
</td></tr>
<tr><td><code id="new_MV_portfolio_weights_BDOPS21_+3A_gamma">gamma</code></td>
<td>
<p>a numeric variable. Coefficient of risk aversion.</p>
</td></tr>
<tr><td><code id="new_MV_portfolio_weights_BDOPS21_+3A_b">b</code></td>
<td>
<p>a numeric variable. 1-beta is the confidence level of the symmetric
confidence interval, constructed for each weight.</p>
</td></tr>
<tr><td><code id="new_MV_portfolio_weights_BDOPS21_+3A_beta">beta</code></td>
<td>
<p>a numeric variable. The confidence level for weight intervals.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class MeanVar_portfolio with subclass
MV_portfolio_weights_BDOPS21.</p>

<table>
<tr>
 <td style="text-align: left;">
   Element </td><td style="text-align: left;"> Description </td>
</tr>
<tr>
 <td style="text-align: left;">
   call </td><td style="text-align: left;"> the function call with which it was created </td>
</tr>
<tr>
 <td style="text-align: left;">
   cov_mtrx </td><td style="text-align: left;"> the sample covariance matrix of the asset returns </td>
</tr>
<tr>
 <td style="text-align: left;">
   inv_cov_mtrx </td><td style="text-align: left;"> the inverse of the sample covariance matrix </td>
</tr>
<tr>
 <td style="text-align: left;">
   means </td><td style="text-align: left;"> sample mean vector of the asset returns </td>
</tr>
<tr>
 <td style="text-align: left;">
   W_mv_hat </td><td style="text-align: left;"> sample estimator of the portfolio weights </td>
</tr>
<tr>
 <td style="text-align: left;">
   weights </td><td style="text-align: left;"> shrinkage estimator of the portfolio weights </td>
</tr>
<tr>
 <td style="text-align: left;">
   alpha </td><td style="text-align: left;"> shrinkage intensity for the weights </td>
</tr>
<tr>
 <td style="text-align: left;">
   Port_Var </td><td style="text-align: left;"> portfolio variance </td>
</tr>
<tr>
 <td style="text-align: left;">
   Port_mean_return </td><td style="text-align: left;"> expected portfolio return </td>
</tr>
<tr>
 <td style="text-align: left;">
   Sharpe </td><td style="text-align: left;"> portfolio Sharpe ratio </td>
</tr>
<tr>
 <td style="text-align: left;">
   weight_intervals </td><td style="text-align: left;"> A data frame, see details </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>weight_intervals contains a shrinkage estimator of portfolio weights,
asymptotic confidence intervals for the true portfolio weights, value of
the test statistic and the p-value of the test on the equality of
the weight of each individual asset to zero
(see Section 4.3 of Bodnar et al. 2023)
weight_intervals is only computed when p&lt;n.
</p>


<h3>References</h3>

<p>Bodnar T, Dmytriv S, Okhrin Y, Parolya N, Schmid W (2021).
&ldquo;Statistical Inference for the Expected Utility Portfolio in High Dimensions.&rdquo;
<em>IEEE Transactions on Signal Processing</em>, <b>69</b>, 1-14.
</p>
<p>Bodnar T, Dette H, Parolya N, Thorsén E (2023).
&ldquo;Corrigendum to &quot;Sampling Distributions of Optimal Portfolio Weights and Characteristics in Low and Large Dimensions.&quot;.&rdquo;
<em>Random Matrices: Theory and Applications</em>, <b>12</b>, 2392001.
<a href="https://doi.org/10.1142/S2010326323920016">doi:10.1142/S2010326323920016</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# c&lt;1

# Assets with a diagonal covariance matrix

n &lt;- 3e2 # number of realizations
p &lt;- .5*n # number of assets
b &lt;- rep(1/p,p)
gamma &lt;- 1

x &lt;- matrix(data = rnorm(n*p), nrow = p, ncol = n)

test &lt;- new_MV_portfolio_weights_BDOPS21(x=x, gamma=gamma, b=b, beta=0.05)
summary(test)

# Assets with a non-diagonal covariance matrix

Mtrx &lt;- RandCovMtrx(p=p)
x &lt;- t(MASS::mvrnorm(n=n , mu=rep(0,p), Sigma=Mtrx))

test &lt;- new_MV_portfolio_weights_BDOPS21(x=x, gamma=gamma, b=b, beta=0.05)
str(test)


# c&gt;1

n &lt;-2e2 # number of realizations
p &lt;-1.2*n # number of assets
b &lt;-rep(1/p,p)
x &lt;- matrix(data = rnorm(n*p), nrow = p, ncol = n)

test &lt;- new_MV_portfolio_weights_BDOPS21_pgn(x=x, gamma=gamma,
                                             b=b, beta=0.05)
summary(test)

# Assets with a non-diagonal covariance matrix

</code></pre>

<hr>
<h2 id='nonlin_shrinkLW'>nonlinear shrinkage estimator of the covariance matrix of
Ledoit and Wolf (2020)</h2><span id='topic+nonlin_shrinkLW'></span>

<h3>Description</h3>

<p>The nonlinear shrinkage estimator of the covariance matrix, that minimizes
the minimum variance loss functions as defined in Eq (2.1) of
Ledoit and Wolf (2020).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nonlin_shrinkLW(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nonlin_shrinkLW_+3A_x">x</code></td>
<td>
<p>a p by n matrix or a data frame of asset returns. Rows represent
different assets, columns &ndash; observations.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class matrix
</p>


<h3>References</h3>

<p>Ledoit O, Wolf M (2020).
&ldquo;Analytical nonlinear shrinkage of large-dimensional covariance matrices.&rdquo;
<em>Annals of Statistics</em>, <b>48</b>(5), 3043&ndash;3065.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n&lt;-3e2
c&lt;-0.7
p&lt;-c*n
mu &lt;- rep(0, p)
Sigma &lt;- RandCovMtrx(p=p)

X &lt;- t(MASS::mvrnorm(n=n, mu=mu, Sigma=Sigma))
Sigma_shr &lt;- nonlin_shrinkLW(X)
</code></pre>

<hr>
<h2 id='plot_frontier'>Plot the Bayesian efficient frontier (Bauder et al. 2021) and the
provided portfolios.</h2><span id='topic+plot_frontier'></span>

<h3>Description</h3>

<p>The plotted  Bayesian efficient frontier is provided by
Eq. (8) in Bauder et al. (2021).
It is the set of optimal portfolios obtained
by employing the posterior predictive distribution on the asset returns.
This efficient frontier can be used to assess the mean-variance efficiency
of various estimators of the portfolio weights. The standard deviation of
the portfolio return is plotted in the <code class="reqn">x</code>-axis and the mean portfolio
return in the <code class="reqn">y</code>-axis. The portfolios with the weights <code class="reqn">\rm{w}</code>
are added to the plot by computing  <code class="reqn">\sqrt{\rm{w}^\prime  S  w} </code>
and  <code class="reqn">\rm w^\prime \bar x</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_frontier(x, weights.eff = rep(1/nrow(x), length = nrow(x)))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_frontier_+3A_x">x</code></td>
<td>
<p>a p by n matrix or a data frame of asset returns. Rows represent
different assets, columns &ndash; observations.</p>
</td></tr>
<tr><td><code id="plot_frontier_+3A_weights.eff">weights.eff</code></td>
<td>
<p>matrix of portfolio weights. Each column contains
p values of the weights for a given portfolio. Default: equally
weighted portfolio.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a ggplot object
</p>


<h3>References</h3>

<p>Bauder D, Bodnar T, Parolya N, Schmid W (2021).
&ldquo;Bayesian mean&ndash;variance analysis: optimal portfolio selection under parameter uncertainty.&rdquo;
<em>Quantitative Finance</em>, <b>21</b>(2), 221&ndash;242.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>p &lt;- 150
n &lt;- 300
gamma &lt;- 10
mu &lt;- seq(0.2,-0.2, length.out=p)
Sigma &lt;- RandCovMtrx(p=p)

x &lt;- t(MASS::mvrnorm(n=n , mu=mu, Sigma=Sigma))

EW_port &lt;- rep(1/p, length=p)
MV_shr_port &lt;- new_MV_portfolio_weights_BDOPS21(x=x, gamma=gamma,
                                                b=EW_port, beta=0.05)$weights
GMV_shr_port &lt;- new_MV_portfolio_weights_BDOPS21(x=x, gamma=Inf, b=EW_port,
                                                 beta=0.05)$weights
MV_trad_port &lt;- new_MV_portfolio_traditional(x=x, gamma=gamma)$weights
GMV_trad_port &lt;- new_MV_portfolio_traditional(x=x, gamma=Inf)$weights

weights.eff &lt;- cbind(EW_port, MV_shr_port, GMV_shr_port,
                     MV_trad_port, GMV_trad_port)
colnames(weights.eff) &lt;- c("EW", "MV_shr", "GMV_shr", "MV_trad", "GMV_trad")


Fplot &lt;- plot_frontier(x, weights.eff)
Fplot
</code></pre>

<hr>
<h2 id='RandCovMtrx'>Covariance matrix generator</h2><span id='topic+RandCovMtrx'></span>

<h3>Description</h3>

<p>Generates a covariance matrix from Wishart distribution with given
eigenvalues or with exponentially decreasing eigenvalues. Useful for examples
and tests when an arbitrary covariance matrix is needed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RandCovMtrx(p = 200, eigenvalues = 0.1 * exp(5 * seq_len(p)/p))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RandCovMtrx_+3A_p">p</code></td>
<td>
<p>dimension of the covariance matrix</p>
</td></tr>
<tr><td><code id="RandCovMtrx_+3A_eigenvalues">eigenvalues</code></td>
<td>
<p>the vector of positive eigenvalues</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function generates a symmetric positive definite covariance matrix with
given eigenvalues. The eigenvalues can be specified explicitly. Or, by
default, they are generated with exponential decay.
</p>


<h3>Value</h3>

<p>covariance matrix
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
p&lt;-1e1
# A non-diagonal covariance matrix
Mtrx &lt;- RandCovMtrx(p=p)
Mtrx
</code></pre>

<hr>
<h2 id='Sigma_sample_estimator'>Sample covariance matrix</h2><span id='topic+Sigma_sample_estimator'></span>

<h3>Description</h3>

<p>It computes the sample covariance of matrix <code class="reqn">S</code> as follows:
</p>
<p style="text-align: center;"><code class="reqn">S = \frac{1}{n-1} \sum_{j=1}^n (x_j - \bar x)(x_j - \bar x)'
,\quad \bar x = \frac{1}{n} \sum_{j=1}^n x_j ,</code>
</p>

<p>where <code class="reqn">x_j</code> is the <code class="reqn">j</code>-th column of the data matrix <code class="reqn">x</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Sigma_sample_estimator(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Sigma_sample_estimator_+3A_x">x</code></td>
<td>
<p>a p by n matrix or a data frame of asset returns. Rows represent
different assets, columns &ndash; observations.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Sample covariance estimation
</p>


<h3>Examples</h3>

<pre><code class='language-R'>p&lt;-5 # number of assets
n&lt;-1e1 # number of realizations

x &lt;-matrix(data = rnorm(n*p), nrow = p, ncol = n)
Sigma_sample_estimator(x)
</code></pre>

<hr>
<h2 id='SP_daily_asset_returns'>Daily  log-returns  of selected constituents S&amp;P500.</h2><span id='topic+SP_daily_asset_returns'></span>

<h3>Description</h3>

<p>Daily log-returns of selected constituents of S&amp;P500 in percents. 
The data are sampled in business time, i.e., weekends and holidays 
are omitted.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SP_daily_asset_returns
</code></pre>


<h3>Format</h3>

<p>a matrix with the first column containing the data and company 
names as column labels.
</p>


<h3>Source</h3>

<p>Yahoo finance
</p>

<hr>
<h2 id='test_MVSP'>Test for mean-variance portfolio weights</h2><span id='topic+test_MVSP'></span>

<h3>Description</h3>

<p>A high-dimensional asymptotic test on the mean-variance efficiency of a given
portfolio with the weights <code class="reqn">\rm{w}_0</code>. The tested hypotheses are
</p>
<p style="text-align: center;"><code class="reqn">H_0: w_{MV} = w_0 \quad vs \quad H_1: w_{MV} \neq w_0.</code>
</p>

<p>The test statistic is based on the shrinkage estimator of mean-variance
portfolio weights (see Eq.(44) of Bodnar et al. 2021).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>test_MVSP(gamma, x, w_0, beta = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="test_MVSP_+3A_gamma">gamma</code></td>
<td>
<p>a numeric variable. Coefficient of risk aversion.</p>
</td></tr>
<tr><td><code id="test_MVSP_+3A_x">x</code></td>
<td>
<p>a p by n matrix or a data frame of asset returns. Rows represent
different assets, columns &ndash; observations.</p>
</td></tr>
<tr><td><code id="test_MVSP_+3A_w_0">w_0</code></td>
<td>
<p>a numeric vector of tested weights.</p>
</td></tr>
<tr><td><code id="test_MVSP_+3A_beta">beta</code></td>
<td>
<p>a significance level for the test.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note: when gamma == Inf, we get the test for the weights of
the global minimum variance portfolio as in Theorem 2 of
Bodnar et al. (2019).
</p>


<h3>Value</h3>


<table>
<tr>
 <td style="text-align: left;">
   Element </td><td style="text-align: left;"> Description </td>
</tr>
<tr>
 <td style="text-align: left;">
   alpha_hat </td><td style="text-align: left;"> the estimated shrinkage intensity </td>
</tr>
<tr>
 <td style="text-align: left;">
   alpha_sd </td><td style="text-align: left;"> the standard deviation of the shrinkage intensity </td>
</tr>
<tr>
 <td style="text-align: left;">
   alpha_lower </td><td style="text-align: left;"> the lower bound for the shrinkage intensity </td>
</tr>
<tr>
 <td style="text-align: left;">
   alpha_upper </td><td style="text-align: left;"> the upper bound for the shrinkage intensity </td>
</tr>
<tr>
 <td style="text-align: left;">
   T_alpha </td><td style="text-align: left;"> the value of the test statistic </td>
</tr>
<tr>
 <td style="text-align: left;">
   p_value </td><td style="text-align: left;"> the p-value for the test </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>References</h3>

<p>Bodnar T, Dmytriv S, Okhrin Y, Parolya N, Schmid W (2021).
&ldquo;Statistical Inference for the Expected Utility Portfolio in High Dimensions.&rdquo;
<em>IEEE Transactions on Signal Processing</em>, <b>69</b>, 1-14.<br /><br /> Bodnar T, Dmytriv S, Parolya N, Schmid W (2019).
&ldquo;Tests for the weights of the global minimum variance portfolio in a high-dimensional setting.&rdquo;
<em>IEEE Transactions on Signal Processing</em>, <b>67</b>(17), 4479&ndash;4493.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n&lt;-3e2 # number of realizations
p&lt;-.5*n # number of assets
b&lt;-rep(1/p,p)
gamma&lt;-1

x &lt;- matrix(data = rnorm(n*p), nrow = p, ncol = n)

T_alpha &lt;- test_MVSP(gamma=gamma, x=x, w_0=b, beta=0.05)
T_alpha
</code></pre>

<hr>
<h2 id='validate_MeanVar_portfolio'>A validator for objects of class MeanVar_portfolio</h2><span id='topic+validate_MeanVar_portfolio'></span>

<h3>Description</h3>

<p>A validator for objects of class MeanVar_portfolio
</p>


<h3>Usage</h3>

<pre><code class='language-R'>validate_MeanVar_portfolio(w)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="validate_MeanVar_portfolio_+3A_w">w</code></td>
<td>
<p>Object of class MeanVar_portfolio.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If the object passes all the checks, then w itself is returned,
otherwise an error is thrown.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n&lt;-3e2 # number of realizations
p&lt;-.5*n # number of assets
gamma&lt;-1

x &lt;- matrix(data = rnorm(n*p), nrow = p, ncol = n)

# Simple MV portfolio
cov_mtrx &lt;- Sigma_sample_estimator(x)
means &lt;- rowMeans(x)

cust_port_simp &lt;- new_MeanVar_portfolio(mean_vec=means,
                                        cov_mtrx=cov_mtrx, gamma=2)
str(validate_MeanVar_portfolio(cust_port_simp))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
