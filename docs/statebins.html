<!DOCTYPE html><html><head><title>Help for package statebins</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {statebins}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#geom_statebins'><p>A statebins Geom</p></a></li>
<li><a href='#state_tbl'><p>&quot;State&quot; abbreviation to name data frame</p></a></li>
<li><a href='#statebins'><p>Create a new ggplot-based &quot;statebin&quot; chart for USA states/territories</p></a></li>
<li><a href='#statebins-package'><p>Create United States Uniform Cartogram Heatmaps</p></a></li>
<li><a href='#theme_statebins'><p>Base statebins theme</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Create United States Uniform Cartogram Heatmaps</td>
</tr>
<tr>
<td>Version:</td>
<td>1.4.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-07-08</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Bob Rudis &lt;bob@rud.is&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>The 'cartogram' heatmaps generated by the included methods 
    are an alternative to choropleth maps for the United States
    and are based on work by the Washington Post graphics department in their report
    on "The states most threatened by trade" 
    (<a href="http://www.washingtonpost.com/wp-srv/special/business/states-most-threatened-by-trade/">http://www.washingtonpost.com/wp-srv/special/business/states-most-threatened-by-trade/</a>).
    "State bins" preserve as much of the geographic placement of the states as 
    possible but have the look and feel of a traditional heatmap. Functions are 
    provided that allow for use of a binned, discrete scale, a continuous scale 
    or manually specified colors depending on what is needed for the underlying data.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://gitlab.com/hrbrmstr/statebins">https://gitlab.com/hrbrmstr/statebins</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://gitlab.com/hrbrmstr/statebins/issues">https://gitlab.com/hrbrmstr/statebins/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Suggests:</td>
<td>viridis, RColorBrewer, covr, tinytest</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0),</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2 (&ge; 2.2.1), scales (&ge; 0.5.0), grid</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Collate:</td>
<td>'aaa.R' 'geom-rrect.r' 'geom-rtile.R' 'geom-statebins.r'
'gutil.R' 'statebins-package.R' 'statebins.R'
'theme-statebin.R' 'util.R'</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-07-08 17:40:11 UTC; hrbrmstr</td>
</tr>
<tr>
<td>Author:</td>
<td>Bob Rudis <a href="https://orcid.org/0000-0001-5670-2640"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre],
  Harold Gil [ctb] (fix for show.guide),
  Brian Adams [ctb] (theme testing &amp; feedback),
  Thomas Wood [ctb] (Significant suggestions &amp; testing that made new
    features possible),
  Mathew Kiang [ctb] (Minor fix for NA handling)</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-07-08 23:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='geom_statebins'>A statebins Geom</h2><span id='topic+geom_statebins'></span><span id='topic+GeomStatebins'></span>

<h3>Description</h3>

<p>Pass in a data frame of states and values and let this do the work. It enables
easy faceting and makes it simpler to have a uniform legend across all the
plots.<br />
<br />
There are two special/critical <code>aes()</code> mappings:<br />
<br />
</p>

<ul>
<li> <p><code>state</code> (so the geom knows which column to map the state names/abbrevs to)
</p>
</li>
<li> <p><code>fill</code> (which column you're mapping the filling for the squares with)
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>geom_statebins(
  mapping = NULL,
  data = NULL,
  border_col = "white",
  border_size = 2,
  lbl_size = 3,
  dark_lbl = "black",
  light_lbl = "white",
  radius = grid::unit(6, "pt"),
  ...,
  na.rm = FALSE,
  show.legend = NA,
  inherit.aes = TRUE
)

GeomStatebins
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="geom_statebins_+3A_mapping">mapping</code></td>
<td>
<p>Set of aesthetic mappings created by <code>aes()</code> or
<code>aes_()</code>. If specified and <code>inherit.aes = TRUE</code> (the
default), it is combined with the default mapping at the top level of the
plot. You must supply <code>mapping</code> if there is no plot mapping.</p>
</td></tr>
<tr><td><code id="geom_statebins_+3A_data">data</code></td>
<td>
<p>The data to be displayed in this layer. There are three
options:
</p>
<p>If <code>NULL</code>, the default, the data is inherited from the plot
data as specified in the call to <code>ggplot()</code>.
</p>
<p>A <code>data.frame</code>, or other object, will override the plot
data. All objects will be fortified to produce a data frame. See
<code>fortify()</code> for which variables will be created.
</p>
<p>A <code>function</code> will be called with a single argument,
the plot data. The return value must be a <code>data.frame.</code>, and
will be used as the layer data.</p>
</td></tr>
<tr><td><code id="geom_statebins_+3A_border_col">border_col</code></td>
<td>
<p>border color of the state squares, default &quot;<code>white</code>&quot;</p>
</td></tr>
<tr><td><code id="geom_statebins_+3A_border_size">border_size</code></td>
<td>
<p>thickness of the square state borders</p>
</td></tr>
<tr><td><code id="geom_statebins_+3A_lbl_size">lbl_size</code></td>
<td>
<p>font size (relative) of the label text</p>
</td></tr>
<tr><td><code id="geom_statebins_+3A_dark_lbl">dark_lbl</code>, <code id="geom_statebins_+3A_light_lbl">light_lbl</code></td>
<td>
<p>colrs to be uses when the label should be dark or light.
The function automagically computes when this should be.</p>
</td></tr>
<tr><td><code id="geom_statebins_+3A_radius">radius</code></td>
<td>
<p>the corner radius</p>
</td></tr>
<tr><td><code id="geom_statebins_+3A_...">...</code></td>
<td>
<p>other arguments passed on to <code>layer()</code>. These are
often aesthetics, used to set an aesthetic to a fixed value, like
<code>color = "red"</code> or <code>size = 3</code>. They may also be parameters
to the paired geom/stat.</p>
</td></tr>
<tr><td><code id="geom_statebins_+3A_na.rm">na.rm</code></td>
<td>
<p>If <code>FALSE</code>, the default, missing values are removed with
a warning. If <code>TRUE</code>, missing values are silently removed.</p>
</td></tr>
<tr><td><code id="geom_statebins_+3A_show.legend">show.legend</code></td>
<td>
<p>logical. Should this layer be included in the legends?
<code>NA</code>, the default, includes if any aesthetics are mapped.
<code>FALSE</code> never includes, and <code>TRUE</code> always includes.
It can also be a named logical vector to finely select the aesthetics to
display.</p>
</td></tr>
<tr><td><code id="geom_statebins_+3A_inherit.aes">inherit.aes</code></td>
<td>
<p>If <code>FALSE</code>, overrides the default aesthetics,
rather than combining with them. This is most useful for helper functions
that define both data and aesthetics and shouldn't inherit behaviour from
the default plot specification, e.g. <code>borders()</code>.</p>
</td></tr>
</table>


<h3>Format</h3>

<p>An object of class <code>GeomStatebins</code> (inherits from <code>Geom</code>, <code>ggproto</code>, <code>gg</code>) of length 7.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(statebins)
library(cdcfluview)
library(hrbrthemes)
library(tidyverse)

flu &lt;- ili_weekly_activity_indicators(2017)

ggplot(flu, aes(state=statename, fill=activity_level)) +
  geom_statebins() +
  coord_equal() +
  viridis::scale_fill_viridis(
    name = "ILI Activity Level  ", limits=c(0,10), breaks=0:10, option = "magma", direction = -1
  ) +
  facet_wrap(~weekend) +
  labs(title="2017-18 Flu Season ILI Activity Level") +
  theme_statebins(base_family = font_ps) +
  theme(plot.title=element_text(size=16, hjust=0)) +
  theme(plot.margin = margin(30,30,30,30))

## End(Not run)
</code></pre>

<hr>
<h2 id='state_tbl'>&quot;State&quot; abbreviation to name data frame</h2><span id='topic+state_tbl'></span>

<h3>Description</h3>

<p>&quot;State&quot; abbreviation to name data frame
</p>

<hr>
<h2 id='statebins'>Create a new ggplot-based &quot;statebin&quot; chart for USA states/territories</h2><span id='topic+statebins'></span>

<h3>Description</h3>

<p>Pass in a data frame and get back a square choropleth.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>statebins(
  state_data,
  state_col = "state",
  value_col = "value",
  dark_label = "black",
  light_label = "white",
  na_label = "white",
  font_size = 3,
  state_border_col = "white",
  state_border_size = 2,
  round = FALSE,
  radius = grid::unit(6, "pt"),
  ggplot2_scale_function = ggplot2::scale_fill_distiller,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="statebins_+3A_state_data">state_data</code></td>
<td>
<p>data frame of states and values to plot</p>
</td></tr>
<tr><td><code id="statebins_+3A_state_col">state_col</code></td>
<td>
<p>column name in <code>state_data</code> that has the states. no duplicates
and can be names (e.g. &quot;<code>Maine</code>&quot;) or abbreviatons (e.g. &quot;<code>ME</code>&quot;)</p>
</td></tr>
<tr><td><code id="statebins_+3A_value_col">value_col</code></td>
<td>
<p>column name in <code>state_data</code> that holds the values to be plotted</p>
</td></tr>
<tr><td><code id="statebins_+3A_dark_label">dark_label</code>, <code id="statebins_+3A_light_label">light_label</code>, <code id="statebins_+3A_na_label">na_label</code></td>
<td>
<p>dark/light/NA label colors. The specified color will be used
when the algorithm determines labels should be inverted.</p>
</td></tr>
<tr><td><code id="statebins_+3A_font_size">font_size</code></td>
<td>
<p>font size (default = <code>3</code>)</p>
</td></tr>
<tr><td><code id="statebins_+3A_state_border_col">state_border_col</code></td>
<td>
<p>default &quot;<code>white</code>&quot; - this creates the &quot;spaces&quot; between boxes</p>
</td></tr>
<tr><td><code id="statebins_+3A_state_border_size">state_border_size</code></td>
<td>
<p>border size</p>
</td></tr>
<tr><td><code id="statebins_+3A_round">round</code></td>
<td>
<p>rounded corners (default: <code>FALSE</code>)</p>
</td></tr>
<tr><td><code id="statebins_+3A_radius">radius</code></td>
<td>
<p>if <code>round</code> is <code>TRUE</code> then use <code>grid::unit</code> to specify the corner radius.
Default is <code>grid::unit(6, "pt")</code> if using rounded corners.</p>
</td></tr>
<tr><td><code id="statebins_+3A_ggplot2_scale_function">ggplot2_scale_function</code></td>
<td>
<p>ggplot2 scale function to use. Defaults to <code>scale_fill_distiller</code>
since you're likely passing in continuous data when you shouldn't be :-)</p>
</td></tr>
<tr><td><code id="statebins_+3A_...">...</code></td>
<td>
<p>additional parameters to the scale function</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>state_col</code> and <code>value_col</code> parameters default to <code>state</code> and <code>value</code>. That means
if you name the columns you want to plot with those names, you can forego passing them
in. Othersise, use <code>"strings"</code>.
</p>
<p>A <em>handy</em> feature of this function is that you can specify a <code>dark_label</code> color
and a <code>light_label</code> color. What does that mean? Well, you also pass in the
color scale function you're going to use and <code>statebins</code> will apply it and use
that information to determine what the tile color is and &mdash; if it's &quot;dark&quot; it will
use the <code>light_label</code> and if it's &quot;light&quot; it will use the <code>dark_label</code> color. That
means the labels will never blend in to the background (as long as you specify
decent label colors).
</p>
<p>You can customize the scale function you pass in by using name parameters. All named
parameters not used by <code>statebins()</code> itself get passed to the scale function.
</p>


<h3>Value</h3>

<p>ggplot2 object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(USArrests)

USArrests$state &lt;- rownames(USArrests)
statebins(USArrests, value_col="Assault", name = "Assault") +
  theme_statebins(legend_position="right")
</code></pre>

<hr>
<h2 id='statebins-package'>Create United States Uniform Cartogram Heatmaps</h2><span id='topic+statebins-package'></span>

<h3>Description</h3>

<p>The cartogram heatmaps generated by the included methods
are an alternative to choropleth maps for the United States
and are based on work by the Washington Post graphics department in their report
on &quot;The states most threatened by trade&quot;
(<a href="http://www.washingtonpost.com/wp-srv/special/business/states-most-threatened-by-trade/">http://www.washingtonpost.com/wp-srv/special/business/states-most-threatened-by-trade/</a>).
&quot;State bins&quot; preserve as much of the geographic placement of the states as
possible but have the look and feel of a traditional heatmap. Functions are
provided that allow for use of a binned, discrete scale, a continuous scale
or manually specified colors depending on what is needed for the underlying data.
</p>


<h3>Author(s)</h3>

<p>Bob Rudis (bob@rud.is)
</p>

<hr>
<h2 id='theme_statebins'>Base statebins theme</h2><span id='topic+theme_statebins'></span>

<h3>Description</h3>

<p>Clears out most of the cruft. Builds off of <code>theme_bw()</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>theme_statebins(legend_position = "bottom", base_size = 11, base_family = "")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="theme_statebins_+3A_legend_position">legend_position</code></td>
<td>
<p>fills in <code>legend.position</code></p>
</td></tr>
<tr><td><code id="theme_statebins_+3A_base_family">base_family</code>, <code id="theme_statebins_+3A_base_size">base_size</code></td>
<td>
<p>same as <code>theme_bw()</code></p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
