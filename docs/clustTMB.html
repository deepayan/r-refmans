<!DOCTYPE html><html lang="en"><head><title>Help for package clustTMB</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {clustTMB}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#clustTMB'><p>Fit a finite mixture model using TMB</p></a></li>
<li><a href='#coef.clustTMB'><p>Get fixed-effect coefficients</p></a></li>
<li><a href='#extractAIC.clustTMB'><p>Extract the AIC of a clustTMB model</p></a></li>
<li><a href='#fixStruct.names'><p>Fixed Covariance Structure names</p></a></li>
<li><a href='#init.options'><p>Initialization options with S3 classes</p></a></li>
<li><a href='#logLik.clustTMB'><p>Extract the log likelihood of a clustTMB model</p></a></li>
<li><a href='#lognormal'><p>Lognormal family and link specification</p></a></li>
<li><a href='#mkInitClass'><p>Apply classification method dependent on init.method</p></a></li>
<li><a href='#parm.lookup'><p>Parameter Information</p></a></li>
<li><a href='#print.clustTMB'><p>Print brief model summary</p></a></li>
<li><a href='#run.options'><p>Run Options</p></a></li>
<li><a href='#setup.projDat'><p>Setup projection data for mkDat</p></a></li>
<li><a href='#setup.spatialDat'><p>Setup spatial data for mkDat</p></a></li>
<li><a href='#skewness'><p>Calculates skewness</p></a></li>
<li><a href='#spdeStruct'><p>Generate SPDE list needed as input to FEM-SPDE spatial TMB models</p></a></li>
<li><a href='#splitForm'><p>Split formula containing special random effect terms</p></a></li>
<li><a href='#summary.clustTMB'><p>summary tables of model parameters</p></a></li>
<li><a href='#tweedie'><p>Tweedie family and link specification</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Spatio-Temporal Finite Mixture Model using 'TMB'</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Fits a spatio-temporal finite mixture model using 'TMB'.
    Covariate, spatial and temporal random effects can be incorporated
    into the gating formula using multinomial logistic regression, the
    expert formula using a generalized linear mixed model framework, or
    both.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/Andrea-Havron/clustTMB">https://github.com/Andrea-Havron/clustTMB</a>,
<a href="https://andrea-havron.github.io/clustTMB/">https://andrea-havron.github.io/clustTMB/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/Andrea-Havron/clustTMB/issues">https://github.com/Andrea-Havron/clustTMB/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>cluster, clustMixType, fmesher, lme4, Matrix, mclust, methods,
reformulas, MoEClust, sf, stats, TMB (&ge; 1.9.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>bookdown, covr, cowplot, dplyr, FMsmsnReg, GGally, ggplot2,
ggspatial, giscoR, inlabru, kableExtra, knitr, magrittr,
MixSim, mvnfast, mvtnorm, palmerpenguins, rmarkdown, sdmTMB,
sp, spData, splancs, testthat, tidyr, tweedie, wesanderson</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>RcppEigen, TMB</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>GNU make</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-10-09 22:38:03 UTC; andrea.havron</td>
</tr>
<tr>
<td>Author:</td>
<td>Andrea M. Havron <a href="https://orcid.org/0000-0002-4080-448X"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre, cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Andrea M. Havron &lt;andrea.havron@noaa.gov&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-10-14 11:50:46 UTC</td>
</tr>
</table>
<hr>
<h2 id='clustTMB'>Fit a finite mixture model using TMB</h2><span id='topic+clustTMB'></span>

<h3>Description</h3>

<p>Fit a finite mixture model using TMB
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clustTMB(
  response = NULL,
  expertformula = ~1,
  gatingformula = ~1,
  expertdata = NULL,
  gatingdata = NULL,
  family = gaussian(link = "identity"),
  Offset = NULL,
  G = 2,
  rr = list(spatial = NULL, temporal = NULL, random = NULL),
  covariance.structure = NULL,
  Start = list(),
  Map = list(),
  initialization.args = list(control = init.options()),
  spatial.list = list(loc = NULL, mesh = NULL, init.range = list(gating.range = NULL,
    expert.range = NULL)),
  projection.dat = NULL,
  control = run.options()
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="clustTMB_+3A_response">response</code></td>
<td>
<p>A numeric vector, matrix, or data frame of observations. When data are multivariate, rows correspond to observations and columns correspond to the multivariate response.</p>
</td></tr>
<tr><td><code id="clustTMB_+3A_expertformula">expertformula</code></td>
<td>
<p>Formula defining expert model. This formula corresponds to the covariates included in the response densities. Defaults to intercept only (~1) when no covariates are used.</p>
</td></tr>
<tr><td><code id="clustTMB_+3A_gatingformula">gatingformula</code></td>
<td>
<p>Formula defining gating model.  This formula corresponds to the covariates included in the mixing proportions (logistic regression). Defaults to intercept only (~1) when no covariates are used. When a random effects term is included in the gating network, this formula will be updated so that the intercept term is removed.</p>
</td></tr>
<tr><td><code id="clustTMB_+3A_expertdata">expertdata</code></td>
<td>
<p>Data frame containing expert model covariates.</p>
</td></tr>
<tr><td><code id="clustTMB_+3A_gatingdata">gatingdata</code></td>
<td>
<p>Data frame containing gating model covariates.</p>
</td></tr>
<tr><td><code id="clustTMB_+3A_family">family</code></td>
<td>
<p>Statistical distribution and link function of observations.</p>
</td></tr>
<tr><td><code id="clustTMB_+3A_offset">Offset</code></td>
<td>
<p>Constant in expertformula only used to offset density expectation.</p>
</td></tr>
<tr><td><code id="clustTMB_+3A_g">G</code></td>
<td>
<p>Integer specifying the number of clusters.</p>
</td></tr>
<tr><td><code id="clustTMB_+3A_rr">rr</code></td>
<td>
<p>List specifying dimension of rank reduction in spatial, temporal, and/or random effects. Dimension must be smaller than the total dimension of the response. Rank reduction is applied only to the expertformula random effects. The rank reduction reduces the dimensionality of a correlated multivariate response to a smaller dimension independent response. When used, the covariance structure of the response is switched to 'Diagonal.' Defaults to NULL, no rank reduction. If rank reduction is used in conjunction with a random effect, that random effect must also be specified in the expert formula. Currently, rank reduction on temporal random effects is disabled.</p>
</td></tr>
<tr><td><code id="clustTMB_+3A_covariance.structure">covariance.structure</code></td>
<td>
<p>A character string specifying the covariance structure of the response using mclust naming scheme. See description of modelNames under ?Mclust for details.</p>
</td></tr>
<tr><td><code id="clustTMB_+3A_start">Start</code></td>
<td>
<p>Set initial values for random effects parameters (fixed and random terms)</p>
</td></tr>
<tr><td><code id="clustTMB_+3A_map">Map</code></td>
<td>
<p>Vector indicating parameter maps, see ?<code><a href="TMB.html#topic+MakeADFun">TMB::MakeADFun()</a></code> for details. Defaults in clustTMB control this map argument and user input is limited</p>
</td></tr>
<tr><td><code id="clustTMB_+3A_initialization.args">initialization.args</code></td>
<td>
<p>A list consisting of initialization settings used to generate initial values.
control Calls <code><a href="#topic+init.options">init.options()</a></code> to generate settings for initial values. Arguments of <code><a href="#topic+init.options">init.options()</a></code> can be specified by the user.
</p>

<ol>
<li><p> init.method - Single character string indicating initial clustering method. Methods include: hc, quantile, random, mclust, kmeans, mixed, user. Defaults to 'hc'. In the case where data are univariate and there are no covariates in the gating/expert formula, this defaults to 'quantile'
</p>
</li>
<li><p> hc.options - Named list of two character strings specifying hc modelName and hcUse when init.method = 'hc'. The default modelName is 'VVV' and the default use is 'SVD' unless gating/expert covariates specified, in which case default in VARS. See ?mclust::mclust.options for complete list of options.
</p>
</li>
<li><p> mix.method - String stating initialization method for mixed-type data (init.method = 'mixed'). Current default when Tweedie family specified. Options include: Gower kmeans (default), Gower hclust, and kproto.
</p>
</li>
<li><p> user - Numeric or character vector defining user specified initial classification. init.method must be set to 'user' when using this option.
</p>
</li></ol>
</td></tr>
<tr><td><code id="clustTMB_+3A_spatial.list">spatial.list</code></td>
<td>
<p>List of data objects needed when fitting a spatial GMRF model</p>
</td></tr>
<tr><td><code id="clustTMB_+3A_projection.dat">projection.dat</code></td>
<td>
<p>Spatial Points class of projection coordinates or Spatial Points Dataframe containing projection coordinates and projection covariates</p>
</td></tr>
<tr><td><code id="clustTMB_+3A_control">control</code></td>
<td>
<p>List controlling whether models are run and whether standard errors are calculated.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of objects from fitted model
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("faithful")
m1 &lt;- clustTMB(response = faithful, covariance.structure = "VVV")
plot(faithful$eruptions, faithful$waiting, pch = 16, col = m1$report$classification + 1)
</code></pre>

<hr>
<h2 id='coef.clustTMB'>Get fixed-effect coefficients</h2><span id='topic+coef.clustTMB'></span>

<h3>Description</h3>

<p>Get fixed-effect coefficients
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'clustTMB'
coef(object, complete = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coef.clustTMB_+3A_object">object</code></td>
<td>
<p>The fitted clustTMB model</p>
</td></tr>
<tr><td><code id="coef.clustTMB_+3A_complete">complete</code></td>
<td>
<p>Currently ignored</p>
</td></tr>
<tr><td><code id="coef.clustTMB_+3A_...">...</code></td>
<td>
<p>Currently ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>names numeric vector
</p>

<hr>
<h2 id='extractAIC.clustTMB'>Extract the AIC of a clustTMB model</h2><span id='topic+extractAIC.clustTMB'></span>

<h3>Description</h3>

<p>Extract the AIC of a clustTMB model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'clustTMB'
extractAIC(fit, scale, k = 2, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extractAIC.clustTMB_+3A_fit">fit</code></td>
<td>
<p>The fitted clustTMB model</p>
</td></tr>
<tr><td><code id="extractAIC.clustTMB_+3A_scale">scale</code></td>
<td>
<p>The scale, currently ignored</p>
</td></tr>
<tr><td><code id="extractAIC.clustTMB_+3A_k">k</code></td>
<td>
<p>Penalization parameter, defaults to 2</p>
</td></tr>
<tr><td><code id="extractAIC.clustTMB_+3A_...">...</code></td>
<td>
<p>Currently ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric value
</p>

<hr>
<h2 id='fixStruct.names'>Fixed Covariance Structure names</h2><span id='topic+fixStruct.names'></span>

<h3>Description</h3>

<p>Fixed Covariance Structure names
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fixStruct.names()
</code></pre>


<h3>Value</h3>

<p>character vector naming available fixed Covariance Structures
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fixStruct.names()
</code></pre>

<hr>
<h2 id='init.options'>Initialization options with S3 classes</h2><span id='topic+init.options'></span>

<h3>Description</h3>

<p>Initialization options with S3 classes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>init.options(
  init.method = "hc",
  hc.options = list(modelName = "VVV", use = "SVD"),
  exp.init = list(mahala = TRUE),
  mix.method = "Gower kmeans",
  user.class = integer()
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="init.options_+3A_init.method">init.method</code></td>
<td>
<p>Name of method used to set initial values. If init.method = 'user', must define 'user.class' with a classification vector.</p>
</td></tr>
<tr><td><code id="init.options_+3A_hc.options">hc.options</code></td>
<td>
<p>Model names and use when init.method is 'hc' following conventions of mclust::mclust.options()</p>
</td></tr>
<tr><td><code id="init.options_+3A_exp.init">exp.init</code></td>
<td>
<p>Turn on mahala initialization when expert network</p>
</td></tr>
<tr><td><code id="init.options_+3A_mix.method">mix.method</code></td>
<td>
<p>Initialization methods when data are mixed. Default method when data are Tweedie distributed.</p>
</td></tr>
<tr><td><code id="init.options_+3A_user.class">user.class</code></td>
<td>
<p>Vector of classification vector set by user and required when init.method = 'user'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of initialization specifications
</p>


<h3>Examples</h3>

<pre><code class='language-R'>init.options()
init.options(init.method = "hc")
init.options(init.method = "mixed")
init.options(init.method = "user", user.class = c(1, 1, 2, 1, 3, 3, 1, 2))
</code></pre>

<hr>
<h2 id='logLik.clustTMB'>Extract the log likelihood of a clustTMB model</h2><span id='topic+logLik.clustTMB'></span>

<h3>Description</h3>

<p>Extract the log likelihood of a clustTMB model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'clustTMB'
logLik(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="logLik.clustTMB_+3A_object">object</code></td>
<td>
<p>The fitted clustTMB model</p>
</td></tr>
<tr><td><code id="logLik.clustTMB_+3A_...">...</code></td>
<td>
<p>Currently ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>object of class <code>logLik</code> with attributes
</p>

<hr>
<h2 id='lognormal'>Lognormal family and link specification</h2><span id='topic+lognormal'></span>

<h3>Description</h3>

<p>Lognormal family and link specification
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lognormal(link = "identity")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lognormal_+3A_link">link</code></td>
<td>
<p>link function association with family</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &quot;family&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fam &lt;- lognormal()
fam$family
fam$link
</code></pre>

<hr>
<h2 id='mkInitClass'>Apply classification method dependent on init.method</h2><span id='topic+mkInitClass'></span>

<h3>Description</h3>

<p>Apply classification method dependent on init.method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mkInitClass(n.g, n.i, n.j, control, y)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mkInitClass_+3A_n.g">n.g</code></td>
<td>
<p>Number of clusters</p>
</td></tr>
<tr><td><code id="mkInitClass_+3A_n.i">n.i</code></td>
<td>
<p>Number of observations</p>
</td></tr>
<tr><td><code id="mkInitClass_+3A_n.j">n.j</code></td>
<td>
<p>Number of columns</p>
</td></tr>
<tr><td><code id="mkInitClass_+3A_control">control</code></td>
<td>
<p>Classification settings from <code><a href="#topic+init.options">init.options()</a></code></p>
</td></tr>
<tr><td><code id="mkInitClass_+3A_y">y</code></td>
<td>
<p>Observations</p>
</td></tr>
</table>


<h3>Value</h3>

<p>classification vector
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("faithful")
mkInitClass(2, nrow(faithful), ncol(faithful), init.options(), faithful)
</code></pre>

<hr>
<h2 id='parm.lookup'>Parameter Information</h2><span id='topic+parm.lookup'></span>

<h3>Description</h3>

<p>Parameter Information
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parm.lookup()
</code></pre>


<h3>Value</h3>

<p>Description of parameters, including dimension and structure
</p>


<h3>Examples</h3>

<pre><code class='language-R'>parm.lookup()
</code></pre>

<hr>
<h2 id='print.clustTMB'>Print brief model summary</h2><span id='topic+print.clustTMB'></span>

<h3>Description</h3>

<p>Invoke TMB's print.report function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'clustTMB'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.clustTMB_+3A_x">x</code></td>
<td>
<p>The fitted clustTMB model</p>
</td></tr>
<tr><td><code id="print.clustTMB_+3A_...">...</code></td>
<td>
<p>Not used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric matrix of parameter estimate and standard errors
</p>

<hr>
<h2 id='run.options'>Run Options</h2><span id='topic+run.options'></span>

<h3>Description</h3>

<p>Run Options
</p>


<h3>Usage</h3>

<pre><code class='language-R'>run.options(check.input = NULL, run.model = NULL, do.sdreport = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="run.options_+3A_check.input">check.input</code></td>
<td>
<p>TRUE: Return initial values before running TMB</p>
</td></tr>
<tr><td><code id="run.options_+3A_run.model">run.model</code></td>
<td>
<p>FALSE: Return TMB object before optimizing model</p>
</td></tr>
<tr><td><code id="run.options_+3A_do.sdreport">do.sdreport</code></td>
<td>
<p>TRUE: Run delta method to obtain standard errors</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list
</p>


<h3>Examples</h3>

<pre><code class='language-R'>run.options()
</code></pre>

<hr>
<h2 id='setup.projDat'>Setup projection data for mkDat</h2><span id='topic+setup.projDat'></span>

<h3>Description</h3>

<p>Setup projection data for mkDat
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setup.projDat(mesh, projection.dat, expert.formula, gating.formula)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="setup.projDat_+3A_mesh">mesh</code></td>
<td>
<p>spatial constrained Delaunay triangulation derived from the fmesher R package</p>
</td></tr>
<tr><td><code id="setup.projDat_+3A_projection.dat">projection.dat</code></td>
<td>
<p>Spatial Points class of projection coordinates or Spatial Points Dataframe containing projection coordinates and projection covariates</p>
</td></tr>
<tr><td><code id="setup.projDat_+3A_expert.formula">expert.formula</code></td>
<td>
<p>Formula defining expert model. This formula corresponds to the covariates included in the response densities. Defaults to intercept only (~1) when no covariates are used.</p>
</td></tr>
<tr><td><code id="setup.projDat_+3A_gating.formula">gating.formula</code></td>
<td>
<p>Formula defining gating model. This formula corresponds to the covariates included in the mixing proportions (logistic regression). Defaults to intercept only (~1) when no covariates are used. When a random effects term is included in the gating network, this formula will be updated so that the intercept term is removed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of projection data
</p>

<hr>
<h2 id='setup.spatialDat'>Setup spatial data for mkDat</h2><span id='topic+setup.spatialDat'></span>

<h3>Description</h3>

<p>Setup spatial data for mkDat
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setup.spatialDat(n.i, spatial.list, projection.dat)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="setup.spatialDat_+3A_n.i">n.i</code></td>
<td>
<p>number of observations</p>
</td></tr>
<tr><td><code id="setup.spatialDat_+3A_spatial.list">spatial.list</code></td>
<td>
<p>list of spatial locations and mesh</p>
</td></tr>
<tr><td><code id="setup.spatialDat_+3A_projection.dat">projection.dat</code></td>
<td>
<p>Points class of projection coordinates or Spatial Points Dataframe containing projection coordinates and projection covariates</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of spatial mesh and sparse A matrix
</p>

<hr>
<h2 id='skewness'>Calculates skewness</h2><span id='topic+skewness'></span>

<h3>Description</h3>

<p>Calculates skewness
</p>


<h3>Usage</h3>

<pre><code class='language-R'>skewness(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="skewness_+3A_x">x</code></td>
<td>
<p>numeric vector of values for which skewness is calculated</p>
</td></tr>
</table>


<h3>Value</h3>

<p>skewness value of x
</p>


<h3>Examples</h3>

<pre><code class='language-R'>skewness(rgamma(100, 1, 1))
</code></pre>

<hr>
<h2 id='spdeStruct'>Generate SPDE list needed as input to FEM-SPDE spatial TMB models</h2><span id='topic+spdeStruct'></span>

<h3>Description</h3>

<p>Generate SPDE list needed as input to FEM-SPDE spatial TMB models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spdeStruct(mesh)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="spdeStruct_+3A_mesh">mesh</code></td>
<td>
<p>mesh object generated from <code><a href="fmesher.html#topic+fm_rcdt_2d">fmesher::fm_rcdt_2d()</a></code> or <code><a href="fmesher.html#topic+fm_mesh_2d">fmesher::fm_mesh_2d()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>spde List used as input into TMB anisotropic model
</p>

<hr>
<h2 id='splitForm'>Split formula containing special random effect terms</h2><span id='topic+splitForm'></span>

<h3>Description</h3>

<p>Parse a formula into fixed formula and random effect terms,
treating 'special' terms appropriately
</p>


<h3>Usage</h3>

<pre><code class='language-R'>splitForm(
  formula,
  defaultTerm = "norm",
  allowFixedOnly = TRUE,
  allowNoSpecials = TRUE,
  debug = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="splitForm_+3A_formula">formula</code></td>
<td>
<p>a formula containing special random effect terms</p>
</td></tr>
<tr><td><code id="splitForm_+3A_defaultterm">defaultTerm</code></td>
<td>
<p>default type for non-special RE terms</p>
</td></tr>
<tr><td><code id="splitForm_+3A_allowfixedonly">allowFixedOnly</code></td>
<td>
<p>(logical) are formulas with no RE terms OK?</p>
</td></tr>
<tr><td><code id="splitForm_+3A_allownospecials">allowNoSpecials</code></td>
<td>
<p>(logical) are formulas with only standard RE terms OK?</p>
</td></tr>
<tr><td><code id="splitForm_+3A_debug">debug</code></td>
<td>
<p>(logical) debug?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Taken from Steve Walker's lme4ord,
ultimately from the flexLambda branch of lme4
<a href="https://github.com/stevencarlislewalker/lme4ord/blob/master/R/formulaParsing.R">https://github.com/stevencarlislewalker/lme4ord/blob/master/R/formulaParsing.R</a>.  Mostly for internal use.
</p>


<h3>Value</h3>

<p>a list containing elements <code>fixedFormula</code>;
<code>reTrmFormulas</code> list of <code>x | g</code> formulas for each term;
<code>reTrmAddArgs</code> list of function+additional arguments, i.e. <code>list()</code> (non-special), <code>foo()</code> (no additional arguments), <code>foo(addArgs)</code> (additional arguments); <code>reTrmClasses</code> (vector of special functions/classes, as character)
</p>


<h3>Author(s)</h3>

<p>Steve Walker
</p>


<h3>Examples</h3>

<pre><code class='language-R'>splitForm(~x+y)                     ## no specials or RE
splitForm(~x+y+(f|g))               ## no specials
splitForm(~x+y+diag(f|g))           ## one special
splitForm(~x+y+(diag(f|g)))         ## 'hidden' special
splitForm(~x+y+(f|g)+cs(1|g))       ## combination
splitForm(~x+y+(1|f/g))             ## 'slash'; term
splitForm(~x+y+(1|f/g/h))             ## 'slash'; term
splitForm(~x+y+(1|(f/g)/h))             ## 'slash'; term
splitForm(~x+y+(f|g)+cs(1|g)+cs(a|b,stuff))  ## complex special
splitForm(~(((x+y))))               ## lots of parentheses
splitForm(~1+rr(f|g,n=2))

</code></pre>

<hr>
<h2 id='summary.clustTMB'>summary tables of model parameters</h2><span id='topic+summary.clustTMB'></span>

<h3>Description</h3>

<p>Invoke TMB's summary.sdreport function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'clustTMB'
summary(
  object,
  select = c("all", "fixed", "random", "report"),
  p.value = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.clustTMB_+3A_object">object</code></td>
<td>
<p>The fitted clustTMB model</p>
</td></tr>
<tr><td><code id="summary.clustTMB_+3A_select">select</code></td>
<td>
<p>Parameter classes to select. Can be any subset of
<code>"fixed"</code> (<code class="reqn">\hat{\theta}</code>), <code>"random"</code> (<code class="reqn">\hat{u}</code>) or
<code>"report"</code> (<code class="reqn">\phi(\hat{u},\hat{\theta)}</code>) using notation as
<code><a href="TMB.html#topic+sdreport">TMB::sdreport()</a></code>.</p>
</td></tr>
<tr><td><code id="summary.clustTMB_+3A_p.value">p.value</code></td>
<td>
<p>Add column with approximate p-values</p>
</td></tr>
<tr><td><code id="summary.clustTMB_+3A_...">...</code></td>
<td>
<p>Currently ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric matrix of parameter estimate and standard errors
</p>

<hr>
<h2 id='tweedie'>Tweedie family and link specification</h2><span id='topic+tweedie'></span>

<h3>Description</h3>

<p>Tweedie family and link specification
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tweedie(link = "log")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tweedie_+3A_link">link</code></td>
<td>
<p>link function association with family</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &quot;family&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fam &lt;- tweedie()
fam$family
fam$link
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
