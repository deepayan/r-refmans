<!DOCTYPE html><html lang="en"><head><title>Help for package animl</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {animl}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#build_file_manifest'><p>File Management Module</p></a></li>
<li><a href='#check_file'><p>Check for files existence and prompt user if they want to load</p></a></li>
<li><a href='#crop_images'><p>Crops all images from an input file with specific required columns: Frame,</p>
bbox1, bbox2, bbox3, and bbox4</a></li>
<li><a href='#detect_MD_batch'><p>Apply MegaDetector to a Given Batch of Images</p></a></li>
<li><a href='#extract_frame_single'><p>Extract Frames for Single Video</p></a></li>
<li><a href='#extract_frames'><p>Extract frames from video for classification</p></a></li>
<li><a href='#extract_frames_old'><p>Extract frames from video for classification</p></a></li>
<li><a href='#get_animals'><p>Return a dataframe of only MD animals</p></a></li>
<li><a href='#get_empty'><p>Return MD empty, vehicle and human images in a dataframe</p></a></li>
<li><a href='#load_data'><p>Load .csv or .Rdata file</p></a></li>
<li><a href='#load_model'><p>Load a Classifier Model with animl-py</p></a></li>
<li><a href='#megadetector'><p>Load MegaDetector</p></a></li>
<li><a href='#parse_MD'><p>parse MD results into a simple dataframe</p></a></li>
<li><a href='#plot_boxes'><p>Plot bounding boxes on image from md results</p></a></li>
<li><a href='#predict_species'><p>Infer Species for Given Detections</p></a></li>
<li><a href='#remove_link'><p>Remove Sorted Links</p></a></li>
<li><a href='#save_data'><p>Save Data to Given File</p></a></li>
<li><a href='#sequence_classification'><p>Leverage sequences to classify images</p></a></li>
<li><a href='#sort_MD'><p>Create SymLink Directories and Sort Classified Images Based on MD Results</p></a></li>
<li><a href='#sort_species'><p>Create SymLink Directories and Sort Classified Images</p></a></li>
<li><a href='#update_labels'><p>Udate Results from File Browser</p></a></li>
<li><a href='#WorkingDirectory'><p>Set Working Directory and Save File Global Variables</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>A Collection of ML Tools for Conservation Research</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions required to classify subjects within camera trap field data. The package can handle both images and videos. The authors recommend a two-step approach using Microsoft's 'MegaDector' model and then a second model trained on the classes of interest.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Imports:</td>
<td>grDevices, methods, pbapply, dplyr, jpeg, reticulate,
parallel, exifr, av, magrittr, stats, rlang,</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-02-11 22:48:40 UTC; kyra</td>
</tr>
<tr>
<td>Author:</td>
<td>Kyra Swanson <a href="https://orcid.org/0000-0002-1496-3217"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Mathias Tobler [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Kyra Swanson &lt;tswanson@sdzwa.org&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-02-11 23:10:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='build_file_manifest'>File Management Module</h2><span id='topic+build_file_manifest'></span>

<h3>Description</h3>

<p>This module provides functions and classes for managing files and directories.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>build_file_manifest(
  image_dir,
  exif = TRUE,
  out_file = NULL,
  offset = 0,
  recursive = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="build_file_manifest_+3A_image_dir">image_dir</code></td>
<td>
<p>folder to search through and find media files</p>
</td></tr>
<tr><td><code id="build_file_manifest_+3A_exif">exif</code></td>
<td>
<p>returns date and time information from exif data, defaults to true</p>
</td></tr>
<tr><td><code id="build_file_manifest_+3A_out_file">out_file</code></td>
<td>
<p>directory to save .csv of manifest to</p>
</td></tr>
<tr><td><code id="build_file_manifest_+3A_offset">offset</code></td>
<td>
<p>add offset in hours for videos when using the File Modified date, defaults to 0</p>
</td></tr>
<tr><td><code id="build_file_manifest_+3A_recursive">recursive</code></td>
<td>
<p>Should directories be scanned recursively? Default TRUE</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Kyra Swanson 2023
Find Image/Video Files and Gather exif Data
</p>


<h3>Value</h3>

<p>files dataframe with or without file dates
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
files &lt;- build_file_manifest("C:\\Users\\usr\\Pictures\\")

## End(Not run)
</code></pre>

<hr>
<h2 id='check_file'>Check for files existence and prompt user if they want to load</h2><span id='topic+check_file'></span>

<h3>Description</h3>

<p>Check for files existence and prompt user if they want to load
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_file(file)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check_file_+3A_file">file</code></td>
<td>
<p>the full path of the file to check</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a boolean indicating wether a file was found
and the user wants to load or not
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  checkFile("path/to/newfile.csv")

## End(Not run)
</code></pre>

<hr>
<h2 id='crop_images'>Crops all images from an input file with specific required columns: Frame,
bbox1, bbox2, bbox3, and bbox4</h2><span id='topic+crop_images'></span>

<h3>Description</h3>

<p>Crops all images from an input file with specific required columns: Frame,
bbox1, bbox2, bbox3, and bbox4
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crop_images(imagelist, outdir)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="crop_images_+3A_imagelist">imagelist</code></td>
<td>
<p>The path for the input csv file</p>
</td></tr>
<tr><td><code id="crop_images_+3A_outdir">outdir</code></td>
<td>
<p>The path where generated cropped images should be uploaded</p>
</td></tr>
</table>


<h3>Value</h3>

<p>no return value, outputs the cropped image
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
cropImagesFromFile("/image/path/file.csv", "/output/path/")

## End(Not run)
</code></pre>

<hr>
<h2 id='detect_MD_batch'>Apply MegaDetector to a Given Batch of Images</h2><span id='topic+detect_MD_batch'></span>

<h3>Description</h3>

<p>Apply MegaDetector to a Given Batch of Images
</p>


<h3>Usage</h3>

<pre><code class='language-R'>detect_MD_batch(
  detector,
  image_file_names,
  checkpoint_path = NULL,
  checkpoint_frequency = -1,
  confidence_threshold = 0.1,
  quiet = TRUE,
  image_size = NULL,
  file_col = "Frame"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="detect_MD_batch_+3A_detector">detector</code></td>
<td>
<p>preloaded md model</p>
</td></tr>
<tr><td><code id="detect_MD_batch_+3A_image_file_names">image_file_names</code></td>
<td>
<p>list of image filenames, a single image filename, or folder</p>
</td></tr>
<tr><td><code id="detect_MD_batch_+3A_checkpoint_path">checkpoint_path</code></td>
<td>
<p>path to checkpoint file</p>
</td></tr>
<tr><td><code id="detect_MD_batch_+3A_checkpoint_frequency">checkpoint_frequency</code></td>
<td>
<p>write results to checkpoint file every N images</p>
</td></tr>
<tr><td><code id="detect_MD_batch_+3A_confidence_threshold">confidence_threshold</code></td>
<td>
<p>only detections above this threshold are returned</p>
</td></tr>
<tr><td><code id="detect_MD_batch_+3A_quiet">quiet</code></td>
<td>
<p>print debugging statements when false, defaults to true</p>
</td></tr>
<tr><td><code id="detect_MD_batch_+3A_image_size">image_size</code></td>
<td>
<p>overrides default image size, 1280</p>
</td></tr>
<tr><td><code id="detect_MD_batch_+3A_file_col">file_col</code></td>
<td>
<p>select which column if image_file_names is a manifest</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of dictionaries of MegaDetector detections
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: mdres &lt;- detectMD_batch(md_py, allframes$Frame)
</code></pre>

<hr>
<h2 id='extract_frame_single'>Extract Frames for Single Video</h2><span id='topic+extract_frame_single'></span>

<h3>Description</h3>

<p>Extract Frames for Single Video
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_frame_single(file_path, out_dir, fps = NULL, frames = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extract_frame_single_+3A_file_path">file_path</code></td>
<td>
<p>filepath to image</p>
</td></tr>
<tr><td><code id="extract_frame_single_+3A_out_dir">out_dir</code></td>
<td>
<p>directory to save frames to</p>
</td></tr>
<tr><td><code id="extract_frame_single_+3A_fps">fps</code></td>
<td>
<p>number of frames per second to save</p>
</td></tr>
<tr><td><code id="extract_frame_single_+3A_frames">frames</code></td>
<td>
<p>number of frames evenly distributed to save</p>
</td></tr>
</table>


<h3>Value</h3>

<p>dataframe of filepaths, frame paths
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
result &lt;- extractFramesSingle(video$FilePath, out_dir, frames=3)

## End(Not run)
</code></pre>

<hr>
<h2 id='extract_frames'>Extract frames from video for classification</h2><span id='topic+extract_frames'></span>

<h3>Description</h3>

<p>This function can take
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_frames(
  files,
  out_dir = tempfile(),
  out_file = NULL,
  fps = NULL,
  frames = NULL,
  file_col = "FilePath",
  parallel = FALSE,
  workers = 1,
  checkpoint = 1000
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extract_frames_+3A_files">files</code></td>
<td>
<p>dataframe of videos</p>
</td></tr>
<tr><td><code id="extract_frames_+3A_out_dir">out_dir</code></td>
<td>
<p>directory to save frames to</p>
</td></tr>
<tr><td><code id="extract_frames_+3A_out_file">out_file</code></td>
<td>
<p>file to which results will be saved</p>
</td></tr>
<tr><td><code id="extract_frames_+3A_fps">fps</code></td>
<td>
<p>frames per second, otherwise determine mathematically</p>
</td></tr>
<tr><td><code id="extract_frames_+3A_frames">frames</code></td>
<td>
<p>number of frames to sample</p>
</td></tr>
<tr><td><code id="extract_frames_+3A_file_col">file_col</code></td>
<td>
<p>string value indexing which column contains file paths</p>
</td></tr>
<tr><td><code id="extract_frames_+3A_parallel">parallel</code></td>
<td>
<p>Toggle for parallel processing, defaults to FALSE</p>
</td></tr>
<tr><td><code id="extract_frames_+3A_workers">workers</code></td>
<td>
<p>number of processors to use if parallel, defaults to 1</p>
</td></tr>
<tr><td><code id="extract_frames_+3A_checkpoint">checkpoint</code></td>
<td>
<p>if not parallel, checkpoint ever n files, defaults to 1000</p>
</td></tr>
</table>


<h3>Value</h3>

<p>dataframe of still frames for each video
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
frames &lt;- extractFrames(videos, out_dir = "C:\\Users\\usr\\Videos\\", frames = 5)

## End(Not run)
</code></pre>

<hr>
<h2 id='extract_frames_old'>Extract frames from video for classification</h2><span id='topic+extract_frames_old'></span>

<h3>Description</h3>

<p>This function can take
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_frames_old(
  files,
  out_dir = tempfile(),
  out_file = NULL,
  fps = NULL,
  frames = NULL,
  file_col = "FilePath",
  parallel = FALSE,
  workers = 1,
  checkpoint = 1000
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extract_frames_old_+3A_files">files</code></td>
<td>
<p>dataframe of videos</p>
</td></tr>
<tr><td><code id="extract_frames_old_+3A_out_dir">out_dir</code></td>
<td>
<p>directory to save frames to</p>
</td></tr>
<tr><td><code id="extract_frames_old_+3A_out_file">out_file</code></td>
<td>
<p>file to which results will be saved</p>
</td></tr>
<tr><td><code id="extract_frames_old_+3A_fps">fps</code></td>
<td>
<p>frames per second, otherwise determine mathematically</p>
</td></tr>
<tr><td><code id="extract_frames_old_+3A_frames">frames</code></td>
<td>
<p>number of frames to sample</p>
</td></tr>
<tr><td><code id="extract_frames_old_+3A_file_col">file_col</code></td>
<td>
<p>string value indexing which column contains file paths</p>
</td></tr>
<tr><td><code id="extract_frames_old_+3A_parallel">parallel</code></td>
<td>
<p>Toggle for parallel processing, defaults to FALSE</p>
</td></tr>
<tr><td><code id="extract_frames_old_+3A_workers">workers</code></td>
<td>
<p>number of processors to use if parallel, defaults to 1</p>
</td></tr>
<tr><td><code id="extract_frames_old_+3A_checkpoint">checkpoint</code></td>
<td>
<p>if not parallel, checkpoint ever n files, defaults to 1000</p>
</td></tr>
</table>


<h3>Value</h3>

<p>dataframe of still frames for each video
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
frames &lt;- extractFrames(videos, out_dir = "C:\\Users\\usr\\Videos\\", frames = 5)

## End(Not run)
</code></pre>

<hr>
<h2 id='get_animals'>Return a dataframe of only MD animals</h2><span id='topic+get_animals'></span>

<h3>Description</h3>

<p>Return a dataframe of only MD animals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_animals(manifest)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_animals_+3A_manifest">manifest</code></td>
<td>
<p>all megadetector frames</p>
</td></tr>
</table>


<h3>Value</h3>

<p>animal frames classified by MD
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
animals &lt;- getAnimals(imagesall)

## End(Not run)
</code></pre>

<hr>
<h2 id='get_empty'>Return MD empty, vehicle and human images in a dataframe</h2><span id='topic+get_empty'></span>

<h3>Description</h3>

<p>Return MD empty, vehicle and human images in a dataframe
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_empty(manifest)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_empty_+3A_manifest">manifest</code></td>
<td>
<p>all megadetector frames</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of empty/human/vehicle allframes with md classification
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
empty &lt;- getEmpty(imagesall)

## End(Not run)
</code></pre>

<hr>
<h2 id='load_data'>Load .csv or .Rdata file</h2><span id='topic+load_data'></span>

<h3>Description</h3>

<p>Load .csv or .Rdata file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>load_data(file)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="load_data_+3A_file">file</code></td>
<td>
<p>the full path of the file to load</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data extracted from the file
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  loadData("path/to/newfile.csv")

## End(Not run)
</code></pre>

<hr>
<h2 id='load_model'>Load a Classifier Model with animl-py</h2><span id='topic+load_model'></span>

<h3>Description</h3>

<p>Load a Classifier Model with animl-py
</p>


<h3>Usage</h3>

<pre><code class='language-R'>load_model(model_path, class_file, device = NULL, architecture = "CTL")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="load_model_+3A_model_path">model_path</code></td>
<td>
<p>path to model</p>
</td></tr>
<tr><td><code id="load_model_+3A_class_file">class_file</code></td>
<td>
<p>path to class list</p>
</td></tr>
<tr><td><code id="load_model_+3A_device">device</code></td>
<td>
<p>send model to the specified device</p>
</td></tr>
<tr><td><code id="load_model_+3A_architecture">architecture</code></td>
<td>
<p>model architecture</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of c(classifier, class_list)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: andes &lt;- loadModel('andes_v1.pt','andes_classes.csv')
</code></pre>

<hr>
<h2 id='megadetector'>Load MegaDetector</h2><span id='topic+megadetector'></span>

<h3>Description</h3>

<p>Load MegaDetector
</p>


<h3>Usage</h3>

<pre><code class='language-R'>megadetector(model_path, device = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="megadetector_+3A_model_path">model_path</code></td>
<td>
<p>path to MegaDetector model (v5)</p>
</td></tr>
<tr><td><code id="megadetector_+3A_device">device</code></td>
<td>
<p>load model onto given device description</p>
</td></tr>
</table>


<h3>Value</h3>

<p>megadetector object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: md_py &lt;- megadetector("/mnt/machinelearning/megaDetector/md_v5a.0.0.pt")
</code></pre>

<hr>
<h2 id='parse_MD'>parse MD results into a simple dataframe</h2><span id='topic+parse_MD'></span>

<h3>Description</h3>

<p>parse MD results into a simple dataframe
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parse_MD(
  results,
  manifest = NULL,
  out_file = NULL,
  buffer = 0.02,
  threshold = 0,
  file_col = "Frame"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="parse_MD_+3A_results">results</code></td>
<td>
<p>json output from megadetector</p>
</td></tr>
<tr><td><code id="parse_MD_+3A_manifest">manifest</code></td>
<td>
<p>dataframe containing all frames</p>
</td></tr>
<tr><td><code id="parse_MD_+3A_out_file">out_file</code></td>
<td>
<p>path to save dataframe</p>
</td></tr>
<tr><td><code id="parse_MD_+3A_buffer">buffer</code></td>
<td>
<p>percentage buffer to move bbox away from image edge</p>
</td></tr>
<tr><td><code id="parse_MD_+3A_threshold">threshold</code></td>
<td>
<p>confidence threshold to include bbox</p>
</td></tr>
<tr><td><code id="parse_MD_+3A_file_col">file_col</code></td>
<td>
<p>column in manifest that refers to file paths</p>
</td></tr>
</table>


<h3>Value</h3>

<p>original dataframe including md results
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
mdresults &lt;- parseMD(mdres)

## End(Not run)
</code></pre>

<hr>
<h2 id='plot_boxes'>Plot bounding boxes on image from md results</h2><span id='topic+plot_boxes'></span>

<h3>Description</h3>

<p>Plot bounding boxes on image from md results
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_boxes(image, label = FALSE, minconf = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_boxes_+3A_image">image</code></td>
<td>
<p>The mdres for the image</p>
</td></tr>
<tr><td><code id="plot_boxes_+3A_label">label</code></td>
<td>
<p>T/F toggle to plot MD category</p>
</td></tr>
<tr><td><code id="plot_boxes_+3A_minconf">minconf</code></td>
<td>
<p>minimum confidence to plot box</p>
</td></tr>
</table>


<h3>Value</h3>

<p>no return value, produces bounding box in plot panel
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
mdres &lt;- classifyImageMD(mdsession, images$FilePath[30000])
plotBoxes(mdres, minconf = 0.5)

## End(Not run)
</code></pre>

<hr>
<h2 id='predict_species'>Infer Species for Given Detections</h2><span id='topic+predict_species'></span>

<h3>Description</h3>

<p>Infer Species for Given Detections
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predict_species(
  detections,
  model,
  classes,
  device = NULL,
  out_file = NULL,
  raw = FALSE,
  file_col = "Frame",
  crop = TRUE,
  resize_width = 299,
  resize_height = 299,
  normalize = TRUE,
  batch_size = 1,
  workers = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict_species_+3A_detections">detections</code></td>
<td>
<p>manifest of animal detections</p>
</td></tr>
<tr><td><code id="predict_species_+3A_model">model</code></td>
<td>
<p>loaded classifier model</p>
</td></tr>
<tr><td><code id="predict_species_+3A_classes">classes</code></td>
<td>
<p>data.frame of classes</p>
</td></tr>
<tr><td><code id="predict_species_+3A_device">device</code></td>
<td>
<p>send model to the specified device</p>
</td></tr>
<tr><td><code id="predict_species_+3A_out_file">out_file</code></td>
<td>
<p>path to csv to save results to</p>
</td></tr>
<tr><td><code id="predict_species_+3A_raw">raw</code></td>
<td>
<p>output raw logits in addition to manifest</p>
</td></tr>
<tr><td><code id="predict_species_+3A_file_col">file_col</code></td>
<td>
<p>column in manifest containing file paths</p>
</td></tr>
<tr><td><code id="predict_species_+3A_crop">crop</code></td>
<td>
<p>use bbox to crop images before feeding into model</p>
</td></tr>
<tr><td><code id="predict_species_+3A_resize_width">resize_width</code></td>
<td>
<p>image width input size</p>
</td></tr>
<tr><td><code id="predict_species_+3A_resize_height">resize_height</code></td>
<td>
<p>image height input size</p>
</td></tr>
<tr><td><code id="predict_species_+3A_normalize">normalize</code></td>
<td>
<p>normalize the tensor before inference</p>
</td></tr>
<tr><td><code id="predict_species_+3A_batch_size">batch_size</code></td>
<td>
<p>batch size for generator</p>
</td></tr>
<tr><td><code id="predict_species_+3A_workers">workers</code></td>
<td>
<p>number of processes</p>
</td></tr>
</table>


<h3>Value</h3>

<p>detection manifest with added prediction and confidence columns
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: animals &lt;- predictSpecies(animals, classifier[[1]], classifier[[2]], raw=FALSE)
</code></pre>

<hr>
<h2 id='remove_link'>Remove Sorted Links</h2><span id='topic+remove_link'></span>

<h3>Description</h3>

<p>Remove Sorted Links
</p>


<h3>Usage</h3>

<pre><code class='language-R'>remove_link(manifest, link_col = "Link")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="remove_link_+3A_manifest">manifest</code></td>
<td>
<p>DataFrame of classified images</p>
</td></tr>
<tr><td><code id="remove_link_+3A_link_col">link_col</code></td>
<td>
<p>column in manifest that contains link paths</p>
</td></tr>
</table>


<h3>Value</h3>

<p>manifest without link column
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
remove_link(manifest)

## End(Not run)
</code></pre>

<hr>
<h2 id='save_data'>Save Data to Given File</h2><span id='topic+save_data'></span>

<h3>Description</h3>

<p>Save Data to Given File
</p>


<h3>Usage</h3>

<pre><code class='language-R'>save_data(data, out_file, prompt = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="save_data_+3A_data">data</code></td>
<td>
<p>the dataframe to be saved</p>
</td></tr>
<tr><td><code id="save_data_+3A_out_file">out_file</code></td>
<td>
<p>the full path of the saved file</p>
</td></tr>
<tr><td><code id="save_data_+3A_prompt">prompt</code></td>
<td>
<p>if true, prompts the user to confirm overwrite</p>
</td></tr>
</table>


<h3>Value</h3>

<p>none
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
 saveData(files,"path/to/newfile.csv")

## End(Not run)
</code></pre>

<hr>
<h2 id='sequence_classification'>Leverage sequences to classify images</h2><span id='topic+sequence_classification'></span>

<h3>Description</h3>

<p>This function applies image classifications at a sequence level by leveraging
information from multiple images. A sequence is defined as all images at the same
camera/station where the time between consecutive images is &lt;=maxdiff. This can improve
classification accuracy, but assumes that only one species is present in each sequence.
If you regularly expect multiple species to occur in an image or sequence don't use this function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sequence_classification(
  animals,
  empty = NULL,
  predictions,
  classes,
  stationcolumn,
  emptyclass = "",
  sortcolumns = NULL,
  recordfield = "FilePath",
  maxdiff = 60
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sequence_classification_+3A_animals">animals</code></td>
<td>
<p>sub-selection of all images that contain MD animals</p>
</td></tr>
<tr><td><code id="sequence_classification_+3A_empty">empty</code></td>
<td>
<p>optional, data frame non-animal images (empty, human and vehicle) that will be merged back with animal imagages</p>
</td></tr>
<tr><td><code id="sequence_classification_+3A_predictions">predictions</code></td>
<td>
<p>data frame of prediction probabilities from the classifySpecies function</p>
</td></tr>
<tr><td><code id="sequence_classification_+3A_classes">classes</code></td>
<td>
<p>a vector or species corresponding to the columns of 'predictions'</p>
</td></tr>
<tr><td><code id="sequence_classification_+3A_stationcolumn">stationcolumn</code></td>
<td>
<p>a column in the animals and empty data frame that indicates the camera or camera station</p>
</td></tr>
<tr><td><code id="sequence_classification_+3A_emptyclass">emptyclass</code></td>
<td>
<p>a string indicating the class that should be considered 'Empty'</p>
</td></tr>
<tr><td><code id="sequence_classification_+3A_sortcolumns">sortcolumns</code></td>
<td>
<p>optional sort order. The default is 'stationcolumnumn' and DateTime.</p>
</td></tr>
<tr><td><code id="sequence_classification_+3A_recordfield">recordfield</code></td>
<td>
<p>a field indicating a single record. The default is FilePath for single images/videos.</p>
</td></tr>
<tr><td><code id="sequence_classification_+3A_maxdiff">maxdiff</code></td>
<td>
<p>maximum difference between images in seconds to be included in a sequence, defaults to 60</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function retains &quot;Empty&quot; classification even if other images within the
sequence are predicted to contain animals.
Classification confidence is weighted by MD confidence.
</p>


<h3>Value</h3>

<p>data frame with predictions and confidence values for animals and empty images
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
predictions &lt;-classifyCropsSpecies(images,modelfile,resize=456)
animals &lt;- allframes[allframes$max_detection_category==1,]
empty &lt;- setEmpty(allframes)
animals &lt;- sequenceClassification(animals, empty, predictions, classes,
                                  emptyclass = "Empty",
                                  stationcolumnumn="StationID", maxdiff=60)

## End(Not run)
</code></pre>

<hr>
<h2 id='sort_MD'>Create SymLink Directories and Sort Classified Images Based on MD Results</h2><span id='topic+sort_MD'></span>

<h3>Description</h3>

<p>Create SymLink Directories and Sort Classified Images Based on MD Results
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sort_MD(
  manifest,
  link_dir,
  file_col = "FilePath",
  unique_name = "UniqueName",
  copy = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sort_MD_+3A_manifest">manifest</code></td>
<td>
<p>DataFrame of classified images</p>
</td></tr>
<tr><td><code id="sort_MD_+3A_link_dir">link_dir</code></td>
<td>
<p>Destination directory for symlinks</p>
</td></tr>
<tr><td><code id="sort_MD_+3A_file_col">file_col</code></td>
<td>
<p>Colun containing file paths</p>
</td></tr>
<tr><td><code id="sort_MD_+3A_unique_name">unique_name</code></td>
<td>
<p>Unique image name identifier</p>
</td></tr>
<tr><td><code id="sort_MD_+3A_copy">copy</code></td>
<td>
<p>Toggle to determine copy or hard link, defaults to link</p>
</td></tr>
</table>


<h3>Value</h3>

<p>manifest with added link columns
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
sort_MD(manifest, link_dir)

## End(Not run)
</code></pre>

<hr>
<h2 id='sort_species'>Create SymLink Directories and Sort Classified Images</h2><span id='topic+sort_species'></span>

<h3>Description</h3>

<p>Create SymLink Directories and Sort Classified Images
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sort_species(
  manifest,
  link_dir,
  file_col = "FilePath",
  unique_name = "UniqueName",
  copy = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sort_species_+3A_manifest">manifest</code></td>
<td>
<p>DataFrame of classified images</p>
</td></tr>
<tr><td><code id="sort_species_+3A_link_dir">link_dir</code></td>
<td>
<p>Destination directory for symlinks</p>
</td></tr>
<tr><td><code id="sort_species_+3A_file_col">file_col</code></td>
<td>
<p>Colun containing file paths</p>
</td></tr>
<tr><td><code id="sort_species_+3A_unique_name">unique_name</code></td>
<td>
<p>Unique image name identifier</p>
</td></tr>
<tr><td><code id="sort_species_+3A_copy">copy</code></td>
<td>
<p>Toggle to determine copy or hard link, defaults to link</p>
</td></tr>
</table>


<h3>Value</h3>

<p>manifest with added link columns
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
manifest &lt;- sort_species(manifest, link_dir)

## End(Not run)
</code></pre>

<hr>
<h2 id='update_labels'>Udate Results from File Browser</h2><span id='topic+update_labels'></span>

<h3>Description</h3>

<p>Udate Results from File Browser
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_labels(manifest, link_dir, unique_name = "UniqueName")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="update_labels_+3A_manifest">manifest</code></td>
<td>
<p>dataframe containing file data and predictions</p>
</td></tr>
<tr><td><code id="update_labels_+3A_link_dir">link_dir</code></td>
<td>
<p>directory to sort files into</p>
</td></tr>
<tr><td><code id="update_labels_+3A_unique_name">unique_name</code></td>
<td>
<p>column name indicating a unique file name for each row</p>
</td></tr>
</table>


<h3>Value</h3>

<p>dataframe with new &quot;Species&quot; column that contains the verified species
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
results &lt;- updateResults(resultsfile, linkdir)

## End(Not run)
</code></pre>

<hr>
<h2 id='WorkingDirectory'>Set Working Directory and Save File Global Variables</h2><span id='topic+WorkingDirectory'></span>

<h3>Description</h3>

<p>Set Working Directory and Save File Global Variables
</p>


<h3>Usage</h3>

<pre><code class='language-R'>WorkingDirectory(workingdir, pkg.env)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="WorkingDirectory_+3A_workingdir">workingdir</code></td>
<td>
<p>local directory that contains data to process</p>
</td></tr>
<tr><td><code id="WorkingDirectory_+3A_pkg.env">pkg.env</code></td>
<td>
<p>environment to create global variables in</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
WorkingDirectory(/home/kyra/animl/examples)

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
