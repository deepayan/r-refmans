<!DOCTYPE html><html lang="en"><head><title>Help for package FBFsearch</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {FBFsearch}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#dataHuman'><p>Cell signalling pathway data</p></a></li>
<li><a href='#dataPub'><p>Publishing productivity data</p></a></li>
<li><a href='#dataSim100'><p>DAG model with 100 nodes and 100 edges</p></a></li>
<li><a href='#dataSim200'><p>DAG model with 200 nodes and 100 edges</p></a></li>
<li><a href='#dataSim50'><p>DAG model with 50 nodes and 100 edges</p></a></li>
<li><a href='#dataSim6'><p>DAG model with 6 nodes and 5 edges</p></a></li>
<li><a href='#dataSimHuman'><p>Simulated cell signalling pathway data</p></a></li>
<li><a href='#FBF_GS'><p>Moment Fractional Bayes Factor Stochastic Search with Global Prior for Gaussian DAG Models</p></a></li>
<li><a href='#FBF_LS'><p>Moment Fractional Bayes Factor Stochastic Search with Local Prior for DAG Models</p></a></li>
<li><a href='#FBF_RS'><p>Moment Fractional Bayes Factor Stochastic Search for Regression Models</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Algorithm for Searching the Space of Gaussian Directed Acyclic
Graph Models Through Moment Fractional Bayes Factors</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-08-08</td>
</tr>
<tr>
<td>Author:</td>
<td>Davide Altomare, Guido Consonni and Luca La Rocca</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Davide Altomare &lt;davide.altomare@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>We propose an objective Bayesian algorithm for searching the space of Gaussian directed acyclic graph (DAG) models. The algorithm proposed makes use of moment fractional Bayes factors (MFBF) and thus it is suitable for learning sparse graph. The algorithm is implemented by using Armadillo: an open-source C++ linear algebra library. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 0.12.7)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-08-08 06:51:30 UTC; davide</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-08-08 13:40:37 UTC</td>
</tr>
</table>
<hr>
<h2 id='dataHuman'>Cell signalling pathway data</h2><span id='topic+dataHuman'></span>

<h3>Description</h3>

<p>Data on a set of flow cytometry experiments on signaling networks of human immune system cells. The dataset includes p=11 proteins and n=7466 samples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(HumanPw)</code></pre>


<h3>Format</h3>

<p><code>dataHuman</code> contains the following objects:
</p>

<dl>
<dt><code>Obs</code></dt><dd>
<p>Matrix (7466x11) with the observations.
</p>
</dd>
<dt><code>Perms</code></dt><dd>
<p>List of 5 matrices (1x11) each of which with a permutation of the nodes.
</p>
</dd>
<dt><code>TDag</code></dt><dd>
<p>Matrix (11x11) with the adjacency matrix of the known regulatory network.
</p>
</dd>
</dl>



<h3>Source</h3>

<p> Sachs, K., Perez, O., Pe'er, D., Lauffenburger, D., and Nolan, G. (2003). Casual protein-
signaling networks derived from multiparameter single-cell data. <em>Science</em> 308, 504-6.
</p>


<h3>References</h3>

<p>D. Altomare, G. Consonni and L. La Rocca (2012). Objective Bayesian search of Gaussian directed acyclic graphical models for ordered variables with non-local priors. <em>Article submitted to Biometric Methodology</em>.
</p>
<p>Shojaie, A. and Michailidis, G. (2010). Penalized likelihood methods for estimation of sparse
high-dimensional directed acyclic graphs. <em>Biometrika</em> 97, 519-538.
</p>

<hr>
<h2 id='dataPub'>Publishing productivity data</h2><span id='topic+dataPub'></span>

<h3>Description</h3>

<p>Data on publishing productivity among academics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(PubProd)</code></pre>


<h3>Format</h3>

<p><code>dataPub</code> contains the following objects:
</p>

<dl>
<dt><code>Corr</code></dt><dd>
<p>Matrix (7x7) with the correlation matrix of the variables. 
</p>
</dd>
<dt><code>nobs</code></dt><dd>
<p>Scalar with the number of observations.
</p>
</dd>
</dl>



<h3>Source</h3>

<p>Spirtes, P., Glymour, C., and Scheines, R. (2000). Causation, prediction and search (2nd
edition). <em>Cambridge, MA: The MIT Press</em>. pages 1-16.
</p>


<h3>References</h3>

<p>Drton, M. and Perlman, M. D. (2008). A SINful approach to Gaussian graphical model
selection. <em>J. Statist. Plann. Inference</em> 138, 1179-1200.
</p>
<p>D. Altomare, G. Consonni and L. La Rocca (2012). Objective Bayesian search of Gaussian directed acyclic graphical models for ordered variables with non-local priors. <em>Article submitted to Biometric Methodology</em>.
</p>

<hr>
<h2 id='dataSim100'>DAG model with 100 nodes and 100 edges</h2><span id='topic+dataSim100'></span>

<h3>Description</h3>

<p><code>dataSim100</code> is a <code>list</code> with the adjacency matrix of a randomly generated DAG with 100 nodes and 100 edges, 10 samples generated from the DAG and 5 permutations of the nodes.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(SimDag100)</code></pre>


<h3>Format</h3>

<p><code>dataSim100</code> contains the following objects:
</p>

<dl>
<dt><code>Obs</code></dt><dd>
<p>List of 10 matrices (100x100) each of which with 100 observations generated from the DAG.
</p>
</dd>
<dt><code>Perms</code></dt><dd>
<p>List of 5 matrices (1x100) each of which with a permutation of the nodes.
</p>
</dd>
<dt><code>TDag</code></dt><dd>
<p>Matrix (100x100) with the adjacency matrix of the DAG.
</p>
</dd>
</dl>



<h3>Source</h3>

<p> D. Altomare, G. Consonni and L. La Rocca (2012). Objective Bayesian search of Gaussian directed acyclic graphical models for ordered variables with non-local priors. <em>Article submitted to Biometric Methodology</em>.
</p>


<h3>References</h3>

<p>Shojaie, A. and Michailidis, G. (2010). Penalized likelihood methods for estimation of sparse
high-dimensional directed acyclic graphs. <em>Biometrika</em> 97, 519-538.
</p>

<hr>
<h2 id='dataSim200'>DAG model with 200 nodes and 100 edges</h2><span id='topic+dataSim200'></span>

<h3>Description</h3>

<p><code>dataSim200</code> is a <code>list</code> with the adjacency matrix of a randomly generated DAG with 200 nodes and 100 edges, 10 samples generated from the DAG and 5 permutations of the nodes.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(SimDag200)
</code></pre>


<h3>Format</h3>

<p><code>dataSim200</code> contains the following objects:
</p>

<dl>
<dt><code>Obs</code></dt><dd>
<p>List of 10 matrices (100x200) each of which with 100 observations simulated from the DAG.
</p>
</dd>
<dt><code>Perms</code></dt><dd>
<p>List of 5 matrices (1x200) each of which with a permutation of the nodes.
</p>
</dd>
<dt><code>TDag</code></dt><dd>
<p>Matrix (200x200) with the adjacency matrix of the DAG.
</p>
</dd>
</dl>



<h3>Source</h3>

<p> D. Altomare, G. Consonni and L. La Rocca (2012). Objective Bayesian search of gaussian directed acyclic graphical models for ordered variables with non-local priors. <em>Article submitted to Biometric Methodology</em>.
</p>


<h3>References</h3>

<p>Shojaie, A. and Michailidis, G. (2010). Penalized likelihood methods for estimation of sparse
high-dimensional directed acyclic graphs. <em>Biometrika</em> 97, 519-538.
</p>

<hr>
<h2 id='dataSim50'>DAG model with 50 nodes and 100 edges</h2><span id='topic+dataSim50'></span>

<h3>Description</h3>

<p><code>dataSim50</code> is a <code>list</code> with the adjacency matrix of a randomly generated DAG with 50 nodes and 100 edges, 10 samples generated from the DAG and 5 permutations of the nodes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(SimDag50)
</code></pre>


<h3>Format</h3>

<p><code>dataSim50</code> contains the following objects:
</p>

<dl>
<dt><code>Obs</code></dt><dd>
<p>List of 10 matrices (100x50) each of which with 100 observations simulated from the DAG.
</p>
</dd>
<dt><code>Perms</code></dt><dd>
<p>List of 5 matrices (1x50) each of which with a permutation of the nodes.
</p>
</dd>
<dt><code>TDag</code></dt><dd>
<p>Matrix (50x50) with the adjacency matrix of the DAG.
</p>
</dd>
</dl>



<h3>Source</h3>

<p> D. Altomare, G. Consonni and L. La Rocca (2012). Objective Bayesian search of Gaussian directed acyclic graphical models for ordered variables with non-local priors. <em>Article submitted to Biometric Methodology</em>.
</p>


<h3>References</h3>

<p>Shojaie, A. and Michailidis, G. (2010). Penalized likelihood methods for estimation of sparse
high-dimensional directed acyclic graphs. <em>Biometrika</em> 97, 519-538.
</p>

<hr>
<h2 id='dataSim6'>DAG model with 6 nodes and 5 edges</h2><span id='topic+dataSim6'></span>

<h3>Description</h3>

<p><code>dataSim6</code> is a <code>list</code> with the adjacency matrix of a randomly generated DAG with 6 nodes and 5 edges and 100 correlation matrices generated from the DAG.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(SimDag6)</code></pre>


<h3>Format</h3>

<p><code>dataSim6</code> contains the following objects:
</p>

<dl>
<dt><code>Corr</code></dt><dd>
<p>List of 100 matrices (6x6) each of which with a correlation matrix generated from the DAG.
</p>
</dd>
<dt><code>TDag</code></dt><dd>
<p>Matrix (6x6) with the adjacency matrix of the DAG.
</p>
</dd>
</dl>



<h3>References</h3>

<p>D. Altomare, G. Consonni and L. La Rocca (2012). Objective Bayesian search of Gaussian directed acyclic graphical models for ordered variables with non-local priors. <em>Article submitted to Biometric Methodology</em>.
</p>

<hr>
<h2 id='dataSimHuman'>Simulated cell signalling pathway data</h2><span id='topic+dataSimHuman'></span>

<h3>Description</h3>

<p>Data generated from the known regulatory network of human cell signalling data. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(SimHumanPw)</code></pre>


<h3>Format</h3>

<p><code>dataSimHuman</code> contains the following objects:
</p>

<dl>
<dt><code>Obs</code></dt><dd>
<p>List of 100 matrices (100x11) each of which with 100 observations simulated from the known regulatory network.
</p>
</dd>
<dt><code>Perms</code></dt><dd>
<p>List of 5 matrices (1x11) each of which with a permutation of the nodes.
</p>
</dd>
<dt><code>TDag</code></dt><dd>
<p>Matrix (11x11) with the adjacency matrix of the known regulatory network.
</p>
</dd>
</dl>



<h3>Source</h3>

 
<p>D. Altomare, G. Consonni and L. La Rocca (2012). Objective Bayesian search of Gaussian directed acyclic graphical models for ordered variables with non-local priors. <em>Article submitted to Biometric Methodology</em>.
</p>


<h3>References</h3>

<p>Sachs, K., Perez, O., Pe'er, D., Lauffenburger, D., and Nolan, G. (2003). Casual protein-
signaling networks derived from multiparameter single-cell data. <em>Science</em> 308, 504-6.
</p>
<p>Shojaie, A. and Michailidis, G. (2010). Penalized likelihood methods for estimation of sparse
high-dimensional directed acyclic graphs. <em>Biometrika</em> 97, 519-538.
</p>

<hr>
<h2 id='FBF_GS'>Moment Fractional Bayes Factor Stochastic Search with Global Prior for Gaussian DAG Models</h2><span id='topic+FBF_GS'></span>

<h3>Description</h3>

<p>Estimate the edge inclusion probabilities for a Gaussian DAG with q nodes from observational data, using the moment fractional Bayes factor approach with global prior.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FBF_GS(Corr, nobs, G_base, h, C, n_tot_mod, n_hpp)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FBF_GS_+3A_corr">Corr</code></td>
<td>
<p>qxq correlation matrix.</p>
</td></tr>
<tr><td><code id="FBF_GS_+3A_nobs">nobs</code></td>
<td>
<p>Number of observations.</p>
</td></tr>
<tr><td><code id="FBF_GS_+3A_g_base">G_base</code></td>
<td>
<p>Base DAG.</p>
</td></tr>
<tr><td><code id="FBF_GS_+3A_h">h</code></td>
<td>
<p>Parameter prior.</p>
</td></tr>
<tr><td><code id="FBF_GS_+3A_c">C</code></td>
<td>
<p>Costant who keeps the probability of all local moves bounded away from 0 and 1.</p>
</td></tr>
<tr><td><code id="FBF_GS_+3A_n_tot_mod">n_tot_mod</code></td>
<td>
<p>Maximum number of different models which will be visited by the algorithm, for each equation.</p>
</td></tr>
<tr><td><code id="FBF_GS_+3A_n_hpp">n_hpp</code></td>
<td>
<p>Number of the highest posterior probability models which will be returned by the procedure.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of <code>class</code> <code>list</code> with:
</p>

<dl>
<dt><code>M_q</code></dt><dd>
<p>Matrix (qxq) with the estimated edge inclusion probabilities.
</p>
</dd>
<dt><code>M_G</code></dt><dd>
<p>Matrix (n*n_hpp)xq with the n_hpp highest posterior probability models returned by the procedure.
</p>
</dd>
<dt><code>M_P</code></dt><dd>
<p>Vector (n_hpp) with the n_hpp posterior probabilities of the models in M_G.
</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Davide Altomare (<a href="mailto:davide.altomare@gmail.com">davide.altomare@gmail.com</a>).
</p>


<h3>References</h3>

<p>D. Altomare, G. Consonni and L. La Rocca (2012). Objective Bayesian search of Gaussian directed acyclic graphical models for ordered variables with non-local priors. <em>Article submitted to Biometric Methodology</em>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(SimDag6) 

Corr=dataSim6$SimCorr[[1]]
nobs=50
q=ncol(Corr)
Gt=dataSim6$TDag

Res_search=FBF_GS(Corr, nobs, matrix(0,q,q), 1, 0.01, 1000, 10)
M_q=Res_search$M_q
M_G=Res_search$M_G
M_P=Res_search$M_P

G_med=M_q
G_med[M_q&gt;=0.5]=1
G_med[M_q&lt;0.5]=0 #median probability DAG

G_high=M_G[1:q,1:q] #Highest Posterior Probability DAG (HPP)
pp_high=M_P[1] #Posterior Probability of the HPP

#Structural Hamming Distance between the true DAG and the median probability DAG
sum(sum(abs(G_med-Gt)))
#Structural Hamming Distance between the true DAG and the highest probability DAG 
sum(sum(abs(G_high-Gt)))


</code></pre>

<hr>
<h2 id='FBF_LS'>Moment Fractional Bayes Factor Stochastic Search with Local Prior for DAG Models</h2><span id='topic+FBF_LS'></span>

<h3>Description</h3>

<p>Estimate the edge inclusion probabilities for a directed acyclic graph (DAG) from observational data, using the moment fractional Bayes factor approach with local prior.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FBF_LS(Corr, nobs, G_base, h, C, n_tot_mod)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FBF_LS_+3A_corr">Corr</code></td>
<td>
<p>qxq correlation matrix.</p>
</td></tr>
<tr><td><code id="FBF_LS_+3A_nobs">nobs</code></td>
<td>
<p>Number of observations.</p>
</td></tr>
<tr><td><code id="FBF_LS_+3A_g_base">G_base</code></td>
<td>
<p>Base DAG.</p>
</td></tr>
<tr><td><code id="FBF_LS_+3A_h">h</code></td>
<td>
<p>Parameter prior.</p>
</td></tr>
<tr><td><code id="FBF_LS_+3A_c">C</code></td>
<td>
<p>Costant who keeps the probability of all local moves bounded away from 0 and 1.</p>
</td></tr>
<tr><td><code id="FBF_LS_+3A_n_tot_mod">n_tot_mod</code></td>
<td>
<p>Maximum number of different models which will be visited by the algorithm, for each equation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of <code>class</code> <code>matrix</code> with the estimated edge inclusion probabilities.</p>


<h3>Author(s)</h3>

<p>Davide Altomare (<a href="mailto:davide.altomare@gmail.com">davide.altomare@gmail.com</a>).
</p>


<h3>References</h3>

<p>D. Altomare, G. Consonni and L. LaRocca (2012).Objective Bayesian search of Gaussian directed acyclic graphical models for ordered variables with non-local priors.<em>Article submitted to Biometric Methodology</em>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(SimDag6) 

Corr=dataSim6$SimCorr[[1]]
nobs=50
q=ncol(Corr)
Gt=dataSim6$TDag

M_q=FBF_LS(Corr, nobs, matrix(0,q,q), 0, 0.01, 1000)

G_med=M_q
G_med[M_q&gt;=0.5]=1
G_med[M_q&lt;0.5]=0 #median probability DAG

#Structural Hamming Distance between the true DAG and the median probability DAG
sum(sum(abs(G_med-Gt))) 


</code></pre>

<hr>
<h2 id='FBF_RS'>Moment Fractional Bayes Factor Stochastic Search for Regression Models</h2><span id='topic+FBF_RS'></span>

<h3>Description</h3>

<p>Estimate the edge inclusion probabilities for a regression model (Y(q) on Y(q-1),...,Y(1)) with q variables from observational data, using the moment fractional Bayes factor approach.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FBF_RS(Corr, nobs, G_base, h, C, n_tot_mod, n_hpp)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FBF_RS_+3A_corr">Corr</code></td>
<td>
<p>qxq correlation matrix.</p>
</td></tr>
<tr><td><code id="FBF_RS_+3A_nobs">nobs</code></td>
<td>
<p>Number of observations.</p>
</td></tr>
<tr><td><code id="FBF_RS_+3A_g_base">G_base</code></td>
<td>
<p>Base model.</p>
</td></tr>
<tr><td><code id="FBF_RS_+3A_h">h</code></td>
<td>
<p>Parameter prior.</p>
</td></tr>
<tr><td><code id="FBF_RS_+3A_c">C</code></td>
<td>
<p>Costant who keeps the probability of all local moves bounded away from 0 and 1.</p>
</td></tr>
<tr><td><code id="FBF_RS_+3A_n_tot_mod">n_tot_mod</code></td>
<td>
<p>Maximum number of different models which will be visited by the algorithm, for each equation.</p>
</td></tr>
<tr><td><code id="FBF_RS_+3A_n_hpp">n_hpp</code></td>
<td>
<p>Number of the highest posterior probability models which will be returned by the procedure.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of <code>class</code> <code>list</code> with:
</p>

<dl>
<dt><code>M_q</code></dt><dd>
<p>Matrix (qxq) with the estimated edge inclusion probabilities.
</p>
</dd>
<dt><code>M_G</code></dt><dd>
<p>Matrix (n*n_hpp)xq with the n_hpp highest posterior probability models returned by the procedure.
</p>
</dd>
<dt><code>M_P</code></dt><dd>
<p>Vector (n_hpp) with the n_hpp posterior probabilities of the models in M_G.
</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Davide Altomare (<a href="mailto:davide.altomare@gmail.com">davide.altomare@gmail.com</a>).
</p>


<h3>References</h3>

<p>D. Altomare, G. Consonni and L. LaRocca (2012). Objective Bayesian search of Gaussian directed acyclic graphical models for ordered variables with non-local priors. <em>Article submitted to Biometric Methodology</em>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(SimDag6) 

Corr=dataSim6$SimCorr[[1]]
nobs=50
q=ncol(Corr)
Gt=dataSim6$TDag

Res_search=FBF_RS(Corr, nobs, matrix(0,1,(q-1)), 1, 0.01, 1000, 10)
M_q=Res_search$M_q
M_G=Res_search$M_G
M_P=Res_search$M_P


Mt=rev(matrix(Gt[1:(q-1),q],1,(q-1))) #True Model

M_med=M_q
M_med[M_q&gt;=0.5]=1
M_med[M_q&lt;0.5]=0 #median probability model

#Structural Hamming Distance between the true DAG and the median probability DAG
sum(sum(abs(M_med-Mt))) 

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
