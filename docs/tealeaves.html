<!DOCTYPE html><html><head><title>Help for package tealeaves</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {tealeaves}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#.get_dwv'><p>d_wv: water vapour gradient (mol / m ^ 3)</p></a></li>
<li><a href='#.get_Dx'><p>D_x: Calculate diffusion coefficient for a given temperature and pressure</p></a></li>
<li><a href='#.get_gbw'><p>g_bw: Boundary layer conductance to water vapour (m / s)</p></a></li>
<li><a href='#.get_gh'><p>g_h: boundary layer conductance to heat (m / s)</p></a></li>
<li><a href='#.get_gr'><p>Gr: Grashof number</p></a></li>
<li><a href='#.get_gtw'><p>g_tw: total conductance to water vapour (m/s)</p></a></li>
<li><a href='#.get_H'><p>H: sensible heat flux density (W / m^2)</p></a></li>
<li><a href='#.get_hvap'><p>h_vap: heat of vaporization (J / mol)</p></a></li>
<li><a href='#.get_L'><p>L: Latent heat flux density (W / m^2)</p></a></li>
<li><a href='#.get_nu'><p>Nu: Nusselt number</p></a></li>
<li><a href='#.get_Pa'><p>P_a: density of dry air (g / m^3)</p></a></li>
<li><a href='#.get_ps'><p>Saturation water vapour pressure (kPa)</p></a></li>
<li><a href='#.get_Rabs'><p>R_abs: total absorbed radiation (W / m^2)</p></a></li>
<li><a href='#.get_re'><p>Re: Reynolds number</p></a></li>
<li><a href='#.get_sh'><p>Sh: Sherwood number</p></a></li>
<li><a href='#.get_Sr'><p>S_r: longwave re-radiation (W / m^2)</p></a></li>
<li><a href='#.get_Tv'><p>Calculate virtual temperature</p></a></li>
<li><a href='#Ar'><p>Ar: Archimedes number</p></a></li>
<li><a href='#constants'><p>S3 class constants</p></a></li>
<li><a href='#convert_conductance'><p>Convert conductance units</p></a></li>
<li><a href='#E'><p>Evaporation (mol / (m^2 s))</p></a></li>
<li><a href='#energy_balance'><p>Calculate leaf energy balance</p></a></li>
<li><a href='#enviro_par'><p>S3 class enviro_par</p></a></li>
<li><a href='#leaf_par'><p>S3 class leaf_par</p></a></li>
<li><a href='#make_parameters'><p>Make lists of parameters of leaf, environmental, or constant parameters</p></a></li>
<li><a href='#parameter_names'><p>Get vector of parameter names</p></a></li>
<li><a href='#tealeaves'><p><code>tealeaves</code> package</p></a></li>
<li><a href='#tl_example1'><p>tealeaves example output 1</p></a></li>
<li><a href='#tleaves'><p><code>tleaves</code>: find leaf temperatures for multiple parameter sets</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.0.6</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-07-19</td>
</tr>
<tr>
<td>Title:</td>
<td>Solve for Leaf Temperature Using Energy Balance</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), units (&ge; 0.6.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>checkmate (&ge; 2.0.0), crayon (&ge; 1.3.0), dplyr (&ge; 1.0.0),
furrr (&ge; 0.1.0), future (&ge; 1.10.0), glue (&ge; 1.3.0), magrittr
(&ge; 1.5.0), methods (&ge; 3.5.0), purrr (&ge; 0.3.0), rlang (&ge;
0.4.0), stringr (&ge; 1.4.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>covr, ggplot2, knitr, rmarkdown, testthat, tidyr</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements models of leaf temperature using energy balance. It uses units to ensure that parameters are properly specified and transformed before calculations. It allows separate lower and upper surface conductances to heat and water vapour, so sensible and latent heat loss are calculated for each surface separately  as in Foster and Smith (1986) &lt;<a href="https://doi.org/10.1111%2Fj.1365-3040.1986.tb02108.x">doi:10.1111/j.1365-3040.1986.tb02108.x</a>&gt;. It's straightforward to model leaf temperature over environmental gradients such as light, air temperature, humidity, and wind. It can also model leaf temperature over trait gradients such as leaf size or stomatal conductance. Other references are Monteith and Unsworth (2013, ISBN:9780123869104), Nobel (2009, ISBN:9780123741431), and Okajima et al. (2012) &lt;<a href="https://doi.org/10.1007%2Fs11284-011-0905-5">doi:10.1007/s11284-011-0905-5</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-07-20 02:20:49 UTC; cdmuir</td>
</tr>
<tr>
<td>Author:</td>
<td>Chris Muir <a href="https://orcid.org/0000-0003-2555-3878"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Chris Muir &lt;cdmuir@hawaii.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-07-20 14:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='.get_dwv'>d_wv: water vapour gradient (mol / m ^ 3)</h2><span id='topic+.get_dwv'></span>

<h3>Description</h3>

<p>d_wv: water vapour gradient (mol / m ^ 3)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.get_dwv(T_leaf, pars, unitless)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".get_dwv_+3A_t_leaf">T_leaf</code></td>
<td>
<p>Leaf temperature in Kelvin</p>
</td></tr>
<tr><td><code id=".get_dwv_+3A_pars">pars</code></td>
<td>
<p>Concatenated parameters (<code>leaf_par</code>, <code>enviro_par</code>, and <code>constants</code>)</p>
</td></tr>
<tr><td><code id=".get_dwv_+3A_unitless">unitless</code></td>
<td>
<p>Logical. Should function use parameters with <code>units</code>? The function is faster when FALSE, but input must be in correct units or else results will be incorrect without any warning.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><b>Water vapour gradient:</b> The water vapour pressure differential from inside to outside of the leaf is the saturation water vapor pressure inside the leaf (p_leaf) minus the water vapor pressure of the air (p_air):
</p>
<p style="text-align: center;"><code class="reqn">d_\mathrm{wv} = p_\mathrm{leaf} / (R T_\mathrm{leaf}) - RH p_\mathrm{air} / (R T_\mathrm{air})</code>
</p>

<p>Note that water vapor pressure is converted from kPa to mol / m^3 using ideal gas law. <br />
</p>

<table>
<tr>
 <td style="text-align: left;">
<em>Symbol</em> </td><td style="text-align: left;"> <em>R</em> </td><td style="text-align: left;"> <em>Description</em> </td><td style="text-align: left;"> <em>Units</em> </td><td style="text-align: left;"> <em>Default</em></td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">p_\mathrm{air}</code> </td><td style="text-align: left;"> <code>p_air</code> </td><td style="text-align: left;"> saturation water vapour pressure of air </td><td style="text-align: left;"> kPa </td><td style="text-align: left;"> <a href="#topic+.get_ps">calculated</a></td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">p_\mathrm{leaf}</code> </td><td style="text-align: left;"> <code>p_leaf</code> </td><td style="text-align: left;"> saturation water vapour pressure inside the leaf </td><td style="text-align: left;"> kPa </td><td style="text-align: left;"> <a href="#topic+.get_ps">calculated</a></td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">R</code> </td><td style="text-align: left;"> <code>R</code> </td><td style="text-align: left;"> ideal gas constant </td><td style="text-align: left;"> J / (mol K) </td><td style="text-align: left;"> 8.3144598</td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">\mathrm{RH}</code> </td><td style="text-align: left;"> <code>RH</code> </td><td style="text-align: left;"> relative humidity </td><td style="text-align: left;"> % </td><td style="text-align: left;"> 0.50</td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">T_\mathrm{air}</code> </td><td style="text-align: left;"> <code>T_air</code> </td><td style="text-align: left;"> air temperature </td><td style="text-align: left;"> K </td><td style="text-align: left;"> 298.15</td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">T_\mathrm{leaf}</code> </td><td style="text-align: left;"> <code>T_leaf</code> </td><td style="text-align: left;"> leaf temperature </td><td style="text-align: left;"> K </td><td style="text-align: left;"> input
</td>
</tr>

</table>



<h3>Value</h3>

<p>Value in mol / m^3 of class <code>units</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Water vapour gradient: 

leaf_par &lt;- make_leafpar()
enviro_par &lt;- make_enviropar()
constants &lt;- make_constants()
pars &lt;- c(leaf_par, enviro_par, constants)
T_leaf &lt;- set_units(300, K)
T_air &lt;- set_units(298.15, K)
p_leaf &lt;- set_units(35.31683, kPa)
p_air &lt;- set_units(31.65367, kPa)

d_wv &lt;- p_leaf / (pars$R * T_leaf) - pars$RH * p_air / (pars$R * T_air)

</code></pre>

<hr>
<h2 id='.get_Dx'>D_x: Calculate diffusion coefficient for a given temperature and pressure</h2><span id='topic+.get_Dx'></span>

<h3>Description</h3>

<p>D_x: Calculate diffusion coefficient for a given temperature and pressure
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.get_Dx(D_0, Temp, eT, P, unitless)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".get_Dx_+3A_d_0">D_0</code></td>
<td>
<p>Diffusion coefficient at 273.15 K (0 °C) and 101.3246 kPa</p>
</td></tr>
<tr><td><code id=".get_Dx_+3A_temp">Temp</code></td>
<td>
<p>Temperature in Kelvin</p>
</td></tr>
<tr><td><code id=".get_Dx_+3A_et">eT</code></td>
<td>
<p>Exponent for temperature dependence of diffusion</p>
</td></tr>
<tr><td><code id=".get_Dx_+3A_p">P</code></td>
<td>
<p>Atmospheric pressure in kPa</p>
</td></tr>
<tr><td><code id=".get_Dx_+3A_unitless">unitless</code></td>
<td>
<p>Logical. Should function use parameters with <code>units</code>? The function is faster when FALSE, but input must be in correct units or else results will be incorrect without any warning.</p>
</td></tr>
</table>


<h3>Details</h3>

<p style="text-align: center;"><code class="reqn">D = D_\mathrm{0} (T / 273.15) ^ {eT} (101.3246 / P)</code>
</p>

<p><br />
According to Montieth &amp; Unger (2013), eT is generally between 1.5 and 2. Their data in Appendix 3 indicate <code class="reqn">eT = 1.75</code> is reasonable for environmental physics.
</p>


<h3>Value</h3>

<p>Value in m<code class="reqn">^2</code>/s of class <code>units</code>
</p>


<h3>References</h3>

<p>Monteith JL, Unsworth MH. 2013. Principles of Environmental Physics. 4th edition. Academic Press, London.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
tealeaves:::.get_Dx(
  D_0 = set_units(2.12e-05, m^2/s),
  Temp = set_units(298.15, K),
  eT = set_units(1.75),
  P = set_units(101.3246, kPa),
  unitless = FALSE
)

</code></pre>

<hr>
<h2 id='.get_gbw'>g_bw: Boundary layer conductance to water vapour (m / s)</h2><span id='topic+.get_gbw'></span>

<h3>Description</h3>

<p>g_bw: Boundary layer conductance to water vapour (m / s)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.get_gbw(T_leaf, surface, pars, unitless)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".get_gbw_+3A_t_leaf">T_leaf</code></td>
<td>
<p>Leaf temperature in Kelvin</p>
</td></tr>
<tr><td><code id=".get_gbw_+3A_surface">surface</code></td>
<td>
<p>Leaf surface (lower or upper)</p>
</td></tr>
<tr><td><code id=".get_gbw_+3A_pars">pars</code></td>
<td>
<p>Concatenated parameters (<code>leaf_par</code>, <code>enviro_par</code>, and <code>constants</code>)</p>
</td></tr>
<tr><td><code id=".get_gbw_+3A_unitless">unitless</code></td>
<td>
<p>Logical. Should function use parameters with <code>units</code>? The function is faster when FALSE, but input must be in correct units or else results will be incorrect without any warning.</p>
</td></tr>
</table>


<h3>Details</h3>

<p style="text-align: center;"><code class="reqn">g_\mathrm{bw} = D_\mathrm{w} Sh / d</code>
</p>


<table>
<tr>
 <td style="text-align: left;">
<em>Symbol</em> </td><td style="text-align: left;"> <em>R</em> </td><td style="text-align: left;"> <em>Description</em> </td><td style="text-align: left;"> <em>Units</em> </td><td style="text-align: left;"> <em>Default</em></td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">d</code> </td><td style="text-align: left;"> <code>leafsize</code> </td><td style="text-align: left;"> Leaf characteristic dimension in meters </td><td style="text-align: left;"> m </td><td style="text-align: left;"> 0.1</td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">D_\mathrm{w}</code> </td><td style="text-align: left;"> <code>D_w</code> </td><td style="text-align: left;"> diffusion coefficient for water vapour </td><td style="text-align: left;"> m<code class="reqn">^2</code> / s </td><td style="text-align: left;"> <a href="#topic+.get_Dx">calculated</a></td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">Sh</code> </td><td style="text-align: left;"> <code>Sh</code> </td><td style="text-align: left;"> Sherwood number </td><td style="text-align: left;"> none </td><td style="text-align: left;"> <a href="#topic+.get_sh">calculated</a>
</td>
</tr>

</table>



<h3>Value</h3>

<p>Value in m / s of class <code>units</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(tealeaves)

cs &lt;- make_constants()
ep &lt;- make_enviropar()
lp &lt;- make_leafpar()

T_leaf &lt;- set_units(298.15, K)

tealeaves:::.get_gbw(T_leaf, "lower", c(cs, ep, lp), FALSE)

</code></pre>

<hr>
<h2 id='.get_gh'>g_h: boundary layer conductance to heat (m / s)</h2><span id='topic+.get_gh'></span>

<h3>Description</h3>

<p>g_h: boundary layer conductance to heat (m / s)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.get_gh(T_leaf, surface, pars, unitless)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".get_gh_+3A_t_leaf">T_leaf</code></td>
<td>
<p>Leaf temperature in Kelvin</p>
</td></tr>
<tr><td><code id=".get_gh_+3A_surface">surface</code></td>
<td>
<p>Leaf surface (lower or upper)</p>
</td></tr>
<tr><td><code id=".get_gh_+3A_pars">pars</code></td>
<td>
<p>Concatenated parameters (<code>leaf_par</code>, <code>enviro_par</code>, and <code>constants</code>)</p>
</td></tr>
<tr><td><code id=".get_gh_+3A_unitless">unitless</code></td>
<td>
<p>Logical. Should function use parameters with <code>units</code>? The function is faster when FALSE, but input must be in correct units or else results will be incorrect without any warning.</p>
</td></tr>
</table>


<h3>Details</h3>

<p style="text-align: center;"><code class="reqn">g_\mathrm{h} = D_\mathrm{h} Nu / d</code>
</p>


<table>
<tr>
 <td style="text-align: left;">
<em>Symbol</em> </td><td style="text-align: left;"> <em>R</em> </td><td style="text-align: left;"> <em>Description</em> </td><td style="text-align: left;"> <em>Units</em> </td><td style="text-align: left;"> <em>Default</em></td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">d</code> </td><td style="text-align: left;"> <code>leafsize</code> </td><td style="text-align: left;"> Leaf characteristic dimension in meters </td><td style="text-align: left;"> m </td><td style="text-align: left;"> 0.1</td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">D_\mathrm{h}</code> </td><td style="text-align: left;"> <code>D_h</code> </td><td style="text-align: left;"> diffusion coefficient for heat in air </td><td style="text-align: left;"> m<code class="reqn">^2</code> / s </td><td style="text-align: left;"> <a href="#topic+.get_Dx">calculated</a></td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">Nu</code> </td><td style="text-align: left;"> <code>Nu</code> </td><td style="text-align: left;"> Nusselt number </td><td style="text-align: left;"> none </td><td style="text-align: left;"> <a href="#topic+.get_nu">calculated</a>
</td>
</tr>

</table>



<h3>Value</h3>

<p>Value in m/s of class <code>units</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(tealeaves)

cs &lt;- make_constants()
ep &lt;- make_enviropar()
lp &lt;- make_leafpar()

T_leaf &lt;- set_units(298.15, K)

tealeaves:::.get_gh(T_leaf, "lower", c(cs, ep, lp), FALSE)

</code></pre>

<hr>
<h2 id='.get_gr'>Gr: Grashof number</h2><span id='topic+.get_gr'></span>

<h3>Description</h3>

<p>Gr: Grashof number
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.get_gr(T_leaf, pars, unitless)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".get_gr_+3A_t_leaf">T_leaf</code></td>
<td>
<p>Leaf temperature in Kelvin</p>
</td></tr>
<tr><td><code id=".get_gr_+3A_pars">pars</code></td>
<td>
<p>Concatenated parameters (<code>leaf_par</code>, <code>enviro_par</code>, and <code>constants</code>)</p>
</td></tr>
<tr><td><code id=".get_gr_+3A_unitless">unitless</code></td>
<td>
<p>Logical. Should function use parameters with <code>units</code>? The function is faster when FALSE, but input must be in correct units or else results will be incorrect without any warning.</p>
</td></tr>
</table>


<h3>Details</h3>

<p style="text-align: center;"><code class="reqn">Gr = t_\mathrm{air} G d ^ 3 |T_\mathrm{v,leaf} - T_\mathrm{v,air}| / D_\mathrm{m} ^ 2</code>
</p>


<table>
<tr>
 <td style="text-align: left;">
<em>Symbol</em> </td><td style="text-align: left;"> <em>R</em> </td><td style="text-align: left;"> <em>Description</em> </td><td style="text-align: left;"> <em>Units</em> </td><td style="text-align: left;"> <em>Default</em></td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">d</code> </td><td style="text-align: left;"> <code>leafsize</code> </td><td style="text-align: left;"> Leaf characteristic dimension in meters </td><td style="text-align: left;"> m </td><td style="text-align: left;"> 0.1</td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">D_\mathrm{m}</code> </td><td style="text-align: left;"> <code>D_m</code> </td><td style="text-align: left;"> diffusion coefficient of momentum in air </td><td style="text-align: left;"> m<code class="reqn">^2</code> / s </td><td style="text-align: left;"> <a href="#topic+.get_Dx">calculated</a></td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">G</code> </td><td style="text-align: left;"> <code>G</code> </td><td style="text-align: left;"> gravitational acceleration </td><td style="text-align: left;"> m / s<code class="reqn">^2</code> </td><td style="text-align: left;"> 9.8</td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">t_\mathrm{air}</code> </td><td style="text-align: left;"> <code>t_air</code> </td><td style="text-align: left;"> coefficient of thermal expansion of air </td><td style="text-align: left;"> 1 / K </td><td style="text-align: left;"> 1 / Temp </td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">T_\mathrm{v,air}</code> </td><td style="text-align: left;"> <code>Tv_air</code> </td><td style="text-align: left;"> virtual air temperature </td><td style="text-align: left;"> K </td><td style="text-align: left;"> <a href="#topic+.get_Tv">calculated</a></td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">T_\mathrm{v,leaf}</code> </td><td style="text-align: left;"> <code>Tv_leaf</code> </td><td style="text-align: left;"> virtual leaf temperature </td><td style="text-align: left;"> K </td><td style="text-align: left;"> <a href="#topic+.get_Tv">calculated</a>
</td>
</tr>

</table>



<h3>Value</h3>

<p>A unitless number of class <code>units</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(tealeaves)

cs &lt;- make_constants()
ep &lt;- make_enviropar()
lp &lt;- make_leafpar()

T_leaf &lt;- set_units(298.15, K)

tealeaves:::.get_gr(T_leaf, c(cs, ep, lp), FALSE)

</code></pre>

<hr>
<h2 id='.get_gtw'>g_tw: total conductance to water vapour (m/s)</h2><span id='topic+.get_gtw'></span>

<h3>Description</h3>

<p>g_tw: total conductance to water vapour (m/s)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.get_gtw(T_leaf, pars, unitless)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".get_gtw_+3A_t_leaf">T_leaf</code></td>
<td>
<p>Leaf temperature in Kelvin</p>
</td></tr>
<tr><td><code id=".get_gtw_+3A_pars">pars</code></td>
<td>
<p>Concatenated parameters (<code>leaf_par</code>, <code>enviro_par</code>, and <code>constants</code>)</p>
</td></tr>
<tr><td><code id=".get_gtw_+3A_unitless">unitless</code></td>
<td>
<p>Logical. Should function use parameters with <code>units</code>? The function is faster when FALSE, but input must be in correct units or else results will be incorrect without any warning.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><b>Total conductance to water vapor:</b> The total conductance to water vapor (<code class="reqn">g_\mathrm{tw}</code>) is the sum of the parallel lower (abaxial) and upper (adaxial) conductances:
</p>
<p style="text-align: center;"><code class="reqn">g_\mathrm{tw} = g_\mathrm{w,lower} + g_\mathrm{w,upper}</code>
</p>

<p>The conductance to water vapor on each surface is a function of parallel stomatal (<code class="reqn">g_\mathrm{sw}</code>) and cuticular (<code class="reqn">g_\mathrm{uw}</code>) conductances in series with the boundary layer conductance (<code class="reqn">g_\mathrm{bw}</code>). The stomatal, cuticular, and boundary layer conductance on the lower surface are:
</p>
<p style="text-align: center;"><code class="reqn">g_\mathrm{sw,lower} = g_\mathrm{sw} (1 - sr) R (T_\mathrm{leaf} + T_\mathrm{air}) / 2</code>
</p>

<p style="text-align: center;"><code class="reqn">g_\mathrm{uw,lower} = g_\mathrm{uw} / 2 R (T_\mathrm{leaf} + T_\mathrm{air}) / 2</code>
</p>

<p><br />
See <code><a href="#topic+.get_gbw">.get_gbw</a></code> for details on calculating boundary layer conductance. The equations for the upper surface are:
</p>
<p style="text-align: center;"><code class="reqn">g_\mathrm{sw,upper} = g_\mathrm{sw} sr R (T_\mathrm{leaf} + T_\mathrm{air}) / 2</code>
</p>

<p style="text-align: center;"><code class="reqn">g_\mathrm{uw,upper} = g_\mathrm{uw} / 2 R (T_\mathrm{leaf} + T_\mathrm{air}) / 2</code>
</p>

<p><br />
Note that the stomatal and cuticular conductances are given in units of (<code class="reqn">\mu</code>mol H2O) / (m<code class="reqn">^2</code> s Pa) (see <code><a href="#topic+make_leafpar">make_leafpar</a></code>) and converted to m/s using the ideal gas law. The total leaf stomatal (<code class="reqn">g_\mathrm{sw}</code>) and cuticular (<code class="reqn">g_\mathrm{uw}</code>) conductances are partitioned across lower and upper surfaces. The stomatal conductance on each surface depends on stomatal ratio (sr); the cuticular conductance is assumed identical on both surfaces. 
</p>

<table>
<tr>
 <td style="text-align: left;">
<em>Symbol</em> </td><td style="text-align: left;"> <em>R</em> </td><td style="text-align: left;"> <em>Description</em> </td><td style="text-align: left;"> <em>Units</em> </td><td style="text-align: left;"> <em>Default</em></td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">g_\mathrm{sw}</code> </td><td style="text-align: left;"> <code>g_sw</code> </td><td style="text-align: left;"> stomatal conductance to H2O </td><td style="text-align: left;"> (<code class="reqn">\mu</code>mol H2O) / (m<code class="reqn">^2</code> s Pa) </td><td style="text-align: left;"> 5</td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">g_\mathrm{uw}</code> </td><td style="text-align: left;"> <code>g_uw</code> </td><td style="text-align: left;"> cuticular conductance to H2O </td><td style="text-align: left;"> (<code class="reqn">\mu</code>mol H2O) / (m<code class="reqn">^2</code> s Pa) </td><td style="text-align: left;"> 0.1</td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">R</code> </td><td style="text-align: left;"> <code>R</code> </td><td style="text-align: left;"> ideal gas constant </td><td style="text-align: left;"> J / (mol K) </td><td style="text-align: left;"> 8.3144598</td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">\mathrm{logit}(sr)</code> </td><td style="text-align: left;"> <code>logit_sr</code> </td><td style="text-align: left;"> stomatal ratio (logit transformed) </td><td style="text-align: left;"> none </td><td style="text-align: left;"> 0 = logit(0.5)</td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">T_\mathrm{air}</code> </td><td style="text-align: left;"> <code>T_air</code> </td><td style="text-align: left;"> air temperature </td><td style="text-align: left;"> K </td><td style="text-align: left;"> 298.15</td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">T_\mathrm{leaf}</code> </td><td style="text-align: left;"> <code>T_leaf</code> </td><td style="text-align: left;"> leaf temperature </td><td style="text-align: left;"> K </td><td style="text-align: left;"> input
</td>
</tr>

</table>



<h3>Value</h3>

<p>Value in m/s of class <code>units</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Total conductance to water vapor

## Hypostomatous leaf; default parameters
leaf_par &lt;- make_leafpar(replace = list(logit_sr = set_units(-Inf)))
enviro_par &lt;- make_enviropar()
constants &lt;- make_constants()
pars &lt;- c(leaf_par, enviro_par, constants)
T_leaf &lt;- set_units(300, K)

## Fixing boundary layer conductance rather than calculating
gbw_lower &lt;- set_units(0.1, m / s)
gbw_upper &lt;- set_units(0.1, m / s)

# Lower surface ----
## Note that pars$logit_sr is logit-transformed! Use stats::plogis() to convert to proportion.
gsw_lower &lt;- set_units(pars$g_sw * (set_units(1) - stats::plogis(pars$logit_sr)) * pars$R * 
                         ((T_leaf + pars$T_air) / 2), "m / s")
guw_lower &lt;- set_units(pars$g_uw * 0.5 * pars$R * ((T_leaf + pars$T_air) / 2), m / s)
gtw_lower &lt;- 1 / (1 / (gsw_lower + guw_lower) + 1 / gbw_lower)

# Upper surface ----
gsw_upper &lt;- set_units(pars$g_sw * stats::plogis(pars$logit_sr) * pars$R * 
                         ((T_leaf + pars$T_air) / 2), m / s)
guw_upper &lt;- set_units(pars$g_uw * 0.5 * pars$R * ((T_leaf + pars$T_air) / 2), m / s)
gtw_upper &lt;- 1 / (1 / (gsw_upper + guw_upper) + 1 / gbw_upper)

## Lower and upper surface are in parallel
g_tw &lt;- gtw_lower + gtw_upper

</code></pre>

<hr>
<h2 id='.get_H'>H: sensible heat flux density (W / m^2)</h2><span id='topic+.get_H'></span>

<h3>Description</h3>

<p>H: sensible heat flux density (W / m^2)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.get_H(T_leaf, pars, unitless)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".get_H_+3A_t_leaf">T_leaf</code></td>
<td>
<p>Leaf temperature in Kelvin</p>
</td></tr>
<tr><td><code id=".get_H_+3A_pars">pars</code></td>
<td>
<p>Concatenated parameters (<code>leaf_par</code>, <code>enviro_par</code>, and <code>constants</code>)</p>
</td></tr>
<tr><td><code id=".get_H_+3A_unitless">unitless</code></td>
<td>
<p>Logical. Should function use parameters with <code>units</code>? The function is faster when FALSE, but input must be in correct units or else results will be incorrect without any warning.</p>
</td></tr>
</table>


<h3>Details</h3>

<p style="text-align: center;"><code class="reqn">H = P_\mathrm{a} c_p g_\mathrm{h} (T_\mathrm{leaf} - T_\mathrm{air})</code>
</p>


<table>
<tr>
 <td style="text-align: left;">
<em>Symbol</em> </td><td style="text-align: left;"> <em>R</em> </td><td style="text-align: left;"> <em>Description</em> </td><td style="text-align: left;"> <em>Units</em> </td><td style="text-align: left;"> <em>Default</em></td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">c_p</code> </td><td style="text-align: left;"> <code>c_p</code> </td><td style="text-align: left;"> heat capacity of air </td><td style="text-align: left;"> J / (g K) </td><td style="text-align: left;"> 1.01</td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">g_\mathrm{h}</code> </td><td style="text-align: left;"> <code>g_h</code> </td><td style="text-align: left;"> boundary layer conductance to heat </td><td style="text-align: left;"> m / s </td><td style="text-align: left;"> <a href="#topic+.get_gh">calculated</a></td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">P_\mathrm{a}</code> </td><td style="text-align: left;"> <code>P_a</code> </td><td style="text-align: left;"> density of dry air </td><td style="text-align: left;"> g / m^3 </td><td style="text-align: left;"> <a href="#topic+.get_Pa">calculated</a></td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">T_\mathrm{air}</code> </td><td style="text-align: left;"> <code>T_air</code> </td><td style="text-align: left;"> air temperature </td><td style="text-align: left;"> K </td><td style="text-align: left;"> 298.15</td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">T_\mathrm{leaf}</code> </td><td style="text-align: left;"> <code>T_leaf</code> </td><td style="text-align: left;"> leaf temperature </td><td style="text-align: left;"> K </td><td style="text-align: left;"> input
</td>
</tr>

</table>



<h3>Value</h3>

<p>Value in W / m<code class="reqn">^2</code> of class <code>units</code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+.get_gh">.get_gh</a></code>, <code><a href="#topic+.get_Pa">.get_Pa</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(tealeaves)

cs &lt;- make_constants()
ep &lt;- make_enviropar()
lp &lt;- make_leafpar()

T_leaf &lt;- set_units(298.15, K)

tealeaves:::.get_H(T_leaf, c(cs, ep, lp), FALSE)

</code></pre>

<hr>
<h2 id='.get_hvap'>h_vap: heat of vaporization (J / mol)</h2><span id='topic+.get_hvap'></span>

<h3>Description</h3>

<p>h_vap: heat of vaporization (J / mol)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.get_hvap(T_leaf, unitless)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".get_hvap_+3A_t_leaf">T_leaf</code></td>
<td>
<p>Leaf temperature in Kelvin</p>
</td></tr>
<tr><td><code id=".get_hvap_+3A_unitless">unitless</code></td>
<td>
<p>Logical. Should function use parameters with <code>units</code>? The function is faster when FALSE, but input must be in correct units or else results will be incorrect without any warning.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><b>Heat of vaporization:</b> The heat of vaporization (<code class="reqn">h_\mathrm{vap}</code>) is a function of temperature. I used data from on temperature and <code class="reqn">h_\mathrm{vap}</code> from Nobel (2009, Appendix 1) to estimate a linear regression. See Examples.
</p>


<h3>Value</h3>

<p>Value in J/mol of class <code>units</code>
</p>


<h3>References</h3>

<p>Nobel PS. 2009. Physicochemical and Environmental Plant Physiology. 4th Edition. Academic Press.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Heat of vaporization and temperature
## data from Nobel (2009)

T_K &lt;- 273.15 + c(0, 10, 20, 25, 30, 40, 50, 60)
h_vap &lt;- 1e3 * c(45.06, 44.63, 44.21, 44.00, 
                 43.78, 43.35, 42.91, 42.47) # (in J / mol)
                 
fit &lt;- lm(h_vap ~ T_K)

## coefficients are 56847.68250 J / mol and 43.12514 J / (mol K)

coef(fit) 

T_leaf &lt;- 298.15
h_vap &lt;- set_units(56847.68250, J / mol) - 
           set_units(43.12514, J / mol / K) * set_units(T_leaf, K)

## h_vap at 298.15 K is 43989.92 [J/mol]

set_units(h_vap, J / mol)

tealeaves:::.get_hvap(set_units(298.15, K), FALSE)

</code></pre>

<hr>
<h2 id='.get_L'>L: Latent heat flux density (W / m^2)</h2><span id='topic+.get_L'></span>

<h3>Description</h3>

<p>L: Latent heat flux density (W / m^2)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.get_L(T_leaf, pars, unitless)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".get_L_+3A_t_leaf">T_leaf</code></td>
<td>
<p>Leaf temperature in Kelvin</p>
</td></tr>
<tr><td><code id=".get_L_+3A_pars">pars</code></td>
<td>
<p>Concatenated parameters (<code>leaf_par</code>, <code>enviro_par</code>, and <code>constants</code>)</p>
</td></tr>
<tr><td><code id=".get_L_+3A_unitless">unitless</code></td>
<td>
<p>Logical. Should function use parameters with <code>units</code>? The function is faster when FALSE, but input must be in correct units or else results will be incorrect without any warning.</p>
</td></tr>
</table>


<h3>Details</h3>

<p style="text-align: center;"><code class="reqn">L = h_\mathrm{vap} g_\mathrm{tw} d_\mathrm{wv}</code>
</p>


<table>
<tr>
 <td style="text-align: left;">
<em>Symbol</em> </td><td style="text-align: left;"> <em>R</em> </td><td style="text-align: left;"> <em>Description</em> </td><td style="text-align: left;"> <em>Units</em> </td><td style="text-align: left;"> <em>Default</em></td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">d_\mathrm{wv}</code> </td><td style="text-align: left;"> <code>d_wv</code> </td><td style="text-align: left;"> water vapour gradient </td><td style="text-align: left;"> mol / m ^ 3 </td><td style="text-align: left;"> <a href="#topic+.get_dwv">calculated</a> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">h_\mathrm{vap}</code> </td><td style="text-align: left;"> <code>h_vap</code> </td><td style="text-align: left;"> latent heat of vaporization </td><td style="text-align: left;"> J / mol </td><td style="text-align: left;"> <a href="#topic+.get_hvap">calculated</a> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">g_\mathrm{tw}</code> </td><td style="text-align: left;"> <code>g_tw</code> </td><td style="text-align: left;"> total conductance to H2O </td><td style="text-align: left;"> (<code class="reqn">\mu</code>mol H2O) / (m<code class="reqn">^2</code> s Pa) </td><td style="text-align: left;"> <a href="#topic+.get_gtw">calculated</a>
</td>
</tr>

</table>



<h3>Value</h3>

<p>Value in W / m^2 of class <code>units</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(tealeaves)

cs &lt;- make_constants()
ep &lt;- make_enviropar()
lp &lt;- make_leafpar()

T_leaf &lt;- set_units(298.15, K)

tealeaves:::.get_L(T_leaf, c(cs, ep, lp), FALSE)

</code></pre>

<hr>
<h2 id='.get_nu'>Nu: Nusselt number</h2><span id='topic+.get_nu'></span>

<h3>Description</h3>

<p>Nu: Nusselt number
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.get_nu(T_leaf, surface, pars, unitless)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".get_nu_+3A_t_leaf">T_leaf</code></td>
<td>
<p>Leaf temperature in Kelvin</p>
</td></tr>
<tr><td><code id=".get_nu_+3A_surface">surface</code></td>
<td>
<p>Leaf surface (lower or upper)</p>
</td></tr>
<tr><td><code id=".get_nu_+3A_pars">pars</code></td>
<td>
<p>Concatenated parameters (<code>leaf_par</code>, <code>enviro_par</code>, and <code>constants</code>)</p>
</td></tr>
<tr><td><code id=".get_nu_+3A_unitless">unitless</code></td>
<td>
<p>Logical. Should function use parameters with <code>units</code>? The function is faster when FALSE, but input must be in correct units or else results will be incorrect without any warning.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Nusselt number depends on a combination how much free or forced convection predominates. For mixed convection: <br /> 
<br />
</p>
<p style="text-align: center;"><code class="reqn">Nu = (a Re ^ b) ^ {3.5} + (c Gr ^ d) ^ {3.5}) ^ {1 / 3.5}</code>
</p>

<p><br />
</p>

<table>
<tr>
 <td style="text-align: left;">
<em>Symbol</em> </td><td style="text-align: left;"> <em>R</em> </td><td style="text-align: left;"> <em>Description</em> </td><td style="text-align: left;"> <em>Units</em> </td><td style="text-align: left;"> <em>Default</em></td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">a, b, c, d</code> </td><td style="text-align: left;"> <code>a, b, c, d</code> </td><td style="text-align: left;"> empirical coefficients </td><td style="text-align: left;"> none </td><td style="text-align: left;"> <a href="#topic+make_constants">calculated</a></td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">Gr</code> </td><td style="text-align: left;"> <code>Gr</code> </td><td style="text-align: left;"> Grashof number </td><td style="text-align: left;"> none </td><td style="text-align: left;"> <a href="#topic+.get_gr">calculated</a></td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">Re</code> </td><td style="text-align: left;"> <code>Re</code> </td><td style="text-align: left;"> Reynolds number </td><td style="text-align: left;"> none </td><td style="text-align: left;"> <a href="#topic+.get_re">calculated</a>
</td>
</tr>

</table>



<h3>Value</h3>

<p>A unitless number of class <code>units</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(tealeaves)

cs &lt;- make_constants()
ep &lt;- make_enviropar()
lp &lt;- make_leafpar()

T_leaf &lt;- set_units(298.15, K)

tealeaves:::.get_nu(T_leaf, "lower", c(cs, ep, lp), FALSE)

</code></pre>

<hr>
<h2 id='.get_Pa'>P_a: density of dry air (g / m^3)</h2><span id='topic+.get_Pa'></span>

<h3>Description</h3>

<p>P_a: density of dry air (g / m^3)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.get_Pa(T_leaf, pars, unitless)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".get_Pa_+3A_t_leaf">T_leaf</code></td>
<td>
<p>Leaf temperature in Kelvin</p>
</td></tr>
<tr><td><code id=".get_Pa_+3A_pars">pars</code></td>
<td>
<p>Concatenated parameters (<code>leaf_par</code>, <code>enviro_par</code>, and <code>constants</code>)</p>
</td></tr>
<tr><td><code id=".get_Pa_+3A_unitless">unitless</code></td>
<td>
<p>Logical. Should function use parameters with <code>units</code>? The function is faster when FALSE, but input must be in correct units or else results will be incorrect without any warning.</p>
</td></tr>
</table>


<h3>Details</h3>

<p style="text-align: center;"><code class="reqn">P_\mathrm{a} = P / (R_\mathrm{air} (T_\mathrm{leaf} - T_\mathrm{air}) / 2)</code>
</p>


<table>
<tr>
 <td style="text-align: left;">
<em>Symbol</em> </td><td style="text-align: left;"> <em>R</em> </td><td style="text-align: left;"> <em>Description</em> </td><td style="text-align: left;"> <em>Units</em> </td><td style="text-align: left;"> <em>Default</em></td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">P</code> </td><td style="text-align: left;"> <code>P</code> </td><td style="text-align: left;"> atmospheric pressure </td><td style="text-align: left;"> kPa </td><td style="text-align: left;"> 101.3246</td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">R_\mathrm{air}</code> </td><td style="text-align: left;"> <code>R_air</code> </td><td style="text-align: left;"> specific gas constant for dry air </td><td style="text-align: left;"> J / (kg K) </td><td style="text-align: left;"> 287.058</td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">T_\mathrm{air}</code> </td><td style="text-align: left;"> <code>T_air</code> </td><td style="text-align: left;"> air temperature </td><td style="text-align: left;"> K </td><td style="text-align: left;"> 298.15</td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">T_\mathrm{leaf}</code> </td><td style="text-align: left;"> <code>T_leaf</code> </td><td style="text-align: left;"> leaf temperature </td><td style="text-align: left;"> K </td><td style="text-align: left;"> input
</td>
</tr>

</table>



<h3>Value</h3>

<p>Value in g / m<code class="reqn">^3</code> of class <code>units</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(tealeaves)

cs &lt;- make_constants()
ep &lt;- make_enviropar()
lp &lt;- make_leafpar()

T_leaf &lt;- set_units(298.15, K)

tealeaves:::.get_Pa(T_leaf, c(cs, ep, lp), FALSE)

</code></pre>

<hr>
<h2 id='.get_ps'>Saturation water vapour pressure (kPa)</h2><span id='topic+.get_ps'></span>

<h3>Description</h3>

<p>Saturation water vapour pressure (kPa)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.get_ps(Temp, P, unitless)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".get_ps_+3A_temp">Temp</code></td>
<td>
<p>Temperature in Kelvin</p>
</td></tr>
<tr><td><code id=".get_ps_+3A_p">P</code></td>
<td>
<p>Atmospheric pressure in kPa</p>
</td></tr>
<tr><td><code id=".get_ps_+3A_unitless">unitless</code></td>
<td>
<p>Logical. Should function use parameters with <code>units</code>? The function is faster when FALSE, but input must be in correct units or else results will be incorrect without any warning.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Goff-Gratch equation (see http://cires1.colorado.edu/~voemel/vp.html) <br />
<br />
This equation assumes P = 1 atm = 101.3246 kPa, otherwise boiling temperature needs to change <br />
</p>


<h3>Value</h3>

<p>Value in kPa of class <code>units</code>
</p>


<h3>References</h3>

<p><a href="http://cires1.colorado.edu/~voemel/vp.html">http://cires1.colorado.edu/~voemel/vp.html</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
T_leaf &lt;- set_units(298.15, K)
P &lt;- set_units(101.3246, kPa)
tealeaves:::.get_ps(T_leaf, P, FALSE)

</code></pre>

<hr>
<h2 id='.get_Rabs'>R_abs: total absorbed radiation (W / m^2)</h2><span id='topic+.get_Rabs'></span>

<h3>Description</h3>

<p>R_abs: total absorbed radiation (W / m^2)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.get_Rabs(pars, unitless)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".get_Rabs_+3A_pars">pars</code></td>
<td>
<p>Concatenated parameters (<code>leaf_par</code>, <code>enviro_par</code>, and <code>constants</code>)</p>
</td></tr>
<tr><td><code id=".get_Rabs_+3A_unitless">unitless</code></td>
<td>
<p>Logical. Should function use parameters with <code>units</code>? The function is faster when FALSE, but input must be in correct units or else results will be incorrect without any warning.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The following treatment follows Okajima et al. (2012):
</p>
<p style="text-align: center;"><code class="reqn">R_\mathrm{abs} = \alpha_\mathrm{s} (1 + r) S_\mathrm{sw} + \alpha_\mathrm{l} \sigma (T_\mathrm{sky} ^ 4 + T_\mathrm{air} ^ 4)</code>
</p>

<p>The incident longwave (aka thermal infrared) radiation is modeled from sky and air temperature <code class="reqn">\sigma (T_\mathrm{sky} ^ 4 + T_\mathrm{air} ^ 4)</code> where <code class="reqn">T_\mathrm{sky}</code> is function of the air temperature and incoming solar shortwave radiation:
</p>
<p style="text-align: center;"><code class="reqn">T_\mathrm{sky} = T_\mathrm{air} - 20 S_\mathrm{sw} / 1000</code>
</p>


<table>
<tr>
 <td style="text-align: left;">
<em>Symbol</em> </td><td style="text-align: left;"> <em>R</em> </td><td style="text-align: left;"> <em>Description</em> </td><td style="text-align: left;"> <em>Units</em> </td><td style="text-align: left;"> <em>Default</em></td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">\alpha_\mathrm{s}</code> </td><td style="text-align: left;"> <code>abs_s</code> </td><td style="text-align: left;"> absorbtivity of shortwave radiation (0.3 - 4 <code class="reqn">\mu</code>m) </td><td style="text-align: left;"> none </td><td style="text-align: left;"> 0.80</td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">\alpha_\mathrm{l}</code> </td><td style="text-align: left;"> <code>abs_l</code> </td><td style="text-align: left;"> absorbtivity of longwave radiation (4 - 80 <code class="reqn">\mu</code>m) </td><td style="text-align: left;"> none </td><td style="text-align: left;"> 0.97</td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">r</code> </td><td style="text-align: left;"> <code>r</code> </td><td style="text-align: left;"> reflectance for shortwave irradiance (albedo) </td><td style="text-align: left;"> none </td><td style="text-align: left;"> 0.2 </td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">\sigma</code> </td><td style="text-align: left;"> <code>s</code> </td><td style="text-align: left;"> Stefan-Boltzmann constant </td><td style="text-align: left;"> W / (m<code class="reqn">^2</code> K<code class="reqn">^4</code>) </td><td style="text-align: left;"> 5.67e-08 </td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">S_\mathrm{sw}</code> </td><td style="text-align: left;"> <code>S_sw</code> </td><td style="text-align: left;"> incident short-wave (solar) radiation flux density </td><td style="text-align: left;"> W / m<code class="reqn">^2</code> </td><td style="text-align: left;"> 1000 </td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">S_\mathrm{lw}</code> </td><td style="text-align: left;"> <code>S_lw</code> </td><td style="text-align: left;"> incident long-wave radiation flux density </td><td style="text-align: left;"> W / m<code class="reqn">^2</code> </td><td style="text-align: left;"> calculated </td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">T_\mathrm{air}</code> </td><td style="text-align: left;"> <code>T_air</code> </td><td style="text-align: left;"> air temperature </td><td style="text-align: left;"> K </td><td style="text-align: left;"> 298.15 </td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">T_\mathrm{sky}</code> </td><td style="text-align: left;"> <code>T_sky</code> </td><td style="text-align: left;"> sky temperature </td><td style="text-align: left;"> K </td><td style="text-align: left;"> calculated
</td>
</tr>

</table>



<h3>Value</h3>

<p>Value in W / m<code class="reqn">^2</code> of class <code>units</code>
</p>


<h3>References</h3>

<p>Okajima Y, H Taneda, K Noguchi, I Terashima. 2012. Optimum leaf size predicted by a novel leaf energy balance model incorporating dependencies of photosynthesis on light and temperature. Ecological Research 27: 333-46.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(tealeaves)

cs &lt;- make_constants()
ep &lt;- make_enviropar()
lp &lt;- make_leafpar()
ep$T_sky &lt;- ep$T_sky(ep)

tealeaves:::.get_Rabs(c(cs, ep, lp), FALSE)

</code></pre>

<hr>
<h2 id='.get_re'>Re: Reynolds number</h2><span id='topic+.get_re'></span>

<h3>Description</h3>

<p>Re: Reynolds number
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.get_re(T_leaf, pars, unitless)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".get_re_+3A_t_leaf">T_leaf</code></td>
<td>
<p>Leaf temperature in Kelvin</p>
</td></tr>
<tr><td><code id=".get_re_+3A_pars">pars</code></td>
<td>
<p>Concatenated parameters (<code>leaf_par</code>, <code>enviro_par</code>, and <code>constants</code>)</p>
</td></tr>
<tr><td><code id=".get_re_+3A_unitless">unitless</code></td>
<td>
<p>Logical. Should function use parameters with <code>units</code>? The function is faster when FALSE, but input must be in correct units or else results will be incorrect without any warning.</p>
</td></tr>
</table>


<h3>Details</h3>

<p style="text-align: center;"><code class="reqn">Re = u d / D_\mathrm{m}</code>
</p>


<table>
<tr>
 <td style="text-align: left;">
<em>Symbol</em> </td><td style="text-align: left;"> <em>R</em> </td><td style="text-align: left;"> <em>Description</em> </td><td style="text-align: left;"> <em>Units</em> </td><td style="text-align: left;"> <em>Default</em></td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">d</code> </td><td style="text-align: left;"> <code>leafsize</code> </td><td style="text-align: left;"> Leaf characteristic dimension in meters </td><td style="text-align: left;"> m </td><td style="text-align: left;"> 0.1</td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">D_\mathrm{m}</code> </td><td style="text-align: left;"> <code>D_m</code> </td><td style="text-align: left;"> diffusion coefficient of momentum in air </td><td style="text-align: left;"> m<code class="reqn">^2</code> / s </td><td style="text-align: left;"> <a href="#topic+.get_Dx">calculated</a></td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">u</code> </td><td style="text-align: left;"> <code>wind</code> </td><td style="text-align: left;"> windspeed </td><td style="text-align: left;"> m / s </td><td style="text-align: left;"> 2
</td>
</tr>

</table>



<h3>Value</h3>

<p>A unitless number of class <code>units</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(tealeaves)

cs &lt;- make_constants()
ep &lt;- make_enviropar()
lp &lt;- make_leafpar()

T_leaf &lt;- set_units(298.15, K)

tealeaves:::.get_re(T_leaf, c(cs, ep, lp), FALSE)

</code></pre>

<hr>
<h2 id='.get_sh'>Sh: Sherwood number</h2><span id='topic+.get_sh'></span>

<h3>Description</h3>

<p>Sh: Sherwood number
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.get_sh(T_leaf, surface, pars, unitless)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".get_sh_+3A_t_leaf">T_leaf</code></td>
<td>
<p>Leaf temperature in Kelvin</p>
</td></tr>
<tr><td><code id=".get_sh_+3A_surface">surface</code></td>
<td>
<p>Leaf surface (lower or upper)</p>
</td></tr>
<tr><td><code id=".get_sh_+3A_pars">pars</code></td>
<td>
<p>Concatenated parameters (<code>leaf_par</code>, <code>enviro_par</code>, and <code>constants</code>)</p>
</td></tr>
<tr><td><code id=".get_sh_+3A_unitless">unitless</code></td>
<td>
<p>Logical. Should function use parameters with <code>units</code>? The function is faster when FALSE, but input must be in correct units or else results will be incorrect without any warning.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Sherwood number depends on a combination how much free or forced convection predominates. For mixed convection: <br /> 
<br />
</p>
<p style="text-align: center;"><code class="reqn">Sh = (a Re ^ b) ^ {3.5} + (c Gr ^ d) ^ {3.5}) ^ {1 / 3.5}</code>
</p>

<p><br />
</p>

<table>
<tr>
 <td style="text-align: left;">
<em>Symbol</em> </td><td style="text-align: left;"> <em>R</em> </td><td style="text-align: left;"> <em>Description</em> </td><td style="text-align: left;"> <em>Units</em> </td><td style="text-align: left;"> <em>Default</em></td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">a, b, c, d</code> </td><td style="text-align: left;"> <code>a, b, c, d</code> </td><td style="text-align: left;"> empirical coefficients </td><td style="text-align: left;"> none </td><td style="text-align: left;"> <a href="#topic+make_constants">calculated</a></td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">Gr</code> </td><td style="text-align: left;"> <code>Gr</code> </td><td style="text-align: left;"> Grashof number </td><td style="text-align: left;"> none </td><td style="text-align: left;"> <a href="#topic+.get_gr">calculated</a></td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">Re</code> </td><td style="text-align: left;"> <code>Re</code> </td><td style="text-align: left;"> Reynolds number </td><td style="text-align: left;"> none </td><td style="text-align: left;"> <a href="#topic+.get_re">calculated</a>
</td>
</tr>

</table>



<h3>Value</h3>

<p>A unitless number of class <code>units</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(tealeaves)

cs &lt;- make_constants()
ep &lt;- make_enviropar()
lp &lt;- make_leafpar()

T_leaf &lt;- set_units(298.15, K)

tealeaves:::.get_sh(T_leaf, "lower", c(cs, ep, lp), FALSE)

</code></pre>

<hr>
<h2 id='.get_Sr'>S_r: longwave re-radiation (W / m^2)</h2><span id='topic+.get_Sr'></span>

<h3>Description</h3>

<p>S_r: longwave re-radiation (W / m^2)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.get_Sr(T_leaf, pars)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".get_Sr_+3A_t_leaf">T_leaf</code></td>
<td>
<p>Leaf temperature in Kelvin</p>
</td></tr>
<tr><td><code id=".get_Sr_+3A_pars">pars</code></td>
<td>
<p>Concatenated parameters (<code>leaf_par</code>, <code>enviro_par</code>, and <code>constants</code>)</p>
</td></tr>
</table>


<h3>Details</h3>

<p style="text-align: center;"><code class="reqn">S_\mathrm{r} = 2 \sigma \alpha_\mathrm{l} T_\mathrm{air} ^ 4</code>
</p>

<p>The factor of 2 accounts for re-radiation from both leaf surfaces (Foster and Smith 1986). <br />
<br />
</p>

<table>
<tr>
 <td style="text-align: left;">
<em>Symbol</em> </td><td style="text-align: left;"> <em>R</em> </td><td style="text-align: left;"> <em>Description</em> </td><td style="text-align: left;"> <em>Units</em> </td><td style="text-align: left;"> <em>Default</em></td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">\alpha_\mathrm{l}</code> </td><td style="text-align: left;"> <code>abs_l</code> </td><td style="text-align: left;"> absorbtivity of longwave radiation (4 - 80 <code class="reqn">\mu</code>m) </td><td style="text-align: left;"> none </td><td style="text-align: left;"> 0.97</td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">T_\mathrm{air}</code> </td><td style="text-align: left;"> <code>T_air</code> </td><td style="text-align: left;"> air temperature </td><td style="text-align: left;"> K </td><td style="text-align: left;"> 298.15</td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">\sigma</code> </td><td style="text-align: left;"> <code>s</code> </td><td style="text-align: left;"> Stefan-Boltzmann constant </td><td style="text-align: left;"> W / (m<code class="reqn">^2</code> K<code class="reqn">^4</code>) </td><td style="text-align: left;"> 5.67e-08
</td>
</tr>

</table>

<p>Note that leaf absorbtivity is the same value as leaf emissivity
</p>


<h3>Value</h3>

<p>Value in W / m<code class="reqn">^2</code> of class <code>units</code>
</p>


<h3>References</h3>

<p>Foster JR, Smith WK. 1986. Influence of stomatal distribution on transpiration in low-wind environments. Plant, Cell &amp; Environment 9: 751-9.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(tealeaves)

cs &lt;- make_constants()
ep &lt;- make_enviropar()
lp &lt;- make_leafpar()

T_leaf &lt;- set_units(298.15, K)

tealeaves:::.get_Sr(T_leaf, c(cs, ep, lp))

</code></pre>

<hr>
<h2 id='.get_Tv'>Calculate virtual temperature</h2><span id='topic+.get_Tv'></span>

<h3>Description</h3>

<p>Calculate virtual temperature
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.get_Tv(Temp, p, P, epsilon, unitless)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".get_Tv_+3A_temp">Temp</code></td>
<td>
<p>Temperature in Kelvin</p>
</td></tr>
<tr><td><code id=".get_Tv_+3A_p">p</code></td>
<td>
<p>water vapour pressure in kPa</p>
</td></tr>
<tr><td><code id=".get_Tv_+3A_p">P</code></td>
<td>
<p>Atmospheric pressure in kPa</p>
</td></tr>
<tr><td><code id=".get_Tv_+3A_epsilon">epsilon</code></td>
<td>
<p>ratio of water to air molar masses (unitless)</p>
</td></tr>
<tr><td><code id=".get_Tv_+3A_unitless">unitless</code></td>
<td>
<p>Logical. Should function use parameters with <code>units</code>? The function is faster when FALSE, but input must be in correct units or else results will be incorrect without any warning.</p>
</td></tr>
</table>


<h3>Details</h3>

<p style="text-align: center;"><code class="reqn">T_\mathrm{v} = T / [1 - (1 - \epsilon) (p / P)]</code>
</p>

<p>Eq. 2.35 in Monteith &amp; Unsworth (2013) <br />
<br />
</p>

<table>
<tr>
 <td style="text-align: left;">
<em>Symbol</em> </td><td style="text-align: left;"> <em>R</em> </td><td style="text-align: left;"> <em>Description</em> </td><td style="text-align: left;"> <em>Units</em> </td><td style="text-align: left;"> <em>Default</em></td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">\epsilon</code> </td><td style="text-align: left;"> <code>epsilon</code> </td><td style="text-align: left;"> ratio of water to air molar masses </td><td style="text-align: left;"> unitless </td><td style="text-align: left;"> 0.622 </td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">p</code> </td><td style="text-align: left;"> <code>p</code> </td><td style="text-align: left;"> water vapour pressure </td><td style="text-align: left;"> kPa </td><td style="text-align: left;"> <a href="#topic+.get_ps">calculated</a></td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">P</code> </td><td style="text-align: left;"> <code>P</code> </td><td style="text-align: left;"> atmospheric pressure </td><td style="text-align: left;"> kPa </td><td style="text-align: left;"> 101.3246
</td>
</tr>

</table>



<h3>Value</h3>

<p>Value in K of class <code>units</code>
</p>


<h3>References</h3>

<p>Monteith JL, Unsworth MH. 2013. Principles of Environmental Physics. 4th edition. Academic Press, London.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(tealeaves)

cs &lt;- make_constants()
ep &lt;- make_enviropar()
lp &lt;- make_leafpar()

T_leaf &lt;- set_units(298.15, K)
p &lt;- ep$RH * tealeaves:::.get_ps(T_leaf, ep$P, FALSE)
tealeaves:::.get_Tv(T_leaf, p, ep$P, cs$epsilon, FALSE)

</code></pre>

<hr>
<h2 id='Ar'>Ar: Archimedes number</h2><span id='topic+Ar'></span>

<h3>Description</h3>

<p>Ar: Archimedes number
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Ar(T_leaf, pars, unitless = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Ar_+3A_t_leaf">T_leaf</code></td>
<td>
<p>Leaf temperature in Kelvin</p>
</td></tr>
<tr><td><code id="Ar_+3A_pars">pars</code></td>
<td>
<p>Concatenated parameters (<code>leaf_par</code>, <code>enviro_par</code>, and <code>constants</code>)</p>
</td></tr>
<tr><td><code id="Ar_+3A_unitless">unitless</code></td>
<td>
<p>Logical. Should function use parameters with <code>units</code>? The function is faster when FALSE, but input must be in correct units or else results will be incorrect without any warning.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Archimedes number is a dimensionless number that describes when free or forced convection dominates.
</p>
<p style="text-align: center;"><code class="reqn">Ar = Gr / Re ^ 2</code>
</p>

<p><br />
</p>

<table>
<tr>
 <td style="text-align: left;">
<em>Symbol</em> </td><td style="text-align: left;"> <em>R</em> </td><td style="text-align: left;"> <em>Description</em> </td><td style="text-align: left;"> <em>Units</em> </td><td style="text-align: left;"> <em>Default</em></td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">Gr</code> </td><td style="text-align: left;"> <code>Gr</code> </td><td style="text-align: left;"> Grashof number </td><td style="text-align: left;"> none </td><td style="text-align: left;"> <a href="#topic+.get_gr">calculated</a></td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">Re</code> </td><td style="text-align: left;"> <code>Re</code> </td><td style="text-align: left;"> Reynolds number </td><td style="text-align: left;"> none </td><td style="text-align: left;"> <a href="#topic+.get_re">calculated</a>
</td>
</tr>

</table>



<h3>Value</h3>

<p><code>unitless = TRUE</code>: A unitless number of class <code>numeric</code> 
<code>unitless = FALSE</code>: A unitless number of class <code>units</code> 
Also returns Reynolds and Grashof numbers
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cs &lt;- make_constants()
ep &lt;- make_enviropar()
lp &lt;- make_leafpar()
pars &lt;- c(cs, lp, ep)
T_leaf &lt;- set_units(298.15, "K")

Ar(T_leaf, pars)

</code></pre>

<hr>
<h2 id='constants'>S3 class constants</h2><span id='topic+constants'></span>

<h3>Description</h3>

<p>Constructor function for constants class. This function ensures that physical constant inputs are properly formatted.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>constants(.x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="constants_+3A_.x">.x</code></td>
<td>
<p>A list to be constructed into <strong>constants</strong>. If units are not provided, they will be set without conversion. If units are provided, they will be checked and converted to units that tealeaves uses.</p>
</td></tr>
</table>

<hr>
<h2 id='convert_conductance'>Convert conductance units</h2><span id='topic+convert_conductance'></span>

<h3>Description</h3>

<p>Convert conductance units
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convert_conductance(.g, Temp = NULL, P = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="convert_conductance_+3A_.g">.g</code></td>
<td>
<p>Conductance in class units. Units must convertible to one of &quot;m/s&quot;, &quot;umol/m^2/s/Pa&quot;, or &quot;mol/m^2/s&quot;</p>
</td></tr>
<tr><td><code id="convert_conductance_+3A_temp">Temp</code></td>
<td>
<p>A temperature value of class <code>units</code></p>
</td></tr>
<tr><td><code id="convert_conductance_+3A_p">P</code></td>
<td>
<p>A pressure value of class <code>units</code> that is convertible to kPa</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of three values of clas <code>units</code> with units &quot;m/s&quot;, &quot;umol/m^2/s/Pa&quot;, and &quot;mol/m^2/s&quot;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
g_sw &lt;- set_units(10, "m/s")
convert_conductance(g_sw, 
                    Temp = set_units(298.15, "K"), 
                    P = set_units(101.3246, "kPa"))

g_sw &lt;- set_units(4, "umol/m^2/s/Pa")
convert_conductance(g_sw, 
                    Temp = set_units(298.15, "K"), 
                    P = set_units(101.3246, "kPa"))

g_sw &lt;- set_units(0.4, "mol/m^2/s")
convert_conductance(g_sw, 
                    Temp = set_units(298.15, "K"), 
                    P = set_units(101.3246, "kPa"))

</code></pre>

<hr>
<h2 id='E'>Evaporation (mol / (m^2 s))</h2><span id='topic+E'></span>

<h3>Description</h3>

<p>Evaporation (mol / (m^2 s))
</p>


<h3>Usage</h3>

<pre><code class='language-R'>E(T_leaf, pars, unitless)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="E_+3A_t_leaf">T_leaf</code></td>
<td>
<p>Leaf temperature in Kelvin</p>
</td></tr>
<tr><td><code id="E_+3A_pars">pars</code></td>
<td>
<p>Concatenated parameters (<code>leaf_par</code>, <code>enviro_par</code>, and <code>constants</code>)</p>
</td></tr>
<tr><td><code id="E_+3A_unitless">unitless</code></td>
<td>
<p>Logical. Should function use parameters with <code>units</code>? The function is faster when FALSE, but input must be in correct units or else results will be incorrect without any warning.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The leaf evaporation rate is the product of the total conductance to water vapour (m / s) and the water vapour gradient (mol / m^3):
</p>
<p style="text-align: center;"><code class="reqn">E = g_\mathrm{tw} D_\mathrm{wv}</code>
</p>

<p>If <code>unitless = TRUE</code>, <code>T_leaf</code> is assumed in degrees K without checking.
</p>


<h3>Value</h3>

<p><code>unitless = TRUE</code>: A value in units of mol / (m ^ 2 / s) number of class <code>numeric</code> 
<code>unitless = FALSE</code>: A value in units of mol / (m ^ 2 / s) of class <code>units</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(tealeaves)

cs &lt;- make_constants()
ep &lt;- make_enviropar()
lp &lt;- make_leafpar()

T_leaf &lt;- set_units(298.15, K)

E(T_leaf, c(cs, ep, lp), FALSE)

</code></pre>

<hr>
<h2 id='energy_balance'>Calculate leaf energy balance</h2><span id='topic+energy_balance'></span>

<h3>Description</h3>

<p>Calculate leaf energy balance
</p>


<h3>Usage</h3>

<pre><code class='language-R'>energy_balance(
  tleaf,
  leaf_par,
  enviro_par,
  constants,
  quiet = FALSE,
  components = FALSE,
  set_units = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="energy_balance_+3A_tleaf">tleaf</code></td>
<td>
<p>Leaf temperature in Kelvin. If input is numeric, it will be automatically converted to <code>units</code>.</p>
</td></tr>
<tr><td><code id="energy_balance_+3A_leaf_par">leaf_par</code></td>
<td>
<p>A list of leaf parameters. This can be generated using the <code>make_leafpar</code> function.</p>
</td></tr>
<tr><td><code id="energy_balance_+3A_enviro_par">enviro_par</code></td>
<td>
<p>A list of environmental parameters. This can be generated using the <code>make_enviropar</code> function.</p>
</td></tr>
<tr><td><code id="energy_balance_+3A_constants">constants</code></td>
<td>
<p>A list of physical constants. This can be generated using the <code>make_constants</code> function.</p>
</td></tr>
<tr><td><code id="energy_balance_+3A_quiet">quiet</code></td>
<td>
<p>Logical. Should a message appear about conversion from <code>numeric</code> to <code>units</code>? Useful for finding leaf temperature that balances heat transfer using <code><a href="stats.html#topic+uniroot">uniroot</a></code>.</p>
</td></tr>
<tr><td><code id="energy_balance_+3A_components">components</code></td>
<td>
<p>Logical. Should leaf energy components be returned? Transpiration (in mol / (m^2 s)) also returned.</p>
</td></tr>
<tr><td><code id="energy_balance_+3A_set_units">set_units</code></td>
<td>
<p>Logical. Should <code>units</code> be set? The function is faster when FALSE, but input must be in correct units or else results will be incorrect without any warning.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric value in W / m^2. Optionally, a named list of energy balance components in W / m^2 and transpiration in mol / (m^2 s).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(tealeaves)

cs &lt;- make_constants()
ep &lt;- make_enviropar()
lp &lt;- make_leafpar()
ep$T_sky &lt;- ep$T_sky(ep)

T_leaf &lt;- set_units(298.15, K)

energy_balance(T_leaf, lp, ep, cs, FALSE, TRUE, TRUE)

</code></pre>

<hr>
<h2 id='enviro_par'>S3 class enviro_par</h2><span id='topic+enviro_par'></span>

<h3>Description</h3>

<p>Constructor function for enviro_par class. This function ensures that environmental parameter inputs are properly formatted.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>enviro_par(.x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="enviro_par_+3A_.x">.x</code></td>
<td>
<p>A list to be constructed into <strong>enviro_par</strong>. If units are not provided, they will be set without conversion. If units are provided, they will be checked and converted to units that tealeaves uses.</p>
</td></tr>
</table>

<hr>
<h2 id='leaf_par'>S3 class leaf_par</h2><span id='topic+leaf_par'></span>

<h3>Description</h3>

<p>Constructor function for leaf_par class. This function ensures that leaf parameter inputs are properly formatted.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>leaf_par(.x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="leaf_par_+3A_.x">.x</code></td>
<td>
<p>A list to be constructed into <strong>leaf_par</strong>. If units are not provided, they will be set without conversion. If units are provided, they will be checked and converted to units that tealeaves uses.</p>
</td></tr>
</table>

<hr>
<h2 id='make_parameters'>Make lists of parameters of leaf, environmental, or constant parameters</h2><span id='topic+make_parameters'></span><span id='topic+make_leafpar'></span><span id='topic+make_enviropar'></span><span id='topic+make_constants'></span>

<h3>Description</h3>

<p>Make lists of parameters of leaf, environmental, or constant parameters
</p>
<p>make_leafpar
</p>
<p>make_enviropar
</p>
<p>make_constants
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_leafpar(replace = NULL)

make_enviropar(replace = NULL)

make_constants(replace = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make_parameters_+3A_replace">replace</code></td>
<td>
<p>A named list of parameters to replace defaults. If <code>NULL</code>, defaults will be used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><b>Leaf parameters:</b>
</p>

<table>
<tr>
 <td style="text-align: left;">
<em>Symbol</em> </td><td style="text-align: left;"> <em>R</em> </td><td style="text-align: left;"> <em>Description</em> </td><td style="text-align: left;"> <em>Units</em> </td><td style="text-align: left;"> <em>Default</em></td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">d</code> </td><td style="text-align: left;"> <code>leafsize</code> </td><td style="text-align: left;"> Leaf characteristic dimension </td><td style="text-align: left;"> m </td><td style="text-align: left;"> 0.1 </td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">\alpha_\mathrm{l}</code> </td><td style="text-align: left;"> <code>abs_l</code> </td><td style="text-align: left;"> absorbtivity of longwave radiation (4 - 80 <code class="reqn">\mu</code>m) </td><td style="text-align: left;"> none </td><td style="text-align: left;"> 0.97 </td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">\alpha_\mathrm{s}</code> </td><td style="text-align: left;"> <code>abs_s</code> </td><td style="text-align: left;"> absorbtivity of shortwave radiation (0.3 - 4 <code class="reqn">\mu</code>m) </td><td style="text-align: left;"> none </td><td style="text-align: left;"> 0.50 </td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">g_\mathrm{sw}</code> </td><td style="text-align: left;"> <code>g_sw</code> </td><td style="text-align: left;"> stomatal conductance to H2O </td><td style="text-align: left;"> (<code class="reqn">\mu</code>mol H2O) / (m<code class="reqn">^2</code> s Pa) </td><td style="text-align: left;"> 5 </td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">g_\mathrm{uw}</code> </td><td style="text-align: left;"> <code>g_uw</code> </td><td style="text-align: left;"> cuticular conductance to H2O </td><td style="text-align: left;"> (<code class="reqn">\mu</code>mol H2O) / (m<code class="reqn">^2</code> s Pa) </td><td style="text-align: left;"> 0.1 </td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">\mathrm{logit}(sr)</code> </td><td style="text-align: left;"> <code>logit_sr</code> </td><td style="text-align: left;"> stomatal ratio (logit transformed) </td><td style="text-align: left;"> none </td><td style="text-align: left;"> 0 = logit(0.5)
</td>
</tr>

</table>

<p><b>Environment parameters:</b>
</p>

<table>
<tr>
 <td style="text-align: left;">
<em>Symbol</em> </td><td style="text-align: left;"> <em>R</em> </td><td style="text-align: left;"> <em>Description</em> </td><td style="text-align: left;"> <em>Units</em> </td><td style="text-align: left;"> <em>Default</em></td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">P</code> </td><td style="text-align: left;"> <code>P</code> </td><td style="text-align: left;"> atmospheric pressure </td><td style="text-align: left;"> kPa </td><td style="text-align: left;"> 101.3246 </td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">r</code> </td><td style="text-align: left;"> <code>r</code> </td><td style="text-align: left;"> reflectance for shortwave irradiance (albedo) </td><td style="text-align: left;"> none </td><td style="text-align: left;"> 0.2 </td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">\mathrm{RH}</code> </td><td style="text-align: left;"> <code>RH</code> </td><td style="text-align: left;"> relative humidity </td><td style="text-align: left;"> none </td><td style="text-align: left;"> 0.50 </td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">S_\mathrm{sw}</code> </td><td style="text-align: left;"> <code>S_sw</code> </td><td style="text-align: left;"> incident short-wave (solar) radiation flux density </td><td style="text-align: left;"> W / m<code class="reqn">^2</code> </td><td style="text-align: left;"> 1000 </td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">S_\mathrm{lw}</code> </td><td style="text-align: left;"> <code>S_lw</code> </td><td style="text-align: left;"> incident long-wave radiation flux density </td><td style="text-align: left;"> W / m<code class="reqn">^2</code> </td><td style="text-align: left;"> <a href="#topic+.get_Rabs">calculated</a> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">T_\mathrm{air}</code> </td><td style="text-align: left;"> <code>T_air</code> </td><td style="text-align: left;"> air temperature </td><td style="text-align: left;"> K </td><td style="text-align: left;"> 298.15 </td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">u</code> </td><td style="text-align: left;"> <code>wind</code> </td><td style="text-align: left;"> windspeed </td><td style="text-align: left;"> m / s </td><td style="text-align: left;"> 2
</td>
</tr>

</table>

<p><b>Constants:</b>
</p>

<table>
<tr>
 <td style="text-align: left;">
<em>Symbol</em> </td><td style="text-align: left;"> <em>R</em> </td><td style="text-align: left;"> <em>Description</em> </td><td style="text-align: left;"> <em>Units</em> </td><td style="text-align: left;"> <em>Default</em></td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">c_p</code> </td><td style="text-align: left;"> <code>c_p</code> </td><td style="text-align: left;"> heat capacity of air </td><td style="text-align: left;"> J / (g K) </td><td style="text-align: left;"> 1.01 </td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">D_{h,0}</code> </td><td style="text-align: left;"> <code>D_h0</code> </td><td style="text-align: left;"> diffusion coefficient for heat in air at 0 °C </td><td style="text-align: left;"> m<code class="reqn">^2</code> / s </td><td style="text-align: left;"> 19.0e-06</td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">D_{m,0}</code> </td><td style="text-align: left;"> <code>D_m0</code> </td><td style="text-align: left;"> diffusion coefficient for momentum in air at 0 °C </td><td style="text-align: left;"> m<code class="reqn">^2</code> / s </td><td style="text-align: left;"> 13.3e-06 </td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">D_{w,0}</code> </td><td style="text-align: left;"> <code>D_w0</code> </td><td style="text-align: left;"> diffusion coefficient for water vapour in air at 0 C </td><td style="text-align: left;"> m<code class="reqn">^2</code> / s </td><td style="text-align: left;"> 21.2e-06 </td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">\epsilon</code> </td><td style="text-align: left;"> <code>epsilon</code> </td><td style="text-align: left;"> ratio of water to air molar masses </td><td style="text-align: left;"> none </td><td style="text-align: left;"> 0.622 </td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">eT</code> </td><td style="text-align: left;"> <code>eT</code> </td><td style="text-align: left;"> exponent for temperature dependence of diffusion </td><td style="text-align: left;"> none </td><td style="text-align: left;"> 1.75 </td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">G</code> </td><td style="text-align: left;"> <code>G</code> </td><td style="text-align: left;"> gravitational acceleration </td><td style="text-align: left;"> m / s<code class="reqn">^2</code> </td><td style="text-align: left;"> 9.8 </td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">Nu</code> </td><td style="text-align: left;"> <code>Nu</code> </td><td style="text-align: left;"> Nusselt number </td><td style="text-align: left;"> none </td><td style="text-align: left;"> <a href="#topic+.get_nu">calculated</a> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">R</code> </td><td style="text-align: left;"> <code>R</code> </td><td style="text-align: left;"> ideal gas constant </td><td style="text-align: left;"> J / (mol K) </td><td style="text-align: left;"> 8.3144598 </td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">R_\mathrm{air}</code> </td><td style="text-align: left;"> <code>R_air</code> </td><td style="text-align: left;"> specific gas constant for dry air </td><td style="text-align: left;"> J / (kg K) </td><td style="text-align: left;"> 287.058</td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">\sigma</code> </td><td style="text-align: left;"> <code>s</code> </td><td style="text-align: left;"> Stefan-Boltzmann constant </td><td style="text-align: left;"> W / (m<code class="reqn">^2</code> K<code class="reqn">^4</code>) </td><td style="text-align: left;"> 5.67e-08 </td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">Sh</code> </td><td style="text-align: left;"> <code>Sh</code> </td><td style="text-align: left;"> Sherwood number </td><td style="text-align: left;"> none </td><td style="text-align: left;"> <a href="#topic+.get_sh">calculated</a>
</td>
</tr>

</table>



<h3>Value</h3>

<p><code>make_leafpar</code>: An object inheriting from class <code><a href="#topic+leaf_par">leaf_par</a></code><br />
<code>make_enviropar</code>: An object inheriting from class <code><a href="#topic+enviro_par">enviro_par</a></code><br />
<code>make_constants</code>: An object inheriting from class <code><a href="#topic+constants">constants</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(tealeaves)

# Use defaults
cs &lt;- make_constants()
ep &lt;- make_enviropar()
lp &lt;- make_leafpar()

# Replace defaults

ep &lt;- make_enviropar(
  replace = list(
    T_air = set_units(300, K)
  )
)

lp &lt;- make_leafpar(
  replace = list(
    leafsize = set_units(c(0.1, 0.2), m)
  )
)

</code></pre>

<hr>
<h2 id='parameter_names'>Get vector of parameter names</h2><span id='topic+parameter_names'></span>

<h3>Description</h3>

<p>Get vector of parameter names
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parameter_names(which)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="parameter_names_+3A_which">which</code></td>
<td>
<p>A character string indicating which parameter names to retrieve, &quot;constants&quot;, &quot;enviro&quot;, or &quot;leaf&quot;. Partial matching allowed.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>parameter_names("leaf")

</code></pre>

<hr>
<h2 id='tealeaves'><code>tealeaves</code> package</h2><span id='topic+tealeaves'></span>

<h3>Description</h3>

<p>Solve for Leaf Temperature Using Energy Balance
</p>


<h3>Details</h3>

<p>See the README on
<a href="https://github.com/cdmuir/tealeaves">GitHub</a>
</p>

<hr>
<h2 id='tl_example1'>tealeaves example output 1</h2><span id='topic+tl_example1'></span>

<h3>Description</h3>

<p>An example output from the <code><a href="#topic+tealeaves">tealeaves</a></code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tl_example1
</code></pre>


<h3>Format</h3>

<p>A data frame with 150 rows and 20 variables:
</p>

<hr>
<h2 id='tleaves'><code>tleaves</code>: find leaf temperatures for multiple parameter sets</h2><span id='topic+tleaves'></span><span id='topic+tleaf'></span>

<h3>Description</h3>

<p><code>tleaves</code>: find leaf temperatures for multiple parameter sets
</p>
<p><code>tleaf</code>: find leaf temperatures for a single parameter set
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tleaves(
  leaf_par,
  enviro_par,
  constants,
  progress = TRUE,
  quiet = FALSE,
  set_units = TRUE,
  parallel = FALSE
)

tleaf(leaf_par, enviro_par, constants, quiet = FALSE, set_units = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tleaves_+3A_leaf_par">leaf_par</code></td>
<td>
<p>A list of leaf parameters. This can be generated using the <code>make_leafpar</code> function.</p>
</td></tr>
<tr><td><code id="tleaves_+3A_enviro_par">enviro_par</code></td>
<td>
<p>A list of environmental parameters. This can be generated using the <code>make_enviropar</code> function.</p>
</td></tr>
<tr><td><code id="tleaves_+3A_constants">constants</code></td>
<td>
<p>A list of physical constants. This can be generated using the <code>make_constants</code> function.</p>
</td></tr>
<tr><td><code id="tleaves_+3A_progress">progress</code></td>
<td>
<p>Logical. Should a progress bar be displayed?</p>
</td></tr>
<tr><td><code id="tleaves_+3A_quiet">quiet</code></td>
<td>
<p>Logical. Should messages be displayed?</p>
</td></tr>
<tr><td><code id="tleaves_+3A_set_units">set_units</code></td>
<td>
<p>Logical. Should <code>units</code> be set? The function is faster when FALSE, but input must be in correct units or else results will be incorrect without any warning.</p>
</td></tr>
<tr><td><code id="tleaves_+3A_parallel">parallel</code></td>
<td>
<p>Logical. Should parallel processing be used via <code><a href="furrr.html#topic+future_map">future_map</a></code>?</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>tleaves</code>: <br />
<br />
A tibble with the following <code>units</code> columns <br />
</p>

<table>
<tr>
 <td style="text-align: left;">
<b>Input:</b> </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>abs_l</code> </td><td style="text-align: left;"> Absorbtivity of longwave radiation (unitless) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>abs_s</code> </td><td style="text-align: left;"> Absorbtivity of shortwave radiation (unitless) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>g_sw</code> </td><td style="text-align: left;"> Stomatal conductance to H2O (<code class="reqn">\mu</code>mol H2O / (m^2 s Pa)) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>g_uw</code> </td><td style="text-align: left;"> Cuticular conductance to H2O (<code class="reqn">\mu</code>mol H2O / (m^2 s Pa)) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>leafsize</code> Leaf characteristic dimension </td><td style="text-align: left;"> (m) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>logit_sr</code> </td><td style="text-align: left;"> Stomatal ratio (logit transformed; unitless) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>P</code> </td><td style="text-align: left;"> Atmospheric pressure (kPa) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>RH</code> </td><td style="text-align: left;"> Relative humidity (unitless) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>S_lw</code> </td><td style="text-align: left;"> incident long-wave radiation flux density (W / m^2) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>S_sw</code> </td><td style="text-align: left;"> incident short-wave (solar) radiation flux density (W / m^2) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>T_air</code> </td><td style="text-align: left;"> Air temperature (K) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>wind</code> </td><td style="text-align: left;"> Wind speed (m / s) </td>
</tr>
<tr>
 <td style="text-align: left;">
<b>Output:</b> </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>T_leaf</code> </td><td style="text-align: left;"> Equilibrium leaf tempearture (K) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>value</code> </td><td style="text-align: left;"> Leaf energy balance (W / m^2) at <code>tleaf</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>convergence</code> </td><td style="text-align: left;"> Convergence code (0 = converged) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>R_abs</code> </td><td style="text-align: left;"> Total absorbed radiation (W / m^2; see <code><a href="#topic+.get_Rabs">.get_Rabs</a></code>) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>S_r</code> </td><td style="text-align: left;"> Thermal infrared radiation loss (W / m^2; see <code><a href="#topic+.get_Sr">.get_Sr</a></code>) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>H</code> </td><td style="text-align: left;"> Sensible heat flux density (W / m^2; see <code><a href="#topic+.get_H">.get_H</a></code>) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>L</code> </td><td style="text-align: left;"> Latent heat flux density (W / m^2; see <code><a href="#topic+.get_L">.get_L</a></code>) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>E</code> </td><td style="text-align: left;"> Evapotranspiration (mol H2O/ (m^2 s))
</td>
</tr>

</table>

<p><code>tleaf</code>: <br />
<br />
A data.frame with the following numeric columns: <br />
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>T_leaf</code> </td><td style="text-align: left;"> Equilibrium leaf temperature (K) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>value</code> </td><td style="text-align: left;"> Leaf energy balance (W / m^2) at <code>tleaf</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>convergence</code> </td><td style="text-align: left;"> Convergence code (0 = converged) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>R_abs</code> </td><td style="text-align: left;"> Total absorbed radiation (W / m^2; see <code><a href="#topic+.get_Rabs">.get_Rabs</a></code>) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>S_r</code> </td><td style="text-align: left;"> Longwave re-radiation (W / m^2; see <code><a href="#topic+.get_Sr">.get_Sr</a></code>) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>H</code> </td><td style="text-align: left;"> Sensible heat flux density (W / m^2; see <code><a href="#topic+.get_H">.get_H</a></code>) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>L</code></td><td style="text-align: left;"> Latent heat flux density (W / m^2; see <code><a href="#topic+.get_L">.get_L</a></code>) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>E</code> </td><td style="text-align: left;"> Evapotranspiration (mol H2O/ (m^2 s))
</td>
</tr>

</table>



<h3>Examples</h3>

<pre><code class='language-R'># tleaf for single parameter set:

leaf_par &lt;- make_leafpar()
enviro_par &lt;- make_enviropar()
constants &lt;- make_constants()
tleaf(leaf_par, enviro_par, constants)

# tleaves for multiple parameter set:

enviro_par &lt;- make_enviropar(
  replace = list(
    T_air = set_units(c(293.15, 298.15), K)
  )
)
tleaves(leaf_par, enviro_par, constants)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
