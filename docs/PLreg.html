<!DOCTYPE html><html lang="en"><head><title>Help for package PLreg</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {PLreg}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bodyfat_Aeolus'><p>Body Fat of Little Brown Bat</p></a></li>
<li><a href='#CI.lambda'><p>Confidence Interval for the Skewness Parameter</p></a></li>
<li><a href='#envelope'><p>Normal Probability Plots with Simulated Envelope of Residuals for PLreg Objects</p></a></li>
<li><a href='#extra.parameter'><p>Procedure to Select the Extra Parameter for PLreg Objects</p></a></li>
<li><a href='#Firm'><p>Firm Cost</p></a></li>
<li><a href='#influence'><p>Influence Diagnostics for PLreg Objects</p></a></li>
<li><a href='#methodsPLreg'><p>Methods for PLreg Objects</p></a></li>
<li><a href='#PeruVotes'><p>Peru Blank Votes</p></a></li>
<li><a href='#PL'><p>Power Logit Distributions</p></a></li>
<li><a href='#plot.PLreg'><p>Diagnostic Plots for PLreg Objects</p></a></li>
<li><a href='#PLreg'><p>Power Logit Regression Models for Bounded Variables</p></a></li>
<li><a href='#PLregcontrol'><p>Auxiliary for Controlling PL Fitting</p></a></li>
<li><a href='#residuals.PLreg'><p>Residuals Method for PLreg Objects</p></a></li>
<li><a href='#sandwich'><p>Sandwich Variance and Covariance Matrix for PLreg Objects</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Power Logit Regression for Modeling Bounded Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.4.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Power logit regression models for bounded
  continuous data, in which the density generator may be normal, Student-t, 
  power exponential, slash, hyperbolic, sinh-normal, or type II logistic. 
  Diagnostic tools associated with the fitted model, such as the residuals, 
  local influence measures, leverage measures, and goodness-of-fit statistics,
  are implemented. The estimation process follows the maximum likelihood approach
  and, currently, the package supports two types of estimators: the usual maximum 
  likelihood estimator and the penalized maximum likelihood estimator. More details
  about power logit regression models are described in 
  Queiroz and Ferrari (2022) &lt;<a href="https://doi.org/10.48550/arXiv.2202.01697">doi:10.48550/arXiv.2202.01697</a>&gt;.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/ffqueiroz/PLreg">https://github.com/ffqueiroz/PLreg</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>Imports:</td>
<td>BBmisc, EnvStats, Formula, gamlss.dist, GeneralizedHyperbolic,
methods, nleqslv, stats, VGAM, zipfR</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rmarkdown, knitr, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-02-14 17:23:26 UTC; franc</td>
</tr>
<tr>
<td>Author:</td>
<td>Felipe Queiroz [aut, cre],
  Silvia Ferrari [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Felipe Queiroz &lt;ffelipeq@outlook.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-02-16 08:20:07 UTC</td>
</tr>
</table>
<hr>
<h2 id='bodyfat_Aeolus'>Body Fat of Little Brown Bat</h2><span id='topic+bodyfat_Aeolus'></span>

<h3>Description</h3>

<p>A dataset containing the percent body fat of little brown bats sampled in
Aeolus Cave, located in East Dorset, Vermont, in the North Eastern United States.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(bodyfat_Aeolus)
</code></pre>


<h3>Format</h3>

<p>A data frame with 159 rows and 4 variables:
</p>

<dl>
<dt>sex</dt><dd><p>sex of the sampled bat, <code>M</code> for masculine and <code>F</code> for
feminine.</p>
</dd>
<dt>percentfat</dt><dd><p>percent body fat.</p>
</dd>
<dt>year</dt><dd><p>year the bat was sampled.</p>
</dd>
<dt>days</dt><dd><p>hibernation time, defined as days since the fall equinox.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The complete dataset was collected by Cheng et al. (2019) in five
different regions of the United States. <code>bodyfat_Aeolus</code> is the subset
of the data collected in Aeolus Cave, located in East Dorset, Vermont,
in the North Eastern United States.
</p>


<h3>Source</h3>

<p><a href="https://datadryad.org/stash/dataset/doi:10.5061/dryad.sh487nh">https://datadryad.org/stash/dataset/doi:10.5061/dryad.sh487nh</a>
</p>


<h3>References</h3>

<p>Cheng TL, Gerson A, Moore MS, et al. (2019) Higher fat stores
contribute to persistence of little brown bat populations with white-nose
syndrome. <em>J Anim Ecol</em>. 88:591-600.
https://doi.org/10.1111/1365-2656.12954
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("bodyfat_Aeolus")
# Model with zeta = 2
fit &lt;- PLreg(percentfat ~ days + sex + year, data = bodyfat_Aeolus,
             family = "PE", zeta = 2)
summary(fit)
</code></pre>

<hr>
<h2 id='CI.lambda'>Confidence Interval for the Skewness Parameter</h2><span id='topic+CI.lambda'></span>

<h3>Description</h3>

<p>The <code>CI.lambda</code> function provides a plot of the profile (penalized)
likelihood ratio statistics for lambda, useful to obtain confidence
intervals for the skewness parameter (see Queiroz and Ferrari (2022)).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CI.lambda(object, conf.coef = 0.95, lower = NULL, upper = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CI.lambda_+3A_object">object</code></td>
<td>
<p>fitted model object of class &quot;<code>PLreg</code>&quot;.</p>
</td></tr>
<tr><td><code id="CI.lambda_+3A_conf.coef">conf.coef</code></td>
<td>
<p>confidence level of the confidence interval. Default is 0.95.</p>
</td></tr>
<tr><td><code id="CI.lambda_+3A_lower">lower</code></td>
<td>
<p>a numeric value representing the lower limit of the interval for
the skewness parameter. If <code>lower = NULL</code>, the lower limit is selected
by the function.</p>
</td></tr>
<tr><td><code id="CI.lambda_+3A_upper">upper</code></td>
<td>
<p>a numeric value representing the upper limit of the interval for
the skewness parameter. If <code>upper = NULL</code>, the upper limit is selected
by the function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a plot of the profile penalized likelihood ratio
statistics for lambda with a horizontal dashed line, indicating the confidence
interval for lambda. It also shows the confidence interval obtained.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("PeruVotes")

fitPL &lt;- PLreg(votes ~ HDI | HDI, 
  data = PeruVotes, 
  family = "TF", zeta = 5)

CI.lambda(fitPL)
</code></pre>

<hr>
<h2 id='envelope'>Normal Probability Plots with Simulated Envelope of Residuals for PLreg Objects</h2><span id='topic+envelope'></span>

<h3>Description</h3>

<p><code>envelope</code> is used to display normal probability plots with simulated
envelope of residuals for the power logit models. Currently, three types of
residuals are supported: quantile, deviance and standardized residuals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>envelope(
  object,
  type = c("quantile", "deviance", "standardized"),
  rep = 40,
  conf = 0.95,
  xlab,
  ylab,
  main,
  envcol,
  ylim,
  xlim
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="envelope_+3A_object">object</code></td>
<td>
<p>fitted model object of class &quot;<code>PLreg</code>&quot;.</p>
</td></tr>
<tr><td><code id="envelope_+3A_type">type</code></td>
<td>
<p>character specifying the type of residuals to be used,
see <code><a href="#topic+residuals.PLreg">residuals.PLreg</a></code>. Default is <code>type = "standardized"</code>.</p>
</td></tr>
<tr><td><code id="envelope_+3A_rep">rep</code></td>
<td>
<p>a positive integer representing the number of iterations to calculate
the simulated envelopes. Default is <code>rep=40</code>.</p>
</td></tr>
<tr><td><code id="envelope_+3A_conf">conf</code></td>
<td>
<p>a numeric value in the interval (0,1) that represents the confidence
level of the simulated envelopes. Default is <code>conf=0.95</code>.</p>
</td></tr>
<tr><td><code id="envelope_+3A_xlab">xlab</code></td>
<td>
<p>character specifying the label for <code class="reqn">x</code> axis (optional). Default is
&quot;<code>Quantile N(0,1)</code>&quot;.</p>
</td></tr>
<tr><td><code id="envelope_+3A_ylab">ylab</code></td>
<td>
<p>character specifying the label for <code class="reqn">y</code> axis (optional). Default is
the name of the used residual.</p>
</td></tr>
<tr><td><code id="envelope_+3A_main">main</code></td>
<td>
<p>character specifying the overall title for the plot.</p>
</td></tr>
<tr><td><code id="envelope_+3A_envcol">envcol</code></td>
<td>
<p>character specifying the color of the envelope.</p>
</td></tr>
<tr><td><code id="envelope_+3A_ylim">ylim</code>, <code id="envelope_+3A_xlim">xlim</code></td>
<td>
<p>numeric values, specifying the left/lower limit and the right/upper
limit of the scale.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>envelope</code> uses the idea of Atkinson (1985) to create normal
probability plots with simulated envelope. Under the correct model,
approximately 100*<code>conf</code> of the residuals are expected to be inside
the envelope.
</p>


<h3>Value</h3>

<p><code>envelope</code> returns normal probability plot with simulated envelopes
for the residuals.
</p>


<h3>References</h3>

<p>Queiroz, F. F. and Ferrari, S. L. P. (2022). Power logit regression
for modeling bounded data. <em>arXiv</em>:2202.01697. <br /> <br />
Atkinson, A. C. (1985) Plots, transformations and regression: an introduction
to graphical methods of diagnostic regression analysis.
<em>Oxford Science Publications</em>, Oxford.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+PLreg">PLreg</a></code>, <code><a href="#topic+residuals.PLreg">residuals.PLreg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("Firm")

fitPL &lt;- PLreg(firmcost ~ sizelog + indcost | sizelog + indcost, data = Firm,
              family = "SLASH", zeta = 2.13)
summary(fitPL)

envelope(fitPL, type = "standardized")
envelope(fitPL, type = "quantile")
envelope(fitPL, type = "deviance")

</code></pre>

<hr>
<h2 id='extra.parameter'>Procedure to Select the Extra Parameter for PLreg Objects</h2><span id='topic+extra.parameter'></span>

<h3>Description</h3>

<p>The <code>extra.parameter</code> function is used to select the extra parameter
of some power logit models. It provides plots of -2<code>logLik</code> and the
Upsilon measure (see Queiroz and Ferrari (2022)) versus <code class="reqn">\zeta</code>,
the extra parameter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extra.parameter(object, lower, upper, grid = 10, graph = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extra.parameter_+3A_object">object</code></td>
<td>
<p>fitted model object of class &quot;<code>PLreg</code>&quot;.</p>
</td></tr>
<tr><td><code id="extra.parameter_+3A_lower">lower</code></td>
<td>
<p>a numeric value representing the lower limit of the interval for
the extra parameter.</p>
</td></tr>
<tr><td><code id="extra.parameter_+3A_upper">upper</code></td>
<td>
<p>a numeric value representing the upper limit of the interval for
the extra parameter.</p>
</td></tr>
<tr><td><code id="extra.parameter_+3A_grid">grid</code></td>
<td>
<p>a positive integer representing the number of points in the plots.
Default is <code>grid=10</code>. If <code>grid</code> is less than 10, then <code>grid=10</code>.</p>
</td></tr>
<tr><td><code id="extra.parameter_+3A_graph">graph</code></td>
<td>
<p>logical. If <code>graph = TRUE</code> the plots are shown, if
<code>graph = FALSE</code> the plots are not shown. Default is <code>graph = TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>extra.parameter</code> returns a list with five objects:
</p>
<table role = "presentation">
<tr><td><code>zeta.Ups</code></td>
<td>
<p>The selected zeta based on the Upsilon measure.</p>
</td></tr>
<tr><td><code>zeta.loglik</code></td>
<td>
<p>The selected zeta based on -2<code>logLik</code>.</p>
</td></tr>
<tr><td><code>zeta.values</code></td>
<td>
<p>The values of zeta used in the graphs.</p>
</td></tr>
<tr><td><code>Upsilon.values</code></td>
<td>
<p>-2<code>logLik</code> evaluated at each value of zeta.</p>
</td></tr>
<tr><td><code>loglik.values</code></td>
<td>
<p>Upsilon measure evaluated at each value of zeta.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Queiroz, F. F. and Ferrari, S. L. P. (2022). Power logit regression
for modeling bounded data. <em>arXiv</em>:2202.01697.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+PLreg">PLreg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("bodyfat_Aeolus")

#Initial model with zeta = 2
fit1 &lt;- PLreg(percentfat ~ days + sex + year, data = bodyfat_Aeolus,
             family = "PE", zeta = 2)
summary(fit1)
# Choosing the best value for zeta

extra.parameter(fit1, lower = 1, upper = 4, grid = 15)
</code></pre>

<hr>
<h2 id='Firm'>Firm Cost</h2><span id='topic+Firm'></span>

<h3>Description</h3>

<p>A dataset on risk management practices of 73 firms.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Firm)
</code></pre>


<h3>Format</h3>

<p>A data frame with 73 rows and 7 variables:
</p>

<dl>
<dt>firmcost</dt><dd><p>total property and casualty premiums and uninsured losses
as a percentage of total assets.</p>
</dd>
<dt>assume</dt><dd><p>per occurrence retention amount as a percentage of total
assets.</p>
</dd>
<dt>cap</dt><dd><p>indicates that the firm owns a captive insurance company; 1 if
the firm uses a captive, 0 otherwise.</p>
</dd>
<dt>sizelog</dt><dd><p>logarithm of total assets.</p>
</dd>
<dt>indcost</dt><dd><p>a measure of the firm's industry risk.</p>
</dd>
<dt>central</dt><dd><p>a measure of the importance of the local managers in
choosing the amount of risk to be retained.</p>
</dd>
<dt>soph</dt><dd><p>a measure of the degree of importance in using analytical tools.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The dataset was introduced and analyzed by Schmit and Roth (1990) and
is available in the personal web page of Professor E. Frees (Wisconsin School
of Business Research). The response variable is <code>FIRMCOST</code>, smaller
values of firm cost are attributed to firms that have a good risk management
performance.
</p>


<h3>Source</h3>

<p><a href="https://instruction.bus.wisc.edu/jfrees/jfreesbooks/Regression%20Modeling/BookWebDec2010/CSVData/RiskSurvey.csv">https://instruction.bus.wisc.edu/jfrees/jfreesbooks/Regression%20Modeling/BookWebDec2010/CSVData/RiskSurvey.csv</a>
</p>


<h3>References</h3>

<p>Schmit, J.T. and Roth, K. (1990). Cost effectiveness of risk management
practices. <em>Journal of Risk and Insurance</em>. 57:455-470.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("Firm")
fitPL &lt;- PLreg(firmcost ~ sizelog + indcost | sizelog + indcost,
              data = Firm,
              family = "SLASH",
              zeta = 2.13)
summary(fitPL)
plot(fitPL, type = "standardized")
</code></pre>

<hr>
<h2 id='influence'>Influence Diagnostics for PLreg Objects</h2><span id='topic+influence'></span>

<h3>Description</h3>

<p>The <code>influence</code> function provides two influence measures and the generalized
leverage for power logit regression models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>influence(model, graph = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="influence_+3A_model">model</code></td>
<td>
<p>fitted model object of class &quot;<code>PLreg</code>&quot;.</p>
</td></tr>
<tr><td><code id="influence_+3A_graph">graph</code></td>
<td>
<p>logical. If <code>graph = TRUE</code> the plots are shown, if
<code>graph = FALSE</code> the plots are not shown. Default is <code>graph = TRUE</code>.</p>
</td></tr>
<tr><td><code id="influence_+3A_...">...</code></td>
<td>
<p>currently not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>influence</code> returns a list with three objects:
</p>
<table role = "presentation">
<tr><td><code>case.weights</code></td>
<td>
<p>The values of <code class="reqn">h_{max}</code> eigenvector based on case
weights perturbation scheme (see Queiroz and Ferrari (2022)).</p>
</td></tr>
<tr><td><code>totalLI</code></td>
<td>
<p>The total local influence (see Lesaffre and Verbeke (1998))</p>
</td></tr>
<tr><td><code>GL</code></td>
<td>
<p>The diagonal elements of the generalized leverage matrix.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Queiroz, F. F. and Ferrari, S. L. P. (2022). Power logit regression
for modeling bounded data. <em>arXiv</em>:2202.01697.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+PLreg">PLreg</a></code>, <code><a href="#topic+residuals.PLreg">residuals.PLreg</a></code>, <code><a href="#topic+envelope">envelope</a></code>,
<code><a href="#topic+plot.PLreg">plot.PLreg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("Firm")

fitPL &lt;- PLreg(firmcost ~ sizelog + indcost | sizelog + indcost,
              data = Firm, family = "SLASH", zeta = 2.13)

influence_measures = influence(fitPL, graph = FALSE)
plot(influence_measures$case.weights, type = "h", ylim = c(0,1))
plot(influence_measures$totalLI, type = "h", ylim = c(0,6))
plot(Firm$sizelog, influence_measures$GL, pch = "+")

</code></pre>

<hr>
<h2 id='methodsPLreg'>Methods for PLreg Objects</h2><span id='topic+methodsPLreg'></span><span id='topic+summary.PLreg'></span><span id='topic+print.PLreg'></span><span id='topic+print.summary.PLreg'></span><span id='topic+coef.PLreg'></span><span id='topic+vcov.PLreg'></span><span id='topic+logLik.PLreg'></span><span id='topic+model.matrix.PLreg'></span>

<h3>Description</h3>

<p>Some S3 Methods for PLreg regression models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'PLreg'
summary(object, type = "standardized", ...)

## S3 method for class 'PLreg'
print(x, ...)

## S3 method for class 'summary.PLreg'
print(x, ...)

## S3 method for class 'PLreg'
coef(object, ...)

## S3 method for class 'PLreg'
vcov(object, ...)

## S3 method for class 'PLreg'
logLik(object, ...)

## S3 method for class 'PLreg'
model.matrix(object, model = c("median", "dispersion"), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="methodsPLreg_+3A_object">object</code>, <code id="methodsPLreg_+3A_x">x</code></td>
<td>
<p>fitted model object of class &quot;<code>PLreg</code>&quot;.</p>
</td></tr>
<tr><td><code id="methodsPLreg_+3A_type">type</code></td>
<td>
<p>character specifying the type of residuals to be included in the
summary output, see <code><a href="#topic+residuals.PLreg">residuals.PLreg</a></code>.</p>
</td></tr>
<tr><td><code id="methodsPLreg_+3A_...">...</code></td>
<td>
<p>currently not used.</p>
</td></tr>
<tr><td><code id="methodsPLreg_+3A_model">model</code></td>
<td>
<p>character specifying for which component of the model the
coefficients/covariance are extracted.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A set of methods for objects of class &quot;<code>PLreg</code>&quot;, including methods
for the functions <code><a href="base.html#topic+summary">summary</a></code> and <code><a href="stats.html#topic+vcov">vcov</a></code>,
which print the estimated coefficients along with some other information and
presents the covariance matrix, respectively. The <code>summary</code> also presents
the partial Wald tests for the model parameters. Finally, <code>summary</code> returns
an object of class &quot;<code>summary.PLreg</code>&quot; containing information to be printed
using the <code>print</code> method.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+PLreg">PLreg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("bodyfat_Aeolus")

fitPL &lt;- PLreg(percentfat ~ 1, data = bodyfat_Aeolus,
              family = "SN", zeta = 1.6)
fitPL
summary(fitPL)
coef(fitPL, model = "median")
vcov(fitPL)
logLik(fitPL)
AIC(fitPL)
</code></pre>

<hr>
<h2 id='PeruVotes'>Peru Blank Votes</h2><span id='topic+PeruVotes'></span>

<h3>Description</h3>

<p>A dataset on the blank votes in the 2006 Peruvian general election.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(PeruVotes)
</code></pre>


<h3>Format</h3>

<p>A data frame with 194 rows and 2 variables:
</p>

<dl>
<dt>votes</dt><dd><p>proportion of blank votes in the 2006 Peruvian general election.</p>
</dd>
<dt>HDI</dt><dd><p>Human Development Index.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The dataset was collected by Bayes et al. (2012) and the response variable
is <code>votes</code>, proportion of blank votes in the 2006 Peruvian general election.
Bayes et al. (2012) analyzed the influence of the Human Development Index (HDI) on
the proportion of blank votes using a beta rectangular regression model. Lemonte and
Bazan (2015) also analyzed the data using GJS regression models.
</p>


<h3>Source</h3>

<p><a href="https://www.undp.org/es/peru">https://www.undp.org/es/peru</a>
</p>


<h3>References</h3>

<p>Bayes, C., Bazan, J. L. and Garcia, C. (2012). A new robust regression model for proportions.
<em>Bayesian Analysis</em>. 7:771-796 <br /> <br />
Lemonte, A. J. and Bazan, J. L. (2015). New class of Johnson SB distributions
and its associated regression model for rates and proportions. <em>Biometrical Journal</em>. 58:727-746.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("PeruVotes")
fitPL &lt;- PLreg(votes ~ HDI | HDI,
               data = PeruVotes,
               family = "TF",
               zeta = 5,
               control = PLreg.control(lambda = 1))
summary(fitPL)
plot(fitPL, type = "standardized")
</code></pre>

<hr>
<h2 id='PL'>Power Logit Distributions</h2><span id='topic+PL'></span><span id='topic+dPL'></span><span id='topic+pPL'></span><span id='topic+qPL'></span><span id='topic+rPL'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random generation
for power logit distributions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dPL(x, mu, sigma, lambda, zeta = 2, family, log = FALSE)

pPL(q, mu, sigma, lambda, zeta = 2, family, lower.tail = TRUE, log.p = FALSE)

qPL(p, mu, sigma, lambda, zeta = 2, family, lower.tail = TRUE, log.p = FALSE)

rPL(n, mu, sigma, lambda, zeta = 2, family)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PL_+3A_x">x</code>, <code id="PL_+3A_q">q</code></td>
<td>
<p>vector of quantiles.</p>
</td></tr>
<tr><td><code id="PL_+3A_mu">mu</code></td>
<td>
<p>vector of medians.</p>
</td></tr>
<tr><td><code id="PL_+3A_sigma">sigma</code></td>
<td>
<p>vector of dispersion parameters.</p>
</td></tr>
<tr><td><code id="PL_+3A_lambda">lambda</code></td>
<td>
<p>vector of skewness parameters.</p>
</td></tr>
<tr><td><code id="PL_+3A_zeta">zeta</code></td>
<td>
<p>vector of extra parameters.</p>
</td></tr>
<tr><td><code id="PL_+3A_family">family</code></td>
<td>
<p>string that specifies the family used to define the power logit distribution. The family is
<code>NO</code>, <code>TF</code>, <code>LO</code>, <code>PE</code>, <code>SHN</code>, <code>Hyp</code> and <code>SLASH</code> for normal,
Student-t, type II logistic, power exponential, sinh-normal, hyperbolic and slash
distribution, respectively.</p>
</td></tr>
<tr><td><code id="PL_+3A_log">log</code>, <code id="PL_+3A_log.p">log.p</code></td>
<td>
<p>logical; if TRUE, probabilities p are given as log(p). Default is FALSE.</p>
</td></tr>
<tr><td><code id="PL_+3A_lower.tail">lower.tail</code></td>
<td>
<p>logical; if TRUE (default), probabilities are <code class="reqn">P(X \le x)</code> otherwise, <code class="reqn">P(X &gt; x)</code>.</p>
</td></tr>
<tr><td><code id="PL_+3A_p">p</code></td>
<td>
<p>vector of probabilities.</p>
</td></tr>
<tr><td><code id="PL_+3A_n">n</code></td>
<td>
<p>number of observations. If <code>length(n) &gt; 1</code>, the length is taken to be the number required.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>zeta</code> is not specified, it assumes the default value 2. <br />
The power logit distribution has density </p>
<p style="text-align: center;"><code class="reqn">f(y; \mu, \sigma, \lambda) = \lambda r(z^2)/(\sigma y (1-y^\lambda)),</code>
</p>

<p>for <code class="reqn">y \in (0,1)</code>, in which <code class="reqn">z = [logit(y^\lambda) - logit(\mu^\lambda)]/\sigma</code>, <code class="reqn">r(\cdot)</code> is the density generator
and <code class="reqn">\mu \in (0,1)</code>, <code class="reqn">\sigma&gt;0</code> and <code class="reqn">\lambda&gt;0</code> are the median, dispersion and skewness of the distribution. <br />
It is possible to consider <code class="reqn">\lambda=0</code> to obtain the limiting case, the log-log distribution. This distribution has
density </p>
<p style="text-align: center;"><code class="reqn">f(y; \mu, \sigma, \lambda) = r(z^2)/(\sigma y (-log(y))),</code>
</p>
<p> for <code class="reqn">y \in (0,1)</code>,
in which <code class="reqn">z = [-log(-log(y)) - (-log(-log(y)))]/\sigma</code>. <br />
The <code>family</code> argument defines the density generator <code class="reqn">r(\cdot)</code>, which may depend on an extra parameter (<code>zeta</code>).
</p>


<h3>Value</h3>

<p><code>dPL</code> gives the density, <code>pPL</code> gives the distribution function, <code>qPL</code> gives the quantile function,
and <code>rPL</code> generates random variables.
</p>


<h3>References</h3>

<p>Queiroz, F. F. and Ferrari, S. L. P. (2022). Power logit regression
for modeling bounded data. <em>arXiv preprint arXiv</em>:2202.01697.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dPL(0.2, mu = 0.3, sigma = 1, lambda=1, zeta = 2, family = "PE")
mu = 0.3; sigma = 1; lambda = 2
set.seed(1)
PLsample = rPL(1000, mu, sigma, lambda, family = "SN",  zeta = 2.5)
hist(PLsample, prob = TRUE, breaks = 15, main = "", las = 1)
curve(dPL(x, mu, sigma, lambda, family = "SN",  zeta = 2.5),
      from = 0.01, to = 0.8, add = TRUE, col = "red")
rug(PLsample)

x = seq(0.01, 0.9,0.01)
y = dPL(x, mu, sigma, lambda, family = "Hyp",  zeta = 2)
plot(x, y, type = "l", lwd = 2, las = 1)

x1 = seq(0.01, 0.4, 0.01)
y1 = dPL(x1, mu, sigma, lambda, family = "Hyp",  zeta = 2)
polygon(c(x1, 0.4, 0), c(y1, 0, 0), col = "lightblue")
text(mu-0.025, 1, paste("P(Y&lt;0.4) = ",
                        round(pPL(0.4, mu, sigma, lambda,
                        family = "Hyp",
                        zeta = 2),2)),
     font = 1, cex = 0.8)

plot(x, pPL(x, mu, sigma, lambda, family = "PE",  zeta = 1.3),
     type = "l", las = 1, lwd = 2,
     ylab = expression(P(Y&lt;y)),
     xlab = "y")
p = pPL(0.5, mu, sigma, lambda, family = "PE",  zeta = 1.3)
q = qPL(p, mu, sigma, lambda, family = "PE",  zeta = 1.3)
points(q, p, pch = 16, col = 2, cex = 1.5)
text(0.55, 0.83, paste("(", 0.5, ",", round(p, 2), ")"), font = 2,
     cex = 0.8, col = "red")
</code></pre>

<hr>
<h2 id='plot.PLreg'>Diagnostic Plots for PLreg Objects</h2><span id='topic+plot.PLreg'></span>

<h3>Description</h3>

<p>This function provides plots for diagnostic analysis of
power logit regression models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'PLreg'
plot(x, which = 1:4, type = "standardized", pch = "+", las = 1, cex = 0.8, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.PLreg_+3A_x">x</code></td>
<td>
<p>fitted model object of class &quot;<code>PLreg</code>&quot;.</p>
</td></tr>
<tr><td><code id="plot.PLreg_+3A_which">which</code></td>
<td>
<p>numeric specifying a subset of plots (numbers between 1 and 7).
Default is <code>which = 1:4</code>.</p>
</td></tr>
<tr><td><code id="plot.PLreg_+3A_type">type</code></td>
<td>
<p>character specifying the type of residuals,
see <code><a href="#topic+residuals.PLreg">residuals.PLreg</a></code>. Default is <code>type = "standardized"</code>.</p>
</td></tr>
<tr><td><code id="plot.PLreg_+3A_pch">pch</code>, <code id="plot.PLreg_+3A_las">las</code>, <code id="plot.PLreg_+3A_cex">cex</code>, <code id="plot.PLreg_+3A_...">...</code></td>
<td>
<p>graphical parameters (see <code><a href="graphics.html#topic+par">par</a></code>)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>plot</code> method for <code><a href="#topic+PLreg">PLreg</a></code> objects provides 7 types
of diagnostic plots in the following order.
</p>

<dl>
<dt>Residuals vs indexes of obs.</dt><dd><p>An index plot of the residuals
versus indexes of observations.</p>
</dd>
<dt>Case-weight perturbation</dt><dd><p>An index plot of local influence based on the
case-weight perturbation scheme.</p>
</dd>
<dt>Generalized leverage</dt><dd><p>A dispersion diagram of the generalized leverage
versus the predicted values.</p>
</dd>
<dt>Residuals vs linear predictor</dt><dd><p>A dispersion diagram of the residuals versus
the linear predictors.</p>
</dd>
<dt>Normal probability plot</dt><dd><p>A normal probability plot of the residuals.</p>
</dd>
<dt>Predicted vs observed values</dt><dd><p>A dispersion diagram of the predicted values
versus the observed values.</p>
</dd>
<dt>Residuals vs v(z) function</dt><dd><p>A dispersion diagram of the <code class="reqn">v(z)</code> function
versus the residuals. For some power logit models, the <code class="reqn">v(z)</code> function
may be interpreted as weights in the estimation process. If <code>family = "NO"</code>,
the <code class="reqn">v(z)</code> function is constant.</p>
</dd>
</dl>

<p>The <code>which</code> argument can be used to select a subset of the implemented plots.
Default is <code>which = 1:4</code>.
</p>


<h3>Value</h3>

<p><code>plot</code> method for <code><a href="#topic+PLreg">PLreg</a></code> objects returns 7 types
of diagnostic plots.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+PLreg">PLreg</a></code>, <code><a href="#topic+residuals.PLreg">residuals.PLreg</a></code>, <code><a href="#topic+envelope">envelope</a></code>, <code><a href="#topic+influence">influence</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("Firm")

fitPL &lt;- PLreg(firmcost ~ sizelog + indcost | sizelog + indcost, data = Firm,
              family = "SLASH", zeta = 2.13)
par(mfrow = c(3,3))
plot(fitPL, type = "standardized")
par(mfrow = c(1, 1))
</code></pre>

<hr>
<h2 id='PLreg'>Power Logit Regression Models for Bounded Variables</h2><span id='topic+PLreg'></span><span id='topic+PLreg.fit'></span>

<h3>Description</h3>

<p><code>PLreg</code> is used to fit power logit regression model for continuous and bounded variables via maximum likelihood approach.
Both median and dispersion of the response variable are modeled through
parametric functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PLreg(
  formula,
  data,
  subset,
  na.action,
  family = c("NO", "LO", "TF", "PE", "SN", "SLASH", "Hyp"),
  zeta = NULL,
  link = c("logit", "probit", "cloglog", "cauchit", "loglog"),
  link.sigma = NULL,
  type = c("pML", "ML"),
  control = PLreg.control(...),
  model = TRUE,
  y = TRUE,
  x = FALSE,
  ...
)

PLreg.fit(
  X,
  y,
  S = NULL,
  family,
  type = "pML",
  zeta = zeta,
  link = "logit",
  link.sigma = "log",
  control = PLreg.control()
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PLreg_+3A_formula">formula</code></td>
<td>
<p>a symbolic description of the model. See details for further information.</p>
</td></tr>
<tr><td><code id="PLreg_+3A_data">data</code>, <code id="PLreg_+3A_subset">subset</code>, <code id="PLreg_+3A_na.action">na.action</code></td>
<td>
<p>arguments controlling formula processing via <code><a href="stats.html#topic+model.frame">model.frame</a></code>.</p>
</td></tr>
<tr><td><code id="PLreg_+3A_family">family</code></td>
<td>
<p>a description of the symmetric distribution to be used for generating the power logit model.
Supported families include &quot;<code>NO</code>&quot;, &quot;<code>LO</code>&quot;, &quot;<code>TF</code>&quot;, &quot;<code>PE</code>&quot;, &quot;<code>Hyp</code>&quot;, <code>SHN</code>&quot;
and &quot;<code>SLASH</code>&quot;, which correspond to the power logit normal, type II logistic,
Student-t, power exponential, hyperbolic, sinh-normal, and slash distributions, respectively.</p>
</td></tr>
<tr><td><code id="PLreg_+3A_zeta">zeta</code></td>
<td>
<p>a numeric value or numeric vector that represents the extra parameter of the distribution. For the
PL-NO and PL-LO models, no extra parameter is needed.</p>
</td></tr>
<tr><td><code id="PLreg_+3A_link">link</code></td>
<td>
<p>an optional character that specifies the link function of the median submodel (mu).
The &quot;<code>logit</code>&quot;, &quot;<code>probit</code>&quot;, &quot;<code>cloglog</code>&quot;, &quot;<code>cauchit</code>&quot;,
&quot;<code>loglog</code>&quot; functions are supported. The <code>logit</code> function is the default.</p>
</td></tr>
<tr><td><code id="PLreg_+3A_link.sigma">link.sigma</code></td>
<td>
<p>an optional character that specifies the link function of the dispersion submodel (sigma).
The &quot;<code>log</code>&quot;, &quot;<code>sqrt</code>&quot; functions are supported. The default is <code>log</code>.</p>
</td></tr>
<tr><td><code id="PLreg_+3A_type">type</code></td>
<td>
<p>character specifying the type of estimator for the skewness parameter.
Currently, penalized maximum likelihood (&quot;<code>pML</code>&quot;) and maximum likelihood (&quot;<code>ML</code>&quot;) are supported.
If the skewness parameter is fixed, <code>ML</code> type is used.</p>
</td></tr>
<tr><td><code id="PLreg_+3A_control">control</code></td>
<td>
<p>a list of control arguments specified via <code><a href="#topic+PLreg.control">PLreg.control</a></code>.</p>
</td></tr>
<tr><td><code id="PLreg_+3A_model">model</code>, <code id="PLreg_+3A_y">y</code>, <code id="PLreg_+3A_x">x</code></td>
<td>
<p>logicals. If <code>TRUE</code> the corresponding components of the fit
(model frame, response, model matrix) are returned.  For <code><a href="#topic+PLreg.fit">PLreg.fit</a></code>, <code>y</code> must
be the numeric response vector (with values in (0,1)).</p>
</td></tr>
<tr><td><code id="PLreg_+3A_...">...</code></td>
<td>
<p>arguments passed to <code><a href="#topic+PLreg.control">PLreg.control</a></code>.</p>
</td></tr>
<tr><td><code id="PLreg_+3A_x">X</code></td>
<td>
<p>numeric regressor matrix for the median submodel.</p>
</td></tr>
<tr><td><code id="PLreg_+3A_s">S</code></td>
<td>
<p>numeric regressor matrix for the dispersion submodel.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The power logit regression models, proposed by Queiroz and Ferrari (2022), is useful in
situations when the response variable is continuous and bounded on the unit interval (0, 1).
The median and the dispersion parameters are modeled through parametric link
functions. The models depend on a skewness parameter (called <code class="reqn">\lambda</code>). When the skewness parameter is fixed
and equal to 1, the power logit models coincide with the GJS regression models
(Lemonte and Bazan, 2016). Queiroz and Ferrari (2022)  suggest using a penalized maximum
likelihood method to estimate the parameters. This method is implemented in
<code>PLreg</code> by default when <code class="reqn">\lambda</code> is not fixed. If convergence is not reached,
maximum likelihood estimation is performed. The estimation
process uses <code><a href="stats.html#topic+optim">optim</a></code>. If no starting values are specified,
the <code>PLreg</code> function uses those suggested by Queiroz and Ferrari (2022).
This function also fits the log-log regression models by setting <code class="reqn">\lambda</code>
at zero (<code class="reqn">\lambda = 0</code> represents <code class="reqn">\lambda \rightarrow 0^+</code>).<br /> <br />
The formulation of the model has the same structure as in the usual functions
<code><a href="stats.html#topic+lm">lm</a></code> and <code><a href="stats.html#topic+glm">glm</a></code>. The argument
<code>formula</code> could comprise of three parts (separated by the symbols &quot;<code class="reqn">~</code>&quot; and &quot;<code class="reqn">|</code>&quot;),
namely: observed response variable in the unit interval, predictor of the median submodel,
with link function <code>link</code> and predictor of the dispersion submodel, with <code>link.sigma</code>
link function. If the model has constant dispersion, the third part may be omitted and the link function for sigma
is &quot;<code>log</code>&quot; by default. The skewness parameter <code>lambda</code> may be
treated as fixed or not (default). If <code>lambda</code> is fixed, its value
must be specified in the <code>control</code> argument. <br /> <br />
Some methods are available for objects of class &quot;<code>PLreg</code>&quot;,
see <code><a href="#topic+plot.PLreg">plot.PLreg</a></code>, <code><a href="#topic+summary.PLreg">summary.PLreg</a></code>,
<code><a href="#topic+coef.PLreg">coef.PLreg</a></code>, <code><a href="#topic+vcov.PLreg">vcov.PLreg</a></code>, and
<code><a href="#topic+residuals.PLreg">residuals.PLreg</a></code>, for details and other methods.
</p>


<h3>Value</h3>

<p><code>PLreg</code> returns an object of class &quot;<code>PLreg</code>&quot; with the following
components (the <code>PLreg.fit</code> returns elements up to <code>v</code>).
</p>
<table role = "presentation">
<tr><td><code>coefficients</code></td>
<td>
<p>a list with the &quot;<code>median</code>&quot;, &quot;<code>dispersion</code>&quot; and
&quot;<code>skewness</code>&quot; (if <code>lambda = NULL</code>) coefficients.</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>a vector of the raw residuals (the difference between the
observed and the fitted response).</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p>a vector with the fitted values of the median submodel.</p>
</td></tr>
<tr><td><code>optim</code></td>
<td>
<p>a list with the output from <code>optim</code>. When lambda is not fixed,
if <code>type = "pML"</code>, the output refers to the iterative process of
the median and dispersion parameters only and, if <code>type = "ML"</code>,
on the maximization of the likelihood for all the parameters.</p>
</td></tr>
<tr><td><code>family</code></td>
<td>
<p>a character specifying the <code>family</code> used.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>the method argument passed to the optim call.</p>
</td></tr>
<tr><td><code>control</code></td>
<td>
<p>the control arguments passed to the optim call.</p>
</td></tr>
<tr><td><code>start</code></td>
<td>
<p>a vector with the starting values used in the iterative process.</p>
</td></tr>
<tr><td><code>nobs</code></td>
<td>
<p>number of observations.</p>
</td></tr>
<tr><td><code>df.null</code></td>
<td>
<p>residual degrees of freedom in the null model
(constant median and dispersion), i.e., <code class="reqn">n-3</code>.</p>
</td></tr>
<tr><td><code>df.residual</code></td>
<td>
<p>residual degrees of freedom in the fitted model.</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>value of the skewness parameter lambda
(<code>NULL</code> when lambda is not fixed).</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p>log-likelihood of the fitted model.</p>
</td></tr>
<tr><td><code>loglikp</code></td>
<td>
<p>penalized profile log-likelihood for lambda. If lambda is
equal to zero, <code>loglikp</code> returns 1.</p>
</td></tr>
<tr><td><code>vcov</code></td>
<td>
<p>covariance matrix of all the parameters.</p>
</td></tr>
<tr><td><code>pseudo.r.squared</code></td>
<td>
<p>pseudo R-squared value.</p>
</td></tr>
<tr><td><code>Upsilon.zeta</code></td>
<td>
<p>an overall goodness-of-fit measure.</p>
</td></tr>
<tr><td><code>link</code></td>
<td>
<p>a list with elements &quot;<code>median</code>&quot; and &quot;<code>dispersion</code>&quot; containing the
link objects for the respective models.</p>
</td></tr>
<tr><td><code>converged</code></td>
<td>
<p>logical indicating successful convergence of the
iterative process.</p>
</td></tr>
<tr><td><code>zeta</code></td>
<td>
<p>a numeric specifying the value of zeta used in the estimation
process.</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>a character specifying the estimation method used.</p>
</td></tr>
<tr><td><code>v</code></td>
<td>
<p>a vector with the v(z) values for all the observations (see Queiroz and
Ferrari(2021)).</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the original function call.</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>the formula used.</p>
</td></tr>
<tr><td><code>terms</code></td>
<td>
<p>a list with elements &quot;<code>median</code>&quot;, &quot;<code>dispersion</code>&quot; and &quot;<code>full</code>&quot; containing
the term objects for the respective models.</p>
</td></tr>
<tr><td><code>levels</code></td>
<td>
<p>a list with elements &quot;<code>median</code>&quot;, &quot;<code>dispersion</code>&quot; and &quot;<code>full</code>&quot; containing
the levels of the categorical regressors.</p>
</td></tr>
<tr><td><code>contrasts</code></td>
<td>
<p>a list with elements &quot;<code>median</code>&quot; and &quot;<code>dispersion</code>&quot;
containing the contrasts corresponding to levels from the respective models.</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>the full model frame (if <code>y = TRUE</code>).</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>the response variable (if <code>y = TRUE</code>).</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>a list with elements &quot;<code>median</code>&quot; and &quot;<code>dispersion</code>&quot; with the matrices from
the median and dispersion submodels (if <code>x = TRUE</code>).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francisco Felipe de Queiroz (<a href="mailto:ffelipeq@outlook.com">ffelipeq@outlook.com</a>) and Silvia L. P. Ferrari.
</p>


<h3>References</h3>

<p>Queiroz, F. F. and Ferrari, S. L. P. (2022). Power logit regression
for modeling bounded data. <em>arXiv</em>:2202.01697. <br /> <br />
Lemonte, A. J. and Bazan, J. L. (2015). New class of Johnson SB distributions
and its associated regression model for rates and proportions. <em>Biometrical Journal</em>. 58:727-746.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summary.PLreg">summary.PLreg</a></code>, <code><a href="#topic+PLreg.control">PLreg.control</a></code>, <code><a href="#topic+residuals.PLreg">residuals.PLreg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#### Body fat data
data("bodyfat_Aeolus")

#Initial model with zeta = 2
fit1 &lt;- PLreg(percentfat ~ days + sex + year, data = bodyfat_Aeolus,
             family = "PE", zeta = 2)
summary(fit1)
# Choosing the best value for zeta
# extra.parameter(fit1, lower = 1, upper = 4, grid = 15)

# Using zeta = 1.7
fit2 &lt;- PLreg(percentfat ~ days + sex + year, data = bodyfat_Aeolus,
             family = "PE", zeta = 1.7)
summary(fit2)

# Fixing lambda = 1
fit3 &lt;- PLreg(percentfat ~ days + sex + year, data = bodyfat_Aeolus,
             family = "PE", zeta = 1.7,
             control = PLreg.control(lambda = 1))
summary(fit3)

# Comparing the AIC and Upsilon values between fit2 and fit3
AIC(fit2) &lt; AIC(fit3) # TRUE
fit2$Upsilon.zeta &lt; fit3$Upsilon.zeta #TRUE

#### Firm cost data
data("Firm")

fitPL &lt;- PLreg(firmcost ~ sizelog + indcost | sizelog + indcost,
              data = Firm,
              family = "SLASH",
              zeta = 2.13)
summary(fitPL)
#extra.parameter(fitPL, lower = 1.2, upper = 4, grid = 10)
#plot(fitPL, type = "standardized")
#envelope(fitPL, type = "standardized")

fitPL_wo72 &lt;- PLreg(firmcost ~ sizelog + indcost | sizelog + indcost,
                   data = Firm[-72,],
                   family = "SLASH",
                   zeta = 2.13)
fitPL_wo15 &lt;- PLreg(firmcost ~ sizelog + indcost | sizelog + indcost,
                   data = Firm[-15,],
                   family = "SLASH",
                   zeta = 2.13)
fitPL_wo16 &lt;- PLreg(firmcost ~ sizelog + indcost | sizelog + indcost,
                   data = Firm[-16,],
                   family = "SLASH",
                   zeta = 2.13)

coef.mu      &lt;- coef(fitPL)[1:3]
coef.mu_wo72 &lt;- coef(fitPL_wo72)[1:3]
coef.mu_wo15 &lt;- coef(fitPL_wo15)[1:3]
coef.mu_wo16 &lt;- coef(fitPL_wo16)[1:3]

plot(Firm$indcost, Firm$firmcost,
    pch = "+",
    xlab = "indcost",
    ylab = "firmcost")
#identify(Firm$indcost, Firm$firmcost)
covariate = matrix(c(rep.int(1, 1000),
                    rep(median(Firm$sizelog), 1000),
                    seq(0, 1.22, length.out = 1000)),
                  ncol = 3)
lines(covariate[,3],
     as.vector(fitPL$link$median$linkinv(covariate%*%coef.mu)),
     type = "l")
lines(covariate[,3],
     as.vector(fitPL$link$median$linkinv(covariate%*%coef.mu_wo72)),
     type = "l", lty = 2, col = "blue")
lines(covariate[,3],
     as.vector(fitPL$link$median$linkinv(covariate%*%coef.mu_wo15)),
     type = "l", lty = 3, col = "red")
lines(covariate[,3],
     as.vector(fitPL$link$median$linkinv(covariate%*%coef.mu_wo16)),
     type = "l", lty = 4, col = "green")
parameters = c("pML",
              "pML w/o 72",
              "pML w/o 15",
              "pML w/o 16")
legend(x = 0.5,
      y = 0.8,
      legend = parameters,
      col = c("black", "blue", "red", "green"),
      lty = c(1, 2, 3, 4),
      cex = 0.6)

</code></pre>

<hr>
<h2 id='PLregcontrol'>Auxiliary for Controlling PL Fitting</h2><span id='topic+PLregcontrol'></span><span id='topic+PLreg.control'></span>

<h3>Description</h3>

<p>Parameters that control fitting of power logit regression models using <code><a href="#topic+PLreg">PLreg</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PLreg.control(
  lambda = NULL,
  method = "BFGS",
  maxit = 2000,
  trace = FALSE,
  start = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PLregcontrol_+3A_lambda">lambda</code></td>
<td>
<p>numeric indicating the value of the skewness parameter lambda (if <code>NULL</code>,
lambda will be estimated).</p>
</td></tr>
<tr><td><code id="PLregcontrol_+3A_method">method</code></td>
<td>
<p>character specifying the <code>method</code> argument passed to <code><a href="stats.html#topic+optim">optim</a></code>.</p>
</td></tr>
<tr><td><code id="PLregcontrol_+3A_maxit">maxit</code>, <code id="PLregcontrol_+3A_trace">trace</code>, <code id="PLregcontrol_+3A_...">...</code></td>
<td>
<p>arguments passed to <code><a href="stats.html#topic+optim">optim</a></code></p>
</td></tr>
<tr><td><code id="PLregcontrol_+3A_start">start</code></td>
<td>
<p>an optional vector with starting values for median and dispersion submodels (starting value for lambda
must not be included).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>PLreg.control</code> controls the fitting process of power logit models. Almost all the arguments
are passed on directly to <code><a href="stats.html#topic+optim">optim</a></code>, which is used to estimate the parameters.
Starting values for median and dispersion submodels may be supplied via <code>start</code>. If the
estimation process is to be performed with a fixed skewness parameter, a value must be specified
in <code>lambda</code>. If <code>lambda = 0</code>, a log-log regression model
will be estimated.
</p>


<h3>Value</h3>

<p>A list with components named as the arguments.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+PLreg">PLreg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("PeruVotes")

fitPL &lt;- PLreg(votes ~ HDI | HDI, data = PeruVotes,
              family = "TF", zeta = 5, control = PLreg.control(lambda = 1))
summary(fitPL)

</code></pre>

<hr>
<h2 id='residuals.PLreg'>Residuals Method for PLreg Objects</h2><span id='topic+residuals.PLreg'></span>

<h3>Description</h3>

<p>The function provides three types of residuals for power logit regression models:
quantile, deviance and standardized.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'PLreg'
residuals(object, type = c("quantile", "deviance", "standardized"), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="residuals.PLreg_+3A_object">object</code></td>
<td>
<p>fitted model object of class &quot;<code>PLreg</code>&quot;.</p>
</td></tr>
<tr><td><code id="residuals.PLreg_+3A_type">type</code></td>
<td>
<p>character specifying the type of residuals to be used.</p>
</td></tr>
<tr><td><code id="residuals.PLreg_+3A_...">...</code></td>
<td>
<p>currently not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <em>quantile residuals</em> is based on Dunn and Smyth (1996) idea. The
residuals are well-defined for all the distributions in the power logit class and
have, approximately, a standard normal distribution in large samples if the model is
correctly specified. <br /> <br />
The <em>deviance residuals</em> are based on the log-likelihood contributions
of each observation in the sample. The distribution of this residual is unknown
(both exact and asymptotic),  except for the power logit normal model, which is,
approximately, standard normal.<br /> <br />
The <em>standardized residuals</em> are a standardized form of the ordinary
residual. These residuals take into account the diagonal elements of the <code class="reqn">H</code>
matrix, being useful for detecting leverage observations. The distribution
of the standardized residuals is unknown.
</p>


<h3>Value</h3>

<p><code>residuals</code> method for object of class &quot;<code>PLreg</code>&quot; returns a vector
with the residuals of the type specified in the <code>type</code> argument.
</p>


<h3>References</h3>

<p>Queiroz, F. F. and Ferrari, S. L. P. (2022). Power logit regression
for modeling bounded data. <em>arXiv</em>:2202.01697. <br /> <br />
Dunn, P. K. and Smyth, G. K. (1996) Randomized quantile residuals.
<em>Journal of Computational and Graphical Statistics</em>, 5:236-244.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+PLreg">PLreg</a></code>, <code><a href="#topic+plot.PLreg">plot.PLreg</a></code>, <code><a href="#topic+envelope">envelope</a></code>, <code><a href="#topic+influence">influence</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("PeruVotes")
fitPL &lt;- PLreg(votes ~ HDI | HDI, data = PeruVotes,
              family = "TF", zeta = 5)

res_quantile = residuals(fitPL, type = "quantile")
res_standardized = residuals(fitPL, type = "standardized")

plot(res_standardized, pch = "+", ylim = c(-6, 6))
abline(h = -3, lty = 2)
abline(h = 3, lty = 2)

qqnorm(res_quantile)
qqline(res_quantile)
</code></pre>

<hr>
<h2 id='sandwich'>Sandwich Variance and Covariance Matrix for PLreg Objects</h2><span id='topic+sandwich'></span>

<h3>Description</h3>

<p>The <code>sandwich</code> function provides an estimate for the asymptotic variance
and covariance matrix of the parameter estimators of the power logit (or log-log)
regression models based on de sandwich estimator (see Queiroz and Ferrari (2022)).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sandwich(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sandwich_+3A_object">object</code></td>
<td>
<p>fitted model object of class &quot;<code>PLreg</code>&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>extra.parameter</code> returns a matrix containing the sandwich variance and
covariance matrix estimate.
</p>


<h3>References</h3>

<p>Queiroz, F. F. and Ferrari, S. L. P. (2022). Power logit regression
for modeling bounded data. <em>arXiv</em>:2202.01697.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+PLreg">PLreg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("Firm")

fit &lt;- PLreg(percentfat ~ days + sex + year, data = bodyfat_Aeolus,
             family = "PE", zeta = 2)
sandwich(fit)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
