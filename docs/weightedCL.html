<!DOCTYPE html><html><head><title>Help for package weightedCL</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {weightedCL}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#weightedCL-package'><p>Efficient and feasible inference for high-dimensional normal copula regression models</p></a></li>
<li><a href='#cl'><p>COMPOSITE LIKELIHOOD ESTIMATION FOR MVN COPULA</p></a></li>
<li><a href='#godambe'><p>INVERSE GODAMBE MATRIX</p></a></li>
<li><a href='#iee'><p>INDEPENDENT ESTIMATING EQUATIONS FOR BINARY AND COUNT REGRESSION</p></a></li>
<li><a href='#iee.ord'>
<p>Maximum Likelihood for Ordinal Model</p></a></li>
<li><a href='#margmodel'><p>DENSITY AND CDF OF THE UNIVARIATE MARGINAL DISTRIBUTION</p></a></li>
<li><a href='#pbvt'>
<p>BIVARIATE NORMAL AND STUDENT CDFs WITH VECTORIZED INPUTS</p></a></li>
<li><a href='#polio'>
<p>Polio cases in USA from Jan 1970 till Dec 1983</p></a></li>
<li><a href='#sleep'><p>Infant sleep status data</p></a></li>
<li><a href='#wcl'><p>SOLVING THE WEIGHTED COMPOSITE LIKELIHOOD ESTIMATING EQUATIONS WITH INPUTS THE WEIGHT MATRICES AND  DATA</p></a></li>
<li><a href='#weightMat'><p>WEIGHT MATRICES FOR THE WEIGHTED COMPOSITE LIKELIHOOD ESTIMATING EQUATIONS</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>0.5</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-10-05</td>
</tr>
<tr>
<td>Title:</td>
<td>Efficient and Feasible Inference for High-Dimensional Normal
Copula Regression Models</td>
</tr>
<tr>
<td>Author:</td>
<td>Aristidis K. Nikoloulopoulos [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Aristidis K. Nikoloulopoulos &lt;a.nikoloulopoulos@uea.ac.uk&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), matlab,rootSolve,sure,MASS</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimates high-dimensional multivariate normal copula regression models with the weighted composite likelihood estimating equations in Nikoloulopoulos (2022) &lt;<a href="https://doi.org/10.48550/arXiv.2203.04619">doi:10.48550/arXiv.2203.04619</a>&gt;. It provides autoregressive moving average correlation structures and binary, ordinal, Poisson, and negative binomial regressions.</td>
</tr>
<tr>
<td>License:</td>
<td></td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-10-06 16:30:30 UTC; aris</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-10-10 05:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='weightedCL-package'>Efficient and feasible inference for high-dimensional normal copula regression models</h2><span id='topic+weightedCL-package'></span>

<h3>Description</h3>

<p>The weighted composite likelihood estimating equations for high-dimensional normal copula regression models in Nikoloulopoulos (2022). 
</p>


<h3>Details</h3>

<p>This package contains <span class="rlang"><b>R</b></span> functions  to estimate high-dimensional MVN copula regression models  with the WCL estimating equations in Nikoloulopoulos (2022). It provides ARMA<code class="reqn">(p, q)</code> correlation structures and binary, ordinal,  Poisson, and  negative binomial (both NB1 and NB2 parametrizations) regressions.
</p>


<h3>Author(s)</h3>

<p>Aristidis K. Nikoloulopoulos.
</p>


<h3>References</h3>

<p>Nikoloulopoulos, A.K. (2022)
Efficient and feasible inference for high-dimensional normal copula regression models.
<em>Arxiv e-prints</em>, &lt;arXiv:2203.04619&gt;. <a href="https://arxiv.org/abs/2203.04619">https://arxiv.org/abs/2203.04619</a>.
</p>

<hr>
<h2 id='cl'>COMPOSITE LIKELIHOOD ESTIMATION FOR MVN COPULA</h2><span id='topic+cl'></span><span id='topic+cl.ord'></span>

<h3>Description</h3>

<p>Composite likelihood estimation for MVN copula.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cl(p,q,b,gam,xdat,ydat,margmodel,link)
cl.ord(p,q,b,gam,xdat,ydat,link)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cl_+3A_p">p</code></td>
<td>
<p>The order of the autoregressive component.</p>
</td></tr>
<tr><td><code id="cl_+3A_q">q</code></td>
<td>
<p>The order of the moving average component.</p>
</td></tr>
<tr><td><code id="cl_+3A_b">b</code></td>
<td>
<p>The regression coefficients.</p>
</td></tr>
<tr><td><code id="cl_+3A_gam">gam</code></td>
<td>
<p>The uinivariate parameters that are not regression coefficients. That is the parameter <code class="reqn">\gamma</code> of negative binomial distribution or  the <code class="reqn">q</code>-dimensional vector of the univariate cutpoints of ordinal model. <code class="reqn">\gamma</code> is NULL for Poisson and binary regression.</p>
</td></tr>
<tr><td><code id="cl_+3A_xdat">xdat</code></td>
<td>
<p>The <code class="reqn">d\times p</code> matrix of covariates, where <code class="reqn">d</code> is the length of the time-series and <code class="reqn">p</code> is the number of covariates including
the unit first column  to account for the intercept (except for ordinal regression where there is no intercept).</p>
</td></tr>
<tr><td><code id="cl_+3A_ydat">ydat</code></td>
<td>
<p>The <code class="reqn">d</code>-dimensional vector of  dicrete time series reponse, where <code class="reqn">d</code> is the length of the series.</p>
</td></tr>
<tr><td><code id="cl_+3A_margmodel">margmodel</code></td>
<td>

<p>Indicates the marginal model.
Choices are &ldquo;poisson&rdquo; for Poisson, &ldquo;bernoulli&rdquo; for Bernoulli, 
and  &ldquo;nb1&rdquo; , &ldquo;nb2&rdquo; for the NB1 and NB2 parametrization 
of negative binomial in Cameron and Trivedi (1998).</p>
</td></tr>
<tr><td><code id="cl_+3A_link">link</code></td>
<td>
<p>The link function. 
Choices are &ldquo;log&rdquo; for the log link function, &ldquo;logit&rdquo; for 
the logit link function, and &ldquo;probit&rdquo; for 
the probit link function. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The
composite likelihood method in Zhao and Joe (2005). The
univariate parameters  are estimated
from the sum of univariate marginal log-likelihoods and then the dependence
parameters are estimated from the sum of bivariate marginal log-likelihoods
with the univariate parameters fixed from the first step. 
</p>
<p>Note that <code>cl.ord</code> is a variant of the code for ordinal (probit and logistic) regression.
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr><td><code>minimum</code></td>
<td>
<p>The negative value of the sum of bivariate marginal log-likelihoods at
CL1 estimates.</p>
</td></tr>
<tr><td><code>estimate</code></td>
<td>
<p>The composite likelihood estimates.</p>
</td></tr>
<tr><td><code>gradient</code></td>
<td>
<p>The gradient at the estimated minimum of CL1.</p>
</td></tr>
<tr><td><code>code</code></td>
<td>
<p>An integer indicating why the optimization process terminated,
same as in <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Aristidis K. Nikoloulopoulos <a href="mailto:A.Nikoloulopoulos@uea.ac.uk">A.Nikoloulopoulos@uea.ac.uk</a>
</p>


<h3>References</h3>

<p>Zhao, Y. and Joe, H. (2005)
Composite likelihood estimation in multivariate data analysis.
<em>The Canadian Journal of Statistics</em>,  <b>33</b>, 335&ndash;356.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+wcl">wcl</a></code>
<code><a href="#topic+iee">iee</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
################################################################################
#                      NB2 regression for count time-series data
################################################################################
################################################################################
#                      read and set up data set
################################################################################
data(polio)
ydat &lt;-polio
d=length(ydat)
tvec=1:length(ydat)
tvec1=tvec-73
xdat &lt;- cbind(1, tvec1/1000, cos(2 * pi * tvec1 / 12), sin(2 * pi * tvec1 / 12),
                      cos(2 * pi * tvec1 / 6), sin(2 * pi * tvec1 / 6)) 
################################################################################
#                      select the marginal model
################################################################################
margmodel="nb2"
################################################################################
#                      select the  ARMA structure
################################################################################
p=2;q=1
################################################################################
#                      perform CL1 estimation
################################################################################
i.est&lt;-iee(xdat,ydat,margmodel)
cat("\niest: IEE estimates\n")
print(c(i.est$reg,i.est$gam))
est.rho&lt;-cl(p=p,q=q,b=i.est$reg,gam=i.est$gam,
             xdat,ydat,margmodel,link)
cat("\nest.rho: CL estimates\n")
print(est.rho$e)
################################################################################
#                         Ordinal time-series regression 
################################################################################
################################################################################
#                      read and set up data set
################################################################################
data(sleep)
ydat=sleep$sleep
bydat=oydat=ydat
bydat[ydat==4]=0
bydat[ydat&lt;4]=1
oydat[ydat==4]=1
oydat[ydat&lt;4]=2
oydat[ydat==2]=3
oydat[ydat==3]=4

x1=sleep$heartrate
x2=sleep$temperature
z1=(x1-mean(x1))/sd(x1)
z2=(x2-mean(x2))/sd(x2)
xdat=cbind(z1,z2)
################################################################################
#                      select the link
################################################################################
link="probit"
################################################################################
#                      select the ARMA structure
################################################################################
p=1;q=0
################################################################################
#                      perform CL1 estimation
################################################################################
i.est&lt;-iee.ord(xdat,oydat,link)
cat("\niest: IEE estimates\n")
print(c(i.est$reg,i.est$gam))
est.rho&lt;-cl.ord(p=p,q=q,b=i.est$reg,gam=i.est$gam,
             xdat,oydat,link)
cat("\nest.rho: CL estimates\n")
print(est.rho$e)

</code></pre>

<hr>
<h2 id='godambe'>INVERSE GODAMBE MATRIX</h2><span id='topic+godambe'></span><span id='topic+godambe.ord'></span>

<h3>Description</h3>

<p>Asymptotic covariance matrix of the weighted composite likelihood estimates.</p>


<h3>Usage</h3>

<pre><code class='language-R'>godambe(b, gam, rh, p, q, xdat, margmodel, link = "log")
godambe.ord(b,gam,rh,p,q,xdat,link)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="godambe_+3A_b">b</code></td>
<td>
<p>The regression coefficients.</p>
</td></tr>
<tr><td><code id="godambe_+3A_gam">gam</code></td>
<td>
<p>The uinivariate parameters that are not regression coefficients. That is the parameter <code class="reqn">\gamma</code> of negative binomial distribution or  the <code class="reqn">q</code>-dimensional vector of the univariate cutpoints of ordinal model. <code class="reqn">\gamma</code> is NULL for Poisson and binary regression.</p>
</td></tr>
<tr><td><code id="godambe_+3A_rh">rh</code></td>
<td>
<p>The vector of autregressive and moving average parameters in high-dimensional normal copula regression models with an ARMA(<code class="reqn">p,q</code>) correlation matrix.</p>
</td></tr>
<tr><td><code id="godambe_+3A_p">p</code></td>
<td>
<p>The order of the autoregressive component.</p>
</td></tr>
<tr><td><code id="godambe_+3A_q">q</code></td>
<td>
<p>The order of the moving average component.</p>
</td></tr>
<tr><td><code id="godambe_+3A_xdat">xdat</code></td>
<td>
<p>The <code class="reqn">d\times p</code> matrix of covariates, where <code class="reqn">d</code> is the length of the time-series and <code class="reqn">p</code> is the number of covariates including
the unit first column  to account for the intercept (except for ordinal regression where there is no intercept).</p>
</td></tr>
<tr><td><code id="godambe_+3A_margmodel">margmodel</code></td>
<td>

<p>Indicates the marginal model.
Choices are &ldquo;poisson&rdquo; for Poisson, &ldquo;bernoulli&rdquo; for Bernoulli, 
and  &ldquo;nb1&rdquo; , &ldquo;nb2&rdquo; for the NB1 and NB2 parametrization 
of negative binomial in Cameron and Trivedi (1998).</p>
</td></tr>
<tr><td><code id="godambe_+3A_link">link</code></td>
<td>
<p>The link function. 
Choices are &ldquo;log&rdquo; for the log link function, &ldquo;logit&rdquo; for 
the logit link function, and &ldquo;probit&rdquo; for 
the probit link function. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that <code>godambe.ord</code> is a variant of the code for ordinal (probit and logistic) regression.
</p>


<h3>Value</h3>

<p>The inverse Godambe matrix.</p>


<h3>Author(s)</h3>

<p>Aristidis K. Nikoloulopoulos <a href="mailto:A.Nikoloulopoulos@uea.ac.uk">A.Nikoloulopoulos@uea.ac.uk</a>
</p>


<h3>References</h3>

<p>Godambe, V. P. (1991)
<em>Estimating Functions</em>.
Oxford: Oxford University Press
</p>
<p>Nikoloulopoulos, A.K. (2022)
Efficient and feasible inference for high-dimensional normal copula regression models.
<em>Arxiv e-prints</em>, &lt;arXiv:2203.04619&gt;. <a href="https://arxiv.org/abs/2203.04619">https://arxiv.org/abs/2203.04619</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+wcl">wcl</a></code>,
<code><a href="#topic+weightMat">weightMat</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>################################################################################
#                      NB2 regression for count time-series data
################################################################################
################################################################################
#                      read and set up data set
################################################################################

data(polio)
ydat &lt;-polio
d=length(ydat)
tvec=1:length(ydat)
tvec1=tvec-73
xdat &lt;- cbind(1, tvec1/1000, cos(2 * pi * tvec1 / 12), sin(2 * pi * tvec1 / 12),
                      cos(2 * pi * tvec1 / 6), sin(2 * pi * tvec1 / 6)) 
################################################################################
#                      select the marginal model
################################################################################
margmodel="nb2"
################################################################################
#                      select the  ARMA structure
################################################################################
p=2;q=1
################################################################################
#                      perform CL1 estimation
################################################################################
i.est&lt;-iee(xdat,ydat,margmodel)
cat("\niest: IEE estimates\n")
print(c(i.est$reg,i.est$gam))
est.rho&lt;-cl(p=p,q=q,b=i.est$reg,gam=i.est$gam,
             xdat,ydat,margmodel,link)
cat("\nest.rho: CL estimates\n")
print(est.rho$e)
################################################################################
#                      obtain the weight matrices
################################################################################
WtScMat&lt;-weightMat(b=i.est$reg,gam=i.est$gam,rh=est.rho$e,
                   p=p,q=q,xdat,margmodel)
################################################################################
#           obtain the weighted composite likelihood estimates
################################################################################  
est&lt;-wcl(start=c(i.est$reg,i.est$gam),WtScMat,xdat,ydat,
              margmodel,link)
cat("est=parameter estimates\n")
print(est$r) 
################################################################################
#                      obtain the inverse Godambe matrix
################################################################################
acov=godambe(b=est$r[-length(est$r)],gam=est$r[length(est$r)],
                rh=est.rho$e,p,q,xdat,margmodel)
cat("\nacov: inverse Godambe matrix\n")
print(acov)
################################################################################
#                         Ordinal time-series regression 
################################################################################
################################################################################
#                      read and set up data set
################################################################################
data(sleep)
ydat=sleep$sleep
bydat=oydat=ydat
bydat[ydat==4]=0
bydat[ydat&lt;4]=1
oydat[ydat==4]=1
oydat[ydat&lt;4]=2
oydat[ydat==2]=3
oydat[ydat==3]=4

x1=sleep$heartrate
x2=sleep$temperature
z1=(x1-mean(x1))/sd(x1)
z2=(x2-mean(x2))/sd(x2)
xdat=cbind(z1,z2)
################################################################################
#                      select the link
################################################################################
link="probit"
################################################################################
#                      select the ARMA structure
################################################################################
p=1;q=0
################################################################################
#                      perform CL1 estimation
################################################################################
i.est&lt;-iee.ord(xdat,oydat,link)
cat("\niest: IEE estimates\n")
print(c(i.est$reg,i.est$gam))
est.rho&lt;-cl.ord(p=p,q=q,b=i.est$reg,gam=i.est$gam,
             xdat,oydat,link)
cat("\nest.rho: CL estimates\n")
print(est.rho$e)
################################################################################
#                      obtain the weight matrices
################################################################################
WtScMat&lt;-weightMat.ord(b=i.est$reg,gam=i.est$gam,rh=est.rho$e,
                   p=p,q=q,xdat,link)
################################################################################
#           obtain the weighted composite likelihood estimates
################################################################################  
est&lt;-wcl.ord(start=c(i.est$reg,i.est$gam),WtScMat,
                  xdat,oydat,link)
cat("est=parameter estimates\n")
print(est$r)  

################################################################################
#                      obtain the inverse Godambe matrix
################################################################################
acov=godambe.ord(b=est$r[1:2],gam=est$r[3:5],
                 rh=est.rho$e,p,q,xdat,link)
cat("\nacov: inverse Godambe matrix\n")
print(acov)

</code></pre>

<hr>
<h2 id='iee'>INDEPENDENT ESTIMATING EQUATIONS FOR BINARY AND COUNT REGRESSION</h2><span id='topic+iee'></span>

<h3>Description</h3>

<p>Independent estimating equations for binary and count regression.</p>


<h3>Usage</h3>

<pre><code class='language-R'>iee(xdat,ydat,margmodel,link) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="iee_+3A_xdat">xdat</code></td>
<td>
<p>The <code class="reqn">d\times p</code> matrix of covariates, where <code class="reqn">d</code> is the length of the time-series and <code class="reqn">p</code> is the number of covariates including
the unit first column  to account for the intercept (except for ordinal regression where there is no intercept).</p>
</td></tr>
<tr><td><code id="iee_+3A_ydat">ydat</code></td>
<td>
<p>The <code class="reqn">d</code>-dimensional vector of  dicrete time series reponse, where <code class="reqn">d</code> is the length of the series.</p>
</td></tr>
<tr><td><code id="iee_+3A_margmodel">margmodel</code></td>
<td>

<p>Indicates the marginal model.
Choices are &ldquo;poisson&rdquo; for Poisson, &ldquo;bernoulli&rdquo; for Bernoulli, 
and  &ldquo;nb1&rdquo; , &ldquo;nb2&rdquo; for the NB1 and NB2 parametrization 
of negative binomial in Cameron and Trivedi (1998).</p>
</td></tr>
<tr><td><code id="iee_+3A_link">link</code></td>
<td>
<p>The link function.
Choices are &ldquo;log&rdquo; for the log link function, &ldquo;logit&rdquo; for 
the logit link function, and &ldquo;probit&rdquo; for 
the probit link function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The univariate parameters  are
estimated from the sum of univariate marginal log-likelihoods.
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr><td><code>coef</code></td>
<td>
<p>The vector with the estimated regression parameters.</p>
</td></tr>
<tr><td><code>gam</code></td>
<td>
<p>The vector with the estimated parameters that  are not regression parameters. This is NULL for Poisson and binary regression.</p>
</td></tr> </table>


<h3>Author(s)</h3>

<p>Aristidis K. Nikoloulopoulos <a href="mailto:A.Nikoloulopoulos@uea.ac.uk">A.Nikoloulopoulos@uea.ac.uk</a>
</p>


<h3>References</h3>

<p>Cameron, A. C. and Trivedi, P. K. (1998)
<em>Regression Analysis of Count Data.</em>
Cambridge: Cambridge University Press.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>################################################################################
#                      NB2 regression for count time-series data
################################################################################
################################################################################
#                      read and set up data set
################################################################################
data(polio)
ydat &lt;-polio
d=length(ydat)
tvec=1:length(ydat)
tvec1=tvec-73
xdat &lt;- cbind(1, tvec1/1000, cos(2 * pi * tvec1 / 12), sin(2 * pi * tvec1 / 12),
                      cos(2 * pi * tvec1 / 6), sin(2 * pi * tvec1 / 6)) 
################################################################################
#                      select the marginal model
################################################################################
margmodel="nb2"

i.est&lt;-iee(xdat,ydat,margmodel)
cat("\niest: IEE estimates\n")
print(c(i.est$reg,i.est$gam))
</code></pre>

<hr>
<h2 id='iee.ord'>
Maximum Likelihood for Ordinal Model 
</h2><span id='topic+iee.ord'></span>

<h3>Description</h3>

<p>Maximum Likelihood for Ordinal Probit and Logit: 
Newton-Raphson minimization of negative log-likelihood. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>iee.ord(x,y,link,iprint=0,maxiter=20,toler=1.e-6)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="iee.ord_+3A_x">x</code></td>
<td>

<p>vector or matrix of explanatory variables. Each row corresponds
to an observation and each column to a variable.  The number of rows of x
should equal the number of data values in y, and there should be fewer 
columns than rows.  Missing values are not allowed.
</p>
</td></tr>
<tr><td><code id="iee.ord_+3A_y">y</code></td>
<td>

<p>numeric vector containing the ordinal response. 
The values must be in the range 1,2,..., number of categories.
Missing values are not allowed. 
</p>
</td></tr>
<tr><td><code id="iee.ord_+3A_link">link</code></td>
<td>
<p>The link function.Choices are  &ldquo;logit&rdquo; for 
the logit link function, and &ldquo;probit&rdquo; for 
the probit link function.</p>
</td></tr>
<tr><td><code id="iee.ord_+3A_iprint">iprint</code></td>
<td>

<p>logical indicator, default is FALSE, for whether the iterations for 
numerical maximum likelihood should be printed.
</p>
</td></tr>
<tr><td><code id="iee.ord_+3A_maxiter">maxiter</code></td>
<td>

<p>maximum number of Newton-Raphson iterations, default = 20.
</p>
</td></tr>
<tr><td><code id="iee.ord_+3A_toler">toler</code></td>
<td>

<p>tolerance for convergence in Newton-Raphson iterations, default = 1.e-6.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The ordinal probit model is similar to the ordinal logit model.
The parameter estimate of ordinal logit are roughly 1.8 to 2 times
those of ordinal probit. 
</p>


<h3>Value</h3>

<p>list of MLE of parameters and their associated standard 
errors, in the order cutpt1,...,cutpt(number of categ-1),b1,...b(number of covariates).
</p>
<table>
<tr><td><code>negloglik</code></td>
<td>

<p>value of negative log-likelihood, evaluated at MLE
</p>
</td></tr>
<tr><td><code>gam</code></td>
<td>

<p>MLE of ordered cutpoint parameters
</p>
</td></tr>
<tr><td><code>reg</code></td>
<td>

<p>MLE of regression parameters
</p>
</td></tr>
<tr><td><code>cov</code></td>
<td>

<p>estimated covariance matrix of the parameters
</p>
</td></tr>
</table>


<h3>References</h3>

<p>Anderson, J.A. and Pemberton, J.D. (1985). The grouped continuous model for
multivariate ordered categorical variables and covariate adjustment.  
<em>Biometrics</em>,  <b>41</b>, 875&ndash;885.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>################################################################################
#                         Ordinal regression 
################################################################################
################################################################################
#                      read and set up data set
################################################################################
data(sleep)
ydat=sleep$sleep
bydat=oydat=ydat
bydat[ydat==4]=0
bydat[ydat&lt;4]=1
oydat[ydat==4]=1
oydat[ydat&lt;4]=2
oydat[ydat==2]=3
oydat[ydat==3]=4

x1=sleep$heartrate
x2=sleep$temperature
z1=(x1-mean(x1))/sd(x1)
z2=(x2-mean(x2))/sd(x2)
xdat=cbind(z1,z2)
################################################################################
#                      select the link
################################################################################
link="probit"
i.est&lt;-iee.ord(xdat,ydat,link)
cat("\niest: IEE estimates\n")
print(c(i.est$reg,i.est$gam))
</code></pre>

<hr>
<h2 id='margmodel'>DENSITY AND CDF OF THE UNIVARIATE MARGINAL DISTRIBUTION</h2><span id='topic+margmodel.ord'></span><span id='topic+dmargmodel'></span><span id='topic+pmargmodel'></span><span id='topic+dmargmodel.ord'></span><span id='topic+pmargmodel.ord'></span>

<h3>Description</h3>

<p>Density and cdf of the univariate marginal distribution.</p>


<h3>Usage</h3>

<pre><code class='language-R'>dmargmodel(y,mu,gam,invgam,margmodel)
pmargmodel(y,mu,gam,invgam,margmodel)
dmargmodel.ord(y,mu,gam,link)
pmargmodel.ord(y,mu,gam,link)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="margmodel_+3A_y">y</code></td>
<td>
<p>Vector of (non-negative integer) quantiles.</p>
</td></tr>
<tr><td><code id="margmodel_+3A_mu">mu</code></td>
<td>
<p>The parameter <code class="reqn">\mu</code> of the univariate distribution.</p>
</td></tr>
<tr><td><code id="margmodel_+3A_gam">gam</code></td>
<td>
<p>The parameter(s) <code class="reqn">\gamma</code> that are not regression parameters. <code class="reqn">\gamma</code> is NULL for Poisson and Bernoulli distribution.</p>
</td></tr>
<tr><td><code id="margmodel_+3A_invgam">invgam</code></td>
<td>
<p>The  inverse of parameter <code class="reqn">\gamma</code> of negative binomial
distribution.</p>
</td></tr>
<tr><td><code id="margmodel_+3A_margmodel">margmodel</code></td>
<td>

<p>Indicates the marginal model.
Choices are &ldquo;poisson&rdquo; for Poisson, &ldquo;bernoulli&rdquo; for Bernoulli, 
and  &ldquo;nb1&rdquo; , &ldquo;nb2&rdquo; for the NB1 and NB2 parametrization 
of negative binomial in Cameron and Trivedi (1998). See details.</p>
</td></tr>
<tr><td><code id="margmodel_+3A_link">link</code></td>
<td>
<p>The link function. 
Choices are  &ldquo;logit&rdquo; for 
the logit link function, and &ldquo;probit&rdquo; for 
the probit link function. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Negative binomial distribution
NB<code class="reqn">(\tau,\xi)</code> allows for overdispersion
and its probability mass function (pmf) is  given by
</p>
<p style="text-align: center;"><code class="reqn"> f(y;\tau,\xi)=\frac{\Gamma(\tau+y)}{\Gamma(\tau)\; y!}
  \frac{\xi^y}{(1+\xi)^{\tau + y}},\quad \begin{matrix} y=0,1,2,\ldots, \\
                                          \tau&gt;0,\; \xi&gt;0,\end{matrix}  </code>
</p>

<p>with mean <code class="reqn">\mu=\tau\,\xi=\exp(\beta^T x)</code> and variance <code class="reqn">\tau\,\xi\,(1+\xi)</code>.
</p>
<p>Cameron and Trivedi (1998) present the NBk parametrization where
<code class="reqn">\tau=\mu^{2-k}\gamma^{-1}</code> and <code class="reqn">\xi=\mu^{k-1}\gamma</code>, <code class="reqn">1\le k\le 2</code>.
In this function we use the NB1 parametrization
<code class="reqn">(\tau=\mu\gamma^{-1},\; \xi=\gamma)</code>, and the NB2 parametrization
<code class="reqn">(\tau=\gamma^{-1},\; \xi=\mu\gamma)</code>; the latter
is the same as in Lawless (1987).
</p>
<p><code>margmodel.ord</code> is a variant of the code for ordinal (probit and logistic) model. In this case, the response <code class="reqn">Y</code> is assumed to have density
</p>
<p style="text-align: center;"><code class="reqn">f_1(y;\nu,\gamma)=F(\alpha_{y}+\nu)-F(\alpha_{y-1}+\nu),</code>
</p>

<p>where <code class="reqn">\nu=x\beta</code> is a function of <code class="reqn">x</code>
and the <code class="reqn">p</code>-dimensional regression vector <code class="reqn">\beta</code>, and <code class="reqn">\gamma=(\alpha_1,\ldots,\alpha_{K-1})</code> is the $q$-dimensional vector of the univariate cutpoints (<code class="reqn">q=K-1</code>). Note that <code class="reqn">F</code> normal leads to the probit model and <code class="reqn">F</code> logistic
leads to the cumulative logit model for ordinal response.
</p>


<h3>Value</h3>

<p>The density and cdf of the univariate distribution.</p>


<h3>References</h3>

<p>Cameron, A. C. and Trivedi, P. K. (1998)
<em>Regression Analysis of Count Data.</em>
Cambridge: Cambridge University Press.
</p>
<p>Lawless, J. F. (1987)
Negative binomial and mixed Poisson regression.
<em>The Canadian Journal
of Statistics</em>, <b>15</b>, 209&ndash;225.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>y&lt;-3
gam&lt;-2.5
invgam&lt;-1/2.5
mu&lt;-0.5
margmodel&lt;-"nb2"
dmargmodel(y,mu,gam,invgam,margmodel)
pmargmodel(y,mu,gam,invgam,margmodel)
link="probit"
dmargmodel.ord(y,mu,gam,link)
pmargmodel.ord(y,mu,gam,link)

</code></pre>

<hr>
<h2 id='pbvt'>
BIVARIATE NORMAL AND STUDENT CDFs WITH VECTORIZED INPUTS  </h2><span id='topic+pbvt'></span>

<h3>Description</h3>

<p>Bivariate normal and Student cdfs with vectorized inputs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pbvt(z1,z2,param,icheck=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pbvt_+3A_z1">z1</code></td>
<td>
<p>scalar or vector of reals </p>
</td></tr>
<tr><td><code id="pbvt_+3A_z2">z2</code></td>
<td>
<p>scalar or vector of reals </p>
</td></tr>
<tr><td><code id="pbvt_+3A_param">param</code></td>
<td>
<p>vector of length 2, or matrix with 2 columns;
vectors and number of rows of matrix cannot be different if larger than 1;
for param, first column is rho, second column is df.</p>
</td></tr>
<tr><td><code id="pbvt_+3A_icheck">icheck</code></td>
<td>
<p>TRUE if checks are made for proper inputs, default of FALSE</p>
</td></tr>
</table>


<h3>Value</h3>

<p>cdf value(s)
</p>


<h3>References</h3>

<p>Joe H (2014) <em>CopulaModel:  Dependence Modeling with Copulas</em>. Software for book: <em>Dependence Modeling with Copulas</em>, Chapman &amp; Hall/CRC, 2014.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cat("\n pbvt rho changing\n")
z1=.3; z2=.4; rho=seq(-.9,.9,.1); nu=2
param=cbind(rho,rep(nu,length(rho)))
out1=pbvt(z1,z2,param)
print(cbind(rho,out1))
cat("\n pbvt z1 changing\n")
z1=seq(-2,2,.4)
z2=.4; rho=.5; nu=2
out2=pbvt(z1,z2,c(rho,nu))
print(cbind(z1,out2))
</code></pre>

<hr>
<h2 id='polio'>
Polio cases in USA from Jan 1970 till Dec 1983
</h2><span id='topic+polio'></span>

<h3>Description</h3>

<p>The data set contains the monthly number of cases of poliomyelitis in the United States between 1970 and 1983.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(polio)</code></pre>


<h3>Format</h3>

<p>The dataset consists of one variable of 168 monthly observations.
</p>

<dl>
<dt><code>polio</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Source</h3>

<p>Zeger, S. A Regression Model for Time Series of Counts. <em>Biometrica</em>, <b>75</b>(4):621&ndash;629.  
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(polio)
</code></pre>

<hr>
<h2 id='sleep'>Infant sleep status data
</h2><span id='topic+sleep'></span>

<h3>Description</h3>

<p>The sleep data  consist of sleep state measurements of a newborn infant together with his heart rate and temperature sampled every 30 seconds. The sleep states are classified as: (1) quiet sleep, (2) indeterminate sleep, (3) active sleep, (4) awake. The total number of observations is equal to 1024 and the objective is to predict the sleep state based on covariate information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(sleep)</code></pre>


<h3>Format</h3>

<p>A data frame with 1024 observations on the following 3 variables:
</p>

<dl>
<dt><code>heartrate</code></dt><dd><p>Heart rate.</p>
</dd>
<dt><code>sleep</code></dt><dd><p>An ordinal time series in the sense that the response increases from awake to active sleep, i.e., (4) &lt; (1) &lt; (2) &lt; (3).</p>
</dd>
<dt><code>temperature</code></dt><dd><p>Temperature</p>
</dd>
</dl>
 


<h3>Source</h3>

<p>Fokianos, K. and Kedem, B. (2003). Regression theory for categorical time series. <em>Statistical Science</em>, <b>18</b>(3):357&ndash;376.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sleep)
</code></pre>

<hr>
<h2 id='wcl'>SOLVING THE WEIGHTED COMPOSITE LIKELIHOOD ESTIMATING EQUATIONS WITH INPUTS THE WEIGHT MATRICES AND  DATA</h2><span id='topic+wcl'></span><span id='topic+wcl.ord'></span>

<h3>Description</h3>

<p>Solving the weighted composite likelihood estimating equations with inputs the weight matrices
and data.</p>


<h3>Usage</h3>

<pre><code class='language-R'>wcl(start,WtScMat,xdat,ydat,margmodel,link)
wcl.ord(start,WtScMat,xdat,ydat,link)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wcl_+3A_start">start</code></td>
<td>
<p>A starting value of the vector of regression
and not regression parameters. The composite likelihood estimates of regression and not regression parameters 
is a good starting value.</p>
</td></tr>
<tr><td><code id="wcl_+3A_wtscmat">WtScMat</code></td>
<td>
<p>A list containing the following components.
omega: the matrix  <code class="reqn">\boldsymbol{\Omega}^{(1)}</code>;
delta: the matrix <code class="reqn">\boldsymbol{\Delta}^{(1)}</code>;
X: the matrix <code class="reqn">\mathbf{X}</code>.</p>
</td></tr>
<tr><td><code id="wcl_+3A_xdat">xdat</code></td>
<td>
<p>The <code class="reqn">d\times p</code> matrix of covariates, where <code class="reqn">d</code> is the length of the time-series and <code class="reqn">p</code> is the number of covariates including
the unit first column  to account for the intercept (except for ordinal regression where there is no intercept).</p>
</td></tr>
<tr><td><code id="wcl_+3A_ydat">ydat</code></td>
<td>
<p>The <code class="reqn">d</code>-dimensional vector of  dicrete time series reponse, where <code class="reqn">d</code> is the length of the series.</p>
</td></tr>
<tr><td><code id="wcl_+3A_margmodel">margmodel</code></td>
<td>

<p>Indicates the marginal model.
Choices are &ldquo;poisson&rdquo; for Poisson, &ldquo;bernoulli&rdquo; for Bernoulli, 
and  &ldquo;nb1&rdquo; , &ldquo;nb2&rdquo; for the NB1 and NB2 parametrization 
of negative binomial in Cameron and Trivedi (1998).</p>
</td></tr>
<tr><td><code id="wcl_+3A_link">link</code></td>
<td>
<p>The link function. 
Choices are &ldquo;log&rdquo; for the log link function, &ldquo;logit&rdquo; for 
the logit link function, and &ldquo;probit&rdquo; for 
the probit link function. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Obtain  estimates <code class="reqn">{\hat{\mathbf{a}}}</code> of the univariate parameters
solving the weighted composite likelihood estimating equations.
</p>
<p>Note that <code>wcl.ord</code> is a variant of the code for ordinal (probit and logistic) regression.
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr><td><code>root</code></td>
<td>
<p>The weighted composite likelihood estimates.</p>
</td></tr>
<tr><td><code>f.root</code></td>
<td>
<p>The value of the weighted composite likelihood estimating equations evaluated at the root.</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p>The number of iterations used.</p>
</td></tr>
<tr><td><code>estim.precis</code></td>
<td>
<p>The estimated precision for root.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Aristidis K. Nikoloulopoulos <a href="mailto:A.Nikoloulopoulos@uea.ac.uk">A.Nikoloulopoulos@uea.ac.uk</a>
</p>


<h3>References</h3>

<p>Nikoloulopoulos, A.K. (2022)
Efficient and feasible inference for high-dimensional normal copula regression models.
<em>Arxiv e-prints</em>, &lt;arXiv:2203.04619&gt;. <a href="https://arxiv.org/abs/2203.04619">https://arxiv.org/abs/2203.04619</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+weightMat">weightMat</a></code>,
<code><a href="#topic+godambe">godambe</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
################################################################################
#                      NB2 regression for count time-series data
################################################################################
################################################################################
#                      read and set up data set
################################################################################
data(polio)
ydat &lt;-polio
d=length(ydat)
tvec=1:length(ydat)
tvec1=tvec-73
xdat &lt;- cbind(1, tvec1/1000, cos(2 * pi * tvec1 / 12), sin(2 * pi * tvec1 / 12),
                      cos(2 * pi * tvec1 / 6), sin(2 * pi * tvec1 / 6)) 
################################################################################
#                      select the marginal model
################################################################################
margmodel="nb2"
################################################################################
#                      select the  ARMA structure
################################################################################
p=2;q=1
################################################################################
#                      perform CL1 estimation
################################################################################
i.est&lt;-iee(xdat,ydat,margmodel)
cat("\niest: IEE estimates\n")
print(c(i.est$reg,i.est$gam))
est.rho&lt;-cl(p=p,q=q,b=i.est$reg,gam=i.est$gam,
             xdat,ydat,margmodel,link)
cat("\nest.rho: CL estimates\n")
print(est.rho$e)
################################################################################
#                      obtain the weight matrices
################################################################################
WtScMat&lt;-weightMat(b=i.est$reg,gam=i.est$gam,rh=est.rho$e,
                   p=p,q=q,xdat,margmodel)
################################################################################
#           obtain the weighted composite likelihood estimates
################################################################################  
est&lt;-wcl(start=c(i.est$reg,i.est$gam),WtScMat,xdat,ydat,
              margmodel,link)
cat("est=parameter estimates\n")
print(est$r)                                  
################################################################################
#                         Ordinal time-series regression 
################################################################################
################################################################################
#                      read and set up data set
################################################################################
data(sleep)
ydat=sleep$sleep
bydat=oydat=ydat
bydat[ydat==4]=0
bydat[ydat&lt;4]=1
oydat[ydat==4]=1
oydat[ydat&lt;4]=2
oydat[ydat==2]=3
oydat[ydat==3]=4

x1=sleep$heartrate
x2=sleep$temperature
z1=(x1-mean(x1))/sd(x1)
z2=(x2-mean(x2))/sd(x2)
xdat=cbind(z1,z2)
################################################################################
#                      select the link
################################################################################
link="probit"
################################################################################
#                      select the ARMA structure
################################################################################
p=1;q=0
################################################################################
#                      perform CL1 estimation
################################################################################
i.est&lt;-iee.ord(xdat,oydat,link)
cat("\niest: IEE estimates\n")
print(c(i.est$reg,i.est$gam))
est.rho&lt;-cl.ord(p=p,q=q,b=i.est$reg,gam=i.est$gam,
             xdat,oydat,link)
cat("\nest.rho: CL estimates\n")
print(est.rho$e)
################################################################################
#                      obtain the weight matrices
################################################################################
WtScMat&lt;-weightMat.ord(b=i.est$reg,gam=i.est$gam,rh=est.rho$e,
                   p=p,q=q,xdat,link)
################################################################################
#           obtain the weighted composite likelihood estimates
################################################################################  
est&lt;-wcl.ord(start=c(i.est$reg,i.est$gam),WtScMat,
                  xdat,oydat,link)
cat("est=parameter estimates\n")
print(est$r)               

</code></pre>

<hr>
<h2 id='weightMat'>WEIGHT MATRICES FOR THE WEIGHTED COMPOSITE LIKELIHOOD ESTIMATING EQUATIONS</h2><span id='topic+weightMat'></span><span id='topic+weightMat.ord'></span>

<h3>Description</h3>

<p>Weight matrices for the weighted composite likelhood estimating equations.</p>


<h3>Usage</h3>

<pre><code class='language-R'>weightMat(b,gam,rh,p,q,xdat,margmodel,link)
weightMat.ord(b,gam,rh,p,q,xdat,link)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="weightMat_+3A_b">b</code></td>
<td>
<p>The regression coefficients.</p>
</td></tr>
<tr><td><code id="weightMat_+3A_gam">gam</code></td>
<td>
<p>The uinivariate parameters that are not regression coefficients. That is the parameter <code class="reqn">\gamma</code> of negative binomial distribution or  the <code class="reqn">q</code>-dimensional vector of the univariate cutpoints of ordinal model. <code class="reqn">\gamma</code> is NULL for Poisson and binary regression.</p>
</td></tr>
<tr><td><code id="weightMat_+3A_rh">rh</code></td>
<td>
<p>The vector of autregressive and moving average parameters in high-dimensional normal copula regression models with an ARMA(<code class="reqn">p,q</code>) correlation matrix.</p>
</td></tr>
<tr><td><code id="weightMat_+3A_p">p</code></td>
<td>
<p>The order of the autoregressive component.</p>
</td></tr>
<tr><td><code id="weightMat_+3A_q">q</code></td>
<td>
<p>The order of the moving average component.</p>
</td></tr>
<tr><td><code id="weightMat_+3A_xdat">xdat</code></td>
<td>
<p>The <code class="reqn">d\times p</code> matrix of covariates, where <code class="reqn">d</code> is the length of the time-series and <code class="reqn">p</code> is the number of covariates including
the unit first column  to account for the intercept (except for ordinal regression where there is no intercept).</p>
</td></tr>
<tr><td><code id="weightMat_+3A_margmodel">margmodel</code></td>
<td>

<p>Indicates the marginal model.
Choices are &ldquo;poisson&rdquo; for Poisson, &ldquo;bernoulli&rdquo; for Bernoulli, 
and  &ldquo;nb1&rdquo; , &ldquo;nb2&rdquo; for the NB1 and NB2 parametrization 
of negative binomial in Cameron and Trivedi (1998).</p>
</td></tr>
<tr><td><code id="weightMat_+3A_link">link</code></td>
<td>
<p>The link function. 
Choices are &ldquo;log&rdquo; for the log link function, &ldquo;logit&rdquo; for 
the logit link function, and &ldquo;probit&rdquo; for 
the probit link function. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The  matrices that form the weight matrices <code class="reqn">\mathbf{W}^{(1)}</code>  of the weighted composite likelihood estimating equations in Nikoloulopoulos et al. (2022).
Note that <code>weightMat.ord</code> is a variant of the code for ordinal (probit and logistic) regression.
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr><td><code>omega</code></td>
<td>
<p> The  <code class="reqn">\boldsymbol{\Omega}^{(1)}</code> matrix.</p>
</td></tr>
<tr><td><code>delta</code></td>
<td>
<p> The  <code class="reqn">\boldsymbol{\Delta}^{(1)}</code> matrix.</p>
</td></tr>
<tr><td><code>X</code></td>
<td>
<p> The <code class="reqn">\mathbf{X}</code> matrix.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Aristidis K. Nikoloulopoulos <a href="mailto:A.Nikoloulopoulos@uea.ac.uk">A.Nikoloulopoulos@uea.ac.uk</a>
</p>


<h3>References</h3>

<p>Nikoloulopoulos, A.K. (2022)
Efficient and feasible inference for high-dimensional normal copula regression models.
<em>Arxiv e-prints</em>, &lt;arXiv:2203.04619&gt;. <a href="https://arxiv.org/abs/2203.04619">https://arxiv.org/abs/2203.04619</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+wcl">wcl</a></code>,
<code><a href="#topic+godambe">godambe</a></code>,
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
################################################################################
#                      NB2 regression for count time-series data
################################################################################
################################################################################
#                      read and set up data set
################################################################################
data(polio)
ydat &lt;-polio
d=length(ydat)
tvec=1:length(ydat)
tvec1=tvec-73
xdat &lt;- cbind(1, tvec1/1000, cos(2 * pi * tvec1 / 12), sin(2 * pi * tvec1 / 12),
                      cos(2 * pi * tvec1 / 6), sin(2 * pi * tvec1 / 6)) 
################################################################################
#                      select the marginal model
################################################################################
margmodel="nb2"
################################################################################
#                      select the  ARMA structure
################################################################################
p=2;q=1
################################################################################
#                      perform CL1 estimation
################################################################################
i.est&lt;-iee(xdat,ydat,margmodel)
cat("\niest: IEE estimates\n")
print(c(i.est$reg,i.est$gam))
est.rho&lt;-cl(p=p,q=q,b=i.est$reg,gam=i.est$gam,
             xdat,ydat,margmodel,link)
cat("\nest.rho: CL estimates\n")
print(est.rho$e)
################################################################################
#                      obtain the weight matrices
################################################################################
WtScMat&lt;-weightMat(b=i.est$reg,gam=i.est$gam,rh=est.rho$e,
                   p=p,q=q,xdat,margmodel)
################################################################################
#                         Ordinal time-series regression 
################################################################################
################################################################################
#                      read and set up data set
################################################################################
data(sleep)
ydat=sleep$sleep
bydat=oydat=ydat
bydat[ydat==4]=0
bydat[ydat&lt;4]=1
oydat[ydat==4]=1
oydat[ydat&lt;4]=2
oydat[ydat==2]=3
oydat[ydat==3]=4

x1=sleep$heartrate
x2=sleep$temperature
z1=(x1-mean(x1))/sd(x1)
z2=(x2-mean(x2))/sd(x2)
xdat=cbind(z1,z2)
################################################################################
#                      select the link
################################################################################
link="probit"
################################################################################
#                      select the ARMA structure
################################################################################
p=1;q=0
################################################################################
#                      perform CL1 estimation
################################################################################
i.est&lt;-iee.ord(xdat,oydat,link)
cat("\niest: IEE estimates\n")
print(c(i.est$reg,i.est$gam))
est.rho&lt;-cl.ord(p=p,q=q,b=i.est$reg,gam=i.est$gam,
             xdat,oydat,link)
cat("\nest.rho: CL1 estimates\n")
print(est.rho$e)
WtScMat&lt;-weightMat.ord(b=i.est$reg,gam=i.est$gam,rh=est.rho$e,xdat,ydat,id,tvec,corstr,link)
################################################################################
#                      obtain the weight matrices
################################################################################
WtScMat&lt;-weightMat.ord(b=i.est$reg,gam=i.est$gam,rh=est.rho$e,
                   p=p,q=q,xdat,link)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
