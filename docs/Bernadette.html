<!DOCTYPE html><html><head><title>Help for package Bernadette</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {Bernadette}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#age_distribution'><p>Country-specific age distribution</p></a></li>
<li><a href='#age_specific_cusum_infection_counts'><p>Age distribution of cumulative reported infections for Greece</p></a></li>
<li><a href='#age_specific_infection_counts'><p>Age distribution of new reported infections for Greece</p></a></li>
<li><a href='#age_specific_mortality_counts'><p>Age distribution of new reported deaths for Greece</p></a></li>
<li><a href='#aggregate_age_distribution'><p>Aggregate the age distribution matrix</p></a></li>
<li><a href='#aggregate_contact_matrix'><p>Aggregate a contact matrix</p></a></li>
<li><a href='#aggregate_ifr_react'><p>Aggregate the Infection Fatality Ratio</p></a></li>
<li><a href='#Bernadette-package'><p>Bayesian inference and model selection for stochastic epidemics</p></a></li>
<li><a href='#contact_matrices'><p>Contact matrices per country</p></a></li>
<li><a href='#contact_matrix'><p>Country-specific contact matrix</p></a></li>
<li><a href='#countries_un'><p>Names of countries with an available age distribution</p></a></li>
<li><a href='#country_contact_matrices'><p>Names of countries for which a contact matrix is available</p></a></li>
<li><a href='#itd_distribution'><p>Distribution of the time between infection and death</p></a></li>
<li><a href='#plot_age_distribution'><p>Bar plot of the age distribution</p></a></li>
<li><a href='#plot_contact_matrix'><p>Contact matrix heatmap</p></a></li>
<li><a href='#plot_posterior_cm'><p>Plot the posterior contact matrix</p></a></li>
<li><a href='#plot_posterior_infections'><p>Plot the posterior distribution of the infection counts</p></a></li>
<li><a href='#plot_posterior_mortality'><p>Plot the posterior distribution of the mortality counts</p></a></li>
<li><a href='#plot_posterior_rt'><p>Plot the estimated effective reproduction number trajectory</p></a></li>
<li><a href='#plot_posterior_transmrate'><p>Plot the estimated age-specific transmission rate</p></a></li>
<li><a href='#posterior_infections'><p>Summarize the posterior distribution of the infection counts</p></a></li>
<li><a href='#posterior_mortality'><p>Summarize the posterior distribution of the mortality counts</p></a></li>
<li><a href='#posterior_rt'><p>Estimate the effective reproduction number with the next generation matrix approach</p></a></li>
<li><a href='#posterior_transmrate'><p>Estimate the age-specific transmission rate</p></a></li>
<li><a href='#priors'><p>Prior distributions and options</p></a></li>
<li><a href='#stan_igbm'><p>Bayesian diffusion-driven multi-type epidemic models via Stan</p></a></li>
<li><a href='#summary.stanigbm'><p>Summary of stanigbm posterior output</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Bayesian Inference and Model Selection for Stochastic Epidemics</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.5</td>
</tr>
<tr>
<td>Description:</td>
<td>Bayesian analysis for stochastic extensions of non-linear
    dynamic systems using advanced computational algorithms. Described in Bouranis, L., 
    Demiris, N., Kalogeropoulos, K., and Ntzoufras, I. (2022) &lt;<a href="https://arxiv.org/abs/2211.15229">arXiv:2211.15229</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://bernadette-eu.github.io/">https://bernadette-eu.github.io/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/bernadette-eu/Bernadette/issues/">https://github.com/bernadette-eu/Bernadette/issues/</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.2)</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2, grid, gridExtra, magrittr, methods, Rcpp (&ge;
1.0.8.3), RcppParallel, rstantools, rstan (&ge; 2.26.0), scales,
stats, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, roxygen2, StanHeaders (&ge; 2.26.0), testthat
(&ge; 3.0.0)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>BH (&ge; 1.78.0-0), Rcpp (&ge; 1.0.8.3), RcppEigen (&ge;
0.3.3.9.1), RcppParallel (&ge; 5.0.1), rstan (&ge; 2.26.0),
StanHeaders (&ge; 2.26.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Biarch:</td>
<td>true</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>LazyDataCompression:</td>
<td>xz</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>GNU make</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-12 22:15:07 UTC; lbour</td>
</tr>
<tr>
<td>Author:</td>
<td>Lampros Bouranis <a href="https://orcid.org/0000-0002-1291-2192"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre, cph],
  European Union [fnd] (Funding by the European Union's Horizon 2020
    research and innovation programme under the Marie Sklodowska-Curie
    grant agreement No 101027218)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Lampros Bouranis &lt;bernadette.aueb@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-12 22:30:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='age_distribution'>Country-specific age distribution</h2><span id='topic+age_distribution'></span>

<h3>Description</h3>

<p>Function to extract the age distribution of a country for a given year, broken
down by 5-year age bands and gender, following the United Nations 2019 Revision of
World Population Prospects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>age_distribution(country, year)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="age_distribution_+3A_country">country</code></td>
<td>
<p>character;
country identifier, following the List of United Nations Member States. See <a href="#topic+countries_un">countries_un</a>.</p>
</td></tr>
<tr><td><code id="age_distribution_+3A_year">year</code></td>
<td>
<p>numeric;
calendar year.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <em>data.frame</em> that contains the age distribution.
</p>


<h3>References</h3>

<p>United Nations, Department of Economic and Social Affairs, Population Division (2019). World Population Prospects 2019, Online Edition. Rev. 1.
</p>
<p>Prem, K., van Zandvoort, K., Klepac, P. et al (2017). Projecting contact matrices in 177 geographical regions: an update and comparison with empirical data for the COVID-19 era. medRxiv 2020.07.22.20159772; doi: https://doi.org/10.1101/2020.07.22.20159772
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Age distribution for Greece in 2020:
age_distr &lt;- age_distribution(country = "Greece", year = 2020)

</code></pre>

<hr>
<h2 id='age_specific_cusum_infection_counts'>Age distribution of cumulative reported infections for Greece</h2><span id='topic+age_specific_cusum_infection_counts'></span>

<h3>Description</h3>

<p>A dataset containing the age distribution of cumulative reported infections in Greece from 2020-08-31 to 2021-03-28 (30 weeks).
The dataset has been extracted from the Hellenic National Public Health Organization database.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(age_specific_cusum_infection_counts)
</code></pre>


<h3>Format</h3>

<p>A data frame with 210 rows and 5 variables:
</p>

<dl>
<dt>Date</dt><dd><p>Date, format; date in the format &quot;2020-08-31&quot;</p>
</dd>
<dt>Total_Cases</dt><dd><p>numeric; count of total cumulative reported infections on a given date</p>
</dd>
<dt>0-39</dt><dd><p>numeric; count of cumulative reported infections on a given date for the age group &quot;0-39&quot;</p>
</dd>
<dt>40-64</dt><dd><p>numeric; count of cumulative reported infections on a given date for the age group &quot;40-64&quot;</p>
</dd>
<dt>65+</dt><dd><p>numeric; count of cumulative reported infections on a given date for the age group &quot;65+&quot;</p>
</dd>
</dl>



<h3>Value</h3>

<p>A data.frame object with 210 rows and 5 variables.
</p>


<h3>References</h3>

<p>Sandbird (2022). Daily regional statistics for covid19 cases in Greece.
</p>


<h3>Source</h3>

<p><a href="https://github.com/Sandbird/covid19-Greece/">https://github.com/Sandbird/covid19-Greece/</a>
</p>

<hr>
<h2 id='age_specific_infection_counts'>Age distribution of new reported infections for Greece</h2><span id='topic+age_specific_infection_counts'></span>

<h3>Description</h3>

<p>A dataset containing the age distribution of new reported infections in Greece from 2020-08-31 to 2021-03-28 (30 weeks).
The dataset has been extracted from the Hellenic National Public Health Organization database.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(age_specific_infection_counts)
</code></pre>


<h3>Format</h3>

<p>A data frame with 210 rows and 8 variables:
</p>

<dl>
<dt>Index</dt><dd><p>integer; a sequence of integer numbers from 1 to 210</p>
</dd>
<dt>Right</dt><dd><p>numeric; Index + 1</p>
</dd>
<dt>Date</dt><dd><p>Date, format; date in the format &quot;2020-08-31&quot;</p>
</dd>
<dt>Week_ID</dt><dd><p>numeric; index of the week that each day falls into. A week is assumed to have 7 days</p>
</dd>
<dt>Total_Cases</dt><dd><p>numeric; count of total reported infections on a given date</p>
</dd>
<dt>0-39</dt><dd><p>numeric; count of reported infections on a given date for the age group &quot;0-39&quot;</p>
</dd>
<dt>40-64</dt><dd><p>numeric; count of reported infections on a given date for the age group &quot;40-64&quot;</p>
</dd>
<dt>65+</dt><dd><p>numeric; count of reported infections on a given date for the age group &quot;65+&quot;</p>
</dd>
</dl>



<h3>Value</h3>

<p>A data.frame object with 210 rows and 8 variables.
</p>


<h3>References</h3>

<p>Sandbird (2022). Daily regional statistics for covid19 cases in Greece.
</p>


<h3>Source</h3>

<p><a href="https://github.com/Sandbird/covid19-Greece/">https://github.com/Sandbird/covid19-Greece/</a>
</p>

<hr>
<h2 id='age_specific_mortality_counts'>Age distribution of new reported deaths for Greece</h2><span id='topic+age_specific_mortality_counts'></span>

<h3>Description</h3>

<p>A dataset containing the age distribution of reported deaths in Greece from 2020-08-31 to 2021-03-28 (30 weeks).
The dataset has been extracted from the Hellenic National Public Health Organization database.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(age_specific_mortality_counts)
</code></pre>


<h3>Format</h3>

<p>A data frame with 210 rows and 8 variables:
</p>

<dl>
<dt>Index</dt><dd><p>integer; a sequence of integer numbers from 1 to 210</p>
</dd>
<dt>Right</dt><dd><p>numeric; Index + 1</p>
</dd>
<dt>Date</dt><dd><p>Date, format; date in the format &quot;2020-08-31&quot;</p>
</dd>
<dt>Week_ID</dt><dd><p>numeric; index of the week that each day falls into. A week is assumed to have 7 days</p>
</dd>
<dt>New_Deaths</dt><dd><p>numeric; count of new total reported deaths on a given date</p>
</dd>
<dt>0-39</dt><dd><p>numeric; count of new reported deaths on a given date for the age group &quot;0-39&quot;</p>
</dd>
<dt>40-64</dt><dd><p>numeric; count of new reported deaths on a given date for the age group &quot;40-64&quot;</p>
</dd>
<dt>65+</dt><dd><p>numeric; count of new reported deaths on a given date for the age group &quot;65+&quot;</p>
</dd>
</dl>



<h3>Value</h3>

<p>A data.frame object with 210 rows and 8 variables.
</p>


<h3>References</h3>

<p>Sandbird (2022). Daily regional statistics for covid19 cases in Greece.
</p>


<h3>Source</h3>

<p><a href="https://github.com/Sandbird/covid19-Greece/">https://github.com/Sandbird/covid19-Greece/</a>
</p>

<hr>
<h2 id='aggregate_age_distribution'>Aggregate the age distribution matrix</h2><span id='topic+aggregate_age_distribution'></span>

<h3>Description</h3>

<p>Function to aggregate the age distribution according to user-defined age groups.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aggregate_age_distribution(x, lookup_table)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aggregate_age_distribution_+3A_x">x</code></td>
<td>
<p>data.frame;
an age distribution matrix. See <a href="#topic+age_distribution">age_distribution</a>.</p>
</td></tr>
<tr><td><code id="aggregate_age_distribution_+3A_lookup_table">lookup_table</code></td>
<td>
<p>data.frame;
a user-defined dataframe which maps the sixteen 5-year age bands to a new set of age bands.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <em>data.frame</em> that contains the aggregated age distribution.
</p>


<h3>References</h3>

<p>United Nations, Department of Economic and Social Affairs, Population Division (2019). World Population Prospects 2019, Online Edition. Rev. 1.
</p>
<p>Prem, K., van Zandvoort, K., Klepac, P. et al (2020). Projecting contact matrices in 177 geographical regions: an update and comparison with empirical data for the COVID-19 era. medRxiv 2020.07.22.20159772; doi: https://doi.org/10.1101/2020.07.22.20159772
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Import the age distribution for Greece in 2020:
age_distr &lt;- age_distribution(country = "Greece", year = 2020)

# Lookup table:
lookup_table &lt;- data.frame(Initial = age_distr$AgeGrp,
                           Mapping = c(rep("0-39",  8),
                                       rep("40-64", 5),
                                       rep("65+"  , 3)))

# Aggregate the age distribution table:
aggr_age &lt;- aggregate_age_distribution(age_distr, lookup_table)

# Plot the aggregated age distribution matrix:
plot_age_distribution(aggr_age)

</code></pre>

<hr>
<h2 id='aggregate_contact_matrix'>Aggregate a contact matrix</h2><span id='topic+aggregate_contact_matrix'></span>

<h3>Description</h3>

<p>Function to aggregate a contact matrix according to user-defined age groups.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aggregate_contact_matrix(object, lookup_table, age_distr)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aggregate_contact_matrix_+3A_object">object</code></td>
<td>
<p>data.frame;
a contact matrix. See <a href="#topic+contact_matrix">contact_matrix</a>.</p>
</td></tr>
<tr><td><code id="aggregate_contact_matrix_+3A_lookup_table">lookup_table</code></td>
<td>
<p>data.frame;
a user-defined data.frame which maps the sixteen 5-year age bands to a new set of age bands.</p>
</td></tr>
<tr><td><code id="aggregate_contact_matrix_+3A_age_distr">age_distr</code></td>
<td>
<p>data.frame;
the aggregated age distribution. See <a href="#topic+aggregate_contact_matrix">aggregate_contact_matrix</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <em>data.frame</em>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Import the age distribution for Greece in 2020:
age_distr &lt;- age_distribution(country = "Greece", year = 2020)

# Lookup table:
lookup_table &lt;- data.frame(Initial = age_distr$AgeGrp,
                           Mapping = c(rep("0-39",  8),
                                       rep("40-64", 5),
                                       rep("65+"  , 3)))

# Aggregate the age distribution table:
aggr_age &lt;- aggregate_age_distribution(age_distr, lookup_table)

# Import the projected contact matrix for Greece:
conmat &lt;- contact_matrix(country = "GRC")

# Aggregate the contact matrix:
aggr_cm &lt;- aggregate_contact_matrix(conmat, lookup_table, aggr_age)

# Plot the contact matrix:
plot_contact_matrix(aggr_cm)

</code></pre>

<hr>
<h2 id='aggregate_ifr_react'>Aggregate the Infection Fatality Ratio</h2><span id='topic+aggregate_ifr_react'></span>

<h3>Description</h3>

<p>Function to aggregate the age-specific Infection Fatality Ratio (IFR) estimates reported by the REACT-2 large-scale community study of SARS-CoV-2 seroprevalence in England according to user-defined age groups.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aggregate_ifr_react(x, user_AgeGrp, data_cases)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aggregate_ifr_react_+3A_x">x</code></td>
<td>
<p>data.frame;
an age distribution matrix. See <a href="#topic+age_distribution">age_distribution</a>.</p>
</td></tr>
<tr><td><code id="aggregate_ifr_react_+3A_user_agegrp">user_AgeGrp</code></td>
<td>
<p>vector;
a user-defined vector which maps the four age groups considered in REACT-2 to a new set of age groups.</p>
</td></tr>
<tr><td><code id="aggregate_ifr_react_+3A_data_cases">data_cases</code></td>
<td>
<p>data.frame;
time series dataset containing the age-stratified infection counts. See <a href="#topic+age_specific_infection_counts">age_specific_infection_counts</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of two data frames that contains the aggregated IFR estimates.
</p>


<h3>References</h3>

<p>Ward, H., Atchison, C., Whitaker, M. et al. (2021). SARS-CoV-2 antibody prevalence in England following the first peak of the pandemic. Nature Communications 12, 905
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Import the age distribution for Greece in 2020:
age_distr &lt;- age_distribution(country = "Greece", year = 2020)

age_mapping &lt;- c(rep("0-39",  8),
                 rep("40-64", 5),
                 rep("65+",   3))

data(age_specific_infection_counts)

# Aggregate the IFR:
aggr_age_ifr &lt;- aggregate_ifr_react(age_distr, age_mapping, age_specific_infection_counts)

</code></pre>

<hr>
<h2 id='Bernadette-package'>Bayesian inference and model selection for stochastic epidemics</h2><span id='topic+Bernadette-package'></span><span id='topic+Bernadette'></span>

<h3>Description</h3>

<p><code>Bernadette</code> provides Bayesian analysis for stochastic extensions of dynamic non-linear systems using advanced computational algorithms.
</p>


<h3>References</h3>

<p>Bouranis, L., Demiris, N. Kalogeropoulos, K. and Ntzoufras, I. (2022). Bayesian analysis of diffusion-driven multi-type epidemic models with application to COVID-19. arXiv: <a href="https://arxiv.org/abs/2211.15229">https://arxiv.org/abs/2211.15229</a>
</p>
<p>Stan Development Team (2020). RStan: the R interface to Stan. R package version 2.21.3. <a href="https://mc-stan.org">https://mc-stan.org</a>
</p>

<hr>
<h2 id='contact_matrices'>Contact matrices per country</h2><span id='topic+contact_matrices'></span>

<h3>Description</h3>

<p>A list of 16 by 16 contact matrices for 177 countries.
Row i of a column j of a contact matrix corresponds to the number of contacts
made by an individual in group i with an individual in group j.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(contact_matrices)
</code></pre>


<h3>Format</h3>

<p>A list of 16 by 16 dataframes for 177 countries.
</p>


<h3>Value</h3>

<p>A list object of 16 by 16 dataframes for 177 countries.
</p>


<h3>References</h3>

<p>Prem, K., van Zandvoort, K., Klepac, P. et al (2020). Projecting contact matrices in 177 geographical regions: an update and comparison with empirical data for the COVID-19 era. medRxiv 2020.07.22.20159772; doi: https://doi.org/10.1101/2020.07.22.20159772
</p>

<hr>
<h2 id='contact_matrix'>Country-specific contact matrix</h2><span id='topic+contact_matrix'></span>

<h3>Description</h3>

<p>A 16 by 16 contact matrix whose row i of a column j corresponds to the number of contacts
made by an individual in group i with an individual in group j.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>contact_matrix(country)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="contact_matrix_+3A_country">country</code></td>
<td>
<p>A character indicating the country identifier. See <a href="#topic+country_contact_matrices">country_contact_matrices</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &quot;data.frame&quot;.
</p>


<h3>References</h3>

<p>Prem, K., van Zandvoort, K., Klepac, P. et al (2020). Projecting contact matrices in 177 geographical regions: an update and comparison with empirical data for the COVID-19 era. medRxiv 2020.07.22.20159772; doi: https://doi.org/10.1101/2020.07.22.20159772
</p>


<h3>Examples</h3>

<pre><code class='language-R'>conmat &lt;- contact_matrix(country = "GRC")

</code></pre>

<hr>
<h2 id='countries_un'>Names of countries with an available age distribution</h2><span id='topic+countries_un'></span>

<h3>Description</h3>

<p>Function to extract the names of the countries whose discrete age distribution is
available by the United Nations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>countries_un()
</code></pre>


<h3>Value</h3>

<p>A character vector that contains the full names of 201 countries/areas.
</p>


<h3>References</h3>

<p>United Nations, Department of Economic and Social Affairs, Population Division (2019). World Population Prospects 2019, Online Edition. Rev. 1.
</p>
<p>Prem, K., van Zandvoort, K., Klepac, P. et al (2017). Projecting contact matrices in 177 geographical regions: an update and comparison with empirical data for the COVID-19 era. medRxiv 2020.07.22.20159772; doi: https://doi.org/10.1101/2020.07.22.20159772
</p>


<h3>Examples</h3>

<pre><code class='language-R'>countries_un()

</code></pre>

<hr>
<h2 id='country_contact_matrices'>Names of countries for which a contact matrix is available</h2><span id='topic+country_contact_matrices'></span>

<h3>Description</h3>

<p>Function to extract the names of the countries whose projected contact matrix is available.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>country_contact_matrices()
</code></pre>


<h3>Value</h3>

<p>A character vector of length 177 with the IDs of each of the 177 geographical regions.
</p>


<h3>References</h3>

<p>Prem, K., van Zandvoort, K., Klepac, P. et al (2017). Projecting contact matrices in 177 geographical regions: an update and comparison with empirical data for the COVID-19 era. medRxiv 2020.07.22.20159772; doi: https://doi.org/10.1101/2020.07.22.20159772
</p>


<h3>Examples</h3>

<pre><code class='language-R'>country_contact_matrices()

</code></pre>

<hr>
<h2 id='itd_distribution'>Distribution of the time between infection and death</h2><span id='topic+itd_distribution'></span>

<h3>Description</h3>

<p>Function to discretize the infection-to-death distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>itd_distribution(
  ts_length,
  gamma_mean = 24.19231,
  gamma_cv = 0.3987261,
  gamma_shape = 6.29,
  gamma_rate = 0.26
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="itd_distribution_+3A_ts_length">ts_length</code></td>
<td>
<p>integer;
time from infection to death in days.</p>
</td></tr>
<tr><td><code id="itd_distribution_+3A_gamma_mean">gamma_mean</code></td>
<td>
<p>numeric;
mean of a gamma distribution, for a given shape and rate. See also <code><a href="stats.html#topic+GammaDist">GammaDist</a></code>.</p>
</td></tr>
<tr><td><code id="itd_distribution_+3A_gamma_cv">gamma_cv</code></td>
<td>
<p>numeric;
coefficient of variation of a gamma distribution, for a given shape and rate. See also <code><a href="stats.html#topic+GammaDist">GammaDist</a></code>.</p>
</td></tr>
<tr><td><code id="itd_distribution_+3A_gamma_shape">gamma_shape</code></td>
<td>
<p>numeric;
shape parameter of a gamma distribution. See also <code><a href="stats.html#topic+GammaDist">GammaDist</a></code>.</p>
</td></tr>
<tr><td><code id="itd_distribution_+3A_gamma_rate">gamma_rate</code></td>
<td>
<p>numeric;
rate parameter of a gamma distribution. See also <code><a href="stats.html#topic+GammaDist">GammaDist</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of length <em>ts_length</em>.
</p>


<h3>References</h3>

<p>Flaxman et al (2020). Estimating the effects of non-pharmaceutical interventions on COVID-19 in Europe.
Nature, 584, 257-261.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Age-specific mortality/incidence count time series:
data(age_specific_mortality_counts)

# Infection-to-death distribution:
ditd &lt;- itd_distribution(ts_length  = nrow(age_specific_mortality_counts),
                         gamma_mean = 24.19231,
                         gamma_cv   = 0.3987261)

</code></pre>

<hr>
<h2 id='plot_age_distribution'>Bar plot of the age distribution</h2><span id='topic+plot_age_distribution'></span>

<h3>Description</h3>

<p>Bar plot of the age distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_age_distribution(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_age_distribution_+3A_x">x</code></td>
<td>
<p>data.frame;
the age distribution matrix. See <a href="#topic+age_distribution">age_distribution</a> and <a href="#topic+aggregate_age_distribution">aggregate_age_distribution</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot object that can be further customized using the
<span class="pkg">ggplot2</span> package.
</p>


<h3>References</h3>

<p>United Nations, Department of Economic and Social Affairs, Population Division (2019). World Population Prospects 2019, Online Edition. Rev. 1.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Import the age distribution for Greece in 2020:
age_distr &lt;- age_distribution(country = "Greece", year = 2020)

plot_age_distribution(age_distr)

# Lookup table:
lookup_table &lt;- data.frame(Initial = age_distr$AgeGrp,
                           Mapping = c(rep("0-39",  8),
                                       rep("40-64", 5),
                                       rep("65+"  , 3)))

# Aggregate the age distribution table:
aggr_age &lt;- aggregate_age_distribution(age_distr, lookup_table)

# Plot the aggregated age distribution matrix:
plot_age_distribution(aggr_age)

</code></pre>

<hr>
<h2 id='plot_contact_matrix'>Contact matrix heatmap</h2><span id='topic+plot_contact_matrix'></span>

<h3>Description</h3>

<p>Contact matrix heatmap
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_contact_matrix(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_contact_matrix_+3A_x">x</code></td>
<td>
<p>data.frame;
a contact matrix.  See <a href="#topic+contact_matrix">contact_matrix</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot object that can be further customized using the
<span class="pkg">ggplot2</span> package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Import the projected contact matrix for Greece:
conmat &lt;- contact_matrix(country = "GRC")

plot_contact_matrix(conmat)

</code></pre>

<hr>
<h2 id='plot_posterior_cm'>Plot the posterior contact matrix</h2><span id='topic+plot_posterior_cm'></span>

<h3>Description</h3>

<p>Plot the posterior contact matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_posterior_cm(object, y_data, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_posterior_cm_+3A_object">object</code></td>
<td>
<p>An object of class <code>stanigbm</code>. See <code><a href="#topic+stan_igbm">stan_igbm</a></code>.</p>
</td></tr>
<tr><td><code id="plot_posterior_cm_+3A_y_data">y_data</code></td>
<td>
<p>data.frame;
age-specific mortality counts in time. See <code>data(age_specific_mortality_counts)</code>.</p>
</td></tr>
<tr><td><code id="plot_posterior_cm_+3A_...">...</code></td>
<td>
<p>Optional arguments passed to <code><a href="ggplot2.html#topic+theme">theme</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>grid.arrange</code> object which can be further customised using the <span class="pkg">gridExtra</span> package.
</p>


<h3>References</h3>

<p>Bouranis, L., Demiris, N. Kalogeropoulos, K. and Ntzoufras, I. (2022). Bayesian analysis of diffusion-driven multi-type epidemic models with application to COVID-19. arXiv: <a href="https://arxiv.org/abs/2211.15229">https://arxiv.org/abs/2211.15229</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Age-specific mortality/incidence count time series:
data(age_specific_mortality_counts)
data(age_specific_cusum_infection_counts)

# Import the age distribution for Greece in 2020:
age_distr &lt;- age_distribution(country = "Greece", year = 2020)

# Lookup table:
lookup_table &lt;- data.frame(Initial = age_distr$AgeGrp,
                          Mapping = c(rep("0-39",  8),
                                      rep("40-64", 5),
                                      rep("65+"  , 3)))

# Aggregate the age distribution table:
aggr_age &lt;- aggregate_age_distribution(age_distr, lookup_table)

# Import the projected contact matrix for Greece:
conmat &lt;- contact_matrix(country = "GRC")

# Aggregate the contact matrix:
aggr_cm &lt;- aggregate_contact_matrix(conmat, lookup_table, aggr_age)

# Aggregate the IFR:
ifr_mapping &lt;- c(rep("0-39", 8), rep("40-64", 5), rep("65+", 3))

aggr_age_ifr &lt;- aggregate_ifr_react(age_distr, ifr_mapping, age_specific_cusum_infection_counts)

# Infection-to-death distribution:
ditd &lt;- itd_distribution(ts_length  = nrow(age_specific_mortality_counts),
                         gamma_mean = 24.19231,
                         gamma_cv   = 0.3987261)

# Posterior sampling:

rstan::rstan_options(auto_write = TRUE)
chains &lt;- 1
options(mc.cores = chains)

igbm_fit &lt;- stan_igbm(y_data                      = age_specific_mortality_counts,
                      contact_matrix              = aggr_cm,
                      age_distribution_population = aggr_age,
                      age_specific_ifr            = aggr_age_ifr[[3]],
                      itd_distr                   = ditd,
                      incubation_period           = 3,
                      infectious_period           = 4,
                      likelihood_variance_type    = "linear",
                      ecr_changes                 = 7,
                      prior_scale_x0              = 1,
                      prior_scale_x1              = 1,
                      prior_scale_contactmatrix   = 0.05,
                      pi_perc                     = 0.1,
                      prior_volatility            = normal(location = 0, scale = 1),
                      prior_nb_dispersion         = exponential(rate = 1/5),
                      algorithm_inference         = "sampling",
                      nBurn                       = 10,
                      nPost                       = 30,
                      nThin                       = 1,
                      chains                      = chains,
                      adapt_delta                 = 0.6,
                      max_treedepth               = 14,
                      seed                        = 1)

# Visualise the posterior distribution of the random contact matrix:
plot_posterior_cm(object = igbm_fit,
                  y_data = age_specific_mortality_counts)

</code></pre>

<hr>
<h2 id='plot_posterior_infections'>Plot the posterior distribution of the infection counts</h2><span id='topic+plot_posterior_infections'></span>

<h3>Description</h3>

<p>Plot the posterior distribution of the infection counts
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_posterior_infections(
  object,
  type = c("age-specific", "aggregated"),
  xlab = NULL,
  ylab = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_posterior_infections_+3A_object">object</code></td>
<td>
<p>A dataframe from <code><a href="#topic+posterior_infections">posterior_infections</a></code>.</p>
</td></tr>
<tr><td><code id="plot_posterior_infections_+3A_type">type</code></td>
<td>
<p>character;
Plot the output for the 'age-specific' infection counts or the 'aggregated' infections.</p>
</td></tr>
<tr><td><code id="plot_posterior_infections_+3A_xlab">xlab</code></td>
<td>
<p>character;
title of x-axis.</p>
</td></tr>
<tr><td><code id="plot_posterior_infections_+3A_ylab">ylab</code></td>
<td>
<p>character;
title of y-axis.</p>
</td></tr>
<tr><td><code id="plot_posterior_infections_+3A_...">...</code></td>
<td>
<p>Optional arguments passed to <code><a href="ggplot2.html#topic+scale_x_date">scale_x_date</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>ggplot</code> object which can be further customised using the <span class="pkg">ggplot2</span> package.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+posterior_infections">posterior_infections</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Age-specific mortality/incidence count time series:
data(age_specific_mortality_counts)
data(age_specific_cusum_infection_counts)

# Import the age distribution for Greece in 2020:
age_distr &lt;- age_distribution(country = "Greece", year = 2020)

# Lookup table:
lookup_table &lt;- data.frame(Initial = age_distr$AgeGrp,
                          Mapping = c(rep("0-39",  8),
                                      rep("40-64", 5),
                                      rep("65+"  , 3)))

# Aggregate the age distribution table:
aggr_age &lt;- aggregate_age_distribution(age_distr, lookup_table)

# Import the projected contact matrix for Greece:
conmat &lt;- contact_matrix(country = "GRC")

# Aggregate the contact matrix:
aggr_cm &lt;- aggregate_contact_matrix(conmat, lookup_table, aggr_age)

# Aggregate the IFR:
ifr_mapping &lt;- c(rep("0-39", 8), rep("40-64", 5), rep("65+", 3))

aggr_age_ifr &lt;- aggregate_ifr_react(age_distr, ifr_mapping, age_specific_cusum_infection_counts)

# Infection-to-death distribution:
ditd &lt;- itd_distribution(ts_length  = nrow(age_specific_mortality_counts),
                         gamma_mean = 24.19231,
                         gamma_cv   = 0.3987261)

# Posterior sampling:

rstan::rstan_options(auto_write = TRUE)
chains &lt;- 1
options(mc.cores = chains)

igbm_fit &lt;- stan_igbm(y_data                      = age_specific_mortality_counts,
                      contact_matrix              = aggr_cm,
                      age_distribution_population = aggr_age,
                      age_specific_ifr            = aggr_age_ifr[[3]],
                      itd_distr                   = ditd,
                      incubation_period           = 3,
                      infectious_period           = 4,
                      likelihood_variance_type    = "linear",
                      ecr_changes                 = 7,
                      prior_scale_x0              = 1,
                      prior_scale_x1              = 1,
                      prior_scale_contactmatrix   = 0.05,
                      pi_perc                     = 0.1,
                      prior_volatility            = normal(location = 0, scale = 1),
                      prior_nb_dispersion         = exponential(rate = 1/5),
                      algorithm_inference         = "sampling",
                      nBurn                       = 10,
                      nPost                       = 30,
                      nThin                       = 1,
                      chains                      = chains,
                      adapt_delta                 = 0.6,
                      max_treedepth               = 14,
                      seed                        = 1)

post_inf_summary &lt;- posterior_infections(object = igbm_fit,
                                         y_data = age_specific_mortality_counts)

# Visualise the posterior distribution of the infection counts:
plot_posterior_infections(post_inf_summary, type = "age-specific")
plot_posterior_infections(post_inf_summary, type = "aggregated")

</code></pre>

<hr>
<h2 id='plot_posterior_mortality'>Plot the posterior distribution of the mortality counts</h2><span id='topic+plot_posterior_mortality'></span>

<h3>Description</h3>

<p>Plot the posterior distribution of the mortality counts
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_posterior_mortality(
  object,
  type = c("age-specific", "aggregated"),
  xlab = NULL,
  ylab = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_posterior_mortality_+3A_object">object</code></td>
<td>
<p>A dataframe from <code><a href="#topic+posterior_mortality">posterior_mortality</a></code>.</p>
</td></tr>
<tr><td><code id="plot_posterior_mortality_+3A_type">type</code></td>
<td>
<p>character;
Plot the output for the 'age-specific' mortality counts or the 'aggregated' mortality counts.</p>
</td></tr>
<tr><td><code id="plot_posterior_mortality_+3A_xlab">xlab</code></td>
<td>
<p>character;
title of x-axis.</p>
</td></tr>
<tr><td><code id="plot_posterior_mortality_+3A_ylab">ylab</code></td>
<td>
<p>character;
title of y-axis.</p>
</td></tr>
<tr><td><code id="plot_posterior_mortality_+3A_...">...</code></td>
<td>
<p>Optional arguments passed to <code><a href="ggplot2.html#topic+scale_x_date">scale_x_date</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>ggplot</code> object which can be further customised using the <span class="pkg">ggplot2</span> package.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+posterior_mortality">posterior_mortality</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Age-specific mortality/incidence count time series:
data(age_specific_mortality_counts)
data(age_specific_cusum_infection_counts)

# Import the age distribution for Greece in 2020:
age_distr &lt;- age_distribution(country = "Greece", year = 2020)

# Lookup table:
lookup_table &lt;- data.frame(Initial = age_distr$AgeGrp,
                          Mapping = c(rep("0-39",  8),
                                      rep("40-64", 5),
                                      rep("65+"  , 3)))

# Aggregate the age distribution table:
aggr_age &lt;- aggregate_age_distribution(age_distr, lookup_table)

# Import the projected contact matrix for Greece:
conmat &lt;- contact_matrix(country = "GRC")

# Aggregate the contact matrix:
aggr_cm &lt;- aggregate_contact_matrix(conmat, lookup_table, aggr_age)

# Aggregate the IFR:
ifr_mapping &lt;- c(rep("0-39", 8), rep("40-64", 5), rep("65+", 3))

aggr_age_ifr &lt;- aggregate_ifr_react(age_distr, ifr_mapping, age_specific_cusum_infection_counts)

# Infection-to-death distribution:
ditd &lt;- itd_distribution(ts_length  = nrow(age_specific_mortality_counts),
                         gamma_mean = 24.19231,
                         gamma_cv   = 0.3987261)

# Posterior sampling:

rstan::rstan_options(auto_write = TRUE)
chains &lt;- 1
options(mc.cores = chains)

igbm_fit &lt;- stan_igbm(y_data                      = age_specific_mortality_counts,
                      contact_matrix              = aggr_cm,
                      age_distribution_population = aggr_age,
                      age_specific_ifr            = aggr_age_ifr[[3]],
                      itd_distr                   = ditd,
                      incubation_period           = 3,
                      infectious_period           = 4,
                      likelihood_variance_type    = "linear",
                      ecr_changes                 = 7,
                      prior_scale_x0              = 1,
                      prior_scale_x1              = 1,
                      prior_scale_contactmatrix   = 0.05,
                      pi_perc                     = 0.1,
                      prior_volatility            = normal(location = 0, scale = 1),
                      prior_nb_dispersion         = exponential(rate = 1/5),
                      algorithm_inference         = "sampling",
                      nBurn                       = 10,
                      nPost                       = 30,
                      nThin                       = 1,
                      chains                      = chains,
                      adapt_delta                 = 0.6,
                      max_treedepth               = 14,
                      seed                        = 1)

post_mortality_summary &lt;- posterior_mortality(object = igbm_fit,
                                              y_data = age_specific_mortality_counts)

# Visualise the posterior distribution of the mortality counts:
plot_posterior_mortality(post_mortality_summary, type = "age-specific")
plot_posterior_mortality(post_mortality_summary, type = "aggregated")

</code></pre>

<hr>
<h2 id='plot_posterior_rt'>Plot the estimated effective reproduction number trajectory</h2><span id='topic+plot_posterior_rt'></span>

<h3>Description</h3>

<p>Plot the estimated effective reproduction number trajectory
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_posterior_rt(object, xlab = NULL, ylab = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_posterior_rt_+3A_object">object</code></td>
<td>
<p>A data frame from <code><a href="#topic+posterior_rt">posterior_rt</a></code>.</p>
</td></tr>
<tr><td><code id="plot_posterior_rt_+3A_xlab">xlab</code></td>
<td>
<p>character;
Title of x-axis.</p>
</td></tr>
<tr><td><code id="plot_posterior_rt_+3A_ylab">ylab</code></td>
<td>
<p>character;
Title of y-axis.</p>
</td></tr>
<tr><td><code id="plot_posterior_rt_+3A_...">...</code></td>
<td>
<p>Optional arguments passed to <code><a href="ggplot2.html#topic+scale_x_date">scale_x_date</a></code> and <code><a href="ggplot2.html#topic+theme">theme</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>ggplot</code> object which can be further customised using the <span class="pkg">ggplot2</span> package.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+posterior_rt">posterior_rt</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Age-specific mortality/incidence count time series:
data(age_specific_mortality_counts)
data(age_specific_cusum_infection_counts)

# Import the age distribution for Greece in 2020:
age_distr &lt;- age_distribution(country = "Greece", year = 2020)

# Lookup table:
lookup_table &lt;- data.frame(Initial = age_distr$AgeGrp,
                          Mapping = c(rep("0-39",  8),
                                      rep("40-64", 5),
                                      rep("65+"  , 3)))

# Aggregate the age distribution table:
aggr_age &lt;- aggregate_age_distribution(age_distr, lookup_table)

# Import the projected contact matrix for Greece:
conmat &lt;- contact_matrix(country = "GRC")

# Aggregate the contact matrix:
aggr_cm &lt;- aggregate_contact_matrix(conmat, lookup_table, aggr_age)

# Aggregate the IFR:
ifr_mapping &lt;- c(rep("0-39", 8), rep("40-64", 5), rep("65+", 3))

aggr_age_ifr &lt;- aggregate_ifr_react(age_distr, ifr_mapping, age_specific_cusum_infection_counts)

# Infection-to-death distribution:
ditd &lt;- itd_distribution(ts_length  = nrow(age_specific_mortality_counts),
                         gamma_mean = 24.19231,
                         gamma_cv   = 0.3987261)

# Posterior sampling:

rstan::rstan_options(auto_write = TRUE)
chains &lt;- 1
options(mc.cores = chains)

igbm_fit &lt;- stan_igbm(y_data                      = age_specific_mortality_counts,
                      contact_matrix              = aggr_cm,
                      age_distribution_population = aggr_age,
                      age_specific_ifr            = aggr_age_ifr[[3]],
                      itd_distr                   = ditd,
                      incubation_period           = 3,
                      infectious_period           = 4,
                      likelihood_variance_type    = "linear",
                      ecr_changes                 = 7,
                      prior_scale_x0              = 1,
                      prior_scale_x1              = 1,
                      prior_scale_contactmatrix   = 0.05,
                      pi_perc                     = 0.1,
                      prior_volatility            = normal(location = 0, scale = 1),
                      prior_nb_dispersion         = exponential(rate = 1/5),
                      algorithm_inference         = "sampling",
                      nBurn                       = 10,
                      nPost                       = 30,
                      nThin                       = 1,
                      chains                      = chains,
                      adapt_delta                 = 0.6,
                      max_treedepth               = 14,
                      seed                        = 1)

post_rt_summary &lt;- posterior_rt(object                      = igbm_fit,
                                y_data                      = age_specific_mortality_counts,
                                age_distribution_population = aggr_age,
                                infectious_period            = 4)

# Visualise the posterior distribution of the effective reproduction number:
plot_posterior_rt(post_rt_summary)

</code></pre>

<hr>
<h2 id='plot_posterior_transmrate'>Plot the estimated age-specific transmission rate</h2><span id='topic+plot_posterior_transmrate'></span>

<h3>Description</h3>

<p>Plot the estimated age-specific transmission rate
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_posterior_transmrate(object, xlab = NULL, ylab = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_posterior_transmrate_+3A_object">object</code></td>
<td>
<p>A dataframe from <code><a href="#topic+posterior_transmrate">posterior_transmrate</a></code>.</p>
</td></tr>
<tr><td><code id="plot_posterior_transmrate_+3A_xlab">xlab</code></td>
<td>
<p>character; Title of x-axis.</p>
</td></tr>
<tr><td><code id="plot_posterior_transmrate_+3A_ylab">ylab</code></td>
<td>
<p>character; Title of y-axis.</p>
</td></tr>
<tr><td><code id="plot_posterior_transmrate_+3A_...">...</code></td>
<td>
<p>Optional arguments passed to <code><a href="ggplot2.html#topic+scale_x_date">scale_x_date</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>ggplot</code> object which can be further customised using the <span class="pkg">ggplot2</span> package.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+posterior_transmrate">posterior_transmrate</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Age-specific mortality/incidence count time series:
data(age_specific_mortality_counts)
data(age_specific_cusum_infection_counts)

# Import the age distribution for Greece in 2020:
age_distr &lt;- age_distribution(country = "Greece", year = 2020)

# Lookup table:
lookup_table &lt;- data.frame(Initial = age_distr$AgeGrp,
                          Mapping = c(rep("0-39",  8),
                                      rep("40-64", 5),
                                      rep("65+"  , 3)))

# Aggregate the age distribution table:
aggr_age &lt;- aggregate_age_distribution(age_distr, lookup_table)

# Import the projected contact matrix for Greece:
conmat &lt;- contact_matrix(country = "GRC")

# Aggregate the contact matrix:
aggr_cm &lt;- aggregate_contact_matrix(conmat, lookup_table, aggr_age)

# Aggregate the IFR:
ifr_mapping &lt;- c(rep("0-39", 8), rep("40-64", 5), rep("65+", 3))

aggr_age_ifr &lt;- aggregate_ifr_react(age_distr, ifr_mapping, age_specific_cusum_infection_counts)

# Infection-to-death distribution:
ditd &lt;- itd_distribution(ts_length  = nrow(age_specific_mortality_counts),
                         gamma_mean = 24.19231,
                         gamma_cv   = 0.3987261)

# Posterior sampling:

rstan::rstan_options(auto_write = TRUE)
chains &lt;- 1
options(mc.cores = chains)

igbm_fit &lt;- stan_igbm(y_data                      = age_specific_mortality_counts,
                      contact_matrix              = aggr_cm,
                      age_distribution_population = aggr_age,
                      age_specific_ifr            = aggr_age_ifr[[3]],
                      itd_distr                   = ditd,
                      incubation_period           = 3,
                      infectious_period           = 4,
                      likelihood_variance_type    = "linear",
                      ecr_changes                 = 7,
                      prior_scale_x0              = 1,
                      prior_scale_x1              = 1,
                      prior_scale_contactmatrix   = 0.05,
                      pi_perc                     = 0.1,
                      prior_volatility            = normal(location = 0, scale = 1),
                      prior_nb_dispersion         = exponential(rate = 1/5),
                      algorithm_inference         = "sampling",
                      nBurn                       = 10,
                      nPost                       = 30,
                      nThin                       = 1,
                      chains                      = chains,
                      adapt_delta                 = 0.6,
                      max_treedepth               = 14,
                      seed                        = 1)

post_transmrate_summary &lt;- posterior_transmrate(object = igbm_fit,
                                                y_data = age_specific_mortality_counts)

# Visualise the posterior distribution of the age-specific transmission rate:
plot_posterior_transmrate(post_transmrate_summary)

</code></pre>

<hr>
<h2 id='posterior_infections'>Summarize the posterior distribution of the infection counts</h2><span id='topic+posterior_infections'></span>

<h3>Description</h3>

<p>Summarize the posterior distribution of the infection counts
</p>


<h3>Usage</h3>

<pre><code class='language-R'>posterior_infections(object, y_data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="posterior_infections_+3A_object">object</code></td>
<td>
<p>An object of class <code>stanigbm</code>. See <code><a href="#topic+stan_igbm">stan_igbm</a></code>.</p>
</td></tr>
<tr><td><code id="posterior_infections_+3A_y_data">y_data</code></td>
<td>
<p>data.frame;
age-specific mortality counts in time. See <code>data(age_specific_mortality_counts)</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named list with elements <code>Age_specific</code> and <code>Aggregated</code> which can be visualized using <code><a href="#topic+plot_posterior_infections">plot_posterior_infections</a></code>.
</p>


<h3>References</h3>

<p>Bouranis, L., Demiris, N. Kalogeropoulos, K. and Ntzoufras, I. (2022). Bayesian analysis of diffusion-driven multi-type epidemic models with application to COVID-19. arXiv: <a href="https://arxiv.org/abs/2211.15229">https://arxiv.org/abs/2211.15229</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Age-specific mortality/incidence count time series:
data(age_specific_mortality_counts)
data(age_specific_cusum_infection_counts)

# Import the age distribution for Greece in 2020:
age_distr &lt;- age_distribution(country = "Greece", year = 2020)

# Lookup table:
lookup_table &lt;- data.frame(Initial = age_distr$AgeGrp,
                          Mapping = c(rep("0-39",  8),
                                      rep("40-64", 5),
                                      rep("65+"  , 3)))

# Aggregate the age distribution table:
aggr_age &lt;- aggregate_age_distribution(age_distr, lookup_table)

# Import the projected contact matrix for Greece:
conmat &lt;- contact_matrix(country = "GRC")

# Aggregate the contact matrix:
aggr_cm &lt;- aggregate_contact_matrix(conmat, lookup_table, aggr_age)

# Aggregate the IFR:
ifr_mapping &lt;- c(rep("0-39", 8), rep("40-64", 5), rep("65+", 3))

aggr_age_ifr &lt;- aggregate_ifr_react(age_distr, ifr_mapping, age_specific_cusum_infection_counts)

# Infection-to-death distribution:
ditd &lt;- itd_distribution(ts_length  = nrow(age_specific_mortality_counts),
                         gamma_mean = 24.19231,
                         gamma_cv   = 0.3987261)

# Posterior sampling:

rstan::rstan_options(auto_write = TRUE)
chains &lt;- 1
options(mc.cores = chains)

igbm_fit &lt;- stan_igbm(y_data                      = age_specific_mortality_counts,
                      contact_matrix              = aggr_cm,
                      age_distribution_population = aggr_age,
                      age_specific_ifr            = aggr_age_ifr[[3]],
                      itd_distr                   = ditd,
                      incubation_period           = 3,
                      infectious_period           = 4,
                      likelihood_variance_type    = "linear",
                      ecr_changes                 = 7,
                      prior_scale_x0              = 1,
                      prior_scale_x1              = 1,
                      prior_scale_contactmatrix   = 0.05,
                      pi_perc                     = 0.1,
                      prior_volatility            = normal(location = 0, scale = 1),
                      prior_nb_dispersion         = exponential(rate = 1/5),
                      algorithm_inference         = "sampling",
                      nBurn                       = 10,
                      nPost                       = 30,
                      nThin                       = 1,
                      chains                      = chains,
                      adapt_delta                 = 0.6,
                      max_treedepth               = 14,
                      seed                        = 1)

post_inf_summary &lt;- posterior_infections(object = igbm_fit,
                                         y_data = age_specific_mortality_counts)

# Visualise the posterior distribution of the infection counts:
plot_posterior_infections(post_inf_summary, type = "age-specific")
plot_posterior_infections(post_inf_summary, type = "aggregated")

</code></pre>

<hr>
<h2 id='posterior_mortality'>Summarize the posterior distribution of the mortality counts</h2><span id='topic+posterior_mortality'></span>

<h3>Description</h3>

<p>Summarize the posterior distribution of the mortality counts
</p>


<h3>Usage</h3>

<pre><code class='language-R'>posterior_mortality(object, y_data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="posterior_mortality_+3A_object">object</code></td>
<td>
<p>An object of class <code>stanigbm</code>. See <code><a href="#topic+stan_igbm">stan_igbm</a></code>.</p>
</td></tr>
<tr><td><code id="posterior_mortality_+3A_y_data">y_data</code></td>
<td>
<p>data.frame;
age-specific mortality counts in time. See <code>data(age_specific_mortality_counts)</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>#' A named list with elements <code>Age_specific</code> and <code>Aggregated</code> which can be visualised using <code><a href="#topic+plot_posterior_mortality">plot_posterior_mortality</a></code>.
</p>


<h3>References</h3>

<p>Bouranis, L., Demiris, N. Kalogeropoulos, K. and Ntzoufras, I. (2022). Bayesian analysis of diffusion-driven multi-type epidemic models with application to COVID-19. arXiv: <a href="https://arxiv.org/abs/2211.15229">https://arxiv.org/abs/2211.15229</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Age-specific mortality/incidence count time series:
data(age_specific_mortality_counts)
data(age_specific_cusum_infection_counts)

# Import the age distribution for Greece in 2020:
age_distr &lt;- age_distribution(country = "Greece", year = 2020)

# Lookup table:
lookup_table &lt;- data.frame(Initial = age_distr$AgeGrp,
                          Mapping = c(rep("0-39",  8),
                                      rep("40-64", 5),
                                      rep("65+"  , 3)))

# Aggregate the age distribution table:
aggr_age &lt;- aggregate_age_distribution(age_distr, lookup_table)

# Import the projected contact matrix for Greece:
conmat &lt;- contact_matrix(country = "GRC")

# Aggregate the contact matrix:
aggr_cm &lt;- aggregate_contact_matrix(conmat, lookup_table, aggr_age)

# Aggregate the IFR:
ifr_mapping &lt;- c(rep("0-39", 8), rep("40-64", 5), rep("65+", 3))

aggr_age_ifr &lt;- aggregate_ifr_react(age_distr, ifr_mapping, age_specific_cusum_infection_counts)

# Infection-to-death distribution:
ditd &lt;- itd_distribution(ts_length  = nrow(age_specific_mortality_counts),
                         gamma_mean = 24.19231,
                         gamma_cv   = 0.3987261)

# Posterior sampling:

rstan::rstan_options(auto_write = TRUE)
chains &lt;- 1
options(mc.cores = chains)

igbm_fit &lt;- stan_igbm(y_data                      = age_specific_mortality_counts,
                      contact_matrix              = aggr_cm,
                      age_distribution_population = aggr_age,
                      age_specific_ifr            = aggr_age_ifr[[3]],
                      itd_distr                   = ditd,
                      incubation_period           = 3,
                      infectious_period           = 4,
                      likelihood_variance_type    = "linear",
                      ecr_changes                 = 7,
                      prior_scale_x0              = 1,
                      prior_scale_x1              = 1,
                      prior_scale_contactmatrix   = 0.05,
                      pi_perc                     = 0.1,
                      prior_volatility            = normal(location = 0, scale = 1),
                      prior_nb_dispersion         = exponential(rate = 1/5),
                      algorithm_inference         = "sampling",
                      nBurn                       = 10,
                      nPost                       = 30,
                      nThin                       = 1,
                      chains                      = chains,
                      adapt_delta                 = 0.6,
                      max_treedepth               = 14,
                      seed                        = 1)

post_mortality_summary &lt;- posterior_mortality(object = igbm_fit,
                                              y_data = age_specific_mortality_counts)

# Visualise the posterior distribution of the mortality counts:
plot_posterior_mortality(post_mortality_summary, type = "age-specific")
plot_posterior_mortality(post_mortality_summary, type = "aggregated")

</code></pre>

<hr>
<h2 id='posterior_rt'>Estimate the effective reproduction number with the next generation matrix approach</h2><span id='topic+posterior_rt'></span>

<h3>Description</h3>

<p>Estimate the effective reproduction number with the next generation matrix approach
</p>


<h3>Usage</h3>

<pre><code class='language-R'>posterior_rt(object, y_data, age_distribution_population, infectious_period)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="posterior_rt_+3A_object">object</code></td>
<td>
<p>An object of class <code>stanigbm</code>. See <code><a href="#topic+stan_igbm">stan_igbm</a></code>.</p>
</td></tr>
<tr><td><code id="posterior_rt_+3A_y_data">y_data</code></td>
<td>
<p>data.frame;
age-specific mortality counts in time. See <code>data(age_specific_mortality_counts)</code>.</p>
</td></tr>
<tr><td><code id="posterior_rt_+3A_age_distribution_population">age_distribution_population</code></td>
<td>
<p>data.frame;
the age distribution of a given population. See <code>aggregate_age_distribution</code>.</p>
</td></tr>
<tr><td><code id="posterior_rt_+3A_infectious_period">infectious_period</code></td>
<td>
<p>integer;
length of infectious period in days. Must be &gt;=1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame which can be visualised using <code><a href="#topic+plot_posterior_rt">plot_posterior_rt</a></code>.
</p>


<h3>References</h3>

<p>Diekmann, O., Heesterbeek, J., and Roberts, M. (2010). The construction of next-generation matrices for compartmental epidemic models. <em>J. R. Soc. Interface</em>, 7, 873-885.
</p>
<p>Bouranis, L., Demiris, N. Kalogeropoulos, K. and Ntzoufras, I. (2022). Bayesian analysis of diffusion-driven multi-type epidemic models with application to COVID-19. arXiv: <a href="https://arxiv.org/abs/2211.15229">https://arxiv.org/abs/2211.15229</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Age-specific mortality/incidence count time series:
data(age_specific_mortality_counts)
data(age_specific_cusum_infection_counts)

# Import the age distribution for Greece in 2020:
age_distr &lt;- age_distribution(country = "Greece", year = 2020)

# Lookup table:
lookup_table &lt;- data.frame(Initial = age_distr$AgeGrp,
                          Mapping = c(rep("0-39",  8),
                                      rep("40-64", 5),
                                      rep("65+"  , 3)))

# Aggregate the age distribution table:
aggr_age &lt;- aggregate_age_distribution(age_distr, lookup_table)

# Import the projected contact matrix for Greece:
conmat &lt;- contact_matrix(country = "GRC")

# Aggregate the contact matrix:
aggr_cm &lt;- aggregate_contact_matrix(conmat, lookup_table, aggr_age)

# Aggregate the IFR:
ifr_mapping &lt;- c(rep("0-39", 8), rep("40-64", 5), rep("65+", 3))

aggr_age_ifr &lt;- aggregate_ifr_react(age_distr, ifr_mapping, age_specific_cusum_infection_counts)

# Infection-to-death distribution:
ditd &lt;- itd_distribution(ts_length  = nrow(age_specific_mortality_counts),
                         gamma_mean = 24.19231,
                         gamma_cv   = 0.3987261)

# Posterior sampling:

rstan::rstan_options(auto_write = TRUE)
chains &lt;- 1
options(mc.cores = chains)

igbm_fit &lt;- stan_igbm(y_data                      = age_specific_mortality_counts,
                      contact_matrix              = aggr_cm,
                      age_distribution_population = aggr_age,
                      age_specific_ifr            = aggr_age_ifr[[3]],
                      itd_distr                   = ditd,
                      incubation_period           = 3,
                      infectious_period           = 4,
                      likelihood_variance_type    = "linear",
                      ecr_changes                 = 7,
                      prior_scale_x0              = 1,
                      prior_scale_x1              = 1,
                      prior_scale_contactmatrix   = 0.05,
                      pi_perc                     = 0.1,
                      prior_volatility            = normal(location = 0, scale = 1),
                      prior_nb_dispersion         = exponential(rate = 1/5),
                      algorithm_inference         = "sampling",
                      nBurn                       = 10,
                      nPost                       = 30,
                      nThin                       = 1,
                      chains                      = chains,
                      adapt_delta                 = 0.6,
                      max_treedepth               = 14,
                      seed                        = 1)

post_rt_summary &lt;- posterior_rt(object                      = igbm_fit,
                                y_data                      = age_specific_mortality_counts,
                                age_distribution_population = aggr_age,
                                infectious_period            = 4)

# Visualise the posterior distribution of the effective reproduction number:
plot_posterior_rt(post_rt_summary)

</code></pre>

<hr>
<h2 id='posterior_transmrate'>Estimate the age-specific transmission rate</h2><span id='topic+posterior_transmrate'></span>

<h3>Description</h3>

<p>Estimate the age-specific transmission rate
</p>


<h3>Usage</h3>

<pre><code class='language-R'>posterior_transmrate(object, y_data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="posterior_transmrate_+3A_object">object</code></td>
<td>
<p>An object of class <code>stanigbm</code>. See <code><a href="#topic+stan_igbm">stan_igbm</a></code>.</p>
</td></tr>
<tr><td><code id="posterior_transmrate_+3A_y_data">y_data</code></td>
<td>
<p>data.frame;
age-specific mortality counts in time. See <code>data(age_specific_mortality_counts)</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame which can be visualised using <code><a href="#topic+plot_posterior_transmrate">plot_posterior_transmrate</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Age-specific mortality/incidence count time series:
data(age_specific_mortality_counts)
data(age_specific_cusum_infection_counts)

# Import the age distribution for Greece in 2020:
age_distr &lt;- age_distribution(country = "Greece", year = 2020)

# Lookup table:
lookup_table &lt;- data.frame(Initial = age_distr$AgeGrp,
                          Mapping = c(rep("0-39",  8),
                                      rep("40-64", 5),
                                      rep("65+"  , 3)))

# Aggregate the age distribution table:
aggr_age &lt;- aggregate_age_distribution(age_distr, lookup_table)

# Import the projected contact matrix for Greece:
conmat &lt;- contact_matrix(country = "GRC")

# Aggregate the contact matrix:
aggr_cm &lt;- aggregate_contact_matrix(conmat, lookup_table, aggr_age)

# Aggregate the IFR:
ifr_mapping &lt;- c(rep("0-39", 8), rep("40-64", 5), rep("65+", 3))

aggr_age_ifr &lt;- aggregate_ifr_react(age_distr, ifr_mapping, age_specific_cusum_infection_counts)

# Infection-to-death distribution:
ditd &lt;- itd_distribution(ts_length  = nrow(age_specific_mortality_counts),
                         gamma_mean = 24.19231,
                         gamma_cv   = 0.3987261)

# Posterior sampling:

rstan::rstan_options(auto_write = TRUE)
chains &lt;- 1
options(mc.cores = chains)

igbm_fit &lt;- stan_igbm(y_data                      = age_specific_mortality_counts,
                      contact_matrix              = aggr_cm,
                      age_distribution_population = aggr_age,
                      age_specific_ifr            = aggr_age_ifr[[3]],
                      itd_distr                   = ditd,
                      incubation_period           = 3,
                      infectious_period           = 4,
                      likelihood_variance_type    = "linear",
                      ecr_changes                 = 7,
                      prior_scale_x0              = 1,
                      prior_scale_x1              = 1,
                      prior_scale_contactmatrix   = 0.05,
                      pi_perc                     = 0.1,
                      prior_volatility            = normal(location = 0, scale = 1),
                      prior_nb_dispersion         = exponential(rate = 1/5),
                      algorithm_inference         = "sampling",
                      nBurn                       = 10,
                      nPost                       = 30,
                      nThin                       = 1,
                      chains                      = chains,
                      adapt_delta                 = 0.6,
                      max_treedepth               = 14,
                      seed                        = 1)

post_transmrate_summary &lt;- posterior_transmrate(object = igbm_fit,
                                                y_data = age_specific_mortality_counts)

# Visualise the posterior distribution of the age-specific transmission rate:
plot_posterior_transmrate(post_transmrate_summary)

</code></pre>

<hr>
<h2 id='priors'>Prior distributions and options</h2><span id='topic+priors'></span><span id='topic+normal'></span><span id='topic+student_t'></span><span id='topic+cauchy'></span><span id='topic+gamma'></span><span id='topic+exponential'></span>

<h3>Description</h3>

<p>The functions described on this page are used to specify the
prior-related arguments of the modeling functions in the
<span class="pkg">Bernadette</span> package.
</p>
<p>The default priors used in the <span class="pkg">Bernadette</span> modeling functions
are intended to be <em>weakly informative</em>. For many applications the
defaults will perform well, but prudent use of more informative priors is
encouraged. Uniform prior distributions are possible (e.g. by setting
<code><a href="#topic+stan_igbm">stan_igbm</a></code>'s <code>prior</code> argument to <code>NULL</code>) but, unless
the data is very strong, they are not recommended and are <em>not</em>
non-informative, giving the same probability mass to implausible values as
plausible ones.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>normal(location = 0, scale = NULL)

student_t(df = 1, location = 0, scale = NULL)

cauchy(location = 0, scale = NULL)

gamma(shape = 2, rate = 1)

exponential(rate = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="priors_+3A_location">location</code></td>
<td>
<p>Prior location. In most cases, this is the prior mean, but
for <code>cauchy</code> (which is equivalent to <code>student_t</code> with
<code>df=1</code>), the mean does not exist and <code>location</code> is the prior
median. The default value is <code class="reqn">0</code>.</p>
</td></tr>
<tr><td><code id="priors_+3A_scale">scale</code></td>
<td>
<p>Prior scale. The default depends on the family (see <strong>Details</strong>).</p>
</td></tr>
<tr><td><code id="priors_+3A_df">df</code></td>
<td>
<p>Degrees of freedom.</p>
</td></tr>
<tr><td><code id="priors_+3A_shape">shape</code></td>
<td>
<p>Prior shape for the gamma distribution. Defaults to <code>2</code>.</p>
</td></tr>
<tr><td><code id="priors_+3A_rate">rate</code></td>
<td>
<p>Prior rate for the exponential distribution. Defaults to
<code>1</code>. For the exponential distribution, the rate parameter is the
<em>reciprocal</em> of the mean.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The details depend on the family of the prior being used:
</p>


<h4>Student t family</h4>

<p>Family members:
</p>

<ul>
<li> <p><code>normal(location, scale)</code>
</p>
</li>
<li> <p><code>student_t(df, location, scale)</code>
</p>
</li>
<li> <p><code>cauchy(location, scale)</code>
</p>
</li></ul>

<p>As the degrees of freedom approaches infinity, the Student t distribution
approaches the normal distribution and if the degrees of freedom are one,
then the Student t distribution is the Cauchy distribution.
If <code>scale</code> is not specified it will default to <code class="reqn">2.5</code>.
</p>



<h3>Value</h3>

<p>A named list to be used internally by the <span class="pkg">Bernadette</span> model
fitting functions.
</p>


<h3>See Also</h3>

<p>The vignette for the <span class="pkg">Bernadette</span> package discusses
the use of some of the supported prior distributions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Age-specific mortality/incidence count time series:
# Age-specific mortality/incidence count time series:
data(age_specific_mortality_counts)
data(age_specific_infection_counts)

# Import the age distribution for Greece in 2020:
age_distr &lt;- age_distribution(country = "Greece", year = 2020)

# Lookup table:
lookup_table &lt;- data.frame(Initial = age_distr$AgeGrp,
                          Mapping = c(rep("0-39",  8),
                                      rep("40-64", 5),
                                      rep("65+"  , 3)))

# Aggregate the age distribution table:
aggr_age &lt;- aggregate_age_distribution(age_distr, lookup_table)

# Import the projected contact matrix for Greece:
conmat &lt;- contact_matrix(country = "GRC")

# Aggregate the contact matrix:
aggr_cm &lt;- aggregate_contact_matrix(conmat, lookup_table, aggr_age)

# Aggregate the IFR:
ifr_mapping &lt;- c(rep("0-39", 8), rep("40-64", 5), rep("65+", 3))

aggr_age_ifr &lt;- aggregate_ifr_react(age_distr, ifr_mapping, age_specific_infection_counts)

# Infection-to-death distribution:
ditd &lt;- itd_distribution(ts_length  = nrow(age_specific_mortality_counts),
                         gamma_mean = 24.19231,
                         gamma_cv   = 0.3987261)

# Can assign priors to names:
N05      &lt;- normal(0, 5)
Gamma22  &lt;- gamma(2,2)
igbm_fit &lt;- stan_igbm(y_data                      = age_specific_mortality_counts,
                      contact_matrix              = aggr_cm,
                      age_distribution_population = aggr_age,
                      age_specific_ifr            = aggr_age_ifr[[3]],
                      itd_distr                   = ditd,
                      likelihood_variance_type    = "quadratic",
                      prior_volatility            = N05,
                      prior_nb_dispersion         = Gamma22,
                      algorithm_inference         = "optimizing")

</code></pre>

<hr>
<h2 id='stan_igbm'>Bayesian diffusion-driven multi-type epidemic models via Stan</h2><span id='topic+stan_igbm'></span><span id='topic+stan_igbm.fit'></span>

<h3>Description</h3>

<p>A Bayesian evidence synthesis approach to model the age-specific transmission
dynamics of COVID-19 based on daily age-stratified mortality counts. The temporal
evolution of transmission rates in populations containing multiple types of individual
is reconstructed via independent diffusion processes assigned to the key epidemiological
parameters. A suitably tailored Susceptible-Exposed-Infected-Removed (SEIR) compartmental
model is used to capture the latent counts of infections and to account for fluctuations
in transmission influenced by phenomena like public health interventions and changes in human behaviour.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stan_igbm(
  y_data,
  contact_matrix,
  age_distribution_population,
  age_specific_ifr,
  itd_distr,
  incubation_period = 3,
  infectious_period = 4,
  likelihood_variance_type = c("quadratic", "linear"),
  ecr_changes = 1,
  prior_scale_x0 = 1,
  prior_scale_x1 = 1,
  prior_scale_contactmatrix = 0.05,
  pi_perc = 0.1,
  prior_volatility = normal(location = 0, scale = 2.5),
  prior_nb_dispersion = gamma(shape = 2, rate = 1),
  algorithm_inference = c("sampling", "optimizing", "meanfield", "fullrank"),
  nBurn = 500,
  nPost = 500,
  nThin = 1,
  adapt_delta = 0.8,
  max_treedepth = 14,
  seed = 1,
  ...
)

stan_igbm.fit(
  standata_preprocessed,
  prior_volatility,
  prior_nb_dispersion,
  algorithm,
  nBurn,
  nPost,
  nThin,
  adapt_delta = NULL,
  max_treedepth = NULL,
  seed,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stan_igbm_+3A_y_data">y_data</code></td>
<td>
<p>data.frame;
age-specific mortality counts in time. See <code>data(age_specific_mortality_counts)</code>.</p>
</td></tr>
<tr><td><code id="stan_igbm_+3A_contact_matrix">contact_matrix</code></td>
<td>
<p>matrix;
a squared matrix representing the the number of contacts between age groups.</p>
</td></tr>
<tr><td><code id="stan_igbm_+3A_age_distribution_population">age_distribution_population</code></td>
<td>
<p>data.frame;
the age distribution of a given population. See <code>aggregate_age_distribution</code>.</p>
</td></tr>
<tr><td><code id="stan_igbm_+3A_age_specific_ifr">age_specific_ifr</code></td>
<td>
<p>data.frame;
time-varying age-specific infection-fatality ratio. See <code>aggregate_ifr_react</code>.</p>
</td></tr>
<tr><td><code id="stan_igbm_+3A_itd_distr">itd_distr</code></td>
<td>
<p>vector;
Infection-to-death distribution. A vector of length <em>ts_length</em>.</p>
</td></tr>
<tr><td><code id="stan_igbm_+3A_incubation_period">incubation_period</code></td>
<td>
<p>integer;
length of incubation period in days. Must be &gt;=1.</p>
</td></tr>
<tr><td><code id="stan_igbm_+3A_infectious_period">infectious_period</code></td>
<td>
<p>integer;
length of infectious period in days. Must be &gt;=1.</p>
</td></tr>
<tr><td><code id="stan_igbm_+3A_likelihood_variance_type">likelihood_variance_type</code></td>
<td>
<p>integer;
If <code class="reqn">0</code>, the variance of the over-dispersed count model is a quadratic function of the mean;
if <code class="reqn">1</code>, the variance of the over-dispersed count model is a linear function of the mean.</p>
</td></tr>
<tr><td><code id="stan_igbm_+3A_ecr_changes">ecr_changes</code></td>
<td>
<p>integer;
between 1 and 7, defaults to 1. Expresses the number of changes of the effective contact rate during the course of 7 days.</p>
</td></tr>
<tr><td><code id="stan_igbm_+3A_prior_scale_x0">prior_scale_x0</code></td>
<td>
<p>double;
scale parameter of a Normal prior distribution assigned to the age-specific log(transmissibility) at time <code class="reqn">t = 0</code>.</p>
</td></tr>
<tr><td><code id="stan_igbm_+3A_prior_scale_x1">prior_scale_x1</code></td>
<td>
<p>double;
scale parameter of a Normal prior distribution assigned to the age-specific log(transmissibility) at time <code class="reqn">t = 1</code>.</p>
</td></tr>
<tr><td><code id="stan_igbm_+3A_prior_scale_contactmatrix">prior_scale_contactmatrix</code></td>
<td>
<p>double;
defaults to 0.05. A positive number that scales the informative Normal prior distribution assigned to the random contact matrix.</p>
</td></tr>
<tr><td><code id="stan_igbm_+3A_pi_perc">pi_perc</code></td>
<td>
<p>numeric;
between 0 and 1. It represents the proportion of Exposed individuals in each age group of a given population at time <code class="reqn">t = 0</code>.
while the rest <code class="reqn">100*(1-pi_perc)</code> remain Susceptible.</p>
</td></tr>
<tr><td><code id="stan_igbm_+3A_prior_volatility">prior_volatility</code></td>
<td>
<p>Prior distribution for the volatility parameters of the age-specific diffusion processes.
<code>prior_volatility</code> can be a call to <code>exponential</code> to use an exponential distribution, <code>gamma</code>
to use a Gamma distribution or one of <code>normal</code>, <code>student_t</code> or <code>cauchy</code> to use a half-normal,
half-t, or half-Cauchy prior. See <code>priors</code> for details on these functions.</p>
</td></tr>
<tr><td><code id="stan_igbm_+3A_prior_nb_dispersion">prior_nb_dispersion</code></td>
<td>
<p>Prior distribution for the dispersion parameter <code>phi</code> of the over-dispersed count model.
Same options as for <code>prior_volatility</code>.</p>
</td></tr>
<tr><td><code id="stan_igbm_+3A_algorithm_inference">algorithm_inference</code></td>
<td>
<p>One of the sampling algorithms that are implemented in Stan. See <code><a href="rstan.html#topic+stan">stan</a></code>.</p>
</td></tr>
<tr><td><code id="stan_igbm_+3A_nburn">nBurn</code></td>
<td>
<p>integer;
number of burn-in iterations at the beginning of an MCMC run. See <code><a href="rstan.html#topic+sampling">sampling</a></code>.</p>
</td></tr>
<tr><td><code id="stan_igbm_+3A_npost">nPost</code></td>
<td>
<p>integer;
number of MCMC iterations after burn-in. See <code><a href="rstan.html#topic+sampling">sampling</a></code>.</p>
</td></tr>
<tr><td><code id="stan_igbm_+3A_nthin">nThin</code></td>
<td>
<p>integer;
a positive integer specifying the period for saving samples. The default is 1, which is usually the recommended value.
See <code><a href="rstan.html#topic+sampling">sampling</a></code>.</p>
</td></tr>
<tr><td><code id="stan_igbm_+3A_adapt_delta">adapt_delta</code></td>
<td>
<p>double;
between 0 and 1, defaults to 0.8. See <code><a href="rstan.html#topic+stan">stan</a></code>.</p>
</td></tr>
<tr><td><code id="stan_igbm_+3A_max_treedepth">max_treedepth</code></td>
<td>
<p>integer;
defaults to 14. See <code><a href="rstan.html#topic+stan">stan</a></code>.</p>
</td></tr>
<tr><td><code id="stan_igbm_+3A_seed">seed</code></td>
<td>
<p>integer;
seed for the random number generator. See <code>set.seed</code>.</p>
</td></tr>
<tr><td><code id="stan_igbm_+3A_...">...</code></td>
<td>
<p>Additional arguments, to be passed to lower-level functions.</p>
</td></tr>
<tr><td><code id="stan_igbm_+3A_standata_preprocessed">standata_preprocessed</code></td>
<td>
<p>A named list providing the data for the model. See <code><a href="rstan.html#topic+sampling">sampling</a></code>.</p>
</td></tr>
<tr><td><code id="stan_igbm_+3A_algorithm">algorithm</code></td>
<td>
<p>See <code>algorithm</code> in <a href="#topic+stan_igbm">stan_igbm</a>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>stan_igbm</code> function performs full Bayesian estimation (if
<code>algorithm_inference</code> is <code>"sampling"</code>) via MCMC. The Bayesian model adds
priors (i) on the diffusion processes used to express the time-varying transmissibility
of the virus, the probability that a contact between an infectious person in age
group alpha and a susceptible person in age group alpha leads to
transmission at time <code class="reqn">t</code> and (ii) on a random contact matrix which represents
the average number of contacts between individuals of age group alpha and
age group alpha' The <code>stan_igbm</code> function calls the workhorse
<code>stan_igbm.fit</code> function.
</p>


<h3>Value</h3>

<p>An object of class <em>stanigbm</em> representing the fitted results. Slot mode for this object indicates if the sampling is done or not.
</p>
<p>An object of S4 class <em>stanfit</em> representing the fitted results. Slot mode for this object indicates if the sampling is done or not.
</p>


<h3>References</h3>

<p>Bouranis, L., Demiris, N. Kalogeropoulos, K. and Ntzoufras, I. (2022). Bayesian analysis of diffusion-driven multi-type epidemic models with application to COVID-19. arXiv: <a href="https://arxiv.org/abs/2211.15229">https://arxiv.org/abs/2211.15229</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Age-specific mortality/incidence count time series:
data(age_specific_mortality_counts)
data(age_specific_cusum_infection_counts)

# Import the age distribution for Greece in 2020:
age_distr &lt;- age_distribution(country = "Greece", year = 2020)

# Lookup table:
lookup_table &lt;- data.frame(Initial = age_distr$AgeGrp,
                          Mapping = c(rep("0-39",  8),
                                      rep("40-64", 5),
                                      rep("65+"  , 3)))

# Aggregate the age distribution table:
aggr_age &lt;- aggregate_age_distribution(age_distr, lookup_table)

# Import the projected contact matrix for Greece:
conmat &lt;- contact_matrix(country = "GRC")

# Aggregate the contact matrix:
aggr_cm &lt;- aggregate_contact_matrix(conmat, lookup_table, aggr_age)

# Aggregate the IFR:
ifr_mapping &lt;- c(rep("0-39", 8), rep("40-64", 5), rep("65+", 3))

aggr_age_ifr &lt;- aggregate_ifr_react(age_distr, ifr_mapping, age_specific_cusum_infection_counts)

# Infection-to-death distribution:
ditd &lt;- itd_distribution(ts_length  = nrow(age_specific_mortality_counts),
                         gamma_mean = 24.19231,
                         gamma_cv   = 0.3987261)

# Posterior sampling:

rstan::rstan_options(auto_write = TRUE)
chains &lt;- 1
options(mc.cores = chains)

igbm_fit &lt;- stan_igbm(y_data                      = age_specific_mortality_counts,
                      contact_matrix              = aggr_cm,
                      age_distribution_population = aggr_age,
                      age_specific_ifr            = aggr_age_ifr[[3]],
                      itd_distr                   = ditd,
                      incubation_period           = 3,
                      infectious_period           = 4,
                      likelihood_variance_type    = "linear",
                      ecr_changes                 = 7,
                      prior_scale_x0              = 1,
                      prior_scale_x1              = 1,
                      prior_scale_contactmatrix   = 0.05,
                      pi_perc                     = 0.1,
                      prior_volatility            = normal(location = 0, scale = 1),
                      prior_nb_dispersion         = exponential(rate = 1/5),
                      algorithm_inference         = "sampling",
                      nBurn                       = 10,
                      nPost                       = 30,
                      nThin                       = 1,
                      chains                      = chains,
                      adapt_delta                 = 0.6,
                      max_treedepth               = 14,
                      seed                        = 1)

# print_summary &lt;- summary(object = igbm_fit, y_data = age_specific_mortality_counts)$summary

</code></pre>

<hr>
<h2 id='summary.stanigbm'>Summary of stanigbm posterior output</h2><span id='topic+summary.stanigbm'></span>

<h3>Description</h3>

<p>This function summarizes the MCMC output for <code>stanigbm</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'stanigbm'
summary(object, y_data, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.stanigbm_+3A_object">object</code></td>
<td>
<p>An <code>R</code> object of class <code>stanigbm</code>.</p>
</td></tr>
<tr><td><code id="summary.stanigbm_+3A_y_data">y_data</code></td>
<td>
<p>data.frame;
age-specific mortality counts in time. See <code>data(age_specific_mortality_counts)</code>.</p>
</td></tr>
<tr><td><code id="summary.stanigbm_+3A_...">...</code></td>
<td>
<p>Additional arguments, to be passed to lower-level functions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named list with elements <code>summary</code> and <code>c_summary</code>,
which contain summaries for for all Markov chains merged and  individual chains,
respectively. See <code><a href="rstan.html#topic+stanfit-method-summary">stanfit-method-summary</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Age-specific mortality/incidence count time series:
data(age_specific_mortality_counts)
data(age_specific_cusum_infection_counts)

# Import the age distribution for Greece in 2020:
age_distr &lt;- age_distribution(country = "Greece", year = 2020)

# Lookup table:
lookup_table &lt;- data.frame(Initial = age_distr$AgeGrp,
                          Mapping = c(rep("0-39",  8),
                                      rep("40-64", 5),
                                      rep("65+"  , 3)))

# Aggregate the age distribution table:
aggr_age &lt;- aggregate_age_distribution(age_distr, lookup_table)

# Import the projected contact matrix for Greece:
conmat &lt;- contact_matrix(country = "GRC")

# Aggregate the contact matrix:
aggr_cm &lt;- aggregate_contact_matrix(conmat, lookup_table, aggr_age)

# Aggregate the IFR:
ifr_mapping &lt;- c(rep("0-39", 8), rep("40-64", 5), rep("65+", 3))

aggr_age_ifr &lt;- aggregate_ifr_react(age_distr, ifr_mapping, age_specific_cusum_infection_counts)

# Infection-to-death distribution:
ditd &lt;- itd_distribution(ts_length  = nrow(age_specific_mortality_counts),
                         gamma_mean = 24.19231,
                         gamma_cv   = 0.3987261)

# Posterior sampling:

rstan::rstan_options(auto_write = TRUE)
chains &lt;- 1
options(mc.cores = chains)

igbm_fit &lt;- stan_igbm(y_data                      = age_specific_mortality_counts,
                      contact_matrix              = aggr_cm,
                      age_distribution_population = aggr_age,
                      age_specific_ifr            = aggr_age_ifr[[3]],
                      itd_distr                   = ditd,
                      incubation_period           = 3,
                      infectious_period           = 4,
                      likelihood_variance_type    = "linear",
                      ecr_changes                 = 7,
                      prior_scale_x0              = 1,
                      prior_scale_x1              = 1,
                      prior_scale_contactmatrix   = 0.05,
                      pi_perc                     = 0.1,
                      prior_volatility            = normal(location = 0, scale = 1),
                      prior_nb_dispersion         = exponential(rate = 1/5),
                      algorithm_inference         = "sampling",
                      nBurn                       = 10,
                      nPost                       = 30,
                      nThin                       = 1,
                      chains                      = chains,
                      adapt_delta                 = 0.6,
                      max_treedepth               = 14,
                      seed                        = 1)

# print_summary &lt;- summary(object = igbm_fit, y_data = age_specific_mortality_counts)$summary


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
