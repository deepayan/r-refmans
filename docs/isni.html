<!DOCTYPE html><html lang="en"><head><title>Help for package isni</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {isni}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#coc'><p>A data set for Psychiatric Drug Treatment</p></a></li>
<li><a href='#definemissingstatus'><p>Utility function to generate missing status variables in longitudinal data with dropout and/or intermittent missingness.</p></a></li>
<li><a href='#isniglm'><p>Function for ISNI computation when the outcome follows GLMs.</p></a></li>
<li><a href='#isniglmmbin'><p>Function for ISNI computation when the longitudinal/clustered binary outcome follows a GLMM.</p></a></li>
<li><a href='#isnilmm'><p>Function for ISNI computation when the outcome follows LMM.</p></a></li>
<li><a href='#isnimgm'><p>Function for ISNI computation when the outcome follows marginal multivariate Gaussian Models.</p></a></li>
<li><a href='#print.isniglm'><p>Function to print  the isniglm object.</p></a></li>
<li><a href='#print.isniglmm'><p>Function to print  the isniglmm object.</p></a></li>
<li><a href='#print.isnilmm'><p>Function to print  the isnilmm object.</p></a></li>
<li><a href='#print.isnimgm'><p>Function to print  the isnimgm object.</p></a></li>
<li><a href='#qolef'><p>A data set for Quality of Life Emontional Functioning outcome.</p></a></li>
<li><a href='#skquit'><p>A randomzied trial data set for Smoking cessation</p></a></li>
<li><a href='#sos'><p>Dataset for a survey of sexual behavior</p></a></li>
<li><a href='#summary.isniglm'><p>Function to print out a summary of isniglm  object in a matrix form.</p></a></li>
<li><a href='#summary.isniglmm'><p>Function to print out a summary of isniglmm  object in a matrix form.</p></a></li>
<li><a href='#summary.isnilmm'><p>Function to print out a summary of isnilmm  object in a matrix form.</p></a></li>
<li><a href='#summary.isnimgm'><p>Function to print out a summary of isnimgm  object in a matrix form.</p></a></li>
<li><a href='#tmdm'><p>Function to fit the transitional missing data model and obtain the predicted probabilities of being observed for all observations.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Index of Local Sensitivity to Nonignorability</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3</td>
</tr>
<tr>
<td>Author:</td>
<td>Hui Xie &lt;huixie@uic.edu&gt;, Weihua Gao, Baodong Xing, Daniel Heitjan, Donald Hedeker, Chengbo Yuan</td>
</tr>
<tr>
<td>Description:</td>
<td>The current version provides functions to compute, print and summarize the Index of Sensitivity to Nonignorability (ISNI) in the generalized linear model for independent data, and in the marginal multivariate Gaussian model and the mixed-effects models for continuous and binary longitudinal/clustered data. It allows for arbitrary patterns of missingness in the regression outcomes  caused by dropout and/or intermittent missingness. One can compute the sensitivity index without estimating any nonignorable models or positing specific magnitude of nonignorability. Thus ISNI provides a simple quantitative assessment of how robust the standard estimates assuming missing at random  is with respect to the assumption of ignorability. For a tutorial, download at <a href="https://huixie.people.uic.edu/Research/ISNI_R_tutorial.pdf">https://huixie.people.uic.edu/Research/ISNI_R_tutorial.pdf</a>.	For more details, see Troxel Ma and Heitjan (2004) and Xie and Heitjan (2004) &lt;<a href="https://doi.org/10.1191%2F1740774504cn005oa">doi:10.1191/1740774504cn005oa</a>&gt; and Ma Troxel and Heitjan (2005) &lt;<a href="https://doi.org/10.1002%2Fsim.2107">doi:10.1002/sim.2107</a>&gt; and  Xie (2008) &lt;<a href="https://doi.org/10.1002%2Fsim.3117">doi:10.1002/sim.3117</a>&gt; and  Xie (2012) &lt;<a href="https://doi.org/10.1016%2Fj.csda.2010.11.021">doi:10.1016/j.csda.2010.11.021</a>&gt; and Xie and Qian (2012) &lt;<a href="https://doi.org/10.1002%2Fjae.1157">doi:10.1002/jae.1157</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.1)</td>
</tr>
<tr>
<td>Imports:</td>
<td>nlme, mvtnorm, nnet, matrixcalc, Formula, lme4</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Hui Xie &lt;huixie@uic.edu&gt;</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-08-22 02:26:08 UTC; hxie</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-08-23 07:50:09 UTC</td>
</tr>
</table>
<hr>
<h2 id='coc'>A data set for Psychiatric Drug Treatment</h2><span id='topic+coc'></span>

<h3>Description</h3>

<p>The variables are as follows:
</p>

<ul>
<li><p> y. number of days
</p>
</li>
<li><p> time. in weeks
</p>
</li>
<li><p> sub. patients id
</p>
</li>
<li><p> group. treatment group with placebo (PBO) and desipramine (DMI)
</p>
</li>
<li><p> basey. baseline days
</p>
</li>
<li><p> g1. dummy variables for treatment group
</p>
</li>
<li><p> g2. dummy variables for treatment group
</p>
</li>
<li><p> time1. dummy variables for time
</p>
</li>
<li><p> time2. dummy variables for time
</p>
</li>
<li><p> grptime. group by time
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>data(coc)
</code></pre>


<h3>Format</h3>

<p>A data frame with 869 rows and 10 variables</p>

<hr>
<h2 id='definemissingstatus'>Utility function to generate missing status variables in longitudinal data with dropout and/or intermittent missingness.</h2><span id='topic+definemissingstatus'></span>

<h3>Description</h3>

<p>Utility function to generate missing status variables in longitudinal data with dropout and/or intermittent missingness.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>definemissingstatus(data, id, time, y)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="definemissingstatus_+3A_data">data</code></td>
<td>
<p>the name of the panel dataset in the long format with each row denoting a subject-visit observation
for ALL the planned visits, regardless of being missed or not. When a subject is lost to follow up, the data set
must include the observation at the first time of being lost to follow up.</p>
</td></tr>
<tr><td><code id="definemissingstatus_+3A_id">id</code></td>
<td>
<p>the name of the level-2 clustering variable.</p>
</td></tr>
<tr><td><code id="definemissingstatus_+3A_time">time</code></td>
<td>
<p>the name of the variable denoting the time of the visit. Can set time=NULL if data is already sorted by id and time within 
id.</p>
</td></tr>
<tr><td><code id="definemissingstatus_+3A_y">y</code></td>
<td>
<p>the name of the outcome variable of the interest that is subject to missingness.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a dataset with the following three new variables added: 
</p>

<ul>
<li><p>    g_ : missingness indicator, &quot;O&quot;-observed, &quot;I&quot;-intermittent missing, &quot;D&quot;-dropout
</p>
</li>
<li><p>    gp_: missingness indicator in the previous visit, &quot;O&quot;-observed, &quot;I&quot;-intermittent missing, &quot;D&quot;-dropout, &quot;U&quot;-undefined. 
</p>
</li>
<li><p>    yp_: the immediately observed prior outcome.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>qolefnew &lt;- definemissingstatus(qolef, id=id, time=time, y=y)
</code></pre>

<hr>
<h2 id='isniglm'>Function for ISNI computation when the outcome follows GLMs.</h2><span id='topic+isniglm'></span>

<h3>Description</h3>

<p>Calculate the ISNI when the regression outcome is subject to missingness and follows generalized linear models (GLMs)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>isniglm(formula, family = gaussian, data, weights, subset,
  start = NULL, offset)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="isniglm_+3A_formula">formula</code></td>
<td>
<p>an object of class &quot;Formula&quot;: a symbolic description of the models to be fitted for the outcome and missingness status variable.
The details of model specification are given under &quot;Details&quot;.</p>
</td></tr>
<tr><td><code id="isniglm_+3A_family">family</code></td>
<td>
<p>a description of the error distribution to be used in the GLM for the outcome.</p>
</td></tr>
<tr><td><code id="isniglm_+3A_data">data</code></td>
<td>
<p>the name of data frame containing the variables in the model and all the observations including those intended to be collected 
but became missing.</p>
</td></tr>
<tr><td><code id="isniglm_+3A_weights">weights</code></td>
<td>
<p>an optional vector of &quot;prior weights&quot; to be used in the fitting process for the outcome model and the missingness mechanism model.
Should be NULL or a numeric vector.</p>
</td></tr>
<tr><td><code id="isniglm_+3A_subset">subset</code></td>
<td>
<p>an optional vector specifying a subset of observations to be used in the fitting process for the outcome model and the missingness mechanism model.</p>
</td></tr>
<tr><td><code id="isniglm_+3A_start">start</code></td>
<td>
<p>starting values for the parameters in the linear predictor of the outcome model.</p>
</td></tr>
<tr><td><code id="isniglm_+3A_offset">offset</code></td>
<td>
<p>an optional vector to specify an a priori known component to be included in the linear predictor during fitting the GLM for the outcome. 
This should be NULL or a numeric vector of length equal to the number of observations.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The ISNI analysis is based on a joint selection model and requires specifying two model equations: the complete-data model and the missing data mechanism model.
To specify the variables in the models and required for computing the ISNI measures, we make use of the  <code>R</code> package &quot;Formula&quot;  designed for handling model
equations with multiple responses    and multiple sets of predictors. At a minimum, the user should supply a single-equation 
in the typical form:  <code>response</code> ~ <code>Xterms</code> where <code>response</code> is the (numeric or factor) vector for the outcome of interest and <code>Xterms</code> 
is a series of terms, separated by + operators, which specify a linear predictor for response. With the signle-equation specification, the <code>isnimgm</code> function 
will by default use (<code>is.na(response)</code>) as the 
missingness status variable and <code>Xterms</code> as the observed predictors for missingness. The <code>isniglm</code> then computes the MAR estimates and conducts ISNI computation
to evaluate the rate of change of model estimates in the neighborhood of the MAR model where the missingness probability is allowed to depend on the unobserved value 
of <code>response</code>,   even after  conditioning on the other  missingness predictors. 
</p>
<p>The above single-equation formula specification uses the same set of predictors for the outcome model and the missingness mechanism model for computing ISNI. 
To use different sets of predictors, one can explicitly specifiy a two-equation formula as: <code>response</code> | <code>is.na(response)</code> ~ <code>Xterms</code> |  <code>Sterms</code>,
which specifies the formula  for the complete-data model as <code>response</code> ~ <code>Xterms</code> and that for the missing data mechanism model as <code>is.na(response)</code> ~ <code>Sterms</code>, and 
<code>Xterms</code> and the observed predictors for missingness <code>Sterms</code> can be different.
</p>


<h3>References</h3>

<p>Troxel AB, Ma G, Heitjan DF. An Index of Local Sensitivity to Nonignorability. Stat Sin. 2004;14:1221-1237.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## load data set
data(sos)

## Perform the MAR analysis
ymodel= sexact  ~ gender*faculty
summary(glm(ymodel,family=binomial, data=sos))

## Perform ISNI analysis
sos.isni&lt;-isniglm(ymodel, family=binomial, data=sos)
sos.isni
summary(sos.isni)

## specifying the missing data model explicitly
ygmodel= sexact | is.na(sexact)  ~ gender*faculty | gender *faculty
summary(isniglm(ygmodel, family=binomial, data=sos))
 

 ## ISNI for grouped binomial regression. 
gender &lt;- c(0,0,1,1,0,0,1,1)
faculty    &lt;- c(0,0,0,0,1,1,1,1)
gender = factor(gender, levels = c(0, 1), labels =c("male", "female"))
faculty = factor(faculty, levels = c(0, 1), labels =c("other", "mdv"))
 
SAcount &lt;- c(NA, 1277, NA, 1247, NA, 126, NA, 152)
total       &lt;- c(1189,1710,978,1657,68,215,73,246)
sosgrp &lt;- data.frame(gender=gender, faculty=faculty, SAcount=SAcount, total=total)
ymodel &lt;- SAcount/total ~gender*faculty
sosgrp.isni&lt;-isniglm(ymodel, family=binomial, data=sosgrp, weight=total)
</code></pre>

<hr>
<h2 id='isniglmmbin'>Function for ISNI computation when the longitudinal/clustered binary outcome follows a GLMM.</h2><span id='topic+isniglmmbin'></span>

<h3>Description</h3>

<p>Calculate the ISNI when the regression outcome is subject to missingness and follows generalized linear mixed-effects models (GLMMs) for binary outcomes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>isniglmmbin(formula, data, random, id, weights, subset, predprobobs,
  misni = FALSE, nAGQ = 10, method = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="isniglmmbin_+3A_formula">formula</code></td>
<td>
<p>an object of class &quot;Formula&quot;: a symbolic description of the models to be fitted for the outcome and missingness status variable.
The details of model specification are given under &quot;Details&quot;.</p>
</td></tr>
<tr><td><code id="isniglmmbin_+3A_data">data</code></td>
<td>
<p>the name of data frame containing all the variables in the model and all the observations including those intended to be collected
but became missing.</p>
</td></tr>
<tr><td><code id="isniglmmbin_+3A_random">random</code></td>
<td>
<p>an object of class &quot;formula&quot;: an one-sided linear formula description of the random-effects part of the model to be fitted
for the outcome</p>
</td></tr>
<tr><td><code id="isniglmmbin_+3A_id">id</code></td>
<td>
<p>the name of the level-2 clustering variable.</p>
</td></tr>
<tr><td><code id="isniglmmbin_+3A_weights">weights</code></td>
<td>
<p>frequency weights to be assigned to each <code>id</code>. when supplied, indicates differential weights are used; otherwise each <code>id</code> is weighted equally.</p>
</td></tr>
<tr><td><code id="isniglmmbin_+3A_subset">subset</code></td>
<td>
<p>an optional vector specifying a subset of observations to be used in the fitting process for the outcome model and the missingness mechanism model.</p>
</td></tr>
<tr><td><code id="isniglmmbin_+3A_predprobobs">predprobobs</code></td>
<td>
<p>Null if using buil-in multinomial transitional logistic model to obtain predicted probabilities of being observed;
otherwise user supply the name of the variable in <code>data</code> that gives these probabilities for all the observations in the data.</p>
</td></tr>
<tr><td><code id="isniglmmbin_+3A_misni">misni</code></td>
<td>
<p>FALSE if using the default approach to computing ISNI with a scalar nonignorability parameter;
TRUE when computing ISNI with multiple nonignorability parameters.</p>
</td></tr>
<tr><td><code id="isniglmmbin_+3A_nagq">nAGQ</code></td>
<td>
<p>integer scalar - the number of points per axis for evaluating the adaptive Gauss-Hermite approximation to the log-likelihood for
obtaining MAR estimates using the R function glmer().
Defaults to 10, corresponding to the 10-points Gaussian quarature. A value of 1 corresponds to Laplace approximation. Values greater than 1 produce
greater accuracy in the  evaluation of the log-likelihood at the expense of speed.  A value of zero
uses a faster but less exact form of parameter estimation for GLMMs by optimizing the random effects and the fixed-effects
coefficients in the penalized iteratively reweighted least squares step. (See documentation for glmer() for Details.)</p>
</td></tr>
<tr><td><code id="isniglmmbin_+3A_method">method</code></td>
<td>
<p>Indicate the method to obtain the MAR estimates:
1: GLMER(); 2:  OPTIM()</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The ISNI analysis is based on a joint selection model and requires specifying two model equations: the outcome model and the missingness mechanism model.
At a minimum, the user should supply a single-equation in the typical form:  <code>response</code> ~ <code>Xterms</code> where <code>response</code> is the (numeric or factor) vector for the binnary outcome of interest and <code>Xterms</code>
is a series of terms, separated by + operators, which specify a linear predictor for response. With the signle-equation specification, the <code>isniglmm</code> function
will by default use the utility function <code>definemissingstatus</code> provided in the package to generate the
missingness status variables at the current and prior visits and then use <code>Xterms</code> as the predictors for fitting a first-order transitional missing data model.
It is important to sort within-<code>id</code> observations  by time so that the missingness status variables can be defined correctly in this default setting.  The <code>isniglmmbin()</code> then computes the MAR estimates and conducts ISNI computation
to evaluate the rate of change of model estimates in the neighborhood of the MAR model where the missingness probability is allowed to depend on the unobserved value
of <code>response</code>,   even after  conditioning on the other  missingness predictors.
</p>
<p>The above single-equation formula specification uses the same set of predictors for the outcome model and the missingness mechanism model for computing ISNI.
To use different sets of predictors, one can explicitly specifiy a two-equation formula as: <code>response</code> | <code>miss + missprior</code> ~ <code>Xterms</code> |  <code>Sterms</code>,
which specifies the formula  for the outcome model as <code>response</code> ~ <code>Xterms</code> and that for the missingness mechanism model as <code>miss | missprior</code> ~ <code>Sterms</code>,
where <code>Xterms</code> and <code>Sterms</code> can be different, <code>miss</code> and <code>missprior</code> are the variable names in <code>data</code> denoting the missingness status at the
current and prior visits, respectively.
</p>
<p>For <code>isniglmm</code>, <code>response</code> ~ <code>Xterms</code> specfied the fixed-effect part of the linear mixed-effects model for the outcome. The random-effect part of the model is
specified as a one-sided formula via the argument <code>random</code>.
</p>


<h3>References</h3>

<p>Xie H. A Local Sensitivity Analysis Approach to Longitudinal Non-Gaussian Data with Non-Ignorable Dropout. Statist Med. 2008;27:3155-3177. <br />
Xie H. Analyzing Longitudinal Clinical Trial Data with Nonignorable Missingness and Unknown Missingness Reasons. Comput Stat Data Anal. 2012;56:1287-1300. <br />
Xie H, Qian Y. Measuring the Impact of Nonignorability in Panel Data with Non-Monotone Nonresponse. Journal of Applied Econometrics. 2012;27:129-159. <br />
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(skquit)

formula=quit~time
## formula=quit~time + helmert1:as.factor(time) +helmert2:as.factor(time)+ helmert3:as.factor(time)
random=~1

## Uncomment the following two lines of codes to run isniglmmbin() and report result with summary()
##result=isniglmmbin(formula, skquit, random, id,misni=FALSE,method=1)
##summary(result)

</code></pre>

<hr>
<h2 id='isnilmm'>Function for ISNI computation when the outcome follows LMM.</h2><span id='topic+isnilmm'></span>

<h3>Description</h3>

<p>Calculate the ISNI when the regression outcome is subject to missingness and follows linear mixed-effects models (LMMs)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>isnilmm(formula, data, random, id, weights, subset, predprobobs,
  misni = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="isnilmm_+3A_formula">formula</code></td>
<td>
<p>an object of class &quot;Formula&quot;: a symbolic description of the models to be fitted for the outcome and missingness status variable.
The details of model specification are given under &quot;Details&quot;.</p>
</td></tr>
<tr><td><code id="isnilmm_+3A_data">data</code></td>
<td>
<p>the name of data frame containing all the variables in the model and all the observations including those intended to be collected 
but became missing.</p>
</td></tr>
<tr><td><code id="isnilmm_+3A_random">random</code></td>
<td>
<p>an object of class &quot;formula&quot;: an one-sided linear formula description of the random-effects part of the model to be fitted 
for the outcome</p>
</td></tr>
<tr><td><code id="isnilmm_+3A_id">id</code></td>
<td>
<p>the name of the level-2 clustering variable.</p>
</td></tr>
<tr><td><code id="isnilmm_+3A_weights">weights</code></td>
<td>
<p>frequency weights to be assigned to each <code>id</code>. when supplied, indicates differential weights are used; otherwise each <code>id</code> is weighted equally.</p>
</td></tr>
<tr><td><code id="isnilmm_+3A_subset">subset</code></td>
<td>
<p>an optional vector specifying a subset of observations to be used in the fitting process for the outcome model and the missingness mechanism model.</p>
</td></tr>
<tr><td><code id="isnilmm_+3A_predprobobs">predprobobs</code></td>
<td>
<p>Null if using buil-in multinomial transitional logistic model to obtain predicted probabilities of being observed;
otherwise user supply the name of the variable in <code>data</code> that gives these probabilities for all the observations in the data.</p>
</td></tr>
<tr><td><code id="isnilmm_+3A_misni">misni</code></td>
<td>
<p>FALSE if using the default approach to computing ISNI with a scalar nonignorability parameter; 
TRUE when computing ISNI with multiple nonignorability parameters.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The ISNI analysis is based on a joint selection model and requires specifying two model equations: the complete-data model and the missing data mechanism model.
To specify the variables in the models that are required for computing the ISNI measures, we make use of the  <code>R</code> package &quot;Formula&quot;  designed for handling model
equations with multiple responses    and multiple sets of predictors . At a minimum, the user should supply a single-equation 
in the typical form:  <code>response</code> ~ <code>Xterms</code> where <code>response</code> is the (numeric or factor) vector for the outcome of interest and <code>Xterms</code> 
is a series of terms, separated by + operators, which specify a linear predictor for response. With the signle-equation specification, the <code>isniglm</code> function 
will by default use the utility function <code>definemissingstatus</code> provided in the package to generate the 
missingness status variables at the current and prior visits and then use <code>Xterms</code> as the observed missingness predictors for fitting a first-order transitional missing data model. 
It is important to sort within-<code>id</code> observations  by time so that the missingness status variables can be defined correctly in this default setting.  The <code>isnimgm</code> then computes the MAR estimates and conducts ISNI computation
to evaluate the rate of change of model estimates in the neighborhood of the MAR model where the missingness probability is allowed to depend on the unobserved value 
of <code>response</code>,   even after  conditioning on the other  missingness predictors. 
</p>
<p>The above single-equation formula specification uses the same set of predictors for the outcome model and the missingness mechanism model for computing ISNI. 
To use different sets of predictors, one can explicitly specifiy a two-equation formula as: <code>response</code> | <code>miss + missprior</code> ~ <code>Xterms</code> |  <code>Sterms</code>,
which specifies the formula  for the complete-data model as <code>response</code> ~ <code>Xterms</code> and that for the missing data mechanism model as <code>miss + missprior</code> ~ <code>Sterms</code>, 
where <code>Xterms</code> and the observed predictors for missingness <code>Sterms</code> can be different, <code>miss</code> and <code>missprior</code> are the variable names in <code>data</code> denoting the missingness status at the 
current and prior visits, respectively.  
</p>
<p>For <code>isnilmm</code>, <code>response</code> ~ <code>Xterms</code> specfied the fixed-effect part of the linear mixed-effects model for the outcome. The random-effect part of the model is
specified as a one-sided formula via the argument <code>random</code>.
</p>


<h3>References</h3>

<p>Hui Xie and Yi Qian (2012) Measuring the impact of nonignorability in panel data with non-monotone nonresponse., Journal of Applied Econometrics 27: 129-159. <br />
Hui Xie, Gao,W, Xing, B., Heitjan, D, Hedeker, D and Yuan, C. (2018) Measuring the Impact of Nonignorable Missingness Using the R packaeg isni, Computer Methods and Programs in Biomedicine 164 207-220.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(qolef)
ymodel= y | g+ gp~   as.factor(time)*group+perf+sever

##Random intercept model
result=isnilmm(ymodel, random=~1, id=id,  data=qolef)
summary(result)

</code></pre>

<hr>
<h2 id='isnimgm'>Function for ISNI computation when the outcome follows marginal multivariate Gaussian Models.</h2><span id='topic+isnimgm'></span>

<h3>Description</h3>

<p>Calculate the ISNI when the regression outcome is subject to missingness and follows marginal multivaraite Gaussian models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>isnimgm(formula, data, cortype = "CS", id, subset, weights, predprobobs,
  misni = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="isnimgm_+3A_formula">formula</code></td>
<td>
<p>an object of class &quot;Formula&quot;: a symbolic description of the models to be fitted for the outcome and missingness status variable.
The details of model specification are given under &quot;Details&quot;.</p>
</td></tr>
<tr><td><code id="isnimgm_+3A_data">data</code></td>
<td>
<p>the name of data frame containing all the variables in the model and all the observations including those intended to be collected 
but became missing.</p>
</td></tr>
<tr><td><code id="isnimgm_+3A_cortype">cortype</code></td>
<td>
<p>the type of within-subject correlation structure.</p>
</td></tr>
<tr><td><code id="isnimgm_+3A_id">id</code></td>
<td>
<p>the name of variable for the level-2 clustering variable.</p>
</td></tr>
<tr><td><code id="isnimgm_+3A_subset">subset</code></td>
<td>
<p>an optional vector specifying a subset of observations to be used in the fitting process for the outcome model and the missingness mechanism model.</p>
</td></tr>
<tr><td><code id="isnimgm_+3A_weights">weights</code></td>
<td>
<p>frequency weights to be assigned to each <code>id</code>. when supplied, indicates differential weights are used; otherwise each <code>id</code> is weighted equally.</p>
</td></tr>
<tr><td><code id="isnimgm_+3A_predprobobs">predprobobs</code></td>
<td>
<p>Null if using buil-in multinomial transitional logistic model to obtain predicted probabilities of being observed;
otherwise user supply the name of the variable in <code>data</code> that gives these probabilities for all the observations in the data.</p>
</td></tr>
<tr><td><code id="isnimgm_+3A_misni">misni</code></td>
<td>
<p>FALSE if using the default approach to computing ISNI with a scalar nonignorability parameter; 
TRUE when computing ISNI with multiple nonignorability parameters.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The ISNI analysis is based on a joint selection model and requires specifying two model equations: the complete-data model and the missing data mechanism model.
To specify the variables in the models that are required for computing the isni measures, we make use of the  <code>R</code> package &quot;Formula&quot;  designed for handling model
equations with multiple responses    and multiple sets of predictors . At a minimum, the user should supply a single-equation 
in the typical form:  <code>response</code> ~ <code>Xterms</code> where <code>response</code> is the (numeric or factor) vector for the outcome of interest and <code>Xterms</code> 
is a series of terms, separated by + operators, which specify a linear predictor for response. With the signle-equation specification, the <code>isniglm</code> function 
will by default use the utility function <code>definemissingstatus</code> provided in the package to generate the 
missingness status variables at the current and prior visits and then use <code>Xterms</code> as the observed missingness predictors for fitting a first-order transitional missing data model. 
It is important to sort within-<code>id</code> observations  by time so that the missingness status variables can be defined correctly in this default setting.  The <code>isnimgm</code> then computes the MAR estimates and conducts ISNI computation
to evaluate the rate of change of model estimates in the neighborhood of the MAR model where the missingness probability is allowed to depend on the unobserved value 
of <code>response</code>,   even after  conditioning on the other  missingness predictors. 
</p>
<p>The above single-equation formula specification uses the same set of predictors for the outcome model and the missing data mechanism model for computing ISNI. 
To use different sets of predictors, one can explicitly specifiy a two-equation formula as: <code>response</code> | <code>miss + missprior</code> ~ <code>Xterms</code> |  <code>Sterms</code>,
which specifies the formula  for the outcome model as <code>response</code> ~ <code>Xterms</code> and that for the missing data mechanism model as <code>miss + missprior</code> ~ <code>Sterms</code>, 
where <code>Xterms</code> and the observed missingness predictors <code>Sterms</code> can be different, <code>miss</code> and <code>missprior</code> are the variable names in <code>data</code> denoting the missingness status at the 
current and prior visits, respectively.
</p>


<h3>References</h3>

<p>Ma G, Troxel AB, Heitjan DF. An Index of Local Sensitivity to Nonignorable Dropout in Longitudinal Modeling. Stat Med. 2005;24:2129-2150. <br />
Xie H. Analyzing Longitudinal Clinical Trial Data with Nonignorable Missingness and Unknown Missingness Reasons. Comput Stat Data Anal. 2012;56:1287-1300. <br />
Xie H, Qian Y. Measuring the Impact of Nonignorability in Panel Data with Non-Monotone Nonresponse. Journal of Applied Econometrics. 2012;27:129-159.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>models= y | g+gp ~   perf + sever+ as.factor(time) + group +as.factor(time):group   |
       as.factor(time) * group + yp+ perf + sever
qolef.isni=isnimgm(models, data=qolef, id=id)
summary(qolef.isni)


</code></pre>

<hr>
<h2 id='print.isniglm'>Function to print  the isniglm object.</h2><span id='topic+print.isniglm'></span>

<h3>Description</h3>

<p><code>print</code> method for class isniglm
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'isniglm'
print(x, digits = max(3, getOption("digits") - 2), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.isniglm_+3A_x">x</code></td>
<td>
<p>the isniglm object obtained from the isniglm function</p>
</td></tr>
<tr><td><code id="print.isniglm_+3A_digits">digits</code></td>
<td>
<p>the number of significant digits to use when printing</p>
</td></tr>
<tr><td><code id="print.isniglm_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function prints the model call, isni and c statistics from the isniglm object.
</p>

<hr>
<h2 id='print.isniglmm'>Function to print  the isniglmm object.</h2><span id='topic+print.isniglmm'></span>

<h3>Description</h3>

<p><code>print</code> method for class isniglmm
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'isniglmm'
print(x, digits = max(3, getOption("digits") - 2),
  ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.isniglmm_+3A_x">x</code></td>
<td>
<p>the isniglmm object obtained from the isniglmm function</p>
</td></tr>
<tr><td><code id="print.isniglmm_+3A_digits">digits</code></td>
<td>
<p>the number of significant digits to use when printing</p>
</td></tr>
<tr><td><code id="print.isniglmm_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function print.isnilmm prints the model call,  isni and c statistics from the isniglmm object.
</p>

<hr>
<h2 id='print.isnilmm'>Function to print  the isnilmm object.</h2><span id='topic+print.isnilmm'></span>

<h3>Description</h3>

<p><code>print</code> method for class isnilmm
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'isnilmm'
print(x, digits = max(3, getOption("digits") - 2), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.isnilmm_+3A_x">x</code></td>
<td>
<p>the isnilmm object obtained from the isnilmm function</p>
</td></tr>
<tr><td><code id="print.isnilmm_+3A_digits">digits</code></td>
<td>
<p>the number of significant digits to use when printing</p>
</td></tr>
<tr><td><code id="print.isnilmm_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function print.isnilmm prints the model call,  isni and c statistics from the isnilmm object.
</p>

<hr>
<h2 id='print.isnimgm'>Function to print  the isnimgm object.</h2><span id='topic+print.isnimgm'></span>

<h3>Description</h3>

<p><code>print</code> method for class isnimgm
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'isnimgm'
print(x, digits = max(3, getOption("digits") - 2), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.isnimgm_+3A_x">x</code></td>
<td>
<p>the isnimgm object obtained from the isnimgm function</p>
</td></tr>
<tr><td><code id="print.isnimgm_+3A_digits">digits</code></td>
<td>
<p>the number of significant digits to use when printing</p>
</td></tr>
<tr><td><code id="print.isnimgm_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function print.isnimgm prints the model call, isni and c statistics from the isnimgm object.
</p>

<hr>
<h2 id='qolef'>A data set for Quality of Life Emontional Functioning outcome.</h2><span id='topic+qolef'></span>

<h3>Description</h3>

<p>The variables are as follows:
</p>

<ul>
<li><p> id: patients id
</p>
</li>
<li><p> y: EF score
</p>
</li>
<li><p> time: time in months since randomization. 
</p>
</li>
<li><p> group: placebo (0) or flutamide (1)
</p>
</li>
<li><p> perf: baseline performance score
</p>
</li>
<li><p> sever: baseline disease severity
</p>
</li>
<li><p> basey: EF at baseline
</p>
</li>
<li><p> g: missingness status (&quot;O&quot;=observed, &quot;D&quot;=dropout, &quot;I&quot;=intermittent missingness)
</p>
</li>
<li><p> gp: missingness status in the prior visit (&quot;O&quot;=observed, &quot;D&quot;=dropout, &quot;I&quot;=intermittent missingness, &quot;U&quot;=undefined)
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>data(qolef)
</code></pre>


<h3>Format</h3>

<p>A data frame with 2860 rows and 10 variables</p>

<hr>
<h2 id='skquit'>A randomzied trial data set for Smoking cessation</h2><span id='topic+skquit'></span>

<h3>Description</h3>

<p>The variables are as follows:
</p>

<ul>
<li><p> id. subjects id
</p>
</li>
<li><p>  time. Time in weeks after baseline
</p>
</li>
<li><p> quit. 0: smoking; 1: quit smoking
</p>
</li>
<li><p> sub. patients id
</p>
</li>
<li><p> helmert1. Herlmert contrast 1 among 4 treatment groups.
</p>
</li>
<li><p> helmert2. Herlmert contrast 2 among 4 treatment groups.
</p>
</li>
<li><p> helmert3. Herlmert contrast 3 among 4 treatment groups.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>data(skquit)
</code></pre>


<h3>Format</h3>

<p>A data frame with 1861 rows and 6 variables</p>

<hr>
<h2 id='sos'>Dataset for a survey of sexual behavior</h2><span id='topic+sos'></span>

<h3>Description</h3>

<p>A dataset from a survey of sexual behavior
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(sos)
</code></pre>


<h3>Format</h3>

<p>A data frame with 6136 rows and 3 variables</p>


<h3>Details</h3>

<p>This data frame contains the following three factor variables:
</p>

<ul>
<li><p>  sexact: response to the survey question &quot;Have you ever had sexual intercouse&quot; with two levels of 
<code>no</code> (ref level) and <code>yes</code>.
</p>
</li>
<li><p> gender: two levels of <code>male</code> (ref level) and female.
</p>
</li>
<li><p> faculty: the student's faculty with two levels of <code>mdv</code>=medical/dental/veterinary (ref level) and  <code>other</code>
=all the other faculty categories.
</p>
</li></ul>


<hr>
<h2 id='summary.isniglm'>Function to print out a summary of isniglm  object in a matrix form.</h2><span id='topic+summary.isniglm'></span>

<h3>Description</h3>

<p>Function to print out a summary of isniglm  object in a matrix form.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'isniglm'
summary(object, digits = max(3, getOption("digits") -
  2), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.isniglm_+3A_object">object</code></td>
<td>
<p>the isniglm object obtained from the isniglm function</p>
</td></tr>
<tr><td><code id="summary.isniglm_+3A_digits">digits</code></td>
<td>
<p>the number of significant digits to use when printing</p>
</td></tr>
<tr><td><code id="summary.isniglm_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function summarizes the MAR coefficient estimates, standard errors, isni and c statistics from the isniglm object as a matrix form.
</p>

<hr>
<h2 id='summary.isniglmm'>Function to print out a summary of isniglmm  object in a matrix form.</h2><span id='topic+summary.isniglmm'></span>

<h3>Description</h3>

<p>Function to print out a summary of isniglmm  object in a matrix form.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'isniglmm'
summary(object, digits = max(3, getOption("digits") -
  2), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.isniglmm_+3A_object">object</code></td>
<td>
<p>the isniglmm object obtained from the isniglmm function</p>
</td></tr>
<tr><td><code id="summary.isniglmm_+3A_digits">digits</code></td>
<td>
<p>the number of significant digits to use when printing</p>
</td></tr>
<tr><td><code id="summary.isniglmm_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
</table>

<hr>
<h2 id='summary.isnilmm'>Function to print out a summary of isnilmm  object in a matrix form.</h2><span id='topic+summary.isnilmm'></span>

<h3>Description</h3>

<p>Function to print out a summary of isnilmm  object in a matrix form.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'isnilmm'
summary(object, digits = max(3, getOption("digits") -
  2), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.isnilmm_+3A_object">object</code></td>
<td>
<p>the isnilmm object obtained from the isnilmm function</p>
</td></tr>
<tr><td><code id="summary.isnilmm_+3A_digits">digits</code></td>
<td>
<p>the number of significant digits to use when printing</p>
</td></tr>
<tr><td><code id="summary.isnilmm_+3A_...">...</code></td>
<td>
<p>additional arguements</p>
</td></tr>
</table>

<hr>
<h2 id='summary.isnimgm'>Function to print out a summary of isnimgm  object in a matrix form.</h2><span id='topic+summary.isnimgm'></span>

<h3>Description</h3>

<p>Function to print out a summary of isnimgm  object in a matrix form.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'isnimgm'
summary(object, digits = max(3, getOption("digits") -
  2), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.isnimgm_+3A_object">object</code></td>
<td>
<p>the isnimgm object obtained from the isnimgm function</p>
</td></tr>
<tr><td><code id="summary.isnimgm_+3A_digits">digits</code></td>
<td>
<p>the number of significant digits to use when printing</p>
</td></tr>
<tr><td><code id="summary.isnimgm_+3A_...">...</code></td>
<td>
<p>additional arguements</p>
</td></tr>
</table>

<hr>
<h2 id='tmdm'>Function to fit the transitional missing data model and obtain the predicted probabilities of being observed for all observations.</h2><span id='topic+tmdm'></span>

<h3>Description</h3>

<p>Fit missing data model and obtain predicted probabilities of being observed for all observations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tmdm(formula, data, weights, subset)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tmdm_+3A_formula">formula</code></td>
<td>
<p>a formula to specify a multinomial transitional missing data model  in the form of g+gp ~Sterms.</p>
</td></tr>
<tr><td><code id="tmdm_+3A_data">data</code></td>
<td>
<p>the name of the dataset for fitting missing data mechansim model</p>
</td></tr>
<tr><td><code id="tmdm_+3A_weights">weights</code></td>
<td>
<p>an optional vector of &quot;prior weights&quot; to be used in the fitting process for the missingness mechanism model.
Should be NULL or a numeric vector.</p>
</td></tr>
<tr><td><code id="tmdm_+3A_subset">subset</code></td>
<td>
<p>an optional vector specifying a subset of observations to be used in the fitting process for the outcome model and the missingness mechanism model.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>qolefitg &lt;- tmdm(g+gp~as.factor(time)+group+perf+sever,data=qolef)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
