<!DOCTYPE html><html><head><title>Help for package MCPModGeneral</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MCPModGeneral}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#MCPModGen'><p>MCPModGen - Multiple Comparison and Modeling (General Case)</p></a></li>
<li><a href='#MCPModGeneral-package'>
<p>A Supplement to the <code>DoseFinding</code> Package for the General Case</p></a></li>
<li><a href='#MCPModSurv'><p>MCPModSurv - Multiple Comparison and Modeling for Coxph and Parametric</p>
Survival Models</a></li>
<li><a href='#planModPrepare'><p>Return the S Matrix for a Theoretical DR-Curve</p></a></li>
<li><a href='#powMCTGen'><p>Calculate Power for Multiple Contrast Test (General Case)</p></a></li>
<li><a href='#prepareGen'><p>Prepare General Data for the MCPMod Function</p></a></li>
<li><a href='#sampSizeMCTGen'><p>Sample Size Calculations (General Case)</p></a></li>
<li><a href='#simS'><p>Covariance Matrix Simulation</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>A Supplement to the 'DoseFinding' Package for the General Case</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1-1</td>
</tr>
<tr>
<td>Description:</td>
<td>Analyzes non-normal data via the Multiple Comparison Procedures and Modeling approach (MCP-Mod). Many functions rely on the 'DoseFinding' package. This package makes it so the user does not need to provide or calculate the mu vector and S matrix. Instead, the user typically supplies the data in its raw form, and this package will calculate the needed objects and passes them into the 'DoseFinding' functions. If the user wishes to primarily use the functions provided in the 'DoseFinding' package, a singular function (prepareGen()) will provide mu and S. The package currently handles power analysis and the MCP-Mod procedure for negative binomial, Poisson, and binomial data. The MCP-Mod procedure can also be applied to survival data, but power analysis is not available.
	Bretz, F., Pinheiro, J. C., and Branson, M. (2005) &lt;<a href="https://doi.org/10.1111%2Fj.1541-0420.2005.00344.x">doi:10.1111/j.1541-0420.2005.00344.x</a>&gt;.
	Buckland, S. T., Burnham, K. P. and Augustin, N. H. (1997) &lt;<a href="https://doi.org/10.2307%2F2533961">doi:10.2307/2533961</a>&gt;.
	Pinheiro, J. C., Bornkamp, B., Glimm, E. and Bretz, F. (2014) &lt;<a href="https://doi.org/10.1002%2Fsim.6052">doi:10.1002/sim.6052</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>DoseFinding</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, MASS</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.0.2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 2.1.0), knitr, rmarkdown, survival</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-02-09 21:54:23 UTC; ilaga</td>
</tr>
<tr>
<td>Author:</td>
<td>Ian Laga [aut, cre],
  Francis Boateng [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ian Laga &lt;ilaga25@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-02-19 17:50:04 UTC</td>
</tr>
</table>
<hr>
<h2 id='MCPModGen'>MCPModGen - Multiple Comparison and Modeling (General Case)</h2><span id='topic+MCPModGen'></span>

<h3>Description</h3>

<p>This function allows the user to implement the MCPMod function on negative
binomial, Poisson, and binary data, without having to write any additional
code. If analyzing survival data, see the
<code><a href="#topic+MCPModSurv">MCPModSurv</a></code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MCPModGen(
  family = c("negative binomial", "binomial"),
  link = c("log", "logit", "probit", "cauchit", "cloglog", "identity", "log risk ratio",
    "risk ratio"),
  returnS = FALSE,
  w = NULL,
  dose,
  resp,
  data = NULL,
  models,
  addCovars = ~1,
  placAdj = FALSE,
  selModel = c("AIC", "maxT", "aveAIC"),
  alpha = 0.025,
  df = NULL,
  critV = NULL,
  doseType = c("TD", "ED"),
  Delta,
  p,
  pVal = TRUE,
  alternative = c("one.sided", "two.sided"),
  na.action = na.fail,
  mvtcontrol = mvtnorm.control(),
  bnds,
  control = NULL,
  offset = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MCPModGen_+3A_family">family</code></td>
<td>
<p>A character string containing the error distribution to be used
in the model.</p>
</td></tr>
<tr><td><code id="MCPModGen_+3A_link">link</code></td>
<td>
<p>A character string for the model link function.</p>
</td></tr>
<tr><td><code id="MCPModGen_+3A_returns">returnS</code></td>
<td>
<p>Logical determining whether muHat and SHat should be returned,
in additional to the MCPMod output.</p>
</td></tr>
<tr><td><code id="MCPModGen_+3A_w">w</code></td>
<td>
<p>Either a numeric vector of the same length as dose and resp, or a
character vector denoting the column name in the data.</p>
</td></tr>
<tr><td><code id="MCPModGen_+3A_dose">dose</code>, <code id="MCPModGen_+3A_resp">resp</code></td>
<td>
<p>Either vectors of equal length specifying dose and response
values, or character vectors specifying the names of variables in the data
frame specified in <code>data</code>.</p>
</td></tr>
<tr><td><code id="MCPModGen_+3A_data">data</code></td>
<td>
<p>Data frame with names specified in 'dose', 'resp', and optionally
'w'. If data is not specified, it is assumed that 'dose' and 'resp' are
numerical vectors</p>
</td></tr>
<tr><td><code id="MCPModGen_+3A_models">models</code></td>
<td>

<p>An object of class &lsquo;<span class="samp">&#8288;"Mods"&#8288;</span>&rsquo;, see <code><a href="DoseFinding.html#topic+Mods">Mods</a></code> for
details
</p>
</td></tr>
<tr><td><code id="MCPModGen_+3A_addcovars">addCovars</code></td>
<td>
<p>Formula specifying additive linear covariates (e.g. '~
factor(gender)').</p>
</td></tr>
<tr><td><code id="MCPModGen_+3A_placadj">placAdj</code></td>
<td>
<p>Logical specifying whether the provided by 'resp' are to be
treated as placebo-adjusted estimates.</p>
</td></tr>
<tr><td><code id="MCPModGen_+3A_selmodel">selModel</code></td>
<td>

<p>Optional character vector specifying the model selection criterion for
dose estimation.  Possible values are 
</p>

<ul>
<li> <p><code>AIC</code>: Selects model with smallest AIC (this is the default)
</p>
</li>
<li> <p><code>maxT</code>: Selects the model corresponding to the largest t-statistic.
</p>
</li>
<li> <p><code>aveAIC</code>: Uses a weighted average of the models corresponding to the
significant contrasts.  The model weights are chosen by the formula:
<code class="reqn">w_i = \exp(-0.5AIC_i)/\sum_i(\exp(-0.5AIC_i))</code>
See Buckland et al. (1997) for details.
</p>
</li></ul>

<p>For &lsquo;<span class="samp">&#8288;type = "general"&#8288;</span>&rsquo; the &quot;gAIC&quot; is used.
</p>
</td></tr>
<tr><td><code id="MCPModGen_+3A_alpha">alpha</code></td>
<td>

<p>Significance level for the multiple contrast test
</p>
</td></tr>
<tr><td><code id="MCPModGen_+3A_df">df</code></td>
<td>
<p>An optional numeric value specifying the degrees of freedom.
Infinite degrees of freedom ('df=Inf', the default), correspond to the
multivariate normal distribution.</p>
</td></tr>
<tr><td><code id="MCPModGen_+3A_critv">critV</code></td>
<td>

<p>Supply a pre-calculated critical value. If this argument is NULL, no
critical value will be calculated and the test decision is based on
the p-values. If &lsquo;<span class="samp">&#8288;critV = TRUE&#8288;</span>&rsquo; the critical value will be calculated. 
</p>
</td></tr>
<tr><td><code id="MCPModGen_+3A_dosetype">doseType</code></td>
<td>

<p>&lsquo;<span class="samp">&#8288;doseType&#8288;</span>&rsquo; determines the dose to estimate, ED or TD (see also
<code><a href="DoseFinding.html#topic+Mods">Mods</a></code>), and &lsquo;<span class="samp">&#8288;Delta&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;p&#8288;</span>&rsquo; need to be
specified depending on whether TD or ED is to be estimated.
See <code><a href="DoseFinding.html#topic+TD">TD</a></code> and <code><a href="DoseFinding.html#topic+ED">ED</a></code> for details.
</p>
</td></tr>
<tr><td><code id="MCPModGen_+3A_delta">Delta</code></td>
<td>

<p>&lsquo;<span class="samp">&#8288;doseType&#8288;</span>&rsquo; determines the dose to estimate, ED or TD (see also
<code><a href="DoseFinding.html#topic+Mods">Mods</a></code>), and &lsquo;<span class="samp">&#8288;Delta&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;p&#8288;</span>&rsquo; need to be
specified depending on whether TD or ED is to be estimated.
See <code><a href="DoseFinding.html#topic+TD">TD</a></code> and <code><a href="DoseFinding.html#topic+ED">ED</a></code> for details.
</p>
</td></tr>
<tr><td><code id="MCPModGen_+3A_p">p</code></td>
<td>

<p>&lsquo;<span class="samp">&#8288;doseType&#8288;</span>&rsquo; determines the dose to estimate, ED or TD (see also
<code><a href="DoseFinding.html#topic+Mods">Mods</a></code>), and &lsquo;<span class="samp">&#8288;Delta&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;p&#8288;</span>&rsquo; need to be
specified depending on whether TD or ED is to be estimated.
See <code><a href="DoseFinding.html#topic+TD">TD</a></code> and <code><a href="DoseFinding.html#topic+ED">ED</a></code> for details.
</p>
</td></tr>
<tr><td><code id="MCPModGen_+3A_pval">pVal</code></td>
<td>

<p>Logical determining, whether p-values should be calculated.
</p>
</td></tr>
<tr><td><code id="MCPModGen_+3A_alternative">alternative</code></td>
<td>

<p>Character determining the alternative for the multiple contrast
trend test. 
</p>
</td></tr>
<tr><td><code id="MCPModGen_+3A_na.action">na.action</code></td>
<td>

<p>A function which indicates what should happen when
the data contain NAs.
</p>
</td></tr>
<tr><td><code id="MCPModGen_+3A_mvtcontrol">mvtcontrol</code></td>
<td>

<p>A list specifying additional control parameters for the &lsquo;<span class="samp">&#8288;qmvt&#8288;</span>&rsquo;
and &lsquo;<span class="samp">&#8288;pmvt&#8288;</span>&rsquo; calls in the code, see also <code><a href="DoseFinding.html#topic+mvtnorm.control">mvtnorm.control</a></code>
for details.
</p>
</td></tr>
<tr><td><code id="MCPModGen_+3A_bnds">bnds</code></td>
<td>

<p>Bounds for non-linear parameters. This needs to be a list with list
entries corresponding to the selected bounds. The names of the list
entries need to correspond to the model names. The
<code><a href="DoseFinding.html#topic+defBnds">defBnds</a></code> function provides the default selection.
</p>
</td></tr>
<tr><td><code id="MCPModGen_+3A_control">control</code></td>
<td>

<p>Control list for the optimization.<br />
A list with entries: &quot;nlminbcontrol&quot;, &quot;optimizetol&quot; and &quot;gridSize&quot;.
</p>
<p>The entry nlminbcontrol needs to be a list and is passed directly to
control argument in the nlminb function, that is used internally for
models with 2 nonlinear parameters (e.g. sigmoid Emax or beta model).
</p>
<p>The entry optimizetol is passed directly to the tol argument of the
optimize function, which is used for models with 1 nonlinear
parameters (e.g. Emax or exponential model).
</p>
<p>The entry gridSize needs to be a list with entries dim1 and dim2
giving the size of the grid for the gridsearch in 1d or 2d models.
</p>
</td></tr>
<tr><td><code id="MCPModGen_+3A_offset">offset</code></td>
<td>
<p>Either a numeric vector of the same length as dose and resp, or
a character vector denoting the column name in the data.</p>
</td></tr>
<tr><td><code id="MCPModGen_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to <code>glm</code> or <code>glm.nb</code>.
This is especially useful when a fitting error is returned. In these cases,
it may be useful to supply a <code>start</code> vector for the parameters.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function works by first fitting a glm with the chosen family and link.
The <code class="reqn">\mu</code> vector and <code class="reqn">S</code> matrix are extracted from the glm, and these
values are supplied to the MCPMod function, along with all user-defined
arguments. <br /> Currently, the function can take the negative binomial and
Poisson family with a log, sqrt, identity, risk ratio, and log risk ratio
links, or a bernoulli family with a log, logit, probit, cauchit,
cloglog-link, identity, risk ratio, and log risk ratio links.
</p>


<h3>Value</h3>

<p>An object of class MCPMod if 'returnS = FALSE'. Otherwise, a list
containing an object of class MCPMod, the numeric vector <code class="reqn">\mu</code>, and the
numeric matrix <code class="reqn">S</code>.
</p>


<h3>References</h3>

<p>Buckland, S. T., Burnham, K. P. and Augustin, N. H. (1997). Model
selection an integral part of inference, <em>Biometrics</em>, <b>53</b>,
603&ndash;618
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Analyze the binary migraine data from the DoseFinding package.
data(migraine)
models = Mods(linear = NULL, emax = 1, quadratic = c(-0.004), doses = migraine$dose)

# Now analyze using binomial weights
PFrate &lt;- migraine$painfree/migraine$ntrt
migraine$pfrat = migraine$painfree / migraine$ntrt
MCPModGen("binomial","logit",returnS = TRUE, w = "ntrt", dose = "dose",
   resp = "pfrat", data = migraine, models = models, selModel = "aveAIC",
   Delta = 0.2)
</code></pre>

<hr>
<h2 id='MCPModGeneral-package'>
A Supplement to the <code>DoseFinding</code> Package for the General Case
</h2><span id='topic+MCPModGeneral-package'></span><span id='topic+MCPModGeneral'></span>

<h3>Description</h3>

<p>Analyzes non-normal data via the Multiple Comparison Procedures and Modeling approach ('MCP-Mod'). Many functions rely on the 'DoseFinding' package. This package makes it so the user does not need to prespecify or calculate the <code class="reqn">\mu</code> vector and <code class="reqn">S</code> matrix. Instead, the user typically supplies the data in its raw form, and this package will calculate the needed objects and pass them into the &lsquo;DoseFinding' functions. If the user wishes to primarily use the functions provided in the 'DoseFinding' package, a singular function ('prepareGen') will provide mu and S. The package currently handles power analysis and the &rsquo;MCP-Mod' procedure for negative binomial, Poisson, and binomial data. The 'MCP-Mod' procedure can also be applied to survival data, but power analysis is not available.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
    Package: </td><td style="text-align: left;"> MCPModGeneral</td>
</tr>
<tr>
 <td style="text-align: left;">
    Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
    Version: </td><td style="text-align: left;"> 0.1-1 </td>
</tr>
<tr>
 <td style="text-align: left;">
    Date: </td><td style="text-align: left;"> 2020-2-9</td>
</tr>
<tr>
 <td style="text-align: left;">
    License: </td><td style="text-align: left;"> GPL-3
  </td>
</tr>

</table>

<p>The main functions are:<br />
<b><code><a href="#topic+prepareGen">prepareGen</a></code></b>: Calculates the <code class="reqn">\mu</code> vector and <code class="reqn">S</code> matrix to be supplied to regular <code>MCPMod</code> functions (e.g. <code>MCPMod</code>, <code>MCTtest</code>, <code>planMod</code>)<br />
<b><code><a href="#topic+MCPModGen">MCPModGen</a></code></b>: Implements the full <code>MCPMod</code> procedure for raw negative binomial and binary data.<br />
<b><code><a href="#topic+planModPrepare">planModPrepare</a></code></b>: Calculate the theoretical covariance matrix <code class="reqn">S</code>.<br />
<b><code><a href="#topic+powMCTGen">powMCTGen</a></code></b>: Calculates the power of the multiple contrast test.<br />
<b><code><a href="#topic+sampSizeMCTGen">sampSizeMCTGen</a></code></b>: Calculates the sample size needed to reach the target power.<br />
</p>
<p>The secondary functions are:<br />
<b><code><a href="#topic+MCPModSurv">MCPModSurv</a></code></b>: Implements the full <code>MCPMod</code> procedure for basic survival data. This includes a Cox-PH model and parametric survival regression models. Power analysis is not available for the survival data.<br />
<b><code><a href="#topic+simS">simS</a></code></b>: A simulation based method for estimating the theoretical covariance matrices.
</p>


<h3>Author(s)</h3>

<p>Ian Laga
</p>
<p>Maintainer: Ian Laga &lt;ilaga25@gmail.com&gt;
</p>


<h3>References</h3>

<p>Pinheiro, J. C., Bornkamp, B., Glimm, E. and Bretz, F. (2014)
Model-based dose finding under model uncertainty using general
parametric models, <em>Statistics in Medicine</em>, <b>33</b>,
1646&ndash;1661
</p>
<p>Buckland, S. T., Burnham, K. P. and Augustin, N. H. (1997). Model selection an integral part
of inference, <em>Biometrics</em>, <b>53</b>, 603&ndash;618
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  # Analyze the binary migraine data from the DoseFinding package.
  data(migraine)
  models = Mods(linear = NULL, emax = 1, quadratic = c(-0.004),
                doses = migraine$dose)

  powMCTGen(migraine$ntrt, "binomial", "logit",
            Ntype = "actual", altModels = models)
  sampSizeMCTGen("binomial", "logit", altModels = models, power = 0.8,
                 Ntype = "arm", upperN = 30, verbose = TRUE)

  # Now analyze using binomial weights
  PFrate &lt;- migraine$painfree/migraine$ntrt
  migraine$pfrat = migraine$painfree / migraine$ntrt
  MCPModGen("binomial","logit",returnS = TRUE, w = "ntrt", dose = "dose",
     resp = "pfrat", data = migraine, models = models, selModel = "aveAIC",
     Delta = 0.2)
</code></pre>

<hr>
<h2 id='MCPModSurv'>MCPModSurv - Multiple Comparison and Modeling for Coxph and Parametric
Survival Models</h2><span id='topic+MCPModSurv'></span>

<h3>Description</h3>

<p>This function allows the user to implement the MCPMod function on a Cox
proportional hazards regression model and a parametric survival model. The
function works very similarly to
<code><a href="#topic+MCPModGen">MCPModGen</a></code>, but is unique enough in
terms of the data and the parameters to warrant its own function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MCPModSurv(
  model = c("coxph", "parametric"),
  dist = NULL,
  returnS = FALSE,
  dose,
  resp,
  status,
  data = NULL,
  models,
  placAdj = FALSE,
  selModel = c("AIC", "maxT", "aveAIC"),
  alpha = 0.025,
  df = NULL,
  critV = NULL,
  doseType = c("TD", "ED"),
  Delta,
  p,
  pVal = TRUE,
  alternative = c("one.sided", "two.sided"),
  na.action = na.fail,
  mvtcontrol = mvtnorm.control(),
  bnds,
  control = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MCPModSurv_+3A_model">model</code></td>
<td>
<p>A character string containing the survival regression model.</p>
</td></tr>
<tr><td><code id="MCPModSurv_+3A_dist">dist</code></td>
<td>
<p>A character string for the distribution, in the case when
<code>model</code> is &quot;parametric&quot;. Must be one of &quot;<code>weibull</code>&quot;,
&quot;<code>exponential</code>&quot;, &quot;<code>gaussian</code>&quot;, &quot;<code>logistic</code>&quot;,
&quot;<code>lognormal</code>&quot;, or &quot;<code>loglogistic</code>&quot;.</p>
</td></tr>
<tr><td><code id="MCPModSurv_+3A_returns">returnS</code></td>
<td>
<p>Logical determining whether muHat and SHat should be returned,
in additional to the MCPMod output.</p>
</td></tr>
<tr><td><code id="MCPModSurv_+3A_dose">dose</code>, <code id="MCPModSurv_+3A_resp">resp</code>, <code id="MCPModSurv_+3A_status">status</code></td>
<td>
<p>Either character strings specifying the names of the
respective columns in the <code>data</code> data frame, or numeric vectors of
equal length containing their respective values. <code>status</code> refers to
whether an observation was censored or not. If no observations were
censored, <code>status</code> should be a vector of 1s.</p>
</td></tr>
<tr><td><code id="MCPModSurv_+3A_data">data</code></td>
<td>
<p>Data frame with names specified in 'dose', 'resp', and optionally
'w'. If data is not specified, it is assumed that 'dose' and 'resp' are
numerical vectors</p>
</td></tr>
<tr><td><code id="MCPModSurv_+3A_models">models</code></td>
<td>

<p>An object of class &lsquo;<span class="samp">&#8288;"Mods"&#8288;</span>&rsquo;, see <code><a href="DoseFinding.html#topic+Mods">Mods</a></code> for
details
</p>
</td></tr>
<tr><td><code id="MCPModSurv_+3A_placadj">placAdj</code></td>
<td>
<p>Logical specifying whether the provided by 'resp' are to be
treated as placebo-adjusted estimates.</p>
</td></tr>
<tr><td><code id="MCPModSurv_+3A_selmodel">selModel</code></td>
<td>

<p>Optional character vector specifying the model selection criterion for
dose estimation.  Possible values are 
</p>

<ul>
<li> <p><code>AIC</code>: Selects model with smallest AIC (this is the default)
</p>
</li>
<li> <p><code>maxT</code>: Selects the model corresponding to the largest t-statistic.
</p>
</li>
<li> <p><code>aveAIC</code>: Uses a weighted average of the models corresponding to the
significant contrasts.  The model weights are chosen by the formula:
<code class="reqn">w_i = \exp(-0.5AIC_i)/\sum_i(\exp(-0.5AIC_i))</code>
See Buckland et al. (1997) for details.
</p>
</li></ul>

<p>For &lsquo;<span class="samp">&#8288;type = "general"&#8288;</span>&rsquo; the &quot;gAIC&quot; is used.
</p>
</td></tr>
<tr><td><code id="MCPModSurv_+3A_alpha">alpha</code></td>
<td>

<p>Significance level for the multiple contrast test
</p>
</td></tr>
<tr><td><code id="MCPModSurv_+3A_df">df</code></td>
<td>
<p>An optional numeric value specifying the degrees of freedom.
Infinite degrees of freedom ('df=Inf', the default), correspond to the
multivariate normal distribution.</p>
</td></tr>
<tr><td><code id="MCPModSurv_+3A_critv">critV</code></td>
<td>

<p>Supply a pre-calculated critical value. If this argument is NULL, no
critical value will be calculated and the test decision is based on
the p-values. If &lsquo;<span class="samp">&#8288;critV = TRUE&#8288;</span>&rsquo; the critical value will be calculated. 
</p>
</td></tr>
<tr><td><code id="MCPModSurv_+3A_dosetype">doseType</code></td>
<td>

<p>&lsquo;<span class="samp">&#8288;doseType&#8288;</span>&rsquo; determines the dose to estimate, ED or TD (see also
<code><a href="DoseFinding.html#topic+Mods">Mods</a></code>), and &lsquo;<span class="samp">&#8288;Delta&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;p&#8288;</span>&rsquo; need to be
specified depending on whether TD or ED is to be estimated.
See <code><a href="DoseFinding.html#topic+TD">TD</a></code> and <code><a href="DoseFinding.html#topic+ED">ED</a></code> for details.
</p>
</td></tr>
<tr><td><code id="MCPModSurv_+3A_delta">Delta</code></td>
<td>

<p>&lsquo;<span class="samp">&#8288;doseType&#8288;</span>&rsquo; determines the dose to estimate, ED or TD (see also
<code><a href="DoseFinding.html#topic+Mods">Mods</a></code>), and &lsquo;<span class="samp">&#8288;Delta&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;p&#8288;</span>&rsquo; need to be
specified depending on whether TD or ED is to be estimated.
See <code><a href="DoseFinding.html#topic+TD">TD</a></code> and <code><a href="DoseFinding.html#topic+ED">ED</a></code> for details.
</p>
</td></tr>
<tr><td><code id="MCPModSurv_+3A_p">p</code></td>
<td>

<p>&lsquo;<span class="samp">&#8288;doseType&#8288;</span>&rsquo; determines the dose to estimate, ED or TD (see also
<code><a href="DoseFinding.html#topic+Mods">Mods</a></code>), and &lsquo;<span class="samp">&#8288;Delta&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;p&#8288;</span>&rsquo; need to be
specified depending on whether TD or ED is to be estimated.
See <code><a href="DoseFinding.html#topic+TD">TD</a></code> and <code><a href="DoseFinding.html#topic+ED">ED</a></code> for details.
</p>
</td></tr>
<tr><td><code id="MCPModSurv_+3A_pval">pVal</code></td>
<td>

<p>Logical determining, whether p-values should be calculated.
</p>
</td></tr>
<tr><td><code id="MCPModSurv_+3A_alternative">alternative</code></td>
<td>

<p>Character determining the alternative for the multiple contrast
trend test. 
</p>
</td></tr>
<tr><td><code id="MCPModSurv_+3A_na.action">na.action</code></td>
<td>

<p>A function which indicates what should happen when
the data contain NAs.
</p>
</td></tr>
<tr><td><code id="MCPModSurv_+3A_mvtcontrol">mvtcontrol</code></td>
<td>

<p>A list specifying additional control parameters for the &lsquo;<span class="samp">&#8288;qmvt&#8288;</span>&rsquo;
and &lsquo;<span class="samp">&#8288;pmvt&#8288;</span>&rsquo; calls in the code, see also <code><a href="DoseFinding.html#topic+mvtnorm.control">mvtnorm.control</a></code>
for details.
</p>
</td></tr>
<tr><td><code id="MCPModSurv_+3A_bnds">bnds</code></td>
<td>

<p>Bounds for non-linear parameters. This needs to be a list with list
entries corresponding to the selected bounds. The names of the list
entries need to correspond to the model names. The
<code><a href="DoseFinding.html#topic+defBnds">defBnds</a></code> function provides the default selection.
</p>
</td></tr>
<tr><td><code id="MCPModSurv_+3A_control">control</code></td>
<td>

<p>Control list for the optimization.<br />
A list with entries: &quot;nlminbcontrol&quot;, &quot;optimizetol&quot; and &quot;gridSize&quot;.
</p>
<p>The entry nlminbcontrol needs to be a list and is passed directly to
control argument in the nlminb function, that is used internally for
models with 2 nonlinear parameters (e.g. sigmoid Emax or beta model).
</p>
<p>The entry optimizetol is passed directly to the tol argument of the
optimize function, which is used for models with 1 nonlinear
parameters (e.g. Emax or exponential model).
</p>
<p>The entry gridSize needs to be a list with entries dim1 and dim2
giving the size of the grid for the gridsearch in 1d or 2d models.
</p>
</td></tr>
<tr><td><code id="MCPModSurv_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to <code>coxph</code> or
<code>survreg</code>. This is especially useful when a fitting error is returned.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>'MCPModSurv' works by making calls to 'coxph', 'survreg', and 'Surv' from the
'survival' package. After retrieving coefficient estimates and the estimated
covariance matrix, values are passed into the 'MCPMod' function from the
'DoseFinding' package.
</p>


<h3>Value</h3>

<p>An object of class MCPMod if returnS = FALSE. Otherwise, a list
containing an object of class MCPMod, the numeric vector <code class="reqn">\mu</code>, and the
numeric matrix <code class="reqn">S</code>.
</p>

<hr>
<h2 id='planModPrepare'>Return the S Matrix for a Theoretical DR-Curve</h2><span id='topic+planModPrepare'></span>

<h3>Description</h3>

<p>This function is useful for several <code>DoseFinding</code> functions, but
particular for <code>planMod</code>. Given the true dose-response curve at
specified doses, this function will calculate and return the S matrix
associated with the specified distribution. If an object of class <code>Mods</code>
is provided in the <code>models</code> argument, then a list of S matrices will be
returned.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>planModPrepare(
  nSample,
  family = c("negative binomial", "binomial", "poisson"),
  link = c("log", "logit", "sqrt", "probit", "cauchit", "cloglog", "identity",
    "risk ratio", "log risk ratio"),
  modelPar = NULL,
  theoResp = NULL,
  doses = NULL,
  Ntype = c("arm", "total", "actual"),
  alRatio = NULL,
  placEff = NULL,
  models = NULL,
  verbose = FALSE,
  offset = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="planModPrepare_+3A_nsample">nSample</code></td>
<td>
<p>An integer if <code>Ntype</code> is 'arm' or 'total', or a numerical
vector of patient allocations for each arm if <code>Ntype</code> is 'actual'.</p>
</td></tr>
<tr><td><code id="planModPrepare_+3A_family">family</code></td>
<td>
<p>A character string containing the error distribution to be used
in the model.</p>
</td></tr>
<tr><td><code id="planModPrepare_+3A_link">link</code></td>
<td>
<p>A character string for the model link function.</p>
</td></tr>
<tr><td><code id="planModPrepare_+3A_modelpar">modelPar</code></td>
<td>
<p>A numeric vector containing the additional parameters for the
family argument. If the family is negative binomial, the dispersion
parameter should be supplied. If the family is binomial, no model parameter
should be supplied.</p>
</td></tr>
<tr><td><code id="planModPrepare_+3A_theoresp">theoResp</code></td>
<td>
<p>A numerical vector of theoretical response values, on the
transformed scale (e.g. on the log-scale for the negative binomial family).
This should be the same length as the doses argument.</p>
</td></tr>
<tr><td><code id="planModPrepare_+3A_doses">doses</code></td>
<td>
<p>A numerical vector of doses, corresponding to the theoretical
response values provided.</p>
</td></tr>
<tr><td><code id="planModPrepare_+3A_ntype">Ntype</code></td>
<td>
<p>One of 'arm', 'total', or 'actual'. See documentation for
<code>Ntype</code> in <code><a href="DoseFinding.html#topic+powMCT">powMCT</a></code> for descriptions
of 'arm' and 'total'. For 'actual', the nSample should be a numerical
vector containing the actual patient allocation for each dose provided.</p>
</td></tr>
<tr><td><code id="planModPrepare_+3A_alratio">alRatio</code></td>
<td>
<p>A numeric vector specifying the ratios between the patient
allocation for the specified doses.</p>
</td></tr>
<tr><td><code id="planModPrepare_+3A_placeff">placEff</code></td>
<td>
<p>A numeric value of the placebo effect. This is needed only
when the link is risk ratio.</p>
</td></tr>
<tr><td><code id="planModPrepare_+3A_models">models</code></td>
<td>
<p>Instead of supplying a theoretical dose-response curve and
doses, an object of class <code>Mods</code> may be provided. The doses will be
pulled from this object, along with the responses at the doses.</p>
</td></tr>
<tr><td><code id="planModPrepare_+3A_verbose">verbose</code></td>
<td>
<p>A logical specifying whether the patient allocation should be
printed, in addition to the results.</p>
</td></tr>
<tr><td><code id="planModPrepare_+3A_offset">offset</code></td>
<td>
<p>A positive numeric value specifying the offset term for the
negative binomial distribution. If offset = NULL (the default), then the
offset has no effect. Theoretically, the offset should be a numeric vector
the same length as the number of observations, but for planning purposes,
it is unlikely to know the individual offsets in advance.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric S matrix, or a list S matrices, for each model is
<code>models</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dose.vec = c(0, 5, 10, 20, 30, 40)
models.full = Mods(doses = dose.vec, linear = NULL,
      sigEmax = rbind(c(9, 2), c(6, 3)),
      emax = 0.8,
      quadratic = -0.02,
      placEff = 0, maxEff = 2)
planModPrepare(30, 'negative binomial', 'log', 0.3, getResp(models.full)[,3],
      dose.vec, 'arm')
</code></pre>

<hr>
<h2 id='powMCTGen'>Calculate Power for Multiple Contrast Test (General Case)</h2><span id='topic+powMCTGen'></span>

<h3>Description</h3>

<p>Like the powMCT function, this function allows the user to calculate power
for a multiple contrast test for a set of specified alternatives for the
general case, but without specifying and S matrix. The user supplies the
patient allocation, the alternative models, and any parameters needed for the
distribution family (e.g. the dispersion parameter for the negative binomial
distribution). The function works by calculating the <code class="reqn">\mu</code> and <code class="reqn">S</code> for each
model in the alternative models and supplying the calculated values to the
powMCT function from the DoseFinding package, forwarding relevant arguments.
<br /> This function also allows a new Ntype, namely 'actual'. If nSample is a
vector and Ntype is 'actual', the function interprets nSample to be the exact
patient allocation. This is useful for slightly modifying patient allocation
and avoiding messy ratios. <br /> Furthermore, the function also accepts a
theoResp and doses argument, which together describe the theoretical
dose-response relationship. The returned power is the probability of
accepting at least one of the models specified in altModels.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powMCTGen(
  nSample,
  family = c("negative binomial", "binomial", "poisson"),
  link = c("log", "logit", "sqrt", "probit", "cauchit", "cloglog", "identity",
    "risk ratio", "log risk ratio"),
  modelPar = NULL,
  placEff = NULL,
  theoResp = NULL,
  doses = NULL,
  Ntype = c("arm", "total", "actual"),
  alRatio = NULL,
  altModels,
  alpha = 0.025,
  df = NULL,
  critV = TRUE,
  alternative = c("one.sided", "two.sided"),
  verbose = FALSE,
  offset = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="powMCTGen_+3A_nsample">nSample</code></td>
<td>
<p>An integer if <code>Ntype</code> is 'arm' or 'total', or a numerical
vector of patient allocations for each arm if <code>Ntype</code> is 'actual'.</p>
</td></tr>
<tr><td><code id="powMCTGen_+3A_family">family</code></td>
<td>
<p>A character string containing the error distribution to be used
in the model.</p>
</td></tr>
<tr><td><code id="powMCTGen_+3A_link">link</code></td>
<td>
<p>A character string for the model link function.</p>
</td></tr>
<tr><td><code id="powMCTGen_+3A_modelpar">modelPar</code></td>
<td>
<p>A numeric vector containing the additional parameters for the
family argument. If the family is negative binomial, the dispersion
parameter should be supplied. If the family is binomial, no model parameter
should be supplied.</p>
</td></tr>
<tr><td><code id="powMCTGen_+3A_placeff">placEff</code></td>
<td>
<p>A numeric value specifying the mean response at the placebo
This is required if <code>link</code> = 'risk ratio' and ignored otherwise.</p>
</td></tr>
<tr><td><code id="powMCTGen_+3A_theoresp">theoResp</code></td>
<td>
<p>A numerical vector of theoretical response values, on the
transformed scale (e.g. on the log-scale for the negative binomial family).
This should be the same length as the doses argument.</p>
</td></tr>
<tr><td><code id="powMCTGen_+3A_doses">doses</code></td>
<td>
<p>A numerical vector of doses, corresponding to the theoretical
response values provided.</p>
</td></tr>
<tr><td><code id="powMCTGen_+3A_ntype">Ntype</code></td>
<td>
<p>One of 'arm', 'total', or 'actual'. See documentation for
<code>Ntype</code> in <code><a href="DoseFinding.html#topic+powMCT">powMCT</a></code> for descriptions
of 'arm' and 'total'. For 'actual', the nSample should be a numerical
vector containing the actual patient allocation for each dose provided.</p>
</td></tr>
<tr><td><code id="powMCTGen_+3A_alratio">alRatio</code></td>
<td>
<p>Vector describing the relative patient allocations to the dose
groups up to proportionality, e.g. <code>rep(1, length(doses))</code> corresponds
to balanced allocations.</p>
</td></tr>
<tr><td><code id="powMCTGen_+3A_altmodels">altModels</code></td>
<td>
<p>An object of class <code>Mods</code>, defining the mean vectors
under which the power should be calculated.</p>
</td></tr>
<tr><td><code id="powMCTGen_+3A_alpha">alpha</code></td>
<td>
<p>Significance level to use.</p>
</td></tr>
<tr><td><code id="powMCTGen_+3A_df">df</code></td>
<td>
<p>Degrees of freedom to assume.</p>
</td></tr>
<tr><td><code id="powMCTGen_+3A_critv">critV</code></td>
<td>
<p>Critical value, if equal to <code>TRUE</code> the critical value will
be calculated. Otherwise one can directly specify the critical value here.</p>
</td></tr>
<tr><td><code id="powMCTGen_+3A_alternative">alternative</code></td>
<td>
<p>Character determining the alternative for the multiple
contrast trend test.</p>
</td></tr>
<tr><td><code id="powMCTGen_+3A_verbose">verbose</code></td>
<td>
<p>A logical specifying whether the patient allocation should be
printed, in addition to the results.</p>
</td></tr>
<tr><td><code id="powMCTGen_+3A_offset">offset</code></td>
<td>
<p>A positive numeric value specifying the offset term for the
negative binomial distribution. If offset = 1 (the default), then the
offset has no effect. Theoretically, the offset should be a numeric vector
the same length as the number of observations, but for planning purposes,
it is unlikely to know the individual offsets in advance.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric containing the calculated power values
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dose.vec = c(0, 5, 10, 20, 30, 40)
models.full = Mods(doses = dose.vec, linear = NULL,
      sigEmax = rbind(c(9, 2), c(6, 3)),
      emax = 0.8,
      quadratic = -0.02,
      placEff = 0, maxEff = 2)
## Calculate the power using the responses and doses specified in Mods
powMCTGen(30, 'negative binomial', 'log', modelPar = 0.1, Ntype = 'arm',
      alpha = 0.05, altModels = models.full)
## Calculate the power at theoretical dose-response values
powMCTGen(30, 'negative binomial', 'log', modelPar = 0.1,
      theoResp = c(0, 0.01, 0.02, 1, 1.6, 1.8), doses = c(0, 10, 20, 30, 40, 50),
      alpha = 0.05, altModels = models.full)
</code></pre>

<hr>
<h2 id='prepareGen'>Prepare General Data for the MCPMod Function</h2><span id='topic+prepareGen'></span>

<h3>Description</h3>

<p>This function serves as an alternative for using the MCPModGen function
directly for general data. The function returns the estimates for <code class="reqn">\mu</code> and
<code class="reqn">S</code>, which are needed for MCPMod.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prepareGen(
  family = c("negative binomial", "binomial", "poisson"),
  link = c("log", "logit", "probit", "cauchit", "cloglog", "identity", "log risk ratio",
    "risk ratio", "sqrt"),
  w = NULL,
  dose,
  resp,
  data = NULL,
  addCovars = ~1,
  placAdj = FALSE,
  offset = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prepareGen_+3A_family">family</code></td>
<td>
<p>A character string containing the error distribution to be used
in the model.</p>
</td></tr>
<tr><td><code id="prepareGen_+3A_link">link</code></td>
<td>
<p>A character string for the model link function.</p>
</td></tr>
<tr><td><code id="prepareGen_+3A_w">w</code></td>
<td>
<p>Either a numeric vector of the same length as dose and resp, or a
character vector denoting the column name in the data.</p>
</td></tr>
<tr><td><code id="prepareGen_+3A_dose">dose</code></td>
<td>
<p>Either vectors of equal length specifying dose and response
values, or character vectors specifying the names of variables in the data
frame specified in <code>data</code>.</p>
</td></tr>
<tr><td><code id="prepareGen_+3A_resp">resp</code></td>
<td>
<p>Either vectors of equal length specifying dose and response
values, or character vectors specifying the names of variables in the data
frame specified in <code>data</code>.</p>
</td></tr>
<tr><td><code id="prepareGen_+3A_data">data</code></td>
<td>
<p>Data frame with names specified in 'dose', 'resp', and optionally
'w'. If data is not specified, it is assumed that 'dose' and 'resp' are
numerical vectors</p>
</td></tr>
<tr><td><code id="prepareGen_+3A_addcovars">addCovars</code></td>
<td>
<p>Formula specifying additive linear covariates (e.g. '~
factor(gender)').</p>
</td></tr>
<tr><td><code id="prepareGen_+3A_placadj">placAdj</code></td>
<td>
<p>Logical specifying whether the provided by 'resp' are to be
treated as placebo-adjusted estimates.</p>
</td></tr>
<tr><td><code id="prepareGen_+3A_offset">offset</code></td>
<td>
<p>Either a numeric vector of the same length as dose and resp, or a
character vector denoting the column name in the data.</p>
</td></tr>
<tr><td><code id="prepareGen_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to <code>glm</code> or <code>glm.nb</code>.
This is especially useful when a fitting error is returned. In these cases,
it may be useful to supply a <code>start</code> vector for the parameters.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the <code class="reqn">\mu</code> vector and <code class="reqn">S</code> matrix.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Analyze the binary migraine data from the DoseFinding package.
data(migraine)
models = Mods(linear = NULL, emax = 1, quadratic = c(-0.004), doses = migraine$dose)

# Now analyze using binomial weights
PFrate &lt;- migraine$painfree/migraine$ntrt
migraine$pfrat = migraine$painfree / migraine$ntrt
muS = prepareGen("binomial", "logit", w = "ntrt", dose = "dose",
                 resp = "pfrat", data = migraine)
## Look at the elements of muS
muS
MCPMod(muS$data$dose, muS$data$resp, models = models, S = muS$S,
       type = "general", selModel = "aveAIC",Delta = 0.2)
</code></pre>

<hr>
<h2 id='sampSizeMCTGen'>Sample Size Calculations (General Case)</h2><span id='topic+sampSizeMCTGen'></span>

<h3>Description</h3>

<p>This function build on the <code>sampSizeMCT</code> function in the
<code>DoseFinding</code> package, allowing the procedure to work with the
<code>powMCTGen</code> function for the general case.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sampSizeMCTGen(
  family = c("negative binomial", "binomial", "poisson"),
  link = c("log", "logit", "probit", "cauchit", "cloglog", "log risk ratio",
    "risk ratio"),
  modelPar = NULL,
  theoResp = NULL,
  doses = NULL,
  upperN,
  lowerN = floor(upperN/2),
  Ntype = c("arm", "total"),
  alRatio = NULL,
  altModels,
  alpha = 0.025,
  power = 0.8,
  sumFct = c("min", "mean", "max"),
  verbose = FALSE,
  tol = 0.001
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sampSizeMCTGen_+3A_family">family</code></td>
<td>
<p>A character string containing the error distribution to be used
in the model.</p>
</td></tr>
<tr><td><code id="sampSizeMCTGen_+3A_link">link</code></td>
<td>
<p>A character string for the model link function.</p>
</td></tr>
<tr><td><code id="sampSizeMCTGen_+3A_modelpar">modelPar</code></td>
<td>
<p>A numeric vector containing the additional parameters for the
family argument. If the family is negative binomial, the dispersion
parameter should be supplied. If the family is binomial, no model parameter
should be supplied.</p>
</td></tr>
<tr><td><code id="sampSizeMCTGen_+3A_theoresp">theoResp</code></td>
<td>
<p>A numerical vector of theoretical response values, on the
transformed scale (e.g. on the log-scale for the negative binomial family).
This should be the same length as the doses argument.</p>
</td></tr>
<tr><td><code id="sampSizeMCTGen_+3A_doses">doses</code></td>
<td>
<p>A numerical vector of doses, corresponding to the theoretical
response values provided.</p>
</td></tr>
<tr><td><code id="sampSizeMCTGen_+3A_uppern">upperN</code>, <code id="sampSizeMCTGen_+3A_lowern">lowerN</code></td>
<td>
<p>Upper and lower bound for the power sample size.
<code>lowerN</code> defaults to <code>floor(upperN/2)</code>.</p>
</td></tr>
<tr><td><code id="sampSizeMCTGen_+3A_ntype">Ntype</code></td>
<td>
<p>One of &quot;arm&quot;, &quot;total&quot;, or 'actual&quot;. See documentation for
<code>Ntype</code> in <code><a href="DoseFinding.html#topic+powMCT">powMCT</a></code> for descriptions
of &quot;arm&quot; and 'total&quot;. For &quot;actual&quot;, the nSample should be a numerical
vector containing the actual patient allocation for each dose provided.</p>
</td></tr>
<tr><td><code id="sampSizeMCTGen_+3A_alratio">alRatio</code></td>
<td>
<p>A numeric vector specifying the ratios between the patient
allocation for the specified doses.</p>
</td></tr>
<tr><td><code id="sampSizeMCTGen_+3A_altmodels">altModels</code></td>
<td>
<p>An object of class <code>Mods</code>, defining the mean vectors
under which the power should be calculated.</p>
</td></tr>
<tr><td><code id="sampSizeMCTGen_+3A_alpha">alpha</code></td>
<td>
<p>A numeric value specifying the significance level</p>
</td></tr>
<tr><td><code id="sampSizeMCTGen_+3A_power">power</code></td>
<td>
<p>A numeric value specifying the power power of <code>sumFct</code></p>
</td></tr>
<tr><td><code id="sampSizeMCTGen_+3A_sumfct">sumFct</code></td>
<td>
<p>Either an included character vector or a function that combines
the power values under the different alternative into one value.</p>
</td></tr>
<tr><td><code id="sampSizeMCTGen_+3A_verbose">verbose</code></td>
<td>
<p>A logical specifying whether the patient allocation should be
printed, in addition to the results.</p>
</td></tr>
<tr><td><code id="sampSizeMCTGen_+3A_tol">tol</code></td>
<td>
<p>A positive numeric value specifying the tolerance level for the
bisection search algorithm. Bisection is stopped if the <code>targFunc</code>
value is within <code>tol</code> of power.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric containing the calculated power values
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
dose.vec = c(0, 5, 10, 20, 30, 40)
models.full = Mods(doses = dose.vec, linear = NULL,
      sigEmax = rbind(c(9, 2), c(6, 3)),
      emax = 0.8,
      quadratic = -0.02,
      placEff = 0, maxEff = 2)
## Now we can calculate the sample sizes needed in order to achieve a certain power
sampSizeMCTGen("negative binomial", "log", modelPar = 0.1, upperN = 50, Ntype = "arm",
      altModels = models.full, alpha = 0.05, sumFct = "min", power = 0.8)

</code></pre>

<hr>
<h2 id='simS'>Covariance Matrix Simulation</h2><span id='topic+simS'></span>

<h3>Description</h3>

<p>For non-canonical links, simulating the covariance matrix is sometimes the
easiest way to get an estimate of the covariance matrix. Even for the
canonical links, simulating the covariance matrix may be desirable, as
theoretical covariance matrices are based off of asymptotic properties which
may not hold for small sample sizes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simS(
  doses,
  resp,
  nSample,
  Ntype = c("arm", "total", "actual"),
  nSim = 1000,
  alRatio = NULL,
  family,
  link,
  modelPar = NULL,
  placEff = NULL,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simS_+3A_doses">doses</code></td>
<td>
<p>A numerical vector of doses, corresponding to the theoretical
response values provided.</p>
</td></tr>
<tr><td><code id="simS_+3A_resp">resp</code></td>
<td>
<p>A numeric vector of response values corresponding to the doses.
This should be on the link scale (e.g. <code>resp</code> should be on the
log-scale if using the log-link).</p>
</td></tr>
<tr><td><code id="simS_+3A_nsample">nSample</code></td>
<td>
<p>An integer if <code>Ntype</code> is &quot;arm&quot; or &quot;total&quot;, or a numerical
vector of patient allocations for each arm if <code>Ntype</code> is &quot;actual&quot;.</p>
</td></tr>
<tr><td><code id="simS_+3A_ntype">Ntype</code></td>
<td>
<p>One of &quot;arm&quot;, &quot;total&quot;, or 'actual&quot;. See documentation for
<code>Ntype</code> in <code><a href="DoseFinding.html#topic+powMCT">powMCT</a></code> for descriptions
of &quot;arm&quot; and 'total&quot;. For &quot;actual&quot;, the nSample should be a numerical
vector containing the actual patient allocation for each dose provided.</p>
</td></tr>
<tr><td><code id="simS_+3A_nsim">nSim</code></td>
<td>
<p>An integer specifying the number of simulations used to estimate
the covariance matrix.</p>
</td></tr>
<tr><td><code id="simS_+3A_alratio">alRatio</code></td>
<td>
<p>Vector describing the relative patient allocations to the dose
groups up to proportionality, e.g. <code>rep(1, length(doses))</code> corresponds
to balanced allocations.</p>
</td></tr>
<tr><td><code id="simS_+3A_family">family</code></td>
<td>
<p>A character string containing the error distribution to be used
in the model.</p>
</td></tr>
<tr><td><code id="simS_+3A_link">link</code></td>
<td>
<p>A character string specifying the link to be using when modeling
the glm.</p>
</td></tr>
<tr><td><code id="simS_+3A_modelpar">modelPar</code></td>
<td>
<p>A numeric vector containing the additional parameters for the
family argument. If the family is negative binomial, the dispersion
parameter should be supplied. If the family is binomial, no model parameter
should be supplied.</p>
</td></tr>
<tr><td><code id="simS_+3A_placeff">placEff</code></td>
<td>
<p>A numeric value specifying the mean response at the placebo
This is required if <code>link</code> = &quot;risk ratio&quot; or &quot;log risk ratio&quot; and
ignored otherwise.</p>
</td></tr>
<tr><td><code id="simS_+3A_verbose">verbose</code></td>
<td>
<p>A logical specifying whether the patient allocation should be
printed, in addition to the results.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric containing the estimated covariance matrix.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(migraine)
models = Mods(linear = NULL, emax = 1, quadratic = c(-0.004), doses = migraine$dose)
simS(migraine$dose, getResp(models)[,1], 30, "arm", 10, family = "binomial",
     link = "logit", verbose = TRUE)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
