<!DOCTYPE html><html lang="en"><head><title>Help for package microplot</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {microplot}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#microplot-package'>
<p>Display microplots (sparklines) from R graphics panels in tables in</p>
'LaTeX', 'Word', 'HTML', 'Excel'.</a></li>
<li><a href='#as.htmlimg'>
<p>Place a filename or filepath in the format used by HTML</p></a></li>
<li><a href='#as.includegraphics'>
<p>Convert a filename into a complete 'LaTeX' <code>\includegraphics</code></p>
expression for use with 'LaTeX' <code>\includegraphics</code> macro in the
<span class="pkg">graphicx</span> package.  This is used for <code>pdf</code> and <code>png</code>
files with the system <code>pdflatex</code> command.  This is used for
<code>ps</code> files with the system <code>latex</code> command.</a></li>
<li><a href='#as.orgfile'>
<p>Place a filename or filepath in the format used by org-mode</p></a></li>
<li><a href='#as.orgtable'>
<p>Prepare a matrix or data.frame to be used as an org-mode table</p></a></li>
<li><a href='#cc176.y.adj'>
<p>Adjusted response values and their five number summaries by treatment</p>
level for one model using the cc176 dataset. This dataset is used in two
demos: &quot;bwplot&quot; and &quot;boxplot-ggplot&quot;.</a></li>
<li><a href='#dir.verify'>
<p>Verifies existence of, or creates, a directory.</p></a></li>
<li><a href='#formatDF'>
<p>Format a Data Frame or Matrix for LaTeX or HTML.</p></a></li>
<li><a href='#graphicsList'>
<p>Convert a list of &quot;trellis&quot; objects or list of &quot;ggplot&quot; objects into a</p>
&quot;graphicslist&quot; object.</a></li>
<li><a href='#latex.AEdotplot'>
<p>Display the AE (Adverse Events) dotplot of incidence and relative risk</p>
from the HH package
in a 'LaTeX' tabular environment or in an 'MS Word' or an 'HTML' table.</a></li>
<li><a href='#latex.trellis'>
<p>Display a table in 'latex' containing panels from <span class="rlang"><b>R</b></span> graphs in</p>
its cells.</a></li>
<li><a href='#latexSetOptions'><p>Set the options for use of latex; check whether the options</p>
for latex functions have been specified.</a></li>
<li><a href='#layoutCollapse'>
<p>Set the lattice <code>par.settings</code> to remove all marginal space.</p></a></li>
<li><a href='#LegendrePolyMatrices'>
<p>Legendre Orthogonal Polynomials for various values of alpha and beta.</p>
The dataset is used in the demo(&quot;LegendrePolynomials&quot;).</a></li>
<li><a href='#microplot'>
<p>Take a trellis or ggplot object, or graphicsList object (list of</p>
trellis or ggplot objects), and generate a set of graphics files, one
per panel of a multi-panel display.</a></li>
<li><a href='#microplot-internal'><p>Internal microplot functions</p></a></li>
<li><a href='#microplotAttrDisplay'>
<p>Specify how to display the microplots for x.axis, y.axis, xlab, ylab, and key.</p></a></li>
<li><a href='#msWord'>
<p>Display a table in 'MS Word' containing panels from <span class="rlang"><b>R</b></span> graphs in</p>
its cells.</a></li>
<li><a href='#show.latexConsole'>
<p>Revisions of Hmisc latex and dvi functions that display the generated</p>
latex file on screen and divert the console log to a file.  New
print methods that display Operating System files (ps, docx, html) on screen.</a></li>
<li><a href='#theme_collapse'>
<p>Set the <span class="pkg">ggplot2</span> theme to remove all marginal space.</p></a></li>
<li><a href='#toxicity'>
<p>Simulated toxicity data.  Dataset is used in demo(&quot;tablesPlusGraphicColumn&quot;).</p>
</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Microplots (Sparklines) in 'LaTeX', 'Word', 'HTML', 'Excel'</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0-45</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-01-26</td>
</tr>
<tr>
<td>Author:</td>
<td>Richard M. Heiberger, with contributions from Karen Byron and Nooreen Dabbish.</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Richard M. Heiberger &lt;rmh@temple.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>The microplot function writes a set of R graphics files to be used as
  microplots (sparklines) in tables in either 'LaTeX', 'HTML', 'Word',
  or 'Excel' files.  For 'LaTeX', we provide methods for the
  Hmisc::latex() generic function to construct 'latex' tabular
  environments which include the graphs.  These can be used directly
  with the operating system 'pdflatex' or 'latex' command, or by using
  one of 'Sweave', 'knitr', 'rmarkdown', or 'Emacs org-mode' as an
  intermediary.  For 'MS Word', the msWord() function uses the
  'flextable' package to construct 'Word' tables which include the
  graphs.  There are several distinct approaches for constructing HTML
  files.  The simplest is to use the msWord() function with argument
  filetype="html".  Alternatively, use either 'Emacs org-mode' or the
  htmlTable::htmlTable() function to construct an 'HTML' file
  containing tables which include the graphs.  See the documentation
  for our as.htmlimg() function.  For 'Excel' use on 'Windows', the
  file examples/irisExcel.xls includes 'VBA' code which brings the
  individual panels into individual cells in the spreadsheet.
  Examples in the examples and demo subdirectories are shown with
  'lattice' graphics, 'ggplot2' graphics, and 'base' graphics.
  Examples for 'LaTeX' include 'Sweave' (both 'LaTeX'-style and
  'Noweb'-style), 'knitr', 'emacs org-mode', and 'rmarkdown' input
  files and their 'pdf' output files.  Examples for 'HTML' include
  'org-mode' and 'Rmd' input files and their webarchive 'HTML' output
  files.  In addition, the as.orgtable() function can display a
  data.frame in an 'org-mode' document.  The examples for 'MS Word'
  (with either filetype="docx" or filetype="html") work with all
  operating systems.  The package does not require the installation of
  'LaTeX' or 'MS Word' to be able to write '.tex' or '.docx' files.</td>
</tr>
<tr>
<td>Imports:</td>
<td>Hmisc (&ge; 4.1-1), HH, lattice, grid, flextable (&ge; 0.5-11),
officer, ggplot2, htmltools, cowplot</td>
</tr>
<tr>
<td>Suggests:</td>
<td>reshape2, latticeExtra, xtable, markdown, rmarkdown, knitr,
htmlTable</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-01-26 21:51:27 UTC; rmh</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-01-26 22:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='microplot-package'>
Display microplots (sparklines) from R graphics panels in tables in
'LaTeX', 'Word', 'HTML', 'Excel'.
</h2><span id='topic+microplot-package'></span><span id='topic+sparkline'></span>

<h3>Description</h3>

<p>The microplot function writes a set of R graphics files to be used as
  microplots (sparklines) in tables in either 'LaTeX', 'HTML', 'Word',
  or 'Excel' files.  For 'LaTeX', we provide methods for the
  Hmisc::latex() generic function to construct 'latex' tabular
  environments which include the graphs.  These can be used directly
  with the operating system 'pdflatex' or 'latex' command, or by using
  one of 'Sweave', 'knitr', 'rmarkdown', or 'Emacs org-mode' as an
  intermediary.  For 'MS Word', the msWord() function uses the
  'flextable' package to construct 'Word' tables which include the
  graphs.  There are several distinct approaches for constructing HTML
  files.  The simplest is to use the msWord() function with argument
  filetype=&quot;html&quot;.  Alternatively, use either 'Emacs org-mode' or the
  htmlTable::htmlTable() function to construct an 'HTML' file
  containing tables which include the graphs.  See the documentation
  for our as.htmlimg() function.  For 'Excel' use on 'Windows', the
  file examples/irisExcel.xls includes 'VBA' code which brings the
  individual panels into individual cells in the spreadsheet.
  Examples in the examples and demo subdirectories are shown with
  'lattice' graphics, 'ggplot2' graphics, and 'base' graphics.
  Examples for 'LaTeX' include 'Sweave' (both 'LaTeX'-style and
  'Noweb'-style), 'knitr', 'emacs org-mode', and 'rmarkdown' input
  files and their 'pdf' output files.  Examples for 'HTML' include
  'org-mode' and 'Rmd' input files and their webarchive 'HTML' output
  files.  In addition, the as.orgtable() function can display a
  data.frame in an 'org-mode' document.  The examples for 'MS Word'
  (with either filetype=&quot;docx&quot; or filetype=&quot;html&quot;) work with all
  operating systems.  The package does not require the installation of
  'LaTeX' or 'MS Word' to be able to write '.tex' or '.docx' files.
</p>


<h3>Details</h3>

<p>The DESCRIPTION file:
</p>

<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> microplot</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Title: </td><td style="text-align: left;"> Microplots (Sparklines) in 'LaTeX', 'Word', 'HTML', 'Excel'</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0-45</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2022-01-26</td>
</tr>
<tr>
 <td style="text-align: left;">
Author: </td><td style="text-align: left;"> Richard M. Heiberger, with contributions from Karen Byron and Nooreen Dabbish.</td>
</tr>
<tr>
 <td style="text-align: left;">
Maintainer: </td><td style="text-align: left;"> Richard M. Heiberger &lt;rmh@temple.edu&gt;</td>
</tr>
<tr>
 <td style="text-align: left;">
Description: </td><td style="text-align: left;"> The microplot function writes a set of R graphics files to be used as
  microplots (sparklines) in tables in either 'LaTeX', 'HTML', 'Word',
  or 'Excel' files.  For 'LaTeX', we provide methods for the
  Hmisc::latex() generic function to construct 'latex' tabular
  environments which include the graphs.  These can be used directly
  with the operating system 'pdflatex' or 'latex' command, or by using
  one of 'Sweave', 'knitr', 'rmarkdown', or 'Emacs org-mode' as an
  intermediary.  For 'MS Word', the msWord() function uses the
  'flextable' package to construct 'Word' tables which include the
  graphs.  There are several distinct approaches for constructing HTML
  files.  The simplest is to use the msWord() function with argument
  filetype="html".  Alternatively, use either 'Emacs org-mode' or the
  htmlTable::htmlTable() function to construct an 'HTML' file
  containing tables which include the graphs.  See the documentation
  for our as.htmlimg() function.  For 'Excel' use on 'Windows', the
  file examples/irisExcel.xls includes 'VBA' code which brings the
  individual panels into individual cells in the spreadsheet.
  Examples in the examples and demo subdirectories are shown with
  'lattice' graphics, 'ggplot2' graphics, and 'base' graphics.
  Examples for 'LaTeX' include 'Sweave' (both 'LaTeX'-style and
  'Noweb'-style), 'knitr', 'emacs org-mode', and 'rmarkdown' input
  files and their 'pdf' output files.  Examples for 'HTML' include
  'org-mode' and 'Rmd' input files and their webarchive 'HTML' output
  files.  In addition, the as.orgtable() function can display a
  data.frame in an 'org-mode' document.  The examples for 'MS Word'
  (with either filetype="docx" or filetype="html") work with all
  operating systems.  The package does not require the installation of
  'LaTeX' or 'MS Word' to be able to write '.tex' or '.docx' files.</td>
</tr>
<tr>
 <td style="text-align: left;">
Imports: </td><td style="text-align: left;"> Hmisc (&gt;= 4.1-1), HH, lattice, grid, flextable (&gt;= 0.5-11), officer, ggplot2, htmltools, cowplot</td>
</tr>
<tr>
 <td style="text-align: left;">
Suggests: </td><td style="text-align: left;"> reshape2, latticeExtra,
xtable, markdown, rmarkdown, knitr, htmlTable</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>


<p>Index of help topics:
</p>
<pre>
LegendrePolyMatrices    Legendre Orthogonal Polynomials for various
                        values of alpha and beta. The dataset is used
                        in the demo("LegendrePolynomials").
as.htmlimg              Place a filename or filepath in the format used
                        by HTML
as.includegraphics      Convert a filename into a complete 'LaTeX'
                        '\includegraphics' expression for use with
                        'LaTeX' '\includegraphics' macro in the
                        'graphicx' package.  This is used for 'pdf' and
                        'png' files with the system 'pdflatex' command.
                        This is used for 'ps' files with the system
                        'latex' command.
as.orgfile              Place a filename or filepath in the format used
                        by org-mode
as.orgtable             Prepare a matrix or data.frame to be used as an
                        org-mode table
cc176.y.adj             Adjusted response values and their five number
                        summaries by treatment level for one model
                        using the cc176 dataset. This dataset is used
                        in two demos: "bwplot" and "boxplot-ggplot".
dir.verify              Verifies existence of, or creates, a directory.
formatDF                Format a Data Frame or Matrix for LaTeX or
                        HTML.
graphicsList            Convert a list of "trellis" objects or list of
                        "ggplot" objects into a "graphicslist" object.
latex.AEdotplot         Display the AE (Adverse Events) dotplot of
                        incidence and relative risk from the HH package
                        in a 'LaTeX' tabular environment or in an 'MS
                        Word' or an 'HTML' table.
latex.trellis           Display a table in 'latex' containing panels
                        from R graphs in its cells.
latexSetOptions         Set the options for use of latex; check whether
                        the options for latex functions have been
                        specified.
layoutCollapse          Set the lattice 'par.settings' to remove all
                        marginal space.
microplot               Take a trellis or ggplot object, or
                        graphicsList object (list of trellis or ggplot
                        objects), and generate a set of graphics files,
                        one per panel of a multi-panel display.
microplot-package       Display microplots (sparklines) from R graphics
                        panels in tables in 'LaTeX', 'Word', 'HTML',
                        'Excel'.
microplotAttrDisplay    Specify how to display the microplots for
                        x.axis, y.axis, xlab, ylab, and key.
msWord                  Display a table in 'MS Word' containing panels
                        from R graphs in its cells.
show.latexConsole       Revisions of Hmisc latex and dvi functions that
                        display the generated latex file on screen and
                        divert the console log to a file.  New print
                        methods that display Operating System files
                        (ps, docx, html) on screen.
theme_collapse          Set the 'ggplot2' theme to remove all marginal
                        space.
toxicity                Simulated toxicity data.  Dataset is used in
                        demo("tablesPlusGraphicColumn").
</pre>
<p>Microplots are small plots that fit into the cells of a table that
otherwise consists of text and numbers.  A special case of a microplot
is known as a sparkline.
</p>
<p>The examples in this package show tables of simple or complex graphs
placed into one or more columns of a table.  The graphs can be produced
by any graphical system in 'R'.  We show <span class="pkg">lattice</span>, <span class="pkg">ggplot2</span>, and <span class="pkg">base</span>
graphics.  The tables can be targeted for display in 'LaTeX', 'MS Word'
on any operating system, 'MS Excel' on 'Windows', or 'HTML'.  We show examples of each.
</p>
<p>The functions produce valid 'LaTeX' <code>.tex</code> files or 'Word'
<code>.docx</code> files in the working directory.  If 'LaTeX' or 'Word' are
installed, then the generated files can be displayed on screen as
illustrated in the help file examples and the <code>demo</code> directory.  The
<code>.tex</code> files can be <code>\include</code>d in a larger <code>.tex</code> file.
Or the generated <code>.pdf</code> file can be displayed in &lsquo;LaTeX&rsquo; with
an <code>\includegraphics</code> statement.
The images in the displayed <code>.docx</code> file can be copied and pasted
into a larger 'Word' file.
</p>
<p>The best way to learn this package is to read the examples and <code>demo</code> files.
The primary function <code><a href="#topic+microplot">microplot</a></code> takes a <code>trellis</code> or <code>ggplot</code>
object and generates a set of graphics files, one per panel of a
multi-panel display.  The <code>latex</code> and <code>msWprd</code> functions place
the graphics files into a table.
</p>
<p>The <code>latex</code> examples (in the help file <code>examples</code>) and <code>demo</code>
files use the operating system <code>pdflatex</code> command with the 'R'
<code>pdf()</code> or <code>png()</code> graphics device.  Or they could use the
operating system <code>latex</code> command with the 'R'
<code>ps()</code> graphics device.  They therefore require that the
three options<br />
<code>options()[c("latexcmd","dviExtension","xdvicmd")]</code><br />
all be set consistently.
The recommended settings for <code>pdflatex</code> with <code>pdf</code> graphics files
are included as the defaults in the function call<br />
<code>latexSetOptions()</code><br />
The recommended settings for <code>latex</code> with <code>ps</code> graphics files
may be specified with the function call<br />
<code>latexSetOptions("latex")</code><br />
</p>
<p>Please see <code><a href="#topic+latexSetOptions">latexSetOptions</a></code> for details on the recommended
settings
for use with the <span class="pkg">microplot</span> package.  See the &quot;System options&quot;
section in the &quot;Details&quot; section of
<code><a href="Hmisc.html#topic+latex">latex</a></code> for discussion of the options themselves.
</p>
<p>The examples in this <code>help</code> file are inside <code>dontrun</code> environments
because they depend on <code>options</code> and they write files.  You must set the
<code>options</code> for your system before running the example manually.
</p>
<p>Most of the 'LaTeX' examples are shown using the <code>Hmisc::latex</code> function
<code><a href="Hmisc.html#topic+latex">latex</a></code>
(I am coauthor of that function).
The <span class="pkg">microplot</span> package also works with the <code>xtable::xtable</code>
function <code><a href="xtable.html#topic+xtable">xtable</a></code>.
An example in the <code>demo</code> directory shows a simple use of <code>xtable</code>.
</p>
<p>The demos in the <code>demo</code> directory are not inside a <code>dontrun</code>
environment.  You must set the options for your system before running
them.  Each demo sets the options for <code>pdfltex</code>.  Should you prefer
<code>latex</code> you will need to run the demos manually.
I recommend that you run the demos with <code>ask=TRUE</code> because
will need to read them closely to see what they are doing.
</p>
<p>To run the demos manually (with a stop at each graph), use
</p>
<pre>
     demo("HowToUseMicroplot"         , package="microplot", ask=TRUE)
     demo("latex"                     , package="microplot", ask=TRUE)
     demo("latex-ggplot"              , package="microplot", ask=TRUE)
     demo("msWord"                    , package="microplot", ask=TRUE)
     demo("LegendrePolynomials"       , package="microplot", ask=TRUE)
     demo("timeseries"                , package="microplot", ask=TRUE)
     demo("NTplot"                    , package="microplot", ask=TRUE)
     demo("bwplot-lattice"            , package="microplot", ask=TRUE)
     demo("boxplot-ggplot"            , package="microplot", ask=TRUE)
     demo("tablesPlusGraphicColumn"   , package="microplot", ask=TRUE)
     demo("regrcoef"                  , package="microplot", ask=TRUE)
     demo("iris"                      , package="microplot", ask=TRUE)
     demo("AEdotplot"                 , package="microplot", ask=TRUE)
     demo("xtable"                    , package="microplot", ask=TRUE)
     demo("Examples"                  , package="microplot", ask=TRUE)
   </pre>
<p>To run the demos automatically, with no stops, use <code>ask=FALSE</code>.
</p>
<p>The <code>examples</code> directory
<code>system.file(package="microplot", "examples")</code>
includes complete working examples of <span class="pkg">Sweave</span> (both LaTeX-style and
Noweb-style), <span class="pkg">knitr</span>, <code>emacs</code> <span class="pkg">orgmode</span>, and
<span class="pkg">rmarkdown</span>
input files and their <code>pdf</code> output files.  These files must be
copied into a directory in which you have write privilege, and that
directory must be made the current working directory with <code>setwd</code>.
They will not work from the installed package directory.
</p>
<p>The 'Excel' for Windows example is in file
<code>examples/irisExcel.xls</code>.  The 'VBA' code in that file shows how to
place the individual microplots into 'Excel' cells.
</p>
<p>See also the vignette:<br />
<code>vignette("rmhPoster", package="microplot")</code>
</p>


<h3>Author(s)</h3>

<p>Richard M. Heiberger, with contributions from Karen Byron and Nooreen Dabbish.
</p>
<p>Maintainer: Richard M. Heiberger &lt;rmh@temple.edu&gt;
</p>


<h3>See Also</h3>

<p><code><a href="Hmisc.html#topic+latex">latex</a></code>, <code><a href="#topic+latex.trellis">latex.trellis</a></code>, <code><a href="#topic+microplot">microplot</a></code>, <code><a href="#topic+as.includegraphics">as.includegraphics</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## This example writes a set of pdf files and then uses the latex
## function to display them in LaTeX.

## The graphs are constructed three times, once each with lattice,
## base graphics, and ggplot2.

## Not run: 

  ## 0. set options for pdflatex and pdf graphics files
  latexSetOptions()


  ## 1. define dataset
  tmp &lt;- matrix(rnorm(10), 2, 5, byrow=TRUE,
                dimnames=list(c("A", "B"), paste0("X", 1:5)))

  tmp.df &lt;- data.frame(y=as.vector(t(tmp)),
                       group=factor(rep(row.names(tmp), each=5)))
  tmp.df


  ## 2. lattice example for latex and msWord

  tmp.lattice &lt;- lattice::bwplot(group ~ y | " " * group, data=tmp.df, layout=c(1,2),
                                 as.table=TRUE, xlim=c(-2.1, 1.3),
                                 scales=list(y=list(relation="free", at=NULL)))
  tmp.lattice


  ## 3. using the latex.trellis method
  latex(tmp.lattice,
        height.panel=.3, width.panel=3, ## inches
        x.axis=TRUE, y.axis=FALSE,
        rowlabel="group", caption="latex.trellis of lattice graph column")

  latex(tmp.lattice, dataobject=formatDF(tmp, dec=2),
        height.panel=.3, width.panel=1.5, ## inches
        x.axis=FALSE, y.axis=FALSE,
        rowlabel="group", caption="latex.trellis of numeric data and lattice graph column")


  ## 4. MS Word example.  Uses functions in the flextable and officer packages.

  tmplw.docx &lt;-
    msWord(tmp.lattice, dataobject=format(tmp, digits=2),
           height.panel=.3, width.panel=2, ## inches
           height.x.axis=.35, width.y.axis=.3,
           figPrefix="tmplw",
           y.axis=FALSE,
           rowlabel="group", width.rowname=.6,
           data.header="data values", width.dataobject=.6,
           graph.header="bwplot",
           caption="Lattice bwplot using msWord function")
  print.default(tmplw.docx)
  tmplw.docx  ## print method opens file
  ## cut and paste this graph into a larger .docx file.


  ## 5. ggplot2 example for latex and msWord

  library(ggplot2)

  tmpga.df &lt;- cbind(tmp.df, fake="ff")
  tmpga &lt;-
    ggplot(tmpga.df, aes(fake, y)) +
    geom_boxplot(outlier.size = 2) +
    facet_wrap(~ group, ncol=1) +
    coord_flip() + ylim(-2, 1.1)
  tmpga ## on interactive device


  ## 6. using the latex.ggplot method

  latex(tmpga, height.x.axis=.2, width.y.axis=.2, y.axis=FALSE)

  latex(tmpga, dataobject=formatDF(tmp, dec=2),
        height.panel=.5, height.x.axis=.2, width.y.axis=.2, y.axis=FALSE)


  ## 7. msWord with ggplot

  tmpga.docx &lt;-
    msWord(tmpga, dataobject=format(tmp, digits=2),
           height.panel=.25, height.x.axis=.2, width.y.axis=.2, y.axis=FALSE,
           rowlabel="group", width.rowname=.6,
           data.header="data values", width.dataobject=.6,
           graph.header="bwplot",
           caption="ggplot2 boxplot using msWord function")
  print.default(tmpga.docx)
  tmpga.docx  ## print method opens file


  detach("package:ggplot2")


  ## 8. base graphics example
  ## This must be done with an explicit loop because
  ## base graphics doesn't produce a graphics object.

  dir.verify("tmpb")
  pdf("tmpb/fig%03d.pdf", onefile=FALSE, height=.5, width=3) ## inch
  par( bty="n", xaxt="n", omd=c(0,1, 0,1), mai=c(0,0,0,0))
  boxplot(tmp["A",], horizontal=TRUE, ylim=range(tmp)) ## ylim for horizontal plot
  boxplot(tmp["B",], horizontal=TRUE, ylim=range(tmp)) ## ylim for horizontal plot
  dev.off()

  tmpb.graphnames &lt;- paste0("tmpb/fig", sprintf("%03i", 1:2), ".pdf")

  tmpb.display &lt;-
    data.frame(round(tmp, 2),
               graphs=as.includegraphics(tmpb.graphnames, height="2em", raise="-1.4ex"))
  tmpb.display

  ## we are now using the latex.data.frame method in the Hmisc package
  tmpb.latex &lt;- latex(tmpb.display, rowlabel="group",
                      caption="latex.default of base graphs")
  tmpb.latex$style &lt;- "graphicx"
  tmpb.latex  ## this line requires latex in the PATH


  ## 9. detail for latex of lattice.  This is essentially what the
  ## latex.trellis method does all together.

  dir.verify("tmpl") ## create a new subdirectory of the working directory
  pdf("tmpl/fig%03d.pdf", onefile=FALSE, height=.5, width=2.5) ## inch
  update(tmp.lattice, layout=c(1,1), xlab="",
         par.settings=list(layout.heights=layoutHeightsCollapse(),
                           layout.widths=layoutWidthsCollapse(),
                           axis.line=list(col="transparent"),
                           strip.border=list(col="transparent")))
  dev.off()

  tmpl.graphnames &lt;- paste0("tmpl/fig", sprintf("%03i", 1:2), ".pdf")
  names(tmpl.graphnames) &lt;- rownames(tmp)

  tmpl &lt;-
    as.includegraphics(tmpl.graphnames)
  ## retains dimensions from pdf() statement
  tmpl
  tmpl.latex &lt;- latex(tmpl, rowlabel="group",
                      caption="latex.default of lattice graph column")
  tmpl.latex  ## this line requires latex in the PATH

  tmplw &lt;-
    data.frame(round(tmp, 2),
               graphs=as.includegraphics(tmpl.graphnames, width="1in"))
  ## retains aspect ratio from pdf() statement
  tmplw

  tmplw.latex &lt;- latex(tmplw, rowlabel="group",
                       caption="latex.default of numeric data and lattice graph column")
  tmplw.latex$style &lt;- "graphicx"
  tmplw.latex  ## this line requires latex in the PATH


  ## 10. detail for latex of ggplot.
  ## left as an exercise.  It is very similar to the detail for latex with lattice.


## End(Not run)

## Please see the demos for more interesting examples.
## demo(package="microplot")

</code></pre>

<hr>
<h2 id='as.htmlimg'>
Place a filename or filepath in the format used by HTML
</h2><span id='topic+as.htmlimg'></span>

<h3>Description</h3>

<p>Place a filename or filepath in the format used by HTML, by
surrounding it with
<code>"&lt;img src"</code> and <code>"/&gt;"</code> and with possible additional arguments between.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.htmlimg(object, height = "80", width = NULL, wd = getwd(), align = "middle")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as.htmlimg_+3A_object">object</code></td>
<td>

<p>Vector of character strings containing filenames.
</p>
</td></tr>
<tr><td><code id="as.htmlimg_+3A_height">height</code>, <code id="as.htmlimg_+3A_width">width</code></td>
<td>

<p>Number of pixels as a character string.
</p>
</td></tr>
<tr><td><code id="as.htmlimg_+3A_wd">wd</code></td>
<td>

<p>The directory in which the files reside.  The default is the current
working directory that R is using.
</p>
</td></tr>
<tr><td><code id="as.htmlimg_+3A_align">align</code></td>
<td>

<p>Specifies the alignment of an image according to surrounding elements
(Not supported in HTML5).
One of the strings:    <code>"top"</code>, <code>"bottom"</code>, <code>"middle"</code>, <code>"left"</code>, <code>"right"</code>
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character vector containing the input strings surrounded by
<code>"&lt;img src"</code> and <code>"/&gt;"</code> and with possible additional arguments between.
</p>


<h3>Author(s)</h3>

<p> Nooreen Dabbish &lt;nerd@temple.edu&gt; and Richard M. Heiberger &lt;rmh@temple.edu&gt; </p>


<h3>See Also</h3>

<p><code><a href="#topic+microplot">microplot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>as.htmlimg("abcd.png")
as.htmlimg("abcd.png", wd=".")
as.htmlimg(c("abcd.png", "efgh.png"))
cat( as.htmlimg("abcd.png")                , "\n")
cat( as.htmlimg("abcd.png", wd=".")        , "\n")
cat( paste(as.htmlimg(c("abcd.png", "efgh.png")), "\n"))

## For an example in context, please see the package example:
##    system.file(package="microplot", "examples/irisRMarkdownHtml.Rmd")
## Copy file irisRMarkdownHtml.Rmd to a directory in which you have write privileges.
## Run the statement
##   rmarkdown::render("irisRMarkdownHtml.Rmd", output_file="irisRMarkdownHtml.html")
## at the R Console.
</code></pre>

<hr>
<h2 id='as.includegraphics'>
Convert a filename into a complete 'LaTeX' <code>\includegraphics</code>
expression for use with 'LaTeX' <code>\includegraphics</code> macro in the
<span class="pkg">graphicx</span> package.  This is used for <code>pdf</code> and <code>png</code>
files with the system <code>pdflatex</code> command.  This is used for
<code>ps</code> files with the system <code>latex</code> command.
</h2><span id='topic+as.includegraphics'></span><span id='topic+as.includegraphics.default'></span><span id='topic+as.includegraphics.trellis'></span><span id='topic+as.includegraphics.ggplot'></span><span id='topic+as.includegraphics.graphicsList'></span><span id='topic+as.includegraphics.microplotMatrix'></span><span id='topic+as.includegraphics.includegraphicsMatrix'></span>

<h3>Description</h3>

<p>Convert a filename into a complete 'LaTeX' <code>\includegraphics</code>
expression for use with 'LaTeX' <code>\includegraphics</code> macro in the
<span class="pkg">graphicx</span> package.  This is used for <code>pdf</code> and <code>png</code>
files with the system <code>pdflatex</code> command.  This is used for
<code>ps</code> files with the system <code>latex</code> command.  The argument
<code>wd</code> is included in the pathname in the generated expression.
The <code>\includegraphics</code> macro is generated with the <code>height</code>
and optional <code>width</code> specified by the
<code>height.includegraphics</code> and <code>width.includegraphics</code>
arguments; the default <code>NULL</code> means use the values in the
graphics (<code>pdf</code>, <code>png</code>, <code>ps</code>) files.  If either is
specified, the other should be left as <code>NULL</code> to retain the
original aspect ratio.
## An optional <code>raise</code> value is available for vertical alignment.
An optional <code>trim</code> argument is available to remove excess margins
from the image.  See the Details section for use of the <code>trim</code>
argument to trim panels in an externally produced graphics file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.includegraphics(object, ...)

## Default S3 method:
as.includegraphics(object,
           height.includegraphics=NULL, ## LaTeX measurement (character)
           width.includegraphics=NULL, ## retains original aspect ratio,
           ##                             LaTeX measurement (character)
           scale=NULL, ## number
           raise=NULL, ## LaTeX measurement (character)
           tabularinclude=TRUE,
           hspace.left=NULL,  ## LaTeX measurement (character)
           hspace.right=NULL, ## LaTeX measurement (character)
           wd=getwd(), ## working directory.  No embedded spaces in directory name.
           viewport=NULL, ## if specified, then left bottom right top (character)
           ## used for pdf png jpeg
           ## See MediaBox in pdf file.
           ## Ask operating system for png or jpg file.
           bb=NULL, ## if specified, then left bottom right top (character)
           ## used for bmp tiff ps, ask operating system for values
           trim=NULL, ## for example, "0 0 0 0" left bottom right top (character)
           x.axis.includegraphics=TRUE, ## logical or a list of arguments
           ##                              to latex \includegraphics[here]{}
           y.axis.includegraphics=TRUE, ## logical or a list of arguments
           xlab.includegraphics=FALSE,  ## logical or a list of arguments
           ylab.includegraphics=FALSE,  ## logical or a list of arguments
           key.includegraphics=!is.null(attr(object, "key.name")),
           ##                           ## logical or a list of arguments
           as.attr=FALSE, ## logical
           label.x.axis="", ## empty, nchar=0
           label.y.axis=" ", ## one space, nchar=1
           columnKey=NULL, ## see ?microplotAttrDisplay
           ...)

## S3 method for class 'microplotMatrix'
as.includegraphics(object, ...) ## principal usage.  Calls default.

## S3 method for class 'includegraphicsMatrix'
as.includegraphics(object, ...) ## returns object

## S3 method for class 'trellis'
as.includegraphics(object, ...) ## generates an informative error message.

## S3 method for class 'ggplot'
as.includegraphics(object, ...) ## generates an informative error message.

## S3 method for class 'graphicsList'
as.includegraphics(object, ...) ## generates an informative error message.


</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as.includegraphics_+3A_object">object</code></td>
<td>
<p>A <code>"microplotMatrix"</code>, that is
a character vector or matrix of filenames for graphics files.  The
argument may include attributes <code>axis.names</code>, <code>lab.names</code>, and
<code>key.name</code> for graphics files containing the <code>"x.axis"</code>,
<code>"y.axis"</code>, <code>"xlab"</code>, <code>"ylab"</code>, and <code>"key"</code> (legend)
panels.
</p>
</td></tr>
<tr><td><code id="as.includegraphics_+3A_scale">scale</code></td>
<td>
<p>Scale factor (number) applied to figure.
If either <code>height.includegraphics</code> or <code>width.includegraphics</code> is specified, then <code>scale</code> is ignored.
</p>
</td></tr>
<tr><td><code id="as.includegraphics_+3A_height.includegraphics">height.includegraphics</code>, <code id="as.includegraphics_+3A_width.includegraphics">width.includegraphics</code></td>
<td>

<p>Character vector containing a LaTeX distance (by default <code>NULL</code>).
Specifying at most one of these retains the original aspect ratio.
Specifying a value for both might distort the figure by changing the
aspect ratio. Specifying <code>trim</code> on height of a panel requires
a new height to be specified to retain the aspect ratio.
Specifying <code>trim</code> on width of a panel requires
a new width to be specified to retain the aspect ratio.
See <code>demo("latex")</code> and <code>demo("latex-ggplot")</code> for an example.
</p>
</td></tr>
<tr><td><code id="as.includegraphics_+3A_wd">wd</code></td>
<td>

<p>The directory in which the files reside.  The default is the full path
to the current
working directory that R is using.  The full path is necessary when
using the <code>Hmisc::print.latex</code> and related functions because they
run the operating system's <code>latex</code> or <code>pdflatex</code> command in
a temporary directory.  The relative path to the current directory
(<code>wd="."</code>)
is sufficient if the file will be brought into a larger <code>tex</code> file
with the LaTeX <code>\input</code> macro.  Should the working directory have an
embedded blank anywhere in its pathname, then <code>as.includegraphics</code> will
generate an informative error.  This is to protect you from a
less-informative error that the system 'latex' command would otherwise generate.
The recommended repair is to <code>setwd()</code> to a directory whose path has no
embedded blanks anywhere.  A workaround is to use <code>wd="."</code> in the
<code>latex</code> call.  Automatic printing with  <code>Hmisc::print.latex</code>
will not work.  <code>\input{}</code> of the generated
<code>.tex</code> file into your larger <code>.tex</code> will work.  Moving the
generated <code>.tex</code> file in the temporary directory to your working directory
will work.
</p>
</td></tr>
<tr><td><code id="as.includegraphics_+3A_raise">raise</code></td>
<td>

<p>Character vector containing a LaTeX distance (by default <code>NULL</code>).
This value may be negative.  Use it if the default vertical
alignment of the graphs in the table is not satisfactory.
Usually a better approach would be to use the <code>arraystretch</code>
argument to <code><a href="#topic+latex.trellis">latex.trellis</a></code>.
</p>
</td></tr>
<tr><td><code id="as.includegraphics_+3A_tabularinclude">tabularinclude</code></td>
<td>
<p>Logical. When <code>TRUE</code> place the generated
<code>\includegraphics{}</code> statements inside a <code>tabular</code>
environment.
This makes the center of the included graphic align with the text on the
same line of the tabular environment.</p>
</td></tr>
<tr><td><code id="as.includegraphics_+3A_hspace.left">hspace.left</code>, <code id="as.includegraphics_+3A_hspace.right">hspace.right</code></td>
<td>

<p>Character vector containing a LaTeX distance (by default <code>NULL</code>).
This value may be negative.  Use it if the default distance on the
left or right between columns of graphs in the table is not satisfactory.
</p>
</td></tr>
<tr><td><code id="as.includegraphics_+3A_viewport">viewport</code></td>
<td>
<p>Size in pixels of the image file.  This is the MediaBox
in a <code>pdf</code> file.  It is the number reported by the operating system for a
<code>png</code> file.  The <code>viewport</code> is optional.  When specified it must be a
character string containing four numbers in order: left, bottom, right, top.</p>
</td></tr>
<tr><td><code id="as.includegraphics_+3A_bb">bb</code></td>
<td>
<p>Bounding Box: Size in pixels of the image file.  It is the
number reported by the operating system for a <code>ps</code> file.
When specified it must be a
character string containing four numbers in order: left, bottom, right, top.</p>
</td></tr>
<tr><td><code id="as.includegraphics_+3A_trim">trim</code></td>
<td>
<p>Size in pixels to be trimmed.  It must be a character string
containing four numbers in order: left, bottom, right, top.  See the
manual for the LaTeX package <span class="pkg">graphicx</span> for details.  When
<code>trim</code> is used, either <code>height.includegraphics</code> or
<code>width.includegraphics</code> will also need to be changed.
See <code>demo("latex")</code> and <code>demo("latex-ggplot")</code> for an example.
See the Details section for additional use of the <code>trim</code> argument.
</p>
</td></tr>
<tr><td><code id="as.includegraphics_+3A_x.axis.includegraphics">x.axis.includegraphics</code>, <code id="as.includegraphics_+3A_y.axis.includegraphics">y.axis.includegraphics</code></td>
<td>
<p>logical,
or list of arguments to nested calls to as.includegraphics.</p>
</td></tr>
<tr><td><code id="as.includegraphics_+3A_xlab.includegraphics">xlab.includegraphics</code>, <code id="as.includegraphics_+3A_ylab.includegraphics">ylab.includegraphics</code>, <code id="as.includegraphics_+3A_key.includegraphics">key.includegraphics</code></td>
<td>
<p>logical, or list of arguments to nested calls
to as.includegraphics.</p>
</td></tr>
<tr><td><code id="as.includegraphics_+3A_as.attr">as.attr</code></td>
<td>
<p>Logical.  When <code>TRUE</code> the attributes in the
<code>"microplotMatrix"</code> argument become
attributes in the <code>"includegraphicsMatrix"</code> result.
When <code>FALSE</code>, the <code>label.x.axis</code>, <code>label.y.axis</code>, and <code>columnKey</code>
arguments are passed through to <code><a href="#topic+microplotAttrDisplay">microplotAttrDisplay</a></code>.</p>
</td></tr>
<tr><td><code id="as.includegraphics_+3A_label.x.axis">label.x.axis</code>, <code id="as.includegraphics_+3A_label.y.axis">label.y.axis</code></td>
<td>
<p>Labels that will used by
<code><a href="#topic+microplotAttrDisplay">microplotAttrDisplay</a></code> in the column
name of the <code>y.axis</code> and the <code>y.axis</code> position for the
<code>x.axis</code> in the 'latex' display of the graphic.</p>
</td></tr>
<tr><td><code id="as.includegraphics_+3A_columnkey">columnKey</code></td>
<td>

<p>If <code>as.attr</code> is <code>FALSE</code> and the key in <code>attr(object,
  "key.name")</code> is non-null, then <code><a href="#topic+microplotAttrDisplay">microplotAttrDisplay</a></code>
will place its <code>key.name</code> as a new last value in
the specified columns.  The column numbering is with respect to the
input <code>object</code>, before the <code>y.axis</code> or <code>ylab</code> are evaluated.
</p>
</td></tr>
<tr><td><code id="as.includegraphics_+3A_...">...</code></td>
<td>

<p>Other arguments currently ignored.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We recommend that the aspect ratio be controlled by the 'R' functions
that generated the figure.  <code>as.includegraphics</code> will use the
height and width values that are encoded in the <code>pdf</code>,
<code>png</code>, <code>ps</code> files.
If you need to change the size of the image
we recommend that at most one of
<code>height.includegraphics</code>
and <code>width.includegraphics</code> be used
in <code>as.includegraphics</code>.  Using both will change the aspect ratio
and consequently stretch the figure.  The <code>trim</code> argument is used
to remove excess margins from the figure; when <code>trim</code> is
specified for height or width, the <code>height.includegraphics</code> or
<code>width.includegraphics</code> will also need to be specified
to retain the aspect ratio.
See <code>demo("latex")</code> and <code>demo("latex-ggplot")</code> for an example.
</p>
<p>Either the <code>viewport</code> (for <code>pdf</code> or <code>png</code> files) or
<code>bb</code> (for <code>ps</code> files) should be specified, not both.
</p>
<p>The <code>trim</code> argument can be used to take apart an externally
produced graphics file and use subsets of its area as components in a 'LaTeX' table.
See the files <code>examples/irisSweaveTakeApart.Rtex</code> and
<code>examples/irisSweaveTakeApart-Distributed.pdf</code> for an example.
</p>


<h3>Value</h3>

<p>A <code>"includegraphicsMatrix"</code> object, a vector or matrix of 'LaTeX'
expressions with the 'LaTeX' macro
<code>\includegraphics</code> for each of the input filenames.  If the
input argument has <code>axis.names</code> or <code>lab.names</code> or
<code>key.name</code> attributes, then the value will also have those
attributes, enclosed in <code>\includegraphics</code> statements.  The
arguments allow different <code>\includegraphics</code> options for the
panels, the x.axis, the y.axis, xlab, ylab, and the key (legend).
The location of the
files listed in the input argument attributes depends on the value of
the <code>as.attr</code> argument.  When <code>as.attr</code> is <code>TRUE</code> the
<code>object</code> attributes will become <code>result</code> attributes.  When
<code>as.attr</code> is <code>FALSE</code>, see the <a href="#topic+microplotAttrDisplay">microplotAttrDisplay</a> for
details.
</p>


<h3>Author(s)</h3>

<p> Richard M. Heiberger &lt;rmh@temple.edu&gt; </p>


<h3>See Also</h3>

<p><code><a href="#topic+latex.trellis">latex.trellis</a></code>, <code><a href="#topic+microplot">microplot</a></code>, <code><a href="Hmisc.html#topic+latex">latex</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>as.includegraphics("abc.pdf")
## [1] "\setlength{\tabcolsep}{0pt}\begin{tabular}{c}
##      \includegraphics{/Users/rmh/Rwd/abc.def}\end{tabular}"
## attr(,"class")
## [1] "includegraphicsMatrix" "character"
## This form, with the full pathname, is required when the Hmisc::print.latex
## and related functions are used for automatic display of
## the current .tex file on screen.

as.includegraphics("abc.pdf", wd=".")
## [1] "\setlength{\tabcolsep}{0pt}\begin{tabular}{c}
##      \includegraphics{./abc.pdf}\end{tabular}"
## attr(,"class")
## [1] "includegraphicsMatrix" "character"
## This form, with the relative path, is optional when the .tex file will be
## embedded into a larger file, and will not be automatically displayed on screen.


## Please see the package documentation ?microplot for a simple example in context.

## Please see the demos for more interesting examples.
## demo(package="microplot")

</code></pre>

<hr>
<h2 id='as.orgfile'>
Place a filename or filepath in the format used by org-mode
</h2><span id='topic+as.orgfile'></span>

<h3>Description</h3>

<p>Place a filename or filepath in the format used by org-mode, by
surrounding it with <code>"[["</code> and <code>"]]"</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.orgfile(object, wd = getwd(), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as.orgfile_+3A_object">object</code></td>
<td>

<p>Vector of character strings containing filenames.
</p>
</td></tr>
<tr><td><code id="as.orgfile_+3A_wd">wd</code></td>
<td>

<p>The directory in which the files reside.  The default is the current
working directory that R is using.
</p>
</td></tr>
<tr><td><code id="as.orgfile_+3A_...">...</code></td>
<td>

<p>Ignored.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character vector containing the input strings surrounded by <code>"[["</code>
and <code>"]]"</code>.
</p>


<h3>Author(s)</h3>

<p> Nooreen Dabbish &lt;nerd@temple.edu&gt; and Richard M. Heiberger &lt;rmh@temple.edu&gt; </p>


<h3>See Also</h3>

<p><code><a href="#topic+microplot">microplot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>as.orgfile("abcd.png")
as.orgfile("abcd.png", wd=".")
as.orgfile(c("abcd.png", "efgh.png"))

## For an example in context, please see the package example:
##    system.file(package="microplot", "examples/irisOrgHtml.org")
## Copy file irisOrgHtml.org to a directory in which you have write privileges,
## open it in emacs, and enter
## C-c C-e b           on Macintosh
## C-c C-e ho          on Windows
## C-c C-e &lt;something&gt; on linux

</code></pre>

<hr>
<h2 id='as.orgtable'>
Prepare a matrix or data.frame to be used as an org-mode table
</h2><span id='topic+as.orgtable'></span>

<h3>Description</h3>

<p>Prepare a matrix or data.frame to be used as an org-mode table.  Column
names are required.  Row names are optional (and default to FALSE
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.orgtable(x, rownames = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as.orgtable_+3A_x">x</code></td>
<td>

<p>Matrix or data.frame.
</p>
</td></tr>
<tr><td><code id="as.orgtable_+3A_rownames">rownames</code></td>
<td>

<p>Logical.  When <code>FALSE</code> (the default), the row.names are not
displayed in the value.  When <code>TRUE</code>, the row.names are displayed
in the value.  See the last example for details on this behavior.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of character strings, one item for each row of the argument <code>x</code>.
The strings contain the markup that will make them appear as tables in
an <code>org-mode</code> document.
</p>


<h3>Author(s)</h3>

<p> Nooreen Dabbish &lt;nerd@temple.edu&gt; and Richard M. Heiberger &lt;rmh@temple.edu&gt; </p>


<h3>See Also</h3>

<p><code><a href="#topic+microplot">microplot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>tmp &lt;- matrix(1:12, 3, 4, dimnames=list(letters[1:3], LETTERS[4:7]))
tmp
as.orgtable(tmp)
as.orgtable(tmp, rownames=TRUE)

tmpdf &lt;- data.frame(tmp)
tmpdf
cat(as.orgtable(tmpdf), sep="\n")
cat(as.orgtable(tmpdf, rownames=TRUE), sep="\n")

## This example shows why row names default to FALSE.

tmp2 &lt;- rbind(tmp, tmp)
tmp2
tmp2df &lt;- data.frame(tmp2)
tmp2df

tmp2df &lt;- cbind(" "=row.names(tmp2), group=rep(c("A","B"), each=3), tmp2df)
tmp2df

cat(as.orgtable(tmp2df), sep="\n")  ## this is what we want

## this has the unwanted initial column of 1:6
cat(as.orgtable(tmp2df, rownames=TRUE), sep="\n")
</code></pre>

<hr>
<h2 id='cc176.y.adj'>
Adjusted response values and their five number summaries by treatment
level for one model using the cc176 dataset. This dataset is used in two
demos: &quot;bwplot&quot; and &quot;boxplot-ggplot&quot;.
</h2><span id='topic+cc176.y.adj'></span><span id='topic+cc176fivenumsd'></span>

<h3>Description</h3>

<p>Adjusted response values and their five number summaries by treatment
level for one model using the cc176 dataset.
The five number summary is based on the standard deviation.
This data set is used in two <span class="pkg">microplot</span> demos:<br />
demo(&quot;bwplot&quot;, package=&quot;microplot&quot;)<br />
demo(&quot;boxplot-ggplot&quot;, package=&quot;microplot&quot;).<br />
In both demos we reproduce HH2 (Heiberger and Holland (2015)) Table 13.2
(page 431), consisting of a
table and aligned boxplot, twice&mdash;using the 'LaTeX' tabular environment accessed
through the <code>latex</code> and <code>microplot</code> functions, and using an
'MS Word' table accessed through the <code>msWord</code> and <code>microplot</code> functions.  In the book we
used manual alignment in the 'LaTeX' code to construct the table (see
chunk 6 in the file referenced by <code>HH::HHscriptnames(13)</code> for the code).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("cc176.y.adj")</code></pre>


<h3>Author(s)</h3>

<p> Richard M. Heiberger &lt;rmh@temple.edu&gt; </p>


<h3>References</h3>

<p>Heiberger, Richard M. and Holland, Burt (2015).
<em>Statistical Analysis and Data Display: An Intermediate Course
with Examples in R</em>, Second Edition.
Springer Texts in Statistics. Springer.
ISBN 978-1-4939-2121-8.
<a href="https://link.springer.com/us/book/9781493921218">https://link.springer.com/us/book/9781493921218</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  ## This example is based on chunks 1, 2, 4, 6 of HH::HHscriptnames(13)
  ## It defines the data(cc176.y.adj) that is used in
  ##    demo("bwplot-lattice")  ## 5 calls to latex() and 5 calls to msWord()
  ##    demo("boxplot-ggplot")  ## 2 calls to latex() and 3 calls to msWord()

data(cc176, package="HH")
cc176.aov &lt;- aov(wt.d ~ rep + wt.n + n.treats*minutes*current,
                 data=cc176)
cc176.y.adj &lt;- cc176$wt.d  -
  (cc176$wt.n - mean(cc176$wt.n))*coef(cc176.aov)["wt.n"]

tmp &lt;-
sapply(split(cc176.y.adj, cc176$current),
       function(x)
         c(min=min(x),
           "m-sd"=mean(x)-sd(x),
           mean=mean(x),
           "m+sd"=mean(x)+sd(x),
           max=max(x)))
cc176fivenumsd &lt;- t(tmp)

save(cc176.y.adj, cc176fivenumsd, file="cc176.y.adj.rda")

## End(Not run)
</code></pre>

<hr>
<h2 id='dir.verify'>
Verifies existence of, or creates, a directory.
</h2><span id='topic+dir.verify'></span>

<h3>Description</h3>

<p>Verifies existence of, or creates, a directory.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dir.verify(path)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dir.verify_+3A_path">path</code></td>
<td>

<p>A character vector containing a single path name.
See <code><a href="base.html#topic+files2">dir.exists</a></code> for more detail.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Logical.  <code>TRUE</code> if the directory already exists or is newly created.
</p>


<h3>Author(s)</h3>

<p> Richard M. Heiberger &lt;rmh@temple.edu&gt; </p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+files2">dir.exists</a></code>
</p>

<hr>
<h2 id='formatDF'>
Format a Data Frame or Matrix for LaTeX or HTML.
</h2><span id='topic+formatDF'></span>

<h3>Description</h3>

<p>Format a Data Frame or Matrix for LaTeX or HTML.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>formatDF(...)
## please see ?Hmisc::format.df
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="formatDF_+3A_...">...</code></td>
<td>

<p>Please see <code><a href="Hmisc.html#topic+format.df">format.df</a></code> for details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Alias for the <code>Hmisc::format.df</code> function whose name will soon be deprecated.
</p>


<h3>Value</h3>

<p>A character matrix with character images of properly rounded <code>x</code>.
Please see <code><a href="Hmisc.html#topic+format.df">format.df</a></code> for details.
</p>


<h3>Author(s)</h3>

<p>Frank E. Harrell, Jr.,
<br />
Department of Biostatistics,
<br />
Vanderbilt University,
<br />
<a href="mailto:f.harrell@vanderbilt.edu">f.harrell@vanderbilt.edu</a>
</p>
<p>Richard M. Heiberger,
<br />
Department of Statistics,
<br />
Temple University, Philadelphia, PA.
<br />
<a href="mailto:rmh@astro.ocis.temple.edu">rmh@astro.ocis.temple.edu</a>
</p>

<hr>
<h2 id='graphicsList'>
Convert a list of &quot;trellis&quot; objects or list of &quot;ggplot&quot; objects into a
&quot;graphicslist&quot; object.
</h2><span id='topic+graphicsList'></span>

<h3>Description</h3>

<p>Convert a list of &quot;trellis&quot; objects or list of &quot;ggplot&quot; objects into a
&quot;graphicslist&quot; object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>graphicsList(...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="graphicsList_+3A_...">...</code></td>
<td>

<p>The list can either be a &quot;list&quot; object, such as <code>list(g1, g2, g3)</code>,
or the actual list <code>g1, g2, g3</code>.  All the <code>g*</code> objects must be
the same class, either <code>"trellis"</code> or <code>"ggplot"</code>.
The &quot;list&quot; object may be an array with dim or dimnames, with <code>length(dim(object))</code>
either 1 or 2.  An actual list, or a &quot;list&quot; object with one dimension,
will be coerced to a column vector of graphics objects.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>"graphicsList"</code> object which can be sent to <code>microplot.graphicsList</code>.
See <code><a href="#topic+graphicsList">microplot.graphicsList</a></code> for more discussion.
</p>


<h3>Author(s)</h3>

<p> Richard M. Heiberger &lt;rmh@temple.edu&gt; </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  latexSetOptions()

  ## graphicsList works the same for lattice and ggplot

  ## lattice
  tt &lt;- data.frame(x=1:3, y=4:6, g=c("A","B","A"))

  ## t1 and t2: with key
  t1 &lt;- lattice::xyplot(y ~ x, xlim=c(0,4), ylim=c(3,7), groups=g,
                        data=tt[1:2,], pch=19, col=2:3,
                        key=list(points=list(pch=19, col=2:3), text=list(levels(tt$g))))

  t2 &lt;- lattice::xyplot(y ~ x, xlim=c(0,4), ylim=c(3,7), groups=g,
                        data=tt[3,  ], pch=19, col=2:3,
                        key=list(points=list(pch=19, col=2:3), text=list(levels(tt$g))))

  ## collapsed panels, no key
  latex(graphicsList(t1, t2), title="glt1", width.y.axis=.4, height.x.axis=.4)

  ## collapsed panels, one key
  latex(graphicsList(t1, t2), key=t1$legend$top$args$key, title="glt2",
        width.y.axis=.4, height.x.axis=.4)

  ## uncollapsed panels, one key per panel
  latex(graphicsList(list(t1, t2)), height.panel=2, width.panel=2, collapse=FALSE, title="glt1")

  ## uncollapsed panels, one key
  latex(graphicsList(list(update(t1, legend=NULL),
                          update(t2, legend=NULL))),
        height.panel=2, width.panel=2, collapse=FALSE,
        key=t1$legend$top$args$key, title="glt4")


  ## collapsed panels, no key
  msWord(graphicsList(matrix(list(t1, t2), 2, 1, dimnames=list(c("A","B"), "c"))),
         width.rowname=.5, title="Wt1", width.y.axis=.4, height.x.axis=.4)

  ## collapsed panels, one key
  msWord(graphicsList(matrix(list(t1, t2), 2, 1, dimnames=list(c("A","B"), "c"))),
         key=t1$legend$top$args$key,
         width.rowname=.5, title="Wt2", width.y.axis=.4, height.x.axis=.4)

  ## uncollapsed panels, one key per panel
  msWord(graphicsList(matrix(list(t1, t2), 2, 1, dimnames=list(c("A","B"), "c"))),
         height.panel=2, width.panel=2, collapse=FALSE,
         width.rowname=.5, title="Wt3")

  ## uncollapsed panels, one key
  msWord(graphicsList(matrix(list(update(t1, legend=NULL),
                                  update(t2, legend=NULL)),
                             2, 1, dimnames=list(c("A","B"), "c"))),
         height.panel=2, width.panel=2, collapse=FALSE,
         key=t1$legend$top$args$key,
         width.rowname=.5, title="Wt4")


  ## ggplot
  tt &lt;- data.frame(x=1:3, y=4:6, g=c("A","B","A"))

  library(ggplot2)

  ## g1 and g2: with key
  g1 &lt;-
    ggplot(tt[1:2,], aes(x,y, color=g)) +
    geom_point() +
    xlim(0,4) + ylim(3,7)

  g2 &lt;-
    ggplot(tt[3,], aes(x,y, color=g)) +
    geom_point() +
    xlim(0,4) + ylim(3,7)

  g1key &lt;- plot_grid(get_legend(g1))

  ## collapsed panels, no key
  latex(graphicsList(g1, g2), title="glg1", width.y.axis=.2, height.x.axis=.2)

  ## collapsed panels, one key
  latex(graphicsList(g1, g2), key=g1key, title="glg2", width.y.axis=.2, height.x.axis=.2)

  ## uncollapsed panels, one key per panel
  latex(graphicsList(list(g1, g2)), height.panel=2, width.panel=2, collapse=FALSE, title="glg3")

  ## uncollapsed panels, one key
  latex(graphicsList(list(g1+theme(legend.position="none"),
                          g2+theme(legend.position="none"))),
        height.panel=2, width.panel=2, collapse=FALSE,
        key=g1key, title="glg4")

  ## collapsed panels, no key
  msWord(graphicsList(g1, g2),
         width.rowname=.5, title="Wg1", width.y.axis=.4, ## width.y.axis=.2, ## not in R CMD check
         height.x.axis=.2,
         FlexTableWidths=c(.5, .45, 1))                  ## c(.5, .25, 1)    ## not in R CMD check

  ## collapsed panels, one key                           ## ditto
  msWord(graphicsList(g1, g2), key=g1key,
         width.rowname=.5, title="Wg2", width.y.axis=.4,
         height.x.axis=.2,
         FlexTableWidths=c(.5, .45, 1))

  ## uncollapsed panels, one key per panel
  msWord(graphicsList(list(g1, g2)), height.panel=2, width.panel=2, collapse=FALSE,
         width.rowname=.5, title="Wg3")

  ## uncollapsed panels, one key
  msWord(graphicsList(list(g1+theme(legend.position="none"),
                           g2+theme(legend.position="none"))),
         height.panel=2, width.panel=2, collapse=FALSE,
         key=g1key,
         width.rowname=.5, title="Wg4")

  detach("package:ggplot2") ## can't unload


## End(Not run)</code></pre>

<hr>
<h2 id='latex.AEdotplot'>
Display the AE (Adverse Events) dotplot of incidence and relative risk
from the HH package
in a 'LaTeX' tabular environment or in an 'MS Word' or an 'HTML' table.
</h2><span id='topic+latex.AEdotplot'></span><span id='topic+msWord.AEdotplot'></span><span id='topic+microplot.AEdotplot'></span>

<h3>Description</h3>

<p>The <code><a href="HH.html#topic+ae.dotplot7a">AEdotplot</a></code> function constructs a
display of the most frequently occurring AEs (Adverse Events) in the
active arm of a clinical study.
The <code><a href="Hmisc.html#topic+latex">latex</a></code> method takes the
incidence panel and the relative risk panel from the
<code>AEdotplot</code> and places them in a 'LaTeX' tabular environment
along with the numerical table of counts, percents, and relative risks.
The <code><a href="#topic+msWord">msWord</a></code> method takes the
incidence panel and the relative risk panel from the
<code>AEdotplot</code> and places them in an 'MS Word' table
along with the numerical table of counts, percents, and relative risks.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'AEdotplot'
latex(object, figPrefix = first.word(deparse(substitute(object))),
      rowlabel="Most Frequent On-Therapy Adverse Events",
      device="pdf", ...)

## S3 method for class 'AEdotplot'
msWord(object, figPrefix = first.word(deparse(substitute(object))),
       device="png",
       height.panel=.25, height.x.axis=.45,
       width.left=2, width.right=1.5,
       height.key=height.panel,
       width.dataobject=.7,
       rowlabel="Adverse Event", width.rowname=2,
       ...)

## S3 method for class 'AEdotplot'
microplot(object, figPrefix, width.left=2, width.right=1.5,
          height.panel=.2, height.x.axis=.45, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="latex.AEdotplot_+3A_object">object</code></td>
<td>

<p>An <code>"AEdotplot"</code> object as constructed by the <code><a href="HH.html#topic+ae.dotplot7a">AEdotplot</a></code>.
</p>
</td></tr>
<tr><td><code id="latex.AEdotplot_+3A_figprefix">figPrefix</code></td>
<td>

<p>Beginning characters for names of the sequence of generated graphics
files.
The 'latex' macro <code>\includegraphics</code> requires that there be no
<code>"."</code> in the filename basename.  We replace all <code>"."</code> in
the <code>figPrefix</code> by <code>"-"</code>.
</p>
</td></tr>
<tr><td><code id="latex.AEdotplot_+3A_device">device</code></td>
<td>

<p>Forwarded to <code>microplot</code>.
</p>
</td></tr>
<tr><td><code id="latex.AEdotplot_+3A_width.left">width.left</code>, <code id="latex.AEdotplot_+3A_width.right">width.right</code></td>
<td>
<p><code>width.left</code> is
<code>width.panel</code> for the Percent column and <code>width.right</code> is the
<code>width.panel</code> for the Relative Risk column of the
<code>AEdotplot</code>.  See  <code><a href="HH.html#topic+ae.dotplot7a">AEdotplot</a></code> and <a href="#topic+microplot">microplot</a>.</p>
</td></tr>
<tr><td><code id="latex.AEdotplot_+3A_height.panel">height.panel</code>, <code id="latex.AEdotplot_+3A_height.x.axis">height.x.axis</code>, <code id="latex.AEdotplot_+3A_height.key">height.key</code></td>
<td>
<p>See
<code><a href="#topic+microplot">microplot</a></code>.</p>
</td></tr>
<tr><td><code id="latex.AEdotplot_+3A_width.dataobject">width.dataobject</code>, <code id="latex.AEdotplot_+3A_width.rowname">width.rowname</code></td>
<td>
<p>See <code><a href="#topic+msWord">msWord</a></code>.</p>
</td></tr>
<tr><td><code id="latex.AEdotplot_+3A_rowlabel">rowlabel</code></td>
<td>
<p>See <code><a href="#topic+latex.trellis">latex.trellis</a></code> or <code><a href="#topic+msWord">msWord</a></code>.</p>
</td></tr>
<tr><td><code id="latex.AEdotplot_+3A_...">...</code></td>
<td>

<p>Additional arguments to <code>microplot.AEdotplot</code> are forwarded to the
<code>microplot.trellis</code> method.  Additional arguments to
<code>latex.AEdotplot</code> are forwarded to <code>microplot.AEdotplot</code> and to
<code><a href="#topic+latex">latex</a></code>.
Additional arguments to <code><a href="#topic+msWord.AEdotplot">msWord.AEdotplot</a></code> are forwarded to <code>microplot.AEdotplot</code> and to
<code><a href="#topic+msWord">msWord</a></code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code><a href="#topic+microplot.AEdotplot">microplot.AEdotplot</a></code> function does most of the work, taking apart the
<code>"AEdotplot"</code> object and constructing  from it the set of graphics files
identified in a <code>"microplotMatrix"</code> object and collecting the
numerical data into a data.frame.  The <code>"microplotMatrix"</code> and the
data.frame are returned.
</p>
<p>The <code><a href="Hmisc.html#topic+latex">latex</a></code> and <code><a href="#topic+msWord">msWord</a></code> methods call the
<code>microplot</code> method
and then the <code>latex</code> or <code>msWord</code> generic.
The <code>msWord</code> method has more arguments than the <code>latex</code>
method because it doesn't pick up
the height and width dimensions from the graphics (<code>.png</code>) files.
</p>


<h3>Value</h3>

<p>For <code>latex.AEdotplot</code>, the <code>"latex"</code> object giving the
pathname of the <code>.tex</code> file containing
the 'LaTeX' tabular environment constructed by the <code><a href="Hmisc.html#topic+latex">latex</a></code> function.
For <code>msWord.AEdotplot</code>, the  <code>"msWordFilename"</code> object giving the
pathname of the <code>.docx</code> file containing
the generated table constructed by the <code><a href="#topic+msWord.microplotMatrix">msWord.microplotMatrix</a></code>
function which in turn uses functions in the <span class="pkg"><a href="flextable.html#topic+flextable">flextable</a></span>
package.
</p>
<p>The <code>microplot.AEdotplot</code> method returns a list containing the
<code>"microplotMatrix"</code> and the data.frame.
</p>


<h3>Author(s)</h3>

<p> Richard M. Heiberger &lt;rmh@temple.edu&gt; </p>


<h3>See Also</h3>

<p>See <code><a href="HH.html#topic+ae.dotplot7a">AEdotplot</a></code> and <code><a href="Hmisc.html#topic+latex">latex</a></code> for
details on the operation of the <code>latex</code> method.<br />
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See
## demo("AEdotplot", package="microplot", ask=TRUE)
</code></pre>

<hr>
<h2 id='latex.trellis'>
Display a table in 'latex' containing panels from <span class="rlang"><b>R</b></span> graphs in
its cells.
</h2><span id='topic+latex.trellis'></span><span id='topic+latex.ggplot'></span><span id='topic+latex.graphicsList'></span><span id='topic+latex.microplotMatrix'></span><span id='topic+latex.includegraphicsMatrix'></span><span id='topic+latex.graphicsClass'></span>

<h3>Description</h3>

<p>Display a table in 'latex' containing panels from <span class="rlang"><b>R</b></span> graphs in
its cells.
Hmisc::latex methods for &quot;trellis&quot;, &quot;ggplot&quot;, &quot;graphicsList&quot;,
&quot;microplotMatrix&quot;, and &quot;includegraphicsMatrix&quot; objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'graphicsClass'
latex(  ## called by trellis, ggplot, graphicsList methods
      object,
      figPrefix=first.word(deparse(substitute(object))),
      title=figPrefix, ## subject to lazy evaluation
      ##
      ## microplot arguments
      device={
        latexcmd &lt;- options()$latexcmd
        if (is.null(latexcmd))
          latexcmd &lt;- "latex"
        switch(latexcmd,
               pdflatex="pdf",
               latex=,
               "postscript")
      },
      ... ## can include arguments to
      ## latex.graphicsClass,
      ## microplot,
      ## as.includegraphics,
      ## latex.includegraphicsMatrix,
      ## latex.default
      )

## S3 method for class 'trellis'
latex( ## calls latex.graphicsClass
      object=stop("trellis object is required", call. = FALSE),
      figPrefix=first.word(deparse(substitute(object))),
      title=figPrefix, ## subject to lazy evaluation
      ... ## can include arguments to
      ## latex.graphicsClass,
      ## microplot,
      ## as.includegraphics,
      ## latex.includegraphicsMatrix,
      ## latex.default
      )

## S3 method for class 'ggplot'
latex( ## calls latex.graphicsClass
      object=stop("ggplot object is required", call. = FALSE),
      figPrefix=first.word(deparse(substitute(object))),
      title=figPrefix, ## subject to lazy evaluation
      ... ## can include arguments to
      ## latex.graphicsClass,
      ## microplot,
      ## as.includegraphics,
      ## latex.includegraphicsMatrix,
      ## latex.default
      )

## S3 method for class 'graphicsList'
latex( ## calls latex.graphicsClass
      object=stop("graphicsList object is required", call. = FALSE),
      figPrefix=first.word(deparse(substitute(object))),
      title=figPrefix, ## subject to lazy evaluation
      ... ## can include arguments to
      ## latex.graphicsClass,
      ## microplot,
      ## as.includegraphics,
      ## latex.includegraphicsMatrix,
      ## latex.default
      )

## S3 method for class 'includegraphicsMatrix'
latex(
      object,
      dataobject, data.first=TRUE,
      title=first.word(deparse(substitute(object))),
      microplotMatrix=NULL,
      arraystretch=1,     ## The normal interrow space is multiplied by arraystretch,
      ##                     so changing it from its default value of 1 to 1.5 makes
      ##                     the rows 1.5 times farther apart.
      ##                     Uses the latex.default argument 'insert.top'.
      bottom.hline.raise=NULL, ## character with latex unit, for example "-10ex"
      ##        arraystretch interferes with bottom.hline.raise
      ##        Pick arraystretch first.
      bottom=if (!is.null(attr(object, "key.name")))
               attr(object, "key.name"),
      col.just.object=rep("c", ncol(object)),
      col.just.dataobject=rep("r", ncol(dataobject)),
      n.cgroup=NULL, ## generated below if cgroup is specified in ... and n.cgroup is not
      ...) ## arguments to latex.default

## S3 method for class 'microplotMatrix'
latex(object,
      title=first.word(deparse(substitute(object))),
      ...) ## all ... arguments are forwarded to both
           ## as.includegraphics and latex.includegraphicsMatrix



</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="latex.trellis_+3A_object">object</code></td>
<td>

<p>For <code>latex.trellis</code>, a <code>"trellis"</code> object,
usually a multi-panel object.
</p>
<p>For <code>latex.ggplot</code>, a <code>"ggplot"</code> object,
usually a multi-panel object.
</p>
<p>For <code>latex.graphicsList</code>, a <code>"graphicsList"</code> object,
usually a list of single panel graphics objects.  All items in the list
must be <code>trellis</code> objects or all must be <code>ggplot</code> objects.
</p>
<p>For <code>latex.microplotMatrix</code>, a
<code>"microplotMatrix"</code> object, the result of calling
<code>microplot</code> on a <code>"trellis"</code> or
<code>"ggplot"</code> object; a matrix of LaTeX filenames,
possibly with <code>axis.names</code> or <code>lab.names</code> or <code>key.name</code>
attributes.
</p>
<p>For <code>latex.includegraphicsMatrix</code>, a
<code>"includegraphicsMatrix"</code> object, the result of
calling <code>as.includegraphics</code> on a
<code>"microplotMatrix"</code> object; a matrix of LaTeX
<code>\includegraphics</code> expressions, possibly with
<code>axis.names</code> or <code>lab.names</code> or <code>key.name</code> attributes.
</p>
</td></tr>
<tr><td><code id="latex.trellis_+3A_device">device</code></td>
<td>
<p>Function used to construct the graphics files.  See <code><a href="#topic+microplot">microplot</a></code>.</p>
</td></tr>
<tr><td><code id="latex.trellis_+3A_dataobject">dataobject</code></td>
<td>
<p>Numeric or character matrix (or data.frame).</p>
</td></tr>
<tr><td><code id="latex.trellis_+3A_data.first">data.first</code></td>
<td>

<p>Logical.  If <code>TRUE</code>, then output file will have <code>dataobject</code> columns
first, then graphics <code>object</code> columns.
If <code>FALSE</code>, then output file will have graphics <code>object</code> columns
first, then <code>dataobject</code> columns.
</p>
</td></tr>
<tr><td><code id="latex.trellis_+3A_figprefix">figPrefix</code></td>
<td>
<p>See <code><a href="#topic+microplot.trellis">microplot.trellis</a></code>.
The 'latex' macro <code>\includegraphics</code> requires that there be no
<code>"."</code> in the filename basename.  We replace all <code>"."</code> in
the <code>figPrefix</code> by <code>"-"</code>.
</p>
</td></tr>
<tr><td><code id="latex.trellis_+3A_title">title</code></td>
<td>
<p>Arguments to <code>Hmisc::latex</code>.</p>
</td></tr>
<tr><td><code id="latex.trellis_+3A_microplotmatrix">microplotMatrix</code></td>
<td>
<p>The <code>microplotMatrix</code> will be made an
attribute of the resulting <code>latex</code> object.</p>
</td></tr>
<tr><td><code id="latex.trellis_+3A_arraystretch">arraystretch</code></td>
<td>
<p>The normal interrow space is multiplied by
<code>arraystretch</code>, so changing it from its default value of 1 to 1.5
makes the rows 1.5 times farther apart.  Uses the <code>latex.default</code>
argument <code>insert.top</code>.
</p>
</td></tr>
<tr><td><code id="latex.trellis_+3A_bottom.hline.raise">bottom.hline.raise</code></td>
<td>
<p>Character string with latex unit, for example
<code>"-10ex"</code>.  <code>arraystretch</code> interacts with <code>bottom.hline.raise</code>. Pick
<code>arraystretch</code> first.
</p>
</td></tr>
<tr><td><code id="latex.trellis_+3A_bottom">bottom</code></td>
<td>
<p>default argument to <code>latex.default</code>'s
<code>insert.bottom</code> argument.</p>
</td></tr>
<tr><td><code id="latex.trellis_+3A_col.just.object">col.just.object</code>, <code id="latex.trellis_+3A_col.just.dataobject">col.just.dataobject</code></td>
<td>

<p>Column justification.  See <code><a href="#topic+formatDF">formatDF</a></code>.

The default centers graph panel columns
and right justifies <code>dataobject</code> columns because it assumes the
<code>dataobject</code> contains formatted (hence aligned) numerical data.
</p>
</td></tr>
<tr><td><code id="latex.trellis_+3A_n.cgroup">n.cgroup</code></td>
<td>
<p>See <code><a href="Hmisc.html#topic+latex">latex</a></code>. When <code>cgroup</code> is
specified it always appears in <code>...</code>. <code>ncgroup</code> is an
optional input here because we have enough information to generate it.</p>
</td></tr>
<tr><td><code id="latex.trellis_+3A_...">...</code></td>
<td>

<p>Arguments to <code>microplot.trellis</code>, <code>microplot.ggplot</code>,
<code>as.includegraphics</code>, <code>latex.includegraphicsMatrix</code>,
<code>latex.default</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The explicit result is a <code>"latex"</code> object containing the name of a
generated <code>.tex</code> file in the current directory.  The file
contains a latex <code>\tabular</code> environment holding a
<code>\table</code>.  The cells of the <code>\table</code> contain each of the
filenames wrapped in an <code>\includegraphics</code> expression.  To get
the name of the created file, you must save the returned value from
the <code>"latex"</code> function and display it with <code>print.default</code>.
</p>
<p>The <code>print</code> method for <code>"latex"</code> objects wraps the generated
file in a minimal complete <code>latex</code> file, runs that file through
the system <code>pdflatex</code> or <code>latex</code> (depending on the value of
<code>options("latexcmd")</code>) to create a <code>pdf</code> file (or <code>dvi</code> file,
depending on the value of <code>options("dviExtension")</code>), and
displays it on the screen.  To get the name of the displayed file, you
must explicitly use the <code>dvi</code> function on the <code>"latex"</code>
object and save the otherwise invisible return value.  If it is a
<code>pdf</code> file it can be included with an <code>\includegraphics</code>
expression into another <code>.tex</code> file for use with <code>pdflatex</code>.
If it is a <code>dvi</code> file it can be converted with <code>dvips</code> to a
<code>.ps</code> file and included with an <code>\includegraphics</code>
expression into another <code>.tex</code> file for use with <code>latex</code>.
</p>


<h3>Value</h3>

<p>The value of these <code>latex</code> methods is a <code>"latex"</code> object
containing two components.
</p>
<table role = "presentation">
<tr><td><code>file</code></td>
<td>
<p>Pathname of the generated <code>.tex</code> file.</p>
</td></tr>
<tr><td><code>style</code></td>
<td>
<p><code>"graphicx"</code>,
indicating that the <code>latex</code> <code>\usepackage{graphicx}</code> is required</p>
</td></tr>
</table>
<p>See <code>demo/HowToUseMicroplot.r</code> for a tutorial.  See the demos in
<code>demo/latex.r</code> and <code>demo/latex-ggplot.r</code> for an elaborate
example.
</p>
<p>When one of the <code>...</code> arguments is <code>file=""</code>, the
generated LaTeX code is printed to standard output.  See the discussion
of the <code>file</code> argument in <code><a href="Hmisc.html#topic+latex">latex</a></code> to learn how
to use this feature with Sweave.
</p>
<p>Function <code>latex.includegraphicsMatrix</code> takes the output of
<code>as.includegraphics</code> as its input and returns a
<code>"latex"</code> object.  If there is a <code>key.name</code> attribute, then it is forwarded to
<code>latex.default</code> as the <code>insert.bottom</code> argument.
The result has an attribute <code>"includegraphicsMatrix"</code>
containing its argument <code>object</code> and an attribute
<code>"microplotMatrix"</code> containing the <code>"microplotMatrix"</code> object
from which the <code>"includegraphicsMatrix"</code> was constructed.
</p>
<p>Function <code>latex.microplotMatrix</code> takes the output of
<code>microplot</code> as its input and forwards it to
<code>latex.includegraphicsMatrix</code>.
All <code>...</code> arguments are forwarded to
<code>latex.includegraphicsMatrix</code>.  The return value is a
<code>"latex"</code> object.
</p>
<p>Functions <code>latex.trellis</code> and <code>latex.ggplot</code> and
<code>latex.graphicsList</code>
take their input and forward it through <code>latex.graphicsClass</code> to
<code>microplot</code>
and then to <code>latex.microplotMatrix</code>.
</p>
<p>The print method for <code>"latex"</code> objects, described in
<code><a href="Hmisc.html#topic+latex">dvi</a></code>,
is to display the latexed file on the screen at 5.5in wide by 7in tall.
The dimensions can be changed by an explicit call to the <code>dvi</code> method with other
dimensions, for example<br />
<code>dvi(latex(MyTrellisObject), height.panel=11, width.panel=8.5)</code><br />
See an example in <code>demo("latex", package="microplot", ask=TRUE)</code>
</p>
<p>The format of the screen display depends on three options described in
<code><a href="#topic+latexSetOptions">latexSetOptions</a></code> and <code><a href="Hmisc.html#topic+latex">latex</a></code>.
</p>
<p>For <code>pdflatex</code> normally use:<br />
<code>latexSetOptions("pdflatex")</code>
</p>
<p>For <code>latex</code> normally use:<br />
latexSetOptions(&quot;latex&quot;)
</p>


<h3>Author(s)</h3>

<p> Richard M. Heiberger &lt;rmh@temple.edu&gt; </p>


<h3>See Also</h3>

<p><code><a href="Hmisc.html#topic+latex">latex</a></code>, <code><a href="#topic+microplot">microplot</a></code>, <code><a href="#topic+as.includegraphics">as.includegraphics</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See the examples in the help files, the demo files, and in the
## examples subdirectory.

## The example here shows how to locate the generated .tex file and the displayed .pdf file.
## The .tex file can be brought into a larger .tex file with an \include statement.
## The .pdf file can be brought into a larger .tex file with an \includegraphics statement.

## Not run: 
## These are the settings for my machines
## Set options for Hmisc::latex
latexSetOptions()

mpgGraph &lt;- lattice::xyplot(mpg ~ wt, group=factor(cyl), data=mtcars,
                            xlim=c(.8, 6.2), ylim=c(9,37),
                            pch=as.character(levels(factor(mtcars$cyl))), cex=2)
mpgGraph ## on your interactive device
mpgLatex &lt;-
  latex(mpgGraph,
        height.panel=2, width.panel=3, ## inch. pick numbers that look right to you.
        height.x.axis=.37, width.y.axis=.44,  ## inch. these require trial and error.
        height.xlab=.18, width.ylab=.27,      ## inch. these require trial and error.
        rowname=NULL,    ## suppress rownames, see ?latex
        colheads=FALSE)  ## suppress colnames, see ?latex
print.default(mpgLatex)  ## file is in your working directory
mpgPdf &lt;- dvi(mpgLatex)
print.default(mpgPdf) ## File is in a temporary directory.
                      ## If Macintosh shows "//", replace by "/" before using.
mpgPdf


## End(Not run)
## Sweave users can bring the generated files directly into their
## document.  See the discussion of the \code{file} argument in
## \code{\link[Hmisc]{latex}} to learn how to use this feature with
## Sweave.
</code></pre>

<hr>
<h2 id='latexSetOptions'>Set the options for use of latex; check whether the options
for latex functions have been specified.</h2><span id='topic+latexSetOptions'></span><span id='topic+latexCheckOptions'></span>

<h3>Description</h3>

<p>Set the options for use of latex; check
whether the options for latex functions have been specified:
if any of<br />
<code>options()[c("latexcmd","dviExtension","xdvicmd")]</code>
are <code>NULL</code>, an error message is displayed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>latexSetOptions(
     latexcmd=c("pdflatex", "latex"),
     dviExtension={
       if (is.null(latexcmd)) NULL
       else
         switch(latexcmd,
                pdflatex="pdf",
                latex="dvi")
     },
     xdvicmd={
       if (is.null(latexcmd)) NULL ## dvips is used, .ps in wd displayed
       else
         switch(latexcmd,
                pdflatex=if (nchar(Sys.which("open")))
                           "open"      ## Macintosh, Windows, SMP linux
                         else
                           "xdg-open", ## ubuntu linux
                latex="dvips") ##
                               ## dvips  Mac, Win: .ps in wd displayed
                               ## xdvi   Mac: Quartz displays image borders
                               ##             and waits until dismissed.
                               ## xdvi   Windows: not on my machine.
                               ## yap    Windows: dvi is displayed
                               ## open   Mac: nothing happens
                               ## open   Windows: yap displays dvi
     }
     )

latexCheckOptions(...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="latexSetOptions_+3A_latexcmd">latexcmd</code>, <code id="latexSetOptions_+3A_dviextension">dviExtension</code>, <code id="latexSetOptions_+3A_xdvicmd">xdvicmd</code></td>
<td>
<p>See <code><a href="Hmisc.html#topic+latex">latex</a></code>.</p>
</td></tr>
<tr><td><code id="latexSetOptions_+3A_...">...</code></td>
<td>

<p>Any arguments to <code>latexCheckOptions</code> are ignored.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These are my recommendations (the default when no arguments are
specified)
for <code>pdflatex</code>:<br />
</p>
<pre>
    options(latexcmd="pdflatex") ## Macintosh, Windows, linux
    options(dviExtension="pdf")  ## Macintosh, Windows, linux

    if (nchar(Sys.which("open"))) {
      options(xdvicmd="open")      ## Macintosh, Windows, SMP linux
    } else {
      options(xdvicmd="xdg-open")  ## ubuntu linux
    }
  </pre>
<p>These are my recommendations for <code>latex</code> (and are the settings
when only the first argument is set to <code>"latex"</code>):<br />
</p>
<pre>
    options(latexcmd="latex")
    options(dviExtension="dvi")
    options(xdvicmd="dvips")
  </pre>


<h3>Value</h3>

<p>For <code>latexSetOptions</code>, the invisible list of the options that were set
by this command.
</p>
<p>For <code>latexCheckOptions</code>, if any <code>NULL</code> options are detected, the
error message is printed.  If all three options have non-<code>NULL</code> values, NULL.
</p>


<h3>Author(s)</h3>

<p> Richard M. Heiberger &lt;rmh@temple.edu&gt; </p>


<h3>See Also</h3>

<p><code><a href="Hmisc.html#topic+latex">latex</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  latexSetOptions() ## default
  latexSetOptions("pdflatex") ## same as default
  latexSetOptions("pdflatex", "pdf", "open") ## same as default on Macintosh, Windows, SMP Unix

  latexSetOptions("latex")
  latexSetOptions("latex", "dvi", "dvips") ## same as above

  latexSetOptions(NULL)
  latexSetOptions(NULL, NULL, NULL) ## same as above

## End(Not run)
</code></pre>

<hr>
<h2 id='layoutCollapse'>
Set the lattice <code>par.settings</code> to remove all marginal space.
</h2><span id='topic+layoutHeightsCollapse'></span><span id='topic+layoutWidthsCollapse'></span><span id='topic+layoutCollapse'></span>

<h3>Description</h3>

<p>Set the lattice <code>par.settings</code> to remove all marginal space.
By default <code>layoutHeightsCollapse</code> and <code>layoutWidthsCollapse</code> set
everything in <code>layout.heights</code> or <code>layout.widths</code> to 0
except for <code>panel</code>.  The user can specify values for all the standard
items in either of those items.<br />
<code>layoutCollapse</code> by default sets <code>layout=c(1,1)</code>,
collapses to 0 all heights and widths except for
<code>panel</code>, removes all labels and strip labels, and sets all axis
lines to <code>col="transparent"</code>.




</p>


<h3>Usage</h3>

<pre><code class='language-R'>layoutCollapse(x,
               xlab="",
               ylab="",
               xlab.top=NULL,
               ylab.right=NULL,
               main=NULL,
               sub=NULL,
               strip=FALSE,
               strip.left=FALSE,
               layout.heights=layoutHeightsCollapse(),
               layout.widths=layoutWidthsCollapse(),
               strip.border=list(col="transparent"),
               axis.line=list(col="transparent"),
               layout=c(1,1),
               ...)
layoutHeightsCollapse(...)
layoutWidthsCollapse(...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="layoutCollapse_+3A_...">...</code></td>
<td>

<p>For <code>layoutCollapse</code> any argument to
<code><a href="lattice.html#topic+update.trellis">update.trellis</a></code>.
</p>
<p>For <code>layoutHeightsCollapse</code> any item name in<br />
<code><a href="lattice.html#topic+trellis.par.get">trellis.par.get</a>()$layout.heights</code>.
</p>
<p>For <code>layoutWidthsCollapse</code> any item name in<br />
<code><a href="lattice.html#topic+trellis.par.get">trellis.par.get</a>()$layout.widths</code>.
</p>
</td></tr>
<tr><td><code id="layoutCollapse_+3A_x">x</code></td>
<td>
<p>Any <code>"trellis"</code> object.</p>
</td></tr>
<tr><td><code id="layoutCollapse_+3A_xlab">xlab</code>, <code id="layoutCollapse_+3A_ylab">ylab</code>, <code id="layoutCollapse_+3A_xlab.top">xlab.top</code>, <code id="layoutCollapse_+3A_ylab.right">ylab.right</code>, <code id="layoutCollapse_+3A_main">main</code>, <code id="layoutCollapse_+3A_sub">sub</code></td>
<td>
<p>Standard <code><a href="lattice.html#topic+xyplot">xyplot</a></code> arguments.</p>
</td></tr>
<tr><td><code id="layoutCollapse_+3A_strip">strip</code>, <code id="layoutCollapse_+3A_strip.left">strip.left</code>, <code id="layoutCollapse_+3A_strip.border">strip.border</code>, <code id="layoutCollapse_+3A_axis.line">axis.line</code>, <code id="layoutCollapse_+3A_layout">layout</code></td>
<td>
<p>Standard <code><a href="lattice.html#topic+xyplot">xyplot</a></code> arguments.</p>
</td></tr>
<tr><td><code id="layoutCollapse_+3A_layout.heights">layout.heights</code>, <code id="layoutCollapse_+3A_layout.widths">layout.widths</code></td>
<td>
<p>Arguments to <code><a href="lattice.html#topic+trellis.par.get">trellis.par.get</a></code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When very small plots are placed inside a LaTeX tabular environment, it is often
helpful
to suppress margins, axes, labels, titles.
</p>


<h3>Value</h3>

<p>For <code>layoutCollapse</code>, a <code>"trellis"</code> object.
</p>
<p>For <code>layoutHeightsCollapse</code> and <code>layoutWidthsCollapse</code>,
a list which may be used as input to the <code>par.settings</code> argument in a
lattice call.
</p>


<h3>Author(s)</h3>

<p> Richard M. Heiberger &lt;rmh@temple.edu&gt; </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  lattice::trellis.par.get("layout.heights")
  lattice::trellis.par.get("layout.widths")
  layoutHeightsCollapse()
  layoutWidthsCollapse()
  layoutWidthsCollapse(axis.left=1)

  A &lt;- lattice::xyplot(Sepal.Length ~ Sepal.Width | Species, data=iris)

  A                 ## one page with three panels

  layoutCollapse(A) ## three pages with one unlabeled panel on each

  layoutCollapse(A, ## one page with panels labeled by ylab
                 layout=c(1,3),
                 ylab=levels(iris$Species),
                 layout.heights=list(axis.bottom=1),
                 layout.widths=list(axis.left=1),
                 axis.line=list(col="green"))

## End(Not run)

## Please see the package documentation for a simple example in context.

## Please see the demos for more interesting examples.
## demo(package="microplot")
</code></pre>

<hr>
<h2 id='LegendrePolyMatrices'>
Legendre Orthogonal Polynomials for various values of alpha and beta.
The dataset is used in the demo(&quot;LegendrePolynomials&quot;).
</h2><span id='topic+LegendrePolyMatrices'></span>

<h3>Description</h3>

<p>Legendre Orthogonal Polynomials for various values of alpha and beta.
The dataset is used in the demo(&quot;LegendrePolynomials&quot;).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("LegendrePolyMatrices")</code></pre>


<h3>Author(s)</h3>

<p> Richard M. Heiberger &lt;rmh@temple.edu&gt; </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## dontrun is to avoid requiring the user to install the polynom and orthopolynom packages

## These matrices are used in the demo showing both latex and msWord tables
##     demo("LegendrePolynomials"       , package="microplot", ask=TRUE)

## Legendre Polynomials
if (require(orthopolynom)) {
LP.score &lt;- function(alpha, beta, m = 4, B = 100) {
  x &lt;- seq(1/B, 1 - 1/B, length = B)
  u &lt;- stats::pbeta(x, alpha, beta)
  poly &lt;-  slegendre.polynomials(m, normalized=TRUE)
  data.frame(x=x, T=sapply(poly[-1], predict, u))
}

alphas &lt;- c(.25, .5, 1)
betas &lt;- c(.25, .5, 1, 2, 10)


## generate LegendrePolyMatrices
LegendrePolyMatrices &lt;- matrix(list(), nrow=length(alphas), ncol=length(betas),
                               dimnames=list(alphas=alphas, betas=betas))
for (alpha in seq(along=alphas))
   for (beta in seq(along=betas))
     LegendrePolyMatrices[[alpha, beta]] &lt;- LP.score(alphas[alpha], betas[beta])

save(LegendrePolyMatrices, file="LegendrePolyMatrices.rda")

detach("package:orthopolynom", unload=TRUE)
detach("package:polynom", unload=TRUE)
} else data(LegendrePolyMatrices)

## End(Not run)
</code></pre>

<hr>
<h2 id='microplot'>
Take a trellis or ggplot object, or graphicsList object (list of
trellis or ggplot objects), and generate a set of graphics files, one
per panel of a multi-panel display.
</h2><span id='topic+microplot'></span><span id='topic+microplot.trellis'></span><span id='topic+microplot.ggplot'></span><span id='topic+microplot.graphicsList'></span>

<h3>Description</h3>

<p>Take a trellis or ggplot object, or graphicsList object (list of
trellis or ggplot objects), and generate a set of graphics files, one
per panel of a multi-panel display.
Additional files are generated for the axes, the axis labels, and the key.
</p>
<p>This help file documents the <code>microplot</code> function.  See
<code><a href="#topic+microplot-package">microplot-package</a></code>
for information on the entire <span class="pkg">microplot</span> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>microplot(object, ...)

## complete for an array of lattice panels
## S3 method for class 'trellis'
microplot(
          object=stop("trellis object is required", call. = FALSE),
          ## object must have class "trellis"
          figPrefix=first.word(deparse(substitute(object))),
          vectorgraph.colname=figPrefix,
          device=c("pdf","postscript","ps","png"),
          res=600, type=getOption("bitmapType"), ## used by png
          height.panel=1, width.panel=1, ## numeric in inches
          collapse=layoutCollapse, ## Zero out unwanted
                                   ## layout.heights and layout.widths.
                                   ## See below for example.
          height.x.axis=height.panel[1],
          axis.line=list(col="black"),
          xaxis.line=axis.line,
          par.settings.x.axis=
            list(layout.heights=list(panel=0, axis.bottom=1,
                                     axis.xlab.padding=0, xlab=0),
                 axis.line=xaxis.line),
          width.y.axis=width.panel[1],
          yaxis.line=axis.line,
          par.settings.y.axis=
            list(layout.widths=list(ylab=0, ylab.axis.padding=0,
                                    axis.left=1, panel=0),
                 axis.line=yaxis.line),
          height.xlab=height.panel[1],
          par.settings.xlab=
            list(layout.heights=list(panel=0, axis.bottom=0,
                                     axis.xlab.padding=0, xlab=1),
                 axis.line=list(col="transparent")),
          width.ylab=width.panel[1],
          par.settings.ylab=
            list(layout.widths=list(ylab=1, ylab.axis.padding=0,
                                    axis.left=0, panel=0),
                 axis.line=list(col="transparent")),
          key=FALSE,    ## FALSE or a list of arguments defining a key
          height.key=height.panel[1], width.key=width.panel[1],
          ...)  ## needed to match generic.  ignored in the trellis method


## S3 method for class 'ggplot'
microplot(object, ## object has class "ggplot"
           collapse=theme_collapse(), ## theme_collapse(...) ?
           figPrefix=first.word(deparse(substitute(object))),
           vectorgraph.colname=figPrefix,
           height.panel=1, ## inch
           width.panel=1,  ## inch
           height.x.axis=height.panel,
           width.y.axis=width.panel,
           height.xlab=height.panel,
           width.ylab=width.panel,
           height.key=height.panel,
           width.key=width.panel,
           tick.text.size=7,
           key=FALSE,  ## FALSE, or a ggplot object which is a valid key
           device=c("pdf","postscript","ps","png"),
           res=600, type=getOption("bitmapType"), ## used by png
            ...)

## S3 method for class 'graphicsList'
microplot(object, ## an array of identically structured,
           ## single-panel, graphics objects (trellis or ggplot)
           ## with dim and dimnames
           figPrefix=first.word(deparse(substitute(object))),
           device=c("pdf","postscript","ps","png"),
           res=600, type=getOption("bitmapType"), ## used by png
           height.panel=1, width.panel=1, ## numeric in inches
           key=FALSE,  ## FALSE, or a trellis or ggplot object which is a valid key
           height.key=height.panel, width.key=width.panel,
           ## valid arguments for microplot.trellis or microplot.ggplot
           ...)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="microplot_+3A_object">object</code></td>
<td>

<p><code>"trellis"</code>, or <code>"ggplot"</code>, or a
<code>graphicsList</code> object of either all similarly constructed
<code>"trellis"</code> objects of all similarly constructed <code>ggplot</code> objects.
</p>
</td></tr>
<tr><td><code id="microplot_+3A_collapse">collapse</code></td>
<td>

<p>Function that zeros out unwanted <code>layout.heights</code> and
<code>layout.widths</code> space for <code>"trellis"</code> objects
(see <code><a href="#topic+layoutCollapse">layoutCollapse</a></code>), or that specifies a <code>"theme"</code>
for <code>ggplot</code> objects (see <code><a href="#topic+theme_collapse">theme_collapse</a></code>).
</p>
</td></tr>
<tr><td><code id="microplot_+3A_figprefix">figPrefix</code></td>
<td>

<p>Character string used as prefix for the generated files.
The 'latex' macro <code>\includegraphics</code> requires that there be no
<code>"."</code> in the filename basename.  We replace all <code>"."</code> in
the <code>figPrefix</code> by <code>"-"</code>.
</p>
</td></tr>
<tr><td><code id="microplot_+3A_vectorgraph.colname">vectorgraph.colname</code></td>
<td>

<p>Character string used as column name when a vector of filenames is
converted to a column matrix of filenames.
</p>
</td></tr>
<tr><td><code id="microplot_+3A_height.panel">height.panel</code>, <code id="microplot_+3A_width.panel">width.panel</code></td>
<td>

<p>Height and width in inches of the generated graphics files.
</p>
</td></tr>
<tr><td><code id="microplot_+3A_height.x.axis">height.x.axis</code>, <code id="microplot_+3A_width.y.axis">width.y.axis</code></td>
<td>
<p>Dimensions for axis
graphics files&mdash;usually smaller than for panel contents.</p>
</td></tr>
<tr><td><code id="microplot_+3A_height.xlab">height.xlab</code>, <code id="microplot_+3A_width.ylab">width.ylab</code></td>
<td>
<p>Dimensions for
graphics files containing axis labels&mdash;usually smaller than for panel contents.</p>
</td></tr>
<tr><td><code id="microplot_+3A_par.settings.x.axis">par.settings.x.axis</code>, <code id="microplot_+3A_par.settings.y.axis">par.settings.y.axis</code>, <code id="microplot_+3A_par.settings.xlab">par.settings.xlab</code>, <code id="microplot_+3A_par.settings.ylab">par.settings.ylab</code></td>
<td>
<p><code>"trellis"</code> only:
<code>par.settings</code> for axis and xlab files.
</p>
</td></tr>
<tr><td><code id="microplot_+3A_axis.line">axis.line</code>, <code id="microplot_+3A_xaxis.line">xaxis.line</code>, <code id="microplot_+3A_yaxis.line">yaxis.line</code></td>
<td>
<p><code>"trellis"</code> only: the usual <code>lwd</code>,
<code>col</code>, <code>cex</code> and such that could be defined in the
<code>scales</code> argument for <code>xyplot</code>.</p>
</td></tr>
<tr><td><code id="microplot_+3A_key">key</code></td>
<td>

<p>Logical or list (for lattice) or ggplot object (for ggplot).
If logical and <code>FALSE</code> there is no key (legend).
If a list for <code>microplot.trellis</code>, it must be defined as described in
<code><a href="lattice.html#topic+xyplot">xyplot</a></code> for <code>"trellis"</code> objects.
If a <code>"ggplot"</code> object for <code>microplot.ggplot</code> it must be a
valid <code>ggplot</code> object and will be displayed in the location
appropriate for a legend.
</p>
</td></tr>
<tr><td><code id="microplot_+3A_height.key">height.key</code>, <code id="microplot_+3A_width.key">width.key</code></td>
<td>

<p>Height and width in inches of key graphics file.  Defaults to same
height and width as the panels.
</p>
</td></tr>
<tr><td><code id="microplot_+3A_device">device</code></td>
<td>

<p>Function used to construct the graphics files.
</p>
<p>For <code>latex</code> with <code>(options("latexcmd")=="pdflatex")</code> use
<code>"pdf"</code> (the default for <code>pdflatex</code>).
</p>
<p>For <code>latex</code> with <code>(options("latexcmd")=="latex")</code> use
<code>"postscript"</code> (the default for <code>latex</code>).
<code>"ps"</code> is equivalent to <code>"postscript"</code>.
</p>
<p>For <code>MSWord</code> use <code>"png"</code>.  <code>png</code> defaults to
<code>res=600, type=getOption("bitmapType")</code>.
</p>
</td></tr>
<tr><td><code id="microplot_+3A_res">res</code>, <code id="microplot_+3A_type">type</code></td>
<td>
<p><code>res</code> is nominal resolution in ppi.  <code>type</code>
is either operating system-specific or <code>"cairo"</code>.  See
<code><a href="grDevices.html#topic+png">png</a></code> and <code><a href="grDevices.html#topic+cairo">cairo</a></code>.</p>
</td></tr>
<tr><td><code id="microplot_+3A_tick.text.size">tick.text.size</code></td>
<td>
<p>Text size of the tick labels in the x and y axes
(<code>microplot.ggplot</code>).</p>
</td></tr>
<tr><td><code id="microplot_+3A_...">...</code></td>
<td>

<p>Arguments to panel function, i.e., <code>cex</code> and such for <span class="pkg">lattice</span>.  Similar
arguments for <span class="pkg">ggplot</span>.  Currently ignored for the
<code>microplot.ggplot</code> function.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Matrix of filenames with same <code>dim</code> and <code>dimnames</code> as the
argument <code>object</code>.  The result has class <code>"microplotMatrix"</code>.
There may be one or more attributes.
</p>
<table role = "presentation">
<tr><td><code>axis.names</code></td>
<td>
<p>contains filenames for the x and y axes.</p>
</td></tr>
<tr><td><code>lab.names</code></td>
<td>
<p>contains filenames for the xlab and ylab.</p>
</td></tr>
<tr><td><code>key.name</code></td>
<td>
<p>contains the filename for key (legend).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Richard M. Heiberger &lt;rmh@temple.edu&gt; </p>


<h3>See Also</h3>

<p><code><a href="#topic+latex.trellis">latex.trellis</a></code>, <code><a href="#topic+as.includegraphics">as.includegraphics</a></code>,
<code><a href="Hmisc.html#topic+latex">latex</a></code>, <code><a href="#topic+msWord">msWord</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See demos
</code></pre>

<hr>
<h2 id='microplot-internal'>Internal microplot functions</h2><span id='topic+optionsCmds'></span><span id='topic+sys'></span><span id='topic+plot_grid'></span><span id='topic+get_legend'></span><span id='topic+latex'></span><span id='topic+dvi'></span>

<h3>Description</h3>

<p>Internal microplot functions.</p>


<h3>Details</h3>

<p><code>optionsCmds</code> and <code>sys</code> and
<code>latex</code> and <code>dvi</code> are imported from <span class="pkg">Hmisc</span>. See
<code><a href="Hmisc.html#topic+sys">sys</a></code>.
</p>
<p><code>plot_grid</code> and <code>get_legend</code> are imported from
<span class="pkg">cowplot</span>. See <code><a href="cowplot.html#topic+plot_grid">plot_grid</a></code> and <code><a href="cowplot.html#topic+get_legend">get_legend</a></code>.
</p>


<h3>Author(s)</h3>

<p> Richard M. Heiberger &lt;rmh@temple.edu&gt; </p>

<hr>
<h2 id='microplotAttrDisplay'>
Specify how to display the microplots for x.axis, y.axis, xlab, ylab, and key.
</h2><span id='topic+microplotAttrDisplay'></span>

<h3>Description</h3>

<p>Specify how to display the microplots for x.axis, y.axis, xlab, ylab, and key.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>microplotAttrDisplay(ii,
                     y.axis=unname(attr(ii, "axis.names")["y"]),
                     x.axis=unname(attr(ii, "axis.names")["x"]),
                     ylab=unname(attr(ii, "lab.names")["y"]),
                     xlab=unname(attr(ii, "lab.names")["x"]),
                     key=attr(ii, "key.name"),
                     columnKey=NULL,
                     label.x.axis="", ## empty, nchar=0
                     label.y.axis=" " ## one space, nchar=1
                     )
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="microplotAttrDisplay_+3A_ii">ii</code></td>
<td>

<p>A <code>"microplotMatrix"</code> or <code>"includegraphicsMatrix"</code> of
filenames of graphics files each containing
one panel of an array of plots.  There may be up to three attributes
containing additional filenames.
</p>
</td></tr>
<tr><td><code id="microplotAttrDisplay_+3A_x.axis">x.axis</code>, <code id="microplotAttrDisplay_+3A_y.axis">y.axis</code></td>
<td>

<p>Vector of filenames containing graphic files of axes.
</p>
</td></tr>
<tr><td><code id="microplotAttrDisplay_+3A_label.x.axis">label.x.axis</code>, <code id="microplotAttrDisplay_+3A_label.y.axis">label.y.axis</code></td>
<td>
<p>Labels that will used in the column
name of the <code>y.axis</code> and the <code>y.axis</code> column for the
<code>x.axis</code> row in the 'latex' display of the graphic.</p>
</td></tr>
<tr><td><code id="microplotAttrDisplay_+3A_xlab">xlab</code>, <code id="microplotAttrDisplay_+3A_ylab">ylab</code></td>
<td>

<p>Vector of filenames containing graphic files of axis labels.
</p>
</td></tr>
<tr><td><code id="microplotAttrDisplay_+3A_key">key</code></td>
<td>

<p>Filename containing a graphics file containing a key (legend).
</p>
</td></tr>
<tr><td><code id="microplotAttrDisplay_+3A_columnkey">columnKey</code></td>
<td>

<p>If the key is non-null, then place its filename as a new last value in
the specified columns.  The column numbering is with respect to the
input ii before the y.axis or ylab are evaluated.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Revised version of the input <code>ii</code>, possibly augmented with additional rows
for the x.axis, xlab, and key, and additional columns for the ylab and
y.axis.  The xlab is ignored unless the x.axis is also specified.
The ylab is ignored unless the y.axis is also specified.
</p>


<h3>Author(s)</h3>

<p> Richard M. Heiberger &lt;rmh@temple.edu&gt; </p>


<h3>See Also</h3>

<p><code><a href="#topic+microplot">microplot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
latexSetOptions()

filenames &lt;-
  structure(c("tt010.pdf", "tt007.pdf", "tt004.pdf", "tt001.pdf",
              "tt011.pdf", "tt008.pdf", "tt005.pdf", "tt002.pdf",
              "tt012.pdf", "tt009.pdf", "tt006.pdf", "tt003.pdf"),
            .Dim = c(4L, 3L),
            .Dimnames = structure(list(
              rr = c("d", "c", "b", "a"),
              cc = c("E", "F", "G")),
              .Names = c("rr", "cc")),
            axis.names = structure(c("tt013.pdf", "tt014.pdf"), .Names = c("x", "y")),
            lab.names = structure(c("tt015.pdf", "tt016.pdf"), .Names = c("x", "y")),
            key.name = "tt017.pdf",
            class = c("microplotMatrix", "matrix"))

filenames

as.includegraphics(filenames, wd=".")

as.includegraphics(filenames, wd=".", as.attr=FALSE) ## default

as.includegraphics(filenames, wd=".", as.attr=TRUE)

as.includegraphics(filenames, wd=".", columnKey=1)

as.includegraphics(filenames, wd=".", columnKey=1:3)

as.includegraphics(filenames, wd=".", xlab=TRUE, ylab=TRUE)

as.includegraphics(filenames, wd=".",
                   label.x.axis="X tick values", label.y.axis="Y tick values")

tt &lt;- data.frame(x=1:4, y=c(2,3,4,1), group=c("A","A","B","B"))
latex(lattice::xyplot(y ~ x | group, data=tt))
latex(lattice::xyplot(y ~ x | group, data=tt),
      label.x.axis="X Range", label.y.axis="Y Range")

demo("AEdotplot", package="microplot", ask=TRUE)


## End(Not run)
</code></pre>

<hr>
<h2 id='msWord'>
Display a table in 'MS Word' containing panels from <span class="rlang"><b>R</b></span> graphs in
its cells.
</h2><span id='topic+msWord'></span><span id='topic+msWord.microplotMatrix'></span><span id='topic+msWord.trellis'></span><span id='topic+msWord.ggplot'></span><span id='topic+msWord.graphicsList'></span><span id='topic+msWord.graphicsClass'></span>

<h3>Description</h3>

<p>Display a table in 'MS Word' containing panels from <span class="rlang"><b>R</b></span> graphs in
its cells.
msWord methods for &quot;trellis&quot;, &quot;ggplot&quot;, &quot;graphicsList&quot;,
&quot;microplotMatrix&quot;, and &quot;includegraphicsMatrix&quot; objects.
The output file can be a <code>.docx</code> or <code>.html</code> file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>msWord(object, ...)

## S3 method for class 'microplotMatrix'
msWord( ## calls msWord.graphicsClass
       object, ## microplotMatrix
       ## (matrix of filenames containing individual panels)
       ## (0 columns permitted)
       filetype=c("docx","html"),
       dataobject=matrix(, nrow(object), 0), ## numeric or character matrix
       data.first=TRUE,
       title=first.word(deparse(substitute(object))),
       rowlabel=title,
       rowname=rownames(object),
       data.header="data",
       graph.header="graph",
       graph.file.directory="./",
       axis.files=attr(object,"axis.names"),
       lab.files=attr(object,"lab.names"),
       key.file=attr(object,"key.name"),
       x.axis=(!is.null(axis.files) &amp;&amp; !is.null(axis.files["x"])),
       y.axis=(!is.null(axis.files) &amp;&amp; !is.null(axis.files["y"])),
       xlab=FALSE,
       ylab=FALSE,
       label.x.axis="",  ## empty, nchar=0
       label.y.axis=" ", ## one space, nchar=1
       height.panel=1, ## inches
       width.panel=1, ## inches
       height.x.axis=height.panel[1], ## inches ## [1] is defensive for lazy evaluation
       width.y.axis=width.panel[1], ## inches
       height.xlab=height.panel[1], ## inches
       width.ylab=width.panel[1], ## inches
       height.key=height.panel[1], ## inches
       width.key=width.panel[1], ## inches
       FlexTableWidths=NULL, ## inches ## value used will be an attribute of result
       rmh.borders=TRUE,
       caption=NULL,
       file=paste0(title, ".", filetype),
       doc.title="Microplot",
       width.rowname=.4,
       width.dataobject=1,
       width.between=.1,
       landscape=FALSE,
       rgroup=NULL,
       n.rgroup=NULL,
       rgroup.exclude.borders=NULL,
       key.align="center",  ## flextable::align
       ...)

## S3 method for class 'graphicsClass'
msWord( ## calls msWord.graphicsClass
           object, ## called by trellis, ggplot, graphicsList methods
           ## microplot arguments
           figPrefix=first.word(deparse(substitute(object))),
           device="png",
           key=FALSE,
           title=figPrefix, ## subject to lazy evaluation
           ... ## can include arguments to
           ## microplot,
           ## msWord.microplotMatrix
           )

## S3 method for class 'trellis'
msWord( ## calls msWord.graphicsClass
           object=stop("trellis object is required", call. = FALSE),
           figPrefix=first.word(deparse(substitute(object))),
           title=figPrefix,
           ... ## can include arguments to
           ## msWord.graphicsClass,
           ## microplot,
           ## msWord.microplotMatrix
           )

## S3 method for class 'ggplot'
msWord(object=stop("ggplot object is required", call. = FALSE),
           figPrefix=first.word(deparse(substitute(object))),
           title=figPrefix,
           ... ## can include arguments to
           ## msWord.graphicsClass,
           ## microplot,
           ## msWord.microplotMatrix
           )

## S3 method for class 'graphicsList'
msWord(object=stop("graphicsList object is required", call. = FALSE),
           ## matrix or vector of trellis objects or ggplot objects,
           ## with dim and dimnames,
           ## normally each containing one panel.
           ## The axes and key will be taken from object[[1]].
           figPrefix=first.word(deparse(substitute(object))),
           title=figPrefix,
           ... ## can include arguments to
           ## msWord.graphicsClass,
           ## microplot,
           ## msWord.microplotMatrix
           )
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="msWord_+3A_object">object</code></td>
<td>

<p><code>"microplotMatrix"</code> (Matrix of filenames containing individual panels) (0 columns permitted).
</p>
</td></tr>
<tr><td><code id="msWord_+3A_filetype">filetype</code></td>
<td>

<p>File extension of generated file.  Character, either <code>"docx"</code> or
<code>"html"</code>.
For <code>filetype="docx"</code> the result is a variable containing the
filename of a generated <code>MS Word</code> file.  See the discussion of
<code>value</code>
below for additional information on the value.
For <code>filetype="html"</code> the result is a variable containing a
<code>flextable</code> object.  See the discussion of <code>value</code> below to learn
how to save the <code>html</code> file.
</p>
</td></tr>
<tr><td><code id="msWord_+3A_dataobject">dataobject</code></td>
<td>

<p>Numeric or character matrix (or data.frame).
</p>
</td></tr>
<tr><td><code id="msWord_+3A_data.first">data.first</code></td>
<td>

<p>Logical.  If <code>TRUE</code>, then output file will have <code>dataobject</code> columns
first, then graphics <code>object</code> columns.
If <code>FALSE</code>, then output file will have graphics <code>object</code> columns
first, then <code>dataobject</code> columns.
</p>
</td></tr>
<tr><td><code id="msWord_+3A_title">title</code></td>
<td>

<p>Basename of generated file.  We replace all <code>"."</code> in
the <code>title</code> by <code>"-"</code>.
</p>
</td></tr>
<tr><td><code id="msWord_+3A_figprefix">figPrefix</code></td>
<td>
<p>See <code><a href="#topic+microplot.trellis">microplot.trellis</a></code>.
The 'latex' macro <code>\includegraphics</code> requires that there be no
<code>"."</code> in the filename basename.  We also enforce this
requirement for
<code>msWord</code>.  We replace all <code>"."</code> in
the <code>figPrefix</code> by <code>"-"</code>.
</p>
</td></tr>
<tr><td><code id="msWord_+3A_rowlabel">rowlabel</code></td>
<td>

<p>Header name for column of rownames in the generated file.
</p>
</td></tr>
<tr><td><code id="msWord_+3A_rowname">rowname</code></td>
<td>
<p>Rownames of constructed table. Default is rownames of
<code>object</code>.  Specify <code>rowname=NULL</code> to suppress the
use of row names.</p>
</td></tr>
<tr><td><code id="msWord_+3A_data.header">data.header</code>, <code id="msWord_+3A_graph.header">graph.header</code></td>
<td>

<p>Header names for groupings of data columns and graph columns.  Used
when both <code>dataobject</code> and <code>object</code> are present, one of them is not missing.
</p>
</td></tr>
<tr><td><code id="msWord_+3A_graph.file.directory">graph.file.directory</code></td>
<td>

<p>Directory containing files named in <code>object</code>.
</p>
</td></tr>
<tr><td><code id="msWord_+3A_axis.files">axis.files</code>, <code id="msWord_+3A_lab.files">lab.files</code>, <code id="msWord_+3A_key.file">key.file</code></td>
<td>
<p>Filenames for graphics files containing
axes, axis labels, and key (legend).
</p>
</td></tr>
<tr><td><code id="msWord_+3A_x.axis">x.axis</code>, <code id="msWord_+3A_xlab">xlab</code></td>
<td>
<p>Logical.  If <code>x.axis==TRUE</code> each column of
graphs will have the <code>x.axis</code> file placed as the last item in that column.
If both are <code>TRUE</code> then the <code>xlab</code> file will be placed in the row
following the <code>x.axis</code> file.</p>
</td></tr>
<tr><td><code id="msWord_+3A_y.axis">y.axis</code>, <code id="msWord_+3A_ylab">ylab</code></td>
<td>
<p>Logical.  If <code>y.axis==TRUE</code> each row of graphs
will have the <code>y.axis</code> file placed as the first item in that row.
If both are <code>TRUE</code>, then the <code>ylab</code> file will be placed on each
row immediately before the <code>y.axis</code> file.</p>
</td></tr>
<tr><td><code id="msWord_+3A_label.x.axis">label.x.axis</code>, <code id="msWord_+3A_label.y.axis">label.y.axis</code></td>
<td>
<p>Labels that will used in the column
name of the <code>y.axis</code> and the <code>y.axis</code> position for the
<code>x.axis</code> in the 'latex' display of the graphic.</p>
</td></tr>
<tr><td><code id="msWord_+3A_height.panel">height.panel</code>, <code id="msWord_+3A_width.panel">width.panel</code>, <code id="msWord_+3A_height.x.axis">height.x.axis</code>, <code id="msWord_+3A_width.y.axis">width.y.axis</code>, <code id="msWord_+3A_height.xlab">height.xlab</code>, <code id="msWord_+3A_width.ylab">width.ylab</code></td>
<td>
<p>See <code><a href="#topic+microplot">microplot</a></code>.</p>
</td></tr>
<tr><td><code id="msWord_+3A_height.key">height.key</code>, <code id="msWord_+3A_width.key">width.key</code>, <code id="msWord_+3A_device">device</code>, <code id="msWord_+3A_key">key</code></td>
<td>
<p>See <code><a href="#topic+microplot">microplot</a></code>.</p>
</td></tr>
<tr><td><code id="msWord_+3A_flextablewidths">FlexTableWidths</code></td>
<td>

<p>Widths of all columns, including header and between columns, in inches.
The default is to base the widths on the widths of individual columns
above.
The actual widths used are returned as an attribute of the returned
filename.
You may wish to examine these values from the first run, and then modify
them on second and later runs.
</p>
</td></tr>
<tr><td><code id="msWord_+3A_rmh.borders">rmh.borders</code></td>
<td>

<p>My preferences for borders on cells based on the American Statistical
Association (<a href="https://academic.oup.com/DocumentLibrary/JSSMET/ASASTYLE_GUIDE.pdf">https://academic.oup.com/DocumentLibrary/JSSMET/ASASTYLE_GUIDE.pdf</a>)
style sheet.  The <span class="pkg">flextable</span> default, with full
borders between rows, does not conform.
</p>
</td></tr>
<tr><td><code id="msWord_+3A_caption">caption</code></td>
<td>

<p>The table will be rendered with a numbered caption containing this
string as the caption value.
</p>
</td></tr>
<tr><td><code id="msWord_+3A_file">file</code></td>
<td>

<p>Name of generated file.
</p>
</td></tr>
<tr><td><code id="msWord_+3A_doc.title">doc.title</code></td>
<td>

<p>Title that appears in the MS Word Properties list.
</p>
</td></tr>
<tr><td><code id="msWord_+3A_width.rowname">width.rowname</code></td>
<td>

<p>Number of inches for the rowname column.
</p>
</td></tr>
<tr><td><code id="msWord_+3A_width.dataobject">width.dataobject</code></td>
<td>

<p>Number of inches for each column In the <code>data.object</code>.
</p>
</td></tr>
<tr><td><code id="msWord_+3A_width.between">width.between</code></td>
<td>

<p>Number of inches for the column between the object (graphs) and the
dataobject (numbers or text).
</p>
</td></tr>
<tr><td><code id="msWord_+3A_landscape">landscape</code></td>
<td>

<p>Logical.  If <code>TRUE</code> then the table is produced in a landscape
orientation.  If <code>FALSE</code>, then in a portrait orientation.
</p>
</td></tr>
<tr><td><code id="msWord_+3A_rgroup">rgroup</code>, <code id="msWord_+3A_n.rgroup">n.rgroup</code>, <code id="msWord_+3A_rgroup.exclude.borders">rgroup.exclude.borders</code></td>
<td>

<p>Argument names borrowed from <code><a href="Hmisc.html#topic+latex">latex</a></code>.
<code>rgroup</code> gives the names of groupings of rows in the table.
<code>n.rgroup</code> gives the number of rows within each group.
<code>rgroup.exclude.borders</code> is not borrowed. It gives the row
numbers of rows which are not to have a border between the rowname and
the body of the table.
</p>
</td></tr>
<tr><td><code id="msWord_+3A_key.align">key.align</code></td>
<td>
<p><code>flextable::align</code> one of <code>left</code>, <code>right</code>, <code>center</code>.</p>
</td></tr>
<tr><td><code id="msWord_+3A_...">...</code></td>
<td>

<p>Additional arguments are currently ignored by
<code>msWord.microplotMatrix</code>.
They are forwarded to other methods by the other functions documented here.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The returned value depends on the <code>filetype</code> argument.
</p>
<p>For <code>filetype="docx"</code>, the value is the name of a generated file
<code>docx</code> file with class <code>"msWordFilename"</code>.  Printing the
returned value will display the generated file on screen.  The result
has an attribute <code>"microplotMatrix"</code> containing its argument
<code>object</code>, which contains the names of the generated microplots.
The result has an attribute showing the actual <code>FlexTableWidths</code>
used.  The user may wish to use the <code>FlexTableWidths</code> argument on
a following run to modify these values.
</p>
<p>For <code>filetype="html"</code>, the value is a <code><a href="flextable.html#topic+flextable">flextable</a></code> object.
Printing the returned value will display the generated table in a
browser window.
If you wish to keep the html object, you MUST save it manually!
The original file is in a temporary directory and will vanish when R is closed.
Switch to the browser window and save the displayed table as a 'Web Archive'
in a directory of your choice.  Choose an appropriate basename for the saved file,
as the default basename of the file is the noninformative <code>"index"</code>.
</p>


<h3>Note</h3>

<p>The <code>msWord</code> function uses facilities provided by the
<span class="pkg">flextable</span> and <span class="pkg">officer</span> packages.
</p>


<h3>Author(s)</h3>

<p> Richard M. Heiberger &lt;rmh@temple.edu&gt; </p>


<h3>Examples</h3>

<pre><code class='language-R'>## See demos.
</code></pre>

<hr>
<h2 id='show.latexConsole'>
Revisions of Hmisc latex and dvi functions that display the generated
latex file on screen and divert the console log to a file.  New
print methods that display Operating System files (ps, docx, html) on screen.
</h2><span id='topic+show.latexConsole'></span><span id='topic+show.dvilC'></span><span id='topic+dvi.latexConsole'></span><span id='topic+show.OSfilename'></span><span id='topic+print.OSfilename'></span>

<h3>Description</h3>

<p>Revisions of Hmisc latex and dvi functions that display the generated
latex file on screen and divert the console log to a file.  New
functions that display Operating System files
(<code>"psFilename"</code>, <code>"msWordFilename"</code>, or <code>"htmlFilename"</code>) on screen.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
## S3 method for class 'latexConsole'
dvi(object, prlog=FALSE, nomargins=TRUE, width=5.5, height=7, ...,
                 ConsoleToFile=TRUE)

## S3 method for class 'latexConsole'
show(object)

## S3 method for class 'dvilC'
show(object, width = 5.5, height = 7,
           ConsoleToFile=TRUE)

## S3 method for class 'OSfilename'
print(x, wait=FALSE, ...)

## S3 method for class 'OSfilename'
show(x, wait=FALSE, ...)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="show.latexConsole_+3A_object">object</code></td>
<td>

<p>For <code>show.latexConsole</code> and <code>dvi.latexConsole</code>, a <code>c("latexConsole","latex")</code>
object created by <code>latex.trellis</code>.
For <code>show.dvilC</code>, a <code>c("dvilC","dvi")</code> object created by <code>dvi.latexConsole</code>.
</p>
</td></tr></table>
<p>x
</p>
<table role = "presentation">
<tr><td><code id="show.latexConsole_+3A_consoletofile">ConsoleToFile</code></td>
<td>
<p>Logical.  <code>TRUE</code> diverts 'latex' and 'dvips'
console output to a file (and prints the file name).
<code>FALSE</code> displays the console output on the 'R' console.</p>
</td></tr>
<tr><td><code id="show.latexConsole_+3A_prlog">prlog</code>, <code id="show.latexConsole_+3A_nomargins">nomargins</code>, <code id="show.latexConsole_+3A_width">width</code>, <code id="show.latexConsole_+3A_height">height</code></td>
<td>
<p>See <code><a href="Hmisc.html#topic+latex">latex</a></code>.</p>
</td></tr>
<tr><td><code id="show.latexConsole_+3A_x">x</code></td>
<td>
<p>The generic functions for <code>print</code> and <code>show</code> require
<code>x</code> as the argument name.</p>
</td></tr>
<tr><td><code id="show.latexConsole_+3A_wait">wait</code></td>
<td>
<p>Logical, defaults to <code>FALSE</code>. Argument to
<code><a href="base.html#topic+system">system</a></code> command.  <code>FALSE</code> indicates the print
should run asynchronously, meaning the R interpreter is
immediately ready for the next command. With <code>TRUE</code> the R
interpreter would wait for the command to finish.</p>
</td></tr>
<tr><td><code id="show.latexConsole_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Extensions to 'Hmisc' functions <code>dvi.latex</code>, <code>show.latex</code>, <code>show.dvi</code>.
</p>


<h3>Value</h3>

<p>For <code>dvi.latexConsole</code>, a <code>c('dvilC', 'dvi')</code> object.
</p>
<p>For <code>show.latexConsole</code> and <code>show.dvilC</code>, when <code>viewer="dvips"</code> a
<code>c("psFilename", "OSfilename")</code> object,
otherwise <code>NULL</code>.
</p>
<p>For <code>print.OSfilename</code>, the input argument is returned invisibly.
For <code>show.OSfilename</code>, <code>NULL</code>.
</p>


<h3>Author(s)</h3>

<p> Richard M. Heiberger &lt;rmh@temple.edu&gt; </p>


<h3>See Also</h3>

<p><code><a href="Hmisc.html#topic+latex">latex</a></code>, <code><a href="#topic+microplot-package">microplot-package</a></code>.
</p>

<hr>
<h2 id='theme_collapse'>
Set the <span class="pkg">ggplot2</span> theme to remove all marginal space.
</h2><span id='topic+theme_collapse'></span>

<h3>Description</h3>

<p>Set the ggplot2 theme to remove all marginal space.
By default the grid, ticks, tick labels, and axis labels are set to blank.
Margins are set to 0.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  theme_collapse(      ## the commented values are from theme_grey
  panel.grid.major=eb, ## element_line(colour = "white")
  panel.grid.minor=eb, ## element_line(colour = "white", size = 0.25)
  axis.ticks=eb,       ## element_line(colour = "grey20")
  axis.text=eb,        ## element_text(size = rel(0.8), colour = "grey30")
  axis.title=eb,       ## axis.title.x = element_text(
                       ##    margin = margin(t = 0.8 * half_line,
                       ##                    b = 0.8 * half_line/2))
                       ## axis.title.y = element_text(angle = 90,
                       ##    margin = margin(r = 0.8 * half_line,
                       ##                    l = 0.8 * half_line/2))
  plot.margin= grid::unit(c(0, 0, 0, 0), "in"),
  ...,
  eb=ggplot2::element_blank())
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="theme_collapse_+3A_panel.grid.major">panel.grid.major</code>, <code id="theme_collapse_+3A_panel.grid.minor">panel.grid.minor</code>, <code id="theme_collapse_+3A_axis.ticks">axis.ticks</code>, <code id="theme_collapse_+3A_axis.text">axis.text</code>, <code id="theme_collapse_+3A_axis.title">axis.title</code>, <code id="theme_collapse_+3A_plot.margin">plot.margin</code></td>
<td>

<p><span class="pkg">ggplot2</span> theme elements.  See <code><a href="ggplot2.html#topic+theme">theme</a></code> for information.
</p>
</td></tr>
<tr><td><code id="theme_collapse_+3A_...">...</code></td>
<td>

<p>Other valid arguments to <code>ggplot2::theme</code>.
</p>
</td></tr>
<tr><td><code id="theme_collapse_+3A_eb">eb</code></td>
<td>
<p>Convenience for <code>ggplot2::element_blank()</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When very small plots are placed inside a LaTeX tabular environment, it is often
helpful
to suppress margins, axes, labels, titles.
</p>


<h3>Value</h3>

<p>A ggplot2 theme object.
</p>


<h3>Note</h3>

<p>The first draft of theme_collapse was written by Karen Byron.
</p>


<h3>Author(s)</h3>

<p> Richard M. Heiberger &lt;rmh@temple.edu&gt; </p>


<h3>Examples</h3>

<pre><code class='language-R'>theme_collapse()
## Please see the package documentation for a simple example in context.

## Please see the demos for more interesting examples.
## demo(package="microplot")
</code></pre>

<hr>
<h2 id='toxicity'>
Simulated toxicity data.  Dataset is used in demo(&quot;tablesPlusGraphicColumn&quot;).
</h2><span id='topic+toxicity'></span>

<h3>Description</h3>

<p>Simulated toxicity data.  Used in <code>demo("tablesPlusGraphicsColumn", package="microplot")</code>.
The demo shows a likert plot <code><a href="HH.html#topic+likert">likert</a></code> embedded in a
table of numbers in both 'LaTeX' and 'MS Word'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("toxicity")</code></pre>


<h3>Format</h3>

<p>A data frame with 4 observations on the following 5 variables.
</p>

<dl>
<dt><code>Grade1</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>Grade2</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>Grade3</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>Grade4</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>Grade5</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p> Richard M. Heiberger &lt;rmh@temple.edu&gt; </p>


<h3>Examples</h3>

<pre><code class='language-R'>## see demo("tablesPlusGraphicsColumn", package="microplot")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
