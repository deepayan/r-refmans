<!DOCTYPE html><html><head><title>Help for package variosig</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {variosig}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#variosig-package'><p>Testing Spatial Dependence Using Empirical Variogram</p></a></li>
<li><a href='#envelope'><p>Generate Pointwise Variogram Envelope</p></a></li>
<li><a href='#envplot'><p>Plot Empirical Variogram and its Pointwise Envelope</p></a></li>
<li><a href='#envsig'><p>Determine Significance of Spatial Dependence Using Pointwise Variogram Envelope</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Imports:</td>
<td>gstat, sp, testthat</td>
</tr>
<tr>
<td>Suggests:</td>
<td>geoR</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1.0)</td>
</tr>
<tr>
<td>Title:</td>
<td>Testing Spatial Dependence Using Empirical Variogram</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3-1</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Craig Wang &lt;craig.wang@math.uzh.ch&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Applying Monte Carlo permutation to generate pointwise variogram envelope and checking for spatial dependence at different scales using permutation test. Empirical Brown's method and Fisher's method are used to compute overall p-value for hypothesis test.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-02-08 12:18:49 UTC; crwang</td>
</tr>
<tr>
<td>Author:</td>
<td>Craig Wang <a href="https://orcid.org/0000-0003-1804-2463"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre],
  Reinhard Furrer <a href="https://orcid.org/0000-0002-6319-2332"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-02-09 19:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='variosig-package'>Testing Spatial Dependence Using Empirical Variogram</h2><span id='topic+variosig-package'></span>

<h3>Description</h3>

<p>Applying Monte Carlo permutation to generate pointwise variogram envelope and checking for spatial dependence at different scales using permutation test. Empirical Brown's method and Fisher's method are used to compute overall p-value for hypothesis test.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> variosig</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 0.3-1</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2020-02-08</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 3) </td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>


<h3>Author(s)</h3>

<p>Craig Wang <a href="mailto:craig.wang@uzh.ch">craig.wang@uzh.ch</a> <br />
</p>

<hr>
<h2 id='envelope'>Generate Pointwise Variogram Envelope</h2><span id='topic+envelope'></span><span id='topic+envelope.gstatVariogram'></span><span id='topic+envelope.variogram'></span>

<h3>Description</h3>

<p>Apply Monte Carlo permutation on the data values over different locations, and compute the variogram estimates for each permutation. The pointwise variogram envelope is taken based on quantiles of variogram estimates at each distance binning.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gstatVariogram'
envelope(vario, data, locations = coordinates(data),
  formula = NULL, cluster = FALSE, n.cluster = NULL,
  nsim = 999, conf.level = 0.95, save.sim = FALSE, ...)

## S3 method for class 'variogram'
envelope(vario, data, locations = data$coords,
  trend = NULL, cluster = FALSE, n.cluster = NULL,
  nsim = 999, conf.level = 0.95, save.sim = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="envelope_+3A_vario">vario</code></td>
<td>
<p>variogram of class <code>gstatVariogram</code> from the <code>gstat</code> package or <code>variogram</code> from the <code>geoR</code> package.</p>
</td></tr>
<tr><td><code id="envelope_+3A_data">data</code></td>
<td>
<p>an object of class <code>SpatialPointsDataFrame</code> if <code>vario</code> is from <code>geoR</code> or class <code>geodata</code> if <code>vario</code> is from <code>gstat</code>.</p>
</td></tr>
<tr><td><code id="envelope_+3A_locations">locations</code></td>
<td>
<p>matrix. Contains x-coordinates in the first column and y-coordinates in the second column.</p>
</td></tr>
<tr><td><code id="envelope_+3A_formula">formula</code></td>
<td>
<p>only works with <code>gstat</code> package, a formula defining the response variable and possible covariates.</p>
</td></tr>
<tr><td><code id="envelope_+3A_trend">trend</code></td>
<td>
<p>only works with <code>geoR</code> package, definng the response variable and possible covariates. See documentation of <code><a href="geoR.html#topic+trend.spatial">trend.spatial</a></code> for further details.</p>
</td></tr>
<tr><td><code id="envelope_+3A_cluster">cluster</code></td>
<td>
<p>logical. If <code>TRUE</code>, clustering-based permutation is used. See Details.</p>
</td></tr>
<tr><td><code id="envelope_+3A_n.cluster">n.cluster</code></td>
<td>
<p>integer. The number of clusters used in the permutation. Only used when <code>cluster = TRUE</code>.</p>
</td></tr>
<tr><td><code id="envelope_+3A_nsim">nsim</code></td>
<td>
<p>integer. The number of permutations conducted to compute the envelope. The default is 999.</p>
</td></tr>
<tr><td><code id="envelope_+3A_conf.level">conf.level</code></td>
<td>
<p>confidence level of the envelope. The default is 0.95.</p>
</td></tr>
<tr><td><code id="envelope_+3A_save.sim">save.sim</code></td>
<td>
<p>logical. If <code>TRUE</code>, save all the permutated data.</p>
</td></tr>
<tr><td><code id="envelope_+3A_...">...</code></td>
<td>
<p>any other arguments that will be passed to variogram computation using either <code><a href="gstat.html#topic+variogram">variogram</a></code> from <code>gstat</code> package or <code><a href="geoR.html#topic+variog">variog</a></code> from <code>geoR</code> package.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There are two possible permutation methods implemented. If <code>cluster = FALSE</code>, complete spatial randomness is assumed and values are permuted over all locations. If <code>cluster = TRUE</code>, spatial dependence at small scales is assumed and and values are permuted only within clusters which are determined using kmeans clustering over spatial locations. When the interest is about the existence of spatial dependence at small scales, <code>cluster = TRUE</code> is preferred to acheive a higher statistical power.
</p>


<h3>Value</h3>

<p>A list with the following elements:
</p>
<table>
<tr><td><code>data</code></td>
<td>
<p>contains a list of all permutated data, only exists if <code>save.sim=TRUE</code></p>
</td></tr>
<tr><td><code>variogram</code></td>
<td>
<p>the original variogram estimates and estimates from each of the permutations</p>
</td></tr>
<tr><td><code>upper</code></td>
<td>
<p>upper quantile of the variogram estimates according to the confidence level</p>
</td></tr>
<tr><td><code>lower</code></td>
<td>
<p>lower quantile of the variogram estimates according to the confidence level</p>
</td></tr>
<tr><td><code>data.values</code></td>
<td>
<p>the values used for variogram estimation, namely the residuals after removing covariates' effect</p>
</td></tr>
<tr><td><code>variogram0</code></td>
<td>
<p>the original variogram supplied via <code>vario</code> argument</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Craig Wang, Reinhard Furrer</p>


<h3>References</h3>

<p>Diggle, P.J., Ribeiro, P.J. (2007), Model-Based Geostatistics, Springer Series in Statistics. Springer.
</p>
<p>Wang, C., Furrer, R. (2018) Monte Carlo Permutation Tests for Assessing Spatial Dependence at Difference Scales. Nonparametric Statistics. (Submitted)</p>


<h3>See Also</h3>

<p><code><a href="#topic+envplot">envplot</a></code> to plot an empirical variogram based on the data and its envelope
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(sp)
data(meuse)

## for gstat variogram

library(gstat)
data(meuse)
coordinates(meuse) = ~x+y
vario0 &lt;- gstat::variogram(log(zinc)~1, meuse)
varioEnv &lt;- envelope(vario0, data = meuse,
  formula = log(zinc)~1, nsim = 499, cluster = TRUE, n.cluster = 10)

## for geoR variog

library(geoR)
data(meuse)
meuse &lt;- as.geodata(meuse, coords.col = 1:2, data.col = 6, covar.col = 3:5)
meuse$data &lt;- log(meuse$data)
vario0 &lt;- variog(meuse,max.dist=1500)
varioEnv &lt;- envelope(vario0, data = meuse,
  trend = trend.spatial(~lead, meuse), nsim = 499)

## End(Not run)</code></pre>

<hr>
<h2 id='envplot'>Plot Empirical Variogram and its Pointwise Envelope</h2><span id='topic+envplot'></span>

<h3>Description</h3>

<p>Plot empirical variogram and its pointwise variogram envelope.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>envplot(envlist, shade = TRUE, shade.color = "lightgrey",
        show.variance = FALSE, xlim = NULL, ylim = NULL,
        main = NULL, xlab = "Distance", ylab = "Semivariance")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="envplot_+3A_envlist">envlist</code></td>
<td>
<p>output from <code>envelope</code> function.</p>
</td></tr>
<tr><td><code id="envplot_+3A_shade">shade</code></td>
<td>
<p>logical. If <code>TRUE</code>, the envelope is shaded.</p>
</td></tr>
<tr><td><code id="envplot_+3A_shade.color">shade.color</code></td>
<td>
<p>string. Color of the envelope if it is shaded.</p>
</td></tr>
<tr><td><code id="envplot_+3A_show.variance">show.variance</code></td>
<td>
<p>logical. Plot horizontal lines showing the sample variance and its confidence interval of residuals ignoring spatial information.</p>
</td></tr>
<tr><td><code id="envplot_+3A_xlim">xlim</code>, <code id="envplot_+3A_ylim">ylim</code></td>
<td>
<p>x-axis and y-axis range. If <code>NULL</code>, default values are chosen.</p>
</td></tr>
<tr><td><code id="envplot_+3A_main">main</code></td>
<td>
<p>string. Title of the plot.</p>
</td></tr>
<tr><td><code id="envplot_+3A_xlab">xlab</code>, <code id="envplot_+3A_ylab">ylab</code></td>
<td>
<p>string. Labels for x- and y-axis.</p>
</td></tr>
</table>


<h3>Value</h3>

<p> Nothing is returned, generates a plot.</p>


<h3>Author(s)</h3>

<p> Craig Wang </p>


<h3>See Also</h3>

<p><code><a href="#topic+envelope">envelope</a></code> to use Monte Carlo permutations for generating variogram envelope.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(sp)
data(meuse)
coordinates(meuse) = ~x+y
vario0 &lt;- gstat::variogram(log(zinc)~1, meuse)
varioEnv &lt;- envelope(vario0, data = meuse, formula = log(zinc)~1, nsim = 499)
envplot(varioEnv)

## End(Not run)
</code></pre>

<hr>
<h2 id='envsig'>Determine Significance of Spatial Dependence Using Pointwise Variogram Envelope</h2><span id='topic+envsig'></span>

<h3>Description</h3>

<p>Determine the significance of spatial dependence at different scales using pointwise variogram envelope based on permutation test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>envsig(envlist, index = NULL, method = c("eb", "fisher", "min"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="envsig_+3A_envlist">envlist</code></td>
<td>
<p>output from <code>envelope</code> function.</p>
</td></tr>
<tr><td><code id="envsig_+3A_index">index</code></td>
<td>
<p>integer. Indicating the index which the permutation test for spatial dependence is performed up to. For example, <code>index = 2</code> indicates only the first two variogram estimates are considered in the hypothesis test, i.e. null hypothesis is there is no spatial dependence at small scales. If <code>NULL</code>, all variogram estimates are considered, which corresponds to the null hypothesis of no overall spatial dependence.</p>
</td></tr>
<tr><td><code id="envsig_+3A_method">method</code></td>
<td>
<p>string. One of p-value combination methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The default and preferred method for computing overall p-value is &quot;eb&quot; (empirical Brown's method), which has good power and close to nominal type I error rate. &quot;fisher&quot; (Fisher's method assumes independent pointwise p-values and requires higher sample size to achieve good power. &quot;min&quot; has the highest power but also much higher type I error rate.
</p>


<h3>Value</h3>

<p> A list contains:
</p>
<table>
<tr><td><code>p.pointwise</code></td>
<td>
<p> Adjusted pointwise p-values.</p>
</td></tr>
<tr><td><code>p.overall</code></td>
<td>
<p> Overall p-value of the permutation test.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Craig Wang</p>


<h3>References</h3>

<p>Walker, D. D., J. C. Loftis, and J. P. W. Mielke (1997). Permutation methods for determining the significance of spatial dependence. Mathematical Geology 29(8), 1011–1024.
</p>
<p>Fisher R. A. (1932). Statistical methods for research workers, 4th ed. Oliver &amp; Boyd.
</p>
<p>Poole, W., D. L. Gibbs, I. Shmulevich, B. Bernard, and T. A. Knijnenburg (2016). Combining dependent P-values with an empirical adaptation of Brown’s method. Bioinformatics 32(17), 430–436.
</p>
<p>Wang, C., Furrer, R. (2018) Monte Carlo Permutation Tests for Assessing Spatial Dependence at Difference Scales. Nonparametric Statistics. (Submitted)</p>


<h3>See Also</h3>

<p><code><a href="#topic+envelope">envelope</a></code> to use Monte Carlo permutations for generating variogram envelope.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(sp)
data(meuse)
coordinates(meuse) = ~x+y
vario0 &lt;- gstat::variogram(log(zinc)~1, meuse)
varioEnv &lt;- envelope(vario0, data = meuse, formula = log(zinc)~1,
  nsim = 500, cluster = TRUE, n.cluster = 10)
envplot(varioEnv)
envsig(varioEnv, index = 2, method = "eb")

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
