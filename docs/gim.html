<!DOCTYPE html><html><head><title>Help for package gim</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {gim}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#gim-package'>
<p>Generalized Integration Model</p></a></li>
<li><a href='#dat'>
<p>Data for example in <code>gim</code></p></a></li>
<li><a href='#gim'>
<p>Fitting Generalized Integration Models</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Generalized Integration Model</td>
</tr>
<tr>
<td>Version:</td>
<td>0.33.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-06-12</td>
</tr>
<tr>
<td>Author:</td>
<td>Han Zhang, Kai Yu</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Han Zhang &lt;zhangh.ustc@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>numDeriv</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements the generalized integration model, which integrates individual-level data and summary statistics under a generalized linear model framework. It supports continuous and binary outcomes to be modeled by the linear and logistic regression models. For binary outcome, data can be sampled in prospective cohort studies or case-control studies. Described in Zhang et al. (2020)&lt;<a href="https://doi.org/10.1093%2Fbiomet%2Fasaa014">doi:10.1093/biomet/asaa014</a>&gt;. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/zhangh12/gim">https://github.com/zhangh12/gim</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/zhangh12/gim/issues">https://github.com/zhangh12/gim/issues</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-06-12 06:24:07 UTC; Xiaojian</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-06-12 09:10:24 UTC</td>
</tr>
</table>
<hr>
<h2 id='gim-package'>
Generalized Integration Model
</h2><span id='topic+gim-package'></span>

<h3>Description</h3>

<p><code>gim</code> implements the generalized integration model proposed in Zhang et al. (2018). <code>gim</code> integrates individual-level data and summary statistics under a generalized linear model framework. It supports continuous and binary outcomes to be modeled by the linear and logistic regression models. For binary outcome, data can be sampled in prospective cohort studies or case-control studies. <code>gim</code> uses <b><em>different</em></b> methods to model binary outcome under <b><em>different</em></b> designs. 
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> gim</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 0.17.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2019-02-25</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> MIT + file LICENSE</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Meta-analysis has become a powerful tool for enhanced inference by gathering evidence from multiple sources. It pools summary-level data, i.e. estiamtes of model coefficients, from different studies to improve estimating efficiency under the assumption that all participating studies are analyzed under the same statistical model. This assumption, however, is usually not true in practice as studies may adjust for different covariates according to specific purpose, or are conduct on partial observed covariates they collect. Meta-analysis can lead to biased estimates when this assumption is violated. 
</p>
<p>It is challenging to integrate external summary data calculated from different models with a newly conducted internal study in which individual-level data is collected. <code>gim</code> is a novel statistical inference framework based on the <b>G</b>eneralized <b>I</b>ntegration <b>M</b>odel, which effectively synthesizes internal and external information according to their variations for multivariate analysis. This new framework is versatile to incorporate various types of summary data from multiple sources. It can be showed that the <code>gim</code> estimate is theoretically more efficient than the internal data based maximum likelihood estimate, and the recently developed constraint maximum likelihood estimate that incorporates the outside information. 
</p>
<p>The <code>gim</code> function implemented in this package accounts for the sample sizes shared by different studies. Ignoring this sample overlap may lead to inflated false positive. <code>gim</code> requires estimates of coefficients in external working models, but do not rely on their standard errors for two reasons. (1) It is more convenient to request less information from users, especially when the unrequired information could be estimated with other given information. (2) The standard errors reported in literatures where users collect their external data maybe underestimated as a working model rather than a true underlying model was assumed. 
</p>
<p>The <code>gim</code> always requests a set of raw data in which both outcome and independent variables are available. This dataset is called the reference set or internal data. This requirement seems unconvenient as outcome can sometimes be expensive, and some other approaches may be applicable with a reference where only independent variables are collected. Theoretically, an slightly extended <code>gim</code> can become workable under the same circumstances, however, we suggest to be more careful to do so. A reference is used to estimate correlation between variables (including outcome) in the population of interest. In practice, there could be a difference in the population of your own study and external studies (from which summary information are collected), therefore, the correlation differ among studies. Conducting an analysis soly relying on a set of independent variables may be biased if the difference between studies is significant. In comparison, a full set of reference consisting of outcome can make the analysis more robust to the potential population difference.
</p>
<p>The main function in this package is <code><a href="#topic+gim">gim</a></code>. 
</p>


<h3>Author(s)</h3>

<p>Han Zhang, Kai Yu
</p>
<p>Maintainer: Han Zhang &lt;han.zhang2@nih.gov&gt;
</p>


<h3>References</h3>

<p>Zhang, H., Deng, L., Schiffman, M., Qin, J., Yu, K. (2020) Generalized integration model for improved statistical inference by leveraging external summary data. Biometrika. asaa014, https://doi.org/10.1093/biomet/asaa014
</p>

<hr>
<h2 id='dat'>
Data for example in <code><a href="#topic+gim">gim</a></code>
</h2><span id='topic+dat'></span>

<h3>Description</h3>

<p><code>dat</code> is a data frame used in the example of <code><a href="#topic+gim">gim</a></code>. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("dat")</code></pre>


<h3>Format</h3>

<p>A data frame with 4000 observations on the following 6 variables.
</p>

<dl>
<dt><code>y</code></dt><dd><p>a continuous outcome</p>
</dd>
<dt><code>d</code></dt><dd><p>a binary outcome</p>
</dd>
<dt><code>x1</code></dt><dd><p>a numeric variable</p>
</dd>
<dt><code>x2</code></dt><dd><p>a numeric variable</p>
</dd>
<dt><code>x3</code></dt><dd><p>a numeric variable</p>
</dd>
<dt><code>x4</code></dt><dd><p>a character variable</p>
</dd>
</dl>



<h3>Details</h3>

<p>This is a dataset from which internal and external data are extracted for the example. 
</p>

<hr>
<h2 id='gim'>
Fitting Generalized Integration Models
</h2><span id='topic+gim'></span>

<h3>Description</h3>

<p><code>gim</code> is used to fit generalized integration models, which assume linear or logistic regression model on an (internal) individual-level data, while integrating auxiliary or summary information of relevant variables that are estimated from external data, on which different working models could be assumed. <code>gim</code> can work even if partial information from working models are available. Compared to conventional regression model, e.g., <code><a href="stats.html#topic+glm">glm</a></code>, that is based on internal data, the estimate of <code>gim</code> method gains additional power by making maximum use of all kinds of available data. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gim(formula, family, data, model, nsample = NULL, 
    ncase = NULL, nctrl = NULL, ref = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gim_+3A_formula">formula</code></td>
<td>

<p>an object of class &quot;<code><a href="stats.html#topic+formula">formula</a></code>&quot; (or one that can be coerced to that class): a symbolic description of the model to be fitted on the given dataset. More details of model specification are illustrated in 'Details' and 'Examples'.
</p>
</td></tr>
<tr><td><code id="gim_+3A_family">family</code></td>
<td>

<p>a character. <code>"gaussian"</code> for linear regression. For binary outcome fitted by logistic regression, use <code>"binomial"</code> for random sample, or <code>"case-control"</code> for case-control data. <code>gim</code> employs different methods to make inference on random sample and case-control data. If your data are collected in case-control studies, do not use <code>"binomial"</code>, otherwise inference may be problematic. 
</p>
</td></tr>
<tr><td><code id="gim_+3A_data">data</code></td>
<td>

<p>a data frame containing all variables that are specified in <code>formula</code> and <code>model</code>. Incomplete lines will be discarded. 
</p>
</td></tr>
<tr><td><code id="gim_+3A_model">model</code></td>
<td>

<p>a list describing auxiliary information and working models that are used to generate such information. See 'Details' and 'Examples' for more details.
</p>
</td></tr>
<tr><td><code id="gim_+3A_nsample">nsample</code></td>
<td>

<p>a matrix specifying the number of samples shared in datasets that are used to fit the working models given in <code>model</code>. Specify this argument when <code>family</code> is <code>"gaussian"</code> or <code>"binomial"</code>, otherwise <code>NULL</code>. See 'Details' and 'Examples' for more details.
</p>
</td></tr>
<tr><td><code id="gim_+3A_ncase">ncase</code></td>
<td>

<p>a matrix specifying the number of cases shared in datasets that are used to fit the working models given in <code>model</code>. Specify this argument when <code>family</code> is <code>"case-control"</code>, otherwise <code>NULL</code>. <code>ncase</code> and <code>nctrl</code> should be specified simultaneously. See 'Details' and 'Examples' for more details.
</p>
</td></tr>
<tr><td><code id="gim_+3A_nctrl">nctrl</code></td>
<td>

<p>a matrix specifying the number of controls shared in datasets that are used to fit the working models given in <code>model</code>. Specify this argument when <code>family</code> is <code>case-control</code>, otherwise <code>NULL</code>. See 'Details' and 'Examples' for more details.
</p>
</td></tr>
<tr><td><code id="gim_+3A_ref">ref</code></td>
<td>

<p>a data frame containing the covariates specified in <code>formula</code> and <code>model</code>. It is the reference sample for modeling summary statistics in <code>model</code>. This assumes that <code>ref</code> is sampled from the external population. By default it is <code>NULL</code> which means that the internal and external populations are the same, therefore <code>gim</code> will use <code>data</code> as the reference. Outcome could be absent or missing in <code>ref</code> because <code>gim</code> will anyway ignore it. See 'Details' for more details. 
</p>
</td></tr>
<tr><td><code id="gim_+3A_...">...</code></td>
<td>

<p>for test purpose, use its default value. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><b><code>formula</code> </b>
<code>formula</code> is the model to be used to fit a conventional regression model if no additional information is available. It could be very general as long as it is acceptable to the <code>glm</code> or <code>lm</code> functions. It can eliminate the intercept, <code>y ~ .-1</code>, or involve arithmetic expressions, e.g., <code>log(x)</code>, or other operators like <code>*</code> for interactions <code>as.factor(x1)*I(x2 &gt; 0)</code>.
</p>
<p><b><code>model</code> </b>
Summary information are calculated on data of external studies, but we do not have access to their raw data. Instead, estimates from working model fitted on external data are given (e.g., reported in literature). The argument <code>model</code> is a list, each component contains information of a working model. Specifically, a component is also a list of two entries <code>form</code> and <code>info</code>, where <code>form</code> is a formula representing the fitted working model, and <code>info</code> is a data frame with two columns <code>var</code> and <code>bet</code>, the names of variables and their estimates from the working model, respectively. Usually the estimate of intercept of a working model is unavailable as people fit but do not reporte it. If user is able to provide such an estimate, the name in column <code>var</code> must be <code>"(Intercept)"</code>. See below for an example. 
</p>
<p>Note that multiple working models could be fitted on the same external data, in that case, the summary information of each working model should be given in <code>model</code> separately. For example, on an external dataset, if two models <code>y ~ x1</code> and <code>y ~ x2</code> are fitted, then the estimates of <code>x1</code> and <code>x2</code> should be given as two components in <code>model</code>. This happens as many research groups can study the same datasets from different angles. 
</p>
<p><b><code>data</code> </b>
<code>gim</code> requires an internal dataset <code>data</code> in which individual-level samples are available. Statistically, this data is critical to provide information of correlation between covariates. This data is also known as the reference data in the literatures. Since general formula is supported in <code>gim</code>, it is important to provide variables in <code>data</code> so that <code>R</code> can find columns of all variables parsed from formulas in <code>formula</code> and <code>model</code>. Read vignettes (upcoming) for more examples about how to create a proper <code>data</code> for <code>gim</code>. We will also release a function to help users with this. <code>gim</code> will discard incomplete lines in <code>data</code>. 
</p>
<p><b><code>nsample</code> </b>
Some of summary information can be calculated from datasets that share samples. Ignoring this will lead to underestimated standard error. For example, if a dataset is studied by two different models, the estimates from these two models are not independent but highly correlated. Therefore, this correlation must be properly handled when calculating the standard error of <code>gim</code> estimate, from which a hypothesis testing is conducted. <code>nsample</code> is a squared matrix of dimension <code>p</code>, which is equal to the length of <code>model</code>. Thus, the (i,i) entry in <code>nsample</code> is the number of samples used in fitting the working model specified in <code>model[[i]]$formula</code>, while the (i,k) entry is the number of samples that are involved in fitting working models <code>model[[i]]$formula</code> and <code>model[[k]]$formula</code>. For example, if two working models, e.g., <code>y ~ x1</code> and <code>y ~ x2</code> are fitted on the same dataset of 100 samples, then <code>nsample</code> is a matrix of all entries being 100. Read example below and vignettes (upcoming) for more examples. 
</p>
<p><b><code>ncase</code> </b> and <b><code>nctrl</code> </b>
Specify these two arguments when data are sampled from case-control studies. Refer to <code>nsample</code> for their formats. 
</p>
<p><b><code>ref</code> </b>
By default, <code>ref</code> is <code>NULL</code> if it is not specified explicitly. This assumes that the internal and external populations are the same, and <code>gim</code> will assign <code>data</code> to <code>ref</code> implicitly. If this assumption holds, and you have additional covariates data (no outcome), e.g. <code>add.ref</code>, that also comes from the internal population, you can specified <code>ref</code> as <code>rbind(data, add.ref)</code> where the column of missing outcome in <code>add.ref</code> is set as <code>NA</code>. You can also rbind <code>data</code> and <code>add.ref</code>, with outcome in <code>data</code> being deleted. If the external population is different from the internal population, you have to assign <code>add.ref</code> to <code>ref</code> as reference. 
</p>


<h3>Value</h3>

<p><code>gim</code> returns an object of class &quot;<code>gim</code>&quot;. The function <code><a href="base.html#topic+summary">summary</a></code> can be used to print a summary of the results. We will support the use of <code><a href="stats.html#topic+anova">anova</a></code> in later versions. 
</p>
<p>The generic accessor functions <code><a href="stats.html#topic+coef">coef</a></code>, <code><a href="stats.html#topic+confint">confint</a></code>, and <code><a href="stats.html#topic+vcov">vcov</a></code> can be used to extract coefficients, confidence intervals, and variance-covariance of estimates from the object returned by <code>gim</code>. 
</p>
<p>An object of class &quot;<code>gim</code>&quot; is a list containing the following components:
</p>
<table>
<tr><td><code>coefficients</code></td>
<td>
<p>a named vector of coefficients</p>
</td></tr>
<tr><td><code>vcov</code></td>
<td>
<p>the variance-covariance matrix of estimates, including the intercept</p>
</td></tr>
<tr><td><code>sigma2</code></td>
<td>
<p>estimated variance of error term in a linear model. Only available for the <code>gaussian</code> family</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the matched call</p>
</td></tr>
<tr><td><code>V.bet</code></td>
<td>
<p>the variance-covariance matrix of external estimate <code>bet</code> in <code>model</code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Han Zhang
</p>


<h3>References</h3>

<p>Zhang, H., Deng, L., Schiffman, M., Qin, J., Yu, K. (2020) Generalized integration model for improved statistical inference by leveraging external summary data. Biometrika. asaa014, https://doi.org/10.1093/biomet/asaa014
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## An artificial dataset is lazyloaded to illustrate the concept of GIM method
## It contains:
## A continuous outcome y. 
## Four covariates x1, x2, x3, x4 (character).
## A binary outcome d

head(dat)

## internal data of 500 samples
dat0 &lt;- dat[1:500, ]

## three external datasets.
## dat2 and dat3 share some samples
dat1 &lt;- dat[501:1500, c('y', 'x1', 'x2')]
dat2 &lt;- dat[1501:2500, c('y', 'x1', 'x3', 'x4')]
dat3 &lt;- dat[2001:3000, c('y', 'x3', 'x4')]

## four working models are fitted
form1 &lt;- 'y ~ I(x1 &lt; 0) + I(x2 &gt; 0)'
form2 &lt;- 'y ~ x3 + x4'
form3 &lt;- 'y ~ I(x4 == "a")'
form4 &lt;- 'y ~ sqrt(x3)'

## two working models are fitted on dat3
## thus nsample is a 4x4 matrix
nsample &lt;- matrix(c(1000, 0, 0, 0, 
                    0, 1000, 500, 500, 
                    0, 500, 1000, 1000, 
                    0, 500, 1000, 1000), 
                  4, 4)

fit1 &lt;- summary(lm(form1, dat1))$coef
fit2 &lt;- summary(lm(form2, dat2))$coef
fit3 &lt;- summary(lm(form3, dat3))$coef ## &lt;-- dat3 is used twice
fit4 &lt;- summary(lm(form4, dat3))$coef ## &lt;-- dat3 is used twice

options(stringsAsFactors = FALSE)
model &lt;- list()
## partial information is available
model[[1]] &lt;- list(form = form1, 
                   info = data.frame(var = rownames(fit1)[2], 
                                     bet = fit1[2, 1]))

## intercept is provided, but miss estimate of a covariate
model[[2]] &lt;- list(form = form2, 
                   info = data.frame(var = rownames(fit2)[1:2], 
                                     bet = fit2[1:2, 1]))

model[[3]] &lt;- list(form = form3, 
                   info = data.frame(var = rownames(fit3)[2], 
                                     bet = fit3[2, 1]))

model[[4]] &lt;- list(form = form4, 
                   info = data.frame(var = rownames(fit4)[2], 
                                     bet = fit4[2, 1]))

form &lt;- 'y ~ I(x1 &lt; 0) + I(x1 &gt; 1) + x2 * x4 + log(x3) - 1'
fit &lt;- gim(form, 'gaussian', dat0, model, nsample)

summary(fit)
coef(fit)
confint(fit)

# one can compare the gim estimates with those estimated from internal data
fit0 &lt;- lm(form, dat0)
summary(fit0)

# by default, covariates in dat is used as reference in gim
# which assumes that the external and internal populations are the same
fit1 &lt;- gim(form, 'gaussian', dat0, model, nsample, ref = dat0)
all(coef(fit) == coef(fit1)) # TRUE

# if additional reference is available, 
# and it comes from the internal population from which dat is sampled
# gim can use it
add.ref &lt;- dat[3001:3500, ]
add.ref$y &lt;- NA ## &lt;-- outcome is unavailable in reference
ref &lt;- rbind(dat0, add.ref)
fit2 &lt;- gim(form, 'gaussian', dat0, model, nsample, ref = ref)

# if the external population is different from the internal population
# then reference for summary data specified in model needs to be provided
ext.ref &lt;- dat[3501:4000, ] ## &lt;-- as an example, assume ext.ref is different 
                            ##    from dat0
fit3 &lt;- gim(form, 'gaussian', dat0, model, nsample, ref = ext.ref)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
