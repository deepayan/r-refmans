<!DOCTYPE html><html><head><title>Help for package secure</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {secure}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#CellCycle'><p>Cell cycle data</p></a></li>
<li><a href='#DLBCL'><p>Chemotherapy data</p></a></li>
<li><a href='#rrr.fit'><p>Fit reduced rank regression</p></a></li>
<li><a href='#secure.control'><p>Internal control function for secure</p></a></li>
<li><a href='#secure.path'><p>Sequential Co-Sparse Factor Regression</p></a></li>
<li><a href='#secure.sim'><p>Simulation model</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Sequential Co-Sparse Factor Regression</td>
</tr>
<tr>
<td>Version:</td>
<td>0.6</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-02-22</td>
</tr>
<tr>
<td>Author:</td>
<td>Aditya Mishra [aut, cre], Kun Chen [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Aditya Mishra &lt;aditya.mishra@uconn.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Sequential factor extraction via co-sparse unit-rank estimation (SeCURE).</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.3.1),stats, utils</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 0.12.9), MASS</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3.0)</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>5.0.1</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-02-26 03:13:37 UTC; amishra</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-02-26 10:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='CellCycle'>Cell cycle data</h2><span id='topic+CellCycle'></span>

<h3>Description</h3>

<p>A list of two matrices used in Lee (2002).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(CellCycle)
</code></pre>


<h3>Format</h3>

<p>A list with two components: 
</p>

<dl>
<dt>X</dt><dd><p>Chromatin immunoprecipitation data, a matrix of 1790 rows and 113 columns.</p>
</dd>
<dt>Y</dt><dd><p>Eukariotic cell cycle data, a matrix of 1790 rows and 18 columns.</p>
</dd>
</dl>


<h3>Details</h3>

<p>Matrix X, the chromatin immunoprecipitation (ChIP) data contain complete binding 
information of a subset of 1790 genes for a total of 113 transcription 
factors.
</p>
<p>Matrix Y, the Eukariotic cell cycle data were generated using alpha factor arrest method,
consisting of RNA levels measured every 7 minutes for 119 minutes with a total 
of 18 time points covering two cell cycle of 1790 genes.
</p>


<h3>References</h3>

<p>Lee, T. I., Rinaldi, N. J., Robert, F., Odom, D. T., Bar-Joseph, Z., Gerber, G. K., 
Hannett, N. M., Harbison, C. T., Thompson, C. M., Simon, I. et al. (2002) <em>Transcriptional
regulatory networks in saccharomyces cerevisiae. Science, 298, 799-804</em>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># data(CellCycle)
# X &lt;- CellCycle$X;Y &lt;- CellCycle$Y
# n &lt;- nrow(Y); p &lt;- ncol(X); q &lt;-  ncol(Y)
# control &lt;- secure.control(spU=160/p,spV=1)
# fit.cycle &lt;- secure.path(Y, X, nrank = 10, nlambda = 100,
#                   control = control)
</code></pre>

<hr>
<h2 id='DLBCL'>Chemotherapy data</h2><span id='topic+DLBCL'></span>

<h3>Description</h3>

<p>A list of two components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(DLBCL)
</code></pre>


<h3>Format</h3>

<p>A list with two components: 
</p>

<dl>
<dt>Y</dt><dd><p>Chromatin immunoprecipitation. A matrix of 180 rows and 661 columns.</p>
</dd>
<dt>classIndex</dt><dd><p>Group index of 180 patients where <em>1,2,3</em> corresponds to OxPhos, BCR and HR groups respectively.</p>
</dd>
</dl>


<h3>Details</h3>

<p>Matrix Y : Gene expression dataset from the patients with diffuse large-B-cell lymphoma (DLBCL) after chemotherapy.
The data has been used for unsupervised analysis i.e. Biclustering. The data consists of expression levels of q = 661 genes from n =180 patients. Among the patients, 42, 51 and
87 of them were classified to OxPhos, BCR and HR groups, respectively. The data thus
form an n by q matrix Y whose rows represent the subjects and columns correspond to the
genes, and used in Rosenwald (2002).
</p>
<p>classIndex: Out of OxPhos (oxidative phosphorylation), BCR(Bcell response) and HR (host response),
the index corresponds to the groups in which these 180 subjects belongs as classified by Hoshida (2007).
</p>


<h3>References</h3>

<p>Rosenwald, A., Wright, G., Chan, W. C., Connors, J. M., Campo, E., Fisher, R. I., 
Gascoyne, R. D., Muller-Hermelink, H. K., Smeland, E. B., Giltnane, J. M. et al. (2002) <em>The
use of molecular profling to predict survival after chemotherapy for diffuse large-b-cell
lymphoma. New England Journal of Medicine, 346, 1937-1947</em>.
</p>
<p>Hoshida, Y., Brunet, J.-P., Tamayo, P., Golub, T. R. and Mesirov, J. P. (2007) <em>Subclass
mapping: Identifying common subtypes in independent disease data sets. PLoS ONE, 2,
e1195</em>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># data(DLBCL)
</code></pre>

<hr>
<h2 id='rrr.fit'>Fit reduced rank regression</h2><span id='topic+rrr.fit'></span>

<h3>Description</h3>

<p>fit multivariate reduced rank regression for a specified rank.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rrr.fit(Y, X, nrank = nrank)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rrr.fit_+3A_y">Y</code></td>
<td>
<p>a matrix of response (n by q)</p>
</td></tr>
<tr><td><code id="rrr.fit_+3A_x">X</code></td>
<td>
<p>a matrix of covariate (n by p)</p>
</td></tr>
<tr><td><code id="rrr.fit_+3A_nrank">nrank</code></td>
<td>
<p>an integer specifying the desired rank</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>coef</code></td>
<td>
<p>reduced rank estimate</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>#require(secure)
Y &lt;- matrix(rnorm(400), 100, 4)
X &lt;- matrix(rnorm(800), 100, 8)
rrr.fit &lt;- rrr.fit(Y, X, nrank = 3)
</code></pre>

<hr>
<h2 id='secure.control'>Internal control function for secure</h2><span id='topic+secure.control'></span>

<h3>Description</h3>

<p>list of parameters for controling secure fitting
</p>


<h3>Usage</h3>

<pre><code class='language-R'>secure.control(mu = 1, nu = 1.1, MMerr = 0.001, MMiter = 100,
  outTol = 1e-06, outMaxIter = 200, inMaxIter = 200, inTol = 1e-04,
  lamMaxFac = 1, lamMinFac = 1e-10, gamma0 = 2, elnetAlpha = 0.95,
  spU = 0.25, spV = 0.25)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="secure.control_+3A_mu">mu</code></td>
<td>
<p>penalty parameter used in enforcing orthogonality</p>
</td></tr>
<tr><td><code id="secure.control_+3A_nu">nu</code></td>
<td>
<p>penalty parameter used in enforcing orthogonality (incremental rate of mu)</p>
</td></tr>
<tr><td><code id="secure.control_+3A_mmerr">MMerr</code></td>
<td>
<p>tolerence in the majorization maximization(MM) algorithm for computing initial values when missing value occurs</p>
</td></tr>
<tr><td><code id="secure.control_+3A_mmiter">MMiter</code></td>
<td>
<p>maximum number iterations in the MM algorithm</p>
</td></tr>
<tr><td><code id="secure.control_+3A_outtol">outTol</code></td>
<td>
<p>tolerence of convergence of outer loop in CURE</p>
</td></tr>
<tr><td><code id="secure.control_+3A_outmaxiter">outMaxIter</code></td>
<td>
<p>maximum number of outer loop iteration in CURE</p>
</td></tr>
<tr><td><code id="secure.control_+3A_inmaxiter">inMaxIter</code></td>
<td>
<p>maximum number of inner loop iteration in CURE</p>
</td></tr>
<tr><td><code id="secure.control_+3A_intol">inTol</code></td>
<td>
<p>tolerence value required for convergence of inner loop in CURE</p>
</td></tr>
<tr><td><code id="secure.control_+3A_lammaxfac">lamMaxFac</code></td>
<td>
<p>a multiplier of calculated lambda_max</p>
</td></tr>
<tr><td><code id="secure.control_+3A_lamminfac">lamMinFac</code></td>
<td>
<p>a multiplier of determing lambda_min as a fraction of lambda_max</p>
</td></tr>
<tr><td><code id="secure.control_+3A_gamma0">gamma0</code></td>
<td>
<p>power parameter in the adaptive weights</p>
</td></tr>
<tr><td><code id="secure.control_+3A_elnetalpha">elnetAlpha</code></td>
<td>
<p>elastic net penalty parameter</p>
</td></tr>
<tr><td><code id="secure.control_+3A_spu">spU</code></td>
<td>
<p>maximum proportion of nonzero elements in each column of U</p>
</td></tr>
<tr><td><code id="secure.control_+3A_spv">spV</code></td>
<td>
<p>maximum proportion of nonzero elements in each column of V</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of controling parameter.
</p>

<hr>
<h2 id='secure.path'>Sequential Co-Sparse Factor Regression</h2><span id='topic+secure'></span><span id='topic+secure.path'></span>

<h3>Description</h3>

<p>Sequential factor extraction via co-sparse unit-rank estimation (SeCURE)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>secure.path(Y, X = NULL, nrank = 3, nlambda = 100, U0 = NULL,
  V0 = NULL, D0 = NULL, orthXU = FALSE, orthV = FALSE,
  keepPath = TRUE, control = list(), ic = c("GIC", "BICP", "AIC")[1])
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="secure.path_+3A_y">Y</code></td>
<td>
<p>response matrix</p>
</td></tr>
<tr><td><code id="secure.path_+3A_x">X</code></td>
<td>
<p>covariate matrix; when X = NULL, the fucntion performs unsupervised learning</p>
</td></tr>
<tr><td><code id="secure.path_+3A_nrank">nrank</code></td>
<td>
<p>an integer specifying the desired rank/number of factors</p>
</td></tr>
<tr><td><code id="secure.path_+3A_nlambda">nlambda</code></td>
<td>
<p>number of lambda values to be used along each path</p>
</td></tr>
<tr><td><code id="secure.path_+3A_u0">U0</code></td>
<td>
<p>initial value of U</p>
</td></tr>
<tr><td><code id="secure.path_+3A_v0">V0</code></td>
<td>
<p>initial value of V</p>
</td></tr>
<tr><td><code id="secure.path_+3A_d0">D0</code></td>
<td>
<p>initial value of D</p>
</td></tr>
<tr><td><code id="secure.path_+3A_orthxu">orthXU</code></td>
<td>
<p>if TRUE, orthogonality of XU is required</p>
</td></tr>
<tr><td><code id="secure.path_+3A_orthv">orthV</code></td>
<td>
<p>if TRUE, orthogonality of V is required</p>
</td></tr>
<tr><td><code id="secure.path_+3A_keeppath">keepPath</code></td>
<td>
<p>if TRUE, th solution paths of U, V, D are reported</p>
</td></tr>
<tr><td><code id="secure.path_+3A_control">control</code></td>
<td>
<p>a list of internal parameters controlling the model fitting</p>
</td></tr>
<tr><td><code id="secure.path_+3A_ic">ic</code></td>
<td>
<p>character specifying which information criterion to use for selecting the tuning parameter: &quot;GIC&quot;(default), &quot;BICP&quot;, and &quot;AIC&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>C.est</code></td>
<td>
<p>estimated coefficient matrix; based on modified BIC</p>
</td></tr>
<tr><td><code>U</code></td>
<td>
<p>estimated U matrix (factor weights)</p>
</td></tr>
<tr><td><code>D</code></td>
<td>
<p>estimated singular values</p>
</td></tr>
<tr><td><code>V</code></td>
<td>
<p>estimated V matrix (factor loadings)</p>
</td></tr>
<tr><td><code>ortX</code></td>
<td>
<p>if TRUE, X is treated as an orthogonal matrix in the computation</p>
</td></tr>
<tr><td><code>lam</code></td>
<td>
<p>selected lambda values based on the chosen information criterion</p>
</td></tr>
<tr><td><code>lampath</code></td>
<td>
<p>sequences of lambda values used in model fitting. In each sequential unit-rank estimation step,
a sequence of length nlambda is first generated between (lamMax*lamMaxFac, lamMax*lamMaxFac*lamMinFac) equally 
spaced on the log scale, in which lamMax is estimated and the other parameters are specified in secure.control.
The model fitting starts from the largest lambda and stops when the maximum proportion of nonzero elements is reached in 
either u or v, as specified by spU and spV in secure.control.</p>
</td></tr>
<tr><td><code>IC</code></td>
<td>
<p>values of information criteria</p>
</td></tr>
<tr><td><code>Upath</code></td>
<td>
<p>solution path of U</p>
</td></tr>
<tr><td><code>Dpath</code></td>
<td>
<p>solution path of D</p>
</td></tr>
<tr><td><code>Vpath</code></td>
<td>
<p>solution path of D</p>
</td></tr>
</table>


<h3>References</h3>

<p>Mishra, A., Dey, D., Chen, K. (2017) <em> Sequential Co-Sparse Factor Regression, To appear in Journal of Computational and Graphical Statistics (JCGS)</em>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#require(secure)

# Simulate data from a sparse factor regression model
p &lt;- 100; q &lt;- 100; n &lt;- 200
xrho &lt;- 0.5; nlambda &lt;- 100 
nrank &lt;- 3 

U &lt;- matrix(0,ncol=nrank ,nrow=p);  V &lt;- matrix(0,ncol=nrank ,nrow=q)
U[,1]&lt;-c(sample(c(1,-1),8,replace=TRUE),rep(0,p-8))
U[,2]&lt;-c(rep(0,5),sample(c(1,-1),9,replace=TRUE),rep(0,p-14))
U[,3]&lt;-c(rep(0,11),sample(c(1,-1),9,replace=TRUE),rep(0,p-20))
V[,1]&lt;-c(sample(c(1,-1),5,replace=TRUE)*runif(5,0.3,1),rep(0,q-5))
V[,2]&lt;-c(rep(0,5),sample(c(1,-1),5,replace=TRUE)*runif(5,0.3,1),rep(0,q-10))
V[,3]&lt;-c(rep(0,10),sample(c(1,-1),5,replace=TRUE)*runif(5,0.3,1),rep(0,q-15))
U[,1:3]&lt;- apply(U[,1:3],2,function(x)x/sqrt(sum(x^2)))
V[,1:3]&lt;- apply(V[,1:3],2,function(x)x/sqrt(sum(x^2)))
D &lt;- diag(c(20,15,10)) 
C &lt;- U%*%D%*%t(V)

Xsigma &lt;- xrho^abs(outer(1:p, 1:p,FUN="-"))
sim.sample &lt;- secure.sim(U,D,V,n,snr = 0.25,Xsigma,rho=0.3)
Y &lt;- sim.sample$Y; 
X &lt;- sim.sample$X



# Fitting secure. Set maximum rank to be 4.
rank.ini &lt;- 4

# Set largest model to about 25% sparsity
# See secure.control for setting other parameters
control &lt;- secure.control(spU=0.25, spV=0.25)

# Complete data case. 
# Fit secure without orthogonality
fit.orthF &lt;- secure.path(Y,X,nrank=rank.ini,nlambda = nlambda,
                        control=control)
# check orthogonality
crossprod(X%*%fit.orthF$U)/n
# check solution
# fit.orthF$U
# fit.orthF$V
# fit.orthF$D

# Fit secure with orthogonality if desired. It takes longer time.
# fit.orthT &lt;- secure.path(Y,X,nrank=rank.ini,nlambda = nlambda,
#                                   orthXU=TRUE,orthV=TRUE,control=control)
# check orthogonality
# crossprod(X%*%fit.orthT$U)/n

  
# 15% missing case
miss &lt;- 0.15
t.ind &lt;- sample.int(n*q, size = miss*n*q)
y &lt;- as.vector(Y); y[t.ind] &lt;- NA;  Ym &lt;- matrix(y,n,q)

fit.orthF.miss &lt;- secure.path(Ym, X, nrank = rank.ini, nlambda = nlambda, 
                            control = control) 
# fit.orthT.miss &lt;- secure.path(Ym, X, nrank = rank.ini, nlambda = nlambda,
#                           orthXU=TRUE,orthV=TRUE, control = control)
</code></pre>

<hr>
<h2 id='secure.sim'>Simulation model</h2><span id='topic+secure.sim'></span>

<h3>Description</h3>

<p>genertate random samples from a sparse factor regression model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>secure.sim(U, D, V, n, snr, Xsigma, rho = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="secure.sim_+3A_u">U</code></td>
<td>
<p>specified value of U</p>
</td></tr>
<tr><td><code id="secure.sim_+3A_d">D</code></td>
<td>
<p>specified value of D</p>
</td></tr>
<tr><td><code id="secure.sim_+3A_v">V</code></td>
<td>
<p>specified value of V</p>
</td></tr>
<tr><td><code id="secure.sim_+3A_n">n</code></td>
<td>
<p>sample size</p>
</td></tr>
<tr><td><code id="secure.sim_+3A_snr">snr</code></td>
<td>
<p>signal to noise ratio</p>
</td></tr>
<tr><td><code id="secure.sim_+3A_xsigma">Xsigma</code></td>
<td>
<p>covariance matrix for generating sample of X</p>
</td></tr>
<tr><td><code id="secure.sim_+3A_rho">rho</code></td>
<td>
<p>parameter defining correlated error</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>Y</code></td>
<td>
<p>Generated response matrix</p>
</td></tr>
<tr><td><code>X</code></td>
<td>
<p>Generated predictor matrix</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>#require(secure)

# Simulate data from a sparse factor regression model
p &lt;- 100; q &lt;- 50; n &lt;- 300
snr &lt;- 0.5; ssigma &lt;- 0.5; nlambda &lt;- 200 
nrank &lt;- 3

U &lt;- matrix(0,ncol=nrank ,nrow=p);  V &lt;- matrix(0,ncol=nrank ,nrow=q)
U[,1]&lt;-c(sample(c(1,-1),8,replace=TRUE),rep(0,p-8))
U[,2]&lt;-c(rep(0,5),sample(c(1,-1),9,replace=TRUE),rep(0,p-14))
U[,3]&lt;-c(rep(0,11),sample(c(1,-1),9,replace=TRUE),rep(0,p-20))
V[,1]&lt;-c(sample(c(1,-1),5,replace=TRUE)*runif(5,0.3,1),rep(0,q-5))
V[,2]&lt;-c(rep(0,5),sample(c(1,-1),5,replace=TRUE)*runif(5,0.3,1),rep(0,q-10))
V[,3]&lt;-c(rep(0,10),sample(c(1,-1),5,replace=TRUE)*runif(5,0.3,1),rep(0,q-15))
U[,1:3]&lt;- apply(U[,1:3],2,function(x)x/sqrt(sum(x^2)))
V[,1:3]&lt;- apply(V[,1:3],2,function(x)x/sqrt(sum(x^2)))
D &lt;- diag(c(20,15,10)) 
C &lt;- U%*%D%*%t(V)

Xsigma &lt;- ssigma^abs(outer(1:p, 1:p,FUN="-"))
sim.sample &lt;- secure.sim(U,D,V,n,snr,Xsigma)
Y &lt;- sim.sample$Y
X &lt;- sim.sample$X

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
