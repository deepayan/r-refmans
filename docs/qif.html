<!DOCTYPE html><html><head><title>Help for package qif</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {qif}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#epil'><p>Seizure Counts for Epileptics</p></a></li>
<li><a href='#exacerb'><p>MS data</p></a></li>
<li><a href='#print.qif'><p>Print Function for qif Object</p></a></li>
<li><a href='#print.summary.qif'><p>Print the Summary of qif Object</p></a></li>
<li><a href='#qif'><p>Function to Solve a Quadratic Inference Function Model</p></a></li>
<li><a href='#summary.qif'><p>Summary of a qif Object</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Quadratic Inference Function</td>
</tr>
<tr>
<td>Version:</td>
<td>1.5</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-7-2</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Description:</td>
<td>Developed to perform the estimation and inference for regression 
    coefficient parameters in longitudinal marginal models using the method of 
    quadratic inference functions. Like generalized estimating equations, this 
    method is also a quasi-likelihood inference method. It has been showed that 
    the method gives consistent estimators of the regression coefficients even if 
    the correlation structure is misspecified, and it is more efficient than GEE 
    when the correlation structure is misspecified. Based on Qu, A., Lindsay, 
    B.G. and Li, B. (2000) &lt;<a href="https://doi.org/10.1093%2Fbiomet%2F87.4.823">doi:10.1093/biomet/87.4.823</a>&gt;.</td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-07-18 16:10:38 UTC; mkleinsa</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/umich-biostatistics/qif/issues">https://github.com/umich-biostatistics/qif/issues</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Author:</td>
<td>Zhichang Jiang [aut],
  Peter Song [aut],
  Michael Kleinsasser [cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Michael Kleinsasser &lt;mkleinsa@umich.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-07-20 11:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='epil'>Seizure Counts for Epileptics</h2><span id='topic+epil'></span>

<h3>Description</h3>

<p>The data set consists of seizure counts for 59 individuals with epilepsy. Counts
were recorded for four two-week periods (8 weeks total). Age is the only covariate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>epil
</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> with 236 rows and 9 variables (columns):
</p>

<dl>
<dt>y</dt><dd><p>the count for the 2-week period.</p>
</dd>
<dt>trt</dt><dd><p>treatment, &quot;placebo&quot; or &quot;progabide&quot;.</p>
</dd>
<dt>base</dt><dd><p>the counts in the baseline 8-week period.</p>
</dd>
<dt>age</dt><dd><p>subject's age, in years.</p>
</dd>
<dt>V4</dt><dd><p>0/1 indicator variable of period 4.</p>
</dd>
<dt>subject</dt><dd><p>subject number, 1 to 59.</p>
</dd>
<dt>period</dt><dd><p>period, 1 to 4.</p>
</dd>
<dt>lbase</dt><dd><p>log-counts for the baseline period, centred to have zero mean.</p>
</dd>
<dt>lage</dt><dd><p>log-ages, centred to have zero mean.</p>
</dd>
</dl>


<h3>Source</h3>

<p>Thall, P. F. and Vail, S. C. (1990) Some covariance models for
longitudinal count data with over-dispersion. Biometrics 46, 657â€“671.
</p>


<h3>References</h3>

<p>Venables, W. N. and Ripley, B. D. (2002) Modern Applied Statistics
with S. Fourth Edition. Springer.
</p>

<hr>
<h2 id='exacerb'>MS data</h2><span id='topic+exacerb'></span>

<h3>Description</h3>

<p>MS data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exacerb
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 765 rows and 14 columns.</p>


<h3>Source</h3>

<p>Thal
</p>


<h3>References</h3>

<p>Venab
</p>

<hr>
<h2 id='print.qif'>Print Function for qif Object</h2><span id='topic+print.qif'></span>

<h3>Description</h3>

<p>Print a <code>qif</code> model object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'qif'
print(x, digits = NULL, quote = FALSE, prefix = "",
  ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.qif_+3A_x">x</code></td>
<td>
<p>the <code>qif</code> model object.</p>
</td></tr>
<tr><td><code id="print.qif_+3A_digits">digits</code></td>
<td>
<p>number of digits to print.</p>
</td></tr>
<tr><td><code id="print.qif_+3A_quote">quote</code></td>
<td>
<p>logical, indicating whether or not strings should be printed with
surrounding quotes.</p>
</td></tr>
<tr><td><code id="print.qif_+3A_prefix">prefix</code></td>
<td>
<p>string, only <code>""</code> is implemented.</p>
</td></tr>
<tr><td><code id="print.qif_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The invisible object from the arguments.
</p>


<h3>Author(s)</h3>

<p>Zhichang Jiang, Alberta Health Services, and Peter X.K. Song, University
of Michigan.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+print">print</a></code> <code><a href="#topic+qif">qif</a></code>
</p>

<hr>
<h2 id='print.summary.qif'>Print the Summary of qif Object</h2><span id='topic+print.summary.qif'></span>

<h3>Description</h3>

<p>Prints the summary of a <code>qif</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.qif'
print(x, digits = NULL, quote = FALSE,
  prefix = "", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.summary.qif_+3A_x">x</code></td>
<td>
<p>the <code>qif</code> model object.</p>
</td></tr>
<tr><td><code id="print.summary.qif_+3A_digits">digits</code></td>
<td>
<p>number of digits to print.</p>
</td></tr>
<tr><td><code id="print.summary.qif_+3A_quote">quote</code></td>
<td>
<p>logical, indicating whether or not strings should be printed with
surrounding quotes.</p>
</td></tr>
<tr><td><code id="print.summary.qif_+3A_prefix">prefix</code></td>
<td>
<p>string, only <code>""</code> is implemented.</p>
</td></tr>
<tr><td><code id="print.summary.qif_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The invisible object from the arguments.
</p>
<p>The invisible object from the arguments.
</p>


<h3>Author(s)</h3>

<p>Zhichang Jiang, Alberta Health Services, and Peter X.K. Song, University
of Michigan.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+summary">summary</a></code> <code><a href="#topic+qif">qif</a></code>
</p>

<hr>
<h2 id='qif'>Function to Solve a Quadratic Inference Function Model</h2><span id='topic+qif'></span>

<h3>Description</h3>

<p>Produces an object of class &quot;<code>qif</code>&quot; which is a Quadratic Inference Function fit
of the balanced longitudinal data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qif(formula = formula(data), id = id, data = parent.frame(),
  b = NULL, tol = 1e-08, maxiter = 1000, family = gaussian,
  corstr = "independence", invfun = "finv")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="qif_+3A_formula">formula</code></td>
<td>
<p>a formula expression as for other regression models, of the form
<code>response ~ predictors</code>. See the documentation of <code><a href="stats.html#topic+lm">lm</a></code>
and <code><a href="stats.html#topic+formula">formula</a></code> for details.</p>
</td></tr>
<tr><td><code id="qif_+3A_id">id</code></td>
<td>
<p>a vector which identifies the clusters. The length of <code>id</code> should be
the same as the number of observations. Data are assumed to be sorted so that
observations on a cluster are contiguous rows for all entities in the formula.</p>
</td></tr>
<tr><td><code id="qif_+3A_data">data</code></td>
<td>
<p>an optional data frame in which to interpret the variables occurring
in the <code>formula</code>, along with the <code>id</code> variables.</p>
</td></tr>
<tr><td><code id="qif_+3A_b">b</code></td>
<td>
<p>an initial estimate for the parameters.</p>
</td></tr>
<tr><td><code id="qif_+3A_tol">tol</code></td>
<td>
<p>the tolerance used in the fitting algorithm.</p>
</td></tr>
<tr><td><code id="qif_+3A_maxiter">maxiter</code></td>
<td>
<p>the maximum number of iterations.</p>
</td></tr>
<tr><td><code id="qif_+3A_family">family</code></td>
<td>
<p>a <code>family</code> object: a list of functions and expressions for defining
canonical link and variance functions. Families supported in <code>qif</code> are <code>gaussian</code>,
<code>binomial</code>, <code>poisson</code>, and <code>gamma</code>; see the <code><a href="stats.html#topic+glm">glm</a></code> and <code><a href="stats.html#topic+formula">formula</a></code> documentation. Some links
are not currently available: probit link for binomial family and log link for
gamma family.</p>
</td></tr>
<tr><td><code id="qif_+3A_corstr">corstr</code></td>
<td>
<p>a character string specifying the correlation structure. The
following are permitted: <code>"independence"</code>, <code>"exchangeable"</code>, <code>"AR-1"</code> and <code>"unstructured"</code>.</p>
</td></tr>
<tr><td><code id="qif_+3A_invfun">invfun</code></td>
<td>
<p>a character string specifying the matrix inverse function. The
following are permitted: <code>"finv"</code> and <code>"ginv"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>qif</code> provides two options of computing matrix inverses. The default
is from Fortran math library, and the other one is generalized inverse &quot;<code>ginv</code>&quot;
given in R package <code>MASS</code>. You can call option &quot;<code>ginv</code>&quot; through argument &quot;<code>invfun</code>&quot;
in &quot;<code>qif()</code>&quot;.
</p>


<h3>Value</h3>

<p>A list containing:
</p>

<ul>
<li><p><code>title</code>: name of qif
</p>
</li>
<li><p><code>version</code>: the current version of qif
</p>
</li>
<li><p><code>model</code>: analysis model for link function, variance function and correlation struture
</p>
</li>
<li><p><code>terms</code>: analysis model for link function, variance function and correlation struture
</p>
</li>
<li><p><code>iteration</code>: the number of iterations
</p>
</li>
<li><p><code>coefficients</code>: beta esitmates value
</p>
</li>
<li><p><code>linear.perdictors</code>: linear predictor value
</p>
</li>
<li><p><code>fitted.value</code>: fitted value of y
</p>
</li>
<li><p><code>x</code>: the perdicted matrix
</p>
</li>
<li><p><code>y</code>: the response
</p>
</li>
<li><p><code>residuals</code>: y-mu
</p>
</li>
<li><p><code>pearson.resi</code>: pearson residuals
</p>
</li>
<li><p><code>scale</code>: the scale of fitted model
</p>
</li>
<li><p><code>family</code>: the type of distribution
</p>
</li>
<li><p><code>id</code>: model fitted value
</p>
</li>
<li><p><code>max.id</code>: max number of each steps
</p>
</li>
<li><p><code>xnames</code>: the values are X name of qif
</p>
</li>
<li><p><code>statistics</code>: The qif statistics
</p>
</li>
<li><p><code>Xnames</code>: the name X matrix in qif
</p>
</li>
<li><p><code>parameter</code>: parameter estimates
</p>
</li>
<li><p><code>covariance</code>: Covariance of coefficients
</p>
</li></ul>



<h3>Note</h3>

<p>This R package is created by transplanting a SAS macro QIF developed
originally by Peter Song and Zhichang Jiang (2006). This is version 1.5 of
this user documentation file, revised 2019-07-02.
</p>


<h3>Author(s)</h3>

<p>Zhichang Jiang, Alberta Health Services, and Peter X.K. Song, University
of Michigan.
</p>


<h3>References</h3>

<p>Qu A, Lindsay BG, Li B. Improving generalized estimating equations using quadratic
inference functions. Biometrika 2000, 87 823-836.
</p>
<p>Qu A, Song P X-K. Assessing robustness of generalised estimating equations and
quadratic inference functions. Biometrika 2004, 91 447-459.
</p>
<p>Qu A, Lindsay BG. Building adaptive estimating equations when inverse of covariance
estimation is difficult. J. Roy. Statist. Soc. B 2003, 65, 127-142.
</p>


<h3>See Also</h3>

<p>glm, lm, formula.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Marginal log-linear model for the epileptic seizures count data
## (Diggle et al., 2002, Analysis of Longitudinal Data, 2nd Ed., Oxford Press).

# Read in the epilepsy data set:
data(epil)

# Fit the QIF model:
fit &lt;- qif(y ~ base + trt + lage + V4, id=subject, data=epil,
                                       family=poisson, corstr="AR-1")

# Alternately, use ginv() from package MASS
fit &lt;- qif(y ~ base + trt + lage + V4, id=subject, data=epil,
                      family=poisson, corstr="AR-1", invfun = "ginv")

# Print summary of QIF fit:
summary(fit)

## Second example: MS study
data(exacerb)

qif_BIN_IND&lt;-qif(exacerbation ~ treatment + time + duration + time2, id=id,
                        data=exacerb, family=binomial, corstr="independence")
qif_BIN_AR1&lt;-qif(exacerbation ~ treatment + time + duration + time2, id=id,
                        data=exacerb, family=binomial, corstr="AR-1")
qif_BIN_CS&lt;-qif(exacerbation ~ treatment + time + duration + time2, id=id,
                        data=exacerb, family=binomial, corstr="exchangeable")
qif_BIN_UN&lt;-qif(exacerbation ~ treatment + time + duration + time2, id=id,
                        data=exacerb, family=binomial, corstr="unstructured")

summary(qif_BIN_CS)

qif_BIN_CS$statistics

qif_BIN_CS$covariance


</code></pre>

<hr>
<h2 id='summary.qif'>Summary of a qif Object</h2><span id='topic+summary.qif'></span>

<h3>Description</h3>

<p>Procuce a summary of a <code>qif</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'qif'
summary(object, correlation = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.qif_+3A_object">object</code></td>
<td>
<p>an object for which a summary is desired.</p>
</td></tr>
<tr><td><code id="summary.qif_+3A_correlation">correlation</code></td>
<td>
<p>binary, include correlation.</p>
</td></tr>
<tr><td><code id="summary.qif_+3A_...">...</code></td>
<td>
<p>additional arguements to be passed to <code>summary</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The <code>summary.qif</code> object.
</p>


<h3>Author(s)</h3>

<p>Zhichang Jiang, Alberta Health Services, and Peter X.K. Song, University
of Michigan.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+qif">qif</a></code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
