<!DOCTYPE html><html><head><title>Help for package SCOUTer</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SCOUTer}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#barwithucl'><p>barwithucl</p></a></li>
<li><a href='#custombar'><p>custombar</p></a></li>
<li><a href='#distplot'><p>distplot</p></a></li>
<li><a href='#distplotsimple'><p>displotsimple</p></a></li>
<li><a href='#dotag'><p>dotag</p></a></li>
<li><a href='#dscplot'><p>dscplot</p></a></li>
<li><a href='#ht2info'><p>ht2info</p></a></li>
<li><a href='#obscontribpanel'><p>obscontribpanel</p></a></li>
<li><a href='#pcamb_classic'><p>pcamb_classic</p></a></li>
<li><a href='#pcame'><p>pcame</p></a></li>
<li><a href='#scoreplot'><p>scoreplot</p></a></li>
<li><a href='#scoreplotsimple'><p>scoreplotsimple</p></a></li>
<li><a href='#scout'><p>scout</p></a></li>
<li><a href='#scoutgrid'><p>scoutgrid</p></a></li>
<li><a href='#scoutsimple'><p>scoutsimple</p></a></li>
<li><a href='#scoutsteps'><p>scoutsteps</p></a></li>
<li><a href='#speinfo'><p>speinfo</p></a></li>
<li><a href='#X'><p>Demo dataset</p></a></li>
<li><a href='#xshift'><p>xshift</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Simulate Controlled Outliers</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Using principal component analysis as a base model, 'SCOUTer' 
    offers a new approach to simulate outliers in a simple and precise way. 
    The user can generate new observations defining them by a pair of well-known 
    statistics: the Squared Prediction Error (SPE) and the Hotelling's T^2 (T^2) 
    statistics. Just by introducing the target values of the SPE and T^2, 'SCOUTer' 
    returns a new set of observations with the desired target properties. 
    Authors: Alba Gonz√°lez, Abel Folch-Fortuny, Francisco Arteaga and 
    Alberto Ferrer (2020).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Alba Gonzalez Cebrian &lt;algonceb@upv.es&gt;</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), ggplot2, ggpubr, stats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-06-29 21:47:06 UTC; AlbaGC</td>
</tr>
<tr>
<td>Author:</td>
<td>Alba Gonzalez Cebrian [aut, cre],
  Abel Folch-Fortuny [aut],
  Francisco Arteaga [aut],
  Alberto Ferrer [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-06-30 09:30:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='barwithucl'>barwithucl</h2><span id='topic+barwithucl'></span>

<h3>Description</h3>

<p>Single bar plot with Upper Control Limis. Customized title and labels.
Y-Axis limits are fixed according to the range of the values in x.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>barwithucl(
  x,
  iobs,
  ucl,
  plotname = "",
  ylabelname = "",
  xlabelname = "Obs. Index"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="barwithucl_+3A_x">x</code></td>
<td>
<p>vector with the values of the statistic.</p>
</td></tr>
<tr><td><code id="barwithucl_+3A_iobs">iobs</code></td>
<td>
<p>index of the observations whose value will be displayed.</p>
</td></tr>
<tr><td><code id="barwithucl_+3A_ucl">ucl</code></td>
<td>
<p>Upper Control Limit of the statistic.</p>
</td></tr>
<tr><td><code id="barwithucl_+3A_plotname">plotname</code></td>
<td>
<p>string with the title of the plot. Set to <code>""</code> by default.</p>
</td></tr>
<tr><td><code id="barwithucl_+3A_ylabelname">ylabelname</code></td>
<td>
<p>string with the y-axis label. Set to <code>""</code> by default.</p>
</td></tr>
<tr><td><code id="barwithucl_+3A_xlabelname">xlabelname</code></td>
<td>
<p>string with the y-axis label. Set to <code>"Obs. Index"</code> by default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot object with the individual value of a variable as a geom_col
with an horizontal line reference.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>barwithucl(c(1:10), 6, 5)
barwithucl(c(1:10), 6, 5, plotname = "Plot title", ylabelname = "Y label", 
xlabelname= "X label")
</code></pre>

<hr>
<h2 id='custombar'>custombar</h2><span id='topic+custombar'></span>

<h3>Description</h3>

<p>Bar plot with customized title and labels. Y-Axis limits are fixed
according to the range of the values in X.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>custombar(X, iobs, plotname = "", ylabelname = "Contribution", xlabelname = "")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="custombar_+3A_x">X</code></td>
<td>
<p>matrix with observations as row vectors.</p>
</td></tr>
<tr><td><code id="custombar_+3A_iobs">iobs</code></td>
<td>
<p>index of the observations whose value will be displayed.</p>
</td></tr>
<tr><td><code id="custombar_+3A_plotname">plotname</code></td>
<td>
<p>string with the title of the plot. Set to &quot;&quot; by default.</p>
</td></tr>
<tr><td><code id="custombar_+3A_ylabelname">ylabelname</code></td>
<td>
<p>string with the y-axis label. Set to &quot;Contribution&quot; by default.</p>
</td></tr>
<tr><td><code id="custombar_+3A_xlabelname">xlabelname</code></td>
<td>
<p>string with the y-axis label. Set to &quot;&quot; by default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot object with the values of a vector with a customized geom_col layer.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X &lt;- as.matrix(X)
custombar(X, 2)
custombar(X, 2, plotname = "Observation 2", ylabelname = bquote(x.["j"]), 
xlabelname= "Variables")
</code></pre>

<hr>
<h2 id='distplot'>distplot</h2><span id='topic+distplot'></span>

<h3>Description</h3>

<p>Returns the distance plot providing a dataset and a Principal Component Analysis model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>distplot(
  X,
  pcaref,
  obstag = matrix(0, nrow(X), 1),
  plottitle = "Distance plot\n"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="distplot_+3A_x">X</code></td>
<td>
<p>data matrix with observations to be displayed in the distance plot.</p>
</td></tr>
<tr><td><code id="distplot_+3A_pcaref">pcaref</code></td>
<td>
<p>list with the information of the PCA model.</p>
</td></tr>
<tr><td><code id="distplot_+3A_obstag">obstag</code></td>
<td>
<p>Optional column vector of integers indicating the group of each
observation (<code>0</code> or <code>1</code>). Default value set to <code>matrix(0, nrow(X), 1)</code>.</p>
</td></tr>
<tr><td><code id="distplot_+3A_plottitle">plottitle</code></td>
<td>
<p>Optional string with the plot title. Set to <code>"Distance plot"</code>
by default.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Coordinates are expressed in terms of the Hotelling's T^2 (x-axis) and the Squared
Prediction Error (y-axis) obtained projecting X on the provided model.
Observations can be identified by the obstag input argument.
</p>


<h3>Value</h3>

<p>ggplot object with the distance plot.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X &lt;- as.matrix(X)
pcamodel.ref &lt;- pcamb_classic(X, 2, 0.05, "cent")
distplot(X, pcamodel.ref)
tags &lt;- dotag(X[1:40,], X[-c(1:40),])
distplot(X, pcamodel.ref, obstag = tags, plottitle = "D plot title")
</code></pre>

<hr>
<h2 id='distplotsimple'>displotsimple</h2><span id='topic+distplotsimple'></span>

<h3>Description</h3>

<p>Returns the distance plot directly providing the coordinates and Upper Control Limits.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>distplotsimple(
  T2,
  SPE,
  lim.t2,
  lim.spe,
  ncomp,
  obstag = matrix(0, length(T2), 1),
  alpha = 0.05,
  plottitle = "Distance plot\n"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="distplotsimple_+3A_t2">T2</code></td>
<td>
<p>Vector with the Hotelling's T^2 values for each observation.</p>
</td></tr>
<tr><td><code id="distplotsimple_+3A_spe">SPE</code></td>
<td>
<p>Vector with the SPE values for each observation.</p>
</td></tr>
<tr><td><code id="distplotsimple_+3A_lim.t2">lim.t2</code></td>
<td>
<p>Value of the Upper Control Limit for the T^2 statistic.</p>
</td></tr>
<tr><td><code id="distplotsimple_+3A_lim.spe">lim.spe</code></td>
<td>
<p>Value of the Upper Control Limit for the SPE.</p>
</td></tr>
<tr><td><code id="distplotsimple_+3A_ncomp">ncomp</code></td>
<td>
<p>An integer indicating the number of PCs.</p>
</td></tr>
<tr><td><code id="distplotsimple_+3A_obstag">obstag</code></td>
<td>
<p>Optional column vector of integers indicating the group of each
observation (<code>0</code> or <code>1</code>). Default value set to <code>matrix(0, nrow(X), 1)</code>.</p>
</td></tr>
<tr><td><code id="distplotsimple_+3A_alpha">alpha</code></td>
<td>
<p>Optional number between 0 and 1 expressing the type I risk assumed in the
computation of the Upper Control Limits (UCL) set to <code>0.05</code> (5 %) by default.</p>
</td></tr>
<tr><td><code id="distplotsimple_+3A_plottitle">plottitle</code></td>
<td>
<p>Optional string with the plot title, <code>"Distance plot"</code> by
default.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Coordinates are expressed in terms of the Hotelling's T^2 (T^2, x-axis) and the Squared
Prediction Error (SPE, y-axis). Observations can be identified by the obstag input argument.
</p>


<h3>Value</h3>

<p>distplotobj ggplot object with the generated distance plot.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X &lt;- as.matrix(X)
pcamodel.ref &lt;- pcamb_classic(X[1:40,], 2, 0.05, "cent") # PCA-MB with first 40 
# observations
pcaproj &lt;- pcame(X[-c(1:40),], pcamodel.ref) # Project last observations
distplotsimple(pcaproj$T2, pcaproj$SPE, pcamodel.ref$limt2, pcamodel.ref$limspe,
pcamodel.ref$ncomp)

pcaproj &lt;- pcame(X, pcamodel.ref) # Project all observations
tags &lt;- dotag(X[1:40,], X[-c(1:40),]) # 0's for observations used in PCA-MB
distplotsimple(pcaproj$T2, pcaproj$SPE, pcamodel.ref$limt2, pcamodel.ref$limspe, 
pcamodel.ref$ncomp, obstag = tags)
</code></pre>

<hr>
<h2 id='dotag'>dotag</h2><span id='topic+dotag'></span>

<h3>Description</h3>

<p>Returns the tag vector to identify two different data sets
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dotag(X.zeros = NA, X.ones = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dotag_+3A_x.zeros">X.zeros</code></td>
<td>
<p>Matrix with the tag <code>0</code>.</p>
</td></tr>
<tr><td><code id="dotag_+3A_x.ones">X.ones</code></td>
<td>
<p>Matrix with the tag <code>1</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>tag.all</code> vector with 0 tags for observations in <code>X.zeros</code> and
1 tags for observations in <code>X.ones</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X &lt;- as.matrix(X)
dotag(X[1:40,], X[-c(1:40),])
</code></pre>

<hr>
<h2 id='dscplot'>dscplot</h2><span id='topic+dscplot'></span>

<h3>Description</h3>

<p>Returns the distance plot and the score plot providing a data matrix and a Principal Component
Analysis (PCA) model. Observations can be identified by the obstag input argument.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dscplot(
  X,
  pcamodel,
  obstag = matrix(0, nrow(X), 1),
  pcx = 1,
  pcy = 2,
  alpha = 0.05,
  nrow = 1,
  ncol = 2,
  legpos = "bottom"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dscplot_+3A_x">X</code></td>
<td>
<p>Matrix with the data to be displayed.</p>
</td></tr>
<tr><td><code id="dscplot_+3A_pcamodel">pcamodel</code></td>
<td>
<p>List with the PCA model elements.</p>
</td></tr>
<tr><td><code id="dscplot_+3A_obstag">obstag</code></td>
<td>
<p>Optional column vector of integers indicating the group of each
observation (<code>0</code> or <code>1</code>). Default value set to <code>matrix(0, nrow(X), 1)</code>.</p>
</td></tr>
<tr><td><code id="dscplot_+3A_pcx">pcx</code></td>
<td>
<p>Optional integer with the number of the PC in the horizontal axis.
Set to <code>1</code> by default.</p>
</td></tr>
<tr><td><code id="dscplot_+3A_pcy">pcy</code></td>
<td>
<p>Optional integer with the number of the PC in the vertical axis.
Set to <code>2</code> by default.</p>
</td></tr>
<tr><td><code id="dscplot_+3A_alpha">alpha</code></td>
<td>
<p>Optional number between 0 and 1 expressing the type I risk assumed in
the computation of the confidence ellipse,
set to <code>0.05</code> (5 %) by default.</p>
</td></tr>
<tr><td><code id="dscplot_+3A_nrow">nrow</code></td>
<td>
<p>Optional number of rows the plot layout. Set to <code>1</code> by default.</p>
</td></tr>
<tr><td><code id="dscplot_+3A_ncol">ncol</code></td>
<td>
<p>Optional number of columns the plot layout. Set to <code>2</code> by default.</p>
</td></tr>
<tr><td><code id="dscplot_+3A_legpos">legpos</code></td>
<td>
<p>Optional string with the position of the legend. Set to <code>"bottom"</code>
by default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot object with the generated score plot.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X &lt;- as.matrix(X)
pcamodel.ref &lt;- pcamb_classic(X[1:40,], 3, 0.05, "cent")
dscplot(X, pcamodel.ref)
dscplot(X, pcamodel.ref, nrow = 2, ncol = 1)
tags &lt;- dotag(X[1:40,], X[-c(1:40),])
dscplot(X, pcamodel.ref, obstag = tags, pcy = 3)
</code></pre>

<hr>
<h2 id='ht2info'>ht2info</h2><span id='topic+ht2info'></span>

<h3>Description</h3>

<p>Returns information about the Hotelling's T^2 statistic for an observation.
Two subplots show the information of an observation regarding its T^2 statistic,
i.e.: a bar plot indicating the value of the statistic for the observation, and a
bar plot with the contribution that each component had for the T^2 value.
The term T^2_A makes reference to the T^2 for a model with A principal components (PCs).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ht2info(HT2, T2matrix, limht2, iobs = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ht2info_+3A_ht2">HT2</code></td>
<td>
<p>A vector with values of the Hotelling's T^2_A statistic.</p>
</td></tr>
<tr><td><code id="ht2info_+3A_t2matrix">T2matrix</code></td>
<td>
<p>A matrix with the contributions of each PC (A columns) for each
observation (rows) to the Hotelling's T^2_A statistic.</p>
</td></tr>
<tr><td><code id="ht2info_+3A_limht2">limht2</code></td>
<td>
<p>Upper Control Limit for the Hotelling's T^2_A statistic, at a certain
confidence
level (1-alpha)*100 %.</p>
</td></tr>
<tr><td><code id="ht2info_+3A_iobs">iobs</code></td>
<td>
<p>Integer with the index of the observation of interest. Default value
set to <code>NA</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot object with the generated bar plots.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X &lt;- as.matrix(X)
pcamodel.ref &lt;- pcamb_classic(X[1:40,], 2, 0.05, "cent") # PCA-MB with first 40 
# observations
pcaproj &lt;- pcame(X[-c(1:40),], pcamodel.ref) # Project last observations
ht2info(pcaproj$T2, pcaproj$T2matrix, pcamodel.ref$limt2, 2) # Information about 
# the T^2 of the row #2
</code></pre>

<hr>
<h2 id='obscontribpanel'>obscontribpanel</h2><span id='topic+obscontribpanel'></span>

<h3>Description</h3>

<p>Information about the Hotelling's T^2 and the Squared Predidiction Error (SPE)
of an observation. The term T^2_A makes reference to the T^2 for a model with
A principal components (PCs).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>obscontribpanel(pcax, pcaref, obsid = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="obscontribpanel_+3A_pcax">pcax</code></td>
<td>
<p>A list with the elements of the PCA model that will be displayed:
SPE, T^2_A and their constributions (E and T2matrix).</p>
</td></tr>
<tr><td><code id="obscontribpanel_+3A_pcaref">pcaref</code></td>
<td>
<p>A list with the PCA model according to which the distance and
contributions are expressed.</p>
</td></tr>
<tr><td><code id="obscontribpanel_+3A_obsid">obsid</code></td>
<td>
<p>Integer with the index of the observation of interest. Default
set to <code>NA</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot object with the generated bar plots in a 1 x 4 subplots layout.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X &lt;- as.matrix(X)
pcamodel.ref &lt;- pcamb_classic(X[1:40,], 2, 0.05, "cent") # PCA-MB with first 
# 40 observations
pcaproj &lt;- pcame(X[-c(1:40),], pcamodel.ref) # Project last observations
obscontribpanel(pcaproj, pcamodel.ref, 2) # Information about the SPE and T^2 
# of the row #2
</code></pre>

<hr>
<h2 id='pcamb_classic'>pcamb_classic</h2><span id='topic+pcamb_classic'></span>

<h3>Description</h3>

<p>Principal Component Analysis (PCA) model fitting according to a matrix X using singular
value decomposition (svd)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pcamb_classic(X, ncomp, alpha, prepro)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pcamb_classic_+3A_x">X</code></td>
<td>
<p>Matrix with observations that will used to fit the PCA model.</p>
</td></tr>
<tr><td><code id="pcamb_classic_+3A_ncomp">ncomp</code></td>
<td>
<p>An integer indicating the number of PCs that the model will have.</p>
</td></tr>
<tr><td><code id="pcamb_classic_+3A_alpha">alpha</code></td>
<td>
<p>A number between 0 and 1 indicating the type I risk assumed to calculate
the Upper Control Limits (UCLs) for the Squared Prediction Error (SPE), the Hotelling's
T^2_A and the scores. The confidence level of these limits will be <code>(1-alpha)*100</code>.</p>
</td></tr>
<tr><td><code id="pcamb_classic_+3A_prepro">prepro</code></td>
<td>
<p>A string indicating the preprocessing to be performed on X. Its possible
values are: <code>"none"</code>, for any preprocessing, <code>"cent"</code>, for a mean-centering,
or <code>"autosc"</code>, for a mean-centering and unitary variance scaling (autoscaling).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list with elements containing information about PCA model:
</p>

<ul>
<li> <p><code>m</code>: mean vector.
</p>
</li>
<li> <p><code>s</code>: standard deviation vector.
</p>
</li>
<li> <p><code>P</code>: loading matrix with the loadings of each PC stored as columns.
</p>
</li>
<li> <p><code>Pfull</code>: full loading matrix obtained by the svd,
</p>
</li>
<li> <p><code>lambda</code>: vector with the variance of each PC.
</p>
</li>
<li> <p><code>limspe</code>: Upper Control Limit for the SPE with a confidence level
(1-alpha)*100 %.
</p>
</li>
<li> <p><code>limt2</code>: Upper Control Limit for the T^2_A with a confidence level
(1-alpha)*100 %.
</p>
</li>
<li> <p><code>limits_t</code>: Upper control Limits for the scores with a confidence level
(1-alpha)*100 %.
</p>
</li>
<li> <p><code>prepro</code>: string indicating the type of preprocessing performed on X.
</p>
</li>
<li> <p><code>ncomp</code>: number of PCs of the PCA model, A.
</p>
</li>
<li> <p><code>alpha</code>: value of the type I risk assumed to calculate the Upper Control
Limits of the SPE, T^2_A and scores.
</p>
</li>
<li> <p><code>n</code>: dimension of the number of rows in X.
</p>
</li>
<li> <p><code>S</code>: covariance matrix of X.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>X &lt;- as.matrix(X)
pcamodel.ref &lt;- pcamb_classic(X, 3, 0.1, "autosc") # PCA-MB with all observations
pcamodel.ref &lt;- pcamb_classic(X[1:40,], 2, 0.05, "cent") # PCA-MB with first 40 
# observations
</code></pre>

<hr>
<h2 id='pcame'>pcame</h2><span id='topic+pcame'></span>

<h3>Description</h3>

<p>Projection of X onto a Principal Component Analysis (PCA) model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pcame(X, pcaref)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pcame_+3A_x">X</code></td>
<td>
<p>Matrix with observations that will be projected onto the PCA model.</p>
</td></tr>
<tr><td><code id="pcame_+3A_pcaref">pcaref</code></td>
<td>
<p>A list with the elemements of a PCA model:
</p>

<ul>
<li> <p><code>m</code>: mean.
</p>
</li>
<li> <p><code>s</code>: standard deviation.
</p>
</li>
<li> <p><code>prepro</code>: preprocessing: <code>"none"</code>, <code>"cent"</code> or <code>"autosc"</code>.
</p>
</li>
<li> <p><code>P</code>: loading matrix.
</p>
</li>
<li> <p><code>lambda</code>: vector with variances of each PC.
</p>
</li></ul>
</td></tr>
</table>


<h3>Details</h3>

<p><code>pcame</code> performs the projection of the data in X onto the PCA model stored as a
list of parameters. It returns the projection of the observations in X, along with the
Squared Prediction Errors (SPE), Hotelling's T^2_A, contribution elements and the
reconstruction of X obtained by the PCA model.
</p>


<h3>Value</h3>

<p>list with elements containing information about X in the PCA model:
</p>

<ul>
<li> <p><code>Xpreprocessed</code>: matrix <code>X</code> preprocessed.
</p>
</li>
<li> <p><code>Tscores</code>: score matrix with the projection of <code>X</code> on each one of the A PCs.
</p>
</li>
<li> <p><code>E</code>: error matrix with the par of <code>X</code> not explained by the PCA model.
</p>
</li>
<li> <p><code>SPE</code>: vector with the SPE for each observation of <code>X</code>.
</p>
</li>
<li> <p><code>T2</code>: vector with the T^_A for each observation of <code>X</code>.
</p>
</li>
<li> <p><code>T2matrix</code>: matrix with the contributions of each PC to the T^2_A for each observation
of <code>X</code>.
</p>
</li>
<li> <p><code>Xrec</code>: matrix with the reconstructed part of <code>X</code>, i.e. the part of <code>X</code>
explained by the PCA model.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>X &lt;- as.matrix(X)
pcamodel.ref &lt;- pcamb_classic(X, 3, 0.1, "autosc") # PCA-MB with all observations
pcame(X, pcamodel.ref) # Project all observations onto PCA model of pcamodel.ref

pcamodel.ref &lt;- pcamb_classic(X[1:40,], 2, 0.05, "cent") # PCA-MB with first 40 observations
pcame(X[-c(1:40),], pcamodel.ref) # Project observations not used in PCA-MB onto PCA model 
# of pcamodel.ref
</code></pre>

<hr>
<h2 id='scoreplot'>scoreplot</h2><span id='topic+scoreplot'></span>

<h3>Description</h3>

<p>Returns the score plot providing a dataset and a pca model. Observations can
be identified by the obstag input argument.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scoreplot(
  X,
  pcamodel,
  obstag = matrix(0, nrow(X), 1),
  pcx = 1,
  pcy = 2,
  alpha = 0.05,
  plottitle = "Score plot\n"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scoreplot_+3A_x">X</code></td>
<td>
<p>Matrix with the data to be displayed.</p>
</td></tr>
<tr><td><code id="scoreplot_+3A_pcamodel">pcamodel</code></td>
<td>
<p>List wiht the PCA model elements.</p>
</td></tr>
<tr><td><code id="scoreplot_+3A_obstag">obstag</code></td>
<td>
<p>Optional column vector of integers indicating the group of each
observation (<code>0</code> or <code>1</code>). Default value set to <code>matrix(0, nrow(X), 1)</code>.</p>
</td></tr>
<tr><td><code id="scoreplot_+3A_pcx">pcx</code></td>
<td>
<p>Optional integer with the number of the PC in the horizontal axis. Set to <code>1</code> by default.</p>
</td></tr>
<tr><td><code id="scoreplot_+3A_pcy">pcy</code></td>
<td>
<p>Optional integer with the number of the PC in the vertical axis. Set to <code>2</code> by default.</p>
</td></tr>
<tr><td><code id="scoreplot_+3A_alpha">alpha</code></td>
<td>
<p>Optional number between 0 and 1 expressing the type I risk assumed in the compuatation of the confidence ellipse,
set to <code>0.05</code> (5 %) by default.</p>
</td></tr>
<tr><td><code id="scoreplot_+3A_plottitle">plottitle</code></td>
<td>
<p>Optional string with the plot title. Set to <code>"Score plot"</code> by default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot object with the generated score plot.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X &lt;- as.matrix(X)
pcamodel.ref &lt;- pcamb_classic(X[1:40,], 3, 0.05, "cent")
scoreplot(X, pcamodel.ref)
tags &lt;- dotag(X[1:40,], X[-c(1:40),])
scoreplot(X, pcamodel.ref, obstag = tags, pcx = 2, pcy = 3, alpha = 0.1, plottitle = "T-plot")
</code></pre>

<hr>
<h2 id='scoreplotsimple'>scoreplotsimple</h2><span id='topic+scoreplotsimple'></span>

<h3>Description</h3>

<p>Returns the score plot providing the scores matrix, <strong>T</strong>. Observations can
be identified by the obstag input argument.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scoreplotsimple(
  Tscores,
  pcx = 1,
  pcy = 2,
  obstag = matrix(0, nrow(Tscores), 1),
  alpha = 0.05,
  varT = stats::var(Tscores),
  plottitle = "Score plot\n"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scoreplotsimple_+3A_tscores">Tscores</code></td>
<td>
<p>Matrix with the scores to be displayed, with the information of each Principal
Component (PC) stored by columns.</p>
</td></tr>
<tr><td><code id="scoreplotsimple_+3A_pcx">pcx</code></td>
<td>
<p>Optional integer with the number of the PC in the horizontal axis. Set to <code>1</code>
by default.</p>
</td></tr>
<tr><td><code id="scoreplotsimple_+3A_pcy">pcy</code></td>
<td>
<p>Optional integer with the number of the PC in the vertical axis. Set to <code>2</code>
by default.</p>
</td></tr>
<tr><td><code id="scoreplotsimple_+3A_obstag">obstag</code></td>
<td>
<p>Optional column vector of integers indicating the group of each
observation (<code>0</code> or <code>1</code>). Default value set to <code>matrix(0, nrow(X), 1)</code>.</p>
</td></tr>
<tr><td><code id="scoreplotsimple_+3A_alpha">alpha</code></td>
<td>
<p>Optional number between 0 and 1 expressing the type I risk assumed in the
computation of the confidence ellipse, set to <code>0.05</code> (5 %) by default.</p>
</td></tr>
<tr><td><code id="scoreplotsimple_+3A_vart">varT</code></td>
<td>
<p>Optional parameter expressing the variance of each PC. Set to <code>var(Tscores)</code>
by default.</p>
</td></tr>
<tr><td><code id="scoreplotsimple_+3A_plottitle">plottitle</code></td>
<td>
<p>Optional string with the plot title. Set to <code>"Score plot"</code> by default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot object with the generated score plot.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X &lt;- as.matrix(X)
pcamodel.ref &lt;- pcamb_classic(X[1:40,], 3, 0.05, "cent")
pcaproj &lt;- pcame(X, pcamodel.ref) # Project last observations
scoreplotsimple(pcaproj$Tscores)

pcaproj &lt;- pcame(X[-c(1:40),], pcamodel.ref) # Project all observations
tags &lt;- dotag(X[1:40,], X[-c(1:40),]) # 0's for observations used in PCA-MB
scoreplotsimple(pcaproj$Tscores, pcx = 2, pcy = 3, obstag = tags)
</code></pre>

<hr>
<h2 id='scout'>scout</h2><span id='topic+scout'></span>

<h3>Description</h3>

<p>Shift of an observation following a selected pattern.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scout(
  X,
  pcaref,
  T2.y = NA,
  SPE.y = NA,
  nsteps = 1,
  nsteps.spe = 1,
  nsteps.t2 = 1,
  gspe = 1,
  gt2 = 1,
  mode = "simple"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scout_+3A_x">X</code></td>
<td>
<p>Matrix with observations that will be shifted as rows.</p>
</td></tr>
<tr><td><code id="scout_+3A_pcaref">pcaref</code></td>
<td>
<p>List with the elements of a PCA model:
</p>

<ul>
<li> <p><code>m</code>: mean.
</p>
</li>
<li> <p><code>s</code>: standard deviation.
</p>
</li>
<li> <p><code>prepro</code>: preprocessing: <code>"none"</code>, <code>"cent"</code> or <code>"autosc"</code>.
</p>
</li>
<li> <p><code>P</code>: loading matrix.
</p>
</li>
<li> <p><code>lambda</code>: vector with variances of each PC.
</p>
</li></ul>
</td></tr>
<tr><td><code id="scout_+3A_t2.y">T2.y</code></td>
<td>
<p>A number indicating the target value for the Hotelling's T^2_A after the shift.
Set to <code>NA</code> by default.</p>
</td></tr>
<tr><td><code id="scout_+3A_spe.y">SPE.y</code></td>
<td>
<p>A number indicating the target value for the Squared Prediction Error after the
shift. Set to <code>NA</code> by default.</p>
</td></tr>
<tr><td><code id="scout_+3A_nsteps">nsteps</code></td>
<td>
<p>A number indicating the number of steps between the reference and target
values of the SPE and the T^2. Set to <code>1</code> by default.</p>
</td></tr>
<tr><td><code id="scout_+3A_nsteps.spe">nsteps.spe</code></td>
<td>
<p>An integer indicating the number of steps in which the shift from
the reference to the target value of the SPE will be performed. Set to <code>1</code> by default.</p>
</td></tr>
<tr><td><code id="scout_+3A_nsteps.t2">nsteps.t2</code></td>
<td>
<p>An integer indicating the number of steps in which the shift from the
reference to the target value of the T^2_A will be performed. Set to <code>1</code> by default.</p>
</td></tr>
<tr><td><code id="scout_+3A_gspe">gspe</code></td>
<td>
<p>A number indicating the term that will tune the spacing between steps for the SPE.
Set to <code>1</code> by default (linear spacing).</p>
</td></tr>
<tr><td><code id="scout_+3A_gt2">gt2</code></td>
<td>
<p>A number indicating the term that will tune the spacing between steps for the SPE.
Set to <code>1</code> by default (linear spacing).</p>
</td></tr>
<tr><td><code id="scout_+3A_mode">mode</code></td>
<td>
<p>A character indicating the type of shift that will be performed: <code>"simple"</code>,
<code>"steps"</code> or <code>"grid"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list with elements:
</p>

<ul>
<li> <p><code>X</code>: matrix with the new and shifted data.
</p>
</li>
<li> <p><code>SPE</code>: SPE of each one of the generated outliers in the list element <code>X</code>.
</p>
</li>
<li> <p><code>T2</code>: T^2 of each one of the generated outliers in the list element <code>X</code>.
</p>
</li>
<li> <p><code>step.spe</code>: step of each observation according to the shift of the SPE.
</p>
</li>
<li> <p><code>step.t2</code>: step of each observation according to the shift of the T^2.
</p>
</li>
<li> <p><code>tag</code>: is a vector of ones as long as the number of generated observations.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>X &lt;- as.matrix(X)
pcamodel.ref &lt;- pcamb_classic(X, 3, 0.1, "autosc") # PCA-MB with all observations
# Shift the first observation:
outscout &lt;- scout(X[1,], pcamodel.ref, T2.y = 40, SPE.y = 50, nsteps.spe = 3, nsteps.t2 = 2, 
gspe = 3, gt2 = 0.5, mode = "grid")

# Shift a set of observations increasing only the T^2 in one step:
outscout &lt;- scout(X, pcamodel.ref, T2.y = matrix(40, nrow(X), 1), mode = "simple")
</code></pre>

<hr>
<h2 id='scoutgrid'>scoutgrid</h2><span id='topic+scoutgrid'></span>

<h3>Description</h3>

<p>Shift of an array following a grid pattern.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scoutgrid(
  X,
  pcaref,
  T2.target = NA,
  SPE.target = NA,
  nsteps.t2 = 1,
  nsteps.spe = 1,
  gspe = 1,
  gt2 = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scoutgrid_+3A_x">X</code></td>
<td>
<p>Matrix with observations that will be shifted as rows.</p>
</td></tr>
<tr><td><code id="scoutgrid_+3A_pcaref">pcaref</code></td>
<td>
<p>List with the elements of a PCA model:
</p>

<ul>
<li> <p><code>m</code>: mean.
</p>
</li>
<li> <p><code>s</code>: standard deviation.
</p>
</li>
<li> <p><code>prepro</code>: preprocessing: <code>"none"</code>, <code>"cent"</code> or <code>"autosc"</code>.
</p>
</li>
<li> <p><code>P</code>: loading matrix.
</p>
</li>
<li> <p><code>lambda</code>: vector with variances of each PC.
</p>
</li></ul>
</td></tr>
<tr><td><code id="scoutgrid_+3A_t2.target">T2.target</code></td>
<td>
<p>A number indicating the target value for the T^2_A after the shift.
Set to <code>NA</code> by default.</p>
</td></tr>
<tr><td><code id="scoutgrid_+3A_spe.target">SPE.target</code></td>
<td>
<p>A number indicating the target value for the SPE after the shift.
Set to <code>NA</code> by default.</p>
</td></tr>
<tr><td><code id="scoutgrid_+3A_nsteps.t2">nsteps.t2</code></td>
<td>
<p>An integer indicating the number of steps in which the shift from the
reference to the target value of the T^2_A will be performed. Set to <code>1</code> by default.</p>
</td></tr>
<tr><td><code id="scoutgrid_+3A_nsteps.spe">nsteps.spe</code></td>
<td>
<p>An integer indicating the number of steps in which the shift from
the reference to the target value of the SPE will be performed. Set to <code>1</code> by default.</p>
</td></tr>
<tr><td><code id="scoutgrid_+3A_gspe">gspe</code></td>
<td>
<p>A number indicating the term that will tune the spacing between steps for the SPE.
Set to <code>1</code> by default (linear spacing).</p>
</td></tr>
<tr><td><code id="scoutgrid_+3A_gt2">gt2</code></td>
<td>
<p>A number indicating the term that will tune the spacing between steps for the SPE.
Set to <code>1</code> by default (linear spacing).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list with elements:
</p>

<ul>
<li> <p><code>X</code>: matrix with the new and shifted data.
</p>
</li>
<li> <p><code>SPE</code>: SPE of each one of the generated outliers in the list element <code>X</code>.
</p>
</li>
<li> <p><code>T2</code>: T^2 of each one of the generated outliers in the list element <code>X</code>.
</p>
</li>
<li> <p><code>step.spe</code>: step of each observation according to the shift of the SPE.
</p>
</li>
<li> <p><code>step.t2</code>: step of each observation according to the shift of the T^2.
</p>
</li>
<li> <p><code>tag</code>: is a vector of ones as long as the number of generated observations.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>X &lt;- as.matrix(X)
pcamodel.ref &lt;- pcamb_classic(X, 3, 0.1, "autosc") # PCA-MB with all observations
# Shift a set of observations increasing the T^2  and the SPE in 3 and 2 linear and 
# non-linear steps respectively:
outgrid &lt;- scoutgrid(X, pcamodel.ref, T2.target = matrix(40, nrow(X), 1), 
SPE.target = matrix(50, nrow(X), 1), nsteps.t2 = 3, nsteps.spe = 2, gspe = 4)
</code></pre>

<hr>
<h2 id='scoutsimple'>scoutsimple</h2><span id='topic+scoutsimple'></span>

<h3>Description</h3>

<p>Shift of an array with a single step.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scoutsimple(X, pcaref, T2.target = NA, SPE.target = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scoutsimple_+3A_x">X</code></td>
<td>
<p>Matrix with observations that will be shifted as rows.</p>
</td></tr>
<tr><td><code id="scoutsimple_+3A_pcaref">pcaref</code></td>
<td>
<p>List with the elements of a PCA model:
</p>

<ul>
<li> <p><code>m</code>: mean.
</p>
</li>
<li> <p><code>s</code>: standard deviation.
</p>
</li>
<li> <p><code>prepro</code>: preprocessing: <code>"none"</code>, <code>"cent"</code> or <code>"autosc"</code>.
</p>
</li>
<li> <p><code>P</code>: loading matrix.
</p>
</li>
<li> <p><code>lambda</code>: vector with variances of each PC.
</p>
</li></ul>
</td></tr>
<tr><td><code id="scoutsimple_+3A_t2.target">T2.target</code></td>
<td>
<p>A number indicating the target value for the T^2_A after the shift.
Set to <code>NA</code> by default.</p>
</td></tr>
<tr><td><code id="scoutsimple_+3A_spe.target">SPE.target</code></td>
<td>
<p>A number indicating the target value for the SPE after the shift.
Set to <code>NA</code> by default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list with elements:
</p>

<ul>
<li> <p><code>X</code>: matrix with the new and shifted data.
</p>
</li>
<li> <p><code>SPE</code>: SPE of each one of the generated outliers in the list element <code>X</code>.
</p>
</li>
<li> <p><code>T2</code>: T^2 of each one of the generated outliers in the list element <code>X</code>.
</p>
</li>
<li> <p><code>step.spe</code>: step of each observation according to the shift of the SPE.
</p>
</li>
<li> <p><code>step.t2</code>: step of each observation according to the shift of the T^2.
</p>
</li>
<li> <p><code>tag</code>: is a vector of ones as long as the number of generated observations.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>X &lt;- as.matrix(X)
pcamodel.ref &lt;- pcamb_classic(X, 3, 0.1, "autosc") # PCA-MB with all observations
# Shift a set of observations increasing only the T^2 in one step:
outsimple &lt;- scoutsimple(X, pcamodel.ref, T2.target = matrix(40, nrow(X), 1))
</code></pre>

<hr>
<h2 id='scoutsteps'>scoutsteps</h2><span id='topic+scoutsteps'></span>

<h3>Description</h3>

<p>Shift of an array following a step-wise pattern.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scoutsteps(
  X,
  pcaref,
  T2.target = NA,
  SPE.target = NA,
  nsteps = 1,
  gspe = 1,
  gt2 = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scoutsteps_+3A_x">X</code></td>
<td>
<p>Matrix with observations that will be shifted as rows.</p>
</td></tr>
<tr><td><code id="scoutsteps_+3A_pcaref">pcaref</code></td>
<td>
<p>List with the elements of a PCA model:
</p>

<ul>
<li> <p><code>m</code>: mean.
</p>
</li>
<li> <p><code>s</code>: standard deviation.
</p>
</li>
<li> <p><code>prepro</code>: preprocessing: <code>"none"</code>, <code>"cent"</code> or <code>"autosc"</code>.
</p>
</li>
<li> <p><code>P</code>: loading matrix.
</p>
</li>
<li> <p><code>lambda</code>: vector with variances of each PC.
</p>
</li></ul>
</td></tr>
<tr><td><code id="scoutsteps_+3A_t2.target">T2.target</code></td>
<td>
<p>A number indicating the target value for the Hotelling's T^2_A after the shift.
Set to <code>NA</code> by default.</p>
</td></tr>
<tr><td><code id="scoutsteps_+3A_spe.target">SPE.target</code></td>
<td>
<p>A number indicating the target value for the Squared Prediction Error after
the shift. Set to <code>NA</code> by default.</p>
</td></tr>
<tr><td><code id="scoutsteps_+3A_nsteps">nsteps</code></td>
<td>
<p>A number indicating the number of steps between the reference and target
values of the SPE and the T^2. Set to <code>1</code> by default.</p>
</td></tr>
<tr><td><code id="scoutsteps_+3A_gspe">gspe</code></td>
<td>
<p>A number indicating the term that will tune the spacing between steps for the SPE.
Set to <code>1</code> by default (linear spacing).</p>
</td></tr>
<tr><td><code id="scoutsteps_+3A_gt2">gt2</code></td>
<td>
<p>A number indicating the term that will tune the spacing between steps for the SPE.
Set to <code>1</code> by default (linear spacing).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list with elements:
</p>

<ul>
<li> <p><code>X</code>: matrix with the new and shifted data.
</p>
</li>
<li> <p><code>SPE</code>: SPE of each one of the generated outliers in the list element <code>X</code>.
</p>
</li>
<li> <p><code>T2</code>: T^2 of each one of the generated outliers in the list element <code>X</code>.
</p>
</li>
<li> <p><code>step.spe</code>: step of each observation according to the shift of the SPE.
</p>
</li>
<li> <p><code>step.t2</code>: step of each observation according to the shift of the T^2.
</p>
</li>
<li> <p><code>tag</code>: is a vector of ones as long as the number of generated observations.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>X &lt;- as.matrix(X)
pcamodel.ref &lt;- pcamb_classic(X, 3, 0.1, "autosc") # PCA-MB with all observations
# Shift a set of observations increasing the T^2  and the SPE in 4 linear steps:
outsteps &lt;- scoutsteps(X, pcamodel.ref, T2.target = matrix(40, nrow(X), 1), 
SPE.target = matrix(50, nrow(X), 1), nsteps = 4)
# Shift a set of observations increasing the SPE in 4 non-linear steps:
outsteps &lt;- scoutsteps(X, pcamodel.ref, SPE.target = matrix(50, nrow(X), 1), nsteps = 4, 
gspe = 0.3)
</code></pre>

<hr>
<h2 id='speinfo'>speinfo</h2><span id='topic+speinfo'></span>

<h3>Description</h3>

<p>Information about the Squared Prediction Error (SPE) of an observation. Two subplots show the
information of an observation regarding its SPE statistic, i.e.: a bar plot indicating the
value of the statistic for the observation, and a bar plot with the contribution that each
variable had for the SPE value
</p>


<h3>Usage</h3>

<pre><code class='language-R'>speinfo(SPE, E, limspe, iobs = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="speinfo_+3A_spe">SPE</code></td>
<td>
<p>Vector with values of the SPE statistic.</p>
</td></tr>
<tr><td><code id="speinfo_+3A_e">E</code></td>
<td>
<p>Matrix with the contributions of each variable (columns) for each observation (rows)
to the SPE. It is the error term obtained from the unexplained part of X by the PCA model.</p>
</td></tr>
<tr><td><code id="speinfo_+3A_limspe">limspe</code></td>
<td>
<p>Upper Control Limit (UCL) for the SPE, at a certain confidence level
(1-alpha)*100 %.</p>
</td></tr>
<tr><td><code id="speinfo_+3A_iobs">iobs</code></td>
<td>
<p>Integer with the index of the observation of interest. Default value set to
<code>NA</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot object with the generated bar plots.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X &lt;- as.matrix(X)
pcamodel.ref &lt;- pcamb_classic(X[1:40,], 2, 0.05, "cent") # PCA-MB with first 40 observations
pcaproj &lt;- pcame(X[-c(1:40),], pcamodel.ref) # Project last observations
speinfo(pcaproj$SPE, pcaproj$E, pcamodel.ref$limspe, 2) # Information about the SPE of the 
# row #2
</code></pre>

<hr>
<h2 id='X'>Demo dataset</h2><span id='topic+X'></span>

<h3>Description</h3>

<p>It is a small data set to use as a demo for the SCOUTer package. It consists of
normally distributed variables, with two Principal Components explaining an
80% of the total variance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>X
</code></pre>


<h3>Format</h3>

<p>A matrix data frame with 50 rows and 5 normally distributed variables.
</p>

<hr>
<h2 id='xshift'>xshift</h2><span id='topic+xshift'></span>

<h3>Description</h3>

<p>Shift of an observation. The performed operation results as a combination of two main
directions: the direction of maximum gradient for the SPE (weighted by the parameter b)
and the direction of the projection of the observation on the model (weighted by the
parameter a).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xshift(X, P, a, b)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xshift_+3A_x">X</code></td>
<td>
<p>Matrix with observations that will be shifted.</p>
</td></tr>
<tr><td><code id="xshift_+3A_p">P</code></td>
<td>
<p>Loading matrix of the PCA model according to which the shift will be performed.</p>
</td></tr>
<tr><td><code id="xshift_+3A_a">a</code></td>
<td>
<p>A number or vector tuning the shift in the direction of its projection.</p>
</td></tr>
<tr><td><code id="xshift_+3A_b">b</code></td>
<td>
<p>A number or vector tuning the shift in the direction of its residual.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Matrix with shifted observation as rows, keeping the order of the input matrix
<code>X</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X &lt;- as.matrix(X)
pcamodel.ref &lt;- pcamb_classic(X, 3, 0.1, "autosc") # PCA-MB with all observations
# Shift observation #10 increasing by a factor of 2 and 4 its T^2 and its SPE respectively
x.new &lt;- xshift(X[10,], pcamodel.ref$P, sqrt(2) - 1, sqrt(4) - 1) 
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
