<!DOCTYPE html><html><head><title>Help for package nortestARMA</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {nortestARMA}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#nortestARMA'>
<p>Neyman Smooth Tests of Normality for the Errors of ARMA Models</p></a></li>
<li><a href='#Piggott'>
<p>Daily gas demand study by Piggott</p></a></li>
<li><a href='#potato'>
<p>Prince Edward Island; Average Yield, Potatoes (Hundredweight per harvested acres (1957-2014))</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Neyman Smooth Tests of Normality for the Errors of ARMA Models</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2017-04-14</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&gt; 2)</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Author:</td>
<td>Pierre Duchesne and Pierre Lafaye de Micheaux</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Pierre Lafaye de Micheaux &lt;lafaye@unsw.edu.au&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Tests the goodness-of-fit to the Normal distribution for the errors of an ARMA model.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10.0), astsa</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2017-04-14 02:42:39 UTC; lafaye</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2017-04-14 14:37:35 UTC</td>
</tr>
</table>
<hr>
<h2 id='nortestARMA'>
Neyman Smooth Tests of Normality for the Errors of ARMA Models
</h2><span id='topic+nortestARMA'></span>

<h3>Description</h3>

<p>Test statistics are computed to check normality in autoregressive moving-average (ARMA) time series models, adopting the smooth test paradigm. The mean of the ARMA process can be assumed known or unknown. A data-driven order of the family of the BIC type is given.</p>


<h3>Usage</h3>

<pre><code class='language-R'>nortestARMA(residuals, sig2hat, d = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nortestARMA_+3A_residuals">residuals</code></td>
<td>
<p>Vector of residuals of a fitted ARMA<code class="reqn">(p,q)</code> model.</p>
</td></tr>
<tr><td><code id="nortestARMA_+3A_sig2hat">sig2hat</code></td>
<td>
<p>Estimated variance of the i.i.d. errors of
the ARMA<code class="reqn">(p,q)</code> model.</p>
</td></tr>
<tr><td><code id="nortestARMA_+3A_d">d</code></td>
<td>
<p>Paramater used in the choice of the order of the Legendre polynomial.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In the 2004 paper, the mean <code class="reqn">\mu</code> of the ARMA process is supposed to be known
and thus should not be estimated. In that case, the residuals should be
computed without estimation of the mean <code class="reqn">\mu</code>. Moreover, these
residuals should not be centered before calling the <code>nortestARMA</code>
function because there might be some asymptotic impact of centering the
residuals (see Serfling (1980) page 73, case (iv)). In the 2016 paper, we considered that the mean <code class="reqn">\mu</code> is
unknown. Thus in that case, the residuals should be computed taking into
account the estimation of <code class="reqn">\mu</code>. Moreover, we have showed that there
is no asymptotic impact of the centering of the residuals (see Yu (2007)). Nevertheless,
in that case, centering the residuals could be a good idea for small
sample sizes.
</p>


<h3>Value</h3>

<p>List with the following components:
</p>
<table>
<tr><td><code>RKsdest</code></td>
<td>
<p>Values of the test statistics <code class="reqn">R_k</code>, for
<code class="reqn">k = 1, ..., 10</code> when only the standard deviation is estimated
(mean is supposed known).</p>
</td></tr>
<tr><td><code>Koptsdest</code></td>
<td>
<p>Optimal value <code class="reqn">\hat{K}</code> of <code class="reqn">K</code> using a BIC
type criterion involving the values of <code>RKsdest</code>, <code class="reqn">k=d, ..., D=10</code>.</p>
</td></tr>
<tr><td><code>pvalsdest</code></td>
<td>
<p><code class="reqn">p</code>-value of the test, associated to <code>RKsdest[Koptsdest]</code>.</p>
</td></tr>
<tr><td><code>RKsdmuest</code></td>
<td>
<p>Values of the test statistics <code class="reqn">R_k</code>, for <code class="reqn">k =
  1, ..., 10</code> for the new test (both the standard deviation and the mean are estimated).</p>
</td></tr>
<tr><td><code>Koptsdmuest</code></td>
<td>
<p>Optimal value <code class="reqn">\hat{K}</code> of <code class="reqn">K</code> using a BIC
type criterion involving the values of <code>RKsdmuest</code>, <code class="reqn">k=d, ..., D=10</code>.</p>
</td></tr>
<tr><td><code>pvalsdmuest</code></td>
<td>
<p><code class="reqn">p</code>-value for the new test, associated to <code>RKsdmuest[Koptsdmuest]</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Duchesne P., Lafaye de Micheaux P.
</p>


<h3>References</h3>

<p>Ducharme G., Lafaye de Micheaux P., (2004). Goodness-of-fit tests of normality for the
innovations in ARMA models. <em>Journal of Time Series Analysis</em> 25 (3), 373&ndash;395.
</p>
<p>Duchesne P., Lafaye de Micheaux P., Tagne J. (2016). Neyman Smooth Test of Normality for ARMA Time Series
Models with Unknown Mean. Submitted.
</p>
<p>Piggott J. L., (1980). The use o f Box-Jenkins modelling for the forecasting of daily gas demand.
Paper presented to the <em>Royal Statistical Society</em>.
</p>
<p>Shea B. L., (1987). Estimation of Multivariate Time
Series. <em>Journal of Time Series Analysis</em> 8 (1), 95&ndash;109.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#####################################
# Example in Ducharme et al. (2004) #
#####################################
data(Piggott)
ts.plot(Piggott$temp, main = "Temperature Series")
ts.plot(Piggott$wind.trans, main = "Transformed Wind Speed Series")

# The differenciated series Y_t - Y_{t - 1} of length 366 (taking Y_0 = 0)
diff.temp &lt;- c(Piggott$temp[1], diff(Piggott$temp))

pacf(diff.temp)
# Below, we assumed that the mean E(Y_t) is known and is equal to 0.
fit.MA4 &lt;- arima(diff.temp, order = c(0,0,4), include.mean = FALSE)

resfit.MA4 &lt;- residuals(fit.MA4)
sig2fit.MA4 &lt;- fit.MA4$sigma2
# The residuals should not be centered.
nortestARMA(resfit.MA4, sig2fit.MA4, d = 2)

# Note: In Ducharme et al. (2004), the data were analyzed using the
#  G13DCF routine in NAG.
# This routine gave us slightly different results.
# We obtained the following values:
#  ITERATION NUMBER =     9
#  ESTIMATED CONDITION NUMBER OF HESSIAN MATRIX =    0.181E+01
#  NUMBER OF LIKELIHOOD EVALUATIONS MADE SO FAR =       82
#  VALUE OF LOG LIKELIHOOD FUNCTION = -0.68515E+03
#  NORM OF GRADIENT VECTOR =  0.12052E-03
#  MA PARAMETERS :  0.0715894141 -0.296819534 -0.149662304 -0.19482046
#  VARIANCE :  2.47466874
# For reproducibility purpose, the non centered residuals returned 
#  by this routine have been included in the current package in the 
# 'resid.temp' object. To obtain exactly the same results as in the 
#  original 2004 article, one can thus issue the following commands:
sig2NAG &lt;- 2.47466874
nortestARMA(resid.temp, sig2NAG, d = 2)


#####################################
# Example in Duchesne et al. (2016) #
#####################################
data(potato)
plot(potato, type = "l")

# First difference
potatoe.yield.diff &lt;- diff(potato$potatoeyield)
mean(potatoe.yield.diff)

potatoe.yield.diff.centered &lt;- scale(potatoe.yield.diff, scale = FALSE)
n &lt;- length(potatoe.yield.diff.centered)
ts.plot(potatoe.yield.diff.centered)

acf2(potatoe.yield.diff.centered)

# ---------------------------------------
# ------------- Fitting an AR(1) --------
# ---------------------------------------

( fit.AR1 &lt;- arima(potatoe.yield.diff.centered, order = c(1, 0, 0) ,
method= 'ML', include.mean = TRUE) )
( fit.AR1.wo.mean &lt;- arima(potatoe.yield.diff.centered, order = c(1, 0, 0) ,
method= 'ML', include.mean = FALSE) )

resfit.AR1 &lt;- residuals(fit.AR1)
sig2fit.AR1 &lt;- fit.AR1$sigma2
resfit.AR1.centered &lt;- resfit.AR1 - mean(resfit.AR1)
nortestARMA(resfit.AR1.centered, sig2fit.AR1, d = 2)
# Using the (2014) approach where the residuals have been
# computed after estimating the mean (by first removing the average of the
# observations), and doing as if the mean had not
# been estimated and were known (include.mean = FALSE).
# Note that if Y_t = a + bt + X_t for example, differenciating
# will not make the true mean of the differenciated series to be 0.
resfit.AR1.wo.mean &lt;- residuals(fit.AR1.wo.mean)
sig2fit.AR1.wo.mean &lt;- fit.AR1.wo.mean$sigma2
nortestARMA(resfit.AR1.wo.mean, sig2fit.AR1.wo.mean, d = 2)

hist(resfit.AR1/sqrt(sig2fit.AR1))

Box.test(resfit.AR1.centered, lag = 3, type = "Ljung-Box", fitdf = 1)
Box.test(resfit.AR1.centered, lag = 6, type = "Ljung-Box", fitdf = 1)
Box.test(resfit.AR1.centered, lag = 12, type = "Ljung-Box", fitdf = 1)
Box.test(resfit.AR1.centered, lag = 14, type = "Ljung-Box", fitdf = 1)
Box.test(resfit.AR1.centered, lag = 20, type = "Ljung-Box", fitdf = 1)

acf2(resfit.AR1)

# ---------------------------------------------------------
# ------------- Fitting an AR(1) with intervention --------
# ---------------------------------------------------------

matX.AOdsARI11 &lt;- function(n, phi) {
 X &lt;- matrix(0, nrow = n + 2, ncol = n)
 oneminusphi &lt;- c(1, -1 - phi, phi)
 for (i in 1:n) X[i:(i + 2), i] &lt;- oneminusphi
 X &lt;- X[1:n, ]
return(X)
}

findAOdsARI11 &lt;- function(residuals, X, phi) {
 n &lt;- length(residuals)
 oneminusphi &lt;- c(1, -1 - phi, phi)
 tau2 &lt;- sum(oneminusphi ^ 2)
 sigma2 &lt;- mean(residuals ^ 2)
 res &lt;- matrix(0, nrow = n, ncol = 2)
 for (t in 1:n) {
  colXt &lt;- X[, t]
  fitt &lt;- lm(residuals ~ colXt - 1)
  omegaAt &lt;- coef(fitt)
  res[t, 1] &lt;- sqrt(tau2) * omegaAt / sqrt(sigma2)
  res[t, 2] &lt;- omegaAt
 }
return(res)
}

findAOandIOdsARI11 &lt;- function(residuals, X, phi) {
 n &lt;- length(residuals)
 oneminusphi &lt;- c(1, -1 - phi, phi)
 tau2 &lt;- sum(oneminusphi ^ 2)
 sigma2 &lt;- mean(residuals ^ 2)
 res &lt;- matrix(0, nrow = n, ncol = 3)
 for (t in 1:n) {
  colXt &lt;- X[, t]
  fitt &lt;- lm(residuals ~ colXt - 1)
  omegaAt &lt;- coef(fitt)
  res[t, 1] &lt;- sqrt(tau2) * omegaAt / sqrt(sigma2)
  res[t, 2] &lt;- omegaAt
  omegaIt &lt;- residuals[t] / sqrt(sigma2)
  res[t, 3] &lt;- omegaIt
 }
return(res)
}

phi &lt;- coef(fit.AR1)[1]
matX &lt;- matX.AOdsARI11(n, phi)
findAO &lt;- findAOdsARI11(resfit.AR1, matX, phi)
findAOandIO &lt;- findAOandIOdsARI11(resfit.AR1, matX, phi)

omega &lt;- rep(0, length(potato$potatoeyield))
findAOandIO[44, 2]
omega[44 + 1] &lt;- -93.8998780   # warning: the residuals in 'resfit.AR1' are in the diff series
potatoe.yieldAO &lt;- potato$potatoeyield - omega
 
plot(potato, type = "l", xlab = "year", ylab = "Hundredweight - Cwt")
lines(potato$year, potatoe.yieldAO, type = "l", lty = 2, col = "blue")
title('Original time series and with an intervention')

potatoe.yield.diffAO &lt;- diff(potatoe.yieldAO)
mean(potatoe.yield.diffAO)
potatoe.yield.diff.centeredao &lt;- potatoe.yield.diffAO - mean(potatoe.yield.diffAO)
n &lt;- length(potatoe.yield.diff.centeredao)

ts.plot(potatoe.yield.diff.centered)
ts.plot(potatoe.yield.diff.centeredao)

plot(1:length(potatoe.yield.diff.centered), potatoe.yield.diff, type = "l")
lines(1:length(potatoe.yield.diff.centeredao), potatoe.yield.diffAO,
 type = "l", lty = 2)


acf2(potatoe.yield.diff.centeredao)


( fit.AR1 &lt;- arima(potatoe.yield.diff.centeredao, order = c(1,0,0) ,
method= 'ML', include.mean = TRUE) )
( fit.AR1.wo.mean &lt;- arima(potatoe.yield.diff.centeredao, order = c(1,0,0) ,
method= 'ML', include.mean = FALSE) )

resfit.AR1 &lt;- residuals(fit.AR1)
resfit.AR1.centered &lt;- resfit.AR1 - mean(resfit.AR1)
sig2fit.AR1 &lt;- fit.AR1$sigma2

hist(resfit.AR1/sqrt(sig2fit.AR1))

acf2(resfit.AR1)

phi &lt;- coef(fit.AR1)[1]

nortestARMA(resfit.AR1.centered, sig2fit.AR1, d = 2)
# Using the (2014) approach where the residuals have been
# computed after estimating the mean (by first removing the average of the
# observations), and doing as if the mean had not
# been estimated and were known (include.mean = FALSE).
resfit.AR1.wo.mean &lt;- residuals(fit.AR1.wo.mean)
sig2fit.AR1.wo.mean &lt;- fit.AR1.wo.mean$sigma2
nortestARMA(resfit.AR1.wo.mean, sig2fit.AR1.wo.mean, d = 2)

Box.test(resfit.AR1.centered, lag = 3, type = "Ljung-Box", fitdf = 1)
Box.test(resfit.AR1.centered, lag = 6, type = "Ljung-Box", fitdf = 1)
Box.test(resfit.AR1.centered, lag = 12, type = "Ljung-Box", fitdf = 1)
Box.test(resfit.AR1.centered, lag = 14, type = "Ljung-Box", fitdf = 1)
Box.test(resfit.AR1.centered, lag = 20, type = "Ljung-Box", fitdf = 1)

# --------------------------------------
# ------------- fitting an AR(2) -------
# --------------------------------------

( fit.AR2 &lt;- arima(potatoe.yield.diff.centeredao, order = c(2, 0, 0),
method= 'ML', include.mean = TRUE) )
( fit.AR2.wo.mean &lt;- arima(potatoe.yield.diff.centeredao, order = c(2, 0, 0),
method= 'ML', include.mean = FALSE) )

resfit.AR2 &lt;- residuals(fit.AR2)
sig2fit.AR2 &lt;- fit.AR2$sigma2

hist( resfit.AR2/sqrt(sig2fit.AR2) )

acf2(resfit.AR2)

resfit.AR2.centered &lt;- resfit.AR2 - mean(resfit.AR2)
nortestARMA(resfit.AR2.centered, sig2fit.AR2, d = 2)
# Using the (2014) approach where the residuals have been
# computed after estimating the mean (by first removing the average of the
# observations), and doing as if the mean had not
# been estimated and were known (include.mean = FALSE).
resfit.AR2.wo.mean &lt;- residuals(fit.AR2.wo.mean)
sig2fit.AR2.wo.mean &lt;- fit.AR2.wo.mean$sigma2
nortestARMA(resfit.AR2.wo.mean, sig2fit.AR2, d = 2)

Box.test(resfit.AR2.centered, lag = 3, type= "Ljung-Box", fitdf = 2)
Box.test(resfit.AR2.centered, lag = 6, type= "Ljung-Box", fitdf = 2)
Box.test(resfit.AR2.centered, lag = 12, type= "Ljung-Box", fitdf = 2)
Box.test(resfit.AR2.centered, lag = 14, type= "Ljung-Box", fitdf = 2)
Box.test(resfit.AR2.centered, lag = 20, type= "Ljung-Box", fitdf = 2)

</code></pre>

<hr>
<h2 id='Piggott'>
Daily gas demand study by Piggott
</h2><span id='topic+Piggott'></span><span id='topic+resid.temp'></span>

<h3>Description</h3>

<p>Two series consisting of daily temperature values and the (square root
transformed) wind speed series obtained from Piggott (1980). This data
set was first studied by Shea (1987) and then by Ducharme et al. (2004).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Piggott)</code></pre>


<h3>Format</h3>

<p>A data frame with 366 observations on the following 2 variables.
</p>

<dl>
<dt><code>temp</code></dt><dd><p>numeric vector of daily temperatures.</p>
</dd>
<dt><code>wind.trans</code></dt><dd><p>numeric vector of the (square root
transformed) wind speed series.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Duchesne P., Lafaye de Micheaux P.
</p>


<h3>References</h3>

<p>Ducharme G., Lafaye de Micheaux P., (2004). Goodness-of-fit tests of normality for the
innovations in ARMA models. <em>Journal of Time Series Analysis</em> 25 (3), 373&ndash;395.
</p>
<p>Duchesne P., Lafaye de Micheaux P., Tagne J. (2016). Neyman Smooth Test of Normality for ARMA Time Series
Models with Unknown Mean. Submitted.
</p>
<p>Piggott J. L., (1980). The use o f Box-Jenkins modelling for the forecasting of daily gas demand.
Paper presented to the <em>Royal Statistical Society</em>.
</p>
<p>Shea B. L., (1987). Estimation of Multivariate Time
Series. <em>Journal of Time Series Analysis</em> 8 (1), 95&ndash;109.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Piggott)
</code></pre>

<hr>
<h2 id='potato'>
Prince Edward Island; Average Yield, Potatoes (Hundredweight per harvested acres (1957-2014))
</h2><span id='topic+potato'></span>

<h3>Description</h3>

<p>We retrieved the data from the Canadian Socio-Economic Information Management System
(CANSIM), which is a computerized database of Statistics Canada. The time series
consists of annual data on the productivity of potatoes (per acre) in Prince Edward
Island for the time period 1957-2014 (CANSIM Series V47152).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(potato)</code></pre>


<h3>Format</h3>

<p>A data frame with 58 observations on the following 2 variables.
</p>

<dl>
<dt><code>year</code></dt><dd><p>numeric vector of the years of harvest</p>
</dd>
<dt><code>potatoeyield</code></dt><dd><p>numeric vector of the productivity of
potatoes (Hundredweight per harvested acres)</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Duchesne P., Lafaye de Micheaux P.
</p>


<h3>References</h3>

<p>Cheng H., (2005). Competitive relationship among potato production areas in northeastern
america. <em>Journal of Food Distribution Research Proceedings</em> 36 (1), 27&ndash;32.
</p>
<p>Ducharme G., Lafaye de Micheaux P., (2004). Goodness-of-fit tests of normality for the
innovations in ARMA models. <em>Journal of Time Series Analysis</em> 25 (3), 373&ndash;395.
</p>
<p>Duchesne P., Lafaye de Micheaux P., Tagne J. (2016). Neyman Smooth Test of Normality for ARMA Time Series
Models with Unknown Mean. Submitted.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(potato)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
