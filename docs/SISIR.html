<!DOCTYPE html><html lang="en"><head><title>Help for package SISIR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SISIR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#project'><p>sparse SIR</p></a></li>
<li><a href='#ridgeRes'><p>Print ridgeRes object</p></a></li>
<li><a href='#ridgeSIR'><p>ridge SIR</p></a></li>
<li><a href='#sfcb'><p>sfcb</p></a></li>
<li><a href='#SFCB-class'><p>Methods for SFCB objects</p></a></li>
<li><a href='#SISIR'><p>Interval Sparse SIR</p></a></li>
<li><a href='#SISIRres'><p>Print SISIRres object</p></a></li>
<li><a href='#sparseRes'><p>Print sparseRes object</p></a></li>
<li><a href='#sparseSIR'><p>sparse SIR</p></a></li>
<li><a href='#truffles'><p>Dataset &quot;Truffles&quot;</p></a></li>
<li><a href='#tune.ridgeSIR'><p>Cross-Validation for ridge SIR</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Select Intervals Suited for Functional Regression</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-08-16</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Nathalie Vialaneix &lt;nathalie.vialaneix@inrae.fr&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Interval fusion and selection procedures for regression with 
             functional inputs. Methods include a semiparametric approach based
             on Sliced Inverse Regression (SIR), as described in 
             &lt;<a href="https://doi.org/10.1007%2Fs11222-018-9806-6">doi:10.1007/s11222-018-9806-6</a>&gt; (standard ridge and sparse SIR are 
             also included in the package) and a random forest based approach, 
             as described in &lt;<a href="https://doi.org/10.1002%2Fsam.11705">doi:10.1002/sam.11705</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), foreach, doParallel, graphics, stats</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://forgemia.inra.fr/sfcb/sisir">https://forgemia.inra.fr/sfcb/sisir</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://forgemia.inra.fr/sfcb/sisir/-/issues">https://forgemia.inra.fr/sfcb/sisir/-/issues</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>Matrix, expm, RSpectra, glmnet, Boruta, CORElearn, dplyr,
mixOmics, purrr, ranger, tidyr, tidyselect, adjclust, magrittr,
rlang, ggplot2, aricode, dendextend, reshape2, RColorBrewer</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-08-16 11:51:16 UTC; nathalie</td>
</tr>
<tr>
<td>Author:</td>
<td>Victor Picheny [aut],
  Remi Servien [aut],
  Nathalie Vialaneix
    <a href="https://orcid.org/0000-0003-1156-0639"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre]</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-08-16 12:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='project'>sparse SIR</h2><span id='topic+project'></span><span id='topic+project.sparseRes'></span>

<h3>Description</h3>

<p><code>project</code> performs the projection on the sparse EDR space (as obtained
by the <code><a href="glmnet.html#topic+glmnet">glmnet</a></code>)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'sparseRes'
project(object)

project(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="project_+3A_object">object</code></td>
<td>
<p>an object of class <code>sparseRes</code> as obtained from the 
function <code><a href="#topic+sparseSIR">sparseSIR</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The projection is obtained by the function 
<code><a href="glmnet.html#topic+predict.glmnet">predict.glmnet</a></code>.
</p>


<h3>Value</h3>

<p>a matrix of dimension n x d with the projection of the observations
on the d dimensions of the sparse EDR space
</p>


<h3>Author(s)</h3>

<p>Victor Picheny, <a href="mailto:victor.picheny@inrae.fr">victor.picheny@inrae.fr</a><br />
Remi Servien, <a href="mailto:remi.servien@inrae.fr">remi.servien@inrae.fr</a><br />
Nathalie Vialaneix, <a href="mailto:nathalie.vialaneix@inrae.fr">nathalie.vialaneix@inrae.fr</a>
</p>


<h3>References</h3>

<p>Picheny, V., Servien, R. and Villa-Vialaneix, N. (2016) 
Interpretable sparse SIR for digitized functional data.
<em>Statistics and Computing</em>, <strong>29</strong>(2), 255&ndash;267.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sparseSIR">sparseSIR</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1140)
tsteps &lt;- seq(0, 1, length = 200)
nsim &lt;- 100
simulate_bm &lt;- function() return(c(0, cumsum(rnorm(length(tsteps)-1, sd=1))))
x &lt;- t(replicate(nsim, simulate_bm()))
beta &lt;- cbind(sin(tsteps*3*pi/2), sin(tsteps*5*pi/2))
beta[((tsteps &lt; 0.2) | (tsteps &gt; 0.5)), 1] &lt;- 0
beta[((tsteps &lt; 0.6) | (tsteps &gt; 0.75)), 2] &lt;- 0
y &lt;- log(abs(x %*% beta[ ,1]) + 1) + sqrt(abs(x %*% beta[ ,2]))
y &lt;- y + rnorm(nsim, sd = 0.1)

res_ridge &lt;- ridgeSIR(x, y, H = 10, d = 2)
res_sparse &lt;- sparseSIR(res_ridge, rep(1, ncol(x)))
proj_data &lt;- project(res_sparse)


</code></pre>

<hr>
<h2 id='ridgeRes'>Print ridgeRes object</h2><span id='topic+ridgeRes'></span><span id='topic+summary.ridgeRes'></span><span id='topic+print.ridgeRes'></span><span id='topic+ridgeRes-class'></span>

<h3>Description</h3>

<p>Print a summary of the result of <code><a href="#topic+ridgeSIR">ridgeSIR</a></code> (
<code>ridgeRes</code> object)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ridgeRes'
summary(object, ...)

## S3 method for class 'ridgeRes'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ridgeRes_+3A_object">object</code></td>
<td>
<p>a <code>ridgeRes</code> object</p>
</td></tr>
<tr><td><code id="ridgeRes_+3A_...">...</code></td>
<td>
<p>not used</p>
</td></tr>
<tr><td><code id="ridgeRes_+3A_x">x</code></td>
<td>
<p>a <code>ridgeRes</code> object</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Victor Picheny, <a href="mailto:victor.picheny@inrae.fr">victor.picheny@inrae.fr</a><br /> 
Remi Servien, <a href="mailto:remi.servien@inrae.fr">remi.servien@inrae.fr</a><br />
Nathalie Vialaneix, <a href="mailto:nathalie.vialaneix@inrae.fr">nathalie.vialaneix@inrae.fr</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ridgeSIR">ridgeSIR</a></code>
</p>

<hr>
<h2 id='ridgeSIR'>ridge SIR</h2><span id='topic+ridgeSIR'></span>

<h3>Description</h3>

<p><code>ridgeSIR</code> performs the first step of the method (ridge regularization
of SIR)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ridgeSIR(x, y, H, d, mu2 = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ridgeSIR_+3A_x">x</code></td>
<td>
<p>explanatory variables (numeric matrix or data frame)</p>
</td></tr>
<tr><td><code id="ridgeSIR_+3A_y">y</code></td>
<td>
<p>target variable (numeric vector)</p>
</td></tr>
<tr><td><code id="ridgeSIR_+3A_h">H</code></td>
<td>
<p>number of slices (integer)</p>
</td></tr>
<tr><td><code id="ridgeSIR_+3A_d">d</code></td>
<td>
<p>number of dimensions to be kept</p>
</td></tr>
<tr><td><code id="ridgeSIR_+3A_mu2">mu2</code></td>
<td>
<p>ridge regularization parameter (numeric, positive)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>SI-SIR
</p>


<h3>Value</h3>

<p>S3 object of class <code>ridgeRes</code>: a list consisting of
</p>

<dl>
<dt><code>EDR</code></dt><dd><p> the estimated EDR space (a p x d matrix)</p>
</dd>
<dt><code>condC</code></dt><dd><p> the estimated slice projection on EDR (a d x H 
matrix)</p>
</dd>
<dt><code>eigenvalues</code></dt><dd><p> the eigenvalues obtained during the generalized 
eigendecomposition performed by SIR</p>
</dd>
<dt><code>parameters</code></dt><dd><p> a list of hyper-parameters for the method: 
</p>

<dl>
<dt><code>H</code></dt><dd><p> number of slices</p>
</dd>
<dt><code>d</code></dt><dd><p> dimension of the EDR space</p>
</dd>
<dt><code>mu2</code></dt><dd><p> regularization parameter for the ridge penalty</p>
</dd>
</dl>
</dd>
<dt><code>utils</code></dt><dd><p> useful outputs for further computations:
</p>

<dl>
<dt><code>Sigma</code></dt><dd><p> covariance matrix for x</p>
</dd>
<dt><code>slices</code></dt><dd><p> slice number for all observations</p>
</dd>
<dt><code>invsqrtS</code></dt><dd><p> value of the inverse square root of the 
regularized covariance matrix for x</p>
</dd>
</dl>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Victor Picheny, <a href="mailto:victor.picheny@inrae.fr">victor.picheny@inrae.fr</a><br />
Remi Servien, <a href="mailto:remi.servien@inrae.fr">remi.servien@inrae.fr</a><br />
Nathalie Vialaneix, <a href="mailto:nathalie.vialaneix@inrae.fr">nathalie.vialaneix@inrae.fr</a>
</p>


<h3>References</h3>

<p>Picheny, V., Servien, R. and Villa-Vialaneix, N. (2019) 
Interpretable sparse SIR for digitized functional data. 
<em>Statistics and Computing</em>, <strong>29</strong>(2), 255&ndash;267.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sparseSIR">sparseSIR</a></code>, <code><a href="#topic+SISIR">SISIR</a></code>, 
<code><a href="#topic+tune.ridgeSIR">tune.ridgeSIR</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1140)
tsteps &lt;- seq(0, 1, length = 50)
simulate_bm &lt;- function() return(c(0, cumsum(rnorm(length(tsteps)-1, sd=1))))
x &lt;- t(replicate(50, simulate_bm()))
beta &lt;- cbind(sin(tsteps*3*pi/2), sin(tsteps*5*pi/2)) 
y &lt;- log(abs(x %*% beta[ ,1])) + sqrt(abs(x %*% beta[ ,2]))
y &lt;- y + rnorm(50, sd = 0.1)
res_ridge &lt;- ridgeSIR(x, y, H = 10, d = 2, mu2 = 10^8)
res_ridge

</code></pre>

<hr>
<h2 id='sfcb'>sfcb</h2><span id='topic+sfcb'></span>

<h3>Description</h3>

<p><code>sfcb</code> performs interval selection based on random forests
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sfcb(
  X,
  Y,
  group.method = c("adjclust", "cclustofvar"),
  summary.method = c("pls", "basics", "cclustofvar"),
  selection.method = c("none", "boruta", "relief"),
  at = round(0.15 * ncol(X)),
  range.at = NULL,
  seed = NULL,
  repeats = 5,
  keep.time = TRUE,
  verbose = TRUE,
  parallel = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sfcb_+3A_x">X</code></td>
<td>
<p>input predictors (matrix or data.frame)</p>
</td></tr>
<tr><td><code id="sfcb_+3A_y">Y</code></td>
<td>
<p>target variable (vector whose length is equal to the number of rows
in X)</p>
</td></tr>
<tr><td><code id="sfcb_+3A_group.method">group.method</code></td>
<td>
<p>group method. Default to <code>"adjclust"</code></p>
</td></tr>
<tr><td><code id="sfcb_+3A_summary.method">summary.method</code></td>
<td>
<p>summary method. Default to <code>"pls"</code></p>
</td></tr>
<tr><td><code id="sfcb_+3A_selection.method">selection.method</code></td>
<td>
<p>selection method. Default to <code>"none"</code> (no 
selection performed)</p>
</td></tr>
<tr><td><code id="sfcb_+3A_at">at</code></td>
<td>
<p>number of groups targeted for output results (integer). Not used
when <code>range.at</code> is not <code>NULL</code></p>
</td></tr>
<tr><td><code id="sfcb_+3A_range.at">range.at</code></td>
<td>
<p>(vector of integer) sequence of the numbers of groups for
output results</p>
</td></tr>
<tr><td><code id="sfcb_+3A_seed">seed</code></td>
<td>
<p>random seed (integer)</p>
</td></tr>
<tr><td><code id="sfcb_+3A_repeats">repeats</code></td>
<td>
<p>number of repeats for the final random forest computation</p>
</td></tr>
<tr><td><code id="sfcb_+3A_keep.time">keep.time</code></td>
<td>
<p>keep computational times for each step of the method? 
(logical; default to <code>TRUE</code>)</p>
</td></tr>
<tr><td><code id="sfcb_+3A_verbose">verbose</code></td>
<td>
<p>print messages? (logical; default to <code>TRUE</code>)</p>
</td></tr>
<tr><td><code id="sfcb_+3A_parallel">parallel</code></td>
<td>
<p>not implemented yet</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class <code>"SFCB"</code> with elements: 
</p>
<table role = "presentation">
<tr><td><code>dendro</code></td>
<td>
<p>a dendrogram corresponding to the method chosen in
<code>group.method</code></p>
</td></tr>
<tr><td><code>groups</code></td>
<td>
<p>a list of length <code>length(range.at)</code> (or of length 1 if
<code>range.at == NULL</code>) that contains the clusterings of input variables
for the selected group numbers</p>
</td></tr>
<tr><td><code>summaries</code></td>
<td>
<p>a list of the same length than <code>$groups</code> that 
contains the summarized predictors according to the method chosen in 
<code>summary.methods</code></p>
</td></tr>
<tr><td><code>selected</code></td>
<td>
<p>a list of the same length than <code>$groups</code> that contains
the names of the variable selected by <code>selection.method</code> if it is not
equal to <code>"none"</code></p>
</td></tr>
<tr><td><code>mse</code></td>
<td>
<p>a data.frame with <code>repeats</code> <code class="reqn">\times</code>
<code>length($groups)</code> rows that contains Mean Squared Errors of the 
<code>repeats</code> random forests fitted for each number of groups</p>
</td></tr>
<tr><td><code>importance</code></td>
<td>
<p>a list of the same length than <code>$groups</code> that 
contains a data.frame providing variable importances for the variables in
selected groups in <code>repeats</code> columns (one for each iteration of the
random forest method). When <code>summary.method == "basics"</code>, importance 
for mean and sd are provided in separated columns, in which case, the 
number of columns is equal to 2<code>repeats</code></p>
</td></tr>
<tr><td><code>computational.times</code></td>
<td>
<p>a vector with 4 values corresponding to the
computational times of (respectively) the group, summary, selection, and RF
steps. Only if <code>keep.time == TRUE</code></p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>function call</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Remi Servien, <a href="mailto:remi.servien@inrae.fr">remi.servien@inrae.fr</a><br />
Nathalie Vialaneix, <a href="mailto:nathalie.vialaneix@inrae.fr">nathalie.vialaneix@inrae.fr</a>
</p>


<h3>References</h3>

<p>Servien, R. and Vialaneix, N. (2024) A random forest approach 
for interval selection in functional regression. <em>Statistical Analysis
and Data Mining</em>, <strong>17</strong>(4), e11705. <a href="https://doi.org/10.1002/sam.11705">doi:10.1002/sam.11705</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(truffles)
out1 &lt;- sfcb(rainfall, truffles, group.method = "adjclust", 
             summary.method = "pls", selection.method = "relief")
out2 &lt;- sfcb(rainfall, truffles, group.method = "adjclust", 
             summary.method = "basics", selection.method = "none",
             range.at = c(5, 7))
</code></pre>

<hr>
<h2 id='SFCB-class'>Methods for SFCB objects</h2><span id='topic+SFCB-class'></span><span id='topic+summary.SFCB'></span><span id='topic+print.SFCB'></span><span id='topic+plot.SFCB'></span><span id='topic+extract_at.SFCB'></span><span id='topic+quality.SFCB'></span><span id='topic+extract_at'></span><span id='topic+quality'></span>

<h3>Description</h3>

<p>Print, plot, manipulate or compute quality for outputs of the
<code><a href="#topic+sfcb">sfcb</a></code> function (<code>SFCB</code> object)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'SFCB'
summary(object, ...)

## S3 method for class 'SFCB'
print(x, ...)

## S3 method for class 'SFCB'
plot(
  x,
  ...,
  plot.type = c("dendrogram", "selection", "importance", "quality"),
  sel.type = c("importance", "selection"),
  threshold = "none",
  shape.imp = c("boxplot", "histogram"),
  quality.crit = "mse"
)

extract_at(object, at)

quality(object, ground_truth, threshold = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SFCB-class_+3A_object">object</code></td>
<td>
<p>a <code>SFCB</code> object</p>
</td></tr>
<tr><td><code id="SFCB-class_+3A_...">...</code></td>
<td>
<p>not used</p>
</td></tr>
<tr><td><code id="SFCB-class_+3A_x">x</code></td>
<td>
<p>a <code>SFCB</code> object</p>
</td></tr>
<tr><td><code id="SFCB-class_+3A_plot.type">plot.type</code></td>
<td>
<p>type of the plot. Default to <code>"dendrogram"</code> (see
Details)</p>
</td></tr>
<tr><td><code id="SFCB-class_+3A_sel.type">sel.type</code></td>
<td>
<p>when <code>plot.type == "selection"</code>, criterion on which to
base the selection. Default to <code>"importance"</code></p>
</td></tr>
<tr><td><code id="SFCB-class_+3A_threshold">threshold</code></td>
<td>
<p>numeric value. If not <code>NULL</code>, selection of variables to
compute qualities is based on a threshold of importance values
<code>extract_at</code></p>
</td></tr>
<tr><td><code id="SFCB-class_+3A_shape.imp">shape.imp</code></td>
<td>
<p>when <code>plot.type == "importance"</code>, type of plot to
represent the importance. Default to <code>"boxplot"</code></p>
</td></tr>
<tr><td><code id="SFCB-class_+3A_quality.crit">quality.crit</code></td>
<td>
<p>character vector (length 1 or 2) indicating one or two
quality criteria to display. The values have to be taken in {<code>"mse"</code>,
<code>"time"</code>, <code>"Precision"</code>, <code>"Recall"</code>, <code>"ARI"</code>, 
<code>"NMI"</code>}. If <code>"time"</code> is chosen, it can not be associated with any
other criterion</p>
</td></tr>
<tr><td><code id="SFCB-class_+3A_at">at</code></td>
<td>
<p>numeric vector. Set of the number of intervals to extract for</p>
</td></tr>
<tr><td><code id="SFCB-class_+3A_ground_truth">ground_truth</code></td>
<td>
<p>numeric vector of ground truth. Target variables 
to compute qualities correspond to non-zero entries of this vector</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>plot</code> functions can be used in four different ways to 
extract information from the <code>SFCB</code> object: </p>

<ul>
<li> <p><code>plot.type == "dendrogram"</code> displays the dendrogram obtained at
the clustering step of the method. Depending on the cases, the dendrogram
comes with additional information on clusters, variable selections and/or
importance values;
</p>
</li>
<li> <p><code>plot.type == "selection"</code> displays either the evolution of the
importance for the simulation with the best (smallest) MSE for each time
step in the range of the functional predictor or the evolution of the
selected intervals along the whole range of the functional prediction also 
for the best MSE;
</p>
</li>
<li> <p><code>plot.type == "importance"</code> displays a summary of the importance
values over the whole range of the functional predictor and for the 
different experiments. This summary can take the form of a boxplot or of
an histogram;
</p>
</li>
<li> <p><code>plot.type == "quality"</code> displays one or two quality distribution
with respect to the different experiments and different number of intervals.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Remi Servien, <a href="mailto:remi.servien@inrae.fr">remi.servien@inrae.fr</a><br />
Nathalie Vialaneix, <a href="mailto:nathalie.vialaneix@inrae.fr">nathalie.vialaneix@inrae.fr</a>
</p>


<h3>References</h3>

<p>Servien, R. and Vialaneix, N. (2023) A random forest approach 
for interval selection in functional regression. Preprint.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sfcb">sfcb</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(truffles)
out1 &lt;- sfcb(rainfall, truffles, group.method = "adjclust", 
             summary.method = "pls", selection.method = "relief")
summary(out1)

plot(out1)
plot(out1, plot.type = "selection")
plot(out1, plot.type = "importance")

out2 &lt;- sfcb(rainfall, truffles, group.method = "adjclust", 
             summary.method = "basics", selection.method = "none",
             range.at = c(5, 7))
out3 &lt;- extract_at(out2, at = 6)
summary(out3)

</code></pre>

<hr>
<h2 id='SISIR'>Interval Sparse SIR</h2><span id='topic+SISIR'></span>

<h3>Description</h3>

<p><code>SISIR</code> performs an automatic search of relevant intervals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SISIR(
  object,
  inter_len = rep(1, nrow(object$EDR)),
  sel_prop = 0.05,
  itermax = Inf,
  minint = 2,
  parallel = TRUE,
  ncores = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SISIR_+3A_object">object</code></td>
<td>
<p>an object of class <code>ridgeRes</code> as obtained from the 
function <code><a href="#topic+ridgeSIR">ridgeSIR</a></code></p>
</td></tr>
<tr><td><code id="SISIR_+3A_inter_len">inter_len</code></td>
<td>
<p>(numeric) vector with interval lengths for the initial 
state. Default is to set one interval for each variable (all intervals have
length 1)</p>
</td></tr>
<tr><td><code id="SISIR_+3A_sel_prop">sel_prop</code></td>
<td>
<p>fraction of the coefficients that will be considered as 
strong zeros and strong non zeros. Default to 0.05</p>
</td></tr>
<tr><td><code id="SISIR_+3A_itermax">itermax</code></td>
<td>
<p>maximum number of iterations. Default to Inf</p>
</td></tr>
<tr><td><code id="SISIR_+3A_minint">minint</code></td>
<td>
<p>minimum number of intervals. Default to 2</p>
</td></tr>
<tr><td><code id="SISIR_+3A_parallel">parallel</code></td>
<td>
<p>whether the computation should be performed in parallel or
not. Logical. Default is FALSE</p>
</td></tr>
<tr><td><code id="SISIR_+3A_ncores">ncores</code></td>
<td>
<p>number of cores to use if <code>parallel = TRUE</code>. If left to 
NULL, all available cores minus one are used</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Different quality criteria used to select the best models among a list of 
models with different interval definitions. Quality criteria are: 
log-likelihood (<code>loglik</code>), cross-validation error as provided by the
function <code><a href="glmnet.html#topic+glmnet">glmnet</a></code>, two versions of the AIC (<code>AIC</code> 
and <code>AIC2</code>) and of the BIC (<code>BIC</code> and <code>BIC2</code>) in which the 
number of parameters is either the number of non null intervals or the 
number of non null parameters with respect to the original variables
</p>


<h3>Value</h3>

<p>S3 object of class <code>SISIR</code>: a list consisting of
</p>

<dl>
<dt><code>sEDR</code></dt><dd><p> the estimated EDR spaces (a list of p x d matrices)</p>
</dd>
<dt><code>alpha</code></dt><dd><p> the estimated shrinkage coefficients (a list of 
vectors)</p>
</dd>
<dt><code>intervals</code></dt><dd><p> the interval lengths (a list of vectors)</p>
</dd>
<dt><code>quality</code></dt><dd><p> a data frame with various qualities for the model.
The chosen quality measures are the same than for the function 
<code><a href="#topic+sparseSIR">sparseSIR</a></code> plus the number of intervals <code>nbint</code></p>
</dd>
<dt><code>init_sel_prop</code></dt><dd><p> initial fraction of the coefficients which 
are considered as strong zeros or strong non zeros</p>
</dd>
<dt><code>rSIR</code></dt><dd><p> same as the input <code>object</code></p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Victor Picheny, <a href="mailto:victor.picheny@inrae.fr">victor.picheny@inrae.fr</a><br />
Remi Servien, <a href="mailto:remi.servien@inrae.fr">remi.servien@inrae.fr</a><br />
Nathalie Vialaneix, <a href="mailto:nathalie.vialaneix@inrae.fr">nathalie.vialaneix@inrae.fr</a>
</p>


<h3>References</h3>

<p>Picheny, V., Servien, R. and Villa-Vialaneix, N. (2016) 
Interpretable sparse SIR for digitized functional data.
<em>Statistics and Computing</em>, <strong>29</strong>(2), 255&ndash;267.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ridgeSIR">ridgeSIR</a></code>, <code><a href="#topic+sparseSIR">sparseSIR</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1140)
tsteps &lt;- seq(0, 1, length = 200)
nsim &lt;- 100
simulate_bm &lt;- function() return(c(0, cumsum(rnorm(length(tsteps)-1, sd=1))))
x &lt;- t(replicate(nsim, simulate_bm()))
beta &lt;- cbind(sin(tsteps*3*pi/2), sin(tsteps*5*pi/2))
beta[((tsteps &lt; 0.2) | (tsteps &gt; 0.5)), 1] &lt;- 0
beta[((tsteps &lt; 0.6) | (tsteps &gt; 0.75)), 2] &lt;- 0
y &lt;- log(abs(x %*% beta[ ,1]) + 1) + sqrt(abs(x %*% beta[ ,2]))
y &lt;- y + rnorm(nsim, sd = 0.1)
res_ridge &lt;- ridgeSIR(x, y, H = 10, d = 2, mu2 = 10^8)
res_fused &lt;- SISIR(res_ridge, rep(1, ncol(x)), ncores = 2)
res_fused

</code></pre>

<hr>
<h2 id='SISIRres'>Print SISIRres object</h2><span id='topic+SISIRres'></span><span id='topic+summary.SISIRres'></span><span id='topic+print.SISIRres'></span>

<h3>Description</h3>

<p>Print a summary of the result of <code><a href="#topic+SISIRres">SISIRres</a></code> (
<code>SISIRres</code> object)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'SISIRres'
summary(object, ...)

## S3 method for class 'SISIRres'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SISIRres_+3A_object">object</code></td>
<td>
<p>a <code>SISIRres</code> object</p>
</td></tr>
<tr><td><code id="SISIRres_+3A_...">...</code></td>
<td>
<p>not used</p>
</td></tr>
<tr><td><code id="SISIRres_+3A_x">x</code></td>
<td>
<p>a <code>SISIRres</code> object</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Victor Picheny, <a href="mailto:victor.picheny@inrae.fr">victor.picheny@inrae.fr</a><br />
Remi Servien, <a href="mailto:remi.servien@inrae.fr">remi.servien@inrae.fr</a><br />
Nathalie Vialaneix, <a href="mailto:nathalie.vialaneix@inrae.fr">nathalie.vialaneix@inrae.fr</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SISIR">SISIR</a></code>
</p>

<hr>
<h2 id='sparseRes'>Print sparseRes object</h2><span id='topic+sparseRes'></span><span id='topic+summary.sparseRes'></span><span id='topic+print.sparseRes'></span><span id='topic+sparseRes-class'></span>

<h3>Description</h3>

<p>Print a summary of the result of <code><a href="#topic+sparseSIR">sparseSIR</a></code> (
<code>sparseRes</code> object)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'sparseRes'
summary(object, ...)

## S3 method for class 'sparseRes'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sparseRes_+3A_object">object</code></td>
<td>
<p>a <code>sparseRes</code> object</p>
</td></tr>
<tr><td><code id="sparseRes_+3A_...">...</code></td>
<td>
<p>not used</p>
</td></tr>
<tr><td><code id="sparseRes_+3A_x">x</code></td>
<td>
<p>a <code>sparseRes</code> object</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Victor Picheny, <a href="mailto:victor.picheny@inrae.fr">victor.picheny@inrae.fr</a><br />
Remi Servien, <a href="mailto:remi.servien@inrae.fr">remi.servien@inrae.fr</a><br />
Nathalie Vialaneix, <a href="mailto:nathalie.vialaneix@inra.fr">nathalie.vialaneix@inra.fr</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sparseSIR">sparseSIR</a></code>
</p>

<hr>
<h2 id='sparseSIR'>sparse SIR</h2><span id='topic+sparseSIR'></span>

<h3>Description</h3>

<p><code>sparseSIR</code> performs the second step of the method (shrinkage of ridge
SIR results
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sparseSIR(
  object,
  inter_len,
  adaptive = FALSE,
  sel_prop = 0.05,
  parallel = FALSE,
  ncores = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sparseSIR_+3A_object">object</code></td>
<td>
<p>an object of class <code>ridgeRes</code> as obtained from the 
function <code><a href="#topic+ridgeSIR">ridgeSIR</a></code></p>
</td></tr>
<tr><td><code id="sparseSIR_+3A_inter_len">inter_len</code></td>
<td>
<p>(numeric) vector with interval lengths</p>
</td></tr>
<tr><td><code id="sparseSIR_+3A_adaptive">adaptive</code></td>
<td>
<p>should the function returns the list of strong zeros and non
strong zeros (logical). Default to FALSE</p>
</td></tr>
<tr><td><code id="sparseSIR_+3A_sel_prop">sel_prop</code></td>
<td>
<p>used only when <code>adaptive = TRUE</code>. Fraction of the 
coefficients that will be considered as strong zeros and strong non zeros.
Default to 0.05</p>
</td></tr>
<tr><td><code id="sparseSIR_+3A_parallel">parallel</code></td>
<td>
<p>whether the computation should be performed in parallel or
not. Logical. Default is FALSE</p>
</td></tr>
<tr><td><code id="sparseSIR_+3A_ncores">ncores</code></td>
<td>
<p>number of cores to use if <code>parallel = TRUE</code>. If left to 
NULL, all available cores minus one are used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>S3 object of class <code>sparseRes</code>: a list consisting of
</p>

<dl>
<dt><code>sEDR</code></dt><dd><p> the estimated EDR space (a p x d matrix)</p>
</dd>
<dt><code>alpha</code></dt><dd><p> the estimated shrinkage coefficients (a vector having
a length similar to <code>inter_len</code>)</p>
</dd>
<dt><code>quality</code></dt><dd><p> a vector with various qualities for the model (see
Details)</p>
</dd>
<dt><code>adapt_res</code></dt><dd><p> if <code>adaptive = TRUE</code>, a list of two vectors: 
</p>

<dl>
<dt><code>nonzeros</code></dt><dd><p> indexes of variables that are strong non zeros</p>
</dd>
<dt><code>zeros</code></dt><dd><p> indexes of variables that are strong zeros</p>
</dd>
</dl>
</dd>
<dt><code>parameters</code></dt><dd><p> a list of hyper-parameters for the method: 
</p>

<dl>
<dt><code>inter_len</code></dt><dd><p> lengths of intervals</p>
</dd>
<dt><code>sel_prop</code></dt><dd><p> if <code>adaptive = TRUE</code>, fraction of the 
coefficients which are considered as strong zeros or strong non zeros</p>
</dd>
</dl>
</dd>
<dt><code>rSIR</code></dt><dd><p> same as the input <code>object</code></p>
</dd>
<dt><code>fit</code></dt><dd><p> a list for LASSO fit with:
</p>

<dl>
<dt><code>glmnet</code></dt><dd><p> result of the <code><a href="glmnet.html#topic+glmnet">glmnet</a></code> 
function</p>
</dd>
<dt><code>lambda</code></dt><dd><p> value of the best Lasso parameter by CV</p>
</dd>
<dt><code>x</code></dt><dd><p> exploratory variable values as passed to fit the 
model</p>
</dd>
</dl>
</dd>
</dl>

<p>@details Different quality criteria used to select the best models among a
list of models with different interval definitions. Quality criteria are:
log-likelihood (<code>loglik</code>), cross-validation error as provided by the
function <code><a href="glmnet.html#topic+glmnet">glmnet</a></code>, two versions of the AIC (<code>AIC</code> 
and <code>AIC2</code>) and of the BIC (<code>BIC</code> and <code>BIC2</code>) in which the 
number of parameters is either the number of non null intervals or the 
number of non null parameters with respect to the original variables.
</p>


<h3>Author(s)</h3>

<p>Victor Picheny, <a href="mailto:victor.picheny@inrae.fr">victor.picheny@inrae.fr</a><br />
Remi Servien, <a href="mailto:remi.servien@inrae.fr">remi.servien@inrae.fr</a><br />
Nathalie Vialaneix, <a href="mailto:nathalie.vialaneix@inrae.fr">nathalie.vialaneix@inrae.fr</a>
</p>


<h3>References</h3>

<p>Picheny, V., Servien, R., and Villa-Vialaneix, N. (2019) 
Interpretable sparse SIR for digitized functional data. 
<em>Statistics and Computing</em>, <strong>29</strong>(2), 255&ndash;267.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ridgeSIR">ridgeSIR</a></code>, <code><a href="#topic+project.sparseRes">project.sparseRes</a></code>, 
<code><a href="#topic+SISIR">SISIR</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1140)
tsteps &lt;- seq(0, 1, length = 200)
nsim &lt;- 100
simulate_bm &lt;- function() return(c(0, cumsum(rnorm(length(tsteps)-1, sd=1))))
x &lt;- t(replicate(nsim, simulate_bm()))
beta &lt;- cbind(sin(tsteps*3*pi/2), sin(tsteps*5*pi/2))
beta[((tsteps &lt; 0.2) | (tsteps &gt; 0.5)), 1] &lt;- 0
beta[((tsteps &lt; 0.6) | (tsteps &gt; 0.75)), 2] &lt;- 0
y &lt;- log(abs(x %*% beta[ ,1]) + 1) + sqrt(abs(x %*% beta[ ,2]))
y &lt;- y + rnorm(nsim, sd = 0.1)
res_ridge &lt;- ridgeSIR(x, y, H = 10, d = 2, mu2 = 10^8)
res_sparse &lt;- sparseSIR(res_ridge, rep(10, 20))

</code></pre>

<hr>
<h2 id='truffles'>Dataset &quot;Truffles&quot;</h2><span id='topic+truffles'></span><span id='topic+rainfall'></span><span id='topic+beta'></span>

<h3>Description</h3>

<p>Yearly truffles production and corresponding monthly rainfall 
information of the Perigord black truffle in the Vaucluse (France) between
1924 and 1949.
</p>


<h3>Format</h3>

<p>3 datasets are provided: </p>

<ul>
<li> <p><code>rainfall</code>: a data frame with 15 columns (months from January 
Year n to March Year n+1) and 25 rows (production years from 1924/1925 to 
1948/1949). Data correspond to cumulated rainfall in mm;
</p>
</li>
<li> <p><code>truffles</code>: a vector with 25 values corresponding to the total 
production (in kg) of truffles in the truffle patch of T. melanosporum de 
Pernes-Les-Fontaines (Vaucluse, France);
</p>
</li>
<li> <p><code>beta</code>: 0/1 vector with 15 values indicated the months during 
which the rainfall has the most important influence on the truffle 
production, as provided by experts.
</p>
</li></ul>



<h3>Details</h3>

<p>This dataset has been made available by courtesy of the authors of 
the publication [Baragatti <em>et al.</em>, 2019]. Meteorological data have 
been provided by Meteo France https://meteofrance.com (Orange meteorological 
station) and truffle production data are courtesy of the truffle patch.
</p>


<h3>References</h3>

<p>Baragatti M., Grollemund P.M., Montpied P., Dupouey J.L., Gravier J., Murat 
C., Le Tacon F. (2019) Influence of annual climatic variations, climate
changes, and sociological factors on the production of the Perigord black 
truffle (<em>Tuber melanosporum Vittad.</em>) from 1903-1904 to 1988-1989 in 
the Vaucluse (France), <em>Mycorrhiza</em>, <strong>29</strong>(2), 113-125.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(truffles)
summary(truffles)
plot(1:15, rainfall[1, ], type = "l", xlab = "month", ylab = "rainfall (mm)")
</code></pre>

<hr>
<h2 id='tune.ridgeSIR'>Cross-Validation for ridge SIR</h2><span id='topic+tune.ridgeSIR'></span>

<h3>Description</h3>

<p><code>tune.ridgeSIR</code> performs a Cross Validation for ridge SIR estimation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tune.ridgeSIR(
  x,
  y,
  listH,
  list_mu2,
  list_d,
  nfolds = 10,
  parallel = TRUE,
  ncores = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tune.ridgeSIR_+3A_x">x</code></td>
<td>
<p>explanatory variables (numeric matrix or data frame)</p>
</td></tr>
<tr><td><code id="tune.ridgeSIR_+3A_y">y</code></td>
<td>
<p>target variable (numeric vector)</p>
</td></tr>
<tr><td><code id="tune.ridgeSIR_+3A_listh">listH</code></td>
<td>
<p>list of the number of slices to be tested (numeric vector)</p>
</td></tr>
<tr><td><code id="tune.ridgeSIR_+3A_list_mu2">list_mu2</code></td>
<td>
<p>list of ridge regularization parameters to be tested 
(numeric vector)</p>
</td></tr>
<tr><td><code id="tune.ridgeSIR_+3A_list_d">list_d</code></td>
<td>
<p>list of the dimensions to be tested (numeric vector)</p>
</td></tr>
<tr><td><code id="tune.ridgeSIR_+3A_nfolds">nfolds</code></td>
<td>
<p>number of folds for the cross validation. Default is 10</p>
</td></tr>
<tr><td><code id="tune.ridgeSIR_+3A_parallel">parallel</code></td>
<td>
<p>whether the computation should be performed in parallel or
not. Logical. Default is FALSE</p>
</td></tr>
<tr><td><code id="tune.ridgeSIR_+3A_ncores">ncores</code></td>
<td>
<p>number of cores to use if <code>parallel = TRUE</code>. If left to 
NULL, all available cores minus one are used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data frame with tested parameters and corresponding CV error and 
estimation of R(d)
</p>


<h3>Author(s)</h3>

<p>Victor Picheny, <a href="mailto:victor.picheny@inrae.fr">victor.picheny@inrae.fr</a><br />
Remi Servien, <a href="mailto:remi.servien@inrae.fr">remi.servien@inrae.fr</a><br />
Nathalie Vialaneix, <a href="mailto:nathalie.vialaneix@inrae.fr">nathalie.vialaneix@inrae.fr</a>
</p>


<h3>References</h3>

<p>Picheny, V., Servien, R. and Villa-Vialaneix, N. (2016) 
Interpretable sparse SIR for digitized functional data.
<em>Statistics and Computing</em>, <strong>29</strong>(2), 255&ndash;267.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ridgeSIR">ridgeSIR</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1115)
tsteps &lt;- seq(0, 1, length = 200)
nsim &lt;- 100
simulate_bm &lt;- function() return(c(0, cumsum(rnorm(length(tsteps)-1, sd=1))))
x &lt;- t(replicate(nsim, simulate_bm()))
beta &lt;- cbind(sin(tsteps*3*pi/2), sin(tsteps*5*pi/2))
y &lt;- log(abs(x %*% beta[ ,1])) + sqrt(abs(x %*% beta[ ,2]))
y &lt;- y + rnorm(nsim, sd = 0.1)
list_mu2 &lt;- 10^(0:10)
listH &lt;- c(5, 10)
list_d &lt;- 1:4
set.seed(1129)

res_tune &lt;- tune.ridgeSIR(x, y, listH, list_mu2, list_d, nfolds = 10, 
                          parallel = TRUE, ncores = 2)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
