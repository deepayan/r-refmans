<!DOCTYPE html><html><head><title>Help for package ExtremalDep</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ExtremalDep}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#angular'><p>Estimation of the angular density, angular measure and random generation from the angular distribution.</p></a></li>
<li><a href='#beed'><p>Bernstein Polynomials Based Estimation of Extremal Dependence</p></a></li>
<li><a href='#beed.boot'><p>Bootstrap Resampling and Bernstein Estimation of Extremal Dependence</p></a></li>
<li><a href='#beed.confband'><p>Nonparametric Bootstrap Confidence Intervals</p></a></li>
<li><a href='#desn'><p>Univariate extended skew-normal distribution</p></a></li>
<li><a href='#dest'><p>Univariate extended skew-t distribution</p></a></li>
<li><a href='#dExtDep'><p>Parametric and non-parametric density of Extremal Dependence</p></a></li>
<li><a href='#dGEV'><p>The Generalized Extreme Value Distribution</p></a></li>
<li><a href='#diagnostics'><p>Diagnostics plots for MCMC algorithm.</p></a></li>
<li><a href='#dim_ExtDep'><p>Dimensions calculations for parametric extremal dependence models</p></a></li>
<li><a href='#dmesn'><p>Bivariate and trivariate extended skew-normal distribution</p></a></li>
<li><a href='#dmest'><p>Bivariate and trivariate extended skew-t distribution</p></a></li>
<li><a href='#ellipse'><p>Level sets for bivariate normal, student-t and skew-normal distributions probability densities.</p></a></li>
<li><a href='#ExtQ'><p>Univariate Extreme Quantile</p></a></li>
<li><a href='#fExtDep'><p>Extremal dependence estimation</p></a></li>
<li><a href='#fExtDep.np'><p>Non-parametric extremal dependence estimation</p></a></li>
<li><a href='#fExtDepSpat'><p>Fitting of a max-stable process</p></a></li>
<li><a href='#fGEV'><p>Fitting of the Generalized Extreme Value Distribution</p></a></li>
<li><a href='#heat'><p>Summer temperature maxima in Melbourne, Australia between 1961 and 2010.</p></a></li>
<li><a href='#index.ExtDep'><p>Index of extremal dependence</p></a></li>
<li><a href='#logReturns'><p>Monthly maxima of log-return exchange rates of the Pound Sterling (GBP) against the US dollar (USD) and the Japanese yen (JPY), between March 1991 and December 2014.</p></a></li>
<li><a href='#madogram'><p>Madogram-based estimation of the Pickands Dependence Function</p></a></li>
<li><a href='#MilanPollution'><p>Pollution data for summer and winter months in Milan, Italy.</p></a></li>
<li><a href='#pExtDep'><p>Parametric and non-parametric distribution function of Extremal Dependence</p></a></li>
<li><a href='#pFailure'><p>Probability of falling into a failure region</p></a></li>
<li><a href='#plot_ExtDep'><p>Graphical summaries of parametric representations of extremal dependence.</p></a></li>
<li><a href='#plot_ExtDep.np'><p>Graphical summaries of non-parametric representations of extremal dependence.</p></a></li>
<li><a href='#pollution'><p>Air quality datasets containing daily maxima of air pollutants (PM10, NO, NO2, 03 and S02)</p>
recorded in Leeds (U.K.), during five winter seasons (November-Februrary) between 1994 and 1998.</a></li>
<li><a href='#PrecipFrance'><p>Weekly maxima of hourly rainfall in France</p></a></li>
<li><a href='#returns'>
<p>Compute return values</p></a></li>
<li><a href='#rExtDep'><p>Parametric and semi-parametric random generator of extreme events</p></a></li>
<li><a href='#rExtDepSpat'><p>Random generation of max-stable processes</p></a></li>
<li><a href='#simplex'><p>Definition of a multivariate simplex</p></a></li>
<li><a href='#summary_ExtDep'><p>Summary of MCMC algorithm.</p></a></li>
<li><a href='#trans2GEV'><p>Transformation to GEV distribution</p></a></li>
<li><a href='#trans2UFrechet'><p>Transformation to unit Frechet distribution</p></a></li>
<li><a href='#Wind'><p>Weekly maximum wind speed data collected over 4 stations across Oklahoma, USA, over the March-May preiod between 1996 and 2012.</p></a></li>
<li><a href='#WindSpeedGust'><p>Hourly wind gust, wind speed and air pressure at Lingen (GER), Ossendorf (GER) and Parcay-Meslay (FRA).</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>0.0.4-1</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-09-01</td>
</tr>
<tr>
<td>Title:</td>
<td>Extremal Dependence Models</td>
</tr>
<tr>
<td>Author:</td>
<td>Boris Beranger [aut],
  Simone Padoan [cre, aut],
  Giulia Marcon [aut],
  Steven G. Johnson [ctb] (Author of included cubature fragments),
  Rudolf Schuerer [ctb] (Author of included cubature fragments),
  Brian Gough [ctb] (Author of included cubature fragments),
  Alec G. Stephenson [ctb],
  Anne Sabourin [ctb] (Author of included BMAmevt fragments)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Simone Padoan &lt;simone.padoan@unibocconi.it&gt;</td>
</tr>
<tr>
<td>Imports:</td>
<td>numDeriv, evd, sn, quadprog, copula, nloptr, gtools, mvtnorm,
fda, parallel, doParallel, foreach</td>
</tr>
<tr>
<td>Suggests:</td>
<td>fields, extraDistr</td>
</tr>
<tr>
<td>Description:</td>
<td>A set of procedures for parametric and non-parametric modelling of the dependence structure of multivariate extreme-values is provided. The statistical inference is performed with non-parametric estimators, likelihood-based estimators and Bayesian techniques. It adapts the methodologies of Beranger and Padoan (2015) &lt;<a href="https://doi.org/10.48550/arXiv.1508.05561">doi:10.48550/arXiv.1508.05561</a>&gt;, Marcon et al. (2016) &lt;<a href="https://doi.org/10.1214%2F16-EJS1162">doi:10.1214/16-EJS1162</a>&gt;, Marcon et al. (2017) &lt;<a href="https://doi.org/10.1002%2Fsta4.145">doi:10.1002/sta4.145</a>&gt;, Marcon et al. (2017) &lt;<a href="https://doi.org/10.1016%2Fj.jspi.2016.10.004">doi:10.1016/j.jspi.2016.10.004</a>&gt; and Beranger et al. (2021) &lt;<a href="https://doi.org/10.1007%2Fs10687-019-00364-0">doi:10.1007/s10687-019-00364-0</a>&gt;. This package also allows for the modelling of spatial extremes using flexible max-stable processes. It provides simulation algorithms and fitting procedures relying on the Stephenson-Tawn likelihood as per Beranger at al. (2021) &lt;<a href="https://doi.org/10.1007%2Fs10687-020-00376-1">doi:10.1007/s10687-020-00376-1</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Repository/R-Forge/Project:</td>
<td>extremaldep</td>
</tr>
<tr>
<td>Repository/R-Forge/Revision:</td>
<td>107</td>
</tr>
<tr>
<td>Repository/R-Forge/DateTimeStamp:</td>
<td>2019-08-12 22:22:37</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-09-25 18:20:11 UTC</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-09-22 13:07:14 UTC; padoan</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://faculty.unibocconi.it/simonepadoan/">https://faculty.unibocconi.it/simonepadoan/</a></td>
</tr>
</table>
<hr>
<h2 id='angular'>Estimation of the angular density, angular measure and random generation from the angular distribution.</h2><span id='topic+angular'></span>

<h3>Description</h3>

<p>Empirical estimation to the Pickands dependence function, the angular density, the angular measure and random generation of samples from the estimated angular density.</p>


<h3>Usage</h3>

<pre><code class='language-R'>angular(data, model, n, dep, asy, alpha, beta, df, seed, k, nsim, plot=TRUE, nw=100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="angular_+3A_data">data</code></td>
<td>
<p>The dataset in vector form</p>
</td></tr>
<tr><td><code id="angular_+3A_model">model</code></td>
<td>
<p>The specified model; a character string. Must be either <code>"log"</code>, <code>"alog"</code>, <code>"hr"</code>, <code>"neglog"</code>, <code>"aneglog"</code>, <code>"bilog"</code>, <code>"negbilog"</code>, <code>"ct"</code>, <code>"amix"</code> or <code>"Extremalt"</code> for the logistic, asymmetric logistic, Husler-Reiss, negative logistic, asymmetric negative logistic, bilogistic, negative bilogistic, Coles-Tawn, asymetric mixed and Extremal-t models respectively.</p>
</td></tr>
<tr><td><code id="angular_+3A_n">n</code></td>
<td>
<p>The number of random generations from the <code>model</code>. Required if <code>data=NULL</code>.</p>
</td></tr>
<tr><td><code id="angular_+3A_dep">dep</code></td>
<td>
<p>The dependence parameter for the <code>model</code>.</p>
</td></tr>
<tr><td><code id="angular_+3A_asy">asy</code></td>
<td>
<p>A vector of length two, containing the two asymmetry parameters for the asymmetric logistic (<code>model='alog'</code>) and asymmetric negative logistic models (<code>model='aneglog'</code>).</p>
</td></tr>
<tr><td><code id="angular_+3A_alpha">alpha</code>, <code id="angular_+3A_beta">beta</code></td>
<td>
<p>Alpha and beta parameters for the bilogistic, negative logistic, Coles-Tawn and asymmetric mixed models.</p>
</td></tr>
<tr><td><code id="angular_+3A_df">df</code></td>
<td>
<p>The degree of freedom for the extremal-t model.</p>
</td></tr>
<tr><td><code id="angular_+3A_seed">seed</code></td>
<td>
<p>The seed for the data generation. Required if <code>data=NULL</code>.</p>
</td></tr>
<tr><td><code id="angular_+3A_k">k</code></td>
<td>
<p>The polynomial order.</p>
</td></tr>
<tr><td><code id="angular_+3A_nsim">nsim</code></td>
<td>
<p>The number of generations from the estimated angular density.</p>
</td></tr>
<tr><td><code id="angular_+3A_plot">plot</code></td>
<td>
<p>If <code>TRUE</code>, the fitted angular density, histogram of the generated observations from the angular density and the true angular density (if <code>model</code> is specified) are displayed.</p>
</td></tr>
<tr><td><code id="angular_+3A_nw">nw</code></td>
<td>
<p>The number of points at which the estimated functions are evaluated</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Marcon et al. (2017).
</p>


<h3>Value</h3>

<p>Returns a list which contains <code>model</code>, <code>n</code>, <code>dep</code>, <code>data</code>, <code>Aest</code> the estimated pickands dependence function, <code>hest</code> the estimated angular density, <code>Hest</code> the estimated angular measure, <code>p0</code> and <code>p1</code> the point masses at the edge of the simplex, <code>wsim</code> the simulated sample from the angular density and <code>Atrue</code> and <code>htrue</code> the true Pickand dependence function and angular density (if <code>model</code> is specified).
</p>


<h3>Author(s)</h3>

<p>Simone Padoan, <a href="mailto:simone.padoan@unibocconi.it">simone.padoan@unibocconi.it</a>,
<a href="https://faculty.unibocconi.it/simonepadoan/">https://faculty.unibocconi.it/simonepadoan/</a>;
Boris Beranger, <a href="mailto:borisberanger@gmail.com">borisberanger@gmail.com</a>
<a href="https://www.borisberanger.com">https://www.borisberanger.com</a>;
Giulia Marcon, <a href="mailto:giuliamarcongm@gmail.com">giuliamarcongm@gmail.com</a>
</p>


<h3>References</h3>

<p>Marcon, G., Naveau, P. and Padoan, S. A. (2017).
A semi-parametric stochastic generator for bivariate extreme events,
<em>Stat 6</em>(1), 184&ndash;201.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>################################################
# The following examples provide the left panels
# of Figure 1, 2 &amp; 3 of Marcon et al. (2017).
################################################

## Figure 1 - symmetric logistic


# Strong dependence
a &lt;- angular(model='log', n=50, dep=0.3, seed=4321, k=20, nsim=10000)
# Mild dependence
b &lt;- angular(model='log', n=50, dep=0.6, seed=212, k=10, nsim=10000)
# Weak dependence
c &lt;- angular(model='log', n=50, dep=0.9, seed=4334, k=6, nsim=10000)


## Figure 2 - Asymmetric logistic


# Strong dependence
d &lt;- angular(model='alog', n=25, dep=0.3, asy=c(.3,.8), seed=43121465, k=20, nsim=10000)
# Mild dependence
e &lt;- angular(model='alog', n=25, dep=0.6, asy=c(.3,.8), seed=1890, k=10, nsim=10000)
# Weak dependence
f &lt;- angular(model='alog', n=25, dep=0.9, asy=c(.3,.8), seed=2043, k=5, nsim=10000)


</code></pre>

<hr>
<h2 id='beed'>Bernstein Polynomials Based Estimation of Extremal Dependence</h2><span id='topic+beed'></span>

<h3>Description</h3>

<p>Estimates the Pickands dependence function corresponding to multivariate data on the basis of a Bernstein polynomials approximation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>beed(data, x, d = 3, est = c("ht","cfg","md","pick"),
     margin = c("emp","est","exp","frechet","gumbel"),
     k = 13, y = NULL, beta = NULL, plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="beed_+3A_data">data</code></td>
<td>
<p><code class="reqn">(n \times d)</code> matrix of component-wise maxima. <code>d</code> is the number of variables and <code>n</code> is the number of replications.</p>
</td></tr>
<tr><td><code id="beed_+3A_x">x</code></td>
<td>
<p><code class="reqn">(m \times d)</code> design matrix where the dependence
function is evaluated (see <b>Details</b>).</p>
</td></tr>
<tr><td><code id="beed_+3A_d">d</code></td>
<td>
<p>positive integer greater than or equal to two indicating the number of variables (<code>d = 3</code> by default).</p>
</td></tr>
<tr><td><code id="beed_+3A_est">est</code></td>
<td>
<p>string, indicating the estimation method (<code>est="md"</code> by default, see <b>Details</b>).</p>
</td></tr>
<tr><td><code id="beed_+3A_margin">margin</code></td>
<td>
<p>string, denoting the type marginal distributions (<code>margin="emp"</code> by default, see <b>Details</b>).</p>
</td></tr>
<tr><td><code id="beed_+3A_k">k</code></td>
<td>
<p>postive integer, indicating the order of Bernstein
polynomials (<code>k=13</code> by default).</p>
</td></tr>
<tr><td><code id="beed_+3A_y">y</code></td>
<td>
<p>numeric vector (of size <code>m</code>) with an initial estimate of the Pickands function. If <code>NULL</code>, the initial estimate is computed using the estimation method denoted in <code>est</code>.</p>
</td></tr>
<tr><td><code id="beed_+3A_beta">beta</code></td>
<td>
<p>vector of polynomial coefficients (see <b>Details</b>).</p>
</td></tr>
<tr><td><code id="beed_+3A_plot">plot</code></td>
<td>
<p>logical; if <code>TRUE</code> and <code>d&lt;=3</code>, the estimated Pickands dependence function is plotted (<code>FALSE</code> by default).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The routine returns an estimate of the Pickands dependence function using the Bernstein polynomials approximation
proposed in Marcon et al. (2017).
The method is based on a preliminary empirical estimate of the Pickands dependence function.
If you do not provide such an estimate, this is computed by the routine. In this case, you can select one of the empirical methods
available. <code>est = 'ht'</code> refers to the Hall-Tajvidi estimator (Hall and Tajvidi 2000).
With <code>est = 'cfg'</code> the method proposed by Caperaa et al. (1997) is considered. Note that in the multivariate case the adjusted  version of Gudendorf and Segers (2011) is used. Finally, with <code>est = 'md'</code> the estimate is based on the madogram defined in Marcon et al. (2017).
</p>
<p>Each row of the <code class="reqn">(m \times d)</code> design matrix <code>x</code> is a point in the unit <code>d</code>-dimensional simplex,
</p>
<p><code class="reqn">
S_d := \left\{ (w_1,\ldots, w_d) \in [0,1]^{d}: \sum_{i=1}^{d} w_i = 1 \right\}.
</code>
</p>
<p>With this &quot;regularization&quot;&quot; method, the final estimate satisfies the neccessary conditions in order to be a Pickands dependence function.
</p>
<p><code class="reqn">A(\bold{w}) = \sum_{\bold{\alpha} \in \Gamma_k} \beta_{\bold{\alpha}} b_{\bold{\alpha}} (\bold{w};k).</code>
</p>
<p>The estimates are obtained by solving an optimization quadratic problem subject to the constraints. The latter are represented
by the following conditions:
<code class="reqn">A(e_i)=1; \max(w_i)\leq A(w) \leq 1; \forall i=1,\ldots,d;</code> (convexity).
</p>
<p>The order of polynomial <code>k</code> controls the smoothness of the estimate. The higher <code>k</code> is, the smoother the final estimate is.
Higher values are better with strong dependence (e. g. <code>k = 23</code>), whereas small values (e.g. <code>k = 6</code> or <code>k = 10</code>) are enough with mild or weak dependence.
</p>
<p>An empirical transformation of the marginals is performed when <code>margin="emp"</code>. A max-likelihood fitting of the GEV distributions is implemented when <code>margin="est"</code>. Otherwise it refers to marginal parametric GEV theorethical distributions (<code>margin = "exp", "frechet", "gumbel"</code>).
</p>


<h3>Value</h3>

<table>
<tr><td><code>beta</code></td>
<td>
<p>vector of polynomial coefficients</p>
</td></tr>
<tr><td><code>A</code></td>
<td>
<p>numeric vector of the estimated Pickands dependence function <code class="reqn">A</code></p>
</td></tr>
<tr><td><code>Anonconvex</code></td>
<td>
<p>preliminary non-convex function</p>
</td></tr>
<tr><td><code>extind</code></td>
<td>
<p>extremal index</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The number of coefficients depends on both the order of polynomial <code>k</code> and the dimension <code>d</code>. The number of parameters is explained in Marcon et al. (2017).
</p>
<p>The size of the vector <code>beta</code> must be compatible with the polynomial order <code>k</code> chosen.
</p>
<p>With the estimated polynomial coefficients, the extremal coefficient, i.e. <code class="reqn">d*A(1/d,\ldots,1/d)</code> is computed.
</p>


<h3>Author(s)</h3>

<p>Simone Padoan, <a href="mailto:simone.padoan@unibocconi.it">simone.padoan@unibocconi.it</a>,
<a href="https://faculty.unibocconi.it/simonepadoan/">https://faculty.unibocconi.it/simonepadoan/</a>;
Boris Beranger, <a href="mailto:borisberanger@gmail.com">borisberanger@gmail.com</a>
<a href="https://www.borisberanger.com">https://www.borisberanger.com</a>;
Giulia Marcon, <a href="mailto:giuliamarcongm@gmail.com">giuliamarcongm@gmail.com</a>
</p>


<h3>References</h3>

<p>Marcon, G., Padoan, S.A., Naveau, P., Muliere, P. and Segers, J. (2017)
Multivariate Nonparametric Estimation of the Pickands Dependence
Function using Bernstein Polynomials.
<em>Journal of Statistical Planning and Inference</em>, <b>183</b>, 1-17.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+beed.confband">beed.confband</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>
x &lt;- simplex(2)
data &lt;- evd::rbvevd(50, dep = 0.4, model = "log", mar1 = c(1,1,1))

Amd &lt;- beed(data, x, 2, "md", "emp", 20, plot=TRUE)
Acfg &lt;- beed(data, x, 2, "cfg", "emp", 20)
Aht &lt;- beed(data, x, 2, "ht", "emp", 20)

lines(x[,1], Aht$A, lty = 1, col = 3)
lines(x[,1], Acfg$A, lty = 1, col = 2)

##################################
# Trivariate case
##################################


x &lt;- simplex(3)

data &lt;- evd::rmvevd(50, dep = 0.8, model = "log", d = 3, mar = c(1,1,1))

op &lt;- par(mfrow=c(1,3))
Amd &lt;- beed(data, x, 3, "md", "emp", 18, plot=TRUE)
Acfg &lt;- beed(data, x, 3, "cfg", "emp", 18, plot=TRUE)
Aht &lt;- beed(data, x, 3, "ht", "emp", 18, plot=TRUE)

par(op)


</code></pre>

<hr>
<h2 id='beed.boot'>Bootstrap Resampling and Bernstein Estimation of Extremal Dependence</h2><span id='topic+beed.boot'></span>

<h3>Description</h3>

<p>Computes <code>nboot</code> estimates of the Pickands dependence function for multivariate data (using the Bernstein polynomials approximation method) on the basis of the bootstrap resampling of the data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  beed.boot(data, x, d = 3, est = c("ht","md","cfg","pick"),
     margin=c("emp", "est", "exp", "frechet", "gumbel"), k = 13,
     nboot = 500, y = NULL, print = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="beed.boot_+3A_data">data</code></td>
<td>
<p><code class="reqn">n \times d</code> matrix of component-wise maxima.</p>
</td></tr>
<tr><td><code id="beed.boot_+3A_x">x</code></td>
<td>
<p><code class="reqn">m \times d</code> design matrix where the dependence function is evaluated, see <b>Details</b>.</p>
</td></tr>
<tr><td><code id="beed.boot_+3A_d">d</code></td>
<td>
<p>postive integer (greater than or equal to two) indicating the number of variables (<code>d=3</code> by default).</p>
</td></tr>
<tr><td><code id="beed.boot_+3A_est">est</code></td>
<td>
<p>string denoting the preliminary estimation method (see <b>Details</b>).</p>
</td></tr>
<tr><td><code id="beed.boot_+3A_margin">margin</code></td>
<td>
<p>string denoting the type marginal distributions (see <b>Details</b>).</p>
</td></tr>
<tr><td><code id="beed.boot_+3A_k">k</code></td>
<td>
<p>postive integer denoting the order of the Bernstein polynomial (<code>k=13</code> by default).</p>
</td></tr>
<tr><td><code id="beed.boot_+3A_nboot">nboot</code></td>
<td>
<p>postive integer indicating the number of bootstrap replicates (<code>nboot=500</code> by default).</p>
</td></tr>
<tr><td><code id="beed.boot_+3A_y">y</code></td>
<td>
<p>numeric vector (of size <code>m</code>) with an initial estimate of the Pickands function. If <code>NULL</code>, The initial estimation is performed by using the estimation method chosen in <code>est</code>.</p>
</td></tr>
<tr><td><code id="beed.boot_+3A_print">print</code></td>
<td>
<p>logical; <code>FALSE</code> by default. If <code>TRUE</code> the number of the iteration is printed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Standard bootstrap is performed, in particular estimates of the Pickands dependence function are provided for each data resampling.
</p>
<p>Most of the settings are the same as in the function <code><a href="#topic+beed">beed</a></code>.
</p>
<p>An empirical transformation of the marginals is performed when <code>margin="emp"</code>. A max-likelihood fitting of the GEV distributions is implemented when <code>margin="est"</code>. Otherwise it refers to marginal parametric GEV theorethical distributions (<code>margin = "exp", "frechet", "gumbel"</code>).
</p>


<h3>Value</h3>

<table>
<tr><td><code>A</code></td>
<td>
<p>numeric vector of the estimated Pickands dependence function.</p>
</td></tr>
<tr><td><code>bootA</code></td>
<td>
<p>matrix with <code>nboot</code> columns that reports the estimates of the Pickands function for each data resampling.</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>matrix of estimated polynomial coefficients. Each column corresponds to a data resampling.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Simone Padoan, <a href="mailto:simone.padoan@unibocconi.it">simone.padoan@unibocconi.it</a>,
<a href="https://faculty.unibocconi.it/simonepadoan/">https://faculty.unibocconi.it/simonepadoan/</a>;
Boris Beranger, <a href="mailto:borisberanger@gmail.com">borisberanger@gmail.com</a>
<a href="https://www.borisberanger.com">https://www.borisberanger.com</a>;
Giulia Marcon, <a href="mailto:giuliamarcongm@gmail.com">giuliamarcongm@gmail.com</a>
</p>


<h3>References</h3>

<p>Marcon, G., Padoan, S.A., Naveau, P., Muliere, P. and Segers, J. (2017)
Multivariate Nonparametric Estimation of the Pickands Dependence
Function using Bernstein Polynomials.
<em>Journal of Statistical Planning and Inference</em>, 183, 1-17.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+beed">beed</a></code>, <code><a href="#topic+beed.confband">beed.confband</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>
x &lt;- simplex(2)
data &lt;- evd::rbvevd(50, dep = 0.4, model = "log", mar1 = c(1,1,1))

boot &lt;- beed.boot(data, x, 2, "md", "emp", 20, 500)

</code></pre>

<hr>
<h2 id='beed.confband'>Nonparametric Bootstrap Confidence Intervals</h2><span id='topic+beed.confband'></span>

<h3>Description</h3>

<p>Computes nonparametric bootstrap <code class="reqn">(1-\alpha)\%</code> confidence bands for the Pickands dependence function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  beed.confband(data, x, d = 3, est = c("ht","md","cfg","pick"),
     margin=c("emp", "est", "exp", "frechet", "gumbel"), k = 13,
     nboot = 500, y = NULL, conf = 0.95, plot = FALSE, print = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="beed.confband_+3A_data">data</code></td>
<td>
<p><code class="reqn">(n \times d)</code> matrix of component-wise maxima.</p>
</td></tr>
<tr><td><code id="beed.confband_+3A_x">x</code></td>
<td>
<p><code class="reqn">(m \times d)</code> design matrix (see <b>Details</b>).</p>
</td></tr>
<tr><td><code id="beed.confband_+3A_d">d</code></td>
<td>
<p>postive integer (greater than or equal to two) indicating the number of variables (<code>d=3</code> by default).</p>
</td></tr>
<tr><td><code id="beed.confband_+3A_est">est</code></td>
<td>
<p>string denoting the estimation method (see <b>Details</b>).</p>
</td></tr>
<tr><td><code id="beed.confband_+3A_margin">margin</code></td>
<td>
<p>string denoting the type marginal distributions (see <b>Details</b>).</p>
</td></tr>
<tr><td><code id="beed.confband_+3A_k">k</code></td>
<td>
<p>postive integer denoting the order of the Bernstein polynomial (<code>k=13</code> by default).</p>
</td></tr>
<tr><td><code id="beed.confband_+3A_nboot">nboot</code></td>
<td>
<p>postive integer indicating the number of bootstrap replicates.</p>
</td></tr>
<tr><td><code id="beed.confband_+3A_y">y</code></td>
<td>
<p>numeric vector (of size <code>m</code>) with an initial estimate of the Pickands function. If <code>NULL</code>, the initial estimation is performed by using the estimation method chosen in <code>est</code>.</p>
</td></tr>
<tr><td><code id="beed.confband_+3A_conf">conf</code></td>
<td>
<p>real value in <code class="reqn">(0,1)</code> denoting the confidence level of the interval. The value <code>conf=0.95</code> is the default.</p>
</td></tr>
<tr><td><code id="beed.confband_+3A_plot">plot</code></td>
<td>
<p>logical; <code>FALSE</code> by default. If <code>TRUE</code>, the confidence bands are plotted.</p>
</td></tr>
<tr><td><code id="beed.confband_+3A_print">print</code></td>
<td>
<p>logical; <code>FALSE</code> by default. If <code>TRUE</code>, the number of the iteration is printed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Two methods for computing bootstrap <code class="reqn">(1-\alpha)\%</code> point-wise and simultaneous confidence bands for the Pickands dependence function are used.
</p>
<p>The first method derives the confidence bands computing the point-wise <code class="reqn">\alpha/2</code> and <code class="reqn">1-\alpha/2</code> quantiles of the bootstrap sample distribution of the Pickands dependence Bernstein based estimator.
</p>
<p>The second method derives the confidence bands, first  computing the point-wise <code class="reqn">\alpha/2</code> and <code class="reqn">1-\alpha/2</code> quantiles of the bootstrap sample distribution of polynomial coefficient estimators, and then the Pickands dependence is computed using the Bernstein polynomial representation. See Marcon et al. (2017) for details.
</p>
<p>Most of the settings are the same as in the function <code><a href="#topic+beed">beed</a></code>.
</p>


<h3>Value</h3>

<table>
<tr><td><code>A</code></td>
<td>
<p>numeric vector of the Pickands dependence function estimated.</p>
</td></tr>
<tr><td><code>bootA</code></td>
<td>
<p>matrix with <code>nboot</code> columns that reports the estimates of the Pickands function for each data resampling.</p>
</td></tr>
<tr><td><code>A.up.beta/A.low.beta</code></td>
<td>
<p>vectors of upper and lower bands of the Pickands dependence function obtained using the bootstrap sampling distribution of the polynomial coefficients estimator.</p>
</td></tr>
<tr><td><code>A.up.pointwise/A.low.pointwise</code></td>
<td>
<p>vectors of upper and lower bands of the Pickands dependence function obtained using the bootstrap sampling distribution of the Pickands dependence function estimator.</p>
</td></tr>
<tr><td><code>up.beta/low.beta</code></td>
<td>
<p>vectors of upper and lower bounds of the bootstrap sampling distribution of the polynomial coefficients estimator.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This routine relies on the bootstrap routine (see <code><a href="#topic+beed.boot">beed.boot</a></code>).
</p>


<h3>Author(s)</h3>

<p>Simone Padoan, <a href="mailto:simone.padoan@unibocconi.it">simone.padoan@unibocconi.it</a>,
<a href="https://faculty.unibocconi.it/simonepadoan/">https://faculty.unibocconi.it/simonepadoan/</a>;
Boris Beranger, <a href="mailto:borisberanger@gmail.com">borisberanger@gmail.com</a>
<a href="https://www.borisberanger.com">https://www.borisberanger.com</a>;
Giulia Marcon, <a href="mailto:giuliamarcongm@gmail.com">giuliamarcongm@gmail.com</a>
</p>


<h3>References</h3>

<p>Marcon, G., Padoan, S.A., Naveau, P., Muliere, P. and Segers, J. (2017)
Multivariate Nonparametric Estimation of the Pickands Dependence
Function using Bernstein Polynomials.
<em>Journal of Statistical Planning and Inference</em>, 183, 1-17.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+beed">beed</a></code>, <code><a href="#topic+beed.boot">beed.boot</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>
x &lt;- simplex(2)
data &lt;- evd::rbvevd(50, dep = 0.4, model = "log", mar1 = c(1,1,1))

# Note you should consider 500 bootstrap replications.
# In order to obtain fastest results we used 50!
cb &lt;- beed.confband(data, x, 2, "md", "emp", 20, 50, plot=TRUE)

</code></pre>

<hr>
<h2 id='desn'>Univariate extended skew-normal distribution</h2><span id='topic+desn'></span><span id='topic+pesn'></span>

<h3>Description</h3>

<p>Density function, distribution function for the univariate extended skew-normal (<abbr><span class="acronym">ESN</span></abbr>) distribution.</p>


<h3>Usage</h3>

<pre><code class='language-R'>desn(x, location=0, scale=1, shape=0, extended=0)
pesn(x, location=0, scale=1, shape=0, extended=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="desn_+3A_x">x</code></td>
<td>
<p>quantile. </p>
</td></tr>
<tr><td><code id="desn_+3A_location">location</code></td>
<td>
<p>location parameter. <code>0</code> is the default.</p>
</td></tr>
<tr><td><code id="desn_+3A_scale">scale</code></td>
<td>
<p>scale parameter; must be positive. <code>1</code> is the default.</p>
</td></tr>
<tr><td><code id="desn_+3A_shape">shape</code></td>
<td>
<p>skewness parameter. <code>0</code> is the default.</p>
</td></tr>
<tr><td><code id="desn_+3A_extended">extended</code></td>
<td>
<p>extension parameter. <code>0</code> is the default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>density (<code>desn</code>), probability (<code>pesn</code>) from the extended skew-normal distribution with given
<code>location</code>, <code>scale</code>, <code>shape</code> and <code>extended</code> parameters or from the skew-normal if <code>extended=0</code>.
If <code>shape=0</code> and <code>extended=0</code> then the normal distribution is recovered.
</p>


<h3>Author(s)</h3>

<p>Simone Padoan, <a href="mailto:simone.padoan@unibocconi.it">simone.padoan@unibocconi.it</a>,
<a href="https://faculty.unibocconi.it/simonepadoan/">https://faculty.unibocconi.it/simonepadoan/</a>;
Boris Beranger, <a href="mailto:borisberanger@gmail.com">borisberanger@gmail.com</a>
<a href="https://www.borisberanger.com">https://www.borisberanger.com</a>;
</p>


<h3>References</h3>

<p>Azzalini, A. (1985).
A class of distributions which includes the normal ones.
<em>Scand. J. Statist.</em> <b>12</b>, 171-178.
</p>
<p>Azzalini, A. with the collaboration of Capitanio, A. (2014).
<em>The Skew-Normal and Related Families</em>.
Cambridge University Press, IMS Monographs series.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
dens1 &lt;- desn(x=1, shape=3, extended=2)
dens2 &lt;- desn(x=1, shape=3)
dens3 &lt;- desn(x=1)
dens4 &lt;- dnorm(x=1)
prob1 &lt;- pesn(x=1, shape=3, extended=2)
prob2 &lt;- pesn(x=1, shape=3)
prob3 &lt;- pesn(x=1)
prob4 &lt;- pnorm(q=1)

</code></pre>

<hr>
<h2 id='dest'>Univariate extended skew-t distribution</h2><span id='topic+dest'></span><span id='topic+pest'></span>

<h3>Description</h3>

<p>Density function, distribution function for the univariate extended skew-t (<abbr><span class="acronym">EST</span></abbr>) distribution.</p>


<h3>Usage</h3>

<pre><code class='language-R'>dest(x, location=0, scale=1, shape=0, extended=0, df=Inf)
pest(x, location=0, scale=1, shape=0, extended=0, df=Inf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dest_+3A_x">x</code></td>
<td>
<p>quantile. </p>
</td></tr>
<tr><td><code id="dest_+3A_location">location</code></td>
<td>
<p>location parameter. <code>0</code> is the default.</p>
</td></tr>
<tr><td><code id="dest_+3A_scale">scale</code></td>
<td>
<p>scale parameter; must be positive. <code>1</code> is the default.</p>
</td></tr>
<tr><td><code id="dest_+3A_shape">shape</code></td>
<td>
<p>skewness parameter. <code>0</code> is the default.</p>
</td></tr>
<tr><td><code id="dest_+3A_extended">extended</code></td>
<td>
<p>extension parameter. <code>0</code> is the default.</p>
</td></tr>
<tr><td><code id="dest_+3A_df">df</code></td>
<td>
<p>a single positive value representing the degrees of freedom;
it can be non-integer. Default value is <code>nu=Inf</code> which corresponds
to the skew-normal distribution.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>density (<code>dest</code>), probability (<code>pest</code>) from the extended skew-t distribution with given
<code>location</code>, <code>scale</code>, <code>shape</code>, <code>extended</code> and <code>df</code> parameters or from the skew-t if <code>extended=0</code>.
If <code>shape=0</code> and <code>extended=0</code> then the t distribution is recovered.
</p>


<h3>Author(s)</h3>

<p>Simone Padoan, <a href="mailto:simone.padoan@unibocconi.it">simone.padoan@unibocconi.it</a>,
<a href="https://faculty.unibocconi.it/simonepadoan/">https://faculty.unibocconi.it/simonepadoan/</a>;
Boris Beranger, <a href="mailto:borisberanger@gmail.com">borisberanger@gmail.com</a>
<a href="https://www.borisberanger.com">https://www.borisberanger.com</a>;
</p>


<h3>References</h3>

<p>Azzalini, A. and Capitanio, A. (2003).
Distributions generated by perturbation of symmetry
with emphasis on a multivariate skew-<em>t</em> distribution.
<em>J.Roy. Statist. Soc. B</em> <b>65</b>, 367&ndash;389.
</p>
<p>Azzalini, A. with the collaboration of Capitanio, A. (2014).
<em>The Skew-normal and Related Families</em>.
Cambridge University Press, IMS Monographs series.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
dens1 &lt;- dest(x=1, shape=3, extended=2, df=1)
dens2 &lt;- dest(x=1, shape=3, df=1)
dens3 &lt;- dest(x=1, df=1)
dens4 &lt;- dt(x=1, df=1)
prob1 &lt;- pest(x=1, shape=3, extended=2, df=1)
prob2 &lt;- pest(x=1, shape=3, df=1)
prob3 &lt;- pest(x=1, df=1)
prob4 &lt;- pt(q=1, df=1)

</code></pre>

<hr>
<h2 id='dExtDep'>Parametric and non-parametric density of Extremal Dependence</h2><span id='topic+dExtDep'></span>

<h3>Description</h3>

<p>This function calculates the density of parametric multivariate extreme distributions and corresponding angular density, or the non-parametric angular density represented through Bernstein polynomials.</p>


<h3>Usage</h3>

<pre><code class='language-R'>dExtDep(x, method="Parametric", model, par, angular=TRUE, log=FALSE, 
        c=NULL, vectorial=TRUE, mixture=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dExtDep_+3A_x">x</code></td>
<td>
<p>A vector or a matrix. The value at which the density is evaluated.</p>
</td></tr>
<tr><td><code id="dExtDep_+3A_method">method</code></td>
<td>
<p>A character string taking value <code>"Parametric"</code> or <code>"NonParametric"</code></p>
</td></tr>
<tr><td><code id="dExtDep_+3A_model">model</code></td>
<td>
<p>A string with the name of the model: <code>"PB"</code> (Pairwise Beta), <code>"HR"</code> (Husler-Reiss), <code>"ET"</code> (Extremal-t), <code>"EST"</code> (Extremal Skew-t), <code>TD</code> (Tilted Dirichlet) or <code>AL</code> (Asymmetric Logistic) when evaluating the angular density. Restricted to <code>"HR"</code>, <code>"ET"</code> and <code>"EST"</code> for multivariate extreme value densities. Required when <code>method="Parametric"</code>.</p>
</td></tr>
<tr><td><code id="dExtDep_+3A_par">par</code></td>
<td>
<p>A vector representing the parameters of the (parametric or non-parametric) model.</p>
</td></tr>
<tr><td><code id="dExtDep_+3A_angular">angular</code></td>
<td>
<p>A logical value specifying if the angular density is computed.</p>
</td></tr>
<tr><td><code id="dExtDep_+3A_log">log</code></td>
<td>
<p>A logical value specifying if the log density is computed.</p>
</td></tr>
<tr><td><code id="dExtDep_+3A_c">c</code></td>
<td>
<p>A real value in <code class="reqn">[0,1]</code>, providing the decision rule to allocate a data point to a subset of the simplex.
Only required for the parametric angular density of the Extremal-t, Extremal Skew-t and Asymmetric Logistic models.</p>
</td></tr>
<tr><td><code id="dExtDep_+3A_vectorial">vectorial</code></td>
<td>
<p>A logical value; if <code>TRUE</code> a vector of <code>nrow(x)</code> densities is returned. If <code>FALSE</code> the likelihood
function is returned (product of densities or sum if <code>log=TRUE</code>. <code>TRUE</code> is the default.</p>
</td></tr>
<tr><td><code id="dExtDep_+3A_mixture">mixture</code></td>
<td>
<p>A logical value specifying if the Bernstein polynomial representation of distribution should be expressed as a mixture. If <code>mixture=TRUE</code> the density integrates to 1. Required when <code>method="NonParametric"</code>. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that when <code>method="Parametric"</code> and <code>angular=FALSE</code>, the density is only available in 2 dimensions.
When <code>method="Parametric"</code> and <code>angular=TRUE</code>, the models <code>"AL"</code>, <code>"ET"</code> and <code>"EST"</code> are limited to 3 dimensions. This is because of the existence of mass on the subspaces on the simplex (and therefore the need to specify <code>c</code>).
</p>
<p>For the parametric models, the appropriate length of the parameter vector can be obtained from the <code>dim_ExtDep</code> function and are summarized as follows.
When <code>model="HR"</code>, the parameter vector is of length <code>choose(dim,2)</code>.
When <code>model="PB"</code> or <code>model="Extremalt"</code>, the parameter vector is of length <code>choose(dim,2) + 1</code>.
When <code>model="EST"</code>, the parameter vector is of length <code>choose(dim,2) + dim + 1</code>.
When <code>model="TD"</code>, the parameter vector is of length <code>dim</code>.
When <code>model="AL"</code>, the parameter vector is of length <code>2^(dim-1)*(dim+2) - (2*dim+1)</code>.
</p>


<h3>Value</h3>

<p>If <code>x</code> is a matrix and <code>vectorial=TRUE</code>, a vector of length <code>nrow(x)</code>, otherwise a scalar.   
</p>


<h3>Author(s)</h3>

<p>Simone Padoan, <a href="mailto:simone.padoan@unibocconi.it">simone.padoan@unibocconi.it</a>,
<a href="https://faculty.unibocconi.it/simonepadoan/">https://faculty.unibocconi.it/simonepadoan/</a>;
Boris Beranger, <a href="mailto:borisberanger@gmail.com">borisberanger@gmail.com</a>
<a href="https://www.borisberanger.com">https://www.borisberanger.com</a>;
</p>


<h3>References</h3>

<p>Beranger, B. and Padoan, S. A. (2015).
Extreme dependence models, chapater of the book <em>Extreme Value Modeling and Risk Analysis: Methods and Applications</em>,
<b>Chapman Hall/CRC</b>.
</p>
<p>Beranger, B., Padoan, S. A. and Sisson, S. A. (2017).
Models for extremal dependence derived from skew-symmetric families.
<em>Scandinavian Journal of Statistics</em>, <b>44</b>(1), 21-45.
</p>
<p>Coles, S. G., and Tawn, J. A. (1991),
Modelling Extreme Multivariate Events,
<em>Journal of the Royal Statistical Society, Series B (Methodological)</em>, <b>53</b>, 377&ndash;392.
</p>
<p>Cooley, D.,Davis, R. A., and Naveau, P. (2010).
The pairwise beta distribution: a flexible parametric multivariate model for extremes.
<em>Journal of Multivariate Analysis</em>, <b>101</b>, 2103&ndash;2117.
</p>
<p>Engelke, S., Malinowski, A., Kabluchko, Z., and Schlather, M. (2015),
Estimation of Husler-Reiss distributions and Brown-Resnick processes,
<em>Journal of the Royal Statistical Society, Series B (Methodological)</em>, <b>77</b>, 239&ndash;265.
</p>
<p>Husler, J. and Reiss, R.-D. (1989),
Maxima of normal random vectors: between independence and complete dependence,
<em>Statistics and Probability Letters</em>, <b>7</b>, 283&ndash;286.
</p>
<p>Marcon, G., Padoan, S.A., Naveau, P., Muliere, P. and Segers, J. (2017)
Multivariate Nonparametric Estimation of the Pickands Dependence
Function using Bernstein Polynomials.
<em>Journal of Statistical Planning and Inference</em>, <b>183</b>, 1-17.
</p>
<p>Nikoloulopoulos, A. K., Joe, H., and Li, H. (2009)
Extreme value properties of t copulas.
<em>Extremes</em>, <b>12</b>, 129&ndash;148.
</p>
<p>Opitz, T. (2013)
Extremal t processes: Elliptical domain of attraction and a spectral representation.
<em>Jounal of Multivariate Analysis</em>, <b>122</b>, 409&ndash;413.
</p>
<p>Tawn, J. A. (1990),
Modelling Multivariate Extreme Value Distributions,
<em>Biometrika</em>, <b>77</b>, 245&ndash;253.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pExtDep">pExtDep</a></code>, <code><a href="#topic+rExtDep">rExtDep</a></code>, <code><a href="#topic+fExtDep">fExtDep</a></code>, <code><a href="#topic+fExtDep.np">fExtDep.np</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example of PB on the 4-dimensional simplex
dExtDep(x=rbind(c(0.1,0.3,0.3,0.3),c(0.1,0.2,0.3,0.4)), method="Parametric", 
        model="PB", par=c(2,2,2,1,0.5,3,4), log=FALSE)

# Example of EST in 2 dimensions
dExtDep(x=c(1.2,2.3), method="Parametric", model="EST", par=c(0.6,1,2,3), angular=FALSE, log=TRUE)

# Example of non-parametric angular density
beta &lt;- c(1.0000000, 0.8714286, 0.7671560, 0.7569398, 
          0.7771908, 0.8031573, 0.8857143, 1.0000000)
dExtDep(x=rbind(c(0.1,0.9),c(0.2,0.8)), method="NonParametric", par=beta)

</code></pre>

<hr>
<h2 id='dGEV'>The Generalized Extreme Value Distribution</h2><span id='topic+dGEV'></span><span id='topic+pGEV'></span><span id='topic+qGEV'></span>

<h3>Description</h3>

<p>Density, distribution and quantile function for the Generalized Extreme Value (<abbr><span class="acronym">GEV</span></abbr>) distribution.</p>


<h3>Usage</h3>

<pre><code class='language-R'>dGEV(x, loc, scale, shape, log=FALSE)
pGEV(q, loc, scale, shape, lower.tail=TRUE)
qGEV(p, loc, scale, shape)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dGEV_+3A_x">x</code>, <code id="dGEV_+3A_q">q</code></td>
<td>
<p>vector of quantiles. </p>
</td></tr>
<tr><td><code id="dGEV_+3A_p">p</code></td>
<td>
<p>vector of probabilities.</p>
</td></tr>
<tr><td><code id="dGEV_+3A_loc">loc</code></td>
<td>
<p>vector of locations.</p>
</td></tr>
<tr><td><code id="dGEV_+3A_scale">scale</code></td>
<td>
<p>vector of scales.</p>
</td></tr>
<tr><td><code id="dGEV_+3A_shape">shape</code></td>
<td>
<p>vector of shapes.</p>
</td></tr>
<tr><td><code id="dGEV_+3A_log">log</code></td>
<td>
<p>A logical value; if <code>TRUE</code> returns the log density.</p>
</td></tr>
<tr><td><code id="dGEV_+3A_lower.tail">lower.tail</code></td>
<td>
<p>A logical value; if <code>TRUE</code> probabilities are <code class="reqn">P\left(X \leq x \right)</code>, otherwise <code class="reqn">P\left(X &gt; x \right)</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The GEV distribution has density
</p>
<p style="text-align: center;"><code class="reqn">f(x; \mu, \sigma, \xi) = \exp \left\{ -\left[ 1 + \xi \left( \frac{x-\mu}{\sigma} \right)\right]_+^{-1/\xi}\right\}</code>
</p>



<h3>Value</h3>

<p>density (<code>dGEV</code>), distribution function (<code>pGEV</code>) and quantile function (<code>qGEV</code>) from the Generalized Extreme Value distirbution with given
<code>location</code>, <code>scale</code> and <code>shape</code>.
</p>


<h3>Author(s)</h3>

<p>Simone Padoan, <a href="mailto:simone.padoan@unibocconi.it">simone.padoan@unibocconi.it</a>,
<a href="https://faculty.unibocconi.it/simonepadoan/">https://faculty.unibocconi.it/simonepadoan/</a>;
Boris Beranger, <a href="mailto:borisberanger@gmail.com">borisberanger@gmail.com</a>
<a href="https://www.borisberanger.com">https://www.borisberanger.com</a>;
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+fGEV">fGEV</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'># Densities
dGEV(x=1, loc=1, scale=1, shape=1)
dGEV(x=c(0.2, 0.5), loc=1, scale=1, shape=c(0,0.3))

# Probabilities
pGEV(q=1, loc=1, scale=1, shape=1, lower.tail=FALSE)
pGEV(q=c(0.2, 0.5), loc=1, scale=1, shape=c(0,0.3))

# Quantiles
qGEV(p=0.5, loc=1, scale=1, shape=1)
qGEV(p=c(0.2, 0.5), loc=1, scale=1, shape=c(0,0.3))
</code></pre>

<hr>
<h2 id='diagnostics'>Diagnostics plots for MCMC algorithm.</h2><span id='topic+diagnostics'></span>

<h3>Description</h3>

<p>This function displays traceplots of the scaling parameter from the proposal distribution of the adaptive MCMC scheme and the associated acceptance probability.</p>


<h3>Usage</h3>

<pre><code class='language-R'>diagnostics(mcmc)    
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="diagnostics_+3A_mcmc">mcmc</code></td>
<td>
<p>An output of the <code><a href="#topic+fGEV">fGEV</a></code> or <code><a href="#topic+fExtDep.np">fExtDep.np</a></code> function with <code>method="Bayesian"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When <code>mcmc</code> is the output of <code><a href="#topic+fGEV">fGEV</a></code> then this corresponds to a marginal estimation and therefore <code>diagnostics</code> will  display in a first plot the value of <code class="reqn">\tau</code> the scaling parameter in the multivariate normal proposal which directly affects the acceptance rate of the proposal parameter values that are displayed in the second plot.
</p>
<p>When <code>mcmc</code> is the output of <code><a href="#topic+fExtDep.np">fExtDep.np</a></code>, then this corresponds to an estimation of the dependence structure following the procedure given in Algorithm 1 of Beranger et al. (2021). If the margins are jointly estimated with the dependence (step 1 and 2 of the algorithm) then <code>diagnostics</code> provides trace plots of the corresponding scaling parameters (<code class="reqn">\tau_1,\tau_2</code>) and acceptance probabilities. For the dependence structure (step 3 of the algorithm), a trace plot of the polynomial order <code class="reqn">\kappa</code> is given with the associated acceptance probability.
</p>


<h3>Value</h3>

<p>a graph of traceplots of the scaling parameter from the proposal distribution of the adaptive MCMC scheme and the associated acceptance probability.
</p>


<h3>Author(s)</h3>

<p>Simone Padoan, <a href="mailto:simone.padoan@unibocconi.it">simone.padoan@unibocconi.it</a>,
<a href="https://faculty.unibocconi.it/simonepadoan/">https://faculty.unibocconi.it/simonepadoan/</a>;
Boris Beranger, <a href="mailto:borisberanger@gmail.com">borisberanger@gmail.com</a>
<a href="https://www.borisberanger.com">https://www.borisberanger.com</a>;
Giulia Marcon, <a href="mailto:giuliamarcongm@gmail.com">giuliamarcongm@gmail.com</a>
</p>


<h3>References</h3>

<p>Beranger, B., Padoan, S. A. and Sisson, S. A. (2021).
Estimation and uncertainty quantification for extreme quantile regions.
<em>Extremes</em>, <b>24</b>, 349-375.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fExtDep.np">fExtDep.np</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>
##################################################
### Example - Pollution levels in Milan, Italy ###
##################################################
	
## Not run: 

### Here we will only model the dependence structure	
data(MilanPollution)

data &lt;- Milan.winter[,c("NO2","SO2")] 
data &lt;- as.matrix(data[complete.cases(data),])

# Thereshold
u &lt;- apply(data, 2, function(x) quantile(x, prob=0.9, type=3))

# Hyperparameters
hyperparam &lt;- list(mu.nbinom = 6, var.nbinom = 8, a.unif=0, b.unif=0.2)

### Standardise data to univariate Frechet margins

f1 &lt;- fGEV(data=data[,1], method="Bayesian", sig0 = 0.1, nsim = 5e+4)
diagnostics(f1)
burn1 &lt;- 1:30000
gev.pars1 &lt;- apply(f1$param_post[-burn1,],2,mean)
sdata1 &lt;- trans2UFrechet(data=data[,1], pars=gev.pars1, type="GEV")

f2 &lt;- fGEV(data=data[,2], method="Bayesian", sig0 = 0.1, nsim = 5e+4)
diagnostics(f2)
burn2 &lt;- 1:30000
gev.pars2 &lt;- apply(f2$param_post[-burn2,],2,mean)
sdata2 &lt;- trans2UFrechet(data=data[,2], pars=gev.pars2, type="GEV")

sdata &lt;- cbind(sdata1,sdata2)

### Bayesian estimation using Bernstein polynomials

pollut1 &lt;- fExtDep.np(method="Bayesian", data=sdata, u=TRUE,
                      mar.fit=FALSE, k0=5, hyperparam = hyperparam, nsim=5e+4)

diagnostics(pollut1)


## End(Not run)
	
</code></pre>

<hr>
<h2 id='dim_ExtDep'>Dimensions calculations for parametric extremal dependence models</h2><span id='topic+dim_ExtDep'></span>

<h3>Description</h3>

<p>This function calculates the dimensions of an extremal dependence model for a given set of parameters, the dimension of the parameter vector for a given dimension and verifies the adequacy between model dimension and length of parameter vector when both are provided.</p>


<h3>Usage</h3>

<pre><code class='language-R'>dim_ExtDep(model, par=NULL, dim=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dim_ExtDep_+3A_model">model</code></td>
<td>
<p>A string with the name of the model: <code>"PB"</code> (Pairwise Beta), <code>"HR"</code> (Husler-Reiss), <code>"ET"</code> (Extremal-t), <code>"EST"</code> (Extremal Skew-t), <code>TD</code> (Tilted Dirichlet) or <code>AL</code> (Asymmetric Logistic). </p>
</td></tr>
<tr><td><code id="dim_ExtDep_+3A_par">par</code></td>
<td>
<p>A vector representing the parameters of the model.</p>
</td></tr>
<tr><td><code id="dim_ExtDep_+3A_dim">dim</code></td>
<td>
<p>An integer representing the dimension of the model. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>One of <code>par</code> or <code>dim</code> need to be provided.
If <code>par</code> is provided, the dimension of the model is calculated.
If <code>dim</code> is provided, the length of the parameter vector is calculated.
If both <code>par</code> and <code>dim</code> are provided, the adequacy between the dimension of the model and the length of the parameter vector is checked.
</p>
<p>For <code>model="HR"</code>, the parameter vector is of length <code>choose(dim,2)</code>.
For <code>model="PB"</code> or <code>model="Extremalt"</code>, the parameter vector is of length <code>choose(dim,2) + 1</code>.
For <code>model="EST"</code>, the parameter vector is of length <code>choose(dim,2) + dim + 1</code>.
For <code>model="TD"</code>, the parameter vector is of length <code>dim</code>.
For <code>model="AL"</code>, the parameter vector is of length <code>2^(dim-1)*(dim+2) - (2*dim+1)</code>.
</p>


<h3>Value</h3>

<p>If <code>par</code> is not provided and <code>dim</code> is provided: returns an integer indicating the length of the parameter vector.
If <code>par</code> is provided and <code>dim</code> is not provided: returns an integer indicating the dimension of the model.
If <code>par</code> and <code>dim</code> are provided: returns a <code>TRUE/FALSE</code>statement indicating whether the length of the parameter and the dimension match.
</p>


<h3>Author(s)</h3>

<p>Simone Padoan, <a href="mailto:simone.padoan@unibocconi.it">simone.padoan@unibocconi.it</a>,
<a href="https://faculty.unibocconi.it/simonepadoan/">https://faculty.unibocconi.it/simonepadoan/</a>;
Boris Beranger, <a href="mailto:borisberanger@gmail.com">borisberanger@gmail.com</a>
<a href="https://www.borisberanger.com">https://www.borisberanger.com</a>;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  dim_ExtDep(model="EST", dim=3)
  dim_ExtDep(model="AL", dim=3)
  
  dim_ExtDep(model="PB", par=rep(0.5,choose(4,2)+1) )
  dim_ExtDep(model="TD", par=rep(1,5) )
  
  dim_ExtDep(model="EST", dim=2, par=c(0.5,1,1,1) )
  dim_ExtDep(model="PB", dim=4, par=rep(0.5,choose(4,2)+1) )
</code></pre>

<hr>
<h2 id='dmesn'>Bivariate and trivariate extended skew-normal distribution</h2><span id='topic+dmesn'></span><span id='topic+pmesn'></span>

<h3>Description</h3>

<p>Density function, distribution function for the bivariate and trivariate extended skew-normal (<abbr><span class="acronym">ESN</span></abbr>) distribution.</p>


<h3>Usage</h3>

<pre><code class='language-R'>dmesn(x=c(0,0), location=rep(0, length(x)), scale=diag(length(x)),
      shape=rep(0,length(x)), extended=0)
pmesn(x=c(0,0), location=rep(0, length(x)), scale=diag(length(x)),
      shape=rep(0,length(x)), extended=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dmesn_+3A_x">x</code></td>
<td>
<p> quantile vector of length <code>d=2</code> or <code>d=3</code>. </p>
</td></tr>
<tr><td><code id="dmesn_+3A_location">location</code></td>
<td>
<p>a numeric location vector of length <code>d</code>. <code>0</code> is the default.</p>
</td></tr>
<tr><td><code id="dmesn_+3A_scale">scale</code></td>
<td>
<p>a symmetric positive-definite scale matrix of dimension <code>(d,d)</code>. <code>diag(d)</code> is the default.</p>
</td></tr>
<tr><td><code id="dmesn_+3A_shape">shape</code></td>
<td>
<p>a numeric skewness vector of length <code>d</code>. <code>0</code> is the default.</p>
</td></tr>
<tr><td><code id="dmesn_+3A_extended">extended</code></td>
<td>
<p>a single value extension parameter. <code>0</code> is the default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>density (<code>dmesn</code>), probability (<code>pmesn</code>) from the bivariate or trivariate extended skew-normal distribution with given
<code>location</code>, <code>scale</code>, <code>shape</code> and <code>extended</code> parameters or from the skew-normal distribution if <code>extended=0</code>.
If <code>shape=0</code> and <code>extended=0</code> then the normal distribution is recovered.
</p>


<h3>Author(s)</h3>

<p>Simone Padoan, <a href="mailto:simone.padoan@unibocconi.it">simone.padoan@unibocconi.it</a>,
<a href="https://faculty.unibocconi.it/simonepadoan/">https://faculty.unibocconi.it/simonepadoan/</a>;
Boris Beranger, <a href="mailto:borisberanger@gmail.com">borisberanger@gmail.com</a>
<a href="https://www.borisberanger.com">https://www.borisberanger.com</a>;
</p>


<h3>References</h3>

<p>Azzalini, A. and Capitanio, A. (1999).
Statistical applications of the multivariate skew normal distribution.
<em>J.Roy.Statist.Soc. B</em> <b>61</b>, 579&ndash;602.
</p>
<p>Azzalini, A. with the collaboration of Capitanio, A. (2014).
<em>The Skew-Normal and Related Families</em>.
Cambridge University Press, IMS Monographs series.
</p>
<p>Azzalini, A. and Dalla Valle, A. (1996).
The multivariate skew-normal distribution.
<em>Biometrika</em> <b>83</b>, 715&ndash;726.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
sigma1 &lt;- matrix(c(2,1.5,1.5,3),ncol=2)
sigma2 &lt;- matrix(c(2,1.5,1.8,1.5,3,2.2,1.8,2.2,3.5),ncol=3)
shape1 &lt;- c(1,2)
shape2 &lt;- c(1,2,1.5)

dens1 &lt;- dmesn(x=c(1,1), scale=sigma1, shape=shape1, extended=2)
dens2 &lt;- dmesn(x=c(1,1), scale=sigma1)
dens3 &lt;- dmesn(x=c(1,1,1), scale=sigma2, shape=shape2, extended=2)
dens4 &lt;- dmesn(x=c(1,1,1), scale=sigma2)

prob1 &lt;- pmesn(x=c(1,1), scale=sigma1, shape=shape1, extended=2)
prob2 &lt;- pmesn(x=c(1,1), scale=sigma1)


prob3 &lt;- pmesn(x=c(1,1,1), scale=sigma2, shape=shape2, extended=2)
prob4 &lt;- pmesn(x=c(1,1,1), scale=sigma2)


</code></pre>

<hr>
<h2 id='dmest'>Bivariate and trivariate extended skew-t distribution</h2><span id='topic+dmest'></span><span id='topic+pmest'></span>

<h3>Description</h3>

<p>Density function, distribution function for the bivariate and trivariate extended skew-t (<abbr><span class="acronym">EST</span></abbr>) distribution.</p>


<h3>Usage</h3>

<pre><code class='language-R'>dmest(x=c(0,0), location=rep(0, length(x)), scale=diag(length(x)),
      shape=rep(0,length(x)), extended=0, df=Inf)
pmest(x=c(0,0), location=rep(0, length(x)), scale=diag(length(x)),
      shape=rep(0,length(x)), extended=0, df=Inf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dmest_+3A_x">x</code></td>
<td>
<p> quantile vector of length <code>d=2</code> or <code>d=3</code>. </p>
</td></tr>
<tr><td><code id="dmest_+3A_location">location</code></td>
<td>
<p>a numeric location vector of length <code>d</code>. <code>0</code> is the default.</p>
</td></tr>
<tr><td><code id="dmest_+3A_scale">scale</code></td>
<td>
<p>a symmetric positive-definite scale matrix of dimension <code>(d,d)</code>. <code>diag(d)</code> is the default.</p>
</td></tr>
<tr><td><code id="dmest_+3A_shape">shape</code></td>
<td>
<p>a numeric skewness vector of length <code>d</code>. <code>0</code> is the default.</p>
</td></tr>
<tr><td><code id="dmest_+3A_extended">extended</code></td>
<td>
<p>a single value extension parameter. <code>0</code> is the default.</p>
</td></tr>
<tr><td><code id="dmest_+3A_df">df</code></td>
<td>
<p>a single positive value representing the degree of freedom;
it can be non-integer. Default value is <code>nu=Inf</code> which corresponds
to the skew-normal distribution.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>density (<code>dmest</code>), probability (<code>pmest</code>) from the bivariate or trivariate extended skew-t distribution with given
<code>location</code>, <code>scale</code>, <code>shape</code>, <code>extended</code> and <code>df</code> parameters or from the skew-t distribution if <code>extended=0</code>.
If <code>shape=0</code> and <code>extended=0</code> then the t distribution is recovered.
</p>


<h3>Author(s)</h3>

<p>Simone Padoan, <a href="mailto:simone.padoan@unibocconi.it">simone.padoan@unibocconi.it</a>,
<a href="https://faculty.unibocconi.it/simonepadoan/">https://faculty.unibocconi.it/simonepadoan/</a>;
Boris Beranger, <a href="mailto:borisberanger@gmail.com">borisberanger@gmail.com</a>
<a href="https://www.borisberanger.com">https://www.borisberanger.com</a>;
</p>


<h3>References</h3>

<p>Azzalini, A. and Capitanio, A. (2003).
Distributions generated by perturbation of symmetry
with emphasis on a multivariate skew <em>t</em> distribution.
<em>J.Roy. Statist. Soc. B</em> <b>65</b>, 367&ndash;389.
</p>
<p>Azzalini, A. with the collaboration of Capitanio, A. (2014).
<em>The Skew-Normal and Related Families</em>.
Cambridge University Press, IMS Monograph series.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
sigma1 &lt;- matrix(c(2,1.5,1.5,3),ncol=2)
sigma2 &lt;- matrix(c(2,1.5,1.8,1.5,3,2.2,1.8,2.2,3.5),ncol=3)
shape1 &lt;- c(1,2)
shape2 &lt;- c(1,2,1.5)

dens1 &lt;- dmest(x=c(1,1), scale=sigma1, shape=shape1, extended=2, df=1)
dens2 &lt;- dmest(x=c(1,1), scale=sigma1, df=1)
dens3 &lt;- dmest(x=c(1,1,1), scale=sigma2, shape=shape2, extended=2, df=1)
dens4 &lt;- dmest(x=c(1,1,1), scale=sigma2, df=1)

prob1 &lt;- pmest(x=c(1,1), scale=sigma1, shape=shape1, extended=2, df=1)
prob2 &lt;- pmest(x=c(1,1), scale=sigma1, df=1)


prob3 &lt;- pmest(x=c(1,1,1), scale=sigma2, shape=shape2, extended=2, df=1)
prob4 &lt;- pmest(x=c(1,1,1), scale=sigma2, df=1)


</code></pre>

<hr>
<h2 id='ellipse'>Level sets for bivariate normal, student-t and skew-normal distributions probability densities.</h2><span id='topic+ellipse'></span>

<h3>Description</h3>

<p>Level sets of the bivariate normal, student-t and skew-normal distributions probability densities for a given probability.</p>


<h3>Usage</h3>

<pre><code class='language-R'>	ellipse(center=c(0,0), alpha=c(0,0), sigma=diag(2), df=1,
	prob=0.01, npoints=250, pos=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ellipse_+3A_center">center</code></td>
<td>
<p>A vector of length 2 corresponding to the location of the distribution.</p>
</td></tr>
<tr><td><code id="ellipse_+3A_alpha">alpha</code></td>
<td>
<p>A vector of length 2 corresponding to the skewness of the skew-normal distribution.</p>
</td></tr>
<tr><td><code id="ellipse_+3A_sigma">sigma</code></td>
<td>
<p>A 2 by 2 variance-covariance matrix.</p>
</td></tr>
<tr><td><code id="ellipse_+3A_df">df</code></td>
<td>
<p>An integer corresponding to the degree of freedom of the student-t distribution.</p>
</td></tr>
<tr><td><code id="ellipse_+3A_prob">prob</code></td>
<td>
<p>The probability level. See <code>details</code></p>
</td></tr>
<tr><td><code id="ellipse_+3A_npoints">npoints</code></td>
<td>
<p>The maximum number of points at which it is evaluated.</p>
</td></tr>
<tr><td><code id="ellipse_+3A_pos">pos</code></td>
<td>
<p>If <code>pos=TRUE</code> only the region on the positive quadrant is kept.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Level sets are defined as
</p>
<p><code class="reqn">R(f_\alpha)=\{ x: f(x) \geq f_\alpha \} </code>
</p>
<p>where <code class="reqn">f_\alpha</code> is the largest constant such that
</p>
<p><code class="reqn">P(X \in R(f_\alpha)) \geq 1-\alpha</code>.
Here we consider <code class="reqn">f(x)</code> to be the bivariate normal, student-t or skew-normal density.
</p>


<h3>Value</h3>

<p>Returns a bivariate vector of <code class="reqn">250</code> rows if <code>pos=FALSE</code>, and half otherwise.
</p>


<h3>Author(s)</h3>

<p>Simone Padoan, <a href="mailto:simone.padoan@unibocconi.it">simone.padoan@unibocconi.it</a>,
<a href="https://faculty.unibocconi.it/simonepadoan/">https://faculty.unibocconi.it/simonepadoan/</a>;
Boris Beranger, <a href="mailto:borisberanger@gmail.com">borisberanger@gmail.com</a>
<a href="https://www.borisberanger.com">https://www.borisberanger.com</a>;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(mvtnorm)

# Data simulation (Bivariate-t on positive quadrant)
rho &lt;- 0.5
sigma &lt;- matrix(c(1,rho,rho,1), ncol=2)
df &lt;- 2

set.seed(101)
n &lt;- 1500
data &lt;- rmvt(5*n, sigma=sigma, df=df)
data &lt;- data[data[,1]&gt;0 &amp; data[,2]&gt;0, ]
data &lt;- data[1:n, ]

P &lt;- c(1/750, 1/1500, 1/3000)

ell1 &lt;- ellipse(prob=1-P[1], sigma=sigma, df=df, pos=TRUE)
ell2 &lt;- ellipse(prob=1-P[2], sigma=sigma, df=df, pos=TRUE)
ell3 &lt;- ellipse(prob=1-P[3], sigma=sigma, df=df, pos=TRUE)

plot(data, xlim=c(0,max(data[,1],ell1[,1],ell2[,1],ell3[,1])),
     ylim=c(0,max(data[,2],ell1[,2],ell2[,2],ell3[,2])), pch=19)
points(ell1, type="l", lwd=2, lty=1)
points(ell2, type="l", lwd=2, lty=1)
points(ell3, type="l", lwd=2, lty=1)

</code></pre>

<hr>
<h2 id='ExtQ'>Univariate Extreme Quantile</h2><span id='topic+ExtQ'></span>

<h3>Description</h3>

<p>Computes the extreme-quantiles of a univariate random variable corresponding to some exceedance probabilities.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ExtQ(P=NULL, method="Frequentist", pU=NULL, 
     cov=NULL, param=NULL,  param_post=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ExtQ_+3A_p">P</code></td>
<td>
<p>A vector with values in <code class="reqn">[0,1]</code> indicating the probabilities of the quantiles to be computed.</p>
</td></tr>
<tr><td><code id="ExtQ_+3A_method">method</code></td>
<td>
<p>A character string indicating the estimation method. Takes value <code>"bayesian"</code> or <code>"frequentist"</code>.</p>
</td></tr>
<tr><td><code id="ExtQ_+3A_pu">pU</code></td>
<td>
<p>A value in <code class="reqn">[0,1]</code> indicating the probability of exceeding a high threshold. In the estimation procedure, observations below the threshold are censored.</p>
</td></tr>
<tr><td><code id="ExtQ_+3A_cov">cov</code></td>
<td>
<p>A <code class="reqn">q \times c</code> matrix indicating <code class="reqn">q</code> observations of <code class="reqn">c-1</code> covariates for the location parameter.</p>
</td></tr>
<tr><td><code id="ExtQ_+3A_param">param</code></td>
<td>
<p>A <code class="reqn">(c + 2)</code> vector indicating the estimated parameters. Required when <code>method="Frequentist"</code>.</p>
</td></tr>
<tr><td><code id="ExtQ_+3A_param_post">param_post</code></td>
<td>
<p>A <code class="reqn">n \times (c + 2)</code> matrix indicating the posterior sample for the parameters, where <code class="reqn">n</code> is the number of MCMC replicates after removal of the burn-in period. Required when <code>method="Bayesian"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The first column of <code>cov</code> is a vector of 1s corresponding to the intercept. 
</p>
<p>When <code>pU</code> is <code>NULL</code> (default), then it is assumed that a block maxima approach was taken and quantiles are computed using the <code><a href="#topic+qGEV">qGEV</a></code> function. When <code>pU</code> is provided, the it is assumed that a threshold exceedances approach is taken and the quantiles are computed as
</p>
<p style="text-align: center;"><code class="reqn">\mu + \sigma * \left(\left(\frac{pU}{P}\right)^\xi-1\right) \frac{1}{\xi}.</code>
</p>



<h3>Value</h3>

<p>When <code>method=="frequentist"</code>, the function returns a vector of length <code>length(P)</code> if <code>ncol(cov)=1</code> (constant mean) or a <code>(length(P) x nrow(cov))</code> matrix if <code>ncol(cov)&gt;1</code>. <br />
</p>
<p>When <code>method=="bayesian"</code>, the function returs a <code>(length(param_post) x length(P))</code> matrix if <code>ncol(cov)=1</code> or a list of <code>ncol(cov)</code> elements each taking a <code>(length(param_post) x length(P))</code> matrix if <code>ncol(cov)&gt;1</code>.
</p>


<h3>Author(s)</h3>

<p>Simone Padoan, <a href="mailto:simone.padoan@unibocconi.it">simone.padoan@unibocconi.it</a>,
<a href="https://faculty.unibocconi.it/simonepadoan/">https://faculty.unibocconi.it/simonepadoan/</a>;
Boris Beranger, <a href="mailto:borisberanger@gmail.com">borisberanger@gmail.com</a>
<a href="https://www.borisberanger.com">https://www.borisberanger.com</a>
</p>


<h3>References</h3>

<p>Beranger, B., Padoan, S. A. and Sisson, S. A. (2021).
Estimation and uncertainty quantification for extreme quantile regions.
<em>Extremes</em>, <b>24</b>, 349-375.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fGEV">fGEV</a></code>, <code><a href="#topic+qGEV">qGEV</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
##################################################
### Example - Pollution levels in Milan, Italy ###
##################################################

## Not run: 

data(MilanPollution)

# Frequentist estimation
fit &lt;- fGEV(Milan.winter$PM10)
fit$est

q1 &lt;- ExtQ(P=1/c(600,1200,2400), method="Frequentist", param=fit$est)
q1

# Bayesian estimation with high threshold
cov &lt;- cbind(rep(1,nrow(Milan.winter)), Milan.winter$MaxTemp, 
             Milan.winter$MaxTemp^2)
u &lt;- quantile(Milan.winter$PM10, prob=0.9, type=3, na.rm=TRUE)

fit2 &lt;- fGEV(data=Milan.winter$PM10, par.start=c(50,0,0,20,1), 
               method="Bayesian", u=u, cov=cov, sig0=0.1, nsim=5e+4) 

r &lt;- range(Milan.winter$MaxTemp, na.rm=TRUE)
t &lt;- seq(from=r[1], to=r[2], length=50)
pU &lt;- mean(Milan.winter$PM10&gt;u, na.rm=TRUE)
q2 &lt;- ExtQ(P=1/c(600,1200,2400), method="Bayesian", pU=pU,
           cov=cbind(rep(1,50), t, t^2),
           param_post=fit2$param_post[-c(1:3e+4),])
             
R &lt;- c(min(unlist(q2)), 800)
qseq &lt;- seq(from=R[1],to=R[2], length=512)
Xl &lt;- "Max Temperature"
Yl &lt;- expression(PM[10])
  
for(i in 1:length(q2)){
  K_q2 &lt;- apply(q2[[i]],2, function(x) density(x, from=R[1], to=R[2])$y)
  D &lt;- cbind(expand.grid(t, qseq), as.vector(t(K_q2)) )
  colnames(D) &lt;- c("x","y","z")
  fields::image.plot(x=t, y=qseq, z=matrix(D$z, 50, 512), xlim=r, 
                           ylim=R, xlab=Xl, ylab=Yl)
}


## End(Not run)
  
##########################################################
### Example - Simulated data from Frechet distirbution ###
##########################################################
  
if(interactive()){  
  
set.seed(999)  
data &lt;- extraDistr::rfrechet(n=1500, mu=3, sigma=1, lambda=1/3)

u &lt;- quantile(data, probs=0.9, type=3)
fit3 &lt;- fGEV(data=data, par.start=c(1,2,1), method="Bayesian", 
             u=u, sig0=1, nsim=5e+4)
  
pU &lt;- mean(data&gt;u)
P &lt;- 1/c(750,1500,3000)
q3 &lt;- ExtQ(P=P, method="Bayesian", pU=pU,
           param_post=fit3$param_post[-c(1:3e+4),])  

### Illustration

# Tail index estimation

ti_true &lt;- 3
ti_ps &lt;- fit3$param_post[-c(1:3e+4),3]

K_ti &lt;- density(ti_ps) # KDE of the tail index
H_ti &lt;- hist(ti_ps, prob=TRUE, col="lightgrey",
			       ylim=range(K_ti$y), main="", xlab="Tail Index",
			       cex.lab=1.8, cex.axis=1.8, lwd=2)
ti_ic &lt;- quantile(ti_ps, probs=c(0.025, 0.975))

points(x=ti_ic, y=c(0,0), pch=4, lwd=4)
lines(K_ti, lwd = 2, col = "dimgrey")
abline(v=ti_true, lwd=2)
abline(v=mean(ti_ps), lwd=2, lty=2)  
  
# Quantile estimation

q3_true &lt;- extraDistr::qfrechet(p=P, mu=3, sigma=1, lambda=1/3, lower.tail=FALSE)

ci &lt;- apply(log(q3), 2, function(x) quantile(x, probs=c(0.025, 0.975)))
K_q3 &lt;- apply(log(q3), 2, density)

R &lt;- range(log(c(q3_true, q3, data)))
Xlim &lt;- c(log(quantile(data, 0.95)), R[2])
Ylim &lt;- c(0, max(K_q3[[1]]$y, K_q3[[2]]$y, K_q3[[3]]$y))

plot(0, main="", xlim=Xlim, ylim=Ylim, xlab=expression(log(x)), 
     ylab="Density", cex.lab=1.8, cex.axis=1.8, lwd=2)
cval &lt;- c(211, 169, 105)	 
for(j in 1:length(P)){
  col &lt;- rgb(cval[j], cval[j], cval[j], 0.8*255, maxColorValue=255)
  col2 &lt;- rgb(cval[j], cval[j], cval[j],  255, maxColorValue=255)
  polygon(K_q3[[j]], col=col, border=col2, lwd=4)
}
points(log(data), rep(0,n), pch=16)	 
# add posterior means
abline(v=apply(log(q3),2,mean), lwd=2, col=2:4)
# add credible intervals
abline(v=ci[1,], lwd=2, lty=3, col=2:4)
abline(v=ci[2,], lwd=2, lty=3, col=2:4)

}

</code></pre>

<hr>
<h2 id='fExtDep'>Extremal dependence estimation</h2><span id='topic+fExtDep'></span>

<h3>Description</h3>

<p>This function estimates the parameters of extremal dependence models.</p>


<h3>Usage</h3>

<pre><code class='language-R'>fExtDep(method="PPP", data, model, par.start = NULL, 
        c = 0, optim.method = "BFGS", trace = 0, sig = 3,
        Nsim, Nbin = 0, Hpar, MCpar, seed = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fExtDep_+3A_method">method</code></td>
<td>
<p>A character string indicating the estimation method inlcuding <code>"PPP"</code>, <code>"BayesianPPP"</code> and <code>"Composite"</code>.</p>
</td></tr>
<tr><td><code id="fExtDep_+3A_data">data</code></td>
<td>
<p>A matrix containing the data.</p>
</td></tr>
<tr><td><code id="fExtDep_+3A_model">model</code></td>
<td>
<p>A character string with the name of the model. When <code>method="PPP"</code> or <code>"BayesianPPP"</code>, this includes <code>"PB"</code>, <code>"HR"</code>, <code>"ET"</code>, <code>"EST"</code>, <code>TD</code> and <code>AL</code> whereas when <code>method="composite"</code> it is restricted to <code>"HR"</code>, <code>"ET"</code> and <code>"EST"</code>.</p>
</td></tr>
<tr><td><code id="fExtDep_+3A_par.start">par.start</code></td>
<td>
<p>A vector representing the initial parameters values for the optimization algorithm.</p>
</td></tr>
<tr><td><code id="fExtDep_+3A_c">c</code></td>
<td>
<p>A real value in <code class="reqn">[0,1]</code> required when <code>method="PPP"</code> or <code>"BayesianPPP"</code> and <code>model="ET"</code>, <code>"EST"</code> and <code>"AL"</code>. See <code><a href="#topic+dExtDep">dExtDep</a></code> for more details.</p>
</td></tr>
<tr><td><code id="fExtDep_+3A_optim.method">optim.method</code></td>
<td>
<p>A character string indicating the optimization algorithm. Required when <code>method="PPP"</code> or <code>"Composite"</code>. See <code><a href="stats.html#topic+optim">optim</a></code> for more details.</p>
</td></tr>
<tr><td><code id="fExtDep_+3A_trace">trace</code></td>
<td>
<p>A non-negative integer, tracing the progress of the optimization. Required when <code>method="PPP"</code> or <code>"Composite"</code>. See <code><a href="stats.html#topic+optim">optim</a></code> for more details.</p>
</td></tr>
<tr><td><code id="fExtDep_+3A_sig">sig</code></td>
<td>
<p>An integer indicating the number of significant digits when reporting outputs.</p>
</td></tr>
<tr><td><code id="fExtDep_+3A_nsim">Nsim</code></td>
<td>
<p>An integer indicating the number of MCMC simulations. Required when <code>method="BayesianPPP"</code>.</p>
</td></tr>
<tr><td><code id="fExtDep_+3A_nbin">Nbin</code></td>
<td>
<p>An integer indicating the length of the burn-in period. Required when <code>method="BayesianPPP"</code>.</p>
</td></tr>
<tr><td><code id="fExtDep_+3A_hpar">Hpar</code></td>
<td>
<p>A list of hyper-parameters. See 'details'. Required when <code>method="BayesianPPP"</code>.</p>
</td></tr>
<tr><td><code id="fExtDep_+3A_mcpar">MCpar</code></td>
<td>
<p>A positive real representing the variance of the proposal distirbution. See 'details'. Required when <code>method="BayesianPPP"</code>.</p>
</td></tr>
<tr><td><code id="fExtDep_+3A_seed">seed</code></td>
<td>
<p>An integer indicating the seed to be set for reproducibility, via the routine <code>set.seed</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When <code>method="PPP"</code> the approximate likelihood is used to estimate the model parameters. It relies on the <code>dExtDep</code> function with argument <code>method="Parametric"</code> and <code>angular=TRUE</code>.
</p>
<p>When <code>method="BayesianPPP"</code> a Bayesian estimation procedure of the spatral measure is considered, following Sabourin et al. (2013) and Sabourin &amp; Naveau (2014). The argument <code>Hpar</code> is required to specify the hyper-parameters of the prior distributions, taking the following into consideration: 
</p>

<ul>
<li><p> For the <b>Pairwise Beta model</b>, the parameters components are independent, log-normal.
The vector of parameters is of size <code>choose(dim,2)+1</code> with positive components. The first elements are the
pairiwse dependence parameters <code>b</code> and the last one is the global dependence parameter <code>alpha</code>.
The list of hyper-parameters should be of the form
<code>mean.alpha=, mean.beta=, sd.alpha=, sd.beta=</code>;
</p>
</li>
<li><p> For the <b>Husler-Reiss model</b>, the parameters are independent, log-normally distributed.
The elements correspond to the <code>lambda</code> parameter. The list of hyper-parameters should be of the form <code>mean.lambda=, sd.lambda=</code>;
</p>
</li>
<li><p> For the <b>Dirichlet model</b>, the parameters are independent, log-normally distributed.
The elements correspond to the <code>alpha</code> parameter. The list of hyper-parameters should be of the form <code>mean.alpha=, sd.alpha=</code>;
</p>
</li>
<li><p> For the <b>Extremal-t model</b>, the parameters are independent, logit-squared for <code>rho</code> and log-normal for <code>mu</code>. The first elements correspond	to the correlation parameters <code>rho</code> and the last parameter is the global dependence parameter <code>mu</code>. The list of hyper-parameters should be of the form <code>mean.rho=, mean.mu=, sd.rho=, sd.mu=</code>;
</p>
</li>
<li><p> For the <b>Extremal skewt-t model</b>, the parameters are independent, logit-squared for <code>rho</code>, normal for <code>alpha</code> and log-normal for <code>mu</code>. The first elements correspond	to the correlation parameters <code>rho</code>, then the skewness parameters <code>alpha</code> and the last parameter is the global dependence parameter <code>mu</code>. The list of hyper-parameters should be of the form <code>mean.rho=, mean.alpha=, mean.mu=, sd.rho=, sd.alpha=, sd.mu=</code>;
</p>
</li>
<li><p> For the <b>Asymmetric Logistic model</b>, the parameters' components are independent, log-normal for <code>alpha</code> and logit for <code>beta</code>. The list of hyper-parameters should be of the form <code>mean.alpha=, mean.beta=, sd.alpha=, sd.beta=</code>.
</p>
</li></ul>

<p>The proposal distribution for each (transformed) parameter is a normal distribution centred on the (transformed) current parameter value, with variance <code>MCpar</code>. 
</p>
<p>When <code>method="Composite"</code>, the pairwise composite likelihood is applied, based on the <code>dExtDep</code> function with argument <code>method="Parametric"</code> and <code>angular=FALSE</code>.
</p>


<h3>Value</h3>

<p>When <code>method == "PPP"</code> or <code>"Composite"</code>, a list is returned including
</p>

<ul>
<li><p><code>par</code>: The estimated parameters.
</p>
</li>
<li><p><code>LL</code>: The maximised log-likelihood.
</p>
</li>
<li><p><code>SE</code>: The standard errors.
</p>
</li>
<li><p><code>TIC</code>: The Takeuchi Information Criterion.
</p>
</li></ul>

<p>When <code>method == "BayesianPPP"</code>, a list is returned including 
</p>

<ul>
<li><p><code>stored.vales</code>: A <code class="reqn">(Nsim-Nbin)*d</code> matrix, where <code class="reqn">d</code> is the dimension of the parameter space
</p>
</li>
<li><p><code>llh</code>: A vector of size <code class="reqn">(Nsim-Nbin)</code> containing the log-likelihoods evaluadted at each parameter
of the posterior sample.
</p>
</li>
<li><p><code>lprior</code>: A vector of size <code class="reqn">(Nsim-Nbin)</code> containing the logarithm of the prior densities evaluated
at each parameter of the posterior sample.
</p>
</li>
<li><p><code>arguments</code>: The specifics of the algorithm.
</p>
</li>
<li><p><code>elapsed</code>: The time elapsed, as given by <code>proc.time</code> between the start and end of the run.
</p>
</li>
<li><p><code>Nsim</code>: The same as the passed argument.
</p>
</li>
<li><p><code>Nbin</code>: Idem.
</p>
</li>
<li><p><code>n.accept</code>: The total number of accepted proposals.
</p>
</li>
<li><p><code>n.accept.kept</code>: The number of accepted proposals after the burn-in period. 
</p>
</li>
<li><p><code>emp.mean</code>: The estimated posterior parameters mean.
</p>
</li>
<li><p><code>emp.sd</code>: The empirical posterior sample standard deviation.
</p>
</li>
<li><p><code>BIC</code>: The Bayesian Information Criteria.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Simone Padoan, <a href="mailto:simone.padoan@unibocconi.it">simone.padoan@unibocconi.it</a>,
<a href="https://faculty.unibocconi.it/simonepadoan/">https://faculty.unibocconi.it/simonepadoan/</a>;
Boris Beranger, <a href="mailto:borisberanger@gmail.com">borisberanger@gmail.com</a>
<a href="https://www.borisberanger.com">https://www.borisberanger.com</a>;
</p>


<h3>References</h3>

<p>Beranger, B. and Padoan, S. A. (2015).
Extreme dependence models, chapater of the book <em>Extreme Value Modeling and Risk Analysis: Methods and Applications</em>,
<b>Chapman Hall/CRC</b>.
</p>
<p>Sabourin, A., Naveau, P. and Fougeres, A-L (2013)
Bayesian model averaging for multivariate extremes
<em>Extremes</em>, <b>16</b>, 325-350.
</p>
<p>Sabourin, A. and Naveau, P. (2014)
Bayesian Dirichlet mixture model for multivariate extremes: A re-parametrization
<em>Computational Statistics &amp; Data Analysis</em>, <b>71</b>, 542-567.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dExtDep">dExtDep</a></code>, <code><a href="#topic+pExtDep">pExtDep</a></code>, <code><a href="#topic+rExtDep">rExtDep</a></code>, <code><a href="#topic+fExtDep.np">fExtDep.np</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example using the Poisson Point Proce Process appraoch
data(pollution)

  f.hr &lt;- fExtDep(method="PPP", data=PNS, model="HR", 
                  par.start = rep(0.5, 3), trace=2)


# Example using the pairwise composite (full) likelihood

  set.seed(1)
  data &lt;- rExtDep(n=300, model="ET", par=c(0.6,3))
  f.et &lt;- fExtDep(method="Composite", data=data, model="ET", 
                  par.start = c(0.5, 1), trace=2)

</code></pre>

<hr>
<h2 id='fExtDep.np'>Non-parametric extremal dependence estimation</h2><span id='topic+fExtDep.np'></span>

<h3>Description</h3>

<p>This function estimates the bivariate extremal dependence structure using a non-parametric approach based on Bernstein Polynomials.</p>


<h3>Usage</h3>

<pre><code class='language-R'>fExtDep.np(method, data, cov1=NULL, cov2=NULL, u, mar.fit=TRUE, 
           mar.prelim=TRUE, par10, par20, sig10, sig20, param0=NULL, 
           k0=NULL, pm0=NULL, prior.k="nbinom", prior.pm="unif", 
           nk=70, lik=TRUE, 
           hyperparam = list(mu.nbinom=3.2, var.nbinom=4.48), 
           nsim, warn=FALSE, type="rawdata")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fExtDep.np_+3A_method">method</code></td>
<td>
<p>A character string indicating the estimation method inlcuding <code>"Bayesian"</code>, <code>"Frequentist"</code> and <code>"Empirical"</code>.</p>
</td></tr>
<tr><td><code id="fExtDep.np_+3A_data">data</code></td>
<td>
<p>A matrix containing the data.</p>
</td></tr>
<tr><td><code id="fExtDep.np_+3A_cov1">cov1</code>, <code id="fExtDep.np_+3A_cov2">cov2</code></td>
<td>
<p>A covariate vector/matrix for linear model on the location parameter of the marginal distributions. <code>length(cov1)</code>/<code>nrow(cov1)</code> needs to match <code>nrow(data)</code>. If <code>NULL</code> it is assumed to be constant. Required when <code>method="Bayesian"</code>.</p>
</td></tr>
<tr><td><code id="fExtDep.np_+3A_u">u</code></td>
<td>
<p>When <code>method="Bayesian"</code>: a bivariate indicating the threshold for the exceedance approach. If logical <code>TRUE</code> the threshold are calculated by default as the 90% quantiles. When missing, a block maxima approach is considered. When <code>method="Frequentist"</code>: the associated quantile is used to select observations with the largest radial components. If missing, the 90% quantile is used. </p>
</td></tr>
<tr><td><code id="fExtDep.np_+3A_mar.fit">mar.fit</code></td>
<td>
<p>A logical value indicated whether the marginal distributions should be fitted. When <code>method="Frequentist"</code>, data are empirically transformed to unit Frechet scale if <code>mar.fit=TRUE</code>. Not required when <code>method="Empirical"</code>.</p>
</td></tr>
<tr><td><code id="fExtDep.np_+3A_rawdata">rawdata</code></td>
<td>
<p>A character string specifying if the data is <code>"rawdata"</code> or <code>"maxima"</code>. Required when <code>method="Frequentist"</code>.</p>
</td></tr>
<tr><td><code id="fExtDep.np_+3A_mar.prelim">mar.prelim</code></td>
<td>
<p>A logical value indicated whether a preliminary fit of marginal distributions should be done prior to estimating the margins and dependence. Required when <code>method="Bayesian"</code>.</p>
</td></tr>
<tr><td><code id="fExtDep.np_+3A_par10">par10</code>, <code id="fExtDep.np_+3A_par20">par20</code></td>
<td>
<p>Vectors of starting values for the marginal parameter estimation. Required when <code>method="Bayesian"</code> and <code>mar.fit=TRUE</code></p>
</td></tr>
<tr><td><code id="fExtDep.np_+3A_sig10">sig10</code>, <code id="fExtDep.np_+3A_sig20">sig20</code></td>
<td>
<p>Positive reals representing the initial value for the scaling parameter of the multivariate normal proposal distribution for both margins. Required when <code>method="Bayesian"</code> and <code>mar.fit=TRUE</code></p>
</td></tr>
<tr><td><code id="fExtDep.np_+3A_param0">param0</code></td>
<td>
<p>A vector of initial value for the Bernstein polynomial coefficients. It should be a list with elements <code>$eta</code> and <code>$beta</code> which can be generated by the internal function <code>rcoef</code> if missing. Required when <code>method="Bayesian"</code>. </p>
</td></tr>
<tr><td><code id="fExtDep.np_+3A_k0">k0</code></td>
<td>
<p>An integer indicating the initial value of the polynomial order. Required when <code>method="Bayesian"</code>.</p>
</td></tr>
<tr><td><code id="fExtDep.np_+3A_pm0">pm0</code></td>
<td>
<p>A list of initial values for the probability masses at the boundaries of the simplex. It should be a list with two elements <code>$p0</code> and <code>$p1</code>. Randomly generated if missing. Required when <code>method="Bayesian"</code>.</p>
</td></tr>
<tr><td><code id="fExtDep.np_+3A_prior.k">prior.k</code></td>
<td>
<p>A character string indicating the prior distribution on the polynomial order. By default <code>prior.k="nbinom"</code> (negative binomial) but can also be <code>"pois"</code> (Poisson). Required when <code>method="Bayesian"</code>.</p>
</td></tr>
<tr><td><code id="fExtDep.np_+3A_prior.pm">prior.pm</code></td>
<td>
<p>A character string indicating the prior on the probability masses at the endpoints of the simplex. By default <code>prior.pm="unif"</code> (uniform) but can also be <code>"beta"</code> (beta). Required when <code>method="Bayesian"</code>.</p>
</td></tr>
<tr><td><code id="fExtDep.np_+3A_nk">nk</code></td>
<td>
<p>An integer indicating the maximum polynomial order. Required when <code>method="Bayesian"</code>.</p>
</td></tr>
<tr><td><code id="fExtDep.np_+3A_lik">lik</code></td>
<td>
<p>A logical value; if <code>FALSE</code>, an approximation of the likelihood, by means of the angular measure in Bernstein form is used (<code>TRUE</code> by default). Required when <code>method="Bayesian"</code>.</p>
</td></tr>
<tr><td><code id="fExtDep.np_+3A_hyperparam">hyperparam</code></td>
<td>
<p>A list of the hyper-parameters depending on the choice of <code>prior.k</code> and <code>prior.pm</code>. See <b>details</b>. Required when <code>method="Bayesian"</code>.</p>
</td></tr>
<tr><td><code id="fExtDep.np_+3A_nsim">nsim</code></td>
<td>
<p>An integer indicating the number of iterations in the Metropolis-Hastings algorithm. Required when <code>method="Bayesian"</code>.</p>
</td></tr>	
<tr><td><code id="fExtDep.np_+3A_warn">warn</code></td>
<td>
<p>A logical value. If <code>TRUE</code> warnings are printed when some specifics (e.g., <code>param0</code>, <code>k0</code>, <code>pm0</code> and <code>hyperparam</code>) are not provided and set by default. Required when <code>method="Bayesian"</code>.</p>
</td></tr>
<tr><td><code id="fExtDep.np_+3A_type">type</code></td>
<td>
<p>A character string indicating whther the data are <code>"rawdata"</code> or <code>"maxima"</code>. Required when <code>method="Bayesian"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When <code>method="Bayesian"</code>, the vector of hyper-parameters is provided in the argument <code>hyperparam</code>. It should include:
</p>

<ul>
<li><p>If <code>prior.pm="unif"</code> requires <code>hyperparam$a.unif</code> and <code>hyperparam$b.unif</code>.
</p>
</li>
<li><p>If <code>prior.pm="beta"</code> requires <code>hyperparam$a.beta</code> and <code>hyperparam$b.beta</code>.
</p>
</li>
<li><p>If <code>prior.k="pois"</code> requires <code>hyperparam$mu.pois</code>.
</p>
</li>
<li><p>If <code>prior.k="nbinom"</code> requires <code>hyperparam$mu.nbinom</code> and <code>hyperparam$var.nbinom</code> or <code>hyperparam$pnb</code> and <code>hyperparam$rnb</code>. The relationship is <code>pnb = mu.nbinom/var.nbinom</code> and <code>rnb = mu.nbinom^2 / (var.nbinom-mu.nbinom)</code>.
</p>
</li></ul>

<p>When <code>u</code> is specified Algorithm 1 of Beranger et al. (2021) is applied whereas when it is not specified Algorithm 3.5 of Marcon et al. (2016) is considered.
</p>
<p>When <code>method="Frequentist"</code>, if <code>type="rawdata"</code> then pseudo-polar coordinates are extracted and only observations with a radial component above some high threshold (the quantile equivalent of <code>u</code> for the raw data) are retained. The inferential approach proposed in Marcon et al. (2017) based on the approximate likelihood is applied.
</p>
<p>When <code>method="Empirical"</code>, the empirical estimation procedure presented in Einmahl et al. (2013) is applied.
</p>


<h3>Value</h3>

<p>Outputs take the form of list including:
</p>

<ul>
<li><p><code>method</code>: The argument.
</p>
</li>
<li><p><code>type</code>:  whether it is <code>"maxima"</code> or <code>"rawdata"</code> (in the broader sense that a threshold exceedance model was taken).
</p>
</li></ul>

<p>If <code>method="Bayesian"</code> the list also includes:
</p>

<ul>
<li><p><code>mar.fit</code>: The argument.
</p>
</li>
<li><p><code>pm</code>: The posterior sample of probability masses.
</p>
</li>
<li><p><code>eta</code>: The posterior sample for the coeficients of the Bernstein polynomial.
</p>
</li>
<li><p><code>k</code>: The posterior sample for the Bernstein polynoial order.
</p>
</li>
<li><p><code>accepted</code>: A binary vector indicating if the proposal was accepted.
</p>
</li>
<li><p><code>acc.vec</code>: A vector containing the acceptance probabilities for the dependence parameters at each iteration.
</p>
</li>
<li><p><code>prior</code>: A list containing <code>hyperparam</code>, <code>prior.pm</code> and <code>prior.k</code>.
</p>
</li>
<li><p><code>nsim</code>: The argument.
</p>
</li>
<li><p><code>data</code>: The argument.
</p>
</li></ul>

<p>In addition if the marginal parameters are estimated (<code>mar.fit=TRUE</code>):
</p>

<ul>
<li><p><code>cov1</code>, <code>cov2</code>: The arguments.
</p>
</li>
<li><p><code>accepted.mar</code>, <code>accepted.mar2</code>: Binary vectors indicating if the marginal proposals were accepted.
</p>
</li>
<li><p><code>straight.reject1</code>, <code>straight.reject2</code>: Binary vectors indicating if the marginal proposals were rejected straight away as not respecting existence conditions (proposal is multivariate normal).
</p>
</li>
<li><p><code>acc.vec1</code>, <code>acc.vec2</code>: Vectors containing the acceptance probabilities for the marginal parameters at each iteration.
</p>
</li>
<li><p><code>sig1.vec</code>, <code>sig2.vec</code>: Vectors containing the values of the scaling parameter in the marginal proposal distributions.
</p>
</li></ul>

<p>Finally, if the argument <code>u</code> is provided, the list also contains:
</p>

<ul>
<li><p><code>threshold</code>: A bivariate vector indicating the threshold level for both margins.
</p>
</li>
<li><p><code>kn</code>: The empirical estimate of the probability of being greater than the threshold.
</p>
</li></ul>

<p>When <code>method="Frequentist"</code>, the list includes:  
</p>
<p>When <code>method="Empirical"</code>, the list includes:
</p>

<ul>
<li><p><code>hhat</code>: An estimate of the angular density.
</p>
</li>
<li><p><code>Hhat</code>: An estimate of the angular measure.
</p>
</li>
<li><p><code>p0</code>, <code>p1</code>: The estimates of the probability mass at 0 and 1.
</p>
</li>
<li><p><code>Ahat</code>: An estimate of the PIckands dependence function.
</p>
</li>
<li><p><code>w</code>: A sequence of value on the bivariate unit simplex.
</p>
</li>
<li><p><code>q</code>: A real in <code class="reqn">[0,1]</code> indicating the quantile associated with the threshold <code>u</code>. Takes value <code>NULL</code> if <code>type="maxima"</code>.
</p>
</li>
<li><p><code>data</code>: The data on the unit Frechet scale (empirical transformation) if <code>type="rawdata"</code> and <code>mar.fit=TRUE</code>. Data on the original scale otherwise.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Simone Padoan, <a href="mailto:simone.padoan@unibocconi.it">simone.padoan@unibocconi.it</a>,
<a href="https://faculty.unibocconi.it/simonepadoan/">https://faculty.unibocconi.it/simonepadoan/</a>;
Boris Beranger, <a href="mailto:borisberanger@gmail.com">borisberanger@gmail.com</a>
<a href="https://www.borisberanger.com">https://www.borisberanger.com</a>;
</p>


<h3>References</h3>

<p>Beranger, B., Padoan, S. A. and Sisson, S. A. (2021).
Estimation and uncertainty quantification for extreme quantile regions.
<em>Extremes</em>, <b>24</b>, 349-375.
</p>
<p>Einmahl, J. H. J., de Haan, L. and Krajina, A. (2013).
Estimating extreme bivariate quantile regions.
<em>Extremes</em>, <b>16</b>, 121-145.
</p>
<p>Marcon, G., Padoan, S. A. and Antoniano-Villalobos, I. (2016).
Bayesian inference for the extremal dependence.
<em>Electronic Journal of Statistics</em>, <b>10</b>, 3310-3337.
</p>
<p>Marcon, G., Padoan, S.A., Naveau, P., Muliere, P. and Segers, J. (2017)
Multivariate Nonparametric Estimation of the Pickands Dependence
Function using Bernstein Polynomials.
<em>Journal of Statistical Planning and Inference</em>, <b>183</b>, 1-17.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dExtDep">dExtDep</a></code>, <code><a href="#topic+pExtDep">pExtDep</a></code>, <code><a href="#topic+rExtDep">rExtDep</a></code>, <code><a href="#topic+fExtDep">fExtDep</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'># Example Bayesian estimation, 
# Threshold exceedances approach, threshold set by default
# Joint estimation margins + dependence
# Default uniform prior on pm
# Default negative binomial prior on polynomial order
# Quadratic relationship between location and max temperature

## Not run: 
  data(MilanPollution)
  data &lt;- Milan.winter[,c("NO2", "SO2", "MaxTemp")]
  data &lt;- data[complete.cases(data),]
  
  covar &lt;- cbind(rep(1,nrow(data)), data[,3], data[,3]^2)
  hyperparam &lt;- list(mu.binom=6, var.binom=8, a.unif=0, b.unif=0.2)
  pollut &lt;- fExtDep.np(method="Bayesian", data = data[,-3], u=TRUE,
                       cov1 = covar, cov2 = covar, mar.prelim=FALSE,
                       par10 = c(100,0,0,35,1), par20 = c(20,0,0,20,1),
                       sig10 = 0.1, sig20 = 0.1, k0 = 5,
                       hyperparam = hyperparam, nsim = 5e+4)
  # Warning: This is slow!                     

## End(Not run)

# Example Frequentist estimation
# Data are maxima

data(WindSpeedGust)
years &lt;- format(ParcayMeslay$time, format="%Y")
attach(ParcayMeslay[which(years %in% c(2004:2013)),])
  
WS_th &lt;- quantile(WS,.9)
DP_th &lt;- quantile(DP,.9)
  
pars.WS &lt;- evd::fpot(WS, WS_th, model="pp")$estimate
pars.DP &lt;- evd::fpot(DP, DP_th, model="pp")$estimate
  
data_uf &lt;- trans2UFrechet(cbind(WS,DP), type="Empirical")
  
rdata &lt;- rowSums(data_uf)
r0 &lt;- quantile(rdata, probs=.90)
extdata &lt;- data_uf[rdata&gt;=r0,]
  
SP_mle &lt;- fExtDep.np(method="Frequentist", data=extdata, k0=10, 
                     type="maxima")
</code></pre>

<hr>
<h2 id='fExtDepSpat'>Fitting of a max-stable process</h2><span id='topic+fExtDepSpat'></span>

<h3>Description</h3>

<p>This function uses the Stephenson-Tawn likelihood to estimate parameters of max-stable models.</p>


<h3>Usage</h3>

<pre><code class='language-R'>fExtDepSpat(model, z, sites, hit, jw, thresh, DoF, range, smooth, 
            alpha, par0, acov1, acov2, parallel, ncores, args1, args2, 
            seed=123, method = "BFGS", sandwich=TRUE,
            control = list(trace=1, maxit=50, REPORT=1, reltol=0.0001))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fExtDepSpat_+3A_model">model</code></td>
<td>
<p>A character string indicating the max-stable model, currently extremal-t (<code>"ET"</code>) and extremal skew-t (<code>"EST"</code>) only available. Note that the Schlather model can be obtained as a special case by specifying the extremal-t model with <code>DoF=1</code></p>
</td></tr>
<tr><td><code id="fExtDepSpat_+3A_z">z</code></td>
<td>
<p>A <code class="reqn">(n \times d)</code> matrix containing <code class="reqn">n</code> observations at <code class="reqn">d</code> locations.</p>
</td></tr>
<tr><td><code id="fExtDepSpat_+3A_sites">sites</code></td>
<td>
<p>A <code class="reqn">(d \times 2)</code> matrix corresponding to the coordinates of locations where the processes is simulated. Each row corresponds to a location.</p>
</td></tr>
<tr><td><code id="fExtDepSpat_+3A_hit">hit</code></td>
<td>
<p>A <code class="reqn">(n \times d)</code> matrix containing the hitting scenarios for each observations.</p>
</td></tr>
<tr><td><code id="fExtDepSpat_+3A_jw">jw</code></td>
<td>
<p>An integer between <code class="reqn">2</code> and <code class="reqn">d</code>, indicating the tuples considered in the composite likelihood. If <code>jw=d</code> the full likelihood is considered.</p>
</td></tr>
<tr><td><code id="fExtDepSpat_+3A_thresh">thresh</code></td>
<td>
<p>A positive real indicating the threshold value for pairwise distances. See <code>details</code>.</p>
</td></tr>
<tr><td><code id="fExtDepSpat_+3A_dof">DoF</code></td>
<td>
<p>A positive real indicating a fixed value of the degree of freedom of the extremal-t and extremal skew-t models.</p>
</td></tr>
<tr><td><code id="fExtDepSpat_+3A_range">range</code></td>
<td>
<p>A positive real indicating a fixed value of the range parameter for the power exponential correlation function (only correlation function currently available).</p>
</td></tr>
<tr><td><code id="fExtDepSpat_+3A_smooth">smooth</code></td>
<td>
<p>A positive real in <code class="reqn">(0,2]</code> indicating a fixed value of the smoothness parameter for the power exponential correlation function (only correlation function currently available).</p>
</td></tr>
<tr><td><code id="fExtDepSpat_+3A_alpha">alpha</code></td>
<td>
<p>A vector of length <code class="reqn">3</code> indicating fixed values of the skewness parameters <code class="reqn">\alpha_0</code>, <code class="reqn">\alpha_1</code> and <code class="reqn">\alpha_2</code> for the extremal skew-t model. If some components are <code>NA</code>, then the corresponding parameter will be estimated.</p>
</td></tr>
<tr><td><code id="fExtDepSpat_+3A_par0">par0</code></td>
<td>
<p>A vector of initial value of the parameter vector, in order the degree of freedom <code class="reqn">\nu</code>, the range <code class="reqn">r</code>, the smoothness <code class="reqn">\eta</code> and the skewness parameters <code class="reqn">\alpha_0</code>, <code class="reqn">\alpha_1</code>. Its length depends on the model and the number of fixed parameters.</p>
</td></tr>
<tr><td><code id="fExtDepSpat_+3A_acov1">acov1</code>, <code id="fExtDepSpat_+3A_acov2">acov2</code></td>
<td>
<p>Vectors of length <code class="reqn">d</code> representing covariates to model the skewness parameter of the extremal skew-t model.</p>
</td></tr>
<tr><td><code id="fExtDepSpat_+3A_parallel">parallel</code></td>
<td>
<p>A logical value; if <code>TRUE</code> parallel computing is done.</p>
</td></tr>
<tr><td><code id="fExtDepSpat_+3A_ncores">ncores</code></td>
<td>
<p>An integer indicating the number of cores considered in the parallel socket cluster of type <code>'PSOCK'</code>, based on the <code>makeCluster</code> routine from the <code>parallel</code> package. Required if <code>parallel=TRUE</code>.</p>
</td></tr>
<tr><td><code id="fExtDepSpat_+3A_args1">args1</code>, <code id="fExtDepSpat_+3A_args2">args2</code></td>
<td>
<p>Lists specifying details about the Monte Carlo simulation schereme to compute multivariate CDFs. See <code>details</code>.</p>
</td></tr>
<tr><td><code id="fExtDepSpat_+3A_seed">seed</code></td>
<td>
<p>An integer for reproduciblity in the CDF computations.</p>
</td></tr>
<tr><td><code id="fExtDepSpat_+3A_method">method</code></td>
<td>
<p>A character string indicating the optimisation method to be used. See <code><a href="stats.html#topic+optim">optim</a></code> for more details.</p>
</td></tr>
<tr><td><code id="fExtDepSpat_+3A_sandwich">sandwich</code></td>
<td>
<p>A logical value; if <code>TRUE</code> the standard errors of the estimates are computed from the Sandwich (Godambe) information matrix.</p>
</td></tr>
<tr><td><code id="fExtDepSpat_+3A_control">control</code></td>
<td>
<p>A list of control parameter for the optimisation. See <code><a href="stats.html#topic+optim">optim</a></code> for more details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This routine follows the methodology developped by Beranger et al. (2021). It uses on the Stephenson-Tawn which relies on the knowledge of time occurrences of each block maxima. Rather than considering all partitions of the set <code class="reqn">\{1, \ldots,d\}</code>, the likelihood is computed using the observed partition. Let <code class="reqn">\Pi = (\pi_1, \ldots, \pi_K)</code> denote the observed partition, then the Stephenson-Tawn likelihood is given by
</p>
<p style="text-align: center;"><code class="reqn">L(\theta;z) = \exp \left\{ - V(z;\theta) \right\} \times \prod^{K}_{k=1} - V_{\pi_k}(z;\theta),</code>
</p>
<p> where <code class="reqn">V_{\pi}</code> represents the partial derivative(s) of <code class="reqn">V(z;\theta)</code> with respect to <code class="reqn">\pi</code>.
</p>
<p>When <code>jw=d</code> the full Stephenson-Tawn likelihood is considered whereas for values lower than <code class="reqn">d</code> a composite likelihood approach is taken. 
</p>
<p>The argument <code>thresh</code> is required when the composite likelihood is used. A tuple of size <code>jw</code>, is assigned a weight of one if the maximum pairwise distance between corresponding locations is less that <code>thresh</code> and a weight of zero otherwise.
</p>
<p>Arguments <code>args1</code> and <code>args2</code> relate to specifications of the Monte Carlo simulation scheme to compute multivariate CDF evaluations. These should take the form of lists including the minimum and maximum number of simulations used (<code>Nmin</code> and <code>Nmax</code>), the absolute error (<code>eps</code>) and whether the error should be controlled on the log-scale (<code>logeps</code>).
</p>


<h3>Value</h3>

<p>A list comprising of the vector of estimated parameters (<code>est</code>), the composite likelihood order (<code>jw</code>), the maximised log-likelihood value (<code>LL</code>). In addition, if <code>sandwich=TRUE</code> the the standard errors from the sandwich information matrix are reported via <code>stderr.sand</code> as well as the TIC for model selection (<code>TIC</code>). Finally, if the composite likelihood is considered, a matrix with all tuples considered with a weight of 1 are reported in <code>cmat</code>. 
</p>


<h3>Author(s)</h3>

<p>Simone Padoan, <a href="mailto:simone.padoan@unibocconi.it">simone.padoan@unibocconi.it</a>,
<a href="https://faculty.unibocconi.it/simonepadoan/">https://faculty.unibocconi.it/simonepadoan/</a>;
Boris Beranger, <a href="mailto:borisberanger@gmail.com">borisberanger@gmail.com</a>
<a href="https://www.borisberanger.com">https://www.borisberanger.com</a>;
</p>


<h3>References</h3>

<p>Beranger, B., Stephenson, A. G. and Sisson, S.A. (2021)
High-dimensional inference using the extremal skew-t process
<em>Extremes</em>, <b>24</b>, 653-685.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fExtDepSpat">fExtDepSpat</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(14342)

# Simulation of 20 locations
Ns &lt;- 20
sites &lt;- matrix(runif(Ns*2)*10-5,nrow=Ns,ncol=2)
for(i in 1:2) sites[,i] &lt;- sites[,i] - mean(sites[,i])

# Simulation of 50 replicates from the Extremal-t model
Ny &lt;- 50
z &lt;- rExtDepSpat(Ny, sites, model="ET", cov.mod="powexp", DoF=1, 
                 range=3, nugget=0, smooth=1.5, 
                 control=list(method="exact"))
                 
# Fit the extremal-t using the full Stephenson-Tawn likelihood
args1 &lt;- list(Nmax=50L, Nmin=5L, eps=0.001, logeps=FALSE)
args2 &lt;- list(Nmax=500L, Nmin=50L, eps=0.001, logeps=TRUE)
## Not run: 
fit1 &lt;- fExtDepSpat(model="ET", z=z$vals, sites=sites, hit=z$hits,
                    par0=c(3,1,1), parallel=TRUE, ncores=6,
                    args1=args1, args2=args2, control = list(trace=0))
fit1$est

## End(Not run)
</code></pre>

<hr>
<h2 id='fGEV'>Fitting of the Generalized Extreme Value Distribution</h2><span id='topic+fGEV'></span>

<h3>Description</h3>

<p>Maximum-likelihood and Metropolis-Hastings algorithm for the estimation of the generalized extreme value distribution.</p>


<h3>Usage</h3>

<pre><code class='language-R'>fGEV(data, par.start, method="Frequentist", u, cov, 
     optim.method="BFGS", optim.trace=0, sig0, nsim)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fGEV_+3A_data">data</code></td>
<td>
<p>A vector representing the data, which may contain missing values.</p>
</td></tr>
<tr><td><code id="fGEV_+3A_par.start">par.start</code></td>
<td>
<p>A vector of length <code class="reqn">3</code> giving the starting values for the parameters to be estimated. If missing, moment estimates are used.</p>
</td></tr>
<tr><td><code id="fGEV_+3A_method">method</code></td>
<td>
<p>A character string indicating whether the estimation is done following a <code>"Frequentist"</code> or <code>"Bayesian"</code> approach.</p>
</td></tr>
<tr><td><code id="fGEV_+3A_u">u</code></td>
<td>
<p>A real indicating a high threshold. If supplied a threshld exceedance approach is taken and computations use the censored likelihood. If missing, a block maxima approach is taken and the regular GEV likelihood is used.</p>
</td></tr>
<tr><td><code id="fGEV_+3A_cov">cov</code></td>
<td>
<p>A matrix of covariates to define a linear model for the location parameter.</p>
</td></tr>
<tr><td><code id="fGEV_+3A_optim.method">optim.method</code></td>
<td>
<p>The optimization method to be used. Required when <code>method="Frequentist"</code>. See <code><a href="stats.html#topic+optim">optim</a></code> for more details.</p>
</td></tr>
<tr><td><code id="fGEV_+3A_optim.trace">optim.trace</code></td>
<td>
<p>A non-negative interger tracing the progress of the optimization. Required when <code>method="Frequentist"</code>. See <code><a href="stats.html#topic+optim">optim</a></code> for more details.</p>
</td></tr>
<tr><td><code id="fGEV_+3A_sig0">sig0</code></td>
<td>
<p>Positive reals representing the initial value for the scaling parameter of the multivariate normal proposal distribution for both margins. Required when <code>method="Bayesian"</code>.</p>
</td></tr>
<tr><td><code id="fGEV_+3A_nsim">nsim</code></td>
<td>
<p>An integer indicating the number of iterations in the Metropolis-Hastings algorithm. Required when <code>method="Bayesian"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When <code>cov</code> is a vector of ones then the location parameter <code class="reqn">\mu</code> is constant. On the contrary, when <code>cov</code> is provided, it represents the design matrix for the linear model on <code class="reqn">\mu</code> (the number of columns in the matrix indicates the number of linear predictors).
When <code>u=NULL</code> or missing, the likelihood function is given by </p>
<p style="text-align: center;"><code class="reqn">\prod_{i=1}^{n}g(x_i; \mu, \sigma, \xi)</code>
</p>
<p> where <code class="reqn">g(\cdot;\mu,\sigma,\xi)</code> represents the GEV pdf, whereas when a threshold value is set the likelihood is given by </p>
<p style="text-align: center;"><code class="reqn">k_n \log\left( G(u;\mu,\sigma,\xi) \right) \times \prod_{i=1}^n \frac{\partial}{\partial x}G(x;\mu,\sigma,\xi)|_{x=x_i} </code>
</p>
<p> where <code class="reqn">G(\cdot;\mu,\sigma,\xi)</code> is the GEV cdf and <code class="reqn">k_n</code> is the empirical estimate of the probability of being greater than the threshold <code>u</code>. 
</p>
<p>Note that the case <code class="reqn">\xi&lt;=0</code> is not yet considered when <code>u</code> is considered.
</p>
<p>The choice <code>method="Bayesian"</code> applies a random walk Metropolis-Hastings algorithm as described in Section 3.1 and Step 1 and 2 of Algorithm 1 from Beranger et al. (2021). The algorithm may restart for several reasons including if the proposed value of the parameters changes too much from the current value (see Garthwaite et al. (2016) for more details.)
</p>
<p>The choice <code>method="Frequentist"</code> uses the <code><a href="stats.html#topic+optim">optim</a></code> function to find the maximum likelihood estimator.
</p>


<h3>Value</h3>

<p>When <code>method="Frequentist"</code> the routine returns a list including the parameter estimates (<code>est</code>) and associated variance-covariance matrix (<code>varcov</code>) and standard errors (<code>stderr</code>).
When <code>method="Bayesian"</code> the routine returns a list including
</p>

<ul>
<li><p><code>param_post</code>the parameter posterior sample;
</p>
</li>
<li><p><code>accepted</code>a binary vector indicating which proposal was accepted; 
</p>
</li>
<li><p><code>straight.reject</code>a binary vector indicating which proposal were rejected straight away given that the proposal is a multivariate normal and there are conditions on the parameter values;
</p>
</li>
<li><p><code>nsim</code>the number of simulations in the algorithm;
</p>
</li>
<li><p><code>sig.vec</code>the vector of updated scaling parameter in the multivariate normal porposal distribution at each iteration;
</p>
</li>
<li><p><code>sig.restart</code>the value of the scaling parameter in the multivariate normal porposal distribution when the algorithm needs to restart;
</p>
</li>
<li><p><code>acc.vec</code>a vector of acceptance probabilities at each iteration.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Simone Padoan, <a href="mailto:simone.padoan@unibocconi.it">simone.padoan@unibocconi.it</a>,
<a href="https://faculty.unibocconi.it/simonepadoan/">https://faculty.unibocconi.it/simonepadoan/</a>;
Boris Beranger, <a href="mailto:borisberanger@gmail.com">borisberanger@gmail.com</a>
<a href="https://www.borisberanger.com">https://www.borisberanger.com</a>;
</p>


<h3>References</h3>

<p>Beranger, B., Padoan, S. A. and Sisson, S. A. (2021).
Estimation and uncertainty quantification for extreme quantile regions.
<em>Extremes</em>, <b>24</b>, 349-375.
</p>
<p>Garthwaite, P. H., Fan, Y. and Sisson S. A. (2016). 
Adaptive optimal scaling of Metropolis-Hastings algorithms using the Robbins-Monro process. 
<em>Communications in Statistics - Theory and Methods</em>, <b>45</b>(17), 5098-5111.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+dGEV">dGEV</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
##################################################
### Example - Pollution levels in Milan, Italy ###
##################################################

data(MilanPollution)

# Frequentist estimation
fit &lt;- fGEV(Milan.winter$PM10)
fit$est

# Bayesian estimation with high threshold
cov &lt;- cbind(rep(1,nrow(Milan.winter)), Milan.winter$MaxTemp, 
             Milan.winter$MaxTemp^2)
u &lt;- quantile(Milan.winter$PM10, prob=0.9, type=3, na.rm=TRUE)

  fit2 &lt;- fGEV(data=Milan.winter$PM10, par.start=c(50,0,0,20,1), 
               method="Bayesian", u=u, cov=cov, sig0=0.1, nsim=5e+4) 

</code></pre>

<hr>
<h2 id='heat'>Summer temperature maxima in Melbourne, Australia between 1961 and 2010.</h2><span id='topic+heat'></span><span id='topic+heatdata'></span><span id='topic+locgrid'></span><span id='topic+mellat'></span><span id='topic+mellon'></span><span id='topic+scalegrid'></span><span id='topic+shapegrid'></span>

<h3>Description</h3>

<p>The dataset corresponds to the summer maxima taken over the period from August to April inclusive, recorded between 1961 and 2010 at 90 stations on a 0.15 degree grid in a 9 by 10 formation.</p>


<h3>Details</h3>

<p>The first maximum is taken over the August 1961 to April 1962 period, and the last maximum is taken over the August 2010 to April 2011 period. The object <code>heatdata</code> contains the core of the data:
</p>

<ul>
<li><p><code>vals</code>: A <code class="reqn">50*90</code> matrix containing the <code class="reqn">50</code> summer maxima at the <code class="reqn">90</code> locations.
</p>
</li>
<li><p><code>sitesLL: </code>A <code class="reqn">90*2</code> matrix containing the sites locations in Latitude-Longitude, recentred (means have been substracted).
</p>
</li>
<li><p><code>sitesEN: </code>A <code class="reqn">90*2</code> matrix containing the sites locations in Eastings-Northings, recentred (means have been substracted).
</p>
</li>
<li><p><code>vals</code>: A <code class="reqn">50*90</code> matrix containing integers indicating the &ldquo;heatwave&rdquo; number of each of the <code class="reqn">50</code> summer maxima at all <code class="reqn">90</code> locations. Locations on the same row with the same integer indicates that they were obtained from the same heatwave. Heatwaves are defined over a three day window.
</p>
</li>
<li><p><code>sitesLLO: </code>A <code class="reqn">90*2</code> matrix containing the sites locations in Latitude-Longitude, on the original scale.
</p>
</li>
<li><p><code>sitesENO: </code>A <code class="reqn">90*2</code> matrix containing the sites locations in Eastings-Northings, on the original scale.
</p>
</li>
<li><p><code>ufvals</code>: A <code class="reqn">50*90</code> matrix containing the <code class="reqn">50</code> summer maxima at the <code class="reqn">90</code> locations, on the unit Frechet scale.
</p>
</li></ul>

<p>Standardisation to unit Frechet is performed as in Beranger et al. (2021) by fitting the GEV distribution marginally using unconstrained location and shape parameters and the shape parameter to be a linear function of eastings and northings in 100 kilometre units. The resulting estimates are given in the objects <code>locgrid</code>, <code>scalegrid</code> and <code>shapegrid</code>, which are <code class="reqn">10*9</code> matrices.
</p>
<p>Details about the study region are given in <code>mellat</code> and <code>mellon</code>, vectors of length <code class="reqn">10</code> and <code class="reqn">11</code> which give the latitude and longitude coordinates of the grid.
</p>


<h3>References</h3>

<p>Beranger, B., Stephenson, A. G. and Sisson, S.A. (2021)
High-dimensional inference using the extremal skew-t process
<em>Extremes</em>, <b>24</b>, 653-685.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>image(x=mellon, y=mellat, z=locgrid)
points(heatdata$sitesLLO, pch=16)
</code></pre>

<hr>
<h2 id='index.ExtDep'>Index of extremal dependence</h2><span id='topic+index.ExtDep'></span>

<h3>Description</h3>

<p>This function computes the extremal coefficient, Pickands dependence function and the coefficients of upper and lower tail dependence for several parametric models and the lower tail dependence function for the bivairate skew-normal distribution.</p>


<h3>Usage</h3>

<pre><code class='language-R'>index.ExtDep(object, model, par, x, u)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="index.ExtDep_+3A_object">object</code></td>
<td>
<p>A character string indicating the index of extremal dependence to compute, including the extremal coefficient <code>"extremal"</code>, the Pickands dependence function <code>"pickands"</code>, the coefficient of upper tail dependence <code>"upper.tail"</code> and the coefficient of lower tail dependence <code>"lower.tail"</code>.</p>
</td></tr>
<tr><td><code id="index.ExtDep_+3A_model">model</code></td>
<td>
<p>A character string indicating the model/distribution. When <code>object="extremal"</code>, <code>"pickands"</code> or <code>"upper.tail"</code> corresponding quantities can be calculated for the Husler-Reiss (<code>"HR"</code>), extremal-t (<code>"ET"</code>) and extremal skew-t (<code>"EST"</code>) are available. When <code>object="lower.tail"</code> then the extremal-t (<code>"ET"</code>) and extremal skew-t (<code>"EST"</code>) models are available as well as the skew-normal distribution (<code>"SN"</code>).</p>
</td></tr>
<tr><td><code id="index.ExtDep_+3A_par">par</code></td>
<td>
<p>A vector indicating the parameter values of the corresponding model/distribution.</p>
</td></tr>
<tr><td><code id="index.ExtDep_+3A_x">x</code></td>
<td>
<p>A vector on the bivariate or trivariate unit simplex indicating where to evaluate the Pickands dependence function.</p>
</td></tr>
<tr><td><code id="index.ExtDep_+3A_u">u</code></td>
<td>
<p>A real in <code class="reqn">[0,1]</code> indicating the value at which to evaluate the lower tail dependence function of the bivariate skew-normal distribution.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The extremal coefficient is defined as </p>
<p style="text-align: center;"><code class="reqn">\theta = V(1,\ldots,1) = d \int_{W} \max_{j \in \left\{1, ..., d\right\} }(w_j) dH(w) = - \log G(1,\ldots,1),</code>
</p>
<p> where <code class="reqn">W</code> represents the unit simplex, <code class="reqn">V</code> is the exponent function and <code class="reqn">G(\cdot)</code> the distribution function of a multivariate extreme value model. Bivariate and trivariate versions are available.
</p>
<p>The Pickands dependence function is defined as <code class="reqn">A(x) = - \log G(1/x)</code> for <code class="reqn">x</code> in the bivariate/trivariate simplex (<code class="reqn">W</code>). 
</p>
<p>The coefficient of upper tail dependence is defined as </p>
<p style="text-align: center;"><code class="reqn">\vartheta = R(1,\ldots,1) = d \int_{W} \min_{j \in \left\{1, ..., d\right\} }(w_j) dH(w).</code>
</p>
<p> In the bivariate case, using the inclusion-exclusion principle this reduces to <code class="reqn">\vartheta =  2 + \log G(1,1) = 2 - V(1,1)</code>.
</p>
<p>For the skew-normal distribution, the lower tail dependence function is defined as in Bortot (2010). This is an approximation where the tail dependence is obtained in the limiting case where <code>u</code>u goes to eqn11. The <code>par</code> argument should be a vector of length <code class="reqn">3</code> comprising of the correlation parameter, between <code class="reqn">-1</code> and <code class="reqn">1</code> and two real-valued skewness parameters.
</p>


<h3>Value</h3>

<p>When <code>object="extremal"</code>, returns a value between <code class="reqn">1</code> and <code class="reqn">d</code> (<code class="reqn">d=2,3</code>). <br />
When <code>object="pickands"</code>, returns a value between <code class="reqn">\max(x)</code> and <code class="reqn">1</code>. <br />
When <code>object="upper.tail"</code>, returns a value between <code class="reqn">0</code> and <code class="reqn">1</code>. <br />
When <code>object="lower.tail"</code>, returns a value between <code class="reqn">-1</code> and <code class="reqn">1</code>.
</p>


<h3>Author(s)</h3>

<p>Simone Padoan, <a href="mailto:simone.padoan@unibocconi.it">simone.padoan@unibocconi.it</a>,
<a href="https://faculty.unibocconi.it/simonepadoan/">https://faculty.unibocconi.it/simonepadoan/</a>;
Boris Beranger, <a href="mailto:borisberanger@gmail.com">borisberanger@gmail.com</a>
<a href="https://www.borisberanger.com">https://www.borisberanger.com</a>;
</p>


<h3>References</h3>

<p>Bortot, P. (2010)
Tail dependence in bivariate skew-normal and skew-t distributions.
<em>Unpublished</em>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#############################
### Extremal skew-t model ###
#############################

### Extremal coefficient
index.ExtDep(object="extremal", model="EST", par=c(0.5,1,-2,2))

### Pickands dependence function
w &lt;- seq(0.00001, .99999, length=100)
pick &lt;- vector(length=100)
for(i in 1:100){
  pick[i] &lt;- index.ExtDep(object="pickands", model="EST", par=c(0.5,1,-2,2), 
                          x=c(w[i],1-w[i]))
}

plot(w, pick, type="l", ylim=c(0.5, 1), ylab="A(t)", xlab="t")
polygon(c(0, 0.5, 1), c(1, 0.5, 1), lwd=2, border = 'grey')

### Upper tail dependence coefficient
index.ExtDep(object="upper.tail", model="EST", par=c(0.5,1,-2,2))

### Lower tail dependence coefficient
index.ExtDep(object="lower.tail", model="EST", par=c(0.5,1,-2,2))

################################
### Skew-normal distribution ###
################################

### Lower tail dependence function
index.ExtDep(object="lower.tail", model="SN", par=c(0.5,1,-2), u=0.5)

</code></pre>

<hr>
<h2 id='logReturns'>Monthly maxima of log-return exchange rates of the Pound Sterling (GBP) against the US dollar (USD) and the Japanese yen (JPY), between March 1991 and December 2014.</h2><span id='topic+logReturns'></span>

<h3>Description</h3>

<p>The dataset <code>logReturns</code> contains 4 columns: <code>date_USD</code> and <code>USD</code> give the date of the monthly maxima of the log-return exchange rate GBP/USD and its value while <code>date_JPY</code> and <code>JPY</code> give the date of the monthly maxima of the log-return exchange rate GBP/JPY and its value.</p>


<h3>Format</h3>

<p>A <code class="reqn">286*4</code> matrix. The first and third columns are objects of type <code>"character"</code> while the second and fourth columns are of type <code>"numeric"</code>.</p>

<hr>
<h2 id='madogram'>Madogram-based estimation of the Pickands Dependence Function</h2><span id='topic+madogram'></span>

<h3>Description</h3>

<p>Computes a non-parametric estimate Pickands dependence function, <code class="reqn">A(w)</code> for multivariate data, based on the madogram estimator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  madogram(w, data, margin = c("emp","est","exp","frechet","gumbel"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="madogram_+3A_w">w</code></td>
<td>
<p><code class="reqn">(m \times d)</code> design matrix (see <b>Details</b>).</p>
</td></tr>
<tr><td><code id="madogram_+3A_data">data</code></td>
<td>
<p><code class="reqn">(n \times d)</code> matrix of data or data frame with <code>d</code> columns. <code>d</code> is the numer of variables and <code>n</code> is the number of replications.</p>
</td></tr>
<tr><td><code id="madogram_+3A_margin">margin</code></td>
<td>
<p>string, denoting the type marginal distributions (<code>margin="emp"</code> by default, see <b>Details</b>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The estimation procedure is based on the madogram as proposed in Marcon et al. (2017). The madogram is defined by
</p>
<p><code class="reqn">
\nu(\bold{w}) =
{\rm E} \left(\
\bigvee_{i=1,\dots,d}\left \lbrace F^{1/w_i}_{i}\left(X_{i}\right)  \right\rbrace -
\frac{1}{d}\sum_{i=1,\dots,d}F^{1/w_i}_{i}\left(X_{i}\right).
\right),
</code>
</p>
<p>where <code class="reqn">0&lt;w_i&lt;1</code> and <code class="reqn">w_d=1-(w_1+\ldots+w_{d-1})</code>.
</p>
<p>Each row of the design matrix <code>w</code> is a point in the unit
<code>d</code>-dimensional simplex.
</p>
<p>If <code class="reqn">X</code> is a <code>d</code>-dimensional max-stable distributed random vector, with exponent measure function <code class="reqn">V(\bold{x})</code> and Pickands dependence function <code class="reqn">A(\bold{w})</code>, then
</p>
<p><code class="reqn">\nu(\bold{w})=V(1/w_1,\ldots,1/w_d)/(1+V(1/w_1,\ldots,1/w_d))-c(\bold{w}),</code>
where <code class="reqn">c(\bold{w})=d^{-1}\sum_{i=1}^{d}{w_i/(1+w_i)}</code>.
</p>
<p>From this, it follows that
</p>
<p><code class="reqn">
V(1/w_1,\ldots,1/w_d)=\frac{\nu(\bold{w})+c(\bold{w})}{1-\nu(\bold{w})-c(\bold{w})},
</code>
</p>
<p>and
</p>
<p><code class="reqn">
A(\bold{w})=\frac{\nu(\bold{w})+c(\bold{w})}{1-\nu(\bold{w})-c(\bold{w})}.
</code>
</p>
<p>An empirical transformation of the marginals is performed when <code>margin="emp"</code>.
A max-likelihood fitting of the GEV distributions is implemented when <code>margin="est"</code>.
Otherwise it refers to marginal parametric GEV theorethical distributions (<code>margin="exp", "frechet", "gumbel"</code>).
</p>


<h3>Value</h3>

<p>A numeric vector of estimates.
</p>


<h3>Author(s)</h3>

<p>Simone Padoan, <a href="mailto:simone.padoan@unibocconi.it">simone.padoan@unibocconi.it</a>,
<a href="https://faculty.unibocconi.it/simonepadoan/">https://faculty.unibocconi.it/simonepadoan/</a>;
Boris Beranger, <a href="mailto:borisberanger@gmail.com">borisberanger@gmail.com</a>
<a href="https://www.borisberanger.com">https://www.borisberanger.com</a>;
Giulia Marcon, <a href="mailto:giuliamarcongm@gmail.com">giuliamarcongm@gmail.com</a>
</p>


<h3>References</h3>

<p>Marcon, G., Padoan, S.A., Naveau, P., Muliere, P. and Segers, J. (2017)
Multivariate Nonparametric Estimation of the Pickands Dependence
Function using Bernstein Polynomials.
<em>Journal of Statistical Planning and Inference</em>, <b>183</b>, 1-17.
</p>
<p>Naveau, P., Guillou, A., Cooley, D., Diebolt, J. (2009)
Modelling pairwise dependence of maxima in space,
Biometrika, <b>96</b>(1), 1-17.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+beed">beed</a></code>, <code><a href="#topic+beed.confband">beed.confband</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- simplex(2)
data &lt;- evd::rbvevd(50, dep = 0.4, model = "log", mar1 = c(1,1,1))

Amd &lt;- madogram(x, data, "emp")
Amd.bp &lt;- beed(data, x, 2, "md", "emp", 20, plot=TRUE)

lines(x[,1], Amd, lty = 1, col = 2)
</code></pre>

<hr>
<h2 id='MilanPollution'>Pollution data for summer and winter months in Milan, Italy.</h2><span id='topic+MilanPollution'></span><span id='topic+Milan.winter'></span><span id='topic+Milan.summer'></span>

<h3>Description</h3>

<p>Two datasets <code>Milan.summer</code> and <code>Milan.winter</code>, each containing 5 air pollutants: daily maximum of NO2, NO, O3 and SO2, daily mean of PM10; and 6 meteorological covariates: maximum precipitation, maximum temperature, maximum humidity, mean precipitation, mean temperature and mean humidity.</p>


<h3>Format</h3>

<p>A <code class="reqn">1968*12</code> data frame and a <code class="reqn">1924*12</code> data frame.</p>


<h3>Details</h3>

<p>The summer period corresponds to the period 30 April - 30 August between 2003 and 2017 and thus the dataset contains <code class="reqn">1968</code> observations. The winter period corresponds to the period 32 November - 27(28) February. The records start from 31 December 2001 until 30 December 2017 and thus the dataset contains <code class="reqn">1924</code> observations.</p>

<hr>
<h2 id='pExtDep'>Parametric and non-parametric distribution function of Extremal Dependence</h2><span id='topic+pExtDep'></span>

<h3>Description</h3>

<p>This function evaluates the distribution function of parametric multivariate extreme distributions and the angular probability distribution represented through Bernstein polynomials.</p>


<h3>Usage</h3>

<pre><code class='language-R'>pExtDep(q, type, method="Parametric", model, par, plot=TRUE, 
        main, xlab, cex.lab, cex.axis, lwd,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pExtDep_+3A_q">q</code></td>
<td>
<p>A vector or matrix of quantiles.</p>
</td></tr>
<tr><td><code id="pExtDep_+3A_type">type</code></td>
<td>
<p>A character string taking value <code>"lower"</code>, <code>"inv.lower"</code> or <code>"upper"</code>. Required when <code>method="Parametric"</code>. </p>
</td></tr>
<tr><td><code id="pExtDep_+3A_method">method</code></td>
<td>
<p>A character string taking value <code>"Parametric"</code> or <code>"NonParametric"</code></p>
</td></tr>
<tr><td><code id="pExtDep_+3A_model">model</code></td>
<td>
<p>A character string with the name of the model: <code>"HR"</code> (Husler-Reiss), <code>"ET"</code> (Extremal-t) or <code>"EST"</code> (Extremal Skew-t). Required when <code>method="Parametric"</code>. </p>
</td></tr>
<tr><td><code id="pExtDep_+3A_par">par</code></td>
<td>
<p>A vector or a matrix representing the parameters of the (parametric or non-parametric) model. When in matrix format, rows indicate different sets of parameter values.</p>
</td></tr>
<tr><td><code id="pExtDep_+3A_plot">plot</code></td>
<td>
<p>A logical value; if <code>TRUE</code> (default) a plot is displayed. See <b>details</b>.</p>
</td></tr>
<tr><td><code id="pExtDep_+3A_main">main</code>, <code id="pExtDep_+3A_xlab">xlab</code>, <code id="pExtDep_+3A_cex.lab">cex.lab</code>, <code id="pExtDep_+3A_cex.axis">cex.axis</code>, <code id="pExtDep_+3A_lwd">lwd</code></td>
<td>
<p>Arguments of the <code>hist()</code> function.</p>
</td></tr>
<tr><td><code id="pExtDep_+3A_...">...</code></td>
<td>
<p>Additional graphical parameter when <code>plot=TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that when <code>method="Parametric"</code>, the distribution function is only available in 2 and 3 dimensions. Refer to the <code><a href="#topic+dim_ExtDep">dim_ExtDep</a></code> function for the appropriate length of the parameter vector. <br />
When <code>type="lower"</code>, the cumulative distribution function is computed, i.e., </p>
<p style="text-align: center;"><code class="reqn">G(\boldsymbol{x}) = P\left(\boldsymbol{X} \leq \boldsymbol{x}\right), x \in R^d, d=2,3.</code>
</p>
 <p><br />
When <code>type="inv.lower"</code>, the survival function is computed, i.e., </p>
<p style="text-align: center;"><code class="reqn">1-G(\boldsymbol{x}) = 1-P\left(\boldsymbol{X} \leq \boldsymbol{x}\right).</code>
</p>
<p> This corresponds to the probability of at least one component of <code class="reqn">X</code> is greater than its corresponding element in <code class="reqn">x</code>. <br />
When <code>type="upper"</code>, the joint probability of exceedance is computed, i.e., </p>
<p style="text-align: center;"><code class="reqn">P\left(\boldsymbol{X} \geq \boldsymbol{x}\right).</code>
</p>
 <p><br />
Finally, when <code>method="NonParametric"</code>, the distribution function is only available in 2 dimensions.<br />
</p>
<p>The argument <code>plot</code> is only applicable when <code>par</code> is a matrix. Typically its main use should be when <code>par</code> corresponds to some posterior sample (e.g. from <code>fExtDep</code> with <code>moethod="BayesianPPP"</code>). A histogram of the probabilities evaluated at each set of parameters is displayed, as well as a kernel density estimator, <code class="reqn">2.5\%, 50\%, 97.5\%</code> quantiles (crosses) and mean (dot). The argument <code>...</code> is used to specify additional parameters in the <code>hist()</code> function.
</p>


<h3>Value</h3>

<p>When <code>par</code> is a vector: if <code>q</code> is a matrix the function returns a vector of length <code>nrow(q)</code>, otherwise a scalar. <br />
When <code>par</code> is a matrix: if <code>q</code> is a matrix the function returns a matrix with <code>nrow(par)</code> rows and <code>nrow(q)</code> columns, otherwise a vector of length <code>nrow(par)</code>. 
</p>


<h3>Author(s)</h3>

<p>Simone Padoan, <a href="mailto:simone.padoan@unibocconi.it">simone.padoan@unibocconi.it</a>,
<a href="https://faculty.unibocconi.it/simonepadoan/">https://faculty.unibocconi.it/simonepadoan/</a>;
Boris Beranger, <a href="mailto:borisberanger@gmail.com">borisberanger@gmail.com</a>
<a href="https://www.borisberanger.com">https://www.borisberanger.com</a>;
</p>


<h3>References</h3>

<p>Beranger, B. and Padoan, S. A. (2015).
Extreme dependence models, chapater of the book <em>Extreme Value Modeling and Risk Analysis: Methods and Applications</em>,
<b>Chapman Hall/CRC</b>.
</p>
<p>Beranger, B., Padoan, S. A. and Sisson, S. A. (2017).
Models for extremal dependence derived from skew-symmetric families.
<em>Scandinavian Journal of Statistics</em>, <b>44</b>(1), 21-45.
</p>
<p>Husler, J. and Reiss, R.-D. (1989),
Maxima of normal random vectors: between independence and complete dependence,
<em>Statistics and Probability Letters</em>, <b>7</b>, 283&ndash;286.
</p>
<p>Marcon, G., Padoan, S.A., Naveau, P., Muliere, P. and Segers, J. (2017)
Multivariate Nonparametric Estimation of the Pickands Dependence
Function using Bernstein Polynomials.
<em>Journal of Statistical Planning and Inference</em>, <b>183</b>, 1-17.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dExtDep">dExtDep</a></code>, <code><a href="#topic+rExtDep">rExtDep</a></code>, <code><a href="#topic+fExtDep">fExtDep</a></code>, <code><a href="#topic+fExtDep.np">fExtDep.np</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example using the trivariate Extremal Skew-t
pExtDep(q=c(1,1.2, 0.6), type="lower", method="Parametric", 
        model="EST", par=c(0.2, 0.4, 0.6,2,2,2,1))

# Example using the bivariate Extremal-t
pExtDep(q=rbind(c(1.2, 0.6), c(1.1, 1.3)), type="inv.lower", 
        method="Parametric", model="ET", par=c(0.2, 1))
pExtDep(q=rbind(c(1.2, 0.6), c(1.1, 1.3)), type="inv.lower", 
        method="Parametric", model="EST", par=c(0.2, 0, 0, 1))

# Example of non-parametric angular density
beta &lt;- c(1.0000000, 0.8714286, 0.7671560, 0.7569398, 
          0.7771908, 0.8031573, 0.8857143, 1.0000000)
pExtDep(q=rbind(c(0.1,0.9),c(0.2,0.8)), method="NonParametric", par=beta)

</code></pre>

<hr>
<h2 id='pFailure'>Probability of falling into a failure region</h2><span id='topic+pFailure'></span>

<h3>Description</h3>

<p>This function computes the empirical estimate of the probability of falling into two types of failure regions.</p>


<h3>Usage</h3>

<pre><code class='language-R'>pFailure(n, beta, u1, u2, mar1, mar2, type, plot, xlab, ylab, 
         nlevels=10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pFailure_+3A_n">n</code></td>
<td>
<p>An integer indicating the number of points generated to compute the empirical probability.</p>
</td></tr>
<tr><td><code id="pFailure_+3A_beta">beta</code></td>
<td>
<p>A vector representing the Bernstein polynomial coefficients.</p>
</td></tr>
<tr><td><code id="pFailure_+3A_u1">u1</code>, <code id="pFailure_+3A_u2">u2</code></td>
<td>
<p>Vectors of positive reals representing some high thresholds.</p>
</td></tr>
<tr><td><code id="pFailure_+3A_mar1">mar1</code>, <code id="pFailure_+3A_mar2">mar2</code></td>
<td>
<p>Vectors of marginal (GEV) parameters</p>
</td></tr>
<tr><td><code id="pFailure_+3A_type">type</code></td>
<td>
<p>A character string indicating if the failure region includes at least one exceedance (<code>"or"</code>), or both exceednaces (<code>"and"</code>). If <code>"both"</code> then probabilities to fall in both regions are computed.</p>
</td></tr>
<tr><td><code id="pFailure_+3A_plot">plot</code></td>
<td>
<p>A logical value; if <code>TRUE</code> contour plots of the probalities are displayed.</p>
</td></tr>
<tr><td><code id="pFailure_+3A_xlab">xlab</code>, <code id="pFailure_+3A_ylab">ylab</code></td>
<td>
<p>A character string equivalent representing the graphical parameters as in <code>par</code>.</p>
</td></tr>
<tr><td><code id="pFailure_+3A_nlevels">nlevels</code></td>
<td>
<p>The number of contour levels to be displayed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The two failure regions are:
</p>
<p style="text-align: center;"><code class="reqn">A_u = \left\{ (v_1, v_2): v_1&gt;u_1 \textrm{ or } v_2 &gt; u_2\right\} </code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">B_u = \left\{ (v_1, v_2): v_1&gt;u_1 \textrm{ and } v_2 &gt; u_2\right\} </code>
</p>

<p>where <code class="reqn">(v_1,v_2) \in R_+^2</code> and <code class="reqn">u_1, u_2&gt;0</code>.
</p>
<p>Exceedances samples <code class="reqn">y_{1,1}, \ldots, y_{n_1}</code> and <code class="reqn">y_{1,2}, \ldots, y_{n_2}</code> are generating according to Algorithm 3 of Marcon et al. (2017) and the the estimates of the probability of falling in <code class="reqn">A_u</code> and <code class="reqn">B_u</code> are given by
</p>
<p style="text-align: center;"><code class="reqn">\hat{P}_{A_u} = \frac{1}{n}\sum{i=1}^n I\left\{ y_{i,1}&gt; u_1^* \textrm{ or } y_{i,2}&gt; u_2^* \right\} </code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">\hat{P}_{B_u} = \frac{1}{n}\sum{i=1}^n I\left\{ y_{i,1}&gt; u_1^* \textrm{ and } y_{i,2}&gt; u_2^* \right\} </code>
</p>



<h3>Value</h3>

<p>A list containing <code>AND</code> and/or <code>OR</code>, depending on the <code>type</code> argument. Each element is a <code>length(u1) x length(u2)</code> matrix.   
</p>


<h3>Author(s)</h3>

<p>Simone Padoan, <a href="mailto:simone.padoan@unibocconi.it">simone.padoan@unibocconi.it</a>,
<a href="https://faculty.unibocconi.it/simonepadoan/">https://faculty.unibocconi.it/simonepadoan/</a>;
Boris Beranger, <a href="mailto:borisberanger@gmail.com">borisberanger@gmail.com</a>
<a href="https://www.borisberanger.com">https://www.borisberanger.com</a>;
</p>


<h3>References</h3>

<p>Marcon, G., Naveau, P. and Padoan, S.A. (2017)
A semi-parametric stochastic generator for bivariate extreme events
<em>Stat</em>, <b>6</b>, 184-201.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dExtDep">dExtDep</a></code>, <code><a href="#topic+rExtDep">rExtDep</a></code>, <code><a href="#topic+fExtDep">fExtDep</a></code>, <code><a href="#topic+fExtDep.np">fExtDep.np</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example wind speed and wind gust

data(WindSpeedGust)
years &lt;- format(ParcayMeslay$time, format="%Y")
attach(ParcayMeslay[which(years %in% c(2004:2013)),])
  
WS_th &lt;- quantile(WS,.9)
DP_th &lt;- quantile(DP,.9)
  
pars.WS &lt;- evd::fpot(WS, WS_th, model="pp")$estimate
pars.DP &lt;- evd::fpot(DP, DP_th, model="pp")$estimate
  
data_uf &lt;- trans2UFrechet(cbind(WS,DP), type="Empirical")
  
rdata &lt;- rowSums(data_uf)
r0 &lt;- quantile(rdata, probs=.90)
extdata &lt;- data_uf[rdata&gt;=r0,]
  
SP_mle &lt;- fExtDep.np(method="Frequentist", data=extdata, k0=10, 
                     type="maxima")


  pF &lt;- pFailure(n=50000, beta=SP_mle$Ahat$beta,
                 u1=seq(from=19, to=28, length=200), mar1=pars.WS,
                 u2=seq(from=40, to=60, length=200), mar2=pars.DP, 
                 type="both", plot=TRUE, 
                 xlab="Daily-maximum Wind Speed (m/s)",
                 ylab="Differential of Pressure (mbar)", nlevels=15)


</code></pre>

<hr>
<h2 id='plot_ExtDep'>Graphical summaries of parametric representations of extremal dependence.</h2><span id='topic+plot_ExtDep'></span>

<h3>Description</h3>

<p>This function displays the angular density, Pickands dependence function and return levels for bivariate and trivariate extreme values models.</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_ExtDep(object="angular", model, par, log=TRUE, data=NULL, contour=TRUE, 
            style, labels, cex.dat=1, cex.lab=1, cex.cont=1, 
            Q.fix, Q.range, Q.range0, cond=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_ExtDep_+3A_object">object</code></td>
<td>
<p>A character string indicating which graphical summary to plot. Takes value <code>"angular"</code> (default) <code>"pickands"</code> or<code>"returns"</code>.</p>
</td></tr>
<tr><td><code id="plot_ExtDep_+3A_model">model</code></td>
<td>
<p>A string with the name of the model considered. Takes value <code>"PB"</code> (Pairwise Beta), <code>"HR"</code> (Husler-Reiss), <code>"ET"</code> (Extremal-t), <code>"EST"</code> (Extremal Skew-t), <code>TD</code> (Tilted Dirichlet) or <code>AL</code> (Asymmetric Logistic) when evaluating the angular density. Restricted to <code>"HR"</code>, <code>"ET"</code> and <code>"EST"</code> for the Pickands dependence function.</p>
</td></tr>
<tr><td><code id="plot_ExtDep_+3A_par">par</code></td>
<td>
<p>A vector representing the parameters of the model.</p>
</td></tr>
<tr><td><code id="plot_ExtDep_+3A_log">log</code></td>
<td>
<p>A logical value specifying if the log density is computed. Required when <code>object="angular"</code>.</p>
</td></tr>
<tr><td><code id="plot_ExtDep_+3A_data">data</code></td>
<td>
<p>A matrix representing angular data to be added to the density plot. Required when <code>object="angular"</code>.</p>
</td></tr>
<tr><td><code id="plot_ExtDep_+3A_contour">contour</code></td>
<td>
<p>A logical value; if <code>TRUE</code> the contour levels are displayed. Required for trivariate models only.</p>
</td></tr>
<tr><td><code id="plot_ExtDep_+3A_style">style</code></td>
<td>
<p>A character string indicating the plotting style of the data. Takes value <code>"hist"</code> or <code>"ticks"</code>. See <b>details</b>. </p>
</td></tr>
<tr><td><code id="plot_ExtDep_+3A_labels">labels</code></td>
<td>
<p>A vector of character strings indicating the labels. Must be of length <code class="reqn">1</code> for bivariate models and <code class="reqn">3</code> for trivariate models.</p>
</td></tr>
<tr><td><code id="plot_ExtDep_+3A_cex.dat">cex.dat</code></td>
<td>
<p>A positive real indicating the size of the data points. Required for the trivariate angular density.</p>
</td></tr>
<tr><td><code id="plot_ExtDep_+3A_cex.lab">cex.lab</code></td>
<td>
<p>A positive real indicating the size of the labels.</p>
</td></tr>
<tr><td><code id="plot_ExtDep_+3A_cex.cont">cex.cont</code></td>
<td>
<p>A positive real indicating the size of the contour labels.</p>
</td></tr>
<tr><td><code id="plot_ExtDep_+3A_q.fix">Q.fix</code></td>
<td>
<p>A vector of length the dimension of the model, indicating some fixed quantiles to compute joint return levels. Must contain <code>NA</code> (maximum 2) for components whose quantiles are allowed to vary. Required when <code>object="returns"</code>.</p>
</td></tr>
<tr><td><code id="plot_ExtDep_+3A_q.range">Q.range</code></td>
<td>
<p>A vector or matrix indicating quantile values on the unit Frechet scale, for the components that are allowed to vary. Must be a vector or a one-column matrix if there is one <code>NA</code> in <code>Q.fix</code>. Must be a two-column matrix if there are two <code>NA</code>s in <code>Q.fix</code>. Required when <code>object="returns"</code>.</p>
</td></tr>
<tr><td><code id="plot_ExtDep_+3A_q.range0">Q.range0</code></td>
<td>
<p>A object of the same format as <code>Q.range</code>, corresponding to the quantiles on the original scale. Required when <code>object="returns"</code>.</p>
</td></tr>
<tr><td><code id="plot_ExtDep_+3A_cond">cond</code></td>
<td>
<p>A logical value; if <code>TRUE</code> then conditional return levels are computed where the conditional event is the fixed event. Default if <code>FALSE</code>. Required when <code>object="returns"</code>.</p>
</td></tr>
<tr><td><code id="plot_ExtDep_+3A_...">...</code></td>
<td>
<p>Additional graphical arguments for the <code>hist()</code> and <code>plot()</code> functions respectively used to compute the bivariate angular density and Pickands dependence function as well as for the <code>plot()</code> and <code>contour()</code> functionswhen <code>object="returns"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The angular density is computed using the function <code><a href="#topic+dExtDep">dExtDep</a></code> with arguments <code>method="Parametric"</code> and <code>angular=TRUE</code>. The Pickands dependence function is computed using the function <code><a href="#topic+index.ExtDep">index.ExtDep</a></code> with argument <code>object="pickands"</code>.
</p>
<p>When displaying the bivariate angular density and some data are provided (a 2-column matrix is specified for <code>data</code>), there is the choice to summarise the data using a histogram (<code>style="hist"</code>) or to display the observations using tick marks (<code>style="ticks"</code>). 
</p>
<p>When displaying return levels, there are two possibilities: univariate and bivariate return levels. Since the model dimensions are restricted to a maximum of three, in that case, aunivariate return level corresponds to fixing two components while a bivariate return level fixes only one component. The choice of the fixed component is decided by the position of the <code>NA</code> value(s) in the <code>Q.fix</code> argument. If <code>par</code> is a vector then the corresponding return level(s) are printed. However if <code>par</code> is a matrix then the return level(s) are evaluated for each value of the parameter vector and the mean, and empirical <code class="reqn">95\%</code> empirical interval are displayed. Typically this is used when posterior samples are available. When <code>par</code> is a matrix with only two rows, resulting plots may not provide much information.  
</p>
<p>When contours are displayed, levels are chosen to be the deciles. 
</p>


<h3>Value</h3>

<p>A graph depending on argument <code>object</code>.
</p>


<h3>Author(s)</h3>

<p>Simone Padoan, <a href="mailto:simone.padoan@unibocconi.it">simone.padoan@unibocconi.it</a>,
<a href="https://faculty.unibocconi.it/simonepadoan/">https://faculty.unibocconi.it/simonepadoan/</a>;
Boris Beranger, <a href="mailto:borisberanger@gmail.com">borisberanger@gmail.com</a>
<a href="https://www.borisberanger.com">https://www.borisberanger.com</a>;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dExtDep">dExtDep</a></code>, <code><a href="#topic+index.ExtDep">index.ExtDep</a></code>. </p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(pollution)

###############################
### Trivariate Husler-Reiss ###
###############################


  f.hr &lt;- fExtDep(method="PPP", data=PNS, model="HR", par.start=rep(1,3))

  plot_ExtDep(object="angular", model="HR", par=f.hr$par, data=PNS, 
              labels=c(expression(PM[10]), expression(NO), expression(SO[2])), 
              cex.lab=2)
      
  plot_ExtDep(object="pickands", model="HR", par=f.hr$par, data=PNS, 
              labels=c(expression(PM[10]), expression(NO), expression(SO[2])), 
              cex.lab=2) # Takes time!      


###############################
### Bivariate Husler-Reiss ###
###############################            


  PN &lt;- na.omit(Leeds.frechet[,1:2])
  PN &lt;- cbind(PN, rowSums(PN))
  PN &lt;- PN[order(PN[,3], decreasing = TRUE)[1:100],]
  PN &lt;- PN[,1:2]/PN[,3]

  f.hr2 &lt;- fExtDep(method="PPP", data=PN, model = "HR", par.start = 1)
  plot_ExtDep(model="HR", par=f.hr2$par, log=FALSE, data=PN, style="hist")
  plot_ExtDep(model="HR", par=f.hr2$par, log=FALSE, data=PN, style="ticks") 
  plot_ExtDep(object="pickands", model="HR", par=f.hr2$par) 


            
</code></pre>

<hr>
<h2 id='plot_ExtDep.np'>Graphical summaries of non-parametric representations of extremal dependence.</h2><span id='topic+plot_ExtDep.np'></span>

<h3>Description</h3>

<p>This function displays several summaries of extremal dependence represented through Bernstein polynomials.</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_ExtDep.np(out, type, summary.mcmc, burn, y, probs, 
               A_true, h_true, est.out, mar1, mar2, dep, 
               QatCov1=NULL, QatCov2=QatCov1, P, 
               labels=c(expression(y[1]),expression(y[2])), 
               CEX=1.5, xlim, ylim, col.data, 
               col.Qfull, col.Qfade, data=NULL, ...)        
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_ExtDep.np_+3A_out">out</code></td>
<td>
<p>An output of the <code><a href="#topic+fExtDep.np">fExtDep.np</a></code> function.</p>
</td></tr>
<tr><td><code id="plot_ExtDep.np_+3A_type">type</code></td>
<td>
<p>A character string indicating the type of graphical summary to be plotted. Takes values <code>"summary"</code>, <code>"returns"</code>, <code>"A"</code>, <code>"h"</code>, <code>"pm"</code>, <code>"k"</code> or <code>"Qsets"</code>.</p>
</td></tr>
<tr><td><code id="plot_ExtDep.np_+3A_summary.mcmc">summary.mcmc</code></td>
<td>
<p>The output of the <code>summary_ExtDep</code> function. Only required when <code>out</code> is obtained using a Bayesian estimation method (<code>out$est=="Bayesian"</code>).</p>
</td></tr>
<tr><td><code id="plot_ExtDep.np_+3A_burn">burn</code></td>
<td>
<p>The burn-in period. Only required when <code>out</code> is obtained using a Bayesian estimation method (<code>out$est=="Bayesian"</code>).</p>
</td></tr>
<tr><td><code id="plot_ExtDep.np_+3A_y">y</code></td>
<td>
<p>A 2-column matrix of unobserved thresholds at which the returns are calculated. Required when <code>type="returns"</code>.</p>
</td></tr>
<tr><td><code id="plot_ExtDep.np_+3A_probs">probs</code></td>
<td>
<p>The probability of joint exceedances, the output of the <code><a href="base.html#topic+return">return</a></code> function.</p>
</td></tr>
<tr><td><code id="plot_ExtDep.np_+3A_a_true">A_true</code></td>
<td>
<p>A vector representing the true pickands dependence function evaluated at the grid points on the simplex given by <code>summary.mcmc$w</code>.</p>
</td></tr>
<tr><td><code id="plot_ExtDep.np_+3A_h_true">h_true</code></td>
<td>
<p>A vector representing the true angular density function evaluated at the grid points on the simplex given by <code>summary.mcmc$w</code>.</p>
</td></tr>
<tr><td><code id="plot_ExtDep.np_+3A_est.out">est.out</code></td>
<td>
<p>A list containing:
</p>

<ul>
<li><p><code>ghat</code>: a 3-row matrix giving the posterior summary for the estimate of the bound;
</p>
</li>
<li><p><code>Shat</code> and <code>Shat_post</code>: a matrix of the posterior and a 3-row matrix giving the posterior summary for the estimate of the basic set <code class="reqn">S</code>;
</p>
</li>
<li><p><code>nuShat</code> and <code>nuShat_post</code>: a matrix of the posterior and a 3-row matrix giving the posterior summary for the estimate of the measure <code class="reqn">\nu(S)</code>;
</p>
</li></ul>

<p>Note that a posterior summary is made of its mean and <code class="reqn">90\%</code>credibility interval.
</p>
<p>Only required when using a Bayesian estimation method (<code>out$est=="Bayesian"</code>) and <code>type="Qsets"</code>.</p>
</td></tr>
<tr><td><code id="plot_ExtDep.np_+3A_mar1">mar1</code>, <code id="plot_ExtDep.np_+3A_mar2">mar2</code></td>
<td>
<p>Vectors of marginal GEV parameters. Required when <code>type="Qsets"</code> and either <code>out$method=="Bayesian"</code> if the marginal parameter weren't fitted or <code>"empirical"</code>.</p>
</td></tr>
<tr><td><code id="plot_ExtDep.np_+3A_dep">dep</code></td>
<td>
<p>A logical value; if <code>TRUE</code> the estimate of the dependence is plotted when computing extreme quantile regions (<code>type="Qsets"</code>).</p>
</td></tr>
<tr><td><code id="plot_ExtDep.np_+3A_qatcov1">QatCov1</code>, <code id="plot_ExtDep.np_+3A_qatcov2">QatCov2</code></td>
<td>
<p>Matrices representing the value of the covariates at which extreme quantile regions should be computed. Required when <code>type="Qsets"</code>. See arguments <code>cov1</code> and <code>cov2</code> from <code><a href="#topic+fExtDep">fExtDep</a></code>. </p>
</td></tr>
<tr><td><code id="plot_ExtDep.np_+3A_p">P</code></td>
<td>
<p>A vector indicating the probabilities associated with the quantiles to be computed. Required when <code>type="Qsets"</code>.</p>
</td></tr>
<tr><td><code id="plot_ExtDep.np_+3A_labels">labels</code></td>
<td>
<p>A bivariate vector of character strings providing labels for extreme quantile regions.  Required when <code>type="Qsets"</code>.</p>
</td></tr>
<tr><td><code id="plot_ExtDep.np_+3A_cex">CEX</code></td>
<td>
<p>Label and axis sizes.</p>
</td></tr>
<tr><td><code id="plot_ExtDep.np_+3A_xlim">xlim</code>, <code id="plot_ExtDep.np_+3A_ylim">ylim</code></td>
<td>
<p>Limits of the x and y axis when computing extreme quantile regions. Required when <code>type="Qsets"</code>.</p>
</td></tr>
<tr><td><code id="plot_ExtDep.np_+3A_col.data">col.data</code>, <code id="plot_ExtDep.np_+3A_col.qfull">col.Qfull</code>, <code id="plot_ExtDep.np_+3A_col.qfade">col.Qfade</code></td>
<td>
<p>Colors for data, estimate of extreme quantile regions and its credible interval (when applicable). Required when <code>type="Qsets"</code>.</p>
</td></tr>
<tr><td><code id="plot_ExtDep.np_+3A_data">data</code></td>
<td>
<p>A 2-column matrix providing the original data to be plotted when <code>type="Qsets"</code>.</p>
</td></tr>
<tr><td><code id="plot_ExtDep.np_+3A_...">...</code></td>
<td>
<p>Additional graphical parameters</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>type="returns"</code>, a (contour) plot of the probabilities of exceedances for some threshold is returned. This corresponds to the output of the <code>returns</code> function. <br />
If <code>type="A"</code>, a plot of the estimated Pickands dependence function is drawn. If <code>A_true</code> is specified the plot includes the true Pickands dependence function and a functional boxplot for the estimated function.
If <code>type="h"</code>, a plot of the estimated angular density function is drawn. If <code>h_true</code> is specified the plot includes the true angular density and a functional boxplot for the estimated function.
If <code>type="pm"</code>, a plot of the prior against the posterior for the mass at <code class="reqn">\{0\}</code> is drawn.
If <code>type="k"</code>, a plot of the prior against the posterior for the polynomial degree <code class="reqn">k</code> is drawn.
If <code>type="summary"</code>, when the estimation was performed in a Bayesian framework then a 2 by 2 plot with types <code>"A"</code>, <code>"h"</code>, <code>"pm"</code> and <code>"k"</code> is returned. Otherwise a 1 by 2 plot with types <code>"A"</code> and <code>"h"</code> is returned.
If <code>type="Qsets"</code>, extreme quantile regions are computed according to the methodology developped in Beranger et al. (2021).
</p>


<h3>Value</h3>

<p>a graph depending on argument <code>type</code>.
</p>


<h3>Author(s)</h3>

<p>Simone Padoan, <a href="mailto:simone.padoan@unibocconi.it">simone.padoan@unibocconi.it</a>,
<a href="https://faculty.unibocconi.it/simonepadoan/">https://faculty.unibocconi.it/simonepadoan/</a>;
Boris Beranger, <a href="mailto:borisberanger@gmail.com">borisberanger@gmail.com</a>
<a href="https://www.borisberanger.com">https://www.borisberanger.com</a>;
Giulia Marcon, <a href="mailto:giuliamarcongm@gmail.com">giuliamarcongm@gmail.com</a>
</p>


<h3>References</h3>

<p>Beranger, B., Padoan, S. A. and Sisson, S. A. (2021).
Estimation and uncertainty quantification for extreme quantile regions.
<em>Extremes</em>, <b>24</b>, 349-375.
</p>
<p>Marcon, G., Padoan, S.A., Naveau, P., Muliere, P., Segers, J. (2017)
Multivariate Nonparametric Estimation of the Pickands Dependence
Function using Bernstein Polynomials.
<em>Journal of Statistical Planning and Inference</em>, <b>183</b>, 1-17.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fExtDep.np">fExtDep.np</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>
###########################################################
### Example 1 - Wind Speed and Differential of pressure ###
###########################################################

data(WindSpeedGust)

years &lt;- format(ParcayMeslay$time, format="%Y")
attach(ParcayMeslay[which(years %in% c(2004:2013)),])

# Marginal quantiles
WS_th &lt;- quantile(WS,.9)
DP_th &lt;- quantile(DP,.9)

# Standardisation to unit Frechet (requires evd package)
pars.WS &lt;- evd::fpot(WS, WS_th, model="pp")$estimate
pars.DP &lt;- evd::fpot(DP, DP_th, model="pp")$estimate
  
# transform the marginal distribution to common unit Frechet:
data_uf &lt;- trans2UFrechet(cbind(WS,DP), type="Empirical")

# compute exceedances 
rdata &lt;- rowSums(data_uf)
r0 &lt;- quantile(rdata, probs=.90)
extdata_WSDP &lt;- data_uf[rdata&gt;=r0,]

# Fit
SP_mle &lt;- fExtDep.np(method="Frequentist", data=extdata_WSDP, k0=10, type="maxima")

# Plot
plot_ExtDep.np(out=SP_mle, type="summary")

####################################################
### Example 2 - Pollution levels in Milan, Italy ###
####################################################
	
## Not run: 

### Here we will only model the dependence structure	
data(MilanPollution)

data &lt;- Milan.winter[,c("NO2","SO2")] 
data &lt;- as.matrix(data[complete.cases(data),])

# Thereshold
u &lt;- apply(data, 2, function(x) quantile(x, prob=0.9, type=3))

# Hyperparameters
hyperparam &lt;- list(mu.nbinom = 6, var.nbinom = 8, a.unif=0, b.unif=0.2)

### Standardise data to univariate Frechet margins

f1 &lt;- fGEV(data=data[,1], method="Bayesian", sig0 = 0.0001, nsim = 5e+4)
diagnostics(f1)
burn1 &lt;- 1:30000
gev.pars1 &lt;- apply(f1$param_post[-burn1,],2,mean)
sdata1 &lt;- trans2UFrechet(data=data[,1], pars=gev.pars1, type="GEV")

f2 &lt;- fGEV(data=data[,2], method="Bayesian", sig0 = 0.0001, nsim = 5e+4)
diagnostics(f2)
burn2 &lt;- 1:30000
gev.pars2 &lt;- apply(f2$param_post[-burn2,],2,mean)
sdata2 &lt;- trans2UFrechet(data=data[,2], pars=gev.pars2, type="GEV")

sdata &lt;- cbind(sdata1,sdata2)

### Bayesian estimation using Bernstein polynomials

pollut1 &lt;- fExtDep.np(method="Bayesian", data=sdata, u=TRUE,
                      mar.fit=FALSE, k0=5, hyperparam = hyperparam, nsim=5e+4)

diagnostics(pollut1)
pollut1_sum &lt;- summary_ExtDep(mcmc=pollut1, burn=3e+4, plot=TRUE)
pl1 &lt;- plot_ExtDep.np(out=pollut1, type="Qsets", summary.mcmc=pollut1_sum, 
                      mar1=gev.pars1, mar2=gev.pars2, P = 1/c(600, 1200, 2400),
                      dep=TRUE, data=data, xlim=c(0,400), ylim=c(0,400))

pl1b &lt;- plot_ExtDep.np(out=pollut1, type="Qsets", summary.mcmc=pollut1_sum, est.out=pl1$est.out, 
                       mar1=gev.pars1, mar2=gev.pars2, P = 1/c(1200),
                       dep=FALSE, data=data, xlim=c(0,400), ylim=c(0,400))

### Frequentist estimation using Bernstein polynomials

pollut2 &lt;- fExtDep.np(method="Frequentist", data=sdata, mar.fit=FALSE, type="rawdata", k0=8)
plot_ExtDep.np(out=pollut2, type = c("summary"), CEX=1.5)

pl2 &lt;- plot_ExtDep.np(out=pollut2, type="Qsets", mar1=gev.pars1, mar2=gev.pars2, 
                      P = 1/c(600, 1200, 2400),
                      dep=TRUE, data=data, xlim=c(0,400), ylim=c(0,400),
                      labels=c(expression(NO[2]),expression(SO[2])),
                      col.Qfull = c("red", "green", "blue"))
                      
### Frequentist estimation using EKdH estimator

pollut3 &lt;- fExtDep.np(method="Empirical", data=data)
plot_ExtDep.np(out=pollut3, type = c("summary"), CEX=1.5)

pl3 &lt;- plot_ExtDep.np(out=pollut3, type="Qsets", mar1=gev.pars1, mar2=gev.pars2,
                      P = 1/c(600, 1200, 2400),
                      dep=TRUE, data=data, xlim=c(0,400), ylim=c(0,400),
                      labels=c(expression(NO[2]),expression(SO[2])),
                      col.Qfull = c("red", "green", "blue"))


## End(Not run)
</code></pre>

<hr>
<h2 id='pollution'>Air quality datasets containing daily maxima of air pollutants (PM10, NO, NO2, 03 and S02)
recorded in Leeds (U.K.), during five winter seasons (November-Februrary) between 1994 and 1998.</h2><span id='topic+pollution'></span><span id='topic+NSN'></span><span id='topic+PNN'></span><span id='topic+PNS'></span><span id='topic+PNNS'></span><span id='topic+winterdat'></span><span id='topic+Leeds.frechet'></span>

<h3>Description</h3>

<p>Contains <code class="reqn">6</code> datasets: <code>PNS</code>, <code>PNN</code>, <code>NSN</code>, <code>PNNS</code>,
<code>winterdat</code> and <code>Leeds.frechet</code>. </p>


<h3>Details</h3>

<p>The dataset <code>winterdat</code> contains <code class="reqn">590</code> (transformed) observations for 
each of the five pollutants. Contains <code>NA</code>s. 
Outliers have been removed according to Heffernan and Tawn (2004).
The following datasets have been obtained by applying transformations to <code>winterdat</code>.
</p>
<p><code>Leeds.frechet</code> contains <code class="reqn">590</code> observations corresponding to the
daily maxima of five air pollutants transformed to unit Frechet scale.
</p>
<p><code>NSN</code> contains <code class="reqn">100</code> observations in the <code class="reqn">3</code>-dimensional
unit simplex for the daily maxima of nitrogen dioxide (NO2), sulfur dioxide (SO2) 
and nitrogen oxide (NO).
</p>
<p><code>PNN</code> contains <code class="reqn">100</code> observations in the <code class="reqn">3</code>-dimensional
unit simplex for the daily maxima of particulate matter (PM10), nitrogen oxide (NO) 
and nitrogen dioxide (NO2).
</p>
<p><code>PNS</code> contains <code class="reqn">100</code> observations in the <code class="reqn">3</code>-dimensional
unit simplex for the daily maxima of particulate matter (PM10), nitrogen oxide (NO) 
and sulfur dioxide (SO2).
</p>
<p><code>PNNS</code> contains <code class="reqn">100</code> observations in the <code class="reqn">4</code>-dimensional
unit simplex for the daily maxima of particulate matter (PM10), nitrogen oxide (NO), 
nitrogen dioxide (NO2) and sulfur dioxide (S02).
</p>
<p>The transformation to unit Frechet margins of the raw data has been considered by
Cooley et al (2010). Only the <code class="reqn">100</code> data points with the largest radial components
were kept.
</p>


<h3>Source</h3>

<p><a href="https://uk-air.defra.gov.uk/">https://uk-air.defra.gov.uk/</a></p>


<h3>References</h3>

<p>Cooley, D.,Davis, R. A., and Naveau, P. (2010).
The pairwise beta distribution: a flexible parametric multivariate model for extremes.
<em>Journal of Multivariate Analysis</em>, <b>101</b>, 2103&ndash;2117.	
</p>
<p>Heffernan, J. E., and Tawn, J. A. (2004).
A conditional approach for multivariate extreme values.
<em>Journal of the Royal Statistical Society, Series B, Methodology</em>, <b>66</b>, 497&ndash;546
</p>

<hr>
<h2 id='PrecipFrance'>Weekly maxima of hourly rainfall in France</h2><span id='topic+PrecipFrance'></span><span id='topic+precip'></span><span id='topic+lat'></span><span id='topic+lon'></span>

<h3>Description</h3>

<p>List containing the weekly maxima of hourly rainfall in the Fall season from 1993 to 2011 recorded at 92 stations across France (<code>precip</code>). Coordinates of the monitoring stations are given in <code>lat</code> and <code>lon</code>. 
</p>


<h3>Format</h3>

<p>A list made of a <code class="reqn">228*92</code> matrix (<code>precip</code>) and two vectors of length <code class="reqn">228</code> (<code>lat</code> and <code>lon</code>).</p>


<h3>Details</h3>

<p>The fall season corresponds to the September-November (SON) period.  The data thus cover a 12-week period over <code class="reqn">19</code> years, yielding a sample of <code class="reqn">n=228</code> observations (rows) and <code class="reqn">p=92</code> stations (columns).</p>

<hr>
<h2 id='returns'>
Compute return values
</h2><span id='topic+returns'></span>

<h3>Description</h3>

<p>Predicts the probability of future simultaneous exceedances
</p>


<h3>Usage</h3>

<pre><code class='language-R'>returns(out, summary.mcmc, y, plot=FALSE, labels=NULL, 
        data=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="returns_+3A_out">out</code></td>
<td>
<p>The output of the <code><a href="#topic+fExtDep.np">fExtDep.np</a></code> function with <code>method="Bayesian"</code>.</p>
</td></tr>
<tr><td><code id="returns_+3A_summary.mcmc">summary.mcmc</code></td>
<td>
<p>The output of the <code><a href="#topic+summary_ExtDep">summary_ExtDep</a></code> function.</p>
</td></tr>
<tr><td><code id="returns_+3A_y">y</code></td>
<td>
<p>A 2-column matrix of unobserved thresholds.</p>
</td></tr>
<tr><td><code id="returns_+3A_plot">plot</code></td>
<td>
<p>A logical value; if <code>TRUE</code>, then the returns are plotted using <code><a href="#topic+plot_ExtDep.np">plot_ExtDep.np</a></code>.</p>
</td></tr>
<tr><td><code id="returns_+3A_labels">labels</code></td>
<td>
<p>As in <code><a href="#topic+plot_ExtDep.np">plot_ExtDep.np</a></code>. Required if <code>plot=TRUE</code>.</p>
</td></tr>
<tr><td><code id="returns_+3A_data">data</code></td>
<td>
<p>As in <code><a href="#topic+plot_ExtDep.np">plot_ExtDep.np</a></code>. Required if <code>plot=TRUE</code>.</p>
</td></tr>    
</table>


<h3>Details</h3>

<p>Computes for a range of unobserved extremes (larger than those observed in a sample), the pointwise mean from the posterior predictive distribution of such predictive values. The probabilities are calculated through
</p>
<p><code class="reqn">
P(Y_1 &gt; y_1, Y_2 &gt; y_2) = \frac{2}{k} \sum_{j=0}^{k-2} (\eta_{j+1} - \eta_j)
\times \left(
\frac{(j+1) B(y_1/(y_1+y_2)| j+2, k-j-1)}{y_1}
- \frac{(k-j-1) B(y_2/(y_1+y_2)| k-j, j+1)}{y_2}
\right),
</code>
</p>
<p>where <code class="reqn">B(x|a,b)</code> denotes the cumulative distribution function of a Beta random variable with shape <code class="reqn">a,b&gt;0</code>. See Marcon et al. (2016, p.3323) for details.
</p>


<h3>Value</h3>

<p>Returns a vector whose length is equal to the number of rows of the input value <code>y</code>.
</p>


<h3>Author(s)</h3>

<p>Simone Padoan, <a href="mailto:simone.padoan@unibocconi.it">simone.padoan@unibocconi.it</a>,
<a href="https://faculty.unibocconi.it/simonepadoan/">https://faculty.unibocconi.it/simonepadoan/</a>;
Boris Beranger, <a href="mailto:borisberanger@gmail.com">borisberanger@gmail.com</a>
<a href="https://www.borisberanger.com">https://www.borisberanger.com</a>;
Giulia Marcon, <a href="mailto:giuliamarcongm@gmail.com">giuliamarcongm@gmail.com</a>
</p>


<h3>References</h3>

<p>Marcon, G., Padoan, S. A. and Antoniano-Villalobos, I. (2016).
Bayesian inference for the extremal dependence.
<em>Electronic Journal of Statistics</em>, <b>10</b>, 3310-3337.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#########################################################
### Example 1 - daily log-returns between the GBP/USD ###
###             and GBP/JPY exchange rates            ###
#########################################################

if(interactive()){

data(logReturns)

mm_gbp_usd &lt;- ts(logReturns$USD, start=c(1991,3), end=c(2014,12), frequency=12)
mm_gbp_jpy &lt;- ts(logReturns$JPY, start=c(1991,3), end=c(2014,12), frequency=12)

### Detect seasonality and trend in the time series of maxima:
seas_usd &lt;- stl(mm_gbp_usd, s.window="period")
seas_jpy &lt;- stl(mm_gbp_jpy, s.window="period")

### remove the seasonality and trend from the two series:
mm_gbp_usd_filt &lt;- mm_gbp_usd - rowSums(seas_usd$time.series[,-3])
mm_gbp_jpy_filt &lt;- mm_gbp_jpy - rowSums(seas_jpy$time.series[,-3])

### Estimation of margins and dependence

mm_gbp &lt;- cbind(as.vector(mm_gbp_usd_filt), as.vector(mm_gbp_jpy_filt))

hyperparam &lt;- list(mu.nbinom = 3.2, var.nbinom = 4.48)
gbp_mar &lt;- fExtDep.np(method="Bayesian", data=mm_gbp, par10=rep(0.1, 3), 
                      par20=rep(0.1,3), sig10=0.0001, sig20=0.0001, k0=5,
                      hyperparam = hyperparam, nsim=5e+4)

gbp_mar_sum &lt;- summary_ExtDep(mcmc=gbp_mar, burn=3e+4, plot=TRUE)

mm_gbp_range &lt;- apply(mm_gbp,2,quantile,c(0.9,0.995))

y_gbp_usd &lt;- seq(from=mm_gbp_range[1,1], to=mm_gbp_range[2,1], length=20)
y_gbp_jpy &lt;- seq(from=mm_gbp_range[1,2], to=mm_gbp_range[2,2], length=20)
y &lt;- as.matrix(expand.grid(y_gbp_usd, y_gbp_jpy, KEEP.OUT.ATTRS = FALSE))

ret_marg &lt;- returns(out=gbp_mar, summary.mcmc=gbp_mar_sum, y=y, plot=TRUE, 
                    data=mm_gbp, labels=c("GBP/USD exchange rate", "GBP/JPY exchange rate"))

}

#########################################################
### Example 2 - Reproducing some of the results shown ###
###             in Marcon et al. (2016, Figure 1)     ###
#########################################################

## Not run: 

set.seed(1890)
data &lt;- evd::rbvevd(n=100, dep=0.6, asy=c(0.8,0.3), model="alog", mar1=c(1,1,1))

hyperparam &lt;- list(a.unif=0, b.unif=.5, mu.nbinom=3.2, var.nbinom=4.48)
pm0 &lt;- list(p0=0.06573614, p1=0.3752118)

mcmc &lt;- fExtDep.np(method="Bayesian", data=data, mar.fit=FALSE, k0=5,
                   pm0=pm0, prior.k = "nbinom", prior.pm = "unif", 
                   hyperparam=hyperparam, nsim=5e+5)

w &lt;- seq(0.001, 0.999, length=100)
summary.mcmc &lt;- summary_ExtDep(w, mcmc, burn=4e+5, plot=TRUE)

plot_ExtDep.np(out=mcmc, type = "A", summary.mcmc=summary.mcmc)
plot_ExtDep.np(out=mcmc, type = "h", summary.mcmc=summary.mcmc)
plot_ExtDep.np(out=mcmc, type = "pm", summary.mcmc=summary.mcmc)
plot_ExtDep.np(out=mcmc, type = "k", summary.mcmc=summary.mcmc)

y &lt;- seq(10,100,2)
y &lt;- as.matrix(expand.grid(y,y))
probs &lt;- returns(out=mcmc, summary.mcmc=summary.mcmc, y=y, plot=TRUE)


## End(Not run)
</code></pre>

<hr>
<h2 id='rExtDep'>Parametric and semi-parametric random generator of extreme events</h2><span id='topic+rExtDep'></span>

<h3>Description</h3>

<p>This function generates random samples of iid observations from extremal dependence models and semi-parametric stochastic generators.</p>


<h3>Usage</h3>

<pre><code class='language-R'>rExtDep(n, model, par, angular=FALSE, mar=c(1,1,1), num, threshold, 
        exceed.type)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rExtDep_+3A_n">n</code></td>
<td>
<p>An integer indictaing the number of observations.</p>
</td></tr>
<tr><td><code id="rExtDep_+3A_model">model</code></td>
<td>
<p>A character string with the name of the model. Parametric model include <code>"HR"</code> (Husler-Reiss), <code>"ET"</code> (Extremal-t), <code>"EST"</code> (Extremal Skew-t). Semi-parametric generators include <code>"semi.bvevd"</code> and <code>"semi.bvexceed"</code>. </p>
</td></tr>
<tr><td><code id="rExtDep_+3A_par">par</code></td>
<td>
<p>A vector representing the parameters of the (parametric or non-parametric) model.</p>
</td></tr>
<tr><td><code id="rExtDep_+3A_angular">angular</code></td>
<td>
<p>A logical value; <code>TRUE</code> for angular outputs.</p>
</td></tr>
<tr><td><code id="rExtDep_+3A_mar">mar</code></td>
<td>
<p>A vector or matrix of marginal parameters.</p>
</td></tr>
<tr><td><code id="rExtDep_+3A_num">num</code></td>
<td>
<p>An integer indicating the number of observations the componentwise maxima is computed over. Required when <code>model="HR"</code>, <code>"ET"</code> or <code>"EST"</code>. Set to <code>5e+5</code> unless specified.</p>
</td></tr>
<tr><td><code id="rExtDep_+3A_threshold">threshold</code></td>
<td>
<p>A bivariate vector indicating the level of exceedances. Required when <code>model="semi.bvexceed"</code>.</p>
</td></tr>
<tr><td><code id="rExtDep_+3A_exceed.type">exceed.type</code></td>
<td>
<p>A character string taking value &quot;and&quot; or &quot;or&quot; indicating the type of exceednaces. Required when <code>model="semi.bvexceed"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There is no limit of the dimensionality when <code>model="HR"</code>, <code>"ET"</code> or <code>"EST"</code> while <code>model="semi.bvevd"</code> and <code>"semi.bvexceed"</code> can only generate bivariate observations.
When <code>angular=TRUE</code> and <code>model="semi.bvevd"</code> or <code>"semi.bvexceed"</code> the simulation of pseudo-angles follows Algorithm 1 of Marcon et al. (2017). 
When <code>model="semi.bvevd"</code> and <code>angular=FALSE</code>, maxima samples are generated according to Algorithm 2 of Marcon et al. (2017).
When <code>model="semi.bvexceed"</code> and <code>angular=FALSE</code>, exceedance samples are generated above value specified by <code>threshold</code>, according to Algorithm 3 of Marcon et al. (2017). <code>exceed.type="and"</code> generates samples that exceed both thresholds while <code>exceed.type="or"</code> generates samples exceeding at least one threshold.
</p>
<p>When the argument <code>mar</code> is a vector, the marginal distrutions are identical. When a matrix is provided each row corresponds to a set of marginal parameters. No marginal transformation is applied when <code>mar=c(1,1,1)</code>.
</p>


<h3>Value</h3>

<p>A matrix with <code class="reqn">n</code> rows and <code class="reqn">p&gt;=2</code> columns. <code class="reqn">p=2</code> when <code>model="semi.bvevd"</code> or <code>"semi.bvexceed"</code>.   
</p>


<h3>Author(s)</h3>

<p>Simone Padoan, <a href="mailto:simone.padoan@unibocconi.it">simone.padoan@unibocconi.it</a>,
<a href="https://faculty.unibocconi.it/simonepadoan/">https://faculty.unibocconi.it/simonepadoan/</a>;
Boris Beranger, <a href="mailto:borisberanger@gmail.com">borisberanger@gmail.com</a>
<a href="https://www.borisberanger.com">https://www.borisberanger.com</a>;
</p>


<h3>References</h3>

<p>Marcon, G., Naveau, P. and Padoan, S.A. (2017)
A semi-parametric stochastic generator for bivariate extreme events
<em>Stat</em>, <b>6</b>, 184-201.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dExtDep">dExtDep</a></code>, <code><a href="#topic+pExtDep">pExtDep</a></code>, <code><a href="#topic+fExtDep">fExtDep</a></code>, <code><a href="#topic+fExtDep.np">fExtDep.np</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>

# Example using the trivariate Husler-Reiss
set.seed(1)
data &lt;- rExtDep(n=10, model="HR", par=c(2,3,3))

# Example using the semi-parammetric generator of maxima
set.seed(2)
beta &lt;- c(1.0000000, 0.8714286, 0.7671560, 0.7569398, 
          0.7771908, 0.8031573, 0.8857143, 1.0000000)
data &lt;- rExtDep(n=10, model="semi.bvevd", par=beta, 
                mar=rbind(c(0.2, 1.5, 0.6),c(-0.5, 0.4, 0.9)))

# Example using the semi-parammetric generator of maxima
set.seed(3)
data &lt;- rExtDep(n=10, model="semi.bvexceed", par=beta, 
                threshold=c(0.2, 0.4), exceed.type="and")
                
                
</code></pre>

<hr>
<h2 id='rExtDepSpat'>Random generation of max-stable processes</h2><span id='topic+rExtDepSpat'></span>

<h3>Description</h3>

<p>This function generates realisations from a max-stable process.</p>


<h3>Usage</h3>

<pre><code class='language-R'>rExtDepSpat(n, coord, model="SCH", cov.mod = "whitmat", grid = FALSE, 
            control = list(), cholsky = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rExtDepSpat_+3A_n">n</code></td>
<td>
<p>An integer indictaing the number of observations.</p>
</td></tr>
<tr><td><code id="rExtDepSpat_+3A_coord">coord</code></td>
<td>
<p>A vector or matrix corresponding to the coordinates of locations where the processes is simulated. Each row corresponds to a location.</p>
</td></tr>
<tr><td><code id="rExtDepSpat_+3A_model">model</code></td>
<td>
<p>A character string indicating the max-stable model. See <code>details</code>.</p>
</td></tr>
<tr><td><code id="rExtDepSpat_+3A_cov.mod">cov.mod</code></td>
<td>
<p>A character string indicating the correlation function function. See <code>details</code>.</p>
</td></tr>
<tr><td><code id="rExtDepSpat_+3A_grid">grid</code></td>
<td>
<p>A logical value; <code>TRUE</code> for coordinates on a grid.</p>
</td></tr>
<tr><td><code id="rExtDepSpat_+3A_control">control</code></td>
<td>
<p>A named list with arguments <code>nlines</code> giving the number of lines of the TBM simulation, <code>method</code> a character string specifying the name of the simulation method and <code>uBound</code> the uniform upper bound. Note that <code>method</code> must take value <code>'exact'</code>, <code>'tbm'</code> or <code>'circ'</code>. See <code>details</code>.</p>
</td></tr>
<tr><td><code id="rExtDepSpat_+3A_cholsky">cholsky</code></td>
<td>
<p>A logical value; if <code>TRUE</code> a Cholesky decomposition is performed. Used for the extremal-t and extremal skew-t models when <code>control=list(method='exact')</code>. </p>
</td></tr>
<tr><td><code id="rExtDepSpat_+3A_...">...</code></td>
<td>
<p>The parameters of the max-stable model. See <code>details</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function extends the <code>rmaxstab</code> function from the <code>SpatialExtremes</code> package in two ways:
</p>

<ul>
<li><p>1. The <b>extremal skew-t</b> model is included.
</p>
</li>
<li><p>2. The function returns the hitting scenarios, i.e. the index of which 'storm' (or process) led to the maximum value for each location and observation.
</p>
</li></ul>

<p>The max-stable models available in this procedure and the specifics  are:
</p>

<ul>
<li><p><b>Smith model</b>: when <code>model='SMI'</code>, does not require <code>cov.mod</code>. If <code>coord</code> is univariate then <code>var</code> needs to be specified and for higher dimensions covariance parameters should be provided such as <code>cov11</code>, <code>cov12</code>, <code>cov22</code>, etc. 
</p>
</li>
<li><p><b>Schlather model</b>: when <code>model='SCH'</code>, requires <code>cov.mod='whitmat'</code>, <code>'cauchy'</code>, <code>'powexp'</code> or <code>'bessel'</code> depending on the correlation family. Parameters <code>'nugget'</code>, <code>'range'</code> and <code>'smooth'</code> should be specified.
</p>
</li>
<li><p><b>Extremal-t model</b>: when <code>model='ET'</code>, requires <code>cov.mod='whitmat'</code>, <code>'cauchy'</code>, <code>'powexp'</code> or <code>'bessel'</code> depending on the correlation family. Parameters <code>'nugget'</code>, <code>'range'</code>, <code>'smooth'</code> and <code>'DoF'</code> should be specified.
</p>
</li>
<li><p><b>Extremal skew-t model</b>: when <code>model='EST'</code>, requires <code>cov.mod='whitmat'</code>, <code>'cauchy'</code>, <code>'powexp'</code> or <code>'bessel'</code> depending on the correlation family. Parameters <code>'nugget'</code>, <code>'range'</code>, <code>'smooth'</code>, <code>'DoF'</code>, <code>'alpha'</code> (a vector of length <code class="reqn">3</code>) and <code>'acov1'</code> and <code>'acov2'</code> (both vector of length the number of locations) should be specified. The skewness vector is defined as <code class="reqn">\alpha = \alpha_0 + \alpha_1 \textrm{acov1} + \alpha_2 \textrm{acov2} </code>.
</p>
</li>
<li><p><b>Geometric gaussian model</b>: when <code>model='GG'</code>, requires <code>cov.mod='whitmat'</code>, <code>'cauchy'</code>, <code>'powexp'</code> or <code>'bessel'</code> depending on the correlation family. Parameters <code>'sig2'</code>, <code>'nugget'</code>, <code>'range'</code> and <code>'smooth'</code> should be specified.
</p>
</li>
<li><p><b>Brown-Resnick model</b>: when <code>model='BR'</code>, does not require <code>cov.mod</code>. Parameters <code>'range'</code> and <code>'smooth'</code> should be specified.  
</p>
</li></ul>

<p>For the argument <code>control</code>, details of the list components are as follows:
</p>

<ul>
<li><p><code>method</code>is <code>NULL</code> by default, meaning that the function tries to find the most appropriate simulation technique. Current simulation techniques are a direct approach, i.e. Cholesky decomposition of the covariance matrix, the turning bands and the circular embedding methods. Note that for the extremal skew-t model it can only take value <code>'exact'</code> or <code>'direct'</code>;
</p>
</li>
<li><p><code>nlines</code> if <code>NULL</code> then it is set to <code class="reqn">1000</code>;
</p>
</li>
<li><p><code>uBound</code> if <code>NULL</code> then it is set to reasonable values - for example <code class="reqn">3.5</code> for the Schlather model.
</p>
</li></ul>



<h3>Value</h3>

<p>A list made of
</p>

<ul>
<li><p><code>vals</code>: A <code class="reqn">(n \times d)</code> matrix containing <code class="reqn">n</code> observations at <code class="reqn">d</code> locations, from the specified max-stable model.
</p>
</li>
<li><p><code>hits</code>: A <code class="reqn">(n \times d)</code> matrix containing the hitting scenarios for each observations. On each row, elements with the same integer value indicate that the maxima at these two locations is coming from the same 'storm' or process.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Simone Padoan, <a href="mailto:simone.padoan@unibocconi.it">simone.padoan@unibocconi.it</a>,
<a href="https://faculty.unibocconi.it/simonepadoan/">https://faculty.unibocconi.it/simonepadoan/</a>;
Boris Beranger, <a href="mailto:borisberanger@gmail.com">borisberanger@gmail.com</a>
<a href="https://www.borisberanger.com">https://www.borisberanger.com</a>;
</p>


<h3>References</h3>

<p>Beranger, B., Stephenson, A. G. and Sisson, S.A. (2021)
High-dimensional inference using the extremal skew-t process
<em>Extremes</em>, <b>24</b>, 653-685.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fExtDepSpat">fExtDepSpat</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Generate some locations
set.seed(1)
lat &lt;- lon &lt;- seq(from=-5, to=5, length=20)
sites &lt;- as.matrix(expand.grid(lat,lon))

# Example using the extremal-t
set.seed(2)
z &lt;- rExtDepSpat(1, sites, model="ET", cov.mod="powexp", DoF=1, 
                 nugget=0, range=3, smooth=1.5, 
                 control=list(method="exact"))
fields::image.plot(lat, lon, matrix(z$vals,ncol=20) )

# Example using the extremal skew-t
set.seed(3)
z2 &lt;- rExtDepSpat(1, sites, model="EST", cov.mod="powexp", DoF=5, 
                  nugget=0, range=3, smooth=1.5, alpha=c(0,5,5), 
                  acov1=sites[,1], acov2=sites[,2], 
                  control=list(method="exact"))
fields::image.plot(lat, lon, matrix(z2$vals,ncol=20) )

</code></pre>

<hr>
<h2 id='simplex'>Definition of a multivariate simplex</h2><span id='topic+simplex'></span>

<h3>Description</h3>

<p>Generation of grid points over the multivariate simplex</p>


<h3>Usage</h3>

<pre><code class='language-R'>simplex(d, n=50, a=0, b=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simplex_+3A_d">d</code></td>
<td>
<p>A positive integer indicating the dimension of the simplex.</p>
</td></tr>
<tr><td><code id="simplex_+3A_n">n</code></td>
<td>
<p>A positive integer indicating the number of grid points to be generated on the univariate components of the simplex.</p>
</td></tr>
<tr><td><code id="simplex_+3A_a">a</code>, <code id="simplex_+3A_b">b</code></td>
<td>
<p>Two numeric values indicating the lower and upper bound of the simplex. By default <code>a=0</code> and <code>b=0</code>, indicating the unit-simplex.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A <code class="reqn">d</code>-dimensional simplex is defined by </p>
<p style="text-align: center;"><code class="reqn">S = \{ (\omega_1, \ldots, \omega_d) \in R^d_+: \sum_{i=1}^d \omega_i = 1 \}.</code>
</p>
<p> Here the function defines the simplex as </p>
<p style="text-align: center;"><code class="reqn">S = \{ (\omega_1, \ldots, \omega_d) \in [a,b]^d: \sum_{i=1}^d \omega_i = 1 \}.</code>
</p>

<p>When <code>d=2</code> and <code class="reqn">[a,b]=[0,1]</code>, a grid of points of the form <code class="reqn">\{ (\omega_1, \omega_2) \in [0,1]: \omega_1 + \omega_2 = 1 \}</code>. 
</p>


<h3>Value</h3>

<p>Returns a matrix with <code class="reqn">d</code> columns. When <code>d=2</code>, the number of rows is <code class="reqn">n</code>.
When <code>d&gt;2</code>, the number of rows is equal to </p>
<p style="text-align: center;"><code class="reqn">\sum_{i_{d-1}=0}^{n-1} \sum_{i_{d-2}=0}^{n-i_{d-1}} \cdots \sum_{i_{1}=1}^{n-i_{d-1}-\cdots-i_{2}} i_{1} </code>
</p>



<h3>Author(s)</h3>

<p>Simone Padoan, <a href="mailto:simone.padoan@unibocconi.it">simone.padoan@unibocconi.it</a>,
<a href="https://faculty.unibocconi.it/simonepadoan/">https://faculty.unibocconi.it/simonepadoan/</a>;
Boris Beranger, <a href="mailto:borisberanger@gmail.com">borisberanger@gmail.com</a>
<a href="https://www.borisberanger.com">https://www.borisberanger.com</a>;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
### 3-dimensional unit simplex

W &lt;- simplex(d=3, n=10)
plot(W[,-3], pch=16)

</code></pre>

<hr>
<h2 id='summary_ExtDep'>Summary of MCMC algorithm.</h2><span id='topic+summary_ExtDep'></span>

<h3>Description</h3>

<p>This function computes summaries on the posterior sample obtained from the adaptive MCMC scheme for the non-parametric estimation of a bivariate dependence structure.</p>


<h3>Usage</h3>

<pre><code class='language-R'>summary_ExtDep(object, mcmc, burn, cred=0.95, plot=FALSE, ...)    
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary_ExtDep_+3A_object">object</code></td>
<td>
<p>A vector of values on <code class="reqn">[0,1]</code>. If missing, a regular grid of length <code class="reqn">100</code> is considered.</p>
</td></tr>
<tr><td><code id="summary_ExtDep_+3A_mcmc">mcmc</code></td>
<td>
<p>An output of the <code><a href="#topic+fExtDep.np">fExtDep.np</a></code> function with <code>method="Bayesian"</code>.</p>
</td></tr>
<tr><td><code id="summary_ExtDep_+3A_burn">burn</code></td>
<td>
<p>A positive integer indicating the burn-in period.</p>
</td></tr>
<tr><td><code id="summary_ExtDep_+3A_cred">cred</code></td>
<td>
<p>A value in <code class="reqn">[0,1]</code> indicating the level of the credibility intervals to be computed.</p>
</td></tr>
<tr><td><code id="summary_ExtDep_+3A_plot">plot</code></td>
<td>
<p>A logical value; if <code>TRUE</code> a summary of the estimated dependence is displayed by calling the <code>plot_ExtDep.np</code> function with <code>type="summary"</code>.</p>
</td></tr>
<tr><td><code id="summary_ExtDep_+3A_...">...</code></td>
<td>
<p>Additional graphical parameters for <code>plot_ExtDep.np</code> when <code>plot=TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For each value say <code class="reqn">\omega \in [0,1]</code> given, the complement <code class="reqn">1-\omega </code> is automatically computed to define the observation <code class="reqn">(\omega,1-\omega)</code> on the bivariate unit simplex.
</p>
<p>It is obvious that the value of <code>burn</code> must be greater than the number of iterations in the mcmc algorithm. This can be found in <code>mcmc</code>.
</p>


<h3>Value</h3>

<p>The function returns a list with the following objects:
</p>

<ul>
<li><p><code>k.median</code>, <code>k.up</code>, <code>k.low</code>: Posterior median, upper and lower bounds of the CI for the estimated Bernstein polynomial degree <code class="reqn">\kappa</code>;
</p>
</li>
<li><p><code>h.mean</code>, <code>h.up</code>, <code>h.low</code>: Posterior mean, upper and lower bounds of the CI for the estimated angular density <code class="reqn">h</code>;
</p>
</li>
<li><p><code>A.mean</code>, <code>A.up</code>, <code>A.low</code>: Posterior mean, upper and lower bounds of the CI for the estimated Pickands dependence function <code class="reqn">A</code>;
</p>
</li>
<li><p><code>p0.mean</code>, <code>p0.up</code>, <code>p0.low</code>: Posterior mean, upper and lower bounds of the CI for the estimated point mass <code class="reqn">p_0</code>;
</p>
</li>
<li><p><code>p1.mean</code>, <code>p1.up</code>, <code>p1.low</code>: Posterior mean, upper and lower bounds of the CI for the estimated point mass <code class="reqn">p_1</code>;
</p>
</li>
<li><p><code>A_post</code>: Posterior sample for Pickands dependence function;
</p>
</li>
<li><p><code>h_post</code>: Posterior sample for angular density;
</p>
</li>
<li><p><code>eta.diff_post</code>: Posterior sample for the Bernstein polynomial coefficients (<code class="reqn">\eta</code> parametrisation);
</p>
</li>
<li><p><code>beta_post</code>: Posterior sample for the Bernstein polynomial coefficients (<code class="reqn">\beta</code> parametrisation);
</p>
</li>
<li><p><code>p0_post</code>, <code>p1_post</code>: Posterior sample for point masses <code class="reqn">p_0</code> and <code class="reqn">p_1</code>;
</p>
</li>
<li><p><code>w</code>: A vector of values on the bivariate simplex where the angular density and Pickands dependence function were evaluated;
</p>
</li>
<li><p><code>burn</code>: The argument provided;
</p>
</li></ul>

<p>If the margins were also fitted, the list given as <code>object</code> would contain <code>mar1</code> and <code>mar2</code> and the function would also output:
</p>

<ul>
<li><p><code>mar1.mean</code>, <code>mar1.up</code>, <code>mar1.low</code>: Posterior mean, upper and lower bounds of the CI for the estimated marginal parameter on the first component;
</p>
</li>
<li><p><code>mar2.mean</code>, <code>mar2.up</code>, <code>mar2.low</code>: Posterior mean, upper and lower bounds of the CI for the estimated marginal parameter on the second component;
</p>
</li>
<li><p><code>mar1_post</code>: Posterior sample for the estimated marginal parameter on the first component;
</p>
</li>
<li><p><code>mar2_post</code>: Posterior sample for the estimated marginal parameter on the second component;  
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Simone Padoan, <a href="mailto:simone.padoan@unibocconi.it">simone.padoan@unibocconi.it</a>,
<a href="https://faculty.unibocconi.it/simonepadoan/">https://faculty.unibocconi.it/simonepadoan/</a>;
Boris Beranger, <a href="mailto:borisberanger@gmail.com">borisberanger@gmail.com</a>
<a href="https://www.borisberanger.com">https://www.borisberanger.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fExtDep.np">fExtDep.np</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>
####################################################
### Example - Pollution levels in Milan, Italy ###
####################################################
	
## Not run: 

### Here we will only model the dependence structure	
data(MilanPollution)

data &lt;- Milan.winter[,c("NO2","SO2")] 
data &lt;- as.matrix(data[complete.cases(data),])

# Thereshold
u &lt;- apply(data, 2, function(x) quantile(x, prob=0.9, type=3))

# Hyperparameters
hyperparam &lt;- list(mu.nbinom = 6, var.nbinom = 8, a.unif=0, b.unif=0.2)

### Standardise data to univariate Frechet margins

f1 &lt;- fGEV(data=data[,1], method="Bayesian", sig0 = 0.0001, nsim = 5e+4)
diagnostics(f1)
burn1 &lt;- 1:30000
gev.pars1 &lt;- apply(f1$param_post[-burn1,],2,mean)
sdata1 &lt;- trans2UFrechet(data=data[,1], pars=gev.pars1, type="GEV")

f2 &lt;- fGEV(data=data[,2], method="Bayesian", sig0 = 0.0001, nsim = 5e+4)
diagnostics(f2)
burn2 &lt;- 1:30000
gev.pars2 &lt;- apply(f2$param_post[-burn2,],2,mean)
sdata2 &lt;- trans2UFrechet(data=data[,2], pars=gev.pars2, type="GEV")

sdata &lt;- cbind(sdata1,sdata2)

### Bayesian estimation using Bernstein polynomials

pollut1 &lt;- fExtDep.np(method="Bayesian", data=sdata, u=TRUE,
                      mar.fit=FALSE, k0=5, hyperparam = hyperparam, nsim=5e+4)

diagnostics(pollut1)
pollut1_sum &lt;- summary_ExtDep(mcmc=pollut1, burn=3e+4, plot=TRUE)

## End(Not run)
	
</code></pre>

<hr>
<h2 id='trans2GEV'>Transformation to GEV distribution</h2><span id='topic+trans2GEV'></span>

<h3>Description</h3>

<p>Transformation of marginal distribution from unit Frechet to GEV</p>


<h3>Usage</h3>

<pre><code class='language-R'>trans2GEV(data, pars)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="trans2GEV_+3A_data">data</code></td>
<td>
<p>A vector of length <code class="reqn">n</code> or a <code class="reqn">(n \times p)</code> matrix representing the data on its original scale.</p>
</td></tr>
<tr><td><code id="trans2GEV_+3A_pars">pars</code></td>
<td>
<p>A <code class="reqn">(1 \times 3)</code> vector or a <code class="reqn">(p \times 3)</code> matrix of marginal GEV parameters.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The transformation function is <code class="reqn">\left(x^{\xi} -1 \right) \frac{\sigma}{\xi}+\mu</code> if <code class="reqn">\xi\neq 0</code>, and <code class="reqn">x^{-1}\sigma+\mu</code> if <code class="reqn">\xi=0</code>. 
</p>


<h3>Value</h3>

<p>An object of the same format and dimensions as <code>data</code>.   
</p>


<h3>Author(s)</h3>

<p>Simone Padoan, <a href="mailto:simone.padoan@unibocconi.it">simone.padoan@unibocconi.it</a>,
<a href="https://faculty.unibocconi.it/simonepadoan/">https://faculty.unibocconi.it/simonepadoan/</a>;
Boris Beranger, <a href="mailto:borisberanger@gmail.com">borisberanger@gmail.com</a>
<a href="https://www.borisberanger.com">https://www.borisberanger.com</a>;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+trans2UFrechet">trans2UFrechet</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(pollution)
pars &lt;- fGEV(Leeds.frechet[,1])$est

par_new &lt;- c(2, 1.5, 0.5)
data_new &lt;- trans2GEV(Leeds.frechet[,1], pars=par_new)

fGEV(data_new)
</code></pre>

<hr>
<h2 id='trans2UFrechet'>Transformation to unit Frechet distribution</h2><span id='topic+trans2UFrechet'></span>

<h3>Description</h3>

<p>Empirical and parametric transformation of a dataset to unit Frechet marginal distribution</p>


<h3>Usage</h3>

<pre><code class='language-R'>trans2UFrechet(data, pars, type="Empirical")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="trans2UFrechet_+3A_data">data</code></td>
<td>
<p>A vector of length <code class="reqn">n</code> or a <code class="reqn">(n \times p)</code> matrix representing the data on its original scale.</p>
</td></tr>
<tr><td><code id="trans2UFrechet_+3A_pars">pars</code></td>
<td>
<p>A <code class="reqn">(1 \times 3)</code> vector or a <code class="reqn">(p \times 3)</code> matrix of marginal GEV parameters. Required when <code>type="GEV"</code>.</p>
</td></tr>
<tr><td><code id="trans2UFrechet_+3A_type">type</code></td>
<td>
<p>A character string indicating the type of transformation. Can take value <code>"Empirical"</code> or <code>"GEV"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When <code>type="Empirical"</code>, the transformation function is <code class="reqn">t(x)=-1/\log(F_{\textrm{emp}}(x))</code> where <code class="reqn">F_{\textrm{emp}}(x)</code> denotes the empirical cumulative distribution.
</p>
<p>When <code>type="GEV"</code>, the transformation function is <code class="reqn">\left(1+\xi \frac{x-\mu}{\sigma}\right)^{1/\xi}</code> if <code class="reqn">\xi \neq 0</code>, <code class="reqn">\left( \frac{x-\mu}{\sigma}\right)^{-1}</code> if <code class="reqn">\xi=0</code>. If the argument <code>pars</code> is missing then a GEV is fitted on the columns of <code>data</code> using the <code><a href="#topic+fGEV">fGEV</a></code> function.
</p>


<h3>Value</h3>

<p>An object of the same format and dimensions as <code>data</code>.   
</p>


<h3>Author(s)</h3>

<p>Simone Padoan, <a href="mailto:simone.padoan@unibocconi.it">simone.padoan@unibocconi.it</a>,
<a href="https://faculty.unibocconi.it/simonepadoan/">https://faculty.unibocconi.it/simonepadoan/</a>;
Boris Beranger, <a href="mailto:borisberanger@gmail.com">borisberanger@gmail.com</a>
<a href="https://www.borisberanger.com">https://www.borisberanger.com</a>;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+trans2GEV">trans2GEV</a></code>, <code><a href="#topic+fGEV">fGEV</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(MilanPollution)

pars &lt;- fGEV(Milan.winter$PM10)$est
pars

data_uf &lt;- trans2UFrechet(data=Milan.winter$PM10, pars=pars, 
                          type="GEV")
fGEV(data_uf)$est

data_uf2 &lt;- trans2UFrechet(data=Milan.winter$PM10, 
                           type="Empirical")
fGEV(data_uf2)$est
</code></pre>

<hr>
<h2 id='Wind'>Weekly maximum wind speed data collected over 4 stations across Oklahoma, USA, over the March-May preiod between 1996 and 2012.</h2><span id='topic+Wind'></span><span id='topic+CLAY.SALL.PAUL'></span><span id='topic+CLOU.CLAY.PAUL'></span><span id='topic+CLOU.CLAY.SALL'></span><span id='topic+CLOU.SALL.PAUL'></span>

<h3>Description</h3>

<p>There are four datasets of weekly maximum wind speed data, for each triplet of locations: <code>CLOU.CLAY.SALL</code>, <code>CLOU.CLAY.PAUL</code>, <code>CLAY.SALL.PAUL</code> and <code>CLOU.SALL.PAUL</code>.
</p>


<h3>Details</h3>

<p><code>CLOU.CLAY.SALL</code> is a <code>data.frame</code> object	with <code class="reqn">3</code> columns and <code class="reqn">212</code> rows.
<code>CLOU.CLAY.PAUL</code> is a <code>data.frame</code> object	with <code class="reqn">3</code> columns and <code class="reqn">217</code> rows.
<code>CLAY.SALL.PAUL</code> is a <code>data.frame</code> object	with <code class="reqn">3</code> columns and <code class="reqn">211</code> rows.
<code>CLOU.SALL.PAUL</code> is a <code>data.frame</code> object	with <code class="reqn">3</code> columns and <code class="reqn">217</code> rows.
Missing observations have been discarded for each triplet.
</p>


<h3>References</h3>

<p>Beranger, B., Padoan, S. A. and Sisson, S. A. (2017).
Models for extremal dependence derived from skew-symmetric families.
<em>Scandinavian Journal of Statistics</em>, <b>44</b>(1), 21-45.
</p>

<hr>
<h2 id='WindSpeedGust'>Hourly wind gust, wind speed and air pressure at Lingen (GER), Ossendorf (GER) and Parcay-Meslay (FRA).</h2><span id='topic+WindSpeedGust'></span><span id='topic+Lingen'></span><span id='topic+Ossendorf'></span><span id='topic+ParcayMeslay'></span>

<h3>Description</h3>

<p>There are three objects of type <code>data.frame</code>, one for each location. 
</p>


<h3>Details</h3>

<p>Each object has the following columns:
</p>

<ul>
<li><p><code>WS</code>: the hourly wind speed in metres per second (m/s);
</p>
</li>
<li><p><code>WG</code>: the hourly wind gust in metres per second (m/s);
</p>
</li>
<li><p><code>DP</code>: the hourly air pressure at sea level in millibars.
</p>
</li></ul>

<p>Specifics about each object is given below:
</p>

<ul>
<li><p><code>Lingen</code>: is a <code>data.frame</code> object	with <code class="reqn">1083</code> rows and <code class="reqn">4</code> columns. Measurements are recorded between January 1982 and June 2003;
</p>
</li>
<li><p><code>Ossendorf</code>: is a <code>data.frame</code> object	with <code class="reqn">676</code> rows and <code class="reqn">4</code> columns. Measurements are recorded between March 1982 and August 1995;
</p>
</li>
<li><p><code>ParcayMeslay</code>: is a <code>data.frame</code> object	with <code class="reqn">2140</code> rows and <code class="reqn">4</code> columns. Measurements are recorded between November 1984 and July 2013.
</p>
</li></ul>



<h3>References</h3>

<p>Marcon, G., Naveau, P. and Padoan, S.A. (2017)
A semi-parametric stochastic generator for bivariate extreme events
<em>Stat</em>, <b>6</b>, 184-201.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
