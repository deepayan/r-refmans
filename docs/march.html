<!DOCTYPE html><html><head><title>Help for package march</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {march}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Employment.2'><p>Employment status in two categories (march dataset format)</p></a></li>
<li><a href='#march-package'><p>Computation of Markovian models for categorical data</p></a></li>
<li><a href='#march.AIC'><p>Compute Akaike Information Criterion (AIC).</p>
</p>
<p>The AIC (Akaike Information Criterion) is computed for</p>
a given <code>march.Model-class</code> according to the data
used during construction.</a></li>
<li><a href='#march.BIC'><p>Compute Bayesian Information Criterion (BIC).</p></a></li>
<li><a href='#march.Dataset-class'><p>Dataset for march package.</p></a></li>
<li><a href='#march.dataset.h.extractSequence'><p>Extract a sequence from a dataset.</p></a></li>
<li><a href='#march.dataset.loadFromDataFrame'><p>Construct a dataset from a data.frame or a matrix.</p></a></li>
<li><a href='#march.dataset.loadFromFile'><p>Load a dataset from a file.</p></a></li>
<li><a href='#march.Dcmm-class'><p>A Double Chain Markov Model (DCMM).</p></a></li>
<li><a href='#march.dcmm.construct'><p>Construct a double chain Markov model (DCMM).</p></a></li>
<li><a href='#march.dcmm.viterbi'><p>Viterbi algorithm for a DCMM model.</p></a></li>
<li><a href='#march.Indep-class'><p>An independence model.</p></a></li>
<li><a href='#march.indep.bailey'><p>Bailey Confidence Intervals for an Independence model.</p></a></li>
<li><a href='#march.indep.construct'><p>Construct an independence model (zero-order Markov chain).</p></a></li>
<li><a href='#march.indep.thompson'><p>Thompson Confidence Intervals for an Independence model.</p></a></li>
<li><a href='#march.Mc-class'><p>A Markov chain of order &gt;= 1.</p></a></li>
<li><a href='#march.mc.bailey'><p>Bailey Confidence Intervals for a Markov chain.</p></a></li>
<li><a href='#march.mc.construct'><p>Construct an homogeneous Markov Chain.</p></a></li>
<li><a href='#march.mc.thompson'><p>Thompson Confidence Intervals for a Markov chain model.</p></a></li>
<li><a href='#march.Model-class'><p>A basic and virtual march model.</p></a></li>
<li><a href='#march.Mtd-class'><p>A Mixture Transition Distribution (MTD) model.</p></a></li>
<li><a href='#march.mtd.bailey'><p>Bailey Confidence Intervals for a MTD model.</p></a></li>
<li><a href='#march.mtd.construct'><p>Construct a Mixture Transition Distribution (MTD) model.</p></a></li>
<li><a href='#march.mtd.thompson'><p>Thompson Confidence Intervals for a MTD model.</p></a></li>
<li><a href='#march.read'><p>Load a march.Model.</p></a></li>
<li><a href='#march.summary'><p>march.Model Summary.</p></a></li>
<li><a href='#march.write'><p>Save a march.Model</p></a></li>
<li><a href='#pewee'><p>Song of the Wood Pewee (march dataset format)</p></a></li>
<li><a href='#pewee_df'><p>Song of the Wood Pewee (data frame format)</p></a></li>
<li><a href='#pewee_t'><p>Song of the Wood Pewee (text format)</p></a></li>
<li><a href='#sleep'><p>Sleep disorders (march dataset format)</p></a></li>
<li><a href='#sleep_df'><p>Sleep disorders (data frame format)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Markov Chains</td>
</tr>
<tr>
<td>Description:</td>
<td>Computation of various Markovian models for categorical data
    including homogeneous Markov chains of any order, MTD models, Hidden Markov
    models, and Double Chain Markov Models.</td>
</tr>
<tr>
<td>Version:</td>
<td>3.3.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-11-26</td>
</tr>
<tr>
<td>Author:</td>
<td>Ogier Maitre and Kevin Emery, with contributions from Oliver Buschor and Andre Berchtold </td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Andre Berchtold &lt;andre.berchtold@unil.ch&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Repository/R-Forge/Project:</td>
<td>march</td>
</tr>
<tr>
<td>Repository/R-Forge/Revision:</td>
<td>152</td>
</tr>
<tr>
<td>Repository/R-Forge/DateTimeStamp:</td>
<td>2020-11-26 14:25:15</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-11-26 15:40:02 UTC</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-11-26 14:47:19 UTC; rforge</td>
</tr>
</table>
<hr>
<h2 id='Employment.2'>Employment status in two categories (march dataset format)</h2><span id='topic+Employment.2'></span>

<h3>Description</h3>

<p>This dataset contains 845 sequences of 13 observations of a categorical variable representing the professional status categorized into 2 categories: 1=&quot;Full time employee&quot;, 2=&quot;Other situation&quot;. 
The first observation of each sequence corresponds to the situation of the respondent at age 20, and then following data were observed each two years, the last observation corresponding to the situation at
age 44. In addition, two covariates are also provided in the dataset. The first one is a fixed covariate representing gender (1=&quot;Female&quot;, 2=&quot;Male&quot;), and the second one is a
time varying covariate representing the health status (1=&quot;Good&quot;, 2=&quot;Bad&quot;).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Employment.2)</code></pre>


<h3>Format</h3>

<p>A march dataset.</p>


<h3>Source</h3>

<p>Swiss Household Panel</p>


<h3>References</h3>

<p>Tillmann, R., Voorpostel, M., Antal, E., Kuhn, U., Lebert, F., Ryser, V.A., Lipps, O., and Wernli, B. (2016). The Swiss Household Panel Study: Observing social change since 1999. Longitudinal and Life Course Studies, 7(1):64-78.
</p>

<hr>
<h2 id='march-package'>Computation of Markovian models for categorical data</h2><span id='topic+march'></span>

<h3>Description</h3>

<p>This package is dedicated to the computation of various Markovian models for categorical data including the independence model, homogeneous Markov chains of any order, the Mixture Transition Distribution (MTD) model for the approximation of high-order homogeneous Markov chains, Hidden Markov Models (HMMs) and Double Chain Markov Models (DCMMs).
</p>


<h3>Author(s)</h3>

<p>Ogier Maitre and Kevin Emery, with contributions from Oliver Buschor and Andre Berchtold</p>


<h3>References</h3>

<p>Berchtold A, Raftery AE (2002) The Mixture Transition Distribution Model for High-Order Markov Chains and Non-Gaussian Time-Series.
<em>Statistical Science</em> 17(3), 328-356.
</p>
<p>Berchtold A (2002) High-order extensions of the Double Chain Markov Model. 
<em>Stochastic Models</em> 18, 193-227.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+march.Model-class">march.Model-class</a></code>, <code><a href="#topic+march.Dataset-class">march.Dataset-class</a></code>.
</p>

<hr>
<h2 id='march.AIC'>Compute Akaike Information Criterion (AIC).
The AIC (Akaike Information Criterion) is computed for
a given <code><a href="#topic+march.Model-class">march.Model-class</a></code> according to the data
used during construction.</h2><span id='topic+march.AIC'></span>

<h3>Description</h3>

<p>Compute Akaike Information Criterion (AIC).
</p>
<p>The AIC (Akaike Information Criterion) is computed for
a given <code><a href="#topic+march.Model-class">march.Model-class</a></code> according to the data
used during construction.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>march.AIC(model)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="march.AIC_+3A_model">model</code></td>
<td>
<p>The model for which the AIC has to be computed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The number of parameters of the given model and its AIC.
</p>


<h3>Author(s)</h3>

<p>Ogier Maitre
</p>


<h3>Examples</h3>

<pre><code class='language-R'>indepModel &lt;- march.indep.construct(pewee)
march.AIC(indepModel)
</code></pre>

<hr>
<h2 id='march.BIC'>Compute Bayesian Information Criterion (BIC).</h2><span id='topic+march.BIC'></span>

<h3>Description</h3>

<p>The BIC (Bayesian Information Criterion) is computed for
a given <code><a href="#topic+march.Model-class">march.Model-class</a></code> according to the data
used during construction.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>march.BIC(model)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="march.BIC_+3A_model">model</code></td>
<td>
<p>The model for which the BIC has to be computed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The number of parameters of the given model and its BIC.
</p>


<h3>Author(s)</h3>

<p>Ogier Maitre
</p>


<h3>Examples</h3>

<pre><code class='language-R'>indepModel &lt;- march.indep.construct(pewee)
march.BIC(indepModel)
</code></pre>

<hr>
<h2 id='march.Dataset-class'>Dataset for march package.</h2><span id='topic+march.Dataset-class'></span>

<h3>Description</h3>

<p>This class contains several discrete-valued time series, in a dataset. It contains for each sequence, 
its length and weights.
</p>


<h3>Details</h3>

<p>The internal representation uses factor-like representation. The integer values correspond to the words stored
into the dictionary vector. Therefor, they are in the interval [1,K].
</p>
<p>@section Slots:
</p>

<dl>
<dt><code>yRaw</code>:</dt><dd><p>A matrix of <code><a href="base.html#topic+character">character</a></code> string, describing the content of 
the original dataset or file, if any.</p>
</dd>
<dt><code>y</code>:</dt><dd><p>A list of vector of <code><a href="base.html#topic+integer">integer</a></code> representing the  each discrete-valued time series
of the dataset, as can be used by the models.</p>
</dd>
<dt><code>T</code>:</dt><dd><p>A vector of <code><a href="base.html#topic+integer">integer</a></code> values representing the length of each sequence.</p>
</dd>
<dt><code>weights</code>:</dt><dd><p>A vector of <code><a href="base.html#topic+numeric">numeric</a></code> values representing the weight of each sequence.</p>
</dd>
<dt><code>K</code>:</dt><dd><p>A <code><a href="base.html#topic+integer">integer</a></code> value representing the number of possible ouput and the number
of words stored into the dictionary.</p>
</dd>
<dt><code>N</code>:</dt><dd><p>A <code><a href="base.html#topic+integer">integer</a></code> value representing the number of sequence.</p>
</dd>
<dt><code>Dictionary</code>:</dt><dd><p>A vector of <code><a href="base.html#topic+character">character</a></code> string representing the translation between 
the yRaw and y data. Each character string is stored according to the integer which represents it into y.</p>
</dd>
<dt><code>cov</code>:</dt><dd><p>A matrix of <code><a href="base.html#topic+integer">integer</a></code> representing the covariates.</p>
</dd>
<dt><code>Kcov</code>:</dt><dd><p>A vector of <code><a href="base.html#topic+integer">integer</a></code> representing the number of possible output for each covariate.</p>
</dd>
<dt><code>Ncov</code>:</dt><dd><p>A <code><a href="base.html#topic+integer">integer</a></code> value representing the number of covariates.</p>
</dd>
</dl>

<p>@seealso <code><a href="#topic+march.dataset.loadFromFile">march.dataset.loadFromFile</a></code>, <code><a href="#topic+march.dataset.loadFromDataFrame">march.dataset.loadFromDataFrame</a></code>
@author Ogier Maitre
</p>

<hr>
<h2 id='march.dataset.h.extractSequence'>Extract a sequence from a dataset.</h2><span id='topic+march.dataset.h.extractSequence'></span>

<h3>Description</h3>

<p>Extract a sequence from a dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>march.dataset.h.extractSequence(y, i)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="march.dataset.h.extractSequence_+3A_y">y</code></td>
<td>
<p>A sequence of integers.</p>
</td></tr>
<tr><td><code id="march.dataset.h.extractSequence_+3A_i">i</code></td>
<td>
<p>The number of observations to keep.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ogier Maitre
</p>

<hr>
<h2 id='march.dataset.loadFromDataFrame'>Construct a dataset from a data.frame or a matrix.</h2><span id='topic+march.dataset.loadFromDataFrame'></span>

<h3>Description</h3>

<p>The function creates a <code><a href="#topic+march.Dataset-class">march.Dataset-class</a></code> from a <em>dataframe</em> or a <em>matrix</em>, where each row (resp. column) represents 
an independent data series when <em>MARGIN</em> is 2 (resp. 1).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>march.dataset.loadFromDataFrame(
  dataframe,
  MARGIN = 2,
  weights = NA,
  missingDataRep = NA,
  covariates = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="march.dataset.loadFromDataFrame_+3A_dataframe">dataframe</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> containing the dataset.</p>
</td></tr>
<tr><td><code id="march.dataset.loadFromDataFrame_+3A_margin">MARGIN</code></td>
<td>
<p>The dimension of the matrix/data.frame that contains the sequences and of the covariates (resp 1 for the column, 
2 for the rows).</p>
</td></tr>
<tr><td><code id="march.dataset.loadFromDataFrame_+3A_weights">weights</code></td>
<td>
<p>If specified, contains the weight of each sequence.</p>
</td></tr>
<tr><td><code id="march.dataset.loadFromDataFrame_+3A_missingdatarep">missingDataRep</code></td>
<td>
<p>If specified, the symbol representing a missing data.</p>
</td></tr>
<tr><td><code id="march.dataset.loadFromDataFrame_+3A_covariates">covariates</code></td>
<td>
<p>If specified, a three dimensional array of integers, representing the covariates. The data for the i-th covariates
should be in [, , i]. If the data are column-wise (respectively row-wise), each table of covariates should be column-wise (respectively row-wise).
If we only have one covariate, we can simply pass a two-dimensional array. The covariates should be coded as integers from 1 to the number of possible outputs.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="#topic+march.Dataset-class">march.Dataset-class</a></code> object containing the data contructed from the matrix or data.frame.
</p>


<h3>Author(s)</h3>

<p>Ogier Maitre
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Create a march dataset from the sleep_df dataframe included in the march package.
sleep &lt;- march.dataset.loadFromDataFrame(sleep_df, MARGIN = 2,
                            weights = NA, missingDataRep = NA)

# Each row of sleep_df contains the data for one subject, so MARGIN was set to 2.

# Most of the subjects have been observed during 7 consecutive years,
# but some subjects have been observed for only 5 or 6 years.
# To load only the first 5 observations of each subject:
sleep.5 &lt;- march.dataset.loadFromDataFrame(sleep_df[,1:5], MARGIN = 2 ,
                            weights = NA, missingDataRep = NA)

# The sleep data are not weighted.
# To add a weighting variable taking value 1.5 for the 500 first subjects
# and value 0.5 for the 500 next:
weighting &lt;- rep(1.5,1000)
weighting[501:1000] &lt;- rep(0.5,500)
sleep.w &lt;- march.dataset.loadFromDataFrame(sleep_df, MARGIN = 2,
                           weights = weighting, missingDataRep = NA)

# We add two covariates to the sleep data. The first is the sex of the subject
# (1 for male, 2 for female), and the second is the age range (1 for younger
# than 40, 2 for older than 40). We suppose that the first 250 sequences 
# represent men older than 40, the next 250 sequences men younger than 40,
# the next 250 women younger than 40 and the last 250 women older than 40.
# We build the two tables of covariates and bind them together to obtain a
# three dimensional array that can be handled by MARCH.
covariates.sex&lt;-rbind(matrix(1,500,7),matrix(1,500,7))
covariates.age&lt;-rbind(matrix(1,250,7), matrix(2,250,7), matrix(1,250,7),
                    matrix(2,250,7))
covariates&lt;-array(0,c(1000,7,2))
covariates[ , ,1]&lt;-covariates.sex
covariates[ , ,2]&lt;-covariates.age
# We build a MARCH dataset object containing these covariates.
sleep.covariates&lt;-march.dataset.loadFromDataFrame(sleep_df,covariates=covariates)
</code></pre>

<hr>
<h2 id='march.dataset.loadFromFile'>Load a dataset from a file.</h2><span id='topic+march.dataset.loadFromFile'></span>

<h3>Description</h3>

<p>The function loads a dataset from a text file, where each row (resp. column) represents 
a data series when <em>MARGIN</em> is 2 (resp. 1), using the character <em>sep</em> as attribute separator. 
Each data sequence should be stored in a given column, (resp. row).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>march.dataset.loadFromFile(filename, MARGIN = 2, sep = ",", weights = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="march.dataset.loadFromFile_+3A_filename">filename</code></td>
<td>
<p>The complete path to the text file containing the dataset.</p>
</td></tr>
<tr><td><code id="march.dataset.loadFromFile_+3A_margin">MARGIN</code></td>
<td>
<p>The dimension of the extracted data.frame that contains the sequences (resp 1 for the column, 2 for the rows).</p>
</td></tr>
<tr><td><code id="march.dataset.loadFromFile_+3A_sep">sep</code></td>
<td>
<p>A caracter used as element separator on a line.</p>
</td></tr>
<tr><td><code id="march.dataset.loadFromFile_+3A_weights">weights</code></td>
<td>
<p>If specified, contains the weight of each sequence.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code><a href="#topic+march.Dataset-class">march.Dataset-class</a></code> object containing the data from the file found at <em>filename</em>, using separator
<em>sep</em>.
</p>


<h3>Author(s)</h3>

<p>Ogier Maitre
#'
</p>

<hr>
<h2 id='march.Dcmm-class'>A Double Chain Markov Model (DCMM).</h2><span id='topic+march.Dcmm-class'></span>

<h3>Description</h3>

<p>This class describes a Double Chain Markov Model (DCMM) represented by Pi, the probability distributions of the first
hidden states; by A, the transition matrix between hidden states; by RB, the transition matrix between sucessive output.
march. Dcmm extends <code><a href="#topic+march.Model-class">march.Model-class</a></code> class and therefore inherits its slots.
</p>


<h3>Details</h3>

<p>The model used here is described in :
</p>

<ul>
<li><p> Berchtold, A.: The Double Chain Markov Model. Commun. Stat., Theory Methods 28 (1999), pp. 2569-2589  
</p>
</li>
<li><p> Berchtold, A.: High-order extensions of the Double Chain Markov Model. Stochastic Models 18 (2002), pp. 193-227.  
</p>
</li></ul>



<h3>Slots</h3>


<dl>
<dt><code>Pi</code>:</dt><dd><p>A 3D matrix of <code><a href="base.html#topic+numeric">numeric</a></code> representing the probability distribution 
of the first hidden state.</p>
</dd>
<dt><code>A</code>:</dt><dd><p>A matrix of <code><a href="base.html#topic+numeric">numeric</a></code> representing the transition matrix between hidden states.</p>
</dd>
<dt><code>RB</code>:</dt><dd><p>A 3D matrix of <code><a href="base.html#topic+numeric">numeric</a></code> representing the transition matrix between successive 
output, in a reduced form.</p>
</dd>
<dt><code>M</code>:</dt><dd><p>An <code><a href="base.html#topic+integer">integer</a></code> value representing the number of hidden state.</p>
</dd>
<dt><code>orderVC</code>:</dt><dd><p>An <code><a href="base.html#topic+integer">integer</a></code> value representing the order of the visible Markov chain.</p>
</dd>
<dt><code>orderHC</code>:</dt><dd><p>An <code><a href="base.html#topic+integer">integer</a></code> value representing the order of the hidden Markov chain.</p>
</dd>
<dt><code>Amodel</code>:</dt><dd><p>A vector of <code><a href="base.html#topic+character">character</a></code> string representing the modeling of the hidden transition matrix (complete, mtd or mtdg)</p>
</dd>
<dt><code>Cmodel</code>:</dt><dd><p>A vector of <code><a href="base.html#topic+character">character</a></code> string representing the modeling of the visible transition matrix (complete, mtd or mtdg)</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+march.dcmm.construct">march.dcmm.construct</a></code>, <code><a href="#topic+march.Model-class">march.Model-class</a></code>.
</p>

<hr>
<h2 id='march.dcmm.construct'>Construct a double chain Markov model (DCMM).</h2><span id='topic+march.dcmm.construct'></span>

<h3>Description</h3>

<p>Construct a <code><a href="#topic+march.Dcmm-class">march.Dcmm-class</a></code> object, with visible order <em>orderVC</em>, hidden order <em>orderHC</em> and <em>M</em> hidden states, according to a <code><a href="#topic+march.Dataset-class">march.Dataset-class</a></code>.
The first <em>maxOrder</em>-<em>orderVC</em> elements of each sequence are truncated in order to return a model
which can be compared with other Markovian model of visible order maxOrder. The construction is performed either by an evolutionary algorithm (EA) or by improving an existing DCMM.
The EA performs <em>gen</em> generations on a population of <em>popSize</em> individuals. The EA behaves as a Lamarckian evolutionary algorithm, using a Baum-Welch algorithm as
optimization step, running until log-likelihood improvement is less than <em>stopBw</em> or for <em>iterBw</em> iterations. Finally only the best individual from the population is returned as solution.
If a seedModel is provided, the only step executed is the optimization step, parameters related to the EA do not apply in this case.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>march.dcmm.construct(
  y,
  orderHC,
  orderVC,
  M = 2,
  gen = 5,
  popSize = 4,
  maxOrder = orderVC,
  seedModel = NULL,
  iterBw = 2,
  stopBw = 0.1,
  Amodel = "mtd",
  Cmodel = "mtd",
  AMCovar = 0,
  CMCovar = 0,
  AConst = FALSE,
  pMut = 0.05,
  pCross = 0.5
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="march.dcmm.construct_+3A_y">y</code></td>
<td>
<p>the dataset from which the Dcmm will be constructed <code><a href="#topic+march.Dataset-class">march.Dataset-class</a></code>.</p>
</td></tr>
<tr><td><code id="march.dcmm.construct_+3A_orderhc">orderHC</code></td>
<td>
<p>the order of the hidden chain of the constructed Dcmm.</p>
</td></tr>
<tr><td><code id="march.dcmm.construct_+3A_ordervc">orderVC</code></td>
<td>
<p>the order of the visible chain of the constructed Dcmm (0 for a HMM).</p>
</td></tr>
<tr><td><code id="march.dcmm.construct_+3A_m">M</code></td>
<td>
<p>the number of hidden states of the Dcmm.</p>
</td></tr>
<tr><td><code id="march.dcmm.construct_+3A_gen">gen</code></td>
<td>
<p>the number of generations performed by the EA.</p>
</td></tr>
<tr><td><code id="march.dcmm.construct_+3A_popsize">popSize</code></td>
<td>
<p>the number of individuals stored into the population.</p>
</td></tr>
<tr><td><code id="march.dcmm.construct_+3A_maxorder">maxOrder</code></td>
<td>
<p>the maximum visible order among the set of Markovian models to compare.</p>
</td></tr>
<tr><td><code id="march.dcmm.construct_+3A_seedmodel">seedModel</code></td>
<td>
<p>a model to optimize using Baum-Welch algorithm.</p>
</td></tr>
<tr><td><code id="march.dcmm.construct_+3A_iterbw">iterBw</code></td>
<td>
<p>the number of iterations performed by the Baum-Welch algorithm.</p>
</td></tr>
<tr><td><code id="march.dcmm.construct_+3A_stopbw">stopBw</code></td>
<td>
<p>the minimum increase in quality (log-likelihood) authorized in the Baum-Welch algorithm.</p>
</td></tr>
<tr><td><code id="march.dcmm.construct_+3A_amodel">Amodel</code></td>
<td>
<p>the modeling of the hidden transition matrix (mtd, mtdg or complete)</p>
</td></tr>
<tr><td><code id="march.dcmm.construct_+3A_cmodel">Cmodel</code></td>
<td>
<p>the modeling of the visible transition matrix (mtd, mtdg or complete)</p>
</td></tr>
<tr><td><code id="march.dcmm.construct_+3A_amcovar">AMCovar</code></td>
<td>
<p>vector of the size Ncov indicating which covariables are used into the hidden process (0: no, 1:yes)</p>
</td></tr>
<tr><td><code id="march.dcmm.construct_+3A_cmcovar">CMCovar</code></td>
<td>
<p>vector of the size Ncov indicating which covariables are used into the visible process (0: no, 1:yes)</p>
</td></tr>
<tr><td><code id="march.dcmm.construct_+3A_aconst">AConst</code></td>
<td>
<p>logical, indicating whether or not the hidden transition matrix has the identity (diagonal) constraint</p>
</td></tr>
<tr><td><code id="march.dcmm.construct_+3A_pmut">pMut</code></td>
<td>
<p>mutation probability for the evolutionary algorithm</p>
</td></tr>
<tr><td><code id="march.dcmm.construct_+3A_pcross">pCross</code></td>
<td>
<p>crossover probability for the evolutionary algorithm</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the best <code><a href="#topic+march.Dcmm-class">march.Dcmm-class</a></code> constructed by the EA or the result of the Baum-Welch algorithm on <em>seedModel</em>.
</p>


<h3>Author(s)</h3>

<p>Emery Kevin
</p>


<h3>See Also</h3>

<p><code><a href="#topic+march.Dcmm-class">march.Dcmm-class</a></code>, <code><a href="#topic+march.Model-class">march.Model-class</a></code>, <code><a href="#topic+march.Dataset-class">march.Dataset-class</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Construct a 2 hidden states DCMM for the pewee data
# with hidden order set to 2 and visible order set to 1.
# The estimation procedure uses both the evolutionary algorithm (population size 2, 
# one generation) and the Bauw-Welch algorithm (one iteration).
## Not run: march.dcmm.construct(y=pewee,orderHC=2,
                              orderVC=1,M=2,popSize=2,gen=1,iterBw=1,stopBw=0.0001)
 
# Same as above, but the DCMM is replaced by a HMM (the visible order OrderVC is set to zero).
HMM&lt;-march.dcmm.construct(y=pewee,orderHC=2,orderVC=0,M=2,popSize=2,gen=1,iterBw=1,stopBw=0.0001)  

# A first model is computed using both EA and Baum-Welch algorithms.
# The previous model is improved through two rounds of Baum-Welch optimization.
models &lt;- list()
models[[length(models)+1]] &lt;- HMM
models[[length(models)+1]] &lt;- march.dcmm.construct(y=pewee,seedModel=models[[1]],
                                                   orderVC=0,iterBw=10,stopBw=0.001)
models[[length(models)+1]] &lt;- march.dcmm.construct(y=pewee,seedModel=models[[2]],
                                                   orderVC=0,iterBw=10,stopBw=0.0001)
# Show performance indicators (ll, number of independent parameters,
# BIC and AIC) for all computed models.
#r &lt;- do.call(rbind,lapply(models,march.summary))
#print(r)

# Construct a three hidden states, first-order HMM (hence OrderVC=0) for the sleep data.
# By setting gen=1 and popSize=1, the estimation procedure uses only the Baum-Welch algorithm.
HMM &lt;- march.dcmm.construct(pewee,orderHC=1,orderVC=0,M=2,gen=1,popSize=1,iterBw=10,stopBw=0.0001)
## End(Not run)


</code></pre>

<hr>
<h2 id='march.dcmm.viterbi'>Viterbi algorithm for a DCMM model.</h2><span id='topic+march.dcmm.viterbi'></span>

<h3>Description</h3>

<p>Viterbi algorithm for a DCMM model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>march.dcmm.viterbi(d)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="march.dcmm.viterbi_+3A_d">d</code></td>
<td>
<p>The <code><a href="#topic+march.Dcmm-class">march.Dcmm-class</a></code> on which to compute the most likely sequences of hidden states.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of vectors containing the most likely sequences of hidden states, considering the given model for each sequence of the given dataset.
</p>


<h3>Author(s)</h3>

<p>Kevin Emery
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(327)
# Computation of a DCMM model
## Not run: model &lt;- march.dcmm.construct(y=pewee,orderHC=1,orderVC=1,M=2,popSize=1,gen=1)
# Extraction of the best sequence of hidden states using the Viterbi algorithm.
bestSeq &lt;- march.dcmm.viterbi(model)
print(bestSeq)
## End(Not run)
</code></pre>

<hr>
<h2 id='march.Indep-class'>An independence model.</h2><span id='topic+march.Indep-class'></span>

<h3>Description</h3>

<p>This class describes an independence model, represented by the probability distribution <em>indP</em> of each event
and the number of data used to compute each member of the probability distribution. march.Indep inherits
from <code><a href="#topic+march.Model-class">march.Model-class</a></code> and therefore inherits its slots.
</p>


<h3>Slots</h3>


<dl>
<dt><code>indP</code>:</dt><dd><p>A vector of <code><a href="base.html#topic+numeric">numeric</a></code> representing the model probability distribution.</p>
</dd>
<dt><code>indC</code>:</dt><dd><p>A vector of <code><a href="base.html#topic+integer">integer</a></code> representing the number of data used to compute each
member of the probability distribution.</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+march.indep.construct">march.indep.construct</a></code>, <code><a href="#topic+march.Model-class">march.Model-class</a></code>.
</p>

<hr>
<h2 id='march.indep.bailey'>Bailey Confidence Intervals for an Independence model.</h2><span id='topic+march.indep.bailey'></span>

<h3>Description</h3>

<p>Compute the confidence intervals using Bailey's formula on a march.Indep
object. See Bailey BJR (1980) Large sample simultaneous confidence intervals
for the multinomial probabilities based ontransformation of the cell frequencies,
Technometrics 22:583–589, for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>march.indep.bailey(object, alpha)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="march.indep.bailey_+3A_object">object</code></td>
<td>
<p>the march.Model object on which compute the confidence intervals.</p>
</td></tr>
<tr><td><code id="march.indep.bailey_+3A_alpha">alpha</code></td>
<td>
<p>the significance level.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of half-length confidence intervals for each probability of the independence model.
</p>


<h3>Author(s)</h3>

<p>Berchtold André
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Compute the independence model for the pewee data.
Indep &lt;- march.indep.construct(pewee)
# Display the model
print(Indep)
# Compute the half-length 95% confidence interval for each element of the distribution.
march.indep.bailey(Indep,alpha=0.05)

# Compute a second-order MTDg model for the pewee data.
MTD2g &lt;- march.mtd.construct(pewee,2,mtdg=TRUE)
# Display the model
print(MTD2g)
# Compute the half-length 95% confidence interval for all parameters
# of the MTD2g model.
march.mtd.bailey(MTD2g,alpha=0.05)
</code></pre>

<hr>
<h2 id='march.indep.construct'>Construct an independence model (zero-order Markov chain).</h2><span id='topic+march.indep.construct'></span>

<h3>Description</h3>

<p>Construct a <code><a href="#topic+march.Indep-class">march.Indep-class</a></code> model from a given <code><a href="#topic+march.Dataset-class">march.Dataset-class</a></code>,
the first <em>maxOrder</em> elements of each sequence being truncated in order to return a model
which can be compared with other Markovian models of visible order maxOrder.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>march.indep.construct(y, maxOrder = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="march.indep.construct_+3A_y">y</code></td>
<td>
<p>the <code><a href="#topic+march.Dataset-class">march.Dataset-class</a></code> from which construct the model.</p>
</td></tr>
<tr><td><code id="march.indep.construct_+3A_maxorder">maxOrder</code></td>
<td>
<p>the maximum visible order among the set of Markovian models to compare.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The <code><a href="#topic+march.Indep-class">march.Indep-class</a></code> constructed using dataset y and maxOrder.
</p>


<h3>Author(s)</h3>

<p>Ogier Maitre
</p>


<h3>See Also</h3>

<p><code><a href="#topic+march.Indep-class">march.Indep-class</a></code>, <code><a href="#topic+march.Model-class">march.Model-class</a></code>, <code><a href="#topic+march.Dataset-class">march.Dataset-class</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Build an independance model from the pewee data set.
model &lt;- march.indep.construct(pewee)
print(model)
</code></pre>

<hr>
<h2 id='march.indep.thompson'>Thompson Confidence Intervals for an Independence model.</h2><span id='topic+march.indep.thompson'></span>

<h3>Description</h3>

<p>Compute the confidence intervals using Thompson's formula on a march.Indep
object. See Thompson SK (1987) Sample size for estimating multinomial proportions,
American Statistician 41:42-46, for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>march.indep.thompson(object, alpha)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="march.indep.thompson_+3A_object">object</code></td>
<td>
<p>the march.Model object on which compute the confidence intervals.</p>
</td></tr>
<tr><td><code id="march.indep.thompson_+3A_alpha">alpha</code></td>
<td>
<p>the significance level among : 0.5, 0.4, 0.3, 0.2, 0.1, 0.05, 0.025, 0.02, 0.01, 0.005, 0.001, 0.0005, 0.0001.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of half-length confidence intervals for each probability of the independence model.
</p>


<h3>Author(s)</h3>

<p>Ogier Maitre, Kevin Emery
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Compute a first-order homogeneous Markov Chain for the pewee data.
MC1 &lt;- march.mc.construct(pewee,1)
# Display the transition matrix
print(MC1@RC)
# Compute the half-length 95% confidence interval for each row of the transition matrix.
march.mc.thompson(MC1,alpha=0.05)

# Compute a third-order MTD model for the pewee data.
MTD3 &lt;- march.mtd.construct(pewee,3)
# Display the model
print(MTD3)
# Compute the half-length 95% confidence interval for the vector of lags
# and for each row of the transition matrix.
march.mtd.thompson(MTD3,alpha=0.05)
</code></pre>

<hr>
<h2 id='march.Mc-class'>A Markov chain of order &gt;= 1.</h2><span id='topic+march.Mc-class'></span>

<h3>Description</h3>

<p>This class describes a Markov chain of order <em>order</em>, represented by matricess RC (transition matrix in reduced form)
and RT (number of data points used to compute each transition). march.Mc extends <code><a href="#topic+march.Model-class">march.Model-class</a></code> class and therefore
inherits its slots.
</p>


<h3>Slots</h3>


<dl>
<dt><code>RC</code>:</dt><dd><p>A matrix of <code><a href="base.html#topic+numeric">numeric</a></code> representing the reduced form of the 
transition matrix of the current Markov Chain.</p>
</dd>
<dt><code>order</code>:</dt><dd><p>An <code><a href="base.html#topic+integer">integer</a></code> representing the order of the current Markov Chain.</p>
</dd>
<dt><code>RT</code>:</dt><dd><p>A matrix of <code><a href="base.html#topic+integer">integer</a></code> representing the number of sample used to compute each 
transition row of the current RC matrix.</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+march.mc.construct">march.mc.construct</a></code>, <code><a href="#topic+march.Model-class">march.Model-class</a></code>.
</p>

<hr>
<h2 id='march.mc.bailey'>Bailey Confidence Intervals for a Markov chain.</h2><span id='topic+march.mc.bailey'></span>

<h3>Description</h3>

<p>Compute the confidence intervals using Bailey's formula on a march.Mc
object. See Bailey BJR (1980) Large sample simultaneous confidence intervals
for the multinomial probabilities based ontransformation of the cell frequencies,
Technometrics 22:583–589, for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>march.mc.bailey(object, alpha)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="march.mc.bailey_+3A_object">object</code></td>
<td>
<p>the march.Model object on which compute the confidence intervals.</p>
</td></tr>
<tr><td><code id="march.mc.bailey_+3A_alpha">alpha</code></td>
<td>
<p>the significance level.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of half-length confidence intervals for each probability distribution of the Markov chain.
</p>


<h3>Author(s)</h3>

<p>Berchtold André
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Compute the independence model for the pewee data.
Indep &lt;- march.indep.construct(pewee)
# Display the model
print(Indep)
# Compute the half-length 95% confidence interval for each element of the distribution.
march.indep.bailey(Indep,alpha=0.05)

# Compute a second-order MTDg model for the pewee data.
MTD2g &lt;- march.mtd.construct(pewee,2,mtdg=TRUE)
# Display the model
print(MTD2g)
# Compute the half-length 95% confidence interval for all parameters
# of the MTD2g model.
march.mtd.bailey(MTD2g,alpha=0.05)
</code></pre>

<hr>
<h2 id='march.mc.construct'>Construct an homogeneous Markov Chain.</h2><span id='topic+march.mc.construct'></span>

<h3>Description</h3>

<p>A <code><a href="#topic+march.Mc-class">march.Mc-class</a></code> object of order <em>order</em> is constructed from
the dataset <em>y</em>. The first maxOrder-order elements of each sequence of the dataset are truncated in order to return a model
which can be compared with other Markovian models of visible order maxOrder.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>march.mc.construct(y, order, maxOrder = order)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="march.mc.construct_+3A_y">y</code></td>
<td>
<p>the <code><a href="#topic+march.Dataset-class">march.Dataset-class</a></code> from which the homogeneous Markov chain will be constructed.</p>
</td></tr>
<tr><td><code id="march.mc.construct_+3A_order">order</code></td>
<td>
<p>the order of the constructed Markov Chain.</p>
</td></tr>
<tr><td><code id="march.mc.construct_+3A_maxorder">maxOrder</code></td>
<td>
<p>the maximum visible order among the set of Markovian models to compare.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the <code><a href="#topic+march.Mc-class">march.Mc-class</a></code> of order <em>order</em> constructed <em>w.r.t</em> the dataset <em>y</em> and maxOrder.
</p>


<h3>Author(s)</h3>

<p>Ogier Maitre
</p>


<h3>See Also</h3>

<p><code><a href="#topic+march.Mc-class">march.Mc-class</a></code>, <code><a href="#topic+march.Model-class">march.Model-class</a></code>, <code><a href="#topic+march.Dataset-class">march.Dataset-class</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># pewee dataset is a data object of the march package in march.Dataset class format.
model &lt;- march.mc.construct(pewee,2)

# print the reduced form of the transition matrix of the Markovian Model.
print(model@RC)
</code></pre>

<hr>
<h2 id='march.mc.thompson'>Thompson Confidence Intervals for a Markov chain model.</h2><span id='topic+march.mc.thompson'></span>

<h3>Description</h3>

<p>Compute the confidence intervals using Thompson's formula on a march.Mc
object. See Thompson SK (1987) Sample size for estimating multinomial proportions,
American Statistician 41:42-46, for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>march.mc.thompson(object, alpha)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="march.mc.thompson_+3A_object">object</code></td>
<td>
<p>the march.Model object on which compute the confidence intervals.</p>
</td></tr>
<tr><td><code id="march.mc.thompson_+3A_alpha">alpha</code></td>
<td>
<p>the significance level among : 0.5, 0.4, 0.3, 0.2, 0.1, 0.05, 0.025, 0.02, 0.01, 0.005, 0.001, 0.0005, 0.0001.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of half-length confidence intervals for each probability distribution of the Markov chain.
</p>


<h3>Author(s)</h3>

<p>Ogier Maitre, Kevin Emery
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Compute a first-order homogeneous Markov Chain for the pewee data.
MC1 &lt;- march.mc.construct(pewee,1)
# Display the transition matrix
print(MC1@RC)
# Compute the half-length 95% confidence interval for each row of the transition matrix.
march.mc.thompson(MC1,alpha=0.05)

# Compute a third-order MTD model for the pewee data.
MTD3 &lt;- march.mtd.construct(pewee,3)
# Display the model
print(MTD3)
# Compute the half-length 95% confidence interval for the vector of lags
# and for each row of the transition matrix.
march.mtd.thompson(MTD3,alpha=0.05)
</code></pre>

<hr>
<h2 id='march.Model-class'>A basic and virtual march model.</h2><span id='topic+march.Model-class'></span>

<h3>Description</h3>

<p>This class describe the basic and virtual model, that every model of the package will extend.
This is a virtual class, which is not meant to be handled by user directly.
</p>


<h3>See Also</h3>

<p>The classes that inherit from march.Model are : <code><a href="#topic+march.Indep-class">march.Indep-class</a></code>, <code><a href="#topic+march.Mc-class">march.Mc-class</a></code>, <code><a href="#topic+march.Mtd-class">march.Mtd-class</a></code>, <code><a href="#topic+march.Dcmm-class">march.Dcmm-class</a></code>.
</p>
<p>@section Slots:
</p>

<dl>
<dt><code>ll</code>:</dt><dd><p>A <code><a href="base.html#topic+numeric">numeric</a></code> representing the log-likelihood for this model <em>w.r.t</em> its 
construction dataset.</p>
</dd>
<dt><code>y</code>:</dt><dd><p>The <code><a href="#topic+march.Dataset-class">march.Dataset-class</a></code> used to construct the model.</p>
</dd>
<dt><code>dsL</code>:</dt><dd><p>A <code><a href="base.html#topic+numeric">numeric</a></code> representing the number of sample used to construct the model.</p>
</dd>
<dt><code>nbZeros</code>:</dt><dd><p>A <code><a href="base.html#topic+numeric">numeric</a></code> representing the number of zeros created during model construction.</p>
</dd>
</dl>


<hr>
<h2 id='march.Mtd-class'>A Mixture Transition Distribution (MTD) model.</h2><span id='topic+march.Mtd-class'></span>

<h3>Description</h3>

<p>This class describes a Mixture Transition Distribution (MTD) model, represented by its transition matrix Q,
its vector phi of lag parameters and its order. march.Mtd extends <code><a href="#topic+march.Model-class">march.Model-class</a></code> class and therefore
inherits its slots.
march.Mtd extends <code><a href="#topic+march.Model-class">march.Model-class</a></code> class and therefore inherits its slots.
</p>


<h3>Details</h3>

<p>The model used here is described into :
</p>

<ul>
<li><p> Raftery, A. E. A Model for High-Order Markov Chains. 
JRSS B 47(1985), pp. 528-539.
</p>
</li>
<li><p> Berchtold, A. Estimation in the mixture transition distribution model.
Journal of Time Series Analysis, 22 (4) (2001), pp. 379-397
</p>
</li></ul>

<p>@section Slots:
</p>

<dl>
<dt><code>Q</code>:</dt><dd><p>A matrix of <code><a href="base.html#topic+numeric">numeric</a></code> representing the transition matrix associated with the 
current MTD model.</p>
</dd>
<dt><code>S</code>:</dt><dd><p>A list of matrices of <code><a href="base.html#topic+numeric">numeric</a></code> representing the transition matrices between the covariates and the dependent variable</p>
</dd>
<dt><code>phi</code>:</dt><dd><p>A vector of <code><a href="base.html#topic+numeric">numeric</a></code> representing the vector of lag parameters.</p>
</dd>
<dt><code>order</code>:</dt><dd><p>An <code><a href="base.html#topic+integer">integer</a></code> representing the order of the model.</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+march.mtd.construct">march.mtd.construct</a></code>, <code><a href="#topic+march.Model-class">march.Model-class</a></code>.
</p>

<hr>
<h2 id='march.mtd.bailey'>Bailey Confidence Intervals for a MTD model.</h2><span id='topic+march.mtd.bailey'></span>

<h3>Description</h3>

<p>Compute the confidence intervals using Bailey's formula on a march.Mtd
object. See Bailey BJR (1980) Large sample simultaneous confidence intervals
for the multinomial probabilities based ontransformation of the cell frequencies,
Technometrics 22:583–589, for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>march.mtd.bailey(object, alpha)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="march.mtd.bailey_+3A_object">object</code></td>
<td>
<p>the march.Model object on which compute the confidence intervals.</p>
</td></tr>
<tr><td><code id="march.mtd.bailey_+3A_alpha">alpha</code></td>
<td>
<p>the significance level.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of half-length confidence intervals for each probability distribution of the MTD model.
</p>


<h3>Author(s)</h3>

<p>Berchtold André
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Compute the independence model for the pewee data.
Indep &lt;- march.indep.construct(pewee)
# Display the model
print(Indep)
# Compute the half-length 95% confidence interval for each element of the distribution.
march.indep.bailey(Indep,alpha=0.05)

# Compute a second-order MTDg model for the pewee data.
MTD2g &lt;- march.mtd.construct(pewee,2,mtdg=TRUE)
# Display the model
print(MTD2g)
# Compute the half-length 95% confidence interval for all parameters
# of the MTD2g model.
march.mtd.bailey(MTD2g,alpha=0.05)
</code></pre>

<hr>
<h2 id='march.mtd.construct'>Construct a Mixture Transition Distribution (MTD) model.</h2><span id='topic+march.mtd.construct'></span>

<h3>Description</h3>

<p>A Mixture Transition Distribution model (<code><a href="#topic+march.Mtd-class">march.Mtd-class</a></code>) object of order <em>order</em> is constructed
according to a given <code><a href="#topic+march.Dataset-class">march.Dataset-class</a></code> <em>y</em>. The first <em>maxOrder</em>-<em>order</em>
elements of each sequence are truncated in order to return a model
which can be compared with other Markovian models of visible order maxOrder.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>march.mtd.construct(
  y,
  order,
  maxOrder = order,
  mtdg = FALSE,
  MCovar = 0,
  init = "best",
  deltaStop = 1e-04,
  llStop = 0.01,
  maxIter = 0,
  seedModel = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="march.mtd.construct_+3A_y">y</code></td>
<td>
<p>the dataset (<code><a href="#topic+march.Dataset-class">march.Dataset-class</a></code>) from which to construct the model.</p>
</td></tr>
<tr><td><code id="march.mtd.construct_+3A_order">order</code></td>
<td>
<p>the order of the constructed model.</p>
</td></tr>
<tr><td><code id="march.mtd.construct_+3A_maxorder">maxOrder</code></td>
<td>
<p>the maximum visible order among the set of Markovian models to compare.</p>
</td></tr>
<tr><td><code id="march.mtd.construct_+3A_mtdg">mtdg</code></td>
<td>
<p>flag indicating whether the constructed model should be a MTDg using a different transition matrix for each lag (value: <em>TRUE</em> or <em>FALSE</em>).</p>
</td></tr>
<tr><td><code id="march.mtd.construct_+3A_mcovar">MCovar</code></td>
<td>
<p>vector of the size Ncov indicating which covariables are used (0: no, 1:yes)</p>
</td></tr>
<tr><td><code id="march.mtd.construct_+3A_init">init</code></td>
<td>
<p>the init method, to choose among <em>best</em>, <em>random</em> and <em>weighted</em>.</p>
</td></tr>
<tr><td><code id="march.mtd.construct_+3A_deltastop">deltaStop</code></td>
<td>
<p>the delta below which the optimization phases of phi and Q stop.</p>
</td></tr>
<tr><td><code id="march.mtd.construct_+3A_llstop">llStop</code></td>
<td>
<p>the ll increase below which the EM algorithm stop.</p>
</td></tr>
<tr><td><code id="march.mtd.construct_+3A_maxiter">maxIter</code></td>
<td>
<p>the maximal number of iterations of the optimisation algorithm (zero for no maximal number).</p>
</td></tr>
<tr><td><code id="march.mtd.construct_+3A_seedmodel">seedModel</code></td>
<td>
<p>an object containing a MTD or a DCMM model used to initialize the parameters of the MTD model.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ogier Maitre, Kevin Emery, Andre Berchtold
</p>


<h3>See Also</h3>

<p><code><a href="#topic+march.Mtd-class">march.Mtd-class</a></code>, <code><a href="#topic+march.Model-class">march.Model-class</a></code>, <code><a href="#topic+march.Dataset-class">march.Dataset-class</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Build a 4th order MTD model from the pewee data set.
model &lt;- march.mtd.construct(pewee,4)
print(model)

# Build a 3th order MTDg model from the pewee data set.
model &lt;- march.mtd.construct(pewee,3,mtdg=TRUE)
print(model)

</code></pre>

<hr>
<h2 id='march.mtd.thompson'>Thompson Confidence Intervals for a MTD model.</h2><span id='topic+march.mtd.thompson'></span>

<h3>Description</h3>

<p>Compute the confidence intervals using Thompson's formula on a march.Mtd
object. See Thompson SK (1987) Sample size for estimating multinomial proportions,
American Statistician 41:42-46, for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>march.mtd.thompson(object, alpha)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="march.mtd.thompson_+3A_object">object</code></td>
<td>
<p>the march.Model object on which compute the confidence intervals.</p>
</td></tr>
<tr><td><code id="march.mtd.thompson_+3A_alpha">alpha</code></td>
<td>
<p>the significance level among : 0.5, 0.4, 0.3, 0.2, 0.1, 0.05, 0.025, 0.02, 0.01, 0.005, 0.001, 0.0005, 0.0001.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of half-length confidence intervals for each probability distribution of the MTD model.
</p>


<h3>Author(s)</h3>

<p>Ogier Maitre, Kevin Emery
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Compute a first-order homogeneous Markov Chain for the pewee data.
MC1 &lt;- march.mc.construct(pewee,1)
# Display the transition matrix
print(MC1@RC)
# Compute the half-length 95% confidence interval for each row of the transition matrix.
march.mc.thompson(MC1,alpha=0.05)

# Compute a third-order MTD model for the pewee data.
MTD3 &lt;- march.mtd.construct(pewee,3)
# Display the model
print(MTD3)
# Compute the half-length 95% confidence interval for the vector of lags
# and for each row of the transition matrix.
march.mtd.thompson(MTD3,alpha=0.05)
</code></pre>

<hr>
<h2 id='march.read'>Load a march.Model.</h2><span id='topic+march.read'></span>

<h3>Description</h3>

<p>Load a march.Model from a file pointed by <em>filename</em> and check that the model is valid.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>march.read(filename)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="march.read_+3A_filename">filename</code></td>
<td>
<p>the path where load the mode</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the march.Model contained into the file pointed by filename if it exists and contains a valid model.
</p>

<hr>
<h2 id='march.summary'>march.Model Summary.</h2><span id='topic+march.summary'></span>

<h3>Description</h3>

<p>Print key values for the current model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>march.summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="march.summary_+3A_object">object</code></td>
<td>
<p>can contain the results of any model computed  using march</p>
</td></tr>
<tr><td><code id="march.summary_+3A_...">...</code></td>
<td>
<p>should indicate any additional parameter passed to the function</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ogier Maitre &amp; Andre Berchtold
</p>

<hr>
<h2 id='march.write'>Save a march.Model</h2><span id='topic+march.write'></span>

<h3>Description</h3>

<p>Save a march.Model into a file pointed by <em>filename</em>. The save will fails
if the file already exists unless force has been set to TRUE.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>march.write(filename, object, force = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="march.write_+3A_filename">filename</code></td>
<td>
<p>a path to the file where to write the model (absolute or relative to the current directory).</p>
</td></tr>
<tr><td><code id="march.write_+3A_object">object</code></td>
<td>
<p>the model to write.</p>
</td></tr>
<tr><td><code id="march.write_+3A_force">force</code></td>
<td>
<p>if TRUE and if the file pointed by the filename path already exists, overwrite it.
</p>
<p>@return invisible TRUE if the model has been written into the file pointed by filename, invisible FALSE otherwise.</p>
</td></tr>
</table>

<hr>
<h2 id='pewee'>Song of the Wood Pewee (march dataset format)</h2><span id='topic+pewee'></span>

<h3>Description</h3>

<p>This dataset contains a sequence of 1327 successive observations of the wood pewee song. This song consists in three different phrases numbered from 1 to 3.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(pewee)</code></pre>


<h3>Format</h3>

<p>A march dataset.</p>


<h3>Source</h3>

<p>Craig (1943)</p>


<h3>References</h3>

<p>Craig, W. (1943) <em>The Song of the Wood Peewee</em>; University of the State of New York:
Albany.
</p>

<hr>
<h2 id='pewee_df'>Song of the Wood Pewee (data frame format)</h2><span id='topic+pewee_df'></span>

<h3>Description</h3>

<p>This dataset contains a sequence of 1327 successive observations of the wood pewee song. This song consists in three different phrases numbered from 1 to 3.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(pewee_df)</code></pre>


<h3>Format</h3>

<p>A data frame.</p>


<h3>Source</h3>

<p>Craig (1943)</p>


<h3>References</h3>

<p>Craig, W. (1943) <em>The Song of the Wood Peewee</em>; University of the State of New York:
Albany.
</p>

<hr>
<h2 id='pewee_t'>Song of the Wood Pewee (text format)</h2><span id='topic+pewee_t'></span>

<h3>Description</h3>

<p>This dataset contains a sequence of 1327 successive observations of the wood pewee song. This song consists in three different phrases numbered from 1 to 3.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(pewee_t)</code></pre>


<h3>Format</h3>

<p>A text file.</p>


<h3>Source</h3>

<p>Craig (1943)</p>


<h3>References</h3>

<p>Craig, W. (1943) <em>The Song of the Wood Peewee</em>; University of the State of New York:
Albany.
</p>

<hr>
<h2 id='sleep'>Sleep disorders (march dataset format)</h2><span id='topic+sleep'></span>

<h3>Description</h3>

<p>This dataset contains 1000 sequences of 5 to 7 successive observation of the level of sleep disorders. Each sequence corresponds to a different subject. Possible values range from 1 (no disorder at all) to 6 (disturbed sleep each night). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(sleep)</code></pre>


<h3>Format</h3>

<p>A march dataset.</p>

<hr>
<h2 id='sleep_df'>Sleep disorders (data frame format)</h2><span id='topic+sleep_df'></span>

<h3>Description</h3>

<p>This dataset contains 1000 sequences of 5 to 7 successive observation of the level of sleep disorders. Each sequence corresponds to a different subject. Possible values range from 1 (no disorder at all) to 6 (disturbed sleep each night). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(sleep_df)</code></pre>


<h3>Format</h3>

<p>A data frame.</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
