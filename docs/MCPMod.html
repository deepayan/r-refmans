<!DOCTYPE html><html><head><title>Help for package MCPMod</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MCPMod}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#betaMod'><p> Beta model</p></a></li>
<li><a href='#biom'><p> Biometrics Dose Response data</p></a></li>
<li><a href='#critVal'><p> Calculate critical value for multiple contrast test</p></a></li>
<li><a href='#emax'><p> Emax model</p></a></li>
<li><a href='#exponential'><p> Exponential (power) model</p></a></li>
<li><a href='#fullMod'><p> Calculate location and scale parameters for candidate set of models</p></a></li>
<li><a href='#genDFdata'><p> Simulate dose-response data</p></a></li>
<li><a href='#getPars'><p> Calculate location and scale parameters</p></a></li>
<li><a href='#guesst'><p> Calculate guesstimates based on prior knowledge</p></a></li>
<li><a href='#IBS'><p> Irritable Bowel Syndrome Dose Response data</p></a></li>
<li><a href='#linear'><p> Linear Model</p></a></li>
<li><a href='#linlog'><p> Linear in log dose Model</p></a></li>
<li><a href='#logistic'><p> Logistic Model</p></a></li>
<li><a href='#LP'><p> Sensitivity analysis for misspecification of standardized model parameters</p></a></li>
<li><a href='#MCPMod'><p>Perform MCPMod analysis of a data set</p></a></li>
<li><a href='#MCPMod-internal'><p> Internal MCPMod functions</p></a></li>
<li><a href='#MCPMod-package'>
<p>Design and Analysis of Dose-Finding Studies</p></a></li>
<li><a href='#modelMeans'><p> Calculate mean vectors for a given candidate set</p></a></li>
<li><a href='#mvtnorm.control'><p> Control options for pmvt and qmvt functions</p></a></li>
<li><a href='#planMM'><p> Calculate planning quantities for MCPMod</p></a></li>
<li><a href='#plot.fullMod'><p> Plot method for fullMod objects</p></a></li>
<li><a href='#plot.LP'><p> Plot method for LP objects</p></a></li>
<li><a href='#plot.MCPMod'><p>Plot MCPMod model fits</p></a></li>
<li><a href='#plot.planMM'><p>Plotting a planMM object</p></a></li>
<li><a href='#plot.powerMM'><p> Plot method for powerMM objects</p></a></li>
<li><a href='#plotModels'><p> Plot candidate models</p></a></li>
<li><a href='#powCalc'><p> Calculate the power for the multiple contrast test</p></a></li>
<li><a href='#powerMM'><p> Calculate power for different sample sizes</p></a></li>
<li><a href='#quadratic'><p> Quadratic model</p></a></li>
<li><a href='#sampSize'><p> Sample size calculations for MCPMod</p></a></li>
<li><a href='#sigEmax'><p> Sigmoid Emax Model</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Design and Analysis of Dose-Finding Studies</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0-10.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2017-08-05</td>
</tr>
<tr>
<td>Author:</td>
<td>Bjoern Bornkamp, Jose Pinheiro and Frank Bretz</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Bjoern Bornkamp &lt;bornkamp@statistik.tu-dortmund.de&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>mvtnorm, lattice, R (&ge; 2.4.1)</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements a methodology for the design and analysis of dose-response studies that
             combines aspects of multiple comparison procedures  and modeling approaches
	     (Bretz, Pinheiro and Branson, 2005, Biometrics 61, 738-748, &lt;<a href="https://doi.org/10.1111%2Fj.1541-0420.2005.00344.x">doi:10.1111/j.1541-0420.2005.00344.x</a>&gt;).
             The package provides tools for the analysis of dose finding trials as well as a variety
             of tools necessary to plan a trial to be conducted with the MCP-Mod methodology.
             Please note: The 'MCPMod' package will not be further developed, all future development of 
             the MCP-Mod methodology will be done in the 'DoseFinding' R-package. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-03-09 14:36:14 UTC; hornik</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-03-09 15:09:13 UTC</td>
</tr>
</table>
<hr>
<h2 id='betaMod'> Beta model </h2><span id='topic+betaMod'></span>

<h3>Description</h3>

<p>The beta model is defined as
</p>
<p style="text-align: center;"><code class="reqn">
  f(d,\theta)=E_0+E_{max}B(\delta_1,\delta_2)(d/scal)^{\delta_1}(1-d/scal)^{\delta_2}
  </code>
</p>

<p>where </p>
<p style="text-align: center;"><code class="reqn">B(\delta_1,\delta_2)=(\delta_1+\delta_2)^{\delta_1+\delta_2}/(\delta_1^{\delta_1} \delta_2^{\delta_2})</code>
</p>



<h3>Usage</h3>

<pre><code class='language-R'>betaMod(dose, e0, eMax, delta1, delta2, scal)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="betaMod_+3A_dose">dose</code></td>
<td>
<p> Dose variable </p>
</td></tr>
<tr><td><code id="betaMod_+3A_e0">e0</code></td>
<td>
<p> Placebo effect </p>
</td></tr>
<tr><td><code id="betaMod_+3A_emax">eMax</code></td>
<td>
<p> Maximum effect </p>
</td></tr>
<tr><td><code id="betaMod_+3A_delta1">delta1</code></td>
<td>
<p> delta1 parameter </p>
</td></tr>
<tr><td><code id="betaMod_+3A_delta2">delta2</code></td>
<td>
<p> delta2 parameter </p>
</td></tr>
<tr><td><code id="betaMod_+3A_scal">scal</code></td>
<td>
<p> Scale parameter (not estimated in the code) </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The beta model is intended to capture non-monotone
dose-response relationships and is more flexible than the quadratic model.
The kernel of the beta model
function consists of the kernel of the density function of a beta
distribution on the interval [0,scal]. The parameter
scal is not estimated but needs to be set to a value 
larger than the maximum dose via the argument <code>scal</code>.
</p>


<h3>Value</h3>

<p>Response value
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+logistic">logistic</a></code>, <code><a href="#topic+sigEmax">sigEmax</a></code>, 
<code><a href="#topic+linlog">linlog</a></code>, <code><a href="#topic+linear">linear</a></code>, <code><a href="#topic+quadratic">quadratic</a></code>,
<code><a href="#topic+emax">emax</a></code>,  <code><a href="#topic+exponential">exponential</a></code>
</p>

<hr>
<h2 id='biom'> Biometrics Dose Response data </h2><span id='topic+biom'></span>

<h3>Description</h3>

<p>An example data set for dose response studies. This data set
was used in Bretz et al. (2005) to illustrate the MCPMod
methodology.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(biom)</code></pre>


<h3>Format</h3>

<p>A data frame with 100 observations on the following 2 variables.
</p>

<dl>
<dt><code>resp</code></dt><dd><p>a numeric vector containing the response values</p>
</dd>
<dt><code>dose</code></dt><dd><p>a numeric vector containing the dose values</p>
</dd>
</dl>



<h3>Source</h3>

<p>Bretz, F., Pinheiro, J. C., and Branson, M. (2005), Combining
multiple comparisons and modeling techniques in dose-response
studies, <em>Biometrics</em>, <b>61</b>, 738&ndash;748
</p>

<hr>
<h2 id='critVal'> Calculate critical value for multiple contrast test</h2><span id='topic+critVal'></span>

<h3>Description</h3>

<p>This function calculates the critical value for a multiple
contrast test via numerical integration (using the methods
implemented in the <code>mvtnorm</code> package).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>critVal(cMat, n, alpha = 0.025, control = mvtnorm.control(),
        twoSide = FALSE, corMat = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="critVal_+3A_cmat">cMat</code></td>
<td>
<p> A matrix with the contrasts in the columns </p>
</td></tr>
<tr><td><code id="critVal_+3A_n">n</code></td>
<td>
<p> A vector giving the sample size per group. If only one number is specified it
is assumed that the sample sizes are balanced. </p>
</td></tr>
<tr><td><code id="critVal_+3A_alpha">alpha</code></td>
<td>
<p> Level of significance (defaults to 0.025)</p>
</td></tr>
<tr><td><code id="critVal_+3A_control">control</code></td>
<td>
<p> A list of options for the <code>pmvt</code> and <code>qmvt</code> functions
as produced by <code>mvtnorm.control</code> </p>
</td></tr>
<tr><td><code id="critVal_+3A_twoside">twoSide</code></td>
<td>
<p> Logical indicating if two or one-sided critical value
should be calculated.</p>
</td></tr>
<tr><td><code id="critVal_+3A_cormat">corMat</code></td>
<td>
<p> Optional: correlation of contrasts matrix can be specified </p>
</td></tr>
</table>


<h3>Value</h3>

<p>Critical value
</p>


<h3>References</h3>

 
<p>Bretz, F., Pinheiro, J. and Branson, M. (2005), Combining
Multiple Comparisons and Modeling Techniques in Dose-Response
Studies, <em>Biometrics</em>, <b>61</b>, 738&ndash;748
</p>
<p>Hothorn, T., Bretz, F., and Genz, A. (2001), On multivariate t and
Gauss probabilities in R, <em>R News</em>, <b>1</b>, 27&ndash;29
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+planMM">planMM</a></code>, <code><a href="#topic+mvtnorm.control">mvtnorm.control</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'># Calculation of critical value for Dunnett test
# Set up contrast matrix (3 active doses)
CM &lt;- rbind(-1,diag(3))
# 30 patients per group, one-sided alpha 0.05
critVal(CM, n=30, alpha = 0.05)
# Example from R News 1(2) p. 28, 29
CM &lt;- c(1, 1, 1, 0, 0, -1, 0, 0, 1, 0, 0, -1, 0, 0,
       1, 0, 0, 0, -1, -1, 0, 0, -1, 0, 0)
CM &lt;- t(matrix(CM, ncol = 5))
critVal(CM, n=c(26, 24, 20, 33, 32), alpha = 0.05, 
    twoSide = TRUE)
</code></pre>

<hr>
<h2 id='emax'> Emax model </h2><span id='topic+emax'></span>

<h3>Description</h3>

<p>The model function for the Emax model is defined as
</p>
<p style="text-align: center;"><code class="reqn">
  f(d,\theta)=E_0+E_{max}\frac{d}{ED_{50}+d}</code>
</p>



<h3>Usage</h3>

<pre><code class='language-R'>emax(dose, e0, eMax, ed50)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="emax_+3A_dose">dose</code></td>
<td>
<p> Dose variable </p>
</td></tr>
<tr><td><code id="emax_+3A_e0">e0</code></td>
<td>
<p> Placebo effect </p>
</td></tr>
<tr><td><code id="emax_+3A_emax">eMax</code></td>
<td>
<p> Asymptotic maximum change from placebo effect </p>
</td></tr>
<tr><td><code id="emax_+3A_ed50">ed50</code></td>
<td>
<p> Dose giving half of the asymptotic maximum effect </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The emax model is used to represent monotone, concave dose-response shapes.
To distinguish it from the more general sigmoid emax model it is sometimes 
also called hyperbolic emax model.
</p>


<h3>Value</h3>

<p>Response value
</p>


<h3>References</h3>

 
<p>MacDougall, J. (2006). Analysis of dose-response studies - Emax model,<em>in</em> N. Ting (ed.),
<em>Dose Finding in Drug Development</em>, Springer, New York, pp. 127&ndash;145
</p>
<p>Pinheiro, J. C., Bretz, F. and Branson, M. (2006). Analysis of dose-response studies - modeling 
approaches, <em>in</em> N. Ting (ed.). <em>Dose Finding in Drug Development</em>, Springer, New York,
pp. 146&ndash;171
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+sigEmax">sigEmax</a></code>, <code><a href="#topic+logistic">logistic</a></code>, <code><a href="#topic+betaMod">betaMod</a></code>, 
<code><a href="#topic+linlog">linlog</a></code>, <code><a href="#topic+linear">linear</a></code>, <code><a href="#topic+quadratic">quadratic</a></code>,
<code><a href="#topic+exponential">exponential</a></code>
</p>

<hr>
<h2 id='exponential'> Exponential (power) model </h2><span id='topic+exponential'></span>

<h3>Description</h3>

<p>The model function for the exponential model is defined as
</p>
<p style="text-align: center;"><code class="reqn">
  f(d,\theta)=E_0+E_1(exp(d/\delta)-1)</code>
</p>



<h3>Usage</h3>

<pre><code class='language-R'>exponential(dose, e0, e1, delta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="exponential_+3A_dose">dose</code></td>
<td>
<p> Dose variable </p>
</td></tr>
<tr><td><code id="exponential_+3A_e0">e0</code></td>
<td>
<p> Placebo effect </p>
</td></tr>
<tr><td><code id="exponential_+3A_e1">e1</code></td>
<td>
<p> E1 parameter </p>
</td></tr>
<tr><td><code id="exponential_+3A_delta">delta</code></td>
<td>
<p> Delta parameter, controlling the convexity of the model. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This model is intended to capture a possible sub-linear or a
convex dose-response relationship. 
</p>


<h3>Value</h3>

<p>Response value
</p>


<h3>References</h3>

<p>Pinheiro, J. C., Bretz, F. and Branson, M. (2006). Analysis of dose-response studies - modeling 
approaches, <em>in</em> N. Ting (ed.). <em>Dose Finding in Drug Development</em>, Springer, New York,
pp. 146&ndash;171
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+logistic">logistic</a></code>, <code><a href="#topic+sigEmax">sigEmax</a></code>, 
<code><a href="#topic+linlog">linlog</a></code>, <code><a href="#topic+linear">linear</a></code>, <code><a href="#topic+quadratic">quadratic</a></code>,
<code><a href="#topic+emax">emax</a></code>,  <code><a href="#topic+betaMod">betaMod</a></code>
</p>

<hr>
<h2 id='fullMod'> Calculate location and scale parameters for candidate set of models </h2><span id='topic+fullMod'></span>

<h3>Description</h3>

<p>Calculates location and scale parameters for all models in the candidate set
using the maximum approach from Pinheiro et al. (2006). This is done by repeatedly
calling the <code>getPars</code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fullMod(models, doses, base, maxEff, off = 0.1*max(doses), scal = 1.2 * max(doses))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fullMod_+3A_models">models</code></td>
<td>
<p> A list specifying the candidate models. The names of the list entries should
be equal to the names of the model functions. The list entries should be equal to the guesstimates  </p>
</td></tr>
<tr><td><code id="fullMod_+3A_doses">doses</code></td>
<td>
<p> Dose levels to be administered </p>
</td></tr>
<tr><td><code id="fullMod_+3A_base">base</code>, <code id="fullMod_+3A_maxeff">maxEff</code></td>
<td>
<p> Baseline effect and maximum change from baseline to be used for calculating the 
location and scale parameters of the model </p>
</td></tr>
<tr><td><code id="fullMod_+3A_off">off</code></td>
<td>
<p> Offset parameter for the linear in log model </p>
</td></tr>
<tr><td><code id="fullMod_+3A_scal">scal</code></td>
<td>
<p> Scale parameter for the beta model </p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an object of class fullMod, containing all parameter values for the models in a list.
</p>


<h3>References</h3>

<p>Bornkamp B., Pinheiro J. C., Bretz, F. (2009). MCPMod: An            
R Package for the Design and Analysis of Dose-Finding        
Studies, <em>Journal of Statistical Software</em>, <b>29</b>(7), 1&ndash;23
</p>
<p>Pinheiro, J. C., Bornkamp, B. and Bretz, F. (2006). Design and analysis of dose finding studies
combining multiple comparisons and modeling procedures, <em>Journal of Biopharmaceutical
Statistics</em>, <b>16</b>, 639&ndash;656
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+getPars">getPars</a></code>, <code><a href="#topic+sampSize">sampSize</a></code>, <code><a href="#topic+powerMM">powerMM</a></code>, <code><a href="#topic+plotModels">plotModels</a></code>, <code><a href="#topic+LP">LP</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>doses &lt;- c(0, 10, 25, 50, 100, 150)                                        
models &lt;- list(linear = NULL, emax = c(25),                                
               logistic = c(50, 10.88111), exponential = c(85),            
               betaMod = matrix(c(0.33, 2.31, 1.39, 1.39), byrow=TRUE,nrow=2))
fMod &lt;- fullMod(models, doses, base = 0, maxEff = 0.4, scal = 200)                 
plot(fMod) # automatically calls the plotModels function
</code></pre>

<hr>
<h2 id='genDFdata'> Simulate dose-response data </h2><span id='topic+genDFdata'></span>

<h3>Description</h3>

<p>The function simulates normally distributed dose-response data, 
according to a prespecified dose-response model (or mean vector)
and a given standard deviation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>genDFdata(model, argsMod, doses, n, sigma, mu = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="genDFdata_+3A_model">model</code></td>
<td>
<p> Character string giving the name of a model function. The first
argument of the model function should be the dose variable. </p>
</td></tr>
<tr><td><code id="genDFdata_+3A_argsmod">argsMod</code></td>
<td>
<p> A vector with the arguments for the model function. </p>
</td></tr>
<tr><td><code id="genDFdata_+3A_doses">doses</code></td>
<td>
<p> Dose levels to be used. </p>
</td></tr>
<tr><td><code id="genDFdata_+3A_n">n</code></td>
<td>
<p> Group sample sizes. </p>
</td></tr>
<tr><td><code id="genDFdata_+3A_sigma">sigma</code></td>
<td>
<p> Standard deviation. </p>
</td></tr>
<tr><td><code id="genDFdata_+3A_mu">mu</code></td>
<td>
<p> If <code>model</code> is not specified mu is used to determine
the mean vector of the observations. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with two columns called <code>dose</code> and <code>resp</code>, corresponding to the dose and 
simulated response values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># use emax model
genDFdata("emax", c(e0 = 0.2, eMax = 1, ed50 = 0.05), c(0,0.05,0.2,0.6,1), 20, 1)
# use fixed mean vector
genDFdata(mu = 1:5, doses = 0:4, n = c(20, 20, 10, 5, 1), sigma = 0.2)
</code></pre>

<hr>
<h2 id='getPars'> Calculate location and scale parameters </h2><span id='topic+getPars'></span>

<h3>Description</h3>

<p>Given the baseline, the maximum effect and the standardized model parameters
this function calculates the location and scale parameters in the
model function using the maximum approach, see Pinheiro et al. (2006) for the basic idea.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getPars(model, doses, initEstim, base, maxEff,
        off = 0.1 * max(doses), scal = 1.2 * max(doses))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getPars_+3A_model">model</code></td>
<td>
<p> A character string with the model name. Built-in models    
have their full parameterization derived internally. For   
user-defined models, it is assumed that a      
function named as &quot;Par&quot; appended to end of model name exists (e.g.,    
for model = &quot;cubic&quot;, it is assumed that there is function  
&quot;cubicPar&quot; that calculates the necessary parameters; this    
function is assumed to have arguments &quot;doses&quot;, &quot;initEstim&quot;,    
&quot;base&quot;, and &quot;maxEff&quot;, in that order (see below for an example).  </p>
</td></tr>
<tr><td><code id="getPars_+3A_doses">doses</code></td>
<td>
<p>  Doses to be used in design   </p>
</td></tr>
<tr><td><code id="getPars_+3A_initestim">initEstim</code></td>
<td>
<p> Vector of guesstimates </p>
</td></tr>
<tr><td><code id="getPars_+3A_base">base</code></td>
<td>
<p> Expected baseline effect </p>
</td></tr>
<tr><td><code id="getPars_+3A_maxeff">maxEff</code></td>
<td>
<p> Expected maximum change from baseline </p>
</td></tr>
<tr><td><code id="getPars_+3A_off">off</code></td>
<td>
<p> Offset parameter for the linear in log model (default 1). </p>
</td></tr>
<tr><td><code id="getPars_+3A_scal">scal</code></td>
<td>
<p> Scale parameter for the beta model (default: 20 perc. larger than maximum dose).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector containing all model parameters.
</p>


<h3>References</h3>

 
<p>Pinheiro, J. C., Bornkamp, B. and Bretz, F. (2006). Design and analysis of dose finding studies
combining multiple comparisons and modeling procedures, <em>Journal of Biopharmaceutical
Statistics</em>, <b>16</b>, 639&ndash;656
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+fullMod">fullMod</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>doses &lt;- c(0, 10, 25, 50, 100, 150)                                        
getPars("emax", doses, 25, 0, 0.4)                                         
getPars("logistic", doses, c(50, 10.88111), 0, 0.4) # compare JBS 16, p.650
getPars("betaMod", doses, initEstim = c(0.33, 2.31), base = 0,             
        maxEff = 0.4)                                                      
#example for user model                                                    
userMod &lt;- function(dose, e0, eMax, ed50, h){                             
  e0 + eMax * ( dose^h / (ed50^h + dose^h) )                               
}                                                                          
# function to return location and scale parameters                         
userModPar &lt;- function(dose, initEstim, base, maxEff){                    
  # function to get linear parameters                                      
  # ed50 parameter assumed to be first in initEstim                        
  ed50 &lt;- initEstim[1]                                                     
  h &lt;- initEstim[2]                                                        
  dmax &lt;- max(dose)                                                        
  emax &lt;- maxEff*(ed50^h+dmax^h)/dmax^h                                    
  c(base, emax, initEstim)                                                 
}                                                                          
getPars("userMod", doses, initEstim = c(50,2), base = 0, maxEff = 1) 
</code></pre>

<hr>
<h2 id='guesst'> Calculate guesstimates based on prior knowledge </h2><span id='topic+guesst'></span>

<h3>Description</h3>

<p>Calculates guesstimates for standardized model parameter(s) 
using the general approach described in Pinheiro et al. (2006). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>guesst(d, p, model = c("emax", "exponential", "logistic", "quadratic",
       "betaMod", "sigEmax"), less = TRUE,  local = FALSE,
       dMax, Maxd, scal)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="guesst_+3A_d">d</code></td>
<td>
<p> Vector containing dose value(s). </p>
</td></tr>
<tr><td><code id="guesst_+3A_p">p</code></td>
<td>
<p> Vector of expected percentages of the maximum effect achieved at d. </p>
</td></tr>
<tr><td><code id="guesst_+3A_model">model</code></td>
<td>
<p> Character string. Should be one of &quot;emax&quot;, &quot;exponential&quot;,
&quot;quadratic&quot;, &quot;betaMod&quot;, &quot;sigEmax&quot;. </p>
</td></tr>
<tr><td><code id="guesst_+3A_less">less</code></td>
<td>
<p> Logical, only needed in case of quadratic model.
Determines if d is smaller (<code>less=TRUE</code>) or larger (<code>less=FALSE</code>)
than dopt (see Pinheiro et al. (2006) for details).</p>
</td></tr>
<tr><td><code id="guesst_+3A_local">local</code></td>
<td>
<p> Logical indicating whether local or asymptotic version
of guesstimate should be derived (defaults to <code>FALSE</code>).
Only needed for emax, logistic and sigEmax model. 
When <code>local=TRUE</code> the maximum dose must be provided via 
<code>Maxd</code>.</p>
</td></tr>
<tr><td><code id="guesst_+3A_dmax">dMax</code></td>
<td>
<p> Dose at which maximum effect occurs, only needed for the beta model </p>
</td></tr>
<tr><td><code id="guesst_+3A_maxd">Maxd</code></td>
<td>
<p> Maximum dose to be administered in the trial </p>
</td></tr>
<tr><td><code id="guesst_+3A_scal">scal</code></td>
<td>
<p> Scale parameter, only needed for the beta model </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculates guesstimates for the parameters of the standardized
model function based on the prior expected percentage of the maximum effect at 
certain dose levels. Note that this function should be used together with the <code>plotModels</code>
function to ensure that the guesstimates are reflecting the prior
beliefs.
</p>
<p>For the logistic and sigmoid emax models at least two pairs (d,p) need to
be specified. 
</p>
<p>For the beta model the dose at which the maximum effect occurs (dMax)
has to be specified in addition to the (d,p) pair.
</p>
<p>For the exponential model the maximum dose administered (Maxd) needs to 
be specified in addition to the (d,p) pair.
</p>
<p>For the quadratic model one (d,p) pair is needed. It is advisable to
specify the location of the maximum within the dose range with this
pair.
</p>
<p>For the emax, sigmoid Emax and logistic model one can choose between a local
and an asymptotic version. In the local version one explicitly forces the
standardized model function to pass through the specified points (d,p). For the
asymptotic version it assumed that the standardized model function is equal to 1
at the largest dose (this is the approach described in Pinheiro et al. (2006)).
If the local version is used, convergence problems
with the underlying nonlinear optimization can occur.
</p>


<h3>Value</h3>

<p>Returns a numeric vector containing the guesstimates.
</p>


<h3>References</h3>

 
<p>Bornkamp B., Pinheiro J. C., and Bretz, F. (2009). MCPMod: An            
R Package for the Design and Analysis of Dose-Finding        
Studies, <em>Journal of Statistical Software</em>, <b>29</b>(7), 1&ndash;23
</p>
<p>Pinheiro, J. C., Bretz, F., and Branson, M. (2006). Analysis of dose-response studies - modeling
approaches, <em>in</em> N. Ting (ed.), <em>Dose Finding in Drug Development</em>, Springer, New York,
pp. 146&ndash;171
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+emax">emax</a></code>, <code><a href="#topic+logistic">logistic</a></code>, <code><a href="#topic+betaMod">betaMod</a></code>,
<code><a href="#topic+sigEmax">sigEmax</a></code>, 
<code><a href="#topic+quadratic">quadratic</a></code>, <code><a href="#topic+exponential">exponential</a></code>,
<code><a href="#topic+plotModels">plotModels</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Emax model
# Expected percentage of maximum effect: 0.8 is associated with
# dose 0.3 (d,p)=(0.3, 0.8), dose range [0,1]
emx1 &lt;- guesst(d=0.3, p=0.8, model="emax")
# local approach
emx2 &lt;- guesst(d=0.3, p=0.8, model="emax", local = TRUE, Maxd = 1)
# plot models
models &lt;- list(emax=c(emx1, emx2))
plotModels(models, c(0,1), base= 0, maxEff = 1)

# Logistic model
# Select two (d,p) pairs (0.2, 0.5) and (0.6, 0.95)
lgc1 &lt;- guesst(d = c(0.2, 0.5), p = c(0.6, 0.95), "logistic")
# local approach
lgc2 &lt;- guesst(d = c(0.2, 0.5), p = c(0.6, 0.95), "logistic", 
               local = TRUE, Maxd = 1)
# plot models
models &lt;- list(logistic = matrix(c(lgc1, lgc2), byrow = TRUE, nrow = 2))
plotModels(models, c(0,1), base= 0, maxEff = 1)

# Beta Model
# Select one pair (d,p): (0.5,0.5)
# dose, where maximum occurs: 0.8
bta &lt;- guesst(d=0.5, p=0.5, model="betaMod", dMax=0.8, scal=1.2)
# plot
models &lt;- list(betaMod = bta)
plotModels(models, c(0,1), base= 0, maxEff = 1)

# Sigmoid Emax model
# Select two (d,p) pairs (0.2, 0.5) and (0.6, 0.95)
sgE1 &lt;- guesst(d = c(0.2, 0.5), p = c(0.6, 0.95), "sigEmax")
# local approach
sgE2 &lt;- guesst(d = c(0.2, 0.5), p = c(0.6, 0.95), "sigEmax",
               local = TRUE, Maxd = 1)
models &lt;- list(sigEmax = matrix(c(sgE1, sgE2), byrow = TRUE, nrow = 2))
plotModels(models, c(0,1), base= 0, maxEff = 1)

# Quadratic model
# For the quadratic model it is assumed that the maximum effect occurs at 
# dose 0.7
quad &lt;- guesst(d = 0.7, p = 1, "quadratic")
models &lt;- list(quadratic = quad)
plotModels(models, c(0,1), base= 0, maxEff = 1)

# exponential model
# (d,p) = (0.8,0.5)
expo &lt;- guesst(d = 0.8, p = 0.5, "exponential", Maxd=1)
models &lt;- list(exponential = expo)
plotModels(models, c(0,1), base= 0, maxEff = 1)
</code></pre>

<hr>
<h2 id='IBS'> Irritable Bowel Syndrome Dose Response data </h2><span id='topic+IBS'></span>

<h3>Description</h3>

<p>A subset of the data used by (Biesheuvel and Hothorn, 2002). 
Except for the dose and the response variable all variables from the original data set
are removed. 
The data are part of a dose ranging trial on a compound for the treatment of the
irritable bowel syndrome with four active treatment arms,
corresponding to doses 1,2,3,4 and placebo. Note that the original dose levels
have been blinded in this data set for confidentiality. The primary endpoint
was a baseline adjusted abdominal pain score with larger values
corresponding to a better treatment effect. In total 369 patients
completed the study, with nearly balanced allocation across the
doses.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(IBS)</code></pre>


<h3>Format</h3>

<p>A data frame with 369 observations on the following 2 variables.
</p>

<dl>
<dt><code>dose</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>resp</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Source</h3>

<p>Biesheuvel, E. and Hothorn, L. A. (2002). Many-to-one comparisons in stratified designs,
<em>Biometrical Journal</em>, <b>44</b>, 101&ndash;116
</p>

<hr>
<h2 id='linear'> Linear Model </h2><span id='topic+linear'></span>

<h3>Description</h3>

<p>The model function for the linear model is defined as
</p>
<p style="text-align: center;"><code class="reqn">
  f(d,\theta)=E_0+\delta d</code>
</p>



<h3>Usage</h3>

<pre><code class='language-R'>linear(dose, e0, delta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="linear_+3A_dose">dose</code></td>
<td>
<p> Dose variable </p>
</td></tr>
<tr><td><code id="linear_+3A_e0">e0</code></td>
<td>
<p> Placebo effect </p>
</td></tr>
<tr><td><code id="linear_+3A_delta">delta</code></td>
<td>
<p> Slope parameter </p>
</td></tr>
</table>


<h3>Value</h3>

<p>Response value
</p>


<h3>References</h3>

 
<p>Pinheiro, J. C., Bretz, F. and Branson, M. (2006). Analysis of dose-response studies - modeling 
approaches, <em>in</em> N. Ting (ed.). <em>Dose Finding in Drug Development</em>, Springer, New York,
pp. 146&ndash;171
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+logistic">logistic</a></code>, <code><a href="#topic+sigEmax">sigEmax</a></code>, 
<code><a href="#topic+linlog">linlog</a></code>, <code><a href="#topic+exponential">exponential</a></code>, <code><a href="#topic+quadratic">quadratic</a></code>,
<code><a href="#topic+emax">emax</a></code>,  <code><a href="#topic+betaMod">betaMod</a></code>
</p>

<hr>
<h2 id='linlog'> Linear in log dose Model </h2><span id='topic+linlog'></span>

<h3>Description</h3>

<p>The model function for the linear in log model is defined as
</p>
<p style="text-align: center;"><code class="reqn">
  f(d,\theta)=E_0+\delta \log(d + off)</code>
</p>
<p> where <code class="reqn">off</code> is an offset parameter not estimated in the code.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>linlog(dose, e0, delta, off = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="linlog_+3A_dose">dose</code></td>
<td>
<p> Dose variable </p>
</td></tr>
<tr><td><code id="linlog_+3A_e0">e0</code></td>
<td>
<p> Placebo effect </p>
</td></tr>
<tr><td><code id="linlog_+3A_delta">delta</code></td>
<td>
<p> Slope parameter </p>
</td></tr>
<tr><td><code id="linlog_+3A_off">off</code></td>
<td>
<p> Offset value to avoid problems with dose=0 (treated as a
fixed value in the code) </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The linear in log-dose model is intended to capture concave
shapes. The parameter <code>off</code> is not estimated in the code
but set to a pre-specified value.
</p>


<h3>Value</h3>

<p>Response value
</p>


<h3>References</h3>

 
<p>Pinheiro, J. C., Bretz, F. and Branson, M. (2006). Analysis of dose-response studies - modeling 
approaches, <em>in</em> N. Ting (ed.). <em>Dose Finding in Drug Development</em>, Springer, New York,
pp. 146&ndash;171
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+logistic">logistic</a></code>, <code><a href="#topic+sigEmax">sigEmax</a></code>, 
<code><a href="#topic+linear">linear</a></code>, <code><a href="#topic+exponential">exponential</a></code>, <code><a href="#topic+quadratic">quadratic</a></code>,
<code><a href="#topic+emax">emax</a></code>,  <code><a href="#topic+betaMod">betaMod</a></code>
</p>

<hr>
<h2 id='logistic'> Logistic Model </h2><span id='topic+logistic'></span>

<h3>Description</h3>

<p>The model function for the logistic model is defined as
</p>
<p style="text-align: center;"><code class="reqn">
    f(d, \theta) = E_0 + E_{\max}/\left\{1 + \exp\left[ \left(ED_{50} - d
  \right)/\delta \right] \right\}</code>
</p>



<h3>Usage</h3>

<pre><code class='language-R'>logistic(dose, e0, eMax, ed50, delta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logistic_+3A_dose">dose</code></td>
<td>
<p> Dose variable </p>
</td></tr>
<tr><td><code id="logistic_+3A_e0">e0</code></td>
<td>
<p> Left-asymptote parameter, corresponding to a basal effect level 
(not the placebo effect, though). </p>
</td></tr>
<tr><td><code id="logistic_+3A_emax">eMax</code></td>
<td>
<p> Asymptotic maximum change in effect from the basal level. </p>
</td></tr>
<tr><td><code id="logistic_+3A_ed50">ed50</code></td>
<td>
<p> Dose giving half of the asymptotic maximum effect. </p>
</td></tr>
<tr><td><code id="logistic_+3A_delta">delta</code></td>
<td>
<p> Parameter controlling determining the steepness of the curve. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The logistic model is intended to capture general monotone, 
sigmoid dose-response relationships.
</p>


<h3>Value</h3>

<p>Response value
</p>


<h3>References</h3>

<p>Pinheiro, J. C., Bretz, F. and Branson, M. (2006). Analysis of dose-response studies - modeling 
approaches, <em>in</em> N. Ting (ed.). <em>Dose Finding in Drug Development</em>, Springer, New York,
pp. 146&ndash;171
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+betaMod">betaMod</a></code>, <code><a href="#topic+logistic">logistic</a></code>, <code><a href="#topic+sigEmax">sigEmax</a></code>, 
<code><a href="#topic+linlog">linlog</a></code>, <code><a href="#topic+linear">linear</a></code>, <code><a href="#topic+quadratic">quadratic</a></code>,
<code><a href="#topic+exponential">exponential</a></code>
</p>

<hr>
<h2 id='LP'> Sensitivity analysis for misspecification of standardized model parameters </h2><span id='topic+LP'></span><span id='topic+print.LP'></span>

<h3>Description</h3>

<p>Calculates the loss in power associated with 
misspecification of the standardized model parameters for a specific model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LP(models, model, type = c("both", "LP1", "LP2"), paramRange,
   doses, base, maxEff, sigma, n, len = c(10, 1), nr = 1,
   alpha = 0.025, twoSide = FALSE, off = 0.1 * max(doses),
   scal = 1.2 * max(doses), control = mvtnorm.control())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LP_+3A_models">models</code></td>
<td>
<p> A list specifying the candidate models. This
can also be a fullMod object, then the arguments <code>base</code>, 
<code>maxEff</code>, <code>off</code> and <code>scal</code> are ignored </p>
</td></tr>
<tr><td><code id="LP_+3A_model">model</code></td>
<td>
<p> Character string giving the
model for which the sensitivity should be investigated. </p>
</td></tr>
<tr><td><code id="LP_+3A_type">type</code></td>
<td>
<p> Character string: One of &quot;LP1&quot;, &quot;LP2&quot; or &quot;both&quot;. </p>
</td></tr>
<tr><td><code id="LP_+3A_paramrange">paramRange</code></td>
<td>
<p> Numeric of length two, giving lower and upper limits for standardized model parameter values
when the model has just one standardized model parameter. 
For models with two standardized model parameters a 2x2 matrix with the boundaries
for each standardized model parameter in the rows. See examples for details. </p>
</td></tr>
<tr><td><code id="LP_+3A_doses">doses</code></td>
<td>
<p> Dose levels to be administered </p>
</td></tr>
<tr><td><code id="LP_+3A_base">base</code></td>
<td>
<p> Baseline effect </p>
</td></tr>
<tr><td><code id="LP_+3A_maxeff">maxEff</code></td>
<td>
<p> Maximum change from baseline </p>
</td></tr>
<tr><td><code id="LP_+3A_sigma">sigma</code></td>
<td>
<p> Standard deviation </p>
</td></tr>
<tr><td><code id="LP_+3A_n">n</code></td>
<td>
<p> Numeric vector of sample sizes per group. In case just one number
is specified, it is assumed that all group sample sizes are equal to 
this number.</p>
</td></tr>
<tr><td><code id="LP_+3A_len">len</code></td>
<td>
<p> Number of points in the standardized model parameter range
on which LP is calculated.  Has to be of length 2 in case of models 
with 2 standardized model parameters. </p>
</td></tr>
<tr><td><code id="LP_+3A_nr">nr</code></td>
<td>
<p> Numeric giving the number of the model (in the order given in the model argument)
in case there is more than one model from one model class in 
the candidate set (e.g. two emax models). </p>
</td></tr>
<tr><td><code id="LP_+3A_alpha">alpha</code></td>
<td>
<p> Level of significance (default: 0.025) </p>
</td></tr>
<tr><td><code id="LP_+3A_twoside">twoSide</code></td>
<td>
<p> Logical indicating whether a two sided or a one sided
test is performed (defaults to one-sided). </p>
</td></tr>
<tr><td><code id="LP_+3A_off">off</code></td>
<td>
<p> Offset parameter for the linear in log model (default 10 perc. of maximum dose). </p>
</td></tr>
<tr><td><code id="LP_+3A_scal">scal</code></td>
<td>
<p> Scale parameter for the beta model (default 20 perc. larger than maximum dose).</p>
</td></tr>
<tr><td><code id="LP_+3A_control">control</code></td>
<td>
<p> A list of options for the <code>pmvt</code> and <code>qmvt</code> functions
as produced by <code>mvtnorm.control</code> </p>
</td></tr>
</table>


<h3>Details</h3>

<p>For a given set of candidate models the power-sensitivity of 
the multiple contrast test with respect to misspecification 
of the guesstimates is investigated. Two measures to measure loss in 
power (&quot;LP1&quot; or &quot;LP2&quot;) can be used. Roughly LP1 can be interpretated 
as the difference between the power that &quot;was
intended&quot; (nominal power), when designing the study and &quot;what one actually gets&quot; (actual power).<br /> LP2 can be
interpreted as the difference between &quot;what could be achieved
knowing the true value of the parameter in advance&quot; (potential power) and &quot;what one actually gets&quot;. 
For a detailed definition see the reference below.
The power values are calculated on a number of points 
specified by the <code>len</code> argument. The calculation of
LP2 is computationally more demanding as the optimal contrasts
and the critical value need to be recalculated for each point in the standardized model 
parameter space.
</p>


<h3>Value</h3>

<p>An object of class LP, i.e. a matrix containing the different alternative 
standardized model parameters,
associated potential/actual power values and the loss in power values.
</p>


<h3>References</h3>

 
<p>Bornkamp B., Pinheiro J. C., Bretz, F. (2009). MCPMod: An            
R Package for the Design and Analysis of Dose-Finding        
Studies, <em>Journal of Statistical Software</em>, <b>29</b>(7), 1&ndash;23
</p>
<p>Pinheiro, J. C., Bornkamp, B. and Bretz, F. (2006). Design and analysis of dose finding studies
combining multiple comparisons and modeling procedures, <em>Journal of Biopharmaceutical
Statistics</em>, <b>16</b>, 639&ndash;656
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+plot.LP">plot.LP</a></code>, <code><a href="#topic+guesst">guesst</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
doses &lt;- c(0,10,25,50,100,150)
models &lt;- list(linear=NULL, emax=c(25),
           logistic=c(50,10.88111), exponential=c(85),
           betaMod=matrix(c(0.33,2.31,1.39,1.39),byrow=TRUE,nrow=2))

# Examples from JBS paper, p.654
LPobj &lt;- LP(models, model = "emax", type = "both", paramRange = c(10,70),
          doses = doses, base = 0, maxEff = 0.4, sigma = 1, n = 60,
          alpha = 0.05, len = 15, scal = 200)
print(LPobj)
plot(LPobj)

# for exponential model with fullMod and LP1:
fMod &lt;- fullMod(models, doses, base = 0, maxEff = 0.4, scal=200)
LPobj &lt;- LP(fMod, "exponential", "LP1", c(50, 120), sigma = 1,
            alpha = 0.05, len = 20, n = 60)
plot(LPobj)

# Examples for models with two standardized model parameters
LP(models, "betaMod", "LP1", 
   paramRange = matrix(c(0.3,1.9,0.4,2.5),nrow=2),
   doses, 0, 0.4, 1, 60, alpha=0.05, len=c(10,4), scal=200)
#  Time consuming example
LPobj &lt;- LP(models, "logistic", "both",
            paramRange = matrix(c(40,5,60,15),nrow=2),    
            doses, 0, 0.4, 1, 60, alpha=0.05, len=c(10,4), scal=200)
plot(LPobj)

## End(Not run)
</code></pre>

<hr>
<h2 id='MCPMod'>Perform MCPMod analysis of a data set</h2><span id='topic+MCPMod'></span><span id='topic+print.MCPMod'></span><span id='topic+print.summary.MCPMod'></span><span id='topic+summary.MCPMod'></span>

<h3>Description</h3>

<p>Tests for a dose-response effect with a model-based multiple contrast test and
estimates a target dose with regression techniques. For details see
Bretz et al. (2005) or the enclosed vignette, available via the command <code>vignette("MCPMod")</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MCPMod(data, models = NULL, contMat = NULL, critV = NULL, resp = "resp",
       dose = "dose", off = NULL, scal = NULL, alpha = 0.025, 
       twoSide = FALSE, selModel = c("maxT", "AIC", "BIC", "aveAIC", 
       "aveBIC"), doseEst = c("MED2", "MED1", "MED3", "ED"), std = TRUE,
       start = NULL, uModPars = NULL, addArgs = NULL, dePar = NULL,
       clinRel = NULL, lenDose = 101, pW = NULL,
       control = list(maxiter = 100, tol = 1e-06, minFactor = 1/1024),
       signTtest = 1, pVal = FALSE, testOnly = FALSE,
       mvtcontrol = mvtnorm.control(), na.action = na.fail, uGrad = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MCPMod_+3A_data">data</code></td>
<td>
<p>Data frame containing the dose and the response data. The code assumes
the columns to be named &quot;dose&quot; and &quot;resp&quot;. Other names can be handed over via
the <code>dose</code> and <code>resp</code> argument see below. </p>
</td></tr>
<tr><td><code id="MCPMod_+3A_models">models</code></td>
<td>
<p> A list specifying the candidate models. The names of the list entries should
be equal to the names of the model functions. The list entries should be equal to the guesstimates. See the Examples (ii)
for details on this topic. If the <code>contMat</code> argument is specified, this argument is ignored, see Examples (iv). </p>
</td></tr>
<tr><td><code id="MCPMod_+3A_contmat">contMat</code></td>
<td>
<p> Optional matrix containing the optimal contrasts in the columns. The names of the columns 
should be equal to the underlying model function names. If specified the code does not calculate the optimal contrasts.</p>
</td></tr>
<tr><td><code id="MCPMod_+3A_critv">critV</code></td>
<td>
<p> Optional numeric specifying the critical value to be used in the multiple
contrast test. </p>
</td></tr>
<tr><td><code id="MCPMod_+3A_resp">resp</code></td>
<td>
<p> Character string giving the name of the response column for the data frame
specified in <code>data</code> (default: &quot;resp&quot;). </p>
</td></tr>
<tr><td><code id="MCPMod_+3A_dose">dose</code></td>
<td>
<p> Character string giving the name of the dose column for the data frame
specified in <code>data</code> (default: &quot;dose&quot;). </p>
</td></tr>
<tr><td><code id="MCPMod_+3A_off">off</code></td>
<td>
<p> Fixed offset parameter needed when the linear in log model is used. 
See also documentation of the linear in log model: <code><a href="#topic+linlog">linlog</a></code>. 
When <code>off = NULL</code> by default (maximum dose)*0.1 is
used for <code>off</code>. </p>
</td></tr>
<tr><td><code id="MCPMod_+3A_scal">scal</code></td>
<td>
<p> Fixed scale parameter needed when the beta model is used. 
See also documentation of the beta model: <code><a href="#topic+betaMod">betaMod</a></code>. 
When <code>scal = NULL</code> by default (maximum dose)*1.2 is
used for <code>scal</code>.</p>
</td></tr>
<tr><td><code id="MCPMod_+3A_alpha">alpha</code></td>
<td>
<p> Level of significance for the multiple contrast test (defaults to 0.025)  </p>
</td></tr>
<tr><td><code id="MCPMod_+3A_twoside">twoSide</code></td>
<td>
<p> Optional logical value deterimining whether two-sided or one-sided testing should be
performed. Defaults to FALSE, so one-sided testing. </p>
</td></tr>
<tr><td><code id="MCPMod_+3A_selmodel">selModel</code></td>
<td>
<p> Optional character vector specifying the model selection criterion for dose estimation. Possible values are <br />
&quot;maxT&quot;: Selects the model corresponding to the largest t-statistic (this is the default).<br />
&quot;AIC&quot;: Selects model with smallest AIC<br />
&quot;BIC&quot;: Selects model with smallest BIC<br />
&quot;aveAIC&quot;: Uses a weighted average of the models corresponding to the significant contrasts.
The model weights are chosen by the formula: wi = exp(-0.5AICi)/sum(exp(-0.5AICi)).
See Buckland et al. (1997) for details.<br />
&quot;aveBIC&quot;: Same as &quot;aveAIC&quot;, but the BIC is used to calculate the model weights.<br />
</p>
</td></tr>
<tr><td><code id="MCPMod_+3A_doseest">doseEst</code></td>
<td>
<p> Determines which dose to estimate and which dose estimator to use, possible
values are &quot;MED2&quot;, &quot;MED1&quot;, &quot;MED3&quot; and &quot;ED&quot;. See Bretz et al. (2005) for the definition
of MED1-MED3. If ED is specified, the dose that gives a pre-specified percentage of
the maximum effect is returned.</p>
</td></tr>
<tr><td><code id="MCPMod_+3A_std">std</code></td>
<td>
<p> Optional logical value determining, whether standardized versions should be assumed
for calculation of the optimal contrasts. If FALSE all model parameters need to be specified
in the models argument (also location and scale parameters). </p>
</td></tr>
<tr><td><code id="MCPMod_+3A_start">start</code></td>
<td>
<p> List containing starting values for the nls fitting algorithm. The names of the list elements 
need to be equal to the names of the model functions. The names of the starting vector should equal the
corresponding names for the model parameters. For built-in models starting values need to be provided
only for the non-linear parameters. In case of a user model (not built in)
starting values for the all parameters need to be supplied. (see Examples (iii) for details). </p>
</td></tr>
<tr><td><code id="MCPMod_+3A_umodpars">uModPars</code></td>
<td>
<p> Optional character vector with names/expressions of user-defined model parameters (names(start) used by
default). </p>
</td></tr>
<tr><td><code id="MCPMod_+3A_addargs">addArgs</code></td>
<td>
<p> Optional character vector with names of additional arguments (variables) to user-defined model. </p>
</td></tr>
<tr><td><code id="MCPMod_+3A_depar">dePar</code></td>
<td>
<p> Numeric, defining parameter used for dose estimators. For the MED-type estimators <code>dePar</code> determines
the confidence level gamma used in the estimator. The used confidence level is given by
<code>1-2*dePar</code>. The default for <code>dePar</code> for MED-type estimators is 0.1. For ED-type estimators <code>dePar</code>
determines which effective dose is estimated. Specifying 0.95 for example results in an estimate of the ED95.
If the ED estimator is used the default for <code>dePar</code> is 0.5. </p>
</td></tr>
<tr><td><code id="MCPMod_+3A_clinrel">clinRel</code></td>
<td>
<p> Numeric specifying the clinical relevance threshold. </p>
</td></tr>
<tr><td><code id="MCPMod_+3A_lendose">lenDose</code></td>
<td>
<p> Numeric vector specifying the number of points in the dose-range
to search for the dose estimate, defaults to 101. </p>
</td></tr>
<tr><td><code id="MCPMod_+3A_pw">pW</code></td>
<td>
<p> Optional vector specifying prior weights for the different models. Should be a named vector with names
matching the names of the models list.</p>
</td></tr>
<tr><td><code id="MCPMod_+3A_control">control</code></td>
<td>
<p> List of parameters to be used in the calls to the <code>nls</code> function. See also
<code>nls.control</code> function. </p>
</td></tr>
<tr><td><code id="MCPMod_+3A_signttest">signTtest</code></td>
<td>
<p> Optional numeric vector multiplied with the test statistics. </p>
</td></tr>
<tr><td><code id="MCPMod_+3A_pval">pVal</code></td>
<td>
<p> Optional logical determining whether p-values should be calculated, defaults to FALSE. If the critical value is supplied,
p-values will not be calculated. </p>
</td></tr>
<tr><td><code id="MCPMod_+3A_testonly">testOnly</code></td>
<td>
<p> Logical value determining, whether only the multiple comparisons test should be performed. See Examples (v) below.</p>
</td></tr>
<tr><td><code id="MCPMod_+3A_mvtcontrol">mvtcontrol</code></td>
<td>
<p> A list specifying additional control parameters for the <code>qmvt</code> and <code>pmvt</code> calls in the code,
see also <code>mvtnorm.control</code> for details. </p>
</td></tr>
<tr><td><code id="MCPMod_+3A_na.action">na.action</code></td>
<td>
<p> A function which indicates what should happen when the data contain NAs.  </p>
</td></tr>
<tr><td><code id="MCPMod_+3A_ugrad">uGrad</code></td>
<td>
<p> Function to return the gradient of a user defined model, see Examples (iii) below. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function performs the multiple comparisons and modelling (MCPMod) procedure presented in
Bretz et al. (2005). The method consists of two steps:<br />
(i) MCP step:
The function calculates the optimal contrasts (if not supplied) and 
the contrast test statistics. In the calculation of the critical 
value and p-values multiplicity is taken into account.<br />
(ii) Modelling step:
If there is at least one significant contrast, one model or a combination
of models is chosen (depending on the <code>selModel</code> argument) for dose estimation.
In case of non-convergence of certain non-linear models the 
remaining significant models are used. Finally the target dose is estimated.<br />
</p>
<p>Built in models are the linear, linear in log, emax, sigmoid emax, logistic, 
exponential, quadratic and beta model (for their definitions see their help files or 
Bretz et al. (2005), Pinheiro et al. (2006)).
Users may hand over their own model functions for details have a look at the Example (iii).
</p>


<h3>Value</h3>

<p>An object of class MCPMod, with the following entries:
</p>
<table>
<tr><td><code>signf</code></td>
<td>
<p>Logical indicating, whether multiple contrast test is significant</p>
</td></tr>
<tr><td><code>model1</code></td>
<td>
<p>Model with largest contrast test statistic</p>
</td></tr>
<tr><td><code>model2</code></td>
<td>
<p>Model(s) used for estimation of target doses</p>
</td></tr>
<tr><td><code>input</code></td>
<td>
<p>A list with entries equal to the input parameters for the function: <code>models</code>, <code>resp</code>, <code>dose</code>,
<code>off</code>, <code>scal</code>, <code>alpha</code>, <code>twoSide</code>, first entry of <code>selModel</code>, <code>doseEst</code>, 
<code>std</code>, <code>dePar</code>, <code>uModArgs</code>, <code>addArgs</code>, <code>start</code>, <code>uGrad</code>, <code>clinRel</code>, 
<code>lenDose</code>, <code>signTtest</code>, <code>pVal</code>, <code>testOnly</code></p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>The data set.</p>
</td></tr>
<tr><td><code>contMat</code></td>
<td>
<p>The contrast matrix.</p>
</td></tr>
<tr><td><code>corMat</code></td>
<td>
<p>The correlation matrix.</p>
</td></tr>
<tr><td><code>cVal</code></td>
<td>
<p>The critical value for the multiple contrast test.</p>
</td></tr>
<tr><td><code>tStat</code></td>
<td>
<p>The contrast test-statistics. If 'pVal=TRUE' the p-values are also attached.</p>
</td></tr>
<tr><td><code>fm</code></td>
<td>
<p>List containing the dose-response model(s) used for dose-estimation. WARNING: The
model fitting is for computational efficiency done based on the group
means and for positive non-linear parameters (e.g. the ED50 parameter in the Emax model) the 
estimate in <code>fm</code> is on log scale. The summary.MCPMod method shows the parameters on their original scale.
Hence some care is hence needed when extracting the fitted model objects from <code>fm</code>
(in particular when interest is in standard deviations of predictions, parameter estimates...).
</p>
</td></tr>
<tr><td><code>tdose</code></td>
<td>
<p>Estimated target dose, in case of model averaging the dose estimates under
the individual models are attached.</p>
</td></tr>
</table>
<p>Note: If <code>testOnly=TRUE</code>, or no model is significant, the object does not contain <code>fm</code> and <code>tdose</code> entries
</p>


<h3>References</h3>

<p>Bornkamp B., Pinheiro J. C., and Bretz, F. (2009). MCPMod: An            
R Package for the Design and Analysis of Dose-Finding        
Studies, <em>Journal of Statistical Software</em>, <b>29</b>(7), 1&ndash;23
</p>
<p>Bretz, F., Pinheiro, J. C., and Branson, M. (2005), Combining
multiple comparisons and modeling techniques in dose-response
studies, <em>Biometrics</em>, <b>61</b>, 738&ndash;748
</p>
<p>Pinheiro, J. C., Bornkamp, B., and Bretz, F. (2006). Design and analysis of dose finding studies
combining multiple comparisons and modeling procedures, <em>Journal of Biopharmaceutical
Statistics</em>, <b>16</b>, 639&ndash;656
</p>
<p>Pinheiro, J. C., Bretz, F., and Branson, M. (2006). Analysis of dose-response studies - modeling 
approaches, <em>in</em> N. Ting (ed.). <em>Dose Finding in Drug Development</em>, Springer, New York,
pp. 146&ndash;171
</p>
<p>Bretz, F., Pinheiro, J. C., and Branson, M. (2004), On a hybrid
method in dose-finding studies, <em>Methods of Information in Medicine</em>,
<b>43</b>, 457&ndash;460
</p>
<p>Buckland, S. T., Burnham, K. P. and Augustin, N. H. (1997). Model selection an integral part
of inference, <em>Biometrics</em>, <b>53</b>, 603&ndash;618
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+logistic">logistic</a></code>, <code><a href="#topic+sigEmax">sigEmax</a></code>, 
<code><a href="#topic+linlog">linlog</a></code>, <code><a href="#topic+linear">linear</a></code>, <code><a href="#topic+quadratic">quadratic</a></code>,
<code><a href="#topic+emax">emax</a></code>,  <code><a href="#topic+betaMod">betaMod</a></code>, <code><a href="#topic+exponential">exponential</a></code>,
<code><a href="#topic+plot.MCPMod">plot.MCPMod</a></code>, <code><a href="#topic+mvtnorm.control">mvtnorm.control</a> </code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# (i)
# example from Biometrics paper p. 743
data(biom)
models &lt;- list(linear = NULL, linlog = NULL, emax = 0.2,
            exponential = c(0.279,0.15), quadratic = c(-0.854,-1))
dfe &lt;- MCPMod(biom, models, alpha = 0.05, dePar = 0.05, pVal = TRUE,
           selModel = "maxT", doseEst = "MED2", clinRel = 0.4, off = 1)
# detailed information is available via summary
summary(dfe)
# plots data with selected model function
plot(dfe)

# example with IBS data
data(IBS)
models &lt;- list(emax = 0.2, quadratic = -0.2, linlog = NULL)
dfe2 &lt;- MCPMod(IBS, models, alpha = 0.05, pVal = TRUE,
             selModel = "aveAIC", clinRel = 0.25, off = 1)
dfe2
# show more digits in the output
print(dfe2, digits = 8)
summary(dfe2, digits = 8)
plot(dfe2, complData = TRUE, cR = TRUE)
plot(dfe2, CI = TRUE)

# simulate dose-response data
dfData &lt;- genDFdata(model = "emax", argsMod = c(e0 = 0.2, eMax = 1, 
          ed50 = 0.05), doses = c(0,0.05,0.2,0.6,1), n=20, sigma=0.5)
models &lt;- list(emax = 0.1, logistic = c(0.2, 0.08), 
             betaMod = c(1, 1))
dfe3 &lt;- MCPMod(dfData, models, clinRel = 0.4, critV = 1.891, 
           scal = 1.5)

## End(Not run)
# (ii) Example for constructing a model list

# Contrasts to be included:
# Model             guesstimate(s) for stand. model parameter(s) (name)
# linear            -
# linear in log     -
# Emax              0.2 (ED50)
# Emax              0.3 (ED50)
# exponential       0.7 (delta)
# quadratic        -0.85 (delta)
# logistic          0.4  0.09 (ED50, delta)
# logistic          0.3  0.1 (ED50, delta)
# betaMod           0.3  1.3 (delta1, delta2) 
# sigmoid Emax      0.5  2 (ED50, h)
#
# For each model class exactly one list entry needs to be used.
# The names for the list entries need to be written exactly 
# as the model functions ("linear", "linlog", "quadratic", "emax", 
# "exponential", "logistic", "betaMod", "sigEmax").
# For models with no parameter in the standardized model just NULL is 
# specified as list entry.
# For models with one parameter a vector needs to be used with length
# equal to the number of contrasts to be used for this model class.
# For the models with two parameters in the standardized model a vector
# is used to hand over the contrast, if it is desired to use just one
# contrast. Otherwise a matrix with the guesstimates in the rows needs to
# be used. For the above example the models list has to look like this

list(linear = NULL, linlog = NULL, emax = c(0.2, 0.3),
     exponential = 0.7, quadratic = -0.85, logistic =
     matrix(c(0.4, 0.3, 0.09, 0.1), nrow = 2),
     betaMod = c(0.3, 1.3), sigEmax = c(0.5, 2))

# Additional parameters (who will not be estimated) are the "off"
# parameter for the linlog model and the "scal" parameter for the
# beta model, which are not handed over in the model list.


# (iii) example for incorporation of a usermodel
# simulate dose response data
dats &lt;- genDFdata("sigEmax", c(e0 = 0, eMax = 1, ed50 = 2, h = 2),
              n = 50, sigma = 1, doses = 0:10)
# define usermodel
userMod &lt;- function(dose, a, b, d){
  a + b*dose/(dose + d)
}
# define gradient
userModGrad &lt;- 
    function(dose, a, b, d) cbind(1, dose/(dose+d), -b*dose/(dose+d)^2)    
# name starting values for nls
start &lt;- list(userMod=c(a=0, b=1, d=2))       
models &lt;- list(userMod=c(0, 1, 1), linear = NULL)
MM1 &lt;- MCPMod(dats, models, clinRel = 0.4, selModel="AIC", start = start,
         uGrad = userModGrad)

# (iv) Contrast matrix and critical value handed over and not calculated
# simulate dose response data
dat &lt;- genDFdata(mu = (0:4)/4, n = 20, 
                       sigma = 1, doses = (0:4)/4)
# construct optimal contrasts and critical value with planMM
doses &lt;- (0:4)/4
mods &lt;- list(linear = NULL, quadratic = -0.7)
pM &lt;- planMM(mods, doses, 20)
MCPMod(dat, models = NULL, clinRel = 0.3, contMat = pM$contMat,
     critV = pM$critVal)
## Not run: 
# (v) Using MCPMod for mutiple contrast tests only
mu1 &lt;- c(1, 2, 2, 2, 2)                      
mu2 &lt;- c(1, 1, 2, 2, 2)                      
mu3 &lt;- c(1, 1, 1, 2, 2)                      
mMat &lt;- cbind(mu1, mu2, mu3)              
dimnames(mMat)[[1]] &lt;- doses               
pM &lt;- planMM(muMat = mMat, doses = doses, n = 20, cV = FALSE)
# calculate p-values
fit &lt;-MCPMod(dat, models = NULL, clinRel = 0.3, contMat = pM$contMat,
        pVal = TRUE, testOnly = TRUE)
summary(fit)

## End(Not run)
</code></pre>

<hr>
<h2 id='MCPMod-internal'> Internal MCPMod functions </h2><span id='topic+fitModel'></span><span id='topic+AIC.fitMCPMod'></span><span id='topic+predict.fitMCPMod'></span><span id='topic+coef.fitMCPMod'></span><span id='topic+pValues'></span><span id='topic+getTstat'></span><span id='topic+getInit'></span><span id='topic+getInitBeta'></span><span id='topic+getGrad'></span><span id='topic+getDoseEst'></span><span id='topic+getDose'></span><span id='topic+getDef'></span><span id='topic+modContr'></span><span id='topic+getOptCont'></span><span id='topic+getStdCont'></span><span id='topic+modelSelect'></span><span id='topic+getInitP'></span><span id='topic+getInitLRasymp'></span><span id='topic+recovNames'></span>

<h3>Description</h3>

<p>These functions are not meant to be called by the user.
</p>

<hr>
<h2 id='MCPMod-package'>
Design and Analysis of Dose-Finding Studies
</h2><span id='topic+MCPMod-package'></span>

<h3>Description</h3>

<p>This package implements a methodology for dose-response analysis
that combines aspects of multiple comparison procedures and modeling approaches
(Bretz, Pinheiro and Branson, (2005)). The package provides tools for the analysis 
of dose finding trials as well as a variety of tools necessary to plan a trial to 
be conducted with the MCPMod methodology. **Note: The MCPMod package will not be further 
developed, all future development of the MCP-Mod methodology will be done in the 
DoseFinding R-package, which already contains an extended version of MCP-Mod, and additional
functions useful for planning and analysing dose-finding trials.**
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> MCPMod</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0-9</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2016-11-24</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-3</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Bjoern Bornkamp, Jose Pinheiro and Frank Bretz
</p>
<p>Maintainer: Bjoern Bornkamp &lt;bornkamp@statistik.tu-dortmund.de&gt;
</p>


<h3>References</h3>

<p>Bornkamp B., Pinheiro J. C., and Bretz, F. (2009), MCPMod: An            
R Package for the Design and Analysis of Dose-Finding        
Studies, <em>Journal of Statistical Software</em>, <b>29</b>(7), 1&ndash;23
</p>
<p>Bretz, F., Pinheiro, J. C., and Branson, M. (2005), Combining
multiple comparisons and modeling techniques in dose-response
studies, <em>Biometrics</em>, <b>61</b>, 738&ndash;748
</p>
<p>Pinheiro, J. C., Bornkamp, B., and Bretz, F. (2006). Design and analysis of dose finding studies
combining multiple comparisons and modeling procedures, <em>Journal of Biopharmaceutical
Statistics</em>, <b>16</b>, 639&ndash;656
</p>
<p>Pinheiro, J. C., Bretz, F., and Branson, M. (2006). Analysis of dose-response studies - modeling 
approaches, <em>in</em> N. Ting (ed.). <em>Dose Finding in Drug Development</em>, Springer, New York,
pp. 146&ndash;171
</p>


<h3>Examples</h3>

<pre><code class='language-R'># detailed information regarding MCP-Mod methodology
# and R-package available via vignette("MCPMod")
## Not run: 
# planning a trial for MCPMod
doses &lt;- c(0,10,25,50,100,150)                                             
models &lt;- list(linear = NULL, emax = c(25),                                
               logistic = c(50, 10.88111), exponential = c(85),            
               betaMod = matrix(c(0.33, 2.31, 1.39, 1.39), byrow=TRUE,nrow=2))
plotModels(models, doses, base = 0, maxEff = 0.4, scal = 200) 
sSize &lt;- sampSize(models, doses, base = 0, maxEff = 0.4, sigma = 1,             
           upperN = 80, scal = 200, alpha = 0.05)
sSize
plM &lt;- planMM(models, doses, n = rep(sSize$samp.size,6), scal=200, alpha = 0.05)
plM
plot(plM)

# analysing a trial
data(biom)
models &lt;- list(linear = NULL, linlog = NULL, emax = 0.2,
            exponential = c(0.279,0.15), quadratic = c(-0.854,-1))

dfe &lt;- MCPMod(biom, models, alpha = 0.05, dePar = 0.05, pVal = TRUE,
           selModel = "maxT", doseEst = "MED2", clinRel = 0.4, off = 1)
# detailed information is available via summary
summary(dfe)
# plots data with selected model function
plot(dfe, complData = TRUE, cR = TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='modelMeans'> Calculate mean vectors for a given candidate set </h2><span id='topic+modelMeans'></span>

<h3>Description</h3>

<p>Calculates the mean or standardized mean vectors for a candidate
set of models. This function is mainly for internal use.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>modelMeans(models, doses, std = TRUE, off = 0.1 * max(doses),
           scal = 1.2 * max(doses))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="modelMeans_+3A_models">models</code></td>
<td>
<p> A list of candidate models, or the output
of the <code>fullMod</code> function (depending on the 
value of <code>std</code>). </p>
</td></tr>
<tr><td><code id="modelMeans_+3A_doses">doses</code></td>
<td>
<p> A numeric vector giving the doses to be administered. </p>
</td></tr>
<tr><td><code id="modelMeans_+3A_std">std</code></td>
<td>
<p> Logical indicating whether standardized or non-standardized
version of model function should be used. </p>
</td></tr>
<tr><td><code id="modelMeans_+3A_off">off</code></td>
<td>
<p> Offset parameter for linear in log model. </p>
</td></tr>
<tr><td><code id="modelMeans_+3A_scal">scal</code></td>
<td>
<p> Scale parameter for beta model. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>Matrix with standardized or non-standardized model means.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>doses &lt;- c(0, 10, 25, 50, 100, 150)                                        
models &lt;- list(linear = NULL, emax = c(25),                                
               logistic = c(50, 10.88111), exponential = c(85),            
               betaMod = matrix(c(0.33, 2.31, 1.39, 1.39), byrow=TRUE,nrow=2))
modelMeans(models, doses, std = TRUE)

# now non-standardized means
Models &lt;- fullMod(models, doses, base = 0, maxEff = 0.4, scal = 200)                 
modelMeans(Models, doses, std = FALSE)
</code></pre>

<hr>
<h2 id='mvtnorm.control'> Control options for pmvt and qmvt functions </h2><span id='topic+mvtnorm.control'></span>

<h3>Description</h3>

<p>Returns a list with control parameters (an object of class GenzBretz) 
for the <code>pmvt</code> and <code>qmvt</code> functions from the <code>mvtnorm</code> 
package, see the corresponding documentation for more information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mvtnorm.control(maxpts = 30000, abseps = 0.001,
                interval = NULL, releps = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mvtnorm.control_+3A_maxpts">maxpts</code></td>
<td>
<p> Maximum number of function values as integer. </p>
</td></tr>
<tr><td><code id="mvtnorm.control_+3A_abseps">abseps</code></td>
<td>
<p> Absolute error tolerance as double.  </p>
</td></tr>
<tr><td><code id="mvtnorm.control_+3A_interval">interval</code></td>
<td>
<p> A vector containing the end-points of the interval to be searched 
for the critical value. </p>
</td></tr>
<tr><td><code id="mvtnorm.control_+3A_releps">releps</code></td>
<td>
<p> Relative error tolerance as double.  </p>
</td></tr>
</table>


<h3>See Also</h3>

 <p><code><a href="mvtnorm.html#topic+pmvt">pmvt</a></code>, <code><a href="mvtnorm.html#topic+qmvt">qmvt</a></code> </p>

<hr>
<h2 id='planMM'> Calculate planning quantities for MCPMod </h2><span id='topic+planMM'></span><span id='topic+print.planMM'></span>

<h3>Description</h3>

<p>Calculates the optimal model contrasts, the critical value and the contrast correlation matrix, i.e.
the quantities necessary to conduct the multiple contrast test for a given candidate set of 
dose-response models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>planMM(models, doses, n, off = 0.1 * max(doses), scal = 1.2 * max(doses),
       std = TRUE, alpha = 0.025, twoSide = FALSE,
       control = mvtnorm.control(), cV = TRUE, muMat = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="planMM_+3A_models">models</code></td>
<td>
<p> A list of candidate models </p>
</td></tr>
<tr><td><code id="planMM_+3A_doses">doses</code></td>
<td>
<p> A numeric vector giving the doses to be administered. </p>
</td></tr>
<tr><td><code id="planMM_+3A_n">n</code></td>
<td>
<p> The vector of sample sizes per group. In case just one number
is specified, it is assumed that all group sample sizes are equal to 
this number.</p>
</td></tr>
<tr><td><code id="planMM_+3A_off">off</code></td>
<td>
<p> Offset parameter for the linear in log model (default 10 perc of the maximum dose). </p>
</td></tr>
<tr><td><code id="planMM_+3A_scal">scal</code></td>
<td>
<p> Scale parameter for the beta model (default 20 perc. larger than maximum dose).</p>
</td></tr>
<tr><td><code id="planMM_+3A_std">std</code></td>
<td>
<p> Optional logical indicating, whether standardized version
of the models should be assumed. </p>
</td></tr>
<tr><td><code id="planMM_+3A_alpha">alpha</code></td>
<td>
<p> Level of significance (default: 0.025)</p>
</td></tr>
<tr><td><code id="planMM_+3A_twoside">twoSide</code></td>
<td>
<p> Logical indicating whether a two sided or a one-sided
test should be performed. By default FALSE, so one-sided testing. </p>
</td></tr>
<tr><td><code id="planMM_+3A_control">control</code></td>
<td>
<p> A list of options for the <code>pmvt</code> and <code>qmvt</code> functions
as produced by <code>mvtnorm.control</code> </p>
</td></tr>
<tr><td><code id="planMM_+3A_cv">cV</code></td>
<td>
<p> Logical indicating whether critical value should be calculated </p>
</td></tr>
<tr><td><code id="planMM_+3A_mumat">muMat</code></td>
<td>
<p> An optional matrix with means in the columns and given dimnames (dose levels
and names of contrasts). If specified
the <code>models</code> argument should not be specified, see examples
below. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class planMM with the following components:
</p>
<table>
<tr><td><code>contMat</code></td>
<td>
<p>Matrix of optimal contrasts.</p>
</td></tr>
<tr><td><code>critVal</code></td>
<td>
<p>The critical value for the test (if calculated)</p>
</td></tr>
<tr><td><code>muMat</code></td>
<td>
<p>Matrix of (non-normalized) model means</p>
</td></tr>
<tr><td><code>corMat</code></td>
<td>
<p>Matrix of the contrast correlations.</p>
</td></tr>
</table>


<h3>References</h3>

 
<p>Bornkamp B., Pinheiro J. C., and Bretz, F. (2009). MCPMod: An            
R Package for the Design and Analysis of Dose-Finding        
Studies, <em>Journal of Statistical Software</em>, <b>29</b>(7), 1&ndash;23
</p>
<p>Bretz, F., Pinheiro, J., and Branson, M. (2005), Combining
Multiple Comparisons and Modeling Techniques in Dose-Response
Studies, <em>Biometrics</em>, <b>61</b>, 738&ndash;748
</p>
<p>Pinheiro, J. C., Bornkamp, B., and Bretz, F. (2006). Design and analysis of dose finding studies
combining multiple comparisons and modeling procedures, <em>Journal of Biopharmaceutical
Statistics</em>, <b>16</b>, 639&ndash;656
</p>


<h3>See Also</h3>

<p><code><a href="#topic+critVal">critVal</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># Example from JBS paper
doses &lt;- c(0,10,25,50,100,150)
models &lt;- list(linear = NULL, emax = 25,                               
               logistic = c(50, 10.88111), exponential= 85,            
               betaMod=matrix(c(0.33,2.31,1.39,1.39), byrow=TRUE, nrow=2))
plM &lt;- planMM(models, doses, n = rep(50,6), alpha = 0.05, scal=200)
plot(plM)

## Not run: 
# example, where means are directly specified
# doses   
dvec &lt;- c(0, 10, 50, 100)
# mean vectors
mu1 &lt;- c(1, 2, 2, 2)
mu2 &lt;- c(1, 1, 2, 2)
mu3 &lt;- c(1, 1, 1, 2)
mMat &lt;- cbind(mu1, mu2, mu3)
dimnames(mMat)[[1]] &lt;- dvec
planMM(muMat = mMat, doses = dvec, n = 30)

## End(Not run)
</code></pre>

<hr>
<h2 id='plot.fullMod'> Plot method for fullMod objects </h2><span id='topic+plot.fullMod'></span>

<h3>Description</h3>

<p>Plot method for fullMod objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'fullMod'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.fullMod_+3A_x">x</code></td>
<td>
 <p><code>fullMod</code> object </p>
</td></tr>
<tr><td><code id="plot.fullMod_+3A_...">...</code></td>
<td>
<p> Additional arguments for the <code>plotModels</code> function </p>
</td></tr>
</table>


<h3>See Also</h3>

 <p><code><a href="#topic+plotModels">plotModels</a></code>, <code><a href="#topic+fullMod">fullMod</a></code> </p>

<hr>
<h2 id='plot.LP'> Plot method for LP objects </h2><span id='topic+plot.LP'></span>

<h3>Description</h3>

<p>Graphically displays an LP object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'LP'
plot(x, line = TRUE, type = NULL, spldf = 5, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.LP_+3A_x">x</code></td>
<td>
<p> LP object as obtained from a call to the <code>LP</code> function </p>
</td></tr>
<tr><td><code id="plot.LP_+3A_line">line</code></td>
<td>
<p> Logical indicating whether the power values should be smoothed. </p>
</td></tr>
<tr><td><code id="plot.LP_+3A_type">type</code></td>
<td>
<p> One of &quot;LP1&quot;, &quot;LP2&quot; or &quot;both&quot;, availability depending on whether
the corresponding values have been calculated in the call to
the <code>LP</code> function. </p>
</td></tr>
<tr><td><code id="plot.LP_+3A_spldf">spldf</code></td>
<td>
<p> Numeric determining the degrees of freedom for the smoothing spline
which is plotted if <code>line==TRUE</code>. Note that <code>spldf</code> should
be larger than 1 and smaller than <code>len</code> (default: 5).</p>
</td></tr>
<tr><td><code id="plot.LP_+3A_...">...</code></td>
<td>
<p> Additional arguments. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function produces a trellis display of the loss in power for different values
of the standardized model parameter. A smoothing spline (with <code>spldf</code> degrees of freedom) is fit to these 
points to give a smooth impression of the loss in power curve. 
For models with two prior parameters
a trellis display is shown with the number of panels equal to <code>len[2]</code>.
The number of points on which the power is evaluated is equal to <code>len[1]</code>
in each panel, where <code>len</code> is an argument of the <code>LP</code> function.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+LP">LP</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
doses &lt;- c(0,10,25,50,100,150)                                           
models &lt;- list(linear=NULL, emax=c(25),
           logistic=c(50,10.88111), exponential=c(85),
           betaMod=matrix(c(0.33,2.31,1.39,1.39),byrow=TRUE,nrow=2))

# Examples from JBS paper, p.654
LPobj &lt;- LP(models, model = "emax", type = "both", paramRange = c(10,70),
           doses = doses, base = 0, maxEff = 0.4, sigma = 1, n = 60,     
           alpha = 0.05, len = 15, scal = 200)
plot(LPobj)
plot(LPobj, line = FALSE, type = "LP1")
plot(LPobj, type = "LP1", spldf = 9)

## End(Not run)
</code></pre>

<hr>
<h2 id='plot.MCPMod'>Plot MCPMod model fits</h2><span id='topic+plot.MCPMod'></span>

<h3>Description</h3>

<p>The function plots the model(s) used for dose estimation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'MCPMod'
plot(x, complData = FALSE, CI = FALSE, clinRel = FALSE, doseEst = FALSE,
     gamma = NULL, models = "all", nrDoseGam = 1,
     colors = c("black", "blue", "black", "gray", "blue"),
     uGrad = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.MCPMod_+3A_x">x</code></td>
<td>
<p> A MCPMod object. </p>
</td></tr>
<tr><td><code id="plot.MCPMod_+3A_compldata">complData</code></td>
<td>
<p> Logical indicating whether complete data set or group means should be plotted. </p>
</td></tr>
<tr><td><code id="plot.MCPMod_+3A_ci">CI</code></td>
<td>
<p> Logical indicating whether a confidence interval should be plotted along the
model fit(s). </p>
</td></tr>
<tr><td><code id="plot.MCPMod_+3A_clinrel">clinRel</code></td>
<td>
<p> Logical indicating, whether clinical relevance threshold should be included in plot. </p>
</td></tr>
<tr><td><code id="plot.MCPMod_+3A_doseest">doseEst</code></td>
<td>
<p> Logical determining whether dose estimate should be included in plot. </p>
</td></tr>
<tr><td><code id="plot.MCPMod_+3A_gamma">gamma</code></td>
<td>
<p> Numeric giving the value for the 1-2*gamma pointwise CI around
the predicted mean. if equal to NULL the value
determined in the MCPMod call is used. In case
a vector of gamma values was used <code>nrDoseGam</code> determines which
is used. </p>
</td></tr>
<tr><td><code id="plot.MCPMod_+3A_models">models</code></td>
<td>
<p>  Character vector determining, which of the used
models should be plotted (only available if model averaging was used) </p>
</td></tr>
<tr><td><code id="plot.MCPMod_+3A_nrdosegam">nrDoseGam</code></td>
<td>
<p> In case a vector is specified for <code>dePar</code> in 
the MCPMod function (and gamma in the plot.MCPMod
function is NULL), nrDoseGam determines which of
these values should be used for the conf. interval
and the dose estimate (if doseEst = T). </p>
</td></tr>
<tr><td><code id="plot.MCPMod_+3A_colors">colors</code></td>
<td>
<p> Vector of length 5 with the names of the colors for:
predictions, CI, data, clinical relevance threshold,
dose estimator </p>
</td></tr>
<tr><td><code id="plot.MCPMod_+3A_ugrad">uGrad</code></td>
<td>
<p> If a user defined model has been used for dose estimation, the gradient
function needs to be handed over via uGrad. </p>
</td></tr>
<tr><td><code id="plot.MCPMod_+3A_...">...</code></td>
<td>
<p> Additional arguments to xyplot. </p>
</td></tr>
</table>


<h3>See Also</h3>

 <p><code><a href="#topic+MCPMod">MCPMod</a></code> </p>

<hr>
<h2 id='plot.planMM'>Plotting a planMM object</h2><span id='topic+plot.planMM'></span>

<h3>Description</h3>

<p>This function displays the contrasts or model means obtained from
a planMM object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'planMM'
plot(x, superpose = TRUE, xlab = "Dose",
     ylab = NULL, resp = c("contrasts", "means"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.planMM_+3A_x">x</code></td>
<td>
<p> A planMM object. </p>
</td></tr>
<tr><td><code id="plot.planMM_+3A_superpose">superpose</code></td>
<td>
<p> Logical, indicating if lines should be superposed. </p>
</td></tr>
<tr><td><code id="plot.planMM_+3A_xlab">xlab</code></td>
<td>
<p> Label for x-axis </p>
</td></tr>
<tr><td><code id="plot.planMM_+3A_ylab">ylab</code></td>
<td>
<p> Label for y-axis </p>
</td></tr>
<tr><td><code id="plot.planMM_+3A_resp">resp</code></td>
<td>
<p> One of &quot;contrasts&quot; or &quot;means&quot;. Determines, whether contrasts or
normalized means are plotted. </p>
</td></tr>
<tr><td><code id="plot.planMM_+3A_...">...</code></td>
<td>
<p> Additional arguments to the <code>xyplot</code> function call. </p>
</td></tr>
</table>


<h3>See Also</h3>

 <p><code><a href="#topic+planMM">planMM</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
doses &lt;- c(0, 10, 25, 50, 100, 150)
models &lt;- list(linear = NULL, emax = c(25),
               logistic = c(50, 10.88111), exponential = c(85),
               betaMod = matrix(c(0.33, 2.31, 1.39, 1.39),
                byrow=TRUE,nrow=2))
pM &lt;- planMM(models, doses, 50, scal = 200)
plot(pM)
plot(pM, superpose=FALSE, xlab="Different axis name")
plot(pM, resp = "means")
# example with muMat
dvec &lt;- c(0, 10, 50, 100)
mu1 &lt;- c(1, 2, 2, 2)
mu2 &lt;- c(1, 1, 2, 2)
mu3 &lt;- c(1, 1, 1, 2)
mMat &lt;- cbind(mu1, mu2, mu3)
dimnames(mMat)[[1]] &lt;- dvec
pM &lt;- planMM(muMat = mMat, doses = dvec, n = 30)
plot(pM)
plot(pM, superpose=FALSE, xlab="Different axis name")

## End(Not run)
</code></pre>

<hr>
<h2 id='plot.powerMM'> Plot method for powerMM objects</h2><span id='topic+plot.powerMM'></span>

<h3>Description</h3>

<p>This function plots the result of the <code>powerMM</code> function call
in a trellis display.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'powerMM'
plot(x, superpose = TRUE, line.at = NULL, models = "all",
     summ = NULL, perc = FALSE, xlab = NULL,
     ylab = ifelse(perc, "Power (%)", "Power"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.powerMM_+3A_x">x</code></td>
<td>
<p> A powerMM object, i.e. a matrix with power values for different sample sizes and models </p>
</td></tr>
<tr><td><code id="plot.powerMM_+3A_superpose">superpose</code></td>
<td>
<p> Logical, indicating if lines should be superposed. </p>
</td></tr>
<tr><td><code id="plot.powerMM_+3A_line.at">line.at</code></td>
<td>
<p> A value, or a vector of values, between 0 and 1, to be        
drawn as horizontal line in the plot (default: not drawn).</p>
</td></tr>
<tr><td><code id="plot.powerMM_+3A_models">models</code></td>
<td>
<p> Character determining which of the models should be included in the plot,            
&quot;all&quot; and &quot;none&quot; are accepted, else names (or numbers) of models. </p>
</td></tr>
<tr><td><code id="plot.powerMM_+3A_summ">summ</code></td>
<td>
<p> Summaries to be included in plot; by default the mean, the minimum
and the maximum value are displayed.</p>
</td></tr>
<tr><td><code id="plot.powerMM_+3A_perc">perc</code></td>
<td>
<p> Logical indicating if power values should be in percentage. </p>
</td></tr>
<tr><td><code id="plot.powerMM_+3A_xlab">xlab</code></td>
<td>
<p> Label for x-axis. </p>
</td></tr>
<tr><td><code id="plot.powerMM_+3A_ylab">ylab</code></td>
<td>
<p> Label for y-axis. </p>
</td></tr>
<tr><td><code id="plot.powerMM_+3A_...">...</code></td>
<td>
<p> Additional arguments for the <code>xyplot</code> function. </p>
</td></tr>
</table>


<h3>References</h3>

<p> Pinheiro, J. C., Bornkamp, B. and Bretz, F. (2006). Design and analysis of dose finding studies
combining multiple comparisons and modeling procedures, <em>Journal of Biopharmaceutical
Statistics</em>, <b>16</b>, 639&ndash;656
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+powerMM">powerMM</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Example from JBS paper
doses &lt;- c(0,10,25,50,100,150)                                         
models &lt;- list(linear = NULL, emax = 25,                               
               logistic = c(50, 10.88111), exponential= 85,            
               betaMod=matrix(c(0.33,2.31,1.39,1.39), byrow=TRUE, nrow=2))
pM &lt;- powerMM(models, doses, base = 0, maxEff = 0.4, sigma = 1,       
               lower = 10, upper = 100, step = 20, scal = 200)        
pM
plot(pM)
plot(pM, line.at = 0.8, model = c("emax", "linear"), summ = "mean")
plot(pM, line.at = 0.8, model = "none", summ = c("median", "min"))

## End(Not run)
</code></pre>

<hr>
<h2 id='plotModels'> Plot candidate models </h2><span id='topic+plotModels'></span>

<h3>Description</h3>

<p>Produces a trellis display of the model functions in the candidate set. The location
and scale parameters of the models are determined by the <code>base</code> and <code>maxEff</code>
arguments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotModels(models, doses, base, maxEff, nPoints = 200, 
           off = 0.1 * max(doses), scal = 1.2 * max(doses), 
           superpose = FALSE, ylab = "Model means", 
           xlab = "Dose", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotModels_+3A_models">models</code></td>
<td>
<p> A list specifying the candidate models. This
can also be a fullMod object, then the arguments <code>base</code>, 
<code>maxEff</code>, <code>off</code> and <code>scal</code> are ignored. </p>
</td></tr>
<tr><td><code id="plotModels_+3A_doses">doses</code></td>
<td>
<p> Dose levels to be administered </p>
</td></tr>
<tr><td><code id="plotModels_+3A_base">base</code></td>
<td>
<p> Expected baseline effect </p>
</td></tr>
<tr><td><code id="plotModels_+3A_maxeff">maxEff</code></td>
<td>
<p> Expected maximum change from baseline </p>
</td></tr>
<tr><td><code id="plotModels_+3A_npoints">nPoints</code></td>
<td>
<p> Number of points for plotting </p>
</td></tr>
<tr><td><code id="plotModels_+3A_off">off</code></td>
<td>
<p> Offset parameter for the linear in log model (default: 10 percent of maximum dose) </p>
</td></tr>
<tr><td><code id="plotModels_+3A_scal">scal</code></td>
<td>
<p> Scale parameter for the beta model (default: 20 percent larger than maximum dose) </p>
</td></tr>
<tr><td><code id="plotModels_+3A_superpose">superpose</code></td>
<td>
<p> Logical determining, whether model plots should be superposed </p>
</td></tr>
<tr><td><code id="plotModels_+3A_ylab">ylab</code>, <code id="plotModels_+3A_xlab">xlab</code></td>
<td>
<p> Label for y-axis and x-axis. </p>
</td></tr>
<tr><td><code id="plotModels_+3A_...">...</code></td>
<td>
<p> Additional arguments to the <code>xyplot</code> call. </p>
</td></tr>
</table>


<h3>References</h3>

 
<p>Bornkamp B., Pinheiro J. C., Bretz, F. (2009). MCPMod: An            
R Package for the Design and Analysis of Dose-Finding        
Studies, <em>Journal of Statistical Software</em>, <b>29</b>(7), 1&ndash;23
</p>
<p>Pinheiro, J. C., Bornkamp, B. and Bretz, F. (2006). Design and analysis of dose finding studies
combining multiple comparisons and modeling procedures, <em>Journal of Biopharmaceutical
Statistics</em>, <b>16</b>, 639&ndash;656
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+guesst">guesst</a></code>, <code><a href="#topic+fullMod">fullMod</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'># JBS example
doses &lt;- c(0,10,25,50,100,150)
models &lt;- list(linear = NULL, emax = c(25),
            logistic = c(50, 10.88111), exponential = c(85),
            betaMod = matrix(c(0.33, 2.31, 1.39, 1.39),
             byrow=TRUE, nrow=2))
plotModels(models, doses, base = 0, maxEff = 0.4, scal = 200) 
# all models in one panel
plotModels(models, doses, base = 0, maxEff = 0.4, scal = 200,
           superpose = TRUE)

# plotModels can also be called using a fullMod object
fM &lt;- fullMod(models, doses, base = 0, maxEff = 0.4, scal = 200)
plotModels(fM)
# or even easier
plot(fM)
</code></pre>

<hr>
<h2 id='powCalc'> Calculate the power for the multiple contrast test </h2><span id='topic+powCalc'></span>

<h3>Description</h3>

<p>Given the optimal contrasts, the sample size and a certain &lsquo;alternative&rsquo; (i.e. a mean vector and sigma), the
function calculates the power to detect this alternative. See Pinheiro et al. (2006) for details.
The function is the building block for the functions <code>powerMM</code>, <code>sampSize</code> and <code>LP</code>.
Numerical integration routines from the <code>mvtnorm</code> package are used to calculate the underlying
multivariate integrals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powCalc(cMat, n, alpha = 0.025, delta = NULL, mu = NULL,
        sigma = NULL, cVal = NULL, corMat = NULL,
        twoSide = FALSE, control = mvtnorm.control())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="powCalc_+3A_cmat">cMat</code></td>
<td>
<p> Matrix with the contrasts in the columns </p>
</td></tr>
<tr><td><code id="powCalc_+3A_n">n</code></td>
<td>
<p> Numeric vector of sample sizes per group. In case just one number
is specified, it is assumed that all group sample sizes are equal to 
this number</p>
</td></tr>
<tr><td><code id="powCalc_+3A_alpha">alpha</code></td>
<td>
<p> Level of significance (defaults to 0.025)</p>
</td></tr>
<tr><td><code id="powCalc_+3A_delta">delta</code></td>
<td>
<p> Non-centrality vector of the distribution of the test statistic
under the alternative. </p>
</td></tr>
<tr><td><code id="powCalc_+3A_mu">mu</code></td>
<td>
<p> Mean vector under the alternative. The function then calculates the
non-centrality vector itself. Ignored if <code>delta</code> is specified.</p>
</td></tr>
<tr><td><code id="powCalc_+3A_sigma">sigma</code></td>
<td>
<p> Expected standard deviation of the response. Only necessary if
the non-centrality vector is to be calculated by the function (i.e.
if <code>delta</code> is NULL). </p>
</td></tr>
<tr><td><code id="powCalc_+3A_cval">cVal</code></td>
<td>
<p> Optional numeric vector giving the critical value, if specified
the argument <code>alpha</code> is ignored. </p>
</td></tr>
<tr><td><code id="powCalc_+3A_cormat">corMat</code></td>
<td>
<p> An optional matrix giving the correlations of the contrasts
specified in <code>cMat</code>. </p>
</td></tr>
<tr><td><code id="powCalc_+3A_twoside">twoSide</code></td>
<td>
<p> Logical indicating whether a two sided or a one sided
test should be performed (defaults to one-sided) </p>
</td></tr>
<tr><td><code id="powCalc_+3A_control">control</code></td>
<td>
<p> A list of options for the <code>pmvt</code> and <code>qmvt</code> functions
as produced by <code>mvtnorm.control</code>. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns the power value.
</p>


<h3>References</h3>

 
<p>Pinheiro, J. C., Bornkamp, B. and Bretz, F. (2006). Design and analysis of dose finding studies
combining multiple comparisons and modeling procedures, <em>Journal of Biopharmaceutical
Statistics</em>, <b>16</b>, 639&ndash;656
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+planMM">planMM</a></code>, <code><a href="#topic+LP">LP</a></code>,  <code><a href="#topic+sampSize">sampSize</a></code>,  <code><a href="#topic+powerMM">powerMM</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>doses &lt;- c(0,10,25,50,100,150)
models &lt;- list(linear = NULL, emax = c(25),
               logistic = c(50, 10.88111), exponential=c(85),
               betaMod=matrix(c(0.33,2.31,1.39,1.39), byrow=TRUE, nrow=2))

# calculate optimal contrasts and critical value 
plMM &lt;- planMM(models, doses, 50, scal = 200, alpha = 0.05)

# calculate mean vectors
compMod &lt;- fullMod(models, doses, base = 0, maxEff = 0.4, scal = 200)
muMat &lt;- modelMeans(compMod, doses, FALSE, scal = 200)

# calculate power to detect mean vectors
# Power for linear model 
powCalc(plMM$contMat, 50, mu = muMat[,1], sigma = 1, cVal = plMM$critVal)
# Power for emax model  
powCalc(plMM$contMat, 50, mu = muMat[,2], sigma = 1, cVal = plMM$critVal)
# Power for logistic model
powCalc(plMM$contMat, 50, mu = muMat[,3], sigma = 1, cVal = plMM$critVal)
# compare with JBS 16, p. 650
</code></pre>

<hr>
<h2 id='powerMM'> Calculate power for different sample sizes </h2><span id='topic+powerMM'></span>

<h3>Description</h3>

<p>Calculates the power under the assumed candidate set for
different sample sizes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powerMM(models, doses, base, maxEff, sigma, lower, upper, step,
        sumFct = c("min", "mean", "max"), off = 0.1 * max(doses),
        scal = 1.2 * max(doses), alpha = 0.025, twoSide = FALSE,
        control = mvtnorm.control(), muMat = NULL, alRatio = NULL,
        typeN = c("arm", "total"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="powerMM_+3A_models">models</code></td>
<td>
<p> A list specifying the candidate models. This
can also be a fullMod object, then the arguments <code>base</code>, 
<code>maxEff</code>, <code>off</code> and <code>scal</code> are ignored. </p>
</td></tr>
<tr><td><code id="powerMM_+3A_doses">doses</code></td>
<td>
<p> Dose levels to be administered </p>
</td></tr>
<tr><td><code id="powerMM_+3A_base">base</code></td>
<td>
<p> Expected baseline effect </p>
</td></tr>
<tr><td><code id="powerMM_+3A_maxeff">maxEff</code></td>
<td>
<p> Expected maximum change from baseline </p>
</td></tr>
<tr><td><code id="powerMM_+3A_sigma">sigma</code></td>
<td>
<p> Expected standard deviation </p>
</td></tr>
<tr><td><code id="powerMM_+3A_lower">lower</code>, <code id="powerMM_+3A_upper">upper</code></td>
<td>
<p>  Maximum and minimum group sample size for
which the power is calculated. </p>
</td></tr>
<tr><td><code id="powerMM_+3A_step">step</code></td>
<td>
<p> Stepsize for the sample size at which the power is calculated.
It is calculated at <code>seq(lower,upper,by=step)</code>. </p>
</td></tr>
<tr><td><code id="powerMM_+3A_sumfct">sumFct</code></td>
<td>
<p> A character vector giving the names of the summary functions used to combine the power values 
into one value. By default the minimum, the mean and the maximum are used. </p>
</td></tr>
<tr><td><code id="powerMM_+3A_off">off</code></td>
<td>
<p> Offset parameter for the linear in log model (default 10 perc. of maximum dose). </p>
</td></tr>
<tr><td><code id="powerMM_+3A_scal">scal</code></td>
<td>
<p> Scale parameter for the beta model (default 20 perc. larger than maximum dose).</p>
</td></tr>
<tr><td><code id="powerMM_+3A_alpha">alpha</code></td>
<td>
<p> Level of significance (default: 0.025)</p>
</td></tr>
<tr><td><code id="powerMM_+3A_twoside">twoSide</code></td>
<td>
<p> Logical indicating whether a two sided or a one-sided
test should be performed. By default FALSE, so one-sided testing. </p>
</td></tr>
<tr><td><code id="powerMM_+3A_control">control</code></td>
<td>
<p> A list of options for the <code>pmvt</code> and <code>qmvt</code> functions
as produced by <code>mvtnorm.control</code>. </p>
</td></tr>
<tr><td><code id="powerMM_+3A_mumat">muMat</code></td>
<td>
<p> An optional matrix with means in the columns, dimnames should
be given (dose levels and names of contrasts), if specified the
the <code>models</code> argument should not be specified, see examples
below. </p>
</td></tr>
<tr><td><code id="powerMM_+3A_alratio">alRatio</code></td>
<td>
<p> Vector describing the relative patient allocations to the dose
groups. See examples below, e.g. c(1,2,2) corresponds to allocating
twice as many patients in dose groups two and three. Per default
balanced allocations are assumed. </p>
</td></tr>
<tr><td><code id="powerMM_+3A_typen">typeN</code></td>
<td>
<p> One of &quot;arm&quot; or &quot;total&quot;. Determines, whether the sample size in the
smallest arm or the total sample size is iterated in bisection
search algorithm. See examples below. </p>
</td></tr>
<tr><td><code id="powerMM_+3A_...">...</code></td>
<td>
<p> Possible additional arguments for sumFct. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given the candidate set of models and associated guesstimates the 
function calculates the power to detect every model in the candidate set
for different group sample sizes. 
Additionally summary functions can be specified to calculate the
combined power (by default the minimum, mean and maximum).
The location and scale parameters are determined by forcing 
the model function to go through (0,base) and (dmax,maxEff), see 
Pinheiro et al. (2006) for details. 
There exists a plot method for the output of the powerMM function. See the examples below.
</p>


<h3>Value</h3>

<p>A <code>powerMM</code> object, i.e. a matrix containing the power values for different sample sizes and models
</p>


<h3>References</h3>

 
<p>Bornkamp B., Pinheiro J. C., and Bretz, F. (2009). MCPMod: An            
R Package for the Design and Analysis of Dose-Finding        
Studies, <em>Journal of Statistical Software</em>, <b>29</b>(7), 1&ndash;23
</p>
<p>Pinheiro, J. C., Bornkamp, B. and Bretz, F. (2006). Design and analysis of dose finding studies
combining multiple comparisons and modeling procedures, <em>Journal of Biopharmaceutical
Statistics</em>, <b>16</b>, 639&ndash;656
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+plot.powerMM">plot.powerMM</a></code>,  <code><a href="#topic+powCalc">powCalc</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
doses &lt;- c(0,10,25,50,100,150)                                         
models &lt;- list(linear = NULL, emax = 25,                               
               logistic = c(50, 10.88111), exponential= 85,            
               betaMod=matrix(c(0.33,2.31,1.39,1.39), byrow=TRUE, nrow=2))
pM &lt;- powerMM(models, doses, base = 0, maxEff = 0.4, sigma = 1,
            alpha = 0.05, lower = 10, upper = 100, step = 20, scal = 200)         
pM
# a graphical display provides plot method
plot(pM)                                
# reproduces plot in JBS 16, p.651      
plot(pM, line.at = 0.8, models = "none")


# the same with fullMod object and default alpha
fMod &lt;- fullMod(models, doses, base = 0, maxEff = 0.4, scal=200) 
pM &lt;- powerMM(fMod, sigma = 1, lower = 10, upper = 100, 
              step = 20, scal = 200)         
pM

# using unbalanced (but fixed) allocations
pM &lt;- powerMM(models, doses, base = 0, maxEff = 0.4, sigma = 1,       
               lower = 10, upper = 100, step = 20, scal = 200,
               alRatio = c(3, 2, 2, 1, 1, 1), typeN = "arm") 
plot(pM, summ = "mean")

# example, where means are directly specified
# doses   
dvec &lt;- c(0, 10, 50, 100)
# mean vectors
mu1 &lt;- c(1, 2, 2, 2)
mu2 &lt;- c(1, 1, 2, 2)
mu3 &lt;- c(1, 1, 1, 2)
mMat &lt;- cbind(mu1, mu2, mu3)
dimnames(mMat)[[1]] &lt;- dvec
pM &lt;- powerMM(muMat = mMat, doses = dvec, sigma = 2, lower = 10,
              upper = 100, step = 20)         
pM

## End(Not run)
</code></pre>

<hr>
<h2 id='quadratic'> Quadratic model </h2><span id='topic+quadratic'></span>

<h3>Description</h3>

<p>The model function for the quadratic model is defined as
</p>
<p style="text-align: center;"><code class="reqn">
  f(d,\theta)=E_0+\beta_1d+\beta_2d^2</code>
</p>



<h3>Usage</h3>

<pre><code class='language-R'>quadratic(dose, e0, b1, b2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="quadratic_+3A_dose">dose</code></td>
<td>
<p> Dose variable </p>
</td></tr>
<tr><td><code id="quadratic_+3A_e0">e0</code></td>
<td>
<p> Placebo effect </p>
</td></tr>
<tr><td><code id="quadratic_+3A_b1">b1</code></td>
<td>
<p> beta1 parameter </p>
</td></tr>
<tr><td><code id="quadratic_+3A_b2">b2</code></td>
<td>
<p> beta2 parameter (controls, whether model is convex or concave) </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This model is intended to capture a possible non-monotonic
dose-response relationship.
</p>


<h3>Value</h3>

<p>Response value
</p>


<h3>References</h3>

 
<p>Pinheiro, J. C., Bretz, F. and Branson, M. (2006). Analysis of dose-response studies - modeling 
approaches, <em>in</em> N. Ting (ed.). <em>Dose Finding in Drug Development</em>, Springer, New York,
pp. 146&ndash;171
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+logistic">logistic</a></code>, <code><a href="#topic+sigEmax">sigEmax</a></code>, 
<code><a href="#topic+linlog">linlog</a></code>, <code><a href="#topic+linear">linear</a></code>, <code><a href="#topic+exponential">exponential</a></code>,
<code><a href="#topic+emax">emax</a></code>,  <code><a href="#topic+betaMod">betaMod</a></code>
</p>

<hr>
<h2 id='sampSize'> Sample size calculations for MCPMod </h2><span id='topic+sampSize'></span><span id='topic+print.sampSize'></span>

<h3>Description</h3>

<p>Given a candidate set, the baseline effect, the maximum effect and
the standard deviation, the <code>sampSize</code> function returns the smallest sample size
achieving a certain combined power value. See Pinheiro et al. (2006) for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sampSize(models, doses, base, maxEff, sigma, upperN,
         lowerN = floor(upperN/2), power = 0.8, alRatio = NULL,
         sumFct = mean, off = 0.1*max(doses), scal = 1.2 * max(doses),
         alpha = 0.025, twoSide = FALSE, tol = 0.001, verbose = FALSE,
         control = mvtnorm.control(), muMat = NULL,
         typeN = c("arm", "total"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sampSize_+3A_models">models</code></td>
<td>
<p> A list specifying the candidate models. This
can also be a fullMod object, then the arguments <code>base</code>, 
<code>maxEff</code>, <code>off</code> and <code>scal</code> are ignored </p>
</td></tr>
<tr><td><code id="sampSize_+3A_doses">doses</code></td>
<td>
<p> Dose levels to be administered </p>
</td></tr>
<tr><td><code id="sampSize_+3A_base">base</code></td>
<td>
<p> Expected baseline effect </p>
</td></tr>
<tr><td><code id="sampSize_+3A_maxeff">maxEff</code></td>
<td>
<p> Expected maximum change from baseline </p>
</td></tr>
<tr><td><code id="sampSize_+3A_sigma">sigma</code></td>
<td>
<p> Expected standard deviation </p>
</td></tr>
<tr><td><code id="sampSize_+3A_uppern">upperN</code>, <code id="sampSize_+3A_lowern">lowerN</code></td>
<td>
<p> Upper and lower bound for the target sample size. <code>lowerN</code> defaults to
<code>floor(upperN/2)</code>. </p>
</td></tr>
<tr><td><code id="sampSize_+3A_power">power</code></td>
<td>
<p> Desired combined power value, defaults to 0.8. </p>
</td></tr>
<tr><td><code id="sampSize_+3A_alratio">alRatio</code></td>
<td>
<p> Vector describing the relative patient allocations to the dose
groups. See Examples below. </p>
</td></tr>
<tr><td><code id="sampSize_+3A_sumfct">sumFct</code></td>
<td>
<p> A function to combine the power values under the
different models into one value. By default the
arthmetic mean is used. </p>
</td></tr>
<tr><td><code id="sampSize_+3A_off">off</code></td>
<td>
<p> Offset parameter for the linear in log model (default 10 perc. of maximum dose). </p>
</td></tr>
<tr><td><code id="sampSize_+3A_scal">scal</code></td>
<td>
<p> Scale parameter for the beta model (default 20 perc. larger than maximum dose).</p>
</td></tr>
<tr><td><code id="sampSize_+3A_alpha">alpha</code></td>
<td>
<p> Level of significance (default: 0.025)</p>
</td></tr>
<tr><td><code id="sampSize_+3A_twoside">twoSide</code></td>
<td>
<p> Logical indicating whether a two sided or a one-sided
test is performed. By default FALSE, so one-sided testing. </p>
</td></tr>
<tr><td><code id="sampSize_+3A_tol">tol</code></td>
<td>
<p> A positive numeric value specifying the tolerance level for the bisection search algorithm. </p>
</td></tr>
<tr><td><code id="sampSize_+3A_verbose">verbose</code></td>
<td>
<p> Logical value indicating if a trace of the iteration progress of
the bisection search algorithm should be displayed. </p>
</td></tr>
<tr><td><code id="sampSize_+3A_control">control</code></td>
<td>
<p> A list of options for the <code>pmvt</code> and <code>qmvt</code> functions
as produced by <code>mvtnorm.control</code> </p>
</td></tr>
<tr><td><code id="sampSize_+3A_mumat">muMat</code></td>
<td>
<p> An optional matrix with means as columns and given dimnames 
(dose levels and names of contrasts). If specified the
the <code>models</code> argument should not be specified, see examples
below. </p>
</td></tr>
<tr><td><code id="sampSize_+3A_typen">typeN</code></td>
<td>
<p> One of &quot;arm&quot; or &quot;total&quot;. Determines, whether the sample size in the
smallest arm or the total sample size is iterated in bisection
search algorithm. See examples below. </p>
</td></tr>
<tr><td><code id="sampSize_+3A_...">...</code></td>
<td>
<p> Possible additional arguments for <code>sumFct</code>  </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculates the sample size necessary to achieve a desired combined power value 
for the multiple contrast test. A summary function is used to combine 
the individual power values. The allocation ratios for the dose groups need to be
predefined and fixed (by default balanced allocations are assumed).<br />
</p>
<p>The function implements a simple bisection search algorithm to determine the target sample size. In case the upper and
lower bound (<code>upperN</code>, <code>lowerN</code>) do not contain the target sample size the algorithm automatically
adjusts these boundaries, but outputs a warning message. 
</p>


<h3>Value</h3>

<p>An object of class sampSize, with the following components: 
</p>
<table>
<tr><td><code>samp.size</code></td>
<td>
<p>Vector of target sample size(s)</p>
</td></tr>
<tr><td><code>approx.power</code></td>
<td>
<p>Combined Power achieved under the assumed scenario and sample size.</p>
</td></tr>
</table>


<h3>References</h3>

 
<p>Bornkamp B., Pinheiro J. C., and Bretz, F. (2009). MCPMod: An            
R Package for the Design and Analysis of Dose-Finding        
Studies, <em>Journal of Statistical Software</em>, <b>29</b>(7), 1&ndash;23
</p>
<p>Pinheiro, J. C., Bornkamp, B., and Bretz, F. (2006). Design and analysis of dose finding studies
combining multiple comparisons and modeling procedures, <em>Journal of Biopharmaceutical
Statistics</em>, <b>16</b>, 639&ndash;656
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+powCalc">powCalc</a></code>, <code><a href="#topic+powerMM">powerMM</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# example from JBS paper p.651
doses &lt;- c(0,10,25,50,100,150)                                         
models &lt;- list(linear = NULL, emax = c(25),                            
               logistic = c(50, 10.88111), exponential=c(85),          
               betaMod=matrix(c(0.33,2.31,1.39,1.39), byrow=TRUE, nrow=2))
sampSize(models, doses, base = 0, maxEff = 0.4, sigma = 1,             
         upperN = 80, scal = 200, alpha = 0.05)
# with different summary function

sampSize(models, doses, base = 0, maxEff = 0.4, sigma = 1,             
         upperN = 90, scal = 200, sumFct = median, alpha = 0.05)

# with unbalanced allocations (twice as many patients in placebo group
# than in active dose groups)
sampSize(models, doses, base = 0, maxEff = 0.4, sigma = 1,            
       alpha = 0.05, upperN = 80, scal = 200, alRatio=c(2,1,1,1,1,1))
# iterates total sample size instead of sample size in smallest arm
# in this case no big difference
sampSize(models, doses, base = 0, maxEff = 0.4, sigma = 1,
         alpha = 0.05, upperN = 500, scal = 200, typeN = "total",
         alRatio=c(2,1,1,1,1,1))


# sample size calculation for general matrix of means
dvec &lt;- c(0, 10, 50, 100)                             
mu1 &lt;- c(1, 2, 2, 2)                                  
mu2 &lt;- c(1, 1, 2, 2)                                  
mu3 &lt;- c(1, 1, 1, 2)                                  
mMat &lt;- cbind(mu1, mu2, mu3)                          
dimnames(mMat)[[1]] &lt;- dvec                           
sampSize(muMat = mMat, doses = dvec, sigma = 1,       
       alpha = 0.05, upperN = 10, alRatio=c(2,2,1,1))

## End(Not run)
</code></pre>

<hr>
<h2 id='sigEmax'> Sigmoid Emax Model </h2><span id='topic+sigEmax'></span>

<h3>Description</h3>

<p>The model function for the sigmoid Emax model is defined as
</p>
<p style="text-align: center;"><code class="reqn">
  f(d,\theta)=E_0+E_{max}\frac{d^h}{ED^h_{50}+d^h}</code>
</p>



<h3>Usage</h3>

<pre><code class='language-R'>sigEmax(dose, e0, eMax, ed50, h)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sigEmax_+3A_dose">dose</code></td>
<td>
<p> Dose variable </p>
</td></tr>
<tr><td><code id="sigEmax_+3A_e0">e0</code></td>
<td>
<p> Placebo effect </p>
</td></tr>
<tr><td><code id="sigEmax_+3A_emax">eMax</code></td>
<td>
<p> Asymptotic maximum change from placebo effect </p>
</td></tr>
<tr><td><code id="sigEmax_+3A_ed50">ed50</code></td>
<td>
<p> Dose giving half of the asymptotic maximum effect </p>
</td></tr>
<tr><td><code id="sigEmax_+3A_h">h</code></td>
<td>
<p> Hill parameter, determining the steepness of the model at the ED50 </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The sigmoid Emax model is an extension of the (hyperbolic) Emax model by introducing an
additional parameter h, that determines the steepness of the curve
at the ed50 value. The sigmoid Emax model describes monotonic, sigmoid dose-response
relationships.
</p>


<h3>Value</h3>

<p>Response value
</p>


<h3>References</h3>

 
<p>MacDougall, J. (2006). Analysis of dose-response studies - Emax model,<em>in</em> N. Ting (ed.),
<em>Dose Finding in Drug Development</em>, Springer, New York, pp. 127&ndash;145
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+emax">emax</a></code>, <code><a href="#topic+logistic">logistic</a></code>, <code><a href="#topic+betaMod">betaMod</a></code>, 
<code><a href="#topic+linlog">linlog</a></code>, <code><a href="#topic+linear">linear</a></code>, <code><a href="#topic+quadratic">quadratic</a></code>,
<code><a href="#topic+exponential">exponential</a></code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
