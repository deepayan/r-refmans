<!DOCTYPE html><html><head><title>Help for package stratastats</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {stratastats}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#stratastats'><p>Stratified Analysis of 2x2 Contingency Tables</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Stratified Analysis of 2x2 Contingency Tables</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2</td>
</tr>
<tr>
<td>Description:</td>
<td>Offers a comprehensive approach for analysing stratified 2x2 contingency tables. It facilitates the calculation of odds ratios, 95% confidence intervals, and conducts chi-squared, Cochran-Mantel-Haenszel, Mantel-Haenszel, and Breslow-Day-Tarone tests. The package is particularly useful in fields like epidemiology and social sciences where stratified analysis is essential. The package also provides interpretative insights into the results, aiding in the understanding of statistical outcomes.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>abind (&ge; 1.4.0), gt (&ge; 0.8.0), stats (&ge; 4.0.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-08 10:12:51 UTC; gianmarcoalberti</td>
</tr>
<tr>
<td>Author:</td>
<td>Gianmarco Alberti [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Gianmarco Alberti &lt;gianmarcoalberti@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-08 14:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='stratastats'>Stratified Analysis of 2x2 Contingency Tables</h2><span id='topic+stratastats'></span>

<h3>Description</h3>

<p>This function performs a comprehensive stratified analysis of 2x2 contingency tables. It calculates odds ratios,
95 percent confidence intervals, conducts chi-squared tests, Cochran-Mantel-Haenszel tests for conditional
independence, Mantel-Haenszel and Breslow-Day-Tarone tests for homogeneity of odds ratios across strata.
Additionally, it produces a nicely-formatted table using the <code><a href="gt.html#topic+gt">gt</a></code> package, which includes both the results
and their interpretation, facilitating easier understanding and presentation of the analysis. The function is designed
to work with either a list of 2x2 tables or a 3-dimensional array representing stratified tables.<br />
Visit this <a href="https://drive.google.com/file/d/1ofS6COi6RFzNm-0K5-uZqeRQN4gu0T-i/view?usp=sharing">LINK</a> to access
the package's vignette.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stratastats(
  input.data,
  variable.names = c("Var1", "Var2"),
  stratifying.variable.name = "Var3",
  flip.or = FALSE,
  table.font.size = 13,
  source.note.font.size = 11
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stratastats_+3A_input.data">input.data</code></td>
<td>
<p>A list of 2x2 contingency tables or a 3-dimensional array where each 2x2 slice along the third
dimension represents a stratum.</p>
</td></tr>
<tr><td><code id="stratastats_+3A_variable.names">variable.names</code></td>
<td>
<p>A character vector containing the names of the two variables being cross-tabulated. Default is &quot;Var1&quot; and &quot;Var2&quot;.
If not provided for a 3D array, they are extracted from the array's dimnames.</p>
</td></tr>
<tr><td><code id="stratastats_+3A_stratifying.variable.name">stratifying.variable.name</code></td>
<td>
<p>A character vector containing the name of the stratifying variable. Default is &quot;Var3&quot;.
If not provided for a 3D array, it is extracted from the array's dimnames.</p>
</td></tr>
<tr><td><code id="stratastats_+3A_flip.or">flip.or</code></td>
<td>
<p>Optional. Logical value indicating whether to flip the odds ratio (default is FALSE).
If TRUE, the reciprocal of the OR is calculated.</p>
</td></tr>
<tr><td><code id="stratastats_+3A_table.font.size">table.font.size</code></td>
<td>
<p>Optional. Font size for the output table (default is 13).</p>
</td></tr>
<tr><td><code id="stratastats_+3A_source.note.font.size">source.note.font.size</code></td>
<td>
<p>Optional. Font size for the source notes in the output table (default is 11).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function employs statistical techniques appropriate for stratified data analysis.
</p>
<p>The odds ratio for each stratum and the combined strata (marginal table) are calculated. Confidence intervals are
derived based on the standard error of the log odds ratio.
</p>
<p>Chi-squared tests are conducted for each table to assess the association between the variables at each level of the
stratifying variable.
</p>
<p>The Cochran-Mantel-Haenszel (CMH) test assesses the overall association while accounting for stratification.
</p>
<p>The Mantel-Haenszel (MH) test and the Breslow-Day-Tarone (BDT) test evaluate the homogeneity of odds ratios
across strata. The latter test uses the code implemented by Michael Hoehle (see References).<br />
</p>
<p>The output includes a detailed breakdown of the odds ratios, confidence intervals, and test statistics for each
stratum and the marginal table. It also presents combined results with annotations explaining the significance and
implications of the tests.
</p>
<p>Interpretational Scenarios:
</p>
<p>1. Significant CMH test with homogeneity (non-significant MH and BDT test): Indicates conditional dependence and
consistent association across strata. The common odds ratio is a reliable summary of the association.
</p>
<p>2. Significant CMH test with heterogeneity (significant MH and BDT test): Suggests conditional dependence and
varying strength or direction of association across strata (interaction), cautioning against a simple summary
of the association.
</p>
<p>3. Non-significant CMH test with homogeneity (non-significant MH and BDT test): Implies conditional independence and
consistent association across strata. The common odds ratio is a reliable summary of the association.
</p>
<p>4. Non-significant CMH test with heterogeneity (significant MH and BDT test): Since not all the conditional odds ratios are
in the same direction, the result of the CMH test might not be reliable. Evaluating the
stratum-specific chi-squared tests should be considered.
</p>
<p>Note that:
</p>
<p>(1) the interpretation guidelines provided by the function are suggested based on the statistical tests' outcomes
and should be further evaluated within the context of your study;
</p>
<p>(2) in case a table features a zero along any of the diagonals, the Haldane-Anscombe correction is applied
for the calculation of the odds ratios and to internally compute the weights used in the Mantel-Haenszel test
of homogeneity. The correction consists in adding 0.5 to every cell of the table.
The original data, on which all the other tests are based, remain unchanged.
</p>
<p>On the correction, see for example: Fleiss et al 2003; Pagano-Gauvreau 2018. See the latter also for the application
of the correction in the calculation of the weights used in the Mantel-Haenszel test.
</p>


<h3>Value</h3>

<p>A list containing the following elements:
</p>

<ul>
<li> <p><code>odds.ratios</code>: A data frame of odds ratios and their 95 percent confidence intervals for each stratum and the marginal table.
</p>
</li>
<li> <p><code>partial.chisq.result</code>: A character vector storing the result of the chi-squared test for each partial table.
</p>
</li>
<li> <p><code>marginal.chisq.result</code>: A character vector storing the result of the chi-squared test for the marginal table.
</p>
</li>
<li> <p><code>cmh.test.result</code>: Result of the Cochran-Mantel-Haenszel test, providing an overall measure of association
while accounting for stratification.
</p>
</li>
<li> <p><code>mh.test.result</code>: Result of the Mantel-Haenszel test, used to assess the homogeneity of the odds ratios
across strata.
</p>
</li>
<li> <p><code>bdt.test.result</code>: Result of the Breslow-Day-Tarone test, used to assess the homogeneity of the odds ratios
across strata.
</p>
</li></ul>



<h3>References</h3>

<p>Azen, R., &amp; Walker, C. M. (2021). Categorical data analysis for the behavioral and social sciences (2nd ed.).
New York: Routledge.
</p>
<p>Breslow, N. E., &amp; Day, N. E. (1980). Statistical methods in cancer research. Volume I -
The analysis of case-control studies. IARC Scientific Publications.
</p>
<p>Fleiss, J. L., Levin, B., &amp; Paik, M. C. 2003. Statistical Methods for Rates and Proportions (3rd ed.). Wiley.
</p>
<p>Hoehle, M. (2000). Breslow-Day-Tarone Test.
Retrieved from https://online.stat.psu.edu/onlinecourses/sites/stat504/files/lesson04/breslowday.test_.R
</p>
<p>Lachin, J. M. (2000). Biostatistical methods: The assessment of relative risks. Wiley.
</p>
<p>Pagano, M., &amp; Gauvreau, K. (2018). Principles of Biostatistics (2nd ed.). Chapman and Hall/CRC.
</p>
<p>Sheskin, D. J. (2011). Handbook of parametric and nonparametric statistical procedures (5th ed.). Chapman &amp; Hall/CRC
</p>


<h3>See Also</h3>

<p>Refer to <code><a href="stats.html#topic+chisq.test">chisq.test</a></code> for chi-squared tests, and to
<code><a href="stats.html#topic+mantelhaen.test">mantelhaen.test</a></code> for the Cochran-Mantel-Haenszel test.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# EXAMPLE 1
# Survival on the Titanic

# create three individual partial tables

table1 &lt;- matrix(c(118,5,61,139), byrow = TRUE, ncol=2)
table2 &lt;- matrix(c(146,12,25,94), byrow = TRUE, ncol=2)
table3 &lt;- matrix(c(418,110,75,106), byrow = TRUE, ncol=2)

# make a list

tables &lt;- list(table1, table2, table3)

# specify the variable names

varnames &lt;- c("Survival", "Gender")
stratvar &lt;- "Class"

# carry out the analysis
results &lt;- stratastats(input.data = tables, variable.names = varnames,
stratifying.variable.name = stratvar)


# EXAMPLE 2
# Smoking status and breathing test results (after Azen-Walker 2021)


table1 &lt;- matrix(c(577, 34, 682, 57), byrow = TRUE, ncol=2)
table2 &lt;- matrix(c(164,4,245,74), byrow = TRUE, ncol=2)

tables &lt;- list(table1, table2)

varnames &lt;- c("Smoking Status", "Breathing Test Result")
stratvar &lt;- "Age"

results &lt;-stratastats(input.data = tables, variable.names = varnames,
stratifying.variable.name = stratvar)

# EXAMPLE 3
# Admission to graduate school at Berkeley in 1973 (3-dimensional array).
# Since the array contains variables name and the name of the stratifying variable,
# all we need to feed into the function is the dataset name 'UCBAdmissions'. However,
# the name of the variables can be customised using either the 'variable.names'
# or 'stratifying.variable.name' # parameter, or both.

results &lt;- stratastats(input.data = UCBAdmissions)


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
