<!DOCTYPE html><html><head><title>Help for package birdscanR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {birdscanR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#addDayNightInfoPerEcho'><p>addDayNightInfoPerEcho</p></a></li>
<li><a href='#classAbbreviations'><p>Default class abbreviations table of the birdscanR package</p></a></li>
<li><a href='#computeMTR'><p>computeMTR</p></a></li>
<li><a href='#computeObservationTime'><p>computeObservationTime</p></a></li>
<li><a href='#convertTimeZone'><p>Converts timestamps from radar time zone to an user-defined time zone</p></a></li>
<li><a href='#createTimeBins'><p>createTimeBins</p></a></li>
<li><a href='#extractDbData'><p>Extract DB Data</p></a></li>
<li><a href='#filterData'><p>filterData</p></a></li>
<li><a href='#filterEchoData'><p>filterEchoData</p></a></li>
<li><a href='#filterProtocolData'><p>filterProtocolData</p></a></li>
<li><a href='#getCollectionTable'><p>Get BirdScan collection table</p></a></li>
<li><a href='#getEchoFeatures'><p>Get BirdScan echo features</p></a></li>
<li><a href='#getEchoValidationTable'><p>Get a BirdScan echo validation table</p></a></li>
<li><a href='#getManualVisibilityTable'><p>Get manual visibility table</p></a></li>
<li><a href='#getProtocolTable'><p>Get BirdScan protocol table</p></a></li>
<li><a href='#getRadarTable'><p>Get a BirdScan radar table</p></a></li>
<li><a href='#getRfClassification'><p>Get a BirdScan 'rfClassification' table</p></a></li>
<li><a href='#getSiteTable'><p>Get BirdScan site table</p></a></li>
<li><a href='#getTimeBinsTable'><p>Get BirdScan time bins table</p></a></li>
<li><a href='#getVisibilityTable'><p>Get BirdScan visibility table</p></a></li>
<li><a href='#loadManualBlindTimes'><p>loadManualBlindTimes</p></a></li>
<li><a href='#manualBlindTimes'><p>Example file on how to include manual blind times for your 'Birdscan MR1'</p>
database.</a></li>
<li><a href='#mergeVisibilityAndManualBlindTimes'><p>mergeVisibilityAndManualBlindTimes</p></a></li>
<li><a href='#plotExploration'><p>plotExploration</p></a></li>
<li><a href='#plotLongitudinalMTR'><p>plotLongitudinalMTR</p></a></li>
<li><a href='#QUERY'><p>Query 'SQL' database</p></a></li>
<li><a href='#saveMTR'><p>saveMTR</p></a></li>
<li><a href='#savePlotToFile'><p>savePlotToFile</p></a></li>
<li><a href='#twilight'><p>Get the nautical, civil, and solar dawn and dusk for a given timerange</p>
and locations.</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>0.2.0</td>
</tr>
<tr>
<td>Title:</td>
<td>Migration Traffic Rate Calculation Package for 'Birdscan MR1'
Radars</td>
</tr>
<tr>
<td>Description:</td>
<td>Extract data from 'Birdscan MR1' 'SQL' vertical-looking radar databases, filter, and process them to Migration Traffic Rates (#objects per hour and km) of, for example birds, and insects. Object classifications in the 'Birdscan MR1' databases are based on the dataset of Haest et al. (2021) &lt;<a href="https://doi.org/10.5281%2Fzenodo.5734960">doi:10.5281/zenodo.5734960</a>&gt;). Migration Traffic Rates can be calculated separately for different height bins (with a height resolution of choice) as well as over time periods of choice (e.g., 1/2 hour, 1 hour, 1 day, day/night, the full time period of observation, and anything in between). Two plotting functions are also included to explore the data in the 'SQL' databases and the resulting Migration Traffic Rate results. For details on the Migration Traffic Rate calculation procedures, see Schmid et al. (2019) &lt;<a href="https://doi.org/10.1111%2Fecog.04025">doi:10.1111/ecog.04025</a>&gt;.</td>
</tr>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Language:</td>
<td>en-gb</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/BirdScanCommunity/birdscanR">https://github.com/BirdScanCommunity/birdscanR</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/BirdScanCommunity/birdscanR/issues">https://github.com/BirdScanCommunity/birdscanR/issues</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>DBI, dplyr, ggplot2, grDevices, magrittr, suntools, methods,
modi, reshape2, RODBC, RPostgreSQL, rstudioapi, sp, stats,
tibble, tidyr, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-10-06 08:26:07 UTC; bha</td>
</tr>
<tr>
<td>Author:</td>
<td>Birgen Haest <a href="https://orcid.org/0000-0002-8739-6460"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Fabian Hertner [aut],
  Baptiste Schmid [ctb],
  Damiano Preatoni [ctb],
  Johannes De Groeve [ctb],
  Felix Liechti [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Birgen Haest &lt;birgen.haest@vogelwarte.ch&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-10-06 08:40:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='addDayNightInfoPerEcho'>addDayNightInfoPerEcho</h2><span id='topic+addDayNightInfoPerEcho'></span>

<h3>Description</h3>

<p>The function ‘addDayNightInfoPerEcho’ adds three columns
‘dayOrNight’, &rdquo;dayOrCrepOrNight' and ‘dateSunset’ to the echo data. This
allows the user to filter echo data easily by “day” and “night”, or &quot;day&quot;,
&quot;crepuscular&quot;, and &quot;night&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>addDayNightInfoPerEcho(
  echoData,
  sunriseSunset,
  sunOrCivil = "civil",
  crepuscule = "nauticalSolar"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="addDayNightInfoPerEcho_+3A_echodata">echoData</code></td>
<td>
<p>dataframe with the echo data from the data list created by
the function ‘extractDBData’</p>
</td></tr>
<tr><td><code id="addDayNightInfoPerEcho_+3A_sunrisesunset">sunriseSunset</code></td>
<td>
<p>dataframe with sunrise/sunset and civil twilight times
created by the function ‘twilight’</p>
</td></tr>
<tr><td><code id="addDayNightInfoPerEcho_+3A_sunorcivil">sunOrCivil</code></td>
<td>
<p>optional character variable, Set to “sun” to use
sunrise/sunset times or to “civil” to use civil twilight times to group echoes
into day/night. Default is &quot;civil&quot;.</p>
</td></tr>
<tr><td><code id="addDayNightInfoPerEcho_+3A_crepuscule">crepuscule</code></td>
<td>
<p>optional character variable, Set to “nauticalSolar” to use
the time between nautical dusk/dawn and sunrise/sunset times to define the
crepuscular period, or to &quot;nauticalCivil&quot; to use the time between nautical
and civil dusk/dawn to define the crepuscular period, or to &quot;civilSolar&quot; to use
the time between civil dusk/dawn and sunrise/sunset times to define the
crepuscular period. Default is &quot;nauticalSolar&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame with thre columns added, i.e. 'dayOrNight', 'dayOrCrepOrNight',
and 'dateSunset'.
</p>


<h3>Author(s)</h3>

<p>Fabian Hertner, <a href="mailto:fabian.hertner@swiss-birdradar.com">fabian.hertner@swiss-birdradar.com</a>;
Birgen Haest, <a href="mailto:birgen.haest@vogelwarte.ch">birgen.haest@vogelwarte.ch</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Set server, database, and other input settings for data extraction
# ===========================================================================
  dbServer       = "MACHINE\\SERVERNAME" # Set the name of your SQL server
  dbName         = "db_Name"               # Set the name of your database
  dbDriverChar   = "SQL Server"            # Set either "SQL Server" or "PostgreSQL"
  mainOutputDir  = file.path(".", "results")
  radarTimeZone  = "Etc/GMT0"
  targetTimeZone = "Etc/GMT0"
  listOfRfFeaturesToExtract = c(167, 168)
  siteLocation   = c(47.494427, 8.716432)
  sunOrCivil   = "civil"
 
# Get data
# ===========================================================================
  dbData = extractDbData(dbDriverChar                   = dbDriverChar,
                         dbServer                       = dbServer, 
                         dbName                         = dbName, 
                         saveDbToFile                   = TRUE,
                         dbDataDir                      = mainOutputDir,
                         radarTimeZone                  = radarTimeZone,
                         targetTimeZone                 = targetTimeZone,
                         listOfRfFeaturesToExtract      = listOfRfFeaturesToExtract,
                         siteLocation                   = siteLocation, 
                         sunOrCivil                   = sunOrCivil, 
                         crepuscule                     = "nauticalSolar")
                         
# Get sunrise/sunset information
# ===========================================================================
  sunrisesunset = twilight(timeRange = c("2021-01-15 00:00", 
                                         "2021-01-31 00:00"),
                           latLon    = siteLocation,
                           timeZone  = targetTimeZone)

# Add day/night info to echo data
# ===========================================================================
  echoData = addDayNightInfoPerEcho(echoData      = dbData$echoData,
                                    sunriseSunset = pulseLengthSelection, 
                                    sunOrCivil  = "civil")   

## End(Not run)

</code></pre>

<hr>
<h2 id='classAbbreviations'>Default class abbreviations table of the birdscanR package</h2><span id='topic+classAbbreviations'></span>

<h3>Description</h3>

<p>Table to allow for easy abbreviations of the standard classes of the Birdscan
MR1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(classAbbreviations)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>"data.frame"</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(classAbbreviations)
</code></pre>

<hr>
<h2 id='computeMTR'>computeMTR</h2><span id='topic+computeMTR'></span>

<h3>Description</h3>

<p>This function will estimate the Activity / Migration Traffic
Rates (MTR, expressed as #objects / km / hour) based on the observations in
your database.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>computeMTR(
  dbName,
  echoes,
  classSelection,
  altitudeRange,
  altitudeBinSize,
  timeRange,
  timeBinDuration_sec,
  timeZone,
  sunriseSunset,
  sunOrCivil = "civil",
  crepuscule = "nauticalSolar",
  protocolData,
  visibilityData,
  manualBlindTimes = NULL,
  saveBlindTimes = FALSE,
  blindTimesOutputDir = getwd(),
  blindTimeAsMtrZero = NULL,
  propObsTimeCutoff = 0,
  computePerDayNight = FALSE,
  computePerDayCrepusculeNight = FALSE,
  computeAltitudeDistribution = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="computeMTR_+3A_dbname">dbName</code></td>
<td>
<p>Character string, containing the name of the database you are
processing</p>
</td></tr>
<tr><td><code id="computeMTR_+3A_echoes">echoes</code></td>
<td>
<p>dataframe with the echo data from the data list created by the
function ‘extractDBData’ or a subset of it created by the function
‘filterEchoData’.</p>
</td></tr>
<tr><td><code id="computeMTR_+3A_classselection">classSelection</code></td>
<td>
<p>character string vector with all classes which should
be used to calculate the MTR. The MTR and number of Echoes will be calculated
for each class as well as for all classes together.</p>
</td></tr>
<tr><td><code id="computeMTR_+3A_altituderange">altitudeRange</code></td>
<td>
<p>numeric vector of length 2 with the start and end of the
altitude range in meter a.g.l.</p>
</td></tr>
<tr><td><code id="computeMTR_+3A_altitudebinsize">altitudeBinSize</code></td>
<td>
<p>numeric, size of the altitude bins in meter.</p>
</td></tr>
<tr><td><code id="computeMTR_+3A_timerange">timeRange</code></td>
<td>
<p>Character vector of length 2, with start and end of time
range, formatted as &quot;%Y-%m-%d %H:%M&quot;</p>
</td></tr>
<tr><td><code id="computeMTR_+3A_timebinduration_sec">timeBinDuration_sec</code></td>
<td>
<p>duration of timeBins in seconds (numeric). for
values &lt;= 0 a duration of 1 hour will be set</p>
</td></tr>
<tr><td><code id="computeMTR_+3A_timezone">timeZone</code></td>
<td>
<p>time zone in which the time bins should be created as string,
e.g. &quot;Etc/GMT0&quot;</p>
</td></tr>
<tr><td><code id="computeMTR_+3A_sunrisesunset">sunriseSunset</code></td>
<td>
<p>dataframe with sunrise/sunset, and civil and nautical
dawn/dusk. Computed with the function 'twilight'.</p>
</td></tr>
<tr><td><code id="computeMTR_+3A_sunorcivil">sunOrCivil</code></td>
<td>
<p>sunrise/sunset or civil dawn/dusk used to split day and
night. Supported values: &quot;sun&quot; or &quot;civil&quot;. Default: &quot;civil&quot;</p>
</td></tr>
<tr><td><code id="computeMTR_+3A_crepuscule">crepuscule</code></td>
<td>
<p>optional character variable, Set to “nauticalSolar” to use
the time between nautical dusk/dawn and sunrise/sunset times to define the
crepuscular period, or to &quot;nauticalCivil&quot; to use the time between nautical
and civil dusk/dawn to define the crepuscular period, or to &quot;civilSolar&quot; to use
the time between civil dusk/dawn and sunrise/sunset times to define the
crepuscular period. Default is &quot;nauticalSolar&quot;.</p>
</td></tr>
<tr><td><code id="computeMTR_+3A_protocoldata">protocolData</code></td>
<td>
<p>dataframe with the protocol data from the data list
created by the function <code>extractDBData</code> or a subset of it created by the
function <code>filterProtocolData</code>.</p>
</td></tr>
<tr><td><code id="computeMTR_+3A_visibilitydata">visibilityData</code></td>
<td>
<p>dataframe with the visibility data from the data list
created by the function ‘extractDBData’.</p>
</td></tr>
<tr><td><code id="computeMTR_+3A_manualblindtimes">manualBlindTimes</code></td>
<td>
<p>dataframe with the manual blind times created by the
function <code>loadManualBlindTimes</code>.</p>
</td></tr>
<tr><td><code id="computeMTR_+3A_saveblindtimes">saveBlindTimes</code></td>
<td>
<p>Logical, determines whether to save the blind times to
a file. Default: False.</p>
</td></tr>
<tr><td><code id="computeMTR_+3A_blindtimesoutputdir">blindTimesOutputDir</code></td>
<td>
<p>Character string containing the path to save the
blind times to. Default: 'your-working-directory'</p>
</td></tr>
<tr><td><code id="computeMTR_+3A_blindtimeasmtrzero">blindTimeAsMtrZero</code></td>
<td>
<p>character string vector with the blind time types
which should be treated as observation time with MTR zero.</p>
</td></tr>
<tr><td><code id="computeMTR_+3A_propobstimecutoff">propObsTimeCutoff</code></td>
<td>
<p>numeric between 0 and 1. If the MTR is computed per
day and night, time bins with a proportional observation time smaller than
propObsTimeCutoff are ignored when combining the time bins. If the MTR is
computed for each time bin, the parameter is ignored.</p>
</td></tr>
<tr><td><code id="computeMTR_+3A_computeperdaynight">computePerDayNight</code></td>
<td>
<p>logical, TRUE: MTR is computed per day and night.
The time bins of each day and night will be combined and the mean MTR is
computed for each day and night. The spread (first and third Quartile) for
each day and night are also computed. The spread is dependent on the chosen
time bin duration/amount of time bins; When FALSE: MTR is computed for each
time bin. This option computes the MTR for each time bin defined in the time
bin dataframe. The time bins that were split due to sunrise/sunset during the
time bin will be combined to one bin.</p>
</td></tr>
<tr><td><code id="computeMTR_+3A_computeperdaycrepusculenight">computePerDayCrepusculeNight</code></td>
<td>
<p>logical, TRUE: MTR is computed per
crepusculeMorning, day, crepusculeEvening, and night. The time bins of each
of these diel phases will be combined and the mean MTR is computed for each
phase. The spread (first and third Quartile) for each phase is also computed.
The spread is dependent on the chosen time bin duration/amount of time bins;
When FALSE: MTR is computed for each time bin. This option computes the MTR
for each time bin defined in the time bin dataframe. The time bins that were
split due to sunrise/sunset during the time bin will be combined to one bin.
Default = FALSE.</p>
</td></tr>
<tr><td><code id="computeMTR_+3A_computealtitudedistribution">computeAltitudeDistribution</code></td>
<td>
<p>logical, TRUE: compute the mean height and
altitude distribution of MTR for the pre-defined quantiles 0.05, 0.25, 0.5,
0.75, 0.95</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Migration Traffic Rates
</p>


<h3>Author(s)</h3>

<p>Fabian Hertner, <a href="mailto:fabian.hertner@swiss-birdradar.com">fabian.hertner@swiss-birdradar.com</a>;
Baptiste Schmid, <a href="mailto:baptiste.schmid@vogelwarte.ch">baptiste.schmid@vogelwarte.ch</a>;
Birgen Haest, <a href="mailto:birgen.haest@vogelwarte.ch">birgen.haest@vogelwarte.ch</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Set server, database, and other input settings
# ===========================================================================
  dbServer       = "MACHINE\\SERVERNAME"     # Set the name of your SQL server
  dbName         = "db_Name"                   # Set the name of your database
  dbDriverChar   = "SQL Server"                # Set either "SQL Server" or "PostgreSQL"
  mainOutputDir  = file.path(".", "results")
  radarTimeZone  = "Etc/GMT0"
  targetTimeZone = "Etc/GMT0"
  listOfRfFeaturesToExtract = c(167, 168)
  siteLocation   = c(47.494427, 8.716432)
  sunOrCivil     = "civil"
  crepuscule     = "nauticalSolar"
  timeRangeData  = c("2021-01-15 00:00", "2021-01-31 00:00")
 
# Get data
# ===========================================================================
  dbData = extractDbData(dbDriverChar                   = dbDriverChar,
                         dbServer                       = dbServer, 
                         dbName                         = dbName, 
                         saveDbToFile                   = TRUE,
                         dbDataDir                      = mainOutputDir,
                         radarTimeZone                  = radarTimeZone,
                         targetTimeZone                 = targetTimeZone,
                         listOfRfFeaturesToExtract      = listOfRfFeaturesToExtract,
                         siteLocation                   = siteLocation, 
                         sunOrCivil                     = sunOrCivil, 
                         crepuscule                     = crepuscule)
                         
# Get sunrise/sunset 
# ===========================================================================
  sunriseSunset = twilight(timeRange = timeRangeData,
                           latLon    = c(47.494427, 8.716432),
                           timeZone  = targetTimeZone)
                          
# Get manual blind times
# ===========================================================================
  data(manualBlindTimes)
  cManualBlindTimes = manualBlindTimes

# Compute migration traffic rate
# ===========================================================================
  classSelection.mtr = c("insect")
  mtrData = computeMTR(dbName                       = dbName, 
                       echoes                       = dbData$echoData, 
                       classSelection               = classSelection.mtr, 
                       altitudeRange                = c(25, 1025),
                       altitudeBinSize              = 50,
                       timeRange                    = timeRangeData, 
                       timeBinDuration_sec          = 1800,
                       timeZone                     = targetTimeZone,
                       sunriseSunset                = sunriseSunset,
                       sunOrCivil                   = "civil",
                       crepuscule                   = crepuscule,
                       protocolData                 = dbData$protocolData, 
                       visibilityData               = dbData$visibilityData,
                       manualBlindTimes             = cManualBlindTimes,
                       saveBlindTimes               = FALSE,
                       blindTimesOutputDir          = getwd(),
                       blindTimeAsMtrZero           = NULL,
                       propObsTimeCutoff            = 0, 
                       computePerDayNight           = FALSE,
                       computePerDayCrepusculeNight = FALSE 
                       computeAltitudeDistribution  = TRUE)   

## End(Not run)

</code></pre>

<hr>
<h2 id='computeObservationTime'>computeObservationTime</h2><span id='topic+computeObservationTime'></span>

<h3>Description</h3>

<p>Compute blind times and observation times during time bins based
on protocol data and blind times
</p>


<h3>Usage</h3>

<pre><code class='language-R'>computeObservationTime(
  timeBins,
  protocolData,
  blindTimes,
  blindTimeAsMtrZero = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="computeObservationTime_+3A_timebins">timeBins</code></td>
<td>
<p>dataframe with the time bins created by the function
<code>createTimeBins</code>.</p>
</td></tr>
<tr><td><code id="computeObservationTime_+3A_protocoldata">protocolData</code></td>
<td>
<p>dataframe with the protocol data from the data list
created by the function <code>extractDBData</code> or a subset of it created by the
function <code>filterProtocolData</code>.</p>
</td></tr>
<tr><td><code id="computeObservationTime_+3A_blindtimes">blindTimes</code></td>
<td>
<p>dataframe containing the blind times created by the
function <code>mergeVisibilityAndManualBlindTimes</code>.</p>
</td></tr>
<tr><td><code id="computeObservationTime_+3A_blindtimeasmtrzero">blindTimeAsMtrZero</code></td>
<td>
<p>character string vector with the blind time types
which should be treated as observation time with MTR zero.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns a dataframe with the time bins completed with the observation
times of each time bin.
</p>


<h3>Author(s)</h3>

<p>Fabian Hertner, <a href="mailto:fabian.hertner@swiss-birdradar.com">fabian.hertner@swiss-birdradar.com</a>;
Birgen Haest, <a href="mailto:birgen.haest@vogelwarte.ch">birgen.haest@vogelwarte.ch</a>
</p>

<hr>
<h2 id='convertTimeZone'>Converts timestamps from radar time zone to an user-defined time zone</h2><span id='topic+convertTimeZone'></span>

<h3>Description</h3>

<p>Converts timestamps from radar time zone to an user-defined time
zone
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convertTimeZone(
  data = NULL,
  colNames = "",
  originTZ = "Etc/GMT0",
  targetTZ = "Etc/GMT0"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="convertTimeZone_+3A_data">data</code></td>
<td>
<p>a data frame containing BirdScan data</p>
</td></tr>
<tr><td><code id="convertTimeZone_+3A_colnames">colNames</code></td>
<td>
<p>a character vector containing valid column names, as present
in <code>data</code></p>
</td></tr>
<tr><td><code id="convertTimeZone_+3A_origintz">originTZ</code></td>
<td>
<p>character, the time zone name of data to be converted
(default is &quot;etc/GMT0&quot;)</p>
</td></tr>
<tr><td><code id="convertTimeZone_+3A_targettz">targetTZ</code></td>
<td>
<p>character, the time zone name to convert data into
(default is &quot;etc/GMT0&quot;)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data frame identical to <code>data</code>, any columns declared in <code>colNames</code>
will have their name changed with a suffix (<code style="white-space: pre;">&#8288;_originTZ&#8288;</code> or <code style="white-space: pre;">&#8288;_targetTZ&#8288;</code>) added.
</p>


<h3>Author(s)</h3>

<p>Fabian Hertner, <a href="mailto:fabian.hertner@swiss-birdradar.com">fabian.hertner@swiss-birdradar.com</a>;
Birgen Haest, <a href="mailto:birgen.haest@vogelwarte.ch">birgen.haest@vogelwarte.ch</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Set server, database, and other input settings for data extraction
# ===========================================================================
  dbServer       = "MACHINE\\SERVERNAME"     # Set the name of your SQL server
  dbName         = "db_Name"                   # Set the name of your database
  dbDriverChar   = "SQL Server"                # Set either "SQL Server" or "PostgreSQL"
  mainOutputDir  = file.path(".", "results")
  radarTimeZone  = "Etc/GMT0"
  targetTimeZone = "Etc/GMT0"
  listOfRfFeaturesToExtract = c(167, 168)
  siteLocation   = c(47.494427, 8.716432)
  sunOrCivil     = "civil"
 
# Get data
# ===========================================================================
  dbData = extractDbData(dbDriverChar                   = dbDriverChar,
                         dbServer                       = dbServer, 
                         dbName                         = dbName, 
                         saveDbToFile                   = TRUE,
                         dbDataDir                      = mainOutputDir,
                         radarTimeZone                  = radarTimeZone,
                         targetTimeZone                 = targetTimeZone,
                         listOfRfFeaturesToExtract      = listOfRfFeaturesToExtract,
                         siteLocation                   = siteLocation, 
                         sunOrCivil                     = sunOrCivil)

# Add day/night info to echo data
# ===========================================================================
  echoData = convertTimeZone(data     = dbData$echoData, 
                             colNames = c("time_stamp"), 
                             originTZ = "Etc/GMT0", 
                             targetTZ = "Etc/GMT-2")   

## End(Not run)

</code></pre>

<hr>
<h2 id='createTimeBins'>createTimeBins</h2><span id='topic+createTimeBins'></span>

<h3>Description</h3>

<p>Create time bins with a given duration. Time bins expanding over
a day/night change will be split in two time bins.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>createTimeBins(
  timeRange,
  timeBinDuration_sec,
  timeZone,
  sunriseSunset,
  dnBins = TRUE,
  crepBins = FALSE,
  sunOrCivil = "civil",
  crepuscule = "nauticalSolar"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="createTimeBins_+3A_timerange">timeRange</code></td>
<td>
<p>vector of length 2, with start and end of time range as
POSIXct</p>
</td></tr>
<tr><td><code id="createTimeBins_+3A_timebinduration_sec">timeBinDuration_sec</code></td>
<td>
<p>duration of timeBins in seconds (numeric). for
values &lt;= 0 a duration of 1 hour will be set</p>
</td></tr>
<tr><td><code id="createTimeBins_+3A_timezone">timeZone</code></td>
<td>
<p>time zone in which the time bins should be created as string,
e.g. &quot;Etc/GMT0&quot;</p>
</td></tr>
<tr><td><code id="createTimeBins_+3A_sunrisesunset">sunriseSunset</code></td>
<td>
<p>dataframe with sunrise/sunset, civil dawn/dusk. computed
with function 'twilight'</p>
</td></tr>
<tr><td><code id="createTimeBins_+3A_dnbins">dnBins</code></td>
<td>
<p>Logical. Default TRUE. Determines whether timebins based on
day/night values (determined by the parameter 'sunOrCivil') are created.</p>
</td></tr>
<tr><td><code id="createTimeBins_+3A_crepbins">crepBins</code></td>
<td>
<p>Logical. Default FALSE. Determines whether timebins with
crepuscular time phases are created (determined by the parameter 'crepuscule').</p>
</td></tr>
<tr><td><code id="createTimeBins_+3A_sunorcivil">sunOrCivil</code></td>
<td>
<p>sunrise/sunset or civil dawn/dusk used to split day and
night. Supported values: &quot;sun&quot; or &quot;civil&quot;, default: &quot;civil&quot;</p>
</td></tr>
<tr><td><code id="createTimeBins_+3A_crepuscule">crepuscule</code></td>
<td>
<p>Used to split into crepusculeMorning, day, crepusculeEvening,
and night. Set to “nauticalSolar” to use the time between nautical dusk/dawn
and sunrise/sunset times to define the crepuscular period, or to
&quot;nauticalCivil&quot; to use the time between nautical and civil dusk/dawn to define
the crepuscular period, or to &quot;civilSolar&quot; to use the time between civil
dusk/dawn and sunrise/sunset times to define the crepuscular period. Default
is &quot;nauticalSolar&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns a dataframe with the time bins information
</p>


<h3>Author(s)</h3>

<p>Fabian Hertner, <a href="mailto:fabian.hertner@swiss-birdradar.com">fabian.hertner@swiss-birdradar.com</a>;
Birgen Haest, <a href="mailto:birgen.haest@vogelwarte.ch">birgen.haest@vogelwarte.ch</a>
</p>

<hr>
<h2 id='extractDbData'>Extract DB Data</h2><span id='topic+extractDbData'></span>

<h3>Description</h3>

<p>Load the data from the database or file and save it to file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extractDbData(
  dbDriverChar = "SQL Server",
  dbServer = NULL,
  dbName = NULL,
  dbUser = NULL,
  dbPwd = NULL,
  saveDbToFile = FALSE,
  dbDataDir = NULL,
  radarTimeZone = NULL,
  targetTimeZone = "Etc/GMT0",
  listOfRfFeaturesToExtract = NULL,
  siteLocation = NULL,
  sunOrCivil = "civil",
  crepuscule = "nauticalSolar"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extractDbData_+3A_dbdriverchar">dbDriverChar</code></td>
<td>
<p>'SQL Server' The name of the driver. Should be either
'SQL Server' or 'PostgreSQL'. If 'PostgreSQL', it connects to
cloud.birdradar.com</p>
</td></tr>
<tr><td><code id="extractDbData_+3A_dbserver">dbServer</code></td>
<td>
<p>NULL The name of the Server</p>
</td></tr>
<tr><td><code id="extractDbData_+3A_dbname">dbName</code></td>
<td>
<p>NULL The name of the Database</p>
</td></tr>
<tr><td><code id="extractDbData_+3A_dbuser">dbUser</code></td>
<td>
<p>NULL The USER name of the Server</p>
</td></tr>
<tr><td><code id="extractDbData_+3A_dbpwd">dbPwd</code></td>
<td>
<p>NULL The password for the user name</p>
</td></tr>
<tr><td><code id="extractDbData_+3A_savedbtofile">saveDbToFile</code></td>
<td>
<p>FALSE Set to TRUE if you want to save the extracted
database data to an rds file. The output filename is automatically set to
dbName_DataExtract.rds</p>
</td></tr>
<tr><td><code id="extractDbData_+3A_dbdatadir">dbDataDir</code></td>
<td>
<p>NULL The path to the output directory where to store the
extracted dataset. If the directory does not exist, it will be created.</p>
</td></tr>
<tr><td><code id="extractDbData_+3A_radartimezone">radarTimeZone</code></td>
<td>
<p>NULL String specifying the radar time zone. Default is
NULL: extract the time zone from the site table of the 'SQL' database.</p>
</td></tr>
<tr><td><code id="extractDbData_+3A_targettimezone">targetTimeZone</code></td>
<td>
<p>&quot;Etc/GMT0&quot; String specifying the target time zone.
Default is &quot;Etc/GMT0&quot;.</p>
</td></tr>
<tr><td><code id="extractDbData_+3A_listofrffeaturestoextract">listOfRfFeaturesToExtract</code></td>
<td>
<p>NULL or a list of feature to extract</p>
</td></tr>
<tr><td><code id="extractDbData_+3A_sitelocation">siteLocation</code></td>
<td>
<p>Geographic location of the radar measurements in decimal
format: c(Latitude, Longitude)</p>
</td></tr>
<tr><td><code id="extractDbData_+3A_sunorcivil">sunOrCivil</code></td>
<td>
<p>optional character variable, Set to “sun” to use
sunrise/sunset times or to “civil” to use civil twilight times to group echoes
into day/night. Default is &quot;civil&quot;.</p>
</td></tr>
<tr><td><code id="extractDbData_+3A_crepuscule">crepuscule</code></td>
<td>
<p>optional character variable, Set to “nauticalSolar” to use
the time between nautical dusk/dawn and sunrise/sunset times to define the
crepuscular period, or to &quot;nauticalCivil&quot; to use the time between nautical
and civil dusk/dawn to define the crepuscular period, or to &quot;civilSolar&quot; to use
the time between civil dusk/dawn and sunrise/sunset times to define the
crepuscular period. Default is &quot;nauticalSolar&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of R objects with data extracted from the Database: 'echoData',
'protocolData', 'siteData', 'visibilityData', 'timeBinData', 'rfFeatures',
'availableClasses', 'classProbabilitiesAndMtrFactors'
</p>


<h3>Author(s)</h3>

<p>Fabian Hertner, <a href="mailto:fabian.hertner@swiss-birdradar.com">fabian.hertner@swiss-birdradar.com</a>;
Birgen Haest, <a href="mailto:birgen.haest@vogelwarte.ch">birgen.haest@vogelwarte.ch</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Set server, database, and other input settings
# ===========================================================================
  dbServer       = "MACHINE\\SERVERNAME"     # Set the name of your SQL server
  dbName         = "db_Name"                   # Set the name of your database
  dbDriverChar   = "SQL Server"                # Set either "SQL Server" or "PostgreSQL"
  mainOutputDir  = file.path(".", "results")
  radarTimeZone  = "Etc/GMT0"
  targetTimeZone = "Etc/GMT0"
  listOfRfFeaturesToExtract = c(167, 168)
  siteLocation   = c(47.494427, 8.716432)
  sunOrCivil   = "civil"
 
# Get data
# ===========================================================================
  dbData = extractDbData(dbDriverChar                   = dbDriverChar,
                         dbServer                       = dbServer, 
                         dbName                         = dbName, 
                         saveDbToFile                   = TRUE,
                         dbDataDir                      = mainOutputDir,
                         radarTimeZone                  = radarTimeZone,
                         targetTimeZone                 = targetTimeZone,
                         listOfRfFeaturesToExtract      = listOfRfFeaturesToExtract,
                         siteLocation                   = siteLocation, 
                         sunOrCivil                   = sunOrCivil,
                         crepuscule                     = "nauticalSolar")

## End(Not run)

</code></pre>

<hr>
<h2 id='filterData'>filterData</h2><span id='topic+filterData'></span>

<h3>Description</h3>

<p>With the function <code>filterData</code> both the echo and protocol data can be filtered by several parameters. The function returns the filtered echo and protocol data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>filterData(
  echoData = NULL,
  protocolData = NULL,
  pulseTypeSelection = NULL,
  rotationSelection = NULL,
  timeRangeTargetTZ = NULL,
  targetTimeZone = "Etc/GMT0",
  classSelection = NULL,
  classProbCutOff = NULL,
  altitudeRange_AGL = NULL,
  manualBlindTimes = NULL,
  echoValidator = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="filterData_+3A_echodata">echoData</code></td>
<td>
<p>dataframe with the echo data from the data list created by the function <code>extractDBData</code>.</p>
</td></tr>
<tr><td><code id="filterData_+3A_protocoldata">protocolData</code></td>
<td>
<p>dataframe with the protocol data from the data list created by the function <code>extractDBData</code> or a subset of it created by the function <code>filterProtocolData</code>. Echoes not detected during the listed protocols will be excluded.</p>
</td></tr>
<tr><td><code id="filterData_+3A_pulsetypeselection">pulseTypeSelection</code></td>
<td>
<p>character vector with the pulse types which should be included in the subset. Options: “S”, “M”, “L” (short-, medium-, long-pulse). Default is NULL: no filtering applied based on pulseType.</p>
</td></tr>
<tr><td><code id="filterData_+3A_rotationselection">rotationSelection</code></td>
<td>
<p>numeric vector to select the operation modes with and/or without antenna rotation. Options: 0, 1. (0 = no rotation, 1 = rotation). Default is NULL: no filtering applied based on rotation mode.</p>
</td></tr>
<tr><td><code id="filterData_+3A_timerangetargettz">timeRangeTargetTZ</code></td>
<td>
<p>Character vector of length 2, with start and end of
time range, formatted as &quot;%Y-%m-%d %H:%M&quot;. Echoes outside the time range will
be excluded.</p>
</td></tr>
<tr><td><code id="filterData_+3A_targettimezone">targetTimeZone</code></td>
<td>
<p>&quot;Etc/GMT0&quot; String specifying the target time zone.
Default is &quot;Etc/GMT0&quot;.</p>
</td></tr>
<tr><td><code id="filterData_+3A_classselection">classSelection</code></td>
<td>
<p>character string vector with the classes that should be
included.</p>
</td></tr>
<tr><td><code id="filterData_+3A_classprobcutoff">classProbCutOff</code></td>
<td>
<p>numeric cutoff value for class probabilities. Echoes
with a lower class probability will be excluded.</p>
</td></tr>
<tr><td><code id="filterData_+3A_altituderange_agl">altitudeRange_AGL</code></td>
<td>
<p>numeric vector of length 2 with start and end of the
altitude range. Echoes outside the altitude range will be excluded.</p>
</td></tr>
<tr><td><code id="filterData_+3A_manualblindtimes">manualBlindTimes</code></td>
<td>
<p>dataframe with the manual blind times created by the
function <code>loadManualBlindTimes</code>.</p>
</td></tr>
<tr><td><code id="filterData_+3A_echovalidator">echoValidator</code></td>
<td>
<p>logical, if set to TRUE, echoes labelled by the echo
validator as “non-bio scatterer” will be excluded. If set to FALSE, all
echoes are included.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns the filtered echo and protocol data in the same format as
provided in the parameters <code>echoData</code> and <code>protocolData</code>.
</p>


<h3>Author(s)</h3>

<p>Birgen Haest, <a href="mailto:birgen.haest@vogelwarte.ch">birgen.haest@vogelwarte.ch</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Set server, database, and other input settings for data extraction
# ===========================================================================
  dbServer       = "MACHINE\\SERVERNAME"     # Set the name of your SQL server
  dbName         = "db_Name"                   # Set the name of your database
  dbDriverChar   = "SQL Server"                # Set either "SQL Server" or "PostgreSQL"
  mainOutputDir  = file.path(".", "results")
  radarTimeZone  = "Etc/GMT0"
  targetTimeZone = "Etc/GMT0"
  listOfRfFeaturesToExtract = c(167, 168)
  siteLocation   = c(47.494427, 8.716432)
  sunOrCivil     = "civil"
 
# Get data
# ===========================================================================
  dbData = extractDbData(dbDriverChar                   = dbDriverChar,
                         dbServer                       = dbServer, 
                         dbName                         = dbName, 
                         saveDbToFile                   = TRUE,
                         dbDataDir                      = mainOutputDir,
                         radarTimeZone                  = radarTimeZone,
                         targetTimeZone                 = targetTimeZone,
                         listOfRfFeaturesToExtract      = listOfRfFeaturesToExtract,
                         siteLocation                   = siteLocation, 
                         sunOrCivil                     = sunOrCivil)
                         
# Set input settings for filtering of the data
# ===========================================================================
  pulseLengthSelection = "S"
  rotationSelection    = 1
  timeRangeData        = c("2021-01-15 00:00", "2021-01-31 00:00")
  classSelection       = c("passerine_type", "wader_type", "swift_type", 
                           "large_bird", "unid_bird", "bird_flock")
  classProbCutoff      = NULL
  altitudeRange        = c(50, 1000)
  data(manualBlindTimes)
  cManualBlindTimes    = manualBlindTimes
  useEchoValidator     = FALSE

# Filter the data
# ===========================================================================
  filteredData = filterData(echoData           = dbData$echoData,
                            protocolData       = dbData$protocolData, 
                            pulseTypeSelection = pulseLengthSelection, 
                            rotationSelection  = rotationSelection,
                            timeRangeTargetTZ  = timeRangeData,
                            targetTimeZone     = targetTimeZone,
                            classSelection     = classSelection, 
                            classProbCutOff    = classProbCutoff, 
                            altitudeRange_AGL  = altitudeRange, 
                            manualBlindTimes   = cManualBlindTimes, 
                            echoValidator      = useEchoValidator)   

## End(Not run)

</code></pre>

<hr>
<h2 id='filterEchoData'>filterEchoData</h2><span id='topic+filterEchoData'></span>

<h3>Description</h3>

<p>With the function <code>filterEchoData</code> the echo data can be
filtered by several parameters. The function returns the filtered echo data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>filterEchoData(
  echoData = NULL,
  timeRangeTargetTZ = NULL,
  targetTimeZone = "Etc/GMT0",
  protocolData = NULL,
  classSelection = NULL,
  classProbCutOff = NULL,
  altitudeRange_AGL = NULL,
  manualBlindTimes = NULL,
  echoValidator = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="filterEchoData_+3A_echodata">echoData</code></td>
<td>
<p>dataframe with the echo data from the data list created by
the function <code>extractDBData</code>.</p>
</td></tr>
<tr><td><code id="filterEchoData_+3A_timerangetargettz">timeRangeTargetTZ</code></td>
<td>
<p>Character vector of length 2, with start and end of
time range, formatted as &quot;%Y-%m-%d %H:%M&quot;. Echoes outside the time range will
be excluded.</p>
</td></tr>
<tr><td><code id="filterEchoData_+3A_targettimezone">targetTimeZone</code></td>
<td>
<p>&quot;Etc/GMT0&quot; String specifying the target time zone.
Default is &quot;Etc/GMT0&quot;.</p>
</td></tr>
<tr><td><code id="filterEchoData_+3A_protocoldata">protocolData</code></td>
<td>
<p>dataframe with the protocol data from the data list
created by the function <code>extractDBData</code> or a subset of it created by
the function <code>filterProtocolData</code>. Echoes not detected during the listed
protocols will be excluded.</p>
</td></tr>
<tr><td><code id="filterEchoData_+3A_classselection">classSelection</code></td>
<td>
<p>character string vector with the classes that should
be included.</p>
</td></tr>
<tr><td><code id="filterEchoData_+3A_classprobcutoff">classProbCutOff</code></td>
<td>
<p>numeric cutoff value for class probabilities. Echoes
with a lower class probability will be excluded.</p>
</td></tr>
<tr><td><code id="filterEchoData_+3A_altituderange_agl">altitudeRange_AGL</code></td>
<td>
<p>numeric vector of length 2 with start and end of the
altitude range. Echoes outside the altitude range will be excluded.</p>
</td></tr>
<tr><td><code id="filterEchoData_+3A_manualblindtimes">manualBlindTimes</code></td>
<td>
<p>dataframe with the manual blind times created by the
function <code>loadManualBlindTimes</code>.</p>
</td></tr>
<tr><td><code id="filterEchoData_+3A_echovalidator">echoValidator</code></td>
<td>
<p>logical, if set to TRUE, echoes labelled by the echo
validator as “non-bio scatterer” will be excluded. If set to FALSE, all
echoes are included.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns the filtered echo data in the same format as provided in the
parameter <code>echoData</code>.
</p>


<h3>Author(s)</h3>

<p>Fabian Hertner, <a href="mailto:fabian.hertner@swiss-birdradar.com">fabian.hertner@swiss-birdradar.com</a>;
Birgen Haest, <a href="mailto:birgen.haest@vogelwarte.ch">birgen.haest@vogelwarte.ch</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Set server, database, and other input settings for data extraction
# ===========================================================================
  dbServer       = "MACHINE\\SERVERNAME"     # Set the name of your SQL server
  dbName         = "db_Name"                   # Set the name of your database
  dbDriverChar   = "SQL Server"                # Set either "SQL Server" or "PostgreSQL"
  mainOutputDir  = file.path(".", "results")
  radarTimeZone  = "Etc/GMT0"
  targetTimeZone = "Etc/GMT0"
  listOfRfFeaturesToExtract = c(167, 168)
  siteLocation   = c(47.494427, 8.716432)
  sunOrCivil     = "civil"
 
# Get data
# ===========================================================================
  dbData = extractDbData(dbDriverChar                   = dbDriverChar,
                         dbServer                       = dbServer, 
                         dbName                         = dbName, 
                         saveDbToFile                   = TRUE,
                         dbDataDir                      = mainOutputDir,
                         radarTimeZone                  = radarTimeZone,
                         targetTimeZone                 = targetTimeZone,
                         listOfRfFeaturesToExtract      = listOfRfFeaturesToExtract,
                         siteLocation                   = siteLocation, 
                         sunOrCivil                     = sunOrCivil)
                         
# Set input settings for filtering of the data
# ===========================================================================
  timeRangeData     = c("2021-01-15 00:00", "2021-01-31 00:00")
  classSelection    = c("passerine_type", "wader_type", "swift_type", 
                        "large_bird", "unid_bird", "bird_flock")
  classProbCutoff   = NULL
  altitudeRange     = c(50, 1000)
  data(manualBlindTimes)
  cManualBlindTimes = manualBlindTimes
  useEchoValidator  = FALSE

# Filter the echo data
# ===========================================================================
  filteredEchoData = filterEchoData(echoData           = dbData$echoData,
                                    timeRangeTargetTZ  = timeRangeData,
                                    targetTimeZone     = targetTimeZone,
                                    protocolData       - dbData$protocolData,
                                    classSelection     = classSelection, 
                                    classProbCutOff    = classProbCutoff, 
                                    altitudeRange_AGL  = altitudeRange, 
                                    manualBlindTimes   = cManualBlindTimes, 
                                    echoValidator      = useEchoValidator)   

## End(Not run)

</code></pre>

<hr>
<h2 id='filterProtocolData'>filterProtocolData</h2><span id='topic+filterProtocolData'></span>

<h3>Description</h3>

<p>With the function <code>filterProtocolData</code> the protocol data
can be filtered by the operation mode (pulse-type and antenna rotation). The
function returns the filtered subset of the protocol data which can later be
used to filter the echoes based on the operation mode/protocol
</p>


<h3>Usage</h3>

<pre><code class='language-R'>filterProtocolData(
  protocolData = NULL,
  pulseTypeSelection = NULL,
  rotationSelection = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="filterProtocolData_+3A_protocoldata">protocolData</code></td>
<td>
<p>dataframe with the protocol data from the data list
created by the function <code>extractDBData</code></p>
</td></tr>
<tr><td><code id="filterProtocolData_+3A_pulsetypeselection">pulseTypeSelection</code></td>
<td>
<p>character vector with the pulse types which should
be included in the subset. Options: “S”, “M”, “L” (short-, medium-,
long-pulse). Default is NULL: no filtering applied based on pulseType.</p>
</td></tr>
<tr><td><code id="filterProtocolData_+3A_rotationselection">rotationSelection</code></td>
<td>
<p>numeric vector to select the operation modes with
and/or without antenna rotation. Options: 0, 1. (0 = no rotation,
1 = rotation). Default is NULL: no filtering applied based on rotation mode.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns the filtered protocol data in the same format as provided in
the parameter <code>protocolData</code>.
</p>


<h3>Author(s)</h3>

<p>Fabian Hertner, <a href="mailto:fabian.hertner@swiss-birdradar.com">fabian.hertner@swiss-birdradar.com</a>;
Birgen Haest, <a href="mailto:birgen.haest@vogelwarte.ch">birgen.haest@vogelwarte.ch</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Set server, database, and other input settings for data extraction
# ===========================================================================
  dbServer       = "MACHINE\\SERVERNAME"     # Set the name of your SQL server
  dbName         = "db_Name"                   # Set the name of your database
  dbDriverChar   = "SQL Server"                # Set either "SQL Server" or "PostgreSQL"
  mainOutputDir  = file.path(".", "results")
  radarTimeZone  = "Etc/GMT0"
  targetTimeZone = "Etc/GMT0"
  listOfRfFeaturesToExtract = c(167, 168)
  siteLocation   = c(47.494427, 8.716432)
  sunOrCivil     = "civil"
 
# Get data
# ===========================================================================
  dbData = extractDbData(dbDriverChar                   = dbDriverChar,
                         dbServer                       = dbServer, 
                         dbName                         = dbName, 
                         saveDbToFile                   = TRUE,
                         dbDataDir                      = mainOutputDir,
                         radarTimeZone                  = radarTimeZone,
                         targetTimeZone                 = targetTimeZone,
                         listOfRfFeaturesToExtract      = listOfRfFeaturesToExtract,
                         siteLocation                   = siteLocation, 
                         sunOrCivil                     = sunOrCivil)
                         
# Set input settings for filtering of the data
# ===========================================================================
  pulseLengthSelection = "S"
  rotationSelection    = 1

# Filter the echo data
# ===========================================================================
  filteredProtocolData = filterProtocolData(protocolData       = dbData$protocolData,
                                            pulseTypeSelection = pulseLengthSelection, 
                                            rotationSelection  = rotationSelection)   

## End(Not run)

</code></pre>

<hr>
<h2 id='getCollectionTable'>Get BirdScan collection table</h2><span id='topic+getCollectionTable'></span>

<h3>Description</h3>

<p>load collection from 'Birdscan MR1' 'SQL' database
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getCollectionTable(dbConnection, dbDriverChar)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getCollectionTable_+3A_dbconnection">dbConnection</code></td>
<td>
<p>a valid  database connection</p>
</td></tr>
<tr><td><code id="getCollectionTable_+3A_dbdriverchar">dbDriverChar</code></td>
<td>
<p>the name of the driver. If different from 'PostgreSQL'
it connects to cloud.birdradar.com</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with the collection table
</p>


<h3>Author(s)</h3>

<p>Fabian Hertner, <a href="mailto:fabian.hertner@swiss-birdradar.com">fabian.hertner@swiss-birdradar.com</a>;
Birgen Haest, <a href="mailto:birgen.haest@vogelwarte.ch">birgen.haest@vogelwarte.ch</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Set server and database settings
# ===========================================================================
  dbServer       = "MACHINE\\SERVERNAME"     # Set the name of your SQL server
  dbName         = "db_Name"                   # Set the name of your database
  dbDriverChar   = "SQL Server"                # Set either "SQL Server" or "PostgreSQL"

# Open the connection with the database
# ===========================================================================
dsn = paste0("driver=", dbDriverChar, ";server=", dbServer,
             ";database=", dbName,
             ";uid=", rstudioapi::askForPassword("Database user"),
             ";pwd=", rstudioapi::askForPassword("Database password"))
dbConnection = RODBC::odbcDriverConnect(dsn)

collectionTable = getCollectionTable(dbConnection, dbDriverChar)

## End(Not run)

</code></pre>

<hr>
<h2 id='getEchoFeatures'>Get BirdScan echo features</h2><span id='topic+getEchoFeatures'></span>

<h3>Description</h3>

<p>load echo rffeature map from 'Birdscan MR1' 'SQL' database
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getEchoFeatures(dbConnection, dbDriverChar, listOfRfFeaturesToExtract)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getEchoFeatures_+3A_dbconnection">dbConnection</code></td>
<td>
<p>a valid  database connection</p>
</td></tr>
<tr><td><code id="getEchoFeatures_+3A_dbdriverchar">dbDriverChar</code></td>
<td>
<p>the name of the driver. If different from 'PostgreSQL'
it connects to cloud.birdradar.com</p>
</td></tr>
<tr><td><code id="getEchoFeatures_+3A_listofrffeaturestoextract">listOfRfFeaturesToExtract</code></td>
<td>
<p>a list of feature to extract</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of the features extracted
</p>


<h3>Author(s)</h3>

<p>Fabian Hertner, <a href="mailto:fabian.hertner@swiss-birdradar.com">fabian.hertner@swiss-birdradar.com</a>;
Birgen Haest, <a href="mailto:birgen.haest@vogelwarte.ch">birgen.haest@vogelwarte.ch</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Set server and database settings
# ===========================================================================
  dbServer       = "MACHINE\\SERVERNAME"     # Set the name of your SQL server
  dbName         = "db_Name"                   # Set the name of your database
  dbDriverChar   = "SQL Server"                # Set either "SQL Server" or "PostgreSQL"

# Open the connection with the database
# ===========================================================================
  dsn = paste0("driver=", dbDriverChar, ";server=", dbServer,
               ";database=", dbName,
               ";uid=", rstudioapi::askForPassword("Database user"),
               ";pwd=", rstudioapi::askForPassword("Database password"))
  dbConnection = RODBC::odbcDriverConnect(dsn)

# Set list of Rf features you also want to extract
# Vector with RF features to extract. Feature IDs can be found in the  
# 'rfFeatures' table in the sql database.  
# Example: Get wing beat frequency and credibility: c(167, 168)
# Set to NULL to not extract any.
# ===========================================================================
  listOfRfFeaturesToExtract = c(167, 168) 

echoFeatures = getEchoFeatures(dbConnection, dbDriverChar, 
                               listOfRfFeaturesToExtract)

## End(Not run)

</code></pre>

<hr>
<h2 id='getEchoValidationTable'>Get a BirdScan echo validation table</h2><span id='topic+getEchoValidationTable'></span>

<h3>Description</h3>

<p>gets the echoValidationTable from an already connected database
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getEchoValidationTable(dbConnection, dbDriverChar)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getEchoValidationTable_+3A_dbconnection">dbConnection</code></td>
<td>
<p>a valid  database connection</p>
</td></tr>
<tr><td><code id="getEchoValidationTable_+3A_dbdriverchar">dbDriverChar</code></td>
<td>
<p>dbDriverChar 'SQL Server' The name of the driver. Should
be either 'SQL Server' or 'PostgreSQL'. If 'PostgreSQL', it connects to cloud.birdradar.com</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe called echovalidationTable
</p>


<h3>Author(s)</h3>

<p>Fabian Hertner, <a href="mailto:fabian.hertner@swiss-birdradar.com">fabian.hertner@swiss-birdradar.com</a>;
Birgen Haest, <a href="mailto:birgen.haest@vogelwarte.ch">birgen.haest@vogelwarte.ch</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Set server and database settings
# ===========================================================================
  dbServer       = "MACHINE\\SERVERNAME"     # Set the name of your SQL server
  dbName         = "db_Name"                   # Set the name of your database
  dbDriverChar   = "SQL Server"                # Set either "SQL Server" or "PostgreSQL"

# Open the connection with the database
# ===========================================================================
  dsn = paste0("driver=", dbDriverChar, ";server=", dbServer,
               ";database=", dbName,
               ";uid=", rstudioapi::askForPassword("Database user"),
               ";pwd=", rstudioapi::askForPassword("Database password"))
  dbConnection = RODBC::odbcDriverConnect(dsn)

echovalidationTable = getEchoValidationTable(dbConnection, dbDriverChar)

## End(Not run)

</code></pre>

<hr>
<h2 id='getManualVisibilityTable'>Get manual visibility table</h2><span id='topic+getManualVisibilityTable'></span>

<h3>Description</h3>

<p>load visibility table from an already connected 'Birdscan MR1'
'SQL' database
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getManualVisibilityTable(dbConnection, dbDriverChar)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getManualVisibilityTable_+3A_dbconnection">dbConnection</code></td>
<td>
<p>a valid  database connection</p>
</td></tr>
<tr><td><code id="getManualVisibilityTable_+3A_dbdriverchar">dbDriverChar</code></td>
<td>
<p>the name of the driver. If different from 'PostgreSQL'
it connects to cloud.birdradar.com</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with the manual visibility table
</p>


<h3>Author(s)</h3>

<p>Baptiste Schmid <a href="mailto:baptiste.schmid@vogelwarte.ch">baptiste.schmid@vogelwarte.ch</a>; Birgen Haest
<a href="mailto:birgen.haest@vogelwarte.ch">birgen.haest@vogelwarte.ch</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Set server and database settings
# ===========================================================================
  dbServer       = "MACHINE\\SERVERNAME"     # Set the name of your SQL server
  dbName         = "db_Name"                   # Set the name of your database
  dbDriverChar   = "SQL Server"                # Set either "SQL Server" or "PostgreSQL"

# Open the connection with the database
# ===========================================================================
  dsn = paste0("driver=", dbDriverChar, ";server=", dbServer,
               ";database=", dbName,
               ";uid=", rstudioapi::askForPassword("Database user"),
               ";pwd=", rstudioapi::askForPassword("Database password"))
  dbConnection = RODBC::odbcDriverConnect(dsn)

manualVisibilityTable = getManualVisibilityTable(dbConnection, dbDriverChar)

## End(Not run)

</code></pre>

<hr>
<h2 id='getProtocolTable'>Get BirdScan protocol table</h2><span id='topic+getProtocolTable'></span>

<h3>Description</h3>

<p>load protocol table from an already connected 'Birdscan MR1' 'SQL' database
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getProtocolTable(dbConnection, dbDriverChar)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getProtocolTable_+3A_dbconnection">dbConnection</code></td>
<td>
<p>a valid  database connection</p>
</td></tr>
<tr><td><code id="getProtocolTable_+3A_dbdriverchar">dbDriverChar</code></td>
<td>
<p>the name of the driver. If different from 'PostgreSQL'
it connects to cloud.birdradar.com</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with the protocol table
</p>


<h3>Author(s)</h3>

<p>Fabian Hertner, <a href="mailto:fabian.hertner@swiss-birdradar.com">fabian.hertner@swiss-birdradar.com</a>;
Birgen Haest, <a href="mailto:birgen.haest@vogelwarte.ch">birgen.haest@vogelwarte.ch</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Set server and database settings
# ===========================================================================
  dbServer       = "MACHINE\\SERVERNAME"     # Set the name of your SQL server
  dbName         = "db_Name"                   # Set the name of your database
  dbDriverChar   = "SQL Server"                # Set either "SQL Server" or "PostgreSQL"

# Open the connection with the database
# ===========================================================================
  dsn = paste0("driver=", dbDriverChar, ";server=", dbServer,
               ";database=", dbName,
               ";uid=", rstudioapi::askForPassword("Database user"),
               ";pwd=", rstudioapi::askForPassword("Database password"))
  dbConnection = RODBC::odbcDriverConnect(dsn)

protocolTable = getProtocolTable(dbConnection, dbDriverChar)

## End(Not run)

</code></pre>

<hr>
<h2 id='getRadarTable'>Get a BirdScan radar table</h2><span id='topic+getRadarTable'></span>

<h3>Description</h3>

<p>get the Radar table from  an already connected DB and rename
the columns appropriately
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getRadarTable(dbConnection, dbDriverChar)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getRadarTable_+3A_dbconnection">dbConnection</code></td>
<td>
<p>a valid  database connection</p>
</td></tr>
<tr><td><code id="getRadarTable_+3A_dbdriverchar">dbDriverChar</code></td>
<td>
<p>the name of the driver.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the radar table  as a data frame
</p>


<h3>Author(s)</h3>

<p>Fabian Hertner, <a href="mailto:fabian.hertner@swiss-birdradar.com">fabian.hertner@swiss-birdradar.com</a>;
Birgen Haest, <a href="mailto:birgen.haest@vogelwarte.ch">birgen.haest@vogelwarte.ch</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Set server and database settings
# ===========================================================================
  dbServer       = "MACHINE\\SERVERNAME"     # Set the name of your SQL server
  dbName         = "db_Name"                   # Set the name of your database
  dbDriverChar   = "SQL Server"                # Set either "SQL Server" or "PostgreSQL"

# Open the connection with the database
# ===========================================================================
  dsn = paste0("driver=", dbDriverChar, ";server=", dbServer,
               ";database=", dbName,
               ";uid=", rstudioapi::askForPassword("Database user"),
               ";pwd=", rstudioapi::askForPassword("Database password"))
  dbConnection = RODBC::odbcDriverConnect(dsn)

radarTable = getRadarTable(dbConnection, dbDriverChar)

## End(Not run)

</code></pre>

<hr>
<h2 id='getRfClassification'>Get a BirdScan 'rfClassification' table</h2><span id='topic+getRfClassification'></span>

<h3>Description</h3>

<p>gets  the 'rfClasses' table from a 'Birdscan MR1' 'SQL'
database
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getRfClassification(dbConnection, dbDriverChar)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getRfClassification_+3A_dbconnection">dbConnection</code></td>
<td>
<p>a valid  database connection</p>
</td></tr>
<tr><td><code id="getRfClassification_+3A_dbdriverchar">dbDriverChar</code></td>
<td>
<p>dbDriverChar 'SQL Server' The name of the driver. Should
be either 'SQL Server' or 'PostgreSQL'. If 'PostgreSQL', it connects to
cloud.birdradar.com</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing three variables: (1) rfclassificationTable: The
'rfClassification' database table; (2) classProbabilitiesAndMtrFactors: A
dataframe containing the classification probabilities for all classes for
each object; and (3) availableClasses: the classes used for the
classification of the objects.
</p>


<h3>Author(s)</h3>

<p>Fabian Hertner, <a href="mailto:fabian.hertner@swiss-birdradar.com">fabian.hertner@swiss-birdradar.com</a>;
Birgen Haest, <a href="mailto:birgen.haest@vogelwarte.ch">birgen.haest@vogelwarte.ch</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Set server and database settings
# ===========================================================================
  dbServer       = "MACHINE\\SERVERNAME"     # Set the name of your SQL server
  dbName         = "db_Name"                   # Set the name of your database
  dbDriverChar   = "SQL Server"                # Set either "SQL Server" or "PostgreSQL"

# Open the connection with the database
# ===========================================================================
  dsn = paste0("driver=", dbDriverChar, ";server=", dbServer,
               ";database=", dbName,
               ";uid=", rstudioapi::askForPassword("Database user"),
               ";pwd=", rstudioapi::askForPassword("Database password"))
  dbConnection = RODBC::odbcDriverConnect(dsn)

rfClassification = getRfClassification(dbConnection, dbDriverChar)

## End(Not run)

</code></pre>

<hr>
<h2 id='getSiteTable'>Get BirdScan site table</h2><span id='topic+getSiteTable'></span>

<h3>Description</h3>

<p>load site table from an already connected 'Birdscan MR1' 'SQL'
database
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getSiteTable(dbConnection, dbDriverChar)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getSiteTable_+3A_dbconnection">dbConnection</code></td>
<td>
<p>a valid database connection</p>
</td></tr>
<tr><td><code id="getSiteTable_+3A_dbdriverchar">dbDriverChar</code></td>
<td>
<p>the name of the driver. If different from 'PostgreSQL'
it connects to cloud.birdradar.com</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with the site table
</p>


<h3>Author(s)</h3>

<p>Fabian Hertner, <a href="mailto:fabian.hertner@swiss-birdradar.com">fabian.hertner@swiss-birdradar.com</a>;
Birgen Haest, <a href="mailto:birgen.haest@vogelwarte.ch">birgen.haest@vogelwarte.ch</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Set server and database settings
# ===========================================================================
  dbServer       = "MACHINE\\SERVERNAME"     # Set the name of your SQL server
  dbName         = "db_Name"                   # Set the name of your database
  dbDriverChar   = "SQL Server"                # Set either "SQL Server" or "PostgreSQL"

# Open the connection with the database
# ===========================================================================
  dsn = paste0("driver=", dbDriverChar, ";server=", dbServer,
               ";database=", dbName,
               ";uid=", rstudioapi::askForPassword("Database user"),
               ";pwd=", rstudioapi::askForPassword("Database password"))
  dbConnection = RODBC::odbcDriverConnect(dsn)

siteTable = getSiteTable(dbConnection, dbDriverChar)

## End(Not run)

</code></pre>

<hr>
<h2 id='getTimeBinsTable'>Get BirdScan time bins table</h2><span id='topic+getTimeBinsTable'></span>

<h3>Description</h3>

<p>load time bins table from an already connected 'Birdscan MR1'
'SQL' database
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getTimeBinsTable(dbConnection, dbDriverChar)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getTimeBinsTable_+3A_dbconnection">dbConnection</code></td>
<td>
<p>a valid database connection</p>
</td></tr>
<tr><td><code id="getTimeBinsTable_+3A_dbdriverchar">dbDriverChar</code></td>
<td>
<p>the name of the driver. If different from 'PostgreSQL'
it connects to cloud.birdradar.com</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with the time bins table
</p>


<h3>Author(s)</h3>

<p>Fabian Hertner, <a href="mailto:fabian.hertner@swiss-birdradar.com">fabian.hertner@swiss-birdradar.com</a>;
Birgen Haest, <a href="mailto:birgen.haest@vogelwarte.ch">birgen.haest@vogelwarte.ch</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Set server and database settings
# ===========================================================================
  dbServer       = "MACHINE\\SERVERNAME" # Set the name of your SQL server
  dbName         = "db_Name"               # Set the name of your database
  dbDriverChar   = "SQL Server"            # Set either "SQL Server" or "PostgreSQL"

# Open the connection with the database
# ===========================================================================
  dsn = paste0("driver=", dbDriverChar, ";server=", dbServer,
               ";database=", dbName,
               ";uid=", rstudioapi::askForPassword("Database user"),
               ";pwd=", rstudioapi::askForPassword("Database password"))
  dbConnection = RODBC::odbcDriverConnect(dsn)

timeBinsTable = getTimeBinsTable(dbConnection, dbDriverChar)

## End(Not run)

</code></pre>

<hr>
<h2 id='getVisibilityTable'>Get BirdScan visibility table</h2><span id='topic+getVisibilityTable'></span>

<h3>Description</h3>

<p>load visibility table from an already connected 'Birdscan MR1'
'SQL' database
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getVisibilityTable(dbConnection, dbDriverChar)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getVisibilityTable_+3A_dbconnection">dbConnection</code></td>
<td>
<p>a valid  database connection</p>
</td></tr>
<tr><td><code id="getVisibilityTable_+3A_dbdriverchar">dbDriverChar</code></td>
<td>
<p>the name of the driver. If different from 'PostgreSQL'
it connects to cloud.birdradar.com</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with the visibility table
</p>


<h3>Author(s)</h3>

<p>Fabian Hertner, <a href="mailto:fabian.hertner@swiss-birdradar.com">fabian.hertner@swiss-birdradar.com</a>;
Birgen Haest, <a href="mailto:birgen.haest@vogelwarte.ch">birgen.haest@vogelwarte.ch</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Set server and database settings
# ===========================================================================
  dbServer       = "MACHINE\\SERVERNAME" # Set the name of your SQL server
  dbName         = "db_Name"               # Set the name of your database
  dbDriverChar   = "SQL Server"            # Set either "SQL Server" or "PostgreSQL"

# Open the connection with the database
# ===========================================================================
  dsn = paste0("driver=", dbDriverChar, ";server=", dbServer,
               ";database=", dbName,
               ";uid=", rstudioapi::askForPassword("Database user"),
               ";pwd=", rstudioapi::askForPassword("Database password"))
  dbConnection = RODBC::odbcDriverConnect(dsn)

visibilityTable = getVisibilityTable(dbConnection, dbDriverChar)

## End(Not run)

</code></pre>

<hr>
<h2 id='loadManualBlindTimes'>loadManualBlindTimes</h2><span id='topic+loadManualBlindTimes'></span>

<h3>Description</h3>

<p>Load manual blind times from csv file.
For the MTR computation the times when the radar was blind have to be known.
The radar itself can be blind in case of a protocol change (block time at the
beginning of each protocol, usually 60s) or due to rain/snow or clutter
(nearby objects, leaves or similar on radome, etc.). These times are stored
in the visibility table or in the time_bins table in relation to the time
bins duration (5min). To be flexible and not fixed to the 5 min time bins
created by the radar, the visibility table is used in this script. In
addition to the radar blind times, manual blind times can be defined. Manual
blind times have to be defined in a csv file and are loaded with the function
‘loadManualBlindTimes’. A example dataset is available by running:
<code>data(manualBlindTimes)</code>
<code>write.csv(manualBlindTimes, file = 'the output file destination', row.names = F)</code>
The file path is defined as a global variable ‘manualBlindTimesFile’. A
custom file and filepath can be used instead. The manual blind times have to
be entered with 3 columns:
start time 'yyyy-mm-dd hh:mm:ss', stop time 'yyyy-MM-dd hh:mm:ss', type.
</p>
<p>Example:
2021-01-16 04:15:00,2021-01-16 05:42:00,rain
2021-01-17 16:33:00,2021-01-17 18:04:00,clutter
Manual blind time types can be chosen freely. When computing observation
times, it can be decided if some of the defined manual blind time types
should be treated as observed time with MTR zero or as blind time
(e.g. rain). If no file is present or the file is empty, no manual blind
times will be computed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loadManualBlindTimes(filePath, blindTimesTZ, targetTZ)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loadManualBlindTimes_+3A_filepath">filePath</code></td>
<td>
<p>character string, absolute filepath of the manual blind time
file</p>
</td></tr>
<tr><td><code id="loadManualBlindTimes_+3A_blindtimestz">blindTimesTZ</code></td>
<td>
<p>time zone of the blind times</p>
</td></tr>
<tr><td><code id="loadManualBlindTimes_+3A_targettz">targetTZ</code></td>
<td>
<p>target time zone of the blind times</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with the manual blind times
</p>


<h3>Author(s)</h3>

<p>Fabian Hertner, <a href="mailto:fabian.hertner@swiss-birdradar.com">fabian.hertner@swiss-birdradar.com</a>;
Birgen Haest, <a href="mailto:birgen.haest@vogelwarte.ch">birgen.haest@vogelwarte.ch</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# load manual blind time example data from birdscanR package
  data(manualBlindTimes)
  
# Save example manual blind times to a file
  write.csv(manualBlindTimes, file = "manualBlindTimes.csv", row.names = F)
  
# Read the manual blind times from file
  manualBlindTimes.new = loadManualBlindTimes(filePath     = "./manualBlindTimes.csv",
                                              blindTimesTZ = "ETC/GMT", 
                                              targetTZ     = "ETC/GMT")

## End(Not run)

</code></pre>

<hr>
<h2 id='manualBlindTimes'>Example file on how to include manual blind times for your 'Birdscan MR1'
database.</h2><span id='topic+manualBlindTimes'></span>

<h3>Description</h3>

<p>To create your own manual blind times file, just copy this file, and adjust.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(manualBlindTimes)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>"data.frame"</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(manualBlindTimes)
</code></pre>

<hr>
<h2 id='mergeVisibilityAndManualBlindTimes'>mergeVisibilityAndManualBlindTimes</h2><span id='topic+mergeVisibilityAndManualBlindTimes'></span>

<h3>Description</h3>

<p>Function to merge manual blind times with blind times from
visibility table. For further processing the radar (visibility) and manual
blind times have to be merged with the function
‘mergeVisibilityAndManualBlindTimes’. This function will add a blind time
type to the radar/visibility blind times. Blind times during the block time
(usually 60s) at the beginning of each protocol are given the type
'protocolChange', the rest of the radar blind times are given the type
“visibility”. After that the visibility and manual blind times will be
merged. In case manual blind times and radar blind times are overlapping,
radar blind times with type “visibility” will be overwritten, but not radar
blind times with type “protocolChange”.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mergeVisibilityAndManualBlindTimes(
  visibilityData,
  manualBlindTimes = NULL,
  protocolData
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mergeVisibilityAndManualBlindTimes_+3A_visibilitydata">visibilityData</code></td>
<td>
<p>dataframe with the visibility data from the data list
created by the function ‘extractDBData’.</p>
</td></tr>
<tr><td><code id="mergeVisibilityAndManualBlindTimes_+3A_manualblindtimes">manualBlindTimes</code></td>
<td>
<p>dataframe with the manual blind times created by the
function ‘loadManualBlindTimes’.</p>
</td></tr>
<tr><td><code id="mergeVisibilityAndManualBlindTimes_+3A_protocoldata">protocolData</code></td>
<td>
<p>dataframe with the protocol data from the data list
created by the function ‘extractDBData’ or a subset of it created by the
function ‘filterProtocolData’.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>dataframe with overall blind times
</p>


<h3>Author(s)</h3>

<p>Fabian Hertner, <a href="mailto:fabian.hertner@swiss-birdradar.com">fabian.hertner@swiss-birdradar.com</a>;
Birgen Haest, <a href="mailto:birgen.haest@vogelwarte.ch">birgen.haest@vogelwarte.ch</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Set server and database settings
# ===========================================================================
  dbServer       = "MACHINE\\SERVERNAME" # Set the name of your SQL server
  dbName         = "db_Name"               # Set the name of your database
  dbDriverChar   = "SQL Server"            # Set either "SQL Server" or "PostgreSQL"

# Open the connection with the database
# ===========================================================================
  dsn = paste0("driver=", dbDriverChar, ";server=", dbServer,
               ";database=", dbName,
               ";uid=", rstudioapi::askForPassword("Database user"),
               ";pwd=", rstudioapi::askForPassword("Database password"))
  dbConnection = RODBC::odbcDriverConnect(dsn)

# Get visibility table 
# ===========================================================================
  visibilityTable = getVisibilityTable(dbConnection, dbDriverChar)

# Get manual blind times
# ===========================================================================
  data(manualBlindTimes)
  cManualBlindTimes = manualBlindTimes
  
# Merge manual and automatic blind times
# ===========================================================================
  blindTimes = mergeVisibilityAndManualBlindTimes(visibilityData   = visibilityTable, 
                                                  manualBlindTimes = cManualBlindTimes, 
                                                  protocolData     = protocolData)

## End(Not run)

</code></pre>

<hr>
<h2 id='plotExploration'>plotExploration</h2><span id='topic+plotExploration'></span>

<h3>Description</h3>

<p>This function creates a time series plot showing all of the
observed echoes at their respective altitudes. These plots are helpful to
roughly visually explore your data (and for example spot oddities).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotExploration(
  echoData = NULL,
  timeRange = NULL,
  targetTimeZone = "Etc/GMT0",
  manualBlindTimes = NULL,
  visibilityData = NULL,
  protocolData = NULL,
  sunriseSunset = NULL,
  maxAltitude = NULL,
  filePath = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotExploration_+3A_echodata">echoData</code></td>
<td>
<p>dataframe with the echo data from the data list created by
the function ‘extractDBData’ or a subset of it created by the function
‘filterEchoData’</p>
</td></tr>
<tr><td><code id="plotExploration_+3A_timerange">timeRange</code></td>
<td>
<p>optional list of string vectors length 2, start and end
time of the time ranges that should be plotted. The date/time format is
“yyyy-MM-dd hh:mm”. If not set, all echo data is plotted in one plot.
Note: Too long time-ranges may produce an error if the created image is too
large and the function can’t allocate the file.</p>
</td></tr>
<tr><td><code id="plotExploration_+3A_targettimezone">targetTimeZone</code></td>
<td>
<p>&quot;Etc/GMT0&quot; String specifying the target time zone.
Default is &quot;Etc/GMT0&quot;.</p>
</td></tr>
<tr><td><code id="plotExploration_+3A_manualblindtimes">manualBlindTimes</code></td>
<td>
<p>optional dataframe with the manual blind times
created by the function ‘loadManualBlindTimes’. If not set, manual blind
times are not shown in the plot.</p>
</td></tr>
<tr><td><code id="plotExploration_+3A_visibilitydata">visibilityData</code></td>
<td>
<p>optional dataframe with the visibility data created by
the function ‘extractDBData’. If not set, visibility data are not shown in
the plot.</p>
</td></tr>
<tr><td><code id="plotExploration_+3A_protocoldata">protocolData</code></td>
<td>
<p>optional dataframe with the protocol data used to filter
the echoes, created by the function ‘extractDBData’ or a subset of it created
by the function ‘filterProtocolData’. If not set, periods without a protocol
are not shown in the plot.</p>
</td></tr>
<tr><td><code id="plotExploration_+3A_sunrisesunset">sunriseSunset</code></td>
<td>
<p>optional dataframe with sunrise/sunset, civil, and nautical
twilight times created by the function ‘twilight’. If not set, day/night
times are not shown in the plot.</p>
</td></tr>
<tr><td><code id="plotExploration_+3A_maxaltitude">maxAltitude</code></td>
<td>
<p>optional numeric, fixes the maximum value of the y-Scale
of the plot to the given value. If negative or not set, the y-Scale is
auto-scaled.</p>
</td></tr>
<tr><td><code id="plotExploration_+3A_filepath">filePath</code></td>
<td>
<p>character string, path of the directory where the plot
should be saved. The function ‘savePlotToFile’ is used to save the plots as
png files with an auto-generated filename.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>png files stored in the directory specified in 'filePath'
</p>


<h3>Author(s)</h3>

<p>Fabian Hertner, <a href="mailto:fabian.hertner@swiss-birdradar.com">fabian.hertner@swiss-birdradar.com</a>;
Birgen Haest, <a href="mailto:birgen.haest@vogelwarte.ch">birgen.haest@vogelwarte.ch</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
#' # Set server, database, and other input settings
# ===========================================================================
  dbServer       = "MACHINE\\SERVERNAME"     # Set the name of your SQL server
  dbName         = "db_Name"                   # Set the name of your database
  dbDriverChar   = "SQL Server"                # Set either "SQL Server" or "PostgreSQL"
  mainOutputDir  = file.path(".", "results")
  radarTimeZone  = "Etc/GMT0"
  targetTimeZone = "Etc/GMT0"
  listOfRfFeaturesToExtract = c(167, 168)
  siteLocation   = c(47.494427, 8.716432)
  sunOrCivil     = "civil"
 
# Get data
# ===========================================================================
  dbData = extractDbData(dbDriverChar                   = dbDriverChar,
                         dbServer                       = dbServer, 
                         dbName                         = dbName, 
                         saveDbToFile                   = TRUE,
                         dbDataDir                      = mainOutputDir,
                         radarTimeZone                  = radarTimeZone,
                         targetTimeZone                 = targetTimeZone,
                         listOfRfFeaturesToExtract      = listOfRfFeaturesToExtract,
                         siteLocation                   = siteLocation, 
                         sunOrCivil                     = sunOrCivil)
                         
# Get manual blindtimes
# ===========================================================================
  data("manualBlindTimes")
  cManualBlindTimes = manualBlindTimes

# Make Plot 
# ===========================================================================
  timeRangePlot = list(c("2021-01-15 00:00", "2021-01-22 00:00"),
                       c("2021-01-23 00:00", "2021-01-31 00:00"))
  plotExploration(echoData         = dbData$echoData, 
                  timeRange        = timeRangePlot, 
                  targetTimeZone   = "Etc/GMT0",
                  manualBlindTimes = cManualBlindTimes, 
                  visibilityData   = dbData$visibilityData, 
                  protocolData     = dbData$protocolData, 
                  sunriseSunset    = dbData$sunriseSunset, 
                  maxAltitude      = -1, 
                  filePath         = "./") 

## End(Not run)

</code></pre>

<hr>
<h2 id='plotLongitudinalMTR'>plotLongitudinalMTR</h2><span id='topic+plotLongitudinalMTR'></span>

<h3>Description</h3>

<p>Plots a time series of MTR values as a bar plot. For each bar
the spread (first and third Quartile) is shown as error bars as well as the
numbers of echoes. Periods with no observation are indicated with grey,
negative bars.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotLongitudinalMTR(
  mtr,
  maxMTR,
  timeRange = NULL,
  targetTimeZone = "Etc/GMT0",
  plotClass = "allClasses",
  propObsTimeCutoff = 0.2,
  plotSpread = TRUE,
  filePath = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotLongitudinalMTR_+3A_mtr">mtr</code></td>
<td>
<p>data frame with MTR values created by the function ‘computeMTR’.</p>
</td></tr>
<tr><td><code id="plotLongitudinalMTR_+3A_maxmtr">maxMTR</code></td>
<td>
<p>optional numeric variable, fixes the maximum value of the
y-Scale of the plot to the given value. If negative or not set, the y-Scale
is auto-scaled.</p>
</td></tr>
<tr><td><code id="plotLongitudinalMTR_+3A_timerange">timeRange</code></td>
<td>
<p>optional list of string vectors length 2, start and end
time of the time ranges that should be plotted. The date/time format is
“yyyy-MM-dd hh:mm”.</p>
</td></tr>
<tr><td><code id="plotLongitudinalMTR_+3A_targettimezone">targetTimeZone</code></td>
<td>
<p>&quot;Etc/GMT0&quot; String specifying the target time zone.
Default is &quot;Etc/GMT0&quot;.</p>
</td></tr>
<tr><td><code id="plotLongitudinalMTR_+3A_plotclass">plotClass</code></td>
<td>
<p>character string with the class of which the MTR data
should be plotted. If not set or set to “allClasses”, MTR of all classes
will be plotted.</p>
</td></tr>
<tr><td><code id="plotLongitudinalMTR_+3A_propobstimecutoff">propObsTimeCutoff</code></td>
<td>
<p>numeric between 0 and 1. If the MTR is computed per
day and night, time bins with a proportional observation time smaller than
propObsTimeCutoff are ignored when combining the time bins. If the MTR is
computed for each time bin, the parameter is ignored.</p>
</td></tr>
<tr><td><code id="plotLongitudinalMTR_+3A_plotspread">plotSpread</code></td>
<td>
<p>logical, choose if the spread (first and third quartile)
should be plotted.</p>
</td></tr>
<tr><td><code id="plotLongitudinalMTR_+3A_filepath">filePath</code></td>
<td>
<p>character string, path of the directory where the plot
should be saved. The function ‘savePlotToFile’ is used to save the plots as
png files with an auto-generated filename.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>png files stored in the directory specified with 'filePath'
</p>


<h3>Author(s)</h3>

<p>Fabian Hertner, <a href="mailto:fabian.hertner@swiss-birdradar.com">fabian.hertner@swiss-birdradar.com</a>;
Birgen Haest, <a href="mailto:birgen.haest@vogelwarte.ch">birgen.haest@vogelwarte.ch</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Set server, database, and other input settings
# ===========================================================================
  dbServer       = "MACHINE\\SERVERNAME" # Set the name of your SQL server
  dbName         = "db_Name"               # Set the name of your database
  dbDriverChar   = "SQL Server"            # Set either "SQL Server" or "PostgreSQL"
  mainOutputDir  = file.path(".", "results")
  radarTimeZone  = "Etc/GMT0"
  targetTimeZone = "Etc/GMT0"
  listOfRfFeaturesToExtract = c(167, 168)
  siteLocation   = c(47.494427, 8.716432)
  sunOrCivil     = "civil"
  timeRangeData       = c("2021-01-15 00:00", "2021-01-31 00:00")
 
# Get data
# ===========================================================================
  dbData = extractDbData(dbDriverChar                   = dbDriverChar,
                         dbServer                       = dbServer, 
                         dbName                         = dbName, 
                         saveDbToFile                   = TRUE,
                         dbDataDir                      = mainOutputDir,
                         radarTimeZone                  = radarTimeZone,
                         targetTimeZone                 = targetTimeZone,
                         listOfRfFeaturesToExtract      = listOfRfFeaturesToExtract,
                         siteLocation                   = siteLocation, 
                         sunOrCivil                     = sunOrCivil)
                         
# Get sunrise/sunset 
# ===========================================================================
  sunriseSunset = twilight(timeRange = timeRangeData,
                           latLon    = c(47.494427, 8.716432),
                           timeZone  = targetTimeZone)
                          
# Get manual blind times
# ===========================================================================
  data(manualBlindTimes)
  cManualBlindTimes = manualBlindTimes

# Compute migration traffic rate
# ===========================================================================
  classSelection.mtr = c("insect")
  mtrData = computeMTR(dbName                      = dbName, 
                       echoes                      = dbData$echoData, 
                       classSelection              = classSelection.mtr, 
                       altitudeRange               = c(25, 1025),
                       altitudeBinSize             = 50,
                       timeRange                   = timeRangeData, 
                       timeBinDuration_sec         = 1800,
                       timeZone                    = targetTimeZone,
                       sunriseSunset               = sunriseSunset,
                       sunOrCivil                  = "civil",
                       protocolData                = dbData$protocolData, 
                       visibilityData              = dbData$visibilityData,
                       manualBlindTimes            = cManualBlindTimes,
                       saveBlindTimes              = FALSE,
                       blindTimesOutputDir         = getwd(),
                       blindTimeAsMtrZero          = NULL,
                       propObsTimeCutoff           = 0, 
                       computePerDayNight          = FALSE, 
                       computeAltitudeDistribution = TRUE)

# Make Plot 
# ===========================================================================
  timeRangePlot = list(c("2021-01-15 00:00", "2021-01-22 00:00"),
                       c("2021-01-23 00:00", "2021-01-31 00:00"))
  plotExplorationplotLongitudinalMTR(mtr               = mtrData, 
                                     maxMTR            = -1, 
                                     timeRange         = timeRangePlot,
                                     targetTimeZone    = "Etc/GMT0",
                                     plotClass         = "allClasses",
                                     propObsTimeCutoff = 0.2,
                                     plotSpread        = TRUE, 
                                     filePath          = "./") 

## End(Not run)

</code></pre>

<hr>
<h2 id='QUERY'>Query 'SQL' database</h2><span id='topic+QUERY'></span>

<h3>Description</h3>

<p>Run an 'SQL' query on an already connected database
</p>


<h3>Usage</h3>

<pre><code class='language-R'>QUERY(dbConnection, dbDriverChar, query, as.is = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="QUERY_+3A_dbconnection">dbConnection</code></td>
<td>
<p>a valid  database connection</p>
</td></tr>
<tr><td><code id="QUERY_+3A_dbdriverchar">dbDriverChar</code></td>
<td>
<p>the name of the driver</p>
</td></tr>
<tr><td><code id="QUERY_+3A_query">query</code></td>
<td>
<p>an 'SQL' string with your query</p>
</td></tr>
<tr><td><code id="QUERY_+3A_as.is">as.is</code></td>
<td>
<p>If TRUE, leaves data as it is</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the result of the query
</p>


<h3>Author(s)</h3>

<p>Fabian Hertner, <a href="mailto:fabian.hertner@swiss-birdradar.com">fabian.hertner@swiss-birdradar.com</a>;
Birgen Haest, <a href="mailto:birgen.haest@vogelwarte.ch">birgen.haest@vogelwarte.ch</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Set server and database settings
# ===========================================================================
  dbServer       = "MACHINE\\SERVERNAME"   # Set the name of your SQL server
  dbName         = "db_Name"               # Set the name of your database
  dbDriverChar   = "SQL Server"            # Set either "SQL Server" or "PostgreSQL"

# Open the connection with the database
# ===========================================================================
  dsn = paste0("driver=", dbDriverChar, ";server=", dbServer,
               ";database=", dbName,
               ";uid=", rstudioapi::askForPassword("Database user"),
               ";pwd=", rstudioapi::askForPassword("Database password"))
  dbConnection = RODBC::odbcDriverConnect(dsn)
  
  QUERY(dbConnection = dbConnection,
        dbDriverChar = dbDriverChar,
        query        = "Select * From collection order by row asc")

## End(Not run)
  
</code></pre>

<hr>
<h2 id='saveMTR'>saveMTR</h2><span id='topic+saveMTR'></span>

<h3>Description</h3>

<p>saves MTR data to a .rds file in the directory <code>filepath</code>.
If the directory is not existing it will be created if possible.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>saveMTR(
  mtr,
  filepath,
  fileName = NULL,
  fileNamePrefix = NULL,
  dbName = NULL,
  rotSelection = NULL,
  pulseTypeSelection = NULL,
  classAbbreviations = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="saveMTR_+3A_mtr">mtr</code></td>
<td>
<p>dataframe with MTR values created by the function <code>computeMTR</code></p>
</td></tr>
<tr><td><code id="saveMTR_+3A_filepath">filepath</code></td>
<td>
<p>character string, path of the directory. If the directory
does not exist it will be created if possible.</p>
</td></tr>
<tr><td><code id="saveMTR_+3A_filename">fileName</code></td>
<td>
<p>Filename (string) for the file. If not set, the filename
will be built using the input of the variables 'filenamePrefix', 'dbName',
'classAbbreviations', and other info in the 'mtr' data. If set, overrides
the automatic filename creation.</p>
</td></tr>
<tr><td><code id="saveMTR_+3A_filenameprefix">fileNamePrefix</code></td>
<td>
<p>prefix of the filename (string). If not set, &quot;mtr&quot; is
used. Different information about the MTR data will be appended to the
filename.</p>
</td></tr>
<tr><td><code id="saveMTR_+3A_dbname">dbName</code></td>
<td>
<p>character string, name of the database. Used to create the
filename, if 'fileName' is not provided.</p>
</td></tr>
<tr><td><code id="saveMTR_+3A_rotselection">rotSelection</code></td>
<td>
<p>numeric vector, rotation selection which was used to
filter protocols. Used to create the filename, if 'fileName' is not
provided. If not set, the rotation selection will not be appended to the
filename.</p>
</td></tr>
<tr><td><code id="saveMTR_+3A_pulsetypeselection">pulseTypeSelection</code></td>
<td>
<p>character vector, pulse type selection which was
used to filter protocols. Used to create the filename, if 'fileName' is not
provided. If not set, the pulse type selection will not be appended to the
filename.</p>
</td></tr>
<tr><td><code id="saveMTR_+3A_classabbreviations">classAbbreviations</code></td>
<td>
<p>Two-column dataframe with character first column
named 'class' and character second 'abbr', containing the full names of the
classes and their abbreviations to use in the output filename.
Default = NULL, meaning the abbreviations will be used that are stored in
the package; See data(classAbbreviations). Used to create the filename, if
'fileName' is not provided.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, used to save MTR to file.
</p>


<h3>Author(s)</h3>

<p>Fabian Hertner, <a href="mailto:fabian.hertner@swiss-birdradar.com">fabian.hertner@swiss-birdradar.com</a>;
Birgen Haest, <a href="mailto:birgen.haest@vogelwarte.ch">birgen.haest@vogelwarte.ch</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Set server, database, and other input settings
# ===========================================================================
  dbServer       = "MACHINE\\SERVERNAME"     # Set the name of your SQL server
  dbName         = "db_Name"                   # Set the name of your database
  dbDriverChar   = "SQL Server"                # Set either "SQL Server" or "PostgreSQL"
  mainOutputDir  = file.path(".", "results")
  radarTimeZone  = "Etc/GMT0"
  targetTimeZone = "Etc/GMT0"
  listOfRfFeaturesToExtract = c(167, 168)
  siteLocation   = c(47.494427, 8.716432)
  sunOrCivil     = "civil"
  timeRangeData       = c("2021-01-15 00:00", "2021-01-31 00:00")
 
# Get data
# ===========================================================================
  dbData = extractDbData(dbDriverChar                   = dbDriverChar,
                         dbServer                       = dbServer, 
                         dbName                         = dbName, 
                         saveDbToFile                   = TRUE,
                         dbDataDir                      = mainOutputDir,
                         radarTimeZone                  = radarTimeZone,
                         targetTimeZone                 = targetTimeZone,
                         listOfRfFeaturesToExtract      = listOfRfFeaturesToExtract,
                         siteLocation                   = siteLocation, 
                         sunOrCivil                     = sunOrCivil)
                         
# Get sunrise/sunset 
# ===========================================================================
  sunriseSunset = twilight(timeRange = timeRangeData,
                           latLon    = c(47.494427, 8.716432),
                           timeZone  = targetTimeZone)
                          
# Get manual blind times
# ===========================================================================
  data(manualBlindTimes)
  cManualBlindTimes = manualBlindTimes

# Compute migration traffic rate
# ===========================================================================
  classSelection.mtr = c("insect")
  mtrData = computeMTR(dbName                      = dbName, 
                       echoes                      = dbData$echoData, 
                       classSelection              = classSelection.mtr, 
                       altitudeRange               = c(25, 1025),
                       altitudeBinSize             = 50,
                       timeRange                   = timeRangeData, 
                       timeBinDuration_sec         = 1800,
                       timeZone                    = targetTimeZone,
                       sunriseSunset               = sunriseSunset,
                       sunOrCivil                  = "civil",
                       protocolData                = dbData$protocolData, 
                       visibilityData              = dbData$visibilityData,
                       manualBlindTimes            = cManualBlindTimes,
                       saveBlindTimes              = FALSE,
                       blindTimesOutputDir         = getwd(),
                       blindTimeAsMtrZero          = NULL,
                       propObsTimeCutoff           = 0, 
                       computePerDayNight          = FALSE, 
                       computeAltitudeDistribution = TRUE)   
                       
saveMTR(mtr      = mtrData,
        filepath = getwd())

## End(Not run)

</code></pre>

<hr>
<h2 id='savePlotToFile'>savePlotToFile</h2><span id='topic+savePlotToFile'></span>

<h3>Description</h3>

<p>saves created plots as .png.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>savePlotToFile(
  plot = NULL,
  filePath = NULL,
  plotType = NULL,
  plotWidth_mm = NULL,
  plotHeight_mm = NULL,
  timeRange = NULL,
  classSelection = NULL,
  altitudeRange = NULL,
  classAbbreviations = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="savePlotToFile_+3A_plot">plot</code></td>
<td>
<p>'ggplot' plot to be saved</p>
</td></tr>
<tr><td><code id="savePlotToFile_+3A_filepath">filePath</code></td>
<td>
<p>character string, path of the directory, e.g.
&quot;your-project-directory/Data/MTR&quot;. If the directory does not exist it will
be created if possible.</p>
</td></tr>
<tr><td><code id="savePlotToFile_+3A_plottype">plotType</code></td>
<td>
<p>character string, name/description of the plot, used to
create the filename. If not set, the pulse type selection will not be
appended to the filename</p>
</td></tr>
<tr><td><code id="savePlotToFile_+3A_plotwidth_mm">plotWidth_mm</code></td>
<td>
<p>numeric, width of the plot in mm. If not set, the size
of the png will be set automatically.</p>
</td></tr>
<tr><td><code id="savePlotToFile_+3A_plotheight_mm">plotHeight_mm</code></td>
<td>
<p>numeric, height of the plot in mm. If not set, the size
of the png will be set automatically.</p>
</td></tr>
<tr><td><code id="savePlotToFile_+3A_timerange">timeRange</code></td>
<td>
<p>POSIXct vector of size 2, time range of the plot, used to
create the filename. If not set, the pulse type selection will not be
appended to the filename</p>
</td></tr>
<tr><td><code id="savePlotToFile_+3A_classselection">classSelection</code></td>
<td>
<p>character string vector, classes that were used to
create the plot, used to create the filename. If not set, the pulse type
selection will not be appended to the filename</p>
</td></tr>
<tr><td><code id="savePlotToFile_+3A_altituderange">altitudeRange</code></td>
<td>
<p>numeric vector of size 2, altitude range used to create
the plot, used to create the filename. If not set, the pulse type selection
will not be appended to the filename</p>
</td></tr>
<tr><td><code id="savePlotToFile_+3A_classabbreviations">classAbbreviations</code></td>
<td>
<p>Two-column dataframe with character first column
named 'class' and character second 'abbr', containing the full names of the
classes and their abbreviations to use in the output filename.
Default = NULL, meaning the abbreviations will be used that are stored in
the package; See data(classAbbreviations).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, used to save plots to file.
</p>


<h3>Author(s)</h3>

<p>Fabian Hertner, <a href="mailto:fabian.hertner@swiss-birdradar.com">fabian.hertner@swiss-birdradar.com</a>;
Birgen Haest, <a href="mailto:birgen.haest@vogelwarte.ch">birgen.haest@vogelwarte.ch</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
#' # Set server, database, and other input settings
# ===========================================================================
  dbServer       = "MACHINE\\SERVERNAME"     # Set the name of your SQL server
  dbName         = "db_Name"                   # Set the name of your database
  dbDriverChar   = "SQL Server"                # Set either "SQL Server" or "PostgreSQL"
  mainOutputDir  = file.path(".", "results")
  radarTimeZone  = "Etc/GMT0"
  targetTimeZone = "Etc/GMT0"
  listOfRfFeaturesToExtract = c(167, 168)
  siteLocation   = c(47.494427, 8.716432)
  sunOrCivil     = "civil"
 
# Get data
# ===========================================================================
  dbData = extractDbData(dbDriverChar                   = dbDriverChar,
                         dbServer                       = dbServer, 
                         dbName                         = dbName, 
                         saveDbToFile                   = TRUE,
                         dbDataDir                      = mainOutputDir,
                         radarTimeZone                  = radarTimeZone,
                         targetTimeZone                 = targetTimeZone,
                         listOfRfFeaturesToExtract      = listOfRfFeaturesToExtract,
                         siteLocation                   = siteLocation, 
                         sunOrCivil                     = sunOrCivil)
                         
# Get manual blindtimes
# ===========================================================================
  data("manualBlindTimes")
  cManualBlindTimes = manualBlindTimes

# Make Plot 
# ===========================================================================
  timeRangePlot = list(c("2021-01-15 00:00", "2021-01-22 00:00"),
                       c("2021-01-23 00:00", "2021-01-31 00:00"))
  cPlot = plotExploration(echoData         = dbData$echoData, 
                          timeRange        = timeRangePlot, 
                          targetTimeZone   = "Etc/GMT0",
                          manualBlindTimes = cManualBlindTimes, 
                          visibilityData   = dbData$visibilityData, 
                          protocolData     = dbData$protocolData, 
                          sunriseSunset    = dbData$sunriseSunset, 
                          maxAltitude      = -1, 
                          filePath         = "./") 
                  
# Save plot
# ===========================================================================
  savePlotToFile(plot               = cPlot, 
                 filePath           = "./", 
                 plotType           = "S", 
                 plotWidth_mm       = 400, 
                 plotHeight_mm      = 200)

## End(Not run)

</code></pre>

<hr>
<h2 id='twilight'>Get the nautical, civil, and solar dawn and dusk for a given timerange
and locations.</h2><span id='topic+twilight'></span>

<h3>Description</h3>

<p>Get the time of nautical (sun at 12 degrees below horizon), civil
(sun at 6 degrees below horizon) and solar (sun at 0 degrees below horizon)
dawn and dusk for each day over a given time range.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>twilight(timeRange, latLon, crs_datum = "WGS84", timeZone)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="twilight_+3A_timerange">timeRange</code></td>
<td>
<p>A two-element character vector with elements of the form
%Y-%m-%d defining the start and end of the timerange for which you want to
get the twilight information.</p>
</td></tr>
<tr><td><code id="twilight_+3A_latlon">latLon</code></td>
<td>
<p>A list of X, Y coordinates</p>
</td></tr>
<tr><td><code id="twilight_+3A_crs_datum">crs_datum</code></td>
<td>
<p>The coordinate reference system and datum of the X, Y
coordinates. Default = &quot;WGS84.</p>
</td></tr>
<tr><td><code id="twilight_+3A_timezone">timeZone</code></td>
<td>
<p>The time zone of the area of interest</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with the results
</p>


<h3>Author(s)</h3>

<p>Fabian Hertner, <a href="mailto:fabian.hertner@swiss-birdradar.com">fabian.hertner@swiss-birdradar.com</a>;
Birgen Haest, <a href="mailto:birgen.haest@vogelwarte.ch">birgen.haest@vogelwarte.ch</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
sunrisesunset = twilight(timeRange = c("2021-01-15 00:00", 
                                       "2021-01-31 00:00"),
                         latLon    = c(47.494427, 8.716432),
                         timeZone  = "Etc/GMT0")

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
