<!DOCTYPE html><html><head><title>Help for package RNifti</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {RNifti}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#$.niftiImage'><p>Access to metadata elements</p></a></li>
<li><a href='#asNifti'><p>Create or modify an NIfTI image object</p></a></li>
<li><a href='#channels'><p>Extract channels from RGB data</p></a></li>
<li><a href='#defaultInfoPanel'><p>Info panels for the built-in viewer</p></a></li>
<li><a href='#dim.internalImage'><p>Internal images</p></a></li>
<li><a href='#ExtensionCodes'><p>NIfTI extension codes</p></a></li>
<li><a href='#extensions'><p>NIfTI extensions</p></a></li>
<li><a href='#ndim'><p>Number of dimensions</p></a></li>
<li><a href='#niftiHeader'><p>Dump or construct a raw NIfTI or ANALYZE header</p></a></li>
<li><a href='#niftiVersion'><p>Check the format version of a file</p></a></li>
<li><a href='#pixdim'><p>Pixel dimensions and units</p></a></li>
<li><a href='#readNifti'><p>Read NIfTI or ANALYZE format files</p></a></li>
<li><a href='#rgbArray'><p>RGB arrays</p></a></li>
<li><a href='#view'><p>A basic 3D image viewer</p></a></li>
<li><a href='#voxelToWorld'><p>Transform points between voxel and &ldquo;world&rdquo; coordinates</p></a></li>
<li><a href='#writeNifti'><p>Write a NIfTI or ANALYZE format file</p></a></li>
<li><a href='#xform'><p>Obtain or replace the &ldquo;xform&rdquo; transforms for an image</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.6.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-03-06</td>
</tr>
<tr>
<td>Title:</td>
<td>Fast R and C++ Access to NIfTI Images</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 0.11.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 0.11.0), covr, reportr, shades</td>
</tr>
<tr>
<td>Enhances:</td>
<td>oro.nifti, tractor.base</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides very fast read and write access to images stored in the
    NIfTI-1, NIfTI-2 and ANALYZE-7.5 formats, with seamless synchronisation
    of in-memory image objects between compiled C and interpreted R code. Also
    provides a simple image viewer, and a C/C++ API that can be used by other
    packages. Not to be confused with 'RNiftyReg', which performs image
    registration and applies spatial transformations.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/jonclayden/RNifti">https://github.com/jonclayden/RNifti</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/jonclayden/RNifti/issues">https://github.com/jonclayden/RNifti/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-06 17:45:19 UTC; jon</td>
</tr>
<tr>
<td>Author:</td>
<td>Jon Clayden <a href="https://orcid.org/0000-0002-6608-0619"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [cre,
    aut],
  Bob Cox [aut],
  Mark Jenkinson [aut],
  Matt Hall [ctb],
  Rick Reynolds [ctb],
  Kate Fissell [ctb],
  Jean-loup Gailly [cph],
  Mark Adler [cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jon Clayden &lt;code@clayden.org&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-07 00:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='+24.niftiImage'>Access to metadata elements</h2><span id='topic++24.niftiImage'></span><span id='topic++24+3C-.niftiImage'></span>

<h3>Description</h3>

<p>These methods provide shorthand access to metadata elements from the NIfTI
header corresponding to an image. The extraction version returns the
corresponding element from the result of <code>niftiHeader</code>, while the
replacement version calls <code>asNifti</code> to replace it.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'niftiImage'
x$name

## S3 replacement method for class 'niftiImage'
x$name &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="+2B24.niftiImage_+3A_x">x</code></td>
<td>
<p>A <code>"niftiImage"</code> object, internal or otherwise.</p>
</td></tr>
<tr><td><code id="+2B24.niftiImage_+3A_name">name</code></td>
<td>
<p>A string naming the field required.</p>
</td></tr>
<tr><td><code id="+2B24.niftiImage_+3A_value">value</code></td>
<td>
<p>A new value for the field.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jon Clayden &lt;code@clayden.org&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+niftiHeader">niftiHeader</a></code>, <code><a href="#topic+asNifti">asNifti</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>im &lt;- readNifti(system.file("extdata", "example.nii.gz", package="RNifti"))
print(im$descrip)

</code></pre>

<hr>
<h2 id='asNifti'>Create or modify an NIfTI image object</h2><span id='topic+asNifti'></span><span id='topic+retrieveNifti'></span><span id='topic+updateNifti'></span><span id='topic+asNifti.default'></span>

<h3>Description</h3>

<p>This function converts a filename, array or other image class into an object
of class <code>"niftiImage"</code>, and optionally updates its metadata from a
reference image and/or changes its internal datatype. The dimensions and
pixel dimensions from the <code>image</code> will replace those from the reference
object, if they are available.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>asNifti(x, reference = NULL, ...)

## Default S3 method:
asNifti(x, reference = NULL, datatype = "auto",
  internal = NA, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="asNifti_+3A_x">x</code></td>
<td>
<p>Any suitable object (see Details).</p>
</td></tr>
<tr><td><code id="asNifti_+3A_reference">reference</code></td>
<td>
<p>An image, or a named list of NIfTI-1 properties like that
produced by <code><a href="#topic+niftiHeader">niftiHeader</a></code>. The default of <code>NULL</code> will
have no effect.</p>
</td></tr>
<tr><td><code id="asNifti_+3A_...">...</code></td>
<td>
<p>Additional parameters to methods.</p>
</td></tr>
<tr><td><code id="asNifti_+3A_datatype">datatype</code></td>
<td>
<p>The NIfTI datatype to use within the internal image. The
default, <code>"auto"</code> uses the R type. Other possibilities are
<code>"float"</code>, <code>"int16"</code>, etc., which may be preferred to reduce
object size. However, no checks are done to ensure that the coercion
maintains precision, and this option is for advanced usage only.</p>
</td></tr>
<tr><td><code id="asNifti_+3A_internal">internal</code></td>
<td>
<p>Logical value. If <code>FALSE</code>, the result will be an array
of class <code>"niftiImage"</code> containing the image pixel or voxel values,
with some metadata in attributes. If <code>TRUE</code>, the result will be an
object of class <code>"internalImage"</code>, which exposes some basic metadata
to R but stores the pixel data internally. If <code>NA</code>, the default, the
result will be an internal image only if the input <code>image</code> is. If a
new <code>datatype</code> is set then this value is implicitly <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the <code>image</code> has an internal NIfTI pointer, that will be retrieved
directly. Otherwise, if it is a string, it will be taken to be a filename.
If it looks like a <code>"nifti"</code> object (from package <code>oro.nifti</code>),
or an <code>"MriImage"</code> object (from package <code>tractor.base</code>), a
conversion will be performed. A list will be assumed to be of the form
produced by <code><a href="#topic+niftiHeader">niftiHeader</a></code>. Finally, a numeric array or matrix,
or RGB array, will be converted using default image parameters.
</p>
<p>If <code>reference</code> is a complete list of NIfTI-1 header fields, like that
produced by <code><a href="#topic+niftiHeader">niftiHeader</a></code>, or an image, then it will be used to
create the internal object, and then the data and metadata associated with
the <code>image</code> will overwrite the appropriate parts. If <code>reference</code>
is an incomplete list, the <code>image</code> will be used to create the internal
object, and then the specified fields will be overwritten from the list.
This allows users to selectively update certain fields while leaving others
alone (but see the note below).
</p>
<p>If multiple values are passed for a field that expects a scalar (which is
most of them), the first element of the vector will be used, with a warning.
An empty vector will be ignored, also with a warning. If a value of the
wrong length is passed to a vector-valued field, an error will be generated.
</p>
<p>Datatype information in a list <code>reference</code> is ignored. The datatype can
only be changed using the <code>datatype</code> argument, but in this case the
internal object gets out of sync with the R array, so an internal image is
returned to avoid the mismatch. Changing the internal datatype in this way
is for advanced usage only.
</p>
<p><code>retrieveNifti</code> and <code>updateNifti</code> are soft-deprecated alternative
interfaces to this function, which behave like the pre-existing functions of
the same names. They may be removed in future.
</p>


<h3>Value</h3>

<p>An array or internal image, with class <code>"niftiImage"</code> (and
possibly also <code>"internalImage"</code>).
</p>


<h3>Note</h3>

<p>The <code>scl_slope</code> and <code>scl_inter</code> fields affect the numerical
interpretation of the pixel data, so it is impossible in general to change
them without also changing the array values on both the C and the R side.
Therefore, to avoid unexpected side-effects, these fields are not affected
by this function. The <code>dim</code> and <code>pixdim</code> fields can be changed,
but for most users the accessor functions of the same name are much safer,
and should be used in preference.
</p>


<h3>Author(s)</h3>

<p>Jon Clayden &lt;code@clayden.org&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+readNifti">readNifti</a></code>, <code><a href="#topic++24.niftiImage">$.niftiImage</a></code>,
<code><a href="#topic+dim.internalImage">dim.internalImage</a></code>, <code><a href="#topic+pixdim">pixdim</a></code>, <code><a href="#topic+xform">xform</a></code>
</p>

<hr>
<h2 id='channels'>Extract channels from RGB data</h2><span id='topic+channels'></span>

<h3>Description</h3>

<p>Extract one or more channels from an RGB data array that was obtained from
an RGB NIfTI image or created by the <code><a href="#topic+rgbArray">rgbArray</a></code> function. The
result is more amenable to numeric manipulation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>channels(array, channels = c("red", "green", "blue", "alpha"), raw = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="channels_+3A_array">array</code></td>
<td>
<p>An image, an <code>rgbArray</code>, or another array that can be
converted to the latter.</p>
</td></tr>
<tr><td><code id="channels_+3A_channels">channels</code></td>
<td>
<p>A character vector of channels to extract.</p>
</td></tr>
<tr><td><code id="channels_+3A_raw">raw</code></td>
<td>
<p>Boolean value: if <code>TRUE</code>, return a raw array, which is the
most compact representation; otherwise return an integer array.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A raw-mode or integer-mode array with one more dimension than the
first argument, corresponding to channels.
</p>


<h3>Author(s)</h3>

<p>Jon Clayden &lt;code@clayden.org&gt;
</p>

<hr>
<h2 id='defaultInfoPanel'>Info panels for the built-in viewer</h2><span id='topic+defaultInfoPanel'></span><span id='topic+timeSeriesPanel'></span>

<h3>Description</h3>

<p>A default info panel for <code><a href="#topic+view">view</a></code>, which shows the labels and
values of each image at the current point, and a panel suitable for
plotting four-dimensional time series images.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>defaultInfoPanel(point, data, labels)

timeSeriesPanel(point, data, labels)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="defaultInfoPanel_+3A_point">point</code></td>
<td>
<p>A numeric vector giving the current point location.</p>
</td></tr>
<tr><td><code id="defaultInfoPanel_+3A_data">data</code></td>
<td>
<p>A list of data values for each image at the current point.
Note that, for images of more than three dimensions, there will be more
than one value per image.</p>
</td></tr>
<tr><td><code id="defaultInfoPanel_+3A_labels">labels</code></td>
<td>
<p>A character vector of image labels.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jon Clayden &lt;code@clayden.org&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+view">view</a></code>
</p>

<hr>
<h2 id='dim.internalImage'>Internal images</h2><span id='topic+dim.internalImage'></span><span id='topic+internalImage'></span><span id='topic+dim+3C-.internalImage'></span><span id='topic+as.array.internalImage'></span><span id='topic++5B.internalImage'></span><span id='topic++5B+3C-.internalImage'></span>

<h3>Description</h3>

<p>An internal image is a simple R object with a few attributes including a
pointer to an internal C structure, which contains the full image data. They
are used in the package for efficiency, but can be converted to a normal
R array using the <code>as.array</code> method. Attributes of these objects should
not be changed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'internalImage'
dim(x)

## S3 replacement method for class 'internalImage'
dim(x) &lt;- value

## S3 method for class 'internalImage'
as.array(x, ...)

## S3 method for class 'internalImage'
x[i, j, ..., drop = TRUE]

## S3 replacement method for class 'internalImage'
x[i, j, ...] &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dim.internalImage_+3A_x">x</code></td>
<td>
<p>An <code>"internalImage"</code> object.</p>
</td></tr>
<tr><td><code id="dim.internalImage_+3A_value">value</code></td>
<td>
<p>Not used. Changing the dimensions of (or data in) an internal
image is invalid, and will produce an error. Convert to an array first.</p>
</td></tr>
<tr><td><code id="dim.internalImage_+3A_...">...</code></td>
<td>
<p>Additional parameters to methods. Only used for additional
indices.</p>
</td></tr>
<tr><td><code id="dim.internalImage_+3A_i">i</code>, <code id="dim.internalImage_+3A_j">j</code></td>
<td>
<p>Index vectors. May be missing, which indicates that the whole of
the relevant dimension should be obtained.</p>
</td></tr>
<tr><td><code id="dim.internalImage_+3A_drop">drop</code></td>
<td>
<p>If <code>TRUE</code> (the default), unitary indices in the result will
be dropped. This mirrors the behaviour of standard array indexing.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jon Clayden &lt;code@clayden.org&gt;
</p>

<hr>
<h2 id='ExtensionCodes'>NIfTI extension codes</h2><span id='topic+ExtensionCodes'></span>

<h3>Description</h3>

<p>NIfTI extension codes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ExtensionCodes
</code></pre>


<h3>Format</h3>

<p>An object of class <code>integer</code> of length 22.
</p>

<hr>
<h2 id='extensions'>NIfTI extensions</h2><span id='topic+extensions'></span><span id='topic+extension'></span><span id='topic+extensions+3C-'></span><span id='topic+extension+3C-'></span>

<h3>Description</h3>

<p>The NIfTI-1 and NIfTI-2 formats have a simple extension mechanism that
allows additional metadata to be stored with their headers. The format of
this extension data is unspecified by the NIfTI standard, but extension
codes indicate what type of information is present. These functions provide
access to this extension metadata.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extensions(image)

extension(image, code, mode = c("raw", "character", "numeric", "double",
  "integer", "logical", "complex"), ..., simplify = TRUE)

extensions(image) &lt;- value

extension(image, code) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extensions_+3A_image">image</code></td>
<td>
<p>An image, in any acceptable form (see <code><a href="#topic+asNifti">asNifti</a></code>).</p>
</td></tr>
<tr><td><code id="extensions_+3A_code">code</code></td>
<td>
<p>Integer value, expression or string specifying which extension
code is required.</p>
</td></tr>
<tr><td><code id="extensions_+3A_mode">mode</code></td>
<td>
<p>The required mode of the extracted data.</p>
</td></tr>
<tr><td><code id="extensions_+3A_...">...</code></td>
<td>
<p>Additional arguments to <code><a href="base.html#topic+readBin">readBin</a></code>.</p>
</td></tr>
<tr><td><code id="extensions_+3A_simplify">simplify</code></td>
<td>
<p>Logical value. If <code>TRUE</code>, the default, a single
extension will be returned as a vector; otherwise a list is always
returned.</p>
</td></tr>
<tr><td><code id="extensions_+3A_value">value</code></td>
<td>
<p>New value for the extension(s).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The plural version, <code>extensions</code>, extracts or replaces all extensions
at once. The retrieval form returns a list of raw vectors, each with the
corresponding code in an attribute, and the replacement form accepts a list
of atomic vectors with code attributes, or <code>NULL</code>, which removes all
extensions. The singular version, <code>extension</code>, gets all extensions with
the specified code, or appends an extension with that code. Valid extension
codes are stored in the <code><a href="#topic+ExtensionCodes">ExtensionCodes</a></code> vector.
</p>
<p>NIfTI extensions are stored as a simple, unstructured byte stream, which is
naturally represented in R as a vector of mode <code>"raw"</code>. However, these
functions will perform some conversion to and from other atomic types for
convenience. The NIfTI standard makes no guarantees about byte order within
the data stream, but the <code>endian</code> argument to <code><a href="base.html#topic+readBin">readBin</a></code> can
be passed through when converting to a non-raw type.
</p>


<h3>Value</h3>

<p>For <code>extensions</code>, a list of raw vectors containing the bytes
stored in each available header. For <code>extension</code>, a list of vector
of values, converted to the required mode, for the extension code
specified. If the extension code is not used in the image, the return
value is <code>NULL</code>. The replacement forms return the modified image.
</p>


<h3>Author(s)</h3>

<p>Jon Clayden &lt;code@clayden.org&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ExtensionCodes">ExtensionCodes</a></code> for the valid extension codes.
</p>

<hr>
<h2 id='ndim'>Number of dimensions</h2><span id='topic+ndim'></span>

<h3>Description</h3>

<p>This function is shorthand for <code>length(dim(object))</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ndim(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ndim_+3A_object">object</code></td>
<td>
<p>An R object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The dimensionality of the object. Objects without a <code>dim</code>
attribute will produce zero.
</p>


<h3>Author(s)</h3>

<p>Jon Clayden &lt;code@clayden.org&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ndim(array(0L, dim=c(10,10)))

</code></pre>

<hr>
<h2 id='niftiHeader'>Dump or construct a raw NIfTI or ANALYZE header</h2><span id='topic+niftiHeader'></span><span id='topic+dumpNifti'></span><span id='topic+analyzeHeader'></span><span id='topic+print.niftiHeader'></span><span id='topic+print.analyzeHeader'></span>

<h3>Description</h3>

<p>These functions extract the contents of a NIfTI-1 or ANALYZE-7.5 header,
closely approximating how it is (or would be) stored on disk. Defaults will
be used where information is missing, but no processing is performed on the
metadata.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>niftiHeader(image = list(), unused = FALSE)

analyzeHeader(image = list())

## S3 method for class 'niftiHeader'
print(x, ...)

## S3 method for class 'analyzeHeader'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="niftiHeader_+3A_image">image</code></td>
<td>
<p>An image, in any acceptable form (see <code><a href="#topic+asNifti">asNifti</a></code>).
A list containing partial header information is acceptable, including an
empty list, which returns defaults for every field.</p>
</td></tr>
<tr><td><code id="niftiHeader_+3A_unused">unused</code></td>
<td>
<p>Logical value. If <code>TRUE</code>, legacy ANALYZE and padding
fields that are unused by the relevant NIfTI standard are included in the
return value. These are occasionally used by software packages.</p>
</td></tr>
<tr><td><code id="niftiHeader_+3A_x">x</code></td>
<td>
<p>A <code>"niftiHeader"</code> object.</p>
</td></tr>
<tr><td><code id="niftiHeader_+3A_...">...</code></td>
<td>
<p>Ignored.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The NIfTI-1 standard was originally formulated as a roughly backwards-
compatible improvement on the ANALYZE format. Both formats use a binary
header structure of 348 bytes, but the field names and their interpretation
is often non-equivalent. These functions dump these fields, without regard
to whether or not the result makes proper sense.
</p>
<p><code>dumpNifti</code> is an alias of <code>niftiHeader</code>, but the former is now
soft-deprecated.
</p>


<h3>Value</h3>

<p>For <code>niftiHeader</code>, a list of class <code>"niftiHeader"</code>, with
named components corresponding to the elements in a raw NIfTI-1 header.
For <code>analyzeHeader</code>, the equivalent for ANALYZE-7.5.
</p>


<h3>Note</h3>

<p>Several medical image analysis packages, such as SPM and FSL, use the
ANALYZE <code>originator</code> field to store a coordinate origin. This
interpretation is also returned, in the <code>origin</code> field.
</p>
<p>Both of these functions call <code><a href="#topic+asNifti">asNifti</a></code> on their arguments to
coerce it to NIfTI, except in one specific circumstance: when
<code>analyzeHeader</code> is called with a single-element character-mode
argument that is not an <code>"internalImage"</code> object. In this case the
string is taken to be a path and the header is reported as stored on disk.
This is because otherwise the header may be changed by the process of
converting it to NIfTI and back.
</p>


<h3>Author(s)</h3>

<p>Jon Clayden &lt;code@clayden.org&gt;
</p>


<h3>References</h3>

<p>The NIfTI-1 standard (<a href="https://www.nitrc.org/docman/view.php/26/64/nifti1.h">https://www.nitrc.org/docman/view.php/26/64/nifti1.h</a>).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+niftiVersion">niftiVersion</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>niftiHeader(system.file("extdata", "example.nii.gz", package="RNifti"))

# Default header for a standard R array
niftiHeader(array(0L, dim=c(10,10)))

</code></pre>

<hr>
<h2 id='niftiVersion'>Check the format version of a file</h2><span id='topic+niftiVersion'></span>

<h3>Description</h3>

<p>This function identifies the likely NIfTI format variant used by one or more
files on disk.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>niftiVersion(file)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="niftiVersion_+3A_file">file</code></td>
<td>
<p>A character vector of file names.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of integers, of the same length as <code>file</code>. Each
element will be 0 for ANALYZE format (the precursor to NIfTI-1), 1 for
NIfTI-1 (which is now most common), 2 for NIfTI-2, or -1 if the file
doesn't exist or doesn't look plausible in any of these formats.
</p>


<h3>Note</h3>

<p>NIfTI-2 format, mostly a variant of NIfTI-1 with wider datatypes used
for many fields, is not currently supported for reading, but it is
detected by this function.
</p>


<h3>Author(s)</h3>

<p>Jon Clayden &lt;code@clayden.org&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+readNifti">readNifti</a></code>, <code><a href="#topic+niftiHeader">niftiHeader</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>path &lt;- system.file("extdata", "example.nii.gz", package="RNifti")
niftiVersion(path)       # 1

</code></pre>

<hr>
<h2 id='pixdim'>Pixel dimensions and units</h2><span id='topic+pixdim'></span><span id='topic+pixdim.default'></span><span id='topic+pixdim+3C-'></span><span id='topic+pixdim+3C-.default'></span><span id='topic+pixunits'></span><span id='topic+pixunits.default'></span><span id='topic+pixunits+3C-'></span><span id='topic+pixunits+3C-.default'></span>

<h3>Description</h3>

<p>By default, these generic functions return or replace the <code>"pixdim"</code>
and <code>"pixunits"</code> attributes of their arguments. These represent the
physical step size between pixel or voxel centre points, and the spatial and
temporal units that they are given in. The former defaults to 1 in each
dimension, if there is no attribute.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pixdim(object)

## Default S3 method:
pixdim(object)

pixdim(object) &lt;- value

## Default S3 replacement method:
pixdim(object) &lt;- value

pixunits(object)

## Default S3 method:
pixunits(object)

pixunits(object) &lt;- value

## Default S3 replacement method:
pixunits(object) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pixdim_+3A_object">object</code></td>
<td>
<p>An R object, generally an image.</p>
</td></tr>
<tr><td><code id="pixdim_+3A_value">value</code></td>
<td>
<p>Numeric vector of pixel dimensions along each axis, or
character vector of abbreviated units. For dimensions, a scalar
<code>value</code> will be recycled if necessary.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>pixdim</code> returns a numeric vector of pixel dimensions.
<code>pixunits</code> returns a character vector of length up to two, giving the
spatial and temporal unit names.
</p>


<h3>Author(s)</h3>

<p>Jon Clayden &lt;code@clayden.org&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>im &lt;- readNifti(system.file("extdata", "example.nii.gz", package="RNifti"))
pixdim(im)
pixunits(im)

</code></pre>

<hr>
<h2 id='readNifti'>Read NIfTI or ANALYZE format files</h2><span id='topic+readNifti'></span><span id='topic+readAnalyze'></span>

<h3>Description</h3>

<p>This function reads one or more NIfTI-1, NIfTI-2 or ANALYZE-7.5 files into
R, using the standard NIfTI C library.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>readNifti(file, internal = FALSE, volumes = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="readNifti_+3A_file">file</code></td>
<td>
<p>A character vector of file names.</p>
</td></tr>
<tr><td><code id="readNifti_+3A_internal">internal</code></td>
<td>
<p>Logical value. If <code>FALSE</code> (the default), an array
of class <code>"niftiImage"</code>, containing the image pixel or voxel values,
will be returned. If <code>TRUE</code>, the return value will be an object of
class <code>"internalImage"</code>, which contains only minimal metadata about
the image. Either way, the return value has an attribute which points to a
C data structure containing the full image.</p>
</td></tr>
<tr><td><code id="readNifti_+3A_volumes">volumes</code></td>
<td>
<p>An integer vector giving the volumes to read (counting along
all dimensions beyond the third jointly), or <code>NULL</code>, the default, in
which case every volume is read. This cannot currently be set differently
for each file read.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An array or internal image, with class <code>"niftiImage"</code> (and
possibly also <code>"internalImage"</code>), or a list of such objects if
<code>file</code> has length greater than one.
</p>


<h3>Note</h3>

<p>If the <code>internal</code> argument is <code>FALSE</code> (the default), the
data type of the image pointer will be set to match one of R's native
numeric data types, i.e., 32-bit signed integer or 64-bit double-precision
floating-point. In these circumstances the data type reported by the
<code><a href="#topic+niftiHeader">niftiHeader</a></code> function will therefore not, in general, match
the storage type used in the file. See also the <code>datatype</code> argument
to <code><a href="#topic+writeNifti">writeNifti</a></code>.
</p>


<h3>Author(s)</h3>

<p>Jon Clayden &lt;code@clayden.org&gt;
</p>


<h3>References</h3>

<p>The NIfTI-1 standard (<a href="https://www.nitrc.org/docman/view.php/26/64/nifti1.h">https://www.nitrc.org/docman/view.php/26/64/nifti1.h</a>).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+writeNifti">writeNifti</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>path &lt;- system.file("extdata", "example.nii.gz", package="RNifti")
readNifti(path)
readNifti(path, internal=TRUE)

</code></pre>

<hr>
<h2 id='rgbArray'>RGB arrays</h2><span id='topic+rgbArray'></span><span id='topic+as.character.rgbArray'></span>

<h3>Description</h3>

<p>The <code>rgbArray</code> function constructs an integer array whose values are
byte-packed representations of 8-bit RGBA colour values. The <code>channels</code>
attribute (with value 3 or 4) indicates how many channels are being used.
The resulting array can be used to construct an RGB(A) NIfTI image, or
converted to standard R colour strings using the <code>as.character</code> method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rgbArray(red, green, blue, alpha, max = NULL, dim = NULL, ...)

## S3 method for class 'rgbArray'
as.character(x, flatten = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rgbArray_+3A_red">red</code></td>
<td>
<p>A numeric vector (or array) of red channel values. If this is the
only channel argument, it can also be a character vector of colour values
(including alpha, if required), or a numeric array whose last dimension is
2 (for grey + alpha), 3 (for RGB) or 4 (for RGBA).</p>
</td></tr>
<tr><td><code id="rgbArray_+3A_green">green</code>, <code id="rgbArray_+3A_blue">blue</code>, <code id="rgbArray_+3A_alpha">alpha</code></td>
<td>
<p>Numeric vectors (or arrays) containing values for
the appropriate channel. These will be combined with the <code>red</code> values
using <code>cbind</code>, and hence recycled as necessary. Alpha, or green and
blue, can be missing.</p>
</td></tr>
<tr><td><code id="rgbArray_+3A_max">max</code></td>
<td>
<p>The maximum possible value for any channel. The default
is 255 when the data is of integer mode, and 1 otherwise. Values above
this, or below zero, will be clipped to the appropriate extreme.</p>
</td></tr>
<tr><td><code id="rgbArray_+3A_dim">dim</code></td>
<td>
<p>An integer vector of dimensions for the final array. The
dimensions of <code>red</code> are used if this is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="rgbArray_+3A_...">...</code></td>
<td>
<p>For <code>rgbArray</code>, additional attributes to set on the result,
such as <code>pixdim</code>. These are passed directly to
<code><a href="base.html#topic+structure">structure</a></code>. For the <code>as.character</code> method, this argument
is ignored.</p>
</td></tr>
<tr><td><code id="rgbArray_+3A_x">x</code></td>
<td>
<p>An <code>rgbArray</code> object.</p>
</td></tr>
<tr><td><code id="rgbArray_+3A_flatten">flatten</code></td>
<td>
<p>Logical value. If <code>FALSE</code>, the dimensions of <code>x</code>
will be retained in the result. The default is <code>TRUE</code>, for
consistency with the usual behaviour of <code>as.character</code>, which strips
all attributes.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>rgbArray</code> returns an integer-mode array of class
<code>"rgbArray"</code>. The <code>as.character</code> method returns a character-mode
vector of colour strings.
</p>


<h3>Note</h3>

<p>The values of an <code>"rgbArray"</code> are not easily interpreted, and
may depend on the endianness of the platform. For manipulation or use as
colours they should generally be converted to character mode, or the
channels extracted using the <code><a href="#topic+channels">channels</a></code> function.
</p>


<h3>Author(s)</h3>

<p>Jon Clayden &lt;code@clayden.org&gt;
</p>

<hr>
<h2 id='view'>A basic 3D image viewer</h2><span id='topic+view'></span><span id='topic+lyr'></span>

<h3>Description</h3>

<p>This function displays one or more 2D or 3D images, with optional
click-to-navigate interactivity.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>view(..., point = NULL, radiological = getOption("radiologicalView",
  FALSE), interactive = base::interactive(), crosshairs = TRUE,
  labels = TRUE, infoPanel = defaultInfoPanel)

lyr(image, scale = "grey", min = NULL, max = NULL, mask = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="view_+3A_...">...</code></td>
<td>
<p>One or more images, or <code>"viewLayer"</code> objects, to display.</p>
</td></tr>
<tr><td><code id="view_+3A_point">point</code></td>
<td>
<p>A numeric vector giving the location to initially centre the
view on. If crosshairs are in use, they will be placed at this point. For
3D images, this parameter also determines the planes shown in each
subview.</p>
</td></tr>
<tr><td><code id="view_+3A_radiological">radiological</code></td>
<td>
<p>Logical value. If <code>TRUE</code>, images will be displayed
in the radiological convention whereby the left of the image is shown on
the right; otherwise left is on the left.</p>
</td></tr>
<tr><td><code id="view_+3A_interactive">interactive</code></td>
<td>
<p>Logical value. If <code>TRUE</code>, the user can navigate
around the image by repeatedly clicking on a new centre point; otherwise
the view is fixed.</p>
</td></tr>
<tr><td><code id="view_+3A_crosshairs">crosshairs</code></td>
<td>
<p>Logical value, indicating whether crosshairs should be
shown or not.</p>
</td></tr>
<tr><td><code id="view_+3A_labels">labels</code></td>
<td>
<p>Logical value, indicating whether orientation labels should be
shown or not. Ignored (defaulting to <code>FALSE</code>) if the image is 2D or
orientation information is not available.</p>
</td></tr>
<tr><td><code id="view_+3A_infopanel">infoPanel</code></td>
<td>
<p>A function of three arguments, which must produce a plot
for the information panel of the view. <code><a href="#topic+defaultInfoPanel">defaultInfoPanel</a></code> is
the default, which shows the labels and values of each image at the
current point. A <code>NULL</code> value will suppress the panel.</p>
</td></tr>
<tr><td><code id="view_+3A_image">image</code></td>
<td>
<p>The image being shown in this layer.</p>
</td></tr>
<tr><td><code id="view_+3A_scale">scale</code></td>
<td>
<p>A character vector of colour values for the scale, or a single
string naming a predefined scale: <code>"grey"</code> or <code>"gray"</code> for
greyscale, <code>"heat"</code> for a heatmap, <code>"rainbow"</code> for a rainbow
scale, or any of the scales defined in the <code>shades</code> package (see
<code>?shades::gradient</code>, if that package is installed). A fixed colour
can be used by wrapping a string in a call to <code>I</code>. Ignored for RGB
images.</p>
</td></tr>
<tr><td><code id="view_+3A_min">min</code>, <code id="view_+3A_max">max</code></td>
<td>
<p>The window minimum and maximum for the layer, i.e., the black
and white points. These are ignored for RGB images. Otherwise, if
<code>NULL</code>, the default, they are taken from the <code>cal_min</code> or
<code>cal_max</code> NIfTI header fields. If either is <code>NA</code>, the image has
no window stored in its header, or the two values are equal, then the 1st
and 99th percentiles of the data are used, with values close to zero
rounded to that extreme. If these values are still equal, the untrimmed
range of the image data is used.</p>
</td></tr>
<tr><td><code id="view_+3A_mask">mask</code></td>
<td>
<p>A optional mask array, which may be of lower dimensionality than
the main image. If specified, this is converted to logical mode and pixels
that evaluate <code>FALSE</code> will be set to <code>NA</code> for that layer,
meaning they will not be plotted. This operation is performed last, and so
will not affect auto-windowing.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>lyr</code> returns a list of class <code>"viewLayer"</code>, to be used
in a view. <code>view</code> is called for its side-effect of showing a view.
</p>


<h3>Note</h3>

<p>Because of the way R's main run-loop interacts with graphics, it will
not be possible to issue further commands to the terminal while
interactive mode is enabled. Instructions for leaving this mode are shown
by the default info panel; see also <code><a href="graphics.html#topic+locator">locator</a></code>, which is the
underlying core function.
</p>


<h3>Author(s)</h3>

<p>Jon Clayden &lt;code@clayden.org&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+defaultInfoPanel">defaultInfoPanel</a></code>, <code><a href="#topic+orientation">orientation</a></code>,
<code><a href="graphics.html#topic+locator">locator</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>im &lt;- readNifti(system.file("extdata", "example.nii.gz", package="RNifti"))
view(im, interactive=FALSE)
view(lyr(im, max=800), interactive=FALSE)
view(lyr(im, mask=im&lt;800), interactive=FALSE)

</code></pre>

<hr>
<h2 id='voxelToWorld'>Transform points between voxel and &ldquo;world&rdquo; coordinates</h2><span id='topic+voxelToWorld'></span><span id='topic+worldToVoxel'></span><span id='topic+origin'></span>

<h3>Description</h3>

<p>These functions are used to transform points from dimensionless pixel or
voxel coordinates to &ldquo;real-world&rdquo; coordinates, typically in millimetres,
and back. Actual pixel units can be obtained using the
<code><a href="#topic+pixunits">pixunits</a></code> function. The <code>origin</code> function gives the voxel
coordinates of the real-world origin.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>voxelToWorld(points, image, simple = FALSE, ...)

worldToVoxel(points, image, simple = FALSE, ...)

origin(image, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="voxelToWorld_+3A_points">points</code></td>
<td>
<p>A vector giving the coordinates of a point, or a matrix with
one point per row.</p>
</td></tr>
<tr><td><code id="voxelToWorld_+3A_image">image</code></td>
<td>
<p>The image in whose space the points are given, or a 4x4 numeric
xform matrix.</p>
</td></tr>
<tr><td><code id="voxelToWorld_+3A_simple">simple</code></td>
<td>
<p>A logical value: if <code>TRUE</code> then the transformation is
performed simply by rescaling the points according to the voxel dimensions
recorded in the <code>image</code>. Otherwise the full xform matrix is used.</p>
</td></tr>
<tr><td><code id="voxelToWorld_+3A_...">...</code></td>
<td>
<p>Additional arguments to <code><a href="#topic+xform">xform</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector or matrix of transformed points.
</p>


<h3>Note</h3>

<p>Voxel coordinates are assumed by these functions to use R's indexing
convention, beginning from 1.
</p>


<h3>Author(s)</h3>

<p>Jon Clayden &lt;code@clayden.org&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+xform">xform</a></code>, <code><a href="#topic+pixdim">pixdim</a></code>, <code><a href="#topic+pixunits">pixunits</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>im &lt;- readNifti(system.file("extdata", "example.nii.gz", package="RNifti"))

# Find the origin
origin(im)

</code></pre>

<hr>
<h2 id='writeNifti'>Write a NIfTI or ANALYZE format file</h2><span id='topic+writeNifti'></span><span id='topic+writeAnalyze'></span>

<h3>Description</h3>

<p>These functions write an image to NIfTI-1, NIfTI-2 or ANALYZE-7.5 format,
using the standard NIfTI C library.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>writeNifti(image, file, template = NULL, datatype = "auto", version = 1,
  compression = 6)

writeAnalyze(image, file, template = NULL, datatype = "auto",
  compression = 6)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="writeNifti_+3A_image">image</code></td>
<td>
<p>An image, in any acceptable form (see <code><a href="#topic+asNifti">asNifti</a></code>).</p>
</td></tr>
<tr><td><code id="writeNifti_+3A_file">file</code></td>
<td>
<p>A character string containing a file name. If this has no file
extension suffix, or ends with <code>"nii"</code>, the single-file NIfTI format
is used; if the suffix is <code>"nii.gz"</code>, the compressed single-file
format is used; if the suffix is <code>"hdr"</code> or <code>"img"</code>, the NIfTI
pair two-file format is used; if it's <code>"hdr.gz"</code> or <code>"img.gz"</code>,
the compressed pair format is used. If any other extension is present it
will be ignored, and <code>".nii"</code> appended.</p>
</td></tr>
<tr><td><code id="writeNifti_+3A_template">template</code></td>
<td>
<p>An optional template object to derive NIfTI properties
from. Passed to <code><a href="#topic+asNifti">asNifti</a></code> if <code>image</code> is an array.</p>
</td></tr>
<tr><td><code id="writeNifti_+3A_datatype">datatype</code></td>
<td>
<p>The NIfTI datatype to use when writing the data out. The
default, <code>"auto"</code> uses the R type or, for internal images, the
original datatype. Other possibilities are <code>"float"</code>, <code>"int16"</code>,
etc., which may be preferred to reduce file size. However, no checks are
done to ensure that the coercion maintains precision.</p>
</td></tr>
<tr><td><code id="writeNifti_+3A_version">version</code></td>
<td>
<p>An integer (1 or 2) giving the NIfTI file format version to
use. Version 2 is usually only needed for very large images or where
metadata needs to be stored with high precision. The types available for
storing the pixel data are the same in both cases.</p>
</td></tr>
<tr><td><code id="writeNifti_+3A_compression">compression</code></td>
<td>
<p>The gzip compression level to use, an integer between 0
(none) and 9 (maximum). Ignored if an uncompressed format is implied by
the requested file name.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An invisible, named character vector giving the image and header
file names written to.
</p>


<h3>Note</h3>

<p>The ANALYZE-7.5 file format is a legacy format and use of it is not
recommended, except for compatibility. In particular, the format does
not reliably specify the spatial orientation of the image.
</p>


<h3>Author(s)</h3>

<p>Jon Clayden &lt;code@clayden.org&gt;
</p>


<h3>References</h3>

<p>The NIfTI-1 standard (<a href="https://www.nitrc.org/docman/view.php/26/64/nifti1.h">https://www.nitrc.org/docman/view.php/26/64/nifti1.h</a>).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+readNifti">readNifti</a></code>, <code><a href="#topic+asNifti">asNifti</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: writeNifti(im, "image.nii.gz", datatype="float")

</code></pre>

<hr>
<h2 id='xform'>Obtain or replace the &ldquo;xform&rdquo; transforms for an image</h2><span id='topic+xform'></span><span id='topic+qform+3C-'></span><span id='topic+sform+3C-'></span><span id='topic+orientation'></span><span id='topic+orientation+3C-'></span><span id='topic+rotation'></span>

<h3>Description</h3>

<p>These functions convert the &ldquo;qform&rdquo; or &ldquo;sform&rdquo; information in a NIfTI
header to or from a corresponding affine matrix. These two &ldquo;xform&rdquo;
mechanisms are defined by the NIfTI standard, and may both be in use in a
particular image header. They define the relationship between the storage
order of the image and real space.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xform(image, useQuaternionFirst = TRUE)

qform(x) &lt;- value

sform(x) &lt;- value

orientation(x, useQuaternionFirst = TRUE)

orientation(x) &lt;- value

rotation(x, useQuaternionFirst = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xform_+3A_image">image</code>, <code id="xform_+3A_x">x</code></td>
<td>
<p>An image, in any acceptable form (see <code><a href="#topic+asNifti">asNifti</a></code>),
or a 4x4 numeric xform matrix.</p>
</td></tr>
<tr><td><code id="xform_+3A_usequaternionfirst">useQuaternionFirst</code></td>
<td>
<p>A single logical value. If <code>TRUE</code>, the
&ldquo;qform&rdquo; matrix will be used first, if it is defined; otherwise the
&ldquo;sform&rdquo; matrix will take priority.</p>
</td></tr>
<tr><td><code id="xform_+3A_value">value</code></td>
<td>
<p>A new 4x4 qform or sform matrix, or orientation string. If a
matrix has a <code>"code"</code> attribute, the appropriate qform or sform code
is also set.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Image orientation is indicated using a three-character string, with each
character indicating the approximate world-space direction of the positive
axes in the first, second and third dimensions, in order. Each character may
be &lsquo;R&rsquo; for left-to-right, &lsquo;L&rsquo; for right-to-left, &lsquo;A&rsquo; for posterior-to-
anterior, &lsquo;P&rsquo; for anterior-to-posterior, &lsquo;S&rsquo; for inferior-to-superior, or
&lsquo;I&rsquo; for superior-to-inferior. The default for NIfTI is RAS, meaning that the
first dimension points towards the right, the second towards the front and
the third towards the top. An xform matrix is an affine transform relative
to that default.
</p>
<p>The upper-left 3x3 matrix in a 3D affine transform governs scale, rotation
and skew, while the last column is a translation. (The <code>rotation</code>
function extracts the rotation part alone.) The final row is always
(0,0,0,1). Reorienting an image involves permuting and possibly reversing
some of the axes, both in the data and the metadata. The sense of the
translation may also need to be reversed, but this is only possible if the
image dimensions are known.
</p>


<h3>Value</h3>

<p>For <code>xform</code>, an affine matrix corresponding to the &ldquo;qform&rdquo;
or &ldquo;sform&rdquo; information in the image header, with an <code>"imagedim"</code>
attribute giving the original image dimensions and a <code>"code"</code>
attribute giving the corresponding xform code. For <code>orientation</code>, a
string with three characters indicating the (approximate) orientation of
the image. The replacement forms return the modified object.
</p>


<h3>Note</h3>

<p>The qform and sform replacement functions are for advanced users only.
Modifying the transforms without knowing what you're doing is usually
unwise, as you can make the image object inconsistent.
</p>


<h3>Author(s)</h3>

<p>Jon Clayden &lt;code@clayden.org&gt;
</p>


<h3>References</h3>

<p>The NIfTI-1 standard (<a href="https://www.nitrc.org/docman/view.php/26/64/nifti1.h">https://www.nitrc.org/docman/view.php/26/64/nifti1.h</a>)
is the definitive reference on &ldquo;xform&rdquo; conventions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>im &lt;- readNifti(system.file("extdata", "example.nii.gz", package="RNifti"))
xform(im)

# Remove the qform information
qform(im) &lt;- structure(diag(4), code=0L)

# The same as above, since the sform is unmodified
xform(im)

# The identity matrix corresponds to RAS orientation
orientation(diag(4))

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
