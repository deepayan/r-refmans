<!DOCTYPE html><html lang="en"><head><title>Help for package MUVR2</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MUVR2}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#biplotPLS'><p>PLS biplot</p></a></li>
<li><a href='#checkinput'><p>Check input</p></a></li>
<li><a href='#confusionMatrix'><p>Confusion matrix</p></a></li>
<li><a href='#crispEM'><p>Effect matrix for the crisp multilevel tutorial</p></a></li>
<li><a href='#customParams'><p>Make custom parameters for internal modelling</p></a></li>
<li><a href='#get_rmsep'><p>Get RMSEP</p></a></li>
<li><a href='#getBER'><p>Get BER</p></a></li>
<li><a href='#getMISS'><p>Get number of misclassifications</p></a></li>
<li><a href='#getVar'><p>Get min, mid or max model from Elastic Net modelling</p></a></li>
<li><a href='#getVIRank'><p>Get variable importance</p></a></li>
<li><a href='#H0_reference'><p>Get reference distribution for resampling tests</p></a></li>
<li><a href='#H0_test'><p>Perform permutation or resampling tests</p></a></li>
<li><a href='#IDR'><p>Subject identifiers for the rye metabolomics regression tutorial</p></a></li>
<li><a href='#IDR2'><p>Subject identifiers for the rye metabolomics regression tutorial, using unique individuals</p></a></li>
<li><a href='#mergeModels'><p>Merge two MUVR class objects</p></a></li>
<li><a href='#MUVR2'><p>MUVR2 with PLS and RF</p></a></li>
<li><a href='#MUVR2_EN'><p>MUVR2 with EN</p></a></li>
<li><a href='#nearZeroVar'><p>Identify variables with near zero variance</p></a></li>
<li><a href='#onehotencoding'><p>One hot encoding</p></a></li>
<li><a href='#permutationPlot'><p>Plot permutation analysis</p></a></li>
<li><a href='#plotMV'><p>Plot predictions</p></a></li>
<li><a href='#plotPCA'><p>PCA score plot</p></a></li>
<li><a href='#plotPerm'><p>Plot for comparison of actual model fitness vs permutation/resampling</p></a></li>
<li><a href='#plotPred'><p>Plot predictions for PLS regression</p></a></li>
<li><a href='#plotStability'><p>Plot stability</p></a></li>
<li><a href='#plotVAL'><p>Plot validation metric</p></a></li>
<li><a href='#plotVIRank'><p>Plot variable importance ranking</p></a></li>
<li><a href='#pPerm'><p>Calculate permutation p-value</p>
Calculate perutation p-value of actual model performance vs null hypothesis distribution.
'pPerm' will calculate the cumulative (1-tailed) probability of 'actual' belonging to 'permutation_distribution'.
'side' is guessed by actual value compared to median(permutation_distribution).
Test is performed on original data OR ranked for non-parametric statistics.</a></li>
<li><a href='#predMV'><p>Predict outcomes</p>
Predict MV object using a MUVR class object and a X testing set. At present, this function only supports predictions for PLS regression type problems.</a></li>
<li><a href='#preProcess'><p>Perform matrix pre-processing</p></a></li>
<li><a href='#Q2_calculation'><p>Q2 calculation</p></a></li>
<li><a href='#qMUVR2'><p>Wrapper for speedy access to MUVR2 (autosetup of parallelization)</p></a></li>
<li><a href='#rdCV'><p>Wrapper for repeated double cross-validation without variable selection</p></a></li>
<li><a href='#rdcvNetParams'><p>Make custom parameters for rdcvNet internal modelling</p></a></li>
<li><a href='#sampling_from_distribution'><p>Sampling from the distribution of something</p></a></li>
<li><a href='#varClass'><p>Report variables belonging to different classes</p></a></li>
<li><a href='#Xotu'><p>Microbiota composition in mosquitos for the classification tutorial</p></a></li>
<li><a href='#XRVIP'><p>Metabolomics data for the rye metabolomics regression tutorial</p></a></li>
<li><a href='#XRVIP2'><p>Metabolomics data for the rye metabolomics regression tutorial, using unique individuals</p></a></li>
<li><a href='#Yotu'><p>Village of capture of mosquitos for the classification tutorial</p></a></li>
<li><a href='#YR'><p>Rye consumption for the rye metabolomics regression tutorial</p></a></li>
<li><a href='#YR2'><p>Rye consumption for the rye metabolomics regression tutorial, using unique individuals</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Multivariate Methods with Unbiased Variable Selection</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Author:</td>
<td>Carl Brunius [aut],
  Yingxiao Yan [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Yingxiao Yan &lt;yingxiao@chalmers.se&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Predictive multivariate modelling for metabolomics. 
    Types: Classification and regression. 
    Methods: Partial Least Squares, Random Forest ans Elastic Net 
    Data structures: Paired and unpaired Validation: repeated double cross-validation (Westerhuis et al. (2008)&lt;<a href="https://doi.org/10.1007%2Fs11306-007-0099-6">doi:10.1007/s11306-007-0099-6</a>&gt;, Filzmoser et al. (2009)&lt;<a href="https://doi.org/10.1002%2Fcem.1225">doi:10.1002/cem.1225</a>&gt;) 
    Variable selection: Performed internally, through tuning in the inner cross-validation loop.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/MetaboComp/MUVR2">https://github.com/MetaboComp/MUVR2</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/MetaboComp/MUVR2/issues">https://github.com/MetaboComp/MUVR2/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, graphics, randomForest, ranger, pROC, doParallel,
foreach, caret, glmnet, splines, dplyr, psych, magrittr, mgcv,
grDevices, parallel</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-09-13 11:07:32 UTC; yingxiao</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-09-16 07:50:11 UTC</td>
</tr>
</table>
<hr>
<h2 id='biplotPLS'>PLS biplot</h2><span id='topic+biplotPLS'></span>

<h3>Description</h3>

<p>Makes a biplot of a fitted object (e.g. from a MUVR with PLS core).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>biplotPLS(
  fit,
  comps = 1:2,
  xCol,
  labPlSc = TRUE,
  labs,
  vars,
  labPlLo = TRUE,
  pchSc = 16,
  colSc,
  colLo = 2,
  supLeg = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="biplotPLS_+3A_fit">fit</code></td>
<td>
<p>A PLS fit (e.g. from MUVRclassObject$Fit[[2]])</p>
</td></tr>
<tr><td><code id="biplotPLS_+3A_comps">comps</code></td>
<td>
<p>Which components to plot</p>
</td></tr>
<tr><td><code id="biplotPLS_+3A_xcol">xCol</code></td>
<td>
<p>(Optional) Continuous vector for grey scale gradient of observation (sample) color (e.g. Y vector in regression analysis)</p>
</td></tr>
<tr><td><code id="biplotPLS_+3A_labplsc">labPlSc</code></td>
<td>
<p>Boolean to plot observation (sample) names (defaults to TRUE)</p>
</td></tr>
<tr><td><code id="biplotPLS_+3A_labs">labs</code></td>
<td>
<p>(Optional) Label names</p>
</td></tr>
<tr><td><code id="biplotPLS_+3A_vars">vars</code></td>
<td>
<p>Which variables to plot (names in rownames(loadings))</p>
</td></tr>
<tr><td><code id="biplotPLS_+3A_labpllo">labPlLo</code></td>
<td>
<p>Boolean to plot variable names (defaults to TRUE)</p>
</td></tr>
<tr><td><code id="biplotPLS_+3A_pchsc">pchSc</code></td>
<td>
<p>Plotting character for observation scores</p>
</td></tr>
<tr><td><code id="biplotPLS_+3A_colsc">colSc</code></td>
<td>
<p>Colors for observation scores (only if xCol omitted)</p>
</td></tr>
<tr><td><code id="biplotPLS_+3A_collo">colLo</code></td>
<td>
<p>Colors for variable loadings (defaults to red)</p>
</td></tr>
<tr><td><code id="biplotPLS_+3A_supleg">supLeg</code></td>
<td>
<p>Boolean for whether to suppress legends</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A PLS biplot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("freelive2")
nRep &lt;- 2 # Number of MUVR2 repetitions
nOuter &lt;- 3 # Number of outer cross-validation segments
varRatio &lt;- 0.75 # Proportion of variables kept per iteration
method &lt;- 'PLS' # Selected core modeling algorithm
regrModel &lt;- MUVR2(X = XRVIP2,
                  Y = YR2,
                  nRep = nRep,
                  nOuter = nOuter,
                  method = method,
                  modReturn = TRUE)
biplotPLS(regrModel$Fit[[2]],
          comps = 1:2,
          xCol = YR2,
          labPlSc = FALSE,
          labPlLo = FALSE)

</code></pre>

<hr>
<h2 id='checkinput'>Check input</h2><span id='topic+checkinput'></span>

<h3>Description</h3>

<p>This can be run to test if the command input of parameters contradict each 
other and check the structure of the data. If something goes wrong, warning 
messages are given.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>checkinput(
  X,
  Y,
  ML,
  DA,
  method,
  fitness,
  nInner,
  nOuter,
  varRatio,
  scale,
  modReturn,
  logg,
  parallel
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="checkinput_+3A_x">X</code></td>
<td>
<p>The original data of X, not the result after onehotencoding</p>
</td></tr>
<tr><td><code id="checkinput_+3A_y">Y</code></td>
<td>
<p>The original data of Y</p>
</td></tr>
<tr><td><code id="checkinput_+3A_ml">ML</code></td>
<td>
<p>ML in MUVR2</p>
</td></tr>
<tr><td><code id="checkinput_+3A_da">DA</code></td>
<td>
<p>DA in MUVR2</p>
</td></tr>
<tr><td><code id="checkinput_+3A_method">method</code></td>
<td>
<p>RF or PLS so far in MUVR2</p>
</td></tr>
<tr><td><code id="checkinput_+3A_fitness">fitness</code></td>
<td>
<p>fitness in MUVR2</p>
</td></tr>
<tr><td><code id="checkinput_+3A_ninner">nInner</code></td>
<td>
<p>nInnerin MUVR2</p>
</td></tr>
<tr><td><code id="checkinput_+3A_nouter">nOuter</code></td>
<td>
<p>nOuter in MUVR2</p>
</td></tr>
<tr><td><code id="checkinput_+3A_varratio">varRatio</code></td>
<td>
<p>varRatio in MUVR2</p>
</td></tr>
<tr><td><code id="checkinput_+3A_scale">scale</code></td>
<td>
<p>scale</p>
</td></tr>
<tr><td><code id="checkinput_+3A_modreturn">modReturn</code></td>
<td>
<p>modReturn in MUVR2</p>
</td></tr>
<tr><td><code id="checkinput_+3A_logg">logg</code></td>
<td>
<p>logg in MUVR2</p>
</td></tr>
<tr><td><code id="checkinput_+3A_parallel">parallel</code></td>
<td>
<p>parallel in MUVR2</p>
</td></tr>
</table>


<h3>Value</h3>

<p>correct_input: the original input(call) and the real input used in MUVR2 when you enter your input
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("freelive2")
checkinput(X = XRVIP2,
           Y = YR2,  ## YR2 a numeric variable
           DA = FALSE,
           fitness="RMSEP")
</code></pre>

<hr>
<h2 id='confusionMatrix'>Confusion matrix</h2><span id='topic+confusionMatrix'></span>

<h3>Description</h3>

<p>Make a confusion matrix from a MUVR object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>confusionMatrix(MVObj, model = "mid")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="confusionMatrix_+3A_mvobj">MVObj</code></td>
<td>
<p>A MUVR object (classification analysis)</p>
</td></tr>
<tr><td><code id="confusionMatrix_+3A_model">model</code></td>
<td>
<p>min, mid or max model</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A confusion matrix of actual vs predicted class
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("mosquito")
data("crisp")
nRep &lt;- 2 # Number of MUVR2 repetitions
nOuter &lt;- 4 # Number of outer cross-validation segments
varRatio &lt;- 0.6 # Proportion of variables kept per iteration
classModel &lt;- MUVR2_EN(X = Xotu,
                      Y = Yotu,
                      nRep = nRep,
                      nOuter = nOuter,
                      DA = TRUE,
                      modReturn = TRUE)
confusionMatrix(classModel)
MLModel &lt;- MUVR2(X = crispEM,
                 ML = TRUE,
                 nRep = nRep,
                 nOuter = nOuter,
                 varRatio = varRatio,
                 method = "RF",
                 modReturn = TRUE)
 confusionMatrix(MLModel)

</code></pre>

<hr>
<h2 id='crispEM'>Effect matrix for the crisp multilevel tutorial</h2><span id='topic+crispEM'></span>

<h3>Description</h3>

<p>Effect matrix for the crisp multilevel tutorial
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(crisp)
</code></pre>

<hr>
<h2 id='customParams'>Make custom parameters for internal modelling</h2><span id='topic+customParams'></span>

<h3>Description</h3>

<p>Make custom parameters for MUVR internal modelling, not rdCV. Please note that, at present, there is no mtryMax for the outer (consensus) loop in effect.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>customParams(
  method = c("RF", "PLS", "SVM", "ANN"),
  robust = 0.05,
  ntreeIn = 150,
  ntreeOut = 300,
  mtryMaxIn = 150,
  compMax = 5,
  nodes = 200,
  threshold = 0.1,
  stepmax = 1e+08,
  neuralMaxIn = 10,
  kernel = "notkernel",
  nu = 0.1,
  gamma = 1,
  degree = 1,
  oneHot,
  NZV,
  rfMethod = c("randomForest", "ranger"),
  svmMethod = c("svm", "ksvm", "svmlight"),
  annMethod = c("nnet", "neuralnet")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="customParams_+3A_method">method</code></td>
<td>
<p>PLS or RF (default)</p>
</td></tr>
<tr><td><code id="customParams_+3A_robust">robust</code></td>
<td>
<p>Robustness (slack) criterion for determining min and max knees (defaults to 0.05)</p>
</td></tr>
<tr><td><code id="customParams_+3A_ntreein">ntreeIn</code></td>
<td>
<p>RF parameter: Number of trees in inner cross-validation loop models (defaults to 150)</p>
</td></tr>
<tr><td><code id="customParams_+3A_ntreeout">ntreeOut</code></td>
<td>
<p>RF parameter: Number of trees in outer (consensus) cross-validation loop models (defaults to 300)</p>
</td></tr>
<tr><td><code id="customParams_+3A_mtrymaxin">mtryMaxIn</code></td>
<td>
<p>RF parameter: Max number of variables to sample from at each node in the inner CV loop (defaults to 150). Will be further limited by standard RF rules (see randomForest documentation)</p>
</td></tr>
<tr><td><code id="customParams_+3A_compmax">compMax</code></td>
<td>
<p>PLS parameter: Maximum number of PLS components (defaults to 5)</p>
</td></tr>
<tr><td><code id="customParams_+3A_nodes">nodes</code></td>
<td>
<p>ann parameter:</p>
</td></tr>
<tr><td><code id="customParams_+3A_threshold">threshold</code></td>
<td>
<p>ann parameter:</p>
</td></tr>
<tr><td><code id="customParams_+3A_stepmax">stepmax</code></td>
<td>
<p>ann parameter:</p>
</td></tr>
<tr><td><code id="customParams_+3A_neuralmaxin">neuralMaxIn</code></td>
<td>
<p>ann parameter: Maximum number of ANN (defaults to 20)</p>
</td></tr>
<tr><td><code id="customParams_+3A_kernel">kernel</code></td>
<td>
<p>svm parameter: kernal function to use, which includes sigmoid, radical, polynomial</p>
</td></tr>
<tr><td><code id="customParams_+3A_nu">nu</code></td>
<td>
<p>svm parameter: ratios of errors allowed in the training set range from 0-1</p>
</td></tr>
<tr><td><code id="customParams_+3A_gamma">gamma</code></td>
<td>
<p>svm parameters: needed for &quot;vanilladot&quot;,&quot;polydot&quot;,&quot;rbfdot&quot; kernel in svm</p>
</td></tr>
<tr><td><code id="customParams_+3A_degree">degree</code></td>
<td>
<p>svm parameter: needed for polynomial kernel in svm</p>
</td></tr>
<tr><td><code id="customParams_+3A_onehot">oneHot</code></td>
<td>
<p>TRUE or FALSE using onehot endcoding or not</p>
</td></tr>
<tr><td><code id="customParams_+3A_nzv">NZV</code></td>
<td>
<p>TRUE or FALSE using non-zero variance or not</p>
</td></tr>
<tr><td><code id="customParams_+3A_rfmethod">rfMethod</code></td>
<td>
<p>randomforest method, which includes randomForest and ranger</p>
</td></tr>
<tr><td><code id="customParams_+3A_svmmethod">svmMethod</code></td>
<td>
<p>support vector machine method, which includes svm, ksvm, s</p>
</td></tr>
<tr><td><code id="customParams_+3A_annmethod">annMethod</code></td>
<td>
<p>artificial neural network method which includes 2 different ann methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a 'methParam' object
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Standard parameters for random forest
methParam &lt;- customParams() # or
methParam &lt;- customParams('RF')
# Custom ntreeOut parameters for random forest
methParam &lt;- customParams('RF',ntreeOut=50) # or
methParam &lt;- customParams('RF')
methParam$ntreeOut &lt;- 50
methParam
</code></pre>

<hr>
<h2 id='get_rmsep'>Get RMSEP</h2><span id='topic+get_rmsep'></span>

<h3>Description</h3>

<p>Get Root Mean Square Error of Prediction (RMSEP) in classification.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_rmsep(actual, predicted)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_rmsep_+3A_actual">actual</code></td>
<td>
<p>Vector of actual classifications of samples</p>
</td></tr>
<tr><td><code id="get_rmsep_+3A_predicted">predicted</code></td>
<td>
<p>Vector of predicted classifications of samples</p>
</td></tr>
</table>


<h3>Value</h3>

<p>RMSEP
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("mosquito")
actual &lt;- YR2
predicted &lt;- sampling_from_distribution(actual)
get_rmsep(actual, predicted)
</code></pre>

<hr>
<h2 id='getBER'>Get BER</h2><span id='topic+getBER'></span>

<h3>Description</h3>

<p>Get Balanced Error Rate (BER) in classification.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getBER(actual, predicted, weigh_added = FALSE, weighing_matrix)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getBER_+3A_actual">actual</code></td>
<td>
<p>Vector of actual classifications of samples</p>
</td></tr>
<tr><td><code id="getBER_+3A_predicted">predicted</code></td>
<td>
<p>Vector of predicted classifications of samples</p>
</td></tr>
<tr><td><code id="getBER_+3A_weigh_added">weigh_added</code></td>
<td>
<p>To add a weighing matrix when it is classification</p>
</td></tr>
<tr><td><code id="getBER_+3A_weighing_matrix">weighing_matrix</code></td>
<td>
<p>The matrix used to get a misclassification score</p>
</td></tr>
</table>


<h3>Value</h3>

<p>BER
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("mosquito")
actual &lt;- Yotu
predicted &lt;- sampling_from_distribution(actual)
getBER(actual, predicted)
</code></pre>

<hr>
<h2 id='getMISS'>Get number of misclassifications</h2><span id='topic+getMISS'></span>

<h3>Description</h3>

<p>Get number of misclassifications from classification analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getMISS(actual, predicted, weigh_added = FALSE, weighing_matrix)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getMISS_+3A_actual">actual</code></td>
<td>
<p>Vector of actual classifications of samples</p>
</td></tr>
<tr><td><code id="getMISS_+3A_predicted">predicted</code></td>
<td>
<p>Vector of predicted classifications of samples</p>
</td></tr>
<tr><td><code id="getMISS_+3A_weigh_added">weigh_added</code></td>
<td>
<p>Boolean, add a weighing matrix when it is classification</p>
</td></tr>
<tr><td><code id="getMISS_+3A_weighing_matrix">weighing_matrix</code></td>
<td>
<p>The matrix used to get a misclassification score</p>
</td></tr>
</table>


<h3>Value</h3>

<p>number of misclassifications
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("mosquito")
actual &lt;- Yotu
predicted &lt;- sampling_from_distribution(actual)
getMISS(actual, predicted)
</code></pre>

<hr>
<h2 id='getVar'>Get min, mid or max model from Elastic Net modelling</h2><span id='topic+getVar'></span>

<h3>Description</h3>

<p>Obtain the min, mid, or max number of variables for an object generated from the rdCVnet() function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getVar(
  rdCVnetObject,
  option = c("quantile", "fitness"),
  fit_curve = c("loess", "gam"),
  span = 1,
  k = 5,
  outlier = c("none", "IQR", "residual"),
  robust = 0.05,
  quantile = 0.25
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getVar_+3A_rdcvnetobject">rdCVnetObject</code></td>
<td>
<p>an object obtained from the rdCVnet() function</p>
</td></tr>
<tr><td><code id="getVar_+3A_option">option</code></td>
<td>
<p>quantile or fitness: which way to perform variable selection</p>
</td></tr>
<tr><td><code id="getVar_+3A_fit_curve">fit_curve</code></td>
<td>
<p>gam or loess method for fitting the curve in the fitness option</p>
</td></tr>
<tr><td><code id="getVar_+3A_span">span</code></td>
<td>
<p>parameter for using loess to fit curve in the fitness option:  how smooth the curve needs to be</p>
</td></tr>
<tr><td><code id="getVar_+3A_k">k</code></td>
<td>
<p>parameter for using gam to fit curve in the fitness option</p>
</td></tr>
<tr><td><code id="getVar_+3A_outlier">outlier</code></td>
<td>
<p>if remove outlier variables or not. There are 3 options: &quot;none&quot;,&quot;IRQ&quot;, &quot;residual&quot;</p>
</td></tr>
<tr><td><code id="getVar_+3A_robust">robust</code></td>
<td>
<p>if the option is fitness, robust parameter decides how much deviation it is allowed from the optimal perdiction performance for min and max variabel selection</p>
</td></tr>
<tr><td><code id="getVar_+3A_quantile">quantile</code></td>
<td>
<p>if the option is quantile, this value decides the cut for the first quantile, ranging from 0 to 0.5</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a rdCVnet object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("mosquito")
nRep &lt;- 2
nOuter &lt;- 4
varRatio &lt;-0.6
classModel &lt;- MUVR2_EN(X = Xotu,
                       Y = Yotu,
                       nRep = nRep,
                       nOuter = nOuter,
                       DA = TRUE,
                       modReturn = TRUE)
classModel&lt;-getVar(classModel)

</code></pre>

<hr>
<h2 id='getVIRank'>Get variable importance</h2><span id='topic+getVIRank'></span>

<h3>Description</h3>

<p>Extract autoselected variables from MUVR model object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getVIRank(MUVRclassObject, model = "mid", n, all = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getVIRank_+3A_muvrclassobject">MUVRclassObject</code></td>
<td>
<p>an object of MUVR class</p>
</td></tr>
<tr><td><code id="getVIRank_+3A_model">model</code></td>
<td>
<p>which model to use (&quot;min&quot;, &quot;mid&quot; (default), or &quot;max&quot;)</p>
</td></tr>
<tr><td><code id="getVIRank_+3A_n">n</code></td>
<td>
<p>customize values</p>
</td></tr>
<tr><td><code id="getVIRank_+3A_all">all</code></td>
<td>
<p>logical, to get the ranks of all variable or not</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame with order, name and average rank of variables ('order', 'name' &amp; 'rank')
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("freelive2")
nRep &lt;- 2
nOuter &lt;- 4
varRatio &lt;-0.6
regrModel &lt;- MUVR2(X = XRVIP2,
                   Y = YR2,
                   nRep = nRep,
                   nOuter = nOuter,
                   varRatio = varRatio,
                   method = "PLS",
                   modReturn = TRUE)
getVIRank(regrModel, model="min")

</code></pre>

<hr>
<h2 id='H0_reference'>Get reference distribution for resampling tests</h2><span id='topic+H0_reference'></span>

<h3>Description</h3>

<p>Make reference distribution for resampling tests to assess overfitting.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>H0_reference(Y, n = 1000, fitness = c("Q2", "BER", "MISS", "AUROC"), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="H0_reference_+3A_y">Y</code></td>
<td>
<p>the target variable</p>
</td></tr>
<tr><td><code id="H0_reference_+3A_n">n</code></td>
<td>
<p>number of permutations to run</p>
</td></tr>
<tr><td><code id="H0_reference_+3A_fitness">fitness</code></td>
<td>
<p>number of repetitions for each permutation (defaults to value of actual model)</p>
</td></tr>
<tr><td><code id="H0_reference_+3A_...">...</code></td>
<td>
<p>additional arguments for sampling from distribution</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a histogram of reference distribution
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("freelive2")
H0_reference(YR2)

</code></pre>

<hr>
<h2 id='H0_test'>Perform permutation or resampling tests</h2><span id='topic+H0_test'></span>

<h3>Description</h3>

<p>This function will extract data and parameter settings from a MUVR object
and run standard permutation or resampling test. This will fit a standard
case of multivariate predictive modelling in either a regression,
classification or multilevel case. However, if an analysis has a complex
sample dependency which requires constrained permutation of your response
vector or if a variable pre-selection is performed for decreased
computational burden, then permutaion/resampling loops should be constructed
manually. In those cases, View(H0_test) can be a first start from which to
build custom solutions for permutation analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>H0_test(
  MUVRclassObject,
  n = 50,
  nRep,
  nOuter,
  varRatio,
  parallel,
  type = c("resampling", "permutation")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="H0_test_+3A_muvrclassobject">MUVRclassObject</code></td>
<td>
<p>a 'MUVR' class object</p>
</td></tr>
<tr><td><code id="H0_test_+3A_n">n</code></td>
<td>
<p>number of permutations to run</p>
</td></tr>
<tr><td><code id="H0_test_+3A_nrep">nRep</code></td>
<td>
<p>number of repetitions for each permutation (defaults to value of actual model)</p>
</td></tr>
<tr><td><code id="H0_test_+3A_nouter">nOuter</code></td>
<td>
<p>number of outer validation segments for each permutation (defaults to value of actual model)</p>
</td></tr>
<tr><td><code id="H0_test_+3A_varratio">varRatio</code></td>
<td>
<p>varRatio for each permutation (defaults to value of actual model)</p>
</td></tr>
<tr><td><code id="H0_test_+3A_parallel">parallel</code></td>
<td>
<p>whether to run calculations using parallel processing which requires registered backend (defaults to parallelization for the actual model)</p>
</td></tr>
<tr><td><code id="H0_test_+3A_type">type</code></td>
<td>
<p>either permutation or resampling, to decide whether the permutation sampling is performed on original Y values or the probability(If Y categorical)/distributions(If Y continuous) of Y values</p>
</td></tr>
</table>


<h3>Value</h3>

<p>permutation_output: A permutation matrix with permuted fitness statistics (nrow=n and ncol=3 for min/mid/max)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("freelive2")
nRep &lt;- 2
nOuter &lt;- 4
varRatio &lt;-0.6
regrModel &lt;- MUVR2(X = XRVIP2,
                   Y = YR2,
                   nRep = nRep,
                  nOuter = nOuter,
                   varRatio = varRatio,
                   method = "PLS",
                   modReturn = TRUE)
H0_test(regrModel)

</code></pre>

<hr>
<h2 id='IDR'>Subject identifiers for the rye metabolomics regression tutorial</h2><span id='topic+IDR'></span>

<h3>Description</h3>

<p>Subject identifiers for the rye metabolomics regression tutorial
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(freelive)
</code></pre>

<hr>
<h2 id='IDR2'>Subject identifiers for the rye metabolomics regression tutorial, using unique individuals</h2><span id='topic+IDR2'></span>

<h3>Description</h3>

<p>Subject identifiers for the rye metabolomics regression tutorial, using unique individuals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(freelive2)
</code></pre>

<hr>
<h2 id='mergeModels'>Merge two MUVR class objects</h2><span id='topic+mergeModels'></span>

<h3>Description</h3>

<p>Merge two MUVR class objects that use regression for PLS or RF methods. The resultant MUVR class object has the same indata except that nRep is different.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mergeModels(MV1, MV2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mergeModels_+3A_mv1">MV1</code></td>
<td>
<p>a MUVR class Object</p>
</td></tr>
<tr><td><code id="mergeModels_+3A_mv2">MV2</code></td>
<td>
<p>a MUVR class Object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A merged MURV class object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("freelive2")
nRep &lt;- 2
nOuter &lt;- 4
varRatio &lt;-0.6
regrModel &lt;- MUVR2(X = XRVIP2,
                   Y = YR2,
                   nRep = nRep,
                  nOuter = nOuter,
                   varRatio = varRatio,
                   method = "PLS",
                   modReturn = TRUE)
mergedModel&lt;-mergeModels(regrModel,regrModel)

</code></pre>

<hr>
<h2 id='MUVR2'>MUVR2 with PLS and RF</h2><span id='topic+MUVR2'></span>

<h3>Description</h3>

<p>&quot;Multivariate modelling with Unbiased Variable selection&quot; using PLS and RF.
Repeated double cross validation with tuning of variables in the inner loop.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MUVR2(
  X,
  Y,
  ID,
  scale = TRUE,
  nRep = 5,
  nOuter = 6,
  nInner,
  varRatio = 0.75,
  DA = FALSE,
  fitness = c("AUROC", "MISS", "BER", "RMSEP", "wBER", "wMISS"),
  method = c("PLS", " RF", "ANN", "SVM"),
  methParam,
  ML = FALSE,
  modReturn = FALSE,
  logg = FALSE,
  parallel = TRUE,
  weigh_added = FALSE,
  weighing_matrix = NULL,
  keep,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MUVR2_+3A_x">X</code></td>
<td>
<p>Predictor variables. NB: Variables (columns) must have names/unique identifiers. NAs not allowed in data. For multilevel, only the positive half of the difference matrix is specified.</p>
</td></tr>
<tr><td><code id="MUVR2_+3A_y">Y</code></td>
<td>
<p>Response vector (Dependent variable). For classification, a factor (or character) variable should be used. For multilevel, Y is calculated automatically.</p>
</td></tr>
<tr><td><code id="MUVR2_+3A_id">ID</code></td>
<td>
<p>Subject identifier (for sampling by subject; Assumption of independence if not specified)</p>
</td></tr>
<tr><td><code id="MUVR2_+3A_scale">scale</code></td>
<td>
<p>If TRUE, the predictor variable matrix is scaled to unit variance for PLS modeling.</p>
</td></tr>
<tr><td><code id="MUVR2_+3A_nrep">nRep</code></td>
<td>
<p>Number of repetitions of double CV. (Defaults to 5)</p>
</td></tr>
<tr><td><code id="MUVR2_+3A_nouter">nOuter</code></td>
<td>
<p>Number of outer CV loop segments. (Defaults to 6)</p>
</td></tr>
<tr><td><code id="MUVR2_+3A_ninner">nInner</code></td>
<td>
<p>Number of inner CV loop segments. (Defaults to nOuter - 1)</p>
</td></tr>
<tr><td><code id="MUVR2_+3A_varratio">varRatio</code></td>
<td>
<p>Ratio of variables to include in subsequent inner loop iteration. (Defaults to 0.75)</p>
</td></tr>
<tr><td><code id="MUVR2_+3A_da">DA</code></td>
<td>
<p>Boolean for Classification (discriminant analysis) (By default, if Y is numeric -&gt; DA = FALSE. If Y is factor (or character) -&gt; DA = TRUE)</p>
</td></tr>
<tr><td><code id="MUVR2_+3A_fitness">fitness</code></td>
<td>
<p>Fitness function for model tuning (choose either 'AUROC' or 'MISS' (default) for classification; or 'RMSEP' (default) for regression.)</p>
</td></tr>
<tr><td><code id="MUVR2_+3A_method">method</code></td>
<td>
<p>Multivariate method. Supports 'PLS' and 'RF' (default)</p>
</td></tr>
<tr><td><code id="MUVR2_+3A_methparam">methParam</code></td>
<td>
<p>List with parameter settings for specified MV method (see function code for details)</p>
</td></tr>
<tr><td><code id="MUVR2_+3A_ml">ML</code></td>
<td>
<p>Boolean for multilevel analysis (defaults to FALSE)</p>
</td></tr>
<tr><td><code id="MUVR2_+3A_modreturn">modReturn</code></td>
<td>
<p>Boolean for returning outer segment models (defaults to FALSE). Setting modReturn = TRUE is required for making MUVR predictions using predMV().</p>
</td></tr>
<tr><td><code id="MUVR2_+3A_logg">logg</code></td>
<td>
<p>Boolean for whether to sink model progressions to 'log.txt'</p>
</td></tr>
<tr><td><code id="MUVR2_+3A_parallel">parallel</code></td>
<td>
<p>Boolean for whether to perform 'foreach' parallel processing (Requires a registered parallel backend; Defaults to 'TRUE')</p>
</td></tr>
<tr><td><code id="MUVR2_+3A_weigh_added">weigh_added</code></td>
<td>
<p>To add a weighing matrix when it is classfication</p>
</td></tr>
<tr><td><code id="MUVR2_+3A_weighing_matrix">weighing_matrix</code></td>
<td>
<p>The matrix used for get a miss classfication score</p>
</td></tr>
<tr><td><code id="MUVR2_+3A_keep">keep</code></td>
<td>
<p>Confounder variables can be added. NB: Variables (columns) must match column names.</p>
</td></tr>
<tr><td><code id="MUVR2_+3A_...">...</code></td>
<td>
<p>additional argument</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A 'MUVR' object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(freelive2)
nRep &lt;- 2 # Number of MUVR2 repetitions
nOuter &lt;- 3 # Number of outer cross-validation segments
varRatio &lt;- 0.6 # Proportion of variables kept per iteration
method &lt;- 'PLS' # Selected core modeling algorithm
regrModel &lt;- MUVR2(X = XRVIP2,
                   Y = YR2,
                   nRep = nRep,
                   nOuter = nOuter,
                   varRatio = varRatio,
                   method = method,
                   modReturn = TRUE)

</code></pre>

<hr>
<h2 id='MUVR2_EN'>MUVR2 with EN</h2><span id='topic+MUVR2_EN'></span>

<h3>Description</h3>

<p>&quot;Multivariate modelling with Unbiased Variable selection&quot; using Elastic Net (EN). Repeated double cross validation with tuning of variables using Elastic Net.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MUVR2_EN(
  X,
  Y,
  ID,
  alow = 1e-05,
  ahigh = 1,
  astep = 11,
  alog = TRUE,
  nRep = 5,
  nOuter = 6,
  nInner,
  NZV = TRUE,
  DA = FALSE,
  fitness = c("AUROC", "MISS", "BER", "RMSEP", "wBER", "wMISS"),
  methParam,
  ML = FALSE,
  modReturn = FALSE,
  parallel = TRUE,
  keep = NULL,
  weigh_added = FALSE,
  weighing_matrix = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MUVR2_EN_+3A_x">X</code></td>
<td>
<p>Predictor variables. NB: Variables (columns) must have names/unique identifiers. NAs not allowed in data. For multilevel, only the positive half of the difference matrix is specified.</p>
</td></tr>
<tr><td><code id="MUVR2_EN_+3A_y">Y</code></td>
<td>
<p>Response vector (Dependent variable). For classification, a factor (or character) variable should be used. For multilevel, Y is calculated automatically.</p>
</td></tr>
<tr><td><code id="MUVR2_EN_+3A_id">ID</code></td>
<td>
<p>Subject identifier (for sampling by subject; Assumption of independence if not specified)</p>
</td></tr>
<tr><td><code id="MUVR2_EN_+3A_alow">alow</code></td>
<td>
<p>alpha tuning: lowest value of alpha</p>
</td></tr>
<tr><td><code id="MUVR2_EN_+3A_ahigh">ahigh</code></td>
<td>
<p>alpha tuning: highest value of alpha</p>
</td></tr>
<tr><td><code id="MUVR2_EN_+3A_astep">astep</code></td>
<td>
<p>alpha tuning: number of alphas to try from low to high</p>
</td></tr>
<tr><td><code id="MUVR2_EN_+3A_alog">alog</code></td>
<td>
<p>alpha tuning: Whether to space tuning of alpha in logarithmic scale (TRUE; default) or normal/arithmetic scale (FALSE)</p>
</td></tr>
<tr><td><code id="MUVR2_EN_+3A_nrep">nRep</code></td>
<td>
<p>Number of repetitions of double CV. (Defaults to 5)</p>
</td></tr>
<tr><td><code id="MUVR2_EN_+3A_nouter">nOuter</code></td>
<td>
<p>Number of outer CV loop segments. (Defaults to 6)</p>
</td></tr>
<tr><td><code id="MUVR2_EN_+3A_ninner">nInner</code></td>
<td>
<p>Number of inner CV loop segments. (Defaults to nOuter-1)</p>
</td></tr>
<tr><td><code id="MUVR2_EN_+3A_nzv">NZV</code></td>
<td>
<p>Boolean for whether to filter out near zero variance variables (defaults to TRUE)</p>
</td></tr>
<tr><td><code id="MUVR2_EN_+3A_da">DA</code></td>
<td>
<p>Boolean for Classification (discriminant analysis) (By default, if Y is numeric -&gt; DA=FALSE. If Y is factor (or character) -&gt; DA=TRUE)</p>
</td></tr>
<tr><td><code id="MUVR2_EN_+3A_fitness">fitness</code></td>
<td>
<p>Fitness function for model tuning (choose either 'AUROC' or 'MISS' (default) for classification; or 'RMSEP' (default) for regression.)</p>
</td></tr>
<tr><td><code id="MUVR2_EN_+3A_methparam">methParam</code></td>
<td>
<p>List with parameter settings for specified MV method (see function code for details)</p>
</td></tr>
<tr><td><code id="MUVR2_EN_+3A_ml">ML</code></td>
<td>
<p>Boolean for multilevel analysis (defaults to FALSE)</p>
</td></tr>
<tr><td><code id="MUVR2_EN_+3A_modreturn">modReturn</code></td>
<td>
<p>Boolean for returning outer segment models (defaults to FALSE). Setting modReturn=TRUE is required for making MUVR predictions using predMV().</p>
</td></tr>
<tr><td><code id="MUVR2_EN_+3A_parallel">parallel</code></td>
<td>
<p>Boolean for whether to perform 'foreach' parallel processing (Requires a registered parallel backend; Defaults to 'TRUE')</p>
</td></tr>
<tr><td><code id="MUVR2_EN_+3A_keep">keep</code></td>
<td>
<p>A group of confounders that you want to manually set as non-zero</p>
</td></tr>
<tr><td><code id="MUVR2_EN_+3A_weigh_added">weigh_added</code></td>
<td>
<p>weigh_added</p>
</td></tr>
<tr><td><code id="MUVR2_EN_+3A_weighing_matrix">weighing_matrix</code></td>
<td>
<p>weighing_matrix</p>
</td></tr>
<tr><td><code id="MUVR2_EN_+3A_...">...</code></td>
<td>
<p>Pass additional arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A MUVR object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("freelive2")
nRep &lt;- 2 # Number of MUVR2 repetitions
nOuter &lt;- 4 # Number of outer cross-validation segments
regrModel &lt;- MUVR2_EN(X = XRVIP2,
                      Y = YR2,
                      nRep = nRep,
                      nOuter = nOuter,
                      modReturn = TRUE)

</code></pre>

<hr>
<h2 id='nearZeroVar'>Identify variables with near zero variance</h2><span id='topic+nearZeroVar'></span>

<h3>Description</h3>

<p>Adapted and stripped down from mixOmics v 5.2.0 (https://cran.r-project.org/web/packages/mixOmics/).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nearZeroVar(x, freqCut = 95/5, uniqueCut = 10)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nearZeroVar_+3A_x">x</code></td>
<td>
<p>a numeric vector or matrix, or a data frame with all numeric data.</p>
</td></tr>
<tr><td><code id="nearZeroVar_+3A_freqcut">freqCut</code></td>
<td>
<p>the cutoff for the ratio of the most common value to the second most common value.</p>
</td></tr>
<tr><td><code id="nearZeroVar_+3A_uniquecut">uniqueCut</code></td>
<td>
<p>the cutoff for the percentage of distinct values out of the number of total samples.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>nzv object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("freelive2")
nearZeroVar(XRVIP2)
data("mosquito")
nearZeroVar(Xotu)
</code></pre>

<hr>
<h2 id='onehotencoding'>One hot encoding</h2><span id='topic+onehotencoding'></span>

<h3>Description</h3>

<p>Each factor and character variable with n categories(&gt;2) will be transformed to n variables. Each factor and character variable with 2 categories will be transformed to one 01 numeric dummy variable. Each factor and character variable with 1 categories will be transformed to one numeric variable that only has value 1. Each factor and character variable with 0 categories will be transformed to one numeric variable that only has value -999. Each logical variable will be transformed to one 01 numeric dummy variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>onehotencoding(X)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="onehotencoding_+3A_x">X</code></td>
<td>
<p>data frame data with numeric, factor, character and/or logical variables</p>
</td></tr>
</table>


<h3>Value</h3>

<p>matrix with all variables transformed to numeric variables
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#To test the scenario when X has factor and character when using PLS
#add one factor and one character variable(freelive data X,
# which originally has 112 numeric samples and 1147 observations)
# factor variable has 3,6,5factors(nearzero variance), character variable has 7,4 categories
factor_variable1&lt;-as.factor(c(rep("33",105),rep("44",3),rep("55",4)))
factor_variable2&lt;-as.factor(c(rep("AB",20),rep("CD",10),rep("EF",30),
                          rep("GH",15),rep("IJ",25),rep("KL",12)))
factor_variable3&lt;-as.factor(c(rep("Tessa",25),rep("Olle",30),rep("Yan",12),
                           rep("Calle",25),rep("Elisa",20)))
factor_variable4&lt;-as.factor(c(rep(NA,112)))
character_variable1&lt;-c(rep("one",16),rep("two",16),rep("three",16),
                      rep("four",16),rep("five",16),rep("six",16),rep("seven",16))
character_variable2&lt;-c(rep("yes",28),rep("no",28),
                         rep("yes",28),rep("no",28))
character_variable3&lt;-c(rep("Hahahah",112))
character_variable4&lt;-as.character(c(rep(NA,112)))
logical_variable1&lt;-c(rep(TRUE,16),rep(FALSE,16),rep(TRUE,16),
rep(FALSE,16),rep(TRUE,16),rep(FALSE,32))
logical_variable2&lt;-c(rep(TRUE,28),rep(FALSE,28),rep(TRUE,28),rep(FALSE,28))

 X&lt;-data.frame(row.names&lt;-1:112)
 X&lt;-cbind(X,XRVIP,
       factor_variable1,factor_variable2,factor_variable3,factor_variable4,
       character_variable1,character_variable2,character_variable3,character_variable4,
        logical_variable1,logical_variable2)
  onehotencoding(X)
</code></pre>

<hr>
<h2 id='permutationPlot'>Plot permutation analysis</h2><span id='topic+permutationPlot'></span>

<h3>Description</h3>

<p>Plot permutation analysis using actual model and permutation result. This is basically a wrapper for the MUVR2::plotPerm() function using model objects to make coding nicer and cleaner.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>permutationPlot(
  MUVRclassObject,
  permutation_result,
  model = "Mid",
  type = "t",
  side = c("greater", "smaller"),
  pos,
  xlab = NULL,
  xlim,
  ylim = NULL,
  breaks = "Sturges",
  main = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="permutationPlot_+3A_muvrclassobject">MUVRclassObject</code></td>
<td>
<p>A 'MUVR' class object</p>
</td></tr>
<tr><td><code id="permutationPlot_+3A_permutation_result">permutation_result</code></td>
<td>
<p>A permutation result. It is a list of 1 items:  permutation_output</p>
</td></tr>
<tr><td><code id="permutationPlot_+3A_model">model</code></td>
<td>
<p>'Min', 'Mid', or 'Max'</p>
</td></tr>
<tr><td><code id="permutationPlot_+3A_type">type</code></td>
<td>
<p>'t' (default; for Student's t) or 'non' for &quot;non-parametric&quot; (i.e. rank) studen'ts</p>
</td></tr>
<tr><td><code id="permutationPlot_+3A_side">side</code></td>
<td>
<p>'smaller' for actual lower than H0 or 'greater' for actual larger than H0 (automatically selected if not specified)</p>
</td></tr>
<tr><td><code id="permutationPlot_+3A_pos">pos</code></td>
<td>
<p>which side of actual to put p-value on</p>
</td></tr>
<tr><td><code id="permutationPlot_+3A_xlab">xlab</code></td>
<td>
<p>optional xlabel</p>
</td></tr>
<tr><td><code id="permutationPlot_+3A_xlim">xlim</code></td>
<td>
<p>optional x-range</p>
</td></tr>
<tr><td><code id="permutationPlot_+3A_ylim">ylim</code></td>
<td>
<p>otional y-range</p>
</td></tr>
<tr><td><code id="permutationPlot_+3A_breaks">breaks</code></td>
<td>
<p>optional custom histogram breaks (defaults to 'sturges')</p>
</td></tr>
<tr><td><code id="permutationPlot_+3A_main">main</code></td>
<td>
<p>optional plot title (or TRUE for autoname)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A permutation plot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("freelive2")
nRep &lt;- 2
nOuter &lt;- 4
varRatio &lt;-0.6
regrModel &lt;- MUVR2(X = XRVIP2,
                   Y = YR2,
                   nRep = nRep,
                  nOuter = nOuter,
                   varRatio = varRatio,
                   method = "PLS",
                   modReturn = TRUE)
permutation_result&lt;-H0_test(regrModel,n=10)
permutationPlot(regrModel,permutation_result)

</code></pre>

<hr>
<h2 id='plotMV'>Plot predictions</h2><span id='topic+plotMV'></span>

<h3>Description</h3>

<p>Plot predicted and actual target variables, with different plots depending on modelling approach.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotMV(MUVRclassObject, model = "min", factCols, sampLabels, ylim = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotMV_+3A_muvrclassobject">MUVRclassObject</code></td>
<td>
<p>An MUVR class object</p>
</td></tr>
<tr><td><code id="plotMV_+3A_model">model</code></td>
<td>
<p>What type of model to plot ('min', 'mid' or 'max'). Defaults to 'mid'.</p>
</td></tr>
<tr><td><code id="plotMV_+3A_factcols">factCols</code></td>
<td>
<p>An optional vector with colors for the factor levels (in the same order as the levels)</p>
</td></tr>
<tr><td><code id="plotMV_+3A_samplabels">sampLabels</code></td>
<td>
<p>Sample labels (optional; implemented for classification)</p>
</td></tr>
<tr><td><code id="plotMV_+3A_ylim">ylim</code></td>
<td>
<p>Optional for imposing y-limits for regression and classification analysis</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot of results from multivariate predictions
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("freelive2")
nRep &lt;- 2
nOuter &lt;- 4
varRatio &lt;-0.6
regrModel &lt;- MUVR2(X = XRVIP2,
                   Y = YR2,
                   nRep = nRep,
                  nOuter = nOuter,
                   varRatio = varRatio,
                   method = "PLS",
                   modReturn = TRUE)
plotMV(regrModel, model="min")

</code></pre>

<hr>
<h2 id='plotPCA'>PCA score plot</h2><span id='topic+plotPCA'></span>

<h3>Description</h3>

<p>Customised PCA score plots with the possibility to choose PCs, exporting to png and the possibility to add color or different plotting symbols according to variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotPCA(pca, PC1 = 1, PC2 = 2, file, colVar, symbVar, main = "")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotPCA_+3A_pca">pca</code></td>
<td>
<p>A 'prcomp' object</p>
</td></tr>
<tr><td><code id="plotPCA_+3A_pc1">PC1</code></td>
<td>
<p>Principal component on x-axis</p>
</td></tr>
<tr><td><code id="plotPCA_+3A_pc2">PC2</code></td>
<td>
<p>Principal component on y-axis</p>
</td></tr>
<tr><td><code id="plotPCA_+3A_file">file</code></td>
<td>
<p>If specified provides the name of a png export file. Otherwise normal plot.</p>
</td></tr>
<tr><td><code id="plotPCA_+3A_colvar">colVar</code></td>
<td>
<p>Continuous variable for coloring observations (40 cuts)</p>
</td></tr>
<tr><td><code id="plotPCA_+3A_symbvar">symbVar</code></td>
<td>
<p>Categorical/discrete variable for multiple plot symbols</p>
</td></tr>
<tr><td><code id="plotPCA_+3A_main">main</code></td>
<td>
<p>If provided provides a main title of the plot</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A PCA score plot. Exported as png if 'file' specified in function call.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("freelive2")
pca_object&lt;-prcomp(XRVIP2)
plotPCA(pca_object)
</code></pre>

<hr>
<h2 id='plotPerm'>Plot for comparison of actual model fitness vs permutation/resampling</h2><span id='topic+plotPerm'></span>

<h3>Description</h3>

<p>Plots histogram of null hypothesis (permutation/resampling) distribution, actual model fitness and cumulative p-value.
Plot defaults to &quot;greater than&quot; or &quot;smaller than&quot; tests and cumulative probability in Student's t-distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotPerm(
  actual,
  distribution,
  xlab = NULL,
  side = c("greater", "smaller"),
  type = "t",
  ylab = NULL,
  xlim,
  ylim = NULL,
  breaks = "Sturges",
  pos,
  main = NULL,
  permutation_visual = "none",
  curve = TRUE,
  extend = 0.1,
  multiple_p_shown = NULL,
  show_actual_value = TRUE,
  show_p = TRUE,
  round_number = 4
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotPerm_+3A_actual">actual</code></td>
<td>
<p>Actual model fitness (e.g. Q2, AUROC or number of misclassifications)</p>
</td></tr>
<tr><td><code id="plotPerm_+3A_distribution">distribution</code></td>
<td>
<p>Null hypothesis (permutation) distribution of similar metric as 'actual'</p>
</td></tr>
<tr><td><code id="plotPerm_+3A_xlab">xlab</code></td>
<td>
<p>Label for x-axis (e.g. 'Q2 using real value',&quot;Q2 using distributions&quot;,&quot;BER&quot; 'AUROC', or 'Misclassifications')</p>
</td></tr>
<tr><td><code id="plotPerm_+3A_side">side</code></td>
<td>
<p>Cumulative p either &quot;greater&quot; or &quot;smaller&quot; than H0 distribution (defaults to side of median(H0))</p>
</td></tr>
<tr><td><code id="plotPerm_+3A_type">type</code></td>
<td>
<p>c('t','non',&quot;smooth&quot;,&quot;rank&quot;,&quot;ecdf&quot;)</p>
</td></tr>
<tr><td><code id="plotPerm_+3A_ylab">ylab</code></td>
<td>
<p>label for y-axis</p>
</td></tr>
<tr><td><code id="plotPerm_+3A_xlim">xlim</code></td>
<td>
<p>Choice of user-specified x-limits (if default is not adequate)</p>
</td></tr>
<tr><td><code id="plotPerm_+3A_ylim">ylim</code></td>
<td>
<p>Choice of user-specified y-limits (if default is not adequate)</p>
</td></tr>
<tr><td><code id="plotPerm_+3A_breaks">breaks</code></td>
<td>
<p>Choice of user-specified histogram breaks (if default is not adequate)</p>
</td></tr>
<tr><td><code id="plotPerm_+3A_pos">pos</code></td>
<td>
<p>Choice of position of p-value label (if default is not adequate)</p>
</td></tr>
<tr><td><code id="plotPerm_+3A_main">main</code></td>
<td>
<p>Choice of user-specified plot title</p>
</td></tr>
<tr><td><code id="plotPerm_+3A_permutation_visual">permutation_visual</code></td>
<td>
<p>choice of showing median or mean or none</p>
</td></tr>
<tr><td><code id="plotPerm_+3A_curve">curve</code></td>
<td>
<p>if add curve or not base on the mid</p>
</td></tr>
<tr><td><code id="plotPerm_+3A_extend">extend</code></td>
<td>
<p>how many percenrtage of the orignical range do we start</p>
</td></tr>
<tr><td><code id="plotPerm_+3A_multiple_p_shown">multiple_p_shown</code></td>
<td>
<p>show many p values</p>
</td></tr>
<tr><td><code id="plotPerm_+3A_show_actual_value">show_actual_value</code></td>
<td>
<p>show the actual value on the vertical line or not</p>
</td></tr>
<tr><td><code id="plotPerm_+3A_show_p">show_p</code></td>
<td>
<p>if p value is added to the figure</p>
</td></tr>
<tr><td><code id="plotPerm_+3A_round_number">round_number</code></td>
<td>
<p>How many digits does it keep</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Plot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("freelive2")
actual &lt;- sample(YR2, 1)
distribution &lt;- YR2
plotPerm (actual, distribution)
</code></pre>

<hr>
<h2 id='plotPred'>Plot predictions for PLS regression</h2><span id='topic+plotPred'></span>

<h3>Description</h3>

<p>At present, this function only supports predictions for PLS regression type problems.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotPred(Ytrue, Ypreds)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotPred_+3A_ytrue">Ytrue</code></td>
<td>
<p>True value of Y, should be a vector</p>
</td></tr>
<tr><td><code id="plotPred_+3A_ypreds">Ypreds</code></td>
<td>
<p>Predicted value of Y can be a vector or data frame with the same number of rows</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot, plot the prediction
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("freelive2")
Ytrue&lt;-YR2
Ypreds&lt;-sampling_from_distribution(YR2)
plotPred(Ytrue,Ypreds)
Ytrue&lt;-YR2
nRep &lt;- 2
nOuter &lt;- 4
varRatio &lt;-0.6
regrModel &lt;- MUVR2(X = XRVIP2,
                   Y = YR2,
                   nRep = nRep,
                   nOuter = nOuter,
                   varRatio = varRatio,
                   method = "PLS",
                   modReturn = TRUE)
Ypreds&lt;-regrModel$yPred
plotPred(Ytrue,Ypreds)

</code></pre>

<hr>
<h2 id='plotStability'>Plot stability</h2><span id='topic+plotStability'></span>

<h3>Description</h3>

<p>Plot stability of selected variables and prediction fitness as a function of number of repetitions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotStability(MUVRrdCVclassObject, model = "min", VAll, nVarLim, missLim)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotStability_+3A_muvrrdcvclassobject">MUVRrdCVclassObject</code></td>
<td>
<p>MUVR class object or rdCV object</p>
</td></tr>
<tr><td><code id="plotStability_+3A_model">model</code></td>
<td>
<p>'min' (default), 'mid' or 'max'</p>
</td></tr>
<tr><td><code id="plotStability_+3A_vall">VAll</code></td>
<td>
<p>Option of specifying which variables (i.e. names) to consider as reference set.
Defaults to variables selected from the 'model' of the 'MUVRrdCVclassObject'</p>
</td></tr>
<tr><td><code id="plotStability_+3A_nvarlim">nVarLim</code></td>
<td>
<p>Option of specifying upper limit for number of variables</p>
</td></tr>
<tr><td><code id="plotStability_+3A_misslim">missLim</code></td>
<td>
<p>Option of specifying upper limit for number of misclassifications</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Plot of number of variables, proportion of variables overlapping with reference and prediction accuracy (Q2 for regression; MISS otherwise) as a function of number of repetitions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("freelive2")
nRep &lt;- 2
nOuter &lt;- 4
varRatio &lt;-0.6
regrModel &lt;- MUVR2(X = XRVIP2,
                   Y = YR2,
                   nRep = nRep,
                  nOuter = nOuter,
                   varRatio = varRatio,
                   method = "PLS",
                   modReturn = TRUE)
plotStability(regrModel, model = "min")

</code></pre>

<hr>
<h2 id='plotVAL'>Plot validation metric</h2><span id='topic+plotVAL'></span>

<h3>Description</h3>

<p>Produces a plot of validation metric vs number of variables in model (inner segment).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotVAL(MUVRclassObject, show_outlier = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotVAL_+3A_muvrclassobject">MUVRclassObject</code></td>
<td>
<p>An object of class 'MUVR'</p>
</td></tr>
<tr><td><code id="plotVAL_+3A_show_outlier">show_outlier</code></td>
<td>
<p>Boolean, show outliers</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("freelive2")
nRep &lt;- 2
nOuter &lt;- 4
varRatio &lt;-0.6
regrModel &lt;- MUVR2(X = XRVIP2,
                   Y = YR2,
                   nRep = nRep,
                  nOuter = nOuter,
                   varRatio = varRatio,
                   method = "PLS",
                   modReturn = TRUE)
plotVAL(regrModel)

</code></pre>

<hr>
<h2 id='plotVIRank'>Plot variable importance ranking</h2><span id='topic+plotVIRank'></span>

<h3>Description</h3>

<p>Plot variable importance ranking in MUVR object. Regardless of MV core method, variables are sorted by rank, where lower is better.
'plotVIRank' produces boxplots of variable rankings for all model repetitions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotVIRank(
  MUVRclassObject,
  n,
  model = "min",
  cut,
  maptype = c("heatmap", "dotplot"),
  add_blank = 4,
  cextext = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotVIRank_+3A_muvrclassobject">MUVRclassObject</code></td>
<td>
<p>An MUVR class object only applied to PLS, RF not rdCVnet</p>
</td></tr>
<tr><td><code id="plotVIRank_+3A_n">n</code></td>
<td>
<p>Number of top ranking variables to plot (defaults to those selected by MUVR2)</p>
</td></tr>
<tr><td><code id="plotVIRank_+3A_model">model</code></td>
<td>
<p>Which model to choose ('min', 'mid' (default) or 'max')</p>
</td></tr>
<tr><td><code id="plotVIRank_+3A_cut">cut</code></td>
<td>
<p>Optional value to cut length of variable names to 'cut' number of characters</p>
</td></tr>
<tr><td><code id="plotVIRank_+3A_maptype">maptype</code></td>
<td>
<p>for rdCvnet dot plot or heat map</p>
</td></tr>
<tr><td><code id="plotVIRank_+3A_add_blank">add_blank</code></td>
<td>
<p>put more blank when the rownames is too long,</p>
</td></tr>
<tr><td><code id="plotVIRank_+3A_cextext">cextext</code></td>
<td>
<p>the cex of the text</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Barplot of variable rankings (lower is better)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("freelive2")
nRep &lt;- 2
nOuter &lt;- 4
varRatio &lt;-0.6
regrModel &lt;- MUVR2(X = XRVIP2,
                   Y = YR2,
                   nRep = nRep,
                  nOuter = nOuter,
                   varRatio = varRatio,
                   method = "PLS",
                   modReturn = TRUE)
plotVIRank(regrModel, n=20)

</code></pre>

<hr>
<h2 id='pPerm'>Calculate permutation p-value
Calculate perutation p-value of actual model performance vs null hypothesis distribution.
'pPerm' will calculate the cumulative (1-tailed) probability of 'actual' belonging to 'permutation_distribution'.
'side' is guessed by actual value compared to median(permutation_distribution).
Test is performed on original data OR ranked for non-parametric statistics.</h2><span id='topic+pPerm'></span>

<h3>Description</h3>

<p>Calculate permutation p-value
Calculate perutation p-value of actual model performance vs null hypothesis distribution.
'pPerm' will calculate the cumulative (1-tailed) probability of 'actual' belonging to 'permutation_distribution'.
'side' is guessed by actual value compared to median(permutation_distribution).
Test is performed on original data OR ranked for non-parametric statistics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pPerm(
  actual,
  permutation_distribution,
  side = c("smaller", "greater"),
  type = "t",
  extend = 0.1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pPerm_+3A_actual">actual</code></td>
<td>
<p>Actual model performance (e.g. misclassifications or Q2)</p>
</td></tr>
<tr><td><code id="pPerm_+3A_permutation_distribution">permutation_distribution</code></td>
<td>
<p>Null hypothesis distribution from permutation test (same metric as 'actual')</p>
</td></tr>
<tr><td><code id="pPerm_+3A_side">side</code></td>
<td>
<p>Smaller or greater than (automatically guessed if omitted) (Q2 and AUC is a &quot;greater than&quot; test, whereas misclassifications is &quot;smaller than&quot;)</p>
</td></tr>
<tr><td><code id="pPerm_+3A_type">type</code></td>
<td>
<p>one of ('t','non',&quot;smooth&quot;,&quot;ecdf&quot;,&quot;rank&quot;)</p>
</td></tr>
<tr><td><code id="pPerm_+3A_extend">extend</code></td>
<td>
<p>extend how much it extend</p>
</td></tr>
</table>


<h3>Value</h3>

<p>p-value
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("freelive2")
actual &lt;- sample(YR2, 1)
permutation_distribution &lt;- YR2
pPerm(actual, permutation_distribution)
</code></pre>

<hr>
<h2 id='predMV'>Predict outcomes 
Predict MV object using a MUVR class object and a X testing set. At present, this function only supports predictions for PLS regression type problems.</h2><span id='topic+predMV'></span>

<h3>Description</h3>

<p>Predict outcomes 
Predict MV object using a MUVR class object and a X testing set. At present, this function only supports predictions for PLS regression type problems.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predMV(MUVRclassobject, newdata, model = "min")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predMV_+3A_muvrclassobject">MUVRclassobject</code></td>
<td>
<p>An 'MUVR' class object</p>
</td></tr>
<tr><td><code id="predMV_+3A_newdata">newdata</code></td>
<td>
<p>New data for which to predict outcomes</p>
</td></tr>
<tr><td><code id="predMV_+3A_model">model</code></td>
<td>
<p>What type of model to plot ('min', 'mid' or 'max'). Defaults to 'mid'.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The predicted result based on the MUVR model and the newdata
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("freelive2")
nRep &lt;- 2
nOuter &lt;- 4
varRatio &lt;-0.6
regrModel &lt;- MUVR2(X = XRVIP2,
                   Y = YR2,
                   nRep = nRep,
                   nOuter = nOuter,
                   varRatio = varRatio,
                   method = "PLS",
                   modReturn=TRUE)
predMV(regrModel,XRVIP2)

</code></pre>

<hr>
<h2 id='preProcess'>Perform matrix pre-processing</h2><span id='topic+preProcess'></span>

<h3>Description</h3>

<p>Perform matrix pre-processing
</p>


<h3>Usage</h3>

<pre><code class='language-R'>preProcess(
  X,
  offset = 0,
  zeroOffset = 0,
  trans = "none",
  center = "none",
  scale = "none"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="preProcess_+3A_x">X</code></td>
<td>
<p>Data matrix with samples in rows and variables in columns</p>
</td></tr>
<tr><td><code id="preProcess_+3A_offset">offset</code></td>
<td>
<p>Add offset to all data points (defaults to 0)</p>
</td></tr>
<tr><td><code id="preProcess_+3A_zerooffset">zeroOffset</code></td>
<td>
<p>Add offset to zero data (defaults to 0)</p>
</td></tr>
<tr><td><code id="preProcess_+3A_trans">trans</code></td>
<td>
<p>Either 'log', 'sqrt' or 'none' (default is 'none')</p>
</td></tr>
<tr><td><code id="preProcess_+3A_center">center</code></td>
<td>
<p>Either 'mean', 'none' or a numeric vector of length equal to the number of columns of X (defaults to 'none').</p>
</td></tr>
<tr><td><code id="preProcess_+3A_scale">scale</code></td>
<td>
<p>Either 'UV', 'Pareto', 'none' or a numeric vector of length equal to the number of columns of X (defaults to 'none').</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A pre-processed data matrix
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("freelive2")
preProcess(XRVIP2)
</code></pre>

<hr>
<h2 id='Q2_calculation'>Q2 calculation</h2><span id='topic+Q2_calculation'></span>

<h3>Description</h3>

<p>Q2 calculation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Q2_calculation(yhat, y)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Q2_calculation_+3A_yhat">yhat</code></td>
<td>
<p>prediction values</p>
</td></tr>
<tr><td><code id="Q2_calculation_+3A_y">y</code></td>
<td>
<p>real values</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Q2
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("freelive2")
actual &lt;- YR2
predicted &lt;- MUVR2::sampling_from_distribution(actual)
Q2_calculation(actual, predicted)
</code></pre>

<hr>
<h2 id='qMUVR2'>Wrapper for speedy access to MUVR2 (autosetup of parallelization)</h2><span id='topic+qMUVR2'></span>

<h3>Description</h3>

<p>Wrapper for speedy access to MUVR2 (autosetup of parallelization)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qMUVR2(
  X,
  Y,
  ML = FALSE,
  method = "RF",
  varRatio = 0.65,
  nCore,
  repMult = 1,
  nOuter = 5,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="qMUVR2_+3A_x">X</code></td>
<td>
<p>X-data</p>
</td></tr>
<tr><td><code id="qMUVR2_+3A_y">Y</code></td>
<td>
<p>Y-data</p>
</td></tr>
<tr><td><code id="qMUVR2_+3A_ml">ML</code></td>
<td>
<p>Boolean for multilevel</p>
</td></tr>
<tr><td><code id="qMUVR2_+3A_method">method</code></td>
<td>
<p>'RF' (default) or 'PLS'</p>
</td></tr>
<tr><td><code id="qMUVR2_+3A_varratio">varRatio</code></td>
<td>
<p>proportion of variables to keep in each loop of the recursive feature elimination</p>
</td></tr>
<tr><td><code id="qMUVR2_+3A_ncore">nCore</code></td>
<td>
<p>Number of threads to use for calculation (defaults to detectCores()-1)</p>
</td></tr>
<tr><td><code id="qMUVR2_+3A_repmult">repMult</code></td>
<td>
<p>Multiplier of cores -&gt; nRep = repMult * nCore</p>
</td></tr>
<tr><td><code id="qMUVR2_+3A_nouter">nOuter</code></td>
<td>
<p>Number of outer segments</p>
</td></tr>
<tr><td><code id="qMUVR2_+3A_...">...</code></td>
<td>
<p>Additional arguments(see MUVR)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>MUVR object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("freelive2")
regrModel &lt;- qMUVR2(X = XRVIP2,
                    Y = YR2,
                    nCore = 1)

</code></pre>

<hr>
<h2 id='rdCV'>Wrapper for repeated double cross-validation without variable selection</h2><span id='topic+rdCV'></span>

<h3>Description</h3>

<p>Wrapper for repeated double cross-validation without variable selection
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rdCV(
  X,
  Y,
  ID,
  nRep = 5,
  nOuter = 6,
  nInner,
  DA = FALSE,
  fitness = c("AUROC", "MISS", "RMSEP", "BER"),
  method = c("PLS", "RF"),
  methParam,
  ML = FALSE,
  modReturn = FALSE,
  logg = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rdCV_+3A_x">X</code></td>
<td>
<p>Independent variables. NB: Variables (columns) must have names/unique identifiers. NAs not allowed in data. For ML, X is upper half only (X1-X2)</p>
</td></tr>
<tr><td><code id="rdCV_+3A_y">Y</code></td>
<td>
<p>Response vector (Dependent variable). For DA (classification), Y should be factor or character. For ML, Y is omitted. For regression, Y is numeric.</p>
</td></tr>
<tr><td><code id="rdCV_+3A_id">ID</code></td>
<td>
<p>Subject identifier (for sampling by subject; Assumption of independence if not specified)</p>
</td></tr>
<tr><td><code id="rdCV_+3A_nrep">nRep</code></td>
<td>
<p>Number of repetitions of double CV.</p>
</td></tr>
<tr><td><code id="rdCV_+3A_nouter">nOuter</code></td>
<td>
<p>Number of outer CV loop segments.</p>
</td></tr>
<tr><td><code id="rdCV_+3A_ninner">nInner</code></td>
<td>
<p>Number of inner CV loop segments.</p>
</td></tr>
<tr><td><code id="rdCV_+3A_da">DA</code></td>
<td>
<p>Logical for Classification (discriminant analysis) (Defaults do FALSE, i.e. regression). PLS is limited to two-class problems (see 'Y' above).</p>
</td></tr>
<tr><td><code id="rdCV_+3A_fitness">fitness</code></td>
<td>
<p>Fitness function for model tuning (choose either 'AUROC' or 'MISS'or 'BER' for classification; or 'RMSEP' (default) for regression.)</p>
</td></tr>
<tr><td><code id="rdCV_+3A_method">method</code></td>
<td>
<p>Multivariate method. Supports 'PLS' and 'RF' (default)</p>
</td></tr>
<tr><td><code id="rdCV_+3A_methparam">methParam</code></td>
<td>
<p>List with parameter settings for specified MV method (defaults to ???)</p>
</td></tr>
<tr><td><code id="rdCV_+3A_ml">ML</code></td>
<td>
<p>Logical for multilevel analysis (defaults to FALSE)</p>
</td></tr>
<tr><td><code id="rdCV_+3A_modreturn">modReturn</code></td>
<td>
<p>Logical for returning outer segment models (defaults to FALSE)</p>
</td></tr>
<tr><td><code id="rdCV_+3A_logg">logg</code></td>
<td>
<p>Logical for whether to sink model progressions to 'log.txt'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object containing stuff...
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("freelive2")
nRep &lt;- 2 # Number of MUVR2 repetitions
nOuter &lt;- 4 # Number of outer cross-validation segments
varRatio &lt;- 0.75 # Proportion of variables kept per iteration
method &lt;- 'RF' # Selected core modeling algorithm
regrModel &lt;- rdCV(X = XRVIP2,
                  Y = YR2,
                  nRep = nRep,
                  nOuter = nOuter,
                  method = method,
                  modReturn=TRUE)

</code></pre>

<hr>
<h2 id='rdcvNetParams'>Make custom parameters for rdcvNet internal modelling</h2><span id='topic+rdcvNetParams'></span>

<h3>Description</h3>

<p>Custom parameters can be set in the function call or by manually setting &quot;slots&quot; in the resulting methParam object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rdcvNetParams(
  robust = 0.05,
  family = "gaussian",
  nRepInner = 1,
  NZV = TRUE,
  oneHot = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rdcvNetParams_+3A_robust">robust</code></td>
<td>
<p>Robustness (slack) criterion for determining min and max knees (defaults to 0.05)</p>
</td></tr>
<tr><td><code id="rdcvNetParams_+3A_family">family</code></td>
<td>
<p>the options could be &quot;gaussian&quot;, &quot;binomial&quot;, &quot;poisson&quot;, &quot;multinomial&quot;, &quot;cox&quot;, &quot;mgaussian&quot;</p>
</td></tr>
<tr><td><code id="rdcvNetParams_+3A_nrepinner">nRepInner</code></td>
<td>
<p>how many nRepInner</p>
</td></tr>
<tr><td><code id="rdcvNetParams_+3A_nzv">NZV</code></td>
<td>
<p>NZV</p>
</td></tr>
<tr><td><code id="rdcvNetParams_+3A_onehot">oneHot</code></td>
<td>
<p>TRUE or FALSE using onehot endcoding or not</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a 'methParam' object
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Standard parameters for rdcvNet
methParam &lt;- rdcvNetParams()
</code></pre>

<hr>
<h2 id='sampling_from_distribution'>Sampling from the distribution of something</h2><span id='topic+sampling_from_distribution'></span>

<h3>Description</h3>

<p>Sampling from the distribution of something
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sampling_from_distribution(X, upperlimit, lowerlimit, extend, n)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sampling_from_distribution_+3A_x">X</code></td>
<td>
<p>a vector (numeric or factor) where the distribution/probility will be generated</p>
</td></tr>
<tr><td><code id="sampling_from_distribution_+3A_upperlimit">upperlimit</code></td>
<td>
<p>if X is numeric, set upper limit</p>
</td></tr>
<tr><td><code id="sampling_from_distribution_+3A_lowerlimit">lowerlimit</code></td>
<td>
<p>if X is numeric, set lower limit</p>
</td></tr>
<tr><td><code id="sampling_from_distribution_+3A_extend">extend</code></td>
<td>
<p>If X is numeric, how much you want to extend from the lower and upper existing X.</p>
</td></tr>
<tr><td><code id="sampling_from_distribution_+3A_n">n</code></td>
<td>
<p>How many you want to sample</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a resampled thing
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("mosquito")
sampling_from_distribution(Yotu)
data("freelive2")
sampling_from_distribution(YR2,
                           upperlimit=200,
                           lowerlimit=0,
                           n=length(YR2)
                           )
</code></pre>

<hr>
<h2 id='varClass'>Report variables belonging to different classes</h2><span id='topic+varClass'></span>

<h3>Description</h3>

<p>Reports names and numbers of variables: all as well as optimal (min model), redundant (from min up to max) and noisy (the rest).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>varClass(MUVRclassObject)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="varClass_+3A_muvrclassobject">MUVRclassObject</code></td>
<td>
<p>A MUVR class object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with names and numbers of variables: all as well as optimal (Corresponding to 'min' or minial-optimal model),
redundant (from 'min' up to 'max' or all-relevant ) and noisy (the rest)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("mosquito")
nRep &lt;- 2
nOuter &lt;- 4
classModel &lt;- MUVR2_EN(X = Xotu,
                       Y = Yotu,
                       nRep = nRep,
                       nOuter = nOuter,
                       DA = TRUE,
                       modReturn = TRUE)
classModel&lt;-getVar(classModel,option="quantile")
varClass(classModel)


</code></pre>

<hr>
<h2 id='Xotu'>Microbiota composition in mosquitos for the classification tutorial</h2><span id='topic+Xotu'></span>

<h3>Description</h3>

<p>Microbiota composition in mosquitos for the classification tutorial
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(mosquito)
</code></pre>

<hr>
<h2 id='XRVIP'>Metabolomics data for the rye metabolomics regression tutorial</h2><span id='topic+XRVIP'></span>

<h3>Description</h3>

<p>Metabolomics data for the rye metabolomics regression tutorial
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(freelive)
</code></pre>

<hr>
<h2 id='XRVIP2'>Metabolomics data for the rye metabolomics regression tutorial, using unique individuals</h2><span id='topic+XRVIP2'></span>

<h3>Description</h3>

<p>Metabolomics data for the rye metabolomics regression tutorial, using unique individuals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(freelive2)
</code></pre>

<hr>
<h2 id='Yotu'>Village of capture of mosquitos for the classification tutorial</h2><span id='topic+Yotu'></span>

<h3>Description</h3>

<p>Village of capture of mosquitos for the classification tutorial
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(mosquito)
</code></pre>

<hr>
<h2 id='YR'>Rye consumption for the rye metabolomics regression tutorial</h2><span id='topic+YR'></span>

<h3>Description</h3>

<p>Rye consumption for the rye metabolomics regression tutorial
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(freelive)
</code></pre>

<hr>
<h2 id='YR2'>Rye consumption for the rye metabolomics regression tutorial, using unique individuals</h2><span id='topic+YR2'></span>

<h3>Description</h3>

<p>Rye consumption for the rye metabolomics regression tutorial, using unique individuals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(freelive2)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
