<!DOCTYPE html><html lang="en"><head><title>Help for package SynergyLMM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SynergyLMM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#+25+26gt+3B+25'><p>Pipe operator</p></a></li>
<li><a href='#APrioriPwr'><p><em>A Priori</em> Synergy Power Analysis Based on Variability and Drug Effect</p></a></li>
<li><a href='#CookDistance'><p>Cook's distance for the coefficient estimates</p></a></li>
<li><a href='#getRTV'><p>Helper function to calculate the relative tumor volume from an imput data frame of tumor growth</p></a></li>
<li><a href='#grwth_data'><p>Example Tumor Growth Data</p></a></li>
<li><a href='#lmmModel'><p>Linear Mixed Effect Model for Tumor Growth</p></a></li>
<li><a href='#lmmModel_estimates'><p>Get estimates from a linear mixed model of tumor growth data</p></a></li>
<li><a href='#lmmSynergy'><p>Synergy calculation using linear-mixed models</p></a></li>
<li><a href='#logLikSubjectDisplacements'><p>Likelihood displacements for the model</p></a></li>
<li><a href='#ObsvsPred'><p>Observed vs predicted values and performance of the model</p></a></li>
<li><a href='#plot_lmmModel'><p>Plotting of tumor growth data from a fitted model</p></a></li>
<li><a href='#plot_lmmSynergy'><p>Plotting synergy results</p></a></li>
<li><a href='#plot_ObsvsPred'><p>Plots of Observed vs Predicted Values</p></a></li>
<li><a href='#plot_ranefDiagnostics'><p>Plots for random effects diagnostics</p></a></li>
<li><a href='#plot_residDiagnostics'><p>Plots for residuals diagnostics</p></a></li>
<li><a href='#plot_SynergyLMM'><p>Plotting SynergyLMM results</p></a></li>
<li><a href='#PostHocPwr'><p>Post hoc power calculation based on simulations of the synergy evaluation using LMM.</p></a></li>
<li><a href='#Pwr'><p>Calculates power based on a model fit</p></a></li>
<li><a href='#Pwr.lme'><p>Performs power calculations</p></a></li>
<li><a href='#PwrSampleSize'><p><em>A Priori</em> Synergy Power Analysis Based on Sample Size</p></a></li>
<li><a href='#PwrTime'><p><em>A Priori</em> Synergy Power Analysis Based on Time</p></a></li>
<li><a href='#ranefDiagnostics'><p>Diagnostics of random effects of the linear mixed model</p></a></li>
<li><a href='#residDiagnostics'><p>Diagnostics of residuals of the linear mixed model</p></a></li>
<li><a href='#simulateTumorGrowth'><p>Helper function to simulate tumor growth data for a two-drug combination experiment.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Statistical Framework for in Vivo Drug Combination Studies</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Description:</td>
<td>A framework for evaluating drug combination effects in preclinical in vivo studies.
    'SynergyLMM' provides functions to analyze longitudinal tumor growth experiments using linear mixed-effects models, 
    perform time-dependent analyses of synergy and antagonism, evaluate model diagnostics and performance, 
    and assess both post-hoc and a priori statistical power.
    The calculation of drug combination synergy follows the statistical framework provided by Demidenko and Miller (2019, &lt;<a href="https://doi.org/10.1371%2Fjournal.pone.0224137">doi:10.1371/journal.pone.0224137</a>&gt;).
    The implementation and analysis of linear mixed-effect models is based on the methods described by Pinheiro and Bates (2000, &lt;<a href="https://doi.org/10.1007%2Fb98882">doi:10.1007/b98882</a>&gt;),
    and Ga≈Çecki and Burzykowski (2013, &lt;<a href="https://doi.org/10.1007%2F978-1-4614-3900-4">doi:10.1007/978-1-4614-3900-4</a>&gt;).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Imports:</td>
<td>magrittr (&ge; 2.0.3), rlang, dplyr (&ge; 1.1.4), ggplot2 (&ge;
3.5.1), cowplot (&ge; 1.1.3), nlme (&ge; 3.1-165), nlmeU, fBasics,
car, MASS, performance, lattice, marginaleffects, clubSandwich</td>
</tr>
<tr>
<td>Suggests:</td>
<td>lme4, knitr, rmarkdown, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/RafRomB/SynergyLMM">https://github.com/RafRomB/SynergyLMM</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/RafRomB/SynergyLMM/issues">https://github.com/RafRomB/SynergyLMM/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-02-07 15:39:59 UTC; rafrombec</td>
</tr>
<tr>
<td>Author:</td>
<td>Rafael Romero-Becerra
    <a href="https://orcid.org/0000-0003-3935-2647"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  Zhi Zhao [ctb],
  Tero Aittokallio [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Rafael Romero-Becerra &lt;r.r.becerra@medisin.uio.no&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-02-07 18:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='+25+26gt+3B+25'>Pipe operator</h2><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>See <code>magrittr::<a href="magrittr.html#topic+pipe">%&gt;%</a></code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lhs %&gt;% rhs
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_lhs">lhs</code></td>
<td>
<p>A value or the magrittr placeholder.</p>
</td></tr>
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_rhs">rhs</code></td>
<td>
<p>A function call using the magrittr semantics.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The result of calling <code>rhs(lhs)</code>.
</p>

<hr>
<h2 id='APrioriPwr'><em>A Priori</em> Synergy Power Analysis Based on Variability and Drug Effect</h2><span id='topic+APrioriPwr'></span>

<h3>Description</h3>

<p><em>A priori</em> power calculation for a hypothetical two-drugs combination study of synergy using linear-mixed models
with varying drug combination effect and/or experimental variability.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>APrioriPwr(
  npg = 5,
  time = c(0, 3, 5, 10),
  grwrControl = 0.08,
  grwrA = 0.07,
  grwrB = 0.06,
  grwrComb = 0.03,
  sd_ranef = 0.01,
  sgma = 0.1,
  sd_eval = NULL,
  sgma_eval = NULL,
  grwrComb_eval = NULL,
  method = "Bliss",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="APrioriPwr_+3A_npg">npg</code></td>
<td>
<p>Number of subjects per group.</p>
</td></tr>
<tr><td><code id="APrioriPwr_+3A_time">time</code></td>
<td>
<p>Vector with the times at which the tumor volume measurements have been performed.</p>
</td></tr>
<tr><td><code id="APrioriPwr_+3A_grwrcontrol">grwrControl</code></td>
<td>
<p>Coefficient for Control treatment group tumor growth rate.</p>
</td></tr>
<tr><td><code id="APrioriPwr_+3A_grwra">grwrA</code></td>
<td>
<p>Coefficient for Drug A treatment group tumor growth rate.</p>
</td></tr>
<tr><td><code id="APrioriPwr_+3A_grwrb">grwrB</code></td>
<td>
<p>Coefficient for Drug B treatment group tumor growth rate.</p>
</td></tr>
<tr><td><code id="APrioriPwr_+3A_grwrcomb">grwrComb</code></td>
<td>
<p>Coefficient for Combination (Drug A + Drug B) treatment group tumor growth rate.</p>
</td></tr>
<tr><td><code id="APrioriPwr_+3A_sd_ranef">sd_ranef</code></td>
<td>
<p>Random effects standard deviation (between-subject variance) for the model.</p>
</td></tr>
<tr><td><code id="APrioriPwr_+3A_sgma">sgma</code></td>
<td>
<p>Residuals standard deviation (within-subject variance) for the model.</p>
</td></tr>
<tr><td><code id="APrioriPwr_+3A_sd_eval">sd_eval</code></td>
<td>
<p>A vector with values representing the standard deviations of random effects,
through which the power for synergy calculation will be evaluated.</p>
</td></tr>
<tr><td><code id="APrioriPwr_+3A_sgma_eval">sgma_eval</code></td>
<td>
<p>A vector with values representing the standard deviations of the residuals,
through which the power for synergy calculation will be evaluated.</p>
</td></tr>
<tr><td><code id="APrioriPwr_+3A_grwrcomb_eval">grwrComb_eval</code></td>
<td>
<p>A vector with values representing the coefficients for Combination treatment group tumor growth rate,
through which the power for synergy calculation will be evaluated.</p>
</td></tr>
<tr><td><code id="APrioriPwr_+3A_method">method</code></td>
<td>
<p>String indicating the method for synergy calculation. Possible methods are &quot;Bliss&quot; and &quot;HSA&quot;,
corresponding to Bliss and highest single agent, respectively.</p>
</td></tr>
<tr><td><code id="APrioriPwr_+3A_...">...</code></td>
<td>
<p>Additional parameters to be passed to <a href="nlmeU.html#topic+Pwr.lme">nlmeU::Pwr.lme</a> method.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>APrioriPwr</code> allows for total customization of an hypothetical drug combination study and allows the user
to define several experimental parameters, such as the sample size, time of measurements, or drug effect,
for the power evaluation of synergy for Bliss and HSA reference models. The power calculation is
based on F-tests of the fixed effects of the model as previously described (Helms, R. W. (1992),
Verbeke and Molenberghs (2009), Ga≈Çecki and Burzykowski (2013)).
</p>
<p>The focus the power analysis with <code>APrioriPwr</code> is on the <strong>drug combination effect</strong> and the <strong>variability</strong> in the
experiment. For other <em>a priori</em> power analysis see also <code><a href="#topic+PwrSampleSize">PwrSampleSize()</a></code> and <code><a href="#topic+PwrTime">PwrTime()</a></code>.
</p>

<ul>
<li> <p><code>npg</code>, <code>time</code>, <code>grwrControl</code>, <code>grwrA</code>, <code>grwrB</code>, <code>grwrComb</code>, <code>sd_ranef</code> and <code>sgma</code> are parameters referring to
the initial exemplary data set and corresponding fitted model. These values can be obtained from a fitted model, using <code><a href="#topic+lmmModel_estimates">lmmModel_estimates()</a></code>,
or be defined by the user.
</p>
</li>
<li> <p><code>sd_eval</code>, <code>sgma_eval</code>, and <code>grwrComb_eval</code> are the different values that will be modified in the initial
exemplary data set to fit the corresponding model and calculate the power.
</p>
</li></ul>



<h3>Value</h3>

<p>The functions returns several plots:
</p>

<ul>
<li><p> A plot representing the hypothetical data, with the regression lines for each
treatment group according to <code>grwrControl</code>, <code>grwrA</code>, <code>grwrB</code> and <code>grwrComb</code> values. The values
assigned to <code>sd_ranef</code> and <code>sgma</code> are also shown.
</p>
</li>
<li><p> A plot showing the values of the power calculation depending on the values assigned to
<code>sd_eval</code> and <code>sgma_eval</code>. The power result corresponding to the values assigned to <code>sd_ranef</code> and
<code>sgma</code> is shown with a red dot.
</p>
</li>
<li><p> A plot showing the values of the power calculation depending on the values assigned to
<code>grwrComb_eval</code>. The vertical dashed line indicates the value of <code>grwrComb</code>. The horizontal
line indicates the power of 0.80.
</p>
</li></ul>

<p>The statistical power for the fitted model for the initial data set according to the values given by
<code>npg</code>, <code>time</code>, <code>grwrControl</code>, <code>grwrA</code>, <code>grwrB</code>, <code>grwrComb</code>, <code>sd_ranef</code> and <code>sgma</code> is also shown in the console.
</p>


<h3>References</h3>


<ul>
<li><p> Helms, R. W. (1992). <em>Intentionally incomplete longitudinal designs: I. Methodology and comparison of some full span designs</em>. Statistics in Medicine, 11(14‚Äì15), 1889‚Äì1913. https://doi.org/10.1002/sim.4780111411
</p>
</li>
<li><p> Verbeke, G. &amp; Molenberghs, G. (2000). <em>Linear Mixed Models for Longitudinal Data</em>. Springer New York. https://doi.org/10.1007/978-1-4419-0300-6
</p>
</li>
<li><p> Andrzej Galecki &amp; Tomasz Burzykowski (2013) <em>Linear Mixed-Effects Models Using R: A Step-by-Step Approach</em> First Edition. Springer, New York. ISBN 978-1-4614-3899-1
</p>
</li></ul>



<h3>See Also</h3>

<p><a href="#topic+PostHocPwr">PostHocPwr</a>,<code><a href="#topic+PwrSampleSize">PwrSampleSize()</a></code>, <code><a href="#topic+PwrTime">PwrTime()</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>APrioriPwr(
sd_eval = seq(0.01, 0.2, 0.01),
sgma_eval = seq(0.01, 0.2, 0.01),
grwrComb_eval = seq(0.01, 0.1, 0.005)
)

</code></pre>

<hr>
<h2 id='CookDistance'>Cook's distance for the coefficient estimates</h2><span id='topic+CookDistance'></span>

<h3>Description</h3>

<p><code>CookDistance</code> allows the user to identify those subjects with a greater influence in the estimation of the
<code class="reqn">\beta</code> (tumor growth rate) for the treatment group, based in the calculation of Cook's distances.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CookDistance(model, cook_thr = NA, label_angle = 0, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CookDistance_+3A_model">model</code></td>
<td>
<p>An object of class &quot;lme&quot; representing the linear mixed-effects model fitted by <code><a href="#topic+lmmModel">lmmModel()</a></code>.</p>
</td></tr>
<tr><td><code id="CookDistance_+3A_cook_thr">cook_thr</code></td>
<td>
<p>Numeric value indicating the threshold for the Cook's distance. If not specified, the threshold is set to the 90% percentile of the Cook's
distance values.</p>
</td></tr>
<tr><td><code id="CookDistance_+3A_label_angle">label_angle</code></td>
<td>
<p>Numeric value indicating the angle for the label of subjects with a Cook's distance greater than <code>cook_thr</code>.</p>
</td></tr>
<tr><td><code id="CookDistance_+3A_verbose">verbose</code></td>
<td>
<p>Logical indicating if the subjects with a Cook's distance greater than <code>cook_thr</code> should be printed to the console.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The identification of the subjects with a greater influence in each estimated <code class="reqn">\beta</code> representing the tumor growth is based on the calculation of Cook's distances, as
described in Ga≈Çecki and Burzykowsk (2013). To compute the Cook's distance for the <code class="reqn">\beta</code> estimates (i.e., the contribution to each subject to the coefficient of its treatment group),
first a matrix containing the leave-one-subject-out estimates or <code class="reqn">\beta</code> is calculated. Then, the Cook's distances are calculated according to:
</p>
<p style="text-align: center;"><code class="reqn">D_i \equiv  \frac{(\hat{\beta} - \hat{\beta}_{(-i)})[\widehat{Var(\hat{\beta})}]^{-1}(\hat{\beta} - \hat{\beta}_{(-i)})}{rank(X)}</code>
</p>

<p>where <code class="reqn">\hat{\beta}_{(-i)}</code> is the estimate of the parameter vector <code class="reqn">\beta</code> obtained by fitting the model to the data with the <code class="reqn">i</code>-th subject excluded. The denominator of
the expression is equal to the number of the fixed-effects coefficients, which, under the assumption that the design matrix is of full rank, is equivalent to the rank of the design matrix.
</p>


<h3>Value</h3>

<p>A plot of the Cook's distance value for each subject, indicating those subjects
whose Cook's distance is greater than <code>cook_thr</code>.
</p>
<p>If saved to a variable, the function returns a vector with the Cook's distances for each subject.
</p>


<h3>References</h3>


<ul>
<li><p> Andrzej Galecki &amp; Tomasz Burzykowski (2013) <em>Linear Mixed-Effects Models Using R: A Step-by-Step Approach</em> First Edition. Springer, New York. ISBN 978-1-4614-3899-1
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>#' # Load the example data
data(grwth_data)
# Fit the model
lmm &lt;- lmmModel(
  data = grwth_data,
  sample_id = "subject",
  time = "Time",
  treatment = "Treatment",
  tumor_vol = "TumorVolume",
  trt_control = "Control",
  drug_a = "DrugA",
  drug_b = "DrugB",
  combination = "Combination"
  ) 
# Calulate Cook's distances for each subject
CookDistance(model = lmm)
# Change the Cook's distance threshold
CookDistance(model = lmm, cook_thr = 0.15)

</code></pre>

<hr>
<h2 id='getRTV'>Helper function to calculate the relative tumor volume from an imput data frame of tumor growth</h2><span id='topic+getRTV'></span>

<h3>Description</h3>

<p><code>getRTV</code> is a helper function used inside <code><a href="#topic+lmmModel">lmmModel()</a></code> to obtain a dataframe with a column <em>RTV</em> corresponding
to the relative tumor volume to time <code>time_start</code>, and a column <em>logRTV</em> with the logarithm of <em>RTV</em>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getRTV(data, time_start)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getRTV_+3A_data">data</code></td>
<td>
<p>Data frame with the tumor growth data. The input data frame columns have to have the following names:
</p>

<ul>
<li> <p><code>SampleID</code>: Column with the identifiers for each sample.
</p>
</li>
<li> <p><code>Time</code>: Column with the time for each measurement.
</p>
</li>
<li> <p><code>TV</code>: Column with the tumor volume measurement.
</p>
</li></ul>
</td></tr>
<tr><td><code id="getRTV_+3A_time_start">time_start</code></td>
<td>
<p>Numeric value indicating the time at which the treatment started.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns the original data frame of tumor growth data, with 3 additional columns, corresponding to:
</p>

<ul>
<li><p> RTV: Relative tumor volume to the tumor volume at <code>start_time</code>.
</p>
</li>
<li><p> logRTV: Logarithm of RTV column.
</p>
</li>
<li><p> TV0: Tumor volume at <code>start_time</code>.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># Load example dataset
data("grwth_data")
# Change column names
colnames(grwth_data) &lt;- c("SampleID", "Time", "Treatment", "TV")
# Calculate relative tumor volume
getRTV(data = grwth_data, time_start = 0)

</code></pre>

<hr>
<h2 id='grwth_data'>Example Tumor Growth Data</h2><span id='topic+grwth_data'></span>

<h3>Description</h3>

<p>A long format data frame with example tumor growth data, generated with <code><a href="#topic+simulateTumorGrowth">simulateTumorGrowth()</a></code>,
representing a simulated <em>in vivo</em> two-drugs combination experiment, involving 8 subjects per group, with 30 days of follow-up, taking measurement
every 3 days.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(grwth_data)
</code></pre>


<h3>Format</h3>

<p>A data frame with 352 rows and 4 columns:
</p>

<dl>
<dt>subject</dt><dd><p>Subject IDs.</p>
</dd>
<dt>Time</dt><dd><p>Time for each measurement in an arbitrary unit, for example, days.</p>
</dd>
<dt>Treatment</dt><dd><p>Treatment group for each subject (Control, DrugA, DrugB, and Combination).</p>
</dd>
<dt>TumorVolume</dt><dd><p>Measurement representing the tumor volume in an arbitrary unit, for example, mm^3.</p>
</dd>
</dl>


<hr>
<h2 id='lmmModel'>Linear Mixed Effect Model for Tumor Growth</h2><span id='topic+lmmModel'></span>

<h3>Description</h3>

<p><code>lmmModel()</code> fits a linear mixed effect model from a tumor growth dataset. The input data frame must be in long format and include at least the following columns: column with the sample ids,
column with the time at which each measurement has been done, a column indicating the treatment group, and a column with the tumor measurement (e.g. tumor volume).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lmmModel(
  data,
  sample_id = "SampleID",
  time = "Time",
  treatment = "Treatment",
  tumor_vol = "TV",
  trt_control = "Control",
  drug_a = "Drug_A",
  drug_b = "Drug_B",
  drug_c = NA,
  combination = "Combination",
  time_start = NULL,
  time_end = NULL,
  min_observations = 1,
  show_plot = TRUE,
  tum_vol_0 = "ignore",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lmmModel_+3A_data">data</code></td>
<td>
<p>A data frame with the tumor growth data, in long format.
It must contain at least the following columns: mice IDs, time of follow-up (numeric number), treatment and tumor volume (numeric number).</p>
</td></tr>
<tr><td><code id="lmmModel_+3A_sample_id">sample_id</code></td>
<td>
<p>String indicating the name of the column with the mice IDs.</p>
</td></tr>
<tr><td><code id="lmmModel_+3A_time">time</code></td>
<td>
<p>String indicating the name of the column with the time of follow-up.</p>
</td></tr>
<tr><td><code id="lmmModel_+3A_treatment">treatment</code></td>
<td>
<p>String indicating the name of the column with the treatment corresponding to each sample.</p>
</td></tr>
<tr><td><code id="lmmModel_+3A_tumor_vol">tumor_vol</code></td>
<td>
<p>String indicating the name of the column with the tumor volume (or any other measurement representing the tumor growth).</p>
</td></tr>
<tr><td><code id="lmmModel_+3A_trt_control">trt_control</code></td>
<td>
<p>String indicating the name assigned to the 'Control' group.</p>
</td></tr>
<tr><td><code id="lmmModel_+3A_drug_a">drug_a</code></td>
<td>
<p>String indicating the name assigned to the 'Drug A' group.</p>
</td></tr>
<tr><td><code id="lmmModel_+3A_drug_b">drug_b</code></td>
<td>
<p>String indicating the name assigned to the 'Drug B' group.</p>
</td></tr>
<tr><td><code id="lmmModel_+3A_drug_c">drug_c</code></td>
<td>
<p>String indicating the name assigned to the 'Drug C' group (if present).</p>
</td></tr>
<tr><td><code id="lmmModel_+3A_combination">combination</code></td>
<td>
<p>String indicating the name assigned to the Combination ('Drug A' + 'Drug B', or 'Drug A' + 'Drug B' + 'Drug C') group.</p>
</td></tr>
<tr><td><code id="lmmModel_+3A_time_start">time_start</code></td>
<td>
<p>Numeric value indicating the time point at which the treatment started. If not
specified, the minimum value in the <code>time</code> column is used as the starting time point.</p>
</td></tr>
<tr><td><code id="lmmModel_+3A_time_end">time_end</code></td>
<td>
<p>Numeric value indicating the last time point to be included in the analysis. If not
specified, the maximum value in the <code>time</code> column is used as the final time point.</p>
</td></tr>
<tr><td><code id="lmmModel_+3A_min_observations">min_observations</code></td>
<td>
<p>Minimum number of observation for each sample to be included in the analysis.</p>
</td></tr>
<tr><td><code id="lmmModel_+3A_show_plot">show_plot</code></td>
<td>
<p>Logical indicating if a plot for the log of the relative tumor volume (RTV) vs Time for each sample,
and the model calculated marginal slope for each treatment, should be produced.</p>
</td></tr>
<tr><td><code id="lmmModel_+3A_tum_vol_0">tum_vol_0</code></td>
<td>
<p>Select the behavior of the function regarding measurements in which the tumor measurement is 0, and therefore the logarithmic
transformation is not possible. Possible options are 'ignore' (default), to ignore these measurements, or 'transform', to add 1 unit to all
measurements before the log transformation.</p>
</td></tr>
<tr><td><code id="lmmModel_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to <code>nlme::<a href="nlme.html#topic+lme">lme</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>lmmModel()</code> relies in the assumption that tumor growth follows an exponential kinetics. Any departure from this assumption can be tested using the diagnostics functions <code><a href="#topic+ranefDiagnostics">ranefDiagnostics()</a></code>,
<code><a href="#topic+residDiagnostics">residDiagnostics()</a></code>, and <code><a href="#topic+ObsvsPred">ObsvsPred()</a></code>.
</p>
<p>The model formula for the linear mixed-effect fitted model is:
</p>
<p style="text-align: center;"><code class="reqn">\log RTV_{i}(t) = \beta_{T_i} \cdot t + b_i \cdot t + \varepsilon_{i} (t).</code>
</p>

<p>where <code class="reqn">\log RTV_{i}(t)</code> denotes the value of the logarithm of the relative tumor volume measured for subject <code class="reqn">i</code> at time <code class="reqn">t</code>. The coefficient
<code class="reqn">\beta_{T_i}</code> represents the fixed effectsat time <code class="reqn">t</code> for each  treatment <code class="reqn">T_i</code>, where <code class="reqn">T_i \in \{Control, DrugA, DrugB, Combination\}</code> in the case of
two-drugs combination experiments, or <code class="reqn">T_i \in \{Control, DrugA, DrugB, DrugC, Combination\}</code> in the case of three-drugs combination experiments, and indicates the
tumor-specific growth rate for each treatment group.
</p>
<p>Term <code class="reqn">b_i \cdot t</code> corresponds to the subject-specific random slope that takes into account the longitudinal nature of the data, where <code class="reqn">b_i</code> is the random effect for subject <code class="reqn">i</code>.
<code class="reqn">\varepsilon_{i}(t)</code> is the residual random term for subject <code class="reqn">i</code> at time <code class="reqn">t</code>.
</p>
<p>The implementation of the linear mixed model in <code>lmmModel()</code> is done using <code>nlme::<a href="nlme.html#topic+lme">lme</a></code>, which also allows for the
specification of within-group correlations structures and/or unequal variances. These, and additional parameters,
can be passed to the <code>nlme::<a href="nlme.html#topic+lme">lme</a></code> function through the <code>...</code> argument for fitting the model (see examples below).
</p>


<h3>Value</h3>

<p>An object of class &quot;lme&quot; (see <code>nlme::<a href="nlme.html#topic+lme">lme</a></code> for details) representing the linear mixed-effects model fit. If <code>show_plot = TRUE</code>, the plot
of the tumor growth data obtained with <code><a href="#topic+plot_lmmModel">plot_lmmModel()</a></code> is also shown.
</p>


<h3>References</h3>


<ul>
<li><p> Pinheiro JC, Bates DM (2000). <em>Mixed-Effects Models in S and S-PLUS</em>. Springer, New York. doi:10.1007/b98882 <a href="https://doi.org/10.1007/b98882">doi:10.1007/b98882</a>.
</p>
</li>
<li><p> Pinheiro J, Bates D, R Core Team (2024). <em>nlme: Linear and Nonlinear Mixed Effects Models</em>. R package version 3.1-166, <a href="https://CRAN.R-project.org/package=nlme">https://CRAN.R-project.org/package=nlme</a>.
</p>
</li>
<li><p> Andrzej Galecki &amp; Tomasz Burzykowski (2013) <em>Linear Mixed-Effects Models Using R: A Step-by-Step Approach</em> First Edition. Springer, New York. ISBN 978-1-4614-3899-1
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>data("grwth_data")
# Most simple model
lmmModel(
 data = grwth_data,
 sample_id = "subject",
 time = "Time",
 treatment = "Treatment",
 tumor_vol = "TumorVolume",
 trt_control = "Control",
 drug_a = "DrugA",
 drug_b = "DrugB",
 combination = "Combination"
 )
# Changing the last time point of follow-up
lmmModel(
 data = grwth_data,
 sample_id = "subject",
 time = "Time",
 treatment = "Treatment",
 tumor_vol = "TumorVolume",
 trt_control = "Control",
 drug_a = "DrugA",
 drug_b = "DrugB",
 combination = "Combination",
 time_end = 21
 )
# Adding additional parameters for model fitting
lmmModel(
 data = grwth_data,
 sample_id = "subject",
 time = "Time",
 treatment = "Treatment",
 tumor_vol = "TumorVolume",
 trt_control = "Control",
 drug_a = "DrugA",
 drug_b = "DrugB",
 combination = "Combination",
 # Adding variance function to represent a different variance per subject
 weights = nlme::varIdent(form = ~1|SampleID),
 # Specifiying control values for lme Fit (useful when convergence problems appear)
 control = nlme::lmeControl(maxIter = 1000, msMaxIter = 1000, niterEM = 100, msMaxEval = 1000)
 )

# Fit a model specifying a different variance per Time
lmmModel(
 data = grwth_data,
 sample_id = "subject",
 time = "Time",
 treatment = "Treatment",
 tumor_vol = "TumorVolume",
 trt_control = "Control",
 drug_a = "DrugA",
 drug_b = "DrugB",
 combination = "Combination",
 # Adding variance function to represent a different variance per Time
 weights = nlme::varIdent(form = ~1|Time)
 )



</code></pre>

<hr>
<h2 id='lmmModel_estimates'>Get estimates from a linear mixed model of tumor growth data</h2><span id='topic+lmmModel_estimates'></span>

<h3>Description</h3>

<p><code>lmmModel_estimates</code> allows the user to easily extract some of the interesting model estimates for further use in other functions,
such as for power calculation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lmmModel_estimates(model)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lmmModel_estimates_+3A_model">model</code></td>
<td>
<p>An object of class &quot;lme&quot; representing the linear mixed-effects model fitted by <code><a href="#topic+lmmModel">lmmModel()</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The model estimates provided by <code>lmmModel_estimates</code> include:
</p>

<ul>
<li><p> Fixed effect coefficients: <code class="reqn">\hat{\beta}_C</code>, <code class="reqn">\hat{\beta}_A</code>, <code class="reqn">\hat{\beta}_B</code>, <code class="reqn">\hat{\beta}_{AB}</code>,
which represent the estimated specific growth rates for the Control, Drug A, Drug B and Combination groups, respectively.
These are shown in columns <code>control</code>, <code>drug_a</code>, <code>drug_b</code>, and <code>combination</code>, respectively.
</p>
</li>
<li><p> Standard deviation of the random effects (between-subject variance). Column <code>sd_ranef</code>.
</p>
</li>
<li><p> Standard deviation of the residuals (within-subject variance). Column <code>sd_resid</code>.
</p>
</li></ul>



<h3>Value</h3>

<p>A data frame with the estimated values for the coefficients of the tumor growth for each treatment,
the standard deviation of the random effects, and the standard deviation of the residuals of the model.
These values can be useful for the power analysis of the model using <code><a href="#topic+APrioriPwr">APrioriPwr()</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("grwth_data")
# Fit example model
lmm &lt;- lmmModel(
  data = grwth_data,
  sample_id = "subject",
  time = "Time",
  treatment = "Treatment",
  tumor_vol = "TumorVolume",
  trt_control = "Control",
  drug_a = "DrugA",
  drug_b = "DrugB",
  combination = "Combination"
  ) 
# Get the estimates
lmmModel_estimates(lmm)
</code></pre>

<hr>
<h2 id='lmmSynergy'>Synergy calculation using linear-mixed models</h2><span id='topic+lmmSynergy'></span>

<h3>Description</h3>

<p><code>lmmSynergy</code> allows for the calculation of synergy using 3 different references models: Bliss independence, highest single agent and
response additivity. The calculation of synergy is based on hypothesis testing on the coefficient estimates from the model fitted by
<code><a href="#topic+lmmModel">lmmModel()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lmmSynergy(
  model,
  method = "Bliss",
  min_time = 0,
  robust = FALSE,
  type = "CR2",
  ra_nsim = 1000,
  show_plot = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lmmSynergy_+3A_model">model</code></td>
<td>
<p>An object of class &quot;lme&quot; representing the linear mixed-effects model fitted by <code><a href="#topic+lmmModel">lmmModel()</a></code>.</p>
</td></tr>
<tr><td><code id="lmmSynergy_+3A_method">method</code></td>
<td>
<p>String indicating the method for synergy calculation. Possible methods are &quot;Bliss&quot;, &quot;HSA&quot; and &quot;RA&quot;,
corresponding to Bliss, highest single agent and response additivity, respectively.</p>
</td></tr>
<tr><td><code id="lmmSynergy_+3A_min_time">min_time</code></td>
<td>
<p>Minimun time for which to start calculating synergy.</p>
</td></tr>
<tr><td><code id="lmmSynergy_+3A_robust">robust</code></td>
<td>
<p>If TRUE, uncertainty is estimated using sandwich-based robust estimators
of the variance-covariance matrix of the regression coefficient estimates provided by <a href="clubSandwich.html#topic+vcovCR.lme">clubSandwich::vcovCR.lme</a>.</p>
</td></tr>
<tr><td><code id="lmmSynergy_+3A_type">type</code></td>
<td>
<p>Character string specifying which small-sample adjustment should be used, with available options &quot;CR0&quot;, &quot;CR1&quot;, &quot;CR1p&quot;, &quot;CR1S&quot;, &quot;CR2&quot;, or &quot;CR3&quot;.
See &quot;Details&quot; section of <code><a href="clubSandwich.html#topic+vcovCR">clubSandwich::vcovCR()</a></code> for further information.</p>
</td></tr>
<tr><td><code id="lmmSynergy_+3A_ra_nsim">ra_nsim</code></td>
<td>
<p>Number of random sampling to calculate the synergy for Response Additivity model.</p>
</td></tr>
<tr><td><code id="lmmSynergy_+3A_show_plot">show_plot</code></td>
<td>
<p>Logical indicating if a plot with the results of the synergy calculation should be generated.</p>
</td></tr>
<tr><td><code id="lmmSynergy_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to <code><a href="marginaleffects.html#topic+hypotheses">marginaleffects::hypotheses()</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>lmmSynergy</code> uses the statistical description provided by Demidenko and Miller (2019) for the calculation of synergy. It is based on hypothesis testing
on the coefficients estimates from the model fitted by <code><a href="#topic+lmmModel">lmmModel()</a></code>: <code class="reqn">\hat{\beta}_C</code>, <code class="reqn">\hat{\beta}_A</code>, <code class="reqn">\hat{\beta}_B</code>, <code class="reqn">\hat{\beta}_{AB}</code>,
which represent the estimated specific growth rates for the Control, Drug A, Drug B and Combination groups, respectively.
</p>
<p><strong>Bliss Indepence Model</strong>
</p>
<p>For Bliss model, <code>lmmSynergy</code> test the following null hypothesis:
</p>
<p><em>Two-drugs combination experiment</em>:
</p>
<p style="text-align: center;"><code class="reqn">H_0: \beta_{combination} = \beta_A + \beta_B - \beta_{control}</code>
</p>

<p><em>Three-drugs combination experiment</em>:
</p>
<p style="text-align: center;"><code class="reqn">H_0: \beta_{combination} = \beta_A + \beta_B + \beta_C - 2\beta_{control}</code>
</p>

<p><strong>Highes Single Agent (HSA)</strong>
</p>
<p><em>Two-drugs combination experiment</em>:
For the HSA model, <code>lmmSynergy</code> test the following null hypothesis:
</p>
<p style="text-align: center;"><code class="reqn">H_0: \beta_{combination} = \min(\beta_A, \beta_B)</code>
</p>

<p><em>Three-drugs combination experiment</em>:
For the HSA model, <code>lmmSynergy</code> test the following null hypothesis:
</p>
<p style="text-align: center;"><code class="reqn">H_0: \beta_{combination} = \min(\beta_A, \beta_B, \beta_C)</code>
</p>

<p><strong>Response Additivity (RA)</strong>
</p>
<p>For the RA model, <code>lmmSynergy</code> test the following null hypothesis:
</p>
<p><em>Two-drugs combination experiment</em>:
</p>
<p style="text-align: center;"><code class="reqn">H_0: e^{\beta_{combination}t} = e^{\beta_At}+e^{\beta_Bt}-e^{\beta_{control}t}</code>
</p>

<p><em>Three-drugs combination experiment</em>:
</p>
<p style="text-align: center;"><code class="reqn">H_0: e^{\beta_{combination}t} = e^{\beta_At}+e^{\beta_Bt}+e^{\beta_Ct}-2e^{\beta_{control}t}</code>
</p>

<p>For <strong>Bliss</strong> and <strong>HSA</strong> models, <code>lmmSynergy</code> uses <code><a href="marginaleffects.html#topic+hypotheses">marginaleffects::hypotheses()</a></code> to conduct hypothesis tests on the estimated coefficients of the model.
</p>
<p>In the case of the <strong>RA</strong> model, the null hypothesis is tested comparing the area under the curve (i.e. cumulative effect from the beginning of a treatment to
a time point of interest) obtained from each side of the equation for the null hypothesis, based on <code>ra_sim</code> random samplings from the
distribution of the coefficients.
</p>
<p><strong>Combination Index and Synergy Score</strong>
</p>
<p>The results obtained by <code>lmmSynergy</code> include the synergy score (SS) and combination index (CI) for the model, for each time point, together with their confidence interval,
and the corresponding p-value. The values of SS and CI provided by <code>lmmSynergy</code> follow previous definitions of these metrics so they have the same interpretation:
</p>

<ul>
<li><p> The SS has been defined as the excess response due to drug interaction compared to the reference model (Ianevski et al. (2017), Ianevski, Giri, and Aittokallio (2022), Mao and Guo (2023)).
Following this definition, a <code class="reqn">SS&gt;0</code>, <code class="reqn">SS=0</code>, and <code class="reqn">SS&lt;0</code>, represent synergistic, additive and antagonistic effects, respectively.
</p>
</li>
<li><p> According to the common definition of the CI, a <code class="reqn">CI&lt;1</code>, <code class="reqn">CI=1</code>, and <code class="reqn">CI&gt;1</code> represent synergistic, additive and antagonistic effects, respectively (Yadav et al. (2015), Demidenko and Miller (2019),
Mao and Guo (2023)), and provides information about the observed drug combination effect versus the expected additive effect provided by the reference synergy model.
A drug combination effect larger than the expected (<code class="reqn">CI &gt; 1</code>) would indicate synergism, a drug combination effect equal to the expected (<code class="reqn">CI = 1</code>) would indicate additivity,
and a lower drug combination effect than the expected (<code class="reqn">CI &lt; 1</code>) would indicate antagonism.
</p>
</li></ul>

<p>As mentioned above, the results include the synergy results for <strong>each day</strong>. This means that <code>lmmSynergy</code> refits the model using the data from <code>time_start</code> defined in <code><a href="#topic+lmmModel">lmmModel()</a></code> until
each time point, providing the synergy results for each of these models and for that specific time point.
</p>
<p><strong>Uncertainty estimation using robust estimators</strong>
</p>
<p>If <code>robust = TRUE</code>, <code>lmmSynergy</code> deals with possible model misspecifications, allowing for cluster-robust variance estimation using  <a href="clubSandwich.html#topic+vcovCR.lme">clubSandwich::vcovCR.lme</a>.
When using <code>robust = TRUE</code>, setting <code>type = "CR2"</code> is recommended. See more details in <code><a href="clubSandwich.html#topic+vcovCR">clubSandwich::vcovCR()</a></code>.
</p>
<p><em>Note</em>: When a variance structure has been specified in the model it is recommended to use always <code>robust = TRUE</code> to get a better estimation.
</p>


<h3>Value</h3>

<p>The function returns a list with two elements:
</p>

<ul>
<li> <p><code>Constrasts</code>: List with the outputs of the linear test for the synergy null hypothesis obtained by <code><a href="marginaleffects.html#topic+hypotheses">marginaleffects::hypotheses()</a></code> for each time.
See <code><a href="marginaleffects.html#topic+hypotheses">marginaleffects::hypotheses()</a></code> for more details.
</p>
</li>
<li> <p><code>Synergy</code>: Data frame with the synergy results, indicating the model of synergy (&quot;Bliss&quot;, &quot;HSA&quot; or &quot;RA&quot;), the metric (combination index and synergy score),
the value of the metric estimate (with upper and lower confidence interval bounds) and the p-value, for each time.
</p>
</li></ul>

<p>If <code>show_plot = TRUE</code>, a plot with the synergy results obtained with <code><a href="#topic+plot_lmmSynergy">plot_lmmSynergy()</a></code> is also shown.
</p>


<h3>References</h3>


<ul>
<li><p> Demidenko, Eugene, and Todd W. Miller. 2019. <em>Statistical Determination of Synergy Based on Bliss Definition of Drugs Independence.</em> PLoS ONE 14 (November). https://doi.org/10.1371/journal.pone.0224137.
</p>
</li>
<li><p> Yadav, Bhagwan, Krister Wennerberg, Tero Aittokallio, and Jing Tang. 2015. <em>Searching for Drug Synergy in Complex Dose‚ÄìResponse Landscapes Using an Interaction Potency Model.</em> Computational and Structural Biotechnology Journal 13: 504‚Äì13. https://doi.org/10.1016/j.csbj.2015.09.001.
</p>
</li>
<li><p> Ianevski, Aleksandr, Liye He, Tero Aittokallio, and Jing Tang. 2017. <em>SynergyFinder: A Web Application for Analyzing Drug Combination Dose‚ÄìResponse Matrix Data.</em> Bioinformatics 33 (August): 2413‚Äì15. https://doi.org/10.1093/bioinformatics/btx162.
</p>
</li>
<li><p> Ianevski, Aleksandr, Anil K Giri, and Tero Aittokallio. 2022. <em>SynergyFinder 3.0: An Interactive Analysis and Consensus Interpretation of Multi-Drug Synergies Across Multiple Samples.</em> Nucleic Acids Research 50 (July): W739‚Äì43. https://doi.org/10.1093/nar/gkac382.
</p>
</li>
<li><p> Mao, Binchen, and Sheng Guo. 2023. <em>Statistical Assessment of Drug Synergy from in Vivo Combination Studies Using Mouse Tumor Models.</em> Cancer Research Communications 3 (October): 2146‚Äì57. https://doi.org/10.1158/2767-9764.CRC-23-0243.
</p>
</li>
<li><p> Vincent Arel-Bundock, Noah Greifer, and Andrew Heiss. Forthcoming. How to Interpret Statistical Models Using marginaleffects in R and Python. Journal of Statistical Software. https://marginaleffects.com
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># Load the example data
data(grwth_data)
# Fit the model
lmm &lt;- lmmModel(
  data = grwth_data,
  sample_id = "subject",
  time = "Time",
  treatment = "Treatment",
  tumor_vol = "TumorVolume",
  trt_control = "Control",
  drug_a = "DrugA",
  drug_b = "DrugB",
  combination = "Combination"
  ) 
# Most simple use with default values
syn &lt;- lmmSynergy(lmm)
# Accessing to synergy results data frame
syn$Synergy
# Selecting different reference models:
## Bliss
lmmSynergy(lmm, method = "Bliss")
## HSA
lmmSynergy(lmm, method = "HSA")
## RA
lmmSynergy(lmm, method = "RA", ra_sim = 1000)

# Only calculate synergy from Time 12 onwards
lmmSynergy(lmm, min_time = 12)

# Using robust standard errors
lmmSynergy(lmm, method = "Bliss", robust = TRUE, type = "CR2")

</code></pre>

<hr>
<h2 id='logLikSubjectDisplacements'>Likelihood displacements for the model</h2><span id='topic+logLikSubjectDisplacements'></span>

<h3>Description</h3>

<p><code>logLikSubjectDisplacements</code> allows the user to evaluate the log-likelihood displacement for each subject,
indicating the influence of every subject to the model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logLikSubjectDisplacements(
  model,
  disp_thrh = NA,
  label_angle = 0,
  var_name = NULL,
  verbose = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="logLikSubjectDisplacements_+3A_model">model</code></td>
<td>
<p>An object of class &quot;lme&quot; representing the linear mixed-effects model fitted by <code><a href="#topic+lmmModel">lmmModel()</a></code>.</p>
</td></tr>
<tr><td><code id="logLikSubjectDisplacements_+3A_disp_thrh">disp_thrh</code></td>
<td>
<p>Numeric value indicating the threshold of log-likelihood displacement. If not specified, the threshold is set to the 90% percentile of the log-likelihood
displacement values.</p>
</td></tr>
<tr><td><code id="logLikSubjectDisplacements_+3A_label_angle">label_angle</code></td>
<td>
<p>Numeric value indicating the angle for the label of subjects with a log-likelihood displacement greater than <code>disp_thrh</code>.</p>
</td></tr>
<tr><td><code id="logLikSubjectDisplacements_+3A_var_name">var_name</code></td>
<td>
<p>Name of the variable for the weights of the model in the case that a variance structure has been specified using <code><a href="nlme.html#topic+varIdent">nlme::varIdent()</a></code>.
(See examples in <code><a href="#topic+lmmModel">lmmModel()</a></code>).</p>
</td></tr>
<tr><td><code id="logLikSubjectDisplacements_+3A_verbose">verbose</code></td>
<td>
<p>Logical indicating if subjects with a log-likelihood displacement greater than <code>disp_thrh</code> should be printed to the console.</p>
</td></tr>
<tr><td><code id="logLikSubjectDisplacements_+3A_...">...</code></td>
<td>
<p>Extra arguments, if any, for <a href="lattice.html#topic+panel.xyplot">lattice::panel.xyplot</a>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The evaluation of the log-likelihood displacement is based in the analysis proposed in Verbeke and Molenberghs (2009) and Ga≈Çecki and Burzykowski (2013).
First, a list of models fitted to leave-one-subject-out datasets are obtained. Then, for each model, the maximum likelihood estimate obtained by fitting the
model to all data and the maximum likelihood estimate obtained by fitting the model to the data with the <code class="reqn">i</code>-th subject removed are obtained and used for the
log-likelihood displacement calculation. The likelihood displacement, <code class="reqn">LDi</code> , is defined as twice the difference between the log-likelihood computed at a
maximum and displaced values of estimated parameters (Verbeke and Molenberghs (2009), Ga≈Çecki and Burzykowsk (2013)):
</p>
<p style="text-align: center;"><code class="reqn">LD_i \equiv 2 \times \Bigr[\ell_\textrm{Full}(\widehat{\Theta};\textrm{y})-\ell_\textrm{Full}(\widehat{\Theta}_{(-i)};\textrm{y})\Bigr]</code>
</p>

<p>where <code class="reqn">\widehat{\Theta}</code> is the maximum-likelihood estimate of <code class="reqn">\Theta</code> obtained by fitting the model to all data, while <code class="reqn">\widehat{\Theta}_{-i}</code> is
the maximum-likelihood estimate obtained by fitting the model to the data with the <code class="reqn">i</code>-subject excluded.
</p>


<h3>Value</h3>

<p>Returns a plot of the log-likelihood displacement values for each subject, indicating those subjects
whose contribution is greater than <code>disp_thrh</code>.
</p>


<h3>References</h3>


<ul>
<li><p> Andrzej Galecki &amp; Tomasz Burzykowski (2013) <em>Linear Mixed-Effects Models Using R: A Step-by-Step Approach</em> First Edition. Springer, New York. ISBN 978-1-4614-3899-1
</p>
</li>
<li><p> Verbeke, G. &amp; Molenberghs, G. (2000). <em>Linear Mixed Models for Longitudinal Data</em>. Springer New York. https://doi.org/10.1007/978-1-4419-0300-6
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># Load the example data
data(grwth_data)
# Fit the model
lmm &lt;- lmmModel(
  data = grwth_data,
  sample_id = "subject",
  time = "Time",
  treatment = "Treatment",
  tumor_vol = "TumorVolume",
  trt_control = "Control",
  drug_a = "DrugA",
  drug_b = "DrugB",
  combination = "Combination"
  ) 
# Obtain log-likelihood displacement for each subject
logLikSubjectDisplacements(model = lmm)
# Modifying the threshold for log-likelihood displacement
logLikSubjectDisplacements(model = lmm, disp_thrh = 1)

# Calculating the log-likelihood contribution in a model with a variance structure specified
lmm_var &lt;- lmmModel(
  data = grwth_data,
  sample_id = "subject",
  time = "Time",
  treatment = "Treatment",
  tumor_vol = "TumorVolume",
  trt_control = "Control",
  drug_a = "DrugA",
  drug_b = "DrugB",
  combination = "Combination",
  weights = nlme::varIdent(form = ~ 1|SampleID)
  ) 
# Calculate the log-likelihood contribution
logLikSubjectDisplacements(model = lmm, var_name = "SampleID")

</code></pre>

<hr>
<h2 id='ObsvsPred'>Observed vs predicted values and performance of the model</h2><span id='topic+ObsvsPred'></span>

<h3>Description</h3>

<p><code>ObsvsPred</code> allows the user to have a straight forward idea about how the model is fitting the data, providing
plots of the predicted regression lines versus the actual data points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ObsvsPred(model, nrow = 4, ncol = 5, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ObsvsPred_+3A_model">model</code></td>
<td>
<p>An object of class &quot;lme&quot; representing the linear mixed-effects model fitted by <code><a href="#topic+lmmModel">lmmModel()</a></code>.</p>
</td></tr>
<tr><td><code id="ObsvsPred_+3A_nrow">nrow</code></td>
<td>
<p>Number of rows of the layout to organize the observed vs predicted plots.</p>
</td></tr>
<tr><td><code id="ObsvsPred_+3A_ncol">ncol</code></td>
<td>
<p>Number of columns of the layout to organize the observed vs predicted plots.</p>
</td></tr>
<tr><td><code id="ObsvsPred_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to <code><a href="performance.html#topic+model_performance">performance::model_performance()</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function provides visual and quantitative information about the performance of the model:
</p>

<ul>
<li><p> A layout of the observed and predicted values of <code class="reqn">log</code>(relative tumor volume) vs Time for each SampleID (i.e. subject),
with the actual measurements, the regression line for each SampleID, and the marginal, treatment-specific,
regression line for each treatment group.
</p>
</li>
<li><p> Performance metrics of the model obtain calculated using <code><a href="performance.html#topic+model_performance">performance::model_performance()</a></code>. The maximum likelihood-based Akaike's Information Criterion (AIC),
small sample AIC (AICc), and Bayesian Information Criterion, and the Nakagawa's r-squared
root mean squared error (RMSE) of the residuals, and the standard deviation of the residuals (sigma) are provided.
</p>
</li></ul>



<h3>Value</h3>

<p>Performance metrics of the model obtain calculated using <code><a href="performance.html#topic+model_performance">performance::model_performance()</a></code> and a layout of plots of the observed vs predicted values for each SampleID.
</p>


<h3>References</h3>


<ul>
<li><p> Andrzej Galecki &amp; Tomasz Burzykowski (2013) <em>Linear Mixed-Effects Models Using R: A Step-by-Step Approach</em> First Edition. Springer, New York. ISBN 978-1-4614-3899-1
</p>
</li>
<li><p> L√ºdecke et al., (2021). <em>performance: An R Package for Assessment, Comparison and Testing of Statistical Models</em>. Journal of Open Source Software, 6(60), 3139. https://doi.org/10.21105/joss.03139
</p>
</li>
<li><p> Sakamoto, Y., M. Ishiguro, and G. Kitagawa. 1984. <em>Akaike Information Criterion Statistics</em>. Mathematics and Its Applications. Reidel.
</p>
</li>
<li><p> Nakagawa, Shinichi, and Holger Schielzeth. 2013. <em>A General and Simple Method for Obtaining r2 from Generalized Linear Mixed-effects Models</em>. Methods in Ecology and Evolution 4 (February): 133‚Äì42. https://doi.org/10.1111/j.2041-210x.2012.00261.x.
</p>
</li>
<li><p> Johnson, Paul C. D. 2014. <em>Extension of Nakagawa &amp; Schielzeth‚Äôs r 2 GLMM to Random Slopes Models</em>. Methods in Ecology and Evolution 5 (September): 944‚Äì46. https://doi.org/10.1111/2041-210X.12225.
</p>
</li>
<li><p> Nakagawa, Shinichi, Paul C. D. Johnson, and Holger Schielzeth. 2017. <em>The Coefficient of Determination r2 and Intra-Class Correlation Coefficient from Generalized Linear Mixed-Effects Models Revisited and Expanded</em>. Journal of The Royal Society Interface 14 (September): 20170213. https://doi.org/10.1098/rsif.2017.0213.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># Load the example data
data(grwth_data)
# Fit the model
lmm &lt;- lmmModel(
  data = grwth_data,
  sample_id = "subject",
  time = "Time",
  treatment = "Treatment",
  tumor_vol = "TumorVolume",
  trt_control = "Control",
  drug_a = "DrugA",
  drug_b = "DrugB",
  combination = "Combination"
  )
# Obtain Observed vs Predicted plots, and model performance metrics
ObsvsPred(model = lmm, nrow = 4, ncol = 8)
</code></pre>

<hr>
<h2 id='plot_lmmModel'>Plotting of tumor growth data from a fitted model</h2><span id='topic+plot_lmmModel'></span>

<h3>Description</h3>

<p>Vizualization of tumor growth data and linear mixed model fitted regression line for the fixed effects. This functions returns a <a href="https://ggplot2.tidyverse.org/">ggplot2</a> plot, allowing for
further personalization.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_lmmModel(
  model,
  trt_control = "Control",
  drug_a = "Drug_A",
  drug_b = "Drug_B",
  drug_c = NA,
  combination = "Combination"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_lmmModel_+3A_model">model</code></td>
<td>
<p>An object of class &quot;lme&quot; representing the linear mixed-effects model fitted by <code><a href="#topic+lmmModel">lmmModel()</a></code>.</p>
</td></tr>
<tr><td><code id="plot_lmmModel_+3A_trt_control">trt_control</code></td>
<td>
<p>String indicating the name assigned to the 'Control' group.</p>
</td></tr>
<tr><td><code id="plot_lmmModel_+3A_drug_a">drug_a</code></td>
<td>
<p>String indicating the name assigned to the 'Drug A' group.</p>
</td></tr>
<tr><td><code id="plot_lmmModel_+3A_drug_b">drug_b</code></td>
<td>
<p>String indicating the name assigned to the 'Drug B' group.</p>
</td></tr>
<tr><td><code id="plot_lmmModel_+3A_drug_c">drug_c</code></td>
<td>
<p>String indicating the name assigned to the 'Drug C' group (if present).</p>
</td></tr>
<tr><td><code id="plot_lmmModel_+3A_combination">combination</code></td>
<td>
<p>String indicating the name assigned to the Combination ('Drug A' + 'Drug B', or 'Drug A' + 'Drug B' + 'Drug C') group.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot2 plot (see <code><a href="ggplot2.html#topic+ggplot">ggplot2::ggplot()</a></code> for more details) showing the tumor growth data represented as log(relative tumor volume) versus time since treatment initiation.
The regression lines corresponding to the fixed effects for each treatment group are also plotted.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(grwth_data)
# Fit the model
lmm &lt;- lmmModel(
  data = grwth_data,
  sample_id = "subject",
  time = "Time",
  treatment = "Treatment",
  tumor_vol = "TumorVolume",
  trt_control = "Control",
  drug_a = "DrugA",
  drug_b = "DrugB",
  combination = "Combination",
  show_plot = FALSE
  )
# Default plot
plot_lmmModel(lmm,
trt_control = "Control",
drug_a = "DrugA",
drug_b = "DrugB",
combination = "Combination"
)
# Adding ggplot2 elements
plot_lmmModel(lmm,
trt_control = "Control",
drug_a = "DrugA",
drug_b = "DrugB",
combination = "Combination"
) + ggplot2::labs(title = "Example Plot") + ggplot2::theme(legend.position = "top")

</code></pre>

<hr>
<h2 id='plot_lmmSynergy'>Plotting synergy results</h2><span id='topic+plot_lmmSynergy'></span>

<h3>Description</h3>

<p>Visualization of synergy results obtained by <code><a href="#topic+lmmSynergy">lmmSynergy()</a></code>.  This functions returns a <a href="https://ggplot2.tidyverse.org/">ggplot2</a> plot, allowing for
further personalization.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_lmmSynergy(syn_data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_lmmSynergy_+3A_syn_data">syn_data</code></td>
<td>
<p>Object obtained by <code><a href="#topic+lmmSynergy">lmmSynergy()</a></code> with the results of synergy calculation using linear mixed models.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>plot_lmmSynergy</code> produces a <a href="https://ggplot2.tidyverse.org/">ggplot2</a> plot with the results of the synergy calculation. Each dot represents the estimated combination index
or synergy score, and the gray lines represent the 95% confidence intervals, for each day. Each dot is colored based on the <code class="reqn">- \log_{10} (p-value)</code>, with
purple colors indicating a <code class="reqn">-\log_{10} (p-value) &lt; 1.3; (p-value &gt; 0.05)</code>, and green colors indicating a <code class="reqn">-\log_{10} (p-value) &gt; 1.3; (p-value &lt; 0.05)</code>.
</p>


<h3>Value</h3>

<p>A list with ggplot2 plots (see <code><a href="ggplot2.html#topic+ggplot">ggplot2::ggplot()</a></code> for more details) with the combination index (CI) and synergy score (SS)
estimates, confidence intervals and p-values for the synergy calculation using linear mixed models.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(grwth_data)
# Fit the model
lmm &lt;- lmmModel(
  data = grwth_data,
  sample_id = "subject",
  time = "Time",
  treatment = "Treatment",
  tumor_vol = "TumorVolume",
  trt_control = "Control",
  drug_a = "DrugA",
  drug_b = "DrugB",
  combination = "Combination"
  )
# Obtain synergy results
lmmSyn &lt;- lmmSynergy(lmm)
# Plot synergy results
plot_lmmSynergy(lmmSyn)
# Accessing to the combination index plot
plot_lmmSynergy(lmmSyn)$CI
# Accessing to only synergy score plot
plot_lmmSynergy(lmmSyn)$SS
# Accessing to the grid of both plots side by side
plot_lmmSynergy(lmmSyn)$CI_SS
# Adding ggplot2 elements
plot_lmmSynergy(lmmSyn)$CI + 
ggplot2::labs(title = "Synergy Calculation for Bliss") + 
ggplot2::theme(legend.position = "top")  

</code></pre>

<hr>
<h2 id='plot_ObsvsPred'>Plots of Observed vs Predicted Values</h2><span id='topic+plot_ObsvsPred'></span>

<h3>Description</h3>

<p>Visualization of observed vs predicted values by a fitted linear mixed model of tumor growth data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_ObsvsPred(model, nrow = 4, ncol = 5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_ObsvsPred_+3A_model">model</code></td>
<td>
<p>An object of class &quot;lme&quot; representing the linear mixed-effects model fitted by <code><a href="#topic+lmmModel">lmmModel()</a></code>.</p>
</td></tr>
<tr><td><code id="plot_ObsvsPred_+3A_nrow">nrow</code></td>
<td>
<p>Number of rows of the layout to organize the observed vs predicted plots.</p>
</td></tr>
<tr><td><code id="plot_ObsvsPred_+3A_ncol">ncol</code></td>
<td>
<p>Number of columns of the layout to organize the observed vs predicted plots.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A layout (arranged in <code>nrow</code> rows and <code>ncol</code> columns) of the observed and predicted values of <code class="reqn">log</code>(relative tumor volume) vs Time for each SampleID (i.e. subject),
with the actual measurements, the regression line for each SampleID, and the marginal, treatment-specific,
regression line for each treatment group.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#' data(grwth_data)
# Fit the model
lmm &lt;- lmmModel(
  data = grwth_data,
  sample_id = "subject",
  time = "Time",
  treatment = "Treatment",
  tumor_vol = "TumorVolume",
  trt_control = "Control",
  drug_a = "DrugA",
  drug_b = "DrugB",
  combination = "Combination",
  show_plot = FALSE
  )
# Obtain the plots
plot_ObsvsPred(lmm, nrow = 4, ncol = 8)    

</code></pre>

<hr>
<h2 id='plot_ranefDiagnostics'>Plots for random effects diagnostics</h2><span id='topic+plot_ranefDiagnostics'></span>

<h3>Description</h3>

<p>Visualization of random effects diagnostics for a fitted linear mixed model of tumor growth data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_ranefDiagnostics(model)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_ranefDiagnostics_+3A_model">model</code></td>
<td>
<p>An object of class &quot;lme&quot; representing the linear mixed-effects model fitted by <code><a href="#topic+lmmModel">lmmModel()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with different plots for evaluating the normality and homoscedasticity of the random effects, including:
</p>

<ul>
<li><p> A normal Q-Q plot of the random effects of the model.
</p>
</li>
<li><p> A normal Q-Q plot of the residuals by sample.
</p>
</li>
<li><p> Boxplots of the &quot;raw&quot; residuals (observed - fitted) by sample.
</p>
</li>
<li><p> Scatter plots of the normalized residuals (standardized residuals pre-multiplied by the inverse square-root factor of the estimated error correlation matrix, see <a href="nlme.html#topic+residuals.lme">nlme::residuals.lme</a>)
vs fitted values by sample. Observations with absolute standardized (normalized) residuals greater than the <code class="reqn">1-0.05/2</code> quantile of the standard normal distribution
are identified in the plots labelled with the time point corresponding to the observation.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>data(grwth_data)
# Fit the model
lmm &lt;- lmmModel(
  data = grwth_data,
  sample_id = "subject",
  time = "Time",
  treatment = "Treatment",
  tumor_vol = "TumorVolume",
  trt_control = "Control",
  drug_a = "DrugA",
  drug_b = "DrugB",
  combination = "Combination",
  show_plot = FALSE
  )
# Generate plots 
plot_ranefDiagnostics(lmm)
# Access to specific plots
plot_ranefDiagnostics(lmm)[[1]]
plot_ranefDiagnostics(lmm)[[2]]
</code></pre>

<hr>
<h2 id='plot_residDiagnostics'>Plots for residuals diagnostics</h2><span id='topic+plot_residDiagnostics'></span>

<h3>Description</h3>

<p>Visualization of residuals diagnostics for a fitted linear mixed model of tumor growth data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_residDiagnostics(model)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_residDiagnostics_+3A_model">model</code></td>
<td>
<p>An object of class &quot;lme&quot; representing the linear mixed-effects model fitted by <code><a href="#topic+lmmModel">lmmModel()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with different plots for evaluating the normality and homoscedasticity of the normalized residuals
(standardized residuals pre-multiplied by the inverse square-root factor of the estimated error correlation matrix, see <a href="nlme.html#topic+residuals.lme">nlme::residuals.lme</a>), including:
</p>

<ul>
<li><p> A normal Q-Q plot of the normalized residuals of the model.
</p>
</li>
<li><p> A normal Q-Q plot of the normalized residuals of the model by Time.
</p>
</li>
<li><p> A normal Q-Q plot of the normalized residuals of the model by Treatment.
</p>
</li>
<li><p> A dotplot of normalized residuals vs fitted values.
</p>
</li>
<li><p> A dotplot of the normalized residuals by Time and Treatment.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>data(grwth_data)
# Fit the model
lmm &lt;- lmmModel(
  data = grwth_data,
  sample_id = "subject",
  time = "Time",
  treatment = "Treatment",
  tumor_vol = "TumorVolume",
  trt_control = "Control",
  drug_a = "DrugA",
  drug_b = "DrugB",
  combination = "Combination",
  show_plot = FALSE
  )
# Generate plots 
plot_residDiagnostics(lmm)
# Access to specific plots
plot_residDiagnostics(lmm)[[1]]
plot_residDiagnostics(lmm)[[2]]
</code></pre>

<hr>
<h2 id='plot_SynergyLMM'>Plotting SynergyLMM results</h2><span id='topic+plot_SynergyLMM'></span>

<h3>Description</h3>

<p>Generic function to generate different types of plots based on SynergyLMM outputs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_SynergyLMM(object, plot_type = "lmmModel", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_SynergyLMM_+3A_object">object</code></td>
<td>
<p>An object generated by <code><a href="#topic+lmmModel">lmmModel()</a></code> or <code><a href="#topic+lmmSynergy">lmmSynergy()</a></code> functions.</p>
</td></tr>
<tr><td><code id="plot_SynergyLMM_+3A_plot_type">plot_type</code></td>
<td>
<p>String indicating the type of plot to generate. Possible options include:
</p>

<ul>
<li><p> &quot;lmmModel&quot; for plotting of tumor growth data from a fitted model.
</p>
</li>
<li><p> &quot;lmmSynergy&quot; for plotting synergy results.
</p>
</li>
<li><p> &quot;ObsvsPred&quot; for generating plots of Observed vs Predicted Values.
</p>
</li>
<li><p> &quot;ranefDiagnostics&quot; for plots of random effects diagnostics.
</p>
</li>
<li><p> &quot;residDiagnostics&quot; for plots of residual diagnostics.
</p>
</li></ul>
</td></tr>
<tr><td><code id="plot_SynergyLMM_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to the specific plot function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Different output plots are produced depending on the <code>plot_type</code> selected.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot_lmmModel">plot_lmmModel()</a></code>, <code><a href="#topic+plot_lmmSynergy">plot_lmmSynergy()</a></code>, <code><a href="#topic+plot_ObsvsPred">plot_ObsvsPred()</a></code>, <code><a href="#topic+plot_ranefDiagnostics">plot_ranefDiagnostics()</a></code>, <code><a href="#topic+plot_residDiagnostics">plot_residDiagnostics()</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(grwth_data)
# Fit the model
lmm &lt;- lmmModel(
  data = grwth_data,
  sample_id = "subject",
  time = "Time",
  treatment = "Treatment",
  tumor_vol = "TumorVolume",
  trt_control = "Control",
  drug_a = "DrugA",
  drug_b = "DrugB",
  combination = "Combination",
  show_plot = FALSE
  )
  
# Plot lmmModel
plot_SynergyLMM(lmm, plot_type = "lmmModel",
trt_control = "Control",
drug_a = "DrugA",
drug_b = "DrugB",
combination = "Combination"
)

# Plot ObsvsPred
plot_SynergyLMM(lmm, plot_type = "ObsvsPred")

# Plot ranefDiagnostics
plot_SynergyLMM(lmm, plot_type = "ranefDiagnostics")

# Plot residDiagnostics
plot_SynergyLMM(lmm, plot_type = "residDiagnostics")

# Plot lmmSynergy
lmmSyn &lt;- lmmSynergy(lmm)
plot_SynergyLMM(lmmSyn, plot_type = "lmmSynergy")
</code></pre>

<hr>
<h2 id='PostHocPwr'>Post hoc power calculation based on simulations of the synergy evaluation using LMM.</h2><span id='topic+PostHocPwr'></span>

<h3>Description</h3>

<p><code>PostHocPwr</code> allows for the <em>post hoc</em> power analysis of the synergy hypothesis testing for Bliss and HSA refence
models for a given tumor growth data fitted model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PostHocPwr(model, nsim = 1000, method = "Bliss", pvalue = 0.05, time = NA, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PostHocPwr_+3A_model">model</code></td>
<td>
<p>An object of class &quot;lme&quot; representing the linear mixed-effects model fitted by <code><a href="#topic+lmmModel">lmmModel()</a></code>.</p>
</td></tr>
<tr><td><code id="PostHocPwr_+3A_nsim">nsim</code></td>
<td>
<p>Number of simulations to perform.</p>
</td></tr>
<tr><td><code id="PostHocPwr_+3A_method">method</code></td>
<td>
<p>String indicating the method for synergy calculation. Possible methods are &quot;Bliss&quot; and &quot;HSA&quot;,
corresponding to Bliss and highest single agent, respectively.</p>
</td></tr>
<tr><td><code id="PostHocPwr_+3A_pvalue">pvalue</code></td>
<td>
<p>Threshold for the p-value of synergy calculation to be considered statistically significant.</p>
</td></tr>
<tr><td><code id="PostHocPwr_+3A_time">time</code></td>
<td>
<p>Time point for which to calculate the statistical power. If not specified, the last time point is used
by default.</p>
</td></tr>
<tr><td><code id="PostHocPwr_+3A_...">...</code></td>
<td>
<p>Additional parameters to be passed to <a href="nlmeU.html#topic+simulateY">nlmeU::simulateY</a>:</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <em>post hoc</em> power calculation relies on simulation of the dependent variable, using <a href="nlmeU.html#topic+simulateY">nlmeU::simulateY</a>.
</p>

<ol>
<li><p> For a given fitted model of the tumor growth data, <code>nsim</code> simulations of the dependent variable (<code class="reqn">\log (RTV)</code>)
are done, based on the marginal distribution implied by the fitted model.
</p>
</li>
<li><p> The model is then fitted to the new values of the dependant variable.
</p>
</li>
<li><p> For each simulation, the new estimates from each model are then used for the synergy hypothesis testing as
explained in <a href="#topic+lmmSynergy">lmmSynergy</a>, and the p-values stored.
</p>
</li>
<li><p> The power is returned as the proportion of simulations resulting in a significant synergy hypothesis testing
(p-value &lt; <code>pvalue</code>).
</p>
</li></ol>

<p>When <code>time</code> is specified, <code>PostHocPwr</code> refits the model using the data from the <code>time_start</code> time point defined in <code><a href="#topic+lmmModel">lmmModel()</a></code> until <code>time</code>, and report the
statistical power for that model. If <code>time</code> is not specified, the model fitted using all data points is used for statistical power calculation.
</p>


<h3>Value</h3>

<p>Returns a numeric value of the power for the synergy calculation for the model using the method specified in <code>method</code>.
The power is expressed as the proportion of simulations that provides a p-value below the threshold specified in <code>pvalue</code>.
</p>


<h3>References</h3>

<p>Andrzej Galecki &amp; Tomasz Burzykowski (2013) <em>Linear Mixed-Effects Models Using R: A Step-by-Step Approach</em> First Edition. Springer, New York. ISBN 978-1-4614-3899-1
</p>


<h3>See Also</h3>

<p><code><a href="#topic+APrioriPwr">APrioriPwr()</a></code>, <code><a href="#topic+PwrSampleSize">PwrSampleSize()</a></code>, <code><a href="#topic+PwrTime">PwrTime()</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#' data(grwth_data)
# Fit the model
lmm &lt;- lmmModel(
  data = grwth_data,
  sample_id = "subject",
  time = "Time",
  treatment = "Treatment",
  tumor_vol = "TumorVolume",
  trt_control = "Control",
  drug_a = "DrugA",
  drug_b = "DrugB",
  combination = "Combination"
  )
 PostHocPwr(lmm, nsim = 50) # 50 simulations for shorter computing time
 # Using a seed to obtain reproducible results
 PostHocPwr(lmm, seed = 123, nsim = 50)
 # Calculating the power for an specific day
 PostHocPwr(lmm, nsim = 50, time = 6)

</code></pre>

<hr>
<h2 id='Pwr'>Calculates power based on a model fit</h2><span id='topic+Pwr'></span>

<h3>Description</h3>

<p>This function is generic; method functions can be written to handle specific classes of objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Pwr(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Pwr_+3A_object">object</code></td>
<td>
<p>an object containing the results returned by a model fitting function (e.g., <code>lme</code>).</p>
</td></tr>
<tr><td><code id="Pwr_+3A_...">...</code></td>
<td>
<p>some methods for this generic function may require additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric scalar value.
</p>


<h3>Author(s)</h3>

<p>Andrzej Galecki and Tomasz Burzykowski
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Pwr.lme">Pwr.lme</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("grwth_data")
lmm &lt;- lmmModel(data = grwth_data,
                sample_id = "subject",
                time = "Time",
                treatment = "Treatment",
                tumor_vol = "TumorVolume",
                trt_control = "Control",
                drug_a = "DrugA",
                drug_b = "DrugB",
                combination = "Combination")
Pwr(lmm,
    L = c("Time:TreatmentControl" = 1,
    "Time:TreatmentDrugA" = -1,
    "Time:TreatmentDrugB" = -1,
    "Time:TreatmentCombination" = 1))
 
</code></pre>

<hr>
<h2 id='Pwr.lme'>Performs power calculations</h2><span id='topic+Pwr.lme'></span>

<h3>Description</h3>

<p>This is method for <code>Pwr()</code> generic function. It is a modified version from the
one described by Galecki and Burzykowski implemented in <code>nlmeU</code> package (<a href="nlmeU.html#topic+Pwr.lme">nlmeU::Pwr.lme</a>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lme'
Pwr(
  object,
  ...,
  type = c("sequential", "marginal"),
  Terms,
  L,
  verbose = FALSE,
  sigma,
  ddf = numeric(0),
  alpha = 0.05,
  altB = NULL,
  tol = 1e-10
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Pwr.lme_+3A_object">object</code></td>
<td>
<p>an object containing <code>lme</code> fit, which provides information needed for power calculations</p>
</td></tr>
<tr><td><code id="Pwr.lme_+3A_...">...</code></td>
<td>
<p>some additional arguments may be required.</p>
</td></tr>
<tr><td><code id="Pwr.lme_+3A_type">type</code></td>
<td>
<p>an optional character string specifying the type of sum of squares to be used in F-tests
needed for power calculations. Syntax is the same as for <code>anova.lme()</code> in <code>nlme</code> package.</p>
</td></tr>
<tr><td><code id="Pwr.lme_+3A_terms">Terms</code></td>
<td>
<p>an optional integer or character vector specifying which terms
in the model should be jointly tested to be zero using a Wald F-test. See
<code>anova.lme</code> in <code>nlme</code> package for details.</p>
</td></tr>
<tr><td><code id="Pwr.lme_+3A_l">L</code></td>
<td>
<p>an optional numeric vector or array specifying linear combinations
of the coefficients in the model that should be tested to be zero. See
<code>anova.lme</code> in <code>nlme</code> package for details.</p>
</td></tr>
<tr><td><code id="Pwr.lme_+3A_verbose">verbose</code></td>
<td>
<p>an optional logical value. See <code>anova.lme</code> in nlme package for details.</p>
</td></tr>
<tr><td><code id="Pwr.lme_+3A_sigma">sigma</code></td>
<td>
<p>numeric scalar value.</p>
</td></tr>
<tr><td><code id="Pwr.lme_+3A_ddf">ddf</code></td>
<td>
<p>numeric scalar value. Argument can be used to redefine default number of denominator degrees of freedom</p>
</td></tr>
<tr><td><code id="Pwr.lme_+3A_alpha">alpha</code></td>
<td>
<p>numeric scalar value. By default 0.05.</p>
</td></tr>
<tr><td><code id="Pwr.lme_+3A_altb">altB</code></td>
<td>
<p>matrix/vector containing alternative values for beta parameters</p>
</td></tr>
<tr><td><code id="Pwr.lme_+3A_tol">tol</code></td>
<td>
<p>numeric scalar value.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data frame inheriting from class Pwr.lme
</p>


<h3>References</h3>


<ul>
<li><p> Andrzej Galecki &amp; Tomasz Burzykowski (2013) <em>Linear Mixed-Effects Models Using R: A Step-by-Step Approach</em> First Edition. Springer, New York. ISBN 978-1-4614-3899-1
</p>
</li></ul>



<h3>See Also</h3>

<p><a href="nlme.html#topic+anova.lme">nlme::anova.lme</a>, <a href="nlmeU.html#topic+Pwr.lme">nlmeU::Pwr.lme</a>
</p>

<hr>
<h2 id='PwrSampleSize'><em>A Priori</em> Synergy Power Analysis Based on Sample Size</h2><span id='topic+PwrSampleSize'></span>

<h3>Description</h3>

<p><em>A priori</em> power calculation for a hypothetical two-drugs combination study of synergy evaluation using linear-mixed models
depending on the sample size per group.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PwrSampleSize(
  npg = c(5, 8, 10),
  time = c(0, 3, 5, 10),
  grwrControl = 0.08,
  grwrA = 0.07,
  grwrB = 0.06,
  grwrComb = 0.03,
  sd_ranef = 0.01,
  sgma = 0.1,
  method = "Bliss",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PwrSampleSize_+3A_npg">npg</code></td>
<td>
<p>A vector with the sample size (number of subjects) per group to calculate the power of
the synergy analysis.</p>
</td></tr>
<tr><td><code id="PwrSampleSize_+3A_time">time</code></td>
<td>
<p>Vector with the times at which the tumor volume measurements have been performed.</p>
</td></tr>
<tr><td><code id="PwrSampleSize_+3A_grwrcontrol">grwrControl</code></td>
<td>
<p>Coefficient for Control treatment group tumor growth rate.</p>
</td></tr>
<tr><td><code id="PwrSampleSize_+3A_grwra">grwrA</code></td>
<td>
<p>Coefficient for Drug A treatment group tumor growth rate.</p>
</td></tr>
<tr><td><code id="PwrSampleSize_+3A_grwrb">grwrB</code></td>
<td>
<p>Coefficient for Drug B treatment group tumor growth rate.</p>
</td></tr>
<tr><td><code id="PwrSampleSize_+3A_grwrcomb">grwrComb</code></td>
<td>
<p>Coefficient for Combination (Drug A + Drug B) treatment group tumor growth rate.</p>
</td></tr>
<tr><td><code id="PwrSampleSize_+3A_sd_ranef">sd_ranef</code></td>
<td>
<p>Random effects standard deviation for the model.</p>
</td></tr>
<tr><td><code id="PwrSampleSize_+3A_sgma">sgma</code></td>
<td>
<p>Residuals standard deviation for the model.</p>
</td></tr>
<tr><td><code id="PwrSampleSize_+3A_method">method</code></td>
<td>
<p>String indicating the method for synergy calculation. Possible methods are &quot;Bliss&quot; and &quot;HSA&quot;,
corresponding to Bliss and highest single agent, respectively.</p>
</td></tr>
<tr><td><code id="PwrSampleSize_+3A_...">...</code></td>
<td>
<p>Additional parameters to be passed to <a href="nlmeU.html#topic+Pwr.lme">nlmeU::Pwr.lme</a> method.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>PwrSampleSize</code> allows the user to define an hypothetical drug combination study, customizing several
experimental parameters, such as the sample size, time of measurements, or drug effect,
for the power evaluation of synergy for Bliss and HSA reference models. The power calculation is
based on F-tests of the fixed effects of the model as previously described (Helms, R. W. (1992),
Verbeke and Molenberghs (2009), Ga≈Çecki and Burzykowski (2013)).
</p>
<p>The focus the power analysis with <code>PwrSampleSize</code> is on the <strong>sample size per group</strong>. The function allows
for the evaluation of how the statistical power changes when the sample size per group varies while the
other parameters are kept constant. For other <em>a priori</em> power analysis see also <code><a href="#topic+APrioriPwr">APrioriPwr()</a></code> and <code><a href="#topic+PwrTime">PwrTime()</a></code>.
</p>

<ul>
<li> <p><code>time</code>, <code>grwrControl</code>, <code>grwrA</code>, <code>grwrB</code>, <code>grwrComb</code>, <code>sd_ranef</code> and <code>sgma</code> are parameters referring to
the initial exemplary data set and corresponding fitted model. These values can be obtained from a fitted model, using <code><a href="#topic+lmmModel_estimates">lmmModel_estimates()</a></code>,
or be defined by the user.
</p>
</li>
<li> <p><code>npg</code> is a vector indicating the different sample sizes for which the statistical power is going to be evaluated, keeping the
rest of parameters fixed.
</p>
</li></ul>



<h3>Value</h3>

<p>The functions returns two plots:
</p>

<ul>
<li><p> A plot representing the hypothetical data, with the regression lines for each
treatment group according to <code>grwrControl</code>, <code>grwrA</code>, <code>grwrB</code> and <code>grwrComb</code> values. The values
assigned to <code>sd_ranef</code> and <code>sgma</code> are also shown.
</p>
</li>
<li><p> A plot showing the values of the power calculation depending on the values assigned to
<code>npg</code>.
</p>
</li></ul>

<p>The function also returns the data frame with the power for the analysis for each sample size
specified in <code>npg</code>.
</p>


<h3>References</h3>


<ul>
<li><p> Helms, R. W. (1992). <em>Intentionally incomplete longitudinal designs: I. Methodology and comparison of some full span designs</em>. Statistics in Medicine, 11(14‚Äì15), 1889‚Äì1913. https://doi.org/10.1002/sim.4780111411
</p>
</li>
<li><p> Verbeke, G. &amp; Molenberghs, G. (2000). <em>Linear Mixed Models for Longitudinal Data</em>. Springer New York. https://doi.org/10.1007/978-1-4419-0300-6
</p>
</li>
<li><p> Andrzej Galecki &amp; Tomasz Burzykowski (2013) <em>Linear Mixed-Effects Models Using R: A Step-by-Step Approach</em> First Edition. Springer, New York. ISBN 978-1-4614-3899-1
</p>
</li></ul>



<h3>See Also</h3>

<p><a href="#topic+PostHocPwr">PostHocPwr</a>, <code><a href="#topic+APrioriPwr">APrioriPwr()</a></code>, <code><a href="#topic+PwrTime">PwrTime()</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>PwrSampleSize(npg = 1:20)

</code></pre>

<hr>
<h2 id='PwrTime'><em>A Priori</em> Synergy Power Analysis Based on Time</h2><span id='topic+PwrTime'></span>

<h3>Description</h3>

<p><em>A priori</em> power calculation for a hypothetical two-drugs combination study of synergy
depending on the time of follow-up or the frequency of measurements.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PwrTime(
  npg = 5,
  time = list(seq(0, 9, 3), seq(0, 21, 3), seq(0, 30, 3)),
  type = "max",
  grwrControl = 0.08,
  grwrA = 0.07,
  grwrB = 0.06,
  grwrComb = 0.03,
  sd_ranef = 0.01,
  sgma = 0.1,
  method = "Bliss",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PwrTime_+3A_npg">npg</code></td>
<td>
<p>Number of mouse per group.</p>
</td></tr>
<tr><td><code id="PwrTime_+3A_time">time</code></td>
<td>
<p>A list in which each element is a vector with the times at which the tumor volume measurements have been performed.
If <code>type</code> is set to &quot;max&quot;, each vector in the list should represent measurements taken at the same interval and differ in the final
time of follow-up. If <code>type</code> is set to &quot;freq&quot;, each vector in the list should have the same final time of follow-up and
differ in the intervals at which the measurements have been taken.</p>
</td></tr>
<tr><td><code id="PwrTime_+3A_type">type</code></td>
<td>
<p>String indicating whether to calculate the power depending on the time of follow-up (&quot;max&quot;), or the frequency
of measurements (&quot;freq&quot;).</p>
</td></tr>
<tr><td><code id="PwrTime_+3A_grwrcontrol">grwrControl</code></td>
<td>
<p>Coefficient for Control treatment group tumor growth rate.</p>
</td></tr>
<tr><td><code id="PwrTime_+3A_grwra">grwrA</code></td>
<td>
<p>Coefficient for Drug A treatment group tumor growth rate.</p>
</td></tr>
<tr><td><code id="PwrTime_+3A_grwrb">grwrB</code></td>
<td>
<p>Coefficient for Drug B treatment group tumor growth rate.</p>
</td></tr>
<tr><td><code id="PwrTime_+3A_grwrcomb">grwrComb</code></td>
<td>
<p>Coefficient for Combination (Drug A + Drug B) treatment group tumor growth rate.</p>
</td></tr>
<tr><td><code id="PwrTime_+3A_sd_ranef">sd_ranef</code></td>
<td>
<p>Random effects standard deviation for the model.</p>
</td></tr>
<tr><td><code id="PwrTime_+3A_sgma">sgma</code></td>
<td>
<p>Residuals standard deviation for the model.</p>
</td></tr>
<tr><td><code id="PwrTime_+3A_method">method</code></td>
<td>
<p>String indicating the method for synergy calculation. Possible methods are &quot;Bliss&quot; and &quot;HSA&quot;,
corresponding to Bliss and highest single agent, respectively.</p>
</td></tr>
<tr><td><code id="PwrTime_+3A_...">...</code></td>
<td>
<p>Additional parameters to be passed to <a href="nlmeU.html#topic+Pwr.lme">nlmeU::Pwr.lme</a> method.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>PwrTime</code> allows the user to define an hypothetical drug combination study, customizing several
experimental parameters, such as the sample size, time of measurements, or drug effect,
for the power evaluation of synergy for Bliss and HSA reference models. The power calculation is
based on F-tests of the fixed effects of the model as previously described (Helms, R. W. (1992),
Verbeke and Molenberghs (2009), Ga≈Çecki and Burzykowski (2013)).
</p>
<p>The focus the power analysis with <code>PwrTime</code> is on the <strong>time</strong> at which the measurements are done. The function allows
for the evaluation of how the statistical power changes when the time of follow-up varies while the frequency
of measurements is keep constant. It also allows to how the statistical power changes when the time of follow-up is
kept constant, but the frequency of measurements varies.
</p>
<p>For other <em>a priori</em> power analysis see also <code><a href="#topic+APrioriPwr">APrioriPwr()</a></code> and <code><a href="#topic+PwrSampleSize">PwrSampleSize()</a></code>.
</p>

<ul>
<li> <p><code>npg</code>, <code>grwrControl</code>, <code>grwrA</code>, <code>grwrB</code>, <code>grwrComb</code>, <code>sd_ranef</code> and <code>sgma</code> are parameters referring to
the initial exemplary data set and corresponding fitted model. These values can be obtained from a fitted model, using <code><a href="#topic+lmmModel_estimates">lmmModel_estimates()</a></code>,
or be defined by the user.
</p>
</li>
<li> <p><code>time</code> is a list in which each element is a vector with the times at which the tumor volume measurements have been performed, and for
which the statistical power is going to be evaluated, keeping the rest of parameters fixed.
</p>
</li></ul>



<h3>Value</h3>

<p>The functions returns two plots:
</p>

<ul>
<li><p> A plot representing the hypothetical data, with the regression lines for each
treatment group according to <code>grwrControl</code>, <code>grwrA</code>, <code>grwrB</code> and <code>grwrComb</code> values. The values
assigned to <code>sd_ranef</code> and <code>sgma</code> are also shown.
</p>
</li>
<li><p> A plot showing the values of the power calculation depending on the values assigned to
<code>Time</code>. If <code>type</code> is set to &quot;max&quot;, the plot shows how the power varies depending on the maximum time of follow-up.
If <code>type</code> is set to &quot;freq&quot;, the plot shows how the power varies depending on how frequently the measurements have
been performed.
</p>
</li></ul>

<p>The function also returns the data frame with the power for the analysis for each value specified in <code> Time</code>.
</p>


<h3>References</h3>


<ul>
<li><p> Helms, R. W. (1992). <em>Intentionally incomplete longitudinal designs: I. Methodology and comparison of some full span designs</em>. Statistics in Medicine, 11(14‚Äì15), 1889‚Äì1913. https://doi.org/10.1002/sim.4780111411
</p>
</li>
<li><p> Verbeke, G. &amp; Molenberghs, G. (2000). <em>Linear Mixed Models for Longitudinal Data</em>. Springer New York. https://doi.org/10.1007/978-1-4419-0300-6
</p>
</li>
<li><p> Andrzej Galecki &amp; Tomasz Burzykowski (2013) <em>Linear Mixed-Effects Models Using R: A Step-by-Step Approach</em> First Edition. Springer, New York. ISBN 978-1-4614-3899-1
</p>
</li></ul>



<h3>See Also</h3>

<p><a href="#topic+PostHocPwr">PostHocPwr</a>, <code><a href="#topic+APrioriPwr">APrioriPwr()</a></code>, <code><a href="#topic+PwrSampleSize">PwrSampleSize()</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Power analysis maintaining the frequency of measurements 
# and varying the time of follow-up ('type = "max"')
PwrTime(time = list(seq(0, 9, 3), 
                    seq(0, 12, 3), 
                    seq(0, 15, 3), 
                    seq(0, 21, 3), 
                    seq(0, 30, 3)), 
                    type = "max")

# Power analysis maintaining the time of follow-up 
# and varying the frequency of measurements ('type = "freq"')
PwrTime(time = list(seq(0, 10, 1), 
                    seq(0, 10, 2), 
                    seq(0, 10, 5), 
                    seq(0, 10, 10)), 
                    type = "freq")
</code></pre>

<hr>
<h2 id='ranefDiagnostics'>Diagnostics of random effects of the linear mixed model</h2><span id='topic+ranefDiagnostics'></span>

<h3>Description</h3>

<p><code>ranefDiagnostics</code> provides several plots as well as statistical test for the examination
of the normality of the random effects of the input model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ranefDiagnostics(model, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ranefDiagnostics_+3A_model">model</code></td>
<td>
<p>An object of class &quot;lme&quot; representing the linear mixed-effects model fitted by <code><a href="#topic+lmmModel">lmmModel()</a></code>.</p>
</td></tr>
<tr><td><code id="ranefDiagnostics_+3A_verbose">verbose</code></td>
<td>
<p>Logical indicating if the normality and homoscedasticity tests results should be printed to the console.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>One of the assumptions of the model obtained with <code><a href="#topic+lmmModel">lmmModel()</a></code> (as in any other linear mixed model) is that
the random effects are normally distributed:
</p>
<p style="text-align: center;"><code class="reqn">b_i = N(0,\psi)</code>
</p>

<p>For the evaluation of this assumption, <code>ranefDiagnostics</code> provides Q-Q plots of random effects,
together with statistical assessment of their normality using Shapiro-Wilk, D'Agostini and Anderson-Darling normality tests.
Additionally, Q-Q plots of the normalized residuals
(standardized residuals pre-multiplied by the inverse square-root factor of the estimated error correlation matrix, see <a href="nlme.html#topic+residuals.lme">nlme::residuals.lme</a>)
by sample are provided to allow for the identification of subjects
which could be notably different from the others and be affecting the adequacy of the model.
Additionally, boxplots of the &quot;raw&quot; residuals (observed - fitted) by sample and scatter plots of the normalized residuals versus fitted values by sample
are provided to give information about variability of the residuals by subject and possible outlier observations. Observations with absolute standardized (normalized)
residuals greater than the <code class="reqn">1-0.05/2</code> quantile of the standard normal distribution
are identified in the scatter plots labelled with the time point corresponding to the observation.
</p>


<h3>Value</h3>

<p>A list with different elements for the diagnostics of the random effects are produced:
</p>

<ul>
<li> <p><code>plots</code>: Different plots for evaluating the normality and homoscedasticity of the random effects are produced.
</p>
</li>
<li> <p><code>Normality</code>: List with the results from 3 different test of the normality of the random effects: Shapiro - Wilk normality test,
D'Agostino normality test and Anderson - Darling normality test.
</p>
</li>
<li> <p><code>Levene.test</code>: results from Levene homoscedasticity test (<code><a href="car.html#topic+leveneTest">car::leveneTest()</a></code>) of the normalized residuals by SampleID (i.e., by subject).
</p>
</li>
<li> <p><code>Fligner.test</code>: results from Fligner homoscedasticity test (<code><a href="stats.html#topic+fligner.test">stats::fligner.test()</a></code>) of the normalized residuals by SampleID (i.e., by subject).
</p>
</li></ul>



<h3>References</h3>


<ul>
<li><p> Pinheiro JC, Bates DM (2000). <em>Mixed-Effects Models in S and S-PLUS</em>. Springer, New York. <a href="https://doi.org/10.1007/b98882">doi:10.1007/b98882</a>.
</p>
</li>
<li><p> Andrzej Galecki &amp; Tomasz Burzykowski (2013) <em>Linear Mixed-Effects Models Using R: A Step-by-Step Approach</em> First Edition. Springer, New York. ISBN 978-1-4614-3899-1
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+plot_ranefDiagnostics">plot_ranefDiagnostics()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load the example data
data(grwth_data)
# Fit the model
lmm &lt;- lmmModel(
  data = grwth_data,
  sample_id = "subject",
  time = "Time",
  treatment = "Treatment",
  tumor_vol = "TumorVolume",
  trt_control = "Control",
  drug_a = "DrugA",
  drug_b = "DrugB",
  combination = "Combination"
  )
# Run random effects diagnostics
ranef_diag &lt;- ranefDiagnostics(lmm)

#Access to individual plots

ranef_diag$Plots[1]
ranef_diag$Plots[2]

# Access to normality tests

ranef_diag$Normality

ranef_diag$Normality$Shapiro.test

# Access to homoscedasticity tests of residuals by subject

ranef_diag$Levene.test

ranef_diag$Fligner.test

</code></pre>

<hr>
<h2 id='residDiagnostics'>Diagnostics of residuals of the linear mixed model</h2><span id='topic+residDiagnostics'></span>

<h3>Description</h3>

<p><code>residDiagnostics</code> provides several plots as well as statistical test for the examination
of the normality and homoscedasticity of the residuals of the input model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>residDiagnostics(model, pvalue = 0.05, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="residDiagnostics_+3A_model">model</code></td>
<td>
<p>An object of class &quot;lme&quot; representing the linear mixed-effects model fitted by <code><a href="#topic+lmmModel">lmmModel()</a></code>.</p>
</td></tr>
<tr><td><code id="residDiagnostics_+3A_pvalue">pvalue</code></td>
<td>
<p>Threshold for the p-value of outlier observations based on their normalized residuals.</p>
</td></tr>
<tr><td><code id="residDiagnostics_+3A_verbose">verbose</code></td>
<td>
<p>Logical indicating if the normality and homoscedasticity tests results, and the list of potential
outlier observations should be printed to the console.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>One of the assumption of the model fit by <code><a href="#topic+lmmModel">lmmModel()</a></code> is that the residuals are normally distributed.
For the evaluation of this assumption, <code>residDiagnostics</code> provides Q-Q plots of the normalized residuals
(standardized residuals pre-multiplied by the inverse square-root factor of the estimated error correlation matrix, see <a href="nlme.html#topic+residuals.lme">nlme::residuals.lme</a>),
together with statistical assessment of their
normality using Shapiro-Wilk, D'Agostini and Anderson-Darling normality tests. Additionally, Q-Q plots of the normalized residuals by time point and
treatment group are provided to be able to detect time points or treatment groups which could be notably different from the others and be
affecting the adequacy of the model.
</p>
<p>Scatter plots of the normalized residuals versus fitted values and normalized residuals
per time and per treatment are also provided to give information about variability of the residuals and possible outlier observations. These plots are accompanied
by Levene and Fligner-Killend homogeneity of variance test results.
</p>
<p>Observations with absolute standardized (normalized) residuals greater than the <code class="reqn">1-0.05/2</code> quantile of the standard normal distribution
are identified and reported as potential outlier observations.
</p>


<h3>Value</h3>

<p>A list with different elements for the diagnostics of the residuals are produced:
</p>

<ul>
<li> <p><code>plots</code>: Different plots for evaluating the normality and homocedasticity of the residuals.
</p>
</li>
<li> <p><code>outliers</code>: Data frame with the identified outliers based on the Pearson residuals and the value of <code>pval</code>. The column <code>resid.p</code> contains the
value of the Pearson residuals for each observation.
</p>
</li>
<li> <p><code>Normality</code>: List with the results from 3 different test of the normality of the normalized residuals of the model: Shapiro - Wilk normality test,
D'Agostino normality test and Anderson - Darling normality test.
</p>
</li>
<li> <p><code>Levene.test</code>: List with the Levene homoscedasticity test results of the normalized residuals by Time and Treatment.
</p>
</li>
<li> <p><code>Fligner.test</code>: List with the Fligner-Killeen homoscedasticity test results of the normalized residuals by Time and Treatment.
</p>
</li></ul>



<h3>References</h3>


<ul>
<li><p> Pinheiro JC, Bates DM (2000). <em>Mixed-Effects Models in S and S-PLUS</em>. Springer, New York. <a href="https://doi.org/10.1007/b98882">doi:10.1007/b98882</a>.
</p>
</li>
<li><p> Andrzej Galecki &amp; Tomasz Burzykowski (2013) <em>Linear Mixed-Effects Models Using R: A Step-by-Step Approach</em> First Edition. Springer, New York. ISBN 978-1-4614-3899-1
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># Load the example data
data(grwth_data)
# Fit the model
lmm &lt;- lmmModel(
  data = grwth_data,
  sample_id = "subject",
  time = "Time",
  treatment = "Treatment",
  tumor_vol = "TumorVolume",
  trt_control = "Control",
  drug_a = "DrugA",
  drug_b = "DrugB",
  combination = "Combination"
  )
  
# Residuals diagnostics
resid_diag &lt;- residDiagnostics(model = lmm, pvalue = 0.05)

# Access outliers data frame
resid_diag$Outliers

# Access individual plots
resid_diag$Plots[1]
resid_diag$Plots[2]

# Access results of normality tests
resid_diag$Normality
resid_diag$Normality$Shapiro.test

# Access to homoscedasticity test results

resid_diag$Levene.test

resid_diag$Fligner.test

</code></pre>

<hr>
<h2 id='simulateTumorGrowth'>Helper function to simulate tumor growth data for a two-drug combination experiment.</h2><span id='topic+simulateTumorGrowth'></span>

<h3>Description</h3>

<p>Helper function to simulate tumor growth data for a two-drug combination experiment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulateTumorGrowth(
  npg = 5,
  timepoints = c(0, 3, 5, 10),
  initial_volume = 100,
  grwrControl = 0.08,
  grwrA = 0.07,
  grwrB = 0.06,
  grwrComb = 0.04,
  sd = 0.1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simulateTumorGrowth_+3A_npg">npg</code></td>
<td>
<p>Number of samples per group.</p>
</td></tr>
<tr><td><code id="simulateTumorGrowth_+3A_timepoints">timepoints</code></td>
<td>
<p>Vector with the time points at which the tumor volume measurements have been performed.</p>
</td></tr>
<tr><td><code id="simulateTumorGrowth_+3A_initial_volume">initial_volume</code></td>
<td>
<p>Initial volume for the tumor growth.</p>
</td></tr>
<tr><td><code id="simulateTumorGrowth_+3A_grwrcontrol">grwrControl</code></td>
<td>
<p>Coefficient for Control treatment group tumor growth rate.</p>
</td></tr>
<tr><td><code id="simulateTumorGrowth_+3A_grwra">grwrA</code></td>
<td>
<p>Coefficient for Drug A treatment group tumor growth rate.</p>
</td></tr>
<tr><td><code id="simulateTumorGrowth_+3A_grwrb">grwrB</code></td>
<td>
<p>Coefficient for Drug B treatment group tumor growth rate.</p>
</td></tr>
<tr><td><code id="simulateTumorGrowth_+3A_grwrcomb">grwrComb</code></td>
<td>
<p>Coefficient for Combination (Drug A + Drug B) treatment group tumor growth rate.</p>
</td></tr>
<tr><td><code id="simulateTumorGrowth_+3A_sd">sd</code></td>
<td>
<p>Variability for the tumor growth.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function simulates the tumor growth following exponential kinetics,
given by
</p>
<p style="text-align: center;"><code class="reqn">TV(t) = TV_0 \cdot e^{\beta_i \cdot t}</code>
</p>

<p>where <code class="reqn">TV_0</code> is given by <code>initial_volume</code>, <code class="reqn">t</code> is given by <code>timepoints</code>
and <code class="reqn">\beta_i</code> are the coefficients given by <code>grwrControl</code>, <code>grwrA</code>, <code>grwrB</code>, and <code>grwrComb</code>.
</p>
<p>The variability is simulated using the <code>sd</code> argument to add random noise from a normal distribution <code class="reqn">N(1, SD)</code>,
with <code class="reqn">SD</code> = <code>sd</code>.
</p>


<h3>Value</h3>

<p>A data frame with tumor growth data in long format.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># This code generates the 'grwth_data' example dataset:
set.seed(123)
grwth_data &lt;- simulateTumorGrowth(npg = 8, timepoints = seq(0,30,3), 
                                   initial_volume = 200, grwrControl = 0.08,
                                   grwrA = 0.07, grwrB = 0.065, 
                                   grwrComb = 0.04, sd = 0.2)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
