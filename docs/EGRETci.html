<!DOCTYPE html><html lang="en"><head><title>Help for package EGRETci</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {EGRETci}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#EGRETci-package'><p>EGRETci package for bootstrap hypothesis tests and confidence interval analysis for WRTDS (Weighted</p>
Regressions on Time, Discharge, and Season) statistical models. This
package is designed to be used in conjunction with the EGRET package,
which estimates and describes WRTDS models.</a></li>
<li><a href='#blockSample'><p>blockSample</p></a></li>
<li><a href='#bootAnnual'><p>Single confidence interval bootstrap run</p></a></li>
<li><a href='#Choptank_eBoot'><p>Example eBoot</p></a></li>
<li><a href='#ciBands'><p>Confidence Interval Band Calculations</p></a></li>
<li><a href='#ciCalculations'><p>ciCalculations</p></a></li>
<li><a href='#genDailyBoot'><p>WRTDSKalman Bootstrapping</p></a></li>
<li><a href='#makeAnnualPI'><p>Make Annual Prediction Intervals</p></a></li>
<li><a href='#makeDailyPI'><p>Make Daily Prediction Intervals</p></a></li>
<li><a href='#makeMonthPI'><p>Make Monthly Prediction Intervals</p></a></li>
<li><a href='#monthSeqToDec'><p>monthSeqToDec</p></a></li>
<li><a href='#plotConcHistBoot'><p>Graph of annual concentration, flow normalized concentration,</p>
and confidence bands for flow normalized concentrations</a></li>
<li><a href='#plotFluxHistBoot'><p>Graph of annual flux, flow normalized flux, and confidence bands for flow normalized flux</p></a></li>
<li><a href='#plotHistogramTrend'><p>plotHistogramTrend</p></a></li>
<li><a href='#pVal'><p>pVal</p></a></li>
<li><a href='#runGroupsBoot'><p>The bootstrap uncertainty analysis for runGroups results</p></a></li>
<li><a href='#runPairsBoot'><p>The bootstrap uncertainty analysis for runPairs results</p></a></li>
<li><a href='#saveEGRETci'><p>Save EGRETci workspace after running wBT (the WRTDS bootstrap test)</p></a></li>
<li><a href='#setForBoot'><p>Allows user to set window parameters for the WRTDS model prior to running the bootstrap procedure</p></a></li>
<li><a href='#trendSetUp'><p>Interactive setup for running wBT, the WRTDS Bootstrap Test</p></a></li>
<li><a href='#wBT'><p>Run the WBT (WRTDS Bootstrap Test)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Exploration and Graphics for RivEr Trends Confidence Intervals</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0.4</td>
</tr>
<tr>
<td>Description:</td>
<td>Collection of functions to evaluate uncertainty of results from
    water quality analysis using the Weighted Regressions on Time Discharge and
    Season (WRTDS) method. This package is an add-on to the EGRET package that
    performs the WRTDS analysis. The WRTDS modeling
    method was initially introduced and discussed in Hirsch et al. (2010) &lt;<a href="https://doi.org/10.1111%2Fj.1752-1688.2010.00482.x">doi:10.1111/j.1752-1688.2010.00482.x</a>&gt;,
    and expanded in Hirsch and De Cicco (2015) &lt;<a href="https://doi.org/10.3133%2Ftm4A10">doi:10.3133/tm4A10</a>&gt;. The 
    paper describing the uncertainty and confidence interval calculations 
    is Hirsch et al. (2015) &lt;<a href="https://doi.org/10.1016%2Fj.envsoft.2015.07.017">doi:10.1016/j.envsoft.2015.07.017</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://creativecommons.org/publicdomain/zero/1.0/legalcode">CC0</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>EGRET(&ge; 3.0.5), binom, stats, graphics, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, testthat, doParallel, iterators, rmarkdown, pkgdown,
covr</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>BuildVignettes:</td>
<td>true</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/USGS-R/EGRETci">https://github.com/USGS-R/EGRETci</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/USGS-R/EGRETci/issues">https://github.com/USGS-R/EGRETci/issues</a></td>
</tr>
<tr>
<td>Copyright:</td>
<td>This software is in the public domain because it contains
materials that originally came from the United States
Geological Survey, an agency of the United States Department of
Interior. For more information, see the official USGS copyright
policy at
http://www.usgs.gov/visual-id/credit_usgs.html#copyright</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-04-13 14:54:26 UTC; ldecicco</td>
</tr>
<tr>
<td>Author:</td>
<td>Laura DeCicco <a href="https://orcid.org/0000-0002-3915-9487"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Robert Hirsch <a href="https://orcid.org/0000-0002-4534-075X"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Jennifer Murphy [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Laura DeCicco &lt;ldecicco@usgs.gov&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-04-13 15:10:11 UTC</td>
</tr>
</table>
<hr>
<h2 id='EGRETci-package'>EGRETci package for bootstrap hypothesis tests and confidence interval analysis for WRTDS (Weighted 
Regressions on Time, Discharge, and Season) statistical models. This 
package is designed to be used in conjunction with the EGRET package, 
which estimates and describes WRTDS models.</h2><span id='topic+EGRETci-package'></span>

<h3>Description</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> EGRETci</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> Unlimited for this package, dependencies have more restrictive licensing.</td>
</tr>
<tr>
 <td style="text-align: left;">
Copyright: </td><td style="text-align: left;"> This software is in the public domain because it contains materials
that originally came from the United States Geological Survey, an agency of
the United States Department of Interior. For more information, see the
official USGS copyright policy at
http://www.usgs.gov/visual-id/credit_usgs.html#copyright</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Collection of functions to evaluate uncertainty of results from water quality analysis using 
the Weighted Regressions on Time Discharge and Season (WRTDS) method. This package is an add-on 
to the EGRET package that performs the WRTDS analysis.
</p>


<h3>Author(s)</h3>

<p>Robert M. Hirsch <a href="mailto:rhirsch@usgs.gov">rhirsch@usgs.gov</a>, Laura De Cicco <a href="mailto:ldecicco@usgs.gov">ldecicco@usgs.gov</a>
</p>


<h3>References</h3>

<p>Hirsch, R.M., and De Cicco, L.A., 2015, User guide to Exploration and Graphics for RivEr Trends 
(EGRET) and dataRetrieval: R packages for hydrologic data: U.S. Geological Survey Techniques and Methods book 4, 
chap. A10, 94 p., doi: <a href="https://doi.org/10.3133/tm4A10">10.3133/tm4A10</a>
</p>
<p>Hirsch, R.M., Archfield, S.A., and De Cicco, L.A., 2015, 
A bootstrap method for estimating uncertainty of water quality trends.  
Environmental Modelling &amp; Software, 73, 148-166. 
<a href="https://www.sciencedirect.com/science/article/pii/S1364815215300220">https://www.sciencedirect.com/science/article/pii/S1364815215300220</a>
</p>

<hr>
<h2 id='blockSample'>blockSample</h2><span id='topic+blockSample'></span>

<h3>Description</h3>

<p>Get a bootstrap replicate of the Sample data frame based on the user-specified blockLength. 
The bootstrap replicate is made up randomly selected blocks of 
data from Sample data frame.  Each block includes all the samples in a standard period of time (the blockLength measured in days).
The blocks are created based on the random selection (with 
replacement) of starting dates from the full Sample data frame.  The bootstrap replicate  
has the same number of observations as the original Sample, but some 
observations are included once, some are included multiple times, and some are not 
included at all.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>blockSample(localSample, blockLength, startSeed = NA)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="blockSample_+3A_localsample">localSample</code></td>
<td>
<p>Sample data frame</p>
</td></tr>
<tr><td><code id="blockSample_+3A_blocklength">blockLength</code></td>
<td>
<p>integer size of subset, expressed in days.  200 days has been found to be a good choice.</p>
</td></tr>
<tr><td><code id="blockSample_+3A_startseed">startSeed</code></td>
<td>
<p>setSeed value. This is used to make repeatable output. Default = NA.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>newSample data frame in same format as Sample data frame.  It has the same number of rows as the Sample data frame.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(EGRET)
eList &lt;- Choptank_eList
Sample &lt;- eList$Sample
bsReturn &lt;- blockSample(Sample, 200)
</code></pre>

<hr>
<h2 id='bootAnnual'>Single confidence interval bootstrap run</h2><span id='topic+bootAnnual'></span>

<h3>Description</h3>

<p>One bootstrap run used in calculating confidence interval bands.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bootAnnual(eList, blockLength = 200, startSeed = 494817, verbose = FALSE,
  jitterOn = FALSE, V = 0.2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bootAnnual_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Daily, Sample, and INFO dataframes. Created from the EGRET package, after running <code><a href="EGRET.html#topic+modelEstimation">modelEstimation</a></code>.</p>
</td></tr>
<tr><td><code id="bootAnnual_+3A_blocklength">blockLength</code></td>
<td>
<p>integer default value is 200.</p>
</td></tr>
<tr><td><code id="bootAnnual_+3A_startseed">startSeed</code></td>
<td>
<p>setSeed value. Defaults to 494817. This is used to make repeatable output.</p>
</td></tr>
<tr><td><code id="bootAnnual_+3A_verbose">verbose</code></td>
<td>
<p>logical specifying whether or not to display progress message.</p>
</td></tr>
<tr><td><code id="bootAnnual_+3A_jitteron">jitterOn</code></td>
<td>
<p>logical, if TRUE, adds &quot;jitter&quot; to the data in an attempt to avoid some numerical problems.  Default = FALSE.  See Details below.</p>
</td></tr>
<tr><td><code id="bootAnnual_+3A_v">V</code></td>
<td>
<p>numeric a multiplier for addition of jitter to the data, default = 0.2.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In some situations numerical problems are encountered in the bootstrap process, resulting in highly unreasonable spikes in the confidence intervals.
The use of &quot;jitter&quot; can often prevent these problems, but should only be used when it is clearly needed.
It adds a small amount of random &quot;jitter&quot; to the explanatory variables of the WRTDS model.  The V parameter sets the scale of variation in the log discharge values.
The standard deviation of the added jitter is V * standard deviation of Log Q.
The default for V is 0.2.  Larger values should generally be avoided, and smaller values may be sufficient.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(EGRET)
eList &lt;- Choptank_eList
## Not run: 
annualResults &lt;- bootAnnual(eList)

## End(Not run)
</code></pre>

<hr>
<h2 id='Choptank_eBoot'>Example eBoot</h2><span id='topic+Choptank_eBoot'></span><span id='topic+Choptank_caseSetUp'></span><span id='topic+Choptank_CIAnnualResults'></span><span id='topic+Choptank_dailyBootOut'></span><span id='topic+Choptank_repAnnual'></span>

<h3>Description</h3>

<p>Example data representing data from the Choptank River at Greensboro, MD,  USGS data
Data is a named list of the Daily, Sample, INFO dataframes, and xConc, and xFlux vectors.
</p>

<hr>
<h2 id='ciBands'>Confidence Interval Band Calculations</h2><span id='topic+ciBands'></span>

<h3>Description</h3>

<p>Computes confidence intervals for Flow-Normalized Concentration 
and Flow-Normalized Flux for a WRTDS model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ciBands(eList, repAnnualResults, probs = c(0.05, 0.95))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ciBands_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Daily, Sample, 
and INFO dataframes. Created from the EGRET package, after running 
<code><a href="EGRET.html#topic+modelEstimation">modelEstimation</a></code>.</p>
</td></tr>
<tr><td><code id="ciBands_+3A_repannualresults">repAnnualResults</code></td>
<td>
<p>named list returned from bootstrapping process.</p>
</td></tr>
<tr><td><code id="ciBands_+3A_probs">probs</code></td>
<td>
<p>numeric vector low and high confidence interval frequencies, 
default = c(0.05, 0.95) (which results in a 90% confidence interval).</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>library(EGRET)
eList &lt;- Choptank_eList
nBoot &lt;- 100
blockLength &lt;- 200
## Not run: 

repAnnualResults &lt;- vector(mode = "list", length = nBoot)
for(n in 1:nBoot){
   annualResults &lt;- bootAnnual(eList, blockLength, startSeed = n) 
   repAnnualResults[[n]] &lt;- annualResults
}

CIAnnualResults &lt;- ciBands(eList, repAnnualResults)


## End(Not run)

</code></pre>

<hr>
<h2 id='ciCalculations'>ciCalculations</h2><span id='topic+ciCalculations'></span>

<h3>Description</h3>

<p>Interactive function to calculate confidence bands for flow normalized concentration or flow normalized flux.
It returns the data frame CIAnnualResults, which is used as input to the functions
plotConcHistBoot( ), and plotFluxHistBoot( ) which produce the graphical output.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ciCalculations(eList, startSeed = 494817, verbose = TRUE,
  jitterOn = FALSE, V = 0.2, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ciCalculations_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Daily, Sample, and INFO dataframes. Created from the EGRET package, after running <code><a href="EGRET.html#topic+modelEstimation">modelEstimation</a></code>.</p>
</td></tr>
<tr><td><code id="ciCalculations_+3A_startseed">startSeed</code></td>
<td>
<p>setSeed value. Defaults to 494817. This is used to make repeatable output.</p>
</td></tr>
<tr><td><code id="ciCalculations_+3A_verbose">verbose</code></td>
<td>
<p>logical specifying whether or not to display progress messag, default = TRUE</p>
</td></tr>
<tr><td><code id="ciCalculations_+3A_jitteron">jitterOn</code></td>
<td>
<p>logical, if TRUE, adds &quot;jitter&quot; to the data in an attempt to avoid some numerical problems.  Default = FALSE.  See Details below.</p>
</td></tr>
<tr><td><code id="ciCalculations_+3A_v">V</code></td>
<td>
<p>numeric a multiplier for addition of jitter to the data, default = 0.2.  See Details below.</p>
</td></tr>
<tr><td><code id="ciCalculations_+3A_...">...</code></td>
<td>
<p>optionally include nBoot, blockLength, or widthCI</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In some situations numerical problems are encountered in the bootstrap process, resulting in highly unreasonable spikes in the confidence intervals.
The use of &quot;jitter&quot; can often prevent these problems, but should only be used when it is clearly needed.
It adds a small amount of random &quot;jitter&quot; to the explanatory variables of the WRTDS model.  The V parameter sets the scale of variation in the log discharge values.
The standard deviation of the added jitter is V * standard deviation of Log Q.
The default for V is 0.2.  Larger values should generally be avoided, and smaller values may be sufficient.
</p>
<p>Argument values suggested.  
To test the code nBoot = 10 is sufficient, but for meaningful results nBoot = 100 or even nBoot = 500 are more appropriate.
blockLength = 200
widthCI = 90 (90% confidence interval)
</p>


<h3>Value</h3>

<p>CIAnnualResults a data frame with the following columns
Year, mean decYear value for the year being reported
FNConcLow, the lower confidence limit for flow normalized concentration, in mg/L
FNConcHigh, the upper confidence limit for flow normalized concentration, in mg/L
FNFluxLow, the lower confidence limit for flow normalized flux, in kg
FNFluxLow, the lower confidence limit for flow normalized flux, in kg
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(EGRET)
eList &lt;- Choptank_eList
## Not run: 
# If run interactively, using stationary flow normalization
# in this format it will prompt for nBoot, blockLength and widthCI.
# CIAnnualResults &lt;- ciCalculations(eList)

# run in batch mode, using non-stationary flow normalization
# In this example nBoot is set very small, useful for an initial trial run.
# A meaningful application would use nBoot values such as 100 or even 500. 
seriesOut_2 &lt;- runSeries(eList, windowSide = 11)
CIAnnualResults &lt;- ciCalculations(seriesOut_2, 
                     nBoot = 10,
                     blockLength = 200,
                     widthCI = 90)
                     
 plotConcHistBoot(seriesOut_2, CIAnnualResults)


## End(Not run)
</code></pre>

<hr>
<h2 id='genDailyBoot'>WRTDSKalman Bootstrapping</h2><span id='topic+genDailyBoot'></span>

<h3>Description</h3>

<p>Function to get multiple bootstrap replicates at a daily time step using the WRTDS_K
method.  It is done by doing bootstrap resampling of the original Sample data frame.
The number of these replicate samples that are created is called nBoot and in each
case the WRTDS model is estimated.  Then, for each of these models, there are
nKalman time series of daily values computed, using all of the sample values in
the original Sample data frame.  The total number of replicates of the complete
process is nBoot * nKalman.  For example we might generate 500 replicates by setting
nBoot = 20 and nKalman = 25.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>genDailyBoot(eList, nBoot = 10, nKalman = 10, rho = 0.9, setSeed = NA,
  jitterOn = FALSE, V = 0.2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="genDailyBoot_+3A_elist">eList</code></td>
<td>
<p>is the data with a fitted model already done. Note that the eList$Sample 
may have multiple values on a given day and it can also have censored values.</p>
</td></tr>
<tr><td><code id="genDailyBoot_+3A_nboot">nBoot</code></td>
<td>
<p>number of times the bootstrap resampling and model estimating is done.</p>
</td></tr>
<tr><td><code id="genDailyBoot_+3A_nkalman">nKalman</code></td>
<td>
<p>number of different realizations of the daily time series for each re-estimated model.</p>
</td></tr>
<tr><td><code id="genDailyBoot_+3A_rho">rho</code></td>
<td>
<p>numeric the lag one autocorrelation. Default is 0.9.</p>
</td></tr>
<tr><td><code id="genDailyBoot_+3A_setseed">setSeed</code></td>
<td>
<p>value. Defaults is <code>NA</code>, which will not specify a randomized seed.
This can be used to make repeatable output.</p>
</td></tr>
<tr><td><code id="genDailyBoot_+3A_jitteron">jitterOn</code></td>
<td>
<p>logical, if TRUE, adds &quot;jitter&quot; to the data in an attempt to avoid some numerical problems.  Default = FALSE.  See Details below.</p>
</td></tr>
<tr><td><code id="genDailyBoot_+3A_v">V</code></td>
<td>
<p>numeric a multiplier for addition of jitter to the data, default = 0.2.  See Details below.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In some situations numerical problems are encountered in the bootstrap process, resulting in highly unreasonable spikes in the confidence intervals.
The use of &quot;jitter&quot; can often prevent these problems, but should only be used when it is clearly needed.
It adds a small amount of random &quot;jitter&quot; to the explanatory variables of the WRTDS model.  The V parameter sets the scale of variation in the log discharge values.
The standard deviation of the added jitter is V * standard deviation of Log Q.
The default for V is 0.2.  Larger values should generally be avoided, and smaller values may be sufficient.
</p>


<h3>Value</h3>

<p>dailyBootOut a matrix of daily flux values (in kg/day).  
The number of columns of the matrix is the number of replicates produced
which is nBoot * nKalman
The number of rows is the number of days in the record.  
The set of days simulated is the same set of days that are in the eList$Daily data frame.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
eList &lt;- EGRET::Choptank_eList
# Very long running function:
## Not run: 
dailyBootOut &lt;- genDailyBoot(eList,
                             nBoot = 20,
                             nKalman = 25)

## End(Not run)

</code></pre>

<hr>
<h2 id='makeAnnualPI'>Make Annual Prediction Intervals</h2><span id='topic+makeAnnualPI'></span>

<h3>Description</h3>

<p>This function takes the output from <code><a href="#topic+genDailyBoot">genDailyBoot</a></code> and 
calculates the quantiles for an annual (based on paStart/paLong) aggregation. 
This means that the function can be used for seasons.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>makeAnnualPI(dailyBootOut, eList, paLong = 12, paStart = 10, fluxUnit = 3)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="makeAnnualPI_+3A_dailybootout">dailyBootOut</code></td>
<td>
<p>data frame returned from <code><a href="#topic+genDailyBoot">genDailyBoot</a></code></p>
</td></tr>
<tr><td><code id="makeAnnualPI_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Daily, Sample, and INFO 
dataframes. Created from the EGRET package, after running <code><a href="EGRET.html#topic+modelEstimation">modelEstimation</a></code>.</p>
</td></tr>
<tr><td><code id="makeAnnualPI_+3A_palong">paLong</code></td>
<td>
<p>numeric integer specifying the length of the period of analysis, in months, 1&lt;=paLong&lt;=12, default is 12</p>
</td></tr>
<tr><td><code id="makeAnnualPI_+3A_pastart">paStart</code></td>
<td>
<p>numeric integer specifying the starting month for the period of analysis, 1&lt;=paStart&lt;=12, default is 10</p>
</td></tr>
<tr><td><code id="makeAnnualPI_+3A_fluxunit">fluxUnit</code></td>
<td>
<p>number representing entry in pre-defined fluxUnit class array. 
<code><a href="EGRET.html#topic+printFluxUnitCheatSheet">printFluxUnitCheatSheet</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of 2 data frames, one for average concentration, in mg/L
and one for flux (unit depends on fluxUnit argument)
In each data frame the first column is DecYear. The remaining columns are
quantiles of the flux or concentration (depending on the data frame).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- EGRET::Choptank_eList
# This example is only based on 4 iterations
# Actual prediction intervals should be calculated on
# a much larger number of iterations (several hundred).  
dailyBoot &lt;- Choptank_dailyBootOut
annualPcts &lt;- makeAnnualPI(dailyBoot, eList)
head(annualPcts[["flux"]])
head(annualPcts[["conc"]])

</code></pre>

<hr>
<h2 id='makeDailyPI'>Make Daily Prediction Intervals</h2><span id='topic+makeDailyPI'></span>

<h3>Description</h3>

<p>This function takes the output from <code><a href="#topic+genDailyBoot">genDailyBoot</a></code> and 
calculates the quantiles for a daily aggregation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>makeDailyPI(dailyBootOut, eList, fluxUnit = 3)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="makeDailyPI_+3A_dailybootout">dailyBootOut</code></td>
<td>
<p>data frame returned from <code><a href="#topic+genDailyBoot">genDailyBoot</a></code></p>
</td></tr>
<tr><td><code id="makeDailyPI_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Daily, Sample, and INFO 
dataframes. Created from the EGRET package, after running <code><a href="EGRET.html#topic+modelEstimation">modelEstimation</a></code>.</p>
</td></tr>
<tr><td><code id="makeDailyPI_+3A_fluxunit">fluxUnit</code></td>
<td>
<p>number representing entry in pre-defined fluxUnit class array. 
<code><a href="EGRET.html#topic+printFluxUnitCheatSheet">printFluxUnitCheatSheet</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of 2 data frames, one for average concentration, in mg/L
and one for flux (unit depends on fluxUnit argument)
In each data frame the first column is Date. The remaining columns are
quantiles of the flux or concentration (depending on the data frame).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- EGRET::Choptank_eList
# This example is only based on 4 iterations
# Actual prediction intervals should be calculated on
# a much larger number of iterations (several hundred).
dailyBoot &lt;- Choptank_dailyBootOut

dailyPcts &lt;- makeDailyPI(dailyBoot, eList)
head(dailyPcts[["flux"]])
head(dailyPcts[["conc"]])

</code></pre>

<hr>
<h2 id='makeMonthPI'>Make Monthly Prediction Intervals</h2><span id='topic+makeMonthPI'></span>

<h3>Description</h3>

<p>Month statistics using WRTDSKalman bootstrapping approach.  The input to this
function is the dailyBootOut matrix which contains nReplicate sets of 
daily flux values for the period of interest.
The results are in the form of quantiles of concentration and of flux 
for each of these months.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>makeMonthPI(dailyBootOut, eList, fluxUnit = 3)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="makeMonthPI_+3A_dailybootout">dailyBootOut</code></td>
<td>
<p>data frame returned from <code><a href="#topic+genDailyBoot">genDailyBoot</a></code></p>
</td></tr>
<tr><td><code id="makeMonthPI_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Daily, Sample, and INFO 
dataframes. Created from the EGRET package, after running <code><a href="EGRET.html#topic+modelEstimation">modelEstimation</a></code>.</p>
</td></tr>
<tr><td><code id="makeMonthPI_+3A_fluxunit">fluxUnit</code></td>
<td>
<p>number representing entry in pre-defined fluxUnit class array. 
<code><a href="EGRET.html#topic+printFluxUnitCheatSheet">printFluxUnitCheatSheet</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of 2 data frames, one for average concentration, in mg/L
and one for flux (unit depends on fluxUnit argument)
In each data frame the first column is monthSeq that corresponds to the months
in the &quot;MonthSeq&quot; column in the eList$Daily data frame. The remaining columns are
quantiles of the flux or concentration (depending on the data frame).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- EGRET::Choptank_eList
# This example is only based on 4 iterations
# Actual prediction intervals should be calculated on
# a much larger number of iterations (several hundred). 
dailyBoot &lt;- Choptank_dailyBootOut
monthPcts &lt;- makeMonthPI(dailyBoot, eList)
head(monthPcts[["flux"]])
head(monthPcts[["conc"]])

</code></pre>

<hr>
<h2 id='monthSeqToDec'>monthSeqToDec</h2><span id='topic+monthSeqToDec'></span>

<h3>Description</h3>

<p>Convert a sequence of month integers into their decimal years.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>monthSeqToDec(monthSeq)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="monthSeqToDec_+3A_monthseq">monthSeq</code></td>
<td>
<p>integer vector of months. Month 1 is considered Jan. 1850.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
months &lt;- 1558:1600
monthSeqToDec(months)
</code></pre>

<hr>
<h2 id='plotConcHistBoot'>Graph of annual concentration, flow normalized concentration, 
and confidence bands for flow normalized concentrations</h2><span id='topic+plotConcHistBoot'></span>

<h3>Description</h3>

<p>Uses the output of <code><a href="EGRET.html#topic+modelEstimation">modelEstimation</a></code> in the EGRET package (results in the named 
list eList), and the data frame CIAnnualResults (produced by the function ciCalculations in the EGRETci package 
using scripts described in the EGRETci vignette) to produce a graph of annual 
concentration, flow normalized concentration, and confidence bands for 
flow-normalized concentrations.  In addition to the arguments listed below, 
it will accept any additional arguments that are listed for the EGRET function 
<code><a href="EGRET.html#topic+plotConcHist">plotConcHist</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotConcHistBoot(eList, CIAnnualResults, yearStart = NA, yearEnd = NA,
  plotFlowNorm = TRUE, col.pred = "green", concMax = NA,
  plotAnnual = TRUE, plotGenConc = FALSE, cex = 0.8, cex.axis = 1.1,
  lwd = 2, col = "black", col.gen = "red", customPar = FALSE,
  printTitle = TRUE, cex.main = 1.1, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotConcHistBoot_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Daily, Sample, and INFO dataframes. Created from the EGRET package, after running <code><a href="EGRET.html#topic+modelEstimation">modelEstimation</a></code>.</p>
</td></tr>
<tr><td><code id="plotConcHistBoot_+3A_ciannualresults">CIAnnualResults</code></td>
<td>
<p>data frame generated from ciBands (includes nBoot, probs, and blockLength attributes).</p>
</td></tr>
<tr><td><code id="plotConcHistBoot_+3A_yearstart">yearStart</code></td>
<td>
<p>numeric is the calendar year containing the first estimated annual value to be plotted, default is NA (which allows it to be set automatically by the data).</p>
</td></tr>
<tr><td><code id="plotConcHistBoot_+3A_yearend">yearEnd</code></td>
<td>
<p>numeric is the calendar year just after the last estimated annual value to be plotted, default is NA (which allows it to be set automatically by the data).</p>
</td></tr>
<tr><td><code id="plotConcHistBoot_+3A_plotflownorm">plotFlowNorm</code></td>
<td>
<p>logical variable if TRUE flow normalized concentration line is plotted, if FALSE not plotted, default is TRUE.</p>
</td></tr>
<tr><td><code id="plotConcHistBoot_+3A_col.pred">col.pred</code></td>
<td>
<p>character color of line for flow-normalized concentration and for the confidence limits, default is &quot;green&quot;.</p>
</td></tr>
<tr><td><code id="plotConcHistBoot_+3A_concmax">concMax</code></td>
<td>
<p>numeric specifying the maximum value to be used on the vertical axis, default is NA (which allows it to be set automatically by the data).</p>
</td></tr>
<tr><td><code id="plotConcHistBoot_+3A_plotannual">plotAnnual</code></td>
<td>
<p>logical variable if <code>TRUE</code>, annual mean concentration points from WRTDS output are plotted, if <code>FALSE</code> not plotted.</p>
</td></tr>
<tr><td><code id="plotConcHistBoot_+3A_plotgenconc">plotGenConc</code></td>
<td>
<p>logical variable. If <code>TRUE</code>, annual mean concentration points from WRTDS_K output are plotted, if <code>FALSE</code> not plotted.</p>
</td></tr>
<tr><td><code id="plotConcHistBoot_+3A_cex">cex</code></td>
<td>
<p>numeric value giving the amount by which plotting symbols should be magnified, default = 0.8.</p>
</td></tr>
<tr><td><code id="plotConcHistBoot_+3A_cex.axis">cex.axis</code></td>
<td>
<p>numeric value of magnification to be used for axis annotation relative to the current setting of cex, default = 1.1.</p>
</td></tr>
<tr><td><code id="plotConcHistBoot_+3A_lwd">lwd</code></td>
<td>
<p>numeric magnification of line width, default = 2.</p>
</td></tr>
<tr><td><code id="plotConcHistBoot_+3A_col">col</code></td>
<td>
<p>color of annual mean points on plot, see ?par 'Color Specification', default = &quot;black&quot;.</p>
</td></tr>
<tr><td><code id="plotConcHistBoot_+3A_col.gen">col.gen</code></td>
<td>
<p>color of annual mean points for WRTDS_K output on plot, see ?par 'Color Specification', default = &quot;red&quot;.</p>
</td></tr>
<tr><td><code id="plotConcHistBoot_+3A_custompar">customPar</code></td>
<td>
<p>logical defaults to FALSE. If TRUE, par() should be set by user before calling this function 
(for example, adjusting margins with par(mar=c(5,5,5,5))). If customPar FALSE, EGRETci chooses the best margins.</p>
</td></tr>
<tr><td><code id="plotConcHistBoot_+3A_printtitle">printTitle</code></td>
<td>
<p>logical print title of the plot, default = TRUE.</p>
</td></tr>
<tr><td><code id="plotConcHistBoot_+3A_cex.main">cex.main</code></td>
<td>
<p>numeric value of magnification to be used for plot title, default = 1.1.</p>
</td></tr>
<tr><td><code id="plotConcHistBoot_+3A_...">...</code></td>
<td>
<p>graphical parameters</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>library(EGRET)
eList &lt;- Choptank_eList
CIAnnualResults &lt;- Choptank_CIAnnualResults
plotConcHistBoot(eList, CIAnnualResults)
plotConcHistBoot(eList, CIAnnualResults, yearStart=1990, yearEnd=2002)
# Very long-running function:
## Not run: 
CIAnnualResults &lt;- ciCalculations(eList, nBoot = 100, blockLength = 200)
plotConcHistBoot(eList, CIAnnualResults)

## End(Not run)
</code></pre>

<hr>
<h2 id='plotFluxHistBoot'>Graph of annual flux, flow normalized flux, and confidence bands for flow normalized flux</h2><span id='topic+plotFluxHistBoot'></span>

<h3>Description</h3>

<p>Uses the output of <code><a href="EGRET.html#topic+modelEstimation">modelEstimation</a></code> in the EGRET package (results in the named list eList), 
and the data frame CIAnnualResults (produced by EGRETci package using scripts described in 
the vignette) to produce a graph of annual flux, flow normalized flux, and confidence bands 
for flow-normalized flux. In addition to the arguments listed below, it will accept any 
additional arguments that are listed for the EGRET function <code><a href="EGRET.html#topic+plotFluxHist">plotFluxHist</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotFluxHistBoot(eList, CIAnnualResults, yearStart = NA, yearEnd = NA,
  fluxUnit = 9, fluxMax = NA, plotFlowNorm = TRUE, col.pred = "green",
  plotAnnual = TRUE, plotGenFlux = FALSE, cex = 0.8, cex.axis = 1.1,
  lwd = 2, col = "black", col.gen = "red", cex.main = 1.1,
  printTitle = TRUE, customPar = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotFluxHistBoot_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Daily, Sample, and INFO dataframes. Created from the EGRET package, after running <code><a href="EGRET.html#topic+modelEstimation">modelEstimation</a></code>.</p>
</td></tr>
<tr><td><code id="plotFluxHistBoot_+3A_ciannualresults">CIAnnualResults</code></td>
<td>
<p>data frame from ciBands (needs nBoot, probs, and blockLength attributes).</p>
</td></tr>
<tr><td><code id="plotFluxHistBoot_+3A_yearstart">yearStart</code></td>
<td>
<p>numeric is the calendar year containing the first estimated annual value to be plotted, default is NA (which allows it to be set automatically by the data).</p>
</td></tr>
<tr><td><code id="plotFluxHistBoot_+3A_yearend">yearEnd</code></td>
<td>
<p>numeric is the calendar year just after the last estimated annual value to be plotted, default is NA (which allows it to be set automatically by the data).</p>
</td></tr>
<tr><td><code id="plotFluxHistBoot_+3A_fluxunit">fluxUnit</code></td>
<td>
<p>integer representing entry in pre-defined fluxUnit class array. <code>printFluxUnitCheatSheet</code></p>
</td></tr>
<tr><td><code id="plotFluxHistBoot_+3A_fluxmax">fluxMax</code></td>
<td>
<p>numeric specifying the maximum value to be used on the vertical axis, default is NA (which allows it to be set automatically by the data), uses units specificed by fluxUnit.</p>
</td></tr>
<tr><td><code id="plotFluxHistBoot_+3A_plotflownorm">plotFlowNorm</code></td>
<td>
<p>logical variable if TRUE flow normalized flux line is plotted, if FALSE not plotted, default is TRUE.</p>
</td></tr>
<tr><td><code id="plotFluxHistBoot_+3A_col.pred">col.pred</code></td>
<td>
<p>character color of line for flow-normalized flux and for the confidence limits, default is &quot;green&quot;.</p>
</td></tr>
<tr><td><code id="plotFluxHistBoot_+3A_plotannual">plotAnnual</code></td>
<td>
<p>logical variable if <code>TRUE</code>, annual mean flux points from WRTDS output are plotted, if <code>FALSE</code> not plotted.</p>
</td></tr>
<tr><td><code id="plotFluxHistBoot_+3A_plotgenflux">plotGenFlux</code></td>
<td>
<p>logical variable. If <code>TRUE</code>, annual mean flux points from WRTDS_K output are plotted, if <code>FALSE</code> not plotted.</p>
</td></tr>
<tr><td><code id="plotFluxHistBoot_+3A_cex">cex</code></td>
<td>
<p>numeric value giving the amount by which plotting symbols should be magnified, default = 0.8.</p>
</td></tr>
<tr><td><code id="plotFluxHistBoot_+3A_cex.axis">cex.axis</code></td>
<td>
<p>numeric magnification to be used for axis annotation relative to the current setting of cex, default = 1.1.</p>
</td></tr>
<tr><td><code id="plotFluxHistBoot_+3A_lwd">lwd</code></td>
<td>
<p>numeric magnification of line width, default = 2.</p>
</td></tr>
<tr><td><code id="plotFluxHistBoot_+3A_col">col</code></td>
<td>
<p>color of annual mean points on plot, see ?par 'Color Specification', default = &quot;black&quot;.</p>
</td></tr>
<tr><td><code id="plotFluxHistBoot_+3A_col.gen">col.gen</code></td>
<td>
<p>color of annual mean points for WRTDS_K output on plot, see ?par 'Color Specification', default = &quot;red&quot;.</p>
</td></tr>
<tr><td><code id="plotFluxHistBoot_+3A_cex.main">cex.main</code></td>
<td>
<p>numeric title scale</p>
</td></tr>
<tr><td><code id="plotFluxHistBoot_+3A_printtitle">printTitle</code></td>
<td>
<p>logical print title of the plot, default = TRUE.</p>
</td></tr>
<tr><td><code id="plotFluxHistBoot_+3A_custompar">customPar</code></td>
<td>
<p>logical defaults to FALSE. If TRUE, par() should be set by user before calling this function 
(for example, adjusting margins with par(mar=c(5,5,5,5))). If customPar FALSE, EGRET chooses the best margins.</p>
</td></tr>
<tr><td><code id="plotFluxHistBoot_+3A_...">...</code></td>
<td>
<p>graphical parameters</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>library(EGRET)
eList &lt;- Choptank_eList 
CIAnnualResults &lt;- Choptank_CIAnnualResults
plotFluxHistBoot(eList, CIAnnualResults, fluxUnit=5)

## Not run: 
CIAnnualResults &lt;- ciCalculations(eList, nBoot = 100, blockLength = 200)
plotFluxHistBoot(eList, CIAnnualResults, fluxUnit=5)

## End(Not run)
</code></pre>

<hr>
<h2 id='plotHistogramTrend'>plotHistogramTrend</h2><span id='topic+plotHistogramTrend'></span>

<h3>Description</h3>

<p>Produces a histogram of trend results from bootstrap process.  The histogram shows the trend results expressed as percentage change between the first year (or first period) 
and the second year (or second period).  It shows the zero line (no trend) and also shows the WRTDS 
estimate of the trend in percent.  It is based on the output of either wBT or 
runPairsBoot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotHistogramTrend(eList, eBoot, caseSetUp, flux = TRUE, xMin = NA,
  xMax = NA, xStep = NA, printTitle = TRUE, cex.main = 1.1,
  cex.axis = 1.1, cex.lab = 1.1, col.fill = "grey", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotHistogramTrend_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Daily, Sample, and INFO dataframes. Created from the EGRET package, after running <code><a href="EGRET.html#topic+modelEstimation">modelEstimation</a></code>.</p>
</td></tr>
<tr><td><code id="plotHistogramTrend_+3A_eboot">eBoot</code></td>
<td>
<p>named list. Returned from <code><a href="#topic+wBT">wBT</a></code> or from <code><a href="#topic+runPairsBoot">runPairsBoot</a></code>.</p>
</td></tr>
<tr><td><code id="plotHistogramTrend_+3A_casesetup">caseSetUp</code></td>
<td>
<p>data frame. Returned from <code><a href="#topic+trendSetUp">trendSetUp</a></code>, or if <code><a href="#topic+runPairsBoot">runPairsBoot</a></code> was used, need to specify caseSetUp = NA.</p>
</td></tr>
<tr><td><code id="plotHistogramTrend_+3A_flux">flux</code></td>
<td>
<p>logical if TRUE, plots flux results, if FALSE plots concentration results.</p>
</td></tr>
<tr><td><code id="plotHistogramTrend_+3A_xmin">xMin</code></td>
<td>
<p>minimum bin value for histogram, it is good to have the xMin and xMax arguments straddle zero, default is NA (value set from the data).</p>
</td></tr>
<tr><td><code id="plotHistogramTrend_+3A_xmax">xMax</code></td>
<td>
<p>maximum bin value for histogram, default is NA (value set from the data).</p>
</td></tr>
<tr><td><code id="plotHistogramTrend_+3A_xstep">xStep</code></td>
<td>
<p>step size, typically multiples of 10 or 20, default is NA (value set from the data).</p>
</td></tr>
<tr><td><code id="plotHistogramTrend_+3A_printtitle">printTitle</code></td>
<td>
<p>logical if TRUE, plot includes title.</p>
</td></tr>
<tr><td><code id="plotHistogramTrend_+3A_cex.main">cex.main</code></td>
<td>
<p>numeric magnification of font size for title, default is 1.1.</p>
</td></tr>
<tr><td><code id="plotHistogramTrend_+3A_cex.axis">cex.axis</code></td>
<td>
<p>numeric magnification of font size for axis, default is 1.1.</p>
</td></tr>
<tr><td><code id="plotHistogramTrend_+3A_cex.lab">cex.lab</code></td>
<td>
<p>numeric magnification of font size for axis labels, default is 1.1.</p>
</td></tr>
<tr><td><code id="plotHistogramTrend_+3A_col.fill">col.fill</code></td>
<td>
<p>character fill color for histogram, default is &quot;grey&quot;.</p>
</td></tr>
<tr><td><code id="plotHistogramTrend_+3A_...">...</code></td>
<td>
<p>base R graphical parameters that can be passed to the hist function</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For any given set of results (from eBoot) it is best to run it first with the arguments
xMin = NA, xMax = NA, and xStep = NA.  Then, observing the range the histogram covers
it can be run again with values of these three arguments selected by the user to provide
for a more readable version of the histogram.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(EGRET)
eList &lt;- Choptank_eList
eBoot &lt;- Choptank_eBoot
caseSetUp &lt;- Choptank_caseSetUp
plotHistogramTrend(eList, eBoot, caseSetUp, flux = FALSE)

## Not run: 
# Using wBT:	
caseSetUp &lt;- trendSetUp(eList)
eBoot &lt;- wBT(eList,caseSetUp)
plotHistogramTrend(eList, eBoot, caseSetUp,  
                   flux = FALSE, xMin = -20, xMax = 60, xStep = 5)
plotHistogramTrend(eList, eBoot, caseSetUp, 
                   flux = TRUE, xMin = -20, xMax = 60, xStep = 5)
   
# Using runPairs followed by runPairsBoot:
year1 &lt;- 1985
year2 &lt;- 2009          
pairOut_2 &lt;- runPairs(eList, year1, year2, windowSide = 7)
boot_pair_out &lt;- runPairsBoot(eList, pairOut_2, nBoot = 10)

plotHistogramTrend(eList, boot_pair_out, caseSetUp = NA, 
                   flux = TRUE, xMin = -20, xMax = 60, xStep = 5)          

## End(Not run)
</code></pre>

<hr>
<h2 id='pVal'>pVal</h2><span id='topic+pVal'></span>

<h3>Description</h3>

<p>Computes the two-sided p value for the null hypothesis, where the null 
hypothesis is that the slope is zero.  It is based on the binomial distribution. 
Note that the result does not depend on the magnitude of the individual slope 
values only depends on the number of positive slopes and number of negative slopes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pVal(s)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pVal_+3A_s">s</code></td>
<td>
<p>numeric vector of slope values from the bootstrap</p>
</td></tr>
</table>


<h3>Value</h3>

<p>pVal numeric value
</p>


<h3>Examples</h3>

<pre><code class='language-R'>s &lt;- c(-1.0, 0, 0.5, 0.55, 3.0)
pValue &lt;- pVal(s)
</code></pre>

<hr>
<h2 id='runGroupsBoot'>The bootstrap uncertainty analysis for runGroups results</h2><span id='topic+runGroupsBoot'></span>

<h3>Description</h3>

<p>This function that does the uncertainty analysis for determining the change 
between two groups of years.  The process is virtually 
identical to what is used for <code><a href="#topic+runPairsBoot">runPairsBoot</a></code> which looks at a change
between a pair of years.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>runGroupsBoot(eList, groupResults, nBoot = 100, startSeed = 494817,
  blockLength = 200, jitterOn = FALSE, V = 0.2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="runGroupsBoot_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Daily, Sample, and INFO dataframes</p>
</td></tr>
<tr><td><code id="runGroupsBoot_+3A_groupresults">groupResults</code></td>
<td>
<p>data frame returned from <code><a href="EGRET.html#topic+runGroups">runGroups</a></code></p>
</td></tr>
<tr><td><code id="runGroupsBoot_+3A_nboot">nBoot</code></td>
<td>
<p>the maximum number of bootstrap replicates to be used, typically 100</p>
</td></tr>
<tr><td><code id="runGroupsBoot_+3A_startseed">startSeed</code></td>
<td>
<p>setSeed value. Defaults to 494817. This is used to make repeatable output.</p>
</td></tr>
<tr><td><code id="runGroupsBoot_+3A_blocklength">blockLength</code></td>
<td>
<p>days, typically 200 is a good choice</p>
</td></tr>
<tr><td><code id="runGroupsBoot_+3A_jitteron">jitterOn</code></td>
<td>
<p>logical, if TRUE, adds &quot;jitter&quot; to the data in an attempt to avoid some numerical problems.
Default = FALSE.  See Details below.</p>
</td></tr>
<tr><td><code id="runGroupsBoot_+3A_v">V</code></td>
<td>
<p>numeric a multiplier for addition of jitter to the data, default = 0.2.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In some situations numerical problems are encountered in the bootstrap process, resulting in highly unreasonable spikes in the confidence intervals.
The use of &quot;jitter&quot; can often prevent these problems, but should only be used when it is clearly needed.
It adds a small amount of random &quot;jitter&quot; to the explanatory variables of the WRTDS model.  The V parameter sets the scale of variation in the log discharge values.
The standard deviation of the added jitter is V * standard deviation of Log Q.
The default for V is 0.2.  Larger values should generally be avoided, and smaller values may be sufficient.
</p>


<h3>Value</h3>

<p>eBoot, a named list with bootOut, wordsOut, xConc, xFlux, pConc, pFlux values.
</p>

<ul>
<li><p>bootOut is a data frame with the results of the bootstrap test.
</p>
</li>
<li><p>wordsOut is a character vector describing the results.
</p>
</li>
<li><p>xConc and xFlux are vectors of length iBoot, of the change in flow normalized concentration
and flow normalized flux computed from each of the bootstrap replicates.
</p>
</li>
<li><p>pConc and pFlux are vectors of length iBoot, of the change in flow normalized concentration
or flow normalized flux computed from each of the bootstrap replicates expressed as % change.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+runPairsBoot">runPairsBoot</a></code>, <code><a href="EGRET.html#topic+runGroups">runGroups</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(EGRET)
eList &lt;- Choptank_eList

## Not run: 
groupResults &lt;- runGroups(eList, 
                          group1firstYear = 1995, 
                          group1lastYear = 2004, 
                          group2firstYear = 2005, 
                          group2lastYear = 2014, 
                          windowSide = 7, wall = TRUE, 
                          sample1EndDate = "2004-10-30", 
                          paStart = 4, paLong = 2, 
                          verbose = FALSE)

boot_group_out &lt;- runGroupsBoot(eList, groupResults)

plotHistogramTrend(eList, boot_group_out, caseSetUp=NA)

## End(Not run)
</code></pre>

<hr>
<h2 id='runPairsBoot'>The bootstrap uncertainty analysis for runPairs results</h2><span id='topic+runPairsBoot'></span>

<h3>Description</h3>

<p>The function that does the uncertainty analysis for determining the change between any 
pair of years.  It is very similar to the <code><a href="#topic+wBT">wBT</a></code> function that runs the WRTDS 
bootstrap test.  It differs from <code><a href="#topic+wBT">wBT</a></code> in that it runs a specific number of 
bootstrap replicates, unlike the <code><a href="#topic+wBT">wBT</a></code> approach that will stop running replicates 
based on the status of the test statistics along the way.  Also, this code can be used with
generalized flow normalization, which handles non-stationary discharge, 
whereas <code><a href="#topic+wBT">wBT</a></code> does not.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>runPairsBoot(eList, pairResults, nBoot = 100, startSeed = 494817,
  blockLength = 200, jitterOn = FALSE, V = 0.2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="runPairsBoot_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Daily, Sample, and INFO dataframes</p>
</td></tr>
<tr><td><code id="runPairsBoot_+3A_pairresults">pairResults</code></td>
<td>
<p>data frame returned from <code><a href="EGRET.html#topic+runPairs">runPairs</a></code></p>
</td></tr>
<tr><td><code id="runPairsBoot_+3A_nboot">nBoot</code></td>
<td>
<p>the maximum number of bootstrap replicates to be used, typically 100</p>
</td></tr>
<tr><td><code id="runPairsBoot_+3A_startseed">startSeed</code></td>
<td>
<p>setSeed value. Defaults to 494817. This is used to make repeatable output.</p>
</td></tr>
<tr><td><code id="runPairsBoot_+3A_blocklength">blockLength</code></td>
<td>
<p>days, typically 200 is a good choice</p>
</td></tr>
<tr><td><code id="runPairsBoot_+3A_jitteron">jitterOn</code></td>
<td>
<p>logical, if TRUE, adds &quot;jitter&quot; to the data in an attempt to avoid some numerical problems.  Default = FALSE.  See Details below.</p>
</td></tr>
<tr><td><code id="runPairsBoot_+3A_v">V</code></td>
<td>
<p>numeric a multiplier for addition of jitter to the data, default = 0.2.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In some situations numerical problems are encountered in the bootstrap process, resulting in highly unreasonable spikes in the confidence intervals.
The use of &quot;jitter&quot; can often prevent these problems, but should only be used when it is clearly needed.
It adds a small amount of random &quot;jitter&quot; to the explanatory variables of the WRTDS model.  The V parameter sets the scale of variation in the log discharge values.
The standard deviation of the added jitter is V * standard deviation of Log Q.
The default for V is 0.2.  Larger values should generally be avoided, and smaller values may be sufficient.
</p>


<h3>Value</h3>

<p>eBoot, a named list with bootOut, wordsOut, xConc, xFlux, pConc, pFlux values.
</p>

<ul>
<li><p>bootOut is a data frame with the results of the bootstrap test. 
</p>
</li>
<li><p>wordsOut is a character vector describing the results.
</p>
</li>
<li><p>xConc and xFlux are vectors of length iBoot, of the change in flow normalized concentration
and flow normalized flux computed from each of the bootstrap replicates. 
</p>
</li>
<li><p>pConc and pFlux are vectors of length iBoot, of the change in flow normalized concentration
or flow normalized flux computed from each of the bootstrap replicates expressed as % change.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+runGroupsBoot">runGroupsBoot</a></code>, <code><a href="EGRET.html#topic+runPairs">runPairs</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(EGRET)
eList &lt;- Choptank_eList
year1 &lt;- 1985
year2 &lt;- 2009

## Not run: 
pairOut_2 &lt;- runPairs(eList, year1, year2, windowSide = 7)

boot_pair_out &lt;- runPairsBoot(eList, pairOut_2)

plotHistogramTrend(eList, boot_pair_out, caseSetUp = NA)

## End(Not run)
</code></pre>

<hr>
<h2 id='saveEGRETci'>Save EGRETci workspace after running wBT (the WRTDS bootstrap test)</h2><span id='topic+saveEGRETci'></span>

<h3>Description</h3>

<p>Saves critical information in a EGRETci workflow when analyzing trends between a starting and ending year.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>saveEGRETci(eList, eBoot, caseSetUp, fileName = "")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="saveEGRETci_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Daily, Sample, and INFO dataframes. Created from the EGRET package, after running <code><a href="EGRET.html#topic+modelEstimation">modelEstimation</a></code>.</p>
</td></tr>
<tr><td><code id="saveEGRETci_+3A_eboot">eBoot</code></td>
<td>
<p>named list. Returned from <code><a href="#topic+wBT">wBT</a></code>.</p>
</td></tr>
<tr><td><code id="saveEGRETci_+3A_casesetup">caseSetUp</code></td>
<td>
<p>data frame. Returned from <code><a href="#topic+trendSetUp">trendSetUp</a></code>.</p>
</td></tr>
<tr><td><code id="saveEGRETci_+3A_filename">fileName</code></td>
<td>
<p>character. If left blank (empty quotes), the function will interactively ask for a name to save.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A .RData file containing three objects: eList, eBoot, and caseSetUp
</p>


<h3>See Also</h3>

<p><code><a href="#topic+wBT">wBT</a></code>, <code><a href="#topic+trendSetUp">trendSetUp</a></code>, <code><a href="EGRET.html#topic+modelEstimation">modelEstimation</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- EGRET::Choptank_eList
## Not run: 
caseSetUp &lt;- trendSetUp(eList)
eBoot &lt;- wBT(eList,caseSetUp)
saveEGRETci(eList, eBoot, caseSetUp)

## End(Not run)
</code></pre>

<hr>
<h2 id='setForBoot'>Allows user to set window parameters for the WRTDS model prior to running the bootstrap procedure</h2><span id='topic+setForBoot'></span>

<h3>Description</h3>

<p>Adds window parameters to INFO file in eList.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setForBoot(eList, caseSetUp, windowY = 7, windowQ = 2, windowS = 0.5,
  edgeAdjust = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="setForBoot_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Daily, Sample, and INFO dataframes. Created from the EGRET package, after running <code><a href="EGRET.html#topic+modelEstimation">modelEstimation</a></code>.</p>
</td></tr>
<tr><td><code id="setForBoot_+3A_casesetup">caseSetUp</code></td>
<td>
<p>data frame returned from <code><a href="#topic+trendSetUp">trendSetUp</a></code>.</p>
</td></tr>
<tr><td><code id="setForBoot_+3A_windowy">windowY</code></td>
<td>
<p>numeric specifying the half-window width in the time dimension, in units of years, default is 7.</p>
</td></tr>
<tr><td><code id="setForBoot_+3A_windowq">windowQ</code></td>
<td>
<p>numeric specifying the half-window width in the discharge dimension, units are natural log units, default is 2.</p>
</td></tr>
<tr><td><code id="setForBoot_+3A_windows">windowS</code></td>
<td>
<p>numeric specifying the half-window with in the seasonal dimension, in units of years, default is 0.5.</p>
</td></tr>
<tr><td><code id="setForBoot_+3A_edgeadjust">edgeAdjust</code></td>
<td>
<p>logical specifying whether to use the modified method for calculating the windows at the edge of the record, default is TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>eList list with Daily,Sample, INFO data frames and surface matrix.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- EGRET::Choptank_eList

caseSetUp &lt;- trendSetUp(eList,
  year1=1985, 
  year2=2005,
  nBoot = 50, 
  bootBreak = 39,
  blockLength = 200)

bootSetUp &lt;- setForBoot(eList,caseSetUp)

</code></pre>

<hr>
<h2 id='trendSetUp'>Interactive setup for running wBT, the WRTDS Bootstrap Test</h2><span id='topic+trendSetUp'></span>

<h3>Description</h3>

<p>Walks user through the set-up for the WRTDS Bootstrap Test.  Establishes 
start and end year for the test period.  Sets the minimum number of 
bootstrap replicates to be run, the maximum number of bootstrap replicates 
to be run, and the block length (in days) for the block bootstrapping.
The test is designed to evaluate the uncertainty about the trend between any pair of years.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trendSetUp(eList, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="trendSetUp_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Daily, Sample, and INFO dataframes. Created from the EGRET package, after running <code><a href="EGRET.html#topic+modelEstimation">modelEstimation</a></code>.</p>
</td></tr>
<tr><td><code id="trendSetUp_+3A_...">...</code></td>
<td>
<p>additional arguments to bring in to reduce interactive options 
(year1, year2, nBoot, bootBreak, blockLength)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>caseSetUp data frame with columns year1, yearData1, year2, yearData2, 
numSamples, nBoot, bootBreak, blockLength, confStop. These correspond to:
</p>

<table>
<tr>
 <td style="text-align: left;">
Column Name </td><td style="text-align: left;"> Manuscript Variable</td>
</tr>
<tr>
 <td style="text-align: left;">
year1 </td><td style="text-align: left;"> <code class="reqn">y_s</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
year2 </td><td style="text-align: left;"> <code class="reqn">y_e</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
nBoot </td><td style="text-align: left;"> <code class="reqn">M_max</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
bootBreak </td><td style="text-align: left;"> <code class="reqn">M_min</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
blockLength </td><td style="text-align: left;"> <code class="reqn">B</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>See Also</h3>

<p><code><a href="#topic+setForBoot">setForBoot</a></code>, <code><a href="#topic+wBT">wBT</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- EGRET::Choptank_eList

# Completely interactive:
# caseSetUp &lt;- trendSetUp(eList)
# Semi-interactive:
# caseSetUp &lt;- trendSetUp(eList, nBoot = 100, blockLength = 200)

# fully scripted:
caseSetUp &lt;- trendSetUp(eList,
  year1=1985, 
  year2=2005,
  nBoot = 50, 
  bootBreak = 39,
  blockLength = 200)

</code></pre>

<hr>
<h2 id='wBT'>Run the WBT (WRTDS Bootstrap Test)</h2><span id='topic+wBT'></span>

<h3>Description</h3>

<p>Runs the WBT for a given data set to evaluate the significance level and 
confidence intervals for the trends between two specified years.  The trends 
evaluated are trends in flow normalized concentration and flow normalized flux.  
Function produces text outputs and a named list (eBoot) that contains all of the 
relevant outputs. Check out <code><a href="#topic+runPairsBoot">runPairsBoot</a></code> and <code><a href="#topic+runGroupsBoot">runGroupsBoot</a></code>
for more bootstrapping options. 
The wBT only runs stationary flow normalization (i.e. making the assumption that discharge is stationary).  
The <code><a href="#topic+runPairsBoot">runPairsBoot</a></code> and <code><a href="#topic+runGroupsBoot">runGroupsBoot</a></code> allow for generalized flow normalization (i.e. non-stationary discharge).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wBT(eList, caseSetUp, saveOutput = TRUE, fileName = "temp.txt",
  startSeed = 494817, jitterOn = FALSE, V = 0.2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="wBT_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Daily, Sample, and INFO dataframes. Created from the EGRET package, after running <code><a href="EGRET.html#topic+modelEstimation">modelEstimation</a></code>.</p>
</td></tr>
<tr><td><code id="wBT_+3A_casesetup">caseSetUp</code></td>
<td>
<p>data frame. Returned from <code><a href="#topic+trendSetUp">trendSetUp</a></code>.</p>
</td></tr>
<tr><td><code id="wBT_+3A_saveoutput">saveOutput</code></td>
<td>
<p>logical. If <code>TRUE</code>, a text file will be saved in the working directory.</p>
</td></tr>
<tr><td><code id="wBT_+3A_filename">fileName</code></td>
<td>
<p>character. Name to save the output file if <code>saveOutput=TRUE</code>.</p>
</td></tr>
<tr><td><code id="wBT_+3A_startseed">startSeed</code></td>
<td>
<p>setSeed value. Defaults to 494817. This is used to make repeatable output.</p>
</td></tr>
<tr><td><code id="wBT_+3A_jitteron">jitterOn</code></td>
<td>
<p>logical, if TRUE, adds &quot;jitter&quot; to the data in an attempt to avoid some numerical problems.  Default = FALSE.  See Details below.</p>
</td></tr>
<tr><td><code id="wBT_+3A_v">V</code></td>
<td>
<p>numeric a multiplier for addition of jitter to the data, default = 0.2.  See Details below.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In some situations numerical problems are encountered in the bootstrap process, resulting in highly unreasonable spikes in the confidence intervals.
The use of &quot;jitter&quot; can often prevent these problems, but should only be used when it is clearly needed.
It adds a small amount of random &quot;jitter&quot; to the explanatory variables of the WRTDS model.  The V parameter sets the scale of variation in the log discharge values.
The standard deviation of the added jitter is V * standard deviation of Log Q.
The default for V is 0.2.  Larger values should generally be avoided, and smaller values may be sufficient.
</p>


<h3>Value</h3>

<p>eBoot, a named list with bootOut, wordsOut, xConc, xFlux, pConc, pFlux values.
</p>

<table>
<tr>
 <td style="text-align: left;">
Object </td><td style="text-align: left;"> Description</td>
</tr>
<tr>
 <td style="text-align: left;">
bootOut </td><td style="text-align: left;"> a data frame with the results of the bootstrap test. </td>
</tr>
<tr>
 <td style="text-align: left;">
wordsOut </td><td style="text-align: left;"> a character vector describing the results. </td>
</tr>
<tr>
 <td style="text-align: left;">
xConc and xFlux </td><td style="text-align: left;"> vectors of length iBoot, of the change in flow normalized concentration
   and flow normalized flux computed from each of the bootstrap replicates. </td>
</tr>
<tr>
 <td style="text-align: left;">
pConc and pFlux </td><td style="text-align: left;"> vectors of length iBoot, of the change in flow normalized concentration
   or flow normalized flux computed from each of the bootstrap replicates expressed as 
</td>
</tr>

</table>



<h3>See Also</h3>

<p><code><a href="#topic+trendSetUp">trendSetUp</a></code>, <code><a href="#topic+setForBoot">setForBoot</a></code>, <code><a href="#topic+runGroupsBoot">runGroupsBoot</a></code>, <code><a href="#topic+runPairsBoot">runPairsBoot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- EGRET::Choptank_eList
caseSetUp &lt;- trendSetUp(eList,
                        year1 = 1985, 
                        year2 = 2005,
                        nBoot = 50, 
                        bootBreak = 39,
                        blockLength = 200)
# Very long-running function:                     
## Not run: 
eBoot &lt;- wBT(eList,caseSetUp)

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
