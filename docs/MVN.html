<!DOCTYPE html><html lang="en"><head><title>Help for package MVN</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MVN}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#mvn'><p>Multivariate Normality Tests</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Multivariate Normality Tests</td>
</tr>
<tr>
<td>Version:</td>
<td>5.9</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-06-29</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Selcuk Korkmaz &lt;selcukorkmaz@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>BiocStyle, knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, nortest, moments, MASS, plyr, psych, boot, energy,
car</td>
</tr>
<tr>
<td>Collate:</td>
<td>mvn.R</td>
</tr>
<tr>
<td>Description:</td>
<td>Performs multivariate normality tests and graphical approaches and
    implements multivariate outlier detection and univariate normality of marginal
    distributions through plots and tests, and performs multivariate Box-Cox transformation 
    (Korkmaz et al, (2014), <a href="https://journal.r-project.org/archive/2014-2/korkmaz-goksuluk-zararsiz.pdf">https://journal.r-project.org/archive/2014-2/korkmaz-goksuluk-zararsiz.pdf</a>).</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-06-30 07:33:28 UTC; selcukkorkmaz</td>
</tr>
<tr>
<td>Author:</td>
<td>Selcuk Korkmaz <a href="https://orcid.org/0000-0003-4632-6850"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Dincer Goksuluk [aut],
  Gokmen Zararsiz [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-06-30 08:40:12 UTC</td>
</tr>
</table>
<hr>
<h2 id='mvn'>Multivariate Normality Tests</h2><span id='topic+mvn'></span>

<h3>Description</h3>

<p>Performs multivariate normality tests, including Marida, Royston, Henze-Zirkler, Dornik-Haansen, E-Statistics, and graphical approaches and implements multivariate outlier detection and univariate normality of marginal distributions through plots and tests, and performs multivariate Box-Cox transformation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mvn(
  data,
  subset = NULL,
  mvnTest = "hz",
  covariance = TRUE,
  tol = 1e-25,
  alpha = 0.5,
  scale = FALSE,
  desc = TRUE,
  transform = "none",
  R = 1000,
  univariateTest = "AD",
  univariatePlot = "none",
  multivariatePlot = "none",
  multivariateOutlierMethod = "none",
  bc = FALSE,
  bcType = "rounded",
  showOutliers = FALSE,
  showNewData = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mvn_+3A_data">data</code></td>
<td>
<p>a numeric matrix or data frame.</p>
</td></tr>
<tr><td><code id="mvn_+3A_subset">subset</code></td>
<td>
<p>define a variable name if subset analysis is required.</p>
</td></tr>
<tr><td><code id="mvn_+3A_mvntest">mvnTest</code></td>
<td>
<p>select one of the MVN tests. Type <code>"mardia"</code> for Mardia's test, <code>"hz"</code> for Henze-Zirkler's test, <code>"royston"</code> for Royston's test, <code>"dh"</code> for Doornik-Hansen's test and <code>energy</code> for E-statistic. Default is Henze-Zirkler's test <code>"hz"</code>. See details for further information.</p>
</td></tr>
<tr><td><code id="mvn_+3A_covariance">covariance</code></td>
<td>
<p>this option works for <code>"mardia"</code> and <code>"royston"</code>. If <code>TRUE</code> covariance matrix is normalized by <code>n</code>, if <code>FALSE</code> it is normalized by <code>n-1</code>.</p>
</td></tr>
<tr><td><code id="mvn_+3A_tol">tol</code></td>
<td>
<p>a numeric tolerance value which isused for inversion of the covariance matrix (<code>default = 1e-25</code>.</p>
</td></tr>
<tr><td><code id="mvn_+3A_alpha">alpha</code></td>
<td>
<p>a numeric parameter controlling the size of the subsets over which the determinant is minimized. Allowed values for the alpha are between 0.5 and 1 and the default is 0.5.</p>
</td></tr>
<tr><td><code id="mvn_+3A_scale">scale</code></td>
<td>
<p>if <code>TRUE</code> scales the colums of data.</p>
</td></tr>
<tr><td><code id="mvn_+3A_desc">desc</code></td>
<td>
<p>a logical argument. If <code>TRUE</code> calculates descriptive statistics.</p>
</td></tr>
<tr><td><code id="mvn_+3A_transform">transform</code></td>
<td>
<p>select a transformation method to transform univariate marginal via logarithm (<code>"log"</code>), square root (<code>"sqrt"</code>) and square (<code>"square"</code>).</p>
</td></tr>
<tr><td><code id="mvn_+3A_r">R</code></td>
<td>
<p>number of bootstrap replicates for Energy test, default is 1000.</p>
</td></tr>
<tr><td><code id="mvn_+3A_univariatetest">univariateTest</code></td>
<td>
<p>select one of the univariate normality tests, Shapiro-Wilk (<code>"SW"</code>), Cramer-von Mises (<code>"CVM"</code>), Lilliefors (<code>"Lillie"</code>), Shapiro-Francia (<code>"SF"</code>), Anderson-Darling (<code>"AD"</code>). Default is Anderson-Darling (<code>"AD"</code>). Do not apply Shapiro-Wilk's test, if dataset includes more than 5000 cases or less than 3 cases.</p>
</td></tr>
<tr><td><code id="mvn_+3A_univariateplot">univariatePlot</code></td>
<td>
<p>select one of the univariate normality plots, Q-Q plot (<code>"qq"</code>), histogram (<code>"histogram"</code>), box plot (<code>"box"</code>), scatter (<code>"scatter"</code>).</p>
</td></tr>
<tr><td><code id="mvn_+3A_multivariateplot">multivariatePlot</code></td>
<td>
<p><code>"qq"</code> for chi-square Q-Q plot, <code>"persp"</code> for perspective plot, <code>"contour"</code> for contour plot.</p>
</td></tr>
<tr><td><code id="mvn_+3A_multivariateoutliermethod">multivariateOutlierMethod</code></td>
<td>
<p>select multivariate outlier detection method, <code>"quan"</code> quantile method based on Mahalanobis distance (default) and <code>"adj"</code> adjusted quantile method based on Mahalanobis distance.</p>
</td></tr>
<tr><td><code id="mvn_+3A_bc">bc</code></td>
<td>
<p>if <code>TRUE</code> it applies Box-Cox power transformation.</p>
</td></tr>
<tr><td><code id="mvn_+3A_bctype">bcType</code></td>
<td>
<p>select <code>"optimal"</code> or <code>"rounded"</code> type of Box-Cox power transformation, only applicable if <code>bc = TRUE</code>, default is <code>"rounded"</code>.</p>
</td></tr>
<tr><td><code id="mvn_+3A_showoutliers">showOutliers</code></td>
<td>
<p>if <code>TRUE</code> prints multivariate outliers.</p>
</td></tr>
<tr><td><code id="mvn_+3A_shownewdata">showNewData</code></td>
<td>
<p>if <code>TRUE</code> prints new data without outliers.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>mvnTest = "mardia"</code>, it calculates the Mardia's multivariate skewness and kurtosis coefficients as well as their corresponding statistical significance.
It can also calculate corrected version of skewness coefficient for small sample size (n&lt; 20).
For multivariate normality, both p-values of skewness and kurtosis statistics should be greater than 0.05.
If sample size less than 20 then p.value.small should be used as significance value of skewness instead of p.value.skew.
If there are missing values in the data, a listwise deletion will be applied and a complete-case analysis will be performed.
</p>
<p>If <code>mvnTest = "hz"</code>, it calculates the Henze-Zirkler's multivariate normality test. The Henze-Zirkler test is based on a non-negative functional distance that measures the distance between two distribution functions. If the data is multivariate normal, the test statistic HZ is approximately lognormally distributed. It proceeds to calculate the mean, variance and smoothness parameter. Then, mean and variance are lognormalized and the p-value is estimated.
If there are missing values in the data, a listwise deletion will be applied and a complete-case analysis will be performed.
</p>
<p>If <code>mvnTest = "royston"</code>, it calculates the Royston's multivariate normality test. A function to generate the Shapiro-Wilk's W statistic needed to feed the Royston's H test for multivariate normality However, if kurtosis of the data greater than 3 then Shapiro-Francia test is used for leptokurtic samples else Shapiro-Wilk test is used for platykurtic samples.
If there are missing values in the data, a listwise deletion will be applied and a complete-case analysis will be performed. Do not apply Royston's test, if dataset includes more than 5000 cases or less than 3 cases, since it depends on Shapiro-Wilk's test.
</p>
<p>If <code>mvnTest = "dh"</code>, it calculates the Doornik-Hansen's multivariate normality test. The code is adapted from asbio package (Aho, 2017).
</p>
<p>If <code>mvnTest = "energy"</code>, it calculates the Energy multivariate normality test. The code is adapted from energy package (Rizzo and Szekely, 2017).
</p>


<h3>Value</h3>

<p><code>multivariateNormality</code> corresponding multivariate normality test statistics and p-value.
</p>
<p><code>univariateNormality</code> corresponding univariate normality test statistics and p-value.
</p>
<p><code>Descriptives</code> Descriptive statistics.
</p>
<p><code>multivariateOutliers</code> multivariate outliers.
</p>
<p><code>newData</code> new data without multivariate outliers.
</p>
<p>multivariate normality plots, Q-Q, perspective or contour.
</p>
<p>chi-square Q-Q plot for multivariate outliers.
</p>
<p>univariate normality plots, Q-Q plot, histogram, box plot, scatter.
</p>


<h3>Author(s)</h3>

<p>Selcuk Korkmaz, <a href="mailto:selcukorkmaz@gmail.com">selcukorkmaz@gmail.com</a>
</p>


<h3>References</h3>

<p>Korkmaz S, Goksuluk D, Zararsiz G. MVN: An R Package for Assessing Multivariate Normality. The R Journal. 2014 6(2):151-162. URL <a href="https://journal.r-project.org/archive/2014-2/korkmaz-goksuluk-zararsiz.pdf">https://journal.r-project.org/archive/2014-2/korkmaz-goksuluk-zararsiz.pdf</a>
</p>
<p>Mardia, K. V. (1970), Measures of multivariate skewnees and kurtosis with applications. Biometrika, 57(3):519-530.
</p>
<p>Mardia, K. V. (1974), Applications of some measures of multivariate skewness and kurtosis for testing normality and robustness studies. Sankhy A, 36:115-128.
</p>
<p>Henze, N. and Zirkler, B. (1990), A Class of Invariant Consistent Tests for Multivariate Normality. Commun. Statist.-Theor. Meth., 19(10): 35953618.
</p>
<p>Henze, N. and Wagner, Th. (1997), A New Approach to the BHEP tests for multivariate normality. Journal of Multivariate Analysis, 62:1-23.
</p>
<p>Royston, J.P. (1982). An Extension of Shapiro and Wilks W Test for Normality to Large Samples. Applied Statistics, 31(2):115124.
</p>
<p>Royston, J.P. (1983). Some Techniques for Assessing Multivariate Normality Based on the Shapiro-Wilk W. Applied Statistics, 32(2).
</p>
<p>Royston, J.P. (1992). Approximating the Shapiro-Wilk W-Test for non-normality. Statistics and Computing, 2:117-119.121133.
</p>
<p>Royston, J.P. (1995). Remark AS R94: A remark on Algorithm AS 181: The W test for normality. Applied Statistics, 44:547-551.
</p>
<p>Shapiro, S. and Wilk, M. (1965). An analysis of variance test for normality. Biometrika, 52:591611.
</p>
<p>Doornik, J.A. and Hansen, H. (2008). An Omnibus test for univariate and multivariate normality. Oxford Bulletin of Economics and Statistics 70, 927-939.
</p>
<p>G. J. Szekely and M. L. Rizzo (2013). Energy statistics: A class of statistics based on distances, Journal of Statistical Planning and Inference, http://dx.doi.org/10.1016/j.jspi.2013.03.018
</p>
<p>M. L. Rizzo and G. J. Szekely (2016). Energy Distance, WIRES Computational Statistics, Wiley, Volume 8 Issue 1, 27-38. Available online Dec., 2015, http://dx.doi.org/10.1002/wics.1375.
</p>
<p>G. J. Szekely and M. L. Rizzo (2017). The Energy of Data. The Annual Review of Statistics and Its Application 4:447-79. 10.1146/annurev-statistics-060116-054026
</p>


<h3>Examples</h3>

<pre><code class='language-R'>result = mvn(data = iris[-4], subset = "Species", mvnTest = "hz",
             univariateTest = "AD", univariatePlot = "histogram",
             multivariatePlot = "qq", multivariateOutlierMethod = "adj",
             showOutliers = TRUE, showNewData = TRUE)

#### Multivariate Normality Result
result$multivariateNormality

### Univariate Normality Result
result$univariateNormality

### Descriptives
result$Descriptives

### Multivariate Outliers
result$multivariateOutliers

### New data without multivariate outliers
result$newData

# Note that this function also creates univariate histograms,
# multivariate Q-Q plots for multivariate normality assessment
# and multivariate outlier detection.

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
