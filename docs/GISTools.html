<!DOCTYPE html><html lang="en"><head><title>Help for package GISTools</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {GISTools}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#GISTools-package'><p>GISTools</p></a></li>
<li><a href='#Add+20masking+20around+20an+20image'><p> Draw a mask around a Grid Based Image</p></a></li>
<li><a href='#auto.shading'><p> auto.shading</p></a></li>
<li><a href='#choro.legend'><p>choro.legend</p></a></li>
<li><a href='#choropleth'><p> choropleth</p></a></li>
<li><a href='#Computational+20Inference+20from+20Point+20Data'><p> Bootstrap and Kernel Bootstrap from Points</p></a></li>
<li><a href='#Create+20a+20+26lsquo+3Bmask+26rsquo+3B+20polygon'><p> Create a masking polygon to block out graphics outside a region.</p></a></li>
<li><a href='#Create+20Transparency'><p> Add transparency to a hex-defined colour</p></a></li>
<li><a href='#cut+20function'><p>Cut functions</p></a></li>
<li><a href='#generalize.polys'><p>generalize.polys</p></a></li>
<li><a href='#georgia'><p>Georgia Social and Economic Data by County</p></a></li>
<li><a href='#Kernel+20Density+20Estimates+20From+20Points'><p>Kernel Density Estimates</p></a></li>
<li><a href='#level.plot'><p>Level plot for gridded data</p></a></li>
<li><a href='#map.scale'><p>map.scale</p></a></li>
<li><a href='#newhaven'><p>New Haven, Connecticut: Crime data with contextual information</p></a></li>
<li><a href='#North+20Arrow'><p>Add a north arrow to a map</p></a></li>
<li><a href='#phenology'><p>Phenology data for North American lilacs</p></a></li>
<li><a href='#Point+20in+20Polygon+20Counts'><p>Number of Points in Each Polygon</p></a></li>
<li><a href='#Polygon+20Areas'><p>Area of Each Polygon</p></a></li>
<li><a href='#Polygon+20Label+20Points'><p>Number of Points in Each Polygon</p></a></li>
<li><a href='#shading'><p> Shading</p></a></li>
<li><a href='#thematic.map'><p> thematic.map</p></a></li>
<li><a href='#tornados'><p>US Tornado Touchdown Data</p></a></li>
<li><a href='#Unit+20Conversion'><p> Distance Units Conversion</p></a></li>
<li><a href='#vulgaris'><p>Phenology data for North American lilacs</p></a></li>
<li><a href='#WHData'><p>Data sets of Wuhan</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Further Capabilities in Geographic Information Science</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0-2</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-10-03</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Binbin Lu &lt;binbinlu@whu.edu.cn&gt;</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Description:</td>
<td>Mapping and spatial data manipulation tools - in particular
    drawing thematic maps with nice looking legends,  and aggregation of point
    data to polygons.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0),sf, sp</td>
</tr>
<tr>
<td>Imports:</td>
<td>RColorBrewer, MASS,methods</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-10-02 17:01:39 UTC; Lenovo</td>
</tr>
<tr>
<td>Author:</td>
<td>Chris Brunsdon [aut],
  Binbin Lu [aut, cre],
  Hongyan Chen [aut]</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-10-02 20:00:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='GISTools-package'>GISTools</h2><span id='topic+GISTools-package'></span><span id='topic+GISTools'></span>

<h3>Description</h3>

<p>In this package, a number of utilities for handling and visualising geographical data of a &ldquo;Spatial&rdquo; or &ldquo;sf&rdquo; object - for example choropleth mapping with 'nice' legends.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> GISTools</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0-2</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2024-10-03</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;=2)</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>


<hr>
<h2 id='Add+20masking+20around+20an+20image'> Draw a mask around a Grid Based Image </h2><span id='topic+add.masking'></span>

<h3>Description</h3>

<p>Takes an &lsquo;mask&rsquo; type polygon object - basically a rectangle with a polygon hole cut through it - and draws this over an image.  This has the effect of only showing the image inside the hole.  This is useful for plotting surfaces defined over a study area,  but masking the values outside of the area.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add.masking(maskPoly,color)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Add+2B20masking+2B20around+2B20an+2B20image_+3A_maskpoly">maskPoly</code></td>
<td>
<p>A masking polygon of a &ldquo;Spatial&rdquo; or &ldquo;sf&rdquo; class as described above.</p>
</td></tr>
<tr><td><code id="Add+2B20masking+2B20around+2B20an+2B20image_+3A_color">color</code></td>
<td>
<p>Colour of the mask.  Defaults to white,  but for example,  sea could be shown as blue.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Returns no value,  but draws a mask on the current graphics device as a side effect
</p>


<h3>Value</h3>

<p>None</p>


<h3>Author(s)</h3>

<p>Chris Brunsdon, Binbin Lu</p>


<h3>See Also</h3>

<p><code><a href="#topic+poly.outer">poly.outer</a></code>, <code><a href="#topic+kde.points">kde.points</a></code>. </p>


<h3>Examples</h3>

<pre><code class='language-R'>  
# Data for New Haven to use in example
data(newhaven)
# Do the KDE
breach.dens = kde.points(breach,lims=tracts)
# Plot the result
level.plot(breach.dens)
# Block out the part outside the study area
masker = poly.outer(breach.dens,tracts,extend=100); add.masking(masker)
add.masking(masker,"blue")
  
</code></pre>

<hr>
<h2 id='auto.shading'> auto.shading </h2><span id='topic+auto.shading'></span>

<h3>Description</h3>

<p>Creates an object of class <code>shading</code> automatically,  given a choropleth variable to be mapped.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>auto.shading(x, digits = 2, cutter = quantileCuts, n = 5, 
	params = NA, cols = brewer.pal(n, "Reds"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="auto.shading_+3A_x">x</code></td>
<td>
<p>The variable to be mapped.</p>
</td></tr>
<tr><td><code id="auto.shading_+3A_digits">digits</code></td>
<td>
<p>The number of significant digits to round the class limits to. </p>
</td></tr>
<tr><td><code id="auto.shading_+3A_cutter">cutter</code></td>
<td>
<p>Function used to create the break points.  Can be user defined or a supplied <a href="#topic+quantileCuts">cut function</a>.</p>
</td></tr>
<tr><td><code id="auto.shading_+3A_n">n</code></td>
<td>
<p>The number of classes.  The should be one more than the number of break points.</p>
</td></tr>
<tr><td><code id="auto.shading_+3A_params">params</code></td>
<td>
<p>Other parameters to be passed to the cut function.</p>
</td></tr>
<tr><td><code id="auto.shading_+3A_cols">cols</code></td>
<td>
<p>List of colours for shading each class. <code>length(cols)</code> should be equal to <code>n</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Returns an object of class <code>shading</code>,  as set out below:
</p>


<h3>Value</h3>

<p>An object of class <code>shading</code>,  having the following list elements:
</p>
<table role = "presentation">
<tr><td><code>breaks</code></td>
<td>
<p>Break points between choropleth classes.  <code>length(cols)</code>  </p>
</td></tr>
<tr><td><code>cols</code></td>
<td>
<p>Colours to shade in each class. <code>length(cols)</code> should be one more than  <code>length(breaks)</code>   </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Chris Brunsdon, Binbin Lu</p>


<h3>See Also</h3>

<p><code><a href="#topic+choropleth">choropleth</a></code>,<code><a href="#topic+shading">shading</a></code>,<code><a href="#topic+choro.legend">choro.legend</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'># Read in map data and compute a rate for mapping
# Try the sf class
data(WHData)
shades = auto.shading(WHHP[["Avg_HP_avg"]],n=7)
dev.new(width = 16, height = 12)
choropleth(sp = WHHP,v="Avg_HP_avg",shading=shades)
choro.legend(548871.4, 3377000, shades,title='Average house price')
#Try the Spatial object
shades = auto.shading(whp_sp@data[["Avg_HP_avg"]],n=6)
dev.new(width = 16, height = 12)
choropleth(sp = whp_sp,v="Avg_HP_avg",shading=shades)
choro.legend(548871.4, 3377000,  shades,title='Average house price')
</code></pre>

<hr>
<h2 id='choro.legend'>choro.legend</h2><span id='topic+choro.legend'></span>

<h3>Description</h3>

<p>Draw a legend for a choropleth map.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>choro.legend(px, py, sh, under = "under", over = "over", 
  between = "to", fmt = "%g", cex=1, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="choro.legend_+3A_px">px</code></td>
<td>
 <p><var>x</var> coordinate of legend location </p>
</td></tr>
<tr><td><code id="choro.legend_+3A_py">py</code></td>
<td>
 <p><var>y</var> coordinate of legend location</p>
</td></tr>
<tr><td><code id="choro.legend_+3A_sh">sh</code></td>
<td>
<p> Shading scheme object used as basis for the legend </p>
</td></tr>
<tr><td><code id="choro.legend_+3A_under">under</code></td>
<td>
<p> What to write in front of the lowest choropleth class upper limit.</p>
</td></tr>
<tr><td><code id="choro.legend_+3A_over">over</code></td>
<td>
<p> What to write in front of the highest choropleth class lower limit. </p>
</td></tr>
<tr><td><code id="choro.legend_+3A_between">between</code></td>
<td>
<p> What to write between the upper and lower limits of intermediate chropleth classes. </p>
</td></tr>
<tr><td><code id="choro.legend_+3A_fmt">fmt</code></td>
<td>
<p>C style format for values stated in above choroplth class limits. </p>
</td></tr>
<tr><td><code id="choro.legend_+3A_cex">cex</code></td>
<td>
<p> Relative size of text in the legend. </p>
</td></tr>
<tr><td><code id="choro.legend_+3A_...">...</code></td>
<td>
<p>Other arguments, passed on to the generic <code><a href="graphics.html#topic+legend">legend</a></code> function. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Returns no value,  but draws a choropleth map legend on the current graphics device as a side effect
</p>


<h3>Value</h3>

<p>None (see above)
</p>


<h3>Author(s)</h3>

<p> Chris Brunsdon </p>


<h3>See Also</h3>

<p><code><a href="#topic+choropleth">choropleth</a></code>, <code><a href="#topic+auto.shading">auto.shading</a></code>, <code><a href="#topic+shading">shading</a></code>. </p>


<h3>Examples</h3>

<pre><code class='language-R'># Read in map data and compute a rate for mapping
# Try the sf class
data(WHData)
shades = auto.shading(WHHP[["Avg_HP_avg"]],n=7)
dev.new(width = 16, height = 12)
choropleth(sp = WHHP,v="Avg_HP_avg",shading=shades)
choro.legend(548871.4, 3377000, shades,title='Average house price')
#Try the Spatial object
shades = auto.shading(whp_sp@data[["Avg_HP_avg"]],n=6)
dev.new(width = 16, height = 12)
choropleth(sp = whp_sp,v="Avg_HP_avg",shading=shades)
choro.legend(548871.4, 3377000,  shades,title='Average house price')
</code></pre>

<hr>
<h2 id='choropleth'> choropleth</h2><span id='topic+choropleth'></span>

<h3>Description</h3>

<p>Draws a choropleth map given a spatialPolygons object,  a variable and a shading scheme.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>choropleth(sp, v, shading, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="choropleth_+3A_sp">sp</code></td>
<td>
<p> A <code>SpatialPolygonsDataFrame</code> or <code>sf</code> -POLYGON or - MULTIPOLYGON object. </p>
</td></tr>
<tr><td><code id="choropleth_+3A_v">v</code></td>
<td>
<p> The variable name to be mapped and must included in the data.</p>
</td></tr>
<tr><td><code id="choropleth_+3A_shading">shading</code></td>
<td>
<p> A shading scheme created by <code>shading</code> or <code>auto.shading</code>.</p>
</td></tr>
<tr><td><code id="choropleth_+3A_...">...</code></td>
<td>
<p>Additional parameters to be passed on to the <code>plot</code> method for <code>sp</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function returns no value,  but draws a choropleth map on the current graphics device as a side effect.
</p>


<h3>Value</h3>

<p>None (see above).
</p>


<h3>Author(s)</h3>

<p>Chris Brunsdon, Binbin Lu</p>


<h3>See Also</h3>

<p><code><a href="#topic+choro.legend">choro.legend</a></code>, <code><a href="#topic+auto.shading">auto.shading</a></code>, <code><a href="#topic+shading">shading</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'># Read in map data and compute a rate for mapping
# Try the sf class
data(WHData)
shades = auto.shading(WHHP[["Avg_HP_avg"]],n=7)
dev.new(width = 16, height = 12)
choropleth(sp = WHHP,v="Avg_HP_avg",shading=shades)
choro.legend(548871.4, 3377000, shades,title='Average house price')
#Try the Spatial object
shades = auto.shading(whp_sp@data[["Avg_HP_avg"]],n=6)
dev.new(width = 16, height = 12)
choropleth(sp = whp_sp,v="Avg_HP_avg",shading=shades)
choro.legend(548871.4, 3377000,  shades,title='Average house price')
</code></pre>

<hr>
<h2 id='Computational+20Inference+20from+20Point+20Data'> Bootstrap and Kernel Bootstrap from Points </h2><span id='topic+jitter.points'></span><span id='topic+bstrap.points'></span>

<h3>Description</h3>

<p>Operations for bootstrapping and kernel bootstrapping based on point data.<code> bstrap.points </code> sample <code>n</code> points with replacement from a sample - and <code> jitter.points </code> adds a Gaussian displacement to each point in a data set.  Applying a jitter to a bootstrap effectively creates a kernel bootstrap operation.</p>


<h3>Usage</h3>

<pre><code class='language-R'>jitter.points(pts,scl)
bstrap.points(pts)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Computational+2B20Inference+2B20from+2B20Point+2B20Data_+3A_pts">pts</code></td>
<td>
<p>A <code>SpatialPointsDataFrame</code> or <code>sf</code> - POINT object</p>
</td></tr>
<tr><td><code id="Computational+2B20Inference+2B20from+2B20Point+2B20Data_+3A_scl">scl</code></td>
<td>
<p>A scale parameter - basically the standard deviation of the random Gaussian displacement</p>
</td></tr></table>


<h3>Value</h3>

<p>A <code>SpatialPointsDataFrame</code> - with either a sample without replacement or a replica of the input data with displacements.
</p>


<h3>Author(s)</h3>

<p>Chris Brunsdon, Binbin Lu</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(newhaven)
plot(blocks)
for (i in 1:20) plot(jitter.points(breach,150),add=TRUE,pch=1,col='red')

</code></pre>

<hr>
<h2 id='Create+20a+20+26lsquo+3Bmask+26rsquo+3B+20polygon'> Create a masking polygon to block out graphics outside a region. </h2><span id='topic+poly.outer'></span>

<h3>Description</h3>

<p>Takes a polygon object and creates a new polygon whose outline is rectangular, but has a hole shaped like the input polygon cut into it. This is useful for plotting surfaces defined over a study area,  but masking the values outside of the area.  It is designed to work with pixel images,  so that the mask covers up all parts of the image not in the input polygon.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>poly.outer(exo.object,input.poly,extend=0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Create+2B20a+2B20+2B26lsquo+2B3Bmask+2B26rsquo+2B3B+2B20polygon_+3A_exo.object">exo.object</code></td>
<td>
<p>The object extending beyond <code>input.poly</code> that is to be masked.  This is required to ensure that 
the external rectangle of the mask will be large enough.</p>
</td></tr>
<tr><td><code id="Create+2B20a+2B20+2B26lsquo+2B3Bmask+2B26rsquo+2B3B+2B20polygon_+3A_input.poly">input.poly</code></td>
<td>
<p>The polygon used to make the hole in the mask.</p>
</td></tr>
<tr><td><code id="Create+2B20a+2B20+2B26lsquo+2B3Bmask+2B26rsquo+2B3B+2B20polygon_+3A_extend">extend</code></td>
<td>
<p>A buffer used to extend the mask if it is required to be larger than <code>exo.object</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A polygon object whose outline is rectangular,  but having holes cut into it in the shape of <code>input.poly</code></p>


<h3>Author(s)</h3>

<p>Chris Brunsdon, Binbin Lu</p>


<h3>See Also</h3>

<p><code><a href="#topic+add.masking">add.masking</a></code>, <code><a href="#topic+kde.points">kde.points</a></code>. </p>


<h3>Examples</h3>

<pre><code class='language-R'>  
# Data for New Haven to use in example
data(newhaven)
# Do the KDE
breach.dens = kde.points(breach,lims=tracts)
# Plot the result
level.plot(breach.dens)
# Block out the part outside the study area
masker = poly.outer(breach.dens,tracts,extend=100); add.masking(masker)
# Plot census tract boundaries
plot(tracts,add=TRUE)
</code></pre>

<hr>
<h2 id='Create+20Transparency'> Add transparency to a hex-defined colour </h2><span id='topic+add.alpha'></span>

<h3>Description</h3>

<p>Takes a colour defined in hex format as <code>#XXXXXX</code> and adds a two transparency bytes <code>XX</code> based on a number from 0 to 1.  Its main use is to make RColorBrewer palettes transparent.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add.alpha(hex.color.list,alpha)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Create+2B20Transparency_+3A_hex.color.list">hex.color.list</code></td>
<td>
<p>A list of strings defining solid colors in six byte format.</p>
</td></tr>
<tr><td><code id="Create+2B20Transparency_+3A_alpha">alpha</code></td>
<td>
<p>A value (or list of values) from 0 to 1 specifying transparency.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of strings defining transparent colours in eight byte format.</p>


<h3>Author(s)</h3>

<p>Chris Brunsdon</p>


<h3>Examples</h3>

<pre><code class='language-R'># Make a list of semi-transparent RColorBrewer colours,  based on Brewer's Red palette with 5 shades
require(RColorBrewer)
add.alpha(brewer.pal(5,'Reds'),0.5)
</code></pre>

<hr>
<h2 id='cut+20function'>Cut functions</h2><span id='topic+quantileCuts'></span><span id='topic+sdCuts'></span><span id='topic+rangeCuts'></span>

<h3>Description</h3>

<p>Helper functions for <code><a href="#topic+auto.shading">auto.shading</a></code>.  Given a variable to be mapped, a number of classes and possibly some more <code>params</code>,  returns a list of break values.  There should be one less break value than the number of classes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>quantileCuts(x, n = 5, params = NA)
sdCuts(x, n = 5, params = NA)
rangeCuts(x, n = 5, params = NA)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cut+2B20function_+3A_x">x</code></td>
<td>
<p>The variable to be mapped.</p>
</td></tr>
<tr><td><code id="cut+2B20function_+3A_n">n</code></td>
<td>
<p>The number of classes.</p>
</td></tr>
<tr><td><code id="cut+2B20function_+3A_params">params</code></td>
<td>
<p>Extra params for individual cut functions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An ordered list of the break values between classes
</p>


<h3>Note</h3>

<p>The only cut function using <code>params</code> is <code>quantileCuts</code>,  where it is used to specify a list of quantile values - useful if they are not evenly spaced.
</p>


<h3>Author(s)</h3>

<p>Chris Brunsdon</p>


<h3>See Also</h3>

<p><code><a href="#topic+auto.shading">auto.shading</a></code></p>

<hr>
<h2 id='generalize.polys'>generalize.polys</h2><span id='topic+generalize.polys'></span>

<h3>Description</h3>

<p>Generalises a <code>SpatialPolygons</code> or <code>SpatialPolygonsDataFrame</code> or a <code>sf</code> -POLYGON or - MULTIPOLYGON object using the Douglas-Peuker algorithm</p>


<h3>Usage</h3>

<pre><code class='language-R'>generalize.polys(sfo, preserveTopology, dTolerance)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="generalize.polys_+3A_sfo">sfo</code></td>
<td>
<p>A <code>SpatialPolygons</code> or <code>SpatialPolygonsDataFrame</code> or a <code>sf</code> -POLYGON or - MULTIPOLYGON object.</p>
</td></tr>
<tr><td><code id="generalize.polys_+3A_preservetopology">preserveTopology</code></td>
<td>
<p>logical; carry out topology preserving simplification? May be specified for each, or for all feature geometries. Note that topology is preserved only for single feature geometries, not for sets of them.</p>
</td></tr>
<tr><td><code id="generalize.polys_+3A_dtolerance">dTolerance</code></td>
<td>
<p>numeric; tolerance parameter, specified for all or for each feature geometry.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Returns an object of the same class as <code>sp</code>. Note that the algorithm is applied on a polygon-by-polygon,
not edge-by-edge basis.  Thus edges in generalised polygons may not match perfectly.
</p>


<h3>Value</h3>

<p>An object of class <code>SpatialPolygons</code> or <code>SpatialPolygonsDataFrame</code>. Each polygon shape has been 
generalized using the Douglas-Peuker algorithm.
</p>


<h3>Author(s)</h3>

<p>Chris Brunsdon, Binbin Lu</p>


<h3>Examples</h3>

<pre><code class='language-R'># Data for Georgia to use in example

data(WHData)
WH.outline &lt;- st_union(WHHP)
WH.generalised &lt;- generalize.polys(WH.outline,TRUE,0.1)
plot(st_geometry(WHHP))
plot(st_geometry(WH.generalised),add=TRUE,border='red',lwd=2)

</code></pre>

<hr>
<h2 id='georgia'>Georgia Social and Economic Data by County</h2><span id='topic+georgia'></span><span id='topic+georgia2'></span><span id='topic+georgia.polys'></span>

<h3>Description</h3>

<p> Polygon Data Frame as used in the Brunsdon, Fotheringham &amp; Charlton GWR book, with further variable median income (MedInc)</p>


<h3>Usage</h3>

<pre><code class='language-R'> data(georgia)</code></pre>


<h3>Format</h3>


<ul>
<li> <p><strong>georgia</strong>  Georgia polygons <code>SpatialPolygonsDataFrame</code> - geographical projection 
</p>
</li>
<li> <p><strong>georgia2</strong> Georgia polygons <code>SpatialPolygonsDataFrame </code> - equal area projection 
</p>
</li>
<li> <p><strong>georgia.polys</strong> Georgia polygons in list format - equal area projection 
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># Read in the data
data(georgia)
# Make a map of median income
choropleth(georgia2,"MedInc")
</code></pre>

<hr>
<h2 id='Kernel+20Density+20Estimates+20From+20Points'>Kernel Density Estimates</h2><span id='topic+kde.points'></span>

<h3>Description</h3>

<p>Given a set of points,  a bandwidth, a grid density and a frame, produce a kernel density estimate</p>


<h3>Usage</h3>

<pre><code class='language-R'>kde.points(pts,h,n=200,lims=NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Kernel+2B20Density+2B20Estimates+2B20From+2B20Points_+3A_pts">pts</code></td>
<td>
<p>A <code>SpatialPoints</code> or <code>SpatialPointsDataFrame</code> object or <code>sf</code> - POINT object.</p>
</td></tr>
<tr><td><code id="Kernel+2B20Density+2B20Estimates+2B20From+2B20Points_+3A_h">h</code></td>
<td>
<p>A real number - the bandwidth of the KDE</p>
</td></tr>
<tr><td><code id="Kernel+2B20Density+2B20Estimates+2B20From+2B20Points_+3A_n">n</code></td>
<td>
<p>An integer,  the output grid density - ie result is nxn grid</p>
</td></tr>
<tr><td><code id="Kernel+2B20Density+2B20Estimates+2B20From+2B20Points_+3A_lims">lims</code></td>
<td>
<p>A spatial object - the KDE grid will cover this,  if provided</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>SpatialPixelsDataFrame</code> containing the KDE.
</p>


<h3>Author(s)</h3>

<p>Chris Brunsdon, Binbin Lu</p>


<h3>Examples</h3>

<pre><code class='language-R'>  
# Data for New Haven to use in example
data(newhaven)
# Do the KDE
breach.dens = kde.points(breach,lims=tracts)
# Plot the result
level.plot(breach.dens)
# Block out the part outside the study area
masker = poly.outer(breach.dens,tracts,extend=100); add.masking(masker)
# Plot census tract boundaries
plot(tracts,add=TRUE)
  
</code></pre>

<hr>
<h2 id='level.plot'>Level plot for gridded data</h2><span id='topic+level.plot'></span>

<h3>Description</h3>

<p>Draws a level plot given a SpatialPixelsDataFrame,  an index and a shading scheme.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>level.plot(grd, shades, index=1, add=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="level.plot_+3A_grd">grd</code></td>
<td>
<p> A <code>spatialPixelsDataFrame</code> object. </p>
</td></tr>
<tr><td><code id="level.plot_+3A_shades">shades</code></td>
<td>
<p> A shading scheme created by <code>shading</code> or <code>auto.shading</code>. If omitted,  chosen automatically from <code>grd</code>.</p>
</td></tr>
<tr><td><code id="level.plot_+3A_index">index</code></td>
<td>
<p>Index giving the variable in <code>grd</code> to plot.</p>
</td></tr>
<tr><td><code id="level.plot_+3A_add">add</code></td>
<td>
<p>Whether to add the level plot to an existing plot.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function returns no value,  but draws a level plot on the current graphics device as a side effect.
</p>


<h3>Value</h3>

<p>None (see above).
</p>


<h3>Author(s)</h3>

<p>Chris Brunsdon, Binbin Lu</p>


<h3>Examples</h3>

<pre><code class='language-R'>  
# Data for New Haven to use in example
data(newhaven)
# Do the KDE
breach.dens = kde.points(breach,lims=tracts)
# Plot the result
level.plot(breach.dens)
</code></pre>

<hr>
<h2 id='map.scale'>map.scale</h2><span id='topic+map.scale'></span>

<h3>Description</h3>

<p>Draws a scale bar on a map.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>map.scale(xc,yc,len,units,ndivs,subdiv=1,tcol='black',scol='black',sfcol='black')
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="map.scale_+3A_xc">xc</code></td>
<td>
<p> The <var>x</var>-centre (in map units) of the scale bar </p>
</td></tr>
<tr><td><code id="map.scale_+3A_yc">yc</code></td>
<td>
<p> The <var>y</var>-centre (in map units) of the scale bar </p>
</td></tr>
<tr><td><code id="map.scale_+3A_len">len</code></td>
<td>
<p> The length (in map units) of the scale bar </p>
</td></tr>
<tr><td><code id="map.scale_+3A_units">units</code></td>
<td>
<p> String specifying the name of the units for the scale bar </p>
</td></tr>
<tr><td><code id="map.scale_+3A_ndivs">ndivs</code></td>
<td>
<p>The number of divisions (units marked) on the scale </p>
</td></tr>
<tr><td><code id="map.scale_+3A_subdiv">subdiv</code></td>
<td>
<p>The fraction of <code>units</code> used to step along the divisions </p>
</td></tr>
<tr><td><code id="map.scale_+3A_tcol">tcol</code></td>
<td>
<p> The colour of text on the scale bar. </p>
</td></tr>
<tr><td><code id="map.scale_+3A_scol">scol</code></td>
<td>
<p> The colour of the scale bar itself. </p>
</td></tr>
<tr><td><code id="map.scale_+3A_sfcol">sfcol</code></td>
<td>
<p> The colour of the filled rectangles in the scale bar. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Draws an alternating bar scale on a map. Returns no value.
</p>


<h3>Value</h3>

<p>None (see above)
</p>


<h3>Author(s)</h3>

<p> Chris Brunsdon </p>


<h3>See Also</h3>

<p><code><a href="#topic+choro.legend">choro.legend</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># Read in map data for New Haven
data(newhaven)
# Plot census block boundaries
plot(blocks)
# Add a map scale
map.scale(534750,152000,miles2ft(2),"Miles",4,0.5,sfcol='red')
# ... and a title
title('New Haven (CT)')
</code></pre>

<hr>
<h2 id='newhaven'>New Haven, Connecticut: Crime data with contextual information</h2><span id='topic+newhaven'></span><span id='topic+blocks'></span><span id='topic+breach'></span><span id='topic+famdisp'></span><span id='topic+burgres.f'></span><span id='topic+burgres.n'></span><span id='topic+places'></span><span id='topic+roads'></span><span id='topic+tracts'></span>

<h3>Description</h3>

<p>Data set from New Haven (CT) crime web site containing point sources of some crimes,  plus roads,  railways and census block spatial data frames.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(newhaven)</code></pre>


<h3>Format</h3>


<ul>
<li> <p><strong>blocks</strong> Census blocks <code>SpatialPolygonsDataFrame </code> 
</p>
</li>
<li> <p><strong>roads</strong> Roads <code>SpatialLinesDataFrame </code> 
</p>
</li>
<li> <p><strong>places</strong> Place names <code>SpatialPointsDataFrame</code>
</p>
</li>
<li> <p><strong>breach</strong> Breach of peace <code>SpatialPointsDataFrame </code> 
</p>
</li>
<li> <p><strong>famdisp</strong> Family dispute <code>SpatialPointsDataFrame</code> 
</p>
</li>
<li> <p><strong>tracts</strong> Census tracts <code>SpatialPolygonsDataFrame</code> 
</p>
</li>
<li> <p><strong>burgres.f</strong> Residential Burglary (Forced) <code>SpatialPointsDataFrame</code> 
</p>
</li>
<li> <p><strong>burgres.n</strong> Residential Burglary (Non-Forced) <code>SpatialPointsDataFrame</code> 
</p>
</li></ul>



<h3>Source</h3>

 <p><code> http://www.newhavencrimelog.org/ </code></p>


<h3>Examples</h3>

<pre><code class='language-R'># Read in map data for New Haven
data(newhaven)
# Plot census block boundaries
plot(blocks)
# Add a map scale
map.scale(534750,152000,miles2ft(2),"Miles",4,0.5,sfcol='red')
# ... and a title
title('New Haven (CT)')
</code></pre>

<hr>
<h2 id='North+20Arrow'>Add a north arrow to a map</h2><span id='topic+north.arrow'></span>

<h3>Description</h3>

<p>Draws a north arrow on a map.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>north.arrow(xb,yb,len,lab='NORTH',cex.lab=1,tcol='black',...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="North+2B20Arrow_+3A_xb">xb</code></td>
<td>
<p> The <var>x</var>-centre (in map units) of the arrow base.</p>
</td></tr>
<tr><td><code id="North+2B20Arrow_+3A_yb">yb</code></td>
<td>
<p> The <var>y</var>-centre (in map units) of the arrow base.</p>
</td></tr>
<tr><td><code id="North+2B20Arrow_+3A_len">len</code></td>
<td>
<p> The length (in map units) of the arrow base.</p>
</td></tr>
<tr><td><code id="North+2B20Arrow_+3A_lab">lab</code></td>
<td>
<p>The label for the arrow.</p>
</td></tr>
<tr><td><code id="North+2B20Arrow_+3A_cex.lab">cex.lab</code></td>
<td>
<p>Scale factor for the label for the arrow.</p>
</td></tr>
<tr><td><code id="North+2B20Arrow_+3A_tcol">tcol</code></td>
<td>
<p> The colour of the label text. </p>
</td></tr>
<tr><td><code id="North+2B20Arrow_+3A_...">...</code></td>
<td>
<p> Other graphical parameters passed to the drawing of the arrow. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Draws a north arrow on a map. The arrow itself is drawn using <code>polygon</code> and any extra parameters are passed to this call.
</p>


<h3>Value</h3>

<p>None.
</p>


<h3>Author(s)</h3>

<p> Chris Brunsdon </p>


<h3>See Also</h3>

<p><code><a href="#topic+map.scale">map.scale</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># Read in map data for New Haven
data(newhaven)
# Plot census block boundaries
plot(blocks)
# Add a north arrow
north.arrow(534750,152000,miles2ft(0.5),col='cyan')
# ... and a title
title('New Haven (CT)')
</code></pre>

<hr>
<h2 id='phenology'>Phenology data for North American lilacs</h2><span id='topic+phenology'></span><span id='topic+chinensis'></span><span id='topic+chinensis2'></span>

<h3>Description</h3>

<p>Data set from Schwartz, M.D. and J.M. Caprio, 2003, North American First Leaf and First Bloom Lilac Phenology Data, IGBP PAGES/World Data Center for Paleoclimatology 
Data Contribution Series # 2003-078. NOAA/NGDC Paleoclimatology Program, Boulder CO, USA.</p>


<h3>Usage</h3>

<pre><code class='language-R'> data(phenology)</code></pre>


<h3>Format</h3>


<ul>
<li> <p><strong>chinensis</strong> Syringa Chinensis Observation Stations <code>SpatialPointsDataFrame</code> - geographical projection 
</p>
</li>
<li> <p><strong>chinensis2</strong> Syringa Chinensis Observation Stations <code>SpatialPointsDataFrame </code> - equal area projection  
</p>
</li>
<li> <p><strong>us_states</strong> States of US <code>SpatialPolygonsDataFrame </code> - geographical projection 
</p>
</li>
<li> <p><strong>us_states2</strong> States of US <code>SpatialPolygonsDataFrame </code> - equal area projection 
</p>
</li></ul>



<h3>Source</h3>

 <p><code> http://www.ncdc.noaa.gov/paleo/phenology.html </code></p>


<h3>Examples</h3>

<pre><code class='language-R'># Read in the data
data(phenology)
# Split the plot in two
opar &lt;- par(mfrow=c(2,1))
# Plot US states
plot(us_states2)
# Add Locations of observation stations
plot(chinensis2,add=TRUE,pch=16,col='red')
# Plot a histogram of year of observation next to this
hist(chinensis2$Year)
par(opar)
</code></pre>

<hr>
<h2 id='Point+20in+20Polygon+20Counts'>Number of Points in Each Polygon</h2><span id='topic+poly.counts'></span>

<h3>Description</h3>

<p>Given a set of points,  and a set of polygons,  computes the number of points in each polygon.</p>


<h3>Usage</h3>

<pre><code class='language-R'>poly.counts(pts, polys)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Point+2B20in+2B20Polygon+2B20Counts_+3A_pts">pts</code></td>
<td>
<p>A <code>SpatialPoints</code> or <code>SpatialPointsDataFrame</code> <code>sf</code> - POINT object .</p>
</td></tr>
<tr><td><code id="Point+2B20in+2B20Polygon+2B20Counts_+3A_polys">polys</code></td>
<td>
<p>A <code>SpatialPolygons</code> or <code>SpatialPolygonsDataFrame</code> or <code>sf</code> -POLYGON or - MULTIPOLYGON object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of integers of the same length as the number of polygons in <code>polys</code>,  giving the number of points from <code>pts</code>.
</p>


<h3>Author(s)</h3>

<p>Chris Brunsdon, Binbin Lu</p>


<h3>Examples</h3>

<pre><code class='language-R'># Data for New Haven to use in example
data(newhaven)
# How many breaches of peace in each census block?
n.breach = poly.counts(breach,blocks)
blocks@data$Count.per &lt;- n.breach/poly.areas(blocks)
# Compute densities and map them
choropleth(blocks,"Count.per")
</code></pre>

<hr>
<h2 id='Polygon+20Areas'>Area of Each Polygon</h2><span id='topic+poly.areas'></span>

<h3>Description</h3>

<p>Given a set of polygons,  returns the area of each polygon.</p>


<h3>Usage</h3>

<pre><code class='language-R'>poly.areas(polys)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Polygon+2B20Areas_+3A_polys">polys</code></td>
<td>
<p>A <code>SpatialPolygons</code> or <code>SpatialPolygonsDataFrame</code> or <code>sf</code> -POLYGON or - MULTIPOLYGON object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of areas of the same length as the number of polygons in <code>polys</code>.
</p>


<h3>Author(s)</h3>

<p>Chris Brunsdon, Binbin Lu</p>


<h3>Examples</h3>

<pre><code class='language-R'># Data for New Haven to use in example
data(newhaven)
# What is the area each census block?
poly.areas(blocks)
</code></pre>

<hr>
<h2 id='Polygon+20Label+20Points'>Number of Points in Each Polygon</h2><span id='topic+poly.labels'></span>

<h3>Description</h3>

<p>Given a set of polygons,  returns the label point for each polygon in a SpatialPoints or a sf POINT object.</p>


<h3>Usage</h3>

<pre><code class='language-R'>poly.labels(polys)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Polygon+2B20Label+2B20Points_+3A_polys">polys</code></td>
<td>
<p>A <code>SpatialPolygons</code> or <code>SpatialPolygonsDataFrame</code>  or <code>sf</code> -POLYGON or - MULTIPOLYGON object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>SpatialPoints or sf POINT object containing the label point for each polygon, respectively.
</p>


<h3>Author(s)</h3>

<p>Chris Brunsdon, Binbin Lu</p>

<hr>
<h2 id='shading'> Shading </h2><span id='topic+shading'></span>

<h3>Description</h3>

<p>Creates an object of class <code>shading</code> by directly specifying break values and (optionally) colours.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shading(breaks, cols = brewer.pal(length(breaks), "Reds"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="shading_+3A_breaks">breaks</code></td>
<td>
<p>The break points</p>
</td></tr>
<tr><td><code id="shading_+3A_cols">cols</code></td>
<td>
<p>The shading colours - there should be one more of these than break points.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>shading</code>.
</p>


<h3>Warning</h3>

<p>At the moment,  the it is assumed that the number of shading colours is one more than the break points,  but this is not checked.</p>


<h3>Author(s)</h3>

<p>Chris Brunsdon</p>


<h3>See Also</h3>

 <p><code><a href="#topic+choropleth">choropleth</a></code>,<code><a href="#topic+choro.legend">choro.legend</a></code> </p>

<hr>
<h2 id='thematic.map'> thematic.map</h2><span id='topic+thematic.map'></span>

<h3>Description</h3>

<p>Draw thematic maps together with histograms with a <code>Spatial</code> or <code>sf</code> object, background layers according to variables and shading schemes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>thematic.map(data, var.names, colorStyle = NULL, na.pos = "bottomright", bglyrs, bgStyle,
                         scaleBar.pos = "bottomright", mtitle = NULL, htitle = NULL,
                         legend = "Legend", legend.pos = "topright", cuts = 5, 
                         cutter = quantileCuts, horiz = FALSE, digits=2,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="thematic.map_+3A_data">data</code></td>
<td>
<p> A <code>Spatial</code> or <code>sf</code> object.</p>
</td></tr>
<tr><td><code id="thematic.map_+3A_var.names">var.names</code></td>
<td>
<p> A vector of variable names to be mapped</p>
</td></tr>
<tr><td><code id="thematic.map_+3A_colorstyle">colorStyle</code></td>
<td>
<p> A vector of colors (including &quot;red&quot;, &quot;blue&quot; and &quot;green&quot;) or a color function, e.g. <code>rainbow</code>, <code>heat.colors</code>, <code>hcl.colors</code>, <code>terrain.colors</code> and <code>colors</code></p>
</td></tr>
<tr><td><code id="thematic.map_+3A_na.pos">na.pos</code></td>
<td>
<p> A 2-D coordinate or character to define the position of north arrow, i.e. &quot;topright&quot;, &quot;topleft&quot;, &quot;bottomright&quot;, &quot;bottomleft&quot;</p>
</td></tr>
<tr><td><code id="thematic.map_+3A_bglyrs">bglyrs</code></td>
<td>
<p> A list of background layers of &quot;Spatial&quot; or &quot;sf&quot; objects</p>
</td></tr>
<tr><td><code id="thematic.map_+3A_bgstyle">bgStyle</code></td>
<td>
<p> A list of parameters for define the styles of background layers, e.g. list(col=&quot;grey&quot;, cex=1, lwd=1, pch=16, lty=1)</p>
</td></tr>
<tr><td><code id="thematic.map_+3A_scalebar.pos">scaleBar.pos</code></td>
<td>
<p> A 2-D coordinate or character to define the position of scale bar, i.e. &quot;topright&quot;, &quot;topleft&quot;, &quot;bottomright&quot;, &quot;bottomleft&quot;</p>
</td></tr>
<tr><td><code id="thematic.map_+3A_mtitle">mtitle</code></td>
<td>
<p> Title of each map</p>
</td></tr>
<tr><td><code id="thematic.map_+3A_htitle">htitle</code></td>
<td>
<p> Title of each histogram</p>
</td></tr>
<tr><td><code id="thematic.map_+3A_legend">legend</code></td>
<td>
<p> Title of each legend for each map</p>
</td></tr>
<tr><td><code id="thematic.map_+3A_legend.pos">legend.pos</code></td>
<td>
<p>  A 2-D coordinate or character to define the position of legend, i.e. &quot;topright&quot;, &quot;topleft&quot;, &quot;bottomright&quot;, &quot;bottomleft&quot;</p>
</td></tr>
<tr><td><code id="thematic.map_+3A_cuts">cuts</code></td>
<td>
<p>The number of classes.</p>
</td></tr>
<tr><td><code id="thematic.map_+3A_cutter">cutter</code></td>
<td>
<p> Function used to create the break points.  Can be user defined or a supplied <a href="#topic+quantileCuts">cut function</a>.</p>
</td></tr>
<tr><td><code id="thematic.map_+3A_horiz">horiz</code></td>
<td>
<p> logical; if TRUE, set the legend horizontally rather than vertically </p>
</td></tr>
<tr><td><code id="thematic.map_+3A_digits">digits</code></td>
<td>
<p> Number of digits kept for legend</p>
</td></tr>
<tr><td><code id="thematic.map_+3A_...">...</code></td>
<td>
<p> Arguments to be passed to methods</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function returns no value,  but draws thematic maps together with histograms on the current graphics device as a side effect.
</p>


<h3>Value</h3>

<p>None (see above).
</p>


<h3>Author(s)</h3>

<p>Binbin Lu</p>


<h3>See Also</h3>

<p><code><a href="#topic+choropleth">choropleth</a></code>, <code><a href="#topic+choro.legend">choro.legend</a></code>, <code><a href="#topic+auto.shading">auto.shading</a></code>, <code><a href="#topic+shading">shading</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(newhaven)
# Single map
thematic.map(blocks, var.names="POP1990", horiz = FALSE, na.pos = "topleft", 
            scaleBar.pos = "bottomright", legend.pos = "bottomleft",
            colorStyle = "red")

#Multiple maps and different colors
thematic.map(blocks, var.names=c("P_35_44","P_25_34", "POP1990"), 
horiz =FALSE, na.pos = "topleft", scaleBar.pos = "bottomright", 

legend.pos = "bottomleft",colorStyle =hcl.colors)
thematic.map(blocks, var.names=c("P_35_44","P_25_34", "POP1990"), 

horiz =FALSE, na.pos = "topleft", scaleBar.pos = "bottomright",
 legend.pos = "bottomleft", colorStyle =c("red", "blue", "na"))
# Use coordinate to define the legend
data(WHData)
thematic.map(whp_sp, var.names="Avg_Green_", colorStyle ="red",
             na.pos = "topleft", scaleBar.pos = "bottomleft", 
             legend.pos = c(544000, 3380000),cuts=7, 
             cutter=rangeCuts)
thematic.map(WHHP, var.names=c("Avg_HP_avg", "Avg_Green_"), colorStyle =c("red", "blue"),
             na.pos = "topleft", scaleBar.pos = "bottomleft", 
             legend.pos = c(544000, 3380000),cuts=7, 
             cutter=rangeCuts)
</code></pre>

<hr>
<h2 id='tornados'>US Tornado Touchdown Data</h2><span id='topic+tornados'></span><span id='topic+torn'></span><span id='topic+torn2'></span>

<h3>Description</h3>

<p> Data set from NOAA's National Weather Service Indianapolis, IN Weather Forecast Office 6900 W. Hanna Ave.</p>


<h3>Usage</h3>

<pre><code class='language-R'> 
data(tornados)</code></pre>


<h3>Format</h3>


<ul>
<li> <p><strong>torn</strong> Tornado Touchdown points <code>SpatialPointsDataFrame</code> - geographical projection 
</p>
</li>
<li> <p><strong>torn2</strong> Tornado Touchdown points <code>SpatialPointsDataFrame </code> - equal area projection 
</p>
</li></ul>



<h3>Source</h3>

 <p><code> http://www.crh.noaa.gov/ind/?n=svrgis </code></p>


<h3>Examples</h3>

<pre><code class='language-R'># Read in the data
data(tornados)
# Split the plot in two
opar &lt;- par(mfrow=c(2,1))
# Plot US states
plot(us_states)
# Add Locations of observation stations
plot(torn,add=TRUE,pch=16,col='red')
# Plot a histogram of year of observation next to this
hist(torn$YEAR)
par(opar)
</code></pre>

<hr>
<h2 id='Unit+20Conversion'> Distance Units Conversion </h2><span id='topic+ft2miles'></span><span id='topic+miles2ft'></span><span id='topic+ft2km'></span><span id='topic+km2ft'></span>

<h3>Description</h3>

<p>Convert between different distance units - all functions take the form <code> xx2yy </code> where <code> xx </code> is the unit to be converted from and <code> yy </code> is the unit to be converted to.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ft2miles(x)
miles2ft(x)
ft2km(x)
km2ft(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Unit+2B20Conversion_+3A_x">x</code></td>
<td>
<p>A quantity in units to be converted from</p>
</td></tr></table>


<h3>Value</h3>

<p>The value of <code>x</code> converted to the new units.  In the example below the conversions are from feet to miles and feet to kilometers  (hence functions are <code>ft2miles</code> and <code>ft2km</code>).
</p>


<h3>Author(s)</h3>

<p>Chris Brunsdon</p>


<h3>Examples</h3>

<pre><code class='language-R'># How many miles is 10,000 feet?
ft2miles(10000)
# How about in kilometers?
ft2km(10000)
</code></pre>

<hr>
<h2 id='vulgaris'>Phenology data for North American lilacs</h2><span id='topic+vulgaris'></span><span id='topic+vulgaris2'></span><span id='topic+us_states'></span><span id='topic+us_states2'></span>

<h3>Description</h3>

<p>Data set from Schwartz, M.D. and J.M. Caprio, 2003, North American First Leaf and First Bloom Lilac Phenology Data, IGBP PAGES/World Data Center for Paleoclimatology 
Data Contribution Series # 2003-078. NOAA/NGDC Paleoclimatology Program, Boulder CO, USA.</p>


<h3>Usage</h3>

<pre><code class='language-R'> data(vulgaris)</code></pre>


<h3>Format</h3>


<ul>
<li> <p><strong>vulgaris</strong> Syringa Vulgaris Observation Stations <code>SpatialPointsDataFrame</code> - geographical projection 
</p>
</li>
<li> <p><strong>vulgaris2</strong> Syringa Vulgaris Observation Stations <code>SpatialPointsDataFrame </code> - equal area projection 
</p>
</li>
<li> <p><strong>us_states</strong> States of US <code>SpatialPolygonsDataFrame </code> - geographical projection 
</p>
</li>
<li> <p><strong>us_states2</strong> States of US <code>SpatialPolygonsDataFrame </code> - equal area projection 
</p>
</li></ul>



<h3>Source</h3>

 <p><code> http://www.ncdc.noaa.gov/paleo/phenology.html </code></p>


<h3>Examples</h3>

<pre><code class='language-R'># Read in the data
data(vulgaris)
# Split the plot in two
opar &lt;- par(mfrow=c(2,1))
# Plot US states
plot(us_states)
# Add Locations of observation stations
plot(vulgaris,add=TRUE,pch=16,col='red')
# Plot a histogram of year of observation next to this
hist(vulgaris$Year)
par(opar)
</code></pre>

<hr>
<h2 id='WHData'>Data sets of Wuhan</h2><span id='topic+WHD'></span><span id='topic+WHHP'></span><span id='topic+WHRD'></span><span id='topic+whp_sp'></span>

<h3>Description</h3>

<p>Four geographic data sets of Wuhan are incoporated in this package</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(WHData)</code></pre>


<h3>Format</h3>


<ul>
<li> <p><strong>WHHP</strong> House price data at the community level of Wuhan in a sf object 
</p>
</li>
<li> <p><strong>WHD</strong> District boundary data of Wuhan 
</p>
</li>
<li> <p><strong>WHRD</strong> Road network data of Wuhan 
</p>
</li>
<li> <p><strong>whp_sp</strong> House price data at the community level of Wuhan in a SpatialPolygonsDataFrame object
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># Read in the data
data(WHData)
choropleth(WHHP,"Avg_HP_avg")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
