<!DOCTYPE html><html lang="en"><head><title>Help for package miLAG</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {miLAG}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#calc_baranyi_fit_lag'><p>calc_baranyi_fit_lag</p></a></li>
<li><a href='#calc_lag'><p>calc_lag</p></a></li>
<li><a href='#calc_lag_fit_to_baranyi_with_lag'><p>calc_lag_fit_to_baranyi_with_lag</p></a></li>
<li><a href='#calc_lag_fit_to_logistic_with_lag'><p>calc_lag_fit_to_logistic_with_lag</p></a></li>
<li><a href='#calc_lagistic_fit_lag'><p>calc_lagistic_fit_lag</p></a></li>
<li><a href='#choose_lag_fit_algorithm_baranyi'><p>choose_lag_fit_algorithm_baranyi</p></a></li>
<li><a href='#choose_lag_fit_algorithm_logistic'><p>choose_lag_fit_algorithm_logistic</p></a></li>
<li><a href='#compare_algorithms'><p>compare_algorithms</p></a></li>
<li><a href='#cut_the_data'><p>cut_the_data</p>
Subsets the data frame containing only the observations up to the specified maximum time</a></li>
<li><a href='#fit_exp_lag'><p>fit_exp_lag</p></a></li>
<li><a href='#fit_exp_lag_to_curve'><p>fit_exp_lag_to_curve</p></a></li>
<li><a href='#fit_max_infl_lag'><p>fit_max_infl_lag</p></a></li>
<li><a href='#get_all_methods_lag'><p>get_all_methods_lag</p></a></li>
<li><a href='#get_def_pars'><p>get_def_pars</p>
Set defaults parameters used by calc_lag function</a></li>
<li><a href='#get_init_pars_baranyi'><p>get_init_pars_baranyi</p></a></li>
<li><a href='#get_init_pars_logistic'><p>get_init_pars_logistic</p></a></li>
<li><a href='#get_lag'><p>get_lag</p></a></li>
<li><a href='#get_n0'><p>get_n0</p></a></li>
<li><a href='#get_theme'><p>get_theme</p></a></li>
<li><a href='#lag_biomass_incr'><p>lag_biomass_incr</p></a></li>
<li><a href='#make_grwoth_curve_df'><p>make_grwoth_curve_df</p></a></li>
<li><a href='#plot_data'><p>plot_data</p></a></li>
<li><a href='#plot_lag_fit'><p>plot_lag_fit</p></a></li>
<li><a href='#smooth_data'><p>smooth_data</p>
Smoothens growth curves data</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Calculates Microbial Lag Duration (on the Population Level) from
Provided Growth Curve Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.5</td>
</tr>
<tr>
<td>Date:</td>
<td>2025-01-17</td>
</tr>
<tr>
<td>Description:</td>
<td>Microbial growth is often measured by growth curves i.e. a table of population sizes and times of measurements. 
  This package allows to use such growth curve data to determine the duration of "microbial lag phase" i.e. the time needed for microbes to restart divisions.
  It implements the most commonly used methods to calculate the lag duration, these methods are discussed and described in Opalek et.al. 2022.
  Citation: Smug, B. J., Opalek, M., Necki, M., &amp; Wloch-Salamon, D. (2024). Microbial lag calculator: A shiny-based application and an R package for calculating the duration of microbial lag phase. Methods in Ecology and Evolution, 15, 301â€“307 &lt;<a href="https://doi.org/10.1111%2F2041-210X.14269">doi:10.1111/2041-210X.14269</a>&gt;. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.3.0), dplyr (&ge; 1.0.8), ggplot2 (&ge; 3.4.1), testthat
(&ge; 3.1.8), minpack.lm (&ge; 1.2.2), nlsMicrobio (&ge; 0.0.3)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-01-17 18:08:19 UTC; bsmug</td>
</tr>
<tr>
<td>Author:</td>
<td>Bogna Smug <a href="https://orcid.org/0000-0001-9364-163X"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Bogna Smug &lt;bogna.smug@uj.edu.pl&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-01-18 00:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='calc_baranyi_fit_lag'>calc_baranyi_fit_lag</h2><span id='topic+calc_baranyi_fit_lag'></span>

<h3>Description</h3>

<p>Calculates lag based on fitting baranyi model to data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_baranyi_fit_lag(
  data,
  n0,
  init_lag = NULL,
  init_gr_rate = NULL,
  algorithm = "auto",
  max_iter = 100
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc_baranyi_fit_lag_+3A_data">data</code></td>
<td>
<p>a data frame with two required columns names: &quot;time&quot; and &quot;biomass&quot;,and one optional column: &quot;curve_id&quot;
This is data from may come from multiple growth curves</p>
</td></tr>
<tr><td><code id="calc_baranyi_fit_lag_+3A_n0">n0</code></td>
<td>
<p>a data frame describing initial biomass for each of the curves, i.e. it has two obligatory columns: &quot;curve_id&quot;, &quot;N0&quot;</p>
</td></tr>
<tr><td><code id="calc_baranyi_fit_lag_+3A_init_lag">init_lag</code></td>
<td>
<p>initial value for the lag parameter, defaults to NULL in which case it will be approximated based on the data</p>
</td></tr>
<tr><td><code id="calc_baranyi_fit_lag_+3A_init_gr_rate">init_gr_rate</code></td>
<td>
<p>initial value for the growth rate, defaults to NULL in which case it will be approximated based on the data</p>
</td></tr>
<tr><td><code id="calc_baranyi_fit_lag_+3A_algorithm">algorithm</code></td>
<td>
<p>eg. &quot;auto&quot;, &quot;Levenberg-Marquardt&quot;, &quot;port&quot;, defaults to &quot;auto&quot;</p>
</td></tr>
<tr><td><code id="calc_baranyi_fit_lag_+3A_max_iter">max_iter</code></td>
<td>
<p>Maximum number of iterations, defaults to 100</p>
</td></tr>
</table>


<h3>Value</h3>

<p>growth curve data with additional columns  ('lag', and predicted biomass 'predicted')
</p>

<hr>
<h2 id='calc_lag'>calc_lag</h2><span id='topic+calc_lag'></span>

<h3>Description</h3>

<p>The main function that calculates lags based on growth curve data, selected method and parameters and returns an extended growth rate data frame (extended by multiple columns with parameters related to lag calculation)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_lag(data, method, pars)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc_lag_+3A_data">data</code></td>
<td>
<p>a data frame with two required columns names: &quot;time&quot; and &quot;biomass&quot;,and one optional column: &quot;curve_id&quot;
This is data from may come from multiple growth curves</p>
</td></tr>
<tr><td><code id="calc_lag_+3A_method">method</code></td>
<td>
<p>method of lag calculation, choose one of the follwoing: &quot;exponential&quot;, &quot;biomass increase&quot;, &quot;max growth acceleration&quot;, &quot;parameter fitting to a model&quot;</p>
</td></tr>
<tr><td><code id="calc_lag_+3A_pars">pars</code></td>
<td>
<p>a list of parameters. Get.default.parameters function can be used to get the default ones. Otherwise create your onwn list with the following names:
- model: if method = &quot;parameter fitting to a model&quot; , one of the following models needs to be chosen: &quot;logistic&quot;, &quot;baranyi&quot;
- n0_method: first.observation&quot; if the first point is taken as the initial biomass or
&quot;minimal.observation&quot; if the minimal biomass is taken is the initial point.
In &quot;healthy&quot; growth curves these options should be equivalent
but sometimes a drop in OD/biomass is observed at the beginning of a growth curve.
In this case it is not obvious what to assume the initial biomass is.
- tangent_method &quot;local.regression&quot; (if the tangent is fitted to a number of points around the maximal growth rate)
or &quot;to.point&quot; (if the tangent is fitted only to the point where the growth rate is maximal); defaults to &quot;to.point&quot;
- threshold: A value of the biomass increase that we can surely associate with the end of the lag phase rather than random variation durinh the lag. Defaults to 10^2
- curve_points: if tangent.method = &quot;local.regression&quot; then curve_points is the number of points the line is fitted to;
defaults to 3 i.e. the point with the maximal uptake rate one point before and one point after
- init_gr_rate: if logistic model is fitted. Defaults to  NULL in which case the initial value will be based on the data
- init_lag: if a logistic model is fitted, Defaults to NULL in which case the initial value will be based on the data
- algorithm: if method = &quot;parameter fitting to a model&quot;, nls algorithm to run the model fit; defaults to &quot;auto&quot; which will choose the best between bounded and unbounded &quot;Levenberg-Marquardt&quot; and bounded &quot;port&quot;
- max_iter =  if method = &quot;parameter fitting to a model&quot;, the maximum number of nls iterations, defaults to  100</p>
</td></tr>
</table>


<h3>Value</h3>

<p>growth curve data (time, biomass, curve_id) with the following additional columns:  log_biomass, lag, line_slope, line_intercept, lag_calc_method, predicted_data, diff, second_deriv_b, tangent_point, threshold
</p>

<hr>
<h2 id='calc_lag_fit_to_baranyi_with_lag'>calc_lag_fit_to_baranyi_with_lag</h2><span id='topic+calc_lag_fit_to_baranyi_with_lag'></span>

<h3>Description</h3>

<p>Runs nlsLM/nls algorithms with three different parameter setups to fit the best Logistic model parameters to our data and chooses the best model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_lag_fit_to_baranyi_with_lag(
  gr_curve,
  LOG10N0 = NULL,
  init_lag = NULL,
  init_mumax = NULL,
  init_LOG10Nmax = NULL,
  algorithm = "auto",
  max_iter = 100,
  lower_bound = c(0, 0, 0, 0)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc_lag_fit_to_baranyi_with_lag_+3A_gr_curve">gr_curve</code></td>
<td>
<p>data from one specific growth curve with these two columns: time and biomass</p>
</td></tr>
<tr><td><code id="calc_lag_fit_to_baranyi_with_lag_+3A_log10n0">LOG10N0</code></td>
<td>
<p>the decimal logarithm of initial biomass</p>
</td></tr>
<tr><td><code id="calc_lag_fit_to_baranyi_with_lag_+3A_init_lag">init_lag</code></td>
<td>
<p>initial value for the lag parameter</p>
</td></tr>
<tr><td><code id="calc_lag_fit_to_baranyi_with_lag_+3A_init_mumax">init_mumax</code></td>
<td>
<p>initial value for the mumax parameter</p>
</td></tr>
<tr><td><code id="calc_lag_fit_to_baranyi_with_lag_+3A_init_log10nmax">init_LOG10Nmax</code></td>
<td>
<p>initial value for the LOG10Nmax parameter</p>
</td></tr>
<tr><td><code id="calc_lag_fit_to_baranyi_with_lag_+3A_algorithm">algorithm</code></td>
<td>
<p>defaults to &quot;auto&quot; which chooses between bounded and unbounded Levenberg-Marquardt method and the bounded port method</p>
</td></tr>
<tr><td><code id="calc_lag_fit_to_baranyi_with_lag_+3A_max_iter">max_iter</code></td>
<td>
<p>max. number of itertaions; defaults to 100</p>
</td></tr>
<tr><td><code id="calc_lag_fit_to_baranyi_with_lag_+3A_lower_bound">lower_bound</code></td>
<td>
<p>lower.bound for the bounded nls optimisation; defaults to 0</p>
</td></tr>
</table>


<h3>Value</h3>

<p>lag and the nls fitting object with parameters fitted to logistic model
</p>

<hr>
<h2 id='calc_lag_fit_to_logistic_with_lag'>calc_lag_fit_to_logistic_with_lag</h2><span id='topic+calc_lag_fit_to_logistic_with_lag'></span>

<h3>Description</h3>

<p>Runs nlsLM/nls algorithm of the user's choice to fit the  Logistic model parameters to our data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_lag_fit_to_logistic_with_lag(
  gr_curve,
  n0,
  init_gr_rate = init_gr_rate,
  init_K = init_K,
  init_lag = init_lag,
  algorithm = "auto",
  max_iter = 100,
  lower_bound = c(0, 0, 0)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc_lag_fit_to_logistic_with_lag_+3A_gr_curve">gr_curve</code></td>
<td>
<p>data from one specific growth curve with these two columns: time and biomass</p>
</td></tr>
<tr><td><code id="calc_lag_fit_to_logistic_with_lag_+3A_n0">n0</code></td>
<td>
<p>the initial biomass</p>
</td></tr>
<tr><td><code id="calc_lag_fit_to_logistic_with_lag_+3A_init_gr_rate">init_gr_rate</code></td>
<td>
<p>initial value for the growth rate</p>
</td></tr>
<tr><td><code id="calc_lag_fit_to_logistic_with_lag_+3A_init_k">init_K</code></td>
<td>
<p>initial value for the saturation parameter K</p>
</td></tr>
<tr><td><code id="calc_lag_fit_to_logistic_with_lag_+3A_init_lag">init_lag</code></td>
<td>
<p>initial value for the lag parameter</p>
</td></tr>
<tr><td><code id="calc_lag_fit_to_logistic_with_lag_+3A_algorithm">algorithm</code></td>
<td>
<p>defaults to &quot;auto&quot; which chooses between bounded and unbounded Levenberg-Marquardt method and the bounded port method</p>
</td></tr>
<tr><td><code id="calc_lag_fit_to_logistic_with_lag_+3A_max_iter">max_iter</code></td>
<td>
<p>max. number of iterations; defaults to 100</p>
</td></tr>
<tr><td><code id="calc_lag_fit_to_logistic_with_lag_+3A_lower_bound">lower_bound</code></td>
<td>
<p>lower bound for the bounded nls optimization; defaults to 0</p>
</td></tr>
</table>


<h3>Value</h3>

<p>lag and the nls fitting object with parameters fitted to logistic model
</p>

<hr>
<h2 id='calc_lagistic_fit_lag'>calc_lagistic_fit_lag</h2><span id='topic+calc_lagistic_fit_lag'></span>

<h3>Description</h3>

<p>Calculates lag based on fitting logistic model to data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_lagistic_fit_lag(
  data,
  n0,
  init_gr_rate = NULL,
  init_K = NULL,
  init_lag = NULL,
  algorithm,
  max_iter,
  return_all_params = FALSE,
  min_b = 0.2,
  min_a = 0.8
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc_lagistic_fit_lag_+3A_data">data</code></td>
<td>
<p>a data frame with two required columns names: &quot;time&quot; and &quot;biomass&quot;,and one optional column: &quot;curve_id&quot;
This is data from may come from multiple growth curves</p>
</td></tr>
<tr><td><code id="calc_lagistic_fit_lag_+3A_n0">n0</code></td>
<td>
<p>a data frame describing initial biomass for each of the curves, i.e. it has two obligatory columns: &quot;curve_id&quot;, &quot;N0&quot;</p>
</td></tr>
<tr><td><code id="calc_lagistic_fit_lag_+3A_init_gr_rate">init_gr_rate</code></td>
<td>
<p>initial value for the growth rate, defaults to NULL in which case it will be approximated based on the data</p>
</td></tr>
<tr><td><code id="calc_lagistic_fit_lag_+3A_init_k">init_K</code></td>
<td>
<p>initial value for the saturation parameter K, defaults to NULL in which case it will be approximated based on the data</p>
</td></tr>
<tr><td><code id="calc_lagistic_fit_lag_+3A_init_lag">init_lag</code></td>
<td>
<p>initial value for the lag parameter, defaults to NULL in which case it will be approximated based on the data</p>
</td></tr>
<tr><td><code id="calc_lagistic_fit_lag_+3A_algorithm">algorithm</code></td>
<td>
<p>eg. &quot;auto&quot;, &quot;Levenberg-Marquardt&quot;, &quot;port&quot;</p>
</td></tr>
<tr><td><code id="calc_lagistic_fit_lag_+3A_max_iter">max_iter</code></td>
<td>
<p>Maximum number of iterations</p>
</td></tr>
<tr><td><code id="calc_lagistic_fit_lag_+3A_return_all_params">return_all_params</code></td>
<td>
<p>defaults to FALSE, TRUE if you also want to get K and growth.rate apart from lag</p>
</td></tr>
<tr><td><code id="calc_lagistic_fit_lag_+3A_min_b">min_b</code></td>
<td>
<p>defaults to 0.2; mina and minb define where to look for exponential phase: it will be where the biomass is between min + (max-min)*(lower.bound.for.gr TO upper.bound.for.gr)</p>
</td></tr>
<tr><td><code id="calc_lagistic_fit_lag_+3A_min_a">min_a</code></td>
<td>
<p>defaults to 0.8</p>
</td></tr>
</table>


<h3>Value</h3>

<p>growth curve data with additional columns  ('lag', and predicted biomass 'predicted'), and the fitting object if return.all.params was set to TRUE
</p>

<hr>
<h2 id='choose_lag_fit_algorithm_baranyi'>choose_lag_fit_algorithm_baranyi</h2><span id='topic+choose_lag_fit_algorithm_baranyi'></span>

<h3>Description</h3>

<p>Runs nlsLM/nls algorithms with three different parameter setups to fit the best Baranyi parameters to our data and chooses the best model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>choose_lag_fit_algorithm_baranyi(
  gr_curve,
  LOG10N0,
  init_lag,
  init_mumax,
  init_LOG10Nmax,
  max_iter,
  lower_bound
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="choose_lag_fit_algorithm_baranyi_+3A_gr_curve">gr_curve</code></td>
<td>
<p>data from one specific growth curve with the following columns: LOG10N, t</p>
</td></tr>
<tr><td><code id="choose_lag_fit_algorithm_baranyi_+3A_log10n0">LOG10N0</code></td>
<td>
<p>init value for the LOG10N0 parameter</p>
</td></tr>
<tr><td><code id="choose_lag_fit_algorithm_baranyi_+3A_init_lag">init_lag</code></td>
<td>
<p>initial value for the lag</p>
</td></tr>
<tr><td><code id="choose_lag_fit_algorithm_baranyi_+3A_init_mumax">init_mumax</code></td>
<td>
<p>initial value for the mumax parameter</p>
</td></tr>
<tr><td><code id="choose_lag_fit_algorithm_baranyi_+3A_init_log10nmax">init_LOG10Nmax</code></td>
<td>
<p>initial value for the LOG10Nmax parameter</p>
</td></tr>
<tr><td><code id="choose_lag_fit_algorithm_baranyi_+3A_max_iter">max_iter</code></td>
<td>
<p>max. number of iterations</p>
</td></tr>
<tr><td><code id="choose_lag_fit_algorithm_baranyi_+3A_lower_bound">lower_bound</code></td>
<td>
<p>lower bound for the bounded nls optimization;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the best nls fitting object with parameters fitted to Baranyi model (lowest Res.Sum Sq provided that all coefficients are nonnegative)
</p>

<hr>
<h2 id='choose_lag_fit_algorithm_logistic'>choose_lag_fit_algorithm_logistic</h2><span id='topic+choose_lag_fit_algorithm_logistic'></span>

<h3>Description</h3>

<p>Runs nlsLM/nls algorithms with three different parameter setups to fit the best Logistic model parameters to our data and chooses the best model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>choose_lag_fit_algorithm_logistic(
  gr_curve,
  n0,
  init_gr_rate = init_gr_rate,
  init_K = init_K,
  init_lag = init_lag,
  max_iter = 100,
  lower_bound = c(0, 0, 0)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="choose_lag_fit_algorithm_logistic_+3A_gr_curve">gr_curve</code></td>
<td>
<p>data from one specific growth curve with the following columns: LOG10N, t</p>
</td></tr>
<tr><td><code id="choose_lag_fit_algorithm_logistic_+3A_n0">n0</code></td>
<td>
<p>the initial biomass</p>
</td></tr>
<tr><td><code id="choose_lag_fit_algorithm_logistic_+3A_init_gr_rate">init_gr_rate</code></td>
<td>
<p>initial value for the growth rate</p>
</td></tr>
<tr><td><code id="choose_lag_fit_algorithm_logistic_+3A_init_k">init_K</code></td>
<td>
<p>initial value for the saturation parameter K</p>
</td></tr>
<tr><td><code id="choose_lag_fit_algorithm_logistic_+3A_init_lag">init_lag</code></td>
<td>
<p>initial value for the lag parameter</p>
</td></tr>
<tr><td><code id="choose_lag_fit_algorithm_logistic_+3A_max_iter">max_iter</code></td>
<td>
<p>max. number of iterations; defaults to 100</p>
</td></tr>
<tr><td><code id="choose_lag_fit_algorithm_logistic_+3A_lower_bound">lower_bound</code></td>
<td>
<p>lower bound for the bounded nls optimization; defaults to 0</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the best nls fitting object with parameters fitted to logistic model (lowest Res.Sum Sq provided that all coefficients are nonnegative)
</p>

<hr>
<h2 id='compare_algorithms'>compare_algorithms</h2><span id='topic+compare_algorithms'></span>

<h3>Description</h3>

<p>Compares results of 3 objects obtained from running nls
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compare_algorithms(nls_LM_no_bound, nls_PORT, nlsres_LM)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compare_algorithms_+3A_nls_lm_no_bound">nls_LM_no_bound</code></td>
<td>
<p>first object resulting from running nls</p>
</td></tr>
<tr><td><code id="compare_algorithms_+3A_nls_port">nls_PORT</code></td>
<td>
<p>second object resulting from running nls</p>
</td></tr>
<tr><td><code id="compare_algorithms_+3A_nlsres_lm">nlsres_LM</code></td>
<td>
<p>third object resulting from running nls</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the best fitting object (lowest Res.Sum Sq provided that all coefficients are nonnegative)
</p>

<hr>
<h2 id='cut_the_data'>cut_the_data
Subsets the data frame containing only the observations up to the specified maximum time</h2><span id='topic+cut_the_data'></span>

<h3>Description</h3>

<p>cut_the_data
Subsets the data frame containing only the observations up to the specified maximum time
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cut_the_data(data, max_time)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cut_the_data_+3A_data">data</code></td>
<td>
<p>a data frame with two required columns names: &quot;time&quot; and &quot;biomass&quot;,and one optional column: &quot;curve_id&quot;
This is data from may come from multiple growth curves</p>
</td></tr>
<tr><td><code id="cut_the_data_+3A_max_time">max_time</code></td>
<td>
<p>max. time at which we want to cut the growth curve data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>cut data
</p>

<hr>
<h2 id='fit_exp_lag'>fit_exp_lag</h2><span id='topic+fit_exp_lag'></span>

<h3>Description</h3>

<p>Fits the lag to multiple growth curves based on the basic tangent method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_exp_lag(data, tangent_method, n0, curve_points = 3)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fit_exp_lag_+3A_data">data</code></td>
<td>
<p>a data frame with two required columns names: &quot;time&quot; and &quot;biomass&quot;,and one optional column: &quot;curve_id&quot;
This is data from may come from multiple growth curves</p>
</td></tr>
<tr><td><code id="fit_exp_lag_+3A_tangent_method">tangent_method</code></td>
<td>
<p>&quot;local.regression&quot; (if the tangent is fitted to a number of points around the maximal growth rate)
or &quot;to.point&quot; (if the tangent is fitted only to the point where the growth rate is maximal); defaults to &quot;to.point&quot;</p>
</td></tr>
<tr><td><code id="fit_exp_lag_+3A_n0">n0</code></td>
<td>
<p>the initial biomass (a tangent line crossing N0 line will determine the lag)</p>
</td></tr>
<tr><td><code id="fit_exp_lag_+3A_curve_points">curve_points</code></td>
<td>
<p>if tangent_method = &quot;local.regression&quot; then curve_points is the number of points the line is fitted to;
defaults to 3 i.e. the point with the maximal uptake rate one point before and one point aftter</p>
</td></tr>
</table>


<h3>Value</h3>

<p>growth curve data (as input) together with additional columns: lag, line.intercept and line.slope
</p>

<hr>
<h2 id='fit_exp_lag_to_curve'>fit_exp_lag_to_curve</h2><span id='topic+fit_exp_lag_to_curve'></span>

<h3>Description</h3>

<p>Fits the lag to one growth curve based on the basic tangent method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_exp_lag_to_curve(data, n0, tangent_method = "to.point", curve_points = 3)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fit_exp_lag_to_curve_+3A_data">data</code></td>
<td>
<p>a data frame with two required columns names: &quot;time&quot; and &quot;biomass&quot;,
This is data from one growth curve only, one (mean) observation per time</p>
</td></tr>
<tr><td><code id="fit_exp_lag_to_curve_+3A_n0">n0</code></td>
<td>
<p>the initial biomass (a tangent line crossing N0 line will determine the lag)</p>
</td></tr>
<tr><td><code id="fit_exp_lag_to_curve_+3A_tangent_method">tangent_method</code></td>
<td>
<p>&quot;local.regression&quot; (if the tangent is fitted to a number of points around the maximal growth rate)
or &quot;to.point&quot; (if the tangent is fitted only to the point where the growth rate is maximal); defaults to &quot;to.point&quot;</p>
</td></tr>
<tr><td><code id="fit_exp_lag_to_curve_+3A_curve_points">curve_points</code></td>
<td>
<p>if tangent_method = &quot;local.regression&quot; then curve_points is the number of points the line is fitted to;
defaults to 3 i.e. the point with the maximal uptake rate one point before and one point after</p>
</td></tr>
</table>


<h3>Value</h3>

<p>line_slope: slope of the tangent line,
line_intercept: intercept of the tangent line,
lag: lag,
tangent_points: i..e a data frame of all points selected for fitting the line
</p>

<hr>
<h2 id='fit_max_infl_lag'>fit_max_infl_lag</h2><span id='topic+fit_max_infl_lag'></span>

<h3>Description</h3>

<p>Fits the lag to multiple growth curves based on the max growth acceleration method
It finds where the second derivative is the largest
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_max_infl_lag(data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fit_max_infl_lag_+3A_data">data</code></td>
<td>
<p>a data frame with two required columns names: &quot;time&quot; and &quot;biomass&quot;,and one optional column: &quot;curve_id&quot;
This is data from may come from multiple growth curves</p>
</td></tr>
</table>


<h3>Value</h3>

<p>growth curve data (as input) together with additional columns: lag, log.biomass, time.diff, time.av, second.deriv.b, biomass.increase
</p>

<hr>
<h2 id='get_all_methods_lag'>get_all_methods_lag</h2><span id='topic+get_all_methods_lag'></span>

<h3>Description</h3>

<p>Runs the main function that calculates lags based on growth curve data based on all possible methods.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_all_methods_lag(data, biomass_incr_threshold, pars = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_all_methods_lag_+3A_data">data</code></td>
<td>
<p>a data frame with two required columns names: &quot;time&quot; and &quot;biomass&quot;,and one optional column: &quot;curve_id&quot;
This is data from may come from multiple growth curves</p>
</td></tr>
<tr><td><code id="get_all_methods_lag_+3A_biomass_incr_threshold">biomass_incr_threshold</code></td>
<td>
<p>A value of the biomass increase that we can surely associate with the end of the lag phase rather than random variation during the lag.
Needs to be set specifically to avoid unconscious use of the value set by default. If set to NULL, the value from pars will be taken</p>
</td></tr>
<tr><td><code id="get_all_methods_lag_+3A_pars">pars</code></td>
<td>
<p>a list of parameters. defaults to the ones set by get_def_pars function. Otherwise create your own list with the following names:
- model: if method = &quot;parameter fitting to a model&quot; , one of the following models needs to be chosen: &quot;logistic&quot;, &quot;baranyi&quot;
- n0_method: first.observation&quot; if the first point is taken as the initial biomass or
&quot;minimal.observation&quot; if the minimal biomass is taken is the initial point.
In &quot;healthy&quot; growth curves these options should be equivalent
but sometimes a drop in OD/biomass is observed at the beginning of a growth curve.
In this case it is not obvious what to assume the initial biomass is.
- tangent.method &quot;local.regression&quot; (if the tangent is fitted to a number of points around the maximal growth rate)
or &quot;to.point&quot; (if the tangent is fitted only to the point where the growth rate is maximal); defaults to &quot;to.point&quot;
- threshold: A value of the biomass increase that we can surely associate with the end of the lag phase rather than random variation during the lag. Defaults to 10^2
- curve_points: if tangent_method = &quot;local.regression&quot; then curve_points is the number of points the line is fitted to;
defaults to 3 i.e. the point with the maximal uptake rate one point before and one point after
- init_growth.rate: if logistic model is fitted. Defaults to  NULL in which case the initial value will be based on the data
- init_lag: if a logistic model is fitted, Defaults to NULL in which case the initial value will be based on the data
- algorithm: if method = &quot;parameter fitting to a model&quot;, nls algorithm to run the model fit; defaults to &quot;auto&quot; which will choose the best between bounded and unbounded &quot;Levenberg-Marquardt&quot; and bounded &quot;port&quot;
- max_iter =  if method = &quot;parameter fitting to a model&quot;, the maximum number of nls iterations, defaults to  100</p>
</td></tr>
</table>


<h3>Value</h3>

<p>growth curve data (time, biomass, curve_id) with the column: lag_calculation_method, and with the following additional columns:  log_biomass, lag, line_slope, line_intercept, lag_calculation_method, predicted_data, diff, second_deriv_b, tangent_point, threshold
Note that each growth curve will appear
</p>

<hr>
<h2 id='get_def_pars'>get_def_pars
Set defaults parameters used by calc_lag function</h2><span id='topic+get_def_pars'></span>

<h3>Description</h3>

<p>get_def_pars
Set defaults parameters used by calc_lag function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_def_pars()
</code></pre>


<h3>Value</h3>

<p>list of parameters
</p>

<hr>
<h2 id='get_init_pars_baranyi'>get_init_pars_baranyi</h2><span id='topic+get_init_pars_baranyi'></span>

<h3>Description</h3>

<p>Finds reasonable approximation for baranyi growth curve parameters (init_mumax, lag) based on the growth curve and some initial values
These approximations will be used as the initial values for the proper optimization algorithm run later.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_init_pars_baranyi(
  data_this_curve,
  this_n0,
  init_lag,
  init_gr_rate,
  min_b = 0.2,
  min_a = 0.8
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_init_pars_baranyi_+3A_data_this_curve">data_this_curve</code></td>
<td>
<p>data from one specific growth curve with these two columns: time and biomass</p>
</td></tr>
<tr><td><code id="get_init_pars_baranyi_+3A_this_n0">this_n0</code></td>
<td>
<p>the initial biomass</p>
</td></tr>
<tr><td><code id="get_init_pars_baranyi_+3A_init_lag">init_lag</code></td>
<td>
<p>initial value for the lag parameter</p>
</td></tr>
<tr><td><code id="get_init_pars_baranyi_+3A_init_gr_rate">init_gr_rate</code></td>
<td>
<p>initial value for the growth rate</p>
</td></tr>
<tr><td><code id="get_init_pars_baranyi_+3A_min_b">min_b</code></td>
<td>
<p>defaults to 0.2; mina and minb define where to look for exponential phase: it will be where the biomass is between min + (max-min)*(mina TO minb)</p>
</td></tr>
<tr><td><code id="get_init_pars_baranyi_+3A_min_a">min_a</code></td>
<td>
<p>defaults to 0.8</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of parameters: init_mumax, init_lag
</p>

<hr>
<h2 id='get_init_pars_logistic'>get_init_pars_logistic</h2><span id='topic+get_init_pars_logistic'></span>

<h3>Description</h3>

<p>Finds reasonable approximation for logistic growth curve parameters (K, lag. growth rate) based on the growth curve and some initial values
These approximations will be used as the initial values for the proper optimization algorithm run later.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_init_pars_logistic(
  data_this_curve,
  this_n0,
  init_K,
  init_lag,
  init_gr_rate,
  min_b = 0.2,
  min_a = 0.8
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_init_pars_logistic_+3A_data_this_curve">data_this_curve</code></td>
<td>
<p>data from one specific growth curve with these two columns: time and biomass</p>
</td></tr>
<tr><td><code id="get_init_pars_logistic_+3A_this_n0">this_n0</code></td>
<td>
<p>the initial biomass</p>
</td></tr>
<tr><td><code id="get_init_pars_logistic_+3A_init_k">init_K</code></td>
<td>
<p>initial value for the saturation parameter K</p>
</td></tr>
<tr><td><code id="get_init_pars_logistic_+3A_init_lag">init_lag</code></td>
<td>
<p>initial value for the lag parameter</p>
</td></tr>
<tr><td><code id="get_init_pars_logistic_+3A_init_gr_rate">init_gr_rate</code></td>
<td>
<p>initial value for the growth rate</p>
</td></tr>
<tr><td><code id="get_init_pars_logistic_+3A_min_b">min_b</code></td>
<td>
<p>defaults to 0.2; mina and minb define where to look for exponential phase: it will be where the biomass is between min + (max-min)*(min_a TO min_b)</p>
</td></tr>
<tr><td><code id="get_init_pars_logistic_+3A_min_a">min_a</code></td>
<td>
<p>defaults to 0.8</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of parameters: init_K, init_lag, init_gr_rate,
</p>

<hr>
<h2 id='get_lag'>get_lag</h2><span id='topic+get_lag'></span>

<h3>Description</h3>

<p>The most basic function that calculates lags based on growth curve data, selected method and parameters.
It uses calc_lag function and strips the results to only get lag parameter for each growth curve id.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_lag(data, method, pars)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_lag_+3A_data">data</code></td>
<td>
<p>a data frame with two required columns names: &quot;time&quot; and &quot;biomass&quot;,and one optional column: &quot;curve_id&quot;
This is data from may come from multiple growth curves</p>
</td></tr>
<tr><td><code id="get_lag_+3A_method">method</code></td>
<td>
<p>method of lag calculation, choose one of the follwoing: &quot;exponential&quot;, &quot;biomass increase&quot;, &quot;max growth acceleration&quot;, &quot;parameter fitting to a model&quot;</p>
</td></tr>
<tr><td><code id="get_lag_+3A_pars">pars</code></td>
<td>
<p>a list of parameters. Get.default.parameters function can be used to get the default ones. Otherwise create your onwn list with the following names:
- model: if method = &quot;parameter fitting to a model&quot; , one of the following models needs to be chosen: &quot;logistic&quot;, &quot;baranyi&quot;
- n0_method: first.observation&quot; if the first point is taken as the initial biomass or
&quot;minimal.observation&quot; if the minimal biomass is taken is the initial point.
In &quot;healthy&quot; growth curves these options should be equivalent
but sometimes a drop in OD/biomass is observed at the beginning of a growth curve.
In this case it is not obvious what to assume the initial biomass is.
- tangent_method &quot;local.regression&quot; (if the tangent is fitted to a number of points around the maximal growth rate)
or &quot;to.point&quot; (if the tangent is fitted only to the point where the growth rate is maximal); defaults to &quot;to.point&quot;
- threshold: A value of the biomass increase that we can surely associate with the end of the lag phase rather than random variation durinh the lag. Defaults to 10^2
- curve_points: if tangent.method = &quot;local.regression&quot; then curve_points is the number of points the line is fitted to;
defaults to 3 i.e. the point with the maximal uptake rate one point before and one point after
- init_gr_rate: if logistic model is fitted. Defaults to  NULL in which case the initial value will be based on the data
- init_lag: if a logistic model is fitted, Defaults to NULL in which case the initial value will be based on the data
- algorithm: if method = &quot;parameter fitting to a model&quot;, nls algorithm to run the model fit; defaults to &quot;auto&quot; which will choose the best between bounded and unbounded &quot;Levenberg-Marquardt&quot; and bounded &quot;port&quot;
- max_iter =  if method = &quot;parameter fitting to a model&quot;, the maximum number of nls iterations, defaults to  100</p>
</td></tr>
</table>


<h3>Value</h3>

<p>lag per each curve_id
</p>

<hr>
<h2 id='get_n0'>get_n0</h2><span id='topic+get_n0'></span>

<h3>Description</h3>

<p>Gets the initial biomass to relate to
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_n0(biomass, n0_method)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_n0_+3A_biomass">biomass</code></td>
<td>
<p>vector of biomass (chronologically ordered as in growth curve)</p>
</td></tr>
<tr><td><code id="get_n0_+3A_n0_method">n0_method</code></td>
<td>
<p>&quot;first.observation&quot; if the first point is taken as the initial biomass or
&quot;minimal.observation&quot; if the minimal biomass is taken is the initial point.
In &quot;healthy&quot; growth curves these options should be equivalent
but sometimes a drop in OD/biomass is observed at the beginning of a growth curve.
In this case it is not obvious what to assume the initial biomass is.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a value of the initial biomass (either the first observation or the minimum value depending on the parameter N0.method)
</p>

<hr>
<h2 id='get_theme'>get_theme</h2><span id='topic+get_theme'></span>

<h3>Description</h3>

<p>This function sets a ggplot theme without grid.
The theme removes the major and minor grid lines, sets a white background with a gray border and adjusts the text size.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_theme(text_size = 12)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_theme_+3A_text_size">text_size</code></td>
<td>
<p>defaults to 12</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a ggplot theme
</p>

<hr>
<h2 id='lag_biomass_incr'>lag_biomass_incr</h2><span id='topic+lag_biomass_incr'></span>

<h3>Description</h3>

<p>Fits the lag to multiple growth curves based on the biomass increase method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lag_biomass_incr(data, threshold, n0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lag_biomass_incr_+3A_data">data</code></td>
<td>
<p>a data frame with two required columns names: &quot;time&quot; and &quot;biomass&quot;,and one optional column: &quot;curve_id&quot;
This is data from may come from multiple growth curves</p>
</td></tr>
<tr><td><code id="lag_biomass_incr_+3A_threshold">threshold</code></td>
<td>
<p>A value of the biomass increase that we can surely associate with the end of the lag phase rather than random variation during the lag</p>
</td></tr>
<tr><td><code id="lag_biomass_incr_+3A_n0">n0</code></td>
<td>
<p>the initial biomass (lag will be defined as the time point where the difference between biomass and N0 reaches a predefined threshold)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>growth curve data (as input) together with additional columns: N0, increase.from.N0, lag
</p>

<hr>
<h2 id='make_grwoth_curve_df'>make_grwoth_curve_df</h2><span id='topic+make_grwoth_curve_df'></span>

<h3>Description</h3>

<p>Create a growth curve data frame that can be later passed to the lag clculation functions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_grwoth_curve_df(time, biomass, curve_id = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="make_grwoth_curve_df_+3A_time">time</code></td>
<td>
<p>numeric vector of times when biomass was measured  (chronologically ordered as in growth curve)</p>
</td></tr>
<tr><td><code id="make_grwoth_curve_df_+3A_biomass">biomass</code></td>
<td>
<p>numeric vector of measured biomass values  (chronologically ordered as in growth curve)</p>
</td></tr>
<tr><td><code id="make_grwoth_curve_df_+3A_curve_id">curve_id</code></td>
<td>
<p>character vector of growth curve identifiers (i.e. if there are multiple measurements done at the same time point, they should have different curve_id)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data frame representing growth curve data
</p>

<hr>
<h2 id='plot_data'>plot_data</h2><span id='topic+plot_data'></span>

<h3>Description</h3>

<p>Plots the provided growth curve (one single growth curve) on logarithmic scale
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_data(data_new, log10_transform = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_data_+3A_data_new">data_new</code></td>
<td>
<p>a data frame with two required columns names: &quot;time&quot; and &quot;biomass&quot;</p>
</td></tr>
<tr><td><code id="plot_data_+3A_log10_transform">log10_transform</code></td>
<td>
<p>if to plot y axis (biomass) on log10 scale</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot object with a growth curve
</p>

<hr>
<h2 id='plot_lag_fit'>plot_lag_fit</h2><span id='topic+plot_lag_fit'></span>

<h3>Description</h3>

<p>Plots the provided growth curve (one single growth curve) together with the calculated lag and and the rationale for lag calculation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_lag_fit(data_new, print_lag_info = TRUE, log10_transform = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_lag_fit_+3A_data_new">data_new</code></td>
<td>
<p>a data frame output by Calculate.Lag function: it needs to have the following columns: &quot;time&quot;, &quot;biomass&quot;, &quot;tangent.point&quot;, &quot;predicted.data&quot;, &quot;threshold&quot;, &quot;N0&quot;, &quot;second.deriv.b&quot;, &quot;line.intercept&quot;, &quot;line.slope&quot;</p>
</td></tr>
<tr><td><code id="plot_lag_fit_+3A_print_lag_info">print_lag_info</code></td>
<td>
<p>if set to &quot;TRUE&quot; prints the lag length on the graph</p>
</td></tr>
<tr><td><code id="plot_lag_fit_+3A_log10_transform">log10_transform</code></td>
<td>
<p>if to plot y axis (biomass) on log10 scale</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot object with a growth curve
</p>

<hr>
<h2 id='smooth_data'>smooth_data
Smoothens growth curves data</h2><span id='topic+smooth_data'></span>

<h3>Description</h3>

<p>smooth_data
Smoothens growth curves data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>smooth_data(data, smooth_kind = "3RS3R")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="smooth_data_+3A_data">data</code></td>
<td>
<p>a data frame with two required columns names: &quot;time&quot; and &quot;biomass&quot;,and one optional column: &quot;curve_id&quot;
This is data from may come from multiple growth curves</p>
</td></tr>
<tr><td><code id="smooth_data_+3A_smooth_kind">smooth_kind</code></td>
<td>
<p>kind used for the smooth functions, defaults to &quot;3RS3R&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>smoothened data
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
