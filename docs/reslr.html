<!DOCTYPE html><html lang="en-US"><head><title>Help for package reslr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {reslr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#+25+26gt+3B+25'><p>Pipe operator</p></a></li>
<li><a href='#cross_val_check'><p>Cross validation check for spline in time, spline in space time and GAM in order to select the most appropriate number of knots when creating basis functions.</p></a></li>
<li><a href='#NAACproxydata'><p>Relative Sea level example dataset</p></a></li>
<li><a href='#plot.reslr_input'><p>Plot raw data with measurement uncertainty.</p></a></li>
<li><a href='#plot.reslr_output'><p>Plotting the results for each statistical model from the <code>reslr_mcmc</code> function.</p></a></li>
<li><a href='#print.reslr_input'><p>Print a reslr output object which is created from the <code>reslr_load</code> function.</p></a></li>
<li><a href='#print.reslr_output'><p>Print a reslr output object which is created by the <code>reslr_mcmc</code> function.</p></a></li>
<li><a href='#reslr_load'><p>Loading in data for the <code>reslr</code> package</p></a></li>
<li><a href='#reslr_mcmc'><p>Run a <code>reslr_input</code> object through the main reslr Markov chain Monte Carlo (MCMC) function using a chosen statistical model</p></a></li>
<li><a href='#summary.reslr_output'><p>Produces summaries and convergence diagnostics for an object created with <code>reslr_mcmc</code>.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Modelling Relative Sea Level Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.1</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/maeveupton/reslr">https://github.com/maeveupton/reslr</a>,
<a href="https://maeveupton.github.io/reslr/">https://maeveupton.github.io/reslr/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/maeveupton/reslr/issues">https://github.com/maeveupton/reslr/issues</a></td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>Description:</td>
<td>The Bayesian modelling of relative sea-level data
    using a comprehensive approach that incorporates
    various statistical models within a unifying framework. 
    Details regarding each statistical models; 
    linear regression (Ashe et al 2019) &lt;<a href="https://doi.org/10.1016%2Fj.quascirev.2018.10.032">doi:10.1016/j.quascirev.2018.10.032</a>&gt;, 
    change point models (Cahill et al 2015) &lt;<a href="https://doi.org/10.1088%2F1748-9326%2F10%2F8%2F084002">doi:10.1088/1748-9326/10/8/084002</a>&gt;, 
    integrated Gaussian process models (Cahill et al 2015) &lt;<a href="https://doi.org/10.1214%2F15-AOAS824">doi:10.1214/15-AOAS824</a>&gt;, 
    temporal splines (Upton et al 2023) &lt;<a href="https://doi.org/10.48550/arXiv.2301.09556">doi:10.48550/arXiv.2301.09556</a>&gt;, 
    spatio-temporal splines (Upton et al 2023) &lt;<a href="https://doi.org/10.48550/arXiv.2301.09556">doi:10.48550/arXiv.2301.09556</a>&gt; and
    generalised additive models (Upton et al 2023) &lt;<a href="https://doi.org/10.48550/arXiv.2301.09556">doi:10.48550/arXiv.2301.09556</a>&gt;.
    This package facilitates data loading, 
    model fitting and result summarisation.
    Notably, it accommodates the inherent measurement errors
    found in relative sea-level data across multiple dimensions,
    allowing for their inclusion in the statistical models.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>data.table, dplyr, fastDummies, fields, geosphere, ggplot2,
magrittr, ncdf4, plyr, posterior, purrr, R2jags, stringr,
tidybayes, tidyr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat, vdiffr</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-06-14 21:35:25 UTC; mupton</td>
</tr>
<tr>
<td>Author:</td>
<td>Maeve Upton <a href="https://orcid.org/0000-0002-3185-7731"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [cph,
    aut, cre],
  Andrew Parnell [aut],
  Niamh Cahill [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Maeve Upton &lt;uptonmaeve010@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-06-15 17:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='+25+26gt+3B+25'>Pipe operator</h2><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>See <code>magrittr::<a href="magrittr.html#topic+pipe">%&gt;%</a></code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lhs %&gt;% rhs
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_lhs">lhs</code></td>
<td>
<p>A value or the magrittr placeholder.</p>
</td></tr>
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_rhs">rhs</code></td>
<td>
<p>A function call using the magrittr semantics.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The result of calling <code>rhs(lhs)</code>.
</p>

<hr>
<h2 id='cross_val_check'>Cross validation check for spline in time, spline in space time and GAM in order to select the most appropriate number of knots when creating basis functions.</h2><span id='topic+cross_val_check'></span>

<h3>Description</h3>

<p>Cross validation check for spline in time, spline in space time and GAM in order to select the most appropriate number of knots when creating basis functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cross_val_check(
  data,
  prediction_grid_res = 50,
  spline_nseg = NULL,
  spline_nseg_t = 20,
  spline_nseg_st = 6,
  n_iterations = 1000,
  n_burnin = 100,
  n_thin = 5,
  n_chains = 2,
  model_type,
  n_fold = 5,
  seed = NULL,
  CI = 0.95
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cross_val_check_+3A_data">data</code></td>
<td>
<p>Raw input data</p>
</td></tr>
<tr><td><code id="cross_val_check_+3A_prediction_grid_res">prediction_grid_res</code></td>
<td>
<p>Resolution of grid. Predictions over every 50 years(default) can vary based on user preference, as larger values will reduce computational run time.</p>
</td></tr>
<tr><td><code id="cross_val_check_+3A_spline_nseg">spline_nseg</code></td>
<td>
<p>This setting is focused on the Noisy Input Spline model. It provides the number of segments used to create basis functions.</p>
</td></tr>
<tr><td><code id="cross_val_check_+3A_spline_nseg_t">spline_nseg_t</code></td>
<td>
<p>This setting is focused on the Noisy Input Generalised Additive Model. It provides the number of segments used to create basis functions.</p>
</td></tr>
<tr><td><code id="cross_val_check_+3A_spline_nseg_st">spline_nseg_st</code></td>
<td>
<p>This setting is focused on the Noisy Input Generalised Additive Model. It provides the number of segments used to create basis functions.</p>
</td></tr>
<tr><td><code id="cross_val_check_+3A_n_iterations">n_iterations</code></td>
<td>
<p>Number of iterations. Increasing this value will increase the computational run time.</p>
</td></tr>
<tr><td><code id="cross_val_check_+3A_n_burnin">n_burnin</code></td>
<td>
<p>Size of burn-in. This number removes a certain number of samples at the beginning.</p>
</td></tr>
<tr><td><code id="cross_val_check_+3A_n_thin">n_thin</code></td>
<td>
<p>Amount of thinning.</p>
</td></tr>
<tr><td><code id="cross_val_check_+3A_n_chains">n_chains</code></td>
<td>
<p>Number of MCMC chains. The number of times the model will be run.</p>
</td></tr>
<tr><td><code id="cross_val_check_+3A_model_type">model_type</code></td>
<td>
<p>The user selects their statistical model type. The user can select a Noisy Input Spline in Time using &quot;ni_spline_t&quot;. The user can select a Noisy Input Spline in Space Time using &quot;ni_spline_st&quot;. The user can select a Noisy Input Generalised Additive Model using &quot;ni_gam_decomp&quot;.</p>
</td></tr>
<tr><td><code id="cross_val_check_+3A_n_fold">n_fold</code></td>
<td>
<p>Number of folds required in the cross validation. The default is 5 fold cross validation.</p>
</td></tr>
<tr><td><code id="cross_val_check_+3A_seed">seed</code></td>
<td>
<p>If the user wants reproducible results, seed stores the output when random selection was used in the creation of the cross validation.</p>
</td></tr>
<tr><td><code id="cross_val_check_+3A_ci">CI</code></td>
<td>
<p>Size of the credible interval required by the user. The default is 0.95 corresponding to 95%.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the model comparison measures, e.g. Root Mean Square Error (RMSE), and plot of true vs predicted values
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data &lt;- NAACproxydata %&gt;% dplyr::filter(Site == "Cedar Island")
cross_val_check(data = data, model_type = "ni_spline_t",n_fold = 2)

</code></pre>

<hr>
<h2 id='NAACproxydata'>Relative Sea level example dataset</h2><span id='topic+NAACproxydata'></span>

<h3>Description</h3>

<p>An example dataset for 22 proxy sites along the Atlantic coast of North America
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NAACproxydata
</code></pre>


<h3>Format</h3>

<p>A data frame with 1715 rows and 8 columns:
</p>

<dl>
<dt>Region</dt><dd><p>All regions along Atlantic coast of North America</p>
</dd>
<dt>Site</dt><dd><p>All sites along Atlantic coast of North America</p>
</dd>
<dt>Latitude</dt><dd><p>Latitude of the data site</p>
</dd>
<dt>Longitude</dt><dd><p>Longitude of the data site</p>
</dd>
<dt>RSL</dt><dd><p>Relative Sea level in meters</p>
</dd>
<dt>RSL_err</dt><dd><p>Error in RSL</p>
</dd>
<dt>Age</dt><dd><p>Age in years CE</p>
</dd>
<dt>Age_err</dt><dd><p>Error in Age</p>
</dd>
</dl>



<h3>Source</h3>

<p>Check out the vignettes to see the sources
</p>

<hr>
<h2 id='plot.reslr_input'>Plot raw data with measurement uncertainty.</h2><span id='topic+plot.reslr_input'></span>

<h3>Description</h3>

<p>In this function, the raw data is plotted with grey uncertainty boxes representing the uncertainty associated with the input and the output.
The function allows the user to plot the proxy record data and tide gauge data together or separately.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'reslr_input'
plot(
  x,
  title = "",
  xlab = "Year (CE)",
  ylab = "Relative Sea Level (m)",
  plot_tide_gauges = FALSE,
  plot_proxy_records = TRUE,
  plot_caption = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.reslr_input_+3A_x">x</code></td>
<td>
<p>An object created via the function <code><a href="#topic+reslr_load">reslr_load</a></code></p>
</td></tr>
<tr><td><code id="plot.reslr_input_+3A_title">title</code></td>
<td>
<p>Title of the plot</p>
</td></tr>
<tr><td><code id="plot.reslr_input_+3A_xlab">xlab</code></td>
<td>
<p>Labeling the x-axis</p>
</td></tr>
<tr><td><code id="plot.reslr_input_+3A_ylab">ylab</code></td>
<td>
<p>Labeling the y-axis</p>
</td></tr>
<tr><td><code id="plot.reslr_input_+3A_plot_tide_gauges">plot_tide_gauges</code></td>
<td>
<p>Plotting the tide gauge data with the proxy records</p>
</td></tr>
<tr><td><code id="plot.reslr_input_+3A_plot_proxy_records">plot_proxy_records</code></td>
<td>
<p>Plotting the proxy records on their own and this is the default</p>
</td></tr>
<tr><td><code id="plot.reslr_input_+3A_plot_caption">plot_caption</code></td>
<td>
<p>Plotting an informed caption with the number of tide gauges and proxy sites.</p>
</td></tr>
<tr><td><code id="plot.reslr_input_+3A_...">...</code></td>
<td>
<p>Not used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Plot of the raw data with the measurement uncertainty.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
full_dataset &lt;- reslr_load(NAACproxydata)
plot(full_dataset)
</code></pre>

<hr>
<h2 id='plot.reslr_output'>Plotting the results for each statistical model from the <code>reslr_mcmc</code> function.</h2><span id='topic+plot.reslr_output'></span>

<h3>Description</h3>

<p>Depending on the model chosen in the <code>reslr_mcmc</code> function, the package produces a range of output plots.
Total posterior model fit plot with the raw data and measurement uncertainty are created for each statistical model.
The rate of change plots are created for the EIV IGP and the NI spline regression models.
For the NI GAM decomposition, each individual component of the model is plotted. Also, the regional and the non-linear local component, an associated rate plot is produced.
If tide gauges are used in the model, the user has the ability plot the output with or without this additional data source.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'reslr_output'
plot(
  x,
  plot_proxy_records = TRUE,
  plot_tide_gauges = FALSE,
  title = "",
  plot_type = c("model_fit_plot"),
  plot_caption = TRUE,
  xlab = "Year (CE)",
  ylab = "Relative Sea Level (m)",
  y_rate_lab = "Rate of change (mm per year)",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.reslr_output_+3A_x">x</code></td>
<td>
<p>An object of class <code>reslr_output</code> and <code>model_type</code> created via <code><a href="#topic+reslr_mcmc">reslr_mcmc</a></code></p>
</td></tr>
<tr><td><code id="plot.reslr_output_+3A_plot_proxy_records">plot_proxy_records</code></td>
<td>
<p>Plotting the proxy records on their own and this is the default</p>
</td></tr>
<tr><td><code id="plot.reslr_output_+3A_plot_tide_gauges">plot_tide_gauges</code></td>
<td>
<p>Plotting the tide gauge data as well as proxy data</p>
</td></tr>
<tr><td><code id="plot.reslr_output_+3A_title">title</code></td>
<td>
<p>Plotting a title on the output plots</p>
</td></tr>
<tr><td><code id="plot.reslr_output_+3A_plot_type">plot_type</code></td>
<td>
<p>The user can select the type of output plot they require from the following: &quot;rate_plot&quot;, &quot;model_fit_plot&quot;, &quot;regional_plot&quot;, &quot;regional_rate_plot&quot;, &quot;linear_local_plot&quot;, &quot;non_linear_local_plot&quot;, &quot;non_linear_local_rate_plot&quot;, &quot;nigam_component_plot&quot;</p>
</td></tr>
<tr><td><code id="plot.reslr_output_+3A_plot_caption">plot_caption</code></td>
<td>
<p>Plotting an informed caption with the number of tide gauges and proxy sites.</p>
</td></tr>
<tr><td><code id="plot.reslr_output_+3A_xlab">xlab</code></td>
<td>
<p>Labeling the x-axis</p>
</td></tr>
<tr><td><code id="plot.reslr_output_+3A_ylab">ylab</code></td>
<td>
<p>Labeling the y-axis</p>
</td></tr>
<tr><td><code id="plot.reslr_output_+3A_y_rate_lab">y_rate_lab</code></td>
<td>
<p>Labeling the y-axis for rate of change plots</p>
</td></tr>
<tr><td><code id="plot.reslr_output_+3A_...">...</code></td>
<td>
<p>Not used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Plot of model fit and the rate of change depending on the statistical model in question.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data &lt;- NAACproxydata %&gt;% dplyr::filter(Site == "Cedar Island")
x &lt;- reslr_load(data = data)
jags_output &lt;- reslr_mcmc(x, model_type = "eiv_slr_t")
plot(x = jags_output)
</code></pre>

<hr>
<h2 id='print.reslr_input'>Print a reslr output object which is created from the <code>reslr_load</code> function.</h2><span id='topic+print.reslr_input'></span>

<h3>Description</h3>

<p>In this function, the reslr input object is printed. This is a high-level summary which provides the number of observations and the number of sites utilised in the dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'reslr_input'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.reslr_input_+3A_x">x</code></td>
<td>
<p>An object of class <code>reslr_input</code></p>
</td></tr>
<tr><td><code id="print.reslr_input_+3A_...">...</code></td>
<td>
<p>Other arguments (not supported)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A neat presentation of your input reslr object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- NAACproxydata %&gt;% dplyr::filter(Site == "Cedar Island")
reslr_input &lt;- reslr_load(data = data)
print(x = reslr_input)
</code></pre>

<hr>
<h2 id='print.reslr_output'>Print a reslr output object which is created by the <code>reslr_mcmc</code> function.</h2><span id='topic+print.reslr_output'></span>

<h3>Description</h3>

<p>This will be very high level printing that the user can use to obtain information about the MCMC run using JAGS. The number of iterations and chains used by the user is printed
In addition, the type of statistical model is printed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'reslr_output'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.reslr_output_+3A_x">x</code></td>
<td>
<p>An object of class <code>reslr_output</code></p>
</td></tr>
<tr><td><code id="print.reslr_output_+3A_...">...</code></td>
<td>
<p>Other arguments (not supported)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns high level information about the reslr_output object, i.e. the number of iterations and chains used.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data &lt;- NAACproxydata %&gt;% dplyr::filter(Site == "Cedar Island")
input_data &lt;- reslr_load(data = data)
jags_output &lt;- reslr_mcmc(input_data = input_data, model_type = "eiv_slr_t")
print(x = jags_output)

</code></pre>

<hr>
<h2 id='reslr_load'>Loading in data for the <code>reslr</code> package</h2><span id='topic+reslr_load'></span>

<h3>Description</h3>

<p>In this function, the data provided by the user is loaded into the package.
The prerequisites of the input data structure has been given in the vignettes.
The user can choose to include data from tide gauges which is sourced from the Permanent Service for Mean Sea Level (PSMSL) online database.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reslr_load(
  data,
  prediction_grid_res = 50,
  include_tide_gauge = FALSE,
  include_linear_rate = FALSE,
  list_preferred_TGs = NULL,
  TG_minimum_dist_proxy = FALSE,
  all_TG_1deg = FALSE,
  input_age_type = "CE",
  sediment_average_TG = 10,
  detrend_data = FALSE,
  core_col_year = NULL,
  cross_val = FALSE,
  test_set
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="reslr_load_+3A_data">data</code></td>
<td>
<p>The input data as a dataframe.</p>
</td></tr>
<tr><td><code id="reslr_load_+3A_prediction_grid_res">prediction_grid_res</code></td>
<td>
<p>Resolution of grid. Predictions over every 50 years(default) can vary based on user preference, as larger values will reduce computational run time.</p>
</td></tr>
<tr><td><code id="reslr_load_+3A_include_tide_gauge">include_tide_gauge</code></td>
<td>
<p>Including tide gauge data from PSMSL website. The tide gauge data undergo a cleaning process in this function where flagged stations are removed as recommended by the online database. Next, the tide gauge data is averaged over period defined by sediment_average_TG which default is 10 years corresponding to accumulation rates of proxy records. Then, the user selects their preferred tide gauge based on three criteria: 1.nearest tide gauge to the proxy site; 2. User supplies a list of names of preferred tide gauges; 3. all tide gauges within 1 degree are chosen.</p>
</td></tr>
<tr><td><code id="reslr_load_+3A_include_linear_rate">include_linear_rate</code></td>
<td>
<p>User decides to include linear_rate and linear_rate_err associated. This relates to linear rate which corresponds to an important physical process that impacts sea level observations which is glacial isostatic adjustment (GIA). For the linear_rate and its associated linear_rate_err, the user can provide these values as additional columns in the input dataframe. If they prefer, the package will calculate the linear_rate and the linear_rate_err using the data.</p>
</td></tr>
<tr><td><code id="reslr_load_+3A_list_preferred_tgs">list_preferred_TGs</code></td>
<td>
<p>The user can supply the name or names of the preferred tide gauges from the PSMSL database.</p>
</td></tr>
<tr><td><code id="reslr_load_+3A_tg_minimum_dist_proxy">TG_minimum_dist_proxy</code></td>
<td>
<p>The package finds the tide gauge closest to the proxy site</p>
</td></tr>
<tr><td><code id="reslr_load_+3A_all_tg_1deg">all_TG_1deg</code></td>
<td>
<p>The package finds all tide gauges within 1 degree of the proxy site</p>
</td></tr>
<tr><td><code id="reslr_load_+3A_input_age_type">input_age_type</code></td>
<td>
<p>The inputted age in years &quot;CE&quot; or year &quot;BP&quot;. The default is &quot;CE&quot; and is the preferred structure of the package. The package has the ability to use Before Present (&quot;BP&quot;) observations.</p>
</td></tr>
<tr><td><code id="reslr_load_+3A_sediment_average_tg">sediment_average_TG</code></td>
<td>
<p>Average the tide gauge data to make it comparable to accumulation rates of proxy records. The default averaging period for tide gauges is 10 years and the user can alter this.</p>
</td></tr>
<tr><td><code id="reslr_load_+3A_detrend_data">detrend_data</code></td>
<td>
<p>Detrend the data using the linear rate provided to remove this component.</p>
</td></tr>
<tr><td><code id="reslr_load_+3A_core_col_year">core_col_year</code></td>
<td>
<p>The year the sediment core was collected in order to the data to be detrended.</p>
</td></tr>
<tr><td><code id="reslr_load_+3A_cross_val">cross_val</code></td>
<td>
<p>For the spline in time, spline in space time and the NIGAM the user can undertake cross validation to examine the</p>
</td></tr>
<tr><td><code id="reslr_load_+3A_test_set">test_set</code></td>
<td>
<p>The test set dataframe for cross validation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing data frame of data and prediction grid. The output of this function is two data frames, one with the data and one with the data_grid which represent a grid with evenly spaced time points. If tide gauge data is used, an ID column is included in the two output dataframes displaying the data source, &quot;ProxyRecord&quot; or &quot;TideGaugeData&quot;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data &lt;- NAACproxydata %&gt;% dplyr::filter(Site == "Cedar Island")
reslr_load(data = data)
</code></pre>

<hr>
<h2 id='reslr_mcmc'>Run a <code>reslr_input</code> object through the main reslr Markov chain Monte Carlo (MCMC) function using a chosen statistical model</h2><span id='topic+reslr_mcmc'></span>

<h3>Description</h3>

<p>In this function, a variety of statistical models can be run depending on the requirements of the user. All models are written within a Bayesian framework and use JAGS (Just Another Gibbs Sampler) to calculate Markov Chain Monte Carlo (MCMC) simulation to obtain estimates of unknown parameters. The user has the ability to alter the number of iterations, the number of burnin, the number of chains and the thinning. These options relate to the amount of MCMC simulations required and should be reviewed by the user to ensure model convergence is achieved without excessively long run times.
The user chooses their 'model_type' and as a range of models to choose from.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reslr_mcmc(
  input_data,
  model_type,
  n_cp = 1,
  igp_smooth = 0.2,
  n_iterations = 5000,
  n_burnin = 1000,
  n_thin = 4,
  n_chains = 3,
  CI = 0.95,
  spline_nseg = NULL,
  spline_nseg_t = 20,
  spline_nseg_st = 6
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="reslr_mcmc_+3A_input_data">input_data</code></td>
<td>
<p>Input data from the <code>reslr_load</code> function</p>
</td></tr>
<tr><td><code id="reslr_mcmc_+3A_model_type">model_type</code></td>
<td>
<p>The user selects their statistical model type. The user can select a Errors in Variable Simple Linear Regression using &quot;eiv_slr_t&quot;. The user can select a Errors in Variable Change Point Regression using  &quot;eiv_cp_t&quot;. The user can select a Errors in Variable Integrated Gaussian Process using &quot;eiv_igp_t&quot;. The user can select a Noisy Input Spline in Time using &quot;ni_spline_t&quot;. The user can select a Noisy Input Spline in Space Time using &quot;ni_spline_st&quot;. The user can select a Noisy Input Generalised Additive Model using &quot;ni_gam_decomp&quot;.</p>
</td></tr>
<tr><td><code id="reslr_mcmc_+3A_n_cp">n_cp</code></td>
<td>
<p>This setting is focused on the Errors in Variables Change Point model. The user can select the number of change points 1,2 or 3.</p>
</td></tr>
<tr><td><code id="reslr_mcmc_+3A_igp_smooth">igp_smooth</code></td>
<td>
<p>This setting is focused on the Errors in Variables Integrated Gaussian Process model. It informs the prior for the smoothness (correlation) parameter if model = &quot;igp&quot; is chosen. Choose a value between 0 and 1. Closer to 1 will increase smoothness.</p>
</td></tr>
<tr><td><code id="reslr_mcmc_+3A_n_iterations">n_iterations</code></td>
<td>
<p>Number of iterations. Increasing this value will increase the computational run time.</p>
</td></tr>
<tr><td><code id="reslr_mcmc_+3A_n_burnin">n_burnin</code></td>
<td>
<p>Size of burn-in. This number removes a certain number of samples at the beginning.</p>
</td></tr>
<tr><td><code id="reslr_mcmc_+3A_n_thin">n_thin</code></td>
<td>
<p>Amount of thinning.</p>
</td></tr>
<tr><td><code id="reslr_mcmc_+3A_n_chains">n_chains</code></td>
<td>
<p>Number of MCMC chains. The number of times the model will be run.</p>
</td></tr>
<tr><td><code id="reslr_mcmc_+3A_ci">CI</code></td>
<td>
<p>Size of the credible interval required by the user. The default is 0.95 corresponding to 95%.</p>
</td></tr>
<tr><td><code id="reslr_mcmc_+3A_spline_nseg">spline_nseg</code></td>
<td>
<p>This setting is focused on the Noisy Input Spline model. It provides the number of segments used to create basis functions.</p>
</td></tr>
<tr><td><code id="reslr_mcmc_+3A_spline_nseg_t">spline_nseg_t</code></td>
<td>
<p>This setting is focused on the Noisy Input Generalised Additive Model. It provides the number of segments used to create basis functions.</p>
</td></tr>
<tr><td><code id="reslr_mcmc_+3A_spline_nseg_st">spline_nseg_st</code></td>
<td>
<p>This setting is focused on the Noisy Input Generalised Additive Model. It provides the number of segments used to create basis functions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the input data, the JAGS output and output dataframes used for final plots.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data &lt;- NAACproxydata %&gt;% dplyr::filter(Site == "Cedar Island")
input_data &lt;- reslr_load(data = data)
reslr_mcmc(input_data = input_data, model_type = "eiv_slr_t")
</code></pre>

<hr>
<h2 id='summary.reslr_output'>Produces summaries and convergence diagnostics for an object created with <code><a href="#topic+reslr_mcmc">reslr_mcmc</a></code>.</h2><span id='topic+summary.reslr_output'></span>

<h3>Description</h3>

<p>A warning message will appear if the model has not been converge. If this appears the user is recommended to re-run the model and alter the <code>reslr_mcmc</code> function default iteration and MCMC settings. Also, it provides high-level summaries of the estimated parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'reslr_output'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.reslr_output_+3A_object">object</code></td>
<td>
<p>Output object from the <code><a href="#topic+reslr_mcmc">reslr_mcmc</a></code></p>
</td></tr>
<tr><td><code id="summary.reslr_output_+3A_...">...</code></td>
<td>
<p>Not in use</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing convergence diagnostics and parameter estimates for the output.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data &lt;- NAACproxydata %&gt;% dplyr::filter(Site == "Cedar Island")
input_data &lt;- reslr_load(data = data)
jags_output &lt;- reslr_mcmc(input_data = input_data, model_type = "eiv_slr_t")
summary(object = jags_output)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
