<!DOCTYPE html><html lang="en"><head><title>Help for package soilphysics</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {soilphysics}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#soilphysics-package'><p> Soil Physical Analysis</p></a></li>
<li><a href='#aggreg.stability'><p> Soil Aggregate-Size Distribution</p></a></li>
<li><a href='#aggreg.stability_App'><p>A shiny for Soil Aggregate-Size Distribution</p></a></li>
<li><a href='#bulkDensity'><p> Soil Bulk Density Data Set</p></a></li>
<li><a href='#compaction'><p> Soil Compaction Data Set</p></a></li>
<li><a href='#compressive_properties'><p>Estimation of compressive properties by Defossez et al. (2003)</p></a></li>
<li><a href='#compressive_properties2'><p> Estimation of compressive properties by Keller and Arvidsson (2007)</p></a></li>
<li><a href='#compressive_properties3'><p>Estimation of compressive properties by de Lima et al. (2018)</p></a></li>
<li><a href='#compressive_properties4'><p> Estimation of compressive properties by de Lima et al. (2020)</p></a></li>
<li><a href='#compressive_properties5'><p>Estimation of compressive properties by O'Sullivan et al. (1999)</p></a></li>
<li><a href='#criticalmoisture'><p> Critical Moisture and Maximum Bulk Density</p></a></li>
<li><a href='#fitbusscher'><p> Self-starting Nls Busscher's (1990) Model for Soil Penetration Resistance</p></a></li>
<li><a href='#fitlbc'><p> Parameter Estimation of the Load Bearing Capacity Model</p></a></li>
<li><a href='#fitsoilwater'><p> Interactive Estimation of van Genuchten's (1980) Model Parameters</p></a></li>
<li><a href='#fitsoilwater_App'><p>A shiny for fitting soil water retention curves</p></a></li>
<li><a href='#fitsoilwater2'><p> Interactive Estimation of the Groenevelt and Grant (2004) Model Parameters</p></a></li>
<li><a href='#fitsoilwater3'><p> Interactive Estimation of the Dexter's (2008) Model Parameters</p></a></li>
<li><a href='#fitsoilwater4'><p> Self-starting Nls Power Models for Soil Water Retention</p></a></li>
<li><a href='#fitsoilwater5'><p> Interactive Estimation of the Modified van Genuchten's Model Parameters</p></a></li>
<li><a href='#fun2form'><p> Converting Function to Formula</p></a></li>
<li><a href='#getInitiallbc'><p> Get Initial Parameter Estimates for the Load Bearing Capacity Model</p></a></li>
<li><a href='#hemc'><p> High-Energy-Moisture-Characteristics Aggregate Stability</p></a></li>
<li><a href='#hydraulicCutOff'><p>The matric potential at the point of hydraulic cut-off obtained from DE (Dexter et al., 2008) and GG (Groenevelt &amp; Grant, 2004) water retention curves.</p></a></li>
<li><a href='#hydraulicCutOff2'><p>The matric potential at the point of hydraulic cut-off using the point of maximum curvature of DE (Dexter et al. 2008) water retention curve.</p></a></li>
<li><a href='#iwc'><p> Integral Water Capacity (IWC)</p></a></li>
<li><a href='#Kr_h'><p> Unsaturated Hydraulic Conductivity</p></a></li>
<li><a href='#Kr_theta'><p> Unsaturated Hydraulic Conductivity as a function of water content</p></a></li>
<li><a href='#liquidlimit'><p> Soil Liquid Limit</p></a></li>
<li><a href='#llwr'><p>Least Limiting Water Range (LLWR)</p></a></li>
<li><a href='#LLWR_App'><p>A shiny for calculation of the usual least limiting water range</p></a></li>
<li><a href='#llwr_llmpr'><p> Least Limiting Water (LLWR) and Matric Potential Ranges (LLMPR)</p></a></li>
<li><a href='#LLWR_LLMPR_App'><p>A shiny for calculation of least limiting water and matric potential ranges of agricultural soils with calculated physical restriction thresholds</p></a></li>
<li><a href='#llwrPTF'><p> Least Limiting Water Range (LLWR) Using Pedo-Transfer Functions</p></a></li>
<li><a href='#maxcurv'><p> Maximum Curvature Point</p></a></li>
<li><a href='#particle.sedimentation'><p> Sedimentation time of soil particles in aqueous media</p></a></li>
<li><a href='#particle.sedimentation_App'><p>A shiny for time of particle sedimentation</p></a></li>
<li><a href='#plotCIsigmaP'><p> Percentile Confidence Intervals for Simulated Preconsolidation Stress</p></a></li>
<li><a href='#PredComp'><p>A shiny for simulation of soil compaction</p></a></li>
<li><a href='#psd'><p> Soil Pore Size Distribution</p></a></li>
<li><a href='#r'><p> Equation of capillary</p></a></li>
<li><a href='#r_App'><p>A shiny for equation of capillarity</p></a></li>
<li><a href='#Rsq'><p> Multiple R-squared</p></a></li>
<li><a href='#sigmaP'><p> Preconsolidation Stress</p></a></li>
<li><a href='#simSigmaP'><p> Simulating Preconsolidation Stress</p></a></li>
<li><a href='#Sindex'><p> The S Index</p></a></li>
<li><a href='#skp1994'><p>LLWR Data Set</p></a></li>
<li><a href='#SoilAggregate'><p>Soil Aggregate Size Data Set</p></a></li>
<li><a href='#soilDeformation'><p> Soil deformation by O'Sullivan and Robertson (1996)</p></a></li>
<li><a href='#soilStrength'><p>Estimation of precompression stress by Severiano et al. (2013)</p></a></li>
<li><a href='#soilStrength2'><p> Estimation of precompression stress by Schjonning and Lamande (2018)</p></a></li>
<li><a href='#soilStrength3'><p> Estimation of precompression stress by Saffih-Hdadi et al. (2009)</p></a></li>
<li><a href='#soilStrength4'><p>Estimation of precompression stress by Lebert and Horn (1991)</p></a></li>
<li><a href='#soilStrength5'><p> Estimation of precompression stress by Imhoff et al. (2004)</p></a></li>
<li><a href='#soilwater'><p> Soil Water Retention, based on the van Genuchten's (1980) formula</p></a></li>
<li><a href='#soilwater2'><p> Soil Water Retention, based on the Groenevelt &amp; Grant (2004) formula</p></a></li>
<li><a href='#soilwater3'><p> Soil Water Retention, based on the Dexter's (2008) formula</p></a></li>
<li><a href='#soilwater4'><p> Soil Water Retention, based on Power Models</p></a></li>
<li><a href='#soilwater5'><p> Soil Water Retention, based on the modified van Genuchten's formula</p></a></li>
<li><a href='#SSlbc'><p> Self-Starting Nls Load Bearing Capacity Model</p></a></li>
<li><a href='#stressTraffic'>
<p>Predicting Soil Stress Due to Agricultural Trafficability</p></a></li>
<li><a href='#voidratio'><p> Void Ratio</p></a></li>
<li><a href='#WRC_App'><p>A shiny to automatically fit the water retention curve</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Soil Physical Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>5.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-06-06</td>
</tr>
<tr>
<td>Description:</td>
<td>Basic and model-based soil physical analyses.</td>
</tr>
<tr>
<td>Author:</td>
<td>Anderson Rodrigo da Silva
    <a href="https://orcid.org/0000-0003-2518-542X"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  Renato Paiva de Lima
    <a href="https://orcid.org/0000-0003-0524-439X"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Anderson Rodrigo da Silva &lt;anderson.agro@hotmail.com&gt;</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://arsilva87.github.io/soilphysics/">https://arsilva87.github.io/soilphysics/</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>utils, stats, graphics, boot, grDevices, datasets, MASS,
shiny, rhandsontable, shinydashboard, fields</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, rpanel, tcltk</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-06-07 15:25:34 UTC; User</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-06-07 16:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='soilphysics-package'> Soil Physical Analysis </h2><span id='topic+soilphysics-package'></span><span id='topic+soilphysics'></span>

<h3>Description</h3>

<p>Basic and model-based soil physical analyses. 
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> soilphysics</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 5.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2022-06-06</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Functions for modelling the load bearing capacity and the penetration resistance, and for predicting the 
stress applied by agricultural machines in the soil profile. The package allows one to model the soil water 
retention through six different models. There are some useful and easy-to-use functions to perform parameter 
estimation of these models. Methods to obtain the preconsolidation stress are available, such as the standard 
of Casagrande (1936) and so on. It is possible to quantify soil water availability for plants through the Least Limiting Water Range 
approach as well as the Integral Water Capacity. Moreover, it is possible to determine the water suction 
at the point of hydraulic cut-off. Also, users can deal with the high-energy-moisture-characteristics 
(HEMC) methodology proposed by Pierson and Mulla (1989), which is used to analyze the aggregate stability. 
There is a function to determine the soil critical moisture and the maximum bulk density for one or more 
samples, based on the Proctor (1933) compaction test. Other utilities like a function to calculate the 
soil liquid limit, the void ratio and to determine the maximum curvature point are available.
</p>


<h3>Note</h3>

<p><em>soilphysics</em> is an ongoing project.
We welcome any and all criticism, comments and suggestions.
</p>


<h3>Author(s)</h3>

<p>Anderson Rodrigo da Silva, Renato Paiva de Lima
</p>
<p>Maintainer: Anderson Rodrigo da Silva &lt;anderson.agro@hotmail.com&gt;
</p>


<h3>References</h3>

<p>da Silva, A.R.; de Lima, R.P. (2015) soilphysics: an R package to determine soil preconsolidation pressure. 
<em>Computers and Geosciences</em>, 84: 54-60.
</p>
<p>de Lima, R.P.; da Silva, A.R.; da Silva, A.P.; Leao, T.P.; Mosaddeghi, M.R. (2016) soilphysics: an R package 
for calculating soil water availability to plants by different soil physical indices.
<em>Computers and Eletronics in Agriculture</em>, 120: 63-71.
</p>
<p>da Silva, A.R.; Lima, R.P. (2017) Determination of maximum curvature point with the R package 
soilphysics. <em>International Journal of Current Research</em>, 9: 45241-45245. 
</p>
<p>De Lima, R.P.; Da Silva, A.R.; Da Silva, A.P. (2021) soilphysics: An R package for simulation of soil compaction induced by agricultural field traffic. 
<em>SOIL and TILLAGE RESEARCH</em>, 206: 104824. 
</p>

<hr>
<h2 id='aggreg.stability'> Soil Aggregate-Size Distribution </h2><span id='topic+aggreg.stability'></span>

<h3>Description</h3>

<p>It calculates the mean weight diameter (MWD), the geometric mean diameter (GMD) and the soil aggregates size
distribution per class based on the mass of the aggregates retained in each sieve from a total soil mass used
for the soil aggregate stability test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aggreg.stability(sample.id = NA, dm.classes, aggre.mass)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="aggreg.stability_+3A_sample.id">sample.id</code></td>
<td>
<p> optional; a character vector containing the sample names. </p>
</td></tr>
<tr><td><code id="aggreg.stability_+3A_dm.classes">dm.classes</code></td>
<td>
<p> a numeric vector containing the aggregates classes, in mm. </p>
</td></tr>
<tr><td><code id="aggreg.stability_+3A_aggre.mass">aggre.mass</code></td>
<td>
<p> a <code>data.frame</code> consisting of columns with soil aggregates mass (g) of each one
of the corresponding <code>dm.classes</code>. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The user must arrange a <code>data.frame</code> with lines representing the samples and the columns representing the mass
of the aggregates retained in each one of the meshes (corresponding to each size class) in the aggregate stability test.
</p>
<p><img src="../help/figures/aggregequations.jpg" alt="aggregequations.jpg" />
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> containing valor of MWD, GMD, total soil mass (<code>total.mass</code>) used in the aggregate stability
test and the percentage of soil aggregate size distribution per class.
</p>


<h3>Author(s)</h3>

<p>Renato Paiva de Lima &lt;renato_agro_@hotmail.com&gt;
</p>


<h3>References</h3>

<p>W. Kemper, W. Chepil. (1965). Size distribution of aggregates. C. Black (Ed.). <em>Methods of Soil Analysis</em>,
American Society Agronomy, Madison. pp. 499-510.
</p>
<p>Yoder, R. A. (1936). A direct method of aggregate analysis of soils and a study of the physical nature of erosion losses.
<em>Journal of the American Society of Agronomy</em>, 28:337-351.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(SoilAggregate)
classes &lt;- c(3, 1.5, 0.75, 0.375, 0.178, 0.053)
aggreg.stability(sample.id = SoilAggregate[ ,1],
   dm.classes = classes, aggre.mass = SoilAggregate[ ,-1])

# End (not run)
</code></pre>

<hr>
<h2 id='aggreg.stability_App'>A shiny for Soil Aggregate-Size Distribution</h2><span id='topic+aggreg.stability_App'></span>

<h3>Description</h3>

<p>A shiny for Soil Aggregate-Size Distribution</p>


<h3>Usage</h3>

<pre><code class='language-R'>aggreg.stability_App()
</code></pre>


<h3>Value</h3>

<p>A shiny app</p>


<h3>Author(s)</h3>

<p> Renato Paiva de Lima &lt;renato_agro_@hotmail.com&gt; </p>


<h3>See Also</h3>

<p><code><a href="#topic+stressTraffic">stressTraffic</a></code>
</p>

<hr>
<h2 id='bulkDensity'> Soil Bulk Density Data Set </h2><span id='topic+bulkDensity'></span>

<h3>Description</h3>

<p>This data set refers to five observations of soil bulk density and soil moisture per sample.
There are four soil samples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> data(bulkDensity) </code></pre>


<h3>Format</h3>

<p>A data frame with 20 observations on the following 3 variables.
</p>

<dl>
<dt><code>Id</code></dt><dd><p> a factor with levels <code>s1</code> <code>s2</code> <code>s3</code> <code>s4</code>, the 'ID' of each soil sample. </p>
</dd>
<dt><code>MOIS</code></dt><dd><p> a numeric vector containing soil moisture values (cm^3 / cm^3). </p>
</dd>
<dt><code>BULK</code></dt><dd><p> a numeric vector containing soil bulk density values (g / cm^3). </p>
</dd>
</dl>



<h3>Source</h3>

<p> Simulated data. </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bulkDensity)
summary(bulkDensity)
</code></pre>

<hr>
<h2 id='compaction'> Soil Compaction Data Set </h2><span id='topic+compaction'></span>

<h3>Description</h3>

<p>This data set refers to physical soil variables related to soil compaction.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> data(compaction) </code></pre>


<h3>Format</h3>

<p>A data frame with 50 observations on the following 4 variables.
</p>

<dl>
<dt><code>PR</code></dt><dd><p>a numeric vector containing soil penetration resistance values (MPa). </p>
</dd>
<dt><code>BD</code></dt><dd><p>a numeric vector containing soil bulk density values (g / cm^3). </p>
</dd>
<dt><code>Mois</code></dt><dd><p>a numeric vector containing soil moisture values (cm^3 / cm^3). </p>
</dd>
<dt><code>PS</code></dt><dd><p>a numeric vector containing soil preconsolidation stress values (kPa). </p>
</dd>
</dl>



<h3>Source</h3>

<p> Simulated data. </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(compaction)
summary(compaction)
</code></pre>

<hr>
<h2 id='compressive_properties'>Estimation of compressive properties by Defossez et al. (2003) </h2><span id='topic+compressive_properties'></span>

<h3>Description</h3>

<p>It calculates the compressive parameters N and lambda using the pedo-transfer function from Defossez et al. (2003)
</p>


<h3>Usage</h3>

<pre><code class='language-R'> 
compressive_properties(water.content, soil=c("Loess", "Calcareous"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compressive_properties_+3A_water.content">water.content</code></td>
<td>
<p> a numeric vector containing the values of gravimetric water content, <code class="reqn">\%</code></p>
</td></tr>
<tr><td><code id="compressive_properties_+3A_soil">soil</code></td>
<td>
<p>the soil group 'Loess' or 'Calcareous'. See examples</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In Defossez et al. (2003), the recompression index, kappa, was assumed as 0.0058 for both soil group.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>N</code></td>
<td>
<p>the specific volume at <code class="reqn">p = 1 kPa</code>, N</p>
</td></tr>
<tr><td><code>CI</code></td>
<td>
<p>the compression index, lambda</p>
</td></tr>
</table>


<h3>Author(s)</h3>

 
<p>Renato Paiva de Lima &lt;renato_agro_@hotmail.com&gt;
Anderson Rodrigo da Silva &lt;anderson.agro@hotmail.com&gt; 
</p>


<h3>References</h3>

<p>Defossez, P., Richard, G., Boizard, H., &amp; O'Sullivan, M. F., 2003. 
Modeling change in soil compaction due to agricultural traffic as function of soil water content. 
<em>Geoderma</em>, 116: 89&ndash;105.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stressTraffic">stressTraffic</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># EXAMPLE 1 - For Loess and Calcareous soil

water.content &lt;- 25
compressive_properties(water.content=water.content, soil="Loess") 
compressive_properties(water.content=water.content, soil="Calcareous") 

# EXAMPLE 2 - For Loess soil

water.content &lt;- seq(from=5,to=30,len=20)
out &lt;- compressive_properties(water.content=water.content, soil="Loess") 
plot(x=water.content ,y=out$N, ylab="N", xlab="Bulk density") # plot for N
plot(x=water.content ,y=out$CI, ylab="Lambda", xlab="Bulk density") # plot for compression index


# EXAMPLE 3 - For Calcareous soil

water.content &lt;- seq(from=5,to=30,len=20)
out &lt;- compressive_properties(water.content=water.content, soil="Calcareous") 
plot(x=water.content ,y=out$N, ylab="N", xlab="Bulk density") # plot for N
plot(x=water.content ,y=out$CI, ylab="Lambda", xlab="Bulk density") # plot for compression index

# End (not run)
</code></pre>

<hr>
<h2 id='compressive_properties2'> Estimation of compressive properties by Keller and Arvidsson (2007)</h2><span id='topic+compressive_properties2'></span>

<h3>Description</h3>

<p>It calculates the compressive parameters N and lambda using the pedo-transfer function from Keller and Arvidsson (2007)
</p>


<h3>Usage</h3>

<pre><code class='language-R'> 
compressive_properties2(particle.density, bulk.density)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compressive_properties2_+3A_particle.density">particle.density</code></td>
<td>
<p> a numeric vector containing the values of particle density, <code class="reqn">Mg m^{-3}</code></p>
</td></tr>
<tr><td><code id="compressive_properties2_+3A_bulk.density">bulk.density</code></td>
<td>
<p> a numeric vector containing the values of bulk density, <code class="reqn">Mg m^{-3}</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>In Keller and Arvidsson (2007), the recompression index, kappa, was found as 0.042 for all soil.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>N</code></td>
<td>
<p>the specific volume at <code class="reqn">p = 1 kPa</code>, N</p>
</td></tr>
<tr><td><code>CI</code></td>
<td>
<p>the compression index, lambda</p>
</td></tr>
</table>


<h3>Author(s)</h3>

 
<p>Renato Paiva de Lima &lt;renato_agro_@hotmail.com&gt;
Anderson Rodrigo da Silva &lt;anderson.agro@hotmail.com&gt; 
</p>


<h3>References</h3>

<p>Keller, T., Arvidsson, J., 2007. 
Compressive properties of some Swedish and Danish structured agricultural soils measured in uniaxial compression tests. 
<em>European Journal of Soil Science </em>, 58: 1373-1381.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stressTraffic">stressTraffic</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># EXAMPLE 1

 compressive_properties2(particle.density=2.65, bulk.density=1.5)

# EXAMPLE 2

BD &lt;- seq(from=1.2,to=1.8, by=0.01) # range of bulk density from 1.2 to 1.8
out &lt;- compressive_properties2(particle.density=2.65, bulk.density=BD)

plot(x=BD,y=out$N, ylab="N", xlab="Bulk density") # for N
plot(x=BD,y=out$CI, ylab="Compression index (CI)", xlab="Bulk density") # for compression index

# End (not run)
</code></pre>

<hr>
<h2 id='compressive_properties3'>Estimation of compressive properties by de Lima et al. (2018)</h2><span id='topic+compressive_properties3'></span>

<h3>Description</h3>

<p>It calculates the compressive parameters N, lambda and kappa using the pedo-transfer function from de Lima et al. (2018)
</p>


<h3>Usage</h3>

<pre><code class='language-R'> 
compressive_properties3(bulk.density, matric.suction, soil=c("SandyLoam","SandyClayLoam"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compressive_properties3_+3A_bulk.density">bulk.density</code></td>
<td>
<p> a numeric vector containing the values of bulk density, <code class="reqn">Mg m^{-3}</code></p>
</td></tr> 
<tr><td><code id="compressive_properties3_+3A_matric.suction">matric.suction</code></td>
<td>
<p> a numeric vector containing the values of matric suction, hPa</p>
</td></tr> 
<tr><td><code id="compressive_properties3_+3A_soil">soil</code></td>
<td>
<p> the soil texture group 'SandyLoam' or 'SandyClayLoam'. See exemples</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Pedo-transfer function deveploed under no-till condition. See de Lima et al. (2018)
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>N</code></td>
<td>
<p>the specific volume at <code class="reqn">p = 1 kPa</code>, N</p>
</td></tr>
<tr><td><code>CI</code></td>
<td>
<p>the compression index, lambda</p>
</td></tr>
<tr><td><code>k</code></td>
<td>
<p>the recompression index, kappa</p>
</td></tr>
</table>


<h3>Author(s)</h3>

 
<p>Renato Paiva de Lima &lt;renato_agro_@hotmail.com&gt;
Anderson Rodrigo da Silva &lt;anderson.agro@hotmail.com&gt; 
</p>


<h3>References</h3>

<p>de Lima, R. P., da Silva, A. P., Giarola, N. F., da Silva, A. R., Rolim, M. M., Keller, T., 2018.
Impact of initial bulk density and matric suction on compressive properties of two Oxisols under no-till. 
<em>Soil and Tillage Research</em>, 175: 168-177.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stressTraffic">stressTraffic</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># EXAMPLE 1

compressive_properties3(bulk.density=1.5, matric.suction=100, soil="SandyLoam")
compressive_properties3(bulk.density=1.5, matric.suction=100, soil="SandyClayLoam")

# EXAMPLE 2 for SandyLoam soil

matric.suction &lt;- seq(from=30,to=1000,len=100)
out &lt;- compressive_properties3(bulk.density=1.5, 
	matric.suction=matric.suction, soil="SandyLoam")
plot(x=matric.suction,y=out$N, ylab="N", 
	xlab="Matric suction (hPa)", log="x") # plot for N
# plot for lambda
plot(x=matric.suction,y=out$lambda, ylab="lambda", 
	xlab="Matric suction (hPa)", log="x") 
# plot for kappa
plot(x=matric.suction,y=out$k, ylab="kappa", 
	xlab="Matric suction (hPa)", log="x") 


# EXAMPLE 3 for SandyClayLoam soil

matric.suction &lt;- seq(from=30,to=1000,len=100)
out &lt;- compressive_properties3(bulk.density=1.5, 
				matric.suction=matric.suction, 
				soil="SandyClayLoam")
plot(x=matric.suction,y=out$N, ylab="N", 
     xlab="Matric suction (hPa)", log="x") # plot for N
# plot for lambda
plot(x=matric.suction,y=out$lambda, 
     ylab="lambda", xlab="Matric suction (hPa)", log="x")
# plot for kappa
plot(x=matric.suction,y=out$k, 
     ylab="kappa", xlab="Matric suction (hPa)", log="x")

# End (not run)
</code></pre>

<hr>
<h2 id='compressive_properties4'> Estimation of compressive properties by de Lima et al. (2020)</h2><span id='topic+compressive_properties4'></span>

<h3>Description</h3>

<p>It calculates the compressive parameters N, lambda and kappa using the pedo-transfer function from de Lima et al. (2020)
</p>


<h3>Usage</h3>

<pre><code class='language-R'> 
compressive_properties4(matric.suction, soil=c("PloughLayer","PloughPan"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compressive_properties4_+3A_matric.suction">matric.suction</code></td>
<td>
<p> a numeric vector containing the values of matric suction, hPa.</p>
</td></tr> 
<tr><td><code id="compressive_properties4_+3A_soil">soil</code></td>
<td>
<p>the soil compaction state 'PloughLayer' or 'PloughPan'. See the examples.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Pedo-transfer function developed for a sandy loam soil texture. See de Lima et al. (2018)
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>N</code></td>
<td>
<p>the specific volume at <code class="reqn">p = 1 kPa</code>, N</p>
</td></tr>
<tr><td><code>CI</code></td>
<td>
<p>the compression index, lambda</p>
</td></tr>
<tr><td><code>k</code></td>
<td>
<p>the recompression index, kappa</p>
</td></tr>
</table>


<h3>Author(s)</h3>

 
<p>Renato Paiva de Lima &lt;renato_agro_@hotmail.com&gt;
Anderson Rodrigo da Silva &lt;anderson.agro@hotmail.com&gt; 
</p>


<h3>References</h3>

<p>de Lima, R. P., Rolim, M. M., da C. Dantas, D., da Silva, A. R., Mendonca, E. A., 2020.
Compressive properties and least limiting water range of plough layer and plough pan in sugarcane fields. 
<em>Soil Use and Management</em>, 00: 1-12.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stressTraffic">stressTraffic</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># EXAMPLE 1

compressive_properties4(matric.suction=100, soil="PloughLayer")
compressive_properties4(matric.suction=100, soil="PloughPan")



# EXAMPLE 2 for "PloughLayer"

matric.suction &lt;- seq(from=10,to=10000,len=100)
out &lt;- compressive_properties4(matric.suction=matric.suction, soil="PloughLayer")
plot(x=matric.suction,y=out$N, ylab="N", 
	xlab="Matric suction (hPa)", log="x") # plot for N
# plot for lambda
plot(x=matric.suction,y=out$lambda, ylab="lambda", 
	xlab="Matric suction (hPa)", log="x") 
# plot for kappa
plot(x=matric.suction,y=out$k, ylab="kappa", 
	xlab="Matric suction (hPa)", log="x")


# EXAMPLE 3 for "PloughPan"

matric.suction &lt;- seq(from=10,to=10000,len=100)
out &lt;- compressive_properties4(matric.suction=matric.suction, 
                               soil="PloughPan")
# plot for N
plot(x=matric.suction,y=out$N, 
     ylab="N", xlab="Matric suction (hPa)", log="x") 
# plot for lambda
plot(x=matric.suction,y=out$lambda, 
     ylab="lambda", xlab="Matric suction (hPa)", log="x") 
# plot for kappa
plot(x=matric.suction,y=out$k, ylab="kappa", 
     xlab="Matric suction (hPa)", log="x") 

# End (not run)
</code></pre>

<hr>
<h2 id='compressive_properties5'>Estimation of compressive properties by O'Sullivan et al. (1999)</h2><span id='topic+compressive_properties5'></span>

<h3>Description</h3>

<p>It calculates the compressive parameteres N, lambda and kappa using the pedo-transfer function from O'Sullivan et al. (1999)
</p>


<h3>Usage</h3>

<pre><code class='language-R'> 
compressive_properties5(water.content, soil=c("SandyLoam","ClayLoam"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compressive_properties5_+3A_water.content">water.content</code></td>
<td>
<p> a numeric vector containing the values of gravimetric water content, <code class="reqn">\%</code></p>
</td></tr> 
<tr><td><code id="compressive_properties5_+3A_soil">soil</code></td>
<td>
<p>the the soil texture group 'SandyLoam' or 'ClayLoam'. See exemples.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See O'Sullivan et al. (1999).
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>N</code></td>
<td>
<p>the specific volume at <code class="reqn">p = 1 kPa</code>, N</p>
</td></tr>
<tr><td><code>CI</code></td>
<td>
<p>the compression index, lambda</p>
</td></tr>
<tr><td><code>k</code></td>
<td>
<p>the recompression index, kappa</p>
</td></tr>
</table>


<h3>Author(s)</h3>

 
<p>Renato Paiva de Lima &lt;renato_agro_@hotmail.com&gt;
Anderson Rodrigo da Silva &lt;anderson.agro@hotmail.com&gt; 
</p>


<h3>References</h3>

<p>O'sullivan, M. F., Henshall, J. K., Dickson, J. W., 1999.
A simplified method for estimating soil compaction. 
<em>Soil and Tillage Research</em>, 49: 325-335.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stressTraffic">stressTraffic</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># EXAMPLE 1
water.content &lt;- 15
compressive_properties5(water.content=water.content, soil="SandyLoam") 
compressive_properties5(water.content=water.content, soil="ClayLoam") 


# EXAMPLE 2 - SandyLoam

water.content &lt;- seq(from=5,to=20,len=20)
out &lt;- compressive_properties5(water.content=water.content, soil="SandyLoam") 
plot(x=water.content ,y=out$N, 
     ylab="N", xlab="Bulk density") # plot for N
plot(x=water.content ,y=out$lambda, 
    ylab="lambda", xlab="Bulk density") # plot for lambda
plot(x=water.content ,y=out$kappa, 
    ylab="kappa", xlab="Bulk density") # plot for kappa


# EXAMPLE 3 - ClayLoam 

water.content &lt;- seq(from=10,to=25,len=20)
out &lt;- compressive_properties5(water.content=water.content, soil="ClayLoam") 
plot(x=water.content ,y=out$N, 
     ylab="N", xlab="Bulk density") # plot for N
plot(x=water.content ,y=out$lambda, 
     ylab="lambda", xlab="Bulk density") # plot for lambda
plot(x=water.content ,y=out$kappa, 
     ylab="kappa", xlab="Bulk density") # plot for rkappa

# End (not run)
</code></pre>

<hr>
<h2 id='criticalmoisture'> Critical Moisture and Maximum Bulk Density </h2><span id='topic+criticalmoisture'></span><span id='topic+maxbulkdensity'></span>

<h3>Description</h3>

<p>Function to determine the soil Critical Moisture and the Maximum Bulk Density 
based on the Proctor (1933) compaction test. It estimates compaction curve
by fitting a quadradtic regression model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>criticalmoisture(theta, Bd, samples = NULL, graph = TRUE, ...)

maxbulkdensity(theta, Bd, samples = NULL, graph = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="criticalmoisture_+3A_theta">theta</code></td>
<td>
<p> a vector containing the soil moisture values. </p>
</td></tr>
<tr><td><code id="criticalmoisture_+3A_bd">Bd</code></td>
<td>
<p> a vector containing the the soil bulk density values. </p>
</td></tr>
<tr><td><code id="criticalmoisture_+3A_samples">samples</code></td>
<td>
<p> optional; a vector indicating the multiple samples. Default is NULL (one sample). See details. </p>
</td></tr>
<tr><td><code id="criticalmoisture_+3A_graph">graph</code></td>
<td>
<p> logical; if TRUE (default), the soil compaction curve is plotted. </p>
</td></tr>
<tr><td><code id="criticalmoisture_+3A_...">...</code></td>
<td>
<p> further graphical arguments. </p>
</td></tr>
</table>


<h3>Details</h3>

<p> If <code>samples</code> is ispecified, then it must has the same length of <code>theta</code> and <code>Bd</code>. </p>


<h3>Value</h3>

<p>An object of class 'criticalmoisture', i.e., a matrix containing the quadratic model
coefficients (rows 1 to 3), the R-squared (row 4), the sample size (row 5), the critical
soil moisture (row 6) and the maximum bulk density (row 7), per sample.
</p>


<h3>Note</h3>

<p><code>maxbulkdensity</code> is just an alias of <code>criticalmoisture</code>.
</p>


<h3>Author(s)</h3>

<p> Anderson Rodrigo da Silva &lt;anderson.agro@hotmail.com&gt; </p>


<h3>References</h3>

<p>Proctor, E. R. (1933). Design and construction of rolled earth dams. <em>Eng. News Record</em>, 3: 245-284, 286-289, 348-351, 372-376.
</p>
<p>Silva, A. P. et al. (2010). Indicadores da qualidade fisica do solo. In: Jong Van Lier, Q. (Ed). <em>Fisica do solo</em>.
Vicosa (MG): Sociedade Brasileira de Ciencia do Solo. p.541-281.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+maxcurv">maxcurv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># example 1 (1 sample)
mois &lt;- c(0.083, 0.092, 0.108, 0.126, 0.135)
bulk &lt;- c(1.86, 1.92, 1.95, 1.90, 1.87)
criticalmoisture(theta = mois, Bd = bulk)

# example 2 (4 samples)
data(bulkDensity)
attach(bulkDensity)
criticalmoisture(theta = MOIS, Bd = BULK, samples = Id)

# End (not run)
</code></pre>

<hr>
<h2 id='fitbusscher'> Self-starting Nls Busscher's (1990) Model for Soil Penetration Resistance </h2><span id='topic+fitbusscher'></span>

<h3>Description</h3>

<p>Function to self start the nonlinear Busscher's (1990) model for penetration
resistance, i.e., <code class="reqn">Pr = b0 * (\theta ^ {b1}) * (Bd ^ {b2})</code>. It creates initial
estimates (by log-linearization) of the parameters b0, b1 and b2 and uses them
to provide its least-squares estimates through <code><a href="stats.html#topic+nls">nls</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> fitbusscher(Pr, theta, Bd, ...) </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitbusscher_+3A_pr">Pr</code></td>
<td>
<p> a numeric vector containing penetration resistance values. </p>
</td></tr>
<tr><td><code id="fitbusscher_+3A_theta">theta</code></td>
<td>
<p> a numeric vector containing soil moisture values at which to evaluate the model. </p>
</td></tr>
<tr><td><code id="fitbusscher_+3A_bd">Bd</code></td>
<td>
<p> a numeric vector containing bulk density values at which to evaluate the model. </p>
</td></tr>
<tr><td><code id="fitbusscher_+3A_...">...</code></td>
<td>
<p> further arguments to <code><a href="stats.html#topic+nls">nls</a></code>. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="stats.html#topic+nls">nls</a></code> output (see <code>help(nls)</code>).
</p>


<h3>Author(s)</h3>

<p> Anderson Rodrigo da Silva &lt;anderson.agro@hotmail.com&gt; </p>


<h3>References</h3>

<p>Busscher, W. J. (1990). Adjustment of flat-tipped penetrometer resistance
data to common water content. <em>Transactions of the ASAE</em>, 3:519-524.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fitlbc">fitlbc</a></code>, <code><a href="stats.html#topic+nls">nls</a></code>, <code><a href="stats.html#topic+summary.nls">summary.nls</a></code>,
<code><a href="stats.html#topic+predict.nls">predict.nls</a></code>, <code><a href="#topic+Rsq">Rsq</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(compaction)
attach(compaction)
out &lt;- fitbusscher(Pr = PR, theta = Mois, Bd = BD)
summary(out)
Rsq(out)

# 3D plot
X &lt;- seq(min(Mois), max(Mois), len = 30) # theta
Y &lt;- seq(min(BD), max(BD), len = 30) # Bd
f &lt;- function(x, y) coef(out)[1] * (x^coef(out)[2]) * (y^coef(out)[3])
Z &lt;- outer(X, Y, f)
persp(X, Y, Z,
	xlab = "Soil moisture",
	ylab = "Soil bulk density",
	zlab = "Penetration resistance",
	ticktype = "detailed",
	phi = 20, theta = 30)

# End (not run)
</code></pre>

<hr>
<h2 id='fitlbc'> Parameter Estimation of the Load Bearing Capacity Model </h2><span id='topic+fitlbc'></span>

<h3>Description</h3>

<p>This function creates initial parameter estimates of the nonlinear Load
Bearing Capacity (Dias Jr., 1994) model, i.e., <code class="reqn">\sigma_P = 10 ^ {(b0 + b1 * \theta)}</code>,
by using two methods: a getInitial method or a log-linearization. Then,
it uses them to provide its least-squares estimates via <code><a href="stats.html#topic+nls">nls</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> fitlbc(theta, sigmaP, ...) </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitlbc_+3A_theta">theta</code></td>
<td>
<p> a numeric vector containing soil moisture values. </p>
</td></tr>
<tr><td><code id="fitlbc_+3A_sigmap">sigmaP</code></td>
<td>
<p> a numeric vector containing values of soil preconsolidation stress. </p>
</td></tr>
<tr><td><code id="fitlbc_+3A_...">...</code></td>
<td>
<p> further arguments to <code><a href="stats.html#topic+nls">nls</a></code>. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="stats.html#topic+nls">nls</a></code> object.
</p>


<h3>Author(s)</h3>

<p> Anderson Rodrigo da Silva &lt;anderson.agro@hotmail.com&gt; </p>


<h3>References</h3>

<p>Dias Junior, M. S. (1994). <em>Compression of three soils under longterm
tillage and wheel traffic</em>. 1994. 114p. Ph.D. Thesis - Michigan
State University, East Lansing.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sigmaP">sigmaP</a></code>, <code><a href="#topic+fitbusscher">fitbusscher</a></code>,
<code><a href="#topic+maxcurv">maxcurv</a></code>, <code><a href="#topic+Rsq">Rsq</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(compaction)
attach(compaction)
out &lt;- fitlbc(theta = Mois, sigmaP = PS)
summary(out)
Rsq(out)
curve(10^(coef(out)[1] + coef(out)[2]*x))

# End (not run)
</code></pre>

<hr>
<h2 id='fitsoilwater'> Interactive Estimation of van Genuchten's (1980) Model Parameters </h2><span id='topic+fitsoilwater'></span>

<h3>Description</h3>

<p>An interactive graphical adjustment of the soil water retention curve via van Genuchten's (1980) formula.
The nonlinear least-squares estimates can be achieved taking the graphical initial
values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitsoilwater(theta, x, xlab = NULL, ylab = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitsoilwater_+3A_theta">theta</code></td>
<td>
<p> a numeric vector containing the values of soil water content. </p>
</td></tr>
<tr><td><code id="fitsoilwater_+3A_x">x</code></td>
<td>
<p>  a numeric vector containing the matric potential values. </p>
</td></tr>
<tr><td><code id="fitsoilwater_+3A_xlab">xlab</code></td>
<td>
<p>  a label for the x axis; if is NULL, the label &quot;Matric potential&quot; is used. </p>
</td></tr>
<tr><td><code id="fitsoilwater_+3A_ylab">ylab</code></td>
<td>
<p>  a label for the y axis; if is NULL, the label &quot;Soil water content&quot; is used. </p>
</td></tr>
<tr><td><code id="fitsoilwater_+3A_...">...</code></td>
<td>
<p>  further graphical arguments; see <code><a href="graphics.html#topic+par">par</a></code>. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot of <code>theta</code> versus <code>x</code> and the curve of the current fitted model
according to the adjusted parameters in an external interactive panel.
Pressing the button &quot;NLS estimates&quot; a <code><a href="stats.html#topic+nls">nls</a></code> summary of the
fitted model is printed on console whether convergence is achieved, otherwise
a warning box of &quot;No convergence&quot; is shown.
</p>


<h3>Author(s)</h3>

<p> Anderson Rodrigo da Silva &lt;anderson.agro@hotmail.com&gt; </p>


<h3>References</h3>

<p>Genuchten, M. T. van. (1980). A closed form equation for predicting the
hydraulic conductivity of unsaturated soils. <em>Soil Science Society of
America Journal</em>, 44:892-898.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+nls">nls</a></code>, <code><a href="#topic+soilwater">soilwater</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Liu et al. (2011)
h &lt;- c(0.001, 50.65, 293.77, 790.14, 992.74, 5065, 10130, 15195)
w &lt;- c(0.5650, 0.4013, 0.2502, 0.2324, 0.2307, 0.1926, 0.1812, 0.1730)
fitsoilwater(w, h)

# End (not run)
</code></pre>

<hr>
<h2 id='fitsoilwater_App'>A shiny for fitting soil water retention curves</h2><span id='topic+fitsoilwater_App'></span>

<h3>Description</h3>

<p>A shiny for fitting soil water retention curves</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitsoilwater_App()
</code></pre>


<h3>Value</h3>

<p>A shiny app</p>


<h3>Author(s)</h3>

<p> Renato Paiva de Lima &lt;renato_agro_@hotmail.com&gt; </p>


<h3>See Also</h3>

<p><code><a href="#topic+stressTraffic">stressTraffic</a></code>
</p>

<hr>
<h2 id='fitsoilwater2'> Interactive Estimation of the Groenevelt and Grant (2004) Model Parameters </h2><span id='topic+fitsoilwater2'></span>

<h3>Description</h3>

<p>An interactive graphical adjustment of the soil water retention curve via Groenevelt and Grant (2004) formula.
The nonlinear least-squares estimates can be achieved taking the graphical initial
values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitsoilwater2(theta, x, x0 = 6.653, xlab = NULL, ylab = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitsoilwater2_+3A_theta">theta</code></td>
<td>
<p> a numeric vector containing the values of soil water content.</p>
</td></tr>
<tr><td><code id="fitsoilwater2_+3A_x">x</code></td>
<td>
<p> a numeric vector containing pF (pore water suction) values. See <code><a href="#topic+soilwater2">soilwater2</a></code>.</p>
</td></tr>
<tr><td><code id="fitsoilwater2_+3A_x0">x0</code></td>
<td>
<p> the value of pF at which the soil water content becomes zero. The default is 6.653.</p>
</td></tr>
<tr><td><code id="fitsoilwater2_+3A_xlab">xlab</code></td>
<td>
<p>  a label for the x axis; if is NULL, the label &quot;pF&quot; is used. </p>
</td></tr>
<tr><td><code id="fitsoilwater2_+3A_ylab">ylab</code></td>
<td>
<p>  a label for the y axis; if is NULL, the label &quot;Soil water content&quot; is used. </p>
</td></tr>
<tr><td><code id="fitsoilwater2_+3A_...">...</code></td>
<td>
<p>  further graphical arguments; see <code><a href="graphics.html#topic+par">par</a></code>. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot of <code>theta</code> versus <code>x</code> and the curve of the current fitted model
according to the adjusted parameters in an external interactive panel.
Pressing the button &quot;NLS estimates&quot; a <code><a href="stats.html#topic+nls">nls</a></code> summary of the
fitted model is printed on console whether convergence is achieved, otherwise
a warning box of &quot;No convergence&quot; is shown.
</p>


<h3>Author(s)</h3>

<p> Anderson Rodrigo da Silva &lt;anderson.agro@hotmail.com&gt; </p>


<h3>References</h3>

<p>Groenevelt &amp; Grant (2004). A newmodel for the soil-water retention curve that solves the problem 
of residualwater contents. <em>European Journal of Soil Science</em>, 55:479-485.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+nls">nls</a></code>, <code><a href="#topic+soilwater2">soilwater2</a></code>, <code><a href="#topic+soilwater">soilwater</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>w &lt;- c(0.417, 0.354, 0.117, 0.048, 0.029, 0.017, 0.007, 0)
pF &lt;- 0:7
fitsoilwater2(w, pF)

# End (not run)
</code></pre>

<hr>
<h2 id='fitsoilwater3'> Interactive Estimation of the Dexter's (2008) Model Parameters </h2><span id='topic+fitsoilwater3'></span>

<h3>Description</h3>

<p>An interactive graphical adjustment of the soil water retention curve through the Dexter's (2008) formula. 
The nonlinear least-squares estimates can be achieved taking the graphical initial values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitsoilwater3(theta, x, xlab = NULL, ylab = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitsoilwater3_+3A_theta">theta</code></td>
<td>
<p> a numeric vector containing the values of soil water content.</p>
</td></tr>
<tr><td><code id="fitsoilwater3_+3A_x">x</code></td>
<td>
<p> a numeric vector containing the values of applied air pressure.</p>
</td></tr>
<tr><td><code id="fitsoilwater3_+3A_xlab">xlab</code></td>
<td>
<p>  a label for the x axis; if is NULL, the label &quot;pF&quot; is used. </p>
</td></tr>
<tr><td><code id="fitsoilwater3_+3A_ylab">ylab</code></td>
<td>
<p>  a label for the y axis; if is NULL, the label &quot;Soil water content&quot; is used. </p>
</td></tr>
<tr><td><code id="fitsoilwater3_+3A_...">...</code></td>
<td>
<p>  further graphical arguments; see <code><a href="graphics.html#topic+par">par</a></code>. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot of <code>theta</code> versus <code>x</code> and the curve of the current fitted model
according to the adjusted parameters in an external interactive panel.
Pressing the button &quot;NLS estimates&quot; a <code><a href="stats.html#topic+nls">nls</a></code> summary of the
fitted model is printed on console whether convergence is achieved, otherwise
a warning box of &quot;No convergence&quot; is shown.
</p>


<h3>Author(s)</h3>

<p> Anderson Rodrigo da Silva &lt;anderson.agro@hotmail.com&gt; </p>


<h3>References</h3>

<p>Dexter et al. (2008). A user-friendly water retention function that takes account of the textural
and structural pore spaces in soil. <em>Geoderma</em>, 143:243&ndash;253.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+soilwater3">soilwater3</a></code>, <code><a href="stats.html#topic+nls">nls</a></code>, <code><a href="#topic+fitsoilwater2">fitsoilwater2</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># data extracted from Liu et al. (2011)
h &lt;- c(0.001, 50.65, 293.77, 790.14, 992.74, 5065, 10130, 15195)
w &lt;- c(0.5650, 0.4013, 0.2502, 0.2324, 0.2307, 0.1926, 0.1812, 0.1730)
fitsoilwater3(w, h)

# End (not run)
</code></pre>

<hr>
<h2 id='fitsoilwater4'> Self-starting Nls Power Models for Soil Water Retention </h2><span id='topic+fitsoilwater4'></span>

<h3>Description</h3>

<p>Function to self start the following nonlinear power models for soil water retention: 
</p>
<p style="text-align: center;"><code class="reqn">\theta = \exp(a + b*Bd) \psi^c</code>
</p>
<p>  (Silva et al., 1994)
</p>
<p style="text-align: center;"><code class="reqn">\theta = a \psi^c</code>
</p>
<p>  (Ross et al., 1991)
</p>
<p>where <code class="reqn">\theta</code> is the soil water content.
</p>
<p><code>fitsoilwater()</code> creates initial estimates (by log-linearization) of the parameters a, b and c and uses them
to provide its least-squares estimates through <code><a href="stats.html#topic+nls">nls</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitsoilwater4(theta, psi, Bd, model = c("Silva", "Ross"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitsoilwater4_+3A_theta">theta</code></td>
<td>
<p> a numeric vector containing values of soil water content.</p>
</td></tr>
<tr><td><code id="fitsoilwater4_+3A_psi">psi</code></td>
<td>
<p> a numeric vector containing values of water potential (Psi).</p>
</td></tr>
<tr><td><code id="fitsoilwater4_+3A_bd">Bd</code></td>
<td>
<p> a numeric vector containing values of dry bulk density.</p>
</td></tr>
<tr><td><code id="fitsoilwater4_+3A_model">model</code></td>
<td>
<p> a character; the model to be used for calculating the soil water content. It must be one of the
two: <code>"Silva"</code> (default) or <code>"Ross"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A &quot;nls&quot; object containing the fitted model.
</p>


<h3>Author(s)</h3>

<p> Anderson Rodrigo da Silva &lt;anderson.agro@hotmail.com&gt; </p>


<h3>References</h3>

<p>Ross et al. (1991). Equation for extending water-retention curves to dryness.
<em>Soil Science Society of America Journal</em>, 55:923-927. 
</p>
<p>Silva et al. (1994). Characterization of the least limiting water range of soils. 
<em>Soil Science Society of America Journal</em>, 58:1775-1781.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fitsoilwater4">fitsoilwater4</a></code>, <code><a href="#topic+soilwater">soilwater</a></code>, <code><a href="#topic+soilwater2">soilwater2</a></code>, <code><a href="#topic+soilwater3">soilwater3</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(skp1994)
# Example 1
ex1 &lt;- with(skp1994,
    fitsoilwater4(theta = W, psi = h, model = "Ross"))
ex1
summary(ex1)

# Example 2
ex2 &lt;- with(skp1994,
    fitsoilwater4(theta = W, psi = h, Bd = BD, model = "Silva"))
ex2
summary(ex2)

# Not run
</code></pre>

<hr>
<h2 id='fitsoilwater5'> Interactive Estimation of the Modified van Genuchten's Model Parameters </h2><span id='topic+fitsoilwater5'></span>

<h3>Description</h3>

<p>An interactive graphical adjustment of the soil water retention curve via the van Genuchten's formula, 
modified by Pierson and Mulla (1989). The nonlinear least-squares estimates can be achieved taking the 
graphical initial values.
It may be useful to estimate the parameters needed in the high-energy-moisture-characteristics (HEMC) method, 
which is used to analyze the aggregate stability. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitsoilwater5(theta, x, theta_S, xlab = NULL, ylab = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitsoilwater5_+3A_theta">theta</code></td>
<td>
<p> a numeric vector containing the values of soil water content. </p>
</td></tr>
<tr><td><code id="fitsoilwater5_+3A_x">x</code></td>
<td>
<p>  a numeric vector containing the matric potential values. </p>
</td></tr>
<tr><td><code id="fitsoilwater5_+3A_theta_s">theta_S</code></td>
<td>
<p> an offset; a value for the parameter <code>theta_S</code>, the water content at saturation. See details.</p>
</td></tr>
<tr><td><code id="fitsoilwater5_+3A_xlab">xlab</code></td>
<td>
<p>  a label for the x axis; if is NULL, the label &quot;Matric potential&quot; is used. </p>
</td></tr>
<tr><td><code id="fitsoilwater5_+3A_ylab">ylab</code></td>
<td>
<p>  a label for the y axis; if is NULL, the label &quot;Soil water content&quot; is used. </p>
</td></tr>
<tr><td><code id="fitsoilwater5_+3A_...">...</code></td>
<td>
<p>  further graphical arguments; see <code><a href="graphics.html#topic+par">par</a></code>. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The parameter theta_S must be passed as an argument. It is recommended to consider it as the highest water content 
value in the data set or the water content at saturation.
</p>


<h3>Value</h3>

<p>A plot of <code>theta</code> versus <code>x</code> and the curve of the current fitted model
according to the adjusted parameters in an external interactive panel.
Pressing the button &quot;NLS estimates&quot; a <code><a href="stats.html#topic+nls">nls</a></code> summary of the
fitted model is printed on console whether convergence is achieved, otherwise
a warning box of &quot;No convergence&quot; is shown.
</p>


<h3>Author(s)</h3>

<p> Anderson Rodrigo da Silva &lt;anderson.agro@hotmail.com&gt; </p>


<h3>References</h3>

<p>Pierson, F.B.; Mulla, D.J. (1989) An Improved Method for Measuring Aggregate Stability
of a Weakly Aggregated Loessial Soil. <em>Soil Sci. Soc. Am. J.</em>, 53:1825&ndash;1831.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+nls">nls</a></code>, <code><a href="#topic+soilwater5">soilwater5</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>h &lt;- seq(0.1, 40, by = 2)
w &lt;- c(0.735, 0.668, 0.635, 0.612, 0.559, 0.462, 0.369, 0.319, 0.296, 0.282, 
	0.269, 0.256, 0.249, 0.246, 0.239, 0.236, 0.229, 0.229, 0.226, 0.222)
plot(w ~ h)

# suggestions of starting values: thetaR = 0.35, alpha = 0.1, n = 10, 
# b0 = 0.02, b1 = -0.0057, b2 = 0.00004 (Not run)

fitsoilwater5(theta = w, x = h, theta_S = 0.70)

# End (Not run)
</code></pre>

<hr>
<h2 id='fun2form'> Converting Function to Formula </h2><span id='topic+fun2form'></span>

<h3>Description</h3>

<p>An accessorial function to convert an object of <code>class</code> 'function' to an object
of <code>class</code> 'formula'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> fun2form(fun, y = NULL) </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fun2form_+3A_fun">fun</code></td>
<td>
<p> a object of class 'function'. It must be a one-line-written function, with no curly braces &quot;{}&quot;. </p>
</td></tr>
<tr><td><code id="fun2form_+3A_y">y</code></td>
<td>
<p> optional; a character defining the lef side of the formula, <code>y = fun()</code>. </p>
</td></tr>
</table>


<h3>Value</h3>

<p> An object of class <code><a href="stats.html#topic+formula">formula</a></code>. </p>


<h3>Warning </h3>

 
<p>Numerical values into <code>fun</code> with three or more digits may cause miscalculation.
</p>


<h3>Author(s)</h3>

<p> Anderson Rodrigo da Silva &lt;anderson.agro@hotmail.com&gt; </p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+function">function</a></code>, <code><a href="stats.html#topic+formula">formula</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>g &lt;- function(x) Asym * exp(-b2 * b3 ^ x) # Gompertz Growth Model
fun2form(g, "y")

# f1 &lt;- function(w) {exp(w)} # error
# fun2form(f1, "x") 
f2 &lt;- function(w) exp(w) # ok
fun2form(f2, "x")

# End (not run)
</code></pre>

<hr>
<h2 id='getInitiallbc'> Get Initial Parameter Estimates for the Load Bearing Capacity Model </h2><span id='topic+getInitiallbc'></span>

<h3>Description</h3>

<p>This is a <code><a href="stats.html#topic+getInitial">getInitial</a></code> function that evaluates initial parameter estimates
for the Load Bearing Capacity model via <code><a href="#topic+SSlbc">SSlbc</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> getInitiallbc(theta, sigmaP) </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getInitiallbc_+3A_theta">theta</code></td>
<td>
<p> a numeric vector containing values of soil moisture. </p>
</td></tr>
<tr><td><code id="getInitiallbc_+3A_sigmap">sigmaP</code></td>
<td>
<p> a numeric vector containing values of preconsolidation stress. </p>
</td></tr>
</table>


<h3>Value</h3>

<p> A numeric vector containing the estimates of the parameters b0 and b1. </p>


<h3>Author(s)</h3>

<p> Anderson Rodrigo da Silva &lt;anderson.agro@hotmail.com&gt; </p>


<h3>References</h3>

<p>Dias Junior, M. S. (1994). <em>Compression of three soils under longterm
tillage and wheel traffic</em>. 1994. 114p. Ph.D. Thesis - Michigan
State University, East Lansing.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+getInitial">getInitial</a></code>, <code><a href="#topic+SSlbc">SSlbc</a></code>, <code><a href="stats.html#topic+nls">nls</a></code>, <code><a href="#topic+sigmaP">sigmaP</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(compaction)
attach(compaction)
getInitiallbc(theta = Mois, sigmaP = PS)

# End (not run)
</code></pre>

<hr>
<h2 id='hemc'> High-Energy-Moisture-Characteristics Aggregate Stability </h2><span id='topic+hemc'></span>

<h3>Description</h3>

<p>A function to determine the modal suction, volume of drainable pores, structural index and stability ratio 
using the high-energy-moisture-characteristics (HEMC) method by Pierson &amp; Mulla (1989), which is used to analyze 
the aggregate stability. Before using <code>hemc()</code>, the user may estimate the parameters of the Modified van 
Genuchten's Model through the function <code>fitsoilwater5()</code>. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hemc(x, theta_R, theta_S, alpha, n, b1, b2, 
	graph = TRUE, from = 1, to = 30, 
	xlab = expression(Psi ~ (J~kg^{-1})), 
	ylab = expression(d ~ theta/d ~ Psi), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hemc_+3A_x">x</code></td>
<td>
<p>a vector containing matric potential values.</p>
</td></tr>
<tr><td><code id="hemc_+3A_theta_r">theta_R</code></td>
<td>
<p> a numeric vector of length two containing the parameter values in the following orde: fast and slow.</p>
</td></tr>
<tr><td><code id="hemc_+3A_theta_s">theta_S</code></td>
<td>
<p> a numeric vector of length two containing the parameter values in the following orde: fast and slow.</p>
</td></tr>
<tr><td><code id="hemc_+3A_alpha">alpha</code></td>
<td>
<p> a numeric vector of length two containing the parameter values in the following orde: fast and slow.</p>
</td></tr>
<tr><td><code id="hemc_+3A_n">n</code></td>
<td>
<p> a numeric vector of length two containing the parameter values in the following orde: fast and slow.</p>
</td></tr>
<tr><td><code id="hemc_+3A_b1">b1</code></td>
<td>
<p> a numeric vector of length two containing the parameter values in the following orde: fast and slow.</p>
</td></tr>
<tr><td><code id="hemc_+3A_b2">b2</code></td>
<td>
<p> a numeric vector of length two containing the parameter values in the following orde: fast and slow.</p>
</td></tr>
<tr><td><code id="hemc_+3A_graph">graph</code></td>
<td>
<p>logical; if TRUE (default), a graphical solution is shown).</p>
</td></tr>
<tr><td><code id="hemc_+3A_from">from</code></td>
<td>
<p>the lower limit for the x-axis</p>
</td></tr>
<tr><td><code id="hemc_+3A_to">to</code></td>
<td>
<p>the lower limit for the x-axis</p>
</td></tr>
<tr><td><code id="hemc_+3A_xlab">xlab</code></td>
<td>
<p>a label for the x-axis</p>
</td></tr>
<tr><td><code id="hemc_+3A_ylab">ylab</code></td>
<td>
<p>a label for the y-axis</p>
</td></tr>
<tr><td><code id="hemc_+3A_...">...</code></td>
<td>
<p>further graphical arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of a two objects: 1) a matrix containing the Modal Suction, the Volume od Drainable Pores (VDP) and the Structural Index for
both, fast and slow wetting; and 2) the value of Stability Ratio.
</p>


<h3>Author(s)</h3>

<p>Anderson Rodrigo da Silva &lt;anderson.agro@hotmail.com&gt;
</p>


<h3>References</h3>

<p>Pierson, F.B.; Mulla, D.J. (1989). An Improved Method for Measuring Aggregate Stability of a Weakly 
Aggregated Loessial Soil. <em>Soil Sci. Soc. Am. J.</em>, 53:1825&ndash;1831.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fitsoilwater5">fitsoilwater5</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>hemc(x = seq(1, 30), theta_R = c(0.27, 0.4), theta_S = c(0.65, 0.47), 
	alpha = c(0.1393, 0.0954), n = c(6.37, 7.47), 
	b1 = c(-0.008421, -0.011970), b2 = c(0.0001322, 0.0001552))

# End (Not run)
</code></pre>

<hr>
<h2 id='hydraulicCutOff'>The matric potential at the point of hydraulic cut-off obtained from DE (Dexter et al., 2008) and GG (Groenevelt &amp; Grant, 2004) water retention curves.</h2><span id='topic+hydraulicCutOff'></span>

<h3>Description</h3>

<p>The pore water suction at the point of hydraulic cut-off occurs at the point where the residual 
water content, obtained from Dexter et al. (2008), intercepts with the Groenevelt &amp; Grant (2004) 
retention curve.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hydraulicCutOff(theta_R, k0, k1, n, x0 = 6.653)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hydraulicCutOff_+3A_theta_r">theta_R</code></td>
<td>
<p> a parameter that represents the residual water content at the the Dexter's (2008) Water Retention Model.</p>
</td></tr>
<tr><td><code id="hydraulicCutOff_+3A_k0">k0</code></td>
<td>
<p> a parameter value, extracted from the water retention curve based on the Groenevelt &amp; Grant (2004) formula.</p>
</td></tr>
<tr><td><code id="hydraulicCutOff_+3A_k1">k1</code></td>
<td>
<p> a parameter value, extracted from the water retention curve based on the Groenevelt &amp; Grant (2004) formula.</p>
</td></tr>
<tr><td><code id="hydraulicCutOff_+3A_n">n</code></td>
<td>
<p> a parameter value, extracted from the water retention curve based on the Groenevelt &amp; Grant (2004) formula.</p>
</td></tr>
<tr><td><code id="hydraulicCutOff_+3A_x0">x0</code></td>
<td>
<p> the value of pF (pore water suction) at which the soil water content becomes zero. The default is 6.653.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The water suction at the point of hydraulic cut-off.
</p>


<h3>Author(s)</h3>

<p>Anderson Rodrigo da Silva &lt;anderson.agro@hotmail.com&gt;
</p>


<h3>References</h3>

<p>Dexter, A.R.; Czyz, E.A.; Richard, G.; Reszkowska, A. (2008). A user-friendly water retention function that takes
account of the textural and structural pore spaces in soil. <em>Geoderma</em>, 143:243&ndash;253.
</p>
<p>Groenevelt, P.H.; Grnat, C.D. (2004). A new model for the soil-water retention curve that solves the problem of 
residual water contents. <em>European Journal of Soil Science</em>, 55:479&ndash;485.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fitsoilwater2">fitsoilwater2</a></code>, <code><a href="#topic+fitsoilwater3">fitsoilwater3</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Dexter et al. (2012), Table 4A
hydraulicCutOff(0.1130, 6.877, 0.6508, 1.0453)
hydraulicCutOff(0.1122, 12.048, 0.4338, 2.0658)

# End (not run)
</code></pre>

<hr>
<h2 id='hydraulicCutOff2'>The matric potential at the point of hydraulic cut-off using the point of maximum curvature of DE (Dexter et al. 2008) water retention curve. 
</h2><span id='topic+hydraulicCutOff2'></span>

<h3>Description</h3>

<p>The pore water suction at the point of hydraulic cut-off occurs at the point where the residual 
water content, obtained from Dexter et al. (2008), intercepts with the Groenevelt &amp; Grant (2004) 
retention curve. This function calculates the Hydraulic Cut-Off using the point of maximum curvature of the 
DE (Dexter et al. 2008) curve.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hydraulicCutOff2(theta_R, a1, a2, p1, p2, graph = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hydraulicCutOff2_+3A_theta_r">theta_R</code></td>
<td>
<p> the residual water content from Dexter's (2008) water retention curve (g/g).</p>
</td></tr>
<tr><td><code id="hydraulicCutOff2_+3A_a1">a1</code></td>
<td>
<p> a water content parameter from Dexter's (2008) water retention curve (g/g).</p>
</td></tr>
<tr><td><code id="hydraulicCutOff2_+3A_a2">a2</code></td>
<td>
<p> a water content parameter from Dexter's (2008) water retention curve (g/g).</p>
</td></tr>
<tr><td><code id="hydraulicCutOff2_+3A_p1">p1</code></td>
<td>
<p> a matric potential parameter from Dexter's (2008) water retention curve (hPa).</p>
</td></tr>
<tr><td><code id="hydraulicCutOff2_+3A_p2">p2</code></td>
<td>
<p> a matric potential parameter from Dexter's (2008) water retention curve (hPa).</p>
</td></tr>
<tr><td><code id="hydraulicCutOff2_+3A_graph">graph</code></td>
<td>
<p> logical; if TRUE a graphical solution with the maximum curvature point is displayed.</p>
</td></tr>
<tr><td><code id="hydraulicCutOff2_+3A_...">...</code></td>
<td>
<p> further graphical arguments. See <code><a href="graphics.html#topic+par">par</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The arguments are the fitting parameters from Dexter's (2008) water retention curve, which can be fitted using 
<code><a href="#topic+fitsoilwater3">fitsoilwater3</a></code>. Further examples of how to use these parameters are given in Dexter et al. (2012). 
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> containing the values of matric potential (hPa), pF and water content (w) at the hydraulic cut-off (hco) point.
</p>


<h3>Author(s)</h3>

<p>Renato Paiva de Lima &lt;renato_agro_@hotmail.com&gt;
</p>


<h3>References</h3>

<p>Dexter, A.R.; Czyz, E.A.; Richard, G.; Reszkowska, A. (2008). A user-friendly water retention function that takes
account of the textural and structural pore spaces in soil. <em>Geoderma</em>, 143:243&ndash;253.
</p>
<p>Dexter, A.R., Czyz, E.A., Richard, G. (2012). Equilibrium, non-equilibrium and residual water: consequences for soil 
water retention. <em>Geoderma</em>, 177:63&ndash;71.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+hydraulicCutOff">hydraulicCutOff</a></code>, <code><a href="#topic+fitsoilwater3">fitsoilwater3</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example 1:  soils from Dexter et al. (2012), Table 4

hydraulicCutOff2(theta_R=0.1130,a1=0.0808,a2=0.0576,p1=4043.2,p2=269.1,
                  graph = TRUE, ylim=c(-0.05,0.15)) # Soil 1

hydraulicCutOff2(theta_R=0.0998,a1=0.1456,a2=0.0162,p1=3156.0,p2=71.51,
                  graph = TRUE, ylim=c(-0.20,0.30)) # Soil 4

hydraulicCutOff2(theta_R=0.0709,a1=0.0195,a2=0.1794,p1=4467.5,p2=1395.5,
                  graph = TRUE, ylim=c(-0.20,0.30)) # Soil 7

hydraulicCutOff2(theta_R=0.0359,a1=0.1014,a2=0.0459,p1=1282.4,p2=56.93,
                  graph = TRUE, ylim=c(-0.10,0.20)) # Soil 10

hydraulicCutOff2(theta_R=0.0736,a1=0.0522,a2=0.0321,p1=3516.2,p2=90.54,
                  graph = TRUE, ylim=c(-0.05,0.15)) # Soil 14

# Example 2:

# Fitting the water retention curve through the Dexter's (2008) curve
h &lt;- c(0.001, 50.65, 293.77, 790.14, 992.74, 5065, 10130, 15195)
w &lt;- c(0.5650, 0.4013, 0.2502, 0.2324, 0.2307, 0.1926, 0.1812, 0.1730)
if (interactive()) {
   fitsoilwater3(theta=w, x=h)
}

# Using the fitted parameter
hydraulicCutOff2(theta_R=0.1738,a1=0.07505,a2=0.316,p1=3673,p2=70.38,
                  graph = TRUE, ylim=c(-0.40,0.60))


# End (not run)
</code></pre>

<hr>
<h2 id='iwc'> Integral Water Capacity (IWC) </h2><span id='topic+iwc'></span>

<h3>Description</h3>

<p>Quantifying the soil water availability for plants through the IWC approach.
The theory was based on the work of Groenevelt et al. (2001), Groenevelt et al. (2004) and 
Asgarzadeh et al. (2014), using the van Genuchten-Mualem Model for estimation of the water 
retention curve and a simple power model for penetration resistance. The salinity effect on 
soil available water is also implemented here, according to Groenevelt et al. (2004). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>iwc(theta_R, theta_S, alpha, n, a, b, hos = 0, 
    graph = TRUE, 
    xlab = "Matric head (cm)", 
    ylab = expression(cm^-1), 
    xlim1 = NULL,
    xlim2 = NULL, 
    xlim3 = NULL,
    ylim1 = NULL, 
    ylim2 = NULL, 
    ylim3 = NULL,
    col12 = c("black", "blue", "red"),
    col3 = c("orange", "black"),
    lty12 = c(1, 3, 2), 
    lty3 = c(2, 1), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="iwc_+3A_theta_r">theta_R</code></td>
<td>
<p> the residual water content (<code class="reqn">m^3~m{-3}</code>); a numeric parameter from van Genuchten's model; see details.</p>
</td></tr>
<tr><td><code id="iwc_+3A_theta_s">theta_S</code></td>
<td>
<p> the water content at saturation (<code class="reqn">m^3~m{-3}</code>); a numeric parameter from van Genuchten's model; see details.</p>
</td></tr>
<tr><td><code id="iwc_+3A_alpha">alpha</code></td>
<td>
<p> a scale parameter from van Genuchten's model; see details.</p>
</td></tr>
<tr><td><code id="iwc_+3A_n">n</code></td>
<td>
<p> a shape parameter from van Genuchten's model; see details.</p>
</td></tr>
<tr><td><code id="iwc_+3A_a">a</code></td>
<td>
<p> a parameter of the soil penetration resistance model; see details.</p>
</td></tr>
<tr><td><code id="iwc_+3A_b">b</code></td>
<td>
<p> a parameter of the soil penetration resistance model; see details.</p>
</td></tr>
<tr><td><code id="iwc_+3A_hos">hos</code></td>
<td>
<p> optional; the value of osmotic head of the saturated soil extract (cm). Used only if one is 
concerned about the salinity effects on the water available for plants. Default is zero. 
See Groenevelt et al. (2004) for more details.</p>
</td></tr>
<tr><td><code id="iwc_+3A_graph">graph</code></td>
<td>
<p>logical; if TRUE (default), graphics for both dry and wet range are built.</p>
</td></tr>
<tr><td><code id="iwc_+3A_xlab">xlab</code></td>
<td>
<p> a label for x-axis.</p>
</td></tr>
<tr><td><code id="iwc_+3A_ylab">ylab</code></td>
<td>
<p> a label for y-axis.</p>
</td></tr>
<tr><td><code id="iwc_+3A_xlim1">xlim1</code>, <code id="iwc_+3A_xlim2">xlim2</code>, <code id="iwc_+3A_xlim3">xlim3</code></td>
<td>
<p> the x limits (x1, x2) of each plot. See <code><a href="graphics.html#topic+plot.default">plot.default</a></code>.</p>
</td></tr>
<tr><td><code id="iwc_+3A_ylim1">ylim1</code>, <code id="iwc_+3A_ylim2">ylim2</code>, <code id="iwc_+3A_ylim3">ylim3</code></td>
<td>
<p> the y limits (y1, y2) of each plot. See <code><a href="graphics.html#topic+plot.default">plot.default</a></code>.</p>
</td></tr>
<tr><td><code id="iwc_+3A_col12">col12</code></td>
<td>
<p> a vector of length 3 containing the color of each line of the first two plots. See <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="iwc_+3A_col3">col3</code></td>
<td>
<p> a vector of length 2 containing the color of each line of the third plot. See <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="iwc_+3A_lty12">lty12</code></td>
<td>
<p> a vector of length 3 containing the line types for the first two plots. See <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="iwc_+3A_lty3">lty3</code></td>
<td>
<p> a vector of length 2 containing the line types for the third plot. See <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="iwc_+3A_...">...</code></td>
<td>
<p> further graphical parameters. See <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The parameters of the van Genuchten-Mualem Model can be estimated through the function <code>fitsoilwater()</code>. 
The soil penetration resistance model is given by: <code class="reqn">PR = a*h^b</code>, where <code class="reqn">h</code> is the soil water content
and <code class="reqn">a</code> and <code class="reqn">b</code> are the fitting parameters.
</p>


<h3>Value</h3>

<p>A table containing each integration of IWC (integral water capacity, in m/m) and EI (integral energy calculation, in J/kg).
</p>


<h3>Author(s)</h3>

<p>Anderson Rodrigo da Silva &lt;anderson.agro@hotmail.com&gt;
</p>


<h3>References</h3>

<p>Asgarzadeh, H.; Mosaddeghi, M.R.; Nikbakht, A.M. (2014) SAWCal: A user-friendly program for 
calculating soil available water quantities and physical quality indices. 
<em>Computers and Electronics in Agriculture</em>, 109:86&ndash;93.
</p>
<p>Groenevelt, P.H.; Grant, C.D.; Semetsa, S. (2001) A new procedure to determine soil water availability.
<em>Australian Journal Soil Research</em>, 39:577&ndash;598.
</p>
<p>Groenevelt, P.H., Grant, C.D., Murray, R.S. (2004) On water availability in saline soils. 
<em>Australian Journal Soil Research</em>, 42:833&ndash;840.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+soilwater">soilwater</a></code>, <code><a href="#topic+fitsoilwater">fitsoilwater</a></code>, <code><a href="#topic+llwr">llwr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># example 1 (Fig 1b, Asgarzadeh et al., 2014)
iwc(theta_R = 0.0160, theta_S = 0.4828, alpha = 0.0471, n = 1.2982, 
	a = 0.2038, b = 0.2558, graph = TRUE) 

# example 2 (Table 1, Asgarzadeh et al., 2014)
iwc(theta_R = 0.166, theta_S = 0.569, alpha = 0.029, n = 1.308, 
	a = 0.203, b = 0.256, graph = TRUE) 

# example 3: evaluating the salinity effect
iwc(theta_R = 0.166, theta_S = 0.569, alpha = 0.029, n = 1.308, 
	a = 0.203, b = 0.256, hos = 200, graph = TRUE)

# End (Not run)
</code></pre>

<hr>
<h2 id='Kr_h'> Unsaturated Hydraulic Conductivity </h2><span id='topic+Kr_h'></span>

<h3>Description</h3>

<p> A closed-form analytical expressions for calculating the relative unsaturated hydraulic conductivity as a function of 
soil water tension (h) based on van Genuchten's water retention curve. </p>


<h3>Usage</h3>

<pre><code class='language-R'>Kr_h(Ks, alpha, n, h, f=0.5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Kr_h_+3A_ks">Ks</code></td>
<td>
<p> Saturated hydraulic conductivity (e.g. cm/day). </p>
</td></tr>
<tr><td><code id="Kr_h_+3A_alpha">alpha</code></td>
<td>
<p> The scale parameter of the van Genuchten's model (hPa^-1). </p>
</td></tr>
<tr><td><code id="Kr_h_+3A_n">n</code></td>
<td>
<p> The shape parameter in van Genuchten's formula. </p>
</td></tr>
<tr><td><code id="Kr_h_+3A_h">h</code></td>
<td>
<p> The water tension (hPa). </p>
</td></tr>
<tr><td><code id="Kr_h_+3A_f">f</code></td>
<td>
<p> The pore-connectivity parameter. Default 0.5  [Mualem, 1976]. </p>
</td></tr>
</table>


<h3>Value</h3>

<p> numeric, the value of unsaturated hydraulic conductivity. </p>


<h3>Author(s)</h3>

<p> Renato Paiva de Lima &lt;renato_agro_@hotmail.com&gt; </p>


<h3>References</h3>

<p>Guarracino, L. (2007). Estimation of saturated hydraulic conductivity Ks from the van Genuchten 
shape parameter alpha. <em>Water Resources Research</em>, 43(11).
</p>
<p>Van Genuchten, M. T. (1980). A closed-form equation for predicting the hydraulic conductivity of 
unsaturated soils 1. <em>Soil Science Society of America Journal</em> 44(5):892-898.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># EXAMPLE 1
Kr_h(Ks = 1.06*10^2, alpha = 0.048, n = 1.5,h=100, f=0.5)

# EXAMPLE 2
x &lt;- seq(log10(1), log10(1000),len=100)
h &lt;- 10^x
y &lt;- Kr_h(Ks = 1.06*10^2, alpha = 0.048, n = 1.5,h=h, f=0.5)
plot(x=h,y=y, log="yx", xlab="h (hPa)", yaxt='n',
    ylab="", ylim=c(0.001,100), xlim=c(1,10000))
mtext(expression(K[r] ~ (cm~d^-1)), 2, line=2)
ax &lt;- c(0.001, 0.01, 0.1, 1, 10, 100)
axis(2,at=ax, labels=ax)

# End (not run)
</code></pre>

<hr>
<h2 id='Kr_theta'> Unsaturated Hydraulic Conductivity as a function of water content</h2><span id='topic+Kr_theta'></span>

<h3>Description</h3>

<p> A closed-form analytical expressions for calculating the relative unsaturated hydraulic conductivity as a function of 
soil water content based on van Genuchten's water retention curve. </p>


<h3>Usage</h3>

<pre><code class='language-R'>Kr_theta(theta, thetaS, thetaR, n, Ks, f=0.5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Kr_theta_+3A_theta">theta</code></td>
<td>
<p> The volumetric water content (m^3/m^3). </p>
</td></tr>
<tr><td><code id="Kr_theta_+3A_thetas">thetaS</code></td>
<td>
<p> The volumetric water content at the saturation (m^3/m^3). </p>
</td></tr>
<tr><td><code id="Kr_theta_+3A_thetar">thetaR</code></td>
<td>
<p> The volumetric residual water content (m^3/m^3). </p>
</td></tr>
<tr><td><code id="Kr_theta_+3A_n">n</code></td>
<td>
<p> The shape parameter in van Genuchten's formula. </p>
</td></tr>
<tr><td><code id="Kr_theta_+3A_ks">Ks</code></td>
<td>
<p> Saturated hydraulic conductivity (e.g. cm/day). </p>
</td></tr>
<tr><td><code id="Kr_theta_+3A_f">f</code></td>
<td>
<p> The pore-connectivity parameter. Default 0.5  [Mualem, 1976]. </p>
</td></tr>
</table>


<h3>Value</h3>

<p> numeric, the value of unsaturated hydraulic conductivity. </p>


<h3>Author(s)</h3>

<p> Renato Paiva de Lima &lt;renato_agro_@hotmail.com&gt; </p>


<h3>References</h3>

<p>Guarracino, L. (2007). Estimation of saturated hydraulic conductivity Ks from the van Genuchten 
shape parameter alpha. <em>Water Resources Research</em>, 43(11).
</p>
<p>Van Genuchten, M. T. (1980). A closed-form equation for predicting the hydraulic conductivity of 
unsaturated soils. <em>Soil Science Society of America Journal</em> 44(5):892-898.
</p>
<p>Mualem, Y. (1976). A new model for predicting the hydraulic conductivity of unsaturated porous 
media. <em>Water Resour. Res.</em> 43(11):  513-522,
</p>


<h3>Examples</h3>

<pre><code class='language-R'># EXAMPLE 1
Kr_theta(theta=0.45,thetaS=0.5,thetaR=0.15, 
         n = 2, Ks = 1.06*10^2, f=0.5)

# EXAMPLE 2
thetaS &lt;- 0.50
thetaR &lt;- 0.15
theta &lt;- seq(thetaS, thetaR, len=50)
y &lt;- Kr_theta(theta=theta,thetaS=thetaS,thetaR=thetaR, 
             n = 2, Ks = 1.06*10^2, f=0.5)
             
# Just for this example, we are removing the "0" value 
# for plotting the graph in log scale, sence log10(0) results in "-Inf"
Kr &lt;- y[-50]
w &lt;- theta[-50]

plot(x=w,y=Kr,xlab=expression(theta~(m^3~m^-3)),
     ylim=c(0.001,100), log="y",yaxt='n',
     ylab="", xlim=c(0.15,0.50))
mtext(expression(K[r] ~ (cm~d^-1)), 2, line=2)
ax &lt;- c(0.001, 0.01, 0.1, 1, 10, 100)
axis(2,at=ax, labels=ax)

# End (not run)
</code></pre>

<hr>
<h2 id='liquidlimit'> Soil Liquid Limit </h2><span id='topic+liquidlimit'></span>

<h3>Description</h3>

<p>Function to determine the soil Liquid Limit by using the Sowers (1965) method.
</p>
<p style="text-align: center;"><code class="reqn">LL = \theta * (n / 25) ^ {0.12}</code>
</p>
<p>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> liquidlimit(theta, n) </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="liquidlimit_+3A_theta">theta</code></td>
<td>
<p> the soil mositure value corresponding to <code>n</code> drops. </p>
</td></tr>
<tr><td><code id="liquidlimit_+3A_n">n</code></td>
<td>
<p> the number of drops. </p>
</td></tr>
</table>


<h3>Value</h3>

<p> The soil moisture value corresponding to the Liquid Limit. </p>


<h3>Author(s)</h3>

<p> Anderson Rodrigo da Silva &lt;anderson.agro@hotmail.com&gt; </p>


<h3>References</h3>

<p>Sowers, G. F. (1965). Consistency. In: BLACK, C.A. (Ed.). <em>Methods of soil analysis</em>.
Madison: American Society of Agronomy. Part 1, p.391-399. (Agronomy, 9).
</p>
<p>Sowers, G. F. (1965). Consistency. In: KLUTE, A. (Ed.). 2 ed. <em>Methods of soil analysis</em>.
Madison: American Society of Agronomy. Part 1, p.545-566.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+criticalmoisture">criticalmoisture</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>liquidlimit(theta = 0.34, n = 22)

M &lt;- c(0.34, 0.29, 0.27, 0.25, 0.20)
N &lt;- c(22, 24, 25, 26, 28)
liquidlimit(theta = M, n = N)

# End (not run)
</code></pre>

<hr>
<h2 id='llwr'>Least Limiting Water Range (LLWR)</h2><span id='topic+llwr'></span>

<h3>Description</h3>

<p>Graphical solution for the Least Limiting Water Range
and parameter estimation of the related water retention and penetration resistance curves.
A summary containing standard errors and statistical significance of the parameters is also given.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>llwr(theta, h, Bd, Pr, 
    particle.density, air, 
    critical.PR, h.FC, h.WP, 
    water.model = c("Silva", "Ross"), 
    Pr.model = c("Busscher", "noBd"),
    pars.water = NULL, pars.Pr = NULL, 
    graph = TRUE, graph2 = TRUE, 
    xlab = expression(Bulk~Density~(Mg~m^{-3})), 
    ylab = expression(theta~(m^{3}~m^{-3})), 
    main = "Least Limiting Water Range", ...) 
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="llwr_+3A_theta">theta</code></td>
<td>
<p>a numeric vector containing values of volumetric water content (<code class="reqn">m^3~m^{-3}</code>).</p>
</td></tr>
<tr><td><code id="llwr_+3A_h">h</code></td>
<td>
<p>a numeric vector containing values of matric head (cm, Psi, MPa, kPa, ...).</p>
</td></tr>
<tr><td><code id="llwr_+3A_bd">Bd</code></td>
<td>
<p>a numeric vector containing values of dry bulk density (<code class="reqn">Mg~m^{-3}</code>).
Note that <code>Bd</code> can also be a vector of length 1. See details.</p>
</td></tr>
<tr><td><code id="llwr_+3A_pr">Pr</code></td>
<td>
<p>a numeric vector containing values of penetration resistance (MPa, kPa, ...).</p>
</td></tr>
<tr><td><code id="llwr_+3A_particle.density">particle.density</code></td>
<td>
<p>the value of the soil particle density (<code class="reqn">Mg~m^{-3}</code>).</p>
</td></tr>
<tr><td><code id="llwr_+3A_air">air</code></td>
<td>
<p>the value of the limiting volumetric air content (<code class="reqn">m^3~m^{-3}</code>).</p>
</td></tr>
<tr><td><code id="llwr_+3A_critical.pr">critical.PR</code></td>
<td>
<p>the value of the critical soil penetration resistance.</p>
</td></tr>
<tr><td><code id="llwr_+3A_h.fc">h.FC</code></td>
<td>
<p>the value of matric head at the field capacity (cm, MPa, kPa, hPa, ...).</p>
</td></tr>
<tr><td><code id="llwr_+3A_h.wp">h.WP</code></td>
<td>
<p>the value of matric head at the wilting point (cm, MPa, kPa, hPa, ...).</p>
</td></tr>
<tr><td><code id="llwr_+3A_water.model">water.model</code></td>
<td>
<p>a character; the model to be used for calculating the soil water content. It must be one of the
two: <code>"Silva"</code> (default) or <code>"Ross"</code>. See details.</p>
</td></tr>
<tr><td><code id="llwr_+3A_pr.model">Pr.model</code></td>
<td>
<p>a character; the model to be used to predict soil penetration resistance. It must be one of the two: 
<code>"Busscher"</code> (default) or <code>"noBd"</code>. See details.</p>
</td></tr>
<tr><td><code id="llwr_+3A_pars.water">pars.water</code></td>
<td>
<p>optional; a numeric vector containing the estimates of the three parameters of the soil water retention 
model employed. If <code>NULL</code> (default), <code>llwr()</code> estimates them using a Newton-Raphson algorithm. See details.</p>
</td></tr>
<tr><td><code id="llwr_+3A_pars.pr">pars.Pr</code></td>
<td>
<p>optional; a numeric vector containing estimates of the three parameters of the model proposed by 
Busscher (1990) for the functional relationship among <code>Pr</code>, <code>theta</code> and <code>Bd</code>. If NULL (default), 
<code>llwr()</code> estimates them using a Newton-Raphson algorithm. Moreover, if <code>Pr.model = "noBd"</code>, then the 
third value is considered to be null.</p>
</td></tr>
<tr><td><code id="llwr_+3A_graph">graph</code></td>
<td>
<p>logical; if TRUE (default) a graphical solution for the Least Limiting Water Range is plotted.</p>
</td></tr>
<tr><td><code id="llwr_+3A_graph2">graph2</code></td>
<td>
<p>logical; if TRUE (default) a line of the Least Limiting Water Range as a function of bulk density is plotted. 
If <code>graph = FALSE</code>, then <code>llwr()</code> will automatically consider <code>graph2 = FALSE</code> too.</p>
</td></tr>
<tr><td><code id="llwr_+3A_xlab">xlab</code></td>
<td>
<p>a title for the x axis; the default is <code class="reqn">Bulk~Density~(Mg~m^{-3})</code>.</p>
</td></tr>
<tr><td><code id="llwr_+3A_ylab">ylab</code></td>
<td>
<p>a title for the y axis; the default is <code class="reqn">\theta~(m^{3}~m^{-3})</code>.</p>
</td></tr>
<tr><td><code id="llwr_+3A_main">main</code></td>
<td>
<p>a main title for the graphic; the default is &quot;Least Limiting Water Range&quot;</p>
</td></tr>
<tr><td><code id="llwr_+3A_...">...</code></td>
<td>
<p>further graphical arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The numeric vectors <code>theta</code>, <code>h</code>, <code>Bd</code> and <code>Pr</code> are supposed to have the same length,
and their values should have appropriate unit of measurement. For fitting purposes, it is not advisable to use
vectors with less than five values. It is possible to calculate the LLWR for a especific (unique) value of bulk 
density. In This case, <code>Bd</code> should be a vector of length 1 and, therfore, it is not possible to fit the 
models <code>"Silva"</code> and <code>"Busscher"</code>, for water content and penetration resistance, respectively.
</p>
<p>The model employed by Silva et al. (1994) for the soil water content (<code class="reqn">\theta</code>) as a function of the soil bulk density (<code class="reqn">\rho</code>) 
and the matric head (h) is:
</p>
<p style="text-align: center;"><code class="reqn">\theta = exp(a + b \rho)h^c</code>
</p>

<p>The model proposed by Ross et al. (1991) for the soil water content (<code class="reqn">\theta</code>) as a function of the matric head (h) is:
</p>
<p style="text-align: center;"><code class="reqn">\theta = a h^c</code>
</p>

<p>The penetration resistance model, as presented by Busscher (1990), is given by
</p>
<p style="text-align: center;"><code class="reqn">Pr = b0 * (\theta^{b1}) * (\rho^{b2})</code>
</p>

<p>If the agrument <code>Bd</code> receives a single value of bulk density, then <code>llwr()</code> fits the following simplified model (option <code>noBd</code>):
</p>
<p style="text-align: center;"><code class="reqn">Pr = b0 * \theta^{b1}</code>
</p>



<h3>Value</h3>

<p>A list of
</p>
<table role = "presentation">
<tr><td><code>limiting.theta</code></td>
<td>
<p>a <code class="reqn">n x 4</code> matrix containing the limiting values of water content for each input 
value of bulk density at the volumetric air content (<code>thetaA</code>), penetration resistance (<code>thetaPR</code>),
field capacity (<code>thetaFC</code>) and wilting point (<code>thetaWP</code>).</p>
</td></tr>
<tr><td><code>pars.water</code></td>
<td>
<p>a &quot;nls&quot; object or a numeric vector containing estimates of the three parameters of the model employed by 
Silva et al. (1994) for	the functional relationship among <code>theta</code>, <code>Bd</code> and <code>h</code>.</p>
</td></tr>
<tr><td><code>r.squared.water</code></td>
<td>
<p>a &quot;Rsq&quot; object containing the pseudo and the adjusted R-squared for the water model.</p>
</td></tr>
<tr><td><code>pars.Pr</code></td>
<td>
<p>a &quot;nls&quot; object or a numeric vector containing estimates of the three parameters of the penetration resistance model.</p>
</td></tr>
<tr><td><code>r.squared.Pr</code></td>
<td>
<p>a &quot;Rsq&quot; object containing the pseudo and the adjusted R-squared for the penetration resistance model.</p>
</td></tr>
<tr><td><code>area</code></td>
<td>
<p>numeric; the value of the shaded (LLWR) area. Calculated only when Bd is a vector of length &gt; 1.</p>
</td></tr>
<tr><td><code>LLWR</code></td>
<td>
<p>numeric; the value of LLWR (<code class="reqn">m^3~m^{-3}</code>) corresponding to <code>Bd</code>. Calculated only when Bd is a single value.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Anderson Rodrigo da Silva &lt;anderson.agro@hotmail.com&gt;
</p>


<h3>References</h3>

<p>Busscher, W. J. (1990). Adjustment of flat-tipped penetrometer resistance data to common water content. 
<em>Transactions of the ASAE</em>, 3:519-524.
</p>
<p>Leao et al. (2005). An Algorithm for Calculating the Least Limiting Water Range of Soils. 
<em>Agronomy Journal</em>, 97:1210-1215.
</p>
<p>Leao et al. (2006). Least limiting water range: A potential indicator of changes in near-surface 
soil physical quality after the conversion of Brazilian Savanna into pasture. 
<em>Soil &amp; Tillage Research</em>, 88:279-285.
</p>
<p>Ross et al. (1991). Equation for extending water-retention curves to dryness.
<em>Soil Science Society of America Journal</em>, 55:923-927. 
</p>
<p>Silva et al. (1994). Characterization of the least limiting water range of soils. 
<em>Soil Science Society of America Journal</em>, 58:1775-1781.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fitbusscher">fitbusscher</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1 - part of the data set used by Leao et al. (2005)
data(skp1994)
ex1 &lt;- with(skp1994,
	llwr(theta = W, h = h, Bd = BD, Pr = PR,
		particle.density = 2.65, air = 0.1,
		critical.PR = 2, h.FC = 100, h.WP = 15000))
ex1

# Example 2 - specifying the parameters (Leao et al., 2005)
a &lt;- c(-0.9175, -0.3027, -0.0835) # Silva et al. model of water content
b &lt;- c(0.0827, -1.6087, 3.0570)   # Busscher's model
ex2 &lt;- with(skp1994,
	llwr(theta = W, h = h, Bd = BD, Pr = PR,
		particle.density = 2.65, air = 0.1,
		critical.PR = 2, h.FC = 0.1, h.WP = 1.5,
		pars.water = a, pars.Pr = b))
ex2

# Example 3 - specifying a single value for Bd
ex3 &lt;- with(skp1994,
	llwr(theta = W, h = h, Bd = 1.45, Pr = PR,
		particle.density = 2.65, air = 0.1,
		critical.PR = 2, h.FC = 100, h.WP = 15000))
ex3

# End (not run)
</code></pre>

<hr>
<h2 id='LLWR_App'>A shiny for calculation of the usual least limiting water range</h2><span id='topic+LLWR_App'></span>

<h3>Description</h3>

<p>A shiny for calculation of the usual least limiting water range</p>


<h3>Usage</h3>

<pre><code class='language-R'>LLWR_App()
</code></pre>


<h3>Value</h3>

<p>A shiny app</p>


<h3>Author(s)</h3>

<p> Renato Paiva de Lima &lt;renato_agro_@hotmail.com&gt; </p>


<h3>See Also</h3>

<p><code><a href="#topic+stressTraffic">stressTraffic</a></code>
</p>

<hr>
<h2 id='llwr_llmpr'> Least Limiting Water (LLWR) and Matric Potential Ranges (LLMPR) </h2><span id='topic+llwr_llmpr'></span>

<h3>Description</h3>

<p>A graphical solution and calculation of the least limiting water range and least limiting water matric potential range, including 
the corresponding the water content and water tensions limits. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'> 
llwr_llmpr(thetaR, thetaS, alpha, n, d, e, f = NULL, critical.PR, PD, Bd = NULL, 
         h.FC, h.PWP, air.porosity,
         labels = c("AIR", "FC", "PWP", "PR"), ylab = "",
         graph1 = TRUE, graph2 = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="llwr_llmpr_+3A_thetar">thetaR</code></td>
<td>
<p> the residual water content, <code class="reqn">m^3 m^{-3}</code> </p>
</td></tr>
<tr><td><code id="llwr_llmpr_+3A_thetas">thetaS</code></td>
<td>
<p> the water content at saturation , <code class="reqn">m^3 m^{-3}</code> </p>
</td></tr>
<tr><td><code id="llwr_llmpr_+3A_alpha">alpha</code></td>
<td>
<p> the scale parameter of the van Genuchten's model, <code class="reqn">hPa^{-1}</code> </p>
</td></tr>
<tr><td><code id="llwr_llmpr_+3A_n">n</code></td>
<td>
<p> the shape parameter of the van Genuchten's model </p>
</td></tr>
<tr><td><code id="llwr_llmpr_+3A_d">d</code></td>
<td>
<p> a parameter of Busscher soil penetration resistance model. See details. </p>
</td></tr>
<tr><td><code id="llwr_llmpr_+3A_e">e</code></td>
<td>
<p> a parameter of Busscher soil penetration resistance model. See details. </p>
</td></tr>
<tr><td><code id="llwr_llmpr_+3A_f">f</code></td>
<td>
<p> a parameter of Busscher soil penetration resistance model. See details. </p>
</td></tr>
<tr><td><code id="llwr_llmpr_+3A_critical.pr">critical.PR</code></td>
<td>
<p> the limiting value of soil penetration resistance, MPa </p>
</td></tr>
<tr><td><code id="llwr_llmpr_+3A_pd">PD</code></td>
<td>
<p> particle density, <code class="reqn">Mg m^{-3}</code>  </p>
</td></tr>
<tr><td><code id="llwr_llmpr_+3A_bd">Bd</code></td>
<td>
<p> the bulk density to be displayed at bottom of the graph (optional), <code class="reqn">Mg m^{-3}</code> </p>
</td></tr>
<tr><td><code id="llwr_llmpr_+3A_h.fc">h.FC</code></td>
<td>
<p> the value of water tension at field capacity, hPa </p>
</td></tr>
<tr><td><code id="llwr_llmpr_+3A_h.pwp">h.PWP</code></td>
<td>
<p> the value of water tension at wilting point, hPa </p>
</td></tr>
<tr><td><code id="llwr_llmpr_+3A_air.porosity">air.porosity</code></td>
<td>
<p> the volumetric air-filled porosity </p>
</td></tr>
<tr><td><code id="llwr_llmpr_+3A_labels">labels</code></td>
<td>
<p> the labels to h.FC, h.PWP, air.porosity and critical.PR </p>
</td></tr>
<tr><td><code id="llwr_llmpr_+3A_ylab">ylab</code></td>
<td>
<p> a title for the y-axis </p>
</td></tr>
<tr><td><code id="llwr_llmpr_+3A_graph1">graph1</code></td>
<td>
<p> logical; if TRUE (default) a graphical solution for the Least Limiting Water Range is displayed </p>
</td></tr>
<tr><td><code id="llwr_llmpr_+3A_graph2">graph2</code></td>
<td>
<p> logical; if TRUE (default) a graphical solution for the Least Limiting Matric Potential Range is displayed </p>
</td></tr>
<tr><td><code id="llwr_llmpr_+3A_...">...</code></td>
<td>
<p> Further graphical arguments </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The penetration resistance model, as presented by Busscher (1990), is given by PR = d * <code class="reqn">\theta^{e} * BD^{f}</code>. 
In this model, BD (bulk density) is calculated from thetaS (soil total porosity) and PD (particles density), 
i.e., <code class="reqn">BD = PD * thetaS^{-1}</code>. If the argument f is not passed, the model becomes <code class="reqn">PR = d * \theta^{e}</code> .
</p>


<h3>Value</h3>

<p>A list of the LLWR and LLMPR, including the corresponding the water content and water tensions limits. 
</p>


<h3>Author(s)</h3>

<p>Renato Paiva de Lima &lt;renato_agro_@hotmail.com&gt;
</p>


<h3>References</h3>

<p>Leon, H. N., Almeida, B. G., Almeida, C. D. G. C., Freire, F. J., Souza, E. R., Oliveira, E. C. A., Silva, E. P. 2019. 
Medium-term influence of conventional tillage on the physical quality of a Typic Fragiudult with hardsetting behavior 
cultivated with sugarcane under rainfed conditions. <em>Catena</em>, 175: 37-46.
</p>
<p>Busscher, W. J. 1990. Adjustment of flat-tipped penetrometer resistance data to common water content. 
<em>Transactions of the ASAE</em>, 3: 519-524.
</p>
<p>van Genuchten, M. T. 1980. A closed-form equation for predicting the hydraulic conductivity of unsaturated soils 1. 
<em>Soil Science Society of America journal</em>, 44: 892-898.
</p>
<p>Silva et al. 1994. Characterization of the least limiting water range of soils. 
<em>Soil Science Society of America Journal</em>, 58: 1775-1781.
</p>
<p>Assouline, S., Or, D. 2014. The concept of field capacity revisited: Defining intrinsic static and dynamic criteria for soil internal drainage dynamics. 
<em>Water Resources Research</em>, 50: 4787-4802.
</p>
<p>Millington, R. J., Quirk, J. P. 1961. Permeability of porous solids. 
<em>Transactions of the Faraday Society</em>, 57: 1200-1207.
</p>
<p>Dexter, A. R., Czyz, E. A., Richard, G. 2012. Equilibrium, non-equilibrium and residual water: consequences for soil water retention. 
<em>Geoderma</em>, 177: 63-71.
</p>
<p>Moraes, M. T., Bengough, A. G., Debiasi, H., Franchini, J. C., Levien, R., Schnepf, A., Leitner, D., 2018. Mechanistic framework to link root 
growth models with weather and soil physical properties, including example applications to soybean growth in Brazil. 
<em>Plant and Soil</em>, 428: 67-92.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Parameters from Leon et al. (2018), for usual physical restrictions threshold
  
  llwr_llmpr(thetaR=0.1180, thetaS=0.36, alpha=0.133, n=1.30, 
        d=0.005, e=-2.93, f=3.54, PD=2.65,
        critical.PR=4, h.FC=100, h.PWP=15000, air.porosity=0.1,
        labels=c("AFP", "FC","PWP", "PR"),
        graph1=TRUE,graph2=FALSE, ylab=expression(psi~(hPa)), ylim=c(15000,1))
  mtext(expression("Bulk density"~(Mg~m^-3)),1,line=2.2, cex=0.8)

  llwr_llmpr(thetaR=0.1180, thetaS=0.36, alpha=0.133, n=1.30, 
        d=0.005, e=-2.93, f=3.54, PD=2.65,
        critical.PR=4, h.FC=100, h.PWP=15000, air.porosity=0.1,
        graph1=FALSE,graph2=TRUE,
        labels=c("Air-filled porosity", "Field capacity", 
                "Permanent wilting point", "Penetration resistance"),
        ylim=c(0.1,0.30), ylab=expression(theta~(m^3~m^-3)))
  mtext(expression("Bulk density"~(Mg~m^-3)),1,line=2.2, cex=0.8)


# Without bulk density effects in Busscher's model (i.e. f=NULL)
 
  llwr_llmpr(thetaR=0.1180, thetaS=0.36, alpha=0.133, n=1.30, 
        d=0.0165, e=-2.93, PD=2.65,
        critical.PR=3, h.FC=100, h.PWP=15000, air.porosity=0.1,
        graph1=TRUE,graph2=FALSE,ylim=c(15000,1),
        ylab=expression(psi~(hPa)))
  mtext(expression("Bulk density"~(Mg~m^-3)),1,line=2.2, cex=0.8)

  llwr_llmpr(thetaR=0.1180, thetaS=0.36, alpha=0.133, n=1.30, 
        d=0.0165, e=-2.93, PD=2.65,
        critical.PR=3, h.FC=100, h.PWP=15000,air.porosity=0.1,
        graph1=FALSE,graph2=TRUE,
        ylim=c(0.1,0.30), ylab=expression(theta~(m^3~m^-3)))
  mtext(expression("Bulk density"~(Mg~m^-3)),1,line=2.2, cex=0.8)


# Parameters from Leon et al. (2018), calculated physical restrictions threshold

  thetaR &lt;- 0.1180
  thetaS &lt;- 0.36
  alpha &lt;- 0.133
  n &lt;- 1.30 
  clay.content &lt;- 15 # clay content 15 %
  mim.gas.difusion &lt;- 0.005
  root.elongation.rate &lt;- 0.3 # root elogation rate 30%

  FC &lt;- (1/alpha)*((n-1)/n)^((1-2*n)/n) # Assouline and Or (2014)
  PWP &lt;- 10^(3.514 + 0.0250*clay.content) # Dexter et al. (2012)
  AIR.critical &lt;-  (mim.gas.difusion*(thetaS)^2)^(1/(10/3)) # Millington and Quirk (1961)
  PR.critical &lt;- log(root.elongation.rate)/-0.4325 # Moraes et al. (2018)

  llwr_llmpr(thetaR=thetaR, thetaS=thetaS, alpha=alpha, n=n, 
        d=0.005, e=-2.93, f=3.54, PD=2.65,ylim=c(15000,1),
        critical.PR=PR.critical, h.FC=FC, h.PWP=PWP, air.porosity=AIR.critical,
        graph1=TRUE,graph2=FALSE, ylab=expression(psi~(hPa)))
  mtext(expression("Bulk density"~(Mg~m^-3)),1,line=2.2, cex=0.8)

  llwr_llmpr(thetaR=thetaR, thetaS=thetaS, alpha=alpha, n=n, 
        d=0.005, e=-2.93, f=3.54, PD=2.65,
        critical.PR=PR.critical, h.FC=FC, h.PWP=PWP, air.porosity=AIR.critical,
        graph1=FALSE,graph2=TRUE,
        ylim=c(0.1,0.30), ylab=expression(theta~(m^3~m^-3)))
  mtext(expression("Bulk density"~(Mg~m^-3)),1,line=2.2, cex=0.8)

# End (not run)
</code></pre>

<hr>
<h2 id='LLWR_LLMPR_App'>A shiny for calculation of least limiting water and matric potential ranges of agricultural soils with calculated physical restriction thresholds</h2><span id='topic+LLWR_LLMPR_App'></span>

<h3>Description</h3>

<p>A shiny for calculation of least limiting water and matric potential ranges of agricultural soils with calculated physical restriction thresholds</p>


<h3>Usage</h3>

<pre><code class='language-R'>LLWR_LLMPR_App()
</code></pre>


<h3>Value</h3>

<p>A shiny app</p>


<h3>Author(s)</h3>

<p> Renato Paiva de Lima &lt;renato_agro_@hotmail.com&gt; </p>


<h3>See Also</h3>

<p><code><a href="#topic+stressTraffic">stressTraffic</a></code>
</p>

<hr>
<h2 id='llwrPTF'> Least Limiting Water Range (LLWR) Using Pedo-Transfer Functions </h2><span id='topic+llwrPTF'></span>

<h3>Description</h3>

<p>It calculates Least Limiting Water Range (LLWR) using pedo-transfer functions in according to Silva \&amp; Kay (1997) and Silva et al. (2008), for Canadian and Brazilian soils, respectively.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> 
llwrPTF(air, critical.PR, h.FC, h.WP, p.density, Bd, clay.content, org.carbon = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="llwrPTF_+3A_air">air</code></td>
<td>
<p> the value of the limiting volumetric air content, <code class="reqn">m^3 m^{-3}</code> </p>
</td></tr>
<tr><td><code id="llwrPTF_+3A_critical.pr">critical.PR</code></td>
<td>
<p> the value of the critical soil penetration resistance, MPa </p>
</td></tr>
<tr><td><code id="llwrPTF_+3A_h.fc">h.FC</code></td>
<td>
<p> the value of matric suction at the field capacity, hPa </p>
</td></tr>
<tr><td><code id="llwrPTF_+3A_h.wp">h.WP</code></td>
<td>
<p> the value of matric suction at the wilting point, hPa </p>
</td></tr>
<tr><td><code id="llwrPTF_+3A_p.density">p.density</code></td>
<td>
<p> the value of the soil particle density, <code class="reqn">Mg m^{-3}</code> </p>
</td></tr>
<tr><td><code id="llwrPTF_+3A_bd">Bd</code></td>
<td>
<p> a numeric vector containing values of dry bulk density, <code class="reqn">Mg m^{-3}</code>. Note that Bd can also be a vector of length 1. </p>
</td></tr>
<tr><td><code id="llwrPTF_+3A_clay.content">clay.content</code></td>
<td>
<p> a numeric vector containing values of clay content to each bulk density, <code class="reqn">\%</code> </p>
</td></tr>
<tr><td><code id="llwrPTF_+3A_org.carbon">org.carbon</code></td>
<td>
<p> a numeric vector containing values of organic carbon to each bulk density, <code class="reqn">\%</code>, for Canadian soils. Default is 2<code class="reqn">\%</code>. See details. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that org.carbon is only required for Canadian soil. If it is not passed, LLWR for Canadian soil is calculated with 2<code class="reqn">\%</code> of organic carbon.
</p>


<h3>Value</h3>

<p>A list of
</p>
<table role = "presentation">
<tr><td><code>LLWR.B</code></td>
<td>
<p> LLWR for Brazilian soils </p>
</td></tr>
<tr><td><code>LLWR.C</code></td>
<td>
<p> LLWR for Canadian soils </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Renato Paiva de Lima &lt;renato_agro_@hotmail.com&gt;
</p>
<p>Anderson Rodrigo da Silva &lt;anderson.agro@hotmail.com&gt;
</p>
<p>Alvaro Pires da Silva &lt;apisilva@usp.br&gt;
</p>


<h3>References</h3>

<p>Keller, T; Silva, A.P.; Tormena, C.A.; Giarola, N.B.F., Cavalieri, K.M.V., Stettler, M.; Arvidsson, J. 2015. 
SoilFlex-LLWR: linking a soil compaction model with the least limiting water range concept. <em>Soil Use and Management</em>, 31:321-329.
</p>
<p>Silva, A.P.; Kay, B.D. 1997. Estimating the least limiting water range of soil from properties and management. 
<em>Soil Science Society of America Journal</em>, 61:877-883.
</p>
<p>Silva, A.P., Kay, B.D.; Perfect, E. 1994. Characterization of the least limiting water range. 
<em>Soil Science Society of America Journal</em>, 61:877-883.
</p>
<p>Silva, A.P., Tormena, C.A., Jonez, F.; Imhoff, S. 2008. Pedotransfer functions for the soil water retention and soil resistance 
to penetration curves. <em>Revista Brasileira de Ciencia do Solo</em>, 32:1-10.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># EXEMPLE 1 (for Brazilian Soils) 
llwrPTF(air=0.1,critical.PR=2, h.FC=100, h.WP=15000,p.density=2.65,
        Bd=c(1.2,1.3,1.4,1.5,1.35),clay.content=c(30,30,35,38,40))

# EXEMPLE 2 (for Canadian Soils)
llwrPTF(air=0.1,critical.PR=2, h.FC=100, h.WP=15000,p.density=2.65,
        Bd=c(1.2,1.3,1.4),clay.content=c(30,30,30), org.carbon=c(1.3,1.5,2))

# EXEMPLE 3 (combining it with soil stress)
stress &lt;- stressTraffic(inflation.pressure=200, 
	        recommended.pressure=200, 
	        tyre.diameter=1.8, 
	        tyre.width=0.4, 
	        wheel.load=4000, 
	        conc.factor=c(4,5,5,5,5,5),
                layers=c(0.05,0.1,0.3,0.5,0.7,1), 
	        plot.contact.area = FALSE)

stress.p &lt;- stress$Stress$sigma_mean
layers &lt;- stress$Stress$Layers
n &lt;- length(layers)
def &lt;- soilDeformation(stress = stress.p,
                p.density = rep(2.67,n),
	          iBD = rep(1.55,n), 
                N = rep(1.9392,n), 
                CI = rep(0.06037,n), 
                k = rep(0.00608,n), 
                k2 = rep(0.01916,n),
                m = rep(1.3,n),graph=TRUE,ylim=c(1.4,1.8))

# Grapth LLWR, considering Brazilian soils
plot(x = 1, y = 1, 
     xlim=c(0,0.2),ylim=c(1,0),xaxt = "n",
     ylab = "Soil Depth",xlab ="", type="l", main="")
axis(3)
mtext("LLWR",side=3,line=2.5)

i.LLWR &lt;- llwrPTF(air=0.1,critical.PR=2, h.FC=100, 
                        h.WP=15000,p.density=2.65,
                        Bd=def$iBD,clay.content=rep(20,n))
f.LLWR &lt;- llwrPTF(air=0.1,critical.PR=2, h.FC=100, 
                        h.WP=15000,p.density=2.65,
                        Bd=def$fBD,clay.content=rep(20,n))

points(x=i.LLWR$LLWR.B, y=layers, type="l"); points(x=i.LLWR$LLWR.B, y=layers,pch=15)
points(x=f.LLWR$LLWR.B, y=layers, type="l", col=2); points(x=f.LLWR$LLWR.B, y=layers,pch=15, col=2)

# End (not run)
</code></pre>

<hr>
<h2 id='maxcurv'> Maximum Curvature Point </h2><span id='topic+maxcurv'></span>

<h3>Description</h3>

<p>Function to determine the maximum curvature point of an univariate nonlinear
function of x.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> maxcurv(x.range, fun, 
	method = c("general", "pd", "LRP", "spline"), 
	x0ini = NULL, 
	graph = TRUE, ...) 
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="maxcurv_+3A_x.range">x.range</code></td>
<td>
<p> a numeric vector of length two, the range of x. </p>
</td></tr>
<tr><td><code id="maxcurv_+3A_fun">fun</code></td>
<td>
<p> a function of x; it must be a one-line-written function, with no curly braces '{}'. </p>
</td></tr>
<tr><td><code id="maxcurv_+3A_method">method</code></td>
<td>
<p> a character indicating one of the following: &quot;general&quot; - for evaluating the general 
curvature function (<em>k</em>), &quot;pd&quot; - for evaluating perpendicular distances from a secant line,
&quot;LRP&quot; - a NLS estimate of the maximum curvature point as the breaking point of Linear Response Plateau model,
&quot;spline&quot; - a NLS estimate of the maximum curvature point as the breaking point of a piecewise linear spline.
See details.</p>
</td></tr>
<tr><td><code id="maxcurv_+3A_x0ini">x0ini</code></td>
<td>
<p> an initial <em>x</em>-value for the maximum curvature point. Required only when &quot;LRP&quot; or &quot;spline&quot; are used.</p>
</td></tr>
<tr><td><code id="maxcurv_+3A_graph">graph</code></td>
<td>
<p> logical; if TRUE (default) a curve of <code>fun</code> is plotted. </p>
</td></tr>
<tr><td><code id="maxcurv_+3A_...">...</code></td>
<td>
<p> further graphical arguments. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The method &quot;LRP&quot; can be understood as an especial case of &quot;spline&quot;. And both models are fitted via <code><a href="stats.html#topic+nls">nls</a></code>.
The method &quot;pd&quot; is an adaptation of the method proposed by Lorentz et al. (2012). The &quot;general&quot; method should be 
preferred for finding <em>global</em> points. On the other hand, &quot;pd&quot;, &quot;LRP&quot; and &quot;spline&quot; are suitable for finding 
<em>local</em> points of maximum curvature.
</p>


<h3>Value</h3>

<p>A list of
</p>
<table role = "presentation">
<tr><td><code>fun</code></td>
<td>
<p> the function of x. </p>
</td></tr>
<tr><td><code>x0</code></td>
<td>
<p> the x critical value. </p>
</td></tr>
<tr><td><code>y0</code></td>
<td>
<p> the y critical value. </p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p> the method of determination (input). </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Anderson Rodrigo da Silva &lt;anderson.agro@hotmail.com&gt; </p>


<h3>References</h3>

<p>Lorentz, L.H.; Erichsen, R.; Lucio, A.D. (2012). Proposal method for plot size estimation in crops. 
<em>Revista Ceres</em>, 59:772&ndash;780. 
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+function">function</a></code>, <code><a href="graphics.html#topic+curve">curve</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1: an exponential model
f &lt;- function(x) exp(-x)
maxcurv(x.range = c(-2, 5), fun = f)

# Example 2: Gompertz Growth Model
Asym &lt;- 8.5
b2 &lt;- 2.3
b3 &lt;- 0.6
g &lt;- function(x) Asym * exp(-b2 * b3 ^ x)
maxcurv(x.range = c(-5, 20), fun = g)

# using "pd" method
maxcurv(x.range = c(-5, 20), fun = g, method = "pd")

# using "LRP" method
maxcurv(x.range = c(-5, 20), fun = g, method = "LRP", x0ini = 6.5)

# Example 3: Lessman &amp; Atkins (1963) model for optimum plot size
a = 40.1
b = 0.72
cv &lt;- function(x) a * x^-b
maxcurv(x.range = c(1, 50), fun = cv)

# using "spline" method
maxcurv(x.range = c(1, 50), fun = cv, method = "spline", x0ini = 6)

# End (not run)
</code></pre>

<hr>
<h2 id='particle.sedimentation'> Sedimentation time of soil particles in aqueous media </h2><span id='topic+particle.sedimentation'></span>

<h3>Description</h3>

<p>It calculates the sedimentation time of soil particle in aqueous media using Stokes equation, i.e., 
the time needed for the particles of soil larger than the size attributed as input to sediment in aqueous 
media, usually water.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>particle.sedimentation(d, h=0.2, g=9.81, v=0.001, Pd=2650, Wd=1000) 
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="particle.sedimentation_+3A_d">d</code></td>
<td>
<p> the lower limit of soil particle diameter (micrometers) to sediment withing the calculated time. </p>
</td></tr>
<tr><td><code id="particle.sedimentation_+3A_h">h</code></td>
<td>
<p> the vertical distance (meters) from which the particles fall. Default is 0.2 m. </p>
</td></tr>
<tr><td><code id="particle.sedimentation_+3A_g">g</code></td>
<td>
<p> the acceleration of gravity, in m/s^2. Default is 9.81 m/s^2. </p>
</td></tr>
<tr><td><code id="particle.sedimentation_+3A_v">v</code></td>
<td>
<p> the viscosity of the fluid, in N/s/m^2. Default is 0.001 N/s/m^2, for water at 20 degrees Celsius. </p>
</td></tr>
<tr><td><code id="particle.sedimentation_+3A_pd">Pd</code></td>
<td>
<p> the particle density, in kg/m^3. Default is 2650 kg/m^3. </p>
</td></tr>
<tr><td><code id="particle.sedimentation_+3A_wd">Wd</code></td>
<td>
<p> the density of the fluid, in kg/m^3. Default is 1000 kg/m^3.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.frame</code> containing the estimated time for the sedimentation of particles.
</p>


<h3>Author(s)</h3>

<p> Renato Paiva de Lima &lt;renato_agro_@hotmail.com&gt; </p>


<h3>References</h3>

<p>Hillel, D. (2003). <em>Introduction to environmental soil physics</em>. Elsevier. p.39-51. Doi:10.1016/B978-012348655-4/50004-6
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1
particle.sedimentation(d=2, h=0.2, g=9.81, v=1.002*10^-3, Pd=2650, Wd=1000) 

# Example 2
d &lt;- c(2000, 200, 50, 10, 2, 1)
time &lt;- particle.sedimentation(d=d, h=0.2, g=9.81, v=1.002*10^-3, Pd=2650, Wd=1000) 

plot(x=d, y=time$hours, log = "x", xaxt ="n", 
     ylab = "time of sedimentation (hours)", xlab = "particle diameter (micrometer)")
axis(1,at=d, labels=d)

# End (not run)
</code></pre>

<hr>
<h2 id='particle.sedimentation_App'>A shiny for time of particle sedimentation</h2><span id='topic+particle.sedimentation_App'></span>

<h3>Description</h3>

<p>A shiny for time of particle sedimentation</p>


<h3>Usage</h3>

<pre><code class='language-R'>particle.sedimentation_App()
</code></pre>


<h3>Value</h3>

<p>A shiny app</p>


<h3>Author(s)</h3>

<p> Renato Paiva de Lima &lt;renato_agro_@hotmail.com&gt; </p>


<h3>See Also</h3>

<p><code><a href="#topic+stressTraffic">stressTraffic</a></code>
</p>

<hr>
<h2 id='plotCIsigmaP'> Percentile Confidence Intervals for Simulated Preconsolidation Stress </h2><span id='topic+plotCIsigmaP'></span>

<h3>Description</h3>

<p>Build and plot percentile confidence intervals for preconsolidation stress simulated from
<code><a href="#topic+simSigmaP">simSigmaP</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotCIsigmaP(msim, conf.level = 0.95, shade.col = "orange", 
	ordered = TRUE, xlim = NULL, xlab = expression(sigma[P]), 
	las = 1, mar = c(4.5, 6.5, 2, 1), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotCIsigmaP_+3A_msim">msim</code></td>
<td>
<p> an object of class <code>"simSigmaP"</code>.</p>
</td></tr>
<tr><td><code id="plotCIsigmaP_+3A_conf.level">conf.level</code></td>
<td>
<p> the confidence level for the intervals.</p>
</td></tr>
<tr><td><code id="plotCIsigmaP_+3A_shade.col">shade.col</code></td>
<td>
<p> a character or number indicating the color of the shaded area delimiting each CI. 
See <code><a href="grDevices.html#topic+colors">colors</a></code>.</p>
</td></tr>
<tr><td><code id="plotCIsigmaP_+3A_ordered">ordered</code></td>
<td>
<p> logical; should the intervals be displayed according to the value of the simulated mean?</p>
</td></tr>
<tr><td><code id="plotCIsigmaP_+3A_xlim">xlim</code></td>
<td>
<p> optional; a numeric vector of length two containing the limits of the <em>x</em>-axis.</p>
</td></tr>
<tr><td><code id="plotCIsigmaP_+3A_xlab">xlab</code></td>
<td>
<p> optional; a character indicating the <em>x</em>-axis label.</p>
</td></tr>
<tr><td><code id="plotCIsigmaP_+3A_las">las</code></td>
<td>
<p> optional; see <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="plotCIsigmaP_+3A_mar">mar</code></td>
<td>
<p> optional; see <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="plotCIsigmaP_+3A_...">...</code></td>
<td>
<p> further graphical parameters; see <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric matrix containing the simulated mean, coefficient of variation, 
lower and upper CI limits and the name of the method used to calculate
the preconsolidation stress.
</p>


<h3>Author(s)</h3>

<p>Anderson Rodrigo da Silva &lt;anderson.agro@hotmail.com&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+simSigmaP">simSigmaP</a></code>, <code><a href="#topic+sigmaP">sigmaP</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># input data: stress and void ratio
pres &lt;- c(1, 12.5, 25, 50, 100, 200, 400, 800, 1600)
VR &lt;- c(1.43, 1.41, 1.40, 1.39, 1.35, 1.31, 1.25, 1.18, 1.12)

# simulation (may take a few seconds)
simres &lt;- simSigmaP(VR, pres, nsim = 30)
head(simres)

# percentile confidence intervals
ci &lt;- plotCIsigmaP(simres, conf.level = 0.95, 
	shade.col = "blue", ordered = TRUE)
print(ci)

# End (Not run)
</code></pre>

<hr>
<h2 id='PredComp'>A shiny for simulation of soil compaction</h2><span id='topic+PredComp'></span>

<h3>Description</h3>

<p>A shiny for for simulation of soil compaction</p>


<h3>Usage</h3>

<pre><code class='language-R'>PredComp()
</code></pre>


<h3>Value</h3>

<p>A shiny app</p>


<h3>Author(s)</h3>

<p> Renato Paiva de Lima &lt;renato_agro_@hotmail.com&gt; </p>


<h3>See Also</h3>

<p><code><a href="#topic+stressTraffic">stressTraffic</a></code>
</p>

<hr>
<h2 id='psd'> Soil Pore Size Distribution </h2><span id='topic+psd'></span>

<h3>Description</h3>

<p> The unimodal soil pore size distribution based on van Genuchten's model. </p>


<h3>Usage</h3>

<pre><code class='language-R'>psd(thetaS, thetaR, alpha, n, h)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="psd_+3A_thetas">thetaS</code></td>
<td>
<p> the water content at saturation. </p>
</td></tr>
<tr><td><code id="psd_+3A_thetar">thetaR</code></td>
<td>
<p> the residual water content. </p>
</td></tr>
<tr><td><code id="psd_+3A_alpha">alpha</code></td>
<td>
<p> the scale parameter of the van Genuchten's model (hPa-1). </p>
</td></tr>
<tr><td><code id="psd_+3A_n">n</code></td>
<td>
<p> the shape parameter in van Genuchten's formula. </p>
</td></tr>
<tr><td><code id="psd_+3A_h">h</code></td>
<td>
<p> a vector of water tension (hPa) on the range of water retention curve. </p>
</td></tr>
</table>


<h3>Value</h3>

<p> A numeric vector containing the soil pore size distribution as a function of soil water tension. </p>


<h3>Author(s)</h3>

<p> Renato Paiva de Lima &lt;renato_agro_@hotmail.com&gt; </p>


<h3>References</h3>

<p>Ghiberto, P. J., Imhoff, S., Libardi, P. L., Silva, A. P. D., Tormena, C. A., Pilatti, M. A. (2015). 
Soil physical quality of Mollisols quantified by a global index. <em>Scientia Agricola</em>, 72(2):167-174.
</p>
<p>Asgarzadeh, H., Mosaddeghi, M. R., Nikbakht, A. M. (2014). SAWCal: A user-friendly program for 
calculating soil available water quantities and physical quality indices. 
<em>Computers and Electronics in Agriculture</em>, 109:86-93.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># EXAMPLE 1
x &lt;- seq(log10(1),log10(15000),len=100)
h &lt;- 10^x
y &lt;- psd(thetaR = 0.15,thetaS = 0.55, alpha = 0.048, n = 1.5, h=h)
plot(x=h,y=y, log="x", xlab="h (hPa)", ylab=expression(delta*theta/delta*h), ylim=c(0,0.005))

# EXAMPLE 2
x &lt;- seq(log10(1),log10(15000),len=100)
h &lt;- 10^x
y &lt;- psd(thetaR = 0.20,thetaS = 0.61, alpha = 0.1232, n = 1.3380,h=h)
plot(x=h,y=y, log="x", xlab="h (hPa)", ylab=expression(delta*theta/delta*h), ylim=c(0,0.01))

# EXAMPLE 3
x &lt;- seq(log10(1),log10(15000),len=100)
h &lt;- 10^x
y &lt;- psd(thetaR = 0.154,thetaS = 0.600, alpha = 0.103, n = 2.365,h=h)
plot(x=h,y=y, log="x", xlab="h (hPa)", ylab=expression(delta*theta/delta*h), ylim=c(0,0.03))
ax &lt;- c(1,10,100,1000,10000)
radius &lt;- r(h=ax)
axis(3,at=ax, labels=round(radius,2))
mtext("Equivalent pore radius"~(mu*m),3,line=2.5, cex=0.9)

# End (not run)
</code></pre>

<hr>
<h2 id='r'> Equation of capillary </h2><span id='topic+r'></span>

<h3>Description</h3>

<p> The equivalent pore radius as a function of soil water tension. </p>


<h3>Usage</h3>

<pre><code class='language-R'>r(h, surface.tension.water=0.072, water.density=1000, water.pore.contact.angle=0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="r_+3A_h">h</code></td>
<td>
<p> The water tension (hPa). </p>
</td></tr>
<tr><td><code id="r_+3A_surface.tension.water">surface.tension.water</code></td>
<td>
<p> Surface tension of water (N/m). </p>
</td></tr>
<tr><td><code id="r_+3A_water.density">water.density</code></td>
<td>
<p> Density of water (kg/m^3). </p>
</td></tr>
<tr><td><code id="r_+3A_water.pore.contact.angle">water.pore.contact.angle</code></td>
<td>
<p> Water pore contact angle (degrees). </p>
</td></tr>
</table>


<h3>Value</h3>

<p> The equivalent pore radius, in micrometer.. </p>


<h3>Author(s)</h3>

<p> Renato Paiva de Lima &lt;renato_agro_@hotmail.com&gt; </p>


<h3>References</h3>

<p>Ghiberto, P. J., Imhoff, S., Libardi, P. L., Silva, A. P. D., Tormena, C. A., Pilatti, M. A. (2015). 
Soil physical quality of Mollisols quantified by a global index. <em>Scientia Agricola</em>, 72(2):167-174.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- seq(log10(1), log10(15000), len=50)
h &lt;- 10^x
y &lt;- r(h=h)
plot(x=h, y=y, log="yx", xlab="h (hPa)", yaxt='n', ylab="", ylim=c(0.1, 1500))
ax &lt;- c(0.1, 1, 10, 100, 1000, 1500)
axis(2,at=ax, labels=ax)
mtext("Pore radius"~ (mu*m), 2, line=2.5)

# End (not run)
</code></pre>

<hr>
<h2 id='r_App'>A shiny for equation of capillarity</h2><span id='topic+r_App'></span>

<h3>Description</h3>

<p>A shiny for equation of capillarity</p>


<h3>Usage</h3>

<pre><code class='language-R'>r_App()
</code></pre>


<h3>Value</h3>

<p>A shiny app</p>


<h3>Author(s)</h3>

<p> Renato Paiva de Lima &lt;renato_agro_@hotmail.com&gt; </p>


<h3>See Also</h3>

<p><code><a href="#topic+stressTraffic">stressTraffic</a></code>
</p>

<hr>
<h2 id='Rsq'> Multiple R-squared </h2><span id='topic+Rsq'></span>

<h3>Description</h3>

<p>Function to calculate the <em>multiple R-squared</em> and the <em>adjusted
R-squared</em> from a fitted model via <code><a href="stats.html#topic+lm">lm</a></code> or <code><a href="stats.html#topic+aov">aov</a></code>, i.e., linear models.
For a model fitted via <code><a href="stats.html#topic+nls">nls</a></code>, nonlinear models, the <em>pseudo R-squared</em> is
returned.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> Rsq(model) </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Rsq_+3A_model">model</code></td>
<td>
<p> a model fitted via <code><a href="stats.html#topic+lm">lm</a></code>, <code><a href="stats.html#topic+aov">aov</a></code> or <code><a href="stats.html#topic+nls">nls</a></code>. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of
</p>
<table role = "presentation">
<tr><td><code>R.squared</code></td>
<td>
<p> the multiple R-squared (for linear models) or the Pseudo R-squared (for nonlinear models). </p>
</td></tr>
<tr><td><code>adj.R.squared</code></td>
<td>
<p> the adjusted R-squared. </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Anderson Rodrigo da Silva &lt;anderson.agro@hotmail.com&gt; </p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+lm">lm</a></code>, <code><a href="stats.html#topic+summary.lm">summary.lm</a></code>, <code><a href="stats.html#topic+aov">aov</a></code>,
<code><a href="stats.html#topic+nls">nls</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># example 1 [linear model]
y &lt;- rnorm(10)
x &lt;- 1:10
fit &lt;- lm(y ~ x)
summary(fit)
Rsq(fit)

# example 2 [nonlinear model for Load Bearing Capacity]
data(compaction)
attach(compaction)
out &lt;- fitlbc(theta = Mois, sigmaP = PS)
summary(out)
Rsq(out)

# End (not run)
</code></pre>

<hr>
<h2 id='sigmaP'> Preconsolidation Stress </h2><span id='topic+sigmaP'></span>

<h3>Description</h3>

<p>A function to determine the preconsolidation stress (<code class="reqn">\sigma_P</code>). It is a parameter obtained from
the soil compression curve and has been used as an indicator of soil load-bearing capacity as well as to
characterize the impacts suffered by the use of machines.
The function <code>sigmaP()</code> contains implementations of the main methods for determining the pre-consolidation
stress, such as the Casagrande method, the method of Pacheco Silva, the regression methods and the method of the
virgin compression line intercept.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sigmaP(voidratio, stress, n4VCL = 3,
    method = c("casagrande", "VCLzero", "reg1", "reg2", "reg3", "reg4", "pacheco"),
    mcp = NULL, graph = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sigmaP_+3A_voidratio">voidratio</code></td>
<td>
<p> a numeric vector containing void ratio (or bulk density) values. </p>
</td></tr>
<tr><td><code id="sigmaP_+3A_stress">stress</code></td>
<td>
<p> a numeric vector containing the applied stress sequence.</p>
</td></tr>
<tr><td><code id="sigmaP_+3A_n4vcl">n4VCL</code></td>
<td>
<p> the number of points for calculating the slope of the soil Virgin Compression Line (VCL),
which is obtained by linear regression. </p>
</td></tr>
<tr><td><code id="sigmaP_+3A_method">method</code></td>
<td>
<p> a character indicating which method is to be computed; one of the following:
<code>casagrande</code> (default), <code>VCLzero</code>, <code>reg1</code>, <code>reg2</code>, <code>reg3</code>,
<code>reg4</code> or <code>pacheco</code>; see Details. </p>
</td></tr>
<tr><td><code id="sigmaP_+3A_mcp">mcp</code></td>
<td>
<p> the maximum curvature point in log10 scale of <code>stress</code>; required only if the
method <code>casagrande</code> is used. </p>
</td></tr>
<tr><td><code id="sigmaP_+3A_graph">graph</code></td>
<td>
<p> logical; if TRUE (default) the compression curve is plotted. </p>
</td></tr>
<tr><td><code id="sigmaP_+3A_...">...</code></td>
<td>
<p> further graphical arguments. </p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>casagrande</code> is the method proposed by Casagrande (1936). The preconsolidation stress obtained via <code>VCLzero</code> corresponds
to the intersection of the soil <em>Virgin Compression Line</em> (VCL) with the x-axis at zero applied stress, as described by
Arvidsson &amp; Keller (2004). <code>reg1</code>, <code>reg2</code>, <code>reg3</code> and <code>reg4</code> are regression methods that obtain the preconsolidation
stress value as the intercept of the VCL and a regression line fitted with the first two, three, four and five points of the curve, respectively,
as described by Dias Junior &amp; Pierce (1995). <code>pacheco</code> is the method of Pacheco Silva (ABNT, 1990).
</p>
<p>You may follow the flowchart below to understand the determination of the preconsolidation stress through <code>sigmaP()</code>.
</p>
<p><img src="../help/figures/sigmaPfluxo.jpg" alt="sigmaPfluxo.jpg" />
</p>


<h3>Value</h3>

<p>A list of
</p>
<table role = "presentation">
<tr><td><code>sigmaP</code></td>
<td>
<p> the preconsolidation stress.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p> the method used as argument.</p>
</td></tr>
<tr><td><code>mcp</code></td>
<td>
<p> the maximum curvature point in log10 scale of <code>stress</code>; stored only if the
method <code>casagrande</code> is used.</p>
</td></tr>
<tr><td><code>CI</code></td>
<td>
<p> the compression index.</p>
</td></tr>
<tr><td><code>SI</code></td>
<td>
<p> the swelling index.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Anderson Rodrigo da Silva &lt;anderson.agro@hotmail.com&gt; </p>


<h3>References</h3>

<p>ABNT - Associacao Brasileira de Normas Tecnicas. (1990). <em>Ensaio de
adensamento unidimensional</em>: NBR 12007. Rio de Janeiro. 13p.
</p>
<p>Arvidsson, J.; Keller, T. (2004). Soil precompression stress
I. A survey of Swedish arable soils. <em>Soil &amp; Tillage Research</em>, 77:85-95.
</p>
<p>Bowles, J. A. (1986). <em>Engineering Properties of Soils and their
Measurements</em>, 3rd edition. McGraw-Hill Book Company, Inc. NY, 218pp.
</p>
<p>Casagrande, A. (1936). <em>The determination of the pre-consolidation
load and its practical significance</em>. In: Proceedings of the
International Conference on Soil Mech. and Found. Eng.
(ICSMFE), Cambridge, MA, 22-26 June 1936, vol. 3. Harvard
University, Cambridge, MA, USA, pp. 60-64.
</p>
<p>Dias Junior, M. S.; Pierce, F. J. (1995). A simple procedure for
estimating preconsolidation pressure from soil compression curves.
<em>Soil Technology</em>, 8:139-151.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+voidratio">voidratio</a></code>, <code><a href="#topic+maxcurv">maxcurv</a></code>, <code><a href="#topic+fitlbc">fitlbc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pres &lt;- c(1, 12.5, 25, 50, 100, 200, 400, 800, 1600)
VR &lt;- c(0.846, 0.829, 0.820, 0.802, 0.767, 0.717, 0.660, 0.595, 0.532)

plot(VR ~ log10(pres), type = "b") # find the 'mcp'
sigmaP(VR, pres, method = "casagrande", mcp = 1.6, n4VCL = 2)

# fitting the VCL
sigmaP(VR, pres, method = "casagrande", mcp = 1.6, n4VCL = 3)

# self-calculation of "mcp" argument for Casagrande method
sigmaP(VR, pres, method = "casagrande", n4VCL = 3)

# Pacheco method
sigmaP(VR, pres, method = "pacheco")

# Regression method
sigmaP(VR, pres, method = "reg3")

# End (not run)
</code></pre>

<hr>
<h2 id='simSigmaP'> Simulating Preconsolidation Stress </h2><span id='topic+simSigmaP'></span>

<h3>Description</h3>

<p>Simulating preconsolidation pressure, compression and swelling indices, based on a multivariate Gaussian distribution for the parameters of the compression curve.</p>


<h3>Usage</h3>

<pre><code class='language-R'>simSigmaP(voidratio, stress,
	what.out = c("sigmaP", "CI", "SI"),
	method = c("casagrande", "VCLzero", "reg1", "reg2", "reg3", "reg4", "pacheco"),
	n4VCL = 3, nsim = 100)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simSigmaP_+3A_voidratio">voidratio</code></td>
<td>
<p> a numeric vector containing void ratio (or bulk density) values.</p>
</td></tr>
<tr><td><code id="simSigmaP_+3A_stress">stress</code></td>
<td>
<p> a numeric vector containing the applied stress sequence.</p>
</td></tr>
<tr><td><code id="simSigmaP_+3A_what.out">what.out</code></td>
<td>
<p> a character indicating which <code>sigmaP()</code> output should be simulated.
It must be on of &quot;sigmaP&quot; (default), &quot;CI&quot; of &quot;SI&quot;.</p>
</td></tr>
<tr><td><code id="simSigmaP_+3A_method">method</code></td>
<td>
<p> a character vector indicating which methods should be used.</p>
</td></tr>
<tr><td><code id="simSigmaP_+3A_n4vcl">n4VCL</code></td>
<td>
<p> the number of points for calculating the slope of the soil Virgin Compression Line (VCL),
which is obtained by linear regression. Default is 3.</p>
</td></tr>
<tr><td><code id="simSigmaP_+3A_nsim">nsim</code></td>
<td>
<p> the number of simulations. Default is 100. Warning: it may cause time demanding.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric matrix containing the simulated values for each method selected as input.
</p>


<h3>Author(s)</h3>

<p> Anderson Rodrigo da Silva &lt;anderson.agro@hotmail.com&gt; </p>


<h3>See Also</h3>

<p><code><a href="#topic+sigmaP">sigmaP</a></code>, <code><a href="#topic+plotCIsigmaP">plotCIsigmaP</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># input data: stress and void ratio
pres &lt;- c(1, 12.5, 25, 50, 100, 200, 400, 800, 1600)
VR &lt;- c(1.43, 1.41, 1.40, 1.39, 1.35, 1.31, 1.25, 1.18, 1.12)

# simulation (may take a few seconds)
simres &lt;- simSigmaP(VR, pres, nsim = 30)
head(simres)

# plot percentile confidence intervals
ci &lt;- plotCIsigmaP(simres, conf.level = 0.95,
	shade.col = "blue", ordered = TRUE)
print(ci)

# End (Not run)
</code></pre>

<hr>
<h2 id='Sindex'> The S Index </h2><span id='topic+Sindex'></span>

<h3>Description</h3>

<p>Function to calculate the S index (Dexter, 2004) for evaluating the soil
physical quality based on the <em>Water Retention Curve</em> (van Genuchten, 1980).
</p>
<p style="text-align: center;"><code class="reqn"> S = - n * (\theta_S - \theta_R) * (1 + 1/m)^{-(1 + m)} </code>
</p>



<h3>Usage</h3>

<pre><code class='language-R'>Sindex(theta_R, theta_S, alpha, n, m = 1 - 1/n, vcov = NULL,
	nsim = 999, conf.level = 0.95, graph = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Sindex_+3A_theta_r">theta_R</code></td>
<td>
<p> the residual water content. </p>
</td></tr>
<tr><td><code id="Sindex_+3A_theta_s">theta_S</code></td>
<td>
<p> the water content at saturation. </p>
</td></tr>
<tr><td><code id="Sindex_+3A_alpha">alpha</code></td>
<td>
<p> a scale parameter of the van Genuchten's formula. </p>
</td></tr>
<tr><td><code id="Sindex_+3A_n">n</code></td>
<td>
<p> a shape parameter in van Genuchten's formula. </p>
</td></tr>
<tr><td><code id="Sindex_+3A_m">m</code></td>
<td>
<p> a shape parameter in van Genuchten's Formula. Default is <code class="reqn">1-1/n</code> (Mualem, 1976). </p>
</td></tr>
<tr><td><code id="Sindex_+3A_vcov">vcov</code></td>
<td>
<p> optional (default is <code>NULL</code>); a variance-covariance matrix of the estimates which is
used to perform	Monte Carlo simulations of the parameters <code>theta_R</code>, <code>theta_S</code>, <code>alpha</code> and
<code>n</code> for building a simulated confidence interval of the S index (in modulus).</p>
</td></tr>
<tr><td><code id="Sindex_+3A_nsim">nsim</code></td>
<td>
<p> the number of Monte Carlo simulations; default is 999. It is used only if <code>vcov</code>
is specified. </p>
</td></tr>
<tr><td><code id="Sindex_+3A_conf.level">conf.level</code></td>
<td>
<p> the confidence level; default is 0.95. It is used only if <code>vcov</code>
is specified.</p>
</td></tr>
<tr><td><code id="Sindex_+3A_graph">graph</code></td>
<td>
<p> logical; if TRUE (defaul), the soil water retention curve is plotted. </p>
</td></tr>
<tr><td><code id="Sindex_+3A_...">...</code></td>
<td>
<p> further graphical arguments. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of
</p>
<table role = "presentation">
<tr><td><code>h_i</code></td>
<td>
<p> the modulus of the water potential at the inflection point. </p>
</td></tr>
<tr><td><code>theta_i</code></td>
<td>
<p> the water content at the inflection point. </p>
</td></tr>
<tr><td><code>S.index</code></td>
<td>
<p> the modulus of the S index. </p>
</td></tr>
<tr><td><code>PhysicalQuality</code></td>
<td>
<p>A character indicating the soil physical quality, as proposed by Dexter (2004). </p>
</td></tr>
<tr><td><code>simCI</code></td>
<td>
<p>the simulated confidence interval. It is stored only if <code>vcov</code> is specified. </p>
</td></tr>
<tr><td><code>conf.level</code></td>
<td>
<p>the confidence level for the simulated confidence interval. It is stored only if <code>vcov</code> is specified. </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Anderson Rodrigo da Silva &lt;anderson.agro@hotmail.com&gt; </p>


<h3>References</h3>

<p>Dexter, A. R. (2004). Soil physical quality Part I. Theory,
effects of soil texture, density, and organic matter,
and effects on root growth. <em>Geoderma</em>, 120:201-214.
</p>
<p>Genuchten, M. T. van. (1980). A closed form equation for predicting the
hydraulic conductivity of unsaturated soils. <em>Soil Science Society of
America Journal</em>, 44:892-898.
</p>
<p>Mualem, Y. (1976). A new model for predicting the hydraulic conductivity
of unsaturated porous media, <em>Water Resource Research</em>, 12:513-522.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+soilwater">soilwater</a></code>, <code><a href="#topic+fitsoilwater">fitsoilwater</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Dexter (2004, Table 1)
Sindex(0, 0.395, 0.0217, 1.103, xlim = c(0, 1000))
Sindex(0, 0.335, 0.0616, 1.139, xlim = c(0, 1000))
# ...
Sindex(0, 0.226, 0.0671, 1.581, xlim = c(0, 1000))

# End (not run)
</code></pre>

<hr>
<h2 id='skp1994'>LLWR Data Set</h2><span id='topic+skp1994'></span>

<h3>Description</h3>

<p>Data set presented by Leao et al. (2005), for determining the Least Limiting Water Range.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(skp1994)</code></pre>


<h3>Format</h3>

<p>A data frame with 64 observations on the following 4 variables:
</p>

<dl>
<dt><code>BD</code></dt><dd><p>a numeric vector containing soil bulk density values, in Mg/m3.</p>
</dd>
<dt><code>W</code></dt><dd><p>a numeric vector containing volumetric water content values, in m3/m3.</p>
</dd>
<dt><code>PR</code></dt><dd><p>a numeric vector containing penetration resistance values, in MPa.</p>
</dd>
<dt><code>h</code></dt><dd><p>a numeric vector containing matric head values, in cm.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Leao et al. (2005). An Algorithm for Calculating the Least Limiting Water Range of Soils. 
<em>Agronomy Journal</em>, 97:1210-1215.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(skp1994)
summary(skp1994)
</code></pre>

<hr>
<h2 id='SoilAggregate'>Soil Aggregate Size Data Set</h2><span id='topic+SoilAggregate'></span>

<h3>Description</h3>

<p>Data set for determining soil aggregate size distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(SoilAggregate)</code></pre>


<h3>Format</h3>

<p>A data frame with 12 observations on 7 variables.
</p>

<dl>
<dt><code>ID</code></dt><dd><p>a factor with the names of the soil samples.</p>
</dd>
<dt><code>D3</code></dt><dd></dd>
<dt><code>D1.5</code></dt><dd></dd>
<dt><code>D0.75</code></dt><dd></dd>
<dt><code>D0.375</code></dt><dd></dd>
<dt><code>D0.178</code></dt><dd></dd>
<dt><code>D0.053</code></dt><dd></dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(SoilAggregate)
summary(SoilAggregate)
</code></pre>

<hr>
<h2 id='soilDeformation'> Soil deformation by O'Sullivan and Robertson (1996) </h2><span id='topic+soilDeformation'></span>

<h3>Description</h3>

<p>It calculates bulk density variation as a function of the applied mean normal stress using critical state theory, by O'Sullivan and Robertson (1996).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>soilDeformation(stress, p.density, iBD, N, CI, k, k2, m, graph = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="soilDeformation_+3A_stress">stress</code></td>
<td>
<p> a numeric vector containing the values of mean normal stress, kPa; Note that stress can also be a vector of length 1.</p>
</td></tr>
<tr><td><code id="soilDeformation_+3A_p.density">p.density</code></td>
<td>
<p> a numeric vector containing the values of particle density to each stress, <code class="reqn">Mg m^{-3}</code>.</p>
</td></tr>
<tr><td><code id="soilDeformation_+3A_ibd">iBD</code></td>
<td>
<p> a numeric vector containing the values of initial bulk density to each stress, <code class="reqn">Mg m^{-3}</code>.</p>
</td></tr>
<tr><td><code id="soilDeformation_+3A_n">N</code></td>
<td>
<p> the specific volume at p = 1 kPa, to each stress</p>
</td></tr>
<tr><td><code id="soilDeformation_+3A_ci">CI</code></td>
<td>
<p> the compression index, to each stress; check details</p>
</td></tr>
<tr><td><code id="soilDeformation_+3A_k">k</code></td>
<td>
<p> the recompression index, to each stress; check details</p>
</td></tr>
<tr><td><code id="soilDeformation_+3A_k2">k2</code></td>
<td>
<p> the slope of the steeper recompression line to each stress (similar to the k' in O'Sullivan and Robertson (1996) model); check details</p>
</td></tr>
<tr><td><code id="soilDeformation_+3A_m">m</code></td>
<td>
<p> the value that separates yield line and VCL to each stress; check details</p>
</td></tr>
<tr><td><code id="soilDeformation_+3A_graph">graph</code></td>
<td>
<p> logical; shall soilDeformation plot the graph model (only the first parameters set is ploted)?</p>
</td></tr>
<tr><td><code id="soilDeformation_+3A_...">...</code></td>
<td>
<p> further graphical arguments. See <a href="graphics.html#topic+par">par</a>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The specific volume (v) is given as <code class="reqn">v=PD/BD</code>, where PD is particle density and BD is the bulk
density. Please, check each parameter from O'Sullivan and Robertson (1996) model in the figure below.
</p>
<p><img src="../help/figures/SMP.jpeg" alt="SMP.jpeg" />
</p>


<h3>Value</h3>

<p>A list of
</p>
<table role = "presentation">
<tr><td><code>iBD</code></td>
<td>
<p> initial bulk density, <code class="reqn">Mg m^{-3}</code></p>
</td></tr>
<tr><td><code>fBD</code></td>
<td>
<p> final bulk density, <code class="reqn">Mg m^{-3}</code></p>
</td></tr>
<tr><td><code>vi</code></td>
<td>
<p> initial specific volume</p>
</td></tr>
<tr><td><code>vf</code></td>
<td>
<p> final specific volume</p>
</td></tr>
<tr><td><code>I</code></td>
<td>
<p> variation of soil bulk density (<code class="reqn">\%</code>) after the applied stress</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Renato Paiva de Lima &lt;renato_agro_@hotmail.com&gt;
</p>
<p>Anderson Rodrigo da Silva &lt;anderson.agro@hotmail.com&gt;
</p>
<p>Alvaro Pires da Silva &lt;apisilva@usp.br&gt;
</p>


<h3>References</h3>

<p>O'Sullivan, M.F.; Robertson, E.A.G. 1996. Critical state parameters from intact samples of two
agricultural soils. <em>Soil and Tillage Research</em>, 39:161-173.
</p>
<p>Keller, T.; Defossez, P.; Weisskopf, P.; Arvidsson, J.; Richard, G. 2007. SoilFlex: a model
for prediction of soil stresses and soil compaction due to agricultural field traffic
including a synthesis of analytical approaches. <em>Soil and Tillage Research</em>, 93:391-411.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># EXAMPLE 1
soilDeformation(stress = 300,
                p.density = 2.67,
	        iBD = 1.55,
                N = 1.9392,
                CI = 0.06037,
                k = 0.00608,
                k2 = 0.01916,
                m = 1.3,graph=TRUE,ylim=c(1.4,1.8))

# EXEMPLE 2 (combining it with soil stress)
stress &lt;- stressTraffic(inflation.pressure=200,
	        recommended.pressure=200,
	        tyre.diameter=1.8,
	        tyre.width=0.4,
	        wheel.load=4000,
	        conc.factor=c(4,5,5,5,5,5),
                layers=c(0.05,0.1,0.3,0.5,0.7,1),
	        plot.contact.area = FALSE)

stress.mean &lt;- stress$Stress$sigma_mean
layers &lt;- stress$Stress$Layers
n &lt;- length(layers)

def &lt;- soilDeformation(stress = stress.mean,
                p.density = rep(2.67, n),
	        iBD = rep(1.55,n),
                N = rep(1.9392,n),
                CI = rep(0.06037,n),
                k = rep(0.00608,n),
                k2 = rep(0.01916,n),
                m = rep(1.3,n),graph=TRUE,ylim=c(1.4,1.8))

# Graph
plot(x = 1, y = 1,
     xlim=c(1.4,1.7),ylim=c(1,0),xaxt = "n",
     ylab = "Soil Depth",xlab ="", type="l", main="")
axis(3)
mtext("Bulk Density",side=3,line=2.5)

initial.BD &lt;- def$iBD
final.BD &lt;- def$fBD
points(x=initial.BD, y=layers, type="l")
points(x=initial.BD, y=layers,pch=15)
points(x=final.BD, y=layers, type="l", col=2)
points(x=final.BD, y=layers,pch=15, col=2)

# End (not run)
</code></pre>

<hr>
<h2 id='soilStrength'>Estimation of precompression stress by Severiano et al. (2013)</h2><span id='topic+soilStrength'></span>

<h3>Description</h3>

<p>It calculates the precompression stress using the pedo-transfer function from Severiano et al. (2013)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>soilStrength(clay.content, matric.suction = NULL, water.content = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="soilStrength_+3A_clay.content">clay.content</code></td>
<td>
<p> a numeric vector containing the values of clay for each soil layer, %.
Note that it can also be a unique value. </p>
</td></tr>
<tr><td><code id="soilStrength_+3A_matric.suction">matric.suction</code></td>
<td>
<p> a numeric vector containing the values of matric suction for each clay content, kPa. </p>
</td></tr>
<tr><td><code id="soilStrength_+3A_water.content">water.content</code></td>
<td>
<p> a numeric vector containing the values of water content for each clay content, <code class="reqn">m^3 m^{-3}</code>.
Note that water.content must be passed if <code>matric.suction</code> is not. See details. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Intervals of soil water content/matric suction to be used as input for estimating soil strength according to Severiano et al. (2013).
</p>
<p><img src="../help/figures/limitsSoilStrength.jpg" alt="limitsSoilStrength.jpg" />
</p>


<h3>Value</h3>

<p>A two-columns data frame:
</p>
<table role = "presentation">
<tr><td><code>Pc</code></td>
<td>
<p> the precompression stress (Severiano et al. 2013)</p>
</td></tr>
<tr><td><code>LL.Pc</code></td>
<td>
<p> the lower limit of precompression stress in acoording to the Terranimo model criteria (see Stettler et al. 2014). Note: LL.Pc = Pc*0.5</p>
</td></tr>
<tr><td><code>UL.Pc</code></td>
<td>
<p> the upper limit of precompression stress in acoording to the Terranimo model criteria (see Stettler et al. 2014). Note: UL.Pc = Pc*1.1</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Renato Paiva de Lima &lt;renato_agro_@hotmail.com&gt;
</p>
<p>Anderson Rodrigo da Silva &lt;anderson.agro@hotmail.com&gt;
</p>
<p>Alvaro Pires da Silva &lt;apisilva@usp.br&gt;
</p>


<h3>References</h3>

<p>Severiano, E.C; Oliveira, G.C.; Dias Junior, M.S.; Curi, N.C.; Costa, K. A.P.; Carducci, C.E. 2013.
Preconsolidation pressure, soil water retention characteristics, and texture of Latosols in the Brazilian Cerrado.
<em>Soil Research</em>, 51:193-202.
</p>
<p>Stettler, M., Keller, T., Weisskopf, P., Lamande, M., Lassen, P., Schjonning, P., 2014.
Terranimo - a web-based tool for evaluating soil compaction. <em>Landtechnik</em>, 69:132-137.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stressTraffic">stressTraffic</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># EXEMPLE 1 (using water content)
soilStrength(clay.content=c(25,28,30,30,30),
             water.content = c(0.26,0.27,0.29,0.32,0.32))


# EXEMPLE 2 (using matric suction)
soilStrength(clay.content=c(25,28,30,30,30),
             matric.suction = c(100,330,1000,3000,5000))


# EXAMPLE 3 (combining it with soil stress)
stress &lt;- stressTraffic(inflation.pressure=200,
	        recommended.pressure=200,
	        tyre.diameter=1.8,
	        tyre.width=0.4,
	        wheel.load=4000,
	        conc.factor=c(4,5,5,5,5,5),
                layers=c(0.05,0.1,0.3,0.5,0.7,1),
	        plot.contact.area = FALSE)

strength &lt;- soilStrength(clay.content=c(25,28,30,30,30,30),
              matric.suction = c(30,100,100,100,200,200))


# Graph
plot(x = 1, y = 1,
     xlim=c(0,300),ylim=c(1,0),xaxt = "n",
     ylab = "Soil Depth",xlab ="", type="l", main="")
axis(3)
mtext("Vertical Stress",side=3,line=2.5)

stressz &lt;- stress$Stress$sigma_vertical
layers &lt;- stress$Stress$Layers
points(x=stressz, y=layers, type="l")

# Green zone
x0 &lt;- strength$LL.Pc
x1 &lt;- rep(0,length(layers))
y0 &lt;- layers
y1 &lt;- rev(layers)
polygon(x=c(x0,x1), y = c(y0,y1),density = NA,
       col=rgb(red=0, green=1, blue=0, alpha=0.3))

# Yellow zone
x0 &lt;- strength$UL.Pc
x1 &lt;- rev(strength$LL.Pc)
y0 &lt;- layers
y1 &lt;- rev(layers)
polygon(x=c(x0,x1), y = c(y0,y1),density = NA,
       col=rgb(red=1, green=1, blue=0, alpha=0.3))

# Red zone
x0 &lt;- rep(300,length(layers))
x1 &lt;- rev(strength$UL.Pc)
y0 &lt;- layers
y1 &lt;- rev(layers)
polygon(x=c(x0,x1), y = c(y0,y1),density = NA,
       col=rgb(red=1, green=0, blue=0, alpha=0.3))

# End (not run)
</code></pre>

<hr>
<h2 id='soilStrength2'> Estimation of precompression stress by Schjonning and Lamande (2018)</h2><span id='topic+soilStrength2'></span>

<h3>Description</h3>

<p>It calculates the precompression stress using the pedo-transfer function from Schjonning and Lamande (2018)
</p>


<h3>Usage</h3>

<pre><code class='language-R'> 
soilStrength2(bulk.density,  matric.suction, clay.content)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="soilStrength2_+3A_clay.content">clay.content</code></td>
<td>
<p> a numeric vector containing the values of clay content, <code class="reqn">\%</code></p>
</td></tr>
<tr><td><code id="soilStrength2_+3A_matric.suction">matric.suction</code></td>
<td>
<p> a numeric vector containing the values of matric suction, hPa</p>
</td></tr>
<tr><td><code id="soilStrength2_+3A_bulk.density">bulk.density</code></td>
<td>
<p> a numeric vector containing the values of soil bulk density, <code class="reqn">Mg m^{-3}</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function returns 0 for soil properties values beyond the range for which the function was built.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>PC</code></td>
<td>
<p>the precompression stress</p>
</td></tr>
</table>


<h3>Author(s)</h3>

 
<p>Renato Paiva de Lima &lt;renato_agro_@hotmail.com&gt;
Anderson Rodrigo da Silva &lt;anderson.agro@hotmail.com&gt; 
</p>


<h3>References</h3>

<p>Schjonning, P.; Lamande, M., 2018. 
Models for prediction of soil precompression stress from readily available soil properties. 
<em>Geoderma</em>, 320:115-125.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stressTraffic">stressTraffic</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># EXAMPLE 1

soilStrength2(bulk.density=1.46, matric.suction=100, clay.content=0.3)


# EXAMPLE 2

matric.suction &lt;- seq(from=60,to=1000,len=50) # range of matric suction from 60 to 1200 hPa
out &lt;- soilStrength2(bulk.density=1.46, matric.suction=matric.suction, clay.content=0.3)
plot(x=matric.suction,y=out, 
     ylab="Precompression stress (kPa)", xlab="Matric suction (hPa)")

# End (not run)
</code></pre>

<hr>
<h2 id='soilStrength3'> Estimation of precompression stress by Saffih-Hdadi et al. (2009)</h2><span id='topic+soilStrength3'></span>

<h3>Description</h3>

<p>It calculates the precompression stress using the pedo-transfer function from Saffih-Hdadi et al. (2009)
</p>


<h3>Usage</h3>

<pre><code class='language-R'> 
soilStrength3(bulk.density, water.content, 
              texture=c("VeryFine","Fine","MediumFine","Medium","Coarse"))

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="soilStrength3_+3A_bulk.density">bulk.density</code></td>
<td>
<p> a numeric vector containing the values of soil bulk density, <code class="reqn">Mg m^{-3}</code></p>
</td></tr>
<tr><td><code id="soilStrength3_+3A_water.content">water.content</code></td>
<td>
<p> a numeric vector containing the values of gravimetric water content, <code class="reqn">\%</code></p>
</td></tr>
<tr><td><code id="soilStrength3_+3A_texture">texture</code></td>
<td>
<p> the soil texture group. See exemples</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function returns 0 for soil properties values beyond the range for which the function was built.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>PC</code></td>
<td>
<p>the precompression stress</p>
</td></tr>
</table>


<h3>Author(s)</h3>

 
<p>Renato Paiva de Lima &lt;renato_agro_@hotmail.com&gt;
Anderson Rodrigo da Silva &lt;anderson.agro@hotmail.com&gt; 
</p>


<h3>References</h3>

<p>Saffih-Hdadi, K.; Defossez, P.; Richard, G.; Cui, Y. J.; Tang, A. M.; Chaplain, V, 2009.
A method for predicting soil susceptibility to the compaction of surface layers as a function of water content and bulk density 
<em>Geoderma</em>, 115: 96-103.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stressTraffic">stressTraffic</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  
# EXAMPLE 1

soilStrength3(bulk.density=1.1, water.content=40, texture="VeryFine")
soilStrength3(bulk.density=1.2, water.content=20, texture="Fine")
soilStrength3(bulk.density=1.3, water.content=15, texture="MediumFine")
soilStrength3(bulk.density=1.4, water.content=15, texture="Medium")
soilStrength3(bulk.density=1.5, water.content=10, texture="Coarse")

# End (not run)
</code></pre>

<hr>
<h2 id='soilStrength4'>Estimation of precompression stress by Lebert and Horn (1991)</h2><span id='topic+soilStrength4'></span>

<h3>Description</h3>

<p>It calculates the soil strength through precompression stress using the pedo-transfer function from Lebert and Horn (1991)
</p>


<h3>Usage</h3>

<pre><code class='language-R'> 
soilStrength4(BD=1.55,AC=10,AWC=15,PWP=26,Ks=0.29,
              OM=1.5,C=30,phi=36,texture="Clay&gt;35", pF=1.8)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="soilStrength4_+3A_bd">BD</code></td>
<td>
<p> a numeric vector containing the values of soil bulk density, <code class="reqn">Mg m^{-3}</code></p>
</td></tr> 
<tr><td><code id="soilStrength4_+3A_ac">AC</code></td>
<td>
<p> a numeric vector containing the values of volumetric air capacity at the specified pF, <code class="reqn">\%</code></p>
</td></tr> 
<tr><td><code id="soilStrength4_+3A_awc">AWC</code></td>
<td>
<p> a numeric vector containing the values of volumetric available water at the specified pF, <code class="reqn">\%</code></p>
</td></tr> 
<tr><td><code id="soilStrength4_+3A_pwp">PWP</code></td>
<td>
<p> a numeric vector containing the values of volumetric non available water capacity (pF &gt; 4.2), <code class="reqn">\%</code></p>
</td></tr> 
<tr><td><code id="soilStrength4_+3A_ks">Ks</code></td>
<td>
<p> a numeric vector containing the values of saturated hydraulic conductivity, <code class="reqn">10^3 cm s^{-1}</code> </p>
</td></tr>
<tr><td><code id="soilStrength4_+3A_om">OM</code></td>
<td>
<p> a numeric vector containing the values of organic matter, <code class="reqn">\%</code></p>
</td></tr> 
<tr><td><code id="soilStrength4_+3A_c">C</code></td>
<td>
<p> a numeric vector containing the values of cohesion at the specified pF, kPa</p>
</td></tr>
<tr><td><code id="soilStrength4_+3A_phi">phi</code></td>
<td>
<p> a numeric vector containing the values of angle of internal friction at the specified pF, degree</p>
</td></tr>
<tr><td><code id="soilStrength4_+3A_texture">texture</code></td>
<td>
<p>the soil texture classification. See details</p>
</td></tr> 
<tr><td><code id="soilStrength4_+3A_pf">pF</code></td>
<td>
<p>the '1.8' or '2.5' value pF</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>The function returns '0' for soil properties values beyond the range for which the function was built. The default for this function is the values given in the application example by Horn and Fleige (2003).
In the 'texture' argument, the user must pass the textural classification 'Sand','SandLoam', 'Silt', 'Clay&lt;35' or 'Clay&gt;35'. See examples.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>PC</code></td>
<td>
<p>the precompression stress</p>
</td></tr>
</table>


<h3>Author(s)</h3>

 
<p>Renato Paiva de Lima &lt;renato_agro_@hotmail.com&gt;
Anderson Rodrigo da Silva &lt;anderson.agro@hotmail.com&gt; 
</p>


<h3>References</h3>

<p>Lebert, M., Horn, R. (1991) A method to predict the mechanical strength of agricultural soils. 
<em>Soil and Tillage Research</em>, 19: 275-256.
</p>
<p>Horn, R., Fleige, H. (2003) A method for assessing the impact of load on mechanical stability and on physical properties of soils. 
<em>Soil and Tillage Research</em>, 73: 89-99.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stressTraffic">stressTraffic</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>soilStrength4(BD=1.55,AC=10,AWC=15,PWP=26,Ks=0.29,OM=1.5,
              C=30,phi=36,texture="Clay&gt;35", pF=1.8) # Exemple from Horn and Fleige (2003), Table 7

# End (not run)
</code></pre>

<hr>
<h2 id='soilStrength5'> Estimation of precompression stress by Imhoff et al. (2004)</h2><span id='topic+soilStrength5'></span>

<h3>Description</h3>

<p>It calculates the soil strength using precompression stress using the pedo-transfer function from Imhoff et al. (2004)
</p>


<h3>Usage</h3>

<pre><code class='language-R'> 
soilStrength5(bulk.density,  water.content, clay.content)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="soilStrength5_+3A_bulk.density">bulk.density</code></td>
<td>
<p> a numeric vector containing the values of soil bulk density, <code class="reqn">Mg m^{-3}</code></p>
</td></tr> 
<tr><td><code id="soilStrength5_+3A_water.content">water.content</code></td>
<td>
<p> a numeric vector containing the values of water content, (g/g)</p>
</td></tr>
<tr><td><code id="soilStrength5_+3A_clay.content">clay.content</code></td>
<td>
<p> a numeric vector containing the values of clay content, <code class="reqn">\%</code></p>
</td></tr> 
</table>


<h3>Details</h3>

<p>The function returns 0 for soil properties values beyond the range for which the function was built.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>PC</code></td>
<td>
<p>the precompression stress</p>
</td></tr>
</table>


<h3>Author(s)</h3>

 
<p>Renato Paiva de Lima &lt;renato_agro_@hotmail.com&gt;
Anderson Rodrigo da Silva &lt;anderson.agro@hotmail.com&gt; 
</p>


<h3>References</h3>

<p>Imhoff, S., Da Silva, A. P., Fallow, D. (2004) Susceptibility to Compaction, Load Support Capacity, and Soil Compressibility of Hapludox. 
<em>Soil Science Society of America Journal</em>, 68: 17-24.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stressTraffic">stressTraffic</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># EXAMPLE 1

soilStrength5(clay.content=60, water.content=0.30, bulk.density=1.25)
soilStrength5(clay.content=35, water.content=0.23, bulk.density=1.40)
soilStrength5(clay.content=20, water.content=0.10, bulk.density=1.60)


# EXAMPLE 2
water.content &lt;- seq(0.1,0.30,len=20) # range of water content from 0.1 to 0.30 (g g^-1)
out &lt;- soilStrength5(clay.content=20, water.content=water.content , bulk.density=1.60)
plot(x=water.content,y=out, 
     ylab="Precompression stress (kPa)", xlab="Water content")


# End (not run)
</code></pre>

<hr>
<h2 id='soilwater'> Soil Water Retention, based on the van Genuchten's (1980) formula </h2><span id='topic+soilwater'></span>

<h3>Description</h3>

<p>Function to calculate the soil water content based on the
van Genuchten's (1980) formula:
</p>
<p style="text-align: center;"><code class="reqn">\theta = \theta_R + (\theta_S - \theta_R)(1 + (\alpha x)^n)^{-m}</code>
</p>



<h3>Usage</h3>

<pre><code class='language-R'>soilwater(x, theta_R, theta_S, alpha, n, m = 1 - 1/n,
    saturation.index = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="soilwater_+3A_x">x</code></td>
<td>
<p> the matric potential. </p>
</td></tr>
<tr><td><code id="soilwater_+3A_theta_r">theta_R</code></td>
<td>
<p> the residual water content. </p>
</td></tr>
<tr><td><code id="soilwater_+3A_theta_s">theta_S</code></td>
<td>
<p> the water content at saturation. </p>
</td></tr>
<tr><td><code id="soilwater_+3A_alpha">alpha</code></td>
<td>
<p> a scale parameter of the van Genuchten's formula. </p>
</td></tr>
<tr><td><code id="soilwater_+3A_n">n</code></td>
<td>
<p> a shape parameter in van Genuchten's formula. </p>
</td></tr>
<tr><td><code id="soilwater_+3A_m">m</code></td>
<td>
<p> a shape parameter in van Genuchten's Formula. Default is <code class="reqn">1-1/n</code> (Mualem, 1976). </p>
</td></tr>
<tr><td><code id="soilwater_+3A_saturation.index">saturation.index</code></td>
<td>
<p> logical; if FALSE (default) the outcome is the soil water content,
otherwise the saturation index is returned. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>The the soil water content or the saturation index (a value between 0 and 1).
</p>


<h3>Author(s)</h3>

<p>Anderson Rodrigo da Silva &lt;anderson.agro@hotmail.com&gt;
(code adapted from the function swc(), package <em>soilwater</em> (Cordano <em>et al</em>., 2012).)
</p>


<h3>References</h3>

<p>Genuchten, M. T. van. (1980). A closed form equation for predicting the
hydraulic conductivity of unsaturated soils. <em>Soil Science Society of
America Journal</em>, 44:892-898.
</p>
<p>Mualem, Y. (1976). A new model for predicting the hydraulic conductivity
of unsaturated porous media. <em>Water Resources Research</em>, 12:513-522.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fitsoilwater">fitsoilwater</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># example 1
soilwater(x = 0.1, theta_R = 0.06, theta_S = 0.25, alpha = 21, n = 2.08)
curve(soilwater(x, theta_R = 0.06, theta_S = 0.25, alpha = 21, n = 2.08))

# example 2 (punctual predictions)
p &lt;- seq(0, 1, length.out = 10)
m &lt;- soilwater(x = p, theta_R = 0.06, theta_S = 0.25,
	alpha = 21, n = 2.08)
points(m ~ p, type = "b", col = "red")

# End (not run)
</code></pre>

<hr>
<h2 id='soilwater2'> Soil Water Retention, based on the Groenevelt &amp; Grant (2004) formula</h2><span id='topic+soilwater2'></span>

<h3>Description</h3>

<p>Function to calculate the soil water content based on the Groenevelt &amp; Grant (2004) model. 
It is based on thermodynamic principles. Therefore, it is appropriate for the case in which 
thermodynamic equilibrium has been attained by diffusion of water. 
In this case, the water retention curve is given by:
</p>
<p style="text-align: center;"><code class="reqn">\theta = k_1 \exp(-k_0 / x_0^n) - k_1 \exp(-k_0 / x^n)</code>
</p>

<p>where <code class="reqn">x = log h</code> (pore water suction), and h is in units of hPa 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>soilwater2(x, x0 = 6.653, k0, k1, n)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="soilwater2_+3A_x">x</code></td>
<td>
<p> a numeric vector containing pF values.</p>
</td></tr>
<tr><td><code id="soilwater2_+3A_x0">x0</code></td>
<td>
<p> the value of pF (pore water suction) at which the soil water content becomes zero. The default is 6.653.</p>
</td></tr>
<tr><td><code id="soilwater2_+3A_k0">k0</code></td>
<td>
<p> a parameter value.</p>
</td></tr>
<tr><td><code id="soilwater2_+3A_k1">k1</code></td>
<td>
<p> a parameter value.</p>
</td></tr>
<tr><td><code id="soilwater2_+3A_n">n</code></td>
<td>
<p> a parameter value.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The the soil water content.
</p>


<h3>Author(s)</h3>

<p> Anderson Rodrigo da Silva &lt;anderson.agro@hotmail.com&gt; </p>


<h3>References</h3>

<p>Groenevelt &amp; Grant (2004). A newmodel for the soil-water retention curve that solves the problem 
of residualwater contents. <em>European Journal of Soil Science</em>, 55:479-485.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fitsoilwater2">fitsoilwater2</a></code>, <code><a href="#topic+soilwater">soilwater</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pF &lt;- 0:7
soilwater2(pF, k0 = 1.867, k1 = 0.426, n = 2.358)

# End (not run)
</code></pre>

<hr>
<h2 id='soilwater3'> Soil Water Retention, based on the Dexter's (2008) formula </h2><span id='topic+soilwater3'></span>

<h3>Description</h3>

<p>Function to calculate the soil water content based on the Dexter's (2008) formula.
It is based on the segregation of pore space in two categories what are called bi-modal pore size distributions. 
In this model, the pore space is divided into two parts: the textural porosity which occurs between the primary 
mineral particles, and the structural porosity which occurs between micro aggregates and/or any other compound particles. 
This is called the double-exponential (DE) water retention equation, given by:
</p>
<p style="text-align: center;"><code class="reqn">\theta = \theta_R + a_1 \exp(-x/p_1) + a_2 \exp(-x/p_2) </code>
</p>

<p>where <code class="reqn">\theta</code> is the gravimetric water content.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>soilwater3(x, theta_R, a1, p1, a2, p2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="soilwater3_+3A_x">x</code></td>
<td>
<p>a numeric vector containing the values of applied air pressure.</p>
</td></tr>
<tr><td><code id="soilwater3_+3A_theta_r">theta_R</code></td>
<td>
<p> a parameter that represents the residual water content.</p>
</td></tr>
<tr><td><code id="soilwater3_+3A_a1">a1</code></td>
<td>
<p> a parameter that represents the drainable part of the textural pore space in units of 
gravimetric water content at saturation.</p>
</td></tr>
<tr><td><code id="soilwater3_+3A_p1">p1</code></td>
<td>
<p> a parameter that represents the applied air pressures characteristic for displacement of water 
from the textural pore space.</p>
</td></tr>
<tr><td><code id="soilwater3_+3A_a2">a2</code></td>
<td>
<p> a parameter that represents the total structural pore space in units of gravimetric water 
content at saturation.</p>
</td></tr>
<tr><td><code id="soilwater3_+3A_p2">p2</code></td>
<td>
<p> a parameter that represents the applied air pressure that is characteristic for displacing 
water from the structural pores.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The the soil water content.
</p>


<h3>Author(s)</h3>

<p> Anderson Rodrigo da Silva &lt;anderson.agro@hotmail.com&gt; </p>


<h3>References</h3>

<p>Dexter et al. (2008). A user-friendly water retention function that takes account of the textural
and structural pore spaces in soil. <em>Geoderma</em>, 143:243-253.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fitsoilwater3">fitsoilwater3</a></code>, <code><a href="#topic+soilwater">soilwater</a></code>, <code><a href="#topic+soilwater2">soilwater2</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>soilwater3(x = 0, theta_R = 0.058, a1 = 0.233, p1 = 3.274, a2 = 0.070, p2 = 1.78)
soilwater3(x = 3, theta_R = 0.058, a1 = 0.233, p1 = 3.274, a2 = 0.070, p2 = 1.78)
soilwater3(x = 4, theta_R = 0.058, a1 = 0.233, p1 = 3.274, a2 = 0.070, p2 = 1.78)

# End (not run)
</code></pre>

<hr>
<h2 id='soilwater4'> Soil Water Retention, based on Power Models </h2><span id='topic+soilwater4'></span>

<h3>Description</h3>

<p>Function to calculate the soil water content based on the following formulas:
</p>
<p style="text-align: center;"><code class="reqn">\theta = \exp(a + b*Bd) \psi^c</code>
</p>
<p>  (Silva et al., 1994)
</p>
<p style="text-align: center;"><code class="reqn">\theta = a \psi^c</code>
</p>
<p>  (Ross et al., 1991)
</p>
<p>where <code class="reqn">\theta</code> is the soil water content.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>soilwater4(psi, Bd, a, b, c, model = c("Silva", "Ross"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="soilwater4_+3A_psi">psi</code></td>
<td>
<p> a numeric vector containing values of water potential (Psi).</p>
</td></tr>
<tr><td><code id="soilwater4_+3A_bd">Bd</code></td>
<td>
<p> a numeric vector containing values of dry bulk density.</p>
</td></tr>
<tr><td><code id="soilwater4_+3A_a">a</code></td>
<td>
<p> a model-fitting parameter. See details.</p>
</td></tr>
<tr><td><code id="soilwater4_+3A_b">b</code></td>
<td>
<p> a model-fitting parameter. See details.</p>
</td></tr>
<tr><td><code id="soilwater4_+3A_c">c</code></td>
<td>
<p> a model-fitting parameter. See details.</p>
</td></tr>
<tr><td><code id="soilwater4_+3A_model">model</code></td>
<td>
<p> a character; the model to be used for calculating the soil water content. It must be one of the
two: <code>"Silva"</code> (default) or <code>"Ross"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The parameters &quot;a&quot; and &quot;c&quot; have the same meaning in both models, but be aware that the parameter &quot;a&quot; of the model
employed by Silva et al. (1994) is parameter &quot;a&quot; of the Ross et al. (1991) in a log10 scale.
</p>


<h3>Value</h3>

<p>The the soil water content.
</p>


<h3>Author(s)</h3>

<p> Anderson Rodrigo da Silva &lt;anderson.agro@hotmail.com&gt; </p>


<h3>References</h3>

<p>Ross et al. (1991). Equation for extending water-retention curves to dryness.
<em>Soil Science Society of America Journal</em>, 55:923-927. 
</p>
<p>Silva et al. (1994). Characterization of the least limiting water range of soils. 
<em>Soil Science Society of America Journal</em>, 58:1775-1781.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fitsoilwater4">fitsoilwater4</a></code>, <code><a href="#topic+soilwater">soilwater</a></code>, <code><a href="#topic+soilwater2">soilwater2</a></code>, <code><a href="#topic+soilwater3">soilwater3</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# End (not run)
</code></pre>

<hr>
<h2 id='soilwater5'> Soil Water Retention, based on the modified van Genuchten's formula </h2><span id='topic+soilwater5'></span>

<h3>Description</h3>

<p>Function to calculate the soil water content based on the modified van Genuchten's formula,
as suggested by Pierson and Mulla (1989):
</p>
<p style="text-align: center;"><code class="reqn">\theta = \theta_R + (\theta_S - \theta_R)(1 + (\alpha x)^n)^{-m} + b_0 + b_1 x + b_2 * x^2</code>
</p>



<h3>Usage</h3>

<pre><code class='language-R'>soilwater5(x, theta_R, theta_S, alpha, n, m = 1 - 1/n, b0, b1, b2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="soilwater5_+3A_x">x</code></td>
<td>
<p> the matric potential.</p>
</td></tr>
<tr><td><code id="soilwater5_+3A_theta_r">theta_R</code></td>
<td>
<p> the residual water content. </p>
</td></tr>
<tr><td><code id="soilwater5_+3A_theta_s">theta_S</code></td>
<td>
<p> the water content at saturation. </p>
</td></tr>
<tr><td><code id="soilwater5_+3A_alpha">alpha</code></td>
<td>
<p> a scale parameter of the van Genuchten's formula. </p>
</td></tr>
<tr><td><code id="soilwater5_+3A_n">n</code></td>
<td>
<p> a shape parameter in van Genuchten's formula. </p>
</td></tr>
<tr><td><code id="soilwater5_+3A_m">m</code></td>
<td>
<p> a shape parameter in van Genuchten's Formula. Default is <code class="reqn">1-1/n</code> (Mualem, 1976). </p>
</td></tr>
<tr><td><code id="soilwater5_+3A_b0">b0</code></td>
<td>
<p> a parameter added to the van Ganuchten's formula.</p>
</td></tr>
<tr><td><code id="soilwater5_+3A_b1">b1</code></td>
<td>
<p> a parameter added to the van Ganuchten's formula.</p>
</td></tr>
<tr><td><code id="soilwater5_+3A_b2">b2</code></td>
<td>
<p> a parameter (of quadratic term) added to the van Ganuchten's formula.</p>
</td></tr>
</table>


<h3>Value</h3>

<p> The the soil water content or the saturation index (a value between 0 and 1). </p>


<h3>Author(s)</h3>

<p>Anderson Rodrigo da Silva &lt;anderson.agro@hotmail.com&gt;
</p>


<h3>References</h3>

<p>Pierson, F.B.; Mulla, D.J. (1989) An Improved Method for Measuring Aggregate Stability
of a Weakly Aggregated Loessial Soil. <em>Soil Sci. Soc. Am. J.</em>, 53:1825&ndash;1831.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fitsoilwater5">fitsoilwater5</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>soilwater5(x = 20, theta_R = 0.2735, theta_S = 0.478, alpha = 0.1029, 
	n = 9.45, b0 = 0.2278, b1 = -0.0165, b2 = 0.000248)
curve(soilwater5(x, theta_R = 0.2735, theta_S = 0.478, alpha = 0.1029, 
	n = 9.45, b0 = 0.2278, b1 = -0.0165, b2 = 0.000248), 
	from = 0, to = 40,
	ylab = "Water content",
	xlab = "Matric potential")

# End (Not run)
</code></pre>

<hr>
<h2 id='SSlbc'> Self-Starting Nls Load Bearing Capacity Model </h2><span id='topic+SSlbc'></span>

<h3>Description</h3>

<p>A  <code><a href="stats.html#topic+selfStart">selfStart</a></code> model that evaluates the Load Bearing Capacity
(Dias Jr., 1994) function and its gradient. It has an initial attribute
that creates initial estimates of the parameters b0 and b1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> SSlbc(theta, b0, b1) </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SSlbc_+3A_theta">theta</code></td>
<td>
<p> a numeric vector of soil moisture values at which to evaluate the model. </p>
</td></tr>
<tr><td><code id="SSlbc_+3A_b0">b0</code></td>
<td>
<p> a numeric parameter. </p>
</td></tr>
<tr><td><code id="SSlbc_+3A_b1">b1</code></td>
<td>
<p> a numeric parameter. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>a numeric vector with the same length of <code>theta</code>. It is the value of the
expression <code class="reqn">10^{(b0 + b1 * \theta)}</code>. Also, the gradient matrix with respect
to the parameters is attached as an attribute named <em>gradient</em>.
</p>


<h3>Author(s)</h3>

<p> Anderson Rodrigo da Silva &lt;anderson.agro@hotmail.com&gt; </p>


<h3>References</h3>

<p>Dias Junior, M. S. (1994). <em>Compression of three soils under longterm
tillage and wheel traffic</em>. 1994. 114p. Ph.D. Thesis - Michigan
State University, East Lansing.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+getInitiallbc">getInitiallbc</a></code>, <code><a href="#topic+fitlbc">fitlbc</a></code>, <code><a href="stats.html#topic+selfStart">selfStart</a></code>,
<code><a href="stats.html#topic+nls">nls</a></code>, <code><a href="#topic+sigmaP">sigmaP</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(compaction)
attach(compaction)
ss &lt;- SSlbc(Mois, 2.79, -2.33)
ss[1:50] # prediction
PS # original data of preconsolidation stress
ss # prediction and gradient

# End (not run)
</code></pre>

<hr>
<h2 id='stressTraffic'>
Predicting Soil Stress Due to Agricultural Trafficability
</h2><span id='topic+stressTraffic'></span>

<h3>Description</h3>

<p>Contact area, stress distribuition and stress propagation based on the SoilFlex model 
(Keller 2005; Keller et al. 2007) are calculated. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stressTraffic(inflation.pressure, recommended.pressure, tyre.diameter, 
    tyre.width, wheel.load, conc.factor, layers, plot.contact.area = FALSE, ...) 
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="stressTraffic_+3A_inflation.pressure">inflation.pressure</code></td>
<td>
<p> tyre inflation pressure, kPa</p>
</td></tr>
<tr><td><code id="stressTraffic_+3A_recommended.pressure">recommended.pressure</code></td>
<td>
<p> recommended tyre inflation pressure at given load, kPa</p>
</td></tr>
<tr><td><code id="stressTraffic_+3A_tyre.diameter">tyre.diameter</code></td>
<td>
<p> overall diameter of the unloaded tyre, m</p>
</td></tr>
<tr><td><code id="stressTraffic_+3A_tyre.width">tyre.width</code></td>
<td>
<p> tyre width, m</p>
</td></tr>
<tr><td><code id="stressTraffic_+3A_wheel.load">wheel.load</code></td>
<td>
<p> wheel load, kg</p>
</td></tr>
<tr><td><code id="stressTraffic_+3A_conc.factor">conc.factor</code></td>
<td>
<p> concentration factor; a numeric vector ranging from 3 (wet soil) to 6 (dry soil), depending on water content.</p>
</td></tr>
<tr><td><code id="stressTraffic_+3A_layers">layers</code></td>
<td>
<p> a numeric vector containing values of depth (in meters) for the soil layers. Note that layers can also be a unique value</p>
</td></tr>
<tr><td><code id="stressTraffic_+3A_plot.contact.area">plot.contact.area</code></td>
<td>
<p> logical; shall <code>soilTraffic</code> plot the distribution of stress over the contact area?</p>
</td></tr>
<tr><td><code id="stressTraffic_+3A_...">...</code></td>
<td>
<p> further graphical arguments. See <a href="graphics.html#topic+par">par</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of
</p>
<table role = "presentation">
<tr><td><code>Area</code></td>
<td>
<p> Contact area parameters.</p>
</td></tr>
<tr><td><code>Loads</code></td>
<td>
<p> Estimated wheel loads.</p>
</td></tr>
<tr><td><code>Stress</code></td>
<td>
<p> Stress propagation into soil; sigma_vertical: vertical stress; sigma_mean: mean normal stress</p>
</td></tr>
<tr><td><code>stress.matrix</code></td>
<td>
<p> The matrix of applied stress at a specific depth and radial distance from the tyre centre.</p>
</td></tr>
<tr><td><code>fZStress</code></td>
<td>
<p> The function of stress propagation in z direction (vertical stress).</p>
</td></tr>
<tr><td><code>fmeanStress</code></td>
<td>
<p> The function of mean normal stress propagation.</p>
</td></tr>
<tr><td><code>fStress</code></td>
<td>
<p> The function of stress propagation.</p>
</td></tr>
<tr><td><code>fXStress</code></td>
<td>
<p> The function of stress propagation in x (footprint length or driving) direction.</p>
</td></tr>
<tr><td><code>fYStress</code></td>
<td>
<p> The function of stress propagation in y (tire width) direction.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Renato Paiva de Lima &lt;renato_agro_@hotmail.com&gt;
</p>
<p>Anderson Rodrigo da Silva &lt;anderson.agro@hotmail.com&gt;
</p>
<p>Alvaro Pires da Silva &lt;apisilva@usp.br&gt;
</p>


<h3>References</h3>

<p>Keller, T. 2005. A model to predict the contact area and the distribution of vertical stress below agricultural tyres 
from readily-available tyre parameters. <em>Biosyst. Eng.</em> 92, 85-96.
</p>
<p>Keller, T.; Defossez, P.; Weisskopf, P.; Arvidsson, J.; Richard, G. 2007. SoilFlex: a model for prediction of soil 
stresses and soil compaction due to agricultural field traffic including a synthesis of analytical approaches. 
<em>Soil and Tillage Research</em> 93, 391-411.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>stress &lt;- stressTraffic(inflation.pressure=200, 
	   recommended.pressure=200, 
	   tyre.diameter=1.8, 
	   tyre.width=0.4, 
	   wheel.load=4000, 
	   conc.factor=c(4,5,5,5,5,5),
           layers=c(0.05,0.1,0.3,0.5,0.7,1), 
	   plot.contact.area = TRUE)

stress

# Building a fancier plot for the contact area
# library(fields)
# image.plot(x = as.numeric(rownames(stress$stress.matrix)), 
#	       y = as.numeric(colnames(stress$stress.matrix)), 
#	       z = stress$stress.matrix,  
#	       xlab="Tyre footprint length (m)", ylab="Tyre width (m)") 
# End (not run)

# Stress Propagation 
# Vertical Stress
stress.v &lt;- stress$Stress$sigma_vertical
layers &lt;- stress$Stress$Layers
plot(x = 1, y = 1, xlim=c(0,300),ylim=c(1,0),xaxt = "n",
     ylab = "Soil Depth",xlab ="", type="l", main="")
axis(3)
mtext("Stress (kPa)",side=3,line=2.5)
lines(x=stress.v, y=layers)

# Mean normal stress
stress.p &lt;- stress$Stress$sigma_mean
lines(x=stress.p, y=layers, lty=2)
legend("bottomright", c("Vertical stress", "Normal mean stress"), lty = 1:2)

# End (not run)
</code></pre>

<hr>
<h2 id='voidratio'> Void Ratio </h2><span id='topic+voidratio'></span>

<h3>Description</h3>

<p> A function to calculate the soil void ratio. </p>


<h3>Usage</h3>

<pre><code class='language-R'>voidratio(wetsoil, drysoil, diam.cylinder, height.cylinder,
    dens.particle, deformation)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="voidratio_+3A_wetsoil">wetsoil</code></td>
<td>
<p> the weight of wet soil. </p>
</td></tr>
<tr><td><code id="voidratio_+3A_drysoil">drysoil</code></td>
<td>
<p> the weight of dry soil. </p>
</td></tr>
<tr><td><code id="voidratio_+3A_diam.cylinder">diam.cylinder</code></td>
<td>
<p> the diameter of the cylinder. </p>
</td></tr>
<tr><td><code id="voidratio_+3A_height.cylinder">height.cylinder</code></td>
<td>
<p> the heigth of the cylinder. </p>
</td></tr>
<tr><td><code id="voidratio_+3A_dens.particle">dens.particle</code></td>
<td>
<p> the particle density. </p>
</td></tr>
<tr><td><code id="voidratio_+3A_deformation">deformation</code></td>
<td>
<p> a numeric vector containing soil deformation values. </p>
</td></tr>
</table>


<h3>Value</h3>

<p> A numeric vector with same length of <code>deformation</code> containig void ratio values. </p>


<h3>Author(s)</h3>

<p> Anderson Rodrigo da Silva &lt;anderson.agro@hotmail.com&gt; </p>


<h3>See Also</h3>

 <p><code><a href="#topic+sigmaP">sigmaP</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>def &lt;- c(0, 0.0230, 0.0352, 0.0605, 0.1070, 0.1750, 0.2525, 0.3395, 0.4250)
pres &lt;- c(1, 12.5, 25, 50, 100, 200, 400, 800, 1600)
VR &lt;- voidratio(wetsoil = 170.62, drysoil = 134.08, diam.cylinder = 6.95, 
               height.cylinder = 2.5, dens.particle = 2.61, def)
VR

plot(VR ~ pres, type = "b",
	ylab = "Void ratio",
	xlab = "Applied stress (kPa)",
	main = "Compression curve", 
	log = "x")

# End (not run)
</code></pre>

<hr>
<h2 id='WRC_App'>A shiny to automatically fit the water retention curve</h2><span id='topic+WRC_App'></span>

<h3>Description</h3>

<p>Use the maximum likelihood method to find the water retention curve that best fits the data.</p>


<h3>Usage</h3>

<pre><code class='language-R'>WRC_App()
</code></pre>


<h3>Value</h3>

<p>A shiny app</p>


<h3>Author(s)</h3>

<p> Anderson Rodrigo da Silva &lt;anderson.agro@hotmail.com&gt; </p>


<h3>See Also</h3>

<p><code><a href="#topic+fitsoilwater_App">fitsoilwater_App</a></code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
