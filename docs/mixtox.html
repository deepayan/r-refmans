<!DOCTYPE html><html><head><title>Help for package mixtox</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {mixtox}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#antibiotox'><p>Toxicity of Seven Antibiotics on Photobacteria</p></a></li>
<li><a href='#BMD'><p>Calculating benchmark dose (BMD) and lower limit of benchmark dose (BMDL)</p></a></li>
<li><a href='#caPred'><p>Mixture Toxicity Prediction Based on Concentration Addition</p></a></li>
<li><a href='#CEx'><p>Effect Calculation for All Ninteen Curves</p></a></li>
<li><a href='#curveFit'><p>Curve Fitting</p></a></li>
<li><a href='#cytotox'><p>Cytotoxicity of Heavy Metal Ions and Ionic Liquids on MCF-7</p></a></li>
<li><a href='#DTcv'><p>critical value for Dunnett's test</p></a></li>
<li><a href='#ecaPred'><p>Mixture Effect Predicted by CA at Particular Concentration of a Mixture</p></a></li>
<li><a href='#ECx'><p>Effect Concentration Calculation for Sigmoidal Models</p></a></li>
<li><a href='#eiaPred'><p>Mixture Effect Predicted by IA at Particular Concentration of a Mixture</p></a></li>
<li><a href='#figPlot'><p>Ploting concentration response curve</p></a></li>
<li><a href='#gcaHill'><p>Mixture Toxicity Prediction Using GCA (Hill_two)</p></a></li>
<li><a href='#gcaPred'><p>Mixture Toxicity Prediction Using GCA (General)</p></a></li>
<li><a href='#getCI'><p>Calculating Confidence Intervals</p></a></li>
<li><a href='#hormesis'><p>Non-monotonic Concentration-response Data</p></a></li>
<li><a href='#iaPred'><p>Mixture Toxicity Prediction Based on Independent Action</p></a></li>
<li><a href='#jacobian'><p>Jacobian Matrix Calculation</p></a></li>
<li><a href='#mixtox'>
<p>Dose-Response Curve Fitting and Mixture Toxicity Assessment</p></a></li>
<li><a href='#nmECx'><p>Effect Concentration Calculation for J-shaped Models</p></a></li>
<li><a href='#NOEC'><p>NOEC and LOEC Calculation</p></a></li>
<li><a href='#qq4res'><p>Residual Normal QQ Plot</p></a></li>
<li><a href='#readModel'><p>Read curve fitting information</p></a></li>
<li><a href='#readTox'><p>Read dose-response data</p></a></li>
<li><a href='#showEq'><p>List Requested Equations</p></a></li>
<li><a href='#staval'><p>Starting Values for 13 Sigmoidal and  4 Hormetic Models</p></a></li>
<li><a href='#tuneFit'><p>Find Optimal Starting values for Curve Fitting</p></a></li>
<li><a href='#unidTab'><p>Uniform Design Table</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Dose Response Curve Fitting and Mixture Toxicity Assessment</td>
</tr>
<tr>
<td>Version:</td>
<td>1.4.0</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.2.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>minpack.lm</td>
</tr>
<tr>
<td>Description:</td>
<td>Curve Fitting of monotonic(sigmoidal) &amp; non-monotonic(J-shaped) 
 dose-response data. Predicting mixture toxicity based on reference 
 models such as 'concentration addition', 'independent action', and 'generalized 
 concentration addition'.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/ichxw/mixtox">https://github.com/ichxw/mixtox</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-06-19</td>
</tr>
<tr>
<td>Author:</td>
<td>Xiangwei Zhu</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Xiangwei Zhu &lt;xwzhunc@gmail.com&gt;</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-06-20 16:13:12 UTC; xzhu</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-06-20 16:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='antibiotox'>Toxicity of Seven Antibiotics on Photobacteria</h2><span id='topic+antibiotox'></span>

<h3>Description</h3>

<p>Seven antibiotics are: Neomycin sulfate(NEO), streptomycin sulfate(STR), 
kanamycin sulfate(KAN), spectinomycin dihydrochloridehydrate(SPE), paromomycin 
sulfate(PAR), dihydrostreptomycin sesquisulfate hydrate(DIH), and gentamycin 
sulfate(GEN). Their toxicity on photobacteria Q67 were tested using 
microplate toxicity analysis.<br />
The concentration-responses include the toxicity of seven antibiotics,
two eecr mixtures, and ten mixtures designed by udcr. The curve fitting 
information of seven antibiotics and a total of 12 mixtures. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(antibiotox)</code></pre>


<h3>Format</h3>

<p>A list with concentration-response data of 7 antibiotics, 12 mixtures, and associated
fitting information.
</p>

<dl>
<dt><code>PAR$x</code></dt><dd><p>a numeric vector of concentrations</p>
</dd>
<dt><code>PAR$y</code></dt><dd><p>a numeric matrix of responses</p>
</dd>
<dt><code>PAR$name</code></dt><dd><p>name of test substance</p>
</dd>
<dt><code>PAR$concNum</code></dt><dd><p>the number of concentrations</p>
</dd>
<dt><code>PAR$tierNum</code></dt><dd><p>the number of repetitions</p>
</dd>
<dt><code>PAR$type</code></dt><dd><p>type of test substance</p>
</dd>
<dt><code>sgl$model</code></dt><dd><p>models used to fit the concentration-response data
</p>
</dd>
<dt><code>sgl$param</code></dt><dd><p>fitted coefficients of concentration-response curves
</p>
</dd>
<dt><code>udcr.mix$model</code></dt><dd><p>models used to fit the concentration-response data of udcr mixtures on 
photobacteria
</p>
</dd>
<dt><code>udcr.mix$param</code></dt><dd><p>fitted coefficients of concentration-response curves
</p>
</dd>
<dt><code>udcr.pct</code></dt><dd><p>the percentage of individual chemicals in the udcr mixtures</p>
</dd>
<dt><code>eecr.mix$model</code></dt><dd><p>models used to fit the concentration-response data of eecr mixtures on 
photobacteria
</p>
</dd>
<dt><code>eecr.mix$param</code></dt><dd><p>fitted coefficients of concentration-response curves
</p>
</dd>
<dt><code>eecr.pct</code></dt><dd><p>the proportion of individual chemicals in the eecr mixtures</p>
</dd>
</dl>



<h3>Details</h3>

<p>Quantal responses[0, 1] are needed for curve fitting using the following six equaitons:
i.e., Weibull, Logit, Hill, BCL, GL, BCW. The following equation could transform 
continous responses to quantal ones: 
</p>
<p style="text-align: center;"><code class="reqn">E = \frac{{{I_0} - {I_i}}}{{{I_0}}}</code>
</p>

<p>where <code class="reqn">I_0</code> is the average of controls for inhibition tests or the average 
of the maximum effect for stimulation tests and <code class="reqn">I_i</code> the average 
effect of the <code class="reqn">i^{th}</code> treatment.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># example 1
## Retrive the toxicity information of PAR on photobacteria.
antibiotox$PAR
# example 2
## Retrive the toxicity information of two eecr mixtures on photobacteria.
antibiotox$eecr.mix
</code></pre>

<hr>
<h2 id='BMD'>Calculating benchmark dose (BMD) and lower limit of benchmark dose (BMDL)</h2><span id='topic+BMD'></span>

<h3>Description</h3>

<p>Calculation of BMD and BMDL for both quantal and continuous dose responses. Six 
2- or 3-paramter models ('Hill', 'Weibull', 'Logit', 'Weibull_three', 'Hill_three', 
'Logit_three') were employed for quantal dose responses. Three 4-parameter 
models ('Weibull_four', 'Logit_four', 'Hill_four') were employed for continuous data. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BMD(object, bmr = 0.10, backg = 0, def = 'additional', eq = 'as.is', 
         sigLev = 0.05, ci = 'CI', sav = FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BMD_+3A_object">object</code></td>
<td>
<p> object of class curveFit.</p>
</td></tr>
<tr><td><code id="BMD_+3A_bmr">bmr</code></td>
<td>
<p> numeric vector of bench mark response levels for which to calculate benchmark
doses (should be between 0 and 1)</p>
</td></tr>
<tr><td><code id="BMD_+3A_backg">backg</code></td>
<td>
<p>numeric value specifying the background level (defaults to 0)</p>
</td></tr>
<tr><td><code id="BMD_+3A_def">def</code></td>
<td>
<p>character string specifiying the definition of the benchmark dose to use in the
calculations. &quot;excess&quot; and &quot;additional&quot; are for binomial response whereas &quot;relative&quot; 
and &quot;hybrid&quot; (additive hybrid) are for continuous response.</p>
</td></tr>
<tr><td><code id="BMD_+3A_eq">eq</code></td>
<td>
<p>default list of equations.</p>
</td></tr>
<tr><td><code id="BMD_+3A_siglev">sigLev</code></td>
<td>
<p>the significance level for Dunnett's test. The default is 0.05.</p>
</td></tr>
<tr><td><code id="BMD_+3A_ci">ci</code></td>
<td>
<p>types of confidence intervals (CI or PI).CI: non-simultaneous confidence intervals;
PI: non-simultaneous prediction intervals.</p>
</td></tr>  
<tr><td><code id="BMD_+3A_sav">sav</code></td>
<td>
<p>TRUE: save output to a default file; FALSE: output will not be saved; 
a custom file directory: save output to the custom file directory.</p>
</td></tr> 
</table>


<h3>Details</h3>

<p> Selecting the Benchmark Response Level (BMR) (https://www.epa.gov/bmds/
benchmark-dose-bmd-methods#bmr).BMR is usually set as 0.10.
</p>


<h3>Value</h3>

<table>
<tr><td><code>bmds</code></td>
<td>
<p>values of BMDL, BMD, and BMDU.</p>
</td></tr>
</table>


<h3>Note</h3>

<p> three default equations (Hill, Weibull, and Logit) were used to calculate BMD for
quantal dose response. Three default equations('Weibull_four', 'Logit_four', 'Hill_four') 
were used to calculate BMD for continuous dose response. BMD calculation is only availabale for
monotonic dose reponses in this version.
</p>


<h3>References</h3>

<p>Benchmark Dose Technical Guidance, Risk Assessment Forum, U.S. Environmental Protection Agency, 
Washington, DC 20460, EPA/100/R-12/001, June 2012<br />
Kennyp (2002). Critical Issues in Benchmark Calculations from Continuous Data. Crit. 
Rev. Toxicol., 32, 133-153.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## example 1
# calcualte the BMD of heavy metal Ni(2+) on the MCF-7 cells 
x &lt;- cytotox$Ni$x
rspn &lt;- cytotox$Ni$y
obj &lt;- curveFit(x, rspn, eq = 'Logit', param = c(12, 3), effv = c(0.05, 0.5), rtype = 'quantal')
BMD(obj, bmr = 0.10, backg = 0, def = 'additional', eq = 'default', sigLev = 0.05, ci = 'CI')
</code></pre>

<hr>
<h2 id='caPred'>Mixture Toxicity Prediction Based on Concentration Addition</h2><span id='topic+caPred'></span>

<h3>Description</h3>

<p>Predicting mixture toxicity based on individual concentration-response 
information fitted only based on the following six models: Hill, 
Weibull, Logit, BCW, BCL, and GL. Three optional mixture design methods 
are provided:(1)arbitrary concentration ratio (acr), users can set 
an arbitary proportion for each component in a mixture; (2)equal effect 
concentration ratio (eecr); (3) uniform design concentration ratio (udcr).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>caPred(model, param, mixType = "eecr", effv, effPoints, sav = FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="caPred_+3A_model">model</code></td>
<td>
<p>vector of models: Hill, Weibull, Logit, BCW, BCL, and GL</p>
</td></tr>
<tr><td><code id="caPred_+3A_param">param</code></td>
<td>
<p>numeric matrix of fitting coefficients with row names (model selected) and 
column names (Alpha, Beta, and Gamma). For models with only two parameters (i.e., 
Hill, Weibull, and Logit), Gamma can be set to zero or any other numeric value.</p>
</td></tr>
<tr><td><code id="caPred_+3A_mixtype">mixType</code></td>
<td>
<p>experimental design of the mixture. 
acr: arbitrary concentration ratio; 
eecr: equal effect concentration ratio; 
udcr: uniform design concentration ratio.</p>
</td></tr>
<tr><td><code id="caPred_+3A_effv">effv</code></td>
<td>
<p>numeric vector with single or multiple effects (0 ~ 1).</p>
</td></tr>
<tr><td><code id="caPred_+3A_effpoints">effPoints</code></td>
<td>
<p>numeric vector [0 ~ 1] of effects to predict 
effect concentrations.</p>
</td></tr>
<tr><td><code id="caPred_+3A_sav">sav</code></td>
<td>
<p>TRUE: save output to a default file; FALSE: output will not be saved; 
a custom file directory: save output to the custom file directory.</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>Concentration addition (CA) is designed for mixtures of chemicals that have similar 
mechanisms of action. For a well-defined mixture (e.g., a mixture of n components), 
CA is expressed mathematically as: 
</p>
<p style="text-align: center;"><code class="reqn">\sum\limits_{i = 1}^n {\frac{{{c_i}}}{{EC{x_i}}}}  = 1</code>
</p>

<p>where <code class="reqn">EC{x_i}</code> is the effect concentration of the <code class="reqn">i^{th}</code> compound that 
causes x% effect when applied individually at <code class="reqn">{c_i}</code>. The <code class="reqn">{c_i}</code> can be 
computed from the following equation:
</p>
<p style="text-align: center;"><code class="reqn">{c_i} = {p_i} \cdot {c_{mix}} = {p_i} \cdot E{C_{x,mix}}</code>
</p>

<p>where <code class="reqn">p_i</code> is the proportion of <code class="reqn">i^{th}</code> component in the mixture, 
<code class="reqn">c_{mix}</code> the mixture concentration and <code class="reqn">E{C_{x,mix}}</code> the 
concentration of the mixture at a specific effect x%. The prediction 
of combined effects of mixture-components based on 
CA can then be expressed as:
</p>
<p style="text-align: center;"><code class="reqn">E{C_{x,mix}} = {\left( {\sum\limits_{i = 1}^n {\frac{{{p_i}}}{{E{C_{x,i}}}}}} 
				\right)^{ - 1}}</code>
</p>



<h3>Value</h3>

<table>
<tr><td><code>ca</code></td>
<td>
<p> a series of effect concentrations predicted by CA at effPoints</p>
</td></tr>
<tr><td><code>e</code></td>
<td>
<p>a series of effects (effPoints) associated with the effect concentrations in ca</p>
</td></tr>
<tr><td><code>pct</code></td>
<td>
<p>the proportion of every component in a mixture</p>
</td></tr>
<tr><td><code>uniTab</code></td>
<td>
<p>the uniform design table used to construct the mixture when mixType is 'udcr'</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Note that effv is dependent on the mixType.<br />
If the mixType is acr, effv is supposed to be a vector with the ratio of each components and its length 
should be the same as the number of components. For instance, effv can be c(4, 1) if one wants to mix two 
compounds with a ratio of 4:1. One can also set effv as c(80, 20) or c(0.8, 0.2) or any other values 
with the same ratio as 4:1. The program will convert the ratio to a range of 0 to 100%.<br />
If the mixType is eecr, effv is supposed to be the effect values. For instance, effv = c(0.5) means one mixture 
will be prepared and each of its components will be mixed in a ratio equal to EC50. More than one eecr mixtures 
can be achieved by assigning more effect values to effv, e.g., effv = c(0.05, 0.10, 0.5) <br />
If the mixType is udcr, elements in effv are levels in a uniform table, the length of effv is the same as 
the number of runs. the number of runs should be consistent with the number of components in the uniform design.
</p>


<h3>References</h3>

<p>Liang, Yi-zeng, Kai-tai Fang, and Qing-song Xu. 2001. Uniform Design and Its Applications in 
Chemistry and Chemical Engineering. Chemometrics and Intelligent Laboratory Systems 
58(1):43-57.<br />
Backhaus, T., Faust, M., 2012. Predictive environmental risk assessment of chemical 
mixtures: A conceptual framework. Environmental Science and Technology. 46, 2564-2573.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+iaPred">iaPred</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## example 1
# using CA to predict the toxicity of mixture designed by eecr at the
# effect concentration of EC05 and EC50
# eecr mixture design is based on seven antibiotics(factors).
model &lt;- antibiotox$sgl$model
param &lt;- antibiotox$sgl$param
caPred(model, param, mixType = "eecr", effv = c(0.05, 0.5))

## example 2
# using CA to predict the mixtures designed by udcr
# the udcr mixture design is based on four heavy metals and four ionic liquids (eight factors).
# five levels (EC05, EC10, EC20, EC30, and EC50 ) are allocated in the uniform table using the
# pseudo-level technique (Liang et al., 2001)
model &lt;- cytotox$sgl$model
param &lt;- cytotox$sgl$param
effv &lt;- c(0.05, 0.05, 0.10, 0.10, 0.20, 0.20, 0.30, 0.30, 0.50, 0.50)
caPred(model, param, mixType = "udcr", effv)

## example 3
# using CA to predict the mixtures designed by acr
# the udcr mixture design is based on five antibiotics (five factors).
# the every component in the mixture shares exactly the same ratio (0.20) 
model &lt;- antibiotox$sgl$model[1 : 5]
param &lt;- antibiotox$sgl$param[1 : 5, ]
effv &lt;- c(0.2, 0.2, 0.2, 0.2, 0.2)
caPred(model, param, mixType = "acr", effv)
</code></pre>

<hr>
<h2 id='CEx'>Effect Calculation for All Ninteen Curves</h2><span id='topic+CEx'></span>

<h3>Description</h3>

<p>Calculating responses at particular concentrations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CEx(model, param, conc, sav = FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CEx_+3A_model">model</code></td>
<td>
<p>a character vector of equation names</p>
</td></tr>
<tr><td><code id="CEx_+3A_param">param</code></td>
<td>
<p>a numeric matrix of fitting coefficients with rownames (equation selected) and 
colnames (ALpha, Beta, and Gamma). For equations with two parameters, Gamma can be set as 
zero or any other numeric value.
</p>
</td></tr>
<tr><td><code id="CEx_+3A_conc">conc</code></td>
<td>
<p>a numeric vector with single or multiple concentrations.</p>
</td></tr>
<tr><td><code id="CEx_+3A_sav">sav</code></td>
<td>
<p>TRUE: save output to a default file; FALSE: output will not be saved; 
a custom file directory: save output to the custom file directory.</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>Responses will be calculated with provided equations (model), associated 
fitting parameters (param), and concentrations.
</p>


<h3>Value</h3>

 
<table>
<tr><td><code>effv</code></td>
<td>
<p>a numeric vector of effect(s)</p>
</td></tr>
</table>


<h3>References</h3>

<p>Zhu X-W, et.al. 2013. Modeling non-monotonic dose-response relationships: Model evaluation 
and hormetic quantities exploration. Ecotoxicol. Environ. Saf. 89:130-136.<br />
Hill equation (biochemistry) http://en.wikipedia.org/wiki/Hill_equation_(biochemistry)<br />
Scholze, M. et al. 2001. A General Best-Fit Method for Concentration-Response Curves and the
Estimation of Low-Effect Concentrations. Environmental Toxicology and Chemistry 20(2):448-457.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## example 1
# calculate the responses of hormesis curves at the concentration of 0.1 and 0.02 mol/L
model &lt;- hormesis$sgl$model
param &lt;- hormesis$sgl$param
CEx(model, param, conc = c(0.1, 0.02)) 

## example 2
# calculate the effect caused by four heavy metals and four ionic liquids at the concentration of
# 0.00001 and 0.00002 mol/L on the MCF-7 cells
model &lt;- cytotox$sgl$model
param &lt;- cytotox$sgl$param
CEx(model, param, conc = c(0.00001, 0.00002)) 

## example 3
# calculate the response ranges
model &lt;- hormesis$sgl$model
param &lt;- hormesis$sgl$param
CEx(model, param, conc = c(0, 1e20))
</code></pre>

<hr>
<h2 id='curveFit'>Curve Fitting</h2><span id='topic+curveFit'></span>

<h3>Description</h3>

<p>Thirteen monotonic(sigmoidal) models (&quot;Hill&quot;, &quot;Hill_two&quot;, &quot;Hill_three&quot;, &quot;Hill_four&quot;,
&quot;Weibull&quot;, &quot;Weibull_three&quot;, &quot;Weibull_four&quot;, &quot;Logit&quot;, &quot;Logit_three&quot;, &quot;Logit_four&quot;,
&quot;BCW(Box-Cox-Weibull)&quot;, &quot;BCL(Box-Cox-Logit)&quot;, &quot;GL(Generalized Logit)&quot;) and four
non-monotonic(J-shaped) models (&quot;Brain_Consens&quot;, &quot;BCV&quot;, &quot;Biphasic&quot;, &quot;Hill_five&quot;)
are provided to fit dose-response data. The goodness of fit of a model
is evaluated by the following statistics: coefficient of
determination (<code class="reqn">R^2</code>), adjusted coefficient of determination (<code class="reqn">R_{adj}^2</code>),
root mean squared error (RMSE), mean absolute error (MAE), Akaike information criterion (AIC),
bias-corrected Akaike information criterion(AICc), and Bayesian information criterion (BIC).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>curveFit(x, rspn, eq , param, effv, rtype = 'quantal', sigLev = 0.05, sav = FALSE, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="curveFit_+3A_x">x</code></td>
<td>
<p>a numeric vector of experimental concentration.</p>
</td></tr>
<tr><td><code id="curveFit_+3A_rspn">rspn</code></td>
<td>
<p>a numeric matrix of experimental responses with one or more replicates.</p>
</td></tr>
<tr><td><code id="curveFit_+3A_eq">eq</code></td>
<td>
<p>equation used for curve fitting: &quot;Hill&quot;, &quot;Hill_two&quot;, &quot;Hill_three&quot;, &quot;Hill_four&quot;,
&quot;Weibull&quot;, &quot;Weibull_three&quot;, &quot;Weibull_four&quot;, &quot;Logit&quot;, &quot;Logit_three&quot;, &quot;Logit_four&quot;,
&quot;BCW&quot;, &quot;BCL&quot;, &quot;GL&quot;, &quot;Brain_Consens&quot;, &quot;BCV&quot;, &quot;Biphasic&quot;, &quot;Hill_five&quot;.</p>
</td></tr>
<tr><td><code id="curveFit_+3A_param">param</code></td>
<td>
<p>a vector of starting parameters. Use tuneFit to get the starting values.</p>
</td></tr>
<tr><td><code id="curveFit_+3A_effv">effv</code></td>
<td>
<p>a numeric vector of responses for the calculation of effect concentrations.
Minus values(e.g., -5%) are permited only in the condition of 'hormesis' 
dose-responses. 
Relative values(e.g., 5%, 10%) in the condition of 'continuous' dose-responses.
</p>
</td></tr>
<tr><td><code id="curveFit_+3A_rtype">rtype</code></td>
<td>
<p>three dose-response types: 'quantal', 'continuous', 'hormesis'. 
Default is 'quantal'. 
'quantal': dose-responses with lower limit fixed at 0 and higher limit at 1 (100%). 
'continuous': dose-responses with no fixed lower or higher limits.
'hormesis': non-monotonic J or U-shaped dose-responses with lower limit fixed at 0 
and higher limit at 1 (100%).
</p>
</td></tr>
<tr><td><code id="curveFit_+3A_siglev">sigLev</code></td>
<td>
<p>the significant level for confidence intervals and Dunnett\'s test. Default
is 0.05.</p>
</td></tr>
<tr><td><code id="curveFit_+3A_sav">sav</code></td>
<td>
<p>TRUE: save output to a default file; FALSE: output will not be saved; 
a custom file directory: save output to the custom file directory.</p>
</td></tr> 
<tr><td><code id="curveFit_+3A_...">...</code></td>
<td>
<p>other arguments passed to nlsLM in minpack.lm.</p>
</td></tr>	
</table>


<h3>Details</h3>

<p>Curve fitting is dependent on the package minpack.lm
(http://cran.r-project.org/web/packages/minpack.lm/index.html).<br />
Monotonic(sigmoidal) equations are as follows:<br />
Hill: </p>
<p style="text-align: center;"><code class="reqn">E = 1/\left( {1 + {{\left( {\alpha /c} \right)}^\beta }} \right)</code>
</p>

<p>Hill_two: </p>
<p style="text-align: center;"><code class="reqn">E = \beta c/\left( {\alpha  + c} \right)</code>
</p>

<p>Hill_three: </p>
<p style="text-align: center;"><code class="reqn">E = \gamma /\left( {1 + {{\left( {\alpha /c} \right)}^\beta }} \right)</code>
</p>

<p>Hill_four: </p>
<p style="text-align: center;"><code class="reqn">E = \delta  + \left( {\gamma  - \delta } \right)/\left( {1 +
							{{\left( {\alpha /c} \right)}^\beta }} \right)</code>
</p>

<p>where <code class="reqn">\alpha</code> = EC50, <code class="reqn">\beta</code> = H (Hill coefficient), <code class="reqn">\gamma</code> = Top,
and <code class="reqn">\delta</code> = Bottom <br />
</p>
<p>Weibull: </p>
<p style="text-align: center;"><code class="reqn">E = 1 - \exp ( - \exp (\alpha  + \beta \log (c)))</code>
</p>

<p>Weibull_three: 	</p>
<p style="text-align: center;"><code class="reqn">E = \gamma \left( {1 - \exp \left( { - \exp \left( {\alpha  +
		                       \beta \log \left( c \right)} \right)} \right)} \right)</code>
</p>

<p>Weibull_four: </p>
<p style="text-align: center;"><code class="reqn">E = \gamma  + \left( {\delta  - \gamma } \right)\exp \left(
		                   { - \exp \left({\alpha  + \beta \log \left( c \right)} \right)} \right)</code>
</p>

<p>Logit: </p>
<p style="text-align: center;"><code class="reqn">E = {(1 + \exp ( - \alpha  - \beta \log (c)))^{ - 1}}</code>
</p>

<p>Logit_three: </p>
<p style="text-align: center;"><code class="reqn">E = \gamma /\left( {1 + \exp \left( {\left( { - \alpha } \right)
		                - \beta \log \left( c \right)} \right)} \right)</code>
</p>

<p>Logit_four: </p>
<p style="text-align: center;"><code class="reqn">E = \delta  + \left( {\gamma  - \delta } \right)/\left( {1 + \exp \left
		            ( {\left( { - \alpha } \right) - \beta \log \left( c \right)} \right)} \right)</code>
</p>

<p>where <code class="reqn">\alpha</code> is the location parameter and <code class="reqn">\beta</code> slope parameter.
<code class="reqn">\gamma</code> = Top, and <code class="reqn">\delta</code> = Bottom <br />
</p>
<p>BCW: </p>
<p style="text-align: center;"><code class="reqn">E = 1 - \exp \left( { - \exp \left( {\alpha  + \beta \left(
				{\frac{{{c^\gamma } - 1}}{\gamma }} \right)} \right)} \right)</code>
</p>

<p>BCL: </p>
<p style="text-align: center;"><code class="reqn">E = {(1 + \exp ( - \alpha  - \beta (({c^\gamma } - 1)/\gamma )))^{ - 1}}</code>
</p>

<p>GL: </p>
<p style="text-align: center;"><code class="reqn">E = 1/{(1 + \exp ( - \alpha  - \beta \log (c)))^\gamma }</code>
</p>

<p>Non-monotonic(J-shaped) models:<br />
Hill_five: </p>
<p style="text-align: center;"><code class="reqn">E = 1 - \left( {1 + \left( {\gamma  - 1} \right)/\left( {1 + {{\left( {\alpha /c}
					\right)}^\beta }} \right)} \right)\left( {1 - 1/\left( {1 + {{\left( {\delta /c} \right)}
					^\varepsilon }} \right)} \right)</code>
</p>

<p>Brain_Consens: </p>
<p style="text-align: center;"><code class="reqn">E = 1 - \left( {1 + \alpha c} \right)/\left( {1 + \exp \left(
		                      {\beta \gamma } \right){c^\beta }} \right)</code>
</p>

<p>where <code class="reqn">\alpha</code> is the initial rate of increase at low concentration, <code class="reqn">\beta</code> 
the way in which 
response decreases with concentration, and <code class="reqn">\gamma</code> no simple interpretation.<br />
</p>
<p>BCV: </p>
<p style="text-align: center;"><code class="reqn">E = 1 - \alpha \left( {1 + \beta c} \right)/\left( {1 + \left( {1 + 2\beta
					\gamma } \right){{\left( {c/\gamma } \right)}^\delta }} \right)</code>
</p>

<p>where <code class="reqn">\alpha</code> is untreated control, <code class="reqn">\beta</code> the initial rate of 
increase at low concentration, <code class="reqn">\gamma</code> the concentration cause 50% inhibition, 
and <code class="reqn">\delta</code> no simple interpretation.<br />
</p>
<p>Cedergreen: </p>
<p style="text-align: center;"><code class="reqn">E = 1 - \left( {1 + \alpha \exp \left( { - 1/\left( {{c^\beta }}
						\right)} \right)} \right)/\left( {1 + \exp \left( {\gamma \left({\ln
						\left( c \right) - \ln \left( \delta  \right)} \right)} \right)} \right)</code>
</p>

<p>where <code class="reqn">\alpha</code> the initial rate of increase at low concentration, <code class="reqn">\beta</code> 
the rate of	hormetic effect manifests itself, 
<code class="reqn">\gamma</code> the steepness of the curve after 
maximum hormetic effect, and <code class="reqn">\delta</code> the lower bound on the EC50 level.<br />
</p>
<p>Beckon: </p>
<p style="text-align: center;"><code class="reqn">E = \left( {\alpha  + \left( {1 - \alpha } \right)/\left( {1 + {{\left(
						{\beta /c} \right)}^\gamma }} \right)} \right)/\left( {1 + {{\left(
						{c/\delta } \right)}^\varepsilon }} \right)</code>
</p>

<p>where <code class="reqn">\alpha</code> is the minimum effect that would be approached by 
the downslope in the absence 
of the upslope, <code class="reqn">\beta</code> the concentration at the midpoint of the falling slope, 
<code class="reqn">\gamma</code> the steepness of the rising(positive) slope, <code class="reqn">\delta</code> the concentration 
at the midpoint of the rising slope, and <code class="reqn">\epsilon</code> the steepness of the 
falling(negative) slope.<br />
</p>
<p>Biphasic: </p>
<p style="text-align: center;"><code class="reqn">E = \alpha  - \alpha /\left( {1 + {{10}^{\left( {\left( {c - \beta }
						\right)\gamma } \right)}}} \right) + \left( {1 - \alpha } \right)/\left
						( {1 + {{10}^{\left( {\left( {\delta  - c} \right)\varepsilon } \right)}}}
						\right)</code>
</p>

<p>where <code class="reqn">\alpha</code> is the minimum effect that would be approached by the 
downslope in the absence 
of the upslope, <code class="reqn">\beta</code> the concentration at the midpoint of the falling slope, 
<code class="reqn">\gamma</code> the steepness of the rising(positive) slope, <code class="reqn">\delta</code> the concentration 
at the midpoint of the
rising slope, and <code class="reqn">\epsilon</code> the steepness of the falling(negative) slope.<br />
In all, <code class="reqn">E</code> represents effect and <code class="reqn">c</code> represents concentration.
</p>


<h3>Value</h3>

<table>
<tr><td><code>fitInfo</code></td>
<td>
<p>curve fitting information.</p>
</td></tr>
<tr><td><code>eq</code></td>
<td>
<p>equation used in curve fitting.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>fitted parameters.</p>
</td></tr>
<tr><td><code>res</code></td>
<td>
<p>residual.</p>
</td></tr>
<tr><td><code>sta</code></td>
<td>
<p>goodness of fit.</p>
</td></tr>
<tr><td><code>crcInfo</code></td>
<td>
<p>a numeric matrix with the experimental concentration (x), predicted and
experimental responses,
experimental responses, lower and upper bounds of (non-simultaneous) prediction intervals
(PI.low and PI.up), and lower and upper bounds of (non-simultaneous) confidence intervals
(CI.low and CI.up).
</p>
</td></tr>
<tr><td><code>ecx</code></td>
<td>
<p>effect concentrations only if effv is provided.</p>
</td></tr>
<tr><td><code>effvAbs</code></td>
<td>
<p>Absolute effects corresponding to effv only in the condition of 'continuous' 
dose-responses.</p>
</td></tr>
<tr><td><code>rtype</code></td>
<td>
<p>dose-response type.</p>
</td></tr>
<tr><td><code>rspnRange</code></td>
<td>
<p>response range. The lower limit is the response at extremely low dose.
The higher limit is the response at infinite high dose.
</p>
</td></tr>
<tr><td><code>minx</code></td>
<td>
<p>concentration to induce the maximum stimulation for 'continuous' dose-response</p>
</td></tr>
<tr><td><code>miny</code></td>
<td>
<p>the maximum stimulation for 'continuous' data.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>tuneFit is recommended to find the starting values.
</p>


<h3>References</h3>

<p>Scholze, M. et al. 2001. A General Best-Fit Method for dose-response Curves and the
Estimation of Low-Effect Concentrations. Environmental Toxicology and Chemistry
20(2):448-457.<br />
Zhu X-W, et.al. 2013. Modeling non-monotonic dose-response relationships: Model evaluation
and hormetic quantities exploration. Ecotoxicol. Environ. Saf. 89:130-136.<br />
Howard GJ, Webster TF. 2009. Generalized concentration addition: A method for examining mixtures 
containing partial agonists. J. Theor. Biol. 259:469-477.<br />	
Spiess, A.-N., Neumeyer, N., 2010. An evaluation of R2 as an inadequate measure for nonlinear
models in pharmacological and biochemical research: A Monte Carlo approach. BMC Pharmacol.
10, 11.<br />
Huet, S., Bouvier, A., Poursat, M.-A., Jolivet, E., 2004. Statistical tools for nonlinear 
regression: a practical guide with S-PLUS and R examples. Springer Science &amp; Business Media.<br />
Gryze, S. De, Langhans, I., Vandebroek, M., 2007. Using the correct intervals for prediction: A
tutorial on tolerance intervals for ordinary least-squares regression. Chemom. Intell. Lab.
Syst. 87, 147-154.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## example 1
# Fit hormesis dose-response data.
# Calculate the concentrations that cause 5% of 50% inhibition.
x &lt;- hormesis$OmimCl$x
rspn &lt;- hormesis$OmimCl$y
curveFit(x, rspn, eq = 'Biphasic', param = c(-0.34, 0.001, 884, 0.01, 128), 
			effv = 0.5, rtype = 'hormesis')

x &lt;- hormesis$HmimCl$x
rspn &lt;- hormesis$HmimCl$y
curveFit(x, rspn, eq = 'Biphasic', param = c(-0.59, 0.001, 160,0.05, 19),  
			effv = c(0.05, 0.5), rtype = 'hormesis')

x &lt;- hormesis$ACN$x
rspn &lt;- hormesis$ACN$y
curveFit(x, rspn, eq = 'Brain_Consens', param = c(2.5, 2.8, 0.6, 2.44),  
			effv = c(0.05, 0.5), rtype = 'hormesis')

x &lt;- hormesis$Acetone$x
rspn &lt;- hormesis$Acetone$y
curveFit(x, rspn, eq = 'BCV', param = c(1.0, 3.8, 0.6, 2.44),  effv = c(0.05, 0.5), 
			rtype = 'hormesis')

## example 2
# Fit quantal dose-responses: the inhibition of heavy metal Ni(2+) on the growth of MCF-7 cells.
# Calculate the concentrations that cause 5% and 50% inhibition. 
x &lt;- cytotox$Ni$x
rspn &lt;- cytotox$Ni$y
curveFit(x, rspn, eq = 'Logit', param = c(12, 3), effv = c(0.05, 0.5), rtype = 'quantal')

## example 3
# Fit quantal dose-responses: the inhibition effect of Paromomycin Sulfate (PAR) on photobacteria.
# Calculate the concentrations that cause 5% and 50% inhibition.
x &lt;- antibiotox$PAR$x
rspn &lt;- antibiotox$PAR$y
curveFit(x, rspn, eq = 'Logit', param = c(26, 4), effv = c(0.05, 0.5))
</code></pre>

<hr>
<h2 id='cytotox'>Cytotoxicity of Heavy Metal Ions and Ionic Liquids on MCF-7</h2><span id='topic+cytotox'></span>

<h3>Description</h3>

<p>Chemicals include four heavy metal ions: 
<code class="reqn">{\rm{NiN}}{{\rm{O}}_{\rm{3}}}\cdot 6{{\rm{H}}_{\rm{2}}}{\rm{O}}</code>(Ni),
<code class="reqn">{\rm{ZnS}}{{\rm{O}}_{\rm{4}}} \cdot {\rm{7}}{{\rm{H}}_{\rm{2}}}{\rm{O}}</code> (Zn), 
<code class="reqn">{\rm{CuS}}{{\rm{O}}_{\rm{4}}} \cdot 5{{\rm{H}}_{\rm{2}}}{\rm{O}}</code> (Cu), and 
<code class="reqn">{\rm{MnC}}{{\rm{l}}_{\rm{2}}} \cdot 4{{\rm{H}}_{\rm{2}}}{\rm{O}}</code> (Mn); 
four ionic liquids are 1-Octyl-3-methylimidazolium chloride (Omim), 
1-Dodecyl-3-methylimidazolium chloride (Dmim), 1-Ethyl-3-methylimidazolium tetrafluoroborate 
(Emim), and 1-Hexyl-3-Methylimidazolium tetrafluoroborate (Hmim). <br />
The concentration-response data include the cytotoxicity of eight compounds,
two mixtures designed by eecr, and ten mixtures designed by udcr.<br />
The fitting information of eight chemicals and a total of 12 mixtures. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(cytotox)</code></pre>


<h3>Format</h3>

<p>A list with concentration-response data of 8 chemicals, 2 eecr mixtures, 10 udcr mixtures,
and associated fitting information.
</p>

<dl>
<dt><code>Ni$x</code></dt><dd><p>a numeric vector of test concentrations</p>
</dd>
<dt><code>Ni$y</code></dt><dd><p>a numeric matrix of responses</p>
</dd>
<dt><code>Ni$name</code></dt><dd><p>test substances</p>
</dd>
<dt><code>Ni$concNum</code></dt><dd><p>the number of test concentrations</p>
</dd>
<dt><code>Ni$tierNum</code></dt><dd><p>the number of repetitions</p>
</dd>
<dt><code>Ni$type</code></dt><dd><p>type of test substance: single chemicals or mixtures</p>
</dd>
<dt><code>sgl$model</code></dt><dd><p>models used to fit the concentration-response data of individual 
chemicals</p>
</dd>
<dt><code>sgl$param</code></dt><dd><p>fitted coefficients of concentration-response curves 
</p>
</dd>
<dt><code>udcr.mix$model</code></dt><dd><p>models used to fit the concentration-response data of udcr 
mixtures</p>
</dd>
<dt><code>udcr.mix$param</code></dt><dd><p>fitted coefficients of the concentration-response 
curves corresponding to udcr.mix$model
</p>
</dd>
<dt><code>$udcr.pct</code></dt><dd><p>the proportion of individual chemicals in udcr mixtures </p>
</dd>	
</dl>



<h3>Details</h3>

<p>Quantal responses[0, 1] are needed for curve fitting using the following six equaitons:
i.e., Weibull, Logit, Hill, BCL, GL, BCW. The following equation could transform 
continous responses to quantal ones: 
</p>
<p style="text-align: center;"><code class="reqn">E = \frac{{{I_0} - {I_i}}}{{{I_0}}}</code>
</p>

<p>where <code class="reqn">I_0</code> is the average of controls for inhibition tests or the average 
of the maximum effect for stimulation tests and <code class="reqn">I_i</code> the average 
effect of the <code class="reqn">i^{th}</code> treatment.
</p>


<h3>Source</h3>

<p> The cytotoxicity experiments were conducted in our lab</p>


<h3>Examples</h3>

<pre><code class='language-R'># example 1
## Retrive the toxicity data of Ni on MCF-7.
cytotox$Ni

# example 2
## Retrive the toxicity information of ten udcr mixtures on MCF-7.
cytotox$udcr.mix
</code></pre>

<hr>
<h2 id='DTcv'>critical value for Dunnett's test </h2><span id='topic+DTcv'></span>

<h3>Description</h3>

<p> DTcv provides the critical constants calculated based step-down 
Dunnett test procedure. Three significance level (0.01, 0.05, and 0.1) each with two 
alternative hypothesis (&quot;U&quot;=upper one-sided test; &quot;B&quot;=two-sided 
test) are supported. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(DTcv)</code></pre>


<h3>Format</h3>

<p> at most 30 treatments (1 : 30), 
and 35 degree of freedom(c(5 : 30, 40, 50, 60, 80, 100, 120, 200, 1000, 3000)).
</p>

<dl>
<dt><code>DTcv</code></dt><dd><p>a matrix of critical value for Dunnett's test</p>
</dd>
</dl>



<h3>Details</h3>

<p>&gt; head(DTcv)<br />
<code style="white-space: pre;">&#8288;   &#8288;</code>df p twoside.01 twoside.05 twoside.10 oneside.01 oneside.05 oneside.10<br />
[1,] 5  1      4.032      2.571      2.015      3.365      2.015      1.476<br />
[2,] 5  2      4.627      3.030      2.433      3.900      2.440      1.873<br />
[3,] 5  3      4.948      3.294      2.669      4.225      2.681      2.095<br />
[4,] 5  4      5.218      3.474      2.831      4.434      2.848      2.245<br />
[5,] 5  5      5.416      3.616      2.956      4.585      2.974      2.360<br />
[6,] 5  6      5.538      3.727      3.055      4.723      3.080      2.451<br />
df: degree of freedom; p: the number of treatment.
</p>


<h3>Source</h3>

<p> The critical constants (store in DTcv) were calculated using step-down 
Dunnett test procedure( the cvSDDT funtion in R package DunnettTests).</p>

<hr>
<h2 id='ecaPred'>Mixture Effect Predicted by CA at Particular Concentration of a Mixture</h2><span id='topic+ecaPred'></span>

<h3>Description</h3>

<p>According to the fitted concentration-response information of mixtures. The 
concentration (e.g., ECx) that causes certain effect in the mixture will be
calculated. ecaPred will predict how much effect will be caused at ECx according
to concentration addition.
The individual concentration-responses should be  
fitted only based on the following six models: Hill, 
Weibull, Logit, BCW, BCL, and GL.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecaPred(effv, sgl, mix, pctMix, sav = FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecaPred_+3A_effv">effv</code></td>
<td>
<p>numeric vector with single or multiple effect values (0 ~ 1).</p>
</td></tr>
<tr><td><code id="ecaPred_+3A_sgl">sgl</code></td>
<td>
<p>A list with sgl$model and sgl$param. sgl$model is character vector of equations used
to fit the concentration-response data of individual chemicals: Hill, Weibull, Logit, BCW,
BCL, GL. sgl$param is numeric matrix of fitting coefficients with rownames (equations) 
and colnames (Alpha, Beta, and Gamma). For equations with only two parameters, 
Gamma can be set as zero or any other numeric value.
</p>
</td></tr>
<tr><td><code id="ecaPred_+3A_mix">mix</code></td>
<td>
<p>A list with mix$model and mix$param. mix$model is character vector of equations used
to fit the concentration-response data of mixtures: Hill, Weibull, Logit, BCW, BCL, GL.
mix$param is numeric matrix of fitting coefficients of mixtures' concentration-response
data with rownames (selected equations) and colnames (Alpha, Beta, and Gamma). For 
equations with only two parameters, Gamma can be set as zero or any other numeric value.
</p>
</td></tr>
<tr><td><code id="ecaPred_+3A_pctmix">pctMix</code></td>
<td>
<p>A numeric matrix, the concentration ratio (percent) of every component in the
mixture.
</p>
</td></tr>
<tr><td><code id="ecaPred_+3A_sav">sav</code></td>
<td>
<p>TRUE: save output to a default file; FALSE: output will not be saved; 
a custom file directory: save output to the custom file directory.</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>ecaPred calculate the effect concentrations based on the fitted concentration-response
information of the mixture according to the input effects effv (e.g., 0.05 and 0.5). The
concentration of individual component <code class="reqn">c_i</code> is computed based on mixture's 
ECx and the proportion of component in the mixture <code class="reqn">p_i</code>. 
Then the CA effect will be calculated based 
on the concentration addition.
</p>


<h3>Value</h3>

<p> A numeric matrix of predicted effects</p>


<h3>See Also</h3>

<p><code><a href="#topic+eiaPred">eiaPred</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## example
# predict the CA predicted response at the concentrations that cause 5%, 10%, 20%, and 50% 
# effect of antibiotic mixtures
# each mixture contains eight components. Totally, there are 10 mixtures designed by the udcr.

sgl &lt;- antibiotox$sgl
mix &lt;- antibiotox$udcr.mix
pct &lt;- antibiotox$udcr.pct
ecaPred(effv = c(0.05, 0.1, 0.20, 0.5), sgl, mix, pct)
</code></pre>

<hr>
<h2 id='ECx'>Effect Concentration Calculation for Sigmoidal Models</h2><span id='topic+ECx'></span>

<h3>Description</h3>

<p>Effect concentrations are calculated at particular effects based on the fitting coefficients 
of 13 sigmoidal models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ECx(model, param, effv, rtype = 'quantal', Scaled = TRUE, sav = FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ECx_+3A_model">model</code></td>
<td>
<p>a character vector of equations:(&quot;Hill&quot;, &quot;Hill_two&quot;, &quot;Hill_three&quot;, &quot;Hill_four&quot;, 
&quot;Weibull&quot;, &quot;Weibull_three&quot;, &quot;Weibull_four&quot;, &quot;Logit&quot;, &quot;Logit_three&quot;, &quot;Logit_four&quot;,
&quot;BCW(Box-Cox-Weibull)&quot;, &quot;BCL(Box-Cox-Logit)&quot;, &quot;GL(Generalized Logit)&quot;)</p>
</td></tr>
<tr><td><code id="ECx_+3A_param">param</code></td>
<td>
<p>a numeric matrix of fitting coefficients with rownames (equations) and 
colnames (Alpha, Beta, Gamma, Delta, and Epsilon).</p>
</td></tr>
<tr><td><code id="ECx_+3A_effv">effv</code></td>
<td>
<p>a numeric vector with single or multiple effect values</p>
</td></tr>
<tr><td><code id="ECx_+3A_rtype">rtype</code></td>
<td>
<p> the response type of endpoint: 'continuous' or 'quantal' data.</p>
</td></tr>
<tr><td><code id="ECx_+3A_scaled">Scaled</code></td>
<td>
<p>only for 'continuous' data. To indicate if the effv is scaled 
by response ranges to 0~1 or not (default is TRUE).</p>
</td></tr>
<tr><td><code id="ECx_+3A_sav">sav</code></td>
<td>
<p>TRUE: save output to a default file; FALSE: output will not be saved; 
a custom file directory: save output to the custom file directory.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>effect concentrations will be calculated with provided equations (model), associated 
fitting parameters (param), and effect levels (effv). For example, 
<code class="reqn">effv</code> should be 0.5 if we want to calculate a concentration 
causes 50% effect.<br /> 
The inverse functions of the six quantal sigmoidal equations are listed as follows:<br />	
inverse Hill_two: </p>
<p style="text-align: center;"><code class="reqn">{c = \beta E/\left( {\alpha  - E} \right)}</code>
</p>

<p>inverse Weibull: </p>
<p style="text-align: center;"><code class="reqn">c = {10^{\left( {\ln ( - \ln (1 - E)) - \alpha } \right)/\beta }}</code>
</p>

<p>inverse Logit: </p>
<p style="text-align: center;"><code class="reqn">c = {10^{\left( {\ln (E/(1 - E)) - \alpha } \right)/\beta }}</code>
</p>

<p>inverse BCW: </p>
<p style="text-align: center;"><code class="reqn">c = {\left( {(\gamma /\beta )(\ln ( - \ln (1 - E)) - \alpha )
				+ 1} \right)^{1/\gamma }}</code>
</p>

<p>inverse BCL: </p>
<p style="text-align: center;"><code class="reqn">c = {((\gamma /\beta )( - \ln ((1 - E)/E) - \alpha ) + 1)^{1/\gamma }}</code>
</p>

<p>inverse GL: </p>
<p style="text-align: center;"><code class="reqn">c = {10^{(( - \ln ({{(1/E)}^{1/\gamma }} - 1) - \alpha )/\beta )}}</code>
</p>

<p>where <code class="reqn">E</code> is effect and <code class="reqn">c</code> is the concentration.
</p>


<h3>Value</h3>

 
<table>
<tr><td><code>ecx</code></td>
<td>
<p>a numeric vector of effect concentration(s)</p>
</td></tr>
<tr><td><code>effvAbs</code></td>
<td>
<p>absolute effect levels. Only for 'continuous' data with scaled effv. The corresponding 
absolute effect is calculated. </p>
</td></tr>
</table>


<h3>References</h3>

<p>Hill equation (biochemistry) http://en.wikipedia.org/wiki/Hill_equation_(biochemistry)<br />
Reference to curveFit
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## example 1
# calculate EC5 and EC50 of seven antibiotics on the photobacteria
model &lt;- antibiotox$sgl$model
param &lt;- antibiotox$sgl$param
effv &lt;- c(0.05, 0.5)
ECx(model, param, effv = c(0.05, 0.50))

## example 2
# calculate EC5 and EC50 of four heavy metals and four ionic liquids on the MCF-7 cells
model &lt;- cytotox$sgl$model
param &lt;- cytotox$sgl$param
ECx(model, param, effv = c(0.05, 0.50), rtype = 'quantal')
</code></pre>

<hr>
<h2 id='eiaPred'>Mixture Effect Predicted by IA at Particular Concentration of a Mixture</h2><span id='topic+eiaPred'></span>

<h3>Description</h3>

<p>According to the fitted concentration-response information of mixtures. The
concentration (e.g., ECx) that causes certain effect in the mixture will 
be calculated. eiaPred will predict how much effect will be caused at 
those concentrations according to independent action.
The individual concentration-responses should be  
fitted only based on the following six models: Hill, 
Weibull, Logit, BCW, BCL, and GL.</p>


<h3>Usage</h3>

<pre><code class='language-R'>eiaPred(effv, sgl, mix, pctMix, sav = FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eiaPred_+3A_effv">effv</code></td>
<td>
<p>numeric vector with single or multiple effect values (0 ~ 1).</p>
</td></tr>
<tr><td><code id="eiaPred_+3A_sgl">sgl</code></td>
<td>
<p>A list with sgl$model and sgl$param. sgl$model is character vector of equations
used to fit the concentration-response data of individual chemicals: Hill, Weibull, Logit,
BCW, BCL, GL. sgl$param is numeric matrix of fitting coefficients with rownames (selected
equations) and colnames (Alpha, Beta, and Gamma). For equations with only two parameters,
Gamma can be set as zero or any other numeric value.
</p>
</td></tr>
<tr><td><code id="eiaPred_+3A_mix">mix</code></td>
<td>
<p>A list with mix$model and mix$param. mix$model is character vector of equations
used to fit the concentration-response data of mixtures: Hill, Weibull, Logit, BCW, 
BCL, GL. mix$param is numeric matrix of fitting coefficients of mixtures' 
concentration-response data with rownames ( equations) and colnames 
(Alpha, Beta, and Gamma). For equations with two parameters, Gamma can 
be set as zero or any other numeric value.
</p>
</td></tr>
<tr><td><code id="eiaPred_+3A_pctmix">pctMix</code></td>
<td>
<p>A numeric matrix, the concentration ratio (percent) of every component in the
mixture.
</p>
</td></tr>
<tr><td><code id="eiaPred_+3A_sav">sav</code></td>
<td>
<p>TRUE: save output to a default file; FALSE: output will not be saved; 
a custom file directory: save output to the custom file directory.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>eiaPred calculate the effect concentrations based on the fitted concentration-response
information of the mixture according to the input effects effv (e.g., 0.05 and 0.5). 
The concentration of individual component <code class="reqn">c_i</code> is computed based on 
mixture's ECx and the proportion of component in the mixture 
<code class="reqn">p_i</code>. Then the IA effect will be calculated based on the 
independent action.
</p>


<h3>Value</h3>

<p>A numeric matrix of predicted effects</p>


<h3>See Also</h3>

<p><code><a href="#topic+ecaPred">ecaPred</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## example 1
# predict the IA predicted response (cytotoxicity) at the concentrations that cause 10% and 50% 
# effect of an mixture. 
# each mixture contains eight components. Totally, there are 10 mixtures designed by the udcr.

sgl &lt;- cytotox$sgl
mix &lt;- cytotox$udcr.mix
pct &lt;- cytotox$udcr.pct
eiaPred(effv = c(0.1, 0.5), sgl, mix, pct)

## example 2
# predict the IA predicted response at the concentrations that cause 5% and 50% effect 
# of antibiotic mixtures.
# each mixture contains eight components. Totally, there are 2 mixtures designed by the eecr.

sgl &lt;- antibiotox$sgl
mix &lt;- antibiotox$eecr.mix
pct &lt;- antibiotox$eecr.pct
eiaPred(effv = c(0.05, 0.5), sgl, mix, pct)

## example 2
# predict the IA predicted response at the concentrations that cause 5%, 10%, 20%, and 
# 50% effect of antibiotic mixtures.
# each mixture contains eight components. Totally, there are 10 mixtures designed by the udcr.

sgl &lt;- antibiotox$sgl
mix &lt;- antibiotox$udcr.mix
pct &lt;- antibiotox$udcr.pct
eiaPred(effv = c(0.05, 0.10, 0.20, 0.5), sgl, mix, pct)
</code></pre>

<hr>
<h2 id='figPlot'>Ploting concentration response curve</h2><span id='topic+figPlot'></span>

<h3>Description</h3>

<p>Plotting concentration response curves with/without confidence intervals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>figPlot(object, logT = TRUE, xlabel = "concentration (mol/L)", ylabel = "Response", 
               ylimit, lgd = NULL)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="figPlot_+3A_object">object</code></td>
<td>
<p>object of class curveFit.</p>
</td></tr>
<tr><td><code id="figPlot_+3A_logt">logT</code></td>
<td>
<p>logarithm transformation on concentration: TRUE or FALSE(defalt if TRUE).</p>
</td></tr>
<tr><td><code id="figPlot_+3A_xlabel">xlabel</code>, <code id="figPlot_+3A_ylabel">ylabel</code></td>
<td>
<p>plot labels.</p>
</td></tr>
<tr><td><code id="figPlot_+3A_ylimit">ylimit</code></td>
<td>
<p>range of the y axis.</p>
</td></tr>
<tr><td><code id="figPlot_+3A_lgd">lgd</code></td>
<td>
<p>legend of the plot.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Plot the concentration response curves, experimental data, CI, and PI in one figure.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## example 1
# 
x &lt;- antibiotox$PAR$x
expr &lt;- antibiotox$PAR$y
obj &lt;- curveFit(x, expr, eq = 'Logit', rtype = 'quantal', param = c(26, 4), effv = c(0.05, 0.5))
figPlot(obj)

## example 2
# 
x &lt;- hormesis$HmimCl$x
rspn &lt;- hormesis$HmimCl$y
obj &lt;- curveFit(x, rspn, eq = 'Biphasic', param = c(-0.59, 0.001, 160,0.05, 19),
         effv = c(0.05, 0.5), rtype = 'hormesis')
figPlot(obj, logT = TRUE)
</code></pre>

<hr>
<h2 id='gcaHill'>Mixture Toxicity Prediction Using GCA (Hill_two)</h2><span id='topic+gcaHill'></span>

<h3>Description</h3>

<p>Predict the mixture toxicity based on individual concentration-response information 
fitted by Hill_two equation. An explicit formula for gca prediction were used 
instead of the dichotomy algorithm in gcaPred. Three 
optional mixture design methods are provided. 
One is the arbitrary concentration ratio (acr) for mixture components.<br />
Users can deign random ratios for components in the mixture. Other two 
options are equal effect concentration ratio (eecr) and uniform design concentration 
ratio (udcr).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gcaHill(model, param, mixType, effv, refEffv = c(0.10, 0.50), rtype, sav = FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gcaHill_+3A_model">model</code></td>
<td>
<p>character vector of equation names, just Hill_two</p>
</td></tr>
<tr><td><code id="gcaHill_+3A_param">param</code></td>
<td>
<p>numeric matrix of fitting coefficients with rownames (equations) and 
colnames (Alpha, Beta).
</p>
</td></tr>
<tr><td><code id="gcaHill_+3A_mixtype">mixType</code></td>
<td>
<p>experimental design of the mixture. acr: arbitrary concentration ratio; 
eecr: equal effect concentration ratio; udcr: uniform design concentration ratio.</p>
</td></tr>
<tr><td><code id="gcaHill_+3A_effv">effv</code></td>
<td>
<p>numeric vector with single or multiple (scaled) effect values (0 ~ 1).</p>
</td></tr>
<tr><td><code id="gcaHill_+3A_refeffv">refEffv</code></td>
<td>
<p>to determine the concentration ranges for predicting effect. 
Use scaled values (0 ~ 1).</p>
</td></tr>
<tr><td><code id="gcaHill_+3A_rtype">rtype</code></td>
<td>
<p> the response type of endpoint: 'continuous' or 'quantal' data.</p>
</td></tr>
<tr><td><code id="gcaHill_+3A_sav">sav</code></td>
<td>
<p>TRUE: save output to a default file; FALSE: output will not be saved; 
a custom file directory: save output to the custom file directory.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The generalized concentration addition (GCA) model was proposed by Howard and Webster 
to predict mixtures containing partial agonists (Howard and Webster, 2009). Empirical 
data are used to fit concentration-response function, and then predict the mixture 
response using the inverse function.
</p>
<p style="text-align: center;"><code class="reqn">E_{mix}^{GCA} = \frac{{\sum\limits_{i = 1}^n {\frac{{{\alpha _i}{c_i}}}{{{K_i}}}}}}
		{{1 + \sum\limits_{i = 1}^n {\frac{{{c_i}}}{{{K_i}}}} }}</code>
</p>

<p>where <code class="reqn">c_i</code> is the concentration of component <code class="reqn">i</code> in the mixture. Parameter 
<code class="reqn">\alpha _i</code> and <code class="reqn">K_i</code> are fitted coefficient of <code class="reqn">i^{th}</code> component, which are 
the same as <code class="reqn">\beta</code> and <code class="reqn">\alpha</code> in Hill_two equation. Right, the <code class="reqn">\alpha _i</code> 
and <code class="reqn">K_i</code> are corresponding to <code class="reqn">\beta</code> and <code class="reqn">\alpha</code> in Hill_two equation.
</p>


<h3>Value</h3>

<table>
<tr><td><code>x</code></td>
<td>
<p> a series of concentrations</p>
</td></tr>
<tr><td><code>e</code></td>
<td>
<p>a series of effects caused by the concentrations (x) as predicted by gca</p>
</td></tr>
<tr><td><code>pct</code></td>
<td>
<p>the concentration ratio (percent) of every component in the mixture</p>
</td></tr>
<tr><td><code>uniTab</code></td>
<td>
<p>the uniform design table used to construct the mixture when mixType is udcr</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Only for concentration-response curves fitted by the Hill_two equation in curveFit.
</p>


<h3>References</h3>

<p>Howard, G.J., Schlezinger, J.J., Hahn, M.E., Webster, T.F., 2010. Generalized Concentration 
Addition Predicts Joint Effects of Aryl Hydrocarbon Receptor Agonists with Partial Agonists 
and Competitive Antagonists. Environ. Health Perspect. 118, 666-672.<br />
Howard, G.J., Webster, T.F., 2009. Generalized concentration addition: A method for examining 
mixtures containing partial agonists. J. Theor. Biol. 259, 469-477.<br />
Hadrup, N., Taxvig, C., Pedersen, M., Nellemann, C., Hass, U., Vinggaard, A.M., 2013. 
Concentration addition, independent action and generalized concentration 
addition models for mixture effect 
prediction of sex hormone synthesis in vitro. PLoS One 8, e70490.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gcaPred">gcaPred</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>model &lt;- c("Hill_two", "Hill_two", "Hill_two", "Hill_two")
param &lt;- matrix(c(3.94e-5, 0.97, 0, 5.16e-4, 1.50, 0, 3.43e-6, 1.04, 0, 9.18e-6, 0.77, 0), 
				nrow = 4, ncol = 3, byrow = TRUE)
rownames(param) &lt;- c('Ni', 'Zn', 'Cu', 'Mn')
colnames(param) &lt;- c('Alpha', 'Beta', 'Gamma')
## example 1
# using GCA to predict the mixtures designed by equal effect concentration ratio (eecr) at
# the effect concentration of EC05 and EC50
# the eecr mixture design is based on four heavy metals (four factors).
gcaHill(model, param, mixType = "eecr", effv = c(0.05, 0.5), rtype = 'continuous')

## example 2
# using GCA to predict the mixtures designed by uniform design concentration ratio (udcr)
# the udcr mixture design is based on four heavy metals (four factors).
# Seven levels (EC05, EC10, EC15, EC20, EC25, EC30, and EC50 ) are allocated in 
# the uniform table
effv &lt;- c(0.05, 0.10, 0.15, 0.20, 0.25, 0.30, 0.50)
gcaHill(model, param, mixType = "udcr", effv, rtype = 'quantal')

## example 3
# using GCA to predict the mixtures designed by arbitrary concentration ratio (acr)
# the udcr mixture design is based on four heavy metals (four factors).
# the every component in the mixture shares exactly the same ratio (0.25) 
effv &lt;- c(0.25, 0.25, 0.25, 0.25)
gcaHill(model, param, mixType = "acr", effv)
</code></pre>

<hr>
<h2 id='gcaPred'>Mixture Toxicity Prediction Using GCA (General)</h2><span id='topic+gcaPred'></span>

<h3>Description</h3>

<p>Predict the mixture toxicity based on individual 
concentration-response information. Thirteen monotonic(sigmoidal) models
(&quot;Hill&quot;, &quot;Hill_two&quot;, &quot;Hill_three&quot;, &quot;Hill_four&quot;,
&quot;Weibull&quot;, &quot;Weibull_three&quot;, &quot;Weibull_four&quot;, &quot;Logit&quot;, &quot;Logit_three&quot;, &quot;Logit_four&quot;,
&quot;BCW(Box-Cox-Weibull)&quot;, &quot;BCL(Box-Cox-Logit)&quot;, &quot;GL(Generalized Logit)&quot;) are 
incorporated to construct the GCA equation. The dichotomy 
technique is used to solve the constructed equation. 
Three optional mixture design methods are provided. One is the arbitrary 
concentration ratio (acr) for mixture components. Users can arbitrarily 
deign a random ratio for each component in the 
mixture. Other two options are equal effect concentration 
ratio (eecr) and uniform design concentration ratio (udcr).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gcaPred(model, param, mixType, effv, refEffv, rtype, lb, ub, sav = FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gcaPred_+3A_model">model</code></td>
<td>
<p>vector of equation names</p>
</td></tr>
<tr><td><code id="gcaPred_+3A_param">param</code></td>
<td>
<p>numeric matrix of fitting coefficients with rownames (equation selected) and 
colnames (ALpha, Beta, and Gamma). For equations with two parameters, Gamma can be set as 
zero or any other numeric value.
</p>
</td></tr>
<tr><td><code id="gcaPred_+3A_mixtype">mixType</code></td>
<td>
<p>experimental design of the mixture. acr: arbitrary concentration ratio; 
eecr: equal effect concentration ratio; udcr: uniform design concentration ratio.
</p>
</td></tr>
<tr><td><code id="gcaPred_+3A_effv">effv</code></td>
<td>
<p>numeric vector with single or multiple (scaled) effect values (0 ~ 1).</p>
</td></tr>
<tr><td><code id="gcaPred_+3A_refeffv">refEffv</code></td>
<td>
<p>to determine the concentration ranges for predicting effect. 
Use scaled values (0 ~ 1).</p>
</td></tr>
<tr><td><code id="gcaPred_+3A_lb">lb</code></td>
<td>
<p>lower bound for solving constructed IA using diochotomy method (default is 1E-9).</p>
</td></tr>
<tr><td><code id="gcaPred_+3A_ub">ub</code></td>
<td>
<p>upper bound bound for solving constructed IA using diochotomy method(default is 9).</p>
</td></tr>
<tr><td><code id="gcaPred_+3A_rtype">rtype</code></td>
<td>
<p> the response type of endpoint: 'continuous' or 'quantal' data.</p>
</td></tr>
<tr><td><code id="gcaPred_+3A_sav">sav</code></td>
<td>
<p>TRUE: save output to a default file; FALSE: output will not be saved; 
a custom file directory: save output to the custom file directory.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The generalized concentration addition (GCA) model was proposed by Howard and Webster to 
predict mixtures containing partial agonists (Howard and Webster, 2009). 
</p>
<p style="text-align: center;"><code class="reqn">\sum\limits_{i = 1}^n {\frac{{{c_i}}}{{f_i^{ - 1}\left( E \right)}}}  = 1</code>
</p>

<p>Empirical data were used to fit concentration-response function, and then predict the mixture 
response using the inverse function. Previous studies used Hill_two function to fit individual 
concentration response curves in the GCA prediction (Hadrup et al., 2013; Howard et al., 2010). 
Here, we incorporated thirteen functions to construct
the GCA equation and the dichotomy technique is used to solve the constructed equation. 
</p>


<h3>Value</h3>

<table>
<tr><td><code>x</code></td>
<td>
<p> a series of concentrations</p>
</td></tr>
<tr><td><code>e</code></td>
<td>
<p>a series of effects caused by the concentrations (x) as predicted by gca</p>
</td></tr>
<tr><td><code>pct</code></td>
<td>
<p>the concentration ratio (percent) of every component in the mixture</p>
</td></tr>
<tr><td><code>uniTab</code></td>
<td>
<p>the uniform design table used to construct the mixture when mixType is udcr</p>
</td></tr>
</table>


<h3>References</h3>

<p>Howard, G.J., Schlezinger, J.J., Hahn, M.E., Webster, T.F., 2010. Generalized Concentration 
Addition Predicts Joint Effects of Aryl Hydrocarbon Receptor Agonists with Partial Agonists 
and Competitive Antagonists. Environ. Health Perspect. 118, 666-672.<br />
Howard, G.J., Webster, T.F., 2009. Generalized concentration addition: A method for examining 
mixtures containing partial agonists. J. Theor. Biol. 259, 469-477.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gcaHill">gcaHill</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## example 1
# using GCA to predict the mixtures designed by equal effect concentration ratio (eecr) at the 
# effect concentration of EC50
# the eecr mixture design is based on seven antibiotics(seven factors).
model &lt;- antibiotox$sgl$model
param &lt;- antibiotox$sgl$param
refEffv &lt;- c(0.1, 0.50, 0.80)
gcaPred(model, param, mixType = "eecr", effv = 0.5, refEffv, rtype = 'quantal')

## example 2
# using GCA to predict the mixtures designed by uniform design concentration ratio (udcr)
# the udcr mixture design is based on 2 antibiotics(2 factors) and 
# three levels (EC05, EC20, and EC50 )
model &lt;- antibiotox$sgl$model[1 : 2]
param &lt;- antibiotox$sgl$param[1 : 2, ]
effv &lt;- c(0.05, 0.20, 0.50)
refEffv &lt;- c(0.1, 0.80)
gcaPred(model, param, mixType = "udcr", effv, refEffv, rtype = 'quantal')

## example 3
# using GCA to predict the mixtures designed by arbitrary concentration ratio (acr)
# the udcr mixture design is based on 2 heavy metals (2 factors).
# the every component in the mixture shares exactly the same ratio (0.5) 
model &lt;- cytotox$sgl$model[1 : 2]
param &lt;- cytotox$sgl$param[1 : 2, ]
effv &lt;- c(0.5, 0.5)
refEffv &lt;- c(0.1, 0.80)
gcaPred(model, param, mixType = "acr", effv, refEffv, rtype = 'quantal')
</code></pre>

<hr>
<h2 id='getCI'>Calculating Confidence Intervals </h2><span id='topic+getCI'></span>

<h3>Description</h3>

<p>calculating non-simultanous confidence intervals and prediction intervals</p>


<h3>Usage</h3>

<pre><code class='language-R'>getCI(object, effv, Scaled = TRUE, sigLev = 0.05, sav = FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getCI_+3A_object">object</code></td>
<td>
<p> object of class curveFit.</p>
</td></tr>
<tr><td><code id="getCI_+3A_effv">effv</code></td>
<td>
<p>numeric matrix of experimental responses with at least three replicates.</p>
</td></tr>
<tr><td><code id="getCI_+3A_scaled">Scaled</code></td>
<td>
<p>indicating if effv was scaled or not(TRUE/FALSE) in continuous dose-response 
(rtype = 'continuous')</p>
</td></tr>
<tr><td><code id="getCI_+3A_siglev">sigLev</code></td>
<td>
<p>significance level(default is 0.05).</p>
</td></tr>
<tr><td><code id="getCI_+3A_sav">sav</code></td>
<td>
<p>TRUE: save output to a default file; FALSE: output will not be saved; 
a custom file directory: save output to the custom file directory.</p>
</td></tr> 
</table>


<h3>Details</h3>

 
<p>The Delta method (Dybowski et al, 2001) is used to construct confidence
intervals for predicted responses. 
</p>


<h3>Value</h3>

<table>
<tr><td><code>xmat</code></td>
<td>
<p>effect concentration(s) and corresponding CIs and PIs</p>
</td></tr>
<tr><td><code>emat</code></td>
<td>
<p>effect(s) and and corresponding CIs and PIs</p>
</td></tr>
<tr><td><code>sav</code></td>
<td>
<p>TRUE: save output to a default file; FALSE: output will not be saved; 
a custom file directory: save output to the custom file directory.</p>
</td></tr> 
</table>


<h3>References</h3>

<p> Zhu, X.-W. and Chen, J.-Y. (2016). mixtox: An R Package for Mixture 
Toxicity Assessment. R Journal, 8(2).<br />
Dybowski, R. and Gant, V. (2001). Clinical applications of artificial neural networks. 
Cambridge University Press, Cambridge.<br />
Gryze, S. De, Langhans, I., and Vandebroek, M. (2007). Using the correct intervals for 
prediction: A tutorial on tolerance intervals for ordinary least-squares regression. 
Chemom. Intell. Lab. Syst., 87, 147-154.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## example 1
x &lt;- cytotox$Ni$x
rspn &lt;- cytotox$Ni$y
obj &lt;- curveFit(x, rspn, eq = 'Logit', param = c(12, 3), effv = c(0.05, 0.5), rtype = 'quantal')
getCI(obj, effv = c(0.05, 0.50))
</code></pre>

<hr>
<h2 id='hormesis'>Non-monotonic Concentration-response Data</h2><span id='topic+hormesis'></span>

<h3>Description</h3>

<p>Two ionic liquids: 1-Octyl-3-methylimidazolium chloride (Omim) and 
1-Hexyl-3-Methylimidazolium tetrafluoroborate (Hmim). 
Two organic solvents: Acetonitrile(ACN) and acetone.<br />
The concentration-response data include the effect of these four compounds 
on firefly luciferase. 
Those concentration-responses were fitted using non-monotonic models. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(hormesis)</code></pre>


<h3>Format</h3>

<p>A list with non-monotonic concentration-responses of four chemicals and associated 
fitting information.
</p>

<dl>
<dt><code>OmimCl$x</code></dt><dd><p>a numeric vector of concentrations</p>
</dd>
<dt><code>OmimCl$y</code></dt><dd><p>a numeric matrix of responses</p>
</dd>
<dt><code>OmimCl$name</code></dt><dd><p>name of test substance</p>
</dd>
<dt><code>OmimCl$concNum</code></dt><dd><p>the number of concentrations</p>
</dd>
<dt><code>OmimCl$tierNum</code></dt><dd><p>the number of repetitions</p>
</dd>
<dt><code>OmimCl$type</code></dt><dd><p>type of test substance</p>
</dd>
<dt><code>sgl$model</code></dt><dd><p>model used to fit the concentration-response data</p>
</dd>
<dt><code>sgl$param</code></dt><dd><p>fitted coefficients of those curves corresponding 
to sgl$model</p>
</dd>
<dt><code>sgl$minx</code></dt><dd><p>numeric vector with  multiple concentrations that 
induce maximun stimulation</p>
</dd>
<dt><code>sgl$miny</code></dt><dd><p>the largest stimulation</p>
</dd>	
</dl>



<h3>Details</h3>

<p>The non-monotonic concentration-responses need to be scaled into [0, 1] using the 
following equation:
</p>
<p style="text-align: center;"><code class="reqn">E = \frac{{{I_0} - {I_i}}}{{{I_0}}}</code>
</p>

<p>where <code class="reqn">I_0</code> is the average of controls for inhibition test or the average 
of the maximum effect for the stimulation test and <code class="reqn">I_i</code> the average 
effect of the <code class="reqn">i^{th}</code> treatment.
</p>


<h3>Source</h3>

<p> Eexperiments were conducted in our lab. Detailed descripttion can be found in references </p>


<h3>References</h3>

<p>Zhu X-W, et.al. 2013. Modeling non-monotonic dose-response relationships: Model evaluation
and hormetic quantities exploration. Ecotoxicol. Environ. Saf. 89:130-136.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#example 1
## Retrive the toxicity data of acetonitrile on firefly luciferase.
hormesis$ACN

#example 2
## Retrive the minx of OmimCl, HmimCl, ACN, and Acetone
hormesis$sgl$minx
</code></pre>

<hr>
<h2 id='iaPred'>Mixture Toxicity Prediction Based on Independent Action</h2><span id='topic+iaPred'></span>

<h3>Description</h3>

<p>Predict the mixture toxicity based on individual concentration-response 
information fitted only based on the following six models: Hill, 
Weibull, Logit, BCW, BCL, and GL. Three optional mixture design methods 
are provided:(1)arbitrary concentration ratio (acr), users can set 
an arbitary proportion for each component in a mixture; (2)equal effect 
concentration ratio (eecr); (3) uniform design concentration ratio (udcr).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>iaPred(model, param, mixType, effv, effPoints, lb = 1e-9, ub = 6, sav = FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="iaPred_+3A_model">model</code></td>
<td>
<p> character vector of models: Hill, Weibull, Logit, BCW, BCL, GL</p>
</td></tr>
<tr><td><code id="iaPred_+3A_param">param</code></td>
<td>
<p>numeric matrix of fitting coefficients with row names (selected equations) and 
column names (Alpha, Beta, and Gamma). For equations with two parameters, Gamma can be 
set to zero or any other numeric value.
</p>
</td></tr>
<tr><td><code id="iaPred_+3A_mixtype">mixType</code></td>
<td>
<p>experimental design of the mixture. 
acr: arbitrary concentration ratio;  
eecr: equal effect concentration ratio;
udcr: uniform design concentration ratio.
</p>
</td></tr>
<tr><td><code id="iaPred_+3A_effv">effv</code></td>
<td>
<p>numeric vector with single or multiple effect values</p>
</td></tr>
<tr><td><code id="iaPred_+3A_effpoints">effPoints</code></td>
<td>
<p>numeric vector [0 ~ 1] to predict effect concentrations.</p>
</td></tr>
<tr><td><code id="iaPred_+3A_lb">lb</code></td>
<td>
<p>lower bound for solving constructed IA using diochotomy method.</p>
</td></tr>
<tr><td><code id="iaPred_+3A_ub">ub</code></td>
<td>
<p>upper bound bound for solving constructed IA using diochotomy method.</p>
</td></tr>
<tr><td><code id="iaPred_+3A_sav">sav</code></td>
<td>
<p>TRUE: save output to a default file; FALSE: output will not be saved; 
a custom file directory: save output to the custom file directory.</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>IA is designed for mixtures of chemicals that have distinct 
mechanisms of action. The IA model is commonly defined as:
</p>
<p style="text-align: center;"><code class="reqn">{\rm{E}}({c_{mix}}) = 1 - (1 - {\rm{E}}({c_1}))(1 - {\rm{E}}({c_2})) \cdot  
		\cdot  \cdot (1 - {\rm{E}}({c_n})) = 1 - \prod\limits_{i = 1}^n {\left( {1 - 
		{\rm{E}}({c_i})} \right)}</code>
</p>

<p>where <code class="reqn">E\left( {{c_{mix}}} \right)</code> is the overall effect caused by <code class="reqn">c_{mix}</code>, 
and <code class="reqn">E({c_i})</code> is the effect elicited by <code class="reqn">c_i</code> when applied individually. 
For a fitted function <code class="reqn">f_i</code> based on the concentration-response data of the 
<code class="reqn">i^{th}</code> component, <code class="reqn">E({c_i})</code> is equal to <code class="reqn">{f_i}({c_i})</code>.
When <code class="reqn">E({c_{mix}}) = x</code>, the equation can be expressed as: 
</p>
<p style="text-align: center;"><code class="reqn">x\%  = 1 - \prod\limits_{i = 1}^n {\left( {1 - {f_i}\left( {{p_i}\left( 
		{E{C_{x,mix}}} \right)} \right)} \right)}</code>
</p>

<p>This equation can be used to predict the combined effects of mixture-components based
on IA. The dichotomy technique is used to solve the constructed equation.
</p>


<h3>Value</h3>

<table>
<tr><td><code>ia</code></td>
<td>
<p> a series of effect concentrations predicted by IA</p>
</td></tr>
<tr><td><code>e</code></td>
<td>
<p>a series of effects (effPoints) associated with the effect concentrations in ia</p>
</td></tr>
<tr><td><code>pct</code></td>
<td>
<p>the proportion of every component in a mixture</p>
</td></tr>
<tr><td><code>uniTab</code></td>
<td>
<p>the uniform design table to construct the mixture when mixType is 'udcr'</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Note that effv is dependent on the mixType.<br />
If the mixType is acr, effv is supposed to be a vector with the ratio of each components and its length 
should be the same as the number of components. For instance, effv can be c(4, 1) if one wants to mix two 
compounds with a ratio of 4:1. One can also set effv as c(80, 20) or c(0.8, 0.2) or any other values 
with the same ratio as 4:1. The program will convert the ratio to a range of 0 to 100%.<br />
If the mixType is eecr, effv is supposed to be the effect values. For instance, effv = c(0.5) means one mixture 
will be prepared and each of its components will be mixed in a ratio equal to EC50. More than one eecr mixtures 
can be achieved by assigning more effect values to effv, e.g., effv = c(0.05, 0.10, 0.5) <br />
If the mixType is udcr, elements in effv are levels in a uniform table, the length of effv is the same as 
the number of runs. the number of runs should be consistent with the number of components in the uniform design.
</p>


<h3>References</h3>

<p>Liang, Yi-zeng, Kai-tai Fang, and Qing-song Xu. 2001. Uniform Design and Its Applications in 
Chemistry and Chemical Engineering. Chemometrics and Intelligent Laboratory Systems 
58(1):43-57.<br />
Backhaus, T., Faust, M., 2012. Predictive environmental risk assessment of chemical mixtures: A 
conceptual framework. Environmental Science and Technology. 46, 2564-2573.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+caPred">caPred</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># data(cytotox)

## example 1
# using IA to predict the mixtures designed by equal effect concentration ratio (eecr) at the 
# effect concentration of EC05 and EC50
# the eecr mixture design is based on four heavy metals and four ion liquids(eight factors).
model &lt;- cytotox$sgl$model
param &lt;- cytotox$sgl$param
iaPred(model, param, mixType = "eecr", effv = c(0.05, 0.5))

## example 2
# using IA to predict the mixtures designed by uniform design concentration ratio (udcr)
# the udcr mixture design is based on seven antibiotics (seven factors).
# five levels (EC05, EC10, EC20, EC30, and EC50 ) are allocated in the uniform table using the 
# pseudo-level technique (Liang et al., 2001)
model &lt;- antibiotox$sgl$model
param &lt;- antibiotox$sgl$param
effv &lt;- c(0.05, 0.05, 0.10, 0.10, 0.20, 0.20, 0.30, 0.30, 0.50, 0.50)
iaPred(model, param, mixType = "udcr", effv)

## example 3
# using IA to predict the mixtures designed by arbitrary concentration ratio (acr)
# the udcr mixture design is based on four antibiotics (four factors).
# the every component in the mixture shares exactly the same ratio (0.25) 
model &lt;- antibiotox$sgl$model[1 : 4]
param &lt;- antibiotox$sgl$param[1 : 4, ]
effv &lt;- c(0.25, 0.25, 0.25, 0.25)
iaPred(model, param, mixType = "acr", effv)
</code></pre>

<hr>
<h2 id='jacobian'>Jacobian Matrix Calculation</h2><span id='topic+jacobian'></span>

<h3>Description</h3>

<p>calculating the Jacobian matrix for confidence intervals</p>


<h3>Usage</h3>

<pre><code class='language-R'>jacobian(eq, x, paraHat)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="jacobian_+3A_eq">eq</code></td>
<td>
<p> equation</p>
</td></tr>
<tr><td><code id="jacobian_+3A_x">x</code></td>
<td>
<p> numeric vector of experimental concentrations</p>
</td></tr>
<tr><td><code id="jacobian_+3A_parahat">paraHat</code></td>
<td>
<p> fitted parameters</p>
</td></tr>
</table>


<h3>Details</h3>

 
<p>Jacobian matrix is the matrix of all first-order partial derivatives of a vector-valued function.
</p>


<h3>Value</h3>

<table>
<tr><td><code>jac</code></td>
<td>
<p>Jacobian matrix.</p>
</td></tr>
</table>


<h3>References</h3>

<p> https://en.wikipedia.org/wiki/Jacobian_matrix_and_determinant
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## example 1
x &lt;- cytotox$Ni$x
rspn &lt;- cytotox$Ni$y
obj &lt;- curveFit(x, rspn, eq = 'Logit', param = c(12, 3), effv = c(0.05, 0.5), rtype = 'quantal')
jacobian('Logit', x, obj$p)

</code></pre>

<hr>
<h2 id='mixtox'>
Dose-Response Curve Fitting and Mixture Toxicity Assessment
</h2><span id='topic+mixtox'></span>

<h3>Description</h3>

<p>Curve Fitting for monotonic(sigmoidal) &amp; non-monotonic(J-shaped) 
concentration-response data. Prediction of mixture toxicity based on reference 
models such as 'concentration addition', 'independent action', and 'generalized 
concentration addition'.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> mixtox</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.3.3</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2022-06-19</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>(1) Curve fitting of concentration-responses based on 13 monotonic(sigmoidal) and 4 
non-monotonic(J-shaped) models, goodness of fit, and calculation of confidence interval 
. <br />
(2) Experimental design for mixture toxicity.  
acr: arbitrary concentration ratio; 
eecr: equal effect concentration ratio;
udcr: uniform design concentration ratio. <br />
(3) Mixture toxicity prediction based on reference models such as concentration addition (CA), 
independent action (IA), and generalized concentration addition (GCA).
</p>


<h3>Author(s)</h3>

<p>xiangwei zhu <br />
Maintainer: xiangwei zhu &lt;xwzhunc@gmail.com&gt;
</p>


<h3>References</h3>

<p>Zhu, X.-W., Chen, J.-Y. (2016). mixtox: An R Package for Mixture Toxicity Assessment. 
R Journal, 8(2), 422-434.<br />
Zhu, X.-W., Ge, H.-L., Cao, Y.-B. (2016). Mixture cytotoxicity assessment of ionic liquids 
and heavy metals in MCF-7 cells using mixtox. Chemosphere, 163, 544-551.<br />
Zhu X-W, Liu S-S, Qin L-T, Chen F, Liu H-L. 2013. Modeling non-monotonic dose-response 
relationships: Model evaluation and hormetic quantities exploration. Ecotoxicology and 
Environmental Safety 89:130-136.<br />
Dunnett, C. W. 1964. New Tables for Multiple Comparisons with a Control. Biometrics 
30(3):482-491.<br />
Hickernell, Fred J. 1996. A Generalized Discrepancy and Quadrature Error Bound. Mathematics of 
Computation 67(211):299-322.<br />
Howard, Gregory J., Jennifer J. Schlezinger, Mark E. Hahn, and Thomas F. Webster. 2010. 
Generalized Concentration Addition Predicts Joint Effects of Aryl Hydrocarbon 
Receptor Agonists with Partial Agonists and Competitive Antagonists.  
Environmental Health Perspectives 118(5):666-672.<br />
Scholze, M. et al. 2001. A General Best-Fit Method for Concentration-Response Curves and the 
Estimation of Low-Effect Concentrations. Environmental Toxicology and Chemistry 
20(2):448-457.<br />
Wang, Yuan and Kai-Tai Fang. 1996. Uniform Design of Experiments with Mixtures. Science in China 
Series A-Mathematics Physics Astronomy 39(3):264-275.<br />
Backhaus, T., Faust, M., 2012. Predictive environmental risk assessment of chemical mixtures: A 
conceptual framework. Environmental Science and Technology. 46, 2564-2573.<br />
</p>

<hr>
<h2 id='nmECx'>Effect Concentration Calculation for J-shaped Models</h2><span id='topic+nmECx'></span>

<h3>Description</h3>

<p>Effect concentrations are calculated at particular effects based on the fitting coefficients 
of J-shaped Models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nmECx(model, param, effv, minx, gap = -1e-6, sav = FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nmECx_+3A_model">model</code></td>
<td>
<p>a character vector of equations:(&quot;Brain_Consens&quot;, &quot;BCV&quot;, &quot;Biphasic&quot;,
&quot;Hill_five&quot;).</p>
</td></tr>
<tr><td><code id="nmECx_+3A_param">param</code></td>
<td>
<p>a numeric matrix of fitting coefficients with rownames (models) and 
colnames (ALpha, Beta, Gamma, Delta, and Epsilon).</p>
</td></tr>
<tr><td><code id="nmECx_+3A_effv">effv</code></td>
<td>
<p>a numeric value (vector) with single or multiple effect values (miny ~ 1).</p>
</td></tr>
<tr><td><code id="nmECx_+3A_minx">minx</code></td>
<td>
<p>a numeric value (vector) with single or multiple concentrations that 
induce maximun stimulation.</p>
</td></tr>
<tr><td><code id="nmECx_+3A_gap">gap</code></td>
<td>
<p> theoritical response at the extreme low concentration predicted by a 
fitted model.</p>
</td></tr>
<tr><td><code id="nmECx_+3A_sav">sav</code></td>
<td>
<p>TRUE: save output to a default file; FALSE: output will not be saved; 
a custom file directory: save output to the custom file directory.</p>
</td></tr> 	   
</table>


<h3>Details</h3>

<p>effect concentrations will be calculated with provided equations(model), 
associated fitting 
parameters (param), and effects (effv). Effect (effv) should be a value(s) between miny ~ 1. For 
example, <code class="reqn">effv</code> should be 0.5 if we want to calculate a concentration causes 50% effect.
<code class="reqn">minx</code> should be calculated by curveFit or tuneFit.
</p>


<h3>Value</h3>

<table>
<tr><td><code>ecx</code></td>
<td>
<p>a numeric vector of effect concentration.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Zhu X-W, Liu S-S, Qin L-T, Chen F, Liu H-L. 2013. Modeling non-monotonic dose-response 
relationships: Model evaluation and hormetic quantities exploration. Ecotoxicology and 
Environmental Safety 89:130-136.<br />
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CEx">CEx</a></code>
<code><a href="#topic+curveFit">curveFit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## example 1
# calculate ECL-10, ECR-10, EC5, and EC50 of the four hormetic curves 
model &lt;- hormesis$sgl$model
param &lt;- hormesis$sgl$param
minx &lt;- hormesis$sgl$minx
nmECx(model, param, effv = c(-0.10, 0.05, 0.50), minx)
</code></pre>

<hr>
<h2 id='NOEC'>NOEC and LOEC Calculation</h2><span id='topic+NOEC'></span>

<h3>Description</h3>

<p>calculating the NOEC and LOEC using Dunnett's test</p>


<h3>Usage</h3>

<pre><code class='language-R'>NOEC(x, rspn, blankC = FALSE, sigLev = 0.05, alternertive = 'B', sav = FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NOEC_+3A_x">x</code></td>
<td>
<p> a numeric vector of experimental concentrations</p>
</td></tr>
<tr><td><code id="NOEC_+3A_rspn">rspn</code></td>
<td>
<p> a numeric matrix of experimental responses with at least three replicates.</p>
</td></tr>
<tr><td><code id="NOEC_+3A_blankc">blankC</code></td>
<td>
<p>TRUE if rspn contains responses of blank control. The default is FALSE.</p>
</td></tr>
<tr><td><code id="NOEC_+3A_siglev">sigLev</code></td>
<td>
<p>the significance level for Dunnett's test. The default is 0.05.</p>
</td></tr>
<tr><td><code id="NOEC_+3A_alternertive">alternertive</code></td>
<td>
<p>the alternative hypothesis: &quot;U&quot;=upper one-sided test; &quot;B&quot;=two-sided 
test(default).</p>
</td></tr> 
<tr><td><code id="NOEC_+3A_sav">sav</code></td>
<td>
<p>TRUE: save output to a default file; FALSE: output will not be saved; 
a custom file directory: save output to the custom file directory.</p>
</td></tr> 
</table>


<h3>Details</h3>

<p> Dunnett's test (Dunnett, 1964) is performed to compare the treatment groups with the 
blank controls. The critical constants (store in DTcv) were calculated using step-down 
Dunnett test procedure. Three significance level (0.01, 0.05, and 0.1) are supported. 
## Q: One dataset has four blank controls (C1, C2, C3, C4) and one treatment has three 
replicates (T1, T2, T3), 
##   another treatment has five replicates (R1, R2, R3, R4, R5), how to arrange the 
response matrix (rspn)?
## A: Label the missing values as NA, the response matrix (rspn) can be arranged as follows:<br />
</p>
<p>C1	C2	C3	C4	NA<br />
T1	T2	T3 NA	NA<br />
R1	R2	R3	R4	R5<br />
</p>
<p>The adjustation of critical value for the unequal variances or unequal number of control 
and replicates is skipped in this program. 
</p>


<h3>Value</h3>

<table>
<tr><td><code>mat</code></td>
<td>
<p>information on Dunnett's test.DT: Dunnett's test values; DTcv: critical values 
for Dunnett's test at the significance level of sigLev.</p>
</td></tr>
<tr><td><code>noec</code></td>
<td>
<p>non-observed effect concentration (NOEC).</p>
</td></tr>
<tr><td><code>loec</code></td>
<td>
<p>least-observed effect concentration (LOEC).</p>
</td></tr>
<tr><td><code>sigLev</code></td>
<td>
<p>the significance level used in the Dunnett's test.</p>
</td></tr>
<tr><td><code>DF</code></td>
<td>
<p>the number of treatments and degree of fredom.</p>
</td></tr>
<tr><td><code>sav</code></td>
<td>
<p>TRUE: save output to a default file; FALSE: output will not be saved; 
a custom file directory: save output to the custom file directory.</p>
</td></tr> 
</table>


<h3>Note</h3>

<p>x a vector of concentrations or levels in an ascending order.
response matrix with at least 3 replicates.
if the response matrix (rspn) contains blank controls (blankC = TRUE), 
the blank controls should be allocated in the first tow of rspn matrix. 
missing values should be labled as NA.
</p>


<h3>References</h3>

<p>Dunnett, C.W., 1964. New tables for multiple comparisons with a control. Biometrics 30, 482-491.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## example 1
# calcualte the NOEC and LOEC of heavy metal Ni(2+) on the MCF-7 cells at the default significance 
# level of 0.05
x &lt;- cytotox$Ni$x
rspn &lt;- cytotox$Ni$y
NOEC(x, rspn)

## example 2
# calcualte the NOEC and LOEC of Neomycin sulfate on the phtotobacteria at the significance 
# level of 0.01
x &lt;- antibiotox$NEO$x
rspn &lt;- antibiotox$NEO$y
NOEC(x, rspn, sigLev = 0.01)
</code></pre>

<hr>
<h2 id='qq4res'>Residual Normal QQ Plot </h2><span id='topic+qq4res'></span>

<h3>Description</h3>

<p>Producing a side-by-side QQ plot of the residuals against standard normal quantiles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qq4res(object, xlabel = 'Theoretical Quantiles', ylabel = 'Residuals', 
       lgd = NULL)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="qq4res_+3A_object">object</code></td>
<td>
<p>object of class curveFit.</p>
</td></tr>
<tr><td><code id="qq4res_+3A_xlabel">xlabel</code>, <code id="qq4res_+3A_ylabel">ylabel</code></td>
<td>
<p>plot labels.</p>
</td></tr>
<tr><td><code id="qq4res_+3A_lgd">lgd</code></td>
<td>
<p>legend of the plot</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The empirical quantiles are plotted against the quantiles of a standard normal 
distribution. If the residuals are from a normal distribution with mean 0, the points 
tend to fall along the reference line that has an intercept of 0 and a slope equal to 
the estimated standard deviation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## example 1
# 
x &lt;- antibiotox$PAR$x
expr &lt;- antibiotox$PAR$y
obj &lt;- curveFit(x, expr, eq = 'Logit', rtype = 'quantal', param = c(26, 4), effv = c(0.05, 0.5))
qq4res(obj)
</code></pre>

<hr>
<h2 id='readModel'>Read curve fitting information  </h2><span id='topic+readModel'></span>

<h3>Description</h3>

<p> Read curve fitting information in specific format from a txt or csv file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>readModel(File)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="readModel_+3A_file">File</code></td>
<td>
<p>a txt or csv file with curve fitting information. a txt file should be tab or space separated; 
a csv file should be comma separated.</p>
</td></tr>
</table>


<h3>Format</h3>

<p> a file contains curve fitting information<br /> 
The file extension needs to be .txt if it's a space or tab separated file.<br />
The file extension needs to be .csv if it's a comma-separated values file.<br />
</p>


<h3>Details</h3>

<p>The file needs three paramters (alpha	beta	gamma), just set gamma to 0 for 
models with only 2 parameters(e.g., Logit/Weibull)<br />
&gt; The format of the file readModel can read:<br />
ID	Model	alpha	beta	gamma<br />
Cu	Logit	9.91	22.15	0<br />
PAR	Weibull	18.31	3.32	0<br />
</p>

<hr>
<h2 id='readTox'>Read dose-response data  </h2><span id='topic+readTox'></span>

<h3>Description</h3>

<p> Read dose-response data of specific format from a txt or csv file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>readTox(File, light=TRUE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="readTox_+3A_file">File</code></td>
<td>
<p>a txt or csv file with dose-response data. a txt file should be tab or space separated; 
a csv file should be comma separated.</p>
</td></tr>
<tr><td><code id="readTox_+3A_light">light</code></td>
<td>
<p>TRUE: the file only contrains doses and responses (light version); 
FALSE: the file also contains information about experiment design and data type 
(complex version)</p>
</td></tr>
</table>


<h3>Format</h3>

<p> Dose-response data contains the following information: the name of compound,
the number of doses, the repititions, and the data type.<br /> 
The file extension needs to be .txt if it's a space or tab separated file.<br />
The file extension needs to be .csv if it's a comma-separated values file.<br />
</p>


<h3>Details</h3>

<p>&gt; The light format of the file readTox can read:<br />
conc	tier1	tier2	tier3<br />
2.50E-07	0.06	0.03	0.07<br />
3.50E-07	0.04	0.07	0.04<br />
5.34E-07	0.07	0.15	0.06<br />
7.68E-07	0.16	0.14	0.10<br />
1.13E-06	0.21	0.26	0.23<br />
1.67E-06	0.34	0.30	0.31<br />
2.50E-06	0.46	0.44	0.48<br />
3.50E-06	0.52	0.59	0.61<br />
5.34E-06	0.73	0.69	0.71<br />
7.68E-06	0.79	0.67	0.78<br />
1.13E-05	0.80	0.72	0.81<br />
1.67E-05	0.82	0.80	0.82<br />
</p>
<p>&gt; The complex format of the file readTox can read:<br />
cu	12	3	type<br />	
ID	conc	tier1	tier2	tier3<br />
1	2.50E-07	0.06	0.03	0.07<br />
2	3.50E-07	0.04	0.07	0.04<br />
3	5.34E-07	0.07	0.15	0.06<br />
4	7.68E-07	0.16	0.14	0.10<br />
5	1.13E-06	0.21	0.26	0.23<br />
6	1.67E-06	0.34	0.30	0.31<br />
7	2.50E-06	0.46	0.44	0.48<br />
8	3.50E-06	0.52	0.59	0.61<br />
9	5.34E-06	0.73	0.69	0.71<br />
10	7.68E-06	0.79	0.67	0.78<br />
11	1.13E-05	0.80	0.72	0.81<br />
12	1.67E-05	0.82	0.80	0.82<br />
</p>

<hr>
<h2 id='showEq'>List Requested Equations</h2><span id='topic+showEq'></span>

<h3>Description</h3>

<p>Show the formula of different equations upto request.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>showEq(eq)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="showEq_+3A_eq">eq</code></td>
<td>
<p>equation name to qury</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Thirteen monotonic(sigmoidal) equations (&quot;Hill&quot;, &quot;Hill_two&quot;, &quot;Hill_three&quot;, &quot;Hill_four&quot;, 
&quot;Weibull&quot;, &quot;Weibull_three&quot;, &quot;Weibull_four&quot;, &quot;Logit&quot;, &quot;Logit_three&quot;, &quot;Logit_four&quot;, 
&quot;BCW(Box-Cox-Weibull)&quot;, &quot;BCL(Box-Cox-Logit)&quot;, &quot;GL(Generalized Logit)&quot;) and four
non-monotonic(J-shaped) equations (&quot;Brain_Consens&quot;, &quot;BCV&quot;, &quot;Biphasic&quot;, &quot;Hill_five&quot;) 
are provided to fit concentration-response data. 
</p>


<h3>Value</h3>

<p>The formula of requested equations (with abbr.) will show up.</p>


<h3>References</h3>

<p>Scholze, M. et al. 2001. A General Best-Fit Method for Concentration-Response Curves and the
Estimation of Low-Effect Concentrations. Environmental Toxicology and Chemistry
20(2):448-457.<br />
Zhu X-W, et.al . 2013. Modeling non-monotonic dose-response relationships: Model evaluation
and hormetic quantities exploration. Ecotoxicol. Environ. Saf. 89:130-136.<br />
Howard GJ, Webster TF. 2009. Generalized concentration addition: A method for examining mixtures 
containing partial agonists. J. Theor. Biol. 259:469-477.<br />	
Spiess, A.-N., Neumeyer, N., 2010. An evaluation of R2 as an inadequate measure for nonlinear
models in pharmacological and biochemical research: A Monte Carlo approach. BMC Pharmacol.
10, 11.<br />
Di Veroli GY, Fornari C, Goldlust I, Mills G, Koh SB, Bramhall JL, et al. 2015. An automated 
fitting procedure and software for dose-response curves with multiphasic features. 
Scitific Report 5: 14701.<br />
Gryze, S. De, Langhans, I., Vandebroek, M., 2007. Using the correct intervals for prediction: A
tutorial on tolerance intervals for ordinary least-squares regression. Chemom. Intell. Lab.
Syst. 87, 147-154.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+curveFit">curveFit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># example 1
## show Weibull model
showEq('Weibull')

# example 2
## show the name of all sigmoidal models
showEq('sigmoid')
</code></pre>

<hr>
<h2 id='staval'>Starting Values for 13 Sigmoidal and  4 Hormetic Models</h2><span id='topic+staval'></span>

<h3>Description</h3>

<p>providing staring values for function tuneFit. <br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(staval)</code></pre>


<h3>Format</h3>

<p>A list with starting values for 13 sigmoidal models and six hormetic models
</p>

<dl>
<dt><code>staval$Hill</code></dt><dd><p>sarting values for Hill model</p>
</dd>
<dt><code>staval$GL</code></dt><dd><p>sarting values for generalized logit model</p>
</dd>
<dt><code>staval</code></dt><dd><p>starting values for 13 sigmoidal and  five hormetic models </p>
</dd>	
</dl>



<h3>Details</h3>

<p>Thirteen monotonic(sigmoidal) models (&quot;Hill&quot;, &quot;Hill_two&quot;, &quot;Hill_three&quot;, &quot;Hill_four&quot;,
&quot;Weibull&quot;, &quot;Weibull_three&quot;, &quot;Weibull_four&quot;, &quot;Logit&quot;, &quot;Logit_three&quot;, &quot;Logit_four&quot;,
&quot;BCW(Box-Cox-Weibull)&quot;, &quot;BCL(Box-Cox-Logit)&quot;, &quot;GL(Generalized Logit)&quot;) and four
non-monotonic(J-shaped) models (&quot;Brain_Consens&quot;, &quot;BCV&quot;, &quot;Biphasic&quot;, &quot;Hill_five&quot;)
</p>


<h3>Examples</h3>

<pre><code class='language-R'># example 1
## Retrive the starting values for Hill.
staval$Hill

# example 2
## Retrive the starting values for Weibull.
staval$Weibull
</code></pre>

<hr>
<h2 id='tuneFit'>Find Optimal Starting values for Curve Fitting</h2><span id='topic+tuneFit'></span>

<h3>Description</h3>

<p> Curve fitting is dependent on the package minpack.lm.
This generic function first seaches optimal starting values based on 
trial and error. The the concentration response data will be fitted using the optimal 
starting values. The statistics for goodness of fit
is evaluated by the following statistics: coefficient of
determination (<code class="reqn">R^2</code>), adjusted coefficient of determination (<code class="reqn">R_{adj}^2</code>),
root mean squared error (RMSE), mean absolute error (MAE), Akaike information criterion (AIC),
bias-corrected Akaike information criterion(AICc), and Bayesian information criterion (BIC).
Thirteen sigmoidal models (&quot;Hill&quot;, &quot;Hill_two&quot;, &quot;Hill_three&quot;, &quot;Hill_four&quot;,
&quot;Weibull&quot;, &quot;Weibull_three&quot;, &quot;Weibull_four&quot;, &quot;Logit&quot;, &quot;Logit_three&quot;, &quot;Logit_four&quot;,
&quot;BCW(Box-Cox-Weibull)&quot;, &quot;BCL(Box-Cox-Logit)&quot;, &quot;GL(Generalized Logit)&quot;) and four
J-shaped models (&quot;Brain_Consens&quot;, &quot;BCV&quot;, &quot;Biphasic&quot;, &quot;Hill_five&quot;)
are provided to fit the concentration-response data. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tuneFit(conc, rspn, eq = 'Weibull', effv, rtype = 'quantal', rsq = 0.6, highBar = 5000, 
		bar = 1000, sav = FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tuneFit_+3A_conc">conc</code></td>
<td>
<p>a numeric vector (matrix) of experimental concentrations</p>
</td></tr>
<tr><td><code id="tuneFit_+3A_rspn">rspn</code></td>
<td>
<p>a numeric vector (matrix) of responses corresponding to conc, it should have the
same length (or rows and columns for matrix) as conc.</p>
</td></tr>
<tr><td><code id="tuneFit_+3A_eq">eq</code></td>
<td>
<p>models for curve fitting: &quot;Hill&quot;, &quot;Hill_two&quot;, &quot;Hill_three&quot;, &quot;Hill_four&quot;,
&quot;Weibull&quot;, &quot;Weibull_three&quot;, &quot;Weibull_four&quot;, &quot;Logit&quot;, &quot;Logit_three&quot;, &quot;Logit_four&quot;,
&quot;BCW&quot;, &quot;BCL&quot;, &quot;GL&quot;, &quot;Brain_Consens&quot;, &quot;BCV&quot;, &quot;Biphasic&quot;, &quot;Hill_five&quot;.</p>
</td></tr>
<tr><td><code id="tuneFit_+3A_rtype">rtype</code></td>
<td>
<p>the response type of endpoint: 'continuous' or 'quantal' data.</p>
</td></tr>
<tr><td><code id="tuneFit_+3A_effv">effv</code></td>
<td>
<p>numeric response to calculate effect concentration, scaled respones [0, 1].</p>
</td></tr>				
<tr><td><code id="tuneFit_+3A_rsq">rsq</code></td>
<td>
<p>r2 below which would be ignored.</p>
</td></tr>
<tr><td><code id="tuneFit_+3A_highbar">highBar</code></td>
<td>
<p>if the number of starting values exceeds highBar, a random sample of 
starting values will be taken.</p>
</td></tr>
<tr><td><code id="tuneFit_+3A_bar">bar</code></td>
<td>
<p>the number of random samples.</p>
</td></tr>
<tr><td><code id="tuneFit_+3A_sav">sav</code></td>
<td>
<p>TRUE: save output to a default file; FALSE: output will not be saved; 
a custom file directory: save output to the custom file directory.</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>tuneFit provides high frequency trial and error approach to find appropriate starting 
values for users. It will deploy those starting values one by one until 
finding the right one.<br />
Function tuneFit can also be used to fit the concentration response data for a batch of 
chemicals and calculate corresponding effect concentration.
</p>


<h3>Value</h3>

<table>
<tr><td><code>sta</code></td>
<td>
<p>goodness of fit statistics: (<code class="reqn">R^2</code>, <code class="reqn">R_{adj}^2</code>, MAE, RMSE, AIC,
AICc, and BIC)</p>
</td></tr>
</table>


<h3>Note</h3>

<p>tuneFit will load the file staval.rda which contains hundreds of starting values for each 
of the sigmoidal and hormetic models. However, 
those starting values are also limited. Users are encouraged to send their fitted 
coefficients to us to extent the coverage of staval.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## example 1
# Fit the non-monotonic concentration-response data
# we'll get a fit with r2 of 0.740
x &lt;- hormesis$OmimCl$x
expr &lt;- hormesis$OmimCl$y
y &lt;- rowMeans(expr)
tuneFit(x, y, eq = 'Biphasic')

## example 2
# Fit the non-monotonic concentration-response data
# use r2 (rsq) of 0.9, we'll get a fit with r2 of 0.989
# calcualte the effect concentration that causes 5% inhibition
x &lt;- hormesis$OmimCl$x
expr &lt;- hormesis$OmimCl$y
y &lt;- rowMeans(expr)
tuneFit(x, y, eq = 'Biphasic', effv = 0.05, rsq = 0.9)

## example 3
# Fit the concentration-response data of heavy metal Ni(2+) on MCF-7 cells.
# Calculate the concentration that causes 5% inhibition on the growth of MCF-7

x &lt;- cytotox$Ni$x
expr &lt;- cytotox$Ni$y
y &lt;- rowMeans(expr)
tuneFit(x, y, eq = 'Logit', effv = 0.05)

## example 4
# Fit the concentration-response data of Paromomycin Sulfate (PAR) on photobacteria.
# Calculate the concentrations that cause 50% inhibition on the growth of photobacteria 

x &lt;- antibiotox$PAR$x
expr &lt;- antibiotox$PAR$y
y &lt;- rowMeans(expr)
tuneFit(x, y, eq = 'Logit', effv = 0.5)
</code></pre>

<hr>
<h2 id='unidTab'>Uniform Design Table</h2><span id='topic+unidTab'></span>

<h3>Description</h3>

<p>The good lattice point method with a power generator 
was used to construct the uniform 
experimental tables . The centered L2-discrepancy (CD2) and the symmetric discrepancy 
algorithms (sd2) were employed to measure the uniformity and 
find the one with lowest discrepancy.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>unidTab(lev, fac, algo = "cd2", sav = FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="unidTab_+3A_lev">lev</code></td>
<td>
<p>the number of runs (levels or pseudo-levels)</p>
</td></tr>
<tr><td><code id="unidTab_+3A_fac">fac</code></td>
<td>
<p>the number of factors</p>
</td></tr>
<tr><td><code id="unidTab_+3A_algo">algo</code></td>
<td>
<p>algorithms used to calculate the discrepancy. &quot;cd2&quot;: the centered L2-discrepancy 
algorithm. &quot;sd2&quot;: the symmetric discrepancy algorithm.
</p>
</td></tr>
<tr><td><code id="unidTab_+3A_sav">sav</code></td>
<td>
<p>TRUE: save output to a default file; FALSE: output will not be saved; 
a custom file directory: save output to the custom file directory.</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>Uniform design (UD) was proposed by Fang et al (Acta Math Appl Sin 3:363-372 (1980)). 
An appropriate uniform design table is constructed 
according to the factor (the number mixture 
components) and level (the number of experiments need to run). 
Many methods can be used to 
construct the uniform table. In the past decades many methods have been proposed for 
constructing (nearly) uniform designs, such as the good lattice point (glp) method, the 
glp method with a power generator (pglp method) (Fang 1980; Fang andWang 1994), 
the cutting method (Maand Fang 2004), the optimization method (Winker and Fang 1998).<br />
However, when s is large, the glp method has a large computational cost. And the pglp 
method has the lowest computation complexity among various methods in quasi-Monte Carlo 
methods and a good performance when <code class="reqn">n</code> or <code class="reqn">n + 1</code> is a prime number 
and <code class="reqn">s</code> is small (Fang 1980; 
Fang and Wang 1994), while the pglp method may have a poor performance when s is large.
Here, we choose the glp method with a power generator to construct the uniform table. The 
centered L2-discrepancy (cd2) is set as default over the symmetric discrepancy algorithm
for its accuracy. The cd2 algorithm is defined as follows:
</p>
<p style="text-align: center;"><code class="reqn">C{D_2}(P) = {\left[ {{{\left( {\frac{{13}}{{12}}} \right)}^s} - \frac{{{2^{1 - s}}}}
		{n}\sum\limits_{k = 1}^n {\prod\limits_{i = 1}^s {{\theta _{ki}} + \frac{1}{{{n^2}}}
		\sum\limits_{k,l = 1}^n {\prod\limits_{i = 1}^s {{\phi _{k,li}}} } } } } 
		\right]^{\frac{1}{2}}}</code>
</p>

<p>With the definition of <code class="reqn">\theta _{ki}</code> and <code class="reqn">\phi _{k,li}</code> as follows:
</p>
<p style="text-align: center;"><code class="reqn">{\theta _{ki}} = 2 + \left| {{x_{ki}} - \frac{1}{2}} \right| - 
		{\left| {{x_{ki}} - \frac{1}{2}} \right|^2}</code>
</p>

<p style="text-align: center;"><code class="reqn">{\phi _{k,li}} = 1 + \frac{1}{2}\left( {\left| {{x_{ki}} - \frac{1}{2}}
		\right| + \left| {{x_{li}} - \frac{1}{2}} \right| - \left| {{x_{ki}} - 
		{x_{li}}} \right|} \right)</code>
</p>

<p>where <code class="reqn">n</code>, <code class="reqn">s</code> are the number of runs (levels or multiple of levels) and 
the number of input variables (factors), respectively.		
</p>


<h3>Value</h3>

<table>
<tr><td><code>T</code></td>
<td>
<p>the selected uniform table(s) . It may contain one or more uniform 
tables with the same discrepancy
</p>
</td></tr>
<tr><td><code>D</code></td>
<td>
<p>the discrepancy of the constructed uniform table</p>
</td></tr>
<tr><td><code>sav</code></td>
<td>
<p>TRUE: save output to a default file; FALSE: output will not be saved; 
a custom file directory: save output to the custom file directory.</p>
</td></tr> 
</table>


<h3>References</h3>

<p>Wang, Y., Fang, K.-T., 1996. Uniform design of experiments with mixtures. Sci. China Ser. 
A-Mathematics Phys. Astron. 39, 264-275.<br />
Hickernell, F.J., 1996. A generalized discrepancy and quadrature error bound. Math. Comput. 
67, 299-322.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## example 1
# construct uniform table with 11 runs and 7 factors using the default centered L2-discrepancy 
# algorithm
unidTab(11, 7)

## example 2
# construct uniform table with 37 runs and 13 factors using the symmetric discrepancy algorithm 
unidTab(lev = 37, fac = 13, algo = "sd2")

## example 3
# construct uniform table with 37 runs and 13 factors using default centered L2-discrepancy 
# algorithm
unidTab(lev = 37, fac = 13, algo = "cd2")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
