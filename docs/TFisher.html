<!DOCTYPE html><html lang="en"><head><title>Help for package TFisher</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {TFisher}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#p.soft'><p>CDF of soft-thresholding Fisher's p-value combination statistic under the null hypothesis.</p></a></li>
<li><a href='#p.soft.omni'><p>CDF of omnibus soft-thresholding Fisher's p-value combination statistic under the null hypothesis.</p></a></li>
<li><a href='#p.tfisher'><p>CDF of thresholding Fisher's p-value combination statistic under the null hypothesis.</p></a></li>
<li><a href='#p.tfisher.omni'><p>CDF of omnibus thresholding Fisher's p-value combination statistic under the null hypothesis.</p></a></li>
<li><a href='#p.tpm'><p>CDF of truncated product method statistic under the null hypothesis.</p></a></li>
<li><a href='#p.tpm.omni'><p>CDF of omnibus truncated product method statistic under the null hypothesis.</p></a></li>
<li><a href='#power.soft'><p>Statistical power of soft-thresholding Fisher's p-value combination test under Gaussian mixture model.</p></a></li>
<li><a href='#power.tfisher'><p>Statistical power of thresholding Fisher's p-value combination test under Gaussian mixture model.</p></a></li>
<li><a href='#power.tpm'><p>Statistical power of truncated product method test under Gaussian mixture model.</p></a></li>
<li><a href='#q.soft'><p>Quantile of soft-thresholding Fisher's p-value combination statistic under the null hypothesis.</p></a></li>
<li><a href='#q.tfisher'><p>Quantile of thresholding Fisher's p-value combination statistic under the null hypothesis.</p></a></li>
<li><a href='#q.tpm'><p>Quantile of truncated product method statistic under the null hypothesis.</p></a></li>
<li><a href='#stat.soft'><p>Construct soft-thresholding Fisher's p-value combination statistic.</p></a></li>
<li><a href='#stat.soft.omni'><p>Construct omnibus soft-thresholding Fisher's p-value combination statistic.</p></a></li>
<li><a href='#stat.tfisher'><p>Construct thresholding Fisher's p-value combination statistic.</p></a></li>
<li><a href='#stat.tfisher.omni'><p>Construct omnibus thresholding Fisher's (TFisher) p-value combination statistic.</p></a></li>
<li><a href='#stat.tpm'><p>Construct truncated product method statistic.</p></a></li>
<li><a href='#stat.tpm.omni'><p>Construct omnibus truncated product method statistic.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Optimal Thresholding Fisher's P-Value Combination Method</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.0</td>
</tr>
<tr>
<td>Author:</td>
<td>Hong Zhang and Zheyang Wu</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Hong Zhang &lt;hzhang@wpi.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>We provide the cumulative distribution function (CDF),
    quantile, and statistical power calculator for a collection of 
    thresholding Fisher's p-value combination methods, including Fisher's 
    p-value combination method, truncated product method and, in particular, soft-thresholding
    Fisher's p-value combination method which is proven to be optimal in some
    context of signal detection. The p-value calculator for the omnibus version
    of these tests are also included. For reference, please see Hong Zhang and Zheyang Wu. "TFisher Tests: Optimal and Adaptive Thresholding for Combining p-Values", submitted.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, sn, mvtnorm, Matrix</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-03-21 02:51:25 UTC; Hong</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-03-21 12:05:33 UTC</td>
</tr>
</table>
<hr>
<h2 id='p.soft'>CDF of soft-thresholding Fisher's p-value combination statistic under the null hypothesis.</h2><span id='topic+p.soft'></span>

<h3>Description</h3>

<p>CDF of soft-thresholding Fisher's p-value combination statistic under the null hypothesis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>p.soft(q, n, tau1, M = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="p.soft_+3A_q">q</code></td>
<td>
<p>- quantile, could be a vector.</p>
</td></tr>
<tr><td><code id="p.soft_+3A_n">n</code></td>
<td>
<p>- dimension parameter, i.e. the number of p-values to be combined.</p>
</td></tr>
<tr><td><code id="p.soft_+3A_tau1">tau1</code></td>
<td>
<p>- truncation parameter=normalization parameter. tau1 &gt; 0.</p>
</td></tr>
<tr><td><code id="p.soft_+3A_m">M</code></td>
<td>
<p>- correlation matrix of the input statistics. Default = NULL assumes independence.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The left-tail probability of the null distribution of soft-thresholding Fisher's p-value combination statistic at the given quantile.
</p>


<h3>References</h3>

<p>1. Hong Zhang and Zheyang Wu. &quot;TFisher Tests: Optimal and Adaptive Thresholding for Combining p-Values&quot;, submitted.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stat.soft">stat.soft</a></code> for the definition of the statistic.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pval &lt;- runif(100)
softstat &lt;- stat.soft(p=pval, tau1=0.05)
p.soft(q=softstat, n=100, tau1=0.05)
M = matrix(0.3,100,100) + diag(1-0.3,100)
p.soft(q=softstat, n=100, tau1=0.05, M=M)
</code></pre>

<hr>
<h2 id='p.soft.omni'>CDF of omnibus soft-thresholding Fisher's p-value combination statistic under the null hypothesis.</h2><span id='topic+p.soft.omni'></span>

<h3>Description</h3>

<p>CDF of omnibus soft-thresholding Fisher's p-value combination statistic under the null hypothesis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>p.soft.omni(q, n, TAU1, M = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="p.soft.omni_+3A_q">q</code></td>
<td>
<p>- quantile, could be a vector.</p>
</td></tr>
<tr><td><code id="p.soft.omni_+3A_n">n</code></td>
<td>
<p>- dimension parameter, i.e. the number of p-values to be combined.</p>
</td></tr>
<tr><td><code id="p.soft.omni_+3A_tau1">TAU1</code></td>
<td>
<p>- a vector of truncation parameters (=normalization parameters). Must be in non-descending order.</p>
</td></tr>
<tr><td><code id="p.soft.omni_+3A_m">M</code></td>
<td>
<p>- correlation matrix of the input statistics. Default = NULL assumes independence.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The left-tail probability of the null distribution of omnibus soft-thresholding Fisher's p-value combination statistic.
</p>


<h3>References</h3>

<p>1. Hong Zhang and Zheyang Wu. &quot;TFisher Tests: Optimal and Adaptive Thresholding for Combining p-Values&quot;, submitted.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stat.soft.omni">stat.soft.omni</a></code> for the definition of the statistic.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>q = 0.01
n = 20
TAU1 = c(0.01, 0.05, 0.5, 1)
M = matrix(0.3,20,20) + diag(1-0.3,20)
p.soft.omni(q=q, n=n, TAU1=TAU1, M=M)
</code></pre>

<hr>
<h2 id='p.tfisher'>CDF of thresholding Fisher's p-value combination statistic under the null hypothesis.</h2><span id='topic+p.tfisher'></span>

<h3>Description</h3>

<p>CDF of thresholding Fisher's p-value combination statistic under the null hypothesis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>p.tfisher(q, n, tau1, tau2, M = NULL, mu = NULL, sigma2 = NULL,
  p0 = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="p.tfisher_+3A_q">q</code></td>
<td>
<p>- quantile, could be a vector.</p>
</td></tr>
<tr><td><code id="p.tfisher_+3A_n">n</code></td>
<td>
<p>- dimension parameter, i.e. the number of p-values to be combined.</p>
</td></tr>
<tr><td><code id="p.tfisher_+3A_tau1">tau1</code></td>
<td>
<p>- truncation parameter. 0 &lt; tau1 &lt;= 1.</p>
</td></tr>
<tr><td><code id="p.tfisher_+3A_tau2">tau2</code></td>
<td>
<p>- normalization parameter. tau2 &gt;= tau1.</p>
</td></tr>
<tr><td><code id="p.tfisher_+3A_m">M</code></td>
<td>
<p>- correlation matrix of the input statistics. Default = NULL assumes independence.</p>
</td></tr>
<tr><td><code id="p.tfisher_+3A_mu">mu</code></td>
<td>
<p>- the mean of TFisher statistics. Default = NULL.</p>
</td></tr>
<tr><td><code id="p.tfisher_+3A_sigma2">sigma2</code></td>
<td>
<p>- the variance of TFisher statistics. Default = NULL.</p>
</td></tr>
<tr><td><code id="p.tfisher_+3A_p0">p0</code></td>
<td>
<p>- the point masse of TFisher statistics. Default = NULL.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The left-tail probability of the null distribution of thresholding Fisher's p-value combination statistic at the given quantile.
</p>


<h3>References</h3>

<p>1. Hong Zhang and Zheyang Wu. &quot;TFisher Tests: Optimal and Adaptive Thresholding for Combining p-Values&quot;, submitted.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stat.tfisher">stat.tfisher</a></code> for the definition of the statistic.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pval &lt;- runif(20)
tfstat &lt;- stat.tfisher(p=pval, tau1=0.25, tau2=0.75)
p.tfisher(q=tfstat, n=20, tau1=0.25, tau2=0.75)
M = matrix(0.3,20,20) + diag(1-0.3,20)
p.tfisher(q=tfstat, n=20, tau1=0.25, tau2=0.75, M=M)
</code></pre>

<hr>
<h2 id='p.tfisher.omni'>CDF of omnibus thresholding Fisher's p-value combination statistic under the null hypothesis.</h2><span id='topic+p.tfisher.omni'></span>

<h3>Description</h3>

<p>CDF of omnibus thresholding Fisher's p-value combination statistic under the null hypothesis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>p.tfisher.omni(q, n, TAU1, TAU2, M = NULL, P0 = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="p.tfisher.omni_+3A_q">q</code></td>
<td>
<p>- quantile, could be a vector.</p>
</td></tr>
<tr><td><code id="p.tfisher.omni_+3A_n">n</code></td>
<td>
<p>- dimension parameter, i.e. the number of p-values to be combined.</p>
</td></tr>
<tr><td><code id="p.tfisher.omni_+3A_tau1">TAU1</code></td>
<td>
<p>- a vector of truncation parameters. Must be in non-descending order.</p>
</td></tr>
<tr><td><code id="p.tfisher.omni_+3A_tau2">TAU2</code></td>
<td>
<p>- a vector of normalization parameters. Must be in non-descending order.</p>
</td></tr>
<tr><td><code id="p.tfisher.omni_+3A_m">M</code></td>
<td>
<p>- correlation matrix of the input statistics. Default = NULL assumes independence.</p>
</td></tr>
<tr><td><code id="p.tfisher.omni_+3A_p0">P0</code></td>
<td>
<p>- a vector of point masses of TFisher statistics. Default = NULL.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The left-tail probability of the null distribution of omnibus thresholding Fisher's p-value combination statistic.
</p>


<h3>References</h3>

<p>1. Hong Zhang and Zheyang Wu. &quot;TFisher Tests: Optimal and Adaptive Thresholding for Combining p-Values&quot;, submitted.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stat.tfisher.omni">stat.tfisher.omni</a></code> for the definition of the statistic.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>q = 0.05
n = 20
TAU1 = c(0.01, 0.05, 0.5, 1)
TAU2 = c(0.1, 0.2, 0.5, 1)
M = matrix(0.3,20,20) + diag(1-0.3,20)
p.tfisher.omni(q=q, n=n, TAU1=TAU1, TAU2=TAU2, M=M)
</code></pre>

<hr>
<h2 id='p.tpm'>CDF of truncated product method statistic under the null hypothesis.</h2><span id='topic+p.tpm'></span>

<h3>Description</h3>

<p>CDF of truncated product method statistic under the null hypothesis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>p.tpm(q, n, tau1, M = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="p.tpm_+3A_q">q</code></td>
<td>
<p>- quantile, could be a vector.</p>
</td></tr>
<tr><td><code id="p.tpm_+3A_n">n</code></td>
<td>
<p>- dimension parameter, i.e. the number of p-values to be combined.</p>
</td></tr>
<tr><td><code id="p.tpm_+3A_tau1">tau1</code></td>
<td>
<p>- truncation parameter. 0 &lt; tau1 &lt;= 1.</p>
</td></tr>
<tr><td><code id="p.tpm_+3A_m">M</code></td>
<td>
<p>- correlation matrix of the input statistics. Default = NULL assumes independence.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The left-tail probability of the null distribution of truncated product method statistic at the given quantile.
</p>


<h3>References</h3>

<p>1. Hong Zhang and Zheyang Wu. &quot;TFisher Tests: Optimal and Adaptive Thresholding for Combining p-Values&quot;, submitted.
</p>
<p>2. Zaykin, D.V., Zhivotovsky, L. A., Westfall, P.H. and Weir, B.S. (2002), Truncated product method for combining P-values. Genet. Epidemiol., 22: 170–185. doi:10.1002/gepi.0042
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stat.tpm">stat.tpm</a></code> for the definition of the statistic.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pval &lt;- runif(100)
tpmstat &lt;- stat.tpm(p=pval, tau1=0.05)
p.tpm(q=tpmstat, n=100, tau1=0.05)
M = matrix(0.3,100,100) + diag(1-0.3,100)
p.tpm(q=tpmstat, n=100, tau1=0.05, M=M)
</code></pre>

<hr>
<h2 id='p.tpm.omni'>CDF of omnibus truncated product method statistic under the null hypothesis.</h2><span id='topic+p.tpm.omni'></span>

<h3>Description</h3>

<p>CDF of omnibus truncated product method statistic under the null hypothesis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>p.tpm.omni(q, n, TAU1, M = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="p.tpm.omni_+3A_q">q</code></td>
<td>
<p>- quantile, could be a vector.</p>
</td></tr>
<tr><td><code id="p.tpm.omni_+3A_n">n</code></td>
<td>
<p>- dimension parameter, i.e. the number of p-values to be combined.</p>
</td></tr>
<tr><td><code id="p.tpm.omni_+3A_tau1">TAU1</code></td>
<td>
<p>- a vector of truncation parameters. Must be in non-descending order.</p>
</td></tr>
<tr><td><code id="p.tpm.omni_+3A_m">M</code></td>
<td>
<p>- correlation matrix of the input statistics. Default = NULL assumes independence</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The left-tail probability of the null distribution of omnibus truncated product method statistic.
</p>


<h3>References</h3>

<p>1. Hong Zhang and Zheyang Wu. &quot;TFisher Tests: Optimal and Adaptive Thresholding for Combining p-Values&quot;, submitted.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stat.tpm.omni">stat.tpm.omni</a></code> for the definition of the statistic.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>q = 0.05
n = 20
TAU1 = c(0.01, 0.05, 0.5, 1)
M = matrix(0.3,20,20) + diag(1-0.3,20)
p.tpm.omni(q=q, n=n, TAU1=TAU1, M=M)
</code></pre>

<hr>
<h2 id='power.soft'>Statistical power of soft-thresholding Fisher's p-value combination test under Gaussian mixture model.</h2><span id='topic+power.soft'></span>

<h3>Description</h3>

<p>Statistical power of soft-thresholding Fisher's p-value combination test under Gaussian mixture model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>power.soft(alpha, n, tau1, eps = 0, mu = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="power.soft_+3A_alpha">alpha</code></td>
<td>
<p>- type-I error rate.</p>
</td></tr>
<tr><td><code id="power.soft_+3A_n">n</code></td>
<td>
<p>- dimension parameter, i.e. the number of input p-values.</p>
</td></tr>
<tr><td><code id="power.soft_+3A_tau1">tau1</code></td>
<td>
<p>- truncation parameter=normalization parameter. tau1 &gt; 0.</p>
</td></tr>
<tr><td><code id="power.soft_+3A_eps">eps</code></td>
<td>
<p>- mixing parameter of the Gaussian mixture.</p>
</td></tr>
<tr><td><code id="power.soft_+3A_mu">mu</code></td>
<td>
<p>- mean of non standard Gaussian model.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We consider the following hypothesis test,
</p>
<p style="text-align: center;"><code class="reqn">H_0: X_i\sim F_0, H_a: X_i\sim (1-\epsilon)F_0+\epsilon F_1</code>
</p>

<p>, where <code class="reqn">\epsilon</code> is the mixing parameter,
<code class="reqn">F_0</code> is the standard normal CDF and <code class="reqn">F = F_1</code> is the CDF of normal distribution with <code class="reqn">\mu</code> defined by mu and <code class="reqn">\sigma = 1</code>.
</p>


<h3>Value</h3>

<p>Power of the soft-thresholding Fisher's p-value combination test.
</p>


<h3>References</h3>

<p>1. Hong Zhang and Zheyang Wu. &quot;TFisher Tests: Optimal and Adaptive Thresholding for Combining p-Values&quot;, submitted.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stat.soft">stat.soft</a></code> for the definition of the statistic.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>alpha = 0.05
#If the alternative hypothesis Gaussian mixture with eps = 0.1 and mu = 1.2:#
power.soft(alpha, 100, 0.05, eps = 0.1, mu = 1.2)
</code></pre>

<hr>
<h2 id='power.tfisher'>Statistical power of thresholding Fisher's p-value combination test under Gaussian mixture model.</h2><span id='topic+power.tfisher'></span>

<h3>Description</h3>

<p>Statistical power of thresholding Fisher's p-value combination test under Gaussian mixture model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>power.tfisher(alpha, n, tau1, tau2, eps = 0, mu = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="power.tfisher_+3A_alpha">alpha</code></td>
<td>
<p>- type-I error rate.</p>
</td></tr>
<tr><td><code id="power.tfisher_+3A_n">n</code></td>
<td>
<p>- dimension parameter, i.e. the number of input p-values.</p>
</td></tr>
<tr><td><code id="power.tfisher_+3A_tau1">tau1</code></td>
<td>
<p>- truncation parameter. 0 &lt; tau1 &lt;= 1.</p>
</td></tr>
<tr><td><code id="power.tfisher_+3A_tau2">tau2</code></td>
<td>
<p>- normalization parameter. tau2 &gt;= tau1.</p>
</td></tr>
<tr><td><code id="power.tfisher_+3A_eps">eps</code></td>
<td>
<p>- mixing parameter of the Gaussian mixture.</p>
</td></tr>
<tr><td><code id="power.tfisher_+3A_mu">mu</code></td>
<td>
<p>- mean of non standard Gaussian model.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We consider the following hypothesis test,
</p>
<p style="text-align: center;"><code class="reqn">H_0: X_i\sim F_0, H_a: X_i\sim (1-\epsilon)F_0+\epsilon F_1</code>
</p>

<p>, where <code class="reqn">\epsilon</code> is the mixing parameter,
<code class="reqn">F_0</code> is the standard normal CDF and <code class="reqn">F = F_1</code> is the CDF of normal distribution with <code class="reqn">\mu</code> defined by mu and <code class="reqn">\sigma = 1</code>.
</p>


<h3>Value</h3>

<p>Power of the thresholding Fisher's p-value combination test.
</p>


<h3>References</h3>

<p>1. Hong Zhang and Zheyang Wu. &quot;TFisher Tests: Optimal and Adaptive Thresholding for Combining p-Values&quot;, submitted.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stat.tfisher">stat.tfisher</a></code> for the definition of the statistic.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>alpha = 0.05
#If the alternative hypothesis Gaussian mixture with eps = 0.1 and mu = 1.2:#
power.tfisher(alpha, 100, 0.05, 0.25, eps = 0.1, mu = 1.2)
</code></pre>

<hr>
<h2 id='power.tpm'>Statistical power of truncated product method test under Gaussian mixture model.</h2><span id='topic+power.tpm'></span>

<h3>Description</h3>

<p>Statistical power of truncated product method test under Gaussian mixture model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>power.tpm(alpha, n, tau1, eps = 0, mu = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="power.tpm_+3A_alpha">alpha</code></td>
<td>
<p>- type-I error rate.</p>
</td></tr>
<tr><td><code id="power.tpm_+3A_n">n</code></td>
<td>
<p>- dimension parameter, i.e. the number of input p-values.</p>
</td></tr>
<tr><td><code id="power.tpm_+3A_tau1">tau1</code></td>
<td>
<p>- truncation parameter. 0 &lt; tau1 &lt;= 1. tau1 &gt; 0.</p>
</td></tr>
<tr><td><code id="power.tpm_+3A_eps">eps</code></td>
<td>
<p>- mixing parameter of the Gaussian mixture.</p>
</td></tr>
<tr><td><code id="power.tpm_+3A_mu">mu</code></td>
<td>
<p>- mean of non standard Gaussian model.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We consider the following hypothesis test,
</p>
<p style="text-align: center;"><code class="reqn">H_0: X_i\sim F_0, H_a: X_i\sim (1-\epsilon)F_0+\epsilon F_1</code>
</p>

<p>, where <code class="reqn">\epsilon</code> is the mixing parameter,
<code class="reqn">F_0</code> is the standard normal CDF and <code class="reqn">F = F_1</code> is the CDF of normal distribution with <code class="reqn">\mu</code> defined by mu and <code class="reqn">\sigma = 1</code>.
</p>


<h3>Value</h3>

<p>Power of the truncated product method test.
</p>


<h3>References</h3>

<p>1. Hong Zhang and Zheyang Wu. &quot;TFisher Tests: Optimal and Adaptive Thresholding for Combining p-Values&quot;, submitted.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stat.soft">stat.soft</a></code> for the definition of the statistic.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>alpha = 0.05
#If the alternative hypothesis Gaussian mixture with eps = 0.1 and mu = 1.2:#
power.tpm(alpha, 100, 0.05, eps = 0.1, mu = 1.2)
</code></pre>

<hr>
<h2 id='q.soft'>Quantile of soft-thresholding Fisher's p-value combination statistic under the null hypothesis.</h2><span id='topic+q.soft'></span>

<h3>Description</h3>

<p>Quantile of soft-thresholding Fisher's p-value combination statistic under the null hypothesis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>q.soft(p, n, tau1, M = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="q.soft_+3A_p">p</code></td>
<td>
<p>-  a scalar left probability that defines the quantile.</p>
</td></tr>
<tr><td><code id="q.soft_+3A_n">n</code></td>
<td>
<p>- dimension parameter, i.e. the number of input p-values.</p>
</td></tr>
<tr><td><code id="q.soft_+3A_tau1">tau1</code></td>
<td>
<p>- truncation parameter=normalization parameter. tau1 &gt; 0.</p>
</td></tr>
<tr><td><code id="q.soft_+3A_m">M</code></td>
<td>
<p>- correlation matrix of the input statistics. Default = NULL assumes independence.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Quantile of soft-thresholding Fisher's p-value combination statistic.
</p>


<h3>References</h3>

<p>1. Hong Zhang and Zheyang Wu. &quot;TFisher Tests: Optimal and Adaptive Thresholding for Combining p-Values&quot;, submitted.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stat.soft">stat.soft</a></code> for the definition of the statistic.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## The 0.05 critical value of soft-thresholding statistic when n = 10:
q.soft(p=.99, n=20, tau1 = 0.05)
M = matrix(0.9,20,20) + diag(1-0.9,20)
q.soft(p=.99, n=20, tau1 = 0.05, M=M)
</code></pre>

<hr>
<h2 id='q.tfisher'>Quantile of thresholding Fisher's p-value combination statistic under the null hypothesis.</h2><span id='topic+q.tfisher'></span>

<h3>Description</h3>

<p>Quantile of thresholding Fisher's p-value combination statistic under the null hypothesis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>q.tfisher(p, n, tau1, tau2, M = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="q.tfisher_+3A_p">p</code></td>
<td>
<p>-  a scalar left probability that defines the quantile.</p>
</td></tr>
<tr><td><code id="q.tfisher_+3A_n">n</code></td>
<td>
<p>- dimension parameter, i.e. the number of input p-values.</p>
</td></tr>
<tr><td><code id="q.tfisher_+3A_tau1">tau1</code></td>
<td>
<p>- truncation parameter. 0 &lt; tau1 &lt;= 1.</p>
</td></tr>
<tr><td><code id="q.tfisher_+3A_tau2">tau2</code></td>
<td>
<p>- normalization parameter. tau2 &gt;= tau1.</p>
</td></tr>
<tr><td><code id="q.tfisher_+3A_m">M</code></td>
<td>
<p>- correlation matrix of the input statistics. Default = NULL assumes independence.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Quantile of thresholding Fisher's p-value combination statistic.
</p>


<h3>References</h3>

<p>1. Hong Zhang and Zheyang Wu. &quot;TFisher Tests: Optimal and Adaptive Thresholding for Combining p-Values&quot;, submitted.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stat.tfisher">stat.tfisher</a></code> for the definition of the statistic.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## The 0.05 critical value of TFisher statistic when n = 10:
q.tfisher(p=.95, n=20, tau1=0.05, tau2=0.25)
## when corrrelated
M = matrix(0.3,20,20) + diag(1-0.3,20)
q.tfisher(p=.95, n=20, tau1=0.05, tau2=0.25, M=M)
</code></pre>

<hr>
<h2 id='q.tpm'>Quantile of truncated product method statistic under the null hypothesis.</h2><span id='topic+q.tpm'></span>

<h3>Description</h3>

<p>Quantile of truncated product method statistic under the null hypothesis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>q.tpm(p, n, tau1, M = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="q.tpm_+3A_p">p</code></td>
<td>
<p>-  a scalar left probability that defines the quantile.</p>
</td></tr>
<tr><td><code id="q.tpm_+3A_n">n</code></td>
<td>
<p>- dimension parameter, i.e. the number of input p-values.</p>
</td></tr>
<tr><td><code id="q.tpm_+3A_tau1">tau1</code></td>
<td>
<p>- truncation parameter. 0 &lt; tau1 &lt;= 1.</p>
</td></tr>
<tr><td><code id="q.tpm_+3A_m">M</code></td>
<td>
<p>- correlation matrix of the input statistics. Default = NULL assumes independence.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Quantile of truncated product method statistic.
</p>


<h3>References</h3>

<p>1. Hong Zhang and Zheyang Wu. &quot;TFisher Tests: Optimal and Adaptive Thresholding for Combining p-Values&quot;, submitted.
</p>
<p>2. Zaykin, D.V., Zhivotovsky, L. A., Westfall, P.H. and Weir, B.S. (2002), Truncated product method for combining P-values. Genet. Epidemiol., 22: 170–185. doi:10.1002/gepi.0042
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stat.tpm">stat.tpm</a></code> for the definition of the statistic.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## The 0.05 critical value of TPM statistic when n = 10:
q.tpm(p=.95, n=20, tau1 = 0.05)
M = matrix(0.3,20,20) + diag(1-0.3,20)
q.tpm(p=.95, n=20, tau1 = 0.05, M=M)
</code></pre>

<hr>
<h2 id='stat.soft'>Construct soft-thresholding Fisher's p-value combination statistic.</h2><span id='topic+stat.soft'></span>

<h3>Description</h3>

<p>Construct soft-thresholding Fisher's p-value combination statistic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stat.soft(p, tau1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="stat.soft_+3A_p">p</code></td>
<td>
<p>- input p-values.</p>
</td></tr>
<tr><td><code id="stat.soft_+3A_tau1">tau1</code></td>
<td>
<p>- truncation parameter=normalization parameter. tau1 &gt; 0.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let <code class="reqn">p_{i}</code>, <code class="reqn">i = 1,...,n</code> be a sequence of p-values, the soft-thresholding statistic
</p>
<p style="text-align: center;"><code class="reqn">Soft = \sum_{i=1}^n -2\log(p_i/\tau_1)I(p_i\leq\tau_1)</code>
</p>
<p>. Soft-thresholding is the special case of TFisher when tau1=tau2.
</p>


<h3>Value</h3>

<p>Soft-thresholding Fisher's p-value combination statistic.
</p>


<h3>References</h3>

<p>1. Hong Zhang and Zheyang Wu. &quot;TFisher Tests: Optimal and Adaptive Thresholding for Combining p-Values&quot;, submitted.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pval &lt;- runif(100)
stat.soft(p=pval, tau1=0.05)
</code></pre>

<hr>
<h2 id='stat.soft.omni'>Construct omnibus soft-thresholding Fisher's p-value combination statistic.</h2><span id='topic+stat.soft.omni'></span>

<h3>Description</h3>

<p>Construct omnibus soft-thresholding Fisher's p-value combination statistic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stat.soft.omni(p, TAU1, M = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="stat.soft.omni_+3A_p">p</code></td>
<td>
<p>- input p-values.</p>
</td></tr>
<tr><td><code id="stat.soft.omni_+3A_tau1">TAU1</code></td>
<td>
<p>- a vector of truncation parameters (=normalization parameters). Must be in non-descending order.</p>
</td></tr>
<tr><td><code id="stat.soft.omni_+3A_m">M</code></td>
<td>
<p>- correlation matrix of the input statistics. Default = NULL assumes independence.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let <code class="reqn">x_{i}</code>, <code class="reqn">i = 1,...,n</code> be a sequence of individual statistics with
correlation matrix M, <code class="reqn">p_{i}</code> be the corresponding two-sided p-values, then the soft-thresholding statistics
</p>
<p style="text-align: center;"><code class="reqn">Soft_j = \sum_{i=1}^n -2\log(p_i/\tau_{1j})I(p_i\leq\tau_{1j})</code>
</p>
<p>, <code class="reqn">j = 1,...,d</code>.
The omnibus test statistic is the minimum p-value of these soft-thresholding tests,
</p>
<p style="text-align: center;"><code class="reqn">W_o = min_j G_j(Soft_j)</code>
</p>
<p>, where <code class="reqn">G_j</code> is the survival function of <code class="reqn">Soft_j</code>.
</p>


<h3>Value</h3>

<p>omni - omnibus soft-thresholding statistic.
</p>
<p>pval - p-values of each soft-thresholding tests.
</p>


<h3>References</h3>

<p>1. Hong Zhang and Zheyang Wu. &quot;TFisher Tests: Optimal and Adaptive Thresholding for Combining p-Values&quot;, submitted.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pval = runif(20)
TAU1 = c(0.01, 0.05, 0.5, 1)
stat.soft.omni(p=pval, TAU1=TAU1)
M = matrix(0.3,20,20) + diag(1-0.3,20)
stat.soft.omni(p=pval, TAU1=TAU1, M=M)
</code></pre>

<hr>
<h2 id='stat.tfisher'>Construct thresholding Fisher's p-value combination statistic.</h2><span id='topic+stat.tfisher'></span>

<h3>Description</h3>

<p>Construct thresholding Fisher's p-value combination statistic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stat.tfisher(p, tau1, tau2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="stat.tfisher_+3A_p">p</code></td>
<td>
<p>- input p-values.</p>
</td></tr>
<tr><td><code id="stat.tfisher_+3A_tau1">tau1</code></td>
<td>
<p>- truncation parameter. 0 &lt; tau1 &lt;= 1.</p>
</td></tr>
<tr><td><code id="stat.tfisher_+3A_tau2">tau2</code></td>
<td>
<p>- normalization parameter. tau2 &gt;= tau1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let <code class="reqn">p_{i}</code>, <code class="reqn">i = 1,...,n</code> be a sequence of p-values, the thresholding Fisher's p-value combination statistic
</p>
<p style="text-align: center;"><code class="reqn">TFisher = \sum_{i=1}^n -2\log(p_i/\tau_2)I(p_i\leq\tau_2)</code>
</p>



<h3>Value</h3>

<p>Thresholding Fisher's p-value combination statistic.
</p>


<h3>References</h3>

<p>1. Hong Zhang and Zheyang Wu. &quot;TFisher Tests: Optimal and Adaptive Thresholding for Combining p-Values&quot;, submitted.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pval &lt;- runif(100)
stat.tfisher(p=pval, tau1=0.05, tau2=0.25)
</code></pre>

<hr>
<h2 id='stat.tfisher.omni'>Construct omnibus thresholding Fisher's (TFisher) p-value combination statistic.</h2><span id='topic+stat.tfisher.omni'></span>

<h3>Description</h3>

<p>Construct omnibus thresholding Fisher's (TFisher) p-value combination statistic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stat.tfisher.omni(p, TAU1, TAU2, M = NULL, MU = NULL, SIGMA2 = NULL,
  P0 = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="stat.tfisher.omni_+3A_p">p</code></td>
<td>
<p>- input p-values from potentially correlated input sstatistics.</p>
</td></tr>
<tr><td><code id="stat.tfisher.omni_+3A_tau1">TAU1</code></td>
<td>
<p>- a vector of truncation parameters. Must be in non-descending order.</p>
</td></tr>
<tr><td><code id="stat.tfisher.omni_+3A_tau2">TAU2</code></td>
<td>
<p>- a vector of normalization parameters. Must be in non-descending order.</p>
</td></tr>
<tr><td><code id="stat.tfisher.omni_+3A_m">M</code></td>
<td>
<p>- correlation matrix of the input statistics. Default = NULL assumes independence</p>
</td></tr>
<tr><td><code id="stat.tfisher.omni_+3A_mu">MU</code></td>
<td>
<p>- a vector of means of TFisher statistics. Default = NULL.</p>
</td></tr>
<tr><td><code id="stat.tfisher.omni_+3A_sigma2">SIGMA2</code></td>
<td>
<p>- a vector of variances of TFisher statistics. Default = NULL.</p>
</td></tr>
<tr><td><code id="stat.tfisher.omni_+3A_p0">P0</code></td>
<td>
<p>- a vector of point masses of TFisher statistics. Default = NULL.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let <code class="reqn">x_{i}</code>, <code class="reqn">i = 1,...,n</code> be a sequence of individual statistics with
correlation matrix M, <code class="reqn">p_{i}</code> be the corresponding two-sided p-values, then the TFisher statistics
</p>
<p style="text-align: center;"><code class="reqn">TFisher_j = \sum_{i=1}^n -2\log(p_i/\tau_{2j})I(p_i\leq\tau_{1j})</code>
</p>
<p>, <code class="reqn">j = 1,...,d</code>.
The omnibus test statistic is the minimum p-value of these thresholding tests,
</p>
<p style="text-align: center;"><code class="reqn">W_o = min_j G_j(Soft_j)</code>
</p>
<p>, where <code class="reqn">G_j</code> is the survival function of <code class="reqn">Soft_j</code>.
</p>


<h3>Value</h3>

<p>omni - omnibus TFisher statistic.
</p>
<p>pval - p-values of each TFisher tests.
</p>


<h3>References</h3>

<p>1. Hong Zhang and Zheyang Wu. &quot;TFisher Tests: Optimal and Adaptive Thresholding for Combining p-Values&quot;, submitted.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pval = runif(20)
TAU1 = c(0.01, 0.05, 0.5, 1)
TAU2 = c(0.1, 0.2, 0.5, 1)
stat.tfisher.omni(p=pval, TAU1=TAU1, TAU2=TAU2)
M = matrix(0.3,20,20) + diag(1-0.3,20)
stat.tfisher.omni(p=pval, TAU1=TAU1, TAU2=TAU2, M=M)
</code></pre>

<hr>
<h2 id='stat.tpm'>Construct truncated product method statistic.</h2><span id='topic+stat.tpm'></span>

<h3>Description</h3>

<p>Construct truncated product method statistic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stat.tpm(p, tau1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="stat.tpm_+3A_p">p</code></td>
<td>
<p>- input p-values.</p>
</td></tr>
<tr><td><code id="stat.tpm_+3A_tau1">tau1</code></td>
<td>
<p>- truncation parameter. 0 &lt; tau1 &lt;= 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let <code class="reqn">p_{i}</code>, <code class="reqn">i = 1,...,n</code> be a sequence of p-values, the TPM statistic
</p>
<p style="text-align: center;"><code class="reqn">TPM = \sum_{i=1}^n -2\log(p_i)I(p_i\leq\tau_2)</code>
</p>
<p>. TPM is the special case of TFisher when tau2=1.
</p>


<h3>Value</h3>

<p>Truncated product method statistic.
</p>


<h3>References</h3>

<p>1. Hong Zhang and Zheyang Wu. &quot;TFisher Tests: Optimal and Adaptive Thresholding for Combining p-Values&quot;, submitted.
</p>
<p>2. Zaykin, D.V., Zhivotovsky, L. A., Westfall, P.H. and Weir, B.S. (2002), Truncated product method for combining P-values. Genet. Epidemiol., 22: 170–185. doi:10.1002/gepi.0042
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pval &lt;- runif(100)
stat.tpm(p=pval, tau1=0.05)
</code></pre>

<hr>
<h2 id='stat.tpm.omni'>Construct omnibus truncated product method statistic.</h2><span id='topic+stat.tpm.omni'></span>

<h3>Description</h3>

<p>Construct omnibus truncated product method statistic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stat.tpm.omni(p, TAU1, M = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="stat.tpm.omni_+3A_p">p</code></td>
<td>
<p>- input p-values.</p>
</td></tr>
<tr><td><code id="stat.tpm.omni_+3A_tau1">TAU1</code></td>
<td>
<p>- a vector of truncation parameters. Must be in non-descending order.</p>
</td></tr>
<tr><td><code id="stat.tpm.omni_+3A_m">M</code></td>
<td>
<p>- correlation matrix of the input statistics. Default = NULL assumes independence.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let <code class="reqn">x_{i}</code>, <code class="reqn">i = 1,...,n</code> be a sequence of individual statistics with
correlation matrix M, <code class="reqn">p_{i}</code> be the corresponding two-sided p-values, then the truncated product method statistics
</p>
<p style="text-align: center;"><code class="reqn">TPM_j = \sum_{i=1}^n -2\log(p_i)I(p_i\leq\tau_{1j})</code>
</p>
<p>, <code class="reqn">j = 1,...,d</code>.
The omnibus test statistic is the minimum p-value of these truncated product method tests,
</p>
<p style="text-align: center;"><code class="reqn">W_o = min_j G_j(TPM_j)</code>
</p>
<p>, where <code class="reqn">G_j</code> is the survival function of <code class="reqn">TPM_j</code>.
</p>


<h3>Value</h3>

<p>omni - omnibus truncated product method statistic.
</p>
<p>pval - p-values of each truncated product method tests.
</p>


<h3>References</h3>

<p>1. Hong Zhang and Zheyang Wu. &quot;TFisher Tests: Optimal and Adaptive Thresholding for Combining p-Values&quot;, submitted.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pval = runif(20)
TAU1 = c(0.01, 0.05, 0.5, 1)
stat.tpm.omni(p=pval, TAU1=TAU1)
M = matrix(0.3,20,20) + diag(1-0.3,20)
stat.tpm.omni(p=pval, TAU1=TAU1, M=M)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
