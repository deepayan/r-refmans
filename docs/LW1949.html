<!DOCTYPE html><html lang="en"><head><title>Help for package LW1949</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {LW1949}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#LW1949'><p>Automated Litchfield and Wilcoxon (1949) Evaluation of Dose-Effect</p>
Experiments</a></li>
<li><a href='#assessfit'><p>Assess Fit of Dose-Response Curve</p></a></li>
<li><a href='#coefprobit'><p>Calculate the Coefficients of a Probit Regression Fit</p></a></li>
<li><a href='#constrain'><p>Constrain Data to a Specified Range</p></a></li>
<li><a href='#correctval'><p>Predict the Corrected Proportional Effect</p></a></li>
<li><a href='#dataprep'><p>Prepare Data</p></a></li>
<li><a href='#estimable'><p>Determine if a Dose-Effect Relation is Estimable</p></a></li>
<li><a href='#fill'><p>Fill in Missing Values</p></a></li>
<li><a href='#fitHand'><p>Best Fit Using Estimated Expected Effects</p></a></li>
<li><a href='#fitlinear'><p>Determine Linear Regression Coefficients from Dose-Effect Data</p></a></li>
<li><a href='#fitLWauto'><p>Best Fit Using Litchfield and Wilcoxon Evaluation of Dose-Effect Experiments</p></a></li>
<li><a href='#fitprobit'><p>Fit a Probit Regression to Dose-Effect Data</p></a></li>
<li><a href='#fxcat'><p>Define Effect Category</p></a></li>
<li><a href='#gamtable1'><p>Fit a smooth GAM to Table 1 of Litchfield and Wilcoxon (1949)</p></a></li>
<li><a href='#invprobit'><p>Convert Probit Scale to Proportions</p></a></li>
<li><a href='#keeponly'><p>Eliminate Consecutive Extreme Values</p></a></li>
<li><a href='#LWchi2'><p>Chi-Squared Statistic</p></a></li>
<li><a href='#LWestimate'><p>Generate Litchfield and Wilcoxon Estimates</p></a></li>
<li><a href='#LWnomo1'><p>Recreate Litchfield and Wilcoxon's Nomograph No. 1</p></a></li>
<li><a href='#LWP'><p>User Friendly Evaluation of Dose-Effect Experiments using Litchfield-Wilcoxon</p>
and Probit Methods</a></li>
<li><a href='#nomoCoord'><p>Find the Coordinate from the Scale of a Nomograph</p></a></li>
<li><a href='#plotDE'><p>Plot Dose-Effect Experiments</p></a></li>
<li><a href='#plotDELP'><p>Plot Dose-Effect Experiments</p></a></li>
<li><a href='#predlinear'><p>Determine the Effective Dose from a Linear Regression Fit</p></a></li>
<li><a href='#predLines'><p>Add Litchfield and Wilcoxon Predictions to a Plot</p></a></li>
<li><a href='#predLinesLP'><p>Add Litchfield and Wilcoxon Predictions to a Plot</p></a></li>
<li><a href='#predprobit'><p>Determine the Effective Dose from a Probit Regression Fit</p></a></li>
<li><a href='#prettylog'><p>Pretty Breakpoints on Log Scale</p></a></li>
<li><a href='#probit'><p>Convert Proportions to the Probit Scale</p></a></li>
<li><a href='#relPotency'><p>Relative Potency of Two Toxins</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>1.1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2017-03-20</td>
</tr>
<tr>
<td>Title:</td>
<td>An Automated Approach to Evaluating Dose-Effect Experiments
Following Litchfield and Wilcoxon (1949)</td>
</tr>
<tr>
<td>Author:</td>
<td>Jean V. Adams [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jean V. Adams &lt;jvadams@usgs.gov&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.3.2)</td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS, mgcv, plotrix, tcltk, grDevices, graphics, stats, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>magrittr, testthat, knitr, rmarkdown</td>
</tr>
<tr>
<td>Description:</td>
<td>The manual approach of Litchfield and Wilcoxon (1949)
    <a href="http://jpet.aspetjournals.org/content/96/2/99.abstract">http://jpet.aspetjournals.org/content/96/2/99.abstract</a>
    for evaluating dose-effect experiments
    is automated so that the computer can do the work. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/JVAdams/LW1949">https://github.com/JVAdams/LW1949</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/JVAdams/LW1949/issues">https://github.com/JVAdams/LW1949/issues</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2017-03-20 16:30:10 UTC; jvadams</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2017-03-20 17:34:16 UTC</td>
</tr>
</table>
<hr>
<h2 id='LW1949'>Automated Litchfield and Wilcoxon (1949) Evaluation of Dose-Effect
Experiments</h2><span id='topic+LW1949'></span><span id='topic+LW1949-package'></span>

<h3>Description</h3>

<p><span class="pkg">LW1949</span> is an automated approach to Litchfield and Wilcoxon's (1949)
evaluation of dose-effect experiments.
<span class="pkg">LW1949</span> was first introduced by Adams et al. (<em>in preparation</em>).
</p>


<h3>Details</h3>

<p>An example of how to use the functions in <span class="pkg">LW1949</span> is given in this
vignette
<a href="https://rawgit.com/JVAdams/LW1949/master/vignettes/Intro.html">[link]</a>.
Use <code><a href="#topic+dataprep">dataprep</a></code> to create a data frame with the results of a
dose-effect experiment.
Use <code><a href="#topic+fitLWauto">fitLWauto</a></code> and <code><a href="#topic+LWestimate">LWestimate</a></code> to
fit dose-effect relations.
And use <code><a href="#topic+plotDELP">plotDELP</a></code> and <code><a href="#topic+plotDE">plotDE</a></code> to plot the results.
</p>
<p><em>U.S. Geological Survey</em> (USGS) Computer Program <span class="pkg">LW1949</span> version
1.1.0
Written by Jean V. Adams, USGS - Great Lakes Science Center
<a href="http://www.glsc.usgs.gov/">glsc.usgs.gov</a>, Ann Arbor, Michigan, USA.
Written in programming language R (R Core Team, 2017, www.R-project.org),
version 3.3.3 (2017-03-06).
Run on a PC with Intel(R) Core(TM) I7-4600m CPU, 2.90 GHz processor,
16.0 GB RAM, and Microsoft Windows 7 Enterprise operating system 2009
Service Pack 1.
Source code is available from Jean V. Adams on GitHub,
<a href="https://github.com/JVAdams/LW1949">github.com/JVAdams/LW1949</a>,
<em>jvadams (at) usgs (dot) gov</em>.
</p>
<p><em>Disclaimer:</em>  Although this program has been used by the USGS,
no warranty, expressed or implied, is made by the USGS or the United States
Government as to the accuracy and functioning of the program and related
program material nor shall the fact of distribution constitute any such
warranty, and no responsibility is assumed by the USGS in connection
therewith.
</p>


<h3>References</h3>

<p>Adams, JV, KS Slaght, and MA Boogaard.  2016.
An automated approach to Litchfield and Wilcoxon's evaluation of
dose-effect experiments using the R package LW1949.
Environmental Toxicology and Chemistry 35(12):3058-3061.
<a href="https://doi.org/10.1002/etc.3490">DOI 10.1002/etc.3490</a>.
Adams, Jean V., Karen S. Slaght, and Michael A. Boogaard.&quot;,
</p>
<p>Litchfield, JT Jr. and F Wilcoxon.  1949.
A simplified method of evaluating dose-effect experiments.
Journal of Pharmacology and Experimental Therapeutics 96(2):99-113.
<a href="http://jpet.aspetjournals.org/content/96/2/99.abstract">[link]</a>.
</p>

<hr>
<h2 id='assessfit'>Assess Fit of Dose-Response Curve</h2><span id='topic+assessfit'></span>

<h3>Description</h3>

<p>Assess the fit of a dose-response curve using the chi-squared statistic.
The curve is described by the intercept and slope of a straight line in
the log dose vs. probit effect scale.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>assessfit(params, DEdata, fit = gamtable1(), simple = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="assessfit_+3A_params">params</code></td>
<td>
<p>A numeric vector of length two, with the estimated intercept
and slope of the dose-effect relation on the log10 and probit scale.
These parameters define the dose-response curve.</p>
</td></tr>
<tr><td><code id="assessfit_+3A_dedata">DEdata</code></td>
<td>
<p>A data frame of dose-effect data (typically, the output from
<code><a href="#topic+dataprep">dataprep</a></code>) containing at least these four variables: dose,
ntot, pfx, fxcateg.</p>
</td></tr>
<tr><td><code id="assessfit_+3A_fit">fit</code></td>
<td>
<p>A model object that can be used to predict the corrected values
(as proportions) from <code>distexpprop5</code>, the distance between the
expected values (as proportions) and 0.5, default <code><a href="#topic+gamtable1">gamtable1</a>()</code>.</p>
</td></tr>
<tr><td><code id="assessfit_+3A_simple">simple</code></td>
<td>
<p>A logical scalar indicating if the output should be restricted to
just the P value, default TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is used to find the dose-response curve that minimizes the
chi-squared statistic measuring the distance between the observed and
expected values of the response (the proportion affected).
Following Litchfield and Wilcoxon (1949, steps B1 and B2),
records with expected effects &lt; 0.01% or &gt; 99.99% are deleted, and
other expected effects are &quot;corrected&quot; using the
<code><a href="#topic+correctval">correctval</a></code> function.
</p>


<h3>Value</h3>

<p>If <code>simple=FALSE</code>, a list of length two.  The first element,
<code>chi</code>, is a numeric vector of length three:
<code>chistat</code>, chi-squared statistic;
<code>df</code>, degrees of freedom; and
<code>pval</code>, P value.
The second element,
<code>contrib</code>, is a matrix of three numeric vectors the same length as
<code>obsn</code>:
<code>exp</code>, expected effects;
<code>obscorr</code>, observed effects corrected; and
<code>contrib</code>, contributions to the chi-squared.
</p>
<p>If <code>simple=TRUE</code>, a numeric scalar, the chi-squared statistic
(see details).
</p>


<h3>References</h3>

<p>Litchfield, JT Jr. and F Wilcoxon.  1949.
A simplified method of evaluating dose-effect experiments.
Journal of Pharmacology and Experimental Therapeutics 96(2):99-113.
<a href="http://jpet.aspetjournals.org/content/96/2/99.abstract">[link]</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+LWchi2">LWchi2</a></code> and <code><a href="stats.html#topic+chisq.test">chisq.test</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>conc &lt;- c(0.0625, 0.125, 0.25, 0.5, 1)
numtested &lt;- rep(8, 5)
nalive &lt;- c(1, 4, 4, 7, 8)
mydat &lt;- dataprep(dose=conc, ntot=numtested, nfx=nalive)
gamfit &lt;- gamtable1()
assessfit(log10(c(0.125, 0.5)), mydat, simple=FALSE)
</code></pre>

<hr>
<h2 id='coefprobit'>Calculate the Coefficients of a Probit Regression Fit</h2><span id='topic+coefprobit'></span>

<h3>Description</h3>

<p>Calculate the coefficients from a fitted probit regression model with
confidence intervals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coefprobit(pfit, alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coefprobit_+3A_pfit">pfit</code></td>
<td>
<p>An object of class <code><a href="stats.html#topic+glm">glm</a></code> representing a probit regression fit
to dose-effect data, typically the result of a call to
<code><a href="#topic+fitprobit">fitprobit</a></code>.  Dose should be the only independent variable
in the model.</p>
</td></tr>
<tr><td><code id="coefprobit_+3A_alpha">alpha</code></td>
<td>
<p>A numeric scalar, the significance level used to generate
100*(1 - <code>alpha</code>)% confidence limits, default 0.05.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of length six, the intercept and slope of the
dose-response curve, each with 100*(1 - <code>alpha</code>)%
confidence limits.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>toxdat &lt;- data.frame(
 dose=c(0.05, 0.0625, 0.125, 0.25, 0.5, 1),
 ntot=rep(8, 6),
  nfx = c(0, 1, 4, 4, 6, 8))
myfit &lt;- fitprobit(toxdat)
coefprobit(myfit)
</code></pre>

<hr>
<h2 id='constrain'>Constrain Data to a Specified Range</h2><span id='topic+constrain'></span>

<h3>Description</h3>

<p>Constrain data to a specified range, assigning values from the specified
range to those outside the range, typically for graphing purposes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>constrain(x, xrange)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="constrain_+3A_x">x</code></td>
<td>
<p>A numeric vector of values to constrain.</p>
</td></tr>
<tr><td><code id="constrain_+3A_xrange">xrange</code></td>
<td>
<p>A numeric vector of length two specifying the constraints, the minimum and
maximum value for <code>x</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector, the same length as <code>x</code>, in which the minimum
constraint is assigned to values of <code>x</code> less than the minimum,
and the maximum constraint is assigned to values of <code>x</code> greater than
the maximum.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>constrain(1:20, c(3, 19))
</code></pre>

<hr>
<h2 id='correctval'>Predict the Corrected Proportional Effect</h2><span id='topic+correctval'></span>

<h3>Description</h3>

<p>Given an expected proportional effect, calculate the &quot;corrected&quot; proportional
effect using a model fit of Litchfield and Wilcoxon's (1949) Table 1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>correctval(val, fit)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="correctval_+3A_val">val</code></td>
<td>
<p>A numeric vector of expected effects (as proportions).</p>
</td></tr>
<tr><td><code id="correctval_+3A_fit">fit</code></td>
<td>
<p>A model object to be used to predict the &quot;corrected&quot; effects
(as proportions) from <code>distexpprop5</code>, the distance between the 
expected effects (as proportions) and 0.5.  Typically the output from
<code><a href="#topic+gamtable1">gamtable1</a>()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of corrected effects (as proportions),
the same length as <code>val</code>.
</p>


<h3>References</h3>

<p>Litchfield, JT Jr. and F Wilcoxon.  1949.
A simplified method of evaluating dose-effect experiments.
Journal of Pharmacology and Experimental Therapeutics 96(2):99-113.
<a href="http://jpet.aspetjournals.org/content/96/2/99.abstract">[link]</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>gamfit &lt;- gamtable1()
correctval(c(0.37, 0.5, 0.63), gamfit)
</code></pre>

<hr>
<h2 id='dataprep'>Prepare Data</h2><span id='topic+dataprep'></span>

<h3>Description</h3>

<p>Prepare dose-effect data for evaluation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dataprep(dose, ntot, nfx)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dataprep_+3A_dose">dose</code></td>
<td>
<p>A numeric vector of unique, chemical concentrations (see Details).</p>
</td></tr>
<tr><td><code id="dataprep_+3A_ntot">ntot</code></td>
<td>
<p>A numeric vector of the number of individuals that were tested at each
dose.</p>
</td></tr>
<tr><td><code id="dataprep_+3A_nfx">nfx</code></td>
<td>
<p>A numeric vector of the number of individuals that were affected at each
dose.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The input data are expected to be summarized by dose.
If duplicate doses are provided, an error will be thrown.
</p>


<h3>Value</h3>

<p>A data frame with eight columns (ordered by dose and proportion affected),
seven numeric vectors and one logical vector:
</p>

<ul>
<li> <p><code>dose</code> = chemical concentrations.
</p>
</li>
<li> <p><code>ntot</code> = the number of individuals that were tested at each
dose.
</p>
</li>
<li> <p><code>nfx</code> = the number of individuals that were affected at each
dose.
</p>
</li>
<li> <p><code>rec</code> = the record number corresponding to the input vectors
<code>dose</code>, <code>ntot</code>, <code>nfx</code>.
</p>
</li>
<li> <p><code>pfx</code> = the proportion of individuals that were affected at
each dose.
</p>
</li>
<li> <p><code>log10dose</code> = log transformed dose, <code>log10(dose)</code>.
</p>
</li>
<li> <p><code>bitpfx</code> = probit transformed proportional affected,
<code><a href="#topic+probit">probit</a>(pfx)</code>.
</p>
</li>
<li> <p><code>fxcateg</code> = effects category: 0 for none affected, 100 for all
affected, and 50 for other proportions affected.
</p>
</li>
<li> <p><code>LWkeep</code> = logical vector identifying records to keep for
Litchfield and Wilcoxon (1949, step A1) method.
</p>
</li></ul>



<h3>References</h3>

<p>Litchfield, JT Jr. and F Wilcoxon.  1949.
A simplified method of evaluating dose-effect experiments.
Journal of Pharmacology and Experimental Therapeutics 96(2):99-113.
<a href="http://jpet.aspetjournals.org/content/96/2/99.abstract">[link]</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>conc &lt;- c(0.0625, 0.125, 0.25, 0.5, 1)
numtested &lt;- rep(8, 5)
nalive &lt;- c(1, 4, 4, 7, 8)
dataprep(dose=conc, ntot=numtested, nfx=nalive)
</code></pre>

<hr>
<h2 id='estimable'>Determine if a Dose-Effect Relation is Estimable</h2><span id='topic+estimable'></span>

<h3>Description</h3>

<p>Determine if a dose-effect relation is estimable based on available data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimable(DEdata)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="estimable_+3A_dedata">DEdata</code></td>
<td>
<p>A data frame of dose-effect data (typically, the output from
<code><a href="#topic+dataprep">dataprep</a></code>) containing at least two variables: dose,
a numeric vector of chemical concentrations, and pfx,
a numeric vector of proportional effects at each dose (see Details).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A dose-effect relation is defined to be estimable if and only if there are
at least two test records and there is some (non-zero) variability in
both the doses and the proportional effects.
The input data are expected to be summarized by dose.
If duplicate doses are provided, an error will be thrown.
</p>


<h3>Value</h3>

<p>A logical scalar indicating if a dose-effect relation is estimable.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>conc &lt;- c(0.0625, 0.125, 0.25, 0.5, 1)
numtested &lt;- rep(8, 5)
nalive &lt;- c(1, 4, 4, 7, 8)
mydat &lt;- dataprep(dose=conc, ntot=numtested, nfx=nalive)
estimable(mydat)
nalive2 &lt;- rep(4, 5)
mydat2 &lt;- dataprep(dose=conc, ntot=numtested, nfx=nalive2)
estimable(mydat2)
</code></pre>

<hr>
<h2 id='fill'>Fill in Missing Values</h2><span id='topic+fill'></span>

<h3>Description</h3>

<p>Fill in missing values in a vector, using the last recorded value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fill(x, resetWhen = rep(FALSE, length(x)))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fill_+3A_x">x</code></td>
<td>
<p>A vector, can be character, numeric, or logical.</p>
</td></tr>
<tr><td><code id="fill_+3A_resetwhen">resetWhen</code></td>
<td>
<p>A logical vector, the same length as <code>x</code>, indicating elements that
should not be filled in.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Similar to <code><a href="zoo.html#topic+na.locf">na.locf</a></code> in the <code>zoo</code> package,
but works for &quot;&quot; in character vectors as well.
</p>


<h3>Value</h3>

<p>A vector the same length as <code>x</code>, with all NAs or &quot;&quot;s replaced by
the last value for the vector.
Note that and missing values at the beginning of the vector will not
be replaced.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>numvec &lt;- c(NA, 1:5, NA, NA, NA, 10:12, NA)
newgroup &lt;- c(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0)
fill(numvec)
fill(numvec, newgroup)

charvec &lt;- c("", letters[1:5], "", "", "", letters[10:12], "")
fill(charvec)
</code></pre>

<hr>
<h2 id='fitHand'>Best Fit Using Estimated Expected Effects</h2><span id='topic+fitHand'></span>

<h3>Description</h3>

<p>Use simple linear regression to describe
a hand draw line fit to a dose-effect experiment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitHand(handDose, handPct)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitHand_+3A_handdose">handDose</code></td>
<td>
<p>A numeric vector of doses for which expected effects are estimated from
a hand drawn line, must have at least two unique values.</p>
</td></tr>
<tr><td><code id="fitHand_+3A_handpct">handPct</code></td>
<td>
<p>A numeric vector of the expected percent affected corresponding to (and
the same length as) <code>handDose</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of length two, the estimated intercept and slope of the
dose-response curve on the log10-probit scale,
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d &lt;- c(0.0625, 0.125, 0.25, 0.5, 1)
p &lt;- c(9.5, 34, 67, 90.5, 98.6)
fitHand(handDose=d, handPct=p)
</code></pre>

<hr>
<h2 id='fitlinear'>Determine Linear Regression Coefficients from Dose-Effect Data</h2><span id='topic+fitlinear'></span>

<h3>Description</h3>

<p>Determine coefficients (intercept and slope) from dose-effect data using
simple linear regression on the log10 dose vs. probit effect scale.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitlinear(DEdata, constr = c(5e-04, 0.9995))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitlinear_+3A_dedata">DEdata</code></td>
<td>
<p>A data frame of dose-effect data (typically, the output from
<code><a href="#topic+dataprep">dataprep</a></code>) containing at least three variables:
log10dose, bitpfx, and LWkeep.</p>
</td></tr>
<tr><td><code id="fitlinear_+3A_constr">constr</code></td>
<td>
<p>A numeric vector of length two, indicating the constraints
(see <code><a href="#topic+constrain">constrain</a></code>) applied to the proportional effects,
default c(0.0005, 0.9995).  These numbers are used, rather than
c(0.001, 0.999), as a way to ensure that effects that would be rounded
(up to 0.1% or down to 99.9%) are still included in true
Litchfield and Wilcoxon (1949) fashion.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of length two, the estimated intercept and slope.
</p>


<h3>References</h3>

<p>Litchfield, JT Jr. and F Wilcoxon.  1949.
A simplified method of evaluating dose-effect experiments.
Journal of Pharmacology and Experimental Therapeutics 96(2):99-113.
<a href="http://jpet.aspetjournals.org/content/96/2/99.abstract">[link]</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>conc &lt;- c(0.0625, 0.125, 0.25, 0.5, 1)
numtested &lt;- rep(8, 5)
nalive &lt;- c(1, 4, 4, 7, 8)
mydat &lt;- dataprep(dose=conc, ntot=numtested, nfx=nalive)
fitlinear(mydat)
</code></pre>

<hr>
<h2 id='fitLWauto'>Best Fit Using Litchfield and Wilcoxon Evaluation of Dose-Effect Experiments</h2><span id='topic+fitLWauto'></span>

<h3>Description</h3>

<p>Use optimization to describe the best fitting line to a dose-effect experiment
following the methods of Litchfield and Wilcoxon (1949).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitLWauto(DEdata)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitLWauto_+3A_dedata">DEdata</code></td>
<td>
<p>A data frame of dose-effect data (typically, the output from
<code><a href="#topic+dataprep">dataprep</a></code>) containing at least eight variables:
dose, ntot, nfx, pfx, log10dose, bitpfx, fxcateg, and LWkeep
(see Details).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The input data are expected to be summarized by dose.
If duplicate doses are provided, an error will be thrown.
</p>


<h3>Value</h3>

<p>A numeric vector of length two, the estimated intercept and slope of the
dose-response curve on the log10-probit scale,
</p>


<h3>References</h3>

<p>Litchfield, JT Jr. and F Wilcoxon.  1949.
A simplified method of evaluating dose-effect experiments.
Journal of Pharmacology and Experimental Therapeutics 96(2):99-113.
<a href="http://jpet.aspetjournals.org/content/96/2/99.abstract">[link]</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dose &lt;- c(0.0625, 0.125, 0.25, 0.5, 1)
ntested &lt;- rep(8, 5)
nalive &lt;- c(1, 4, 4, 7, 8)
mydat &lt;- dataprep(dose=dose, ntot=ntested, nfx=nalive)
mydat
fitLWauto(mydat)
</code></pre>

<hr>
<h2 id='fitprobit'>Fit a Probit Regression to Dose-Effect Data</h2><span id='topic+fitprobit'></span>

<h3>Description</h3>

<p>Fit a probit regression to dose-effect data, using the log10 of the dose as
the response.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitprobit(dat)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitprobit_+3A_dat">dat</code></td>
<td>
<p>A data frame of toxicity data, including at least three variables:
dose (the concentration of the tested chemical),
ntot (the number of individuals tested), and
nfx (the number of affected individuals).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Only those rows with <code>dose &gt; 0</code>, <code>ntot &gt; 0</code>, and <code>nfx &gt;= 0</code>
are used in fitting the model.
</p>


<h3>Value</h3>

<p>A an object of class <code><a href="stats.html#topic+glm">glm</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>toxdat &lt;- data.frame(
 dose=c(0.05, 0.0625, 0.125, 0.25, 0.5, 1),
  ntot=rep(8, 6),
  nfx = c(0, 1, 4, 4, 6, 8))
fitprobit(toxdat)
</code></pre>

<hr>
<h2 id='fxcat'>Define Effect Category</h2><span id='topic+fxcat'></span>

<h3>Description</h3>

<p>Define three effect categories, 0 for none affected, 100 for all affected,
and 50 for other proportions affected.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fxcat(dat)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fxcat_+3A_dat">dat</code></td>
<td>
<p>A data frame of toxicity data, including at least two variables:
ntot (the number of individuals tested) and
nfx (the number of affected individuals).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An integer vector the same length as <code>prob</code> with
categories of 0, 50, or 100.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>toxdat &lt;- data.frame(
  dose=c(0.0625, 0.125, 0.25, 0.5),
  ntot=rep(8, 4),
  nfx = c(0, 4, 6, 8))
cbind(toxdat, fxcat(toxdat))
</code></pre>

<hr>
<h2 id='gamtable1'>Fit a smooth GAM to Table 1 of Litchfield and Wilcoxon (1949)</h2><span id='topic+gamtable1'></span>

<h3>Description</h3>

<p>Fit a smooth GAM function to replace looking up values in Table 1 of
Litchfield and Wilcoxon (1949).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gamtable1()
</code></pre>


<h3>Details</h3>

<p>Note that for an expected value of 37 Table 1 gives a corrected value of
9.4, but for an expected value of 63 it gives a corrected value of 90.5.
To ensure that both values add to 100, I used corrected values of 9.45
and 90.55. The expected and corrected values from Table 1 are then used
to build a GAM model, which is used as input to the
<code><a href="#topic+correctval">correctval</a></code> function.
</p>


<h3>Value</h3>

<p>A <code><a href="mgcv.html#topic+gamObject">gamObject</a></code> that can be used to predict the corrected values
(as proportions) from <code>distexpprop5</code>,
the distance between the expected values (as proportions) and 0.5
</p>


<h3>References</h3>

<p>Litchfield, JT Jr. and F Wilcoxon.  1949.
A simplified method of evaluating dose-effect experiments.
Journal of Pharmacology and Experimental Therapeutics 96(2):99-113.
<a href="http://jpet.aspetjournals.org/content/96/2/99.abstract">[link]</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fit &lt;- gamtable1()
summary(fit)
plot(fit)
</code></pre>

<hr>
<h2 id='invprobit'>Convert Probit Scale to Proportions</h2><span id='topic+invprobit'></span>

<h3>Description</h3>

<p>Convert values on the probit scale to their proportions on the 0 to 1 scale.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>invprobit(quan)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="invprobit_+3A_quan">quan</code></td>
<td>
<p>A numeric vector of probit quantiles.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Simply calls <code><a href="stats.html#topic+pnorm">pnorm</a>(quan)</code>.
</p>


<h3>Value</h3>

<p>A numeric vector of proportions the same length as <code>quan</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>invprobit(c(-3, -1, 0, 1, 3))
</code></pre>

<hr>
<h2 id='keeponly'>Eliminate Consecutive Extreme Values</h2><span id='topic+keeponly'></span>

<h3>Description</h3>

<p>Generate the index for eliminating values beyond a given maximum number of
consecutive extremes allowed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>keeponly(x, extremes = c(0, 100), nconsec = 2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="keeponly_+3A_x">x</code></td>
<td>
<p>A numeric vector, with no missing values.</p>
</td></tr>
<tr><td><code id="keeponly_+3A_extremes">extremes</code></td>
<td>
<p>A numeric vector of length two giving the boundary limits for <code>x</code>,
default c(0, 100).</p>
</td></tr>
<tr><td><code id="keeponly_+3A_nconsec">nconsec</code></td>
<td>
<p>An integer scalar, the maximum number of consecutive extreme values
allowed, default 2.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A logical vector for selecting all elements of <code>x</code> without
exceeding <code>nconsec</code> consecutive extreme values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>vec &lt;- c(0, 0, 0, 4, 4, 4, 100, 100, 100, 100)
vec[keeponly(vec)]
# the original vector need not be ordered
vec &lt;- c(100, 4, 100, 4, 0, 100, 0, 4, 0, 100)
keeponly(vec)
</code></pre>

<hr>
<h2 id='LWchi2'>Chi-Squared Statistic</h2><span id='topic+LWchi2'></span>

<h3>Description</h3>

<p>Calculate the chi-squared statistic from observed and expected counts
using the Litchfield and Wilcoxon (1949) approach.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LWchi2(obsn, expn, totn)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LWchi2_+3A_obsn">obsn</code></td>
<td>
<p>A numeric vector of observed counts.</p>
</td></tr>
<tr><td><code id="LWchi2_+3A_expn">expn</code></td>
<td>
<p>A numeric vector of expected counts, the same length as <code>obsn</code>.</p>
</td></tr>
<tr><td><code id="LWchi2_+3A_totn">totn</code></td>
<td>
<p>A numeric vector of total counts possible, the same length as <code>obsn</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The denominator of Litchfield and Wilcoxon's (1949) chi-squared estimate
is the minimum of the <code>expn</code> and (<code>totn</code> - <code>expn</code>)
following their Nomograph No. 1.  This ensures that the same chi-squared
value is calculated regardless of which proportion is reported (e.g.,
affected vs. not affected).
</p>


<h3>Value</h3>

<p>A list of length two.
The first element is a numeric vector of length three:
<code>chistat</code>, chi-squared statistic;
<code>df</code>, degrees of freedom; and
<code>pval</code>, P value.
The second element is a numeric vector the same length as <code>obsn</code>,
containing <strong>total</strong> contributions to the chi-squared.  To get the
<strong>individual</strong> contributions to the chi-squared as reported in
Litchfield and Wilcoxon (1949), divide by <code>totn</code>.
</p>


<h3>References</h3>

<p>Litchfield, JT Jr. and F Wilcoxon.  1949.
A simplified method of evaluating dose-effect experiments.
Journal of Pharmacology and Experimental Therapeutics 96(2):99-113.
<a href="http://jpet.aspetjournals.org/content/96/2/99.abstract">[link]</a>.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+chisq.test">chisq.test</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>LWchi2(c(10, 8, 3), c(7, 7, 7), c(12, 12, 12))
</code></pre>

<hr>
<h2 id='LWestimate'>Generate Litchfield and Wilcoxon Estimates</h2><span id='topic+LWestimate'></span>

<h3>Description</h3>

<p>Generate Litchfield and Wilcoxon's (1949) estimates in the evaluation of
dose-effect experiments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LWestimate(estParams, DEdata)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LWestimate_+3A_estparams">estParams</code></td>
<td>
<p>A numeric vector of length 2, the estimated parameters (intercept and
slope) of a straight line on the log10-probit scale, typically output
from <code><a href="#topic+fitLWauto">fitLWauto</a></code>.</p>
</td></tr>
<tr><td><code id="LWestimate_+3A_dedata">DEdata</code></td>
<td>
<p>A data frame of dose-effect data (typically, the output from
<code><a href="#topic+dataprep">dataprep</a></code>) containing at least eight variables:
dose, ntot, nfx, pfx, log10dose, bitpfx, fxcateg, and LWkeep
(see Details).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The input data are expected to be summarized by dose.
If duplicate doses are provided, an error will be thrown.
</p>


<h3>Value</h3>

<p>A list of length three:
</p>

<ul>
<li> <p><code>chi</code> = the chi-squared statistic with associated P value and
degrees of freedom,
</p>
</li>
<li> <p><code>params</code> = the estimated intercept and slope of the
dose-response curve on the log10 probit scale,
</p>
</li>
<li> <p><code>LWest</code> = the Litchfield Wilcoxon estimates of
ED50 with 95% confidence intervals and the number of records with
partial effects (npartfx) as well as other metrics used in their
step-by-step approach
(ED16, ED84, S with 95% confidence intervals, N', and fED50).
</p>
</li></ul>



<h3>References</h3>

<p>Litchfield, JT Jr. and F Wilcoxon.  1949.
A simplified method of evaluating dose-effect experiments.
Journal of Pharmacology and Experimental Therapeutics 96(2):99-113.
<a href="http://jpet.aspetjournals.org/content/96/2/99.abstract">[link]</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dose &lt;- c(0.0625, 0.125, 0.25, 0.5, 1)
ntested &lt;- rep(8, 5)
nalive &lt;- c(1, 4, 4, 7, 8)
mydat &lt;- dataprep(dose=dose, ntot=ntested, nfx=nalive)
mydat
intslope &lt;- fitLWauto(mydat)
LWestimate(intslope, mydat)
</code></pre>

<hr>
<h2 id='LWnomo1'>Recreate Litchfield and Wilcoxon's Nomograph No. 1</h2><span id='topic+LWnomo1'></span>

<h3>Description</h3>

<p>Recreate Litchfield and Wilcoxon's (1949) nomograph to estimate the
contribution to the chi-squared from the expected percent effect and
the observed  minus the expected percent effect.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LWnomo1(values = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LWnomo1_+3A_values">values</code></td>
<td>
<p>A logical scalar indicating whether values should be output.</p>
</td></tr>
<tr><td><code id="LWnomo1_+3A_...">...</code></td>
<td>
<p>Additional parameters to <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Use the nomograph by laying a straight edge from the expected percent effect
in the first scale to the observed (corrected, if necessary) minus the
expected percent effect in the second scale and reading the point where the
straight edge crosses the third scale as the contribution.
</p>
<p>The formula behind the nomograph is
(observed - expected)^2 / (100 * expected)
</p>


<h3>Value</h3>

<p>If <code>values</code> is TRUE, a list of length four, with the x and y
coordinates and the corresponding values (all displayed in the log10
scale) of the end points of the three scales.  Information is provided
twice for the first scale, once for the left tick marks and once for the
right tick marks.
</p>


<h3>References</h3>

<p>Litchfield, JT Jr. and F Wilcoxon.  1949.
A simplified method of evaluating dose-effect experiments.
Journal of Pharmacology and Experimental Therapeutics 96(2):99-113.
<a href="http://jpet.aspetjournals.org/content/96/2/99.abstract">[link]</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>LWnomo1()
</code></pre>

<hr>
<h2 id='LWP'>User Friendly Evaluation of Dose-Effect Experiments using Litchfield-Wilcoxon
and Probit Methods</h2><span id='topic+LWP'></span>

<h3>Description</h3>

<p>User friendly evaluation of dose-effect experiments using automated
Litchfield Wilcoxon (1949) and probit estimation methods.
This function has been tailored for non-R users with input data set up in a
particular way (see Details).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LWP(rawfile = NULL, descrcolz = 1:4, saveplots = TRUE,
  showplots = FALSE, saveresults = TRUE, showresults = TRUE,
  returnresults = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LWP_+3A_rawfile">rawfile</code></td>
<td>
<p>A character scalar specifying the path of the input data as a csv file.
If NULL, default, the user will be prompted to browse to a file using a
menu.</p>
</td></tr>
<tr><td><code id="LWP_+3A_descrcolz">descrcolz</code></td>
<td>
<p>A numeric vector, the column numbers to use as the description of the
test, default 1:4.</p>
</td></tr>
<tr><td><code id="LWP_+3A_saveplots">saveplots</code></td>
<td>
<p>A logical scalar indicating if plots should be saved to a pdf file,
default TRUE.  See details.</p>
</td></tr>
<tr><td><code id="LWP_+3A_showplots">showplots</code></td>
<td>
<p>A logical scalar indicating if plots should be shown on screen,
default FALSE.  See details.</p>
</td></tr>
<tr><td><code id="LWP_+3A_saveresults">saveresults</code></td>
<td>
<p>A logical scalar indicating if results should be saved to a csv file,
default TRUE.
The csv file is given the same name (plus the suffix &quot;Smry&quot;) and is
placed in the same directory as the input file.</p>
</td></tr>
<tr><td><code id="LWP_+3A_showresults">showresults</code></td>
<td>
<p>A logical scalar indicating if results should be printed to the console,
default TRUE.
These results include the chi-squared statistic, degrees of freedom, and
p-value for the Litchfield Wilcoxon method.</p>
</td></tr>
<tr><td><code id="LWP_+3A_returnresults">returnresults</code></td>
<td>
<p>A logical scalar indicating if results should be returned by the function,
default FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The input data must include at least these seven columns,
with these names in the header row:
</p>

<ul>
<li> <p><code>Test ID</code> = A character or numeric vector,
the unique identifier for each test
</p>
</li>
<li> <p><code>Source</code> = A character vector, the source of the chemical
</p>
</li>
<li> <p><code>Batch</code> = A character or numeric vector, the batch of the
chemical
</p>
</li>
<li> <p><code>Species</code> = A character vector, the species tested
</p>
</li>
<li> <p><code>TFM Conc. (mg/L)</code> = A numeric vector, the concentration of
TFM in mg/L
</p>
</li>
<li> <p><code>No. Tested</code> = A numeric vector, the number of animals tested
</p>
</li>
<li> <p><code>No. Dead</code> = A numeric vector, the number of animals dead
</p>
</li></ul>

<p>The input data are expected to be summarized by dose.
If duplicate doses are provided, an error will be thrown.
</p>
<p>Both <code>saveplots</code> and <code>showplots</code> may be set to FALSE, in which
case no plots will be produced.  But both may not be set to TRUE.
</p>


<h3>Value</h3>

<p>If <code>returnresults=TRUE</code>, a data frame with 11 rows per test and
2 more columns than the input data. Three columns from the input data are
not included (<code>TFM Conc. (mg/L)</code>, <code>No. Tested</code>, and
<code>No. Dead</code>). Five columns are added: the parameter (<code>param</code>),
the method used (<code>method</code>), the estimate (<code>estimate</code>), and the
95% confidence interval of the estimate (<code>lower95ci</code> and
<code>upper95ci</code>)
</p>


<h3>References</h3>

<p>Litchfield, JT Jr. and F Wilcoxon.  1949.
A simplified method of evaluating dose-effect experiments.
Journal of Pharmacology and Experimental Therapeutics 96(2):99-113.
<a href="http://jpet.aspetjournals.org/content/96/2/99.abstract">[link]</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
LWP()

## End(Not run)
</code></pre>

<hr>
<h2 id='nomoCoord'>Find the Coordinate from the Scale of a Nomograph</h2><span id='topic+nomoCoord'></span>

<h3>Description</h3>

<p>Find the x and y coordinate corresponding to a specified point on a
nomograph scale.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nomoCoord(df, val)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nomoCoord_+3A_df">df</code></td>
<td>
<p>A data frame with three columns, the <code>x</code> and <code>y</code> coordinates
of the nomograph scale and the corresponding values.</p>
</td></tr>
<tr><td><code id="nomoCoord_+3A_val">val</code></td>
<td>
<p>A numeric scalar identifying the point on the scale for which the
coordinates will be returned.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function makes it easier to add points or lines to a nomograph for
illustrative purposes.
</p>
<p>Each scale is assumed to be displayed on the log10 scale.
</p>


<h3>Value</h3>

<p>A numeric vector of length two with the x and y coordinates of the
specified point in plotting units of the nomograph.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>scales &lt;- LWnomo1(TRUE)
fromxy &lt;- nomoCoord(scales$scale1r, 34)
toxy &lt;- nomoCoord(scales$scale3, 16^2/(100*34))
segments(fromxy[1], fromxy[2], toxy[1], toxy[2], col="red")

</code></pre>

<hr>
<h2 id='plotDE'>Plot Dose-Effect Experiments</h2><span id='topic+plotDE'></span>

<h3>Description</h3>

<p>Plot dose-effect experiments on the arithmetic scale.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotDE(DEdata, xlab = "Dose", ylab = "Affected  (%)",
  xlim = range(DEdata$dose, na.rm = TRUE), ylim = c(0, 100), ref = c(0,
  50, 100), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotDE_+3A_dedata">DEdata</code></td>
<td>
<p>A data frame of dose-effect data (typically, the output from
<code><a href="#topic+dataprep">dataprep</a></code>) containing at least five variables:
dose, pfx, log10dose, bitpfx, fxcateg.</p>
</td></tr>
<tr><td><code id="plotDE_+3A_xlab">xlab</code></td>
<td>
<p>A character scalar, the title for the dose (x) axis, default &quot;Dose&quot;.</p>
</td></tr>
<tr><td><code id="plotDE_+3A_ylab">ylab</code></td>
<td>
<p>A character scalar, the title for the affected (y) axis,
default &quot;Affected  (%)&quot;.</p>
</td></tr>
<tr><td><code id="plotDE_+3A_xlim">xlim</code></td>
<td>
<p>A numeric vector of length two giving the x coordinate range for
dose, default range(DEdata$dose, na.rm=TRUE).</p>
</td></tr>
<tr><td><code id="plotDE_+3A_ylim">ylim</code></td>
<td>
<p>A numeric vector of length two giving the y coordinate range for
affected (%), default c(0.1, 99.9).
Observed effects beyond this range will be plotted at the limits of this
range using an open symbol.</p>
</td></tr>
<tr><td><code id="plotDE_+3A_ref">ref</code></td>
<td>
<p>A numeric vector specifying horizontal reference lines to be added
to the plot, default c(0, 50, 100).</p>
</td></tr>
<tr><td><code id="plotDE_+3A_...">...</code></td>
<td>
<p>Additional arguments to <code><a href="base.html#topic+plot">plot</a></code>.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+predLines">predLines</a></code>, <code><a href="#topic+plotDELP">plotDELP</a></code>, <code><a href="#topic+predLinesLP">predLinesLP</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dose &lt;- c(0.0625, 0.125, 0.25, 0.5, 1)
ntested &lt;- rep(8, 5)
nalive &lt;- c(1, 4, 4, 7, 8)
mydat &lt;- dataprep(dose=dose, ntot=ntested, nfx=nalive)
plotDE(mydat)
</code></pre>

<hr>
<h2 id='plotDELP'>Plot Dose-Effect Experiments</h2><span id='topic+plotDELP'></span>

<h3>Description</h3>

<p>Plot dose-effect experiments on the log10-probit scale.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotDELP(DEdata, xlab = "Dose", ylab = "Affected  (%)",
  xlim = range(DEdata$dose[DEdata$dose &gt; 0], na.rm = TRUE), ylim = c(0.1,
  99.9), grid = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotDELP_+3A_dedata">DEdata</code></td>
<td>
<p>A data frame of dose-effect data (typically, the output from
<code><a href="#topic+dataprep">dataprep</a></code>) containing at least five variables:
dose, pfx, log10dose, bitpfx, fxcateg.</p>
</td></tr>
<tr><td><code id="plotDELP_+3A_xlab">xlab</code></td>
<td>
<p>A character scalar, the title for the dose (x) axis, default &quot;Dose&quot;.</p>
</td></tr>
<tr><td><code id="plotDELP_+3A_ylab">ylab</code></td>
<td>
<p>A character scalar, the title for the affected (y) axis,
default &quot;Affected  (%)&quot;.</p>
</td></tr>
<tr><td><code id="plotDELP_+3A_xlim">xlim</code></td>
<td>
<p>A numeric vector of length two giving the x coordinate range for
dose, default range(DEdata$dose, na.rm=TRUE).</p>
</td></tr>
<tr><td><code id="plotDELP_+3A_ylim">ylim</code></td>
<td>
<p>A numeric vector of length two giving the y coordinate range for
affected (%), default c(0.1, 99.9).
Observed effects beyond this range will be plotted at the limits of this
range using an open symbol.</p>
</td></tr>
<tr><td><code id="plotDELP_+3A_grid">grid</code></td>
<td>
<p>A logical scalar indicating if a background grid should be plotted,
default TRUE.</p>
</td></tr>
<tr><td><code id="plotDELP_+3A_...">...</code></td>
<td>
<p>Additional arguments to <code><a href="base.html#topic+plot">plot</a></code>.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+predLinesLP">predLinesLP</a></code>, <code><a href="#topic+plotDE">plotDE</a></code>, <code><a href="#topic+predLines">predLines</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dose &lt;- c(0.0625, 0.125, 0.25, 0.5, 1)
ntested &lt;- rep(8, 5)
nalive &lt;- c(1, 4, 4, 7, 8)
mydat &lt;- dataprep(dose=dose, ntot=ntested, nfx=nalive)
plotDELP(mydat)
</code></pre>

<hr>
<h2 id='predlinear'>Determine the Effective Dose from a Linear Regression Fit</h2><span id='topic+predlinear'></span>

<h3>Description</h3>

<p>Determine the effective dose for a specified percent effect from the
intercept and slope of a linear regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predlinear(pct, LWmod, simple = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predlinear_+3A_pct">pct</code></td>
<td>
<p>A numeric vector of effects (in percents) for which to estimate the
effective dose(s).</p>
</td></tr>
<tr><td><code id="predlinear_+3A_lwmod">LWmod</code></td>
<td>
<p>If <code>simple=TRUE</code>, a numeric vector of length two giving the intercept
and slope of the linear relation between the dose (x, the concentration
of the applied chemical on the log10 scale), and the proportion of
affected individuals (y, on the probit scale, with 0s converted to
0.1% and 1s converted to 99.9%).
If <code>simple=FALSE</code>, a list with the results of fitting a Litchfield and
Wilcoxon model to dose-effect data,
the output from <code><a href="#topic+LWestimate">LWestimate</a></code>.</p>
</td></tr>
<tr><td><code id="predlinear_+3A_simple">simple</code></td>
<td>
<p>A logical scalar indicating whether to carry out a simple estimation of
effective doses from the intercept and slope (TRUE),
or an estimation of effective doses with confidence intervals from the
Litchfield and Wilcoxon model (default, FALSE).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Follows methods outlined in Litchfield and Wilcoxon (1949).
Specifically, for the 95% confidence intervals, see page 105, and
equation 13 in the Appendix (corresponding to Nomograph 4).
</p>


<h3>Value</h3>

<p>If <code>simple=TRUE</code>, a numeric vector the same length as <code>pct</code> with
the estimated effective doses.
If <code>simple=FALSE</code>, an n*4 numeric matrix with the given effects
(<code>pct</code>), the effective doses (<code>ED</code>), and Litchfield and
Wilcoxon's (1949) 95% confidence intervals for the effective doses
(<code>lower</code> and <code>upper</code>).
The number of rows of the matrix, n, is the length of <code>pct</code>.
</p>


<h3>References</h3>

<p>Litchfield, JT Jr. and F Wilcoxon.  1949.
A simplified method of evaluating dose-effect experiments.
Journal of Pharmacology and Experimental Therapeutics 96(2):99-113.
<a href="http://jpet.aspetjournals.org/content/96/2/99.abstract">[link]</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
predlinear(c(16, 50, 84, 99.9), c(1.700875, 2.199559), simple=TRUE)

dose &lt;- c(0.0625, 0.125, 0.25, 0.5, 1)
ntested &lt;- rep(8, 5)
nalive &lt;- c(1, 4, 4, 7, 8)
mydat &lt;- dataprep(dose=dose, ntot=ntested, nfx=nalive)
fLW &lt;- LWestimate(fitLWauto(mydat), mydat)
predlinear(c(25, 50, 99.9), fLW)
</code></pre>

<hr>
<h2 id='predLines'>Add Litchfield and Wilcoxon Predictions to a Plot</h2><span id='topic+predLines'></span>

<h3>Description</h3>

<p>Add predictions from a Litchfield and Wilcoxon model fit to
a plot of the results of a dose-effect experiment on the arithmetic scale.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predLines(fit, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predLines_+3A_fit">fit</code></td>
<td>
<p>A list of length three containing the result of a Litchfield and
Wilcoxon model fit, typically the output from <code><a href="#topic+LWestimate">LWestimate</a></code>.</p>
</td></tr>
<tr><td><code id="predLines_+3A_...">...</code></td>
<td>
<p>Additional arguments to <code><a href="graphics.html#topic+lines">lines</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A solid fitted line is added to the plot.  Dashed lines are added to the
plot representing the <strong>horizontal</strong> 95% confidence intervals
for the predicted dose to elicit a given percent affected.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plotDE">plotDE</a></code>, <code><a href="#topic+plotDELP">plotDELP</a></code>, <code><a href="#topic+predLinesLP">predLinesLP</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dose &lt;- c(0.0625, 0.125, 0.25, 0.5, 1)
ntested &lt;- rep(8, 5)
nalive &lt;- c(1, 4, 4, 7, 8)
mydat &lt;- dataprep(dose=dose, ntot=ntested, nfx=nalive)
plotDE(mydat)
myfit &lt;- LWestimate(fitLWauto(mydat), mydat)
predLines(myfit)
</code></pre>

<hr>
<h2 id='predLinesLP'>Add Litchfield and Wilcoxon Predictions to a Plot</h2><span id='topic+predLinesLP'></span>

<h3>Description</h3>

<p>Add predictions from a Litchfield and Wilcoxon model fit to
a plot of the results of a dose-effect experiment on the log10-probit scale.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predLinesLP(fit, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predLinesLP_+3A_fit">fit</code></td>
<td>
<p>A list of length three containing the result of a Litchfield and
Wilcoxon model fit, typically the output from <code><a href="#topic+LWestimate">LWestimate</a></code>.</p>
</td></tr>
<tr><td><code id="predLinesLP_+3A_...">...</code></td>
<td>
<p>Additional arguments to <code><a href="graphics.html#topic+abline">abline</a></code> and <code><a href="graphics.html#topic+lines">lines</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A solid fitted line is added to the plot.  Dashed lines are added to the
plot representing the <strong>horizontal</strong> 95% confidence intervals
for the predicted dose to elicit a given percent affected.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plotDELP">plotDELP</a></code>, <code><a href="#topic+plotDE">plotDE</a></code>, <code><a href="#topic+predLines">predLines</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dose &lt;- c(0.0625, 0.125, 0.25, 0.5, 1)
ntested &lt;- rep(8, 5)
nalive &lt;- c(1, 4, 4, 7, 8)
mydat &lt;- dataprep(dose=dose, ntot=ntested, nfx=nalive)
plotDELP(mydat)
myfit &lt;- LWestimate(fitLWauto(mydat), mydat)
predLinesLP(myfit)
</code></pre>

<hr>
<h2 id='predprobit'>Determine the Effective Dose from a Probit Regression Fit</h2><span id='topic+predprobit'></span>

<h3>Description</h3>

<p>Determine the effective dose for a specified percent effect from a fitted
probit regression model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predprobit(pct, pfit, alpha = 0.05, logbase = 10)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predprobit_+3A_pct">pct</code></td>
<td>
<p>A numeric scalar of the effect (as a percent) for which to estimate the
effective dose.</p>
</td></tr>
<tr><td><code id="predprobit_+3A_pfit">pfit</code></td>
<td>
<p>An object of class <code><a href="stats.html#topic+glm">glm</a></code> representing a probit regression fit
to dose-effect data, typically the result of a call to
<code><a href="#topic+fitprobit">fitprobit</a></code>.</p>
</td></tr>
<tr><td><code id="predprobit_+3A_alpha">alpha</code></td>
<td>
<p>A numeric scalar, the significance level used to generate
100*(1 - <code>alpha</code>)% confidence limits, default 0.05.</p>
</td></tr>
<tr><td><code id="predprobit_+3A_logbase">logbase</code></td>
<td>
<p>A numeric or logical scalar, the base of the log transformation used for
dose in <code>pfit</code>, default 10.  Use logbase=FALSE, if the dose was not
log transformed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of length three, the effective dose and the lower and
upper 100*(1 - <code>alpha</code>)% confidence limits.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>toxdat &lt;- data.frame(
 dose=c(0.05, 0.0625, 0.125, 0.25, 0.5, 1),
 ntot=rep(8, 6),
 nfx = c(0, 1, 4, 4, 6, 8))
myfit &lt;- fitprobit(toxdat)
predprobit(50, myfit)
</code></pre>

<hr>
<h2 id='prettylog'>Pretty Breakpoints on Log Scale</h2><span id='topic+prettylog'></span>

<h3>Description</h3>

<p>Compute a sequence of &quot;round&quot; values which cover the range of <code>x</code> on
the log scale.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prettylog(x, lead = c(1, 5), extra = 5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="prettylog_+3A_x">x</code></td>
<td>
<p>A numeric vector.</p>
</td></tr>
<tr><td><code id="prettylog_+3A_lead">lead</code></td>
<td>
<p>An integer vector giving the desired lead digits of pretty values on
the log scale, default c(1, 5).</p>
</td></tr>
<tr><td><code id="prettylog_+3A_extra">extra</code></td>
<td>
<p>An integer scalar giving the desired number of additional
non-log scale values to include, default 5.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of pretty values covering the range of <code>x</code> on
the log scale.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>vals &lt;- rlnorm(100, 6)
summary(vals)
prettylog(vals, 1, 0)
prettylog(vals, 1)
prettylog(vals, c(1, 2, 5))
</code></pre>

<hr>
<h2 id='probit'>Convert Proportions to the Probit Scale</h2><span id='topic+probit'></span>

<h3>Description</h3>

<p>Convert proportions to the probit scale.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>probit(prob)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="probit_+3A_prob">prob</code></td>
<td>
<p>A numeric vector of proportions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Simply calls <code><a href="stats.html#topic+qnorm">qnorm</a>(prob)</code>.
</p>


<h3>Value</h3>

<p>A numeric vector the same length as <code>prob</code> with quantiles on
the probit scale.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>probit(c(0.001, 0.01, 0.1, 0.5, 0.9, 0.99, 0.999))
</code></pre>

<hr>
<h2 id='relPotency'>Relative Potency of Two Toxins</h2><span id='topic+relPotency'></span>

<h3>Description</h3>

<p>Estimate of relative potency of two toxins using Litchfield and
Wilcoxon's (1949) approach to evaluating dose-effect experiments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>relPotency(ED50nS1, ED50nS2, vec = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="relPotency_+3A_ed50ns1">ED50nS1</code></td>
<td>
<p>Either the list output from <code><a href="#topic+LWestimate">LWestimate</a></code> (<code>vec = FALSE</code>) 
or a numeric vector of length four (<code>vec = TRUE</code>) with the estimated
ED50, fED50, S, and fS from a Litchfield and Wilcoxon fit to dose-effect
data for the first toxin.</p>
</td></tr>
<tr><td><code id="relPotency_+3A_ed50ns2">ED50nS2</code></td>
<td>
<p>Either the list output from <code><a href="#topic+LWestimate">LWestimate</a></code> (<code>vec = FALSE</code>) 
or a numeric vector of length four (<code>vec = TRUE</code>) with the estimated
ED50, fED50, S, and fS from a Litchfield and Wilcoxon fit to dose-effect
data for the second toxin.</p>
</td></tr>
<tr><td><code id="relPotency_+3A_vec">vec</code></td>
<td>
<p>A logical scalar indicating whether the inputs <code>ED50nS1</code> and
<code>ED50nS2</code> are both numeric vectors (TRUE) or
both lists (FALSE, the default).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The ratios reported (both for slope and potency) have
the first toxin in the numerator and the second toxin in the denominator,
but the test results (both for parallelism and relative potency) are based
on the ratios of the larger values over the smaller values.
</p>
<p>No relative potency is estimated if the two dose-effect curves differ
significantly from parallelism (with 95% confidence).
</p>


<h3>Value</h3>

<p>A list with two elements, <code>SR</code> with three elements:
</p>

<ul>
<li> <p><code>r</code> = a numeric vector of length three with the estimated
slope ratio with 95% confidence limits,
</p>
</li>
<li> <p><code>f</code> = a numeric scalar with the f of the slope ratio, and
</p>
</li>
<li> <p><code>parallel</code> = a logical scalar indicating whether the two
curves differ significantly from parallelism (FALSE).
</p>
</li></ul>

<p>and <code>PR</code> with one (just <code>difPotency</code> if <code>parallel=FALSE</code>)
or three (if <code>parallel=TRUE</code>) elements:
</p>

<ul>
<li> <p><code>r</code> = a numeric vector of length three with the estimated
potency ratio with 95% confidence limits,
</p>
</li>
<li> <p><code>f</code> = a numeric scalar with the f of the potency ratio, and
</p>
</li>
<li> <p><code>difPotency</code> = a logical scalar indicating whether the two
toxins differ significantly in potency (FALSE).
</p>
</li></ul>



<h3>References</h3>

<p>Litchfield, JT Jr. and F Wilcoxon.  1949.
A simplified method of evaluating dose-effect experiments.
Journal of Pharmacology and Experimental Therapeutics 96(2):99-113.
<a href="http://jpet.aspetjournals.org/content/96/2/99.abstract">[link]</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example starting from raw tox data
dose &lt;- c(0.0625, 0.125, 0.25, 0.5, 1)
ntested &lt;- rep(8, 5)
nalive1 &lt;- c(1, 4, 4, 7, 8)
mydat1 &lt;- dataprep(dose=dose, ntot=ntested, nfx=nalive1)
nalive2 &lt;- c(0, 1, 2, 6, 6)
mydat2 &lt;- dataprep(dose=dose, ntot=ntested, nfx=nalive2)
fit1 &lt;- LWestimate(fitLWauto(mydat1), mydat1)
fit2 &lt;- LWestimate(fitLWauto(mydat2), mydat2)
relPotency(fit1, fit2)

# Example from Litchfield and Wilcoxon (1949)
# comparing Tagathen and Pyribenzamine
relPotency(c(0.18, 1.72, 2.20, 1.60), c(0.60, 1.60, 2.34, 1.57), vec=TRUE)

# Example in which curves differ significantly from parallelism.
relPotency(c(0.18, 1.72, 2.20, 1.60), c(0.60, 1.60, 4.34, 1.57), vec=TRUE)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
