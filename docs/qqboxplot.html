<!DOCTYPE html><html><head><title>Help for package qqboxplot</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {qqboxplot}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#comparison_dataset'><p>Simulated normal dataset with mean=5 and variance=1</p></a></li>
<li><a href='#expression_data'><p>Log expression data for select genes</p></a></li>
<li><a href='#geom_qqboxplot'><p>A modification of the boxplot with information about the tails</p></a></li>
<li><a href='#indicators'><p>World Bank indicator data for Labor Force participation rates</p></a></li>
<li><a href='#population_brain_data'><p>Neuron population firing data</p></a></li>
<li><a href='#qqboxplot'><p><code>qqboxplot</code> package</p></a></li>
<li><a href='#simulated_data'><p>Simulated t-distributions to show use of q-q boxplots</p></a></li>
<li><a href='#spike_data'><p>Neuron spiking data for neural tuning orientation</p></a></li>
<li><a href='#stat_qqboxplot'><p>Compute values for the Q-Q Boxplot</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Implementation of the Q-Q Boxplot</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.0</td>
</tr>
<tr>
<td>Description:</td>
<td>A system to implement the Q-Q boxplot.  It is implemented as an
    extension to 'ggplot2'.  The Q-Q boxplot is an amalgam of the boxplot and the
    Q-Q plot and allows the user to rapidly examine summary statistics and tail
    behavior for multiple distributions in the same pane.  As an extension of
    the 'ggplot2' implementation of the boxplot, possible modifications to the 
    boxplot extend to the Q-Q boxplot.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2, grid</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.3)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, dplyr, gridExtra, testthat (&ge; 3.0.0),
vdiffr (&ge; 0.3.3), scales</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-11-20 03:17:28 UTC; jsr6q</td>
</tr>
<tr>
<td>Author:</td>
<td>Jordan Rodu [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jordan Rodu &lt;jordan.rodu@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-11-20 03:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='comparison_dataset'>Simulated normal dataset with mean=5 and variance=1</h2><span id='topic+comparison_dataset'></span>

<h3>Description</h3>

<p>A dataset that contains simulated data to reproduce a figure in our manuscript
</p>


<h3>Usage</h3>

<pre><code class='language-R'>comparison_dataset
</code></pre>


<h3>Format</h3>

<p>A vector
</p>


<h3>Source</h3>

<p>simulations
</p>

<hr>
<h2 id='expression_data'>Log expression data for select genes</h2><span id='topic+expression_data'></span>

<h3>Description</h3>

<p>A dataset that contains log expression data for randomly selected genes for two
patients, one with autism and one control.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expression_data
</code></pre>


<h3>Format</h3>

<p>A data frame with 1200 rows and 3 variables:
</p>

<dl>
<dt>gene</dt><dd><p>gene identifier (not meaningful)</p>
</dd>
<dt>specimen</dt><dd><p>autism or control</p>
</dd>
<dt>log_count</dt><dd><p>the logged gene expression count</p>
</dd>
</dl>
<p>...

</p>


<h3>Source</h3>

<p><a href="https://www.ebi.ac.uk/gxa/experiments/E-GEOD-30573/Results">https://www.ebi.ac.uk/gxa/experiments/E-GEOD-30573/Results</a>
</p>

<hr>
<h2 id='geom_qqboxplot'>A modification of the boxplot with information about the tails</h2><span id='topic+geom_qqboxplot'></span>

<h3>Description</h3>

<p>A modification of the boxplot with information about the tails
</p>


<h3>Usage</h3>

<pre><code class='language-R'>geom_qqboxplot(
  mapping = NULL,
  data = NULL,
  stat = "qqboxplot",
  position = "dodge2",
  ...,
  outlier.colour = NULL,
  outlier.color = NULL,
  outlier.fill = NULL,
  outlier.shape = 19,
  outlier.size = 1.5,
  outlier.stroke = 0.5,
  outlier.alpha = NULL,
  notch = FALSE,
  notchwidth = 0.5,
  varwidth = FALSE,
  na.rm = FALSE,
  show.legend = NA,
  inherit.aes = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="geom_qqboxplot_+3A_mapping">mapping</code></td>
<td>
<p>Set of aesthetic mappings created by <code><a href="ggplot2.html#topic+aes">aes()</a></code> or
<code><a href="ggplot2.html#topic+aes_">aes_()</a></code>. If specified and <code>inherit.aes = TRUE</code> (the
default), it is combined with the default mapping at the top level of the
plot. You must supply <code>mapping</code> if there is no plot mapping.</p>
</td></tr>
<tr><td><code id="geom_qqboxplot_+3A_data">data</code></td>
<td>
<p>The data to be displayed in this layer. There are three
options:
</p>
<p>If <code>NULL</code>, the default, the data is inherited from the plot
data as specified in the call to <code><a href="ggplot2.html#topic+ggplot">ggplot()</a></code>.
</p>
<p>A <code>data.frame</code>, or other object, will override the plot
data. All objects will be fortified to produce a data frame. See
<code><a href="ggplot2.html#topic+fortify">fortify()</a></code> for which variables will be created.
</p>
<p>A <code>function</code> will be called with a single argument,
the plot data. The return value must be a <code>data.frame</code>, and
will be used as the layer data. A <code>function</code> can be created
from a <code>formula</code> (e.g. <code>~ head(.x, 10)</code>).</p>
</td></tr>
<tr><td><code id="geom_qqboxplot_+3A_stat">stat</code></td>
<td>
<p>specifies the stat function to use</p>
</td></tr>
<tr><td><code id="geom_qqboxplot_+3A_position">position</code></td>
<td>
<p>Position adjustment, either as a string, or the result of
a call to a position adjustment function.</p>
</td></tr>
<tr><td><code id="geom_qqboxplot_+3A_...">...</code></td>
<td>
<p>Other arguments passed on to <code><a href="ggplot2.html#topic+layer">layer()</a></code>. These are
often aesthetics, used to set an aesthetic to a fixed value, like
<code>colour = "red"</code> or <code>size = 3</code>. They may also be parameters
to the paired geom/stat.</p>
</td></tr>
<tr><td><code id="geom_qqboxplot_+3A_outlier.colour">outlier.colour</code>, <code id="geom_qqboxplot_+3A_outlier.color">outlier.color</code>, <code id="geom_qqboxplot_+3A_outlier.fill">outlier.fill</code>, <code id="geom_qqboxplot_+3A_outlier.shape">outlier.shape</code>, <code id="geom_qqboxplot_+3A_outlier.size">outlier.size</code>, <code id="geom_qqboxplot_+3A_outlier.stroke">outlier.stroke</code>, <code id="geom_qqboxplot_+3A_outlier.alpha">outlier.alpha</code></td>
<td>
<p>Default aesthetics for outliers. Set to <code>NULL</code> to inherit from the
aesthetics used for the box.
</p>
<p>In the unlikely event you specify both US and UK spellings of colour, the
US spelling will take precedence.
</p>
<p>Sometimes it can be useful to hide the outliers, for example when overlaying
the raw data points on top of the boxplot. Hiding the outliers can be achieved
by setting <code>outlier.shape = NA</code>. Importantly, this does not remove the outliers,
it only hides them, so the range calculated for the y-axis will be the
same with outliers shown and outliers hidden.</p>
</td></tr>
<tr><td><code id="geom_qqboxplot_+3A_notch">notch</code></td>
<td>
<p>If <code>FALSE</code> (default) make a standard box plot. If
<code>TRUE</code>, make a notched box plot. Notches are used to compare groups;
if the notches of two boxes do not overlap, this suggests that the medians
are significantly different.</p>
</td></tr>
<tr><td><code id="geom_qqboxplot_+3A_notchwidth">notchwidth</code></td>
<td>
<p>For a notched box plot, width of the notch relative to
the body (defaults to <code>notchwidth = 0.5</code>).</p>
</td></tr>
<tr><td><code id="geom_qqboxplot_+3A_varwidth">varwidth</code></td>
<td>
<p>If <code>FALSE</code> (default) make a standard box plot. If
<code>TRUE</code>, boxes are drawn with widths proportional to the
square-roots of the number of observations in the groups (possibly
weighted, using the <code>weight</code> aesthetic).</p>
</td></tr>
<tr><td><code id="geom_qqboxplot_+3A_na.rm">na.rm</code></td>
<td>
<p>If <code>FALSE</code>, the default, missing values are removed with
a warning. If <code>TRUE</code>, missing values are silently removed.</p>
</td></tr>
<tr><td><code id="geom_qqboxplot_+3A_show.legend">show.legend</code></td>
<td>
<p>logical. Should this layer be included in the legends?
<code>NA</code>, the default, includes if any aesthetics are mapped.
<code>FALSE</code> never includes, and <code>TRUE</code> always includes.
It can also be a named logical vector to finely select the aesthetics to
display.</p>
</td></tr>
<tr><td><code id="geom_qqboxplot_+3A_inherit.aes">inherit.aes</code></td>
<td>
<p>If <code>FALSE</code>, overrides the default aesthetics,
rather than combining with them. This is most useful for helper functions
that define both data and aesthetics and shouldn't inherit behaviour from
the default plot specification, e.g. <code><a href="ggplot2.html#topic+borders">borders()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an object of class <code>GeomQqboxplot</code>, (inherits from <code>Geom</code>, <code>ggproto</code>),
that renders the data for the Q-Q boxplot.
</p>


<h3>Description</h3>

<p>The Q-Q boxplot inherits its summary statistics from the boxplot.  See
<code><a href="ggplot2.html#topic+geom_boxplot">geom_boxplot()</a></code> for details.  The Q-Q boxplot differs from the boxplot
by using more informative whiskers than the regular boxplot.
</p>
<p>The vertical position of the whiskers can be interpreted as it is in the
boxplot, and the maximal vertical value is chosen as it is done in the
regular boxplot.  The horizontal positioning of the whiskers indicates the
deviation of the data set of interest from some reference data set
(specified as either a theoretical distribution or an actual data set).
Taking the central vertical axis of the boxplot as being zero, deviations
to the right indicate that those values are larger than the
corresponding data points in the reference data set, where two data points
correspond if their quantiles match.  Deviations to the left indicate that
the values are smaller than their corresponding data points.  Consider a
situation where your data set has fatter tails than the normal distribution.
When the reference distribution is the normal distribution, then the whiskers
below the box will be left of the central axis (the left tail values are
smaller than they ought to be) and the whiskers above the box will be right
of the central axis (the right tail values are larger than the ought to be).
</p>
<p>In order to compare the data set of interest to the reference data set, they
must be on the same scale.  The Q-Q boxplot uses Tukey's g-h distribution
to determine the appropriate scaling factor.
</p>
<p>Much of the code here is a modification of the geom_boxplot() code.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>p &lt;- ggplot2::ggplot(simulated_data, ggplot2::aes(factor(group,
levels=c("normal, mean=2", "t distribution, df=32", "t distribution, df=16",
"t distribution, df=8", "t distribution, df=4")), y=y))
p + geom_qqboxplot()
p + geom_qqboxplot(reference_dist = "norm")


p + geom_qqboxplot(compdata = comparison_dataset)


# geom_qqboxplot inherits all arguments from geom_boxplot, e.g.:
p + geom_qqboxplot(notch = TRUE)
p + geom_qqboxplot(varwidth=TRUE)
p + geom_qqboxplot(ggplot2::aes(color = group)) + ggplot2::guides(color=FALSE)

</code></pre>

<hr>
<h2 id='indicators'>World Bank indicator data for Labor Force participation rates</h2><span id='topic+indicators'></span>

<h3>Description</h3>

<p>A dataset that contains participation rates (%) for ages 15-24, separated
by gender, and measured in the years 2008, 2012, and 2017
</p>


<h3>Usage</h3>

<pre><code class='language-R'>indicators
</code></pre>


<h3>Format</h3>

<p>A data frame with 612 rows and 7 variables:
</p>

<dl>
<dt>Country Name</dt><dd><p>name of country</p>
</dd>
<dt>Country Code</dt><dd><p>unique country identifier (string)</p>
</dd>
<dt>Series Name</dt><dd><p>Specifies male/female</p>
</dd>
<dt>Series Code</dt><dd><p>unique identifier for series</p>
</dd>
<dt>year</dt><dd><p>year for data</p>
</dd>
<dt>indicator</dt><dd><p>participation rate in percents</p>
</dd>
<dt>log_indicator</dt><dd><p>the log of the participation rate</p>
</dd>
</dl>
<p>...

</p>


<h3>Source</h3>

<p><a href="https://www.worldbank.org/en/home">https://www.worldbank.org/en/home</a>
</p>

<hr>
<h2 id='population_brain_data'>Neuron population firing data</h2><span id='topic+population_brain_data'></span>

<h3>Description</h3>

<p>A dataset that contains populations of neurons from CA1 and LM and their
firing rates for three situations: base firing rate, dot motion, and
drifting gradient.  Each row represents a neuron
</p>


<h3>Usage</h3>

<pre><code class='language-R'>population_brain_data
</code></pre>


<h3>Format</h3>

<p>A data frame with 13731 rows and 3 variables:
</p>

<dl>
<dt>ecephys_structure_acronym</dt><dd><p>acronym for population location</p>
</dd>
<dt>fr_type</dt><dd><p>situation under which firing rate was recorded</p>
</dd>
<dt>rate</dt><dd><p>the firing rate</p>
</dd>
</dl>
<p>...

</p>


<h3>Source</h3>

<p><a href="https://allensdk.readthedocs.io/en/latest/visual_coding_neuropixels.html">https://allensdk.readthedocs.io/en/latest/visual_coding_neuropixels.html</a>
</p>

<hr>
<h2 id='qqboxplot'><code>qqboxplot</code> package</h2><span id='topic+qqboxplot'></span>

<h3>Description</h3>

<p>Create qq-boxplots
</p>

<hr>
<h2 id='simulated_data'>Simulated t-distributions to show use of q-q boxplots</h2><span id='topic+simulated_data'></span>

<h3>Description</h3>

<p>A dataset that contains simulated data to reproduce the simulated data
figures used in our manuscript
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulated_data
</code></pre>


<h3>Format</h3>

<p>A data frame with 4500 rows and 2 variables:
</p>

<dl>
<dt>y</dt><dd><p>a value simulated from a distribution</p>
</dd>
<dt>group</dt><dd><p>a string specifying the distribution from which the y value
is drawn</p>
</dd>
</dl>
<p>...

</p>


<h3>Source</h3>

<p>simulations
</p>

<hr>
<h2 id='spike_data'>Neuron spiking data for neural tuning orientation</h2><span id='topic+spike_data'></span>

<h3>Description</h3>

<p>A dataset that contains the number of spikes for neurons across several
possible orientations of a grating
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spike_data
</code></pre>


<h3>Format</h3>

<p>A data frame with 12800 rows and 5 variables:
</p>

<dl>
<dt>orientation</dt><dd><p>1 to 8, specifies the orientation of the grating</p>
</dd>
<dt>nspikes</dt><dd><p>number of spikes for a single trial of 1.28 seconds for a particular orientation</p>
</dd>
<dt>region</dt><dd><p>region of the brain where the neuron is located</p>
</dd>
</dl>
<p>...

</p>


<h3>Source</h3>

<p><a href="https://CRCNS.org">https://CRCNS.org</a>
</p>

<hr>
<h2 id='stat_qqboxplot'>Compute values for the Q-Q Boxplot</h2><span id='topic+stat_qqboxplot'></span>

<h3>Description</h3>

<p>Compute values for the Q-Q Boxplot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stat_qqboxplot(
  mapping = NULL,
  data = NULL,
  geom = "qqboxplot",
  position = "dodge2",
  ...,
  coef = 1.5,
  na.rm = FALSE,
  show.legend = NA,
  inherit.aes = TRUE,
  reference_dist = "norm",
  confidence_level = 0.95,
  numboots = 500,
  qtype = 7,
  compdata = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stat_qqboxplot_+3A_mapping">mapping</code></td>
<td>
<p>Set of aesthetic mappings created by <code><a href="ggplot2.html#topic+aes">aes()</a></code> or
<code><a href="ggplot2.html#topic+aes_">aes_()</a></code>. If specified and <code>inherit.aes = TRUE</code> (the
default), it is combined with the default mapping at the top level of the
plot. You must supply <code>mapping</code> if there is no plot mapping.</p>
</td></tr>
<tr><td><code id="stat_qqboxplot_+3A_data">data</code></td>
<td>
<p>The data to be displayed in this layer. There are three
options:
</p>
<p>If <code>NULL</code>, the default, the data is inherited from the plot
data as specified in the call to <code><a href="ggplot2.html#topic+ggplot">ggplot()</a></code>.
</p>
<p>A <code>data.frame</code>, or other object, will override the plot
data. All objects will be fortified to produce a data frame. See
<code><a href="ggplot2.html#topic+fortify">fortify()</a></code> for which variables will be created.
</p>
<p>A <code>function</code> will be called with a single argument,
the plot data. The return value must be a <code>data.frame</code>, and
will be used as the layer data. A <code>function</code> can be created
from a <code>formula</code> (e.g. <code>~ head(.x, 10)</code>).</p>
</td></tr>
<tr><td><code id="stat_qqboxplot_+3A_geom">geom</code></td>
<td>
<p>specifies the geom function to use</p>
</td></tr>
<tr><td><code id="stat_qqboxplot_+3A_position">position</code></td>
<td>
<p>Position adjustment, either as a string, or the result of
a call to a position adjustment function.</p>
</td></tr>
<tr><td><code id="stat_qqboxplot_+3A_...">...</code></td>
<td>
<p>Other arguments passed on to <code><a href="ggplot2.html#topic+layer">layer()</a></code>. These are
often aesthetics, used to set an aesthetic to a fixed value, like
<code>colour = "red"</code> or <code>size = 3</code>. They may also be parameters
to the paired geom/stat.</p>
</td></tr>
<tr><td><code id="stat_qqboxplot_+3A_coef">coef</code></td>
<td>
<p>Length of the whiskers as multiple of IQR. Defaults to 1.5.</p>
</td></tr>
<tr><td><code id="stat_qqboxplot_+3A_na.rm">na.rm</code></td>
<td>
<p>If <code>FALSE</code>, the default, missing values are removed with
a warning. If <code>TRUE</code>, missing values are silently removed.</p>
</td></tr>
<tr><td><code id="stat_qqboxplot_+3A_show.legend">show.legend</code></td>
<td>
<p>logical. Should this layer be included in the legends?
<code>NA</code>, the default, includes if any aesthetics are mapped.
<code>FALSE</code> never includes, and <code>TRUE</code> always includes.
It can also be a named logical vector to finely select the aesthetics to
display.</p>
</td></tr>
<tr><td><code id="stat_qqboxplot_+3A_inherit.aes">inherit.aes</code></td>
<td>
<p>If <code>FALSE</code>, overrides the default aesthetics,
rather than combining with them. This is most useful for helper functions
that define both data and aesthetics and shouldn't inherit behaviour from
the default plot specification, e.g. <code><a href="ggplot2.html#topic+borders">borders()</a></code>.</p>
</td></tr>
<tr><td><code id="stat_qqboxplot_+3A_reference_dist">reference_dist</code></td>
<td>
<p>Specifies theoretical reference distribution.</p>
</td></tr>
<tr><td><code id="stat_qqboxplot_+3A_confidence_level">confidence_level</code></td>
<td>
<p>Sets confidence level for deviation whisker
confidence bands</p>
</td></tr>
<tr><td><code id="stat_qqboxplot_+3A_numboots">numboots</code></td>
<td>
<p>specifies the number of bootstrap draws for bootstrapped CIs
needed only if compdata is not NULL</p>
</td></tr>
<tr><td><code id="stat_qqboxplot_+3A_qtype">qtype</code></td>
<td>
<p>an integer between 1 and 9 indicating which one of the quantile algorithms to use.</p>
</td></tr>
<tr><td><code id="stat_qqboxplot_+3A_compdata">compdata</code></td>
<td>
<p>specifies a data set to use as the reference distribution.
If compdata is not NULL, the argument reference_dist will be ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an object of class <code>StatQqboxplot</code>, (inherits from <code>Geom</code>, <code>ggproto</code>),
that helps to render the data for <code>geom_qqboxplot()</code>.
</p>


<h3>Computed variables</h3>

<p><code>stat_qqboxplot()</code> provides the following variables, some of which depend on the orientation:
</p>

<dl>
<dt>width</dt><dd><p>width of boxplot</p>
</dd>
<dt>ymin <em>or</em> xmin</dt><dd><p>lower whisker = smallest observation greater than or equal to lower hinge - 1.5 * IQR</p>
</dd>
<dt>lower <em>or</em> xlower</dt><dd><p>lower hinge, 25% quantile</p>
</dd>
<dt>notchlower</dt><dd><p>lower edge of notch = median - 1.58 * IQR / sqrt(n)</p>
</dd>
<dt>middle <em>or</em> xmiddle</dt><dd><p>median, 50% quantile</p>
</dd>
<dt>notchupper</dt><dd><p>upper edge of notch = median + 1.58 * IQR / sqrt(n)</p>
</dd>
<dt>upper <em>or</em> xupper</dt><dd><p>upper hinge, 75% quantile</p>
</dd>
<dt>ymax <em>or</em> xmax</dt><dd><p>upper whisker = largest observation less than or equal to upper hinge + 1.5 * IQR</p>
</dd>
</dl>


</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
