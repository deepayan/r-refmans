<!DOCTYPE html><html lang="en"><head><title>Help for package RRNA</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {RRNA}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#RRNA-package'>
<p>RNA secondary structure ploting</p></a></li>
<li><a href='#alignCoord'>
<p>Alignment of secondary structure folds to 2 nucleotides.</p></a></li>
<li><a href='#aptPlotCT'>
<p>RNA secondary structure plotting from CT files</p></a></li>
<li><a href='#backward'>
<p>Internal function for moving through secondary structures</p></a></li>
<li><a href='#bplfile'>
<p>Creates a bpl file from a coordinate file</p></a></li>
<li><a href='#circleCoord'>
<p>Internal function for finding the coordinates of NT's in a circle</p></a></li>
<li><a href='#ct2coord'>
<p>Generate coordinate file</p></a></li>
<li><a href='#ct2knet'>
<p>creates a knet file from a CT file</p></a></li>
<li><a href='#forward'>
<p>Internal function for moving through secondary structures</p></a></li>
<li><a href='#genCords'>
<p>Internal function that generates coordinates for a given loop starting and stopping at p1 and p2 respectfully</p></a></li>
<li><a href='#loadCoords'>
<p>Loads a coordinate file into a data frame</p></a></li>
<li><a href='#loadCt'>
<p>Loads a CT file into an R data frame</p></a></li>
<li><a href='#loopLength'>
<p>internal function that determines the length of a loop</p></a></li>
<li><a href='#makeCt'>
<p>make a CT file from a structure and sequence</p></a></li>
<li><a href='#pseudoKnot'>
<p>removes pseudoknots from a ct file</p></a></li>
<li><a href='#RNAPlot'>
<p>Generic RNA Secondary Structure Plotting Function</p></a></li>
<li><a href='#rotateS'>
<p>Internal function to rotate a single point</p></a></li>
<li><a href='#rotateV'>
<p>internal function to rotate a vector of points</p></a></li>
<li><a href='#stemCords'>
<p>internal function that generates coordinates for a stem</p></a></li>
<li><a href='#transformFold'>
<p>Internal function to translate and rotate a secondary structure plot</p></a></li>
<li><a href='#translate'>
<p>internal function for translating points</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Secondary Structure Plotting for RNA</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-07-10</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions for creating and manipulating RNA secondary structure plots.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-07-10 10:02:31 UTC; jp</td>
</tr>
<tr>
<td>Author:</td>
<td>JP Bida [aut],
  Jonathan Price <a href="https://orcid.org/0000-0001-6554-5667"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [cre, ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jonathan Price &lt;jlp76@cam.ac.uk&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-07-10 10:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='RRNA-package'>
RNA secondary structure ploting
</h2><span id='topic+RRNA-package'></span><span id='topic+RRNA'></span>

<h3>Description</h3>

<p>Set of functions for creating and manipulating RNA secondary structure plots from CT files or bracket notations.  
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> RRNA</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2015-07-27</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-3</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>JP Bida
Maintainer: JP Bida &lt;bida.john@gmail.com
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Create a CT file from bracket notation
ct=makeCt("(((...(((...)))...(((...)))...)))","AAAUUUCCCAAAGGGUUUAAAGGGUUUCCCUUU")
coord=ct2coord(ct)
RNAPlot(coord,hl=c("GGGUUU","AAAUUU"),seqcols=c(2,4),labTF=TRUE)
</code></pre>

<hr>
<h2 id='alignCoord'>
Alignment of secondary structure folds to 2 nucleotides. 
</h2><span id='topic+alignCoord'></span>

<h3>Description</h3>

<p>Given a coordinate file with multiple RNA secondary structures, it aligns all folds such that n1 is at position (x,y) and n2 has its y coordinate equal to y
</p>


<h3>Usage</h3>

<pre><code class='language-R'>alignCoord(data, n1, n2, x, y)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="alignCoord_+3A_data">data</code></td>
<td>

<p>R data frame containing the coordinates for plotting a given secondary structure 
</p>
</td></tr>
<tr><td><code id="alignCoord_+3A_n1">n1</code></td>
<td>

<p>Nucleotide position that will be translated to (x,y)
</p>
</td></tr>
<tr><td><code id="alignCoord_+3A_n2">n2</code></td>
<td>

<p>Nucleotide position that will have its y coordinate equal to y
</p>
</td></tr>
<tr><td><code id="alignCoord_+3A_x">x</code></td>
<td>

<p>x coordinate that n1 will be translated to 
</p>
</td></tr>
<tr><td><code id="alignCoord_+3A_y">y</code></td>
<td>

<p>y coordinate that n1 will be translated to
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a data frame containing fold coordinates. 
</p>


<h3>Author(s)</h3>

<p>JP Bida
</p>


<h3>See Also</h3>

<p><code><a href="#topic+RNAPlot">RNAPlot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Create two RNA secondary structures ####
ct1=makeCt(
           "((((...(((((((....)))))))...((((...))))...))))",
           "CCCCAAAGGGGGGGAUUACCCCUCCUUUAAAAGGGUUUUCCCCCCC" 
          )
ct2=makeCt(
           "((((...(((((((....))))))).((..((...))))...))))",
           "CCCCAAAGGGGGGGAUUACCCCUCCUUUAAAAGGGUUUUCCCCCCC" 
          )

### Create a coordinate file ####
dat1=ct2coord(ct1)

### Each RNA fold needs its own id ###
dat1$id=1

#### Create a coordinate file ####
dat2=ct2coord(ct2)
### Each RNA fold needs its own id ###
dat2$id=2

dat=rbind(dat1,dat2)

adat=alignCoord(dat,1,46,0,0)

### Plot the aligned RNA folds ####
RNAPlot(adat[adat$id==1,])
l=length(adat$seq[adat$id==2])
RNAPlot(adat[adat$id==2,],modspec=TRUE,modp=c(1:l),modcol=rep(4,l),mod=rep(16,l),add=TRUE)

</code></pre>

<hr>
<h2 id='aptPlotCT'>
RNA secondary structure plotting from CT files
</h2><span id='topic+aptPlotCT'></span>

<h3>Description</h3>

<p>Generates and RNA secondary structure plot from a CT file. Removes pseudoKnots automatically and allows them to be drawn back in with pseudoTF=TRUE.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aptPlotCT(file, ranges = 0, add = FALSE, hl = NULL, seqcols = NULL,
          seqTF = FALSE, labTF = FALSE, nt = FALSE, dp = 0.5, 
          modspec = FALSE, modp = NULL, mod = NULL, modcol = NULL, 
          tsize = 0.5, main = "", pseudoTF = FALSE, pseudo_nums = NULL, 
          ticks = NULL, ticksTF = FALSE
         )
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="aptPlotCT_+3A_file">file</code></td>
<td>

<p>CT file name
</p>
</td></tr>
<tr><td><code id="aptPlotCT_+3A_ranges">ranges</code></td>
<td>

<p>A data frame containing the ranges of sequence positions that should be highlighted with given colors.
<code>
ranges=data.frame(min=c(69,1,7),max=c(74,5,17),col=c(2,3,4),desc=c("Region 1","Region 2","Region 3"))
</code>
The above will highlight the nucleotides at positions 69-74, 1-5, and 7-17 respectively 
</p>
</td></tr>
<tr><td><code id="aptPlotCT_+3A_add">add</code></td>
<td>

<p>Should the new plot be added to an existing plot TRUE/FALSE
</p>
</td></tr>
<tr><td><code id="aptPlotCT_+3A_hl">hl</code></td>
<td>

<p>Takes an array of sequences and highlights them with seqcol
<code>hl=c("GGGAAAA","GGGCCCC")</code>
The above hl will highlight the nucleotides in the secondary structure that have the given sequences with the colors provided in the seqcols option.  
</p>
</td></tr>
<tr><td><code id="aptPlotCT_+3A_seqcols">seqcols</code></td>
<td>

<p>Colors that should be used to highlight the sequences given in hl
</p>
</td></tr>
<tr><td><code id="aptPlotCT_+3A_seqtf">seqTF</code></td>
<td>

<p>If sequence is a vector set as TRUE
</p>
</td></tr>
<tr><td><code id="aptPlotCT_+3A_labtf">labTF</code></td>
<td>

<p>TRUE/FALSE plot the legend
</p>
</td></tr>
<tr><td><code id="aptPlotCT_+3A_nt">nt</code></td>
<td>

<p>TRUE/FALSE plot the nucleotide sequence on the secondary structure
</p>
</td></tr>
<tr><td><code id="aptPlotCT_+3A_dp">dp</code></td>
<td>

<p>Floating point value to determine how far from the coordinates the nucleotide sequence should be plotted. Values between 0 and 5 usually work best. 
</p>
</td></tr>
<tr><td><code id="aptPlotCT_+3A_modspec">modspec</code></td>
<td>

<p>TRUE/FALSE modify specific positions in the secondary structure. Used in combination with modp,mod,and modcol. This allows you to change the shape and color of nucleotide in the secondary structure. 
</p>
</td></tr>
<tr><td><code id="aptPlotCT_+3A_modp">modp</code></td>
<td>

<p>Array defining the specific positions to be modified in the plot
<code>
modp=c(1:10)
</code>
</p>
</td></tr>
<tr><td><code id="aptPlotCT_+3A_mod">mod</code></td>
<td>

<p>Array defining the pch values to be plotted at the positions given by modp. 
<code>
mod=c(rep(15,5),rep(16,5))
</code>
</p>
</td></tr>
<tr><td><code id="aptPlotCT_+3A_modcol">modcol</code></td>
<td>

<p>Array of color values to be used for plotting at the positions defined by modp in the secondary structure. 
<code>
modcol=rep(4,10)
</code>
</p>
</td></tr>
<tr><td><code id="aptPlotCT_+3A_tsize">tsize</code></td>
<td>

<p>Text size used for plotting the nucleotide sequence in the secondary structure. Only applicable when nt=TRUE. Values between 0.1 and 4 work well. 
</p>
</td></tr>
<tr><td><code id="aptPlotCT_+3A_main">main</code></td>
<td>

<p>Title used for the plot when labTF is set to TRUE.
</p>
</td></tr>
<tr><td><code id="aptPlotCT_+3A_pseudotf">pseudoTF</code></td>
<td>

<p>Plot pseudo knot sequences
</p>
</td></tr>
<tr><td><code id="aptPlotCT_+3A_pseudo_nums">pseudo_nums</code></td>
<td>

<p>indices of the nucleotides included in pseudoknots
</p>
</td></tr>
<tr><td><code id="aptPlotCT_+3A_tickstf">ticksTF</code></td>
<td>

<p>TRUE/FALSE include ticks 
</p>
</td></tr>
<tr><td><code id="aptPlotCT_+3A_ticks">ticks</code></td>
<td>

<p>Positions where the ticks should be drawn. These are sequence positions in the RNA molecule
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns and R plot object
</p>


<h3>Author(s)</h3>

<p>JP Bida
</p>


<h3>See Also</h3>

<p><code><a href="#topic+RNAPlot">RNAPlot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### PseudoKnots ###
pk= makeCt("((((...(((((((.........)))))))...((((.........))))...))))",
          "AAAAAAAACCCCCCCCAAAGGGGGGGAUUACCCCUCCUUUAAAAGGGUUUUCCCCCCC"
         )
pk$bound[pk$pos==20]=42
pk$bound[pk$pos==19]=43
pk$bound[pk$pos==43]=19
pk$bound[pk$pos==42]=20
f = tempfile()
### Create a CT file for testing ###
write.table(pk[,c(1,4,2,3,6,5)],file=f,row.names=FALSE,col.names=TRUE)

aptPlotCT(f,ticksTF=TRUE,ticks=seq(1,60,by=5),pseudoTF=TRUE,pseudo_nums=c(19,20,43,42))

</code></pre>

<hr>
<h2 id='backward'>
Internal function for moving through secondary structures
</h2><span id='topic+backward'></span>

<h3>Description</h3>

<p>Given a bracket notation for RNA secondary structure and an index of a &quot;)&quot; bracket type the backward function will find the &quot;(&quot; bracket that closes the &quot;)&quot; at the given index.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>backward(stc, i)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="backward_+3A_stc">stc</code></td>
<td>

<p>Array of brackets and dots.
<code>
a=unlist(strsplit("(((...)))...((..))",""))
</code>
</p>
</td></tr>
<tr><td><code id="backward_+3A_i">i</code></td>
<td>

<p>index giving the position of a bracket
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns the index of the bracket that closes the bracket at the given index
</p>


<h3>Author(s)</h3>

<p>JP Bida
</p>


<h3>Examples</h3>

<pre><code class='language-R'>a=unlist(strsplit("(((...)))...((..))",""))
ind=backward(a,7)
</code></pre>

<hr>
<h2 id='bplfile'>
Creates a bpl file from a coordinate file 
</h2><span id='topic+bplfile'></span>

<h3>Description</h3>

<p>A bpl file can be created from a given coordinate file for inputing into other RNA visulatization programs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bplfile(dat, name)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bplfile_+3A_dat">dat</code></td>
<td>

<p>Coordinate file created by ct2coord or loadCoords functions 
<code>
ct=makeCt("((((...))))","AAAACCCUUUU")
### Create the coordinate file ###
dat=ct2coord(ct)
</code>
</p>
</td></tr>
<tr><td><code id="bplfile_+3A_name">name</code></td>
<td>

<p>Name of the file outputed 
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Creates the file with the given &quot;name&quot;
</p>


<h3>Author(s)</h3>

<p>JP Bida
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ct=makeCt("((((...))))","AAAACCCUUUU")
### Create the coordinate file ###
dat=ct2coord(ct)

bplfile(dat,tempfile())
</code></pre>

<hr>
<h2 id='circleCoord'>
Internal function for finding the coordinates of NT's in a circle
</h2><span id='topic+circleCoord'></span>

<h3>Description</h3>

<p>Given an integer N the function returns N (x,y) coordinates for a polygon with N sides each of length 1. This is used to plot the loops in an RNA structure
</p>


<h3>Usage</h3>

<pre><code class='language-R'>circleCoord(n)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="circleCoord_+3A_n">n</code></td>
<td>

<p>Integer determining the number of sides
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame with columns x,y defining coordinates of the polygons
</p>


<h3>Author(s)</h3>

<p>JP Bida
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pts=circleCoord(10)
plot(pts$x,pts$y)
</code></pre>

<hr>
<h2 id='ct2coord'>
Generate coordinate file 
</h2><span id='topic+ct2coord'></span>

<h3>Description</h3>

<p>Creates a coordinate file from a CT file that has been loaded into a data frame
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ct2coord(input)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ct2coord_+3A_input">input</code></td>
<td>

<p>Data frame representing a ct file. Created from makeCt or loadCt
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a coordinate file for the secondary structure represented in the CT file
</p>


<h3>Note</h3>

<p>Pseudoknots sometimes cause trouble
</p>


<h3>Author(s)</h3>

<p>JP Bida
</p>


<h3>See Also</h3>

<p><code><a href="#topic+RNAPlot">RNAPlot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ct=makeCt("((((...(((((((....)))))))...((((...))))...))))",
          "CCCCAAAGGGGGGGAUUACCCCUCCUUUAAAAGGGUUUUCCCCCCC"
         )
coord=ct2coord(ct)
RNAPlot(coord)
</code></pre>

<hr>
<h2 id='ct2knet'>
creates a knet file from a CT file
</h2><span id='topic+ct2knet'></span>

<h3>Description</h3>

<p>Knet files are used as inputs for KnetFold secondary structure prediction program
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ct2knet(file, ind = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ct2knet_+3A_file">file</code></td>
<td>

<p>Name of the CT file being converted to KnetFold file
</p>
</td></tr>
<tr><td><code id="ct2knet_+3A_ind">ind</code></td>
<td>

<p>Index used to relabel sequence indexes
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Retuns a string containing the contains of the knet file
</p>


<h3>Author(s)</h3>

<p>JP Bida
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pk=makeCt("((((...(((((((.........)))))))...((((.........))))...))))",
          "AAAAAAAACCCCCCCCAAAGGGGGGGAUUACCCCUCCUUUAAAAGGGUUUUCCCCCCC"
         )
pk$bound[pk$pos==20]=42
pk$bound[pk$pos==19]=43
pk$bound[pk$pos==43]=19
pk$bound[pk$pos==42]=20

f = tempfile()
### Create a CT file for testing ###
write.table(pk[,c(1,4,2,3,6,5)],file=f,row.names=FALSE,col.names=TRUE)

### Convert CT file to Knet ###
out=ct2knet(f,0)
</code></pre>

<hr>
<h2 id='forward'>
Internal function for moving through secondary structures
</h2><span id='topic+forward'></span>

<h3>Description</h3>

<p>Given a bracket notation for RNA secondary structure and an index of a &quot;(&quot; bracket type the forward function will find the &quot;)&quot; bracket that closes the &quot;(&quot; at the given index.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>forward(stc, i)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="forward_+3A_stc">stc</code></td>
<td>

<p>a=unlist(strsplit(&quot;(((...)))...((..))&quot;,&quot;&quot;))
</p>
</td></tr>
<tr><td><code id="forward_+3A_i">i</code></td>
<td>

<p>Interger index 
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Integer index
</p>


<h3>Author(s)</h3>

<p>JP Bida
</p>


<h3>See Also</h3>

<p><code><a href="#topic+backward">backward</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>a=unlist(strsplit("(((...)))...((..))",""))
ind=forward(a,1)
</code></pre>

<hr>
<h2 id='genCords'>
Internal function that generates coordinates for a given loop starting and stopping at p1 and p2 respectfully
</h2><span id='topic+genCords'></span>

<h3>Description</h3>

<p>Generates coordinates for a loop in a secondary structure. Internal function used by RNAPlot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>genCords(loop, p1, p2, input, vn)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="genCords_+3A_loop">loop</code></td>
<td>

<p>List contianing a data frame that has the subset of nucleotides in a given loop
</p>
</td></tr>
<tr><td><code id="genCords_+3A_p1">p1</code></td>
<td>

<p>The position of the first nucleotide in the loop
</p>
</td></tr>
<tr><td><code id="genCords_+3A_p2">p2</code></td>
<td>

<p>The position of the second nucleotide in the loop
</p>
</td></tr>
<tr><td><code id="genCords_+3A_input">input</code></td>
<td>

<p>The data frame contianing the coordinate file for the entire RNA secondary structure 
</p>
</td></tr>
<tr><td><code id="genCords_+3A_vn">vn</code></td>
<td>

<p>A flag that flips over y axis if vn = 1. 
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a set of points
</p>


<h3>Author(s)</h3>

<p>JP Bida
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### This is an internal function ###
</code></pre>

<hr>
<h2 id='loadCoords'>
Loads a coordinate file into a data frame
</h2><span id='topic+loadCoords'></span>

<h3>Description</h3>

<p>Coordinate files can be created from the viennaRNA library. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loadCoords(filename)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="loadCoords_+3A_filename">filename</code></td>
<td>

<p>Name of the coordinate file being loaded
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame containing the coordinate file
</p>


<h3>Author(s)</h3>

<p>JP Bida
</p>


<h3>References</h3>

<p>The RRNAFold program generates the coordinate files used by RRNA
</p>
<p><a href="https://github.com/jpbida/ViennaScripts">https://github.com/jpbida/ViennaScripts</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Create a test coordinate file using ct2coord ###
ct=makeCt("((((...(((((((.........)))))))...((((.........))))...))))",
          "AAAAAAAACCCCCCCCAAAGGGGGGGAUUACCCCUCCUUUAAAAGGGUUUUCCCCCCC" 
         )
coord=ct2coord(ct)
### add an id ###
coord$id=1
f = tempfile()
### write out test file ###
write.table( coord[,c('id','x','y','seq','num','bound')],
             col.names=FALSE,row.names=FALSE,sep=",",file=f
           )

### Read in the coordinate file ##
input=loadCoords(f)

### Plot the file using RNAPlot ##
RNAPlot(input)
</code></pre>

<hr>
<h2 id='loadCt'>
Loads a CT file into an R data frame
</h2><span id='topic+loadCt'></span>

<h3>Description</h3>

<p>A variety of RNA secondary structure prediction programs produce CT files. You can load these CT files into 
R using the loadCT function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loadCt(file)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="loadCt_+3A_file">file</code></td>
<td>

<p>The name of the CT file being loaded
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns at data frame containing the CT file data 
</p>


<h3>Author(s)</h3>

<p>JP Bida
</p>


<h3>See Also</h3>

<p><code><a href="#topic+RNAPlot">RNAPlot</a></code>
<code><a href="#topic+aptPlotCT">aptPlotCT</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Create a CT file with PseudoKnots ###
pk=makeCt("((((...(((((((.........)))))))...((((.........))))...))))",
          "AAAAAAAACCCCCCCCAAAGGGGGGGAUUACCCCUCCUUUAAAAGGGUUUUCCCCCCC"
         )
pk$bound[pk$pos==20]=42
pk$bound[pk$pos==19]=43
pk$bound[pk$pos==43]=19
pk$bound[pk$pos==42]=20

### Create a CT file for testing ###

f = tempfile()
write.table(pk[,c(1,4,2,3,6,5)],file=f,
            row.names=FALSE,col.names=TRUE)

ctfile=loadCt(f)

### Before using ct2coord you need to remove the pseudo knots ###

l=pseudoKnot(ctfile)
dat=l[[2]]
cd=ct2coord(dat)
RNAPlot(cd)

</code></pre>

<hr>
<h2 id='loopLength'>
internal function that determines the length of a loop
</h2><span id='topic+loopLength'></span>

<h3>Description</h3>

<p>Used by RNAPlot to get the length of a loop
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loopLength(input, start)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="loopLength_+3A_input">input</code></td>
<td>

<p>CT file 
<code>makeCt("((((...))))","AAAACCCUUUU")</code>
</p>
</td></tr>
<tr><td><code id="loopLength_+3A_start">start</code></td>
<td>

<p>Position of the first nucleotide in the the loop
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Retuns a list contianing the output and stems
</p>


<h3>Author(s)</h3>

<p>JP Bida
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ct=makeCt("((((...((((..))))..((((...)))).))))","AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA")
out=loopLength(ct,4)
</code></pre>

<hr>
<h2 id='makeCt'>
make a CT file from a structure and sequence
</h2><span id='topic+makeCt'></span>

<h3>Description</h3>

<p>Given an RNA secondary structure in bracket notation containing no pseudoKnots this function creates an R data frame that represents the secondary structures CT file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>makeCt(struct, seq)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="makeCt_+3A_struct">struct</code></td>
<td>

<p>Bracket notation. 
<code>st="(((((....)))))..((..))"</code>
</p>
</td></tr>
<tr><td><code id="makeCt_+3A_seq">seq</code></td>
<td>

<p>String containing the RNA sequence
<code>seq="AUAAUUAAAAAAAACCCCCAAA"</code> 
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a data frame representing the bracket notaiton secondary structure in a CT file like format.
</p>


<h3>Author(s)</h3>

<p>JP Bida
</p>


<h3>Examples</h3>

<pre><code class='language-R'>st="(((((....)))))..((..))"
seq="AUAAUUAAAAAAAACCCCCAAA"

ct=makeCt(st,seq) 
</code></pre>

<hr>
<h2 id='pseudoKnot'>
removes pseudoknots from a ct file 
</h2><span id='topic+pseudoKnot'></span>

<h3>Description</h3>

<p>internal function used to remove pseudoKnots before calling ct2coord 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pseudoKnot(ctDat)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pseudoKnot_+3A_ctdat">ctDat</code></td>
<td>

<p>R data frame representing a CT file for RNA secondary structure
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list with the first item being a list of pseudoKnots and the second item being a CT file data frame with all pseudoKnots removed from the structure
</p>


<h3>Author(s)</h3>

<p>JP Bida
</p>


<h3>See Also</h3>

<p><code><a href="#topic+RNAPlot">RNAPlot</a></code>,
<code><a href="#topic+aptPlotCT">aptPlotCT</a></code>,
<code><a href="#topic+ct2coord">ct2coord</a></code>,
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pk=makeCt("((((...(((((((.........)))))))...((((.........))))...))))",
          "AAAAAAAACCCCCCCCAAAGGGGGGGAUUACCCCUCCUUUAAAAGGGUUUUCCCCCCC")
pk$bound[pk$pos==20]=42
pk$bound[pk$pos==19]=43
pk$bound[pk$pos==43]=19
pk$bound[pk$pos==42]=20

l=pseudoKnot(pk)

## Positions of removed pseudo knots ##
removed=l[[1]]

### clean ct file that can be used by ct2coord ###
ct=l[[2]]


</code></pre>

<hr>
<h2 id='RNAPlot'>
Generic RNA Secondary Structure Plotting Function
</h2><span id='topic+RNAPlot'></span>

<h3>Description</h3>

<p>Given fold data from loadFolds or ct2coords RNAPlot plots the secondary structure
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RNAPlot(data, ranges = 0, add = FALSE, hl = NULL, seqcols = NULL,
        seqTF = FALSE, labTF = FALSE, nt = FALSE, dp = 0.5,
        modspec = FALSE, modp = NULL, mod = NULL, modcol = NULL,
        tsize = 0.5, main = "", pointSize = 2, lineWd = 2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="RNAPlot_+3A_data">data</code></td>
<td>

<p>R data frame containing the coordinates for plotting a given secondary structure 
<code>
###  Example input file format: 
###  
###  0,158.534088,199.550888,G,0,-1
###  0,152.741776,194.100571,A,1,-1
###  0,149.307266,186.849899,A,2,-1
###  0,148.749847,178.776566,G,3,-1
###  0,151.196960,170.989944,C,4,59
###  0,141.412643,159.620361,U,5,58
###  0,131.628342,148.250793,U,6,57
###  0,121.844025,136.881210,A,7,56
###  0,112.059715,125.511642,C,8,55
###  0,102.275398,114.142059,A,9,54
###  0,89.142853,109.343330,A,10,-1
###  ....
###  
###  There is no header on the input file. The columns are 
###  ID,X,Y,SEQ,POS,BOUND
###  
###  ID - A unique ID for a given fold in the file 
###  X - X position of the NT in the secondary structure plot
###  Y - Y position of the NT in the secondary structure plot
###  SEQ - The nucleotide (A,G,U,C) 
###  POS - The position of the NT in the sequence
###  BOUND - The position of the NT that the NT at POS is bound to
</code>
</p>
</td></tr>
<tr><td><code id="RNAPlot_+3A_ranges">ranges</code></td>
<td>

<p>A data frame containing the ranges of sequence positions that should be highlighted with given colors.
<code>
ranges=data.frame(min=c(69,1,7),max=c(74,5,17),col=c(2,3,4),desc=c("Region 1","Region 2","Region 3"))
</code>
The above will highlight the nucleotides at positions 69-74, 1-5, and 7-17 respectively 
</p>
</td></tr>
<tr><td><code id="RNAPlot_+3A_add">add</code></td>
<td>

<p>Should the new plot be added to an existing plot TRUE/FALSE
</p>
</td></tr>
<tr><td><code id="RNAPlot_+3A_hl">hl</code></td>
<td>

<p>Takes an array of sequences and highlights them with seqcol
<code>hl=c("GGGAAAA","GGGCCCC")</code>
The above hl will highlight the nucleotides in the secondary structure that have the given sequences with the colors provided in the seqcols option.  
</p>
</td></tr>
<tr><td><code id="RNAPlot_+3A_seqcols">seqcols</code></td>
<td>

<p>Colors that should be used to highlight the sequences given in hl
</p>
</td></tr>
<tr><td><code id="RNAPlot_+3A_seqtf">seqTF</code></td>
<td>

<p>If sequence is a vector set as TRUE
</p>
</td></tr>
<tr><td><code id="RNAPlot_+3A_labtf">labTF</code></td>
<td>

<p>TRUE/FALSE plot the legend
</p>
</td></tr>
<tr><td><code id="RNAPlot_+3A_nt">nt</code></td>
<td>

<p>TRUE/FALSE plot the nucleotide sequence on the secondary structure
</p>
</td></tr>
<tr><td><code id="RNAPlot_+3A_dp">dp</code></td>
<td>

<p>Floating point value to determine how far from the coordinates the nucleotide sequence should be plotted. Values between 0 and 5 usually work best. 
</p>
</td></tr>
<tr><td><code id="RNAPlot_+3A_modspec">modspec</code></td>
<td>

<p>TRUE/FALSE modify specific positions in the secondary structure. Used in combination with modp,mod,and modcol. This allows you to change the shape and color of nucleotide in the secondary structure. 
</p>
</td></tr>
<tr><td><code id="RNAPlot_+3A_modp">modp</code></td>
<td>

<p>Array defining the specific positions to be modified in the plot
<code>
modp=c(1:10)
</code>
</p>
</td></tr>
<tr><td><code id="RNAPlot_+3A_mod">mod</code></td>
<td>

<p>Array defining the pch values to be plotted at the positions given by modp. 
<code>
mod=c(rep(15,5),rep(16,5))
</code>
</p>
</td></tr>
<tr><td><code id="RNAPlot_+3A_modcol">modcol</code></td>
<td>

<p>Array of color values to be used for plotting at the positions defined by modp in the secondary structure. 
<code>
modcol=rep(4,10)
</code>
</p>
</td></tr>
<tr><td><code id="RNAPlot_+3A_tsize">tsize</code></td>
<td>

<p>Text size used for plotting the nucleotide sequence in the secondary structure. Only applicable when nt=TRUE. Values between 0.1 and 4 work well. 
</p>
</td></tr>
<tr><td><code id="RNAPlot_+3A_main">main</code></td>
<td>

<p>Title used for the plot when labTF is set to TRUE.
</p>
</td></tr>
<tr><td><code id="RNAPlot_+3A_pointsize">pointSize</code></td>
<td>

<p>The size of points plotted in the secondary structure. Values betwen 0.1-5 work well.  
</p>
</td></tr>
<tr><td><code id="RNAPlot_+3A_linewd">lineWd</code></td>
<td>

<p>Line width for base pairings and backbone of secondary structures. 
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a generic R plot that can be used with the jpeg, postscript, etc. functions. 
</p>


<h3>Author(s)</h3>

<p>JP Bida
</p>


<h3>See Also</h3>

<p><code><a href="#topic+makeCt">makeCt</a></code>,<code><a href="#topic+loadCoords">loadCoords</a></code>,<code><a href="#topic+ct2coord">ct2coord</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Create a CT file from bracket notation and sequence ###
ct=makeCt( "((((...(((((((....)))))))...((((...))))...))))",
          "CCCCAAAGGGGGGGAUUACCCCUCCUUUAAAAGGGUUUUCCCCCCC"
)

## Create a coordinate file based on the CT file ###
dat=ct2coord(ct)

### Create a plot of the secondary structure ###
RNAPlot(dat)

### Plot positions 1:4 as green and 43:46 circles ## 
### and show the legend
ranges=data.frame(min=c(1,43),max=c(4,46),col=c(2,3),
                  desc=c("Region 1","Region 2")
                 )
RNAPlot(dat,ranges,labTF=TRUE)

### Highlight the sequences CUCCU and CCCCAAA ###

RNAPlot(dat,hl=c("CUCCU","CCCCAAA"),seqcol=c(2,4),labTF=TRUE,main="RNA Molecule")

### Modify specific positions ####

RNAPlot( dat, modspec=TRUE, modp=c(1:4,43:46),mod=c(17,17,15,15,16,16,16,16),
         modcol=c(rep(2,2),rep(3,2),rep(4,4))
       )

### RNA Plot with nucleotides ###
RNAPlot(dat,nt=TRUE)

### RNA plot with nucleotides
RNAPlot( dat,nt=TRUE,modspec=TRUE,modp=c(1:4,43:46),
         mod=c(17,17,15,15,16,16,16,16),
         modcol=c(rep(2,2),rep(3,2),rep(4,4))
       )

### RNA Plot wiht nucleotides and dots ###

RNAPlot(dat)
RNAPlot(dat,nt=TRUE,add=TRUE,dp=0.75)
</code></pre>

<hr>
<h2 id='rotateS'>
Internal function to rotate a single point
</h2><span id='topic+rotateS'></span>

<h3>Description</h3>

<p>Rotates a point a given angle around a given center point.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rotateS(x2, y2, x0, y0, ang)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rotateS_+3A_x2">x2</code></td>
<td>

<p>x coordinate of the position being rotated
</p>
</td></tr>
<tr><td><code id="rotateS_+3A_y2">y2</code></td>
<td>

<p>y coordinate of the position being rotated
</p>
</td></tr>
<tr><td><code id="rotateS_+3A_x0">x0</code></td>
<td>

<p>x coordinate of the center of rotation
</p>
</td></tr>
<tr><td><code id="rotateS_+3A_y0">y0</code></td>
<td>

<p>y coordinate of the center of rotation
</p>
</td></tr>
<tr><td><code id="rotateS_+3A_ang">ang</code></td>
<td>

<p>rotatation angle in radians
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a rotated point
</p>


<h3>Author(s)</h3>

<p>JP Bida
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Rotate a point 90 degress ###
rotateS(0,1,0,0,pi/2)
</code></pre>

<hr>
<h2 id='rotateV'>
internal function to rotate a vector of points
</h2><span id='topic+rotateV'></span>

<h3>Description</h3>

<p>Rotates a set of points around a center point a given number of radians
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rotateV(x2, y2, x0, y0, ang)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rotateV_+3A_x2">x2</code></td>
<td>

<p>Vector containing x coordinates being rotated
</p>
</td></tr>
<tr><td><code id="rotateV_+3A_y2">y2</code></td>
<td>

<p>Vector containing y coordinates being rotated
</p>
</td></tr>
<tr><td><code id="rotateV_+3A_x0">x0</code></td>
<td>

<p>x coordinate of center of rotation
</p>
</td></tr>
<tr><td><code id="rotateV_+3A_y0">y0</code></td>
<td>

<p>y coordinate of center of rotation
</p>
</td></tr>
<tr><td><code id="rotateV_+3A_ang">ang</code></td>
<td>

<p>Angle of rotation given in radians
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>set of rotated points
</p>


<h3>Author(s)</h3>

<p>JP Bida
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rotateS">rotateS</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x=c(1,0,-1,0)
y=c(0,1,0,-1)
pts=rotateV(x,y,0,0,pi/4)
</code></pre>

<hr>
<h2 id='stemCords'>
internal function that generates coordinates for a stem
</h2><span id='topic+stemCords'></span>

<h3>Description</h3>

<p>internal function that generates coordinates for an RNA secondary structure stem
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stemCords(input, p1, p2, x1, y1, x2, y2, x3, y3)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="stemCords_+3A_input">input</code></td>
<td>

<p>ct file as data frame
</p>
</td></tr>
<tr><td><code id="stemCords_+3A_p1">p1</code></td>
<td>

<p>index of nucleotide in first base pair of the stem
</p>
</td></tr>
<tr><td><code id="stemCords_+3A_p2">p2</code></td>
<td>

<p>index of nucleotide in first base pair of the stem
</p>
</td></tr>
<tr><td><code id="stemCords_+3A_x1">x1</code></td>
<td>

<p>x coordinate of p1
</p>
</td></tr>
<tr><td><code id="stemCords_+3A_y1">y1</code></td>
<td>

<p>y coordinate of p1
</p>
</td></tr>
<tr><td><code id="stemCords_+3A_x2">x2</code></td>
<td>

<p>x coordinate of p2 
</p>
</td></tr>
<tr><td><code id="stemCords_+3A_y2">y2</code></td>
<td>

<p>y coordinate of p2
</p>
</td></tr>
<tr><td><code id="stemCords_+3A_x3">x3</code></td>
<td>

<p>direction vector x component
</p>
</td></tr>
<tr><td><code id="stemCords_+3A_y3">y3</code></td>
<td>

<p>direction vector y component
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>set of points
</p>


<h3>Note</h3>

<p>This is an internal function not recommend for use out side of the ct2coord function
</p>


<h3>Author(s)</h3>

<p>JP Bida
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ct2coord">ct2coord</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Internal Function ###
</code></pre>

<hr>
<h2 id='transformFold'>
Internal function to translate and rotate a secondary structure plot
</h2><span id='topic+transformFold'></span>

<h3>Description</h3>

<p>Given a coordinate file, a point, and an angle in radians transformFold rotates the fold around the given point the given number of radians.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>transformFold(dat, x0, y0, ang)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="transformFold_+3A_dat">dat</code></td>
<td>

<p>Coordinate file containing multiple RNA folds
</p>
</td></tr>
<tr><td><code id="transformFold_+3A_x0">x0</code></td>
<td>

<p>x coordinate of center of rotation
</p>
</td></tr>
<tr><td><code id="transformFold_+3A_y0">y0</code></td>
<td>

<p>y coordinate of center of rotation
</p>
</td></tr>
<tr><td><code id="transformFold_+3A_ang">ang</code></td>
<td>

<p>angle of rotation in radians
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>dat frame containing the rotated coordinates
</p>


<h3>Author(s)</h3>

<p>JP Bida
</p>


<h3>See Also</h3>

<p><code><a href="#topic+alignCoord">alignCoord</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
ct=makeCt("((((...(((((((.........)))))))...((((.........))))...))))",
          "AAAAAAAACCCCCCCCAAAGGGGGGGAUUACCCCUCCUUUAAAAGGGUUUUCCCCCCC")

c1=ct2coord(ct)

RNAPlot(c1)

c2=transformFold(c1,0,0,pi/2)
c3=transformFold(c2,0,0,pi/2)
c4=transformFold(c3,0,0,pi/2)

RNAPlot(c2,add=TRUE)
RNAPlot(c3,add=TRUE)
RNAPlot(c4,add=TRUE)

</code></pre>

<hr>
<h2 id='translate'>
internal function for translating points
</h2><span id='topic+translate'></span>

<h3>Description</h3>

<p>internal function to translate points
</p>


<h3>Usage</h3>

<pre><code class='language-R'>translate(x1, y1, x2, y2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="translate_+3A_x1">x1</code></td>
<td>

<p>x coordinates being translated
</p>
</td></tr>
<tr><td><code id="translate_+3A_y1">y1</code></td>
<td>

<p>y coordinates being translated
</p>
</td></tr>
<tr><td><code id="translate_+3A_x2">x2</code></td>
<td>

<p>dx for translation
</p>
</td></tr>
<tr><td><code id="translate_+3A_y2">y2</code></td>
<td>

<p>dy for translation
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>set of points
</p>


<h3>Author(s)</h3>

<p>JP Bida
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Internal Function ##
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
