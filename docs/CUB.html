<!DOCTYPE html><html><head><title>Help for package CUB</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {CUB}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#auxmat'><p>Auxiliary matrix</p></a></li>
<li><a href='#betabinomial'><p>Beta-Binomial probabilities of ordinal responses, with feeling and overdispersion parameters</p>
for each observation</a></li>
<li><a href='#betabinomialcsi'><p>Beta-Binomial probabilities of ordinal responses, given feeling parameter for each observation</p></a></li>
<li><a href='#betar'><p>Beta-Binomial distribution</p></a></li>
<li><a href='#BIC.GEM'><p>S3 BIC method for class &quot;GEM&quot;</p></a></li>
<li><a href='#bitcsi'><p>Shifted Binomial probabilities of ordinal responses</p></a></li>
<li><a href='#bitgama'><p>Shifted Binomial distribution with covariates</p></a></li>
<li><a href='#chi2cub'><p>Pearson <code class="reqn">X^2</code> statistic</p></a></li>
<li><a href='#chi2cub1cov'><p>Pearson <code class="reqn">X^2</code> statistic  for CUB models with one discrete covariate for feeling</p></a></li>
<li><a href='#chi2cub2cov'><p>Pearson <code class="reqn">X^2</code> statistic  for CUB models with one discrete covariate for feeling</p></a></li>
<li><a href='#coef.GEM'><p>S3 Method: coef for class &quot;GEM&quot;</p></a></li>
<li><a href='#cormat'><p>Correlation matrix for estimated model</p></a></li>
<li><a href='#CUB'><p>Main function for CUB models</p></a></li>
<li><a href='#CUB_package'><p>CUB package</p></a></li>
<li><a href='#cub00'><p>Main function for CUB models without covariates</p></a></li>
<li><a href='#cub0q'><p>Main function for CUB models with covariates for the feeling component</p></a></li>
<li><a href='#CUBE'><p>Main function for CUBE models</p></a></li>
<li><a href='#cube000'><p>Main function for CUBE models without covariates</p></a></li>
<li><a href='#cubecov'><p>Main function for CUBE models with covariates</p></a></li>
<li><a href='#cubecsi'><p>Main function for CUBE models with covariates only for feeling</p></a></li>
<li><a href='#cubevisual'><p>Plot an estimated CUBE model</p></a></li>
<li><a href='#cubp0'><p>Main function for CUB models with covariates for the uncertainty component</p></a></li>
<li><a href='#cubpq'><p>Main function for CUB models with covariates for both the uncertainty and the feeling components</p></a></li>
<li><a href='#cubshe'><p>Main function for CUB models with a shelter effect</p></a></li>
<li><a href='#cubshevisual'><p>Plot an estimated CUB model with shelter</p></a></li>
<li><a href='#cubvisual'><p>Plot an estimated CUB model</p></a></li>
<li><a href='#CUSH'><p>Main function for CUSH models</p></a></li>
<li><a href='#cush00'><p>CUSH model without covariates</p></a></li>
<li><a href='#cushcov'><p>CUSH model with covariates</p></a></li>
<li><a href='#deltaprob'><p>Mean difference of a discrete random variable</p></a></li>
<li><a href='#dissim'><p>Normalized dissimilarity measure</p></a></li>
<li><a href='#effe01'><p>Auxiliary function for the log-likelihood estimation of CUB models</p></a></li>
<li><a href='#effe10'><p>Auxiliary function for the log-likelihood estimation of CUB models</p></a></li>
<li><a href='#effecube'><p>Auxiliary function for the log-likelihood estimation of CUBE models without covariates</p></a></li>
<li><a href='#effecubecsi'><p>Auxiliary function for the log-likelihood estimation of CUBE models with covariates</p>
only for the feeling component</a></li>
<li><a href='#effecush'><p>Auxiliary function for the log-likelihood estimation of CUSH models with covariates</p></a></li>
<li><a href='#effeihg'><p>Auxiliary function for the log-likelihood estimation of IHG models without covariates</p></a></li>
<li><a href='#effeihgcov'><p>Auxiliary function for the log-likelihood estimation of IHG models with covariates</p></a></li>
<li><a href='#ellecub'><p>Log-likelihood function of a CUB model without covariates</p></a></li>
<li><a href='#ellegecub'><p>Log-likelihood function for gecub distribution</p></a></li>
<li><a href='#expcub00'><p>Expectation of CUB distributions</p></a></li>
<li><a href='#expcube'><p>Expectation of CUBE models</p></a></li>
<li><a href='#fitted.GEM'><p>S3 method &quot;fitted&quot; for class &quot;GEM&quot;</p></a></li>
<li><a href='#gecubpqs'><p>Main function for CUB models with covariates for all the components</p></a></li>
<li><a href='#GEM'><p>Main function for GEM models</p></a></li>
<li><a href='#gini'><p>Normalized Gini heterogeneity index</p></a></li>
<li><a href='#Hadprod'><p>Hadamard product of a matrix with a vector</p></a></li>
<li><a href='#IHG'><p>Main function for IHG models</p></a></li>
<li><a href='#ihg00'><p>Main function for IHG models without covariates</p></a></li>
<li><a href='#ihgcov'><p>Main function for IHG models with covariates</p></a></li>
<li><a href='#inibest'><p>Preliminary estimators for CUB models without covariates</p></a></li>
<li><a href='#inibestcube'><p>Naive estimates for CUBE models without covariates</p></a></li>
<li><a href='#inibestcubecov'><p>Preliminary parameter estimates for CUBE models with covariates</p></a></li>
<li><a href='#inibestcubecsi'><p>Preliminary estimates of parameters for CUBE models with covariates only for feeling</p></a></li>
<li><a href='#inibestgama'><p>Preliminary parameter estimates of a CUB model with covariates for feeling</p></a></li>
<li><a href='#inigrid'><p>Grid-based preliminary parameter estimates for CUB models</p></a></li>
<li><a href='#iniihg'><p>Moment estimate for the preference parameter of the IHG distribution</p></a></li>
<li><a href='#kkk'><p>Sequence of combinatorial coefficients</p></a></li>
<li><a href='#laakso'><p>Normalized Laakso and Taagepera heterogeneity index</p></a></li>
<li><a href='#logis'><p>The logistic transform</p></a></li>
<li><a href='#logLik.GEM'><p>logLik S3 Method for class &quot;GEM&quot;</p></a></li>
<li><a href='#loglikCUB'><p>Log-likelihood function for CUB models</p></a></li>
<li><a href='#loglikcub00'><p>Log-likelihood function of a CUB model without covariates</p></a></li>
<li><a href='#loglikcub0q'><p>Log-likelihood function of a CUB model with covariates for the feeling component</p></a></li>
<li><a href='#loglikCUBE'><p>Log-likelihood function for CUBE models</p></a></li>
<li><a href='#loglikcubecov'><p>Log-likelihood function of a CUBE model with covariates</p></a></li>
<li><a href='#loglikcubecsi'><p>Log-likelihood function of CUBE model with covariates only for feeling</p></a></li>
<li><a href='#loglikcuben'><p>Log-likelihood function of CUBE models for ordinal data</p></a></li>
<li><a href='#loglikcubp0'><p>Log-likelihood function of a CUB model with covariates for the uncertainty component</p></a></li>
<li><a href='#loglikcubpq'><p>Log-likelihood function of a CUB model with covariates for both feeling and uncertainty</p></a></li>
<li><a href='#loglikcubshe'><p>Log-likelihood of a CUB model with shelter effect</p></a></li>
<li><a href='#loglikCUSH'><p>Log-likelihood function for CUSH models</p></a></li>
<li><a href='#loglikcush00'><p>Log-likelihood function for a CUSH model without covariates</p></a></li>
<li><a href='#loglikcushcov'><p>Log-likelihood function for a CUSH model with covariates</p></a></li>
<li><a href='#loglikIHG'><p>Log-likelihood function for IHG models</p></a></li>
<li><a href='#loglikihgcov'><p>Log-likelihood function for the IHG model with covariates</p></a></li>
<li><a href='#logscore'><p>Logarithmic score</p></a></li>
<li><a href='#makeplot'><p>Plot facilities for GEM objects</p></a></li>
<li><a href='#multicub'><p>Joint plot of estimated CUB models in the parameter space</p></a></li>
<li><a href='#multicube'><p>Joint plot of estimated CUBE models in the parameter space</p></a></li>
<li><a href='#parnames'><p>Generic function for coefficient names</p></a></li>
<li><a href='#plotloglikihg'><p>Plot of the log-likelihood function of the IHG distribution</p></a></li>
<li><a href='#print.GEM'><p>S3 method: print for class &quot;GEM&quot;</p></a></li>
<li><a href='#probbit'><p>Probability distribution of a shifted Binomial random variable</p></a></li>
<li><a href='#probcub00'><p>Probability distribution of a CUB model without covariates</p></a></li>
<li><a href='#probcub0q'><p>Probability distribution of a CUB model with covariates for the feeling component</p></a></li>
<li><a href='#probcube'><p>Probability distribution of a CUBE model without covariates</p></a></li>
<li><a href='#probcubp0'><p>Probability distribution of a CUB model with covariates for the uncertainty component</p></a></li>
<li><a href='#probcubpq'><p>Probability distribution of a CUB model with covariates for both feeling and uncertainty</p></a></li>
<li><a href='#probcubshe1'><p>probcubshe1</p></a></li>
<li><a href='#probcubshe2'><p>probcubshe2</p></a></li>
<li><a href='#probcubshe3'><p>probcubshe3</p></a></li>
<li><a href='#probcush'><p>Probability distribution of a CUSH model</p></a></li>
<li><a href='#probgecub'><p>Probability distribution of a GeCUB model</p></a></li>
<li><a href='#probihg'><p>Probability distribution of an IHG model</p></a></li>
<li><a href='#probihgcovn'><p>Probability distribution of an IHG model with covariates</p></a></li>
<li><a href='#Q2gecub'><p>Auxiliary function for the log-likelihood estimation of GeCUB models.</p></a></li>
<li><a href='#Qdue'><p>Auxiliary function for the log-likelihood estimation of CUBE models with covariates</p></a></li>
<li><a href='#Quno'><p>Auxiliary function for the log-likelihood estimation of CUBE models with covariates</p></a></li>
<li><a href='#Qunogecub'><p>Auxiliary function for the log-likelihood estimation of GeCUB models.</p></a></li>
<li><a href='#relgoods'><p>Relational goods and Leisure time dataset</p></a></li>
<li><a href='#simcub'><p>Simulation routine for CUB models</p></a></li>
<li><a href='#simcube'><p>Simulation routine for CUBE models</p></a></li>
<li><a href='#simcubshe'><p>Simulation routine for CUB models with shelter effect</p></a></li>
<li><a href='#simcush'><p>Simulation routine for CUSH models</p></a></li>
<li><a href='#simihg'><p>Simulation routine for IHG models</p></a></li>
<li><a href='#summary.GEM'><p>S3 method: summary for class &quot;GEM&quot;</p></a></li>
<li><a href='#univer'><p>Evaluation of the Orientation Services 2002</p></a></li>
<li><a href='#varcovcub00'><p>Variance-covariance matrix of a CUB model without covariates</p></a></li>
<li><a href='#varcovcub0q'><p>Variance-covariance matrix of CUB models with covariates for the feeling component</p></a></li>
<li><a href='#varcovcubecov'><p>Variance-covariance matrix of a CUBE model with covariates</p></a></li>
<li><a href='#varcovcubeexp'><p>Variance-covariance matrix for CUBE models based on the expected information matrix</p></a></li>
<li><a href='#varcovcubeobs'><p>Variance-covariance matrix for CUBE models based on the observed information matrix</p></a></li>
<li><a href='#varcovcubp0'><p>Variance-covariance matrix of CUB model with covariates for the uncertainty parameter</p></a></li>
<li><a href='#varcovcubpq'><p>Variance-covariance matrix of a CUB model with covariates for both uncertainty and feeling</p></a></li>
<li><a href='#varcovcubshe'><p>Variance-covariance matrix for CUB models with shelter effect</p></a></li>
<li><a href='#varcovgecub'><p>Variance-covariance matrix of a CUB model without covariates</p></a></li>
<li><a href='#varcub00'><p>Variance of CUB models without covariates</p></a></li>
<li><a href='#varcube'><p>Variance of CUBE models without covariates</p></a></li>
<li><a href='#varmatCUB'><p>Variance-covariance matrix for CUB models</p></a></li>
<li><a href='#varmatCUBE'><p>Variance-covariance matrix for CUBE models</p></a></li>
<li><a href='#vcov.GEM'><p>S3 method  vcov() for class &quot;GEM&quot;</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>A Class of Mixture Models for Ordinal Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.5</td>
</tr>
<tr>
<td>Description:</td>
<td>For ordinal rating data, estimate and test models within the family of CUB models and their extensions (where CUB stands for Combination of a discrete Uniform and a shifted Binomial distributions); Simulation routines, plotting facilities and fitting measures are also provided.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.15.2), Formula</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, digest</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-23 11:20:58 UTC; Rosaria</td>
</tr>
<tr>
<td>Author:</td>
<td>Maria Iannario [aut],
  Domenico Piccolo [aut],
  Rosaria Simone [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Rosaria Simone &lt;rosaria.simone@unina.it&gt;</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-23 12:00:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='auxmat'>Auxiliary matrix</h2><span id='topic+auxmat'></span>

<h3>Description</h3>

<p>Returns an auxiliary matrix needed for computing the variance-covariance matrix of a CUBE model with covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>auxmat(m, vettcsi, vettphi, a, b, c, d, e)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="auxmat_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="auxmat_+3A_vettcsi">vettcsi</code></td>
<td>
<p>Vector of the feeling parameters of the Beta-Binomial distribution, with length equal to the number of observations</p>
</td></tr>
<tr><td><code id="auxmat_+3A_vettphi">vettphi</code></td>
<td>
<p>Vector of the overdispersion parameters of the Beta-Binomial distribution, with length equal to the number of observations</p>
</td></tr>
<tr><td><code id="auxmat_+3A_a">a</code></td>
<td>
<p>Real number</p>
</td></tr>
<tr><td><code id="auxmat_+3A_b">b</code></td>
<td>
<p>Real number</p>
</td></tr>
<tr><td><code id="auxmat_+3A_c">c</code></td>
<td>
<p>Real number</p>
</td></tr>
<tr><td><code id="auxmat_+3A_d">d</code></td>
<td>
<p>Real number</p>
</td></tr>
<tr><td><code id="auxmat_+3A_e">e</code></td>
<td>
<p>Real number</p>
</td></tr>
</table>


<h3>References</h3>

<p>Iannario, M. (2014). Modelling Uncertainty and Overdispersion in Ordinal Data,
<em> Communications in Statistics- Theory and Methods</em>, <b>43</b>, 771&ndash;786 <br />
Piccolo, D. (2014). Inferential issues on CUBE models with covariates,
<em>Communications in Statistics. Theory and Methods</em>, <b>44</b>, DOI: 10.1080/03610926.2013.821487
</p>

<hr>
<h2 id='betabinomial'>Beta-Binomial probabilities of ordinal responses, with feeling and overdispersion parameters
for each observation</h2><span id='topic+betabinomial'></span>

<h3>Description</h3>

<p>Compute the Beta-Binomial probabilities of ordinal responses, given feeling and overdispersion
parameters for each observation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>betabinomial(m,ordinal,csivett,phivett)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="betabinomial_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="betabinomial_+3A_ordinal">ordinal</code></td>
<td>
<p>Vector of ordinal responses. Missing values are not allowed: they should be preliminarily deleted
or imputed</p>
</td></tr>
<tr><td><code id="betabinomial_+3A_csivett">csivett</code></td>
<td>
<p>Vector of feeling parameters of the Beta-Binomial distribution for given ordinal responses</p>
</td></tr>
<tr><td><code id="betabinomial_+3A_phivett">phivett</code></td>
<td>
<p>Vector of overdispersion parameters of the Beta-Binomial distribution for given ordinal
responses</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Beta-Binomial distribution is the Binomial distribution in which the probability of success at
each trial is random and follows the Beta distribution. It is frequently used in Bayesian
statistics, empirical Bayes methods and classical statistics as an overdispersed binomial distribution.
</p>


<h3>Value</h3>

<p>A vector of the same length as ordinal, containing the Beta-Binomial probabilities of each observation,
for the corresponding feeling and overdispersion parameters.
</p>


<h3>References</h3>

<p>Iannario, M. (2014). Modelling Uncertainty and Overdispersion in Ordinal Data,
<em>Communications in Statistics - Theory and Methods</em>, <b>43</b>, 771&ndash;786 <br />
Piccolo D. (2015). Inferential issues for CUBE models with covariates.
<em>Communications in Statistics - Theory and Methods</em>, <b>44</b>(23), 771&ndash;786.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+betar">betar</a></code>, <code><a href="#topic+betabinomialcsi">betabinomialcsi</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(relgoods)
m&lt;-10
ordinal&lt;-relgoods$Tv
age&lt;-2014-relgoods$BirthYear
no_na&lt;-na.omit(cbind(ordinal,age))
ordinal&lt;-no_na[,1]; age&lt;-no_na[,2]
lage&lt;-log(age)-mean(log(age))
gama&lt;-c(-0.6, -0.3)
csivett&lt;-logis(lage,gama)
alpha&lt;-c(-2.3,0.92); 
ZZ&lt;-cbind(1,lage)
phivett&lt;-exp(ZZ%*%alpha)
pr&lt;-betabinomial(m,ordinal,csivett,phivett)
plot(density(pr))
</code></pre>

<hr>
<h2 id='betabinomialcsi'>Beta-Binomial probabilities of ordinal responses, given feeling parameter for each observation</h2><span id='topic+betabinomialcsi'></span>

<h3>Description</h3>

<p>Compute the Beta-Binomial probabilities of given ordinal responses, with feeling
parameter specified for each observation,
and with the same overdispersion parameter for all the responses.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>betabinomialcsi(m,ordinal,csivett,phi)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="betabinomialcsi_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="betabinomialcsi_+3A_ordinal">ordinal</code></td>
<td>
<p>Vector of ordinal responses. Missing values are not allowed: they should be preliminarily deleted
or imputed</p>
</td></tr>
<tr><td><code id="betabinomialcsi_+3A_csivett">csivett</code></td>
<td>
<p>Vector of feeling parameters of the Beta-Binomial distribution for given ordinal
responses</p>
</td></tr>
<tr><td><code id="betabinomialcsi_+3A_phi">phi</code></td>
<td>
<p>Overdispersion parameter of the Beta-Binomial distribution</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of the same length as ordinal: each entry is the Beta-Binomial probability for the given observation
for the corresponding feeling and overdispersion parameters.
</p>


<h3>References</h3>

<p>Iannario, M. (2014). Modelling Uncertainty and Overdispersion in Ordinal Data,
<em>Communications in Statistics - Theory and Methods</em>, <b>43</b>, 771&ndash;786 <br />
Piccolo D. (2015). Inferential issues for CUBE models with covariates.
<em>Communications in Statistics - Theory and Methods</em>, <b>44</b>(23), 771&ndash;786.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+betar">betar</a></code>, <code><a href="#topic+betabinomial">betabinomial</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(relgoods)
m&lt;-10
ordinal&lt;-relgoods$Tv
age&lt;-2014-relgoods$BirthYear
no_na&lt;-na.omit(cbind(ordinal,age))
ordinal&lt;-no_na[,1]; age&lt;-no_na[,2]
lage&lt;-log(age)-mean(log(age))
gama&lt;-c(-0.61,-0.31)
phi&lt;-0.16 
csivett&lt;-logis(lage,gama)
pr&lt;-betabinomialcsi(m,ordinal,csivett,phi)
plot(density(pr))
</code></pre>

<hr>
<h2 id='betar'>Beta-Binomial distribution</h2><span id='topic+betar'></span>

<h3>Description</h3>

<p>Return the Beta-Binomial distribution with parameters <code class="reqn">m</code>, <code class="reqn">csi</code> and <code class="reqn">phi</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>betar(m,csi,phi)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="betar_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="betar_+3A_csi">csi</code></td>
<td>
<p>Feeling parameter of the Beta-Binomial distribution</p>
</td></tr>
<tr><td><code id="betar_+3A_phi">phi</code></td>
<td>
<p>Overdispersion parameter of the Beta-Binomial distribution</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The vector of length <code class="reqn">m</code> of the  Beta-Binomial distribution.
</p>


<h3>References</h3>

<p>Iannario, M. (2014). Modelling Uncertainty and Overdispersion in Ordinal Data,
<em>Communications in Statistics - Theory and Methods</em>, <b>43</b>, 771&ndash;786
</p>


<h3>See Also</h3>

<p><code><a href="#topic+betabinomial">betabinomial</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>m&lt;-9
csi&lt;-0.8
phi&lt;-0.2
pr&lt;-betar(m,csi,phi)
plot(1:m,pr,type="h", main="Beta-Binomial distribution",xlab="Ordinal categories")
points(1:m,pr,pch=19)
</code></pre>

<hr>
<h2 id='BIC.GEM'>S3 BIC method for class &quot;GEM&quot;</h2><span id='topic+BIC.GEM'></span>

<h3>Description</h3>

<p>S3 BIC method for objects of class <code><a href="#topic+GEM">GEM</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'GEM'
BIC(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BIC.GEM_+3A_object">object</code></td>
<td>
<p>An object of class &quot;GEM&quot;</p>
</td></tr>
<tr><td><code id="BIC.GEM_+3A_...">...</code></td>
<td>
<p>Other arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>BIC index for the fitted model.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+logLik">logLik</a></code>, <code><a href="#topic+GEM">GEM</a></code>
</p>

<hr>
<h2 id='bitcsi'>Shifted Binomial probabilities of ordinal responses</h2><span id='topic+bitcsi'></span>

<h3>Description</h3>

<p>Compute the shifted Binomial probabilities of ordinal responses.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bitcsi(m,ordinal,csi)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bitcsi_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="bitcsi_+3A_ordinal">ordinal</code></td>
<td>
<p>Vector of ordinal responses</p>
</td></tr>
<tr><td><code id="bitcsi_+3A_csi">csi</code></td>
<td>
<p>Feeling parameter of the shifted Binomial distribution</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of the same length as <code>ordinal</code>, where each entry is the shifted Binomial probability
of the corresponding observation.
</p>


<h3>References</h3>

<p>Piccolo D. (2003). On the moments of a mixture of uniform and shifted binomial random variables,
<em>Quaderni di Statistica</em>, <b>5</b>, 85&ndash;104
</p>


<h3>See Also</h3>

<p><code><a href="#topic+probcub00">probcub00</a></code>, <code><a href="#topic+probcubp0">probcubp0</a></code>,  <code><a href="#topic+probcub0q">probcub0q</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(univer)
m&lt;-7
csi&lt;-0.7
ordinal&lt;-univer$informat
pr&lt;-bitcsi(m,ordinal,csi)
</code></pre>

<hr>
<h2 id='bitgama'>Shifted Binomial distribution with covariates</h2><span id='topic+bitgama'></span>

<h3>Description</h3>

<p>Return the shifted Binomial probabilities of ordinal responses where the feeling component
is explained by covariates via a logistic link.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bitgama(m,ordinal,W,gama)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bitgama_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="bitgama_+3A_ordinal">ordinal</code></td>
<td>
<p>Vector of ordinal responses</p>
</td></tr>
<tr><td><code id="bitgama_+3A_w">W</code></td>
<td>
<p>Matrix of covariates for the feeling component</p>
</td></tr>
<tr><td><code id="bitgama_+3A_gama">gama</code></td>
<td>
<p>Vector of parameters for the feeling component, with length equal to
NCOL(W)+1 to account for an intercept term (first entry of <code>gama</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of the same length as <code>ordinal</code>, where each entry is the shifted Binomial probability for
the corresponding observation and feeling value.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+logis">logis</a></code>, <code><a href="#topic+probcub0q">probcub0q</a></code>, <code><a href="#topic+probcubpq">probcubpq</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n&lt;-100
m&lt;-7
W&lt;-sample(c(0,1),n,replace=TRUE)
gama&lt;-c(0.2,-0.2)
csivett&lt;-logis(W,gama)
ordinal&lt;-rbinom(n,m-1,csivett)+1
pr&lt;-bitgama(m,ordinal,W,gama)
</code></pre>

<hr>
<h2 id='chi2cub'>Pearson <code class="reqn">X^2</code> statistic</h2><span id='topic+chi2cub'></span>

<h3>Description</h3>

<p>Compute the <code class="reqn">X^2</code> statistic of Pearson for CUB models with one or two discrete
covariates for the feeling component.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chi2cub(m,ordinal,W,pai,gama)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="chi2cub_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="chi2cub_+3A_ordinal">ordinal</code></td>
<td>
<p>Vector of ordinal responses</p>
</td></tr>
<tr><td><code id="chi2cub_+3A_w">W</code></td>
<td>
<p>Matrix of covariates for the feeling component</p>
</td></tr>
<tr><td><code id="chi2cub_+3A_pai">pai</code></td>
<td>
<p>Uncertainty parameter</p>
</td></tr>
<tr><td><code id="chi2cub_+3A_gama">gama</code></td>
<td>
<p>Vector of parameters for the feeling component, with length equal to NCOL(W)+1
to account for an intercept term (first entry of <code>gama</code>)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>No missing value should be present neither
for <code>ordinal</code> nor for covariate matrices: thus, deletion or imputation procedures should be
preliminarily run.
</p>


<h3>Value</h3>

<p>A list with the following components:
</p>
<table>
<tr><td><code>df</code></td>
<td>
<p>Degrees of freedom</p>
</td></tr>
<tr><td><code>chi2</code></td>
<td>
<p>Value of the Pearson fitting measure</p>
</td></tr>
<tr><td><code>dev</code></td>
<td>
<p>Deviance indicator</p>
</td></tr>
</table>


<h3>References</h3>

<p>Tutz, G. (2012). <em>Regression for Categorical Data</em>, Cambridge University Press, Cambridge
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(univer)
m&lt;-7
pai&lt;-0.3
gama&lt;-c(0.1,0.7)
ordinal&lt;-univer$informat; W&lt;-univer$gender;
pearson&lt;-chi2cub(m,ordinal,W,pai,gama)
degfree&lt;-pearson$df
statvalue&lt;-pearson$chi2
deviance&lt;-pearson$dev
</code></pre>

<hr>
<h2 id='chi2cub1cov'>Pearson <code class="reqn">X^2</code> statistic  for CUB models with one discrete covariate for feeling</h2><span id='topic+chi2cub1cov'></span>

<h3>Description</h3>

<p>Compute the <code class="reqn">X^2</code> statistic of Pearson for the goodness of fit of a CUB model for ordinal responses, where the feeling parameter
is explained via a logistic transform of the only discrete covariate. It groups ratings in
classes according to the values of the covariate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chi2cub1cov(m, ordinal, covar, pai, gama)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="chi2cub1cov_+3A_m">m</code></td>
<td>
<p>Integer: number of ordinal categories</p>
</td></tr>
<tr><td><code id="chi2cub1cov_+3A_ordinal">ordinal</code></td>
<td>
<p>Vector of ordinal responses</p>
</td></tr>
<tr><td><code id="chi2cub1cov_+3A_covar">covar</code></td>
<td>
<p>Vector of the selected covariate for explaining the feeling component</p>
</td></tr>
<tr><td><code id="chi2cub1cov_+3A_pai">pai</code></td>
<td>
<p>Uncertainty parameter</p>
</td></tr>
<tr><td><code id="chi2cub1cov_+3A_gama">gama</code></td>
<td>
<p>Vector of parameters for the feeling component, with length equal to 2
to account for an intercept term (first entry)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>It returns the following results in a list:
</p>
<table>
<tr><td><code>df</code></td>
<td>
<p>Number of degrees of freedom</p>
</td></tr>
<tr><td><code>chi2</code></td>
<td>
<p>Value of the Pearson fitting measure</p>
</td></tr>
<tr><td><code>dev</code></td>
<td>
<p>Deviance indicator</p>
</td></tr>
</table>


<h3>References</h3>

<p>Tutz, G. (2011). <em>Regression for categorical data</em>, Cambridge Series in Statistical
and Probabilistic Mathematics
</p>

<hr>
<h2 id='chi2cub2cov'>Pearson <code class="reqn">X^2</code> statistic  for CUB models with one discrete covariate for feeling</h2><span id='topic+chi2cub2cov'></span>

<h3>Description</h3>

<p>Compute the <code class="reqn">X^2</code> statistic of Pearson for the goodness of fit of a CUB model for ordinal responses, where the feeling parameter
is explained via a logistic transform of the only discrete covariate. It groups ratings in
classes according to the values of the covariate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chi2cub2cov(m, ordinal, covar1, covar2, pai, gama)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="chi2cub2cov_+3A_m">m</code></td>
<td>
<p>Integer: number of ordinal categories</p>
</td></tr>
<tr><td><code id="chi2cub2cov_+3A_ordinal">ordinal</code></td>
<td>
<p>Vector of ordinal responses</p>
</td></tr>
<tr><td><code id="chi2cub2cov_+3A_covar1">covar1</code></td>
<td>
<p>Vector of the first covariate values for explaining the feeling component</p>
</td></tr>
<tr><td><code id="chi2cub2cov_+3A_covar2">covar2</code></td>
<td>
<p>Vector of the second covariate values for explaining the feeling component</p>
</td></tr>
<tr><td><code id="chi2cub2cov_+3A_pai">pai</code></td>
<td>
<p>Uncertainty parameter</p>
</td></tr>
<tr><td><code id="chi2cub2cov_+3A_gama">gama</code></td>
<td>
<p>Vector of parameters for the feeling component, with length equal to 2
to account for an intercept term (first entry)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>It returns the following results in a list:
</p>
<table>
<tr><td><code>df</code></td>
<td>
<p>Number of degrees of freedom</p>
</td></tr>
<tr><td><code>chi2</code></td>
<td>
<p>Value of the Pearson fitting measure</p>
</td></tr>
<tr><td><code>dev</code></td>
<td>
<p>Deviance indicator</p>
</td></tr>
</table>


<h3>References</h3>

<p>Tutz, G. (2011). <em>Regression for categorical data</em>, Cambridge Series in Statistical
and Probabilistic Mathematics
</p>

<hr>
<h2 id='coef.GEM'>S3 Method: coef for class &quot;GEM&quot;</h2><span id='topic+coef.GEM'></span>

<h3>Description</h3>

<p>S3 method: coef for objects of class <code><a href="#topic+GEM">GEM</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'GEM'
coef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef.GEM_+3A_object">object</code></td>
<td>
<p>An object of class <code><a href="#topic+GEM">GEM</a></code></p>
</td></tr>
<tr><td><code id="coef.GEM_+3A_...">...</code></td>
<td>
<p>Other arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Returns estimated values of coefficients of the fitted model
</p>


<h3>Value</h3>

<p>ML estimates of parameters of the fitted GEM model.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GEM">GEM</a></code>, <code><a href="base.html#topic+summary">summary</a></code>
</p>

<hr>
<h2 id='cormat'>Correlation matrix for estimated model</h2><span id='topic+cormat'></span>

<h3>Description</h3>

<p>Compute parameter correlation matrix for estimated model as returned by an object
of class &quot;GEM&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cormat(object,digits=options()$digits)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cormat_+3A_object">object</code></td>
<td>
<p>An object of class &quot;GEM&quot;</p>
</td></tr>
<tr><td><code id="cormat_+3A_digits">digits</code></td>
<td>
<p>Number of significant digits to be printed. Default is <code>options()$digits</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Parameters correlation matrix for fitted GEM models.
</p>


<h3>See Also</h3>

<p><code>GEM</code>, <code>vcov</code>
</p>

<hr>
<h2 id='CUB'>Main function for CUB models</h2><span id='topic+CUB'></span>

<h3>Description</h3>

<p>Main function to estimate and validate a CUB model for explaining uncertainty
and feeling for given ratings, with or without covariates and shelter effect.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CUB(Formula, data, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CUB_+3A_formula">Formula</code></td>
<td>
<p>Object of class Formula.</p>
</td></tr>
<tr><td><code id="CUB_+3A_data">data</code></td>
<td>
<p>Data frame from which model matrices and response variables are taken.</p>
</td></tr>
<tr><td><code id="CUB_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed for the specification of the model, including covariates matrices Y, W, X for
#' for uncertainty, feeling and shelter, respectively.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is the main function for CUB models, which calls for the corresponding functions whenever
covariates or shelter effect are specified. It performs maximum likelihood estimation via the E-M algorithm
for CUB models and extensions. The optimization procedure is run via &quot;optim&quot;.<br />
It is possible to fit data with CUB models, with or without covariates
for the parameters of the mixture model, and CUB models with shelter effect with no covariate included
in the model. The program also checks if the estimated variance-covariance matrix is positive definite:
if not, it prints a warning message and returns a matrix and related results with NA entries.
</p>


<h3>Value</h3>

<p>An object of the class &quot;GEM&quot;-CUB&quot;: returns a list containing the following results:
</p>
<table>
<tr><td><code>estimates</code></td>
<td>
<p>Maximum likelihood estimates: <code class="reqn">(\pi, \xi)</code></p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p>Log-likelihood function at the final estimates</p>
</td></tr>
<tr><td><code>varmat</code></td>
<td>
<p>Variance-covariance matrix of final estimates</p>
</td></tr>
<tr><td><code>niter</code></td>
<td>
<p>Number of executed iterations</p>
</td></tr>
<tr><td><code>BIC</code></td>
<td>
<p>BIC index for the estimated model</p>
</td></tr>
</table>


<h3>References</h3>

<p>Piccolo D. and D'Elia A. (2008). A new approach for modelling consumers' preferences, <em>Food Quality and Preference</em>,
<b>18</b>, 247&ndash;259 <br />
Iannario M. and Piccolo D. (2012). CUB models: Statistical methods and empirical evidence, in:
Kenett R. S. and Salini S. (eds.), <em>Modern Analysis of Customer Surveys: with applications using R</em>,
J. Wiley and Sons, Chichester, 231&ndash;258<br />
Iannario M. (2012). Modelling <em>shelter</em> choices in a class of mixture models for ordinal responses,
<em>Statistical Methods and Applications</em>, <b>21</b>, 1&ndash;22 <br />
Iannario M. and Piccolo D. (2014). Inference for CUB models: a program in R, <em>Statistica &amp; Applicazioni</em>,
<b>XII</b> n.2, 177&ndash;204 <br />
Iannario M. (2016). Testing the overdispersion parameter in CUBE models,
<em>Communications in Statistics: Simulation and Computation</em>, <b>45</b>(5), 1621&ndash;1635
</p>


<h3>See Also</h3>

<p><code><a href="#topic+probcub00">probcub00</a></code>, <code><a href="#topic+probcubp0">probcubp0</a></code>, <code><a href="#topic+probcub0q">probcub0q</a></code>, <code><a href="#topic+probcubpq">probcubpq</a></code>,
<code><a href="#topic+probcubshe1">probcubshe1</a></code>, <code><a href="#topic+loglikCUB">loglikCUB</a></code>, <code><a href="#topic+varmatCUB">varmatCUB</a></code>
</p>

<hr>
<h2 id='CUB_package'>CUB package</h2><span id='topic+CUB_package'></span>

<h3>Description</h3>

<p>The analysis of human perceptions is often carried out by resorting to questionnaires,
where respondents are asked to express ratings about the items being evaluated. The standard goal of the
statistical framework proposed for this kind of data (e.g. cumulative models) is to explicitly characterize
the respondents' perceptions about a latent trait, by taking into account, at the same time,
the ordinal categorical scale of measurement of the   involved statistical variables.<br />
The new class of models starts from a particular assumption about the unconscious mechanism leading individuals' responses
to choose an ordinal category on a rating scale. The basic idea derives from the awareness that two latent
components move the psychological process of selection among discrete alternatives: attractiveness
towards the item and uncertainty in the response. Both components of models concern the stochastic
mechanism in term of feeling, which is an internal/personal movement of the subject towards the item,
and uncertainty pertaining to the final choice.<br />
Thus, on the basis of experimental data and statistical motivations, the response distribution is modelled
as the convex Combination of a discrete Uniform and a shifted Binomial random variable (denoted as CUB model)
whose parameters may be consistently estimated and validated by maximum likelihood inference.
In addition, subjects' and objects' covariates can be included in the model in order to assess how the
characteristics of the respondents may affect the ordinal score. <br />
CUB models have been firstly introduced by Piccolo (2003) and implemented on real datasets concerning ratings and rankings
by D'Elia and Piccolo (2005). <br />
The CUB package allows the user to estimate and test CUB models and their extensions by using maximum
likelihood methods: see Piccolo and Simone (2019a, 2019b) for an updated overview of methodological developments and applications.
The accompanying vignettes supplies the user with detailed usage instructions and examples. <br />
Acknowledgements: The Authors are grateful to Maria Antonietta Del Ferraro, Francesco Miranda and
Giuseppe Porpora for their preliminary support in the implementation of the first version of the package.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> CUB</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.1.4</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2017-10-11</td>
</tr>
<tr>
 <td style="text-align: left;">
License: GPL-2 | GPL-3
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Maria Iannario, Domenico Piccolo, Rosaria Simone
</p>


<h3>References</h3>

<p>D'Elia A. (2003). Modelling ranks using the inverse hypergeometric distribution,
<em>Statistical Modelling: an International Journal</em>, <b>3</b>, 65&ndash;78 <br />
Piccolo D. (2003). On the moments of a mixture of uniform and shifted binomial random variables,
<em>Quaderni di Statistica</em>, <b>5</b>, 85&ndash;104 <br />
D'Elia A. and Piccolo D. (2005).  A mixture model for preferences data analysis,
<em>Computational Statistics &amp; Data Analysis</em>,  <b>49</b>, 917&ndash;937 <br />
Piccolo D. and Simone R. (2019a).  The class of CUB models: statistical foundations, inferential issues and empirical evidence.
<em>Statistical Methods and Applications</em>, <b>28</b>(3), 389&ndash;435.<br />
Piccolo D. and Simone R. (2019b). Rejoinder to the discussions: The class of CUB models: statistical foundations, inferential issues and empirical evidence.
<em>Statistical Methods and Applications</em>, <b>28</b>(3), 477-493.<br />
Capecchi S. and Piccolo D. (2017). Dealing with heterogeneity in ordinal responses,
<em>Quality and Quantity</em>, <b>51</b>(5), 2375&ndash;2393 <br />
<em>Metron</em>, <b>74</b>(2), 233&ndash;252.<br />
Iannario M. and Piccolo D. (2016b). A generalized framework for modelling ordinal data.
<em>Statistical Methods and Applications</em>, <b>25</b>, 163&ndash;189.<br />
</p>

<hr>
<h2 id='cub00'>Main function for CUB models without covariates</h2><span id='topic+cub00'></span>

<h3>Description</h3>

<p>Function to estimate and validate a CUB model without covariates for given ordinal responses.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cub00(m, ordinal, maxiter, toler)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cub00_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="cub00_+3A_ordinal">ordinal</code></td>
<td>
<p>Vector of ordinal responses</p>
</td></tr>
<tr><td><code id="cub00_+3A_maxiter">maxiter</code></td>
<td>
<p>Maximum number of iterations allowed for running the optimization algorithm</p>
</td></tr>
<tr><td><code id="cub00_+3A_toler">toler</code></td>
<td>
<p>Fixed error tolerance for final estimates</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of the class &quot;CUB&quot;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CUB">CUB</a></code>, <code><a href="#topic+probbit">probbit</a></code>, <code><a href="#topic+probcub00">probcub00</a></code>, <code><a href="#topic+loglikCUB">loglikCUB</a></code>
</p>

<hr>
<h2 id='cub0q'>Main function for CUB models with covariates for the feeling component</h2><span id='topic+cub0q'></span>

<h3>Description</h3>

<p>Function to estimate and validate a CUB model for given ordinal responses, with covariates for
explaining the feeling component.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cub0q(m, ordinal, W, maxiter, toler)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cub0q_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="cub0q_+3A_ordinal">ordinal</code></td>
<td>
<p>Vector of ordinal responses</p>
</td></tr>
<tr><td><code id="cub0q_+3A_w">W</code></td>
<td>
<p>Matrix of selected covariates for explaining the feeling component, not including intercept</p>
</td></tr>
<tr><td><code id="cub0q_+3A_maxiter">maxiter</code></td>
<td>
<p>Maximum number of iterations allowed for running the optimization algorithm</p>
</td></tr>
<tr><td><code id="cub0q_+3A_toler">toler</code></td>
<td>
<p>Fixed error tolerance for final estimates</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of the class &quot;CUB&quot;
</p>


<h3>References</h3>

<p>Piccolo D. and D'Elia A. (2008), A new approach for modelling consumers' preferences,
<em>Food Quality and Preference</em>, <b>18</b>, 247&ndash;259 <br />
</p>
<p>Iannario M. and Piccolo D. (2010), A new statistical model for the analysis of customer
satisfaction, #' <em>Quality Technology and Quantity management</em>, <b>7</b>(2) 149&ndash;168 <br />
Iannario M. and Piccolo D. (2012), CUB models: Statistical methods and empirical evidence, in:
Kenett R. S. and Salini S. (eds.), <em>Modern Analysis of Customer Surveys: with applications using R</em>,
J. Wiley and Sons, Chichester, 231&ndash;258.
</p>

<hr>
<h2 id='CUBE'>Main function for CUBE models</h2><span id='topic+CUBE'></span>

<h3>Description</h3>

<p>Main function to estimate and validate a CUBE model for given ratings,
explaining uncertainty, feeling and overdispersion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CUBE(Formula,data,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CUBE_+3A_formula">Formula</code></td>
<td>
<p>Object of class Formula.</p>
</td></tr>
<tr><td><code id="CUBE_+3A_data">data</code></td>
<td>
<p>Data frame from which model matrices and response variables are taken.</p>
</td></tr>
<tr><td><code id="CUBE_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed for the specification of the model, Including Y, W, Z for
explanatory variables for uncertainty, feeling and overdispersion. Set expinform=TRUE if inference should
be based on expected information matrix for model with no covariate. Set starting = ... to pass initial
values for EM iterations.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is the main function for CUBE models, calling for the corresponding functions whenever
covariates are specified: it is possible to select covariates for explaining all the three parameters
or only the feeling component. <br />
The program also checks if the estimated variance-covariance matrix is positive definite: if not,
it prints a warning message and returns a matrix and related results with NA entries.
The optimization procedure is run via &quot;optim&quot;. If covariates are included only for feeling,
the variance-covariance matrix is computed as the inverse of the returned numerically differentiated
Hessian matrix (option: hessian=TRUE as argument for &quot;optim&quot;), and the estimation procedure is not
iterative, so a NULL result for $niter is produced.
If the estimated variance-covariance matrix is not positive definite, the function returns a
warning message and produces a matrix with NA entries.
</p>


<h3>Value</h3>

<p>An object of the class &quot;GEM&quot;-&quot;CUBE&quot; is a list containing the following results:
</p>
<table>
<tr><td><code>estimates</code></td>
<td>
<p>Maximum likelihood estimates: <code class="reqn">(\pi, \xi, \phi)</code></p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p>Log-likelihood function at the final estimates</p>
</td></tr>
<tr><td><code>varmat</code></td>
<td>
<p>Variance-covariance matrix of final estimates</p>
</td></tr>
<tr><td><code>niter</code></td>
<td>
<p>Number of executed iterations</p>
</td></tr>
<tr><td><code>BIC</code></td>
<td>
<p>BIC index for the estimated model</p>
</td></tr>
</table>


<h3>References</h3>

<p>Iannario M. (2014). Modelling Uncertainty and Overdispersion in Ordinal Data,
<em>Communications in Statistics - Theory and Methods</em>, <b>43</b>, 771&ndash;786 <br />
Piccolo D. (2015). Inferential issues for CUBE models with covariates,
<em>Communications in Statistics. Theory and Methods</em>, <b>44</b>(23), 771&ndash;786. <br />
Iannario M. (2015). Detecting latent components in ordinal data with overdispersion by means
of a mixture distribution, <em>Quality &amp; Quantity</em>, <b>49</b>, 977&ndash;987 <br />
Iannario M. (2016). Testing the overdispersion parameter in CUBE models.
<em>Communications in Statistics: Simulation and Computation</em>, <b>45</b>(5), 1621&ndash;1635.<br />
</p>


<h3>See Also</h3>

<p><code><a href="#topic+probcube">probcube</a></code>, <code><a href="#topic+loglikCUBE">loglikCUBE</a></code>, <code><a href="#topic+loglikcuben">loglikcuben</a></code>,  <code><a href="#topic+inibestcube">inibestcube</a></code>,
<code><a href="#topic+inibestcubecsi">inibestcubecsi</a></code>, <code><a href="#topic+inibestcubecov">inibestcubecov</a></code>,
<code><a href="#topic+varmatCUBE">varmatCUBE</a></code>
</p>

<hr>
<h2 id='cube000'>Main function for CUBE models without covariates</h2><span id='topic+cube000'></span>

<h3>Description</h3>

<p>Estimate and validate a CUBE model without covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cube000(m, ordinal, starting, maxiter, toler, expinform)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cube000_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="cube000_+3A_ordinal">ordinal</code></td>
<td>
<p>Vector of ordinal responses</p>
</td></tr>
<tr><td><code id="cube000_+3A_starting">starting</code></td>
<td>
<p>Vector of initial estimates to start the optimization algorithm,
whose length equals the number of parameters of the model</p>
</td></tr>
<tr><td><code id="cube000_+3A_maxiter">maxiter</code></td>
<td>
<p>Maximum number of iterations allowed for running the optimization algorithm</p>
</td></tr>
<tr><td><code id="cube000_+3A_toler">toler</code></td>
<td>
<p>Fixed error tolerance for final estimates</p>
</td></tr>
<tr><td><code id="cube000_+3A_expinform">expinform</code></td>
<td>
<p>Logical: if TRUE, the function returns the expected variance-covariance matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of the class &quot;CUBE&quot;
</p>


<h3>References</h3>

<p>Iannario, M. (2014). Modelling Uncertainty and Overdispersion in Ordinal Data,
<em>Communications in Statistics - Theory and Methods</em>, <b>43</b>, 771&ndash;786 <br />
Iannario, M. (2015). Detecting latent components in ordinal data with overdispersion by means
of a mixture distribution, <em>Quality &amp; Quantity</em>, <b>49</b>, 977&ndash;987
</p>

<hr>
<h2 id='cubecov'>Main function for CUBE models with covariates</h2><span id='topic+cubecov'></span>

<h3>Description</h3>

<p>Function to estimate and validate a CUBE model with
explicative covariates for all the three parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cubecov(m, ordinal, Y, W, Z, starting, maxiter, toler)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cubecov_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="cubecov_+3A_ordinal">ordinal</code></td>
<td>
<p>Vector of ordinal responses</p>
</td></tr>
<tr><td><code id="cubecov_+3A_y">Y</code></td>
<td>
<p>Matrix of selected covariates for explaining the uncertainty component</p>
</td></tr>
<tr><td><code id="cubecov_+3A_w">W</code></td>
<td>
<p>Matrix of selected covariates for explaining the feeling component</p>
</td></tr>
<tr><td><code id="cubecov_+3A_z">Z</code></td>
<td>
<p>Matrix of selected covariates for explaining the overdispersion component</p>
</td></tr>
<tr><td><code id="cubecov_+3A_starting">starting</code></td>
<td>
<p>Vector of initial parameters estimates to start the optimization algorithm
(it has length NCOL(Y) + NCOL(W) + NCOL(Z) + 3 to account for intercept terms
for all the three components</p>
</td></tr>
<tr><td><code id="cubecov_+3A_maxiter">maxiter</code></td>
<td>
<p>Maximum number of iterations allowed for running the optimization algorithm</p>
</td></tr>
<tr><td><code id="cubecov_+3A_toler">toler</code></td>
<td>
<p>Fixed error tolerance for final estimates</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of the class &quot;CUBE&quot;
</p>


<h3>References</h3>

<p>Piccolo, D. (2014). Inferential issues on CUBE models with covariates,
<em>Communications in Statistics - Theory and Methods</em>, <b>44</b>,
DOI: 10.1080/03610926.2013.821487
</p>

<hr>
<h2 id='cubecsi'>Main function for CUBE models with covariates only for feeling</h2><span id='topic+cubecsi'></span>

<h3>Description</h3>

<p>Estimate and validate a CUBE model for ordinal data, with covariates only for explaining the
feeling component.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cubecsi(m, ordinal, W, starting, maxiter, toler)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cubecsi_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="cubecsi_+3A_ordinal">ordinal</code></td>
<td>
<p>Vector of ordinal responses</p>
</td></tr>
<tr><td><code id="cubecsi_+3A_w">W</code></td>
<td>
<p>Matrix of selected covariates for explaining the feeling component</p>
</td></tr>
<tr><td><code id="cubecsi_+3A_starting">starting</code></td>
<td>
<p>Vector of initial parameters estimates to start the optimization algorithm, with length equal to
NCOL(W) + 3 to account for an intercept term for the feeling component (first entry)</p>
</td></tr>
<tr><td><code id="cubecsi_+3A_maxiter">maxiter</code></td>
<td>
<p>Maximum number of iterations allowed for running the optimization algorithm</p>
</td></tr>
<tr><td><code id="cubecsi_+3A_toler">toler</code></td>
<td>
<p>Fixed error tolerance for final estimates</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of the class &quot;CUBE&quot;. For cubecsi, $niter will return a NULL value since the optimization procedure
is not iterative but based on &quot;optim&quot; (method = &quot;L-BFGS-B&quot;, option hessian=TRUE). <br /> $varmat will return the inverse
of the numerically computed Hessian when it is positive definite, otherwise the procedure will return a matrix of NA
entries.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+loglikcubecsi">loglikcubecsi</a></code>,  <code><a href="#topic+inibestcubecsi">inibestcubecsi</a></code>,  <code><a href="#topic+CUBE">CUBE</a></code>
</p>

<hr>
<h2 id='cubevisual'>Plot an estimated CUBE model</h2><span id='topic+cubevisual'></span>

<h3>Description</h3>

<p>Plotting facility for the CUBE estimation of ordinal responses.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cubevisual(ordinal,csiplot=FALSE,paiplot=FALSE,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cubevisual_+3A_ordinal">ordinal</code></td>
<td>
<p>Vector of ordinal responses</p>
</td></tr>
<tr><td><code id="cubevisual_+3A_csiplot">csiplot</code></td>
<td>
<p>Logical: should <code class="reqn">\xi</code> or <code class="reqn">1-\xi</code> be the <code class="reqn">y</code> coordinate</p>
</td></tr>
<tr><td><code id="cubevisual_+3A_paiplot">paiplot</code></td>
<td>
<p>Logical: should <code class="reqn">\pi</code> or <code class="reqn">1-\pi</code> be the <code class="reqn">x</code> coordinate</p>
</td></tr>
<tr><td><code id="cubevisual_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to <code>plot()</code> and <code>text()</code>. Optionally, the number <code>m</code>
of ordinal categories may be passed: this is recommended if some category has zero frequency.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It represents an estimated CUBE model as a point
in the parameter space with the overdispersion being labeled.
</p>


<h3>Value</h3>

<p>For a CUBE model fitted to <code>ordinal</code>, by default it returns a plot of the estimated
<code class="reqn">(1-\pi, 1-\xi)</code> as a point in the parameter space, labeled with the estimated overdispersion <code class="reqn">\phi</code>.
Depending on <code>csiplot</code> and <code>paiplot</code> and on desired output, <code class="reqn">x</code> and <code class="reqn">y</code> coordinates may be set
to <code class="reqn">\pi</code> and <code class="reqn">\xi</code>, respectively.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(univer)
ordinal&lt;-univer$global
cubevisual(ordinal,xlim=c(0,0.5),main="Global Satisfaction",
   ylim=c(0.5,1),cex=0.8,digits=3,col="red")
</code></pre>

<hr>
<h2 id='cubp0'>Main function for CUB models with covariates for the uncertainty component</h2><span id='topic+cubp0'></span>

<h3>Description</h3>

<p>Estimate and validate a CUB model for given ordinal responses, with covariates for explaining
the feeling component via a logistic transform.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cubp0(m, ordinal, Y, maxiter, toler)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cubp0_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="cubp0_+3A_ordinal">ordinal</code></td>
<td>
<p>Vector of ordinal responses</p>
</td></tr>
<tr><td><code id="cubp0_+3A_y">Y</code></td>
<td>
<p>Matrix of selected covariates for explaining the uncertainty component</p>
</td></tr>
<tr><td><code id="cubp0_+3A_maxiter">maxiter</code></td>
<td>
<p>Maximum number of iterations allowed for running the optimization algorithm</p>
</td></tr>
<tr><td><code id="cubp0_+3A_toler">toler</code></td>
<td>
<p>Fixed error tolerance for final estimates</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of the class &quot;CUB&quot;
</p>


<h3>References</h3>

<p>Iannario M. and Piccolo D. (2010), A new statistical model for the analysis of customer satisfaction,
<em>Quality Technology and Quantity management</em>, <b>7</b>(2) 149&ndash;168 <br />
Iannario M. and Piccolo D. (2012). CUB models: Statistical methods and empirical evidence, in:
Kenett R. S. and Salini S. (eds.), <em>Modern Analysis of Customer Surveys: with applications using R</em>,
J. Wiley and Sons, Chichester, 231&ndash;258
</p>

<hr>
<h2 id='cubpq'>Main function for CUB models with covariates for both the uncertainty and the feeling components</h2><span id='topic+cubpq'></span>

<h3>Description</h3>

<p>Estimate and validate a CUB model for given ordinal responses, with covariates for explaining both the
feeling and the uncertainty components by means of logistic transform.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cubpq(m, ordinal, Y, W, maxiter, toler)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cubpq_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="cubpq_+3A_ordinal">ordinal</code></td>
<td>
<p>Vector of ordinal responses</p>
</td></tr>
<tr><td><code id="cubpq_+3A_y">Y</code></td>
<td>
<p>Matrix of selected covariates for explaining the uncertainty component</p>
</td></tr>
<tr><td><code id="cubpq_+3A_w">W</code></td>
<td>
<p>Matrix of selected covariates for explaining the feeling component</p>
</td></tr>
<tr><td><code id="cubpq_+3A_maxiter">maxiter</code></td>
<td>
<p>Maximum number of iterations allowed for running the optimization algorithm</p>
</td></tr>
<tr><td><code id="cubpq_+3A_toler">toler</code></td>
<td>
<p>Fixed error tolerance for final estimates</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of the class &quot;CUB&quot;
</p>


<h3>References</h3>

<p>Piccolo D. and D'Elia A. (2008), A new approach for modelling consumers' preferences, <em>Food Quality and Preference</em>,
<b>18</b>, 247&ndash;259 <br />
Iannario M. and Piccolo D. (2010), A new statistical model for the analysis of customer satisfaction,
<em>Quality Technology and Quantitative Management</em>, <b>17</b>(2)  149&ndash;168
</p>


<h3>See Also</h3>

<p><code><a href="#topic+varcovcubpq">varcovcubpq</a></code>, <code><a href="#topic+loglikcubpq">loglikcubpq</a></code>, <code><a href="#topic+inibestgama">inibestgama</a></code>, <code><a href="#topic+CUB">CUB</a></code>
</p>

<hr>
<h2 id='cubshe'>Main function for CUB models with a shelter effect</h2><span id='topic+cubshe'></span>

<h3>Description</h3>

<p>Estimate and validate a CUB model with a shelter effect.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cubshe(m, ordinal, shelter, maxiter, toler)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cubshe_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="cubshe_+3A_ordinal">ordinal</code></td>
<td>
<p>Vector of ordinal responses</p>
</td></tr>
<tr><td><code id="cubshe_+3A_shelter">shelter</code></td>
<td>
<p>Category corresponding to the shelter choice</p>
</td></tr>
<tr><td><code id="cubshe_+3A_maxiter">maxiter</code></td>
<td>
<p>Maximum number of iterations allowed for running the optimization algorithm</p>
</td></tr>
<tr><td><code id="cubshe_+3A_toler">toler</code></td>
<td>
<p>Fixed error tolerance for final estimates</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of the class &quot;CUB&quot;
</p>


<h3>References</h3>

<p>Iannario M. (2012). Modelling <em>shelter</em> choices in a class of mixture models for ordinal responses,
<em>Statistical Methods and Applications</em>, <b>21</b>, 1&ndash;22
</p>

<hr>
<h2 id='cubshevisual'>Plot an estimated CUB model with shelter</h2><span id='topic+cubshevisual'></span>

<h3>Description</h3>

<p>Plotting facility for the CUB estimation of ordinal responses when a shelter effect is included
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cubshevisual(ordinal,shelter,csiplot=FALSE,paiplot=FALSE,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cubshevisual_+3A_ordinal">ordinal</code></td>
<td>
<p>Vector of ordinal responses</p>
</td></tr>
<tr><td><code id="cubshevisual_+3A_shelter">shelter</code></td>
<td>
<p>Category corresponding to the shelter choice</p>
</td></tr>
<tr><td><code id="cubshevisual_+3A_csiplot">csiplot</code></td>
<td>
<p>Logical: should <code class="reqn">\xi</code> or <code class="reqn">1-\xi</code> be the <code class="reqn">y</code> coordinate</p>
</td></tr>
<tr><td><code id="cubshevisual_+3A_paiplot">paiplot</code></td>
<td>
<p>Logical: should <code class="reqn">\pi</code> or <code class="reqn">1-\pi</code> be the <code class="reqn">x</code> coordinate</p>
</td></tr>
<tr><td><code id="cubshevisual_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to <code>plot()</code> and <code>text()</code>. Optionally, the number <code>m</code>
of ordinal categories may be passed: this is recommended if some category has zero frequency.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It represents an estimated CUB model with shelter effect as a point
in the parameter space with shelter estimate indicated as label.
</p>


<h3>Value</h3>

<p>For a CUB model with shelter fitted to <code>ordinal</code>, by default it returns a plot of the estimated
<code class="reqn">(1-\pi, 1-\xi)</code> as a point in the parameter space, labeled with the estimated shelter parameter <code class="reqn">\delta</code>.
Depending on <code>csiplot</code> and <code>paiplot</code> and on desired output, <code class="reqn">x</code> and <code class="reqn">y</code> coordinates may be set
to <code class="reqn">\pi</code> and <code class="reqn">\xi</code>, respectively.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cubvisual">cubvisual</a></code>, <code><a href="#topic+multicub">multicub</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(univer)
ordinal&lt;-univer$global
cubshevisual(ordinal,shelter=7,digits=3,col="blue",main="Global Satisfaction")
</code></pre>

<hr>
<h2 id='cubvisual'>Plot an estimated CUB model</h2><span id='topic+cubvisual'></span>

<h3>Description</h3>

<p>Plotting facility for the CUB estimation of ordinal responses.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cubvisual(ordinal,csiplot=FALSE,paiplot=FALSE,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cubvisual_+3A_ordinal">ordinal</code></td>
<td>
<p>Vector of ordinal responses</p>
</td></tr>
<tr><td><code id="cubvisual_+3A_csiplot">csiplot</code></td>
<td>
<p>Logical: should <code class="reqn">\xi</code> or <code class="reqn">1-\xi</code> be the <code class="reqn">y</code> coordinate</p>
</td></tr>
<tr><td><code id="cubvisual_+3A_paiplot">paiplot</code></td>
<td>
<p>Logical: should <code class="reqn">\pi</code> or <code class="reqn">1-\pi</code> be the <code class="reqn">x</code> coordinate</p>
</td></tr>
<tr><td><code id="cubvisual_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to <code>plot()</code> and <code>text()</code>. Optionally, the number
<code>m</code> of ordinal categories may be passed: this is recommended if some category has zero frequency.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It represents an estimated CUB model as a point
in the parameter space with some useful options.
</p>


<h3>Value</h3>

<p>For a CUB model fit to <code>ordinal</code>, by default it returns a plot of the estimated
<code class="reqn">(1-\pi, 1-\xi)</code> as a point in the parameter space. Depending on <code>csiplot</code> and <code>paiplot</code>
and on desired output, <code class="reqn">x</code> and <code class="reqn">y</code> coordinates may be set to <code class="reqn">\pi</code> and <code class="reqn">\xi</code>, respectively.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(univer)
ordinal&lt;-univer$global
cubvisual(ordinal,xlim=c(0,0.5),ylim=c(0.5,1),cex=0.8,main="Global Satisfaction")
</code></pre>

<hr>
<h2 id='CUSH'>Main function for CUSH models</h2><span id='topic+CUSH'></span>

<h3>Description</h3>

<p>Main function to estimate and validate a CUSH model for ordinal responses, with or without covariates
to explain the shelter effect.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CUSH(Formula,data,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CUSH_+3A_formula">Formula</code></td>
<td>
<p>Object of class Formula.</p>
</td></tr>
<tr><td><code id="CUSH_+3A_data">data</code></td>
<td>
<p>Data frame from which model matrices and response variables are taken.</p>
</td></tr>
<tr><td><code id="CUSH_+3A_...">...</code></td>
<td>
<p>Additional arguments to pass to the fitting procedure. Argument X specifies the matrix of
subjects covariates to include in the model for explaining the shelter effect (not including intercept).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The estimation procedure is not iterative, so a null result for CUSH$niter is produced.
The optimization procedure is run via &quot;optim&quot;. If covariates are included, the variance-covariance matrix
is computed as the inverse of the returned numerically differentiated Hessian matrix (option: hessian=TRUE
as argument for &quot;optim&quot;). If not positive definite, it returns a warning message and produces a matrix
with NA entries.
</p>


<h3>Value</h3>

<p>An object of the class &quot;CUSH&quot; is a list containing the following results:
</p>
<table>
<tr><td><code>estimates</code></td>
<td>
<p>Maximum likelihood parameters estimates</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p>Log-likelihood function at the final estimates</p>
</td></tr>
<tr><td><code>varmat</code></td>
<td>
<p>Variance-covariance matrix of final estimates (if X=0, it returns the square of the estimated standard error
for the shelter parameter <code class="reqn">\delta</code>)</p>
</td></tr>
<tr><td><code>BIC</code></td>
<td>
<p>BIC index for the estimated model</p>
</td></tr>
</table>


<h3>References</h3>

<p>Capecchi S. and Piccolo D. (2015). Dealing with heterogeneity/uncertainty in sample survey with ordinal data,
<em>IFCS Proceedings, University of Bologna</em> <br />
Capecchi S. and Iannario M. (2016). Gini heterogeneity index for detecting uncertainty in ordinal data surveys,
<em>Metron</em> - DOI: 10.1007/s40300-016-0088-5
</p>


<h3>See Also</h3>

<p><code><a href="#topic+loglikCUSH">loglikCUSH</a></code>
</p>

<hr>
<h2 id='cush00'>CUSH model without covariates</h2><span id='topic+cush00'></span>

<h3>Description</h3>

<p>Estimate and validate a CUSH model for given ordinal responses, without covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cush00(m, ordinal, shelter)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cush00_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="cush00_+3A_ordinal">ordinal</code></td>
<td>
<p>Vector of ordinal responses</p>
</td></tr>
<tr><td><code id="cush00_+3A_shelter">shelter</code></td>
<td>
<p>Category corresponding to the shelter choice</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of the class &quot;GEM&quot;, &quot;CUSH&quot;
</p>

<hr>
<h2 id='cushcov'>CUSH model with covariates</h2><span id='topic+cushcov'></span>

<h3>Description</h3>

<p>Estimate and validate a CUSH model for ordinal responses, with covariates
to explain the shelter effect.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cushcov(m, ordinal, X, shelter)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cushcov_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="cushcov_+3A_ordinal">ordinal</code></td>
<td>
<p>Vector of ordinal responses</p>
</td></tr>
<tr><td><code id="cushcov_+3A_x">X</code></td>
<td>
<p>Matrix of selected covariates for explaining the shelter effect</p>
</td></tr>
<tr><td><code id="cushcov_+3A_shelter">shelter</code></td>
<td>
<p>Category corresponding to the shelter choice</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of the class &quot;GEM&quot;, &quot;CUSH&quot;
</p>

<hr>
<h2 id='deltaprob'>Mean difference of a discrete random variable</h2><span id='topic+deltaprob'></span>

<h3>Description</h3>

<p>Compute the Gini mean difference of a discrete distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>deltaprob(prob)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="deltaprob_+3A_prob">prob</code></td>
<td>
<p>Vector of the probability distribution</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric value of the Gini mean difference of the input probability distribution,
computed according to the de Finetti-Paciello formulation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>prob&lt;-c(0.04,0.04,0.05,0.10,0.21,0.32,0.24)
deltaprob(prob)
</code></pre>

<hr>
<h2 id='dissim'>Normalized dissimilarity measure</h2><span id='topic+dissim'></span>

<h3>Description</h3>

<p>Compute the normalized dissimilarity measure between observed
relative frequencies and estimated (theoretical) probabilities of a discrete distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dissim(proba,probb)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dissim_+3A_proba">proba</code></td>
<td>
<p>Vector of observed relative frequencies</p>
</td></tr>
<tr><td><code id="dissim_+3A_probb">probb</code></td>
<td>
<p>Vector of estimated (theoretical) probabilities</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric value of the dissimilarity index, assessing the distance to a perfect fit.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>proba&lt;-c(0.01,0.03,0.08,0.07,0.27,0.37,0.17)
probb&lt;-c(0.04,0.04,0.05,0.10,0.21,0.32,0.24)
dissim(proba,probb)
</code></pre>

<hr>
<h2 id='effe01'>Auxiliary function for the log-likelihood estimation of CUB models</h2><span id='topic+effe01'></span>

<h3>Description</h3>

<p>Compute the opposite of the scalar function that is maximized when running
the E-M algorithm for CUB models with covariates for the feeling parameter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>effe01(gama, esterno01, m)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="effe01_+3A_gama">gama</code></td>
<td>
<p>Vector of the starting values of the parameters to be estimated</p>
</td></tr>
<tr><td><code id="effe01_+3A_esterno01">esterno01</code></td>
<td>
<p>A matrix binding together the vector of the posterior probabilities
that each observation has been generated by the first component distribution of the mixture,
the ordinal data and the matrix of the selected covariates accounting for an intercept term</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is called as an argument for optim within CUB function for models with covariates for
feeling or for both feeling and uncertainty
</p>

<hr>
<h2 id='effe10'>Auxiliary function for the log-likelihood estimation of CUB models</h2><span id='topic+effe10'></span>

<h3>Description</h3>

<p>Compute the opposite of the scalar function that is maximized when running
the E-M algorithm for CUB models with covariates for the uncertainty parameter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>effe10(bet, esterno10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="effe10_+3A_bet">bet</code></td>
<td>
<p>Vector of the starting values for the parameters to be estimated</p>
</td></tr>
<tr><td><code id="effe10_+3A_esterno10">esterno10</code></td>
<td>
<p>A matrix binding together the matrix of the selected covariates
(accounting for an intercept term) and a vector (whose length equals the number of observations)
of the posterior probabilities that each observation has been generated by the first component
distribution of the mixture</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is called as an argument for optim within CUB function for models with covariates for
uncertainty or for both feeling and uncertainty
</p>

<hr>
<h2 id='effecube'>Auxiliary function for the log-likelihood estimation of CUBE models without covariates</h2><span id='topic+effecube'></span>

<h3>Description</h3>

<p>Define the opposite of the scalar function that is maximized when running the E-M
algorithm for CUBE models without covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>effecube(paravec, dati, m)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="effecube_+3A_paravec">paravec</code></td>
<td>
<p>Vector of initial estimates for the feeling and the overdispersion parameters</p>
</td></tr>
<tr><td><code id="effecube_+3A_dati">dati</code></td>
<td>
<p>Matrix binding together a column vector of length <code class="reqn">m</code> containing the posterior
probabilities that each observed category has been generated by the first component distribution
of the mixture, and the column vector of the absolute frequencies of the observations</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is called as an argument for optim within CUBE function (where no covariate is specified)
and &quot;cubeforsim&quot; as the function to minimize.
</p>


<h3>References</h3>

<p>Iannario, M. (2014). Modelling Uncertainty and Overdispersion in Ordinal Data,
<em>Communications in Statistics - Theory and Methods</em>, <b>43</b>, 771&ndash;786 <br />
</p>

<hr>
<h2 id='effecubecsi'>Auxiliary function for the log-likelihood estimation of CUBE models with covariates
only for the feeling component</h2><span id='topic+effecubecsi'></span>

<h3>Description</h3>

<p>Compute the opposite of the scalar function that is maximized when running the
E-M algorithm for CUBE models with covariates only for the feeling component.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>effecubecsi(param, ordinal, W, m)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="effecubecsi_+3A_param">param</code></td>
<td>
<p>Vector of length equal to NCOL(W) + 3 whose entries are the initial parameters estimates</p>
</td></tr>
<tr><td><code id="effecubecsi_+3A_ordinal">ordinal</code></td>
<td>
<p>Vector of ordinal responses</p>
</td></tr>
<tr><td><code id="effecubecsi_+3A_w">W</code></td>
<td>
<p>Matrix of the selected covariates for explaining the feeling component</p>
</td></tr>
<tr><td><code id="effecubecsi_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
</table>

<hr>
<h2 id='effecush'>Auxiliary function for the log-likelihood estimation of CUSH models with covariates</h2><span id='topic+effecush'></span>

<h3>Description</h3>

<p>Compute the opposite of the loglikelihood function for CUSH models
with covariates to explain the shelter effect.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>effecush(paravec, esternocush, shelter, m)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="effecush_+3A_paravec">paravec</code></td>
<td>
<p>Vector of the initial parameters estimates</p>
</td></tr>
<tr><td><code id="effecush_+3A_esternocush">esternocush</code></td>
<td>
<p>Matrix binding together the vector of ordinal data and the matrix XX of explanatory
variables whose first column is a column of ones needed to consider an intercept term</p>
</td></tr>
<tr><td><code id="effecush_+3A_shelter">shelter</code></td>
<td>
<p>Category corresponding to the shelter choice</p>
</td></tr>
<tr><td><code id="effecush_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is called as an argument for &quot;optim&quot; within CUSH function (when no covariate is included)
as the function to minimize.
</p>

<hr>
<h2 id='effeihg'>Auxiliary function for the log-likelihood estimation of IHG models without covariates</h2><span id='topic+effeihg'></span>

<h3>Description</h3>

<p>Compute the opposite of the log-likelihood function for an IHG model without covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>effeihg(theta, m, freq)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="effeihg_+3A_theta">theta</code></td>
<td>
<p>Initial estimate for the parameter of the IHG distribution</p>
</td></tr>
<tr><td><code id="effeihg_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="effeihg_+3A_freq">freq</code></td>
<td>
<p>Vector of the absolute frequency distribution of the ordinal responses</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is called as an argument for &quot;optim&quot; within IHG function (when no covariate is specified)
as the function to minimize.
</p>

<hr>
<h2 id='effeihgcov'>Auxiliary function for the log-likelihood estimation of IHG models with covariates</h2><span id='topic+effeihgcov'></span>

<h3>Description</h3>

<p>Compute the opposite of the log-likelihood function for an IHG model with covariates
for the preference parameter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>effeihgcov(nu, ordinal, U, m)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="effeihgcov_+3A_nu">nu</code></td>
<td>
<p>Vector of the starting values for the parameters to be estimated, with length equal to
NCOL(U)+1 to account for an intercept term (first entry of <code class="reqn">nu</code>)</p>
</td></tr>
<tr><td><code id="effeihgcov_+3A_ordinal">ordinal</code></td>
<td>
<p>Vector of ordinal responses</p>
</td></tr>
<tr><td><code id="effeihgcov_+3A_u">U</code></td>
<td>
<p>Matrix of the explanatory variables for the preference parameter <code class="reqn">\theta</code></p>
</td></tr>
<tr><td><code id="effeihgcov_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is called as an argument for &quot;optim&quot; within IHG function (with covariates)
as the function to minimize.
</p>

<hr>
<h2 id='ellecub'>Log-likelihood function of a CUB model without covariates</h2><span id='topic+ellecub'></span>

<h3>Description</h3>

<p>Compute the log-likelihood function of a CUB model without covariates fitting
ordinal responses, possibly with subjects' specific parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ellecub(m,ordinal,assepai,assecsi)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ellecub_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="ellecub_+3A_ordinal">ordinal</code></td>
<td>
<p>Vector of ordinal responses</p>
</td></tr>
<tr><td><code id="ellecub_+3A_assepai">assepai</code></td>
<td>
<p>Vector of uncertainty parameters for given observations
(with the same length as <code>ordinal</code>)</p>
</td></tr>
<tr><td><code id="ellecub_+3A_assecsi">assecsi</code></td>
<td>
<p>Vector of feeling parameters for given observations
(with the same length as <code>ordinal</code>)</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+loglikCUB">loglikCUB</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>m&lt;-7
n0&lt;-230
n1&lt;-270
bet&lt;-c(-1.5,1.2)
gama&lt;-c(0.5,-1.2)
pai0&lt;-logis(0,bet); csi0&lt;-logis(0,gama)
pai1&lt;-logis(1,bet); csi1&lt;-logis(1,gama)
ordinal0&lt;-simcub(n0,m,pai0,csi0)
ordinal1&lt;-simcub(n1,m,pai1,csi1)
ordinal&lt;-c(ordinal0,ordinal1)
assepai&lt;-c(rep(pai0,n0),rep(pai1,n1))
assecsi&lt;-c(rep(csi0,n0),rep(csi1,n1))
lli&lt;-ellecub(m,ordinal,assepai,assecsi)
</code></pre>

<hr>
<h2 id='ellegecub'>Log-likelihood function for gecub distribution</h2><span id='topic+ellegecub'></span>

<h3>Description</h3>

<p>Log-likelihood function for gecub distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ellegecub(ordinal,Y,W,X,bet,gama,omega,shelter)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ellegecub_+3A_ordinal">ordinal</code></td>
<td>
<p>Vector of ordinal responses</p>
</td></tr>
<tr><td><code id="ellegecub_+3A_y">Y</code></td>
<td>
<p>Matrix of selected covariates for explaining the uncertainty component, not including intercept</p>
</td></tr>
<tr><td><code id="ellegecub_+3A_w">W</code></td>
<td>
<p>Matrix of selected covariates for explaining the feeling component, not including intercept</p>
</td></tr>
<tr><td><code id="ellegecub_+3A_x">X</code></td>
<td>
<p>Matrix of selected covariates for explaining the shelter effect, not including intercept</p>
</td></tr>
<tr><td><code id="ellegecub_+3A_bet">bet</code></td>
<td>
<p>Matrix of selected covariates for explaining the uncertainty component, not including intercept</p>
</td></tr>
<tr><td><code id="ellegecub_+3A_gama">gama</code></td>
<td>
<p>Matrix of selected covariates for explaining the feeling component, not including intercept</p>
</td></tr>
<tr><td><code id="ellegecub_+3A_omega">omega</code></td>
<td>
<p>Matrix of selected covariates for explaining the shelter effect, not including intercept</p>
</td></tr>
<tr><td><code id="ellegecub_+3A_shelter">shelter</code></td>
<td>
<p>Category corresponding to the shelter choice</p>
</td></tr>
</table>

<hr>
<h2 id='expcub00'>Expectation of CUB distributions</h2><span id='topic+expcub00'></span>

<h3>Description</h3>

<p>Compute the expectation of a CUB model without covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expcub00(m,pai,csi)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="expcub00_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="expcub00_+3A_pai">pai</code></td>
<td>
<p>Uncertainty parameter</p>
</td></tr>
<tr><td><code id="expcub00_+3A_csi">csi</code></td>
<td>
<p>Feeling parameter</p>
</td></tr>
</table>


<h3>References</h3>

<p>Piccolo D. (2003). On the moments of a mixture of uniform and shifted binomial random variables.
<em>Quaderni di Statistica</em>, <b>5</b>, 85&ndash;104
</p>


<h3>See Also</h3>

<p><code><a href="#topic+varcub00">varcub00</a></code>, <code><a href="#topic+expcube">expcube</a></code>, <code><a href="#topic+varcube">varcube</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>m&lt;-10
pai&lt;-0.3
csi&lt;-0.7
meancub&lt;-expcub00(m,pai,csi)
</code></pre>

<hr>
<h2 id='expcube'>Expectation of CUBE models</h2><span id='topic+expcube'></span>

<h3>Description</h3>

<p>Compute the expectation of a CUBE model without covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expcube(m,pai,csi,phi)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="expcube_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="expcube_+3A_pai">pai</code></td>
<td>
<p>Uncertainty parameter</p>
</td></tr>
<tr><td><code id="expcube_+3A_csi">csi</code></td>
<td>
<p>Feeling parameter</p>
</td></tr>
<tr><td><code id="expcube_+3A_phi">phi</code></td>
<td>
<p>Overdispersion parameter</p>
</td></tr>
</table>


<h3>References</h3>

<p>Iannario M. (2014). Modelling Uncertainty and Overdispersion in Ordinal Data,
<em>Communications in Statistics - Theory and Methods</em>, <b>43</b>, 771&ndash;786 <br />
Iannario, M. (2015). Detecting latent components in ordinal data with overdispersion by means
of a mixture distribution, <em>Quality &amp; Quantity</em>, <b>49</b>, 977&ndash;987
</p>


<h3>See Also</h3>

<p><code><a href="#topic+varcube">varcube</a></code>, <code><a href="#topic+varcub00">varcub00</a></code>, <code><a href="#topic+expcub00">expcub00</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>m&lt;-10
pai&lt;-0.1
csi&lt;-0.7
phi&lt;-0.2
meancube&lt;-expcube(m,pai,csi,phi)
</code></pre>

<hr>
<h2 id='fitted.GEM'>S3 method &quot;fitted&quot; for class &quot;GEM&quot;</h2><span id='topic+fitted.GEM'></span>

<h3>Description</h3>

<p>S3 method fitted for objects of class <code><a href="#topic+GEM">GEM</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'GEM'
fitted(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitted.GEM_+3A_object">object</code></td>
<td>
<p>An object of class <code><a href="#topic+GEM">GEM</a></code></p>
</td></tr>
<tr><td><code id="fitted.GEM_+3A_...">...</code></td>
<td>
<p>Other arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Returns the fitted probability distribution for GEM models with no covariates. If only one dichotomous
covariate is included in the model to explain some components, it returns the fitted probability distribution for each profile.
</p>


<h3>See Also</h3>

<p><code>GEM</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fitcub&lt;-GEM(Formula(global~0|freqserv|0),family="cub",data=univer)
fitted(fitcub,digits=4)
</code></pre>

<hr>
<h2 id='gecubpqs'>Main function for CUB models with covariates for all the components</h2><span id='topic+gecubpqs'></span>

<h3>Description</h3>

<p>Function to estimate and validate a CUB model for given ordinal responses, with covariates for
explaining all the components and the shelter effect.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gecubpqs(ordinal,Y,W,X,shelter,theta0,maxiter,toler)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gecubpqs_+3A_ordinal">ordinal</code></td>
<td>
<p>Vector of ordinal responses</p>
</td></tr>
<tr><td><code id="gecubpqs_+3A_y">Y</code></td>
<td>
<p>Matrix of selected covariates for explaining the uncertainty component, not including intercept</p>
</td></tr>
<tr><td><code id="gecubpqs_+3A_w">W</code></td>
<td>
<p>Matrix of selected covariates for explaining the feeling component, not including intercept</p>
</td></tr>
<tr><td><code id="gecubpqs_+3A_x">X</code></td>
<td>
<p>Matrix of selected covariates for explaining the shelter effect, not including intercept</p>
</td></tr>
<tr><td><code id="gecubpqs_+3A_shelter">shelter</code></td>
<td>
<p>Category corresponding to the shelter choice</p>
</td></tr>
<tr><td><code id="gecubpqs_+3A_theta0">theta0</code></td>
<td>
<p>Starting values for parameters explaining the shelter effect</p>
</td></tr>
<tr><td><code id="gecubpqs_+3A_maxiter">maxiter</code></td>
<td>
<p>Maximum number of iterations allowed for running the optimization algorithm</p>
</td></tr>
<tr><td><code id="gecubpqs_+3A_toler">toler</code></td>
<td>
<p>Fixed error tolerance for final estimates</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of the class &quot;CUB&quot;
</p>


<h3>References</h3>

<p>Piccolo D. and D'Elia A. (2008), A new approach for modelling consumers' preferences,
<em>Food Quality and Preference</em>, <b>18</b>, 247&ndash;259 <br />
</p>
<p>Iannario M. and Piccolo D. (2010), A new statistical model for the analysis of customer
satisfaction, #' <em>Quality Technology and Quantity management</em>, <b>7</b>(2) 149&ndash;168 <br />
Iannario M. and Piccolo D. (2012), CUB models: Statistical methods and empirical evidence, in:
Kenett R. S. and Salini S. (eds.), <em>Modern Analysis of Customer Surveys: with applications using R</em>,
J. Wiley and Sons, Chichester, 231&ndash;258.
</p>

<hr>
<h2 id='GEM'>Main function for GEM models</h2><span id='topic+GEM'></span>

<h3>Description</h3>

<p>Main function to estimate and validate GEneralized Mixture models with uncertainty.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GEM(Formula,family=c("cub","cube","ihg","cush"),data,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GEM_+3A_formula">Formula</code></td>
<td>
<p>Object of class Formula. Response variable is the vector of ordinal observations - see Details.</p>
</td></tr>
<tr><td><code id="GEM_+3A_family">family</code></td>
<td>
<p>Character string indicating which class of GEM models to fit.</p>
</td></tr>
<tr><td><code id="GEM_+3A_data">data</code></td>
<td>
<p>an optional data frame (or object coercible by <code>as.data.frame</code> to a data frame)
containing the variables in the model. If missing, the variables are taken from <code>environment(Formula)</code>.</p>
</td></tr>
<tr><td><code id="GEM_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed for the specification of the model. See details and examples.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is the main function for GEM models estimation, calling for the corresponding function for
the specified subclass. The number of categories <code>m</code> is internally retrieved but it is advisable to pass
it as an argument to the call if some category has zero frequency.<br />
If  <code>family="cub"</code>, then a CUB mixture model is fitted to the data to explain uncertainty,
feeling and possible shelter effect by further passing the extra argument <code>shelter</code> for the corresponding category.
Subjects' covariates can be included by specifying covariates matrices in the
Formula as <code>ordinal~Y|W|X</code>,  to explain uncertainty (Y), feeling (W) or shelter (X).  Notice that
covariates for shelter effect can be included only if specified for both feeling and uncertaint (GeCUB models). <br />
If <code>family="cube"</code>, then a CUBE mixture model (Combination of Uniform and Beta-Binomial) is fitted to the data
to explain uncertainty, feeling and overdispersion.   Subjects' covariates can be also included to explain the
feeling component or all the three components by  specifying covariates matrices in the Formula as
<code>ordinal~Y|W|Z</code> to explain uncertainty (Y), feeling (W) or
overdispersion (Z). An extra logical argument <code>expinform</code> indicates whether or not to use the expected or the
observed information matrix (default is FALSE). <br />
If <code>family="ihg"</code>, then an IHG model is fitted to the data. IHG models (Inverse Hypergeometric) are nested into
CUBE models (see the references below). The parameter <code class="reqn">\theta</code> gives the probability of observing
the first category and is therefore a direct measure of preference, attraction, pleasantness toward the
investigated item. This is the reason why <code class="reqn">\theta</code> is customarily referred to as the preference parameter of the
IHG model. Covariates for the preference parameter <code class="reqn">\theta</code> have to be specified in matrix form in the Formula as
<code>ordinal~U</code>. <br />
If <code>family="cush"</code>, then a CUSH model is fitted to the data (Combination of Uniform and SHelter effect).
The category corresponding to the inflation should be
passed via argument <code>shelter</code>. Covariates for the shelter parameter <code class="reqn">\delta</code>
are specified in matrix form Formula as <code>ordinal~X</code>. <br />
Even if no covariate is included in the model for a given component, the corresponding model matrix needs always
to be specified: in this case, it should be set to 0 (see examples below). Extra arguments include the maximum
number of iterations (<code>maxiter</code>, default: <code>maxiter</code>=500) for the optimization algorithm and
the required error tolerance (<code>toler</code>, default: <code>toler</code>=1e-6). <br />
Standard methods: <code>logLik()</code>, <code>BIC()</code>, <code>vcov()</code>, <code>fitted()</code>, <code>coef()</code>, <code>print()</code>, <code>summary()</code>
are implemented.<br />
The optimization procedure is run via <code>optim()</code> when required. If the estimated variance-covariance matrix is not positive definite, the function returns a
warning message and produces a matrix with NA entries.
</p>


<h3>Value</h3>

<p>An object of the class &quot;GEM&quot; is a list containing the following elements:
</p>
<table>
<tr><td><code>estimates</code></td>
<td>
<p>Maximum likelihood estimates of parameters</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p>Log-likelihood function at the final estimates</p>
</td></tr>
<tr><td><code>varmat</code></td>
<td>
<p>Variance-covariance matrix of final estimates</p>
</td></tr>
<tr><td><code>niter</code></td>
<td>
<p>Number of executed iterations</p>
</td></tr>
<tr><td><code>BIC</code></td>
<td>
<p>BIC index for the estimated model</p>
</td></tr>
<tr><td><code>ordinal</code></td>
<td>
<p>Vector of ordinal responses on which the model has been fitted</p>
</td></tr>
<tr><td><code>time</code></td>
<td>
<p>Processor time for execution</p>
</td></tr>
<tr><td><code>ellipsis</code></td>
<td>
<p>Retrieve the arguments passed to the call and extra arguments generated via the call</p>
</td></tr>
<tr><td><code>family</code></td>
<td>
<p>Character string indicating the sub-class of the fitted model</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>Returns the Formula of the call for the fitted model</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>Returns the executed call</p>
</td></tr>
</table>


<h3>References</h3>

<p>D'Elia A. (2003). Modelling ranks using the inverse hypergeometric distribution,
<em>Statistical Modelling: an International Journal</em>, <b>3</b>, 65&ndash;78 <br />
D'Elia A. and Piccolo D. (2005). A mixture model for preferences data analysis,
<em>Computational Statistics &amp; Data Analysis</em>,  <b>49</b>, 917&ndash;937 <br />
Capecchi S. and Piccolo D. (2017). Dealing with heterogeneity in ordinal responses,
<em>Quality and Quantity</em>, <b>51</b>(5), 2375&ndash;2393 <br />
Iannario M. (2014). Modelling Uncertainty and Overdispersion in Ordinal Data,
<em>Communications in Statistics - Theory and Methods</em>, <b>43</b>, 771&ndash;786 <br />
Piccolo D. (2015). Inferential issues for CUBE models with covariates,
<em>Communications in Statistics. Theory and Methods</em>, <b>44</b>(23), 771&ndash;786. <br />
Iannario M. (2015). Detecting latent components in ordinal data with overdispersion by means
of a mixture distribution, <em>Quality &amp; Quantity</em>, <b>49</b>, 977&ndash;987 <br />
Iannario M. and Piccolo D. (2016a). A comprehensive framework for regression models of ordinal data.
<em>Metron</em>, <b>74</b>(2), 233&ndash;252.<br />
Iannario M. and Piccolo D. (2016b). A generalized framework for modelling ordinal data.
<em>Statistical Methods and Applications</em>, <b>25</b>, 163&ndash;189.<br />
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+logLik">logLik</a></code>, <code><a href="stats.html#topic+coef">coef</a></code>, <code><a href="stats.html#topic+BIC">BIC</a></code>,  <code><a href="#topic+makeplot">makeplot</a></code>,
<code><a href="base.html#topic+summary">summary</a></code>, <code><a href="stats.html#topic+vcov">vcov</a></code>, <code><a href="stats.html#topic+fitted">fitted</a></code>, <code><a href="#topic+cormat">cormat</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(CUB)
## CUB models with no covariates
model&lt;-GEM(Formula(Walking~0|0|0),family="cub",data=relgoods)
coef(model,digits=5)     # Estimated parameter vector (pai,csi)
logLik(model)            # Log-likelihood function at ML estimates
vcov(model,digits=4)     # Estimated Variance-Covariance matrix
cormat(model)            # Parameter Correlation matrix
fitted(model)            # Fitted probability distribution
makeplot(model)
################
## CUB model with shelter effect
model&lt;-GEM(Formula(officeho~0|0|0),family="cub",shelter=7,data=univer)
BICshe&lt;-BIC(model,digits=4)
################
## CUB model with covariate for uncertainty
modelcovpai&lt;-GEM(Formula(Parents~Smoking|0|0),family="cub",data=relgoods)
fitted(modelcovpai)
makeplot(modelcovpai)
################
## CUB model with covariates for both uncertainty and feeling components
data(univer)
model&lt;-GEM(Formula(global~gender|freqserv|0),family="cub",data=univer,maxiter=50,toler=1e-2)
param&lt;-coef(model)
bet&lt;-param[1:2]      # ML estimates of coefficients for uncertainty covariate: gender
gama&lt;-param[3:4]     # ML estimates of coefficients for feeling covariate: lage
##################
## CUBE models with no covariates
model&lt;-GEM(Formula(MeetRelatives~0|0|0),family="cube",starting=c(0.5,0.5,0.1),
  data=relgoods,expinform=TRUE,maxiter=50,toler=1e-2)
coef(model,digits=4)       # Final ML estimates
vcov(model)
fitted(model)
makeplot(model)
summary(model)
##################
## IHG with covariates
modelcov&lt;-GEM(willingn~freqserv,family="ihg",data=univer)
omega&lt;-coef(modelcov)      ## ML estimates 
maxlik&lt;-logLik(modelcov)   ## 
makeplot(modelcov)
summary(modelcov)
###################
## CUSH models without covariate
model&lt;-GEM(Dog~0,family="cush",shelter=1,data=relgoods)
delta&lt;-coef(model)      # ML estimates of delta
maxlik&lt;-logLik(model)   # Log-likelihood at ML estimates
summary(model)
makeplot(model)
</code></pre>

<hr>
<h2 id='gini'>Normalized Gini heterogeneity index</h2><span id='topic+gini'></span>

<h3>Description</h3>

<p>Compute the normalized Gini heterogeneity
index for a given discrete probability distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gini(prob)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gini_+3A_prob">prob</code></td>
<td>
<p>Vector of  probability distribution or relative frequencies</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+laakso">laakso</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>prob&lt;-c(0.04,0.04,0.05,0.10,0.21,0.32,0.24)
gini(prob)
</code></pre>

<hr>
<h2 id='Hadprod'>Hadamard product of a matrix with a vector</h2><span id='topic+Hadprod'></span>

<h3>Description</h3>

<p>Return the Hadamard product between the given matrix and vector: this operation corresponds
to multiply every row of the matrix by the corresponding element of the vector, and it is equivalent to the
standard matrix multiplication to the right with the diagonal matrix whose diagonal is the given vector.
It is possible only if the length of the vector equals the number of rows of the matrix, otherwise it prints
an error message.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Hadprod(Amat, xvett)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Hadprod_+3A_amat">Amat</code></td>
<td>
<p>A generic matrix</p>
</td></tr>
<tr><td><code id="Hadprod_+3A_xvett">xvett</code></td>
<td>
<p>A generic vector</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is an auxiliary function needed for computing the variance-covariance matrix of the estimated model
with covariates.
</p>


<h3>Value</h3>

<p>A matrix of the same dimensions as Amat
</p>

<hr>
<h2 id='IHG'>Main function for IHG models</h2><span id='topic+IHG'></span>

<h3>Description</h3>

<p>Main function to estimate and validate an Inverse Hypergeometric model, without or
with covariates for explaining the preference parameter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IHG(Formula, data, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="IHG_+3A_formula">Formula</code></td>
<td>
<p>Object of class Formula.</p>
</td></tr>
<tr><td><code id="IHG_+3A_data">data</code></td>
<td>
<p>Data frame from which model matrices and response variables are taken.</p>
</td></tr>
<tr><td><code id="IHG_+3A_...">...</code></td>
<td>
<p>Additional arguments to pass to the fitting procedure. Argument U specifies the matrix of
subjects covariates to include in the model for explaining the preference parameter (not including intercept).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is the main function for IHG models (that are nested into CUBE models, see the references below),
calling for the corresponding function whenever covariates are specified. <br />
The parameter <code class="reqn">\theta</code> represents the probability of observing a rating corresponding to the first
category and is therefore a direct measure of preference, attraction, pleasantness toward the investigated item.
This is reason why <code class="reqn">\theta</code> is customarily referred to as the preference parameter of the IHG model.<br />
The estimation procedure is not iterative, so a null result for IHG$niter is produced. <br />
The optimization procedure is run via &quot;optim&quot;. The variance-covariance matrix (or the estimated standard error for
theta if no covariate is included) is computed as the inverse of the returned numerically differentiated
Hessian matrix (option: hessian=TRUE as argument for optim). If not positive definite,
it returns a warning message and produces a matrix with NA entries.
</p>


<h3>Value</h3>

<p>An object of the class &quot;IHG&quot; is a list containing the following results:
</p>
<table>
<tr><td><code>estimates</code></td>
<td>
<p>Maximum likelihood parameters estimates</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p>Log-likelihood function at the final estimates</p>
</td></tr>
<tr><td><code>varmat</code></td>
<td>
<p>Variance-covariance matrix of final estimates. If no covariate is included in the model,
it returns the square of the estimated standard error for the preference parameter <code class="reqn">\theta</code></p>
</td></tr>
<tr><td><code>BIC</code></td>
<td>
<p>BIC index for the estimated model</p>
</td></tr>
</table>


<h3>References</h3>

<p>D'Elia A. (2003). Modelling ranks using the inverse hypergeometric distribution,
<em>Statistical Modelling: an International Journal</em>, <b>3</b>, 65&ndash;78 <br />
Iannario M. (2012). CUBE models for interpreting ordered categorical data with overdispersion,
<em>Quaderni di Statistica</em>, <b>14</b>, 137&ndash;140
</p>


<h3>See Also</h3>

<p><code><a href="#topic+probihg">probihg</a></code>,  <code><a href="#topic+iniihg">iniihg</a></code>, <code><a href="#topic+loglikIHG">loglikIHG</a></code>
</p>

<hr>
<h2 id='ihg00'>Main function for IHG models without covariates</h2><span id='topic+ihg00'></span>

<h3>Description</h3>

<p>Estimate and validate an IHG model without covariates for given ordinal responses.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ihg00(m, ordinal)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ihg00_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="ihg00_+3A_ordinal">ordinal</code></td>
<td>
<p>Vector of ordinal responses</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The optimization procedure is run via &quot;optim&quot;, option method=&quot;Brent&quot; for constrained optimization
(lower bound = 0, upper bound=1).
</p>


<h3>Value</h3>

<p>An object of the class &quot;IHG&quot;
</p>
<p>An object of the class &quot;IHG&quot;
</p>

<hr>
<h2 id='ihgcov'>Main function for IHG models with covariates</h2><span id='topic+ihgcov'></span>

<h3>Description</h3>

<p>Estimate and validate an IHG model for given ordinal responses, with covariates to
explain the preference parameter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ihgcov(m, ordinal, U)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ihgcov_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="ihgcov_+3A_ordinal">ordinal</code></td>
<td>
<p>Vector of ordinal responses</p>
</td></tr>
<tr><td><code id="ihgcov_+3A_u">U</code></td>
<td>
<p>Matrix of selected covariates for the preference parameter</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The optimization procedure is run via &quot;optim&quot;, option method=&quot;Brent&quot; for constrained optimization
(lower bound = 0, upper bound=1).
</p>


<h3>Value</h3>

<p>An object of the class &quot;IHG&quot;
</p>
<p>An object of the class &quot;IHG&quot;
</p>

<hr>
<h2 id='inibest'>Preliminary estimators for CUB models without covariates</h2><span id='topic+inibest'></span>

<h3>Description</h3>

<p>Compute preliminary parameter estimates of a CUB model without covariates for given ordinal
responses. These preliminary estimators are used within the package code to start the E-M algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>inibest(m,freq)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="inibest_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="inibest_+3A_freq">freq</code></td>
<td>
<p>Vector of the absolute frequencies of given ordinal responses</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector <code class="reqn">(\pi,\xi)</code> of the initial parameter estimates for a CUB model without covariates,
given the absolute frequency distribution of ordinal responses
</p>


<h3>References</h3>

<p>Iannario M. (2009). A comparison of preliminary estimators in a class of ordinal data models,
<em>Statistica &amp; Applicazioni</em>, <b>VII</b>, 25&ndash;44 <br />
Iannario M. (2012). Preliminary estimators for a mixture model of ordinal data,
<em>Advances in Data Analysis and Classification</em>, <b>6</b>, 163&ndash;184
</p>


<h3>See Also</h3>

<p><code><a href="#topic+inibestgama">inibestgama</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>m&lt;-9
freq&lt;-c(10,24,28,36,50,43,23,12,5)
estim&lt;-inibest(m,freq) 
pai&lt;-estim[1]
csi&lt;-estim[2]
</code></pre>

<hr>
<h2 id='inibestcube'>Naive estimates for CUBE models without covariates</h2><span id='topic+inibestcube'></span>

<h3>Description</h3>

<p>Compute <em>naive</em> parameter estimates of a CUBE model without covariates for given ordinal responses.
These preliminary estimators are used within the package code to start the E-M algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>inibestcube(m,ordinal)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="inibestcube_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="inibestcube_+3A_ordinal">ordinal</code></td>
<td>
<p>Vector of ordinal responses</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector <code class="reqn">(\pi, \xi ,\phi)</code> of parameter estimates of a CUBE model without covariates.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+inibestcubecov">inibestcubecov</a></code>, <code><a href="#topic+inibestcubecsi">inibestcubecsi</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(relgoods)
m&lt;-10
ordinal&lt;-relgoods$SocialNetwork
estim&lt;-inibestcube(m,ordinal)     # Preliminary estimates (pai,csi,phi)
</code></pre>

<hr>
<h2 id='inibestcubecov'>Preliminary parameter estimates for CUBE models with covariates</h2><span id='topic+inibestcubecov'></span>

<h3>Description</h3>

<p>Compute preliminary parameter estimates for a CUBE model with covariates for all the three parameters.
These estimates are set as initial values to start the E-M algorithm within maximum likelihood estimation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>inibestcubecov(m,ordinal,Y,W,Z)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="inibestcubecov_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="inibestcubecov_+3A_ordinal">ordinal</code></td>
<td>
<p>Vector of ordinal responses</p>
</td></tr>
<tr><td><code id="inibestcubecov_+3A_y">Y</code></td>
<td>
<p>Matrix of selected covariates to explain the uncertainty parameter</p>
</td></tr>
<tr><td><code id="inibestcubecov_+3A_w">W</code></td>
<td>
<p>Matrix of selected covariates to explain the feeling parameter</p>
</td></tr>
<tr><td><code id="inibestcubecov_+3A_z">Z</code></td>
<td>
<p>Matrix of selected covariates to explain the overdispersion parameter</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector <code>(inibet, inigama, inialpha)</code> of preliminary estimates of parameter vectors for
<code class="reqn">\pi = \pi(\bold{\beta})</code>, <code class="reqn">\xi=\xi(\bold{\gamma})</code>, <code class="reqn">\phi=\phi(\bold{\alpha})</code>, respectively, of a CUBE model with covariates for all the three
parameters. In details, <code>inibet</code>, <code>inigama</code> and <code>inialpha</code> have length equal to NCOL(Y)+1, NCOL(W)+1 and
NCOL(Z)+1, respectively, to account for an intercept term for each component.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+inibestcube">inibestcube</a></code>, <code><a href="#topic+inibestcubecsi">inibestcubecsi</a></code>, <code><a href="#topic+inibestgama">inibestgama</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(relgoods)
m&lt;-10 
naord&lt;-which(is.na(relgoods$Tv))
nacovpai&lt;-which(is.na(relgoods$Gender))
nacovcsi&lt;-which(is.na(relgoods$year.12))
nacovphi&lt;-which(is.na(relgoods$EducationDegree))
na&lt;-union(union(naord,nacovpai),union(nacovcsi,nacovphi))
ordinal&lt;-relgoods$Tv[-na]
Y&lt;-relgoods$Gender[-na]
W&lt;-relgoods$year.12[-na]
Z&lt;-relgoods$EducationDegree[-na]
ini&lt;-inibestcubecov(m,ordinal,Y,W,Z)
p&lt;-NCOL(Y)
q&lt;-NCOL(W)
inibet&lt;-ini[1:(p+1)]               # Preliminary estimates for uncertainty 
inigama&lt;-ini[(p+2):(p+q+2)]        # Preliminary estimates for feeling 
inialpha&lt;-ini[(p+q+3):length(ini)] # Preliminary estimates for overdispersion
</code></pre>

<hr>
<h2 id='inibestcubecsi'>Preliminary estimates of parameters for CUBE models with covariates only for feeling</h2><span id='topic+inibestcubecsi'></span>

<h3>Description</h3>

<p>Compute preliminary parameter estimates of a CUBE model with covariates only for feeling, given
ordinal responses. These estimates are set as initial values to start the corresponding E-M algorithm within the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>inibestcubecsi(m,ordinal,W,starting,maxiter,toler)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="inibestcubecsi_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="inibestcubecsi_+3A_ordinal">ordinal</code></td>
<td>
<p>Vector of ordinal responses</p>
</td></tr>
<tr><td><code id="inibestcubecsi_+3A_w">W</code></td>
<td>
<p>Matrix of selected covariates to explain the feeling component</p>
</td></tr>
<tr><td><code id="inibestcubecsi_+3A_starting">starting</code></td>
<td>
<p>Starting values for preliminary estimation of a CUBE without covariate</p>
</td></tr>
<tr><td><code id="inibestcubecsi_+3A_maxiter">maxiter</code></td>
<td>
<p>Maximum number of iterations allowed for preliminary iterations</p>
</td></tr>
<tr><td><code id="inibestcubecsi_+3A_toler">toler</code></td>
<td>
<p>Fixed error tolerance for final estimates for preliminary iterations</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Preliminary estimates for the uncertainty and the overdispersion parameters are computed by short runs of EM.
As to the feeling component, it considers the nested CUB model with covariates and calls <code><a href="#topic+inibestgama">inibestgama</a></code> to derive initial estimates for the coefficients
of the selected covariates for feeling.
</p>


<h3>Value</h3>

<p>A vector <code>(pai, gamaest, phi)</code>, where <code>pai</code> is the initial estimate for the uncertainty parameter,
<code>gamaest</code> is the vector of initial estimates for the feeling component (including an intercept term in the first entry),
and <code>phi</code> is the initial estimate for the overdispersion parameter.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+inibestcube">inibestcube</a></code>, <code><a href="#topic+inibestcubecov">inibestcubecov</a></code>, <code><a href="#topic+inibestgama">inibestgama</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(relgoods)
isnacov&lt;-which(is.na(relgoods$Gender))
isnaord&lt;-which(is.na(relgoods$Tv))
na&lt;-union(isnacov,isnaord)
ordinal&lt;-relgoods$Tv[-na]; W&lt;-relgoods$Gender[-na]
m&lt;-10
starting&lt;-rep(0.1,3)
ini&lt;-inibestcubecsi(m,ordinal,W,starting,maxiter=100,toler=1e-3)
nparam&lt;-length(ini)
pai&lt;-ini[1]                 # Preliminary estimates for uncertainty component
gamaest&lt;-ini[2:(nparam-1)]  # Preliminary estimates for coefficients of feeling covariates
phi&lt;-ini[nparam]            # Preliminary estimates for overdispersion component
</code></pre>

<hr>
<h2 id='inibestgama'>Preliminary parameter estimates of a CUB model with covariates for feeling</h2><span id='topic+inibestgama'></span>

<h3>Description</h3>

<p>Compute preliminary parameter estimates for the feeling component of a CUB model
fitted to ordinal responses
These estimates are set as initial values for parameters to start the E-M algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>inibestgama(m,ordinal,W)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="inibestgama_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="inibestgama_+3A_ordinal">ordinal</code></td>
<td>
<p>Vector of ordinal responses</p>
</td></tr>
<tr><td><code id="inibestgama_+3A_w">W</code></td>
<td>
<p>Matrix of selected covariates for explaining the feeling component</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of length equal to NCOL(W)+1, whose entries are the preliminary estimates
of the parameters for the feeling component, including an intercept term as first entry.
</p>


<h3>References</h3>

<p>Iannario M. (2008). Selecting feeling covariates in rating surveys,
<em>Rivista di Statistica Applicata</em>, <b>20</b>, 103&ndash;116 <br />
Iannario M. (2009). A comparison of preliminary estimators in a class of ordinal data models,
<em>Statistica &amp; Applicazioni</em>, <b>VII</b>, 25&ndash;44 <br />
Iannario M. (2012).  Preliminary estimators for a mixture model of ordinal data,
<em>Advances in Data Analysis and Classification</em>, <b>6</b>, 163&ndash;184
</p>


<h3>See Also</h3>

<p><code><a href="#topic+inibest">inibest</a></code>, <code><a href="#topic+inibestcubecsi">inibestcubecsi</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(univer)
m&lt;-7; ordinal&lt;-univer$global; cov&lt;-univer$diploma
ini&lt;-inibestgama(m,ordinal,W=cov)
</code></pre>

<hr>
<h2 id='inigrid'>Grid-based preliminary parameter estimates for CUB models</h2><span id='topic+inigrid'></span>

<h3>Description</h3>

<p>Compute the log-likelihood function of a CUB model with parameter vector <code class="reqn">(\pi, \xi)</code> ranging in
the Cartesian product between <code class="reqn">x</code> and <code class="reqn">y</code>, for a given absolute frequency distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>inigrid(m,freq,x,y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="inigrid_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="inigrid_+3A_freq">freq</code></td>
<td>
<p>Vector of length <code class="reqn">m</code> of the absolute frequency distribution</p>
</td></tr>
<tr><td><code id="inigrid_+3A_x">x</code></td>
<td>
<p>A set of values to assign to the uncertainty parameter <code class="reqn">\pi</code></p>
</td></tr>
<tr><td><code id="inigrid_+3A_y">y</code></td>
<td>
<p>A set of values to assign to the feeling parameter <code class="reqn">\xi</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>It returns the parameter vector corresponding to the maximum value of the log-likelihood
for a CUB model without covariates for given frequencies.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+inibest">inibest</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>m&lt;-9
x&lt;-c(0.1,0.4,0.6,0.8)
y&lt;-c(0.2, 0.5,0.7)
freq&lt;-c(10,24,28,36,50,43,23,12,5)
ini&lt;-inigrid(m,freq,x,y)
pai&lt;-ini[1]
csi&lt;-ini[2]
</code></pre>

<hr>
<h2 id='iniihg'>Moment estimate for the preference parameter of the IHG distribution</h2><span id='topic+iniihg'></span>

<h3>Description</h3>

<p>Compute the moment estimate of the preference parameter of the IHG distribution.
This preliminary estimate is set as initial value within the optimization procedure for an IHG model
fitting the observed frequencies.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>iniihg(m,freq)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="iniihg_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="iniihg_+3A_freq">freq</code></td>
<td>
<p>Vector of the absolute frequency distribution of the categories</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Moment estimator of the preference parameter <code class="reqn">\theta</code>.
</p>


<h3>References</h3>

<p>D'Elia A. (2003). Modelling ranks using the inverse hypergeometric distribution,
<em>Statistical Modelling: an International Journal</em>, <b>3</b>, 65&ndash;78.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+inibest">inibest</a></code>, <code><a href="#topic+inibestcube">inibestcube</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>m&lt;-9
freq&lt;-c(70,51,48,38,29,23,12,10,5)
initheta&lt;-iniihg(m,freq)
</code></pre>

<hr>
<h2 id='kkk'>Sequence of combinatorial coefficients</h2><span id='topic+kkk'></span>

<h3>Description</h3>

<p>Compute the sequence of binomial coefficients <code class="reqn">{m-1}\choose{r-1}</code>, for <code class="reqn">r= 1, \dots, m</code>,
and then returns a vector of the same length as ordinal, whose i-th component is the corresponding binomial
coefficient <code class="reqn">{m-1}\choose{r_i-1}</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kkk(m, ordinal)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kkk_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="kkk_+3A_ordinal">ordinal</code></td>
<td>
<p>Vector of ordinal responses</p>
</td></tr>
</table>

<hr>
<h2 id='laakso'>Normalized Laakso and Taagepera heterogeneity index</h2><span id='topic+laakso'></span>

<h3>Description</h3>

<p>Compute the normalized Laakso and Taagepera heterogeneity index for a given
discrete probability distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>laakso(prob)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="laakso_+3A_prob">prob</code></td>
<td>
<p>Vector of a probability or relative frequency distribution</p>
</td></tr>
</table>


<h3>References</h3>

<p>Laakso, M. and Taagepera, R. (1989). Effective number of parties: a measure with application to West Europe,
<em>Comparative Political Studies</em>, <b>12</b>, 3&ndash;27.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gini">gini</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>prob&lt;-c(0.04,0.04,0.05,0.10,0.21,0.32,0.24)
laakso(prob)
</code></pre>

<hr>
<h2 id='logis'>The logistic transform</h2><span id='topic+logis'></span>

<h3>Description</h3>

<p>Create a matrix YY binding array <code>Y</code> with a vector of ones, placed as the first column of YY.
It applies the logistic transform componentwise to the standard matrix multiplication between YY and <code>param</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logis(Y,param)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logis_+3A_y">Y</code></td>
<td>
<p>A generic matrix or one dimensional array</p>
</td></tr>
<tr><td><code id="logis_+3A_param">param</code></td>
<td>
<p>Vector of coefficients, whose length is NCOL(Y) + 1 (to consider also an intercept term)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Return a vector whose length is NROW(Y) and whose i-th component is the logistic function
at the scalar product between the i-th row of YY and the vector <code>param</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n&lt;-50 
Y&lt;-sample(c(1,2,3),n,replace=TRUE) 
param&lt;-c(0.2,0.7)
logis(Y,param)
</code></pre>

<hr>
<h2 id='logLik.GEM'>logLik S3 Method for class &quot;GEM&quot;</h2><span id='topic+logLik.GEM'></span>

<h3>Description</h3>

<p>S3 method: logLik() for objects of class &quot;GEM&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'GEM'
logLik(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logLik.GEM_+3A_object">object</code></td>
<td>
<p>An object of class &quot;GEM&quot;</p>
</td></tr>
<tr><td><code id="logLik.GEM_+3A_...">...</code></td>
<td>
<p>Other arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Log-likelihood at the final ML estimates for parameters of the fitted GEM model.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+loglikCUB">loglikCUB</a></code>, <code><a href="#topic+loglikCUBE">loglikCUBE</a></code>, <code><a href="#topic+GEM">GEM</a></code>,  <code><a href="#topic+loglikIHG">loglikIHG</a></code>,
<code><a href="#topic+loglikCUSH">loglikCUSH</a></code>, <code><a href="stats.html#topic+BIC">BIC</a></code>
</p>

<hr>
<h2 id='loglikCUB'>Log-likelihood function for CUB models</h2><span id='topic+loglikCUB'></span>

<h3>Description</h3>

<p>Compute the log-likelihood value of a CUB model fitting given data, with or without covariates to
explain the feeling and uncertainty components, or for extended CUB models with shelter effect.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loglikCUB(ordinal,m,param,Y=0,W=0,X=0,shelter=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loglikCUB_+3A_ordinal">ordinal</code></td>
<td>
<p>Vector of ordinal responses</p>
</td></tr>
<tr><td><code id="loglikCUB_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="loglikCUB_+3A_param">param</code></td>
<td>
<p>Vector of parameters for the specified CUB model</p>
</td></tr>
<tr><td><code id="loglikCUB_+3A_y">Y</code></td>
<td>
<p>Matrix of selected covariates to explain the uncertainty component (default: no covariate is included
in the model)</p>
</td></tr>
<tr><td><code id="loglikCUB_+3A_w">W</code></td>
<td>
<p>Matrix of selected covariates to explain the feeling component (default: no covariate is included
in the model)</p>
</td></tr>
<tr><td><code id="loglikCUB_+3A_x">X</code></td>
<td>
<p>Matrix of selected covariates to explain the shelter effect (default: no covariate is included
in the model)</p>
</td></tr>
<tr><td><code id="loglikCUB_+3A_shelter">shelter</code></td>
<td>
<p>Category corresponding to the shelter choice (default: no shelter effect is included in the
model)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If no covariate is included in the model, then <code>param</code> should be given in the form <code class="reqn">(\pi,\xi)</code>.
More generally, it should have the form <code class="reqn">(\bold{\beta,\gamma)}</code> where,
respectively, <code class="reqn">\bold{\beta}</code> and <code class="reqn">\bold{\gamma}</code> are the vectors of
coefficients explaining the uncertainty and the feeling components, with length NCOL(Y)+1 and
NCOL(W)+1 to account for an intercept term in the first entry. When shelter effect is considered, <code>param</code> corresponds
to the first possibile parameterization and hence should be given as <code>(pai1,pai2,csi)</code>.
No missing value should be present neither
for <code>ordinal</code> nor for covariate matrices: thus, deletion or imputation procedures should be preliminarily run.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+logLik">logLik</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Log-likelihood of a CUB model with no covariate
m&lt;-9; n&lt;-300
pai&lt;-0.6; csi&lt;-0.4
ordinal&lt;-simcub(n,m,pai,csi)
param&lt;-c(pai,csi)
loglikcub&lt;-loglikCUB(ordinal,m,param)
##################################
## Log-likelihood of a CUB model with covariate for uncertainty
data(relgoods)
m&lt;-10
naord&lt;-which(is.na(relgoods$Physician))
nacov&lt;-which(is.na(relgoods$Gender))
na&lt;-union(naord,nacov)
ordinal&lt;-relgoods$Physician[-na]; Y&lt;-relgoods$Gender[-na]
bbet&lt;-c(-0.81,0.93); ccsi&lt;-0.2
param&lt;-c(bbet,ccsi)
loglikcubp0&lt;-loglikCUB(ordinal,m,param,Y=Y)
#######################
## Log-likelihood of a CUB model with covariate for feeling
data(relgoods)
m&lt;-10
naord&lt;-which(is.na(relgoods$Physician))
nacov&lt;-which(is.na(relgoods$Gender))
na&lt;-union(naord,nacov)
ordinal&lt;-relgoods$Physician[-na]; W&lt;-relgoods$Gender[-na]
pai&lt;-0.44; gama&lt;-c(-0.91,-0.7)
param&lt;-c(pai,gama)
loglikcub0q&lt;-loglikCUB(ordinal,m,param,W=W)
#######################
## Log-likelihood of a CUB model with covariates for both parameters
data(relgoods)
m&lt;-10
naord&lt;-which(is.na(relgoods$Walking))
nacovpai&lt;-which(is.na(relgoods$Gender))
nacovcsi&lt;-which(is.na(relgoods$Smoking))
na&lt;-union(naord,union(nacovpai,nacovcsi))
ordinal&lt;-relgoods$Walking[-na]
Y&lt;-relgoods$Gender[-na]; W&lt;-relgoods$Smoking[-na]
bet&lt;-c(-0.45,-0.48); gama&lt;-c(-0.55,-0.43)
param&lt;-c(bet,gama)
loglikcubpq&lt;-loglikCUB(ordinal,m,param,Y=Y,W=W)
#######################
### Log-likelihood of a CUB model with shelter effect
m&lt;-7; n&lt;-400
pai&lt;-0.7; csi&lt;-0.16; delta&lt;-0.15
shelter&lt;-5
ordinal&lt;-simcubshe(n,m,pai,csi,delta,shelter)
pai1&lt;- pai*(1-delta); pai2&lt;-1-pai1-delta
param&lt;-c(pai1,pai2,csi)
loglik&lt;-loglikCUB(ordinal,m,param,shelter=shelter)
</code></pre>

<hr>
<h2 id='loglikcub00'>Log-likelihood function of a CUB model without covariates</h2><span id='topic+loglikcub00'></span>

<h3>Description</h3>

<p>Compute the log-likelihood function of a CUB model without covariates for a given
absolute frequency distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loglikcub00(m, freq, pai, csi)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loglikcub00_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="loglikcub00_+3A_freq">freq</code></td>
<td>
<p>Vector of the absolute frequency distribution</p>
</td></tr>
<tr><td><code id="loglikcub00_+3A_pai">pai</code></td>
<td>
<p>Uncertainty parameter</p>
</td></tr>
<tr><td><code id="loglikcub00_+3A_csi">csi</code></td>
<td>
<p>Feeling parameter</p>
</td></tr>
</table>

<hr>
<h2 id='loglikcub0q'>Log-likelihood function of a CUB model with covariates for the feeling component</h2><span id='topic+loglikcub0q'></span>

<h3>Description</h3>

<p>Compute the log-likelihood function of a CUB model fitting ordinal data, with <code class="reqn">q</code>
covariates for explaining the feeling component.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loglikcub0q(m, ordinal, W, pai, gama)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loglikcub0q_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="loglikcub0q_+3A_ordinal">ordinal</code></td>
<td>
<p>Vector of ordinal responses</p>
</td></tr>
<tr><td><code id="loglikcub0q_+3A_w">W</code></td>
<td>
<p>Matrix of selected covariates for explaining the feeling component</p>
</td></tr>
<tr><td><code id="loglikcub0q_+3A_pai">pai</code></td>
<td>
<p>Uncertainty parameter</p>
</td></tr>
<tr><td><code id="loglikcub0q_+3A_gama">gama</code></td>
<td>
<p>Vector of parameters for the feeling component, with length NCOL(W) + 1 to account for
an intercept term (first entry of gama)</p>
</td></tr>
</table>

<hr>
<h2 id='loglikCUBE'>Log-likelihood function for CUBE models</h2><span id='topic+loglikCUBE'></span>

<h3>Description</h3>

<p>Compute the log-likelihood function for CUBE models. It is possible to include
covariates in the model for explaining the feeling component or all the three parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loglikCUBE(ordinal,m,param,Y=0,W=0,Z=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loglikCUBE_+3A_ordinal">ordinal</code></td>
<td>
<p>Vector of ordinal responses</p>
</td></tr>
<tr><td><code id="loglikCUBE_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="loglikCUBE_+3A_param">param</code></td>
<td>
<p>Vector of parameters for the specified CUBE model</p>
</td></tr>
<tr><td><code id="loglikCUBE_+3A_y">Y</code></td>
<td>
<p>Matrix of selected covariates to explain the uncertainty component (default: no covariate is included
in the model)</p>
</td></tr>
<tr><td><code id="loglikCUBE_+3A_w">W</code></td>
<td>
<p>Matrix of selected covariates to explain the feeling component (default: no covariate is included
in the model)</p>
</td></tr>
<tr><td><code id="loglikCUBE_+3A_z">Z</code></td>
<td>
<p>Matrix of selected covariates to explain the overdispersion component (default: no covariate is included
in the model)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If no covariate is included in the model, then <code>param</code> has the form <code class="reqn">(\pi,\xi,\phi)</code>. More generally,
it has the form <code class="reqn">(\bold{\beta,\gamma,\alpha)}</code> where, respectively, <code class="reqn">\bold{\beta}</code>,<code class="reqn">\bold{\gamma}</code>, <code class="reqn">\bold{\alpha}</code>
are the vectors of  coefficients explaining the uncertainty, the feeling and the overdispersion components, with length NCOL(Y)+1,
NCOL(W)+1, NCOL(Z)+1 to account for an intercept term in the first entry. No missing value should be present neither
for <code>ordinal</code> nor for covariate matrices: thus, deletion or imputation procedures should be preliminarily run.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+logLik">logLik</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#### Log-likelihood of a CUBE model with no covariate
m&lt;-7; n&lt;-400
pai&lt;-0.83; csi&lt;-0.19; phi&lt;-0.045
ordinal&lt;-simcube(n,m,pai,csi,phi)
loglik&lt;-loglikCUBE(ordinal,m,param=c(pai,csi,phi))
##################################
#### Log-likelihood of a CUBE model with covariate for feeling
data(relgoods)
m&lt;-10
nacov&lt;-which(is.na(relgoods$BirthYear))
naord&lt;-which(is.na(relgoods$Tv))
na&lt;-union(nacov,naord)
age&lt;-2014-relgoods$BirthYear[-na]
lage&lt;-log(age)-mean(log(age))
ordinal&lt;-relgoods$Tv[-na]; W&lt;-lage
pai&lt;-0.63; gama&lt;-c(-0.61,-0.31); phi&lt;-0.16
param&lt;-c(pai,gama,phi)
loglik&lt;-loglikCUBE(ordinal,m,param,W=W)
########## Log-likelihood of a CUBE model with covariates for all parameters
Y&lt;-W&lt;-Z&lt;-lage
bet&lt;-c(0.18, 1.03); gama&lt;-c(-0.6, -0.3); alpha&lt;-c(-2.3,0.92)
param&lt;-c(bet,gama,alpha)
loglik&lt;-loglikCUBE(ordinal,m,param,Y=Y,W=W,Z=Z)
</code></pre>

<hr>
<h2 id='loglikcubecov'>Log-likelihood function of a CUBE model with covariates</h2><span id='topic+loglikcubecov'></span>

<h3>Description</h3>

<p>Compute the log-likelihood function of a CUBE model for ordinal responses,
with covariates for explaining all the three parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loglikcubecov(m, ordinal, Y, W, Z, bet, gama, alpha)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loglikcubecov_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="loglikcubecov_+3A_ordinal">ordinal</code></td>
<td>
<p>Vector of ordinal responses</p>
</td></tr>
<tr><td><code id="loglikcubecov_+3A_y">Y</code></td>
<td>
<p>Matrix of covariates for explaining the uncertainty component</p>
</td></tr>
<tr><td><code id="loglikcubecov_+3A_w">W</code></td>
<td>
<p>Matrix of covariates for explaining the feeling component</p>
</td></tr>
<tr><td><code id="loglikcubecov_+3A_z">Z</code></td>
<td>
<p>Matrix of covariates for explaining the overdispersion component</p>
</td></tr>
<tr><td><code id="loglikcubecov_+3A_bet">bet</code></td>
<td>
<p>Vector of parameters for the uncertainty component, with length equal to
NCOL(Y) + 1 to account for an intercept term (first entry of bet)</p>
</td></tr>
<tr><td><code id="loglikcubecov_+3A_gama">gama</code></td>
<td>
<p>Vector of parameters for the feeling component, with length equal to
NCOL(W) + 1 to account for an intercept term (first entry of gama)</p>
</td></tr>
<tr><td><code id="loglikcubecov_+3A_alpha">alpha</code></td>
<td>
<p>Vector of parameters for the overdispersion component, with length equal to
NCOL(Z) + 1 to account for an intercept term (first entry of alpha)</p>
</td></tr>
</table>

<hr>
<h2 id='loglikcubecsi'>Log-likelihood function of CUBE model with covariates only for feeling</h2><span id='topic+loglikcubecsi'></span>

<h3>Description</h3>

<p>Compute the log-likelihood function of a CUBE model for ordinal data with subjects'
covariates only for feeling.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loglikcubecsi(m, ordinal, W, pai, gama, phi)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loglikcubecsi_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="loglikcubecsi_+3A_ordinal">ordinal</code></td>
<td>
<p>Vector of ordinal responses</p>
</td></tr>
<tr><td><code id="loglikcubecsi_+3A_w">W</code></td>
<td>
<p>Matrix of covariates for explaining the feeling component</p>
</td></tr>
<tr><td><code id="loglikcubecsi_+3A_pai">pai</code></td>
<td>
<p>Uncertainty parameter</p>
</td></tr>
<tr><td><code id="loglikcubecsi_+3A_gama">gama</code></td>
<td>
<p>Vector of parameters for the feeling component, with length
equal to NCOL(W) + 1 to account for an intercept term (first entry of gama)</p>
</td></tr>
<tr><td><code id="loglikcubecsi_+3A_phi">phi</code></td>
<td>
<p>Overdispersion parameter</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>internal
</p>

<hr>
<h2 id='loglikcuben'>Log-likelihood function of CUBE models for ordinal data</h2><span id='topic+loglikcuben'></span>

<h3>Description</h3>

<p>Compute the log-likelihood function of a CUBE model
without covariates for ordinal responses, possibly with different
vectors of parameters for each observation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loglikcuben(m, ordinal, assepai, assecsi, assephi)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loglikcuben_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="loglikcuben_+3A_ordinal">ordinal</code></td>
<td>
<p>Vector of ordinal responses</p>
</td></tr>
<tr><td><code id="loglikcuben_+3A_assepai">assepai</code></td>
<td>
<p>Vector of uncertainty parameters for the given
observations (with the same length as ordinal)</p>
</td></tr>
<tr><td><code id="loglikcuben_+3A_assecsi">assecsi</code></td>
<td>
<p>Vector of feeling parameters for the given observations
(with the same length as ordinal)</p>
</td></tr>
<tr><td><code id="loglikcuben_+3A_assephi">assephi</code></td>
<td>
<p>Vector of overdispersion parameters for the given
observations (with the same length as ordinal)</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+loglikCUBE">loglikCUBE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>m&lt;-8
n0&lt;-230;  n1&lt;-270
bet&lt;-c(-1.5,1.2)
gama&lt;-c(0.5,-1.2)
alpha&lt;-c(-1.2,-0.5)
pai0&lt;-1/(1+exp(-bet[1])); csi0&lt;-1/(1+exp(-gama[1])); phi0&lt;-exp(alpha[1])
ordinal0&lt;-simcube(n0,m,pai0,csi0,phi0)
pai1&lt;-1/(1+exp(-sum(bet))); csi1&lt;-1/(1+exp(-sum(gama))); phi1&lt;-exp(sum(alpha))
ordinal1&lt;-simcube(n1,m,pai1,csi1,phi1)
ordinal&lt;-c(ordinal0,ordinal1)
assepai&lt;-c(rep(pai0,n0),rep(pai1,n1))
assecsi&lt;-c(rep(csi0,n0),rep(csi1,n1))
assephi&lt;-c(rep(phi0,n0),rep(phi1,n1))
lli&lt;-loglikcuben(m,ordinal,assepai,assecsi,assephi)
</code></pre>

<hr>
<h2 id='loglikcubp0'>Log-likelihood function of a CUB model with covariates for the uncertainty component</h2><span id='topic+loglikcubp0'></span>

<h3>Description</h3>

<p>Compute the log-likelihood function of a CUB model fitting ordinal responses with covariates
for explaining the uncertainty component.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loglikcubp0(m, ordinal, Y, bbet, ccsi)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loglikcubp0_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="loglikcubp0_+3A_ordinal">ordinal</code></td>
<td>
<p>Vector of ordinal responses</p>
</td></tr>
<tr><td><code id="loglikcubp0_+3A_y">Y</code></td>
<td>
<p>Matrix of selected covariates for explaining the uncertainty component</p>
</td></tr>
<tr><td><code id="loglikcubp0_+3A_bbet">bbet</code></td>
<td>
<p>Vector of parameters for the uncertainty component, with length equal to
NCOL(Y)+1 to account for an intercept term (first entry of bbet)</p>
</td></tr>
<tr><td><code id="loglikcubp0_+3A_ccsi">ccsi</code></td>
<td>
<p>Feeling parameter</p>
</td></tr>
</table>

<hr>
<h2 id='loglikcubpq'>Log-likelihood function of a CUB model with covariates for both feeling and uncertainty</h2><span id='topic+loglikcubpq'></span>

<h3>Description</h3>

<p>Compute the log-likelihood function of a CUB model fitting ordinal data
with covariates for explaining both the feeling and the uncertainty components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loglikcubpq(m, ordinal, Y, W, bet, gama)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loglikcubpq_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="loglikcubpq_+3A_ordinal">ordinal</code></td>
<td>
<p>Vector of ordinal responses</p>
</td></tr>
<tr><td><code id="loglikcubpq_+3A_y">Y</code></td>
<td>
<p>Matrix of selected covariates for explaining the uncertainty component</p>
</td></tr>
<tr><td><code id="loglikcubpq_+3A_w">W</code></td>
<td>
<p>Matrix of selected covariates for explaining the feeling component</p>
</td></tr>
<tr><td><code id="loglikcubpq_+3A_bet">bet</code></td>
<td>
<p>Vector of parameters for the uncertainty component, with length equal to
NCOL(Y)+1 to account for an intercept term (first entry of bbet)</p>
</td></tr>
<tr><td><code id="loglikcubpq_+3A_gama">gama</code></td>
<td>
<p>Vector of parameters for the feeling component, whose length equals
NCOL(W) + 1 to account for an intercept term (first entry of gama)</p>
</td></tr>
</table>

<hr>
<h2 id='loglikcubshe'>Log-likelihood of a CUB model with shelter effect</h2><span id='topic+loglikcubshe'></span>

<h3>Description</h3>

<p>Compute the log-likelihood of a CUB model with a shelter effect
for the given absolute frequency distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loglikcubshe(m, freq, pai1, pai2, csi, shelter)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loglikcubshe_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="loglikcubshe_+3A_freq">freq</code></td>
<td>
<p>Vector of the absolute frequency distribution</p>
</td></tr>
<tr><td><code id="loglikcubshe_+3A_pai1">pai1</code></td>
<td>
<p>Mixing coefficient for the shifted Binomial component of the mixture distribution</p>
</td></tr>
<tr><td><code id="loglikcubshe_+3A_pai2">pai2</code></td>
<td>
<p>Mixing coefficient for the discrete Uniform component of the mixture distribution</p>
</td></tr>
<tr><td><code id="loglikcubshe_+3A_csi">csi</code></td>
<td>
<p>Feeling parameter</p>
</td></tr>
<tr><td><code id="loglikcubshe_+3A_shelter">shelter</code></td>
<td>
<p>Category corresponding to the shelter choice</p>
</td></tr>
</table>

<hr>
<h2 id='loglikCUSH'>Log-likelihood function for CUSH models</h2><span id='topic+loglikCUSH'></span>

<h3>Description</h3>

<p>Compute the log-likelihood function for CUSH models with or without covariates
to explain the shelter effect.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loglikCUSH(ordinal,m,param,shelter,X=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loglikCUSH_+3A_ordinal">ordinal</code></td>
<td>
<p>Vector of ordinal responses</p>
</td></tr>
<tr><td><code id="loglikCUSH_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="loglikCUSH_+3A_param">param</code></td>
<td>
<p>Vector of parameters for the specified CUSH model</p>
</td></tr>
<tr><td><code id="loglikCUSH_+3A_shelter">shelter</code></td>
<td>
<p>Category corresponding to the shelter choice</p>
</td></tr>
<tr><td><code id="loglikCUSH_+3A_x">X</code></td>
<td>
<p>Matrix of selected covariates to explain the shelter effect (default: no covariate
is included in the model)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If no covariate is included in the model, then <code>param</code> is the estimate of the shelter
parameter (delta), otherwise <code>param</code> has length equal to NCOL(X) + 1 to account for an intercept
term (first entry). No missing value should be present neither for <code>ordinal</code> nor for <code>X</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GEM">GEM</a></code>, <code><a href="stats.html#topic+logLik">logLik</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Log-likelihood of CUSH model without covariates
n&lt;-300
m&lt;-7
shelter&lt;-2; delta&lt;-0.4
ordinal&lt;-simcush(n,m,delta,shelter)
loglik&lt;-loglikCUSH(ordinal,m,param=delta,shelter)
#####################
## Log-likelihood of CUSH model with covariates
data(relgoods)
m&lt;-10
naord&lt;-which(is.na(relgoods$SocialNetwork))
nacov&lt;-which(is.na(relgoods$Gender))
na&lt;-union(nacov,naord)
ordinal&lt;-relgoods$SocialNetwork[-na]; cov&lt;-relgoods$Gender[-na]
omega&lt;-c(-2.29, 0.62)
loglikcov&lt;-loglikCUSH(ordinal,m,param=omega,shelter=1,X=cov)
</code></pre>

<hr>
<h2 id='loglikcush00'>Log-likelihood function for a CUSH model without covariates</h2><span id='topic+loglikcush00'></span>

<h3>Description</h3>

<p>Compute the log-likelihood function for a CUSH model
without covariate for the given ordinal responses.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loglikcush00(m,ordinal,delta,shelter)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loglikcush00_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="loglikcush00_+3A_ordinal">ordinal</code></td>
<td>
<p>Vector of ordinal responses</p>
</td></tr>
<tr><td><code id="loglikcush00_+3A_delta">delta</code></td>
<td>
<p>Shelter parameter</p>
</td></tr>
<tr><td><code id="loglikcush00_+3A_shelter">shelter</code></td>
<td>
<p>Category corresponding to the shelter choice</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+GEM">GEM</a></code>
</p>

<hr>
<h2 id='loglikcushcov'>Log-likelihood function for a CUSH model with covariates</h2><span id='topic+loglikcushcov'></span>

<h3>Description</h3>

<p>Compute the log-likelihood function for a CUSH model
with covariates for the given ordinal responses.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loglikcushcov(m, ordinal, X, omega, shelter)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loglikcushcov_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="loglikcushcov_+3A_ordinal">ordinal</code></td>
<td>
<p>Vector of ordinal responses</p>
</td></tr>
<tr><td><code id="loglikcushcov_+3A_x">X</code></td>
<td>
<p>Matrix of selected covariates for explaining the shelter parameter</p>
</td></tr>
<tr><td><code id="loglikcushcov_+3A_omega">omega</code></td>
<td>
<p>Vector of parameters for explaining the shelter effect,
with length equal to NCOL(X)+1 to account for an intercept term (first entry of omega)</p>
</td></tr>
<tr><td><code id="loglikcushcov_+3A_shelter">shelter</code></td>
<td>
<p>Category corresponding to the shelter choice</p>
</td></tr>
</table>

<hr>
<h2 id='loglikIHG'>Log-likelihood function for IHG models</h2><span id='topic+loglikIHG'></span>

<h3>Description</h3>

<p>Compute the log-likelihood function for IHG models with or without covariates
to explain the preference parameter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loglikIHG(ordinal,m,param,U=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loglikIHG_+3A_ordinal">ordinal</code></td>
<td>
<p>Vector of ordinal responses</p>
</td></tr>
<tr><td><code id="loglikIHG_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="loglikIHG_+3A_param">param</code></td>
<td>
<p>Vector of parameters for the specified IHG model</p>
</td></tr>
<tr><td><code id="loglikIHG_+3A_u">U</code></td>
<td>
<p>Matrix of selected covariates to explain the preference parameter (default: no covariate is included
in the model)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If no covariate is included in the model, then <code>param</code> is the estimate of the preference
parameter (<code class="reqn">theta</code>), otherwise <code>param</code> has length equal to NCOL(U) + 1 to account for an intercept
term (first entry). No missing value should be present neither for <code>ordinal</code> nor for <code>U</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GEM">GEM</a></code>, <code><a href="stats.html#topic+logLik">logLik</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#### Log-likelihood of an IHG model with no covariate
m&lt;-10; theta&lt;-0.14; n&lt;-300
ordinal&lt;-simihg(n,m,theta)
loglik&lt;-loglikIHG(ordinal,m,param=theta)
##################################
#### Log-likelihood of a IHG model with covariate 
data(relgoods)
m&lt;-10
naord&lt;-which(is.na(relgoods$HandWork))
nacov&lt;-which(is.na(relgoods$Gender))
na&lt;-union(naord,nacov)
ordinal&lt;-relgoods$HandWork[-na]; U&lt;-relgoods$Gender[-na]
nu&lt;-c(-1.55,-0.11)     # first entry: intercept term
loglik&lt;-loglikIHG(ordinal,m,param=nu,U=U); loglik
</code></pre>

<hr>
<h2 id='loglikihgcov'>Log-likelihood function for the IHG model with covariates</h2><span id='topic+loglikihgcov'></span>

<h3>Description</h3>

<p>Compute the log-likelihood function for the IHG model
with covariates to explain the preference parameter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loglikihgcov(m, ordinal, U, nu)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loglikihgcov_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="loglikihgcov_+3A_ordinal">ordinal</code></td>
<td>
<p>Vector of ordinal responses</p>
</td></tr>
<tr><td><code id="loglikihgcov_+3A_u">U</code></td>
<td>
<p>Matrix of selected covariates for explaining the preference parameter</p>
</td></tr>
<tr><td><code id="loglikihgcov_+3A_nu">nu</code></td>
<td>
<p>Vector of coefficients for covariates, whose length equals NCOL(U)+1 to include
an intercept term in the model (first entry of nu)</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>loglikIHG
</p>

<hr>
<h2 id='logscore'>Logarithmic score</h2><span id='topic+logscore'></span>

<h3>Description</h3>

<p>Compute the logarithmic score of a CUB model with covariates both for the uncertainty
and the feeling parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logscore(m,ordinal,Y,W,bet,gama)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logscore_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="logscore_+3A_ordinal">ordinal</code></td>
<td>
<p>Vector of ordinal responses</p>
</td></tr>
<tr><td><code id="logscore_+3A_y">Y</code></td>
<td>
<p>Matrix of covariates for explaining the uncertainty component</p>
</td></tr>
<tr><td><code id="logscore_+3A_w">W</code></td>
<td>
<p>Matrix of covariates for explaining the feeling component</p>
</td></tr>
<tr><td><code id="logscore_+3A_bet">bet</code></td>
<td>
<p>Vector of parameters for the uncertainty component, with length NCOL(Y)+1
to account for an intercept term (first entry of <code>bet</code>)</p>
</td></tr>
<tr><td><code id="logscore_+3A_gama">gama</code></td>
<td>
<p>Vector of parameters for the feeling component, with length NCOL(W)+1
to account for an intercept term (first entry of <code>gama</code>)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>No missing value should be present neither
for <code>ordinal</code> nor for covariate matrices: thus, deletion or imputation procedures should be
preliminarily run.
</p>


<h3>References</h3>

<p>Tutz, G. (2012). <em>Regression for Categorical Data</em>, Cambridge University Press, Cambridge
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(relgoods)
m&lt;-10
naord&lt;-which(is.na(relgoods$Walking))
nacovpai&lt;-which(is.na(relgoods$Gender))
nacovcsi&lt;-which(is.na(relgoods$Smoking))
na&lt;-union(naord,union(nacovpai,nacovcsi))
ordinal&lt;-relgoods$Walking[-na]
Y&lt;-relgoods$Gender[-na]
W&lt;-relgoods$Smoking[-na]
bet&lt;-c(-0.45,-0.48)
gama&lt;-c(-0.55,-0.43)
logscore(m,ordinal,Y=Y,W=W,bet,gama)
</code></pre>

<hr>
<h2 id='makeplot'>Plot facilities for GEM objects</h2><span id='topic+makeplot'></span>

<h3>Description</h3>

<p>Plot facilities for objects of class &quot;GEM&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>makeplot(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="makeplot_+3A_object">object</code></td>
<td>
<p>An object of class &quot;GEM&quot;</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Returns a plot comparing fitted
probabilities and observed relative frequencies for GEM models without covariates. If only one
explanatory dichotomous variable is included in the model for one or all components,
then the function returns a plot comparing the distributions of the responses conditioned to
the value of the covariate.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cubvisual">cubvisual</a></code>, <code><a href="#topic+cubevisual">cubevisual</a></code>, <code><a href="#topic+cubshevisual">cubshevisual</a></code>,
<code><a href="#topic+multicub">multicub</a></code>, <code><a href="#topic+multicube">multicube</a></code>
</p>

<hr>
<h2 id='multicub'>Joint plot of estimated CUB models in the parameter space</h2><span id='topic+multicub'></span>

<h3>Description</h3>

<p>Return a plot of estimated CUB models represented as points in the parameter space.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multicub(listord,mvett,csiplot=FALSE,paiplot=FALSE,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="multicub_+3A_listord">listord</code></td>
<td>
<p>A data matrix, data frame, or list of vectors of ordinal observations (for variables
with different number of observations)</p>
</td></tr>
<tr><td><code id="multicub_+3A_mvett">mvett</code></td>
<td>
<p>Vector of number of categories for ordinal variables in <code>listord</code> (optional: if missing,
the number of categories is retrieved from data: it is advisable to specify it in case some category has zero
frequency)</p>
</td></tr>
<tr><td><code id="multicub_+3A_csiplot">csiplot</code></td>
<td>
<p>Logical: should <code class="reqn">\xi</code> or <code class="reqn">1-\xi</code> be the <code class="reqn">y</code> coordinate</p>
</td></tr>
<tr><td><code id="multicub_+3A_paiplot">paiplot</code></td>
<td>
<p>Logical: should <code class="reqn">\pi</code> or <code class="reqn">1-\pi</code> be the <code class="reqn">x</code> coordinate</p>
</td></tr>
<tr><td><code id="multicub_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to <code><a href="graphics.html#topic+plot">plot</a></code>, <code><a href="graphics.html#topic+text">text</a></code>, and <code><a href="#topic+GEM">GEM</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Fit a CUB model to list elements, and then by default it returns a plot of the estimated
<code class="reqn">(1-\pi, 1-\xi)</code> as points in the parameter space. Depending on <code>csiplot</code> and <code>paiplot</code>
and on desired output, <code class="reqn">x</code> and <code class="reqn">y</code> coordinates may be set to <code class="reqn">\pi</code> and <code class="reqn">\xi</code>, respectively.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(univer)
listord&lt;-univer[,8:12]
multicub(listord,colours=rep("red",5),cex=c(0.4,0.6,0.8,1,1.2),
  pch=c(1,2,3,4,5),xlim=c(0,0.4),ylim=c(0.75,1),pos=c(1,3,3,3,3))
###############################
m1&lt;-5; m2&lt;-7;  m3&lt;-9
pai&lt;-0.7;csi&lt;-0.6
n1&lt;-1000; n2&lt;-500; n3&lt;-1500
ord1&lt;-simcub(n1,m1,pai,csi)
ord2&lt;-simcub(n2,m2,pai,csi)
ord3&lt;-simcub(n3,m3,pai,csi)
listord&lt;-list(ord1,ord2,ord3)
multicub(listord,labels=c("m=5","m=7","m=9"),pos=c(3,1,4))
</code></pre>

<hr>
<h2 id='multicube'>Joint plot of estimated CUBE models in the parameter space</h2><span id='topic+multicube'></span>

<h3>Description</h3>

<p>Return a plot of estimated CUBE models represented as points in the
parameter space, where the overdispersion is labeled.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multicube(listord,mvett,csiplot=FALSE,paiplot=FALSE,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="multicube_+3A_listord">listord</code></td>
<td>
<p>A data matrix, data frame, or list of vectors of ordinal observations (for variables
with different number of observations)</p>
</td></tr>
<tr><td><code id="multicube_+3A_mvett">mvett</code></td>
<td>
<p>Vector of number of categories for ordinal variables in <code>listord</code> (optional: if missing,
the number of categories is retrieved from data: it is advisable to specify it in case some category has zero
frequency)</p>
</td></tr>
<tr><td><code id="multicube_+3A_csiplot">csiplot</code></td>
<td>
<p>Logical: should <code class="reqn">\xi</code> or <code class="reqn">1-\xi</code> be the <code class="reqn">y</code> coordinate</p>
</td></tr>
<tr><td><code id="multicube_+3A_paiplot">paiplot</code></td>
<td>
<p>Logical: should <code class="reqn">\pi</code> or <code class="reqn">1-\pi</code> be the <code class="reqn">x</code> coordinate</p>
</td></tr>
<tr><td><code id="multicube_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to <code><a href="graphics.html#topic+plot">plot</a></code>, <code><a href="graphics.html#topic+text">text</a></code>, and <code><a href="#topic+GEM">GEM</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Fit a CUBE model to list elements, and then by default it returns a plot of the estimated
<code class="reqn">(1-\pi, 1-\xi)</code> as points in the parameter space, labeled with the estimated overdispersion.
Depending on <code>csiplot</code> and <code>paiplot</code> and on desired output, <code class="reqn">x</code> and <code class="reqn">y</code>
coordinates may be set to <code class="reqn">\pi</code> and <code class="reqn">\xi</code>, respectively.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>m1&lt;-5; m2&lt;-7;  m3&lt;-9
pai&lt;-0.7;csi&lt;-0.6;phi=0.1
n1&lt;-1000; n2&lt;-500; n3&lt;-1500
ord1&lt;-simcube(n1,m1,pai,csi,phi)
ord2&lt;-simcube(n2,m2,pai,csi,phi)
ord3&lt;-simcube(n3,m3,pai,csi,phi)
listord&lt;-list(ord1,ord2,ord3)
multicube(listord,labels=c("m=5","m=7","m=9"),pos=c(3,1,4),expinform=TRUE)
</code></pre>

<hr>
<h2 id='parnames'>Generic function for coefficient names</h2><span id='topic+parnames'></span><span id='topic+parnames.GEM'></span>

<h3>Description</h3>

<p>Generic function for names of parameter estimates of object of class &quot;GEM&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parnames(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="parnames_+3A_object">object</code></td>
<td>
<p>An object of class &quot;GEM&quot;</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="base.html#topic+summary">summary</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(univer);attach(univer)
model&lt;-GEM(Formula(officeho~0|0|0),family="cub",shelter=7)
model 
</code></pre>

<hr>
<h2 id='plotloglikihg'>Plot of the log-likelihood function of the IHG distribution</h2><span id='topic+plotloglikihg'></span>

<h3>Description</h3>

<p>Plot the log-likelihood function of an IHG model fitted to a given absolute frequency distribution,
over the whole support of the preference parameter. It returns also the ML estimate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotloglikihg(m,freq)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotloglikihg_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="plotloglikihg_+3A_freq">freq</code></td>
<td>
<p>Vector of the absolute frequency distribution</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+loglikIHG">loglikIHG</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>m&lt;-7
freq&lt;-c(828,275,202,178,143,110,101)
max&lt;-plotloglikihg(m,freq)
</code></pre>

<hr>
<h2 id='print.GEM'>S3 method: print for class &quot;GEM&quot;</h2><span id='topic+print.GEM'></span>

<h3>Description</h3>

<p>S3 method print for objects of class <code><a href="#topic+GEM">GEM</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'GEM'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.GEM_+3A_x">x</code></td>
<td>
<p>An object of class <code><a href="#topic+GEM">GEM</a></code></p>
</td></tr>
<tr><td><code id="print.GEM_+3A_...">...</code></td>
<td>
<p>Other arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Brief summary results of the fitting procedure, including parameter estimates, their standard errors and
the executed call.
</p>

<hr>
<h2 id='probbit'>Probability distribution of a shifted Binomial random variable</h2><span id='topic+probbit'></span>

<h3>Description</h3>

<p>Return the shifted Binomial probability distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>probbit(m,csi)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="probbit_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="probbit_+3A_csi">csi</code></td>
<td>
<p>Feeling parameter</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The vector of the probability distribution of a shifted Binomial model.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bitcsi">bitcsi</a></code>, <code><a href="#topic+probcub00">probcub00</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>m&lt;-7
csi&lt;-0.7
pr&lt;-probbit(m,csi)
plot(1:m,pr,type="h",main="Shifted Binomial probability distribution",xlab="Categories")
points(1:m,pr,pch=19)
</code></pre>

<hr>
<h2 id='probcub00'>Probability distribution of a CUB model without covariates</h2><span id='topic+probcub00'></span>

<h3>Description</h3>

<p>Compute the probability distribution of a CUB model without covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>probcub00(m,pai,csi)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="probcub00_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="probcub00_+3A_pai">pai</code></td>
<td>
<p>Uncertainty parameter</p>
</td></tr>
<tr><td><code id="probcub00_+3A_csi">csi</code></td>
<td>
<p>Feeling parameter</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The vector of the probability distribution of a CUB model.
</p>


<h3>References</h3>

<p>Piccolo D. (2003). On the moments of a mixture of uniform and shifted binomial random variables.
<em>Quaderni di Statistica</em>, <b>5</b>, 85&ndash;104<br />
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bitcsi">bitcsi</a></code>, <code><a href="#topic+probcub0q">probcub0q</a></code>, <code><a href="#topic+probcubp0">probcubp0</a></code>, <code><a href="#topic+probcubpq">probcubpq</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>m&lt;-9
pai&lt;-0.3
csi&lt;-0.8
pr&lt;-probcub00(m,pai,csi)
plot(1:m,pr,type="h",main="CUB probability distribution",xlab="Ordinal categories")
points(1:m,pr,pch=19)
</code></pre>

<hr>
<h2 id='probcub0q'>Probability distribution of a CUB model with covariates for the feeling component</h2><span id='topic+probcub0q'></span>

<h3>Description</h3>

<p>Compute the probability distribution of a CUB model with covariates
for the feeling component.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>probcub0q(m,ordinal,W,pai,gama)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="probcub0q_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="probcub0q_+3A_ordinal">ordinal</code></td>
<td>
<p>Vector of ordinal responses</p>
</td></tr>
<tr><td><code id="probcub0q_+3A_w">W</code></td>
<td>
<p>Matrix of covariates for explaining the feeling component
NCOL(Y)+1 to include an intercept term in the model (first entry)</p>
</td></tr>
<tr><td><code id="probcub0q_+3A_pai">pai</code></td>
<td>
<p>Uncertainty parameter</p>
</td></tr>
<tr><td><code id="probcub0q_+3A_gama">gama</code></td>
<td>
<p>Vector of parameters for the feeling component, whose length equals
NCOL(W)+1 to include an intercept term in the model (first entry)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of the same length as <code>ordinal</code>, whose i-th component is the
probability of the i-th observation according to a CUB distribution with the corresponding values
of the covariates for the feeling component and coefficients specified in <code>gama</code>.
</p>


<h3>References</h3>

<p>Piccolo D. (2006). Observed Information Matrix for MUB Models,
<em>Quaderni di Statistica</em>, <b>8</b>, 33&ndash;78 <br />
Piccolo D. and D'Elia A. (2008). A new approach for modelling consumers' preferences, <em>Food Quality and Preference</em>,
<b>18</b>, 247&ndash;259 <br />
Iannario M. and Piccolo D. (2012). CUB models: Statistical methods and empirical evidence, in:
Kenett R. S. and Salini S. (eds.), <em>Modern Analysis of Customer Surveys: with applications using R</em>,
J. Wiley and Sons, Chichester, 231&ndash;258
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bitgama">bitgama</a></code>, <code><a href="#topic+probcub00">probcub00</a></code>, <code><a href="#topic+probcubp0">probcubp0</a></code>,
<code><a href="#topic+probcubpq">probcubpq</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(relgoods)
m&lt;-10
naord&lt;-which(is.na(relgoods$Physician))
nacov&lt;-which(is.na(relgoods$Gender))
na&lt;-union(naord,nacov)
ordinal&lt;-relgoods$Physician[-na]
W&lt;-relgoods$Gender[-na]
pai&lt;-0.44; gama&lt;-c(-0.91,-0.7)
pr&lt;-probcub0q(m,ordinal,W,pai,gama)
</code></pre>

<hr>
<h2 id='probcube'>Probability distribution of a CUBE model without covariates</h2><span id='topic+probcube'></span>

<h3>Description</h3>

<p>Compute the probability distribution of a CUBE model without covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>probcube(m,pai,csi,phi)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="probcube_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="probcube_+3A_pai">pai</code></td>
<td>
<p>Uncertainty parameter</p>
</td></tr>
<tr><td><code id="probcube_+3A_csi">csi</code></td>
<td>
<p>Feeling parameter</p>
</td></tr>
<tr><td><code id="probcube_+3A_phi">phi</code></td>
<td>
<p>Overdispersion parameter</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The vector of the probability distribution of a CUBE model without covariates.
</p>


<h3>References</h3>

<p>Iannario, M. (2014). Modelling Uncertainty and Overdispersion in Ordinal Data,
<em>Communications in Statistics - Theory and Methods</em>, <b>43</b>, 771&ndash;786
</p>


<h3>See Also</h3>

<p><code><a href="#topic+betar">betar</a></code>, <code><a href="#topic+betabinomial">betabinomial</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>m&lt;-9
pai&lt;-0.3
csi&lt;-0.8
phi&lt;-0.1
pr&lt;-probcube(m,pai,csi,phi)
plot(1:m,pr,type="h", main="CUBE probability distribution",xlab="Ordinal categories")
points(1:m,pr,pch=19)
</code></pre>

<hr>
<h2 id='probcubp0'>Probability distribution of a CUB model with covariates for the uncertainty component</h2><span id='topic+probcubp0'></span>

<h3>Description</h3>

<p>Compute the probability distribution of a CUB model with covariates for the
uncertainty component.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>probcubp0(m,ordinal,Y,bet,csi)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="probcubp0_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="probcubp0_+3A_ordinal">ordinal</code></td>
<td>
<p>Vector of ordinal responses</p>
</td></tr>
<tr><td><code id="probcubp0_+3A_y">Y</code></td>
<td>
<p>Matrix of covariates for explaining the uncertainty component</p>
</td></tr>
<tr><td><code id="probcubp0_+3A_bet">bet</code></td>
<td>
<p>Vector of parameters for the uncertainty component, whose length equals
NCOL(Y) + 1 to include an intercept term in the model (first entry)</p>
</td></tr>
<tr><td><code id="probcubp0_+3A_csi">csi</code></td>
<td>
<p>Feeling parameter</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of the same length as <code>ordinal</code>, whose i-th component is the probability of the i-th
observation according to a CUB model with the corresponding values of the covariates for the
uncertainty component and coefficients for the covariates specified in <code>bet</code>.
</p>


<h3>References</h3>

<p>Piccolo D. (2006). Observed Information Matrix for MUB Models,
<em>Quaderni di Statistica</em>, <b>8</b>, 33&ndash;78 <br />
Piccolo D. and D'Elia A. (2008). A new approach for modelling consumers' preferences, <em>Food Quality and Preference</em>,
<b>18</b>, 247&ndash;259 <br />
Iannario M. and Piccolo D. (2012). CUB models: Statistical methods and empirical evidence, in:
Kenett R. S. and Salini S. (eds.), <em>Modern Analysis of Customer Surveys: with applications using R</em>,
J. Wiley and Sons, Chichester, 231&ndash;258
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bitgama">bitgama</a></code>, <code><a href="#topic+probcub00">probcub00</a></code>, <code><a href="#topic+probcubpq">probcubpq</a></code>, <code><a href="#topic+probcub0q">probcub0q</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(relgoods)
m&lt;-10
naord&lt;-which(is.na(relgoods$Physician))
nacov&lt;-which(is.na(relgoods$Gender))
na&lt;-union(naord,nacov)
ordinal&lt;-relgoods$Physician[-na]
Y&lt;-relgoods$Gender[-na]
bet&lt;-c(-0.81,0.93); csi&lt;-0.20
probi&lt;-probcubp0(m,ordinal,Y,bet,csi)
</code></pre>

<hr>
<h2 id='probcubpq'>Probability distribution of a CUB model with covariates for both feeling and uncertainty</h2><span id='topic+probcubpq'></span>

<h3>Description</h3>

<p>Compute the probability distribution of a CUB model with covariates for both the feeling
and the uncertainty components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>probcubpq(m,ordinal,Y,W,bet,gama)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="probcubpq_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="probcubpq_+3A_ordinal">ordinal</code></td>
<td>
<p>Vector of ordinal responses</p>
</td></tr>
<tr><td><code id="probcubpq_+3A_y">Y</code></td>
<td>
<p>Matrix of covariates for explaining the uncertainty component</p>
</td></tr>
<tr><td><code id="probcubpq_+3A_w">W</code></td>
<td>
<p>Matrix of covariates for explaining the feeling component</p>
</td></tr>
<tr><td><code id="probcubpq_+3A_bet">bet</code></td>
<td>
<p>Vector of parameters for the uncertainty component, whose length equals
NCOL(Y) + 1 to include an intercept term in the model (first entry)</p>
</td></tr>
<tr><td><code id="probcubpq_+3A_gama">gama</code></td>
<td>
<p>Vector of parameters for the feeling component, whose length equals
NCOL(W)+1 to include an intercept term in the model (first entry)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of the same length as <code>ordinal</code>, whose i-th component is the probability of the
i-th rating according to a CUB distribution with given covariates for both uncertainty and feeling,
and specified coefficients vectors <code>bet</code> and <code>gama</code>, respectively.
</p>


<h3>References</h3>

<p>Piccolo D. (2006). Observed Information Matrix for MUB Models,
<em>Quaderni di Statistica</em>, <b>8</b>, 33&ndash;78 <br />
Piccolo D. and D'Elia A. (2008). A new approach for modelling consumers' preferences, <em>Food Quality and Preference</em>,
<b>18</b>, 247&ndash;259 <br />
Iannario M. and Piccolo D. (2012). CUB models: Statistical methods and empirical evidence, in:
Kenett R. S. and Salini S. (eds.), <em>Modern Analysis of Customer Surveys: with applications using R</em>,
J. Wiley and Sons, Chichester, 231&ndash;258
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bitgama">bitgama</a></code>, <code><a href="#topic+probcub00">probcub00</a></code>, <code><a href="#topic+probcubp0">probcubp0</a></code>, <code><a href="#topic+probcub0q">probcub0q</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(relgoods)
m&lt;-10
naord&lt;-which(is.na(relgoods$Physician))
nacov&lt;-which(is.na(relgoods$Gender))
na&lt;-union(naord,nacov)
ordinal&lt;-relgoods$Physician[-na]
W&lt;-Y&lt;-relgoods$Gender[-na]
gama&lt;-c(-0.91,-0.7); bet&lt;-c(-0.81,0.93)
probi&lt;-probcubpq(m,ordinal,Y,W,bet,gama)
</code></pre>

<hr>
<h2 id='probcubshe1'>probcubshe1</h2><span id='topic+probcubshe1'></span>

<h3>Description</h3>

<p>Probability distribution of an extended CUB model with a shelter effect.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>probcubshe1(m,pai1,pai2,csi,shelter)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="probcubshe1_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="probcubshe1_+3A_pai1">pai1</code></td>
<td>
<p>Mixing coefficient for the shifted Binomial component of the mixture distribution</p>
</td></tr>
<tr><td><code id="probcubshe1_+3A_pai2">pai2</code></td>
<td>
<p>Mixing coefficient for the discrete Uniform component of the mixture distribution</p>
</td></tr>
<tr><td><code id="probcubshe1_+3A_csi">csi</code></td>
<td>
<p>Feeling parameter</p>
</td></tr>
<tr><td><code id="probcubshe1_+3A_shelter">shelter</code></td>
<td>
<p>Category corresponding to the shelter choice</p>
</td></tr>
</table>


<h3>Details</h3>

<p>An extended CUB model is a mixture of three components: a shifted Binomial distribution
with probability of success <code class="reqn">\xi</code>, a discrete uniform distribution with support <code class="reqn">\{1,...,m\}</code>,
and a degenerate distribution with unit mass at the shelter category (<code>shelter</code>).
</p>


<h3>Value</h3>

<p>The vector of the probability distribution of an extended CUB model with a shelter effect
at the shelter category
</p>


<h3>References</h3>

<p>Iannario M. (2012). Modelling <em>shelter</em> choices in a class of mixture models for ordinal responses,
<em>Statistical Methods and Applications</em>, <b>21</b>, 1&ndash;22 <br />
</p>


<h3>See Also</h3>

<p><code><a href="#topic+probcubshe2">probcubshe2</a></code>, <code><a href="#topic+probcubshe3">probcubshe3</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>m&lt;-8
pai1&lt;-0.5
pai2&lt;-0.3
csi&lt;-0.4
shelter&lt;-6
pr&lt;-probcubshe1(m,pai1,pai2,csi,shelter)
plot(1:m,pr,type="h",main="Extended CUB probability distribution with shelter effect",
xlab="Ordinal categories")
points(1:m,pr,pch=19)
</code></pre>

<hr>
<h2 id='probcubshe2'>probcubshe2</h2><span id='topic+probcubshe2'></span>

<h3>Description</h3>

<p>Probability distribution of a CUB model with explicit shelter effect
</p>


<h3>Usage</h3>

<pre><code class='language-R'>probcubshe2(m,pai,csi,delta,shelter)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="probcubshe2_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="probcubshe2_+3A_pai">pai</code></td>
<td>
<p>Uncertainty parameter</p>
</td></tr>
<tr><td><code id="probcubshe2_+3A_csi">csi</code></td>
<td>
<p>Feeling parameter</p>
</td></tr>
<tr><td><code id="probcubshe2_+3A_delta">delta</code></td>
<td>
<p>Shelter parameter</p>
</td></tr>
<tr><td><code id="probcubshe2_+3A_shelter">shelter</code></td>
<td>
<p>Category corresponding to the shelter choice</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A CUB model with explicit shelter effect is a mixture of two components:
a CUB distribution with uncertainty parameter <code class="reqn">\pi</code>  and feeling parameter <code class="reqn">\xi</code>,
and  a degenerate distribution with unit mass at the shelter category (<code>shelter</code>)
with mixing coefficient specified by <code class="reqn">\delta</code>.
</p>


<h3>Value</h3>

<p>The vector of the probability distribution of a CUB model with explicit shelter effect.
</p>


<h3>References</h3>

<p>Iannario M. (2012). Modelling <em>shelter</em> choices in a class of mixture models for ordinal responses,
<em>Statistical Methods and Applications</em>, <b>21</b>, 1&ndash;22 <br />
</p>


<h3>See Also</h3>

<p><code><a href="#topic+probcubshe1">probcubshe1</a></code>, <code><a href="#topic+probcubshe3">probcubshe3</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>m&lt;-8
pai1&lt;-0.5
pai2&lt;-0.3
csi&lt;-0.4
shelter&lt;-6
delta&lt;-1-pai1-pai2
pai&lt;-pai1/(1-delta)
pr2&lt;-probcubshe2(m,pai,csi,delta,shelter)
plot(1:m,pr2,type="h", main="CUB probability distribution with 
explicit shelter effect",xlab="Ordinal categories")
points(1:m,pr2,pch=19)
</code></pre>

<hr>
<h2 id='probcubshe3'>probcubshe3</h2><span id='topic+probcubshe3'></span>

<h3>Description</h3>

<p>Probability distribution of a CUB model with explicit shelter effect:
satisficing interpretation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>probcubshe3(m,lambda,eta,csi,shelter)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="probcubshe3_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="probcubshe3_+3A_lambda">lambda</code></td>
<td>
<p>Mixing coefficient for the shifted Binomial component</p>
</td></tr>
<tr><td><code id="probcubshe3_+3A_eta">eta</code></td>
<td>
<p>Mixing coefficient for the mixture of the uncertainty component and the
shelter effect</p>
</td></tr>
<tr><td><code id="probcubshe3_+3A_csi">csi</code></td>
<td>
<p>Feeling parameter</p>
</td></tr>
<tr><td><code id="probcubshe3_+3A_shelter">shelter</code></td>
<td>
<p>Category corresponding to the shelter choice</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The &quot;satisficing interpretation&quot; provides a parametrization for CUB models with explicit
shelter effect as a mixture of two components: a shifted Binomial distribution with feeling parameter
<code class="reqn">\xi</code> (meditated choice), and a mixture of a degenerate distribution with unit mass at the shelter
category (<code>shelter</code>) and a discrete uniform distribution over <code class="reqn">m</code> categories, with mixing
coefficient specified by <code class="reqn">\eta</code> (lazy selection of a category).
</p>


<h3>Value</h3>

<p>The vector of the probability distribution of a CUB model with shelter effect.
</p>


<h3>References</h3>

<p>Iannario M. (2012). Modelling <em>shelter</em> choices in a class of mixture models for ordinal responses,
<em>Statistical Methods and Applications</em>, <b>21</b>, 1&ndash;22 <br />
</p>


<h3>See Also</h3>

<p><code><a href="#topic+probcubshe1">probcubshe1</a></code>, <code><a href="#topic+probcubshe2">probcubshe2</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>m&lt;-8
pai1&lt;-0.5
pai2&lt;-0.3
csi&lt;-0.4
shelter&lt;-6
lambda&lt;-pai1
eta&lt;-1-pai2/(1-pai1)
pr3&lt;-probcubshe3(m,lambda,eta,csi,shelter)
plot(1:m,pr3,type="h",main="CUB probability distribution with explicit 
shelter effect",xlab="Ordinal categories")
points(1:m,pr3,pch=19)
</code></pre>

<hr>
<h2 id='probcush'>Probability distribution of a CUSH model</h2><span id='topic+probcush'></span>

<h3>Description</h3>

<p>Compute the probability distribution of a CUSH model without covariates, that is a mixture of a
degenerate random variable with mass at the shelter category and the Uniform distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>probcush(m,delta,shelter)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="probcush_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="probcush_+3A_delta">delta</code></td>
<td>
<p>Shelter parameter</p>
</td></tr>
<tr><td><code id="probcush_+3A_shelter">shelter</code></td>
<td>
<p>Category corresponding to the shelter choice</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The vector of the probability distribution of a CUSH model without covariates.
</p>


<h3>References</h3>

<p>Capecchi S. and Piccolo D. (2017). Dealing with heterogeneity in ordinal responses,
<em>Quality and Quantity</em>, <b>51</b>(5), 2375&ndash;2393 <br />
Capecchi S. and Iannario M. (2016). Gini heterogeneity index for detecting uncertainty in ordinal data surveys,
<em>Metron</em>, <b>74</b>(2), 223&ndash;232
</p>


<h3>Examples</h3>

<pre><code class='language-R'>m&lt;-10
shelter&lt;-1
delta&lt;-0.4
pr&lt;-probcush(m,delta,shelter)
plot(1:m,pr,type="h",xlab="Number of categories")
points(1:m,pr,pch=19)
</code></pre>

<hr>
<h2 id='probgecub'>Probability distribution of a GeCUB model</h2><span id='topic+probgecub'></span>

<h3>Description</h3>

<p>Compute the probability distribution of a GeCUB model, that is a CUB model with
shelter effect with covariates specified for all component.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>probgecub(ordinal,Y,W,X,bet,gama,omega,shelter)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="probgecub_+3A_ordinal">ordinal</code></td>
<td>
<p>Vector of ordinal responses</p>
</td></tr>
<tr><td><code id="probgecub_+3A_y">Y</code></td>
<td>
<p>Matrix of covariates for explaining the uncertainty component</p>
</td></tr>
<tr><td><code id="probgecub_+3A_w">W</code></td>
<td>
<p>Matrix of covariates for explaining the feeling component</p>
</td></tr>
<tr><td><code id="probgecub_+3A_x">X</code></td>
<td>
<p>Matrix of covariates for explaining the shelter effect</p>
</td></tr>
<tr><td><code id="probgecub_+3A_bet">bet</code></td>
<td>
<p>Vector of parameters for the uncertainty component, whose length equals
NCOL(Y)+1 to include an intercept term in the model (first entry)</p>
</td></tr>
<tr><td><code id="probgecub_+3A_gama">gama</code></td>
<td>
<p>Vector of parameters for the feeling component, whose length equals
NCOL(W)+1 to include an intercept term in the model (first entry)</p>
</td></tr>
<tr><td><code id="probgecub_+3A_omega">omega</code></td>
<td>
<p>Vector of parameters for the shelter effect, whose length equals
NCOL(X)+1 to include an intercept term in the model (first entry)</p>
</td></tr>
<tr><td><code id="probgecub_+3A_shelter">shelter</code></td>
<td>
<p>Category corresponding to the shelter choice</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of the same length as <code>ordinal</code>, whose i-th component is the
probability of the i-th observation according to a GeCUB model with the corresponding values
of the covariates for all the components and coefficients specified in <code>bet</code>, <code>gama</code>, <code>omega</code>.
</p>


<h3>References</h3>

<p>Iannario M. and Piccolo D. (2016b). A generalized framework for modelling ordinal data.
<em>Statistical Methods and Applications</em>, <b>25</b>, 163&ndash;189.<br />
</p>

<hr>
<h2 id='probihg'>Probability distribution of an IHG model</h2><span id='topic+probihg'></span>

<h3>Description</h3>

<p>Compute the probability distribution of an IHG model (Inverse Hypergeometric) without covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>probihg(m,theta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="probihg_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="probihg_+3A_theta">theta</code></td>
<td>
<p>Preference parameter</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The vector of the probability distribution of an IHG model.
</p>


<h3>References</h3>

<p>D'Elia A. (2003). Modelling ranks using the inverse hypergeometric distribution,
<em>Statistical Modelling: an International Journal</em>, <b>3</b>, 65&ndash;78
</p>


<h3>Examples</h3>

<pre><code class='language-R'>m&lt;-10
theta&lt;-0.30
pr&lt;-probihg(m,theta)
plot(1:m,pr,type="h",xlab="Ordinal categories")
points(1:m,pr,pch=19)
</code></pre>

<hr>
<h2 id='probihgcovn'>Probability distribution of an IHG model with covariates</h2><span id='topic+probihgcovn'></span>

<h3>Description</h3>

<p>Given a vector of <code class="reqn">n</code> ratings over <code class="reqn">m</code> categories, it returns a vector
of length <code class="reqn">n</code> whose i-th element is the  probability of observing the i-th rating for the
corresponding IHG model with parameter <code class="reqn">\theta_i</code>, obtained via logistic link with covariates
and coefficients.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>probihgcovn(m,ordinal,U,nu)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="probihgcovn_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="probihgcovn_+3A_ordinal">ordinal</code></td>
<td>
<p>Vector of ordinal responses</p>
</td></tr>
<tr><td><code id="probihgcovn_+3A_u">U</code></td>
<td>
<p>Matrix of selected covariates for explaining the preference parameter</p>
</td></tr>
<tr><td><code id="probihgcovn_+3A_nu">nu</code></td>
<td>
<p>Vector of coefficients for covariates, whose length equals NCOL(U)+1 to include
an intercept term in the model (first entry)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The matrix <code class="reqn">U</code> is expanded with a vector with entries equal to 1 in the first column to include
an intercept term in the model.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+probihg">probihg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n&lt;-100
m&lt;-7
theta&lt;-0.30
ordinal&lt;-simihg(n,m,theta)
U&lt;-sample(c(0,1),n,replace=TRUE)
nu&lt;-c(0.12,-0.5)
pr&lt;-probihgcovn(m,ordinal,U,nu)
</code></pre>

<hr>
<h2 id='Q2gecub'>Auxiliary function for the log-likelihood estimation of GeCUB models.</h2><span id='topic+Q2gecub'></span>

<h3>Description</h3>

<p>Define the opposite one of the two scalar functions that are maximized when running the E-M algorithm
for GeCUB models with covariates for feeling, uncertainty and overdispersion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Q2gecub(param,datidue)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Q2gecub_+3A_param">param</code></td>
<td>
<p>Vector of initial estimates of parameters for the feeling component</p>
</td></tr>
<tr><td><code id="Q2gecub_+3A_datidue">datidue</code></td>
<td>
<p>Auxiliary matrix</p>
</td></tr>
</table>

<hr>
<h2 id='Qdue'>Auxiliary function for the log-likelihood estimation of CUBE models with covariates</h2><span id='topic+Qdue'></span>

<h3>Description</h3>

<p>Define the opposite of one of the two scalar functions that are maximized when running the E-M
algorithm for CUBE models with covariates for feeling, uncertainty and overdispersion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Qdue(param, esterno2, q, m)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Qdue_+3A_param">param</code></td>
<td>
<p>Vector of initial estimates of parameters for the feeling component and the overdispersion effect</p>
</td></tr>
<tr><td><code id="Qdue_+3A_esterno2">esterno2</code></td>
<td>
<p>Matrix binding together the column vector of the posterior probabilities that each observed rating
has been generated by the distribution of the first component of the mixture, the column vector of ordinal responses,
and the matrices W and Z of the selected covariates for feeling and overdispersion, respectively</p>
</td></tr>
<tr><td><code id="Qdue_+3A_q">q</code></td>
<td>
<p>Number of selected covariates for explaining the feeling component</p>
</td></tr>
<tr><td><code id="Qdue_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is iteratively called as an argument of &quot;optim&quot; within CUBE function (with covariates) as  the function to minimize
to compute the maximum likelihood estimates for the feeling and the overdispersion components.
</p>

<hr>
<h2 id='Quno'>Auxiliary function for the log-likelihood estimation of CUBE models with covariates</h2><span id='topic+Quno'></span>

<h3>Description</h3>

<p>Define the opposite one of the two scalar functions that are maximized when running the E-M algorithm
for CUBE models with covariates for feeling, uncertainty and overdispersion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Quno(bet, esterno1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Quno_+3A_bet">bet</code></td>
<td>
<p>Vector of initial estimates of parameters for the uncertainty component</p>
</td></tr>
<tr><td><code id="Quno_+3A_esterno1">esterno1</code></td>
<td>
<p>Matrix binding together the column vector of the posterior probabilities
that each observed rating has been generated by the first component distribution of the mixture, with the matrix
YY of explicative  variables for the uncertainty component, expanded with a unitary vector in the first column to
consider also an intercept term</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is iteratively called as an argument of &quot;optim&quot; within CUBE function (with covariates) as  the function
to minimize  to compute the maximum likelihood estimates for the feeling and the overdispersion components.
</p>

<hr>
<h2 id='Qunogecub'>Auxiliary function for the log-likelihood estimation of GeCUB models.</h2><span id='topic+Qunogecub'></span>

<h3>Description</h3>

<p>Define the opposite one of the two scalar functions that are maximized when running the E-M algorithm
for GeCUB models with covariates for feeling, uncertainty and overdispersion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Qunogecub(param,datiuno,s)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Qunogecub_+3A_param">param</code></td>
<td>
<p>Vector of initial estimates of parameters for the uncertainty component</p>
</td></tr>
<tr><td><code id="Qunogecub_+3A_datiuno">datiuno</code></td>
<td>
<p>Auxiliary matrix</p>
</td></tr>
<tr><td><code id="Qunogecub_+3A_s">s</code></td>
<td>
<p>Number of covariates to explain the shelter effect</p>
</td></tr>
</table>

<hr>
<h2 id='relgoods'>Relational goods and Leisure time dataset</h2><span id='topic+relgoods'></span>

<h3>Description</h3>

<p>Dataset consists of the results of a survey aimed at measuring the evaluation
of people living in the metropolitan area of Naples, Italy, with respect to of relational goods and
leisure time collected in December 2014. Every participant was asked
to assess on a 10 point ordinal scale his/her personal score for several relational goods
(for instance, time dedicated to friends and family) and to leisure time.
In addition, the survey asked respondents to self-evaluate their level of happiness by marking
a sign along a horizontal line of 110 millimeters according to their feeling, with the left-most
extremity standing for &quot;extremely unhappy&quot;, and the right-most extremity corresponding to
the status &quot;extremely happy&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(relgoods)
</code></pre>


<h3>Format</h3>

<p>The description of subjects' covariates is the following:
</p>

<dl>
<dt><code>ID</code></dt><dd><p>An identification number</p>
</dd>
<dt><code>Gender</code></dt><dd><p>A factor with levels: 0 = man, 1 = woman</p>
</dd>
<dt><code>BirthMonth</code></dt><dd><p>A variable indicating the month of  birth of the respondent</p>
</dd>
<dt><code>BirthYear</code></dt><dd><p>A variable indicating the year of  birth of the respondent</p>
</dd>
<dt><code>Family</code></dt><dd><p>A factor variable indicating the number of members of the family</p>
</dd>
<dt><code>Year.12</code></dt><dd><p>A factor with levels: 1 = if there is any child aged less than 12  in the family,
0 = otherwise</p>
</dd>
<dt><code>EducationDegree</code></dt><dd><p>A factor with levels: 1 = compulsory school, 2 = high school diploma,
3 = Graduated-Bachelor degree, 4 = Graduated-Master degree, 5 = Post graduated</p>
</dd>
<dt><code>MaritalStatus</code></dt><dd><p>A factor with levels: 1 = Unmarried, 2 = Married/Cohabitee,
3 = Separated/Divorced, 4 = Widower</p>
</dd>
<dt><code>Residence</code></dt><dd><p>A factor with levels: 1 = City of Naples, 2 = District of Naples,
3 = Others Campania, 4 = Others Italia, 5 = Foreign countries</p>
</dd>
<dt><code>Glasses</code></dt><dd><p>A factor with levels: 1 = wearing glasses or contact lenses, 0 = otherwise</p>
</dd>
<dt><code>RightHand</code></dt><dd><p>A factor with levels: 1 = right-handed, 0 = left-handed</p>
</dd>
<dt><code>Smoking</code></dt><dd><p>A factor with levels: 1 = smoker, 0 = not smoker</p>
</dd>
<dt><code>WalkAlone</code></dt><dd><p>A factor with levels: 1 = usually walking alone, 0 = usually walking in company</p>
</dd>
<dt><code>job</code></dt><dd><p>A factor with levels: 1 = Not working, 2 = Retired, 3 = occasionally,
4 = fixed-term job, 5 = permanent job</p>
</dd>
<dt><code>PlaySport</code></dt><dd><p>A factor with levels: 1 = Not playing any sport, 2 = Yes, individual sport,
3 = Yes, team sport</p>
</dd>
<dt><code>Pets</code></dt><dd><p>A factor with levels: 1 = owning a pet, 0 = not owning any pet</p>
</dd>
</dl>


<ol>
<li><p> Respondents were asked to evaluate the following items on a 10 point Likert scale,
ranging from 1 = &quot;never, at all&quot; to 10 = &quot;always, a lot&quot;:
</p>

<dl>
<dt><code>WalkOut</code></dt><dd><p>How often the respondent goes out for a walk</p>
</dd>
<dt><code>Parents</code></dt><dd><p>How often respondent talks at least to one of his/her parents</p>
</dd>
<dt><code>MeetRelatives</code></dt><dd><p>How often respondent meets his/her relatives</p>
</dd>
<dt><code>Association</code></dt><dd><p>Frequency of involvement in volunteering or different kinds of
associations/parties, etc</p>
</dd>
<dt><code>RelFriends</code></dt><dd><p>Quality of respondent's relationships with friends</p>
</dd>
<dt><code>RelNeighbours</code></dt><dd><p>Quality of the relationships with neighbors</p>
</dd>
<dt><code>NeedHelp</code></dt><dd><p>Easiness in asking help whenever in need</p>
</dd>
<dt><code>Environment</code></dt><dd><p>Level of comfort with the surrounding environment</p>
</dd>
<dt><code>Safety</code></dt><dd><p>Level of safety in the streets</p>
</dd>
<dt><code>EndofMonth</code></dt><dd><p>Family making ends meet</p>
</dd>
<dt><code>MeetFriend</code></dt><dd><p>Number of times the respondent met his/her friends during the month
preceding the interview</p>
</dd>
<dt><code>Physician</code></dt><dd><p>Importance of the kindness/simpathy in the selection of respondent's physician</p>
</dd>
</dl>


<dl>
<dt><code>Happiness</code></dt><dd><p>Each respondent was asked to mark a sign on a 110mm horizontal line
according to his/her feeling of happiness (left endpoint corresponding to completely unhappy,
right-most endpoint corresponding to extremely happy</p>
</dd>
</dl>

</li>
<li><p> The same respondents were asked to score the activities for leisure time listed below, according
to their involvement/degree of amusement, on a 10 point Likert scale
ranging from 1 = &quot;At all, nothing, never&quot; to 10 = &quot;Totally, extremely important, always&quot;:
</p>

<dl>
<dt><code>Videogames</code></dt><dd></dd>
<dt><code>Reading</code></dt><dd></dd>
<dt><code>Cinema</code></dt><dd></dd>
<dt><code>Drawing</code></dt><dd></dd>
<dt><code>Shopping</code></dt><dd></dd>
<dt><code>Writing</code></dt><dd></dd>
<dt><code>Bicycle</code></dt><dd></dd>
<dt><code>Tv</code></dt><dd></dd>
<dt><code>StayWFriend</code></dt><dd><p>Spending time with friends</p>
</dd></dl>

<dl>
<dt><code>Groups</code></dt><dd><p>Taking part to associations, meetings, etc.</p>
</dd></dl>

<dl>
<dt><code>Walking</code></dt><dd></dd>
<dt><code>HandWork</code></dt><dd><p>Hobby, gardening, sewing, etc. </p>
</dd>
<dt><code>Internet</code></dt><dd></dd>
<dt><code>Sport</code></dt><dd></dd>
<dt><code>SocialNetwork</code></dt><dd></dd>
<dt><code>Gym</code></dt><dd></dd>
<dt><code>Quiz</code></dt><dd><p>Crosswords, sudoku, etc.</p>
</dd>
<dt><code>MusicInstr</code></dt><dd><p>Playing a musical instrument</p>
</dd>
<dt><code>GoAroundCar</code></dt><dd><p> Hanging out by car</p>
</dd>
<dt><code>Dog</code></dt><dd><p>Walking out the dog</p>
</dd>
<dt><code>GoOutEat</code></dt><dd><p>Go to restaurants/pubs</p>
</dd></dl>

</li></ol>



<h3>Details</h3>

<p>Period of data collection: December 2014 <br />
Mode of collection: questionnaire <br />
Number of observations: 2459 <br />
Number of subjects' covariates: 16 <br />
Number of analyzed items: 34 <br />
Warning: with a limited number of missing values
</p>

<hr>
<h2 id='simcub'>Simulation routine for CUB models</h2><span id='topic+simcub'></span>

<h3>Description</h3>

<p>Generate <code class="reqn">n</code> pseudo-random observations following the given CUB distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simcub(n,m,pai,csi)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simcub_+3A_n">n</code></td>
<td>
<p>Number of simulated observations</p>
</td></tr>
<tr><td><code id="simcub_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="simcub_+3A_pai">pai</code></td>
<td>
<p>Uncertainty parameter</p>
</td></tr>
<tr><td><code id="simcub_+3A_csi">csi</code></td>
<td>
<p>Feeling parameter</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+probcub00">probcub00</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n&lt;-300
m&lt;-9
pai&lt;-0.4
csi&lt;-0.7
simulation&lt;-simcub(n,m,pai,csi)
plot(table(simulation),xlab="Ordinal categories",ylab="Frequencies")
</code></pre>

<hr>
<h2 id='simcube'>Simulation routine for CUBE models</h2><span id='topic+simcube'></span>

<h3>Description</h3>

<p>Generate <code class="reqn">n</code> pseudo-random observations following the given CUBE
distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simcube(n,m,pai,csi,phi)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simcube_+3A_n">n</code></td>
<td>
<p>Number of simulated observations</p>
</td></tr>
<tr><td><code id="simcube_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="simcube_+3A_pai">pai</code></td>
<td>
<p>Uncertainty parameter</p>
</td></tr>
<tr><td><code id="simcube_+3A_csi">csi</code></td>
<td>
<p>Feeling parameter</p>
</td></tr>
<tr><td><code id="simcube_+3A_phi">phi</code></td>
<td>
<p>Overdispersion parameter</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+probcube">probcube</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n&lt;-300
m&lt;-9
pai&lt;-0.7
csi&lt;-0.4
phi&lt;-0.1
simulation&lt;-simcube(n,m,pai,csi,phi)
plot(table(simulation),xlab="Ordinal categories",ylab="Frequencies")
</code></pre>

<hr>
<h2 id='simcubshe'>Simulation routine for CUB models with shelter effect</h2><span id='topic+simcubshe'></span>

<h3>Description</h3>

<p>Generate <code class="reqn">n</code> pseudo-random observations following the given CUB distribution
with shelter effect.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simcubshe(n,m,pai,csi,delta,shelter)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simcubshe_+3A_n">n</code></td>
<td>
<p>Number of simulated observations</p>
</td></tr>
<tr><td><code id="simcubshe_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="simcubshe_+3A_pai">pai</code></td>
<td>
<p>Uncertainty parameter</p>
</td></tr>
<tr><td><code id="simcubshe_+3A_csi">csi</code></td>
<td>
<p>Feeling parameter</p>
</td></tr>
<tr><td><code id="simcubshe_+3A_delta">delta</code></td>
<td>
<p>Shelter parameter</p>
</td></tr>
<tr><td><code id="simcubshe_+3A_shelter">shelter</code></td>
<td>
<p>Category corresponding to the shelter choice</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+probcubshe1">probcubshe1</a></code>, <code><a href="#topic+probcubshe2">probcubshe2</a></code>, <code><a href="#topic+probcubshe3">probcubshe3</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n&lt;-300
m&lt;-9
pai&lt;-0.7
csi&lt;-0.3
delta&lt;-0.2
shelter&lt;-3
simulation&lt;-simcubshe(n,m,pai,csi,delta,shelter)
plot(table(simulation),xlab="Ordinal categories",ylab="Frequencies")
</code></pre>

<hr>
<h2 id='simcush'>Simulation routine for CUSH models</h2><span id='topic+simcush'></span>

<h3>Description</h3>

<p>Generate <code class="reqn">n</code> pseudo-random observations following the distribution of a CUSH
model without covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simcush(n,m,delta,shelter)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simcush_+3A_n">n</code></td>
<td>
<p>Number of simulated observations</p>
</td></tr>
<tr><td><code id="simcush_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="simcush_+3A_delta">delta</code></td>
<td>
<p>Shelter parameter</p>
</td></tr>
<tr><td><code id="simcush_+3A_shelter">shelter</code></td>
<td>
<p>Category corresponding to the shelter choice</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+probcush">probcush</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n&lt;-200
m&lt;-7
delta&lt;-0.3
shelter&lt;-3
simulation&lt;-simcush(n,m,delta,shelter)
plot(table(simulation),xlab="Ordinal categories",ylab="Frequencies")
</code></pre>

<hr>
<h2 id='simihg'>Simulation routine for IHG models</h2><span id='topic+simihg'></span>

<h3>Description</h3>

<p>Generate <code class="reqn">n</code> pseudo-random observations following the given IHG distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simihg(n,m,theta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simihg_+3A_n">n</code></td>
<td>
<p>Number of simulated observations</p>
</td></tr>
<tr><td><code id="simihg_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="simihg_+3A_theta">theta</code></td>
<td>
<p>Preference parameter</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+probihg">probihg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n&lt;-300
m&lt;-9
theta&lt;-0.4
simulation&lt;-simihg(n,m,theta)
plot(table(simulation),xlab="Number of categories",ylab="Frequencies")
</code></pre>

<hr>
<h2 id='summary.GEM'>S3 method: summary for class &quot;GEM&quot;</h2><span id='topic+summary.GEM'></span>

<h3>Description</h3>

<p>S3 method summary for objects of class <code><a href="#topic+GEM">GEM</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'GEM'
summary(object, correlation = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.GEM_+3A_object">object</code></td>
<td>
<p>An object of class <code><a href="#topic+GEM">GEM</a></code></p>
</td></tr>
<tr><td><code id="summary.GEM_+3A_correlation">correlation</code></td>
<td>
<p>Logical: should the estimated correlation matrix be returned? Default is FALSE</p>
</td></tr>
<tr><td><code id="summary.GEM_+3A_...">...</code></td>
<td>
<p>Other arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Extended summary results of the fitting procedure, including parameter estimates, their standard errors and
Wald statistics, maximized log-likelihood compared with that of the saturated model and of a Uniform sample.
AIC, BIC and ICOMP indeces are also displayed for model selection. Execution time and number of exectued iterations
for the fitting procedure are aslo returned.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>model&lt;-GEM(Formula(MeetRelatives~0|0|0),family="cube",data=relgoods) 
summary(model,correlation=TRUE,digits=4)

</code></pre>

<hr>
<h2 id='univer'>Evaluation of the Orientation Services 2002</h2><span id='topic+univer'></span>

<h3>Description</h3>

<p>A sample survey on students evaluation of the Orientation services was conducted across the
13 Faculties of University of Naples  Federico II in five waves: participants were asked to express their ratings
on a 7 point scale (1 = &quot;very unsatisfied&quot;, 7 = &quot;extremely satisfied&quot;).
Here  dataset collected during 2002 is loaded.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(univer)
</code></pre>


<h3>Format</h3>

<p>The description of subjects' covariates is:
</p>

<dl>
<dt><code>Faculty</code></dt><dd><p>A factor variable, with levels ranging from 1 to 13 indicating the coding
for the different university faculties</p>
</dd>
<dt><code>Freqserv</code></dt><dd><p>A factor with levels: 0 = for not regular users, 1 = for regular users</p>
</dd>
<dt><code>Age</code></dt><dd><p>Variable indicating the age of the respondent in years</p>
</dd>
<dt><code>Gender</code></dt><dd><p>A factor with levels: 0 = man, 1 = woman</p>
</dd>
<dt><code>Diploma</code></dt><dd><p>A factor with levels:  1 = classic studies, 2 = scientific studies, 3 = linguistic,
4 = Professional, 	5 = Technical/Accountancy, 6 = others</p>
</dd>
<dt><code>Residence</code></dt><dd><p>A factor with levels: 1 = city NA, 2 = district NA, 3 = others</p>
</dd>
<dt><code>ChangeFa</code></dt><dd><p>A factor with levels: 1 = changed faculty, 2 = not changed faculty</p>
</dd>
</dl>

<p>Analyzed ordinal variables (Likert ordinal scale):
1 = &quot;extremely unsatisfied&quot;, 2 = &quot;very unsatisfied&quot;, 3 = &quot;unsatisfied&quot;, 4 = &quot;indifferent&quot;, 5 = &quot;satisfied&quot;, 6 = &quot;very satisfied&quot;,
7 = &quot;extremely satisfied&quot;
</p>

<dl>
<dt><code>Informat</code></dt><dd><p>Level of satisfaction about the collected information</p>
</dd>
<dt><code>Willingn</code></dt><dd><p>Level of satisfaction about the willingness of the staff</p>
</dd>
<dt><code>Officeho</code></dt><dd><p>Judgment about the Office hours</p>
</dd>
<dt><code>Competen</code></dt><dd><p>Judgement about the competence of the staff</p>
</dd>
<dt><code>Global</code></dt><dd><p>Global satisfaction</p>
</dd>
</dl>



<h3>Details</h3>


<p>Period of data collection: 2002 <br />
Mode of collection: questionnaire <br />
Number of observations: 2179 <br />
Number of subjects' covariates: 7 <br />
Number of analyzed items: 5

</p>

<hr>
<h2 id='varcovcub00'>Variance-covariance matrix of a CUB model without covariates</h2><span id='topic+varcovcub00'></span>

<h3>Description</h3>

<p>Compute the variance-covariance matrix of parameter estimates of a CUB model without covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>varcovcub00(m, ordinal, pai, csi)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="varcovcub00_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="varcovcub00_+3A_ordinal">ordinal</code></td>
<td>
<p>Vector of ordinal responses</p>
</td></tr>
<tr><td><code id="varcovcub00_+3A_pai">pai</code></td>
<td>
<p>Uncertainty parameter</p>
</td></tr>
<tr><td><code id="varcovcub00_+3A_csi">csi</code></td>
<td>
<p>Feeling parameter</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function checks if the variance-covariance matrix is positive-definite: if not,
it returns a warning message and produces a matrix with NA entries.
</p>


<h3>References</h3>

<p>Piccolo D. (2006), Observed Information Matrix for MUB Models. <em>Quaderni di Statistica</em>,
<b>8</b>, 33&ndash;78,
</p>


<h3>See Also</h3>

<p><code><a href="#topic+probcub00">probcub00</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(univer)
m&lt;-7
ordinal&lt;-univer[,12]
pai&lt;-0.87
csi&lt;-0.17
varmat&lt;-varcovcub00(m, ordinal, pai, csi)
</code></pre>

<hr>
<h2 id='varcovcub0q'>Variance-covariance matrix of CUB models with covariates for the feeling component</h2><span id='topic+varcovcub0q'></span>

<h3>Description</h3>

<p>Compute the variance-covariance matrix of parameter estimates of a CUB model
with covariates for the feeling component.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>varcovcub0q(m, ordinal, W, pai, gama)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="varcovcub0q_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="varcovcub0q_+3A_ordinal">ordinal</code></td>
<td>
<p>Vector of ordinal responses</p>
</td></tr>
<tr><td><code id="varcovcub0q_+3A_w">W</code></td>
<td>
<p>Matrix of covariates for explaining the feeling component</p>
</td></tr>
<tr><td><code id="varcovcub0q_+3A_pai">pai</code></td>
<td>
<p>Uncertainty parameter</p>
</td></tr>
<tr><td><code id="varcovcub0q_+3A_gama">gama</code></td>
<td>
<p>Vector of parameters for the feeling component, whose length is
NCOL(W)+1 to include an intercept term in the model (first entry of gama)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function checks if the variance-covariance matrix is positive-definite: if not,
it returns a warning message and produces a matrix with NA entries.
</p>


<h3>References</h3>

<p>Piccolo D.(2006), Observed Information Matrix for MUB Models. <em>Quaderni di Statistica</em>,
<b>8</b>, 33&ndash;78,
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(univer)
m&lt;-7
ordinal&lt;-univer[,9]
pai&lt;-0.86
gama&lt;-c(-1.94, -0.17)
W&lt;-univer[,4]           
varmat&lt;-varcovcub0q(m, ordinal, W, pai, gama)
</code></pre>

<hr>
<h2 id='varcovcubecov'>Variance-covariance matrix of a CUBE model with covariates</h2><span id='topic+varcovcubecov'></span>

<h3>Description</h3>

<p>Compute the variance-covariance matrix of parameter estimates of a CUBE model with covariates
for all the three parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>varcovcubecov(m, ordinal, Y, W, Z, estbet, estgama, estalpha)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="varcovcubecov_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="varcovcubecov_+3A_ordinal">ordinal</code></td>
<td>
<p>Vector of ordinal responses</p>
</td></tr>
<tr><td><code id="varcovcubecov_+3A_y">Y</code></td>
<td>
<p>Matrix of covariates for explaining the uncertainty component</p>
</td></tr>
<tr><td><code id="varcovcubecov_+3A_w">W</code></td>
<td>
<p>Matrix of covariates for explaining the feeling component</p>
</td></tr>
<tr><td><code id="varcovcubecov_+3A_z">Z</code></td>
<td>
<p>Matrix of covariates for explaining the overdispersion component</p>
</td></tr>
<tr><td><code id="varcovcubecov_+3A_estbet">estbet</code></td>
<td>
<p>Vector of the estimated parameters for the uncertainty component, with length equal to
NCOL(Y)+1 to account for an intercept term (first entry)</p>
</td></tr>
<tr><td><code id="varcovcubecov_+3A_estgama">estgama</code></td>
<td>
<p>Vector of the estimated parameters for the  feeling component, with length equal to
NCOL(W)+1 to account for an intercept term (first entry)</p>
</td></tr>
<tr><td><code id="varcovcubecov_+3A_estalpha">estalpha</code></td>
<td>
<p>Vector of the estimated parameters for the overdispersion component, with length
equal to NCOL(Z)+1 to account for an intercept term (first entry)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function checks if the variance-covariance matrix is positive-definite: if not,
it returns a warning message and produces a matrix with NA entries.
</p>


<h3>References</h3>

<p>Piccolo, D. (2014), Inferential issues on CUBE models with covariates,
<em>Communications in Statistics - Theory and Methods</em>, <b>44</b>, DOI: 10.1080/03610926.2013.821487
</p>

<hr>
<h2 id='varcovcubeexp'>Variance-covariance matrix for CUBE models based on the expected information matrix</h2><span id='topic+varcovcubeexp'></span>

<h3>Description</h3>

<p>Compute the variance-covariance matrix of parameter estimates as the inverse of
the expected information matrix for a CUBE model without covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>varcovcubeexp(m, pai, csi, phi, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="varcovcubeexp_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="varcovcubeexp_+3A_pai">pai</code></td>
<td>
<p>Uncertainty parameter</p>
</td></tr>
<tr><td><code id="varcovcubeexp_+3A_csi">csi</code></td>
<td>
<p>Feeling parameter</p>
</td></tr>
<tr><td><code id="varcovcubeexp_+3A_phi">phi</code></td>
<td>
<p>Overdispersion parameter</p>
</td></tr>
<tr><td><code id="varcovcubeexp_+3A_n">n</code></td>
<td>
<p>Number of observations</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function checks if the variance-covariance matrix is positive-definite: if not,
it returns a warning message and produces a matrix with NA entries.
</p>


<h3>References</h3>

<p>Iannario, M. (2014). Modelling Uncertainty and Overdispersion in Ordinal Data,
<em>Communications in Statistics - Theory and Methods</em>, <b>43</b>, 771&ndash;786
</p>


<h3>See Also</h3>

<p><code><a href="#topic+varcovcubeobs">varcovcubeobs</a></code>
</p>

<hr>
<h2 id='varcovcubeobs'>Variance-covariance matrix for CUBE models based on the observed information matrix</h2><span id='topic+varcovcubeobs'></span>

<h3>Description</h3>

<p>Compute the variance-covariance matrix of parameter estimates for a CUBE model without covariates
as the inverse of the observed information matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>varcovcubeobs(m, pai, csi, phi, freq)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="varcovcubeobs_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="varcovcubeobs_+3A_pai">pai</code></td>
<td>
<p>Uncertainty parameter</p>
</td></tr>
<tr><td><code id="varcovcubeobs_+3A_csi">csi</code></td>
<td>
<p>Feeling parameter</p>
</td></tr>
<tr><td><code id="varcovcubeobs_+3A_phi">phi</code></td>
<td>
<p>Overdispersion parameter</p>
</td></tr>
<tr><td><code id="varcovcubeobs_+3A_freq">freq</code></td>
<td>
<p>Vector of the observed absolute frequencies</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function checks if the variance-covariance matrix is positive-definite: if not,
it returns a warning message and produces a matrix with NA entries.
</p>


<h3>References</h3>

<p>Iannario, M. (2014). Modelling Uncertainty and Overdispersion in Ordinal Data,
<em>Communications in Statistics - Theory and Methods</em>, <b>43</b>, 771&ndash;786
</p>


<h3>See Also</h3>

<p><code><a href="#topic+varcovcubeexp">varcovcubeexp</a></code>
</p>

<hr>
<h2 id='varcovcubp0'>Variance-covariance matrix of CUB model with covariates for the uncertainty parameter</h2><span id='topic+varcovcubp0'></span>

<h3>Description</h3>

<p>Compute the variance-covariance matrix of parameter estimates of a CUB model with
covariates for the uncertainty component.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>varcovcubp0(m, ordinal, Y, bet, csi)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="varcovcubp0_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="varcovcubp0_+3A_ordinal">ordinal</code></td>
<td>
<p>Vector of ordinal responses</p>
</td></tr>
<tr><td><code id="varcovcubp0_+3A_y">Y</code></td>
<td>
<p>Matrix of covariates for explaining the uncertainty parameter</p>
</td></tr>
<tr><td><code id="varcovcubp0_+3A_bet">bet</code></td>
<td>
<p>Vector of parameters for the uncertainty component, whose length equals NCOL(Y)+1
to include an intercept term (first entry)</p>
</td></tr>
<tr><td><code id="varcovcubp0_+3A_csi">csi</code></td>
<td>
<p>Feeling parameter</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function checks if the variance-covariance matrix is positive-definite: if not,
it returns a warning message and produces a matrix with NA entries.
</p>


<h3>References</h3>

<p>Piccolo D. (2006), Observed Information Matrix for CUB Models, <em>Quaderni di Statistica</em>, <b>8</b>, 33&ndash;78
</p>


<h3>See Also</h3>

<p><code><a href="#topic+probcubpq">probcubpq</a></code>
</p>

<hr>
<h2 id='varcovcubpq'>Variance-covariance matrix of a CUB model with covariates for both uncertainty and feeling</h2><span id='topic+varcovcubpq'></span>

<h3>Description</h3>

<p>Compute the variance-covariance matrix of parameter estimates of a CUB model with covariates for
both the uncertainty and the feeling components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>varcovcubpq(m, ordinal, Y, W, bet, gama)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="varcovcubpq_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="varcovcubpq_+3A_ordinal">ordinal</code></td>
<td>
<p>Vector of ordinal responses</p>
</td></tr>
<tr><td><code id="varcovcubpq_+3A_y">Y</code></td>
<td>
<p>Matrix of covariates for explaining the uncertainty parameter</p>
</td></tr>
<tr><td><code id="varcovcubpq_+3A_w">W</code></td>
<td>
<p>Matrix of covariates for explaining the feeling parameter</p>
</td></tr>
<tr><td><code id="varcovcubpq_+3A_bet">bet</code></td>
<td>
<p>Vector of parameters for the uncertainty component, with length equal to
NCOL(Y)+1 to account for an intercept term (first entry)</p>
</td></tr>
<tr><td><code id="varcovcubpq_+3A_gama">gama</code></td>
<td>
<p>Vector of parameters for the feeling component, with length equal to
NCOL(W)+1 to account for an intercept term (first entry)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function checks if the variance-covariance matrix is positive-definite: if not, it returns a warning
message and produces a matrix with NA entries.
</p>


<h3>References</h3>

<p>Piccolo D. (2006), Observed Information Matrix for CUB Models, <em>Quaderni di Statistica</em>, <b>8</b>, 33&ndash;78
</p>


<h3>See Also</h3>

<p><code><a href="#topic+probcubpq">probcubpq</a></code>
</p>

<hr>
<h2 id='varcovcubshe'>Variance-covariance matrix for CUB models with shelter effect</h2><span id='topic+varcovcubshe'></span>

<h3>Description</h3>

<p>Compute the variance-covariance matrix of parameter estimates of a CUB model with shelter effect.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>varcovcubshe(m, pai1, pai2, csi, shelter, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="varcovcubshe_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="varcovcubshe_+3A_pai1">pai1</code></td>
<td>
<p>Parameter of the mixture distribution: mixing coefficient for the shifted Binomial component</p>
</td></tr>
<tr><td><code id="varcovcubshe_+3A_pai2">pai2</code></td>
<td>
<p>Second parameter of the mixture distribution: mixing coefficient for the discrete Uniform component</p>
</td></tr>
<tr><td><code id="varcovcubshe_+3A_csi">csi</code></td>
<td>
<p>Feeling parameter</p>
</td></tr>
<tr><td><code id="varcovcubshe_+3A_shelter">shelter</code></td>
<td>
<p>Category corresponding to the shelter choice</p>
</td></tr>
<tr><td><code id="varcovcubshe_+3A_n">n</code></td>
<td>
<p>Number of observations</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function checks if the variance-covariance matrix is positive-definite: if not, it returns a warning
message and produces a matrix with NA entries.
</p>


<h3>References</h3>

<p>Iannario, M. (2012), Modelling shelter choices in ordinal data surveys.
Statistical Modelling and Applications, <b>21</b>, 1&ndash;22
</p>


<h3>See Also</h3>

<p><code><a href="#topic+probcubshe1">probcubshe1</a></code>
</p>

<hr>
<h2 id='varcovgecub'>Variance-covariance matrix of a CUB model without covariates</h2><span id='topic+varcovgecub'></span>

<h3>Description</h3>

<p>Compute the variance-covariance matrix of parameter estimates of a CUB model without covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>varcovgecub(ordinal,Y,W,X,bet,gama,omega,shelter)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="varcovgecub_+3A_ordinal">ordinal</code></td>
<td>
<p>Vector of ordinal responses</p>
</td></tr>
<tr><td><code id="varcovgecub_+3A_y">Y</code></td>
<td>
<p>Matrix of selected covariates to explain the uncertainty component (default: no covariate is included
in the model)</p>
</td></tr>
<tr><td><code id="varcovgecub_+3A_w">W</code></td>
<td>
<p>Y Matrix of selected covariates to explain the feeling component (default: no covariate is included
in the model)</p>
</td></tr>
<tr><td><code id="varcovgecub_+3A_x">X</code></td>
<td>
<p>Matrix of selected covariates to explain the shelter component (default: no covariate is included
in the model)</p>
</td></tr>
<tr><td><code id="varcovgecub_+3A_bet">bet</code></td>
<td>
<p>Parameter vector for the Uncertainty component</p>
</td></tr>
<tr><td><code id="varcovgecub_+3A_gama">gama</code></td>
<td>
<p>Parameter vector for the Feeling component</p>
</td></tr>
<tr><td><code id="varcovgecub_+3A_omega">omega</code></td>
<td>
<p>Parameter vector for the shelter component</p>
</td></tr>
<tr><td><code id="varcovgecub_+3A_shelter">shelter</code></td>
<td>
<p>Cateogry corresponding to the shelter effect</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function checks if the variance-covariance matrix is positive-definite: if not,
it returns a warning message and produces a matrix with NA entries.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+probgecub">probgecub</a></code>
</p>

<hr>
<h2 id='varcub00'>Variance of CUB models without covariates</h2><span id='topic+varcub00'></span>

<h3>Description</h3>

<p>Compute the variance of a CUB model without covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>varcub00(m,pai,csi)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="varcub00_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="varcub00_+3A_pai">pai</code></td>
<td>
<p>Uncertainty parameter</p>
</td></tr>
<tr><td><code id="varcub00_+3A_csi">csi</code></td>
<td>
<p>Feeling parameter</p>
</td></tr>
</table>


<h3>References</h3>

<p>Piccolo D. (2003). On the moments of a mixture of uniform and shifted binomial random variables.
<em>Quaderni di Statistica</em>, <b>5</b>, 85&ndash;104
</p>


<h3>See Also</h3>

<p><code><a href="#topic+expcub00">expcub00</a></code>, <code><a href="#topic+probcub00">probcub00</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>m&lt;-9
pai&lt;-0.6
csi&lt;-0.5
varcub&lt;-varcub00(m,pai,csi)
</code></pre>

<hr>
<h2 id='varcube'>Variance of CUBE models without covariates</h2><span id='topic+varcube'></span>

<h3>Description</h3>

<p>Compute the variance of a CUBE model without covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>varcube(m,pai,csi,phi)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="varcube_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="varcube_+3A_pai">pai</code></td>
<td>
<p>Uncertainty parameter</p>
</td></tr>
<tr><td><code id="varcube_+3A_csi">csi</code></td>
<td>
<p>Feeling parameter</p>
</td></tr>
<tr><td><code id="varcube_+3A_phi">phi</code></td>
<td>
<p>Overdispersion parameter</p>
</td></tr>
</table>


<h3>References</h3>

<p>Iannario, M. (2014). Modelling Uncertainty and Overdispersion in
Ordinal Data,  <em>Communications in Statistics - Theory and Methods</em>, <b>43</b>,
771&ndash;786
</p>


<h3>See Also</h3>

<p><code><a href="#topic+probcube">probcube</a></code>, <code><a href="#topic+expcube">expcube</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>m&lt;-7
pai&lt;-0.8
csi&lt;-0.2
phi&lt;-0.05
varianceCUBE&lt;-varcube(m,pai,csi,phi)
</code></pre>

<hr>
<h2 id='varmatCUB'>Variance-covariance matrix for CUB models</h2><span id='topic+varmatCUB'></span>

<h3>Description</h3>

<p>Compute the variance-covariance matrix of parameter estimates for CUB models with or without
covariates for the feeling and the uncertainty parameter, and for extended CUB models with shelter effect.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>varmatCUB(ordinal,m,param,Y=0,W=0,X=0,shelter=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="varmatCUB_+3A_ordinal">ordinal</code></td>
<td>
<p>Vector of ordinal responses</p>
</td></tr>
<tr><td><code id="varmatCUB_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="varmatCUB_+3A_param">param</code></td>
<td>
<p>Vector of parameters for the specified CUB model</p>
</td></tr>
<tr><td><code id="varmatCUB_+3A_y">Y</code></td>
<td>
<p>Matrix of selected covariates to explain the uncertainty component (default: no covariate is included
in the model)</p>
</td></tr>
<tr><td><code id="varmatCUB_+3A_w">W</code></td>
<td>
<p>Matrix of selected covariates to explain the feeling component (default: no covariate is included
in the model)</p>
</td></tr>
<tr><td><code id="varmatCUB_+3A_x">X</code></td>
<td>
<p>Matrix of selected covariates to explain the shelter effect (default: no covariate is included
in the model)</p>
</td></tr>
<tr><td><code id="varmatCUB_+3A_shelter">shelter</code></td>
<td>
<p>Category corresponding to the shelter choice (default: no shelter effect is included in the
model)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function checks if the variance-covariance matrix is positive-definite: if not,
it returns a warning message and produces a matrix with NA entries.  No missing value should be present neither
for <code>ordinal</code> nor for covariate matrices: thus, deletion or imputation procedures should be preliminarily run.
</p>


<h3>References</h3>

<p>Piccolo D. (2006). Observed Information Matrix for MUB Models,
<em>Quaderni di Statistica</em>, <b>8</b>, 33&ndash;78 <br />
Iannario, M. (2012). Modelling shelter choices in ordinal data surveys.
<em>Statistical Modelling and Applications</em>, <b>21</b>, 1&ndash;22 <br />
Iannario M. and Piccolo D. (2016b). A generalized framework for modelling ordinal data.
<em>Statistical Methods and Applications</em>, <b>25</b>, 163&ndash;189.<br />
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+vcov">vcov</a></code>, <code><a href="#topic+cormat">cormat</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(univer)
m&lt;-7
### CUB model with no covariate
pai&lt;-0.87; csi&lt;-0.17 
param&lt;-c(pai,csi)
varmat&lt;-varmatCUB(univer$global,m,param)
#######################
### and with covariates for feeling
data(univer)
m&lt;-7
pai&lt;-0.86; gama&lt;-c(-1.94,-0.17)
param&lt;-c(pai,gama)
ordinal&lt;-univer$willingn; W&lt;-univer$gender      
varmat&lt;-varmatCUB(ordinal,m,param,W)
#######################
### CUB model with uncertainty covariates
data(relgoods)
m&lt;-10
naord&lt;-which(is.na(relgoods$Physician))
nacov&lt;-which(is.na(relgoods$Gender))
na&lt;-union(naord,nacov)
ordinal&lt;-relgoods$Physician[-na]
Y&lt;-relgoods$Gender[-na]
bet&lt;-c(-0.81,0.93); csi&lt;-0.20
varmat&lt;-varmatCUB(ordinal,m,param=c(bet,csi),Y=Y)
#######################
### and with covariates for both parameters
data(relgoods)
m&lt;-10
naord&lt;-which(is.na(relgoods$Physician))
nacov&lt;-which(is.na(relgoods$Gender))
na&lt;-union(naord,nacov)
ordinal&lt;-relgoods$Physician[-na]
W&lt;-Y&lt;-relgoods$Gender[-na]
gama&lt;-c(-0.91,-0.7); bet&lt;-c(-0.81,0.93)
varmat&lt;-varmatCUB(ordinal,m,param=c(bet,gama),Y=Y,W=W)
#######################
### Variance-covariance for a CUB model with shelter
m&lt;-8; n&lt;-300
pai1&lt;-0.5; pai2&lt;-0.3; csi&lt;-0.4
shelter&lt;-6
pr&lt;-probcubshe1(m,pai1,pai2,csi,shelter)
ordinal&lt;-sample(1:m,n,prob=pr,replace=TRUE)
param&lt;-c(pai1,pai2,csi)
varmat&lt;-varmatCUB(ordinal,m,param,shelter=shelter)
</code></pre>

<hr>
<h2 id='varmatCUBE'>Variance-covariance matrix for CUBE models</h2><span id='topic+varmatCUBE'></span>

<h3>Description</h3>

<p>Compute the variance-covariance matrix of parameter estimates for CUBE models when no covariate
is specified, or when covariates are included for all the three parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>varmatCUBE(ordinal,m,param,Y=0,W=0,Z=0,expinform=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="varmatCUBE_+3A_ordinal">ordinal</code></td>
<td>
<p>Vector of ordinal responses</p>
</td></tr>
<tr><td><code id="varmatCUBE_+3A_m">m</code></td>
<td>
<p>Number of ordinal categories</p>
</td></tr>
<tr><td><code id="varmatCUBE_+3A_param">param</code></td>
<td>
<p>Vector of parameters for the specified CUBE model</p>
</td></tr>
<tr><td><code id="varmatCUBE_+3A_y">Y</code></td>
<td>
<p>Matrix of selected covariates to explain the uncertainty component (default: no covariate is included
in the model)</p>
</td></tr>
<tr><td><code id="varmatCUBE_+3A_w">W</code></td>
<td>
<p>Matrix of selected covariates to explain the feeling component (default: no covariate is included
in the model)</p>
</td></tr>
<tr><td><code id="varmatCUBE_+3A_z">Z</code></td>
<td>
<p>Matrix of selected covariates to explain the overdispersion component (default: no covariate is included
in the model)</p>
</td></tr>
<tr><td><code id="varmatCUBE_+3A_expinform">expinform</code></td>
<td>
<p>Logical: if TRUE  and no covariate is included in the model, the function returns
the expected variance-covariance matrix (default is FALSE: the function returns the observed
variance-covariance matrix)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function checks if the variance-covariance matrix is positive-definite: if not,
it returns a warning message and produces a matrix with NA entries.  No missing value should be present neither
for <code>ordinal</code> nor for covariate matrices: thus, deletion or imputation procedures should be preliminarily run.
</p>


<h3>References</h3>

<p>Iannario, M. (2014). Modelling Uncertainty and Overdispersion in Ordinal Data,
<em>Communications in Statistics - Theory and Methods</em>, <b>43</b>, 771&ndash;786 <br />
Piccolo D. (2015). Inferential issues for CUBE models with covariates,
<em>Communications in Statistics. Theory and Methods</em>, <b>44</b>(23), 771&ndash;786. <br />
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+vcov">vcov</a></code>, <code><a href="#topic+cormat">cormat</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>m&lt;-7; n&lt;-500
pai&lt;-0.83; csi&lt;-0.19; phi&lt;-0.045
ordinal&lt;-simcube(n,m,pai,csi,phi)
param&lt;-c(pai,csi,phi)
varmat&lt;-varmatCUBE(ordinal,m,param)
##########################
### Including covariates
data(relgoods)
m&lt;-10
naord&lt;-which(is.na(relgoods$Tv))
nacov&lt;-which(is.na(relgoods$BirthYear))
na&lt;-union(naord,nacov)
age&lt;-2014-relgoods$BirthYear[-na]
lage&lt;-log(age)-mean(log(age))
Y&lt;-W&lt;-Z&lt;-lage
ordinal&lt;-relgoods$Tv[-na]
estbet&lt;-c(0.18,1.03); estgama&lt;-c(-0.6,-0.3); estalpha&lt;-c(-2.3,0.92)
param&lt;-c(estbet,estgama,estalpha)
varmat&lt;-varmatCUBE(ordinal,m,param,Y=Y,W=W,Z=Z,expinform=TRUE)
</code></pre>

<hr>
<h2 id='vcov.GEM'>S3 method  vcov() for class &quot;GEM&quot;</h2><span id='topic+vcov.GEM'></span>

<h3>Description</h3>

<p>S3 method: vcov for objects of class <code><a href="#topic+GEM">GEM</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'GEM'
vcov(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vcov.GEM_+3A_object">object</code></td>
<td>
<p>An object of class <code><a href="#topic+GEM">GEM</a></code></p>
</td></tr>
<tr><td><code id="vcov.GEM_+3A_...">...</code></td>
<td>
<p>Other arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Variance-covariance matrix of the final ML estimates for parameters of the fitted GEM model.
It returns the square of the estimated standard error for CUSH and IHG models with no covariates.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+varmatCUB">varmatCUB</a></code>, <code><a href="#topic+varmatCUBE">varmatCUBE</a></code>, <code><a href="#topic+GEM">GEM</a></code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
