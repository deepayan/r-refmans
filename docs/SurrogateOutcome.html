<!DOCTYPE html><html><head><title>Help for package SurrogateOutcome</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SurrogateOutcome}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#SurrogateOutcome-package'>
<p>Estimation of the Proportion of Treatment Effect Explained by Surrogate Outcome Information</p></a></li>
<li><a href='#censor.weight'>
<p>Calculates censoring probability for weighting</p></a></li>
<li><a href='#cumsum2'>
<p>Helper function</p>
</p></a></li>
<li><a href='#delta.estimate'>
<p>Estimates the treatment effect at time t, defined as the difference in the restricted mean survival time</p></a></li>
<li><a href='#delta.estimate.RMST'>
<p>Helper function</p></a></li>
<li><a href='#delta.q.event.RMST'>
<p>Calculates the residual treatment effect (the difference in restricted mean survival time at time t) after accounting for the treatment effect on the surrogate outcome information up to the landmark time</p></a></li>
<li><a href='#delta.q.event.semi.RMST'>
<p>Calculates the residual treatment effect (the difference in restricted mean survival time at time t) after accounting for the treatment effect on the surrogate outcome information up to the landmark time</p></a></li>
<li><a href='#delta.t.RMST'>
<p>Calculates the residual treatment effect (the difference in restricted mean survival time at time t) after accounting for the treatment effect on the primary outcome up to the landmark time</p>
</p></a></li>
<li><a href='#ExampleData'>
<p>Hypothetical data</p></a></li>
<li><a href='#helper.si'>
<p>Helper function</p></a></li>
<li><a href='#IV.event'>
<p>Calculates the incremental value of the surrogate outcome information</p></a></li>
<li><a href='#Kern.FUN'>
<p>Calculates kernel matrix</p></a></li>
<li><a href='#new.q'>
<p>Helper function</p></a></li>
<li><a href='#pred.smooth.surv'>
<p>Calculates the conditional probability of survival for control group values</p></a></li>
<li><a href='#R.q.event'>
<p>Calculates the proportion of the treatment effect (the difference in restriced mean survival time at time t) explained by surrogate outcome information observed up to the landmark time</p></a></li>
<li><a href='#R.t.estimate'>
<p>Calculates the proportion of the treatment effect (the difference in restricted mean survival time at time t) explained by primary outcome information observed up to the landmark time</p></a></li>
<li><a href='#VTM'>
<p>Repeats a row</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Estimation of the Proportion of Treatment Effect Explained by
Surrogate Outcome Information</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-11-14</td>
</tr>
<tr>
<td>Author:</td>
<td>Layla Parast</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Layla Parast &lt;parast@austin.utexas.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides functions to estimate the proportion of treatment effect on a censored primary outcome that is explained by the treatment effect on a censored surrogate outcome/event. All methods are described in detail in Parast, Tian, Cai (2020) "Assessing the Value of a Censored Surrogate Outcome" &lt;<a href="https://doi.org/10.1007%2Fs10985-019-09473-1">doi:10.1007/s10985-019-09473-1</a>&gt;. The main functions are (1) R.q.event() which calculates the proportion of the treatment effect (the difference in restricted mean survival time at time t) explained by surrogate outcome information observed up to a selected landmark time, (2) R.t.estimate() which calculates the proportion of the treatment effect explained by primary outcome information only observed up to a selected landmark time, and (3) IV.event() which calculates the incremental value of the surrogate outcome information.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL]</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, survival</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-11-14 14:00:24 UTC; parast</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-11-15 09:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='SurrogateOutcome-package'>
Estimation of the Proportion of Treatment Effect Explained by Surrogate Outcome Information
</h2><span id='topic+SurrogateOutcome-package'></span><span id='topic+SurrogateOutcome'></span>

<h3>Description</h3>

<p>Provides functions to estimate the proportion of treatment effect on a censored primary outcome that is explained by the treatment effect on a censored surrogate outcome/event. All methods are described in detail in Parast, Tian, Cai (2020) &quot;Assessing the Value of a Censored Surrogate Outcome&quot; &lt;doi:10.1007/s10985-019-09473-1&gt;. The main functions are (1) R.q.event() which calculates the proportion of the treatment effect (the difference in restricted mean survival time at time t) explained by surrogate outcome information observed up to a selected landmark time, (2) R.t.estimate() which calculates the proportion of the treatment effect explained by primary outcome information only observed up to a selected landmark time, and (3) IV.event() which calculates the incremental value of the surrogate outcome information.
</p>


<h3>Details</h3>

<p>This package implements all methods proposed in Parast L, Tian L, and Cai T (2020). Assessing the Value of a Censored Surrogate Outcome. Lifetime Data Analysis, 26(2):245-265. The main functions are (1) R.q.event() which calculates the proportion of the treatment effect (the difference in restricted mean survival time at time t) explained by surrogate outcome information observed up to a selected landmark time, (2) R.t.estimate() which calculates the proportion of the treatment effect explained by primary outcome information only observed up to a selected landmark time, and (3) IV.event() which calculates the incremental value of the surrogate outcome information.
</p>


<h3>Author(s)</h3>

<p>Layla Parast
</p>
<p>Maintainer: Layla Parast &lt;parast@austin.utexas.edu&gt;
</p>


<h3>References</h3>

<p>Parast L, Tian L, and Cai T (2020). Assessing the Value of a Censored Surrogate Outcome. Lifetime Data Analysis, 26(2):245-265.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ExampleData)
names(ExampleData)


R.q.event(xone = ExampleData$x1, xzero = ExampleData$x0, deltaone = ExampleData$delta1, 
deltazero = ExampleData$delta0, sone = ExampleData$s1, szero = ExampleData$s0, t = 5, 
landmark=2, type = "np")
R.t.estimate(xone = ExampleData$x1, xzero = ExampleData$x0, deltaone = ExampleData$delta1, 
deltazero = ExampleData$delta0, t = 5, landmark=2)
IV.event(xone = ExampleData$x1, xzero = ExampleData$x0, deltaone = ExampleData$delta1, 
deltazero = ExampleData$delta0, sone = ExampleData$s1, szero = ExampleData$s0, t = 5, 
landmark=2, type = "np")
R.q.event(xone = ExampleData$x1, xzero = ExampleData$x0, deltaone = ExampleData$delta1, 
deltazero = ExampleData$delta0, sone = ExampleData$s1, szero = ExampleData$s0, t = 5, 
landmark=2, type = "np", std = TRUE, conf.int = TRUE)
R.t.estimate(xone = ExampleData$x1, xzero = ExampleData$x0, deltaone = ExampleData$delta1, 
deltazero = ExampleData$delta0, t = 5, landmark=2, std = TRUE, conf.int = TRUE)
IV.event(xone = ExampleData$x1, xzero = ExampleData$x0, deltaone = ExampleData$delta1, 
deltazero = ExampleData$delta0, sone = ExampleData$s1, szero = ExampleData$s0, t = 5, 
landmark=2, type = "np", std = TRUE, conf.int = TRUE)


</code></pre>

<hr>
<h2 id='censor.weight'>
Calculates censoring probability for weighting
</h2><span id='topic+censor.weight'></span>

<h3>Description</h3>

<p>Helper function; calculates censoring probability needed for inverse probability of censoring weighting
</p>


<h3>Usage</h3>

<pre><code class='language-R'>censor.weight(data.x, data.delta, t, weight = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="censor.weight_+3A_data.x">data.x</code></td>
<td>

<p>numeric vector, the observed event time: X = min(T, C) where T is the time of the primary outcome, C is the censoring time
</p>
</td></tr>
<tr><td><code id="censor.weight_+3A_data.delta">data.delta</code></td>
<td>

<p>numeric vector of 0/1, the censoring indicator: D = I(T&lt;C) where T is the time of the primary outcome, C is the censoring time
</p>
</td></tr>
<tr><td><code id="censor.weight_+3A_t">t</code></td>
<td>

<p>number, the time of interest
</p>
</td></tr>
<tr><td><code id="censor.weight_+3A_weight">weight</code></td>
<td>

<p>a numeric vector or matrix of weights used for perturbation-resampling, default is null.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Computes the Kaplan Meier estimate of survival for the censoring random variable at the specified time
</p>


<h3>Value</h3>

<p>Kaplan Meier estimate of survival for censoring at time t
</p>


<h3>Author(s)</h3>

<p>Layla Parast
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ExampleData)
censor.weight(data.x = ExampleData$x1, data.delta = ExampleData$delta1, t=5)

</code></pre>

<hr>
<h2 id='cumsum2'>
Helper function
</h2><span id='topic+cumsum2'></span>

<h3>Description</h3>

<p>Helper function; should not be called directly by user.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cumsum2(mydat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cumsum2_+3A_mydat">mydat</code></td>
<td>
<p> mydat
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>out</code></td>
<td>
<p>matrix</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Layla Parast
</p>

<hr>
<h2 id='delta.estimate'>
Estimates the treatment effect at time t, defined as the difference in the restricted mean survival time
</h2><span id='topic+delta.estimate'></span>

<h3>Description</h3>

<p>Estimates the treatment effect at time t, defined as the difference in the restricted mean survival time.</p>


<h3>Usage</h3>

<pre><code class='language-R'>delta.estimate(xone, xzero, deltaone, deltazero, t, std = FALSE, conf.int = FALSE, 
weight.perturb = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="delta.estimate_+3A_xone">xone</code></td>
<td>

<p>numeric vector, observed event times for the primary outcome in the treatment group.
</p>
</td></tr>
<tr><td><code id="delta.estimate_+3A_xzero">xzero</code></td>
<td>

<p>numeric vector, observed event times for the primary outcome in the control group.
</p>
</td></tr>
<tr><td><code id="delta.estimate_+3A_deltaone">deltaone</code></td>
<td>

<p>numeric vector, event/censoring indicators for the primary outcome in the treatment group.
</p>
</td></tr>
<tr><td><code id="delta.estimate_+3A_deltazero">deltazero</code></td>
<td>

<p>numeric vector, event/censoring indicators for the primary outcome in the control group.
</p>
</td></tr>
<tr><td><code id="delta.estimate_+3A_t">t</code></td>
<td>

<p>time of interest for treatment effect.
</p>
</td></tr>
<tr><td><code id="delta.estimate_+3A_std">std</code></td>
<td>

<p>TRUE or FALSE; indicates whether standard error estimates should be provided, default is FALSE. Estimates are calculated using perturbation-resampling.  Two versions are provided: one that takes the standard deviation of the perturbed estimates (denoted as &quot;sd&quot;) and one that takes the median absolute deviation (denoted as &quot;mad&quot;).
</p>
</td></tr>
<tr><td><code id="delta.estimate_+3A_conf.int">conf.int</code></td>
<td>

<p>TRUE or FALSE; indicates whether 95% confidence intervals should be provided. Confidence intervals are calculated using the percentiles of perturbed estimates, default is FALSE. If this is TRUE, standard error estimates are automatically provided.
</p>
</td></tr>
<tr><td><code id="delta.estimate_+3A_weight.perturb">weight.perturb</code></td>
<td>

<p>weights used for perturbation resampling.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let <code class="reqn">G \in \{1,0\}</code> be the randomized treatment indicator and <code class="reqn">T</code> denote the time of the primary outcome of interest. We use potential outcomes notation such that <code class="reqn">T^{(G)}</code> denotes the time of the primary outcome under treatment G, for <code class="reqn">G \in \{1, 0\}</code>. We define the treatment effect as the difference in restricted mean survival time up to a fixed time <code class="reqn">t</code> under treatment 1 versus under treatment 0,
</p>
<p style="text-align: center;"><code class="reqn"> \Delta(t)=E\{T^{(1)}\wedge t\} - E\{T^{(0)}\wedge t \}</code>
</p>

<p>where <code class="reqn">\wedge</code> indicates the minimum. Due to censoring, data consist of <code class="reqn">n = n_1 + n_0</code> independent observations <code class="reqn">\{X_{gi}, \delta_{gi}, i=1,...,n_g, g = 1,0\}</code>, where <code class="reqn">X_{gi} = T_{gi}\wedge C_{ gi}</code>, <code class="reqn">\delta_{gi} = I(T_{gi} &lt; C_{gi})</code>, <code class="reqn">C_{gi}</code> denotes the censoring time, <code class="reqn">T_{gi}</code> denotes the time of the primary outcome, and <code class="reqn">\{(T_{gi}, C_{gi}), i = 1, ..., n_g\}</code> are identically distributed within treatment group. The quantity <code class="reqn"> \Delta(t)</code> is estimated using inverse probability of censoring weights:
</p>
<p style="text-align: center;"><code class="reqn">\hat{\Delta}(t)  = n_1^{-1} \sum_{i=1}^{n_1} \hat{M}_{1i}(t)- n_0^{-1} \sum_{i=1}^{n_0} \hat{M}_{0i}(t)</code>
</p>

<p>where  <code class="reqn">\hat{M}_{gi}(t) = I(X_{gi} &gt; t)t/\hat{W}^C_g(t) +  I(X_{gi} &lt; t)X_{gi}\delta_{gi}/\hat{W}^C_g(X_{gi})</code> and <code class="reqn">\hat{W}^C_g(t)</code> is the Kaplan-Meier estimator of <code class="reqn">P(C_{gi} \ge t).</code>
</p>


<h3>Value</h3>

<p>A list is returned:                
</p>
<table>
<tr><td><code>delta</code></td>
<td>
<p>the estimate, <code class="reqn">\hat{\Delta}(t)</code>, described above.</p>
</td></tr>
<tr><td><code>rmst.1</code></td>
<td>
<p>the estimated restricted mean survival time in group 1, described above.</p>
</td></tr>
<tr><td><code>rmst.0</code></td>
<td>
<p>the estimated restricted mean survival time in group 0, described above.</p>
</td></tr>
<tr><td><code>delta.sd</code></td>
<td>
<p>the standard error estimate of <code class="reqn">\hat{\Delta}(t)</code>; if std = TRUE or conf.int = TRUE.</p>
</td></tr>
<tr><td><code>delta.mad</code></td>
<td>
<p>the standard error estimate of <code class="reqn">\hat{\Delta}(t)</code> using the median absolute deviation; if std = TRUE or conf.int = TRUE.</p>
</td></tr> 
<tr><td><code>conf.int.delta</code></td>
<td>
<p>a vector of size 2; the 95% confidence interval for <code class="reqn">\hat{\Delta}(t)</code> based on sample quantiles of the perturbed values; if conf.int = TRUE.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Layla Parast
</p>


<h3>References</h3>

<p>Parast L, Tian L, and Cai T (2020). Assessing the Value of a Censored Surrogate Outcome. Lifetime Data Analysis, 26(2):245-265.
</p>
<p>Tian, L, Zhao, L, &amp; Wei, LJ (2013). Predicting the restricted mean event time with the subject's baseline covariates in survival analysis. Biostatistics, 15(2), 222-233.
</p>
<p>Royston, P, &amp; Parmar, MK (2011). The use of restricted mean survival time to estimate the treatment effect in randomized clinical trials when the proportional hazards assumption is in doubt. Statistics in Medicine, 30(19), 2409-2421.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ExampleData)
names(ExampleData)

delta.estimate(xone = ExampleData$x1, xzero = ExampleData$x0, deltaone = ExampleData$delta1, 
deltazero = ExampleData$delta0, t = 5)


delta.estimate(xone = ExampleData$x1, xzero = ExampleData$x0, deltaone = ExampleData$delta1, 
deltazero = ExampleData$delta0, t = 5, std = TRUE, conf.int = TRUE)


</code></pre>

<hr>
<h2 id='delta.estimate.RMST'>
Helper function
</h2><span id='topic+delta.estimate.RMST'></span>

<h3>Description</h3>

<p>Helper function; used by delta.estimate function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>delta.estimate.RMST(xone, xzero, deltaone, deltazero, t, weight = NULL, delta.only = F)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="delta.estimate.RMST_+3A_xone">xone</code></td>
<td>

<p>numeric vector, observed event times for the primary outcome in the treatment group.
</p>
</td></tr>
<tr><td><code id="delta.estimate.RMST_+3A_xzero">xzero</code></td>
<td>

<p>numeric vector, observed event times for the primary outcome in the control group.
</p>
</td></tr>
<tr><td><code id="delta.estimate.RMST_+3A_deltaone">deltaone</code></td>
<td>

<p>numeric vector, event/censoring indicators for the primary outcome in the treatment group.
</p>
</td></tr>
<tr><td><code id="delta.estimate.RMST_+3A_deltazero">deltazero</code></td>
<td>

<p>numeric vector, event/censoring indicators for the primary outcome in the control group.
</p>
</td></tr>
<tr><td><code id="delta.estimate.RMST_+3A_t">t</code></td>
<td>

<p>time of interest for treatment effect.
</p>
</td></tr>
<tr><td><code id="delta.estimate.RMST_+3A_weight">weight</code></td>
<td>

<p>weight; optional   
</p>
</td></tr>
<tr><td><code id="delta.estimate.RMST_+3A_delta.only">delta.only</code></td>
<td>

<p>TRUE or FALSE; if TRUE then only delta is returned, if FALSE then delta and restricted mean survival time for each treatment group is also returned
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list is returned:                
</p>
<table>
<tr><td><code>delta</code></td>
<td>
<p>the difference in the restricted mean survival between the two treatment groups. </p>
</td></tr>
<tr><td><code>s1</code></td>
<td>
<p>only if delta.only = F; the restricted mean survival in group 1.</p>
</td></tr>
<tr><td><code>s0</code></td>
<td>
<p>only if delta.only = F; the restricted mean survival in group 0.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Layla Parast
</p>

<hr>
<h2 id='delta.q.event.RMST'>
Calculates the residual treatment effect (the difference in restricted mean survival time at time t) after accounting for the treatment effect on the surrogate outcome information up to the landmark time
</h2><span id='topic+delta.q.event.RMST'></span>

<h3>Description</h3>

<p>Calculates the residual treatment effect (the difference in restricted mean survival time at time t) after accounting for the treatment effect on the surrogate outcome information up to the landmark time; uses nonparametric estimation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>delta.q.event.RMST(xone, xzero, deltaone, deltazero, sone, szero, t, weight = NULL,
 landmark = landmark, deltaslist = TRUE, transform = FALSE, extrapolate=TRUE, 
 number, warn.extrapolate=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="delta.q.event.RMST_+3A_xone">xone</code></td>
<td>

<p>numeric vector, observed event times for the primary outcome in the treatment group.
</p>
</td></tr>
<tr><td><code id="delta.q.event.RMST_+3A_xzero">xzero</code></td>
<td>

<p>numeric vector, observed event times for the primary outcome in the control group.
</p>
</td></tr>
<tr><td><code id="delta.q.event.RMST_+3A_deltaone">deltaone</code></td>
<td>

<p>numeric vector, event/censoring indicators for the primary outcome in the treatment group.
</p>
</td></tr>
<tr><td><code id="delta.q.event.RMST_+3A_deltazero">deltazero</code></td>
<td>

<p>numeric vector, event/censoring indicators for the primary outcome in the control group.
</p>
</td></tr>
<tr><td><code id="delta.q.event.RMST_+3A_sone">sone</code></td>
<td>

<p>numeric vector, observed event times for the surrogate outcome in the treatment group.
</p>
</td></tr>
<tr><td><code id="delta.q.event.RMST_+3A_szero">szero</code></td>
<td>

<p>numeric vector, observed event times for the surrogate outcome in the control group.
</p>
</td></tr>
<tr><td><code id="delta.q.event.RMST_+3A_t">t</code></td>
<td>

<p>time of interest for treatment effect.
</p>
</td></tr>
<tr><td><code id="delta.q.event.RMST_+3A_weight">weight</code></td>
<td>

<p>optional weight.
</p>
</td></tr>
<tr><td><code id="delta.q.event.RMST_+3A_landmark">landmark</code></td>
<td>

<p>landmark time of interest, <code class="reqn">t_0</code>.
</p>
</td></tr>
<tr><td><code id="delta.q.event.RMST_+3A_deltaslist">deltaslist</code></td>
<td>

<p>TRUE or FALSE; if TRUE, each component of the residual treatment effect is returned along with the residual treatment effect itself, if FALSE, only the residual treatment effect is returned.
</p>
</td></tr>
<tr><td><code id="delta.q.event.RMST_+3A_transform">transform</code></td>
<td>

<p>TRUE or FALSE; indicates whether a transformation should be used, default is FALSE.
</p>
</td></tr>
<tr><td><code id="delta.q.event.RMST_+3A_extrapolate">extrapolate</code></td>
<td>

<p>TRUE or FALSE; indicates whether local constant extrapolation should be used, default is TRUE.
</p>
</td></tr>
<tr><td><code id="delta.q.event.RMST_+3A_number">number</code></td>
<td>

<p>number of points for RMST calculation, default is 40.
</p>
</td></tr>
<tr><td><code id="delta.q.event.RMST_+3A_warn.extrapolate">warn.extrapolate</code></td>
<td>

<p>TRUE or FALSE; indicates whether user prefers a warning message when extrapolation is used, default is TRUE.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See documentation for R.q.event for details.
</p>


<h3>Value</h3>

<p>A list is returned:                
</p>
<table>
<tr><td><code>delta.q</code></td>
<td>
<p>the estimated residual treatment effect</p>
</td></tr>
<tr><td><code>first.term</code></td>
<td>
<p>the first term of the residual treatment effect, if deltaslist = TRUE</p>
</td></tr>
<tr><td><code>second.term</code></td>
<td>
<p>the second term of the residual treatment effect, if deltaslist = TRUE</p>
</td></tr>
<tr><td><code>third.term</code></td>
<td>
<p>the third term of the residual treatment effect, if deltaslist = TRUE</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Layla Parast
</p>


<h3>References</h3>

<p>Parast L, Tian L, and Cai T (2020). Assessing the Value of a Censored Surrogate Outcome. Lifetime Data Analysis, 26(2):245-265.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ExampleData)
names(ExampleData)

delta.q.event.RMST(xone = ExampleData$x1, xzero = ExampleData$x0, deltaone = ExampleData$delta1, 
deltazero = ExampleData$delta0, sone = ExampleData$s1, szero = ExampleData$s0, t = 5, landmark=2, 
number = 40)
delta.q.event.RMST(xone = ExampleData$x1, xzero = ExampleData$x0, deltaone = ExampleData$delta1, 
deltazero = ExampleData$delta0, sone = ExampleData$s1, szero = ExampleData$s0, t = 4, landmark=2, 
number = 40)

</code></pre>

<hr>
<h2 id='delta.q.event.semi.RMST'>
Calculates the residual treatment effect (the difference in restricted mean survival time at time t) after accounting for the treatment effect on the surrogate outcome information up to the landmark time
</h2><span id='topic+delta.q.event.semi.RMST'></span>

<h3>Description</h3>

<p>Calculates the residual treatment effect (the difference in restricted mean survival time at time t) after accounting for the treatment effect on the surrogate outcome information up to the landmark time; uses semi-parametric estimation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>delta.q.event.semi.RMST(xone, xzero, deltaone, deltazero, sone, szero, t, 
weight = NULL, landmark = landmark, deltaslist = TRUE, number)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="delta.q.event.semi.RMST_+3A_xone">xone</code></td>
<td>

<p>numeric vector, observed event times for the primary outcome in the treatment group.
</p>
</td></tr>
<tr><td><code id="delta.q.event.semi.RMST_+3A_xzero">xzero</code></td>
<td>

<p>numeric vector, observed event times for the primary outcome in the control group.
</p>
</td></tr>
<tr><td><code id="delta.q.event.semi.RMST_+3A_deltaone">deltaone</code></td>
<td>

<p>numeric vector, event/censoring indicators for the primary outcome in the treatment group.
</p>
</td></tr>
<tr><td><code id="delta.q.event.semi.RMST_+3A_deltazero">deltazero</code></td>
<td>

<p>numeric vector, event/censoring indicators for the primary outcome in the control group.
</p>
</td></tr>
<tr><td><code id="delta.q.event.semi.RMST_+3A_sone">sone</code></td>
<td>

<p>numeric vector, observed event times for the surrogate outcome in the treatment group.
</p>
</td></tr>
<tr><td><code id="delta.q.event.semi.RMST_+3A_szero">szero</code></td>
<td>

<p>numeric vector, observed event times for the surrogate outcome in the control group.
</p>
</td></tr>
<tr><td><code id="delta.q.event.semi.RMST_+3A_t">t</code></td>
<td>

<p>time of interest for treatment effect.
</p>
</td></tr>
<tr><td><code id="delta.q.event.semi.RMST_+3A_weight">weight</code></td>
<td>

<p>optional weight.
</p>
</td></tr>
<tr><td><code id="delta.q.event.semi.RMST_+3A_landmark">landmark</code></td>
<td>

<p>landmark time of interest, <code class="reqn">t_0</code>.
</p>
</td></tr>
<tr><td><code id="delta.q.event.semi.RMST_+3A_deltaslist">deltaslist</code></td>
<td>

<p>TRUE or FALSE; if TRUE, each component of the residual treatment effect is returned along with the residual treatment effect itself, if FALSE, only the residual treatment effect is returned.
</p>
</td></tr>
<tr><td><code id="delta.q.event.semi.RMST_+3A_number">number</code></td>
<td>

<p>number of points for RMST calculation, default is 40.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See documentation for R.q.event for details.
</p>


<h3>Value</h3>

<p>A list is returned:                
</p>
<table>
<tr><td><code>delta.q</code></td>
<td>
<p>the estimated residual treatment effect</p>
</td></tr>
<tr><td><code>first.term</code></td>
<td>
<p>the first term of the residual treatment effect, if deltaslist = TRUE</p>
</td></tr>
<tr><td><code>second.term</code></td>
<td>
<p>the second term of the residual treatment effect, if deltaslist = TRUE</p>
</td></tr>
<tr><td><code>third.term</code></td>
<td>
<p>the third term of the residual treatment effect, if deltaslist = TRUE</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Layla Parast
</p>


<h3>References</h3>

<p>Parast L, Tian L, and Cai T (2020). Assessing the Value of a Censored Surrogate Outcome. Lifetime Data Analysis, 26(2):245-265.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ExampleData)
names(ExampleData)

delta.q.event.semi.RMST(xone = ExampleData$x1, xzero = ExampleData$x0, deltaone = 
ExampleData$delta1, deltazero = ExampleData$delta0, sone = ExampleData$s1, 
szero = ExampleData$s0, t = 5, landmark=2, number = 40)
delta.q.event.semi.RMST(xone = ExampleData$x1, xzero = ExampleData$x0, deltaone = 
ExampleData$delta1, deltazero = ExampleData$delta0, sone = ExampleData$s1, 
szero = ExampleData$s0, t = 3, landmark=2, number = 40)

</code></pre>

<hr>
<h2 id='delta.t.RMST'>
Calculates the residual treatment effect (the difference in restricted mean survival time at time t) after accounting for the treatment effect on the primary outcome up to the landmark time
</h2><span id='topic+delta.t.RMST'></span>

<h3>Description</h3>

<p>Calculates the residual treatment effect (the difference in restricted mean survival time at time t) after accounting for the treatment effect on the primary outcome up to the landmark time
</p>


<h3>Usage</h3>

<pre><code class='language-R'>delta.t.RMST(xone, xzero, deltaone, deltazero, t, weight = NULL, landmark = landmark)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="delta.t.RMST_+3A_xone">xone</code></td>
<td>

<p>numeric vector, observed event times for the primary outcome in the treatment group.
</p>
</td></tr>
<tr><td><code id="delta.t.RMST_+3A_xzero">xzero</code></td>
<td>

<p>numeric vector, observed event times for the primary outcome in the control group.
</p>
</td></tr>
<tr><td><code id="delta.t.RMST_+3A_deltaone">deltaone</code></td>
<td>

<p>numeric vector, event/censoring indicators for the primary outcome in the treatment group.
</p>
</td></tr>
<tr><td><code id="delta.t.RMST_+3A_deltazero">deltazero</code></td>
<td>

<p>numeric vector, event/censoring indicators for the primary outcome in the control group.
</p>
</td></tr>
<tr><td><code id="delta.t.RMST_+3A_t">t</code></td>
<td>

<p>time of interest for treatment effect.
</p>
</td></tr>
<tr><td><code id="delta.t.RMST_+3A_weight">weight</code></td>
<td>

<p>optional weight.
</p>
</td></tr>
<tr><td><code id="delta.t.RMST_+3A_landmark">landmark</code></td>
<td>

<p>landmark time of interest, <code class="reqn">t_0</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See documentation for R.t.estimate for details.
</p>


<h3>Value</h3>

<table>
<tr><td><code>delta.t</code></td>
<td>
<p>the estimated residual treatment effect after accounting for the treatment effect on the primary outcome up to the landmark time
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Layla Parast
</p>


<h3>References</h3>

<p>Parast L, Tian L, and Cai T (2020). Assessing the Value of a Censored Surrogate Outcome. Lifetime Data Analysis, 26(2):245-265.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ExampleData)
names(ExampleData)
delta.t.RMST(xone = ExampleData$x1, xzero = ExampleData$x0, deltaone = ExampleData$delta1, 
deltazero = ExampleData$delta0, t = 5, landmark=2)
</code></pre>

<hr>
<h2 id='ExampleData'>
Hypothetical data
</h2><span id='topic+ExampleData'></span>

<h3>Description</h3>

<p>Hypothetical data to be used in examples; t=5 and the landmark time = 2.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ExampleData)</code></pre>


<h3>Format</h3>

<p>A list with 6 elements representing 1000 observations from a control group and 1000 observations from a treatment group:
</p>

<dl>
<dt><code>s1</code></dt><dd><p>Time of the occurrence of the surrogate outcome for treated observations.</p>
</dd>
<dt><code>x1</code></dt><dd><p>The observed event or censoring time for treated observations; X  = min(T, C) where T is the time of the primary outcome and C is the censoring time.</p>
</dd>
<dt><code>delta1</code></dt><dd><p>The indicator identifying whether the treated observation was observed to have the event or was censored; D =1*(T&lt;C) where T is the time of the primary outcome and C is the censoring time.</p>
</dd>
<dt><code>s0</code></dt><dd><p>Time of the occurrence of the surrogate outcome for control observations.</p>
</dd>
<dt><code>x0</code></dt><dd><p>The observed event or censoring time for control observations; X  = min(T, C) where T is the time of the primary outcome and C is the censoring time.</p>
</dd>
<dt><code>delta0</code></dt><dd><p>The indicator identifying whether the control observation was observed to have the event or was censored; D =1*(T&lt;C) where T is the time of the primary outcome and C is the censoring time.</p>
</dd>
</dl>


<h3>Details</h3>

<p>Note that the time of the surrogate outcome is used in all functions only if the surrogate outcome occurs before the minimum of the event time and censoring time.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ExampleData)
names(ExampleData)
</code></pre>

<hr>
<h2 id='helper.si'>
Helper function
</h2><span id='topic+helper.si'></span>

<h3>Description</h3>

<p>Helper function; should not be called directly by user.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>helper.si(yy,FUN,Yi,Vi=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="helper.si_+3A_yy">yy</code></td>
<td>

<p>yy
</p>
</td></tr>
<tr><td><code id="helper.si_+3A_fun">FUN</code></td>
<td>

<p>FUN</p>
</td></tr>
<tr><td><code id="helper.si_+3A_yi">Yi</code></td>
<td>

<p>Yi</p>
</td></tr>
<tr><td><code id="helper.si_+3A_vi">Vi</code></td>
<td>

<p>Vi</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>out</code></td>
<td>
<p>matrix</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Layla Parast
</p>

<hr>
<h2 id='IV.event'>
Calculates the incremental value of the surrogate outcome information 
</h2><span id='topic+IV.event'></span>

<h3>Description</h3>

<p>Calculates the incremental value of the surrogate outcome information 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IV.event(xone, xzero, deltaone, deltazero, sone, szero, t, landmark, number = 40, 
transform = FALSE, extrapolate = TRUE, std = FALSE, conf.int = FALSE, 
weight.perturb = NULL, type = "np")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="IV.event_+3A_xone">xone</code></td>
<td>

<p>numeric vector, observed event times for the primary outcome in the treatment group.
</p>
</td></tr>
<tr><td><code id="IV.event_+3A_xzero">xzero</code></td>
<td>

<p>numeric vector, observed event times for the primary outcome in the control group.
</p>
</td></tr>
<tr><td><code id="IV.event_+3A_deltaone">deltaone</code></td>
<td>

<p>numeric vector, event/censoring indicators for the primary outcome in the treatment group.
</p>
</td></tr>
<tr><td><code id="IV.event_+3A_deltazero">deltazero</code></td>
<td>

<p>numeric vector, event/censoring indicators for the primary outcome in the control group.
</p>
</td></tr>
<tr><td><code id="IV.event_+3A_sone">sone</code></td>
<td>

<p>numeric vector, observed event times for the surrogate outcome in the treatment group.
</p>
</td></tr>
<tr><td><code id="IV.event_+3A_szero">szero</code></td>
<td>

<p>numeric vector, observed event times for the surrogate outcome in the control group.
</p>
</td></tr>
<tr><td><code id="IV.event_+3A_t">t</code></td>
<td>

<p>time of interest for treatment effect.
</p>
</td></tr>
<tr><td><code id="IV.event_+3A_landmark">landmark</code></td>
<td>

<p>landmark time of interest, <code class="reqn">t_0</code>.
</p>
</td></tr>
<tr><td><code id="IV.event_+3A_number">number</code></td>
<td>

<p>number of points for RMST calculation, default is 40.
</p>
</td></tr>
<tr><td><code id="IV.event_+3A_transform">transform</code></td>
<td>

<p>TRUE or FALSE; indicates whether a transformation should be used, default is FALSE.
</p>
</td></tr>
<tr><td><code id="IV.event_+3A_extrapolate">extrapolate</code></td>
<td>

<p>TRUE or FALSE; indicates whether local constant extrapolation should be used, default is FALSE.
</p>
</td></tr>
<tr><td><code id="IV.event_+3A_std">std</code></td>
<td>

<p>TRUE or FALSE; indicates whether standard error estimates should be provided, default is FALSE. Estimates are calculated using perturbation-resampling. Two versions are provided: one that takes the standard deviation of the perturbed estimates (denoted as &quot;sd&quot;) and one that takes the median absolute deviation (denoted as &quot;mad&quot;). 
</p>
</td></tr>
<tr><td><code id="IV.event_+3A_conf.int">conf.int</code></td>
<td>

<p>TRUE or FALSE; indicates whether 95% confidence intervals should be provided. Confidence intervals are calculated using the percentiles of perturbed estimates, default is FALSE. If this is TRUE, standard error estimates are automatically provided.
</p>
</td></tr>
<tr><td><code id="IV.event_+3A_weight.perturb">weight.perturb</code></td>
<td>

<p>weights used for perturbation resampling.
</p>
</td></tr>
<tr><td><code id="IV.event_+3A_type">type</code></td>
<td>

<p>Type of estimate that should be provided; options are &quot;np&quot; for the nonparametric estimate or &quot;semi&quot; for the semiparametric estimate, default is &quot;np&quot;.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The incremental value of the surrogate outcome information only is quantified as <code class="reqn">IV_S(t,t_0) = R_Q(t,t_0) - R_T(t,t_0)</code> where the definition and estimation procedures for <code class="reqn">R_Q(t,t_0)</code> and <code class="reqn">R_T(t,t_0)</code> are described in the documentation for R.q.event and R.t.estimate, respectively. The estimate of the incremental value is  <code class="reqn">\hat{IV}_S(t,t_0) = \hat{R}_Q(t,t_0) - \hat{R}_T(t,t_0)</code>. 
</p>


<h3>Value</h3>

<p>A list is returned:                
</p>
<table>
<tr><td><code>delta</code></td>
<td>
<p>the estimate, <code class="reqn">\hat{\Delta}(t)</code>, described in delta.estimate documentation.</p>
</td></tr>
<tr><td><code>delta.q</code></td>
<td>
<p>the estimate, <code class="reqn">\hat{\Delta}_Q(t,t_0)</code>, described in R.q.event documention.</p>
</td></tr>
<tr><td><code>R.q</code></td>
<td>
<p>the estimate, <code class="reqn">\hat{R}_Q(t,t_0)</code>, described in R.q.event documention.</p>
</td></tr>
<tr><td><code>delta.t</code></td>
<td>
<p>the estimate, <code class="reqn">\hat{\Delta}_T(t,t_0)</code>, described in R.t.estimate documention.</p>
</td></tr>
<tr><td><code>R.t</code></td>
<td>
<p>the estimate, <code class="reqn">\hat{R}_T(t,t_0)</code>, described in R.t.estimate documention.</p>
</td></tr>
<tr><td><code>IV</code></td>
<td>
<p>the estimated incremental value of the surrogate outcome information, described above.</p>
</td></tr>
<tr><td><code>delta.sd</code></td>
<td>
<p>the standard error estimate of <code class="reqn">\hat{\Delta}(t)</code>; if std = TRUE or conf.int = TRUE.</p>
</td></tr>
<tr><td><code>delta.mad</code></td>
<td>
<p>the standard error estimate of <code class="reqn">\hat{\Delta}(t)</code> using the median absolute deviation; if std = TRUE or conf.int = TRUE.</p>
</td></tr> 
<tr><td><code>delta.q.sd</code></td>
<td>
<p>the standard error estimate of <code class="reqn">\hat{\Delta}_Q(t,t_0)</code>; if std = TRUE or conf.int = TRUE.</p>
</td></tr>
<tr><td><code>delta.q.mad</code></td>
<td>
<p>the standard error estimate of <code class="reqn">\hat{\Delta}_Q(t,t_0)</code> using the median absolute deviation; if std = TRUE or conf.int = TRUE.</p>
</td></tr>  
<tr><td><code>R.q.sd</code></td>
<td>
<p>the standard error estimate of <code class="reqn">\hat{R}_Q(t,t_0)</code>; if std = TRUE or conf.int = TRUE.</p>
</td></tr>
<tr><td><code>R.q.mad</code></td>
<td>
<p>the standard error estimate of <code class="reqn">\hat{R}_Q(t,t_0)</code> using the median absolute deviation; if std = TRUE or conf.int = TRUE.</p>
</td></tr>
<tr><td><code>delta.t.sd</code></td>
<td>
<p>the standard error estimate of <code class="reqn">\hat{\Delta}_T(t,t_0)</code>; if std = TRUE or conf.int = TRUE.</p>
</td></tr>
<tr><td><code>delta.t.mad</code></td>
<td>
<p>the standard error estimate of <code class="reqn">\hat{\Delta}_T(t,t_0)</code> using the median absolute deviation; if std = TRUE or conf.int = TRUE.</p>
</td></tr>  
<tr><td><code>R.t.sd</code></td>
<td>
<p>the standard error estimate of <code class="reqn">\hat{R}_T(t,t_0)</code>; if std = TRUE or conf.int = TRUE.</p>
</td></tr>
<tr><td><code>R.t.mad</code></td>
<td>
<p>the standard error estimate of <code class="reqn">\hat{R}_T(t,t_0)</code> using the median absolute deviation; if std = TRUE or conf.int = TRUE.</p>
</td></tr>
<tr><td><code>IV.sd</code></td>
<td>
<p>the standard error estimate of the incremental value; if std = TRUE or conf.int = TRUE.</p>
</td></tr>
<tr><td><code>IV.mad</code></td>
<td>
<p>the standard error estimate of the incremental value using the median absolute deviation; if std = TRUE or conf.int = TRUE.</p>
</td></tr>
<tr><td><code>conf.int.delta</code></td>
<td>
<p>a vector of size 2; the 95% confidence interval for <code class="reqn">\hat{\Delta}(t)</code> based on sample quantiles of the perturbed values; if conf.int = TRUE.</p>
</td></tr>
<tr><td><code>conf.int.delta.q</code></td>
<td>
<p>a vector of size 2; the 95% confidence interval for <code class="reqn">\hat{\Delta}_Q(t,t_0)</code> based on sample quantiles of the perturbed values; if conf.int = TRUE.</p>
</td></tr> 
<tr><td><code>conf.int.R.q</code></td>
<td>
<p>a vector of size 2; the 95% confidence interval for <code class="reqn">\hat{R}_Q(t,t_0)</code> based on sample quantiles of the perturbed values; if conf.int = TRUE.</p>
</td></tr>
<tr><td><code>conf.int.delta.t</code></td>
<td>
<p>a vector of size 2; the 95% confidence interval for <code class="reqn">\hat{\Delta}_T(t,t_0)</code> based on sample quantiles of the perturbed values; if conf.int = TRUE.</p>
</td></tr> 
<tr><td><code>conf.int.R.t</code></td>
<td>
<p>a vector of size 2; the 95% confidence interval for <code class="reqn">\hat{R}_T(t,t_0)</code> based on sample quantiles of the perturbed values; if conf.int = TRUE.</p>
</td></tr>
<tr><td><code>conf.int.IV</code></td>
<td>
<p>a vector of size 2; the 95% confidence interval for the incremental value based on sample quantiles of the perturbed values; if conf.int = TRUE.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Layla Parast
</p>


<h3>References</h3>

<p>Parast L, Tian L, and Cai T (2020). Assessing the Value of a Censored Surrogate Outcome. Lifetime Data Analysis, 26(2):245-265.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ExampleData)
names(ExampleData)


IV.event(xone = ExampleData$x1, xzero = ExampleData$x0, deltaone = ExampleData$delta1, 
deltazero = ExampleData$delta0, sone = ExampleData$s1, szero = ExampleData$s0, t = 5,
 landmark=2, type = "np")

IV.event(xone = ExampleData$x1, xzero = ExampleData$x0, deltaone = ExampleData$delta1, 
deltazero = ExampleData$delta0, sone = ExampleData$s1, szero = ExampleData$s0, t = 5,
 landmark=2, type = "np", std = TRUE, conf.int = TRUE)

</code></pre>

<hr>
<h2 id='Kern.FUN'>
Calculates kernel matrix
</h2><span id='topic+Kern.FUN'></span>

<h3>Description</h3>

<p>Helper function; this calculates the kernel matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Kern.FUN(zz, zi, bw, kern0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Kern.FUN_+3A_zz">zz</code></td>
<td>

<p>zz
</p>
</td></tr>
<tr><td><code id="Kern.FUN_+3A_zi">zi</code></td>
<td>

<p>zi
</p>
</td></tr>
<tr><td><code id="Kern.FUN_+3A_bw">bw</code></td>
<td>

<p>bandwidth
</p>
</td></tr>
<tr><td><code id="Kern.FUN_+3A_kern0">kern0</code></td>
<td>

<p>kernel distribution
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the kernel matrix
</p>


<h3>Author(s)</h3>

<p>Layla Parast
</p>

<hr>
<h2 id='new.q'>
Helper function
</h2><span id='topic+new.q'></span>

<h3>Description</h3>

<p>Helper function; should not be called directly by user. This function differs from the quantile function in that it returns an NA when there are NAs in the supplied vector, rather than causing an error. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>new.q(x, p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="new.q_+3A_x">x</code></td>
<td>
<p> vector of numeric values
</p>
</td></tr>
<tr><td><code id="new.q_+3A_p">p</code></td>
<td>
<p> sample quantile that is desired
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns either NA or the desired sample quantile
</p>


<h3>Author(s)</h3>

<p>Layla Parast
</p>

<hr>
<h2 id='pred.smooth.surv'>
Calculates the conditional probability of survival for control group values
</h2><span id='topic+pred.smooth.surv'></span>

<h3>Description</h3>

<p>Helper function; calculates the estimated probability of survival for control 
control group surrogate values using treatment group surrogate and 
outcome information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pred.smooth.surv(xone.f, deltaone.f, sone.f, szero.one, myt, bw = NULL, 
weight, transform, extrapolate = T)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pred.smooth.surv_+3A_xone.f">xone.f</code></td>
<td>

<p>observed event times in the treatment group.
</p>
</td></tr>
<tr><td><code id="pred.smooth.surv_+3A_deltaone.f">deltaone.f</code></td>
<td>

<p>censoring indicators in the treatment group.
</p>
</td></tr>
<tr><td><code id="pred.smooth.surv_+3A_sone.f">sone.f</code></td>
<td>

<p>surrogate marker values in the treatment group.
</p>
</td></tr>
<tr><td><code id="pred.smooth.surv_+3A_szero.one">szero.one</code></td>
<td>

<p>surrogate marker values in the control group.
</p>
</td></tr>
<tr><td><code id="pred.smooth.surv_+3A_myt">myt</code></td>
<td>

<p>time of interest.
</p>
</td></tr>
<tr><td><code id="pred.smooth.surv_+3A_bw">bw</code></td>
<td>

<p>bandwidth.
</p>
</td></tr>
<tr><td><code id="pred.smooth.surv_+3A_weight">weight</code></td>
<td>

<p>weight used for perturbation resampling.
</p>
</td></tr>
<tr><td><code id="pred.smooth.surv_+3A_transform">transform</code></td>
<td>

<p>TRUE or FALSE; indicates whether a transformation should be used, default is FALSE.
</p>
</td></tr>
<tr><td><code id="pred.smooth.surv_+3A_extrapolate">extrapolate</code></td>
<td>

<p>TRUE or FALSE; indicates whether local constant extrapolation should be used, default is TRUE.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list is returned:                
</p>
<table>
<tr><td><code>Phat.ss</code></td>
<td>
<p>conditional probability of survival past t for control group</p>
</td></tr>
<tr><td><code>warn.flag</code></td>
<td>
<p>warning flag equal to 1 if extrapolation was used; 0 otherwise</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Layla Parast
</p>

<hr>
<h2 id='R.q.event'>
Calculates the proportion of the treatment effect (the difference in restriced mean survival time at time t) explained by surrogate outcome information observed up to the landmark time
</h2><span id='topic+R.q.event'></span>

<h3>Description</h3>

<p>Calculates the proportion of the treatment effect (the difference in restriced mean survival time at time t) explained by surrogate outcome information observed up to the landmark time; also provides standard error estimate and confidence interval.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>R.q.event(xone, xzero, deltaone, deltazero, sone, szero, t, landmark, number = 40, 
transform = FALSE, extrapolate = TRUE, std = FALSE, conf.int = FALSE, 
weight.perturb = NULL, type = "np")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="R.q.event_+3A_xone">xone</code></td>
<td>

<p>numeric vector, observed event times for the primary outcome in the treatment group.
</p>
</td></tr>
<tr><td><code id="R.q.event_+3A_xzero">xzero</code></td>
<td>

<p>numeric vector, observed event times for the primary outcome in the control group.
</p>
</td></tr>
<tr><td><code id="R.q.event_+3A_deltaone">deltaone</code></td>
<td>

<p>numeric vector, event/censoring indicators for the primary outcome in the treatment group.
</p>
</td></tr>
<tr><td><code id="R.q.event_+3A_deltazero">deltazero</code></td>
<td>

<p>numeric vector, event/censoring indicators for the primary outcome in the control group.
</p>
</td></tr>
<tr><td><code id="R.q.event_+3A_sone">sone</code></td>
<td>

<p>numeric vector, observed event times for the surrogate outcome in the treatment group.
</p>
</td></tr>
<tr><td><code id="R.q.event_+3A_szero">szero</code></td>
<td>

<p>numeric vector, observed event times for the surrogate outcome in the control group.
</p>
</td></tr>
<tr><td><code id="R.q.event_+3A_t">t</code></td>
<td>

<p>time of interest for treatment effect.
</p>
</td></tr>
<tr><td><code id="R.q.event_+3A_landmark">landmark</code></td>
<td>

<p>landmark time of interest, <code class="reqn">t_0</code>.
</p>
</td></tr>
<tr><td><code id="R.q.event_+3A_number">number</code></td>
<td>

<p>number of points for RMST calculation, default is 40.
</p>
</td></tr>
<tr><td><code id="R.q.event_+3A_transform">transform</code></td>
<td>

<p>TRUE or FALSE; indicates whether a transformation should be used, default is FALSE.
</p>
</td></tr>
<tr><td><code id="R.q.event_+3A_extrapolate">extrapolate</code></td>
<td>

<p>TRUE or FALSE; indicates whether local constant extrapolation should be used, default is FALSE.
</p>
</td></tr>
<tr><td><code id="R.q.event_+3A_std">std</code></td>
<td>

<p>TRUE or FALSE; indicates whether standard error estimates should be provided, default is FALSE. Estimates are calculated using perturbation-resampling. Two versions are provided: one that takes the standard deviation of the perturbed estimates (denoted as &quot;sd&quot;) and one that takes the median absolute deviation (denoted as &quot;mad&quot;). 
</p>
</td></tr>
<tr><td><code id="R.q.event_+3A_conf.int">conf.int</code></td>
<td>

<p>TRUE or FALSE; indicates whether 95% confidence intervals should be provided. Confidence intervals are calculated using the percentiles of perturbed estimates, default is FALSE. If this is TRUE, standard error estimates are automatically provided.
</p>
</td></tr>
<tr><td><code id="R.q.event_+3A_weight.perturb">weight.perturb</code></td>
<td>

<p>weights used for perturbation resampling.
</p>
</td></tr>
<tr><td><code id="R.q.event_+3A_type">type</code></td>
<td>

<p>Type of estimate that should be provided; options are &quot;np&quot; for the nonparametric estimate or &quot;semi&quot; for the semiparametric estimate, default is &quot;np&quot;.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let <code class="reqn">G \in \{1,0\}</code> be the randomized treatment indicator, <code class="reqn">T</code> denote the time of the primary outcome of interest, and <code class="reqn">S</code> denote the time of the surrogate outcome. We use potential outcomes notation such that <code class="reqn">T^{(G)}</code> and <code class="reqn">S^{(G)}</code> denote the respective times of the primary and surrogate outcomes under treatment G, for <code class="reqn">G \in \{1, 0\}</code>.  In the absence of censoring, we only observe <code class="reqn">(T, S)=(T^{(1)}, S^{(1)})</code> or <code class="reqn">(T^{(0)}, S^{(0)})</code> for each individual depending on whether <code class="reqn">G=1</code> or <code class="reqn">0</code>. Due to censoring, data consist of <code class="reqn">n = n_1 + n_0</code> independent observations <code class="reqn">\{X_{gi}, \delta_{gi}, I(S_{gi}&lt; t_0)I(X_{gi} &gt; t_0),  S_{gi}\wedge t_0 I(X_{gi} &gt; t_0), i=1,...,n_g, g = 1,0\}</code>, where <code class="reqn">X_{gi} = T_{gi}\wedge C_{ gi}</code>, <code class="reqn">\delta_{gi} = I(T_{gi} &lt; C_{gi})</code>, <code class="reqn">C_{gi}</code> denotes the censoring time, <code class="reqn">T_{gi}</code> denotes the time of the primary outcome, <code class="reqn">S_{gi}</code> denotes the time of the surrogate outcome, <code class="reqn">\{(T_{gi}, C_{gi}, S_{gi}), i = 1, ..., n_g\}</code> are identically distributed within treatment group, and <code class="reqn">t_0</code> is the landmark time of interest.
</p>
<p>We define the treatment effect as the difference in restricted mean survival time up to a fixed time <code class="reqn">t</code> under treatment 1 versus under treatment 0,
</p>
<p style="text-align: center;"><code class="reqn"> \Delta(t)=E\{T^{(1)}\wedge t\} - E\{T^{(0)}\wedge t \}</code>
</p>

<p>where <code class="reqn">\wedge</code> indicates the minimum. To define the proportion of treatment effect explained by the surrogate outcome information, let </p>
<p style="text-align: center;"><code class="reqn">Q_{t_0} ^{(g)} =  (Q_{t_01}, Q_{t_02})'=\{S ^{(g)} \wedge t_0I(T ^{(g)} &gt; t_0), T^{(g)} I(T^{(g)} \le t_0)\}',  g=1, 0</code>
</p>

<p>and define the residual treatment effect after accounting for the treatment effect on the surrogate outcome information as:
</p>
<p style="text-align: center;"><code class="reqn"> \Delta_Q(t,t_0) = P ^{(0)}_{t_0,2}\int_0^{t_0} \phi_1(t|t_0,s)dF_0(s) + P^{(0)}_{t_0,3}\psi_1(t|t_0) - P(T ^{(0)}&gt; t_0) \nu_0(t|t_0)</code>
</p>
<p>  where  <code class="reqn">P^{(0)}_{t_0,2} = P(T^{(0)} &gt; {t_0}, S ^{(0)} &lt; t_0)</code> and <code class="reqn"> P^{(0)}_{t_0,3} = P(T^{(0)} &gt; {t_0}, S ^{(0)} &gt; t_0)</code>,  <code class="reqn"> \psi_1(t \mid t_0) = E(T^{(1)}\wedge t \mid  T^{(1)}&gt; t_0, S^{(1)} &gt; t_0)</code>, 
<code class="reqn">\phi_1(t\mid t_0,s) = E(T^{(1)}\wedge t \mid  T ^{(1)}&gt; t_0, S ^{(1)} = s), \quad \nu_0(t|t_0) = E(T ^{(0)} \wedge t | T ^{(0)}&gt; t_0)</code>, and  <code class="reqn">F_0(\cdot\mid t_0)</code> is the cumulative distribution function of <code class="reqn">S^{(0)}</code> conditional on <code class="reqn">T ^{(0)}&gt; t_0</code> and <code class="reqn">S ^{(0)} &lt; t_0</code>. Then, the proportion of treatment effect on the primary outcome that is explained by surrogate information up to <code class="reqn">t_0</code>, <code class="reqn">Q_{t_0}</code>, can be expressed as a contrast between  <code class="reqn">\Delta(t)</code> and <code class="reqn">\Delta_Q(t,t_0)</code>:
</p>
<p style="text-align: center;"><code class="reqn">R_Q(t,t_0) = \{\Delta(t) - \Delta_Q(t,t_0) \} / \Delta(t) = 1-  \Delta_Q(t,t_0) / \Delta(t).</code>
</p>
 
<p>The quantity <code class="reqn"> \Delta(t)</code> is estimated using inverse probability of censoring weights:
</p>
<p style="text-align: center;"><code class="reqn">\hat{\Delta}(t)  = n_1^{-1} \sum_{i=1}^{n_1} \hat{M}_{1i}(t)- n_0^{-1} \sum_{i=1}^{n_0} \hat{M}_{0i}(t)</code>
</p>

<p>where  <code class="reqn">\hat{M}_{gi}(t) = I(X_{gi} &gt; t)t/\hat{W}^C_g(t) +  I(X_{gi} &lt; t)X_{gi}\delta_{gi}/\hat{W}^C_g(X_{gi})</code> and <code class="reqn">\hat{W}^C_g(t)</code> is the Kaplan-Meier estimator of <code class="reqn">P(C_{gi} \ge t).</code> The residual treatment effect <code class="reqn"> \Delta_Q(t,t_0)</code> can be estimated nonparametrically or semi-parametrically. For nonparametric estimation, <code class="reqn"> \psi_{1}(t|t_0)</code> is estimated by <code class="reqn">\hat{\psi}_{1}(t|t_0) = \sum_{i=1}^{n_1}\frac{  { \hat{W}^C_1(t_0)} I(S_{1i}&gt;t_0, X_{1i} &gt; t_0) }{ \sum_{i=1}^{n_1}I(S_{1i}&gt;t_0, X_{1i} &gt; t_0)} \hat{M}_{1i}(t)</code>, and <code class="reqn">\phi_1(t \mid t_0,s) = E(T^{(1)}\wedge t\mid  X^{(1)}&gt; t_0, S ^{(1)} = s)</code> is estimated using a
nonparametric kernel Nelson-Aalen estimator for <code class="reqn">\Lambda_1(t\mid t_0,s ),</code> the cumulative hazard function of <code class="reqn">T^{(1)}</code> conditional on <code class="reqn">S^{(1)}=s</code> and <code class="reqn">T^{(1)}&gt;t_0,</code> as
</p>
<p style="text-align: center;"><code class="reqn">\hat \phi_1(t \mid t_0,s)  = t_0+\int_ {t_0}^t \exp\{-\hat{\Lambda}_1(t\mid t_0,s) \}dt,</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">\hat{\Lambda}_1(t\mid t_0,s) = \int_{t_0}^t \frac{\sum_{i=1}^{n_1} I(X_{1i}&gt;t_0, {S_{1i} &lt; t_0})  K_h\{\gamma(S_{1i}) - \gamma(s)\}dN_{1i}(z)}{\sum_{i=1}^{n_1}  I(X_{1i}&gt;t_0,  {S_{1i} &lt; t_0})  K_h\{\gamma(S_{1i}) - \gamma(s)\} Y_{1i}(z)},</code>
</p>

<p>is a consistent estimate of <code class="reqn">\Lambda_1(t\mid t_0,s ),</code> <code class="reqn">Y_{1i}(t) = I(X_{1i} \geq t)</code>,  <code class="reqn">N_{1i}(t) = I(X_{1i} \leq t) \delta_i,  K(\cdot)</code> is a smooth symmetric density function, <code class="reqn">K_h(x) = K(x/h)/h</code>, <code class="reqn">\gamma(\cdot)</code> is a given monotone transformation function, and <code class="reqn">h=O(n_1^{-\eta})</code> is a specified bandwidth with <code class="reqn">\eta \in (1/2,1/4)</code>.  Finally, we let </p>
<p style="text-align: center;"><code class="reqn">
\hat{\nu}_{0}(t|t_0) = \sum_{i=1}^{n_0}\frac{  {\hat{W}^C_0(t_0)}I(X_{0i} &gt; t_0) }{ \sum_{i=1}^{n_0}I(X_{0i} &gt; t_0)} \hat{M}_{0i}(t).</code>
</p>

<p>We then estimate  <code class="reqn">\Delta_{Q}(t,t_0)</code> as <code class="reqn">\hat{\Delta}_{Q}(t,t_0)</code> defined as
</p>
<p style="text-align: center;"><code class="reqn">
n_0^{-1} \sum_{i=1}^{n_0} \left \{ \frac{I_{t_0,2}(X_{0i}, S_{0i})\hat{\phi}_1(t\mid t_0, S_{0i}) + I_{t_0,3}(X_{0i}, S_{0i})\hat{\psi}_1(t\mid t_0) - I_{t_0}(X_{0i})\hat{\nu}(t|t_0) }{\hat{W}^C_0(t_0)} \right \}</code>
</p>

<p>where <code class="reqn"> I_{t_0,2}(x, s) = I(x &gt; {t_0}, s &lt; t_0)</code> and <code class="reqn"> I_{t_0,3}(x, s) = I(x &gt; {t_0}, s &gt; t_0)</code> and <code class="reqn"> I_{t_0}(x)=I(x &gt; {t_0})</code> and thus, <code class="reqn">\hat{R}_Q(t,t_0) =1- \hat{\Delta}_Q(t,t_0)/\hat{\Delta}(t).</code>
</p>
<p>For the semi-parametric estimate,  <code class="reqn">\hat \phi_1(t| t_0,s)</code> is replaced with an estimate obtained using a landmark Cox proportional hazards model </p>
<p style="text-align: center;"><code class="reqn">P(T^{(1)}&gt; t\mid  T^{(1)}&gt; t_0, S^{(1)} &lt; t_0, S ^{(1)}) = \exp \{ -\Lambda_0(t|t_0)\exp(\beta_0S ^{(1)})\}</code>
</p>

<p>where <code class="reqn">\Lambda_0(t|t_0)</code> is the unspecified baseline cumulative hazard among <code class="reqn">\Omega_{t_0} = \{T^{(1)}&gt; t_0, S^{(1)} &lt; t_0\}</code> and <code class="reqn">\beta_0</code> is unknown. That is, let <code class="reqn">\tilde \phi_1(t| t_0,s) =  t_0+\int_{t_0}^{t}\exp \{ -\hat{\Lambda}_0(t|t_0)\exp(\hat{\beta}s)\} dt,</code>  where <code class="reqn">\hat{\beta}</code> is estimated by fitting a Cox model to the subpopulation <code class="reqn">\Omega_{t_0}</code> with a single predictor <code class="reqn">S</code> and <code class="reqn">\hat{\Lambda}_0(\cdot|t_0)</code> is the corresponding Breslow estimator. Then the semiparametric estimator for
<code class="reqn">\Delta_{Q}(t,t_0)</code> is <code class="reqn">\tilde{\Delta}_{Q}(t,t_0)</code> defined as
</p>
<p style="text-align: center;"><code class="reqn"> n_0^{-1} \sum_{i=1}^{n_0} \left \{ \frac{I_{t_0,2}(X_{0i}, S_{0i})\tilde{\phi}_1(t\mid t_0, S_{0i}) + I_{t_0,3}(X_{0i}, S_{0i})\hat{\psi}_1(t\mid t_0) - I_{t_0}(X_{0i})\hat{\nu}(t|t_0) }{\hat{W}^C_0(t_0)} \right \} </code>
</p>

<p>and <code class="reqn">\tilde{R}_Q(t,t_0) =1- \tilde{\Delta}_Q(t,t_0)/\hat{\Delta}(t).</code>
</p>


<h3>Value</h3>

<p>A list is returned:                
</p>
<table>
<tr><td><code>delta</code></td>
<td>
<p>the estimate, <code class="reqn">\hat{\Delta}(t)</code>, described in delta.estimate documentation.</p>
</td></tr>
<tr><td><code>delta.q</code></td>
<td>
<p>the estimate, <code class="reqn">\hat{\Delta}_Q(t,t_0)</code>, described above.</p>
</td></tr>
<tr><td><code>R.q</code></td>
<td>
<p>the estimate, <code class="reqn">\hat{R}_Q(t,t_0)</code>, described above.</p>
</td></tr>
<tr><td><code>delta.sd</code></td>
<td>
<p>the standard error estimate of <code class="reqn">\hat{\Delta}(t)</code>; if std = TRUE or conf.int = TRUE.</p>
</td></tr>
<tr><td><code>delta.mad</code></td>
<td>
<p>the standard error estimate of <code class="reqn">\hat{\Delta}(t)</code> using the median absolute deviation; if std = TRUE or conf.int = TRUE.</p>
</td></tr> 
<tr><td><code>delta.q.sd</code></td>
<td>
<p>the standard error estimate of <code class="reqn">\hat{\Delta}_Q(t,t_0)</code>; if std = TRUE or conf.int = TRUE.</p>
</td></tr>
<tr><td><code>delta.q.mad</code></td>
<td>
<p>the standard error estimate of <code class="reqn">\hat{\Delta}_Q(t,t_0)</code> using the median absolute deviation; if std = TRUE or conf.int = TRUE.</p>
</td></tr>  
<tr><td><code>R.q.sd</code></td>
<td>
<p>the standard error estimate of <code class="reqn">\hat{R}_Q(t,t_0)</code>; if std = TRUE or conf.int = TRUE.</p>
</td></tr>
<tr><td><code>R.q.mad</code></td>
<td>
<p>the standard error estimate of <code class="reqn">\hat{R}_Q(t,t_0)</code> using the median absolute deviation; if std = TRUE or conf.int = TRUE.</p>
</td></tr>
<tr><td><code>conf.int.delta</code></td>
<td>
<p>a vector of size 2; the 95% confidence interval for <code class="reqn">\hat{\Delta}(t)</code> based on sample quantiles of the perturbed values; if conf.int = TRUE.</p>
</td></tr>
<tr><td><code>conf.int.delta.q</code></td>
<td>
<p>a vector of size 2; the 95% confidence interval for <code class="reqn">\hat{\Delta}_Q(t,t_0)</code> based on sample quantiles of the perturbed values; if conf.int = TRUE.</p>
</td></tr> 
<tr><td><code>conf.int.R.q</code></td>
<td>
<p>a vector of size 2; the 95% confidence interval for <code class="reqn">\hat{R}_Q(t,t_0)</code> based on sample quantiles of the perturbed values; if conf.int = TRUE.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Layla Parast
</p>


<h3>References</h3>

<p>Parast L, Tian L, and Cai T (2020). Assessing the Value of a Censored Surrogate Outcome. Lifetime Data Analysis, 26(2):245-265.
</p>
<p>Parast, L and Cai, T (2013). Landmark risk prediction of residual life for breast cancer survival. Statistics in Medicine, 32(20), 3459-3471.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ExampleData)
names(ExampleData)


R.q.event(xone = ExampleData$x1, xzero = ExampleData$x0, deltaone = ExampleData$delta1, 
deltazero = ExampleData$delta0, sone = ExampleData$s1, szero = ExampleData$s0, t = 5, 
landmark=2, type = "np")
R.q.event(xone = ExampleData$x1, xzero = ExampleData$x0, deltaone = ExampleData$delta1, 
deltazero = ExampleData$delta0, sone = ExampleData$s1, szero = ExampleData$s0, t = 5, 
landmark=2, type = "semi")
R.q.event(xone = ExampleData$x1, xzero = ExampleData$x0, deltaone = ExampleData$delta1, 
deltazero = ExampleData$delta0, sone = ExampleData$s1, szero = ExampleData$s0, t = 5, 
landmark=2, type = "np", std = TRUE, conf.int = TRUE)

</code></pre>

<hr>
<h2 id='R.t.estimate'>
Calculates the proportion of the treatment effect (the difference in restricted mean survival time at time t) explained by primary outcome information observed up to the landmark time
</h2><span id='topic+R.t.estimate'></span>

<h3>Description</h3>

<p>Calculates the proportion of the treatment effect (the difference in restricted mean survival time at time t) explained by primary outcome information observed up to the landmark time; also provides standard error estimate and confidence interval.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>R.t.estimate(xone, xzero, deltaone, deltazero, t, landmark, std = FALSE, conf.int
 = FALSE, weight.perturb = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="R.t.estimate_+3A_xone">xone</code></td>
<td>

<p>numeric vector, observed event times for the primary outcome in the treatment group.
</p>
</td></tr>
<tr><td><code id="R.t.estimate_+3A_xzero">xzero</code></td>
<td>

<p>numeric vector, observed event times for the primary outcome in the control group.
</p>
</td></tr>
<tr><td><code id="R.t.estimate_+3A_deltaone">deltaone</code></td>
<td>

<p>numeric vector, event/censoring indicators for the primary outcome in the treatment group.
</p>
</td></tr>
<tr><td><code id="R.t.estimate_+3A_deltazero">deltazero</code></td>
<td>

<p>numeric vector, event/censoring indicators for the primary outcome in the control group.
</p>
</td></tr>
<tr><td><code id="R.t.estimate_+3A_t">t</code></td>
<td>

<p>time of interest for treatment effect.
</p>
</td></tr>
<tr><td><code id="R.t.estimate_+3A_landmark">landmark</code></td>
<td>

<p>landmark time of interest, <code class="reqn">t_0</code>.
</p>
</td></tr>
<tr><td><code id="R.t.estimate_+3A_std">std</code></td>
<td>

<p>TRUE or FALSE; indicates whether standard error estimates should be provided, default is FALSE. Estimates are calculated using perturbation-resampling. Two versions are provided: one that takes the standard deviation of the perturbed estimates (denoted as &quot;sd&quot;) and one that takes the median absolute deviation (denoted as &quot;mad&quot;). 
</p>
</td></tr>
<tr><td><code id="R.t.estimate_+3A_conf.int">conf.int</code></td>
<td>

<p>TRUE or FALSE; indicates whether 95% confidence intervals should be provided. Confidence intervals are calculated using the percentiles of perturbed estimates, default is FALSE. If this is TRUE, standard error estimates are automatically provided.
</p>
</td></tr>
<tr><td><code id="R.t.estimate_+3A_weight.perturb">weight.perturb</code></td>
<td>

<p>weights used for perturbation resampling.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let <code class="reqn">G \in \{1,0\}</code> be the randomized treatment indicator, <code class="reqn">T</code> denote the time of the primary outcome of interest, and <code class="reqn">S</code> denote the time of the surrogate outcome. We use potential outcomes notation such that <code class="reqn">T^{(G)}</code> and <code class="reqn">S^{(G)}</code> denote the respective times of the primary and surrogate outcomes under treatment G, for <code class="reqn">G \in \{1, 0\}</code>.  In the absence of censoring, we only observe <code class="reqn">(T, S)=(T^{(1)}, S^{(1)})</code> or <code class="reqn">(T^{(0)}, S^{(0)})</code> for each individual depending on whether <code class="reqn">G=1</code> or <code class="reqn">0</code>. Due to censoring, data consist of <code class="reqn">n = n_1 + n_0</code> independent observations <code class="reqn">\{X_{gi}, \delta_{gi}, I(S_{gi}&lt; t_0)I(X_{gi} &gt; t_0),  S_{gi}\wedge t_0 I(X_{gi} &gt; t_0), i=1,...,n_g, g = 1,0\}</code>, where <code class="reqn">X_{gi} = T_{gi}\wedge C_{ gi}</code>, <code class="reqn">\delta_{gi} = I(T_{gi} &lt; C_{gi})</code>, <code class="reqn">C_{gi}</code> denotes the censoring time, <code class="reqn">T_{gi}</code> denotes the time of the primary outcome, <code class="reqn">S_{gi}</code> denotes the time of the surrogate outcome, <code class="reqn">\{(T_{gi}, C_{gi}, S_{gi}), i = 1, ..., n_g\}</code> are identically distributed within treatment group, and <code class="reqn">t_0</code> is the landmark time of interest.
</p>
<p>The proportion of treatment effect explained by primary outcome information observed up to the landmark time, <code class="reqn">t_0</code>, is defined as <code class="reqn">R_T(t, t_0) = 1-\Delta_T(t,t_0) / \Delta(t)</code> where 
</p>
<p style="text-align: center;"><code class="reqn">\Delta_T(t,t_0)   =  P(T^{(0)} &gt; t_0) E\{T^{(1)} \wedge t - T^{(0)} \wedge t \mid T &gt; t_0 \}</code>
</p>
<p> and <code class="reqn">\Delta(t)</code> is the treatment effect on the primary outcome, defined in the documentation for delta.estimate. The quantity <code class="reqn">\Delta_T(t,t_0)</code> is estimated using </p>
<p style="text-align: center;"><code class="reqn">\hat{\Delta}_T(t,t_0) = n_0^{-1} \sum_{i=1}^{n_0} I(X_{0i} &gt; t_0) /\hat{W}_0^C(t_0)  \{\hat{\nu}_{1}(t|t_0) - \hat{\nu}_{0}(t|t_0) \}</code>
</p>
<p> where <code class="reqn">\hat{W}^C_0(t)</code> is the Kaplan-Meier estimator of <code class="reqn">P(C_{gi} \ge t)</code>, <code class="reqn">\hat{\nu}_{0}(t|t_0)</code> is defined in the documentation for R.q.event and <code class="reqn">\hat{\nu}_{1}(t|t_0)</code> is obtained by replacing <code class="reqn">0</code> with <code class="reqn">1</code>.
</p>


<h3>Value</h3>

<p>A list is returned:                
</p>
<table>
<tr><td><code>delta</code></td>
<td>
<p>the estimate, <code class="reqn">\hat{\Delta}(t)</code>, described in delta.estimate documentation.</p>
</td></tr>
<tr><td><code>delta.t</code></td>
<td>
<p>the estimate, <code class="reqn">\hat{\Delta}_T(t,t_0)</code>, described above.</p>
</td></tr>
<tr><td><code>R.t</code></td>
<td>
<p>the estimate, <code class="reqn">\hat{R}_T(t,t_0)</code>, described above.</p>
</td></tr>
<tr><td><code>delta.sd</code></td>
<td>
<p>the standard error estimate of <code class="reqn">\hat{\Delta}(t)</code>; if std = TRUE or conf.int = TRUE.</p>
</td></tr>
<tr><td><code>delta.mad</code></td>
<td>
<p>the standard error estimate of <code class="reqn">\hat{\Delta}(t)</code> using the median absolute deviation; if std = TRUE or conf.int = TRUE.</p>
</td></tr> 
<tr><td><code>delta.t.sd</code></td>
<td>
<p>the standard error estimate of <code class="reqn">\hat{\Delta}_T(t,t_0)</code>; if std = TRUE or conf.int = TRUE.</p>
</td></tr>
<tr><td><code>delta.t.mad</code></td>
<td>
<p>the standard error estimate of <code class="reqn">\hat{\Delta}_T(t,t_0)</code> using the median absolute deviation; if std = TRUE or conf.int = TRUE.</p>
</td></tr>  
<tr><td><code>R.t.sd</code></td>
<td>
<p>the standard error estimate of <code class="reqn">\hat{R}_T(t,t_0)</code>; if std = TRUE or conf.int = TRUE.</p>
</td></tr>
<tr><td><code>R.t.mad</code></td>
<td>
<p>the standard error estimate of <code class="reqn">\hat{R}_T(t,t_0)</code> using the median absolute deviation; if std = TRUE or conf.int = TRUE.</p>
</td></tr>
<tr><td><code>conf.int.delta</code></td>
<td>
<p>a vector of size 2; the 95% confidence interval for <code class="reqn">\hat{\Delta}(t)</code> based on sample quantiles of the perturbed values; if conf.int = TRUE.</p>
</td></tr>
<tr><td><code>conf.int.delta.t</code></td>
<td>
<p>a vector of size 2; the 95% confidence interval for <code class="reqn">\hat{\Delta}_T(t,t_0)</code> based on sample quantiles of the perturbed values; if conf.int = TRUE.</p>
</td></tr> 
<tr><td><code>conf.int.R.t</code></td>
<td>
<p>a vector of size 2; the 95% confidence interval for <code class="reqn">\hat{R}_T(t,t_0)</code> based on sample quantiles of the perturbed values; if conf.int = TRUE.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Layla Parast
</p>


<h3>References</h3>

<p>Parast L, Tian L, and Cai T (2020). Assessing the Value of a Censored Surrogate Outcome. Lifetime Data Analysis, 26(2):245-265.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ExampleData)
names(ExampleData)


R.t.estimate(xone = ExampleData$x1, xzero = ExampleData$x0, deltaone =ExampleData$delta1, 
deltazero = ExampleData$delta0, t = 5, landmark=2)

R.t.estimate(xone = ExampleData$x1, xzero = ExampleData$x0, deltaone = ExampleData$delta1, 
deltazero = ExampleData$delta0, t = 5, landmark=2, std = TRUE, conf.int = TRUE)


</code></pre>

<hr>
<h2 id='VTM'>
Repeats a row
</h2><span id='topic+VTM'></span>

<h3>Description</h3>

<p>Helper function; this function creates a matrix that repeats vc, dm times where each row is equal to the vc vector. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>VTM(vc, dm)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VTM_+3A_vc">vc</code></td>
<td>

<p>the vector to repeat.
</p>
</td></tr>
<tr><td><code id="VTM_+3A_dm">dm</code></td>
<td>

<p>number of rows.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a matrix that repeats vc, dm times where each row is equal to the vc vector
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
