<!DOCTYPE html><html lang="en"><head><title>Help for package ConfIntVariance</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ConfIntVariance}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ConfIntVariance-package'>
<p>Confidence Interval for the Univariate Population Variance without Normality Assumption</p></a></li>
<li><a href='#varwci'>
<p>varwci</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Confidence Interval for the Univariate Population Variance
without Normality Assumption</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-03-06</td>
</tr>
<tr>
<td>Author:</td>
<td>Mathias Fuchs</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Mathias Fuchs&lt;mathias@mathiasfuchs.de&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Surrounds the usual sample variance of a univariate numeric sample with a confidence interval for the population variance. This has been done so far only under the assumption that the underlying distribution is normal. Under the hood, this package implements the unique least-variance unbiased estimator of the variance of the sample variance, in a formula that is equivalent to estimating kurtosis and square of the population variance in an unbiased way and combining them according to the classical formula into an estimator of the variance of the sample variance. Both the sample variance and the estimator of its variance are U-statistics. By the theory of U-statistic, the resulting estimator is unique. See Fuchs, Krautenbacher (2016) &lt;<a href="https://doi.org/10.1080%2F15598608.2016.1158675">doi:10.1080/15598608.2016.1158675</a>&gt; and the references therein for an overview of unbiased estimation of variances of U-statistics.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-03-08 19:13:32 UTC; mathias</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-03-10 10:02:39 UTC</td>
</tr>
</table>
<hr>
<h2 id='ConfIntVariance-package'>
Confidence Interval for the Univariate Population Variance without Normality Assumption
</h2><span id='topic+ConfIntVariance-package'></span><span id='topic+ConfIntVariance'></span>

<h3>Description</h3>

<p>Surrounds the usual sample variance of a univariate numeric sample with a confidence interval for the population variance. This has been done so far only under the assumption that the underlying distribution is normal. Under the hood, this package implements the unique least-variance unbiased estimator of the variance of the sample variance, in a formula that is equivalent to estimating kurtosis and square of the population variance in an unbiased way and combining them according to the classical formula into an estimator of the variance of the sample variance. Both the sample variance and the estimator of its variance are U-statistics. By the theory of U-statistic, the resulting estimator is unique. See Fuchs, Krautenbacher (2016) &lt;doi:10.1080/15598608.2016.1158675&gt; and the references therein for an overview of unbiased estimation of variances of U-statistics.
</p>


<h3>Details</h3>

<p>The DESCRIPTION file:
</p>

<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> ConfIntVariance</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Title: </td><td style="text-align: left;"> Confidence Interval for the Univariate Population Variance without Normality Assumption</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0.2</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2019-03-06</td>
</tr>
<tr>
 <td style="text-align: left;">
Author: </td><td style="text-align: left;"> Mathias Fuchs</td>
</tr>
<tr>
 <td style="text-align: left;">
Maintainer: </td><td style="text-align: left;"> Mathias Fuchs&lt;mathias@mathiasfuchs.de&gt;</td>
</tr>
<tr>
 <td style="text-align: left;">
Description: </td><td style="text-align: left;"> Surrounds the usual sample variance of a univariate numeric sample with a confidence interval for the population variance. This has been done so far only under the assumption that the underlying distribution is normal. Under the hood, this package implements the unique least-variance unbiased estimator of the variance of the sample variance, in a formula that is equivalent to estimating kurtosis and square of the population variance in an unbiased way and combining them according to the classical formula into an estimator of the variance of the sample variance. Both the sample variance and the estimator of its variance are U-statistics. By the theory of U-statistic, the resulting estimator is unique. See Fuchs, Krautenbacher (2016) &lt;doi:10.1080/15598608.2016.1158675&gt; and the references therein for an overview of unbiased estimation of variances of U-statistics.</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-3</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Index of help topics:
</p>
<pre>
ConfIntVariance-package
                        Confidence Interval for the Univariate
                        Population Variance without Normality
                        Assumption
varwci                  varwci
</pre>
<p>A package providing one function varwci which is short for
&quot;variance with confidence interval.&quot;
</p>


<h3>Author(s)</h3>

<p>Mathias Fuchs
Maintainer: Mathias Fuchs&lt;mathias@mathiasfuchs.de&gt;
</p>


<h3>References</h3>

<p>www.mathiasfuchs.de/b3.html
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
##
## Example: throwing a dice
## 

                                        # True quantities that do not depend on n
trueMeanOfDice &lt;- mean(1:6)


                                        # The true variance of the dice
                                        # This is the quantity that we
                                        # want to estimate by embracing
                                        # with a confidence interval
                                        # instead of just estimating
                                        # with a point estimator as is
                                        # done in the function var
trueVarianceOfDice &lt;- mean((1:6)^2) - trueMeanOfDice^2
trueFourthCentralMomentOfDice &lt;- mean(((1:6)-trueMeanOfDice)^4)

                                        # this requires some scribbling with paper and pencil
                                        # (or a study of Hoeffding 1948)
trueVarianceOfSampleVarianceOfDice &lt;- function(n) 
(trueFourthCentralMomentOfDice - trueVarianceOfDice^2 * (n-3)/(n-1))/n

##
## Simulation study: compute the coverage probability of
## the confidence interval by computing the probability
## that it contains the true value.
## We want that probability to be equal to the confidence level 0.95,
## not more and not less. (If it was higher, the test would be too conservative).
##

                                        # number of times we draw a
                                        # sample and compute a confidence interval
N &lt;- 1e4
trueValueCovered &lt;- sapply(
    1:N,
    function(i) {
                                        # throw a dice 100 times
        x &lt;- sample(6, 100, replace=TRUE)
                                        # compute our confidence interval
        ci &lt;- varwci(x)
                                        # We know that the true variance
                                        # of the dice is
                                        # 35/12 = 2.916666...
                                        # Record the boolean whether the
                                        # confidence interval contains
                                        # the true value.
        (35/12 &gt; ci[1] &amp;&amp; 35/12 &lt; ci[2])
    }
)

                                        # Result of simulation study:
                                        # Will be close to 0.95.
print(mean(trueValueCovered))

</code></pre>

<hr>
<h2 id='varwci'>
varwci
</h2><span id='topic+varwci'></span>

<h3>Description</h3>

<p>Surround the univariate variance estimator of the function var with a
confidence interval, not assuming normality
</p>


<h3>Usage</h3>

<pre><code class='language-R'>varwci(x, conf.level=0.95)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="varwci_+3A_x">x</code></td>
<td>
<p>A one-dimensional numeric vector</p>
</td></tr>
<tr><td><code id="varwci_+3A_conf.level">conf.level</code></td>
<td>
<p>The confidence level for the confidence
interval. Defaults to 0.95</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a vector with two entries: the lower and the upper bound of the
confidence interval, and the following attributes:
</p>

<dl>
<dt>point.estimator</dt><dd><p>The usual sample variance at the center of the interval</p>
</dd>
<dt>conf.level</dt><dd><p>The confidence level used</p>
</dd>
<dt>var.SampleVariance</dt><dd><p>The estimated variance of the sample variance</p>
</dd>
</dl>



<h3>Warning </h3>

<p>On very small sample sizes, the result is NA because there is insufficient information on the variance estimation
</p>


<h3>Note</h3>

<p>The underlying theory is that of U-statistics. See Hoeffding 1948.
</p>


<h3>Author(s)</h3>

<p>Mathias Fuchs
</p>


<h3>References</h3>

<p>http://dx.doi.org/10.1080/15598608.2016.1158675 and https://mathiasfuchs.de/b3.html
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##
## Example: throwing a dice
## 

# throw a dice 100 times
s &lt;- sample(6, 100, replace=TRUE)

# the standard point estimator for the variance
print(var(s))

# contains the true value 2.9166 with a probability of 95 percent.
print(varwci(s))

##
## Check the coverage probability of the confidence interval
##

                                        # True quantities that do not depend on n
trueMeanOfDice &lt;- mean(1:6)
trueVarianceOfDice &lt;- mean((1:6)^2) - trueMeanOfDice^2

## see package description for more details
                                        # number of times we draw a
                                        # sample and compute a confidence interval
N &lt;- 1e4
trueValueCovered &lt;- rep(NA, N)
for (i in 1:N) {
    if (i %% 1e3 == 0) print(i)
                                        # throw a dice 100 times
    x &lt;- sample(6, 100, replace=TRUE)
                                        # compute our confidence interval
    ci &lt;- varwci(x)
                                        # We know that the true variance
                                        # of the dice is 91/6 - 49/4 = 2.916666...
                                        # did the confidence interval contain the correct value?
    trueValueCovered[i] &lt;- (trueVarianceOfDice &gt; ci[1] &amp;&amp; trueVarianceOfDice &lt; ci[2])
}

                                        # Result of simulation study: should be close to 0.95
print(mean(trueValueCovered))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
