<!DOCTYPE html><html lang="en"><head><title>Help for package Rbent</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {Rbent}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#data_mrs'><p>MRS data</p></a></li>
<li><a href='#data_transport'><p>bedload transport data</p></a></li>
<li><a href='#rbentfit'><p>rank estimation for bent line regression</p></a></li>
<li><a href='#rbenttest'><p>test the existence of change point in the bent line regression</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Robust Bent Line Regression</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Feipeng Zhang &lt;zhangfp108@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>An implementation of robust bent line regression. It can fit the bent line regression and test the existence of change point,
    for the paper, "Feipeng Zhang and Qunhua Li (2016). Robust bent line regression, submitted."</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2.0)]</td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>5.0.1</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1.0), Rfit</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://arxiv.org/abs/1606.02234">http://arxiv.org/abs/1606.02234</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2016-06-08 02:04:42 UTC; Frank2015</td>
</tr>
<tr>
<td>Author:</td>
<td>Feipeng Zhang [cre],
  Qunhua Li [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2016-06-08 05:46:58</td>
</tr>
</table>
<hr>
<h2 id='data_mrs'>MRS data</h2><span id='topic+data_mrs'></span>

<h3>Description</h3>

<p>A dataset containing the mass, speed and hopper indicator for land animals.
The variables are as follows:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(data_mrs)
</code></pre>


<h3>Format</h3>

<p>A data frame with 107 rows and 3 variables
</p>

<dl>
<dt>mass</dt><dd><p>the mass of animals</p>
</dd>
<dt>speed</dt><dd><p>the speed of animals</p>
</dd>
<dt>hopper</dt><dd><p>the indicator variabel of hoppers</p>
</dd>
</dl>


<h3>Source</h3>

<p>Garland, T.(1983).
</p>


<h3>References</h3>


<ul>
<li><p> Garland, T.(1983).
The relation between maximal running speed and body
mass in terrestrial mammals. Journal of Zoology 199, 157&ndash;170.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(data_mrs)
summary(data_mrs)

## End(Not run)
</code></pre>

<hr>
<h2 id='data_transport'>bedload transport data</h2><span id='topic+data_transport'></span>

<h3>Description</h3>

<p>A dataset containing  the discharge, the bedload transport rate
The variables are as follows:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(data_transport)
</code></pre>


<h3>Format</h3>

<p>A data frame with 76 rows and 2 variables
</p>

<dl>
<dt>x</dt><dd><p>the discharge (cubic meters/second)</p>
</dd>
<dt>y</dt><dd><p>the bedload transport rate (kilograms/second)</p>
</dd>
</dl>


<h3>Source</h3>

<p>Ryan, S., Porth, L., Troendle, C. (2002).
</p>


<h3>References</h3>


<ul>
<li><p> Ryan, S., Porth, L., Troendle, C. (2002).
Defining phases of bedload transport
using piecewise regression.
Earth Surface Processes and Landforms 27, 971&ndash;990.
</p>
</li>
<li><p> Ryan, S., Porth, L. (2007). A tutorial on the piecewise
regression approach applied to bedload transport data.
US Department of Agriculture, Forest Service,
Rocky Mountain Research Station Fort Collins, CO, 1&ndash;41.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>data(data_transport)
summary(data_transport)
</code></pre>

<hr>
<h2 id='rbentfit'>rank estimation for bent line regression</h2><span id='topic+rbentfit'></span>

<h3>Description</h3>

<p>This function use Wilcoxon score functions for
fitting the bent line regression model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rbentfit(y, z, x, bet.ini, tau.ini, tol = 1e-04, max.iter = 50)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rbentfit_+3A_y">y</code></td>
<td>
<p>A vector of response</p>
</td></tr>
<tr><td><code id="rbentfit_+3A_z">z</code></td>
<td>
<p>A vector of covariates</p>
</td></tr>
<tr><td><code id="rbentfit_+3A_x">x</code></td>
<td>
<p>A numeric variable with change point</p>
</td></tr>
<tr><td><code id="rbentfit_+3A_bet.ini">bet.ini</code></td>
<td>
<p>A initial vector of regression coefficients</p>
</td></tr>
<tr><td><code id="rbentfit_+3A_tau.ini">tau.ini</code></td>
<td>
<p>A initial value of change point</p>
</td></tr>
<tr><td><code id="rbentfit_+3A_tol">tol</code></td>
<td>
<p>tolerance value, 1e-4 for default</p>
</td></tr>
<tr><td><code id="rbentfit_+3A_max.iter">max.iter</code></td>
<td>
<p>the maximum iteration steps</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the elements
</p>
<table role = "presentation">
<tr><td><code>est</code></td>
<td>
<p>The estimated regression coefficients with intercept.</p>
</td></tr>
<tr><td><code>bp</code></td>
<td>
<p>The estimated change point.</p>
</td></tr>
<tr><td><code>est.se</code></td>
<td>
<p>The estimated standard error of the regression coefficients.</p>
</td></tr>
<tr><td><code>bp.est</code></td>
<td>
<p>The estimated standard error of the change point.</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p>The iteration steps.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Feipeng Zhang
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n &lt;- 150
x &lt;- runif(n, 0, 4)
z &lt;- rnorm(n, 1, 1)
y &lt;- 1 + 0.5*z + 1.5*x  - 3 *pmax(x-2, 0)  + rt(n, 2)
rbentfit(y, cbind(1,z), x, bet.ini = c(0, 1, 1, -2), tau.ini = 1)

# for the example of  MRS data
data(data_mrs)
x &lt;- log(data_mrs$mass)
y &lt;- log(data_mrs$speed)
z &lt;- data_mrs$hopper
tau.ini &lt;- 3
dat.new &lt;- data.frame(y=y, z1=z, z2 = x, z3=pmax(x-tau.ini,0))
library(Rfit)
fit.ini &lt;- rfit(y~ z1 + z2 +z3, data= dat.new)   # with intercept
bet.ini &lt;- fit.ini$coef
fit.rank &lt;- rbentfit(y, cbind(1,z), x, bet.ini, tau.ini)
</code></pre>

<hr>
<h2 id='rbenttest'>test the existence of change point in the bent line regression</h2><span id='topic+rbenttest'></span>

<h3>Description</h3>

<p>This function use Wilcoxon score functions for  calculating
the test statistics and p-value by wild bootstrap.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rbenttest(y, z, x, NB = 1000, myseed = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rbenttest_+3A_y">y</code></td>
<td>
<p>A vector of response</p>
</td></tr>
<tr><td><code id="rbenttest_+3A_z">z</code></td>
<td>
<p>A vector of covariates</p>
</td></tr>
<tr><td><code id="rbenttest_+3A_x">x</code></td>
<td>
<p>A numeric variable with change point</p>
</td></tr>
<tr><td><code id="rbenttest_+3A_nb">NB</code></td>
<td>
<p>resampling times</p>
</td></tr>
<tr><td><code id="rbenttest_+3A_myseed">myseed</code></td>
<td>
<p>set seed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the elements
</p>
<table role = "presentation">
<tr><td><code>Tn</code></td>
<td>
<p>The statistic based on original data.</p>
</td></tr>
<tr><td><code>Tn.NB</code></td>
<td>
<p>The statistics by wild bootstrap.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>The p-value by wild bootstrap.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Feipeng Zhang
</p>


<h3>Examples</h3>

<pre><code class='language-R'># for the example of  MRS data
data(data_mrs)
x &lt;- log(data_mrs$mass)
y &lt;- log(data_mrs$speed)
z &lt;- data_mrs$hopper
p.value &lt;- rbenttest(y, cbind(1, z), x, NB = 50)$p.value

# for the example of bedload transport data
data(data_transport)
x &lt;- data_transport$x
y &lt;- data_transport$y
p.value &lt;- rbenttest(y, 1, x, NB = 50)$p.value
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
