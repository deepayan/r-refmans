<!DOCTYPE html><html><head><title>Help for package OTUtable</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {OTUtable}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#OTUtable-package'>
<p>OTU table analysis functions</p></a></li>
<li><a href='#bog_subset'>
<p>Subset OTU table by sampling site</p></a></li>
<li><a href='#chao1'>
<p>Chao1 Richness</p></a></li>
<li><a href='#clean_mothur_taxonomy'>
<p>Clean mothur-format Taxonomy File</p></a></li>
<li><a href='#clean_shared'>
<p>Reformat a shared file</p></a></li>
<li><a href='#clean_TaxAss_taxonomy'>
<p>Clean Taxonomy File Output by TaxAss Workflow</p></a></li>
<li><a href='#combine_otus'>
<p>Combine OTUs based on identical taxonomic assignments</p></a></li>
<li><a href='#extract_date'>
<p>Extract sampling date from a vector of sample names</p></a></li>
<li><a href='#filter_taxa'>
<p>Filter Taxa Based on Abundance and Persistence</p></a></li>
<li><a href='#grab_group'>
<p>Subset OTU table by taxonomic assignment</p></a></li>
<li><a href='#make_do_matrix'>
<p>Make matrix of dissolved oxygen data</p></a></li>
<li><a href='#make_temp_matrix'>
<p>Make matrix of temperature data</p></a></li>
<li><a href='#metadata'>
<p>Lake metadata for OTU table</p></a></li>
<li><a href='#obs_richness'>
<p>Observed Richness</p></a></li>
<li><a href='#otu_table'>
<p>OTU table generated from 8 bog lakes over 4 years</p></a></li>
<li><a href='#pielou'>
<p>Pielou's Evenness</p></a></li>
<li><a href='#plot_column'>
<p>Plot DO or temperature data from a depth profile over time</p></a></li>
<li><a href='#reduce_names'>
<p>Shorten taxonomic assignment in table row names</p></a></li>
<li><a href='#remove_reps'>
<p>Remove the second replicate of each sample, when it exists</p></a></li>
<li><a href='#rotate'>
<p>Rotate a matrix</p></a></li>
<li><a href='#shannon'>
<p>Shannon's Biodiversity Index</p></a></li>
<li><a href='#taxonomy'>
<p>Taxonomic assignments of OTUs</p></a></li>
<li><a href='#year_subset'>
<p>Subset samples by a specific year</p></a></li>
<li><a href='#zscore'>
<p>Z-score normalize relative abundance data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>North Temperate Lakes - Microbial Observatory 16S Time Series
Data and Functions</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2018-05-26</td>
</tr>
<tr>
<td>Author:</td>
<td>Alexandra Linz</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Alexandra Linz &lt;amlinz16@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Analyses of OTU tables produced by 16S rRNA gene amplicon sequencing, as well as example data. It contains the data and scripts used in the paper Linz, et al. (2017) "Bacterial community composition and dynamics spanning five years in freshwater bog lakes," &lt;<a href="https://doi.org/10.1128%2FmSphere.00169-17">doi:10.1128/mSphere.00169-17</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-05-26 14:17:50 UTC; Alex</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-05-26 15:20:55 UTC</td>
</tr>
</table>
<hr>
<h2 id='OTUtable-package'>
OTU table analysis functions
</h2><span id='topic+OTUtable-package'></span><span id='topic+OTUtable'></span>

<h3>Description</h3>

<p>Contains functions for the analysis of an OTU table generated from 16S rRNA amplicon sequencing. It also includes the data from the North Temperate Lakes-Microbial Observatory used in the paper Linz, et al. (2017) &quot;Bacterial community composition and dynamics spanning five years in freshwater bog lakes.&quot; Please cite this paper if you use OTUtable. The data and code used in this paper are available at &lt;https://github.com/McMahonLab/North_Temperate_Lakes-Microbial_Observatory&gt;.
Three data files are included: otu_table, taxonomy, and metadata. Access these by calling them with data(). There is also a fasta file associated with this dataset that is not included in this package - it can be found on our GitHub page in Data/16S_data. This package does not include functionality for fasta files; if you need this for analyses such as calculating UniFrac distance, please see the R package &quot;phyloseq&quot;.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> OTUtable</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.1.2</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2018-05-26</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-3 </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Functions include:
bog_subset <br />
chao1 <br />
clean_shared <br />
clean_mothur_taxonomy <br />
clean_TaxAss_taxonomy <br />
combine_otus <br />
extract_date <br />
filter_taxa <br />
grab_group <br />
make_do_matrix <br />
make_temp_matrix <br />
obs_richness <br />
pielou <br />
plot_column <br />
reduce_names <br />
remove_reps <br />
rotate <br />
shannon <br />
strat_metric <br />
year_subset <br />
zscore <br />
</p>


<h3>Author(s)</h3>

<p>Alexandra Linz &lt;amlinz16@gmail.com&gt;
</p>


<h3>References</h3>

<p>Alexandra M. Linz, Benjamin C. Crary, Ashley Shade, Sarah Owens, Jack A. Gilbert, Rob Knight, Katherine D. McMahon.
Bacterial Community Composition and Dynamics Spanning Five Years in Freshwater Bog Lakes. mSphere Jun 2017, 2 (3)
e00169-17; DOI: 10.1128/mSphere.00169-17
</p>

<hr>
<h2 id='bog_subset'>
Subset OTU table by sampling site
</h2><span id='topic+bog_subset'></span>

<h3>Description</h3>

<p>Returns an OTU table containing only samples from the identified sampling site. This function can also be used on tables of higher level taxa generated by combine_otus(), or on tables that have already been processed by year_subset().
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bog_subset(bog_id, table)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bog_subset_+3A_bog_id">bog_id</code></td>
<td>

<p>The three letter code indicating the sampling site. The bog is represented by letters one and two; options are TB, SS, CB, NS, MA, HK, WS, and FB. The third letter indicates the layer; E for epilimnion and H for hypolimnion. The bog_id should be in quotes, and regular expressions can be used.
</p>
</td></tr>
<tr><td><code id="bog_subset_+3A_table">table</code></td>
<td>

<p>A table containing the relative abundances of each taxon as rows and samples as columns. Sample names must be coded in the format bog, layer, date, and replicate (example: TBE07JUN08.R2 == Trout Bog Epilimnion, collected 07Jun08, replicate 2)
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a relative abundance table containing samples from the specified sampling site in columns, with taxa in rows
</p>


<h3>Author(s)</h3>

<p>Alexandra Linz &lt;amlinz16@gmail.com&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(otu_table)

Trout_Bog_Epilimnion &lt;- bog_subset("TBE", otu_table)

Hells_Kitchen_Hypolimnion &lt;- bog_subset("HKH", otu_table)

# Include both epilimnion and hypolimnion in a single table
Trout_Bog_both_layers &lt;- bog_subset("TB.", otu_table)

# Include all meromictic hypolimnia
meromictic_hypolimnia &lt;- bog_subset("HKH|MAH", otu_table)

</code></pre>

<hr>
<h2 id='chao1'>
Chao1 Richness
</h2><span id='topic+chao1'></span>

<h3>Description</h3>

<p>Calculates Chao1 richness of a vector of relative abundance data. This alpha diversity metric takes into account the number of singletons and doubletons for a more accurate estimate than observed richness.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chao1(sample)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="chao1_+3A_sample">sample</code></td>
<td>

<p>A vector of relative abundance data, typically a column in a matrix
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a single number indicating the estimated richness in the tested sample based on the number of taxa appearing only once or twice
</p>


<h3>Note</h3>

<p>Use apply functions to calculate Chao1 richness for all samples in a matrix
</p>


<h3>Author(s)</h3>

<p>Alexandra Linz &lt;amlinz16@gmail.com&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(otu_table)
chao1_richness &lt;- apply(otu_table, 2, chao1)
</code></pre>

<hr>
<h2 id='clean_mothur_taxonomy'>
Clean mothur-format Taxonomy File
</h2><span id='topic+clean_mothur_taxonomy'></span>

<h3>Description</h3>

<p>Reduces information in a mothur .taxonomy file by removing the second column with the number of reads per OTU. It will also check for and remove OTUs in the taxonomy file that are not in OTU table - this may be the case if rarefaction was performed after classification, as was used in the NTL-Microbial Observatory dataset. This function was formerly clean_taxonomy in v1.0.0.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clean_mothur_taxonomy(taxonomy_file, table, remove_bootstrap)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clean_mothur_taxonomy_+3A_taxonomy_file">taxonomy_file</code></td>
<td>

<p>A .taxonomy file output by mothur
</p>
</td></tr>
<tr><td><code id="clean_mothur_taxonomy_+3A_table">table</code></td>
<td>

<p>An OTU table containing OTU numbers as row names
</p>
</td></tr>
<tr><td><code id="clean_mothur_taxonomy_+3A_remove_bootstrap">remove_bootstrap</code></td>
<td>

<p>TRUE or FALSE: if TRUE, removes bootstrap values from the classification strings
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the taxonomy with OTUs as row names and seven columns containing each taxonomic level (Kingdom, Phylum, Class, Order, Lineage, Clade, and Tribe)
</p>


<h3>Author(s)</h3>

<p>Alexandra Linz &lt;amlinz16@gmail.com&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example path only: path &lt;- "mothur_output/bogs.taxonomy"
# table &lt;- clean_shared("mothur_output/bogs.shared", trim.names = T)
# taxonomy &lt;- clean_mothur_taxonomy(path, table, remove_bootstrap = F)

</code></pre>

<hr>
<h2 id='clean_shared'>
Reformat a shared file
</h2><span id='topic+clean_shared'></span>

<h3>Description</h3>

<p>Converts a mothur .shared file into a simplified OTU table. The columns indicating total reads for each OTU and the clustering level are removed, and the table is transposed so that OTUs are rows and samples are columns. The &quot;trim.names&quot; variable provides an option to shorten sample names to the first &quot;.&quot; character - this is specific to the NTL-Microbial Observatory dataset. Manual curation of sample names took place after this step for the NTL-Microbial Observatory dataset in order to maintain consistency across all sample names.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clean_shared(shared_file, trim.names)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clean_shared_+3A_shared_file">shared_file</code></td>
<td>

<p>A .shared file output by mothur
</p>
</td></tr>
<tr><td><code id="clean_shared_+3A_trim.names">trim.names</code></td>
<td>

<p>TRUE or FALSE - if TRUE, sample names will be trimmed to the first &quot;.&quot; character.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an OTU table with samples as columns and OTUs as rows. 
</p>


<h3>Author(s)</h3>

<p>Alexandra Linz &lt;amlinz16@gmail.com&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example path only: path &lt;- "mothur_output/bogs.shared"

# otu_table &lt;- clean_shared(path, trim.names = T)
# write.csv(otu_table, file = "bogs_otu_table.csv", quote = F, row.names = T)

</code></pre>

<hr>
<h2 id='clean_TaxAss_taxonomy'>
Clean Taxonomy File Output by TaxAss Workflow
</h2><span id='topic+clean_TaxAss_taxonomy'></span>

<h3>Description</h3>

<p>Formats a taxonomy file output by the McMahon Lab TaxAss 16S classification workflow (github.com/McMahonLab/TaxAss) into the same format produced by clean_mothur_taxonomy(). It will also check for and remove OTUs in the taxonomy file that are not in OTU table - this may be the case if rarefaction was performed after classification, as was used in the NTL-Microbial Observatory dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clean_TaxAss_taxonomy(taxonomy_file, table, remove_bootstrap)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clean_TaxAss_taxonomy_+3A_taxonomy_file">taxonomy_file</code></td>
<td>

<p>A .taxonomy file output by the TaxAss workflow
</p>
</td></tr>
<tr><td><code id="clean_TaxAss_taxonomy_+3A_table">table</code></td>
<td>

<p>An OTU table containing OTU numbers as row names
</p>
</td></tr>
<tr><td><code id="clean_TaxAss_taxonomy_+3A_remove_bootstrap">remove_bootstrap</code></td>
<td>

<p>TRUE or FALSE: if TRUE, removes bootstrap values from the classification strings
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the taxonomy with OTUs as row names and seven columns containing each taxonomic level (Kingdom, Phylum, Class, Order, Lineage, Clade, and Tribe)
</p>


<h3>Author(s)</h3>

<p>Alexandra Linz &lt;amlinz16@gmail.com&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example path only: path &lt;- "TaxAss_output/bogs.taxonomy"
# table &lt;- clean_shared("mothur_output/bogs.shared", trim.names = T)
# taxonomy &lt;- clean_TaxAss_taxonomy(path, table, remove_bootstrap = F)

</code></pre>

<hr>
<h2 id='combine_otus'>
Combine OTUs based on identical taxonomic assignments
</h2><span id='topic+combine_otus'></span>

<h3>Description</h3>

<p>Sums the abundances of OTUs with the same taxonomy at a given level into a single vector for that taxonomy. This creates a new table of relative abundance data at a higher taxonomic level than OTU. This function only works with the OTU level as input, but can be used on any subset of the OTU table created by year_subset() or bog_subset(). The OTU table must have the same number of rows as the taxonomy file (do not remove rows with no reads before running combine_otus())
If bootstrap values were not removed by expand_taxa(), this command will likely create spurious groupings based on identical bootstrap values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>combine_otus(level, table, taxonomy)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="combine_otus_+3A_level">level</code></td>
<td>

<p>The desired level at which to combine OTUs; options are the column names from the taxonomy dataset
</p>
</td></tr>
<tr><td><code id="combine_otus_+3A_table">table</code></td>
<td>

<p>An OTU table containing the relative abundances of each OTU.
</p>
</td></tr>
<tr><td><code id="combine_otus_+3A_taxonomy">taxonomy</code></td>
<td>

<p>A taxonomy dataset in the form produced by expand_taxa().
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a table of relative abundance data with each row representing all OTUs of a given taxonomic assignment summed together. Row names are now the full taxonomic assignment of each row. To keep only the the lowest taxonomic level in the row names, run the function reduce_names()
</p>


<h3>Author(s)</h3>

<p>Alexandra Linz &lt;amlinz16@gmail.com&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(otu_table)
data(taxonomy)

example_table &lt;- year_subset("05", otu_table)
example_table &lt;- bog_subset("TBE", example_table)

phylum_table &lt;- combine_otus("Phylum", example_table, taxonomy)

</code></pre>

<hr>
<h2 id='extract_date'>
Extract sampling date from a vector of sample names
</h2><span id='topic+extract_date'></span>

<h3>Description</h3>

<p>The date each sample was collected is encoded in the sample ID. Extract this into R date format using this command. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_date(sample_ids)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extract_date_+3A_sample_ids">sample_ids</code></td>
<td>

<p>A vector of sample names. Samples must be labeled using the bog, layer, date, and replicate system (MAH04JUL05.R1 = Mary Lake Hypolimnion, 04Jul05, replicate 1)
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a vector of dates corresponding to each sample
</p>


<h3>Author(s)</h3>

<p>Alexandra Linz &lt;amlinz16@gmail.com&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
samples &lt;- c("TBE01JUN09.R1", "TBE05JUN09", "TBE10JUN09.R2")
extract_date(samples)

# Extract sample dates from the OTU table
data(otu_table)
x &lt;- extract_date(colnames(otu_table))

# Extract sample dates from the metadata
data(metadata)
x &lt;- extract_date(metadata$Sample_Name)

</code></pre>

<hr>
<h2 id='filter_taxa'>
Filter Taxa Based on Abundance and Persistence
</h2><span id='topic+filter_taxa'></span>

<h3>Description</h3>

<p>Returns a table containing only taxa that meet the imposed requirements of a minimum abundance and a minimum number of samples containing that taxon
</p>


<h3>Usage</h3>

<pre><code class='language-R'>filter_taxa(table, abundance, persistence)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="filter_taxa_+3A_table">table</code></td>
<td>

<p>A table containing the relative abundances of each OTU or taxon in the form produced by clean_shared(). Can be used on the output of grab_groups() or combine_otus()
</p>
</td></tr>
<tr><td><code id="filter_taxa_+3A_abundance">abundance</code></td>
<td>

<p>The minimum threshold for percentage of reads attributed to a taxon in at least one sample. Taxa at abundances greater than or equal this number will be retained.
</p>
</td></tr>
<tr><td><code id="filter_taxa_+3A_persistence">persistence</code></td>
<td>

<p>The minimum threshold for the percentage of samples in which a taxon has been observed.  Taxa at abundances greater than or equal this number will be retained.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a table with all taxa that met the imposed thresholds
</p>


<h3>Note</h3>

<p>Thanks Juliana Dias for suggesting this function!
</p>


<h3>Author(s)</h3>

<p>Alexandra Linz &lt;amlinz16@gmail.com&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# To make a table containing only OTUs with at least 0.1% abundance 
# in at least one sample that were observed 
# (at any abundance) in at least 50% of samples:
# library(OTUtable)
# data(otu_table)
# filtered_table &lt;- filter_taxa(otu_table, abundance = 0.1, persistence = 50)

# To make a table containing only phyla with at least 10% abundance 
# in any one sample and were observed 
# at any abundance in at least 10% of samples:
# data(taxonomy)
# phylum_table &lt;- combine_otus("Phylum", otu_table, taxonomy)
# filtered_phylum_table &lt;- filter_taxa(phylum_table, abundance = 10, persistence = 10)
</code></pre>

<hr>
<h2 id='grab_group'>
Subset OTU table by taxonomic assignment
</h2><span id='topic+grab_group'></span>

<h3>Description</h3>

<p>Returns a table containing only taxa from a given phylogenetic group
</p>


<h3>Usage</h3>

<pre><code class='language-R'>grab_group(group, level, table, taxonomy)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="grab_group_+3A_group">group</code></td>
<td>

<p>The phylogenetic classification of interest (can be a regular expression)
</p>
</td></tr>
<tr><td><code id="grab_group_+3A_level">level</code></td>
<td>

<p>The phylogenetic level of the group of interest (must be a column name in the taxonomy file)
</p>
</td></tr>
<tr><td><code id="grab_group_+3A_table">table</code></td>
<td>

<p>A table containing the relative abundances of each OTU in the form produced by clean_shared()
</p>
</td></tr>
<tr><td><code id="grab_group_+3A_taxonomy">taxonomy</code></td>
<td>

<p>A taxonomy dataset in the form produced by expand_taxa()
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a table with all taxa of a given taxonomic assignment
</p>


<h3>Note</h3>

<p>This function must be run on the OTU level table. However, the output of this function can be run through combine_otus() to create a higher level table of results. Sometimes closely related groups were classified better in the Greengenes vs the freshwater database during classification of the NTL-Microbial Observatory dataset. In this case, it is necessary to search for the names generated by both datasets to get all closely related OTUs.
For example, Methylophilaceae in Greengenes are named betIV in the freshwater database.
</p>


<h3>Author(s)</h3>

<p>Alexandra Linz &lt;amlinz16@gmail.com&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'> 
data(otu_table)
data(taxonomy)

acI &lt;- grab_group("acI", "Clade", otu_table, taxonomy)
verruco &lt;- grab_group("Verrucomicrobia", "Phylum", otu_table, taxonomy)

# Example where two search terms are needed due to classification with two databases
methylophilaceae &lt;- grab_group("Methylophilaceae|betIV", "Clade", otu_table, taxonomy)
</code></pre>

<hr>
<h2 id='make_do_matrix'>
Make matrix of dissolved oxygen data
</h2><span id='topic+make_do_matrix'></span>

<h3>Description</h3>

<p>Takes a given sample ID and converts the dissolved oxygen data in data(metadata) from long format into a matrix. This is useful for plotting using plot_column()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_do_matrix(sampleID, field_data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make_do_matrix_+3A_sampleid">sampleID</code></td>
<td>

<p>A regular expression used to select a group of samples
</p>
</td></tr>
<tr><td><code id="make_do_matrix_+3A_field_data">field_data</code></td>
<td>

<p>A dataset of DO profiles in long format. Column names must be the same as the metadata file provided with this package
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Also fills in NA values with the average of the depth above and below the missing value. If the value is at the bottom of the water column, the second deepest is substituted.
</p>


<h3>Value</h3>

<p>Returns matrix of DO data with depth in rows and date in columns
</p>


<h3>Note</h3>

<p>This is mainly used for generating contour plots. In general, long format is easier to work with.
In the metadata file included in this package, each DO measurement is listed twice, once under the epilimnion sample name and again under the hypolimnion sample name.
</p>


<h3>Author(s)</h3>

<p>Alexandra Linz &lt;amlinz16@gmail.com&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(metadata)

dissolved_oxygen &lt;- make_do_matrix("TBE.....07", metadata)
</code></pre>

<hr>
<h2 id='make_temp_matrix'>
Make matrix of temperature data
</h2><span id='topic+make_temp_matrix'></span>

<h3>Description</h3>

<p>Takes a given sample ID and converts temperature data of water profiles over time from long format into a matrix. This is most often useful for plotting using plot_column().
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_temp_matrix(sampleID, field_data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make_temp_matrix_+3A_sampleid">sampleID</code></td>
<td>

<p>A regular expression used to select a group of samples
</p>
</td></tr>
<tr><td><code id="make_temp_matrix_+3A_field_data">field_data</code></td>
<td>

<p>A dataset of temperature profiles in long format. Column names must be the same as the metadata file provided with this package
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns matrix of temperature data with depth in rows and date in columns
</p>


<h3>Note</h3>

<p>This is mainly used for generating contour plots. In general, long format is easier to work with.
In the included metadata file, each temperature measurement is recorded twice, once as epilimnion and once as hypolimnion.
</p>


<h3>Author(s)</h3>

<p>Alexandra Linz &lt;amlinz16@gmail.com&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(metadata)

temp &lt;- make_temp_matrix("TBE.....07", metadata)
</code></pre>

<hr>
<h2 id='metadata'>
Lake metadata for OTU table
</h2><span id='topic+metadata'></span>

<h3>Description</h3>

<p>A dataset containing temperature and oxygen profiles from the lakes in this study
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(taxonomy)
</code></pre>


<h3>Format</h3>

<p>A dataframe with 6 columns (measured variables) and 13,607 rows	(depth profiles)
</p>


<h3>Details</h3>

<p>Missing data indicated by NA
Some sample dates and metadata dates may not match up exactly; if this presents an issue, please email and I will look at our written records for the right date
Epilimnion and hypolimnion samples each have an identical depth profile entry; search for just one or the other
</p>


<h3>Author(s)</h3>

<p>Alexandra Linz &lt;amlinz16@gmail.com&gt;
</p>

<hr>
<h2 id='obs_richness'>
Observed Richness
</h2><span id='topic+obs_richness'></span>

<h3>Description</h3>

<p>Calculates observed richness on a single column of relative abundance data. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>obs_richness(sample)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="obs_richness_+3A_sample">sample</code></td>
<td>

<p>A vector of relative abundance data, typically a single column in a matrix
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a single number indicating the number of taxa in the tested sample
</p>


<h3>Note</h3>

<p>Use apply functions to calculate richness for all samples in a matrix
</p>


<h3>Author(s)</h3>

<p>Alexandra Linz &lt;amlinz16@gmail.com&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'> data(otu_table)
 richness &lt;- apply(otu_table, 2, obs_richness)
</code></pre>

<hr>
<h2 id='otu_table'>
OTU table generated from 8 bog lakes over 4 years
</h2><span id='topic+otu_table'></span>

<h3>Description</h3>

<p>A dataset containing bacterial relative abundance data from the North Temperate Lakes Microbial Observatory
Produced from mothur output using clean_shared()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(otu_table)
</code></pre>


<h3>Format</h3>

<p>A dataframe with 1,387 columns (samples) and 6,208 rows	(OTUs)
</p>


<h3>Details</h3>

<p>Contains replicate samples
Each column has been rarefied to 2500
Sample names encode sampling site (&quot;TB&quot;), epilimnion or hypolimnion (&quot;E&quot; or &quot;H&quot;), sampling date (&quot;01JUN07&quot;) and replicate(&quot;.R2&quot;)
</p>


<h3>Author(s)</h3>

<p>Alexandra Linz &lt;amlinz16@gmail.com&gt;
</p>

<hr>
<h2 id='pielou'>
Pielou's Evenness
</h2><span id='topic+pielou'></span>

<h3>Description</h3>

<p>Calculates Pielou's evenness for a single vector of relative abundance data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pielou(sample)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pielou_+3A_sample">sample</code></td>
<td>

<p>A vector of relative abundance data
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a single value indicating the evenness of a community
</p>


<h3>Author(s)</h3>

<p>Alexandra Linz &lt;amlinz16@gmail.com&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(otu_table)
even &lt;- apply(otu_table, 2, pielou)

</code></pre>

<hr>
<h2 id='plot_column'>
Plot DO or temperature data from a depth profile over time
</h2><span id='topic+plot_column'></span>

<h3>Description</h3>

<p>Takes output from make_do_matrix or make_temp_matrix and plots using filled.contour()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_column(data_matrix, title)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_column_+3A_data_matrix">data_matrix</code></td>
<td>

<p>A matrix output by make_do_matrix() or make_temp_matrix()
</p>
</td></tr>
<tr><td><code id="plot_column_+3A_title">title</code></td>
<td>

<p>The title you would like on the plot
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Plots a filled contour plot showing the water column over time
</p>


<h3>Note</h3>

<p>Depends on the function rotate(). The functions make_do_matrix() and make_temp_matrix() fill in missing values with the average of the measurement at each depth above and below; however, if missing values are present in the matrix for plotting, these will appear as white space on the plot.
</p>


<h3>Author(s)</h3>

<p>Alexandra Linz &lt;amlinz16@gmail.com&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(metadata)
temp &lt;- make_temp_matrix("TBE.....07", metadata)
plot_column(temp, "Trout Bog 2007 Temperature")
</code></pre>

<hr>
<h2 id='reduce_names'>
Shorten taxonomic assignment in table row names
</h2><span id='topic+reduce_names'></span>

<h3>Description</h3>

<p>Reduces the full string indicating taxonomy to the last classified level. Works on tables at levels higher than OTUs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reduce_names(table)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="reduce_names_+3A_table">table</code></td>
<td>

<p>A table containing the relative abundances of each taxa produced by combine_otus()
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the same table with shortened row names
</p>


<h3>Note</h3>

<p>This function is often most useful for plotting, so that the full string does not appear on the plot
</p>


<h3>Author(s)</h3>

<p>Alexandra Linz &lt;amlinz16@gmail.com&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(otu_table)
data(taxonomy)

# Create a small table for the example
# example &lt;- year_subset("05", otu_table)
# example &lt;- bog_subset("TBE", example)

# clade_table &lt;- combine_otus("Clade", example, taxonomy)
# clade_table &lt;- clade_table[which(rowSums(clade_table) &gt; 0),]
# head(rownames(clade_table))
# reduced_clades &lt;- reduce_names(clade_table)
# head(rownames(reduced_clades))
</code></pre>

<hr>
<h2 id='remove_reps'>
Remove the second replicate of each sample, when it exists
</h2><span id='topic+remove_reps'></span>

<h3>Description</h3>

<p>Sometimes it is desirable to remove replicate samples (often for plotting). This command removes all samples marked as replicate 2. Please note that you should always check the similarity of replicates for your metric of interest before removing them for aesthetic purposes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>remove_reps(table)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="remove_reps_+3A_table">table</code></td>
<td>

<p>An OTU table containing the relative abundances of each OTU
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an OTU table containing only one replicate for each sample
</p>


<h3>Author(s)</h3>

<p>Alexandra Linz &lt;amlinz16@gmail.com&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'> data(otu_table)
 no_reps &lt;- remove_reps(otu_table)
</code></pre>

<hr>
<h2 id='rotate'>
Rotate a matrix
</h2><span id='topic+rotate'></span>

<h3>Description</h3>

<p>Rotates a matrix of data so that columns are reversed
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rotate(data_matrix)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rotate_+3A_data_matrix">data_matrix</code></td>
<td>

<p>Used in this package with matrix output by make_do_matrix or make_temp_matrix as part of the function plot_column(). Any matrix will work, though.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Used to rotate the DO or temperature matrices so that depth 0 is at the top of a contour plot and the max depth is at the bottom.
</p>


<h3>Value</h3>

<p>Returns a matrix that has been rotated so that it reads from bottom to top
</p>


<h3>Note</h3>

<p>Used with make_do_matrix(), make_temp_matrix(), and plot_column(). plot_column() depends on this function.
</p>


<h3>Author(s)</h3>

<p>An anonymous author on Stack Overflow
Alexandra Linz &lt;amlinz16@gmail.com&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(metadata)
temp &lt;- make_temp_matrix("TBE.....07", metadata)
r_temp &lt;- rotate(temp)

</code></pre>

<hr>
<h2 id='shannon'>
Shannon's Biodiversity Index
</h2><span id='topic+shannon'></span>

<h3>Description</h3>

<p>Calculates Shannon's Biodiversity Index on a single column of relative abundance data. This metric takes into account both richness and evenness.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shannon(sample)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="shannon_+3A_sample">sample</code></td>
<td>

<p>A vector of relative abundance data, typically a single column in a matrix
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a single number indicating the amount of biodiversity in the tested sample
</p>


<h3>Note</h3>

<p>Use apply functions to calculate Shannon's index for all samples in a matrix
</p>


<h3>Author(s)</h3>

<p>Alexandra Linz &lt;amlinz16@gmail.com&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(otu_table)
richness &lt;- apply(otu_table, 2, shannon)
</code></pre>

<hr>
<h2 id='taxonomy'>
Taxonomic assignments of OTUs
</h2><span id='topic+taxonomy'></span>

<h3>Description</h3>

<p>A dataset containing the taxonomy of each OTU in the otu_table
Produced from mothur output using clean_taxonomy()
Bootstrap values have been removed from this dataset, but are still available in as part of the Data folder in the McMahonLab/North_Temperate_Lakes-Microbial_Observatory GitHub repo
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(taxonomy)
</code></pre>


<h3>Format</h3>

<p>A dataframe with 7 columns (taxonomic levels) and 6,208 rows	(OTUs)
</p>


<h3>Details</h3>

<p>Classified using our Freshwater database, followed by Greengenes - for the full workflow, visit the McMahonLab Github 16STax-Ass repository
Some OTUs are missing; these were removed by subsampling of the OTU table
The presence of both blank (__) assignments and &quot;unclassified&quot; assignments are the result of the dual classification.
</p>


<h3>Author(s)</h3>

<p>Alexandra Linz &lt;amlinz16@gmail.com&gt;
</p>

<hr>
<h2 id='year_subset'>
Subset samples by a specific year
</h2><span id='topic+year_subset'></span>

<h3>Description</h3>

<p>Takes the year value in the last two digits of the sample ID and allows selection of a single year of data. Can be performed on tables at higher taxonomic levels generated by combine_otus(), or on tables already subset by bog_subset().
</p>


<h3>Usage</h3>

<pre><code class='language-R'>year_subset(year_id, table)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="year_subset_+3A_table">table</code></td>
<td>

<p>A table containing the relative abundances of each taxa
</p>
</td></tr>
<tr><td><code id="year_subset_+3A_year_id">year_id</code></td>
<td>

<p>Two digit code indicating the last two digits of the year of interest (05, 07, 08, 09) surrounded by quotes. Regular expressions can be used.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an OTU table containing only samples from the specified year
</p>


<h3>Author(s)</h3>

<p>Alexandra Linz &lt;amlinz16@gmail.com&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(otu_table)

seven &lt;- year_subset("07", otu_table)

# Select two years at once
two_years &lt;- year_subset("07|08", otu_table)
</code></pre>

<hr>
<h2 id='zscore'>
Z-score normalize relative abundance data
</h2><span id='topic+zscore'></span>

<h3>Description</h3>

<p>Normalizes taxa abundances in a table of relative abundance data using the z-score method.
((Abundance of one OTU in one sample) - (mean abundance for that OTU ))/(standard deviation of that OTU)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>zscore(table)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="zscore_+3A_table">table</code></td>
<td>

<p>A table of relative abundance data with taxa in rows and samples in columns
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a table with relative abundance data replaced by z-scores
</p>


<h3>Note</h3>

<p>There is debate on whether this method of normalization is valid for microbial communities, as their abundance distrubtions tend to be heavily skewed.
I found it useful for plotting heatmaps and for input into network analysis.
</p>


<h3>Author(s)</h3>

<p>Alexandra Linz &lt;amlinz16@gmail.com&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(otu_table)

# Create a small table for z-score normalization
example &lt;- year_subset("05", otu_table)
example &lt;- bog_subset("TBE", example)

# Remove OTUs that are not present in this subset
example &lt;- example[which(rowSums(example) &gt; 0), ]

z_otu_table &lt;- zscore(example)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
