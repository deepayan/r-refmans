<!DOCTYPE html><html><head><title>Help for package mhazard</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {mhazard}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#anemia'><p>Aplastic anemia clinical trial data.</p></a></li>
<li><a href='#bladder'><p>Bladder tumor recurrence data.</p></a></li>
<li><a href='#clayton_sim'><p>Simulated Clayton-Oakes data.</p></a></li>
<li><a href='#genClayton2'><p>Generates survival data from a bivariate Clayton-Oakes model</p></a></li>
<li><a href='#genClayton3'><p>Generates survival data from a trivariate Clayton-Oakes model</p></a></li>
<li><a href='#genClaytonReg'><p>Generates regression data from a bivariate Clayton-Oakes model</p></a></li>
<li><a href='#mHR2'><p>Cox regression for a bivariate outcome</p></a></li>
<li><a href='#mHR2.LF'><p>Bivariate regression survival function and marginal hazards estimation</p></a></li>
<li><a href='#mHR2.tvc'><p>Cox regression for a bivariate outcome with time-varying covariates</p></a></li>
<li><a href='#npSurv2'><p>Nonparametric estimates of the survival function for bivariate failure</p>
time data</a></li>
<li><a href='#npSurv3'><p>Nonparametric estimates of the survival function for trivariate failure</p>
time data</a></li>
<li><a href='#plotnpSurv2.3D'><p>Uses a 3D perspective plot to visualize a nonparametric bivariate</p>
survival function</a></li>
<li><a href='#plotnpSurv2.HM'><p>Uses a heat map to visualize a nonparametric bivariate survival function</p></a></li>
<li><a href='#tvc.example'><p>Creates an example of a matrix of time-varying covariates</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Nonparametric and Semiparametric Methods for Multivariate
Failure Time Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.3</td>
</tr>
<tr>
<td>Description:</td>
<td>Nonparametric survival function estimates and semiparametric
    regression for the multivariate failure time data with right-censoring.
    For nonparametric survival function estimates, the Volterra, Dabrowska,
    and Prentice-Cai estimates for bivariate failure time data may be
    computed as well as the Dabrowska estimate for the trivariate failure
    time data. Bivariate marginal hazard rate regression can be fitted for
    the bivariate failure time data. Functions are also provided to compute
    (bootstrap) confidence intervals and plot the estimates of the bivariate
    survival function. For details, see "The Statistical Analysis of
    Multivariate Failure Time Data: A Marginal Modeling Approach", Prentice,
    R., Zhao, S. (2019, ISBN: 978-1-4822-5657-4), CRC Press.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp, boot, plot3D, survival, rootSolve</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-16 09:21:13 UTC; ebair</td>
</tr>
<tr>
<td>Author:</td>
<td>Eric Bair [aut, cre],
  Taylor Petty [aut],
  Shanshan Zhao [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Eric Bair &lt;eric.bair@sciome.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-17 14:32:39 UTC</td>
</tr>
</table>
<hr>
<h2 id='anemia'>Aplastic anemia clinical trial data.</h2><span id='topic+anemia'></span>

<h3>Description</h3>

<p>Failure time data for 64 patients having severe aplastic anemia. Patients
were randomly assigned to receive either cyclosporine plus methotrexate
(CSPMTX) or methotrexate alone (MTX) with time from assignment to the
diagnosis of stage 2 or greater acute graft versus host disease (A-GVHD)
as a key outcome.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(anemia)
</code></pre>


<h3>Format</h3>

<p>A data frame with 64 rows and 5 variables:
</p>

<dl>
<dt>Treatment:</dt><dd><p>Treatment group, either cyclosporine and methotrexate
(CSPMTX) or methotrexate only (MTX).</p>
</dd>
<dt>Time:</dt><dd><p>Time in days to severe (stage &gt;=2) acute graft versus host
disease, death, or last contact.</p>
</dd>
<dt>LAF:</dt><dd><p>Patient assigned to laminar air flow isolation room at
baseline. LAF = 1 signifies yes, LAF = 0 signifies no.</p>
</dd>
<dt>Age:</dt><dd><p>Age of patient in years.</p>
</dd>
<dt>Censored:</dt><dd><p>Boolean for whether or not time to severe A-GVHD is
right-censored; i.e., the patient died without severe A-GVHD or was
without severe A-GVHD at last contact.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Table 1.1, page 14 of Prentice and Zhao 2019, taken from
Table 1.2 on page 3 in The Statistical Analysis of Failure Time Data,
Second Edition, by J. D. Kalbfleisch and R. L. Prentice. New York: Wiley
and Sons, 2002.
</p>


<h3>References</h3>

<p>Prentice, R., Zhao, S. &quot;The statistical analysis of multivariate
failure time data: A marginal modeling approach&quot;, CRC Press (2019).
</p>

<hr>
<h2 id='bladder'>Bladder tumor recurrence data.</h2><span id='topic+bladder'></span>

<h3>Description</h3>

<p>Data from a randomized trial of patient recurrences of superficial
bladder tumor recurrence as conducted by the Veterans Administration
Cooperative Urological Group. These data were used to compare the
frequency of recurrences among 48 patients assigned to placebo, among
whom there were a total of 87 post-randomization recurrences, and 38
patients assigned to treatment with a drug called thiotepa, among whom
there were 45 recurrences during the follow-up period, which averaged
about 31 months.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(bladder)
</code></pre>


<h3>Format</h3>

<p>A data frame with 86 rows and 13 variables:
</p>

<dl>
<dt>Group:</dt><dd><p>Placebo vs treatment (thiotepa).</p>
</dd>
<dt>Number:</dt><dd><p>Number of tumors present at baseline, with 8 denoting 8
or more.</p>
</dd>
<dt>Size:</dt><dd><p>Size of largest tumor at baseline, in centimeters.</p>
</dd>
<dt>CensorTime:</dt><dd><p>Censor time, in months.</p>
</dd>
<dt>T1:</dt><dd><p>For i = 1,...,9, T_i is the recurrence time, in months.
If there is no recurrence, T_1, ..., T_9 will be NA. If there is only one,
T_1 will be filled and T_2, ..., T_9 will be NA, and so on.</p>
</dd>
<dt>T2:</dt><dd><p>See T1.</p>
</dd>
<dt>T3:</dt><dd><p>See T1.</p>
</dd>
<dt>T4:</dt><dd><p>See T1.</p>
</dd>
<dt>T5:</dt><dd><p>See T1.</p>
</dd>
<dt>T6:</dt><dd><p>See T1.</p>
</dd>
<dt>T7:</dt><dd><p>See T1.</p>
</dd>
<dt>T8:</dt><dd><p>See T1.</p>
</dd>
<dt>T9:</dt><dd><p>See T1.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Table 1.2, page 18 of Prentice and Zhao 2019, taken from
Table 9.2 on page 292 in The Statistical Analysis of Failure Time Data,
Second Edition, by J. D. Kalbfleisch and R. L. Prentice. New York: Wiley
and Sons, 2002.
</p>


<h3>References</h3>

<p>Prentice, R., Zhao, S. &quot;The statistical analysis of multivariate
failure time data: A marginal modeling approach&quot;, CRC Press (2019).
</p>

<hr>
<h2 id='clayton_sim'>Simulated Clayton-Oakes data.</h2><span id='topic+clayton_sim'></span>

<h3>Description</h3>

<p>Data simulated under Clayton-Oakes model (Equation 1.7, page 7 of Prentice
and Zhao) at various theta values and n = 50, with each observed time having
a 1/3 probability of being censored. Variate T_i is right-censored by C_i
for i = 1,2 (see pages 52 and 53 of Prentice and Zhao 2019), and
min(T_i,C_i) = S_i, with delta_i = 1 if T_i = S_i, and 0 otherwise
(i.e., if T_i = S_i then the data was not censored).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(clayton_sim)
</code></pre>


<h3>Format</h3>

<p>A data frame with 150 rows and 5 variables:
</p>

<dl>
<dt>Theta:</dt><dd><p>Parameter value in Clayton-Oakes model.</p>
</dd>
<dt>S1:</dt><dd><p>min(T_1, C_1), where T_1 is time of interest and C_1 is a
censoring variable. We see T_1 if it is not censored (i.e. C_1 &gt; T_1),
and we see C_1 otherwise.</p>
</dd>
<dt>d1:</dt><dd><p>I(T_1=S_1), i.e. 1 if T_1 = S_1 and 0 otherwise.</p>
</dd>
<dt>S2:</dt><dd><p>See S1.</p>
</dd>
<dt>d2:</dt><dd><p>See d1.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Table 3.4, page 70 of Prentice and Zhao 2019.
</p>


<h3>References</h3>

<p>Prentice, R., Zhao, S. &quot;The statistical analysis of multivariate
failure time data: A marginal modeling approach&quot;, CRC Press (2019).
</p>

<hr>
<h2 id='genClayton2'>Generates survival data from a bivariate Clayton-Oakes model</h2><span id='topic+genClayton2'></span>

<h3>Description</h3>

<p>Generates simulated survival data from a bivariate Clayton-Oakes model,
which can be used to create example data for bivariate survival
function estimation. The marginal distributions are exponential with
given rate parameters. The joint distribution is defined using a Clayton
copula. The censoring times are also exponentially distributed with
given rate parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>genClayton2(n, theta, lambda10, lambda01, lambdaC1, lambdaC2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="genClayton2_+3A_n">n</code></td>
<td>
<p>Sample size for the simulated data set.</p>
</td></tr>
<tr><td><code id="genClayton2_+3A_theta">theta</code></td>
<td>
<p>Parameter for the Clayton copula. Must be -1 or larger.</p>
</td></tr>
<tr><td><code id="genClayton2_+3A_lambda10">lambda10</code>, <code id="genClayton2_+3A_lambda01">lambda01</code></td>
<td>
<p>Rate parameters for the (marginal) exponential
distributions.</p>
</td></tr>
<tr><td><code id="genClayton2_+3A_lambdac1">lambdaC1</code>, <code id="genClayton2_+3A_lambdac2">lambdaC2</code></td>
<td>
<p>Rate parameters for the censoring times. No
censoring occurs if this parameter is equal to 0.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing the following elements:
</p>

<dl>
<dt>Y1, Y2:</dt><dd><p>Survival times for the simulated data</p>
</dd>
<dt>Delta1, Delta2:</dt><dd><p>Censoring indicators for the simulated data</p>
</dd>
</dl>



<h3>Details</h3>

<p>This function simulates data with the following survival function:
F(t1,t2) = [F(t1,0)^(-theta) + F(0,t2)^(-theta) - 1]^(-1/theta)
(The survival function is defined to be equal to 0 if this
quantity is negative.) The marginal survival functions F(t1,0) and
F(0,t2) are exponentially distributed with rate parameters lambda10 and
lambda01, respectively. After generating survival times Y1 and Y2 (of
length n) under this distribution, censoring times C1 and C2 (also of
length n) are generated. C1/C2 are generated under an exponential
distribution with rate parameters lambdaC1 and lambdaC2. If
C1[i]&lt;Y1[i] for a given observation i, then observation i is
considered to be censored (i.e., Delta1[i]=0). Delta2 is defined in
a similar manner. If lambdaC1 or lambdaC2 is equal to 0, then the
corresponding variable is uncensored (meaning that Delta[i]=1 for
all i).
</p>


<h3>References</h3>

<p>Clayton, D. &quot;Model for association in bivariate life tables and its
application in epidemiological studies of familial tendency in chronic
disease incidence.&quot;, Biometrika (1978) 65:141-151.
Prentice, R., Zhao, S. &quot;The statistical analysis of multivariate
failure time data: A marginal modeling approach&quot;, CRC Press (2019).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- genClayton2(1000, 0, 1, 1, 2, 2)
</code></pre>

<hr>
<h2 id='genClayton3'>Generates survival data from a trivariate Clayton-Oakes model</h2><span id='topic+genClayton3'></span>

<h3>Description</h3>

<p>Generates simulated survival data from a trivariate Clayton-Oakes model,
which can be used to create example data for trivariate survival
function estimation. The marginal distributions are exponential with
rate parameter 1. The joint distribution is defined using a Clayton
copula. The censoring times are also exponentially distributed with
given rate parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>genClayton3(n, theta, lambdaC1, lambdaC2, lambdaC3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="genClayton3_+3A_n">n</code></td>
<td>
<p>Sample size for the simulated data set.</p>
</td></tr>
<tr><td><code id="genClayton3_+3A_theta">theta</code></td>
<td>
<p>Parameter for the Clayton copula. Must be -1 or larger.</p>
</td></tr>
<tr><td><code id="genClayton3_+3A_lambdac1">lambdaC1</code>, <code id="genClayton3_+3A_lambdac2">lambdaC2</code>, <code id="genClayton3_+3A_lambdac3">lambdaC3</code></td>
<td>
<p>Rate parameters for the censoring
times. No censoring occurs if this parameter is equal to 0.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing the following elements:
</p>

<dl>
<dt>Y1, Y2, Y3:</dt><dd><p>Survival times for the simulated data</p>
</dd>
<dt>Delta1, Delta2, Delta3:</dt><dd><p>Censoring indicators for the simulated
data</p>
</dd>
</dl>



<h3>Details</h3>

<p>This function simulates data with the following survival function:
F(t1,t2,t3) = [F(t1,0,0)^(-theta) + F(0,t2,0)^(-theta) +
F(0,0,t3) - 2]^(-1/theta)
(The survival function is defined to be equal to 0 if this
quantity is negative.) The marginal survival functions F(t1,0,0),
F(0,t2,0), and F(0,0,t3) are exponentially distributed with rate
parameter 1. After generating survival times Y1, Y2, and Y3 (of
length n) under this distribution, censoring times C1, C2, and C3 (also
of length n) are generated. C1/C2/C3 are generated under an exponential
distribution with rate parameters lambdaC1, lambdaC2, lambdaC3,
respectively. If C1[i]&lt;Y1[i] for a given observation i, then
observation i is considered to be censored (i.e., Delta1[i]=0).
Delta2 and Delta3 are defined in a similar manner. If lambdaC1,
lambdaC2, and/or lambdaC3 is equal to 0, then the corresponding
variable is uncensored (meaning that Delta[i]=1 for all i).
</p>


<h3>References</h3>

<p>Clayton, D. &quot;Model for association in bivariate life tables and its
application in epidemiological studies of familial tendency in chronic
disease incidence.&quot;, Biometrika (1978) 65:141-151.
Prentice, R., Zhao, S. &quot;The statistical analysis of multivariate
failure time data: A marginal modeling approach&quot;, CRC Press (2019).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- genClayton3(200, 0, 0.5, 0.5, 0.5)
</code></pre>

<hr>
<h2 id='genClaytonReg'>Generates regression data from a bivariate Clayton-Oakes model</h2><span id='topic+genClaytonReg'></span>

<h3>Description</h3>

<p>Generates simulated survival data from a bivariate Clayton-Oakes model
where the hazard depends on a binary coefficient X. This can be used to
create example data for bivariate Cox regression. The marginal
distributions are exponential with given rate parameters. The joint
distribution is defined using a Clayton copula. The censoring times are
also exponentially distributed with given rate parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>genClaytonReg(
  n,
  theta,
  Xp,
  lambda10,
  lambda01,
  b10,
  b01,
  b11,
  lambdaC1,
  lambdaC2
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="genClaytonReg_+3A_n">n</code></td>
<td>
<p>Sample size for the simulated data set.</p>
</td></tr>
<tr><td><code id="genClaytonReg_+3A_theta">theta</code></td>
<td>
<p>Parameter for the Clayton copula. Must be -1 or larger.</p>
</td></tr>
<tr><td><code id="genClaytonReg_+3A_xp">Xp</code></td>
<td>
<p>Probability that the covariate is equal to 1. Must satisfy
0&lt;Xp&lt;1.</p>
</td></tr>
<tr><td><code id="genClaytonReg_+3A_lambda10">lambda10</code>, <code id="genClaytonReg_+3A_lambda01">lambda01</code></td>
<td>
<p>Rate parameters for the (marginal) exponential
distributions when X=0.</p>
</td></tr>
<tr><td><code id="genClaytonReg_+3A_b10">b10</code>, <code id="genClaytonReg_+3A_b01">b01</code>, <code id="genClaytonReg_+3A_b11">b11</code></td>
<td>
<p>Regression coefficient values.</p>
</td></tr>
<tr><td><code id="genClaytonReg_+3A_lambdac1">lambdaC1</code>, <code id="genClaytonReg_+3A_lambdac2">lambdaC2</code></td>
<td>
<p>Rate parameters for the censoring times. No
censoring occurs if this parameter is equal to 0.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing the following elements:
</p>

<dl>
<dt>Y1, Y2:</dt><dd><p>Survival times for the simulated data</p>
</dd>
<dt>Delta1, Delta2:</dt><dd><p>Censoring indicators for the simulated data</p>
</dd>
</dl>

<table>
<tr><td><code>X</code></td>
<td>
<p>Covariate matrix (of dimension n x 1).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function simulates data with the following survival function:
F(t1,t2) = [F(t1,0)^(-eta) + F(0,t2)^(-eta) - 1]^(-1/eta)
(The survival function is defined to be equal to 0 if this
quantity is negative.) Here eta=theta<em>exp(X</em>b11). The marginal
survival functions F(t1,0) and F(0,t2) are exponentially distributed
with rate parameters lambda10<em>exp(X</em>b10) and lambda01<em>exp(X</em>b01),
respectively. After generating survival times Y1 and Y2 (of
length n) under this distribution, censoring times C1 and C2 (also of
length n) are generated. C1/C2 are generated under an exponential
distribution with rate parameters lambdaC1 and lambdaC2. If
C1[i]&lt;Y1[i] for a given observation i, then observation i is
considered to be censored (i.e., Delta1[i]=0). Delta2 is defined in
a similar manner. If lambdaC1 or lambdaC2 is equal to 0, then the
corresponding variable is uncensored (meaning that Delta[i]=1 for
all i).
</p>


<h3>References</h3>

<p>Clayton, D. &quot;Model for association in bivariate life tables and its
application in epidemiological studies of familial tendency in chronic
disease incidence.&quot;, Biometrika (1978) 65:141-151.
Prentice, R., Zhao, S. &quot;The statistical analysis of multivariate
failure time data: A marginal modeling approach&quot;, CRC Press (2019).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- genClaytonReg(1000, 2, 0.5, 1, 1, log(2), log(2), log(8/3), 2, 2)
</code></pre>

<hr>
<h2 id='mHR2'>Cox regression for a bivariate outcome</h2><span id='topic+mHR2'></span>

<h3>Description</h3>

<p>Fits a semiparametric Cox regression model for a bivariate
outcome. This function computes the regression coefficients,
baseline hazards, and sandwich estimates of the standard
deviation of the regression coefficients. If desired, estimates
of the survival function F and marginal hazard rates Lambda11
can be computed using the mHR2.LF function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mHR2(Y1, Y2, Delta1, Delta2, X)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mHR2_+3A_y1">Y1</code>, <code id="mHR2_+3A_y2">Y2</code></td>
<td>
<p>Vectors of event times (continuous).</p>
</td></tr>
<tr><td><code id="mHR2_+3A_delta1">Delta1</code>, <code id="mHR2_+3A_delta2">Delta2</code></td>
<td>
<p>Vectors of censoring indicators (1=event,
0=censored).</p>
</td></tr>
<tr><td><code id="mHR2_+3A_x">X</code></td>
<td>
<p>Matrix of covariates (continuous or binary).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following elements:
</p>

<dl>
<dt>Y1, Y2:</dt><dd><p>Original vectors of event times</p>
</dd>
<dt>Delta1, Delta2:</dt><dd><p>Original vectors of censoring indicators</p>
</dd>
<dt>X:</dt><dd><p>Original covariate matrix</p>
</dd>
<dt>n10, n01:</dt><dd><p>Total number of events for the first/second outcome</p>
</dd>
<dt>n11:</dt><dd><p>Total number of double events</p>
</dd>
<dt>beta10, beta01, beta11:</dt><dd><p>Regression coefficient estimates</p>
</dd>
<dt>lambda10, lambda01, lambda11:</dt><dd><p>Baseline hazard estimates</p>
</dd>
<dt>SD.beta10, SD.beta01, SD.beta11:</dt><dd><p>Sandwich estimates of the
standard deviation of the regression coefficients</p>
</dd>
<dt>SD.beta10.cox, SD.beta01.cox:</dt><dd><p>Standard deviation estimates
for the regression coefficients based on a univariate Cox model</p>
</dd>
</dl>



<h3>References</h3>

<p>Prentice, R., Zhao, S. &quot;The statistical analysis of multivariate
failure time data: A marginal modeling approach&quot;, CRC Press (2019).
Prentice, R., Zhao, S. &quot;Regression models and multivariate life tables&quot;,
Journal of the American Statistical Association (2021) 116(535):
1330-1345. https://doi.org/10.1080/01621459.2020.1713792
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mHR2.LF">mHR2.LF</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- genClaytonReg(1000, 2, 0.5, 1, 1, log(2), log(2), log(8/3), 2, 2)
x.mHR2 &lt;- mHR2(x$Y1, x$Y2, x$Delta1, x$Delta2, x$X)
</code></pre>

<hr>
<h2 id='mHR2.LF'>Bivariate regression survival function and marginal hazards estimation</h2><span id='topic+mHR2.LF'></span>

<h3>Description</h3>

<p>Estimates the survival function F and the marginal hazards Lambda11
for a bivariate Cox regression model. F and Lambda11 are estimated
at two specified values of the covariates. If desired, (bootstrap)
confidence intervals or confidence bounds for F and Lambda11 may also
be computed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mHR2.LF(
  mHR2.obj,
  X0_out,
  X1_out,
  T1_out,
  T2_out,
  confidence = c("none", "CI", "CB"),
  n.boot = 100
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mHR2.LF_+3A_mhr2.obj">mHR2.obj</code></td>
<td>
<p>Output from the mHR2 function.</p>
</td></tr>
<tr><td><code id="mHR2.LF_+3A_x0_out">X0_out</code>, <code id="mHR2.LF_+3A_x1_out">X1_out</code></td>
<td>
<p>Two possible sets of values for the covariates.
F and Lambda will be estimated at X=X0_out and X=X1_out.</p>
</td></tr>
<tr><td><code id="mHR2.LF_+3A_t1_out">T1_out</code>, <code id="mHR2.LF_+3A_t2_out">T2_out</code></td>
<td>
<p>Vector of time points at which F and Lambda11
should be estimated. If confidence=&quot;CB&quot;, then both vectors must
have length 3.</p>
</td></tr>
<tr><td><code id="mHR2.LF_+3A_confidence">confidence</code></td>
<td>
<p>Type of confidence estimate to be computed.
Possible values include &quot;none&quot;, &quot;CI&quot; (to compute confidence
intervals), and &quot;CB&quot; (to compute confidence bands). Defaults to
&quot;none&quot;.</p>
</td></tr>
<tr><td><code id="mHR2.LF_+3A_n.boot">n.boot</code></td>
<td>
<p>Number of bootstrap iterations for computing the
confidence intervals/bands. Defaults to 100. Ignored if
confidence=&quot;none&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following elements:
</p>

<dl>
<dt>n10, n01:</dt><dd><p>Total number of events for the first/second outcome</p>
</dd>
<dt>n11:</dt><dd><p>Total number of double events</p>
</dd>
<dt>beta10, beta01, beta11:</dt><dd><p>Regression coefficient estimates</p>
</dd>
<dt>lambda10, lambda01, lambda11:</dt><dd><p>Baseline hazard estimates</p>
</dd>
<dt>Lambda11_out_Z0, Lambda11_out_Z1:</dt><dd><p>Estimates of Lambda11 at
T1_out, T2_out for X=X0_out and X=X1_out</p>
</dd>
<dt>F_out_X0, F_out_X1:</dt><dd><p>Estimates of F at T1_out, T2_out for
X=X0_out and X=X1_out</p>
</dd>
<dt>CI_Lambda11_X0.lb, CI_Lambda11_X0.ub:</dt><dd><p>Lower and upper bounds
for Lambda11 at X=X0_out</p>
</dd>
<dt>CI_Lambda11_X1.lb, CI_Lambda11_X1.ub:</dt><dd><p>Lower and upper bounds
for Lambda11 at X=X1_out</p>
</dd>
<dt>CI_F_X0.lb, CI_F_X0.ub:</dt><dd><p>Lower and upper bounds for F at
X=X0_out</p>
</dd>
<dt>CI_F_X1.lb, CI_F_X1.ub:</dt><dd><p>Lower and upper bounds for F at
X=X1_out</p>
</dd>
<dt>CB1_Lambda11_X0.lb, CB1_Lambda11_X0.ub, CB2_Lambda11_X0.lb,
CB2_Lambda11_X0.ub, CB3_Lambda11_X0.lb, CB3_Lambda11_X0.ub:</dt><dd><p>Lower
and upper bounds for Lambda11 at X=X0_out, at three T1_out, T2_out
combinations</p>
</dd>
<dt>CB1_Lambda11_X1.lb, CB1_Lambda11_X1.ub, CB2_Lambda11_X1.lb,
CB2_Lambda11_X1.ub, CB3_Lambda11_X1.lb, CB3_Lambda11_X1.ub:</dt><dd><p>Lower
and upper bounds for Lambda11 at X=X1_out, at three T1_out, T2_out
combinations</p>
</dd>
<dt>CB1_F_X0.lb, CB1_F_X0.ub, CB2_F_X0.lb, CB2_F_X0.ub, CB3_F_X0.lb,
CB3_F_X0.ub:</dt><dd><p>Lower and upper bounds for F at X=X0_out, at three
T1_out, T2_out combinations</p>
</dd>
<dt>CB1_F_X1.lb, CB1_F_X1.ub, CB2_F_X1.lb, CB2_F_X1.ub, CB3_F_X1.lb,
CB3_F_X1.ub:</dt><dd><p>Lower and upper bounds for F at X=X1_out, at three
T1_out, T2_out combinations</p>
</dd>
</dl>



<h3>Details</h3>

<p>If confidence=&quot;CI&quot; or confidence=&quot;CB&quot;, then 95% bootstrap confidence
bounds are computed by estimating the standard errors of F/Lambda11
based on n.boot bootstrap iterations. Currently confidence bounds
can only be computed at three specified T1out/T2out combinations
(meaning that T1out and T2out must both have length 3 if
confidence=&quot;CB&quot;). No confidence measures will be returned if
confidence=&quot;none&quot;.
</p>


<h3>References</h3>

<p>Prentice, R., Zhao, S. &quot;The statistical analysis of multivariate
failure time data: A marginal modeling approach&quot;, CRC Press (2019).
Prentice, R., Zhao, S. &quot;Regression models and multivariate life tables&quot;,
Journal of the American Statistical Association (2020) In press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mHR2">mHR2</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- genClaytonReg(50, 2, 0.5, 1, 1, log(2), log(2), log(8/3), 2, 2)
x.mHR2 &lt;- mHR2(x$Y1, x$Y2, x$Delta1, x$Delta2, x$X)
x.LF &lt;- mHR2.LF(x.mHR2, 0, 1, c(0.25, 0.5, 1), c(0.25, 0.5, 1))
x.LF.CI &lt;- mHR2.LF(x.mHR2, 0, 1, c(0.25, 0.5, 1),
c(0.25, 0.5, 1), confidence="CI")
x.LF.CB &lt;- mHR2.LF(x.mHR2, 0, 1, c(0.25, 0.5, 1),
c(0.25, 0.5, 1), confidence="CB")
</code></pre>

<hr>
<h2 id='mHR2.tvc'>Cox regression for a bivariate outcome with time-varying covariates</h2><span id='topic+mHR2.tvc'></span>

<h3>Description</h3>

<p>Fits a semiparametric Cox regression model for a bivariate
outcome with time-varying covariates. Currently only the regression
coefficients are computed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mHR2.tvc(Y1, Y2, Delta1, Delta2, ids, X)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mHR2.tvc_+3A_y1">Y1</code>, <code id="mHR2.tvc_+3A_y2">Y2</code></td>
<td>
<p>Vectors of event times (continuous).</p>
</td></tr>
<tr><td><code id="mHR2.tvc_+3A_delta1">Delta1</code>, <code id="mHR2.tvc_+3A_delta2">Delta2</code></td>
<td>
<p>Vectors of censoring indicators (1=event,
0=censored).</p>
</td></tr>
<tr><td><code id="mHR2.tvc_+3A_ids">ids</code></td>
<td>
<p>Vector of ID numbers. It is used to map the values of
the time-varying covariates back to the original
Y1/Y2/Delta1/Delta2 values. See Details.</p>
</td></tr>
<tr><td><code id="mHR2.tvc_+3A_x">X</code></td>
<td>
<p>Matrix of covariates (continuous or binary). See Details
for the proper format of this matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following elements:
</p>

<dl>
<dt>beta10, beta01, beta11:</dt><dd><p>Regression coefficient estimates</p>
</dd>
</dl>



<h3>Details</h3>

<p>X must be a matrix with at least four columns. The first column
contains the ID numbers. Each ID number in this column must map
to a unique element of the ids vector. The second and third columns
consists of time points for T1 and T2, respectively. They specify
the time points at which the covariates take on the specified
value(s). The remaining columns represent the values
of the covariates on the specified time interval. For example,
if we define
X.tv &lt;- matrix(c(1001, 1001, 0, 0, 0, 5, 1, 2), nrow=2)
then, for the observation with ID number 1001, then when T1=0, the
time-varying covariate has a value of 1 on when T2 is in [0,5) and a
value of 2 when T2 is in [5,Inf). Note that the values of the
time-varying covariates must be specified for when T1=0 (or T2=0)
in order to compute beta10 and beta01. If a value of a covariate is
constant when T1=0 or T2=0, that covariate will be dropped when
computing beta10 or beta01.
</p>
<p>Support for time-varying covariates is experimental and has not
been tested extensively. Use this function at your own risk.
</p>


<h3>References</h3>

<p>Prentice, R., Zhao, S. &quot;The statistical analysis of multivariate
failure time data: A marginal modeling approach&quot;, CRC Press (2019).
Prentice, R., Zhao, S. &quot;Regression models and multivariate life tables&quot;,
Journal of the American Statistical Association (2021) 116(535):
1330-1345. https://doi.org/10.1080/01621459.2020.1713792
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mHR2">mHR2</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- genClaytonReg(50, 2, 0.5, 1, 1, 0, log(2), 0, 5, 5)
x.tv &lt;- tvc.example(x$Y1, x$Y2, x$Delta1, x$Delta2, x$X)
x.mHR2 &lt;- mHR2.tvc(x$Y1, x$Y2, x$Delta1, x$Delta2,
x.tv$ids, x.tv$X.tv)
</code></pre>

<hr>
<h2 id='npSurv2'>Nonparametric estimates of the survival function for bivariate failure
time data</h2><span id='topic+npSurv2'></span>

<h3>Description</h3>

<p>Computes the survival function for bivariate failure time data using one
of three possible estimators, including Dabrowska, Volterra and
Prentice-Cai estimators. Optionally (bootstrap) confidence intervals for
the survival function may also be computed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>npSurv2(
  Y1,
  Y2,
  Delta1,
  Delta2,
  newT1 = NULL,
  newT2 = NULL,
  estimator = c("dabrowska", "volterra", "prentice-cai"),
  conf.int = FALSE,
  R = 1000,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="npSurv2_+3A_y1">Y1</code>, <code id="npSurv2_+3A_y2">Y2</code></td>
<td>
<p>Vectors of event times (continuous).</p>
</td></tr>
<tr><td><code id="npSurv2_+3A_delta1">Delta1</code>, <code id="npSurv2_+3A_delta2">Delta2</code></td>
<td>
<p>Vectors of censoring indicators (1=event,
0=censored).</p>
</td></tr>
<tr><td><code id="npSurv2_+3A_newt1">newT1</code>, <code id="npSurv2_+3A_newt2">newT2</code></td>
<td>
<p>Optional vectors of times at which to estimate
the survival function (which do not need to be subsets of Y1/Y2).
Defaults to the unique values in Y1/Y2 if not specified.</p>
</td></tr>
<tr><td><code id="npSurv2_+3A_estimator">estimator</code></td>
<td>
<p>Which estimator of the survival function should be used.
Possible values include &quot;dabrowska&quot;, &quot;volterra&quot;, and &quot;prentice-cai&quot;.
Defaults to &quot;dabrowska&quot;.</p>
</td></tr>
<tr><td><code id="npSurv2_+3A_conf.int">conf.int</code></td>
<td>
<p>Should bootstrap confidence intervals be computed?</p>
</td></tr>
<tr><td><code id="npSurv2_+3A_r">R</code></td>
<td>
<p>Number of bootstrap replicates. This argument is passed to the
boot function. Defaults to 1000. Ignored if conf.int is FALSE.</p>
</td></tr>
<tr><td><code id="npSurv2_+3A_...">...</code></td>
<td>
<p>Additional arguments to the boot function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following elements:
</p>

<dl>
<dt>T1:</dt><dd><p>Unique uncensored Y1 values</p>
</dd>
<dt>T2:</dt><dd><p>Unique uncensored Y2 values</p>
</dd>
<dt>Fhat:</dt><dd><p>Estimated bivariate survival function (computed at T1, T2)</p>
</dd>
<dt>Fhat.lci:</dt><dd><p>Lower 95% confidence bounds for Fhat</p>
</dd>
<dt>Fhat.uci:</dt><dd><p>Upper 95% confidence bounds for Fhat</p>
</dd>
<dt>Fmarg1.est:</dt><dd><p>Estimated marginal survival function for T1
(computed at newT1)</p>
</dd>
<dt>Fmarg1.lci:</dt><dd><p>Lower 95% confidence bounds for Fmarg1</p>
</dd>
<dt>Fmarg1.uci:</dt><dd><p>Upper 95% confidence bounds for Fmarg1</p>
</dd>
<dt>Fmarg2.est:</dt><dd><p>Estimated marginal survival function for T2
(computed at newT2)</p>
</dd>
<dt>Fmarg2.lci:</dt><dd><p>Lower 95% confidence bounds for Fmarg2</p>
</dd>
<dt>Fmarg2.uci:</dt><dd><p>Upper 95% confidence bounds for Fmarg2</p>
</dd>
<dt>F.est:</dt><dd><p>Estimated survival function (computed at newT1, newT2)</p>
</dd>
<dt>F.est.lci:</dt><dd><p>Lower 95% confidence bounds for F.est</p>
</dd>
<dt>F.est.uci:</dt><dd><p>Upper 95% confidence bounds for F.est</p>
</dd>
<dt>CR:</dt><dd><p>Estimated cross ratio (computed at T1, T2)</p>
</dd>
<dt>KT:</dt><dd><p>Estimated Kendall\'s tau (computed at T1, T2)</p>
</dd>
<dt>CR.est:</dt><dd><p>Estimated cross ratio (computed at newT1, newT2)</p>
</dd>
<dt>KT.est:</dt><dd><p>Estimated Kendall\'s tau (computed at newT1, newT2)</p>
</dd>
</dl>



<h3>Details</h3>

<p>If conf.int is TRUE, confidence intervals will be computed using the
boot function in the boot package. Currently only 95% confidence
intervals computed using the percentile method are implemented. If
conf.int is FALSE, confidence intervals will not be computed, and
confidence bounds will not be returned in the output.
</p>


<h3>References</h3>

<p>Prentice, R., Zhao, S. &quot;Nonparametric estimation of the multivariate
survivor function: the multivariate Kaplan–Meier estimator&quot;, Lifetime
Data Analysis (2018) 24:3-27.
Prentice, R., Zhao, S. &quot;The statistical analysis of multivariate
failure time data: A marginal modeling approach&quot;, CRC Press (2019).
pp. 52-60.
</p>


<h3>See Also</h3>

<p><code><a href="boot.html#topic+boot">boot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- genClayton2(100, 0, 1, 1, 2, 2)
x.npSurv2 &lt;- npSurv2(x$Y1, x$Y2, x$Delta1, x$Delta2)
x.npSurv2.ci &lt;- npSurv2(x$Y1, x$Y2, x$Delta1, x$Delta2,
conf.int=TRUE)
x.npSurv2.volt &lt;- npSurv2(x$Y1, x$Y2, x$Delta1, x$Delta2,
estimator="volterra")
x.npSurv2.t &lt;- npSurv2(x$Y1, x$Y2, x$Delta1, x$Delta2,
newT1=-1*log(c(0.55, 0.7, 0.7, 0.85, 0.85, 0.85)),
newT2=-1*log(c(0.55, 0.55, 0.7, 0.55, 0.7, 0.85)))
</code></pre>

<hr>
<h2 id='npSurv3'>Nonparametric estimates of the survival function for trivariate failure
time data</h2><span id='topic+npSurv3'></span>

<h3>Description</h3>

<p>Computes the survival function for a trivariate failure time data. The
survival function for trivariate failure time data is analogous to the
Kaplan-Meier estimator for a univariate failure time data and Dabrowska
estimator for bivariate failure time data. Optionally (bootstrap)
confidence intervals for the survival function may also be computed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>npSurv3(
  Y1,
  Y2,
  Y3,
  Delta1,
  Delta2,
  Delta3,
  newT1 = NULL,
  newT2 = NULL,
  newT3 = NULL,
  conf.int = FALSE,
  R = 1000,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="npSurv3_+3A_y1">Y1</code>, <code id="npSurv3_+3A_y2">Y2</code>, <code id="npSurv3_+3A_y3">Y3</code></td>
<td>
<p>Vectors of event times (continuous).</p>
</td></tr>
<tr><td><code id="npSurv3_+3A_delta1">Delta1</code>, <code id="npSurv3_+3A_delta2">Delta2</code>, <code id="npSurv3_+3A_delta3">Delta3</code></td>
<td>
<p>Vectors of censoring indicators (1=event,
0=censored).</p>
</td></tr>
<tr><td><code id="npSurv3_+3A_newt1">newT1</code>, <code id="npSurv3_+3A_newt2">newT2</code>, <code id="npSurv3_+3A_newt3">newT3</code></td>
<td>
<p>Optional vectors of times at which to estimate
the survival function (which do not need to be subsets of Y1/Y2/Y3).
Defaults to the unique values in Y1/Y2/Y3 if not specified.</p>
</td></tr>
<tr><td><code id="npSurv3_+3A_conf.int">conf.int</code></td>
<td>
<p>Should bootstrap confidence intervals be computed?</p>
</td></tr>
<tr><td><code id="npSurv3_+3A_r">R</code></td>
<td>
<p>Number of bootstrap replicates. This argument is passed to the
boot function. Defaults to 1000. Ignored if conf.int is FALSE.</p>
</td></tr>
<tr><td><code id="npSurv3_+3A_...">...</code></td>
<td>
<p>Additional arguments to the boot function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following elements:
</p>

<dl>
<dt>T1:</dt><dd><p>Unique values of Y1 at which Fhat was computed</p>
</dd>
<dt>T2:</dt><dd><p>Unique values of Y2 at which Fhat was computed</p>
</dd>
<dt>T3:</dt><dd><p>Unique values of Y3 at which Fhat was computed</p>
</dd>
<dt>Fhat:</dt><dd><p>Estimated survival function (computed at T1, T2, T3)</p>
</dd>
<dt>Fhat.lci:</dt><dd><p>Lower 95% confidence bounds for Fhat</p>
</dd>
<dt>Fhat.uci:</dt><dd><p>Upper 95% confidence bounds for Fhat</p>
</dd>
<dt>Fmarg1.est:</dt><dd><p>Estimated marginal survival function for T11
(computed at newT1)</p>
</dd>
<dt>Fmarg1.lci:</dt><dd><p>Lower 95% confidence bounds for Fmarg1</p>
</dd>
<dt>Fmarg1.uci:</dt><dd><p>Upper 95% confidence bounds for Fmarg1</p>
</dd>
<dt>Fmarg2.est:</dt><dd><p>Estimated marginal survival function for T2
(computed at newT2)</p>
</dd>
<dt>Fmarg2.lci:</dt><dd><p>Lower 95% confidence bounds for Fmarg2</p>
</dd>
<dt>Fmarg2.uci:</dt><dd><p>Upper 95% confidence bounds for Fmarg2</p>
</dd>
<dt>Fmarg3.est:</dt><dd><p>Estimated marginal survival function for T3
(computed at newT3)</p>
</dd>
<dt>Fmarg3.lci:</dt><dd><p>Lower 95% confidence bounds for Fmarg3</p>
</dd>
<dt>Fmarg3.uci:</dt><dd><p>Upper 95% confidence bounds for Fmarg3</p>
</dd>
<dt>F.est:</dt><dd><p>Estimated survival function (computed at newT1, newT2,
newT3)</p>
</dd>
<dt>F.est.lci:</dt><dd><p>Lower 95% confidence bounds for F.est</p>
</dd>
<dt>F.est.uci:</dt><dd><p>Upper 95% confidence bounds for F.est</p>
</dd>
<dt>C110:</dt><dd><p>Pairwise marginal cross ratio estimator C110 (computed at
newT1, newT2, newT3)</p>
</dd>
<dt>C101:</dt><dd><p>Pairwise marginal cross ratio estimator C101 (computed at
newT1, newT2, newT3)</p>
</dd>
<dt>C011:</dt><dd><p>Pairwise marginal cross ratio estimator C011 (computed at
new T1, newT2, newT3)</p>
</dd>
<dt>C111:</dt><dd><p>Trivariate dependency estimator C111 (computed at newT1,
newT2, newT3)</p>
</dd>
</dl>



<h3>Details</h3>

<p>If conf.int is TRUE, confidence intervals will be computed using the
boot function in the boot package. Currently only 95% confidence
intervals computed using the percentile method are implemented. If
conf.int is FALSE, confidence intervals will not be computed, and
confidence bounds will not be returned in the output.
</p>


<h3>References</h3>

<p>Prentice, R., Zhao, S. &quot;Nonparametric estimation of the multivariate
survivor function: the multivariate Kaplan–Meier estimator&quot;, Lifetime
Data Analysis (2018) 24:3-27.
Prentice, R., Zhao, S. &quot;The statistical analysis of multivariate
failure time data: A marginal modeling approach&quot;, CRC Press (2019).
pp. 120-123.
</p>


<h3>See Also</h3>

<p><code><a href="boot.html#topic+boot">boot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- genClayton3(25, 0, 0.5, 0.5, 0.5)
x.npSurv3 &lt;- npSurv3(x$Y1, x$Y2, x$Y3, x$Delta1, x$Delta2, x$Delta3)
x.npSurv3.ci &lt;- npSurv3(x$Y1, x$Y2, x$Y3, x$Delta1, x$Delta2,
x$Delta3, conf.int=TRUE, R=500)
</code></pre>

<hr>
<h2 id='plotnpSurv2.3D'>Uses a 3D perspective plot to visualize a nonparametric bivariate
survival function</h2><span id='topic+plotnpSurv2.3D'></span>

<h3>Description</h3>

<p>Plots a 3D perspective plot of an estimated nonparametric bivariate
survival function. This function is a wrapper for the persp3D function
from the plot3D package with default parameters chosen to make the
data easier to visualize.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotnpSurv2.3D(
  npSurv2.obj,
  col = "grey",
  shade = 0.25,
  theta = 120,
  xlab = "T1",
  ylab = "T2",
  zlab = "Fhat",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotnpSurv2.3D_+3A_npsurv2.obj">npSurv2.obj</code></td>
<td>
<p>Output of the npSurv2 function.</p>
</td></tr>
<tr><td><code id="plotnpSurv2.3D_+3A_col">col</code></td>
<td>
<p>Color palette to be used for the plot. Defaults to &quot;grey&quot;.
See persp3D.</p>
</td></tr>
<tr><td><code id="plotnpSurv2.3D_+3A_shade">shade</code></td>
<td>
<p>The degree of shading of the surface facets. Defaults to
0.25. See persp.</p>
</td></tr>
<tr><td><code id="plotnpSurv2.3D_+3A_theta">theta</code></td>
<td>
<p>The azimuthal viewing direction. See persp.</p>
</td></tr>
<tr><td><code id="plotnpSurv2.3D_+3A_xlab">xlab</code></td>
<td>
<p>The x-axis label. Defaults to &quot;T1&quot;.</p>
</td></tr>
<tr><td><code id="plotnpSurv2.3D_+3A_ylab">ylab</code></td>
<td>
<p>The y-axis label. Defaults to &quot;T2&quot;.</p>
</td></tr>
<tr><td><code id="plotnpSurv2.3D_+3A_zlab">zlab</code></td>
<td>
<p>The z-axis label. Defaults to &quot;Fhat&quot;.</p>
</td></tr>
<tr><td><code id="plotnpSurv2.3D_+3A_...">...</code></td>
<td>
<p>Additional parameters to the persp3D function.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+npSurv2">npSurv2</a></code>, <code><a href="plot3D.html#topic+persp3D">persp3D</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- genClayton2(100, 0, 1, 1, 2, 2)
x.npSurv2 &lt;- npSurv2(x$Y1, x$Y2, x$Delta1, x$Delta2)
plotnpSurv2.3D(x.npSurv2)

x2 &lt;- genClayton2(100, 2, 1, 1, 2, 2)
x2.npSurv2 &lt;- npSurv2(x2$Y1, x2$Y2, x2$Delta1, x2$Delta2)
plotnpSurv2.3D(x2.npSurv2)
</code></pre>

<hr>
<h2 id='plotnpSurv2.HM'>Uses a heat map to visualize a nonparametric bivariate survival function</h2><span id='topic+plotnpSurv2.HM'></span>

<h3>Description</h3>

<p>Plots a heat map of an estimated nonparametric bivariate survival
function. This function is a wrapper for the image function with default
parameters chosen to make the data easier to visualize.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotnpSurv2.HM(
  npSurv2.obj,
  contour = TRUE,
  col = terrain.colors(100),
  xlab = "T1",
  ylab = "T2",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotnpSurv2.HM_+3A_npsurv2.obj">npSurv2.obj</code></td>
<td>
<p>Output of the npSurv2 function.</p>
</td></tr>
<tr><td><code id="plotnpSurv2.HM_+3A_contour">contour</code></td>
<td>
<p>Should contour lines be added to the plot? Defaults to
TRUE.</p>
</td></tr>
<tr><td><code id="plotnpSurv2.HM_+3A_col">col</code></td>
<td>
<p>List of colors for the heat map. Defaults to
terrain.colors(100).</p>
</td></tr>
<tr><td><code id="plotnpSurv2.HM_+3A_xlab">xlab</code></td>
<td>
<p>The x-axis label. Defaults to &quot;T1&quot;.</p>
</td></tr>
<tr><td><code id="plotnpSurv2.HM_+3A_ylab">ylab</code></td>
<td>
<p>The y-axis label. Defaults to &quot;T2&quot;.</p>
</td></tr>
<tr><td><code id="plotnpSurv2.HM_+3A_...">...</code></td>
<td>
<p>Additional parameters to the image function.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+npSurv2">npSurv2</a></code>, <code><a href="graphics.html#topic+image">image</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- genClayton2(1000, 0, 1, 1, 2, 2)
x.npSurv2 &lt;- npSurv2(x$Y1, x$Y2, x$Delta1, x$Delta2)
plotnpSurv2.HM(x.npSurv2)

x2 &lt;- genClayton2(1000, 2, 1, 1, 2, 2)
x2.npSurv2 &lt;- npSurv2(x2$Y1, x2$Y2, x2$Delta1, x2$Delta2)
plotnpSurv2.HM(x2.npSurv2)
</code></pre>

<hr>
<h2 id='tvc.example'>Creates an example of a matrix of time-varying covariates</h2><span id='topic+tvc.example'></span>

<h3>Description</h3>

<p>Given a set of (non-time-varying) covariates, creates a simple example
of a matrix of time-varying covariates that can be used as input data
for the mHR2.tvc function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tvc.example(Y1, Y2, Delta1, Delta2, X)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tvc.example_+3A_y1">Y1</code>, <code id="tvc.example_+3A_y2">Y2</code></td>
<td>
<p>Vectors of event times (continuous).</p>
</td></tr>
<tr><td><code id="tvc.example_+3A_delta1">Delta1</code>, <code id="tvc.example_+3A_delta2">Delta2</code></td>
<td>
<p>Vectors of censoring indicators (1=event,
0=censored).</p>
</td></tr>
<tr><td><code id="tvc.example_+3A_x">X</code></td>
<td>
<p>Matrix of covariates (continuous or binary).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following elements:
</p>

<dl>
<dt>ids:</dt><dd><p>A vector of ids</p>
</dd>
<dt>X.tv:</dt><dd><p>Time-varying covariate matrix</p>
</dd>
</dl>



<h3>Details</h3>

<p>For each (non-time-varying) covariate in X, two time-varying
covariates are created. The first time-varying covariate is equal to
X<em>log(T1), and the second is equal to X</em>log(T2). (If T=0, then the
time-varying covariate is set to be 0.) A vector of ID numbers and a
matrix of time-varying covariates are created in a format that can be
passed to the mHR2.tvc function.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mHR2">mHR2</a></code>, <code><a href="#topic+genClaytonReg">genClaytonReg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- genClaytonReg(250, 2, 0.5, 1, 1, 0, log(2), 0, 5, 5)
x.tv &lt;- tvc.example(x$Y1, x$Y2, x$Delta1, x$Delta2, x$X)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
