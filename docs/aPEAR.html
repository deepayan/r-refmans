<!DOCTYPE html><html><head><title>Help for package aPEAR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {aPEAR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#aPEAR-package'><p>aPEAR: Advanced Pathway Enrichment Analysis Representation</p></a></li>
<li><a href='#aPEAR.methods'><p>Default method configuration for aPEAR</p></a></li>
<li><a href='#aPEAR.theme'><p>Default theme configuration for aPEAR</p></a></li>
<li><a href='#enrichmentNetwork'><p>aPEAR enrichment network</p></a></li>
<li><a href='#findPathClusters'><p>Find pathway clusters</p></a></li>
<li><a href='#plotPathClusters'><p>aPEAR enrichment network</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Advanced Pathway Enrichment Analysis Representation</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Simplify pathway enrichment analysis results by detecting clusters
    of similar pathways and visualizing it as an enrichment network, where
    nodes and edges describe the pathways and similarity between them,
    respectively. This reduces the redundancy of the overlapping pathways and
    helps to notice the most important biological themes in the data
    (Kerseviciute and Gordevicius (2023) &lt;<a href="https://doi.org/10.1101%2F2023.03.28.534514">doi:10.1101/2023.03.28.534514</a>&gt;).</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://gitlab.com/vugene/aPEAR">https://gitlab.com/vugene/aPEAR</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://gitlab.com/vugene/aPEAR/-/issues">https://gitlab.com/vugene/aPEAR/-/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Suggests:</td>
<td>Spectrum, clusterProfiler, gprofiler2, DOSE, org.Hs.eg.db,
testthat (&ge; 3.0.0), knitr, rmarkdown, stringr</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Imports:</td>
<td>arules, bayesbio, data.table, dplyr, igraph, lsa, MCL,
reshape2, tibble, utils, stats, methods, ggplot2, ggrepel,
ggforce</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-06-12 08:01:24 UTC; ieva</td>
</tr>
<tr>
<td>Author:</td>
<td>Ieva Kerseviciute <a href="https://orcid.org/0000-0002-9353-038X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Juozas Gordevicius
    <a href="https://orcid.org/0000-0003-3190-6721"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ths],
  VUGENE, LLC [cph, fnd]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ieva Kerseviciute &lt;kerseviciute.ieva@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-06-12 18:10:13 UTC</td>
</tr>
</table>
<hr>
<h2 id='aPEAR-package'>aPEAR: Advanced Pathway Enrichment Analysis Representation</h2><span id='topic+aPEAR'></span><span id='topic+aPEAR-package'></span>

<h3>Description</h3>

<p>Simplify pathway enrichment analysis results by detecting clusters of similar pathways and visualizing it as an enrichment network, where nodes and edges describe the pathways and similarity between them, respectively. This reduces the redundancy of the overlapping pathways and helps to notice the most important biological themes in the data (Kerseviciute and Gordevicius (2023) <a href="https://doi.org/10.1101/2023.03.28.534514">doi:10.1101/2023.03.28.534514</a>).
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Ieva Kerseviciute <a href="mailto:kerseviciute.ieva@gmail.com">kerseviciute.ieva@gmail.com</a> (<a href="https://orcid.org/0000-0002-9353-038X">ORCID</a>)
</p>
<p>Other contributors:
</p>

<ul>
<li><p> Juozas Gordevicius <a href="mailto:juozas@vugene.com">juozas@vugene.com</a> (<a href="https://orcid.org/0000-0003-3190-6721">ORCID</a>) [thesis advisor]
</p>
</li>
<li><p> VUGENE, LLC [copyright holder, funder]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://gitlab.com/vugene/aPEAR">https://gitlab.com/vugene/aPEAR</a>
</p>
</li>
<li><p> Report bugs at <a href="https://gitlab.com/vugene/aPEAR/-/issues">https://gitlab.com/vugene/aPEAR/-/issues</a>
</p>
</li></ul>


<hr>
<h2 id='aPEAR.methods'>Default method configuration for aPEAR</h2><span id='topic+aPEAR.methods'></span>

<h3>Description</h3>

<p>A list with parameters for customizing how the clusters within the enrichment data
are calculated.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aPEAR.methods
</code></pre>


<h3>Format</h3>

<p>An object of class <code>aPEAR.methods.config</code> of length 5.
</p>


<h3>Details</h3>

<p>similarity: method for calculating similarity matrix between the pathways. Available
methods: 'jaccard', 'cosine' and 'correlation'
</p>
<p>cluster: method for detecting pathway clusters. Available methods: 'markov', 'hier'
and 'spectral'. Using 'spectral' method requires that you have the <code>Spectrum</code>
package installed
</p>
<p>clusterName: method for selecting cluster names. Available methods: 'pagerank',
'hits', 'nes' and 'pval'. The 'pagerank' and 'hits' algorithms analyse the connectivity
within the cluster to detect the most important node. The 'nes' and 'pval' methods
use enrichment results to determine the most important node within the cluster: the 'nes'
method will choose the node with the maximum absolute enrichment score value and the
'pval' method will choose the node with the lowest p-value. When using the 'nes' and
'pval' methods, please specify which column in the data to use with the <code>clusterNameColumn</code>
parameter
</p>
<p>clusterNameColumn: which column in the dataset should be used to select the cluster
title. Required when <code>clusterName = 'nes'</code> and <code>clusterName = 'pval'</code>
</p>
<p>minClusterSize: minimum cluster size (default: 2). Clusters with less elements than
specified will be dropped
</p>


<h3>Value</h3>

<p>an object of class aPEAR.methods.config
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Display all default methods used by aPEAR
aPEAR.methods

# Update methods to use different similarity metric
settings &lt;- aPEAR.methods
settings$similarity &lt;- 'cosine'
settings

</code></pre>

<hr>
<h2 id='aPEAR.theme'>Default theme configuration for aPEAR</h2><span id='topic+aPEAR.theme'></span>

<h3>Description</h3>

<p>A list with parameters for customizing the theme of the enrichment network plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aPEAR.theme
</code></pre>


<h3>Format</h3>

<p>An object of class <code>aPEAR.theme.config</code> of length 9.
</p>


<h3>Details</h3>

<p>colorBy: which column in the data should be used to color the nodes in
the enrichment network plot (default: 'NES')
</p>
<p>nodeSize: which column in the data should be used to get the node size for the
enrichment network plot (default: 'setSize')
</p>
<p>innerCutoff: similarity cutoff for within-cluster nodes (default: 0.1). Decreasing
this value results in greater connectivity within the nodes in the same cluster.
For example, innerCutoff = 0 would display all connections within the same cluster.
</p>
<p>outerCutoff: similarity cutoff for between-cluster nodes (default: 0.5). Decreasing
this value results in greater connectivity between the nodes in different clusters.
For example, outerCutoff = 0 would display all connections between different clusters.
</p>
<p>colorType: how to colour the nodes: 'nes' - will center around 0 with blue min and
red max, 'pval' - will use log transform on the colorBy column and adjust color range
(default: 'nes')
</p>
<p>pCutoff: adjust p-value colouring cutoff when using <code>colorType = 'pval'</code> (default: -10)
</p>
<p>drawEllipses: enable / disable ellipse drawing (default: FALSE)
</p>
<p>fontSize: adjust cluster label font size (default: 3)
</p>
<p>repelLabels: whether the cluster label positions should be corrected (default: FALSE)
</p>


<h3>Value</h3>

<p>an object of class aPEAR.theme.config
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Display the default theme configuration used by aPEAR
aPEAR.theme

# Update the theme to draw ellipses
settings &lt;- aPEAR.theme
settings$drawEllipses &lt;- TRUE
settings

</code></pre>

<hr>
<h2 id='enrichmentNetwork'>aPEAR enrichment network</h2><span id='topic+enrichmentNetwork'></span>

<h3>Description</h3>

<p>Creates an enrichment network plot. This function internally calls
<code>findPathClusters</code> to obtain pathway clusters and then <code>plotPathClusters</code>
to create the enrichment network visualization.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>enrichmentNetwork(
  enrichment,
  methods = aPEAR.methods,
  theme = aPEAR.theme,
  verbose = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="enrichmentNetwork_+3A_enrichment">enrichment</code></td>
<td>
<p>a data.frame containing enrichment results</p>
</td></tr>
<tr><td><code id="enrichmentNetwork_+3A_methods">methods</code></td>
<td>
<p>object of class <code>aPEAR.methods.config</code></p>
</td></tr>
<tr><td><code id="enrichmentNetwork_+3A_theme">theme</code></td>
<td>
<p>object of class <code>aPEAR.theme.config</code></p>
</td></tr>
<tr><td><code id="enrichmentNetwork_+3A_verbose">verbose</code></td>
<td>
<p>enable / disable log messages</p>
</td></tr>
<tr><td><code id="enrichmentNetwork_+3A_...">...</code></td>
<td>
<p>additional parameters (see <code>?aPEAR.methods</code> and <code>?aPEAR.theme</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>ggplot2</code> object
</p>


<h3>See Also</h3>

<p><code>?findPathClusters</code>, <code>?plotPathClusters</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Load libraries
library(clusterProfiler)
library(DOSE)
library(org.Hs.eg.db)
data(geneList)

# Perform enrichment using clusterProfiler
enrich &lt;- gseGO(geneList, OrgDb = org.Hs.eg.db, ont = 'CC')

# Create enrichment network visualization with default parameters
enrichmentNetwork(enrich@result)

# Create enrichment network visualization with repelled labels and elipses
enrichmentNetwork(enrich@result, repelLabels = TRUE, drawEllipses = TRUE)


</code></pre>

<hr>
<h2 id='findPathClusters'>Find pathway clusters</h2><span id='topic+findPathClusters'></span>

<h3>Description</h3>

<p>Calculates the clusters within the enrichment data based on
pathway similarity.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>findPathClusters(enrichment, methods = aPEAR.methods, verbose = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="findPathClusters_+3A_enrichment">enrichment</code></td>
<td>
<p>a data.frame containing enrichment results</p>
</td></tr>
<tr><td><code id="findPathClusters_+3A_methods">methods</code></td>
<td>
<p>methods for calculating the pathway clusters within the enrichment
result (object of class aPEAR.methods; default: aPEAR.methods)</p>
</td></tr>
<tr><td><code id="findPathClusters_+3A_verbose">verbose</code></td>
<td>
<p>enable / disable log messages (default: FALSE)</p>
</td></tr>
<tr><td><code id="findPathClusters_+3A_...">...</code></td>
<td>
<p>additional parameters (see <code>?aPEAR.methods</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of two objects: <code>sim</code> - pathway similarity matrix; and
<code>clusters</code> - pathway clusters
</p>
<p>a list of clusters and similarity matrix
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Load libraries
library(clusterProfiler)
library(DOSE)
library(org.Hs.eg.db)
data(geneList)

# Perform enrichment using clusterProfiler
enrich &lt;- gseGO(geneList, OrgDb = org.Hs.eg.db, ont = 'CC')

# Obtain clusters within the enriched pathways using default parameters
data &lt;- findPathClusters(enrich@result)
data$clusters

# Obtain clusters within the enriched pathways using hierarchical clustering
# and minClusterSize = 1
data &lt;- findPathClusters(enrich@result, cluster = 'hier', minClusterSize = 1)
data$clusters


</code></pre>

<hr>
<h2 id='plotPathClusters'>aPEAR enrichment network</h2><span id='topic+plotPathClusters'></span>

<h3>Description</h3>

<p>Creates enrichment network plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotPathClusters(
  enrichment,
  sim,
  clusters,
  theme = aPEAR.theme,
  verbose = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotPathClusters_+3A_enrichment">enrichment</code></td>
<td>
<p>a data.frame containing enrichment results</p>
</td></tr>
<tr><td><code id="plotPathClusters_+3A_sim">sim</code></td>
<td>
<p>similarity matrix of the enriched pathways</p>
</td></tr>
<tr><td><code id="plotPathClusters_+3A_clusters">clusters</code></td>
<td>
<p>clusters of the enriched pathways</p>
</td></tr>
<tr><td><code id="plotPathClusters_+3A_theme">theme</code></td>
<td>
<p>object of class <code>aPEAR.theme.config</code></p>
</td></tr>
<tr><td><code id="plotPathClusters_+3A_verbose">verbose</code></td>
<td>
<p>enable / disable log messages</p>
</td></tr>
<tr><td><code id="plotPathClusters_+3A_...">...</code></td>
<td>
<p>additional parameters (see <code>?aPEAR.theme</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>ggplot2</code> object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Load libraries
library(clusterProfiler)
library(DOSE)
library(org.Hs.eg.db)
data(geneList)

# Perform enrichment using clusterProfiler
enrich &lt;- gseGO(geneList, OrgDb = org.Hs.eg.db, ont = 'CC')

# Obtain clusters within the enriched pathways using default parameters
data &lt;- findPathClusters(enrich@result)

# Create the enrichment network visualization using default parameters
plotPathClusters(enrich@result, data$sim, data$clusters)

# Create the enrichment network visualization with repelled labels and elipses
plotPathClusters(enrich@result, data$sim, data$clusters, repelLabels = TRUE, drawEllipses = TRUE)


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
