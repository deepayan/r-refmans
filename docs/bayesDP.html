<!DOCTYPE html><html><head><title>Help for package bayesDP</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {bayesDP}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#alpha_discount'><p>Bayesian Discount Prior: Historical Data Weight (alpha)</p></a></li>
<li><a href='#bdpbinomial'><p>Bayesian Discount Prior: Binomial counts</p></a></li>
<li><a href='#bdplm'><p>Bayesian Discount Prior: Two-Arm Linear Regression</p></a></li>
<li><a href='#bdplogit'><p>Bayesian Discount Prior: Two-Arm Logistic Regression</p></a></li>
<li><a href='#bdpnormal'><p>Bayesian Discount Prior: Gaussian mean values</p></a></li>
<li><a href='#bdpsurvival'><p>Bayesian Discount Prior: Survival Analysis</p></a></li>
<li><a href='#plot,bdpbinomial-method'><p>bdpbinomial Object Plot</p></a></li>
<li><a href='#plot,bdpnormal-method'><p>bdpnormal Object Plot</p></a></li>
<li><a href='#plot,bdpsurvival-method'><p>bdpsurvival Object Plot</p></a></li>
<li><a href='#ppexp'><p>Compute cdf of the piecewise exponential distribution</p></a></li>
<li><a href='#print,bdpbinomial-method'><p>bdpbinomial Object Print</p></a></li>
<li><a href='#print,bdplm-method'><p>bdplm Object Print</p></a></li>
<li><a href='#print,bdpnormal-method'><p>bdpnormal Object Print</p></a></li>
<li><a href='#print,bdpsurvival-method'><p>bdpsurvival Object Print</p></a></li>
<li><a href='#probability_discount'><p>Bayesian Discount Prior: Comparison Between Current and Historical Data</p></a></li>
<li><a href='#summary,bdpbinomial-method'><p>bdpbinomial Object Summary</p></a></li>
<li><a href='#summary,bdplm-method'><p>bdplm Object Summary</p></a></li>
<li><a href='#summary,bdpnormal-method'><p>bdpnormal Object Summary</p></a></li>
<li><a href='#summary,bdpsurvival-method'><p>bdpsurvival Object Summary</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Implementation of the Bayesian Discount Prior Approach for
Clinical Trials</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3.6</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6.0), ggplot2, methods, survival</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions for data augmentation using the Bayesian discount prior 
    method for single arm and two-arm clinical trials, as described in Haddad 
    et al. (2017) &lt;<a href="https://doi.org/10.1080%2F10543406.2017.1300907">doi:10.1080/10543406.2017.1300907</a>&gt;. The discount power prior 
    methodology was developed in collaboration with the The Medical Device 
    Innovation Consortium (MDIC) Computer Modeling &amp; Simulation Working Group.</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> | file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/graemeleehickey/bayesDP">https://github.com/graemeleehickey/bayesDP</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/graemeleehickey/bayesDP/issues">https://github.com/graemeleehickey/bayesDP/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Imports:</td>
<td>MCMCpack, Rcpp</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Suggests:</td>
<td>covr, knitr, rmarkdown, testthat</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-01-30 21:59:59 UTC; hickey</td>
</tr>
<tr>
<td>Author:</td>
<td>Shawn Balcome [aut],
  Donnie Musgrove [aut],
  Tarek Haddad [aut],
  Graeme L. Hickey <a href="https://orcid.org/0000-0002-4989-0054"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [cre, aut],
  Christopher Jackson [ctb] (For the ppexp R code that was ported to
    C++.)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Graeme L. Hickey &lt;graemeleehickey@gmail.com&gt;</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-01-30 22:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='alpha_discount'>Bayesian Discount Prior: Historical Data Weight (alpha)</h2><span id='topic+alpha_discount'></span><span id='topic+alpha_discount+2CANY-method'></span>

<h3>Description</h3>

<p><code>alpha_discount</code> can be used to estimate the weight
applied to historical data in the context of a one- or two-arm
clinical trial. <code>alpha_discount</code> is not used internally but is
given for educational purposes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>alpha_discount(
  p_hat = NULL,
  discount_function = "weibull",
  alpha_max = 1,
  weibull_scale = 0.135,
  weibull_shape = 3
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="alpha_discount_+3A_p_hat">p_hat</code></td>
<td>
<p>scalar. The posterior probability of a stochastic comparison.
This value can be the output of <code>posterior_probability</code> or a value
between 0 and 1.</p>
</td></tr>
<tr><td><code id="alpha_discount_+3A_discount_function">discount_function</code></td>
<td>
<p>character. Specify the discount function to use.
Currently supports <code>weibull</code>, <code>scaledweibull</code>, and
<code>identity</code>. The discount function <code>scaledweibull</code> scales
the output of the Weibull CDF to have a max value of 1. The <code>identity</code>
discount function uses the posterior probability directly as the discount
weight. Default value is &quot;<code>weibull</code>&quot;.</p>
</td></tr>
<tr><td><code id="alpha_discount_+3A_alpha_max">alpha_max</code></td>
<td>
<p>scalar. Maximum weight the discount function can apply.
Default is 1.</p>
</td></tr>
<tr><td><code id="alpha_discount_+3A_weibull_scale">weibull_scale</code></td>
<td>
<p>scalar. Scale parameter of the Weibull discount function
used to compute alpha, the weight parameter of the historical data. Default
value is 0.135.</p>
</td></tr>
<tr><td><code id="alpha_discount_+3A_weibull_shape">weibull_shape</code></td>
<td>
<p>scalar. Shape parameter of the Weibull discount function
used to compute alpha, the weight parameter of the historical data. Default
value is 3.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is not used internally but is given for educational purposes.
Given inputs <code>p_hat</code>, <code>discount_function</code>, <code>alpha_max</code>,
<code>weibull_shape</code>, and <code>weibull_scale</code> the output is the weight
that would be applied to historical data in the context of a one- or
two-arm clinical trial.
</p>


<h3>Value</h3>

<p><code>alpha_discount</code> returns an object of class &quot;alpha_discount&quot;.
</p>
<p>An object of class <code>alpha_discount</code> contains the following:
</p>

<dl>
<dt><code>alpha_hat</code></dt><dd>
<p>scalar. The historical data weight.
</p>
</dd>
</dl>



<h3>References</h3>

<p>Haddad, T., Himes, A., Thompson, L., Irony, T., Nair, R. MDIC Computer
Modeling and Simulation working group.(2017) Incorporation of stochastic
engineering models as prior information in Bayesian medical device trials.
<em>Journal of Biopharmaceutical Statistics</em>, 1-15.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>alpha_discount(0.5)

alpha_discount(0.5, discount_function = "identity")
</code></pre>

<hr>
<h2 id='bdpbinomial'>Bayesian Discount Prior: Binomial counts</h2><span id='topic+bdpbinomial'></span><span id='topic+bdpbinomial-method'></span><span id='topic+bdpbinomial+2CANY-method'></span>

<h3>Description</h3>

<p><code>bdpbinomial</code> is used for estimating posterior samples from a
binomial outcome where an informative prior is used. The prior weight
is determined using a discount function. This code is modeled after
the methodologies developed in Haddad et al. (2017).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bdpbinomial(
  y_t = NULL,
  N_t = NULL,
  y0_t = NULL,
  N0_t = NULL,
  y_c = NULL,
  N_c = NULL,
  y0_c = NULL,
  N0_c = NULL,
  discount_function = "identity",
  alpha_max = 1,
  fix_alpha = FALSE,
  a0 = 1,
  b0 = 1,
  number_mcmc = 10000,
  weibull_scale = 0.135,
  weibull_shape = 3,
  method = "mc",
  compare = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bdpbinomial_+3A_y_t">y_t</code></td>
<td>
<p>scalar. Number of events for the current treatment group.</p>
</td></tr>
<tr><td><code id="bdpbinomial_+3A_n_t">N_t</code></td>
<td>
<p>scalar. Sample size of the current treatment group.</p>
</td></tr>
<tr><td><code id="bdpbinomial_+3A_y0_t">y0_t</code></td>
<td>
<p>scalar. Number of events for the historical treatment group.</p>
</td></tr>
<tr><td><code id="bdpbinomial_+3A_n0_t">N0_t</code></td>
<td>
<p>scalar. Sample size of the historical treatment group.</p>
</td></tr>
<tr><td><code id="bdpbinomial_+3A_y_c">y_c</code></td>
<td>
<p>scalar. Number of events for the current control group.</p>
</td></tr>
<tr><td><code id="bdpbinomial_+3A_n_c">N_c</code></td>
<td>
<p>scalar. Sample size of the current control group.</p>
</td></tr>
<tr><td><code id="bdpbinomial_+3A_y0_c">y0_c</code></td>
<td>
<p>scalar. Number of events for the historical control group.</p>
</td></tr>
<tr><td><code id="bdpbinomial_+3A_n0_c">N0_c</code></td>
<td>
<p>scalar. Sample size of the historical control group.</p>
</td></tr>
<tr><td><code id="bdpbinomial_+3A_discount_function">discount_function</code></td>
<td>
<p>character. Specify the discount function to use.
Currently supports <code>weibull</code>, <code>scaledweibull</code>, and
<code>identity</code>. The discount function <code>scaledweibull</code> scales
the output of the Weibull CDF to have a max value of 1. The <code>identity</code>
discount function uses the posterior probability directly as the discount
weight. Default value is &quot;<code>identity</code>&quot;.</p>
</td></tr>
<tr><td><code id="bdpbinomial_+3A_alpha_max">alpha_max</code></td>
<td>
<p>scalar. Maximum weight the discount function can apply.
Default is 1. For a two-arm trial, users may specify a vector of two values
where the first value is used to weight the historical treatment group and
the second value is used to weight the historical control group.</p>
</td></tr>
<tr><td><code id="bdpbinomial_+3A_fix_alpha">fix_alpha</code></td>
<td>
<p>logical. Fix alpha at alpha_max? Default value is FALSE.</p>
</td></tr>
<tr><td><code id="bdpbinomial_+3A_a0">a0</code></td>
<td>
<p>scalar. Prior value for the beta rate. Default is 1.</p>
</td></tr>
<tr><td><code id="bdpbinomial_+3A_b0">b0</code></td>
<td>
<p>scalar. Prior value for the beta rate. Default is 1.</p>
</td></tr>
<tr><td><code id="bdpbinomial_+3A_number_mcmc">number_mcmc</code></td>
<td>
<p>scalar. Number of Monte Carlo simulations. Default is 10000.</p>
</td></tr>
<tr><td><code id="bdpbinomial_+3A_weibull_scale">weibull_scale</code></td>
<td>
<p>scalar. Scale parameter of the Weibull discount function
used to compute alpha, the weight parameter of the historical data. Default
value is 0.135. For a two-arm trial, users may specify a vector of two values
where the first value is used to estimate the weight of the historical
treatment group and the second value is used to estimate the weight of the
historical control group. Not used when <code>discount_function</code> = &quot;identity&quot;.</p>
</td></tr>
<tr><td><code id="bdpbinomial_+3A_weibull_shape">weibull_shape</code></td>
<td>
<p>scalar. Shape parameter of the Weibull discount function
used to compute alpha, the weight parameter of the historical data. Default
value is 3. For a two-arm trial, users may specify a vector of two values
where the first value is used to estimate the weight of the historical
treatment group and the second value is used to estimate the weight of the
historical control group. Not used when <code>discount_function</code> = &quot;identity&quot;.</p>
</td></tr>
<tr><td><code id="bdpbinomial_+3A_method">method</code></td>
<td>
<p>character. Analysis method with respect to estimation of the weight
paramter alpha. Default method &quot;<code>mc</code>&quot; estimates alpha for each
Monte Carlo iteration. Alternate value &quot;<code>fixed</code>&quot; estimates alpha once and
holds it fixed throughout the analysis. See the the <code>bdpbinomial</code> vignette <br />
<code>vignette("bdpbinomial-vignette", package="bayesDP")</code> for more details.</p>
</td></tr>
<tr><td><code id="bdpbinomial_+3A_compare">compare</code></td>
<td>
<p>logical. Should a comparison object be included in the fit?
For a one-arm analysis, the comparison object is simply the posterior
chain of the treatment group parameter. For a two-arm analysis, the comparison
object is the posterior chain of the treatment effect that compares treatment and
control. If <code>compare=TRUE</code>, the comparison object is accessible in the
<code>final</code> slot, else the <code>final</code> slot is <code>NULL</code>. Default is
<code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>bdpbinomial</code> uses a two-stage approach for determining the
strength of historical data in estimation of a binomial count mean outcome.
In the first stage, a <em>discount function</em> is used that that defines
the maximum strength of the historical data and discounts based on
disagreement with the current data. Disagreement between current and
historical data is determined by stochastically comparing the respective
posterior distributions under noninformative priors. With binomial data,
the comparison is the proability (<code>p</code>) that the current count is less
than the historical count. The comparison metric <code>p</code> is then input
into the Weibull discount function and the final strength of the historical
data is returned (alpha).
</p>
<p>In the second stage, posterior estimation is performed where the discount
function parameter, <code>alpha</code>, is used incorporated in all posterior
estimation procedures.
</p>
<p>To carry out a single arm (OPC) analysis, data for the current treatment
(<code>y_t</code> and <code>N_t</code>) and historical treatment (<code>y0_t</code> and
<code>N0_t</code>) must be input. The results are then based on the posterior
distribution of the current data augmented by the historical data.
</p>
<p>To carry our a two-arm (RCT) analysis, data for the current treatment and
at least one of current or historical control data must be input. The results
are then based on the posterior distribution of the difference between
current treatment and control, augmented by available historical data.
</p>
<p>For more details, see the <code>bdpbinomial</code> vignette: <br />
<code>vignette("bdpbinomial-vignette", package="bayesDP")</code>
</p>


<h3>Value</h3>

<p><code>bdpbinomial</code> returns an object of class &quot;bdpbinomial&quot;. The
functions <code><a href="#topic+summary+2Cbdpbinomial-method">summary</a></code> and
<code><a href="#topic+print+2Cbdpbinomial-method">print</a></code> are used to obtain and
print a summary of the results, including user inputs. The
<code><a href="#topic+plot+2Cbdpbinomial-method">plot</a></code> function displays visual
outputs as well.
</p>
<p>An object of class <code>bdpbinomial</code> is a list containing at least
the following components:
</p>

<dl>
<dt><code>posterior_treatment</code></dt><dd>
<p>list. Entries contain values related to the treatment group:</p>
</dd>
</dl>

<ul>
<li><p><code>alpha_discount</code>
numeric. Alpha value, the weighting parameter of the historical data.
</p>
</li>
<li><p><code>p_hat</code>
numeric. The posterior probability of the stochastic comparison
between the current and historical data.
</p>
</li>
<li><p><code>posterior</code>
vector. A vector of length <code>number_mcmc</code> containing
posterior Monte Carlo samples of the event rate of the treatment
group. If historical treatment data is present, the posterior
incorporates the weighted historical data.
</p>
</li>
<li><p><code>posterior_flat</code>
vector. A vector of length <code>number_mcmc</code> containing
Monte Carlo samples of the event rate of the current treatment group
under a flat/non-informative prior, i.e., no incorporation of the
historical data.
</p>
</li>
<li><p><code>prior</code>
vector. If historical treatment data is present, a vector of length
<code>number_mcmc</code> containing Monte Carlo samples of the event rate
of the historical treatment group under a flat/non-informative prior.
</p>
</li></ul>

<dl>
<dt><code>posterior_control</code></dt><dd>
<p>list. Similar entries as <code>posterior_treament</code>. Only present if a
control group is specified.</p>
</dd>
<dt><code>final</code></dt><dd>
<p>list. Contains the final comparison object, dependent on the analysis type:</p>
</dd>
</dl>

<ul>
<li><p>One-arm analysis:
vector. Posterior chain of binomial proportion.
</p>
</li>
<li><p>Two-arm analysis:
vector. Posterior chain of binomial proportion difference comparing
treatment and control groups.
</p>
</li></ul>

<dl>
<dt><code>args1</code></dt><dd>
<p>list. Entries contain user inputs. In addition, the following elements
are ouput:</p>
</dd>
</dl>

<ul>
<li><p><code>arm2</code>
binary indicator. Used internally to indicate one-arm or two-arm
analysis.
</p>
</li>
<li><p><code>intent</code>
character. Denotes current/historical status of treatment and
control groups.
</p>
</li></ul>




<h3>References</h3>

<p>Haddad, T., Himes, A., Thompson, L., Irony, T., Nair, R. MDIC Computer
Modeling and Simulation working group.(2017) Incorporation of stochastic
engineering models as prior information in Bayesian medical device trials.
<em>Journal of Biopharmaceutical Statistics</em>, 1-15.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summary+2Cbdpbinomial-method">summary</a></code>,
<code><a href="#topic+print+2Cbdpbinomial-method">print</a></code>,
and <code><a href="#topic+plot+2Cbdpbinomial-method">plot</a></code> for details of each of the
supported methods.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># One-arm trial (OPC) example
fit &lt;- bdpbinomial(
  y_t = 10,
  N_t = 500,
  y0_t = 25,
  N0_t = 250,
  method = "fixed"
)
summary(fit)
print(fit)
## Not run: 
plot(fit)

## End(Not run)

# Two-arm (RCT) example
fit2 &lt;- bdpbinomial(
  y_t = 10,
  N_t = 500,
  y0_t = 25,
  N0_t = 250,
  y_c = 8,
  N_c = 500,
  y0_c = 20,
  N0_c = 250,
  method = "fixed"
)
summary(fit2)
print(fit2)
## Not run: 
plot(fit2)

## End(Not run)

</code></pre>

<hr>
<h2 id='bdplm'>Bayesian Discount Prior: Two-Arm Linear Regression</h2><span id='topic+bdplm'></span><span id='topic+bdplm-method'></span><span id='topic+bdplm+2CANY-method'></span>

<h3>Description</h3>

<p><code>bdplm</code> is used to estimate the treatment effect in the
presence of covariates using the regression analysis implementation of the
Bayesian discount prior. <code>summary</code> and <code>print</code> methods are
supported. Currently, the function only supports a two-arm clinical trial
where all of current treatment, current control, historical treatment, and
historical control data are present
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bdplm(
  formula = formula,
  data = data,
  data0 = NULL,
  prior_treatment_effect = NULL,
  prior_control_effect = NULL,
  prior_treatment_sd = NULL,
  prior_control_sd = NULL,
  prior_covariate_effect = 0,
  prior_covariate_sd = 10000,
  number_mcmc_alpha = 5000,
  number_mcmc_sigmagrid = 5000,
  number_mcmc_sigma = 100,
  number_mcmc_beta = 10000,
  discount_function = "identity",
  alpha_max = 1,
  fix_alpha = FALSE,
  weibull_scale = 0.135,
  weibull_shape = 3,
  method = "mc"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bdplm_+3A_formula">formula</code></td>
<td>
<p>an object of class &quot;formula.&quot; See &quot;Details&quot; for more
information, including specification of treatment data indicators.</p>
</td></tr>
<tr><td><code id="bdplm_+3A_data">data</code></td>
<td>
<p>a data frame containing the current data variables in the model.
A column named <code>treatment</code> must be present; <code>treatment</code> must be
binary and indicate treatment group vs. control group.</p>
</td></tr>
<tr><td><code id="bdplm_+3A_data0">data0</code></td>
<td>
<p>a data frame containing the historical data variables in the
model. The column labels of data and data0 must match.</p>
</td></tr>
<tr><td><code id="bdplm_+3A_prior_treatment_effect">prior_treatment_effect</code></td>
<td>
<p>scalar. The historical adjusted treatment
effect. If left <code>NULL</code>, value is estimated from the historical data.</p>
</td></tr>
<tr><td><code id="bdplm_+3A_prior_control_effect">prior_control_effect</code></td>
<td>
<p>scalar. The historical adjusted control effect.
If left <code>NULL</code>, value is estimated from the historical data.</p>
</td></tr>
<tr><td><code id="bdplm_+3A_prior_treatment_sd">prior_treatment_sd</code></td>
<td>
<p>scalar. The standard deviation of the historical
adjusted treatment effect. If left <code>NULL</code>, value is estimated from the
historical data.</p>
</td></tr>
<tr><td><code id="bdplm_+3A_prior_control_sd">prior_control_sd</code></td>
<td>
<p>scalar. The standard deviation of the historical
adjusted control effect. If left <code>NULL</code>, value is estimated from the
historical data.</p>
</td></tr>
<tr><td><code id="bdplm_+3A_prior_covariate_effect">prior_covariate_effect</code></td>
<td>
<p>vector. The prior mean(s) of the covariate
effect(s). Default value is zero. If a single value is input, the the
scalar is repeated to the length of the input covariates. Otherwise, care
must be taken to ensure the length of the input matches the number of
covariates.</p>
</td></tr>
<tr><td><code id="bdplm_+3A_prior_covariate_sd">prior_covariate_sd</code></td>
<td>
<p>vector. The prior standard deviation(s) of the
covariate effect(s). Default value is 1e4. If a single value is input, the
the scalar is repeated to the length of the input covariates. Otherwise,
care must be taken to ensure the length of the input matches the number of
covariates.</p>
</td></tr>
<tr><td><code id="bdplm_+3A_number_mcmc_alpha">number_mcmc_alpha</code></td>
<td>
<p>scalar. Number of Monte Carlo simulations for
estimating the historical data weight. Default is 5000.</p>
</td></tr>
<tr><td><code id="bdplm_+3A_number_mcmc_sigmagrid">number_mcmc_sigmagrid</code></td>
<td>
<p>scalar. Grid size for computing sigma. Default
is 5000. See &quot;Details&quot; for more information.</p>
</td></tr>
<tr><td><code id="bdplm_+3A_number_mcmc_sigma">number_mcmc_sigma</code></td>
<td>
<p>scalar. Number of Monte Carlo simulations for
estimating sigma. Default is 1000. See &quot;Details&quot; for more information.</p>
</td></tr>
<tr><td><code id="bdplm_+3A_number_mcmc_beta">number_mcmc_beta</code></td>
<td>
<p>scalar. Number of Monte Carlo simulations for
estimating beta, the vector of regression coefficients. Default is 10000.</p>
</td></tr>
<tr><td><code id="bdplm_+3A_discount_function">discount_function</code></td>
<td>
<p>character. Specify the discount function to use.
Currently supports <code>weibull</code>, <code>scaledweibull</code>, and
<code>identity</code>. The discount function <code>scaledweibull</code> scales the
output of the Weibull CDF to have a max value of 1. The <code>identity</code>
discount function uses the posterior probability directly as the discount
weight. Default value is &quot;<code>identity</code>&quot;.</p>
</td></tr>
<tr><td><code id="bdplm_+3A_alpha_max">alpha_max</code></td>
<td>
<p>scalar. Maximum weight the discount function can apply.
Default is 1. Users may specify a vector of two values where the first
value is used to weight the historical treatment group and the second value
is used to weight the historical control group.</p>
</td></tr>
<tr><td><code id="bdplm_+3A_fix_alpha">fix_alpha</code></td>
<td>
<p>logical. Fix alpha at alpha_max? Default value is FALSE.</p>
</td></tr>
<tr><td><code id="bdplm_+3A_weibull_scale">weibull_scale</code></td>
<td>
<p>scalar. Scale parameter of the Weibull discount function
used to compute alpha, the weight parameter of the historical data. Default
value is 0.135. Users may specify a vector of two values where the first
value is used to estimate the weight of the historical treatment group and
the second value is used to estimate the weight of the historical control
group. Not used when <code>discount_function</code> = &quot;identity&quot;.</p>
</td></tr>
<tr><td><code id="bdplm_+3A_weibull_shape">weibull_shape</code></td>
<td>
<p>scalar. Shape parameter of the Weibull discount function
used to compute alpha, the weight parameter of the historical data. Default
value is 3. Users may specify a vector of two values where the first value
is used to estimate the weight of the historical treatment group and the
second value is used to estimate the weight of the historical control
group. Not used when <code>discount_function</code> = &quot;identity&quot;.</p>
</td></tr>
<tr><td><code id="bdplm_+3A_method">method</code></td>
<td>
<p>character. Analysis method with respect to estimation of the
weight paramter alpha. Default method &quot;<code>mc</code>&quot; estimates alpha for each
Monte Carlo iteration. Alternate value &quot;<code>fixed</code>&quot; estimates alpha once
and holds it fixed throughout the analysis.  See the the <code>bdplm</code>
vignette <br /> <code>vignette("bdplm-vignette", package="bayesDP")</code> for more
details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>bdplm</code> uses a two-stage approach for determining the strength
of historical data in estimation of an adjusted mean or covariate effect.
In the first stage, a <em>discount function</em> is used that that defines
the maximum strength of the historical data and discounts based on
disagreement with the current data. Disagreement between current and
historical data is determined by stochastically comparing the respective
posterior distributions under noninformative priors. Here with a two-arm
regression analysis, the comparison is the proability (<code>p</code>) that the
covariate effect of an historical data indicator is significantly different
from zero. The comparison metric <code>p</code> is then input into the discount
function and the final strength of the historical data is returned
(<code>alpha</code>).
</p>
<p>In the second stage, posterior estimation is performed where the discount
function parameter, <code>alpha</code>, is used to weight the historical data
effects.
</p>
<p>The formula must include an intercept (i.e., do not use <code>-1</code> in the
formula) and both data and data0 must be present. The column names of data
and data0 must match. See <code>examples</code> below for example usage.
</p>
<p>The underlying model results in a marginal posterior distribution for the
error variance <code>sigma2</code> that does not have a known distribution. Thus,
we use a grid search to draw samples of <code>sigma2</code>. First, the marginal
posterior is evaluated at a grid of <code>number_mcmc_sigmagrid</code>
<code>sigma2</code> values. The bounds of the grid are taken as approximately six
standard deviations from an estimate of <code>sigma2</code> using the <code>lm</code>
function. Next, <code>number_mcmc_sigma</code> posterior draws of <code>sigma2</code>
are made by sampling with replacement from the grid with each value having
the corresponding marginal posterior probability of being selected. With
posterior draws of <code>sigma2</code> in hand, we can make posterior draws of
the regression coefficients.
</p>


<h3>Value</h3>

<p><code>bdplm</code> returns an object of class &quot;bdplm&quot;.
</p>
<p>An object of class &quot;<code>bdplm</code>&quot; is a list containing at least the
following components: </p>
 <dl>
<dt><code>posterior</code></dt><dd><p> data frame. The
posterior draws of the covariates, the intercept, and the treatment effect.
The grid of sigma values are included.</p>
</dd> <dt><code>alpha_discount</code></dt><dd>
<p>vector. The posterior probability of the stochastic comparison between the
current and historical data for each of the treatment and control arms. If
<code>method="mc"</code>, the result is a matrix of estimates, otherwise for
<code>method="fixed"</code>, the result is a vector of estimates.</p>
</dd>
<dt><code>estimates</code></dt><dd><p> list. The posterior means and standard errors of
the intercept, treatment effect, covariate effect(s) and error variance.</p>
</dd> </dl>



<h3>Examples</h3>

<pre><code class='language-R'># Set sample sizes
n_t &lt;- 30 # Current treatment sample size
n_c &lt;- 30 # Current control sample size
n_t0 &lt;- 80 # Historical treatment sample size
n_c0 &lt;- 80 # Historical control sample size

# Treatment group vectors for current and historical data
treatment &lt;- c(rep(1, n_t), rep(0, n_c))
treatment0 &lt;- c(rep(1, n_t0), rep(0, n_c0))

# Simulate a covariate effect for current and historical data
x &lt;- rnorm(n_t + n_c, 1, 5)
x0 &lt;- rnorm(n_t0 + n_c0, 1, 5)

# Simulate outcome:
# - Intercept of 10 for current and historical data
# - Treatment effect of 31 for current data
# - Treatment effect of 30 for historical data
# - Covariate effect of 3 for current and historical data
Y &lt;- 10 + 31 * treatment + x * 3 + rnorm(n_t + n_c, 0, 5)
Y0 &lt;- 10 + 30 * treatment0 + x0 * 3 + rnorm(n_t0 + n_c0, 0, 5)

# Place data into separate treatment and control data frames and
# assign historical = 0 (current) or historical = 1 (historical)
df_ &lt;- data.frame(Y = Y, treatment = treatment, x = x)
df0 &lt;- data.frame(Y = Y0, treatment = treatment0, x = x0)

# Fit model using default settings
fit &lt;- bdplm(
  formula = Y ~ treatment + x, data = df_, data0 = df0,
  method = "fixed"
)

# Look at estimates and discount weight
summary(fit)
print(fit)
</code></pre>

<hr>
<h2 id='bdplogit'>Bayesian Discount Prior: Two-Arm Logistic Regression</h2><span id='topic+bdplogit'></span><span id='topic+bdplogit-method'></span><span id='topic+bdplogit+2CANY-method'></span>

<h3>Description</h3>

<p><code>bdplogit</code> is used to estimate the treatment effect
in the presence of covariates using the logistic regression analysis
implementation of the Bayesian discount prior. <code>summary</code> and
<code>print</code> methods are supported. Currently, the function only supports
a two-arm clinical trial where all of current treatment, current control,
historical treatment, and historical control data are present
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bdplogit(
  formula = formula,
  data = data,
  data0 = NULL,
  prior_treatment_effect = NULL,
  prior_control_effect = NULL,
  prior_treatment_sd = NULL,
  prior_control_sd = NULL,
  prior_covariate_effect = 0,
  prior_covariate_sd = 10000,
  number_mcmc_alpha = 5000,
  number_mcmc_beta = 10000,
  discount_function = "identity",
  alpha_max = 1,
  fix_alpha = FALSE,
  weibull_scale = 0.135,
  weibull_shape = 3,
  method = "mc"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bdplogit_+3A_formula">formula</code></td>
<td>
<p>an object of class &quot;formula.&quot; See &quot;Details&quot; for
more information, including specification of treatment
data indicators.</p>
</td></tr>
<tr><td><code id="bdplogit_+3A_data">data</code></td>
<td>
<p>a data frame containing the current data variables in the model.
A column named <code>treatment</code> must be present; <code>treatment</code> must
be binary and indicate treatment group vs. control group.</p>
</td></tr>
<tr><td><code id="bdplogit_+3A_data0">data0</code></td>
<td>
<p>a data frame containing the historical data variables in the model.
The column labels of data and data0 must match.</p>
</td></tr>
<tr><td><code id="bdplogit_+3A_prior_treatment_effect">prior_treatment_effect</code></td>
<td>
<p>scalar. The historical adjusted treatment effect.
If left <code>NULL</code>, value is estimated from the historical data.</p>
</td></tr>
<tr><td><code id="bdplogit_+3A_prior_control_effect">prior_control_effect</code></td>
<td>
<p>scalar. The historical adjusted control effect.
If left <code>NULL</code>, value is estimated from the historical data.</p>
</td></tr>
<tr><td><code id="bdplogit_+3A_prior_treatment_sd">prior_treatment_sd</code></td>
<td>
<p>scalar. The standard deviation of the historical
adjusted treatment effect. If left <code>NULL</code>, value is estimated from
the historical data.</p>
</td></tr>
<tr><td><code id="bdplogit_+3A_prior_control_sd">prior_control_sd</code></td>
<td>
<p>scalar. The standard deviation of the historical
adjusted control effect. If left <code>NULL</code>, value is estimated from
the historical data.</p>
</td></tr>
<tr><td><code id="bdplogit_+3A_prior_covariate_effect">prior_covariate_effect</code></td>
<td>
<p>vector. The prior mean(s) of the covariate
effect(s). Default value is zero. If a single value is input, the
the scalar is repeated to the length of the input covariates. Otherwise,
care must be taken to ensure the length of the input matches the number of
covariates.</p>
</td></tr>
<tr><td><code id="bdplogit_+3A_prior_covariate_sd">prior_covariate_sd</code></td>
<td>
<p>vector. The prior standard deviation(s) of the
covariate effect(s). Default value is 1e4. If a single value is input, the
the scalar is repeated to the length of the input covariates. Otherwise,
care must be taken to ensure the length of the input matches the number of
covariates.</p>
</td></tr>
<tr><td><code id="bdplogit_+3A_number_mcmc_alpha">number_mcmc_alpha</code></td>
<td>
<p>scalar. Number of Monte Carlo
simulations for estimating the historical data weight. Default is 5000.</p>
</td></tr>
<tr><td><code id="bdplogit_+3A_number_mcmc_beta">number_mcmc_beta</code></td>
<td>
<p>scalar. Number of Monte Carlo simulations for
estimating beta, the vector of regression coefficients. Default is 10000.</p>
</td></tr>
<tr><td><code id="bdplogit_+3A_discount_function">discount_function</code></td>
<td>
<p>character. Specify the discount function to use.
Currently supports <code>weibull</code>, <code>scaledweibull</code>, and
<code>identity</code>. The discount function <code>scaledweibull</code> scales
the output of the Weibull CDF to have a max value of 1. The <code>identity</code>
discount function uses the posterior probability directly as the discount
weight. Default value is &quot;<code>identity</code>&quot;.</p>
</td></tr>
<tr><td><code id="bdplogit_+3A_alpha_max">alpha_max</code></td>
<td>
<p>scalar. Maximum weight the discount function can apply.
Default is 1. Users may specify a vector of two values where the first
value is used to weight the historical treatment group and
the second value is used to weight the historical control group.</p>
</td></tr>
<tr><td><code id="bdplogit_+3A_fix_alpha">fix_alpha</code></td>
<td>
<p>logical. Fix alpha at alpha_max? Default value is FALSE.</p>
</td></tr>
<tr><td><code id="bdplogit_+3A_weibull_scale">weibull_scale</code></td>
<td>
<p>scalar. Scale parameter of the Weibull discount function
used to compute alpha, the weight parameter of the historical data. Default
value is 0.135. Users may specify a vector of two
values where the first value is used to estimate the weight of the
historical treatment group and the second value is used to estimate the
weight of the historical control group.
Not used when <code>discount_function</code> = &quot;identity&quot;.</p>
</td></tr>
<tr><td><code id="bdplogit_+3A_weibull_shape">weibull_shape</code></td>
<td>
<p>scalar. Shape parameter of the Weibull discount function
used to compute alpha, the weight parameter of the historical data. Default
value is 3. Users may specify a vector of two values
where the first value is used to estimate the weight of the historical
treatment group and the second value is used to estimate the weight of the
historical control group. Not used when <code>discount_function</code> = &quot;identity&quot;.</p>
</td></tr>
<tr><td><code id="bdplogit_+3A_method">method</code></td>
<td>
<p>character. Analysis method with respect to estimation of the weight
paramter alpha. Default method &quot;<code>mc</code>&quot; estimates alpha for each
Monte Carlo iteration. Alternate value &quot;<code>fixed</code>&quot; estimates alpha once and
holds it fixed throughout the analysis.  See the the <code>bdplm</code> vignette <br />
<code>vignette("bdplm-vignette", package="bayesDP")</code> for more details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>bdplogit</code> uses a two-stage approach for determining the
strength of historical data in estimation of an adjusted mean or covariate
effect. In the first stage, a <em>discount function</em> is used that
that defines the maximum strength of the
historical data and discounts based on disagreement with the current data.
Disagreement between current and historical data is determined by stochastically
comparing the respective posterior distributions under noninformative priors.
Here with a two-arm regression analysis, the comparison is the
proability (<code>p</code>) that the covariate effect of an historical data indicator is
significantly different from zero. The comparison metric <code>p</code> is then
input into the discount function and the final strength of the
historical data is returned (<code>alpha</code>).
</p>
<p>In the second stage, posterior estimation is performed where the discount
function parameter, <code>alpha</code>, is used to weight the historical data
effects.
</p>
<p>The formula must include an intercept (i.e., do not use <code>-1</code> in
the formula) and both data and data0 must be present.
The column names of data and data0 must match. See <code>examples</code> below for
example usage.
</p>
<p>The underlying model uses the <code>MCMClogit</code> function of the MCMCpack
package to carryout posterior estimation. Add more.
</p>


<h3>Value</h3>

<p><code>bdplogit</code> returns an object of class &quot;bdplogit&quot;.
</p>
<p>An object of class &quot;<code>bdplogit</code>&quot; is a list containing at least
the following components:
</p>

<dl>
<dt><code>posterior</code></dt><dd>
<p>data frame. The posterior draws of the covariates, the intercept, and
the treatment effect. The grid of sigma values are included.</p>
</dd>
<dt><code>alpha_discount</code></dt><dd>
<p>vector. The posterior probability of the stochastic comparison
between the current and historical data for each of the treatment
and control arms. If <code>method="mc"</code>, the result is a matrix of
estimates, otherwise for <code>method="fixed"</code>, the result is a vector
of estimates.</p>
</dd>
<dt><code>estimates</code></dt><dd>
<p>list. The posterior means and standard errors of the intercept,
treatment effect, covariate effect(s) and error variance.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'># Set sample sizes
n_t &lt;- 30 # Current treatment sample size
n_c &lt;- 30 # Current control sample size
n_t0 &lt;- 80 # Historical treatment sample size
n_c0 &lt;- 80 # Historical control sample size

# Treatment group vectors for current and historical data
treatment &lt;- c(rep(1, n_t), rep(0, n_c))
treatment0 &lt;- c(rep(1, n_t0), rep(0, n_c0))

# Simulate a covariate effect for current and historical data
x &lt;- rnorm(n_t + n_c, 1, 5)
x0 &lt;- rnorm(n_t0 + n_c0, 1, 5)

# Simulate outcome:
# - Intercept of 10 for current and historical data
# - Treatment effect of 31 for current data
# - Treatment effect of 30 for historical data
# - Covariate effect of 3 for current and historical data
Y &lt;- 10 + 31 * treatment + x * 3 + rnorm(n_t + n_c, 0, 5)
Y0 &lt;- 10 + 30 * treatment0 + x0 * 3 + rnorm(n_t0 + n_c0, 0, 5)

# Place data into separate treatment and control data frames and
# assign historical = 0 (current) or historical = 1 (historical)
df_ &lt;- data.frame(Y = Y, treatment = treatment, x = x)
df0 &lt;- data.frame(Y = Y0, treatment = treatment0, x = x0)

# Fit model using default settings
fit &lt;- bdplm(
  formula = Y ~ treatment + x, data = df_, data0 = df0,
  method = "fixed"
)

# Look at estimates and discount weight
summary(fit)
print(fit)
</code></pre>

<hr>
<h2 id='bdpnormal'>Bayesian Discount Prior: Gaussian mean values</h2><span id='topic+bdpnormal'></span><span id='topic+bdpnormal-method'></span><span id='topic+bdpnormal+2CANY-method'></span>

<h3>Description</h3>

<p><code>bdpnormal</code> is used for estimating posterior samples from a
Gaussian outcome where an informative prior is used. The prior weight
is determined using a discount function. This code is modeled after
the methodologies developed in Haddad et al. (2017).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bdpnormal(
  mu_t = NULL,
  sigma_t = NULL,
  N_t = NULL,
  mu0_t = NULL,
  sigma0_t = NULL,
  N0_t = NULL,
  mu_c = NULL,
  sigma_c = NULL,
  N_c = NULL,
  mu0_c = NULL,
  sigma0_c = NULL,
  N0_c = NULL,
  discount_function = "identity",
  alpha_max = 1,
  fix_alpha = FALSE,
  weibull_scale = 0.135,
  weibull_shape = 3,
  number_mcmc = 10000,
  method = "mc",
  compare = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bdpnormal_+3A_mu_t">mu_t</code></td>
<td>
<p>scalar. Mean of the current treatment group.</p>
</td></tr>
<tr><td><code id="bdpnormal_+3A_sigma_t">sigma_t</code></td>
<td>
<p>scalar. Standard deviation of the current treatment group.</p>
</td></tr>
<tr><td><code id="bdpnormal_+3A_n_t">N_t</code></td>
<td>
<p>scalar. Number of observations of the current treatment group.</p>
</td></tr>
<tr><td><code id="bdpnormal_+3A_mu0_t">mu0_t</code></td>
<td>
<p>scalar. Mean of the historical treatment group.</p>
</td></tr>
<tr><td><code id="bdpnormal_+3A_sigma0_t">sigma0_t</code></td>
<td>
<p>scalar. Standard deviation of the historical treatment
group.</p>
</td></tr>
<tr><td><code id="bdpnormal_+3A_n0_t">N0_t</code></td>
<td>
<p>scalar. Number of observations of the historical treatment
group.</p>
</td></tr>
<tr><td><code id="bdpnormal_+3A_mu_c">mu_c</code></td>
<td>
<p>scalar. Mean of the current control group.</p>
</td></tr>
<tr><td><code id="bdpnormal_+3A_sigma_c">sigma_c</code></td>
<td>
<p>scalar. Standard deviation of the current control group.</p>
</td></tr>
<tr><td><code id="bdpnormal_+3A_n_c">N_c</code></td>
<td>
<p>scalar. Number of observations of the current control group.</p>
</td></tr>
<tr><td><code id="bdpnormal_+3A_mu0_c">mu0_c</code></td>
<td>
<p>scalar. Mean of the historical control group.</p>
</td></tr>
<tr><td><code id="bdpnormal_+3A_sigma0_c">sigma0_c</code></td>
<td>
<p>scalar. Standard deviation of the historical control group.</p>
</td></tr>
<tr><td><code id="bdpnormal_+3A_n0_c">N0_c</code></td>
<td>
<p>scalar. Number of observations of the historical control group.</p>
</td></tr>
<tr><td><code id="bdpnormal_+3A_discount_function">discount_function</code></td>
<td>
<p>character. Specify the discount function to use.
Currently supports <code>weibull</code>, <code>scaledweibull</code>, and
<code>identity</code>. The discount function <code>scaledweibull</code> scales
the output of the Weibull CDF to have a max value of 1. The <code>identity</code>
discount function uses the posterior probability directly as the discount
weight. Default value is &quot;<code>identity</code>&quot;.</p>
</td></tr>
<tr><td><code id="bdpnormal_+3A_alpha_max">alpha_max</code></td>
<td>
<p>scalar. Maximum weight the discount function can apply.
Default is 1. For a two-arm trial, users may specify a vector of two values
where the first value is used to weight the historical treatment group and
the second value is used to weight the historical control group.</p>
</td></tr>
<tr><td><code id="bdpnormal_+3A_fix_alpha">fix_alpha</code></td>
<td>
<p>logical. Fix alpha at alpha_max? Default value is FALSE.</p>
</td></tr>
<tr><td><code id="bdpnormal_+3A_weibull_scale">weibull_scale</code></td>
<td>
<p>scalar. Scale parameter of the Weibull discount function
used to compute alpha, the weight parameter of the historical data. Default
value is 0.135. For a two-arm trial, users may specify a vector of two values
where the first value is used to estimate the weight of the historical
treatment group and the second value is used to estimate the weight of the
historical control group. Not used when <code>discount_function</code> = &quot;identity&quot;.</p>
</td></tr>
<tr><td><code id="bdpnormal_+3A_weibull_shape">weibull_shape</code></td>
<td>
<p>scalar. Shape parameter of the Weibull discount function
used to compute alpha, the weight parameter of the historical data. Default
value is 3. For a two-arm trial, users may specify a vector of two values
where the first value is used to estimate the weight of the historical
treatment group and the second value is used to estimate the weight of the
historical control group. Not used when <code>discount_function</code> = &quot;identity&quot;.</p>
</td></tr>
<tr><td><code id="bdpnormal_+3A_number_mcmc">number_mcmc</code></td>
<td>
<p>scalar. Number of Monte Carlo simulations. Default is 10000.</p>
</td></tr>
<tr><td><code id="bdpnormal_+3A_method">method</code></td>
<td>
<p>character. Analysis method with respect to estimation of the weight
paramter alpha. Default method &quot;<code>mc</code>&quot; estimates alpha for each
Monte Carlo iteration. Alternate value &quot;<code>fixed</code>&quot; estimates alpha once
and holds it fixed throughout the analysis.  See the the
<code>bdpnormal</code> vignette <br />
<code>vignette("bdpnormal-vignette", package="bayesDP")</code> for more details.</p>
</td></tr>
<tr><td><code id="bdpnormal_+3A_compare">compare</code></td>
<td>
<p>logical. Should a comparison object be included in the fit?
For a one-arm analysis, the comparison object is simply the posterior
chain of the treatment group parameter. For a two-arm analysis, the comparison
object is the posterior chain of the treatment effect that compares treatment and
control. If <code>compare=TRUE</code>, the comparison object is accessible in the
<code>final</code> slot, else the <code>final</code> slot is <code>NULL</code>. Default is
<code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>bdpnormal</code> uses a two-stage approach for determining the
strength of historical data in estimation of a mean outcome. In the first stage,
a <em>discount function</em> is used that that defines the maximum strength of the
historical data and discounts based on disagreement with the current data.
Disagreement between current and historical data is determined by stochastically
comparing the respective posterior distributions under noninformative priors.
With Gaussian data, the comparison is the proability (<code>p</code>) that the current
mean is less than the historical mean. The comparison metric <code>p</code> is then
input into the discount function and the final strength of the
historical data is returned (alpha).
</p>
<p>In the second stage, posterior estimation is performed where the discount
function parameter, <code>alpha</code>, is used incorporated in all posterior
estimation procedures.
</p>
<p>To carry out a single arm (OPC) analysis, data for the current treatment
(<code>mu_t</code>, <code>sigma_t</code>, and <code>N_t</code>) and historical treatment
(<code>mu0_t</code>, <code>sigma0_t</code>, and <code>N0_t</code>) must be input. The results
are then based on the posterior distribution of the current data augmented
by the historical data.
</p>
<p>To carry our a two-arm (RCT) analysis, data for the current treatment and
at least one of current or historical control data must be input.
The results are then based on the posterior distribution of the difference
between current treatment and control, augmented by available historical data.
</p>
<p>For more details, see the <code>bdpnormal</code> vignette: <br />
<code>vignette("bdpnormal-vignette", package="bayesDP")</code>
</p>


<h3>Value</h3>

<p><code>bdpnormal</code> returns an object of class &quot;bdpnormal&quot;. The
functions <code><a href="#topic+summary+2Cbdpnormal-method">summary</a></code> and
<code><a href="#topic+print+2Cbdpnormal-method">print</a></code> are used to obtain and print
a summary of the results, including user inputs. The
<code><a href="#topic+plot+2Cbdpnormal-method">plot</a></code> function displays visual
outputs as well.
</p>
<p>An object of class <code>bdpnormal</code> is a list containing at least
the following components:
</p>

<dl>
<dt><code>posterior_treatment</code></dt><dd>
<p>list. Entries contain values related to the treatment group:</p>
</dd>
</dl>

<ul>
<li><p><code>alpha_discount</code>
numeric. Alpha value, the weighting parameter of the historical data.
</p>
</li>
<li><p><code>p_hat</code>
numeric. The posterior probability of the stochastic comparison
between the current and historical data.
</p>
</li>
<li><p><code>posterior_mu</code>
vector. A vector of length <code>number_mcmc</code> containing the posterior
mean of the treatment group. If historical treatment data is present,
the posterior incorporates the weighted historical data.
</p>
</li>
<li><p><code>posterior_sigma2</code>
vector. A vector of length <code>number_mcmc</code> containing the posterior
variance of the treatment group. If historical treatment data is present,
the posterior incorporates the weighted historical data.
</p>
</li>
<li><p><code>posterior_flat_mu</code>
vector. A vector of length <code>number_mcmc</code> containing
Monte Carlo samples of the mean of the current treatment group
under a flat/non-informative prior, i.e., no incorporation of the
historical data.
</p>
</li>
<li><p><code>posterior_flat_sigma2</code>
vector. A vector of length <code>number_mcmc</code> containing
Monte Carlo samples of the standard deviation of the current treatment group
under a flat/non-informative prior, i.e., no incorporation of the
historical data.
</p>
</li>
<li><p><code>prior_mu</code>
vector. If historical treatment data is present, a vector of length
<code>number_mcmc</code> containing Monte Carlo samples of the mean
of the historical treatment group under a flat/non-informative prior.
</p>
</li>
<li><p><code>prior_sigma2</code>
vector. If historical treatment data is present, a vector of length
<code>number_mcmc</code> containing Monte Carlo samples of the standard deviation
of the historical treatment group under a flat/non-informative prior.
</p>
</li></ul>

<dl>
<dt><code>posterior_control</code></dt><dd>
<p>list. Similar entries as <code>posterior_treament</code>. Only present if a
control group is specified.
</p>
</dd>
<dt><code>final</code></dt><dd>
<p>list. Contains the final comparison object, dependent on the analysis type:</p>
</dd>
</dl>

<ul>
<li><p>One-arm analysis:
vector. Posterior chain of the mean.
</p>
</li>
<li><p>Two-arm analysis:
vector. Posterior chain of the mean difference comparing treatment and
control groups.
</p>
</li></ul>

<dl>
<dt><code>args1</code></dt><dd>
<p>list. Entries contain user inputs. In addition, the following elements
are ouput:</p>
</dd>
</dl>

<ul>
<li><p><code>arm2</code>
binary indicator. Used internally to indicate one-arm or two-arm
analysis.
</p>
</li>
<li><p><code>intent</code>
character. Denotes current/historical status of treatment and
control groups.
</p>
</li></ul>




<h3>References</h3>

<p>Haddad, T., Himes, A., Thompson, L., Irony, T., Nair, R. MDIC Computer
Modeling and Simulation working group.(2017) Incorporation of stochastic
engineering models as prior information in Bayesian medical device trials.
<em>Journal of Biopharmaceutical Statistics</em>, 1-15.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summary+2Cbdpnormal-method">summary</a></code>,
<code><a href="#topic+print+2Cbdpnormal-method">print</a></code>,
and <code><a href="#topic+plot+2Cbdpnormal-method">plot</a></code> for details of each of the
supported methods.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># One-arm trial (OPC) example
fit &lt;- bdpnormal(
  mu_t = 30, sigma_t = 10, N_t = 50,
  mu0_t = 32, sigma0_t = 10, N0_t = 50,
  method = "fixed"
)
summary(fit)
## Not run: 
plot(fit)

## End(Not run)

# Two-arm (RCT) example
fit2 &lt;- bdpnormal(
  mu_t = 30, sigma_t = 10, N_t = 50,
  mu0_t = 32, sigma0_t = 10, N0_t = 50,
  mu_c = 25, sigma_c = 10, N_c = 50,
  mu0_c = 25, sigma0_c = 10, N0_c = 50,
  method = "fixed"
)
summary(fit2)
## Not run: 
plot(fit2)

## End(Not run)

</code></pre>

<hr>
<h2 id='bdpsurvival'>Bayesian Discount Prior: Survival Analysis</h2><span id='topic+bdpsurvival'></span><span id='topic+bdpsurvival-method'></span><span id='topic+bdpsurvival+2CANY-method'></span>

<h3>Description</h3>

<p><code>bdpsurvival</code> is used to estimate the survival probability
(single arm trial; OPC) or hazard ratio (two-arm trial; RCT) for
right-censored data using the survival analysis implementation of the
Bayesian discount prior. In the current implementation, a two-arm analysis
requires all of current treatment, current control, historical treatment,
and historical control data. This code is modeled after
the methodologies developed in Haddad et al. (2017).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bdpsurvival(
  formula = formula,
  data = data,
  data0 = NULL,
  breaks = NULL,
  a0 = 0.1,
  b0 = 0.1,
  surv_time = NULL,
  discount_function = "identity",
  alpha_max = 1,
  fix_alpha = FALSE,
  number_mcmc = 10000,
  weibull_scale = 0.135,
  weibull_shape = 3,
  method = "mc",
  compare = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bdpsurvival_+3A_formula">formula</code></td>
<td>
<p>an object of class &quot;formula.&quot; Must have a survival object on
the left side and at most one input on the right side, treatment. See
&quot;Details&quot; for more information.</p>
</td></tr>
<tr><td><code id="bdpsurvival_+3A_data">data</code></td>
<td>
<p>a data frame containing the current data variables in the model.
Columns denoting 'time' and 'status' must be present. See &quot;Details&quot; for required
structure.</p>
</td></tr>
<tr><td><code id="bdpsurvival_+3A_data0">data0</code></td>
<td>
<p>optional. A data frame containing the historical data variables in the model.
If present, the column labels of data and data0 must match.</p>
</td></tr>
<tr><td><code id="bdpsurvival_+3A_breaks">breaks</code></td>
<td>
<p>vector. Breaks (interval starts) used to compose the breaks of the
piecewise exponential model. Do not include zero. Default breaks are the
quantiles of the input times.</p>
</td></tr>
<tr><td><code id="bdpsurvival_+3A_a0">a0</code></td>
<td>
<p>scalar. Prior value for the gamma shape of the piecewise
exponential hazards. Default is 0.1.</p>
</td></tr>
<tr><td><code id="bdpsurvival_+3A_b0">b0</code></td>
<td>
<p>scalar. Prior value for the gamma rate of the piecewise
exponential hazards. Default is 0.1.</p>
</td></tr>
<tr><td><code id="bdpsurvival_+3A_surv_time">surv_time</code></td>
<td>
<p>scalar. Survival time of interest for computing the
probability of survival for a single arm (OPC) trial. Default is
overall, i.e., current+historical, median survival time.</p>
</td></tr>
<tr><td><code id="bdpsurvival_+3A_discount_function">discount_function</code></td>
<td>
<p>character. Specify the discount function to use.
Currently supports <code>weibull</code>, <code>scaledweibull</code>, and
<code>identity</code>. The discount function <code>scaledweibull</code> scales
the output of the Weibull CDF to have a max value of 1. The <code>identity</code>
discount function uses the posterior probability directly as the discount
weight. Default value is &quot;<code>identity</code>&quot;.</p>
</td></tr>
<tr><td><code id="bdpsurvival_+3A_alpha_max">alpha_max</code></td>
<td>
<p>scalar. Maximum weight the discount function can apply.
Default is 1. For a two-arm trial, users may specify a vector of two values
where the first value is used to weight the historical treatment group and
the second value is used to weight the historical control group.</p>
</td></tr>
<tr><td><code id="bdpsurvival_+3A_fix_alpha">fix_alpha</code></td>
<td>
<p>logical. Fix alpha at alpha_max? Default value is FALSE.</p>
</td></tr>
<tr><td><code id="bdpsurvival_+3A_number_mcmc">number_mcmc</code></td>
<td>
<p>scalar. Number of Monte Carlo simulations. Default is 10000.</p>
</td></tr>
<tr><td><code id="bdpsurvival_+3A_weibull_scale">weibull_scale</code></td>
<td>
<p>scalar. Scale parameter of the Weibull discount function
used to compute alpha, the weight parameter of the historical data. Default
value is 0.135. For a two-arm trial, users may specify a vector of two
values where the first value is used to estimate the weight of the
historical treatment group and the second value is used to estimate the
weight of the historical control group.</p>
</td></tr>
<tr><td><code id="bdpsurvival_+3A_weibull_shape">weibull_shape</code></td>
<td>
<p>scalar. Shape parameter of the Weibull discount function
used to compute alpha, the weight parameter of the historical data. Default
value is 3. For a two-arm trial, users may specify a vector of two values
where the first value is used to estimate the weight of the historical
treatment group and the second value is used to estimate the weight of the
historical control group.</p>
</td></tr>
<tr><td><code id="bdpsurvival_+3A_method">method</code></td>
<td>
<p>character. Analysis method with respect to estimation of the weight
paramter alpha. Default method &quot;<code>mc</code>&quot; estimates alpha for each
Monte Carlo iteration. Alternate value &quot;<code>fixed</code>&quot; estimates alpha once
and holds it fixed throughout the analysis.  See the the
<code>bdpsurvival</code> vignette <br />
<code>vignette("bdpsurvival-vignette", package="bayesDP")</code> for more details.</p>
</td></tr>
<tr><td><code id="bdpsurvival_+3A_compare">compare</code></td>
<td>
<p>logical. Should a comparison object be included in the fit?
For a one-arm analysis, the comparison object is simply the posterior
chain of the treatment group parameter. For a two-arm analysis, the comparison
object is the posterior chain of the treatment effect that compares treatment and
control. If <code>compare=TRUE</code>, the comparison object is accessible in the
<code>final</code> slot, else the <code>final</code> slot is <code>NULL</code>. Default is
<code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>bdpsurvival</code> uses a two-stage approach for determining the
strength of historical data in estimation of a survival probability outcome.
In the first stage, a <em>discount function</em> is used that
that defines the maximum strength of the
historical data and discounts based on disagreement with the current data.
Disagreement between current and historical data is determined by stochastically
comparing the respective posterior distributions under noninformative priors.
With a single arm survival data analysis, the comparison is the
probability (<code>p</code>) that the current survival is less than the historical
survival. For a two-arm survival data, analysis the comparison is the
probability that the hazard ratio comparing treatment and control is
different from zero. The comparison metric <code>p</code> is then
input into the discount function and the final strength of the
historical data is returned (alpha).
</p>
<p>In the second stage, posterior estimation is performed where the discount
function parameter, <code>alpha</code>, is used incorporated in all posterior
estimation procedures.
</p>
<p>To carry out a single arm (OPC) analysis, data for the current and
historical treatments are specified in separate data frames, data and data0,
respectively. The data frames must have matching columns denoting time and status.
The 'time' column is the survival (censor) time of the event and the 'status' column
is the event indicator. The results are then based on the posterior probability of
survival at <code>surv_time</code> for the current data augmented by the historical data.
</p>
<p>Two-arm (RCT) analyses are specified similarly to a single arm trial. Again
the input data frames must have columns denoting time and status, but now
an additional column named 'treatment' is required to denote treatment and control
data. The 'treatment' column must use 0 to indicate the control group. The current data
are augmented by historical data (if present) and the results are then based
on the posterior distribution of the hazard ratio between the treatment
and control groups.
</p>
<p>For more details, see the <code>bdpsurvival</code> vignette: <br />
<code>vignette("bdpsurvival-vignette", package="bayesDP")</code>
</p>


<h3>Value</h3>

<p><code>bdpsurvival</code> returns an object of class &quot;bdpsurvival&quot;.
The functions <code><a href="#topic+summary+2Cbdpsurvival-method">summary</a></code> and <code><a href="#topic+print+2Cbdpsurvival-method">print</a></code> are used to obtain and
print a summary of the results, including user inputs. The <code><a href="#topic+plot+2Cbdpsurvival-method">plot</a></code>
function displays visual outputs as well.
</p>
<p>An object of class &quot;<code>bdpsurvival</code>&quot; is a list containing at least
the following components:
</p>

<dl>
<dt><code>posterior_treatment</code></dt><dd>
<p>list. Entries contain values related to the treatment group:</p>
</dd>
</dl>

<ul>
<li><p><code>alpha_discount</code>
numeric. Alpha value, the weighting parameter of the historical data.
</p>
</li>
<li><p><code>p_hat</code>
numeric. The posterior probability of the stochastic comparison
between the current and historical data.
</p>
</li>
<li><p><code>posterior_survival</code>
vector. If one-arm trial, a vector of length <code>number_mcmc</code>
containing the posterior probability draws of survival at
<code>surv_time</code>.
</p>
</li>
<li><p><code>posterior_flat_survival</code>
vector. If one-arm trial, a vector of length <code>number_mcmc</code>
containing the probability draws of survival at <code>surv_time</code>
for the current treatment not augmented by historical treatment.
</p>
</li>
<li><p><code>prior_survival</code>
vector. If one-arm trial, a vector of length <code>number_mcmc</code>
containing the probability draws of survival at <code>surv_time</code>
for the historical treatment.
</p>
</li>
<li><p><code>posterior_hazard</code>
matrix. A matrix with <code>number_mcmc</code> rows and <code>length(breaks)</code>
columns containing the posterior draws of the piecewise hazards
for each interval break point.
</p>
</li>
<li><p><code>posterior_flat_hazard</code>
matrix. A matrix with <code>number_mcmc</code> rows and <code>length(breaks)</code>
columns containing the draws of piecewise hazards for each interval
break point for current treatment not augmented by historical treatment.
</p>
</li>
<li><p><code>prior_hazard</code>
matrix. A matrix with <code>number_mcmc</code> rows and <code>length(breaks)</code>
columns containing the draws of piecewise hazards for each interval break point
for historical treatment.
</p>
</li></ul>

<dl>
<dt><code>posterior_control</code></dt><dd>
<p>list. If two-arm trial, contains values related to the control group
analagous to the <code>posterior_treatment</code> output.</p>
</dd>
<dt><code>final</code></dt><dd>
<p>list. Contains the final comparison object, dependent on the analysis type:</p>
</dd>
</dl>

<ul>
<li><p>One-arm analysis:
vector. Posterior chain of survival probability at requested time.
</p>
</li>
<li><p>Two-arm analysis:
vector. Posterior chain of log-hazard rate comparing treatment and control groups.
</p>
</li></ul>

<dl>
<dt><code>args1</code></dt><dd>
<p>list. Entries contain user inputs. In addition, the following elements
are ouput:</p>
</dd>
</dl>

<ul>
<li><p><code>S_t</code>, <code>S_c</code>, <code>S0_t</code>, <code>S0_c</code>
survival objects. Used internally to pass survival data between
functions.
</p>
</li>
<li><p><code>arm2</code>
logical. Used internally to indicate one-arm or two-arm analysis.
</p>
</li></ul>




<h3>References</h3>

<p>Haddad, T., Himes, A., Thompson, L., Irony, T., Nair, R. MDIC Computer
Modeling and Simulation working group.(2017) Incorporation of stochastic
engineering models as prior information in Bayesian medical device trials.
<em>Journal of Biopharmaceutical Statistics</em>, 1-15.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summary+2Cbdpsurvival-method">summary</a></code>,
<code><a href="#topic+print+2Cbdpsurvival-method">print</a></code>,
and <code><a href="#topic+plot+2Cbdpsurvival-method">plot</a></code> for details of each of the
supported methods.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># One-arm trial (OPC) example - survival probability at 5 years

# Collect data into data frames
df_ &lt;- data.frame(
  status = rexp(50, rate = 1 / 30),
  time = rexp(50, rate = 1 / 20)
)
df_$status &lt;- ifelse(df_$time &lt; df_$status, 1, 0)

df0 &lt;- data.frame(
  status = rexp(50, rate = 1 / 30),
  time = rexp(50, rate = 1 / 10)
)
df0$status &lt;- ifelse(df0$time &lt; df0$status, 1, 0)


fit1 &lt;- bdpsurvival(Surv(time, status) ~ 1,
  data = df_,
  data0 = df0,
  surv_time = 5,
  method = "fixed"
)

print(fit1)
## Not run: 
plot(fit1)

## End(Not run)

# Two-arm trial example
# Collect data into data frames
df_ &lt;- data.frame(
  time = c(
    rexp(50, rate = 1 / 20), # Current treatment
    rexp(50, rate = 1 / 10)
  ), # Current control
  status = rexp(100, rate = 1 / 40),
  treatment = c(rep(1, 50), rep(0, 50))
)
df_$status &lt;- ifelse(df_$time &lt; df_$status, 1, 0)

df0 &lt;- data.frame(
  time = c(
    rexp(50, rate = 1 / 30), # Historical treatment
    rexp(50, rate = 1 / 5)
  ), # Historical control
  status = rexp(100, rate = 1 / 40),
  treatment = c(rep(1, 50), rep(0, 50))
)
df0$status &lt;- ifelse(df0$time &lt; df0$status, 1, 0)

fit2 &lt;- bdpsurvival(Surv(time, status) ~ treatment,
  data = df_,
  data0 = df0,
  method = "fixed"
)
summary(fit2)

### Fix alpha at 1
fit2_1 &lt;- bdpsurvival(Surv(time, status) ~ treatment,
  data = df_,
  data0 = df0,
  fix_alpha = TRUE,
  method = "fixed"
)
summary(fit2_1)
</code></pre>

<hr>
<h2 id='plot+2Cbdpbinomial-method'>bdpbinomial Object Plot</h2><span id='topic+plot+2Cbdpbinomial-method'></span>

<h3>Description</h3>

<p><code>plot</code> method for class <code>bdpbinomial</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'bdpbinomial'
plot(x, type = NULL, print = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot+2B2Cbdpbinomial-method_+3A_x">x</code></td>
<td>
<p>object of class <code>bdpbinomial</code>. The result of a call to the
<code><a href="#topic+bdpbinomial">bdpbinomial</a></code> function.</p>
</td></tr>
<tr><td><code id="plot+2B2Cbdpbinomial-method_+3A_type">type</code></td>
<td>
<p>character. Optional. Select plot type to print. Supports the
following: &quot;discount&quot; gives the discount function; &quot;posteriors&quot; gives the
posterior plots of the event rates; and &quot;density&quot; gives the augmented
posterior density plot(s). Leave NULL to display all plots in sequence.</p>
</td></tr>
<tr><td><code id="plot+2B2Cbdpbinomial-method_+3A_print">print</code></td>
<td>
<p>logical. Optional. Produce a plot (<code>print = TRUE</code>; default)
or return a ggplot object (<code>print = FALSE</code>). When <code>print =
FALSE</code>, it is possible to use <code>ggplot2</code> syntax to modify the plot
appearance.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>plot</code> method for <code>bdpbinomial</code> returns up to three
plots: (1) posterior density curves; (2) posterior density of the effect of
interest; and (3) the discount function. A call to <code>plot</code> that omits
the <code>type</code> input returns one plot at a time and prompts the user to
click the plot or press return to proceed to the next plot. Otherwise, the
user can specify a plot <code>type</code> to display the requested plot.
</p>

<hr>
<h2 id='plot+2Cbdpnormal-method'>bdpnormal Object Plot</h2><span id='topic+plot+2Cbdpnormal-method'></span>

<h3>Description</h3>

<p><code>plot</code> method for class <code>bdpnormal</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'bdpnormal'
plot(x, type = NULL, print = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot+2B2Cbdpnormal-method_+3A_x">x</code></td>
<td>
<p>object of class <code>bdpnormal</code>. The result of a call to the
<code><a href="#topic+bdpnormal">bdpnormal</a></code> function.</p>
</td></tr>
<tr><td><code id="plot+2B2Cbdpnormal-method_+3A_type">type</code></td>
<td>
<p>character. Optional. Select plot type to print. Supports the
following: &quot;discount&quot; gives the discount function; &quot;posteriors&quot; gives the
posterior plots of the event rates; and &quot;density&quot; gives the augmented
posterior density plot(s). Leave NULL to display all plots in sequence.</p>
</td></tr>
<tr><td><code id="plot+2B2Cbdpnormal-method_+3A_print">print</code></td>
<td>
<p>logical. Optional. Produce a plot (<code>print = TRUE</code>; default)
or return a ggplot object (<code>print = FALSE</code>). When <code>print =
FALSE</code>, it is possible to use <code>ggplot2</code> syntax to modify the plot
appearance.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>plot</code> method for <code>bdpnormal</code> returns up to three
plots: (1) posterior density curves; (2) posterior density of the effect of
interest; and (3) the discount function. A call to <code>plot</code> that omits
the <code>type</code> input returns one plot at a time and prompts the user to
click the plot or press return to proceed to the next plot. Otherwise, the
user can specify a plot <code>type</code> to display the requested plot.
</p>

<hr>
<h2 id='plot+2Cbdpsurvival-method'>bdpsurvival Object Plot</h2><span id='topic+plot+2Cbdpsurvival-method'></span>

<h3>Description</h3>

<p><code>plot</code> method for class <code>bdpsurvival</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'bdpsurvival'
plot(x, type = NULL, print = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot+2B2Cbdpsurvival-method_+3A_x">x</code></td>
<td>
<p>object of class <code>bdpsurvival</code>. The result of a call to the
<code><a href="#topic+bdpsurvival">bdpsurvival</a></code> function.</p>
</td></tr>
<tr><td><code id="plot+2B2Cbdpsurvival-method_+3A_type">type</code></td>
<td>
<p>character. Optional. Select plot type to print. Supports the
following: &quot;discount&quot; gives the discount function and &quot;survival&quot; gives the
survival curves. Leave NULL to display all plots in sequence.</p>
</td></tr>
<tr><td><code id="plot+2B2Cbdpsurvival-method_+3A_print">print</code></td>
<td>
<p>logical. Optional. Produce a plot (<code>print = TRUE</code>; default)
or return a ggplot object (<code>print = FALSE</code>). When <code>print =
FALSE</code>, it is possible to use <code>ggplot2</code> syntax to modify the plot
appearance.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>plot</code> method for <code>bdpsurvival</code> returns up to two
plots: (1) posterior survival curves and (2) the discount function. A call
to <code>plot</code> that omits the <code>type</code> input returns one plot at a time
and prompts the user to click the plot or press return to proceed to the
next plot. Otherwise, the user can specify a plot <code>type</code> to display
the requested plot.
</p>

<hr>
<h2 id='ppexp'>Compute cdf of the piecewise exponential distribution</h2><span id='topic+ppexp'></span>

<h3>Description</h3>

<p><code>ppexp</code> is used to compute the cumulative distribution
function of the piecewise exponential distribution. The function is ported
from R to C++ via code adapted from the <code>msm</code> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ppexp(q, x, cuts)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ppexp_+3A_q">q</code></td>
<td>
<p>scalar. The time point at which the cdf is to be computed.</p>
</td></tr>
<tr><td><code id="ppexp_+3A_x">x</code></td>
<td>
<p>vector or matrix. The hazard rate(s).</p>
</td></tr>
<tr><td><code id="ppexp_+3A_cuts">cuts</code></td>
<td>
<p>vector. Times at which the rate changes, i.e., the interval cut
points. The first element of cuts should be 0, and cuts should be in
increasing order. Must be the same length as <code>x</code> (vector) or have the
same number of columns as <code>x</code> (matrix)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The code underlying <code>ppexp</code> is written in C++ and adapted from
R code used in the <code>msm</code> package.
</p>


<h3>Value</h3>

<p>The cumulative distribution function computed at time <code>q</code>,
hazard(s) <code>x</code>, and cut points <code>cuts</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Single vector of hazard rates. Returns a single cdf value.
q &lt;- 12
x &lt;- c(0.25, 0.3, 0.35, 0.4)
cuts &lt;- c(0, 6, 12, 18)
pp &lt;- ppexp(q, x, cuts)

# Matrix of multiple vectors of hazard rates. Returns 10 cdf values.
x &lt;- matrix(rgamma(4 * 10, 0.1, 0.1), nrow = 10)
pp &lt;- ppexp(q, x, cuts)
</code></pre>

<hr>
<h2 id='print+2Cbdpbinomial-method'>bdpbinomial Object Print</h2><span id='topic+print+2Cbdpbinomial-method'></span>

<h3>Description</h3>

<p><code>print</code> method for class <code>bdpbinomial</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'bdpbinomial'
print(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print+2B2Cbdpbinomial-method_+3A_x">x</code></td>
<td>
<p>object of class <code>bdpbinomial</code>. The result of a call to the
<code><a href="#topic+bdpbinomial">bdpbinomial</a></code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Returns same output as a call to
<code><a href="#topic+summary+2Cbdpbinomial-method">summary</a></code>.
</p>

<hr>
<h2 id='print+2Cbdplm-method'>bdplm Object Print</h2><span id='topic+print+2Cbdplm-method'></span>

<h3>Description</h3>

<p><code>print</code> method for class <code>bdplm</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'bdplm'
print(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print+2B2Cbdplm-method_+3A_x">x</code></td>
<td>
<p>object of class <code>bdplm</code>. The result of a call to the
<code><a href="#topic+bdplm">bdplm</a></code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Displays a print of the <code>bdplm</code> fit and the initial function call.
The fit includes the estimate of the intercept, treatment effect, and
covariate effects. The discount function weight estimates are displayed as well.
If <code>method</code>=&quot;mc&quot;, the median estimate of alpha is displayed.
</p>

<hr>
<h2 id='print+2Cbdpnormal-method'>bdpnormal Object Print</h2><span id='topic+print+2Cbdpnormal-method'></span>

<h3>Description</h3>

<p><code>print</code> method for class <code>bdpnormal</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'bdpnormal'
print(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print+2B2Cbdpnormal-method_+3A_x">x</code></td>
<td>
<p>object of class <code>bdpnormal</code>. The result of a call to the
<code><a href="#topic+bdpnormal">bdpnormal</a></code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Returns same output as a call to <code><a href="#topic+summary+2Cbdpnormal-method">summary</a></code>.
</p>

<hr>
<h2 id='print+2Cbdpsurvival-method'>bdpsurvival Object Print</h2><span id='topic+print+2Cbdpsurvival-method'></span>

<h3>Description</h3>

<p><code>print</code> method for class <code>bdpsurvival</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'bdpsurvival'
print(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print+2B2Cbdpsurvival-method_+3A_x">x</code></td>
<td>
<p>object of class <code>bdpsurvival</code>. The result of a call to the
<code><a href="#topic+bdpsurvival">bdpsurvival</a></code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Displays a print of the <code>bdpsurvival</code> fit. The output
is different, conditional on a one- or two-arm survival analysis.
</p>
<p>In the case of a one-arm analysis, a brief summary is displayed,
including the current data sample size, number of events,
user input survival time, the augmented median survival probability,
and corresponding lower and upper 95 percent interval limits.
</p>
<p>When a control arm is present, the output is the same as a call to
<code><a href="#topic+summary+2Cbdpsurvival-method">summary</a></code>.
</p>

<hr>
<h2 id='probability_discount'>Bayesian Discount Prior: Comparison Between Current and Historical Data</h2><span id='topic+probability_discount'></span><span id='topic+probability_discount+2CANY-method'></span>

<h3>Description</h3>

<p><code>probability_discount</code> can be used to estimate the posterior
probability of the comparison between historical and current data in the
context of a clinical trial with normal (mean) data.
<code>probability_discount</code> is not used internally but is given for
educational purposes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>probability_discount(
  mu = NULL,
  sigma = NULL,
  N = NULL,
  mu0 = NULL,
  sigma0 = NULL,
  N0 = NULL,
  number_mcmc = 10000,
  method = "fixed"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="probability_discount_+3A_mu">mu</code></td>
<td>
<p>scalar. Mean of the current data.</p>
</td></tr>
<tr><td><code id="probability_discount_+3A_sigma">sigma</code></td>
<td>
<p>scalar. Standard deviation of the current data.</p>
</td></tr>
<tr><td><code id="probability_discount_+3A_n">N</code></td>
<td>
<p>scalar. Number of observations of the current data.</p>
</td></tr>
<tr><td><code id="probability_discount_+3A_mu0">mu0</code></td>
<td>
<p>scalar. Mean of the historical data.</p>
</td></tr>
<tr><td><code id="probability_discount_+3A_sigma0">sigma0</code></td>
<td>
<p>scalar. Standard deviation of the historical data.</p>
</td></tr>
<tr><td><code id="probability_discount_+3A_n0">N0</code></td>
<td>
<p>scalar. Number of observations of the historical data.</p>
</td></tr>
<tr><td><code id="probability_discount_+3A_number_mcmc">number_mcmc</code></td>
<td>
<p>scalar. Number of Monte Carlo simulations. Default is
10000.</p>
</td></tr>
<tr><td><code id="probability_discount_+3A_method">method</code></td>
<td>
<p>character. Analysis method. Default value &quot;<code>fixed</code>&quot;
estimates the posterior probability and holds it fixed. Alternative method
&quot;<code>mc</code>&quot; estimates the posterior probability for each Monte Carlo
iteration. See the the <code>bdpnormal</code> vignette <br />
<code>vignette("bdpnormal-vignette", package="bayesDP")</code> for more details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is not used internally but is given for educational purposes.
Given the inputs,  the output is the posterior probability of the comparison
between current and historical data in the context of a clinical
trial with normal (mean) data.
</p>


<h3>Value</h3>

<p><code>probability_discount</code> returns an object of class
&quot;probability_discount&quot;.
</p>
<p>An object of class <code>probability_discount</code> contains the following:
</p>

<dl>
<dt><code>p_hat</code></dt><dd>
<p>scalar. The posterior probability of the comparison historical data weight. If
<code>method="mc"</code>, a vector of posterior probabilities of length
<code>number_mcmc</code> is returned.</p>
</dd>
</dl>



<h3>References</h3>

<p>Haddad, T., Himes, A., Thompson, L., Irony, T., Nair, R. MDIC Computer
Modeling and Simulation working group.(2017) Incorporation of stochastic
engineering models as prior information in Bayesian medical device trials.
<em>Journal of Biopharmaceutical Statistics</em>, 1-15.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>probability_discount(
  mu = 0, sigma = 1, N = 100,
  mu0 = 0.1, sigma0 = 1, N0 = 100
)
</code></pre>

<hr>
<h2 id='summary+2Cbdpbinomial-method'>bdpbinomial Object Summary</h2><span id='topic+summary+2Cbdpbinomial-method'></span>

<h3>Description</h3>

<p><code>summary</code> method for class <code>bdpbinomial</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'bdpbinomial'
summary(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary+2B2Cbdpbinomial-method_+3A_object">object</code></td>
<td>
<p>object of class <code>bdpbinomial</code>. The result of a call to the
<code><a href="#topic+bdpbinomial">bdpbinomial</a></code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Displays a summary of the <code>bdpbinomial</code> fit including the input
data, the stochastic comparison between current and historical data, and
the resulting historical data weight (alpha). If historical data is missing
then no stochastic comparison nor weight are displayed.
</p>
<p>In the case of a one-arm analysis, the displayed 95 percent CI contains the
lower and upper limits of the augmented event rate of the current data. The
displayed <code>sample estimate</code> is the event rate of the current data
augmented by the historical data.
</p>
<p>When a control arm is present, a two-arm analysis is carried out. Now, the
displayed 95 percent CI contains the lower and upper limits of the
difference between the treatment and control arms with the historical data
augmented to current data, if present. The displayed <code>sample
  estimates</code> are the event rates of the treatment and control arms, each of
which are augmented when historical data are present.
</p>

<hr>
<h2 id='summary+2Cbdplm-method'>bdplm Object Summary</h2><span id='topic+summary+2Cbdplm-method'></span>

<h3>Description</h3>

<p><code>summary</code> method for class <code>bdplm</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'bdplm'
summary(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary+2B2Cbdplm-method_+3A_object">object</code></td>
<td>
<p>an object of class <code>bdplm</code>, a result of a call to
<code><a href="#topic+bdplm">bdplm</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Displays a summary of the <code>bdplm</code> fit. Displayed output is
similar to <code><a href="stats.html#topic+summary.lm">summary.lm</a></code>. The function call, residuals, and
coefficient table are displayed. The discount function weight estimates are
displayed as well. If <code>method</code>=&quot;mc&quot;, the median estimate of alpha is
displayed.
</p>

<hr>
<h2 id='summary+2Cbdpnormal-method'>bdpnormal Object Summary</h2><span id='topic+summary+2Cbdpnormal-method'></span>

<h3>Description</h3>

<p><code>summary</code> method for class <code>bdpnormal</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'bdpnormal'
summary(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary+2B2Cbdpnormal-method_+3A_object">object</code></td>
<td>
<p>object of class <code>bdpnormal</code>. The result of a call to the
<code><a href="#topic+bdpnormal">bdpnormal</a></code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Displays a summary of the <code>bdpnormal</code> fit including the input
data, the stochastic comparison between current and historical data, and
the resulting historical data weight (alpha). If historical data is missing
then no stochastic comparison nor weight are displayed.
</p>
<p>In the case of a one-arm analysis, the displayed 95 percent CI contains the
lower and upper limits of the augmented mean value of the current data. The
displayed <code>mean of treatment group</code> is the mean of the current data
augmented by the historical data.
</p>
<p>When a control arm is present, a two-arm analysis is carried out. Now, the
displayed 95 percent CI contains the lower and upper limits of the
difference between the treatment and control arms with the historical data
augmented to current data, if present. The displayed posterior sample
estimates are the mean of the treatment and control arms, each of which are
augmented when historical data are present.
</p>

<hr>
<h2 id='summary+2Cbdpsurvival-method'>bdpsurvival Object Summary</h2><span id='topic+summary+2Cbdpsurvival-method'></span>

<h3>Description</h3>

<p><code>summary</code> method for class <code>bdpsurvival</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'bdpsurvival'
summary(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary+2B2Cbdpsurvival-method_+3A_object">object</code></td>
<td>
<p>an object of class <code>bdpsurvival</code>, a result of a call to
<code><a href="#topic+bdpsurvival">bdpsurvival</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Displays a summary of the <code>bdpsurvival</code> fit. The output is
different, conditional on a one- or two-arm survival analysis.
</p>
<p>In the case of a one-arm analysis, the stochastic comparison between
current and historical data and the resulting historical data weight
(alpha) are displayed, followed by a survival table containing augmented
posterior estimates of the survival probability at each time point for the
current data.
</p>
<p>When a control arm is present, a two-arm analysis is carried out. A two-arm
survival analysis is similar to a cox proportional hazards analysis, and
the displayed summary reflects this. First, the stochastic comparison
between current and historical data and the resulting historical data
weight (alpha) are displayed, when historical data is present for the
respective arm. The displayed <code>coef</code> value is the log-hazard between
the augmented treatment and control arms (log(treatment) - log(control)).
The lower and upper 95 percent interval limits correspond to the
<code>coef</code> value.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
