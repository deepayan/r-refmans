<!DOCTYPE html><html lang="en"><head><title>Help for package hglm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {hglm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#hglm-package'>
<p>Hierarchical Generalized Linear Models</p></a></li>
<li><a href='#Beta'><p>Extended Beta Family</p></a></li>
<li><a href='#CAR'><p>Conditional Autoregressive Family</p></a></li>
<li><a href='#hglm'><p>Fitting Hierarchical Generalized Linear Models</p></a></li>
<li><a href='#hglm2'><p>Fitting Hierarchical Generalized Linear Models</p></a></li>
<li><a href='#inverse.gamma'><p>Inverse Gamma Family</p></a></li>
<li><a href='#inverse.sqrt'><p>Inverse Square Root Family</p></a></li>
<li><a href='#logLik.hglm'><p>Extracts log-likelihood values</p></a></li>
<li><a href='#lrt'><p>Likelihood-ratio test for variance components in <code>hglm</code></p></a></li>
<li><a href='#plot.hglm'><p>Plot Hierarchical Generalized Linear Model Objects</p></a></li>
<li><a href='#SAR'><p>Simultaneous Autoregressive Family</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Hierarchical Generalized Linear Models</td>
</tr>
<tr>
<td>Version:</td>
<td>2.2-1</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-04-04</td>
</tr>
<tr>
<td>Author:</td>
<td>Moudud Alam, Lars Ronnegard, Xia Shen</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Xia Shen &lt;xia.shen@ki.se&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Implemented here are procedures for fitting hierarchical generalized linear models (HGLM). It can be used for linear mixed models and generalized linear mixed models with random effects for a variety of links and a variety of distributions for both the outcomes and the random effects. Fixed effects can also be fitted in the dispersion part of the mean model. As statistical models, HGLMs were initially developed by Lee and Nelder (1996) <a href="https://www.jstor.org/stable/2346105?seq=1">https://www.jstor.org/stable/2346105?seq=1</a>. We provide an implementation (Ronnegard, Alam and Shen 2010) <a href="https://journal.r-project.org/archive/2010-2/RJournal_2010-2_Roennegaard~et~al.pdf">https://journal.r-project.org/archive/2010-2/RJournal_2010-2_Roennegaard~et~al.pdf</a> following Lee, Nelder and Pawitan (2006) &lt;ISBN: 9781420011340&gt; with algorithms extended for spatial modeling (Alam, Ronnegard and Shen 2015) <a href="https://journal.r-project.org/archive/2015/RJ-2015-017/RJ-2015-017.pdf">https://journal.r-project.org/archive/2015/RJ-2015-017/RJ-2015-017.pdf</a>. </td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://r-forge.r-project.org/tracker/?group_id=558">https://r-forge.r-project.org/tracker/?group_id=558</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0), utils, Matrix, MASS, hglm.data</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-04-04 15:36:54 UTC; xia</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-04-04 16:20:07 UTC</td>
</tr>
</table>
<hr>
<h2 id='hglm-package'>
Hierarchical Generalized Linear Models
</h2><span id='topic+hglm-package'></span>

<h3>Description</h3>

<p>The <code>hglm</code> package is used to fit hierarchical generalized linear models. It can be used for linear mixed models and 
generalized linear models with random effects for a variety of links and a variety of distributions for both
the outcomes and the random effects. Fixed effects can also be fitted in the dispersion part of the model.
The function can be called either by specifying the design matrices or as a <code><a href="stats.html#topic+formula">formula</a></code>. The default estimation method is
extended quasi likelihood (EQL; Lee et al., 2006) but from version 2.0 the EQL1 correction has been implemented as well.   
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> hglm</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 2.1-0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2015-04-20</td>
</tr>
<tr>
 <td style="text-align: left;">
Discussion: </td><td style="text-align: left;"> https://r-forge.r-project.org/forum/?group_id=558</td>
</tr>
<tr>
 <td style="text-align: left;">
BugReports: </td><td style="text-align: left;"> https://r-forge.r-project.org/tracker/?group_id=558</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
Depends: </td><td style="text-align: left;"> R (&gt;= 2.10), utils, Matrix, MASS, hglm.data</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Moudud Alam, Lars Ronnegard, Xia Shen<br /><br />
Maintainer: Xia Shen &lt;xia.shen@ki.se&gt;
</p>


<h3>References</h3>

<p>Lars Ronnegard, Xia Shen and Moudud Alam (2010). <b>hglm: A Package for Fitting Hierarchical Generalized Linear Models</b>. <em>The R Journal</em>, <b>2</b>(2), 20-28.<br /><br />
</p>
<p>Youngjo Lee, John A Nelder and Yudi Pawitan (2006) <em>Generalized Linear Models with Random Effect: a unified analysis via h-likelihood.</em> Chapman and Hall/CRC.<br /><br />
</p>
<p>Xia Shen, Moudud Alam, Freddy Fikse and Lars Ronnegard (2013). <b>A novel generalized ridge regression method for quantitative genetics</b>. <em>Genetics</em>.<br /><br />
</p>
<p>Moudud Alam, Lars Ronnegard, Xia Shen (2014). <b>Fitting conditional and simultaneous autoregressive spatial models in hglm</b>. <em>Submitted</em>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+hglm">hglm</a></code>, <code><a href="#topic+hglm2">hglm2</a></code>, <code><a href="#topic+plot.hglm">plot.hglm</a></code>
</p>

<hr>
<h2 id='Beta'>Extended Beta Family</h2><span id='topic+Beta'></span>

<h3>Description</h3>

<p>A function used in the <code>hglm</code> package which extends the usage of the Beta family.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Beta(link = "logit")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Beta_+3A_link">link</code></td>
<td>
<p>the link function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Output as for other GLM families 
</p>

<hr>
<h2 id='CAR'>Conditional Autoregressive Family</h2><span id='topic+CAR'></span>

<h3>Description</h3>

<p>A function used in the <code>hglm</code> package which extends the usage of the CAR family.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CAR(D, link = "identity", link.rand.disp = "inverse")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CAR_+3A_d">D</code></td>
<td>
<p>the <b>D</b> matrix of the Markov Random Field model.</p>
</td></tr>
<tr><td><code id="CAR_+3A_link">link</code></td>
<td>
<p>the link function for the random effects.</p>
</td></tr>
<tr><td><code id="CAR_+3A_link.rand.disp">link.rand.disp</code></td>
<td>
<p>the link function for the random effects dispersion parameter.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Output specific for <code>hglm</code> fit, including eigen values and vectors of <b>D</b>.
</p>


<h3>References</h3>

<p>Moudud Alam, Lars Ronnegard, Xia Shen (2014). <b>Fitting conditional and simultaneous autoregressive spatial models in hglm</b>. <em>Submitted</em>.
</p>

<hr>
<h2 id='hglm'>Fitting Hierarchical Generalized Linear Models</h2><span id='topic+hglm'></span>

<h3>Description</h3>

<p><code>hglm</code> is used to fit hierarchical generalized linear models. It can be used for linear mixed models and 
generalized linear models with random effects for a variety of links and a variety of distributions for both
the outcomes and the random effects. Fixed effects can also be fitted in the dispersion part of the model.
The function can be called either by specifying the design matrices or as a <code><a href="stats.html#topic+formula">formula</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hglm(X = NULL, y = NULL, Z = NULL, family = gaussian(link = identity),
     rand.family = gaussian(link = identity), method = "EQL", 
     conv = 1e-6, maxit = 50, startval = NULL, fixed = NULL, 
     random = NULL, X.disp = NULL, disp = NULL, link.disp = "log", 
     X.rand.disp = NULL, rand.disp = NULL, link.rand.disp = "log", 
     data = NULL, weights = NULL, fix.disp = NULL, offset = NULL, 
     RandC = ncol(Z), sparse = TRUE, vcovmat = FALSE, 
     calc.like = FALSE, bigRR = FALSE, verbose = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hglm_+3A_x">X</code></td>
<td>
<p><code>matrix</code>. The design matrix for the fixed effects.</p>
</td></tr>
<tr><td><code id="hglm_+3A_y">y</code></td>
<td>
<p><code>numeric</code>. The dependent variable.</p>
</td></tr>
<tr><td><code id="hglm_+3A_z">Z</code></td>
<td>
<p><code>matrix</code>. The design matrix for the random effects.</p>
</td></tr>
<tr><td><code id="hglm_+3A_family">family</code></td>
<td>
<p><code>family</code>. The description of the error distribution and link function to be used in the mean part of the model. (See <code><a href="stats.html#topic+family">family</a></code> for details of family functions.)</p>
</td></tr>
<tr><td><code id="hglm_+3A_rand.family">rand.family</code></td>
<td>
<p><code>family</code>. The description of the distribution and link function to be used for the random effect.</p>
</td></tr>
<tr><td><code id="hglm_+3A_method">method</code></td>
<td>
<p><code>character</code>. Estimation method where <code>EQL</code> is the method of interconnected GLMs presented in Lee et al (2006). Apart from the default option <code>EQL</code> there is also an <code>EQL1</code> option, which improves estimation for GLMMs (especially for Poisson models with a large number of levels in the random effects).</p>
</td></tr>
<tr><td><code id="hglm_+3A_conv">conv</code></td>
<td>
<p><code>numeric</code>. The convergence criteria (change in linear predictor between iterations).</p>
</td></tr>
<tr><td><code id="hglm_+3A_maxit">maxit</code></td>
<td>
<p><code>numeric</code>. Maximum number of iterations in the <code>hglm</code> algorithm.</p>
</td></tr>
<tr><td><code id="hglm_+3A_startval">startval</code></td>
<td>
<p><code>numeric</code>. A vector of starting values in the following order: fixed effects, random effect, variance of random effects, variance of residuals.</p>
</td></tr>
<tr><td><code id="hglm_+3A_fixed">fixed</code></td>
<td>
<p><code>formula</code>. A <code><a href="stats.html#topic+formula">formula</a></code> specifying the fixed effects part of the model.</p>
</td></tr>
<tr><td><code id="hglm_+3A_random">random</code></td>
<td>
<p><code>formula</code>. A one-sided <code><a href="stats.html#topic+formula">formula</a></code> specifying the random effects part of the model.</p>
</td></tr>
<tr><td><code id="hglm_+3A_x.disp">X.disp</code></td>
<td>
<p><code>matrix</code>. The design matrix for the fixed effects in the residual dispersion part of the model.</p>
</td></tr>
<tr><td><code id="hglm_+3A_disp">disp</code></td>
<td>
<p><code>formula</code>. A one-sided <code><a href="stats.html#topic+formula">formula</a></code> specifying the fixed effects in the residual dispersion part of the model.</p>
</td></tr>
<tr><td><code id="hglm_+3A_link.disp">link.disp</code></td>
<td>
<p><code>character</code>. The link function for the residual dispersion part of the model.</p>
</td></tr>
<tr><td><code id="hglm_+3A_x.rand.disp">X.rand.disp</code></td>
<td>
<p><code>matrix</code>. The design matrix for the fixed effects in the random effects dispersion part of the model.</p>
</td></tr>
<tr><td><code id="hglm_+3A_rand.disp">rand.disp</code></td>
<td>
<p><code>formula</code>. A one-sided <code><a href="stats.html#topic+formula">formula</a></code> specifying the fixed effects in the random effects dispersion part of the model.</p>
</td></tr>
<tr><td><code id="hglm_+3A_link.rand.disp">link.rand.disp</code></td>
<td>
<p><code>character</code>. The link function for the random effects dispersion part of the model.</p>
</td></tr>
<tr><td><code id="hglm_+3A_data">data</code></td>
<td>
<p><code>data.frame</code>. The data frame to be used together with <code>fixed</code> and <code>random</code>.</p>
</td></tr>
<tr><td><code id="hglm_+3A_weights">weights</code></td>
<td>
<p><code>numeric</code>. Prior weights to be specified in weighted regression.</p>
</td></tr>
<tr><td><code id="hglm_+3A_fix.disp">fix.disp</code></td>
<td>
<p><code>numeric</code>. A numeric value if the dispersion parameter of the mean model is known, e.g., 1 for binomial and Poisson model.</p>
</td></tr>
<tr><td><code id="hglm_+3A_offset">offset</code></td>
<td>
<p>An offset for the linear predictor of the mean model.</p>
</td></tr>
<tr><td><code id="hglm_+3A_randc">RandC</code></td>
<td>
<p><code>numeric</code>. Integers (possibly a vector) specifying the number of column of Z to be used for each of the random-effect terms.</p>
</td></tr>
<tr><td><code id="hglm_+3A_sparse">sparse</code></td>
<td>
<p><code>logical</code>. If <code>TRUE</code>, the computation is to be carried out by using sparse matrix technique.</p>
</td></tr>
<tr><td><code id="hglm_+3A_vcovmat">vcovmat</code></td>
<td>
<p><code>logical</code>. If <code>TRUE</code>, the variance-covariance matrix is returned.</p>
</td></tr>
<tr><td><code id="hglm_+3A_calc.like">calc.like</code></td>
<td>
<p>logical. If <code>TRUE</code>, likelihoods will be computed at convergence and will be shown via the print or summary methods on the output object.</p>
</td></tr>
<tr><td><code id="hglm_+3A_bigrr">bigRR</code></td>
<td>
<p>logical. If <code>TRUE</code>, and only for the Gaussian model with one random effect term, a specific algorithm will be used for fast fitting high-dimensional (p &gt;&gt; n) problems. See Shen et al. (2013) for more details of the method.</p>
</td></tr>
<tr><td><code id="hglm_+3A_verbose">verbose</code></td>
<td>
<p>logical. If <code>TRUE</code>, more information is printed during model fitting process.</p>
</td></tr>
<tr><td><code id="hglm_+3A_...">...</code></td>
<td>
<p>not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Models for <code>hglm</code> are either specified symbolically using <code><a href="stats.html#topic+formula">formula</a></code> 
or by specifying the design matrices ( <code>X</code>, <code>Z</code> and <code>X.disp</code>). The extended quasi likelihood (EQL)
method is the default method for estimation of the model parameters. For the Gaussian-Gaussian linear mixed models, it
is REML. It should be noted that the EQL estimator can be biased and inconsistent in some special cases e.g. binary pair matched response. A higher order correction 
might be useful to correct the bias of EQL (Lee et al. 2006). There is also an <code>EQL1</code> option, which improves estimation for GLMMs (especially for Poisson models with a large number of levels in the random effects). The <code>EQL1</code> method computes estimates by adjusting the working response as described in the appendix of Lee and Lee (2012). <br />
By default, the dispersion
parameter is estimated by the <code>hglm</code> and <code>hglm2</code> functions. If the dispersion parameter of the mean model is to be held constant, for example if it is
desired to be 1 for binomial and Poisson family, then <code>fix.disp</code>=value where, value=1 for the above example, should be used. 
<br /><br />
<b>Interpretation of warning messages</b> <br />
<em>Remove all NA before input to the hglm function.</em><br />
- This message is important and tells the user to delete all lines with missing values from the input data.<br /><br />
<em>Residuals numerically 0 are replaced by 1e-8.</em> or <br />
<em>Hat-values numerically 1 are replaced by 1 - 1e-8.</em><br />
- These messages are often not important as they usually reflect a numerical issue in an intermediate step of the iterative fitting algorithm. However, it is a good idea to check that there are no hat values equal to 1 in the final output. 
</p>


<h3>Value</h3>

<p>It returns an object of class <code>hglm</code> consiting of the following values.
</p>
<table role = "presentation">
<tr><td><code>fixef</code></td>
<td>
<p>fixed effect estimates.</p>
</td></tr>
<tr><td><code>ranef</code></td>
<td>
<p>random effect estimates.</p>
</td></tr>
<tr><td><code>RandC</code></td>
<td>
<p>integers (possibly a vector) specified the number of column of Z to be used for each of the random-effect terms.</p>
</td></tr>
<tr><td><code>varFix</code></td>
<td>
<p>dispersion parameter of the mean model (residual variance for LMM).</p>
</td></tr>
<tr><td><code>varRanef</code></td>
<td>
<p>dispersion parameter of the random effects (variance of random effects for GLMM).</p>
</td></tr>
<tr><td><code>CAR.rho</code></td>
<td>
<p>parameter estimate for a MRF spatial model.</p>
</td></tr>
<tr><td><code>CAR.tau</code></td>
<td>
<p>parameter estimate for a MRF spatial model.</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p>number of iterations used.</p>
</td></tr>
<tr><td><code>Converge</code></td>
<td>
<p>specifies if the algorithm converged.</p>
</td></tr>
<tr><td><code>SeFe</code></td>
<td>
<p>standard errors of fixed effects.</p>
</td></tr>
<tr><td><code>SeRe</code></td>
<td>
<p>standard errors of random effects.</p>
</td></tr>
<tr><td><code>dfReFe</code></td>
<td>
<p>deviance degrees of freedom for the mean part of the model.</p>
</td></tr>
<tr><td><code>SummVC1</code></td>
<td>
<p>estimates and standard errors of the linear predictor in the dispersion model.</p>
</td></tr>
<tr><td><code>SummVC2</code></td>
<td>
<p>estimates and standard errors of the linear predictor for the dispersion parameter of the random effects.</p>
</td></tr>
<tr><td><code>dev</code></td>
<td>
<p>individual deviances for the mean part of the model.</p>
</td></tr>
<tr><td><code>hv</code></td>
<td>
<p>hatvalues for the mean part of the model.</p>
</td></tr>
<tr><td><code>resid</code></td>
<td>
<p>studentized residuals for the mean part of the model.</p>
</td></tr>
<tr><td><code>fv</code></td>
<td>
<p>fitted values for the mean part of the model.</p>
</td></tr>
<tr><td><code>disp.fv</code></td>
<td>
<p>fitted values for the dispersion part of the model.</p>
</td></tr>
<tr><td><code>disp.resid</code></td>
<td>
<p>standardized deviance residuals for the dispersion part of the model.</p>
</td></tr>
<tr><td><code>link.disp</code></td>
<td>
<p>link function for the dispersion part of the model.</p>
</td></tr>
<tr><td><code>vcov</code></td>
<td>
<p>the variance-covariance matrix.</p>
</td></tr>
<tr><td><code>likelihood</code></td>
<td>
<p>a list of log-likelihood values for model selection purposes, where <code>$hlik</code> is the log-h-likelihood, <code>$pvh</code> the adjusted profile log-likelihood profiled over random effects, <code>$pbvh</code> the adjusted profile log-likelihood profiled over fixed and random effects, and <code>$cAIC</code> the conditional AIC. (NOTE: In some earlier version (version &lt;2.0) -2 times the log-likelihoods were reported.)</p>
</td></tr>
<tr><td><code>bad</code></td>
<td>
<p>the index of the influential observation.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Moudud Alam, Lars Ronnegard, Xia Shen</p>


<h3>References</h3>

<p>Lars Ronnegard, Xia Shen and Moudud Alam (2010). <b>hglm: A Package for Fitting Hierarchical Generalized Linear Models</b>. <em>The R Journal</em>, <b>2</b>(2), 20-28.<br /><br />
</p>
<p>Youngjo Lee, John A Nelder and Yudi Pawitan (2006) <em>Generalized Linear Models with Random Effect: a unified analysis via h-likelihood.</em> Chapman and Hall/CRC.<br /><br />
</p>
<p>Xia Shen, Moudud Alam, Freddy Fikse and Lars Ronnegard (2013). <b>A novel generalized ridge regression method for quantitative genetics</b>. <em>Genetics</em> <b>193</b>(4), ?1255-1268. <br /><br />
</p>
<p>Moudud Alam, Lars Ronnegard, Xia Shen (2014). <b>Fitting conditional and simultaneous autoregressive spatial models in hglm</b>. <em>Submitted</em>.<br /><br />
</p>
<p>Woojoo Lee and Youngjo Lee (2012). <b>Modifications of REML algorithm for hglms</b>. <em>Statistics and Computing</em> <b>22</b>, 959-966.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+hglm2">hglm2</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># Find more examples and instructions in the package vignette:
# vignette('hglm')

require(hglm)

# --------------------- #
# semiconductor example #
# --------------------- #

data(semiconductor)

m11 &lt;- hglm(fixed = y ~ x1 + x3 + x5 + x6,
            random = ~ 1|Device,
            family = Gamma(link = log),
            disp = ~ x2 + x3, data = semiconductor)
summary(m11)
plot(m11, cex = .6, pch = 1,
     cex.axis = 1/.6, cex.lab = 1/.6,
     cex.main = 1/.6, mar = c(3, 4.5, 0, 1.5))

# ------------------- #
# redo it using hglm2 #
# ------------------- #

m12 &lt;- hglm2(y ~ x1 + x3 + x5 + x6 + (1|Device),
             family = Gamma(link = log),
             disp = ~ x2 + x3, data = semiconductor)
summary(m12)
     
# -------------------------- #
# redo it using matrix input #
# -------------------------- #

attach(semiconductor)
m13 &lt;- hglm(y = y, X = model.matrix(~ x1 + x3 + x5 + x6),
            Z = kronecker(diag(16), rep(1, 4)),
            X.disp = model.matrix(~ x2 + x3), 
            family = Gamma(link = log))
summary(m13)
     
# --------------------- #
# verbose &amp; likelihoods #
# --------------------- #
     
m14 &lt;- hglm(fixed = y ~ x1 + x3 + x5 + x6,
            random = ~ 1|Device,
            family = Gamma(link = log),
            disp = ~ x2 + x3, data = semiconductor,
            verbose = TRUE, calc.like = TRUE)
summary(m14)

# --------------------------------------------- #  
# simulated example with 2 random effects terms #
# --------------------------------------------- #  
## Not run: 
set.seed(911)
x1 &lt;- rnorm(100)
x2 &lt;- rnorm(100)
x3 &lt;- rnorm(100)
z1 &lt;- factor(rep(LETTERS[1:10], rep(10, 10)))
z2 &lt;- factor(rep(letters[1:5], rep(20, 5)))
Z1 &lt;- model.matrix(~ 0 + z1)
Z2 &lt;- model.matrix(~ 0 + z2)
u1 &lt;- rnorm(10, 0, sqrt(2))
u2 &lt;- rnorm(5, 0, sqrt(3))
y &lt;- 1 + 2*x1 + 3*x2 + Z1%*%u1 + Z2%*%u2 + rnorm(100, 0, sqrt(exp(x3)))
dd &lt;- data.frame(x1 = x1, x2 = x2, x3 = x3, z1 = z1, z2 = z2, y = y)

(m21 &lt;- hglm(X = cbind(rep(1, 100), x1, x2), y = y, Z = cbind(Z1, Z2), 
             RandC = c(10, 5)))
summary(m21)
plot(m21)

# m21 is the same as:
(m21b &lt;- hglm(X = cbind(rep(1, 100), x1, x2), y = y, Z = cbind(Z1, Z2), 
              rand.family = list(gaussian(), gaussian()), RandC = c(10, 5))

(m22 &lt;- hglm2(y ~ x1 + x2 + (1|z1) + (1|z2), data = dd, vcovmat = TRUE))
image(m22$vcov, main = 'Variance-covariance Matrix')
summary(m22)
plot(m22)

m31 &lt;- hglm2(y ~ x1 + x2 + (1|z1) + (1|z2), disp = ~ x3, data = dd)
print (m31)
summary(m31)
plot(m31)

# ------------------------------- #  
# Markov random field (MRF) model #
# ------------------------------- #  
data(cancer)
logE &lt;- log(E)
X11 &lt;- model.matrix(~Paff)
m41 &lt;- hglm(X = X11, y = O, Z = diag(length(O)), 
           family = poisson(), rand.family = CAR(D = nbr),
           offset = logE, conv = 1e-9, maxit = 200, fix.disp = 1)
summary(m41)

data(ohio)
m42 &lt;- hglm(fixed = MedianScore ~ 1, 
            random = ~ 1 | district, 
            rand.family = CAR(D = ohioDistrictDistMat), 
            data = ohioMedian)
summary(m42)
require(sp)
districtShape &lt;- as.numeric(substr(as.character(ohioShape@data$UNSDIDFP), 3, 7)) 
CARfit &lt;- matrix(m42$ranef + m42$fixef, dimnames = list(rownames(ohioDistrictDistMat), NULL))
ohioShape@data$CAR &lt;- CARfit[as.character(districtShape),]
ohioShape@data$CAR[353] &lt;- NA # remove estimate of Lake Erie
spplot(ohioShape, zcol = "CAR", main = "Fitted values from CAR", 
        col.regions = heat.colors(1000)[1000:1], cuts = 1000)

## End(Not run)
</code></pre>

<hr>
<h2 id='hglm2'>Fitting Hierarchical Generalized Linear Models</h2><span id='topic+hglm2'></span>

<h3>Description</h3>

<p><code>hglm2</code> is used to fit hierarchical generalized linear models. <code>hglm2</code> is used to fit hierarchical generalized linear models. 
It extends the <code>hglm</code> function by allowing for several random effects, where the model is specified in <code>lme4</code> convension, 
and also by implementing sparse matrix techniques using the <code>Matrix</code> library. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hglm2(meanmodel, data = NULL, family = gaussian(link = identity),
      rand.family = gaussian(link = identity), method = "EQL", 
      conv = 1e-6, maxit = 50, startval = NULL,
      X.disp = NULL, disp = NULL, link.disp = "log", 
      weights = NULL, fix.disp = NULL, offset = NULL, 
      sparse = TRUE, vcovmat = FALSE, calc.like = FALSE, 
      RandC = NULL, bigRR = FALSE, verbose = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hglm2_+3A_meanmodel">meanmodel</code></td>
<td>
<p><code>formula</code>. A two sided formula specifying the fixed and random terms in <code>lme4</code> convention, e.g. <code>y ~ x1 + (1|id)</code> indicates <code>y</code> as response, <code>x1</code> as the fixed effect and <code>(1|id)</code> represent a random intercept for each level of <code>id</code>.</p>
</td></tr>
<tr><td><code id="hglm2_+3A_data">data</code></td>
<td>
<p><code>data.frame</code>. An optional data frame from where the variables in the <code>meanmodel</code> (and possibly <code>disp</code>) are to be obtained. It is expected that the data frame does not contain any missing value.</p>
</td></tr>
<tr><td><code id="hglm2_+3A_family">family</code></td>
<td>
<p><code>family</code>. The description of the error distribution and link function to be used in the mean part of the model. (See <code><a href="stats.html#topic+family">family</a></code> for details of family functions.)</p>
</td></tr>
<tr><td><code id="hglm2_+3A_rand.family">rand.family</code></td>
<td>
<p><code>family</code>. The description of the distribution and link function to be used for the random effect.</p>
</td></tr>
<tr><td><code id="hglm2_+3A_method">method</code></td>
<td>
<p><code>character</code>. Estimation method where <code>EQL</code> is the method of interconnected GLMs presented in Lee et al (2006). Apart from the default option <code>EQL</code> there is also an <code>EQL1</code> option, which improves estimation for GLMMs (especially for Poisson models with a large number of levels in the random effects).</p>
</td></tr>
<tr><td><code id="hglm2_+3A_conv">conv</code></td>
<td>
<p><code>numeric</code>. The convergence criteria (change in linear predictor between iterations).</p>
</td></tr>
<tr><td><code id="hglm2_+3A_maxit">maxit</code></td>
<td>
<p><code>numeric</code>. Maximum number of iterations in the <code>hglm</code> algorithm.</p>
</td></tr>
<tr><td><code id="hglm2_+3A_startval">startval</code></td>
<td>
<p><code>numeric</code>. A vector of starting values in the following order: fixed effects, random effect, variance of random effects, variance of residuals.</p>
</td></tr>
<tr><td><code id="hglm2_+3A_x.disp">X.disp</code></td>
<td>
<p><code>matrix</code>. The design matrix for the fixed effects in the dispersion part of the model.</p>
</td></tr>
<tr><td><code id="hglm2_+3A_disp">disp</code></td>
<td>
<p><code>formula</code>. A one-sided <code><a href="stats.html#topic+formula">formula</a></code> specifying the fixed effects in the dispersion part of the model.</p>
</td></tr>
<tr><td><code id="hglm2_+3A_link.disp">link.disp</code></td>
<td>
<p><code>character</code>. The link function for the dispersion part of the model.</p>
</td></tr>
<tr><td><code id="hglm2_+3A_weights">weights</code></td>
<td>
<p><code>numeric</code>. Prior weights to be specified in weighted regression.</p>
</td></tr>
<tr><td><code id="hglm2_+3A_fix.disp">fix.disp</code></td>
<td>
<p><code>numeric</code>. A numeric value if the dispersion parameter of the mean model is known, e.g., 1 for binomial and Poisson model.</p>
</td></tr>
<tr><td><code id="hglm2_+3A_offset">offset</code></td>
<td>
<p>An offset for the linear predictor of the mean model.</p>
</td></tr>
<tr><td><code id="hglm2_+3A_sparse">sparse</code></td>
<td>
<p><code>logical</code>. If <code>TRUE</code>, the computation is to be carried out by using sparse matrix technique.</p>
</td></tr>
<tr><td><code id="hglm2_+3A_vcovmat">vcovmat</code></td>
<td>
<p>logical. If <code>TRUE</code>, the variance-covariance matrix is exported.</p>
</td></tr>
<tr><td><code id="hglm2_+3A_calc.like">calc.like</code></td>
<td>
<p>logical. If <code>TRUE</code>, likelihoods will be computed at convergence and will be shown via the print or summary methods on the output object.</p>
</td></tr>
<tr><td><code id="hglm2_+3A_randc">RandC</code></td>
<td>
<p><code>numeric</code>. Necessary in old versions but can be neglected now. Integers (possibly a vector) specifying the number of column of Z to be used for each of the random-effect terms. </p>
</td></tr>
<tr><td><code id="hglm2_+3A_bigrr">bigRR</code></td>
<td>
<p>logical. If <code>TRUE</code>, and only for the Gaussian model with one random effect term, a specific algorithm will be used for fast fitting high-dimensional (p &gt;&gt; n) problems. See Shen et al. (2013) for more details of the method.</p>
</td></tr>
<tr><td><code id="hglm2_+3A_verbose">verbose</code></td>
<td>
<p>logical. If <code>TRUE</code>, more information is printed during model fitting process.</p>
</td></tr>
<tr><td><code id="hglm2_+3A_...">...</code></td>
<td>
<p>not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Models for <code>hglm</code> are either specified symbolically using <code><a href="stats.html#topic+formula">formula</a></code> 
or by specifying the design matrices ( <code>X</code>, <code>Z</code> and <code>X.disp</code>). Currently, only the extended quasi likelihood (EQL)
method is available for the estimation of the model parameters. Only for the Gaussian-Gaussina linear mixed models, it
is REML. It should be noted that the EQL estimator can be biased and inconsistent in some special cases e.g. binary pair matched response. A higher order correction 
might be useful to correct the bias of EQL (Lee et al. 2006). But, those currections are not implemented in the current version. By default, the dispersion
parameter is always estimated via EQL. If the dispersion parameter of the mean model is to be held constant, for example if it is
desired to be 1 for binomial and Poisson family, then <code>fix.disp</code>=value where, value=1 for the above example, should be used. 
</p>


<h3>Value</h3>

<p>It returns an object of class <code>hglm</code> consiting of the following values.
</p>
<table role = "presentation">
<tr><td><code>fixef</code></td>
<td>
<p>fixed effect estimates.</p>
</td></tr>
<tr><td><code>ranef</code></td>
<td>
<p>random effect estimates.</p>
</td></tr>
<tr><td><code>RandC</code></td>
<td>
<p>integers (possibly a vector) specified the number of column of Z to be used for each of the random-effect terms.</p>
</td></tr>
<tr><td><code>varFix</code></td>
<td>
<p>dispersion parameter of the mean model (residual variance for LMM).</p>
</td></tr>
<tr><td><code>varRanef</code></td>
<td>
<p>dispersion parameter of the random effects (variance of random effects for GLMM).</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p>number of iterations used.</p>
</td></tr>
<tr><td><code>Converge</code></td>
<td>
<p>specifies if the algorithm converged.</p>
</td></tr>
<tr><td><code>SeFe</code></td>
<td>
<p>standard errors of fixed effects.</p>
</td></tr>
<tr><td><code>SeRe</code></td>
<td>
<p>standard errors of random effects.</p>
</td></tr>
<tr><td><code>dfReFe</code></td>
<td>
<p>deviance degrees of freedom for the mean part of the model.</p>
</td></tr>
<tr><td><code>SummVC1</code></td>
<td>
<p>estimates and standard errors of the linear predictor in the dispersion model.</p>
</td></tr>
<tr><td><code>SummVC2</code></td>
<td>
<p>estimates and standard errors of the linear predictor for the dispersion parameter of the random effects.</p>
</td></tr>
<tr><td><code>dev</code></td>
<td>
<p>individual deviances for the mean part of the model.</p>
</td></tr>
<tr><td><code>hv</code></td>
<td>
<p>hatvalues for the mean part of the model.</p>
</td></tr>
<tr><td><code>resid</code></td>
<td>
<p>studentized residuals for the mean part of the model.</p>
</td></tr>
<tr><td><code>fv</code></td>
<td>
<p>fitted values for the mean part of the model.</p>
</td></tr>
<tr><td><code>disp.fv</code></td>
<td>
<p>fitted values for the dispersion part of the model.</p>
</td></tr>
<tr><td><code>disp.resid</code></td>
<td>
<p>standardized deviance residuals for the dispersion part of the model.</p>
</td></tr>
<tr><td><code>link.disp</code></td>
<td>
<p>link function for the dispersion part of the model.</p>
</td></tr>
<tr><td><code>vcov</code></td>
<td>
<p>the variance-covariance matrix.</p>
</td></tr>
<tr><td><code>likelihood</code></td>
<td>
<p>a list of log-likelihood values for model selection purposes, where <code>$hlik</code> is -2 times the log-h-likelihood, <code>$pvh</code> -2 times the adjusted profile log-likelihood profiled over random effects, <code>$pbvh</code> -2 times the adjusted profile log-likelihood profiled over fixed and random effects, and <code>$cAIC</code> the conditional AIC.</p>
</td></tr>
<tr><td><code>bad</code></td>
<td>
<p>the index of the influential observation.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Moudud Alam, Xia Shen, Lars Ronnegard</p>


<h3>References</h3>

<p>Lars Ronnegard, Xia Shen and Moudud Alam (2010). <b>hglm: A Package for Fitting Hierarchical Generalized Linear Models</b>. <em>The R Journal</em>, <b>2</b>(2), 20-28.<br /><br />
</p>
<p>Youngjo Lee, John A Nelder and Yudi Pawitan (2006) <em>Generalized Linear Models with Random Effect: a unified analysis via h-likelihood.</em> Chapman and Hall/CRC.<br /><br />
</p>
<p>Xia Shen, Moudud Alam, Freddy Fikse and Lars Ronnegard (2013). <b>A novel generalized ridge regression method for quantitative genetics</b>. <em>Genetics</em>.<br /><br />
</p>
<p>Moudud Alam, Lars Ronnegard, Xia Shen (2014). <b>Fitting conditional and simultaneous autoregressive spatial models in hglm</b>. <em>Submitted</em>.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+hglm">hglm</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># Find more examples and instructions in the package vignette:
# vignette('hglm')

require(hglm)

# --------------------- #
# semiconductor example #
# --------------------- #

data(semiconductor)

m11 &lt;- hglm(fixed = y ~ x1 + x3 + x5 + x6,
            random = ~ 1|Device,
            family = Gamma(link = log),
            disp = ~ x2 + x3, data = semiconductor)
summary(m11)
plot(m11, cex = .6, pch = 1,
     cex.axis = 1/.6, cex.lab = 1/.6,
     cex.main = 1/.6, mar = c(3, 4.5, 0, 1.5))

# ------------------- #
# redo it using hglm2 #
# ------------------- #

m12 &lt;- hglm2(y ~ x1 + x3 + x5 + x6 + (1|Device),
             family = Gamma(link = log),
             disp = ~ x2 + x3, data = semiconductor)
summary(m12)
     
# -------------------------- #
# redo it using matrix input #
# -------------------------- #

attach(semiconductor)
m13 &lt;- hglm(y = y, X = model.matrix(~ x1 + x3 + x5 + x6),
            Z = kronecker(diag(16), rep(1, 4)),
            X.disp = model.matrix(~ x2 + x3), 
            family = Gamma(link = log))
summary(m13)
     
# --------------------- #
# verbose &amp; likelihoods #
# --------------------- #
     
m14 &lt;- hglm(fixed = y ~ x1 + x3 + x5 + x6,
            random = ~ 1|Device,
            family = Gamma(link = log),
            disp = ~ x2 + x3, data = semiconductor,
            verbose = TRUE, calc.like = TRUE)
summary(m14)

# --------------------------------------------- #  
# simulated example with 2 random effects terms #
# --------------------------------------------- #  
## Not run: 
set.seed(911)
x1 &lt;- rnorm(100)
x2 &lt;- rnorm(100)
x3 &lt;- rnorm(100)
z1 &lt;- factor(rep(LETTERS[1:10], rep(10, 10)))
z2 &lt;- factor(rep(letters[1:5], rep(20, 5)))
Z1 &lt;- model.matrix(~ 0 + z1)
Z2 &lt;- model.matrix(~ 0 + z2)
u1 &lt;- rnorm(10, 0, sqrt(2))
u2 &lt;- rnorm(5, 0, sqrt(3))
y &lt;- 1 + 2*x1 + 3*x2 + Z1%*%u1 + Z2%*%u2 + rnorm(100, 0, sqrt(exp(x3)))
dd &lt;- data.frame(x1 = x1, x2 = x2, x3 = x3, z1 = z1, z2 = z2, y = y)

(m21 &lt;- hglm(X = cbind(rep(1, 100), x1, x2), y = y, Z = cbind(Z1, Z2), 
              RandC = c(10, 5)))
summary(m21)
plot(m21)

(m22 &lt;- hglm2(y ~ x1 + x2 + (1|z1) + (1|z2), data = dd, vcovmat = TRUE))
image(m22$vcov, main = 'Variance-covariance Matrix')
summary(m22)
plot(m22)

m31 &lt;- hglm2(y ~ x1 + x2 + (1|z1) + (1|z2), disp = ~ x3, data = dd)
print (m31)
summary(m31)
plot(m31)

## End(Not run)
</code></pre>

<hr>
<h2 id='inverse.gamma'>Inverse Gamma Family</h2><span id='topic+inverse.gamma'></span>

<h3>Description</h3>

<p>A function used in the <code>hglm</code> package for the inverse Gamma family.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>inverse.gamma(link="inverse")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="inverse.gamma_+3A_link">link</code></td>
<td>
<p>Link function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Output as for other GLM families 
</p>

<hr>
<h2 id='inverse.sqrt'>Inverse Square Root Family</h2><span id='topic+inverse.sqrt'></span>

<h3>Description</h3>

<p>A function used in the <code>hglm</code> package for the inverse square root family.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>inverse.sqrt()
</code></pre>


<h3>Value</h3>

<p>Output as for other GLM families 
</p>

<hr>
<h2 id='logLik.hglm'>Extracts log-likelihood values</h2><span id='topic+logLik.hglm'></span><span id='topic+logLik'></span>

<h3>Description</h3>

<p>Extracts log-likelihood values from an existing hglm object <code>hglm.obj</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'hglm'
logLik(object, REML=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="logLik.hglm_+3A_object">object</code></td>
<td>
<p>A fitted <code>hglm</code> object.</p>
</td></tr>
<tr><td><code id="logLik.hglm_+3A_reml">REML</code></td>
<td>
<p>The default NULL returns all computed log-likelihoods. The option <code>REML=TRUE</code> returns only the adjusted profile log-likelihood profiled over fixed and random effects.</p>
</td></tr>
<tr><td><code id="logLik.hglm_+3A_...">...</code></td>
<td>
<p>This argument is not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The use of log-likelihoods and cAIC is described in Lee, Nelder and Pawitan (2006).
</p>


<h3>Value</h3>

<p>A list of log-likelihood values for model selection purposes, where $hlik is the log-h-likelihood, $pvh the adjusted profile log-likelihood profiled over random effects, $pbvh the adjusted profile log-likelihood profiled over fixed and random effects, and $cAIC the conditional AIC.
</p>


<h3>References</h3>

<p>Youngjo Lee, John A Nelder and Yudi Pawitan (2006) <em>Generalized Linear Models with Random Effect: a unified analysis via h-likelihood.</em> Chapman and Hall/CRC.
</p>

<hr>
<h2 id='lrt'>Likelihood-ratio test for variance components in <code>hglm</code></h2><span id='topic+lrt'></span>

<h3>Description</h3>

<p>Likelihood-ratio test for the estimated variance components (or other dipersion parameters) in <code>hglm</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lrt(hglm.obj1, hglm.obj2 = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lrt_+3A_hglm.obj1">hglm.obj1</code></td>
<td>
<p>a fitted <code>hglm</code> object.</p>
</td></tr>
<tr><td><code id="lrt_+3A_hglm.obj2">hglm.obj2</code></td>
<td>
<p>optional, another fitted <code>hglm</code> object to be tested against <code>hglm.obj1</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When <code>hglm.obj2 = NULL</code>, all the random effects variance components in <code>hglm.obj1</code> are tested against
the null model with only fixed effects. The degree of freedom is determined by comparing the number of random
effects terms in <code>hglm.obj1</code> and <code>hglm.obj2</code> or the null fixed-effects-only model. Note that the likelihood-
ratio test statistic for variance estimates, which are bounded above zero, follows a 50:50 mixture distribution
of chi-square with 0 and 1 degree of freedom (Self and Liang 1987 JASA).
</p>


<h3>Value</h3>

<p>Printout summary of the likelihood-ratio test results. Test statistic, p-value, etc. are returned.
</p>


<h3>References</h3>

<p>Self, S. G., &amp; Liang, K.-Y. (1987). Asymptotic Properties of Maximum Likelihood Estimators and Likelihood Ratio Tests Under Nonstandard Conditions. <em>Journal of the American Statistical Association</em>, <b>82</b>(398), 605-610.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(hglm)

## Not run: 
set.seed(911)
x1 &lt;- rnorm(100)
x2 &lt;- rnorm(100)
x3 &lt;- rnorm(100)
z1 &lt;- factor(rep(LETTERS[1:10], rep(10, 10)))
z2 &lt;- factor(rep(letters[1:5], rep(20, 5)))
Z1 &lt;- model.matrix(~ 0 + z1)
Z2 &lt;- model.matrix(~ 0 + z2)
u1 &lt;- rnorm(10, 0, sqrt(2))
u2 &lt;- rnorm(5, 0, sqrt(3))
y &lt;- 1 + 2*x1 + 3*x2 + Z1%*%u1 + Z2%*%u2 + rnorm(100, 0, sqrt(exp(x3)))
dd &lt;- data.frame(x1 = x1, x2 = x2, x3 = x3, z1 = z1, z2 = z2, y = y)

m20 &lt;- hglm(X = cbind(rep(1, 100), x1, x2), y = y, Z = Z1, 
            calc.like = TRUE)

lrt(m20)
         
m21 &lt;- hglm(X = cbind(rep(1, 100), x1, x2), y = y, Z = cbind(Z1, Z2), 
             RandC = c(10, 5), calc.like = TRUE)

lrt(m20, m21)


## End(Not run)
</code></pre>

<hr>
<h2 id='plot.hglm'>Plot Hierarchical Generalized Linear Model Objects</h2><span id='topic+plot.hglm'></span><span id='topic+plot'></span>

<h3>Description</h3>

<p>Plots residuals for the mean and dispersion models, individual deviances and hatvalues for <code>hglm</code> objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'hglm'
plot(x, pch = "+", pcol = 'slateblue', lcol = 2, 
                    device = NULL, name = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.hglm_+3A_x">x</code></td>
<td>
<p>the <code>hglm</code> object to be plotted</p>
</td></tr>
<tr><td><code id="plot.hglm_+3A_pch">pch</code></td>
<td>
<p>symbol used in the plots</p>
</td></tr>
<tr><td><code id="plot.hglm_+3A_pcol">pcol</code></td>
<td>
<p>color of points</p>
</td></tr>
<tr><td><code id="plot.hglm_+3A_lcol">lcol</code></td>
<td>
<p>color of lines</p>
</td></tr>
<tr><td><code id="plot.hglm_+3A_device">device</code></td>
<td>
<p>if <code>NULL</code>, plot on screen devices, if <code>'pdf'</code>, plot to PDF files in the current working directory.</p>
</td></tr>
<tr><td><code id="plot.hglm_+3A_name">name</code></td>
<td>
<p>a string gives the main name of the PDF file when <code>device = 'pdf'</code>.</p>
</td></tr>
<tr><td><code id="plot.hglm_+3A_...">...</code></td>
<td>
<p>graphical parameters</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A S3 generic plot method for <code>hglm</code> objects. It produces a set of diagnostic plots for a hierarchical model.
</p>


<h3>Author(s)</h3>

<p>Xia Shen</p>


<h3>Examples</h3>

<pre><code class='language-R'># --------------------- #
# semiconductor example #
# --------------------- #

data(semiconductor)

h.gamma.normal &lt;- hglm(fixed = y ~ x1 + x3 + x5 + x6,
                       random = ~ 1|Device,
                       family = Gamma(link = log),
                       disp = ~ x2 + x3, data = semiconductor)
summary(h.gamma.normal)
plot(h.gamma.normal, cex = .6, pch = 1,
     cex.axis = 1/.6, cex.lab = 1/.6,
     cex.main = 1/.6, mar = c(3, 4.5, 0, 1.5))

# ------------------- #
# redo it using hglm2 #
# ------------------- #

m1 &lt;- hglm2(y ~ x1 + x3 + x5 + x6 + (1|Device),
            family = Gamma(link = log),
            disp = ~ x2 + x3, data = semiconductor)
summary(m1)
plot(m1, cex = .6, pch = 1,
     cex.axis = 1/.6, cex.lab = 1/.6,
     cex.main = 1/.6, mar = c(3, 4.5, 0, 1.5))

# --------------------------------------------- #  
# simulated example with 2 random effects terms #
# --------------------------------------------- #  
## Not run: 
set.seed(911)
x1 &lt;- rnorm(100)
x2 &lt;- rnorm(100)
x3 &lt;- rnorm(100)
z1 &lt;- factor(rep(LETTERS[1:10], rep(10, 10)))
z2 &lt;- factor(rep(letters[1:5], rep(20, 5)))
Z1 &lt;- model.matrix(~ 0 + z1)
Z2 &lt;- model.matrix(~ 0 + z2)
u1 &lt;- rnorm(10, 0, sqrt(2))
u2 &lt;- rnorm(5, 0, sqrt(3))
y &lt;- 1 + 2*x1 + 3*x2 + Z1%*%u1 + Z2%*%u2 + rnorm(100, 0, sqrt(exp(x3)))
dd &lt;- data.frame(x1 = x1, x2 = x2, x3 = x3, z1 = z1, z2 = z2, y = y)

(m2.1 &lt;- hglm(X = cbind(rep(1, 100), x1, x2), y = y, Z = cbind(Z1, Z2), 
              RandC = c(10, 5)))
summary(m2.1)
plot(m2.1)

(m2.2 &lt;- hglm2(y ~ x1 + x2 + (1|z1) + (1|z2), data = dd, vcovmat = TRUE))
image(m2.2$vcov)
summary(m2.2)
plot(m2.2)

m3 &lt;- hglm2(y ~ x1 + x2 + (1|z1) + (1|z2), disp = ~ x3, data = dd)
print (m3)
summary(m3)
plot(m3)

## End(Not run)
</code></pre>

<hr>
<h2 id='SAR'>Simultaneous Autoregressive Family</h2><span id='topic+SAR'></span>

<h3>Description</h3>

<p>A function used in the <code>hglm</code> package which extends the usage of the SAR family.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SAR(D, link = "identity", link.rand.disp = "inverse.sqrt")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SAR_+3A_d">D</code></td>
<td>
<p>the <b>D</b> matrix of the SAR model.</p>
</td></tr>
<tr><td><code id="SAR_+3A_link">link</code></td>
<td>
<p>the link function for the random effects.</p>
</td></tr>
<tr><td><code id="SAR_+3A_link.rand.disp">link.rand.disp</code></td>
<td>
<p>the link function for the random effects dispersion parameter.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Output specific for <code>hglm</code> fit, including eigen values and vectors of <b>D</b>.
</p>


<h3>References</h3>

<p>Moudud Alam, Lars Ronnegard, Xia Shen (2014). <b>Fitting conditional and simultaneous autoregressive spatial models in hglm</b>. <em>Submitted</em>.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
