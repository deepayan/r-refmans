<!DOCTYPE html><html><head><title>Help for package QF</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {QF}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#compute_MellinQF'><p>Mellin Transform of a Positive QF</p></a></li>
<li><a href='#compute_MellinQF_ratio'><p>Mellin Transform of the Independent Positive QFs Ratio</p></a></li>
<li><a href='#pQF_depratio'><p>Cumulative Distribution Function of the Dependent QFs Ratio</p></a></li>
<li><a href='#print.MellinQF'><p>Printing <code>MellinQF</code></p></a></li>
<li><a href='#print.MellinQF_ratio'><p>Print <code>MellinQF_ratio</code></p></a></li>
<li><a href='#QF'><p>Positive Definite Quadratic Forms Distribution</p></a></li>
<li><a href='#QF_ratio'><p>Ratio of Positive Definite Quadratic Forms Distribution</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Density, Cumulative and Quantile Functions of Quadratic Forms</td>
</tr>
<tr>
<td>Version:</td>
<td>0.0.6</td>
</tr>
<tr>
<td>Description:</td>
<td>The computation of quadratic form (QF) distributions is often not trivial and it requires numerical routines. The package contains functions aimed at evaluating the exact distribution of quadratic forms (QFs) and ratios of QFs. In particular, we propose to evaluate density, quantile and distribution functions of positive definite QFs and ratio of independent positive QFs by means of an algorithm based on the numerical inversion of Mellin transforms.  </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppGSL</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>GNU GSL</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-10-22</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-10-22 09:23:14 UTC; Acer</td>
</tr>
<tr>
<td>Author:</td>
<td>Aldo Gardini [aut, cre],
  Fedele Greco [aut],
  Carlo Trivisano [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Aldo Gardini &lt;aldo.gardini2@unibo.it&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-10-22 10:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='compute_MellinQF'>Mellin Transform of a Positive QF</h2><span id='topic+compute_MellinQF'></span>

<h3>Description</h3>

<p>The function computes the Mellin transform of a positive definite quadratic form producing a <code>MellinQF</code> object.
The output can be used to evaluate the density, cumulative and quantile functions of
the target quadratic form.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_MellinQF(
  lambdas,
  etas = rep(0, length(lambdas)),
  eps = 1e-06,
  rho = 1 - 1e-04,
  maxit_comp = 1e+05,
  eps_quant = 1e-06,
  maxit_quant = 10000,
  lambdas_tol = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compute_MellinQF_+3A_lambdas">lambdas</code></td>
<td>
<p>vector of positive weights.</p>
</td></tr>
<tr><td><code id="compute_MellinQF_+3A_etas">etas</code></td>
<td>
<p>vector of non-centrality parameters. Default all zeros (central chi square).</p>
</td></tr>
<tr><td><code id="compute_MellinQF_+3A_eps">eps</code></td>
<td>
<p>required absolute error for density and cumulative functions.</p>
</td></tr>
<tr><td><code id="compute_MellinQF_+3A_rho">rho</code></td>
<td>
<p>distribution total probability mass for which it is desired to keep the error <code>eps</code>.</p>
</td></tr>
<tr><td><code id="compute_MellinQF_+3A_maxit_comp">maxit_comp</code></td>
<td>
<p>maximum number of iterations.</p>
</td></tr>
<tr><td><code id="compute_MellinQF_+3A_eps_quant">eps_quant</code></td>
<td>
<p>required numerical error for quantile computation.</p>
</td></tr>
<tr><td><code id="compute_MellinQF_+3A_maxit_quant">maxit_quant</code></td>
<td>
<p>maximum number of iterations before stopping the quantile computation.</p>
</td></tr>
<tr><td><code id="compute_MellinQF_+3A_lambdas_tol">lambdas_tol</code></td>
<td>
<p>maximum value admitted for the weight skewness. When it is not NULL (default), elements of lambdas such that the ratio max(lambdas)/lambdas is greater than the specified value are removed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The quadratic form having positive weights <code>lambdas</code> and non-centrality parameters <code>etas</code> is considered:
</p>
<p style="text-align: center;"><code class="reqn">Q=\sum_{i=1}^r \lambda_i\chi^2_{1,\eta_i}. </code>
</p>

<p>Its Mellin transform is computed by exploiting the density formulation by Ruben (1962).
The numerical error is controlled in order to provide the requested precision (<code>eps</code>) for the
interval of quantiles that contains the specified total probability <code>rho</code>.
</p>
<p>The argument <code>eps_quant</code> controls the relative precision requested for the
computation of quantiles that determine the range in which the error <code>eps</code> is
guaranteed, whereas <code>maxit_quant</code> sets the maximum number of Newton-Raphson iterations of the algorithm.
</p>


<h3>Value</h3>

<p>The function returns an object of the class <code>MellinQF</code> that contains information on the Mellin transform
of a linear combination of positively weighted chi-square random variables. This information can be used in order to
evaluate the density, cumulative distribution and quantile functions.
</p>
<p>An object of the class <code>MellinQF</code> has the following components:
</p>

<ul>
<li> <p><code>range_q</code>: the range of quantiles that contains the specified mass of probability <code>rho</code> in which it
is possible to compute density and CDF preserving the error level <code>eps</code>.
</p>
</li>
<li> <p><code>Mellin</code>: a list containing the values of the Mellin transform (<code>Mellin</code>),
the corresponding evaluation points (<code>z</code>), the integration step <code>delta</code> and the lowest weight (<code>lambda_min</code>).
</p>
</li>
<li><p> the inputs <code>rho</code>, <code>lambdas</code>, <code>etas</code>, <code>eps</code> needed for CDF, PDF and quantile function computation.
</p>
</li></ul>



<h3>Source</h3>

<p>Ruben, Harold. &quot;Probability content of regions under spherical normal distributions, IV:
The distribution of homogeneous and non-homogeneous quadratic functions of normal variables.&quot;
The Annals of Mathematical Statistics 33.2 (1962): 542-570.
</p>


<h3>See Also</h3>

<p>The function <code><a href="#topic+print.MellinQF">print.MellinQF</a></code> can be used to summarize the basic information on the Mellin transform.
</p>
<p>The object can be used in the function <code><a href="#topic+dQF">dQF</a></code> to compute the density function of the QF,
<code><a href="#topic+pQF">pQF</a></code> for the CDF and <code><a href="#topic+qQF">qQF</a></code> for the quantile function.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

library(QF)
# Definition of the QF
lambdas_QF &lt;- c(rep(7, 6),rep(3, 2))
etas_QF &lt;- c(rep(6, 6), rep(2, 2))
# Computation Mellin transform
eps &lt;- 1e-7
rho &lt;- 0.999
Mellin &lt;- compute_MellinQF(lambdas_QF, etas_QF, eps = eps, rho = rho)
print(Mellin)



</code></pre>

<hr>
<h2 id='compute_MellinQF_ratio'>Mellin Transform of the Independent Positive QFs Ratio</h2><span id='topic+compute_MellinQF_ratio'></span>

<h3>Description</h3>

<p>The function computes the Mellin transform of the ratio of independent and positive definite quadratic forms producing a <code>MellinQF_ratio</code> object.
The output can be used to evaluate the density, cumulative and quantile functions of the target quadratic form.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_MellinQF_ratio(
  lambdas_num,
  lambdas_den,
  etas_num = rep(0, length(lambdas_num)),
  etas_den = rep(0, length(lambdas_den)),
  eps = 1e-06,
  rho = 1 - 1e-04,
  maxit_comp = 1e+05,
  eps_quant = 1e-06,
  maxit_quant = 10000,
  lambdas_tol = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compute_MellinQF_ratio_+3A_lambdas_num">lambdas_num</code></td>
<td>
<p>vector of positive weights for the numerator.</p>
</td></tr>
<tr><td><code id="compute_MellinQF_ratio_+3A_lambdas_den">lambdas_den</code></td>
<td>
<p>vector of positive weights for the denominator.</p>
</td></tr>
<tr><td><code id="compute_MellinQF_ratio_+3A_etas_num">etas_num</code></td>
<td>
<p>vector of non-centrality parameters for the numerator. Default all zeros (central chi square).</p>
</td></tr>
<tr><td><code id="compute_MellinQF_ratio_+3A_etas_den">etas_den</code></td>
<td>
<p>vector of non-centrality parameters for the denominator. Default all zeros (central chi square).</p>
</td></tr>
<tr><td><code id="compute_MellinQF_ratio_+3A_eps">eps</code></td>
<td>
<p>required absolute error for density and cumulative functions.</p>
</td></tr>
<tr><td><code id="compute_MellinQF_ratio_+3A_rho">rho</code></td>
<td>
<p>distribution total probability mass for which it is desired to keep the error <code>eps</code>.</p>
</td></tr>
<tr><td><code id="compute_MellinQF_ratio_+3A_maxit_comp">maxit_comp</code></td>
<td>
<p>maximum number of iterations.</p>
</td></tr>
<tr><td><code id="compute_MellinQF_ratio_+3A_eps_quant">eps_quant</code></td>
<td>
<p>required numerical error for quantile computation.</p>
</td></tr>
<tr><td><code id="compute_MellinQF_ratio_+3A_maxit_quant">maxit_quant</code></td>
<td>
<p>maximum number of iterations before stopping the quantile computation.</p>
</td></tr>
<tr><td><code id="compute_MellinQF_ratio_+3A_lambdas_tol">lambdas_tol</code></td>
<td>
<p>maximum value admitted for the weight skewness for both the numerator and the denominator. When it is not NULL (default), elements of lambdas such that the ratio max(lambdas)/lambdas is greater than the specified value are removed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Mellin transform of the ratio of two independent quadratic forms having positive weights <code>lambdas_num</code> and <code>lambdas_den</code>
and non-centrality parameters <code>etas_num</code> and <code>etas_den</code> is computed
exploiting the density formulation by Ruben (1962).  The numerical error is controlled in order to provide the requested precision (<code>eps</code>) for the
interval of quantiles that contains the specified total probability <code>rho</code>.
</p>
<p>The argument <code>eps_quant</code> controls the relative precision requested for the computation of quantiles that determine the range in which the error <code>eps</code> is
guaranteed, whereas <code>maxit_quant</code> sets the maximum number of Newton-Raphson iterations of the algorithm.
</p>


<h3>Value</h3>

<p>The function returns an object of the class <code>MellinQF_ratio</code> that contains information on the Mellin transform
of the ratio of two linear combinations of positively weighted chi-square random variables. This information can be used in order to
evaluate the density, cumulative distribution and quantile functions of the desired quadratic form.
</p>
<p>An object of the class <code>MellinQF_ratio</code> has the following components:
</p>

<ul>
<li> <p><code>range_q</code>: the range of quantiles that contains the specified mass of probability <code>rho</code> in which it
is possible to compute density and CDF preserving the error level <code>eps</code>.
</p>
</li>
<li> <p><code>Mellin</code>: a list containing the values of the Mellin transform (<code>Mellin</code>),
the corresponding evaluation points (<code>z</code>), the integration step <code>delta</code> and the lowest numerator weight (<code>lambda_min</code>).
</p>
</li>
<li><p> the inputs <code>rho</code>, <code>lambdas_num</code>, <code>lambdas_den</code>, <code>etas_num</code>, <code>etas_den</code>, <code>eps</code> needed for CDF, PDF and quantile function computation.
</p>
</li></ul>



<h3>Source</h3>

<p>Ruben, Harold. &quot;Probability content of regions under spherical normal distributions, IV:
The distribution of homogeneous and non-homogeneous quadratic functions of normal variables.&quot;
The Annals of Mathematical Statistics 33.2 (1962): 542-570.
</p>


<h3>See Also</h3>

<p>The function <code><a href="#topic+print.MellinQF_ratio">print.MellinQF_ratio</a></code> can be used to summarize the basic information on the Mellin transform.
</p>
<p>The object can be used in the function <code><a href="#topic+dQF_ratio">dQF_ratio</a></code> to compute the density function of the QFs ratio,
<code><a href="#topic+pQF_ratio">pQF_ratio</a></code> for the CDF and <code><a href="#topic+qQF_ratio">qQF_ratio</a></code> for the quantile function.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

library(QF)
# Definition of the QFs
lambdas_QF_num &lt;- c(rep(7, 6),rep(3, 2))
etas_QF_num &lt;- c(rep(6, 6), rep(2, 2))
lambdas_QF_den &lt;- c(0.6, 0.3, 0.1)
# Computation Mellin transform
eps &lt;- 1e-7
rho &lt;- 0.999
Mellin_ratio &lt;- compute_MellinQF_ratio(lambdas_QF_num, lambdas_QF_den,
                                       etas_QF_num, eps = eps, rho = rho)
print(Mellin_ratio)




</code></pre>

<hr>
<h2 id='pQF_depratio'>Cumulative Distribution Function of the Dependent QFs Ratio</h2><span id='topic+pQF_depratio'></span>

<h3>Description</h3>

<p>The function computes the CDF of the ratio of two dependent and possibly indefinite quadratic forms.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pQF_depratio(
  q = NULL,
  lambdas = NULL,
  A = NULL,
  B = NULL,
  eps = 1e-06,
  maxit_comp = 1e+05,
  lambdas_tol = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pQF_depratio_+3A_q">q</code></td>
<td>
<p>quantile.</p>
</td></tr>
<tr><td><code id="pQF_depratio_+3A_lambdas">lambdas</code></td>
<td>
<p>vector of eigenvalues of the matrix (A-qB).</p>
</td></tr>
<tr><td><code id="pQF_depratio_+3A_a">A</code></td>
<td>
<p>matrix of the numerator QF. If not specified but <code>B</code> is passed, it is assumed to be the identity.</p>
</td></tr>
<tr><td><code id="pQF_depratio_+3A_b">B</code></td>
<td>
<p>matrix of the numerator QF. If not specified but <code>A</code> is passed, it is assumed to be the identity.</p>
</td></tr>
<tr><td><code id="pQF_depratio_+3A_eps">eps</code></td>
<td>
<p>requested absolute error.</p>
</td></tr>
<tr><td><code id="pQF_depratio_+3A_maxit_comp">maxit_comp</code></td>
<td>
<p>maximum number of iterations.</p>
</td></tr>
<tr><td><code id="pQF_depratio_+3A_lambdas_tol">lambdas_tol</code></td>
<td>
<p>maximum value admitted for the weight skewness for both the numerator and the denominator. When it is not NULL (default), elements of lambdas such that the ratio max(lambdas)/lambdas is greater than the specified value are removed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The distribution function of the following ratio of dependent quadratic forms is computed:
</p>
<p style="text-align: center;"><code class="reqn">P\left(\frac{Y^TAY }{Y^TBY}&lt;q\right),</code>
</p>

<p>where <code class="reqn">Y\sim N(0, I)</code>.
</p>
<p>The transformation to the following indefinite quadratic form is exploited:
</p>
<p style="text-align: center;"><code class="reqn">P\left(Y^T(A-qB)Y &lt;0\right).</code>
</p>

<p>The following inputs can be provided:
</p>

<ul>
<li><p>vector <code>lambdas</code> that contains the eigenvalues of the matrix <code class="reqn">(A-qB)</code>. Input <code>q</code> is ignored.
</p>
</li>
<li><p>matrix <code>A</code> and/or matrix <code>B</code>: in these cases <code>q</code> is required to be not null and an eventual missing specification of one matrix make it equal to the identity.
</p>
</li></ul>



<h3>Value</h3>

<p>The values of the CDF at quantiles <code>q</code>.
</p>

<hr>
<h2 id='print.MellinQF'>Printing <code>MellinQF</code></h2><span id='topic+print.MellinQF'></span>

<h3>Description</h3>

<p>It allows to visualize useful information on the <code>MellinQF</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'MellinQF'
print(x, digits = 3L, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.MellinQF_+3A_x">x</code></td>
<td>
<p><code>MellinQF</code> object.</p>
</td></tr>
<tr><td><code id="print.MellinQF_+3A_digits">digits</code></td>
<td>
<p>number of digits to display in the output.</p>
</td></tr>
<tr><td><code id="print.MellinQF_+3A_...">...</code></td>
<td>
<p>potentially more arguments passed to methods.</p>
</td></tr>
</table>

<hr>
<h2 id='print.MellinQF_ratio'>Print <code>MellinQF_ratio</code></h2><span id='topic+print.MellinQF_ratio'></span>

<h3>Description</h3>

<p>It allows to visualize useful information on the <code>MellinQF_ratio</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'MellinQF_ratio'
print(x, digits = 3L, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.MellinQF_ratio_+3A_x">x</code></td>
<td>
<p><code>MellinQF_ratio</code> object.</p>
</td></tr>
<tr><td><code id="print.MellinQF_ratio_+3A_digits">digits</code></td>
<td>
<p>number of digits to display in the output.</p>
</td></tr>
<tr><td><code id="print.MellinQF_ratio_+3A_...">...</code></td>
<td>
<p>potentially more arguments passed to methods.</p>
</td></tr>
</table>

<hr>
<h2 id='QF'>Positive Definite Quadratic Forms Distribution</h2><span id='topic+QF'></span><span id='topic+dQF'></span><span id='topic+pQF'></span><span id='topic+qQF'></span><span id='topic+rQF'></span>

<h3>Description</h3>

<p>Density function, distribution function, quantile function and random generator for positive definite QFs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dQF(x, obj)

pQF(q, obj)

qQF(p, obj, eps_quant = 1e-06, maxit_quant = 10000)

rQF(n, lambdas, etas = rep(0, length(lambdas)))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="QF_+3A_x">x</code>, <code id="QF_+3A_q">q</code></td>
<td>
<p>vector of quantiles.</p>
</td></tr>
<tr><td><code id="QF_+3A_obj">obj</code></td>
<td>
<p><code>MellinQF</code> object produced by the <code><a href="#topic+compute_MellinQF">compute_MellinQF</a></code> function.</p>
</td></tr>
<tr><td><code id="QF_+3A_p">p</code></td>
<td>
<p>vector of probabilities.</p>
</td></tr>
<tr><td><code id="QF_+3A_eps_quant">eps_quant</code></td>
<td>
<p>relative error for quantiles.</p>
</td></tr>
<tr><td><code id="QF_+3A_maxit_quant">maxit_quant</code></td>
<td>
<p>maximum number of Newton-Raphson iterations allowed to compute quantiles.</p>
</td></tr>
<tr><td><code id="QF_+3A_n">n</code></td>
<td>
<p>number of observations.</p>
</td></tr>
<tr><td><code id="QF_+3A_lambdas">lambdas</code></td>
<td>
<p>vector of positive weights.</p>
</td></tr>
<tr><td><code id="QF_+3A_etas">etas</code></td>
<td>
<p>vector of non-centrality parameters. Default all zeros.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The quadratic form CDF and PDF are evaluated by numerical inversion of the Mellin transform.
The absolute error specified in <code><a href="#topic+compute_MellinQF">compute_MellinQF</a></code> is guaranteed for values of <code>q</code> and <code>x</code> inside the <code>range_q</code>.
If the quantile is outside <code>range_q</code>, computations are carried out, but a warning is sent.
</p>
<p>The function uses the Newton-Raphson algorithm to compute the QF quantiles related to probabilities <code>p</code>.
</p>


<h3>Value</h3>

<p><code>dQF</code> provides the values of the density function at a quantile <code>x</code>.
</p>
<p><code>pQF</code> provides the cumulative distribution function at a quantile <code>q</code>.
</p>
<p><code>qQF</code> provides the quantile corresponding to a probability level <code>p</code>.
</p>
<p><code>rQF</code> provides a sample of <code>n</code> independent realizations from the QF.
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+compute_MellinQF">compute_MellinQF</a></code> for details on the Mellin computation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(QF)
# Definition of the QF
lambdas_QF &lt;- c(rep(7, 6),rep(3, 2))
etas_QF &lt;- c(rep(6, 6), rep(2, 2))
# Computation Mellin transform
eps &lt;- 1e-7
rho &lt;- 0.999
Mellin &lt;- compute_MellinQF(lambdas_QF, etas_QF, eps = eps, rho = rho)
xs &lt;- seq(Mellin$range_q[1], Mellin$range_q[2], l = 100)
# PDF
ds &lt;- dQF(xs, Mellin)
plot(xs, ds, type="l")
# CDF
ps &lt;- pQF(xs, Mellin)
plot(xs, ps, type="l")
# Quantile
qs &lt;- qQF(ps, Mellin)
plot(ps, qs, type="l")
#Comparison computed quantiles vs real quantiles
plot((qs - xs) / xs, type = "l")



</code></pre>

<hr>
<h2 id='QF_ratio'>Ratio of Positive Definite Quadratic Forms Distribution</h2><span id='topic+QF_ratio'></span><span id='topic+dQF_ratio'></span><span id='topic+pQF_ratio'></span><span id='topic+qQF_ratio'></span><span id='topic+rQF_ratio'></span>

<h3>Description</h3>

<p>Density function, distribution function, quantile function and random generator for the ratio of positive definite QFs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dQF_ratio(x, obj)

pQF_ratio(q, obj)

qQF_ratio(p, obj, eps_quant = 1e-06, maxit_quant = 10000)

rQF_ratio(
  n,
  lambdas_num,
  lambdas_den,
  etas_num = rep(0, length(lambdas_num)),
  etas_den = rep(0, length(lambdas_den))
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="QF_ratio_+3A_x">x</code>, <code id="QF_ratio_+3A_q">q</code></td>
<td>
<p>vector of quantiles.</p>
</td></tr>
<tr><td><code id="QF_ratio_+3A_obj">obj</code></td>
<td>
<p><code>MellinQF_ratio</code> object produced by the <code><a href="#topic+compute_MellinQF_ratio">compute_MellinQF_ratio</a></code> function.</p>
</td></tr>
<tr><td><code id="QF_ratio_+3A_p">p</code></td>
<td>
<p>vector of probabilities.</p>
</td></tr>
<tr><td><code id="QF_ratio_+3A_eps_quant">eps_quant</code></td>
<td>
<p>relative error for quantiles.</p>
</td></tr>
<tr><td><code id="QF_ratio_+3A_maxit_quant">maxit_quant</code></td>
<td>
<p>maximum number of Newton-Raphson iterations allowed to compute quantiles.</p>
</td></tr>
<tr><td><code id="QF_ratio_+3A_n">n</code></td>
<td>
<p>number of observations.</p>
</td></tr>
<tr><td><code id="QF_ratio_+3A_lambdas_num">lambdas_num</code></td>
<td>
<p>vector of positive weights of the QF at the numerator.</p>
</td></tr>
<tr><td><code id="QF_ratio_+3A_lambdas_den">lambdas_den</code></td>
<td>
<p>vector of positive weights of the QF at the denominator</p>
</td></tr>
<tr><td><code id="QF_ratio_+3A_etas_num">etas_num</code></td>
<td>
<p>vector of non-centrality parameters of the QF at the numerator. Default all zeros.</p>
</td></tr>
<tr><td><code id="QF_ratio_+3A_etas_den">etas_den</code></td>
<td>
<p>vector of non-centrality parameters of the QF at the denominator Default all zeros.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The CDF and PDF of the ratio of positive QFs are evaluated by numerical inversion of the Mellin transform.
The absolute error specified in <code><a href="#topic+compute_MellinQF_ratio">compute_MellinQF_ratio</a></code> is guaranteed for values of <code>q</code> and <code>x</code> inside <code>range_q</code>.
If the quantile is outside <code>range_q</code>, computations are carried out, but a warning is sent.
</p>
<p>The function uses the Newton-Raphson algorithm to compute the ratio of QFs quantiles related to probabilities <code>p</code>.
</p>


<h3>Value</h3>

<p><code>dQF_ratio</code> provides the values of the density function at a quantile <code>x</code>.
</p>
<p><code>pQF_ratio</code> provides the cumulative distribution function at a quantile <code>q</code>.
</p>
<p><code>qQF_ratio</code> provides the quantile corresponding to a probability level <code>p</code>.
</p>
<p><code>rQF_ratio</code> provides a sample of <code>n</code> independent realizations the QFs ratio.
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+compute_MellinQF_ratio">compute_MellinQF_ratio</a></code> for details on the Mellin computation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
lambdas_QF_num &lt;- c(rep(7, 6),rep(3, 2))
etas_QF_num &lt;- c(rep(6, 6), rep(2, 2))
lambdas_QF_den &lt;- c(0.6, 0.3, 0.1)
# Computation Mellin transform
eps &lt;- 1e-7
rho &lt;- 0.999
Mellin_ratio &lt;- compute_MellinQF_ratio(lambdas_QF_num, lambdas_QF_den,
                                       etas_QF_num, eps = eps, rho = rho)
xs &lt;- seq(Mellin_ratio$range_q[1], Mellin_ratio$range_q[2], l = 100)
# PDF
ds &lt;- dQF_ratio(xs, Mellin_ratio)
plot(xs, ds, type="l")
# CDF
ps &lt;- pQF_ratio(xs, Mellin_ratio)
plot(xs, ps, type="l")
# Quantile
qs &lt;- qQF_ratio(ps, Mellin_ratio)
plot(ps, qs, type="l")
#Comparison computed quantiles vs real quantiles
plot((qs - xs) / xs, type = "l")



</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
