<!DOCTYPE html><html><head><title>Help for package RARfreq</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {RARfreq}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#DBCD_BINARY'><p>Doubly Adaptive Biased Coin Design (Binary Responses)</p></a></li>
<li><a href='#DBCD_BINARY_raw'><p>Doubly Adaptive Biased Coin Design (Binary Data Frame)</p></a></li>
<li><a href='#DBCD_GAUSSIAN'><p>Doubly Adaptive Biased Coin Design (Gaussian Responses)</p></a></li>
<li><a href='#DBCD_GAUSSIAN_raw'><p>Doubly Adaptive Biased Coin Design (Gaussian Responses)</p></a></li>
<li><a href='#power_comparison_Power_vs_n'><p>Comparison of Powers for Different Tests under Different DBCD Randomization</p>
Methods (Binary Responses)</a></li>
<li><a href='#power_comparison_Power_vs_n_GAUSSIAN'><p>Comparison of Powers for Different Tests under Different DBCD Randomization</p>
Methods (Gaussian Responses)</a></li>
<li><a href='#power_comparison_Power_vs_Trt'><p>Comparison of Powers for Treatment Effects under Different DBCD Randomization</p>
Methods (Binary Responses)</a></li>
<li><a href='#power_comparison_Power_vs_Trt_GAUSSIAN'><p>Comparison of Powers for Treatment Effects under Different DBCD Randomization</p>
methods (Gaussian Responses)</a></li>
<li><a href='#SEU_BINARY_raw'><p>Sequential Estimation-adjusted Urn Model (Binary Data)</p></a></li>
<li><a href='#SEU_GAUSSIAN_raw'><p>Sequential Estimation-adjusted Urn Model (Gaussian Responses)</p></a></li>
<li><a href='#SEU_power_comparison_Power_vs_n'><p>Comparison of Powers for Sample Sizes under Different SEU Randomization</p>
Methods (Binary Responses)</a></li>
<li><a href='#SEU_power_comparison_Power_vs_n_GAUSSIAN'><p>Comparison of Powers for Sample Sizes under Different SEU Randomization</p>
Methods (Gaussian Responses)</a></li>
<li><a href='#SEU_power_comparison_Power_vs_Trt'><p>Comparison of Powers for Treatment Effects under Different SEU Randomization</p>
Methods (Binary Responses)</a></li>
<li><a href='#SEU_power_comparison_Power_vs_Trt_GAUSSIAN'><p>Comparison of Powers for Treatment Effects under Different SEU Randomization</p>
Methods (Gaussian Responses)</a></li>
<li><a href='#SEU_simulation_main'><p>Sequential Estimation-adjusted Urn Model with Simulated Data (Binary Data)</p></a></li>
<li><a href='#SEU_simulation_main_GAUSSIAN'><p>Sequential Estimation-adjusted Urn Model with Simulated Data (Gaussian</p>
Responses)</a></li>
<li><a href='#simulation_main'><p>Doubly Adaptive Biased Coin Design with Simulated Data (Binary Responses)</p></a></li>
<li><a href='#simulation_main_GAUSSIAN'><p>Doubly Adaptive Biased Coin Design with Simulated Data (Gaussian Responses)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Response Adaptive Randomization with 'Frequentist' Approaches</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.4</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides functions and command-line user interface to generate allocation sequence 
             by response-adaptive randomization for clinical trials. The package currently supports 
             two families of frequentist response-adaptive randomization procedures, Doubly Adaptive 
             Biased Coin Design ('DBCD') and Sequential Estimation-adjusted Urn Model ('SEU'), for 
             binary and normal endpoints. One-sided proportion (or mean) difference and Chi-square 
             (or 'ANOVA') hypothesis testing methods are also available in the package to  facilitate 
             the inference for treatment effect. Additionally, the package provides comprehensive and 
             efficient tools to allow one to evaluate and  compare the performance of randomization 
             procedures and tests based on various criteria. For example, plots for relationship among 
             assumed treatment effects,  sample size, and power are provided. Five allocation functions 
             for 'DBCD' and six addition rule functions for 'SEU' are implemented to target allocations 
             such as 'Neyman', 'Rosenberger' Rosenberger et al. (2001) 
             &lt;<a href="https://doi.org/10.1111%2Fj.0006-341X.2001.00909.x">doi:10.1111/j.0006-341X.2001.00909.x</a>&gt; and 'Urn' allocations.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, ggplot2, latex2exp, magrittr, patchwork, stats, tidyr,
data.table, reshape2, Rdpack</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>Rdpack</td>
</tr>
<tr>
<td>Suggests:</td>
<td>spelling, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-04-04 03:17:31 UTC; huangxx6</td>
</tr>
<tr>
<td>Author:</td>
<td>Mengjia Yu [aut],
  Xiu Huang [aut, cre],
  Feifang Hu [aut],
  Li Wang [aut],
  Hongjian Zhu [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Xiu Huang &lt;xiu.huang@aya.yale.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-04-04 15:00:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='DBCD_BINARY'>Doubly Adaptive Biased Coin Design (Binary Responses)</h2><span id='topic+DBCD_BINARY'></span>

<h3>Description</h3>

<p>Allocates patients to one of treatments based on doubly adaptive
biased coin design on summary level data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DBCD_BINARY(S_RK, N_RK, group_allo, rho_func_index, rho_func, alpha)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DBCD_BINARY_+3A_s_rk">S_RK</code></td>
<td>
<p>A vector of current success rates for each treatment arm.</p>
</td></tr>
<tr><td><code id="DBCD_BINARY_+3A_n_rk">N_RK</code></td>
<td>
<p>A vector of current enrolled subjects in each arm. The length
must be the same as 'S_RK'.</p>
</td></tr>
<tr><td><code id="DBCD_BINARY_+3A_group_allo">group_allo</code></td>
<td>
<p>An integer of the size of group allocation. The default is
1.</p>
</td></tr>
<tr><td><code id="DBCD_BINARY_+3A_rho_func_index">rho_func_index</code></td>
<td>
<p>Supply a number of 1, 2 or 3 indicting the
allocation function to use.
1 = Wei's allocation;
2 = Neyman allocation;
3 = Rosenberger allocation.
The default is 3.</p>
</td></tr>
<tr><td><code id="DBCD_BINARY_+3A_rho_func">rho_func</code></td>
<td>
<p>Supply a user-specified allocation function of S_RK when
rho_func_index is NULL. Default is NULL.</p>
</td></tr>
<tr><td><code id="DBCD_BINARY_+3A_alpha">alpha</code></td>
<td>
<p>Supply a number indicating the subscripts of the probability
function. The default is 2.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>'DBCD_BINARY' assigns the next subject to a group given the observed
success rates, enrolled subjects and allocation function.
</p>


<h3>Value</h3>

<p>Number of the arm that the next subject is assigned to.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># There are 3 arms each of which receives 25 patients.
# The observed response rates are 40%, 28% and 60%, respectively.
# The following command returns the number of arm that the next patient will
# be assigned to.
DBCD_BINARY(S_RK = c(0.4, 0.28, 0.6),
            N_RK = c(25, 25, 25),
            rho_func_index = 3, alpha=2)

# Urn allocation
DBCD_BINARY(S_RK = c(0.4, 0.3),
            N_RK = c(25, 25),
            group_allo = 1,
            rho_func_index = NULL,
            rho_func = function(x) rev(1-x)/sum(1-x),
            alpha=2)

</code></pre>

<hr>
<h2 id='DBCD_BINARY_raw'>Doubly Adaptive Biased Coin Design (Binary Data Frame)</h2><span id='topic+DBCD_BINARY_raw'></span>

<h3>Description</h3>

<p>Allocates patients to one of treatments based on doubly adaptive
biased coin design on individual data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DBCD_BINARY_raw(X.df, group_allo, rho_func_index, rho_func, alpha)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DBCD_BINARY_raw_+3A_x.df">X.df</code></td>
<td>
<p>A data frame of two columns: treatment arm and response value.</p>
</td></tr>
<tr><td><code id="DBCD_BINARY_raw_+3A_group_allo">group_allo</code></td>
<td>
<p>An integer of the size of group allocation. The default is
1.</p>
</td></tr>
<tr><td><code id="DBCD_BINARY_raw_+3A_rho_func_index">rho_func_index</code></td>
<td>
<p>Supply a number of 1, 2 or 3 indicting the
allocation function to use.
1 = Wei's allocation
2 = Neyman allocation;
3 = Rosenberger allocation.
The default is 3.</p>
</td></tr>
<tr><td><code id="DBCD_BINARY_raw_+3A_rho_func">rho_func</code></td>
<td>
<p>Supply a user-specified allocation function of sample
response rates when rho_func_index is NULL. Default is NULL.</p>
</td></tr>
<tr><td><code id="DBCD_BINARY_raw_+3A_alpha">alpha</code></td>
<td>
<p>Supply a number indicating the subscripts of the probability
function. The default is 2.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>'DBCD_BINARY_raw' assigns the next subject to a group given the
observed success rates, enrolled subjects and allocation function.
</p>


<h3>Value</h3>

<p>Code of the arm that the next subject is assigned to.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X.df = data.frame(
ARM = sample(LETTERS[1:3],50,replace = TRUE),
RESPONSE = sample(c(0,1),50,replace = TRUE)
)
DBCD_BINARY_raw(X.df, rho_func_index = 3, alpha=2)

X.df = data.frame(
ARM = sample(LETTERS[1:2],40,replace = TRUE),
RESPONSE = sample(c(0,1),40,replace = TRUE)
)
DBCD_BINARY_raw(
X.df, rho_func_index = NULL,
rho_func = function(x) rev(1-x)/sum(1-x), alpha=2
)

</code></pre>

<hr>
<h2 id='DBCD_GAUSSIAN'>Doubly Adaptive Biased Coin Design (Gaussian Responses)</h2><span id='topic+DBCD_GAUSSIAN'></span>

<h3>Description</h3>

<p>Allocates patients to one of treatments based on doubly adaptive
biased coin design on summarized data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DBCD_GAUSSIAN(Mean_RK,SD_RK, N_RK, group_allo, rho_func_index,
rho_func, alpha)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DBCD_GAUSSIAN_+3A_mean_rk">Mean_RK</code></td>
<td>
<p>A vector of current response means for each treatment arm.</p>
</td></tr>
<tr><td><code id="DBCD_GAUSSIAN_+3A_sd_rk">SD_RK</code></td>
<td>
<p>A vector of current response standard deviations for each
treatment arm.</p>
</td></tr>
<tr><td><code id="DBCD_GAUSSIAN_+3A_n_rk">N_RK</code></td>
<td>
<p>A vector of current enrolled subjects in each arm. The length
must be the same as 'Mean_RK'.</p>
</td></tr>
<tr><td><code id="DBCD_GAUSSIAN_+3A_group_allo">group_allo</code></td>
<td>
<p>An integer of the size of group allocation. The default is
1.</p>
</td></tr>
<tr><td><code id="DBCD_GAUSSIAN_+3A_rho_func_index">rho_func_index</code></td>
<td>
<p>Supply a number of 1 or 2 indicting the
allocation function to use.
1 = Zhang-Rosenberger allocation;
2 = Neyman allocation.
The default is 2.</p>
</td></tr>
<tr><td><code id="DBCD_GAUSSIAN_+3A_rho_func">rho_func</code></td>
<td>
<p>Supply a user-specified allocation function of Mean_RK and
SD_RK when rho_func_index is NULL. Default is NULL.</p>
</td></tr>
<tr><td><code id="DBCD_GAUSSIAN_+3A_alpha">alpha</code></td>
<td>
<p>Supply a number indicating the subscripts of the probability
function. The default is 2.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>'DBCD_GAUSSIAN' assigns the next subject to a group given the observed
success rates, enrolled subjects and allocation function.
</p>


<h3>Value</h3>

<p>Number of the arm that the next subject is assigned to.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># There are 2 arms each of which receives 10 patients.
# The observed response means are 4.5 and 5, respectively.
# The following command returns the number of arm that the next patient will
# be assigned to.
DBCD_GAUSSIAN(Mean_RK = c(4.5,5),
SD_RK = c(1.32,0.72),
N_RK = c(10,10),
rho_func_index = 2, alpha=2)

DBCD_GAUSSIAN(Mean_RK = c(4.5,5),
SD_RK = c(1.32,0.72),
N_RK = c(10,10),
rho_func_index = 1, alpha=2)

</code></pre>

<hr>
<h2 id='DBCD_GAUSSIAN_raw'>Doubly Adaptive Biased Coin Design (Gaussian Responses)</h2><span id='topic+DBCD_GAUSSIAN_raw'></span>

<h3>Description</h3>

<p>Allocates patients to one of treatments based on doubly adaptive
biased coin design on summarized data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DBCD_GAUSSIAN_raw(X.df, group_allo, rho_func_index, rho_func, alpha)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DBCD_GAUSSIAN_raw_+3A_x.df">X.df</code></td>
<td>
<p>A data frame of two columns: treatment arm and response value.</p>
</td></tr>
<tr><td><code id="DBCD_GAUSSIAN_raw_+3A_group_allo">group_allo</code></td>
<td>
<p>An integer of the size of group allocation. The default is
1.</p>
</td></tr>
<tr><td><code id="DBCD_GAUSSIAN_raw_+3A_rho_func_index">rho_func_index</code></td>
<td>
<p>Supply a number of 1, 2 or 3 indicting the
allocation function to use. (TODO: add reference)
1 = Zhang-Rosenberger allocation;
2 = Neyman allocation.
The default is 2.</p>
</td></tr>
<tr><td><code id="DBCD_GAUSSIAN_raw_+3A_rho_func">rho_func</code></td>
<td>
<p>Supply a user-specified allocation function of Mean_RK and
SD_RK when rho_func_index is NULL. Default is NULL.</p>
</td></tr>
<tr><td><code id="DBCD_GAUSSIAN_raw_+3A_alpha">alpha</code></td>
<td>
<p>Supply a number indicating the subscripts of the probability
function. The default is 2. (Hu and Zhang 2004)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>'DBCD_GAUSSIAN' assigns the next subject to a group given the observed
success rates, enrolled subjects and allocation function.
</p>


<h3>Value</h3>

<p>Number of the arm that the next subject is assigned to.
</p>


<h3>References</h3>

<p>Hu F, Zhang L (2004).
&ldquo;Asymptotic Properties of Doubly Adaptive Biased Coin Designs for Multitreatment Clinical Trials.&rdquo;
<em>The Annals of Statistics</em>.
<a href="https://doi.org/10.1214/aos/1079120137">doi:10.1214/aos/1079120137</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X.df = data.frame(
ARM = sample(LETTERS[1:2],50,replace = TRUE),
RESPONSE = rnorm(50)
)

DBCD_GAUSSIAN_raw(X.df)

</code></pre>

<hr>
<h2 id='power_comparison_Power_vs_n'>Comparison of Powers for Different Tests under Different DBCD Randomization
Methods (Binary Responses)</h2><span id='topic+power_comparison_Power_vs_n'></span>

<h3>Description</h3>

<p>Compares the power of tests under different sample sizes for the same
treatment effect and design through matrices and plots.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>power_comparison_Power_vs_n(n_seq, nstart_seq, p, nstop_mat,
replication, group_allo, rho_func_index, rho_func, alpha, sig_level)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="power_comparison_Power_vs_n_+3A_n_seq">n_seq</code></td>
<td>
<p>A sequence of numbers of patients.
The default is c(50, 100, 150, 200).</p>
</td></tr>
<tr><td><code id="power_comparison_Power_vs_n_+3A_nstart_seq">nstart_seq</code></td>
<td>
<p>The burn-in sample size of each arm. If NULL, n_seq/20
will be used.</p>
</td></tr>
<tr><td><code id="power_comparison_Power_vs_n_+3A_p">p</code></td>
<td>
<p>A vector of probabilities containing probabilities
for each treatment arm (where the first element refers to the control arm).
The length of p should correspond to the number of treatment arms.
The default is p = c(0.3, 0.3, 0.6).</p>
</td></tr>
<tr><td><code id="power_comparison_Power_vs_n_+3A_nstop_mat">nstop_mat</code></td>
<td>
<p>A matrix of sample size stopping caps for each arm.
Each row corresponds to each n in n_seq, and each column represents each arm.
The trial stops if at least one arm reaches the corresponding cap.
The default is NULL, which means no cap.</p>
</td></tr>
<tr><td><code id="power_comparison_Power_vs_n_+3A_replication">replication</code></td>
<td>
<p>the number of replications of the simulation. The default
is 100.</p>
</td></tr>
<tr><td><code id="power_comparison_Power_vs_n_+3A_group_allo">group_allo</code></td>
<td>
<p>A number or a vector of group size(s) for allocation.
If a number is given, the allocation ratios will be updated for each batch of
group_allo samples. If a vector is given, the allocation ratios will be
updated sequentially in group according to the vector.
The group_allo will be applied to all n (from each n_seq).
Any value greater than n  will be omitted.
The default is group_allo=1, which is the same as group_allo = seq(nstart*length(p)+1,n).</p>
</td></tr>
<tr><td><code id="power_comparison_Power_vs_n_+3A_rho_func_index">rho_func_index</code></td>
<td>
<p>Supply a number of 1, 2 or 3 indicting the
allocation function to use.
1 = Wei's allocation
2 = Neyman allocation;
3 (default) = Rosenberger allocation.</p>
</td></tr>
<tr><td><code id="power_comparison_Power_vs_n_+3A_rho_func">rho_func</code></td>
<td>
<p>Supply a user-specified allocation function of S_RK when
rho_func_index is NULL. Default is NULL.</p>
</td></tr>
<tr><td><code id="power_comparison_Power_vs_n_+3A_alpha">alpha</code></td>
<td>
<p>Supply a number indicating the subscripts of the probability
function. The default is 2.</p>
</td></tr>
<tr><td><code id="power_comparison_Power_vs_n_+3A_sig_level">sig_level</code></td>
<td>
<p>Significant level. The default is 0.05.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>'power_comparison_Power_vs_n' reads different sample sizes as
well as the corresponding burn-in size and outputs allocation, estimated
rates and powers.
</p>


<h3>Value</h3>


<ul>
<li><p> Allocation - Average and standard deviation (SD) of allocation distribution
</p>
</li>
<li><p> Estimation - Average and standard deviation of the estimators of treatment effect
</p>
</li>
<li><p> Power_chisq - Average power of Chi-square test
</p>
</li>
<li><p> Power_oneside - Average power of one-sided Welch T-test performed for each of the k-th arm against $H_0: p_1&gt;p_k$ without multiplicity adjustment
</p>
</li>
<li><p> Plot - Four figures of results: 1) Allocation mean and SD, 2) Estimated mean response and SD, 3) Power of Chi-square test, 4) Power of one-sided proportion test
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
## Default setting
power_comparison_Power_vs_n(
n_seq = seq(from = 50, to = 200, by = 50),
nstart_seq = round(seq(from = 50, to = 200, by = 50) / 20),
p = c(0.3, 0.3, 0.6),
nstop_mat = NULL,
replication = 5,
group_allo = 1,
rho_func_index = 3,
rho_func = NULL,
alpha = 2,
sig_level = 0.05
)


</code></pre>

<hr>
<h2 id='power_comparison_Power_vs_n_GAUSSIAN'>Comparison of Powers for Different Tests under Different DBCD Randomization
Methods (Gaussian Responses)</h2><span id='topic+power_comparison_Power_vs_n_GAUSSIAN'></span>

<h3>Description</h3>

<p>Compares the power of tests under different sample sizes for the same
treatment effects and design through matrices and plots.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>power_comparison_Power_vs_n_GAUSSIAN(n_seq, nstart_seq, mu, sd,
nstop_mat, replication, group_allo, rho_func_index, rho_func, alpha,
sig_level)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="power_comparison_Power_vs_n_GAUSSIAN_+3A_n_seq">n_seq</code></td>
<td>
<p>A sequence of numbers of patients.
The default is c(50, 100, 150, 200).</p>
</td></tr>
<tr><td><code id="power_comparison_Power_vs_n_GAUSSIAN_+3A_nstart_seq">nstart_seq</code></td>
<td>
<p>burn-in sample size of each arm. If NULL, n_seq/20 will be used.</p>
</td></tr>
<tr><td><code id="power_comparison_Power_vs_n_GAUSSIAN_+3A_mu">mu</code></td>
<td>
<p>A vector of mean response for each treatment arm
(where the first element refers to the control arm).
The length of mu should correspond to the number of arms.
The default is mu = c(4.5,5).</p>
</td></tr>
<tr><td><code id="power_comparison_Power_vs_n_GAUSSIAN_+3A_sd">sd</code></td>
<td>
<p>A vector of response standard deviations for each treatment arm.
(where the first element refers to the control arm).
The length of sd should correspond to the number of arms.
The default is sd = c(1.32, 0.72).</p>
</td></tr>
<tr><td><code id="power_comparison_Power_vs_n_GAUSSIAN_+3A_nstop_mat">nstop_mat</code></td>
<td>
<p>A matrix of sample size stopping caps for each arm.
Each row corresponds to each n in n_seq, and each column represents each arm.
The trial stops if at least one arm reaches the corresponding cap.
The default is NULL, which means no cap.</p>
</td></tr>
<tr><td><code id="power_comparison_Power_vs_n_GAUSSIAN_+3A_replication">replication</code></td>
<td>
<p>the number of replications of the simulation. The default
is 100.</p>
</td></tr>
<tr><td><code id="power_comparison_Power_vs_n_GAUSSIAN_+3A_group_allo">group_allo</code></td>
<td>
<p>A number or a vector of group size(s) for allocation.
If a number is given, the allocation ratios will be updated for each batch of
group_allo samples. If a vector is given, the allocation ratios will be
updated sequentially in group according to the vector.
The group_allo will be applied to all n (from each n_seq).
Any value greater than n  will be omitted.
The default is group_allo=1, which is the same as group_allo = seq(nstart*length(p)+1,n).</p>
</td></tr>
<tr><td><code id="power_comparison_Power_vs_n_GAUSSIAN_+3A_rho_func_index">rho_func_index</code></td>
<td>
<p>Supply a number of 1 or 2 indicting the
allocation function to use.
1 = Zhang-Rosenberger allocation;
2 (default) = Neyman allocation.</p>
</td></tr>
<tr><td><code id="power_comparison_Power_vs_n_GAUSSIAN_+3A_rho_func">rho_func</code></td>
<td>
<p>Supply a user-specified allocation function of Mean_RK and
SD_RK when rho_func_index is NULL. Default is NULL.</p>
</td></tr>
<tr><td><code id="power_comparison_Power_vs_n_GAUSSIAN_+3A_alpha">alpha</code></td>
<td>
<p>Supply a number indicating the subscripts of the probability
function. The default is 2.</p>
</td></tr>
<tr><td><code id="power_comparison_Power_vs_n_GAUSSIAN_+3A_sig_level">sig_level</code></td>
<td>
<p>Significant level. The default is 0.05.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>'power_comparison_Power_vs_n_GAUSSIAN' reads different sample sizes
as well as the corresponding burn-in size and outputs allocation, estimated
rates and powers.
</p>


<h3>Value</h3>


<ul>
<li><p> Allocation - Average and standard deviation (SD) of allocation distribution
</p>
</li>
<li><p> Estimation - Average and standard deviation of treatment effect
</p>
</li>
<li><p> Power_oneside - Average power of one-sided Welch T-test performed for each of the k-th arm against H0: mu_1&gt;mu_k without multiplicity adjustment
</p>
</li>
<li><p> Power_aov - Average power of ANOVA test
</p>
</li>
<li><p> Plot - Four figures of results: 1) Allocation mean and SD, 2) Estimated mean response and SD, 3) Power of ANOVA test, 4) Power of one-sided Welch T-test
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
## Default setting
power_comparison_Power_vs_n_GAUSSIAN(
n_seq = seq(from = 50, to = 200, by = 50),
nstart_seq = round(seq(from = 50, to = 200, by = 50) / 20),
mu = c(4.5,5),
sd = c(1.32,0.72),
nstop_mat = NULL,
replication = 5,
group_allo = 1,
rho_func_index = 2,
rho_func = NULL,
alpha = 2,
sig_level = 0.05
)


</code></pre>

<hr>
<h2 id='power_comparison_Power_vs_Trt'>Comparison of Powers for Treatment Effects under Different DBCD Randomization
Methods (Binary Responses)</h2><span id='topic+power_comparison_Power_vs_Trt'></span>

<h3>Description</h3>

<p>Compares the power of a 2-arm design under different treatment effects
for the same sample size and placebo effect through matrices and plots.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>power_comparison_Power_vs_Trt(n, nstart, p_pbo, p_trt, nstop,
replication, group_allo, rho_func_index, rho_func, alpha, sig_level)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="power_comparison_Power_vs_Trt_+3A_n">n</code></td>
<td>
<p>The number of patients. The default is 100.</p>
</td></tr>
<tr><td><code id="power_comparison_Power_vs_Trt_+3A_nstart">nstart</code></td>
<td>
<p>Burn-in sample size of each arm. The default is n/20.</p>
</td></tr>
<tr><td><code id="power_comparison_Power_vs_Trt_+3A_p_pbo">p_pbo</code></td>
<td>
<p>Success rate of placebo (control) arm. The default is 0.3.</p>
</td></tr>
<tr><td><code id="power_comparison_Power_vs_Trt_+3A_p_trt">p_trt</code></td>
<td>
<p>A vector containing success rates of treatment arm.</p>
</td></tr>
<tr><td><code id="power_comparison_Power_vs_Trt_+3A_nstop">nstop</code></td>
<td>
<p>A vector of stopping cap of sample size for each arm. The trial
stops if at least one arm reaches the corresponding cap.
The default is NULL, which means no cap.</p>
</td></tr>
<tr><td><code id="power_comparison_Power_vs_Trt_+3A_replication">replication</code></td>
<td>
<p>the number of replications of the simulation. The default
is 100.</p>
</td></tr>
<tr><td><code id="power_comparison_Power_vs_Trt_+3A_group_allo">group_allo</code></td>
<td>
<p>A number or a vector of group size(s) for allocation.
If a number is given, the allocation ratios will be updated for each batch of
group_allo samples. If a vector is given, the allocation ratios will be
updated sequentially in group according to the vector.
Any value greater than n will be omitted.
The default is group_allo=1, which is the same as group_allo = seq(nstart*length(p)+1,n).</p>
</td></tr>
<tr><td><code id="power_comparison_Power_vs_Trt_+3A_rho_func_index">rho_func_index</code></td>
<td>
<p>Supply a number of 1, 2 or 3 indicting the
allocation function to use.
1 = Wei's allocation
2 = Neyman allocation;
3 (default) = Rosenberger allocation;</p>
</td></tr>
<tr><td><code id="power_comparison_Power_vs_Trt_+3A_rho_func">rho_func</code></td>
<td>
<p>Supply a user-specified allocation function of Mean_RK and
SD_RK when rho_func_index is NULL. Default is NULL.</p>
</td></tr>
<tr><td><code id="power_comparison_Power_vs_Trt_+3A_alpha">alpha</code></td>
<td>
<p>Supply a number indicating the subscripts of the probability
function. The default is 2.</p>
</td></tr>
<tr><td><code id="power_comparison_Power_vs_Trt_+3A_sig_level">sig_level</code></td>
<td>
<p>Significant level. The default is 0.05.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>'power_comparison_Power_vs_Trt' reads different treatment effects
and outputs allocation, estimated rates and powers.
</p>


<h3>Value</h3>


<ul>
<li><p> Allocation - Average and standard deviation (SD) of allocation distribution
</p>
</li>
<li><p> Estimation - Average and standard deviation of treatment effect
</p>
</li>
<li><p> Power - Average power: 1) Chi-square test, 2) one-sided proportion test performed for each of the k-th arm against H0: p_1&gt;p_k without multiplicity adjustment
</p>
</li>
<li><p> Plot - Three figures of results: 1) Allocation mean and SD, 2) Estimated mean response and SD, 3) Power of Chi-square test and power of one-sided proportion test
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>## Default setting
power_comparison_Power_vs_Trt(
n = 100,
nstart = round(100/20),
p_pbo = 0.3,
p_trt = seq(0,0.3,0.1)+0.3,
nstop = NULL,
replication = 5,
group_allo = 1,
rho_func_index = 3,
rho_func = NULL,
alpha = 2,
sig_level = 0.05
)


</code></pre>

<hr>
<h2 id='power_comparison_Power_vs_Trt_GAUSSIAN'>Comparison of Powers for Treatment Effects under Different DBCD Randomization
methods (Gaussian Responses)</h2><span id='topic+power_comparison_Power_vs_Trt_GAUSSIAN'></span>

<h3>Description</h3>

<p>Compares the power of a 2-arm design under different treatment effects
for the same sample size and placebo effect through matrices and plots.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>power_comparison_Power_vs_Trt_GAUSSIAN(n, nstart, mu_pbo, sd_pbo,
mu_trt, sd_trt, nstop, replication, group_allo, rho_func_index, rho_func,
alpha, sig_level)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="power_comparison_Power_vs_Trt_GAUSSIAN_+3A_n">n</code></td>
<td>
<p>The number of patients. Default is 100.</p>
</td></tr>
<tr><td><code id="power_comparison_Power_vs_Trt_GAUSSIAN_+3A_nstart">nstart</code></td>
<td>
<p>Burn-in sample size of each arm. Default is n/20.</p>
</td></tr>
<tr><td><code id="power_comparison_Power_vs_Trt_GAUSSIAN_+3A_mu_pbo">mu_pbo</code></td>
<td>
<p>Mean response of placebo (control) arm. Default is 4.5.</p>
</td></tr>
<tr><td><code id="power_comparison_Power_vs_Trt_GAUSSIAN_+3A_sd_pbo">sd_pbo</code></td>
<td>
<p>Response standard deviation of placebo (control) arm. Default
is 1.32.</p>
</td></tr>
<tr><td><code id="power_comparison_Power_vs_Trt_GAUSSIAN_+3A_mu_trt">mu_trt</code></td>
<td>
<p>A vector containing mean responses of treatment.</p>
</td></tr>
<tr><td><code id="power_comparison_Power_vs_Trt_GAUSSIAN_+3A_sd_trt">sd_trt</code></td>
<td>
<p>A vector containing response standard deviations of treatment.</p>
</td></tr>
<tr><td><code id="power_comparison_Power_vs_Trt_GAUSSIAN_+3A_nstop">nstop</code></td>
<td>
<p>A vector of stopping cap of sample size for each arm. The trial
stops if at least one arm reaches the corresponding cap.
The default is NULL, which means no cap.</p>
</td></tr>
<tr><td><code id="power_comparison_Power_vs_Trt_GAUSSIAN_+3A_replication">replication</code></td>
<td>
<p>the number of replications of the simulation. The default
is 100.</p>
</td></tr>
<tr><td><code id="power_comparison_Power_vs_Trt_GAUSSIAN_+3A_group_allo">group_allo</code></td>
<td>
<p>A number or a vector of group size(s) for allocation.
If a number is given, the allocation ratios will be updated for each batch of
group_allo samples. If a vector is given, the allocation ratios will be
updated sequentially in group according to the vector.
Any value greater than n will be omitted.
The default is group_allo=1, which is the same as group_allo = seq(nstart*length(p)+1,n).</p>
</td></tr>
<tr><td><code id="power_comparison_Power_vs_Trt_GAUSSIAN_+3A_rho_func_index">rho_func_index</code></td>
<td>
<p>Supply a number of 1 or 2 indicting the
allocation function to use.
1 = Zhang-Rosenberger allocation (2-arm allocation only);
2 (default) = Neyman allocation.</p>
</td></tr>
<tr><td><code id="power_comparison_Power_vs_Trt_GAUSSIAN_+3A_rho_func">rho_func</code></td>
<td>
<p>Supply a user-specified allocation function of Mean_RK and
SD_RK when rho_func_index is NULL. Default is NULL.</p>
</td></tr>
<tr><td><code id="power_comparison_Power_vs_Trt_GAUSSIAN_+3A_alpha">alpha</code></td>
<td>
<p>Supply a number indicating the subscripts of the probability
function. Default is 2.</p>
</td></tr>
<tr><td><code id="power_comparison_Power_vs_Trt_GAUSSIAN_+3A_sig_level">sig_level</code></td>
<td>
<p>Significant level. Default is 0.05.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>'power_comparison_Power_vs_Trt_GAUSSIAN' reads different treatment
effects and outputs allocation, estimated rates and powers.
</p>


<h3>Value</h3>


<ul>
<li><p> Allocation - Average and standard deviation (SD) of allocation distribution
</p>
</li>
<li><p> Estimation - Average and standard deviation of treatment effect
</p>
</li>
<li><p> Power - Average power: 1) ANOVA test, 2) one-sided Welch T-test performed for each of the k-th arm against H0: mu_1&gt;mu_k without multiplicity adjustment
</p>
</li>
<li><p> Plot - Three figures of results: 1) Allocation mean and SD, 2) Estimated mean response and SD, 3) Power of ANOVA test and power of one-sided Welch T-test
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>## Default setting
power_comparison_Power_vs_Trt_GAUSSIAN(
n = 100,
nstart = round(100/20),
mu_pbo = 4.5,
sd_pbo = 1.32,
mu_trt = seq(0,0.6,0.2)+4.5,
sd_trt = rep(1.32,4),
nstop = NULL,
replication = 5,
group_allo = 1,
rho_func_index = 2,
rho_func = NULL,
alpha = 2,
sig_level = 0.05
)


</code></pre>

<hr>
<h2 id='SEU_BINARY_raw'>Sequential Estimation-adjusted Urn Model (Binary Data)</h2><span id='topic+SEU_BINARY_raw'></span>

<h3>Description</h3>

<p>Allocates patients to one of treatments based on sequential
estimation-adjusted urn model (SEU) on summarized data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SEU_BINARY_raw(x.df, urn_comp, arms, group_allo, add_rule_index,
add_rule)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SEU_BINARY_raw_+3A_x.df">x.df</code></td>
<td>
<p>A data frame of two columns: treatment arm and response value.</p>
</td></tr>
<tr><td><code id="SEU_BINARY_raw_+3A_urn_comp">urn_comp</code></td>
<td>
<p>A vector of current urn composition.</p>
</td></tr>
<tr><td><code id="SEU_BINARY_raw_+3A_arms">arms</code></td>
<td>
<p>A vector of arm names. If it is not provided, the arms occurred
in x.df will be assumed as all possible arms. Suggest to always assign arms.</p>
</td></tr>
<tr><td><code id="SEU_BINARY_raw_+3A_group_allo">group_allo</code></td>
<td>
<p>An integer of the size of group allocation. The default is
1.</p>
</td></tr>
<tr><td><code id="SEU_BINARY_raw_+3A_add_rule_index">add_rule_index</code></td>
<td>
<p>Supply a number of 1, 2 or 3 indicting the
addition rules to target allocation functions.
1 = randomized play-the-winner (RPW) rule that targets the urn allocation
2 = the SEU model that targets Neyman allocation;
3 = the SEU model that targets Rosenberger allocation;'
4 = the SEU model that assigns probability of 0.6+1/K to winner at each step.
The default is 1.</p>
</td></tr>
<tr><td><code id="SEU_BINARY_raw_+3A_add_rule">add_rule</code></td>
<td>
<p>Supply a user-specified addition rules function of x.df and
arms when add_rule_index is NULL. Default is NULL.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>'SEU_BINARY_raw' assigns the next subject to a group given the
observed data, current urn composition, full list of arm codes,
number of group allocation and addition rule function.
</p>


<h3>Value</h3>

<p>Code of arms that the next group of subjects assigned to and the
updated urn composition.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x.df = data.frame(
ARM = sample(LETTERS[1:3],50,replace = TRUE),
RESPONSE = sample(c(0,1),50,replace = TRUE)
)
SEU_BINARY_raw(x.df, urn_comp=c(0,0,0), arms=c("A","B","C"))

x.df = data.frame(
ARM = sample(LETTERS[1:2],40,replace = TRUE),
RESPONSE = sample(c(0,1),40,replace = TRUE)
)
SEU_BINARY_raw(x.df,
urn_comp=c(0,0),
arms=c("A","B"),
group_allo = 1,
add_rule_index = 3)

</code></pre>

<hr>
<h2 id='SEU_GAUSSIAN_raw'>Sequential Estimation-adjusted Urn Model (Gaussian Responses)</h2><span id='topic+SEU_GAUSSIAN_raw'></span>

<h3>Description</h3>

<p>Allocates patients to one of treatments based on sequential
estimation-adjusted urn model (SEU) on summarized data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SEU_GAUSSIAN_raw(x.df, urn_comp, arms, group_allo,
add_rule_index, add_rule)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SEU_GAUSSIAN_raw_+3A_x.df">x.df</code></td>
<td>
<p>A data frame of two columns: treatment arm and response value.
treatment arm.</p>
</td></tr>
<tr><td><code id="SEU_GAUSSIAN_raw_+3A_urn_comp">urn_comp</code></td>
<td>
<p>A vector of current urn composition.</p>
</td></tr>
<tr><td><code id="SEU_GAUSSIAN_raw_+3A_arms">arms</code></td>
<td>
<p>A vector of arm names. If it is not provided, the arms occurred
in x.df will be assumed as all possible arms. Suggest to always assign arms.</p>
</td></tr>
<tr><td><code id="SEU_GAUSSIAN_raw_+3A_group_allo">group_allo</code></td>
<td>
<p>An integer of the size of group allocation. The default is
1.</p>
</td></tr>
<tr><td><code id="SEU_GAUSSIAN_raw_+3A_add_rule_index">add_rule_index</code></td>
<td>
<p>Supply a number of 1 or 2 indicting the
addition rules to target allocation functions.
1 = the SEU model targeting Neyman allocation;
2 = the SEU model that assigns probability of 0.6+1/K to winner at each step.
The default is 1.</p>
</td></tr>
<tr><td><code id="SEU_GAUSSIAN_raw_+3A_add_rule">add_rule</code></td>
<td>
<p>Supply a user-specified addition rules function of x.df and
arms when add_rule_index is NULL. Default is NULL.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>'SEU_GAUSSIAN' assigns the next subject to a group given the observed
success rates, enrolled subjects and allocation function.
</p>


<h3>Value</h3>

<p>Number of the arm that the next subject is assigned to.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x.df = data.frame(
ARM = sample(LETTERS[1:2],50,replace = TRUE),
RESPONSE = rnorm(50)
)

SEU_GAUSSIAN_raw(x.df,
urn_comp=c(0,0),
arms=c("A","B"),
group_allo = 1,
add_rule_index = 1)

</code></pre>

<hr>
<h2 id='SEU_power_comparison_Power_vs_n'>Comparison of Powers for Sample Sizes under Different SEU Randomization
Methods (Binary Responses)</h2><span id='topic+SEU_power_comparison_Power_vs_n'></span>

<h3>Description</h3>

<p>Compares the power of tests under different sample sizes for the same
treatment effects and design through matrices and plots.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SEU_power_comparison_Power_vs_n(n_seq, nstart_seq, p, urn_comp,
nstop_mat, replication, group_allo, add_rule_index, add_rule, add_rule_full,
sig_level)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SEU_power_comparison_Power_vs_n_+3A_n_seq">n_seq</code></td>
<td>
<p>A sequence of settings' number of patients.
The default is c(50, 100, 150, 200).</p>
</td></tr>
<tr><td><code id="SEU_power_comparison_Power_vs_n_+3A_nstart_seq">nstart_seq</code></td>
<td>
<p>The burn-in sample size of each arm. The default is
n_seq/20 = c(2, 5, 8, 10).</p>
</td></tr>
<tr><td><code id="SEU_power_comparison_Power_vs_n_+3A_p">p</code></td>
<td>
<p>A vector of probabilities containing probabilities
for each treatment arm (where the first element refers to the control arm).
The length of p should correspond to the number of treatment arms.
The default is p = c(0.3, 0.3, 0.6).</p>
</td></tr>
<tr><td><code id="SEU_power_comparison_Power_vs_n_+3A_urn_comp">urn_comp</code></td>
<td>
<p>A vector of current urn composition. The default is NULL,
which indicates no ball in the urn.</p>
</td></tr>
<tr><td><code id="SEU_power_comparison_Power_vs_n_+3A_nstop_mat">nstop_mat</code></td>
<td>
<p>A matrix of sample size stopping caps for each arm.
Each row corresponds to each n in n_seq, and each column represents each arm.
The trial stops if at least one arm reaches the corresponding cap.
The default is NULL, which means no cap.</p>
</td></tr>
<tr><td><code id="SEU_power_comparison_Power_vs_n_+3A_replication">replication</code></td>
<td>
<p>the number of replications of the simulation. The default
is 100.</p>
</td></tr>
<tr><td><code id="SEU_power_comparison_Power_vs_n_+3A_group_allo">group_allo</code></td>
<td>
<p>A number or a vector of group size(s) for allocation.
If a number is given, the allocation ratios will be updated for each batch of
group_allo samples. If a vector is given, the allocation ratios will be
updated sequentially in group according to the vector.
The group_allo will be applied to all n (from each n_seq).
Any value greater than n  will be omitted.
The default is group_allo=1, which is the same as group_allo = seq(nstart*length(p)+1,n).</p>
</td></tr>
<tr><td><code id="SEU_power_comparison_Power_vs_n_+3A_add_rule_index">add_rule_index</code></td>
<td>
<p>Supply a number of 1, 2 or 3 indicting the
addition rules to target allocation functions.
1 = randomized play-the-winner (RPW) rule that targets the urn allocation
2 = the SEU model that targets Neyman allocation;
3 = the SEU model that targets Rosenberger allocation;'
4 = the SEU model that assigns probability of 0.6+1/K to winner at each step.
The default is 1.</p>
</td></tr>
<tr><td><code id="SEU_power_comparison_Power_vs_n_+3A_add_rule">add_rule</code></td>
<td>
<p>Supply a user-specified addition rules function of x.df and
arms when add_rule_index is NULL. Default is NULL. (See SEU_BINARY_raw for
details on x.df and arms.)</p>
</td></tr>
<tr><td><code id="SEU_power_comparison_Power_vs_n_+3A_add_rule_full">add_rule_full</code></td>
<td>
<p>Indicator of reference data for updating addition rule.
If TRUE, the addition rule is updated by full observation at each group
allocation. If FALSE,the addition rule is updated by each group observation.
The default is FALSE for add_rule_index=1 and TRUE otherwise.</p>
</td></tr>
<tr><td><code id="SEU_power_comparison_Power_vs_n_+3A_sig_level">sig_level</code></td>
<td>
<p>Significant level (one-sided). The default is 0.05.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>'SEU_power_comparison_Power_vs_n' reads different sample sizes as
well as the corresponding burn-in size and outputs allocation, estimated
rates and powers.
</p>


<h3>Value</h3>


<ul>
<li><p> Allocation - Average and standard deviation (SD) of allocation distribution
</p>
</li>
<li><p> Estimation - Average and standard deviation of treatment effect
</p>
</li>
<li><p> Power_chisq - Average power of Chi-square test
</p>
</li>
<li><p> Power_oneside - Average power of one-sided Welch T-test performed for each of the k-th arm against H0: p_1&gt;p_k without multiplicity adjustment
</p>
</li>
<li><p> Plot - Four figures of results: 1) Allocation mean and SD, 2) Estimated mean response and SD, 3) Power of Chi-square test, 4) Power of one-sided proportion test
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
## Default setting
SEU_power_comparison_Power_vs_n(
n_seq = seq(from = 50, to = 200, by = 50),
nstart_seq = round(seq(from = 50, to = 200, by = 50) / 20),
p = c(0.3, 0.3, 0.6),
urn_comp = NULL,
nstop_mat = NULL,
replication = 4,
group_allo = 1,
add_rule_index = 1,
add_rule = NULL,
add_rule_full = FALSE,
sig_level = 0.05
)


</code></pre>

<hr>
<h2 id='SEU_power_comparison_Power_vs_n_GAUSSIAN'>Comparison of Powers for Sample Sizes under Different SEU Randomization
Methods (Gaussian Responses)</h2><span id='topic+SEU_power_comparison_Power_vs_n_GAUSSIAN'></span>

<h3>Description</h3>

<p>Compares the power of tests under different sample sizes for the same
treatment effects and design through matrices and plots.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SEU_power_comparison_Power_vs_n_GAUSSIAN(n_seq, nstart_seq, mu, sd,
 urn_comp, nstop_mat, replication, group_allo, add_rule_index, add_rule,
 add_rule_full, sig_level)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SEU_power_comparison_Power_vs_n_GAUSSIAN_+3A_n_seq">n_seq</code></td>
<td>
<p>A sequence of settings' number of patients.
The default is c(50, 100, 150, 200).</p>
</td></tr>
<tr><td><code id="SEU_power_comparison_Power_vs_n_GAUSSIAN_+3A_nstart_seq">nstart_seq</code></td>
<td>
<p>The burn-in sample size of each arm. The default is
n_seq/20 = c(2, 5, 8, 10).</p>
</td></tr>
<tr><td><code id="SEU_power_comparison_Power_vs_n_GAUSSIAN_+3A_mu">mu</code></td>
<td>
<p>A vector of mean response for each treatment arm
(where the first element refers to the control arm).
The length of mu should correspond to the number of arms.
The default is mu = c(4.5,5).</p>
</td></tr>
<tr><td><code id="SEU_power_comparison_Power_vs_n_GAUSSIAN_+3A_sd">sd</code></td>
<td>
<p>A vector of response standard deviations for each treatment arm.
(where the first element refers to the control arm).
The length of sd should correspond to the number of arms.
The default is sd = c(1.32, 0.72).</p>
</td></tr>
<tr><td><code id="SEU_power_comparison_Power_vs_n_GAUSSIAN_+3A_urn_comp">urn_comp</code></td>
<td>
<p>A vector of current urn composition. The default is NULL,
which indicates no ball in the urn.</p>
</td></tr>
<tr><td><code id="SEU_power_comparison_Power_vs_n_GAUSSIAN_+3A_nstop_mat">nstop_mat</code></td>
<td>
<p>A matrix of sample size stopping caps for each arm.
Each row corresponds to each n in n_seq, and each column represents each arm.
The trial stops if at least one arm reaches the corresponding cap.
The default is NULL, which means no cap.</p>
</td></tr>
<tr><td><code id="SEU_power_comparison_Power_vs_n_GAUSSIAN_+3A_replication">replication</code></td>
<td>
<p>the number of replications of the simulation. The default
is 100.</p>
</td></tr>
<tr><td><code id="SEU_power_comparison_Power_vs_n_GAUSSIAN_+3A_group_allo">group_allo</code></td>
<td>
<p>A number or a vector of group size(s) for allocation.
If a number is given, the allocation ratios will be updated for each batch of
group_allo samples. If a vector is given, the allocation ratios will be
updated sequentially in group according to the vector.
The group_allo will be applied to all n (from each n_seq).
Any value greater than n  will be omitted.
The default is group_allo=1, which is the same as group_allo = seq(nstart*length(p)+1,n).</p>
</td></tr>
<tr><td><code id="SEU_power_comparison_Power_vs_n_GAUSSIAN_+3A_add_rule_index">add_rule_index</code></td>
<td>
<p>Supply a number of 1 or 2 indicting the
addition rules to target allocation functions.
1 = the SEU model targeting Neyman allocation;
2 = the SEU model that assigns probability of 0.6+1/K to winner at each step.
The default is 1.</p>
</td></tr>
<tr><td><code id="SEU_power_comparison_Power_vs_n_GAUSSIAN_+3A_add_rule">add_rule</code></td>
<td>
<p>Supply a user-specified addition rules function of x.df and
arms when add_rule_index is NULL. Default is NULL. (See SEU_GAUSSIAN_raw for
details on x.df and arms.)</p>
</td></tr>
<tr><td><code id="SEU_power_comparison_Power_vs_n_GAUSSIAN_+3A_add_rule_full">add_rule_full</code></td>
<td>
<p>Indicator of reference data for updating addition rule.
If TRUE, the addition rule is updated by full observation at each group
allocation. If FALSE,the addition rule is updated by each group observation.
The default is TRUE.</p>
</td></tr>
<tr><td><code id="SEU_power_comparison_Power_vs_n_GAUSSIAN_+3A_sig_level">sig_level</code></td>
<td>
<p>Significant level (one-sided). The default is 0.05.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>'SEU_power_comparison_Power_vs_n_GAUSSIAN' reads different sample
sizes as well as the corresponding burn-in size and outputs allocation,
estimated rates and powers.
</p>


<h3>Value</h3>


<ul>
<li><p> Allocation - Average and standard deviation (SD) of allocation distribution
</p>
</li>
<li><p> Estimation - Average and standard deviation of treatment effect
</p>
</li>
<li><p> Power_chisq - Average power of Chi-square test
</p>
</li>
<li><p> Power_oneside - Average power of one-sided Welch T-test performed for each of the k-th arm against H0: p_1&gt;p_k without multiplicity adjustment
</p>
</li>
<li><p> Plot - Four figures of results: 1) Allocation mean and SD, 2) Estimated mean response and SD, 3) Power of Chi-square test, 4) Power of one-sided proportion test
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
## Default setting
SEU_power_comparison_Power_vs_n_GAUSSIAN(
n_seq = seq(from = 50, to = 100, by = 50),
nstart_seq = round(seq(from = 50, to = 100, by = 50) / 20),
mu = c(4.5,5),
sd = c(1.32,0.72),
urn_comp = NULL,
nstop_mat = NULL,
replication = 5,
group_allo = 1,
add_rule_index = 1,
add_rule = NULL,
add_rule_full = NULL,
sig_level = 0.05
)


</code></pre>

<hr>
<h2 id='SEU_power_comparison_Power_vs_Trt'>Comparison of Powers for Treatment Effects under Different SEU Randomization
Methods (Binary Responses)</h2><span id='topic+SEU_power_comparison_Power_vs_Trt'></span>

<h3>Description</h3>

<p>Compares the power of a 2-arm design under different treatment effects
for the same sample size and placebo effect through matrices and plots.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SEU_power_comparison_Power_vs_Trt(n, nstart, p_pbo, p_trt, urn_comp,
nstop, replication, group_allo, add_rule_index, add_rule, add_rule_full,
sig_level)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SEU_power_comparison_Power_vs_Trt_+3A_n">n</code></td>
<td>
<p>The number of patients. The default is 100.</p>
</td></tr>
<tr><td><code id="SEU_power_comparison_Power_vs_Trt_+3A_nstart">nstart</code></td>
<td>
<p>Burn-in sample size of each arm. The default is n/20.</p>
</td></tr>
<tr><td><code id="SEU_power_comparison_Power_vs_Trt_+3A_p_pbo">p_pbo</code></td>
<td>
<p>Success rate of placebo (control) arm. The default is 0.3.</p>
</td></tr>
<tr><td><code id="SEU_power_comparison_Power_vs_Trt_+3A_p_trt">p_trt</code></td>
<td>
<p>A vector containing success rates of treatment arm.</p>
</td></tr>
<tr><td><code id="SEU_power_comparison_Power_vs_Trt_+3A_urn_comp">urn_comp</code></td>
<td>
<p>A vector of current urn composition. The default is NULL,
which indicates no ball in the urn.</p>
</td></tr>
<tr><td><code id="SEU_power_comparison_Power_vs_Trt_+3A_nstop">nstop</code></td>
<td>
<p>A vector of stopping cap of sample size for each arm. The trial
stops if at least one arm reaches the corresponding cap.
The default is NULL, which means no cap.</p>
</td></tr>
<tr><td><code id="SEU_power_comparison_Power_vs_Trt_+3A_replication">replication</code></td>
<td>
<p>the number of replications of the simulation. The default
is 100.</p>
</td></tr>
<tr><td><code id="SEU_power_comparison_Power_vs_Trt_+3A_group_allo">group_allo</code></td>
<td>
<p>A number or a vector of group size(s) for allocation.
If a number is given, the allocation ratios will be updated for each batch of
group_allo samples. If a vector is given, the allocation ratios will be
updated sequentially in group according to the vector.
Any value greater than n will be omitted.
The default is group_allo=1, which is the same as group_allo = seq(nstart*length(p)+1,n).</p>
</td></tr>
<tr><td><code id="SEU_power_comparison_Power_vs_Trt_+3A_add_rule_index">add_rule_index</code></td>
<td>
<p>Supply a number of 1, 2 or 3 indicting the
addition rules to target allocation functions.
1 = randomized play-the-winner (RPW) rule that targets the urn allocation
2 = the SEU model that targets Neyman allocation;
3 = the SEU model that targets Rosenberger allocation;'
4 = the SEU model that assigns probability of 0.6+1/K to winner at each step.
The default is 1.</p>
</td></tr>
<tr><td><code id="SEU_power_comparison_Power_vs_Trt_+3A_add_rule">add_rule</code></td>
<td>
<p>Supply a user-specified addition rules function of x.df and
arms when add_rule_index is NULL. Default is NULL. (See SEU_BINARY_raw for
details on x.df and arms.)</p>
</td></tr>
<tr><td><code id="SEU_power_comparison_Power_vs_Trt_+3A_add_rule_full">add_rule_full</code></td>
<td>
<p>Indicator of reference data for updating addition rule.
If TRUE, the addition rule is updated by full observation at each group
allocation. If FALSE,the addition rule is updated by each group observation.
The default is FALSE for add_rule_index=1 and TRUE otherwise.</p>
</td></tr>
<tr><td><code id="SEU_power_comparison_Power_vs_Trt_+3A_sig_level">sig_level</code></td>
<td>
<p>Significant level (one-sided). The default is 0.05.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>'SEU_power_comparison_Power_vs_Trt' reads different treatment effects
and outputs allocation, estimated rates and powers.
</p>


<h3>Value</h3>


<ul>
<li><p> Allocation - Average and standard deviation (SD) of allocation distribution
</p>
</li>
<li><p> Estimation - Average and standard deviation of treatment effect
</p>
</li>
<li><p> Power - Average power: 1) Chi-square test, 2) one-sided proportion test performed for each of the k-th arm against H0: p_1&gt;p_k without multiplicity adjustment
</p>
</li>
<li><p> Plot - Three figures of results: 1) Allocation mean and SD, 2) Estimated mean response and SD, 3) Power of Chi-square test and power of one-sided proportion test
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
## Default setting
SEU_power_comparison_Power_vs_Trt(
n = 40,
nstart = round(40/20),
p_pbo = 0.3,
p_trt = seq(0,0.3,0.1)+0.3,
urn_comp = NULL,
nstop = NULL,
replication = 5,
group_allo = 1,
add_rule_index = 3,
add_rule = NULL,
add_rule_full = FALSE,
sig_level = 0.05
)

</code></pre>

<hr>
<h2 id='SEU_power_comparison_Power_vs_Trt_GAUSSIAN'>Comparison of Powers for Treatment Effects under Different SEU Randomization
Methods (Gaussian Responses)</h2><span id='topic+SEU_power_comparison_Power_vs_Trt_GAUSSIAN'></span>

<h3>Description</h3>

<p>Compares the power of a 2-arm design under different treatment effects
for the same sample size and placebo effect through matrices and plots.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SEU_power_comparison_Power_vs_Trt_GAUSSIAN(n, nstart, mu_pbo, sd_pbo,
mu_trt, sd_trt, urn_comp, nstop, replication, group_allo, add_rule_index,
add_rule, add_rule_full, sig_level)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SEU_power_comparison_Power_vs_Trt_GAUSSIAN_+3A_n">n</code></td>
<td>
<p>The number of patients. The default is 100.</p>
</td></tr>
<tr><td><code id="SEU_power_comparison_Power_vs_Trt_GAUSSIAN_+3A_nstart">nstart</code></td>
<td>
<p>Burn-in sample size of each arm. The default is n/20.</p>
</td></tr>
<tr><td><code id="SEU_power_comparison_Power_vs_Trt_GAUSSIAN_+3A_mu_pbo">mu_pbo</code></td>
<td>
<p>Mean response of placebo (control) arm. Default is 4.5.</p>
</td></tr>
<tr><td><code id="SEU_power_comparison_Power_vs_Trt_GAUSSIAN_+3A_sd_pbo">sd_pbo</code></td>
<td>
<p>Response standard deviation of placebo (control) arm. Default
is 1.32.</p>
</td></tr>
<tr><td><code id="SEU_power_comparison_Power_vs_Trt_GAUSSIAN_+3A_mu_trt">mu_trt</code></td>
<td>
<p>A vector containing mean responses of treatment.</p>
</td></tr>
<tr><td><code id="SEU_power_comparison_Power_vs_Trt_GAUSSIAN_+3A_sd_trt">sd_trt</code></td>
<td>
<p>A vector containing response standard deviations of treatment.</p>
</td></tr>
<tr><td><code id="SEU_power_comparison_Power_vs_Trt_GAUSSIAN_+3A_urn_comp">urn_comp</code></td>
<td>
<p>A vector of current urn composition. The default is NULL,
which indicates no ball in the urn.</p>
</td></tr>
<tr><td><code id="SEU_power_comparison_Power_vs_Trt_GAUSSIAN_+3A_nstop">nstop</code></td>
<td>
<p>A vector of stopping cap of sample size for each arm. The trial
stops if at least one arm reaches the corresponding cap.
The default is NULL, which means no cap.</p>
</td></tr>
<tr><td><code id="SEU_power_comparison_Power_vs_Trt_GAUSSIAN_+3A_replication">replication</code></td>
<td>
<p>the number of replications of the simulation. The default
is 100.</p>
</td></tr>
<tr><td><code id="SEU_power_comparison_Power_vs_Trt_GAUSSIAN_+3A_group_allo">group_allo</code></td>
<td>
<p>A number or a vector of group size(s) for allocation.
If a number is given, the allocation ratios will be updated for each batch of
group_allo samples. If a vector is given, the allocation ratios will be
updated sequentially in group according to the vector.
Any value greater than n will be omitted.
The default is group_allo=1, which is the same as group_allo = seq(nstart*length(p)+1,n).</p>
</td></tr>
<tr><td><code id="SEU_power_comparison_Power_vs_Trt_GAUSSIAN_+3A_add_rule_index">add_rule_index</code></td>
<td>
<p>Supply a number of 1 or 2 indicting the
addition rules to target allocation functions.
1 = the SEU model targeting Neyman allocation;
2 = the SEU model that assigns probability of 0.6+1/K to winner at each step.
The default is 1.</p>
</td></tr>
<tr><td><code id="SEU_power_comparison_Power_vs_Trt_GAUSSIAN_+3A_add_rule">add_rule</code></td>
<td>
<p>Supply a user-specified addition rules function of x.df and
arms when add_rule_index is NULL. Default is NULL. (See SEU_GAUSSIAN_raw for
details on x.df and arms.)</p>
</td></tr>
<tr><td><code id="SEU_power_comparison_Power_vs_Trt_GAUSSIAN_+3A_add_rule_full">add_rule_full</code></td>
<td>
<p>Indicator of reference data for updating addition rule.
If TRUE, the addition rule is updated by full observation at each group
allocation. If FALSE,the addition rule is updated by each group observation.
The default is TRUE.</p>
</td></tr>
<tr><td><code id="SEU_power_comparison_Power_vs_Trt_GAUSSIAN_+3A_sig_level">sig_level</code></td>
<td>
<p>Significant level (one-sided). The default is 0.05.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>'SEU_power_comparison_Power_vs_Trt_GAUSSIAN' reads different treatment effects
and outputs allocation, estimated rates and powers.
</p>


<h3>Value</h3>


<ul>
<li><p> Allocation - Average and standard deviation (SD) of allocation distribution
</p>
</li>
<li><p> Estimation - Average and standard deviation of treatment effect
</p>
</li>
<li><p> Power - Average power: 1) Chi-square test, 2) one-sided proportion test performed for each of the k-th arm against H0: p_1&gt;p_k without multiplicity adjustment
</p>
</li>
<li><p> Plot - Three figures of results: 1) Allocation mean and SD, 2) Estimated mean response and SD, 3) Power of Chi-square test and power of one-sided proportion test
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
## Default setting
SEU_power_comparison_Power_vs_Trt_GAUSSIAN(
n = 40,
nstart = round(40/20),
urn_comp = NULL,
nstop = NULL,
replication = 5,
group_allo = 1,
add_rule_index = 1,
add_rule = NULL,
add_rule_full = TRUE,
sig_level = 0.05
)


</code></pre>

<hr>
<h2 id='SEU_simulation_main'>Sequential Estimation-adjusted Urn Model with Simulated Data (Binary Data)</h2><span id='topic+SEU_simulation_main'></span>

<h3>Description</h3>

<p>Allocates patients to one of treatments based on sequential
estimation-adjusted urn model (SEU) with simulated data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SEU_simulation_main(n, nstart, p, urn_comp, nstop, replication, group_allo,
 add_rule_index, add_rule, add_rule_full, sig_level)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SEU_simulation_main_+3A_n">n</code></td>
<td>
<p>The number of patients. The default is 500.</p>
</td></tr>
<tr><td><code id="SEU_simulation_main_+3A_nstart">nstart</code></td>
<td>
<p>Burn-in sample size of each arm. The default is n/20.</p>
</td></tr>
<tr><td><code id="SEU_simulation_main_+3A_p">p</code></td>
<td>
<p>A vector containing response probabilities
for each treatment arm (where the first element refers to the control arm).
The length of p should correspond to the number of arms.
The default is p = c(0.3, 0.3, 0.6).</p>
</td></tr>
<tr><td><code id="SEU_simulation_main_+3A_urn_comp">urn_comp</code></td>
<td>
<p>A vector of current urn composition. The default is NULL,
which indicates no ball in the urn.</p>
</td></tr>
<tr><td><code id="SEU_simulation_main_+3A_nstop">nstop</code></td>
<td>
<p>A vector of stopping cap of sample size for each arm. The trial
stops if at least one arm reaches the corresponding cap.
The default is NULL, which means no cap.</p>
</td></tr>
<tr><td><code id="SEU_simulation_main_+3A_replication">replication</code></td>
<td>
<p>the number of replications of the simulation. The default
is 100.</p>
</td></tr>
<tr><td><code id="SEU_simulation_main_+3A_group_allo">group_allo</code></td>
<td>
<p>A number or a vector of group size(s) for allocation.
If a number is given, the allocation ratios will be updated for each batch of
group_allo samples. If a vector is given, the allocation ratios will be
updated sequentially in group according to the vector.
Any value greater than n will be omitted.
The default is group_allo=1, which is the same as group_allo = seq(nstart*length(p)+1,n).</p>
</td></tr>
<tr><td><code id="SEU_simulation_main_+3A_add_rule_index">add_rule_index</code></td>
<td>
<p>Supply a number of 1, 2 or 3 indicting the
addition rules to target allocation functions.
1 = randomized play-the-winner (RPW) rule that targets the urn allocation
2 = the SEU model that targets Neyman allocation;
3 = the SEU model that targets Rosenberger allocation;'
4 = the SEU model that assigns probability of 0.6+1/K to winner at each step.
The default is 1.</p>
</td></tr>
<tr><td><code id="SEU_simulation_main_+3A_add_rule">add_rule</code></td>
<td>
<p>Supply a user-specified addition rules function of x.df and
arms when add_rule_index is NULL. Default is NULL. (See SEU_BINARY_raw for
details on x.df and arms.)</p>
</td></tr>
<tr><td><code id="SEU_simulation_main_+3A_add_rule_full">add_rule_full</code></td>
<td>
<p>Indicator of reference data for updating addition rule.
If TRUE, the addition rule is updated by full observation at each group
allocation. If FALSE,the addition rule is updated by each group observation.
The default is FALSE for add_rule_index=1 and TRUE otherwise.</p>
</td></tr>
<tr><td><code id="SEU_simulation_main_+3A_sig_level">sig_level</code></td>
<td>
<p>Significant level (one-sided). The default is 0.05.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>'SEU_simulation_main' can sample response and adaptively randomize
subjects group by group.
</p>


<h3>Value</h3>


<ul>
<li><p> allocation_mean - Average of allocation in each arm based on 'replication' repeats
</p>
</li>
<li><p> allocation_sd - Standard deviation of allocation in each arm based on 'replication' repeats
</p>
</li>
<li><p> SS_mean - Average of sample size in each arm based on 'replication' repeats
</p>
</li>
<li><p> SS_sd - Standard deviation of sample size in each arm based on 'replication' repeats
</p>
</li>
<li><p> power_chisq - Average power of chi-square test.
</p>
</li>
<li><p> power_oneside - Average power for each of the k-th arm to perform one-sided test against H0: p_1&gt;p_k without multiplicity adjustment
</p>
</li>
<li><p> p_estimate_mean - Average of estimated success rate p
</p>
</li>
<li><p> p_estimate_sd - Standard deviation of estimated success rate p
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
## Default method
SEU_simulation_main(n = 500,
nstart = round(500 / 20),
p = c(0.3, 0.3, 0.6),
nstop=c(500,500,500),
urn_comp = c(0,0,0),
replication = 5,
group_allo = 1,
add_rule_index = 1,
add_rule_full = FALSE,
sig_level = 0.05
)

</code></pre>

<hr>
<h2 id='SEU_simulation_main_GAUSSIAN'>Sequential Estimation-adjusted Urn Model with Simulated Data (Gaussian
Responses)</h2><span id='topic+SEU_simulation_main_GAUSSIAN'></span>

<h3>Description</h3>

<p>Allocates patients to one of treatments based on sequential
estimation-adjusted urn model (SEU) with simulated data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SEU_simulation_main_GAUSSIAN(n, nstart, mu, sd, urn_comp, nstop,
 replication, group_allo, add_rule_index, add_rule,
 add_rule_full, sig_level)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SEU_simulation_main_GAUSSIAN_+3A_n">n</code></td>
<td>
<p>The number of patients. The default is 500.</p>
</td></tr>
<tr><td><code id="SEU_simulation_main_GAUSSIAN_+3A_nstart">nstart</code></td>
<td>
<p>Burn-in sample size of each arm. The default is n/20.</p>
</td></tr>
<tr><td><code id="SEU_simulation_main_GAUSSIAN_+3A_mu">mu</code></td>
<td>
<p>A vector of mean response for each treatment arm
(where the first element refers to the control arm).
The length of mu should correspond to the number of arms.
The default is mu = c(4.5,5).</p>
</td></tr>
<tr><td><code id="SEU_simulation_main_GAUSSIAN_+3A_sd">sd</code></td>
<td>
<p>A vector of response standard deviations for each treatment arm.
(where the first element refers to the control arm).
The length of sd should correspond to the number of arms.
The default is sd = c(1.32, 0.72).</p>
</td></tr>
<tr><td><code id="SEU_simulation_main_GAUSSIAN_+3A_urn_comp">urn_comp</code></td>
<td>
<p>A vector of current urn composition. The default is NULL,
which indicates no ball in the urn.</p>
</td></tr>
<tr><td><code id="SEU_simulation_main_GAUSSIAN_+3A_nstop">nstop</code></td>
<td>
<p>A vector of stopping cap of sample size for each arm. The trial
stops if at least one arm reaches the corresponding cap.
The default is NULL, which means no cap.</p>
</td></tr>
<tr><td><code id="SEU_simulation_main_GAUSSIAN_+3A_replication">replication</code></td>
<td>
<p>the number of replications of the simulation. The default
is 100.</p>
</td></tr>
<tr><td><code id="SEU_simulation_main_GAUSSIAN_+3A_group_allo">group_allo</code></td>
<td>
<p>A number or a vector of group size(s) for allocation.
If a number is given, the allocation ratios will be updated for each batch of
group_allo samples. If a vector is given, the allocation ratios will be
updated sequentially in group according to the vector.
Any value greater than n will be omitted.
The default is group_allo=1, which is the same as group_allo = seq(nstart*length(p)+1,n).</p>
</td></tr>
<tr><td><code id="SEU_simulation_main_GAUSSIAN_+3A_add_rule_index">add_rule_index</code></td>
<td>
<p>Supply a number of 1 or 2 indicting the
addition rules to target allocation functions.
1 = the SEU model targeting Neyman allocation;
2 = the SEU model that assigns probability of 0.6+1/K to winner at each step.
The default is 1.</p>
</td></tr>
<tr><td><code id="SEU_simulation_main_GAUSSIAN_+3A_add_rule">add_rule</code></td>
<td>
<p>Supply a user-specified addition rules function of x.df and
arms when add_rule_index is NULL. Default is NULL. (See SEU_GAUSSIAN_raw for
details on x.df and arms.)</p>
</td></tr>
<tr><td><code id="SEU_simulation_main_GAUSSIAN_+3A_add_rule_full">add_rule_full</code></td>
<td>
<p>Indicator of reference data for updating addition rule.
If TRUE, the addition rule is updated by full observation at each group
allocation. If FALSE,the addition rule is updated by each group observation.
The default is TRUE.</p>
</td></tr>
<tr><td><code id="SEU_simulation_main_GAUSSIAN_+3A_sig_level">sig_level</code></td>
<td>
<p>Significant level (one-sided). The default is 0.05.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>'SEU_simulation_main_GAUSSIAN' can sample response and adaptively
randomize subjects group by group.
</p>


<h3>Value</h3>


<ul>
<li><p> allocation_mean - Average of allocation in each arm based on 'replication' repeats.
</p>
</li>
<li><p> allocation_sd - Standard deviation of allocation in each arm based on 'replication' repeats.
</p>
</li>
<li><p> SS_mean - Average of sample size in each arm based on 'replication' repeats.
</p>
</li>
<li><p> SS_sd - Standard deviation of sample size in each arm based on 'replication' repeats.
</p>
</li>
<li><p> power_aov - Average power of ANOVA test.
</p>
</li>
<li><p> power_oneside - Average power for each of the k-th arm to perform one-sided Welch T-test against H0: mu_1&gt;mu_k without multiplicity adjustment.
</p>
</li>
<li><p> mu_estimate_mean - Average of estimated response mean 'mu'.
</p>
</li>
<li><p> sd_estimate_mean - Average of estimated response standard deviation 'sd'.
</p>
</li>
<li><p> mu_estimate_sd - Standard deviation of estimated response mean 'mu'.
</p>
</li>
<li><p> sd_estimate_sd - Standard deviation of estimated response standard deviation 'sd'.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
## Default method
SEU_simulation_main_GAUSSIAN(
n = 50,
nstart = round(50 / 20),
mu = c(4.5,5),
sd = c(1.32,0.72),
urn_comp = c(0,0),
nstop=c(50,50),
replication = 5,
group_allo = 1,
add_rule_index = 1,
add_rule = NULL,
add_rule_full = TRUE,
sig_level = 0.05
)

</code></pre>

<hr>
<h2 id='simulation_main'>Doubly Adaptive Biased Coin Design with Simulated Data (Binary Responses)</h2><span id='topic+simulation_main'></span>

<h3>Description</h3>

<p>Allocates patients to one of treatments based on the doubly adaptive biased
coin design with simulated data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulation_main(n, nstart, p, nstop, replication, group_allo, rho_func_index,
rho_func, alpha, sig_level)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulation_main_+3A_n">n</code></td>
<td>
<p>The number of patients. The default is 500.</p>
</td></tr>
<tr><td><code id="simulation_main_+3A_nstart">nstart</code></td>
<td>
<p>Burn-in sample size of each arm. The default is n/20.</p>
</td></tr>
<tr><td><code id="simulation_main_+3A_p">p</code></td>
<td>
<p>A vector containing response probabilities
for each treatment arm (where the first element refers to the control arm).
The length of p should correspond to the number of arms.
The default is p = c(0.3, 0.3, 0.6).</p>
</td></tr>
<tr><td><code id="simulation_main_+3A_nstop">nstop</code></td>
<td>
<p>A vector of stopping cap of sample size for each arm. The trial
stops if at least one arm reaches the corresponding cap.
The default is NULL, which means no cap.</p>
</td></tr>
<tr><td><code id="simulation_main_+3A_replication">replication</code></td>
<td>
<p>the number of replications of the simulation. The default
is 100.</p>
</td></tr>
<tr><td><code id="simulation_main_+3A_group_allo">group_allo</code></td>
<td>
<p>A number or a vector of group size(s) for allocation.
If a number is given, the allocation ratios will be updated for each batch of
group_allo samples. If a vector is given, the allocation ratios will be
updated sequentially in group according to the vector.
Any value greater than n will be omitted.
The default is group_allo=1, which is the same as group_allo = seq(nstart*length(p)+1,n).</p>
</td></tr>
<tr><td><code id="simulation_main_+3A_rho_func_index">rho_func_index</code></td>
<td>
<p>Supply a number of 1, 2 or 3 indicting the
allocation function to use; default to 3.
* 1 = Wei's allocation (Urn allocation);
* 2 = Neyman allocation;
* 3 (default) = Rosenberger allocation;</p>
</td></tr>
<tr><td><code id="simulation_main_+3A_rho_func">rho_func</code></td>
<td>
<p>Supply a user-specified allocation function of S_RK when
rho_func_index is NULL. Default is NULL.</p>
</td></tr>
<tr><td><code id="simulation_main_+3A_alpha">alpha</code></td>
<td>
<p>Supply a number indicating the subscripts of the probability
function. The default is 2.</p>
</td></tr>
<tr><td><code id="simulation_main_+3A_sig_level">sig_level</code></td>
<td>
<p>Significant level (one-sided). The default is 0.05.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>'simulation_main' can sample response and adaptively randomize
subjects group by group.
</p>


<h3>Value</h3>


<ul>
<li><p> allocation_mean - Average of allocation in each arm based on 'replication' repeats
</p>
</li>
<li><p> allocation_sd - Standard deviation of allocation in each arm based on 'replication' repeats
</p>
</li>
<li><p> SS_mean - Average of sample size in each arm based on 'replication' repeats
</p>
</li>
<li><p> SS_sd - Standard deviation of sample size in each arm based on 'replication' repeats
</p>
</li>
<li><p> power_chisq - Average power of chi-square test.
</p>
</li>
<li><p> power_oneside - Average power for each of the k-th arm to perform one-sided test against H0: p_1&gt;p_k without multiplicity adjustment
</p>
</li>
<li><p> p_estimate_mean - Average of estimated success rate p
</p>
</li>
<li><p> p_estimate_sd - Standard deviation of estimated success rate p
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
## Default method
simulation_main(n = 500,
nstart = round(500 / 20),
p = c(0.3, 0.3, 0.6),
nstop=c(500,500,500),
replication = 5,
group_allo = 1,
rho_func_index = 3,
alpha = 2,
sig_level = 0.05
)

</code></pre>

<hr>
<h2 id='simulation_main_GAUSSIAN'>Doubly Adaptive Biased Coin Design with Simulated Data (Gaussian Responses)</h2><span id='topic+simulation_main_GAUSSIAN'></span>

<h3>Description</h3>

<p>Allocates patients to one of treatments based on the doubly adaptive biased
coin design with simulated data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulation_main_GAUSSIAN(n, nstart, mu, sd, nstop, replication, group_allo,
 rho_func_index, rho_func, alpha, sig_level)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulation_main_GAUSSIAN_+3A_n">n</code></td>
<td>
<p>The number of patients. The default is 500.</p>
</td></tr>
<tr><td><code id="simulation_main_GAUSSIAN_+3A_nstart">nstart</code></td>
<td>
<p>Burn-in sample size of each arm. The default is n/20.</p>
</td></tr>
<tr><td><code id="simulation_main_GAUSSIAN_+3A_mu">mu</code></td>
<td>
<p>A vector of mean response for each treatment arm
(where the first element refers to the control arm).
The length of mu should correspond to the number of arms.
The default is mu = c(4.5,5).</p>
</td></tr>
<tr><td><code id="simulation_main_GAUSSIAN_+3A_sd">sd</code></td>
<td>
<p>A vector of response standard deviations for each treatment arm.
(where the first element refers to the control arm).
The length of sd should correspond to the number of arms.
The default is sd = c(1.32, 0.72).</p>
</td></tr>
<tr><td><code id="simulation_main_GAUSSIAN_+3A_nstop">nstop</code></td>
<td>
<p>A vector of stopping cap of sample size for each arm. The trial
stops if at least one arm reaches the corresponding cap.
The default is NULL, which means no cap.</p>
</td></tr>
<tr><td><code id="simulation_main_GAUSSIAN_+3A_replication">replication</code></td>
<td>
<p>the number of replications of the simulation. The default
is 100.</p>
</td></tr>
<tr><td><code id="simulation_main_GAUSSIAN_+3A_group_allo">group_allo</code></td>
<td>
<p>A number or a vector of group size(s) for allocation.
If a number is given, the allocation ratios will be updated for each batch of
group_allo samples. If a vector is given, the allocation ratios will be
updated sequentially in group according to the vector.
Any value greater than n will be omitted.
The default is group_allo=1, which is the same as group_allo = seq(nstart*length(p)+1,n).</p>
</td></tr>
<tr><td><code id="simulation_main_GAUSSIAN_+3A_rho_func_index">rho_func_index</code></td>
<td>
<p>Supply a number of 1 or 2 indicting the
allocation function to use.
1 = Zhang-Rosenberger allocation (2-arm allocation only);
2 (default) = Neyman allocation.</p>
</td></tr>
<tr><td><code id="simulation_main_GAUSSIAN_+3A_rho_func">rho_func</code></td>
<td>
<p>Supply a user-specified allocation function of Mean_RK and
SD_RK when rho_func_index is NULL. Default is NULL.</p>
</td></tr>
<tr><td><code id="simulation_main_GAUSSIAN_+3A_alpha">alpha</code></td>
<td>
<p>Supply a number indicating the subscripts of the probability
function. The default is 2.</p>
</td></tr>
<tr><td><code id="simulation_main_GAUSSIAN_+3A_sig_level">sig_level</code></td>
<td>
<p>Significant level. The default is 0.05.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>'simulation_main_GAUSSIAN' can sample response and adaptively
randomize subjects group by group.
</p>


<h3>Value</h3>


<ul>
<li><p> allocation_mean - Average of allocation in each arm based on 'replication' repeats.
</p>
</li>
<li><p> allocation_sd - Standard deviation of allocation in each arm based on 'replication' repeats.
</p>
</li>
<li><p> SS_mean - Average of sample size in each arm based on 'replication' repeats.
</p>
</li>
<li><p> SS_sd - Standard deviation of sample size in each arm based on 'replication' repeats.
</p>
</li>
<li><p> power_aov - Average power of ANOVA test.
</p>
</li>
<li><p> power_oneside - Average power for each of the k-th arm to perform one-sided Welch T-test against H0: mu_1&gt;mu_k without multiplicity adjustment.
</p>
</li>
<li><p> mu_estimate_mean - Average of estimated response mean 'mu'.
</p>
</li>
<li><p> sd_estimate_mean - Average of estimated response standard deviation 'sd'.
</p>
</li>
<li><p> mu_estimate_sd - Standard deviation of estimated response mean 'mu'.
</p>
</li>
<li><p> sd_estimate_sd - Standard deviation of estimated response standard deviation 'sd'.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
## Default method
simulation_main_GAUSSIAN(
n = 500,
nstart = round(500 / 20),
mu = c(4.5,5),
sd = c(1.32,0.72),
nstop=c(500,500),
replication = 5,
group_allo = 1,
rho_func_index = 2,
rho_func = NULL,
alpha = 2,
sig_level = 0.05
)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
