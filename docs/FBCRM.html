<!DOCTYPE html><html lang="en"><head><title>Help for package FBCRM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {FBCRM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#FBCRMSimTrial'><p>Provides simulation results using FBCRM</p></a></li>
<li><a href='#GetFBCRM'><p>Provides the optimal dose level closest to the mtd where the next cohort of patients should be allotted based on the data.</p></a></li>
<li><a href='#GetMFBCRM'><p>Provides the optimal dose level closest to the mtd where the next cohort of patients should be allotted based on the data</p></a></li>
<li><a href='#MFBCRMSimTrial'><p>Provides simulation results using MFBCRM</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Phase I Optimal Dose Assignment using the FBCRM and MFBCRM
Methods</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-10-19</td>
</tr>
<tr>
<td>Description:</td>
<td>Performs dose assignment and trial simulation for the FBCRM (Fully Bayesian Continual Reassessment Method) and MFBCRM (Mixture Fully Bayesian Continual Reassessment Method) phase I clinical trial designs. These trial designs extend the Continual Reassessment Method (CRM) and Bayesian Model Averaging Continual Reassessment Method (BMA-CRM) by allowing the prior toxicity skeleton itself to be random, with posterior distributions obtained from Markov Chain Monte Carlo. On average, the FBCRM and MFBCRM methods outperformed the CRM and BMA-CRM methods in terms of selecting an optimal dose level across thousands of randomly generated simulation scenarios. Details on the methods and results of this simulation study are available on request, and the manuscript is currently under review.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 0.12.18)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-10-27 20:12:38 UTC; achapp</td>
</tr>
<tr>
<td>Author:</td>
<td>Soham Mahato [aut],
  Andrew G Chapple [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Andrew G Chapple &lt;achapp@lsuhsc.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-10-29 08:42:51 UTC</td>
</tr>
</table>
<hr>
<h2 id='FBCRMSimTrial'>Provides simulation results using FBCRM</h2><span id='topic+FBCRMSimTrial'></span>

<h3>Description</h3>

<p>Provides simulation results using FBCRM
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FBCRMSimTrial(max_samp, Cohort, ptrue, mu, p_rho, sigma, mtd, p_u, B, M)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FBCRMSimTrial_+3A_max_samp">max_samp</code></td>
<td>
<p>Total number of patients recruited/will be recruited in the trial.</p>
</td></tr>
<tr><td><code id="FBCRMSimTrial_+3A_cohort">Cohort</code></td>
<td>
<p>Number of patients within each cohort.</p>
</td></tr>
<tr><td><code id="FBCRMSimTrial_+3A_ptrue">ptrue</code></td>
<td>
<p>True toxicity probability vector.</p>
</td></tr>
<tr><td><code id="FBCRMSimTrial_+3A_mu">mu</code></td>
<td>
<p>Prior expected toxicity probability at each dose.</p>
</td></tr>
<tr><td><code id="FBCRMSimTrial_+3A_p_rho">p_rho</code></td>
<td>
<p>Prior probability that two dose-toxicity probabilities will not cluster together.</p>
</td></tr>
<tr><td><code id="FBCRMSimTrial_+3A_sigma">sigma</code></td>
<td>
<p>Prior standard deviation for the parameter alpha.</p>
</td></tr>
<tr><td><code id="FBCRMSimTrial_+3A_mtd">mtd</code></td>
<td>
<p>Maximum Tolerated dose toxicity probability (pre defined).</p>
</td></tr>
<tr><td><code id="FBCRMSimTrial_+3A_p_u">p_u</code></td>
<td>
<p>Cut-off toxicity probability for first dose.</p>
</td></tr>
<tr><td><code id="FBCRMSimTrial_+3A_b">B</code></td>
<td>
<p>Number of Iterations to run for MCMC.</p>
</td></tr>
<tr><td><code id="FBCRMSimTrial_+3A_m">M</code></td>
<td>
<p>Number of simulations to run.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing (1) Design parameters and prior hyperparameters used for simulating the trials and (2) a summary of the trial simulation results including the percent of times each dose was selected and the average number of toxicities seen in the trial.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>max_samp=15
Cohort=3
ptrue=c(0.01,0.05,0.15,0.3,0.45,0.5,0.6,0.8)
mu=seq(0.1,0.8,0.1)
p_rho=0.9
sigma = 2
mtd = 0.3
p_u=0.9
B=200 ##Number of iterations, Change to 2k
M=10 ##Number of simulations, Change to larger
Z=FBCRMSimTrial(max_samp,Cohort,ptrue,mu,p_rho,sigma,mtd,p_u,B,M)
Z
</code></pre>

<hr>
<h2 id='GetFBCRM'>Provides the optimal dose level closest to the mtd where the next cohort of patients should be allotted based on the data.</h2><span id='topic+GetFBCRM'></span>

<h3>Description</h3>

<p>Provides the optimal dose level closest to the mtd where the next cohort of patients should be allotted based on the data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GetFBCRM(X, Y, Cohort, mu, p_rho, sigma, mtd, B, p_u)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GetFBCRM_+3A_x">X</code></td>
<td>
<p>Vector of patients allotted to each dose level.</p>
</td></tr>
<tr><td><code id="GetFBCRM_+3A_y">Y</code></td>
<td>
<p>Vector of toxicity events in each dose.</p>
</td></tr>
<tr><td><code id="GetFBCRM_+3A_cohort">Cohort</code></td>
<td>
<p>Number of patients within each cohort.</p>
</td></tr>
<tr><td><code id="GetFBCRM_+3A_mu">mu</code></td>
<td>
<p>Prior expected toxicity probability at each dose.</p>
</td></tr>
<tr><td><code id="GetFBCRM_+3A_p_rho">p_rho</code></td>
<td>
<p>Prior probability that two dose-toxicity probabilities will not cluster together.</p>
</td></tr>
<tr><td><code id="GetFBCRM_+3A_sigma">sigma</code></td>
<td>
<p>Prior standard deviation for the parameter alpha.</p>
</td></tr>
<tr><td><code id="GetFBCRM_+3A_mtd">mtd</code></td>
<td>
<p>Maximum Tolerated dose toxicity probability (pre defined).</p>
</td></tr>
<tr><td><code id="GetFBCRM_+3A_b">B</code></td>
<td>
<p>Number of Iterations to run for MCMC.</p>
</td></tr>
<tr><td><code id="GetFBCRM_+3A_p_u">p_u</code></td>
<td>
<p>Cut-off toxicity probability for first dose.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing (1) Design parameters and prior hyperparameters used for running the trials and (2) a posterior summary of the resuls, including the next dose to assign patients to.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X=c(3, 6, 3, 3, 3, 9, 15, 6)
Y=c(1, 0, 1, 0, 0, 2,  4, 5)
Cohort=3
mu=seq(0.1,0.8,0.1)
p_rho=0.9
sigma = 2
mtd = 0.3
B=2000 ##Number of iterations
p_u=0.9
Z=GetFBCRM(X, Y, Cohort, mu, p_rho, sigma, mtd, B, p_u)
Z
</code></pre>

<hr>
<h2 id='GetMFBCRM'>Provides the optimal dose level closest to the mtd where the next cohort of patients should be allotted based on the data</h2><span id='topic+GetMFBCRM'></span>

<h3>Description</h3>

<p>Provides the optimal dose level closest to the mtd where the next cohort of patients should be allotted based on the data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GetMFBCRM(X, Y, Cohort, mu_mat, p_rho, sigma, mtd, B, p_u)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GetMFBCRM_+3A_x">X</code></td>
<td>
<p>Vector of patients allotted to each dose level .</p>
</td></tr>
<tr><td><code id="GetMFBCRM_+3A_y">Y</code></td>
<td>
<p>Vector of toxicity events in each dose.</p>
</td></tr>
<tr><td><code id="GetMFBCRM_+3A_cohort">Cohort</code></td>
<td>
<p>Number of patients within each cohort.</p>
</td></tr>
<tr><td><code id="GetMFBCRM_+3A_mu_mat">mu_mat</code></td>
<td>
<p>Prior expected toxicity probability matrix at each dose.</p>
</td></tr>
<tr><td><code id="GetMFBCRM_+3A_p_rho">p_rho</code></td>
<td>
<p>Prior probability that two dose-toxicity probabilities will not cluster together.</p>
</td></tr>
<tr><td><code id="GetMFBCRM_+3A_sigma">sigma</code></td>
<td>
<p>Prior standard deviation for the parameter alpha.</p>
</td></tr>
<tr><td><code id="GetMFBCRM_+3A_mtd">mtd</code></td>
<td>
<p>Maximum Tolerated dose toxicity probability (pre defined).</p>
</td></tr>
<tr><td><code id="GetMFBCRM_+3A_b">B</code></td>
<td>
<p>Number of Iterations to run for MCMC.</p>
</td></tr>
<tr><td><code id="GetMFBCRM_+3A_p_u">p_u</code></td>
<td>
<p>Cut-off toxicity probability for first dose</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing (1) Design parameters and prior hyperparameters used for running the trials and (2) a posterior summary of the resuls, including the next dose to assign patients to.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X=c(3, 6, 3, 3, 3, 9, 15, 6)
Y=c(1, 0, 1, 0, 0, 2,  4, 5)
Cohort=3
##Skeletons for 8 doses
mu1=c(0.02,0.06,0.08,0.12,0.2,0.3,0.4,0.5)
mu2=c(0.01,0.05,0.09,0.14,0.18,0.22,0.26,0.30)
mu3=c(0.10,0.20,0.30,0.40,0.50,0.60,0.70,0.80)
mu4=c(0.20,0.30,0.40,0.50,0.60,0.65,0.70,0.75)
mu_mat=matrix(c(mu1,mu2,mu3,mu4),nrow = 4,byrow = TRUE)
p_rho=0.9
sigma = 2
mtd = 0.3
B=2000 ##Number of iterations
p_u=0.9
Z=GetMFBCRM(X, Y, Cohort, mu_mat, p_rho, sigma, mtd, B, p_u)
Z
</code></pre>

<hr>
<h2 id='MFBCRMSimTrial'>Provides simulation results using MFBCRM</h2><span id='topic+MFBCRMSimTrial'></span>

<h3>Description</h3>

<p>Provides simulation results using MFBCRM
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MFBCRMSimTrial(max_samp, Cohort, ptrue, mu_mat, p_rho, sigma, mtd, p_u, B, M)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MFBCRMSimTrial_+3A_max_samp">max_samp</code></td>
<td>
<p>Total number of patients recruited/will be recruited in the trial.</p>
</td></tr>
<tr><td><code id="MFBCRMSimTrial_+3A_cohort">Cohort</code></td>
<td>
<p>Number of patients within each cohort.</p>
</td></tr>
<tr><td><code id="MFBCRMSimTrial_+3A_ptrue">ptrue</code></td>
<td>
<p>True toxicity probability vector.</p>
</td></tr>
<tr><td><code id="MFBCRMSimTrial_+3A_mu_mat">mu_mat</code></td>
<td>
<p>Prior expected toxicity probability matrix at each dose.</p>
</td></tr>
<tr><td><code id="MFBCRMSimTrial_+3A_p_rho">p_rho</code></td>
<td>
<p>Prior probability that two dose-toxicity probabilities will not cluster together.</p>
</td></tr>
<tr><td><code id="MFBCRMSimTrial_+3A_sigma">sigma</code></td>
<td>
<p>Prior standard deviation for the parameter alpha.</p>
</td></tr>
<tr><td><code id="MFBCRMSimTrial_+3A_mtd">mtd</code></td>
<td>
<p>Maximum Tolerated dose toxicity probability (pre defined).</p>
</td></tr>
<tr><td><code id="MFBCRMSimTrial_+3A_p_u">p_u</code></td>
<td>
<p>Cut-off toxicity probability for first dose.</p>
</td></tr>
<tr><td><code id="MFBCRMSimTrial_+3A_b">B</code></td>
<td>
<p>Number of Iterations to run for MCMC.</p>
</td></tr>
<tr><td><code id="MFBCRMSimTrial_+3A_m">M</code></td>
<td>
<p>Number of simulations to run.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing (1) Design parameters and prior hyperparameters used for simulating the trials and (2) a summary of the trial simulation results including the percent of times each dose was selected and the average number of toxicities seen in the trial.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>max_samp=15   ##Change to larger size
Cohort=3
ptrue=c(0.01,0.05,0.15,0.3,0.45,0.5,0.6,0.8)
##Skeletons for 8 doses
mu1=c(0.02,0.06,0.08,0.12,0.2,0.3,0.4,0.5)
mu2=c(0.01,0.05,0.09,0.14,0.18,0.22,0.26,0.30)
mu3=c(0.10,0.20,0.30,0.40,0.50,0.60,0.70,0.80)
mu4=c(0.20,0.30,0.40,0.50,0.60,0.65,0.70,0.75)
mu_mat=matrix(c(mu1,mu2,mu3,mu4),nrow = 4,byrow = TRUE)
p_rho=0.9
sigma = 2
mtd = 0.3
p_u=0.9
B=200 ##Number of iterations, change to 2k
M=10 ##Number of simulations, change to larger
Z=MFBCRMSimTrial(max_samp,Cohort,ptrue,mu_mat,p_rho,sigma,mtd,p_u,B,M)
Z
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
