<!DOCTYPE html><html><head><title>Help for package HellCor</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {HellCor}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Chagos'>
<p>Coral fish, seabirds and reef productivity study by Graham et al (2018)</p></a></li>
<li><a href='#HellCor'>
<p>The Hellinger Correlation</p></a></li>
<li><a href='#wdemographics'>
<p>Birth rates and death rates for 229 countries in 2020</p></a></li>
<li><a href='#worlddemographics'>
<p>Birth rates and death rates for 229 countries in 2020</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>The Hellinger Correlation</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-05-16</td>
</tr>
<tr>
<td>Author:</td>
<td>Gery Geenens [aut],
  Pierre Lafaye De Micheaux [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Pierre Lafaye De Micheaux &lt;lafaye@unsw.edu.au&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Empirical value of the Hellinger correlation, a measure of dependence between
	     two continuous random variables. More details can be found in Geenens and Lafaye De Micheaux (2019) &lt;<a href="https://arxiv.org/abs/1810.10276v4">arXiv:1810.10276v4</a>&gt;. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10.0), energy, FNN, orthopolynom</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-05-17 07:03:23 UTC; lafaye</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-05-17 07:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='Chagos'>
Coral fish, seabirds and reef productivity study by Graham et al (2018)
</h2><span id='topic+Chagos'></span>

<h3>Description</h3>

<p>Data set investigated in Graham et al (2018). It contains several
variables describing fish and seabirds populations on twelve islands
of the Chagos Archipelago (British Indian Ocean Territory).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Chagos)</code></pre>


<h3>Format</h3>

<p>A data frame with 12 observations on the following 7 variables.
</p>

<dl>
<dt><code>Atoll</code></dt><dd><p>Factor with 3 levels. Atoll containing several islands.</p>
</dd>
<dt><code>Island</code></dt><dd><p>Factor with 12 levels. Name of the island.</p>
</dd>
<dt><code>Treatment</code></dt><dd><p>Factor with 2 levels. Presence or absence of
rats on the island.</p>
</dd>
<dt><code>Seabirds_ha</code></dt><dd><p>Numeric vector of the number of birds per hectare of island.</p>
</dd>
<dt><code>kg_N_ha_yr</code></dt><dd><p>Numeric vector of nitrogen input (in kg) by
seabirds per hectare of island over a one year period.</p>
</dd>
<dt><code>Number_of_fishes</code></dt><dd><p>Integer vector of the number of
fishes recorded during underwater visual surveys along the
reef crest of each island on the lagoonal side of each atoll.</p>
</dd>
<dt><code>biomass</code></dt><dd><p>numeric vector. Fish counts were converted
into biomass using published length-weight relationships from FishBase.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Geenens G., Lafaye de Micheaux P.
</p>


<h3>References</h3>

<p>Graham N. A. J., Wilson S. K., Carr P., Hoey A. S., Jennings S., MacNeil
M. A. (2018). Seabirds enhance coral reef productivity and
functioning in the absence of invasive rats. <em>Nature</em> 559, 250&ndash;253.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Chagos)
</code></pre>

<hr>
<h2 id='HellCor'>
The Hellinger Correlation
</h2><span id='topic+HellCor'></span>

<h3>Description</h3>

<p>Empirical value of the Hellinger correlation between two continuous random variables X and Y.</p>


<h3>Usage</h3>

<pre><code class='language-R'>HellCor(x, y, Kmax = 20L, Lmax = 20L, K = 0L, L = 0L,
        alpha = 6.0, pval.comp = FALSE, conf.level = NULL,
        B1 = 200, B2 = 200, C.version = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="HellCor_+3A_x">x</code></td>
<td>
<p>Sample of X-values.</p>
</td></tr>
<tr><td><code id="HellCor_+3A_y">y</code></td>
<td>
<p>Sample of Y-values.</p>
</td></tr>
<tr><td><code id="HellCor_+3A_kmax">Kmax</code></td>
<td>
<p>Maximal number of terms to consider in the expansion of
the square root of the copula density in the basis of Legendre polynomials.</p>
</td></tr>
<tr><td><code id="HellCor_+3A_lmax">Lmax</code></td>
<td>
<p>Maximal number of terms to consider in the expansion of
the square root of the copula density in the basis of Legendre polynomials.</p>
</td></tr>
<tr><td><code id="HellCor_+3A_k">K</code></td>
<td>
<p>If K and L are not equal to zero, and Kmax = Lmax = 0, the
number of terms is set to K in the expansion of
the square root of the copula density in the basis of Legendre polynomials.</p>
</td></tr>
<tr><td><code id="HellCor_+3A_l">L</code></td>
<td>
<p>If K and L are not equal to zero, and Kmax = Lmax = 0, the
number of terms is set to L in the expansion of
the square root of the copula density in the basis of Legendre polynomials.</p>
</td></tr>
<tr><td><code id="HellCor_+3A_alpha">alpha</code></td>
<td>
<p>Parameter of the Beta(alpha,alpha) distribution
used to fix boundary issues through transformation when estimating the Hellinger correlation.</p>
</td></tr>
<tr><td><code id="HellCor_+3A_pval.comp">pval.comp</code></td>
<td>
<p>Logical. Should we compute the p-value?</p>
</td></tr>
<tr><td><code id="HellCor_+3A_conf.level">conf.level</code></td>
<td>
<p>If not <code>NULL</code>, a number in (0, 1) that sets the
confidence level for the computed confidence interval.</p>
</td></tr>
<tr><td><code id="HellCor_+3A_b1">B1</code></td>
<td>
<p>Numeric. Number of Bootstrap replicates for the outer loop
in the double bootstrap procedure used to obtain the confidence
interval. Only used if <code>conf.level</code> is not <code>NULL</code>. For some
examples, one might need to increase this value to 1,000.</p>
</td></tr>
<tr><td><code id="HellCor_+3A_b2">B2</code></td>
<td>
<p>Numeric. Number of Bootstrap replicates for the inner loop
in the double bootstrap procedure used to obtain the confidence
interval. Only used if <code>conf.level</code> is not <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="HellCor_+3A_c.version">C.version</code></td>
<td>
<p>Logical. If <code>FALSE</code>, the R version is used instead
of the C version. Not really useful to change to <code>FALSE</code> unless
one wants to understand the algorithm used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When <code>Kmax = Lmax = K = L = 0</code>, the value returned in <code>Hcor</code> is the
unnormalized version of the empirical Hellinger correlation.
</p>


<h3>Value</h3>

<p>List with the following components:
</p>
<table>
<tr><td><code>Hcor</code></td>
<td>
<p>Value of the empirical Hellinger correlation.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>The p-value associated to the null hypothesis that the Hellinger correlation is
equal to 0 (computed using a Monte-Carlo simulation). Will be
<code>NA</code> if <code>pval.comp</code> is not set to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code>conf.int</code></td>
<td>
<p>Confidence interval for the population Hellinger
correlation (computed using a double Bootstrap). Will be
<code>NA</code> if <code>conf.level</code> is not set to a value in (0,1).</p>
</td></tr>
<tr><td><code>Khat</code></td>
<td>
<p>Value of <code class="reqn">K</code> selected by cross-validation, if
computed, otherwise <code>NA</code>.</p>
</td></tr>
<tr><td><code>Lhat</code></td>
<td>
<p>Value of <code class="reqn">L</code> selected by cross-validation, if computed, otherwise <code>NA</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Geenens G., Lafaye de Micheaux P.
</p>


<h3>References</h3>

<p>Geenens G., Lafaye de Micheaux P., (2018). The Hellinger correlation.   (), &ndash;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# We illustrate the application of our new measure using data extracted
#  from a study on the coral reef published in
#  [Graham, N.A.J. and Wilson, S.K. and Carr, P. and Hoey, A.S. and
#   Jennings, S. and MacNeil, M.A. (2018), Seabirds enhance coral reef
#   productivity and functioning in the absence of invasive rats, Nature,
#   559, 250--253.]. 
# The two variables we consider are the number of fishes and the nitrogen 
# input by seabirds per hectare recorded on n = 12 islands in the Chagos
# Archipelago. Nitrogen input is an indirect measure of the abundance of
# seabirds. It is worthwhile to notice that nitrogen is absorbed by algae 
# and that herbivorous fishes eat these algae. Fishes and birds living in 
# two different worlds, it might seem odd to suspect a dependence between 
# these two variables. Since our measure is tailored to capture dependence 
# induced by a lurking variable, we can suspect the existence of such a
# hidden variable. This is indeed what researchers in (Graham et al., 2018) 
# were able to show by finding that the presence and abundance of rats on 
# an island had dramatic effects on the number of seabirds (the rats eating 
# their eggs) and consequently on the input of nitrogen in seabirds' guano. 
# In turn, this would diminish the abundance of algae and fishes eating
# these algae.

data(Chagos)
n &lt;- nrow(Chagos)

par.save &lt;- par()$mfrow
par(mfrow = c(1, 2))
plot(Chagos$Seabirds_ha, Chagos$Number_of_fishes, main = "Original data",
     xlab = "Density of seabirds", ylab = "Density of fishes")
plot(rank(Chagos$Seabirds_ha) / (n + 1), rank(Chagos$Number_of_fishes) /
     (n + 1), main = "Rank-Copula transformed data",
     xlab = "Density of seabirds", ylab = "Density of fishes")
par(mfrow = par.save)

set.seed(1)
# Empirical Hellinger correlation
HellCor(Chagos$Seabirds_ha, Chagos$Number_of_fishes, pval.comp = TRUE)
# Pearson correlation
cor.test(Chagos$Seabirds_ha, Chagos$Number_of_fishes)
# Distance correlation
dcor.test(Chagos$Seabirds_ha, Chagos$Number_of_fishes, R = 200)


set.seed(1)
# Empirical Hellinger correlation
HellCor(Chagos$kg_N_ha_yr, Chagos$Seabirds_ha, pval.comp = TRUE)
# Pearson correlation
cor.test(Chagos$kg_N_ha_yr, Chagos$Seabirds_ha)
# Distance correlation
dcor.test(Chagos$kg_N_ha_yr, Chagos$Seabirds_ha, R = 200)

set.seed(1)
# Empirical Hellinger correlation
HellCor(Chagos$kg_N_ha_yr, Chagos$Number_of_fishes, pval.comp = TRUE)
# Pearson correlation
cor.test(Chagos$kg_N_ha_yr, Chagos$Number_of_fishes)
# Distance correlation
dcor.test(Chagos$kg_N_ha_yr, Chagos$Number_of_fishes, R = 200)

t.test(Chagos$kg_N_ha_yr ~ Chagos$Treatment)

######################################################################
# Geenens G., Lafaye de Micheaux P., (2020). The Hellinger correlation
######################################################################
# Figure 5.2

## Not run: 
n &lt;- 500

set.seed(1)
par(mfrow = c(3, 5))

XX &lt;- .datagenW.corrected(n)
plot(XX, xlab = expression(X[1]), ylab = expression(X[2]))
etahat &lt;- HellCor(XX[,1], XX[,2])$Hcor
title(main = substitute(W~~-~~hat(eta)==etahat, list(etahat =
round(etahat, 3))))

XX &lt;- .datagenDiamond(n)
plot(XX, xlab = expression(X[1]), ylab = expression(X[2]))
etahat &lt;- HellCor(XX[,1], XX[,2])$Hcor
title(main = substitute(Diamond~~-~~hat(eta)==etahat, list(etahat =
round(etahat, 3))))

XX &lt;- .datagenParabola.corrected(n)
plot(XX, xlab = expression(X[1]), ylab = expression(X[2]))
etahat &lt;- HellCor(XX[,1], XX[,2])$Hcor
title(main = substitute(Parabola~~-~~hat(eta)==etahat, list(etahat =
round(etahat, 3))))

XX &lt;- .datagen2Parabolas.corrected(n)
plot(XX, xlab = expression(X[1]), ylab = expression(X[2]))
etahat&lt;-HellCor(XX[,1], XX[,2])$Hcor
title(main = substitute(Two~~parabolae~~-~~hat(eta)==etahat, list(etahat
= round(etahat, 3))))

XX &lt;- .datagenCircle.corrected(n)
plot(XX, xlab = expression(X[1]), ylab = expression(X[2]))
etahat &lt;- HellCor(XX[,1], XX[,2])$Hcor
title(main = substitute(Circle~~-~~hat(eta)==etahat, list(etahat =
round(etahat, 3))))

XX &lt;- .datagen4indclouds(n)
plot(XX, xlab = expression(X[1]), ylab = expression(X[2]))
etahat &lt;- HellCor(XX[,1], XX[,2])$Hcor
title(main = substitute(4~~clouds~~-~~hat(eta)==etahat, list(etahat =
round(etahat, 3))))

XX &lt;- .datagenCubic(n)
plot(XX, xlab = expression(X[1]), ylab = expression(X[2]))
etahat &lt;- HellCor(XX[,1], XX[,2])$Hcor
title(main = substitute(Cubic~~-~~hat(eta)==etahat, list(etahat =
round(etahat, 3))))

XX &lt;- .datagenSine(n)
plot(XX, xlab = expression(X[1]), ylab = expression(X[2]))
etahat &lt;- HellCor(XX[,1], XX[,2])$Hcor
title(main = substitute(Sine~~-~~hat(eta)==etahat, list(etahat =
round(etahat, 3))))

XX &lt;- .datagenWedge(n)
plot(XX, xlab = expression(X[1]), ylab = expression(X[2]))
etahat &lt;- HellCor(XX[,1], XX[,2])$Hcor
title(main = substitute(Wedge~~-~~hat(eta)==etahat, list(etahat =
round(etahat, 3))))

XX &lt;- .datagenCross(n)
plot(XX, xlab = expression(X[1]), ylab = expression(X[2]))
etahat &lt;- HellCor(XX[,1], XX[,2])$Hcor
title(main = substitute(Cross~~-~~hat(eta)==etahat, list(etahat =
round(etahat, 3))))

XX &lt;- .datagenSpiral(n, sigma = 0.05)
plot(XX, xlab = expression(X[1]), ylab = expression(X[2]))
etahat &lt;- HellCor(XX[,1], XX[,2])$Hcor
title(main = substitute(Spiral~~-~~hat(eta)==etahat, list(etahat =
round(etahat, 3))))

XX &lt;- .datagen4Circles(n)
plot(XX, xlab = expression(X[1]), ylab = expression(X[2]))
etahat &lt;- HellCor(XX[,1], XX[,2])$Hcor
title(main = substitute(Circles~~-~~hat(eta)==etahat, list(etahat =
round(etahat, 3))))

XX &lt;- .datagenHeavisine(n)
plot(XX, xlab = expression(X[1]), ylab = expression(X[2]))
etahat &lt;- HellCor(XX[,1], XX[,2])$Hcor
title(main = substitute(Heavisine~~-~~hat(eta)==etahat, list(etahat =
round(etahat, 3))))

XX &lt;- .datagenDoppler(n)
plot(XX, xlab = expression(X[1]), ylab = expression(X[2]))
etahat&lt;-HellCor(XX[,1], XX[,2])$Hcor
title(main = substitute(Doppler~~-~~hat(eta)==etahat, list(etahat =
round(etahat, 3))))

XX &lt;- .datagen5Clouds(n)
plot(XX, xlab = expression(X[1]), ylab = expression(X[2]))
etahat &lt;- HellCor(XX[,1], XX[,2])$Hcor
title(main = substitute(5~~clouds~~-~~hat(eta)==etahat, list(etahat =
round(etahat, 3))))

## End(Not run)

############################
# Birth rate vs Death rate #
############################

data(worlddemographics)
x &lt;- wdemographics$Death.Rate.Pop
y &lt;- wdemographics$Birth.Rate.Pop
plot(x, y, xlab = "DEATHS/1,000 POPULATION", ylab =
"BIRTHS/1,000 POPULATION", main =
"Birth rate vs Death rate for 229 countries and territories (in 2020)", col = "orangered", pch = 20)
text(x, y, labels = wdemographics$Country, pos = 3, cex = 0.4, offset = 0.2)
## Not run: 
 HellCor(x, y, pval.comp = TRUE)
 cor.test(x, y) # Pearson
 dcor.test(x, y, R = 200)

## End(Not run)
</code></pre>

<hr>
<h2 id='wdemographics'>
Birth rates and death rates for 229 countries in 2020
</h2><span id='topic+worlddemographics'></span>

<h3>Description</h3>

<p>This data set contains the birth rates and death rates of 229 countries
in 2020 ranked in decreasing order.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wdemographics</code></pre>


<h3>Format</h3>

<p>Data frame with 229 observations and 3 variables.
</p>

<dl>
<dt><code>Country</code></dt><dd><p>Character. Name of the country.</p>
</dd>
<dt><code>Birth.Rate.Pop</code></dt><dd><p>Numeric. Birth rate per 1,000 habitants.</p>
</dd>
<dt><code>Death.Rate.Pop</code></dt><dd><p>Numeric. Death rate per 1,000 habitants.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Geenens G., Lafaye de Micheaux P.
</p>


<h3>References</h3>

<p>Source: The World Factbook of the Central Intelligence Agency of the
United States (<a href="https://www.cia.gov/library/publications/the-world-factbook/geos/xx.html">https://www.cia.gov/library/publications/the-world-factbook/geos/xx.html</a>).
</p>
<p>See also Figure 1.1 in &quot;A consistent test of independence between random vectors&quot;, G. Boglioni Beaulieu,
Master thesis, Universite de Montreal, (2016).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(wdemographics)
</code></pre>

<hr>
<h2 id='worlddemographics'>
Birth rates and death rates for 229 countries in 2020
</h2><span id='topic+wdemographics'></span>

<h3>Description</h3>

<p>This data set contains the birth rates and death rates of 229 countries
in 2020 ranked in decreasing order.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>worlddemographics</code></pre>


<h3>Format</h3>

<p>Data frame with 229 observations and 3 variables.
</p>

<dl>
<dt><code>Country</code></dt><dd><p>Character. Name of the country.</p>
</dd>
<dt><code>Birth.Rate.Pop</code></dt><dd><p>Numeric. Birth rate per 1,000 habitants.</p>
</dd>
<dt><code>Death.Rate.Pop</code></dt><dd><p>Numeric. Death rate per 1,000 habitants.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Geenens G., Lafaye de Micheaux P.
</p>


<h3>References</h3>

<p>Source: The World Factbook of the Central Intelligence Agency of the
United States (<a href="https://www.cia.gov/library/publications/the-world-factbook/geos/xx.html">https://www.cia.gov/library/publications/the-world-factbook/geos/xx.html</a>).
</p>
<p>See also Figure 1.1 in &quot;A consistent test of independence between random vectors&quot;, G. Boglioni Beaulieu,
Master thesis, Universite de Montreal, (2016).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(worlddemographics)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
