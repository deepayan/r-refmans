<!DOCTYPE html><html lang="en"><head><title>Help for package MFDFA</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MFDFA}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#MFDFA'><p>MultiFractal Detrended Fluctuation Analysis</p></a></li>
<li><a href='#MFsim'><p>Simulated multifractal series.</p></a></li>
<li><a href='#MFXDFA'><p>Multifractal detrended cross-correlation analysis</p></a></li>
<li><a href='#MMA'><p>Multiscale Multifractal Analysis</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>MultiFractal Detrended Fluctuation Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1</td>
</tr>
<tr>
<td>Author:</td>
<td>Mohamed Laib [aut, cre],
  Luciano Telesca [aut],
  Mikhail Kanevski [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Mohamed Laib &lt;laib.med@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Contains the MultiFractal Detrended Fluctuation Analysis (MFDFA), 
  MultiFractal Detrended Cross-Correlation Analysis (MFXDFA), and the Multiscale
  Multifractal Analysis (MMA). The MFDFA() function proposed in this package was 
  used in Laib et al. (&lt;<a href="https://doi.org/10.1016%2Fj.chaos.2018.02.024">doi:10.1016/j.chaos.2018.02.024</a>&gt; and &lt;<a href="https://doi.org/10.1063%2F1.5022737">doi:10.1063/1.5022737</a>&gt;). 
  See references for more information. Interested users can find a parallel version of
  the MFDFA() function on GitHub.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>numbers</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://mlaib.github.io">https://mlaib.github.io</a></td>
</tr>
<tr>
<td>Note:</td>
<td>The originale code was in matlab, see details below.</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-04-15 14:25:00 UTC; Mohamed</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-04-15 15:22:53 UTC</td>
</tr>
</table>
<hr>
<h2 id='MFDFA'>MultiFractal Detrended Fluctuation Analysis</h2><span id='topic+MFDFA'></span>

<h3>Description</h3>

<p>Applies the MultiFractal Detrended Fluctuation Analysis (MFDFA) to time series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MFDFA(tsx, scale, m=1, q)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MFDFA_+3A_tsx">tsx</code></td>
<td>
<p>Univariate time series (must be a vector).</p>
</td></tr>
<tr><td><code id="MFDFA_+3A_scale">scale</code></td>
<td>
<p>Vector of scales. There is no default value
for this parameter, please add values.</p>
</td></tr>
<tr><td><code id="MFDFA_+3A_m">m</code></td>
<td>
<p>An integer of the polynomial order for the detrending (by default m=1).</p>
</td></tr>
<tr><td><code id="MFDFA_+3A_q">q</code></td>
<td>
<p>q-order of the moment. There is no default value
for this parameter, please add values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The original code of this function is in Matlab, you can find it on the
following website <a href="https://ch.mathworks.com/matlabcentral/fileexchange/38262-multifractal-detrended-fluctuation-analyses?focused=5247306&amp;tab=function">Mathworks</a>.
</p>


<h3>Value</h3>

<p>A list of the following elements:
</p>

<ul>
<li> <p><code>Hq</code> Hurst exponent.
</p>
</li>
<li> <p><code>tau_q</code> Mass exponent.
</p>
</li>
<li> <p><code>spec</code> Multifractal spectrum (<code class="reqn">\alpha</code> and
<code class="reqn">f(\alpha)</code>)
</p>
</li>
<li> <p><code>Fq</code> Fluctuation function.
</p>
</li></ul>



<h3>References</h3>

<p>J. Feder, Fractals, Plenum Press, New York, NY, USA, 1988.
</p>
<p>Espen A. F. Ihlen, Introduction to multifractal detrended fluctuation analysis
in matlab, Frontiers in Physiology: Fractal Physiology, 3 (141),(2012) 1-18.
</p>
<p>J. W. Kantelhardt, S. A. Zschiegner, E. Koscielny-Bunde, S. Havlin,
A. Bunde, H. Stanley, Multifractal detrended fluctuation analysis of
nonstationary time series, Physica A: Statistical Mechanics and its
Applications, 316 (1) (2002) 87 – 114.
</p>
<p>Kantelhardt J.W. (2012) Fractal and Multifractal Time Series. In: Meyers R. (eds)
Mathematics of Complexity and Dynamical Systems. Springer, New York, NY.
</p>
<p>M. Laib, L. Telesca and M. Kanevski, Long-range fluctuations and
multifractality in connectivity density time series of a wind speed
monitoring network, Chaos: An Interdisciplinary Journal of Nonlinear
Science, 28 (2018) p. 033108, <a href="https://aip.scitation.org/doi/10.1063/1.5022737">Paper</a>.
</p>
<p>M. Laib, J. Golay, L. Telesca, M. Kanevski, Multifractal
analysis of the time series of daily means of wind speed
in complex regions, Chaos, Solitons &amp; Fractals, 109 (2018)
pp. 118-127, <a href="https://www.sciencedirect.com/science/article/pii/S0960077918300699">Paper</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
## MFDFA package installation: from github ####
install.packages("devtools")
devtools::install_github("mlaib/MFDFA")

## Get the Parellel version:
devtools::source_gist("bb0c09df9593dad16ae270334ec3e7d7", filename = "MFDFA2.r")

## End(Not run)

library(MFDFA)
a&lt;-0.9
N&lt;-1024
tsx&lt;-MFsim(N,a)
scale=10:100
q&lt;--10:10
m&lt;-1
b&lt;-MFDFA(tsx, scale, m, q)

## Not run: 
## Results plot ####
dev.new()
par(mai=rep(1, 4))
plot(q, b$Hq, col=1, axes= F, ylab=expression('h'[q]), pch=16, cex.lab=1.8,
     cex.axis=1.8, main="Hurst exponent",
     ylim=c(min(b$Hq),max(b$Hq)))
grid(col="midnightblue")
axis(1)
axis(2)

##################################
## Suggestion of output plot: ####
## Supplementary functions: #####
reset &lt;- function(){
par(mfrow=c(1, 1), oma=rep(0, 4), mar=rep(0, 4), new=TRUE)
plot(0:1, 0:1, type="n", xlab="", ylab="", axes=FALSE)}

poly_fit&lt;-function(x,y,n){
  formule&lt;-lm(as.formula(paste('y~',paste('I(x^',1:n,')', sep='',collapse='+'))))
  res1&lt;-coef(formule)
  poly.res&lt;-res1[length(res1):1]
  allres&lt;-list(polyfit=poly.res, model1=formule)
  return(allres)}

##################################
## Output plots: #################
dev.new()
layout(matrix(c(1,2,3,4), 2, 2, byrow = TRUE),heights=c(4, 4))
## b : mfdfa output
par(mai=rep(0.8, 4))

## 1st plot: Scaling function order Fq (q-order RMS)
p1&lt;-c(1,which(q==0),which(q==q[length(q)]))
plot(log2(scale),log2(b$Fqi[,1]),  pch=16, col=1, axes = F, xlab = "s (days)",
     ylab=expression('log'[2]*'(F'[q]*')'), cex=1, cex.lab=1.6, cex.axis=1.6,
     main= "Fluctuation function Fq",
     ylim=c(min(log2(b$Fqi[,c(p1)])),max(log2(b$Fqi[,c(p1)]))))
lines(log2(scale),b$line[,1], type="l", col=1, lwd=2)
grid(col="midnightblue")
axis(2)
lbl&lt;-scale[c(1,floor(length(scale)/8),floor(length(scale)/4),
             floor(length(scale)/2),length(scale))]
att&lt;-log2(lbl)
axis(1, at=att, labels=lbl)
for (i in 2:3){
  k&lt;-p1[i]
  points(log2(scale), log2(b$Fqi[,k]),  col=i,pch=16)
  lines(log2(scale),b$line[,k], type="l", col=i, lwd=2)
}
legend("bottomright", c(paste('q','=',q[p1] , sep=' ' )),cex=2,lwd=c(2,2,2),
 bty="n", col=1:3)

## 2nd plot: q-order Hurst exponent
plot(q, b$Hq, col=1, axes= F, ylab=expression('h'[q]), pch=16, cex.lab=1.8,
    cex.axis=1.8, main="Hurst exponent", ylim=c(min(b$Hq),max(b$Hq)))
grid(col="midnightblue")
axis(1, cex=4)
axis(2, cex=4)

## 3rd plot: q-order Mass exponent
plot(q, b$tau_q, col=1, axes=F, cex.lab=1.8, cex.axis=1.8,
     main="Mass exponent",
     pch=16,ylab=expression(tau[q]))
grid(col="midnightblue")
axis(1, cex=4)
axis(2, cex=4)

## 4th plot: Multifractal spectrum
plot(b$spec$hq, b$spec$Dq, col=1, axes=F, pch=16, #main="Multifractal spectrum",
     ylab=bquote("f ("~alpha~")"),cex.lab=1.8, cex.axis=1.8,
     xlab=bquote(~alpha))
grid(col="midnightblue")
axis(1, cex=4)
axis(2, cex=4)

x1=b$spec$hq
y1=b$spec$Dq
rr&lt;-poly_fit(x1,y1,4)
mm1&lt;-rr$model1
mm&lt;-rr$polyfit
x2&lt;-seq(0,max(x1)+1,0.01)
curv&lt;-mm[1]*x2^4+mm[2]*x2^3+mm[3]*x2^2+mm[4]*x2+mm[5]
lines(x2,curv, col="red", lwd=2)
reset()
legend("top", legend="MFDFA Plots", bty="n", cex=2)

## End(Not run)
</code></pre>

<hr>
<h2 id='MFsim'>Simulated multifractal series.</h2><span id='topic+MFsim'></span>

<h3>Description</h3>

<p>Generates series using the binomial multifractal model (see references).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MFsim(N,a)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MFsim_+3A_n">N</code></td>
<td>
<p>The length of the generated multifractal series.</p>
</td></tr>
<tr><td><code id="MFsim_+3A_a">a</code></td>
<td>
<p>Exponent that takes values in [0.6, 1].</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector containing the multifractal series.
</p>


<h3>References</h3>

<p>J. Feder, Fractals, Plenum Press, New York, NY, USA, 1988.
</p>
<p>E.L. Flores-Márquez, A. Ramírez-Rojas, L. Telesca, Multifractal detrended
fluctuation analysis of earthquake magnitude series of Mexican South Pacific
Region, Applied Mathematics and Computation, Volume 265, 2015,
Pages 1106-1114, ISSN 0096-3003.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
a&lt;-0.9
N&lt;-1024
tsx&lt;-MFsim(N,a)
scale=10:100
q&lt;--10:10
m&lt;-1
b&lt;-MFDFA(tsx, scale, m, q)

dev.new()
par(mai=rep(1, 4))
plot(q, b$Hq, col=1, axes= FALSE, ylab=expression('h'[q]), pch=16, cex.lab=1.8,
     cex.axis=1.8, main="q-order Hurst exponent", ylim=c(min(b$Hq),max(b$Hq)))
grid(col="midnightblue")
axis(1)
axis(2)

## Not run: 
## Example with Levy distribution ####
require(rmutil)
tsx &lt;- rlevy(1000, 0, 1)
scale=10:100
q&lt;--10:10
m&lt;-1
b&lt;-MFDFA(tsx, scale, m, q)

dev.new()
plot(q, b$Hq, col=1, axes= F, ylab=expression('h'[q]), pch=16, cex.lab=1.8,
    cex.axis=1.8, main="Hurst exponent", ylim=c(min(b$Hq),max(b$Hq)))
grid(col="midnightblue")
axis(1, cex=4)
axis(2, cex=4)

## End(Not run)

</code></pre>

<hr>
<h2 id='MFXDFA'>Multifractal detrended cross-correlation analysis</h2><span id='topic+MFXDFA'></span>

<h3>Description</h3>

<p>Applies the MultiFractal Detrended Fluctuation cross-correlation Analysis (MFXDFA) on two time series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MFXDFA(tsx1, tsx2, scale, m=1, q)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MFXDFA_+3A_tsx1">tsx1</code></td>
<td>
<p>Univariate time series (must be a vector or a ts object).</p>
</td></tr>
<tr><td><code id="MFXDFA_+3A_tsx2">tsx2</code></td>
<td>
<p>Univariate time series (must be a vector or a ts object).</p>
</td></tr>
<tr><td><code id="MFXDFA_+3A_scale">scale</code></td>
<td>
<p>Vector of scales.</p>
</td></tr>
<tr><td><code id="MFXDFA_+3A_m">m</code></td>
<td>
<p>Polynomial order for the detrending (by default m=1).</p>
</td></tr>
<tr><td><code id="MFXDFA_+3A_q">q</code></td>
<td>
<p>q-order of the moment. There is no default value
for this parameter, please add values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of the following elements:
</p>

<ul>
<li> <p><code>Hq</code> Hurst exponent.
</p>
</li>
<li> <p><code>h</code> Holder exponent.
</p>
</li>
<li> <p><code>Dh</code> Multifractal spectrum.
</p>
</li>
<li> <p><code>Fq</code> Fluctuation function in log.
</p>
</li></ul>



<h3>Note</h3>

<p>The original code of this function is in Matlab, you can find it on the
following website <a href="https://ch.mathworks.com/matlabcentral/fileexchange/38262-multifractal-detrended-fluctuation-analyses?focused=5247306&amp;tab=function">Mathworks</a>.
</p>


<h3>References</h3>

<p>J. Feder, Fractals, Plenum Press, New York, NY, USA, 1988.
</p>
<p>Espen A. F. Ihlen, Introduction to multifractal detrended fluctuation analysis
in matlab, Frontiers in Physiology: Fractal Physiology, 3 (141),(2012) 1-18.
</p>
<p>J. W. Kantelhardt, S. A. Zschiegner, E. Koscielny-Bunde, S. Havlin,
A. Bunde, H. Stanley, Multifractal detrended fluctuation analysis of
nonstationary time series, Physica A: Statistical Mechanics and its
Applications, 316 (1) (2002) 87 – 114.
</p>
<p>Kantelhardt J.W. (2012) Fractal and Multifractal Time Series. In: Meyers R. (eds) Mathematics
of Complexity and Dynamical Systems. Springer, New York, NY.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(MFDFA)
a&lt;-0.6
N&lt;-1024

tsx1&lt;-MFsim(N,a)
b&lt;-0.8
N&lt;-1024

tsx2&lt;-MFsim(N,b)
scale=10:100
q&lt;--10:10
m&lt;-1

## Not run: 
b&lt;-MFXDFA(tsx1, tsx2, scale, m=1, q)

## Supplementary functions: #####
reset &lt;- function(){
par(mfrow=c(1, 1), oma=rep(0, 4), mar=rep(0, 4), new=TRUE)
plot(0:1, 0:1, type="n", xlab="", ylab="", axes=FALSE)}

poly_fit&lt;-function(x,y,n){
  formule&lt;-lm(as.formula(paste('y~',paste('I(x^',1:n,')', sep='',collapse='+'))))
  res1&lt;-coef(formule)
  poly.res&lt;-res1[length(res1):1]
  allres&lt;-list(polyfit=poly.res, model1=formule)
  return(allres)}

## Plot results: #####
dev.new()
layout(matrix(c(1,2,3,4), 2, 2, byrow = TRUE),heights=c(4, 4))
## b : mfdfa output
par(mai=rep(0.8, 4))

## 1st plot: Fluctuations function
p1&lt;-which(q==2)
plot(log(scale),b$Fq[,p1],  pch=16, col=1, axes = FALSE, xlab = "s",
     ylab=expression('log'*'(F'[2]*')'), cex=1, cex.lab=1.6, cex.axis=1.6,
     main= "Fluctuation function F for q=2",
     ylim=c(min(b$Fq[,c(p1)]),max(b$Fq[,c(p1)])))
lines(log(scale),b$line[,p1], type="l", col=1, lwd=2)
grid(col="midnightblue")
axis(2)
lbl&lt;-scale[c(1,floor(length(scale)/8),floor(length(scale)/4),
             floor(length(scale)/2),length(scale))]
att&lt;-log(lbl)
axis(1, at=att, labels=lbl)

## 2nd plot: q-order Hurst exponent
plot(q, b$Hq, col=1, axes= FALSE, ylab=expression('h'[q]), pch=16, cex.lab=1.8,
     cex.axis=1.8, main="Hurst exponent", ylim=c(min(b$Hq),max(b$Hq)))
grid(col="midnightblue")
axis(1, cex=4)
axis(2, cex=4)

## 3rd plot: Spectrum
plot(b$h, b$Dh, col=1, axes=FALSE, pch=16, main="Multifractal spectrum",
     ylab=bquote("f ("~alpha~")"),cex.lab=1.8, cex.axis=1.8,
     xlab=bquote(~alpha))
grid(col="midnightblue")
axis(1, cex=4)
axis(2, cex=4)

x1=b$h
y1=b$Dh
rr&lt;-poly_fit(x1,y1,4)
mm1&lt;-rr$model1
mm&lt;-rr$polyfit
x2&lt;-seq(min(x1),max(x1)+1,0.01)
curv&lt;-mm[1]*x2^4+mm[2]*x2^3+mm[3]*x2^2+mm[4]*x2+mm[5]
lines(x2,curv, col="red", lwd=2)

## End(Not run)

</code></pre>

<hr>
<h2 id='MMA'>Multiscale Multifractal Analysis</h2><span id='topic+MMA'></span>

<h3>Description</h3>

<p>Applies the Multiscale Multifractal Analysis (MMA) on time series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MMA(tsx, scale, qminmax, ovlap=0, m=2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MMA_+3A_tsx">tsx</code></td>
<td>
<p>Univariate time series (must be a vector or a ts object).</p>
</td></tr>
<tr><td><code id="MMA_+3A_scale">scale</code></td>
<td>
<p>Vector of scales.</p>
</td></tr>
<tr><td><code id="MMA_+3A_qminmax">qminmax</code></td>
<td>
<p>Vector of two values min and max of q-order of the moment.</p>
</td></tr>
<tr><td><code id="MMA_+3A_ovlap">ovlap</code></td>
<td>
<p>Overlapping parameter (By default ovlap=0: no overlapping).</p>
</td></tr>
<tr><td><code id="MMA_+3A_m">m</code></td>
<td>
<p>Polynomial order for the detrending (by defaults m=2).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix with three columns (q-order, scale (s), and the scale exponent).
</p>


<h3>Note</h3>

<p>The original code of this function is in Matlab, you can find it on the
following website <a href="https://physionet.org/physiotools/mma/">Physionet</a>. See
references below.
</p>


<h3>References</h3>

<p>J. Feder, Fractals, Plenum Press, New York, NY, USA, 1988.
</p>
<p>J. Gieraltowski, J. J. Zebrowski, and R. Baranowski,
Multiscale multifractal analysis of heart rate variability recordings
http://dx.doi.org/10.1103/PhysRevE.85.021915
</p>
<p>Goldberger AL, Amaral LAN, Glass L, Hausdorff JM, Ivanov PCh, Mark RG,
Mietus JE, Moody GB, Peng C-K, Stanley HE. PhysioBank, PhysioToolkit,
and PhysioNet: Components of a New Research Resource for Complex
Physiologic Signals. Circulation 101(23):e215-e220.
</p>
<p>J. W. Kantelhardt, S. A. Zschiegner, E. Koscielny-Bunde, S. Havlin,
A. Bunde, H. Stanley, Multifractal detrended fluctuation analysis of
nonstationary time series, Physica A: Statistical Mechanics and its
Applications, 316 (1) (2002) 87 – 114.
</p>
<p>J. Gierałtowski, J. J. Żebrowski, and R. Baranowski, &quot;Multiscale
multifractal analysis of heart rate variability recordings with a
large number of occurrences of arrhythmia,&quot; Phys. Rev. E 85, 021915 (2012)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
library(MFDFA)
library(plotly)
library(plot3D)

a&lt;-0.6
N&lt;-800
tsx&lt;-MFsim(N,a)
scale=10:100
res&lt;-MMA(tsx, scale, qminmax=c(-10,10), ovlap=0, m=2)

## Visualisation 1:
S_exponent &lt;- matrix(res[,3], nrow=length(unique(res[,1])), ncol=length(min(scale):(max(scale)/5)))
m_scale &lt;- unique(res[,2])
q &lt;- unique(res[,1])
plot_ly() %&gt;% add_surface(x = ~m_scale, y = ~q,
                         z = ~S_exponent)

## Visualisation 2:
image2D(S_exponent, xlab="q", ylab="scale", axes=F)
axis(1, seq(0,1,0.1), round(quantile(q, seq(0, 1, 0.1)), 2))
axis(2, seq(0,1,0.1), round(quantile(m_scale, seq(0, 1, 0.1)), 2))

## End(Not run)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
