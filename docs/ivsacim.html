<!DOCTYPE html><html><head><title>Help for package ivsacim</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ivsacim}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#invalidivsacim_est'><p>This is the main function to compute the estimator in C++</p></a></li>
<li><a href='#IV_center'><p>This function is to compute the centralized instrument</p></a></li>
<li><a href='#ivsacim'><p>Fitting a Cumulative Intensity Model for Exposure Effects with Instrumental Variables</p></a></li>
<li><a href='#ivsacim_est'><p>This is the main function to compute the estimator in C++</p></a></li>
<li><a href='#plot.ivsacim'><p>Plotting Estimated Cumulative Intensity function with Pointwise Confidence Intervals</p></a></li>
<li><a href='#summary.ivsacim'><p>Summarizing Cumulative Intensity Function of Treatment with Instrumental Variables</p>
Estimation Using Structural Additive Cumulative Intensity Models</a></li>
<li><a href='#treatment_status'><p>This function is to generate a grid of treatment status</p></a></li>
<li><a href='#trt_center'><p>This function is to compute the centralized treatment process given the covariates Z, L at each sorted unique event time</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Structural Additive Cumulative Intensity Models with IV</td>
</tr>
<tr>
<td>Version:</td>
<td>2.1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-01-01</td>
</tr>
<tr>
<td>Author:</td>
<td>Andrew Ying</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Andrew Ying &lt;aying9339@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>An instrumental variable estimator under structural cumulative additive intensity model is fitted, that leverages initial randomization as the IV. The estimator can be used to fit an additive hazards model under time to event data which handles treatment switching (treatment crossover) correctly. We also provide a consistent variance estimate.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0)</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-01-30 01:08:41 UTC; andrewying</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-01-30 03:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='invalidivsacim_est'>This is the main function to compute the estimator in C++</h2><span id='topic+invalidivsacim_est'></span>

<h3>Description</h3>

<p>This is the main function to compute the estimator in C++
</p>


<h3>Usage</h3>

<pre><code class='language-R'>invalidivsacim_est(
  time,
  event,
  stime,
  Z,
  Z_c,
  D_status,
  D_status_c,
  Z_model_mat,
  eps_1,
  D_model_mat,
  eps_2,
  weights
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="invalidivsacim_est_+3A_time">time</code></td>
<td>
<p>censored event time</p>
</td></tr>
<tr><td><code id="invalidivsacim_est_+3A_event">event</code></td>
<td>
<p>event indicator</p>
</td></tr>
<tr><td><code id="invalidivsacim_est_+3A_stime">stime</code></td>
<td>
<p>unique sorted noncensored event time</p>
</td></tr>
<tr><td><code id="invalidivsacim_est_+3A_z">Z</code></td>
<td>
<p>the instrument</p>
</td></tr>
<tr><td><code id="invalidivsacim_est_+3A_z_c">Z_c</code></td>
<td>
<p>centered IV</p>
</td></tr>
<tr><td><code id="invalidivsacim_est_+3A_d_status">D_status</code></td>
<td>
<p>treatment process at each noncensored event time</p>
</td></tr>
<tr><td><code id="invalidivsacim_est_+3A_d_status_c">D_status_c</code></td>
<td>
<p>centered treatment process at each noncensored event time</p>
</td></tr>
<tr><td><code id="invalidivsacim_est_+3A_z_model_mat">Z_model_mat</code></td>
<td>
<p>bread matrix from modeling IV</p>
</td></tr>
<tr><td><code id="invalidivsacim_est_+3A_eps_1">eps_1</code></td>
<td>
<p>influence function from modeling IV</p>
</td></tr>
<tr><td><code id="invalidivsacim_est_+3A_d_model_mat">D_model_mat</code></td>
<td>
<p>bread matrix from modeling treatment</p>
</td></tr>
<tr><td><code id="invalidivsacim_est_+3A_eps_2">eps_2</code></td>
<td>
<p>influence function from modeling treatment</p>
</td></tr>
<tr><td><code id="invalidivsacim_est_+3A_weights">weights</code></td>
<td>
<p>optional weights</p>
</td></tr>
</table>

<hr>
<h2 id='IV_center'>This function is to compute the centralized instrument</h2><span id='topic+IV_center'></span>

<h3>Description</h3>

<p>This function is to compute the centralized instrument
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IV_center(Z, weights)
</code></pre>

<hr>
<h2 id='ivsacim'>Fitting a Cumulative Intensity Model for Exposure Effects with Instrumental Variables</h2><span id='topic+ivsacim'></span>

<h3>Description</h3>

<p>ivsacim is used to fit cumulative intensity models for exposure effects with instrumental variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ivsacim(
  time,
  event,
  instrument,
  IV_valid = TRUE,
  treatment_init,
  treatment_shift_time = NULL,
  max_time = NULL,
  max_time_bet = NULL,
  n_sim = 0,
  weights = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ivsacim_+3A_time">time</code></td>
<td>
<p>the censored event time</p>
</td></tr>
<tr><td><code id="ivsacim_+3A_event">event</code></td>
<td>
<p>event indicator</p>
</td></tr>
<tr><td><code id="ivsacim_+3A_instrument">instrument</code></td>
<td>
<p>the instrumental variable</p>
</td></tr>
<tr><td><code id="ivsacim_+3A_iv_valid">IV_valid</code></td>
<td>
<p>whether assuming IV satisfies the exclusion restriction</p>
</td></tr>
<tr><td><code id="ivsacim_+3A_treatment_init">treatment_init</code></td>
<td>
<p>the initial treatment assignment</p>
</td></tr>
<tr><td><code id="ivsacim_+3A_treatment_shift_time">treatment_shift_time</code></td>
<td>
<p>the shift time of each subject, if no shift for a subject, set as 0</p>
</td></tr>
<tr><td><code id="ivsacim_+3A_max_time">max_time</code></td>
<td>
<p>the max time that we threshold for nonconstant effect</p>
</td></tr>
<tr><td><code id="ivsacim_+3A_max_time_bet">max_time_bet</code></td>
<td>
<p>the max time that we threshold for constant effect</p>
</td></tr>
<tr><td><code id="ivsacim_+3A_n_sim">n_sim</code></td>
<td>
<p>the number of resampling, set as 0 if no resampling is needed</p>
</td></tr>
<tr><td><code id="ivsacim_+3A_weights">weights</code></td>
<td>
<p>optional weights used in the estimating equation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ivsacim returns an object of class &quot;ivsacim&quot;.
An object of class &quot;ivsacim&quot; is a list containing the following components:
</p>
<table>
<tr><td><code>stime</code></td>
<td>
<p>an estimate of the baseline hazards function</p>
</td></tr>
<tr><td><code>dB_D</code></td>
<td>
<p>an estimate of the increment of the treatment effect</p>
</td></tr>
<tr><td><code>B_D</code></td>
<td>
<p>an estimate of the treatment effect</p>
</td></tr>
<tr><td><code>beta_D</code></td>
<td>
<p>an estimate of the constant treatment effect</p>
</td></tr>
<tr><td><code>B_D_se</code></td>
<td>
<p>an estimate of the variance covariance matrix of B_D</p>
</td></tr>
<tr><td><code>beta_D_se</code></td>
<td>
<p>an estimate of the constant treatment effect</p>
</td></tr>
<tr><td><code>by_prod</code></td>
<td>
<p>a byproduct, that will used by other functions</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>n = 400
event = rbinom(n, 1, 0.8)
IV = rbinom(n, 1, 0.5)
trt_init = IV
trt_shift = rep(0, n)
time = rexp(n)/(0.5 + trt_init * 0.2)
max_t = 3
max_t_bet = 3
n_sim = 0
fit &lt;- ivsacim(time, event, IV, TRUE, trt_init, 
trt_shift, max_t, max_t_bet, n_sim)
</code></pre>

<hr>
<h2 id='ivsacim_est'>This is the main function to compute the estimator in C++</h2><span id='topic+ivsacim_est'></span>

<h3>Description</h3>

<p>This is the main function to compute the estimator in C++
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ivsacim_est(time, event, stime, Zc, D_status, eps_1, Zc_dot, weights)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ivsacim_est_+3A_time">time</code></td>
<td>
<p>censored event time</p>
</td></tr>
<tr><td><code id="ivsacim_est_+3A_event">event</code></td>
<td>
<p>event indicator</p>
</td></tr>
<tr><td><code id="ivsacim_est_+3A_stime">stime</code></td>
<td>
<p>unique sorted noncensored event time</p>
</td></tr>
<tr><td><code id="ivsacim_est_+3A_zc">Zc</code></td>
<td>
<p>centered IV</p>
</td></tr>
<tr><td><code id="ivsacim_est_+3A_d_status">D_status</code></td>
<td>
<p>treatment process at each noncensored event time</p>
</td></tr>
<tr><td><code id="ivsacim_est_+3A_eps_1">eps_1</code></td>
<td>
<p>influence function from modeling IV</p>
</td></tr>
<tr><td><code id="ivsacim_est_+3A_zc_dot">Zc_dot</code></td>
<td>
<p>bread matrix from modeling IV</p>
</td></tr>
<tr><td><code id="ivsacim_est_+3A_weights">weights</code></td>
<td>
<p>optional weights</p>
</td></tr>
</table>

<hr>
<h2 id='plot.ivsacim'>Plotting Estimated Cumulative Intensity function with Pointwise Confidence Intervals</h2><span id='topic+plot.ivsacim'></span>

<h3>Description</h3>

<p>The function will plot the estimated cumulative intensity function of the treatment after fitting.
Corresponding pointwise confidence intervals at level alpha are also included.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ivsacim'
plot(x, gof = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.ivsacim_+3A_x">x</code></td>
<td>
<p>the fitting object after fitting IVSACIM model</p>
</td></tr>
<tr><td><code id="plot.ivsacim_+3A_gof">gof</code></td>
<td>
<p>whether to draw the goodness-of-fit plot</p>
</td></tr>
<tr><td><code id="plot.ivsacim_+3A_...">...</code></td>
<td>
<p>the other arguments you want to put in the built-in plot function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for side effects
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n = 400
event = rbinom(n, 1, 0.8)
IV = rbinom(n, 1, 0.5)
trt_init = IV
trt_shift = rep(0, n)
time = rexp(n)/(0.5 + trt_init * 0.2)
max_t = 3
max_t_bet = 3
n_sim = 100
fit &lt;- ivsacim(time, event, IV, IV_valid = TRUE, trt_init, trt_shift, max_t, max_t_bet, n_sim)
plot(fit, main = "", xlab = "Time", ylab = "Cumulative Intensity Function")
plot(fit, gof = TRUE, xlab = "Time", ylab = "")
</code></pre>

<hr>
<h2 id='summary.ivsacim'>Summarizing Cumulative Intensity Function of Treatment with Instrumental Variables 
Estimation Using Structural Additive Cumulative Intensity Models</h2><span id='topic+summary.ivsacim'></span><span id='topic+print.summary.ivsacim'></span>

<h3>Description</h3>

<p>summary method for class &quot;ivsacim&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ivsacim'
summary(object, ...)

## S3 method for class 'summary.ivsacim'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.ivsacim_+3A_object">object</code></td>
<td>
<p>an object of class &quot;ivsacim&quot;, usually, a result of a call to ivsacim.</p>
</td></tr>
<tr><td><code id="summary.ivsacim_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
<tr><td><code id="summary.ivsacim_+3A_x">x</code></td>
<td>
<p>an object of class &quot;summary.ivsacim&quot;, usually, a result of a call to summary.ivsacim.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>print.summary.ivsacim tries to be smart about formatting coefficients, an estimated variance covariance matrix of
the coeffieients, Z-values and the corresponding P-values.
</p>


<h3>Value</h3>

<p>The function summary.ivsacim computes and returns a list of summary statistics of the fitted model given in object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n = 400
event = rbinom(n, 1, 0.8) 
IV = rbinom(n, 1, 0.5)
trt_init = IV
trt_shift = rep(0, n)
time = rexp(n)/(0.5 + trt_init * 0.2)
max_t = 3
max_t_bet = 3
n_sim = 0
fit &lt;- ivsacim(time, event, IV, IV_valid = TRUE, trt_init, trt_shift, max_t, max_t_bet, n_sim)
summary(fit)
</code></pre>

<hr>
<h2 id='treatment_status'>This function is to generate a grid of treatment status</h2><span id='topic+treatment_status'></span>

<h3>Description</h3>

<p>This function is to generate a grid of treatment status
</p>


<h3>Usage</h3>

<pre><code class='language-R'>treatment_status(N, K, stime, treatment_init, treatment_shift_time, max_time)
</code></pre>

<hr>
<h2 id='trt_center'>This function is to compute the centralized treatment process given the covariates Z, L at each sorted unique event time</h2><span id='topic+trt_center'></span>

<h3>Description</h3>

<p>This function is to compute the centralized treatment process given the covariates Z, L at each sorted unique event time
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trt_center(D_status, Z, weights)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
