<!DOCTYPE html><html><head><title>Help for package RXshrink</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {RXshrink}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#aug.lars'><p>Maximum Likelihood Estimation of Effects in Least Angle Regression</p></a></li>
<li><a href='#correct.signs'><p>Normal-Theory Maximum Likelihood Estimation of Beta Coefficients with &quot;Correct&quot; Signs</p></a></li>
<li><a href='#eff.aug'><p>Augment calculations performed by eff.ridge() to prepare for display of eliptical confidence</p>
regions for pairs of biased coefficient estimates using plot.eff.biv()</a></li>
<li><a href='#eff.biv'><p>Specify pairs of GRR Coefficient Estimates for display in Bivariate Confidence Regions</p></a></li>
<li><a href='#eff.ridge'><p>Efficient Maximum Likelihood (ML) Shrinkage via the Shortest Piecewise Linear-Spline PATH</p></a></li>
<li><a href='#haldport'><p>Portland Cement data of Hald(1952)</p></a></li>
<li><a href='#longley2'><p>Art Hoerl's update of the infamous Longley(1967) benchmark dataset</p></a></li>
<li><a href='#meff'><p>m-Extents of Shrinkage used in eff.ridge() Calculations.</p></a></li>
<li><a href='#MLboot'><p>Calculate Bootstrap distribution of Unrestricted Maximum Likelihood (ML)</p>
point-estimates for a Linear Model.</a></li>
<li><a href='#MLcalc'><p>Calculate Efficient Maximum Likelihood (ML) point-estimates for a Linear Model that</p>
are either Unbiased (OLS) or Most Likely to be Optimally Biased under Normal-distribution
theory.</a></li>
<li><a href='#MLhist'><p>Plot method for MLboot objects</p></a></li>
<li><a href='#MLtrue'><p>Simulate data for Linear Models with known Parameter values and Normal Errors</p></a></li>
<li><a href='#mpg'><p>Hocking(1976) Miles Per Gallon data: a Multiple Regression Benchmark</p></a></li>
<li><a href='#plot.aug.lars'><p>Plot method for aug.lars objects</p></a></li>
<li><a href='#plot.eff.biv'><p>Plot method for eff.biv objects</p></a></li>
<li><a href='#plot.eff.ridge'><p>Plot method for eff.ridge objects</p></a></li>
<li><a href='#plot.qm.ridge'><p>Plot method for qm.ridge objects</p></a></li>
<li><a href='#plot.RXpredict'><p>Plot method for RXpredict objects</p></a></li>
<li><a href='#plot.syxi'><p>Plot method for syxi objects</p></a></li>
<li><a href='#plot.uc.lars'><p>Plot method for uc.lars objects</p></a></li>
<li><a href='#plot.YonX'><p>Plot method for YonX objects</p></a></li>
<li><a href='#qm.ridge'><p>Restricted (2-parameter) Maximum Likelihood Shrinkage in Regression</p></a></li>
<li><a href='#RXpredict'><p>Predictions from Models fit using RXshrink Generalized Ridge Estimation Methods.</p></a></li>
<li><a href='#RXshrink-internal'><p>Internal RXshrink functions</p></a></li>
<li><a href='#RXshrink-package'><p>Maximum Likelihood (ML) Shrinkage using Generalized Ridge or Least Angle Regression</p></a></li>
<li><a href='#syxi'><p>Linear and GAM Spline Predictions from a Single x-Variable</p></a></li>
<li><a href='#tycobb'><p>Ty Cobb batting statistics for 1905&ndash;1928 with Carl Morris' 2-piece Spline term.</p></a></li>
<li><a href='#uc.lars'><p>Maximum Likelihood Least Angle Regression on Uncorrelated X-Components</p></a></li>
<li><a href='#YonX'><p>Maximum Likelihood (ML) Shrinkage in Simple Linear Regression</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Maximum Likelihood Shrinkage using Generalized Ridge or Least
Angle Regression</td>
</tr>
<tr>
<td>Version:</td>
<td>2.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-08-15</td>
</tr>
<tr>
<td>Author:</td>
<td>Bob Obenchain </td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Bob Obenchain &lt;wizbob@att.net&gt;</td>
</tr>
<tr>
<td>Imports:</td>
<td>lars, ellipse</td>
</tr>
<tr>
<td>Suggests:</td>
<td>mgcv</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions are provided to calculate and display ridge TRACE Diagnostics for a 
  variety of alternative Shrinkage Paths. While all methods focus on Maximum Likelihood 
  estimation of unknown true effects under normal distribution-theory, some estimates are 
  modified to be Unbiased or to have "Correct Range" when estimating either [1] the noncentrality 
  of the F-ratio for testing that true Beta coefficients are Zeros or [2] the "relative" MSE 
  Risk (i.e. MSE divided by true sigma-square, where the "relative" variance of OLS is known.) 
  The eff.ridge() function implements the "Efficient Shrinkage Path" introduced in Obenchain
  (2022) &lt;Open Statistics&gt;. This "p-Parameter" Shrinkage-Path always passes through the
  vector of regression coefficient estimates Most-Likely to achieve the overall Optimal
  Variance-Bias Trade-Off and is the shortest Path with this property. Functions eff.aug() and
  eff.biv() augment the calculations made by eff.ridge() to provide plots of the bivariate
  confidence ellipses corresponding to any of the p*(p-1) possible ordered pairs of shrunken
  regression coefficients. Functions for plotting TRACE Diagnostics now have more options. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://www.R-project.org">https://www.R-project.org</a> , <a href="http://localcontrolstatistics.org">http://localcontrolstatistics.org</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-06 16:37:58 UTC; bobo</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-07 19:30:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='aug.lars'>Maximum Likelihood Estimation of Effects in Least Angle Regression</h2><span id='topic+aug.lars'></span>

<h3>Description</h3>

<p>These functions perform calculations that determine whether least angle and lasso regression
estimates correspond to generalized ridge regression (GRR) estimates (i.e. whether they use
shrinkage delta-factors that are both non-negative and strictly less than 1.0). They also
estimate the Normal-theory likelihood that MSE risk is minimized and compute diagnostics for
display in ridge TRACE plots.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aug.lars(form, data, rscale = 1, type = "lar", trace = FALSE, 
    eps = .Machine$double.eps, omdmin = 9.9e-13) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aug.lars_+3A_form">form</code></td>
<td>
<p>A regression formula [y~x1+x2+...] suitable for use with lm().</p>
</td></tr>
<tr><td><code id="aug.lars_+3A_data">data</code></td>
<td>
<p>Data frame containing observations on all variables in the formula.</p>
</td></tr>
<tr><td><code id="aug.lars_+3A_rscale">rscale</code></td>
<td>
<p>One of three possible choices (0, 1 or 2) for &quot;rescaling&quot; of variables
(after being &quot;centered&quot;) to remove all &quot;non-essential&quot; ill-conditioning:  0 implies no
rescaling; 1 implies divide each variable by its standard error; 2 implies rescale as
in option 1 but re-express answers as in option 0.</p>
</td></tr>
<tr><td><code id="aug.lars_+3A_type">type</code></td>
<td>
<p>One of &quot;lasso&quot;, &quot;lar&quot; or &quot;forward.stagewise&quot; for function lars(). Names can be
abbreviated to any unique substring. Default in aug.lars() is &quot;lar&quot;.</p>
</td></tr>
<tr><td><code id="aug.lars_+3A_trace">trace</code></td>
<td>
<p>If TRUE, lars() function prints out its progress.</p>
</td></tr>
<tr><td><code id="aug.lars_+3A_eps">eps</code></td>
<td>
<p>The effective zero for lars().</p>
</td></tr>
<tr><td><code id="aug.lars_+3A_omdmin">omdmin</code></td>
<td>
<p>Strictly positive minimum allowed value for one-minus-delta (default = 9.9e-013.)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>aug.lars() calls the Efron/Hastie lars() function to perform Least Angle Regression on
x-variables that have been centered and possibly rescaled but which may be (highly) correlated.
Maximum likelihood TRACE displays paralleling those of eff.ridge() and qm.ridge() are also
computed and (optionally) plotted. 
</p>


<h3>Value</h3>

<p> An output list object of class aug.lars:
</p>
<table>
<tr><td><code>form</code></td>
<td>
<p>The regression formula specified as the first argument.</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>Name of the data.frame object specified as the second argument.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>Number of regression predictor variables.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>Number of complete observations after removal of all missing values.</p>
</td></tr>
<tr><td><code>r2</code></td>
<td>
<p>Numerical value of R-square goodness-of-fit statistic.</p>
</td></tr>
<tr><td><code>s2</code></td>
<td>
<p>Numerical value of the residual mean square estimate of error.</p>
</td></tr>
<tr><td><code>prinstat</code></td>
<td>
<p>Listing of principal statistics.</p>
</td></tr>
<tr><td><code>gmat</code></td>
<td>
<p>Orthogonal matrix of direction cosines for regressor principal axes.</p>
</td></tr>
<tr><td><code>lars</code></td>
<td>
<p>An object of class lars.</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p>Matrix of shrinkage-ridge regression coefficient estimates.</p>
</td></tr>
<tr><td><code>risk</code></td>
<td>
<p>Matrix of MSE risk estimates for fitted coefficients.</p>
</td></tr>
<tr><td><code>exev</code></td>
<td>
<p>Matrix of excess MSE eigenvalues (ordinary least squares minus ridge.)</p>
</td></tr>
<tr><td><code>infd</code></td>
<td>
<p>Matrix of direction cosines for the estimated inferior direction, if any.</p>
</td></tr>
<tr><td><code>spat</code></td>
<td>
<p>Matrix of shrinkage pattern multiplicative delta factors.</p>
</td></tr>
<tr><td><code>mlik</code></td>
<td>
<p>Listing of criteria for maximum likelihood selection of M-extent-of-shrinkage.</p>
</td></tr>
<tr><td><code>sext</code></td>
<td>
<p>Listing of summary statistics for all M-extents-of-shrinkage.</p>
</td></tr>
<tr><td><code>mClk</code></td>
<td>
<p>Most Likely Extent of Shrinkage Observed: best multiple of (1/steps) &lt;= p.</p>
</td></tr>
<tr><td><code>minC</code></td>
<td>
<p>Minimum Observed Value of Normal-theory -2*log(Likelihood-Ratio).</p>
</td></tr>    
</table>


<h3>Author(s)</h3>

<p>Bob Obenchain &lt;wizbob@att.net&gt;</p>


<h3>References</h3>

<p>Breiman L. (1995) Better subset regression using the non-negative garrote.
<em>Technometrics</em> <b>37</b>, 373-384.
</p>
<p>Efron B, Hastie T, Johnstone I, Tibshirani R. (2003)
Least angle regression. <em>Annals of Statistics</em> <b>32</b>, 407-499.
</p>
<p>Hastie T, Efron, B. (2013) lars: Least Angle Regression, Lasso and Forward Stagewise.
ver 1.2, <a href="https://CRAN.R-project.org/package=lars">https://CRAN.R-project.org/package=lars</a>  
</p>
<p>Obenchain RL. (2022) <em>RXshrink_in_R.PDF</em> RXshrink package vignette-like document,
Version 2.1. <a href="http://localcontrolstatistics.org">http://localcontrolstatistics.org</a>
</p>
<p>Tibshirani R. (1996) Regression shrinkage and selection via the lasso.
<em>J. Roy. Stat. Soc. B</em>  <b>58</b>, 267-288.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+uc.lars">uc.lars</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(longley2)
  form &lt;- GNP~GNP.deflator+Unemployed+Armed.Forces+Population+Year+Employed
  rxlobj &lt;- aug.lars(form, data=longley2)
  rxlobj
  plot(rxlobj)
  str(rxlobj)
</code></pre>

<hr>
<h2 id='correct.signs'>Normal-Theory Maximum Likelihood Estimation of Beta Coefficients with &quot;Correct&quot; Signs</h2><span id='topic+correct.signs'></span>

<h3>Description</h3>

<p>Obenchain(1978) discussed the risk of linear generalized ridge estimators in individual directions
within p-dimensional X-space. While shrinkage to ZERO is clearly optimal for all directions
strictly ORTHOGONAL to the true BETA, he showed that optimal shrinkage in the UNKNOWN direction
PARALLEL to the true BETA is possible. This optimal BETA estimate is of the form k * X'y, where
k is the positive scalar given in equation (4.2), page 1118. The correct.signs() function computes
this estimate, B(=), that uses GRR delta-shrinkage factors proportional to X-matrix eigenvalues.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  correct.signs(form, data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="correct.signs_+3A_form">form</code></td>
<td>
<p>A regression formula [y~x1+x2+...] suitable for use with lm().</p>
</td></tr>
<tr><td><code id="correct.signs_+3A_data">data</code></td>
<td>
<p>Data frame containing observations on all variables in the formula.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Ill-conditioned (nearly multi-collinear) regression models can produce Ordinary Least
Squares estimates with numerical signs that differ from those of the X'y vector. This is disturbing
because X'y contains the sample <b>correlations</b> between the X-predictor variables and
y-response variable. After all, these variables have been &quot;centered&quot; by subtracting off their
mean values and rescaled to vectors of length one.  Besides displaying OLS estimates, the
correct.signs() function also displays the &quot;correlation form&quot; of X'y, the estimated delta-shrinkage
factors, and the k-rescaled beta-coefficients. Finally, the &quot;Bfit&quot; vector of estimates proportional
to B(=) is displayed that minimizes the restricted Residual Sum-of-Squares. This restricted RSS of
Bfit cannot, of course, be less than the RSS of OLS, but it can be MUCH less that the RSS of B(=)
whenever B(=) shrinkage appears excessive.
</p>


<h3>Value</h3>

<p> An output list object of class &quot;correct.signs&quot;:
</p>
<table>
<tr><td><code>data</code></td>
<td>
<p>Name of the data.frame object specified as the second argument.</p>
</td></tr>
<tr><td><code>form</code></td>
<td>
<p>The regression formula specified as the first argument.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>Number of regression predictor variables.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>Number of complete observations after removal of all missing values.</p>
</td></tr>
<tr><td><code>r2</code></td>
<td>
<p>Numerical value of R-square goodness-of-fit statistic.</p>
</td></tr>
<tr><td><code>s2</code></td>
<td>
<p>Numerical value of the residual mean square estimate of error.</p>
</td></tr>
<tr><td><code>prinstat</code></td>
<td>
<p>Listing of principal statistics (p by 5) from qm.ridge().</p>
</td></tr>
<tr><td><code>kpb</code></td>
<td>
<p>Maximum likelihood estimate of k-factor in equation (4.2) of Obenchain(1978).</p>
</td></tr>
<tr><td><code>bmf</code></td>
<td>
<p>Rescaling factor for B(=) to minimize the Residual Sum-of-Squares.</p>
</td></tr>
<tr><td><code>signs</code></td>
<td>
<p>Listing of five Beta coefficient statistics (p by 5): OLS, X'y, Delta, B(=) and Bfit.</p>
</td></tr>
<tr><td><code>loff</code></td>
<td>
<p>Lack-of-Fit statistics: Residual Sum-of-Squares for OLS, X'y, B(=) and Bfit.</p>
</td></tr>
<tr><td><code>sqcor</code></td>
<td>
<p>Squared Correlation between the y-vector and its predicted values. The two values
displayed are for OLS predictions or for predictions using Bfit, X'y or B(=). These two values
are the familiar R^2 coefficients of determination for OLS and Bfit.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Bob Obenchain &lt;wizbob@att.net&gt;</p>


<h3>References</h3>

<p>Obenchain RL. (1978) Good and Optimal Ridge Estimators. <em>Annals of Statistics</em>
<b>6</b>, 1111-1121. <a href="https://doi.org/10.1214/aos/1176344314">doi:10.1214/aos/1176344314</a>
</p>
<p>Obenchain RL. (2022) <em>RXshrink_in_R.PDF</em> RXshrink package vignette-like document,
Version 2.2. <a href="http://localcontrolstatistics.org">http://localcontrolstatistics.org</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+eff.ridge">eff.ridge</a></code>, <code><a href="#topic+qm.ridge">qm.ridge</a></code> and <code><a href="#topic+MLtrue">MLtrue</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(longley2)
  form &lt;- GNP~GNP.deflator+Unemployed+Armed.Forces+Population+Year+Employed
  rxcsobj &lt;- correct.signs(form, data=longley2)
  rxcsobj
  str(rxcsobj)
</code></pre>

<hr>
<h2 id='eff.aug'>Augment calculations performed by eff.ridge() to prepare for display of eliptical confidence
regions for pairs of biased coefficient estimates using plot.eff.biv()</h2><span id='topic+eff.aug'></span>

<h3>Description</h3>

<p>This function makes classical (rather than Bayesian) Normal distribution-theory calculations of the
form proposed in Obenchain(1977). Instead of providing &quot;new&quot; confidence regions for estimable linear 
functions, Generalized Ridge Regression (GRR) can focus interest on estimates that are within
traditional confidence intervals and regions but which deviate reasonably from the centroid of that
interval or region.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  eff.aug(efobj)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eff.aug_+3A_efobj">efobj</code></td>
<td>
<p>An output object of class &quot;eff.ridge&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p> An output list object of class &quot;eff.aug&quot;...
</p>
<table>
<tr><td><code>p</code></td>
<td>
<p>Number of regression predictor variables.</p>
</td></tr>
<tr><td><code>LMobj</code></td>
<td>
<p>The lm() output object for the model fitted using eff.ridge().</p>
</td></tr>
<tr><td><code>bstar</code></td>
<td>
<p>The p by 3 matrix of GRR coefficients. Column 1 contains OLS estimates, the middle
column gives optimally biased coefficient estimates corresponding to the &quot;Interior Knot&quot; on all
p of the Two-Piece Linear Splines, and column 3 contains all zeros for the Shrinkage Terminus.</p>
</td></tr>
<tr><td><code>mcal</code></td>
<td>
<p>Three increasing measures of shrinkage &quot;Extent&quot;. The first is 0 for the OLS (BLUE)
estimate, the second is the Maximum Likelihood m-Extent of Shrinkage [PURPLE point], and the
third is m = p for Shrinkage to beta = 0. This &quot;shrinkage terminus&quot; [BLACK point] is frequently
outside of the eff.biv() plot frame ...allowing the ellipse to be as LARGE as possible.</p>
</td></tr>
<tr><td><code>vnams</code></td>
<td>
<p>Names of all variables actually used in the GRR model.</p>
</td></tr> 
</table>


<h3>Author(s)</h3>

<p>Bob Obenchain &lt;wizbob@att.net&gt;</p>


<h3>References</h3>

<p>Obenchain RL. (1977) Classical F-tests and Confidence Regions for Ridge Regression.
<em>Technometrics</em> <b>19</b>, 429-439. <a href="https://doi.org/10.1080/00401706.1977.10489582">doi:10.1080/00401706.1977.10489582</a>
</p>
<p>Obenchain RL. (2021) <em>The Efficient Shrinkage Path: Maximum Likelihood of Minimum MSE
Risk.</em> <a href="https://arxiv.org/abs/2103.05161">https://arxiv.org/abs/2103.05161</a>
</p>
<p>Obenchain RL. (2022) Efficient Generalized Ridge Regression. <em>Open Statistics</em>
<b>3</b>: 1-18. <a href="https://doi.org/10.1515/stat-2022-0108">doi:10.1515/stat-2022-0108</a>
</p>
<p>Obenchain RL. (2022) <em>RXshrink_in_R.PDF</em> RXshrink package vignette-like document,
Version 2.1. <a href="http://localcontrolstatistics.org">http://localcontrolstatistics.org</a>  
</p>


<h3>See Also</h3>

<p><code><a href="#topic+eff.ridge">eff.ridge</a></code> and <code><a href="#topic+meff">meff</a></code></p>

<hr>
<h2 id='eff.biv'>Specify pairs of GRR Coefficient Estimates for display in Bivariate Confidence Regions</h2><span id='topic+eff.biv'></span>

<h3>Description</h3>

<p>This function specifies which Pair of GRR estimates to display and the single (or dual) Confidence
Level(s) of the Ellipse(s) displayed. Reguested confidence levels must both be equal to or greater
than 0.05 and less than or equal to 0.95.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  eff.biv(efaug, x1 = 1, x2 = 2, conf1 = 0.95, conf2 = 0.50) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eff.biv_+3A_efaug">efaug</code></td>
<td>
<p>An output list object of class &quot;eff.aug&quot; for a GRR model with p &gt;= 2 x-Variables.</p>
</td></tr>
<tr><td><code id="eff.biv_+3A_x1">x1</code></td>
<td>
<p>Integer index value &gt;= 1 and &lt;= p for the x-Coefficient to be displayed on the horizontal axis.</p>
</td></tr>
<tr><td><code id="eff.biv_+3A_x2">x2</code></td>
<td>
<p>Integer index value &gt;= 1 and &lt;= p for the x-Coefficient to be displayed on the vertical axis.
Index x2 must differ from x1 to display a plot.</p>
</td></tr>
<tr><td><code id="eff.biv_+3A_conf1">conf1</code></td>
<td>
<p>This first Confidence level must be &gt;= 0.05 and &lt;= 0.95 to display an Ellipse.</p>
</td></tr>
<tr><td><code id="eff.biv_+3A_conf2">conf2</code></td>
<td>
<p>When the second Confidence level is &gt;= 0.05 and &lt;= 0.95, its Ellipse is displayed. No
plot is displayed when both conf1 and conf2 are outside of the [0.05, 0.95] range.</p>
</td></tr>   
</table>


<h3>Value</h3>

<p> An output list object of class &quot;eff.biv&quot;...
</p>
<table>
<tr><td><code>p</code></td>
<td>
<p>Number of regression predictor variables.</p>
</td></tr>
<tr><td><code>LMobj</code></td>
<td>
<p>The lm() output object for the model fitted using eff.ridge().</p>
</td></tr>
<tr><td><code>bstar</code></td>
<td>
<p>The p by 3 matrix of shrunken GRR coefficients. The 3 columns correspond to OLS
estimates, optimally shrunken estimates, and estimates shrunken to Zeros.</p>
</td></tr>
<tr><td><code>mcal</code></td>
<td>
<p>Three increasing measures of shrinkage m-Extent: 0 for OLS [BLUE], the Optimal m-Extent
at the &quot;Interior Knot&quot; [PURPLE], and m = p [BLACK] at the Shrinkage Terminus.</p>
</td></tr>
<tr><td><code>ellip1</code></td>
<td>
<p>matrix[100, 2] of points on confidence ellipse 1.</p>
</td></tr>
<tr><td><code>conf1</code></td>
<td>
<p>confidence level of ellipse 1 within [0.05, 0.95].</p>
</td></tr>
<tr><td><code>ecor1</code></td>
<td>
<p>Pearson correlation between x1 and x2 coordinates.</p>
</td></tr>
<tr><td><code>ellip2</code></td>
<td>
<p>matrix[100, 2] of points on confidence ellipse 2.</p>
</td></tr>
<tr><td><code>conf2</code></td>
<td>
<p>confidence level of ellipse 2 within [0.05, 0.95].</p>
</td></tr>
<tr><td><code>ecor2</code></td>
<td>
<p>Pearson correlation between x1 and x2 coordinates.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Bob Obenchain &lt;wizbob@att.net&gt;</p>


<h3>References</h3>

<p>Obenchain RL. (1977) Classical F-tests and Confidence Regions for Ridge Regression.
<em>Technometrics</em> <b>19</b>, 429-439. <a href="https://doi.org/10.1080/00401706.1977.10489582">doi:10.1080/00401706.1977.10489582</a>
</p>
<p>Obenchain RL. (2022) <em>RXshrink_in_R.PDF</em> RXshrink package vignette-like document,
Version 2.1. <a href="http://localcontrolstatistics.org">http://localcontrolstatistics.org</a>
</p>
<p>Murdoch DJ. and Chow ED. (1996). A graphical display of large correlation matrices.
<em>The American Statistician</em> 50, 178-180.
</p>
<p>Murdoch DJ. ellipse: Functions for Drawing Ellipses and Ellipse-Like Confidence Regions.
<a href="https://CRAN.R-project.org/package=ellipse">https://CRAN.R-project.org/package=ellipse</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+eff.aug">eff.aug</a></code>, <code><a href="ellipse.html#topic+ellipse.lm">ellipse.lm</a></code>, <code><a href="#topic+eff.ridge">eff.ridge</a></code></p>

<hr>
<h2 id='eff.ridge'>Efficient Maximum Likelihood (ML) Shrinkage via the Shortest Piecewise Linear-Spline PATH</h2><span id='topic+eff.ridge'></span>

<h3>Description</h3>

<p>Compute and display TRACEs for the p-paramater Shrinkage PATH passing through the
(classical) Normal-theory Maximum Likelihood (ML) point-estimate of the Beta coefficient
vector. The m-Extent of overall Optimal Shrinkage corresponding to this solution occurs
at the only &quot;interior&quot; Knot on the Shrinkage Path and is also marked by the vertical
dashed-line drawn on all 5-types of eff.ridge TRACE displays.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  eff.ridge(form, data, rscale = 1, steps = 20, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eff.ridge_+3A_form">form</code></td>
<td>
<p>A regression formula [y~x1+x2+...+xp] suitable for use with lm().</p>
</td></tr>
<tr><td><code id="eff.ridge_+3A_data">data</code></td>
<td>
<p>data.frame containing observations on all variables in the formula.</p>
</td></tr>
<tr><td><code id="eff.ridge_+3A_rscale">rscale</code></td>
<td>
<p>One of three possible choices (0, 1 or 2) for &quot;rescaling&quot; of variables
(after being &quot;centered&quot;) to remove all &quot;non-essential&quot; ill-conditioning: 0 implies no
rescaling; 1 implies divide each variable by its standard error; 2 implies rescale as
in option 1 but re-express answers as in option 0.</p>
</td></tr>
<tr><td><code id="eff.ridge_+3A_steps">steps</code></td>
<td>
<p>Number of equally spaced values per unit change along the horizontal
M-extent-of-shrinkage axis for estimates to be calculated and displayed in TRACES
(default = 20.)</p>
</td></tr>
<tr><td><code id="eff.ridge_+3A_...">...</code></td>
<td>
<p>Optional argument(s)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Ill-conditioned and/or nearly multi-collinear regression models are unlikely to
produce Ordinary Least Squares (OLS) regression coefficient estimates that are very
close, numerically, to their unknown true values.  Specifically, OLS estimates can have
unreasonable relative magnitudes or &quot;wrong&quot; numerical signs when the number of x-variables
is 2 or more. Shrunken (Generalized Ridge Regression) estimates chosen to maximize their
likelihood of reducing Mean Squared Error (MSE) Risk (expected Squared Error Loss) can be
more stable and reasonable, numerically.  On the other hand, because only OLS estimates
are guaranteed to be minimax when risk is matrix valued (truly multivariate), no guarantee
of an actual reduction in MSE Risk is necessarily associated with shrinkage. 
</p>


<h3>Value</h3>

<p> An output list object of class eff.ridge:
</p>
<table>
<tr><td><code>data</code></td>
<td>
<p>Name of the data.frame object specified as the second argument.</p>
</td></tr>
<tr><td><code>form</code></td>
<td>
<p>The regression formula is the first argument.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>Number of regression x-predictor variables.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>Number of complete observations after removal of all missing values.</p>
</td></tr>
<tr><td><code>r2</code></td>
<td>
<p>Numerical value of R-squared: proportion of variance explained.</p>
</td></tr>
<tr><td><code>s2</code></td>
<td>
<p>Numerical value of the residual mean square estimate of error.</p>
</td></tr>
<tr><td><code>prinstat</code></td>
<td>
<p>Listing of 5 summary statistics for each of p-Principal Axes.</p>
</td></tr>  
<tr><td><code>rscale</code></td>
<td>
<p>Variable re-scaling code of 0, 1 or 2 used in calculations.</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>The data.frame containing all variables listed in the formula.</p>
</td></tr>
<tr><td><code>gmat</code></td>
<td>
<p>Orthogonal Matrix of Direction Cosines for Principal Axes.</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p>Matrix of shrinkage-ridge regression coefficient estimates.</p>
</td></tr>
<tr><td><code>rmse</code></td>
<td>
<p>Matrix of MSE risk estimates for fitted coefficients.</p>
</td></tr>
<tr><td><code>exev</code></td>
<td>
<p>Matrix of excess MSE eigenvalues (ordinary least squares minus ridge.)</p>
</td></tr>
<tr><td><code>infd</code></td>
<td>
<p>Matrix of direction cosines for the estimated inferior direction, if any.</p>
</td></tr>
<tr><td><code>spat</code></td>
<td>
<p>Matrix of shrinkage pattern multiplicative delta-factors.</p>
</td></tr>
<tr><td><code>mlik</code></td>
<td>
<p>Listing of criteria for maximum likelihood selection of an m-Extent for Shrinkage.</p>
</td></tr>
<tr><td><code>sext</code></td>
<td>
<p>Listing of summary statistics for all M-extents-of-shrinkage.</p>
</td></tr>
<tr><td><code>mStar</code></td>
<td>
<p>Optimal m-Extent of Shrinkage with delta[j] = dMSE[j] on TRACE displays.</p>
</td></tr>
<tr><td><code>mMSE</code></td>
<td>
<p>Minimum MSE Risk estimate.</p>
</td></tr>  
<tr><td><code>mClk</code></td>
<td>
<p>Most Likely Observed Extent of Shrinkage: best multiple of (1/steps) &lt;= p.</p>
</td></tr> 
<tr><td><code>minC</code></td>
<td>
<p>Minimum Observed Value of Normal-theory -2*log(Likelihood-Ratio).</p>
</td></tr>
<tr><td><code>dMSE</code></td>
<td>
<p>Most Likely to be Optimal-values for Shrinkage: dMSE[j] for j in [1:p].</p>
</td></tr>  
</table>


<h3>Author(s)</h3>

<p>Bob Obenchain &lt;wizbob@att.net&gt;</p>


<h3>References</h3>

<p>Thompson JR. (1968) Some shrinkage techniques for estimating the mean. <em>Journal
of the American Statistical Association</em> <b>63</b>, 113-122. (The &ldquo;cubic&rdquo; estimator.)
</p>
<p>Obenchain RL. (1978) Good and Optimal Ridge Estimators. <em>Annals of Statistics</em>
<b>6</b>, 1111-1121. <a href="https://doi.org/10.1214/aos/1176344314">doi:10.1214/aos/1176344314</a>
</p>
<p>Obenchain RL. (2021) <em>The Efficient Shrinkage Path: Maximum Likelihood of Minimum MSE
Risk.</em> <a href="https://arxiv.org/abs/2103.05161">https://arxiv.org/abs/2103.05161</a>
</p>
<p>Obenchain RL. (2022) Efficient Generalized Ridge Regression. <em>Open Statistics</em>
<b>3</b>: 1-18. <a href="https://doi.org/10.1515/stat-2022-0108">doi:10.1515/stat-2022-0108</a>
</p>
<p>Obenchain RL. (2022) <em>RXshrink_in_R.PDF</em> RXshrink package vignette-like document,
Version 2.3. <a href="http://localcontrolstatistics.org">http://localcontrolstatistics.org</a>  
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MLcalc">MLcalc</a></code>, <code><a href="#topic+meff">meff</a></code>, <code><a href="#topic+correct.signs">correct.signs</a></code>, <code><a href="#topic+MLtrue">MLtrue</a></code> 
and <code><a href="#topic+RXpredict">RXpredict</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(longley2)
  form &lt;- Employed~GNP+GNP.deflator+Unemployed+Armed.Forces+Population+Year
  rxefobj &lt;- eff.ridge(form, data=longley2)
  rxefobj          # print shrinkage summary statistics...
  plot(rxefobj)    # 5 TRACEs on 1 plot...
  str(rxefobj)
</code></pre>

<hr>
<h2 id='haldport'>Portland Cement data of Hald(1952)</h2><span id='topic+haldport'></span>

<h3>Description</h3>

<p>Heat evolved during setting of 13 cement mixtures of four (or five) ingredients.
The first four ingredient percentages appear to be &quot;rounded down&quot; to a full integer. The fifth
integer percentage of &quot;other&quot; material assures that the five percentages sum to exactly 100%.
However, the &quot;centered&quot; X-matrix resulting from inclusion of all five ingredients would then be
Singular (rank=4). In other words, regressing any y-Outcome on only the first four X-variables
yields an &quot;ill-conditioned&quot; model that, while having numerical &quot;full rank&quot;=4, actually suffers
a effective &quot;rank deficiency&quot; of at least mcal = 1. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(haldport)</code></pre>


<h3>Format</h3>

<p>A data frame with 13 observations on the following 6 variables.
</p>

<dl>
<dt><code>p3ca</code></dt><dd><p>Positive Integer percentage of 3CaO.Al2O3 [tricalcium aluminate] in the mixture.</p>
</dd>
<dt><code>p3cs</code></dt><dd><p>Positive Integer percentage of 3CaO.SiO2 [tricalcium silicate] in the mixture.</p>
</dd>
<dt><code>p4caf</code></dt><dd><p>Positive Integer percentage of 4CaO.Al2O3.Fe2O3 [tetracalcium aluminoferrite] in the mixture.</p>
</dd>
<dt><code>p2cs</code></dt><dd><p>Positive Integer percentage of 2CaO.SiO2 [dicalcium silicate] in the mixture.</p>
</dd>
<dt><code>other</code></dt><dd><p>Positive Integer percentage of other ingredients in the mixture.</p>
</dd> 	
<dt><code>heat</code></dt><dd><p>Heat (cals/gm) evolved in setting, recorded to nearest tenth.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The (RXshrink) haldport data are identical to the (MASS) cement data except for
variable names and inclusion of the &quot;other&quot; X-variable.
</p>


<h3>Source</h3>

<p>Woods H, Steinour HH, Starke HR. &quot;Effect of composition of Portland cement on heat
evolved during hardening. Industrial Engineering and Chemistry 1932; 24: 1207-1214.
</p>


<h3>References</h3>

<p>Hald A. Statistical Theory with Engineering Applications. 1952 (page 647.) New York; Wiley.
</p>
<p>Obenchain RL. (2022) Efficient Generalized Ridge Regression. <em>Open Statistics</em>
<b>3</b>: 1-18. <a href="https://doi.org/10.1515/stat-2022-0108">doi:10.1515/stat-2022-0108</a>
</p>

<hr>
<h2 id='longley2'>Art Hoerl's update of the infamous Longley(1967) benchmark dataset</h2><span id='topic+longley2'></span>

<h3>Description</h3>

<p>Data from the &quot;Employment and Training Report of the President, 1976&quot;
compiled by Art Hoerl, University of Delaware.  This data.frame contains both [1] some
different (&quot;corrected&quot;) numerical values from those used by Longley(1967) and [2] the added
years of 1963-1975. Longley(1967) used only data from the 16 years of 1947 through 1962.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(longley2)</code></pre>


<h3>Format</h3>

<p>A data.frame of 7 variables covering 29 consecutive years; no NAs.
</p>

<dl>
<dt>GNP.deflator</dt><dd><p>GNP price deflation index.</p>
</dd>
<dt>Unemployed</dt><dd><p>Unemployment percentage.</p>
</dd>
<dt>Armed.Forces</dt><dd><p>Size of the Armed Forces.</p>
</dd>
<dt>Population</dt><dd><p>Total U.S. Population.</p>
</dd>
<dt>Year</dt><dd><p>1947 to 1975.</p>
</dd>
<dt>Employed</dt><dd><p>employment.</p>
</dd>
<dt>GNP</dt><dd><p>Gross National Product.</p>
</dd>
</dl>



<h3>References</h3>

<p>Longley JW. An appraisal of least-squares programs from the point of view of the user.
J. Amer. Statist. Assoc. 1967; 62: 819-841.
</p>
<p>Hoerl AE, Kennard RW. Ridge Regression - Present and Future. 12th Symposium on the
Interface. 1979. Waterloo, Ontario, Canada.
</p>

<hr>
<h2 id='meff'>m-Extents of Shrinkage used in eff.ridge() Calculations.</h2><span id='topic+meff'></span>

<h3>Description</h3>

<p>The meff() function computes the numerical Shrinkage delta-factors corresponding to any
desired m-Extent of Shrinkage, meobj, along the &quot;efficient&quot; (shortest) Path used by
eff.ridge(). This Two-Piece Linear Path has its single &quot;interior&quot; Knot at the
Normal-theory Maximum Likelihood estimate with Minimum MSE Risk: d[j] = dMSE[j] for
j = 1, 2, ..., p.   
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  meff(meobj, p, dMSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="meff_+3A_meobj">meobj</code></td>
<td>
<p>A desired m-Extent of Shrinkage along the &quot;efficient&quot; Path.</p>
</td></tr>
<tr><td><code id="meff_+3A_p">p</code></td>
<td>
<p>The integer number of non-constant x-variables used in defining the linear
model being fitted to ill-conditioned (intercorrelated, confounded) data. Note that
p must also be rank of the given X-matrix.</p>
</td></tr>
<tr><td><code id="meff_+3A_dmse">dMSE</code></td>
<td>
<p>Maximum Likelihood [ML] estimates of Shrinkage Delta-Factors leading to
minimum MSE risk.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The appropriate scalar value for m and corresponding p by p diagonal matrix d:
</p>
<table>
<tr><td><code>meobj</code></td>
<td>
<p>Any desired m-Extent of Shrinkage (a scalar) within [0, p].</p>
</td></tr>
<tr><td><code>d</code></td>
<td>
<p>The p by p diagonal matrix of shrinkage-factors: d[j,j] in [0, 1].</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Bob Obenchain &lt;wizbob@att.net&gt;</p>


<h3>See Also</h3>

<p><code><a href="#topic+eff.ridge">eff.ridge</a></code> and <code><a href="#topic+eff.aug">eff.aug</a></code>.</p>

<hr>
<h2 id='MLboot'>Calculate Bootstrap distribution of Unrestricted Maximum Likelihood (ML)
point-estimates for a Linear Model.</h2><span id='topic+MLboot'></span>

<h3>Description</h3>

<p>Resample With-Replacement from a given data.frame and recompute MSE risk-optimal estimates
of Beta-Coefficients and their Relative MSE risks using MLcalcs() to compute ML point-estimates.</p>


<h3>Usage</h3>

<pre><code class='language-R'>  MLboot(form, data, reps=100, seed, rscale=1)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MLboot_+3A_form">form</code></td>
<td>
<p>Regression formula [y~x1+x2+...] suitable for use with lm().</p>
</td></tr>
<tr><td><code id="MLboot_+3A_data">data</code></td>
<td>
<p>data.frame containing observations on all variables in the formula.</p>
</td></tr>
<tr><td><code id="MLboot_+3A_reps">reps</code></td>
<td>
<p>Number of Bootstrap replications: Minimum reps = 10, Default is reps = 100.
While reps = 10000 is reasonable for bivariate (p=2) linear models, even that many
reps could be excessive for models with p &gt;&gt; 2.</p>
</td></tr>
<tr><td><code id="MLboot_+3A_seed">seed</code></td>
<td>
<p>Either an Integer between 1 and 999 or else missing to generate a random seed.</p>
</td></tr>
<tr><td><code id="MLboot_+3A_rscale">rscale</code></td>
<td>
<p>One of three possible choices (0, 1 or 2) for &quot;rescaling&quot; of variables
(after being &quot;centered&quot;) to remove all &quot;non-essential&quot; ill-conditioning:  0 implies no
rescaling; 1 implies divide each variable by its standard error; 2 implies rescale as
in option 1 but re-express answers as in option 0.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Ill-conditioned and/or nearly multi-collinear linear regression models are
unlikely to yield reasonable ML unbiased (OLS) point-estimates. But more reasonable
ML &quot;optimally-biased&quot; point-estimates from generalized ridge regression (GRR) typically
have questionable MSE risk characteristics because they are complicated non-linear
functions of the observed y-outcome vector. Thus the distribution of bootstrap resamples
is of considerable interest in both theory and practice.</p>


<h3>Value</h3>

<p> An output list object of class MLboot:
</p>
<table>
<tr><td><code>data</code></td>
<td>
<p>Name of the data.frame object specified as the second argument.</p>
</td></tr>
<tr><td><code>form</code></td>
<td>
<p>The regression formula specified as the first argument.</p>
</td></tr>	
<tr><td><code>reps</code></td>
<td>
<p>Number of Bootstrap replications performed.</p>
</td></tr>
<tr><td><code>seed</code></td>
<td>
<p>Seed used to start random number generator.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>Number of complete observations after removal of all missing values.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>Number of beta, rmse or dmse estimates resampled.</p>
</td></tr>
<tr><td><code>ols.beta</code></td>
<td>
<p>OLS matrix (reps x p) of unbiased beta-coefficient estimates.</p>
</td></tr>  
<tr><td><code>ols.rmse</code></td>
<td>
<p>OLS matrix (reps x p) of beta-coefficient relative variances.</p>
</td></tr> 
<tr><td><code>opt.dmse</code></td>
<td>
<p>OPT matrix (reps x p) of delta shrinkage-factors with minimum MSE risk.</p>
</td></tr> 
<tr><td><code>opt.beta</code></td>
<td>
<p>OPT matrix (reps x p) of biased beta-coefficient estimates.</p>
</td></tr>  
<tr><td><code>opt.rmse</code></td>
<td>
<p>OPT matrix (reps x p) of beta-coefficient relative MSE risks.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Bob Obenchain &lt;wizbob@att.net&gt;</p>


<h3>References</h3>

<p>Thompson JR. (1968) Some shrinkage techniques for estimating the mean. <em>Journal
of the American Statistical Association</em> <b>63</b>, 113-122. (The &quot;cubic&quot; estimator.)
</p>
<p>Obenchain RL. (2022) Efficient Generalized Ridge Regression. <em>Open Statistics</em>
<b>3</b>: 1-18. <a href="https://doi.org/10.1515/stat-2022-0108">doi:10.1515/stat-2022-0108</a>
</p>
<p>Obenchain RL. (2022) <em>RXshrink_in_R.PDF</em> RXshrink package vignette-like document,
Version 2.1. <a href="http://localcontrolstatistics.org">http://localcontrolstatistics.org</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+eff.ridge">eff.ridge</a></code>, <code><a href="#topic+correct.signs">correct.signs</a></code></p>

<hr>
<h2 id='MLcalc'>Calculate Efficient Maximum Likelihood (ML) point-estimates for a Linear Model that
are either Unbiased (OLS) or Most Likely to be Optimally Biased under Normal-distribution
theory.</h2><span id='topic+MLcalc'></span>

<h3>Description</h3>

<p>Compute MSE risk-optimal point-estimates of Beta-Coefficients and their Relative MSE risks.
Much of the code for this function is identical to that of eff.ridge(), which computes
multiple points along the &quot;Efficient&quot; Shrinkage Path. MLcalc() restricts attention to
only two points: [1] the Unbiased OLS (BLUE) vector and [2] the Most Likely to be Optimally
Biased [Minimum MSE Risk] vector of estimates.</p>


<h3>Usage</h3>

<pre><code class='language-R'>  MLcalc(form, data, rscale = 1)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MLcalc_+3A_form">form</code></td>
<td>
<p>A regression formula [y~x1+x2+...] suitable for use with lm().</p>
</td></tr>
<tr><td><code id="MLcalc_+3A_data">data</code></td>
<td>
<p>Data frame containing observations on all variables in the formula.</p>
</td></tr>
<tr><td><code id="MLcalc_+3A_rscale">rscale</code></td>
<td>
<p>One of three possible choices (0, 1 or 2) for &quot;rescaling&quot; of variables
(after being &quot;centered&quot;) to remove all &quot;non-essential&quot; ill-conditioning:  0 implies no
rescaling; 1 implies divide each variable by its standard error; 2 implies rescale as
in option 1 but re-express answers as in option 0.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Ill-conditioned and/or nearly multi-collinear regression models are unlikely to
produce Ordinary Least Squares (OLS) regression coefficient estimates that are very
close, numerically, to their unknown true values.  Specifically, OLS estimates can then
tend to have &quot;wrong&quot; numerical signs and/or unreasonable relative magnitudes, while
shrunken (generalized ridge) estimates chosen to Maximize their Likelihood of reducing
Mean Squared Error (MSE) Risk (expected squared-error loss) can be more stable
numerically.  On the other hand, because only OLS estimates are guaranteed to be minimax
when risk is Matrix Valued (truly multivariate), no guarantee of an expected reduction in
MSE Risk is necessarily associated with &quot;Optimal&quot; Generalized Ridge Regression shrinkage. 
</p>


<h3>Value</h3>

<p> An output list object of class MLcalc:
</p>
<table>
<tr><td><code>data</code></td>
<td>
<p>Name of the data.frame object specified as the second argument.</p>
</td></tr>
<tr><td><code>form</code></td>
<td>
<p>The regression formula specified as the first argument.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>Number of regression predictor variables.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>Number of complete observations after removal of all missing values.</p>
</td></tr>
<tr><td><code>r2</code></td>
<td>
<p>Numerical value of R-square goodness-of-fit statistic.</p>
</td></tr>
<tr><td><code>s2</code></td>
<td>
<p>Numerical value of the residual mean square estimate of error.</p>
</td></tr>
<tr><td><code>prinstat</code></td>
<td>
<p>Listing of principal statistics.</p>
</td></tr>
<tr><td><code>gmat</code></td>
<td>
<p>Orthogonal Matrix of Direction Cosines for Principal Axes [1:p, 1:p].</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>Numerical shrinkage-ridge regression coefficient estimates [1:2, 1:p].</p>
</td></tr>
<tr><td><code>rmse</code></td>
<td>
<p>Numerical MSE risk estimates for fitted coefficients [1:2, 1:p].</p>
</td></tr>
<tr><td><code>dMSE</code></td>
<td>
<p>Numerical delta-factors for shrinking OLS components [1:p].</p>
</td></tr>
<tr><td><code>ys</code></td>
<td>
<p>Numerical rescaling factor for y-outcome variable [1, 1].</p>
</td></tr>
<tr><td><code>xs</code></td>
<td>
<p>Numerical rescaling factors for given x-variables [1:p].</p>
</td></tr>  
</table>


<h3>Author(s)</h3>

<p>Bob Obenchain &lt;wizbob@att.net&gt;</p>


<h3>References</h3>

<p>Thompson JR. (1968) Some shrinkage techniques for estimating the mean. <em>Journal
of the American Statistical Association</em> <b>63</b>, 113-122. (The &ldquo;cubic&rdquo; estimator.)
</p>
<p>Obenchain RL. (2021) <em>The Efficient Shrinkage Path: Maximum Likelihood of Minimum MSE
Risk.</em> <a href="https://arxiv.org/abs/2103.05161">https://arxiv.org/abs/2103.05161</a>
</p>
<p>Obenchain RL. (2022) Efficient Generalized Ridge Regression. <em>Open Statistics</em>
<b>3</b>: 1-18. <a href="https://doi.org/10.1515/stat-2022-0108">doi:10.1515/stat-2022-0108</a>
</p>
<p>Obenchain RL. (2022) <em>RXshrink_in_R.PDF</em> RXshrink package vignette-like document,
Version 2.1. <a href="http://localcontrolstatistics.org">http://localcontrolstatistics.org</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+eff.ridge">eff.ridge</a></code>, <code><a href="#topic+MLboot">MLboot</a></code>, <code><a href="#topic+eff.aug">eff.aug</a></code></p>

<hr>
<h2 id='MLhist'>Plot method for MLboot objects</h2><span id='topic+MLhist'></span>

<h3>Description</h3>

<p>Frequency Histogram displays that use both a specified &quot;Middle Percentage&quot;
of a MLboot() distribution that contains outliers as well as a proposed total number
of bins.</p>


<h3>Usage</h3>

<pre><code class='language-R'>  MLhist(x, comp="opt.beta", xvar=1, npct = 95, bins = 50 )</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MLhist_+3A_x">x</code></td>
<td>
<p>An Output-list object of class &quot;MLboot&quot;.</p>
</td></tr>
<tr><td><code id="MLhist_+3A_comp">comp</code></td>
<td>
<p>One of five possible choices of MLboot() resampled estimates: &quot;ols.beta&quot;,
&quot;ols.rmse&quot;, &quot;opt.dmse&quot;, &quot;opt.beta&quot; or &quot;opt.rmse&quot;.</p>
</td></tr> 
<tr><td><code id="MLhist_+3A_xvar">xvar</code></td>
<td>
<p>Column number of estimates to be displayed: 1 &lt;= xvar &lt;= x$p.</p>
</td></tr>  
<tr><td><code id="MLhist_+3A_npct">npct</code></td>
<td>
<p>An integer percentage of the simulated scalar estimates to be displayed.
This percentage should be at least 66 and at most 100.</p>
</td></tr>
<tr><td><code id="MLhist_+3A_bins">bins</code></td>
<td>
<p>This proposed number of histogram &quot;breaks&quot; is only a suggestion;
actual breakpoints will be set to &quot;pretty&quot; values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p> An output list object of class MLhist:
</p>
<table>
<tr><td><code>x</code></td>
<td>
<p>Character string showing user choices for &quot;comp&quot; and &quot;xvar&quot; arguments.</p>
</td></tr>
<tr><td><code>form</code></td>
<td>
<p>The regression formula specifying the linear model in MLboot().</p>
</td></tr>	
<tr><td><code>reps</code></td>
<td>
<p>Number of Bootstrap replications performed.</p>
</td></tr>
<tr><td><code>npct</code></td>
<td>
<p>An integer percentage of the simulated scalar estimates displayed.</p>
</td></tr>
<tr><td><code>rbins</code></td>
<td>
<p>Number of histogram Bins requested.</p>
</td></tr>
<tr><td><code>dbins</code></td>
<td>
<p>Number of histogram Bins actually displayed.</p>
</td></tr>
<tr><td><code>ntot</code></td>
<td>
<p>Total number of rows of scalar estimates.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>Total number of columns of scalar estimates.</p>
</td></tr>
<tr><td><code>nlo</code></td>
<td>
<p>First (smallest) order statistic displayed in Histogram.</p>
</td></tr>
<tr><td><code>nup</code></td>
<td>
<p>Last (largest) order statistic displayed in Histogram.</p>
</td></tr>
<tr><td><code>noin</code></td>
<td>
<p>Total number of scalar estimates displayed in Histogram.</p>
</td></tr>
<tr><td><code>xmn</code></td>
<td>
<p>Observed Mean Estimate: location of vertical &quot;blue&quot; dashed line on Histogram.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Bob Obenchain &lt;wizbob@att.net&gt;</p>

<hr>
<h2 id='MLtrue'>Simulate data for Linear Models with known Parameter values and Normal Errors</h2><span id='topic+MLtrue'></span>

<h3>Description</h3>

<p>Using specified numerical values for Parameters, such as the true error-term variance,
that usually are unknown, MLtrue() creates a new data.frame that contains variables
&quot;Yhat&quot; (the vector of expected values) and &quot;Yvec&quot; (Yhat + IID Normal error-terms) as
well as the p given X-variables. Thus, MLtrue() produces &quot;correct&quot; linear models that
can be ideal for analysis and bootstraping via methods based on Normal-theory.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  MLtrue(form, data, seed, go=TRUE, truv, trub, truc)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MLtrue_+3A_form">form</code></td>
<td>
<p>A regression formula [y~x1+x2+...] suitable for use with lm().</p>
</td></tr>
<tr><td><code id="MLtrue_+3A_data">data</code></td>
<td>
<p>Data frame containing observations on all variables in the formula.</p>
</td></tr>
<tr><td><code id="MLtrue_+3A_seed">seed</code></td>
<td>
<p>Seed for random number generation between 1 and 1000. When this seed
number is missing in a call to MLtrue(), a new seed is generated using runif().
Error terms are then generated using calls to rnorm(), and the seed used is
reported in the MLtrue output.list to enable reproducible research.</p>
</td></tr>
<tr><td><code id="MLtrue_+3A_go">go</code></td>
<td>
<p>Logical value: go=TRUE starts the simulation using OLS estimates or the
numerical values from the (optional) truv, trub and truc arguments to define the
&quot;Yhat&quot; and &quot;Yvec&quot; variables; go=FALSE causes MLtrue() to compute OLS estimates
that ignore the truv, trueb and truc arguments. Thus, go=FALSE provides a
convenient way for users to Print and Examine the MLtrue() output.list before
deciding which parameter-settings they wish to actually USE or MODIFY before
making a final run with go=TRUE.</p>
</td></tr>
<tr><td><code id="MLtrue_+3A_truv">truv</code></td>
<td>
<p>Optional: numerical value for the true error variance, sigma^2.</p>
</td></tr>
<tr><td><code id="MLtrue_+3A_trub">trub</code></td>
<td>
<p>Optional: column vector of numerical values for the true regression
coefficients.</p>
</td></tr>
<tr><td><code id="MLtrue_+3A_truc">truc</code></td>
<td>
<p>Optional: column vector of numerical values for the true uncorrelated
components of the regression coefficient vector.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>RXshrink functions like eff.ridge() and qm.ridge() calculate maximum likelihood
estimates ...either unbiased (BLUE) or &quot;optimally&quot; biased (minimum MSE risk) along a
specified &quot;path&quot;... for typical statistical inference situations where true regression
parameters are unknown. Furthermore the specified linear-model may be &quot;incorrect&quot; or
the error-terms may not be IID Normal variates.  In sharp contrast with this usual
situation, the MLtrue() function generates a &quot;Yvec&quot; vector of outcomes from a CORRECT
model of the given form that does contain IID Normal error-terms and all true parameter
values are KNOWN. This makes it interesting to compare plots and output.lists from
RXshrink GRR-estimation functions on a &quot;real&quot; data.frame with the corresponding outputs
from a MLtrue() data.frame with known parameter-setting that are either identical to or 
&quot;close&quot; to those estimated from &quot;real&quot; data. WARNING: All output X-variables are
&quot;centered&quot; and &quot;rescaled&quot; to have mean ~0 and variance 1. Yhat expected values are
&quot;centered&quot; but usually have variance differing from 1. Yvec values are not &quot;centered&quot;
and have variance determined by either the original data.frame or the &quot;truv&quot; setting.
</p>


<h3>Value</h3>

<p> An output list object of class MLtrue:
</p>
<table>
<tr><td><code>new</code></td>
<td>
<p>A data.frame containing the Yvec and Yhat vectors as well as centered and
rescaled versions of the input X-matrix and original Y-vector.</p>
</td></tr>
<tr><td><code>Yvec</code></td>
<td>
<p>An additional copy of Yvec pseudo-data containing Normal error-terms.</p>
</td></tr>
<tr><td><code>Yhat</code></td>
<td>
<p>An additional copy of Yhat linear fitted-values.</p>
</td></tr>
<tr><td><code>seed</code></td>
<td>
<p>Seed actually used in random-number generation; needed for replication.</p>
</td></tr>
<tr><td><code>tvar</code></td>
<td>
<p>True numerical value of sigma^2 ...[1,1] matrix.</p>
</td></tr>
<tr><td><code>tbeta</code></td>
<td>
<p>True numerical values of beta-coefficients ...[p,1] matrix.</p>
</td></tr>
<tr><td><code>tcomp</code></td>
<td>
<p>True numerical values of uncorrelated components ...[p,1] matrix.</p>
</td></tr>
<tr><td><code>useb</code></td>
<td>
<p>Logical: TRUE =&gt; tbeta vector was used in simulation. FALSE =&gt; tcomp
vector was used rather than tbeta.</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>The name of the data.frame object specified in the second argument.</p>
</td></tr>  
<tr><td><code>form</code></td>
<td>
<p>The regression formula specified in the first argument. NOTE: The final
11 output items [p, ..., xs] are identical to those in output lists from RXshrink
functions like eff.ridge() and qm.ridge().</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Bob Obenchain &lt;wizbob@att.net&gt;</p>


<h3>See Also</h3>

<p><code><a href="#topic+eff.ridge">eff.ridge</a></code>, <code><a href="#topic+qm.ridge">qm.ridge</a></code> and <code><a href="#topic+MLboot">MLboot</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>  # require(RXshrink)
  data(mpg)
  form &lt;- mpg~cylnds+cubins+hpower+weight
  MLtest &lt;- MLtrue(form, mpg, go=FALSE)   # all other potential arguments "missing"...
  MLtest   # print current parameter estimates...
  cvec &lt;- c(-0.5, 0.15, -0.16, -0.6)   # define alternative "true" components...
  MLout &lt;- MLtrue(form, mpg, truc = cvec ) # Use "truc" input with default go=TRUE...
  str(MLout)
  formY &lt;- Yhat~cylnds+cubins+hpower+weight   # Formula for true expected Y-outcomes...
  lmobj &lt;- lm(formY, MLout$new)
  max(abs(lmobj$residuals))   # essentially 0 because linear model is "correct"...
  # effobj &lt;- eff.ridge(formY, MLout$new)   ...generates "Error" because RSQUARE=1.
</code></pre>

<hr>
<h2 id='mpg'>Hocking(1976) Miles Per Gallon data: a Multiple Regression Benchmark</h2><span id='topic+mpg'></span>

<h3>Description</h3>

<p>Performance data for the 1973-74 models of 32 autos from the Road Tests
Section of <em>Motor Trends</em> magazine. NOTE: data(mtcars) loads essentially the
same data, but most variable names are then different and have fewer characters.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(mpg)</code></pre>


<h3>Format</h3>

<p>A data frame of 11 variables on 32 autos; no NAs.
</p>

<dl>
<dt>cylnds</dt><dd><p>number of cylinders.</p>
</dd>
<dt>cubins</dt><dd><p>cubic inches of engine displacement.</p>
</dd>
<dt>hpower</dt><dd><p>engine horsepower.</p>
</dd>
<dt>weight</dt><dd><p>total weight in pounds.</p>
</dd>
<dt>mpg</dt><dd><p>miles per gallon.</p>
</dd>
<dt>shape</dt><dd><p>engine shape (0 = V, 1 = Straight).</p>
</dd>
<dt>transm</dt><dd><p>transmission type (0 = Automatic, 1 = Manual).</p>
</dd>
<dt>speeds</dt><dd><p>number of forward speeds.</p>
</dd>
<dt>carbs</dt><dd><p>number of carburetors.</p>
</dd>
<dt>fratio</dt><dd><p>final drive rtaio.</p>
</dd>
<dt>qmilt</dt><dd><p>quarter mile time.</p>
</dd>
</dl>



<h3>References</h3>

<p>Hocking RA. The Analysis and Selection of Variables in Regression.
Biometrics 1976; 32: 1-51.
</p>
<p>Henderson HV, Velleman PF. Building multiple regression models interactively.
Biometrics 1981; 37: 391-411.
</p>

<hr>
<h2 id='plot.aug.lars'>Plot method for aug.lars objects</h2><span id='topic+plot.aug.lars'></span>

<h3>Description</h3>

<p>Plot TRACE displays for aug.lars regression coefficients.  The default
is to display all Five TRACEs on one page with no legend.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'aug.lars'
plot(x, trace = "all", trkey = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.aug.lars_+3A_x">x</code></td>
<td>
<p>Output list object of class aug.lars.</p>
</td></tr>
<tr><td><code id="plot.aug.lars_+3A_trace">trace</code></td>
<td>
<p>One of seven possible options: &quot;all&quot; to display 5 traces in one graph,
&quot;seq&quot; to display 5 full-sized traces in sequence in response to user prompts,
&quot;coef&quot; to display only the estimated beta coefficient trace,
&quot;rmse&quot; to display only the estimated relative MSE risk trace,
&quot;exev&quot; to display only the estimated excess MSE eigenvalue (OLS minus larlso),
&quot;infd&quot; to display only the estimated inferior direction cosine trace, or
&quot;spat&quot; to display only the delta-factor pattern trace.</p>
</td></tr>
<tr><td><code id="plot.aug.lars_+3A_trkey">trkey</code></td>
<td>
<p>If TRUE, display a crude legend at the bottom of each trace plot.</p>
</td></tr>
<tr><td><code id="plot.aug.lars_+3A_...">...</code></td>
<td>
<p>Optional argument(s) passed on to plot().</p>
</td></tr>
</table>


<h3>Value</h3>

<p>NULL</p>


<h3>Author(s)</h3>

<p>Bob Obenchain &lt;wizbob@att.net&gt;</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(longley2)
  form &lt;- GNP~GNP.deflator+Unemployed+Armed.Forces+Population+Year+Employed
  rxlobj &lt;- aug.lars(form, data=longley2)
  plot(rxlobj)
</code></pre>

<hr>
<h2 id='plot.eff.biv'>Plot method for eff.biv objects</h2><span id='topic+plot.eff.biv'></span>

<h3>Description</h3>

<p>Plot One or Two Bivariate Confidence Ellipses or a TRACE display for
efficiently shrunken regression coefficients.  The default is to display two ellipses
at confidence levels 0.95 and 0.50 on a single plot for the first 2 of p &gt;= 2
coefficients. The projection of the eff.ridge() Path from the OLS solution (at m = 0)
to the Knot at the most likely Minimum MSE Risk solution (at m = mStar) ...plus the
continuation of this Path towards the Shrinkage Terminus at (0,0) is shown in &quot;red&quot;.
To show the (outer) Ellipse as large as possible, the (0,0) point may be &quot;off the plot&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'eff.biv'
plot(x, type = "ellip", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.eff.biv_+3A_x">x</code></td>
<td>
<p>Output list object of class eff.ridge.</p>
</td></tr>
<tr><td><code id="plot.eff.biv_+3A_type">type</code></td>
<td>
<p>One of 2 options: &quot;ellip&quot; or &quot;trace&quot;. The default option of &quot;ellip&quot;
displays the Confidence Ellipse(s) specified by arguments to eff.biv().</p>
</td></tr>
<tr><td><code id="plot.eff.biv_+3A_...">...</code></td>
<td>
<p>Optional argument(s) passed on to plot().</p>
</td></tr>
</table>


<h3>Value</h3>

<p>NULL</p>


<h3>Author(s)</h3>

<p>Bob Obenchain &lt;wizbob@att.net&gt;</p>


<h3>Examples</h3>

<pre><code class='language-R'>  # Cost-Effectiveness inferences using Linear Models and eff.ridge...
  ## Not run: 
    library(ICEinfer)
    data(sepsis)
    ndr &lt;- ICEpref(sepsis$icu, sepsis$qalypres, sepsis$totcost, lambda=50000, beta=0.1)
    sndr &lt;- data.frame(cbind(ndr$pref, sepsis)) # ndr: non-linear diminishing returns...
    form4 &lt;- ndr.pref ~ icu + age + orgfails + apache
    usndra &lt;- eff.aug(eff.ridge(form4, sndr)) # compare ndr of 2 Intensive Care Units...
    plot(efobj &lt;- eff.biv(usndra, 2, 4))
    efobj          # implicit print...
    # plot(efobj, type = "tr")
  
## End(Not run)
</code></pre>

<hr>
<h2 id='plot.eff.ridge'>Plot method for eff.ridge objects</h2><span id='topic+plot.eff.ridge'></span>

<h3>Description</h3>

<p>Plot TRACE displays for the Efficient Path. This path is [1]
as short as possible and [2] consists of a Two-Piece Linear-Function with a
emphSingle Interior Knot at the MSE Optimal m-Extent of Shrinkage. The
default is to display all five Traces on one page with no legend. This
function requires the number, p, of non-constant x-variables be at most 30.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'eff.ridge'
plot(x, trace = "all", LP = 0, HH = 0, ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.eff.ridge_+3A_x">x</code></td>
<td>
<p>RXshrink output list object of class eff.ridge.</p>
</td></tr>
<tr><td><code id="plot.eff.ridge_+3A_trace">trace</code></td>
<td>
<p>One of seven possible options: &quot;all&quot; to display 5 traces in one graph,
&quot;seq&quot; to display 5 full-sized traces in sequence in response to user prompts,
&quot;coef&quot; to display only the estimated beta coefficient trace,
&quot;rmse&quot; to display only the estimated relative MSE risk trace,
&quot;exev&quot; to display only the estimated excess MSE eigenvalue (OLS minus larlso),
&quot;infd&quot; to display only the estimated inferior direction cosine trace, or
&quot;spat&quot; to display only the delta-factor pattern trace.</p>
</td></tr>
<tr><td><code id="plot.eff.ridge_+3A_lp">LP</code></td>
<td>
<p>The &quot;Legend Position&quot; must be an integer between 0 and 9, inclusive:
LP = 0 is the default and yields NO legend display,
LP = 1 displays a crude legend at the Lower-Right of each trace plot, ... ,
LP = 7 displays the legend in the Upper-Right position, . ,
LP = 9 displays the legend in the Middle-Middle position.</p>
</td></tr>
<tr><td><code id="plot.eff.ridge_+3A_hh">HH</code></td>
<td>
<p>The &quot;Half Height&quot; plot option is an integer between 0 and 2, inclusive:
HH = 0 is the default and yields trace plots with either 1 or 3 rows,
HH = 1 calls par(mfrow=c(2,1)) before displaying the current trace plot,
HH = 2 displays a 2nd (or sebsequent) trace in &quot;Half Height&quot; mode. NOTE that
these &quot;Half Height&quot; options allow users to display both a qm.ridge() and an
eff.ridge() trace on a single plot.</p>
</td></tr>  
<tr><td><code id="plot.eff.ridge_+3A_...">...</code></td>
<td>
<p>Optional argument(s) passed on to plot().</p>
</td></tr>
</table>


<h3>Value</h3>

<p>NULL</p>


<h3>Author(s)</h3>

<p>Bob Obenchain &lt;wizbob@att.net&gt;</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(longley2)
  form &lt;- GNP~GNP.deflator+Unemployed+Armed.Forces+Population+Year+Employed
  rxefobj &lt;- eff.ridge(form, data=longley2)
  plot(rxefobj, "coef", LP=7)
</code></pre>

<hr>
<h2 id='plot.qm.ridge'>Plot method for qm.ridge objects</h2><span id='topic+plot.qm.ridge'></span>

<h3>Description</h3>

<p>Plot TRACE displays for 2-parameter (q, m) generalized ridge estimators.  The
default is to display all five Traces on one page with no legend. When the number, p, of
non-constant x-variables is at most 30, the lines [straight or curved] displayed on Traces
avoid (or postpone) use of lty = 3 [dotted].
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'qm.ridge'
plot(x, trace = "all", LP = 0, HH = 0, ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.qm.ridge_+3A_x">x</code></td>
<td>
<p>Output list object of class qm.ridge.</p>
</td></tr>
<tr><td><code id="plot.qm.ridge_+3A_trace">trace</code></td>
<td>
<p>One of seven possible options: &quot;all&quot; to display 5 traces in one graph,
&quot;seq&quot; to display 5 full-sized traces in sequence in response to user prompts,
&quot;coef&quot; to display only the estimated beta coefficient trace,
&quot;rmse&quot; to display only the estimated relative MSE risk trace,
&quot;exev&quot; to display only the estimated excess MSE eigenvalue (OLS minus larlso),
&quot;infd&quot; to display only the estimated inferior direction cosine trace, or
&quot;spat&quot; to display only the delta-factor pattern trace.</p>
</td></tr>
<tr><td><code id="plot.qm.ridge_+3A_lp">LP</code></td>
<td>
<p>The &quot;Legend Position&quot; must be an integer between 0 and 9, inclusive:
LP = 0 is the default and yields NO legend display,
LP = 1 displays a crude legend at the Lower-Right of each trace plot, ... ,
LP = 7 displays the legend in the Upper-Right position, . ,
LP = 9 displays the legend in the Middle-Middle position.</p>
</td></tr>
<tr><td><code id="plot.qm.ridge_+3A_hh">HH</code></td>
<td>
<p>The &quot;Half Height&quot; plot option is an integer between 0 and 2, inclusive:
HH = 0 is the default and yields trace plots with either 1 or 3 rows,
HH = 1 calls par(mfrow=c(2,1)) before displaying the current trace plot,
HH = 2 displays a 2nd (or sebsequent) trace in &quot;Half Height&quot; mode. NOTE that
these &quot;Half Height&quot; options allow users to display both a qm.ridge() and an
eff.ridge() trace on a single plot.</p>
</td></tr>  
<tr><td><code id="plot.qm.ridge_+3A_...">...</code></td>
<td>
<p>Optional argument(s) passed on to plot().</p>
</td></tr>
</table>


<h3>Value</h3>

<p>NULL</p>


<h3>Author(s)</h3>

<p>Bob Obenchain &lt;wizbob@att.net&gt;</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(longley2)
  form &lt;- GNP~GNP.deflator+Unemployed+Armed.Forces+Population+Year+Employed
  rxrobj &lt;- qm.ridge(form, data=longley2)
  plot(rxrobj, "rmse", LP = 5)
</code></pre>

<hr>
<h2 id='plot.RXpredict'>Plot method for RXpredict objects</h2><span id='topic+plot.RXpredict'></span>

<h3>Description</h3>

<p>Plot Predicted and/or Fitted.Values for all 5 RXshrink regression estimation
methods. The default is to plot Predictions for the y-Outcome variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'RXpredict'
plot(x, fit = "yvecprd", ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.RXpredict_+3A_x">x</code></td>
<td>
<p>Output list object of class RXpredict.</p>
</td></tr>
<tr><td><code id="plot.RXpredict_+3A_fit">fit</code></td>
<td>
<p>One of three possible options:,
&quot;yvecprd&quot; to display Predictions of the Observed y-Outcomes in a single plot,
&quot;cryprd&quot; to display Fitted.Values for the Centered and Rescaled y-Outcomes,
&quot;both&quot; to display &quot;yvecprd&quot; and &quot;cryprd&quot; plots in two rows on one page.</p>
</td></tr>
<tr><td><code id="plot.RXpredict_+3A_...">...</code></td>
<td>
<p>Optional argument(s) passed on to plot().</p>
</td></tr>
</table>


<h3>Value</h3>

<p>NULL</p>


<h3>Author(s)</h3>

<p>Bob Obenchain &lt;wizbob@att.net&gt;</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(longley2)
  form &lt;- Employed~GNP+GNP.deflator+Unemployed+Armed.Forces+Population+Year
  rxefobj &lt;- eff.ridge(form, longley2)
  rxefprd &lt;- RXpredict(rxefobj, longley2)
  plot(rxefprd)
  # Clearly Biased predictions can still represent an "Optimal" Variance-Bias Trade-Off...
</code></pre>

<hr>
<h2 id='plot.syxi'>Plot method for syxi objects</h2><span id='topic+plot.syxi'></span>

<h3>Description</h3>

<p>Display plots for Visual Validation of the syxi() approach that attempts to 
straighten nonlinear relationships between two variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'syxi'
plot(x, type = "xy", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.syxi_+3A_x">x</code></td>
<td>
<p>syxi output list object of class syxi.</p>
</td></tr>
<tr><td><code id="plot.syxi_+3A_type">type</code></td>
<td>
<p>One of two possible options: &quot;xy&quot; to display a plot of the
x-predictor versus the y-outcome with the lm() fitted line in RED
and the corresponding gam() Spline fit in BLUE, &quot;sy&quot; (or any string different
from &quot;xy&quot;) displays a plot of s(x) versus y with only the lm() fit in BLUE.</p>
</td></tr>
<tr><td><code id="plot.syxi_+3A_...">...</code></td>
<td>
<p>Optional argument(s) passed on to plot().</p>
</td></tr>
</table>


<h3>Value</h3>

<p>NULL</p>


<h3>Author(s)</h3>

<p>Bob Obenchain &lt;wizbob@att.net&gt;</p>

<hr>
<h2 id='plot.uc.lars'>Plot method for uc.lars objects</h2><span id='topic+plot.uc.lars'></span>

<h3>Description</h3>

<p>Plot TRACE displays of lars regression coefficients for the uncorrelated components
of the X-matrix. The default option of trace = &quot;all&quot; displays all Five TRACEs on one
page.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'uc.lars'
plot(x, trace = "all", trkey = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.uc.lars_+3A_x">x</code></td>
<td>
<p>Output list object of class uc.lars.</p>
</td></tr>
<tr><td><code id="plot.uc.lars_+3A_trace">trace</code></td>
<td>
<p>One of seven possible options: &quot;all&quot; to display 5 traces in one graph,
&quot;seq&quot; to display 5 full-sized traces in sequence in response to user prompts,
&quot;coef&quot; to display only the estimated shrunken beta coefficient trace,
&quot;rmse&quot; to display only the estimated relative MSE risk trace,
&quot;exev&quot; to display only the estimated excess MSE eigenvalue (OLS minus ridge) trace,
&quot;infd&quot; to display only the estimated inferior direction cosine trace, or
&quot;spat&quot; to display only the shrinkage (delta) factor pattern trace.</p>
</td></tr>
<tr><td><code id="plot.uc.lars_+3A_trkey">trkey</code></td>
<td>
<p>If TRUE, display a crude legend at the bottom-right of each trace plot.</p>
</td></tr>
<tr><td><code id="plot.uc.lars_+3A_...">...</code></td>
<td>
<p>Optional argument(s) passed on to plot().</p>
</td></tr>
</table>


<h3>Value</h3>

<p>NULL</p>


<h3>Author(s)</h3>

<p>Bob Obenchain &lt;wizbob@att.net&gt;</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(longley2)
  form &lt;- GNP~GNP.deflator+Unemployed+Armed.Forces+Population+Year+Employed
  rxucobj &lt;- uc.lars(form, data=longley2)
  plot(rxucobj)
</code></pre>

<hr>
<h2 id='plot.YonX'>Plot method for YonX objects</h2><span id='topic+plot.YonX'></span>

<h3>Description</h3>

<p>Graphics for Shrinkage in &quot;Simple&quot; Linear Regression: Models with only p=1
X-variable. The default is to [1] display four TRACES in one plot and then to [2]
display the &quot;Y on X&quot; scatter-plot with Three Fitted Lines: the OLS fit is BLUE, the
optimally Shrunken fit is &quot;purple&quot;, and the largest m-Extent of shrinkage with Relative
MSE at most that of OLS is &quot;red&quot;. Note: Whenever model lack-of-fit is small, these 3
m-Extents can be quite close to each other.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'YonX'
plot(x, trace = "all", ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.YonX_+3A_x">x</code></td>
<td>
<p>Output list object of class &quot;YonX&quot;.</p>
</td></tr>
<tr><td><code id="plot.YonX_+3A_trace">trace</code></td>
<td>
<p>One of EIGHT possible options: &quot;all&quot; to display 4 traces on the first plot,
then the &quot;YonX&quot; scatter plot; &quot;seq&quot; to display 5 full-sized plots in sequence (in
response to user prompts); &quot;coef&quot; to display only the estimated beta coefficient trace
(a straight line); &quot;rmse&quot; to display only the (quadratic) estimated relative MSE risk
trace; &quot;spat&quot; to display only the delta-factor trace (a straight line); &quot;lglk&quot; to
display only the &quot;-2 log(Likelihood Ratio)&quot; trace; &quot;YonX&quot; to display only the Y-vs-X
scatter plot with 3 fitted-lines: the OLS fitted line (BLUE), the &quot;purple&quot; Maximum-Likelihood
(optimally biased) line, and the &quot;red&quot; line marking the most shrinkage with estimated
MSE Relative Risk less than or equal to that of OLS; or &quot;exev&quot; to display only the Excess
Eigenvalue trace that is redundant with the &quot;rmse&quot; trace.</p>
</td></tr>
<tr><td><code id="plot.YonX_+3A_...">...</code></td>
<td>
<p>Optional argument(s) passed on to plot().</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The effects of Shrinkage on Simple Linear Regression models (p = 1) are, in reality,
NOT easier to illustrate than the corresponding effects on Multiple Linear Regressiom models
(p &gt; 1). In both situations, alternative estimates of effects and risks abound. For example,
the estimate chosen can be [1] Maximum Likelihood under Normal-theory, [2] Unbiased under
Normal-theory or [3] have &quot;Correct Range&quot;. [See Obenchain (1978), equations (3.3) to (3.5),
and corresponding text.] When a graphic contains only a single curve, a &quot;reality&quot; is that
the general &quot;shape&quot; of the curve (plus any highlighted &quot;points&quot; on that curve) should &quot;look
right&quot; or, at the very least, &quot;reasonable&quot;.
</p>
<p>My choices among alternative estimates of (nonlinear) MSE risk were initially made roughly
30 years ago ...and have remained mostly unchanged (primarily) for consistency with earlier
versions of RXshrink.
</p>
<p>The NEW &quot;rmse&quot; TRACE for class &quot;YonX&quot; displays MSE Relative Risk estimates from the &quot;qrsk&quot;
vector rather than the (traditional) &quot;rmse&quot; estimates for all p = 1 models. This allows MSE
Relative Risk estimates to <em>satisfy a Quadratic equation</em> and give the CORRECT visual
impression that Relative Risk is MINIMIZED at the ML &quot;purple&quot; point and dotted-line at m =
(1-dMSE). Note that the Relative Risk then starts to increase for m &gt; (1-dMSE) and returns
to its initial starting level at m = 0 [&quot;blue&quot; point and dotted-line] when the m-Extent
reaches m = 2*(1-dMSE) [&quot;red&quot; point and dotted-line.] Finally, when 0.5 &lt; dMSE &lt; 1, the
Relative Risk then continues to increase, reaching its Maximum at m = 1. As argued in
Obenchain(1978), the &quot;Good&quot; Shrinkage Range is 0 &lt; m &lt; 2*(1-dMSE), between the &quot;blue&quot; and
&quot;red&quot; vertical dotted-lines on the &quot;rmse&quot; TRACE.
</p>


<h3>Value</h3>

<p>NULL</p>


<h3>Author(s)</h3>

<p>Bob Obenchain &lt;wizbob@att.net&gt;</p>


<h3>References</h3>

<p>Obenchain RL. (1978) Good and Optimal Ridge Estimators. <em>Annals of Statistics</em>
<b>6</b>, 1111-1121. <a href="https://doi.org/10.1214/aos/1176344314">doi:10.1214/aos/1176344314</a>
</p>
<p>Obenchain RL. (2022) Efficient Generalized Ridge Regression. <em>Open Statistics</em>
<b>3</b>: 1-18. <a href="https://doi.org/10.1515/stat-2022-0108">doi:10.1515/stat-2022-0108</a>
</p>
<p>Obenchain RL. (2022) <em>RXshrink_in_R.PDF</em> RXshrink package vignette-like document,
Version 2.1. <a href="http://localcontrolstatistics.org">http://localcontrolstatistics.org</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(haldport)
  form &lt;- heat ~ p4caf
  YXobj &lt;- YonX(form, data=haldport)
  plot(YXobj)
</code></pre>

<hr>
<h2 id='qm.ridge'>Restricted (2-parameter) Maximum Likelihood Shrinkage in Regression</h2><span id='topic+qm.ridge'></span>

<h3>Description</h3>

<p>Computes and displays TRACEs for a <b>q</b>-Shaped shrinkage PATH, including the <b>m</b>-Extent
of shrinkage along that path, most likely under Normal-distribution theory to yield optimal
reducions in MSE Risk. When rank(X-matrix) = p &gt; 2, the most likely solution on the qm.ridge()
path will be less likely to have minimal MSE risk than the optimal solution on the p-parameter
eff.ridge() path. The Hoerl-Kennard &quot;ordinary&quot; ridge path has Shape q=0 within the qm.ridge()
family.    
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  qm.ridge(form, data, rscale = 1, Q = "qmse", steps = 20, nq = 21,
              qmax = 5, qmin = -5, omdmin = 9.9e-13)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="qm.ridge_+3A_form">form</code></td>
<td>
<p>A regression formula [y~x1+x2+...] suitable for use with lm().</p>
</td></tr>
<tr><td><code id="qm.ridge_+3A_data">data</code></td>
<td>
<p>Data frame containing observations on all variables in the formula.</p>
</td></tr>
<tr><td><code id="qm.ridge_+3A_rscale">rscale</code></td>
<td>
<p>One of three possible choices (0, 1 or 2) for &quot;rescaling&quot; of variables
(after being &quot;centered&quot;) to remove all &quot;non-essential&quot; ill-conditioning: 0 implies no
rescaling; 1 implies divide each variable by its standard error; 2 implies rescale as
in option 1 but re-express answers as in option 0.</p>
</td></tr>
<tr><td><code id="qm.ridge_+3A_q">Q</code></td>
<td>
<p>Shape parameter that controls the curvature of the shrinkage path through
regression-coefficient likelihood space (default = &quot;qmse&quot; implies use the value found 
most likely to be optimal.)  Use Q = 0 to specify Hoerl-Kennard &quot;ordinary&quot; ridge regression.</p>
</td></tr>
<tr><td><code id="qm.ridge_+3A_steps">steps</code></td>
<td>
<p>Number of equally spaced values per unit change along the horizontal
m-Extent-of-shrinkage axis for estimates to be calculated and displayed in TRACES
(default = 20.)</p>
</td></tr>
<tr><td><code id="qm.ridge_+3A_nq">nq</code></td>
<td>
<p>Number of equally spaced values on the lattice of all possible values for
shrinkage q-Shape between the &quot;qmin&quot; and &quot;qmax&quot; parameter settings (default = 21.)</p>
</td></tr>
<tr><td><code id="qm.ridge_+3A_qmax">qmax</code></td>
<td>
<p>Maximum allowed q-Shape (default = +5.)</p>
</td></tr>
<tr><td><code id="qm.ridge_+3A_qmin">qmin</code></td>
<td>
<p>Minimum allowed q-Shape (default = -5.)</p>
</td></tr>
<tr><td><code id="qm.ridge_+3A_omdmin">omdmin</code></td>
<td>
<p>Strictly positive minimum value for one-minus-delta (default = 9.9e-013.)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Traditional qm.ridge() paths cannot be overall-optimal when p &gt; 2 because they are
restricted to using strictly &quot;monotone&quot; (increasing or decreasing) shrinkage factors. Still,
the &quot;best&quot; m-Extent of qm-shrinkage is marked by a vertical dashed-line on all 5-types of
qm.ridge() TRACE displays. Compared to OLS estimates, these shrunken estimates have higher
likelihood of reduced MSE risk and can be much more stable and reasonable, numerically. On
the other hand, because only OLS estimates are guaranteed to be minimax when risk is MATRIX
valued (truly multivariate), no guarantee of an actual reduction in MSE Risk is necessarily
associated with shrinkage. 
</p>


<h3>Value</h3>

<p> An output list object of class qm.ridge:
</p>
<table>
<tr><td><code>form</code></td>
<td>
<p>The regression formula specified as the first argument.</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>Name of the data.frame object specified as the second argument.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>Number of regression predictor variables.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>Number of complete observations after removal of all missing values.</p>
</td></tr>
<tr><td><code>r2</code></td>
<td>
<p>Numerical value of R-square goodness-of-fit statistic.</p>
</td></tr>
<tr><td><code>s2</code></td>
<td>
<p>Numerical value of the residual mean square estimate of error.</p>
</td></tr>
<tr><td><code>prinstat</code></td>
<td>
<p>Listing of principal statistics.</p>
</td></tr>
<tr><td><code>mx</code></td>
<td>
<p>Matrix containing mean values of X-predictors.</p>
</td></tr>
<tr><td><code>crlqstat</code></td>
<td>
<p>Listing of criteria for maximum likelihood selection of path q-Shape.</p>
</td></tr>
<tr><td><code>qmse</code></td>
<td>
<p>Numerical value of q-Shape most likely to be optimal.</p>
</td></tr>
<tr><td><code>qp</code></td>
<td>
<p>Numerical value of the q-Shape actually used for shrinkage.</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p>Matrix of shrinkage-ridge regression coefficient estimates.</p>
</td></tr>
<tr><td><code>risk</code></td>
<td>
<p>Matrix of MSE risk estimates for fitted coefficients.</p>
</td></tr>
<tr><td><code>exev</code></td>
<td>
<p>Matrix of excess MSE eigenvalues (ordinary least squares minus ridge.)</p>
</td></tr>
<tr><td><code>infd</code></td>
<td>
<p>Matrix of direction cosines for the estimated inferior direction, if any.</p>
</td></tr>
<tr><td><code>spat</code></td>
<td>
<p>Matrix of shrinkage pattern multiplicative delta factors.</p>
</td></tr>
<tr><td><code>mlik</code></td>
<td>
<p>Listing of criteria for maximum likelihood selection of m-Extent-of-shrinkage.</p>
</td></tr>
<tr><td><code>sext</code></td>
<td>
<p>Listing of summary statistics for all m-Extents-of-shrinkage.</p>
</td></tr>
<tr><td><code>mClk</code></td>
<td>
<p>Most-Likely Extent of Shrinkage Observed: best multiple of (1/steps) &lt;= p.</p>
</td></tr> 
<tr><td><code>minC</code></td>
<td>
<p>Minimum Observed Value of Normal-theory -2*log(Likelihood-Ratio).</p>
</td></tr>
<tr><td><code>QS</code></td>
<td>
<p>Was a Mesh-Search for Best q-Shape requested? : 1 =&gt; Yes, 0 =&gt; No.</p>
</td></tr>
<tr><td><code>qML</code></td>
<td>
<p>Computable only when p=rank=2: True Most-Likely q-Shape.</p>
</td></tr>
<tr><td><code>kML</code></td>
<td>
<p>Computable only when p=rank=2: True Most-Likely k-Factor.</p>
</td></tr>
<tr><td><code>dML1</code></td>
<td>
<p>Computable only when p=rank=2: True Most-Likely Delta[1]-Factor.</p>
</td></tr>
<tr><td><code>dML2</code></td>
<td>
<p>Computable only when p=rank=2: True Most-Likely Delta[2]-Factor.</p>
</td></tr>
<tr><td><code>mML</code></td>
<td>
<p>Computable only when p=rank=2: True Most-Likely m-Extent.</p>
</td></tr>  
</table>


<h3>Author(s)</h3>

<p>Bob Obenchain &lt;wizbob@att.net&gt;</p>


<h3>References</h3>

<p>Burr TL, Fry HA. (2005) Biased Regression: The Case for Cautious Application.
<em>Technometrics</em> <b>47</b>, 284-296.
</p>
<p>Goldstein M, Smith AFM. (1974) Ridge-type estimators for regression analysis.
<em>J. Roy. Stat. Soc. B</em> <b>36</b>, 284-291. (The 2-parameter shrinkage family.)
</p>
<p>Obenchain RL. (1975) Ridge Analysis Following a Preliminary Test of the Shrunken
Hypothesis. <em>Technometrics</em> <b>17</b>, 431-441. <a href="https://doi.org/10.1080/00401706.1975.10489369">doi:10.1080/00401706.1975.10489369</a>
</p>
<p>Obenchain RL. (1978) Good and Optimal Ridge Estimators. <em>Annals of Statistics</em>
<b>6</b>, 1111-1121. &lt;doi:10.1214/aos/1176344314&gt;
</p>
<p>Obenchain RL. (2022) Efficient Generalized Ridge Regression. <em>Open Statistics</em>
<b>3</b>: 1-18. <a href="https://doi.org/10.1515/stat-2022-0108">doi:10.1515/stat-2022-0108</a> [Best q-Shape when p = 2.]
</p>
<p>Obenchain RL. (2022) <em>RXshrink_in_R.PDF</em> RXshrink package vignette-like document,
Version 2.3. <a href="http://localcontrolstatistics.org">http://localcontrolstatistics.org</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+eff.ridge">eff.ridge</a></code>, <code><a href="#topic+correct.signs">correct.signs</a></code>, <code><a href="#topic+MLtrue">MLtrue</a></code> 
and <code><a href="#topic+RXpredict">RXpredict</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(longley2)
  form &lt;- GNP~GNP.deflator+Unemployed+Armed.Forces+Population+Year+Employed
  rxrobj &lt;- qm.ridge(form, data=longley2)
  rxrobj
  plot(rxrobj)
  str(rxrobj)
</code></pre>

<hr>
<h2 id='RXpredict'>Predictions from Models fit using RXshrink Generalized Ridge Estimation Methods.</h2><span id='topic+RXpredict'></span>

<h3>Description</h3>

<p>RXpredict() makes in-sample predictions (i.e. computes &quot;fitted.values&quot;) for all 6 forms of
RXshrink estimation either at some user-specified m-Extent of Shrinkage, such as m=0.963,
or at the Normal distribution-theory m-Extent most likely to achieve minimum Risk (minMSE).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  RXpredict(x, data, m="minMSE", rscale=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RXpredict_+3A_x">x</code></td>
<td>
<p>An object output by one of the 6 RXshrink estimation functions. Thus class(x) must
be &quot;qm.ridge&quot;, &quot;eff.ridge&quot;, &quot;aug.lars&quot;, &quot;uc.lars&quot;, &quot;MLcalc&quot; or &quot;correct.signs&quot;.</p>
</td></tr>
<tr><td><code id="RXpredict_+3A_data">data</code></td>
<td>
<p>Existing data.frame containing observations on all variables used by the RXshrink
function for estimation of regression coefficients.</p>
</td></tr>
<tr><td><code id="RXpredict_+3A_m">m</code></td>
<td>
<p>The m argument can be either [i] a single &quot;numeric&quot; value that is non-negative and
does not exceed rank(X) or [ii] the (default) string &quot;minMSE&quot; to request use of the observed
m-Extent of shrinkage most likely to be MSE optimal under Normal distribution-theory. For
example, m=&quot;0.0&quot; requests use of the (unbaised) OLS estimate [BLUE].</p>
</td></tr>
<tr><td><code id="RXpredict_+3A_rscale">rscale</code></td>
<td>
<p>One of two possible choices (0 or 1) for &quot;rescaling&quot; of variables (after being
&quot;centered&quot;) to remove all &quot;non-essential&quot; ill-conditioning. Use &quot;rscale=0&quot; only when the RXshrink
estimation function that computed the x-object also used &quot;rscale=0&quot;. The default of &quot;rscale=1&quot;
should be used in all other cases.</p>
</td></tr>
</table>


<h3>Value</h3>

<p> An output list object of class RXpredict:
</p>
<table>
<tr><td><code>cryprd</code></td>
<td>
<p>Predicted values for the &quot;centered&quot; and POSSIBLY &quot;rescaled&quot; outcome y-vector, cry.
These values correspond, for example, to the default &quot;predicted.values&quot; from lm().</p>
</td></tr>
<tr><td><code>cry</code></td>
<td>
<p>This the &quot;centered&quot; and POSSIBLY &quot;rescaled&quot; outcome y-vector from the input data.frame.</p>
</td></tr>
<tr><td><code>yvecprd</code></td>
<td>
<p>Predicted values for the Y-outcome variable, yvec.</p>
</td></tr>
<tr><td><code>yvec</code></td>
<td>
<p>The Y-outcome vector from the input data.frame specified by the &quot;data&quot; argument.</p>
</td></tr>
<tr><td><code>m</code></td>
<td>
<p>&quot;numeric&quot; Value of m-Extent implied by the call to RXpredict(), possibly via a default
call with m=&quot;minMSE&quot;. Restriction: 0 &lt;= m &lt;= rank(X).</p>
</td></tr> 
<tr><td><code>mobs</code></td>
<td>
<p>Observed m-Extent most close to the requested m-Extent AND is on the lattice of
observed m-Extents stored within the given x-object.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Bob Obenchain &lt;wizbob@att.net&gt;</p>


<h3>References</h3>

<p>Obenchain RL. (1978) Good and Optimal Ridge Estimators. <em>Annals of Statistics</em>
<b>6</b>, 1111-1121. <a href="https://doi.org/10.1214/aos/1176344314">doi:10.1214/aos/1176344314</a>
</p>
<p>Obenchain RL. (2005)
<em>Shrinkage Regression: ridge, BLUP, Bayes, spline and Stein</em>.  Electronic
book-in-progress (185+ pages.) <a href="http://localcontrolstatistics.org">http://localcontrolstatistics.org</a>
</p>
<p>Obenchain RL. (2022) <em>RXshrink_in_R.PDF</em> RXshrink package vignette-like document,
Version 2.2. <a href="http://localcontrolstatistics.org">http://localcontrolstatistics.org</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+qm.ridge">qm.ridge</a></code>, <code><a href="#topic+eff.ridge">eff.ridge</a></code> and <code><a href="#topic+MLtrue">MLtrue</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(tycobb)
  form &lt;- batavg~atbats+seasons+CMspl
  rxefobj &lt;- eff.ridge(form, data=tycobb)
  tycfit &lt;- RXpredict(rxefobj, tycobb, m="minMSE")
  plot(tycfit)
  tycobb$batavg[18]  # Ty Cobb's batavg = 0.401 in 1922
  abline(h=tycfit$cry[18], lty=2, lwd=3, col="red")
</code></pre>

<hr>
<h2 id='RXshrink-internal'>Internal RXshrink functions</h2><span id='topic+RXshrink-internal'></span><span id='topic+print.aug.lars'></span><span id='topic+print.correct.signs'></span><span id='topic+print.eff.ridge'></span><span id='topic+print.MLboot'></span><span id='topic+print.MLcalc'></span><span id='topic+print.MLhist'></span><span id='topic+print.MLtrue'></span><span id='topic+print.qm.ridge'></span><span id='topic+print.RXpredict'></span><span id='topic+print.uc.lars'></span><span id='topic+print.unr.ridge'></span><span id='topic+print.eff.biv'></span><span id='topic+print.YonX'></span><span id='topic+mstep'></span><span id='topic+kofm1'></span><span id='topic+mofk1'></span><span id='topic+mapp'></span><span id='topic+B19'></span>

<h3>Description</h3>

<p>These are internal functions for printing and calculating quantities such
as additive K-factors and multiplicative Delta-Factors that determine a specified
m-Extent of Shrinkage. mstep() is called by qm.ridge(), true.risk(), true.simu(), aug.lars()
and uc.lars(). kofm1(), mofk1() and mapp() are called by YonX(). B19() is called by
plot.eff.ridge() and plot.qm.ridge().
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  mstep(mobj, kinc, p, qp, eqm1)
  mofk1(k, dMSE)
  kofm1(muobj, dMSE, delmax)
  mapp(mVal, YXobj)
  B19(x)  
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RXshrink-internal_+3A_mobj">mobj</code></td>
<td>
<p>Objective value for the M-extent-of-shrinkage along a path of shape qp.</p>
</td></tr>
<tr><td><code id="RXshrink-internal_+3A_kinc">kinc</code></td>
<td>
<p>Previous additive eigenvalue inflation constant yielding a smaller mobj.</p>
</td></tr>
<tr><td><code id="RXshrink-internal_+3A_p">p</code></td>
<td>
<p>Number of estimates in the regression coefficient vector.</p>
</td></tr>
<tr><td><code id="RXshrink-internal_+3A_qp">qp</code></td>
<td>
<p>Shrinkage path <b>Q</b>-shape parameter.</p>
</td></tr>
<tr><td><code id="RXshrink-internal_+3A_eqm1">eqm1</code></td>
<td>
<p>Vector of X'X eigenvalues raised to the power (qp-1).</p>
</td></tr>
<tr><td><code id="RXshrink-internal_+3A_k">k</code></td>
<td>
<p>Multiplicative factor that must decrease to increase shrinkage.</p>
</td></tr>
<tr><td><code id="RXshrink-internal_+3A_dmse">dMSE</code></td>
<td>
<p>MSE Optimal Shrinkage delta-factor for YonX().</p>
</td></tr>
<tr><td><code id="RXshrink-internal_+3A_muobj">muobj</code></td>
<td>
<p>Objective value for M-extent-of-shrinkage in kofm1().</p>
</td></tr>
<tr><td><code id="RXshrink-internal_+3A_delmax">delmax</code></td>
<td>
<p>Scalar value strictly &lt; 1. Default value is delmax = 0.999999.</p>
</td></tr>
<tr><td><code id="RXshrink-internal_+3A_mval">mVal</code></td>
<td>
<p>Objective M-extent-of-shrinkage in mapp().</p>
</td></tr>
<tr><td><code id="RXshrink-internal_+3A_yxobj">YXobj</code></td>
<td>
<p>YonX object used by mapp().</p>
</td></tr>
<tr><td><code id="RXshrink-internal_+3A_x">x</code></td>
<td>
<p>Numerical value argument for B19().</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An output list consisting of two objects (k-factor &amp; d-matrix):
</p>
<table>
<tr><td><code>kinc</code></td>
<td>
<p>New k-factor producing an m-Extent-of-shrinkage of mobj.</p>
</td></tr>
<tr><td><code>d</code></td>
<td>
<p>A pxp diagonal matrix of multiplicative shrinkage delta-factors for the
uncorrelated components of the regression coefficient vector. p = 1 in mofk1().</p>
</td></tr>
<tr><td><code>m</code></td>
<td>
<p>m-Extent of Shrinkage output by mofk1() or mapp().</p>
</td></tr>  
<tr><td><code>kStar</code></td>
<td>
<p>New k-factor producing an m-Extent-of-shrinkage of muobj.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Bob Obenchain &lt;wizbob@att.net&gt;</p>

<hr>
<h2 id='RXshrink-package'>Maximum Likelihood (ML) Shrinkage using Generalized Ridge or Least Angle Regression</h2><span id='topic+RXshrink-package'></span>

<h3>Description</h3>

<p>The functions in this package augment basic calculations of Generalized Ridge and
Least Angle Regression plus Visual Insights from five types of ridge TRACE display: [1] regression
coefficients, [2] relative MSE risk, [3] excess eigenvalues, [4] inferior direction cosines, and [5]
shrinkage delta-factors. These TRACEs reveal the primary Effects of Shrinkage along ridge paths with
1, 2 or more parameters: shrinkage m-Extent, path q-Shape, and the p shrinkage delta-factors applied
to the uncorrelated components of the Ordinary Least Squares estimator. All paths start at the OLS
estimate [m = 0] and end at the shrinkage Terminous, (0, 0, ..., 0), where m = p = rank of the
centered and rescaled X-matrix. Three different measures of overall Likelihood of minimal MSE risk
(Classical Normal-Theory, Empirical Bayes, and Random Coefficients) are monitored to suggest an
optimal m-Extent of shrinkage for the given matrix of non-constant x-Variables and the observed
y-Outcome vector.  
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
  Package: </td><td style="text-align: left;"> RXshrink</td>
</tr>
<tr>
 <td style="text-align: left;">
  Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
  Version: </td><td style="text-align: left;"> 2.3</td>
</tr>
<tr>
 <td style="text-align: left;">
  Date: </td><td style="text-align: left;"> 2023-08-15</td>
</tr>
<tr>
 <td style="text-align: left;">
  License: </td><td style="text-align: left;"> GNU GENERAL PUBLIC LICENSE, Version 2, June 1991</td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>

<p>The eff.ridge() function calculates generalized ridge TRACE statistics for the Efficient Shrinkage
PATH with p &gt; 1 parameters. This PATH always passes through the Beta coefficient point-estimate that
is most likely to achieve optimal MSE risk reductions under normal distribution-theory. This PATH is
as Short as Possible; it consists of a Two-Piece Linear function with its single &quot;interior&quot; Knot at
the MSE Risk Optimal m-Extent of Shrinkage. 
</p>
<p>MLboot(), MLcalc() and MLhist() support use of Bootstrap resampling to study both the Bias and the
MSE Risk characeristics of non-linear (unrestricted) Generalized Ridge Regression (GRR) estimators.
</p>
<p>When true regression parameters have user-specified (KNOWN) numerical values, MLtrue() uses this
information and generates a new data.frame that contains a y-Outcome vector of the expected form
with &quot;disturbance&quot; terms that are I.I.D. Normal errors-in-measurement. Arguments to MLtrue() must
include the &quot;formula&quot; for a desired linear model and a data.frame containing the specified
X-variables.
</p>
<p>qm.ridge() calculates and displays TRACEs for traditional PATHs defined by just 2-parameters:
<b>q</b>-Shape and <b>m</b>-Extent of Shrinkage. By default, the search for the Path with most
likely <b>q</b>-Shape uses a lattice of only 21 values within [-5,+5]. However, lattice searches for
both q-Shape and m-Extent are easy to modify using the qmax, qmin, nq and steps arguments to qm.ridge().
The &quot;ordinary&quot; ridge Path of Hoerl and Kennard always uses <b>q</b>-Shape = 0, while &quot;uniform&quot; shrinkage
corresponds to <b>q</b>-Shape = +1. NONE of these qm-Paths generally achieve Overall Minimum MSE
Risk when p &gt; 2 because they restrict attention to a &quot;monotome&quot; (increasing or decreasing) family of
&quot;delta&quot; shrinkage-factors.  
</p>
<p>aug.lars() augments the Efron-Hastie lars() R-function to perform Least Angle Regression with
MSE risk calculations and Maximum Likelihood TRACE displays ...like those of eff.ridge() and
qm.ridge().
</p>
<p>uc.lars() applies Least Angle Regression methods to the <b>Uncorrelated Components</b> of a possibly
ill-conditioned set of x-Variables. Calculations use a closed-form expression for lars/lasso
shrinkage delta-factors that apply because NO Ill-Conditioning is present in these &quot;uc&quot; cases.
</p>
<p>correct.signs() displays the Normal-theory maximum likelihood estimate of the regression
coefficient vector that minimizes MSE Risk in the UNKNOWN direction of p-space PARALLEL to
the true Beta vector. This estimate corrects &quot;wrong-sign&quot; problems in the sense that its
coefficients have the same relative magnitudes and numerical signs as those of the &quot;Correlation
Form&quot; of the X'y vector.
</p>
<p>YonX() displays Shrinkage statistics and graphics for &quot;simple&quot; linear regression (p = 1) models.
</p>
<p>RXpredict() makes predictions (i.e. computes &quot;fitted.values&quot;) for 6 types of RXshrink
estimation ...either at a user-specified m-Extent of Shrinkage or at the Normal-theory &quot;minMSE&quot;
m-Extent.
</p>


<h3>Author(s)</h3>

<p>Bob Obenchain &lt;wizbob@att.net&gt;</p>


<h3>References</h3>

<p>Efron B, Hastie T, Johnstone I, Tibshirani R. (2003) Least angle regression.
<em>Annals of Statistics</em> <b>32</b>, 407-499.
</p>
<p>Goldstein M, Smith AFM. (1974) Ridge-type estimators for regression analysis.
<em>J. Roy. Stat. Soc. B</em> <b>36</b>, 284-291. (The 2-parameter shrinkage family.)
</p>
<p>Obenchain RL. (1975) Ridge Analysis Following a Preliminary Test of the Shrunken
Hypothesis. <em>Technometrics</em> <b>17</b>, 431-441. <a href="https://doi.org/10.1080/00401706.1975.10489369">doi:10.1080/00401706.1975.10489369</a>
</p>
<p>Obenchain RL. (1977) Classical F-tests and Confidence Regions for Ridge Regression.
<em>Technometrics</em> <b>19</b>, 429-439. <a href="https://doi.org/10.1080/00401706.1977.10489582">doi:10.1080/00401706.1977.10489582</a>
</p>
<p>Obenchain RL. (1978) Good and Optimal Ridge Estimators. <em>Annals of Statistics</em>
<b>6</b>, 1111-1121. <a href="https://doi.org/10.1214/aos/1176344314">doi:10.1214/aos/1176344314</a>
</p>
<p>Obenchain RL. (2022) Efficient Generalized Ridge Regression. <em>Open Statistics</em>
<b>3</b>: 1-18. <a href="https://doi.org/10.1515/stat-2022-0108">doi:10.1515/stat-2022-0108</a>
</p>
<p>Obenchain RL. (2023) <em>RXshrink_in_R.PDF</em> RXshrink package vignette-like document,
Version 2.3. <a href="http://localcontrolstatistics.org">http://localcontrolstatistics.org</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  demo(longley2)
</code></pre>

<hr>
<h2 id='syxi'>Linear and GAM Spline Predictions from a Single x-Variable</h2><span id='topic+syxi'></span>

<h3>Description</h3>

<p>Compute and display (x,y) plots with their linear and gam() spline y-predictions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  syxi(form, data, i = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="syxi_+3A_form">form</code></td>
<td>
<p>A &quot;simple&quot; regression formula [y~x] suitable for use with lm().</p>
</td></tr>
<tr><td><code id="syxi_+3A_data">data</code></td>
<td>
<p>data.frame containing at least 10 observations on both variables in the formula.</p>
</td></tr>
<tr><td><code id="syxi_+3A_i">i</code></td>
<td>
<p>A single integer &quot;index&quot; within 1:25.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The gam() functon from the <em>mgcv</em> R-package is used to compute and,
subsequently, to generate plots that visually compare the &quot;linear&quot; fit from lm(y~x)
with a potentially &quot;nonlinear&quot; fit using smoothing parameters. The horizontal axis on
type = &quot;sy&quot; plots gives potentially &quot;straightened out&quot; x numerical values.
</p>


<h3>Value</h3>

<p> An output list object of class syxi:
</p>
<table>
<tr><td><code>dfname</code></td>
<td>
<p>Name of the data.frame object specified as the second argument.</p>
</td></tr> 
<tr><td><code>xname</code></td>
<td>
<p>&quot;xi&quot; as Two or Three Characters.</p>
</td></tr> 
<tr><td><code>sxname</code></td>
<td>
<p>&quot;si&quot; as Two or Three Characters.</p>
</td></tr>
<tr><td><code>dfsxf</code></td>
<td>
<p>A data.frame containing 3 variables: &quot;yvec&quot;, &quot;xvec&quot;, and &quot;sxfit&quot;.</p>
</td></tr>    
<tr><td><code>yxcor</code></td>
<td>
<p>Pearson correlation between &quot;yvec&quot; and &quot;xvec&quot;.</p>
</td></tr>
<tr><td><code>yscor</code></td>
<td>
<p>Pearson correlation between &quot;yvec&quot; and &quot;sxfit&quot;.</p>
</td></tr>
<tr><td><code>xscor</code></td>
<td>
<p>Pearson correlation between &quot;xvec&quot; and &quot;sxfit&quot;.</p>
</td></tr>
<tr><td><code>lmyxc</code></td>
<td>
<p>lm() Coefficients (intercept and slope) for y ~ x.</p>
</td></tr>
<tr><td><code>lmysc</code></td>
<td>
<p>lm() Coefficients (intercept and slope) for y ~ sxfit.</p>
</td></tr>
<tr><td><code>adjR2</code></td>
<td>
<p>Adjusted R2 value from gam.sum$r.sq.</p>
</td></tr>		
</table>


<h3>Author(s)</h3>

<p>Bob Obenchain &lt;wizbob@att.net&gt;</p>


<h3>References</h3>

<p>Obenchain RL. (2022) Efficient Generalized Ridge Regression. <em>Open Statistics</em>
<b>3</b>: 1-18. <a href="https://doi.org/10.1515/stat-2022-0108">doi:10.1515/stat-2022-0108</a>
</p>
<p>Obenchain RL. (2023) Nonlinear Generalized Ridge Regression. <em>arXiv preprint</em>
<a href="https://arxiv.org/abs/2103.05161">https://arxiv.org/abs/2103.05161</a>  
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  library(mgcv)
  data(longley2)
  form = GNP ~ Year
  GNPpred = syxi(form, data=longley2, i = 1)
  plot(GNPpred, type="xy")
  title(main="y = GNP on x1 = Year")
  plot(GNPpred, type="sy")
  title(main="y = GNP on Spline for Year")
</code></pre>

<hr>
<h2 id='tycobb'>Ty Cobb batting statistics for 1905&ndash;1928 with Carl Morris' 2-piece Spline term.</h2><span id='topic+tycobb'></span>

<h3>Description</h3>

<p>Linear Regression models can be used to predict Ty Cobb's Expected true
yearly batting averages from his observed yearly &quot;batavg&quot; and the 5 other variables
stored in the &quot;tycobb&quot; data.frame. Predictions from such &quot;models&quot; can address the
question: &quot;Was Ty Cobb ever a TRUE .400 hitter?&quot; Since a player's seasonal batavg
is a &quot;random variable,&quot; the fact that Cobb's batavg was 0.4196 in 1911 and 0.4105
in 1912 does not necessarily imply that his Expected Seasonal batavg was truly
over .400 in either of those consecutive seasons. For example, his batavg was 0.4011
in 1922 (10 years later). However, his seasonal batavg had dipped to &quot;only&quot; 0.3341
in 1920.
</p>
<p>&quot;Cobb lived off the field as though he wished to live forever. He lived on the field
as though it was his last day.&quot; &ndash; Branch Rickey, Major League Baseball Hall of Fame
executive. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(tycobb)</code></pre>


<h3>Format</h3>

<p>A data frame with 24 observations (years) on the following 6 variables.
</p>

<dl>
<dt><code>year</code></dt><dd><p>Ty Cobb's 24 American League Seasons: 1905 - 1928.</p>
</dd>
<dt><code>hits</code></dt><dd><p>Total number of Hits that season.</p>
</dd>
<dt><code>atbats</code></dt><dd><p>Total number of times at Bat that season.</p>
</dd>
<dt><code>CMspl</code></dt><dd><p>Carl Morris' Piecewise-Linear Spline term with &quot;knot&quot; in
season 6 (1910).</p>
</dd>
<dt><code>seasons</code></dt><dd><p>A linear &quot;Trend&quot; term: 1, 2, ..., 24.</p>
</dd>
<dt><code>batavg</code></dt><dd><p>Cobb's Seasonal Batting Average ... 7 decimal places.</p>
</dd> 	
</dl>



<h3>References</h3>

<p>Carl Morris. (1982). &quot;Was Ty Cobb ever a TRUE .400 hitter?&quot; One-page Handout for his
JSM Lecture on August 18 in Cincinnati, Ohio.
</p>

<hr>
<h2 id='uc.lars'>Maximum Likelihood Least Angle Regression on Uncorrelated X-Components</h2><span id='topic+uc.lars'></span>

<h3>Description</h3>

<p>Apply least angle regression estimation to the uncorrelated
components of a possibly ill-conditioned linear regression model and
generate normal-theory maximum likelihood TRACE displays.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  uc.lars(form, data, rscale = 1, type = "lar", trace = FALSE, 
    eps = .Machine$double.eps, omdmin = 9.9e-13) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="uc.lars_+3A_form">form</code></td>
<td>
<p>A regression formula [y~x1+x2+...] suitable for use with lm().</p>
</td></tr>
<tr><td><code id="uc.lars_+3A_data">data</code></td>
<td>
<p>Data frame containing observations on all variables in the formula.</p>
</td></tr>
<tr><td><code id="uc.lars_+3A_rscale">rscale</code></td>
<td>
<p>One of three possible choices (0, 1 or 2) for &quot;rescaling&quot; of variables
(after being &quot;centered&quot;) to remove all &quot;non-essential&quot; ill-conditioning: 0 implies no
rescaling; 1 implies divide each variable by its standard error; 2 implies rescale as
in option 1 but re-express answers as in option 0.</p>
</td></tr>
<tr><td><code id="uc.lars_+3A_type">type</code></td>
<td>
<p>One of &quot;lasso&quot;, &quot;lar&quot; or &quot;forward.stagewise&quot; for function lars(). Names can be
abbreviated to any unique substring. Default in uc.lars() is &quot;lar&quot;.</p>
</td></tr>
<tr><td><code id="uc.lars_+3A_trace">trace</code></td>
<td>
<p>If TRUE, lars() function prints out its progress.</p>
</td></tr>
<tr><td><code id="uc.lars_+3A_eps">eps</code></td>
<td>
<p>The effective zero for lars().</p>
</td></tr>
<tr><td><code id="uc.lars_+3A_omdmin">omdmin</code></td>
<td>
<p>Strictly positive minimum allowed value for one-minus-delta (default = 9.9e-013.)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>uc.lars() applies Least Angle Regression to the uncorrelated components of a
possibly ill-conditioned set of x-variables.  A closed-form expression for the lars/lasso
shrinkage delta factors exits in this case: Delta(i) = max(0,1-k/abs[PC(i)]), where PC(i)
is the principal correlation between y and the i-th principal coordinates of X. Note that
the k-factor in this formulation is limited to a subset of [0,1].  MCAL=0 occurs at k=0,
while MCAL = p results when k is the maximum absolute principal correlation. 
</p>


<h3>Value</h3>

<p> An output list object of class uc.lars:
</p>
<table>
<tr><td><code>form</code></td>
<td>
<p>The regression formula specified as the first argument.</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>Name of the data.frame object specified as the second argument.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>Number of regression predictor variables.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>Number of complete observations after removal of all missing values.</p>
</td></tr>
<tr><td><code>r2</code></td>
<td>
<p>Numerical value of R-square goodness-of-fit statistic.</p>
</td></tr>
<tr><td><code>s2</code></td>
<td>
<p>Numerical value of the residual mean square estimate of error.</p>
</td></tr>
<tr><td><code>prinstat</code></td>
<td>
<p>Listing of principal statistics.</p>
</td></tr>
<tr><td><code>gmat</code></td>
<td>
<p>Orthogonal matrix of direction cosines for regressor principal axes.</p>
</td></tr>
<tr><td><code>lars</code></td>
<td>
<p>An object of class lars.</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p>Matrix of shrinkage-ridge regression coefficient estimates.</p>
</td></tr>
<tr><td><code>risk</code></td>
<td>
<p>Matrix of MSE risk estimates for fitted coefficients.</p>
</td></tr>
<tr><td><code>exev</code></td>
<td>
<p>Matrix of excess MSE eigenvalues (ordinary least squares minus ridge.)</p>
</td></tr>
<tr><td><code>infd</code></td>
<td>
<p>Matrix of direction cosines for the estimated inferior direction, if any.</p>
</td></tr>
<tr><td><code>spat</code></td>
<td>
<p>Matrix of shrinkage pattern multiplicative delta factors.</p>
</td></tr>
<tr><td><code>mlik</code></td>
<td>
<p>Listing of criteria for maximum likelihood selection of M-extent-of-shrinkage.</p>
</td></tr>
<tr><td><code>sext</code></td>
<td>
<p>Listing of summary statistics for all M-extents-of-shrinkage.</p>
</td></tr>
<tr><td><code>mClk</code></td>
<td>
<p>Most Likely Extent of Shrinkage Observed: best multiple of (1/steps) &lt;= p.</p>
</td></tr> 
<tr><td><code>minC</code></td>
<td>
<p>Minimum Observed Value of Normal-theory -2*log(Likelihood).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Bob Obenchain &lt;wizbob@att.net&gt;</p>


<h3>References</h3>

<p>Hastie T, Efron, B. (2013) lars: Least Angle Regression, Lasso and Forward Stagewise.
ver 1.2, <a href="https://CRAN.R-project.org/package=lars">https://CRAN.R-project.org/package=lars</a>
</p>
<p>Obenchain RL. (1994-2005) Shrinkage Regression: ridge, BLUP, Bayes, spline and Stein.
<a href="http://localcontrolstatistics.org">http://localcontrolstatistics.org</a>
</p>
<p>Obenchain RL. (2022) <em>RXshrink_in_R.PDF</em> RXshrink package vignette-like document,
Version 2.1. <a href="http://localcontrolstatistics.org">http://localcontrolstatistics.org</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+aug.lars">aug.lars</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(longley2)
  form &lt;- GNP~GNP.deflator+Unemployed+Armed.Forces+Population+Year+Employed
  rxucobj &lt;- uc.lars(form, data=longley2)
  rxucobj
  plot(rxucobj)
  str(rxucobj)
</code></pre>

<hr>
<h2 id='YonX'>Maximum Likelihood (ML) Shrinkage in Simple Linear Regression</h2><span id='topic+YonX'></span>

<h3>Description</h3>

<p>Compute and display Normal-theory ML Shrinkage statistics when a y-Outcome Variable
is regressed upon a SINGLE x-Variable (i.e. p = 1). This illustration is usefull in
regression pedagogy. The OLS (BLUE) estimate is a scalar in these simple cases, so
the MSE optimal Shrinkage factor, dMSE, is also a scalar less than +1 and greater
than 0 when cor(y,x) differs from Zero. The corresponding m-Extent of Optimal
Shrinkage is marked by the &quot;purple&quot; vertical dashed-line on all YonX() TRACE
Diagnostics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  YonX(form, data, delmax = 0.999999)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="YonX_+3A_form">form</code></td>
<td>
<p>A regression formula [y ~ x] suitable for use with lm().</p>
</td></tr>
<tr><td><code id="YonX_+3A_data">data</code></td>
<td>
<p>Data frame containing observations on both variables in the formula.</p>
</td></tr>
<tr><td><code id="YonX_+3A_delmax">delmax</code></td>
<td>
<p>Maximum allowed value for Shrinkage delta-factor that is strictly less
than 1. (default = 0.999999, which prints as 1 when rounded to fewer than 6 decimal
places.)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Since only a single x-Variable is being used, these &quot;simple&quot; models are
(technically) NOT &quot;Ill-conditioned&quot;. Of course, the y-Outcome may be nearly
multi-collinear with the given x-Variable, but this simply means that the model
then has low &quot;lack-of-fit&quot;. In fact, the OLS estimate can never have the &quot;wrong&quot;
numerical sign in these simple p = 1 models!  Furthermore, since &quot;risk&quot; estimates
are scalar-valued, no &quot;exev&quot; TRACE is routinely displayed; its content duplicates
information in the &quot;rmse&quot; TRACE. Similarly, no &quot;infd&quot; TRACE is displayed because
any &quot;inferior direction&quot; COSINE would be either: +1 (&quot;upwards&quot;) when an estimate
is decreasing, or -1 (&quot;downwards&quot;) when an estimate is increasing. The m-Extent
of shrinkage is varied from 0.000 to 1.000 in 1000 &quot;steps&quot; of size 0.001.
</p>


<h3>Value</h3>

<p> An output list object of class YonX:
</p>
<table>
<tr><td><code>data</code></td>
<td>
<p>Name of the data.frame object specified as the second argument.</p>
</td></tr>
<tr><td><code>form</code></td>
<td>
<p>The regression formula specified as the first argument to YonX() must
have only ONE right-hand-side X-variable in calls to YonX().</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>Number of X-variables MUST be p = 1 in YonX().</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>Number of complete observations after removal of all missing values.</p>
</td></tr>
<tr><td><code>r2</code></td>
<td>
<p>Numerical value of R-square goodness-of-fit statistic.</p>
</td></tr>
<tr><td><code>s2</code></td>
<td>
<p>Numerical value of the residual mean square estimate for error.</p>
</td></tr>
<tr><td><code>prinstat</code></td>
<td>
<p>Vector of five Principal Statistics: eigval, sv, b0, rho &amp; tstat.</p>
</td></tr> 
<tr><td><code>yxnam</code></td>
<td>
<p>Character Names of &quot;Y&quot; and &quot;X&quot; data vectors.</p>
</td></tr>
<tr><td><code>yvec</code></td>
<td>
<p>&quot;Y&quot; vector of data values.</p>
</td></tr>
<tr><td><code>xvec</code></td>
<td>
<p>&quot;X&quot; vector of data values.</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p>Vector of Shrinkage regression Beta-coefficient estimates: delta * B0.</p>
</td></tr>
<tr><td><code>rmse</code></td>
<td>
<p>Vector of Relative MSE Risk estimates starting with the rmse of the OLS estimate.</p>
</td></tr>
<tr><td><code>spat</code></td>
<td>
<p>Vector of Shrinkage (multiplicative) delta-factors: 1.000 to 0.000 by -0.001.</p>
</td></tr>
<tr><td><code>qrsk</code></td>
<td>
<p>Vector of Quatratic Relative MSE Risk estimates with minimum at delta = dMSE.</p>
</td></tr>
<tr><td><code>exev</code></td>
<td>
<p>Vector of Excess Eigenvalues = Difference in MSE Risk: OLS minus GRR.</p>
</td></tr>  
<tr><td><code>mlik</code></td>
<td>
<p>Normal-theory Likelihood ...for Maximum Likelihood estimation of Shrinkage m-Extent.</p>
</td></tr>
<tr><td><code>sext</code></td>
<td>
<p>Listing of summary statistics for all M-extents-of-shrinkage.</p>
</td></tr>
<tr><td><code>mUnr</code></td>
<td>
<p>Unrestricted optimal m-Extent of Shrinkage from the dMSE estimate; mUnr = 1 - dMSE.</p>
</td></tr>   
<tr><td><code>mClk</code></td>
<td>
<p>Most Likely Observed m-Extent of Shrinkage: best multiple of (1/steps) &lt;= 1.</p>
</td></tr> 
<tr><td><code>minC</code></td>
<td>
<p>Minimum Observed Value of CLIK Normal-theory -2*log(Likelihood-Ratio).</p>
</td></tr>
<tr><td><code>minE</code></td>
<td>
<p>Minimum Observed Value of EBAY (Empirical Bayes) criterion.</p>
</td></tr>
<tr><td><code>minR</code></td>
<td>
<p>Minimum Observed Value of RCOF (Random Coefficients) criterion.</p>
</td></tr>  
<tr><td><code>minRR</code></td>
<td>
<p>Minimum Relative Risk estimate.</p>
</td></tr>
<tr><td><code>mRRm</code></td>
<td>
<p>m-Extent of the Minimum Relative Risk estimate.</p>
</td></tr>  
<tr><td><code>mReql</code></td>
<td>
<p>m-Extent where the &quot;qrsk&quot; estimate is first &gt;= the observed OLS RR at m = 0.</p>
</td></tr>
<tr><td><code>Phi2ML</code></td>
<td>
<p>Maximum Likelihood estimate of the Phi-Squared noncentrality parameter of the
F-ratio for testing H: true beta-coefficient = zero.</p>
</td></tr>
<tr><td><code>Phi2UB</code></td>
<td>
<p>Unbiased Phi-Squared noncentrality estimate. This estimate can be negative.</p>
</td></tr>	
<tr><td><code>dALT</code></td>
<td>
<p>This Maximim Likelihood estimate of Optimal Shrinkage has serious Downward Bias.</p>
</td></tr>
<tr><td><code>dMSE</code></td>
<td>
<p>Best Estimate of Optimal Shrinkage Delta-factor from the &quot;Correct Range&quot; adjustment
to the Unbiased Estimate of the NonCentrality of the F-ratio for testing Beta = 0.</p>
</td></tr>  
</table>


<h3>Author(s)</h3>

<p>Bob Obenchain &lt;wizbob@att.net&gt;</p>


<h3>References</h3>

<p>Obenchain RL. (1978) Good and Optimal Ridge Estimators. <em>Annals of Statistics</em>
<b>6</b>, 1111-1121. <a href="https://doi.org/10.1214/aos/1176344314">doi:10.1214/aos/1176344314</a>
</p>
<p>Obenchain RL. (2022) Efficient Generalized Ridge Regression. <em>Open Statistics</em>
<b>3</b>: 1-18. <a href="https://doi.org/10.1515/stat-2022-0108">doi:10.1515/stat-2022-0108</a>
</p>
<p>Obenchain RL. (2022) <em>RXshrink_in_R.PDF</em> RXshrink package vignette-like document,
Version 2.1. <a href="http://localcontrolstatistics.org">http://localcontrolstatistics.org</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+correct.signs">correct.signs</a></code> and <code><a href="#topic+MLtrue">MLtrue</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(haldport)
  form &lt;- heat ~ p4caf
  YXobj &lt;- YonX(form, data=haldport)
  YXobj
  plot(YXobj)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
