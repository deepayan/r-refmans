<!DOCTYPE html><html><head><title>Help for package chunked</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {chunked}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#chunked-package'><p>Chunked</p></a></li>
<li><a href='#insert_chunkwise_into'><p>insert data in chunks into a database</p></a></li>
<li><a href='#read_chunkwise'><p>Read chunkwise from a data source</p></a></li>
<li><a href='#read_csv_chunkwise'><p>Read chunkwise data from text files</p></a></li>
<li><a href='#write_chunkwise'><p>Genereric function to write chunk by chunk</p></a></li>
<li><a href='#write_csv_chunkwise'><p>Write chunks to a csv file</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Chunkwise Text-File Processing for 'dplyr'</td>
</tr>
<tr>
<td>Version:</td>
<td>0.6.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Data stored in text file can be processed chunkwise using 'dplyr' commands. These
    are recorded and executed per data chunk, so large files can be processed with
    limited memory using the 'LaF' package.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/edwindj/chunked/issues">https://github.com/edwindj/chunked/issues</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/edwindj/chunked">https://github.com/edwindj/chunked</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>dplyr (&ge; 0.7)</td>
</tr>
<tr>
<td>Imports:</td>
<td>LaF, utils, rlang, DBI, progress</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, RSQLite, dbplyr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-03-02 12:43:50 UTC; edwindj</td>
</tr>
<tr>
<td>Author:</td>
<td>Edwin de Jonge <a href="https://orcid.org/0000-0002-6580-4718"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Edwin de Jonge &lt;edwindjonge@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-03-07 19:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='chunked-package'>Chunked</h2><span id='topic+chunked-package'></span><span id='topic+select'></span><span id='topic+filter'></span><span id='topic+mutate'></span><span id='topic+dplyr-verbs'></span>

<h3>Description</h3>

<p>R is a great tool, but processing large text files with data is cumbersome.
<code>chunked</code> helps you to process large text files with dplyr while loading
only a part of the data in memory. It builds on the execellent R package LaF
Processing commands are writing in dplyr syntax, and <code>chunked</code>
(using <code>LaF</code>)
will take care that chunk by chunk is processed, taking far less memory
than otherwise. <code>chunked</code> is useful for selecting columns, mutating columns
and filtering rows. It can be used in data pre-processing.
</p>


<h3>Implemented dplyr verbs</h3>


<ul>
<li><p> filter
</p>
</li>
<li><p> select
</p>
</li>
<li><p> rename
</p>
</li>
<li><p> mutate
</p>
</li>
<li><p> transmute
</p>
</li>
<li><p> do
</p>
</li>
<li><p> left_join
</p>
</li>
<li><p> inner_join
</p>
</li>
<li><p> anti_join
</p>
</li>
<li><p> semi_join
</p>
</li>
<li><p> tbl_vars
</p>
</li>
<li><p> collect
</p>
</li></ul>

<p>filter, select, do, left_join, inner_join
</p>


<h3>Not implemented</h3>

<p>The following operators are not implemented because data in <code>chunked</code> is processed
chunkwise, so these are not available.
</p>

<ul>
<li><p> full_join
</p>
</li>
<li><p> right_join
</p>
</li>
<li><p> group_by
</p>
</li>
<li><p> arrange
</p>
</li>
<li><p> tail
</p>
</li></ul>


<hr>
<h2 id='insert_chunkwise_into'>insert data in chunks into a database</h2><span id='topic+insert_chunkwise_into'></span>

<h3>Description</h3>

<p><code>insert_chunkwise_into</code> can be used to insert chunks of data into a
database. Typically <code>chunked</code> can be used to for preprocessing data
before adding it to a database.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>insert_chunkwise_into(x, dest, table, temporary = FALSE, analyze = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="insert_chunkwise_into_+3A_x">x</code></td>
<td>
<p>tbl_chunk object</p>
</td></tr>
<tr><td><code id="insert_chunkwise_into_+3A_dest">dest</code></td>
<td>
<p>database destination, e.g. src_dbi()</p>
</td></tr>
<tr><td><code id="insert_chunkwise_into_+3A_table">table</code></td>
<td>
<p>name of table</p>
</td></tr>
<tr><td><code id="insert_chunkwise_into_+3A_temporary">temporary</code></td>
<td>
<p>Should the table be removed when the database connection is closed?</p>
</td></tr>
<tr><td><code id="insert_chunkwise_into_+3A_analyze">analyze</code></td>
<td>
<p>Should the table be analyzed after import?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code><a href="dplyr.html#topic+tbl">tbl</a></code> object pointing to the table in database <code>dest</code>.
</p>

<hr>
<h2 id='read_chunkwise'>Read chunkwise from a data source</h2><span id='topic+read_chunkwise'></span><span id='topic+read_chunkwise.character'></span><span id='topic+read_chunkwise.laf'></span><span id='topic+read_chunkwise.tbl_sql'></span>

<h3>Description</h3>

<p>Read chunkwise from a data source
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_chunkwise(src, chunk_size = 10000L, ...)

## S3 method for class 'character'
read_chunkwise(
  src,
  chunk_size = 10000L,
  format = c("csv", "csv2", "table"),
  stringsAsFactors = FALSE,
  ...
)

## S3 method for class 'laf'
read_chunkwise(src, chunk_size = 10000L, ...)

## S3 method for class 'tbl_sql'
read_chunkwise(src, chunk_size = 10000L, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_chunkwise_+3A_src">src</code></td>
<td>
<p>source to read from</p>
</td></tr>
<tr><td><code id="read_chunkwise_+3A_chunk_size">chunk_size</code></td>
<td>
<p>size of the chunks</p>
</td></tr>
<tr><td><code id="read_chunkwise_+3A_...">...</code></td>
<td>
<p>parameters used by specific classes</p>
</td></tr>
<tr><td><code id="read_chunkwise_+3A_format">format</code></td>
<td>
<p>used for specifying type of text file</p>
</td></tr>
<tr><td><code id="read_chunkwise_+3A_stringsasfactors">stringsAsFactors</code></td>
<td>
<p><code>logical</code> should string be read as factors?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of type tbl_chunk
</p>

<hr>
<h2 id='read_csv_chunkwise'>Read chunkwise data from text files</h2><span id='topic+read_csv_chunkwise'></span><span id='topic+read_csv2_chunkwise'></span><span id='topic+read_table_chunkwise'></span><span id='topic+read_laf_chunkwise'></span>

<h3>Description</h3>

<p>read_csv_chunk will open a connection to a text file. Subsequent dplyr verbs and commands
are recorded until <code>collect</code>, <code><a href="#topic+write_csv_chunkwise">write_csv_chunkwise</a></code> is called. In that case
the recorded commands will be executed chunk by chunk. This
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_csv_chunkwise(
  file,
  chunk_size = 10000L,
  header = TRUE,
  sep = ",",
  dec = ".",
  stringsAsFactors = FALSE,
  ...
)

read_csv2_chunkwise(
  file,
  chunk_size = 10000L,
  header = TRUE,
  sep = ";",
  dec = ",",
  ...
)

read_table_chunkwise(
  file,
  chunk_size = 10000L,
  header = TRUE,
  sep = " ",
  dec = ".",
  ...
)

read_laf_chunkwise(laf, chunk_size = 10000L)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_csv_chunkwise_+3A_file">file</code></td>
<td>
<p>path of texst file</p>
</td></tr>
<tr><td><code id="read_csv_chunkwise_+3A_chunk_size">chunk_size</code></td>
<td>
<p>size of the chunks te be read</p>
</td></tr>
<tr><td><code id="read_csv_chunkwise_+3A_header">header</code></td>
<td>
<p>Does the csv file have a header with column names?</p>
</td></tr>
<tr><td><code id="read_csv_chunkwise_+3A_sep">sep</code></td>
<td>
<p>field separator to be used</p>
</td></tr>
<tr><td><code id="read_csv_chunkwise_+3A_dec">dec</code></td>
<td>
<p>decimal separator to be used</p>
</td></tr>
<tr><td><code id="read_csv_chunkwise_+3A_stringsasfactors">stringsAsFactors</code></td>
<td>
<p><code>logical</code> should string be read as factors?</p>
</td></tr>
<tr><td><code id="read_csv_chunkwise_+3A_...">...</code></td>
<td>
<p>not used
</p>
<p><code>read_laf_chunkwise</code> reads chunkwise from a LaF object created with <code>laf_open</code>.
It offers more control over
data specification.</p>
</td></tr>
<tr><td><code id="read_csv_chunkwise_+3A_laf">laf</code></td>
<td>
<p>laf object created using LaF</p>
</td></tr>
</table>


<h3>Details</h3>

<p>read_csv_chunkwise can be best combined with
<code><a href="#topic+write_csv_chunkwise">write_csv_chunkwise</a></code> or
<code><a href="#topic+insert_chunkwise_into">insert_chunkwise_into</a></code> (see example)
</p>


<h3>Examples</h3>

<pre><code class='language-R'># create csv file for demo purpose
in_file &lt;- file.path(tempdir(), "in.csv")
write.csv(women, in_file, row.names = FALSE, quote = FALSE)

#
women_chunked &lt;-
  read_chunkwise(in_file) %&gt;%  #open chunkwise connection
  mutate(ratio = weight/height) %&gt;%
  filter(ratio &gt; 2) %&gt;%
  select(height, ratio) %&gt;%
  inner_join(data.frame(height=63:66)) # you can join with data.frames!

# no processing done until
out_file &lt;- file.path(tempdir(), "processed.csv")
women_chunked %&gt;%
  write_chunkwise(file=out_file)

head(women_chunked) # works (without processing all data...)

iris_file &lt;- file.path(tempdir(), "iris.csv")
write.csv(iris, iris_file, row.names = FALSE, quote= FALSE)

iris_chunked &lt;-
  read_chunkwise(iris_file, chunk_size = 49) %&gt;% # 49 for demo purpose
  group_by(Species) %&gt;%
  summarise(sepal_length = mean(Sepal.Length), n=n()) # note that mean is per chunk

</code></pre>

<hr>
<h2 id='write_chunkwise'>Genereric function to write chunk by chunk</h2><span id='topic+write_chunkwise'></span><span id='topic+write_chunkwise.chunkwise'></span>

<h3>Description</h3>

<p>Genereric function to write chunk by chunk
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write_chunkwise(x, dest, ...)

## S3 method for class 'chunkwise'
write_chunkwise(
  x,
  dest,
  table,
  file = dest,
  format = c("csv", "csv2", "table"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="write_chunkwise_+3A_x">x</code></td>
<td>
<p>chunked input, e.g. created with <code>read_chunkwise</code> or it can be a <code>tbl_sql</code> object.</p>
</td></tr>
<tr><td><code id="write_chunkwise_+3A_dest">dest</code></td>
<td>
<p>where should the data be written. May be a character or
a <code>src_sql</code>.</p>
</td></tr>
<tr><td><code id="write_chunkwise_+3A_...">...</code></td>
<td>
<p>parameters that will be passed to the specific implementations.</p>
</td></tr>
<tr><td><code id="write_chunkwise_+3A_table">table</code></td>
<td>
<p>table to write to. Only used when dest is a data base(<code>src_sql</code>)</p>
</td></tr>
<tr><td><code id="write_chunkwise_+3A_file">file</code></td>
<td>
<p>File to write to</p>
</td></tr>
<tr><td><code id="write_chunkwise_+3A_format">format</code></td>
<td>
<p>Specifies the text format for written to disk. Only used
if <code>x</code> is a character.</p>
</td></tr>
</table>

<hr>
<h2 id='write_csv_chunkwise'>Write chunks to a csv file</h2><span id='topic+write_csv_chunkwise'></span><span id='topic+write_csv2_chunkwise'></span><span id='topic+write_table_chunkwise'></span>

<h3>Description</h3>

<p>Writes data to a csv file chunk by chunk. This function must be just in
conjunction with <code><a href="#topic+read_csv_chunkwise">read_csv_chunkwise</a></code>. Chunks of data will
be read, processed and written when this function is called.
For writing to a database use <code><a href="#topic+insert_chunkwise_into">insert_chunkwise_into</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write_csv_chunkwise(
  x,
  file = "",
  sep = ",",
  dec = ".",
  col.names = TRUE,
  row.names = FALSE,
  ...
)

write_csv2_chunkwise(
  x,
  file = "",
  sep = ";",
  dec = ",",
  col.names = TRUE,
  row.names = FALSE,
  ...
)

write_table_chunkwise(
  x,
  file = "",
  sep = "\t",
  dec = ".",
  col.names = TRUE,
  row.names = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="write_csv_chunkwise_+3A_x">x</code></td>
<td>
<p>chunkwise object pointing to a text file</p>
</td></tr>
<tr><td><code id="write_csv_chunkwise_+3A_file">file</code></td>
<td>
<p>file <code>character</code> or connection where the csv file should be written</p>
</td></tr>
<tr><td><code id="write_csv_chunkwise_+3A_sep">sep</code></td>
<td>
<p>field separator</p>
</td></tr>
<tr><td><code id="write_csv_chunkwise_+3A_dec">dec</code></td>
<td>
<p>decimal separator</p>
</td></tr>
<tr><td><code id="write_csv_chunkwise_+3A_col.names">col.names</code></td>
<td>
<p>should column names be written?</p>
</td></tr>
<tr><td><code id="write_csv_chunkwise_+3A_row.names">row.names</code></td>
<td>
<p>should row names be written?</p>
</td></tr>
<tr><td><code id="write_csv_chunkwise_+3A_...">...</code></td>
<td>
<p>passed through to <code><a href="utils.html#topic+read.table">read.table</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>chunkwise object (chunkwise), when writing to a file it refers to the
newly created file, otherwise to <code>x</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># create csv file for demo purpose
in_file &lt;- file.path(tempdir(), "in.csv")
write.csv(women, in_file, row.names = FALSE, quote = FALSE)

#
women_chunked &lt;-
  read_chunkwise(in_file) %&gt;%  #open chunkwise connection
  mutate(ratio = weight/height) %&gt;%
  filter(ratio &gt; 2) %&gt;%
  select(height, ratio) %&gt;%
  inner_join(data.frame(height=63:66)) # you can join with data.frames!

# no processing done until
out_file &lt;- file.path(tempdir(), "processed.csv")
women_chunked %&gt;%
  write_chunkwise(file=out_file)

head(women_chunked) # works (without processing all data...)

iris_file &lt;- file.path(tempdir(), "iris.csv")
write.csv(iris, iris_file, row.names = FALSE, quote= FALSE)

iris_chunked &lt;-
  read_chunkwise(iris_file, chunk_size = 49) %&gt;% # 49 for demo purpose
  group_by(Species) %&gt;%
  summarise(sepal_length = mean(Sepal.Length), n=n()) # note that mean is per chunk

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
