<!DOCTYPE html><html><head><title>Help for package gp</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {gp}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Cumulative probability mass of the generalized Poisson distribution'>
<p>Cumulative probability mass of the generalized Poisson distribution</p></a></li>
<li><a href='#Density computation of the generalized Poisson distribution'>
<p>Density computation of the generalized Poisson distribution</p></a></li>
<li><a href='#gp-package'>
<p>Maximum Likelihood Estimation of the Generalized Poisson Distribution.</p></a></li>
<li><a href='#gp.mle'>
<p>Maximum likelihood estimation of the generalized Poisson distribution</p></a></li>
<li><a href='#gp.reg'>
<p>Generalized Poisson regression</p></a></li>
<li><a href='#rgp'>
<p>Random values simulation from the generalized Poisson distribution</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Maximum Likelihood Estimation of the Generalized Poisson
Distribution</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-10-23</td>
</tr>
<tr>
<td>Author:</td>
<td>Michail Tsagris [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Michail Tsagris &lt;mtsagris@uoc.gr&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rfast, RNGforGPD, stats</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions to estimate the parameters of the generalized Poisson distribution with or without covariates using maximum likelihood. The references include Nikoloulopoulos A.K. &amp; Karlis D. (2008). "On modeling count data: a comparison of some well-known discrete distributions". Journal of Statistical Computation and Simulation, 78(3): 437&ndash;457, &lt;<a href="https://doi.org/10.1080%2F10629360601010760">doi:10.1080/10629360601010760</a>&gt; and Consul P.C. &amp; Famoye F. (1992). "Generalized Poisson regression model". Communications in Statistics - Theory and Methods, 21(1): 89&ndash;109, &lt;<a href="https://doi.org/10.1080%2F03610929208830766">doi:10.1080/03610929208830766</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-10-23 14:07:06 UTC; mtsag</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-10-23 15:50:16 UTC</td>
</tr>
</table>
<hr>
<h2 id='Cumulative+20probability+20mass+20of+20the+20generalized+20Poisson+20distribution'>
Cumulative probability mass of the generalized Poisson distribution
</h2><span id='topic+pgp'></span>

<h3>Description</h3>

<p>Cumulative probability mass of the generalized Poisson distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pgp(y, theta, lambda)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Cumulative+2B20probability+2B20mass+2B20of+2B20the+2B20generalized+2B20Poisson+2B20distribution_+3A_y">y</code></td>
<td>

<p>A vector with non negative integer values.
</p>
</td></tr>
<tr><td><code id="Cumulative+2B20probability+2B20mass+2B20of+2B20the+2B20generalized+2B20Poisson+2B20distribution_+3A_theta">theta</code></td>
<td>

<p>The value of the <code class="reqn">\theta</code> parameter.
</p>
</td></tr>
<tr><td><code id="Cumulative+2B20probability+2B20mass+2B20of+2B20the+2B20generalized+2B20Poisson+2B20distribution_+3A_lambda">lambda</code></td>
<td>

<p>The value of the <code class="reqn">\lambda</code> parameter.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The cumulative probability mass of the generealized Poisson distribution is computed.
</p>


<h3>Value</h3>

<p>A vector with the probabilities.
</p>


<h3>Author(s)</h3>

<p>Michail Tsagris.
</p>
<p>R implementation and documentation: Michail Tsagris <a href="mailto:mtsagris@uoc.gr">mtsagris@uoc.gr</a>.
</p>


<h3>References</h3>

<p>Nikoloulopoulos A.K. &amp; Karlis D. (2008). On modeling count data: a comparison of some well-known discrete distributions. Journal of Statistical Computation and Simulation, 78(3): 437&ndash;457.
</p>
<p>Demirtas H. (2017). On accurate and precise generation of generalized Poisson variates. Communications in Statistics - Simulation and Computation, 46(1): 489&ndash;499.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dgp">dgp</a>, <a href="#topic+rgp">rgp</a> </code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>y &lt;-  rgp(1000, 10, 0.5, method = "Inversion")
a &lt;- gp.mle(y)
pgp(y[1:10], a[1], a[2])
</code></pre>

<hr>
<h2 id='Density+20computation+20of+20the+20generalized+20Poisson+20distribution'>
Density computation of the generalized Poisson distribution
</h2><span id='topic+dgp'></span>

<h3>Description</h3>

<p>Density computation of the generalized Poisson distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dgp(y, theta, lambda, logged = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Density+2B20computation+2B20of+2B20the+2B20generalized+2B20Poisson+2B20distribution_+3A_y">y</code></td>
<td>

<p>A vector with non negative integer values.
</p>
</td></tr>
<tr><td><code id="Density+2B20computation+2B20of+2B20the+2B20generalized+2B20Poisson+2B20distribution_+3A_theta">theta</code></td>
<td>

<p>The value of the <code class="reqn">\theta</code> parameter.
</p>
</td></tr>
<tr><td><code id="Density+2B20computation+2B20of+2B20the+2B20generalized+2B20Poisson+2B20distribution_+3A_lambda">lambda</code></td>
<td>

<p>The value of the <code class="reqn">\lambda</code> parameter.
</p>
</td></tr>
<tr><td><code id="Density+2B20computation+2B20of+2B20the+2B20generalized+2B20Poisson+2B20distribution_+3A_logged">logged</code></td>
<td>

<p>Should the logarithm of the density values be computed? The default value is TRUE.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The density of the generealized Poisson distribution is computed.
</p>


<h3>Value</h3>

<p>A vector with the logged density values.
</p>


<h3>Author(s)</h3>

<p>Michail Tsagris.
</p>
<p>R implementation and documentation: Michail Tsagris <a href="mailto:mtsagris@uoc.gr">mtsagris@uoc.gr</a>.
</p>


<h3>References</h3>

<p>Nikoloulopoulos A.K. &amp; Karlis D. (2008). On modeling count data: a comparison of some well-known discrete distributions. Journal of Statistical Computation and Simulation, 78(3): 437&ndash;457.
</p>
<p>Demirtas H. (2017). On accurate and precise generation of generalized Poisson variates. Communications in Statistics - Simulation and Computation, 46(1): 489&ndash;499.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rgp">rgp</a>, <a href="#topic+pgp">pgp</a> </code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>y &lt;-  rgp(1000, 10, 0.5, method = "Inversion")
a &lt;- gp.mle(y)
f &lt;- dgp(y, a[1], a[2])
sum(f)
</code></pre>

<hr>
<h2 id='gp-package'>
Maximum Likelihood Estimation of the Generalized Poisson Distribution.
</h2><span id='topic+gp-package'></span>

<h3>Description</h3>

<p>Maximum likelihood estimation of the generalized Poisson distribution. Regression modelling is also supported.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> gp</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.1</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2023-10-23</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Maintainers</h3>

<p>Michail Tsagris <a href="mailto:mtsagris@uoc.gr">mtsagris@uoc.gr</a>.
</p>


<h3>Author(s)</h3>

<p>Michail Tsagris <a href="mailto:mtsagris@uoc.gr">mtsagris@uoc.gr</a>.
</p>


<h3>References</h3>

<p>Nikoloulopoulos A.K. &amp; Karlis D. (2008). On modeling count data: a comparison of some well-known discrete distributions. Journal of Statistical Computation and Simulation, 78(3): 437&ndash;457.
Consul P.C. &amp; Famoye F. (1992). Generalized poisson regression model. Communications in Statistics - Theory and Methods, 21(1): 89&ndash;109.
</p>

<hr>
<h2 id='gp.mle'>
Maximum likelihood estimation of the generalized Poisson distribution
</h2><span id='topic+gp.mle'></span>

<h3>Description</h3>

<p>Maximum likelihood estimation of the generalized Poisson distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gp.mle(y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gp.mle_+3A_y">y</code></td>
<td>

<p>A vector with non negative integer values.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The probability density function of the generalized Poisson distribution is the following (Nikoloulopoulos &amp; Karlis, 2008):
</p>
<p style="text-align: center;"><code class="reqn">
P(Y=y|\theta, \lambda)=\theta(\theta+\lambda y)^{y-1}\frac{e^{-\theta-\lambda y}}{y!},
\ \ y=0,1... \ \ \theta &gt;0, \ \ 0 \leq \lambda \leq 1.
</code>
</p>

<p>To ensure that <code class="reqn">\theta</code> is positive we use the &quot;log&quot; link and for <code class="reqn">\lambda</code> to lie within 0 and 1
we use the &quot;logit&quot; link within the <code><a href="stats.html#topic+optim">optim</a></code> function.
</p>


<h3>Value</h3>

<p>A vector with three numbers, the <code class="reqn">\theta</code> and <code class="reqn">\lambda</code> parameters and the value of the log-likelihood.
</p>


<h3>Author(s)</h3>

<p>Michail Tsagris.
</p>
<p>R implementation and documentation: Michail Tsagris <a href="mailto:mtsagris@uoc.gr">mtsagris@uoc.gr</a>.
</p>


<h3>References</h3>

<p>Nikoloulopoulos A.K. &amp; Karlis D. (2008). On modeling count data: a comparison of some well-known discrete distributions. Journal of Statistical Computation and Simulation, 78(3): 437&ndash;457.
</p>


<h3>See Also</h3>

<p><code> <a href="#topic+gp.reg">gp.reg</a>, <a href="#topic+rgp">rgp</a>
</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>y &lt;-  rgp(1000, 10, 0.5, method = "Inversion")
gp.mle(y)
</code></pre>

<hr>
<h2 id='gp.reg'>
Generalized Poisson regression
</h2><span id='topic+gp.reg'></span><span id='topic+gp.reg2'></span>

<h3>Description</h3>

<p>Generalized Poisson regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gp.reg(y, x, tol = 1e-7)
gp.reg2(y, x, tol = 1e-7)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gp.reg_+3A_y">y</code></td>
<td>

<p>The response variable, a vector with non negative integer values.
</p>
</td></tr>
<tr><td><code id="gp.reg_+3A_x">x</code></td>
<td>

<p>A data.frame or a matrix with the independent variables.
</p>
</td></tr>
<tr><td><code id="gp.reg_+3A_tol">tol</code></td>
<td>

<p>The tolerance value to terminate the optimization.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The loglikelihood of the generalised Poisson distribution when covariates are present is the following (Consul &amp; Famoye, 1992):
</p>
<p style="text-align: center;"><code class="reqn">
\ell(\beta, \phi)=\sum_{i=1}^n\log(\mu_i) + \sum_{i=1}^n(y_i-1)\log{[\mu_i+(\phi-1)y_i]}-
\log{\phi}\sum_{i=1}^ny_i-\frac{1}{\phi}\sum_{i=1}^n[\mu_i+(\phi-1)y_i]-\sum_{i=1}^n\log{(y_i)},
</code>
</p>

<p>where <code class="reqn">\mu_i=e^{\sum_{j=0}^kX_{ij}\beta_j}</code>, <code class="reqn">n</code> denotes the sample size, <code class="reqn">k</code> is the number of <code class="reqn">\beta</code> coefficients, and <code class="reqn">\phi &gt; 0</code>.
</p>
<p>Breslow (1984) suggested the (moment) estimation of a dispersion parameter by equating the chi-square statistic to its degrees of freedom. For the generalised Poisson regression model, this leads to
<code class="reqn">\sum_{i=1}^n\frac{(y_i-\mu_i)^2}{\mu_i\phi^2}=n-k</code> and we solve this for <code class="reqn">\phi</code>.
</p>
<p>According to Consul and Famoye (1992) we begin by fitting a Poisson regression model and obtain initial values for <code class="reqn">\beta_s</code> and <code class="reqn">\phi</code>. If <code class="reqn">\hat{\phi} \approx 1</code>, it implies that the Poisson regression
model is appropriate and no further estimation needs to be done. However, if <code class="reqn">\hat{\phi} \neq 1</code>, this is used to obtain new values of the estimated <code class="reqn">\beta_s</code> by maximizing the log-likelihood. This process is iterated until we obtain a stable solution.
</p>
<p>The function as seen below returns the log-likelihood of the initial Poisson regression as well. This is useful if one wants to test, via the log-likelihood ratio test as 1 degree of freedom, if the generalized Poisson regression is to be preferred over the Poisson regression.
</p>
<p>gp.reg() estimates the <code class="reqn">beta</code> coefficients using Newton-Raphson, whereas gp.reg2() uses the <code><a href="stats.html#topic+optim">optim</a></code> function. For some reason these two do not always agree. One might yield higher log-likelihood than the other and this is why I offer both ways.
</p>


<h3>Value</h3>

<p>A list including:
</p>
<table>
<tr><td><code>pois.loglik</code></td>
<td>

<p>The initial Poisson regression log-likelihood.
</p>
</td></tr>
<tr><td><code>gp.loglik</code></td>
<td>

<p>The generalized Poisson regression log-likelihood.
</p>
</td></tr>
<tr><td><code>be</code></td>
<td>
<p>The estimated <code class="reqn">beta</code> coefficients.
</p>
</td></tr>
<tr><td><code>phi</code></td>
<td>

<p>The estimated <code class="reqn">\phi</code> parameter.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Michail Tsagris.
</p>
<p>R implementation and documentation: Michail Tsagris <a href="mailto:mtsagris@uoc.gr">mtsagris@uoc.gr</a>.
</p>


<h3>References</h3>

<p>Consul P.C. &amp; Famoye F. (1992). Generalized poisson regression model. Communications in Statistics - Theory and Methods, 21(1): 89&ndash;109.
</p>
<p>Breslow N. E. (1984). Extra-Poisson variation in log-linear models. Journal of the Royal Statistical Society: Series C (Applied Statistics), 33(1): 38&ndash;44.
</p>


<h3>See Also</h3>

<p><code> <a href="#topic+gp.mle">gp.mle</a>
</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n &lt;- 500
x &lt;- matrix (rnorm(n * 2), nrow = n, ncol = 2)
be &lt;- c(1, 1)
mi &lt;- x[, 1] * be[1] + x[, 2] * be[2] + 1
mi &lt;- exp(mi)
y &lt;- numeric(n)
for (i in 1:n)  y[i] &lt;- rgp(2, mi[i], 0.5, method = "Inversion")[1]
gp.reg(y, x)
gp.reg2(y, x)
</code></pre>

<hr>
<h2 id='rgp'>
Random values simulation from the generalized Poisson distribution
</h2><span id='topic+rgp'></span>

<h3>Description</h3>

<p>Random values simulation from the generalized Poisson distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rgp(n, theta, lambda, method)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rgp_+3A_n">n</code></td>
<td>

<p>The number of random values to generate.
</p>
</td></tr>
<tr><td><code id="rgp_+3A_theta">theta</code></td>
<td>

<p>The value of the <code class="reqn">\theta</code> parameter.
</p>
</td></tr>
<tr><td><code id="rgp_+3A_lambda">lambda</code></td>
<td>

<p>The value of the <code class="reqn">\lambda</code> parameter.
</p>
</td></tr>
<tr><td><code id="rgp_+3A_method">method</code></td>
<td>

<p>The simulation method to use. The available options are:
&quot;Inversion&quot;, &quot;Branching&quot;, &quot;Normal-Approximation&quot;, &quot;Build-Up&quot; and &quot;Chop-Down&quot;.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The values <code class="reqn">\theta</code> and <code class="reqn">\lambda</code> affect the method of simulation to use.
See Li et al. (2020) for more information.
</p>


<h3>Value</h3>

<p>A vector with values from the generalized Poisson distribution.
</p>


<h3>Author(s)</h3>

<p>Michail Tsagris.
</p>
<p>R implementation and documentation: Michail Tsagris <a href="mailto:mtsagris@uoc.gr">mtsagris@uoc.gr</a>.
</p>


<h3>References</h3>

<p>Li H., Demirtas H. &amp; Chen R. (2020). RNGforGPD: An R Package for Generation of Univariate and Multivariate Generalized Poisson Data. R JOURNAL, 12(2): 173&ndash;188.
</p>
<p>Demirtas H. (2017). On accurate and precise generation of generalized Poisson variates. Communications in Statistics - Simulation and Computation, 46(1): 489&ndash;499.
</p>


<h3>See Also</h3>

<p><code> <a href="#topic+gp.mle">gp.mle</a>
</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>y &lt;-  rgp(1000, 10, 0.5, method = "Inversion")
gp.mle(y)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
