<!DOCTYPE html><html lang="en"><head><title>Help for package MDEI</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MDEI}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#MDEI-package'><p>MDEI</p></a></li>
<li><a href='#coverPlot'><p>Coverage Plot for MDEI Object</p></a></li>
<li><a href='#MDEI'><p>MDEI function</p></a></li>
<li><a href='#summary.MDEI'><p>Summary of an MDEI Object</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Implementing the Method of Direct Estimation and Inference</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-05-03</td>
</tr>
<tr>
<td>Description:</td>
<td>Causal and statistical inference on an arbitrary treatment
    effect curve requires care in both estimation and inference.  This
    package, implements the Method of Direct Estimation and Inference as introduced in "Estimation and Inference on Nonlinear and Heterogeneous Effects" by Ratkovic and Tingley (2023) &lt;<a href="https://doi.org/10.1086%2F723811">doi:10.1086/723811</a>&gt;.  The method takes an outcome, variable of theoretical interest
    (treatment), and set of variables and then returns a partial
    derivative (marginal effect) of the treatment variable at each point
    along with uncertainty intervals. The approach offers two advances.
    First, a split-sample approach is used as a guard against over-fitting.
    Second, the method uses a data-driven interval derived from conformal
    inference, rather than relying on a normality assumption on the error
    terms.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>grDevices, MASS, ranger, Rcpp (&ge; 1.0.6), splines2</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-05-03 13:37:22 UTC; ratkovic</td>
</tr>
<tr>
<td>Author:</td>
<td>Marc Ratkovic [aut, cre],
  Dustin Tingley [ctb],
  Nithin Kavi [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Marc Ratkovic &lt;ratkovic@princeton.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-05-04 08:30:11 UTC</td>
</tr>
</table>
<hr>
<h2 id='MDEI-package'>MDEI</h2><span id='topic+MDEI-package'></span>

<h3>Description</h3>

<p>MDEI estimates  effects.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Marc Ratkovic <a href="mailto:ratkovic@princeton.edu">ratkovic@princeton.edu</a>
</p>
<p>Authors:
</p>

<ul>
<li><p> Nithin Kavi <a href="mailto:nithinkavi@college.harvard.edu">nithinkavi@college.harvard.edu</a>
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Dustin Tingley <a href="mailto:dtingley@gov.harvard.edu">dtingley@gov.harvard.edu</a> [contributor]
</p>
</li></ul>


<hr>
<h2 id='coverPlot'>Coverage Plot for MDEI Object</h2><span id='topic+coverPlot'></span>

<h3>Description</h3>

<p>Coverage Plot for MDEI Object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coverPlot(
  object,
  xvar = "treat",
  sigval = 0,
  target = "tau",
  colors = c(gray(0.7), gray(0)),
  cex.point = 0.5,
  xlabel = "",
  ylabel = "",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coverPlot_+3A_object">object</code></td>
<td>
<p>An object of class MDEI.</p>
</td></tr>
<tr><td><code id="coverPlot_+3A_xvar">xvar</code></td>
<td>
<p>The variable to plot along the x-axis.  May be 'treat' for the treatment
variable, the name of a column in the covariate matrix in the <code>obj</code>, or a numeric vector,
the length of the data.   Default is <code>"treat"</code>.</p>
</td></tr>
<tr><td><code id="coverPlot_+3A_sigval">sigval</code></td>
<td>
<p>The value to see if it is covered by the conformal interval. Either a single value or a vector.   Default is <code>0</code>.</p>
</td></tr>
<tr><td><code id="coverPlot_+3A_target">target</code></td>
<td>
<p>Either tau' or 'theta'.  The first, 'tau', is the marginal effect at each point, while the second
'theta', is the portion of the conditional mean of the outcome that is a function of the treatment and the outcome.</p>
</td></tr>
<tr><td><code id="coverPlot_+3A_colors">colors</code></td>
<td>
<p>A vector with two elements.  The first is the color of the confidence interval at points
where the conformal interval does not contain <code>sigval</code>, the second the color where it does.   Default is <code>c(gray(.7), gray(0))</code>.</p>
</td></tr>
<tr><td><code id="coverPlot_+3A_cex.point">cex.point</code></td>
<td>
<p>The size of the points in the figure.  Default is <code>0.5</code>.</p>
</td></tr>
<tr><td><code id="coverPlot_+3A_xlabel">xlabel</code></td>
<td>
<p>Label for x-axis of figure.  Default is <code>""</code>.</p>
</td></tr>
<tr><td><code id="coverPlot_+3A_ylabel">ylabel</code></td>
<td>
<p>Label for y-axis of figure.  Default is <code>""</code>.</p>
</td></tr>
<tr><td><code id="coverPlot_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to <code>plot</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value.
</p>

<hr>
<h2 id='MDEI'>MDEI function</h2><span id='topic+MDEI'></span>

<h3>Description</h3>

<p>Implements the Method of Direct Estimation and Inference
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MDEI(
  y,
  treat,
  X,
  splits = 10,
  alpha = 0.9,
  samplesplit = TRUE,
  conformal = TRUE,
  nthreads.ranger = NULL,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MDEI_+3A_y">y</code></td>
<td>
<p>The outcome variable, a vector.</p>
</td></tr>
<tr><td><code id="MDEI_+3A_treat">treat</code></td>
<td>
<p>The treatment variable, a vector.</p>
</td></tr>
<tr><td><code id="MDEI_+3A_x">X</code></td>
<td>
<p>A matrix of covariates.</p>
</td></tr>
<tr><td><code id="MDEI_+3A_splits">splits</code></td>
<td>
<p>Number of repeated cross-fitting steps to implement.</p>
</td></tr>
<tr><td><code id="MDEI_+3A_alpha">alpha</code></td>
<td>
<p>The desired level of the confidence band.</p>
</td></tr>
<tr><td><code id="MDEI_+3A_samplesplit">samplesplit</code></td>
<td>
<p>Whether to use a sample splitting approach. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="MDEI_+3A_conformal">conformal</code></td>
<td>
<p>Whether to generate a conformal bands or use a critical value from the
normal approximation.  Default is <code>TRUE</code>..</p>
</td></tr>
<tr><td><code id="MDEI_+3A_nthreads.ranger">nthreads.ranger</code></td>
<td>
<p>Number of threads used internally by the <code>ranger</code> function 
for random forests.  Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="MDEI_+3A_verbose">verbose</code></td>
<td>
<p>An optional logical value. If <code>TRUE</code> information 
on the number of split samples completed is printed. Default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>


<dl>
<dt>tau.est</dt><dd><p>The estimated marginal effect.</p>
</dd>
<dt>CIs.tau</dt><dd><p>Upper and lower values of conformal confidence band.</p>
</dd>
<dt>critical.values</dt><dd><p>Conformal critical values.</p>
</dd>
<dt>Ey.x</dt><dd><p>Mean of outcome given only covariates.</p>
</dd>
<dt>coefficients</dt><dd><p>The list of all nonparametric bases and the proportion of sample splits that they were selected.</p>
</dd>
<dt>internal</dt><dd><p>Internal objects used for development and diagnostics.</p>
</dd>
</dl>



<h3>References</h3>

<p>Ratkovic, Marc and Dustin Tingley.  2023. &quot;Estimation and Inference on Nonlinear and Heterogeneous Effects.&quot;  The Journal of Politics.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n &lt;- 100

X &lt;- matrix(rnorm(n*1), nrow = n)
treat &lt;- rnorm(n)
y &lt;- treat^2 + X[,1] + rnorm(n)

# Be sure to run with more splits than this.  We recommend
# at least 10-50 initially, for exploratory analyses, with several hundred for 
# publication quality. For large sample sizes, these numbers may be adjusted down.
# These are only recommendations.
# Threads are set to 1 to pass CRAN checks, but we suggest leaving it at the default
# which ranger takse as the total number available.
set.seed(1)
m1 &lt;- MDEI(y, treat, X, splits=1, alpha=.9, nthreads.ranger = 1)

# Accuracy
cor(m1$tau.est, treat*2)
cor(m1$theta.est, treat^2)

# Coverage
mean(apply(m1$CIs.tau-2*treat,1,prod)&lt;0)
</code></pre>

<hr>
<h2 id='summary.MDEI'>Summary of an MDEI Object</h2><span id='topic+summary.MDEI'></span>

<h3>Description</h3>

<p>Summary of an object of class MDEI.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'MDEI'
summary(object, features = 10, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.MDEI_+3A_object">object</code></td>
<td>
<p>An object of class MDEI.</p>
</td></tr>
<tr><td><code id="summary.MDEI_+3A_features">features</code></td>
<td>
<p>Number of spline bases to include.</p>
</td></tr>
<tr><td><code id="summary.MDEI_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to <code>plot</code>.</p>
</td></tr>
</table>


<h3>Value</h3>


<dl>
<dt>coeftable</dt><dd><p>A table with three columns: the names of selected spline interactions, the average coefficient, and
proportion of time it was included in the model. Averages over taken over subsamples in the
split sample strategy.Note that the coefficients are interactions between
spline interactions that can be accessed through <code>obj$internal$Xmat.spline</code>.</p>
</dd>
</dl>


</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
