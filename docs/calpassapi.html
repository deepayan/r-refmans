<!DOCTYPE html><html lang="en"><head><title>Help for package calpassapi</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {calpassapi}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#calpass_create_isk'><p>Create interSegmentKey's for students</p></a></li>
<li><a href='#calpass_get_token'><p>Obtain CalPASS API token</p></a></li>
<li><a href='#calpass_query'><p>Query data from CalPASS API endpoints</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>R Interface to Access CalPASS API</td>
</tr>
<tr>
<td>Version:</td>
<td>0.0.3</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements methods for querying data from CalPASS using its API.
 CalPASS Plus.  MMAP API V1. <a href="https://mmap.calpassplus.org/docs/index.html">https://mmap.calpassplus.org/docs/index.html</a>.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>httr, dplyr, digest, jsonlite, stringr</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/vinhdizzo/calpassapi">https://github.com/vinhdizzo/calpassapi</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/vinhdizzo/calpassapi/issues">https://github.com/vinhdizzo/calpassapi/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.0</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-08-06 15:17:15 UTC; vnguyen216</td>
</tr>
<tr>
<td>Author:</td>
<td>Vinh Nguyen [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Vinh Nguyen &lt;nguyenvq714@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-08-06 15:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='calpass_create_isk'>Create interSegmentKey's for students</h2><span id='topic+calpass_create_isk'></span>

<h3>Description</h3>

<p>Create interSegmentKey's from students' first names, last names, genders, and birthdates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calpass_create_isk(first_name, last_name, gender, birthdate)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calpass_create_isk_+3A_first_name">first_name</code></td>
<td>
<p>a character vector of students' first names.</p>
</td></tr>
<tr><td><code id="calpass_create_isk_+3A_last_name">last_name</code></td>
<td>
<p>a character vector of students' last names.</p>
</td></tr>
<tr><td><code id="calpass_create_isk_+3A_gender">gender</code></td>
<td>
<p>a character vector of students' genders.  The first character will be used (uppercase'd automatically), and should take on values <code>'M'</code>, <code>'F'</code>, or <code>'X'</code> (use <code>'X'</code> for unknown or did not disclosed).</p>
</td></tr>
<tr><td><code id="calpass_create_isk_+3A_birthdate">birthdate</code></td>
<td>
<p>a character or numeric vector of birthdates of the form <code>'yyyymmdd'</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of interSegmentKey's
</p>


<h3>Author(s)</h3>

<p>Vinh Nguyen
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## single
calpass_create_isk(first_name='Jane', last_name='Doe'
 , gender='F', birthdate=20001231)
## data frame
## Not run: 
firstname &lt;- c('Tom', 'Jane', 'Jo')
lastname &lt;- c('Ng', 'Doe', 'Smith')
gender &lt;- c('Male', 'Female', 'X')
birthdate &lt;- c(2001231, 19990101, 19981111)
df &lt;- data.frame(firstname, lastname
  , gender, birthdate, stringsAsFactors=FALSE)
library(dplyr)
df %&gt;%
  mutate(isk=calpass_create_isk(first_name=firstname
    , last_name=lastname
    , gender=gender
    , birthdate
  ))

## End(Not run)
</code></pre>

<hr>
<h2 id='calpass_get_token'>Obtain CalPASS API token</h2><span id='topic+calpass_get_token'></span>

<h3>Description</h3>

<p>Obtain a token from CalPASS using your API credentials, which should allow access for 60 minutes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calpass_get_token(
  username = Sys.getenv("cp_api_uid"),
  password = Sys.getenv("cp_api_pwd"),
  client_id,
  scope,
  auth_endpoint = "https://oauth.calpassplus.org/connect/token",
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calpass_get_token_+3A_username">username</code></td>
<td>
<p>API username.  For security reasons, the user could specify <code>cp_api_uid</code> in the user's <code>.Renviron</code> file in the user's home directory (execute <code>Sys.getenv('HOME')</code> in R to check path to home directory).  That way, the user does not have to hard code the username in their R script.  The function uses for the username here by default.</p>
</td></tr>
<tr><td><code id="calpass_get_token_+3A_password">password</code></td>
<td>
<p>API password.  The user could specify <code>cp_api_pwd</code> as above.</p>
</td></tr>
<tr><td><code id="calpass_get_token_+3A_client_id">client_id</code></td>
<td>
<p>parameter needed in the http body in order to obtain a token (unique to <code>username</code>)</p>
</td></tr>
<tr><td><code id="calpass_get_token_+3A_scope">scope</code></td>
<td>
<p>parameter needed in the http body in order to obtain a token (unique to <code>username</code>)</p>
</td></tr>
<tr><td><code id="calpass_get_token_+3A_auth_endpoint">auth_endpoint</code></td>
<td>
<p>Authentication endpoint/url, defaults to <code>'https://oauth.calpassplus.org/connect/token'</code>.</p>
</td></tr>
<tr><td><code id="calpass_get_token_+3A_verbose">verbose</code></td>
<td>
<p>If <code>TRUE</code>, then print http exchanges (to assist with debugging).  Defaults to <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>CalPASS token string
</p>


<h3>Author(s)</h3>

<p>Vinh Nguyen
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
cp_token &lt;- calpass_get_token(username='my_cp_api_uid', password='my_cp_api_pwd'
  , client_id='my_client_id'
  , scope='my_scope'
  )

## End(Not run)
</code></pre>

<hr>
<h2 id='calpass_query'>Query data from CalPASS API endpoints</h2><span id='topic+calpass_query'></span><span id='topic+calpass_query_many'></span>

<h3>Description</h3>

<p>Query data from CalPASS API endpoints for a single interSegmentKey
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calpass_query(
  interSegmentKey,
  token,
  api_url = "https://mmap.calpassplus.org/api",
  endpoint = c("transcript", "placement"),
  verbose = FALSE
)

calpass_query_many(
  interSegmentKey,
  token,
  api_url = "https://mmap.calpassplus.org/api",
  endpoint = c("transcript", "placement"),
  verbose = FALSE,
  api_call_limit = 3200,
  limit_per_n_sec = 3600,
  wait = FALSE,
  token_username,
  token_password,
  token_client_id,
  token_scope
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calpass_query_+3A_intersegmentkey">interSegmentKey</code></td>
<td>
<p>for <code>calpass_query</code>, a single interSegmentKey; for <code>calpass_query_many</code>, a vector of interSgementKey's.  The interSegmentKey's can be created from <a href="#topic+calpass_create_isk">calpass_create_isk</a>.</p>
</td></tr>
<tr><td><code id="calpass_query_+3A_token">token</code></td>
<td>
<p>(optional) a token object created from <a href="#topic+calpass_get_token">calpass_get_token</a>.  If this is not specified, then <code>token_username</code>, <code>token_password</code>, <code>token_client_id</code>, and <code>token_scope</code> should be specified.  The credentials approach is preferred for long runs to obtain refreshed tokens (tokens currently are valid for 1 hour).</p>
</td></tr>
<tr><td><code id="calpass_query_+3A_api_url">api_url</code></td>
<td>
<p>defaults to <code>'https://mmap.calpassplus.org/api'</code>, but can be overrode if CalPASS changes the url.</p>
</td></tr>
<tr><td><code id="calpass_query_+3A_endpoint">endpoint</code></td>
<td>
<p>the api endpoint to use; defaults to <code>'transcript'</code>.</p>
</td></tr>
<tr><td><code id="calpass_query_+3A_verbose">verbose</code></td>
<td>
<p>If <code>TRUE</code>, then print http exchanges (to assist with debugging).  Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="calpass_query_+3A_api_call_limit">api_call_limit</code></td>
<td>
<p>the number of api calls allowed per <code>limit_per_n_sec</code>; defaults to 150 calls per 60 seconds.</p>
</td></tr>
<tr><td><code id="calpass_query_+3A_limit_per_n_sec">limit_per_n_sec</code></td>
<td>
<p>time frame where <code>api_call_limit</code> is applicable to; defaults to 60 seconds.</p>
</td></tr>
<tr><td><code id="calpass_query_+3A_wait">wait</code></td>
<td>
<p>indicates whether the user is willing to wait <code>limit_per_n_sec</code> seconds per batch if the number of unique values in <code>interSegmentKey</code> is greater than <code>api_call_limit</code>; defaults to <code>FALSE</code>.  The user should set to <code>TRUE</code> if there are more than <code>api_call_limit</code> number of calls to be executed.</p>
</td></tr>
<tr><td><code id="calpass_query_+3A_token_username">token_username</code></td>
<td>
<p>(optional, required if <code>token</code> is not specified) username passed to <a href="#topic+calpass_get_token">calpass_get_token</a>.</p>
</td></tr>
<tr><td><code id="calpass_query_+3A_token_password">token_password</code></td>
<td>
<p>(optional, required if <code>token</code> is not specified) password passed to <a href="#topic+calpass_get_token">calpass_get_token</a>.</p>
</td></tr>
<tr><td><code id="calpass_query_+3A_token_client_id">token_client_id</code></td>
<td>
<p>(optional, required if <code>token</code> is not specified) client_id passed to <a href="#topic+calpass_get_token">calpass_get_token</a>.</p>
</td></tr>
<tr><td><code id="calpass_query_+3A_token_scope">token_scope</code></td>
<td>
<p>(optional, required if <code>token</code> is not specified) scope passed to <a href="#topic+calpass_get_token">calpass_get_token</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data frame with columns <code>interSegmentKey</code>, <code>status_code</code> (the http response code: 200 means student was found, 204 means student was not found, 429 means the api limit was reached and student was not processed, and anything else in the 400's correspond to http errors.)
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>calpass_query_many</code>: Query data from CalPASS API endpoints with a vector of interSegmentKey's.  The number of rows returned corresponds to the number of unique interSegmentKey's.
</p>
</li></ul>


<h3>Author(s)</h3>

<p>Vinh Nguyen
</p>


<h3>References</h3>

<p><a href="https://mmap.calpassplus.org/docs/index.html">MMAP API V1</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## get access token
cp_token &lt;- calpass_get_token(username='my_cp_api_uid', password='my_cp_api_pwd')

## single run
isk &lt;- calpass_create_isk(first_name='Jane', last_name='Doe'
  , gender='F', birthdate=20001231)
calpass_query(interSegmentKey=isk
  , token=cp_token, endpoint='transcript')
calpass_query(interSegmentKey=isk
  , token=cp_token, endpoint='placement')

## multiple
firstname &lt;- c('Tom', 'Jane', 'Jo')
lastname &lt;- c('Ng', 'Doe', 'Smith')
gender &lt;- c('Male', 'Female', 'X')
birthdate &lt;- c(20001231, 19990101, 19981111)
df &lt;- data.frame(firstname, lastname
  , gender, birthdate, stringsAsFactors=FALSE)
library(dplyr)
df %&gt;%
  mutate(isk=calpass_create_isk(first_name=firstname
    , last_name=lastname
    , gender=gender
    , birthdate
  )) 
dfResults &lt;- calpass_query_many(interSegmentKey=df$isk
  , token=cp_token
  , endpoint='transcript'
)

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
