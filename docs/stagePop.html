<!DOCTYPE html><html><head><title>Help for package stagePop</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {stagePop}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#checkSolution'><p>checkSolution</p></a></li>
<li><a href='#deathFuncDefault'><p>Death Rate Function</p></a></li>
<li><a href='#defaultRateFunctions'><p>defaultRateFunctions</p></a></li>
<li><a href='#derivDede'><p>derivDede</p></a></li>
<li><a href='#derivPBS'><p>derivPBS</p></a></li>
<li><a href='#develFuncDefault'><p>Development Function</p></a></li>
<li><a href='#durationFuncDefault'><p>Life stage duration function</p></a></li>
<li><a href='#emigrationFuncDefault'><p>Emigration Function</p></a></li>
<li><a href='#genericPlot'><p>Generic Plotting Function</p></a></li>
<li><a href='#immigrationFuncDefault'><p>Immigration Function</p></a></li>
<li><a href='#popModel'><p>popModel</p></a></li>
<li><a href='#rateFuncCheck'><p>rateFunCheck</p></a></li>
<li><a href='#RateFunctions'><p>Rate Functions</p></a></li>
<li><a href='#reproFuncDefault'><p>Reproduction Function</p></a></li>
<li><a href='#runStagePopExample'><p>runStagePopExample</p></a></li>
<li><a href='#SolverOptions'><p>SolverOptions</p></a></li>
<li><a href='#stagePop-package'><p>Stage-Structured Population modelling</p></a></li>
<li><a href='#sumStrains'><p>sumStrains</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Modelling the Population Dynamics of a Stage-Structured Species
in Continuous Time</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1-2</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-05-05</td>
</tr>
<tr>
<td>Author:</td>
<td>Helen Kettle</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>David Nutter &lt;david.nutter@bioss.ac.uk&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides facilities to implement and run population models of
    stage-structured species...</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/HelenKettle/StagePop">https://github.com/HelenKettle/StagePop</a></td>
</tr>
<tr>
<td>Suggests:</td>
<td>R.rsp</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>R.rsp</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> | file LICENSE</td>
</tr>
<tr>
<td>Imports:</td>
<td>deSolve,PBSddesolve, grDevices, graphics</td>
</tr>
<tr>
<td>Collate:</td>
<td>'SolverOptions.R' 'addNamesToList.R' 'checkICs.R'
'checkSolution.R' 'deathFunction.R' 'emigrationFunction.R'
'developmentFunction.R' 'immigrationFunction.R'
'durationFunction.R' 'reproductionFunction.R'
'defaultRateFunctions.R' 'derivDede.R' 'derivPBS.R'
'genericPlot.R' 'initConditions.R' 'namingVariables.R'
'plotStrains.R' 'popModel.R' 'rateFuncCheck.R' 'rateFunction.R'
'runStagePopExample.R' 'stagePop-package.R' 'sumStrains.R'
'vecDivideFunc.R' 'vecToMatList.R'</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-05-10 12:19:53 UTC; helen</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-05-10 13:50:02 UTC</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
</table>
<hr>
<h2 id='checkSolution'>checkSolution</h2><span id='topic+checkSolution'></span>

<h3>Description</h3>

<p>Check whether any of the state variables are significantly negative and emit suitable warnings.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>checkSolution(output, numSpecies, numStages, numStrains, ntol)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="checkSolution_+3A_output">output</code></td>
<td>
<p>Model output from <code><a href="#topic+popModel">popModel</a></code></p>
</td></tr>
<tr><td><code id="checkSolution_+3A_numspecies">numSpecies</code></td>
<td>
<p>Number of species</p>
</td></tr>
<tr><td><code id="checkSolution_+3A_numstages">numStages</code></td>
<td>
<p>Number of life stages</p>
</td></tr>
<tr><td><code id="checkSolution_+3A_numstrains">numStrains</code></td>
<td>
<p>Number of strains for each species</p>
</td></tr>
<tr><td><code id="checkSolution_+3A_ntol">ntol</code></td>
<td>
<p>Negative tolerance value (i.e. a warning is produced if variable&lt;-(ntol*max(variable))). The larger ntol is, the larger the negative values that are tolerated.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing if there are no problems with the output, otherwise warnings are generated
</p>


<h3>See Also</h3>

<p><code><a href="#topic+popModel">popModel</a></code>
</p>

<hr>
<h2 id='deathFuncDefault'>Death Rate Function</h2><span id='topic+deathFuncDefault'></span><span id='topic+deathFunc'></span><span id='topic+deathFunction'></span>

<h3>Description</h3>

<p>Return the per capita rate of death (per unit time)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>deathFuncDefault(stage, x, time, species, strain)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="deathFuncDefault_+3A_stage">stage</code></td>
<td>
<p>(integer). The numbered life stage for which to return a death rate.</p>
</td></tr>
<tr><td><code id="deathFuncDefault_+3A_x">x</code></td>
<td>
<p>Vector of state variables within the DDE solver. To access a variable use:
x$speciesName['stageName',strainNumber]
e.g. for species 'Bacteria', stage 'reproductive', strain 2 use
x$Bacteria['reproductive',2]
If there is only one stage and strain in species 'Food', for example, use
x$Food[1,1]</p>
</td></tr>
<tr><td><code id="deathFuncDefault_+3A_time">time</code></td>
<td>
<p>(scalar). The current time point in the DDE solver.</p>
</td></tr>
<tr><td><code id="deathFuncDefault_+3A_species">species</code></td>
<td>
<p>(integer). The numbered species for which to return a death rate.</p>
</td></tr>
<tr><td><code id="deathFuncDefault_+3A_strain">strain</code></td>
<td>
<p>(integer). The numbered strain for which to return a death rate.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>per capita death rate (units of inverse time) for the strain, stage,species and time specified.
</p>

<hr>
<h2 id='defaultRateFunctions'>defaultRateFunctions</h2><span id='topic+defaultRateFunctions'></span>

<h3>Description</h3>

<p>These default implementations will simply generate errors when
run. To create implementations, please see the documentation linked
to below.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>defaultRateFunctions
</code></pre>


<h3>Format</h3>

<p>An object of class <code>list</code> of length 6.
</p>


<h3>Details</h3>

<p>The list should contain the following names, each mapped to a function of the correct signature.
</p>

<ul>
<li> <p><code>reproFunc</code>
</p>
</li>
<li> <p><code>deathFunc</code>
</p>
</li>
<li> <p><code>durationFunc</code>
</p>
</li>
<li> <p><code>immigrationFunc</code>
</p>
</li>
<li> <p><code>develFunc</code>. Note that by defaul develFunc is NULL as it is not required for all simulation types
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+RateFunctions">RateFunctions</a></code>
</p>

<hr>
<h2 id='derivDede'>derivDede</h2><span id='topic+derivDede'></span>

<h3>Description</h3>

<p>Internal-use function which allows use of the DeSolve ODE solver. Called by <code><a href="#topic+popModel">popModel</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>derivDede(t, y, parms)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="derivDede_+3A_t">t</code></td>
<td>
<p>Time step</p>
</td></tr>
<tr><td><code id="derivDede_+3A_y">y</code></td>
<td>
<p>state variables</p>
</td></tr>
<tr><td><code id="derivDede_+3A_parms">parms</code></td>
<td>
<p>Additional parameters passed in from the original invoker of the solver</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the new model state.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+derivPBS">derivPBS</a></code>
</p>

<hr>
<h2 id='derivPBS'>derivPBS</h2><span id='topic+derivPBS'></span>

<h3>Description</h3>

<p>Internal-use function which allows use of the PBSddesolv ODE
solver. <code><a href="#topic+popModel">popModel</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>derivPBS(t, y, parms)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="derivPBS_+3A_t">t</code></td>
<td>
<p>Time step</p>
</td></tr>
<tr><td><code id="derivPBS_+3A_y">y</code></td>
<td>
<p>state variables</p>
</td></tr>
<tr><td><code id="derivPBS_+3A_parms">parms</code></td>
<td>
<p>Additional parameters passed in from the original invoker of the solver</p>
</td></tr>
</table>


<h3>Details</h3>

<p>note PBS does not allow lagged variables to be computed at the
current timestep (hence the changes from the dede deriv function)
</p>


<h3>Value</h3>

<p>the new model state.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+derivDede">derivDede</a></code>
</p>

<hr>
<h2 id='develFuncDefault'>Development Function</h2><span id='topic+develFuncDefault'></span><span id='topic+develFunc'></span><span id='topic+developmentFunction'></span>

<h3>Description</h3>

<p>Return the rate of development (per unit time)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>develFuncDefault(stage, x, time, species, strain)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="develFuncDefault_+3A_stage">stage</code></td>
<td>
<p>(integer). The numbered life stage for which to return a developement rate.</p>
</td></tr>
<tr><td><code id="develFuncDefault_+3A_x">x</code></td>
<td>
<p>Vector of state variables within the DDE solver. To access a variable use:
x$speciesName['stageName',strainNumber]
e.g. for species 'Bacteria', stage 'reproductive', strain 2 use
x$Bacteria['reproductive',2]
If there is only one stage and strain in species 'Food', for example, use
x$Food[1,1]</p>
</td></tr>
<tr><td><code id="develFuncDefault_+3A_time">time</code></td>
<td>
<p>(scalar). The current time point in the DDE solver.</p>
</td></tr>
<tr><td><code id="develFuncDefault_+3A_species">species</code></td>
<td>
<p>(integer). The numbered species for which to return a development rate.</p>
</td></tr>
<tr><td><code id="develFuncDefault_+3A_strain">strain</code></td>
<td>
<p>(integer). The numbered strain for which to return a developement rate.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function will only be called
when the <code>timeDependDuration</code> argument to
<code><a href="#topic+popModel">popModel</a></code> contains TRUE values, otherwise the
development rate within a stage is irrelevant to the model.
</p>


<h3>Value</h3>

<p>Development rate (units of inverse time) for the strain, stage, species and time specified.
</p>

<hr>
<h2 id='durationFuncDefault'>Life stage duration function</h2><span id='topic+durationFuncDefault'></span><span id='topic+durationFunc'></span><span id='topic+durationFunction'></span>

<h3>Description</h3>

<p>Return the duration of the life stages (time units).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>durationFuncDefault(stage, x, time, species, strain)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="durationFuncDefault_+3A_stage">stage</code></td>
<td>
<p>(integer). The numbered life stage for which to return a duration</p>
</td></tr>
<tr><td><code id="durationFuncDefault_+3A_x">x</code></td>
<td>
<p>Vector of state variables within the DDE solver. To access a particular variable use:
x$speciesName['stageName',strainNumber]
e.g. for species 'Bacteria', stage 'reproductive', strain 2 use
x$Bacteria['reproductive',2]
If there is only one stage and strain in species 'Food', for example, use
x$Food[1,1]</p>
</td></tr>
<tr><td><code id="durationFuncDefault_+3A_time">time</code></td>
<td>
<p>(scalar). The current time point in the DDE solver.</p>
</td></tr>
<tr><td><code id="durationFuncDefault_+3A_species">species</code></td>
<td>
<p>(integer). The numbered species for which to return a life stage duration.</p>
</td></tr>
<tr><td><code id="durationFuncDefault_+3A_strain">strain</code></td>
<td>
<p>(integer). The numbered strain for which to return a life stage duration.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Duration of the life stage for the stage, species, strain and time specified.
</p>

<hr>
<h2 id='emigrationFuncDefault'>Emigration Function</h2><span id='topic+emigrationFuncDefault'></span><span id='topic+EmigrationFunc'></span><span id='topic+EmigrationFunction'></span><span id='topic+emigrationFunction'></span>

<h3>Description</h3>

<p>Return the per capita rate of Emigration (per unit time)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>emigrationFuncDefault(stage, x, time, species, strain)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="emigrationFuncDefault_+3A_stage">stage</code></td>
<td>
<p>(integer). The numbered life stage for which to return an emigration rate.</p>
</td></tr>
<tr><td><code id="emigrationFuncDefault_+3A_x">x</code></td>
<td>
<p>Vector of state variables within the DDE solver. To access a variable use:
x$speciesName['stageName',strainNumber]
e.g. for species 'Bacteria', stage 'reproductive', strain 2 use
x$Bacteria['reproductive',2]
If there is only one stage and strain in species 'Food', for example, use
x$Food[1,1]</p>
</td></tr>
<tr><td><code id="emigrationFuncDefault_+3A_time">time</code></td>
<td>
<p>(scalar). The current time point in the DDE solver.</p>
</td></tr>
<tr><td><code id="emigrationFuncDefault_+3A_species">species</code></td>
<td>
<p>(integer). The numbered species for which to return an emigration rate.</p>
</td></tr>
<tr><td><code id="emigrationFuncDefault_+3A_strain">strain</code></td>
<td>
<p>(integer). The numbered strain for which to return an emigration rate.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Emigration rate (per capita) for the strain, stage, species and time specified.
</p>

<hr>
<h2 id='genericPlot'>Generic Plotting Function</h2><span id='topic+genericPlot'></span>

<h3>Description</h3>

<p>Plot the state variables over time (sums over all strains if there are multiple strains in a species)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>genericPlot(
  output,
  numSpecies,
  numStages,
  speciesNames,
  stageNames,
  saveFig = FALSE,
  figType = "eps",
  figName = "stagePopFig"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="genericPlot_+3A_output">output</code></td>
<td>
<p>Model output, from <code><a href="#topic+popModel">popModel</a></code></p>
</td></tr>
<tr><td><code id="genericPlot_+3A_numspecies">numSpecies</code></td>
<td>
<p>Number of species in the model</p>
</td></tr>
<tr><td><code id="genericPlot_+3A_numstages">numStages</code></td>
<td>
<p>Number of life stages</p>
</td></tr>
<tr><td><code id="genericPlot_+3A_speciesnames">speciesNames</code></td>
<td>
<p>species names (vector of strings). Default is NULL.</p>
</td></tr>
<tr><td><code id="genericPlot_+3A_stagenames">stageNames</code></td>
<td>
<p>stage names (a list of vectors if there is more than one species).</p>
</td></tr>
<tr><td><code id="genericPlot_+3A_savefig">saveFig</code></td>
<td>
<p>Choose to save the figure (TRUE or FALSE). Default is FALSE.</p>
</td></tr>
<tr><td><code id="genericPlot_+3A_figtype">figType</code></td>
<td>
<p>Figure format can be 'eps', 'tiff' or 'png'. Default is 'eps'</p>
</td></tr>
<tr><td><code id="genericPlot_+3A_figname">figName</code></td>
<td>
<p>filepath to save figure to. Default is 'stagePopFig'</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+popModel">popModel</a></code>
</p>

<hr>
<h2 id='immigrationFuncDefault'>Immigration Function</h2><span id='topic+immigrationFuncDefault'></span><span id='topic+immigrationFunc'></span><span id='topic+immigrationFunction'></span>

<h3>Description</h3>

<p>Return the rate of immigration (amount per unit time)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>immigrationFuncDefault(stage, x, time, species, strain)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="immigrationFuncDefault_+3A_stage">stage</code></td>
<td>
<p>(integer). The numbered life stage for which to return an immigration rate.</p>
</td></tr>
<tr><td><code id="immigrationFuncDefault_+3A_x">x</code></td>
<td>
<p>Vector of state variables within the DDE solver. To access a variable use:
x$speciesName['stageName',strainNumber]
e.g. for species 'Bacteria', stage 'reproductive', strain 2 use
x$Bacteria['reproductive',2]
If there is only one stage and strain in species 'Food', for example, use
x$Food[1,1]</p>
</td></tr>
<tr><td><code id="immigrationFuncDefault_+3A_time">time</code></td>
<td>
<p>(scalar). The current time point in the DDE solver.</p>
</td></tr>
<tr><td><code id="immigrationFuncDefault_+3A_species">species</code></td>
<td>
<p>(integer). The numbered species for which to return an immigration rate.</p>
</td></tr>
<tr><td><code id="immigrationFuncDefault_+3A_strain">strain</code></td>
<td>
<p>(integer). The numbered strain for which to return an immigration rate.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Immigration rate (amount per unit time) for the strain, stage, species and time specified.
</p>

<hr>
<h2 id='popModel'>popModel</h2><span id='topic+popModel'></span>

<h3>Description</h3>

<p>Run the core model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>popModel(
  numSpecies,
  numStages,
  numStrains = rep(1, numSpecies),
  timeVec,
  speciesNames,
  stageNames,
  rateFunctions = defaultRateFunctions,
  ICs,
  timeDependLoss = rep(TRUE, numSpecies),
  timeDependDuration = rep(FALSE, numSpecies),
  solverOptions = list(),
  checkForNegs = TRUE,
  ntol = 0.01,
  plotFigs = TRUE,
  saveFig = FALSE,
  figType = "eps",
  figName = "stagePopFig",
  sumOverStrains = TRUE,
  plotStrainsFig = TRUE,
  saveStrainsFig = FALSE,
  strainsFigType = "eps",
  strainsFigName = "strainFig"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="popModel_+3A_numspecies">numSpecies</code></td>
<td>
<p>Number of species (integer)</p>
</td></tr>
<tr><td><code id="popModel_+3A_numstages">numStages</code></td>
<td>
<p>Number of life-stages in each species (vector)</p>
</td></tr>
<tr><td><code id="popModel_+3A_numstrains">numStrains</code></td>
<td>
<p>Number of strains in each species (vector). Default is 1.</p>
</td></tr>
<tr><td><code id="popModel_+3A_timevec">timeVec</code></td>
<td>
<p>Vector of times the solution should be output out e.g. seq(1,10,0.1)</p>
</td></tr>
<tr><td><code id="popModel_+3A_speciesnames">speciesNames</code></td>
<td>
<p>A vector of strings containing the name for each species.</p>
</td></tr>
<tr><td><code id="popModel_+3A_stagenames">stageNames</code></td>
<td>
<p>A list of n vectors (where n is the number of species) containing the names of each stage for each species.</p>
</td></tr>
<tr><td><code id="popModel_+3A_ratefunctions">rateFunctions</code></td>
<td>
<p>A list of rate functions to use. See <code><a href="#topic+RateFunctions">RateFunctions</a></code></p>
</td></tr>
<tr><td><code id="popModel_+3A_ics">ICs</code></td>
<td>
<p>is a list of matrices containing the initial conditions for every stage and strain of each species. These must be zero for all stages apart from the reproductive stage (usually the last stage). Each species has a matrix with the number of columns equal to the number of strains in that species and the number of rows equal to the number of stages in that species. E.g. for 2 species, the first with 2 strains and 3 stages, the second with 1 strain and 1 stage, then for zero starting conditions: ICs=list(matrix(0,ncol=2,nrow=3),matrix(0,ncol=1,nrow=1)). Due to the restrictions on initial conditions, it is recommended that more complicated initial conditions are defined through immigration rates in immigrationFunc</p>
</td></tr>
<tr><td><code id="popModel_+3A_timedependloss">timeDependLoss</code></td>
<td>
<p>A vector specifying TRUE/FALSE for each species. If a species has any time dependent per capita death or emigration rates, the entry in the vector must be TRUE. The default is TRUE for each species.</p>
</td></tr>
<tr><td><code id="popModel_+3A_timedependduration">timeDependDuration</code></td>
<td>
<p>A vector specifying TRUE/FALSE for each species. If a species has any time dependent stage durations the entry is TRUE for that species. The default is FALSE for each species.</p>
</td></tr>
<tr><td><code id="popModel_+3A_solveroptions">solverOptions</code></td>
<td>
<p>Options for the DDE solver. A list containing 'DDEsolver' (can be 'deSolve' or 'PBS'), 'tol' (max error tolerance for DDE solver), 'hbsize' (history buffer size), 'method' (method for DDE solver), 'atol' (absolute tolerance (deSolve only)) and 'dt' (maximum initial timestep (PBS only)). Default is solverOptions=list(DDEsolver='PBS',tol=1e-7,hbsize=1e3,method='lsoda',atol=1e-7,dt=0.1)</p>
</td></tr>
<tr><td><code id="popModel_+3A_checkfornegs">checkForNegs</code></td>
<td>
<p>If TRUE the function checkSolution is called and the solution for each variable, x, is checked for negative values that are greater in magnitude than ntol*max(x). If negative values occur then the solution is incorect and either the problem is incorrectly specified or the tolerances in the DDE solver need to be smaller. The default is TRUE.</p>
</td></tr>
<tr><td><code id="popModel_+3A_ntol">ntol</code></td>
<td>
<p>This controls the tolerance on the warning given for negative values when checkSolution is called. The default is 0.01 i.e. negative values whose magnitude is less than 1 percent of the max value of the variable are allowed.</p>
</td></tr>
<tr><td><code id="popModel_+3A_plotfigs">plotFigs</code></td>
<td>
<p>If TRUE, results will be automatically plotted during the model run. The default is TRUE.</p>
</td></tr>
<tr><td><code id="popModel_+3A_savefig">saveFig</code></td>
<td>
<p>Choose to save the figure (TRUE or FALSE). Default is FALSE.</p>
</td></tr>
<tr><td><code id="popModel_+3A_figtype">figType</code></td>
<td>
<p>Figure format can be 'eps', 'tiff' or 'png'. Default is 'eps'</p>
</td></tr>
<tr><td><code id="popModel_+3A_figname">figName</code></td>
<td>
<p>filepath to save figure to. Default is 'stagePopFig'</p>
</td></tr>
<tr><td><code id="popModel_+3A_sumoverstrains">sumOverStrains</code></td>
<td>
<p>If any of the species contain multiple strains then if this is TRUE the output is given as the sum over all the strains in the species. If this is FALSE then the time series for each strain will be in the output. Default is TRUE.</p>
</td></tr>
<tr><td><code id="popModel_+3A_plotstrainsfig">plotStrainsFig</code></td>
<td>
<p>If any of the species contain multiple strains then if this is TRUE these will be plotted. Default is TRUE</p>
</td></tr>
<tr><td><code id="popModel_+3A_savestrainsfig">saveStrainsFig</code></td>
<td>
<p>If any of the species contain multiple strains then if this is TRUE the figures for the strains will be saveed</p>
</td></tr>
<tr><td><code id="popModel_+3A_strainsfigtype">strainsFigType</code></td>
<td>
<p>If any of the species contain multiple strains and if saveStrainsFig=TRUE then this is used to choose the type of file the figure is saved as (choose from 'eps', 'png' and 'tiff'). Default is 'eps'.</p>
</td></tr>
<tr><td><code id="popModel_+3A_strainsfigname">strainsFigName</code></td>
<td>
<p>If any of the species contain multiple strains and if saveStrainsFig=TRUE then this is used to choose the name of file the figure is saved as. Default is created by paste('strainFig',SpeciesName[i]).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The default solver options are:
</p>
<p><code>list('DDEsolver'='deSolve','tol'=1e-7,'hbsize'=1e3,'method'=lsoda,'atol'=1e-7,'dt'=0.1)</code>
</p>
<p>but these may be changed by use of the <code>solverOptions</code>
parameter. Please see <code><a href="#topic+SolverOptions">SolverOptions</a></code> for details of this
parameter.
</p>


<h3>Value</h3>

<p>The model output is a matrix where rows are points in time and the columns are the state variables. These are named according to the species names and stage names supplied in inputs; the prefixes 'prob', 'dur' and 'dot' refer to the probability of survival through the stage, the duration of the stage and the rate of change of the variable. 'prob' type variables only appear if the per capita death (or emigration) rate is variable in time and 'dur' only appears if the stage duration is variable in time.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rateFuncs=list(
  reproFunc=function(x,time,species,strain){
   v=10*x$flies['adults',1]*exp(-x$flies['adults',1]/100)
   return(max(v,0))
 },
 deathFunc=function(stage,x,time,species,strain){
   a=c(0.05,0.1,0.1); return(a[stage])
 },
 durationFunc=function(stage,x,time,species,strain){
   a=c(5,10); return(a[stage])
 },
 immigrationFunc=function(stage,x,time,species,strain){
   v=0
   if (stage==3 &amp; time&lt;1){v=100}; return(v)},
 emigrationFunc=function(stage,x,time,species,strain){return(0)}
)

modelOutput = popModel(
 numSpecies=1,
 numStages=3,
 ICs=list(matrix(0,nrow=3,ncol=1)),
 timeVec=seq(0,100,0.5),
 timeDependLoss=FALSE,
 timeDependDuration=FALSE,
 rateFunctions=rateFuncs,
 solverOptions=list(DDEsolver='PBS',tol=1e-4,hbsize=1e4,dt=0.01),
 stageNames=list(c('eggs','larvae','adults')),
 speciesNames=c('flies'),
 plotFigs=FALSE #change this to TRUE to see graphical output
 )
</code></pre>

<hr>
<h2 id='rateFuncCheck'>rateFunCheck</h2><span id='topic+rateFuncCheck'></span>

<h3>Description</h3>

<p>check the user-defined rate functions exist and are in the correct format
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rateFuncCheck(
  x,
  numSpecies,
  numStages,
  numStrains,
  timeDependDuration,
  rateFunctions,
  speciesNames,
  stageNames,
  startTime
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rateFuncCheck_+3A_x">x</code></td>
<td>
<p>Vector of state variables within the DDE solver. To access a variable use: x$speciesName['stageName',strainNumber]</p>
</td></tr>
<tr><td><code id="rateFuncCheck_+3A_numspecies">numSpecies</code></td>
<td>
<p>Number of species</p>
</td></tr>
<tr><td><code id="rateFuncCheck_+3A_numstages">numStages</code></td>
<td>
<p>Number of life stages</p>
</td></tr>
<tr><td><code id="rateFuncCheck_+3A_numstrains">numStrains</code></td>
<td>
<p>Number of strains for each species</p>
</td></tr>
<tr><td><code id="rateFuncCheck_+3A_timedependduration">timeDependDuration</code></td>
<td>
<p>vector of logicals defining whether the stage duration is time dependent for each species</p>
</td></tr>
<tr><td><code id="rateFuncCheck_+3A_ratefunctions">rateFunctions</code></td>
<td>
<p>List of rate functions to check</p>
</td></tr>
<tr><td><code id="rateFuncCheck_+3A_speciesnames">speciesNames</code></td>
<td>
<p>Vector of species names</p>
</td></tr>
<tr><td><code id="rateFuncCheck_+3A_stagenames">stageNames</code></td>
<td>
<p>Vector of species' stage names</p>
</td></tr>
<tr><td><code id="rateFuncCheck_+3A_starttime">startTime</code></td>
<td>
<p>First entry in timeVec vector</p>
</td></tr>
</table>


<h3>Details</h3>

<p>checks existence of deathFunc, reproFunc, durationFunc, immigrationFunc and develFunc if 
there is time dependent duration.
</p>
<p>Also checks that output from rate functions is a single value
</p>


<h3>Value</h3>

<p>TRUE/FALSE - TRUE if rate functions are OK, FALSE if not.
</p>

<hr>
<h2 id='RateFunctions'>Rate Functions</h2><span id='topic+RateFunctions'></span>

<h3>Description</h3>

<p>The rate functions are user-defined functions which give the rates for each life
stage.
</p>


<h3>Details</h3>

<p>These are passed into the <code><a href="#topic+popModel">popModel</a></code> function via the <code>rateFunctions</code> argument. 
</p>
<p>The signatures for each rate function are defined in their respective documentation files
</p>


<h3>See Also</h3>

<p><code><a href="#topic+deathFunction">deathFunction</a></code> <code><a href="#topic+durationFunction">durationFunction</a></code> <code><a href="#topic+reproductionFunction">reproductionFunction</a></code> <code><a href="#topic+developmentFunction">developmentFunction</a></code> <code><a href="#topic+immigrationFunction">immigrationFunction</a></code> <code><a href="#topic+emigrationFunction">emigrationFunction</a></code>
</p>

<hr>
<h2 id='reproFuncDefault'>Reproduction Function</h2><span id='topic+reproFuncDefault'></span><span id='topic+reproFunc'></span><span id='topic+reproductionFunction'></span>

<h3>Description</h3>

<p>Return the rate of reproduction (amount per unit time)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reproFuncDefault(x, time, species, strain)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="reproFuncDefault_+3A_x">x</code></td>
<td>
<p>Vector of state variables within the DDE solver. To access a variable use:
x$speciesName['stageName',strainNumber]
e.g. for species 'Bacteria', stage 'reproductive', strain 2 use
x$Bacteria['reproductive',2]
If there is only one stage and strain in species 'Food', for example, use
x$Food[1,1]</p>
</td></tr>
<tr><td><code id="reproFuncDefault_+3A_time">time</code></td>
<td>
<p>(scalar). The current time point in the DDE solver.</p>
</td></tr>
<tr><td><code id="reproFuncDefault_+3A_species">species</code></td>
<td>
<p>(integer). The numbered species for which to return a reproductive rate.</p>
</td></tr>
<tr><td><code id="reproFuncDefault_+3A_strain">strain</code></td>
<td>
<p>(integer). The numbered strain for which to return a rate.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Unlike the other <code><a href="#topic+RateFunctions">RateFunctions</a></code> this rate function has
no stage argument as by definition it only pertains to the first
stage of life
</p>


<h3>Value</h3>

<p>Reproduction rate (amount per unit time) for the strain, species and time specified.
</p>

<hr>
<h2 id='runStagePopExample'>runStagePopExample</h2><span id='topic+runStagePopExample'></span>

<h3>Description</h3>

<p>This function is similar to the demo() function but requires less interaction
It is used to run the canned examples from the stagePop package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>runStagePopExample(name = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="runStagePopExample_+3A_name">name</code></td>
<td>
<p>Name of the example to run. If Name is NULL the list of examples will be printed.</p>
</td></tr>
</table>

<hr>
<h2 id='SolverOptions'>SolverOptions</h2><span id='topic+SolverOptions'></span>

<h3>Description</h3>

<p>Documentation for the SolverOptions parameter
</p>


<h3>Details</h3>

<p>SolverOptions (optional) is a list containing: 'DDEsolver', 'tol', 'hbsize', 'method' and 'atol'. DDEsolver equal to 'deSolve' or 'PBS' sets the R package used to solve the DDEs. The 'tol' option sets the relative tolerances and 'hbsize' sets the size of the history buffer. The remaining two items, 'method' and 'atol' set the numerical integration scheme and the absolute tolerance if 'DDEsolver'='deSolve' (PBS does not have these options). If solverOptions is not specified at all, or if only some of the options are specified, the default values: list('DDEsolver'='deSolve', 'tol'=1e-7, 'hbsize'=1e3, 'method'=lsoda, 'atol'=1e-7, 'dt'=0.1) will be used.
</p>

<hr>
<h2 id='stagePop-package'>Stage-Structured Population modelling</h2><span id='topic+stagePop-package'></span><span id='topic+stagePop'></span>

<h3>Description</h3>

<p>stagePop can be used to model the dynamics and interactions of stage-structured populations (i.e. where the life cycle consists of distinct stages - e.g. eggs, juveniles and reproductive adults) in continuous time. It can be used to model predator-prey interactions, host-parasitoid interactions, resource competition and the effects of environmental change on stage-structured species. The model is based on the formulation described by RM Nisbet and WSC Gurney in 1983 in the paper 'The systematic formulation of population models for insects with dynamically varying instar duration. Theoretical Population Biology, 23, 114-135'.  It uses delay differential equations which are solved using the R-packages 'deSolve' or 'PBSddesolve'.
</p>


<h3>Author(s)</h3>

<p>Helen Kettle
</p>


<h3>References</h3>

<p>To be done
</p>

<hr>
<h2 id='sumStrains'>sumStrains</h2><span id='topic+sumStrains'></span>

<h3>Description</h3>

<p>sumStrains
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sumStrains(
  namedOutput,
  numSpecies,
  numStages,
  numStrains,
  speciesNames,
  stageNames,
  timeDependLoss,
  timeDependDuration
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sumStrains_+3A_namedoutput">namedOutput</code></td>
<td>
<p>The output martix from popModel</p>
</td></tr>
<tr><td><code id="sumStrains_+3A_numspecies">numSpecies</code></td>
<td>
<p>Number of species (integer)</p>
</td></tr>
<tr><td><code id="sumStrains_+3A_numstages">numStages</code></td>
<td>
<p>Number of life-stages in each species (vector)</p>
</td></tr>
<tr><td><code id="sumStrains_+3A_numstrains">numStrains</code></td>
<td>
<p>Number of strains in each species (vector)</p>
</td></tr>
<tr><td><code id="sumStrains_+3A_speciesnames">speciesNames</code></td>
<td>
<p>A vector of strings containing the name for each species. This is only used for plotting purposes.</p>
</td></tr>
<tr><td><code id="sumStrains_+3A_stagenames">stageNames</code></td>
<td>
<p>A list of n vectors (where n is the number of species) containing the names of each stage for each species.</p>
</td></tr>
<tr><td><code id="sumStrains_+3A_timedependloss">timeDependLoss</code></td>
<td>
<p>A vector specifying TRUE/FALSE for each species. If a species has any time dependent per capita death rates (e.g. density dependent death rates) this is TRUE.</p>
</td></tr>
<tr><td><code id="sumStrains_+3A_timedependduration">timeDependDuration</code></td>
<td>
<p>A vector specifying TRUE/FALSE for each species. If a species has any time dependent stage durations it is TRUE for that species.</p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
