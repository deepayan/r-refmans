<!DOCTYPE html><html><head><title>Help for package WeightedPortTest</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {WeightedPortTest}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Weighted.Box.test'><p>Weighted Portmanteau Test</p>
</a></li>
<li><a href='#Weighted.LM.test'><p>Weighted Portmanteau Test for Fitted ARCH process</p>
</a></li>
<li><a href='#WeightedPortTest-package'><p>Weighted Portmanteau Test procedures for Time Series Goodness-of-fit</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Weighted Portmanteau Tests for Time Series Goodness-of-Fit</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-05-23</td>
</tr>
<tr>
<td>Description:</td>
<td>An implementation of the Weighted Portmanteau Tests described
      in "New Weighted Portmanteau Statistics for Time Series Goodness-of-Fit Testing"
      published by the Journal of the American Statistical Association, Volume 107, 
      Issue 498, pages 777-787, 2012.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-05-24 02:16:32 UTC; fishert4</td>
</tr>
<tr>
<td>Author:</td>
<td>Thomas J. Fisher <a href="https://orcid.org/0000-0001-5885-7646"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Colin M. Gallagher [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Thomas J. Fisher &lt;fishert4@miamioh.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-05-24 07:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='Weighted.Box.test'>Weighted Portmanteau Test

</h2><span id='topic+Weighted.Box.test'></span>

<h3>Description</h3>

<p>Weighted portmanteau tests for testing the null hypothesis of adequate ARMA fit and/or for detecting nonlinear processes. Written in the style of <code>Box.test()</code> and is capable of performing the traditional Box Pierce (1970), Ljung Box (1978) or Monti (1994) tests.

</p>


<h3>Usage</h3>

<pre><code class='language-R'>Weighted.Box.test(x, lag = 1, 
                 type = c("Box-Pierce", "Ljung-Box", "Monti"),
                 fitdf = 0, sqrd.res = FALSE,
                 log.sqrd.res = FALSE, abs.res = FALSE,
                 weighted = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Weighted.Box.test_+3A_x">x</code></td>
<td>
<p>a numeric vector or univariate time series, or residuals of a fitted time series

</p>
</td></tr>
<tr><td><code id="Weighted.Box.test_+3A_lag">lag</code></td>
<td>
<p>the statistic will be based on <code>lag</code> autocorrelation coefficients. lag=1 by default

</p>
</td></tr>
<tr><td><code id="Weighted.Box.test_+3A_type">type</code></td>
<td>
<p>test to be performed, partial matching is used. &quot;Box-Pierce&quot; by default

</p>
</td></tr>
<tr><td><code id="Weighted.Box.test_+3A_fitdf">fitdf</code></td>
<td>
<p>number of degrees of freedom to be subtracted if <code>x</code> is a series of residuals, set at 0 by default

</p>
</td></tr>
<tr><td><code id="Weighted.Box.test_+3A_sqrd.res">sqrd.res</code></td>
<td>
<p>A flag, should the series/residuals be squared to detect for nonlinear effects?, FALSE by default

</p>
</td></tr>
<tr><td><code id="Weighted.Box.test_+3A_log.sqrd.res">log.sqrd.res</code></td>
<td>
<p>A flag, should a log of the squared series/residuals be used to detect for nonlinear effects? FALSE by default

</p>
</td></tr>
<tr><td><code id="Weighted.Box.test_+3A_abs.res">abs.res</code></td>
<td>
<p>A flag, should the absolute series or residuals be used to detect for nonlinear effects? FALSE by default

</p>
</td></tr>
<tr><td><code id="Weighted.Box.test_+3A_weighted">weighted</code></td>
<td>
<p>A flag determining if the weighting scheme should be utilized. TRUE by default. If set to FALSE, the traditional test is performed with no weights

</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These test are traditionally applied to a time series for detecting autocorrelation, or to the residuals of an <code>ARMA(p,q)</code> fit to check the adequacy of that fit or to detect nonlinear (i.e. GARCH) effects in the time/residual series. The weighting scheme utilized here is asymptotically similar to the results found in Pena and Rodriguez (2002) and Mahdi and McLeod (2012) (i.e. the <code>portes</code> package).

</p>


<h3>Value</h3>

<p>A list with class &quot;<code>htest</code>&quot; containing the following components:
</p>
<table>
<tr><td><code>statistic</code></td>
<td>
<p>the value of the test statistic</p>
</td></tr>
<tr><td><code>parameter</code></td>
<td>
<p>The approximate shape and scale parameters for the weighted statistic or degrees of freedom of the chi-squared distribution if the weighted flag is set to false.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>The p-value of the test</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>a character string indicating which type of test was performed.</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>a character string giving the name of the data</p>
</td></tr>





</table>


<h3>Note</h3>

<p>Like the <code>Box.test()</code> function, missing values are not handled

</p>


<h3>Author(s)</h3>

<p>Thomas J. Fisher

</p>


<h3>References</h3>

<p>Box, G. E. P. and Pierce, D. A. (1970), Distribution of residual correlations in autoregressive-integrated moving average time series models. Journal of the American Statistical Association, 65, 1509-1526.
</p>
<p>Fisher, T. J. and Gallagher, C. M. (2012), New Weighted Portmanteau Statistics for Time Series Goodness-of-Fit Testing. Journal of the American Statistical Association, 107(498), 777-787.
</p>
<p>Ljung, G. M. and Box, G. E. P. (1978), On a measure of lack of fit in time series models. Biometrika 65, 297-303.
</p>
<p>Mahdi, E. and McLeod, A. I. (2012), Improved multivariate portmanteau test. Journal of Time Series Analysis 65(2), 297-303.
</p>
<p>Monti, A. C. (1994), A proposal for a residual autocorrelation test in linear models. Biometrika 81(4), 776-780.
</p>
<p>Pena, D. and Rodriguez, J. (2002) A powerful portmanteau test of lack of fit for time series. Journal of the American Statistical Association 97(458), 601-610.

</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1)
x &lt;- rnorm(100);
Weighted.Box.test(x, lag=10, type="Ljung");
Weighted.Box.test(x, lag=10, type="Ljung", sqrd.res=TRUE);
</code></pre>

<hr>
<h2 id='Weighted.LM.test'>Weighted Portmanteau Test for Fitted ARCH process

</h2><span id='topic+Weighted.LM.test'></span>

<h3>Description</h3>

<p>A weighted portmanteau test for testing the null hypothesis of adequately fitted ARCH process. This is essentially a weighted version of the statistic proposed by Li and Mak (1994)

</p>


<h3>Usage</h3>

<pre><code class='language-R'>Weighted.LM.test(x, h.t, lag = 1, 
                type = c("correlation", "partial"),
                fitdf = 1, weighted = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Weighted.LM.test_+3A_x">x</code></td>
<td>
<p>a numeric vector or univariate time series, or residuals of a fitted time series

</p>
</td></tr>
<tr><td><code id="Weighted.LM.test_+3A_h.t">h.t</code></td>
<td>
<p>a numeric vector of the conditional variances

</p>
</td></tr>
<tr><td><code id="Weighted.LM.test_+3A_lag">lag</code></td>
<td>
<p>the statistic will be based on <code>lag</code> autocorrelation coefficients.

</p>
</td></tr>
<tr><td><code id="Weighted.LM.test_+3A_type">type</code></td>
<td>
<p>type of test to be performed, either based on the autocorrelations or partial-autocorrelations.

</p>
</td></tr>
<tr><td><code id="Weighted.LM.test_+3A_fitdf">fitdf</code></td>
<td>
<p>the number of ARCH parameters fit to the model, default=1 since at least some ARCH model must be fit to find h.t

</p>
</td></tr>
<tr><td><code id="Weighted.LM.test_+3A_weighted">weighted</code></td>
<td>
<p>A flag determining if the weighting scheme should be utilized. TRUE by default, if FALSE, it performs the test from Li and Mak (1994)

</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These test can be performed after fitting an ARCH process to a time series. The theoretical work was originally developed in Li and Mak (1994) and has recently been extended in Fisher and Gallagher (2012).

</p>


<h3>Value</h3>

<p>A list with class &quot;<code>htest</code>&quot; containing the following components:
</p>
<table>
<tr><td><code>statistic</code></td>
<td>
<p>the value of the test statistic</p>
</td></tr>
<tr><td><code>parameter</code></td>
<td>
<p>The approximate shape and scale parameters for the weighted statistic or degrees of freedom of the chi-squared distribution if the weighted flag is set to FALSE.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>The p-value of the test</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>a character string indicating which type of test was performed.</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>a character string giving the name of the data</p>
</td></tr>





</table>


<h3>Note</h3>

<p>Similiar to the <code>Box.test()</code> and <code>Weighted.Box.test()</code> functions

</p>


<h3>Author(s)</h3>

<p>Thomas J. Fisher

</p>


<h3>References</h3>

<p>Fisher, T. J. and Gallagher, C. M. (2012), New Weighted Portmanteau Statistics for Time Series Goodness-of-Fit Testing. Journal of the American Statistical Association, 107(498), 777-787.
</p>
<p>Li, W. K. and Mak, T. K. (1994), On the squared residual autocorrelations in non-linear time series with conditional heteroskedasticity. Journal of Time Series Analysis 15(6), 627-636.
</p>


<hr>
<h2 id='WeightedPortTest-package'>Weighted Portmanteau Test procedures for Time Series Goodness-of-fit
</h2><span id='topic+WeightedPortTest-package'></span><span id='topic+WeightedPortTest'></span>

<h3>Description</h3>

<p>Two functions that implement the Weighted Portmanteau Statistics from Fisher and Gallagher (2012). The first is essentially a weighted Ljung-Box type test that can be used for fitted ARMA processes or detecting non-linear effects. The second function can be utilized to check the adequacy of a fitted ARCH process. Both are written for backward compatibility.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> WeightedPortTest</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.1</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2023-05-23</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;=3)</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>The two functions, <code>Weighted.Box.test()</code> and <code>Weighted.LM.test()</code>, can be used in a similiar to the <code>Box.test()</code> function.
</p>


<h3>Author(s)</h3>

<p>Thomas J. Fisher and Colin M. Gallagher
</p>
<p>Maintainer: Thomas J. Fisher &lt;fishert4@miamioh.edu&gt;
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
