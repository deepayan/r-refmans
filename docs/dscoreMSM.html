<!DOCTYPE html><html lang="en"><head><title>Help for package dscoreMSM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {dscoreMSM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cphGM'><p>CoxPH model with parametric baseline and frailty terms</p></a></li>
<li><a href='#dscore'><p>Survival Proximity Score matching for MSM</p></a></li>
<li><a href='#EBMTdata'><p>European Bone Marrow Transplantation data obtained from <code>mstate</code> r package</p></a></li>
<li><a href='#EBMTupdate'><p>European Bone Marrow Transplantation data obtained from <code>mstate</code> r package. This is the updated data obtained after applying SPSM.</p></a></li>
<li><a href='#expbh'><p>Exponential baseline hazard</p></a></li>
<li><a href='#ggplot_roc'><p>Reciever Operating Curve</p></a></li>
<li><a href='#ggplot_surv'><p>Survival probability plot</p></a></li>
<li><a href='#gompbh'><p>Gompartz baseline hazard</p></a></li>
<li><a href='#print.cphGM'><p>print function for cphGM</p></a></li>
<li><a href='#simfdata'><p>simulation of survival data</p></a></li>
<li><a href='#simulated_data'><p>Simulated multistate data</p></a></li>
<li><a href='#weibulbh'><p>Weibull baseline hazard</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Survival Proximity Score Matching in Multi-State Survival Model</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Atanu Bhattacharjee &lt;atanustat@gmail.com&gt;</td>
</tr>
<tr>
<td>Imports:</td>
<td>rjags, stats, timeROC, ggplot2, survival, mstate</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements survival proximity score matching in multi-state survival models. Includes tools for simulating survival data and estimating transition-specific coxph models with frailty terms. The primary methodological work on multistate censored data modeling using propensity score matching has been published by Bhattacharjee et al.(2024) &lt;<a href="https://doi.org/10.1038%2Fs41598-024-54149-y">doi:10.1038/s41598-024-54149-y</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-12-12 16:29:27 UTC; atanubhattacharjee</td>
</tr>
<tr>
<td>Author:</td>
<td>Atanu Bhattacharjee [aut, cre, ctb],
  Bhrigu Kumar Rajbongshi [aut, ctb],
  Gajendra K Vishwakarma [aut, ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-12-13 16:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='cphGM'>CoxPH model with parametric baseline and frailty terms</h2><span id='topic+cphGM'></span>

<h3>Description</h3>

<p>Function for estimating the parameters of coxPH model with frailty terms
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cphGM(
  formula,
  fterm,
  Time,
  status,
  id,
  data,
  bhdist,
  method = "L-BFGS-B",
  maxit = 200
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cphGM_+3A_formula">formula</code></td>
<td>
<p>survival model formula like Surv(time,status)~x1+x2</p>
</td></tr>
<tr><td><code id="cphGM_+3A_fterm">fterm</code></td>
<td>
<p>frailty term like c('gamma','center'). Currently we have the option for gamma distribution.</p>
</td></tr>
<tr><td><code id="cphGM_+3A_time">Time</code></td>
<td>
<p>survival time column</p>
</td></tr>
<tr><td><code id="cphGM_+3A_status">status</code></td>
<td>
<p>survival status column</p>
</td></tr>
<tr><td><code id="cphGM_+3A_id">id</code></td>
<td>
<p>id column</p>
</td></tr>
<tr><td><code id="cphGM_+3A_data">data</code></td>
<td>
<p>dataset</p>
</td></tr>
<tr><td><code id="cphGM_+3A_bhdist">bhdist</code></td>
<td>
<p>distribution of survival time at baseline. Available option 'weibull','exponential','gompertz',</p>
</td></tr>
<tr><td><code id="cphGM_+3A_method">method</code></td>
<td>
<p>options are 'LFGS','L-BFGS-G','CG' etc. for more details see <a href="stats.html#topic+optim">optim</a></p>
</td></tr>
<tr><td><code id="cphGM_+3A_maxit">maxit</code></td>
<td>
<p>maximum number of iteration</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The hazard model is as follows:
</p>
<p style="text-align: center;"><code class="reqn">h_i(t)=z_ih_0(t)exp(\textbf{x}_i\beta)\;;i=1,2,3,...,n</code>
</p>

<p>where baseline survival distribution could be Weibull distribution and the hazard function is:
</p>
<p style="text-align: center;"><code class="reqn">h_0(t)=\rho \lambda t^{\rho-1}</code>
</p>
<p>. Similarly we can have Expoenetial, log logistic distribution. The following are the formula for hazard and cummulative hazard function
For exponential: <code class="reqn">h_0(t)=\lambda</code> and <code class="reqn">H_0(t)=\lambda t</code>\;<code class="reqn">\lambda&gt;0</code>
Gompertz: <code class="reqn">h_0(t)=\lambda exp(\gamma t)</code> and <code class="reqn">H_0(t)=\frac{\lambda}{\gamma}(exp(\gamma t)-1)</code>;<code class="reqn">\lambda,\gamma&gt;0</code>
The frailty term <code class="reqn">z_i</code> follows Gamma distribution with parameter <code class="reqn">\theta</code>. The parameter estimates are obtained by maximising the log likelihood
</p>
<p style="text-align: center;"><code class="reqn">\prod_{i=1}^{n}l_i(\beta,\theta,\lambda,\rho)</code>
</p>

<p>The method argument allows the user to select suitable optimisation method available in <code>optim</code> function.
</p>


<h3>Value</h3>

<p>Estimates obtained from coxph model with the frailty terms.
</p>


<h3>Author(s)</h3>

<p>Atanu Bhattacharjee, Bhrigu Kumar Rajbongshi and Gajendra K. Vishwakarma
</p>


<h3>References</h3>

<p>Vishwakarma, G. K., Bhattacherjee, A., Rajbongshi, B. K., &amp; Tripathy, A. (2024). Censored imputation of time to event outcome through survival proximity score method. <em>Journal of Computational and Applied Mathematics</em>, 116103;
</p>
<p>Bhattacharjee, A., Vishwakarma, G. K., Tripathy, A., &amp; Rajbongshi, B. K. (2024). Competing risk multistate censored data modeling by propensity score matching method. <em>Scientific Reports</em>, 14(1), 4368.
</p>


<h3>See Also</h3>

<p><a href="#topic+dscore">dscore</a>,<a href="#topic+simfdata">simfdata</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
##
X1&lt;-matrix(rnorm(1000*2),1000,2)
simulated_data&lt;-simfdata(n=1000,beta=c(0.5,0.5),fvar=0.5,
X=X1)
model1&lt;-cphGM(formula=Surv(time,status)~X1+X2,
fterm&lt;-c('gamma','id'),Time="time",status="status",
id="id",data=simulated_data,bhdist='weibull')
model1
##

</code></pre>

<hr>
<h2 id='dscore'>Survival Proximity Score matching for MSM</h2><span id='topic+dscore'></span>

<h3>Description</h3>

<p>function for survival proximity score matching in multistate model with three state.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dscore(status, data, prob, m, n, method = "euclidean")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dscore_+3A_status">status</code></td>
<td>
<p>status column name in the survival data</p>
</td></tr>
<tr><td><code id="dscore_+3A_data">data</code></td>
<td>
<p>survival data</p>
</td></tr>
<tr><td><code id="dscore_+3A_prob">prob</code></td>
<td>
<p>threshold probability</p>
</td></tr>
<tr><td><code id="dscore_+3A_m">m</code></td>
<td>
<p>starting column number</p>
</td></tr>
<tr><td><code id="dscore_+3A_n">n</code></td>
<td>
<p>ending column number</p>
</td></tr>
<tr><td><code id="dscore_+3A_method">method</code></td>
<td>
<p>distance metric name e.g. &quot;euclidean&quot;,&quot;minkowski&quot;,&quot;canberra&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list with newdataset updated using dscore
</p>


<h3>Author(s)</h3>

<p>Atanu Bhattacharjee, Bhrigu Kumar Rajbongshi and Gajendra K. Vishwakarma
</p>


<h3>References</h3>

<p>Vishwakarma, G. K., Bhattacherjee, A., Rajbongshi, B. K., &amp; Tripathy, A. (2024). Censored imputation of time to event outcome through survival proximity score method. <em>Journal of Computational and Applied Mathematics</em>, 116103;
</p>
<p>Bhattacharjee, A., Vishwakarma, G. K., Tripathy, A., &amp; Rajbongshi, B. K. (2024). Competing risk multistate censored data modeling by propensity score matching method. <em>Scientific Reports</em>, 14(1), 4368.
</p>


<h3>See Also</h3>

<p><a href="#topic+cphGM">cphGM</a>,<a href="#topic+simfdata">simfdata</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
##s
data(simulated_data)
udata&lt;-dscore(status="status",data=simulated_data,prob=0.65,m=4,n=7)
##

</code></pre>

<hr>
<h2 id='EBMTdata'>European Bone Marrow Transplantation data obtained from <code>mstate</code> r package</h2><span id='topic+EBMTdata'></span>

<h3>Description</h3>

<p>A multi state dataset
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(EBMTdata)
</code></pre>


<h3>Format</h3>

<p>a tibble of 13 columns and 2204 observations,
</p>

<dl>
<dt>id</dt><dd><p>id value for subjects</p>
</dd>
<dt>prtime</dt><dd><p>Time in days from transplantation to platelet recovery or last follow-up</p>
</dd>
<dt>prstate</dt><dd><p>Platelet recovery status; 1 = platelet recovery, 0 = censored</p>
</dd>
<dt>rfstime</dt><dd><p>Time in days from transplantation to relapse or death or last follow-up (relapse-free survival time)</p>
</dd>
<dt>rfsstate</dt><dd><p>Relapse-free survival status; 1 = relapsed or dead, 0 = censored</p>
</dd>
<dt>dissub</dt><dd><p>Disease subclassification; factor with levels &quot;AML&quot;, &quot;ALL&quot;, &quot;CML&quot;</p>
</dd>
<dt>age</dt><dd><p>Patient age at transplant; factor with levels &quot;&lt;=20&quot;, &quot;20-40&quot;, &quot;&gt;40&quot;</p>
</dd>
<dt>drmatch</dt><dd><p>Donor-recipient gender match; factor with levels &quot;No gender mismatch&quot;, &quot;Gender mismatch&quot;</p>
</dd>
<dt>tcd</dt><dd><p>T-cell depletion; factor with levels &quot;No TCD&quot;, &quot;TCD&quot;</p>
</dd>
<dt>x1,x2,x3,x4</dt><dd><p>simulated covariate information used for SPSM</p>
</dd>
</dl>



<h3>Source</h3>

<p>We acknowledge that this data set is obtained from the r package <code>mstate</code>. We have included four continuous covariates in the dataset to demonstrate SPSM method in multistate survival model.
</p>


<h3>References</h3>

<p>de Wreede, L. C., Fiocco, M., &amp; Putter, H. (2011). mstate: an R package for the analysis of competing risks and multi-state models. Journal of statistical software, 38, 1-30.
</p>
<p>Vishwakarma, G. K., Bhattacherjee, A., Rajbongshi, B. K., &amp; Tripathy, A. (2024). Censored imputation of time to event outcome through survival proximity score method. Journal of Computational and Applied Mathematics, 116103;
</p>
<p>Bhattacharjee, A., Vishwakarma, G. K., Tripathy, A., &amp; Rajbongshi, B. K. (2024). Competing risk multistate censored data modeling by propensity score matching method. Scientific Reports, 14(1), 4368.
</p>

<hr>
<h2 id='EBMTupdate'>European Bone Marrow Transplantation data obtained from <code>mstate</code> r package. This is the updated data obtained after applying SPSM.</h2><span id='topic+EBMTupdate'></span>

<h3>Description</h3>

<p>A multi state dataset
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(EBMTupdate)
</code></pre>


<h3>Format</h3>

<p>a tibble of 13 columns and 2204 observations,
</p>

<dl>
<dt>id</dt><dd><p>id value for subjects</p>
</dd>
<dt>prtime</dt><dd><p>Time in days from transplantation to platelet recovery or last follow-up</p>
</dd>
<dt>prstate</dt><dd><p>Platelet recovery status; 1 = platelet recovery, 0 = censored</p>
</dd>
<dt>rfstime</dt><dd><p>Time in days from transplantation to relapse or death or last follow-up (relapse-free survival time)</p>
</dd>
<dt>rfsstate</dt><dd><p>Relapse-free survival status; 1 = relapsed or dead, 0 = censored</p>
</dd>
<dt>dissub</dt><dd><p>Disease subclassification; factor with levels &quot;AML&quot;, &quot;ALL&quot;, &quot;CML&quot;</p>
</dd>
<dt>age</dt><dd><p>Patient age at transplant; factor with levels &quot;&lt;=20&quot;, &quot;20-40&quot;, &quot;&gt;40&quot;</p>
</dd>
<dt>drmatch</dt><dd><p>Donor-recipient gender match; factor with levels &quot;No gender mismatch&quot;, &quot;Gender mismatch&quot;</p>
</dd>
<dt>tcd</dt><dd><p>T-cell depletion; factor with levels &quot;No TCD&quot;, &quot;TCD&quot;</p>
</dd>
<dt>x1,x2,x3,x4</dt><dd><p>simulated covariate information used for SPSM</p>
</dd>
</dl>



<h3>Source</h3>

<p>We acknowledge that this data set is obtained from the r package <code>mstate</code>. We have included four continuous covariates in the dataset to demonstrate SPSM method in multistate survival model.
</p>


<h3>References</h3>

<p>de Wreede, L. C., Fiocco, M., &amp; Putter, H. (2011). mstate: an R package for the analysis of competing risks and multi-state models. Journal of statistical software, 38, 1-30.
</p>
<p>Vishwakarma, G. K., Bhattacherjee, A., Rajbongshi, B. K., &amp; Tripathy, A. (2024). Censored imputation of time to event outcome through survival proximity score method. Journal of Computational and Applied Mathematics, 116103;
</p>
<p>Bhattacharjee, A., Vishwakarma, G. K., Tripathy, A., &amp; Rajbongshi, B. K. (2024). Competing risk multistate censored data modeling by propensity score matching method. Scientific Reports, 14(1), 4368.
</p>

<hr>
<h2 id='expbh'>Exponential baseline hazard</h2><span id='topic+expbh'></span>

<h3>Description</h3>

<p>Exponential baseline hazard
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expbh(t, shape = 2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="expbh_+3A_t">t</code></td>
<td>
<p>time</p>
</td></tr>
<tr><td><code id="expbh_+3A_shape">shape</code></td>
<td>
<p>shape parameter</p>
</td></tr>
</table>


<h3>Value</h3>

<p>hazard function value under Exponential distibution
</p>

<hr>
<h2 id='ggplot_roc'>Reciever Operating Curve</h2><span id='topic+ggplot_roc'></span>

<h3>Description</h3>

<p>this function provides roc plot for coxph model fitted before and after survival proximity score matching.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ggplot_roc(
  trns,
  model1,
  model2,
  data1,
  data2,
  folder_path = NULL,
  times = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ggplot_roc_+3A_trns">trns</code></td>
<td>
<p>transition number for the multistate model</p>
</td></tr>
<tr><td><code id="ggplot_roc_+3A_model1">model1</code></td>
<td>
<p>fitted object from coxPH (before SPSM)</p>
</td></tr>
<tr><td><code id="ggplot_roc_+3A_model2">model2</code></td>
<td>
<p>fitted object from coxPH (after SPSM)</p>
</td></tr>
<tr><td><code id="ggplot_roc_+3A_data1">data1</code></td>
<td>
<p>dataset used for model1</p>
</td></tr>
<tr><td><code id="ggplot_roc_+3A_data2">data2</code></td>
<td>
<p>dataset used for model2</p>
</td></tr>
<tr><td><code id="ggplot_roc_+3A_folder_path">folder_path</code></td>
<td>
<p>default is NULL. if folder_path is provided then plots will be saved there automitically.</p>
</td></tr>
<tr><td><code id="ggplot_roc_+3A_times">times</code></td>
<td>
<p>default is NULL. time at which TP and FP values are calculated.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns roc plot for model1 and model2
</p>


<h3>Author(s)</h3>

<p>Atanu Bhattacharjee, Bhrigu Kumar Rajbongshi and Gajendra Kumar Vishwakarma
</p>


<h3>References</h3>

<p>Vishwakarma, G. K., Bhattacherjee, A., Rajbongshi, B. K., &amp; Tripathy, A. (2024). Censored imputation of time to event outcome through survival proximity score method. Journal of Computational and Applied Mathematics, 116103;
</p>
<p>Bhattacharjee, A., Vishwakarma, G. K., Tripathy, A., &amp; Rajbongshi, B. K. (2024). Competing risk multistate censored data modeling by propensity score matching method. Scientific Reports, 14(1), 4368.
</p>


<h3>See Also</h3>

<p><a href="#topic+dscore">dscore</a>, <a href="#topic+simfdata">simfdata</a>, <a href="#topic+cphGM">cphGM</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
##
library(mstate)
data(EBMTdata)
data(EBMTupdate)
tmat&lt;-transMat(x=list(c(2,3),c(3),c()),
               names=c("Tx","Rec","Death"))
covs&lt;-c("dissub","age","drmatch","tcd","prtime","x1","x2","x3","x4")
msbmt&lt;-msprep(time=c(NA,"prtime","rfstime"),
              status=c(NA,"prstat","rfsstat"),
              data=EBMTdata,trans=tmat,keep=covs)
msbmt1&lt;-msprep(time=c(NA,"prtime","rfstime"),
               status=c(NA,"prstat","rfsstat"),
               data=EBMTupdate,trans=tmat,keep=covs)
msph3&lt;-coxph(Surv(time,status)~dissub+age+drmatch+tcd+
frailty(id,distribution='gamma'),data=msbmt[msbmt$trans==3,])
msph33&lt;-coxph(Surv(Tstart,Tstop,status)~dissub+age +drmatch+ tcd+
frailty(id,distribution='gamma'),data=msbmt1[msbmt1$trans==3,])
ggplot_roc(trns=3,model1=msph3,model2=msph33,
           data1=msbmt,data2=msbmt1)
##

</code></pre>

<hr>
<h2 id='ggplot_surv'>Survival probability plot</h2><span id='topic+ggplot_surv'></span>

<h3>Description</h3>

<p>it gives plot with fitted survival curve obtained from two different coxPH model fitted before and after SPSM
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ggplot_surv(model1, model2, data1, data2, n_trans, id)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ggplot_surv_+3A_model1">model1</code></td>
<td>
<p>coxPH fitted model object (before SPSM)</p>
</td></tr>
<tr><td><code id="ggplot_surv_+3A_model2">model2</code></td>
<td>
<p>coxPH fitted model object (after SPSM)</p>
</td></tr>
<tr><td><code id="ggplot_surv_+3A_data1">data1</code></td>
<td>
<p>multistate data used in model1</p>
</td></tr>
<tr><td><code id="ggplot_surv_+3A_data2">data2</code></td>
<td>
<p>multistate data used in model2</p>
</td></tr>
<tr><td><code id="ggplot_surv_+3A_n_trans">n_trans</code></td>
<td>
<p>number of transition</p>
</td></tr>
<tr><td><code id="ggplot_surv_+3A_id">id</code></td>
<td>
<p>particular id from the dataset</p>
</td></tr>
</table>


<h3>Value</h3>

<p>plot for survival curve of a particular id obtained from both the model
</p>


<h3>Author(s)</h3>

<p>Atanu Bhattacharjee, Bhrigu Kumar Rajbongshi and Gajendra Kumar Vishwakarma
</p>


<h3>See Also</h3>

<p><a href="#topic+dscore">dscore</a>, <a href="#topic+simfdata">simfdata</a>, <a href="#topic+cphGM">cphGM</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
##
library(mstate)
data(EBMTdata)
data(EBMTupdate)
tmat&lt;-transMat(x=list(c(2,3),c(3),c()),names=c("Tx","Rec","Death"))
covs&lt;-c("dissub","age","drmatch","tcd","prtime","x1","x2","x3","x4")
msbmt&lt;-msprep(time=c(NA,"prtime","rfstime"),status=c(NA,"prstat","rfsstat"),
             data=EBMTdata,trans=tmat,keep=covs)
msbmt1&lt;-msprep(time=c(NA,"prtime","rfstime"),status=c(NA,"prstat","rfsstat"),
              data=EBMTupdate,trans=tmat,keep=covs)
msph3&lt;-coxph(Surv(time,status)~dissub+age+drmatch+tcd+
             frailty(id,distribution='gamma'),data=msbmt[msbmt$trans==3,])
msph33&lt;-coxph(Surv(Tstart,Tstop,status)~dissub+age +drmatch+ tcd+
              frailty(id,distribution='gamma'),data=msbmt1[msbmt1$trans==3,])
ggplot_surv(model1=msph3,model2=msph33,data1=msbmt,
           data2=msbmt1,n_trans=3,id=1)
#####
# plot1&lt;-ggplot_surv(model1=msph3,model2=msph33,data1=msbmt,data2=msbmt1,
# ggsave("plot1.jpg",path="C:/Users/.....")
#####
##

</code></pre>

<hr>
<h2 id='gompbh'>Gompartz baseline hazard</h2><span id='topic+gompbh'></span>

<h3>Description</h3>

<p>Gompartz baseline hazard
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gompbh(t, shape = 2, scale = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gompbh_+3A_t">t</code></td>
<td>
<p>time</p>
</td></tr>
<tr><td><code id="gompbh_+3A_shape">shape</code></td>
<td>
<p>shape parameter</p>
</td></tr>
<tr><td><code id="gompbh_+3A_scale">scale</code></td>
<td>
<p>scale parameter</p>
</td></tr>
</table>


<h3>Value</h3>

<p>hazard function value under Gompartz distibution
</p>

<hr>
<h2 id='print.cphGM'>print function for cphGM</h2><span id='topic+print.cphGM'></span>

<h3>Description</h3>

<p>S3 print method for class 'cphGM'
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cphGM'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.cphGM_+3A_x">x</code></td>
<td>
<p>object</p>
</td></tr>
<tr><td><code id="print.cphGM_+3A_...">...</code></td>
<td>
<p>others</p>
</td></tr>
</table>


<h3>Value</h3>

<p>prints table containing various parameter estimates,
SE, P-value.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
##
n1&lt;-1000
p1&lt;-2
X1&lt;-matrix(rnorm(n1*p1),n1,p1)
simulated_data&lt;-simfdata(n=1000,beta=c(0.5,0.5),fvar=0.5,X=X1)
model1&lt;-cphGM(formula=Surv(time,status)~X1+X2,
fterm=c('gamma','id'),Time="time",status="status",
id="id",data=simulated_data,bhdist='weibull')
print(model1)
##

</code></pre>

<hr>
<h2 id='simfdata'>simulation of survival data</h2><span id='topic+simfdata'></span>

<h3>Description</h3>

<p>function for simulation of survival data assuming the data comes from a parametric coxph model with gamma frailty distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simfdata(n, beta, fvar, bhdist = "weibull", X, fdist = "gamma", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simfdata_+3A_n">n</code></td>
<td>
<p>number of individual</p>
</td></tr>
<tr><td><code id="simfdata_+3A_beta">beta</code></td>
<td>
<p>vector of regression coefficient for coxph model</p>
</td></tr>
<tr><td><code id="simfdata_+3A_fvar">fvar</code></td>
<td>
<p>frailty variance value(currently the function works for gamma frailty only)</p>
</td></tr>
<tr><td><code id="simfdata_+3A_bhdist">bhdist</code></td>
<td>
<p>distribution of survival time at baseline e.g. &quot;weibull&quot;,&quot;exponential&quot;,&quot;llogistic&quot;</p>
</td></tr>
<tr><td><code id="simfdata_+3A_x">X</code></td>
<td>
<p>model matrix for the coxPH model with particular choice of beta</p>
</td></tr>
<tr><td><code id="simfdata_+3A_fdist">fdist</code></td>
<td>
<p>distribution of frailty terms e.g. &quot;gamma&quot;</p>
</td></tr>
<tr><td><code id="simfdata_+3A_...">...</code></td>
<td>
<p>user can assume the shape and scale parameter of baseline survival distribution</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The process for simulation of multistate survival data is described in our manuscript. As the process includes transition through different states and it involves simulating survival time in different transition. So we have demonstrated the code for simulation of simple survival model.
Suppose we want to simulate a survival data with parametric baseline hazard and parametric frailty model. The hazard model is as follows:
</p>
<p style="text-align: center;"><code class="reqn">h_i(t)=z_ih_0(t)exp(\textbf{x}_i\beta)\;;i=1,2,3,...,n</code>
</p>

<p>where the baseline survival time follow Weibull distribution and the hazard is
</p>
<p style="text-align: center;"><code class="reqn">h_0(t)=\rho \lambda t^{\rho-1}</code>
</p>
<p>. Similarly we can have Gompertz, log logistic distribution. The following are the formula for hazard and cummulative hazard function
For exponential: <code class="reqn">h_0(t)=\lambda</code> and <code class="reqn">H_0(t)=\lambda t</code>\;<code class="reqn">\lambda&gt;0</code>
Gompertz: <code class="reqn">h_0(t)=\lambda exp(\gamma t)</code> and <code class="reqn">H_0(t)=\frac{\lambda}{\gamma}(exp(\gamma t)-1)</code>;<code class="reqn">\lambda,\gamma&gt;0</code>
</p>


<h3>Value</h3>

<p>simulated survival data for a single transition
</p>


<h3>Author(s)</h3>

<p>Atanu Bhattacharjee, Bhrigu Kumar Rajbongshi and Gajendra K. Vishwakarma
</p>


<h3>References</h3>

<p>Vishwakarma, G. K., Bhattacherjee, A., Rajbongshi, B. K., &amp; Tripathy, A. (2024). Censored imputation of time to event outcome through survival proximity score method. <em>Journal of Computational and Applied Mathematics</em>, 116103;
</p>
<p>Bhattacharjee, A., Vishwakarma, G. K., Tripathy, A., &amp; Rajbongshi, B. K. (2024). Competing risk multistate censored data modeling by propensity score matching method. <em>Scientific Reports</em>, 14(1), 4368.
</p>


<h3>See Also</h3>

<p><a href="#topic+cphGM">cphGM</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
##
n1&lt;-1000
p1&lt;-2
X1&lt;-matrix(rnorm(n1*p1),n1,p1)
simulated_data&lt;-simfdata(n=1000,beta=c(0.5,0.5),fvar=0.5,
X=X1)
##

</code></pre>

<hr>
<h2 id='simulated_data'>Simulated multistate data</h2><span id='topic+simulated_data'></span>

<h3>Description</h3>

<p>A simulated multi state dataset used for demonstration purpose.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(simulated_data)
</code></pre>


<h3>Format</h3>

<p>a tibble of 13 columns and 2204 observations,
</p>

<dl>
<dt>id</dt><dd><p>id value for subjects</p>
</dd>
<dt>status</dt><dd><p>survival status</p>
</dd>
<dt>time</dt><dd><p>survival time</p>
</dd>
<dt>x1</dt><dd><p>Numeric covariate</p>
</dd>
<dt>x2</dt><dd><p>Numeric covariate</p>
</dd>
<dt>x3</dt><dd><p>Numeric covariate</p>
</dd>
<dt>x4</dt><dd><p>Numeric covariate</p>
</dd>
</dl>



<h3>References</h3>

<p>Vishwakarma, G. K., Bhattacherjee, A., Rajbongshi, B. K., &amp; Tripathy, A. (2024). Censored imputation of time to event outcome through survival proximity score method. Journal of Computational and Applied Mathematics, 116103;
</p>
<p>Bhattacharjee, A., Vishwakarma, G. K., Tripathy, A., &amp; Rajbongshi, B. K. (2024). Competing risk multistate censored data modeling by propensity score matching method. Scientific Reports, 14(1), 4368.
</p>

<hr>
<h2 id='weibulbh'>Weibull baseline hazard</h2><span id='topic+weibulbh'></span>

<h3>Description</h3>

<p>Weibull baseline hazard
</p>


<h3>Usage</h3>

<pre><code class='language-R'>weibulbh(t, shape = 2, scale = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="weibulbh_+3A_t">t</code></td>
<td>
<p>time</p>
</td></tr>
<tr><td><code id="weibulbh_+3A_shape">shape</code></td>
<td>
<p>shape parameter</p>
</td></tr>
<tr><td><code id="weibulbh_+3A_scale">scale</code></td>
<td>
<p>scale parameter</p>
</td></tr>
</table>


<h3>Value</h3>

<p>hazard function value under Weibull distibution
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
