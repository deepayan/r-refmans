<!DOCTYPE html><html><head><title>Help for package ampd</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ampd}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#AMPD'><p>AMPD</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>An Algorithm for Automatic Peak Detection in Noisy Periodic and
Quasi-Periodic Signals</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2</td>
</tr>
<tr>
<td>Author:</td>
<td>Felix Scholkmann &lt;felix.scholkmann@gmail.com&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Oliver Sieber &lt;oliver.sieber@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>A method for automatic detection of peaks in noisy periodic and quasi-periodic signals. This method, called automatic multiscale-based peak detection (AMPD), is based on the calculation and analysis of the local maxima scalogram, a matrix comprising the scale-dependent occurrences of local maxima.
     For further information see  &lt;<a href="https://doi.org/10.3390%2Fa5040588">doi:10.3390/a5040588</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>5.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2016-12-11 12:25:24 UTC; oliver</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2016-12-11 16:37:19</td>
</tr>
</table>
<hr>
<h2 id='AMPD'>AMPD</h2><span id='topic+AMPD'></span>

<h3>Description</h3>

<p>Implementation of the automatic multiscale-based peak detection (AMPD) algorithm.
AMPD enables to detect peaks in noisy periodic and quasi-periodic signals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AMPD(data, L = NaN, extended = FALSE, splitting = FALSE,
  splittingSize = NaN)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AMPD_+3A_data">data</code></td>
<td>
<p>list containing noisy data with quasi-periodic distribution of local maxima</p>
</td></tr>
<tr><td><code id="AMPD_+3A_l">L</code></td>
<td>
<p>maximum number of scales (corresponding to the maximum width of the window used)</p>
</td></tr>
<tr><td><code id="AMPD_+3A_extended">extended</code></td>
<td>
<p>default FALSE, if TRUE it uses an optimzed algorithm, which is capable to detect Maxima at the beginning and/or the end of the data. This was a bottleneck for the old algorithm. FALSE uses the traditional method.</p>
</td></tr>
<tr><td><code id="AMPD_+3A_splitting">splitting</code></td>
<td>
<p>default FALSE, splits the data vector to achieve better computation performance. However, with this option, no other parameter than the positions of the maxima will be returned</p>
</td></tr>
<tr><td><code id="AMPD_+3A_splittingsize">splittingSize</code></td>
<td>
<p>default NaN, it is recommended to specify a splitting size, otherwise a splitting size of 5000 is used. The splitting size is adapted anyway, so that at least 10 local maxima are included.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with different variables: LMS ($LMS), rescaled LMS ($rLMS), position of global minimum of the row-wise summation of LMS ($minLoc), position of maxima ($maximaLoc). Note that for big data vectors, only the positions of the local maxima will be returned. The others remain empty.
</p>


<h3>References</h3>

<p>Scholkmann et al. (2012). An Efficient Algorithm for Automatic Peak Detection in Noisy Periodic and Quasi-Periodic Signals. Algorithms, 5 (4), 588-603 http://www.mdpi.com/1999-4893/5/4/588
</p>


<h3>Examples</h3>

<pre><code class='language-R'>t = seq(0,2,0.005)
data = sin(25*t)*sin(0.3*t)+0.4*t
dataNoise = jitter(data,1000)
result = AMPD(dataNoise)
result2 = AMPD(dataNoise, extended=TRUE)
par(mfrow=c(1,2))
plot(dataNoise, main="traditional algorithm", type="l")
points(result$maximaLoc, dataNoise[result$maximaLoc],col="red")
plot(dataNoise, main="extended algorithm", type="l")
points(result2$maximaLoc, dataNoise[result2$maximaLoc],col="red")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
