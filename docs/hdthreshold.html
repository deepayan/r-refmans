<!DOCTYPE html><html lang="en"><head><title>Help for package hdthreshold</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {hdthreshold}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#K'><p>Uniform kernel function</p></a></li>
<li><a href='#MAinf_normal'><p>Simulate an MA infinity process with algrebraic decay</p></a></li>
<li><a href='#simulation.derivative'><p>Monte Carlo simulation for existence of derivative threshold effects under known threshold location</p></a></li>
<li><a href='#simulation.hetero'><p>Monte Carlo simulation for heterogeneity of threshold effects under known threshold location</p></a></li>
<li><a href='#simulation.pooled'><p>Monte Carlo simulation for pooled test of existence of threshold effects</p></a></li>
<li><a href='#simulation.threshold'><p>Monte Carlo simulation for existence of threshold effects under known threshold location</p></a></li>
<li><a href='#simulation.unknown'><p>Monte Carlo simulation for uniform test of existence of threshold effects under unknown threshold location</p></a></li>
<li><a href='#threshold.derivative.test'><p>Uniform test for existence of derivative threshold effects</p></a></li>
<li><a href='#threshold.example'><p>Simulate an example data frame</p></a></li>
<li><a href='#threshold.heterogeneity.test'><p>Uniform test for heterogeneity of threshold effects</p></a></li>
<li><a href='#threshold.test'><p>Uniform test for existence of threshold effects</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Inference on Many Jumps in Nonparametric Panel Regression Models</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides uniform testing procedures for existence and heterogeneity of threshold 
    effects in high-dimensional nonparametric panel regression models. The package accompanies
    the paper Chen, Keilbar, Su and Wang (2023) "Inference on many jumps in nonparametric panel
    regression models". arXiv preprint &lt;<a href="https://doi.org/10.48550%2FarXiv.2312.01162">doi:10.48550/arXiv.2312.01162</a>&gt;.</td>
</tr>
<tr>
<td>Imports:</td>
<td>fdrtool, KernSmooth, rdrobust, stats</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-12-20 16:39:58 UTC; georg</td>
</tr>
<tr>
<td>Author:</td>
<td>Georg Keilbar [aut, cre, cph],
  Likai Chen [ctb],
  Liangjun Su [ctb],
  Weining Wang [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Georg Keilbar &lt;georg.keilbar@hu-berlin.de&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-12-23 10:50:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='K'>Uniform kernel function</h2><span id='topic+K'></span>

<h3>Description</h3>

<p>Uniform kernel function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>K(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="K_+3A_x">x</code></td>
<td>
<p>a vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of values
</p>


<h3>Examples</h3>

<pre><code class='language-R'>K(0)
</code></pre>

<hr>
<h2 id='MAinf_normal'>Simulate an MA infinity process with algrebraic decay</h2><span id='topic+MAinf_normal'></span>

<h3>Description</h3>

<p>Simulate an MA infinity process with algrebraic decay
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MAinf_normal(N, beta)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MAinf_normal_+3A_n">N</code></td>
<td>
<p>sample size</p>
</td></tr>
<tr><td><code id="MAinf_normal_+3A_beta">beta</code></td>
<td>
<p>algebraic decay parameter</p>
</td></tr>
</table>


<h3>Value</h3>

<p>simulated MA infinity process
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x = MAinf_normal(100, 1.5)
</code></pre>

<hr>
<h2 id='simulation.derivative'>Monte Carlo simulation for existence of derivative threshold effects under known threshold location</h2><span id='topic+simulation.derivative'></span>

<h3>Description</h3>

<p>Monte Carlo simulation to study the size and power properties of the uniform test
for existence of threshold effects in the first derivative under known threshold locations. Provides the Monte Carlo
distribution of the test statistic and empirical rejection probabilities at 10%, 5% and 1% level.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulation.derivative(
  N,
  TL,
  p,
  M,
  epsilon = c("iid", "factor"),
  running = c("iid", "factor"),
  hetero = c(0, 1)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simulation.derivative_+3A_n">N</code></td>
<td>
<p>cross-sectional dimension</p>
</td></tr>
<tr><td><code id="simulation.derivative_+3A_tl">TL</code></td>
<td>
<p>time series length</p>
</td></tr>
<tr><td><code id="simulation.derivative_+3A_p">p</code></td>
<td>
<p>fraction of non-zero coefficients</p>
</td></tr>
<tr><td><code id="simulation.derivative_+3A_m">M</code></td>
<td>
<p>number of Monte Carlo runs</p>
</td></tr>
<tr><td><code id="simulation.derivative_+3A_epsilon">epsilon</code></td>
<td>
<p>specification of error term. If <code>"iid"</code> is selected the error term is iid standard normal.
If <code>"factor"</code> is selected, the error term follows a factor model with strong cross-sectional and weak
temporal dependence.</p>
</td></tr>
<tr><td><code id="simulation.derivative_+3A_running">running</code></td>
<td>
<p>specification of running variable. If <code>"iid"</code> is selected the running variable is iid uniformly
distributed. If <code>"factor"</code> is selected, the running variable follows a factor model with strong cross-sectional and weak
temporal dependence.</p>
</td></tr>
<tr><td><code id="simulation.derivative_+3A_hetero">hetero</code></td>
<td>
<p>if <code>hetero=1</code> the error term is heteroskedastic, if <code>hetero=0</code> the error term is homoskedastic.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the value of the test statistic for each Monte Carlo run and the
empirical rejection rate for a 10%, 5% and 1% confidence level.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>result_derivative = simulation.derivative(10, 200, 0, 10, epsilon = "iid",
                    running = "iid", hetero = 0)
</code></pre>

<hr>
<h2 id='simulation.hetero'>Monte Carlo simulation for heterogeneity of threshold effects under known threshold location</h2><span id='topic+simulation.hetero'></span>

<h3>Description</h3>

<p>Monte Carlo simulation to study the size and power properties of the uniform test
for heterogeneity of threshold effects under known threshold locations. Provides the Monte Carlo
distribution of the test statistic and empirical rejection probabilities at 10%, 5% and 1% level.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulation.hetero(
  N,
  TL,
  p,
  M,
  epsilon = c("iid", "factor"),
  running = c("iid", "factor"),
  hetero = c(0, 1)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simulation.hetero_+3A_n">N</code></td>
<td>
<p>cross-sectional dimension</p>
</td></tr>
<tr><td><code id="simulation.hetero_+3A_tl">TL</code></td>
<td>
<p>time series length</p>
</td></tr>
<tr><td><code id="simulation.hetero_+3A_p">p</code></td>
<td>
<p>fraction of non-zero coefficients</p>
</td></tr>
<tr><td><code id="simulation.hetero_+3A_m">M</code></td>
<td>
<p>number of Monte Carlo runs</p>
</td></tr>
<tr><td><code id="simulation.hetero_+3A_epsilon">epsilon</code></td>
<td>
<p>specification of error term. If <code>"iid"</code> is selected the error term is iid standard normal.
If <code>"factor"</code> is selected, the error term follows a factor model with strong cross-sectional and weak
temporal dependence.</p>
</td></tr>
<tr><td><code id="simulation.hetero_+3A_running">running</code></td>
<td>
<p>specification of running variable. If <code>"iid"</code> is selected the running variable is iid uniformly
distributed. If <code>"factor"</code> is selected, the running variable follows a factor model with strong cross-sectional and weak
temporal dependence.</p>
</td></tr>
<tr><td><code id="simulation.hetero_+3A_hetero">hetero</code></td>
<td>
<p>if <code>hetero=1</code> the error term is heteroskedastic, if <code>hetero=0</code> the error term is homoskedastic.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the value of the test statistic for each Monte Carlo run and the
empirical rejection rate for a 10%, 5% and 1% confidence level.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>result_hetero = simulation.hetero(10, 200, 0, 10, epsilon = "iid",
                running = "iid", hetero = 0)
</code></pre>

<hr>
<h2 id='simulation.pooled'>Monte Carlo simulation for pooled test of existence of threshold effects</h2><span id='topic+simulation.pooled'></span>

<h3>Description</h3>

<p>Monte Carlo simulation to study the size and power properties of the pooled test
for existence of threshold effects under unknown threshold locations. The pooled test can
be based on a nonparametric regression model or a linear panel threshold regression model.
Provides the Monte Carlo distribution of the test statistic and empirical rejection probabilities
at 10%, 5% and 1% level.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulation.pooled(
  N,
  TL,
  p,
  M,
  epsilon = c("iid", "factor"),
  running = c("iid", "factor"),
  hetero = c(0, 1),
  threshold = c("uniform", "exponential", "gaussian"),
  method = c("parametric", "nonparametric")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simulation.pooled_+3A_n">N</code></td>
<td>
<p>cross-sectional dimension</p>
</td></tr>
<tr><td><code id="simulation.pooled_+3A_tl">TL</code></td>
<td>
<p>time series length</p>
</td></tr>
<tr><td><code id="simulation.pooled_+3A_p">p</code></td>
<td>
<p>fraction of non-zero coefficients</p>
</td></tr>
<tr><td><code id="simulation.pooled_+3A_m">M</code></td>
<td>
<p>number of Monte Carlo runs</p>
</td></tr>
<tr><td><code id="simulation.pooled_+3A_epsilon">epsilon</code></td>
<td>
<p>specification of error term. If <code>"iid"</code> is selected the error term is iid standard normal.
If <code>"factor"</code> is selected, the error term follows a factor model with strong cross-sectional and weak
temporal dependence.</p>
</td></tr>
<tr><td><code id="simulation.pooled_+3A_running">running</code></td>
<td>
<p>specification of running variable. If <code>"iid"</code> is selected the running variable is iid uniformly
distributed. If <code>"factor"</code> is selected, the running variable follows a factor model with strong cross-sectional and weak
temporal dependence.</p>
</td></tr>
<tr><td><code id="simulation.pooled_+3A_hetero">hetero</code></td>
<td>
<p>if <code>hetero=1</code> the error term is heteroskedastic, if <code>hetero=0</code> the error term is homoskedastic.</p>
</td></tr>
<tr><td><code id="simulation.pooled_+3A_threshold">threshold</code></td>
<td>
<p>specifies the distribution for the non-zero threshold coefficients, possible values are <code>"normal"</code> for the
standard normel, <code>"exponential"</code> for an exponential distribution with parameter 1, or <code>"uniform"</code> for a uniform distribution.</p>
</td></tr>
<tr><td><code id="simulation.pooled_+3A_method">method</code></td>
<td>
<p>method of estimation (<code>"nonparametric"</code> vs. <code>"parametric"</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the value of the test statistic for each Monte Carlo run and the
empirical rejection rate for a 10%, 5% and 1% confidence level.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>result_pooled = simulation.pooled(5, 400, 0, 10, epsilon = "iid", running = "iid",
                hetero = 0, threshold = "gaussian", method = "nonparametric")
</code></pre>

<hr>
<h2 id='simulation.threshold'>Monte Carlo simulation for existence of threshold effects under known threshold location</h2><span id='topic+simulation.threshold'></span>

<h3>Description</h3>

<p>Monte Carlo simulation to study the size and power properties of the uniform test
for existence of threshold effects under known threshold locations. Provides the Monte Carlo
distribution of the test statistic and empirical rejection probabilities at 10%, 5% and 1% level.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulation.threshold(
  N,
  TL,
  p,
  M,
  epsilon = c("iid", "factor"),
  running = c("iid", "factor"),
  hetero = c(0, 1)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simulation.threshold_+3A_n">N</code></td>
<td>
<p>cross-sectional dimension</p>
</td></tr>
<tr><td><code id="simulation.threshold_+3A_tl">TL</code></td>
<td>
<p>time series length</p>
</td></tr>
<tr><td><code id="simulation.threshold_+3A_p">p</code></td>
<td>
<p>fraction of non-zero coefficients</p>
</td></tr>
<tr><td><code id="simulation.threshold_+3A_m">M</code></td>
<td>
<p>number of Monte Carlo runs</p>
</td></tr>
<tr><td><code id="simulation.threshold_+3A_epsilon">epsilon</code></td>
<td>
<p>specification of error term. If <code>"iid"</code> is selected the error term is iid standard normal.
If <code>"factor"</code> is selected, the error term follows a factor model with strong cross-sectional and weak
temporal dependence.</p>
</td></tr>
<tr><td><code id="simulation.threshold_+3A_running">running</code></td>
<td>
<p>specification of running variable. If <code>"iid"</code> is selected the running variable is iid uniformly
distributed. If <code>"factor"</code> is selected, the running variable follows a factor model with strong cross-sectional and weak
temporal dependence.</p>
</td></tr>
<tr><td><code id="simulation.threshold_+3A_hetero">hetero</code></td>
<td>
<p>if <code>hetero=1</code> the error term is heteroskedastic, if <code>hetero=0</code> the error term is homoskedastic.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the value of the test statistic for each Monte Carlo run and the
empirical rejection rate for a 10%, 5% and 1% confidence level.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>result_threshold = simulation.threshold(10, 200, 0, 10, epsilon = "iid",
                   running = "iid", hetero = 0)
</code></pre>

<hr>
<h2 id='simulation.unknown'>Monte Carlo simulation for uniform test of existence of threshold effects under unknown threshold location</h2><span id='topic+simulation.unknown'></span>

<h3>Description</h3>

<p>Monte Carlo simulation to study the size and power properties of the uniform test
for existence of threshold effects under unknown threshold locations. Provides the Monte Carlo
distribution of the test statistic and empirical rejection probabilities at 10%, 5% and 1% level.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulation.unknown(
  N,
  TL,
  p,
  M,
  epsilon = c("iid", "factor"),
  running = c("iid", "factor"),
  hetero = c(0, 1),
  threshold = c("uniform", "exponential", "gaussian")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simulation.unknown_+3A_n">N</code></td>
<td>
<p>cross-sectional dimension</p>
</td></tr>
<tr><td><code id="simulation.unknown_+3A_tl">TL</code></td>
<td>
<p>time series length</p>
</td></tr>
<tr><td><code id="simulation.unknown_+3A_p">p</code></td>
<td>
<p>fraction of non-zero coefficients</p>
</td></tr>
<tr><td><code id="simulation.unknown_+3A_m">M</code></td>
<td>
<p>number of Monte Carlo runs</p>
</td></tr>
<tr><td><code id="simulation.unknown_+3A_epsilon">epsilon</code></td>
<td>
<p>specification of error term. If <code>"iid"</code> is selected the error term is iid standard normal.
If <code>"factor"</code> is selected, the error term follows a factor model with strong cross-sectional and weak
temporal dependence.</p>
</td></tr>
<tr><td><code id="simulation.unknown_+3A_running">running</code></td>
<td>
<p>specification of running variable. If <code>"iid"</code> is selected the running variable is iid uniformly
distributed. If <code>"factor"</code> is selected, the running variable follows a factor model with strong cross-sectional and weak
temporal dependence.</p>
</td></tr>
<tr><td><code id="simulation.unknown_+3A_hetero">hetero</code></td>
<td>
<p>if <code>hetero=1</code> the error term is heteroskedastic, if <code>hetero=0</code> the error term is homoskedastic.</p>
</td></tr>
<tr><td><code id="simulation.unknown_+3A_threshold">threshold</code></td>
<td>
<p>specifies the distribution for the non-zero threshold coefficients, possible values are <code>"normal"</code> for the
standard normel, <code>"exponential"</code> for an exponential distribution with parameter 1, or <code>"uniform"</code> for a uniform distribution.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the value of the test statistic for each Monte Carlo run and the
empirical rejection rate for a 10%, 5% and 1% confidence level.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>result_unknown = simulation.unknown(2, 800, 0, 10, epsilon = "iid", running = "iid",
                 hetero = 0, threshold = "gaussian")
</code></pre>

<hr>
<h2 id='threshold.derivative.test'>Uniform test for existence of derivative threshold effects</h2><span id='topic+threshold.derivative.test'></span>

<h3>Description</h3>

<p>Uniform test for existence of threshold effects in the first derivative for nonparametric panel regressions. Both the
known and unknown threshold location case are covered. Apart from the uniform test statistic and
the corresponding p-value, a table for the results of the individual threshold estimates and test statistics
is provided.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>threshold.derivative.test(
  data,
  response,
  running,
  id,
  bw = NULL,
  C = 0,
  alpha = NULL,
  alternative = "two"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="threshold.derivative.test_+3A_data">data</code></td>
<td>
<p>a data frame containing the response, running and id variables</p>
</td></tr>
<tr><td><code id="threshold.derivative.test_+3A_response">response</code></td>
<td>
<p>name of the dependent variable (aka response variable)</p>
</td></tr>
<tr><td><code id="threshold.derivative.test_+3A_running">running</code></td>
<td>
<p>name of the running variable (aka forcing variable)</p>
</td></tr>
<tr><td><code id="threshold.derivative.test_+3A_id">id</code></td>
<td>
<p>name of the id variable</p>
</td></tr>
<tr><td><code id="threshold.derivative.test_+3A_bw">bw</code></td>
<td>
<p>an optional scalar bandwidth parameter for the local linear estimation. If not specified, the bandwidth
is selected by the command <code><a href="rdrobust.html#topic+rdbwselect">rdrobust::rdbwselect()</a></code>.</p>
</td></tr>
<tr><td><code id="threshold.derivative.test_+3A_c">C</code></td>
<td>
<p>a scalar value for the true threshold location (for the known case) or a grid of candidate threshold locations
(for the unknown case)</p>
</td></tr>
<tr><td><code id="threshold.derivative.test_+3A_alpha">alpha</code></td>
<td>
<p>specifies a threshold to determine which and how many individual-specific threshold effects and test
statistics are displayed in the output table. Only individuals which are significant at the alpha confidence level are selected.</p>
</td></tr>
<tr><td><code id="threshold.derivative.test_+3A_alternative">alternative</code></td>
<td>
<p>specifies whether we consider a two-sided alternative (default) or left-/right-sided alternative.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:</p>

<table>
<tr>
 <td style="text-align: left;">
<code>I_hat</code> </td><td style="text-align: left;"> the value of the uniform test statistic </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>p_value</code> </td><td style="text-align: left;"> the corresponding p-value </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>N</code> </td><td style="text-align: left;"> the cross-sectional dimension </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Critical_values</code> </td><td style="text-align: left;"> critical values at 10%, 5%, 1%, and 0.1% confidence level </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Table</code> </td><td style="text-align: left;"> a table displaying the estimation result for a selection of individuals, including the id variable, the threshold location,
the estimated coefficient, the estimated standard error, and the individual test statistic. </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>See Also</h3>

<p><code><a href="#topic+threshold.example">threshold.example()</a></code>, <code><a href="rdrobust.html#topic+rdbwselect">rdrobust::rdbwselect()</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d = threshold.example(10, 200, 0.1, 2)
threshold.derivative.test(data = d, response = "y", running = "x", id = "id", C = 0)
</code></pre>

<hr>
<h2 id='threshold.example'>Simulate an example data frame</h2><span id='topic+threshold.example'></span>

<h3>Description</h3>

<p>Simulate an example data frame
</p>


<h3>Usage</h3>

<pre><code class='language-R'>threshold.example(N, TL, p, gamma)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="threshold.example_+3A_n">N</code></td>
<td>
<p>cross-sectional dimension</p>
</td></tr>
<tr><td><code id="threshold.example_+3A_tl">TL</code></td>
<td>
<p>time series length</p>
</td></tr>
<tr><td><code id="threshold.example_+3A_p">p</code></td>
<td>
<p>fraction of non-zero coefficients</p>
</td></tr>
<tr><td><code id="threshold.example_+3A_gamma">gamma</code></td>
<td>
<p>value of non-zero coefficients</p>
</td></tr>
</table>


<h3>Value</h3>

<p>simulated data frame
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d = threshold.example(10, 200, 0.1, 2)
</code></pre>

<hr>
<h2 id='threshold.heterogeneity.test'>Uniform test for heterogeneity of threshold effects</h2><span id='topic+threshold.heterogeneity.test'></span>

<h3>Description</h3>

<p>Uniform test for heterogeneity of threshold effects in a nonparametric panel regression under known threshold locations.
Apart from the uniform test statistic and the corresponding p-value, a table for the results of the individual threshold
estimates and test statistics is provided.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>threshold.heterogeneity.test(
  data,
  response,
  running,
  id,
  bw = NULL,
  c = 0,
  alpha = NULL,
  alternative = "two",
  use.median = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="threshold.heterogeneity.test_+3A_data">data</code></td>
<td>
<p>a data frame containing the response, running and id variables</p>
</td></tr>
<tr><td><code id="threshold.heterogeneity.test_+3A_response">response</code></td>
<td>
<p>name of the dependent variable (aka response variable)</p>
</td></tr>
<tr><td><code id="threshold.heterogeneity.test_+3A_running">running</code></td>
<td>
<p>name of the running variable (aka forcing variable)</p>
</td></tr>
<tr><td><code id="threshold.heterogeneity.test_+3A_id">id</code></td>
<td>
<p>name of the id variable</p>
</td></tr>
<tr><td><code id="threshold.heterogeneity.test_+3A_bw">bw</code></td>
<td>
<p>an optional scalar bandwidth parameter for the local linear estimation. If not specified, the bandwidth
is selected by the command <code><a href="rdrobust.html#topic+rdbwselect">rdrobust::rdbwselect()</a></code>.</p>
</td></tr>
<tr><td><code id="threshold.heterogeneity.test_+3A_c">c</code></td>
<td>
<p>a scalar value for the true threshold location</p>
</td></tr>
<tr><td><code id="threshold.heterogeneity.test_+3A_alpha">alpha</code></td>
<td>
<p>specifies a threshold to determine which and how many individual-specific threshold effects and test
statistics are displayed in the output table. Only individuals which are significant at the alpha confidence level are selected.</p>
</td></tr>
<tr><td><code id="threshold.heterogeneity.test_+3A_alternative">alternative</code></td>
<td>
<p>specifies whether we consider a two-sided alternative (default) or left-/right-sided alternative.</p>
</td></tr>
<tr><td><code id="threshold.heterogeneity.test_+3A_use.median">use.median</code></td>
<td>
<p>if <code>TRUE</code>, the median replaces the mean as a robust alternative in the test for heterogeneity</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:</p>

<table>
<tr>
 <td style="text-align: left;">
<code>Q_hat</code> </td><td style="text-align: left;"> the value of the uniform test statistic </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>p_value</code> </td><td style="text-align: left;"> the corresponding p-value </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>N</code> </td><td style="text-align: left;"> the cross-sectional dimension </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Critical_values</code> </td><td style="text-align: left;"> critical values at 10%, 5%, 1%, and 0.1% confidence level </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Table</code> </td><td style="text-align: left;"> a table displaying the estimation result for a selection of individuals, including the id variable, the threshold location,
the estimated coefficient, the estimated standard error, and the individual test statistic. </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>See Also</h3>

<p><code><a href="#topic+threshold.example">threshold.example()</a></code>, <code><a href="rdrobust.html#topic+rdbwselect">rdrobust::rdbwselect()</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d = threshold.example(10, 200, 0.1, 2)
threshold.heterogeneity.test(data = d, response = "y", running = "x", id = "id", c = 0)
</code></pre>

<hr>
<h2 id='threshold.test'>Uniform test for existence of threshold effects</h2><span id='topic+threshold.test'></span>

<h3>Description</h3>

<p>Uniform test for existence of threshold effects in a nonparametric panel regression. Both the
known and unknown threshold location case are covered. Apart from the uniform test statistic and
the corresponding p-value, a table for the results of the individual threshold estimates and test statistics
is provided.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>threshold.test(
  data,
  response,
  running,
  id,
  bw = NULL,
  C = 0,
  alpha = NULL,
  alternative = "two"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="threshold.test_+3A_data">data</code></td>
<td>
<p>a data frame containing the response, running and id variables</p>
</td></tr>
<tr><td><code id="threshold.test_+3A_response">response</code></td>
<td>
<p>name of the dependent variable (aka response variable)</p>
</td></tr>
<tr><td><code id="threshold.test_+3A_running">running</code></td>
<td>
<p>name of the running variable (aka forcing variable)</p>
</td></tr>
<tr><td><code id="threshold.test_+3A_id">id</code></td>
<td>
<p>name of the id variable</p>
</td></tr>
<tr><td><code id="threshold.test_+3A_bw">bw</code></td>
<td>
<p>an optional scalar bandwidth parameter for the local linear estimation. If not specified, the bandwidth
is selected by the command <code><a href="rdrobust.html#topic+rdbwselect">rdrobust::rdbwselect()</a></code>.</p>
</td></tr>
<tr><td><code id="threshold.test_+3A_c">C</code></td>
<td>
<p>a scalar value for the true threshold location (for the known case) or a grid of candidate threshold locations
(for the unknown case)</p>
</td></tr>
<tr><td><code id="threshold.test_+3A_alpha">alpha</code></td>
<td>
<p>specifies a threshold to determine which and how many individual-specific threshold effects and test
statistics are displayed in the output table. Only individuals which are significant at the alpha confidence level are selected.</p>
</td></tr>
<tr><td><code id="threshold.test_+3A_alternative">alternative</code></td>
<td>
<p>specifies whether we consider a two-sided alternative (default) or left-/right-sided alternative.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:</p>

<table>
<tr>
 <td style="text-align: left;">
<code>I_hat</code> </td><td style="text-align: left;"> the value of the uniform test statistic </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>p_value</code> </td><td style="text-align: left;"> the corresponding p-value </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>N</code> </td><td style="text-align: left;"> the cross-sectional dimension </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Critical_values</code> </td><td style="text-align: left;"> critical values at 10%, 5%, 1%, and 0.1% confidence level </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Table</code> </td><td style="text-align: left;"> a table displaying the estimation result for a selection of individuals, including the id variable, the threshold location,
the estimated coefficient, the estimated standard error, and the individual test statistic. </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>See Also</h3>

<p><code><a href="#topic+threshold.example">threshold.example()</a></code>, <code><a href="rdrobust.html#topic+rdbwselect">rdrobust::rdbwselect()</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d = threshold.example(10, 200, 0.1, 2)
threshold.test(data = d, response = "y", running = "x", id = "id", C = 0)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
