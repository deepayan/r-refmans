<!DOCTYPE html><html><head><title>Help for package secuTrialR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {secuTrialR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#annual_recruitment'><p>Returns a data.frame showing the annual recruitment per center</p></a></li>
<li><a href='#as.data.frame.secuTrialdata'><p>as.data.frame method for secuTrialdata objects</p>
Make the data from the exports more easily accessible by placing them in
another environment (e.g. place them in the global environment
(<code>.GlobalEnv</code>) and you can reference them without referring to the
<code>secuTrialdata</code> object anymore. Ie. they become regular <code>data.frame</code>s).</a></li>
<li><a href='#assess_form_variable_completeness'><p>Asses completeness of data for each variable in a secuTrial export</p></a></li>
<li><a href='#build_secuTrial_url'><p>Compose a secuTrial URL</p></a></li>
<li><a href='#check_export_options'><p>Returns deviations from suggested export options</p></a></li>
<li><a href='#dates_secuTrial'><p>Methods to handle date(times)s in secuTrial exports</p></a></li>
<li><a href='#dictionary_secuTrial'><p>Data dictionary for secuTrialdata objects</p></a></li>
<li><a href='#diff_secuTrial'><p>Returns differences in the setup of two <code>secuTrialdata</code> objects</p></a></li>
<li><a href='#export_datetime'><p>Return the date and time that an export was performed</p></a></li>
<li><a href='#factorize'><p>Add factors to <code>secuTrialdata</code> objects</p></a></li>
<li><a href='#form_status_counts'><p>A function to assess the status of forms</p></a></li>
<li><a href='#form_status_summary'><p>A function to show summary statistics for form statuses</p></a></li>
<li><a href='#get_participants'><p>Retrieves participants present in <code>secuTrialdata</code></p></a></li>
<li><a href='#labels_secuTrial'><p>Get variable labels for secuTrialdata objects</p></a></li>
<li><a href='#links_secuTrial'><p>Show links between forms</p></a></li>
<li><a href='#plot_recruitment'><p>Plots the recruitment over time for <code>secuTrialdata</code> objects</p></a></li>
<li><a href='#read_secuTrial'><p>Read secuTrial export</p></a></li>
<li><a href='#read_validation_overview'><p>This function loads a multi-page secuTrial 'Validation Overview' report into an R tibble.</p></a></li>
<li><a href='#return_hidden_items'><p>Returns hidden items (variables) from <code>secuTrialdata</code> objects</p></a></li>
<li><a href='#return_random_participants'><p>Returns the random participants from a secuTrial export</p></a></li>
<li><a href='#return_scores'><p>Returns the score (calculated) items from <code>secuTrialdata</code> objects</p></a></li>
<li><a href='#secuTrialdata'><p>This function loads a secuTrial export</p></a></li>
<li><a href='#subset_secuTrial'><p>Subsets a <code>secuTrialdata</code> object</p></a></li>
<li><a href='#visit_structure'><p>Get the visit structure of <code>secuTrialdata</code> objects</p></a></li>
<li><a href='#write_secuTrial'><p>Write secuTrial exports to other formats</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Handling of Data from the Clinical Data Management System
'secuTrial'</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.1</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Alan G. Haynes &lt;alan.haynes@ctu.unibe.ch&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Seamless and standardized interaction with data
    exported from the clinical data management system (CDMS)
    'secuTrial'<a href="https://www.secutrial.com">https://www.secutrial.com</a>.
    The primary data export the package works with is a standard non-rectangular export.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5)</td>
</tr>
<tr>
<td>Imports:</td>
<td>haven (&ge; 2.2.0), readr, readxl, stringr, tibble, magrittr,
purrr, tidyr, dplyr, rlang, lubridate</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, lintr, rmarkdown, testthat, tufte, tcltk, igraph</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/SwissClinicalTrialOrganisation/secuTrialR">https://github.com/SwissClinicalTrialOrganisation/secuTrialR</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/SwissClinicalTrialOrganisation/secuTrialR/issues">https://github.com/SwissClinicalTrialOrganisation/secuTrialR/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-03-02 09:43:06 UTC; haynes</td>
</tr>
<tr>
<td>Author:</td>
<td>Alan G. Haynes [cre, aut, cph],
  Patrick R. Wright [aut, cph],
  Milica Markovic [aut, cph],
  Gilles Dutilh [ctb],
  Armando Lenz [ctb],
  Pascal Benkert [com],
  Silvia Grieder [ctb],
  Pia Neuschwander [ctb],
  Constantin Sluka [ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-03-06 09:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='annual_recruitment'>Returns a data.frame showing the annual recruitment per center</h2><span id='topic+annual_recruitment'></span>

<h3>Description</h3>

<p>secuTrial exports inherently contain the information on which participant was
registered at which point in time. This function makes use of this property
to show annual recruitment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>annual_recruitment(x, rm_regex = "")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="annual_recruitment_+3A_x">x</code></td>
<td>
<p>a <code>secuTrialdata</code> object</p>
</td></tr>
<tr><td><code id="annual_recruitment_+3A_rm_regex">rm_regex</code></td>
<td>
<p>character - specifies a regular expression to be removed from the centre names in the legend.
e.g. rm_regex = &quot;\\(.*\\)$&quot; will remove trailing brackets and their contents.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame showing the annual recruitment counts per center
</p>


<h3>Note</h3>

<p>This function wraps plot_recruitment to retrieve the data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># export location
expot_loc &lt;- system.file("extdata", "sT_exports", "lnames",
                         "s_export_CSV-xls_CTU05_long_ref_miss_en_utf8.zip",
                         package = "secuTrialR")
# read export
sT_export &lt;- read_secuTrial(expot_loc)

# plot recruitment
annual_recruitment(sT_export)

# show without trailing bracket
annual_recruitment(sT_export, rm_regex = "\\(.*\\)$")

</code></pre>

<hr>
<h2 id='as.data.frame.secuTrialdata'>as.data.frame method for secuTrialdata objects
Make the data from the exports more easily accessible by placing them in
another environment (e.g. place them in the global environment
(<code>.GlobalEnv</code>) and you can reference them without referring to the
<code>secuTrialdata</code> object anymore. Ie. they become regular <code>data.frame</code>s).</h2><span id='topic+as.data.frame.secuTrialdata'></span>

<h3>Description</h3>

<p>as.data.frame method for secuTrialdata objects
Make the data from the exports more easily accessible by placing them in
another environment (e.g. place them in the global environment
(<code>.GlobalEnv</code>) and you can reference them without referring to the
<code>secuTrialdata</code> object anymore. Ie. they become regular <code>data.frame</code>s).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'secuTrialdata'
as.data.frame(
  x,
  ...,
  envir,
  data.frames = NULL,
  meta = FALSE,
  regex = NULL,
  rep = ""
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.data.frame.secuTrialdata_+3A_x">x</code></td>
<td>
<p><code>secuTrialdata</code> object</p>
</td></tr>
<tr><td><code id="as.data.frame.secuTrialdata_+3A_...">...</code></td>
<td>
<p>further parameters</p>
</td></tr>
<tr><td><code id="as.data.frame.secuTrialdata_+3A_envir">envir</code></td>
<td>
<p>environment in which to put the data (e.g. <code>.GlobalEnv</code>)</p>
</td></tr>
<tr><td><code id="as.data.frame.secuTrialdata_+3A_data.frames">data.frames</code></td>
<td>
<p>character vector of data.frame names to turn into data.frames.
If the vector is named,data.frames will be renamed into the non-empty names(data.frames)</p>
</td></tr>
<tr><td><code id="as.data.frame.secuTrialdata_+3A_meta">meta</code></td>
<td>
<p>logical should metadata be returned</p>
</td></tr>
<tr><td><code id="as.data.frame.secuTrialdata_+3A_regex">regex</code></td>
<td>
<p>regex syntax to remove from names</p>
</td></tr>
<tr><td><code id="as.data.frame.secuTrialdata_+3A_rep">rep</code></td>
<td>
<p>replacement for regex</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>envir</code> must be specifically defined. For simplicity,
<code>.GlobalEnv</code> would probably be the easiest (assigning it to another
environment would still entail referring to that environment).
</p>


<h3>Value</h3>

<p>each <code>data.frame</code> in the <code>secuTrialdata</code> object is saved to it's
own <code>data.frame</code> in the designated environment
</p>


<h3>Examples</h3>

<pre><code class='language-R'># prepare path to example export
export_location &lt;- system.file("extdata", "sT_exports", "lnames",
                               "s_export_CSV-xls_CTU05_long_ref_miss_en_utf8.zip",
                               package = "secuTrialR")
# load all export data
sT_export &lt;- read_secuTrial_raw(data_dir = export_location)
# add files to a new environment called env1
env1 &lt;- new.env()
as.data.frame(sT_export, envir = env1)
# add files to a new environment called env2, removing the project name from
# the file names
env2 &lt;- new.env()
as.data.frame(sT_export, regex = "ctu05", envir = env2)
# add files to a new environment called env3, renaming files in data.frames
env3 &lt;- new.env()
as.data.frame(sT_export, data.frames = c("allmedications" = "ctu05allmedi", "ctu05baseline"),
              envir = env3)
</code></pre>

<hr>
<h2 id='assess_form_variable_completeness'>Asses completeness of data for each variable in a secuTrial export</h2><span id='topic+assess_form_variable_completeness'></span>

<h3>Description</h3>

<p>NOTE: This is not exported currently since it is not generic enough.
It can still be used but in depth knowledge of the function is required
to evaluate if the result is correct.
As a rule of thumb: rigid CDMA setups with low complexity will likely
work as expected.
</p>
<p>Variable completeness is defined as percentage of data entered for a variable
when considering all occurrences of the variable throughout the visit plan and
all participants registered in the secuTrial data base. The completeness can
be assessed for 'allforms', which will also take unsaved forms into account, and
for 'savedforms' which will only consider forms that have been actively saved.
In order to asses variable completeness the function requires a loaded secuTrial
validation overview and a loaded secuTrial standard export. Both the validation
overview and the data export should be from the same time (not more than minutes
apart if possible) to ensure data integrity.
Variable completeness is considered based on rules in the secuTrial setup. Thus,
if a variable is not marked as necessary for completeness, this variable will
always be considered as 100 percent complete if only 'savedforms' are assessed.
Please note that variable completeness for repetition forms should only be
assessed for saved forms.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>assess_form_variable_completeness(
  form,
  casenodes_table,
  validation_overview,
  completeness = "allforms",
  occ_in_vp = 1,
  omit_mnp = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="assess_form_variable_completeness_+3A_form">form</code></td>
<td>
<p>data.frame Form for which to assess variable completeness
(i.e. a list element returned by read_secuTrial_raw).</p>
</td></tr>
<tr><td><code id="assess_form_variable_completeness_+3A_casenodes_table">casenodes_table</code></td>
<td>
<p>data.frame The central casenodes record file
(i.e. 'casenodes' from the list returned by read_secuTrial_raw).</p>
</td></tr>
<tr><td><code id="assess_form_variable_completeness_+3A_validation_overview">validation_overview</code></td>
<td>
<p>tibble returned by read_validation_overview.</p>
</td></tr>
<tr><td><code id="assess_form_variable_completeness_+3A_completeness">completeness</code></td>
<td>
<p>string Specifies if completeness is assessed for all forms ('allforms')
or only for saved forms ('savedforms').</p>
</td></tr>
<tr><td><code id="assess_form_variable_completeness_+3A_occ_in_vp">occ_in_vp</code></td>
<td>
<p>integer Specifies how often the form occurs in the visit plan
(only relevant if completeness = 'allforms' is set).</p>
</td></tr>
<tr><td><code id="assess_form_variable_completeness_+3A_omit_mnp">omit_mnp</code></td>
<td>
<p>boolean Removes variable names from the result table that start with mnp.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.frame showing percent completeness per variable.
</p>


<h3>See Also</h3>

<p>read_validation_overview, read_secuTrial_raw
</p>


<h3>Examples</h3>

<pre><code class='language-R'># prepare path to example export
export_location &lt;- system.file("extdata", "sT_exports", "BMD",
                               "s_export_CSV-xls_BMD_short_en_utf8.zip",
                               package = "secuTrialR")
# read all export data
sT_export &lt;- read_secuTrial_raw(data_dir = export_location)

# read validation overview
val_ovv_location &lt;- system.file("extdata", "sT_exports", "BMD",
                                "bmd_validation_overview.xlsx",
                                package = "secuTrialR")
val_ovv &lt;- read_validation_overview(data_dir = val_ovv_location)

secuTrialR:::assess_form_variable_completeness(form = sT_export$bmd,
                                               casenodes_table = sT_export$cn,
                                               validation_overview = val_ovv,
                                               completeness = "allforms",
                                               occ_in_vp = 5)

</code></pre>

<hr>
<h2 id='build_secuTrial_url'>Compose a secuTrial URL</h2><span id='topic+build_secuTrial_url'></span>

<h3>Description</h3>

<p>Given a secuTrial server URL, and optionally instance, customer, project id and document id,
this function composes a URL to a specific secuTrial instance, customer or form.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>build_secuTrial_url(
  server,
  instance = NA,
  customer = NA,
  projid = NA,
  docid = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="build_secuTrial_url_+3A_server">server</code></td>
<td>
<p>string containing a server URL</p>
</td></tr>
<tr><td><code id="build_secuTrial_url_+3A_instance">instance</code></td>
<td>
<p>(optional) string containing secuTrial instance name</p>
</td></tr>
<tr><td><code id="build_secuTrial_url_+3A_customer">customer</code></td>
<td>
<p>(optional) string containing secuTrial customer label</p>
</td></tr>
<tr><td><code id="build_secuTrial_url_+3A_projid">projid</code></td>
<td>
<p>(optional) string containing secuTrial project identifier</p>
</td></tr>
<tr><td><code id="build_secuTrial_url_+3A_docid">docid</code></td>
<td>
<p>(optional) secuTrial document/form identifer</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To find the server and instance of a secuTrial database, simply extract the information from the URL that
you usually use to log in. For example in:
</p>
<p><em>https://server.secutrial.com/apps/WebObjects/ST21-setup-DataCapture.woa/wa/choose?customer=TES</em>
</p>

<ul>
<li><p> server id is: <strong>server.secutrial.com</strong>
</p>
</li>
<li><p> instance id is: <strong>ST21-setup-DataCapture</strong>
</p>
</li>
<li><p> you can find the customer id at the end of the link i.e <strong>TES</strong>
</p>
<p>Alternatively it can be found in the
CustomerAdminTool -&gt; click &quot;Kunden&quot; -&gt; Value in DB column of table on login page.
</p>
</li>
<li><p> you can find the project id in the AdminTool -&gt; Projects -&gt; left side ID column in the table.
</p>
</li>
<li><p> you can find docids in secuTrial exports as values in the &quot;mnpdocid&quot; column.
</p>
<p>Alternatively they are noted in the form footers of the DataCapture.
</p>
</li></ul>

<p>Also note that only the server address has to be provided, the other arguments are optional.
Thus, there are different scenarios:
</p>

<ul>
<li><p> if only server address is provided, the output will point to the secuTrial server
</p>
</li>
<li><p> if secuTrial server and instance are provided, the output will point to the secuTrial instance.
</p>
</li>
<li><p> if secutrial server, instance and customer id are provided, the output will point to the customer page.
</p>
</li>
<li><p> if secuTrial server, instance, customer, project and document id are provided,
the output will point to a specific secuTrial form.
</p>
</li></ul>



<h3>Value</h3>

<p>string containing a URL to desired secuTrial page. Currently we provide no
guarantee that the returned URL is valid.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# This example, builds pseudo-urls that do not point to an active secuTrial instance.

server &lt;- "server.secutrial.com"
instance &lt;- "ST21-setup-DataCapture"
customer &lt;- "TES"
project &lt;- "7036"
docid &lt;- "181"

build_secuTrial_url(server)
build_secuTrial_url(server, instance)
build_secuTrial_url(server, instance, customer)
build_secuTrial_url(server, instance, customer, project)
build_secuTrial_url(server, instance, customer, project, docid)

# examples of docids (mnpdocid)
path &lt;- system.file("extdata", "sT_exports", "lnames",
                    "s_export_CSV-xls_CTU05_long_ref_miss_en_utf8.zip",
                    package = "secuTrialR")
sT_export &lt;- read_secuTrial(path)

# return docids
docids &lt;- sT_export$ctu05baseline$mnpdocid

# make several links with all docids
build_secuTrial_url(server, instance, customer, project, docids)

</code></pre>

<hr>
<h2 id='check_export_options'>Returns deviations from suggested export options</h2><span id='topic+check_export_options'></span>

<h3>Description</h3>

<p>Given a <code>secuTrialdata</code> object, this function returns information on deviations
from suggested export options.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_export_options(dat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_export_options_+3A_dat">dat</code></td>
<td>
<p><code>secuTrialdata</code> object</p>
</td></tr>
</table>


<h3>Details</h3>

<p>While the package strives to allow loading of as many types of secuTrial data exports
as possible, there are certain export options which are less likely to cause issues.
If possible it is suggested to export data which adheres to a suggested option set.
This function points out deviations from the suggested set of options which are: <br />
is_zip == TRUE <br />
refvals_separate == TRUE <br />
add_id == TRUE <br />
duplicate_meta == FALSE <br />
encoding == &quot;UTF-8&quot; <br />
form_status == TRUE <br />
centre_info == TRUE <br />
proj_setup == TRUE <br />
dict_items$lang == &quot;en&quot; <br />
hidden_fields == FALSE <br />
structure == TRUE
</p>


<h3>Examples</h3>

<pre><code class='language-R'>path &lt;- system.file("extdata", "sT_exports", "exp_opt",
                    "s_export_CSV-xls_CTU05_only_column_names.zip",
                    package = "secuTrialR")
sT_export &lt;- read_secuTrial_raw(path)

secuTrialR:::check_export_options(sT_export)
</code></pre>

<hr>
<h2 id='dates_secuTrial'>Methods to handle date(times)s in secuTrial exports</h2><span id='topic+dates_secuTrial'></span><span id='topic+dates_secuTrial.secuTrialdata'></span>

<h3>Description</h3>

<p>Converts dates and datetime variables to <code>Date</code> or <code>POSIXct</code> class, as appropriate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dates_secuTrial(object, ...)

## S3 method for class 'secuTrialdata'
dates_secuTrial(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dates_secuTrial_+3A_object">object</code></td>
<td>
<p><code>secuTrialdata</code> object</p>
</td></tr>
<tr><td><code id="dates_secuTrial_+3A_...">...</code></td>
<td>
<p>further parameters</p>
</td></tr>
</table>


<h3>Details</h3>

<p>New variables are created appended with <code>.date</code> or <code>.datetime</code>.
This is a safety mechanism in case NAs are inadvertently introduced.
</p>


<h3>Value</h3>

<p>same as the original object with date variables converted to <code>Date</code>s.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># prepare path to example export
export_location &lt;- system.file("extdata", "sT_exports", "lnames",
                               "s_export_CSV-xls_CTU05_long_ref_miss_en_utf8.zip",
                               package = "secuTrialR")
# load all export data
sT_export &lt;- read_secuTrial_raw(data_dir = export_location)
# prepare dates
sT_export_dates &lt;- dates_secuTrial(sT_export)

# show parsed datetime example
sT_export_dates$ctu05baseline$hiv_date.datetime[1]
# [1] "2019-03-05 23:56:00 CET"
# show parsed date example
sT_export_dates$ctu05baseline$paracetamol_start.date[1]
# [1] "2019-03-05"
</code></pre>

<hr>
<h2 id='dictionary_secuTrial'>Data dictionary for secuTrialdata objects</h2><span id='topic+dictionary_secuTrial'></span>

<h3>Description</h3>

<p>Data dictionary for secuTrialdata objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dictionary_secuTrial(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dictionary_secuTrial_+3A_x">x</code></td>
<td>
<p><code>secuTrialdata</code> object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame with info on variables
</p>


<h3>Examples</h3>

<pre><code class='language-R'>export_location &lt;- system.file("extdata", "sT_exports", "lnames",
                               "s_export_CSV-xls_CTU05_long_ref_miss_en_utf8.zip",
                               package = "secuTrialR")
# read all export data
sT_export &lt;- read_secuTrial(data_dir = export_location)
# get dictionary
dictionary_secuTrial(sT_export)
</code></pre>

<hr>
<h2 id='diff_secuTrial'>Returns differences in the setup of two <code>secuTrialdata</code> objects</h2><span id='topic+diff_secuTrial'></span>

<h3>Description</h3>

<p>During ongoing studies it is possible that changes to the DataCapture interface
are made. Sometimes these changes may call for adjustments in analysis code.
It is considered good practice to run <code>diff_secuTrial()</code> on the last export
and the current export of a project to at least make yourself aware of
potential changes to the setup. If there are differences, the results of this function should
be interpreted as a first indicator since they may not cover all alterations.
Information is returned on new forms and variables.
A detailed list of changes can be produced in the FormBuilder with
&quot;Compare project setup&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>diff_secuTrial(x, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="diff_secuTrial_+3A_x">x</code></td>
<td>
<p>a <code>secuTrialdata</code> object (the older export)</p>
</td></tr>
<tr><td><code id="diff_secuTrial_+3A_y">y</code></td>
<td>
<p>a <code>secuTrialdata</code> object (the newer export)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If there are differences, <code>diff_secuTrial()</code> will produce a list of vectors.
The fist vector informs about new forms and the second vector informs about
new variables.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># read exports

# v1 is essentially a clone of the CTU05 setup
ctu06_v1 &lt;- read_secuTrial(system.file("extdata", "sT_exports", "change_tracking",
                                       "s_export_CSV-xls_CTU06_version1.zip",
                                       package = "secuTrialR"))
# v2 contains 2 additional forms (mnpctu06anewform, mnpctu06anothernewform) and
# 2 additional variables (new_item_in_fu, new_item_in_new_form)
ctu06_v2 &lt;- read_secuTrial(system.file("extdata", "sT_exports", "change_tracking",
                                       "s_export_CSV-xls_CTU06_version2.zip",
                                       package = "secuTrialR"))
# return diff
diff_secuTrial(ctu06_v1, ctu06_v2)

</code></pre>

<hr>
<h2 id='export_datetime'>Return the date and time that an export was performed</h2><span id='topic+export_datetime'></span><span id='topic+export_date'></span>

<h3>Description</h3>

<p>Return the date and time that an export was performed
</p>


<h3>Usage</h3>

<pre><code class='language-R'>export_datetime(x)

export_date(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="export_datetime_+3A_x">x</code></td>
<td>
<p>secuTrial export</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>export_date</code> returns a date object, <code>export_datetime</code> returns a string
</p>


<h3>Examples</h3>

<pre><code class='language-R'>export_location &lt;- system.file("extdata", "sT_exports", "lnames",
                               "s_export_CSV-xls_CTU05_long_ref_miss_en_utf8.zip",
                               package = "secuTrialR")
# read all export data
sT_export &lt;- read_secuTrial(data_dir = export_location)
# get date/time
export_datetime(sT_export)
export_date(sT_export)
</code></pre>

<hr>
<h2 id='factorize'>Add factors to <code>secuTrialdata</code> objects</h2><span id='topic+factorize'></span><span id='topic+factorize_secuTrial'></span><span id='topic+factorize_secuTrial.secuTrialdata'></span>

<h3>Description</h3>

<p>secuTrial can return a codebook of codes and labels for categorical variables, including lookup
type variables, if this option is selected in the export tool ('reference values as separate table').
This allows factors to be easily created. Factorize methods exist for <code>secuTrialdata</code> objects,
<code>data.frames</code>, <code>integer</code>s and <code>logical</code>s, but the intent is that only the former be
used by users. The other methods could be used with customized codebooks.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>factorize_secuTrial(object, ...)

## S3 method for class 'secuTrialdata'
factorize_secuTrial(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="factorize_+3A_object">object</code></td>
<td>
<p><code>secuTrialdata</code> object with additional factor variables in study forms containing categorical data</p>
</td></tr>
<tr><td><code id="factorize_+3A_...">...</code></td>
<td>
<p>further parameters</p>
</td></tr>
</table>


<h3>Details</h3>

<p>factorize_secuTrial will return an error if the appropriate codebook is not available.
</p>


<h3>Value</h3>

<p>factorized <code>secuTrialdata</code> object
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load secuTrial export with separate reference table
sT_export &lt;- read_secuTrial_raw(system.file("extdata", "sT_exports", "lnames",
                                            "s_export_CSV-xls_CTU05_long_ref_miss_en_utf8.zip",
                                            package = "secuTrialR"))
# factorize the secuTrialdata object
sT_export_factorized &lt;- factorize_secuTrial(sT_export)
</code></pre>

<hr>
<h2 id='form_status_counts'>A function to assess the status of forms</h2><span id='topic+form_status_counts'></span>

<h3>Description</h3>

<p>This function returns a data.frame informing on the status of saved
forms per participant. There is a line for every combination of
form type and participant id. The numbers are occurrence counts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>form_status_counts(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="form_status_counts_+3A_object">object</code></td>
<td>
<p><code>secuTrialdata</code> object</p>
</td></tr>
<tr><td><code id="form_status_counts_+3A_...">...</code></td>
<td>
<p>further parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.frame informing on the status of saved forms per participant
</p>


<h3>Examples</h3>

<pre><code class='language-R'># prepare path to example export
export_location &lt;- system.file("extdata", "sT_exports", "snames",
                               "s_export_CSV-xls_CTU05_short_ref_miss_en_utf8.zip",
                               package = "secuTrialR")
# load all export data
sT_export &lt;- read_secuTrial(data_dir = export_location)

# get form status
form_status_counts(sT_export)

</code></pre>

<hr>
<h2 id='form_status_summary'>A function to show summary statistics for form statuses</h2><span id='topic+form_status_summary'></span>

<h3>Description</h3>

<p>This function warps form_status_counts and returns a
data.frame summarizing the statuses for each form.
Only saved forms are considered for the statistic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>form_status_summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="form_status_summary_+3A_object">object</code></td>
<td>
<p><code>secuTrialdata</code> object</p>
</td></tr>
<tr><td><code id="form_status_summary_+3A_...">...</code></td>
<td>
<p>further parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.frame summarizing the statuses for each form
</p>


<h3>Examples</h3>

<pre><code class='language-R'># prepare path to example export
export_location &lt;- system.file("extdata","sT_exports", "snames",
                               "s_export_CSV-xls_CTU05_short_ref_miss_en_utf8.zip",
                               package = "secuTrialR")
# load all export data
sT_export &lt;- read_secuTrial(data_dir = export_location)

# get form status
form_status_summary(sT_export)

</code></pre>

<hr>
<h2 id='get_participants'>Retrieves participants present in <code>secuTrialdata</code></h2><span id='topic+get_participants'></span>

<h3>Description</h3>

<p>Given a <code>secuTrialdata</code> object, this function simply returns a list of participants.
Information included are participant IDs and corresponding study centre information,
if available.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_participants(dat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_participants_+3A_dat">dat</code></td>
<td>
<p><code>secuTrialdata</code> object containing participant IDs and centre information</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.frame containing participants present in dat
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
path &lt;- system.file("extdata", "sT_exports", "exp_opt",
                    "s_export_CSV-xls_CTU05_all_info.zip",
                    package = "secuTrialR")
sT_export &lt;- read_secuTrial(path)

# show participants
participants &lt;- get_participants(sT_export)

</code></pre>

<hr>
<h2 id='labels_secuTrial'>Get variable labels for secuTrialdata objects</h2><span id='topic+labels_secuTrial'></span><span id='topic+label_secuTrial'></span><span id='topic+label'></span><span id='topic+units'></span><span id='topic+label+3C-'></span><span id='topic+units+3C-'></span>

<h3>Description</h3>

<p>Variable labels are important for understanding the contents of a variable.
<code>secuTrialR</code> offers two main methods to get those labels. <code>labels_secuTrial</code>
returns a named list of labels. <code>label_secuTrial</code> adds labels and units to
variables (and data.frames) which can then be queried via <code>label</code> or <code>units</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>labels_secuTrial(object, form = NULL)

label_secuTrial(object, ...)

label(x)

units(x)

label(x) &lt;- value

units(x) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="labels_secuTrial_+3A_object">object</code></td>
<td>
<p>a <code>secuTrialdata</code> object</p>
</td></tr>
<tr><td><code id="labels_secuTrial_+3A_form">form</code></td>
<td>
<p>which form (string)</p>
</td></tr>
<tr><td><code id="labels_secuTrial_+3A_...">...</code></td>
<td>
<p>further parameters</p>
</td></tr>
<tr><td><code id="labels_secuTrial_+3A_x">x</code></td>
<td>
<p>any object</p>
</td></tr>
<tr><td><code id="labels_secuTrial_+3A_value">value</code></td>
<td>
<p>any object</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For <code>labels_secuTrial</code>, regular expressions are used with <code>form</code>
(specifically, it is inserted between <code>(</code> and <code>)$</code> to identify the form).
Consequently, if <code>form</code> matches multiple forms (because the beginning is different),
multiple forms may be returned. You could be more specific with the regular expression,
remembering that it is inserted between <code>(</code> and <code>)$</code>.
</p>


<h3>Value</h3>

<p><code>labels_secuTrial</code> returns a named vector
<code>label_secuTrial</code> returns the same object as <code>object</code>, but with labels added to variables
and data.frames
<code>label</code> and <code>units</code> return strings with the appropriate labels
</p>
<p><code>secuTrialdata</code> object with labels applied to each variable
</p>


<h3>Note</h3>

<p>The <code>label_secuTrial</code>/<code>label</code> syntax is similar to that used in Hmisc, with the
advantage that it does not change data types (Hmisc coerces everything to labelled integer).
Similar to Hmisc, however, most operations will remove the labels.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># APPROACH 1: labels_secuTrial
# ex. 1
# prepare path to example export
export_location &lt;- system.file("extdata", "sT_exports", "BMD",
                               "s_export_CSV-xls_BMD_short_en_utf8.zip",
                               package = "secuTrialR")
# load all export data
sT_export &lt;- read_secuTrial_raw(data_dir = export_location)
# get all labels
labels &lt;- labels_secuTrial(sT_export)
labels[["age"]]

# ex. 2
# load export
sT_export &lt;- read_secuTrial_raw(system.file("extdata", "sT_exports", "lnames",
                                            "s_export_CSV-xls_CTU05_long_miss_en_utf8.zip",
                                            package = "secuTrialR"))

# get labels for sae, treatment and surgeries forms
labels &lt;- labels_secuTrial(sT_export, form = c("sae", "treatment", "surgeries"))


# APPROACH 2: label_secuTrial
# load secuTrial export with separate reference table
sT_export &lt;- read_secuTrial_raw(system.file("extdata", "sT_exports", "lnames",
                                            "s_export_CSV-xls_CTU05_long_ref_miss_en_utf8.zip",
                                            package = "secuTrialR"))
# label the secuTrialdata object
sT_export_labelled &lt;- label_secuTrial(sT_export)
# form label
label(sT_export_labelled$ctu05baseline)
# variable label
label(sT_export_labelled$ctu05baseline$visit_date)
# sampling units
units(sT_export_labelled$ctu05baseline$height)
</code></pre>

<hr>
<h2 id='links_secuTrial'>Show links between forms</h2><span id='topic+links_secuTrial'></span>

<h3>Description</h3>

<p>secuTrial creates a large number of files and identifiers with which to link files together.
Understanding the links can be difficult. This function produces a map linking the forms
with common variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>links_secuTrial(
  object,
  forms = NULL,
  formcol = "#d8b365",
  varcol = "#e5f5f9",
  plot = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="links_secuTrial_+3A_object">object</code></td>
<td>
<p><code>secuTrialdata</code> object</p>
</td></tr>
<tr><td><code id="links_secuTrial_+3A_forms">forms</code></td>
<td>
<p>a regular expression for which forms should be included</p>
</td></tr>
<tr><td><code id="links_secuTrial_+3A_formcol">formcol</code></td>
<td>
<p>color for form name circles</p>
</td></tr>
<tr><td><code id="links_secuTrial_+3A_varcol">varcol</code></td>
<td>
<p>color for variable name circles</p>
</td></tr>
<tr><td><code id="links_secuTrial_+3A_plot">plot</code></td>
<td>
<p>boolean specifies if the plot should be shown</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We recommend to resize the tcltk window and and click view/&quot;fit to screen&quot; to improve readability.
Forms are colored dull orange, variables are colored light blue.
</p>


<h3>Value</h3>

<p>a tcltk plot window.
</p>


<h3>Note</h3>

<p>Note that where a form name is also a variable name, it is appended by <code>_form</code>
(igraph requires uniquely named nodes).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# ex. 1
# prepare path to example export
export_location &lt;- system.file("extdata", "sT_exports", "BMD",
                               "s_export_CSV-xls_BMD_short_en_utf8.zip",
                               package = "secuTrialR")
# load all export data
sT_export &lt;- read_secuTrial_raw(data_dir = export_location)
# plot links
links_secuTrial(sT_export)

# ex. 2
# prepare path to example export
export_location &lt;- system.file("extdata", "sT_exports", "lnames",
                               "s_export_CSV-xls_CTU05_long_ref_miss_en_utf8.zip",
                               package = "secuTrialR")
# load all export data
sT_export &lt;- read_secuTrial_raw(data_dir = export_location)
# plot links for form names starting with "ctu05"
links_secuTrial(sT_export, forms = "^ctu05")

</code></pre>

<hr>
<h2 id='plot_recruitment'>Plots the recruitment over time for <code>secuTrialdata</code> objects</h2><span id='topic+plot_recruitment'></span>

<h3>Description</h3>

<p>secuTrial exports inherently contain the information on which participant was
registered at which point in time. This function makes use of this property
to plot recruitment over time. Centers indicated with a black line in the
legend did not recruit at all.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_recruitment(
  x,
  return_data = FALSE,
  show_centres = TRUE,
  cex = 1,
  rm_regex = ""
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_recruitment_+3A_x">x</code></td>
<td>
<p>a <code>secuTrialdata</code> object</p>
</td></tr>
<tr><td><code id="plot_recruitment_+3A_return_data">return_data</code></td>
<td>
<p>logical - return the data used to produce the plot instead of the plot</p>
</td></tr>
<tr><td><code id="plot_recruitment_+3A_show_centres">show_centres</code></td>
<td>
<p>logical - subset the data into centres</p>
</td></tr>
<tr><td><code id="plot_recruitment_+3A_cex">cex</code></td>
<td>
<p>double - specifies font size in legend</p>
</td></tr>
<tr><td><code id="plot_recruitment_+3A_rm_regex">rm_regex</code></td>
<td>
<p>character - specifies a regular expression to be removed from the centre names in the legend.
e.g. rm_regex = &quot;\\(.*\\)$&quot; will remove trailing brackets and their contents.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a simple line plot showing recruitment over time
or a list of data.frames if return_data is set to TRUE
</p>


<h3>Examples</h3>

<pre><code class='language-R'># export location
expot_loc &lt;- system.file("extdata", "sT_exports", "lnames",
                         "s_export_CSV-xls_CTU05_long_ref_miss_en_utf8.zip",
                         package = "secuTrialR")
# read export
sT_export &lt;- read_secuTrial(expot_loc)

# plot recruitment
plot_recruitment(sT_export)

# plot without trailing bracket
plot_recruitment(sT_export, rm_regex = "\\(.*\\)$")

</code></pre>

<hr>
<h2 id='read_secuTrial'>Read secuTrial export</h2><span id='topic+read_secuTrial'></span>

<h3>Description</h3>

<p>Convenience wrapper for <code>read_secuTrial_raw</code>, <code>label_secuTrial</code>,
<code>factorize_secuTrial</code> and <code>dates_secuTrial</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_secuTrial(data_dir, labels = TRUE, factor = TRUE, dates = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_secuTrial_+3A_data_dir">data_dir</code></td>
<td>
<p>string - location of the export</p>
</td></tr>
<tr><td><code id="read_secuTrial_+3A_labels">labels</code></td>
<td>
<p>logical - add labels to variables and table</p>
</td></tr>
<tr><td><code id="read_secuTrial_+3A_factor">factor</code></td>
<td>
<p>logical - convert categorical variables to factor variables
(ignored when reference values are not in a separate table)</p>
</td></tr>
<tr><td><code id="read_secuTrial_+3A_dates">dates</code></td>
<td>
<p>logical - convert date variables</p>
</td></tr>
<tr><td><code id="read_secuTrial_+3A_...">...</code></td>
<td>
<p>options passed to <code>read_secuTrial_raw</code>. Can be used for passing options to read.table</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>secuTrialdata</code> object - a list with one data.frame for each file on the export
and a list containing the export options
</p>


<h3>Examples</h3>

<pre><code class='language-R'>export_location &lt;- system.file("extdata", "sT_exports", "lnames",
                               "s_export_CSV-xls_CTU05_long_ref_miss_en_utf8.zip",
                               package = "secuTrialR")
# read all export data
sT_export &lt;- read_secuTrial(data_dir = export_location)

</code></pre>

<hr>
<h2 id='read_validation_overview'>This function loads a multi-page secuTrial 'Validation Overview' report into an R tibble.</h2><span id='topic+read_validation_overview'></span>

<h3>Description</h3>

<p>This function loads a multi-page secuTrial 'Validation Overview' report into an R tibble.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_validation_overview(data_dir, skip = 7)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_validation_overview_+3A_data_dir">data_dir</code></td>
<td>
<p>Path to the Validation Overview (must be an *.xlsx file).</p>
</td></tr>
<tr><td><code id="read_validation_overview_+3A_skip">skip</code></td>
<td>
<p>Equivalent parameter in read_excel().
The validation overview xlsx files contain some information in the first
few lines of each sheet which need to be skipped in order to produce the
correct header in R. Prior to reading the validation overview with read_validation_overview()
it is likely a good idea to check how many lines need to be skipped. This
parameter has been added because the amount of lines can differ between different
versions of secuTrial.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>tibble with the 'Validation Overview' data
</p>


<h3>Examples</h3>

<pre><code class='language-R'>val_ovv_location &lt;- system.file("extdata", "sT_exports", "BMD",
                                "bmd_validation_overview.xlsx",
                                package = "secuTrialR")
val_ovv &lt;- read_validation_overview(data_dir = val_ovv_location)

</code></pre>

<hr>
<h2 id='return_hidden_items'>Returns hidden items (variables) from <code>secuTrialdata</code> objects</h2><span id='topic+return_hidden_items'></span>

<h3>Description</h3>

<p>Sometimes, during a study, certain fields may be hidden because data should
no longer be entered into them. If this is the case and the data of these
fields is part of your export is likely good to know about it.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>return_hidden_items(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="return_hidden_items_+3A_x">x</code></td>
<td>
<p>a <code>secuTrialdata</code> object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame (columns: name, itemtype, label) that pinpoints which items are hidden
</p>


<h3>Examples</h3>

<pre><code class='language-R'># export location
expot_loc &lt;- system.file("extdata", "sT_exports", "lnames",
                         "s_export_CSV-xls_CTU05_long_ref_miss_en_utf8.zip",
                         package = "secuTrialR")
# read export
sT_export &lt;- read_secuTrial(expot_loc)

# return scores
return_hidden_items(sT_export)

</code></pre>

<hr>
<h2 id='return_random_participants'>Returns the random participants from a secuTrial export</h2><span id='topic+return_random_participants'></span>

<h3>Description</h3>

<p>There are situations (e.g. randomized monitoring) in which you may want to
return a list of random participants from a secuTrial export.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>return_random_participants(
  x,
  centres = "all",
  percent = 0.1,
  date = "1900-01-01",
  seed = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="return_random_participants_+3A_x">x</code></td>
<td>
<p>a <code>secuTrialdata</code> object</p>
</td></tr>
<tr><td><code id="return_random_participants_+3A_centres">centres</code></td>
<td>
<p>A character vector of centres for which participants should be returned. If left
unspecified it will return participants for every study centre.</p>
</td></tr>
<tr><td><code id="return_random_participants_+3A_percent">percent</code></td>
<td>
<p>A number greater than 0 and smaller than 1 specifying the approximate percentage
of participants to be returned per centre.</p>
</td></tr>
<tr><td><code id="return_random_participants_+3A_date">date</code></td>
<td>
<p>If only participants after a specific date should be considered this can be entered here.
Format should be &quot;YYYY-MM-DD&quot; (e.g. &quot;2011-03-26&quot; for March 26th 2011).
This date is checked against mnpvisstartdate in the casenodes table.</p>
</td></tr>
<tr><td><code id="return_random_participants_+3A_seed">seed</code></td>
<td>
<p>Allows to configure a seed for id sampling. Every centre will use a small variation of this seed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of two elements. First, a data.frame that contains the
random participants from each specified centre. This is performed based on a specified seed to retain
reproducibilty. Second, the configuration of the randomization (i.e. result of <code>RNGkind()</code>).
If the percentage does not yield an integer for a centre the number is tranformed into an integer
under application of the <code>ceiling()</code> function (i.e. it is rounded up).
</p>


<h3>Examples</h3>

<pre><code class='language-R'># export location
expot_loc &lt;- system.file("extdata", "sT_exports", "lnames",
                         "s_export_CSV-xls_CTU05_long_ref_miss_en_utf8.zip",
                         package = "secuTrialR")
# read export
sT_export &lt;- read_secuTrial(expot_loc)

# return random participants
return_random_participants(sT_export, percent = 0.25, seed = 1337, date = "2019-03-18",
                           centres = c("Inselspital Bern (RPACK)", "Charité Berlin (RPACK)"))

</code></pre>

<hr>
<h2 id='return_scores'>Returns the score (calculated) items from <code>secuTrialdata</code> objects</h2><span id='topic+return_scores'></span>

<h3>Description</h3>

<p>secuTrial allows to set up calculated fields (i.e. scores) that depend on other items. It is not
suggested to use the scores calculated by secuTrial to perform reliable analyses. To this end,
calling <code>return_scores</code> will return all items in the secuTrial export which are scores and should
be manually recalculated before data analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>return_scores(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="return_scores_+3A_x">x</code></td>
<td>
<p>a <code>secuTrialdata</code> object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame (columns: name, itemtype, label) that pinpoints which items are scores/calculated.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># export location
expot_loc &lt;- system.file("extdata", "sT_exports", "lnames",
                         "s_export_CSV-xls_CTU05_long_ref_miss_en_utf8.zip",
                         package = "secuTrialR")
# read export
sT_export &lt;- read_secuTrial(expot_loc)

# return scores
return_scores(sT_export)

</code></pre>

<hr>
<h2 id='secuTrialdata'>This function loads a secuTrial export</h2><span id='topic+secuTrialdata'></span><span id='topic+read_secuTrial_raw'></span><span id='topic+print.secuTrialdata'></span>

<h3>Description</h3>

<p>This function will always load the full set of meta and data tables.
The export options are also loaded and written into export_options.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_secuTrial_raw(data_dir, ...)

## S3 method for class 'secuTrialdata'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="secuTrialdata_+3A_data_dir">data_dir</code></td>
<td>
<p>string The data_dir specifies the path to the secuTrial data export.</p>
</td></tr>
<tr><td><code id="secuTrialdata_+3A_...">...</code></td>
<td>
<p>further parameters</p>
</td></tr>
<tr><td><code id="secuTrialdata_+3A_x">x</code></td>
<td>
<p>secuTrialdata object as returned by <code>read_secuTrial_raw</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>secuTrialdata</code> object containing a list of
export options and data.frames with all the data loaded from
the secuTrial export.
The list will contain at least the metadata data.frames and
export_options list.
</p>
<p>data.frame with a row for each table in the export. For each table it
contains the name, number of rows and columns, an indicator for
whether the table is a metadata table and the files original name.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># prepare path to example export
export_location &lt;- system.file("extdata", "sT_exports", "BMD",
                               "s_export_CSV-xls_BMD_short_en_utf8.zip",
                               package = "secuTrialR")
# read all export data
sT_export &lt;- read_secuTrial_raw(data_dir = export_location)

# Print method
print(sT_export)
# or
sT_export
</code></pre>

<hr>
<h2 id='subset_secuTrial'>Subsets a <code>secuTrialdata</code> object</h2><span id='topic+subset_secuTrial'></span>

<h3>Description</h3>

<p>Given a <code>secuTrialdata</code> object, and subsetting parameters,
this function filters the data object to include only the desired study participants.
Subsetting is possible based on participants and based on centres. In order to subset
based on participants, participant IDs (mnpaid) musst be present in the export.
In order to subset based on centres, centre information must be included in the export.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>subset_secuTrial(dat, participant = NULL, centre = NULL, exclude = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="subset_secuTrial_+3A_dat">dat</code></td>
<td>
<p><code>secuTrialdata</code> object containing participant IDs and centre information</p>
</td></tr>
<tr><td><code id="subset_secuTrial_+3A_participant">participant</code></td>
<td>
<p>character vector with a selection of participant IDs (mnpaid) used for subsetting</p>
</td></tr>
<tr><td><code id="subset_secuTrial_+3A_centre">centre</code></td>
<td>
<p>character vector with a selection of centre names (mnpctrname) used for subsetting</p>
</td></tr>
<tr><td><code id="subset_secuTrial_+3A_exclude">exclude</code></td>
<td>
<p>boolean which if true excludes participants and centres from dat</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Subsetting based on participants only, centers only, or based on both is possible. The value of parameter exclude
determines whether the output will include participants that meet selection criteria (when exclude = FALSE),
or exclude them (when exclude = TRUE). When selecting based on both participants and centres,
exclude = FALSE will include the intersection of participants meeting the selection criteria.
If exclude = TRUE, a complement of union of participant and centre sets is returned.
</p>


<h3>Value</h3>

<p><code>secuTrialdata</code> object containing only those participants that meet the selection criteria.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
path &lt;- system.file("extdata", "sT_exports", "exp_opt",
                    "s_export_CSV-xls_CTU05_all_info.zip",
                    package = "secuTrialR")
sT &lt;- read_secuTrial(path)
participants &lt;- c("RPACK-INS-011", "RPACK-INS-014", "RPACK-INS-015")
centres &lt;- c("Inselspital Bern (RPACK)", "Universitätsspital Basel (RPACK)")

# show all participants
get_participants(sT)

# subset sT_export
sT_subset1 &lt;- subset_secuTrial(dat = sT, participant = participants)
get_participants(sT_subset1)
sT_subset2 &lt;- subset_secuTrial(dat = sT, participant = participants, exclude = TRUE)
get_participants(sT_subset2)
sT_subset3 &lt;- subset_secuTrial(dat = sT, centre = centres, exclude = TRUE)
get_participants(sT_subset3)
sT_subset4 &lt;- subset_secuTrial(dat = sT, participant = participants,
                               centre = centres, exclude = FALSE)
get_participants(sT_subset4)
sT_subset5 &lt;- subset_secuTrial(dat = sT, participant = participants,
                               centre = centres[2], exclude = FALSE)
get_participants(sT_subset5)

</code></pre>

<hr>
<h2 id='visit_structure'>Get the visit structure of <code>secuTrialdata</code> objects</h2><span id='topic+visit_structure'></span><span id='topic+plot.secuTrialvisit'></span>

<h3>Description</h3>

<p>Get the visit structure of <code>secuTrialdata</code> objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>visit_structure(x, sorted = TRUE)

## S3 method for class 'secuTrialvisit'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="visit_structure_+3A_x">x</code></td>
<td>
<p>a <code>secuTrialdata</code> object</p>
</td></tr>
<tr><td><code id="visit_structure_+3A_sorted">sorted</code></td>
<td>
<p>logical if TRUE sorted by first visit</p>
</td></tr>
<tr><td><code id="visit_structure_+3A_...">...</code></td>
<td>
<p>further parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.frame with 1 for whether a form (rows) was collected during a particular visit (columns)
</p>
<p>plot of the visit plan
</p>


<h3>Note</h3>

<p>Requires a fixed visit structure - an error will be returned for projects without
a visit structure or one with flexible visits
</p>


<h3>Examples</h3>

<pre><code class='language-R'>export_location &lt;- system.file("extdata", "sT_exports", "lnames",
                               "s_export_CSV-xls_CTU05_long_ref_miss_en_utf8.zip",
                               package = "secuTrialR")
# read all export data
sT_export &lt;- read_secuTrial(data_dir = export_location)
# get visit structure
vs &lt;- visit_structure(sT_export)
# plot
plot(vs)
</code></pre>

<hr>
<h2 id='write_secuTrial'>Write secuTrial exports to other formats</h2><span id='topic+write_secuTrial'></span><span id='topic+write_secuTrial.secuTrialdata'></span><span id='topic+write_secuTrial.data.frame'></span>

<h3>Description</h3>

<p>Convert the export prepared in R and export it to
SPSS (sav), Stata (dta) or SAS (sas, xpt version 8)
using the haven package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write_secuTrial(object, ...)

## S3 method for class 'secuTrialdata'
write_secuTrial(object, format = "dta", metadata = FALSE, ...)

## S3 method for class 'data.frame'
write_secuTrial(df, filename, path = "", format = "dta", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="write_secuTrial_+3A_object">object</code></td>
<td>
<p><code>secuTrialdata</code> object</p>
</td></tr>
<tr><td><code id="write_secuTrial_+3A_...">...</code></td>
<td>
<p>further parameters</p>
</td></tr>
<tr><td><code id="write_secuTrial_+3A_format">format</code></td>
<td>
<p>format in which to save the export (one of &quot;dta&quot;, &quot;sas&quot;, &quot;sav&quot;, &quot;xpt&quot;)</p>
</td></tr>
<tr><td><code id="write_secuTrial_+3A_metadata">metadata</code></td>
<td>
<p>if TRUE then metadate files will also be written</p>
</td></tr>
<tr><td><code id="write_secuTrial_+3A_df">df</code></td>
<td>
<p>a data.frame</p>
</td></tr>
<tr><td><code id="write_secuTrial_+3A_filename">filename</code></td>
<td>
<p>file name</p>
</td></tr>
<tr><td><code id="write_secuTrial_+3A_path">path</code></td>
<td>
<p>directory where the files should be saved</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Due to variable naming limitations in other packages, date variables are
appended with _d (rather than _date), datetime/POSIX variables are appended
with _dt (rather than _datetime) and factors with _f (rather than _factor).
Further variable names may be altered in the conversion process.
For details please refer to the <code>haven</code> documentation.
</p>


<h3>Value</h3>

<p>a list of filenames
</p>


<h3>Examples</h3>

<pre><code class='language-R'># prepare path to example export
export_location &lt;- system.file("extdata", "sT_exports", "lnames",
                               "s_export_CSV-xls_CTU05_long_ref_miss_en_utf8.zip",
                               package = "secuTrialR")
# load all export data
sT_export &lt;- read_secuTrial(data_dir = export_location)
tdir &lt;- tempdir()
write_secuTrial(sT_export, format = "dta", path = tdir)
list.files(tdir)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
