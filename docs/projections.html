<!DOCTYPE html><html><head><title>Help for package projections</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {projections}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#[.projections'><p>Subsetting 'projections' objects</p></a></li>
<li><a href='#as.matrix.projections'><p>Conversion of projections objects</p></a></li>
<li><a href='#build_projections'><p>Constructor for projections objects</p></a></li>
<li><a href='#cumulate.projections'><p>Compute cumulative projections</p></a></li>
<li><a href='#get_dates'><p>Access content projections objects</p></a></li>
<li><a href='#merge_add_projections'><p>Add data of different projections objects</p></a></li>
<li><a href='#merge_projections'><p>Merge a list of projections objects</p></a></li>
<li><a href='#plot.projections'><p>Plot projections objects</p></a></li>
<li><a href='#print.projections'><p>Print method for projections objects</p></a></li>
<li><a href='#project'><p>Project future incidence</p></a></li>
<li><a href='#summary.projections'><p>Summary for projections objects</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Project Future Case Incidence</td>
</tr>
<tr>
<td>Version:</td>
<td>0.6.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides functions and graphics for projecting daily incidence based on past incidence, and estimates of the serial interval and reproduction number. Projections are based on a branching process using a Poisson-distributed number of new cases per day, similar to the model used for estimating R in 'EpiEstim' or in 'earlyR', and described by Nouvellet et al. (2017) &lt;<a href="https://doi.org/10.1016%2Fj.epidem.2017.02.012">doi:10.1016/j.epidem.2017.02.012</a>&gt;. The package provides the S3 class 'projections' which extends 'matrix', with accessors and additional helpers for handling, subsetting, merging, or adding these objects, as well as dedicated printing and plotting methods.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, roxygen2, knitr, rmarkdown, outbreaks, magrittr,
distcrete, svglite, EpiEstim</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, utils, incidence (&ge; 1.4.1), ggplot2, methods</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://www.repidemicsconsortium.org/projections/">https://www.repidemicsconsortium.org/projections/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/reconhub/projections/issues">https://github.com/reconhub/projections/issues</a></td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-03-23 09:43:23 UTC; thibaut</td>
</tr>
<tr>
<td>Author:</td>
<td>Thibaut Jombart [aut, cre],
  Pierre Nouvellet [aut],
  Sangeeta Bhatia [ctb],
  Zhian N. Kamvar [ctb],
  Tim Taylor [ctb],
  Stephane Ghozzi [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Thibaut Jombart &lt;thibautjombart@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-03-23 11:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='+5B.projections'>Subsetting 'projections' objects</h2><span id='topic++5B.projections'></span><span id='topic++22subset.projections+22'></span><span id='topic++22+5B.projections+22'></span><span id='topic+subset.projections'></span>

<h3>Description</h3>

<p>Two functions can be used to subset projections objects. The operator &quot;[&quot; can
be used as for matrices, using the syntax <code>x[i,j]</code> where 'i' is a subset
of dates, and 'j' is a subset of simulations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'projections'
x[i, j]

## S3 method for class 'projections'
subset(x, ..., from = NULL, to = NULL, sim = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="+2B5B.projections_+3A_x">x</code></td>
<td>
<p>An projections object, generated by the function
<code><a href="#topic+project">project</a></code>.</p>
</td></tr>
<tr><td><code id="+2B5B.projections_+3A_i">i</code></td>
<td>
<p>a subset of dates to retain</p>
</td></tr>
<tr><td><code id="+2B5B.projections_+3A_j">j</code></td>
<td>
<p>a subset of groups to retain</p>
</td></tr>
<tr><td><code id="+2B5B.projections_+3A_...">...</code></td>
<td>
<p>Further arguments passed to other methods (not used).</p>
</td></tr>
<tr><td><code id="+2B5B.projections_+3A_from">from</code></td>
<td>
<p>The starting date; data strictly before this date are discarded.</p>
</td></tr>
<tr><td><code id="+2B5B.projections_+3A_to">to</code></td>
<td>
<p>The ending date; data strictly after this date are discarded.</p>
</td></tr>
<tr><td><code id="+2B5B.projections_+3A_sim">sim</code></td>
<td>
<p>(optional) The simulations to retained, indicated as subsets of
the columns of x.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Thibaut Jombart <a href="mailto:thibautjombart@gmail.com">thibautjombart@gmail.com</a>
</p>


<h3>See Also</h3>

<p>The <code><a href="#topic+project">project</a></code> function to generate the 'projections'
objects.
</p>

<hr>
<h2 id='as.matrix.projections'>Conversion of projections objects</h2><span id='topic+as.matrix.projections'></span><span id='topic+as.data.frame.projections'></span>

<h3>Description</h3>

<p>These functions convert <code>projections</code> objects into other classes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'projections'
as.matrix(x, ...)

## S3 method for class 'projections'
as.data.frame(x, ..., long = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.matrix.projections_+3A_x">x</code></td>
<td>
<p>An <code>projections</code> object, or an object to be converted as
<code>projections</code> (see details).</p>
</td></tr>
<tr><td><code id="as.matrix.projections_+3A_...">...</code></td>
<td>
<p>Further arguments passed to other functions (no used).</p>
</td></tr>
<tr><td><code id="as.matrix.projections_+3A_long">long</code></td>
<td>
<p>A logical indicating if the output data.frame should be 'long',
i.e. where a single column containing 'groups' is added in case of data
computed on several groups.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Thibaut Jombart <a href="mailto:thibautjombart@gmail.com">thibautjombart@gmail.com</a>
</p>


<h3>See Also</h3>

<p>the <code><a href="#topic+project">project</a></code> function to generate the 'projections' objects.
</p>

<hr>
<h2 id='build_projections'>Constructor for projections objects</h2><span id='topic+build_projections'></span>

<h3>Description</h3>

<p>This function builds a valid <code>projections</code> object from some input
simulations and dates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>build_projections(x, dates = NULL, cumulative = FALSE, order_dates = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="build_projections_+3A_x">x</code></td>
<td>
<p>A <code>matrix</code> of simulated incidence stored as integers, where
rows correspond to dates and columns to simulations.</p>
</td></tr>
<tr><td><code id="build_projections_+3A_dates">dates</code></td>
<td>
<p>A vector of dates containing one value per row in <code>x</code>;
acceptable formats are: <code>integer</code>, <code>Date</code>, and <code>POSIXct</code>; if
NULL, the time steps will be counted, with the first dates corresponding to
0.</p>
</td></tr>
<tr><td><code id="build_projections_+3A_cumulative">cumulative</code></td>
<td>
<p>A logical indicating if data represent cumulative
incidence; defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="build_projections_+3A_order_dates">order_dates</code></td>
<td>
<p>A logical indicating whether the dates should be ordered,
from the oldest to the most recent one; <code>TRUE</code> by default.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Thibaut Jombart <a href="mailto:thibautjombart@gmail.com">thibautjombart@gmail.com</a>
</p>


<h3>See Also</h3>

<p>the <code><a href="#topic+project">project</a></code> function to generate the 'projections'
objects.
</p>

<hr>
<h2 id='cumulate.projections'>Compute cumulative projections</h2><span id='topic+cumulate.projections'></span>

<h3>Description</h3>

<p><code>cumulate</code> is an S3 generic to compute cumulative numbers defined in the
package <code>incidence</code>. The method for <code>projections</code> objects turns
predicted incidences into cumulative incidences over time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'projections'
cumulate(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cumulate.projections_+3A_x">x</code></td>
<td>
<p>A <code>projections</code> object.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Thibaut Jombart <a href="mailto:thibautjombart@gmail.com">thibautjombart@gmail.com</a>
</p>


<h3>See Also</h3>

<p>The <code><a href="#topic+project">project</a></code> function to generate the
<code>projections</code> objects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
if (require(distcrete) &amp;&amp;
    require(incidence)) {

  ## simulate basic epicurve
  dat &lt;- c(0, 2, 2, 3, 3, 5, 5, 5, 6, 6, 6, 6)
  i &lt;- incidence(dat)


  ## example with a function for SI
  si &lt;- distcrete("gamma", interval = 1L,
                  shape = 1.5,
                  scale = 2, w = 0)
  set.seed(1)
  pred_1 &lt;- project(i, runif(100, 0.8, 1.9), si, n_days = 30)
  plot_1 &lt;- plot(pred_1)

  ## cumulative predictions
  pred_1_cum &lt;- cumulate(pred_1)
  pred_1_cum
  plot(pred_1_cum)
}


</code></pre>

<hr>
<h2 id='get_dates'>Access content projections objects</h2><span id='topic+get_dates'></span><span id='topic+get_dates.projections'></span>

<h3>Description</h3>

<p>These simple helper functions retrieve content from <code>projections</code>
objects. They currently include:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'projections'
get_dates(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_dates_+3A_x">x</code></td>
<td>
<p>A <code>projections</code> object.</p>
</td></tr>
<tr><td><code id="get_dates_+3A_...">...</code></td>
<td>
<p>Further arguments passed to methods; currently not used.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li> <p><code>get_dates</code>: get dates of the predictions.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Thibaut Jombart <a href="mailto:thibautjombart@gmail.com">thibautjombart@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

if (require(distcrete) &amp;&amp; require(incidence)) { withAutoprint({

## prepare input: epicurve and serial interval
dat &lt;- c(0, 2, 2, 3, 3, 5, 5, 5, 6, 6, 6, 6)
i &lt;- incidence(dat)
si &lt;- distcrete("gamma", interval = 1L,
                 shape = 1.5,
                 scale = 2, w = 0)


## make predictions
pred_1 &lt;- project(i, 1.2, si, n_days = 30)
pred_1


## retrieve content
get_dates(pred_1)
max(i$dates) # predictions start 1 day after last incidence

})}
</code></pre>

<hr>
<h2 id='merge_add_projections'>Add data of different projections objects</h2><span id='topic+merge_add_projections'></span><span id='topic++2B.projections'></span>

<h3>Description</h3>

<p>This function adds counts from several <code>projections</code> objects, making sure
that they all use the same dates, adding rows of '0' where
needed. Simulations (columns) are recycled when needed if some objects have
less simulations than others. The same operation is implemented by the <code>+</code>
operator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>merge_add_projections(x)

## S3 method for class 'projections'
a + b
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="merge_add_projections_+3A_x">x</code></td>
<td>
<p>A <code>list</code> of <code>projections</code> objects to be added.</p>
</td></tr>
<tr><td><code id="merge_add_projections_+3A_a">a</code></td>
<td>
<p>A  <code>projections</code> object.</p>
</td></tr>
<tr><td><code id="merge_add_projections_+3A_b">b</code></td>
<td>
<p>A  <code>projections</code> object.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Thibaut Jombart
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
if (require(incidence)) {

  ## make toy data and projections 
  set.seed(1)
  i &lt;- incidence::incidence(as.Date('2020-01-01') +
                          sample(1:20, 50, replace = TRUE))
  si &lt;- c(0.2, 0.5, 0.2, 0.1)

  x_1 &lt;- project(x = i[1:10],
                 si = si,
                 R = 3.5,
                 n_sim = 200,
                 n_days = 5)

  x_2 &lt;- project(x = i[11:20],
                 si = si,
                 R = 1.8,
                 n_sim = 300,
                 n_days = 10
                 )

  ## check simulations
  x_1 # first type
  x_2 # other simulations
  y &lt;- x_1 + x_2 # add simulations
  plot(y)

}
</code></pre>

<hr>
<h2 id='merge_projections'>Merge a list of projections objects</h2><span id='topic+merge_projections'></span>

<h3>Description</h3>

<p>This function merges <code>projections</code> objects, binding them by columns, making
sure that they all use the same dates, adding rows of '0' where needed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>merge_projections(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="merge_projections_+3A_x">x</code></td>
<td>
<p>A <code>list</code> of <code>projections</code> objects to be merged.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Thibaut Jombart
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## generate toy data
dates &lt;- Sys.Date() + c(0, 0, 2, 5, 6, 6, 7)
i &lt;- incidence::incidence(dates)
si &lt;- c(0.2, 0.5, 0.2, 0.1)
R0 &lt;- 3.5

## make several projections objects
x &lt;- lapply(1:10,
            function(j)
              project(x = i,
                      si = si,
                      R = R0,
                      n_sim = 2 * j,
                      R_fix_within = TRUE,
                      n_days = j,
                      model = "poisson"
                      ))
## see all dimensions
lapply(x, dim)
merge_projections(x)
</code></pre>

<hr>
<h2 id='plot.projections'>Plot projections objects</h2><span id='topic+plot.projections'></span><span id='topic+add_projections'></span>

<h3>Description</h3>

<p>The <code>plot</code> method of <code>projections</code> objects (output by the function
<code><a href="#topic+project">project</a></code>) shows quantiles of predicted incidence over time. The
function <code>add_projections</code> can be used to add a similar plot to an
existing <code>incidence</code> plot. This latter function is piping friendly (see
examples).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'projections'
plot(x, ylab = NULL, title = NULL, ...)

add_projections(
  p,
  x,
  quantiles = c(0.01, 0.05, 0.1, 0.5),
  ribbon = TRUE,
  boxplots = FALSE,
  palette = quantile_pal,
  quantiles_alpha = 1,
  linetype = 1,
  linesize = 0.5,
  ribbon_quantiles = NULL,
  ribbon_color = NULL,
  ribbon_alpha = 0.3,
  boxplots_color = "#47476b",
  boxplots_fill = "grey",
  boxplots_alpha = 0.8,
  outliers = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.projections_+3A_x">x</code></td>
<td>
<p>A <code>projections</code> object.</p>
</td></tr>
<tr><td><code id="plot.projections_+3A_ylab">ylab</code></td>
<td>
<p>An optional label for the y-axis. If missing will default to
&quot;predicted incidence&quot; or, if cumulative, &quot;predicted cumulative incidence&quot;</p>
</td></tr>
<tr><td><code id="plot.projections_+3A_title">title</code></td>
<td>
<p>An optional title.</p>
</td></tr>
<tr><td><code id="plot.projections_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to <code>add_projections</code>.</p>
</td></tr>
<tr><td><code id="plot.projections_+3A_p">p</code></td>
<td>
<p>A previous incidence plot to which projections should be added.</p>
</td></tr>
<tr><td><code id="plot.projections_+3A_quantiles">quantiles</code></td>
<td>
<p>A vector of quantiles to plot, automatically completed to be
symmetric around the median.</p>
</td></tr>
<tr><td><code id="plot.projections_+3A_ribbon">ribbon</code></td>
<td>
<p>A logical indicating if a ribbon should be drawn; defaults to
<code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot.projections_+3A_boxplots">boxplots</code></td>
<td>
<p>A logical indicating if boxplots should be drawn.</p>
</td></tr>
<tr><td><code id="plot.projections_+3A_palette">palette</code></td>
<td>
<p>A color palette to be used for plotting the quantile lines;
defaults to <code>quantile_pal</code>.</p>
</td></tr>
<tr><td><code id="plot.projections_+3A_quantiles_alpha">quantiles_alpha</code></td>
<td>
<p>A number used to control the transparency of the
quantile lines, from 0 (full transparency) to 1 (full opacity); defaults to
1.</p>
</td></tr>
<tr><td><code id="plot.projections_+3A_linetype">linetype</code></td>
<td>
<p>An integer indicating the type of line used for plotting the
quantiles; defaults to 1 for a plain line.</p>
</td></tr>
<tr><td><code id="plot.projections_+3A_linesize">linesize</code></td>
<td>
<p>An integer indicating the size of line used for plotting the
quantiles; defaults to 0.5.</p>
</td></tr>
<tr><td><code id="plot.projections_+3A_ribbon_quantiles">ribbon_quantiles</code></td>
<td>
<p>A vector of 2 quantiles to be used to determine the
limits of the ribbon; if NULL (default); uses the most extreme quantiles if
available; if quantiles are not provided, the daily range will be used.</p>
</td></tr>
<tr><td><code id="plot.projections_+3A_ribbon_color">ribbon_color</code></td>
<td>
<p>Any valid color, used for the ribbon.</p>
</td></tr>
<tr><td><code id="plot.projections_+3A_ribbon_alpha">ribbon_alpha</code></td>
<td>
<p>A number used to control the transparency of the
ribbon, from 0 (full transparency) to 1 (full opacity); defaults to 0.3.</p>
</td></tr>
<tr><td><code id="plot.projections_+3A_boxplots_color">boxplots_color</code></td>
<td>
<p>Any valid color, used for the boxplot.</p>
</td></tr>
<tr><td><code id="plot.projections_+3A_boxplots_fill">boxplots_fill</code></td>
<td>
<p>Any valid color, used for filling the boxplot.</p>
</td></tr>
<tr><td><code id="plot.projections_+3A_boxplots_alpha">boxplots_alpha</code></td>
<td>
<p>A number used to control the transparency of the
boxplots, from 0 (full transparency) to 1 (full opacity); defaults to 0.8.</p>
</td></tr>
<tr><td><code id="plot.projections_+3A_outliers">outliers</code></td>
<td>
<p>A logical indicating if outliers should be displayed
alongside the boxplots; defaults to <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Thibaut Jombart <a href="mailto:thibautjombart@gmail.com">thibautjombart@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+project">project</a></code> to generate projections
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
if (require(outbreaks) &amp;&amp;
    require(distcrete) &amp;&amp;
    require(incidence) &amp;&amp;
    require(magrittr)) {

si &lt;- distcrete("gamma",
                 interval = 1L,
                 shape = 2.4,
                 scale = 4.7,
                 w = 0.5)

i &lt;- incidence(ebola_sim$linelist$date_of_onset)
plot(i)

## add projections after the first 100 days, over 60 days
set.seed(1)
proj &lt;- project(x = i[1:100], R = 1.4, si = si, n_days = 60)

## plotting projections: different options
plot(proj)
plot(proj, quantiles = c(.025, .5)) # 95% CI
plot(proj, ribbon_color = "red", quantiles = FALSE) # range
plot(proj, ribbon_color = "red", quantiles = FALSE,
     ribbon_quantiles = c(.025, .5))
plot(proj, boxplots = TRUE, quantiles = FALSE, ribbon = FALSE)
plot(proj, boxplots = TRUE, quantiles = FALSE, outliers = FALSE)
plot(proj, linetype = 3)

## adding them to incidence plot
plot(i) %&gt;% add_projections(proj)
plot(i[1:160]) %&gt;% add_projections(proj)
plot(i[1:160]) %&gt;% add_projections(proj, boxplots = FALSE)
plot(i[1:160]) %&gt;%
  add_projections(proj, boxplots_alpha = .3, boxplots_color = "red")

## same, with customised quantiles and colors
quantiles &lt;- c(.001, .01, 0.05, .1, .2, .3, .4, .5)
pal &lt;- colorRampPalette(c("#b3c6ff", "#00e64d", "#cc0066"))
plot(i[1:200]) %&gt;%
  add_projections(proj, quantiles, palette = pal)

}

</code></pre>

<hr>
<h2 id='print.projections'>Print method for projections objects</h2><span id='topic+print.projections'></span>

<h3>Description</h3>

<p>This method prints the content of <code>projections</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'projections'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.projections_+3A_x">x</code></td>
<td>
<p>A <code>projections</code> object.</p>
</td></tr>
<tr><td><code id="print.projections_+3A_...">...</code></td>
<td>
<p>further parameters to be passed to other methods (currently not
used)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Thibaut Jombart (<a href="mailto:thibautjombart@gmail.com">thibautjombart@gmail.com</a>)
</p>

<hr>
<h2 id='project'>Project future incidence</h2><span id='topic+project'></span>

<h3>Description</h3>

<p>This function simulates future incidence based on past incidence data, a
selection of plausible reproduction numbers (R), and the distribution of the
serial interval (time from primary onset to secondary onset).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>project(
  x,
  R,
  si,
  n_sim = 100,
  n_days = 7,
  R_fix_within = FALSE,
  model = c("poisson", "negbin"),
  size = 0.03,
  time_change = NULL,
  instantaneous_R = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="project_+3A_x">x</code></td>
<td>
<p>An <code>incidence</code> object containing daily incidence; other time
intervals will trigger an error.</p>
</td></tr>
<tr><td><code id="project_+3A_r">R</code></td>
<td>
<p>A vector of numbers representing plausible reproduction numbers; for
instance, these can be samples from a posterior distribution using the
<code>earlyR</code> or <code>EpiEstim</code> packages. If <code>time_change</code> is provided, then it must
be a <code>vector</code> (for fixed values of R per time window) or a <code>list</code> of
vectors (for separate distributions of R per time window), with one element
more than the number of dates in <code>time_change</code>.</p>
</td></tr>
<tr><td><code id="project_+3A_si">si</code></td>
<td>
<p>A function computing the serial interval, or a <code>numeric</code> vector
providing its mass function, starting a day 1, so that <code>si[i]</code> is the PMF
for serial interval of <code>i</code>. The model implicitly assumes that <code>si[0] = 0</code>.
For functions, we strongly recommend using the RECON package
<code>distcrete</code> to obtain such distribution (see example).</p>
</td></tr>
<tr><td><code id="project_+3A_n_sim">n_sim</code></td>
<td>
<p>The number of epicurves to simulate. Defaults to 100.</p>
</td></tr>
<tr><td><code id="project_+3A_n_days">n_days</code></td>
<td>
<p>The number of days to run simulations for. Defaults to 14.</p>
</td></tr>
<tr><td><code id="project_+3A_r_fix_within">R_fix_within</code></td>
<td>
<p>A logical indicating if R should be fixed within
simulations (but still varying across simulations). If <code>FALSE</code>, R is
drawn for every simulation and every time step. Fixing values within
simulations favours more extreme predictions (see details)</p>
</td></tr>
<tr><td><code id="project_+3A_model">model</code></td>
<td>
<p>Distribution to be used for projections. Must be one of
&quot;poisson&quot; or &quot;negbin&quot; (negative binomial process). Defaults to poisson</p>
</td></tr>
<tr><td><code id="project_+3A_size">size</code></td>
<td>
<p>size parameter of negative binomial distribition. Ignored if
model is poisson</p>
</td></tr>
<tr><td><code id="project_+3A_time_change">time_change</code></td>
<td>
<p>an optional vector of times at which the simulations
should use a different sample of reproduction numbers, provided in days
into the simulation (so that day '1' is the first day after the input
<code>incidence</code> object); if provided, <code>n</code> dates in <code>time_change</code> will produce
<code>n+1</code> time windows, in which case <code>R</code> should be a list of vectors of <code>n+1</code>
<code>R</code> values, one per each time window.</p>
</td></tr>
<tr><td><code id="project_+3A_instantaneous_r">instantaneous_R</code></td>
<td>
<p>a boolean specifying whether to assume <code>R</code> is the case
reproduction number (<code>instantaneous_R = FALSE</code>, the default), or the
instantaneous reproduction number (<code>instantaneous_R = TRUE</code>).
If <code>instantaneous_R = FALSE</code> then values of <code>R</code> at time <code>t</code> will govern the
mean number of secondary cases of all cases infected at time <code>t</code>,
even if those secondary cases appear after <code>t</code>. In other words, <code>R</code>
will characterise onwards transmission from infectors depending on their
date of infection.
If <code>instantaneous_R = TRUE</code> then values of <code>R</code> at time <code>t</code> will govern the
mean number of secondary cases made at time <code>t</code> by all cases infected
before <code>t</code>. In other words, <code>R</code> will characterise onwards transmission at
a given time.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The decision to fix R values within simulations
(<code>R_fix_within</code>) reflects two alternative views of the uncertainty
associated with R. When drawing R values at random from the provided
sample, (<code>R_fix_within</code> set to <code>FALSE</code>), it is assumed that R
varies naturally, and can be treated as a random variable with a given
distribution. When fixing values within simulations (<code>R_fix_within</code>
set to <code>TRUE</code>), R is treated as a fixed parameter, and the uncertainty
is merely a consequence of the estimation of R. In other words, the first
view is rather Bayesian, while the second is more frequentist.
</p>


<h3>Author(s)</h3>

<p>Pierre Nouvellet (original model), Thibaut Jombart (bulk of the
code), Sangeeta Bhatia (Negative Binomial model), Stephane Ghozzi (bug fixes
time varying R)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## example using simulated Ebola outbreak
if (require(outbreaks) &amp;&amp;
    require(distcrete) &amp;&amp;
    require(incidence) &amp;&amp;
    require(magrittr)) {

si &lt;- distcrete("gamma", interval = 1L,
                 shape = 2.4,
                 scale = 4.7,
                 w = 0.5)

i &lt;- incidence(ebola_sim$linelist$date_of_onset)
plot(i)


## projections after the first 100 days, over 60 days, fixed R to 2.1

set.seed(1)
proj_1 &lt;- project(x = i[1:100], R = 2.1, si = si, n_days = 60)
plot(proj_1)

## add projections to incidence plot
plot(i[1:160]) %&gt;% add_projections(proj_1)


## projections after the first 100 days, over 60 days,
## using a sample of R

set.seed(1)
R &lt;- rnorm(100, 1.8, 0.2)
hist(R, col = "grey", border = "white", main = "Distribution of R")
proj_2 &lt;- project(x = i[1:100], R = R, si = si, n_days = 60)

## add projections to incidence plot
plot(i[1:160]) %&gt;% add_projections(proj_2)


## same with R constant per simulation (more variability)

set.seed(1)
proj_3 &lt;- project(x = i[1:100], R = R, si = si, n_days = 60,
                  R_fix_within = TRUE)

## add projections to incidence plot
plot(i[1:160]) %&gt;% add_projections(proj_3)


## time-varying R, 2 periods, R is 2.1 then 0.5
set.seed(1)
proj_4 &lt;- project(i,
                  R = c(2.1, 0.5),
                  si = si,
                  n_days = 60,
                  time_change = 40,
                  n_sim = 100)
plot(proj_4)


## time-varying R, 2 periods, separate distributions of R for each period
set.seed(1)
R_period_1 &lt;- runif(100, min = 1.1, max = 3)
R_period_2 &lt;- runif(100, min = 0.6, max = .9)

proj_5 &lt;- project(i,
                  R = list(R_period_1, R_period_2),
                  si = si,
                  n_days = 60,
                  time_change = 20,
                  n_sim = 100)
plot(proj_5)

}

</code></pre>

<hr>
<h2 id='summary.projections'>Summary for projections objects</h2><span id='topic+summary.projections'></span>

<h3>Description</h3>

<p>This method summarises predicted epidemic trajectories contained in a
<code>projections</code> object by days, deriving the mean, standard deviation, and
user-specified quantiles for each day.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'projections'
summary(
  object,
  quantiles = c(0.025, 0.25, 0.5, 0.75, 0.975),
  mean = TRUE,
  sd = TRUE,
  min = TRUE,
  max = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.projections_+3A_object">object</code></td>
<td>
<p>A <code>projections</code> object to summarise</p>
</td></tr>
<tr><td><code id="summary.projections_+3A_quantiles">quantiles</code></td>
<td>
<p>A <code>numeric</code> vector indicating which quantiles should be
computed; ignored if <code>FALSE</code> or of length 0</p>
</td></tr>
<tr><td><code id="summary.projections_+3A_mean">mean</code></td>
<td>
<p>a <code>logical</code> indicating of the mean should be computed</p>
</td></tr>
<tr><td><code id="summary.projections_+3A_sd">sd</code></td>
<td>
<p>a <code>logical</code> indicating of the standard deviation should be computed</p>
</td></tr>
<tr><td><code id="summary.projections_+3A_min">min</code></td>
<td>
<p>a <code>logical</code> indicating of the minimum should be computed</p>
</td></tr>
<tr><td><code id="summary.projections_+3A_max">max</code></td>
<td>
<p>a <code>logical</code> indicating of the maximum should be computed</p>
</td></tr>
<tr><td><code id="summary.projections_+3A_...">...</code></td>
<td>
<p>only preesnt for compatibility with the generic
</p>
<p>if (require(incidence)) 
i &lt;- incidence::incidence(as.Date('2020-01-23'))
si &lt;- c(0.2, 0.5, 0.2, 0.1)
R0 &lt;- 2
</p>
<p>p &lt;- project(x = i,
si = si,
R = R0,
n_sim = 2,
R_fix_within = TRUE,
n_days = 10,
model = &quot;poisson&quot;
)
summary(p)
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Thibaut Jombart
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
