<!DOCTYPE html><html lang="en"><head><title>Help for package ClusterVAR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ClusterVAR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#clusterVAR-datasets'><p>Datasets included in the ClusterVAR package</p></a></li>
<li><a href='#clusterVAR-internal'><p>Internal ClusterVAR functions</p></a></li>
<li><a href='#coef.ClusterVAR'>
<p>Show coefficients of given Model</p></a></li>
<li><a href='#LCVAR'>
<p>Fitting Latent Class VAR Models</p></a></li>
<li><a href='#numberPredictableObservations'>
<p>Determine the number of observations that can be predicted</p></a></li>
<li><a href='#plot.ClusterVAR'>
<p>Visualizing Model fit and information criteria</p></a></li>
<li><a href='#print.ClusterVAR'>
<p>Prints description of ClusterVAR objects</p></a></li>
<li><a href='#print.ClusterVARCoef'>
<p>Overview of Parameters of given Model.</p></a></li>
<li><a href='#print.ClusterVARSummary'>
<p>Print Summary of Models into Console.</p></a></li>
<li><a href='#print.PredictableObs'>
<p>Print Summary of predictable Observations into Console.</p></a></li>
<li><a href='#summary.ClusterVAR'>
<p>Summary of ClusterVAR objects</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Fitting Latent Class Vector-Autoregressive (VAR) Models</td>
</tr>
<tr>
<td>Version:</td>
<td>0.0.8</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Anja Ernst &lt;a.f.ernst@rug.nl&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimates latent class vector-autoregressive models via EM algorithm on time-series data for model-based clustering and classification. Includes model selection criteria for selecting the number of lags and clusters.</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/anieBee/ClusterVAR/issues">https://github.com/anieBee/ClusterVAR/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, utils, graphics, grDevices, fastDummies, MASS, mvtnorm,
scales, foreach, parallel, doParallel, parabar, iterators</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-12-09 12:36:57 UTC; anja</td>
</tr>
<tr>
<td>Author:</td>
<td>Anja Ernst [aut, cre],
  Jonas Haslbeck [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-12-09 13:40:25 UTC</td>
</tr>
</table>
<hr>
<h2 id='clusterVAR-datasets'>Datasets included in the ClusterVAR package</h2><span id='topic+ExampleData'></span><span id='topic+SyntheticData'></span>

<h3>Description</h3>

<p>Internal clusterVAR datasets.</p>


<h3>Details</h3>

<p>SyntheticData: Follows the structure where a 'Beep' variable and a 'Day' variable together indicate the time-point of the measurement. This data has missing observations that have been removed.
</p>
<p>ExampleData: Follows the structure where a single 'Time' variable indicates the time-point of the measurement. This data is generated from a 2 cluster model wtih 1 lag for both clusters (i.e., a c(1, 1) Model).
</p>


<h3>Author(s)</h3>

<p>Anja Ernst &amp; Jonas Haslbeck</p>

<hr>
<h2 id='clusterVAR-internal'>Internal ClusterVAR functions</h2><span id='topic+checkVarianceY'></span><span id='topic+plotHeat'></span><span id='topic+DetPredSubj'></span><span id='topic+calculateICL'></span><span id='topic+calculateBIC'></span><span id='topic+InitPseudoRand'></span><span id='topic+InitRat'></span><span id='topic+reorderLags'></span><span id='topic+determineLagOrder'></span><span id='topic+createX'></span><span id='topic+createOutputList'></span><span id='topic+constraintsOnB'></span><span id='topic+checkSingularitySigma'></span><span id='topic+checkPosteriorsNA'></span><span id='topic+checkOutliers'></span><span id='topic+checkLikelihoodsNA'></span><span id='topic+checkConvergence'></span><span id='topic+checkComponentsCollapsed'></span><span id='topic+callEMFuncs'></span><span id='topic+callCalculateCoefficientsForRandoAndRational'></span><span id='topic+calculateW'></span><span id='topic+calculateU'></span><span id='topic+calculateTau'></span><span id='topic+calculateSigma'></span><span id='topic+calculateRatio'></span><span id='topic+calculatePosterior'></span><span id='topic+calculateNPara'></span><span id='topic+calculateLagList'></span><span id='topic+calculateIC'></span><span id='topic+calculateFYZ'></span><span id='topic+calculateCoefficientsForRandoAndRational'></span><span id='topic+calculateBandWZero'></span><span id='topic+calculateB'></span><span id='topic+calculateA'></span><span id='topic+InitFuncs'></span><span id='topic+EMInit'></span><span id='topic+EMFunc'></span>

<h3>Description</h3>

<p>Internal ClusterVAR functions.</p>


<h3>Details</h3>

<p>These are internal functions.
</p>


<h3>Value</h3>

<p>No return value, called for side effects</p>


<h3>Author(s)</h3>

<p>Anja Ernst &amp; Jonas Haslbeck</p>

<hr>
<h2 id='coef.ClusterVAR'>
Show coefficients of given Model
</h2><span id='topic+coef.ClusterVAR'></span>

<h3>Description</h3>

<p>Extracts the coefficients of a given model from the output object of the <code>LCVAR</code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ClusterVAR'
coef(object, Model,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coef.ClusterVAR_+3A_object">object</code></td>
<td>

<p>An output object of the <code>LCVAR</code> function.
</p>
</td></tr>
<tr><td><code id="coef.ClusterVAR_+3A_model">Model</code></td>
<td>

<p>An integer vector specifying the model for which coefficients should be shown. For example, <code>Model = c(1,1,2)</code> returns the coefficients of a model with three clusters (i.e., latent classes), in which the first cluster has one lag, the second cluster has 1 lag, and the third cluster has 2 lags. The vector length indicates the number of clusters in the model of interest.
</p>
</td></tr>
<tr><td><code id="coef.ClusterVAR_+3A_...">...</code></td>
<td>

<p>Pass additional arguments.
</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>Lags</code></td>
<td>
<p>An integer vector specifying for which model the coefficients are shown. For example, <code>Lags = c(1,1,2)</code> indicates a model with three clusters, in which the first cluster has one lag, the second cluster has 1 lag, and the third cluster has 2 lags. </p>
</td></tr>
<tr><td><code>Classification</code></td>
<td>
<p>The crisp classification for each individual into a cluster. Crisp classifications are made based on an individual's  modal cluster membership probabilities.</p>
</td></tr>
<tr><td><code>VAR_coefficients</code></td>
<td>
<p>The cluster-wise vector-autoregressive coefficients for each cluster.</p>
</td></tr>
<tr><td><code>Exogenous_coefficients</code></td>
<td>
<p>The cluster-wise exogenous coefficients for each cluster. The first column in each array indicates the (conditional) within-person mean in that cluster. If exogenous variable(s) were specified, the other columns indicate the influences of the exogenous variable(s) in that cluster.</p>
</td></tr>
<tr><td><code>Sigma</code></td>
<td>
<p>The cluster-wise innovation covariance matrix for each cluster.</p>
</td></tr>
<tr><td><code>Proportions</code></td>
<td>
<p>The mixing proportions for each cluster. These can be considered as the proportion of individuals belonging to the respective cluster.</p>
</td></tr>
<tr><td><code>PredictableTimepoints</code></td>
<td>
<p>The total number of time-points in this dataset that could be predicted because the previous time-point(s) were observed. In case of unequal lags across different clusters, the number of time-points for each person are weighted by their posterior cluster-membership probability.  See also <code>numberPredictableObservations()</code>.</p>
</td></tr>
<tr><td><code>Converged</code></td>
<td>
<p>A logical value that indicates whether this model converged.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Anja Ernst &amp; Jonas Haslbeck
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

LCVAR_outExample &lt;- LCVAR(Data = ExampleData,
                           yVars = 1:4, ID = 5, Beep = 6,
                           xContinuous = 7, xFactor = 8,
                           Clusters = 2, Lags = 1:2, smallestClN = 3,
                           Cores = 2, RndSeed = 3, Rand = 2,
                           it = 25)

coef(LCVAR_outExample, Model = c(1, 1))
coef(LCVAR_outExample, Model = c(2, 2))


</code></pre>

<hr>
<h2 id='LCVAR'>
Fitting Latent Class VAR Models
</h2><span id='topic+LCVAR'></span>

<h3>Description</h3>

<p>Function to fit a Latent Class VAR model with a given number of latent classes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LCVAR(Data, yVars, Beep, Day = NULL, ID,
           xContinuous = NULL, xFactor = NULL,
           Clusters, Lags, Center = FALSE,
           smallestClN = 3, Cores = 2,
           RndSeed = NULL, Rand = 50, Rational = TRUE,
           Initialization = NULL, SigmaIncrease = 10,
           it = 50, Conv = 1e-05, pbar = TRUE, verbose = TRUE,
           Covariates = "equal-within-clusters", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LCVAR_+3A_data">Data</code></td>
<td>

<p>The data provided in a data.frame.
</p>
</td></tr>
<tr><td><code id="LCVAR_+3A_yvars">yVars</code></td>
<td>

<p>An integer vector specifying the position of the column(s) in dataframe <code>Data</code> that contain the endogenous variables (= the VAR time series).
</p>
</td></tr>
<tr><td><code id="LCVAR_+3A_beep">Beep</code></td>
<td>

<p>An integer specifying the position of the column in dataframe <code>Data</code> that contains the time-point.
</p>
</td></tr>
<tr><td><code id="LCVAR_+3A_day">Day</code></td>
<td>

<p>Optional argument. An integer specifying the position of the column in dataframe <code>Data</code> that contains the variable that indicates the day of measurement. If <code>Day</code> is supplied here, measurements on the previous day are not used to predict measurements on the current day. Instead, the first <code>Lags</code> observations within each day are excluded from the calculation of VAR coefficients.
</p>
</td></tr>
<tr><td><code id="LCVAR_+3A_id">ID</code></td>
<td>

<p>An integer specifying the position of the column in dataframe <code>Data</code> that contains the ID variable for every participant.
</p>
</td></tr>
<tr><td><code id="LCVAR_+3A_xcontinuous">xContinuous</code></td>
<td>

<p>Optional argument.  An integer vector specifying the position of the column(s) in dataframe Data that contain the continuous exogenous variable(s), if present. Exogenous variables are also known as covariates or as moderators for the within-person mean.
</p>
</td></tr>
<tr><td><code id="LCVAR_+3A_xfactor">xFactor</code></td>
<td>

<p>Optional argument.  An integer vector specifying the position of the column(s) in dataframe Data that contain the categorical exogenous variable(s), if present. Exogenous variables are also known as covariates or as moderators for the within-person mean.
</p>
</td></tr>
<tr><td><code id="LCVAR_+3A_clusters">Clusters</code></td>
<td>

<p>An integer or integer vector specifying the numbers of latent classes (i.e., clusters) for which LCVAR models are to be calculated.
</p>
</td></tr>
<tr><td><code id="LCVAR_+3A_lags">Lags</code></td>
<td>

<p>An integer or integer vector specifying the number of VAR(p) lags to consider. Needs to be a sequence of subsequent integers. The maximum number supported is <code>Lags = 3</code>.
</p>
</td></tr>
<tr><td><code id="LCVAR_+3A_center">Center</code></td>
<td>

<p>Logical, indicating whether the data (i.e., the endogenous variables) should be centered per person before calculations. If <code>Center = TRUE</code>, the differences in within-person means are removed from the data and the clustering is based only on similarity in VAR coefficients and (if exogenous variable(s) are specified) similarities in infleunces of exogenous variable(s). If <code>Center = FALSE</code>, the clustering is also based on similarities in within-person means. Defaults to <code>Center = FALSE</code>.</p>
</td></tr>
<tr><td><code id="LCVAR_+3A_smallestcln">smallestClN</code></td>
<td>

<p>An integer specifying the lowest number of individuals allowed in a cluster. When during estimation the crisp cluster membership of a cluster indicates less than <code>smallestClN</code> individuals, the covariance matrix and the posterior probabilities of cluster membership are reset. Defaults to <code>smallestClN = 3</code>.
</p>
</td></tr>
<tr><td><code id="LCVAR_+3A_cores">Cores</code></td>
<td>

<p>A positive integer specifying the number of cores used to parallelize the computations. Specifying a high number of available cores can speed up computation. Defaults to <code>Cores = 2</code>.
</p>
</td></tr>
<tr><td><code id="LCVAR_+3A_rndseed">RndSeed</code></td>
<td>

<p>Optional argument. An integer specifying the value supplied to <code>set.seed()</code>, which guarantees reproducible results. If not specified, no seed is set.
</p>
</td></tr>
<tr><td><code id="LCVAR_+3A_rand">Rand</code></td>
<td>

<p>The number of pseudo-random EM-starts used in fitting each possible model. For pseudo-random starts K individuals are randomly selected as cluster centres. Then individuals are partitioned into the cluster to which their individual VAR and individual covariate coefficients are closest. High numbers (e.g., 50 and above) ensure that a global optimum will be found, but will take longer to compute. Defaults to <code>Rand = 50</code>.
</p>
</td></tr>
<tr><td><code id="LCVAR_+3A_rational">Rational</code></td>
<td>

<p>Logical, indicating whether a rational EM-start should be used in addition to the other EM-starts. Defaults to <code>Rational = TRUE</code>. Rational starts are based on the k-means partitioning of individuals’ ideographic VAR and ideographic covariate coefficients.
</p>
</td></tr>
<tr><td><code id="LCVAR_+3A_initialization">Initialization</code></td>
<td>

<p>Optional argument. An integer specifying the position of a column in dataframe <code>Data</code> that contains a guess at participants' cluster membership for a fixed number of clusters, if available. This initialization will be used as an additional EM-start.
</p>
</td></tr>
<tr><td><code id="LCVAR_+3A_sigmaincrease">SigmaIncrease</code></td>
<td>

<p>A numerical value specifying the value by which every element of Sigma will be increased when posterior probabilities of cluster memberships are reset. Defaults to <code>SigmaIncrease = 10</code>.
</p>
</td></tr>
<tr><td><code id="LCVAR_+3A_it">it</code></td>
<td>

<p>An integer specifying the maximum number of EM-iterations allowed for every EM-start. After completing <code>it</code> EM-iterations, an EM-start is forced to terminate. High numbers (e.g., 100 and above) ensure convergence, but will take longer to compute. Defaults to <code>it = 50</code>.
</p>
</td></tr>
<tr><td><code id="LCVAR_+3A_conv">Conv</code></td>
<td>

<p>A numerical value specifying the convergence criterion of the log likelihood to determine convergence of an EM-start. For details see Ernst et al. (2020) Inter-individual differences in multivariate time series: Latent class vector-autoregressive modelling.  Defaults to <code>Conv = 1e-05</code>.
</p>
</td></tr>
<tr><td><code id="LCVAR_+3A_pbar">pbar</code></td>
<td>

<p>If <code>pbar = TRUE</code>, a progress bar is shown. Defaults to <code>pbar = TRUE</code>.</p>
</td></tr>
<tr><td><code id="LCVAR_+3A_verbose">verbose</code></td>
<td>
<p>If <code>verbose = FALSE</code>, output messages are limited. Additionally, the <code>pbar</code> argument is overridden, so the progress bar is not printed. Defaults to <code>verbose = TRUE</code>.</p>
</td></tr>
<tr><td><code id="LCVAR_+3A_covariates">Covariates</code></td>
<td>

<p>Constraints on the parameters of the exogenous variable(s). So far only <code>Covariates = "equal-within-clusters"</code> can be specified.</p>
</td></tr>
<tr><td><code id="LCVAR_+3A_...">...</code></td>
<td>

<p>Additional arguments passed to the function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function estimates the latent class vector-autoregressive model to obtain latent classes (i.e., clusters) of individuals who are similar in VAR coefficients and (if specified) in within-person means and infleunces of exogenous variable(s).
</p>
<p style="text-align: center;"><code class="reqn">y_{i, t} =  w_{i, t} + \mu_{k} + \beta_{k} x_{i, t}</code>
</p>

<p style="text-align: center;"><code class="reqn"> w_{i, t} = (\sum_{a = 1}^{p} \Phi_{k, a} w_{i, t-a}) + u_{i, t}\qquad u_{i, t} \sim N(0, \Sigma_{k})</code>
</p>

<p>Here <code class="reqn"> \mu_{k}</code> represents an m x 1 vector that contains the cluster-wise conditional within-person mean for each y-variable in cluster k. <code class="reqn">\beta_{k}</code> represents an m x q matrix that expresses the cluster-wise moderating influence of q exogenous variables (<code class="reqn">x_{i, t}</code>) on the within-person means in cluster k.
<code class="reqn">\Phi_{k, a}</code> represents an m×m matrix containing the cluster-wise VAR coefficients at lag a for cluster k. See the references below for details.
</p>


<h3>Value</h3>

<p>An object of class 'ClusterVAR' providing several LCVAR models.
The details of the output components are as follows:
</p>
<table role = "presentation">
<tr><td><code>Call</code></td>
<td>
<p>A list of arguments from the original function call.</p>
</td></tr>
<tr><td><code>All_Models</code></td>
<td>
<p>All LCVAR models across all number of clusters, lag combinations, and number of EM-starts. <code>All_Models[[a]][[b]][[c]]</code>  contains all information for the LCVAR model for the <code>a</code>th number of clusters that was specified in <code>Clusters</code>, for the <code>b</code>th combination of lag orders, based on the combination of lags that was specified in <code>Lags</code>, on the <code>c</code>th EM-start. To find the ideal model across all of them use <code>summary()</code>, to view the coefficients of a given model, use <code>coef()</code>.</p>
</td></tr>
<tr><td><code>Runtime</code></td>
<td>
<p>The runtime the function took to complete.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Anja Ernst
</p>


<h3>References</h3>

<p>Ernst, A. F., Albers, C. J., Jeronimus, B. F., &amp; Timmerman, M. E. (2020). Inter-individual differences in multivariate time-series: Latent class vector-autoregressive modeling. European Journal of Psychological Assessment, 36(3), 482–491. <a href="https://doi.org/10.1027/1015-5759/a000578">doi:10.1027/1015-5759/a000578</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>


head(SyntheticData)
LCVAR_outExample1 &lt;- LCVAR(Data = SyntheticData,
                           yVars = 1:4, ID = 5, Beep = 9, Day = 10,
                           xContinuous = 7, xFactor = 8,
                           Clusters = 1:2, Lags = 1,
                           Center = TRUE,
                           Cores = 2, # Adapt to local machine
                           RndSeed = 123, Rand = 1, it = 25)
summary(LCVAR_outExample1)
summary(object = LCVAR_outExample1, show = "GNL", Number_of_Lags = 1)
coef(LCVAR_outExample1, Model = c(1, 1))


head(ExampleData)
LCVAR_outExample2 &lt;- LCVAR(Data = ExampleData,
                           yVars = 1:4, ID = 5, Beep = 6,
                           xContinuous = 7, xFactor = 8,
                           Clusters = 1:2, Lags = 1:2,
                           Center = FALSE,
                           Cores = 2, RndSeed = 123,
                           Rand = 1,
                           it = 25, Conv = 1e-05)
summary(LCVAR_outExample2)
summary(object = LCVAR_outExample2, show = "GNL", Number_of_Lags = 1)
summary(object = LCVAR_outExample2, show = "GNC", Number_of_Clusters = 2)
coef(LCVAR_outExample2, Model = c(1, 1))
plot(LCVAR_outExample2, show = "specific", Model = c(1, 1))


LCVAR_outExample3 &lt;- LCVAR(Data = ExampleData,
                           yVars = c("Item1", "Item2","Item3", "Item4"),
                           ID = "Person", Beep = "Timepoint",
                           xContinuous = "ContiniousVariable",
                           xFactor = "CategoricalVariable",
                           Clusters = 1:2, Lags = 1:2,
                           Center = FALSE,
                           Cores = 2, RndSeed = 123,
                           Rand = 1,
                           it = 25, Conv = 1e-05)
plot(LCVAR_outExample3, show = "GNL", Number_of_Lags = 1)
plot(LCVAR_outExample3, show = "GNC", Number_of_Clusters = 2)


</code></pre>

<hr>
<h2 id='numberPredictableObservations'>
Determine the number of observations that can be predicted
</h2><span id='topic+numberPredictableObservations'></span>

<h3>Description</h3>

<p><code>numberPredictableObservations</code> is a function to determine the number of observations in a given dataset that can be predicted based on the availability of previous observations, considering a specified time-lag.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>numberPredictableObservations(Data, yVars, Beep, Day = NULL, ID,
                              xContinuous = NULL, xFactor = NULL, Lags, ...)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="numberPredictableObservations_+3A_data">Data</code></td>
<td>

<p>The data provided in a data.frame.
</p>
</td></tr>
<tr><td><code id="numberPredictableObservations_+3A_yvars">yVars</code></td>
<td>

<p>An integer vector specifying the position of the column(s) in dataframe <code>Data</code> that contain the endogenous variables (= the VAR time series).
</p>
</td></tr>
<tr><td><code id="numberPredictableObservations_+3A_beep">Beep</code></td>
<td>

<p>An integer specifying the position of the column in dataframe <code>Data</code> that contains the time-point.
</p>
</td></tr>
<tr><td><code id="numberPredictableObservations_+3A_day">Day</code></td>
<td>

<p>Optional. An integer specifying the position of the column in dataframe <code>Data</code> that contains the variable that indicates the day of measurement. If <code>Day</code> is supplied here, measurements on the previous day are not used to predict measurements on the current day. Instead, the first <code>Lags</code> observations within each day are excluded from the calculation of VAR coefficients.
</p>
</td></tr>
<tr><td><code id="numberPredictableObservations_+3A_id">ID</code></td>
<td>

<p>An integer specifying the position of the column in dataframe <code>Data</code> that contains the ID variable for every participant.
</p>
</td></tr>
<tr><td><code id="numberPredictableObservations_+3A_xcontinuous">xContinuous</code></td>
<td>

<p>Optional argument.  An integer vector specifying the position of the column(s) in dataframe Data that contain the continuous exogenous variable(s), if present. Exogenous variables are also known as covariates or as moderators for the within-person mean.
</p>
</td></tr>
<tr><td><code id="numberPredictableObservations_+3A_xfactor">xFactor</code></td>
<td>

<p>Optional argument.  An integer vector specifying the position of the column(s) in dataframe Data that contain the categorical exogenous variable(s), if present. Exogenous variables are also known as covariates or as moderators for the within-person mean.
</p>
</td></tr>
<tr><td><code id="numberPredictableObservations_+3A_lags">Lags</code></td>
<td>

<p>An integer or integer vector specifying the number of VAR(p) lags to consider. Needs to be a sequence of subsequent integers. The maximum number supported is <code>Lags = 3</code>.
</p>
</td></tr>
<tr><td><code id="numberPredictableObservations_+3A_...">...</code></td>
<td>

<p>Additional arguments passed to the function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function determines the number of observations in a given dataset that can be predicted based on previous observations. For instance, in a lag-1 model, if an observation is missing, the observation at the next time-point cannot be predicted. Similarly, in a lag-2 model, if an observation is missing, the observations at the next two time-points cannot be predicted. The output gives the number of predictable observations for each of the endogenous variables that was specified under <code>yVars</code>. The number of predictable observations is the same for all endogenous variables.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>Predictable observations per subject</code></td>
<td>
<p>The number of predictable observations for each endogenous variable per subject, considering a specified time-lag.</p>
</td></tr>
<tr><td><code>Total predictable observations</code></td>
<td>
<p>The total number of predictable observations summed over all subjects in the dataset for each endogenous variable, considering a specified time-lag.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Anja Ernst &amp; Jonas Haslbeck
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
head(SyntheticData)

Obs &lt;- numberPredictableObservations(Data = SyntheticData, yVars = 1:4,
                                      Beep = 9, Day = 10,  ID = 5, Lags = 1:3)

Obs

Obs$`Predictable observations per subject`$`1 Lag`


</code></pre>

<hr>
<h2 id='plot.ClusterVAR'>
Visualizing Model fit and information criteria
</h2><span id='topic+plot.ClusterVAR'></span>

<h3>Description</h3>

<p>Creates a variety of plots summarizing fitted LCVAR models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ClusterVAR'
plot(x,
    show,
    Number_of_Clusters = NULL,
    Number_of_Lags = NULL,
    Model = NULL,
    mar_heat = c(2.5,2.5,2,1),
    ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.ClusterVAR_+3A_x">x</code></td>
<td>

<p>An output object of the <code>ClusterVAR</code> function
</p>
</td></tr>
<tr><td><code id="plot.ClusterVAR_+3A_show">show</code></td>
<td>

<p>Indicate summaries to plot. <code>show = "GNC"</code> compares models with different lags for a given number of clusters, specified with <code>Number_of_Clusters</code>. <code>show = "GNL"</code> compares models with different number of clusters, given the a number of lags specified with <code>Number_of_Lags</code>.
</p>
<p>Alternatively, the VAR matrices of a specific model can be visualized. <code>show = specific</code> visualizes the VAR matrices across clusters for a given model which is specified with the argument <code>Model</code>. <code>show = specificDiff</code> displays the pairwise differences between clusters for a specific model, also specified with the argument <code>Model</code>. <code>show = specific</code> and <code>show = specificDiff</code> are currently only implemented for models with 1 lag.
</p>
</td></tr>
<tr><td><code id="plot.ClusterVAR_+3A_number_of_clusters">Number_of_Clusters</code></td>
<td>

<p>An integer. Specify the fixed number of clusters when using <code>show = "GNC"</code>. Defaults to <code>Number_of_Clusters = NULL</code>
</p>
</td></tr>
<tr><td><code id="plot.ClusterVAR_+3A_number_of_lags">Number_of_Lags</code></td>
<td>

<p>An integer. Specify the fixed number of lags when using <code>show = "GNL"</code>. Defaults to <code>Number_of_Lags =</code> the lowest number of lags specified in object.
</p>
</td></tr>
<tr><td><code id="plot.ClusterVAR_+3A_model">Model</code></td>
<td>

<p>An integer vector. Specify when using <code>show = "specific"</code> or <code>show = specificDef</code>. Indicates the model for which coefficients should be plotted. For example, <code>Model = c(1,1,1)</code> plots a model with three clusters and each cluster has 1 lag. Defaults to <code>Model = NULL</code>.
</p>
</td></tr>
<tr><td><code id="plot.ClusterVAR_+3A_mar_heat">mar_heat</code></td>
<td>

<p>A numeric vector. Optional when using <code>show = "specific"</code> to specify the margins of the heatplot. Defaults to <code>mar_heat = c(2.5,2.5,2,1)</code>.
</p>
</td></tr>
<tr><td><code id="plot.ClusterVAR_+3A_...">...</code></td>
<td>

<p>Pass additional arguments.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Creates different plots showing either a fitted LCVAR model or fit indices for a specified set of LCVAR models.
</p>


<h3>Value</h3>

<p>No return value, just plots figure.</p>


<h3>Author(s)</h3>

<p>Anja Ernst &amp; Jonas Haslbeck
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
LCVAR_outExample &lt;- LCVAR(Data = ExampleData,
                          yVars = 1:4, ID = 5, Beep = 6,
                          xContinuous = 7, xFactor = 8,
                          Clusters = 1:2, Lags = 1:2,
                          Center = FALSE, Cores = 2,
                          RndSeed = 3, Rand = 2,
                          it = 25)

plot(LCVAR_outExample, show = "GNL", Number_of_Lags = 1)
plot(LCVAR_outExample, show = "GNC", Number_of_Clusters = 2)
plot(LCVAR_outExample, show = "specific", Model = c(1, 1))
plot(LCVAR_outExample, show = "specific", Model = c(1, 1), labels = c("A", "B", "C","D"))
plot(LCVAR_outExample, show = "specificDiff", Model = c(1, 1))

</code></pre>

<hr>
<h2 id='print.ClusterVAR'>
Prints description of ClusterVAR objects
</h2><span id='topic+print.ClusterVAR'></span>

<h3>Description</h3>

<p>Takes the output of the ClusterVAR object and prints a small overview of the fitted model(s).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ClusterVAR'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.ClusterVAR_+3A_x">x</code></td>
<td>

<p>An output object of the <code>LCVAR</code> function
</p>
</td></tr>
<tr><td><code id="print.ClusterVAR_+3A_...">...</code></td>
<td>

<p>Pass additional arguments
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Prints an overview of the fitted model(s) in the console.
</p>


<h3>Value</h3>

<p>No return value, just returns summary in console.</p>


<h3>Author(s)</h3>

<p>Anja Ernst &amp; Jonas Haslbeck
</p>

<hr>
<h2 id='print.ClusterVARCoef'>
Overview of Parameters of given Model.
</h2><span id='topic+print.ClusterVARCoef'></span>

<h3>Description</h3>

<p>Overview of Parameters of given Model.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ClusterVARCoef'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.ClusterVARCoef_+3A_x">x</code></td>
<td>

<p>An output object of the <code>coef.ClusterVAR</code> function.
</p>
</td></tr>
<tr><td><code id="print.ClusterVARCoef_+3A_...">...</code></td>
<td>

<p>Pass additional arguments.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Prints an overview of the fitted model in the console.
</p>


<h3>Author(s)</h3>

<p>Anja Ernst &amp; Jonas Haslbeck
</p>

<hr>
<h2 id='print.ClusterVARSummary'>
Print Summary of Models into Console.
</h2><span id='topic+print.ClusterVARSummary'></span>

<h3>Description</h3>

<p>Print Summary of Models into Console.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ClusterVARSummary'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.ClusterVARSummary_+3A_x">x</code></td>
<td>

<p>An output object of the <code>summary.ClusterVAR</code> function.
</p>
</td></tr>
<tr><td><code id="print.ClusterVARSummary_+3A_...">...</code></td>
<td>

<p>Pass additional arguments.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Prints the summary of the fitted models in the console.
</p>


<h3>Author(s)</h3>

<p>Anja Ernst &amp; Jonas Haslbeck
</p>

<hr>
<h2 id='print.PredictableObs'>
Print Summary of predictable Observations into Console.
</h2><span id='topic+print.PredictableObs'></span>

<h3>Description</h3>

<p>Print Summary of predictable Observations into Console.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>    ## S3 method for class 'PredictableObs'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.PredictableObs_+3A_x">x</code></td>
<td>

<p>An output object of the <code>numberPredictableObservations</code> function.
</p>
</td></tr>
<tr><td><code id="print.PredictableObs_+3A_...">...</code></td>
<td>

<p>Pass additional arguments.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Prints the summary of the number of predictable Observations in the console.
</p>


<h3>Author(s)</h3>

<p>Anja Ernst &amp; Jonas Haslbeck
</p>

<hr>
<h2 id='summary.ClusterVAR'>
Summary of ClusterVAR objects
</h2><span id='topic+summary.ClusterVAR'></span>

<h3>Description</h3>

<p>Takes the output of the LCVAR function and creates a small summary of the fitted model(s).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ClusterVAR'
summary(object,
  show = "BPC",
  TS_criterion = "SC",
  global_criterion = "BIC",
  Number_of_Clusters = NULL,
  Number_of_Lags = NULL,
  ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.ClusterVAR_+3A_object">object</code></td>
<td>

<p>An output object of the <code>LCVAR</code> function.
</p>
</td></tr>
<tr><td><code id="summary.ClusterVAR_+3A_show">show</code></td>
<td>

<p>Indicate how models should be summarized, the possible choices are <code>"BPC"</code>, <code>"GNC"</code>and <code>"GNL"</code>. <code>show = "BPC"</code> compares models with different time lags for each number of clusters. If <code>show = "BPC"</code>, for each number of clusters the model with the best lag is selected and displayed in the output. The best lag is selected through the time-series information criterion specified with the argument <code>TS_criterion</code> (see below). <code>show = "GNC"</code> shows all models with different lags for a given number of clusters, this number of clusters is specified through <code>Number_of_Clusters</code> (see below). <code>show = "GNL"</code> shows for each number of clusters the model where all lags are fixed to a given number, this number of lags is specified through <code>Number_of_Lags</code> (see below). Out of these models, the best model in terms of the number of clusters is selected by the information criterion selected with the argument <code>global_criterion</code> (see below). Defaults to <code>show = "BPC"</code>.
</p>
</td></tr>
<tr><td><code id="summary.ClusterVAR_+3A_ts_criterion">TS_criterion</code></td>
<td>

<p>The information criterion to select the best model between models with a different number of lags but with the same number of clusters. The possible choices are <code>"SC"</code> and <code>"HQ"</code>. Defaults to <code>TS_criterion = "SC"</code>.
</p>
</td></tr>
<tr><td><code id="summary.ClusterVAR_+3A_global_criterion">global_criterion</code></td>
<td>

<p>The information criterion to select the best model between models with different numbers of clusters but with the same number of lags. The possible choices are <code>"BIC"</code> and <code>"ICL"</code>. Defaults to <code>global_criterion = "BIC"</code>.
</p>
</td></tr>
<tr><td><code id="summary.ClusterVAR_+3A_number_of_clusters">Number_of_Clusters</code></td>
<td>

<p>An integer. Specify the fixed number of clusters when using <code>show = "GNC"</code>. Defaults to <code>Number_of_Clusters = NULL</code>.
</p>
</td></tr>
<tr><td><code id="summary.ClusterVAR_+3A_number_of_lags">Number_of_Lags</code></td>
<td>

<p>An integer. Specify the fixed number of lags when using <code>show = "GNL"</code>. Defaults to <code>Number_of_Lags = </code> the lowest number of lags specified in object.
</p>
</td></tr>
<tr><td><code id="summary.ClusterVAR_+3A_...">...</code></td>
<td>

<p>Pass additional arguments.
</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>FunctionOutput</code></td>
<td>
<p>Is a data frame containing summaries of the fitted models.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Anja Ernst &amp; Jonas Haslbeck
</p>


<h3>References</h3>

<p>Hamilton, J. (1994), Time Series Analysis, Princeton University Press, Princeton.
</p>
<p>Hannan, E. J. and B. G. Quinn (1979), The determination of the order of an autoregression, Journal of the Royal Statistical Society.
</p>
<p>Lütkepohl, H. (2006), New Introduction to Multiple Time Series Analysis, Springer, New York.
</p>
<p>Quinn, B. (1980), Order determination for a multivariate autoregression, Journal of the Royal Statistical Society.
</p>
<p>Biernacki, C., Celeux, G., &amp; Govaert, G. (2000). Assessing a mixture model for clustering with
the integrated completed likelihood. IEEE Transactions on Pattern Analysis and Machine
Intelligence.
</p>
<p>Schwarz, G. (1978). Estimating the Dimension of a Model. The Annals of Statistics.
</p>


<h3>See Also</h3>

<p><code>plot.ClusterVAR()</code>, <code>coef.ClusterVAR()</code></p>


<h3>Examples</h3>

<pre><code class='language-R'>

LCVAR_outExample &lt;- LCVAR(Data = ExampleData,
                          yVars = 1:4, ID = 5, Beep = 6,
                          xContinuous = 7, xFactor = 8,
                          Clusters = 1:2, Lags = 1:2,
                          Cores = 2, RndSeed = 3,
                          Rand = 2, it = 25)

summary(LCVAR_outExample)
summary(object = LCVAR_outExample, show = "GNL", Number_of_Lags = 1)
summary(object = LCVAR_outExample, show = "GNL", Number_of_Lags = 1, global_criterion = "ICL")
summary(object = LCVAR_outExample, show = "GNC", Number_of_Clusters = 2)
summary(object = LCVAR_outExample, show = "GNC", Number_of_Clusters = 2, TS_criterion = "HQ")


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
