<!DOCTYPE html><html><head><title>Help for package dlsem</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {dlsem}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#agres'><p>European agricultural data</p></a></li>
<li><a href='#as.graphNEL'><p>Conversion into the <code>graphNEL</code> class</p></a></li>
<li><a href='#auto.lagPlot'><p>Automated plot of lag shapes</p></a></li>
<li><a href='#autoCode'><p>Automated model code</p></a></li>
<li><a href='#causalEff'><p>Assessment of dynamic causal effects</p></a></li>
<li><a href='#compareModels'><p>Comparison among different distributed-lag linear structural equation models</p></a></li>
<li><a href='#dlsem'><p>Parameter estimation</p></a></li>
<li><a href='#dlsem-package'><p>Distributed-lag linear structural equation models</p></a></li>
<li><a href='#drawSample'><p>Sampling from a distributed-lag linear structural equation model</p></a></li>
<li><a href='#ecq'><p>Lag shape constructors</p></a></li>
<li><a href='#industry'><p>Industrial development</p></a></li>
<li><a href='#isIndep'><p>Conditional independence check</p></a></li>
<li><a href='#lagPlot'><p>Plot of lag shapes</p></a></li>
<li><a href='#lagShapes'><p>Estimated lag shapes</p></a></li>
<li><a href='#lmHAC'><p>Heteroskedasticty and autocorrelation consistent covariance matrix</p></a></li>
<li><a href='#residualPlot'><p>Plot for diagnostics of the residuals in a distributed-lag structural equation model.</p></a></li>
<li><a href='#unirootTest'><p>Unit root test</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Distributed-Lag Linear Structural Equation Models</td>
</tr>
<tr>
<td>Version:</td>
<td>2.4.6</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-03-23</td>
</tr>
<tr>
<td>Author:</td>
<td>Alessandro Magrini</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Alessandro Magrini &lt;alessandro.magrini@unifi.it&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Inference functionalities for distributed-lag linear structural equation models (DLSEMs). DLSEMs are Markovian structural causal models where each factor of the joint probability distribution is a distributed-lag linear regression with constrained lag shapes (Magrini, 2018 &lt;<a href="https://doi.org/10.2478%2Fbile-2018-0012">doi:10.2478/bile-2018-0012</a>&gt;; Magrini et al., 2019 &lt;<a href="https://doi.org/10.1007%2Fs11135-019-00855-z">doi:10.1007/s11135-019-00855-z</a>&gt;). DLSEMs account for temporal delays in the dependence relationships among the variables through a single parameter per covariate, thus allowing to perform dynamic causal inference in a feasible fashion. Endpoint-constrained quadratic, quadratic decreasing, linearly decreasing and gamma lag shapes are available.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), graph, Rgraphviz</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-04-16 15:45:35 UTC; Alessandro</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-04-16 16:10:11 UTC</td>
</tr>
</table>
<hr>
<h2 id='agres'>European agricultural data</h2><span id='topic+agres'></span>

<h3>Description</h3>

<p>Data on research expenditure, research activity, productivity and impacts of Agriculture from 1990 to 2014 in EU 15 countries.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(agres)</code></pre>


<h3>Format</h3>

<p>A data frame with a total of 350 observations on the following 20 variables:
</p>

<dl>
<dt><code>COUNTRY</code></dt><dd><p>Code of the country. Belgium and Luxembourg are merged together with code <code>BL</code>.</p>
</dd>
<dt><code>YEAR</code></dt><dd><p>Year.</p>
</dd>
<dt><code>GDP</code></dt><dd><p>Gross domestic product (million euro PPS). Source: Eurostat.</p>
</dd>
<dt><code>EMPL_AGR</code></dt><dd><p>Persons employed in Agriculture (count). Source: Eurostat.</p>
</dd>
<dt><code>UAA</code></dt><dd><p>Utilized agricultural area (hectares). Source: Eurostat.</p>
</dd>
<dt><code>PATENT_OTHER</code></dt><dd><p>Mechanical, chemical and environment-related patent applications (count). Source: OECD.</p>
</dd>
<dt><code>GBAORD_AGR</code></dt><dd><p>Government research expenditure (million euro PPS). Source: OECD.</p>
</dd>
<dt><code>BERD_AGR</code></dt><dd><p>Business enterprise research expenditure (million euro PPS). Source: Eurostat.</p>
</dd>
<dt><code>RD_EDU_AGR</code></dt><dd><p>Agricultural researchers with tertiary education (count). Source: OECD.</p>
</dd>
<dt><code>PATENT_AGR</code></dt><dd><p>Agricultural patent applications (count). Source: OECD.</p>
</dd>
<dt><code>TFP_AGR</code></dt><dd><p>Total factor productivity (index 2005=100). Source: USDA.</p>
</dd>
<dt><code>GVA_AGR</code></dt><dd><p>Gross value added of Agriculture (international dollars). Source: Faostat.</p>
</dd>
<dt><code>PPI_AGR</code></dt><dd><p>Producer price of agricultural output (index 2005=100). Source: Faostat.</p>
</dd>
<dt><code>ENTR_INCOME_AGR</code></dt><dd><p>Net entrepreneurial income of Agriculture (index 2005=100). Source: Eurostat.</p>
</dd>
<dt><code>GHG_AGR</code></dt><dd><p>Greenhouse gas emissions due to Agriculture (gigagrams CO2 equivalent). Source: Faostat.</p>
</dd>
<dt><code>NBAL_AGR</code></dt><dd><p>Nitrogen gross nutrient balance (kg of nutrient per hectare). Source: Eurostat.</p>
</dd>
<dt><code>INCOME_RURAL</code></dt><dd><p>Mean familiar income in rural areas (international dollars).</p>
</dd>
<dt><code>UNEMPL_RURAL</code></dt><dd><p>Unemployment rate in rural areas (index 2005=100).</p>
</dd>
</dl>


<hr>
<h2 id='as.graphNEL'>Conversion into the <code>graphNEL</code> class</h2><span id='topic+as.graphNEL'></span>

<h3>Description</h3>

<p>An object of class <code>dlsem</code> is converted into an object of class <code>graphNEL</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.graphNEL(x, conf = 0.95, use.ns = FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.graphNEL_+3A_x">x</code></td>
<td>
<p>An object of class <code>dlsem</code>.</p>
</td></tr>
<tr><td><code id="as.graphNEL_+3A_conf">conf</code></td>
<td>
<p>The confidence level for each edge: only edges with statistically significant causal effect at such confidence are considered. Default is 0.95.</p>
</td></tr>
<tr><td><code id="as.graphNEL_+3A_use.ns">use.ns</code></td>
<td>
<p>A logical value indicating whether edges without statistically significant causal effect (at level <code>conf</code>) should be considered or not. If <code>FALSE</code> (the default), they will be ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>graphNEL</code>.</p>


<h3>See Also</h3>

<p><a href="#topic+dlsem">dlsem</a>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(industry)
indus.code &lt;- list(
  Consum~ecq(Job,0,5),
  Pollution~ecq(Job,1,8)+ecq(Consum,1,7)
  )
indus.mod &lt;- dlsem(indus.code,group="Region",exogenous=c("Population","GDP"),data=industry,
  log=TRUE)
as.graphNEL(indus.mod)
</code></pre>

<hr>
<h2 id='auto.lagPlot'>Automated plot of lag shapes</h2><span id='topic+auto.lagPlot'></span>

<h3>Description</h3>

<p>All the single-edge pathwise causal lag shapes are saved as pdf files.</p>


<h3>Usage</h3>

<pre><code class='language-R'>auto.lagPlot(x, cumul = FALSE, conf = 0.95, plotDir = NULL)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="auto.lagPlot_+3A_x">x</code></td>
<td>
<p>An object of class <code>dlsem</code>.</p>
</td></tr>
<tr><td><code id="auto.lagPlot_+3A_cumul">cumul</code></td>
<td>
<p>Logical. If <code>TRUE</code>, cumulative causal effects are displayed. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="auto.lagPlot_+3A_conf">conf</code></td>
<td>
<p>The confidence level for each plot. Default is 0.95.</p>
</td></tr>
<tr><td><code id="auto.lagPlot_+3A_plotdir">plotDir</code></td>
<td>
<p>The directory where to save the plots. If <code>NULL</code> (the default), plots will be saved in the current working directory.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><a href="#topic+dlsem">dlsem</a>; <a href="#topic+lagPlot">lagPlot</a>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(industry)
indus.code &lt;- list(
  Consum~ecq(Job,0,5),
  Pollution~ecq(Job,1,8)+ecq(Consum,1,7)
  )
indus.mod &lt;- dlsem(indus.code,group="Region",exogenous=c("Population","GDP"),data=industry,
  log=TRUE)
## NOT RUN:
# auto.lagPlot(indus.mod,plotDir=getwd())
</code></pre>

<hr>
<h2 id='autoCode'>Automated model code</h2><span id='topic+autoCode'></span>

<h3>Description</h3>

<p>Given a set of variable names, a model code including all the possible edges is built.</p>


<h3>Usage</h3>

<pre><code class='language-R'>autoCode(var.names, lag.type = "ecq")</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="autoCode_+3A_var.names">var.names</code></td>
<td>
<p>A vector containing the names of the variables, which must be at least of length 2.</p>
</td></tr>
<tr><td><code id="autoCode_+3A_lag.type">lag.type</code></td>
<td>
<p>The type of lag shape, which will be applied to all variables and must be one among 'ecq', 'qd', 'ld', 'gam' and 'none'. Default is 'ecq'.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of formulas to be passed as argument <code>model.code</code> in <code>dlsem()</code>.</p>


<h3>See Also</h3>

<p><a href="#topic+dlsem">dlsem</a>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>autoCode(c("Job","Consum","Pollution"),lag.type="ecq")
</code></pre>

<hr>
<h2 id='causalEff'>Assessment of dynamic causal effects</h2><span id='topic+causalEff'></span>

<h3>Description</h3>

<p>All the pathwise causal lag shapes and the overall one connecting two or more variables are computed.</p>


<h3>Usage</h3>

<pre><code class='language-R'>causalEff(x, from = NULL, to = NULL, lag = NULL, cumul = FALSE, conf = 0.95,
  use.ns = FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="causalEff_+3A_x">x</code></td>
<td>
<p>An object of class <code>dlsem</code>.</p>
</td></tr>
<tr><td><code id="causalEff_+3A_from">from</code></td>
<td>
<p>The name of the starting variable, or a vector containing the names of starting variables, which must be endogenous variables.</p>
</td></tr>
<tr><td><code id="causalEff_+3A_to">to</code></td>
<td>
<p>The name of the ending variable, which must be an endogenous variable.</p>
</td></tr>
<tr><td><code id="causalEff_+3A_lag">lag</code></td>
<td>
<p>A non-negative integer or a vector of non-negative integers indicating the time lags to be considered. If <code>NULL</code>, the whole lag shapes will be considered.</p>
</td></tr>
<tr><td><code id="causalEff_+3A_cumul">cumul</code></td>
<td>
<p>Logical. If <code>TRUE</code>, cumulative causal effects are returned. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="causalEff_+3A_conf">conf</code></td>
<td>
<p>The confidence level. Default is 0.95.</p>
</td></tr>
<tr><td><code id="causalEff_+3A_use.ns">use.ns</code></td>
<td>
<p>A logical value indicating whether edges without statistically significant causal effect (at level <code>conf</code>) should be considered or not. If <code>FALSE</code> (the default), they will be ignored.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A <em>pathwise causal lag shape</em> is the set of causal effects associated to a path at different time lags.
An <em>overall causal lag shape</em> is the set of overall causal effects of a variable on another one at different time lags.
</p>
<p>Note that, due to the properties of the multiple linear regression model,
causal effects are net of the influence of the group factor and exogenous variables.
</p>


<h3>Value</h3>

<p>A list containing several matrices including point estimates, standard errors and asymptotic confidence intervals (at level <code>conf</code>) for all the pathwise causal lag shapes and the overall one connecting the starting variables to the ending variable.
</p>


<h3>Note</h3>

<p>Value <code>NULL</code> is returned if one of the following occurs:
(i) no significant path at confidence level <code>conf</code> exists connecting the starting variables to the ending variable;
(ii) the requested path does not exist or is not significant at confidence level <code>conf</code>.
Note that the edges between the starting variables and their respective parents are deleted
as a consequence of intervention. 
See Magrini (2018) for technical details on causal inference in distributed-lag linear structural equation models.
</p>


<h3>References</h3>

<p>A. Magrini (2018). Linear Markovian models for lag exposure assessment. Biometrical Letters, 55(2): 179-195. DOI: 10.2478/bile-2018-0012.
</p>





<h3>See Also</h3>

<p><a href="#topic+dlsem">dlsem</a>; <a href="#topic+lagPlot">lagPlot</a>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(industry)
indus.code &lt;- list(
  Consum~ecq(Job,0,5),
  Pollution~ecq(Job,1,8)+ecq(Consum,1,7)
  )
indus.mod &lt;- dlsem(indus.code,group="Region",exogenous=c("Population","GDP"),data=industry,
  log=TRUE)
causalEff(indus.mod,from="Job",to="Pollution",lag=c(0,5,10,15),cumul=TRUE)
</code></pre>

<hr>
<h2 id='compareModels'>Comparison among different distributed-lag linear structural equation models</h2><span id='topic+compareModels'></span>

<h3>Description</h3>

<p>Several competing distributed-lag linear structural equation models are compared based on information criteria.</p>


<h3>Usage</h3>

<pre><code class='language-R'>compareModels(x)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compareModels_+3A_x">x</code></td>
<td>
<p>A list of 2 or more objects of class <code>dlsem</code> estimated on the same data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame with one record for each model in <code>x</code> on the following quantities: log-likelihood, number of parameters, Akaike Information Criterion (AIC),

Bayesian Information criterion (BIC).</p>


<h3>Note</h3>

<p>In order to keep the sample size constant, only the non-missing residuals across all the models are considered (see Magrini, 2020, for details).</p>


<h3>References</h3>

<p>H. Akaike (1974). A New Look at the Statistical Identification Model. <em>IEEE Transactions on Automatic Control</em>, 19, 716-723. DOI: 10.1109/TAC.1974.1100705
</p>

<p>A. Magrini (2020). A family of theory-based lag shapes for distributed-lag linear regression. To be appeared on <em>Italian Journal of Applied Statistics</em>.
</p>
<p>G. Schwarz (1978). Estimating the Dimension of a Model. <em>Annals of Statistics</em>, 6, 461-464. DOI: 10.1214/aos/1176344136
</p>


<h3>See Also</h3>

<p><a href="#topic+dlsem">dlsem</a>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(industry)

# model with endpoint-contrained quadratic lag shapes
indus.code &lt;- list(
  Consum~ecq(Job,0,5),
  Pollution~ecq(Job,1,8)+ecq(Consum,1,7)
  )
indus.mod &lt;- dlsem(indus.code,group="Region",exogenous=c("Population","GDP"),data=industry,
  log=TRUE)
  
# model with gamma lag shapes
indus.code_2 &lt;- list(
  Consum~gam(Job,0.85,0.2),
  Pollution~gam(Job,0.95,0.05)+gam(Consum,0.9,0.15)
  )
indus.mod_2 &lt;- dlsem(indus.code_2,group="Region",exogenous=c("Population","GDP"),data=industry,
  log=TRUE)
  
compareModels(list(indus.mod,indus.mod_2))
</code></pre>

<hr>
<h2 id='dlsem'>Parameter estimation</h2><span id='topic+dlsem'></span>

<h3>Description</h3>

<p>Parameter estimation is performed for a distributed-lag linear structural equation model.
A single group factor may be taken into account.</p>


<h3>Usage</h3>

<pre><code class='language-R'>dlsem(model.code, group = NULL, time = NULL, exogenous = NULL, data, hac = TRUE,
  gamma.by = 0.05, global.control = NULL, local.control = NULL, log = FALSE,
  diff.options = list(test=NULL, maxdiff=2, ndiff=NULL),
  imput.options = list(tol=0.0001, maxiter=500, maxlag=2, no.imput=NULL), quiet = FALSE)
  </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dlsem_+3A_model.code">model.code</code></td>
<td>
<p>A list of objects of class <code>formula</code>, each describing a single regression model. See <code>Details</code>.</p>
</td></tr>
<tr><td><code id="dlsem_+3A_group">group</code></td>
<td>
<p>The name of the group factor (optional). If <code>NULL</code>, no groups are considered.</p>
</td></tr>
<tr><td><code id="dlsem_+3A_time">time</code></td>
<td>
<p>The name of the variable indicating the date time (optional). This variable must be either a numeric identificative or a date in format '%Y/%m/%d','%d/%m/%Y', or '%Y-%m-%d'. If <code>time</code> is <code>NULL</code> and <code>group</code> is not <code>NULL</code>, data are assumed to be temporally ordered within each group.
If both <code>time</code> and <code>group</code> are <code>NULL</code>, data are assumed to be temporally ordered.</p>
</td></tr>
<tr><td><code id="dlsem_+3A_exogenous">exogenous</code></td>
<td>
<p>The name of exogenous variables (optional). Exogenous variables may be either quantitative or qualitative and must not appear in the model code.</p>
</td></tr>  
<tr><td><code id="dlsem_+3A_data">data</code></td>
<td>
<p>An object of class <code>data.frame</code> containing data.</p>
</td></tr>
<tr><td><code id="dlsem_+3A_hac">hac</code></td>
<td>
<p>Logical. If <code>TRUE</code>, heteroskedasticity and autocorrelation consistent (HAC) estimation of standard errors by Newey &amp; West (1978) is applied, otherwise OLS standard errors are used. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="dlsem_+3A_gamma.by">gamma.by</code></td>
<td>
<p>A real number between 0 and 1 defining the resolution of the grid for the adaptation of gamma lag shapes. Adaptation is more precise with values near 0, but it will also take more time. Default is 0.05.</p>
</td></tr>

<tr><td><code id="dlsem_+3A_global.control">global.control</code></td>
<td>
<p>A list containing global options for the estimation. The list may consist of any number of components among the following:
</p>

<ul>
<li><p><code>adapt</code>: a logical value indicating whether adaptation of lag shapes should be performed for all regression models. Default is <code>FALSE</code>;
</p>
</li>
<li><p><code>min.gestation</code>: the minimum gestation lag for all covariates. If not provided, it is assumed to be equal to 0. Ignored for a gamma lag shape or if <code>adapt</code>=<code>FALSE</code>;
</p>
</li>
<li><p><code>max.gestation</code>: the maximum gestation lag for all covariates. If not provided, it is assumed to be equal to <code>max.lead</code> (see below). Ignored for a gamma lag shape or if <code>adapt</code>=<code>FALSE</code>;
</p>
</li>
<li><p><code>max.lead</code>: the maximum lead lag for all covariates. If not provided, it is computed accordingly to the sample size. Ignored if <code>adapt</code>=<code>FALSE</code>. Note that the lead lag for a gamma lag shape is determined numerically;
</p>
</li>
<li><p><code>min.width</code>: the minimum lag width for all covariates. It cannot be greater than <code>max.lead</code>. If not provided, it is assumed to be 0. Ignored for a gamma lag shape or if <code>adapt</code>=<code>FALSE</code>;
</p>
</li>
<li><p><code>sign</code>: the sign of parameter <code class="reqn">\theta_i</code> (either '+' for positive or '-' for negative) for all covariates. If not provided, adaptation will disregard the sign of parameter <code class="reqn">\theta_i</code>. Ignored if <code>adapt</code>=<code>FALSE</code>.
</p>
</li></ul>
</td></tr>

<tr><td><code id="dlsem_+3A_local.control">local.control</code></td>
<td>
<p>A list containing variable-specific options for the estimation.
These options prevail on the ones contained in <code>global.control</code>. See <code>Details</code>.</p>
</td></tr>

<tr><td><code id="dlsem_+3A_log">log</code></td>
<td>
<p>Logical or a vector of characters. If a vector of characters is provided, logarithmic transformation is applied to strictly positive quantitative variables with name matching those characters. If <code>TRUE</code>, logarithmic transformation is applied to all strictly positive quantitative variables. Default is <code>FALSE</code>.</p>
</td></tr>

<tr><td><code id="dlsem_+3A_diff.options">diff.options</code></td>
<td>
<p>A list containing options for differencing. The list may consist of any number of components among the following: 
</p>

<ul>
<li><p><code>test</code>: the unit root test to apply, that may be either <code>"kpss"</code> for KPSS test or <code>"adf"</code> for ADF test (see <a href="#topic+unirootTest">unirootTest</a>). If <code>NULL</code> (the default), the choice is for the KPSS test if the number of periods is less than 100, otherwise the ADF test is used.
</p>
</li>
<li><p><code>maxdiff</code>: the maximum differencing order to apply. If <code>maxdiff</code>=0, differencing will not be applied. Default is 3;
</p>
</li>
<li><p><code>ndiff</code>: the order of differencing to apply (without performing unit root test). If <code>ndiff</code>=<code>NULL</code>, differencing will be applied according to unit root test. Default is <code>NULL</code>.
</p>
</li></ul>

<p>Differencing is applied to remove unit roots, thus avoiding spurious regression (Granger \&amp; Newbold, 1974).
The same order of differencing will be applied to all quantitative variables. 
</p>
</td></tr>

<tr><td><code id="dlsem_+3A_imput.options">imput.options</code></td>
<td>
<p>A list containing options for the imputation of missing values through the Expectation-Maximization algorithm (Dempster et al., 1977).
The list may consist of any number of components among the following:
</p>

<ul>
<li><p><code>tol</code>: the tolerance threshold. Default is 0.0001;
</p>
</li>
<li><p><code>maxiter</code>: the maximum number of iterations. Default is 500. If <code>maxiter</code>=0, imputation will not be performed;
</p>
</li>
<li><p><code>maxlag</code>: The maximum autoregressive order to consider in the imputation. Default is 3. 
</p>
</li>
<li><p><code>no.input</code>: the name of variables to which imputation should not be applied.  
</p>
</li></ul>

<p>Only missing values of quantitative variables will be imputed. Qualitative variables cannot contain missing values.
</p>
</td></tr>

<tr><td><code id="dlsem_+3A_quiet">quiet</code></td>
<td>
<p>Logical. If <code>TRUE</code>, messages on the estimation progress are suppressed. Deafult is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Each regression model in a distributed-lag linear structural equation model has the form:
</p>
<p style="text-align: center;"><code class="reqn">y_t = \beta_0+\sum_{i=1}^p \sum_{l=0}^{L_i} \beta_{i,l} ~ x_{i,t-l}+\epsilon_t
</code>
</p>

<p>where <code class="reqn">y_t</code> is the value of the response variable at time <code class="reqn">t</code>,
<code class="reqn">x_{i,t-l}</code> is the value of the <code class="reqn">i</code>-th covariate at <code class="reqn">l</code> time lags before <code class="reqn">t</code>,
and <code class="reqn">\epsilon_t</code> is the random error at time <code class="reqn">t</code> uncorrelated with the covariates and with <code class="reqn">\epsilon_{t-1}</code>.
The set <code class="reqn">(\beta_{i,0},\beta_{i,1},\ldots,\beta_{i,L_i})</code>
is the lag shape of the <code class="reqn">i</code>-th covariate.

Currently available lag shapes are the endpoint-constrained quadratic lag shape:
</p>
<p style="text-align: center;"><code class="reqn">\beta_{i,l} = \theta_i \left[-\frac{4}{(b_i-a_i+2)^2} l^2+\frac{4(a_i+b_i)}{(b_i-a_i+2)^2} l-\frac{4(a_i-1)(b_i+1)}{(b_i-a_i+2)^2} \right] \hspace{1cm} a_i \leq l \leq b_i</code>
</p>

<p>(otherwise, <code class="reqn">\beta_{i,l}=0</code>);
the quadratic decreasing lag shape:
</p>
<p style="text-align: center;"><code class="reqn">\beta_{i,l} = \theta_i \frac{l^2-2(b_i+1)l+(b_i+1)^2}{(b_i-a_i+1)^2} \hspace{1cm} a_i \leq l \leq b_i</code>
</p>

<p>(otherwise, <code class="reqn">\beta_{i,l}=0</code>);
the linearly decreasing lag shape:
</p>
<p style="text-align: center;"><code class="reqn">\beta_{i,l} = \theta_i \frac{b_i+1-l}{b_i+1-a_i} \hspace{1cm} a_i \leq l \leq b_i</code>
</p>

<p>(otherwise, <code class="reqn">\beta_{i,l}=0</code>);
the gamma lag shape:
</p>
<p style="text-align: center;"><code class="reqn">\beta_{i,l} = \theta_i (l+1)^\frac{a_i}{1-a_i}b_i^l \left[\left(\frac{a_i}{(a_i-1)\log(b_i)}\right)^\frac{a_i}{1-a_i}b_i^{\frac{a_i}{(a_i-1)\log(b_i)}-1}\right]^{-1}</code>
</p>

<p style="text-align: center;"><code class="reqn">0&lt;a_i&lt;1 \hspace{1cm} 0&lt;b_i&lt;1</code>
</p>


<p>See Magrini (2020) for details on these constrained lag shapes.
</p>
<p>Formulas cannot contain neither qualitative variables or interaction terms (no ':' or '*' symbols), nor functions excepting the following operators for the specification of lag shapes:
</p>

<ul>
<li><p><code>ecq</code>: quadratic (2nd order polynomial) lag shape with endpoint constraints;
</p>
</li>
<li><p><code>qd</code>: quadratic (2nd order polynomial) decreasing lag shape;
</p>
</li>
<li><p><code>ld</code>: linearly decreasing lag shape;
</p>
</li>
<li><p><code>gam</code>: gamma lag shape.
</p>
</li></ul>

<p>Each operator must have the following three arguments (provided within brackets and separated by commas):
</p>

<ol>
<li><p>the name of the covariate to which the lag is applied;
</p>
</li>
<li><p>parameter <code class="reqn">a_i</code>;
</p>
</li>
<li><p>parameter <code class="reqn">b_i</code>;
</p>
</li>
<li><p>the group factor (optional). If not provided and argument <code>group</code> is not <code>NULL</code>, this is found automatically.
</p>
</li></ol>

<p>The formula of regression models with no endogenous covariates may be omitted from argument <code>model.code</code>.
The group factor and exogenous variables must not appear in any formula.
</p>
<p>Argument <code>local.control</code> must be a named list containing one or more among the following components:
</p>

<ul>
<li><p><code>adapt</code>: a named vector of logical values, where each component must have
the name of one endogenous variable and indicate whether adaptation of lag shapes should be
performed for the regression model of that variable.
</p>
</li>
<li><p><code>min.gestation</code>: a named list. Each component of the list must have
the name of one endogenous variable and be a named vector.
Each component of the named vector must have the name of one covariate in the regression
model of the endogenous variable above and include the minimum gestation lag for its lag shape.
</p>
</li>
<li><p><code>max.gestation</code>: the same as <code>min.gestation</code>, with the exception that
the named vector must include the maximum gestation lag.
</p>
</li>
<li><p><code>max.lead</code>: the same as <code>min.gestation</code>, with the exception that
the named vector must include the maximum lead lag.
</p>
</li>
<li><p><code>min.width</code>: the same as <code>min.gestation</code>, with the exception that
the named vector must include the minimum lag width.
</p>
</li>
<li><p><code>sign</code>: the same as <code>min.gestation</code>, with the exception that
the named vector must include the lag sign (either <code>'+'</code> for positive or <code>'-'</code> for negative).
Local control options have no default values, and global ones are applied in their absence.
If some local control options conflict with global ones, only the former are applied.
</p>
</li></ul>



<h3>Value</h3>

<p>An object of class <code>dlsem</code>, with the following components:
</p>
<table>
<tr><td><code>estimate</code></td>
<td>
<p>A list of objects of class <code>lm</code>, one for each regression model.</p>
</td></tr>
<tr><td><code>model.code</code></td>
<td>
<p>The model code, eventually after adaptation of the lag shapes.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>A list containing the call for each regression, eventually after adaptation of lag shapes.</p>
</td></tr>
<tr><td><code>lag.par</code></td>
<td>
<p>A list containing the parameters of the lag shapes for each regression, eventually after adaptation.</p>
</td></tr>
<tr><td><code>exogenous</code></td>
<td>
<p>The names of exogenous variables.</p>
</td></tr>
<tr><td><code>group</code></td>
<td>
<p>The name of the group factor. <code>NULL</code> is returned if <code>group</code>=<code>NULL</code>.</p>
</td></tr>
<tr><td><code>time</code></td>
<td>
<p>The name of the variable indicating the date time. <code>NULL</code> is returned if <code>time</code>=<code>NULL</code>.</p>
</td></tr>
<tr><td><code>log</code></td>
<td>
<p>The name of the variables to which logarithmic transformation was applied.</p>
</td></tr>
<tr><td><code>ndiff</code></td>
<td>
<p>The order of differencing applied to the time series.</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>The data after eventual logarithmic transformation and differencing, which were actually used to estimate the model.</p>
</td></tr>
<tr><td><code>data.orig</code></td>
<td>
<p>The dataset provided to argument <code>data</code>.</p>
</td></tr>
<tr><td><code>fitted</code></td>
<td>
<p>The fitted values.</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>The residuals.</p>
</td></tr>
<tr><td><code>autocorr</code></td>
<td>
<p>The estimated order of the residual auto-correlation for each regression model.</p>
</td></tr>
<tr><td><code>hac</code></td>
<td>
<p>Logical indicating whether HAC estimation of standard errors is applied.</p>
</td></tr>
<tr><td><code>adaptation</code></td>
<td>
<p>Variable-specific options used for the adaptation of lag shapes.</p>
</td></tr>
</table>
<p>S3 methods available for class <code>dlsem</code> are:
</p>
<table>
<tr><td><code>print</code></td>
<td>
<p>provides essential information on the model.</p>
</td></tr>
<tr><td><code>summary</code></td>
<td>
<p>shows summaries of estimation.</p>
</td></tr>
<tr><td><code>plot</code></td>
<td>
<p>displays the directed acyclic graph (DAG) of the model including only the endogenous variables.
Option <code>conf</code> controls the confidence level (default is 0.95), while
option <code>style</code> controls the style of the plot:
</p>

<ul>
<li><p><code>style=2</code> (the default): each edge is coloured with respect to the sign of the estimated causal effect (green: positive, red: negative, light grey: not statistically significant);
</p>
</li>
<li> <p><code>style=1</code>: edges with statistically significant causal effect are shown in black, otherwise they are shown in light grey;
</p>
</li>
<li> <p><code>style=0</code>: all edges are shown in black disregarding statistical significance of causal effects.
</p>
</li></ul>
</td></tr>
<tr><td><code>nobs</code></td>
<td>
<p>returns the number of observations for each regression model.</p>
</td></tr>
<tr><td><code>npar</code></td>
<td>
<p>returns the number of parameters for each regression model.</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p>returns the estimates of scale parameters for each regression model.</p>
</td></tr>
<tr><td><code>confint</code></td>
<td>
<p>returns the confidence intervals of scale parameters for each regression model. Argument <code>level</code> controls the confidence level (default is 0.95).</p>
</td></tr>
<tr><td><code>vcov</code></td>
<td>
<p>returns the covariance matrix of estimates for each regression model.</p>
</td></tr>
<tr><td><code>logLik</code></td>
<td>
<p>returns the log-likelihood for each regression model.</p>
</td></tr>
<tr><td><code>fitted</code></td>
<td>
<p>returns fitted values.</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>returns residuals.</p>
</td></tr>
<tr><td><code>predict</code></td>
<td>
<p>returns predicted values. Optionally, a data frame from which to predict may be provided to argument <code>newdata</code>.
</p>
</td></tr>
</table>


<h3>References</h3>

<p>A. P. Dempster, N. M. Laird, and D. B. Rubin (1977). Maximum likelihood from incomplete data via the EM algorithm. <em>Journal of the Royal Statistical Society</em>, Series B, 39(1): 1-38.
</p>
<p>C. W. J. Granger, and P. Newbold (1974). Spurious regressions in econometrics. <em>Journal of Econometrics</em>, 2(2): 111-120.
</p>
<p>A. Magrini (2019). A family of theory-based lag shapes for distributed-lag linear regression. To be appeared on <em>Italian Journal of Applied Statistics</em>.
</p>
<p>W. K. Newey, and K. D. West (1978). A simple, positive semi-definite, heteroskedasticity and autocorrelation consistent covariance matrix. <em>Econometrica</em>, 55(3), 703-708.
</p>


<h3>See Also</h3>

<p><a href="#topic+unirootTest">unirootTest</a>; <a href="#topic+causalEff">causalEff</a>; <a href="#topic+compareModels">compareModels</a>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(industry)

# Estimation without adaptation of lag shapes
indus.code &lt;- list(
  Consum~ecq(Job,0,5),
  Pollution~ecq(Job,1,8)+ecq(Consum,1,7)
  )
indus.mod &lt;- dlsem(indus.code,group="Region",time="Year",exogenous=c("Population","GDP"),
  data=industry,log=TRUE)

# Adaptation of lag shapes (estimation takes some seconds more)
indus.global &lt;- list(adapt=TRUE,max.gestation=5,max.lead=15,min.width=3,sign="+")
## NOT RUN:
# indus.mod &lt;- dlsem(indus.code,group="Region",time="Year",exogenous=c("Population","GDP"),
#   data=industry,global.control=indus.global,log=TRUE)

# Summary of estimation
summary(indus.mod)$endogenous

# DAG with edges coloured according to the sign
plot(indus.mod)

# DAG disregarding statistical significance
plot(indus.mod,style=0)  


### Comparison among alternative models

# Model 2: quadratic decreasing lag shapes
indus.code_2 &lt;- list(
  Job ~ 1,
  Consum~qd(Job),
  Pollution~qd(Job)+qd(Consum)
  )
## NOT RUN:
# indus.mod_2 &lt;- dlsem(indus.code_2,group="Region",time="Year",exogenous=c("Population","GDP"),
#   data=industry,global.control=indus.global,log=TRUE)

# Model 3: linearly decreasing lag shapes
indus.code_3 &lt;- list(
  Job ~ 1,
  Consum~ld(Job),
  Pollution~ld(Job)+ld(Consum)
  )
## NOT RUN:
# indus.mod_3 &lt;- dlsem(indus.code_3,group="Region",time="Year",exogenous=c("Population","GDP"),
#   data=industry,global.control=indus.global,log=TRUE)

# Model 4: gamma lag shapes
indus.code_4 &lt;- list(
  Job ~ 1,
  Consum~gam(Job),
  Pollution~gam(Job)+gam(Consum)
  )
## NOT RUN:
# indus.mod_4 &lt;- dlsem(indus.code_4,group="Region",time="Year",exogenous=c("Population","GDP"),
#   data=industry,global.control=indus.global,log=TRUE)

# comparison of the three models
## NOT RUN:
# compareModels(list(indus.mod,indus.mod_2,indus.mod_3,indus.mod_4))


### A more complex model

data(agres)

# Qualitative exogenous variable
agres$POLICY &lt;- factor(1*(agres$YEAR&gt;=2005))
levels(agres$POLICY) &lt;- c("no","yes")

# Causal levels
context.var &lt;- c("GDP","EMPL_AGR","UAA","PATENT_OTHER","POLICY")
investment.var &lt;- c("GBAORD_AGR","BERD_AGR")
research.var &lt;- c("RD_EDU_AGR","PATENT_AGR")
impact.var &lt;-  c("GVA_AGR","PPI_AGR")
agres.var &lt;- c(context.var,investment.var,research.var,impact.var)

# Constraints on lag shapes
agres.global &lt;- list(adapt=TRUE,max.gestation=5,max.lead=15,sign="+")
agres.local &lt;- list(
  sign=list(
    PPI_AGR=c(GBAORD_AGR="-",BERD_AGR="-",RD_EDU_AGR="-",PATENT_AGR="-")
    )
  )

# Endpoint-constrained quadratic lag shapes (estimation takes a couple of minutes)
auxcode &lt;- c(paste(investment.var,"~1",sep=""),
  paste(research.var,"~",paste("ecq(",investment.var,",,)",
    collapse="+",sep=""),sep=""),
  paste(impact.var,"~",paste("ecq(",c(investment.var,research.var),",,)",
    collapse="+",sep=""),sep=""))
agres.code &lt;- list()
for(i in 1:length(auxcode)) {
  agres.code[[i]] &lt;- formula(auxcode[i])
  }
## NOT RUN:
# agres.mod &lt;- dlsem(agres.code,group="COUNTRY",time="YEAR",exogenous=context.var,
#   data=agres,global.control=agres.global,local.control=agres.local,log=TRUE)
# summary(agres.mod)$endogenous

## Gamma lag shapes (estimation takes some minutes)
auxcode_2 &lt;- c(paste(investment.var,"~1",sep=""),
  paste(research.var,"~",paste("gam(",investment.var,",,)",
    collapse="+",sep=""),sep=""),
  paste(impact.var,"~",paste("gam(",c(investment.var,research.var),",,)",
    collapse="+",sep=""),sep=""))
agres.code_2 &lt;- list()
for(i in 1:length(auxcode_2)) {
  agres.code_2[[i]] &lt;- formula(auxcode_2[i])
  }
## NOT RUN:
# agres.mod_2 &lt;- dlsem(agres.code_2,group="COUNTRY",time="YEAR",exogenous=context.var,
#  data=agres,global.control=agres.global,local.control=agres.local,log=TRUE)
# summary(agres.mod_2)$endogenous
# compareModels(list(agres.mod,agres.mod_2))
</code></pre>

<hr>
<h2 id='dlsem-package'>Distributed-lag linear structural equation models</h2><span id='topic+dlsem-package'></span>

<h3>Description</h3>

<p>Inference functionalities for distributed-lag linear structural equation models (DLSEMs).
DLSEMs are Markovian structural causal models where each factor of the joint probability distribution
is a distributed-lag linear regression with constrained lag shapes (Magrini, 2018; Magrini et. al, 2019; Magrini, 2020).
DLSEMs account for temporal delays in the dependence relationships among the variables through a single parameter per covariate, thus allowing to perform dynamic causal inference in a feasible fashion.
Endpoint-constrained quadratic ('ecq'), quadratic decreasing ('qd'), linearly decreasing ('ld') and gamma ('gam') lag shapes are available.
The main functions of the package are:
</p>

<ul>
<li><p><a href="#topic+dlsem">dlsem</a>, to perform parameter estimation;
</p>
</li>
<li><p><a href="#topic+causalEff">causalEff</a>, to compute all the pathwise causal lag shapes and the overall one connecting two or more variables;
</p>
</li>
<li><p><a href="#topic+lagPlot">lagPlot</a>, to display a pathwise or an overall causal lag shape.
</p>
</li></ul>



<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
  Package: </td><td style="text-align: left;"> dlsem</td>
</tr>
<tr>
 <td style="text-align: left;">
  Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
  Version: </td><td style="text-align: left;"> 2.4.6</td>
</tr>
<tr>
 <td style="text-align: left;">
  Date: </td><td style="text-align: left;"> 2020-03-22</td>
</tr>
<tr>
 <td style="text-align: left;">
  License: </td><td style="text-align: left;"> GPL-2
  </td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Alessandro Magrini &lt;alessandro.magrini@unifi.it&gt;</p>


<h3>References</h3>

<p>A. Magrini (2018). Linear Markovian models for lag exposure assessment. Biometrical Letters, 55(2): 179-195. DOI: 10.2478/bile-2018-0012.
</p>
<p>A. Magrini, F. Bartolini, A. Coli, B. Pacini (2019). A structural equation model to assess the
impact of agricultural research expenditure on multiple dimensions. Quality and Quantity, 53(4):
2063-2080. DOI: 10.1007/s11135-019-00855-z
</p>
<p>A. Magrini (2020). A family of theory-based lag shapes for distributed-lag linear regression. To be appeared on <em>Italian Journal of Applied Statistics</em>.
</p>

<hr>
<h2 id='drawSample'>Sampling from a distributed-lag linear structural equation model</h2><span id='topic+drawSample'></span>

<h3>Description</h3>

<p>A future sample from a distributed-lag linear structural equation model is drawn.</p>


<h3>Usage</h3>

<pre><code class='language-R'>drawSample(x, n)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="drawSample_+3A_x">x</code></td>
<td>
<p>An object of class <code>dlsem</code>.</p>
</td></tr>
<tr><td><code id="drawSample_+3A_n">n</code></td>
<td>
<p>The sample size (temporal horizon).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>data.frame</code>.</p>


<h3>Note</h3>

<p>Sampling is conditioned to the most recent observed value of all the variables.
</p>
<p>For variables subdued to logarithmic transformation and/or differencing,
the sampled values are in logarithmic scale and/or after differencing, as well.
</p>
<p>If a group factor was specified for the model, a sample of size <code>n</code> is drawn for each group.

</p>


<h3>See Also</h3>

<p><a href="#topic+dlsem">dlsem</a>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(industry)
indus.code &lt;- list(
  Consum~ecq(Job,0,5),
  Pollution~ecq(Job,1,8)+ecq(Consum,1,7)
  )
indus.mod &lt;- dlsem(indus.code,group="Region",time="Year",exogenous=c("Population","GDP"),
  data=industry,log=TRUE)
drawSample(indus.mod,10)
</code></pre>

<hr>
<h2 id='ecq'>Lag shape constructors</h2><span id='topic+ecq'></span><span id='topic+qd'></span><span id='topic+ld'></span><span id='topic+gam'></span>

<h3>Description</h3>

<p>Lag shape constructors to be used in model formulas.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecq(x, a, b, x.group = NULL, nlag = NULL)
qd(x, a, b, x.group = NULL, nlag = NULL)
ld(x, a, b, x.group = NULL, nlag = NULL)
gam(x, a, b, x.group = NULL, nlag = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecq_+3A_x">x</code></td>
<td>
<p>The name of the variable.</p>
</td></tr>
<tr><td><code id="ecq_+3A_a">a</code>, <code id="ecq_+3A_b">b</code></td>
<td>
<p>The shape parameters.</p>
</td></tr>
<tr><td><code id="ecq_+3A_nlag">nlag</code></td>
<td>
<p>The number of lags considered. If <code>NULL</code> or more than 2/3 of the sample size, it is set equal to 2/3 of the sample size.</p>
</td></tr>
<tr><td><code id="ecq_+3A_x.group">x.group</code></td>
<td>
<p>The name of the group factor (optional).</p>
</td></tr>
</table>


<h3>References</h3>

<p>A. Magrini (2020). A family of theory-based lag shapes for distributed-lag linear regression. To be appeared on <em>Italian Journal of Applied Statistics</em>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(industry)
# example in linear regression
m1 &lt;- lm(Consum ~ -1+Region+ecq(Job,0,5,x.group=Region), data=industry)
m2 &lt;- lm(Consum ~ -1+Region+gam(Job,0.85,0.2,x.group=Region), data=industry)
</code></pre>

<hr>
<h2 id='industry'>Industrial development</h2><span id='topic+industry'></span>

<h3>Description</h3>

<p>Simulated data on industrial development from 1983 to 2014 in 10 imaginary regions.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(industry)</code></pre>


<h3>Format</h3>

<p>A data frame with a total of 320 observations on the following 7 variables:
</p>

<dl>
<dt><code>Region</code></dt><dd><p>ID of the region.</p>
</dd>
<dt><code>Year</code></dt><dd><p>Year.</p>
</dd>
<dt><code>Population</code></dt><dd><p>Population (number of inhabitants).</p>
</dd>
<dt><code>GDP</code></dt><dd><p>Gross domestic product (1000 international dollars).</p>
</dd>
<dt><code>Job</code></dt><dd><p>Employment in industry (Index, 1980=100).</p>
</dd>
<dt><code>Consum</code></dt><dd><p>Private consumption (Index, 1980=100).</p>
</dd>
<dt><code>Pollution</code></dt><dd><p>Greenhouse gas emissions (tonnes of CO2 equivalent).</p>
</dd>
</dl>


<hr>
<h2 id='isIndep'>Conditional independence check</h2><span id='topic+isIndep'></span>

<h3>Description</h3>

<p>Conditional independence between two variables is checked using the d-separation criterion (Pearl, 2000, page 16 and following).</p>


<h3>Usage</h3>

<pre><code class='language-R'>isIndep(x, var1 = NULL, var2 = NULL, given = NULL, conf = 0.95, use.ns = FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="isIndep_+3A_x">x</code></td>
<td>
<p>An object of class <code>dlsem</code>.</p>
</td></tr>
<tr><td><code id="isIndep_+3A_var1">var1</code></td>
<td>
<p>The name of the first variable.</p>
</td></tr>
<tr><td><code id="isIndep_+3A_var2">var2</code></td>
<td>
<p>The name of the second variable.</p>
</td></tr>
<tr><td><code id="isIndep_+3A_given">given</code></td>
<td>
<p>A vector containing the names of conditioning variables. If <code>NULL</code>, marginal independence is checked.</p>
</td></tr>
<tr><td><code id="isIndep_+3A_conf">conf</code></td>
<td>
<p>The confidence level for each edge: only edges with statistically significant causal effect at such confidence are considered. Default is 0.95.</p>
</td></tr>
<tr><td><code id="isIndep_+3A_use.ns">use.ns</code></td>
<td>
<p>A logical value indicating whether edges without statistically significant causal effect (at level <code>conf</code>) should be considered or not. If <code>FALSE</code> (the default), they will be ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Logical</p>


<h3>Note</h3>

<p>Conditional independence is checked statically, that is the whole history of conditioning variables is supposed to be known.
</p>
<p>The result is unchanged if arguments <code>var1</code> and <code>var2</code> are switched.
</p>
<p>Dependence is a necessary but not sufficient condition for causation: see the discussion in Pearl (2000).</p>


<h3>References</h3>

<p>J. Pearl (2000). Causality: Models, Reasoning, and Inference. Cambridge University Press. Cambridge, UK. ISBN: 978-0-521-89560-6</p>


<h3>See Also</h3>

<p><a href="#topic+dlsem">dlsem</a>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(industry)
indus.code &lt;- list(
  Consum~ecq(Job,0,5),
  Pollution~ecq(Job,1,8)+ecq(Consum,1,7)
  )
indus.mod &lt;- dlsem(indus.code,group="Region",exogenous=c("Population","GDP"),data=industry,
  log=TRUE)
isIndep(indus.mod,"Job","Pollution",given=c("Consum"))
</code></pre>

<hr>
<h2 id='lagPlot'>Plot of lag shapes</h2><span id='topic+lagPlot'></span>

<h3>Description</h3>

<p>A pathwise or an overall causal lag shape is displayed.</p>


<h3>Usage</h3>

<pre><code class='language-R'>lagPlot(x, from = NULL, to = NULL, path = NULL, maxlag = NULL, cumul = FALSE,
  conf = 0.95, use.ns = FALSE, ylim = NULL, title = NULL)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lagPlot_+3A_x">x</code></td>
<td>
<p>An object of class <code>dlsem</code>.</p>
</td></tr>
<tr><td><code id="lagPlot_+3A_from">from</code>, <code id="lagPlot_+3A_to">to</code>, <code id="lagPlot_+3A_path">path</code></td>
<td>

<p>To display the overall causal lag shape of a variable to another one,
their names must be provided to arguments <code>from</code> and <code>to</code>, respectively.
To display a pathwise causal lag shape,
the name of the path, indicated as a string made of the names of the variables in the path separated by '*', must be provided to argument <code>path</code>.
Argument <code>path</code> will be ignored if both <code>from</code> and <code>to</code> are not <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="lagPlot_+3A_maxlag">maxlag</code></td>
<td>
<p>The maximum lag displayed (optional).</p>
</td></tr>
<tr><td><code id="lagPlot_+3A_cumul">cumul</code></td>
<td>
<p>Logical. If <code>TRUE</code>, cumulative causal effects are returned. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="lagPlot_+3A_conf">conf</code></td>
<td>
<p>The confidence level for each edge: only statistically significant edges at such confidence are considered. Default is 0.95.</p>
</td></tr>
<tr><td><code id="lagPlot_+3A_use.ns">use.ns</code></td>
<td>
<p>A logical value indicating whether not statistically significant edges (at level <code>conf</code>) should be considered or not. If <code>FALSE</code> (the default), they will be ignored.</p>
</td></tr>
<tr><td><code id="lagPlot_+3A_ylim">ylim</code></td>
<td>
<p>A vector of two numerical values indicating the limits of the y axis (optional). If <code>NULL</code>, the limits of the y axis are computed automatically.</p>
</td></tr>
<tr><td><code id="lagPlot_+3A_title">title</code></td>
<td>
<p>The title of the plot (optional). If <code>NULL</code>, a default title is used.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Value <code>NULL</code> is returned if one of the following occurs:
(i) no significant path at confidence level <code>conf</code> exists connecting the starting variables to the ending variable;
(ii) the requested path does not exist or is not significant at confidence level <code>conf</code>.
</p>


<h3>See Also</h3>

<p><a href="#topic+dlsem">dlsem</a>; <a href="#topic+lagShapes">lagShapes</a>; <a href="#topic+causalEff">causalEff</a>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(industry)
indus.code &lt;- list(
  Consum~ecq(Job,0,5),
  Pollution~ecq(Job,1,8)+ecq(Consum,1,7)
  )
indus.mod &lt;- dlsem(indus.code,group="Region",exogenous=c("Population","GDP"),data=industry,
  log=TRUE)

# the lag shape of the causal effect associated to specific paths
lagPlot(indus.mod,path="Job*Pollution")
lagPlot(indus.mod,path="Job*Consum*Pollution")

# the lag shape of an overall causal effect
lagPlot(indus.mod,from="Job",to="Pollution")
</code></pre>

<hr>
<h2 id='lagShapes'>Estimated lag shapes</h2><span id='topic+lagShapes'></span>

<h3>Description</h3>

<p>Estimated lag shapes and their standard errors are provided.</p>


<h3>Usage</h3>

<pre><code class='language-R'>lagShapes(x, cumul = FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lagShapes_+3A_x">x</code></td>
<td>
<p>An object of class <code>dlsem</code>.</p>
</td></tr>
<tr><td><code id="lagShapes_+3A_cumul">cumul</code></td>
<td>
<p>Logical. If <code>TRUE</code>, cumulative causal effects are returned. Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of lists, one for each endogenous variable, each containing several matrices including the estimated lag shapes and their standard errors.
</p>


<h3>See Also</h3>

<p><a href="#topic+dlsem">dlsem</a>; <a href="#topic+causalEff">causalEff</a>; <a href="#topic+lagPlot">lagPlot</a>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(industry)
indus.code &lt;- list(
  Consum~ecq(Job,0,5),
  Pollution~ecq(Job,1,8)+ecq(Consum,1,7)
  )
indus.mod &lt;- dlsem(indus.code,group="Region",exogenous=c("Population","GDP"),data=industry,
  log=TRUE)
lagShapes(indus.mod)
</code></pre>

<hr>
<h2 id='lmHAC'>Heteroskedasticty and autocorrelation consistent covariance matrix</h2><span id='topic+lmHAC'></span>

<h3>Description</h3>

<p>The heteroskedasticty and autocorrelation consistent (HAC) covariance matrix of least square estimates (Newey &amp; West, 1978) is applied to an object of class <code>lm</code>. A single group factor may be taken into account.</p>


<h3>Usage</h3>

<pre><code class='language-R'>lmHAC(x, group = NULL)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lmHAC_+3A_x">x</code></td>
<td>
<p>An object of class <code>lm</code>.</p>
</td></tr>
<tr><td><code id="lmHAC_+3A_group">group</code></td>
<td>
<p>The name of the group factor (optional). If <code>NULL</code>, no groups are considered.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>hac</code> and <code>lm</code>.
The HAC covariance matrix is stored into the component <code>vcov</code> of the object,
which is taken into account by the <code>summary</code> and the <code>vcov</code> methods.
The HAC covariance matrix has the attribute <code>max.lag</code>, indicating the maximum lag of autocorrelation, which is automatically computed based on fit to data.
</p>


<h3>Note</h3>

<p>If <code>group</code> is not <code>NULL</code>, the HAC covariance matrix is computed within each group.
Residuals are assumed to be temporally ordered within each group.</p>


<h3>References</h3>

<p>W. K. Newey, and K. D. West (1978). A simple, positive semi-definite, heteroskedasticity and autocorrelation consistent covariance matrix. <em>Econometrica</em>, 55(3), 703-708.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(industry)

m0 &lt;- lm(Consum ~ -1+Region+ecq(Job,0,5,x.group=Region), data=industry)
summary(m0)
confint(m0)

m0_hac &lt;- lmHAC(m0,group="Region")
summary(m0_hac)
confint(m0_hac)
</code></pre>

<hr>
<h2 id='residualPlot'>Plot for diagnostics of the residuals in a distributed-lag structural equation model.</h2><span id='topic+residualPlot'></span>

<h3>Description</h3>

<p>Several different types of plot for diagnostics of the residuals in a distributed-lag structural equation model are displayed.</p>


<h3>Usage</h3>

<pre><code class='language-R'>residualPlot(x, type = "fr")</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="residualPlot_+3A_x">x</code></td>
<td>
<p>An object of class <code>dlsem</code>.</p>
</td></tr>
<tr><td><code id="residualPlot_+3A_type">type</code></td>
<td>
<p>A character string indicating the type of plot, which should be one among
'fr' (fitted vs. residuals plot, the default),
'qq' (quantile-quantile plot of the residuals),
'ts' (time series plot of the residuals),
'ac' (auto-correlation plot of the residuals).</p>
</td></tr>
</table>


<h3>Note</h3>

<p>If <code>type</code> is equal to 'ts' or 'ac' and a group factor was specified for <code>x</code>, the results are displayed as minimum, 1st quartile, median, 3rd quartile and maximum by group.
</p>


<h3>See Also</h3>

<p><a href="#topic+dlsem">dlsem</a>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(industry)
indus.code &lt;- list(
  Consum~ecq(Job,0,5),
  Pollution~ecq(Job,1,8)+ecq(Consum,1,7)
  )
indus.mod &lt;- dlsem(indus.code,group="Region",exogenous=c("Population","GDP"),data=industry,
  log=TRUE)
residualPlot(indus.mod,type="fr")
residualPlot(indus.mod,type="qq")
residualPlot(indus.mod,type="ts")
residualPlot(indus.mod,type="ac")
</code></pre>

<hr>
<h2 id='unirootTest'>Unit root test</h2><span id='topic+unirootTest'></span>

<h3>Description</h3>

<p>Unit root test is performed on a set of quantitative variables. A single group factor may be taken into account.</p>


<h3>Usage</h3>

<pre><code class='language-R'>unirootTest(x = NULL, group = NULL, time = NULL, data, test = NULL, log = FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="unirootTest_+3A_x">x</code></td>
<td>
<p>A vector including the name of the quantitative variables to be tested.
If <code>NULL</code> (the default), all the quantitative variables contained in <code>data</code> will be tested.</p>
</td></tr>
<tr><td><code id="unirootTest_+3A_group">group</code></td>
<td>
<p>The name of the group factor (optional). If <code>NULL</code>, no groups are considered.</p>
</td></tr>
<tr><td><code id="unirootTest_+3A_time">time</code></td>
<td>
<p>The name of the time factor (optional).  This variable must be either a numeric identificative or a date in format '%Y/%m/%d','%d/%m/%Y', or '%Y-%m-%d'. If <code>time</code> is <code>NULL</code> and <code>group</code> is not <code>NULL</code>, data are assumed to be temporally ordered within each group.
If both <code>time</code> and <code>group</code> are <code>NULL</code>, data are assumed to be temporally ordered.</p>
</td></tr>
<tr><td><code id="unirootTest_+3A_data">data</code></td>
<td>
<p>An object of class <code>data.frame</code> containing the variables to be tested,
the group factor if <code>group</code> is not <code>NULL</code>, and the time factor if <code>time</code> is not <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="unirootTest_+3A_test">test</code></td>
<td>
<p>The test to apply, that may be either <code>"kpss"</code> (Kwiatkowski, 1992) or <code>"adf"</code> (Dickey \&amp; Fuller, 1981).
If <code>NULL</code> (the default), the choice is for the KPSS test if the number of periods is less than 100, otherwise the ADF test is used.</p>
</td></tr>
<tr><td><code id="unirootTest_+3A_log">log</code></td>
<td>
<p>Logical. If <code>TRUE</code>, logarithmic transformation is applied to all strictly positive quantitative variables. Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>unirootTest</code>, consisting of a list with one component for each variable tested. Each list contains the following components:
</p>
<table>
<tr><td><code>statistic</code></td>
<td>
<p>The value of the test statistic.</p>
</td></tr>
<tr><td><code>lag.order</code></td>
<td>
<p>The lag order at which the test statistic is computed. It is automatically selected according to the precedure by Ng \&amp; Perron (2001).</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>The total number of observations if <code>group</code> is <code>NULL</code>, otherwise the number of observations per group.</p>
</td></tr>
<tr><td><code>z.value</code></td>
<td>
<p>The z-value of the test.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>The p-value of the test.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The null hypothesis of the ADF test is the presence of a unit root.
The lag order to calculate the statistic of the ADF test is automatically selected according to the precedure by Ng \&amp; Perron (2001).
</p>
<p>The null hypothesis of the KPSS test is stationarity.
The statistic of the KPSS test is calculated at the lag order 4*(n/100)^0.25.
</p>
<p>If the group factor is specified, p-values of each group are combined
using the method proposed by Demetrescu (2006).
</p>


<h3>References</h3>

<p>M. Demetrescu, U. Hassler, and A. Tarcolea (2006). Combining Significance of Correlated Statistics with Application to Panel Data. <em>Oxford Bulletin of Economics and Statistics</em>, 68(5), 647-663. DOI: 10.1111/j.1468-0084.2006.00181.x
</p>
<p>D. A. Dickey, and W. A. Fuller (1981). Likelihood Ratio Statistics for Autoregressive Time Series with a Unit Root. <em>Econometrica</em>, 49: 1057-1072. DOI: 10.2307/1912517
</p>
<p>D. Kwiatkowski, P. C. B. Phillips, P. Schmidt and Y. Shin (1992). Testing the null hypothesis of stationarity against the alternative of a unit root. <em>Journal of Econometrics</em>, 54(1-3): 159-178.
</p>
<p>S. Ng, and W. P. Perron (2001). Lag Length  Selection and the Construction of Unit Root Tests with Good Size and Power. <em>Econometrica</em>, 60: 1519-1554. DOI: 10.1111/1468-0262.00256.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(industry)
indus.urt &lt;- unirootTest(c("Job","Consum","Population","GDP"),
  group="Region",time="Year",data=industry,log=TRUE)
indus.urt      ## p-values
indus.urt$Job  ## details for variable 'Job'
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
