<!DOCTYPE html><html><head><title>Help for package sac</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {sac}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#BootsChapt'><p> Bootstrap (Permutation) Test of Change-Point(s) with One-Change or Epidemic Alternative</p></a></li>
<li><a href='#BootsModelTest'><p> Bootstrap Test of the Validity of the Semiparametric Change-Point Model</p></a></li>
<li><a href='#CriticalValues'><p> Critical Values of Tests of Change-Point(s) with One-Change or Epidemic Alternative</p></a></li>
<li><a href='#cumsum.test'><p>Nonparametric Test for Change-Point with One-change or Epidemic Alternative</p></a></li>
<li><a href='#plots'><p>Visualized Model Diagnostic and Loglikelihood Plot</p></a></li>
<li><a href='#Pvalues'><p> The p-values of Test Statistics Based on Asymptotic Distribution</p></a></li>
<li><a href='#sac-internal'><p>Internal sac Functions</p></a></li>
<li><a href='#schapt'><p> Semiparametric Analysis of Changepoint</p></a></li>
<li><a href='#SemiparChangePoint'><p> Semiparametric Test of Change-point(s) with One-change or Epidemic Alternative</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.0.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-01-26</td>
</tr>
<tr>
<td>Title:</td>
<td>Semiparametric Analysis of Change-Point</td>
</tr>
<tr>
<td>Author:</td>
<td>Zhong Guan &lt;zguan@iusb.edu&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Zhong Guan &lt;zguan@iusb.edu&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 1.4)</td>
</tr>
<tr>
<td>Description:</td>
<td>Semiparametric empirical likelihood ratio
    based tests of change-point with one-change or epidemic alternatives
    with data-based model diagnostic are contained.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-01-27 14:13:32 UTC; zguan</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-01-27 15:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='BootsChapt'> Bootstrap (Permutation) Test of Change-Point(s) with One-Change or Epidemic Alternative</h2><span id='topic+BootsChapt'></span>

<h3>Description</h3>

<p>By resampling with(out) replacement from the original sample data,
we can obtain bootstrap(permutation) versions of the test statistics.
The <code>p</code>-values of the test(s) from the original data are approximated by the
<code>p</code>-values of the bootstrap(permutation) version statistics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BootsChapt(x, stat1, stat2 = NULL, B, replace = FALSE, 
    alternative = c("one.change", "epidemic"), adj.Wn = FALSE, 
    tol = 1.0e-7, maxit = 50,trace = FALSE,... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BootsChapt_+3A_x">x</code></td>
<td>
<p>a numeric vector or matrix containing the data, one row per observation; </p>
</td></tr>
<tr><td><code id="BootsChapt_+3A_stat1">stat1</code></td>
<td>
<p>test statistic <code>Sn</code> for <code>"one-change"</code> alternative or <code>Vn</code> for 
<code>"epidemic"</code> alternative,
output of <code><a href="#topic+SemiparChangePoint">SemiparChangePoint</a></code>.</p>
</td></tr>
<tr><td><code id="BootsChapt_+3A_stat2">stat2</code></td>
<td>
<p>test statistic <code>Wn</code> for <code>"epidemic"</code> alternative, output of <code><a href="#topic+SemiparChangePoint">SemiparChangePoint</a></code>.</p>
</td></tr>
<tr><td><code id="BootsChapt_+3A_b">B</code></td>
<td>
<p> number of resamples </p>
</td></tr>
<tr><td><code id="BootsChapt_+3A_replace">replace</code></td>
<td>
<p> a logical indicating whether bootstrap samples for bootstrap test
of the change-point are selected with or without replacement, if <code>replace</code>= FALSE (default),
corresponds to permutation test, otherwise, bootstrap test; </p>
</td></tr>
<tr><td><code id="BootsChapt_+3A_alternative">alternative</code></td>
<td>
<p> a character string specifying the alternative hypothesis,
must be one of <code>"one-change"</code> (default) or <code>"epidemic"</code>.  You can specify just the initial letter.</p>
</td></tr>
<tr><td><code id="BootsChapt_+3A_adj.wn">adj.Wn</code></td>
<td>
<p> logical indicating if <code>Wn</code> should be adjusted or not
for <code>"epidemic"</code> alternative. </p>
</td></tr>
<tr><td><code id="BootsChapt_+3A_tol">tol</code></td>
<td>
<p> the desired accuracy (convergence tolerance), an argument of <code><a href="stats.html#topic+glm.control">glm.control</a></code>. </p>
</td></tr>
<tr><td><code id="BootsChapt_+3A_maxit">maxit</code></td>
<td>
<p> the maximum number of iterations, an argument of <code><a href="stats.html#topic+glm.control">glm.control</a></code>. </p>
</td></tr>
<tr><td><code id="BootsChapt_+3A_trace">trace</code></td>
<td>
<p> logical indicating if output should be produced for each
iteration, an argument of <code><a href="stats.html#topic+glm.control">glm.control</a></code>.</p>
</td></tr>
<tr><td><code id="BootsChapt_+3A_...">...</code></td>
<td>
<p> other arguments </p>
</td></tr>
</table>


<h3>Details</h3>

<p> The procedure will fail when there is separation in the data in the
sense of Albert \&amp; Anderson(1984, <em>Biometrika</em>) and Santner \&amp; Duffy (1986, <em>Biometrika</em>).
In this case, the change-point(s) may be detected easily using nonparametric method
based on cumsum. Now, this program does not check whether the data is separated.
</p>


<h3>Value</h3>

<table>
<tr><td><code>p.boots</code></td>
<td>
<p>bootstrap <code>p</code>-value of <code>Sn</code> for <code>"one-change"</code> alternative</p>
</td></tr>
<tr><td><code>p.boots.Vn</code></td>
<td>
<p>bootstrap <code>p</code>-value of <code>Vn</code> for <code>"epidemic"</code> alternative</p>
</td></tr>
<tr><td><code>p.boots.Wn</code></td>
<td>
<p>bootstrap <code>p</code>-value of <code>Wn</code> for <code>"epidemic"</code> alternative</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Default alternative is <code>"one-change"</code>, even when <code>stat2</code> is not NULL.
If <code>alternative = "epidemic"</code>, both <code>stat1</code> and <code>stat2</code> should be provided.
Statistic <code>Wn</code> need be adjusted only for one dimensional observations
and if no bootstrap test is conducted. However, if <code>Wn</code> is already adjusted, you have to asign
<code>adj.Wn = TRUE</code> to calculate the <code>p</code>-value of <code>Wn</code>.</p>


<h3>Author(s)</h3>

<p> Zhong Guan <a href="mailto:zguan@iusb.edu">zguan@iusb.edu</a></p>


<h3>References</h3>

<p>Guan, Z.(2001) Some Results About Empirical Likelihood Method,
<em>Ph.D. Thesis, The University of Toledo</em>.
</p>
<p>Guan, Z.(2004) A semiparametric changepoint model, <em>Biometrika</em>, 91, 4, 849&ndash;862.
</p>
<p>Guan, Z. Semiparametric Tests for Change-points with Epidemic Alternatives.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+SemiparChangePoint">SemiparChangePoint</a></code>, <code><a href="#topic+schapt">schapt</a></code>, <code><a href="#topic+p.OneChange">p.OneChange</a></code>, <code><a href="#topic+p.Epidemic.Vn">p.Epidemic.Vn</a></code>, <code><a href="#topic+p.Epidemic.Wn">p.Epidemic.Wn</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>require(sac) #load the package

# one-change alternative
k&lt;-10
n&lt;-20
x&lt;-rnorm(n,0,1)
x[(k+1):n]&lt;-x[(k+1):n]+1.5
T&lt;-SemiparChangePoint(x, alternative = "one.change")$Sn
BootsChapt(x, T, B = 5)
    #Choose larger B to get better approximate p-value.
</code></pre>

<hr>
<h2 id='BootsModelTest'> Bootstrap Test of the Validity of the Semiparametric Change-Point Model </h2><span id='topic+BootsModelTest'></span>

<h3>Description</h3>

<p>Using bootstrap method to approximate the <code>p</code>-value of test of the model validity.
Bootstrap samples are drawn from the semiparametrica empirical distribution which
are estimates of the underlying population distributions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BootsModelTest(x, k, m, B, Alpha, Beta, tol = 1.0e-7, maxit=50, trace=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BootsModelTest_+3A_x">x</code></td>
<td>
<p> a numeric vector or matrix containing the data, one row per observation;</p>
</td></tr>
<tr><td><code id="BootsModelTest_+3A_k">k</code></td>
<td>
<p> the estimated change-point, output of <code><a href="#topic+SemiparChangePoint">SemiparChangePoint</a></code> </p>
</td></tr>
<tr><td><code id="BootsModelTest_+3A_m">m</code></td>
<td>
<p> = <code>n</code> the sample size for <code>"one-change"</code> alternative,
or the estimated second change-point for <code>"epidemic"</code> alternative,
an output of <code><a href="#topic+SemiparChangePoint">SemiparChangePoint</a></code> </p>
</td></tr>
<tr><td><code id="BootsModelTest_+3A_b">B</code></td>
<td>
<p> number of resamples </p>
</td></tr>
<tr><td><code id="BootsModelTest_+3A_alpha">Alpha</code></td>
<td>
<p> estimated parameter <code class="reqn">\alpha</code>, output of <code><a href="#topic+SemiparChangePoint">SemiparChangePoint</a></code>  </p>
</td></tr>
<tr><td><code id="BootsModelTest_+3A_beta">Beta</code></td>
<td>
<p> estimated parameter <code class="reqn">\beta</code>, output of <code><a href="#topic+SemiparChangePoint">SemiparChangePoint</a></code>  </p>
</td></tr>
<tr><td><code id="BootsModelTest_+3A_tol">tol</code></td>
<td>
<p> the desired accuracy (convergence tolerance), an argument of <code><a href="stats.html#topic+glm.control">glm.control</a></code>. </p>
</td></tr>
<tr><td><code id="BootsModelTest_+3A_maxit">maxit</code></td>
<td>
<p> the maximum number of iterations, an argument of <code><a href="stats.html#topic+glm.control">glm.control</a></code>. </p>
</td></tr>
<tr><td><code id="BootsModelTest_+3A_trace">trace</code></td>
<td>
<p> logical indicating if output should be produced for each
iteration, an argument of <code><a href="stats.html#topic+glm.control">glm.control</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>Delta</code></td>
<td>
<p>The test statistic of the model validity</p>
</td></tr>
<tr><td><code>Pvalue</code></td>
<td>
<p>The bootstrapped <code>p</code>-value </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Zhong Guan <a href="mailto:zguan@iusb.edu">zguan@iusb.edu</a></p>


<h3>References</h3>

<p>Guan, Z.(2001) Some Results About Empirical Likelihood Method,
<em>Ph.D. Thesis, The University of Toledo</em>.
</p>
<p>Guan, Z.(2004) A semiparametric changepoint model, <em>Biometrika</em>, 91, 4, 849&ndash;862.
</p>
<p>Guan, Z. Semiparametric Tests for Change-points with Epidemic Alternatives.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+SemiparChangePoint">SemiparChangePoint</a></code>, <code><a href="#topic+schapt">schapt</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Nile data with one change-point: the annual flows drop in 1898.
## It is believed to be caused by the building of the first Aswan dam.
if(! "package:stats" %in% search()) library(stats)
data(Nile)
require(sac) #load the package
Nile.res&lt;-SemiparChangePoint(Nile, alternative = "one.change")
BootsModelTest(Nile, Nile.res$k.hat, length(Nile), B=5, Nile.res$alpha.hat, 
    Nile.res$beta.hat)
    # Choose larger B to get better approximate p-value.
    # It takes longer to do bootstrap model test for large B.
</code></pre>

<hr>
<h2 id='CriticalValues'> Critical Values of Tests of Change-Point(s) with One-Change or Epidemic Alternative </h2><span id='topic+Sn.alfa'></span><span id='topic+CV.Epidemic.Vn'></span><span id='topic+CV.Epidemic.Wn'></span>

<h3>Description</h3>

<p> Return the approximate critical values of the test statistics given level <code>alfa</code></p>


<h3>Usage</h3>

<pre><code class='language-R'>Sn.alfa(alfa,n,d,model=c("parametric","semiparametric"),
        tol = .Machine$double.eps^0.25, maxiter = 1000)
CV.Epidemic.Vn(alfa, d, tol = 1e-10)
CV.Epidemic.Wn(alfa, tol = 1e-07)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CriticalValues_+3A_alfa">alfa</code></td>
<td>
<p> significance level</p>
</td></tr>
<tr><td><code id="CriticalValues_+3A_n">n</code></td>
<td>
<p> sample size</p>
</td></tr>
<tr><td><code id="CriticalValues_+3A_model">model</code></td>
<td>
<p> a character string specifying the model,
must be one of <code>"parametric"</code> or <code>"semiparametric"</code> (default).
You can specify just the initial letter</p>
</td></tr>
<tr><td><code id="CriticalValues_+3A_d">d</code></td>
<td>
<p> dimension of the data value </p>
</td></tr>
<tr><td><code id="CriticalValues_+3A_tol">tol</code></td>
<td>
<p> the desired accuracy (convergence). </p>
</td></tr>
<tr><td><code id="CriticalValues_+3A_maxiter">maxiter</code></td>
<td>
<p>  the maximum number of iterations for <code>uniroot</code>. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function <code>Sn.alfa</code> returns the critical value
of <code>Sn</code> for one-change alternative.  The functions <code>CV.Epidemic.Vn</code>
and <code>CV.Epidemic.Wn</code> calculate critical values
for <code>Vn</code> and <code>Wn</code>.
</p>


<h3>Value</h3>

<p>Critical values
</p>


<h3>Author(s)</h3>

<p> Zhong Guan  <a href="mailto:zguan@iusb.edu">zguan@iusb.edu</a></p>


<h3>References</h3>

<p>Csorgo, M. and Horvath, L. (1997),
<em>Limit Theorems in Change-Point Analysis</em>, New York: John Wiley</p>


<h3>See Also</h3>

 <p><code><a href="#topic+schapt">schapt</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>require(sac) #load the package
alpha&lt;-0.05
n&lt;-20
d&lt;-1
Sn.alfa(alpha, n, d, model="semiparametric")
CV.Epidemic.Vn(alpha, d)
CV.Epidemic.Wn(alpha)
</code></pre>

<hr>
<h2 id='cumsum.test'>Nonparametric Test for Change-Point with One-change or Epidemic Alternative</h2><span id='topic+cumsum.test'></span>

<h3>Description</h3>

<p>Compute test statistic based on CUMSUM and change-point estimate
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cumsum.test(x, alternative = c("one.change", "epidemic"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cumsum.test_+3A_x">x</code></td>
<td>
<p> a numeric vector or matrix containing the data, one row per observation;</p>
</td></tr>
<tr><td><code id="cumsum.test_+3A_alternative">alternative</code></td>
<td>
<p> a character string specifying the alternative hypothesis,
must be one of <code>"one-change"</code> (default) or <code>"epidemic"</code>.  You can specify just the initial letter.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>Sn</code></td>
<td>
<p>test statistic</p>
</td></tr>
<tr><td><code>k.hat</code></td>
<td>
<p>estimated change-point</p>
</td></tr>
<tr><td><code>m.hat</code></td>
<td>
<p>the second estimated change-point for epidemic alternative</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Zhong Guan <a href="mailto:zguan@iusb.edu">zguan@iusb.edu</a></p>


<h3>References</h3>

<p>Csorgo, M. and Horvath, L. (1997),
<em>Limit Theorems in Change-Point Analysis</em>, New York: John Wiley
</p>


<h3>See Also</h3>

 <p><code><a href="base.html#topic+cumsum">cumsum</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>require(sac) #load the package
# one-change alternative
k&lt;-10
n&lt;-30
x&lt;-rnorm(n,0,1)
x[(k+1):n]&lt;-x[(k+1):n]+1.5
cumsum.test(x, alternative = "one.change")
# epidemic alternative
k&lt;-10
m&lt;-20
n&lt;-30
x&lt;-rnorm(n,0,1)
x[(k+1):m]&lt;-x[(k+1):m]+1.5
cumsum.test(x,  alternative = "epidemic")

</code></pre>

<hr>
<h2 id='plots'>Visualized Model Diagnostic and Loglikelihood Plot</h2><span id='topic+Graf.Diagnostic'></span><span id='topic+Plot.ll'></span>

<h3>Description</h3>

<p>Plot and compare the empirical likelihood and semiparametric empirical
likelihood distribution functions, plot loglikelihood function. </p>


<h3>Usage</h3>

<pre><code class='language-R'>Graf.Diagnostic(x, k, m, Alpha, Beta, Color, LTY, xlab = "x", 
    ylab = "Estimated DF's", main = "Model Diagnostic", 
    OneLegend = TRUE, lgnd1, lgnd2, arw1, arw2, ...)
Plot.ll(x, ll, col, xaxis.lab = NULL, xlab = "k", ylab = "Loglikelihood", 
    main = "Plot of Loglikelihood",...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plots_+3A_x">x</code></td>
<td>
<p> a numeric vector or matrix containing the data, one row per observation;</p>
</td></tr>
<tr><td><code id="plots_+3A_ll">ll</code></td>
<td>
<p> loglikelihood function, output of <code><a href="#topic+SemiparChangePoint">SemiparChangePoint</a></code> </p>
</td></tr>
<tr><td><code id="plots_+3A_col">col</code></td>
<td>
<p> color code or character string for the loglikelihood curve </p>
</td></tr>
<tr><td><code id="plots_+3A_xaxis.lab">xaxis.lab</code></td>
<td>
<p>a vector of character strings or numeric values to be placed at
the tickpoints as <code>labels</code> of <code><a href="graphics.html#topic+axis">axis</a></code> </p>
</td></tr>
<tr><td><code id="plots_+3A_k">k</code></td>
<td>
<p> the estimated change-point, output of <code><a href="#topic+SemiparChangePoint">SemiparChangePoint</a></code> </p>
</td></tr>
<tr><td><code id="plots_+3A_m">m</code></td>
<td>
<p> = <code>n</code>, the sample size, for <code>"one-change"</code> alternative,
or the estimated second change-point for <code>"epidemic"</code> alternative,
an output of <code><a href="#topic+SemiparChangePoint">SemiparChangePoint</a></code> </p>
</td></tr>
<tr><td><code id="plots_+3A_alpha">Alpha</code></td>
<td>
<p> estimated parameter <code class="reqn">\alpha</code>, output of <code><a href="#topic+SemiparChangePoint">SemiparChangePoint</a></code>  </p>
</td></tr>
<tr><td><code id="plots_+3A_beta">Beta</code></td>
<td>
<p> estimated parameter <code class="reqn">\beta</code>, output of <code><a href="#topic+SemiparChangePoint">SemiparChangePoint</a></code>  </p>
</td></tr>
<tr><td><code id="plots_+3A_color">Color</code></td>
<td>
<p>a vector of character strings or color codes for
curves of estimated distribution functions <code class="reqn">\hat F</code>, <code class="reqn">\tilde F</code>,
<code class="reqn">\hat G</code> and <code class="reqn">\tilde G</code></p>
</td></tr>
<tr><td><code id="plots_+3A_lty">LTY</code></td>
<td>
<p> vector of lty's, LTY=c(lty1, lty2, lty3, lty4), corresponds to the above color codes </p>
</td></tr>
<tr><td><code id="plots_+3A_xlab">xlab</code></td>
<td>
<p> character string for x-axis lable </p>
</td></tr>
<tr><td><code id="plots_+3A_ylab">ylab</code></td>
<td>
<p> character string for y-axis lable </p>
</td></tr>
<tr><td><code id="plots_+3A_main">main</code></td>
<td>
<p> character string for main title </p>
</td></tr>
<tr><td><code id="plots_+3A_onelegend">OneLegend</code></td>
<td>
<p> a logical indicating whether plot one or two legend. </p>
</td></tr>
<tr><td><code id="plots_+3A_lgnd1">lgnd1</code></td>
<td>
<p> a numeric vector of two specify the position of the first legend box </p>
</td></tr>
<tr><td><code id="plots_+3A_lgnd2">lgnd2</code></td>
<td>
<p> a numeric vector of two specify the position of the second legend box,
if <code>OneLegend</code> = FALSE </p>
</td></tr>
<tr><td><code id="plots_+3A_arw1">arw1</code></td>
<td>
<p> a numeric vector of four numbers indicating start and end positions of
the first arrows point to curves </p>
</td></tr>
<tr><td><code id="plots_+3A_arw2">arw2</code></td>
<td>
<p> a numeric vector of four numbers indicating start and end positions of
the second arrows point to curves </p>
</td></tr>
<tr><td><code id="plots_+3A_...">...</code></td>
<td>
<p> other arguments of function <code>plot</code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Zhong Guan <a href="mailto:zguan@iusb.edu">zguan@iusb.edu</a> </p>


<h3>References</h3>

<p>Guan, Z.(2001) Some Results About Empirical Likelihood Method,
<em>Ph.D. Thesis, The University of Toledo</em>;
</p>
<p>Guan, Z.(2004) A semiparametric change-point model, <em>Biometrika</em>, 91, 4, 849&ndash;862.
</p>
<p>Guan, Z. Semiparametric Tests for Changepoints with Epidemic Alternatives.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+schapt">schapt</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>require(sac) #load the package
k&lt;-30
n&lt;-80
x&lt;-rnorm(n,0,1)
x[(k+1):n]&lt;-x[(k+1):n]+1.5
res&lt;-SemiparChangePoint(x, alternative = "one.change")
Plot.ll(x, res$ll, col="blue")

## Nile data with one change-point: the annual flows drop in 1898 which corresponds 
## to k=28. It is believed to be caused by the building of the first Aswan dam.
if(! "package:sac" %in% search()) library(sac) 
    #if package sac has not been loaded, load it.
if(! "package:stats" %in% search()) library(stats)
data(Nile)
plot(Nile, type="p")
Nile.res&lt;-SemiparChangePoint(Nile, alternative = "one.change")
Color&lt;-c(1,2,3,4); LTY&lt;-c(1,2,3,4)

## Plots of estimated distribution functions
Graf.Diagnostic(Nile, Nile.res$k.hat, length(Nile), Nile.res$alpha.hat, 
    Nile.res$beta.hat, Color, LTY, xlab = "x", ylab = "Estimated DF's", 
    main="Model Diagnostic for Nile Data", OneLegend = FALSE, lgnd1 = 
    c(1100, 0.15), lgnd2 = c(600, .99), arw1=c(780, .93, 1010, .9),
    arw2 = c(1165, .15, 1015, .24))

## Plot of loglikelihood function
Plot.ll(Nile, Nile.res$ll, col = "blue")
Plot.ll(Nile, Nile.res$ll, col = "blue", xaxis.lab = seq(1871,1970, length = 100), 
    xlab = "Year")
</code></pre>

<hr>
<h2 id='Pvalues'> The p-values of Test Statistics Based on Asymptotic Distribution  </h2><span id='topic+p.OneChange'></span><span id='topic+p.Epidemic.Vn'></span><span id='topic+p.Epidemic.Wn'></span>

<h3>Description</h3>

<p>Calculate the approximate <code>p</code>-values of the test statistics
<code>Tn</code>, <code>Vn</code> and <code>Wn</code> using limit null distributions.</p>


<h3>Usage</h3>

<pre><code class='language-R'>p.OneChange(n, d, Sn)
p.Epidemic.Vn(Vn, d, tol = 1e-10)
p.Epidemic.Wn(Wn, tol = 1e-07)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Pvalues_+3A_sn">Sn</code></td>
<td>
<p> test statistic <code>Sn</code> of the one-change alternative </p>
</td></tr>
<tr><td><code id="Pvalues_+3A_vn">Vn</code></td>
<td>
<p>test statistic <code>Vn</code> of the epidemic alternative</p>
</td></tr>
<tr><td><code id="Pvalues_+3A_wn">Wn</code></td>
<td>
<p> test statistic <code>Wn</code> of the epidemic alternative </p>
</td></tr>
<tr><td><code id="Pvalues_+3A_n">n</code></td>
<td>
<p> sample size </p>
</td></tr>
<tr><td><code id="Pvalues_+3A_d">d</code></td>
<td>
<p> dimension of the data value </p>
</td></tr>
<tr><td><code id="Pvalues_+3A_tol">tol</code></td>
<td>
<p> the desired accuracy. </p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>p.value</code></td>
<td>
<p><code>p</code>-value</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Zhong Guan <a href="mailto:zguan@iusb.edu">zguan@iusb.edu</a> </p>


<h3>References</h3>

<p>Guan, Z.(2001) Some Results About Empirical Likelihood Method,
<em>Ph.D. Thesis, The University of Toledo</em>.
</p>
<p>Guan, Z.(2004) A semiparametric changepoint model, <em>Biometrika</em>, 91, 4, 849&ndash;862.
</p>
<p>Guan, Z. Semiparametric Tests for Change-points with Epidemic Alternatives.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+schapt">schapt</a></code>, <code><a href="#topic+BootsChapt">BootsChapt</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>require(sac) #load the package
# one-change alternative
k&lt;-10
n&lt;-30
x&lt;-rnorm(n,0,1)
x[(k+1):n]&lt;-x[(k+1):n]+1.5
T&lt;-SemiparChangePoint(x, alternative = "one.change")$Sn
p.OneChange(n, d=1, T)

# epidemic alternative
k&lt;-5
m&lt;-10
n&lt;-20
x&lt;-rnorm(n,0,1)
x[(k+1):m]&lt;-x[(k+1):m]+1.5
res&lt;-SemiparChangePoint(x, alternative = "e")
V&lt;-res$Vn; W&lt;-res$Wn
p.Epidemic.Vn(V, d=1)
p.Epidemic.Wn(W)
</code></pre>

<hr>
<h2 id='sac-internal'>Internal sac Functions</h2><span id='topic+dvalue.epidemic'></span><span id='topic+Deltan.ModelTest'></span><span id='topic+G.alfa'></span><span id='topic+Z.alfa'></span><span id='topic+Zn.alfa'></span>

<h3>Description</h3>

<p>Internal speltest functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dvalue.epidemic(x, tol = 1e-07)
Deltan.ModelTest(x, k, m, Alpha, Beta)
Z.alfa(alfa, n, d)
</code></pre>


<h3>Details</h3>

<p>These are not to be called by the user.
</p>

<hr>
<h2 id='schapt'> Semiparametric Analysis of Changepoint</h2><span id='topic+schapt'></span>

<h3>Description</h3>

<p>Semiparametric empirical likelihood ratio
based test of changepoint with one-change or epidemic alternatives
with data-based model diagnostic
</p>


<h3>Usage</h3>

<pre><code class='language-R'>schapt(x, n.boots = 0, replace = FALSE, alternative = c("one.change",
    "epidemic"), conf.level = 0.95, adj.Wn = FALSE, model.test = FALSE,
    n.model.boots = 0, tol=1.0e-7, maxit=50,trace=FALSE,... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="schapt_+3A_x">x</code></td>
<td>
<p> a numeric vector or matrix containing the data, one row per observation;</p>
</td></tr>
<tr><td><code id="schapt_+3A_n.boots">n.boots</code></td>
<td>
<p> number of bootstrap samples for bootstrap test of the change-point,
if <code>n.boots =0 </code>, do not perform bootstrap test;</p>
</td></tr>
<tr><td><code id="schapt_+3A_replace">replace</code></td>
<td>
<p> a logical indicating whether bootstrap samples for bootstrap test
of the change-point are selected with or without replacement, if <code>replace</code>= FALSE (default),
corresponds to permutation test, otherwise, bootstrap test; </p>
</td></tr>
<tr><td><code id="schapt_+3A_alternative">alternative</code></td>
<td>
<p> a character string specifying the alternative hypothesis,
must be one of <code>"one-change"</code> (default) or <code>"epidemic"</code>.  You can specify just the initial letter.
Epidemic alternative is also called square wave alternative in the literature.</p>
</td></tr>
<tr><td><code id="schapt_+3A_conf.level">conf.level</code></td>
<td>
<p> confidence level.</p>
</td></tr>
<tr><td><code id="schapt_+3A_adj.wn">adj.Wn</code></td>
<td>
<p> logical indicating if <code>Wn</code> should be adjusted or not
for <code>"epidemic"</code> alternative. </p>
</td></tr>
<tr><td><code id="schapt_+3A_model.test">model.test</code></td>
<td>
<p>a logical indicating whether the test of model validity is performed.</p>
</td></tr>
<tr><td><code id="schapt_+3A_n.model.boots">n.model.boots</code></td>
<td>
<p> number of bootstrap samples for model test, if either
<code>n.model.boots</code> = 0 or
<code>model.test</code>=FALSE, then model test will not be performed.</p>
</td></tr>
<tr><td><code id="schapt_+3A_tol">tol</code></td>
<td>
<p> the desired accuracy (convergence tolerance), an argument of <code><a href="stats.html#topic+glm.control">glm.control</a></code>. </p>
</td></tr>
<tr><td><code id="schapt_+3A_maxit">maxit</code></td>
<td>
<p> the maximum number of iterations, an argument of <code><a href="stats.html#topic+glm.control">glm.control</a></code>. </p>
</td></tr>
<tr><td><code id="schapt_+3A_trace">trace</code></td>
<td>
<p> logical indicating if output should be produced for each
iteration, an argument of <code><a href="stats.html#topic+glm.control">glm.control</a></code>.</p>
</td></tr>
<tr><td><code id="schapt_+3A_...">...</code></td>
<td>
<p> other future arguments </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Model: <code class="reqn">\log\{g(x)/f(x)\}=\exp\{\alpha+\beta'T(x)\}</code>,
where <code class="reqn">f(x)</code> and <code class="reqn">g(x)</code> are the
density (frequency) functions of the two hypothesized populations, and <code class="reqn">T(x)</code> can be chosen as
<code class="reqn">T(x)=x</code> or <code class="reqn">T(x)=(x,x^2)</code>.  The procedure will fail when there is separation in the data in the
sense of Albert \&amp; Anderson(1984, <em>Biometrika</em>) and Santner \&amp; Duffy (1986, <em>Biometrika</em>).
In this case, the change-point(s) may be detected easily using nonparametric method
based on cumsum. Currently, this function does not check whether the data are separated.
</p>


<h3>Value</h3>

<table>
<tr><td><code>data.name</code></td>
<td>
<p>dataset name</p>
</td></tr>
<tr><td><code>parameter</code></td>
<td>
<p>sample size <code>n</code> and degree(s) of freedom of the <code>df</code> of <code>Sn</code> for
<code>"one-change"</code> alternative</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p>the alternative hypothesis</p>
</td></tr>
<tr><td><code>statistic</code></td>
<td>
<p>a list contains <code>Sn</code> for <code>"one-change"</code> alternative, <code>Sn</code>, <code>Vn</code> and <code>Wn</code>
for <code>"epidemic"</code> alternative;
also contains <code>Delta</code> if model test is performed </p>
</td></tr>
<tr><td><code>estimate</code></td>
<td>
<p>a list contains change-point(s) and <code>alpha</code> and <code>beta</code></p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p> a list contains <code>p</code>-value(s), <code>p(Sn)</code>, of <code>Sn</code> for <code>"one-change"</code> alternative,
<code>p(Vn)</code> and <code>p(Wn)</code>, of <code>Vn</code> and <code>Wn</code>, repectively, for <code>"epidemic"</code> alternative;
also <code>p.boots(model)</code> of <code>Delta</code> if model test is performed, if bootstrap test(s) of the change-point(s)
are performed, the it also containts the
corresponding <code>p</code>-values, <code>p.boots(Sn)</code>, <code>p.boots(Vn)</code> and <code>p.boots(Wn)</code> accordingly.</p>
</td></tr>

</table>


<h3>Note</h3>

<p>Statistic <code>Wn</code> need be adjusted only for one dimensional observations
and if no bootstrap test is conducted. If returned <code>p</code>-value is 0, this means that the
<code>p</code>-value is less than 1.0e-7.
</p>


<h3>Author(s)</h3>

<p> Zhong Guan <a href="mailto:zguan@iusb.edu">zguan@iusb.edu</a></p>


<h3>References</h3>

<p>Guan,  Z. (2001).   Some Results About Empirical Likelihood Method,
<em>Ph.D. Thesis, The University of Toledo</em>.
</p>
<p>Guan, Z.(2004) A semiparametric change-point model, <em>Biometrika</em>, 91, 4, 849&ndash;862.
</p>
<p>Guan, Z. Semiparametric Tests for Change-points with Epidemic Alternatives.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+Graf.Diagnostic">Graf.Diagnostic</a></code>, <code><a href="#topic+Plot.ll">Plot.ll</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>require(sac) #load the package
# one-change alternative
## Nile data with one change-point: the annual flows drop in 1898.
## It is believed to be caused by the building of the first Aswan dam.
if(! "package:sac" %in% search()) library(sac)
    #if package sac has not been loaded, load it.
if(! "package:stats" %in% search()) library(stats)
data(Nile)
plot(Nile, type="p")
schapt(Nile, alternative = "one.change")
</code></pre>

<hr>
<h2 id='SemiparChangePoint'> Semiparametric Test of Change-point(s) with One-change or Epidemic Alternative </h2><span id='topic+SemiparChangePoint'></span>

<h3>Description</h3>

<p>Calculate test statistics, loglikelihood function and estimate unknown parameters in the semiparametric model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SemiparChangePoint(x, alternative = c("one.change", "epidemic"), 
    adj.Wn = FALSE, tol = 1e-07, maxit = 50, trace = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SemiparChangePoint_+3A_x">x</code></td>
<td>
<p> a numeric vector or matrix containing the data, one row per observation;</p>
</td></tr>
<tr><td><code id="SemiparChangePoint_+3A_alternative">alternative</code></td>
<td>
<p> a character string specifying the alternative hypothesis,
must be one of <code>"one-change"</code> (default) or <code>"epidemic"</code>.  You can specify just the initial letter.</p>
</td></tr>
<tr><td><code id="SemiparChangePoint_+3A_tol">tol</code></td>
<td>
<p> the desired accuracy (convergence tolerance), an argument of <code><a href="stats.html#topic+glm.control">glm.control</a></code>. </p>
</td></tr>
<tr><td><code id="SemiparChangePoint_+3A_adj.wn">adj.Wn</code></td>
<td>
<p> logical indicating if <code>Wn</code> should be adjusted or not
for <code>"epidemic"</code> alternative. </p>
</td></tr>
<tr><td><code id="SemiparChangePoint_+3A_maxit">maxit</code></td>
<td>
<p> the maximum number of iterations, an argument of <code><a href="stats.html#topic+glm.control">glm.control</a></code>. </p>
</td></tr>
<tr><td><code id="SemiparChangePoint_+3A_trace">trace</code></td>
<td>
<p> logical indicating if output should be produced for each
iteration, an argument of <code><a href="stats.html#topic+glm.control">glm.control</a></code>.</p>
</td></tr>
<tr><td><code id="SemiparChangePoint_+3A_...">...</code></td>
<td>
<p> other future arguments </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Model: <code class="reqn">\log\{ g(x)/f(x)\}=\exp\{\alpha+\beta'T(x)\}</code> , 
where <code class="reqn">f(x)</code> and <code class="reqn">g(x)</code> are the
density (frequency) functions of the two hypothesized populations, and <code class="reqn">T(x)</code> can be chosen as
<code class="reqn">T(x)=x</code> or <code class="reqn">T(x)=(x,x^2)</code>.  The procedure will fail when there is separation in the data in the
sense of Albert \&amp; Anderson(1984, <em>Biometrika</em>) and Santner \&amp; Duffy (1986, <em>Biometrika</em>).
In this case, the change-point(s) may be detected easily using nonparametric method
based on cumsum. Currently, this function does not check whether the data are separated.
</p>


<h3>Value</h3>

<table>
<tr><td><code>k.hat</code></td>
<td>
<p>change-point estimate</p>
</td></tr>
<tr><td><code>m.hat</code></td>
<td>
<p>second change-point estimate for <code>"epidemic"</code> alternative</p>
</td></tr>
<tr><td><code>ll</code></td>
<td>
<p>loglikelihood function</p>
</td></tr>
<tr><td><code>Sn</code></td>
<td>
<p>likelihood ratio test statistic for <code>"one-change"</code> alternative</p>
</td></tr>
<tr><td><code>Vn</code></td>
<td>
<p>test statistic based integal of weighted likelihood ratio for <code>"epidemic"</code> alternative</p>
</td></tr>
<tr><td><code>Wn</code></td>
<td>
<p>test statistic based supremum of weighted likelihood ratio for <code>"epidemic"</code> alternative</p>
</td></tr>
<tr><td><code>alpha.hat</code></td>
<td>
<p>estimate of <code class="reqn">\alpha</code></p>
</td></tr>
<tr><td><code>beta.hat</code></td>
<td>
<p>estimate of <code class="reqn">\beta</code></p>
</td></tr>
</table>


<h3>Note</h3>

<p>Statistic <code>Wn</code> need be adjusted only for one dimensional observations
and if no bootstrap test is conducted. </p>


<h3>Author(s)</h3>

<p> Zhong Guan <a href="mailto:zguan@iusb.edu">zguan@iusb.edu</a></p>


<h3>References</h3>

<p>Guan, Z.(2001) Some Results About Empirical Likelihood Method,
<em>Ph.D. Thesis, The University of Toledo</em>.
</p>
<p>Guan, Z.(2004) A semiparametric change-point model, <em>Biometrika</em>, 91, 4, 849&ndash;862.
</p>
<p>Guan, Z. Semiparametric Tests for Change-points with Epidemic Alternatives.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+schapt">schapt</a></code>, <code><a href="#topic+p.OneChange">p.OneChange</a></code>, <code><a href="#topic+p.Epidemic.Vn">p.Epidemic.Vn</a></code>,
<code><a href="#topic+p.Epidemic.Wn">p.Epidemic.Wn</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>require(sac) #load the package
# one-change alternative
k&lt;-10
n&lt;-30
x&lt;-rnorm(n,0,1)
x[(k+1):n]&lt;-x[(k+1):n]+1.5
SemiparChangePoint(x, alternative = "one.change")

# epidemic alternative
k&lt;-5
m&lt;-10
n&lt;-20
x&lt;-rnorm(n,0,1)
x[(k+1):m]&lt;-x[(k+1):m]+1.5
SemiparChangePoint(x,  alternative = "epidemic")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
