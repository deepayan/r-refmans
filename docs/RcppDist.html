<!DOCTYPE html><html lang="en"><head><title>Help for package RcppDist</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {RcppDist}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#RcppDist'><p>RcppDist</p></a></li>
<li><a href='#bayeslm'><p>bayeslm</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>'Rcpp' Integration of Additional Probability Distributions</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.1</td>
</tr>
<tr>
<td>Description:</td>
<td>The 'Rcpp' package provides a C++ library to make it easier
    to use C++ with R. R and 'Rcpp' provide functions for a variety of
    statistical distributions. Several R packages make functions
    available to R for additional statistical distributions. However,
    to access these functions from C++ code, a costly call to the R
    functions must be made. 'RcppDist' provides a header-only C++ library
    with functions for additional statistical distributions that can be
    called from C++ when writing code using 'Rcpp' or 'RcppArmadillo'.
    Functions are available that return a 'NumericVector' as well as
    doubles, and for multivariate or matrix distributions, 'Armadillo'
    vectors and matrices. 'RcppDist' provides functions for the following
    distributions: the four parameter beta distribution; the location-
    scale t distribution; the truncated normal distribution; the
    truncated t distribution; a truncated location-scale t distribution;
    the triangle distribution; the multivariate normal distribution*;
    the multivariate t distribution*; the Wishart distribution*; and
    the inverse Wishart distribution*. Distributions marked with an
    asterisk rely on 'RcppArmadillo'.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2.0)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/duckmayr/RcppDist">https://github.com/duckmayr/RcppDist</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/duckmayr/RcppDist/issues">https://github.com/duckmayr/RcppDist/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.0</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-10-21 13:45:50 UTC; jb</td>
</tr>
<tr>
<td>Author:</td>
<td>JB Duck-Mayr <a href="https://orcid.org/0000-0002-2231-1294"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>JB Duck-Mayr &lt;j.duckmayr@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-10-28 22:50:09 UTC</td>
</tr>
</table>
<hr>
<h2 id='RcppDist'>RcppDist</h2><span id='topic+RcppDist'></span><span id='topic+RcppDist-package'></span>

<h3>Description</h3>

<p>'Rcpp' Integration of Additional Probability Distributions
</p>


<h3>Details</h3>

<p>The 'Rcpp' package provides a C++ library to make it easier to use C++ with
R. R and 'Rcpp' provide functions for a variety of statistical
distributions. Several R packages make functions available to R for
additional statistical distributions. However, to access these functions
from C++ code, a costly call to the R functions must be made.
</p>
<p>'RcppDist' provides a header-only C++ library with functions for additional
statistical distributions that can be called from C++ when writing code
using 'Rcpp' or 'RcppArmadillo'. Functions are available that return a
'NumericVector' as well as doubles, and for multivariate or matrix
distributions, 'Armadillo' vectors and matrices.
RcppDist provides functions for the following distributions:
</p>

<ul>
<li><p> The four parameter beta distribution
</p>
</li>
<li><p> The location-scale t distribution
</p>
</li>
<li><p> The truncated normal distribution
</p>
</li>
<li><p> The truncated t distribution
</p>
</li>
<li><p> A truncated location-scale t distribution
</p>
</li>
<li><p> The triangle distribution
</p>
</li>
<li><p> The multivariate normal distribution*
</p>
</li>
<li><p> The multivariate t distribution*
</p>
</li>
<li><p> The Wishart distribution*
</p>
</li>
<li><p> And the inverse Wishart distribution*.
</p>
</li></ul>

<p>Distributions marked with an asterisk rely also on RcppArmadillo.
</p>
<p>For more information on using 'RcppDist' functions in your C++ code, please
consult the vignette via <code>vignette("RcppDist")</code>; the vignette explains
how to link to the package and include the headers, which header files
provide which functions, and also provides all function declarations
(so that you can see the function and argument names and return/argument
types; the arguments are also described in reasonable detail). You can also
see an example of using the multivariate normal generator provided by
'RcppDist' in the function <code><a href="#topic+bayeslm">bayeslm</a></code>.
</p>


<h3>Author(s)</h3>

<p>JB Duck-Mayr
</p>

<hr>
<h2 id='bayeslm'>bayeslm</h2><span id='topic+bayeslm'></span>

<h3>Description</h3>

<p>Demonstrates the use of RcppDist in C++ with Bayesian linear regression
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bayeslm(y, x, iters = 1000L)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bayeslm_+3A_y">y</code></td>
<td>
<p>A numeric vector &ndash; the response</p>
</td></tr>
<tr><td><code id="bayeslm_+3A_x">x</code></td>
<td>
<p>A numeric matrix &ndash; the explanatory variables; note this assumes
you have included a column of ones if you intend there to be an intercept.</p>
</td></tr>
<tr><td><code id="bayeslm_+3A_iters">iters</code></td>
<td>
<p>An integer vector of length one, the number of posterior draws
desired; the default is 1000.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To see an example of using RcppDist C++ functions in C++ code,
we can code up a Bayesian linear regression with completely uninformative
priors (such that estimates should be equivalent to classical estimates).
The code to do so is as follows:
</p>
<pre>
#include &lt;RcppDist.h&gt;
// or, alternatively,
// #include &lt;RcppArmadillo.h&gt;
// #include &lt;mvnorm.h&gt;

// [[Rcpp::depends(RcppArmadillo, RcppDist)]]

// [[Rcpp::export]]
Rcpp::List bayeslm(const arma::vec&amp; y, const arma::mat x,
                   const int iters = 1000) {
    int n = x.n_rows;
    int p = x.n_cols;
    double a = (n - p) / 2.0;
    arma::mat xtx = x.t() * x;
    arma::mat xtxinv = xtx.i();
    arma::vec mu = xtxinv * x.t() * y;
    arma::mat px = x * xtxinv * x.t();
    double ssq = arma::as_scalar(y.t() * (arma::eye(n, n) - px) * y);
    ssq *= (1.0 / (n - p));
    double b = 1.0 / (a * ssq);
    arma::mat beta_draws(iters, p);
    Rcpp::NumericVector sigma_draws(iters);
    for ( int iter = 0; iter &lt; iters; ++iter ) {
        double sigmasq = 1.0 / R::rgamma(a, b);
        sigma_draws[iter] = sigmasq;
        // Here we can use our multivariate normal generator
        beta_draws.row(iter) = rmvnorm(1, mu, xtxinv * sigmasq);
    }
    return Rcpp::List::create(Rcpp::_["beta_draws"] = beta_draws,
                              Rcpp::_["sigma_draws"] = sigma_draws);
}
</pre>


<h3>Value</h3>

<p>A list of length two; the first element is a numeric matrix of the
beta draws and the second element is a numeric vector of the sigma draws
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
n &lt;- 30
x &lt;- cbind(1, matrix(rnorm(n*3), ncol = 3))
beta &lt;- matrix(c(10, 2, -1, 3), nrow = 4)
y &lt;- x %*% beta + rnorm(n)
freqmod &lt;- lm(y ~ x[ , -1])
bayesmod &lt;- bayeslm(y, x)
round(unname(coef(freqmod)), 2)
round(apply(bayesmod$beta_draws, 2, mean), 2)
c(beta)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
