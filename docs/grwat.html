<!DOCTYPE html><html><head><title>Help for package grwat</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {grwat}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#%&gt;%'><p>Pipe operator</p></a></li>
<li><a href='#gr_baseflow'><p>Extract baseflow</p></a></li>
<li><a href='#gr_buffer_geo'><p>Quasi-geographic buffering</p></a></li>
<li><a href='#gr_check_data'><p>Check the correctness of data frame for separating</p></a></li>
<li><a href='#gr_check_params'><p>Check the correctness of parameters list for separating</p></a></li>
<li><a href='#gr_fill_gaps'><p>Fill missing daily data</p></a></li>
<li><a href='#gr_get_gaps'><p>Get gaps in the daily data</p></a></li>
<li><a href='#gr_get_params'><p>Get hydrograph separation parameters</p></a></li>
<li><a href='#gr_help_params'><p>Get the information about parameters used to separate the hydrograph</p></a></li>
<li><a href='#gr_help_vars'><p>Hydrograph separation variables</p></a></li>
<li><a href='#gr_join_rean'><p>Join reanalysis data</p></a></li>
<li><a href='#gr_kable_tests'><p>Tabular representation of tests</p></a></li>
<li><a href='#gr_plot_acf'><p>Plot runoff ACF</p></a></li>
<li><a href='#gr_plot_hori'><p>Horizon hydrograph plot</p></a></li>
<li><a href='#gr_plot_matrix'><p>Runoff matrix plot</p></a></li>
<li><a href='#gr_plot_minmonth'><p>Plot minimum runoff month</p></a></li>
<li><a href='#gr_plot_periods'><p>Plot long-term hydrograph variable changes</p></a></li>
<li><a href='#gr_plot_ridge'><p>Ridgeline hydrograph plot</p></a></li>
<li><a href='#gr_plot_sep'><p>Plot hydrograph separation</p></a></li>
<li><a href='#gr_plot_tests'><p>Plot change year density</p></a></li>
<li><a href='#gr_plot_vars'><p>Plot interannual hydrograph variable changes</p></a></li>
<li><a href='#gr_read_rean'><p>Read reanalysis data</p></a></li>
<li><a href='#gr_report'><p>Report hydrograph separation and variables</p></a></li>
<li><a href='#gr_separate'><p>Advanced hydrograph separation</p></a></li>
<li><a href='#gr_set_locale'><p>Set the language that is used for plotting</p></a></li>
<li><a href='#gr_set_param'><p>Set the value of hydrograph separation parameter</p></a></li>
<li><a href='#gr_summarize'><p>Summarize hydrograph separation</p></a></li>
<li><a href='#gr_test_vars'><p>Test hydrograph changes</p></a></li>
<li><a href='#spas'><p>Spas-Zagorye daily runoff data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>River Hydrograph Separation and Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>0.0.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-10-27</td>
</tr>
<tr>
<td>Description:</td>
<td>River hydrograph separation and daily runoff time series analysis. Provides
  various filters to separate baseflow and quickflow. Implements advanced separation 
  technique by Rets et al. (2022) &lt;<a href="https://doi.org/10.1134%2FS0097807822010146">doi:10.1134/S0097807822010146</a>&gt; which involves 
  meteorological data to reveal genetic components of the runoff: ground, rain, thaw 
  and spring (seasonal thaw). High-performance C++17 computation, annually aggregated 
  variables, statistical testing and numerous plotting functions for high-quality 
  visualization.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/tsamsonov/grwat">https://github.com/tsamsonov/grwat</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/tsamsonov/grwat/issues">https://github.com/tsamsonov/grwat/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>pandoc</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.3)</td>
</tr>
<tr>
<td>Imports:</td>
<td>cli, Rcpp, magrittr, dplyr, tidyr, lubridate, stringr, rlang,
grid, ggplot2, zoo, trend, mblm, R.utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>ggridges, ggHoriPlot, ggthemes, kableExtra, knitr, ncdf4,
rmarkdown, sf, testthat, stringi</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-10-27 09:42:59 UTC; tsamsonov</td>
</tr>
<tr>
<td>Author:</td>
<td>Timofey Samsonov <a href="https://orcid.org/0000-0001-5994-0302"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Ekaterina Retz <a href="https://orcid.org/0000-0002-4505-1173"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb],
  Maria Kireeva <a href="https://orcid.org/0000-0002-8285-9761"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Timofey Samsonov &lt;tsamsonov@geogr.msu.ru&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-10-27 11:40:12 UTC</td>
</tr>
</table>
<hr>
<h2 id='+25+26gt+3B+25'>Pipe operator</h2><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>See <code>magrittr::<a href="magrittr.html#topic+pipe">%&gt;%</a></code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lhs %&gt;% rhs
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_lhs">lhs</code></td>
<td>
<p>A value or the magrittr placeholder.</p>
</td></tr>
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_rhs">rhs</code></td>
<td>
<p>A function call using the magrittr semantics.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The result of calling <code>rhs(lhs)</code>.
</p>

<hr>
<h2 id='gr_baseflow'>Extract baseflow</h2><span id='topic+gr_baseflow'></span>

<h3>Description</h3>

<p>Extract baseflow from hydrological series using the filtering approach
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gr_baseflow(
  Q,
  a = 0.925,
  k = 0.975,
  C = 0.05,
  aq = -0.5,
  passes = 3,
  padding = 30,
  method = "lynehollick"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gr_baseflow_+3A_q">Q</code></td>
<td>
<p>Numeric runoff vector.</p>
</td></tr>
<tr><td><code id="gr_baseflow_+3A_a">a</code></td>
<td>
<p>Numeric value of a filtering parameter used in <code>'chapman'</code>, <code>'jakeman'</code> and <code>'lynehollick'</code> methods. Defaults to <code>0.925</code>.</p>
</td></tr>
<tr><td><code id="gr_baseflow_+3A_k">k</code></td>
<td>
<p>Numeric value of a filtering parameter used in <code>'boughton'</code> and <code>'maxwell'</code> methods. Defaults to <code>0.975</code>.</p>
</td></tr>
<tr><td><code id="gr_baseflow_+3A_c">C</code></td>
<td>
<p>Numeric value of a separation shape parameter used in <code>'boughton'</code>, <code>'jakeman'</code> and <code>'maxwell'</code> methods</p>
</td></tr>
<tr><td><code id="gr_baseflow_+3A_aq">aq</code></td>
<td>
<p>Numeric value of a filtering parameter used in <code>'jakeman'</code> method. Defaults to <code>-0.5</code>.</p>
</td></tr>
<tr><td><code id="gr_baseflow_+3A_passes">passes</code></td>
<td>
<p>Integer number of filtering iterations. The first iteration is forward, second is backward, third is forward and so on. Defaults to <code>3</code>.</p>
</td></tr>
<tr><td><code id="gr_baseflow_+3A_padding">padding</code></td>
<td>
<p>Integer number of elements padded at the beginning and ending of runoff vector to reduce boundary effects. Defaults to <code>30</code>.</p>
</td></tr>
<tr><td><code id="gr_baseflow_+3A_method">method</code></td>
<td>
<p>Character string to set baseflow filtering method. Available methods are <code>'boughton'</code>, <code>'chapman'</code>, <code>'furey'</code>, <code>'jakeman'</code>, <code>'lynehollick'</code> and <code>'maxwell'</code>. Default is <code>'lynehollick'</code>, which corresponds to Lyne-Hollick (1979) hydrograph separation method.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric baseflow vector with length equal to <code>Q</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(grwat)
library(ggplot2)
library(dplyr)
library(tidyr)
library(lubridate)

data(spas) # example Spas-Zagorye data is included with grwat package

# Calculate baseflow using Line-Hollick approach
hdata = spas %&gt;% 
  mutate(Qbase = gr_baseflow(Q, method = 'lynehollick', 
                             a = 0.925, passes = 3))

# Visualize for 1980 year
ggplot(hdata) +
  geom_area(aes(Date, Q), fill = 'steelblue', color = 'black') +
  geom_area(aes(Date, Qbase), fill = 'orangered', color = 'black') +
  scale_x_date(limits = c(ymd(19800101), ymd(19801231)))

# Compare various approaches
hdata = spas %&gt;%
  mutate(lynehollick = gr_baseflow(Q, method = 'lynehollick', a = 0.9),
         boughton = gr_baseflow(Q, method = 'boughton', k = 0.9),
         jakeman = gr_baseflow(Q, method = 'jakeman', k = 0.9),
         maxwell = gr_baseflow(Q, method = 'maxwell', k = 0.9)) %&gt;% 
  pivot_longer(lynehollick:maxwell, names_to = 'Method', values_to = 'Qbase')

# Visualize for 1980 year
ggplot(hdata) +
  geom_area(aes(Date, Q), fill = 'steelblue', color = 'black') +
  geom_area(aes(Date, Qbase), fill = 'orangered', color = 'black') +
  scale_x_date(limits = c(ymd(19810101), ymd(19811231))) +
  facet_wrap(~Method)

# Compare Lyne to Kudelin
p = gr_get_params('center')
p$filter = 'kudelin'

hdata = spas %&gt;% 
  mutate(lynehollick = gr_baseflow(Q, method = 'lynehollick', 
                                   a = 0.925, passes = 3),
         kudelin = gr_separate(spas, p)$Qbase) %&gt;% 
  pivot_longer(lynehollick:kudelin, names_to = 'Method', values_to = 'Qbase')

# Visualize for 1980 year
ggplot(hdata) +
  geom_area(aes(Date, Q), fill = 'steelblue', color = 'black') +
  geom_area(aes(Date, Qbase), fill = 'orangered', color = 'black') +
  scale_x_date(limits = c(ymd(19800101), ymd(19801231))) +
  facet_wrap(~Method)
</code></pre>

<hr>
<h2 id='gr_buffer_geo'>Quasi-geographic buffering</h2><span id='topic+gr_buffer_geo'></span>

<h3>Description</h3>

<p>Generate the buffer of spatial object in geographic coordinates. The function transforms the object into Azimuthal equidistant projection, then buffers it by the specified radius and then reprojects into geographical coordinate system (WGS84)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gr_buffer_geo(g, bufsize)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gr_buffer_geo_+3A_g">g</code></td>
<td>
<p><code>sf</code> or <code>sfg</code> object with known coordinate system.</p>
</td></tr>
<tr><td><code id="gr_buffer_geo_+3A_bufsize">bufsize</code></td>
<td>
<p>Numeric value of a buffer distance, in meters.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>sf</code> or <code>sfg</code> object, buffered to <code>bufsize</code> and projected into geographic coordinates (WGS84).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (require("sf")) {

  library(grwat)
  library(ggplot2)
  path = system.file("extdata", "spas-zagorye.gpkg", package = "grwat")
  basin = sf::st_read(path, layer = 'basin') # read basin region

  basin_buffer = gr_buffer_geo(basin, 25000)

  ggplot() +
    geom_sf(data = basin_buffer, fill = 'orangered', color = 'black') +
    geom_sf(data = basin, fill = 'steelblue', color = 'black')

}
</code></pre>

<hr>
<h2 id='gr_check_data'>Check the correctness of data frame for separating</h2><span id='topic+gr_check_data'></span>

<h3>Description</h3>

<p>This function is called inside <code><a href="#topic+gr_separate">gr_separate()</a></code>, but can be used explicitly inside your code.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gr_check_data(df)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gr_check_data_+3A_df">df</code></td>
<td>
<p><code>data.frame</code> with four columns: date, runoff, temperature, precipitation, as required by <code><a href="#topic+gr_separate">gr_separate()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>stops execution if <code>df</code> contains the wrong number of columns, or the columns have the wrong types, or the data in columns is incorrect (e.g. runoff or precipitation are negative).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(grwat)

# example Spas-Zagorye data is included with grwat package
data(spas)
head(spas)

gr_check_data(spas)

# raw Spas-Zagorye data represents date components
# in columns and does not contain meteorologgical variables
path = system.file("extdata", "spas-zagorye.txt", 
                   package = "grwat")

hdata_raw = read.delim(path, header = FALSE, 
                       sep = ' ', na.strings = c('-999', '-999.0', '-'),
                       col.names = c('d', 'm', 'y', 'q'))

print(hdata_raw)

try(gr_check_data(hdata_raw))



</code></pre>

<hr>
<h2 id='gr_check_params'>Check the correctness of parameters list for separating</h2><span id='topic+gr_check_params'></span>

<h3>Description</h3>

<p>Check the correctness of parameters list for separating
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gr_check_params(params, df = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gr_check_params_+3A_params">params</code></td>
<td>
<p><code>list</code> of separation parameters, as returned by <code><a href="#topic+gr_get_params">gr_get_params()</a></code> function</p>
</td></tr>
<tr><td><code id="gr_check_params_+3A_df">df</code></td>
<td>
<p><code>data.frame</code> with four columns: date, runoff, temperature, precipitation, as required by <code><a href="#topic+gr_separate">gr_separate()</a></code>. Required when params is a <code>list</code> of parameter <code>list</code>s. Defaults to <code>NULL</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>stops the execution if anything is wrong and prints the exact reason of the error. Otherwise prints the message that everything is OK
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(grwat)

# example Spas-Zagorye data is included with grwat package
data(spas)

params = gr_get_params(reg = 'center')

gr_check_params(params)

# set the unknown parameter
params$new = -2

# use try if you do not want to stop at error
try(gr_check_params(params))

# remove wrong parameter
params$new = NULL

# remove right parameter
params$grad1 = NULL
try(gr_check_params(params))

# reset
params = gr_get_params(reg = 'center')

sep = gr_separate(spas, params, debug = TRUE)
parlist = attributes(sep)$params

parlist[['2002']]$grad1 = 4

# if the parlist is used for separation
# then data frame must be specified
try(gr_check_params(parlist))

gr_check_params(parlist, spas)

# grad parameter is not known
parlist[['2002']]$grad = 4
try(gr_check_params(parlist, spas))

# remove wrong parameter
parlist[['2002']]$grad = NULL

# remove year
parlist[['2002']] = NULL
try(gr_check_params(parlist, spas))

parlist[['2002']] = parlist[['2001']]
gr_check_params(parlist, spas)

</code></pre>

<hr>
<h2 id='gr_fill_gaps'>Fill missing daily data</h2><span id='topic+gr_fill_gaps'></span>

<h3>Description</h3>

<p>Use the function to fill the missing daily data by linear interpolation. These can be both missing dates and missing runoff or temperature values. A preliminary summary of missing data can be viewed by <code><a href="#topic+gr_get_gaps">gr_get_gaps()</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gr_fill_gaps(hdata, autocorr = 0.7, nobserv = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gr_fill_gaps_+3A_hdata">hdata</code></td>
<td>
<p><code>data.frame</code> with at least two columns, where the first column is <code>Date</code>, and the remaining columns have numeric type.</p>
</td></tr>
<tr><td><code id="gr_fill_gaps_+3A_autocorr">autocorr</code></td>
<td>
<p>Autocorrelation value that defines possible length of the period that can be filled. Defaults to 0.7.  If <code>nobserv</code> parameter is set, then this parameter is ignored. If both parameters are <code>NULL</code>, then all gaps are filled disregard of their lengths (not recommended).</p>
</td></tr>
<tr><td><code id="gr_fill_gaps_+3A_nobserv">nobserv</code></td>
<td>
<p>Maximum number of contiguous observations that can be interpolated. Defaults to <code>NULL</code>. If this parameter is set, then <code>autocorr</code> parameter is ignored. If both parameters are <code>NULL</code>, then all gaps are filled disregard of their lengths (not recommended).</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>data.frame</code> which is a filled version of <code>hdata</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(grwat)
library(dplyr)

# example Spas-Zagorye data is included with grwat package
path = system.file("extdata", "spas-zagorye.txt", 
                   package = "grwat")

hdata_raw = read.delim(path, header = FALSE, 
                       sep = ' ', na.strings = c('-999', '-999.0', '-'),
                       col.names = c('d', 'm', 'y', 'q'))

hdata = hdata_raw %&gt;% 
  transmute(Date = lubridate::make_date(y, m, d), 
            Q = q)

head(hdata)

# identify gaps
gr_get_gaps(hdata) 

# fill gaps
fhdata = gr_fill_gaps(hdata, autocorr = 0.8)

# check the results
gr_get_gaps(fhdata)

# fill gaps
fhdata = gr_fill_gaps(hdata, nobserv = 7)

# check the results
gr_get_gaps(fhdata)
</code></pre>

<hr>
<h2 id='gr_get_gaps'>Get gaps in the daily data</h2><span id='topic+gr_get_gaps'></span>

<h3>Description</h3>

<p>Use the function to detect periods of missing data. The first column must be of <code>Date</code> type. The data is considered to be a gap if any value in the row is missing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gr_get_gaps(hdata)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gr_get_gaps_+3A_hdata">hdata</code></td>
<td>
<p><code>data.frame</code> with at least two columns, where the first column is <code>Date</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>data.frame</code> with periods of data and periods of gaps, containing five columns: number of the period (num), start of the period (start_date), end of the period (end_date), duration of the period (duration) and type of the period (type).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(grwat)
library(dplyr)

# example Spas-Zagorye data is included with grwat package
path = system.file("extdata", "spas-zagorye.txt", 
                   package = "grwat")

hdata_raw = read.delim(path, header = FALSE, 
                       sep = ' ', na.strings = c('-999', '-999.0', '-'),
                       col.names = c('d', 'm', 'y', 'q'))

hdata = hdata_raw %&gt;% 
  transmute(Date = lubridate::make_date(y, m, d), 
            Q = q)

head(hdata)

# identify gaps
gr_get_gaps(hdata) 

# fill gaps
fhdata = gr_fill_gaps(hdata, autocorr = 0.8)

# check the results
gr_get_gaps(fhdata)

# fill gaps
fhdata = gr_fill_gaps(hdata, nobserv = 7)

# check the results
gr_get_gaps(fhdata)
</code></pre>

<hr>
<h2 id='gr_get_params'>Get hydrograph separation parameters</h2><span id='topic+gr_get_params'></span>

<h3>Description</h3>

<p>The function returns the list of parameters that can be used by <code><a href="#topic+gr_separate">gr_separate()</a></code>. Since the parameters are region-specific, the location must be selected. It can be identified by region name or geographic coordinates. If both are specified, then region have a higher priority
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gr_get_params(reg = "center", lon = NULL, lat = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gr_get_params_+3A_reg">reg</code></td>
<td>
<p>Character string â€” the name of the region. Defaults to <code>'center'</code>.</p>
</td></tr>
<tr><td><code id="gr_get_params_+3A_lon">lon</code></td>
<td>
<p>Numeric value of the longitude. Ignored if <code>reg</code> is specified.</p>
</td></tr>
<tr><td><code id="gr_get_params_+3A_lat">lat</code></td>
<td>
<p>Numeric value of the latitude. Ignored if <code>reg</code> is specified.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of separation parameters that can be used in <code><a href="#topic+gr_separate">gr_separate()</a></code>  function.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(grwat)

params = gr_get_params(reg = 'center')

print(params)
</code></pre>

<hr>
<h2 id='gr_help_params'>Get the information about parameters used to separate the hydrograph</h2><span id='topic+gr_help_params'></span>

<h3>Description</h3>

<p>Get the information about parameters used to separate the hydrograph
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gr_help_params()
</code></pre>


<h3>Value</h3>

<p><code>data.frame</code> with description of hydrograph separation parameters that are used in <code><a href="#topic+gr_separate">gr_separate()</a></code> .
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(grwat)

gr_help_params()
</code></pre>

<hr>
<h2 id='gr_help_vars'>Hydrograph separation variables</h2><span id='topic+gr_help_vars'></span>

<h3>Description</h3>

<p>Use this function to learn the meaning of the variables that are calculated by <code><a href="#topic+gr_summarize">gr_summarize()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gr_help_vars()
</code></pre>


<h3>Value</h3>

<p><code>data.frame</code> of hydrograph separation variables
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(grwat)

gr_help_vars()
</code></pre>

<hr>
<h2 id='gr_join_rean'>Join reanalysis data</h2><span id='topic+gr_join_rean'></span>

<h3>Description</h3>

<p>The function performs spatial join of meteorological variables (temperature and precipitation) from <a href="https://www.dropbox.com/sh/5xjnf620tlwfk7a/AABhTaPEDWLII8rV04dp0MWna?dl=0">grwat reanalysis</a> to the daily runoff time series. Reanalysis covers the East European Plain with 0.75 degrees spatial resolution and is obtained based on CIRES-DOE (1880-1949) and ERA5 (1950-2021) data. This function is useful when the data from meteorological stations are missing inside the basin.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gr_join_rean(hdata, rean, buffer)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gr_join_rean_+3A_hdata">hdata</code></td>
<td>
<p><code>data.frame</code> containing 2 columns: <code>Date</code> and runoff</p>
</td></tr>
<tr><td><code id="gr_join_rean_+3A_rean">rean</code></td>
<td>
<p><code>list</code> as returned by <code><a href="#topic+gr_read_rean">gr_read_rean()</a></code></p>
</td></tr>
<tr><td><code id="gr_join_rean_+3A_buffer">buffer</code></td>
<td>
<p><code>sf</code> object containing the region to select reanalysis data. Usually a river basin is used to select the meteorological data. Use <code><a href="#topic+gr_buffer_geo">gr_buffer_geo()</a></code> to buffer the basin by specified distance and get more data, if needed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Download the reanalysis archive from <a href="https://www.dropbox.com/sh/5xjnf620tlwfk7a/AABhTaPEDWLII8rV04dp0MWna?dl=0">here</a>.
</p>


<h3>Value</h3>

<p><code>data.frame</code> with four columns: date, runoff, temperature, precipitation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (require("sf") &amp;&amp; require("ncdf4")) {

  library(grwat)
  library(dplyr)

  # example Spas-Zagorye daily runoff data is included with grwat package
  data_path = system.file("extdata", "spas-zagorye.txt",
                          package = "grwat")

  hdata_raw = read.delim(data_path, header = FALSE, 
                         sep = ' ', na.strings = c('-999', '-999.0', '-'),
                         col.names = c('d', 'm', 'y', 'q'))

  hdata = hdata_raw %&gt;%
    transmute(Date = lubridate::make_date(y, m, d),
              Q = q)

  head(hdata)

  # read basin
  basin_path = system.file("extdata", "spas-zagorye.gpkg",
                           package = "grwat")
  basin = sf::st_read(basin_path, layer = 'basin') # read basin region
  basin_buffer = gr_buffer_geo(basin, 25000)

  ## Not run: 
    # read reanalysis data
    rean = gr_read_rean(
      '/Volumes/Data/Spatial/Reanalysis/grwat/pre_1880-2021.nc',
      '/Volumes/Data/Spatial/Reanalysis/grwat/temp_1880-2021.nc'
    )

    # spatial join of reanalysis data to runoff data
    hdata_rean = gr_join_rean(hdata, rean, basin_buffer)

    head(hdata_rean)
  
## End(Not run)

}
</code></pre>

<hr>
<h2 id='gr_kable_tests'>Tabular representation of tests</h2><span id='topic+gr_kable_tests'></span>

<h3>Description</h3>

<p>This function is used to represent the results of <code><a href="#topic+gr_test_vars">gr_test_vars()</a></code> in a tabular form. Used mainly in <code><a href="#topic+gr_report">gr_report()</a></code>, but can be used for your own purposes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gr_kable_tests(tests, format = "html")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gr_kable_tests_+3A_tests">tests</code></td>
<td>
<p><code>list</code> of tests as returned by <code><a href="#topic+gr_test_vars">gr_test_vars()</a></code> function.</p>
</td></tr>
<tr><td><code id="gr_kable_tests_+3A_format">format</code></td>
<td>
<p>Character string encoding the type of output. Currently <code>'html'</code> only is supported.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>HTML table as returned by <code><a href="knitr.html#topic+kable">knitr::kable()</a></code> function.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (require("kableExtra")) {
  
  library(grwat)
  
  data(spas) # example Spas-Zagorye data is included with grwat package
  
  # separate
  sep = gr_separate(spas, params = gr_get_params(reg = 'center'))
  
  # summarize from 1965 to 1990
  vars = gr_summarize(sep, 1965, 1990)
  
  # test all variables
  tests = gr_test_vars(vars)
  
  # kable tests
  gr_kable_tests(tests)

}
</code></pre>

<hr>
<h2 id='gr_plot_acf'>Plot runoff ACF</h2><span id='topic+gr_plot_acf'></span>

<h3>Description</h3>

<p>The function plots the autocorrelation function (ACF) for daily runoff time series. A number of days corresponding to the specified <code>autocorr</code> value is highlighted.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gr_plot_acf(hdata, autocorr = 0.7, maxlag = 30, print = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gr_plot_acf_+3A_hdata">hdata</code></td>
<td>
<p><code>data.frame</code> with first column as <code>Date</code> and the second column as runoff</p>
</td></tr>
<tr><td><code id="gr_plot_acf_+3A_autocorr">autocorr</code></td>
<td>
<p>Numeric value of the autocorrelation for which the time period will be highlighted. Defaults to <code>0.7</code>.</p>
</td></tr>
<tr><td><code id="gr_plot_acf_+3A_maxlag">maxlag</code></td>
<td>
<p>Integer value of the maximum daily lag used to calculate the correlation. Defaults to <code>30</code>.</p>
</td></tr>
<tr><td><code id="gr_plot_acf_+3A_print">print</code></td>
<td>
<p>Boolean. Print plot? Defaults to <code>TRUE</code>. Use <code>FALSE</code> if you want to tweak the plot aesthetics before plotting.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>ggplot2</code> object representing the autocorrelation function (ACF) for daily runoff time series
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(grwat)

# example Spas-Zagorye data is included with grwat package
data(spas)
head(spas)

# plot ACF
gr_plot_acf(spas, 0.65)
</code></pre>

<hr>
<h2 id='gr_plot_hori'>Horizon hydrograph plot</h2><span id='topic+gr_plot_hori'></span>

<h3>Description</h3>

<p>A convenient wrapper around <code><a href="ggHoriPlot.html#topic+geom_horizon">ggHoriPlot::geom_horizon()</a></code> to visualize multiple river hydrographs at once.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gr_plot_hori(df, years, pal = "Blues", rev = TRUE, scale = 6, print = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gr_plot_hori_+3A_df">df</code></td>
<td>
<p><code>data.frame</code> with date (1st) and runoff (2nd) columns.</p>
</td></tr>
<tr><td><code id="gr_plot_hori_+3A_years">years</code></td>
<td>
<p>Integer vector of years to be plotted.</p>
</td></tr>
<tr><td><code id="gr_plot_hori_+3A_pal">pal</code></td>
<td>
<p>Numeric or character string. Color palette identifier passed to <code><a href="ggplot2.html#topic+scale_brewer">ggplot2::scale_fill_distiller()</a></code>.</p>
</td></tr>
<tr><td><code id="gr_plot_hori_+3A_rev">rev</code></td>
<td>
<p>Boolean. Reverse the palette? Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="gr_plot_hori_+3A_scale">scale</code></td>
<td>
<p>Numeric scale factor passed to <code><a href="ggHoriPlot.html#topic+geom_horizon">ggHoriPlot::geom_horizon()</a></code>. Defaults to <code>6</code>.</p>
</td></tr>
<tr><td><code id="gr_plot_hori_+3A_print">print</code></td>
<td>
<p>Boolean. Print plot? Defaults to <code>TRUE</code>. Use <code>FALSE</code> if you want to tweak the plot aesthetics before plotting.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>ggplot2</code> object representing multiple river hydrographs at once using the horizon plot approach
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (require("ggHoriPlot") &amp;&amp; require("ggthemes")) {
  
  library(grwat)
  
  data(spas) # example Spas-Zagorye data is included with grwat package
  
  # separate
  sep = gr_separate(spas, params = gr_get_params(reg = 'center'))
  
  # horizon plot for selected years
  gr_plot_hori(sep, years = 1960:1980)
  
}
</code></pre>

<hr>
<h2 id='gr_plot_matrix'>Runoff matrix plot</h2><span id='topic+gr_plot_matrix'></span>

<h3>Description</h3>

<p>The function plots runoff values, components and seasons using the matrix-based approach. The X axis corresponds to the day of the year, and the Y axis corresponds to the year. The function is useful when the whole picture of river runoff needs to be assessed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gr_plot_matrix(df, years = NULL, type = "runoff", print = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gr_plot_matrix_+3A_df">df</code></td>
<td>
<p><code>data.frame</code> of hydrograph separation produced by <code><a href="#topic+gr_separate">gr_separate()</a></code>.</p>
</td></tr>
<tr><td><code id="gr_plot_matrix_+3A_years">years</code></td>
<td>
<p>Integer vector of years to be plotted. Defaults to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gr_plot_matrix_+3A_type">type</code></td>
<td>
<p>Character string. Supported options are <code>'runoff'</code>, <code>'component'</code>, and <code>'season'</code>. Defaults to <code>'runoff'</code>.</p>
</td></tr>
<tr><td><code id="gr_plot_matrix_+3A_print">print</code></td>
<td>
<p>Boolean. Print plot? Defaults to <code>TRUE</code>. Use <code>FALSE</code> if you want to tweak the plot aesthetics before plotting.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>ggplot2</code> object representing the runoff values, components or seasons using the matrix-based approach
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(grwat)

data(spas) # example Spas-Zagorye data is included with grwat package

# separate
sep = gr_separate(spas, params = gr_get_params(reg = 'center'))

# matrix plot for runoff
gr_plot_matrix(sep, type = 'runoff')

# matrix plot for seasons
gr_plot_matrix(sep, type = 'season')

# matrix plot for genetic components
gr_plot_matrix(sep, type = 'component')
</code></pre>

<hr>
<h2 id='gr_plot_minmonth'>Plot minimum runoff month</h2><span id='topic+gr_plot_minmonth'></span>

<h3>Description</h3>

<p>Generate a histogram of a minimum runoff month for two periods: before and after the change year set by <code>year</code> parameter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gr_plot_minmonth(
  df,
  year = NULL,
  exclude = NULL,
  tests = NULL,
  pagebreak = FALSE,
  print = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gr_plot_minmonth_+3A_df">df</code></td>
<td>
<p><code>data.frame</code> of hydrograph and meteorological variables as produced by <code><a href="#topic+gr_summarize">gr_summarize()</a></code>.</p>
</td></tr>
<tr><td><code id="gr_plot_minmonth_+3A_year">year</code></td>
<td>
<p>Integer. Change year value to separate two periods.</p>
</td></tr>
<tr><td><code id="gr_plot_minmonth_+3A_exclude">exclude</code></td>
<td>
<p>Integer vector of years to be excluded from plotting.</p>
</td></tr>
<tr><td><code id="gr_plot_minmonth_+3A_tests">tests</code></td>
<td>
<p>Tests list for the same variables (generated by <code><a href="#topic+gr_test_vars">gr_test_vars()</a></code> function)</p>
</td></tr>
<tr><td><code id="gr_plot_minmonth_+3A_pagebreak">pagebreak</code></td>
<td>
<p>Logical. Whether to break page between plots (needed for reporting). Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="gr_plot_minmonth_+3A_print">print</code></td>
<td>
<p>Boolean. Print plot? Defaults to <code>TRUE</code>. Use <code>FALSE</code> if you want to tweak the plot aesthetics before plotting.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>list</code> of two <code>ggplot2</code> objects, representing the histogram of a minimum runoff month for two periods: before and after the change year
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(grwat)

data(spas) # example Spas-Zagorye data is included with grwat package

# separate
sep = gr_separate(spas, params = gr_get_params(reg = 'center'))

# summarize from 1965 to 1990
vars = gr_summarize(sep, 1965, 1990)

# plot minimum runoff month for two periods divided by Pettitt test
gr_plot_minmonth(vars, tests = gr_test_vars(vars))

# plot minimum runoff month for two periods divided by fixed year
gr_plot_minmonth(vars, year = 1978)
</code></pre>

<hr>
<h2 id='gr_plot_periods'>Plot long-term hydrograph variable changes</h2><span id='topic+gr_plot_periods'></span>

<h3>Description</h3>

<p>This function generates boxplots of the hydrograph separation variables produced by <code><a href="#topic+gr_summarize">gr_summarize()</a></code>. The data for each variable is divided into two samples: before and after the change year either set by <code>year</code> parameter or extracted from <code>tests</code> (statistically estimated). Different background fill colors are used to differentiate seasons types.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gr_plot_periods(
  df,
  ...,
  year = NULL,
  exclude = NULL,
  tests = NULL,
  layout = as.matrix(1),
  pagebreak = FALSE,
  print = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gr_plot_periods_+3A_df">df</code></td>
<td>
<p><code>data.frame</code> of hydrograph and meteorological variables produced by <code><a href="#topic+gr_summarize">gr_summarize()</a></code>.</p>
</td></tr>
<tr><td><code id="gr_plot_periods_+3A_...">...</code></td>
<td>
<p>Quoted sequence of variable names.</p>
</td></tr>
<tr><td><code id="gr_plot_periods_+3A_year">year</code></td>
<td>
<p>Integer. Change year value to separate two periods (overridden by tests if it is supplied).</p>
</td></tr>
<tr><td><code id="gr_plot_periods_+3A_exclude">exclude</code></td>
<td>
<p>Integer vector of years to be excluded from plotting.</p>
</td></tr>
<tr><td><code id="gr_plot_periods_+3A_tests">tests</code></td>
<td>
<p>Tests list for the same variables (generated by <code><a href="#topic+gr_test_vars">gr_test_vars()</a></code> function)</p>
</td></tr>
<tr><td><code id="gr_plot_periods_+3A_layout">layout</code></td>
<td>
<p><code>matrix</code> that encodes the order of plotting.</p>
</td></tr>
<tr><td><code id="gr_plot_periods_+3A_pagebreak">pagebreak</code></td>
<td>
<p>Logical. Whether to break page between plots (needed for reporting). Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="gr_plot_periods_+3A_print">print</code></td>
<td>
<p>Boolean. Print plot? Defaults to <code>TRUE</code>. Use <code>FALSE</code> if you want to tweak the plot aesthetics before plotting.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>list</code> of <code>ggplot2</code>  objects, one for each variable, representing its long-term changes
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(grwat)

data(spas) # example Spas-Zagorye data is included with grwat package

# separate
sep = gr_separate(spas, params = gr_get_params(reg = 'center'))

# summarize from 1965 to 1990
vars = gr_summarize(sep, 1965, 1990)

# plot periods with fixed change year
gr_plot_periods(vars, Qygr, year = 1978)

# plot periods with change year from Pettitt test
gr_plot_periods(vars, Qygr, tests = TRUE)

# calculate test beforehand
tests = gr_test_vars(vars)
gr_plot_periods(vars, Qspmax, tests = tests)

# use matrix layout to plot multiple variables
gr_plot_periods(vars, Qygr, Qspmax, D10w1, Wsprngr,
                layout = matrix(1:4, nrow = 2),
                tests = tests)
</code></pre>

<hr>
<h2 id='gr_plot_ridge'>Ridgeline hydrograph plot</h2><span id='topic+gr_plot_ridge'></span>

<h3>Description</h3>

<p>A convenient wrapper around <code><a href="ggridges.html#topic+geom_ridgeline">ggridges::geom_ridgeline()</a></code> to visualize multiple river hydrographs at once.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gr_plot_ridge(
  df,
  years,
  pal = 4,
  rev = FALSE,
  scale = 0.01,
  alpha = 0.8,
  print = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gr_plot_ridge_+3A_df">df</code></td>
<td>
<p><code>data.frame</code> with date (1st) and runoff (2nd) columns.</p>
</td></tr>
<tr><td><code id="gr_plot_ridge_+3A_years">years</code></td>
<td>
<p>Integer vector of years to be plotted.</p>
</td></tr>
<tr><td><code id="gr_plot_ridge_+3A_pal">pal</code></td>
<td>
<p>Numeric or character string. Color palette identifier passed to <code><a href="ggplot2.html#topic+scale_brewer">ggplot2::scale_fill_distiller()</a></code>.</p>
</td></tr>
<tr><td><code id="gr_plot_ridge_+3A_rev">rev</code></td>
<td>
<p>Boolean. Reverse the palette? Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="gr_plot_ridge_+3A_scale">scale</code></td>
<td>
<p>Numeric scale factor passed to <code><a href="ggridges.html#topic+geom_ridgeline">ggridges::geom_ridgeline()</a></code>. Defaults to <code>0.01</code>.</p>
</td></tr>
<tr><td><code id="gr_plot_ridge_+3A_alpha">alpha</code></td>
<td>
<p>Numeric opacity value of the ridgeline plot. Defaults to <code>0.8</code>.</p>
</td></tr>
<tr><td><code id="gr_plot_ridge_+3A_print">print</code></td>
<td>
<p>Boolean. Print plot? Defaults to <code>TRUE</code>. Use <code>FALSE</code> if you want to tweak the plot aesthetics before plotting.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>ggplot2</code> object representing the multiple river hydrographs at once using the ridgeline plot approach
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (require("ggridges")) {
  
  library(grwat)
  
  data(spas) # example Spas-Zagorye data is included with grwat package
  
  # separate
  sep = gr_separate(spas, params = gr_get_params(reg = 'center'))
  
  # ridgline plot for selected years
  gr_plot_ridge(sep, years = c(1960, 1965, 1989, 2001, 2012)) 

}
</code></pre>

<hr>
<h2 id='gr_plot_sep'>Plot hydrograph separation</h2><span id='topic+gr_plot_sep'></span>

<h3>Description</h3>

<p>The function plots river hydrograph by filling the different flow types using colors. Matrix layouts can be used if multiple plots are needed. Temperature and precipitation can be overlaid.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gr_plot_sep(
  df,
  years = NULL,
  layout = as.matrix(1),
  pagebreak = FALSE,
  temp = FALSE,
  prec = FALSE,
  span = 5,
  print = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gr_plot_sep_+3A_df">df</code></td>
<td>
<p><code>data.frame</code> of hydrograph separation as produced by <code><a href="#topic+gr_separate">gr_separate()</a></code>.</p>
</td></tr>
<tr><td><code id="gr_plot_sep_+3A_years">years</code></td>
<td>
<p>Integer vector of years to be plotted.</p>
</td></tr>
<tr><td><code id="gr_plot_sep_+3A_layout">layout</code></td>
<td>
<p><code>matrix</code> that encodes the order of plotting.</p>
</td></tr>
<tr><td><code id="gr_plot_sep_+3A_pagebreak">pagebreak</code></td>
<td>
<p>Logical. Whether to break page between plots (used by <code><a href="#topic+gr_report">gr_report()</a></code>). Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="gr_plot_sep_+3A_temp">temp</code></td>
<td>
<p>Boolean. Add temperature curve to the plot? Defaults to <code>FALSE</code>. If both <code>temp = TRUE</code> and <code>prec = TRUE</code>, then the axis is drawn for precipitation.</p>
</td></tr>
<tr><td><code id="gr_plot_sep_+3A_prec">prec</code></td>
<td>
<p>Boolean. Add precipitation curve to the plot? Defaults to <code>FALSE</code>. If both <code>temp = TRUE</code> and <code>prec = TRUE</code>, then the axis is drawn for precipitation.</p>
</td></tr>
<tr><td><code id="gr_plot_sep_+3A_span">span</code></td>
<td>
<p>Integer number of days to accumulate precipitation for plotting.</p>
</td></tr>
<tr><td><code id="gr_plot_sep_+3A_print">print</code></td>
<td>
<p>Boolean. Print plot? Defaults to <code>TRUE</code>. Use <code>FALSE</code> if you want to tweak the plot aesthetics before plotting.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>list</code> of <code>ggplot2</code> objects, one for each year, representing the hydrograph separation
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(grwat)

data(spas) # example Spas-Zagorye data is included with grwat package

# separate
sep = gr_separate(spas, params = gr_get_params(reg = 'center'))

# One year
gr_plot_sep(sep, 1978) 

# Two years
gr_plot_sep(sep, c(1978, 1989)) 

# Two years in a matrix layout
gr_plot_sep(sep, 1988:1989, layout = matrix(1:2, nrow = 2, byrow = TRUE)) 

# Add temperature and precipitation
gr_plot_sep(sep, 1991, temp = TRUE, prec = TRUE) 
</code></pre>

<hr>
<h2 id='gr_plot_tests'>Plot change year density</h2><span id='topic+gr_plot_tests'></span>

<h3>Description</h3>

<p>The function extracts change years from results of <code><a href="#topic+gr_test_vars">gr_test_vars()</a></code> and plots their probability density. Since for every variable the change year is individual, this procedure allows finding the one most probable year, which is the mode of the distribution. This year is highlighted by the line and labeled on the plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gr_plot_tests(tests, type = "year", print = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gr_plot_tests_+3A_tests">tests</code></td>
<td>
<p><code>list</code> of tests generated by <code><a href="#topic+gr_test_vars">gr_test_vars()</a></code>.</p>
</td></tr>
<tr><td><code id="gr_plot_tests_+3A_type">type</code></td>
<td>
<p>Character string type of the plot. Currently only <code>'year'</code> is supported, which means that the distribution density of the change year detected by Pettitt test is visualized. Ignored until other types are implemented.</p>
</td></tr>
<tr><td><code id="gr_plot_tests_+3A_print">print</code></td>
<td>
<p>Boolean. Print plot? Defaults to <code>TRUE</code>. Use <code>FALSE</code> if you want to tweak the plot aesthetics before plotting.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>ggplot2</code> object representing the selected type of the tested variable
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(grwat)

data(spas) # example Spas-Zagorye data is included with grwat package

# separate
sep = gr_separate(spas, params = gr_get_params(reg = 'center'))

# summarize from 1965 to 1990
vars = gr_summarize(sep, 1965, 1990)

# test all variables
tests = gr_test_vars(vars)

# plot change year from Pettitt test
gr_plot_tests(tests, type = 'year')
</code></pre>

<hr>
<h2 id='gr_plot_vars'>Plot interannual hydrograph variable changes</h2><span id='topic+gr_plot_vars'></span>

<h3>Description</h3>

<p>This function plots the hydrograph separation variables produced by <code><a href="#topic+gr_summarize">gr_summarize()</a></code>. Different background fill colors and line types are used to differentiate seasons and variable types.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gr_plot_vars(
  df,
  ...,
  tests = NULL,
  exclude = NULL,
  smooth = TRUE,
  layout = as.matrix(1),
  pagebreak = FALSE,
  print = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gr_plot_vars_+3A_df">df</code></td>
<td>
<p><code>data.frame</code> of hydrograph and meteorological variables produced by <code><a href="#topic+gr_summarize">gr_summarize()</a></code>.</p>
</td></tr>
<tr><td><code id="gr_plot_vars_+3A_...">...</code></td>
<td>
<p>Quoted sequence of variable names.</p>
</td></tr>
<tr><td><code id="gr_plot_vars_+3A_tests">tests</code></td>
<td>
<p><code>list</code> of tests for the same variables (generated by <code><a href="#topic+gr_test_vars">gr_test_vars()</a></code> function). If tests are specified, then they are added to the plot.</p>
</td></tr>
<tr><td><code id="gr_plot_vars_+3A_exclude">exclude</code></td>
<td>
<p>Integer vector of years to be excluded from plotting.</p>
</td></tr>
<tr><td><code id="gr_plot_vars_+3A_smooth">smooth</code></td>
<td>
<p>Logical. If <code>TRUE</code> then local smoothing regression is plotted. Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="gr_plot_vars_+3A_layout">layout</code></td>
<td>
<p><code>matrix</code> that encodes the order of plotting.</p>
</td></tr>
<tr><td><code id="gr_plot_vars_+3A_pagebreak">pagebreak</code></td>
<td>
<p>Logical. Whether to break page between plots (<code><a href="#topic+gr_report">gr_report()</a></code>). Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="gr_plot_vars_+3A_print">print</code></td>
<td>
<p>Boolean. Print plot? Defaults to <code>TRUE</code>. Use <code>FALSE</code> if you want to tweak the plot aesthetics before plotting.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>list</code> of <code>ggplot2</code> objects, one for each variable, representing its interannual changes
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(grwat)

data(spas) # example Spas-Zagorye data is included with grwat package

# separate
sep = gr_separate(spas, params = gr_get_params(reg = 'center'))

# summarize from 1965 to 1990
vars = gr_summarize(sep, 1965, 1990)

# plot one selected variable
gr_plot_vars(vars, Qygr) 

# plot two variables sequentially
gr_plot_vars(vars, D10w1, Wsprngr)

# four variables in matrix layout with tests calculated on the fly
gr_plot_vars(vars, Qspmax, Qygr, D10w1, Wsprngr,
             layout = matrix(1:4, nrow = 2, byrow = TRUE),
             tests = TRUE) 
</code></pre>

<hr>
<h2 id='gr_read_rean'>Read reanalysis data</h2><span id='topic+gr_read_rean'></span>

<h3>Description</h3>

<p>The function reads meteorological variables (temperature and precipitation) from <a href="https://www.dropbox.com/sh/5xjnf620tlwfk7a/AABhTaPEDWLII8rV04dp0MWna?dl=0">grwat reanalysis</a> for using with <code><a href="#topic+gr_join_rean">gr_join_rean()</a></code>. Reanalysis covers the East European Plain with 0.75 degrees spatial resolution and is obtained based on CIRES-DOE (1880-1949) and ERA5 (1950-2021) data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gr_read_rean(file_prec, file_temp)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gr_read_rean_+3A_file_prec">file_prec</code></td>
<td>
<p>Character string path to precipitation NetCDF file.</p>
</td></tr>
<tr><td><code id="gr_read_rean_+3A_file_temp">file_temp</code></td>
<td>
<p>Character string path to temperature NetCDF file.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Download the reanalysis archive from <a href="https://www.dropbox.com/sh/5xjnf620tlwfk7a/AABhTaPEDWLII8rV04dp0MWna?dl=0">here</a>.
</p>


<h3>Value</h3>

<p><code>list</code> containing time series, precipitation series, temperature series
and spatial points (sf)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (require("sf") &amp;&amp; require("ncdf4")) {
  
  library(grwat)
  
  # read reanalysis data
  ## Not run: 
    rean = gr_read_rean(
      '/Volumes/Data/Spatial/Reanalysis/grwat/pre_1880-2021.nc',
      '/Volumes/Data/Spatial/Reanalysis/grwat/temp_1880-2021.nc'
    ) 
    
    str(rean)
  
## End(Not run)
  
}
</code></pre>

<hr>
<h2 id='gr_report'>Report hydrograph separation and variables</h2><span id='topic+gr_report'></span>

<h3>Description</h3>

<p>This function generates a graphical HTML report that summarizes separation of hydrograph, its variables and their statistical properties. See example <a href="https://www.dropbox.com/s/747xyqp65ipriy5/Spas-Zagorye.html">report</a> generated by this command for <code>spas</code> dataset included in grwat package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gr_report(
  sep,
  vars,
  output = "Report.html",
  year = NULL,
  exclude = NULL,
  temp = FALSE,
  prec = FALSE,
  span = 5,
  locale = "EN"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gr_report_+3A_sep">sep</code></td>
<td>
<p><code>data.frame</code> of hydrograph separation as returned by <code><a href="#topic+gr_separate">gr_separate()</a></code> function.</p>
</td></tr>
<tr><td><code id="gr_report_+3A_vars">vars</code></td>
<td>
<p><code>data.frame</code> of hydrograph variables as returned by <code><a href="#topic+gr_summarize">gr_summarize()</a></code> function.</p>
</td></tr>
<tr><td><code id="gr_report_+3A_output">output</code></td>
<td>
<p>Character string path to the output file. Must have <code>.html</code> extension.</p>
</td></tr>
<tr><td><code id="gr_report_+3A_year">year</code></td>
<td>
<p>Integer value of year used to divide series in two samples compared by Student and Fisher tests. Defaults to <code>NULL</code> which means that the year is calculated automatically by Pettitt test. Defaults to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gr_report_+3A_exclude">exclude</code></td>
<td>
<p>Integer vector of years to be excluded from reporting. Defaults to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gr_report_+3A_temp">temp</code></td>
<td>
<p>Boolean. Plot temperature on the top of hydrograph? Defaults to <code>FALSE</code>. If both <code>temp = TRUE</code> and <code>prec = TRUE</code>, then the axis is drawn for precipitation.</p>
</td></tr>
<tr><td><code id="gr_report_+3A_prec">prec</code></td>
<td>
<p>Boolean. Plot precipitation on the top of hydrograph? Defaults to <code>FALSE</code>. If both <code>temp = TRUE</code> and <code>prec = TRUE</code>, then the axis is drawn for precipitation.</p>
</td></tr>
<tr><td><code id="gr_report_+3A_span">span</code></td>
<td>
<p>Integer number of days to accumulate precipitation for plotting. Defaults to <code>5</code>.</p>
</td></tr>
<tr><td><code id="gr_report_+3A_locale">locale</code></td>
<td>
<p>Character string locale. Currently only English (<code>'EN'</code>) and Russian (<code>'RU'</code>) locales are supported. Defaults to <code>'EN'</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for side effects
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  if (require("knitr") &amp;&amp; require("rmarkdown") &amp;&amp; require("kableExtra")) {
    library(grwat)
    
    data(spas) # example Spas-Zagorye data is included with grwat package
    
    # separate
    sep = gr_separate(spas, params = gr_get_params(reg = 'center'))
    
    # summarize
    vars = gr_summarize(sep)
    
    # report
    report = '~/Spas-Zagorye.html'
    
    gr_report(sep, vars, output = report)
    browseURL(report)
  }

## End(Not run)
</code></pre>

<hr>
<h2 id='gr_separate'>Advanced hydrograph separation</h2><span id='topic+gr_separate'></span>

<h3>Description</h3>

<p>Separates the runoff into genetic components: groundwater, thaw, rain and spring.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gr_separate(df, params = gr_get_params(), debug = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gr_separate_+3A_df">df</code></td>
<td>
<p><code>data.frame</code> with four columns: date, runoff, temperature, precipitation.</p>
</td></tr>
<tr><td><code id="gr_separate_+3A_params">params</code></td>
<td>
<p><code>list</code> of separation parameters, as returned by <code><a href="#topic+gr_get_params">gr_get_params()</a></code> function. Can also be a <code>list</code> of such <code>list</code>s if modified parameters are required for some years. In this case the length of <code>params</code> must be equal to the number of calendar years in <code>df</code> or be equal to <code>1</code>.</p>
</td></tr>
<tr><td><code id="gr_separate_+3A_debug">debug</code></td>
<td>
<p>Boolean. If <code>TRUE</code> then additional attributes <code>jittered</code> and <code>params</code> are written to the output <code>data.frame</code>. <code>jittered</code> is an integer vector of years for which the separation parameters were randomly jittered. <code>params</code> is a list of separation parameter lists used for each year (some o those may have been jittered). Defaults to <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.frame</code> with 11 columns:</p>

<table>
<tr>
 <td style="text-align: left;">
   <strong>Column</strong> </td><td style="text-align: left;"> <strong>Description</strong> </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>Date</code> </td><td style="text-align: left;"> date </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>Q</code> </td><td style="text-align: left;"> total runoff </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>Temp</code> </td><td style="text-align: left;"> temperature </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>Prec</code> </td><td style="text-align: left;"> precipitation </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>Qbase</code> </td><td style="text-align: left;"> baseflow </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>Quick</code> </td><td style="text-align: left;"> quickflow </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>Qspri</code> </td><td style="text-align: left;"> spring flood </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>Qrain</code> </td><td style="text-align: left;"> rain floods </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>Qthaw</code> </td><td style="text-align: left;"> thaw floods </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>Season</code> </td><td style="text-align: left;"> a season of the year </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>Year</code> </td><td style="text-align: left;"> a water-resources year </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Examples</h3>

<pre><code class='language-R'>library(grwat)

data(spas) # example Spas-Zagorye data is included with grwat package
head(spas)

# separate
sep = gr_separate(spas, params = gr_get_params(reg = 'center'))

# Visualize
gr_plot_sep(sep, c(1978, 1989)) 

# Debug mode gives access to additional information
sep_debug = gr_separate(spas, 
                        params = gr_get_params(reg = 'center'), 
                        debug = TRUE)

# a vector of years with jittered params
jit = attributes(sep_debug)$jittered
print(jit)

# actual params used for each year
parlist = attributes(sep_debug)$params
partab = do.call(dplyr::bind_rows, parlist) # View as table
head(partab)

# extract and tweak parameters for selected year
p = parlist[['1989']]
p$grad1 = 1
p$grad2 = 2.5

# use tweaked parameters for all years
sep_debug = gr_separate(spas, params = p, debug = TRUE)

# Visualize
gr_plot_sep(sep_debug, c(1978, 1989)) 

# actual params used for each year
parlist = attributes(sep_debug)$params

# tweak parameters for selected year
parlist[['1989']]$grad1 = 3
parlist[['1989']]$grad2 = 6

# set the sprecdays parameter for multiple years
parlist = gr_set_param(parlist, sprecdays, 
                       years = c(1978, 1989:1995), 
                       value = 15)

# set the spcomp parameter for all years
parlist = gr_set_param(parlist, spcomp, value = 2.5)

# use the list of parameters for separation
sep_debug = gr_separate(spas, params = parlist, debug = TRUE)

# Visualize
gr_plot_sep(sep_debug, c(1978, 1989))



</code></pre>

<hr>
<h2 id='gr_set_locale'>Set the language that is used for plotting</h2><span id='topic+gr_set_locale'></span>

<h3>Description</h3>

<p>Run this function once at the beginning of the session. All plots will be labeled using the selected language.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gr_set_locale(locale = "EN")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gr_set_locale_+3A_locale">locale</code></td>
<td>
<p>Character string locale. Currently only English (<code>'EN'</code>), Russian (<code>'RU'</code>) and Ukrainian (<code>'UA'</code>) locales are supported. More locales can be requested at issue on GitHub. Defaults to <code>'EN'</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note to Linux users: the desired locale may not be installed on the system. A list of available locales can be obtained in bash terminal:
</p>
<p><code>locale -a</code>
</p>
<p>Russian locale is <code>ru_RU.UTF-8</code>, and Ukrainian locale is <code>uk_UA.UTF-8</code>. If absent in the list, then install the desired locales by:
</p>
<p><code style="white-space: pre;">&#8288;sudo locale-gen ru_RU.UTF-8&#8288;</code>
</p>
<p><code style="white-space: pre;">&#8288;sudo locale-gen uk_UA.UTF-8&#8288;</code>
</p>
<p><code style="white-space: pre;">&#8288;sudo update-locale&#8288;</code>
</p>
<p>Then restart R session, and localization should work as expected.
</p>


<h3>Value</h3>

<p>No return value, called for side effects
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(grwat)

data(spas) # example Spas-Zagorye data is included with grwat package

# separate
sep = gr_separate(spas, params = gr_get_params(reg = 'center'))

# Default is  English
gr_set_locale('EN')
gr_plot_sep(sep, 1978) 
</code></pre>

<hr>
<h2 id='gr_set_param'>Set the value of hydrograph separation parameter</h2><span id='topic+gr_set_param'></span>

<h3>Description</h3>

<p>The value is set for selected years in parameter list. Such list is returned by <code><a href="#topic+gr_separate">gr_separate()</a></code>  with <code>debug = TRUE</code> set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gr_set_param(params, p, value, years = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gr_set_param_+3A_params">params</code></td>
<td>
<p><code>list</code> of <code>list</code>s of hydrograph separation parameters as returned in <code>params</code> attribute by <code><a href="#topic+gr_separate">gr_separate()</a></code>  with <code>debug = TRUE</code>.</p>
</td></tr>
<tr><td><code id="gr_set_param_+3A_p">p</code></td>
<td>
<p>Name of the parameter.</p>
</td></tr>
<tr><td><code id="gr_set_param_+3A_value">value</code></td>
<td>
<p>Numeric value to set.</p>
</td></tr>
<tr><td><code id="gr_set_param_+3A_years">years</code></td>
<td>
<p>Integer vector of years to modify. Defaults to <code>NULL</code>, which means that all years will be modified.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>list</code> of <code>list</code>s â€” a modified version of <code>params</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(grwat)

data(spas) # example Spas-Zagorye data is included with grwat package

# Debug mode gives access to additional information
sep = gr_separate(spas, 
                  params = gr_get_params(reg = 'center'), 
                  debug = TRUE)

# Visualize
gr_plot_sep(sep, c(1978, 1989)) 

# actual params used for each year
parlist = attributes(sep)$params

# set the sprecdays parameter for multiple years
parlist = gr_set_param(parlist, sprecdays, 
                       years = c(1978, 1989:1995), 
                       value = 15)

# use the list of parameters for separation
sep_new = gr_separate(spas, params = parlist, debug = TRUE)

# Visualize
gr_plot_sep(sep_new, c(1978, 1989))
</code></pre>

<hr>
<h2 id='gr_summarize'>Summarize hydrograph separation</h2><span id='topic+gr_summarize'></span>

<h3>Description</h3>

<p>Use this function to get meaningful summary statistics for hydrograph separation. Resulting variables are described by <code><a href="#topic+gr_help_vars">gr_help_vars()</a></code>. This function is a convenient wrapper around <a href="https://dplyr.tidyverse.org">dplyr</a>'s <code>df %&gt;% group_by %&gt;% summarize</code> idiom.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gr_summarize(df, year_min = NULL, year_max = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gr_summarize_+3A_df">df</code></td>
<td>
<p><code>data.frame</code> of hydrograph separation resulting from <code><a href="#topic+gr_separate">gr_separate()</a></code> function</p>
</td></tr>
<tr><td><code id="gr_summarize_+3A_year_min">year_min</code></td>
<td>
<p><code>integer</code> first year to summarise</p>
</td></tr>
<tr><td><code id="gr_summarize_+3A_year_max">year_max</code></td>
<td>
<p><code>integer</code> last year to summarise</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>data.frame</code> with one row for each water-resources year and multiple columns of statistics explained by <code><a href="#topic+gr_help_vars">gr_help_vars()</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(grwat)

data(spas) # example Spas-Zagorye data is included with grwat package

# separate
sep = gr_separate(spas, params = gr_get_params(reg = 'center'))

# summarize
vars = gr_summarize(sep)

head(vars)

gr_plot_vars(vars, Qygr, tests = TRUE)
</code></pre>

<hr>
<h2 id='gr_test_vars'>Test hydrograph changes</h2><span id='topic+gr_test_vars'></span>

<h3>Description</h3>

<p>Use this function to test interannual changes or hydrograph separation variables returned by <code><a href="#topic+gr_summarize">gr_summarize()</a></code>. Pettitt test is used to detect the change year â€” i.e. the year which divides the time series into the statistically most differing samples. Student (Welch) and Fisher tests are used to estimate the significance of mean and variance differences of these samples. Theil-Sen test calculates the trend slope value. Mann-Kendall test is performed to reveal the significance of the trend.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gr_test_vars(df, ..., year = NULL, exclude = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gr_test_vars_+3A_df">df</code></td>
<td>
<p><code>data.frame</code> as produced by <code><a href="#topic+gr_summarize">gr_summarize()</a></code> function.</p>
</td></tr>
<tr><td><code id="gr_test_vars_+3A_...">...</code></td>
<td>
<p>Names of the tested variables (quoted).</p>
</td></tr>
<tr><td><code id="gr_test_vars_+3A_year">year</code></td>
<td>
<p>Integer value of year used to divide series in two samples compared by Student and Fisher tests. Defaults to <code>NULL</code> which means that the year is calculated automatically by Pettitt test.</p>
</td></tr>
<tr><td><code id="gr_test_vars_+3A_exclude">exclude</code></td>
<td>
<p>Integer vector of years to be excluded from tests.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Number of observations formally required for various tests: Pettitt &gt; 0, Mann-Kendall &gt; 2, Theil-Sen &gt; 1, Student &gt; 1, Fisher &gt; 1.
</p>


<h3>Value</h3>

<p><code>list</code> of testing results with following elements:</p>

<table>
<tr>
 <td style="text-align: left;">
   <strong>Element</strong> </td><td style="text-align: left;"> <strong>Description</strong> </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>ptt</code> </td><td style="text-align: left;"> Pettitt tests for change year </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>mkt</code> </td><td style="text-align: left;"> Mann-Kendall test for trend significance </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>tst</code> </td><td style="text-align: left;"> Theil-Sen test for slope estimation </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>ts_fit</code> </td><td style="text-align: left;"> Theil-Sen linear model fit </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>tt</code> </td><td style="text-align: left;"> Student (Welch) test for significance of mean differences between two periods </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>ft</code> </td><td style="text-align: left;"> Fisher test for significance of variance differences between two periods </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>year</code> </td><td style="text-align: left;"> Integer value of year used to divide series in two samples compared by Student and Fisher tests </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>maxval</code> </td><td style="text-align: left;"> Maximum value for the variable along the full time series </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>fixed_year</code> </td><td style="text-align: left;"> Boolean <code>TRUE</code> or <code>FALSE</code> value indicating if the year was fixed </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>pvalues</code> </td><td style="text-align: left;"> p-values of all tests summarized as a single table for all variables </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Examples</h3>

<pre><code class='language-R'>library(grwat)

data(spas) # example Spas-Zagorye data is included with grwat package

# separate
sep = gr_separate(spas, params = gr_get_params(reg = 'center'))

# summarize from 1965 to 1990
vars = gr_summarize(sep, 1965, 1990)

# test all variables
tests = gr_test_vars(vars)

# view Pettitt test for Qygr
tests$ptt$Qygr

# view Fisher test for Q30s
tests$ft$Q30s

# test only Qygr and Q30s using 1978 as fixed year and excluding 1988-1991 yrs
gr_test_vars(vars, Qygr, Q30s, year = 1978, exclude = 1981:1983)
</code></pre>

<hr>
<h2 id='spas'>Spas-Zagorye daily runoff data</h2><span id='topic+spas'></span>

<h3>Description</h3>

<p>A dataset containing the daily runoff data for <a href="https://allrivers.info/gauge/protva-obninsk">Spas-Zagorye</a> gauge on <a href="https://en.wikipedia.org/wiki/Protva">Protva</a> river in Central European plane. The dataset is supplemented by meteorological variables (temperature and precipitation) obtained from CIRES-DOE (1880-1949) and ERA5 (1950-2021) data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spas
</code></pre>


<h3>Format</h3>

<p>A data frame with 23742 rows and 4 variables:
</p>

<dl>
<dt>Date</dt><dd><p>date, in dates</p>
</dd>
<dt>Q</dt><dd><p>daily runoff, in m3/s</p>
</dd>
<dt>Temp</dt><dd><p>daily temperature, in Celsius degrees</p>
</dd>
<dt>Prec</dt><dd><p>daily precipitation, in mm</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://allrivers.info/gauge/protva-obninsk">https://allrivers.info/gauge/protva-obninsk</a>
</p>
<p><a href="https://gmvo.skniivh.ru">https://gmvo.skniivh.ru</a>
</p>
<p><a href="https://www.ecmwf.int/en/forecasts/dataset/ecmwf-reanalysis-v5">https://www.ecmwf.int/en/forecasts/dataset/ecmwf-reanalysis-v5</a>
</p>
<p><a href="https://psl.noaa.gov/data/gridded/data.20thC_ReanV3.html">https://psl.noaa.gov/data/gridded/data.20thC_ReanV3.html</a>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
