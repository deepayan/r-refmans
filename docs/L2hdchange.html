<!DOCTYPE html><html lang="en"><head><title>Help for package L2hdchange</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {L2hdchange}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#check_nbd'><p>Check the validity of the neighbourhood specification</p></a></li>
<li><a href='#covid_data'><p>U.S. COVID-19 Data</p></a></li>
<li><a href='#covid_nbd_info'><p>U.S. COVID-19 Data Neighbourhood Information</p></a></li>
<li><a href='#est_hdchange'><p>Construct an S3 class 'no_nbd' or 'nbd' for change-point estimation</p></a></li>
<li><a href='#genZ'><p>Generate a random Gaussian vector</p></a></li>
<li><a href='#get_breaks'><p>Obtain the time-stamps and spatial locations with breaks</p></a></li>
<li><a href='#get_breaks.nbd'><p>Obtain the time-stamps and spatial locations with breaks</p></a></li>
<li><a href='#get_breaks.no_nbd'><p>Obtain the time-stamps and spatial locations without break</p></a></li>
<li><a href='#get_cov_x_MAinf'><p>The covariance matrix for generating random Gaussian vector</p></a></li>
<li><a href='#get_critical'><p>Obtain critical values and threshold</p></a></li>
<li><a href='#get_critical.nbd'><p>Obtain critical values and threshold</p></a></li>
<li><a href='#get_critical.no_nbd'><p>Obtain critical values and threshold</p></a></li>
<li><a href='#get_GS_MAinf'><p>Obtain the simulated standardised gap vector</p></a></li>
<li><a href='#get_GS_MAinf.nbd'><p>Obtain the simulated standardised gap vector</p></a></li>
<li><a href='#get_GS_MAinf.no_nbd'><p>Obtain the simulated standardised gap vector</p></a></li>
<li><a href='#get_lr_var'><p>Compute the long-run variance of the gap vector</p></a></li>
<li><a href='#get_teststats'><p>Obtain the test statistics</p></a></li>
<li><a href='#get_teststats.nbd'><p>Obtain the test statistics</p></a></li>
<li><a href='#get_teststats.no_nbd'><p>Obtain the test statistics</p></a></li>
<li><a href='#get_V_l2_MAinf'><p>Obtain the standardised gap vector</p></a></li>
<li><a href='#get_V_l2_MAinf.nbd'><p>Obtain the standardised gap vector</p></a></li>
<li><a href='#get_V_l2_MAinf.no_nbd'><p>Obtain the standardised gap vector</p></a></li>
<li><a href='#hdchange'><p>Estimate the time-stamps and spatial locations with breaks</p></a></li>
<li><a href='#plot_result'><p>Plot the time series and change-points</p></a></li>
<li><a href='#plot_result.result_nbd'><p>Plot the time series and change-points</p></a></li>
<li><a href='#plot_result.result_no_nbd'><p>Plot the time series and change-points</p></a></li>
<li><a href='#sim_hdchange_nbd'><p>Simulate data with neighbourhood</p></a></li>
<li><a href='#sim_hdchange_no_nbd'><p>Simulate data without neighbourhood</p></a></li>
<li><a href='#summary.result_nbd'><p>Summarize the estimation results</p></a></li>
<li><a href='#summary.result_no_nbd'><p>Summarize the estimation results</p></a></li>
<li><a href='#test_existence'><p>Test the existence of change-points in the data</p></a></li>
<li><a href='#ts_hdchange'><p>'no_nbd' or 'nbd' object construction</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-07-19</td>
</tr>
<tr>
<td>Title:</td>
<td>L2 Inference for Change Points in High-Dimensional Time Series</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Rui Lin &lt;ruilin1081@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides a method for detecting multiple change points in high-dimensional time
    series, targeting dense or spatially clustered signals. See Li et al. (2023) 
    "L2 Inference for Change Points in High-Dimensional Time Series via a Two-Way MOSUM". 
    arXiv preprint &lt;<a href="https://doi.org/10.48550/arXiv.2208.13074">doi:10.48550/arXiv.2208.13074</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-07-19 16:54:45 UTC; rl1081</td>
</tr>
<tr>
<td>Author:</td>
<td>Jiaqi Li [aut],
  Likai Chen [aut],
  Weining Wang [aut],
  Wei Biao Wu [aut],
  Rui Lin [cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-07-20 11:20:04 UTC</td>
</tr>
</table>
<hr>
<h2 id='check_nbd'>Check the validity of the neighbourhood specification</h2><span id='topic+check_nbd'></span>

<h3>Description</h3>

<p>Check the validity of the neighbourhood specification
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_nbd(nbd_info)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check_nbd_+3A_nbd_info">nbd_info</code></td>
<td>
<p>A list containing the neighbourhood information. See <code><a href="#topic+ts_hdchange">ts_hdchange()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value. Show an error message if nbd_info is invalid.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>nbd_info &lt;- list(c(1:10),c(8:20))
check_nbd &lt;- check_nbd(nbd_info)


</code></pre>

<hr>
<h2 id='covid_data'>U.S. COVID-19 Data</h2><span id='topic+covid_data'></span>

<h3>Description</h3>

<p>Daily number of COVID-19 cases for 58 areas in the United States (including 50 states,
Washington D.C., 5 territories and 2 cruise ships)
for 812 days from 22 Jan 2020 to 12 April 2022.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>covid_data
</code></pre>


<h3>Format</h3>



<h4><code>covid_data</code></h4>

<p>A data matrix with p = 58 rows and n = 812 columns.
</p>



<h3>Source</h3>

<p>U.S. CDC <a href="https://covid.cdc.gov/covid-data-tracker/#maps_new-admissions-rate-county">https://covid.cdc.gov/covid-data-tracker/#maps_new-admissions-rate-county</a>
</p>

<hr>
<h2 id='covid_nbd_info'>U.S. COVID-19 Data Neighbourhood Information</h2><span id='topic+covid_nbd_info'></span>

<h3>Description</h3>

<p>U.S. COVID-19 Data Neighbourhood Information
</p>


<h3>Usage</h3>

<pre><code class='language-R'>covid_nbd_info
</code></pre>


<h3>Format</h3>



<h4><code>covid_nbd_info</code></h4>

<p>A list containing five arrays indicating the constituents of five U.S. regions:
</p>
<p><strong>Northeast</strong>: Connecticut, Maine, Massachusetts, New Hampshire, Rhode Island, Vermont,
New Jersey, New York, and Pennsylvania.
</p>
<p><strong>Midwest</strong>: Illinois, Indiana, Michigan, Ohio, Wisconsin, Iowa, Kansas, Minnesota, Missouri,
Nebraska, North Dakota, and South Dakota.
</p>
<p><strong>South</strong>: Delaware, Florida, Georgia, Maryland, North Carolina, South Carolina, Virginia,
District of Columbia, West Virginia, Alabama, Kentucky, Mississippi, Tennessee, Arkansas, Louisiana,
Oklahoma, and Texas.
</p>
<p><strong>West</strong>: Arizona, Colorado, Idaho, Montana, Nevada, New Mexico, Utah, Wyoming, Alaska,
California, Hawaii, Oregon, and Washington.
</p>
<p><strong>Others</strong>: American Samoa, Diamond Princess, Grand Princess, Guam, Northern Mariana
Islands, Puerto Rico, and Virgin Islands.
</p>



<h3>Source</h3>

<p>U.S. Census Bureau, W. (2000). <em>List of regions of the United States</em>.
</p>

<hr>
<h2 id='est_hdchange'>Construct an S3 class 'no_nbd' or 'nbd' for change-point estimation</h2><span id='topic+est_hdchange'></span>

<h3>Description</h3>

<p>Construct an S3 class 'no_nbd' or 'nbd' for change-point estimation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>est_hdchange(hdobj, test_stats, threshold, stat_all, critical_values)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="est_hdchange_+3A_hdobj">hdobj</code></td>
<td>
<p>An S3 object of class 'no_nbd' or 'nbd' generated by <code><a href="#topic+ts_hdchange">ts_hdchange()</a></code>.</p>
</td></tr>
<tr><td><code id="est_hdchange_+3A_test_stats">test_stats</code></td>
<td>
<p>A list containing the test statistics generated by <code><a href="#topic+get_teststats">get_teststats()</a></code>.</p>
</td></tr>
<tr><td><code id="est_hdchange_+3A_threshold">threshold</code></td>
<td>
<p>The threshold in break estimation.</p>
</td></tr>
<tr><td><code id="est_hdchange_+3A_stat_all">stat_all</code></td>
<td>
<p>An array of test statistics generated by <code><a href="#topic+get_V_l2_MAinf">get_V_l2_MAinf()</a></code>.</p>
</td></tr>
<tr><td><code id="est_hdchange_+3A_critical_values">critical_values</code></td>
<td>
<p>An array of quantiles for critical values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 object of class 'no_nbd' or 'nbd' used as the argument of <code><a href="#topic+get_breaks">get_breaks()</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generate data
data_no_nbd &lt;- sim_hdchange_no_nbd(n = 200,
p = 30,
S = 30,
tau = c(40, 100, 160),
dist_info =
  list(dist = "normal", dependence = "MA_inf", param = 1),
jump_max = c(2, 2, 1.5))

# construct no_nbd object
ts_no_nbd &lt;- ts_hdchange(data_no_nbd,
window_size = 30,
m = 8,
h = 1,
N_rep = 999,
alpha = 1e-5,
quantiles = c(0.01, 0.05, 0.1))

teststats &lt;- get_teststats(ts_no_nbd)
V_12_MAinf &lt;- get_V_l2_MAinf(ts_no_nbd)

estobj &lt;- est_hdchange(hdobj = ts_no_nbd, test_stats = teststats$stat_max,
threshold = 1e-5, stat_all = V_12_MAinf, critical_values = c(0.01, 0.05, 0.1))


</code></pre>

<hr>
<h2 id='genZ'>Generate a random Gaussian vector</h2><span id='topic+genZ'></span>

<h3>Description</h3>

<p>Generate a random Gaussian vector
</p>


<h3>Usage</h3>

<pre><code class='language-R'>genZ(hdobj)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="genZ_+3A_hdobj">hdobj</code></td>
<td>
<p>An S3 object of class 'no_nbd' or 'nbd' generated by <code><a href="#topic+ts_hdchange">ts_hdchange()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The Gaussian random vector <code class="reqn">\mathcal{Z}</code>.
</p>


<h3>References</h3>

<p>Li, J., Chen, L., Wang, W. and Wu, W.B., 2022. <code class="reqn">\ell^2</code> Inference for Change Points in High-Dimensional Time Series via a Two-Way MOSUM.
<em>arXiv preprint arXiv:2208.13074</em>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generate data
data_no_nbd &lt;- sim_hdchange_no_nbd(n = 200,
p = 30,
S = 30,
tau = c(40, 100, 160),
dist_info =
  list(dist = "normal", dependence = "MA_inf", param = 1),
jump_max = c(2, 2, 1.5))

# construct no_nbd object
ts_no_nbd &lt;- ts_hdchange(data_no_nbd,
window_size = 30,
m = 8,
h = 1,
N_rep = 999,
alpha = 1e-5,
quantiles = c(0.01, 0.05, 0.1))

Z &lt;- genZ(ts_no_nbd)

</code></pre>

<hr>
<h2 id='get_breaks'>Obtain the time-stamps and spatial locations with breaks</h2><span id='topic+get_breaks'></span>

<h3>Description</h3>

<p>Obtain the time-stamps and spatial locations with breaks
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_breaks(estobj)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_breaks_+3A_estobj">estobj</code></td>
<td>
<p>An S3 object of class 'no_nbd' or 'nbd' generated
by <code><a href="#topic+est_hdchange">est_hdchange()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the time-stamps and spatial locations with breaks.
For S3 class 'no_nbd', it returns the total number of breaks <code class="reqn">\widehat{K}</code>
and the time-stamps <code class="reqn">\hat{\tau}_{k}</code>. See Algorithm 1 of Li et al. (2023).
For S3 class 'nbd', it returns the total number of breaks <code class="reqn">\widehat{R}</code> and the
spatial-temporal location of the break <code class="reqn">(\hat{\tau}_{r},\hat{s}_{r})</code>. See Algorithm
2 of Li et al. (2023).
</p>


<h3>References</h3>

<p>Li, J., Chen, L., Wang, W. and Wu, W.B., 2022. <code class="reqn">\ell^2</code> Inference for Change Points in High-Dimensional Time Series via a Two-Way MOSUM.
<em>arXiv preprint arXiv:2208.13074</em>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generate data
data_no_nbd &lt;- sim_hdchange_no_nbd(n = 200,
p = 30,
S = 30,
tau = c(40, 100, 160),
dist_info =
  list(dist = "normal", dependence = "MA_inf", param = 1),
jump_max = c(2, 2, 1.5))

# construct no_nbd object
ts_no_nbd &lt;- ts_hdchange(data_no_nbd,
window_size = 30,
m = 8,
h = 1,
N_rep = 999,
alpha = 1e-5,
quantiles = c(0.01, 0.05, 0.1))

teststats &lt;- get_teststats(ts_no_nbd)
V_12_MAinf &lt;- get_V_l2_MAinf(ts_no_nbd)

estobj &lt;- est_hdchange(hdobj = ts_no_nbd, test_stats = teststats$stat_max,
threshold = 1e-5, stat_all = V_12_MAinf, critical_values = c(0.01, 0.05, 0.1))

breaks &lt;- get_breaks(estobj)

</code></pre>

<hr>
<h2 id='get_breaks.nbd'>Obtain the time-stamps and spatial locations with breaks</h2><span id='topic+get_breaks.nbd'></span>

<h3>Description</h3>

<p>Obtain the time-stamps and spatial locations with breaks
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nbd'
get_breaks(estobj)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_breaks.nbd_+3A_estobj">estobj</code></td>
<td>
<p>An S3 object of class 'no_nbd' or 'nbd' generated
by <code><a href="#topic+est_hdchange">est_hdchange()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the total number of breaks <code class="reqn">\widehat{R}</code> and the
spatial-temporal location of the break <code class="reqn">(\hat{\tau}_{r},\hat{s}_{r})</code>. See Algorithm
2 of Li et al. (2023).
</p>


<h3>References</h3>

<p>Li, J., Chen, L., Wang, W. and Wu, W.B., 2022. <code class="reqn">\ell^2</code> Inference for Change Points in High-Dimensional Time Series via a Two-Way MOSUM.
<em>arXiv preprint arXiv:2208.13074</em>.
</p>

<hr>
<h2 id='get_breaks.no_nbd'>Obtain the time-stamps and spatial locations without break</h2><span id='topic+get_breaks.no_nbd'></span>

<h3>Description</h3>

<p>Obtain the time-stamps and spatial locations without break
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'no_nbd'
get_breaks(estobj)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_breaks.no_nbd_+3A_estobj">estobj</code></td>
<td>
<p>An S3 object of class 'no_nbd' or 'nbd' generated
by <code><a href="#topic+est_hdchange">est_hdchange()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the total number of breaks <code class="reqn">\widehat{K}</code>
and the time-stamps <code class="reqn">\hat{\tau}_{k}</code>. See Algorithm 1 of Li et al. (2023).
</p>


<h3>References</h3>

<p>Li, J., Chen, L., Wang, W. and Wu, W.B., 2022. <code class="reqn">\ell^2</code> Inference for Change Points in High-Dimensional Time Series via a Two-Way MOSUM.
<em>arXiv preprint arXiv:2208.13074</em>.
</p>

<hr>
<h2 id='get_cov_x_MAinf'>The covariance matrix for generating random Gaussian vector</h2><span id='topic+get_cov_x_MAinf'></span>

<h3>Description</h3>

<p>The covariance matrix for generating random Gaussian vector
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_cov_x_MAinf(n, b)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_cov_x_MAinf_+3A_n">n</code></td>
<td>
<p>Number of time series observations.</p>
</td></tr>
<tr><td><code id="get_cov_x_MAinf_+3A_b">b</code></td>
<td>
<p>Bandwith parameter <code class="reqn">b = window\_size/n</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The covariance matrix. See section 2.2 of Li et al. (2023).
</p>


<h3>References</h3>

<p>Li, J., Chen, L., Wang, W. and Wu, W.B., 2022. <code class="reqn">\ell^2</code> Inference for Change Points in High-Dimensional Time Series via a Two-Way MOSUM.
<em>arXiv preprint arXiv:2208.13074</em>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# generate data
data_no_nbd &lt;- sim_hdchange_no_nbd(n = 200,
p = 30,
S = 30,
tau = c(40, 100, 160),
dist_info =
  list(dist = "normal", dependence = "MA_inf", param = 1),
jump_max = c(2, 2, 1.5))

# construct no_nbd object
ts_no_nbd &lt;- ts_hdchange(data_no_nbd,
window_size = 30,
m = 8,
h = 1,
N_rep = 999,
alpha = 1e-5,
quantiles = c(0.01, 0.05, 0.1))

Cov_x_MAinf &lt;- get_cov_x_MAinf(ts_no_nbd$n, ts_no_nbd$b)

</code></pre>

<hr>
<h2 id='get_critical'>Obtain critical values and threshold</h2><span id='topic+get_critical'></span>

<h3>Description</h3>

<p>Obtain critical values and threshold
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_critical(hdobj)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_critical_+3A_hdobj">hdobj</code></td>
<td>
<p>An S3 object of class 'no_nbd' or 'nbd' generated
by <code><a href="#topic+ts_hdchange">ts_hdchange()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the critical values and
the threshold parameter <code class="reqn">\omega</code>.
</p>


<h3>References</h3>

<p>Li, J., Chen, L., Wang, W. and Wu, W.B., 2022. <code class="reqn">\ell^2</code> Inference for Change Points in High-Dimensional Time Series via a Two-Way MOSUM.
<em>arXiv preprint arXiv:2208.13074</em>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generate data
data_no_nbd &lt;- sim_hdchange_no_nbd(n = 200,
p = 30,
S = 30,
tau = c(40, 100, 160),
dist_info =
  list(dist = "normal", dependence = "MA_inf", param = 1),
jump_max = c(2, 2, 1.5))

# construct no_nbd object
ts_no_nbd &lt;- ts_hdchange(data_no_nbd,
window_size = 30,
m = 8,
h = 1,
N_rep = 999,
alpha = 1e-5,
quantiles = c(0.01, 0.05, 0.1))

crit &lt;- get_critical(ts_no_nbd)

</code></pre>

<hr>
<h2 id='get_critical.nbd'>Obtain critical values and threshold</h2><span id='topic+get_critical.nbd'></span>

<h3>Description</h3>

<p>Obtain critical values and threshold
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nbd'
get_critical(hdobj)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_critical.nbd_+3A_hdobj">hdobj</code></td>
<td>
<p>An S3 object of class 'no_nbd' or 'nbd' generated
by <code><a href="#topic+ts_hdchange">ts_hdchange()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the critical values and
the threshold parameter <code class="reqn">\omega</code>.
</p>


<h3>References</h3>

<p>Li, J., Chen, L., Wang, W. and Wu, W.B., 2022. <code class="reqn">\ell^2</code> Inference for Change Points in High-Dimensional Time Series via a Two-Way MOSUM.
<em>arXiv preprint arXiv:2208.13074</em>.
</p>

<hr>
<h2 id='get_critical.no_nbd'>Obtain critical values and threshold</h2><span id='topic+get_critical.no_nbd'></span>

<h3>Description</h3>

<p>Obtain critical values and threshold
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'no_nbd'
get_critical(hdobj)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_critical.no_nbd_+3A_hdobj">hdobj</code></td>
<td>
<p>An S3 object of class 'no_nbd' or 'nbd' generated
by <code><a href="#topic+ts_hdchange">ts_hdchange()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the critical values and
the threshold parameter <code class="reqn">\omega</code>.
</p>


<h3>References</h3>

<p>Li, J., Chen, L., Wang, W. and Wu, W.B., 2022. <code class="reqn">\ell^2</code> Inference for Change Points in High-Dimensional Time Series via a Two-Way MOSUM.
<em>arXiv preprint arXiv:2208.13074</em>.
</p>

<hr>
<h2 id='get_GS_MAinf'>Obtain the simulated standardised gap vector</h2><span id='topic+get_GS_MAinf'></span>

<h3>Description</h3>

<p>Obtain the simulated standardised gap vector
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_GS_MAinf(hdobj)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_GS_MAinf_+3A_hdobj">hdobj</code></td>
<td>
<p>An S3 object of class 'no_nbd' or 'nbd' generated
by <code><a href="#topic+ts_hdchange">ts_hdchange()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An array of the simulated counterpart of <code class="reqn">|V_{i}|_{2}^{2}</code>.
</p>


<h3>References</h3>

<p>Li, J., Chen, L., Wang, W. and Wu, W.B., 2022. <code class="reqn">\ell^2</code> Inference for Change Points in High-Dimensional Time Series via a Two-Way MOSUM.
<em>arXiv preprint arXiv:2208.13074</em>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generate data
data_no_nbd &lt;- sim_hdchange_no_nbd(n = 200,
p = 30,
S = 30,
tau = c(40, 100, 160),
dist_info =
  list(dist = "normal", dependence = "MA_inf", param = 1),
jump_max = c(2, 2, 1.5))

# construct no_nbd object
ts_no_nbd &lt;- ts_hdchange(data_no_nbd,
window_size = 30,
m = 8,
h = 1,
N_rep = 999,
alpha = 1e-5,
quantiles = c(0.01, 0.05, 0.1))

GS_MAinf &lt;- get_GS_MAinf(ts_no_nbd)

</code></pre>

<hr>
<h2 id='get_GS_MAinf.nbd'>Obtain the simulated standardised gap vector</h2><span id='topic+get_GS_MAinf.nbd'></span>

<h3>Description</h3>

<p>Obtain the simulated standardised gap vector
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nbd'
get_GS_MAinf(hdobj)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_GS_MAinf.nbd_+3A_hdobj">hdobj</code></td>
<td>
<p>An S3 object of class 'no_nbd' or 'nbd' generated
by <code><a href="#topic+ts_hdchange">ts_hdchange()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An array of the simulated counterpart of <code class="reqn">|V_{i}|_{2}^{2}</code>.
</p>


<h3>References</h3>

<p>Li, J., Chen, L., Wang, W. and Wu, W.B., 2022. <code class="reqn">\ell^2</code> Inference for Change Points in High-Dimensional Time Series via a Two-Way MOSUM.
<em>arXiv preprint arXiv:2208.13074</em>.
</p>

<hr>
<h2 id='get_GS_MAinf.no_nbd'>Obtain the simulated standardised gap vector</h2><span id='topic+get_GS_MAinf.no_nbd'></span>

<h3>Description</h3>

<p>Obtain the simulated standardised gap vector
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'no_nbd'
get_GS_MAinf(hdobj)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_GS_MAinf.no_nbd_+3A_hdobj">hdobj</code></td>
<td>
<p>An S3 object of class 'no_nbd' or 'nbd' generated
by <code><a href="#topic+ts_hdchange">ts_hdchange()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An array of the simulated counterpart of <code class="reqn">|V_{i}|_{2}^{2}</code>.
</p>


<h3>References</h3>

<p>Li, J., Chen, L., Wang, W. and Wu, W.B., 2022. <code class="reqn">\ell^2</code> Inference for Change Points in High-Dimensional Time Series via a Two-Way MOSUM.
<em>arXiv preprint arXiv:2208.13074</em>.
</p>

<hr>
<h2 id='get_lr_var'>Compute the long-run variance of the gap vector</h2><span id='topic+get_lr_var'></span>

<h3>Description</h3>

<p>Compute the long-run variance of the gap vector
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_lr_var(hdobj)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_lr_var_+3A_hdobj">hdobj</code></td>
<td>
<p>An S3 object of class 'no_nbd' or 'nbd' generated
by <code><a href="#topic+ts_hdchange">ts_hdchange()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The covariance matrix of the gap vectors <code class="reqn">\hat{J}(.)</code>.
</p>


<h3>References</h3>

<p>Li, J., Chen, L., Wang, W. and Wu, W.B., 2022. <code class="reqn">\ell^2</code> Inference for Change Points in High-Dimensional Time Series via a Two-Way MOSUM.
<em>arXiv preprint arXiv:2208.13074</em>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# generate data
data_no_nbd &lt;- sim_hdchange_no_nbd(n = 200,
p = 30,
S = 30,
tau = c(40, 100, 160),
dist_info =
  list(dist = "normal", dependence = "MA_inf", param = 1),
jump_max = c(2, 2, 1.5))

# construct no_nbd object
ts_no_nbd &lt;- ts_hdchange(data_no_nbd,
window_size = 30,
m = 8,
h = 1,
N_rep = 999,
alpha = 1e-5,
quantiles = c(0.01, 0.05, 0.1))

lr_var &lt;- get_lr_var(ts_no_nbd)

</code></pre>

<hr>
<h2 id='get_teststats'>Obtain the test statistics</h2><span id='topic+get_teststats'></span>

<h3>Description</h3>

<p>Obtain the test statistics
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_teststats(hdobj)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_teststats_+3A_hdobj">hdobj</code></td>
<td>
<p>An S3 object of class 'no_nbd' or 'nbd' generated
by <code><a href="#topic+ts_hdchange">ts_hdchange()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the test statistics <code class="reqn">\mathcal{\boldsymbol{Q}}_{n}</code>
and a sequence of standardised <code class="reqn">|V_{i}|_{2}^{2}</code>.
</p>


<h3>References</h3>

<p>Li, J., Chen, L., Wang, W. and Wu, W.B., 2022. <code class="reqn">\ell^2</code> Inference for Change Points in High-Dimensional Time Series via a Two-Way MOSUM.
<em>arXiv preprint arXiv:2208.13074</em>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generate data
data_no_nbd &lt;- sim_hdchange_no_nbd(n = 200,
p = 30,
S = 30,
tau = c(40, 100, 160),
dist_info =
  list(dist = "normal", dependence = "MA_inf", param = 1),
jump_max = c(2, 2, 1.5))

# construct no_nbd object
ts_no_nbd &lt;- ts_hdchange(data_no_nbd,
window_size = 30,
m = 8,
h = 1,
N_rep = 999,
alpha = 1e-5,
quantiles = c(0.01, 0.05, 0.1))

teststat &lt;- get_teststats(ts_no_nbd)

</code></pre>

<hr>
<h2 id='get_teststats.nbd'>Obtain the test statistics</h2><span id='topic+get_teststats.nbd'></span>

<h3>Description</h3>

<p>Obtain the test statistics
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nbd'
get_teststats(hdobj)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_teststats.nbd_+3A_hdobj">hdobj</code></td>
<td>
<p>An S3 object of class 'no_nbd' or 'nbd' generated
by <code><a href="#topic+ts_hdchange">ts_hdchange()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the test statistics <code class="reqn">\mathcal{\boldsymbol{Q}}_{n}</code>
and a sequence of standardised <code class="reqn">|V_{i}|_{2}^{2}</code>.
</p>


<h3>References</h3>

<p>Li, J., Chen, L., Wang, W. and Wu, W.B., 2022. <code class="reqn">\ell^2</code> Inference for Change Points in High-Dimensional Time Series via a Two-Way MOSUM.
<em>arXiv preprint arXiv:2208.13074</em>.
</p>

<hr>
<h2 id='get_teststats.no_nbd'>Obtain the test statistics</h2><span id='topic+get_teststats.no_nbd'></span>

<h3>Description</h3>

<p>Obtain the test statistics
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'no_nbd'
get_teststats(hdobj)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_teststats.no_nbd_+3A_hdobj">hdobj</code></td>
<td>
<p>An S3 object of class 'no_nbd' or 'nbd' generated
by <code><a href="#topic+ts_hdchange">ts_hdchange()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the test statistics <code class="reqn">\mathcal{\boldsymbol{Q}}_{n}</code>
and a sequence of standardised <code class="reqn">|V_{i}|_{2}^{2}</code>.
</p>


<h3>References</h3>

<p>Li, J., Chen, L., Wang, W. and Wu, W.B., 2022. <code class="reqn">\ell^2</code> Inference for Change Points in High-Dimensional Time Series via a Two-Way MOSUM.
<em>arXiv preprint arXiv:2208.13074</em>.
</p>

<hr>
<h2 id='get_V_l2_MAinf'>Obtain the standardised gap vector</h2><span id='topic+get_V_l2_MAinf'></span>

<h3>Description</h3>

<p>Obtain the standardised gap vector
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_V_l2_MAinf(hdobj)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_V_l2_MAinf_+3A_hdobj">hdobj</code></td>
<td>
<p>An S3 object of class 'no_nbd' or 'nbd' generated
by <code><a href="#topic+ts_hdchange">ts_hdchange()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An array of <code class="reqn">|V_{i}|_{2}^{2}</code>.
</p>


<h3>References</h3>

<p>Li, J., Chen, L., Wang, W. and Wu, W.B., 2022. <code class="reqn">\ell^2</code> Inference for Change Points in High-Dimensional Time Series via a Two-Way MOSUM.
<em>arXiv preprint arXiv:2208.13074</em>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generate data
data_no_nbd &lt;- sim_hdchange_no_nbd(n = 200,
p = 30,
S = 30,
tau = c(40, 100, 160),
dist_info =
  list(dist = "normal", dependence = "MA_inf", param = 1),
jump_max = c(2, 2, 1.5))

# construct no_nbd object
ts_no_nbd &lt;- ts_hdchange(data_no_nbd,
window_size = 30,
m = 8,
h = 1,
N_rep = 999,
alpha = 1e-5,
quantiles = c(0.01, 0.05, 0.1))

V_12_MAinf &lt;- get_V_l2_MAinf(ts_no_nbd)

</code></pre>

<hr>
<h2 id='get_V_l2_MAinf.nbd'>Obtain the standardised gap vector</h2><span id='topic+get_V_l2_MAinf.nbd'></span>

<h3>Description</h3>

<p>Obtain the standardised gap vector
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nbd'
get_V_l2_MAinf(hdobj)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_V_l2_MAinf.nbd_+3A_hdobj">hdobj</code></td>
<td>
<p>An S3 object of class 'no_nbd' or 'nbd' generated
by <code><a href="#topic+ts_hdchange">ts_hdchange()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An array of <code class="reqn">|V_{i}|_{2}^{2}</code>.
</p>


<h3>References</h3>

<p>Li, J., Chen, L., Wang, W. and Wu, W.B., 2022. <code class="reqn">\ell^2</code> Inference for Change Points in High-Dimensional Time Series via a Two-Way MOSUM.
<em>arXiv preprint arXiv:2208.13074</em>.
</p>

<hr>
<h2 id='get_V_l2_MAinf.no_nbd'>Obtain the standardised gap vector</h2><span id='topic+get_V_l2_MAinf.no_nbd'></span>

<h3>Description</h3>

<p>Obtain the standardised gap vector
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'no_nbd'
get_V_l2_MAinf(hdobj)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_V_l2_MAinf.no_nbd_+3A_hdobj">hdobj</code></td>
<td>
<p>An S3 object of class 'no_nbd' or 'nbd' generated
by <code><a href="#topic+ts_hdchange">ts_hdchange()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An array of <code class="reqn">|V_{i}|_{2}^{2}</code>.
</p>


<h3>References</h3>

<p>Li, J., Chen, L., Wang, W. and Wu, W.B., 2022. <code class="reqn">\ell^2</code> Inference for Change Points in High-Dimensional Time Series via a Two-Way MOSUM.
<em>arXiv preprint arXiv:2208.13074</em>.
</p>

<hr>
<h2 id='hdchange'>Estimate the time-stamps and spatial locations with breaks</h2><span id='topic+hdchange'></span>

<h3>Description</h3>

<p>The main function of this package. It performs a test for existence of
breaks and estimates the time-stamps and locations of the breaks.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hdchange(hdobj)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hdchange_+3A_hdobj">hdobj</code></td>
<td>
<p>An S3 object of class 'no_nbd' or 'nbd' generated
by <code><a href="#topic+ts_hdchange">ts_hdchange()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The return value is an S3 object of class 'no_nbd' or 'nbd' containing a list
of the test results and change-point locations.
</p>


<h3>References</h3>

<p>Li, J., Chen, L., Wang, W. and Wu, W.B., 2022. <code class="reqn">\ell^2</code> Inference for Change Points in High-Dimensional Time Series via a Two-Way MOSUM.
<em>arXiv preprint arXiv:2208.13074</em>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>############ No neighbourhood case ############

# generate data
data_no_nbd &lt;- sim_hdchange_no_nbd(n = 200,
p = 30,
S = 30,
tau = c(40, 100, 160),
dist_info =
  list(dist = "normal", dependence = "MA_inf", param = 1),
jump_max = c(2, 2, 1.5))

# construct no_nbd object
ts_no_nbd &lt;- ts_hdchange(data_no_nbd,
window_size = 30,
m = 8,
h = 1,
N_rep = 999,
alpha = 1e-5,
quantiles = c(0.01, 0.05, 0.1))



# Estimate the time-stamps of the breaks
est_result_no_nbd &lt;- hdchange(ts_no_nbd)

# Summarize the results
summary(est_result_no_nbd)

# Plot the results
plot_result(est_result_no_nbd)
axis(1,
  at = est_result_no_nbd$time_stamps,
  labels = c("break 1", "break 2", "break 3")
)
title(main = "Change-points estimation")


############ Neighbourhood case ############

# generate data
data_nbd &lt;- sim_hdchange_nbd(n = 300,
p = 70,
nbd_info =
 list(
   (1:9), (2:31), (32:41), (42:70),
   (3:15), (16:35), (31:55)
 ),
sp_tp_break = rbind(c(2, 50), c(4, 150), c(2, 250)),
dist_info =
  list(dist = "t", dependence = "iid", param = 5),
jump_max = 1)

# construct nbd object
ts_nbd &lt;- ts_hdchange(data_nbd,
window_size = 30,
m = 8,
h = 1,
N_rep = 999,
alpha = 1e-5,
quantiles = c(0.01, 0.05, 0.1),
nbd_info =
 list(
   (1:9), (2:31), (32:41), (42:70),
   (3:15), (16:35), (31:55)
 ))



# Estimate the time-stamps of the breaks
est_result_nbd &lt;- hdchange(ts_nbd)

# Summarize the results
summary(est_result_nbd)

# Plot the results
plot_result(est_result_nbd, nbd_index = 2)
pairs &lt;- est_result_nbd$nbd_and_stamps_pair
time_stamps &lt;- pairs[pairs[, 1] == 2, 2]
axis(1,
  at = time_stamps,
  labels = c("break 1", "break 2")
)
title(main = "Change-points estimation for neibourhood 2")

</code></pre>

<hr>
<h2 id='plot_result'>Plot the time series and change-points</h2><span id='topic+plot_result'></span>

<h3>Description</h3>

<p>Plot the time series and change-points
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_result(est_result, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_result_+3A_est_result">est_result</code></td>
<td>
<p>An S3 object of class 'result_no_nbd' or 'result_nbd' created by <code><a href="#topic+get_breaks">get_breaks()</a></code>.</p>
</td></tr>
<tr><td><code id="plot_result_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See <code><a href="#topic+hdchange">hdchange()</a></code> for examples.
</p>


<h3>Value</h3>

<p>No return value. Presents the plot of the data and breaks.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# generate data
data_nbd &lt;- sim_hdchange_nbd(n = 300,
p = 70,
nbd_info =
 list(
   (1:9), (2:31), (32:41), (42:70),
   (3:15), (16:35), (31:55)
 ),
sp_tp_break = rbind(c(2, 50), c(4, 150), c(2, 250)),
dist_info =
  list(dist = "t", dependence = "iid", param = 5),
jump_max = 1)

# construct nbd object
ts_nbd &lt;- ts_hdchange(data_nbd,
window_size = 30,
m = 8,
h = 1,
N_rep = 999,
alpha = 1e-5,
quantiles = c(0.01, 0.05, 0.1),
nbd_info =
 list(
   (1:9), (2:31), (32:41), (42:70),
   (3:15), (16:35), (31:55)
 ))

# Estimate the time-stamps of the breaks
est_result_nbd &lt;- hdchange(ts_nbd)

# Plot the results
plot_result(est_result_nbd, nbd_index = 2)
pairs &lt;- est_result_nbd$nbd_and_stamps_pair
time_stamps &lt;- pairs[pairs[, 1] == 2, 2]
axis(1,
  at = time_stamps,
  labels = c("break 1", "break 2")
)
title(main = "Change-points estimation for neibourhood 2")

</code></pre>

<hr>
<h2 id='plot_result.result_nbd'>Plot the time series and change-points</h2><span id='topic+plot_result.result_nbd'></span>

<h3>Description</h3>

<p>Plot the time series and change-points
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'result_nbd'
plot_result(est_result, ..., nbd_index)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_result.result_nbd_+3A_est_result">est_result</code></td>
<td>
<p>An S3 object of class 'result_nbd' created by <code><a href="#topic+get_breaks">get_breaks()</a></code>.</p>
</td></tr>
<tr><td><code id="plot_result.result_nbd_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
<tr><td><code id="plot_result.result_nbd_+3A_nbd_index">nbd_index</code></td>
<td>
<p>An integer indicating which neighbourhood to be plotted.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See <code><a href="#topic+hdchange">hdchange()</a></code> for examples.
</p>


<h3>Value</h3>

<p>No return value. Presents the plot of the data and breaks.
</p>

<hr>
<h2 id='plot_result.result_no_nbd'>Plot the time series and change-points</h2><span id='topic+plot_result.result_no_nbd'></span>

<h3>Description</h3>

<p>Plot the time series and change-points
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'result_no_nbd'
plot_result(est_result, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_result.result_no_nbd_+3A_est_result">est_result</code></td>
<td>
<p>An S3 object of class 'result_no_nbd' created by <code><a href="#topic+get_breaks">get_breaks()</a></code>.</p>
</td></tr>
<tr><td><code id="plot_result.result_no_nbd_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See <code><a href="#topic+hdchange">hdchange()</a></code> for examples.
</p>


<h3>Value</h3>

<p>No return value. Presents the plot of the data and breaks.
</p>

<hr>
<h2 id='sim_hdchange_nbd'>Simulate data with neighbourhood</h2><span id='topic+sim_hdchange_nbd'></span>

<h3>Description</h3>

<p>Simulate data with neighbourhood
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_hdchange_nbd(
  n = 300,
  p = 70,
  nbd_info = list((1:9), (2:31), (32:41), (42:70), (3:15), (16:35), (31:55)),
  sp_tp_break = rbind(c(2, 50), c(4, 150), c(2, 250)),
  dist_info = list(dist = "normal", dependence = "iid", param = 1),
  jump_max = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sim_hdchange_nbd_+3A_n">n</code></td>
<td>
<p>Number of time series observations.</p>
</td></tr>
<tr><td><code id="sim_hdchange_nbd_+3A_p">p</code></td>
<td>
<p>Number of individual.</p>
</td></tr>
<tr><td><code id="sim_hdchange_nbd_+3A_nbd_info">nbd_info</code></td>
<td>
<p>A list containing the neighbourhood information. See <code><a href="#topic+ts_hdchange">ts_hdchange()</a></code>.</p>
</td></tr>
<tr><td><code id="sim_hdchange_nbd_+3A_sp_tp_break">sp_tp_break</code></td>
<td>
<p>A <code class="reqn">K \times 2</code> matrix indicating the spatial-temporal break location.</p>
</td></tr>
<tr><td><code id="sim_hdchange_nbd_+3A_dist_info">dist_info</code></td>
<td>
<p>A list specifying the distribution of the innovation.</p>
</td></tr>
<tr><td><code id="sim_hdchange_nbd_+3A_jump_max">jump_max</code></td>
<td>
<p>Maximum jump size of the breaks.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>'sp_tp_break' should be a <code class="reqn">K \times 2</code> matrix with first column
indicating the neighbourhoods and the second column indicating the time stamps.
For example, 'sp_tp_break = rbind(c(2, 50), c(4, 150), c(2, 250))' means that
the second neighbourhood has two breaks taking place at <code class="reqn">i = 50, 250</code> and
the fourth neighbourhood has one break taking place at <code class="reqn">i = 150</code>.
</p>
<p>'dist_info' should be a list containing the following items:
</p>

<ul>
<li><p> dist: distribution of the innovations, either &quot;normal&quot; or &quot;t&quot;.
</p>
</li>
<li><p> dependence: iid or <code class="reqn">MA(\infty)</code>, either &quot;iid&quot; or &quot;MA_inf&quot;.
</p>
</li>
<li><p> param = parameter of the distribution, standard deviation for normal distribution
and degree of freedom for t distribution
</p>
</li></ul>

<p>'jump_max' is set equal in nbd case for convenience.
</p>
<p>See <code><a href="#topic+ts_hdchange">ts_hdchange()</a></code> for example.
</p>


<h3>Value</h3>

<p>A <code class="reqn">p \times n</code> simulated data matrix.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data_nbd &lt;- sim_hdchange_nbd(n = 300,
p = 70,
nbd_info =
 list(
   (1:9), (2:31), (32:41), (42:70),
   (3:15), (16:35), (31:55)
 ),
sp_tp_break = rbind(c(2, 50), c(4, 150), c(2, 250)),
dist_info =
  list(dist = "t", dependence = "iid", param = 5),
jump_max = 1)


</code></pre>

<hr>
<h2 id='sim_hdchange_no_nbd'>Simulate data without neighbourhood</h2><span id='topic+sim_hdchange_no_nbd'></span>

<h3>Description</h3>

<p>Simulate data without neighbourhood
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_hdchange_no_nbd(
  n = 200,
  p = 30,
  S = 30,
  tau = c(40, 100, 160),
  dist_info = list(dist = "normal", dependence = "iid", param = 1),
  jump_max = c(2, 2, 1.5)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sim_hdchange_no_nbd_+3A_n">n</code></td>
<td>
<p>Number of time series observations.</p>
</td></tr>
<tr><td><code id="sim_hdchange_no_nbd_+3A_p">p</code></td>
<td>
<p>Number of individuals.</p>
</td></tr>
<tr><td><code id="sim_hdchange_no_nbd_+3A_s">S</code></td>
<td>
<p>Number of individuals with jumps.</p>
</td></tr>
<tr><td><code id="sim_hdchange_no_nbd_+3A_tau">tau</code></td>
<td>
<p>An array of length <code class="reqn">K</code> for time stamps for breaks.</p>
</td></tr>
<tr><td><code id="sim_hdchange_no_nbd_+3A_dist_info">dist_info</code></td>
<td>
<p>A list specifying the distribution of the innovation.</p>
</td></tr>
<tr><td><code id="sim_hdchange_no_nbd_+3A_jump_max">jump_max</code></td>
<td>
<p>An array of length <code class="reqn">K</code> for jump sizes of the breaks.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>'dist_info' should be a list containing the following items:
</p>

<ul>
<li><p> dist: distribution of the innovations, either &quot;normal&quot; or &quot;t&quot;.
</p>
</li>
<li><p> dependence: iid or MA(<code class="reqn">\infty</code>), either &quot;iid&quot; or &quot;MA_inf&quot;.
</p>
</li>
<li><p> param = parameter of the distribution, standard deviation for normal distribution
and degree of freedom for t distribution
</p>
</li></ul>

<p>See <code><a href="#topic+ts_hdchange">ts_hdchange()</a></code> for example.
</p>


<h3>Value</h3>

<p>A <code class="reqn">p \times n</code> simulated data matrix.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data_no_nbd &lt;- sim_hdchange_no_nbd(n = 200,
p = 30,
S = 30,
tau = c(40, 100, 160),
dist_info =
  list(dist = "normal", dependence = "MA_inf", param = 1),
jump_max = c(2, 2, 1.5))


</code></pre>

<hr>
<h2 id='summary.result_nbd'>Summarize the estimation results</h2><span id='topic+summary.result_nbd'></span>

<h3>Description</h3>

<p>Summarize the estimation results
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'result_nbd'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.result_nbd_+3A_object">object</code></td>
<td>
<p>An S3 object of class 'result_nbd' created by <code><a href="#topic+get_breaks">get_breaks()</a></code>.</p>
</td></tr>
<tr><td><code id="summary.result_nbd_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See <code><a href="#topic+hdchange">hdchange()</a></code> for examples.
</p>


<h3>Value</h3>

<p>No return value. Presents the summary of the test and estimation results.
</p>

<hr>
<h2 id='summary.result_no_nbd'>Summarize the estimation results</h2><span id='topic+summary.result_no_nbd'></span>

<h3>Description</h3>

<p>Summarize the estimation results
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'result_no_nbd'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.result_no_nbd_+3A_object">object</code></td>
<td>
<p>An S3 object of class 'result_no_nbd' created by <code><a href="#topic+get_breaks">get_breaks()</a></code>.</p>
</td></tr>
<tr><td><code id="summary.result_no_nbd_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See <code><a href="#topic+hdchange">hdchange()</a></code> for examples.
</p>


<h3>Value</h3>

<p>No return value. Presents the summary of the test and estimation results.
</p>

<hr>
<h2 id='test_existence'>Test the existence of change-points in the data</h2><span id='topic+test_existence'></span>

<h3>Description</h3>

<p>Test the existence of change-points in the data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>test_existence(hdobj, display = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="test_existence_+3A_hdobj">hdobj</code></td>
<td>
<p>An S3 object of class 'no_nbd' or 'nbd' generated
by <code><a href="#topic+ts_hdchange">ts_hdchange()</a></code>.</p>
</td></tr>
<tr><td><code id="test_existence_+3A_display">display</code></td>
<td>
<p>A logical. If 'display = TRUE', the test statistics and
critical values will be printed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See <code><a href="#topic+hdchange">hdchange()</a></code> for examples.
</p>


<h3>Value</h3>

<p>A list containing the following elements:
</p>

<ul>
<li><p> 'test_stats' The test statistics
<code class="reqn">\mathcal{\boldsymbol{Q}}_{n}</code>.
</p>
</li>
<li><p> 'critical_values' The critical values.
</p>
</li>
<li><p> 'stat_all' An array of <code class="reqn">|V_{i}|_{2}^{2}</code>.
</p>
</li>
<li><p> 'critical_value_alpha' The threshold value <code class="reqn">\omega</code> depending on alpha.
</p>
</li></ul>



<h3>References</h3>

<p>Li, J., Chen, L., Wang, W. and Wu, W.B., 2022. <code class="reqn">\ell^2</code> Inference for Change Points in High-Dimensional Time Series via a Two-Way MOSUM.
<em>arXiv preprint arXiv:2208.13074</em>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generate data
data_no_nbd &lt;- sim_hdchange_no_nbd(n = 200,
p = 30,
S = 30,
tau = c(40, 100, 160),
dist_info =
  list(dist = "normal", dependence = "MA_inf", param = 1),
jump_max = c(2, 2, 1.5))

# construct no_nbd object
ts_no_nbd &lt;- ts_hdchange(data_no_nbd,
window_size = 30,
m = 8,
h = 1,
N_rep = 999,
alpha = 1e-5,
quantiles = c(0.01, 0.05, 0.1))

test &lt;- test_existence(ts_no_nbd, display = TRUE)

</code></pre>

<hr>
<h2 id='ts_hdchange'>'no_nbd' or 'nbd' object construction</h2><span id='topic+ts_hdchange'></span>

<h3>Description</h3>

<p>This function creates an S3 object of class 'no_nbd' or 'nbd' containing the
initialising information supplied to the main function <code><a href="#topic+hdchange">hdchange()</a></code>.
'no_nbd' or 'nbd' are constructed depending on whether the
neighbourhood information is provided. The resulting object will be used in the
test and estimation functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ts_hdchange(
  data,
  window_size = 30,
  m = 8,
  h = 1,
  N_rep = 999,
  alpha = 1e-05,
  quantiles = c(0.01, 0.05, 0.1),
  nbd_info = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ts_hdchange_+3A_data">data</code></td>
<td>
<p>p by n data matrix, n = number of time series observations,
p = cross-sectional dimension.</p>
</td></tr>
<tr><td><code id="ts_hdchange_+3A_window_size">window_size</code></td>
<td>
<p><code class="reqn">window\_size = b \times n</code>, e.g. <code class="reqn">n=100</code>, <code class="reqn">b=30</code>.</p>
</td></tr>
<tr><td><code id="ts_hdchange_+3A_m">m</code></td>
<td>
<p>Number of blocks in long-run variance estimation, 8 by default.</p>
</td></tr>
<tr><td><code id="ts_hdchange_+3A_h">h</code></td>
<td>
<p>Parameter in long-run variance estimation, 1 by default.</p>
</td></tr>
<tr><td><code id="ts_hdchange_+3A_n_rep">N_rep</code></td>
<td>
<p>Number of repetitions in MC simulation.</p>
</td></tr>
<tr><td><code id="ts_hdchange_+3A_alpha">alpha</code></td>
<td>
<p>A small positive number controlling for the threshold in break estimation.</p>
</td></tr>
<tr><td><code id="ts_hdchange_+3A_quantiles">quantiles</code></td>
<td>
<p>An array of quantiles for critical values.</p>
</td></tr>
<tr><td><code id="ts_hdchange_+3A_nbd_info">nbd_info</code></td>
<td>
<p>A list containing the neighbourhood information, NULL by default
indicating no neighbourhoods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>'nbd_info' indicates the location of individuals in the data matrix.
For example, 'nbd_info = list(c(1:10), c(25:35), c(7:18))' means that
there are three neighbourhoods. The first neighbourhood contains from the 1st
to 10th individuals and the same rule applies to the rest of neighbourhoods.
The neighbourhoods are allowed to be overlapped. See also the illustrating
example in <code><a href="#topic+hdchange">hdchange()</a></code>.
</p>


<h3>Value</h3>

<p>The return value is an S3 object of class 'no_nbd' or 'nbd'.
It contains a list of the following items:
</p>

<ul>
<li><p> data, m, h, N_rep, alpha, quantiles, and nbd_info are the same as in
the arguments.
</p>
</li>
<li><p> n = number of time series observations.
</p>
</li>
<li><p> p = cross-sectional dimension.
</p>
</li>
<li><p> b = bandwith parameter <code class="reqn">b = window\_size/n</code>.
</p>
</li></ul>



<h3>References</h3>

<p>Li, J., Chen, L., Wang, W. and Wu, W.B., 2022. <code class="reqn">\ell^2</code> Inference for Change Points in High-Dimensional Time Series via a Two-Way MOSUM.
<em>arXiv preprint arXiv:2208.13074</em>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- covid_data

# No neighbourhood case
ts_no_nbd &lt;- ts_hdchange(data,
window_size = 30,
m = 8,
h = 1,
N_rep = 999,
alpha = 1e-5,
quantiles = c(0.01, 0.05, 0.1))

# Neighbourhood case
ts_nbd &lt;- ts_hdchange(data,
window_size = 30,
m = 8,
h = 1,
N_rep = 999,
alpha = 1e-5,
quantiles = c(0.01, 0.05, 0.1),
nbd_info = list(c(1:10), c(25:35), c(7:18)))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
