<!DOCTYPE html><html><head><title>Help for package REMLA</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {REMLA}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#controlREM'><p>Control parameters for REM package</p></a></li>
<li><a href='#REM_CFA'><p>Robust Estimation Maximization Estimates for Confirmatory Factor Analysis</p></a></li>
<li><a href='#REM_EFA'><p>Robust Estimation Maximization for Exploratory Factor Analysis</p></a></li>
<li><a href='#summary.REMLA'><p>Summary for Robust Estimation Maximization</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Robust Expectation-Maximization Estimation for Latent Variable
Models</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-04-18</td>
</tr>
<tr>
<td>Description:</td>
<td>Traditional latent variable models assume that the population
    is homogeneous, meaning that all individuals in the population are
    assumed to have the same latent structure. However, this assumption is
    often violated in practice given that individuals may differ in their
    age, gender, socioeconomic status, and other factors that can affect
    their latent structure. The robust expectation maximization (REM)
    algorithm is a statistical method for estimating the parameters of a
    latent variable model in the presence of population heterogeneity as recommended by 
    Nieser &amp; Cochran (2023) &lt;<a href="https://doi.org/10.1037%2Fmet0000413">doi:10.1037/met0000413</a>&gt;. The REM algorithm is based on the
    expectation-maximization (EM) algorithm, but it allows for the case
    when all the data are generated by the assumed data generating model.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/knieser/REM">https://github.com/knieser/REM</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0), GPArotation,geex</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, lavaan, rmarkdown, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-04-24 18:58:46 UTC; bryanortiz</td>
</tr>
<tr>
<td>Author:</td>
<td>Bryan Ortiz-Torres [aut, cre],
  Kenneth Nieser <a href="https://orcid.org/0000-0001-6003-1296"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Bryan Ortiz-Torres &lt;bortiztorres@wisc.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-05-11 19:03:14 UTC</td>
</tr>
</table>
<hr>
<h2 id='controlREM'>Control parameters for REM package</h2><span id='topic+controlREM'></span>

<h3>Description</h3>

<p>Control parameters for REM package
</p>


<h3>Usage</h3>

<pre><code class='language-R'>controlREM(
  steps = 25,
  tol = 1e-06,
  maxiter = 1000,
  min_weights = 1e-30,
  max_ueps = 0.3,
  chk_gamma = 0.9,
  n = 20000
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="controlREM_+3A_steps">steps</code></td>
<td>
<p>number of steps in binary search for optimal epsilon value (default = 25)</p>
</td></tr>
<tr><td><code id="controlREM_+3A_tol">tol</code></td>
<td>
<p>tolerance parameter to check for convergence of EM and REM algorithm (default = 1e-6)</p>
</td></tr>
<tr><td><code id="controlREM_+3A_maxiter">maxiter</code></td>
<td>
<p>maximum number iterations of EM and REM algorithm (default = 1e3)</p>
</td></tr>
<tr><td><code id="controlREM_+3A_min_weights">min_weights</code></td>
<td>
<p>lower bound for the individual weights estimated by REM (default = 1e-30)</p>
</td></tr>
<tr><td><code id="controlREM_+3A_max_ueps">max_ueps</code></td>
<td>
<p>percentile of the distribution of likelihood values to use as the maximum epsilon value to consider</p>
</td></tr>
<tr><td><code id="controlREM_+3A_chk_gamma">chk_gamma</code></td>
<td>
<p>gamma value used when searching for epsilon</p>
</td></tr>
<tr><td><code id="controlREM_+3A_n">n</code></td>
<td>
<p>sample size of simulated data used when checking heuristic criterion in the epsilon search</p>
</td></tr>
</table>


<h3>Value</h3>

<p>control parameters used in the REM package (steps, tol, maxiter, min_weights, ueps, n).
</p>


<h3>Author(s)</h3>

<p>Bryan Ortiz-Torres (bortiztorres@wisc.edu); Kenneth Nieser (nieser@stanford.edu)
</p>


<h3>References</h3>

<p>Nieser, K. J., &amp; Cochran, A. L. (2021). Addressing heterogeneous populations in latent variable settings through robust estimation. Psychological Methods.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+REM_EFA">REM_EFA()</a></code>, <code><a href="#topic+REM_CFA">REM_CFA()</a></code>
</p>

<hr>
<h2 id='REM_CFA'>Robust Estimation Maximization Estimates for Confirmatory Factor Analysis</h2><span id='topic+REM_CFA'></span>

<h3>Description</h3>

<p>This function uses the robust expectation maximization (REM) algorithm to estimate the parameters of a confirmatory factor analysis model as suggested by Nieser &amp; Cochran (2021).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>REM_CFA(X, delta = 0.05, model = NA, ctrREM = controlREM())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="REM_CFA_+3A_x">X</code></td>
<td>
<p>data to analyze; should be a data frame or matrix</p>
</td></tr>
<tr><td><code id="REM_CFA_+3A_delta">delta</code></td>
<td>
<p>hyperparameter between 0 and 1 that captures the researcher’s tolerance of incorrectly down-weighting data from the model (default = 0.05).</p>
</td></tr>
<tr><td><code id="REM_CFA_+3A_model">model</code></td>
<td>
<p>string variable that contains each structural equation in a new line where equalities are denoted by the symbol &quot;~&quot;.</p>
</td></tr>
<tr><td><code id="REM_CFA_+3A_ctrrem">ctrREM</code></td>
<td>
<p>control parameters (default: (steps = 25, tol = 1e-6, maxiter = 1e3, min_weights = 1e-30, max_ueps =  0.3, chk_gamma = 0.9, n = 2e4))</p>
</td></tr>
</table>


<h3>Value</h3>

<p>REM_CFA returns an object of class &quot;REM&quot;. The function <code><a href="base.html#topic+summary">summary()</a></code> is used to obtain estimated parameters from the model. An object of class &quot;REM&quot; in Confirmatory Factor Analysis is a list of outputs with four different components: the matched call (call), estimates using traditional expectation maximization (EM_output), estimates using robust expectation maximization (REM_output), and a summary table (summary_table). The list contains the following components:
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>match call</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>model frame</p>
</td></tr>
<tr><td><code>delta</code></td>
<td>
<p>hyperparameter between 0 and 1 that captures the researcher’s tolerance of incorrectly down-weighting data from the model</p>
</td></tr>
<tr><td><code>k</code></td>
<td>
<p>number of factors</p>
</td></tr>
<tr><td><code>constraints</code></td>
<td>
<p>p x k matrix of zeros and ones denoting the factors (rows) and observed variables (columns)</p>
</td></tr>
<tr><td><code>epsilon</code></td>
<td>
<p>hyperparameter on the likelihood scale</p>
</td></tr>
<tr><td><code>AIC_rem</code></td>
<td>
<p>Akaike Information Criterion</p>
</td></tr>
<tr><td><code>BIC_rem</code></td>
<td>
<p>Bayesian Information Criterion</p>
</td></tr>
<tr><td><code>mu</code></td>
<td>
<p>item intercepts</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>factor loadings</p>
</td></tr>
<tr><td><code>psi</code></td>
<td>
<p>unique variances of items</p>
</td></tr>
<tr><td><code>gamma</code></td>
<td>
<p>average weights</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>
<p>estimated REM weights</p>
</td></tr>
<tr><td><code>ind_lik</code></td>
<td>
<p>likelihood value for each individual</p>
</td></tr>
<tr><td><code>lik_rem</code></td>
<td>
<p>joint log-likelihood evaluated at REM estimates</p>
</td></tr>
<tr><td><code>lik</code></td>
<td>
<p>joint log-likelihood evaluated at EM estimates</p>
</td></tr>
<tr><td><code>summary_table</code></td>
<td>
<p>summary of EM and REM estimates, SEs, Z statistics, p-values, and 95% confidence intervals</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Bryan Ortiz-Torres (bortiztorres@wisc.edu); Kenneth Nieser (nieser@stanford.edu)
</p>


<h3>References</h3>

<p>Nieser, K. J., &amp; Cochran, A. L. (2021). Addressing heterogeneous populations in latent variable settings through robust estimation. Psychological Methods.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+REM_EFA">REM_EFA()</a></code>, <code><a href="#topic+summary.REMLA">summary.REMLA()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Creating latent model
library(lavaan)
library(GPArotation)
df &lt;- HolzingerSwineford1939
data = df[,-c(1:6)]

model &lt;- "Visual  =~  x1 + x2 + x3
         Textual =~  x4 + x5 + x6
         Speed   =~  x7 + x8 + x9"

# Modeling Confirmatory Factor Analysis
model_CFA = REM_CFA(X = data, delta = 0.05, model = model)
summary(model_CFA)

</code></pre>

<hr>
<h2 id='REM_EFA'>Robust Estimation Maximization for Exploratory Factor Analysis</h2><span id='topic+REM_EFA'></span>

<h3>Description</h3>

<p>This function uses the robust expectation maximization (REM) algorithm to estimate the parameters of an exploratory factor analysis model as suggested by Nieser &amp; Cochran (2021).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>REM_EFA(X, k_range, delta = 0.05, rotation = "oblimin", ctrREM = controlREM())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="REM_EFA_+3A_x">X</code></td>
<td>
<p>data to analyze; should be a data frame or matrix</p>
</td></tr>
<tr><td><code id="REM_EFA_+3A_k_range">k_range</code></td>
<td>
<p>vector of the number of factors to consider</p>
</td></tr>
<tr><td><code id="REM_EFA_+3A_delta">delta</code></td>
<td>
<p>hyperparameter between 0 and 1 that captures the researcher’s tolerance of incorrectly down-weighting data from the model (default = 0.05)</p>
</td></tr>
<tr><td><code id="REM_EFA_+3A_rotation">rotation</code></td>
<td>
<p>factor rotation method (default = 'oblimin'); 'varimax' is the only other available option at this time</p>
</td></tr>
<tr><td><code id="REM_EFA_+3A_ctrrem">ctrREM</code></td>
<td>
<p>control parameters (default: (steps = 25, tol = 1e-6, maxiter = 1e3, min_weights = 1e-30, max_ueps =  0.3, chk_gamma = 0.9, n = 2e4))</p>
</td></tr>
</table>


<h3>Value</h3>

<p>REM_EFA returns an object of class &quot;REM&quot;. The function <code><a href="base.html#topic+summary">summary()</a></code> is used to obtain estimated parameters from the model. An object of class &quot;REM&quot; in Exploratory Factor Analysis is a list of outputs with four different components for each number of factor: the matched call (call), estimates using traditional expectation maximization (EM_output), estimates using robust expectation maximization (REM_output), and a summary table (summary_table). The list contains the following components:
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>match call</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>model frame</p>
</td></tr>
<tr><td><code>k</code></td>
<td>
<p>number of factors</p>
</td></tr>
<tr><td><code>constraints</code></td>
<td>
<p>p x k matrix of zeros and ones denoting the factors (rows) and observed variables (columns)</p>
</td></tr>
<tr><td><code>epsilon</code></td>
<td>
<p>hyperparameter on the likelihood scale</p>
</td></tr>
<tr><td><code>AIC_rem</code></td>
<td>
<p>Akaike information criterion based on REM estimates</p>
</td></tr>
<tr><td><code>BIC_rem</code></td>
<td>
<p>Bayesian information criterion based on REM estimates</p>
</td></tr>
<tr><td><code>mu</code></td>
<td>
<p>item intercepts</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>factor loadings</p>
</td></tr>
<tr><td><code>psi</code></td>
<td>
<p>unique variances of items</p>
</td></tr>
<tr><td><code>phi</code></td>
<td>
<p>factor covariance matrix</p>
</td></tr>
<tr><td><code>gamma</code></td>
<td>
<p>average weight</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>
<p>estimated REM weights</p>
</td></tr>
<tr><td><code>ind_lik</code></td>
<td>
<p>likelihood value for each individual</p>
</td></tr>
<tr><td><code>lik_rem</code></td>
<td>
<p>joint log-likelihood evaluated at REM estimates</p>
</td></tr>
<tr><td><code>lik</code></td>
<td>
<p>joint log-likelihood evaluated at EM estimates</p>
</td></tr>
<tr><td><code>mu.se</code></td>
<td>
<p>standard errors of items intercepts</p>
</td></tr>
<tr><td><code>lambda.se</code></td>
<td>
<p>standard errors of factor loadings</p>
</td></tr>
<tr><td><code>psi.se</code></td>
<td>
<p>standard errors of unique variances of items</p>
</td></tr>
<tr><td><code>gamma.se</code></td>
<td>
<p>standard error of gamma</p>
</td></tr>
<tr><td><code>summary_table</code></td>
<td>
<p>summary of EM and REM estimates, SEs, Z statistics, p-values, and 95% confidence intervals</p>
</td></tr>
</table>
<p>The summary function can be used to obtain estimated parameters from the optimal model based on the BIC from the EM and REM algorithms.
</p>


<h3>Author(s)</h3>

<p>Bryan Ortiz-Torres (bortiztorres@wisc.edu); Kenneth Nieser (nieser@stanford.edu)
</p>


<h3>References</h3>

<p>Nieser, K. J., &amp; Cochran, A. L. (2021). Addressing heterogeneous populations in latent variable settings through robust estimation. Psychological Methods.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summary.REMLA">summary.REMLA()</a></code> for more detailed summaries, <code><a href="GPArotation.html#topic+oblimin">oblimin()</a></code> and <code><a href="stats.html#topic+varimax">varimax()</a></code> for details on the rotation
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Modeling Exploratory Factor Analysis
library(lavaan)
library(GPArotation)
df &lt;- HolzingerSwineford1939
data = df[,-c(1:6)]

model_EFA = REM_EFA( X = data, k_range = 1:3, delta = 0.05)
summary(model_EFA)

</code></pre>

<hr>
<h2 id='summary.REMLA'>Summary for Robust Estimation Maximization</h2><span id='topic+summary.REMLA'></span>

<h3>Description</h3>

<p>Summary method for class &quot;REMLA&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'REMLA'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.REMLA_+3A_object">object</code></td>
<td>
<p>an object of class &quot;REMLA&quot;, usually a result of a call to <a href="#topic+REM_EFA">REM_EFA</a>.</p>
</td></tr>
<tr><td><code id="summary.REMLA_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The summary.REM function returns estimated parameters from the optimal model based on the BIC from the EM and REM algorithms.
</p>
<p>Output include:
</p>
<table>
<tr><td><code>optimal</code></td>
<td>
<p>optimal number of factors based on BIC</p>
</td></tr>
<tr><td><code>mu</code></td>
<td>
<p>intercept</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>loadings</p>
</td></tr>
<tr><td><code>psi</code></td>
<td>
<p>variance</p>
</td></tr>
<tr><td><code>indk_lik</code></td>
<td>
<p>likelihood value for each individual</p>
</td></tr>
<tr><td><code>epsilon</code></td>
<td>
<p>hyperparameter on the likelihood scale</p>
</td></tr>
<tr><td><code>diff</code></td>
<td>
<p>differences between EM and REM</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Bryan Ortiz-Torres (bortiztorres@wisc.edu); Kenneth Nieser (nieser@wisc.edu)
</p>


<h3>References</h3>

<p>Nieser, K. J., &amp; Cochran, A. L. (2021). Addressing heterogeneous populations in latent variable settings through robust estimation. Psychological Methods.
</p>


<h3>See Also</h3>

<p>the model fitting function <code><a href="#topic+REM_EFA">REM_EFA()</a></code>, <code><a href="base.html#topic+summary">summary()</a></code>.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
