<!DOCTYPE html><html><head><title>Help for package MATA</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MATA}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#MATA'><p>Model-Averaged Tail Area Wald (MATA-Wald) Confidence Interval, Density, and Distribution</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Model-Averaged Tail Area (MATA) Confidence Interval and
Distribution</td>
</tr>
<tr>
<td>Version:</td>
<td>0.7.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Calculates Model-Averaged Tail Area Wald
    (MATA-Wald) confidence intervals, and MATA-Wald confidence densities
    and distributions, which are constructed using single-model
    frequentist estimators and model weights. See Turek and Fletcher
    (2012) &lt;<a href="https://doi.org/10.1016%2Fj.csda.2012.03.002">doi:10.1016/j.csda.2012.03.002</a>&gt; and Fletcher et al (2019)
    &lt;<a href="https://doi.org/10.1007%2Fs10651-019-00432-5">doi:10.1007/s10651-019-00432-5</a>&gt; for details.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-03-28 11:34:57 UTC; dturek</td>
</tr>
<tr>
<td>Author:</td>
<td>Daniel Turek [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Daniel Turek &lt;danielturek@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-03-28 14:40:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='MATA'>Model-Averaged Tail Area Wald (MATA-Wald) Confidence Interval, Density, and Distribution</h2><span id='topic+MATA'></span><span id='topic+mata'></span><span id='topic+mata.wald'></span><span id='topic+dmata.wald'></span><span id='topic+pmata.wald'></span>

<h3>Description</h3>

<p>Functions for computing the Model-Averaged Tail Area Wald (MATA-Wald) confidence interval, density, and distribution. These are all constructed using single-model frequentist estimators and model weights.  See details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mata.wald(
  theta.hats,
  se.theta.hats,
  model.weights,
  mata.t,
  residual.dfs,
  alpha = 0.025
)

dmata.wald(
  theta,
  theta.hats,
  se.theta.hats,
  model.weights,
  mata.t,
  residual.dfs
)

pmata.wald(
  theta,
  theta.hats,
  se.theta.hats,
  model.weights,
  mata.t,
  residual.dfs
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MATA_+3A_theta.hats">theta.hats</code></td>
<td>
<p>A numeric vector containing the parameter estimates under each  candidate model.</p>
</td></tr>
<tr><td><code id="MATA_+3A_se.theta.hats">se.theta.hats</code></td>
<td>
<p>A numeric vector containing the estimated standard error of each value in <code>theta.hats</code>.  If an element is zero, this corresponds to the parameter being fixed to the value give in <code>theta.hats</code> under a particular candidate model.</p>
</td></tr>
<tr><td><code id="MATA_+3A_model.weights">model.weights</code></td>
<td>
<p>A vector containing the weights for each candidate model (e.g. AIC weights or stacking weights). All model weights must be non-negative, and sum to one.</p>
</td></tr>
<tr><td><code id="MATA_+3A_mata.t">mata.t</code></td>
<td>
<p>Logical.  TRUE for the normal linear model case, and FALSE otherwise.  When TRUE, the argument <code>residual.dfs</code> must also be supplied.</p>
</td></tr>
<tr><td><code id="MATA_+3A_residual.dfs">residual.dfs</code></td>
<td>
<p>A vector containing the residual (error) degrees of freedom under each candidate model.  This argument must be provided when <code>mata.t = TRUE</code>.</p>
</td></tr>
<tr><td><code id="MATA_+3A_alpha">alpha</code></td>
<td>
<p>For <code>mata.wald</code> only, the desired lower and upper error rate. The value 0.025 corresponds to a 95% MATA-Wald confidence interval, and 0.05 to a 90% interval. Must be between 0 and 0.5. Default value is 0.025.</p>
</td></tr>
<tr><td><code id="MATA_+3A_theta">theta</code></td>
<td>
<p>For <code>dmata.wald</code> and <code>pmata.wald</code> only, a vector of theta values at which to evaluate the model-averaged confidence density or distribution function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>mata.wald</code> may be used to construct model-averaged confidence intervals, using the Model-Averaged Tail Area (MATA) construction (see Turek and Fletcher (2012) for details). The idea underlying this construction is similar to that of a model-averaged Bayesian credible interval.  This function returns the lower and upper confidence limits of a MATA-Wald interval.
</p>
<p>Closely related, the <code>dmata.wald</code> and <code>pmata.wald</code> functions evaluate the MATA-Wald confidence density and confidence distribution functions, which were developed by Fletcher et al. (2019).
</p>
<p>Two usages are supported.  For the normal linear model, or any other model where a t-based interval is appropriate (e.g., quasi-poisson), using option <code>mata.t = TRUE</code> corresponds to a MATA-Wald confidence interval, density, or distribution corresponding to the solutions of equations (2) and (3) of Turek and Fletcher (2012).  The argument <code>residual.dfs</code> is required for this usage.
</p>
<p>When the sampling distribution for the estimator is asymptotically normal (e.g. MLEs), possibly after a transformation, use option <code>mata.t = FALSE</code>. This corresponds to solutions to the equations in Section 3.2 of Turek and Fletcher (2012).
</p>
<p>If the parameter is fixed to a certain value under one or more candidate models, this value should be provided in the <code>theta.hats</code> argument, along with a corresponding value of zero in <code>se.theta.hats</code>.  For the model-averaged confidence density, this results in a point mass equal to the sum of the weights for these models.
</p>


<h3>Author(s)</h3>

<p>Daniel Turek
</p>


<h3>References</h3>

<p>Turek, D. and Fletcher, D. (2012). Model-Averaged Wald Confidence Intervals. Computational Statistics and Data Analysis, 56(9): 2809-2815.
</p>
<p>Fletcher, D. (2018). Model Averaging. Berlin, Heidelberg: Springer Briefs in Statistics.
</p>
<p>Fletcher, D., Dillingham, P. W., and Zeng, J. (2019). Model-averaged confidence distributions. Environmental and Ecological Statistics, 26: 367â€“384.
</p>


<h3>See Also</h3>

<p>mata.wald, dmata.wald, pmata.wald
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Normal linear prediction:
# Generate single-model Wald and model-averaged MATA-Wald 95% confidence intervals
#
# Data 'y', covariates 'x1' and 'x2', all vectors of length 'n'.
# 'y' taken to have a normal distribution.
# 'x1' specifies treatment/group (factor).
# 'x2' a continuous covariate.
#
# Take the quantity of interest (theta) as the predicted response 
# (expectation of y) when x1=1 (second group/treatment), and x2=15.

set.seed(0)
n = 20                              # 'n' is assumed to be even
x1 = c(rep(0,n/2), rep(1,n/2))      # two groups: x1=0, and x1=1
x2 = rnorm(n, mean=10, sd=3)
y = rnorm(n, mean = 3*x1 + 0.1*x2)  # data generation

x1 = factor(x1)
m1 = glm(y ~ x1)                    # using 'glm' provides AIC values.
m2 = glm(y ~ x1 + x2)               # using 'lm' doesn't.
aic = c(m1$aic, m2$aic)
delta.aic = aic - min(aic)
model.weights = exp(-0.5*delta.aic) / sum(exp(-0.5*delta.aic))
residual.dfs = c(m1$df.residual, m2$df.residual)

p1 = predict(m1, se=TRUE, newdata=list(x1=factor(1), x2=15))
p2 = predict(m2, se=TRUE, newdata=list(x1=factor(1), x2=15))
theta.hats = c(p1$fit, p2$fit)
se.theta.hats = c(p1$se.fit, p2$se.fit)

#  AIC model weights
model.weights

#  95% Wald confidence interval for theta (under Model 1)
theta.hats[1] + c(-1,1)*qt(0.975, residual.dfs[1])*se.theta.hats[1]

#  95% Wald confidence interval for theta (under Model 2)
theta.hats[2] + c(-1,1)*qt(0.975, residual.dfs[2])*se.theta.hats[2]

#  95% MATA-Wald confidence interval for theta:
mata.wald(theta.hats, se.theta.hats, model.weights, mata.t = TRUE, residual.dfs = residual.dfs)

#  Plot the model-averaged confidence density and distribution functions
#  on the interval [2, 7]
thetas &lt;- seq(2, 7, by = 0.1)

dens &lt;- dmata.wald(thetas, theta.hats, se.theta.hats, model.weights,
                  mata.t = TRUE, residual.dfs = residual.dfs)

dists &lt;- pmata.wald(thetas, theta.hats, se.theta.hats, model.weights,
                   mata.t = TRUE, residual.dfs = residual.dfs)

par(mfrow = c(2,1))
plot(thetas, dens, type = 'l', main = 'Model-Averaged Confidence Density')
plot(thetas, dists, type = 'l', main = 'Model-Averaged Confidence Distribution')

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
