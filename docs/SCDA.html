<!DOCTYPE html><html lang="en-US"><head><title>Help for package SCDA</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SCDA}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Data2010'><p>Spatial dataset to replicate the results for 2010 from Cerqueti, R., Maranzano, P. &amp; Mattera, R. &quot;Spatially-clustered spatial autoregressive models with application to agricultural market concentration in Europe&quot;. arXiv preprints (&lt;https://doi.org/10.48550/arXiv.2407.15874&gt;</p></a></li>
<li><a href='#Data2020'><p>Spatial dataset to replicate the results for 2020 from Cerqueti, R., Maranzano, P. &amp; Mattera, R. &quot;Spatially-clustered spatial autoregressive models with application to agricultural market concentration in Europe&quot;. arXiv preprints (&lt;https://doi.org/10.48550/arXiv.2407.15874&gt;)</p></a></li>
<li><a href='#Elbow_finder'><p>Automatically selects the optimal number of clusters based on elbow criterion.</p></a></li>
<li><a href='#listW'><p>List of 222 spatial weights (style = &quot;W&quot;, zero.policy=TRUE) used in Cerqueti, R., Maranzano, P. &amp; Mattera, R. &quot;Spatially-clustered spatial autoregressive models with application to agricultural market concentration in Europe&quot;. arXiv preprints (&lt;https://doi.org/10.48550/arXiv.2407.15874&gt;)</p></a></li>
<li><a href='#SC_AMKM'><p>Spatial Clustering for sf data</p></a></li>
<li><a href='#SCSR_Estim'><p>Estimate spatially-clustered spatial regression models</p></a></li>
<li><a href='#SCSR_InfoCrit'><p>Automatically select the optimal number of clusters based on likelihood information criteria (i.e., AIC, BIC and HQC) for a given SCSR model.</p></a></li>
<li><a href='#SpatReg_Extract'><p>Extracts numerical values for the estimated regression parameters (i.e., spatial coefficients, regression coefficients, and residuals variance) for a given spatial regression model of class <code>lm</code> or <code>Sarlm</code>.</p></a></li>
<li><a href='#SpatReg_GoF'><p>Computes a set of goodness-of-fit indices (e.g., likelihood-based information criteria, Wald and LR test, Moran's I statistic) for a given spatial regression model of class <code>lm</code> or <code>Sarlm</code>.</p></a></li>
<li><a href='#SpatReg_Perf'><p>Computes a set of in-sample performance metrics (i.e., AIC, BIC, RMSE, Sigma, and Pseudo R<code class="reqn">^2</code>) for a given spatial regression model of class <code>lm</code> or <code>Sarlm</code>.</p></a></li>
<li><a href='#SpatReg_PseudoR2'><p>Computes the Pseudo R<code class="reqn">^2</code> metric for a given spatial regression model of class <code>lm</code> or <code>Sarlm</code>.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Spatially-Clustered Data Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>0.0.2</td>
</tr>
<tr>
<td>Description:</td>
<td>Contains functions for statistical data analysis based on spatially-clustered techniques.
    The package allows estimating the spatially-clustered spatial regression models presented in Cerqueti, Maranzano \&amp; Mattera (2024), "Spatially-clustered spatial autoregressive models
    with application to agricultural market concentration in Europe", arXiv preprint 2407.15874 &lt;<a href="https://doi.org/10.48550%2FarXiv.2407.15874">doi:10.48550/arXiv.2407.15874</a>&gt;.
    Specifically, the current release allows the estimation of the spatially-clustered linear regression model (SCLM), the spatially-clustered spatial autoregressive model (SCSAR),
    the spatially-clustered spatial Durbin model (SCSEM), and the spatially-clustered linear regression model with spatially-lagged exogenous covariates (SCSLX).
    From release 0.0.2, the library contains functions to estimate spatial clustering based on Adiajacent Matrix K-Means (AMKM) as described in Zhou, Liu \&amp; Zhu (2019), "Weighted adjacent matrix for K-means clustering", Multimedia Tools and Applications, 78 (23) &lt;<a href="https://doi.org/10.1007%2Fs11042-019-08009-x">doi:10.1007/s11042-019-08009-x</a>&gt;.  </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Imports:</td>
<td>spatialreg,sp,spdep,utils,rlang,performance,stats,methods,dplyr,sf,NbClust,ggplot2,ggspatial</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>tidyverse,</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Paolo Maranzano &lt;pmaranzano.ricercastatistica@gmail.com&gt;</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-10-22 15:05:11 UTC; paulm</td>
</tr>
<tr>
<td>Author:</td>
<td>Paolo Maranzano <a href="https://orcid.org/0000-0002-9228-2759"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre, cph],
  Raffaele Mattera <a href="https://orcid.org/0000-0001-8770-7049"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cph],
  Camilla Lionetti [aut, cph],
  Francesco Caccia [aut, cph]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-10-22 21:50:10 UTC</td>
</tr>
</table>
<hr>
<h2 id='Data2010'>Spatial dataset to replicate the results for 2010 from Cerqueti, R., Maranzano, P. &amp; Mattera, R. &quot;Spatially-clustered spatial autoregressive models with application to agricultural market concentration in Europe&quot;. arXiv preprints (&lt;https://doi.org/10.48550/arXiv.2407.15874&gt;</h2><span id='topic+Data2010'></span>

<h3>Description</h3>

<p>The 'Data_RC_PM_RM_JABES2024' dataset was created merging information from the Eurostat regional database (&lt;https://ec.europa.eu/eurostat/web/regions/database&gt;).
it is a spatial dataset to replicate the results for 2010 from Cerqueti, R., Maranzano, P. &amp; Mattera, R. &quot;Spatially-clustered spatial autoregressive models with application to agricultural market concentration in Europe&quot;. arXiv preprints (&lt;https://doi.org/10.48550/arXiv.2407.15874&gt;).
Data contained in this file refer to the agricultural sector industry for 222 European regions (NUTS-2 classification) for 2010.
For more information see the database 'Economic accounts for agriculture by NUTS 2 region' (agr_r_accts, DOI:10.2908/agr_r_accts).
The file includes 6 mixed-type objects:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Data_RC_PM_RM_JABES2024)
</code></pre>


<h3>Format</h3>


<p><code>Data2010</code> is a spatial data frame (sf/data.frame) with 222 rows, 13 variables and a geometry representing the regions' polygons:
</p>
<dl>
<dt>Year</dt><dd><p>Reference year for the data, that is, 2010</p>
</dd>
<dt>geo_lab</dt><dd><p>Extended name (English-translated) of the regions</p>
</dd>
<dt>geo</dt><dd><p>Eurostat NUTS-2 code of the regions</p>
</dd>
<dt>Gini_SO</dt><dd><p>Gini index for the standard output of farms and agricultural holdings in each region</p>
</dd>
<dt>GDPPC_PPS2020</dt><dd><p>Regional per capita GDP measured as Euros PPS 2020</p>
</dd>
<dt>Share_AgroEmp</dt><dd><p>Share of employment in agriculture: relevance of agricultural industry on the regional labor market</p>
</dd>
<dt>HoursWorked_AgroEmp</dt><dd><p>Hours worked per agro-employed: agricultural labor market intensity</p>
</dd>
<dt>GVA_AgroEmp</dt><dd><p>Gross value added per agro-employed: agricultural productivity intensity</p>
</dd>
<dt>GFCF_AgroEmp</dt><dd><p>Investment per agro-employed: propensity to invest according to the economic size</p>
</dd>
<dt>Share_AgroGVA</dt><dd><p>Share of agricultural GVA on total GVA: relevance of agricultural industry on the regional economy</p>
</dd>
<dt>Share_AgroLand</dt><dd><p>Share of agricultural land: relevance of agricultural industry on the regional activities</p>
</dd>
<dt>Alt_mean</dt><dd><p>Average altitude: geography and landscape</p>
</dd>
<dt>HDD</dt><dd><p>Heating degree days (HDD): proxy of temperature and weather conditions</p>
</dd>
</dl>



<h3>Note</h3>


<p>All source data files prepared by Paolo Maranzano (Department of Economics, Management and Statistics, University of Milano-Bicocca, Italy).

</p>


<h3>Source</h3>


<p>Eurostat &ndash; Economic accounts for agriculture by NUTS 2 region' (agr_r_accts, DOI:10.2908/agr_r_accts)

</p>

<hr>
<h2 id='Data2020'>Spatial dataset to replicate the results for 2020 from Cerqueti, R., Maranzano, P. &amp; Mattera, R. &quot;Spatially-clustered spatial autoregressive models with application to agricultural market concentration in Europe&quot;. arXiv preprints (&lt;https://doi.org/10.48550/arXiv.2407.15874&gt;)</h2><span id='topic+Data2020'></span>

<h3>Description</h3>

<p>The 'Data_RC_PM_RM_JABES2024' dataset was created merging information from the Eurostat regional database (&lt;https://ec.europa.eu/eurostat/web/regions/database&gt;).
it is a spatial dataset to replicate the results for 2020 from Cerqueti, R., Maranzano, P. &amp; Mattera, R. &quot;Spatially-clustered spatial autoregressive models with application to agricultural market concentration in Europe&quot;. arXiv preprints (&lt;https://doi.org/10.48550/arXiv.2407.15874&gt;).
Data contained in this file refer to the agricultural sector industry for 222 European regions (NUTS-2 classification) for 2020.
For more information see the database 'Economic accounts for agriculture by NUTS 2 region' (agr_r_accts, DOI:10.2908/agr_r_accts).
The file includes 6 mixed-type objects:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Data_RC_PM_RM_JABES2024)
</code></pre>


<h3>Format</h3>


<p><code>Data2020</code> is a data frame with 222 rows, 13 variables and a geometry representing the regions' polygons:
</p>
<dl>
<dt>Year</dt><dd><p>Reference year for the data, that is, 2020</p>
</dd>
<dt>geo_lab</dt><dd><p>Extended name (English-translated) of the regions</p>
</dd>
<dt>geo</dt><dd><p>Eurostat NUTS-2 code of the regions</p>
</dd>
<dt>Gini_SO</dt><dd><p>Gini index for the standard output of farms and agricultural holdings in each region</p>
</dd>
<dt>GDPPC_PPS2020</dt><dd><p>Regional per capita GDP measured as Euros PPS 2020</p>
</dd>
<dt>Share_AgroEmp</dt><dd><p>Share of employment in agriculture: relevance of agricultural industry on the regional labor market</p>
</dd>
<dt>HoursWorked_AgroEmp</dt><dd><p>Hours worked per agro-employed: agricultural labor market intensity</p>
</dd>
<dt>GVA_AgroEmp</dt><dd><p>Gross value added per agro-employed: agricultural productivity intensity</p>
</dd>
<dt>GFCF_AgroEmp</dt><dd><p>Investment per agro-employed: propensity to invest according to the economic size</p>
</dd>
<dt>Share_AgroGVA</dt><dd><p>Share of agricultural GVA on total GVA: relevance of agricultural industry on the regional economy</p>
</dd>
<dt>Share_AgroLand</dt><dd><p>Share of agricultural land: relevance of agricultural industry on the regional activities</p>
</dd>
<dt>Alt_mean</dt><dd><p>Average altitude: geography and landscape</p>
</dd>
<dt>HDD</dt><dd><p>Heating degree days (HDD): proxy of temperature and weather conditions</p>
</dd>
</dl>



<h3>Note</h3>


<p>All source data files prepared by Paolo Maranzano (Department of Economics, Management and Statistics, University of Milano-Bicocca, Italy).

</p>


<h3>Source</h3>


<p>Eurostat &ndash; Economic accounts for agriculture by NUTS 2 region' (agr_r_accts, DOI:10.2908/agr_r_accts)

</p>

<hr>
<h2 id='Elbow_finder'>Automatically selects the optimal number of clusters based on elbow criterion.</h2><span id='topic+Elbow_finder'></span>

<h3>Description</h3>

<p>Automatically selects the optimal number of clusters (X-axis) based on elbow criterion computed on a metric (Y-axis).
Potential metrics are the AIC and the BIC. The function can be applied to any other context in which the objective is to find the optimal X producing an elbow in Y.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Elbow_finder(x, y, Plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Elbow_finder_+3A_x">x</code></td>
<td>
<p>Numeric (m x 1) <code>vector</code> of integer values (usually, the number of clusters from 1 to G)</p>
</td></tr>
<tr><td><code id="Elbow_finder_+3A_y">y</code></td>
<td>
<p>Numeric (m x 1) <code>vector</code> of values (usually, the criterion values) associated with the number of groups.</p>
</td></tr>
<tr><td><code id="Elbow_finder_+3A_plot">Plot</code></td>
<td>
<p><code>Logical</code> value (<code>TRUE</code> or <code>FALSE</code>). If <code>Plot = TRUE</code> a plot of the relationship between x and y is produced.
The plot is a scatterplot with connecting lines. A vertical line is depicted in correspondence of the optimal value of x.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the following outputs:
</p>

<ul>
<li><p>x_max_dist: optimal value of x (i.e., the x satisfying the elbow rule)
</p>
</li>
<li><p>y_max_dist: optimal value of y (i.e., the y satisfying the elbow rule) 
</p>
</li>
<li><p>Scatterplot (non-compulsory) of x and y with connecting lines and vertical line in correspondence of the optimal value of x.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>## Compute the Elbow criterion on two generic vectors x and y
x &lt;- 1:10
y &lt;- c(10,9,6,5,4,3,2,1,1,1)
Elbow_finder(x,y,Plot = TRUE)


</code></pre>

<hr>
<h2 id='listW'>List of 222 spatial weights (style = &quot;W&quot;, zero.policy=TRUE) used in Cerqueti, R., Maranzano, P. &amp; Mattera, R. &quot;Spatially-clustered spatial autoregressive models with application to agricultural market concentration in Europe&quot;. arXiv preprints (&lt;https://doi.org/10.48550/arXiv.2407.15874&gt;)</h2><span id='topic+listW'></span>

<h3>Description</h3>

<p>The 'Data_RC_PM_RM_JABES2024' dataset was created merging information from the Eurostat regional database (&lt;https://ec.europa.eu/eurostat/web/regions/database&gt;).
it is a spatial dataset to replicate the results for 2020 from Cerqueti, R., Maranzano, P. &amp; Mattera, R. &quot;Spatially-clustered spatial autoregressive models with application to agricultural market concentration in Europe&quot;. arXiv preprints (&lt;https://doi.org/10.48550/arXiv.2407.15874&gt;).
Data contained in this file refer to the agricultural sector industry for 222 European regions (NUTS-2 classification) for 2020.
For more information see the database 'Economic accounts for agriculture by NUTS 2 region' (agr_r_accts, DOI:10.2908/agr_r_accts).
The file includes 6 mixed-type objects:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Data_RC_PM_RM_JABES2024)
</code></pre>


<h3>Format</h3>


<p><code>listW</code> is a list of 222 spatial weights (style = &quot;W&quot;, zero.policy=TRUE) for the European NUTS-2 regions

</p>


<h3>Note</h3>


<p>All source data files prepared by Paolo Maranzano (Department of Economics, Management and Statistics, University of Milano-Bicocca, Italy).

</p>


<h3>Source</h3>


<p>Eurostat &ndash;  GISCO Territorial units for statistics (NUTS) (https://ec.europa.eu/eurostat/web/gisco/geodata/statistical-units/territorial-units-statistics)

</p>

<hr>
<h2 id='SC_AMKM'>Spatial Clustering for sf data</h2><span id='topic+SC_AMKM'></span>

<h3>Description</h3>

<p>Perform spatial clustering using K-means and AMKM (Adjacent Matrix K-Means) algorithms on sf data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SC_AMKM(
  Data_sf,
  IndexCol,
  Method,
  Distance = "euclidean",
  MinNc = 2,
  MaxNc = 10,
  Metric = "silhouette",
  RidDim = "pca",
  CenterVars = T,
  ScaleVars = T,
  MakePlot = T,
  ExplainedVariance = 0.9,
  KeepCoord = T,
  Seed = 123456789,
  Verbose = T,
  CRS = 4326
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SC_AMKM_+3A_data_sf">Data_sf</code></td>
<td>
<p>A <code>data.frame</code> object of class <code>sf</code> with n rows (each one corresponding to a location) and a user-defined number of columns.
It must include the <code>geometry</code> feature for spatial modelling and representation.
Typically, <code>sf</code> <code>data.frame</code> are built using the <code>st_as_sf(...)</code> command from the <code>sf</code> package (see its documentation for details).</p>
</td></tr>
<tr><td><code id="SC_AMKM_+3A_indexcol">IndexCol</code></td>
<td>
<p><code>Integer</code> value. Number of the dataset ID column. If there isn't an ID column <code>IndexCol=0</code>.</p>
</td></tr>
<tr><td><code id="SC_AMKM_+3A_method">Method</code></td>
<td>
<p><code>Character</code>. Must be one of: 'AMKM' or 'K-means'. If <code>method='AMKM'</code>, the Adjacent Matrix K-Means clustering is performed. If <code>method='K-means'</code>, K-means clustering is performed.</p>
</td></tr>
<tr><td><code id="SC_AMKM_+3A_distance">Distance</code></td>
<td>
<p><code>Character</code>. The distance measure to be used to compute the dissimilarity matrix. This must be one of: &quot;euclidean&quot;, &quot;maximum&quot;, &quot;manhattan&quot;, &quot;canberra&quot;, &quot;binary&quot;, &quot;minkowski&quot;. By default, <code>distance='euclidean'</code>.</p>
</td></tr>
<tr><td><code id="SC_AMKM_+3A_minnc">MinNc</code></td>
<td>
<p><code>Integer</code> value. Minimal number of clusters, between 1 and (number of objects - 1). Default is <code>MinNc=2</code>.</p>
</td></tr>
<tr><td><code id="SC_AMKM_+3A_maxnc">MaxNc</code></td>
<td>
<p><code>Integer</code> value. Maximal number of clusters, between 2 and (number of objects - 1), greater or equal to MinNc. Default is <code>MaxNc=10</code>.</p>
</td></tr>
<tr><td><code id="SC_AMKM_+3A_metric">Metric</code></td>
<td>
<p><code>Character</code>. The validation index to be calculated for the selection of the optimal clustering partition. This should be one of : &quot;kl&quot;, &quot;ch&quot;, &quot;hartigan&quot;, &quot;ccc&quot;, &quot;scott&quot;, &quot;marriot&quot;, &quot;trcovw&quot;, &quot;tracew&quot;, &quot;friedman&quot;, &quot;rubin&quot;, &quot;cindex&quot;, &quot;db&quot;, &quot;silhouette&quot;, &quot;duda&quot;, &quot;pseudot2&quot;, &quot;beale&quot;, &quot;ratkowsky&quot;, &quot;ball&quot;, &quot;ptbiserial&quot;, &quot;gap&quot;, &quot;frey&quot;, &quot;mcclain&quot;, &quot;gamma&quot;, &quot;gplus&quot;, &quot;tau&quot;, &quot;dunn&quot;, &quot;hubert&quot;, &quot;sdindex&quot;, &quot;dindex&quot;, &quot;sdbw&quot;, &quot;all&quot; (all indices except GAP, Gamma, Gplus and Tau), &quot;alllong&quot; (all indices with Gap, Gamma, Gplus and Tau included).
Default is <code>Metric='silhouette'</code>.</p>
</td></tr>
<tr><td><code id="SC_AMKM_+3A_riddim">RidDim</code></td>
<td>
<p><code>Character</code>.The dimensionality reduction method. This should be one of : 'pca' or 'laplacian'. if 'RidDim='pca&rdquo;, a principal component analysis is performed. if 'RidDim='laplacian&rdquo; the laplacian matrix dimensionality reduction method is performed . Default is <code>RidDim='pca'</code>.</p>
</td></tr>
<tr><td><code id="SC_AMKM_+3A_centervars">CenterVars</code></td>
<td>
<p><code>Logical</code> value (<code>TRUE</code> or <code>FALSE</code>) stating whether the features have to be centered around the mean. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="SC_AMKM_+3A_scalevars">ScaleVars</code></td>
<td>
<p><code>Logical</code> value (<code>TRUE</code> or <code>FALSE</code>) stating whether the features have to be scaled with respect to their standard deviation. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="SC_AMKM_+3A_makeplot">MakePlot</code></td>
<td>
<p><code>Logical</code> value (<code>TRUE</code> or <code>FALSE</code>) stating whether the plot must be displayed. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="SC_AMKM_+3A_explainedvariance">ExplainedVariance</code></td>
<td>
<p><code>numeric</code>. cumulate percentage of the variance explained by the eigenvalues of the dimesionality reduction method. Must be between 0 and 1. Default is <code>ExplainedVariance=0.9</code>.</p>
</td></tr>
<tr><td><code id="SC_AMKM_+3A_keepcoord">KeepCoord</code></td>
<td>
<p><code>Logical</code> value (<code>TRUE</code> or <code>FALSE</code>) stating whether the coordinate must be taken into account in K-means algorithm. Available only when 'method='K-means&rdquo;. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="SC_AMKM_+3A_seed">Seed</code></td>
<td>
<p><code>Integer</code> value. Define the random number generator (RNG) state for random number generation in R.
Deafult is <code>seed = 123456789</code>.</p>
</td></tr>
<tr><td><code id="SC_AMKM_+3A_verbose">Verbose</code></td>
<td>
<p><code>Logical</code> value (<code>TRUE</code> or <code>FALSE</code>). Toggle warnings and messages. If <code>verbose = TRUE</code> (default) the function
prints on the screen some messages describing the progress of the tasks. If <code>verbose = FALSE</code> any message about the progression is suppressed. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="SC_AMKM_+3A_crs">CRS</code></td>
<td>
<p><code>Integer</code> value. Coordinate reference system. something suitable as input to st_crs.command from the <code>sf</code> package (see its documentation for details). Default is <code>CRS=4326</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>AMKM calculations is done decomposing the input dataset in two subset. The first one contains the features while the second one contains the coordinates (longitude and latitude).
A dissimilarity matrix is calculated on both subset using the parameter distance for the feature and the Great Circle distance for coordinates.
Then an adjacent matrix (n x n) is computed on every dissimilarity matrix using gaussian kernel.
To reduce the dimensionality of the adjacent matrix a dimentionality reduction method is necessary (see RidDim param. for more)
K-means is applied with no modification at its original algorithm.
</p>


<h3>Value</h3>

<p>A list object containing the following outputs:
</p>

<ul>
<li><p>df: n row dataframe with the following columns : ID, Longitude, Latitude and Cluster (the optimal partition)
</p>
</li>
<li><p>plot: Display cluster partition in a map.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Camilla Lionetti &lt;lionetticamilla511@gmail.com&gt;, Francesco Caccia &lt;francesco.caccia2000@gmail.com&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(sp)
library(sf)
data("meuse")
dati&lt;-meuse
dati&lt;-subset(dati,select=sapply(dati,is.numeric))
dati&lt;-st_as_sf(dati, coords = c("x", "y"),crs =28992)
SC &lt;- SC_AMKM(Data_sf=dati,IndexCol=0, Method="AMKM",MinNc = 5,MaxNc = 5 ,CRS=28992)

</code></pre>

<hr>
<h2 id='SCSR_Estim'>Estimate spatially-clustered spatial regression models</h2><span id='topic+SCSR_Estim'></span>

<h3>Description</h3>

<p>Estimates spatially-clustered spatial regression (SCSR) models, such as the spatially-clustered linear regression model (SCLM),
the spatially-clustered spatial autoregressive model (SCSAR), the spatially-clustered spatial durbin model (SCSEM),
and the spatially-clustered linear regression model with spatially-lagged exogenous covariates and response variable (SCSLX).
Estimation is performed via cluster-wise maximum likelihood as presented in &lt;https://arxiv.org/abs/2407.15874&gt;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SCSR_Estim(
  Formula,
  Data_sf,
  listW,
  G = 2,
  Phi = 1,
  Type = c("SCLM", "SCSAR", "SCSEM", "SCSLX"),
  CenterVars = FALSE,
  ScaleVars = FALSE,
  Maxitr = 100,
  RelTol = 10^-6,
  AbsTol = 10^-5,
  Verbose = TRUE,
  Seed = 123456789
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SCSR_Estim_+3A_formula">Formula</code></td>
<td>
<p>a symbolic description of the regression model to be fit. The details of model specification are given for <code>lm(...)</code></p>
</td></tr>
<tr><td><code id="SCSR_Estim_+3A_data_sf">Data_sf</code></td>
<td>
<p>A <code>data.frame</code> object of class <code>sf</code> with n rows (each one corresponding to a location/polygon) and a user-defined number of columns.
The data frame must contain the response variable and all the covariates to be used in the model. Also, it must include the <code>geometry</code> feature for spatial modelling and representation.
Typically, <code>sf</code> <code>data.frame</code> are built using the <code>st_as_sf(...)</code> command from the <code>sf</code> package (see its documentation for details).</p>
</td></tr>
<tr><td><code id="SCSR_Estim_+3A_listw">listW</code></td>
<td>
<p><code>listw</code> object. It contains the spatial weights for the spatial autoregressive component.
Typically, listW is built using the <code>nb2listw(...)</code> command from the <code>spdep</code> package (see its documentation for details).
We suggest to adopt one of matrix styles suggested in the <code>spdep</code> package, such as <code>W</code> (row-standardized) or <code>B</code> (binary).
We also suggest to adopt a <code>zero.policy = TRUE</code> option to allow the computation of groups/clusters with isolated units. In this regard, we recall that if <code>zero.policy = FALSE</code> and <code>Type = "SCSAR"</code> causes <code>SCSR_Estim(...)</code> to terminate with an error.
See package <code>spatialreg</code> for details on the <code>zero.policy</code> input.</p>
</td></tr>
<tr><td><code id="SCSR_Estim_+3A_g">G</code></td>
<td>
<p>Integer value. Number of clusters to be considered. When 'G=1', the pooled regression (no clusterwise) is estimated. Default is 'G = 2'.</p>
</td></tr>
<tr><td><code id="SCSR_Estim_+3A_phi">Phi</code></td>
<td>
<p>Non-negative (&gt;=0) real value. Spatial penalty parameter. Default is 'Phi = 1'.</p>
</td></tr>
<tr><td><code id="SCSR_Estim_+3A_type">Type</code></td>
<td>
<p>Character. Declares which model specification has to be estimated. Admitted strings are:
</p>

<ul>
<li><p><code>"SCLM"</code> for linear regression model without spatial effects (LM);
</p>
</li>
<li><p><code>"SCSAR"</code> for spatial autoregressive (SAR) model;
</p>
</li>
<li><p><code>"SCSEM"</code> for linear regression model with spatial autoregressive error term or spatial Durbin model (SEM);
</p>
</li>
<li><p><code>"SCSLX"</code> for linear regression model with spatially-lagged response variable and covariates (SLX);
</p>
</li></ul>
</td></tr>
<tr><td><code id="SCSR_Estim_+3A_centervars">CenterVars</code></td>
<td>
<p><code>Logical</code> value (<code>TRUE</code> or <code>FALSE</code>) stating whether the response variable and the covariates have to be centered around the mean in the iterative algorithm to update memberships and group-wise parameters.
Centering is only use in the iterative procedure, while final estimates provided to the user are computed original (i.e., non-centered) variables.</p>
</td></tr>
<tr><td><code id="SCSR_Estim_+3A_scalevars">ScaleVars</code></td>
<td>
<p><code>Logical</code> value (<code>TRUE</code> or <code>FALSE</code>) stating whether the response variable and the covariates have to be scaled with respect to their standard deviation in the iterative algorithm to update memberships and group-wise parameters.
Scaling is only used in the iterative procedure, while final estimates provided to the user are computed original (i.e., non-scaled) variables.</p>
</td></tr>
<tr><td><code id="SCSR_Estim_+3A_maxitr">Maxitr</code></td>
<td>
<p>Integer value. Maximum number of iterations for the iterative algorithm. Convergence criterion is fixed to  <code class="reqn">\varepsilon</code> = 10^(-5).</p>
</td></tr>
<tr><td><code id="SCSR_Estim_+3A_reltol">RelTol</code></td>
<td>
<p>Tolerance for the relative improvement in the log-likelihood (exit criterion) from iteration k to k+1. Default is <code class="reqn">\varepsilon_{Rel}</code> = 10^-6</p>
</td></tr>
<tr><td><code id="SCSR_Estim_+3A_abstol">AbsTol</code></td>
<td>
<p>Tolerance for the absolute improvement in the log-likelihood (exit criterion) from iteration k to k+1. Default is <code class="reqn">\varepsilon_{Abs}</code> = 10^-5</p>
</td></tr>
<tr><td><code id="SCSR_Estim_+3A_verbose">Verbose</code></td>
<td>
<p><code>Logical</code> value (<code>TRUE</code> or <code>FALSE</code>). Toggle warnings and messages. If <code>verbose = TRUE</code> (default) the function
prints on the screen some messages describing the progress of the tasks. If <code>verbose = FALSE</code> any message about the progression is suppressed.</p>
</td></tr>
<tr><td><code id="SCSR_Estim_+3A_seed">Seed</code></td>
<td>
<p>Integer value. Define the random number generator (RNG) state for random number generation in R.
Deafult is <code>seed = 123456789</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The package <code>SCSR</code> computes the spatially-clustered spatial regression models based on the <code>spatialreg</code> package (see &lt;https://cran.r-project.org/web/packages/spatialreg/index.html&gt;).
SCSAR model is estimated using the function <code>lagsarlm</code>; SCSEM model is estimated using the function <code>errorsarlm</code>; SCSLX model is estimated using the function <code>lmSLX</code>.
SCLM model is estimated using the <code>lm</code> function from package <code>stats</code>.
Thus, estimated SCSAR, SCSEM and SCSLX models belong to class <code>Sarlm</code>, while estimated SCLM belongs to class <code>lm</code>.
We kindly refer to the package <code>spatialreg</code> for any detail regarding computational aspects (e.g., optimization).
Also, we refer to the package <code>spdep</code> for computational details on the spatial weighting matrix via <code>listw2mat(...)</code>, <code>nb2listw(...)</code> and <code>nb2mat(...)</code> from the <code>spdep</code> package.
For computional details on the spatially-clustered models, we kindly refer to Cerqueti, R., Maranzano, P. &amp; Mattera, R. &quot;Spatially-clustered spatial autoregressive models with application to agricultural market concentration in Europe&quot;. arXiv preprints (&lt;doi:10.48550/arXiv.2407.15874&gt;)
</p>


<h3>Value</h3>

<p>A list object containing the following outputs:
</p>

<ul>
<li><p>ClusterFitModels: G-dimensional list containing the estimated clustered regression models of class <code>lm</code> or <code>Sarlm</code>
</p>
</li>
<li><p>Beta: (G x p) matrix of cluster-wise or pooled regression coefficients
</p>
</li>
<li><p>Sig: G-dimensional vector of cluster-wise standard deviations
</p>
</li>
<li><p>VCov: (p x p x G) array of cluster-wise variance-covariance matrices of coefficients
</p>
</li>
<li><p>W_g: G-dimensional list containing for the g-th cluster with cardinality n_g a (n_g x n_g) spatial weighting matrix
</p>
</li>
<li><p>listW_g: G-dimensional list containing for the g-th cluster the weights list
</p>
</li>
<li><p>Group: (n x 1) vector of group assignment
</p>
</li>
<li><p>sBeta: (n x p) matrix of location-wise regression coefficients
</p>
</li>
<li><p>sSig: (n x 1) vector of location-wise standard deviations
</p>
</li>
<li><p>MLE: Estimated maximum log-likelihood
</p>
</li>
<li><p>Iter: The number of iteration needed to satisfy the convergence criterion and end up the clustering iterative loop
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>data(Data_RC_PM_RM_JABES2024, package="SCDA")
SCSAR &lt;- SCSR_Estim(Formula = "Gini_SO ~ GDPPC_PPS2020 + Share_AgroEmp",
                    Data_sf = Data2020, G=3, listW=listW, Type="SCSAR", Phi = 0.50)
SCLM &lt;- SCSR_Estim(Formula = "Gini_SO ~ GDPPC_PPS2020 + Share_AgroEmp",
                   Data_sf = Data2020, G=3, listW=listW, Type="SCLM", Phi = 0.50)


</code></pre>

<hr>
<h2 id='SCSR_InfoCrit'>Automatically select the optimal number of clusters based on likelihood information criteria (i.e., AIC, BIC and HQC) for a given SCSR model.</h2><span id='topic+SCSR_InfoCrit'></span>

<h3>Description</h3>

<p>Computes the likelihood-based information criteria (i.e, Akaike's IC, Bayesian IC, and Hannan–Quinn IC) for every SCSR model given by the combination of the G and Phi contained in the <code>G.set</code> and <code>Phi.set</code> inputs and provides the associated likelihood-based information criteria.
Given the minimization rule, <code>SCSR_InfoCrit</code> automatically identifies the optimal number of clusters for every criterion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SCSR_InfoCrit(
  Formula,
  Data_sf,
  listW,
  Phi.set = c(0.5, 1),
  G.set = c(2, 3, 4),
  Type = c("SCLM", "SCSAR", "SCSEM", "SCSLX"),
  CenterVars = TRUE,
  ScaleVars = TRUE,
  Maxitr = 200,
  RelTol = 10^-6,
  AbsTol = 10^-5,
  Verbose = TRUE,
  Seed = 123456789
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SCSR_InfoCrit_+3A_formula">Formula</code></td>
<td>
<p>a symbolic description of the regression model to be fit. The details of model specification are given for <code>lm(...)</code></p>
</td></tr>
<tr><td><code id="SCSR_InfoCrit_+3A_data_sf">Data_sf</code></td>
<td>
<p>A <code>data.frame</code> object of class <code>sf</code> with n rows (each one corresponding to a location/polygon) and a user-defined number of columns.
The data frame must contain the response variable and all the covariates to be used in the model. Also, it must include the <code>geometry</code> feature for spatial modelling and representation.
Typically, <code>sf</code> <code>data.frame</code> are built using the <code>st_as_sf(...)</code> command from the <code>sf</code> package (see its documentation for details).</p>
</td></tr>
<tr><td><code id="SCSR_InfoCrit_+3A_listw">listW</code></td>
<td>
<p><code>listw</code> object. It contains the spatial weights for the spatial autoregressive component.
Typically, listW is built using the <code>nb2listw(...)</code> command from the <code>spdep</code> package (see its documentation for details).
We suggest to adopt one of matrix styles suggested in the <code>spdep</code> package, such as <code>W</code> (row-standardized) or <code>B</code> (binary).
We also suggest to adopt a <code>zero.policy = TRUE</code> option to allow the computation of groups/clusters with isolated units. In this regard, we recall that if <code>zero.policy = FALSE</code> and <code>Type = "SCSAR"</code> causes <code>SCSR_Estim(...)</code> to terminate with an error.
See package <code>spatialreg</code> for details on the <code>zero.policy</code> input.</p>
</td></tr>
<tr><td><code id="SCSR_InfoCrit_+3A_phi.set">Phi.set</code></td>
<td>
<p>Non-negative (&gt;=0) real-valued vector. Sequence of spatial penalty parameter. Default is <code>Phi = c(0.50,1)</code>.</p>
</td></tr>
<tr><td><code id="SCSR_InfoCrit_+3A_g.set">G.set</code></td>
<td>
<p>Integer vector. Sequence of clusters to be considered. Default is <code>G = c(2,3,4)</code>.</p>
</td></tr>
<tr><td><code id="SCSR_InfoCrit_+3A_type">Type</code></td>
<td>
<p>Character. Declares which model specification has to be estimated. Admitted strings are:
</p>

<ul>
<li><p><code>"SCLM"</code> for linear regression model without spatial effects (LM);
</p>
</li>
<li><p><code>"SCSAR"</code> for spatial autoregressive (SAR) model;
</p>
</li>
<li><p><code>"SCSEM"</code> for linear regression model with spatial autoregressive error term or spatial Durbin model (SEM);
</p>
</li>
<li><p><code>"SCSLX"</code> for linear regression model with spatially-lagged response variable and covariates (SLX);
</p>
</li></ul>
</td></tr>
<tr><td><code id="SCSR_InfoCrit_+3A_centervars">CenterVars</code></td>
<td>
<p><code>Logical</code> value (<code>TRUE</code> or <code>FALSE</code>) stating whether the response variable and the covariates have to be centered around the mean in the iterative algorithm to update memberships and group-wise parameters.
Centering is only use in the iterative procedure, while final estimates provided to the user are computed original (i.e., non-centered) variables.</p>
</td></tr>
<tr><td><code id="SCSR_InfoCrit_+3A_scalevars">ScaleVars</code></td>
<td>
<p><code>Logical</code> value (<code>TRUE</code> or <code>FALSE</code>) stating whether the response variable and the covariates have to be scaled with respect to their standard deviation in the iterative algorithm to update memberships and group-wise parameters.
Scaling is only used in the iterative procedure, while final estimates provided to the user are computed original (i.e., non-scaled) variables.</p>
</td></tr>
<tr><td><code id="SCSR_InfoCrit_+3A_maxitr">Maxitr</code></td>
<td>
<p>Integer value. Maximum number of iterations for the iterative algorithm. Convergence criterion is fixed to  <code class="reqn">\varepsilon</code> = 10^(-5).</p>
</td></tr>
<tr><td><code id="SCSR_InfoCrit_+3A_reltol">RelTol</code></td>
<td>
<p>Tolerance for the relative improvement in the log-likelihood (exit criterion) from iteration k to k+1. Default is <code class="reqn">\varepsilon_{Rel}</code> = 10^-6</p>
</td></tr>
<tr><td><code id="SCSR_InfoCrit_+3A_abstol">AbsTol</code></td>
<td>
<p>Tolerance for the absolute improvement in the log-likelihood (exit criterion) from iteration k to k+1. Default is <code class="reqn">\varepsilon_{Abs}</code> = 10^-5</p>
</td></tr>
<tr><td><code id="SCSR_InfoCrit_+3A_verbose">Verbose</code></td>
<td>
<p><code>Logical</code> value (<code>TRUE</code> or <code>FALSE</code>). Toggle warnings and messages. If <code>verbose = TRUE</code> (default) the function
prints on the screen some messages describing the progress of the tasks. If <code>verbose = FALSE</code> any message about the progression is suppressed.</p>
</td></tr>
<tr><td><code id="SCSR_InfoCrit_+3A_seed">Seed</code></td>
<td>
<p>Integer value. Define the random number generator (RNG) state for random number generation in R.
Deafult is <code>seed = 123456789</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given the vectors G.set = c(2,3,4) and Phi.set = c(0.50,1), the function 'SCSR_InfoCrit' will compute 3x2=6 models, each at a given combination of G and Phi.
For computional details on the spatially-clustered models, we kindly refer to
Cerqueti, R., Maranzano, P. &amp; Mattera, R. &quot;Spatially-clustered spatial autoregressive models with application to agricultural market concentration in Europe&quot;. arXiv preprints (&lt;doi:10.48550/arXiv.2407.15874&gt;)
</p>


<h3>Value</h3>

<p>A list object containing the following outputs:
</p>

<ul>
<li><p>IC: a <code>data.frame</code> object containing one row for each combination of the supplied vectors G.set and Phi.set and 5 columns (G,Phi,AIC,BIC,HQC).
</p>
</li>
<li><p>OptimPars: a <code>data.frame</code> object with 3 rows (criteria) and 2 columns (Parameters) with the optimal combination of G and Phi for every criterion.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Paolo Maranzano &lt;&gt;
</p>
<p>Raffaele Mattera &lt;&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(Data_RC_PM_RM_JABES2024, package="SCDA")
SCSAR_IC &lt;- SCSR_InfoCrit(Formula = "Gini_SO ~ GDPPC_PPS2020 + Share_AgroEmp",
                          Data_sf = Data2020, listW=listW, Type="SCSAR",
                          Maxitr = 100, Phi.set = c(0.50,1), G.set=c(2,3))


</code></pre>

<hr>
<h2 id='SpatReg_Extract'>Extracts numerical values for the estimated regression parameters (i.e., spatial coefficients, regression coefficients, and residuals variance) for a given spatial regression model of class <code>lm</code> or <code>Sarlm</code>.</h2><span id='topic+SpatReg_Extract'></span>

<h3>Description</h3>

<p>Extracts the numerical values for the regression parameters (i.e., estimated spatial parameters, regression coefficients, and residuals variance) for a given spatial regression model of class <code>lm</code> or <code>Sarlm</code> as defined in package <code>spatialreg</code>.
The function can be applied to the output of any SCSR model and contained in the <code>ClusterFitModels</code> output of <code>SCSR_Estim</code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SpatReg_Extract(SRModel)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SpatReg_Extract_+3A_srmodel">SRModel</code></td>
<td>
<p>Estimated spatial or non-spatial regression model of class <code>lm</code> or <code>Sarlm</code> (see package <code>spatialreg</code> for details.)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named <code>vector</code> containing numerical values for the estimated spatial parameters (e.g.,  <code class="reqn">\rho</code> in SAR or  <code class="reqn">\lambda</code> in SEM), regression coefficients, and residuals variance for the input model in <code>SRModel</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Data_RC_PM_RM_JABES2024, package="SCDA")
SCSAR &lt;- SCSR_Estim(Formula = "Gini_SO ~ GDPPC_PPS2020 + Share_AgroEmp",
                    Data_sf = Data2020, G=3, listW=listW, Type="SCSAR", Phi = 0.50)
SpatReg_Extract(SRModel = SCSAR$ClusterFitModels[[1]])
SpatReg_Extract(SRModel = SCSAR$ClusterFitModels[[2]])
SpatReg_Extract(SRModel = SCSAR$ClusterFitModels[[3]])

</code></pre>

<hr>
<h2 id='SpatReg_GoF'>Computes a set of goodness-of-fit indices (e.g., likelihood-based information criteria, Wald and LR test, Moran's I statistic) for a given spatial regression model of class <code>lm</code> or <code>Sarlm</code>.</h2><span id='topic+SpatReg_GoF'></span>

<h3>Description</h3>

<p>Computes a set of goodness-of-fit indices (e.g., likelihood-based information criteria, Wald and LR test, Moran's I statistic) for a given spatial regression model of class <code>lm</code> or <code>Sarlm</code> as defined in package <code>spatialreg</code>.
The function can be applied to the output of any SCSR model and contained in the <code>ClusterFitModels</code> output of <code>SCSR_Estim</code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SpatReg_GoF(SRModel_list, SRModel_W_list)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SpatReg_GoF_+3A_srmodel_list">SRModel_list</code></td>
<td>
<p>List of estimated spatial or non-spatial regression model of class <code>lm</code> or <code>Sarlm</code> (see package <code>spatialreg</code> for details.)</p>
</td></tr>
<tr><td><code id="SpatReg_GoF_+3A_srmodel_w_list">SRModel_W_list</code></td>
<td>
<p>List of <code>listw</code> objects (see package <code>spdep</code> for details) containing the spatial weights for the spatial autoregressive component for the G groups.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>matrix</code> containing 15 goodness-of-fit indices (e.g., likelihood-based information criteria, Wald and LR test, Moran's I statistic) for the list of models given as a input in <code>SRModel_list</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Data_RC_PM_RM_JABES2024, package="SCDA")
SCSAR &lt;- SCSR_Estim(Formula = "Gini_SO ~ GDPPC_PPS2020 + Share_AgroEmp",
                    Data_sf = Data2020, G=3, listW=listW, Type="SCSAR", Phi = 0.50)
reglist &lt;- c(SCSAR$ClusterFitModels[1],SCSAR$ClusterFitModels[2],SCSAR$ClusterFitModels[3])
Wlist &lt;- c(SCSAR$listW_g[1],SCSAR$listW_g[2],SCSAR$listW_g[3])
SpatReg_GoF(SRModel_list = reglist,SRModel_W_list = Wlist)

</code></pre>

<hr>
<h2 id='SpatReg_Perf'>Computes a set of in-sample performance metrics (i.e., AIC, BIC, RMSE, Sigma, and Pseudo R<code class="reqn">^2</code>) for a given spatial regression model of class <code>lm</code> or <code>Sarlm</code>.</h2><span id='topic+SpatReg_Perf'></span>

<h3>Description</h3>

<p>Computes a set of in-sample performance metrics (i.e., AIC, BIC, RMSE, Sigma, and Pseudo R$^2$) for a given spatial regression model of class <code>lm</code> or <code>Sarlm</code> as defined in package <code>spatialreg</code>.
The function can be applied to the output of any SCSR model and contained in the <code>ClusterFitModels</code> output of <code>SCSR_Estim</code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SpatReg_Perf(SRModel)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SpatReg_Perf_+3A_srmodel">SRModel</code></td>
<td>
<p>Estimated spatial or non-spatial regression model of class <code>lm</code> or <code>Sarlm</code> (see package <code>spatialreg</code> for details.)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named <code>vector</code> containing numerical values for the estimated performance metrics (i.e., AIC, BIC, RMSE, Sigma, and Pseudo R<code class="reqn">^2</code>) for the input model in <code>SRModel</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Data_RC_PM_RM_JABES2024, package="SCDA")
SCSAR &lt;- SCSR_Estim(Formula = "Gini_SO ~ GDPPC_PPS2020 + Share_AgroEmp",
                    Data_sf = Data2020, G=3, listW=listW, Type="SCSAR", Phi = 0.50)
SpatReg_Perf(SRModel = SCSAR$ClusterFitModels[[1]])
SpatReg_Perf(SRModel = SCSAR$ClusterFitModels[[2]])
SpatReg_Perf(SRModel = SCSAR$ClusterFitModels[[3]])

</code></pre>

<hr>
<h2 id='SpatReg_PseudoR2'>Computes the Pseudo R<code class="reqn">^2</code> metric for a given spatial regression model of class <code>lm</code> or <code>Sarlm</code>.</h2><span id='topic+SpatReg_PseudoR2'></span>

<h3>Description</h3>

<p>Computes the Pseudo R<code class="reqn">^2</code> metric for a given spatial regression model of class <code>lm</code> or <code>Sarlm</code> as defined in package <code>spatialreg</code>.
The function can be applied to the output of any SCSR model and contained in the <code>ClusterFitModels</code> output of <code>SCSR_Estim</code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SpatReg_PseudoR2(SRModel)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SpatReg_PseudoR2_+3A_srmodel">SRModel</code></td>
<td>
<p>Estimated spatial or non-spatial regression model of class <code>lm</code> or <code>Sarlm</code> (see package <code>spatialreg</code> for details.)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>numeric</code> value reporting the Pseudo R<code class="reqn">^2</code> for the input model in <code>SRModel</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Data_RC_PM_RM_JABES2024, package="SCDA")
SCSAR &lt;- SCSR_Estim(Formula = "Gini_SO ~ GDPPC_PPS2020 + Share_AgroEmp",
                    Data_sf = Data2020, G=3, listW=listW, Type="SCSAR", Phi = 0.50)
SpatReg_PseudoR2(SRModel = SCSAR$ClusterFitModels[[1]])
SpatReg_PseudoR2(SRModel = SCSAR$ClusterFitModels[[2]])
SpatReg_PseudoR2(SRModel = SCSAR$ClusterFitModels[[3]])

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
