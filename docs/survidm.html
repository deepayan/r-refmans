<!DOCTYPE html><html><head><title>Help for package survidm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {survidm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#survidm-package'><p>survidm: Inference and Prediction in an Illness-Death Model</p></a></li>
<li><a href='#autoplot.survIDM'><p>Visualization of  objects of class <code>survIDM</code> with ggplot2 graphics.</p></a></li>
<li><a href='#Beran'><p>Estimation of the conditional distribution function of the response, given the covariate under random censoring.</p></a></li>
<li><a href='#bladderIDM'><p>Bladder Cancer Recurrences.</p></a></li>
<li><a href='#CIF'><p>Nonparametric estimation of the Cumulative Incident Functions</p>
in the illness-death model</a></li>
<li><a href='#colonIDM'><p>Chemotherapy for Stage B/C colon cancer.</p></a></li>
<li><a href='#coxidm'><p>Fit proportional hazards regression model in each transition of</p>
the Illness-Death Model.</a></li>
<li><a href='#KM'><p>Kaplan-Meier product-limit estimate of survival</p></a></li>
<li><a href='#KMW'><p>Kaplan-Meier weights</p></a></li>
<li><a href='#LLW'><p>Local linear weights</p></a></li>
<li><a href='#markov.test'><p>This function is used to test the markov assumption in the illness-death model.</p></a></li>
<li><a href='#nevents'><p>Count number of observed transitions.</p></a></li>
<li><a href='#NWW'><p>Nadaraya-Watson weights.</p></a></li>
<li><a href='#PKM'><p>Presmoothed Kaplan-Meier product-limit estimate of survival</p></a></li>
<li><a href='#PKMW'><p>Presmoothed Kaplan-Meier weights</p></a></li>
<li><a href='#plot.survIDM'><p>Plot for an object of class &quot;survIDM&quot;.</p></a></li>
<li><a href='#sojourn'><p>Nonparametric estimation of the Sojourn time distributions in the</p>
recurrence state in the illness-death model</a></li>
<li><a href='#summary.cmm'><p>Summarizing fits of <code>cmm</code> class</p></a></li>
<li><a href='#summary.survIDM'><p>Summarizing fits of <code>survIDM</code> class</p></a></li>
<li><a href='#survIDM'><p>Create a survIDM object</p></a></li>
<li><a href='#tprob'><p>Nonparametric estimation of transition probabilities in</p>
the illness-death model</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Inference and Prediction in an Illness-Death Model</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-06-23</td>
</tr>
<tr>
<td>Author:</td>
<td>Luis Meira-Machado, Marta Sestelo and Gustavo Soutinho</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Marta Sestelo &lt;sestelo@uvigo.es&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Newly developed methods for the estimation of several probabilities
      in an illness-death model. The package can be used to obtain nonparametric and 
      semiparametric estimates for: transition probabilities, occupation probabilities, 
      cumulative incidence function and the sojourn time distributions. 
      Additionally, it is possible to fit proportional hazards regression models
      in each transition of the Illness-Death Model. Several auxiliary 
      functions are also provided which can be used for marginal 
      estimation of the survival functions.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>KernSmooth, np, survival, doParallel, parallel, doRNG,
foreach, TPmsm, Rcpp, ggplot2, gridExtra, plotly</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-06-24 13:42:18 UTC; sestelo</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-06-24 23:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='survidm-package'>survidm: Inference and Prediction in an Illness-Death Model
</h2><span id='topic+survidm-package'></span><span id='topic+survidm'></span>

<h3>Description</h3>

<p>Newly developed methods for the estimation of several probabilities in an illness-death model. The package can be used to obtain nonparametric and semiparametric estimates for: transition probabilities, occupation probabilities, cumulative incidence function and the sojourn time distributions. Additionally, it is possible to fit proportional hazards regression models in each transition of the
Illness-Death Model. Several auxiliary functions are also provided which can be used for marginal estimation of the survival functions.
</p>


<h3>Author(s)</h3>

<p>Luis Meira-Machado, Marta Sestelo and Gustavo Soutinho.
</p>
<p>Maintainer: Marta Sestelo, sestelo@uvigo.es
</p>


<h3>References</h3>

<p>Aalen O. O., Johansen S. (1978) An Empirical Transition Matrix for Nonhomogeneous Markov
Chains Based on Censored Observations. Scandinavian Journal of Statistics, 5(3), 141&ndash;150.
</p>
<p>Cao R., Lopez-de Ullibarri I., Janssen P., Veraverbeke N. (2005) Presmoothed kaplan-meier and
nelsonaalen estimators. Journal of Nonparametric Statistics, 17, 31&ndash;56.
</p>
<p>de Una-Alvarez J. and Meira-Machado L. (2015). Nonparametric estimation of transition probabilities in a non-Markov illness-death model: a comparative study. Biometrics, 71, 364&ndash;375.
</p>
<p>Geskus R.B. (2011). Cause-specific cumulative incidence estimation and the fine and gray model under both left truncation and right censoring. Biometrics, 67, 39&ndash;49.
</p>
<p>Meira-Machado L. F., de Una-Alvarez J. and Cadarso-Suarez C. (2006). Nonparametric estimation
of transition probabilities in a non-Markov illness-death model. Lifetime Data Anal 12(3), 325&ndash;344.
</p>
<p>Satten G.A. and Datta S. (2002) Marginal estimation for multi-stage models: waiting time distributions and competing risks analyses. Statistics in Medicine, 21, 3&ndash;19.
</p>

<hr>
<h2 id='autoplot.survIDM'>Visualization of  objects of class <code>survIDM</code> with ggplot2 graphics.</h2><span id='topic+autoplot.survIDM'></span><span id='topic+autoplot'></span>

<h3>Description</h3>

<p>It draws the estimated probabilities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'survIDM'
autoplot(
  object = object,
  y = NULL,
  trans = "all",
  func = "distribution",
  conf = NULL,
  type = NULL,
  conftype = NULL,
  col = 1:6,
  confcol = 1:6,
  lty = 1,
  conflty = 2,
  xlab = "Time",
  ylab = NULL,
  ylim = NULL,
  xlim = NULL,
  interactive = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="autoplot.survIDM_+3A_object">object</code></td>
<td>
<p>Object of <code>survIDM</code> class.</p>
</td></tr>
<tr><td><code id="autoplot.survIDM_+3A_y">y</code></td>
<td>
<p><code>NULL</code></p>
</td></tr>
<tr><td><code id="autoplot.survIDM_+3A_trans">trans</code></td>
<td>
<p>The transition probabilities plotted. It is used only when
the object is of class <code>"AJ"</code>, <code>"LIDA"</code> <code>"LM"</code>, <code>"PLM"</code>,
<code>"LMAJ"</code>, <code>"PLMAJ"</code>, <code>"PAJ"</code> and
<code>"tpIPCW"</code>. Possible options
are <code>"all"</code> (default), <code>"00"</code>, <code>"01"</code>, <code>"02"</code>, <code>"11"</code> or <code>"12"</code>.</p>
</td></tr>
<tr><td><code id="autoplot.survIDM_+3A_func">func</code></td>
<td>
<p>It is used only when the object is of class &quot;soj&quot; or &quot;sojIPCW&quot;.
The type of curve to be drawn (&quot;distribution&quot; or &quot;survival&quot;). Default to &quot;distribution&quot;.</p>
</td></tr>
<tr><td><code id="autoplot.survIDM_+3A_conf">conf</code></td>
<td>
<p>Draw the confidence intervals into the plot. By default it is
<code>NULL</code>, they are drawn if the &quot;surv&quot; object contains them.</p>
</td></tr>
<tr><td><code id="autoplot.survIDM_+3A_type">type</code></td>
<td>
<p>The type of plot that should be drawn. See details <code><a href="graphics.html#topic+par">par</a></code>
for possible options. Defaults to &quot;s&quot; for the draw be stair steps.</p>
</td></tr>
<tr><td><code id="autoplot.survIDM_+3A_conftype">conftype</code></td>
<td>
<p>The type of plot that should be drawn for confidence intervals.
See details <code><a href="graphics.html#topic+par">par</a></code> for possible options. Defaults to &quot;s&quot; for the draw be stair steps.</p>
</td></tr>
<tr><td><code id="autoplot.survIDM_+3A_col">col</code></td>
<td>
<p>Vector of colors. Colors are used cyclically.</p>
</td></tr>
<tr><td><code id="autoplot.survIDM_+3A_confcol">confcol</code></td>
<td>
<p>Vector of colors for the confidence intervals. Colors are used cyclically.</p>
</td></tr>
<tr><td><code id="autoplot.survIDM_+3A_lty">lty</code></td>
<td>
<p>The line type. Line types can either be specified as an integer
(0 = blank, 1 = solid (default), 2 = dashed, 3 = dotted, 4 = dotdash,
5 = longdash, 6 = twodash).  See details in <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="autoplot.survIDM_+3A_conflty">conflty</code></td>
<td>
<p>The line type for confidence intervals. Line types can either
be specified as an integer (0 = blank, 1 = solid (default), 2 = dashed,
3 = dotted, 4 = dotdash, 5 = longdash, 6 = twodash).</p>
</td></tr>
<tr><td><code id="autoplot.survIDM_+3A_xlab">xlab</code></td>
<td>
<p>A title for the <code>x</code> axis: see <code><a href="graphics.html#topic+title">title</a></code>.</p>
</td></tr>
<tr><td><code id="autoplot.survIDM_+3A_ylab">ylab</code></td>
<td>
<p>A title for the <code>y</code> axis: see <code><a href="graphics.html#topic+title">title</a></code>.</p>
</td></tr>
<tr><td><code id="autoplot.survIDM_+3A_ylim">ylim</code></td>
<td>
<p>The <code>y</code> limits of the plot.</p>
</td></tr>
<tr><td><code id="autoplot.survIDM_+3A_xlim">xlim</code></td>
<td>
<p>The <code>x</code> limits of the plot.</p>
</td></tr>
<tr><td><code id="autoplot.survIDM_+3A_interactive">interactive</code></td>
<td>
<p>Logical flag indicating if an interactive plot with plotly is produced.</p>
</td></tr>
<tr><td><code id="autoplot.survIDM_+3A_...">...</code></td>
<td>
<p>Other options.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot object, so you can use common features from
ggplot2 package to manipulate the plot.
</p>


<h3>Author(s)</h3>

<p>Luis Meira-Machado, Marta Sestelo and Gustavo Soutinho.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>res &lt;- tprob(survIDM(time1, event1, Stime, event) ~ 1, s = 0,
method = "AJ", conf = FALSE, data = colonIDM)
autoplot(res)
autoplot(res, trans = "02")

  res1 &lt;- tprob(survIDM(time1, event1, Stime, event) ~ factor(sex), s = 365,
                method = "AJ", conf = FALSE, data = colonIDM)

  autoplot(res1, trans="02", ylim=c(0,0.5))


  res2 &lt;- CIF(survIDM(time1, event1, Stime, event) ~ age, data = colonIDM,
              z.value = 56, conf = FALSE)

  autoplot(res2)


  res3 &lt;- sojourn(survIDM(time1, event1, Stime, event) ~ factor(sex),
                  data = colonIDM, conf = FALSE, conf.level = 0.95)

  autoplot(res3)

</code></pre>

<hr>
<h2 id='Beran'>Estimation of the conditional distribution function of the response, given the covariate under random censoring.</h2><span id='topic+Beran'></span>

<h3>Description</h3>

<p>Computes the conditional survival probability P(T &gt; y|Z = z)</p>


<h3>Usage</h3>

<pre><code class='language-R'> Beran(time, status, covariate, delta, x, y, kernel = "gaussian", bw, lower.tail = FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Beran_+3A_time">time</code></td>
<td>
<p>The survival time of the process.</p>
</td></tr>
<tr><td><code id="Beran_+3A_status">status</code></td>
<td>
<p>Censoring indicator of the total time of the process; 0 if the total time is censored and 1 otherwise.</p>
</td></tr>
<tr><td><code id="Beran_+3A_covariate">covariate</code></td>
<td>
<p>Covariate values for obtaining estimates for the conditional probabilities.</p>
</td></tr>
<tr><td><code id="Beran_+3A_delta">delta</code></td>
<td>
<p>Censoring indicator of the covariate.</p>
</td></tr>
<tr><td><code id="Beran_+3A_x">x</code></td>
<td>
<p>The first time (or covariate value) for obtaining estimates for the conditional probabilities. If missing, 0 will be used.</p>
</td></tr>
<tr><td><code id="Beran_+3A_y">y</code></td>
<td>
<p>The total time for obtaining estimates for the conditional probabilities.</p>
</td></tr>
<tr><td><code id="Beran_+3A_kernel">kernel</code></td>
<td>
<p>A character string specifying the desired kernel. See details below for possible options. Defaults to &quot;gaussian&quot; where the gaussian density kernel will be used.</p>
</td></tr>
<tr><td><code id="Beran_+3A_bw">bw</code></td>
<td>
<p>A single numeric value to compute a kernel density bandwidth.</p>
</td></tr>
<tr><td><code id="Beran_+3A_lower.tail">lower.tail</code></td>
<td>
<p>logical; if FALSE (default), probabilities are P(T &gt; y|Z = z) otherwise, P(T &lt;= y|Z = z).</p>
</td></tr>
</table>


<h3>Details</h3>

<p> Possible options for argument window are &quot;gaussian&quot;, &quot;epanechnikov&quot;, &quot;tricube&quot;, &quot;boxcar&quot;, &quot;triangular&quot;, &quot;quartic&quot; or &quot;cosine&quot;.</p>


<h3>Author(s)</h3>

<p>Luis Meira-Machado, Marta Sestelo and Gustavo Soutinho</p>


<h3>References</h3>

<p>R. Beran. Nonparametric regression with randomly censored survival data. Technical report, University of
California, Berkeley, 1981.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>obj &lt;- with(colonIDM, survIDM(time1, event1, Stime, event))
obj0 &lt;- obj

#P(T&gt;y|age=45)
library(KernSmooth)
h &lt;- dpik(colonIDM$age)
Beran(time = obj0$Stime, status = obj0$event, covariate = colonIDM$age,
x = 45, y = 730, bw = h)

#P(T&lt;=y|age=45)
Beran(time = obj0$Stime, status = obj0$event, covariate = colonIDM$age,
x = 45, y = 730, bw = h, lower.tail = TRUE)
</code></pre>

<hr>
<h2 id='bladderIDM'>Bladder Cancer Recurrences.</h2><span id='topic+bladderIDM'></span>

<h3>Description</h3>

<p>bladderIDM is a data frame with 8 variables and 85 observations.
Data on recurrences of bladder cancer, used by many people to demonstrate methodology for recurrent event modelling.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("bladderIDM")</code></pre>


<h3>Format</h3>

<p>A data frame with 85 observations on the following 8 variables.
Below a brief description is given for some of these variables.
</p>

<dl>
<dt>t1</dt><dd><p>Time to first recurrence/censoring, whichever occurs first.</p>
</dd>
<dt>e1</dt><dd><p>Recurrence/censoring indicator (first recurrence=1) for the first time (t1).</p>
</dd>
<dt>t2</dt><dd><p>Time to second recurrence/censoring, whichever occurs first.</p>
</dd>
<dt>e2</dt><dd><p>Recurrence/censoring indicator (second recurrence=1) for the second time (t2)</p>
</dd>
<dt>t3</dt><dd><p>Time to recurrence/censoring, whichever occurs first.</p>
</dd>
<dt>e3</dt><dd><p>Recurrence/censoring indicator (third recurrence=1) for the third time (t3)</p>
</dd>
<dt>t4</dt><dd><p>Time to fourth recurrence/censoring, whichever occurs first.</p>
</dd>
<dt>e4</dt><dd><p>Recurrence/censoring indicator (fourth recurrence=1) for the fourth time (t4)</p>
</dd>

</dl>



<h3>References</h3>

<p>Byar, D. (1980) Veterans administration study of chemoprophylaxis for recurrent stage i bladder tumors:
Comparisons of placebo, pyridoxine and topical thiotepa. Bladder Tumors and Other Topics in
Urological Oncology, 18:363&ndash;370.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(bladderIDM)
  head(bladderIDM)
</code></pre>

<hr>
<h2 id='CIF'>Nonparametric estimation of the Cumulative Incident Functions
in the illness-death model</h2><span id='topic+CIF'></span>

<h3>Description</h3>

<p>This function is used to obtain nonparametric estimates of
the cumulative incidence probabilities in the illness-death model. They
represent the probability of one individual's being or having been in
state j at time t.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CIF(
  formula,
  s,
  data,
  conf = FALSE,
  n.boot = 199,
  conf.level = 0.95,
  z.value,
  bw = "dpik",
  window = "gaussian",
  method.weights = "NW",
  cluster = FALSE,
  ncores = NULL,
  presmooth = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CIF_+3A_formula">formula</code></td>
<td>
<p>A <code>formula</code> object, which must have a <code>survIDM</code>
object as the response on the left of the <code>~</code> operator and, if desired,
a term on the right. The term may be a qualitative or quantitative variable.
Without covariates, the right hand side should be <code>~ 1</code>.</p>
</td></tr>
<tr><td><code id="CIF_+3A_s">s</code></td>
<td>
<p>The first time for obtaining estimates for the cumulative
incidence functions. If missing, 0 will be used.</p>
</td></tr>
<tr><td><code id="CIF_+3A_data">data</code></td>
<td>
<p>A data.frame including at least four columns named
<code>time1</code>, <code>event1</code>, <code>Stime</code> and <code>event</code>, which correspond
to disease free survival time, disease free survival indicator, time to death
or censoring, and death indicator, respectively.</p>
</td></tr>
<tr><td><code id="CIF_+3A_conf">conf</code></td>
<td>
<p>Provides pointwise confidence bands. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="CIF_+3A_n.boot">n.boot</code></td>
<td>
<p>The number of bootstrap replicates to compute the variance
of the estimator. Default is 199.</p>
</td></tr>
<tr><td><code id="CIF_+3A_conf.level">conf.level</code></td>
<td>
<p>Level of confidence. Defaults to 0.95 (corresponding to 95%).</p>
</td></tr>
<tr><td><code id="CIF_+3A_z.value">z.value</code></td>
<td>
<p>The value of the covariate on the right hand side of formula
at which the cumulative incidence probabilities are computed. For quantitative
covariates, i.e. of class integer and numeric.</p>
</td></tr>
<tr><td><code id="CIF_+3A_bw">bw</code></td>
<td>
<p>A single numeric value to compute a kernel density bandwidth.
Use <code>"dpik"</code> for the <span class="pkg">KernSmooth</span> package based selector or <code>"np"</code>
for the <code>'npudensbw'</code> function of the <span class="pkg">np</span> package.</p>
</td></tr>
<tr><td><code id="CIF_+3A_window">window</code></td>
<td>
<p>A character string specifying the desired kernel.
See details below for possible options. Defaults to <code>"gaussian"</code>
where the gaussian density kernel will be used.</p>
</td></tr>
<tr><td><code id="CIF_+3A_method.weights">method.weights</code></td>
<td>
<p>A character string specifying the desired weights method.
Possible options are <code>"NW"</code> for the Nadaraya-Watson weights and <code>"LL"</code>
for local linear weights. Defaults to <code>"NW"</code>.</p>
</td></tr>
<tr><td><code id="CIF_+3A_cluster">cluster</code></td>
<td>
<p>A logical value. If <code>TRUE</code> (default), the bootstrap procedure
for the confidence intervals is parallelized. Note that there are
cases (e.g., a low number of bootstrap repetitions) that <span class="rlang"><b>R</b></span> will gain in
performance through serial computation. <span class="rlang"><b>R</b></span> takes time to distribute tasks
across the processors also it will need time for binding them all together
later on. Therefore, if the time for distributing and gathering pieces
together is greater than the time need for single-thread computing,
it does not worth parallelize.</p>
</td></tr>
<tr><td><code id="CIF_+3A_ncores">ncores</code></td>
<td>
<p>An integer value specifying the number of cores to be used in
the parallelized procedure. If <code>NULL</code> (default), the number of cores
to be used is equal to the number of cores of the machine - 1.</p>
</td></tr>
<tr><td><code id="CIF_+3A_presmooth">presmooth</code></td>
<td>
<p>A logical value. If <code>TRUE</code>, the presmoothed landmark
estimator of the cumulative incidence function is computed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Possible options for argument window are <code>"gaussian"</code>,
<code>"epanechnikov"</code>, <code>"tricube"</code>, <code>"boxcar"</code>,
<code>"triangular"</code>, <code>"quartic"</code> or <code>"cosine"</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>"survIDM"</code> and one of the following
two classes: <code>"CIF"</code> (Cumulative Incidence Function), and
<code>"cifIPCW"</code> (Inverse Probability of Censoring Weighting for the Cumulative Incidence Function). Objects are implemented as a list with elements:
</p>
<table>
<tr><td><code>est</code></td>
<td>
<p>data.frame with estimates of the cumulative incidence probabilities.</p>
</td></tr>
<tr><td><code>CI</code></td>
<td>
<p>data.frame with the confidence intervals of the cumulative
incidence probabilities.</p>
</td></tr>
<tr><td><code>conf.level</code></td>
<td>
<p>Level of confidence.</p>
</td></tr>
<tr><td><code>s</code></td>
<td>
<p>The first time for obtaining estimates for the cumulative
incidence probabilities.</p>
</td></tr>
<tr><td><code>t</code></td>
<td>
<p>The time for obtaining the estimates of cumulative incidence probabilities.</p>
</td></tr>
<tr><td><code>conf</code></td>
<td>
<p>logical; if <code>FALSE</code> (default) the pointwise confidence
bands are not given.</p>
</td></tr>
<tr><td><code>callp</code></td>
<td>
<p>The expression of the estimated probability.</p>
</td></tr>
<tr><td><code>Nlevels</code></td>
<td>
<p>The number of levels of the covariate. Provides important
information when the covariate at the right hand side of formula
is of class factor.</p>
</td></tr>
<tr><td><code>levels</code></td>
<td>
<p>The levels of the qualitative covariate
(if it is of class factor) on the right hand side of formula.</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>A formula object.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>A call object.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Luis Meira-Machado, Marta Sestelo and Gustavo Soutinho.
</p>


<h3>References</h3>

<p>Geskus, R.B. (2011). Cause-specific cumulative incidence estimation
and the fine and gray model under both left truncation and right censoring.
Biometrics, 67, 39&ndash;49.
</p>
<p>Kalbeisch, J. D. and Prentice R. L. (1980) The statistical analysis of
failure time data. John Wiley &amp; Sons, New York.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Cumulative Incidence Function (CIF)
res &lt;- CIF(survIDM(time1, event1, Stime, event) ~ 1, data = colonIDM,
conf = FALSE)
res
summary(res, time=365*1:7)
plot(res, ylim=c(0, 0.6))

res01 &lt;- CIF(survIDM(time1, event1, Stime, event) ~ 1, data = colonIDM,
conf = FALSE, presmooth = TRUE)
res01
summary(res01, time=365*1:7)
plot(res01, ylim=c(0, 0.6))


# CIF for those in State 1 at time s=365, Y(s)=0
res1 &lt;- CIF(survIDM(time1, event1, Stime, event) ~ 1, data = colonIDM,
s = 365, conf = FALSE)
summary(res1, time=365*1:7)
plot(res1, ylim=c(0, 0.6))


# Conditional CIF (with a factor)
res2 &lt;- CIF(survIDM(time1, event1, Stime, event) ~ factor(sex),
data = colonIDM, s = 365, conf = FALSE)
summary(res2, time=365*1:5)
plot(res2)

res2.1 &lt;- CIF(survIDM(time1, event1, Stime, event) ~ factor(sex),  #new
data = colonIDM, s = 365, conf = FALSE, presmooth = TRUE)
summary(res2.1, time=365*1:5)
plot(res2.1)


# Conditional CIF (with continuous covariate)
res3 &lt;- CIF(survIDM(time1, event1, Stime, event) ~ age, data = colonIDM,
z.value = 56, conf = FALSE)
summary(res3, time=365*1:6)
plot(res3)

</code></pre>

<hr>
<h2 id='colonIDM'>Chemotherapy for Stage B/C colon cancer.</h2><span id='topic+colonIDM'></span>

<h3>Description</h3>

<p>These are data from one of the first successful trials of adjuvant chemotherapy for colon cancer. Levamisole is a low-toxicity compound previously used to treat worm infestations in animals; 5-FU is a moderately toxic (as these things go) chemotherapy agent. </p>


<h3>Usage</h3>

<pre><code class='language-R'>data("colonIDM")</code></pre>


<h3>Format</h3>

<p>A data frame with 929 observations on the following 15 variables.
Below a brief description is given for some of these variables.
</p>

<dl>
<dt>time1</dt><dd><p>Time to recurrence/censoring/death, whichever occurs first.</p>
</dd>
<dt>event1</dt><dd><p>Recurrence/censoring indicator (recurrence=1, alive=0).</p>
</dd>
<dt>Stime</dt><dd><p>Time to censoring/death, whichever occurs first.</p>
</dd>
<dt>event</dt><dd><p>Death/censoring indicator (death=1, alive=0).</p>
</dd>
<dt>rx</dt><dd><p>Treatment - Obs(ervation), Lev(amisole), Lev(amisole)+5-FU.</p>
</dd>
<dt>sex</dt><dd><p>Sex indicator (male=1, female=0).</p>
</dd>
<dt>age</dt><dd><p>Age in years.</p>
</dd>
<dt>obstruct</dt><dd><p>Obstruction of colon by tumour.</p>
</dd>
<dt>perfor</dt><dd><p>Perforation of colon.</p>
</dd>
<dt>adhere</dt><dd><p>Adherence to nearby organs.</p>
</dd>
<dt>nodes</dt><dd><p>Number of lymph nodes with detectable cancer.</p>
</dd>
<dt>differ</dt><dd><p>Differentiation of tumour (1=well, 2=moderate, 3=poor).</p>
</dd>
<dt>extent</dt><dd><p>Extent of local spread (1=submucosa, 2=muscle, 3=serosa,
4=contiguous structures).</p>
</dd>
<dt>surg</dt><dd><p>Time from surgery to registration (0=short, 1=long).</p>
</dd>
<dt>node4</dt><dd><p>More than 4 positive lymph nodes.</p>
</dd>
</dl>



<h3>Source</h3>

<p>The study is originally described in Laurie (1989).The main report is found in Moertel (1990). This data set is closest to that of the final report in Moertel (1991). A version of the data with less follow-up time was used in the paper by Lin (1994).
</p>


<h3>References</h3>

<p>JA Laurie, CG Moertel, TR Fleming, HS Wieand, JE Leigh, J Rubin, GW McCormack, JB Gerstner, JE Krook and J Malliard. Surgical adjuvant therapy of large-bowel carcinoma: An evaluation of levamisole and the combination of levamisole and fluorouracil: The North Central Cancer Treatment Group and the Mayo Clinic. Journal of Clinical Oncology, 7:1447-1456, 1989.
</p>
<p>DY Lin. Cox regression analysis of multivariate failure time data: the marginal approach. Statistics in Medicine, 13:2233-2247, 1994.
</p>
<p>CG Moertel, TR Fleming, JS MacDonald, DG Haller, JA Laurie, PJ Goodman, JS Ungerleider, WA Emerson, DC Tormey, JH Glick, MH Veeder and JA Maillard. Levamisole and fluorouracil for adjuvant therapy of resected colon carcinoma. New England Journal of Medicine, 332:352-358, 1990.
</p>
<p>CG Moertel, TR Fleming, JS MacDonald, DG Haller, JA Laurie, CM Tangen, JS Ungerleider, WA Emerson, DC Tormey, JH Glick, MH Veeder and JA Maillard. Fluorouracil plus Levamisole as and effective adjuvant therapy after resection of stage II colon carcinoma: a final report. Annals of Internal Medicine, 122:321-326, 1991.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(colonIDM)
head(colonIDM)
</code></pre>

<hr>
<h2 id='coxidm'>Fit proportional hazards regression model in each transition of
the Illness-Death Model.</h2><span id='topic+coxidm'></span><span id='topic+coxidm'></span>

<h3>Description</h3>

<p>Fits a Cox proportional hazards regression model for each transition.</p>


<h3>Usage</h3>

<pre><code class='language-R'>coxidm(formula, data, semiMarkov = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coxidm_+3A_formula">formula</code></td>
<td>
<p>A <code>formula</code> object, which must have a <code>survIDM</code>
object as the response on the left of the <code>~</code> operator and, if desired,
a term on the right. The term may be a qualitative or quantitative variable.
Without covariates, the right hand side should be <code>~ 1</code>.</p>
</td></tr>
<tr><td><code id="coxidm_+3A_data">data</code></td>
<td>
<p>A data.frame including at least four columns named
<code>time1</code>, <code>event1</code>, <code>Stime</code> and <code>event</code>, which correspond
to disease free survival time, disease free survival indicator, time to death
or censoring, and death indicator, respectively.</p>
</td></tr>
<tr><td><code id="coxidm_+3A_semimarkov">semiMarkov</code></td>
<td>
<p>By default, <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame or a list containing the following components:
</p>
<table>
<tr><td><code>coef</code></td>
<td>
<p>Estimated coeficients.</p>
</td></tr>
<tr><td><code>exp(coef)</code></td>
<td>
<p>Exponent of the estimated coefficients.</p>
</td></tr>
<tr><td><code>lower 0.95</code></td>
<td>
<p>Lower limit of the confidence interval.</p>
</td></tr>
<tr><td><code>upper 0.95</code></td>
<td>
<p>Upper limit of the confidence interval.</p>
</td></tr>
<tr><td><code>pvalue</code></td>
<td>
<p>obtained pvalue testing that the coefficient is equals to zero.</p>
</td></tr>
</table>
<p>Other data frames or lists:
</p>
<table>
<tr><td><code>anova</code></td>
<td>
<p>Analysis of Deviance for the Cox Regression models.</p>
</td></tr>
<tr><td><code>zph</code></td>
<td>
<p>Test the Proportional Hazards Assumption of the Cox Regression models.</p>
</td></tr>
<tr><td><code>term</code></td>
<td>
<p>Predicted values of splines and partial residual for the terms of the model.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Luis Meira-Machado, Marta Sestelo and Gustavo Soutinho.</p>


<h3>Examples</h3>

<pre><code class='language-R'>  cmm1 &lt;- coxidm(survIDM(time1, event1, Stime, event) ~ age, data = colonIDM)
  summary(cmm1, conf.level = 0.95)

  cmm2 &lt;- coxidm(survIDM(time1, event1, Stime, event) ~ rx + sex + age + nodes,
                 data = colonIDM)
  summary(cmm2)

  cmm3 &lt;- coxidm(survIDM(time1, event1, Stime, event) ~ rx + sex + age + nodes,
                 data = colonIDM, semiMarkov = TRUE)
  summary(cmm3)
</code></pre>

<hr>
<h2 id='KM'>Kaplan-Meier product-limit estimate of survival</h2><span id='topic+KM'></span>

<h3>Description</h3>

<p>This function provides survival estimates using the product-limit Kaplan-Meier estimator.</p>


<h3>Usage</h3>

<pre><code class='language-R'>KM(time, status, t)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="KM_+3A_time">time</code></td>
<td>
<p> Survival time of the process.</p>
</td></tr>
<tr><td><code id="KM_+3A_status">status</code></td>
<td>
<p>Censoring indicator of the survival time of the process; 0 if the survival time is censored and 1 otherwise. </p>
</td></tr>
<tr><td><code id="KM_+3A_t">t</code></td>
<td>
<p> The time for obtaining survival estimates.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Luis Meira-Machado, Marta Sestelo and Gustavo Soutinho.</p>


<h3>References</h3>

<p>E. Kaplan and P. Meier. Nonparametric estimation from incomplete observations. Journal of the
American Statistical Association, 53:457-481, 1958.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+PKM">PKM</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>require(survival)
obj &lt;- with(colonIDM, survIDM(time1, event1, Stime, event))
KM(time = obj$Stime, status = obj$event, t = 1095)

fit &lt;- survfit(Surv(obj$Stime, obj$event) ~ 1, data = obj)
summary(fit, time = 1095)$surv

</code></pre>

<hr>
<h2 id='KMW'>Kaplan-Meier weights</h2><span id='topic+KMW'></span>

<h3>Description</h3>

<p>This function returns a vector with the Kaplan-Meier weights.</p>


<h3>Usage</h3>

<pre><code class='language-R'>KMW(time, status)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="KMW_+3A_time">time</code></td>
<td>
<p> Survival time of the process.</p>
</td></tr>
<tr><td><code id="KMW_+3A_status">status</code></td>
<td>
<p>Censoring indicator of the survival time of the process; 0 if the survival time is censored and 1 otherwise. </p>
</td></tr>
</table>


<h3>Value</h3>

<p> Vector with Kaplan-Meier weights. </p>


<h3>Author(s)</h3>

<p>Luis Meira-Machado, Marta Sestelo and Gustavo Soutinho.</p>


<h3>References</h3>

<p>E. Kaplan and P. Meier. Nonparametric estimation from incomplete observations. Journal of the
American Statistical Association, 53:457-481, 1958.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+PKMW">PKMW</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>obj &lt;- with(colonIDM, survIDM(time1, event1, Stime, event))
kmw &lt;- KMW(time = obj$Stime, status = obj$event)

require(survival)
colon.surv &lt;- survfit(Surv(Stime, event) ~ 1, obj)
times &lt;- summary(colon.surv)$time
surv &lt;- summary(colon.surv)$surv
nevent &lt;- summary(colon.surv)$n.event
p &lt;- match(obj$Stime, times)
kmw2 &lt;- -diff(c(1, surv))/nevent
kmw2 &lt;- kmw2[p]*obj$event
kmw2[is.na(kmw2)] &lt;- 0
all.equal(kmw, kmw2)

</code></pre>

<hr>
<h2 id='LLW'>Local linear weights</h2><span id='topic+LLW'></span>

<h3>Description</h3>

<p>Computes local linear weights based on Kernel smoothing. </p>


<h3>Usage</h3>

<pre><code class='language-R'>LLW(x, kernel = "gaussian", bw, t1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LLW_+3A_x">x</code></td>
<td>
<p>Covariate values for obtaining estimates for the conditional probabilities. If missing, unconditioned probabilities will be computed.</p>
</td></tr>
<tr><td><code id="LLW_+3A_kernel">kernel</code></td>
<td>
<p>A character string specifying the desired kernel. See details below for possible options. Defaults to &quot;gaussian&quot; where the gaussian density kernel will be used.</p>
</td></tr>
<tr><td><code id="LLW_+3A_bw">bw</code></td>
<td>
<p>A single numeric value to compute a kernel density bandwidth.</p>
</td></tr>
<tr><td><code id="LLW_+3A_t1">t1</code></td>
<td>
<p>Covariate value to compute the weight at.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Possible options for argument window are &quot;gaussian&quot;, &quot;epanechnikov&quot;, &quot;tricube&quot;, &quot;boxcar&quot;, &quot;triangular&quot;, &quot;quartic&quot; or &quot;cosine&quot;. </p>


<h3>Value</h3>

<p>A vector with local linear weights. </p>


<h3>Author(s)</h3>

<p>Luis Meira-Machado, Marta Sestelo and Gustavo Soutinho.</p>


<h3>See Also</h3>

<p><code><a href="#topic+NWW">NWW</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>LLW(x = colonIDM$age, bw = 3, t1 = 60)
</code></pre>

<hr>
<h2 id='markov.test'>This function is used to test the markov assumption in the illness-death model.</h2><span id='topic+markov.test'></span>

<h3>Description</h3>

<p>The markov assumption may be tested including
the sojourn time in the initial state, &quot;times1&quot;, and other covariates in the Cox model.</p>


<h3>Usage</h3>

<pre><code class='language-R'>markov.test(formula, s, nm.method = "LM", data)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="markov.test_+3A_formula">formula</code></td>
<td>
<p>A <code>formula</code> object, which must have a <code>survIDM</code>.</p>
</td></tr>
<tr><td><code id="markov.test_+3A_s">s</code></td>
<td>
<p>The first time for obtaining a graphical test of markovianity by
comparison of the estimates for transition probabilities.  If missing, first quartile of the sojourn time in the initial state has been considered for the graphical test.</p>
</td></tr>
<tr><td><code id="markov.test_+3A_nm.method">nm.method</code></td>
<td>
<p>The non-markov method used to compute the transition probabilities. Defaults to <code>"LM"</code>.</p>
</td></tr>
<tr><td><code id="markov.test_+3A_data">data</code></td>
<td>
<p>A data.frame including at least four columns named
<code>time1</code>, <code>event1</code>, <code>Stime</code> and <code>event</code>, which correspond
to disease free survival time, disease free survival indicator, time to death
or censoring, and death indicator, respectively.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The markov assumption may be tested including
the sojourn time in the initial state, &quot;times1&quot;, and other covariates in the Cox model.
A graphical test for Markovianity is also available.</p>


<h3>Value</h3>

<table>
<tr><td><code>cox.markov.test</code></td>
<td>
<p>An object of class <code>coxph</code> representing the fit. See <code>coxph.object</code> for details.</p>
</td></tr>
<tr><td><code>TPestimates</code></td>
<td>
<p>Dataframe with estimates of the transition probabilities for Aalen-Johansen estimator (markovian)
and for non-markov estimator. Confidence intervals for the transition probability from State 1 to State 2 are also available.</p>
</td></tr>
<tr><td><code>nm.method</code></td>
<td>
<p>The non-markov method used to compute the transition probabilities.</p>
</td></tr>
<tr><td><code>s</code></td>
<td>
<p>The first time for obtaining a graphical test of markovianity by
comparison of the estimates for transition probabilities.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>A call object.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Luis Meira-Machado, Marta Sestelo and Gustavo Soutinho.
</p>


<h3>References</h3>

<p>L. Meira-Machado, J. de Una-Alvarez, C. Cadarso-Suarez, and P. Andersen. Multi-state models for the
analysis of time to event data. Statistical Methods in Medical Research, 18:195-222, 2009.
</p>
<p>J. de Una-Alvarez and L. Meira-Machado. Nonparametric estimation of transition probabilities in
the non-markov illness-death model: A comparative study. Biometrics, 71(2):364-375, 2015.
</p>
<p>L. Meira-Machado and M. Sestelo. Estimation in the progressive illness-death model: A nonexhaustive
review. Biometrical Journal, 2018.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
mk &lt;- markov.test(survIDM(time1,event1,Stime,event)~1, s=365, nm.method = "LM", data=colonIDM)
mk$cox.markov.test
mk$TPestimates
mk$nm.method
plot(mk)

</code></pre>

<hr>
<h2 id='nevents'>Count number of observed transitions.</h2><span id='topic+nevents'></span>

<h3>Description</h3>

<p>Given a dataset of class &quot;survIDM&quot;, this function counts the number of observed transitions
in the multi-state model.</p>


<h3>Usage</h3>

<pre><code class='language-R'>nevents(dataidm, state.names=NULL)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nevents_+3A_dataidm">dataidm</code></td>
<td>
<p>A dataframe including at least four columns named
<code>time1</code>, <code>event1</code>, <code>Stime</code> and <code>event</code>, which correspond
to disease free survival time, disease free survival indicator, time to death
or censoring, and death indicator, respectively.</p>
</td></tr>
<tr><td><code id="nevents_+3A_state.names">state.names</code></td>
<td>
<p>Names for the transition states. If <code>NULL</code> (default),
transition states are named by <code>"healthy"</code>, <code>"illness"</code> and <code>"death"</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The colums of the dataset needs to have the format of class &quot;survIDM&quot;,
which holds the transition matrix of the multi-state model. The arguments <code>time1</code>
and <code>Stime</code> must be numeric and nonnegative; <code>event1</code> and <code>event</code> must
be 0 or 1 if numeric and TRUE or FALSE if logical. <code>Stime</code> must be greater or
equal to argument arguments <code>time1</code>. <code>Stime</code> and <code>time1</code> must be equal
when argument <code>event1</code> equals 0 or FALSE. Argument <code>event</code> must be equal
to 0 or FALSE when argument <code>event1</code> equals 0 or FALSE. When arguments
<code>Stime</code> and <code>time1</code> are equal and argument <code>event1</code> equals 1 or
TRUE, argument <code>event</code> must be equal to 1 or TRUE.</p>


<h3>Author(s)</h3>

<p>Luis Meira-Machado, Marta Sestelo and Gustavo Soutinho.
</p>


<h3>References</h3>

<p>L. Meira-Machado, J. de Una-Alvarez, C. Cadarso-Suarez, and P. Andersen. Multi-state models for the
analysis of time to event data. Statistical Methods in Medical Research, 18:195-222, 2009.
</p>
<p>J. de Una-Alvarez and L. Meira-Machado. Nonparametric estimation of transition probabilities in
the non-markov illness-death model: A comparative study. Biometrics, 71(2):364-375, 2015.
</p>
<p>L. Meira-Machado and M. Sestelo. Estimation in the progressive illness-death model: A nonexhaustive
review. Biometrical Journal, 2018.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
nevents(colonIDM)

nevents(colonIDM, c('State0','State1', 'State2'))

</code></pre>

<hr>
<h2 id='NWW'>Nadaraya-Watson weights.</h2><span id='topic+NWW'></span>

<h3>Description</h3>

<p>Computes the Nadaraya-Watson weights. </p>


<h3>Usage</h3>

<pre><code class='language-R'>NWW(covariate, x, kernel = "gaussian", bw)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NWW_+3A_covariate">covariate</code></td>
<td>
<p>Covariate values for obtaining weights.</p>
</td></tr>
<tr><td><code id="NWW_+3A_x">x</code></td>
<td>
<p>Covariate value to compute the weight at.</p>
</td></tr>
<tr><td><code id="NWW_+3A_kernel">kernel</code></td>
<td>
<p>A character string specifying the desired kernel. See details below for possible options. Defaults to &quot;gaussian&quot; where the gaussian density kernel will be used.</p>
</td></tr>
<tr><td><code id="NWW_+3A_bw">bw</code></td>
<td>
<p>A single numeric value to compute a kernel density bandwidth.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Possible options for argument window are &quot;gaussian&quot;, &quot;epanechnikov&quot;, &quot;tricube&quot;, &quot;boxcar&quot;, &quot;triangular&quot;, &quot;quartic&quot; or &quot;cosine&quot;. </p>


<h3>Value</h3>

<p>A vector with Nadaraya-Watson weights. </p>


<h3>Author(s)</h3>

<p>Luis Meira-Machado, Marta Sestelo and Gustavo Soutinho.</p>


<h3>See Also</h3>

<p><code><a href="#topic+LLW">LLW</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>NWW(covariate = colonIDM$age, x=40, kernel = "gaussian", bw = 3)
</code></pre>

<hr>
<h2 id='PKM'>Presmoothed Kaplan-Meier product-limit estimate of survival</h2><span id='topic+PKM'></span>

<h3>Description</h3>

<p>This function provides survival estimates using the presmoothed product-limit Kaplan-Meier estimator.</p>


<h3>Usage</h3>

<pre><code class='language-R'>PKM(time, status, t)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PKM_+3A_time">time</code></td>
<td>
<p>Survival time of the process.</p>
</td></tr>
<tr><td><code id="PKM_+3A_status">status</code></td>
<td>
<p>Censoring indicator of the survival time of the process; 0 if the survival time is censored and 1 otherwise. </p>
</td></tr>
<tr><td><code id="PKM_+3A_t">t</code></td>
<td>
<p> The time for obtaining survival estimates.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Luis Meira-Machado, Marta Sestelo and Gustavo Soutinho.</p>


<h3>References</h3>

<p>R. Cao, I. Lopez-de Ullibarri, P. Janssen, and N. Veraverbeke. Presmoothed kaplan-meier and nelsonaalen
estimators. Journal of Nonparametric Statistics, 17:31-56, 2005.
</p>
<p>G. Dikta. On semiparametric random censorship models. Journal of Statistical Planning and Inference,
66:253-279, 1998.
</p>
<p>E. Kaplan and P. Meier. Nonparametric estimation from incomplete observations. Journal of the
American Statistical Association, 53:457-481, 1958.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+KM">KM</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>obj &lt;- with(colonIDM, survIDM(time1, event1, Stime, event))
PKM(time = obj$Stime, status = obj$event, t = 1095)
</code></pre>

<hr>
<h2 id='PKMW'>Presmoothed Kaplan-Meier weights</h2><span id='topic+PKMW'></span>

<h3>Description</h3>

<p>This function returns a vector with the presmoothed Kaplan-Meier weights.</p>


<h3>Usage</h3>

<pre><code class='language-R'>PKMW(time, status)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PKMW_+3A_time">time</code></td>
<td>
<p> Survival time of the process.</p>
</td></tr>
<tr><td><code id="PKMW_+3A_status">status</code></td>
<td>
<p>Censoring indicator of the survival time of the process; 0 if the survival time is censored and 1 otherwise. </p>
</td></tr>
</table>


<h3>Value</h3>

<p> Vector with presmoothed Kaplan-Meier weights. </p>


<h3>Author(s)</h3>

<p>Luis Meira-Machado, Marta Sestelo and Gustavo Soutinho.</p>


<h3>References</h3>

<p>R. Cao, I. Lopez-de Ullibarri, P. Janssen, and N. Veraverbeke. Presmoothed kaplan-meier and nelsonaalen
estimators. Journal of Nonparametric Statistics, 17:31-56, 2005.
</p>
<p>G. Dikta. On semiparametric random censorship models. Journal of Statistical Planning and Inference,
66:253-279, 1998.
</p>
<p>E. Kaplan and P. Meier. Nonparametric estimation from incomplete observations. Journal of the
American Statistical Association, 53:457-481, 1958.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+KMW">KMW</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>obj &lt;- with(colonIDM, survIDM(time1, event1, Stime, event))
PKMW(time = obj$Stime, status = obj$event)
</code></pre>

<hr>
<h2 id='plot.survIDM'>Plot for an object of class &quot;survIDM&quot;.</h2><span id='topic+plot.survIDM'></span>

<h3>Description</h3>

<p>It draws the estimated probabilities. </p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'survIDM'
plot(x = object, y = NULL, trans = "all",
func = "distribution", conf = NULL,
type = NULL, conftype = NULL, col = 1:6, confcol = 1:6, lty = 1, conflty = 2,
xlab = "Time (years)", ylab = NULL, ylim = NULL, xlim = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.survIDM_+3A_x">x</code></td>
<td>
<p>An object of class &quot;survIDM&quot;.</p>
</td></tr>
<tr><td><code id="plot.survIDM_+3A_y">y</code></td>
<td>
<p><code>NULL</code></p>
</td></tr>
<tr><td><code id="plot.survIDM_+3A_trans">trans</code></td>
<td>
<p>The transition probabilities plotted. It is used only when
the object is of class <code>"AJ"</code>, <code>"LIDA"</code> <code>"LM"</code>, <code>"PLM"</code>,
<code>"LMAJ"</code>, <code>"PLMAJ"</code>, <code>"PAJ"</code> and
<code>"tpIPCW"</code>. Possible options
are <code>"all"</code> (default), <code>"00"</code>, <code>"01"</code>, <code>"02"</code>, <code>"11"</code> or <code>"12"</code>.</p>
</td></tr>
<tr><td><code id="plot.survIDM_+3A_func">func</code></td>
<td>
<p>It is used only when the object is of class &quot;soj&quot; or &quot;sojIPCW&quot;. The type of curve to be drawn (&quot;distribution&quot; or &quot;survival&quot;).
Default to &quot;distribution&quot;. </p>
</td></tr>
<tr><td><code id="plot.survIDM_+3A_conf">conf</code></td>
<td>
<p>Draw the confidence intervals into the plot. By default it is
<code>NULL</code>, they are drawn if the &quot;surv&quot; object contains them.</p>
</td></tr>
<tr><td><code id="plot.survIDM_+3A_type">type</code></td>
<td>
<p>The type of plot that should be drawn. See details <code><a href="graphics.html#topic+par">par</a></code>
for possible options. Defaults to &quot;s&quot; for the draw be stair steps.</p>
</td></tr>
<tr><td><code id="plot.survIDM_+3A_conftype">conftype</code></td>
<td>
<p>The type of plot that should be drawn for confidence intervals.
See details <code><a href="graphics.html#topic+par">par</a></code>
for possible options. Defaults to &quot;s&quot; for the draw be stair steps.</p>
</td></tr>
<tr><td><code id="plot.survIDM_+3A_col">col</code></td>
<td>
<p>Vector of colors. Colors are used cyclically.</p>
</td></tr>
<tr><td><code id="plot.survIDM_+3A_confcol">confcol</code></td>
<td>
<p>Vector of colors for the confidence intervals.
Colors are used cyclically.</p>
</td></tr>
<tr><td><code id="plot.survIDM_+3A_lty">lty</code></td>
<td>
<p>The line type. Line types can either be specified as an integer
(0 = blank, 1 = solid (default), 2 = dashed, 3 = dotted, 4 = dotdash,
5 = longdash, 6 = twodash).  See details in <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="plot.survIDM_+3A_conflty">conflty</code></td>
<td>
<p>The line type for confidence intervals. Line types can either
be specified as an integer (0 = blank, 1 = solid (default), 2 = dashed,
3 = dotted, 4 = dotdash, 5 = longdash, 6 = twodash).</p>
</td></tr>
<tr><td><code id="plot.survIDM_+3A_xlab">xlab</code></td>
<td>
<p>A title for the <code>x</code> axis: see <code><a href="graphics.html#topic+title">title</a></code>.</p>
</td></tr>
<tr><td><code id="plot.survIDM_+3A_ylab">ylab</code></td>
<td>
<p>A title for the <code>y</code> axis: see <code><a href="graphics.html#topic+title">title</a></code>.</p>
</td></tr>
<tr><td><code id="plot.survIDM_+3A_ylim">ylim</code></td>
<td>
<p>The <code>y</code> limits of the plot.</p>
</td></tr>
<tr><td><code id="plot.survIDM_+3A_xlim">xlim</code></td>
<td>
<p>The <code>x</code> limits of the plot.</p>
</td></tr>
<tr><td><code id="plot.survIDM_+3A_...">...</code></td>
<td>
<p>Other options.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value is returned.</p>


<h3>Author(s)</h3>

<p>Luis Meira-Machado, Marta Sestelo and Gustavo Soutinho.</p>


<h3>Examples</h3>

<pre><code class='language-R'>res &lt;- tprob(survIDM(time1, event1, Stime, event) ~ 1, s = 0,
method = "AJ", conf = FALSE, data = colonIDM)

plot(res)
plot(res, trans = "02")


res1 &lt;- tprob(survIDM(time1, event1, Stime, event) ~ factor(sex), s = 365,
method = "AJ", conf = FALSE, data = colonIDM)

plot(res1, trans="02", ylim=c(0,0.5))


res2 &lt;- CIF(survIDM(time1, event1, Stime, event) ~ age, data = colonIDM,
z.value = 56, conf = FALSE)

plot(res2)


res3 &lt;- sojourn(survIDM(time1, event1, Stime, event) ~ factor(sex),
data = colonIDM, conf = FALSE, conf.level = 0.95)

plot(res3)

</code></pre>

<hr>
<h2 id='sojourn'>Nonparametric estimation of the Sojourn time distributions in the
recurrence state in the illness-death model</h2><span id='topic+sojourn'></span>

<h3>Description</h3>

<p>This function is used to obtain nonparametric estimates of
of the sojourn probabilities in the recurrence state in the illness-death
model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sojourn(
  formula,
  data,
  conf = FALSE,
  n.boot = 199,
  conf.level = 0.95,
  z.value,
  bw = "dpik",
  window = "gaussian",
  method.weights = "NW",
  method = "LM",
  presmooth = FALSE,
  cluster = FALSE,
  ncores = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sojourn_+3A_formula">formula</code></td>
<td>
<p>A <code>formula</code> object, which must have a <code>survIDM</code>
object as the response on the left of the <code>~</code> operator and, if desired,
a term on the right. The term may be a qualitative or quantitative variable.
Without covariates, the right hand side should be <code>~ 1</code>.</p>
</td></tr>
<tr><td><code id="sojourn_+3A_data">data</code></td>
<td>
<p>A data.frame including at least four columns named
<code>time1</code>, <code>event1</code>, <code>Stime</code> and <code>event</code>, which correspond
to disease free survival time, disease free survival indicator, time to death
or censoring, and death indicator, respectively.</p>
</td></tr>
<tr><td><code id="sojourn_+3A_conf">conf</code></td>
<td>
<p>Provides pointwise confidence bands. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="sojourn_+3A_n.boot">n.boot</code></td>
<td>
<p>The number of bootstrap replicates to compute the variance
of the non-Markovian estimator. Default is 199.</p>
</td></tr>
<tr><td><code id="sojourn_+3A_conf.level">conf.level</code></td>
<td>
<p>Level of confidence. Defaults to 0.95 (corresponding to 95%).</p>
</td></tr>
<tr><td><code id="sojourn_+3A_z.value">z.value</code></td>
<td>
<p>The value of the covariate on the right hand side of formula
at which the sojourn probabilities are computed. For quantitative
covariates, i.e. of class integer and numeric.</p>
</td></tr>
<tr><td><code id="sojourn_+3A_bw">bw</code></td>
<td>
<p>A single numeric value to compute a kernel density bandwidth.
Use <code>"dpik"</code> for the <span class="pkg">KernSmooth</span> package based selector or <code>"np"</code>
for the <code>'npudensbw'</code> function of the <span class="pkg">np</span> package.</p>
</td></tr>
<tr><td><code id="sojourn_+3A_window">window</code></td>
<td>
<p>A character string specifying the desired kernel.
See details below for possible options. Defaults to <code>"gaussian"</code>
where the gaussian density kernel will be used.</p>
</td></tr>
<tr><td><code id="sojourn_+3A_method.weights">method.weights</code></td>
<td>
<p>A character string specifying the desired weights method.
Possible options are <code>"NW"</code> for the Nadaraya-Watson weights and <code>"LL"</code>
for local linear weights. Defaults to <code>"NW"</code>.</p>
</td></tr>
<tr><td><code id="sojourn_+3A_method">method</code></td>
<td>
<p>The method used to compute the sojourn estimates.
Possible options are <code>"LM"</code> and <code>"Satten-Datta"</code>.
Defaults to <code>"LM"</code>.</p>
</td></tr>
<tr><td><code id="sojourn_+3A_presmooth">presmooth</code></td>
<td>
<p>- A logical value. If <code>TRUE</code>, the presmoothed landmark
estimator of the sojourn function is computed. Only valid for <code>method = "LM"</code>.</p>
</td></tr>
<tr><td><code id="sojourn_+3A_cluster">cluster</code></td>
<td>
<p>A logical value. If <code>TRUE</code> (default), the bootstrap procedure
for the confidence intervals is parallelized. Note that there are
cases (e.g., a low number of bootstrap repetitions) that <span class="rlang"><b>R</b></span> will gain in
performance through serial computation. <span class="rlang"><b>R</b></span> takes time to distribute tasks
across the processors also it will need time for binding them all together
later on. Therefore, if the time for distributing and gathering pieces
together is greater than the time need for single-thread computing,
it does not worth parallelize.</p>
</td></tr>
<tr><td><code id="sojourn_+3A_ncores">ncores</code></td>
<td>
<p>An integer value specifying the number of cores to be used in
the parallelized procedure. If <code>NULL</code> (default), the number of cores
to be used is equal to the number of cores of the machine - 1.
</p>
<p>#'</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Possible options for argument window are <code>"gaussian"</code>,
<code>"epanechnikov"</code>, <code>"tricube"</code>, <code>"boxcar"</code>,
<code>"triangular"</code>, <code>"quartic"</code> or <code>"cosine"</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>"survIDM"</code> and one of the following
two classes: <code>"soj"</code> (Sojourn Time Distribution), and
<code>"sojIPCW"</code> (Inverse Probability of Censoring Weighting for the Sojourn Time Distribution). Objects are implemented as a list with elements:
</p>
<table>
<tr><td><code>est</code></td>
<td>
<p>data.frame with estimates of the sojourn probabilities.</p>
</td></tr>
<tr><td><code>CI</code></td>
<td>
<p>data.frame with the confidence intervals of the sojourn
probabilities.</p>
</td></tr>
<tr><td><code>conf.level</code></td>
<td>
<p>Level of confidence.</p>
</td></tr>
<tr><td><code>t</code></td>
<td>
<p>The time for obtaining the estimates of sojourn probabilities.</p>
</td></tr>
<tr><td><code>conf</code></td>
<td>
<p>logical; if <code>FALSE</code> (default) the pointwise confidence
bands are not given.</p>
</td></tr>
<tr><td><code>callp</code></td>
<td>
<p>The expression of the estimated probability.</p>
</td></tr>
<tr><td><code>Nlevels</code></td>
<td>
<p>The number of levels of the covariate. Provides important
information when the covariate at the right hand side of formula
is of class factor.</p>
</td></tr>
<tr><td><code>levels</code></td>
<td>
<p>The levels of the qualitative covariate
(if it is of class factor) on the right hand side of formula.</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>A formula object.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>A call object.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Luis Meira-Machado, Marta Sestelo and Gustavo Soutinho.
</p>


<h3>References</h3>

<p>Satten, G.A. and Datta, S. (2002) Marginal estimation for
multi-stage models: waiting time distributions and competing risks
analyses. Statistics in Medicine, 21, 3&ndash;19.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
res &lt;- sojourn(survIDM(time1, event1, Stime, event) ~ 1,
data = colonIDM, conf = FALSE, conf.level = 0.95)
res
summary(res, time=365*1:6)
plot(res)

res1 &lt;- sojourn(survIDM(time1, event1, Stime, event) ~ 1,
data = colonIDM, conf = FALSE, conf.level = 0.95, method = "LM",
presmooth = TRUE)
res1
summary(res1, time=365*1:6)
plot(res1)


# not run:
#res2 &lt;- sojourn(survIDM(time1, event1, Stime, event) ~ 1,
#data = colonIDM, conf = FALSE, conf.level = 0.95, method = "Satten-Datta")
#res2


# with a factor
res3 &lt;- sojourn(survIDM(time1, event1, Stime, event) ~ factor(sex),
data = colonIDM, conf = FALSE, conf.level = 0.95)
res3
summary(res3, time=365*1:6)
plot(res3)

# with a qualitative covariate
res4 &lt;- sojourn(survIDM(time1, event1, Stime, event) ~ age, data = colonIDM,
z.value = 56, conf = FALSE, conf.level = 0.95)
res4
summary(res4, time=365*1:6)
plot(res4)

</code></pre>

<hr>
<h2 id='summary.cmm'>Summarizing fits of <code>cmm</code> class</h2><span id='topic+summary.cmm'></span><span id='topic+print.cmm'></span>

<h3>Description</h3>

<p>Produces a summary of a fitted coxidm model (proportional
hazards regression model in each transition of the Illness-Death Model.</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'cmm'
summary(object, type=NULL, conf.level = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.cmm_+3A_object">object</code></td>
<td>
<p>A fitted <code>cmm</code> object as produced by <code>coxidm()</code>.</p>
</td></tr>
<tr><td><code id="summary.cmm_+3A_type">type</code></td>
<td>
<p>Type of summary of the Cox model. Default value is <code>"NULL"</code>
that produces a summary of a fitted coxidm model. Possible choices are
<code>"anova"</code> and <code>"ph"</code>. The <code>"anova"</code> option provides the
Analysis of Deviance of the regression model. The <code>"ph"</code> option computes
the tests of the proportional hazards assumption of the Cox Regression models.
</p>
</td></tr>
<tr><td><code id="summary.cmm_+3A_conf.level">conf.level</code></td>
<td>
<p>Level for computation of the confidence intervals. If set
to <code>FALSE</code> no confidence intervals are printed.</p>
</td></tr>
<tr><td><code id="summary.cmm_+3A_...">...</code></td>
<td>
<p>Other options.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame or a list containing the following components:
</p>
<table>
<tr><td><code>coef</code></td>
<td>
<p>Estimated coeficients.</p>
</td></tr>
<tr><td><code>exp(coef)</code></td>
<td>
<p>Exponent of the estimated coefficients.</p>
</td></tr>
<tr><td><code>lower 0.95</code></td>
<td>
<p>Lower limit of the confidence interval.</p>
</td></tr>
<tr><td><code>upper 0.95</code></td>
<td>
<p>Upper limit of the confidence interval.</p>
</td></tr>
<tr><td><code>pvalue</code></td>
<td>
<p>obtained pvalue testing that the coefficient is equals to zero.</p>
</td></tr>
</table>
<p>Other data frames with the Analysis of Deviance or the tests of the
Proportional Hazards Assumption
of the Cox Regression models.
</p>


<h3>Author(s)</h3>

<p>Luis Meira-Machado, Marta Sestelo and Gustavo Soutinho.</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  cmm1 &lt;- coxidm(survIDM(time1, event1, Stime, event) ~ age, data = colonIDM)
  summary(cmm1, conf.level = 0.95)

  cmm2 &lt;- coxidm(survIDM(time1, event1, Stime, event) ~ rx + sex + age + nodes,
                 data = colonIDM)
  summary(cmm2)

  summary(cmm2,type = 'anova')

  cmm3 &lt;- coxidm(survIDM(time1, event1, Stime, event) ~ rx + sex + age + nodes,
                 data = colonIDM, semiMarkov = TRUE)
  summary(cmm3)

  cmm4 &lt;- coxidm(survIDM(time1, event1, Stime, event) ~ rx + sex + age +
                pspline(nodes) + surg + adhere, data = colonIDM)

  summary(cmm4, type = 'ph')
  
</code></pre>

<hr>
<h2 id='summary.survIDM'>Summarizing fits of <code>survIDM</code> class</h2><span id='topic+summary.survIDM'></span><span id='topic+print.survIDM'></span>

<h3>Description</h3>

<p>Returns a a data.frame or list containing the estimates of
the probabilities, its confidence limits and other information. </p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'survIDM'
summary(object, times = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.survIDM_+3A_object">object</code></td>
<td>
<p>A fitted <code>survIDM</code> object as produced by <code>tprob()</code>, <code>CIF()</code> or <code>sojourn()</code>.</p>
</td></tr>
<tr><td><code id="summary.survIDM_+3A_times">times</code></td>
<td>
<p>Vector of times; the returned data frame will contain 1 row
for each time. Missing values are not allowed.</p>
</td></tr>
<tr><td><code id="summary.survIDM_+3A_...">...</code></td>
<td>
<p>For future methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame or a list containing the following components:
</p>
<table>
<tr><td><code>y</code></td>
<td>
<p>The total time for obtaining the estimates of the probabilities.</p>
</td></tr>
<tr><td><code>est</code></td>
<td>
<p>Estimates of the probability.</p>
</td></tr>
<tr><td><code>lower 95% CI</code></td>
<td>
<p>The lower probabilities of the interval.</p>
</td></tr>
<tr><td><code>upper 95% CI</code></td>
<td>
<p>The upper probabilities of the interval.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Luis Meira-Machado, Marta Sestelo and Gustavo Soutinho.</p>


<h3>Examples</h3>

<pre><code class='language-R'>fit &lt;- tprob(survIDM(time1,event1,Stime, event) ~ 1, s = 365,
method = "AJ", conf = TRUE, conf.level = 0.95,
conf.type = "linear", n.boot = 50, data = colonIDM)

summary(fit)
summary(fit, times = c(400, 1000, 2900))

    </code></pre>

<hr>
<h2 id='survIDM'>Create a survIDM object</h2><span id='topic+survIDM'></span>

<h3>Description</h3>

<p>Creates a &quot;survIDM&quot; object, usually used as a response
variable in a model formula.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>survIDM(time1, event1, Stime, event, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="survIDM_+3A_time1">time1</code></td>
<td>
<p>First time or censoring time.</p>
</td></tr>
<tr><td><code id="survIDM_+3A_event1">event1</code></td>
<td>
<p>Indicator of the first time; 0 if the first time is censored
and 1 otherwise.</p>
</td></tr>
<tr><td><code id="survIDM_+3A_stime">Stime</code></td>
<td>
<p>The total time of the process.</p>
</td></tr>
<tr><td><code id="survIDM_+3A_event">event</code></td>
<td>
<p>Censoring indicator of the survival time of the process; 0 if
the total time is censored and 1 otherwise.</p>
</td></tr>
<tr><td><code id="survIDM_+3A_...">...</code></td>
<td>
<p>Other options.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Arguments in this function must be introduced in the following
order: <code>time1</code>, <code>event1</code>, <code>Stime</code> and <code>event</code>, where
<code>time1</code> and <code>Stime</code> are the sojourn time in the initial state and
the total time, respectively. <code>event1</code> and <code>event</code> denote their
corresponding indicator statuses. This function checks the following
conditions: (i) the arguments <code>time1</code> and <code>Stime</code> must be numeric
and nonnegative; <code>event1</code> and <code>event</code> must be 0 or 1 if numeric
and TRUE or FALSE if logical. <code>Stime</code> must be greater or equal to
argument arguments <code>time1</code>. <code>Stime</code> and <code>time1</code> must be
equal when argument <code>event1</code> equals 0 or FALSE. Argument <code>event</code>
must be equal to 0 or FALSE when argument <code>event1</code> equals 0 or FALSE.
When arguments <code>Stime</code> and <code>time1</code> are equal and argument
<code>event1</code> equals 1 or TRUE, argument <code>event</code> must be equal to
1 or TRUE.
</p>


<h3>Value</h3>

<p>An object of class &quot;survIDM&quot;. &quot;survIDM&quot; objects are implemented
as a single dataframe.
</p>


<h3>Author(s)</h3>

<p>Luis Meira-Machado, Marta Sestelo and Gustavo Soutinho.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>with(colonIDM, survIDM(time1, event1, Stime, event))
</code></pre>

<hr>
<h2 id='tprob'>Nonparametric estimation of transition probabilities in
the illness-death model</h2><span id='topic+tprob'></span>

<h3>Description</h3>

<p>This function is used to obtain nonparametric estimates of
the transition probabilities in the illness-death model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tprob(
  formula,
  s,
  method = "AJ",
  conf = FALSE,
  conf.level = 0.95,
  conf.type = "log",
  n.boot = 199,
  data,
  z.value,
  bw = "dpik",
  window = "gaussian",
  method.weights = "NW",
  cluster = FALSE,
  ncores = NULL,
  na.rm = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tprob_+3A_formula">formula</code></td>
<td>
<p>A <code>formula</code> object, which must have a <code>survIDM</code>
object as the response on the left of the <code>~</code> operator and, if desired,
a term on the right. The term may be a qualitative or quantitative variable.
Without covariates, the right hand side should be <code>~ 1</code>.</p>
</td></tr>
<tr><td><code id="tprob_+3A_s">s</code></td>
<td>
<p>The first time for obtaining estimates for the transition
probabilities. If missing, 0 will be used.</p>
</td></tr>
<tr><td><code id="tprob_+3A_method">method</code></td>
<td>
<p>The method used to compute the transition probabilities.
Possible options are <code>"AJ"</code>, <code>"LIDA"</code> <code>"LM"</code>, <code>"PLM"</code>,
<code>"LMAJ"</code>, <code>"PLMAJ"</code>, <code>"PAJ"</code>, <code>"IPCW"</code> and <code>"breslow"</code>.
Defaults to <code>"AJ"</code>. The <code>"IPCW"</code> method
is recommended to obtain conditional transition probabilities (i.e., with a
quantitative term on the right hand side of formula). The <code>"breslow"</code> method
is based on a Cox's regression model (Cox, 1972) fitted marginally to each allowed
transition, with the corresponding baseline hazard function estimated by the
Breslow's method (Breslow, 1972).</p>
</td></tr>
<tr><td><code id="tprob_+3A_conf">conf</code></td>
<td>
<p>Provides pointwise confidence bands. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="tprob_+3A_conf.level">conf.level</code></td>
<td>
<p>Level of confidence. Defaults to 0.95 (corresponding to 95%).</p>
</td></tr>
<tr><td><code id="tprob_+3A_conf.type">conf.type</code></td>
<td>
<p>Method to compute the confidence intervals. Depends on the
choice of the estimation method of the transition probabilities. For
Aalen-Johansen type estimators (<code>"AJ"</code>, <code>"LMAJ"</code>, <code>"PAJ"</code> and
<code>"PLMAJ"</code>) possible choices are <code>"linear"</code>, <code>"log"</code> and
<code>"log-log"</code>. Default method is <code>"log"</code>. The <code>"linear"</code> option provides
the standard intervals curve +-k *se(curve), where k is determined from <code>"conf.int"</code>.
The <code>"log"</code> option calculates the intervals based on the cumulative hazard or
-log(survival). The <code>"log-log"</code> option uses the log hazard function or
log(-log(survival)). For the remaining estimation methods (<code>"LIDA"</code>,
<code>"LM"</code>, <code>"PLM"</code>, <code>"IPCW"</code> and <code>"breslow"</code>) the percentile
bootstrap which resamples each datum with probability 1/n is used.</p>
</td></tr>
<tr><td><code id="tprob_+3A_n.boot">n.boot</code></td>
<td>
<p>The number of bootstrap replicates to compute the variance
of the non-Markovian estimator. Default is 199.</p>
</td></tr>
<tr><td><code id="tprob_+3A_data">data</code></td>
<td>
<p>A data.frame including at least four columns named
<code>time1</code>, <code>event1</code>, <code>Stime</code> and <code>event</code>, which correspond
to disease free survival time, disease free survival indicator, time to death
or censoring, and death indicator, respectively.</p>
</td></tr>
<tr><td><code id="tprob_+3A_z.value">z.value</code></td>
<td>
<p>The value of the covariate on the right hand side of formula
at which the transition probabilities are computed. For quantitative
covariates, i.e. of class integer and numeric.</p>
</td></tr>
<tr><td><code id="tprob_+3A_bw">bw</code></td>
<td>
<p>A single numeric value to compute a kernel density bandwidth.
Use <code>"dpik"</code> for the <span class="pkg">KernSmooth</span> package based selector or <code>"np"</code>
for the <code>'npudensbw'</code> function of the <span class="pkg">np</span> package.</p>
</td></tr>
<tr><td><code id="tprob_+3A_window">window</code></td>
<td>
<p>A character string specifying the desired kernel.
See details below for possible options. Defaults to <code>"gaussian"</code>
where the gaussian density kernel will be used.</p>
</td></tr>
<tr><td><code id="tprob_+3A_method.weights">method.weights</code></td>
<td>
<p>A character string specifying the desired weights method.
Possible options are <code>"NW"</code> for the Nadaraya-Watson weights and <code>"LL"</code>
for local linear weights. Defaults to <code>"NW"</code>.</p>
</td></tr>
<tr><td><code id="tprob_+3A_cluster">cluster</code></td>
<td>
<p>A logical value. If <code>TRUE</code> (default), the bootstrap procedure
for the confidence intervals is parallelized. Note that there are
cases (e.g., a low number of bootstrap repetitions) that <span class="rlang"><b>R</b></span> will gain in
performance through serial computation. <span class="rlang"><b>R</b></span> takes time to distribute tasks
across the processors also it will need time for binding them all together
later on. Therefore, if the time for distributing and gathering pieces
together is greater than the time need for single-thread computing,
it does not worth parallelize.</p>
</td></tr>
<tr><td><code id="tprob_+3A_ncores">ncores</code></td>
<td>
<p>An integer value specifying the number of cores to be used in
the parallelized procedure. If <code>NULL</code> (default), the number of cores
to be used is equal to the number of cores of the machine - 1.</p>
</td></tr>
<tr><td><code id="tprob_+3A_na.rm">na.rm</code></td>
<td>
<p>A logical value indicating whether NA values should
be stripped in the computation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Possible options for argument window are <code>"gaussian"</code>,
<code>"epanechnikov"</code>, <code>"tricube"</code>, <code>"boxcar"</code>,
<code>"triangular"</code>, <code>"quartic"</code> or <code>"cosine"</code>. The LIDA estimator
was labelled according to the acronym of the Lifetime Data Analysis journal
in which the estimator was described for the first time (Meira-Machado,
U?a-?lvarez and Cadarso-Su?rez, 2006).
</p>
<p>Possible methods are:
</p>

<ul>
<li><p><code>AJ</code> Aalen-Johansen estimator
</p>
</li>
<li><p><code>PAJ</code> Presmoothed Aalen-Johansen estimator
</p>
</li>
<li><p><code>LIDA</code> LIDA estimator
</p>
</li>
<li><p><code>LM</code> Landmark approach estimator
</p>
</li>
<li><p><code>PLM</code> Presmoothed Landmark approach estimator
</p>
</li>
<li><p><code>LMAJ</code> Landmark approach Aalen-Johansen estimator
</p>
</li>
<li><p><code>PLDAJ</code> Presmoothed Landmark approach Aalen-Johansen estimator
</p>
</li>
<li><p><code>tpIPCW</code> Inverse Probability of Censoring Weighting for Transition Probabilities
</p>
</li>
<li><p><code>tpBreslow</code> Breslow method
</p>
</li></ul>



<h3>Value</h3>

<p>An object of class <code>"survIDM"</code> and one of the following
five classes: <code>"AJ"</code>, <code>"LIDA"</code>, <code>"LM"</code>, <code>"PLM"</code>,
<code>"LMAJ"</code>, <code>"PLMAJ"</code>, <code>"PAJ"</code>,
<code>"tpIPCW"</code> and <code>"tpBreslow"</code>. Objects are implemented as a list with elements:
</p>
<table>
<tr><td><code>est</code></td>
<td>
<p>data.frame with estimates of the transition probabilities.</p>
</td></tr>
<tr><td><code>CI</code></td>
<td>
<p>data.frame with the confidence intervals of the transition probabilities.</p>
</td></tr>
<tr><td><code>conf.level</code></td>
<td>
<p>Level of confidence.</p>
</td></tr>
<tr><td><code>s</code></td>
<td>
<p>The first time for obtaining estimates for the transition probabilities.</p>
</td></tr>
<tr><td><code>t</code></td>
<td>
<p>The time for obtaining the estimates of transition probabilities.</p>
</td></tr>
<tr><td><code>conf</code></td>
<td>
<p>logical; if <code>FALSE</code> (default) the pointwise confidence
bands are not given.</p>
</td></tr>
<tr><td><code>conf.type</code></td>
<td>
<p>Type of the confidence interval.</p>
</td></tr>
<tr><td><code>callp</code></td>
<td>
<p>The expression of the estimated probability.</p>
</td></tr>
<tr><td><code>Nlevels</code></td>
<td>
<p>The number of levels of the covariate. Provides important
information when the covariate at the right hand side of formula
is of class factor.</p>
</td></tr>
<tr><td><code>levels</code></td>
<td>
<p>The levels of the qualitative covariate
(if it is of class factor) on the right hand side of formula.</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>A formula object.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>A call object.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Luis Meira-Machado, Marta Sestelo and Gustavo Soutinho.
</p>


<h3>References</h3>

<p>Aalen O. O., Johansen S. (1978) An Empirical Transition Matrix for
Nonhomogeneous Markov Chains Based on Censored Observations. Scandinavian
Journal of Statistics 5(3), 141&ndash;150.
</p>
<p>Meira-Machado L. F., de Una-Alvarez J. and Cadarso-Suarez C. (2006).
Nonparametric estimation of transition probabilities in a non-Markov
illness-death model. Lifetime Data Anal 12(3), 325&ndash;344.
</p>
<p>de Una-Alvarez J. and Meira-Machado L. (2015). Nonparametric estimation
of transition probabilities in a non-Markov illness-death model:
a comparative study. Biometrics 71, 364&ndash;375.
</p>
<p>Cox, DR (1972). Regression models and life tables (with discussion). Journal
of the Royal Statistical Society, Series B 34, 187-200.
</p>
<p>Breslow, N. (1972). Discussion of paper by dr cox. Journal of Royal Statistical
Society, Series B 34, 216-217.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Aalen-Johansen
res &lt;- tprob(survIDM(time1, event1, Stime, event) ~ 1, s = 0,
method = "AJ", conf = FALSE, data = colonIDM)
summary(res, time=365*1:6)
plot(res)
# Transition Probabilities Pij(t)=Pij(365,t)
# LIDA
res1 &lt;- tprob(survIDM(time1, event1, Stime, event) ~ 1, s = 365,
             method = "LIDA", conf = FALSE, data = colonIDM)

summary(res1, time=365*1:6)
plot(res1)
plot(res1, trans="01", ylim=c(0,0.15))
# Landmark (LM)
res2 &lt;- tprob(survIDM(time1, event1, Stime, event) ~ 1, s = 365,
              method = "LM", conf = FALSE, data = colonIDM)
summary(res2, time=365*1:6)
plot(res2)
# Presmoothed LM
res3 &lt;- tprob(survIDM(time1, event1, Stime, event) ~ 1, s = 365,
              method = "PLM", conf = TRUE, data = colonIDM)
summary(res3, time=365*1:6)
autoplot(res3, interactive = TRUE)
# Conditional transition probabilities
# With factor
res4 &lt;- tprob(survIDM(time1, event1, Stime, event) ~ factor(sex), s = 365,
              method = "AJ", conf = TRUE, data = colonIDM)
summary(res4, time=365*1:6)
plot(res4, trans="02", ylim=c(0,0.5))
res5 &lt;- tprob(survIDM(time1, event1, Stime, event) ~ rx, s =365,
              method = "breslow", z.value='Lev', conf = TRUE, data =colonIDM)
summary(res5, time=365*1:6)
plot(res5,trans="02", ylim=c(0,0.5))
# with continuous covariate (IPCW and Breslow Method)
res6 &lt;- tprob(survIDM(time1, event1, Stime, event) ~ age, s = 365,
              method = "IPCW", z.value = 48, conf = FALSE, data = colonIDM,
              bw = "dpik", window = "gaussian", method.weights = "NW")
summary(res6, time=365*1:6)
plot(res6)
res7 &lt;- tprob(survIDM(time1, event1, Stime, event) ~ age, s =365,
              method = "breslow", z.value=60, conf = FALSE, data =colonIDM)
summary(res7, time=365*1:6)
autoplot(res7, interactive=TRUE)
res8 &lt;- tprob(survIDM(time1, event1, Stime, event) ~ age, s =365,
              method = "breslow", conf.type='bootstrap', z.value=60, conf = TRUE, data =colonIDM)
summary(res8, time=365*1:6)
plot(res8)
res9 &lt;- tprob(survIDM(time1, event1, Stime, event) ~ rx, s =365,
              method = "breslow", conf.type='bootstrap',  conf = TRUE, data =colonIDM)
summary(res9, time=365*1:6)
plot(res9, trans="02", ylim=c(0,0.5))
# more than a covariate (Breslow Method)
res10&lt;- tprob(survIDM(time1, event1, Stime, event) ~ nodes + factor(rx), s =365,
              method = "breslow", conf = TRUE, data =colonIDM)
summary(res10,t=365*1:5)
autoplot(res10)
res11&lt;- tprob(survIDM(time1, event1, Stime, event) ~ nodes + factor(rx), s =365,
              method = "breslow", z.value=c(10,'Obs'), conf = TRUE, data =colonIDM)
summary(res11,t=365*1:5)
autoplot(res11)
# more than a covariate for Non Linear Models (Breslow Method)
res12&lt;- tprob(survIDM(time1, event1, Stime, event) ~ pspline(age)+ nodes + factor(rx), s =365,
              method = "breslow", conf = TRUE, data =colonIDM)
summary(res12,t=365*1:5)
autoplot(res12)
# Confidence intervals
res13 &lt;- tprob(survIDM(time1, event1, Stime, event) ~ 1, s = 365,
               method = "AJ", conf = TRUE, n.boot = 5, conf.level = 0.95,
               conf.type = "log", data = colonIDM)
summary(res13, time=365*1:7)
autoplot(res13)

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
