<!DOCTYPE html><html lang="en"><head><title>Help for package POCRE</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {POCRE}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cvpocre'>
<p>Use k-Fold Cross-Validation to Choose the Tuning Parameter for POCRE</p></a></li>
<li><a href='#gps'>
<p>Screen Variables for Generalized Linear Models via Generalized POCRE</p></a></li>
<li><a href='#plot.pocre'>
<p>Visualization of a <code>pocre</code> Object</p></a></li>
<li><a href='#plot.pocrepath'>
<p>Visulaization of a POCRE Path</p></a></li>
<li><a href='#pocre'>
<p>Penalized Orthogonal-Components Regression (POCRE)</p></a></li>
<li><a href='#pocrepath'>
<p>Build a POCRE Path for Different Values of Tuning Parameters</p></a></li>
<li><a href='#pocrescreen'>
<p>Screen Variables Using Penalized Orthogonal-Components Regression (POCRE)</p></a></li>
<li><a href='#selectmodel'>
<p>Select the Optimal Model</p></a></li>
<li><a href='#sim5ydata'>
<p>A Set of Simulated Data with Multiple Response Variables</p></a></li>
<li><a href='#simbin'>
<p>A Set of Simulated Binomial Data.</p></a></li>
<li><a href='#simdata'>
<p>A Set of Simulated Data with Single Gaussian Response Variable</p></a></li>
<li><a href='#simpoi'>
<p>A Set of Simulated Poisson Data.</p></a></li>
<li><a href='#sipocre'>
<p>Penalized Orthogonal-Components Regression (POCRE) with Significance Inference</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Penalized Orthogonal-Components Regression</td>
</tr>
<tr>
<td>Version:</td>
<td>0.6.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-03-15</td>
</tr>
<tr>
<td>Author:</td>
<td>Dabao Zhang, Zhongli Jiang, Zeyu Zhang, Yu-ting Chen</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Dabao Zhang &lt;zhangdb@purdue.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Penalized orthogonal-components regression (POCRE) is a supervised dimension reduction method for high-dimensional data. It sequentially constructs orthogonal components (with selected features) which are maximally correlated to the response residuals. POCRE can also construct common components for multiple responses and thus build up latent-variable models.</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats,utils,ggplot2 (&ge; 2.2.0),pracma,EbayesThresh</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-03-16 17:48:42 UTC; admin-zhangdb</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-03-16 18:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='cvpocre'>
Use k-Fold Cross-Validation to Choose the Tuning Parameter for POCRE
</h2><span id='topic+cvpocre'></span>

<h3>Description</h3>

<p>Choose the optimal tuning parameter via k-fold cross-validation for POCRE.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cvpocre(y, x, n.folds=10, delta=0.1, maxvar=dim(x)[1]/2,
        ptype=c('ebtz','ebt','l1','scad','mcp'), maxit=100,
        maxcmp=10, gamma=3.7, lambda.init=1, tol=1e-6,
        crit=c('press','Pearson','Spearman','Kendall'))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cvpocre_+3A_y">y</code></td>
<td>

<p>n*q matrix, values of q response variables (allow for multiple response variables).
</p>
</td></tr>
<tr><td><code id="cvpocre_+3A_x">x</code></td>
<td>

<p>n*p matrix, values of p predicting variables (excluding the intercept).
</p>
</td></tr>
<tr><td><code id="cvpocre_+3A_n.folds">n.folds</code></td>
<td>

<p>number of folds to split the data (10-fold CV by default).
</p>
</td></tr>
<tr><td><code id="cvpocre_+3A_delta">delta</code></td>
<td>

<p>step size of different values of the tuning parameter.
</p>
</td></tr>
<tr><td><code id="cvpocre_+3A_maxvar">maxvar</code></td>
<td>

<p>maximum number of selected variables.
</p>
</td></tr>
<tr><td><code id="cvpocre_+3A_ptype">ptype</code></td>
<td>

<p>a character to indicate the type of penalty: <code>'ebtz'</code> (emprical Bayes thresholding after Fisher's z-transformation, by default), <code>'ebt'</code> (emprical Bayes thresholding by Johnstone &amp; Silverman (2004)), <code>'l1'</code> (L_1 penalty), <code>'scad'</code> (SCAD by Fan &amp; Li (2001)), <code>'mcp'</code> (MCP by Zhang (2010)).
</p>
</td></tr>
<tr><td><code id="cvpocre_+3A_maxit">maxit</code></td>
<td>

<p>maximum number of iterations to be allowed.
</p>
</td></tr>
<tr><td><code id="cvpocre_+3A_maxcmp">maxcmp</code></td>
<td>

<p>maximum number of components to be constructed.
</p>
</td></tr>
<tr><td><code id="cvpocre_+3A_gamma">gamma</code></td>
<td>

<p>a parameter used by SCAD and MCP (=3.7 by default).
</p>
</td></tr>
<tr><td><code id="cvpocre_+3A_lambda.init">lambda.init</code></td>
<td>

<p>initial value of the tuning parameter (=1 by default).
</p>
</td></tr>
<tr><td><code id="cvpocre_+3A_tol">tol</code></td>
<td>

<p>tolerance of precision in iterations.
</p>
</td></tr>
<tr><td><code id="cvpocre_+3A_crit">crit</code></td>
<td>

<p>a character to indicate the validation criterion: <code>'press'</code> (prediction residual error sum of squares, by default), <code>'Pearson'</code> (Pearson correlation coefficient), <code>'Spearman'</code> (Spearman's rank correlation coefficient), <code>'Kendall'</code> (Kendall's rank correlation coefficient).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Use k-folds cross-validation to find the optinal value for the tuning parameter. The validation criterion can be chosen from PRESS, or different types of correlation coefficients, such as Pearson's, Spearman's, or Kendall's.
</p>


<h3>Value</h3>

<p>The optimal value of the tuning parameter.
</p>


<h3>Author(s)</h3>

<p>Dabao Zhang, Zhongli Jiang, Zeyu Zhang, Department of Statistics, Purdue University</p>


<h3>References</h3>

<p>Fan J and Li R (2001). Variable selection via nonconcave penalized likelihood and its oracle properties. <em>Journal of the American Statistical Association</em>, 96:1348-1360
</p>
<p>Johnstone IM and Silverman BW (2004). Needles and straw in haystacks: empirical Bayes estimates of possibly sparse sequences. <em>Annals of Statistics</em>, 32: 1594-1649.
</p>
<p>Zhang C-H (2010). Nearly unbiased variable selection under minimax concave penalty. <em>The Annals of Statistics</em>, 38: 894-942.
</p>
<p>Zhang D, Lin Y, and Zhang M (2009). Penalized orthogonal-components regression for large p small n data. <em>Electronic Journal of Statistics</em>, 3: 781-796.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pocrescreen">pocrescreen</a></code>, <code><a href="#topic+pocrepath">pocrepath</a></code>, <code><a href="#topic+pocre">pocre</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(simdata)
n &lt;- dim(simdata)[1]
xx &lt;- simdata[,-1]
yy &lt;- simdata[,1]

# tp &lt;- cvpocre(yy,xx,delta=0.01)
tp &lt;- cvpocre(yy,xx)
print(paste("  pocre: Optimal Tuning Parameter = ", tp))
cvpres &lt;- pocre(yy,xx,lambda=tp,maxvar=n/log(n))

## End(Not run)
</code></pre>

<hr>
<h2 id='gps'>
Screen Variables for Generalized Linear Models via Generalized POCRE
</h2><span id='topic+gps'></span>

<h3>Description</h3>

<p>A pre-specified number (i.e., maxvar) of covariates will be selected for generalized linear models by constructing maxcmp components with generalized POCRE. Each component will be constructed by selecting maxvar/macmp covariates which are most relevant to the response variable(s). Similar to <a href="#topic+pocrescreen">pocrescreen</a>, gps selects covariates for their top relevance to the response variable(s) without penalization.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gps(y, x, family="binomial", bc.method="optimal", x.include=NULL,
    weights=NULL, maxcmp=10, maxvar=NULL, tol = 1e-6, maxit = 100)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gps_+3A_y">y</code></td>
<td>

<p>n*q matrix, values of q response variables (allow for multiple response variables).
</p>
</td></tr>
<tr><td><code id="gps_+3A_x">x</code></td>
<td>

<p>n*p matrix, values of p predicting variables (excluding the intercept).
</p>
</td></tr>
<tr><td><code id="gps_+3A_family">family</code></td>
<td>

<p>Family objects as <code><a href="stats.html#topic+family">family</a></code>. Currently only support <code>"gaussian"</code>, <code>"binomial"</code> (by default), and <code>"poisson"</code>.
</p>
</td></tr>  
<tr><td><code id="gps_+3A_bc.method">bc.method</code></td>
<td>

<p>Bias correction method.
</p>
</td></tr> 
<tr><td><code id="gps_+3A_x.include">x.include</code></td>
<td>

<p>a vector of indices indicating covariates which should always be included in the model (so not counted into selected maxvar covariates).
</p>
</td></tr>
<tr><td><code id="gps_+3A_weights">weights</code></td>
<td>

<p>A vector, including a prespecified weight for each observation (set as 1/n by default).
</p>
</td></tr>
<tr><td><code id="gps_+3A_maxcmp">maxcmp</code></td>
<td>

<p>maximum number of components to be constructed.
</p>
</td></tr>
<tr><td><code id="gps_+3A_maxvar">maxvar</code></td>
<td>

<p>maximum number of selected variables.
</p>
</td></tr>
<tr><td><code id="gps_+3A_tol">tol</code></td>
<td>

<p>tolerance of precision in iterations.
</p>
</td></tr>
<tr><td><code id="gps_+3A_maxit">maxit</code></td>
<td>

<p>maximum number of iterations to be allowed.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of indices of selected covariates (excluding those in x.include).
</p>


<h3>Author(s)</h3>

<p>Dabao Zhang, Zhongli Jiang, Yu-ting Chen, Department of Statistics, Purdue University
</p>


<h3>References</h3>

<p>Zhang D, Lin Y, and Zhang M (2009). Penalized orthogonal-components regression for large p small n data. <em>Electronic Journal of Statistics</em>, 3: 781-796.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pocrescreen">pocrescreen</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  # Binomial Data
  data(simbin)
  gps(simbin[,1], simbin[,-1], maxcmp=3, maxvar=9)
  gps(simbin[,1], simbin[,-1], x.include=103:104, maxcmp=3, maxvar=9)
 
 # Count Data
  data(simpoi)
  gps(simpoi[,1], simpoi[,-1], family='poisson',maxcmp=5,maxvar=10)
</code></pre>

<hr>
<h2 id='plot.pocre'>
Visualization of a <code>pocre</code> Object
</h2><span id='topic+plot.pocre'></span>

<h3>Description</h3>

<p>Plot the regression coefficients, and the loadings of all components for a fitted model by POCRE.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pocre'
plot(x, x.id = NA, which=1:2, cex=.5, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.pocre_+3A_x">x</code></td>
<td>

<p>a <a href="#topic+pocre">pocre</a> object, i.e., the result from <a href="#topic+pocre">pocre</a>.
</p>
</td></tr>
<tr><td><code id="plot.pocre_+3A_x.id">x.id</code></td>
<td>

<p>a vector indicating the indices or positions of the covariates in the original data.
</p>
</td></tr>
<tr><td><code id="plot.pocre_+3A_which">which</code></td>
<td>

<p>1 for plotting the regression coefficients, 2 for plotting the loadings of all components.
</p>
</td></tr>
<tr><td><code id="plot.pocre_+3A_cex">cex</code></td>
<td>

<p>A numerical value giving the amount by which plotting text and symbols should be magnified relative to the default, see <a href="graphics.html#topic+par">par</a>.
</p>
</td></tr>
<tr><td><code id="plot.pocre_+3A_...">...</code></td>
<td>

<p>additional arguments accepted by <a href="ggplot2.html#topic+ggplot">ggplot</a>.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Dabao Zhang, Zhongli Jiang, Zeyu Zhang, Department of Statistics, Purdue University</p>


<h3>References</h3>

<p>Zhang D (2018). R package POCRE: Exploring high-dimensional data via supervised dimension reduction. Manuscript.
</p>
<p>Zhang D, Lin Y, and Zhang M (2009). Penalized orthogonal-components regression for large p small n data. <em>Electronic Journal of Statistics</em>, 3: 781-796.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pocre">pocre</a></code>, <code><a href="#topic+plot.pocrepath">plot.pocrepath</a></code>, <code><a href="#topic+pocrepath">pocrepath</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simdata)
xx &lt;- scale(as.matrix(simdata[,-1]))
yy &lt;- scale(as.matrix(simdata[,1]))

##Fit with pocre()
pres &lt;- pocre(yy, xx, lambda=0.9)

# plot(pres,which=1)
plot(pres)
</code></pre>

<hr>
<h2 id='plot.pocrepath'>
Visulaization of a POCRE Path
</h2><span id='topic+plot.pocrepath'></span>

<h3>Description</h3>

<p>For a series models built by POCRE for different tuning paramter values, it provides three types of plots to help select an appropriate tuning parameter value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pocrepath'
plot(x, which=1:3, cex=.5, lwd=1, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.pocrepath_+3A_x">x</code></td>
<td>

<p>a <a href="#topic+pocrepath">pocrepath</a> object, i.e., the result from <a href="#topic+pocrepath">pocrepath</a>.
</p>
</td></tr>
<tr><td><code id="plot.pocrepath_+3A_which">which</code></td>
<td>

<p>1 for plotting the tuning parameter vs. (beta, #[beta!=0]), 2 for plotting the tuning parameter vs. (beta, R^2), 3 for plotting the tuning parameter vs. (R^2, #[beta!=0]).
</p>
</td></tr>
<tr><td><code id="plot.pocrepath_+3A_cex">cex</code></td>
<td>

<p>A numerical value giving the amount by which plotting text and symbols should be magnified relative to the default, see <a href="graphics.html#topic+par">par</a>.
</p>
</td></tr>
<tr><td><code id="plot.pocrepath_+3A_lwd">lwd</code></td>
<td>

<p>line width, see <a href="graphics.html#topic+par">par</a>.
</p>
</td></tr>
<tr><td><code id="plot.pocrepath_+3A_...">...</code></td>
<td>

<p>additional arguments accepted by <a href="ggplot2.html#topic+ggplot">ggplot</a>.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Dabao Zhang, Zhongli Jiang, Zeyu Zhang, Department of Statistics, Purdue University</p>


<h3>References</h3>

<p>Zhang D (2018). R package POCRE: Exploring high-dimensional data via supervised dimension reduction. Manuscript.
</p>
<p>Zhang D, Lin Y, and Zhang M (2009). Penalized orthogonal-components regression for large p small n data. <em>Electronic Journal of Statistics</em>, 3: 781-796.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pocrepath">pocrepath</a></code>, <code><a href="#topic+plot.pocre">plot.pocre</a></code>, <code><a href="#topic+pocre">pocre</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simdata)
xx &lt;- scale(as.matrix(simdata[,-1]))
yy &lt;- scale(as.matrix(simdata[,1]))

# ppres &lt;- pocrepath(yy, xx, delta=0.01)
ppres &lt;- pocrepath(yy, xx)

# plot(ppres)
plot(ppres,which=3)
</code></pre>

<hr>
<h2 id='pocre'>
Penalized Orthogonal-Components Regression (POCRE)
</h2><span id='topic+pocre'></span>

<h3>Description</h3>

<p>Apply POCRE with a pre-specified tuning parameter to build a linear regression model with orthogonal components <code class="reqn">X\vartheta_1, X\vartheta_2, \dots</code>,
</p>
<p style="text-align: center;"><code class="reqn">Y=\mu+\sum_j (X\varpi_j)\vartheta_j+\epsilon=\mu+X\beta+\epsilon,</code>
</p>

<p>where <code class="reqn">var[\epsilon]=\sigma^2</code> and <code class="reqn">\beta=\sum_j \varpi_j\vartheta_j</code>. These orthogonal components are sequentially constructed according to supervised dimension reduction under penalty set by the pre-specified tuning parameter.
</p>
<p>While the orthogonal components are constructed using the centralized covariates, the intercept <code class="reqn">\mu</code> and regression coefficients in <code class="reqn">\beta</code> are estimated for original covariates. The sequential construction stops when no new component can be constructed (returning bSparse=1), or the new component is constructed with more than maxvar covariates (returning bSparse=0).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pocre(y, x, lambda=1, x.nop=NA, maxvar=dim(x)[1]/2,
      maxcmp=10, ptype=c('ebtz','ebt','l1','scad','mcp'),
      maxit=100, tol=1e-6, gamma=3.7, pval=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pocre_+3A_y">y</code></td>
<td>

<p>n*q matrix, values of q response variables (allow for multiple response variables).
</p>
</td></tr>
<tr><td><code id="pocre_+3A_x">x</code></td>
<td>

<p>n*p matrix, values of p predicting variables (excluding the intercept).
</p>
</td></tr>
<tr><td><code id="pocre_+3A_lambda">lambda</code></td>
<td>

<p>the tuning parameter (=1 by default).
</p>
</td></tr>
<tr><td><code id="pocre_+3A_x.nop">x.nop</code></td>
<td>

<p>a vector indicating indices of covariates which are excluded only when evaluating the significance of components.
</p>
</td></tr>
<tr><td><code id="pocre_+3A_maxvar">maxvar</code></td>
<td>

<p>maximum number of selected variables.
</p>
</td></tr>
<tr><td><code id="pocre_+3A_maxcmp">maxcmp</code></td>
<td>

<p>maximum number of components to be constructed.
</p>
</td></tr>
<tr><td><code id="pocre_+3A_ptype">ptype</code></td>
<td>

<p>a character to indicate the type of penalty: <code>'ebtz'</code> (emprical Bayes thresholding after Fisher's z-transformation, by default), <code>'ebt'</code> (emprical Bayes thresholding by Johnstone &amp; Silverman (2004)), <code>'l1'</code> (L_1 penalty), <code>'scad'</code> (SCAD by Fan &amp; Li (2001)), <code>'mcp'</code> (MCP by Zhang (2010)).
</p>
</td></tr>
<tr><td><code id="pocre_+3A_maxit">maxit</code></td>
<td>

<p>maximum number of iterations to be allowed.
</p>
</td></tr>
<tr><td><code id="pocre_+3A_tol">tol</code></td>
<td>

<p>tolerance of precision in iterations.
</p>
</td></tr>
<tr><td><code id="pocre_+3A_gamma">gamma</code></td>
<td>

<p>a parameter used by SCAD and MCP (=3.7 by default).
</p>
</td></tr>
<tr><td><code id="pocre_+3A_pval">pval</code></td>
<td>

<p>a logical value indicating whether to calculate the p-values of components.
</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>mu</code></td>
<td>
<p>estimated intercept of the linear regression.</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>estimated coefficients of the linear regression.</p>
</td></tr>
<tr><td><code>varpi</code></td>
<td>
<p>loadings of the constructed components.</p>
</td></tr>
<tr><td><code>vartheta</code></td>
<td>
<p>the regression coefficients of the constructed components.</p>
</td></tr>
<tr><td><code>bSparse</code></td>
<td>
<p>a logical value indicating whether estimated beta has less than maxvar nonzero values.</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>value of the tuning paramete.</p>
</td></tr>
<tr><td><code>nCmp</code></td>
<td>
<p>number of constructed components.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>sample size.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>number of covariates.</p>
</td></tr>
<tr><td><code>xShift</code></td>
<td>
<p>the column means of x.</p>
</td></tr>
<tr><td><code>yShift</code></td>
<td>
<p>the column means of y.</p>
</td></tr>
<tr><td><code>sigmae2</code></td>
<td>
<p>estimated error variance <code class="reqn">\sigma^2</code>.</p>
</td></tr>
<tr><td><code>rsq</code></td>
<td>
<p><code class="reqn">R^2</code> value of the fitted regression model.</p>
</td></tr>
<tr><td><code>nzBeta</code></td>
<td>
<p>number of non-zero regression coefficients in <code class="reqn">\beta</code>.</p>
</td></tr>
<tr><td><code>omega</code></td>
<td>
<p>internal matrix.</p>
</td></tr>
<tr><td><code>theta</code></td>
<td>
<p>internal matrix.</p>
</td></tr>
<tr><td><code>pvalue</code></td>
<td>
<p>p-values of constructed components, available when <code>pval=TRUE</code>.</p>
</td></tr>
<tr><td><code>seqpv</code></td>
<td>
<p>Type I p-values of components when sequentially including them into the model, available when <code>pval=TRUE</code>.</p>
</td></tr>
<tr><td><code>indpv</code></td>
<td>
<p>p-values of components when marginally testing each component, available when pval=TRUE.</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p>the loglikelihood function, available when <code>pval=TRUE</code>.</p>
</td></tr>
<tr><td><code>effp</code></td>
<td>
<p>the effective number of predictors, excluding redundant ones, available when pval=TRUE.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Dabao Zhang, Zhongli Jiang, Zeyu Zhang, Department of Statistics, Purdue University</p>


<h3>References</h3>

<p>Fan J and Li R (2001). Variable selection via nonconcave penalized likelihood and its oracle properties. <em>Journal of the American Statistical Association</em>, 96:1348-1360
</p>
<p>Johnstone IM and Silverman BW (2004). Needles and straw in haystacks: empirical Bayes estimates of possibly sparse sequences. <em>Annals of Statistics</em>, 32: 1594-1649.
</p>
<p>Zhang C-H (2010). Nearly unbiased variable selection under minimax concave penalty. <em>The Annals of Statistics</em>, 38: 894-942.
</p>
<p>Zhang D, Lin Y, and Zhang M (2009). Penalized orthogonal-components regression for large p small n data. <em>Electronic Journal of Statistics</em>, 3: 781-796.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.pocre">plot.pocre</a></code>, <code><a href="#topic+pocrescreen">pocrescreen</a></code>, <code><a href="#topic+pocrepath">pocrepath</a></code>, <code><a href="#topic+cvpocre">cvpocre</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simdata)
xx &lt;- simdata[,-1]
yy &lt;- simdata[,1]

#pres &lt;- pocre(yy,xx,lambda=0.9)
pres &lt;- pocre(yy,xx)   # lambda=1 by default
</code></pre>

<hr>
<h2 id='pocrepath'>
Build a POCRE Path for Different Values of Tuning Parameters
</h2><span id='topic+pocrepath'></span>

<h3>Description</h3>

<p>Applying POCRE for a series of tuning parameters chosen by a pre-specified step size. The tuning parameter will increase until non-component can be constructed, and then decrease until a non-sparse regression is constructed (i.e., the number of non-zero coefficients in <code class="reqn">\beta</code> is more than maxvar).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pocrepath(y, x, delta=0.1, maxvar=dim(x)[1]/2, x.nop=NA, maxcmp=10,
          ptype=c('ebtz','ebt','l1','scad','mcp'), lambda.init=1,
          maxit=100, tol=1e-6, maxtps=500, gamma=3.7, pval=(dim(y)[2]==1))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pocrepath_+3A_y">y</code></td>
<td>

<p>n*q matrix, values of q response variables (allow for multiple response variables).
</p>
</td></tr>
<tr><td><code id="pocrepath_+3A_x">x</code></td>
<td>

<p>n*p matrix, values of p predicting variables (excluding the intercept).
</p>
</td></tr>
<tr><td><code id="pocrepath_+3A_delta">delta</code></td>
<td>

<p>step size to increase or decrase from current tuning parameter.
</p>
</td></tr>
<tr><td><code id="pocrepath_+3A_maxvar">maxvar</code></td>
<td>

<p>maximum number of selected variables.
</p>
</td></tr>
<tr><td><code id="pocrepath_+3A_x.nop">x.nop</code></td>
<td>

<p>a vector indicating indices of covariates which are excluded only when evaluating the significance of components.
</p>
</td></tr>
<tr><td><code id="pocrepath_+3A_maxcmp">maxcmp</code></td>
<td>

<p>maximum number of components to be constructed.
</p>
</td></tr>
<tr><td><code id="pocrepath_+3A_ptype">ptype</code></td>
<td>

<p>a character to indicate the type of penalty: <code>'ebtz'</code> (emprical Bayes thresholding after Fisher's z-transformation, by default), <code>'ebt'</code> (emprical Bayes thresholding by Johnstone &amp; Silverman (2004)), <code>'l1'</code> (L_1 penalty), <code>'scad'</code> (SCAD by Fan &amp; Li (2001)), <code>'mcp'</code> (MCP by Zhang (2010)).
</p>
</td></tr>
<tr><td><code id="pocrepath_+3A_lambda.init">lambda.init</code></td>
<td>

<p>initial value of the tuning parameter (=1 by default).
</p>
</td></tr>
<tr><td><code id="pocrepath_+3A_maxit">maxit</code></td>
<td>

<p>maximum number of iterations to be allowed.
</p>
</td></tr>
<tr><td><code id="pocrepath_+3A_tol">tol</code></td>
<td>

<p>tolerance of precision in iterations.
</p>
</td></tr>
<tr><td><code id="pocrepath_+3A_maxtps">maxtps</code></td>
<td>

<p>maximum number of different values that the tuning parameter is allowed.
</p>
</td></tr>
<tr><td><code id="pocrepath_+3A_gamma">gamma</code></td>
<td>

<p>a parameter used by SCAD and MCP (=3.7 by default).
</p>
</td></tr>
<tr><td><code id="pocrepath_+3A_pval">pval</code></td>
<td>

<p>a logical value indicating whether to calculate the p-values of components (not implemented for q&gt;1, i.e., multiple response variables).
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of results from <a href="#topic+pocre">pocre</a>, each for a specific value of the tuning parameter. 
</p>


<h3>Author(s)</h3>

<p>Dabao Zhang, Zhongli Jiang, Zeyu Zhang, Department of Statistics, Purdue University</p>


<h3>References</h3>

<p>Fan J and Li R (2001). Variable selection via nonconcave penalized likelihood and its oracle properties. <em>Journal of the American Statistical Association</em>, 96:1348-1360
</p>
<p>Johnstone IM and Silverman BW (2004). Needles and straw in haystacks: empirical Bayes estimates of possibly sparse sequences. <em>Annals of Statistics</em>, 32: 1594-1649.
</p>
<p>Zhang C-H (2010). Nearly unbiased variable selection under minimax concave penalty. <em>The Annals of Statistics</em>, 38: 894-942.
</p>
<p>Zhang D (2018). R package POCRE: Exploring high-dimensional data via supervised dimension reduction. Manuscript.
</p>
<p>Zhang D, Lin Y, and Zhang M (2009). Penalized orthogonal-components regression for large p small n data. <em>Electronic Journal of Statistics</em>, 3: 781-796.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.pocrepath">plot.pocrepath</a></code>, <code><a href="#topic+selectmodel">selectmodel</a></code>, <code><a href="#topic+pocre">pocre</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simdata)
xx &lt;- simdata[,-1]
yy &lt;- simdata[,1]

ppres &lt;- pocrepath(yy,xx)
</code></pre>

<hr>
<h2 id='pocrescreen'>
Screen Variables Using Penalized Orthogonal-Components Regression (POCRE)
</h2><span id='topic+pocrescreen'></span>

<h3>Description</h3>

<p>Screen for a pre-specified number (i.e., maxvar) of covariates by constructing maxcmp components with POCRE. Each component will be constructed by selecting maxvar/macmp covariates which are most relevant to the response variable(s). Here POCRE selects covariates for their top relevance to the response variable(s) without penalization.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pocrescreen(y, x, maxvar=nrow(x), maxcmp=5, x.include=NULL,
            tol=1e-6, maxit=100)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pocrescreen_+3A_y">y</code></td>
<td>

<p>n*q matrix, values of q response variables (allow for multiple response variables).
</p>
</td></tr>
<tr><td><code id="pocrescreen_+3A_x">x</code></td>
<td>

<p>n*p matrix, values of p predicting variables (excluding the intercept).
</p>
</td></tr>
<tr><td><code id="pocrescreen_+3A_maxvar">maxvar</code></td>
<td>

<p>maximum number of selected variables.
</p>
</td></tr>
<tr><td><code id="pocrescreen_+3A_maxcmp">maxcmp</code></td>
<td>

<p>maximum number of components to be constructed.
</p>
</td></tr>
<tr><td><code id="pocrescreen_+3A_x.include">x.include</code></td>
<td>

<p>a vector of indices indicating covariates which should always be included in the model (so not counted into selected maxvar covariates).
</p>
</td></tr>
<tr><td><code id="pocrescreen_+3A_tol">tol</code></td>
<td>

<p>tolerance of precision in iterations.
</p>
</td></tr>
<tr><td><code id="pocrescreen_+3A_maxit">maxit</code></td>
<td>

<p>maximum number of iterations to be allowed.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of indices of selected covariates (excluding those in x.include).
</p>


<h3>Author(s)</h3>

<p>Dabao Zhang, Zhongli Jiang, Zeyu Zhang, Department of Statistics, Purdue University</p>


<h3>References</h3>

<p>Zhang D (2018). R package POCRE: Exploring high-dimensional data via supervised dimension reduction. Manuscript.
</p>
<p>Zhang D, Lin Y, and Zhang M (2009). Penalized orthogonal-components regression for large p small n data. <em>Electronic Journal of Statistics</em>, 3: 781-796.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pocre">pocre</a></code>, <code><a href="#topic+pocrepath">pocrepath</a></code>, <code><a href="#topic+cvpocre">cvpocre</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simdata)
xx &lt;- simdata[,-1]
yy &lt;- simdata[,1]

# Screen for 50 covariates
sidx &lt;- pocrescreen(yy,xx,maxvar=50)

# Screen for 50 additional covariates besides the first 10
xinc &lt;- 1:10
sidx &lt;- pocrescreen(yy,xx,maxvar=50,x.include=xinc)
sidx &lt;- c(xinc,sidx)
</code></pre>

<hr>
<h2 id='selectmodel'>
Select the Optimal Model
</h2><span id='topic+selectmodel'></span>

<h3>Description</h3>

<p>Select the optimal model from those fitted by POCRE, on the basis of prespecified criterion, such as EBIC, BIC, AIC, and AICc.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>selectmodel(ppobj, msc=NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="selectmodel_+3A_ppobj">ppobj</code></td>
<td>

<p>output from <a href="#topic+pocrepath">pocrepath</a>.
</p>
</td></tr>
<tr><td><code id="selectmodel_+3A_msc">msc</code></td>
<td>

<p>a value indicating the information criterion: 0 for BIC, (0,1] for EBIC (by default), 2 for AIC, 3 for AICc.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>output of <a href="#topic+pocre">pocre</a> for the optimal model.
</p>


<h3>Author(s)</h3>

<p>Dabao Zhang, Zhongli Jiang, Zeyu Zhang, Department of Statistics, Purdue University</p>


<h3>References</h3>

<p>Chen J and Chen Z (2008) Extended Bayesian information criteria for
model selection with large model spaces. <em>Biometrika</em>, 95: 759-771.
</p>
<p>Zhang D, Lin Y, and Zhang M (2009). Penalized orthogonal-components regression for large p small n data. <em>Electronic Journal of Statistics</em>, 3: 781-796.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pocrepath">pocrepath</a></code>, <code><a href="#topic+plot.pocrepath">plot.pocrepath</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simdata)
xx &lt;- scale(as.matrix(simdata[,-1]))
yy &lt;- scale(as.matrix(simdata[,1]))

# ppres &lt;- pocrepath(yy,xx,delta=0.01)
ppres &lt;- pocrepath(yy,xx)
fres &lt;- selectmodel(ppres)
</code></pre>

<hr>
<h2 id='sim5ydata'>
A Set of Simulated Data with Multiple Response Variables
</h2><span id='topic+sim5ydata'></span>

<h3>Description</h3>

<p>A simulated data set with 100 observations, each with five response variable and 1,000 covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("sim5ydata")</code></pre>


<h3>Format</h3>

<p>A data frame with 100 observations on 1005 variables with the first five columns for the response variables, and the rest for the covariates.
</p>


<h3>Details</h3>

<p>The 1,000 covariates are from 10 blocks of independent variables, with each block consisting 100 autoregressively correlated variables. There are a total of 12 covariates affecting the response variables: <code class="reqn">x_{50}, x_{51}, x_{150}, x_{153}, x_{250}, x_{256}, x_{350}, x_{359}, x_{450}, x_{467}, x_{550}, x_{583}</code>.
</p>


<h3>Author(s)</h3>

<p>Dabao Zhang, Zhongli Jiang, Zeyu Zhang, Department of Statistics, Purdue University</p>


<h3>References</h3>

<p>Zhang D, Lin Y, and Zhang M (2009). Penalized orthogonal-components regression for large p small n data. <em>Electronic Journal of Statistics</em>, 3: 781-796.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pocrescreen">pocrescreen</a></code>, <code><a href="#topic+pocrepath">pocrepath</a></code>, <code><a href="#topic+pocre">pocre</a></code>, <code><a href="#topic+cvpocre">cvpocre</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sim5ydata)
</code></pre>

<hr>
<h2 id='simbin'>
A Set of Simulated Binomial Data.
</h2><span id='topic+simbin'></span>

<h3>Description</h3>

<p>A simulated data set with 100 observations, each with one binary response variable and 1,000 covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("simbin")</code></pre>


<h3>Format</h3>

<p>A data frame with 100 observations on 1001 variables with the first column for the response variable, and the rest for the covariates.
</p>


<h3>Details</h3>

<p>The true covariates are 1, 2, 103, 104, 205, and 206.
</p>


<h3>Author(s)</h3>

<p>Dabao Zhang, Zhongli Jiang, Yu-ting Chen, Department of Statistics, Purdue University</p>


<h3>References</h3>

<p>Zhang D, Lin Y, and Zhang M (2009). Penalized orthogonal-components regression for large p small n data. <em>Electronic Journal of Statistics</em>, 3: 781-796.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gps">gps</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(simbin)
</code></pre>

<hr>
<h2 id='simdata'>
A Set of Simulated Data with Single Gaussian Response Variable
</h2><span id='topic+simdata'></span>

<h3>Description</h3>

<p>A simulated data set with 100 observations, each with one response variable and 1,000 covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("simdata")</code></pre>


<h3>Format</h3>

<p>A data frame with 100 observations on 1001 variables with the first column for the response variable, and the rest for the covariates.
</p>


<h3>Details</h3>

<p>The 1,000 covariates are from 10 blocks of independent variables, with each block consisting 100 autoregressively correlated variables. There are a total of 20 covariates affecting the response variables: <code class="reqn">x_1, \dots, x_{10}</code>, <code class="reqn">x_{101}, \dots, x_{110}</code>.
</p>


<h3>Author(s)</h3>

<p>Dabao Zhang, Zhongli Jiang, Zeyu Zhang, Department of Statistics, Purdue University</p>


<h3>References</h3>

<p>Zhang D, Lin Y, and Zhang M (2009). Penalized orthogonal-components regression for large p small n data. <em>Electronic Journal of Statistics</em>, 3: 781-796.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pocrescreen">pocrescreen</a></code>, <code><a href="#topic+pocrepath">pocrepath</a></code>, <code><a href="#topic+pocre">pocre</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simdata)
</code></pre>

<hr>
<h2 id='simpoi'>
A Set of Simulated Poisson Data.
</h2><span id='topic+simpoi'></span>

<h3>Description</h3>

<p>A simulated data set with 100 observations, each with one count response variable and 1,000 covariates. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("simpoi")</code></pre>


<h3>Format</h3>

<p>A data frame with 100 observations on 1001 variables with the first column for the response variable, and the rest for the covariates.
</p>


<h3>Details</h3>

<p>The 1,000 covariates are from 10 blocks of independent variables, with each block consisting 100 autoregressively correlated variables. There are a total of 20 covariates affecting the response variables: <code class="reqn">x_1, \dots, x_{10}</code>, <code class="reqn">x_{101}, \dots, x_{110}</code>.
</p>


<h3>Author(s)</h3>

<p>Dabao Zhang, Yu-ting Chen, Department of Statistics, Purdue University</p>


<h3>References</h3>

<p>Zhang D, Lin Y, and Zhang M (2009). Penalized orthogonal-components regression for large p small n data. <em>Electronic Journal of Statistics</em>, 3: 781-796.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gps">gps</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(simpoi)
</code></pre>

<hr>
<h2 id='sipocre'>
Penalized Orthogonal-Components Regression (POCRE) with Significance Inference
</h2><span id='topic+sipocre'></span>

<h3>Description</h3>

<p>Applying POCRE to select variables and evaluate the significance of selected variables using the multiple splitting method by Meinshausen et al. (2009). The tuning parameter may be selected based on either an information criterion or k-fold cross-validation. The tuning parameter can also be fixed at a prespecified value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sipocre(y, x, n.splits=10, delta=0.1, crit=c('ic','cv','fixed'),
        ptype=c('ebtz','ebt','l1','scad','mcp'), maxvar=dim(x)[1]/2,
        msc=NA, maxit=100, maxcmp=50, gamma=3.7, tol=1e-6,
        n.folds=10, lambda=1, n.train=round(nrow(x)/2))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sipocre_+3A_y">y</code></td>
<td>

<p>n*q matrix, values of q response variables (allow for multiple response variables).
</p>
</td></tr>
<tr><td><code id="sipocre_+3A_x">x</code></td>
<td>

<p>n*p matrix, values of p predicting variables (excluding the intercept).
</p>
</td></tr>
<tr><td><code id="sipocre_+3A_n.splits">n.splits</code></td>
<td>

<p>number of random splits (=10 by default).
</p>
</td></tr>
<tr><td><code id="sipocre_+3A_delta">delta</code></td>
<td>

<p>step size to increase or decrase from current tuning parameter.
</p>
</td></tr>
<tr><td><code id="sipocre_+3A_crit">crit</code></td>
<td>

<p>character indicating the criterion to choose the tuning parameter: <code>'ic'</code> (information criteria such as AIC, AICc, BIC, EBIC), <code>'cv'</code> (k-folds cross-valdiation) or <code>'fixed'</code> (a pre-specified value).
</p>
</td></tr>
<tr><td><code id="sipocre_+3A_ptype">ptype</code></td>
<td>

<p>a character to indicate the type of penalty: <code>'ebtz'</code> (emprical Bayes thresholding after Fisher's z-transformation, by default), <code>'ebt'</code> (emprical Bayes thresholding by Johnstone &amp; Silverman (2004)), <code>'l1'</code> (L_1 penalty), <code>'scad'</code> (SCAD by Fan &amp; Li (2001)), <code>'mcp'</code> (MCP by Zhang (2010)).
</p>
</td></tr>
<tr><td><code id="sipocre_+3A_maxvar">maxvar</code></td>
<td>

<p>maximum number of selected variables.
</p>
</td></tr>
<tr><td><code id="sipocre_+3A_msc">msc</code></td>
<td>

<p>value(s) to indicate the penalty related to the information criterion: 0~1 for (E)BIC, 2 for AIC, 3 for AICc, used when <code>crit='ic'</code>.
</p>
</td></tr>
<tr><td><code id="sipocre_+3A_maxit">maxit</code></td>
<td>

<p>maximum number of iterations to be allowed.
</p>
</td></tr>
<tr><td><code id="sipocre_+3A_maxcmp">maxcmp</code></td>
<td>

<p>maximum number of components to be constructed.
</p>
</td></tr>
<tr><td><code id="sipocre_+3A_gamma">gamma</code></td>
<td>

<p>a parameter used by SCAD and MCP (=3.7 by default).
</p>
</td></tr>
<tr><td><code id="sipocre_+3A_tol">tol</code></td>
<td>

<p>tolerance of precision in iterations.
</p>
</td></tr>
<tr><td><code id="sipocre_+3A_n.folds">n.folds</code></td>
<td>

<p>number of folds in k-folds cross-validation, used when <code>crit='cv'</code>.
</p>
</td></tr>
<tr><td><code id="sipocre_+3A_lambda">lambda</code></td>
<td>

<p>pre-sepcified value for the tuning parameter, used when <code>crit='fixed'</code>.
</p>
</td></tr>
<tr><td><code id="sipocre_+3A_n.train">n.train</code></td>
<td>

<p>sample size of the training data set.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list consisting of the following components,
</p>
<table role = "presentation">
<tr><td><code>cpv</code></td>
<td>

<p>component-based p-values which are calculated by testing the constructed components, either a matrix (when <code>crit='ic'</code>, in this case each column corresponds to one value in msc) or a vector (when <code>crit='cv'</code> or <code>crit='fixed'</code>).
</p>
</td></tr>
<tr><td><code>xpv</code></td>
<td>

<p>traditional p-values, either a matrix (when <code>crit='ic'</code>, in this case each column corresponds to one value in msc) or a vector (when <code>crit='cv'</code> or <code>crit='fixed'</code>).
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Dabao Zhang, Zhongli Jiang, Zeyu Zhang, Department of Statistics, Purdue University</p>


<h3>References</h3>

<p>Fan J and Li R (2001). Variable selection via nonconcave penalized likelihood and its oracle properties. <em>Journal of the American Statistical Association</em>, 96:1348-1360
</p>
<p>Johnstone IM and Silverman BW (2004). Needles and straw in haystacks: empirical Bayes estimates of possibly sparse sequences. <em>Annals of Statistics</em>, 32: 1594-1649.
</p>
<p>Meinshausen N, Meier L, and Buhlmann P (2009) p-Values for High-Dimensional Regression. <em>Journal of the American Statistical Association</em>, 104: 1671-1681.
</p>
<p>Zhang C-H (2010). Nearly unbiased variable selection under minimax concave penalty. <em>The Annals of Statistics</em>, 38: 894-942.
</p>
<p>Zhang D, Lin Y, and Zhang M (2009). Penalized orthogonal-components regression for large p small n data. <em>Electronic Journal of Statistics</em>, 3: 781-796.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pocre">pocre</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(simdata)
xx &lt;- simdata[,-1]
yy &lt;- simdata[,1]

sipres &lt;- sipocre(yy,xx)

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
