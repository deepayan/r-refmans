<!DOCTYPE html><html><head><title>Help for package smatr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {smatr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#smatr-package'><p>(Standardised) Major Axis Estimation and Testing Routines</p></a></li>
<li><a href='#alpha.fun'><p>Utility functions for robust fitting</p></a></li>
<li><a href='#b.com.est'><p> Common slope estimation</p></a></li>
<li><a href='#coef.sma'><p>Extract coefficients from a 'sma' or 'ma' fit</p></a></li>
<li><a href='#com.ci'><p> Calculates a confidence inteval for a common slope (called by slope.com)</p></a></li>
<li><a href='#elev.com'><p> Test for equal elevation among several lines fitted with (standardised) major axes of common slope.</p></a></li>
<li><a href='#elev.test'><p>One-sample test of a (standardised) major axis elevation</p></a></li>
<li><a href='#fitted.sma'>
<p>Returns fitted values</p></a></li>
<li><a href='#leaflife'><p>Leaf longevity and leaf mass per area for plant species from different sites</p></a></li>
<li><a href='#leafmeas'><p>Leaf mass per area and photosynthetic rate for plant species from different sites</p></a></li>
<li><a href='#line.cis'><p>Slope and elevation of a (standardised) major axis, with confidence intervals</p></a></li>
<li><a href='#lr.b.com'><p> Likelihood ratio statistic, assuming a common slope (called by slope.com)</p></a></li>
<li><a href='#makeLogMinor'><p>Generate spacing for minor tick marks on a plot with log-scaled axes</p></a></li>
<li><a href='#meas.est'><p>Measurement error variance estimation from repeated measures</p></a></li>
<li><a href='#multcompmatrix'>
<p>Multiple comparisons graphical matrix</p></a></li>
<li><a href='#plot.sma'><p>Draw an X-Y plot</p></a></li>
<li><a href='#plotutils'>
<p>Utility plotting functions</p></a></li>
<li><a href='#print.sma'><p>Print an object of class 'sma'.</p></a></li>
<li><a href='#residuals.sma'><p>Extract model residuals</p></a></li>
<li><a href='#seqLog'><p>Sequence Generation</p></a></li>
<li><a href='#shift.com'><p>Test for no mean shift along a common (standardised) major axis</p></a></li>
<li><a href='#slope.com'><p> Common slope test amongst several allometric lines</p></a></li>
<li><a href='#slope.test'><p>One-sample test of a (standardised) major axis slope</p></a></li>
<li><a href='#sma'>
<p>(Standardized) major axis estimation and testing for one or several samples</p></a></li>
<li><a href='#summary.sma'><p>Print a summary</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>3.4-8</td>
</tr>
<tr>
<td>Title:</td>
<td>(Standardised) Major Axis Estimation and Testing Routines</td>
</tr>
<tr>
<td>Author:</td>
<td>David Warton &lt;David.Warton@unsw.edu.au&gt;, Remko Duursma, Daniel Falster
    and Sara Taskinen.</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Remko Duursma &lt;remkoduursma@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Methods for fitting bivariate lines in
    allometry using the major axis (MA) or standardised major axis (SMA), and
    for making inferences about such lines. The available methods of inference
    include confidence intervals and one-sample tests for slope and elevation,
    testing for a common slope or elevation amongst several allometric lines,
    constructing a confidence interval for a common slope or elevation, and
    testing for no shift along a common axis, amongst several samples. 
    See Warton et al. 2012 &lt;<a href="https://doi.org/10.1111%2Fj.2041-210X.2011.00153.x">doi:10.1111/j.2041-210X.2011.00153.x</a>&gt; for methods description.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://web.maths.unsw.edu.au/~dwarton">http://web.maths.unsw.edu.au/~dwarton</a>,
<a href="http://www.bitbucket.org/remkoduursma/smatr">http://www.bitbucket.org/remkoduursma/smatr</a></td>
</tr>
<tr>
<td>Collate:</td>
<td>'alpha.fun.R' 'b.com.est.R' 'coef.sma.R' 'com.ci.R'
'defineAxis.R' 'elev.com.R' 'elev.test.R' 'fitted.sma.R'
'huber.M.R' 'line.cis.R' 'logLik_sma.R' 'lr.b.com.R' 'ma.R'
'makeLogMinor.R' 'meas.est.R' 'multcompmatrix.R' 'nicePlot.R'
'plot.sma.R' 'predict.sma.R' 'print.sma.R' 'residuals.sma.R'
'robust.factor.R' 'seqLog.R' 'shift.com.R' 'slope.com.R'
'slope.test.R' 'sma.R' 'summary.sma.R'</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-03-18 20:51:38 UTC; remko</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-03-18 21:15:22 UTC</td>
</tr>
</table>
<hr>
<h2 id='smatr-package'>(Standardised) Major Axis Estimation and Testing Routines</h2><span id='topic+smatr-package'></span>

<h3>Description</h3>

<p>This package provides methods of fitting bivariate lines in allometry 
using the major axis (MA) or standardised major axis (SMA), and for making inferences 
about such lines. The available methods of inference include confidence intervals and 
one-sample tests for slope and elevation, testing for a common slope or elevation 
amongst several allometric lines, constructing a confidence interval for a common slope 
or elevation, and testing for no shift along a common axis, amongst several samples.</p>


<h3>Details</h3>

<p>The key functions in this package are <code><a href="#topic+sma">sma</a></code> and <code><a href="#topic+ma">ma</a></code>, which will fit SMA and MA respectively, and construct confidence intervals or test hypotheses about slope or elevation in one or several samples, depending on how the arguments are used.
</p>
<p>For example:
</p>
<p><code>sma(y~x)</code> will fit a SMA for <code>y</code> vs <code>x</code>, and report confidence intervals for the slope and elevation.
</p>
<p><code>sma(y~x, robust=T)</code> will fit a robust SMA for <code>y</code> vs <code>x</code> using Huber's M estimation, and will report (approximate) confidence intervals for the slope and elevation.
</p>
<p><code>ma(y~x*groups-1)</code> will fit MA lines for <code>y</code> vs <code>x</code> that are forced through the origin, where a separate MA is fitted to each of several samples as specified by the argument <code>groups</code>. It will also report results from a test of the hypothesis that the true MA slope is equal across all samples.
</p>
<p>For more details, see the help listings for <code><a href="#topic+sma">sma</a></code> and <code><a href="#topic+ma">ma</a></code>.
</p>
<p>Note that the <code><a href="#topic+sma">sma</a></code> and <code><a href="#topic+ma">ma</a></code> functions replace the functions given in earlier package versions as <code><a href="#topic+line.cis">line.cis</a></code>, <code><a href="#topic+slope.test">slope.test</a></code>, <code><a href="#topic+elev.test">elev.test</a></code>, <code><a href="#topic+slope.com">slope.com</a></code>, <code><a href="#topic+elev.com">elev.com</a></code> and <code><a href="#topic+shift.com">shift.com</a></code>, although all of these functions and their help entries are still available.
</p>
<p>All procedures have the option of correcting for measurement error, although only in an approximate fashion, valid in large samples.
</p>
<p>Additional features of this package are listed below.
</p>

<dl>
<dt>meas.est</dt><dd><p> Estimates the average variance matrix of measurement error for a set of subjects with repeated measures </p>
</dd>
</dl>

<p><b>Example datasets:</b>
</p>

<dl>
<dt>leaflife</dt><dd><p> leaf longevity and leaf mass per area for plant species from different sites. Used to demonstrate the functionality of the <code>sma</code> and <code>ma</code> functions.</p>
</dd>
<dt>leafmeas</dt><dd><p> leaf mass per area and photosynthetic rate for plant species from different sites. Used to demonstrate the meas.est function </p>
</dd>
</dl>

<p>For more details, see the documentation for any of the individual functions listed above.
</p>


<h3>Author(s)</h3>

<p> Warton, D. <a href="mailto:David.Warton@unsw.edu.au">David.Warton@unsw.edu.au</a>, Duursma, R., Falster, D. and Taskinen, S. </p>


<h3>References</h3>

<p> Warton D. I. and Weber N. C. (2002) Common slope tests for bivariate structural relationships.  <em>Biometrical Journal</em> <b>44</b>, 161&ndash;174.
</p>
<p>Warton D. I., Wright I. J., Falster D. S. and Westoby M. (2006) A review of bivariate line-fitting methods for allometry.  <em>Biological Reviews</em> <b>81</b>, 259&ndash;291.
</p>
<p>Taskinen S. and Warton D. I. (in press) Robust estimation and inference for bivariate line-fitting in allometry.  <em>Biometrical Journal</em>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sma">sma</a></code>,<code><a href="#topic+ma">ma</a></code>, <code><a href="#topic+meas.est">meas.est</a></code>, <code><a href="#topic+leaflife">leaflife</a></code>, <code><a href="#topic+leafmeas">leafmeas</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
# See  ?sma and ?plot.sma for a full list of examples.

</code></pre>

<hr>
<h2 id='alpha.fun'>Utility functions for robust fitting</h2><span id='topic+huber.M'></span><span id='topic+alpha.fun'></span>

<h3>Description</h3>

<p>Functions used by <code><a href="#topic+sma">sma</a></code> when 'robust = TRUE'. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>alpha.fun(r, k, q)
huber.M(data, q = pchisq(3, 2))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="alpha.fun_+3A_r">r</code>, <code id="alpha.fun_+3A_k">k</code>, <code id="alpha.fun_+3A_q">q</code></td>
<td>
<p>Parameters.</p>
</td></tr>
<tr><td><code id="alpha.fun_+3A_data">data</code></td>
<td>
<p>.....</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Warton, D. I. <a href="mailto:David.Warton@unsw.edu.au">David.Warton@unsw.edu.au</a>, S. Taskinen  </p>


<h3>See Also</h3>

<p><code><a href="#topic+sma">sma</a></code>
</p>

<hr>
<h2 id='b.com.est'> Common slope estimation </h2><span id='topic+b.com.est'></span>

<h3>Description</h3>

<p>Estimates a common slope from bivariate data for several independent groups. 
Called by <code><a href="#topic+slope.com">slope.com</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>b.com.est(z, n, method, lambda = 1, res.df)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="b.com.est_+3A_z">z</code></td>
<td>
<p> Variances and covariances of each group. </p>
</td></tr>
<tr><td><code id="b.com.est_+3A_n">n</code></td>
<td>
<p> Sample sizes of each group. </p>
</td></tr>
<tr><td><code id="b.com.est_+3A_method">method</code></td>
<td>
<p> See <code><a href="#topic+slope.com">slope.com</a></code> for details. </p>
</td></tr>
<tr><td><code id="b.com.est_+3A_lambda">lambda</code></td>
<td>
<p> Error variance ration (implied by choice of method). </p>
</td></tr>
<tr><td><code id="b.com.est_+3A_res.df">res.df</code></td>
<td>
<p> Residual degrees of freedom, for each group. </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Warton, D. <a href="mailto:David.Warton@unsw.edu.au">David.Warton@unsw.edu.au</a> and J. Ormerod </p>


<h3>See Also</h3>

 <p><code><a href="#topic+slope.com">slope.com</a></code> </p>

<hr>
<h2 id='coef.sma'>Extract coefficients from a 'sma' or 'ma' fit</h2><span id='topic+coef.sma'></span>

<h3>Description</h3>

<p>Extracts elevation and slope of a standardized major axis (sma) or major axis (ma) fit,
for each of the groups if the fit was by group.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'sma'
coef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef.sma_+3A_object">object</code></td>
<td>
<p>Object of class 'sma'.</p>
</td></tr>
<tr><td><code id="coef.sma_+3A_...">...</code></td>
<td>
<p>Further arguments ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with the slope(s) and elevation(s), and their confidence intervals. If the fit was by multiple groups,
fits by all groups are returned.
</p>


<h3>Author(s)</h3>

<p>R.A. Duursma
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sma">sma</a></code>
</p>

<hr>
<h2 id='com.ci'> Calculates a confidence inteval for a common slope (called by slope.com) </h2><span id='topic+com.ci'></span>

<h3>Description</h3>

<p>Calculates a confidence inteval for a common slope (called by slope.com)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>com.ci(b, varb, crit, z, n, l1, l2, method, lambda, res.df, r.factor)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="com.ci_+3A_b">b</code></td>
<td>
<p> Common slope estimate. </p>
</td></tr>
<tr><td><code id="com.ci_+3A_varb">varb</code></td>
<td>
<p> Estimated variance of the common slope. </p>
</td></tr>
<tr><td><code id="com.ci_+3A_crit">crit</code></td>
<td>
<p> Critical value to be used in confidence interval calculation. </p>
</td></tr>
<tr><td><code id="com.ci_+3A_z">z</code></td>
<td>
<p> Variances and covariances of each group. </p>
</td></tr>
<tr><td><code id="com.ci_+3A_n">n</code></td>
<td>
<p> Sample sizes of each group. </p>
</td></tr>
<tr><td><code id="com.ci_+3A_l1">l1</code></td>
<td>
<p> Variance of fitted axis scores, for each group. </p>
</td></tr>
<tr><td><code id="com.ci_+3A_l2">l2</code></td>
<td>
<p> Variance of fitted residuals, for each group. </p>
</td></tr>
<tr><td><code id="com.ci_+3A_method">method</code></td>
<td>
<p> See slope.com for details. </p>
</td></tr>
<tr><td><code id="com.ci_+3A_lambda">lambda</code></td>
<td>
<p> Error variance ration (implied by choice of method. </p>
</td></tr>
<tr><td><code id="com.ci_+3A_res.df">res.df</code></td>
<td>
<p> Residual degrees of freedom, for each group. </p>
</td></tr>
<tr><td><code id="com.ci_+3A_r.factor">r.factor</code></td>
<td>
<p> A vector of &quot;robust factors&quot; for each group, default value 1. Variance estimates are rescaled by this factor when using robust inference. </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Warton, D.I.<a href="mailto:David.Warton@unsw.edu.au">David.Warton@unsw.edu.au</a>, J. Ormerod, &amp; S. Taskinen</p>


<h3>See Also</h3>

 <p><code><a href="#topic+slope.com">slope.com</a></code> </p>

<hr>
<h2 id='elev.com'> Test for equal elevation among several lines fitted with (standardised) major axes of common slope. </h2><span id='topic+elev.com'></span>

<h3>Description</h3>

<p>Test if several major axis or standardised major axis lines share a common elevation. 
This can now be done via <code>sma(y~x+groups)</code>, see help on the <code><a href="#topic+sma">sma</a></code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>elev.com(y, x, groups, data = NULL, method = 'SMA', alpha = 0.05, robust=FALSE,
  V = array(0, c(2, 2, length(unique(groups)))),
  group.names = sort(unique(groups)))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="elev.com_+3A_y">y</code></td>
<td>
<p> The Y-variable for all observations (as a vector). </p>
</td></tr>
<tr><td><code id="elev.com_+3A_x">x</code></td>
<td>
<p> The X-variable for all observations (as a vector). </p>
</td></tr>
<tr><td><code id="elev.com_+3A_groups">groups</code></td>
<td>
<p> Coding variable identifying which group each observation belongs to (as a factor or vector). </p>
</td></tr>
<tr><td><code id="elev.com_+3A_data">data</code></td>
<td>
<p> Deprecated. Use with() instead (see Examples).</p>
</td></tr>
<tr><td><code id="elev.com_+3A_method">method</code></td>
<td>
<p> The line fitting method: 
</p>

<dl>
<dt>'SMA' or 1</dt><dd><p> standardised major axis (this is the default) </p>
</dd>
<dt>'MA' or 2</dt><dd><p> major axis </p>
</dd>
</dl>

</td></tr>
<tr><td><code id="elev.com_+3A_alpha">alpha</code></td>
<td>
<p> The desired confidence level for the 100(1-alpha)% confidence interval for the common elevation. (Default value is 0.05, which returns a 95% confidence interval.) </p>
</td></tr>
<tr><td><code id="elev.com_+3A_robust">robust</code></td>
<td>
<p>If TRUE, uses a robust method to fit the lines and construct the test statistic.</p>
</td></tr>
<tr><td><code id="elev.com_+3A_v">V</code></td>
<td>
<p> The estimated variance matrices of measurement error, for each group. This is a 3-dimensional array with measurement error in Y in the first row and column, error in X in the second row and column,and groups running along the third dimension. Default is that there is no measurement error. </p>
</td></tr>
<tr><td><code id="elev.com_+3A_group.names">group.names</code></td>
<td>
<p> (optional: rarely required). A vector containing the labels for &lsquo;groups&rsquo;. (Only actually useful for reducing computation time in simulation work). </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculates a Wald statistic to test for equal elevation of several MA's or SMA's with a common slope. This is done by testing for equal mean residual scores across groups.
</p>
<p>Note that this test is only valid if it is reasonable to assume that the axes for the different groups all have the same slope.
</p>
<p>The test assumes the following:
</p>

<ul>
<li><p> each group of observations was independently sampled
</p>
</li>
<li><p> the axes fitted to all groups have a common slope
</p>
</li>
<li><p> y and x are linearly related within each group
</p>
</li>
<li><p> residual scores independently follow a normal distribution with equal variance at all points along the line, within each group
</p>
</li></ul>

<p>Note that we do not need to assume equal variance across groups, unlike in tests comparing several linear regression lines.
</p>
<p>The assumptions can be visually checked by plotting residual scores against fitted axis scores, and by constructing a Q-Q plot of residuals against a normal distribution, available using the <code><a href="#topic+plot.sma">plot.sma</a></code> function. On a residual plot, if there is a distinct increasing or decreasing trend within any of the groups, this suggests that all groups do not share a common slope.
</p>
<p>Setting <code>robust=TRUE</code> fits lines using Huber's M estimation, and modifies the test statistic as proposed in Taskinen &amp; Warton (in review).
</p>
<p>The common slope (<code class="reqn">\hat{\beta}</code>) is estimated from a maximum of 100 iterations, convergence is reached when the change in <code class="reqn">\hat{\beta} &lt; 10^{-6}</code>.
</p>


<h3>Value</h3>

<table>
<tr><td><code>stat</code></td>
<td>
<p>The Wald statistic testing for no shift along the common axis</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>The P-value of the test. This is calculated assuming that stat has a chi-square distribution with (g-1) df, if there are g groups</p>
</td></tr>
<tr><td><code>a</code></td>
<td>
<p>The estimated common elevation</p>
</td></tr>
<tr><td><code>ci</code></td>
<td>
<p>A 100(1-alpha)% confidence interval for the true common elevation</p>
</td></tr>
<tr><td><code>as</code></td>
<td>
<p>Separate elevation estimates for each group</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Warton, D.I.<a href="mailto:David.Warton@unsw.edu.au">David.Warton@unsw.edu.au</a>, J. Ormerod, &amp; S. Taskinen</p>


<h3>References</h3>

<p> Warton D. I., Wright I. J., Falster D. S. and Westoby M. (2006) A review of bivariate line-fitting methods for allometry.  <em>Biological Reviews</em> <b>81</b>, 259&ndash;291.
</p>
<p>Taskinen, S. and D.I. Warton. in review. Robust tests for one or more allometric lines.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+sma">sma</a></code>, <code><a href="#topic+plot.sma">plot.sma</a></code>, <code><a href="#topic+line.cis">line.cis</a></code>, <code><a href="#topic+slope.com">slope.com</a></code>, <code><a href="#topic+shift.com">shift.com</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'># Load leaf longevity data
data(leaflife)

# Test for common SMA slope amongst species at low soil nutrient sites
# with different rainfall:
leaf.low.soilp &lt;- subset(leaflife, soilp == 'low')
with(leaf.low.soilp, slope.com(log10(longev), log10(lma), rain))

# Now test for common elevation of the groups fitted with an axis
# of common slope, at low soil nutrient sites:
with(leaf.low.soilp, elev.com(log10(longev), log10(lma), rain))

# Or test for common elevation amongst the MA's of common slope,
# for low soil nutrient sites, and construct 99% a confidence interval
# for the common elevation:
with(leaf.low.soilp, elev.com(log10(longev), log10(lma), rain, method='MA',
   alpha=0.01))
</code></pre>

<hr>
<h2 id='elev.test'>One-sample test of a (standardised) major axis elevation</h2><span id='topic+elev.test'></span>

<h3>Description</h3>

<p>Test if the elevation of a major axis or standardised
major axis equals a specific value. This can now be done via <code>sma(y~x,elev.test=0)</code>, 
see help on the <code><a href="#topic+sma">sma</a></code> function.</p>


<h3>Usage</h3>

<pre><code class='language-R'>    elev.test(y, x, test.value = 0, data = NULL, alpha = 0.05,
        method = 'SMA', robust = FALSE, V = matrix(0,2,2) )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="elev.test_+3A_y">y</code></td>
<td>
<p>The Y-variable</p>
</td></tr>
<tr><td><code id="elev.test_+3A_x">x</code></td>
<td>
<p>The X-variable</p>
</td></tr>
<tr><td><code id="elev.test_+3A_test.value">test.value</code></td>
<td>
<p>The hypothesised value of the elevation (default value is 0)</p>
</td></tr>
<tr><td><code id="elev.test_+3A_data">data</code></td>
<td>
<p> Deprecated. Use with() instead (see Examples).</p>
</td></tr>
<tr><td><code id="elev.test_+3A_alpha">alpha</code></td>
<td>
<p>The desired confidence level for the 100(1-alpha)% confidence interval for the common slope. (Default value is 0.05, which returns a 95% confidence interval.)</p>
</td></tr>
<tr><td><code id="elev.test_+3A_method">method</code></td>
<td>
<p> The line fitting method:
</p>

<dl>
<dt>'OLS' or 0</dt><dd><p>linear regression</p>
</dd>
<dt>'SMA' or 1</dt><dd><p>standardised major axis (this is the default)</p>
</dd>
<dt>'MA' or 2</dt><dd><p>major axis</p>
</dd>
</dl>

</td></tr>
<tr><td><code id="elev.test_+3A_robust">robust</code></td>
<td>
<p>If TRUE, uses a robust method to fit the lines and construct the test statistic.</p>
</td></tr>
<tr><td><code id="elev.test_+3A_v">V</code></td>
<td>
<p>The estimated variance matrix of measurement error. Default is that there is no measurement error.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Tests if the line relating y to x has an elevation equal to test.value (which has a default value of 0). The line can be a linear regression line, major axis or standardised major axis (as selected using the input argument choice). The test is carried out usinga t-statistic, comparing the difference between estimated and hypothesised elevation to the standard error of elevation. As described in Warton et al (2006).
</p>
<p>A confidence interval for the elevation is also returned, again using the t-distribution.
</p>
<p>If measurement error is present, it can be corrected for through use of the input argument V, which makes adjustments to the estimated sample variances and covariances then proceeds with the same method of inference. Note, however, that this method is only approximate (see Warton et al 2006 for more details).
</p>
<p>The test assumes the following:
</p>

<ol>
<li><p> y and x are linearly related
</p>
</li>
<li><p> residuals independently follow a normal distribution with equal variance at all points along the line
</p>
</li></ol>
      
<p>The assumptions can be visually checked by plotting residual scores against fitted axis scores, and by constructing a Q-Q plot of residuals against a normal distribution, available using the <code><a href="#topic+plot.sma">plot.sma</a></code> function.
</p>
<p>Setting <code>robust=TRUE</code> fits lines using Huber's M estimation, and modifies the test statistic as proposed in Taskinen &amp; Warton (in review).
</p>


<h3>Value</h3>

<table>
<tr><td><code>t</code></td>
<td>
<p>The test statistic (a t-statistic).</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>The P-value, taken from the <code class="reqn">t_{n-2}</code>-distribution. This is an exact test if residuals are normally distributed.</p>
</td></tr>
<tr><td><code>test.value</code></td>
<td>
<p>The hypothesised value of the elevation.</p>
</td></tr>
<tr><td><code>a</code></td>
<td>
<p>The estimated elevation.</p>
</td></tr>
<tr><td><code>ci</code></td>
<td>
<p>A 100(1-alpha)% CI for the slope.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Warton, D.I.<a href="mailto:David.Warton@unsw.edu.au">David.Warton@unsw.edu.au</a>, J. Ormerod, &amp; S. Taskinen</p>


<h3>References</h3>

<p> Warton D. I., Wright I. J., Falster D. S. and Westoby M. (2006) A review of bivariate line-fitting methods for allometry.  <em>Biological Reviews</em> <b>81</b>, 259&ndash;291.
</p>
<p>Taskinen, S. and D.I. Warton. in review. Robust tests for one or more allometric lines.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sma">sma</a></code>, <code><a href="#topic+line.cis">line.cis</a></code>, <code><a href="#topic+slope.test">slope.test</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>#load the leaflife dataset:
data(leaflife)

#consider only the low rainfall sites:
leaf.low.rain &lt;-  subset(leaflife, rain=="low")

#construct a plot
plot(log10(leaf.low.rain$lma), log10(leaf.low.rain$longev),
   xlab="leaf mass per area [log scale]", ylab="leaf longevity [log scale]")
    
#test if the SMA elevation is 0 for leaf longevity vs LMA
with(leaf.low.rain, elev.test(log10(lma), log10(longev)))

#test if the MA elevation is 2
with(leaf.low.rain,elev.test(log10(lma), log10(longev),
   test.value = 2, method = "MA"))
</code></pre>

<hr>
<h2 id='fitted.sma'>
Returns fitted values
</h2><span id='topic+fitted.sma'></span>

<h3>Description</h3>

<p>Returns &quot;fitted values&quot; of a (standardized) major axis fit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'sma'
fitted(object, type = "fitted", newdata=NULL, centered=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitted.sma_+3A_object">object</code></td>
<td>
<p>Object of class <code>sma</code>.</p>
</td></tr>
<tr><td><code id="fitted.sma_+3A_type">type</code></td>
<td>
<p>Either 'residuals', or 'fitted'.</p>
</td></tr>
<tr><td><code id="fitted.sma_+3A_newdata">newdata</code></td>
<td>
<p>New data for which to provide fitted values.</p>
</td></tr>
<tr><td><code id="fitted.sma_+3A_centered">centered</code></td>
<td>
<p>Logical. If TRUE (the default) returns the zero-centered fitted values.</p>
</td></tr>
<tr><td><code id="fitted.sma_+3A_...">...</code></td>
<td>
<p>Further arguments are currently ignored.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&quot;Fitted values&quot; are calculated using <code>y+bx</code> for SMA or <code>by+x</code> for MA (see Warton et al. 2006, especially Table 4). Note these values are calculated differently to ordinary linear regression, and they cannot be interpreted as predicted values. The &quot;fitted values&quot; should be interpreted as measuring how far along the fitted axis each point lies, and are used in checking assumptions (via residual vs. fitted value plots).
</p>
<p>Fitted values may be computed for new data, using the <code>newdata</code> arguments. Be aware that the names of the variables need to be the same as in the data used in the original model fit. Also, if the original fit used <code>log='xy'</code>, for example, this transformation will also be applied to your <code>newdata</code> (so don't do the transformation yourself).
</p>


<h3>References</h3>

<p> Warton D. I., Wright I. J., Falster D. S. and Westoby M. (2006) A review of bivariate line-fitting methods for allometry.  <em>Biological Reviews</em> <b>81</b>, 259-291.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sma">sma</a></code>,<code><a href="#topic+residuals.sma">residuals.sma</a></code>
</p>

<hr>
<h2 id='leaflife'>Leaf longevity and leaf mass per area for plant species from different sites</h2><span id='topic+leaflife'></span>

<h3>Description</h3>

<p>This dataset contains the leaf longevity and leaf mass per area of 75 plant species from four sites in south-eastern Australia. Sites represent contrasts along rainfall and soil phosphorous gradients.</p>


<h3>Usage</h3>

<pre><code class='language-R'>    data(leaflife)
</code></pre>


<h3>Format</h3>

<p>A data frame containing 75 rows and 5 variables:
</p>

<dl>
<dt>site</dt><dd><p>the site at which this species was sampled (coded as 1, 2, 3, or 4)</p>
</dd>
<dt>rain</dt><dd><p>The level of annual rainfall at the site (coded as &quot;high&quot; or &quot;low&quot;)</p>
</dd>
<dt>soilp</dt><dd><p>The level of soil phosphate concentration at the site (coded as &quot;high&quot; or &quot;low&quot;)</p>
</dd>
<dt>longev</dt><dd><p>Leaf longevity (years)</p>
</dd>
<dt>lma</dt><dd><p>Leaf mass per area (m2/kg)</p>
</dd>
</dl>



<h3>Source</h3>

<p>Wright I. J., Westoby M. and Reich P. B. (2002) Convergence towards higher leaf mass per area in dry and nutrient-poor habitats has different consequences for leaf life span.  <em>Journal of Ecology</em> <b>90</b>, 534&ndash;543.
</p>

<hr>
<h2 id='leafmeas'>Leaf mass per area and photosynthetic rate for plant species from different sites</h2><span id='topic+leafmeas'></span>

<h3>Description</h3>

<p>This dataset contains the leaf mass per area (LMA) and photosynthetic rate per meaf mass (Amass) of individual plants from 81 plant species at four sites in south-eastern Australia. Sites represent contrasts along rainfall and soil phosphorous gradients.</p>


<h3>Usage</h3>

<pre><code class='language-R'>    data(leafmeas)
</code></pre>


<h3>Format</h3>

<p>A data frame containing 529 rows and 4 variables:
</p>

<dl>
<dt>site</dt><dd><p>(factor) The site at which this species was sampled (coded as Murrua, WH, RHM, RHW)</p>
</dd>
<dt>spp</dt><dd><p>(factor) Species of the observed plant species</p>
</dd>
<dt>Amass</dt><dd><p>(numeric) Photosynthetic rate per leaf mass ()</p>
</dd>
<dt>lma</dt><dd><p>(numeric) Leaf mass per area (m2/kg)</p>
</dd>
</dl>



<h3>Source</h3>

<p>Wright I. J., Reich P. B. and Westoby M. (2001) Strategy shifts in leaf physiology, structure and nutrient content between species of high- and low-rainfall and high- and low-nutrient habitats.  <em>Functional Ecology</em> <b>15</b>, 423&ndash;434.
</p>

<hr>
<h2 id='line.cis'>Slope and elevation of a (standardised) major axis, with confidence intervals</h2><span id='topic+line.cis'></span>

<h3>Description</h3>

<p>Calculates the slope and elevation of a major axis or standardised
major axis, and constructs confidence intervals for the true slope and elevation. This can now be fitted via calls of the form <code>sma(y~x, ...)</code>, see <code><a href="#topic+sma">sma</a></code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>line.cis(y, x, alpha = 0.05, data = NULL, 
	method = "SMA", intercept = TRUE, 
	V = matrix(0, 2, 2), f.crit = 0, robust=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="line.cis_+3A_y">y</code></td>
<td>
<p>The Y-variable</p>
</td></tr>
<tr><td><code id="line.cis_+3A_x">x</code></td>
<td>
<p>The X-variable</p>
</td></tr>
<tr><td><code id="line.cis_+3A_alpha">alpha</code></td>
<td>
<p>The desired confidence level for the 100(1-alpha)% confidence interval for the common slope. (Default value is 0.05, which returns a 95% confidence interval.)</p>
</td></tr>
<tr><td><code id="line.cis_+3A_data">data</code></td>
<td>
<p>Deprecated. Use with() instead (see Examples). </p>
</td></tr>
<tr><td><code id="line.cis_+3A_method">method</code></td>
<td>
<p>The line fitting method:
</p>

<dl>
<dt>'OLS' or 0</dt><dd><p>linear regression</p>
</dd>
<dt>'SMA' or 1</dt><dd><p>standardised major axis (this is the default)</p>
</dd>
<dt>'MA' or 2</dt><dd><p>major axis</p>
</dd>
</dl>

</td></tr>
<tr><td><code id="line.cis_+3A_v">V</code></td>
<td>
<p>The estimated variance matrix of measurement error. Average measurement error for Y is in the first row and column, and average measurement error for X is in the second row and column. The default is that there is no measurement error.</p>
</td></tr>
<tr><td><code id="line.cis_+3A_intercept">intercept</code></td>
<td>
<p> (logical) Whether or not the line includes an  intercept.
</p>

<dl>
<dt>FALSE</dt><dd><p> no intercept, so the line is forced through the origin </p>
</dd>
<dt>TRUE</dt><dd><p> an intercept is fitted (this is the default) </p>
</dd>
</dl>

</td></tr>
<tr><td><code id="line.cis_+3A_f.crit">f.crit</code></td>
<td>
<p>(optional - rarely required). The critical value to be used from the F distribution. (Only actually useful for reducing computation time in simulation work - otherwise, do not change.) </p>
</td></tr>
<tr><td><code id="line.cis_+3A_robust">robust</code></td>
<td>
<p>If TRUE, uses a robust method to fit the lines and construct confidence intervals.</p>
</td></tr>
<tr><td><code id="line.cis_+3A_...">...</code></td>
<td>
<p>Further parameters (not passed anywhere at the moment).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Fits a linear regression line, major axis, or standardised major axis, to a bivariate dataset. The slope and elevation are returned with confidence intervals, using any user-specified confidence level.
</p>
<p>Confidence intervals are constructed by inverting the standard one-sample tests for elvation and slope (see slope.test and elev.test for more details). Only the primary confidence interval is returned - this is valid as long as it is known a priori that the (standardised) major axis is estimating the true slope rather than the (standardised) minor axis. For SMA, this means that the sign of the true slope needs to be known a priori, and the sample slope must have the same sign as the true slope.
</p>
<p>The test assumes the following:
</p>

<ol>
<li><p> y and x are linearly related
</p>
</li>
<li><p> residuals independently follow a normal distribution with equal variance at all points along the line
</p>
</li></ol>
      
<p>These assumptions can be visually checked by plotting residuals against fitted axis scores, and by constructing a Q-Q plot of residuals against a normal distribution.  An appropriate residual variable is y-bx, and for fitted axis scores use x (for linear regression), y+bx (for SMA) or by+x (for MA), where b represents the estimated slope.
</p>
<p>If measurement error is present, it can be corrected for through use of the input argument V, which makes adjustments to the estimated sample variances and covariances then proceeds with the same method of inference. Note, however, that this method is only approximate (see Warton et al in review for more details).
</p>
<p>Setting <code>robust=TRUE</code> fits lines using Huber's M estimation, and modifies confidence interval formulae along the lines discussed in Taskinen &amp; Warton (in review).
</p>


<h3>Value</h3>

<table>
<tr><td><code>coeff</code></td>
<td>
<p>A matrix containing the estimated elevation and slope (first column), and the lower and upper limits of confidence intervals for the true elevation and slope (second and third columns). Output for the elevation and slope are in the first and second rows, respectively.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Warton, D.I.<a href="mailto:David.Warton@unsw.edu.au">David.Warton@unsw.edu.au</a>, J. Ormerod, &amp; S. Taskinen</p>


<h3>References</h3>

<p>Warton, D.I., I.J. Wright, D.S. Falster and M. Westoby. 2006. Bivariate line-fitting methods for allometry. <em>Biological Reviews</em> <b>81</b>, 259&ndash;291.
</p>
<p>Taskinen, S. and D.I. Warton. in review. Robust tests for one or more allometric lines.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sma">sma</a></code>, <code><a href="#topic+slope.test">slope.test</a></code>, <code><a href="#topic+elev.test">elev.test</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>#load the leaflife data
data(leaflife)

#consider only the low rainfall sites:
leaf.low.rain=leaflife[leaflife$rain=='low',]

#estimate the SMA line for reserve vs coat
with(leaf.low.rain, line.cis(log10(longev),log10(lma)))

#produce CI's for MA slope and elevation:
with(leaf.low.rain, line.cis(log10(longev),log10(lma),method='MA'))
</code></pre>

<hr>
<h2 id='lr.b.com'> Likelihood ratio statistic, assuming a common slope (called by slope.com) </h2><span id='topic+lr.b.com'></span>

<h3>Description</h3>

<p>Likelihood ratio statistic, assuming a common slope (called by slope.com)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lr.b.com(b, arguments)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lr.b.com_+3A_b">b</code></td>
<td>
<p> Common slope estimate. </p>
</td></tr>
<tr><td><code id="lr.b.com_+3A_arguments">arguments</code></td>
<td>
<p> A list of other required arguments. </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Warton, D. <a href="mailto:David.Warton@unsw.edu.au">David.Warton@unsw.edu.au</a>, translated to R by Ormerod, J. 2005-12-08 </p>


<h3>See Also</h3>

 <p><code><a href="#topic+slope.com">slope.com</a></code> </p>

<hr>
<h2 id='makeLogMinor'>Generate spacing for minor tick marks on a plot with log-scaled axes
</h2><span id='topic+makeLogMinor'></span>

<h3>Description</h3>

<p>Generates a sequence of numbers providing minor tick marks on log scaled axes. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>makeLogMinor(major)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="makeLogMinor_+3A_major">major</code></td>
<td>
<p>a vector of values giving major tick marks.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A vector is created according to the following algorithm. For each pair of adjacent values (x1, x2) in <code>major</code>, the function adds the values (x1, 2*x1, 3*x1, ..., x2) to the vector of return values. 
</p>
<p>This is useful for generating spacing of minor tick-values on log-transformed axes. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+nicePlot">nicePlot</a></code>, <code><a href="#topic+seqLog">seqLog</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Sequence suitable for log base 10 labels
makeLogMinor(seqLog(1E-5, 1E5))
</code></pre>

<hr>
<h2 id='meas.est'>Measurement error variance estimation from repeated measures</h2><span id='topic+meas.est'></span>

<h3>Description</h3>

<p>Estimates the average variance matrix of measurement error for a set of subjects with repeated measures.</p>


<h3>Usage</h3>

<pre><code class='language-R'>    meas.est(datameas, id, data=NULL )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="meas.est_+3A_datameas">datameas</code></td>
<td>
<p>A data matrix containing the repeated measures of observations, with each variable in a different column and all observations on all subjects in different rows of the same column.</p>
</td></tr>
<tr><td><code id="meas.est_+3A_id">id</code></td>
<td>
<p>An id vector identifying the subject being measured for each observation in the data matrix.</p>
</td></tr>
<tr><td><code id="meas.est_+3A_data">data</code></td>
<td>
<p> Deprecated. Use with() instead (see Examples).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function allows the estimation of measurement error variance, given a set of repeated measures on different subjects. Measurement error variance is estimated separately for each subject, then averaged across subjects. This provides terms that can be used to correct for measurement error in allometric analyses.
</p>
<p>Any number of variables can be specified in the data matrix for measurement error calculation. If more than one variable is specified, the covariance of measurement error is estimated from the repeated measures as well as the variance.
</p>
<p>As well as the estimated measurement error variance, a data matrix is returned which contains the averages of the repeated measures for each subject.
</p>


<h3>Value</h3>

<table>
<tr><td><code>V</code></td>
<td>
<p>A matrix containing the average variances and average convariances of the repeated measures of subjects.</p>
</td></tr>
<tr><td><code>dat.mean</code></td>
<td>
<p>A matrix containing the values for each subject, averages across repeated measures. Subjects are in rows, variables in columns.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Warton, D. <a href="mailto:David.Warton@unsw.edu.au">David.Warton@unsw.edu.au</a>, translated to R by Ormerod, J. 2005-12-08</p>


<h3>References</h3>

<p>Warton, D.I., I.J. Wright, D.S. Falster and M. Westoby. 2006. Bivariate line-fitting methods for allometry. <em>Biological Reviews</em> <b>81</b>, 259&ndash;291.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+line.cis">line.cis</a></code>, <code><a href="#topic+slope.test">slope.test</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>#load the individual level leaf example dataset
data(leafmeas)

#Estimate measurement error variance matrix, store in "meas.vr"
meas.vr &lt;- meas.est(leafmeas[,3:4], leafmeas$spp)
</code></pre>

<hr>
<h2 id='multcompmatrix'>
Multiple comparisons graphical matrix
</h2><span id='topic+multcompmatrix'></span>

<h3>Description</h3>

<p>Print a matrix of pair-wise comparisons based on an 'sma' fit. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multcompmatrix(smfit, sort = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="multcompmatrix_+3A_smfit">smfit</code></td>
<td>

<p>An object of class 'sma', fit with <code><a href="#topic+sma">sma</a></code>.
</p>
</td></tr>
<tr><td><code id="multcompmatrix_+3A_sort">sort</code></td>
<td>

<p>Logical. Specifies whether or not to sort groups from smallest to largest value based on the parameter of interest (slope, elevation or mean fitted value).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A matrix of comparisons is drawn, based on the P values of the pair-wise tests between levels of the grouping variable. An 'X' indicates P &lt; 0.05, 'o' indicates 0.05 &lt; P &lt; 0.1.
</p>


<h3>Value</h3>

<p>Invisibly returns the (character) matrix.
</p>


<h3>Author(s)</h3>

<p>Remko Duursma and Daniel Falster.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sma">sma</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Print the matrix of comparisons:
data(leaflife)
sm1 &lt;- sma(lma ~ longev + site, data=leaflife, multcomp=TRUE)
multcompmatrix(sm1)

# Write the matrix to a file like this:
## Not run: 
capture.output(multcompmatrix(sm1), file="sm1matrix.txt")

## End(Not run)

</code></pre>

<hr>
<h2 id='plot.sma'>Draw an X-Y plot	</h2><span id='topic+plot.sma'></span>

<h3>Description</h3>

<p>Plot a (standardized) major axis fit, including the data and the fitted lines. There are many options for 
changing the appearance of the plot and generating high-quality publishable graphs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'sma'
plot(x, which = c("default", "residual", "qq"), 
	use.null = FALSE, add = FALSE, 	type = "o", xaxis = NULL, 
	yaxis = NULL, xlab = NULL, ylab = NULL, pch = NULL, 
	col = NULL, lty = NULL, from = NULL, to = NULL, 
	log = x$log, frame.plot = TRUE, tck=par("tck"), 
	p.lines.transparent = NA, axes = TRUE, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.sma_+3A_x">x</code></td>
<td>
<p>Object of class 'sma'.</p>
</td></tr>
<tr><td><code id="plot.sma_+3A_which">which</code></td>
<td>
<p>If 'residual', plots a residual plot; if 'qq', plots a qq plot; otherwise an x-y plot.</p>
</td></tr>
<tr><td><code id="plot.sma_+3A_use.null">use.null</code></td>
<td>
<p>Logical. If FALSE, plots the fitted lines (the default), otherwise those corresponding to the null hypothesis.</p>
</td></tr>
<tr><td><code id="plot.sma_+3A_add">add</code></td>
<td>
<p>Logical. If TRUE, adds lines or points to an existing plot.</p>
</td></tr>
<tr><td><code id="plot.sma_+3A_type">type</code></td>
<td>
<p>As in 'lm.default' : 'p' plots points only, 'l' only lines, and 'o' or 'b' plot both.</p>
</td></tr>
<tr><td><code id="plot.sma_+3A_xaxis">xaxis</code>, <code id="plot.sma_+3A_yaxis">yaxis</code></td>
<td>
<p>Special axis objects. See Details and examples.</p>
</td></tr>
<tr><td><code id="plot.sma_+3A_xlab">xlab</code>, <code id="plot.sma_+3A_ylab">ylab</code></td>
<td>
<p>Labels for X and Y axes.</p>
</td></tr>
<tr><td><code id="plot.sma_+3A_pch">pch</code></td>
<td>
<p>Plotting symbols (see <code><a href="graphics.html#topic+points">points</a></code>).</p>
</td></tr>
<tr><td><code id="plot.sma_+3A_col">col</code></td>
<td>
<p>Color of points and lines.</p>
</td></tr>
<tr><td><code id="plot.sma_+3A_lty">lty</code></td>
<td>
<p>Line type (see <code><a href="graphics.html#topic+lines">lines</a></code>).</p>
</td></tr>
<tr><td><code id="plot.sma_+3A_from">from</code>, <code id="plot.sma_+3A_to">to</code></td>
<td>
<p>Min and max X values for the lines (defaults to values given by <code><a href="#topic+sma">sma</a></code>, which are the  
X values corresponding the maximum and minimum fitted values in the data.).</p>
</td></tr>
<tr><td><code id="plot.sma_+3A_log">log</code></td>
<td>
<p>One of 'x','y' or 'xy', to denote which axes to log-scale.</p>
</td></tr>
<tr><td><code id="plot.sma_+3A_frame.plot">frame.plot</code></td>
<td>
<p>a logical indicating whether a box should be drawn around the plot, by default = TRUE. </p>
</td></tr>
<tr><td><code id="plot.sma_+3A_tck">tck</code></td>
<td>
<p>The length of tick marks as a fraction of the smaller of the width or height of the plotting region. If tck &gt;= 0.5 it is interpreted as a fraction of the relevant side, so if tck = 1 grid lines are drawn. By default set to current system defaults (tck = par(&quot;tck&quot;)).</p>
</td></tr>
<tr><td><code id="plot.sma_+3A_p.lines.transparent">p.lines.transparent</code></td>
<td>
<p>Adjusts transparency level of fitted lines according to p-value of correlation between X and Y, via formula opacity = 1-p/p.lines.transparent). Setting to a value 0.1 means the line for any group with p = 0.1 would be fully transparent, while line for a group with p =0.05 would be 50 perecent transparent. by default set to NA, which means lines are fully visible.</p>
</td></tr>
<tr><td><code id="plot.sma_+3A_axes">axes</code></td>
<td>
<p>If FALSE, suppress plotting of the axes (Default TRUE)</p>
</td></tr>
<tr><td><code id="plot.sma_+3A_...">...</code></td>
<td>
<p>Further arguments passed to <code><a href="graphics.html#topic+plot.default">plot.default</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>plot.sma</code> function produces one of three different types of plot, depending on the <code>which</code> argument.
</p>
<p>The default plot, <code>which="default"</code>, produced a plot of <code>y</code> vs <code>x</code>, with separate symbols for each <code>group</code> if appropriate, and MA or SMA lines fitted through each group. The formula used in the <code>sma</code> object that is input to the <code>plot</code> function determines whether there is a group structure, whether fitted lines have common slope, etc.
</p>
<p>A residual plot can be obtained via <code>which="residual"</code> - this is a plot of residuals against fitted values. This can be used to check assumptions - if assumptions are satisfied there should be no pattern.
</p>
<p>A normal quantile plot can be obtained via <code>which="qq"</code> - this is a normal quantile plot of residuals. This can be used to check the normality assumption - if data are close to a straight line, normality is plausible. Note that non-normality is only important to the validity of the test in small samples. In larger samples, non-normality will not effect validity, but strong non-normality will reduce the power of tests.
</p>
<p>If <code>use.null=TRUE</code> then the lines added to the plot use the coefficients estimated under the null hypothesis. For example, if the sma object <code>x</code> was produced using a common slopes test (via <code>y~x*groups</code> or similar) then <code>use.null=TRUE</code> will plot lines that apply the common slope to each group.
</p>
<p>The arguments <code>pch</code>,  <code>col</code>,  <code>lty</code>,  <code>from &amp; to</code>, are used to modify characteristics of the plotted points and lines. If a vector of values for anyone of these arguments is passed to <code>plot.sma</code>, then successive values are applied to each group, provided group structure is included in <code>x</code> and the vector length is at least as long as the number of groups. 
</p>
<p>By default, <code>plot.sma</code> uses the default tick spacing given by <code>plot.default</code>. To customise axes, users can pass special axis objects to <code>plot.sma</code>, obtained using the <code><a href="#topic+defineAxis">defineAxis</a></code> command as in the example below. This enables high quality publishable plots to be produced. See <code><a href="#topic+plotutils">plotutils</a></code> for more information.
</p>


<h3>Author(s)</h3>

<p> D. Falster, R.A. Duursma, D.I. Warton </p>


<h3>See Also</h3>

<p><code><a href="#topic+sma">sma</a></code>, <code><a href="#topic+plotutils">plotutils</a></code>, <code><a href="#topic+defineAxis">defineAxis</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load leaf lifetime dataset:
data(leaflife)

# Only consider low-nutrient sites:
leaf.low.soilp &lt;- subset(leaflife, soilp == 'low')

# Fit SMA's separately at each of high and low 
# rainfall sites and test for common slope:
ft &lt;- sma(longev~lma*rain, data=leaf.low.soilp, log="xy")

# Plot leaf longevity (longev) vs leaf mass per area (lma) 
# separately for each of high and low rainfall:
plot(ft)

# As before but add lines which have a common slope:
plot(ft, use.null=TRUE)

#As above, but adding the common slope lines to an existing plot
plot(ft, type='p', col="black")
plot(ft, use.null=TRUE, add=TRUE, type='l')

# Plot with equally spaced tick marks:
plot(ft, xaxis=defineAxis(major.ticks=c(40,80,160,320,640)), 
	yaxis=defineAxis(major.ticks=c(0.5,1,2,4,8)) )

# Produce a residual plot to check assumptions:
plot(ft,which="res")

# Produce a normal quantile plot:
plot(ft,which="qq")

</code></pre>

<hr>
<h2 id='plotutils'>
Utility plotting functions
</h2><span id='topic+plotutils'></span><span id='topic+defineAxis'></span><span id='topic+nicePlot'></span>

<h3>Description</h3>

<p>Functions used in conjunction with <code><a href="#topic+plot.sma">plot.sma</a></code> to customize spacing of ticks on plot axes. <code>defineAxis</code> creates an 'axis' object, including tick spacing, limits, and labels, that can be passed into <code><a href="#topic+plot.sma">plot.sma</a></code> or <code>nicePlot</code>. <code>nicePlot</code> creates an empty plot using x and y axis objects.     
</p>


<h3>Usage</h3>

<pre><code class='language-R'>defineAxis(major.ticks, limits=NULL, minor.ticks = NULL, 
	major.tick.labels = major.ticks, both.sides = FALSE)
nicePlot(xaxis, yaxis, log = "", ann = par("ann"), xlab = NULL, 
	ylab = NULL,tck = par("tck"),frame.plot = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotutils_+3A_limits">limits</code></td>
<td>
<p>the x or y limits of the plot,  (x1, x2) or (y1,y2).</p>
</td></tr>
<tr><td><code id="plotutils_+3A_major.ticks">major.ticks</code>, <code id="plotutils_+3A_minor.ticks">minor.ticks</code></td>
<td>
<p>Where to draw major and minor ticks (vectors).</p>
</td></tr>
<tr><td><code id="plotutils_+3A_major.tick.labels">major.tick.labels</code></td>
<td>
<p>Labels to draw at the ticks (optional).</p>
</td></tr>
<tr><td><code id="plotutils_+3A_both.sides">both.sides</code></td>
<td>
<p>a logical value indicating whether tickmarks should also be drawn on opposite sides of the plot, i.e. right or top</p>
</td></tr>
<tr><td><code id="plotutils_+3A_xaxis">xaxis</code>, <code id="plotutils_+3A_yaxis">yaxis</code></td>
<td>
<p>'axis' objects, the result of calling 'defineAxis'.</p>
</td></tr>
<tr><td><code id="plotutils_+3A_ann">ann</code></td>
<td>
<p>a logical value indicating whether the default annotation (x and y axis labels) should appear on the plot.</p>
</td></tr>
<tr><td><code id="plotutils_+3A_xlab">xlab</code></td>
<td>
<p>a label for the x axis, defaults to a description of x.</p>
</td></tr>
<tr><td><code id="plotutils_+3A_ylab">ylab</code></td>
<td>
<p>a label for the y axis, defaults to a description of y.</p>
</td></tr>
<tr><td><code id="plotutils_+3A_log">log</code></td>
<td>
<p>One of 'x', 'y' or 'xy', specifying which axes draw in log10 scale.</p>
</td></tr>
<tr><td><code id="plotutils_+3A_frame.plot">frame.plot</code></td>
<td>
<p>a logical indicating whether a box should be drawn around the plot, by default = TRUE. </p>
</td></tr>
<tr><td><code id="plotutils_+3A_tck">tck</code></td>
<td>
<p>The length of tick marks as a fraction of the smaller of the width or height of the plotting region. If tck &gt;= 0.5 it is interpreted as a fraction of the relevant side, so if tck = 1 grid lines are drawn. By default set to current system defaults (tck = par(&quot;tck&quot;)).</p>
</td></tr>
<tr><td><code id="plotutils_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to nicePlot, and therein to 'axis'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>By default, calls to <code><a href="#topic+plot.sma">plot.sma</a></code> use the values given by <code><a href="graphics.html#topic+plot.default">plot.default</a></code> to determine axis limits and spacing of major and minor ticks. Users can override these values by passing two 'axis' objects created by <code>defineAxis</code> to <code><a href="#topic+plot.sma">plot.sma</a></code>. When both x and y axis objects are passed to  <code><a href="#topic+plot.sma">plot.sma</a></code>, the function uses <code>nicePlot</code> to construct the axes according to the specified values, instead of  <code><a href="graphics.html#topic+plot.default">plot.default</a></code>. As a minimum, users must at least one argument (<code>major.ticks</code>) to <code>defineAxis</code> when passing these to <code><a href="#topic+plot.sma">plot.sma</a></code>. 
</p>
<p>The function <code>nicePlot</code> can also be called to construct a new set of axes according to the specified values. For this to work, axis objects must contain both <code>major.ticks</code> and <code>limits</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sma">sma</a></code>, <code><a href="#topic+plot.sma">plot.sma</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load leaf lifetime dataset:
data(leaflife)

#First example of axis spacing
ft &lt;- sma(longev~lma*rain,log="xy",data=leaflife)
xax &lt;- defineAxis(major.ticks=c(50, 100, 200, 400))
yax &lt;- defineAxis(major.ticks=c(0.25, 0.5, 1,2,4,8))
plot(ft, xaxis=xax, yaxis=yax)

#As above, marking axes on both sides
xax &lt;- defineAxis(major.ticks=c(50, 100, 200, 400), both.sides=TRUE)
yax &lt;- defineAxis(major.ticks=c(0.25, 0.5, 1,2,4,8), both.sides=TRUE)
plot(ft, xaxis=xax, yaxis=yax)

#Using labels with log10 spacing and minor tick marks
xax &lt;- defineAxis(limits=c(10, 1E3), major.ticks=seqLog(1, 1000), 
	minor.ticks=makeLogMinor(seqLog(1, 1000)))
yax &lt;- defineAxis(limits=c(1E-1, 1E1), major.ticks=seqLog(1E-2, 10), 
	minor.ticks=makeLogMinor(seqLog(1E-2, 10)))
plot(ft, xaxis=xax, yaxis=yax)

#As above, but using expressions as labels
xax &lt;- defineAxis(limits=c(10, 1E3), major.ticks=seqLog(10, 1000), 
	minor.ticks=makeLogMinor(seqLog(10, 1000)), 
major.tick.labels = parse(text=paste("10^", c( 1,2,3), sep="")), 
	both.sides=FALSE)
yax &lt;- defineAxis(limits=c(1E-1, 1E1), major.ticks=seqLog(1E-1, 10), 
	minor.ticks=makeLogMinor(seqLog(1E-1, 10)), 
major.tick.labels = parse(text=paste("10^", c( -1,0,1), sep="")), 
	both.sides=FALSE)
plot(ft, xaxis=xax, yaxis=yax)

#start an empty plot using nicePlot 
xax &lt;- defineAxis(limits=c(8, 1.2E3), major.ticks=seqLog(1, 1000))
yax &lt;- defineAxis(limits=c(0.8E-1, 1.2E1), major.ticks=seqLog(1E-2, 10))
nicePlot(xax,yax,log='xy')

</code></pre>

<hr>
<h2 id='print.sma'>Print an object of class 'sma'.</h2><span id='topic+print.sma'></span>

<h3>Description</h3>

<p>Prints the coefficients and the results of the various hypothesis tests of an sma object.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'sma'
print(x, ..., coefbygroup = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.sma_+3A_x">x</code></td>
<td>
<p>Object of class 'sma'.</p>
</td></tr>
<tr><td><code id="print.sma_+3A_coefbygroup">coefbygroup</code></td>
<td>
<p>Whether or not to print the coefficients by group.</p>
</td></tr>
<tr><td><code id="print.sma_+3A_...">...</code></td>
<td>
<p>Further arguments ignored.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> R.A. Duursma, D. Falster,  D.I. Warton </p>


<h3>See Also</h3>

<p><code><a href="#topic+sma">sma</a></code>
</p>

<hr>
<h2 id='residuals.sma'>Extract model residuals
</h2><span id='topic+residuals.sma'></span>

<h3>Description</h3>

<p>Extracts the residuals of a (standardized) major axis fit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'sma'
residuals(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="residuals.sma_+3A_object">object</code></td>
<td>
<p>Object of class 'sma'.</p>
</td></tr>
<tr><td><code id="residuals.sma_+3A_...">...</code></td>
<td>
<p>Further arguments ignored.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Residuals are calculated as y-bx-a for each group. These values are useful in assumption checking,  especially in constructing residual vs fitted value plots.
</p>


<h3>Value</h3>

<p>A vector of residuals.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sma">sma</a></code>, <code><a href="#topic+plot.sma">plot.sma</a></code>
</p>

<hr>
<h2 id='seqLog'>Sequence Generation
</h2><span id='topic+seqLog'></span>

<h3>Description</h3>

<p>Generate multiplicative sequences, or series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>seqLog(from, to, base = 10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="seqLog_+3A_from">from</code>, <code id="seqLog_+3A_to">to</code></td>
<td>
<p>the starting and (maximal) end value of a sequence.</p>
</td></tr>
<tr><td><code id="seqLog_+3A_base">base</code></td>
<td>
<p>multiplication value.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Starting at <code>from</code>, <code>seq</code> multiplies successively by <code>base</code> until the maximal value is reached. This is useful for generating tick-spacing on log-transformed axes. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+nicePlot">nicePlot</a></code>, <code><a href="#topic+makeLogMinor">makeLogMinor</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Sequence suitable for log base 10 labels
seqLog(1E-5, 1E5)

#Sequence suitable for log base 2 labels
seqLog(2, 128,base=2)
</code></pre>

<hr>
<h2 id='shift.com'>Test for no mean shift along a common (standardised) major axis</h2><span id='topic+shift.com'></span>

<h3>Description</h3>

<p>Test if several groups of observations have no shift in location along major axis or standardised major axis lines with a common slope. This can now be done via <code>sma(y~x+groups, type="shift")</code>, see help on the <code><a href="#topic+sma">sma</a></code> function.</p>


<h3>Usage</h3>

<pre><code class='language-R'>shift.com( y, x, groups, data = NULL, method = 'SMA', 
   intercept = TRUE, robust = FALSE, V=array( 0, c( 2,2,length(unique(groups)))), 
   group.names=sort(unique(groups)) )</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="shift.com_+3A_y">y</code></td>
<td>
<p>The Y-variable for all observations (as a vector)</p>
</td></tr>
<tr><td><code id="shift.com_+3A_x">x</code></td>
<td>
<p>The X-variable for all observations (as a vector)</p>
</td></tr>
<tr><td><code id="shift.com_+3A_groups">groups</code></td>
<td>
<p>Coding variable identifying which group each observation belongs to (as a factor or vector)</p>
</td></tr>
<tr><td><code id="shift.com_+3A_data">data</code></td>
<td>
<p> Deprecated. Use with() instead (see Examples). </p>
</td></tr>
<tr><td><code id="shift.com_+3A_method">method</code></td>
<td>
<p>The line fitting method:
</p>

<dl>
<dt>'SMA' or 1</dt><dd><p>standardised major axis (this is the default)</p>
</dd>
<dt>'MA' or 2</dt><dd><p>major axis</p>
</dd>
</dl>

</td></tr>
<tr><td><code id="shift.com_+3A_intercept">intercept</code></td>
<td>
<p> (logical) Whether or not the line includes an  intercept.
</p>

<dl>
<dt>FALSE</dt><dd><p> no intercept, so the line is forced through the origin </p>
</dd>
<dt>TRUE</dt><dd><p> an intercept is fitted (this is the default) </p>
</dd>
</dl>

</td></tr>
<tr><td><code id="shift.com_+3A_robust">robust</code></td>
<td>
<p>If TRUE, uses a robust method to fit the lines and construct the test statistic.</p>
</td></tr>
<tr><td><code id="shift.com_+3A_v">V</code></td>
<td>
<p>The estimated variance matrices of measurement error, for each group. This is a 3-dimensional array with measurement error in Y in the first row and column, error in X in the second row and column, and groups running along the third dimension. Default is that there is no measurement error.</p>
</td></tr>
<tr><td><code id="shift.com_+3A_group.names">group.names</code></td>
<td>
<p> (optional: rarely required). A vector containing the labels for &lsquo;groups&rsquo;. (Only actually useful for reducing computation time in simulation work). </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculates a Wald statistic to test for no shift along several MA's or SMA's of common slope. This is done by testing for equal fitted axis means across groups.
</p>
<p>Note that this test is only valid if it is reasonable to assume that the axes for the different groups all have the same slope.
</p>
<p>The test assumes the following:
</p>

<ol>
<li><p> each group of observations was independently sampled
</p>
</li>
<li><p> the axes fitted to all groups have a common slope
</p>
</li>
<li><p> y and x are linearly related within each group
</p>
</li>
<li><p> fitted axis scores independently follow a normal distribution with equal variance at all points along the line, within each group
</p>
</li></ol>

<p>Note that we do not need to assume equal variance across groups, unlike in tests comparing several linear regression lines.
</p>
<p>The assumptions can be visually checked by plotting residuals against fitted axis scores, and by constructing a Q-Q plot of residuals against a normal distribution, available using 
</p>
<p><code>plot.sma(sma.object,which="residual")</code>. 
</p>
<p>On a residual plot, if there is a distinct increasing or decreasing trend within any of the groups, this suggests that all groups do not share a common slope.
</p>
<p>A plot of residual scores against fitted axis scores can also be used as a visual test for no shift. If fitted axis scores systematically differ across groups then this is evidence of a shift along the common axis.
</p>
<p>Setting <code>robust=TRUE</code> fits lines using Huber's M estimation, and modifies the test statistic as proposed in Taskinen &amp; Warton (in review).
</p>
<p>The common slope (<code class="reqn">\hat{\beta}</code>) is estimated from a maximum of 100 iterations, convergence is reached when the change in <code class="reqn">\hat{\beta}</code> is <code class="reqn">&lt; 10^{-6}</code>.
</p>


<h3>Value</h3>

<table>
<tr><td><code>stat</code></td>
<td>
<p>The Wald statistic testing for no shift along the common axis</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>The P-value of the test. This is calculated assuming that stat has a chi-square distribution with (g-1) df, if there are g groups</p>
</td></tr>
<tr><td><code>f.mean</code></td>
<td>
<p>The fitted axis means for each group</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Warton, D.I.<a href="mailto:David.Warton@unsw.edu.au">David.Warton@unsw.edu.au</a>, J. Ormerod, &amp; S. Taskinen</p>


<h3>References</h3>

<p> Warton D. I., Wright I. J., Falster D. S. and Westoby M. (2006) A review of bivariate line-fitting methods for allometry.  <em>Biological Reviews</em> <b>81</b>, 259&ndash;291.
</p>
<p>Taskinen, S. and D.I. Warton. in review. Robust tests for one or more allometric lines.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sma">sma</a></code>, <code><a href="#topic+plot.sma">plot.sma</a></code>, <code><a href="#topic+line.cis">line.cis</a></code>, <code><a href="#topic+elev.com">elev.com</a></code>, <code><a href="#topic+shift.com">shift.com</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>#load leaf longevity data
data(leaflife)

#Test for common SMA slope amongst species at low rainfall sites
#with different levels of soil nutrients
leaf.low.rain=leaflife[leaflife$rain=='low',]
with(leaf.low.rain, slope.com(log10(longev), log10(lma), soilp))

#Now test for no shift along the axes of common slope, for sites
#with different soil nutrient levels but low rainfall:
with(leaf.low.rain, shift.com(log10(longev), log10(lma), soilp))

#Now test for no shift along the axes of common slope, for sites
#with different soil nutrient levels but low rainfall:
with(leaf.low.rain,shift.com(log10(longev), log10(lma), soilp, method='MA'))

</code></pre>

<hr>
<h2 id='slope.com'> Common slope test amongst several allometric lines </h2><span id='topic+slope.com'></span>

<h3>Description</h3>

<p>Test if several major axis or standardised major axis lines share a common slope. This can now be done via <code>sma(y~x*groups)</code>, see help on the <code><a href="#topic+sma">sma</a></code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>slope.com(y, x, groups, method = 'SMA', alpha = 0.05, 
   data = NULL, intercept = TRUE, robust=FALSE,
   V = array(0, c(2, 2, length(unique(groups)))), 
   group.names = sort(unique(groups)),
   ci = TRUE, bs = TRUE, slope.test=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="slope.com_+3A_y">y</code></td>
<td>
<p> The Y-variable for all observations (as a vector) </p>
</td></tr>
<tr><td><code id="slope.com_+3A_x">x</code></td>
<td>
<p> The X-variable for all observations (as a vector) </p>
</td></tr>
<tr><td><code id="slope.com_+3A_groups">groups</code></td>
<td>
<p> Coding variable identifying which group each observation belongs to (as a factor or vector) </p>
</td></tr>
<tr><td><code id="slope.com_+3A_method">method</code></td>
<td>
<p> The line fitting method:
</p>

<dl>
<dt>'SMA' or 1</dt><dd><p>standardised major axis (this is the default)</p>
</dd>
<dt>'MA' or 2</dt><dd><p>major axis</p>
</dd>
<dt>'lamest' or 3</dt><dd><p>Error variance ratio is estimated from the data</p>
</dd>
</dl>

</td></tr>
<tr><td><code id="slope.com_+3A_alpha">alpha</code></td>
<td>
<p> The desired confidence level for the 100(1-alpha)% confidence interval for the common slope. (Default value is 0.05, which returns a 95% confidence interval.) </p>
</td></tr>
<tr><td><code id="slope.com_+3A_data">data</code></td>
<td>
<p> Deprecated. Use with() instead (see Examples).</p>
</td></tr>
<tr><td><code id="slope.com_+3A_intercept">intercept</code></td>
<td>
<p> (logical) Whether or not the line includes an  intercept.
</p>

<dl>
<dt>FALSE</dt><dd><p> no intercept, so the line is forced through the origin </p>
</dd>
<dt>TRUE</dt><dd><p> an intercept is fitted (this is the default) </p>
</dd>
</dl>

</td></tr>
<tr><td><code id="slope.com_+3A_robust">robust</code></td>
<td>
<p>If TRUE, uses a robust method to fit the lines and construct the test statistic.</p>
</td></tr>
<tr><td><code id="slope.com_+3A_v">V</code></td>
<td>
<p> The estimated variance matrices of measurement error, for each group. This is a 3-dimensional array with measurement error in Y in the first row and column, error in X in the second row and column, and groups running along the third dimension. Default is that there is no measurement error. </p>
</td></tr>
<tr><td><code id="slope.com_+3A_group.names">group.names</code></td>
<td>
<p> (optional: rarely required). A vector containing the labels for &lsquo;groups&rsquo;. (Only actually useful for reducing computation time in simulation work). </p>
</td></tr>
<tr><td><code id="slope.com_+3A_ci">ci</code></td>
<td>
<p> (logical) Whether or not to return a confidence interval for the common slope. </p>
</td></tr>
<tr><td><code id="slope.com_+3A_bs">bs</code></td>
<td>
<p> (logical) Whether or not to return the slopes for the separate groups, with confidence intervals. </p>
</td></tr>
<tr><td><code id="slope.com_+3A_slope.test">slope.test</code></td>
<td>
<p>If a value provided, tests the common slope fit against this value.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For several bivariate groups of observations, this function tests if the line-of-best-fit has a common slope for all samples, when the line-of-best-fit is estimated using the major axis, standardised major axis, or a more general version of these methods in which the error variance ratio is estimated from the data.
</p>
<p>The test assumes the following:
</p>

<ol>
<li><p> each group of observations was independently sampled
</p>
</li>
<li><p> y and x are linearly related within each group
</p>
</li>
<li><p> residuals independently follow a normal distribution with equal variance at all points along the line, within each group
</p>
</li></ol>

<p>Note that we do not need to assume equal variance across groups, unlike in the standard test for common slope for linear regression.
</p>
<p>The assumptions can be visually checked by plotting residual scores against fitted axis scores, and by constructing a Q-Q plot of residuals against a normal distribution, available using the <code><a href="#topic+plot.sma">plot.sma</a></code> function.
</p>
<p>Setting <code>robust=TRUE</code> fits lines using Huber's M estimation, and modifies the test statistic as proposed in Taskinen &amp; Warton (in review).
</p>
<p>The common slope is estimated from a maximum of 100 iterations, convergence is reached when the change in b is <code class="reqn">&lt; 10^{-6}</code>.
</p>


<h3>Value</h3>

<table>
<tr><td><code>lr</code></td>
<td>
<p>The (Bartlett-corrected) likelihood ratio statistic testing for common slope</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>The P-value of the test. This is calculated assuming that lr has a chi-square distribution with (g-1) df, if there are g groups</p>
</td></tr>
<tr><td><code>b</code></td>
<td>
<p>The common slope estimate</p>
</td></tr>
<tr><td><code>varb</code></td>
<td>
<p>The sample variance of the common slope</p>
</td></tr>
<tr><td><code>ci</code></td>
<td>
<p>A 100(1-alpha)% confidence interval for the common slope</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>The error variance ratio - the ratio of error variance in y to error variance in x. For MA, this is assumed to be 1. for SMA, this is assumed to be <code class="reqn">b^2</code>. For the &lsquo;lamest&rsquo; method, the error variance ratio is estimated from the data under the common slope assumption.</p>
</td></tr>
<tr><td><code>bs</code></td>
<td>
<p>The slopes and confidence intervals for data from each group.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Warton, D.I.<a href="mailto:David.Warton@unsw.edu.au">David.Warton@unsw.edu.au</a>, J. Ormerod, &amp; S. Taskinen</p>


<h3>References</h3>

<p> Warton D. I. and Weber N. C. (2002) Common slope tests for bivariate structural relationships.  <em>Biometrical Journal</em> <b>44</b>, 161&ndash;174.
</p>
<p>Warton D. I., Wright I. J., Falster D. S. and Westoby M. (2006) A review of bivariate line-fitting methods for allometry.  <em>Biological Reviews</em> <b>81</b>, 259&ndash;291.
</p>
<p>Taskinen, S. and D.I. Warton. in review. Robust tests for one or more allometric lines.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+sma">sma</a></code>, <code><a href="#topic+line.cis">line.cis</a></code>, <code><a href="#topic+elev.com">elev.com</a></code>, <code><a href="#topic+shift.com">shift.com</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>#load leaf longevity data
data(leaflife)

#plot the data, with different symbols for different groups.
plot(leaflife$lma, leaflife$longev, type='n', log='xy', xlab=
   'leaf mass per area [log scale]', ylab='leaf longevity [log scale]')
colours &lt;- c('blue', 'red', 'green', 'yellow')
points(leaflife$lma, leaflife$longev,
   col=colours[as.numeric(leaflife$site)])
legend(55, 5, as.character(unique(leaflife$site)), col=colours,
   pch=rep(1,4))

#test for common SMA slope of log(leaf longevity) vs log(LMA),
#across species sampled at different sites:
fit &lt;- with(leaflife, slope.com(log10(longev), log10(lma), site))
fit

#Residual vs fits plots for SMA fit of each site
y &lt;- log10(leaflife$longev)
x &lt;- log10(leaflife$lma)
site &lt;- leaflife$site
par( mfrow=c(2,2) )
plot(y[site==1] + fit$bs[1,1] * x[site==1], y[site==1] - fit$bs[1,1] 
   * x[site==1], xlab='fits (site 1)', ylab='residuals (site 1)')
plot(y[site==2] + fit$bs[1,2] * x[site==2], y[site==2] - fit$bs[1,2]
   * x[site==2], xlab='fits (site 2)', ylab='residuals (site 2)')
plot(y[site==3] + fit$bs[1,3] * x[site==3], y[site==3] - fit$bs[1,3]
   * x[site==3], xlab='fits (site 3)', ylab='residuals (site 3)')
plot(y[site==4] + fit$bs[1,4] * x[site==4], y[site==4] - fit$bs[1,4]
   * x[site==4], xlab='fits (site 4)', ylab='residuals (site 4)')

#Test for common SMA slope amongst species at low rainfall sites
#with different levels of soil nutrients
leaf.low.rain &lt;- leaflife[leaflife$rain=='low',]
with(leaf.low.rain, slope.com(log10(longev), log10(lma), soilp))

#test for common MA slope:
with(leaflife, slope.com(log10(longev), log10(lma), site, method='MA'))

#test for common MA slope, and produce a 90% CI for the common slope:
with(leaflife, slope.com(log10(longev), log10(lma), site,  method='MA', alpha=0.1))

</code></pre>

<hr>
<h2 id='slope.test'>One-sample test of a (standardised) major axis slope</h2><span id='topic+slope.test'></span>

<h3>Description</h3>

<p>Test if the slope of a major axis or standardised
major axis equals a specific value. This can now be done via <code>sma(y~x, slope.test=1)</code>, see help on <code><a href="#topic+sma">sma</a></code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>    slope.test(y, x, test.value = 1, data=NULL, method = SMA,
        alpha = 0.05, V = matrix(0,2,2), intercept = TRUE, robust=FALSE )

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="slope.test_+3A_y">y</code></td>
<td>
<p> The Y-variable </p>
</td></tr>
<tr><td><code id="slope.test_+3A_x">x</code></td>
<td>
<p> The X-variable </p>
</td></tr>
<tr><td><code id="slope.test_+3A_test.value">test.value</code></td>
<td>
<p> The hypothesised value of the slope (default value is 1) </p>
</td></tr>
<tr><td><code id="slope.test_+3A_data">data</code></td>
<td>
<p>Deprecated. Use with() instead (see Examples). </p>
</td></tr>
<tr><td><code id="slope.test_+3A_method">method</code></td>
<td>
<p> The line fitting method:
</p>

<dl>
<dt>'OLS' or 0</dt><dd><p>linear regression</p>
</dd>
<dt>'SMA' or 1</dt><dd><p>standardised major axis (this is the default)</p>
</dd>
<dt>'MA' or 2</dt><dd><p>major axis</p>
</dd>
</dl>

</td></tr>
<tr><td><code id="slope.test_+3A_alpha">alpha</code></td>
<td>
<p> The desired confidence level for the 100(1-alpha)% confidence interval for the common slope. (Default value is 0.05, which returns a 95% confidence interval.) </p>
</td></tr>
<tr><td><code id="slope.test_+3A_robust">robust</code></td>
<td>
<p>If TRUE, uses a robust method to fit the lines and construct the test statistic.</p>
</td></tr>
<tr><td><code id="slope.test_+3A_v">V</code></td>
<td>
<p> The estimated variance matrix of measurement error. Average measurement error for Y is in the first row and column, and average measurement error for X is in the second row and column. The default is that there is no measurement error. </p>
</td></tr>
<tr><td><code id="slope.test_+3A_intercept">intercept</code></td>
<td>
<p> (logical) Whether or not the line includes an  intercept.
</p>

<dl>
<dt>FALSE</dt><dd><p> no intercept, so the line is forced through the origin </p>
</dd>
<dt>TRUE</dt><dd><p> an intercept is fitted (this is the default) </p>
</dd>
</dl>

</td></tr>
</table>


<h3>Details</h3>

<p>Tests if the line relating y to x has a slope equal to test.value (which has a default value of 1). The line can be a linear regression line, major axis or standardised major axis (as selected using the input argument choice). The test is carried out by testing for correlation between residual and fitted values, as described in Warton et al (in review).
</p>
<p>A confidence interval for the slope is also returned, which is the primary confidence interval found by inverting the one-sample test statistic.
</p>
<p>If measurement error is present, it can be corrected for through use of the input argument V, which makes adjustments to the estimated sample variances and covariances then proceeds with the same method of inference. Note, however, that this method is only approximate (see Warton et al in review for more details).
</p>
<p>The test assumes the following:
</p>

<ol>
<li><p> y and x are linearly related
</p>
</li>
<li><p> residuals independently follow a normal distribution with equal variance at all points along the line
</p>
</li></ol>
      
<p>The assumptions can be visually checked by plotting residual scores against fitted axis scores, and by constructing a Q-Q plot of residuals against a normal distribution, available using the <code><a href="#topic+plot.sma">plot.sma</a></code> function.
</p>
<p>Setting <code>robust=TRUE</code> fits lines using Huber's M estimation, and modifies the test statistic as proposed in Taskinen &amp; Warton (in review).
</p>


<h3>Value</h3>

<table>
<tr><td><code>r</code></td>
<td>
<p>The test statistic - the sample correlation between residuals and fitted values</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>The P-value, taken from the F-distribution. This is an exact test if residuals are normally distributed.</p>
</td></tr>
<tr><td><code>test.value</code></td>
<td>
<p>The hypothesised value of the slope</p>
</td></tr>
<tr><td><code>b</code></td>
<td>
<p>The estimated slope</p>
</td></tr>
<tr><td><code>ci</code></td>
<td>
<p>A 100(1-alpha)% CI for the slope.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Warton, D.I.<a href="mailto:David.Warton@unsw.edu.au">David.Warton@unsw.edu.au</a>, J. Ormerod, &amp; S. Taskinen</p>


<h3>References</h3>

 
<p>Warton D. I., Wright I. J., Falster D. S. and Westoby M. (2006) A review of bivariate line-fitting methods for allometry.  <em>Biological Reviews</em> <b>81</b>, 259&ndash;291.
</p>
<p>Taskinen, S. and D.I. Warton. in review. Robust tests for one or more allometric lines.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sma">sma</a></code>, <code><a href="#topic+line.cis">line.cis</a></code>, <code><a href="#topic+elev.test">elev.test</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>#load the leaflife dataset:
data(leaflife)

#consider only the low rainfall sites:
leaf.low.rain &lt;- leaflife[leaflife$rain=='low',]

#test if the SMA slope amongst species at low rainfall sites is 1,
#for log (base 10) transformed data:
with(leaf.low.rain, slope.test(log10(longev), log10(lma)))
    
#test if the MA slope is 2/3
with(leaf.low.rain, slope.test(log10(longev), log10(lma), test.value = 2/3, method = 'MA'))
</code></pre>

<hr>
<h2 id='sma'>
(Standardized) major axis estimation and testing for one or several samples
</h2><span id='topic+sma'></span><span id='topic+ma'></span>

<h3>Description</h3>

<p>The <code>sma</code> and <code>ma</code> functions fit SMA and MA respectively, and construct confidence 
intervals or test hypotheses about slope or elevation in one or several samples, depending on how the arguments 
are specified. Options exist to force lines through the origin, (approximately) correct for measurement error if the 
measurement error variance is known, and use robust estimation to ensure that inferences are valid in
the presence of outliers (currently implemented for single samples only).</p>


<h3>Usage</h3>

<pre><code class='language-R'>sma(formula, data, subset, na.action, log="",
	 method=c("SMA","MA","OLS"), type=c("elevation","shift"), 
   alpha=0.05, slope.test=NA, elev.test=NA, 
   multcomp=FALSE, multcompmethod=c("default","adjusted"),
	 robust=FALSE,V=matrix(0,2,2),n_min=3,quiet=FALSE,
	 ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sma_+3A_formula">formula</code></td>
<td>
<p>Formula of the form y ~ x etc. This determines whether a single (S)MA is fitted, or whether several lines are fitted and compared. See Details.</p>
</td></tr>
<tr><td><code id="sma_+3A_data">data</code></td>
<td>
<p>A dataframe with the x and y variables.</p>
</td></tr>
<tr><td><code id="sma_+3A_subset">subset</code></td>
<td>
<p>A subset of the dataframe for fitting; optional.</p>
</td></tr>
<tr><td><code id="sma_+3A_na.action">na.action</code></td>
<td>
<p>What to do with missing values (na.omit, na.fail, etc).</p>
</td></tr>
<tr><td><code id="sma_+3A_log">log</code></td>
<td>
<p>One of 'x', 'y', or 'xy' to log10-transform variables.</p>
</td></tr>
<tr><td><code id="sma_+3A_method">method</code></td>
<td>
<p>If SMA, standardized major axis, if MA, major axis, and if OLS, ordinary least squares.</p>
</td></tr>
<tr><td><code id="sma_+3A_type">type</code></td>
<td>
<p>If several lines with common slope are to be compared, do you want to test for a change in 'elevation' or for a 'shift' along a common (S)MA. See Details.</p>
</td></tr>
<tr><td><code id="sma_+3A_alpha">alpha</code></td>
<td>
<p>The error rate for confidence intervals. Typically 0.05.</p>
</td></tr>
<tr><td><code id="sma_+3A_slope.test">slope.test</code></td>
<td>
<p>The hypothesised value to be used, if testing for evidence that (S)MA slope(s) are significantly different from a hypothesised value.</p>
</td></tr>
<tr><td><code id="sma_+3A_elev.test">elev.test</code></td>
<td>
<p>The hypothesised value to be used, if testing for evidence that (S)MA elevation(s) are significantly different from a hypothesised value.</p>
</td></tr>
<tr><td><code id="sma_+3A_robust">robust</code></td>
<td>
<p>If TRUE, uses a new method of robust line fitting. (Currently available for single-sample testing only.)</p>
</td></tr>
<tr><td><code id="sma_+3A_v">V</code></td>
<td>
<p>The estimated variance matrix of measurement error. Average measurement error for Y is in the first row and column, and average measurement error for X is in the second row and column. The default is that there is no measurement error.</p>
</td></tr>
<tr><td><code id="sma_+3A_n_min">n_min</code></td>
<td>
<p>The minimum sample size for a group.</p>
</td></tr>
<tr><td><code id="sma_+3A_quiet">quiet</code></td>
<td>
<p>If TRUE, suppresses all messages.</p>
</td></tr>
<tr><td><code id="sma_+3A_multcomp">multcomp</code></td>
<td>
<p>Logical. If TRUE, performs pair-wise comparisons between levels of the grouping variable.</p>
</td></tr>
<tr><td><code id="sma_+3A_multcompmethod">multcompmethod</code></td>
<td>
<p>Whether to adjust the P values for multiple comparisons ('adjusted') or not ('default').</p>
</td></tr>
<tr><td><code id="sma_+3A_...">...</code></td>
<td>
<p>Further arguments passed to internal functions (none at the moment?)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is the key function in the <code><a href="#topic+smatr-package">smatr-package</a></code>; all the key estimation and testing 
functionality in the package can all be accessed using this function, via different usages of 
the <code>formula</code> and other arguments, as described below.
</p>
<p><b>One-sample testing</b>
The below options allow estimation of a (S)MA, confidence intervals for parameters, and hypothesis testing of parameters, from a single sample of two variables <code>y</code> and <code>x</code>. Use the <code>sma</code> function to fit a standardised major axis (SMA), or use <code>ma</code> in combination with the below options in order to fit major axis (MA) instead.
</p>

<dl>
<dt><code>sma(y~x)</code></dt><dd><p> Fits a SMA and constructs confidence intervals for the true slope and elevation. Replaces the <code><a href="#topic+line.cis">line.cis</a></code> function from previous versions of smatr. </p>
</dd>
<dt><code>ma(y~x)</code></dt><dd><p> Fits a MA and constructs confidence intervals for the true slope and elevation. All the below functions also work for MA, if the <code>ma</code> function is called instead of the <code>sma</code> function.</p>
</dd>
<dt><code>sma(y~x, slope.test=B)</code></dt><dd><p> Tests if the slope of a SMA equals <code>B</code>. </p>
</dd>
<dt><code>sma(y~x, elev.test=A)</code></dt><dd><p> Tests if the elevation of a SMA equals <code>A</code>. </p>
</dd>
<dt><code>sma(y~x, robust=T)</code></dt><dd><p> Fits a SMA using Huber's M estimation and constructs confidence intervals for the true slope and elevation. This offers robustness to outliers in estimation and inference, and can be used in combination with the <code>slope.test</code> and <code>elev.test</code> arguments. </p>
</dd>
<dt><code>sma(y~x-1)</code></dt><dd><p> Fits a SMA where the line is forced through the origin, and constructs confidence intervals for the true slope. This type of formula can be used in combination with the <code>slope.test</code> argument.</p>
</dd>
</dl>

<p><b>For several samples:</b>
The below options allow estimation of several (S)MA lines, confidence intervals for parameters, and hypothesis testing of parameters, from two variables <code>y</code> and <code>x</code> for observations that have been classified into several different samples using the factor <code>groups</code>. Use the <code>sma</code> function to fit a standardised major axis (SMA), or use the <code>ma</code> in combination with the below options in order to fir major axis (MA) instead.
</p>

<dl>
<dt><code>sma(y~x*groups)</code></dt><dd><p> Test if several SMA lines share a common slope, and construct a confidence interval for the true common slope. </p>
</dd>
<dt><code>sma(y~x+groups, type="elevation")</code></dt><dd><p> Test if several common slope SMA lines also share a common elevation, and construct a confidence interval for the true common elevation. </p>
</dd>
<dt><code>sma(y~x+groups, type="shift")</code></dt><dd><p> Test if several groups of observations have no shift in location along common slope SMA lines. </p>
</dd>
<dt><code>sma(y~x*groups, slope.test=B)</code></dt><dd><p> Test if several SMA lines share a common slope whose true value is exactly equal to <code>B</code>. </p>
</dd>
<dt><code>sma(y~x+groups, elev.test=A)</code></dt><dd><p> Test if several common-slope SMA lines share a common elevation whose true value is exactly equal to <code>A</code>. </p>
</dd>
<dt><code>sma(y~x*groups-1)</code></dt><dd><p> Test if several SMA lines forced through the origin share a common slope. This can also be used in combination with the <code>slope.test</code> argument or when testing for no shift along common (S)MA lines.</p>
</dd>
</dl>

<p>In all cases, estimates and confidence intervals for key parameters are returned, and if a hypothesis test is done, results will be returned and stored in the <code>slope.test</code> or <code>elev.test</code> output arguments.
</p>
<p>The <code><a href="base.html#topic+plot">plot</a></code> function can be applied to objects produced using the <code>sma</code> and <code>ma</code> functions, which is highly recommended to visualise results and check assumptions.
</p>
<p><b>Multiple comparisons</b>
If multcomp=TRUE, pair-wise comparisons are made between levels of the grouping variable for differences in slope, elevation or shift, depending on the formula used.
The P values can be adjusted for multiple comparisons (using the Sidak correction). See also <code><a href="#topic+multcompmatrix">multcompmatrix</a></code> for visualization of the results.
<b>Warning:</b> When using the multiple comparisons (multcomp=TRUE), you must specify a <code>data</code> statement. If your variables are not in a dataframe, simply combine them in a dataframe before calling <code>sma</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>sma</code> or <code>ma</code>, which contains the following output arguments:
</p>

<dl>
<dt>coef</dt><dd><p> The coefficients of the fitted (standardised) major axes. If several samples are being compared, this will return parameters from the alternative model, e.g. assuming separate slopes if testing for common slope, or assuming common slope but separate elevations if testing for common elevation. </p>
</dd>
<dt>nullcoef</dt><dd><p>The coefficients under the null hypothesis</p>
</dd>
<dt>alpha</dt><dd><p> As above. </p>
</dd>
<dt>method</dt><dd><p> The method used in fitting lines: 'MA' or 'SMA' </p>
</dd>
<dt>intercept</dt><dd><p> Whether or not (S)MA lines were forced through the origin (True or False). </p>
</dd>
<dt>call</dt><dd><p> The call to the <code>ma</code> or <code>sma</code> function. </p>
</dd>
<dt>data</dt><dd><p> As above. </p>
</dd>
<dt>log</dt><dd><p> As above. </p>
</dd>
<dt>variables</dt><dd><p> A list of the variables used in fitting (S)MA lines. </p>
</dd>
<dt>origvariables</dt><dd><p> A list of the variables prior to transformation (if any) for use in fitting (S)MA lines. </p>
</dd>
<dt>groups</dt><dd><p>Levels of the grouping variable, if present in the fit.</p>
</dd>
<dt>gt</dt><dd><p>Type of grouptest (&quot;slopecom&quot;,&quot;elevcom&quot;,or &quot;shiftcom&quot;), if it was carried out, or &quot;none&quot; if none.</p>
</dd>
<dt>gtr</dt><dd><p>The result of that grouptest.</p>
</dd>
<dt>slopetest</dt><dd><p> Output from the hypothesis test of slope(s), if any. Returned as a list of objects, including the P-value (<code>p</code>), the test statistic (<code>r</code> or <code>LR</code>), the (common) slope (<code>b</code>) and its confidence interval (<code>ci</code>). </p>
</dd>
<dt>elevtest</dt><dd><p> Output from the hypothesis test of elevation(s), if any. Returned as a list of objects, including the P-value (<code>p</code>), the test statistic (<code>t</code> or <code>stat</code>), the (common) elevation (<code>a</code>) and its confidence interval (<code>ci</code>). </p>
</dd>
<dt>slopetestdone</dt><dd><p>Whether a slopetest was actually carried out.</p>
</dd>
<dt>elevtestdone</dt><dd><p>Whether an elevation test was actually carried out.</p>
</dd>
<dt>n</dt><dd><p>Sample size(s).</p>
</dd>
<dt>r2</dt><dd><p>Squared correlation coefficient.</p>
</dd>
<dt>pval</dt><dd><p>P-value of the test of correlation coefficient against zero.</p>
</dd>
<dt>from,to</dt><dd><p>X values corresponding the maximum and minimum fitted values in each group. Used by plot.sma to determine endpoints for fitted lines).</p>
</dd>
<dt>groupsummary</dt><dd><p>Neatly organized dataframe with coefficients by group.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p> Warton, D. I. <a href="mailto:David.Warton@unsw.edu.au">David.Warton@unsw.edu.au</a>, R.A. Duursma, D. Falster, S. Taskinen  </p>


<h3>References</h3>

 
<p>Warton, D.I., R.A. Duursma, D.S. Falster and S. Taskinen (2012). smatr 3 - an R package for estimation and inference about allometric lines. <em>Methods in Ecology and Evolution</em>. <b>3</b>, 257-259.
</p>
<p>Warton D. I. and Weber N. C. (2002) Common slope tests for bivariate structural relationships.  <em>Biometrical Journal</em> <b>44</b>, 161&ndash;174.
</p>
<p>Warton D. I., Wright I. J., Falster D. S. and Westoby M. (2006) A review of bivariate line-fitting methods for allometry.  <em>Biological Reviews</em> <b>81</b>, 259&ndash;291.
</p>
<p>Taskinen S. and Warton D. I. (in press) Robust estimation and inference for bivariate line-fitting in allometry.  <em>Biometrical Journal</em>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.sma">plot.sma</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Load leaf lifetime dataset:
data(leaflife)

### One sample analyses ###
# Extract only low-nutrient, low-rainfall data:
leaf.low &lt;- subset(leaflife, soilp == 'low' &amp; rain == 'low')

# Fit a MA for log(leaf longevity) vs log(leaf mass per area):
ma(longev ~ lma, log='xy', data=leaflife)

# Test if the MA slope is not significantly different from 1:
ma.test &lt;- ma(longev ~ lma, log='xy', slope.test=1, data=leaflife)
summary(ma.test)

# Construct a residual plot to check assumptions:
plot(ma.test,type="residual")

### Several sample analyses ###

# Now consider low-nutrient sites (high and low rainfall):
leaf.low.soilp &lt;- subset(leaflife, soilp == 'low')

# Fit SMA's separately at each of high and low rainfall sites,
# and test for common slope:
com.test &lt;- sma(longev~lma*rain, log="xy", data=leaf.low.soilp)
com.test

# Plot longevity vs LMA separately for each group:
plot(com.test)

# Fit SMA's separately at each of high and low rainfall sites,
# and test if there is a common slope equal to 1:
sma(longev~lma*rain, log="xy", slope.test=1, data=leaf.low.soilp)

# Fit SMA's with common slope across each of high and low rainfall sites, 
# and test for common elevation:
sma(longev~lma+rain, log="xy", data=leaf.low.soilp)

# Fit SMA's with common slope across each of high and low rainfall sites, 
# and test for no shift along common SMA:
sma(longev~lma+rain, log="xy", type="shift", data=leaf.low.soilp)

</code></pre>

<hr>
<h2 id='summary.sma'>Print a summary</h2><span id='topic+summary.sma'></span>

<h3>Description</h3>

<p>Writes a summary of a (standardized) major axis fit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'sma'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.sma_+3A_object">object</code></td>
<td>
<p>Object of class 'sma'.</p>
</td></tr>
<tr><td><code id="summary.sma_+3A_...">...</code></td>
<td>
<p>Further arguments ignored.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Does not add much to print.sma, at the moment, except when fit by multiple groups.
See <code><a href="#topic+sma">sma</a></code> for examples.
</p>


<h3>Author(s)</h3>

<p>Remko Duursma, Daniel Falster, David Warton
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sma">sma</a></code>,<code><a href="#topic+print.sma">print.sma</a></code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
