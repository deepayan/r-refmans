<!DOCTYPE html><html><head><title>Help for package striprtf</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {striprtf}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#looks_rtf'><p>Test if a file looks like an RTF</p></a></li>
<li><a href='#read_rtf'><p>Extract Text from RTF (Rich Text Format) File</p></a></li>
<li><a href='#striprtf-deprecated'><p>Renamed Functions</p></a></li>
<li><a href='#unused_letters'><p>Find letters not used in strings</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Extract Text from RTF File</td>
</tr>
<tr>
<td>Version:</td>
<td>0.6.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Extracts plain text from RTF (Rich Text Format) file.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>magrittr, Rcpp, stringr, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/kota7/striprtf">https://github.com/kota7/striprtf</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/kota7/striprtf/issues">https://github.com/kota7/striprtf/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-09 17:40:13 UTC; kota</td>
</tr>
<tr>
<td>Author:</td>
<td>Kota Mori [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Kota Mori &lt;kmori05@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-10 16:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='looks_rtf'>Test if a file looks like an RTF</h2><span id='topic+looks_rtf'></span>

<h3>Description</h3>

<p>Validate if a file looks like an RTF.
The test should be seen as a minimal requirement;
If failed, the file is highly likely that the file is invalid,
while passed, there is still possibility that the file does not follw the rule of RTF files.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>looks_rtf(con, n = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="looks_rtf_+3A_con">con</code></td>
<td>
<p>A connection object or string of file name</p>
</td></tr>
<tr><td><code id="looks_rtf_+3A_n">n</code></td>
<td>
<p>Integer that specifies the length of contents to be tested.
If smaller than 10, forced to 10.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Logical.
</p>

<hr>
<h2 id='read_rtf'>Extract Text from RTF (Rich Text Format) File</h2><span id='topic+read_rtf'></span><span id='topic+strip_rtf'></span>

<h3>Description</h3>

<p>Parses an RTF file and extracts plain text as character vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_rtf(
  file,
  verbose = FALSE,
  row_start = "*| ",
  row_end = "",
  cell_end = " | ",
  ignore_tables = FALSE,
  check_file = TRUE,
  ...
)

strip_rtf(
  text,
  verbose = FALSE,
  row_start = "*| ",
  row_end = "",
  cell_end = " | ",
  ignore_tables = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_rtf_+3A_file">file</code></td>
<td>
<p>Path to an RTF file. Must be character of length 1.</p>
</td></tr>
<tr><td><code id="read_rtf_+3A_verbose">verbose</code></td>
<td>
<p>Logical. If TRUE, progress report is printed on console.
While it can be informative when parsing a large file,
this option itself makes the process slow.</p>
</td></tr>
<tr><td><code id="read_rtf_+3A_row_start">row_start</code>, <code id="read_rtf_+3A_row_end">row_end</code></td>
<td>
<p>strings to be added at the beginning and end of table rows</p>
</td></tr>
<tr><td><code id="read_rtf_+3A_cell_end">cell_end</code></td>
<td>
<p>string to be put at the end of table cells</p>
</td></tr>
<tr><td><code id="read_rtf_+3A_ignore_tables">ignore_tables</code></td>
<td>
<p>if <code>TRUE</code>, no special treatment for tables</p>
</td></tr>
<tr><td><code id="read_rtf_+3A_check_file">check_file</code></td>
<td>
<p>if <code>TRUE</code>, conducts a quick check on the file if it is an RTF file.
If the file fails to pass the check, returns NULL without parsing the file.</p>
</td></tr>
<tr><td><code id="read_rtf_+3A_...">...</code></td>
<td>
<p>Addional arguments passed to <code><a href="base.html#topic+readLines">readLines</a></code></p>
</td></tr>
<tr><td><code id="read_rtf_+3A_text">text</code></td>
<td>
<p>Character of length 1.  Expected to be contents of an RTF file.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Rich text format (RTF) files are written as a text file
consisting of ASCII characters.  The specification has been developed by
Microsoft.
This function interprets the character strings and extracts plain texts of
the file.
Major part of the algorithm of this function comes from a
stack overflow thread (<a href="https://stackoverflow.com/a/188877">https://stackoverflow.com/a/188877</a>) and
the references therein.
This function is a translation of the above to R language, associated with C++ codes for enhancement.
</p>
<p>An advance from the preceding implementation is that the function
accomodates with various ANSI code pages.  For example, RTF files created
by Japanese version of Microsoft Word marks <code>\ansicpg932</code>, which indicates
the code page 932 is used for letter-code conversion.
The function detects the code page indication and
convert the characters to UTF-8 where possible.  Conversion tables are retrieved from
here: (<a href="https://www.unicode.org/Public/MAPPINGS/VENDORS/MICSFT/">https://www.unicode.org/Public/MAPPINGS/VENDORS/MICSFT/</a>).
</p>


<h3>Value</h3>

<p>Character vector of extracted text
</p>


<h3>References</h3>


<ul>
<li><p>Original discussion thread: <a href="https://stackoverflow.com/a/188877">https://stackoverflow.com/a/188877</a>
</p>
</li>
<li><p>Code page table: <a href="https://www.unicode.org/Public/MAPPINGS/VENDORS/MICSFT/">https://www.unicode.org/Public/MAPPINGS/VENDORS/MICSFT/</a>
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>read_rtf(system.file("extdata/king.rtf", package = "striprtf"))
</code></pre>

<hr>
<h2 id='striprtf-deprecated'>Renamed Functions</h2><span id='topic+striprtf-deprecated'></span><span id='topic+striprtf'></span><span id='topic+rtf2text'></span>

<h3>Description</h3>

<p>From ver 0.3.1, the functions are renamed as follows:
</p>

<ul>
<li><p><code>striprtf</code> &ndash;&gt; <code><a href="#topic+read_rtf">read_rtf</a></code>
</p>
</li>
<li><p><code>rtf2text</code> &ndash;&gt; <code><a href="#topic+strip_rtf">strip_rtf</a></code>
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>striprtf(file, verbose = FALSE, ...)

rtf2text(text, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="striprtf-deprecated_+3A_file">file</code></td>
<td>
<p>Path to an RTF file. Must be character of length 1.</p>
</td></tr>
<tr><td><code id="striprtf-deprecated_+3A_verbose">verbose</code></td>
<td>
<p>Logical. If TRUE, progress report is printed on console.
While it can be informative when parsing a large file,
this option itself makes the process slow.</p>
</td></tr>
<tr><td><code id="striprtf-deprecated_+3A_...">...</code></td>
<td>
<p>Addional arguments passed to <code><a href="base.html#topic+readLines">readLines</a></code></p>
</td></tr>
<tr><td><code id="striprtf-deprecated_+3A_text">text</code></td>
<td>
<p>Character of length 1.  Expected to be contents of an RTF file.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character vector of extracted text
</p>

<hr>
<h2 id='unused_letters'>Find letters not used in strings</h2><span id='topic+unused_letters'></span>

<h3>Description</h3>

<p>Returns letters not used in strings
</p>


<h3>Usage</h3>

<pre><code class='language-R'>unused_letters(
  s,
  n = 1,
  avoid_strifrtf_internal = TRUE,
  as_number = FALSE,
  as_vector = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="unused_letters_+3A_s">s</code></td>
<td>
<p>character vector</p>
</td></tr>
<tr><td><code id="unused_letters_+3A_n">n</code></td>
<td>
<p>number of letters to return</p>
</td></tr>
<tr><td><code id="unused_letters_+3A_avoid_strifrtf_internal">avoid_strifrtf_internal</code></td>
<td>
<p>If <code>TRUE</code>, letters used in the package's internal process are also regarded as &quot;used&quot;.</p>
</td></tr>
<tr><td><code id="unused_letters_+3A_as_number">as_number</code></td>
<td>
<p>if <code>TRUE</code>, return unicode numbers instead of letters itself</p>
</td></tr>
<tr><td><code id="unused_letters_+3A_as_vector">as_vector</code></td>
<td>
<p>if <code>FALSE</code> (and <code>as_number</code> is <code>FALSE</code>), return
a single concatenated character, otherwise returns a character vector</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function can be useful when some special characters must be
temporarily converted to another letter without being confused with the same letters used elsewhere.
</p>
<p>Letters are first searched from <code>\u0001</code> upto <code>\uffff</code>.
Do not specify too large <code>n</code>; An error is raised if a sufficient number of unsed letters are not found.
</p>


<h3>Value</h3>

<p>unsed characters, format depends on <code>as_number</code> and <code>as_vector</code> arguments
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
