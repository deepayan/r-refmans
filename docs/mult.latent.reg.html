<!DOCTYPE html><html><head><title>Help for package mult.latent.reg</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {mult.latent.reg}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#fetal_covid_data'><p>A set of fetal movements data collected before and during the Covid-19 pandemic</p></a></li>
<li><a href='#IALS_data'><p>International Adult Literacy Survey (IALS) for 13 countries</p></a></li>
<li><a href='#mult.em_1level'><p>EM algorithm for multivariate one level model with covariates</p></a></li>
<li><a href='#mult.em_2level'><p>EM algorithm for multivariate two level model with covariates</p></a></li>
<li><a href='#mult.latent.reg'><p>Regression and Clustering in Multivariate Response Scenarios</p></a></li>
<li><a href='#mult.reg_1level'><p>Selecting the best results for multivariate one level model</p></a></li>
<li><a href='#mult.reg_2level'><p>Selecting the best results for multivariate two level model</p></a></li>
<li><a href='#start_em'><p>Starting values for parameters</p></a></li>
<li><a href='#trading_data'><p>A set of import and export data in 44 countries.</p></a></li>
<li><a href='#twins_data'><p>A set of fetal movements data in twins and singletons.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Regression and Clustering in Multivariate Response Scenarios</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.7</td>
</tr>
<tr>
<td>Description:</td>
<td>Fitting multivariate response models with random effects on one or two levels; whereby the (one-dimensional) random effect represents a latent variable approximating the multivariate space of outcomes, after possible adjustment for covariates. The method is particularly useful for multivariate, highly correlated outcome variables with unobserved heterogeneities. Applications include regression with multivariate responses, as well as multivariate clustering or ranking problems. See Zhang and Einbeck (2024) &lt;<a href="https://doi.org/10.1007%2Fs42519-023-00357-0">doi:10.1007/s42519-023-00357-0</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>mvtnorm, stats, matrixStats, utils, lme4</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Collate:</td>
<td>'fetal_covid_data.R' 'IALS_data.R' 'mult.latent.reg-package.R'
'mult.reg_1level.R' 'mult.reg_2level.R' 'start.em.1level.R'
'start.em.2level.R' 'start.em.R' 'trading_data.R'
'twins_data.R'</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-21 14:53:34 UTC; katiezhang</td>
</tr>
<tr>
<td>Author:</td>
<td>Yingjuan Zhang [aut, cre],
  Jochen Einbeck [aut, ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Yingjuan Zhang &lt;yingjuan.zhang@durham.ac.uk&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-21 17:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='fetal_covid_data'>A set of fetal movements data collected before and during the Covid-19 pandemic</h2><span id='topic+fetal_covid_data'></span>

<h3>Description</h3>

<p>The data were recorded via 4D ultrasound scans from 40 fetuses (20 before Covid and 20 during Covid) at 32 weeks gestation,
and consist of the number of movements each fetus carries out in relation to the recordable scan length.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(fetal_covid_data)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>"data.frame"</code>
</p>

<dl>
<dt>UpperFaceMovements</dt><dd><p>Inner Brow Raiser, Outer Brow Raiser, Brow Lower, Cheek Raiser, Nose Wrinkle.</p>
</dd>
<dt>Headmovements</dt><dd><p>Turn Right, Turn Left, Up, Down.</p>
</dd>
<dt>MouthMovements</dt><dd><p>Upper Lip Raiser, Nasolabial Furrow, Lip Puller,
Lower Lip Depressor, Lip Pucker, Tongue Show, Lip Stretch, Lip Presser, Lip Suck, Lips Parting, Jaw Drop, Mouth Stretch.</p>
</dd>
<dt>TouchMovements</dt><dd><p>Upper Face, Side Face, Lower Face, Mouth Area.</p>
</dd>
<dt>EyeBlink</dt><dd><p>All scans were coded for eye blink.</p>
</dd>
<dt>status_bi</dt><dd><p>&quot;during the pandemic&quot; is coded by 1, &quot;before the pandemic&quot; is coded by 0.</p>
</dd>
<dt>status</dt><dd><p>specifies whether it is during or before the pandemic.</p>
</dd>
</dl>



<h3>References</h3>

<p>Reissland, N., Ustun, B. and Einbeck, J. (2024).
The effects of lockdown during the COVID-19 pandemic on fetal movement profiles.
BMC Pregnancy and Childbirth, 24(1), 1-7.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(fetal_covid_data)
head(fetal_covid_data)
</code></pre>

<hr>
<h2 id='IALS_data'>International Adult Literacy Survey (IALS) for 13 countries</h2><span id='topic+IALS_data'></span>

<h3>Description</h3>

<p>The data is obtained from the International Adult Literacy Survey (IALS),
collected in 13 countries on Prose, Document, and Quantitative scales between 1994 and 1995.
The data are reported as the percentage of individuals who could not reach a basic level of literacy in each country.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(IALS_data)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>"data.frame"</code>
</p>

<dl>
<dt>Prose</dt><dd><p>On prose scale, the percentage of individuals who could not reach a basic level of literacy in each country.</p>
</dd>
<dt>Document</dt><dd><p>On document scale, the percentage of individuals who could not reach a basic level of literacy in each country.</p>
</dd>
<dt>Quantitative</dt><dd><p>On quantitative scale, the percentage of individuals who could not reach a basic level of literacy in each country.</p>
</dd>
<dt>Country</dt><dd><p>Specify the country</p>
</dd>
<dt>Gender</dt><dd><p>Specify the gender</p>
</dd>
</dl>



<h3>References</h3>

<p>Sofroniou, N., Hoad, D., &amp; Einbeck, J. (2008).  League tables for literacy survey data based on random effect models.
In: Proceedings of the 23rd International Workshop on Statistical Modelling, Utrecht; pp. 402-405.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(IALS_data)
head(IALS_data)
</code></pre>

<hr>
<h2 id='mult.em_1level'>EM algorithm for multivariate one level model with covariates</h2><span id='topic+mult.em_1level'></span>

<h3>Description</h3>

<p>This function is used to obtain the Maximum Likelihood Estimates (MLE) using the EM algorithm for one-level multivariate data.
The estimates enable users to conduct clustering, ranking, and simultaneous dimension reduction on the multivariate dataset.
Furthermore, when covariates are included, the function supports the fitting of multivariate response models, expanding its utility for regression analysis.
The details of the model used in this function can be found in Zhang and Einbeck (2024).
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="mult.em_1level_+3A_data">data</code></td>
<td>
<p>A data set object; we denote the dimension to be <code class="reqn">m</code>.</p>
</td></tr>
<tr><td><code id="mult.em_1level_+3A_v">v</code></td>
<td>
<p>Covariate(s).</p>
</td></tr>
<tr><td><code id="mult.em_1level_+3A_k">K</code></td>
<td>
<p>Number of mixture components, the default is <code>K = 2</code>. Note that when <code>K = 1</code>, <code>z</code> and <code>beta</code> will be 0.</p>
</td></tr>
<tr><td><code id="mult.em_1level_+3A_steps">steps</code></td>
<td>
<p>Number of iterations, the default is <code>steps = 20</code>.</p>
</td></tr>
<tr><td><code id="mult.em_1level_+3A_start">start</code></td>
<td>
<p>Containing parameters involved in the proposed model (<code>p</code>, <code>alpha</code>, <code>z</code>, <code>beta</code>, <code>sigma</code>, <code>gamma</code>) in a list,
the starting values can be obtained through the use of <a href="#topic+start_em">start_em</a>. More details can be found in <a href="#topic+start_em">start_em</a>.</p>
</td></tr>
<tr><td><code id="mult.em_1level_+3A_option">option</code></td>
<td>
<p>Four options for selecting the starting values for the parameters in the model. The default is option = 1.
More details can be found in <a href="#topic+start_em">start_em</a>.</p>
</td></tr>
<tr><td><code id="mult.em_1level_+3A_var_fun">var_fun</code></td>
<td>
<p>There are four types of variance specifications;
<code>var_fun = 1</code>, the same diagonal variance specification to all <code>K</code> components of the mixture;
<code>var_fun = 2</code>, different diagonal variance matrices for different components.
<code>var_fun = 3</code>, the same full (unrestricted) variance for all components.
<code>var_fun = 4</code>, different full (unrestricted) variance matrices for different components.
The default is <code>var_fun = 2</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The estimated parameters in the model <code class="reqn">x_{i} = \alpha + \beta z_k + \Gamma v_i + \varepsilon_i</code> obtained through the EM algorithm at the convergence.
</p>
<table>
<tr><td><code>p</code></td>
<td>
<p>The estimates for the parameter <code class="reqn">\pi_k</code>, which is a vector of length <code class="reqn">K</code>.</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>The estimates for the parameter <code class="reqn">\alpha</code>, which is a vector of length <code class="reqn">m</code>.</p>
</td></tr>
<tr><td><code>z</code></td>
<td>
<p>The estimates for the parameter <code class="reqn">z_k</code>, which is a vector of length <code class="reqn">K</code>.</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>The estimates for the parameter <code class="reqn">\beta</code>, which is a vector of length <code class="reqn">m</code>.</p>
</td></tr>
<tr><td><code>gamma</code></td>
<td>
<p>The estimates for the parameter <code class="reqn">\Gamma</code>, which is a matrix.</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>The estimates for the parameter <code class="reqn">\Sigma_k</code>.
When <code>var_fun = 1</code>, <code class="reqn">\Sigma_k</code> is a diagonal matrix and <code class="reqn">\Sigma_k = \Sigma</code>, and we obtain a vector of the diagonal elements;
When <code>var_fun = 2</code>, <code class="reqn">\Sigma_k</code> is a diagonal matrix, and we obtain <code>K</code> vectors of the diagonal elements;
When <code>var_fun = 3</code>, <code class="reqn">\Sigma_k</code> is a full variance-covariance matrix, <code class="reqn">\Sigma_k = \Sigma</code>, and we obtain a matrix <code class="reqn">\Sigma</code>;
When <code>var_fun = 4</code>, <code class="reqn">\Sigma_k</code> is a full variance-covariance matrix, and we obtain <code>K</code> different matrices <code class="reqn">\Sigma_k</code>.</p>
</td></tr>
<tr><td><code>W</code></td>
<td>
<p>The posterior probability matrix.</p>
</td></tr>
<tr><td><code>loglikelihood</code></td>
<td>
<p>The approximated log-likelihood of the fitted model.</p>
</td></tr>
<tr><td><code>disparity</code></td>
<td>
<p>The disparity (<code>-2logL</code>) of the fitted model.</p>
</td></tr>
<tr><td><code>number_parameters</code></td>
<td>
<p>The number of parameters estimated in the EM algorithm.</p>
</td></tr>
<tr><td><code>AIC</code></td>
<td>
<p>The AIC value (<code>-2logL + 2number_parameters</code>).</p>
</td></tr>
<tr><td><code>BIC</code></td>
<td>
<p>The BIC value (<code>-2logL + number_parameters*log(n)</code>), where n is the number of observations.</p>
</td></tr>
<tr><td><code>starting_values</code></td>
<td>
<p>A list of starting values for parameters used in the EM algorithm.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Zhang, Y. and Einbeck, J. (2024). A Versatile Model for Clustered and Highly Correlated Multivariate Data. J Stat Theory Pract 18(5).<a href="https://doi.org/10.1007/s42519-023-00357-0">doi:10.1007/s42519-023-00357-0</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mult.reg_1level">mult.reg_1level</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##example for data without covariates.
data(faithful)
res &lt;- mult.em_1level(faithful,K=2,steps = 10,var_fun = 1)


## Graph showing the estimated one-dimensional space with cluster centers in red and alpha in green.
x &lt;- res$alpha[1]+res$beta[1]*res$z
y &lt;- res$alpha[2]+res$beta[2]*res$z
plot(faithful,col = 8)
points(x=x[1],y=y[1],type = "p",col = "red",pch = 17)
points(x=x[2],y=y[2],type = "p",col = "red",pch = 17)
points(x=res$alpha[1],y=res$alpha[2],type = "p",col = "darkgreen",pch = 4)
slope &lt;- (y[2]-y[1])/(x[2]-x[1])
intercept &lt;- y[1]-slope*x[1]
abline(intercept, slope, col="red")

##Graph showing the originaldata points being assigned to different
 ##clusters according to the Maximum a posterior (MAP) rule.
index &lt;- apply(res$W, 1, which.max)
faithful_grouped &lt;- cbind(faithful,index)
colors &lt;- c("#FDAE61", "#66BD63")
plot(faithful_grouped[,-3], pch = 1, col = colors[factor(index)])


##example for data with covariates.
data(fetal_covid_data)
set.seed(2)
covid_res &lt;- mult.em_1level(fetal_covid_data[,c(1:5)],v=fetal_covid_data$status_bi, K=3, steps = 20,
             var_fun = 2)
coeffs &lt;- covid_res$gamma
##compare with regression coefficients from fitting individual linear models.
summary(lm( UpperFaceMovements ~ status_bi,data=fetal_covid_data))$coefficients[2,1]
summary(lm( Headmovements ~ status_bi,data=fetal_covid_data))$coefficients[2,1]

</code></pre>

<hr>
<h2 id='mult.em_2level'>EM algorithm for multivariate two level model with covariates</h2><span id='topic+mult.em_2level'></span>

<h3>Description</h3>

<p>This function extends the one-level version <a href="#topic+mult.em_1level">mult.em_1level</a>,
and it is designed to obtain Maximum Likelihood Estimates (MLE) using the EM algorithm for nested (structured) multivariate data,
e.g. multivariate test scores (such as on numeracy, literacy)  of students nested in different classes or schools.
The resulting estimates can be applied for clustering or constructing league tables (ranking of observations).
With the inclusion of covariates, the model allows fitting a multivariate response model for further regression analysis.
Detailed information about the model used in this function can be found in Zhang et al. (2023).
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="mult.em_2level_+3A_data">data</code></td>
<td>
<p>A data set object; we denote the dimension to be <code class="reqn">m</code>.</p>
</td></tr>
<tr><td><code id="mult.em_2level_+3A_v">v</code></td>
<td>
<p>Covariate(s).</p>
</td></tr>
<tr><td><code id="mult.em_2level_+3A_k">K</code></td>
<td>
<p>Number of mixture components, the default is <code>K = 2</code>. Note that when <code>K = 1</code>, <code>z</code> and <code>beta</code> will be 0.</p>
</td></tr>
<tr><td><code id="mult.em_2level_+3A_steps">steps</code></td>
<td>
<p>Number of iterations, the default is <code>steps = 20</code>.</p>
</td></tr>
<tr><td><code id="mult.em_2level_+3A_start">start</code></td>
<td>
<p>Containing parameters involved in the proposed model (<code>p</code>, <code>alpha</code>, <code>z</code>, <code>beta</code>, <code>sigma</code>, <code>gamma</code>) in a list,
the starting values can be obtained through the use of <a href="#topic+start_em">start_em</a>. More details can be found in <a href="#topic+start_em">start_em</a>.</p>
</td></tr>
<tr><td><code id="mult.em_2level_+3A_option">option</code></td>
<td>
<p>Four options for selecting the starting values for the parameters in the model. The default is <code>option = 1</code>.
More details can be found in <a href="#topic+start_em">start_em</a>.</p>
</td></tr>
<tr><td><code id="mult.em_2level_+3A_var_fun">var_fun</code></td>
<td>
<p>There are two types of variance specifications; <code>var_fun = 1</code>, the same diagonal variance specification to all <code>K</code> components of the mixture;
<code>var_fun = 2</code>, different diagonal variance matrices for different components;
The default is <code>var_fun = 2</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The estimated parameters in the model <code class="reqn">x_{ij} = \alpha + \beta z_k + \Gamma v_{ij} + \varepsilon_{ij}</code> obtained through the EM algorithm,
where the upper-level unit is indexed by <code class="reqn">i</code>, and the lower-level unit is indexed by <code class="reqn">j</code>.
</p>
<table>
<tr><td><code>p</code></td>
<td>
<p>The estimates for the parameter <code class="reqn">\pi_k</code>, which is a vector of length <code class="reqn">K</code>.</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>The estimates for the parameter <code class="reqn">\alpha</code>, which is a vector of length <code class="reqn">m</code>.</p>
</td></tr>
<tr><td><code>z</code></td>
<td>
<p>The estimates for the parameter <code class="reqn">z_k</code>, which is a vector of length <code class="reqn">K</code>.</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>The estimates for the parameter <code class="reqn">\beta</code>, which is a vector of length <code class="reqn">m</code>.</p>
</td></tr>
<tr><td><code>gamma</code></td>
<td>
<p>The estimates for the parameter <code class="reqn">\Gamma</code>, which is a matrix.</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>The estimates for the parameter <code class="reqn">\Sigma_k</code>.
When <code>var_fun = 1</code>, <code class="reqn">\Sigma_k</code> is a diagonal matrix and <code class="reqn">\Sigma_k = \Sigma</code>, and we obtain a vector of the diagonal elements;
When <code>var_fun = 2</code>, <code class="reqn">\Sigma_k</code> is a diagonal matrix, and we obtain <code>K</code> vectors of the diagonal elements.
</p>
</td></tr>
<tr><td><code>W</code></td>
<td>
<p>The posterior probability matrix.</p>
</td></tr>
<tr><td><code>loglikelihood</code></td>
<td>
<p>The approximated log-likelihood of the fitted model.</p>
</td></tr>
<tr><td><code>disparity</code></td>
<td>
<p>The disparity (<code>-2logL</code>) of the fitted model.</p>
</td></tr>
<tr><td><code>number_parameters</code></td>
<td>
<p>The number of parameters estimated in the EM algorithm.</p>
</td></tr>
<tr><td><code>AIC</code></td>
<td>
<p>The AIC value (<code>-2logL + 2number_parameters</code>).</p>
</td></tr>
<tr><td><code>starting_values</code></td>
<td>
<p>A list of starting values for parameters used in the EM algorithm.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Zhang, Y., Einbeck, J. and Drikvandi, R. (2023). A multilevel multivariate response model for data with latent structures.
In: Proceedings of the 37th International Workshop on Statistical Modelling, pages 343-348.
Link on RG: <a href="https://www.researchgate.net/publication/375641972_A_multilevel_multivariate_response_model_for_data_with_latent_structures">https://www.researchgate.net/publication/375641972_A_multilevel_multivariate_response_model_for_data_with_latent_structures</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mult.reg_2level">mult.reg_2level</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
##examples for data without covariates.
data(trading_data)
set.seed(49)
trade_res &lt;- mult.em_2level(trading_data, K=4, steps = 10, var_fun = 2)

i_1 &lt;- apply(trade_res$W, 1, which.max)
ind_certain &lt;- rep(as.vector(i_1),c(4,5,5,3,5,5,4,4,5,5,5,5,5,5,5,5,5,5,
3,5,5,5,5,4,4,5,5,5,4,5,4,5,5,5,3,5,5,5,5,5,5,4,5,4))
colors &lt;- c("#FF6600","#66BD63", "lightpink","purple")
plot(trading_data[,-3],pch = 1, col = colors[factor(ind_certain)])
legend("topleft", legend=c("Mass point 1", "Mass point 2","Mass point 3","Mass point 4"),
col=c("#FF6600","purple","#66BD63","lightpink"),pch = 1, cex=0.8)

###The Twins data
library(lme4)
set.seed(26)
twins_res &lt;- mult.em_2level(twins_data[,c(1,2,3)],v=twins_data[,c(4,5,6)],
K=2, steps = 20, var_fun = 2)
coeffs &lt;- twins_res$gamma
##Compare to the estimated coefficients obtained using individual two-level models (lmer()).
summary(lmer(SelfTouchCodable ~ Depression + PSS + Anxiety + (1 | id) ,
data=twins_data, REML = TRUE))$coefficients[2,1]

</code></pre>

<hr>
<h2 id='mult.latent.reg'>Regression and Clustering in Multivariate Response Scenarios</h2><span id='topic+mult.latent.reg'></span>

<h3>Description</h3>

<p>This package implements methodology for the estimation of multivariate response models with random effects on one or two levels;
whereby the (one-dimensional) random effect represents a latent variable approximating the multivariate space of outcomes,
after possible adjustment for covariates. The estimation methodology makes use of a nonparametric maximum likelihood-type approach,
where the random effect distribution is approximated by a discrete mixture, hence allowing the use of the EM algorithm for the estimation of all model parameters.
The method is particularly useful for multivariate,
highly correlated outcome variables with unobserved heterogeneities. Applications include regression with multivariate responses,
as well as multivariate clustering or ranking problems.
The details of the models can be found in Zhang and Einbeck (2024) and Zhang et al. (2023).
The main functions are <code><a href="#topic+mult.em_1level">mult.em_1level</a></code> and <code><a href="#topic+mult.em_2level">mult.em_2level</a></code> for the fitting of the raw models, as well as envelope functions
<code><a href="#topic+mult.reg_1level">mult.reg_1level</a></code> and <code><a href="#topic+mult.reg_2level">mult.reg_2level</a></code> which facilitate iterative runs of the algorithm with a view to
finding optimal starting points, with help by function <code><a href="#topic+start_em">start_em</a></code>.
</p>


<h3>Details</h3>

<p>Package: mult.latent.reg
</p>
<p>Type:    Package
</p>
<p>License: GPL-3
</p>


<h3>Author(s)</h3>

<p>Yingjuan Zhang &lt;yingjuan.zhang@durham.ac.uk&gt;
</p>
<p>Jochen Einbeck
</p>


<h3>References</h3>

<p>Zhang, Y., Einbeck, J., and Drikvandi, R. (2023). A multilevel multivariate response model for data with latent structures.
In: Proceedings of the 37th International Workshop on Statistical Modelling, Dortmund; pages 343-348.
Link on RG: <a href="https://www.researchgate.net/publication/375641972_A_multilevel_multivariate_response_model_for_data_with_latent_structures">https://www.researchgate.net/publication/375641972_A_multilevel_multivariate_response_model_for_data_with_latent_structures</a>.
</p>
<p>Zhang, Y. and Einbeck, J. (2024). A Versatile Model for Clustered and Highly Correlated Multivariate Data. J Stat Theory Pract 18(5).<a href="https://doi.org/10.1007/s42519-023-00357-0">doi:10.1007/s42519-023-00357-0</a>
</p>

<hr>
<h2 id='mult.reg_1level'>Selecting the best results for multivariate one level model</h2><span id='topic+mult.reg_1level'></span>

<h3>Description</h3>

<p>This wrapper function runs multiple times the function <a href="#topic+mult.em_1level">mult.em_1level</a> for fitting Zhang and Einbeck's (2024) multivariate response models with one-level random effect,
and select the best results with the smallest AIC value.
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="mult.reg_1level_+3A_data">data</code></td>
<td>
<p>A data set object; we denote the dimension of a data set to be <code class="reqn">m</code>.</p>
</td></tr>
<tr><td><code id="mult.reg_1level_+3A_v">v</code></td>
<td>
<p>Covariate(s).</p>
</td></tr>
<tr><td><code id="mult.reg_1level_+3A_k">K</code></td>
<td>
<p>Number of mixture components, the default is <code>K = 2</code>.</p>
</td></tr>
<tr><td><code id="mult.reg_1level_+3A_steps">steps</code></td>
<td>
<p>Number of iterations within each <code>num_runs</code>, the default is <code>steps = 20</code>.</p>
</td></tr>
<tr><td><code id="mult.reg_1level_+3A_num_runs">num_runs</code></td>
<td>
<p>Number of function iteration runs, the default is <code>num_runs = 10</code>.</p>
</td></tr>
<tr><td><code id="mult.reg_1level_+3A_start">start</code></td>
<td>
<p>Containing parameters involved in the proposed model (<code>p</code>, <code>alpha</code>, <code>z</code>, <code>beta</code>, <code>sigma</code>, <code>gamma</code>) in a list,
the starting values can be obtained through the use of <a href="#topic+start_em">start_em</a>. More details can be found in <a href="#topic+start_em">start_em</a>.</p>
</td></tr>
<tr><td><code id="mult.reg_1level_+3A_option">option</code></td>
<td>
<p>Four options for selecting the starting values for the parameters in the model. The default is <code>option = 1</code>.
More details can be found in <a href="#topic+start_em">start_em</a>.</p>
</td></tr>
<tr><td><code id="mult.reg_1level_+3A_var_fun">var_fun</code></td>
<td>
<p>There are four types of variance specifications;
<code>var_fun = 1</code>, the same diagonal variance specification to all <code>K</code> components of the mixture;
<code>var_fun = 2</code>, different diagonal variance matrices for different components.
<code>var_fun = 3</code>, the same full (unrestricted) variance for all components.
<code>var_fun = 4</code>, different full (unrestricted) variance matrices for different components.
The default is <code>var_fun = 2</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The best estimated result (with the smallest AIC value) in the model (Zhang and Einbeck, 2024) <code class="reqn">x_{i} = \alpha + \beta z_k + \Gamma v_i + \varepsilon_i</code> obtained through the EM algorithm.
</p>
<table>
<tr><td><code>p</code></td>
<td>
<p>The estimates for the parameter <code class="reqn">\pi_k</code>, which is a vector of length <code class="reqn">K</code>.</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>The estimates for the parameter <code class="reqn">\alpha</code>, which is a vector of length <code class="reqn">m</code>.</p>
</td></tr>
<tr><td><code>z</code></td>
<td>
<p>The estimates for the parameter <code class="reqn">z_k</code>, which is a vector of length <code class="reqn">K</code>.</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>The estimates for the parameter <code class="reqn">\beta</code>, which is a vector of length <code class="reqn">m</code>.</p>
</td></tr>
<tr><td><code>gamma</code></td>
<td>
<p>The estimates for the parameter <code class="reqn">\Gamma</code>, which is a matrix.</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>The estimates for the parameter <code class="reqn">\Sigma_k</code>.
When <code>var_fun = 1</code>, <code class="reqn">\Sigma_k</code> is a diagonal matrix and <code class="reqn">\Sigma_k = \Sigma</code>, and we obtain a vector of the diagonal elements;
When <code>var_fun = 2</code>, <code class="reqn">\Sigma_k</code> is a diagonal matrix, and we obtain <code>K</code> vectors of the diagonal elements;
When <code>var_fun = 3</code>, <code class="reqn">\Sigma_k</code> is a full variance-covariance matrix, <code class="reqn">\Sigma_k = \Sigma</code>, and we obtain a matrix <code class="reqn">\Sigma</code>;
When <code>var_fun = 4</code>, <code class="reqn">\Sigma_k</code> is a full variance-covariance matrix, and we obtain <code>K</code> different matrices <code class="reqn">\Sigma_k</code>.</p>
</td></tr>
<tr><td><code>W</code></td>
<td>
<p>The posterior probability matrix.</p>
</td></tr>
<tr><td><code>loglikelihood</code></td>
<td>
<p>The approximated log-likelihood of the fitted model.</p>
</td></tr>
<tr><td><code>disparity</code></td>
<td>
<p>The disparity (<code>-2logL</code>) of the fitted model.</p>
</td></tr>
<tr><td><code>number_parameters</code></td>
<td>
<p>The number of parameters estimated in the EM algorithm.</p>
</td></tr>
<tr><td><code>AIC</code></td>
<td>
<p>The AIC value (<code>-2logL + 2number_parameters</code>).</p>
</td></tr>
<tr><td><code>BIC</code></td>
<td>
<p>The BIC value (<code>-2logL + number_parameters*log(n)</code>), where n is the number of observations.</p>
</td></tr>
<tr><td><code>aic_data</code></td>
<td>
<p>All AIC values in each run.</p>
</td></tr>
<tr><td><code>Starting_values</code></td>
<td>
<p>Lists of starting values for parameters used in each <code>num_runs</code>.
It allows reproduction of the best result (obtained from <a href="#topic+mult.reg_1level">mult.reg_1level</a>) in a single run
using <a href="#topic+mult.em_1level">mult.em_1level</a> by setting <code>start</code> equal to the list of starting values
that were used to obtain the best result in <a href="#topic+mult.reg_1level">mult.reg_1level</a>.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Zhang, Y. and Einbeck J.  (2024). A Versatile Model for Clustered and Highly Correlated Multivariate Data. J Stat Theory Pract 18(5).<a href="https://doi.org/10.1007/s42519-023-00357-0">doi:10.1007/s42519-023-00357-0</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mult.em_1level">mult.em_1level</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
##run the mult.em_1level() multiple times and select the best results with the smallest AIC value
set.seed(7)
results &lt;- mult.reg_1level(fetal_covid_data[,c(1:5)],v=fetal_covid_data$status_bi,
K=3, num_runs = 5,steps = 20, var_fun = 2, option = 1)
##Reproduce the best result: the best result is the 5th run in the above example.
rep_best_result &lt;- mult.em_1level(fetal_covid_data[,c(1:5)],
v=fetal_covid_data$status_bi,
K=3, steps = 20, var_fun = 2, option = 1,
start = results$Starting_values[[5]])

</code></pre>

<hr>
<h2 id='mult.reg_2level'>Selecting the best results for multivariate two level model</h2><span id='topic+mult.reg_2level'></span>

<h3>Description</h3>

<p>This wrapper function runs multiple times the function <a href="#topic+mult.em_2level">mult.em_2level</a> for fitting Zhang et al.'s (2023) multivariate response models with two-level random effect,
and select the best results with the smallest AIC value.
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="mult.reg_2level_+3A_data">data</code></td>
<td>
<p>A data set object; we denote the dimension of a data set to be <code class="reqn">m</code>.</p>
</td></tr>
<tr><td><code id="mult.reg_2level_+3A_v">v</code></td>
<td>
<p>Covariate(s).</p>
</td></tr>
<tr><td><code id="mult.reg_2level_+3A_k">K</code></td>
<td>
<p>Number of mixture components, the default is <code>K = 2</code>.</p>
</td></tr>
<tr><td><code id="mult.reg_2level_+3A_steps">steps</code></td>
<td>
<p>Number of iterations within each <code>num_runs</code>, the default is <code>steps = 20</code>.</p>
</td></tr>
<tr><td><code id="mult.reg_2level_+3A_num_runs">num_runs</code></td>
<td>
<p>Number of function iteration runs, the default is <code>num_runs = 20</code>.</p>
</td></tr>
<tr><td><code id="mult.reg_2level_+3A_start">start</code></td>
<td>
<p>Containing parameters involved in the proposed model (<code>p</code>, <code>alpha</code>, <code>z</code>, <code>beta</code>, <code>sigma</code>, <code>gamma</code>) in a list,
the starting values can be obtained through the use of <a href="#topic+start_em">start_em</a>. More details can be found in <a href="#topic+start_em">start_em</a>.</p>
</td></tr>
<tr><td><code id="mult.reg_2level_+3A_option">option</code></td>
<td>
<p>Four options for selecting the starting values for the parameters in the model. The default is <code>option = 1</code>.
More details can be found in <a href="#topic+start_em">start_em</a>.</p>
</td></tr>
<tr><td><code id="mult.reg_2level_+3A_var_fun">var_fun</code></td>
<td>
<p>There are two types of variance specifications; <code>var_fun = 1</code>, the same diagonal variance specification to all <code>K</code> components of the mixture;
<code>var_fun = 2</code>, different diagonal variance matrices for different components;
The default is <code>var_fun = 2</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The best estimated result (with the smallest AIC value) in the model <code class="reqn">x_{ij} = \alpha + \beta z_k + \Gamma v_{ij} + \varepsilon_{ij} </code> obtained through the EM algorithm (Zhang et al., 2023),
where the upper-level unit is indexed by <code class="reqn">i</code>, and the lower-level unit is indexed by <code class="reqn">j</code>.
</p>
<table>
<tr><td><code>p</code></td>
<td>
<p>The estimates for the parameter <code class="reqn">\pi_k</code>, which is a vector of length <code class="reqn">K</code>.</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>The estimates for the parameter <code class="reqn">\alpha</code>, which is a vector of length <code class="reqn">m</code>.</p>
</td></tr>
<tr><td><code>z</code></td>
<td>
<p>The estimates for the parameter <code class="reqn">z_k</code>, which is a vector of length <code class="reqn">K</code>.</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>The estimates for the parameter <code class="reqn">\beta</code>, which is a vector of length <code class="reqn">m</code>.</p>
</td></tr>
<tr><td><code>gamma</code></td>
<td>
<p>The estimates for the parameter <code class="reqn">\Gamma</code>, which is a matrix.</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>The estimates for the parameter <code class="reqn">\Sigma_k</code>.
When <code>var_fun = 1</code>, <code class="reqn">\Sigma_k</code> is a diagonal matrix and <code class="reqn">\Sigma_k = \Sigma</code>, and we obtain a vector of the diagonal elements;
When <code>var_fun = 2</code>, <code class="reqn">\Sigma_k</code> is a diagonal matrix, and we obtain <code>K</code> vectors of the diagonal elements.
</p>
</td></tr>
<tr><td><code>W</code></td>
<td>
<p>The posterior probability matrix.</p>
</td></tr>
<tr><td><code>loglikelihood</code></td>
<td>
<p>The approximated log-likelihood of the fitted model.</p>
</td></tr>
<tr><td><code>disparity</code></td>
<td>
<p>The disparity (<code>-2logL</code>) of the fitted model.</p>
</td></tr>
<tr><td><code>number_parameters</code></td>
<td>
<p>The number of parameters estimated in the EM algorithm.</p>
</td></tr>
<tr><td><code>AIC</code></td>
<td>
<p>The AIC value (<code>-2logL + 2number_parameters</code>).</p>
</td></tr>
<tr><td><code>aic_data</code></td>
<td>
<p>All AIC values in each run.</p>
</td></tr>
<tr><td><code>Starting_values</code></td>
<td>
<p>Lists of starting values for parameters used in each <code>num_runs</code>.
It allows reproduction of the best result (obtained from <a href="#topic+mult.reg_2level">mult.reg_2level</a>) in a single run
using <a href="#topic+mult.em_2level">mult.em_2level</a> by setting <code>start</code> equal to the list of starting values
that were used to obtain the best result in <a href="#topic+mult.reg_2level">mult.reg_2level</a>.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Zhang, Y., Einbeck, J. and Drikvandi, R. (2023). A multilevel multivariate response model for data with latent structures.
In: Proceedings of the 37th International Workshop on Statistical Modelling, pages 343-348.
Link on RG: <a href="https://www.researchgate.net/publication/375641972_A_multilevel_multivariate_response_model_for_data_with_latent_structures">https://www.researchgate.net/publication/375641972_A_multilevel_multivariate_response_model_for_data_with_latent_structures</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mult.em_2level">mult.em_2level</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
##run the mult.em_2level() multiple times and select the best results with the smallest AIC value
set.seed(7)
results &lt;- mult.reg_2level(trading_data, K=4, steps = 10, num_runs = 5,
                           var_fun = 2, option = 1)
## Reproduce the best result: the best result is the 2nd run in the above example.
rep_best_result &lt;- mult.em_2level(trading_data, K=4, steps = 10,
var_fun = 2, option = 1,
start = results$Starting_values[[2]])

</code></pre>

<hr>
<h2 id='start_em'>Starting values for parameters</h2><span id='topic+start_em'></span>

<h3>Description</h3>

<p>The starting values for parameters used for the EM algorithm in the functions: <a href="#topic+mult.em_1level">mult.em_1level</a>, <a href="#topic+mult.em_2level">mult.em_2level</a>, <a href="#topic+mult.reg_1level">mult.reg_1level</a> and <a href="#topic+mult.reg_2level">mult.reg_2level</a>.
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="start_em_+3A_data">data</code></td>
<td>
<p>A data set object; we denote the dimension of a data set to be <code class="reqn">m</code>.</p>
</td></tr>
<tr><td><code id="start_em_+3A_v">v</code></td>
<td>
<p>Covariate(s); we denote the dimension of it to be <code class="reqn">r</code>.</p>
</td></tr>
<tr><td><code id="start_em_+3A_k">K</code></td>
<td>
<p>Number of mixture components, the default is <code>K = 2</code>.</p>
</td></tr>
<tr><td><code id="start_em_+3A_steps">steps</code></td>
<td>
<p>Number of iterations. This will only be used when using <code>option = 2</code> for both the 1-level model and the 2-level model.
It should also be used when using <code>option = 3</code> and <code>option = 4</code> for the 1-level model, provided <code>var_fun</code> is set to either 3 or 4;
the default is <code>steps = 20</code>.</p>
</td></tr>
<tr><td><code id="start_em_+3A_option">option</code></td>
<td>
<p>Four options for selecting the starting values for the parameters. The default is <code>option = 1</code>.
When <code>option = 1</code>: <code class="reqn">\pi_k</code> = <code class="reqn">\frac{1}{K}</code>, <code class="reqn">z_k</code> ~ rnorm(<code class="reqn">K</code>, mean = 0, sd=1), <code class="reqn">\alpha</code> = column means, <code class="reqn">\beta</code> = a random row minus alpha,
<code class="reqn">\Gamma</code> = coefficient estimates from separate linear models, <code class="reqn">\Sigma</code> is diagonal matrix where the diagonals take the value of column standard deviations over <code class="reqn">K</code>;
when <code>option = 2</code>: use a short run (<code>steps = 5</code>) of the EM function which uses <code>option = 1</code> with <code>var_fun = 1</code> and use the estimates as the starting values for all the parameters;
when <code>option = 3</code>: the starting value of <code class="reqn">\beta</code> is the first principal component, and the starting values for the rest of the parameters are the same as described when <code>option = 1</code>;
when <code>option = 4</code>: first, take the scores of the first principal component of the data and perform <code class="reqn">K</code>-means, <code class="reqn">\pi_k</code> is the proportion of the clustering assignments, and <code class="reqn">z_k</code> take the values of the <code class="reqn">K</code>-means centers,
and the starting values for the rest of the parameters are the same as described when <code>option = 1</code>.</p>
</td></tr>
<tr><td><code id="start_em_+3A_var_fun">var_fun</code></td>
<td>
<p>The four variance specifications. When <code>var_fun = 1</code>, the same diagonal variance specification to all <code class="reqn">K</code> components of the mixture;
<code>var_fun = 2</code>, different diagonal variance matrices for different components.
<code>var_fun = 3</code>, the same full (unrestricted) variance for all components.
<code>var_fun = 4</code>, different full (unrestricted) variance matrices for different components.
If unspecified, <code>var_fun = 2</code>. Note that for application propose, in two-level models, <code>var_fun</code> can only take values of 1 or 2.</p>
</td></tr>
<tr><td><code id="start_em_+3A_p">p</code></td>
<td>
<p>optional; specifies starting values for <code class="reqn">\pi_k</code>, it is input as a <code class="reqn">K</code>-dimensional vector.</p>
</td></tr>
<tr><td><code id="start_em_+3A_z">z</code></td>
<td>
<p>optional; specifies starting values for <code class="reqn">z_k</code>, it is input as a <code class="reqn">K</code>-dimensional vector.</p>
</td></tr>
<tr><td><code id="start_em_+3A_beta">beta</code></td>
<td>
<p>optional; specifies starting values for <code class="reqn">\beta</code>, it is input as an <code class="reqn">m</code>-dimensional vector.</p>
</td></tr>
<tr><td><code id="start_em_+3A_alpha">alpha</code></td>
<td>
<p>optional; specifies starting values for <code class="reqn">\alpha</code>, it is input as an <code class="reqn">m</code>-dimensional vector.</p>
</td></tr>
<tr><td><code id="start_em_+3A_sigma">sigma</code></td>
<td>
<p>optional; specifies starting values for <code class="reqn">\Sigma_k</code> (<code class="reqn">\Sigma</code>, when <code>var_fun = 1</code> or <code>var_fun = 3</code>), when <code>var_fun = 1</code>, it is input as an <code class="reqn">m</code>-dimensional vector,
when <code>var_fun = 2</code>, it is input as a list (of length <code class="reqn">K</code>) of <code class="reqn">m</code>-dimensional vectors, when <code>var_fun = 3</code>, it is input as an <code class="reqn">m \times m</code> matrix,
when <code>var_fun = 4</code>, it is input as a list (of length <code class="reqn">K</code>) of <code class="reqn">m \times m</code> matrices.</p>
</td></tr>
<tr><td><code id="start_em_+3A_gamma">gamma</code></td>
<td>
<p>optional; the coefficients for the covariates; specifies starting values for <code class="reqn">\Gamma</code>, it is input as an <code class="reqn">m \times r</code> matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The starting values (in a list) for parameters in the models <code class="reqn">x_{i} = \alpha + \beta z_k + \Gamma v_i + \varepsilon_i</code> (Zhang and Einbeck, 2024) and
<code class="reqn">x_{ij} = \alpha + \beta z_k + \Gamma v_{ij} + \varepsilon_{ij}</code> (Zhang et al., 2023) used in the four fucntions: <a href="#topic+mult.em_1level">mult.em_1level</a>, <a href="#topic+mult.em_2level">mult.em_2level</a>, <a href="#topic+mult.reg_1level">mult.reg_1level</a> and <a href="#topic+mult.reg_2level">mult.reg_2level</a>.
</p>
<table>
<tr><td><code>p</code></td>
<td>
<p>The starting value for the parameter <code class="reqn">\pi_k</code>, which is a vector of length <code class="reqn">K</code>.</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>The starting value for the parameter <code class="reqn">\alpha</code>, which is a vector of length <code class="reqn">m</code>.</p>
</td></tr>
<tr><td><code>z</code></td>
<td>
<p>The starting value for the parameter <code class="reqn">z_k</code>, which is a vector of length <code class="reqn">K</code>.</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>The starting value for the parameter <code class="reqn">\beta</code>, which is a vector of length <code class="reqn">m</code>.</p>
</td></tr>
<tr><td><code>gamma</code></td>
<td>
<p>The starting value for the parameter <code class="reqn">\Gamma</code>, which is a matrix.</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>The starting value for the parameter <code class="reqn">\Sigma_k</code>.
When <code>var_fun = 1</code>, <code class="reqn">\Sigma_k</code> is a diagonal matrix and <code class="reqn">\Sigma_k = \Sigma</code>, and we obtain a vector of the diagonal elements;
When <code>var_fun = 2</code>, <code class="reqn">\Sigma_k</code> is a diagonal matrix, and we obtain <code>K</code> vectors of the diagonal elements;
When <code>var_fun = 3</code>, <code class="reqn">\Sigma_k</code> is a full variance-covariance matrix, <code class="reqn">\Sigma_k = \Sigma</code>, and we obtain a matrix <code class="reqn">\Sigma</code>;
When <code>var_fun = 4</code>, <code class="reqn">\Sigma_k</code> is a full variance-covariance matrix, and we obtain <code>K</code> different matrices <code class="reqn">\Sigma_k</code>.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Zhang, Y., Einbeck, J. and Drikvandi, R. (2023). A multilevel multivariate response model for data with latent structures.
In: Proceedings of the 37th International Workshop on Statistical Modelling, pages 343-348.
Link on RG: <a href="https://www.researchgate.net/publication/375641972_A_multilevel_multivariate_response_model_for_data_with_latent_structures">https://www.researchgate.net/publication/375641972_A_multilevel_multivariate_response_model_for_data_with_latent_structures</a>.
</p>
<p>Zhang, Y. and Einbeck, J. (2024). A Versatile Model for Clustered and Highly Correlated Multivariate Data. J Stat Theory Pract 18(5).<a href="https://doi.org/10.1007/s42519-023-00357-0">doi:10.1007/s42519-023-00357-0</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##example for the faithful data.
data(faithful)
start &lt;- start_em(faithful, option = 1)
</code></pre>

<hr>
<h2 id='trading_data'>A set of import and export data in 44 countries.</h2><span id='topic+trading_data'></span>

<h3>Description</h3>

<p>The variables are given as the percentage of imports and exports in relation to the overall GDP.
The data set comprises data from 44 countries (for our analysis),
we specifically selected the time period between 2018 and 2022.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(trading_data)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>"data.frame"</code>
</p>

<dl>
<dt>import</dt><dd><p>The fetus from the same twins share the same id number.</p>
</dd>
<dt>export</dt><dd><p>frequency of self-touch for each fetus.</p>
</dd>
<dt>country</dt><dd><p>frequency of twin-to-twin for each fetus.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Trade in Goods and Services. <a href="https://data.oecd.org/trade/trade-in-goods-and-services.htm">https://data.oecd.org/trade/trade-in-goods-and-services.htm</a>. Accessed on 2023-05-29.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(trading_data)
head(trading_data)
</code></pre>

<hr>
<h2 id='twins_data'>A set of fetal movements data in twins and singletons.</h2><span id='topic+twins_data'></span>

<h3>Description</h3>

<p>This data was collected for research on the effects of maternal mental health on prenatal movements in twins and singletons (Reissland et al., 2021).
There are two touch movement types of the fetus recorded: self-touch and twin-to-twin touch,
and the mothers’ mental health status was collected on three variables: depression, perceived stress scale and stress.
There are 14 pairs of twins, 11 of the mothers were available for one scan and 3 of them were available for two scans,
i.e. in total there are 34 observations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(twins_data)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>"data.frame"</code>
</p>

<dl>
<dt>id</dt><dd><p>The fetus from the same twins share the same id number.</p>
</dd>
<dt>SelfTouchCodable</dt><dd><p>frequency of self-touch for each fetus.</p>
</dd>
<dt>OtherTouchCodable</dt><dd><p>frequency of twin-to-twin for each fetus.</p>
</dd>
<dt>Depression</dt><dd><p>Depression scale of the mothers.</p>
</dd>
<dt>PSS</dt><dd><p>Perceived Stress Scale of the mothers.</p>
</dd>
<dt>Anxiety</dt><dd><p>Hospital Anxiety of the mothers.</p>
</dd>
</dl>



<h3>References</h3>

<p>Reissland, N., Einbeck, J., Wood, R., and Lane, A. (2021).
Effects of maternal mental health on prenatal movement profiles in twins and singletons.
Acta Paediatrica, 110(9):2553–2558.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(twins_data)
head(twins_data)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
