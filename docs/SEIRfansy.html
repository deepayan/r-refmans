<!DOCTYPE html><html><head><title>Help for package SEIRfansy</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SEIRfansy}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#covid19'><p>COVID-19 Cases Time Series in India</p></a></li>
<li><a href='#plot.SEIRfansy'><p>Plot an SEIRfansy Fit Object</p></a></li>
<li><a href='#plot.SEIRfansyPredict'><p>Plot an SEIRfansyPredict Fit Object</p></a></li>
<li><a href='#SEIRfansy'><p>Estimate SEIRfansy Model Parameters</p></a></li>
<li><a href='#SEIRfansy.predict'><p>Prediction for SEIRfansy Model</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Extended Susceptible-Exposed-Infected-Recovery Model</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Extended Susceptible-Exposed-Infected-Recovery Model for 
    handling high false negative rate and symptom based administration of 
    diagnostic tests. &lt;<a href="https://doi.org/10.1101%2F2020.09.24.20200238">doi:10.1101/2020.09.24.20200238</a>&gt;.</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Michael Kleinsasser &lt;biostat-cran-manager@umich.edu&gt;</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Biarch:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, arm, pbapply, DescTools, patchwork, ggpubr, ggplot2,
knitr, rlang, magrittr, scales</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/umich-biostatistics/SEIRfansy">https://github.com/umich-biostatistics/SEIRfansy</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/umich-biostatistics/SEIRfansy/issues">https://github.com/umich-biostatistics/SEIRfansy/issues</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-09-22 14:19:55 UTC; mkleinsa</td>
</tr>
<tr>
<td>Author:</td>
<td>Ritwik Bhaduri [aut],
  Ritoban Kundu [aut],
  Soumik Purkayastha [aut],
  Lauren Beesley [aut],
  Bhramar Mukherjee [aut],
  Michael Kleinsasser [cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-09-27 16:30:10 UTC</td>
</tr>
</table>
<hr>
<h2 id='covid19'>COVID-19 Cases Time Series in India</h2><span id='topic+covid19'></span>

<h3>Description</h3>

<p>Contains dailies and totals of cases, recoveries, and deaths from the COVID-19
outbreak in India from January 30 to September 21 of 2020.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>covid19
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 236 rows and 7 columns.
</p>

<dl>
<dt>Date</dt><dd><p>Date as a character string</p>
</dd>
<dt>Daily.Confirmed</dt><dd><p>Daily confirmed cases as an integer vector</p>
</dd>
<dt>Total.Confirmed</dt><dd><p>Total confirmed cases upto current date as an integer vector</p>
</dd>
<dt>Daily.Recovered</dt><dd><p>Daily recovered cases an an integer vector</p>
</dd>
<dt>Total.Recovered</dt><dd><p>Total confirmed cases upto current date as an integer vector</p>
</dd>
<dt>Daily.Deceased</dt><dd><p>Daily deceased cases as an integer vector</p>
</dd>
<dt>Total.Deceased</dt><dd><p>Total deceased cases upto current date as an integer vector</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>covid19
head(covid19)
tail(covid19)
</code></pre>

<hr>
<h2 id='plot.SEIRfansy'>Plot an SEIRfansy Fit Object</h2><span id='topic+plot.SEIRfansy'></span>

<h3>Description</h3>

<p>This is a convenient wrapper for output that is already included in the
SEIRfansy output in the plots element. Options are trace or boxplot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'SEIRfansy'
plot(x, type, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.SEIRfansy_+3A_x">x</code></td>
<td>
<p>SEIRfansy object to plot</p>
</td></tr>
<tr><td><code id="plot.SEIRfansy_+3A_type">type</code></td>
<td>
<p>type of plot to render. Options are &quot;trace&quot; or &quot;boxplot&quot;.</p>
</td></tr>
<tr><td><code id="plot.SEIRfansy_+3A_...">...</code></td>
<td>
<p>not currently used</p>
</td></tr>
</table>

<hr>
<h2 id='plot.SEIRfansyPredict'>Plot an SEIRfansyPredict Fit Object</h2><span id='topic+plot.SEIRfansyPredict'></span>

<h3>Description</h3>

<p>This is a convenient wrapper for output that is already included in the
predict output in the plots element. Options are panel and cases.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'SEIRfansyPredict'
plot(x, type, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.SEIRfansyPredict_+3A_x">x</code></td>
<td>
<p>SEIRfansyPredict object to plot</p>
</td></tr>
<tr><td><code id="plot.SEIRfansyPredict_+3A_type">type</code></td>
<td>
<p>type of plot to render. Options are &quot;trace&quot;, &quot;boxplot&quot;, &quot;panel&quot;, or &quot;cases&quot;.</p>
</td></tr>
<tr><td><code id="plot.SEIRfansyPredict_+3A_...">...</code></td>
<td>
<p>not currently used</p>
</td></tr>
</table>

<hr>
<h2 id='SEIRfansy'>Estimate SEIRfansy Model Parameters</h2><span id='topic+SEIRfansy'></span>

<h3>Description</h3>

<p>This function is used to estimate the different parameters of interest like
the time varying transmission rates, proportion of reported cases, and the
basic reproduction rates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SEIRfansy(
  data,
  data_init,
  N,
  init_pars = NULL,
  niter = 1e+05,
  BurnIn = 1e+05,
  model = "Multinomial",
  plot = TRUE,
  period_start,
  auto.initialize = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SEIRfansy_+3A_data">data</code></td>
<td>
<p>(mandatory): If the model is Multinomial, then the data matrix
should contain the 3 columns Confirmed, Recovered, and Death. If the model
is Poisson or Binomial, then the data should contain only the column Confirmed.
Please ensure that the names of the columns are exactly as stated above.</p>
</td></tr>
<tr><td><code id="SEIRfansy_+3A_data_init">data_init</code></td>
<td>
<p>(mandatory): These are the initial data values
provided by the user as a numeric vector of length six. The entries should be
the Total Confirmed, Total Recovered, Total Death, Daily Confirmed,
Daily Recovered, and Daily Death for the Starting Date. Note: If the starting total
confirmed is 0, please replace it by 1.</p>
</td></tr>
<tr><td><code id="SEIRfansy_+3A_n">N</code></td>
<td>
<p>(mandatory): The population size.</p>
</td></tr>
<tr><td><code id="SEIRfansy_+3A_init_pars">init_pars</code></td>
<td>
<p>NULL(default): If not equal to NULL, then the user can give a user input initial
parameters which should consist of the initial values of the time varying beta,
proportion of testing for the different periods.</p>
</td></tr>
<tr><td><code id="SEIRfansy_+3A_niter">niter</code></td>
<td>
<p>1e5 (default): Number of iterations for the MCMC Metropolis Hastings
algorithm.</p>
</td></tr>
<tr><td><code id="SEIRfansy_+3A_burnin">BurnIn</code></td>
<td>
<p>5e4 (default): This is the number of burn-in iterations for the MCMC algorithm</p>
</td></tr>
<tr><td><code id="SEIRfansy_+3A_model">model</code></td>
<td>
<p>&quot;Multinomial&quot; (default): This is the likelihood function that will
be used. There are three options available: &quot;Multinomial&quot;, &quot;Poisson&quot;, or &quot;Binomial&quot;.</p>
</td></tr>
<tr><td><code id="SEIRfansy_+3A_plot">plot</code></td>
<td>
<p>TRUE (default): This will give the box plot for the basic reproduction
number for the different periods.</p>
</td></tr>
<tr><td><code id="SEIRfansy_+3A_period_start">period_start</code></td>
<td>
<p>The total time period is divided into small periods depending
on the lock down measures imposed by the government. So this is a numeric vector
consisting of the start dates for the different time periods.</p>
</td></tr>
<tr><td><code id="SEIRfansy_+3A_auto.initialize">auto.initialize</code></td>
<td>
<p>TRUE (default): This is the option for using a mle
based initial parameter.</p>
</td></tr>
<tr><td><code id="SEIRfansy_+3A_...">...</code></td>
<td>
<p>arguments passed to the function model_initializeR and model_plotR
which is used for initializing the parameters. The parameters are
described below:
</p>

<ul>
<li><p>step_pars: init_pars/500 (default): It is the variance
of the proposal distribution for the Metropolis Hastings Algorithm
which is assumed to be a Random Walk.
</p>
</li>
<li><p>alpha_p: 0.5 (default): It is defined as the ratio
of rate of spread of infection by tested positive patients to
that by false negatives. We have taken $alpha_p &lt; 1$ as patients
who are tested positive are subjected to quarantine where the
chance of spreading the disease is less than that of false
negative patients who are mostly unaware of their infectious
nature. So, false negative individuals continue to spread the
disease freely at a higher rate than tested positive individuals.
</p>
</li>
<li><p>alpha_u: 0.7 (default): It is defined as the  scaling
factor for the rate of spread of infection by untested individuals.
$alpha_u$ is assumed to be &lt; 1 as U mostly consists of
asymptomatic or mildly symptomatic cases who are known to spread
the disease at a much lower rate than those with higher levels
of symptoms.
</p>
</li>
<li><p>beta_1: 0.6 (default): It is the scaling factor for
rate of recovery for untested individuals. $beta_1$ is
assumed to be less than 1. The condition of Untested individuals
is not as severe as they consist of mostly asymptomatic people.
So, they are assumed to recover faster than the Current
Positive ones.
</p>
</li>
<li><p>beta_2: 0.7 (default): It is the inverse of the
scaling factor for rate of recovery for false negative individuals.
$beta_2$ is assumed to be less than 1. It is assumed that the
recovery rate is slower than the detected ones for the False
Negative ones because they are not getting any hospital treatments.
</p>
</li>
<li><p>delta_1: 0.3 (default): It is the scaling factor for
death rate for undetected individuals. $delta_1$ is assumed
to be less than 1. Similarly  for the Untested ones, the death
rate is taken to be lesser because they are mostly asymptomatic.
So, their probability of dying is much lower.
</p>
</li>
<li><p>delta_2: 0.7 (default): It is the inverse of  the
scaling factor for death rate for false negative individuals.
$delta_2$ is assumed to be less than 1. Same as before, the
death rate for False Negative ones are assumed to be higher than
the Current detected Positive as they are not receiving proper
treatment.
</p>
</li>
<li><p>lambda: 1 / (66.26 * 365) (default): Natural birth
rate. The value given here as the default value is the world's
common birth rate.
</p>
</li>
<li><p>mu: 1 / (66.26 * 365) (default): Natural death rates.
This is assumed to be equal with natural birth rate for the sake
of simplicity.
</p>
</li>
<li><p>D_d: 17.8 (default): Mean days until death for positive
individuals.
</p>
</li>
<li><p>D_e: 5.2 (default): Incubation period.
</p>
</li>
<li><p>Dr: 17.8 (default): Mean days until recovery for positive
individuals.
</p>
</li>
<li><p>f: 0.15 (default): False negative probability of
RT-PCR test.
</p>
</li>
<li><p>mCFR: NULL (It is calculated from the data by default)
It is defined as the ratio of the total reported deceased cases
and the total removed cases until that day.
</p>
</li>
<li><p>init.exposed.ratio: 3 (default): This is the scaling
factor for the calculation of the initial number of exposed people
from the sum of the initial number of unreported, reported people.
</p>
</li>
<li><p>init.confirmed.ratio: 0.15 (default): This is the initial
value of the probability of being tested.
</p>
</li>
<li><p>opt_num: 100 (default): The number of times an user
wants to run the mle optimization before deciding on the best
initial parameter.
</p>
</li>
<li><p>trace_plot.common_axis: FALSE (default): This will give
the trace plot for the convergence of the MCMC estimated time
varying parameters.
</p>
</li>
<li><p>save plot: TRUE (default): It is the option for saving
the plots in the directory folder.
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with class &quot;SEIRfansy&quot;, which contains the items described
below:
</p>

<ul>
<li><p>mcmc_pars: a matrix of the mcmc draws for the parameters
</p>
</li>
<li><p>plots: a list of ggplot objects
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)
train = covid19[which(covid19$Date == "01 April "):which(covid19$Date == "30 June "),]
test = covid19[which(covid19$Date == "01 July "):which(covid19$Date == "31 July "),]

train_multinom = 
 train %&gt;% 
   rename(Confirmed = Daily.Confirmed, 
          Recovered = Daily.Recovered,
          Deceased = Daily.Deceased) %&gt;%
   dplyr::select(Confirmed, Recovered, Deceased)
 
 test_multinom = 
   test %&gt;% 
   rename(Confirmed = Daily.Confirmed, 
          Recovered = Daily.Recovered,
          Deceased = Daily.Deceased) %&gt;%
   dplyr::select(Confirmed, Recovered, Deceased)
 
N = 1341e6 # population size of India
data_initial = c(2059, 169, 58, 424, 9, 11)
pars_start = c(c(1,0.8,0.6,0.4,0.2), c(0.2,0.2,0.2,0.25,0.2))
phases = c(1,15,34,48,62)

cov19est = SEIRfansy(data = train_multinom, init_pars = pars_start, 
                     data_init = data_initial, niter = 1e3, BurnIn = 1e2, 
                     model = "Multinomial", N = N, lambda = 1/(69.416 * 365), 
                     mu = 1/(69.416 * 365), period_start = phases, opt_num = 1, 
                     auto.initialize = TRUE, f = 0.15)

names(cov19est)
class(cov19est$mcmc_pars)
names(cov19est$plots)

plot(cov19est, type = "trace")
plot(cov19est, type = "boxplot")









# quick test for package check
# not for use outside CRAN check()
cov19est = SEIRfansy(data = train_multinom, init_pars = pars_start, 
                     data_init = data_initial, niter = 33, BurnIn = 18, 
                     model = "Multinomial", N = N, lambda = 1/(69.416 * 365), 
                     mu = 1/(69.416 * 365), period_start = phases, opt_num = 1, 
                     auto.initialize = TRUE, f = 0.15, plot = FALSE, system_test = NULL)


</code></pre>

<hr>
<h2 id='SEIRfansy.predict'>Prediction for SEIRfansy Model</h2><span id='topic+SEIRfansy.predict'></span>

<h3>Description</h3>

<p>This function is used to predict the total reported as well as unreported case
counts, total recovered, and total deaths.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SEIRfansy.predict(
  data = NULL,
  data_init,
  init_pars = NULL,
  N,
  plot = TRUE,
  T_predict,
  period_start,
  estimate = TRUE,
  pars = NULL,
  data_test = NULL,
  auto.initialize = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SEIRfansy.predict_+3A_data">data</code></td>
<td>
<p>(mandatory): input the training data set. If the model is
Multinomial then the data matrix should contain the 3 columns Confirmed,
Recovered, and Death. If the model is Poisson or Binomial, then the data
should contain only the column Confirmed. Note that the names of
the columns must be the same as stated above.</p>
</td></tr>
<tr><td><code id="SEIRfansy.predict_+3A_data_init">data_init</code></td>
<td>
<p>(mandatory): These are the initial data values
provided by the user as a numeric vector of length six. The entries should be
the Total Confirmed, Total Recovered, Total Death, Daily Confirmed,
Daily Recovered, and Daily Death for the Starting Date. Note: If the starting total
confirmed is 0, please replace it by 1.</p>
</td></tr>
<tr><td><code id="SEIRfansy.predict_+3A_init_pars">init_pars</code></td>
<td>
<p>NULL (default): If not equal to NULL, then the user can give a user input initial
parameters which should consist of the initial values of the time varying beta,
proportion of testing for the different periods.</p>
</td></tr>
<tr><td><code id="SEIRfansy.predict_+3A_n">N</code></td>
<td>
<p>(mandatory): The population size.</p>
</td></tr>
<tr><td><code id="SEIRfansy.predict_+3A_plot">plot</code></td>
<td>
<p>TRUE (default): If estimate = FALSE, this will give two plots. One is
the panel plot for total cases, total recovered, total death, and total
confirmed if the model is Multinomial. Otherwise it will give only a plot for total
confirmed when the model is binomial or Poisson, and the second plot is the plot
of untested, false negative, and reported cases. And when estimate = TRUE,
it will give two other plots along with the previous two plots. One is the
box plot for basic reproduction number and the other one is the trace plot for
the convergence of the MCMC parameters.</p>
</td></tr>
<tr><td><code id="SEIRfansy.predict_+3A_t_predict">T_predict</code></td>
<td>
<p>It is the number of days that we want to predict after the train
period. The value of T_predict should be greater than or equal to the number
of rows of <code>data_test</code>.</p>
</td></tr>
<tr><td><code id="SEIRfansy.predict_+3A_period_start">period_start</code></td>
<td>
<p>The total time period is divided into small periods depending
on the lock down measures imposed by the government. So this is a numeric vector consisting
of the start dates for the different time periods.</p>
</td></tr>
<tr><td><code id="SEIRfansy.predict_+3A_estimate">estimate</code></td>
<td>
<p>TRUE (default): If it is TRUE then it will run the MCMC algorithm
to estimate the parameters. If it is FALSE, then the user needs to give
input the parameter values in the pars argument.</p>
</td></tr>
<tr><td><code id="SEIRfansy.predict_+3A_pars">pars</code></td>
<td>
<p>= NULL (default): If estimate = FALSE, then the user needs to
input the parameter estimates.</p>
</td></tr>
<tr><td><code id="SEIRfansy.predict_+3A_data_test">data_test</code></td>
<td>
<p>NULL (default): Otherwise need to give the
test data for comparing with the model estimates.</p>
</td></tr>
<tr><td><code id="SEIRfansy.predict_+3A_auto.initialize">auto.initialize</code></td>
<td>
<p>TRUE (default): This is the option for using a mle
based initial parameter.</p>
</td></tr>
<tr><td><code id="SEIRfansy.predict_+3A_...">...</code></td>
<td>
<p>arguments passed to the function SEIRfansy, model_initializeR
and model_plotR which are used for initializing the parameters. The
parameters are described below:
</p>

<ul>
<li><p>niter: 1e5 (default): Number of iteration for the MCMC
metropolis hasting algorithm.
</p>
</li>
<li><p>BurnIn: 5e4 (default) This is the Burn-In Period for
the MCMC algorithm.
</p>
</li>
<li><p>model: &quot;Multinomial&quot; (default): This is the likelihood
function that will be used. There are three options available
including &quot;Multinomial&quot;, &quot;Poisson&quot;, and &quot;Binomial&quot;.
</p>
</li>
<li><p>alpha_p: 0.5 (default): It is defined as the ratio of
rate of spread of infection by tested positive patients to that
by false negatives. We have taken $alpha_p &lt; 1$ as patients
who are tested positive are subjected to quarantine where the
chance of spreading the disease is less than that of false
negative patients who are mostly unaware of their infectious nature.
So, false negative individuals continue to spread the disease
freely at a higher rate than tested positive individuals.
</p>
</li>
<li><p>alpha_u: 0.7 (default): It is defined as the  scaling
factor for the rate of spread of infection by untested individuals.
$alpha_u$ is assumed to be &lt; 1 as U mostly consists of
asymptomatic or mildly symptomatic cases who are known to spread
the disease at a much lower rate than those with higher levels
of symptoms.
</p>
</li>
<li><p>beta_1: 0.6 (default): It is the scaling factor for
rate of recovery  for untested individuals. $beta_1$ is
assumed to be less than 1. The condition of Untested individuals
is not so severe as they consist of mostly asymptomatic people.
So, they are assumed to recover faster than the Current Positive ones.
</p>
</li>
<li><p>beta_2: 0.7 (default): It is the inverse of the scaling
factor for rate of recovery for false negative individuals.
$beta_2$ is assumed to be less than 1. It is assumed that the
recovery rate is slower than the detected ones for the False
Negative ones because they are not getting any hospital
treatment.
</p>
</li>
<li><p>delta_1: 0.3 (default): It is the scaling factor for
death rate for undetected individuals. $delta_1$ is assumed
to be less than 1. Similarly, for the Untested ones, the death
rate is taken to be lesser because they are mostly asymptomatic.
So, their probability of dying is much less.
</p>
</li>
<li><p>delta_2: 0.7 (default): It is the inverse of the scaling
factor for death rate for false negative individuals. $delta_2$
is assumed to be less than 1. Same as before, the death rate for
False Negative ones are assumed to be higher than the Current
detected Positive as they are not receiving proper treatment.
</p>
</li>
<li><p>lambda: 1 / (66.26 * 365) (default): Natural birth rate.
The value given here as the default value is the world's common
birth  rate.
</p>
</li>
<li><p>mu: 1 / (66.26 * 365) (default): Natural death rates.
This is assumed to be equal with natural birth rate for the
sake of simplicity.
</p>
</li>
<li><p>D_e: 5.2 (default): Incubation period.
</p>
</li>
<li><p>Dr: 17.8 (default): Mean days until recovery for positive
individuals.
</p>
</li>
<li><p>f: 0.15 (default): False negative probability of RT-PCR
test.
</p>
</li>
<li><p>mCFR: NULL (default): (It is calculated from the data by default)
It is defined as the ratio of the total reported deceased cases
and the total removed cases until that day.
</p>
</li>
<li><p>init.exposed.ratio: 3 (default): This is the scaling
factor for the calculation of the initial number of exposed
people from the sum of the initial number of unreported,
reported people.
</p>
</li>
<li><p>init.confirmed.ratio: 0.15 (default): This is the initial
value of the probability of being tested.
</p>
</li>
<li><p>opt_num: 100 (default): The number of times an user
wants to run the mle optimization before deciding on the best
initial parameter.
</p>
</li>
<li><p>trace_plot.common_axis: FALSE (default): This will give
the trace plot for the convergence of the MCMC estimated time
varying parameters.
</p>
</li>
<li><p>save plot: TRUE (default): It is the option for saving
the plots in the directory folder.
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with class &quot;SEIRfansyPredict&quot;, which contains the items described
below:
</p>

<ul>
<li><p>mcmc_pars: a matrix of the mcmc draws for the parameters
</p>
</li>
<li><p>plots: a list of ggplot objects
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)
train = covid19[which(covid19$Date == "01 April "):which(covid19$Date == "30 June "),]
test = covid19[which(covid19$Date == "01 July "):which(covid19$Date == "31 July "),]

train_multinom = 
 train %&gt;% 
   rename(Confirmed = Daily.Confirmed, 
          Recovered = Daily.Recovered,
          Deceased = Daily.Deceased) %&gt;%
   dplyr::select(Confirmed, Recovered, Deceased)
 
 test_multinom = 
   test %&gt;% 
   rename(Confirmed = Daily.Confirmed, 
          Recovered = Daily.Recovered,
          Deceased = Daily.Deceased) %&gt;%
   dplyr::select(Confirmed, Recovered, Deceased)
 
N = 1341e6 # population size of India
data_initial = c(2059, 169, 58, 424, 9, 11)
pars_start = c(c(1,0.8,0.6,0.4,0.2), c(0.2,0.2,0.2,0.25,0.2))
phases = c(1,15,34,48,62)
 
 cov19pred = SEIRfansy.predict(data = train_multinom, init_pars = pars_start, 
                               data_init = data_initial, T_predict = 60, niter = 1e3, 
                               BurnIn = 1e2, data_test = test_multinom, model = "Multinomial", 
                               N = N, lambda = 1/(69.416 * 365), mu = 1/(69.416 * 365), 
                               period_start = phases, opt_num = 1, 
                               auto.initialize = TRUE, f = 0.15)

names(cov19pred)
class(cov19pred$prediction)
class(cov19pred$mcmc_pars)
names(cov19pred$plots)

plot(cov19pred, type = "trace")
plot(cov19pred, type = "boxplot")
plot(cov19pred, type = "panel")
plot(cov19pred, type = "cases")








# quick test for package check
# not for use outside CRAN check()
cov19est = SEIRfansy(data = train_multinom, init_pars = pars_start, 
                     data_init = data_initial, niter = 33, BurnIn = 18, 
                     model = "Multinomial", N = N, lambda = 1/(69.416 * 365), 
                     mu = 1/(69.416 * 365), period_start = phases, opt_num = 1, 
                     auto.initialize = TRUE, f = 0.15, plot = FALSE, system_test = NULL)


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
