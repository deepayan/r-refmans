<!DOCTYPE html><html lang="en"><head><title>Help for package RODBC</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {RODBC}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#RODBC-package'><p>ODBC Database Connectivity</p></a></li>
<li><a href='#odbc-low-level'><p>Low-level ODBC functions</p></a></li>
<li><a href='#odbcClose'><p>ODBC Close Connections</p></a></li>
<li><a href='#odbcConnect'><p>ODBC Open Connections</p></a></li>
<li><a href='#odbcDataSources'><p>List ODBC Data Sources</p></a></li>
<li><a href='#odbcGetInfo'><p>Request Information on an ODBC Connection</p></a></li>
<li><a href='#odbcSetAutoCommit'><p>ODBC Set Auto-Commit Mode</p></a></li>
<li><a href='#RODBC-internal'><p>Internal RODBC functions</p></a></li>
<li><a href='#setSqlTypeInfo'><p>Specify or Query a Mapping of R Types to DBMS Types</p></a></li>
<li><a href='#sqlColumns'><p>Query Column Structure in ODBC Tables</p></a></li>
<li><a href='#sqlCopy'><p>ODBC Copy</p></a></li>
<li><a href='#sqlDrop'><p>Deletion Operations on Tables in ODBC databases</p></a></li>
<li><a href='#sqlFetch'><p>Reading Tables from ODBC Databases</p></a></li>
<li><a href='#sqlQuery'><p>Query an ODBC Database</p></a></li>
<li><a href='#sqlSave'><p>Write a Data Frame to a Table in an ODBC Database</p></a></li>
<li><a href='#sqlTables'><p>List Tables on an ODBC Connection</p></a></li>
<li><a href='#sqlTypeInfo'><p>Request Information about Data Types in an ODBC Database</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>1.3-26</td>
</tr>
<tr>
<td>Revision:</td>
<td>$Rev: 3674 $</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-12-12</td>
</tr>
<tr>
<td>Title:</td>
<td>ODBC Database Access</td>
</tr>
<tr>
<td>Description:</td>
<td>An ODBC database interface.</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>An ODBC3 driver manager and drivers.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Biarch:</td>
<td>yes</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-12-12 11:56:03 UTC; ripley</td>
</tr>
<tr>
<td>Author:</td>
<td>Brian Ripley [aut, cre],
  Michael Lapsley [aut] (1999 to Oct 2002)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Brian Ripley &lt;Brian.Ripley@R-project.org&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-12-12 13:47:23 UTC</td>
</tr>
</table>
<hr>
<h2 id='RODBC-package'>ODBC Database Connectivity</h2><span id='topic+RODBC'></span><span id='topic+RODBC-package'></span>

<h3>Description</h3>

<p>Package <span class="pkg">RODBC</span> implements ODBC database connectivity.
</p>
<p>See the package manual for details of installation and use.  (This
will show up as a vignette, and can be accessed <em>via</em>
<code>RShowDoc("RODBC", package="RODBC")</code>.)
</p>


<h3>Details</h3>

<p>Two groups of functions are provided.  The mainly internal
<code>odbc*</code> commands implement low-level access to the ODBC functions
of similar name.  The <code>sql*</code> functions operate at a higher level
to read, save, copy and manipulate data between data frames and SQL
tables.  Many connections can be open at once to any combination of
DSN/hosts.
</p>


<h3>Author(s)</h3>

<p>Michael Lapsley and Brian Ripley
</p>

<hr>
<h2 id='odbc-low-level'>Low-level ODBC functions</h2><span id='topic+odbcQuery'></span><span id='topic+odbcTables'></span><span id='topic+odbcFetchRows'></span><span id='topic+odbcGetErrMsg'></span><span id='topic+odbcClearError'></span>

<h3>Description</h3>

<p><span class="rlang"><b>R</b></span> functions which talk directly to the ODBC interface.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>odbcTables(channel, catalog = NULL, schema = NULL,
           tableName = NULL, tableType = NULL, literal = FALSE)

odbcQuery(channel, query, rows_at_time = attr(channel, "rows_at_time"))
odbcFetchRows(channel, max = 0, buffsize = 1000,
              nullstring = NA_character_, believeNRows = TRUE)

odbcGetErrMsg(channel)
odbcClearError(channel)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="odbc-low-level_+3A_channel">channel</code></td>
<td>
<p>connection handle as returned by
<code><a href="#topic+odbcConnect">odbcConnect</a></code>, of class <code>"RODBC"</code>.</p>
</td></tr>
<tr><td><code id="odbc-low-level_+3A_catalog">catalog</code>, <code id="odbc-low-level_+3A_schema">schema</code>, <code id="odbc-low-level_+3A_tablename">tableName</code>, <code id="odbc-low-level_+3A_tabletype">tableType</code></td>
<td>
<p><code>NULL</code> or character:
whether these do anything depends on the ODBC driver.  The first
three can be length-one character vectors, and <code>tableType</code> can
specify zero or more types.</p>
</td></tr>
<tr><td><code id="odbc-low-level_+3A_literal">literal</code></td>
<td>
<p>logical: should arguments be interpreted literally or
including wildcards?</p>
</td></tr>
<tr><td><code id="odbc-low-level_+3A_query">query</code></td>
<td>
<p>any valid SQL statement.</p>
</td></tr>
<tr><td><code id="odbc-low-level_+3A_rows_at_time">rows_at_time</code></td>
<td>
<p>The number of rows to fetch at a time, between 1
and 1024.  Not all drivers work correctly with values &gt; 1: see
<code><a href="#topic+sqlQuery">sqlQuery</a></code>.</p>
</td></tr>
<tr><td><code id="odbc-low-level_+3A_max">max</code></td>
<td>
<p>limit on the number of rows to fetch, with 0 indicating no limit.</p>
</td></tr>
<tr><td><code id="odbc-low-level_+3A_buffsize">buffsize</code></td>
<td>
<p>the number of records to be transferred at a time.</p>
</td></tr>
<tr><td><code id="odbc-low-level_+3A_nullstring">nullstring</code></td>
<td>
<p>character string to be used when reading
<code>SQL_NULL_DATA</code> items in a column transferred as character.</p>
</td></tr>
<tr><td><code id="odbc-low-level_+3A_believenrows">believeNRows</code></td>
<td>
<p>logical.  Is the number of rows returned by the
ODBC connection believable?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These are low-level functions called by <code><a href="#topic+sqlTables">sqlTables</a></code>,
<code><a href="#topic+sqlQuery">sqlQuery</a></code>, <code><a href="#topic+sqlGetResults">sqlGetResults</a></code> and similar
high-level functions.  They are likely to be confind to the 
<span class="pkg">RODBC</span> namespace in the near future.
</p>
<p><code>odbcTables</code> enquires about the tables on the connected database.
Whether arguments after the first do anything and what they do
depends on the ODBC driver: see the help on <code><a href="#topic+sqlTables">sqlTables</a></code>
for some driver-specific details.
</p>
<p><code>odbcFetchRows</code> returns a data frame of the pending rowset,
limited to <code>max</code> rows if <code>max</code> is greater than 0.
</p>
<p><code>buffsize</code> may be increased from the default of 1000 rows for
increased performance on a large dataset.  This only has an effect
when <code>max = 0</code> and <code>believeNRows = FALSE</code> (either for the
ODBC connection or for this function call), in which case
<code>buffsize</code> is used as the initial allocation length of the <span class="rlang"><b>R</b></span>
vectors to hold the results.  (Values of less than 100 are increased
to 100.)  If the initial size is too small the vector length is
doubled, repeatedly if necessary.
</p>


<h3>Value</h3>

<p><code>odbcGetErrMsg</code> returns a (possibly zero-length)
character vector of pending messages.
</p>
<p><code>odbcClearError</code> returns nothing, invisibly.
</p>
<p>The otheres return <code>1</code> on success and <code>-1</code> on failure,
indicating that a message is waiting to be retrieved
<code><a href="#topic+odbcGetErrMsg">odbcGetErrMsg</a></code>.  <code>odbcFetchRows</code> may return
<code>-2</code> indicating <code>"No Data"</code>, the message that would be
returned by <code><a href="#topic+odbcGetErrMsg">odbcGetErrMsg</a></code>.
</p>


<h3>Author(s)</h3>

<p>Michael Lapsley and Brian Ripley
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sqlQuery">sqlQuery</a></code>, <code><a href="#topic+odbcConnect">odbcConnect</a></code>,
<code><a href="#topic+odbcGetErrMsg">odbcGetErrMsg</a></code>.
</p>

<hr>
<h2 id='odbcClose'>ODBC Close Connections</h2><span id='topic+odbcClose'></span><span id='topic+odbcCloseAll'></span><span id='topic+close.RODBC'></span>

<h3>Description</h3>

<p>Close connections to ODBC databases.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>odbcClose(channel)

## S3 method for class 'RODBC'
close(con, ...)

odbcCloseAll()
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="odbcClose_+3A_channel">channel</code>, <code id="odbcClose_+3A_con">con</code></td>
<td>
<p>RODBC connection object as returned by
<code>odbcConnect</code>.</p>
</td></tr>
<tr><td><code id="odbcClose_+3A_...">...</code></td>
<td>
<p>additional arguments passed from the generic.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>odbcClose</code> cleans up and frees resources.  It is also the method for the
generic function <code>close</code>.
</p>
<p><code>odbcCloseAll</code> closes all open channels (amongst the first 1000
used in the session).
</p>
<p>Channels are closed at the end of an <span class="rlang"><b>R</b></span> session, and may also be
closed by garbage collection if no object refers to them.  In both
cases a warning is given (but may not be seen at the end of a console
session).
</p>


<h3>Value</h3>

<p>Function <code>odbcClose</code> returns a logical indicating if it
succeeded, invisibly unless a warning is given.
</p>
<p>The <code>close</code> method returns <code>0</code> (success) or <code>1</code>, invisibly.
</p>


<h3>Author(s)</h3>

<p>Michael Lapsley and Brian Ripley
</p>


<h3>See Also</h3>

<p><code><a href="#topic+odbcConnect">odbcConnect</a></code>
</p>

<hr>
<h2 id='odbcConnect'>ODBC Open Connections</h2><span id='topic+odbcConnect'></span><span id='topic+odbcDriverConnect'></span><span id='topic+odbcReConnect'></span>

<h3>Description</h3>

<p>Open connections to ODBC databases.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>odbcConnect(dsn, uid = "", pwd = "", ...)

odbcDriverConnect(connection = "", case, believeNRows = TRUE,
                  colQuote, tabQuote = colQuote,
                  interpretDot = TRUE, DBMSencoding = "",
                  rows_at_time = 100, readOnlyOptimize = FALSE)

odbcReConnect(channel, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="odbcConnect_+3A_dsn">dsn</code></td>
<td>
<p>character string. A registered data source name.</p>
</td></tr>
<tr><td><code id="odbcConnect_+3A_uid">uid</code>, <code id="odbcConnect_+3A_pwd">pwd</code></td>
<td>
<p>UID and password for authentication (if required).</p>
</td></tr>
<tr><td><code id="odbcConnect_+3A_connection">connection</code></td>
<td>
<p>character string. See your ODBC documentation for the
format.</p>
</td></tr>
<tr><td><code id="odbcConnect_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to <code>odbcDriverConnect</code>.</p>
</td></tr>
<tr><td><code id="odbcConnect_+3A_case">case</code></td>
<td>
<p>Controls case changes for different DBMS engines.  See
&lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="odbcConnect_+3A_channel">channel</code></td>
<td>
<p>RODBC connection object returned by <code>odbcConnect</code>.</p>
</td></tr>
<tr><td><code id="odbcConnect_+3A_believenrows">believeNRows</code></td>
<td>
<p>logical.  Is the number of rows returned by the
ODBC connection believable?  Not true for some Oracle and Sybase drivers,
apparently, nor for Actual Technologies' SQLite driver for Mac OS X.</p>
</td></tr>
<tr><td><code id="odbcConnect_+3A_colquote">colQuote</code>, <code id="odbcConnect_+3A_tabquote">tabQuote</code></td>
<td>
<p>how to quote column (table) names in SQL
statements.  Can be of length 0 (no quoting), a length&ndash;1 character
vector giving the quote character to be used at both ends, or a
length&ndash;2 character vector giving the beginning and ending quotes.
ANSI SQL uses double quotes, but the default mode for a MySQL server
is to use backticks.
</p>
<p>The defaults are backtick (&lsquo;<span class="samp">&#8288;`&#8288;</span>&rsquo;) if the DBMS is identified
as <code>"MySQL"</code> by the driver, and double quote otherwise.
</p>
<p>A user reported that the SAS ODBC driver required <code>colQuote = NULL</code>.
</p>
</td></tr>
<tr><td><code id="odbcConnect_+3A_interpretdot">interpretDot</code></td>
<td>
<p>logical.  Should table names of the form
<code><var>qualifier</var>.<var>table</var></code> be interpreted  as table
<code><var>table</var></code> in schema <code><var>qualifier</var></code> (and for MySQL
&lsquo;schema&rsquo; means database)?</p>
</td></tr>
<tr><td><code id="odbcConnect_+3A_dbmsencoding">DBMSencoding</code></td>
<td>
<p>character string naming the encoding returned by
the DBMS.  The default means the encoding of the locale <span class="rlang"><b>R</b></span> is running
under.  Values other than the default require <code><a href="base.html#topic+iconv">iconv</a></code> to 
be available: it always is from <span class="rlang"><b>R</b></span> 2.10.0, otherwise see
<code><a href="base.html#topic+capabilities">capabilities</a></code>.</p>
</td></tr>
<tr><td><code id="odbcConnect_+3A_rows_at_time">rows_at_time</code></td>
<td>
<p>The default number of rows to fetch at a time,
between 1 and 1024.  Not all drivers work correctly with values &gt; 1: see
<code><a href="#topic+sqlQuery">sqlQuery</a></code>.</p>
</td></tr>
<tr><td><code id="odbcConnect_+3A_readonlyoptimize">readOnlyOptimize</code></td>
<td>
<p>logical: should the connection be optimized
for read-only access?</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>odbcConnect</code> establishes a connection to the specified DSN, and
<code>odbcDriverConnect</code> allows a more flexible specification <em>via</em> a
connection string.  <code>odbcConnect</code> uses the connection string<br />
<code>"DSN=<var>dsn</var>;UID=<var>uid</var>;PWD=<var>pwd</var>"</code>,<br />
omitting the last two components if they are empty.
</p>
<p>For DBMSs that translate table and column names <code>case</code> must
be set appropriately.  Allowable values are <code>"nochange"</code>,
<code>"toupper"</code> and <code>"tolower"</code> as well as the names of
databases where the behaviour is known to us (currently
<code>"mysql"</code>, which maps to lower case on Windows but not on Linux,
<code>"postgresql"</code> (lower), and <code>"msaccess"</code> (nochange)).  If
<code>case</code> is not specified, the default is <code>"nochange"</code> unless
the appropriate value can be figured out from the DBMS name reported
by the ODBC driver.  It is likely that <code>"toupper"</code> is desirable
on IBM's DB2, but this is not enforced.
</p>
<p>Note that <code>readOnlyOptimize</code> may do nothing, and is <strong>not</strong>
guaranteed to enforce read-only access.  With drivers that support it,
it is used to optimize locking strategies, transaction management and
so on.  It does make access to Mimer read-only, and has no effect on
MySQL.
</p>
<p>Function <code>odbcReConnect</code> re-connects to a database using the
settings of an existing (and presumably now closed) channel object.
Arguments given in the original call can be overridden as needed.
</p>
<p>Note that if a password is supplied (either as a <code>pwd</code> argument
or as part of the DSN) it may be stored in the
<code>connection.string</code> element of the return value, but the value is
(from <span class="pkg">RODBC</span> 1.3-0) replaced by <code>******</code>.  (This will break
<code>odbcReConnect</code>.)
</p>
<p>If it is possible to set the DBMS or ODBC driver to communicate in the
character set of the <span class="rlang"><b>R</b></span> session then this should be done.  For
example, MySQL can set the communication character set <em>via</em> SQL,
e.g. &lsquo;<span class="samp">&#8288;SET NAMES 'utf8'&#8288;</span>&rsquo;.
</p>


<h3>Value</h3>

<p>A non-negative integer which is used as handle if no error occurred,
<code>-1</code> otherwise.  A successful return has class <code>"RODBC"</code>, and
attributes including
</p>
<table role = "presentation">
<tr><td><code>connection.string</code></td>
<td>
<p>the full ODBC connection string.</p>
</td></tr>
<tr><td><code>case</code></td>
<td>
<p>the value of <code>case</code>.</p>
</td></tr>
<tr><td><code>id</code></td>
<td>
<p>a numeric ID for the channel.</p>
</td></tr>
<tr><td><code>believeNRows</code></td>
<td>
<p>the value of <code>believeNRows</code>.</p>
</td></tr>
<tr><td><code>rows_at_time</code></td>
<td>
<p>the value of <code>rows_at_time</code>.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Several errors which have been reported as bugs in <span class="pkg">RODBC</span> 1.3-0
which were in fact ODBC driver errors that can be circumvented by
setting <code>rows_at_time = 1</code> (and the warning under that argument has
always been there).  The drivers involved have been third-party
Oracle drivers and old SQL Server drivers.
</p>


<h3>Author(s)</h3>

<p>Michael Lapsley, Brian Ripley
</p>


<h3>See Also</h3>

<p><code><a href="#topic+odbcClose">odbcClose</a></code>, <code><a href="#topic+sqlQuery">sqlQuery</a></code>, <code><a href="#topic+odbcGetInfo">odbcGetInfo</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# MySQL
channel &lt;- odbcConnect("test", uid="ripley", pwd="secret")
# PostgreSQL: 'case' should be detected automatically
channel &lt;- odbcConnect("pg", uid="ripley", pwd="secret", case="postgresql")

# re-connection
odbcCloseAll()
channel &lt;- odbcReConnect(channel) # must re-assign as the data may change

## End(Not run)</code></pre>

<hr>
<h2 id='odbcDataSources'>List ODBC Data Sources</h2><span id='topic+odbcDataSources'></span>

<h3>Description</h3>

<p>List known ODBC data sources.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>odbcDataSources(type = c("all", "user", "system"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="odbcDataSources_+3A_type">type</code></td>
<td>
<p>User DSNs, system DSNs or all?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named character vector of DSN descriptions, with names the DSNs.
</p>


<h3>Author(s)</h3>

<p>Brian Ripley
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
&gt; odbcDataSources()
        test      sqlite3       testpg 
     "MySQL"    "sqlite3" "PostgreSQL"
or
                          testdb3                           sqlite3
         "MySQL ODBC 3.51 Driver"             "SQLite3 ODBC Driver"
                          bdr.xls                           testacc
 "Microsoft Excel Driver (*.xls)" "Microsoft Access Driver (*.mdb)"
                           testpg                         SQLServer
                "PostgreSQL ANSI"               "SQL Native Client"
                           Oracle                               DB2
       "Oracle in OraDb10g_home1"  "IBM DB2 ODBC DRIVER - DB2COPY1"
                          testpgw                           testdb5
             "PostgreSQL Unicode"           "MySQL ODBC 5.1 Driver"
                SQLite Datasource           SQLite UTF-8 Datasource
             "SQLite ODBC Driver"      "SQLite ODBC (UTF-8) Driver"
               SQLite3 Datasource                             mimdb
            "SQLite3 ODBC Driver"                           "MIMER"

## End(Not run)</code></pre>

<hr>
<h2 id='odbcGetInfo'>Request Information on an ODBC Connection</h2><span id='topic+odbcGetInfo'></span>

<h3>Description</h3>

<p>Request information on an ODBC connection.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>odbcGetInfo(channel)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="odbcGetInfo_+3A_channel">channel</code></td>
<td>
<p>connection handle as returned by
<code><a href="#topic+odbcConnect">odbcConnect</a></code> of class <code>"RODBC"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named character string giving information on the database and ODBC driver
in use on the connection <code>channel</code>.
</p>


<h3>Author(s)</h3>

<p>Brian Ripley
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
odbcGetInfo(channel) # under Windows XP
## MySQL returned
             DBMS_Name               DBMS_Ver        Driver_ODBC_Ver
               "MySQL"     "5.1.35-community"                "03.51"
      Data_Source_Name            Driver_Name             Driver_Ver
             "testdb5"          "myodbc5.dll"           "05.01.0005"
              ODBC_Ver            Server_Name
          "03.52.0000" "localhost via TCP/IP"
## MS Access returned
       DBMS_Name         DBMS_Ver  Driver_ODBC_Ver Data_Source_Name
        "ACCESS"     "04.00.0000"          "03.51"        "testacc"
     Driver_Name       Driver_Ver         ODBC_Ver      Server_Name
  "odbcjt32.dll"     "04.00.6305"     "03.52.0000"         "ACCESS"
## SQL Server 2008 Express returned
             DBMS_Name               DBMS_Ver        Driver_ODBC_Ver
"Microsoft SQL Server"           "10.00.1600"                "03.52"
      Data_Source_Name            Driver_Name             Driver_Ver
           "SQLServer"          "SQLNCLI.DLL"           "09.00.4035"
              ODBC_Ver            Server_Name
          "03.52.0000"      "AUK\\SQLEXPRESS"

## End(Not run)</code></pre>

<hr>
<h2 id='odbcSetAutoCommit'>ODBC Set Auto-Commit Mode</h2><span id='topic+odbcSetAutoCommit'></span><span id='topic+odbcEndTran'></span>

<h3>Description</h3>

<p>Set ODBC database connection's auto-commit mode.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>odbcSetAutoCommit(channel, autoCommit = TRUE)

odbcEndTran(channel, commit = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="odbcSetAutoCommit_+3A_channel">channel</code></td>
<td>
<p>RODBC connection object returned by <code>odbcConnect</code>.</p>
</td></tr>
<tr><td><code id="odbcSetAutoCommit_+3A_autocommit">autoCommit</code></td>
<td>
<p>logical.  Set auto-commit on?</p>
</td></tr>
<tr><td><code id="odbcSetAutoCommit_+3A_commit">commit</code></td>
<td>
<p>logical.  Commit or rollback pending transaction?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Auto-commit is a concept supported only by ODBC connections to
transactional DBMSs.
</p>
<p>If a connection to a transactional DBMS is in auto-commit mode (the
default), then all its SQL statements will be executed and committed
as individual transactions.  Otherwise, its SQL statements are grouped
into transactions that are terminated by an execution of <code>commit</code>
or <code>rollback</code>.  Switching a connection to auto-commit mode
commits the pending transaction.
</p>
<p>By default, new connections are in auto-commit mode.  If auto-commit
mode has been disabled, a call to <code>odbcEndTran</code> or an SQL
<code>commit</code> statement must be executed in order to commit changes;
otherwise, pending database changes will not be saved.
</p>


<h3>Value</h3>

<p><code>odbcSetAutoCommit</code> stops if <code>channel</code> is an invalid
connection.  The function returns <code>-1</code> on error, <code>0</code> on
success and  on success with a message that would be returned
by <code>odbcGetErrMsg</code>.
</p>


<h3>Author(s)</h3>

<p>Norman Yamada, Yasser El-Zein
</p>

<hr>
<h2 id='RODBC-internal'>Internal RODBC functions</h2><span id='topic+odbcUpdate'></span><span id='topic+odbcCaseFlag'></span><span id='topic+odbcColumns'></span><span id='topic+odbcPrimaryKeys'></span><span id='topic+odbcSpecialColumns'></span><span id='topic+sqltablecreate'></span><span id='topic+sqlwrite'></span><span id='topic+odbcTableExists'></span><span id='topic+odbcClearResults'></span><span id='topic+odbcValidChannel'></span>

<h3>Description</h3>

<p>Internal RODBC functions: not exported from the <span class="pkg">RODBC</span> name space.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>odbcUpdate(channel, query, data, params, test = FALSE,
           verbose = FALSE, nastring = NULL)
odbcCaseFlag(channel)
odbcColumns(channel, table, catalog = NULL, schema = NULL, literal = FALSE)
odbcSpecialColumns(channel, table, catalog = NULL, schema = NULL)
odbcPrimaryKeys(channel, table, catalog = NULL, schema = NULL)
sqlwrite(channel, tablename, mydata, test = FALSE, fast = TRUE,
         nastring = NULL, verbose = FALSE)
sqltablecreate(channel, tablename, coldata = NULL, colspecs, keys = -1)
odbcTableExists(channel, tablename, abort = TRUE, forQuery = TRUE,
                allowDot = attr(channel, "interpretDot"))
odbcClearResults(channel)
odbcValidChannel(channel)
</code></pre>

<hr>
<h2 id='setSqlTypeInfo'>Specify or Query a Mapping of R Types to DBMS Types</h2><span id='topic+setSqlTypeInfo'></span><span id='topic+getSqlTypeInfo'></span>

<h3>Description</h3>

<p>Specify or retrieve a mapping of <span class="rlang"><b>R</b></span> types to DBMS datatypes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setSqlTypeInfo(driver, value)

getSqlTypeInfo(driver)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="setSqlTypeInfo_+3A_driver">driver</code></td>
<td>
<p>A character string specifying the <code>DBMS_name</code> as returned
by <code><a href="#topic+odbcGetInfo">odbcGetInfo</a></code>.  Optional for <code>getSqlTypeInfo</code>.</p>
</td></tr>
<tr><td><code id="setSqlTypeInfo_+3A_value">value</code></td>
<td>
<p>A named list with character values.  This should have
names <code>"double"</code>, <code>"integer"</code>, <code>"character"</code> and
<code>"logical"</code>, and values SQL types appropriate to the DBMS.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This information is used by <code><a href="#topic+sqlSave">sqlSave</a></code> if it creates a
table in the DBMS and is not overridden by arguments <code>typeInfo</code>
or <code>varTypes</code>.  Mappings are included for MySQL, PostgreSQL,
SQLite, Oracle, Mimer, DB2 on Windows, and the Microsoft SQL Server,
Access, Excel and Dbase drivers.
</p>
<p>The SQL types chosen should be nullable to allow <code>NA</code>s to be
represented.  (Bit and boolean types often are not.)
</p>


<h3>Value</h3>

<p>For <code>setSqlTypeInfo</code> none.
</p>
<p>For <code>getSqlTypeInfo</code> with an argument, a named list.  Without an
argument, a data frame.
</p>


<h3>Author(s)</h3>

<p>Brian Ripley
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sqlTypeInfo">sqlTypeInfo</a></code>, <code><a href="#topic+sqlSave">sqlSave</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
getSqlTypeInfo()
getSqlTypeInfo("MySQL")
setSqlTypeInfo("Microsoft SQL Server",
               list(double="float", integer="int",
                    character="varchar(255)", logical="varchar(5)"))

## End(Not run)</code></pre>

<hr>
<h2 id='sqlColumns'>Query Column Structure in ODBC Tables</h2><span id='topic+sqlPrimaryKeys'></span><span id='topic+sqlColumns'></span>

<h3>Description</h3>

<p>Enquire about the column structure of tables on an ODBC database
connection.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sqlColumns(channel, sqtable, errors = FALSE, as.is = TRUE,
           special = FALSE, catalog = NULL, schema = NULL,
           literal = FALSE)

sqlPrimaryKeys(channel, sqtable, errors = FALSE, as.is = TRUE,
               catalog = NULL, schema = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sqlColumns_+3A_channel">channel</code></td>
<td>
<p>connection object as returned by <code><a href="#topic+odbcConnect">odbcConnect</a></code>.</p>
</td></tr>
<tr><td><code id="sqlColumns_+3A_sqtable">sqtable</code></td>
<td>
<p>character string: a database table (or view or similar)
name accessible from the connected DSN.  If wildcards are allowed
(only for <code>sqlColumns(special=FALSE)</code>),
results for all matching tables.</p>
</td></tr>
<tr><td><code id="sqlColumns_+3A_errors">errors</code></td>
<td>
<p>logical: if true halt and display error, else return <code>-1</code>.</p>
</td></tr>
<tr><td><code id="sqlColumns_+3A_as.is">as.is</code></td>
<td>
<p>see <code><a href="#topic+sqlGetResults">sqlGetResults</a></code>.</p>
</td></tr>
<tr><td><code id="sqlColumns_+3A_special">special</code></td>
<td>
<p>logical.  If true, return only the column(s) needed to
specify a row uniquely.  Depending on the database, there might be none.</p>
</td></tr> 
<tr><td><code id="sqlColumns_+3A_catalog">catalog</code>, <code id="sqlColumns_+3A_schema">schema</code></td>
<td>
<p><code>NULL</code> or character: additional
information on where to locate the table: see
<code><a href="#topic+sqlTables">sqlTables</a></code> for driver-specific details.  Wildcards may
be supported in <code>schema</code> for <code>sqlColumns(special=FALSE)</code>.</p>
</td></tr>
<tr><td><code id="sqlColumns_+3A_literal">literal</code></td>
<td>
<p>logical: wildcards may be interpreted in
<code>schema</code> and <code>sqtable</code>: if so this may
suppress such interpretation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The argument <code>special = TRUE</code> to <code>sqlColumns</code> returns the
column(s) needed to specify a row uniquely.  This is intended to form
the basis of an SQL <code>WHERE</code> clause for update queries (see
<code><a href="#topic+sqlUpdate">sqlUpdate</a></code>), and what (if anything) it does is
DBMS-specific.  On many DBMSs it will return the primary keys if
present: on others it will return a pseudo-column such as &lsquo;<span class="samp">&#8288;ROWID&#8288;</span>&rsquo;
(Oracle) or &lsquo;<span class="samp">&#8288;_ROWID_&#8288;</span>&rsquo; (SQLite), either always (Oracle) or if
there is no primary key.
</p>
<p>Primary keys are implemented in some DBMSs and drivers.  A table can
have a single column designated as a primary key or, in some cases,
multiple columns.  Primary keys should not be nullable (that is,
cannot contain missing values).  They can be specified as part of a
&lsquo;<span class="samp">&#8288;CREATE TABLE&#8288;</span>&rsquo; statement or added by a &lsquo;<span class="samp">&#8288;ALTER TABLE&#8288;</span>&rsquo;
statement.
</p>
<p>In principle specifying <code>catalog</code> should select an alternative
database in MySQL or an attached database in SQLite, but neither works
with current drivers.
</p>
<p>If <code>sqtable</code> contains &lsquo;<span class="samp">&#8288;.&#8288;</span>&rsquo; and neither <code>catalog</code> nor
<code>schema</code> is supplied, an attempt is made to interpret
<code><var>qualifier</var>.<var>table</var></code> as table <code><var>table</var></code> in
schema <code><var>qualifier</var></code> (and for MySQL &lsquo;schema&rsquo; means
&lsquo;database&rsquo;, but the current drivers fail to interpret
<code>catalog=</code>, so this does not yet work). (This can be suppressed
by opening the connection with <code>interpretDot = FALSE</code>.)  This has
been tested successfully on PostgreSQL, SQL Server, Oracle, DB2 and
Mimer.
</p>
<p>Whether wildcards are accepted for <code>sqtable</code> and <code>schema</code> in
<code>sqlColumns(special = FALSE)</code> depends on the driver and may be
changed by the value of <code>literal</code>.  For example, the PostgreSQL
driver tested allowed wildcards in <code>schema</code> only if <code>literal
  = FALSE</code> and never in <code>sqtable</code>, whereas two MySQL drivers both
failed to match a database when <code>catalog</code> was supplied and always
allowed wildcards in <code>sqtable</code> even if <code>literal = TRUE</code>.



</p>


<h3>Value</h3>

  
<p>A data frame on success.  If no data is returned, either a
zero-row data frame or an error. (For example, if there are no primary
keys or special column(s) in this table an empty data frame is
returned, but if primary keys are not supported by the ODBC driver or
DBMS, an error code results.)
</p>
<p>The column names are not constant across ODBC versions so the
data should be accessed by column number.
</p>
<p>For <code>sqlPrimaryKeys</code> and <code>sqlColumns(special=FALSE)</code> the
first four columns give the catalog, schema, table and column names
(where applicable).  For <code>sqlPrimaryKeys</code> the next two columns
are the column sequence number (starting with 1) and name of the
primary key: drivers can define further columns.  For
<code>sqlColumns(special=FALSE)</code> there are 18 columnns: see
<a href="https://learn.microsoft.com/en-us/sql/odbc/reference/syntax/sqlcolumns-function?view=sql-server-ver15">https://learn.microsoft.com/en-us/sql/odbc/reference/syntax/sqlcolumns-function?view=sql-server-ver15</a>.
Those beyond the first 6 shown in the examples give the
&lsquo;ordinal position&rsquo; (column 17) and further characteristics of the
column type: see <code><a href="#topic+sqlTypeInfo">sqlTypeInfo</a></code>.
</p>
<p>For the numeric values returned by <code>sqlColumns(special=TRUE)</code> see
<a href="https://learn.microsoft.com/en-us/sql/odbc/reference/syntax/sqlspecialcolumns-function?view=sql-server-ver15">https://learn.microsoft.com/en-us/sql/odbc/reference/syntax/sqlspecialcolumns-function?view=sql-server-ver15</a>:
the scope should always be <code>2</code> (the session) since that is the
scope requested in the call. For the <code>PSEUDO_COLUMN</code> column, the
possible values are <code>0</code> (unknown), <code>1</code> (no) and <code>2</code>
(yes).
</p>


<h3>Author(s)</h3>

<p>Michael Lapsley and Brian Ripley
</p>


<h3>See Also</h3>

<p><code><a href="#topic+odbcConnect">odbcConnect</a></code>, <code><a href="#topic+sqlQuery">sqlQuery</a></code>, <code><a href="#topic+sqlFetch">sqlFetch</a></code>,
<code><a href="#topic+sqlSave">sqlSave</a></code>, <code><a href="#topic+sqlTables">sqlTables</a></code>, <code><a href="#topic+odbcGetInfo">odbcGetInfo</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: ## example results from MySQL
&gt; channel &lt;- odbcConnect("test")
&gt; sqlDrop(channel, "USArrests", errors = FALSE) # precautionary
&gt; sqlSave(channel, USArrests, addPK = TRUE)
&gt; sqlColumns(channel, "USArrests")
  TABLE_CAT TABLE_SCHEM TABLE_NAME COLUMN_NAME DATA_TYPE TYPE_NAME
1    ripley        &lt;NA&gt;  USArrests    rownames        12   varchar
2    ripley        &lt;NA&gt;  USArrests      Murder         8    double
3    ripley        &lt;NA&gt;  USArrests     Assault         4   integer
4    ripley        &lt;NA&gt;  USArrests    UrbanPop         4   integer
5    ripley        &lt;NA&gt;  USArrests        Rape         8    double
... 12 more columns

&gt; sqlColumns(channel, "USArrests", special = TRUE)
  SCOPE COLUMN_NAME DATA_TYPE TYPE_NAME COLUMN_SIZE BUFFER_LENGTH
1     2    rownames        12   varchar         255           255
  DECIMAL_DIGITS PSEUDO_COLUMN
1             NA             1

&gt; sqlPrimaryKeys(channel, "USArrests")
  TABLE_CAT TABLE_SCHEM TABLE_NAME COLUMN_NAME KEY_SEQ PK_NAME
1      &lt;NA&gt;        &lt;NA&gt;  USArrests    rownames       1 PRIMARY
&gt; sqlDrop(channel, "USArrests")
&gt; close(channel)

## End(Not run)</code></pre>

<hr>
<h2 id='sqlCopy'>ODBC Copy</h2><span id='topic+sqlCopy'></span><span id='topic+sqlCopyTable'></span>

<h3>Description</h3>

<p>Functions to copy tables or result sets from one database to another.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sqlCopy(channel, query, destination, destchannel = channel,
        verbose = FALSE, errors = TRUE, ...)

sqlCopyTable(channel, srctable, desttable, destchannel = channel,
             verbose = FALSE, errors = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sqlCopy_+3A_channel">channel</code>, <code id="sqlCopy_+3A_destchannel">destchannel</code></td>
<td>
<p>connection handle as returned by
<code><a href="#topic+odbcConnect">odbcConnect</a></code>.</p>
</td></tr>
<tr><td><code id="sqlCopy_+3A_query">query</code></td>
<td>
<p>any valid SQL statement</p>
</td></tr>
<tr><td><code id="sqlCopy_+3A_destination">destination</code>, <code id="sqlCopy_+3A_srctable">srctable</code>, <code id="sqlCopy_+3A_desttable">desttable</code></td>
<td>
<p>character: a
database table name accessible from the connected DSN.</p>
</td></tr>
<tr><td><code id="sqlCopy_+3A_verbose">verbose</code></td>
<td>
<p>Display statements as they are sent to the server?</p>
</td></tr>
<tr><td><code id="sqlCopy_+3A_errors">errors</code></td>
<td>
<p>if TRUE halt and display error, else return <code>-1</code>.</p>
</td></tr>
<tr><td><code id="sqlCopy_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to <code><a href="#topic+sqlSave">sqlSave</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>sqlCopy</code> as is like <code><a href="#topic+sqlQuery">sqlQuery</a></code>, but saves the output
of <code>query</code> in table <code>destination</code> on channel
<code>destchannel</code>.     
</p>
<p><code>sqlCopyTable</code> copies the structure of <code>srctable</code> to
<code>desttable</code> on DSN <code>destchannel</code>.  This is within the
limitations of the ODBC lowest common denominator.  More precise
control is possible <em>via</em> <code>sqlQuery</code>.
</p>


<h3>Value</h3>

<p>See <code><a href="#topic+sqlGetResults">sqlGetResults</a></code>.
</p>


<h3>Author(s)</h3>

<p>Michael Lapsley and Brian Ripley
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sqlQuery">sqlQuery</a></code>, <code><a href="#topic+sqlSave">sqlSave</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: ## example for a l/casing DBMS
sqlSave(channel, USArrests, rownames = "state")
query &lt;- paste("select state, murder from usarrests",
               "where rape &gt; 30", "order by murder")
sqlCopy(channel, query, "HighRape", rownames = FALSE)
sqlFetch(channel, "HighRape", rownames = "state", max = 5)
sqlDrop(channel, "HighRape")

## End(Not run)</code></pre>

<hr>
<h2 id='sqlDrop'>Deletion Operations on Tables in ODBC databases</h2><span id='topic+sqlDrop'></span><span id='topic+sqlClear'></span>

<h3>Description</h3>

<p><code>sqlClear</code> deletes all the rows of the table <code>sqtable</code>.
</p>
<p><code>sqlDrop</code> removes the table <code>sqtable</code> (if permitted).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sqlClear(channel, sqtable, errors = TRUE)

sqlDrop(channel, sqtable, errors = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sqlDrop_+3A_channel">channel</code></td>
<td>
<p>connection object as returned by <code><a href="#topic+odbcConnect">odbcConnect</a></code>.</p>
</td></tr>
<tr><td><code id="sqlDrop_+3A_sqtable">sqtable</code></td>
<td>
<p>character string: a database table name accessible from the
connected DSN.  This can be a &lsquo;dotted&rsquo; name of the form
<code><var>schema</var>.<var>table</var></code>.</p>
</td></tr>
<tr><td><code id="sqlDrop_+3A_errors">errors</code></td>
<td>
<p>logical: if <code>TRUE</code> halt and display error, else
return <code>-1</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These submit &lsquo;<span class="samp">&#8288;TRUNCATE TABLE&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;DROP TABLE&#8288;</span>&rsquo; SQL queries
respectively.
</p>
<p>&lsquo;Dotted&rsquo; table names are allowed on systems that support them
but the existence of the table is not checked and so attempting these
operations on a non-existent table will give a low-level error.  (This
can be suppressed by opening the connection with <code>interpretDot =
    FALSE</code>.)
</p>
<p>The default &lsquo;drop&rsquo; behaviour in Oracle is to move the table to
the &lsquo;recycle bin&rsquo;: use
</p>
<pre>
  sqlQuery(channel, "PURGE recyclebin")
</pre>
<p>to empty the recycle bin.
</p>
<p>The current user might not have privileges to allow these operations,
and Actual Technologies' Mac OS X SQLite driver has a bug causing them
silently to fail.
</p>


<h3>Value</h3>

<p>If <code>errors = FALSE</code>, a numeric value, invisibly.
Otherwise a character string or <code>invisible()</code>.
</p>


<h3>Author(s)</h3>

<p>Michael Lapsley and Brian Ripley
</p>


<h3>See Also</h3>

<p><code><a href="#topic+odbcConnect">odbcConnect</a></code>, <code><a href="#topic+sqlQuery">sqlQuery</a></code>, <code><a href="#topic+sqlFetch">sqlFetch</a></code>,
<code><a href="#topic+sqlSave">sqlSave</a></code>, <code><a href="#topic+sqlTables">sqlTables</a></code>, <code><a href="#topic+odbcGetInfo">odbcGetInfo</a></code>
</p>

<hr>
<h2 id='sqlFetch'>Reading Tables from ODBC Databases</h2><span id='topic+sqlFetch'></span><span id='topic+sqlFetchMore'></span>

<h3>Description</h3>

<p>Read some or all of a table from an ODBC database into a data frame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sqlFetch(channel, sqtable, ..., colnames = FALSE, rownames = TRUE)

sqlFetchMore(channel, ..., colnames = FALSE, rownames = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sqlFetch_+3A_channel">channel</code></td>
<td>
<p>connection handle returned by <code><a href="#topic+odbcConnect">odbcConnect</a></code>.</p>
</td></tr>
<tr><td><code id="sqlFetch_+3A_sqtable">sqtable</code></td>
<td>
<p>a database table name accessible from the connected DSN.
This should be either a literal character string or a character vector of
length 1.</p>
</td></tr>
<tr><td><code id="sqlFetch_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to
<code><a href="#topic+sqlQuery">sqlQuery</a></code> or <code><a href="#topic+sqlGetResults">sqlGetResults</a></code>.  See
&lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="sqlFetch_+3A_colnames">colnames</code></td>
<td>
<p>logical: retrieve column names from first row of table?
(For use when <code><a href="#topic+sqlSave">sqlSave</a>(colnames = TRUE)</code> was used.)</p>
</td></tr>
<tr><td><code id="sqlFetch_+3A_rownames">rownames</code></td>
<td>
<p>either logical or character.
If logical, retrieve row names from the first column
(<code>rownames</code>) in the table?  If character, the column name to
retrieve them from.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note the &lsquo;table&rsquo; includes whatever table-like objects are
provided by the DBMS, in particular views and system tables.
</p>
<p><code>sqlFetch</code> by default retrieves the the entire contents of the table
<code>sqtable</code>.  Rownames and column names are restored as indicated
(assuming that they have been placed in the table by the corresponding
arguments to <code><a href="#topic+sqlSave">sqlSave</a></code>).
</p>
<p>Alternatively, <code>sqlFetch</code> can fetch the first <code>max</code> rows, in
which case <code>sqlFetchMore</code> will retrieve further result rows,
provided there has been no other ODBC query on that channel in the
meantime.
</p>
<p>These functions try to cope with the peculiar way the Excel ODBC
driver handles table names, and to quote Access table names which
contain spaces.  Dotted table names, e.g. <code>myschema.mytable</code>, are
allowed on systems that support them, unless the connection was opened
with <code>interpretDot = FALSE</code>.
</p>
<p>Useful additional parameters to pass to <code><a href="#topic+sqlQuery">sqlQuery</a></code> or
<code><a href="#topic+sqlGetResults">sqlGetResults</a></code> include
</p>

<dl>
<dt><code>max</code>:</dt><dd><p>limit on the number of rows to fetch, with
<code>0</code> (the default) indicating no limit.</p>
</dd>
<dt><code>nullstring</code>:</dt><dd><p>character string to be used when reading
<code>SQL_NULL_DATA</code> character items from the database:
default <code>NA_character_</code>.</p>
</dd>
<dt><code>na.strings</code>:</dt><dd><p>character string(s) to be mapped to
<code>NA</code> when reading character data: default <code>"NA"</code>.</p>
</dd>
<dt><code>as.is</code>:</dt><dd><p>as in <code><a href="#topic+sqlGetResults">sqlGetResults</a></code>.</p>
</dd>
<dt><code>dec</code>:</dt><dd><p>The character for the decimal place to be assumed
when converting character columns to numeric.</p>
</dd>
<dt><code>rows_at_time</code>:</dt><dd><p>Allow for multiple rows to be retrieved at
once.  See <code><a href="#topic+sqlQuery">sqlQuery</a></code>.</p>
</dd>
</dl>



<h3>Value</h3>

<p>A data frame on success, or a character or numeric error code (see
<code><a href="#topic+sqlQuery">sqlQuery</a></code>).
</p>


<h3>Note</h3>

<p>If the table name desired is not a valid SQL name (alphanumeric plus
<code>_</code>) and these functions are not able to interpret the name, you
can use <code><a href="#topic+sqlQuery">sqlQuery</a></code> with whatever quoting mechanism
your DBMS vendor provides (e.g. <code>[ ]</code> on some Microsoft
products and backticks on MySQL).
</p>


<h3>Author(s)</h3>

<p>Michael Lapsley and Brian Ripley
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sqlSave">sqlSave</a></code>, <code><a href="#topic+sqlQuery">sqlQuery</a></code>,
<code><a href="#topic+odbcConnect">odbcConnect</a></code>, <code><a href="#topic+odbcGetInfo">odbcGetInfo</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
channel &lt;- odbcConnect("test")
sqlSave(channel, USArrests)
sqlFetch(channel, "USArrests") # get the lot
sqlFetch(channel, "USArrests", max = 20, rows_at_time = 10)
sqlFetchMore(channel, max = 20)
sqlFetchMore(channel) # get the rest
sqlDrop(channel, "USArrests") 
close(channel)

## End(Not run)</code></pre>

<hr>
<h2 id='sqlQuery'>Query an ODBC Database</h2><span id='topic+sqlQuery'></span><span id='topic+sqlGetResults'></span>

<h3>Description</h3>

<p>Submit an SQL query to an ODBC database, and retrieve the results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sqlQuery(channel, query, errors = TRUE, ..., rows_at_time)

sqlGetResults(channel, as.is = FALSE,  errors = FALSE,
              max = 0, buffsize = 1000,
              nullstring = NA_character_, na.strings = "NA",
              believeNRows = TRUE, dec = getOption("dec"),
              stringsAsFactors = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sqlQuery_+3A_channel">channel</code></td>
<td>
<p>connection handle as returned by <code><a href="#topic+odbcConnect">odbcConnect</a></code>.</p>
</td></tr>
<tr><td><code id="sqlQuery_+3A_query">query</code></td>
<td>
<p>any valid SQL statement.</p>
</td></tr>
<tr><td><code id="sqlQuery_+3A_errors">errors</code></td>
<td>
<p>logical: if true halt and display error, else return <code>-1</code>.</p>
</td></tr>
<tr><td><code id="sqlQuery_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to <code>sqlGetResults</code>.</p>
</td></tr>
<tr><td><code id="sqlQuery_+3A_rows_at_time">rows_at_time</code></td>
<td>
<p>The number of rows to fetch at a time, between 1
and 1024.  See &lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="sqlQuery_+3A_as.is">as.is</code></td>
<td>
<p>which (if any) columns returned as character should be
converted to another type?  Allowed values are as for
<code><a href="utils.html#topic+read.table">read.table</a></code>.  See &lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="sqlQuery_+3A_max">max</code></td>
<td>
<p>limit on the number of rows to fetch, with <code>0</code>
indicating no limit.</p>
</td></tr>
<tr><td><code id="sqlQuery_+3A_buffsize">buffsize</code></td>
<td>
<p>an initial guess at the number of rows, used if
<code>max = 0</code> and <code>believeNRows == FALSE</code>.</p>
</td></tr>
<tr><td><code id="sqlQuery_+3A_nullstring">nullstring</code></td>
<td>
<p>character string to be used when reading
<code>SQL_NULL_DATA</code> character items from the database.</p>
</td></tr>
<tr><td><code id="sqlQuery_+3A_na.strings">na.strings</code></td>
<td>
<p>character vector of strings to be mapped to
<code>NA</code> when reading character data.</p>
</td></tr>
<tr><td><code id="sqlQuery_+3A_believenrows">believeNRows</code></td>
<td>
<p>logical.  Is the number of rows returned by the
ODBC connection believable?  This might have been set to false when
the channel was opened, and if so that setting cannot be overridden.</p>
</td></tr>
<tr><td><code id="sqlQuery_+3A_dec">dec</code></td>
<td>
<p>The character for the decimal place to be assumed when
converting character columns to numeric.</p>
</td></tr>
<tr><td><code id="sqlQuery_+3A_stringsasfactors">stringsAsFactors</code></td>
<td>
<p>logical: should columns returned as character and not
excluded by <code>as.is</code> and not converted to anything else be
converted to factors?</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>sqlQuery</code> is the workhorse function of <span class="pkg">RODBC</span>.  It sends the SQL
statement <code>query</code> to the server, using connection <code>channel</code>
returned by <code><a href="#topic+odbcConnect">odbcConnect</a></code>, and retrieves (some or all of)
the results <em>via</em> <code>sqlGetResults</code>.
</p>
<p>The term &lsquo;query&rsquo; includes any valid SQL statement including
table creation, alteration, updates etc as well as &lsquo;<span class="samp">&#8288;SELECT&#8288;</span>&rsquo;s.  The
<code>sqlQuery</code> command is a convenience wrapper that first calls
<code><a href="#topic+odbcQuery">odbcQuery</a></code> and then <code>sqlGetResults</code>. If
finer-grained control is needed, for example over the number of rows
fetched, additional arguments can be passed to <code>sqlQuery</code> or the
underlying functions called directly.
</p>
<p><code>sqlGetResults</code> is a mid-level function.  It is called after a
call to <code>sqlQuery</code> or <code><a href="#topic+odbcQuery">odbcQuery</a></code> to retrieve waiting
results into a data frame.  Its main use is with <code>max</code> set to
non-zero when it will retrieve the result set in batches with repeated
calls.  This is useful for very large result sets which can be
subjected to intermediate processing.
</p>
<p>Where possible <code>sqlGetResults</code> transfers data in binary form:
this happens for columns of (ODBC) SQL types <code>double</code>,
<code>real</code>, <code>integer</code> and <code>smallint</code>, and for binary SQL
types (which are transferred as lists of raw vectors, given class
<code>"ODBC_binary"</code>).  All other SQL data types are converted to
character strings by the ODBC interface.
</p>
<p>This paragraph applies only to SQL data types which are returned by
ODBC as character vectors.  If when creating the connection (see
<code><a href="#topic+odbcConnect">odbcConnect</a>)</code> <code>DBMSencoding</code> was set to a non-empty
value, the character strings are re-encoded.  Then if <code>as.is</code>
is true for a column, it is returned as a character vector.  Otherwise
(where detected) <code>date</code>, <code>datetime</code> and <code>timestamp</code>
values are converted to the <code>"Date"</code> or <code>"POSIXct"</code> class.
(Some drivers seem to confuse times with dates, so times may get
converted too.  Also, some DBMSs (e.g. Oracle's) idea of <code>date</code>
is a date-time.)  Remaining cases are converted by <span class="rlang"><b>R</b></span> using
<code><a href="utils.html#topic+type.convert">type.convert</a></code>.  When character data are to be converted
to numeric data, the setting of <code>options("dec")</code> is used to map
the character used by the ODBC driver in setting decimal points&mdash;this
is set to a locale-specific value when <span class="pkg">RODBC</span> is initialized if
it is not already set.
</p>
<p>Using <code>buffsize</code> will yield a marginal increase in speed if set
to no less than the maximum number of rows when <code>believeNRows =
    FALSE</code>.  (If set too small it can result in unnecessarily high
memory use as the buffers will need to be expanded.)
</p>
<p>Modern drivers should work (and work faster, especially if
communicating with a remote machine) with <code>rows_at_time = 100</code>,
the usual default, or more.  (However, some drivers may mis-fetch
multiple rows, in which case set <code>rows_at_time = 1</code> when creating
the connection.)  However, if <code>max</code> is specified then this
may fetch too many rows and hence it could be reduced (but then this
setting applies to all subsequent fetches from that result set).
Another circumstance in which you might want to reduce
<code>rows_at_time</code> is if there are large character columns in the
result set: with the default value up to 6Mb of buffer for each such
column could be allocated to store intermediate results.
</p>


<h3>Value</h3>

<p>On success, a data frame (possibly with 0 rows) or character string.
On error, if <code>errors = TRUE</code> a character vector of error
message(s), otherwise an invisible integer error code <code>-1</code>
(general, call <code><a href="#topic+odbcGetErrMsg">odbcGetErrMsg</a></code> for details) or <code>-2</code>
(no data, which may not be an error as some SQL statements do return
no data).
</p>


<h3>Author(s)</h3>

<p>Michael Lapsley and Brian Ripley
</p>


<h3>See Also</h3>

<p><code><a href="#topic+odbcConnect">odbcConnect</a></code>, <code><a href="#topic+sqlFetch">sqlFetch</a></code>,
<code><a href="#topic+sqlSave">sqlSave</a></code>, <code><a href="#topic+sqlTables">sqlTables</a></code>, <code><a href="#topic+odbcQuery">odbcQuery</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
channel &lt;- odbcConnect("test")
sqlSave(channel, USArrests, rownames = "State", verbose = TRUE)
# options(dec=".") # optional, if DBMS is not locale-aware or set to ASCII
## note case of State, Murder, Rape are DBMS-dependent,
## and some drivers need column and table names double-quoted.
sqlQuery(channel, paste("select State, Murder from USArrests",
                        "where Rape &gt; 30 order by Murder"))
close(channel)

## End(Not run)</code></pre>

<hr>
<h2 id='sqlSave'>Write a Data Frame to a Table in an ODBC Database</h2><span id='topic+sqlSave'></span><span id='topic+sqlUpdate'></span>

<h3>Description</h3>

<p>Write or update a table in an ODBC database.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sqlSave(channel, dat, tablename = NULL, append = FALSE,
        rownames = TRUE, colnames = FALSE, verbose = FALSE,
        safer = TRUE, addPK = FALSE, typeInfo, varTypes,
        fast = TRUE, test = FALSE, nastring = NULL)

sqlUpdate(channel, dat, tablename = NULL, index = NULL,
          verbose = FALSE, test = FALSE, nastring = NULL,
          fast = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sqlSave_+3A_channel">channel</code></td>
<td>
<p>connection handle returned by <code><a href="#topic+odbcConnect">odbcConnect</a></code>.</p>
</td></tr>
<tr><td><code id="sqlSave_+3A_dat">dat</code></td>
<td>
<p>a data frame.</p>
</td></tr>
<tr><td><code id="sqlSave_+3A_tablename">tablename</code></td>
<td>
<p>character: a database table name accessible from
the connected DSN.  If missing, the name of <code>dat</code>.</p>
</td></tr>
<tr><td><code id="sqlSave_+3A_index">index</code></td>
<td>
<p>character.  Name(s) of index column(s) to be used.</p>
</td></tr>
<tr><td><code id="sqlSave_+3A_append">append</code></td>
<td>
<p>logical.  Should data be appended to an existing table?</p>
</td></tr>
<tr><td><code id="sqlSave_+3A_rownames">rownames</code></td>
<td>
<p>either logical or character.  If logical, save the row
names as the first column <code>rownames</code> in the table?  If
character, the column name under which to save the rownames.</p>
</td></tr>
<tr><td><code id="sqlSave_+3A_colnames">colnames</code></td>
<td>
<p>logical: save column names as the first row of table?</p>
</td></tr>
<tr><td><code id="sqlSave_+3A_verbose">verbose</code></td>
<td>
<p>display statements as they are sent to the server?</p>
</td></tr>
<tr><td><code id="sqlSave_+3A_safer">safer</code></td>
<td>
<p>logical. If true, create a non-existing table but only
allow appends to an existing table. If false, allow <code>sqlSave</code>
to attempt to delete all the rows of an existing table, or to drop it.</p>
</td></tr>
<tr><td><code id="sqlSave_+3A_addpk">addPK</code></td>
<td>
<p>logical.  Should rownames (if included) be specified as a
primary key?</p>
</td></tr>
<tr><td><code id="sqlSave_+3A_typeinfo">typeInfo</code></td>
<td>
<p>optional list of DBMS datatypes.  Should have elements
named <code>"character"</code>, <code>"double"</code> and <code>"integer"</code>.</p>
</td></tr>
<tr><td><code id="sqlSave_+3A_vartypes">varTypes</code></td>
<td>
<p>an optional named character vector giving the DBMSs
datatypes to be used for some (or all) of the columns if a table is
to be created.</p>
</td></tr>
<tr><td><code id="sqlSave_+3A_fast">fast</code></td>
<td>
<p>logical.  If false, write data a row at a time.  If true,
use a parametrized <code>INSERT INTO</code> or <code>UPDATE</code> query to
write all the data in one operation.</p>
</td></tr>
<tr><td><code id="sqlSave_+3A_test">test</code></td>
<td>
<p>logical: if <code>TRUE</code> show what would be done, only.</p>
</td></tr>
<tr><td><code id="sqlSave_+3A_nastring">nastring</code></td>
<td>
<p>optional character string to be used for writing
<code>NA</code>s to the database.  See &lsquo;Details&rsquo;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>sqlSave</code> saves the data frame <code>dat</code> in the table
<code>tablename</code>.  If the table exists and has the appropriate
structure it is used, or else it is created anew.  If a new table is
created, column names are remapped by removing any characters which
are not alphanumeric or <code>_</code>, and the types are selected by
consulting arguments <code>varTypes</code> and <code>typeInfo</code>, then looking
the driver up in the database used by <code><a href="#topic+getSqlTypeInfo">getSqlTypeInfo</a></code> or
failing that by interrogating <code><a href="#topic+sqlTypeInfo">sqlTypeInfo</a></code>.
</p>
<p>If <code>rownames = TRUE</code> the first column of the table will be the
row labels with colname <code>rowname</code>: <code>rownames</code> can also be a
string giving the desired column name (see &lsquo;Examples&rsquo;). If
<code>colnames</code> is true, the column names are copied into row 1.  This
is intended for cases where case conversion alters the original column
names and it is desired that they are retained.  Note that there are
drawbacks to this approach: it presupposes that the rows will be
returned in the correct order; not always valid.  It will also cause
numeric columns to be returned as factors.
</p>
<p>Argument <code>addPK = TRUE</code> causes the row names to be marked as a
primary key.  This is usually a good idea, and may allow database
updates to be done.  However, the ODBC drivers for some DBMSs
(e.g. Access) do not support primary keys, and earlier versions of the
PostgreSQL ODBC driver generated internal memory corruption if this
option is used.
</p>
<p><code>sqlUpdate</code> updates the table where the rows already exist.  Data
frame <code>dat</code> should contain columns with names that map to (some
of) the columns in the table.  It also needs to contain the column(s)
specified by <code>index</code> which together identify the rows to be
updated.  If <code>index = NULL</code>, the function tries to identify such
columns.  First it looks for a primary key for the table, then for the
column(s) that the database regards as the optimal for defining a row
uniquely (these are returned by <code><a href="#topic+sqlColumns">sqlColumns</a>(special =
  TRUE)</code>: if this returns a pseudo-column it cannot be used as we do not
have values for the rows to be changed).  Finally, the row names are
used if they are stored as column <code>"rownames"</code> in the table.
</p>
<p>When <code>fast = TRUE</code>, <code>NA</code>s are always written as SQL nulls in
the database, and this is also the case if <code>fast = FALSE</code> and
<code>nastring = NULL</code> (its default value).  Otherwise <code>nastring</code>
gives the character string to be sent to the driver when <code>NA</code>s
are encountered: for all but the simplest applications it will be
better to prepare a data frame with non-null missing values already
substituted.
</p>
<p>If <code>fast = FALSE</code> all data are sent as character strings.
If <code>fast = TRUE</code>, integer and double vectors are sent as types
<code>SQL_C_SLONG</code> and <code>SQL_C_DOUBLE</code> respectively.  Some drivers
seem to require <code>fast = FALSE</code> to send other types,
e.g. <code>datetime</code>.  SQLite's approach is to use the data to determine
how it is stored, and this does not work well with <code>fast = TRUE</code>.
</p>
<p>If <code>tablename</code> contains &lsquo;<span class="samp">&#8288;.&#8288;</span>&rsquo; and neither <code>catalog</code> nor
<code>schema</code> is supplied, an attempt is made to interpret
<code><var>qualifier</var>.<var>table</var></code> names as table <code><var>table</var></code>
in schema <code><var>qualifier</var></code> (and for MySQL &lsquo;schema&rsquo; means
&lsquo;database&rsquo;).  (This can be suppressed by opening the connection with
<code>interpretDot = FALSE</code>.)
</p>


<h3>Value</h3>

<p><code>1</code> invisibly for success (and failures cause errors).
</p>


<h3>Warning</h3>

<p><code>sqlSave(safer = FALSE)</code> uses the &lsquo;great white shark&rsquo;
method of testing tables (bite it and see).  The logic will
unceremoniously <code>DROP</code> the table and create it anew with its own
choice of column types in its attempt to find a writable
solution. <code>test = TRUE</code> will not necessarily predict this
behaviour. Attempting to write indexed columns or writing to
pseudo-columns are less obvious causes of failed writes followed by a
<code>DROP</code>.  If your table structure is precious it is up to you back
it up.
</p>


<h3>Author(s)</h3>

<p>Michael Lapsley and Brian Ripley
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sqlFetch">sqlFetch</a></code>, <code><a href="#topic+sqlQuery">sqlQuery</a></code>,
<code><a href="#topic+odbcConnect">odbcConnect</a></code>, <code><a href="#topic+odbcGetInfo">odbcGetInfo</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
channel &lt;- odbcConnect("test")
sqlSave(channel, USArrests, rownames = "state", addPK=TRUE)
sqlFetch(channel, "USArrests", rownames = "state") # get the lot
foo &lt;- cbind(state=row.names(USArrests), USArrests)[1:3, c(1,3)]
foo[1,2] &lt;- 222
sqlUpdate(channel, foo, "USArrests")
sqlFetch(channel, "USArrests", rownames = "state", max = 5)
sqlDrop(channel, "USArrests") 
close(channel)

## End(Not run)</code></pre>

<hr>
<h2 id='sqlTables'>List Tables on an ODBC Connection</h2><span id='topic+sqlTables'></span>

<h3>Description</h3>

<p>List the table-like objects accessible from an ODBC connection.  What
objects are &lsquo;table-like&rsquo; depends on the DBMS, ODBC driver and
perhaps even the configuration settings: in particular some
connections report system tables and some do not.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sqlTables(channel, errors = FALSE, as.is = TRUE,
          catalog = NULL, schema = NULL, tableName = NULL,
          tableType = NULL, literal = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sqlTables_+3A_channel">channel</code></td>
<td>
<p>connection handle as returned by
<code><a href="#topic+odbcConnect">odbcConnect</a></code>.</p>
</td></tr>
<tr><td><code id="sqlTables_+3A_errors">errors</code></td>
<td>
<p>if <code>TRUE</code> halt and display error, else return <code>-1</code>.</p>
</td></tr>
<tr><td><code id="sqlTables_+3A_as.is">as.is</code></td>
<td>
<p>as in <code><a href="#topic+sqlGetResults">sqlGetResults</a></code>.</p>
</td></tr>
<tr><td><code id="sqlTables_+3A_catalog">catalog</code>, <code id="sqlTables_+3A_schema">schema</code>, <code id="sqlTables_+3A_tablename">tableName</code>, <code id="sqlTables_+3A_tabletype">tableType</code></td>
<td>
<p><code>NULL</code> or character:
whether these do anything depends on the ODBC driver.  The first
three can be length-one character vectors, and <code>tableType</code> can
specify zero or more types in separate elements of a character vector.</p>
</td></tr>
<tr><td><code id="sqlTables_+3A_literal">literal</code></td>
<td>
<p>logical: (where supported) should arguments be
interpreted literally or including wildcards?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame on success, or character/numeric on error depending on
the <code>errors</code> argument. (Use <code><a href="#topic+sqlGetResults">sqlGetResults</a></code> for
further details of errors.)
</p>
<p>The column names depend on the database, containing a third column
<code>TABLE_NAME</code> (not always in upper case): however, they are
supposed to be always in the same order.
</p>
<p>The first column is the &lsquo;catalog&rsquo; or (in ODBC2 parlance)
&lsquo;qualifier&rsquo;, the second the &lsquo;schema&rsquo; or (ODBC2)
&lsquo;owner&rsquo;, the third the name, the fourth the table type (one of
<code>"TABLE"</code>, <code>"VIEW"</code>, <code>"SYSTEM TABLE"</code>, <code>"ALIAS"</code>,
<code>"SYNONYM"</code>, or a driver-specific type name) and the fifth
column any remarks.
</p>
<p>Oddly, the Microsoft Excel driver considers worksheets to be
system tables, and named ranges to be tables.
</p>


<h3>Driver-specific details</h3>

<p>Whether the additional arguments are implemented and what they do is
driver-specific.  The standard SQL wildcards are <em>underscore</em> to
match a single character and <em>percent</em> to match zero or more
characters (and often backslash will escape these): these are not used
for table types.  All of these drivers interpret wildcards in
<code>tableName</code>, and in <code>catalog</code> or <code>schema</code> where
supported.
</p>
<p>Setting one of <code>catalog</code> or <code>schema</code> to <code>"%"</code> and the
other and <code>tableName</code> to <code>""</code> should give a list of
available catalogs or schemas, whereas
</p>
<pre>
  catalog = "", schema = "", tableName = "", tableType = "%"
  </pre>
<p>should list the supported table types.
</p>
<p>For MySQL, <code>catalog</code> refers to a database whereas
<code>schema</code> is mostly ignored, and <code>literal</code> is ignored.  To
list all databases use just <code>catalog = "%"</code>.  In the 5.1.x
driver, use <code>catalog="<var>db_name</var>", tableName="%"</code> to list the
tables in another database, and to list the table types use the
form displayed above.
</p>
<p>For PostgreSQL's ODBC driver <code>catalog</code> is ignored (except that
<code>catalog = ""</code> is required when listing schema or table types) and
<code>literal</code> works for both <code>schema</code> and for <code>tableName</code>.
</p>
<p>SQLite ODBC ignores <code>catalog</code> and <code>schema</code>, except that the
displayed form is used to list table types.  So although it is
possible to attach databases and to refer to them by the <em>dotted
name</em> notation, it is apparently impossible to list tables on attached
databases.

</p>
<p>Microsoft SQL Server 2008 interprets both <code>catalog</code> and <code>schema</code>.
With <code>literal = TRUE</code> it only finds tables if <code>schema</code> is
set (even to an empty string).  Schemas are only listed if they contain
objects.
</p>
<p>Oracle's Windows ODBC driver finds no matches if anything non-empty is
supplied for the <code>catalog</code> argument.  Unless a schema is
specified it lists tables in all schemas.  It lists available table
types as just <code>"TABLE"</code> and <code>"VIEW"</code>, but other types appear
in listings.  With <code>literal = TRUE</code> it only finds tables if
<code>schema</code> is set (even to an empty string). 
</p>
<p>DB2 implements schemas but not catalogs.  <code>literal = TRUE</code> has no
effect.  In some uses case matters and upper-case names must be used
for schemas.
</p>
<p>The Microsoft Access and Excel drivers interpret <code>catalog</code> as the
name of the Access <code>.mdb</code> or Excel <code>.xls</code> file (with the
path but without the extension): wildcards are interpreted in
<code>catalog</code> (for files in the same folder as the attached database)
and <code>tableName</code>.  Using <code>schema</code> is an error except when
listing catalogs or table types.  The Excel driver matched
<code>tableType = "TABLE"</code> (a named range) but not <code>tableType =
    "SYSTEM TABLE"</code> (the type returned for worksheets).
</p>
<p>The Actual Technologies Access/Excel driver ignores all the additional
arguments.
</p>


<h3>Author(s)</h3>

<p>Michael Lapsley and Brian Ripley
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sqlGetResults">sqlGetResults</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
&gt; sqlTables(channel, "USArrests")
## MySQL example
  TABLE_CAT TABLE_SCHEM TABLE_NAME TABLE_TYPE REMARKS
1    ripley              USArrests      TABLE        
## PostgreSQL example
  TABLE_QUALIFIER TABLE_OWNER TABLE_NAME TABLE_TYPE REMARKS
1          ripley      public  usarrests      TABLE        
## Microsoft Access example
&gt; sqlTables(channel)
      TABLE_CAT TABLE_SCHEM        TABLE_NAME   TABLE_TYPE REMARKS
1 C:\bdr\test        &lt;NA&gt; MSysAccessObjects SYSTEM TABLE    &lt;NA&gt;
2 C:\bdr\test        &lt;NA&gt;          MSysACEs SYSTEM TABLE    &lt;NA&gt;
3 C:\bdr\test        &lt;NA&gt;       MSysObjects SYSTEM TABLE    &lt;NA&gt;
4 C:\bdr\test        &lt;NA&gt;       MSysQueries SYSTEM TABLE    &lt;NA&gt;
5 C:\bdr\test        &lt;NA&gt; MSysRelationships SYSTEM TABLE    &lt;NA&gt;
6 C:\bdr\test        &lt;NA&gt;             hills        TABLE    &lt;NA&gt;
7 C:\bdr\test        &lt;NA&gt;         USArrests        TABLE    &lt;NA&gt;

## End(Not run)</code></pre>

<hr>
<h2 id='sqlTypeInfo'>Request Information about Data Types in an ODBC Database</h2><span id='topic+sqlTypeInfo'></span>

<h3>Description</h3>

<p>Request information about data types in an ODBC database
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sqlTypeInfo(channel, type = "all", errors = TRUE, as.is = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sqlTypeInfo_+3A_channel">channel</code></td>
<td>
<p>connection handle as returned by <code><a href="#topic+odbcConnect">odbcConnect</a></code>.</p>
</td></tr>
<tr><td><code id="sqlTypeInfo_+3A_type">type</code></td>
<td>
<p>The types of columns about which information is requested.
Possible values are <code>"all"</code>, <code>"char"</code>, <code>"varchar"</code> ,
<code>"wchar"</code>, <code>"wvarchar"</code> (Unicode), <code>"real"</code>,
<code>"float"</code>, <code>"double"</code>, <code>"integer"</code>,
<code>"smallint"</code>, <code>"date"</code>, <code>"time"</code>,
<code>"timestamp"</code>, <code>"binary"</code>, <code>"varbinary"</code>,
<code>"longvarbinary"</code> and (its alias) <code>"blob"</code>.
</p>
</td></tr>
<tr><td><code id="sqlTypeInfo_+3A_errors">errors</code></td>
<td>
<p>logical: if true halt and display error, else return <code>-1</code>.</p>
</td></tr>
<tr><td><code id="sqlTypeInfo_+3A_as.is">as.is</code></td>
<td>
<p>as in <code><a href="#topic+sqlGetResults">sqlGetResults</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>sqlTypeInfo</code> attempts to find the types of columns the database
supports: ODBC drivers are not required to support this (but all known
examples do).  Where it is supported, it is used by
<code><a href="#topic+sqlSave">sqlSave</a></code> to decide what column types to create when
creating a new table in the database.
</p>


<h3>Value</h3>

<p>A data frame on success, or character/numeric on error depending on
the <code>errors</code> argument.  Use <code><a href="#topic+sqlGetResults">sqlGetResults</a></code> for
further details of errors.
</p>
<p>The columns returned may depend on the ODBC driver manager.  For a
fully ODBC 3 manager, see
<a href="https://learn.microsoft.com/en-us/sql/odbc/reference/syntax/sqlgettypeinfo-function?view=sql-server-ver15">https://learn.microsoft.com/en-us/sql/odbc/reference/syntax/sqlgettypeinfo-function?view=sql-server-ver15</a>
the symbolic constants mentioned there will be returned as numbers
(and the values of the numeric constants can be found in the ODBC
headers such as &lsquo;<span class="file">sql.h</span>&rsquo; and &lsquo;<span class="file">sqlext.h</span>&rsquo;).
</p>


<h3>Author(s)</h3>

<p>Brian Ripley
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sqlGetResults">sqlGetResults</a></code>, <code><a href="#topic+odbcGetInfo">odbcGetInfo</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
&gt; names(sqlTypeInfo(channel))
 [1] "TYPE_NAME"          "DATA_TYPE"          "COLUMN_SIZE"       
 [4] "LITERAL_PREFIX"     "LITERAL_SUFFIX"     "CREATE_PARAMS"     
 [7] "NULLABLE"           "CASE_SENSITIVE"     "SEARCHABLE"        
[10] "UNSIGNED_ATTRIBUTE" "FIXED_PREC_SCALE"   "AUTO_UNIQUE_VALUE" 
[13] "LOCAL_TYPE_NAME"    "MINIMUM_SCALE"      "MAXIMUM_SCALE"     
[16] "SQL_DATATYPE"       "SQL_DATETIME_SUB"   "NUM_PREC_RADIX"    
[19] "INTERVAL_PRECISION"

## End(Not run)</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
